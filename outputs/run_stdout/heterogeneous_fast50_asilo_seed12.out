[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:39403
[S3] → join 127.0.0.1:39402
[S4] → join 127.0.0.1:39402
[S5] → join 127.0.0.1:39402
[S6] → join 127.0.0.1:39402
[S7] → join 127.0.0.1:39402
[S8] → join 127.0.0.1:39402
[S9] → join 127.0.0.1:39402
[S10] → join 127.0.0.1:39402
[S11] → join 127.0.0.1:39402
[S13] → join 127.0.0.1:39402
[S14] → join 127.0.0.1:39402
[S15] → join 127.0.0.1:39402
[S16] → join 127.0.0.1:39402
[S17] → join 127.0.0.1:39402
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.162021 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.178195 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.180531 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.205104 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.150924 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.192139 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.118133 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.163453 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.136789 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.133420 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.111874 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.173969 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.143861 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.137442 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.195271 (no previous merge yet)
[S6]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S3] + discovered S9
[S3] + discovered S13
[S3] + discovered S15
[S4] + discovered S3
[S4] + discovered S2
[S3] + discovered S5
[S3] + discovered S8
[S3] + discovered S7
[S3] + discovered S4
[S3] + discovered S16
[S3] + discovered S11
[S3] + discovered S14
[S3] + discovered S17
[S3] + discovered S6
[S3] + discovered S10
[S4] + discovered S5
[S4] + discovered S8
[S4] + discovered S7
[S4] + discovered S16
[S4] + discovered S11
[S4] + discovered S14
[S4] + discovered S17
[S4] + discovered S6
[S4] + discovered S9
[S4] + discovered S13
[S5] + discovered S4
[S4] + discovered S15
[S5] + discovered S3
[S4] + discovered S10
[S5] + discovered S2
[S5] + discovered S7
[S6] + discovered S5
[S5] + discovered S16
[S5] + discovered S14
[S5] + discovered S6
[S6] + discovered S2
[S5] + discovered S10
[S5] + discovered S13
[S6] + discovered S3
[S5] + discovered S8
[S5] + discovered S11
[S5] + discovered S9
[S6] + discovered S4
[S5] + discovered S15
[S5] + discovered S17
[S6] + discovered S17
[S6] + discovered S8
[S6] + discovered S14
[S6] + discovered S9
[S6] + discovered S10
[S6] + discovered S16
[S6] + discovered S11
[S7] + discovered S2
[S7] + discovered S4
[S7] + discovered S6
[S7] + discovered S3
[S6] + discovered S15
[S6] + discovered S7
[S7] + discovered S5
[S6] + discovered S13
[S7] + discovered S11
[S7] + discovered S10
[S7] + discovered S16
[S7] + discovered S9
[S7] + discovered S8
[S7] + discovered S14
[S7] + discovered S15
[S7] + discovered S17
[S7] + discovered S13
[S8] + discovered S5
[S8] + discovered S3
[S8] + discovered S4
[S8] + discovered S6
[S8] + discovered S2
[S8] + discovered S7
[S8] + discovered S9
[S8] + discovered S16
[S8] + discovered S10
[S8] + discovered S15
[S8] + discovered S11
[S8] + discovered S17
[S8] + discovered S14
[S8] + discovered S13
[S9] + discovered S5
[S9] + discovered S3
[S9] + discovered S7
[S9] + discovered S8
[S9] + discovered S4
[S9] + discovered S6
[S9] + discovered S2
[S10] + discovered S6
[S10] + discovered S9
[S10] + discovered S8
[S10] + discovered S7
[S10] + discovered S4
[S10] + discovered S2
[S10] + discovered S3
[S10] + discovered S5
[S9] + discovered S13
[S9] + discovered S17
[S9] + discovered S14
[S9] + discovered S10
[S9] + discovered S11
[S9] + discovered S15
[S9] + discovered S16
[S10] + discovered S13
[S11] + discovered S4
[S11] + discovered S5
[S11] + discovered S9
[S11] + discovered S8
[S11] + discovered S7
[S11] + discovered S2
[S11] + discovered S10
[S11] + discovered S6
[S10] + discovered S15
[S10] + discovered S14
[S10] + discovered S17
[S10] + discovered S11
[S10] + discovered S16
[S11] + discovered S3
[S13] + discovered S7
[S13] + discovered S2
[S13] + discovered S5
[S13] + discovered S4
[S13] + discovered S3
[S13] + discovered S8
[S13] + discovered S10
[S13] + discovered S6
[S13] + discovered S11
[S13] + discovered S9
[S11] + discovered S13
[S11] + discovered S17
[S11] + discovered S16
[S11] + discovered S14
[S11] + discovered S15
[S13] + discovered S16
[S13] + discovered S17
[S13] + discovered S15
[S13] + discovered S14
[S14] + discovered S5
[S14] + discovered S7
[S14] + discovered S10
[S14] + discovered S9
[S14] + discovered S11
[S14] + discovered S6
[S14] + discovered S8
[S14] + discovered S3
[S14] + discovered S4
[S14] + discovered S2
[S14] + discovered S13
[S14] + discovered S15
[S14] + discovered S17
[S14] + discovered S16
[S15] + discovered S2
[S15] + discovered S13
[S15] + discovered S4
[S15] + discovered S3
[S15] + discovered S8
[S15] + discovered S6
[S15] + discovered S11
[S15] + discovered S10
[S15] + discovered S7
[S15] + discovered S5
[S15] + discovered S9
[S15] + discovered S14
[S16] + discovered S9
[S16] + discovered S7
[S16] + discovered S10
[S16] + discovered S11
[S16] + discovered S8
[S16] + discovered S13
[S16] + discovered S4
[S16] + discovered S5
[S16] + discovered S15
[S16] + discovered S14
[S16] + discovered S6
[S16] + discovered S3
[S16] + discovered S2
[S15] + discovered S16
[S15] + discovered S17
[S17] + discovered S3
[S17] + discovered S14
[S17] + discovered S15
[S17] + discovered S5
[S17] + discovered S4
[S17] + discovered S13
[S17] + discovered S7
[S17] + discovered S2
[S17] + discovered S6
[S17] + discovered S10
[S17] + discovered S8
[S17] + discovered S11
[S17] + discovered S9
[S17] + discovered S16
[S16] + discovered S17
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] ⇄ pheromone p=1.000 → S9@127.0.0.1:39410
[S16] ⇄ pheromone p=1.000 → S6@127.0.0.1:39407
[S13] ⇄ pheromone p=1.000 → S15@127.0.0.1:39415
[S9] ⇄ pheromone p=1.000 → S3@127.0.0.1:39403
[S15] ⇄ pheromone p=1.000 → S10@127.0.0.1:39411
[S8] ⇄ pheromone p=1.000 → S3@127.0.0.1:39403
[S2] ⇄ pheromone p=1.000 → S10@127.0.0.1:39411
[S14] ⇄ pheromone p=1.000 → S6@127.0.0.1:39407
[S10] ⇄ pheromone p=1.000 → S7@127.0.0.1:39408
[S7] ⇄ pheromone p=1.000 → S15@127.0.0.1:39415
[S4] ⇄ pheromone p=1.000 → S2@127.0.0.1:39402
[S11] ⇄ pheromone p=1.000 → S7@127.0.0.1:39408
[S6] ⇄ pheromone p=1.000 → S8@127.0.0.1:39409
[S3] ⇄ pheromone p=1.000 → S15@127.0.0.1:39415
[S17] ⇄ pheromone p=1.000 → S8@127.0.0.1:39409
[S2] START round=1 head_norm_before_train=1.179826 (no previous merge yet)
[S2] round=1 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6120246280392718, 'loss_val': 1.2342576266441672, 'psi': 0.3298761312488488}-{'f1_val': 0.4159371698148182, 'auprc': 0.6019487533033214, 'loss_val': 1.3411213418599603, 'psi': 0.4903418032102195}
[S3] START round=1 head_norm_before_train=1.176656 (no previous merge yet)
[S3] round=1 local utility u=0.467999 metrics={'f1_val': 0.14726672555362863, 'auprc': 0.9980703592279504, 'loss_val': 1.3487700686276536, 'psi': 0.4875881790233574}-{'f1_val': 0.10474797479747974, 'auprc': 0.7796947829676114, 'loss_val': 1.3745281629877386, 'psi': 0.37472669806553244}
[S4] START round=1 head_norm_before_train=1.192949 (no previous merge yet)
[S4] round=1 local utility u=0.075748 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.768607637202671, 'loss_val': 1.2744057192279867, 'psi': 0.3915790322181789}-{'f1_val': 0.14022662889518414, 'auprc': 0.735485306034415, 'loss_val': 1.3265348326914324, 'psi': 0.3783300997508765}
[S5] START round=1 head_norm_before_train=1.208700 (no previous merge yet)
[S5] round=1 local utility u=0.029543 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7497259042380371, 'loss_val': 1.306840751051492, 'psi': 0.3852475045523577}-{'f1_val': 0.14226190476190476, 'auprc': 0.7390008284599032, 'loss_val': 1.3337515140915508, 'psi': 0.38095747424110415}
[S6] START round=1 head_norm_before_train=1.160973 (no previous merge yet)
[S6] round=1 local utility u=0.036218 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.5942512965632331, 'loss_val': 1.2666377808473506, 'psi': 0.32255628785606244}-{'f1_val': 0.14142628205128205, 'auprc': 0.5979312983501179, 'loss_val': 1.350114516483385, 'psi': 0.3240282885708164}
[S7] START round=1 head_norm_before_train=1.197650 (no previous merge yet)
[S7] round=1 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7775387521624741, 'loss_val': 1.3145294628570496, 'psi': 0.3962495945024447}-{'f1_val': 0.39397506074099287, 'auprc': 0.7771823606559006, 'loss_val': 1.3455220211569128, 'psi': 0.547257980706956}
[S8] START round=1 head_norm_before_train=1.115937 (no previous merge yet)
[S8] round=1 local utility u=1.000000 metrics={'f1_val': 0.3966210596441621, 'auprc': 0.6547441829612377, 'loss_val': 1.30551976316692, 'psi': 0.4998703089709923}-{'f1_val': 0.10450549450549451, 'auprc': 0.39733365503079177, 'loss_val': 1.3671424437934165, 'psi': 0.22163675871561345}
[S9] START round=1 head_norm_before_train=1.170557 (no previous merge yet)
[S9] round=1 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.994135311997527, 'loss_val': 1.3129655216835254, 'psi': 0.48249289908300846}-{'f1_val': 0.4029800509553908, 'auprc': 0.6780254615093009, 'loss_val': 1.356259231586807, 'psi': 0.5129982151769549}
[S10] START round=1 head_norm_before_train=1.139442 (no previous merge yet)
[S10] round=1 local utility u=0.033884 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.5878666579858564, 'loss_val': 1.2890188561088143, 'psi': 0.3183196457193769}-{'f1_val': 0.13862163754172394, 'auprc': 0.5826876996247796, 'loss_val': 1.3412495090907393, 'psi': 0.3162480623749462}
[S11] START round=1 head_norm_before_train=1.135800 (no previous merge yet)
[S11] round=1 local utility u=0.091290 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.9968774119297705, 'loss_val': 1.3270053718905819, 'psi': 0.4829991747957746}-{'f1_val': 0.140777666999003, 'auprc': 0.9464467485246306, 'loss_val': 1.3604770340494508, 'psi': 0.46304529960925406}
[S13] START round=1 head_norm_before_train=1.126950 (no previous merge yet)
[S13] round=1 local utility u=0.125487 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.6459962272115543, 'loss_val': 1.251777098453105, 'psi': 0.34262994843085354}-{'f1_val': 0.1403857625770531, 'auprc': 0.5836923013766186, 'loss_val': 1.3158396033265167, 'psi': 0.31770837809687935}
[S14] START round=1 head_norm_before_train=1.183964 (no previous merge yet)
[S14] round=1 local utility u=0.112264 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.6522250348449631, 'loss_val': 1.3198968285209374, 'psi': 0.34510472566760747}-{'f1_val': 0.14035785288270378, 'auprc': 0.5855636599637587, 'loss_val': 1.3444406006133947, 'psi': 0.31844017571512573}
[S15] START round=1 head_norm_before_train=1.152789 (no previous merge yet)
[S15] round=1 local utility u=0.991852 metrics={'f1_val': 0.4053574113879822, 'auprc': 0.7695697746802818, 'loss_val': 1.3030057698292725, 'psi': 0.5510423567049021}-{'f1_val': 0.09269662921348315, 'auprc': 0.7534117553316557, 'loss_val': 1.3622718113630112, 'psi': 0.3569826796607522}
[S16] START round=1 head_norm_before_train=1.142012 (no previous merge yet)
[S16] round=1 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.770527712861755, 'loss_val': 1.3314321017658493, 'psi': 0.3925935552642239}-{'f1_val': 0.4153913696091057, 'auprc': 0.4901386685582061, 'loss_val': 1.3617475677927422, 'psi': 0.44529028918874586}
[S17] START round=1 head_norm_before_train=1.209454 (no previous merge yet)
[S17] round=1 local utility u=0.005393 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.8863101310505846, 'loss_val': 1.2761691701152253, 'psi': 0.4390934304106645}-{'f1_val': 0.14094896331738438, 'auprc': 0.8989346513565816, 'loss_val': 1.3248283716919314, 'psi': 0.44414323853306326}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S13] → sending delta(kind=head bytes=1793) to S17@127.0.0.1:39417
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S5] → sending delta(kind=head bytes=1786) to S15@127.0.0.1:39415
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] → sending delta(kind=head bytes=1793) to S17@127.0.0.1:39417
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S10] → sending delta(kind=head bytes=1790) to S4@127.0.0.1:39404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1783 reason=None
[S3] → sending delta(kind=head bytes=1783) to S6@127.0.0.1:39407
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S6] → sending delta(kind=head bytes=1788) to S8@127.0.0.1:39409
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:39417
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1784 reason=None
[S14] → sending delta(kind=head bytes=1784) to S16@127.0.0.1:39416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S15] → sending delta(kind=head bytes=1790) to S6@127.0.0.1:39407
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S11] → sending delta(kind=head bytes=1789) to S15@127.0.0.1:39415
[S11] sending update (kind=head size=1789 to 1 peers)
[S10] sending update (kind=head size=1790 to 1 peers)
[S15] sending update (kind=head size=1790 to 1 peers)
[S13] sending update (kind=head size=1793 to 1 peers)
[S3] sending update (kind=head size=1783 to 1 peers)
[S14] sending update (kind=head size=1784 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1793 to 1 peers)
[S6] sending update (kind=head size=1788 to 1 peers)
[S5] sending update (kind=head size=1786 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1796) from S8
[S17] cosine check vs S8: cos=-0.1151
[S17] DROPPED delta from S8 (cos=-0.1151 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1789) from S11
[S15] cosine check vs S11: cos=-0.0362
[S15] DROPPED delta from S11 (cos=-0.0362 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1784) from S14
[S16] cosine check vs S14: cos=0.0558
[S8] RECEIVED delta(kind=head bytes=1788) from S6
[S8] cosine check vs S6: cos=0.1223
[S17] RECEIVED delta(kind=head bytes=1793) from S4
[S17] cosine check vs S4: cos=0.0384
[S17] RECEIVED delta(kind=head bytes=1793) from S13
[S17] cosine check vs S13: cos=-0.0686
[S17] DROPPED delta from S13 (cos=-0.0686 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1786) from S5
[S15] cosine check vs S5: cos=-0.0085
[S15] DROPPED delta from S5 (cos=-0.0085 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1790) from S10
[S4] cosine check vs S10: cos=-0.0293
[S4] DROPPED delta from S10 (cos=-0.0293 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1790) from S15
[S6] cosine check vs S15: cos=-0.0517
[S6] DROPPED delta from S15 (cos=-0.0517 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1783) from S3
[S6] cosine check vs S3: cos=-0.1571
[S6] DROPPED delta from S3 (cos=-0.1571 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:39412
[S17] sending update (kind=head size=1795 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1795) from S17
[S11] cosine check vs S17: cos=0.1311
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=1 metric=0.3966 head_norm=1.149386
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.775763e-01
[S8] stored merged vector for next round verification (round=1)
[S8] DEBUG after merge:  round=1 metric=0.3225 head_norm=0.879185 delta_norm=0.777576
[S8] aggregate: ROLLBACK (f1_val pre=0.397 post=0.323 tol_abs=0.005 tol_rel=0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=1 metric=0.1404 head_norm=1.144696
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.884620e-01
[S11] stored merged vector for next round verification (round=1)
[S11] DEBUG after merge:  round=1 metric=0.1404 head_norm=0.899209 delta_norm=0.788462
[S11] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=1 metric=0.1406 head_norm=1.156359
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.100919e-01
[S16] stored merged vector for next round verification (round=1)
[S16] DEBUG after merge:  round=1 metric=0.1406 head_norm=0.856631 delta_norm=0.810092
[S16] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=1 metric=0.1409 head_norm=1.245058
[S17] _apply_head_vector_avg (torch): Δ‖w‖=8.571883e-01
[S17] stored merged vector for next round verification (round=1)
[S17] DEBUG after merge:  round=1 metric=0.1409 head_norm=0.890736 delta_norm=0.857188
[S17] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=1.225791 (no previous merge yet)
[S2] round=2 local utility u=0.047230 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6119619908985945, 'loss_val': 1.139609155063375, 'psi': 0.3298510763925778}-{'f1_val': 0.1417771333885667, 'auprc': 0.6120246280392718, 'loss_val': 1.2342576266441672, 'psi': 0.3298761312488488}
[S3] START round=2 head_norm_before_train=1.183810 (no previous merge yet)
[S3] round=2 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9988504811643921, 'loss_val': 1.319182312891302, 'psi': 0.48344423183422114}-{'f1_val': 0.14726672555362863, 'auprc': 0.9980703592279504, 'loss_val': 1.3487700686276536, 'psi': 0.4875881790233574}
[S4] START round=2 head_norm_before_train=1.227271 (no previous merge yet)
[S4] round=2 local utility u=0.057517 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7769080792540253, 'loss_val': 1.1842739074167492, 'psi': 0.3948992090387206}-{'f1_val': 0.14022662889518414, 'auprc': 0.768607637202671, 'loss_val': 1.2744057192279867, 'psi': 0.3915790322181789}
[S5] START round=2 head_norm_before_train=1.220148 (no previous merge yet)
[S5] round=2 local utility u=0.001801 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7411601452871704, 'loss_val': 1.2775409002088662, 'psi': 0.38182120097201105}-{'f1_val': 0.14226190476190476, 'auprc': 0.7497259042380371, 'loss_val': 1.306840751051492, 'psi': 0.3852475045523577}
[S6] START round=2 head_norm_before_train=1.197537 (no previous merge yet)
[S6] round=2 local utility u=0.074727 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6125933162193707, 'loss_val': 1.1722102692857328, 'psi': 0.32989309571851755}-{'f1_val': 0.14142628205128205, 'auprc': 0.5942512965632331, 'loss_val': 1.2666377808473506, 'psi': 0.32255628785606244}
[S7] START round=2 head_norm_before_train=1.212972 (no previous merge yet)
[S7] round=2 local utility u=0.016693 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7775929011590024, 'loss_val': 1.2813059692905358, 'psi': 0.39627125410105596}-{'f1_val': 0.14205682272909165, 'auprc': 0.7775387521624741, 'loss_val': 1.3145294628570496, 'psi': 0.3962495945024447}
[S8] START round=2 head_norm_before_train=0.879185 cos_to_last_merge=1.0000 (last merge round=1)
[S8] round=2 local utility u=0.000000 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.6605343529738187, 'loss_val': 1.257844200954491, 'psi': 0.3481873306253018}-{'f1_val': 0.3966210596441621, 'auprc': 0.6547441829612377, 'loss_val': 1.30551976316692, 'psi': 0.4998703089709923}
[S9] START round=2 head_norm_before_train=1.186235 (no previous merge yet)
[S9] round=2 local utility u=0.018339 metrics={'f1_val': 0.141397957139996, 'auprc': 0.987594895779259, 'loss_val': 1.2566656566014167, 'psi': 0.47987673259570124}-{'f1_val': 0.141397957139996, 'auprc': 0.994135311997527, 'loss_val': 1.3129655216835254, 'psi': 0.48249289908300846}
[S10] START round=2 head_norm_before_train=1.170133 (no previous merge yet)
[S10] round=2 local utility u=0.051270 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.5922849987189304, 'loss_val': 1.1997333222549391, 'psi': 0.32008698201260655}-{'f1_val': 0.13862163754172394, 'auprc': 0.5878666579858564, 'loss_val': 1.2890188561088143, 'psi': 0.3183196457193769}
[S11] START round=2 head_norm_before_train=0.899209 cos_to_last_merge=1.0000 (last merge round=1)
[S11] round=2 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.9622440926809879, 'loss_val': 1.308054895271513, 'psi': 0.4691458470962615}-{'f1_val': 0.14041368337311058, 'auprc': 0.9968774119297705, 'loss_val': 1.3270053718905819, 'psi': 0.4829991747957746}
[S13] START round=2 head_norm_before_train=1.172797 (no previous merge yet)
[S13] round=2 local utility u=0.143642 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7116814337043411, 'loss_val': 1.1615491967273825, 'psi': 0.3689040310279683}-{'f1_val': 0.1403857625770531, 'auprc': 0.6459962272115543, 'loss_val': 1.251777098453105, 'psi': 0.34262994843085354}
[S14] START round=2 head_norm_before_train=1.201235 (no previous merge yet)
[S14] round=2 local utility u=0.030585 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.6631354717596242, 'loss_val': 1.291457765301899, 'psi': 0.34946890043347195}-{'f1_val': 0.14035785288270378, 'auprc': 0.6522250348449631, 'loss_val': 1.3198968285209374, 'psi': 0.34510472566760747}
[S15] START round=2 head_norm_before_train=1.188849 (no previous merge yet)
[S15] round=2 local utility u=0.000000 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7712916225418779, 'loss_val': 1.2267866547106312, 'psi': 0.3923568398336862}-{'f1_val': 0.4053574113879822, 'auprc': 0.7695697746802818, 'loss_val': 1.3030057698292725, 'psi': 0.5510423567049021}
[S16] START round=2 head_norm_before_train=0.856631 cos_to_last_merge=1.0000 (last merge round=1)
[S16] round=2 local utility u=0.029458 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7886552587252362, 'loss_val': 1.3268991795287395, 'psi': 0.39984457360961645}-{'f1_val': 0.14063745019920318, 'auprc': 0.770527712861755, 'loss_val': 1.3314321017658493, 'psi': 0.3925935552642239}
[S17] START round=2 head_norm_before_train=0.890736 cos_to_last_merge=1.0000 (last merge round=1)
[S17] round=2 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.821654420520456, 'loss_val': 1.2375258469022976, 'psi': 0.41323114619861306}-{'f1_val': 0.14094896331738438, 'auprc': 0.8863101310505846, 'loss_val': 1.2761691701152253, 'psi': 0.4390934304106645}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:39410
[S6] not sending this round → trigger blocked (psi=0.330)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:39414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:39408
[S5] not sending this round → trigger blocked (psi=0.382)
[S13] not sending this round → trigger blocked (psi=0.369)
[S10] not sending this round → trigger blocked (psi=0.320)
[S4] not sending this round → trigger blocked (psi=0.395)
[S14] not sending this round → trigger blocked (psi=0.349)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S9] → sending delta(kind=head bytes=1787) to S3@127.0.0.1:39403
[S9] sending update (kind=head size=1787 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1797) from S7
[S9] cosine check vs S7: cos=0.0175
[S3] RECEIVED delta(kind=head bytes=1787) from S9
[S3] cosine check vs S9: cos=-0.0127
[S3] DROPPED delta from S9 (cos=-0.0127 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1796) from S16
[S7] cosine check vs S16: cos=0.0775
[S14] RECEIVED delta(kind=head bytes=1802) from S2
[S14] cosine check vs S2: cos=-0.0760
[S14] DROPPED delta from S2 (cos=-0.0760 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=2 metric=0.1414 head_norm=1.209430
[S9] _apply_head_vector_avg (torch): Δ‖w‖=8.567229e-01
[S9] stored merged vector for next round verification (round=2)
[S9] DEBUG after merge:  round=2 metric=0.3384 head_norm=0.871872 delta_norm=0.856723
[S9] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=2 metric=0.1421 head_norm=1.235131
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.288442e-01
[S7] stored merged vector for next round verification (round=2)
[S7] DEBUG after merge:  round=2 metric=0.1421 head_norm=0.784234 delta_norm=0.728844
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=3 head_norm_before_train=1.284653 (no previous merge yet)
[S2] round=3 local utility u=1.000000 metrics={'f1_val': 0.5832406078003143, 'auprc': 0.7764393007985188, 'loss_val': 0.9578333621273786, 'psi': 0.660520084999596}-{'f1_val': 0.1417771333885667, 'auprc': 0.6119619908985945, 'loss_val': 1.139609155063375, 'psi': 0.3298510763925778}
[S3] START round=3 head_norm_before_train=1.200786 (no previous merge yet)
[S3] round=3 local utility u=0.020368 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9986280242568061, 'loss_val': 1.2777788213423027, 'psi': 0.48335524907118665}-{'f1_val': 0.13984006561410703, 'auprc': 0.9988504811643921, 'loss_val': 1.319182312891302, 'psi': 0.48344423183422114}
[S4] START round=3 head_norm_before_train=1.280909 (no previous merge yet)
[S4] round=3 local utility u=0.879543 metrics={'f1_val': 0.39871425926631776, 'auprc': 0.7810690412137538, 'loss_val': 0.988596678492952, 'psi': 0.5516561720452922}-{'f1_val': 0.14022662889518414, 'auprc': 0.7769080792540253, 'loss_val': 1.1842739074167492, 'psi': 0.3948992090387206}
[S5] START round=3 head_norm_before_train=1.238470 (no previous merge yet)
[S5] round=3 local utility u=0.017625 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7400889197329457, 'loss_val': 1.2390780772369094, 'psi': 0.3813927107503211}-{'f1_val': 0.14226190476190476, 'auprc': 0.7411601452871704, 'loss_val': 1.2775409002088662, 'psi': 0.38182120097201105}
[S6] START round=3 head_norm_before_train=1.250983 (no previous merge yet)
[S6] round=3 local utility u=1.000000 metrics={'f1_val': 0.4168551858772006, 'auprc': 0.7687309656364245, 'loss_val': 1.0058169976157587, 'psi': 0.5576054977808902}-{'f1_val': 0.14142628205128205, 'auprc': 0.6125933162193707, 'loss_val': 1.1722102692857328, 'psi': 0.32989309571851755}
[S7] START round=3 head_norm_before_train=0.784234 cos_to_last_merge=1.0000 (last merge round=2)
[S7] round=3 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7776271263329729, 'loss_val': 1.2901960565288118, 'psi': 0.3962849441706442}-{'f1_val': 0.14205682272909165, 'auprc': 0.7775929011590024, 'loss_val': 1.2813059692905358, 'psi': 0.39627125410105596}
[S8] START round=3 head_norm_before_train=0.922802 cos_to_last_merge=0.9943 (last merge round=1)
[S8] round=3 local utility u=0.494288 metrics={'f1_val': 0.23422891035838933, 'auprc': 0.7650373942804702, 'loss_val': 1.1484145373998487, 'psi': 0.44655230392722167}-{'f1_val': 0.13995598239295717, 'auprc': 0.6605343529738187, 'loss_val': 1.257844200954491, 'psi': 0.3481873306253018}
[S9] START round=3 head_norm_before_train=0.871872 cos_to_last_merge=1.0000 (last merge round=2)
[S9] round=3 local utility u=0.011738 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9977930274065161, 'loss_val': 1.263783334134098, 'psi': 0.48395598524660405}-{'f1_val': 0.141397957139996, 'auprc': 0.987594895779259, 'loss_val': 1.2566656566014167, 'psi': 0.47987673259570124}
[S10] START round=3 head_norm_before_train=1.220654 (no previous merge yet)
[S10] round=3 local utility u=0.714758 metrics={'f1_val': 0.33615454293380326, 'auprc': 0.612444744047503, 'loss_val': 1.01589301891419, 'psi': 0.4466706233792832}-{'f1_val': 0.13862163754172394, 'auprc': 0.5922849987189304, 'loss_val': 1.1997333222549391, 'psi': 0.32008698201260655}
[S11] START round=3 head_norm_before_train=0.913410 cos_to_last_merge=0.9967 (last merge round=1)
[S11] round=3 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.6146646603441904, 'loss_val': 1.2554486026537555, 'psi': 0.33011407416154254}-{'f1_val': 0.14041368337311058, 'auprc': 0.9622440926809879, 'loss_val': 1.308054895271513, 'psi': 0.4691458470962615}
[S13] START round=3 head_norm_before_train=1.224539 (no previous merge yet)
[S13] round=3 local utility u=0.829316 metrics={'f1_val': 0.3724150130313311, 'auprc': 0.7382178833544033, 'loss_val': 0.9747019622172993, 'psi': 0.51873616116056}-{'f1_val': 0.1403857625770531, 'auprc': 0.7116814337043411, 'loss_val': 1.1615491967273825, 'psi': 0.3689040310279683}
[S14] START round=3 head_norm_before_train=1.226357 (no previous merge yet)
[S14] round=3 local utility u=0.075493 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7023696187900124, 'loss_val': 1.2581747191784225, 'psi': 0.3651625592456272}-{'f1_val': 0.14035785288270378, 'auprc': 0.6631354717596242, 'loss_val': 1.291457765301899, 'psi': 0.34946890043347195}
[S15] START round=3 head_norm_before_train=1.242781 (no previous merge yet)
[S15] round=3 local utility u=0.952567 metrics={'f1_val': 0.4163758395072774, 'auprc': 0.7937653847947864, 'loss_val': 1.0489278938966935, 'psi': 0.567331657622281}-{'f1_val': 0.13973365136155833, 'auprc': 0.7712916225418779, 'loss_val': 1.2267866547106312, 'psi': 0.3923568398336862}
[S16] START round=3 head_norm_before_train=0.875743 cos_to_last_merge=0.9969 (last merge round=1)
[S16] round=3 local utility u=0.033469 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7997676778004593, 'loss_val': 1.2932991335634765, 'psi': 0.4042895412397056}-{'f1_val': 0.14063745019920318, 'auprc': 0.7886552587252362, 'loss_val': 1.3268991795287395, 'psi': 0.39984457360961645}
[S17] START round=3 head_norm_before_train=0.935493 cos_to_last_merge=0.9918 (last merge round=1)
[S17] round=3 local utility u=0.828252 metrics={'f1_val': 0.3826847269593948, 'auprc': 0.8291054528386528, 'loss_val': 1.0537901131568417, 'psi': 0.561253017311098}-{'f1_val': 0.14094896331738438, 'auprc': 0.821654420520456, 'loss_val': 1.2375258469022976, 'psi': 0.41323114619861306}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:39415
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S5] → sending delta(kind=head bytes=1791) to S9@127.0.0.1:39410
[S9] not sending this round → trigger blocked (psi=0.484)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.404)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S10] → sending delta(kind=head bytes=1787) to S7@127.0.0.1:39408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:39402
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:39403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] → sending delta(kind=head bytes=1794) to S6@127.0.0.1:39407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:39411
[S2] not sending this round → trigger blocked (psi=0.661)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S3] → sending delta(kind=head bytes=1789) to S15@127.0.0.1:39415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S6] → sending delta(kind=head bytes=1792) to S8@127.0.0.1:39409
[S4] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1787 to 1 peers)
[S6] sending update (kind=head size=1792 to 1 peers)
[S3] sending update (kind=head size=1789 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1794 to 1 peers)
[S5] sending update (kind=head size=1791 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1787) from S10
[S7] cosine check vs S10: cos=0.0022
[S6] RECEIVED delta(kind=head bytes=1794) from S14
[S6] cosine check vs S14: cos=-0.0432
[S6] DROPPED delta from S14 (cos=-0.0432 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1801) from S4
[S2] cosine check vs S4: cos=0.0967
[S15] RECEIVED delta(kind=head bytes=1798) from S13
[S15] cosine check vs S13: cos=0.1221
[S10] RECEIVED delta(kind=head bytes=1796) from S15
[S10] cosine check vs S15: cos=0.0040
[S8] RECEIVED delta(kind=head bytes=1792) from S6
[S8] cosine check vs S6: cos=0.7144
[S15] RECEIVED delta(kind=head bytes=1789) from S3
[S15] cosine check vs S3: cos=0.0219
[S9] RECEIVED delta(kind=head bytes=1791) from S5
[S9] cosine check vs S5: cos=-0.0437
[S9] DROPPED delta from S5 (cos=-0.0437 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1795) from S8
[S3] cosine check vs S8: cos=-0.1228
[S3] DROPPED delta from S8 (cos=-0.1228 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:39409
[S17] sending update (kind=head size=1799 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1799) from S17
[S8] cosine check vs S17: cos=-0.0295
[S8] DROPPED delta from S17 (cos=-0.0295 < 0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=3 metric=0.5832 head_norm=1.327193
[S2] _apply_head_vector_avg (torch): Δ‖w‖=8.974363e-01
[S2] stored merged vector for next round verification (round=3)
[S2] DEBUG after merge:  round=3 metric=0.4475 head_norm=0.988831 delta_norm=0.897436
[S2] aggregate: ROLLBACK (f1_val pre=0.583 post=0.447 tol_abs=0.005 tol_rel=0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=3 metric=0.1421 head_norm=0.805512
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.540627e-01
[S7] stored merged vector for next round verification (round=3)
[S7] DEBUG after merge:  round=3 metric=0.1421 head_norm=0.755562 delta_norm=0.754063
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=3 metric=0.2342 head_norm=0.965753
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.552592e-01
[S8] stored merged vector for next round verification (round=3)
[S8] DEBUG after merge:  round=3 metric=0.4153 head_norm=1.050871 delta_norm=0.455259
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=3 metric=0.3362 head_norm=1.276761
[S10] _apply_head_vector_avg (torch): Δ‖w‖=9.089457e-01
[S10] stored merged vector for next round verification (round=3)
[S10] DEBUG after merge:  round=3 metric=0.4165 head_norm=0.912603 delta_norm=0.908946
[S10] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=3 metric=0.4164 head_norm=1.299206
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.438101e-01
[S15] stored merged vector for next round verification (round=3)
[S15] DEBUG after merge:  round=3 metric=0.4164 head_norm=0.819792 delta_norm=0.743810
[S15] aggregate: ACCEPT kept=['S13', 'S3'] (k=2/2) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=0.988831 cos_to_last_merge=1.0000 (last merge round=3)
[S2] round=4 local utility u=0.090997 metrics={'f1_val': 0.6049791465121709, 'auprc': 0.7763529078871922, 'loss_val': 0.9060111366989375, 'psi': 0.6735286510621794}-{'f1_val': 0.5832406078003143, 'auprc': 0.7764393007985188, 'loss_val': 0.9578333621273786, 'psi': 0.660520084999596}
[S3] START round=4 head_norm_before_train=1.227684 (no previous merge yet)
[S3] round=4 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8169373264782592, 'loss_val': 1.2233668075862838, 'psi': 0.41067896995976794}-{'f1_val': 0.13984006561410703, 'auprc': 0.9986280242568061, 'loss_val': 1.2777788213423027, 'psi': 0.48335524907118665}
[S4] START round=4 head_norm_before_train=1.343472 (no previous merge yet)
[S4] round=4 local utility u=0.738209 metrics={'f1_val': 0.6547969077792758, 'auprc': 0.650559966807895, 'loss_val': 0.6571469763649115, 'psi': 0.6531021313907235}-{'f1_val': 0.39871425926631776, 'auprc': 0.7810690412137538, 'loss_val': 0.988596678492952, 'psi': 0.5516561720452922}
[S5] START round=4 head_norm_before_train=1.263393 (no previous merge yet)
[S5] round=4 local utility u=0.042764 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7491920773455587, 'loss_val': 1.180859219097049, 'psi': 0.38503397379536636}-{'f1_val': 0.14226190476190476, 'auprc': 0.7400889197329457, 'loss_val': 1.2390780772369094, 'psi': 0.3813927107503211}
[S6] START round=4 head_norm_before_train=1.300194 (no previous merge yet)
[S6] round=4 local utility u=0.075864 metrics={'f1_val': 0.40530928811977895, 'auprc': 0.7769133888246712, 'loss_val': 0.8093614601905378, 'psi': 0.5539509284017359}-{'f1_val': 0.4168551858772006, 'auprc': 0.7687309656364245, 'loss_val': 1.0058169976157587, 'psi': 0.5576054977808902}
[S7] START round=4 head_norm_before_train=0.755562 cos_to_last_merge=1.0000 (last merge round=3)
[S7] round=4 local utility u=0.025369 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7922675474744139, 'loss_val': 1.2833794216277759, 'psi': 0.4021411126272206}-{'f1_val': 0.14205682272909165, 'auprc': 0.7776271263329729, 'loss_val': 1.2901960565288118, 'psi': 0.3962849441706442}
[S8] START round=4 head_norm_before_train=1.050871 cos_to_last_merge=1.0000 (last merge round=3)
[S8] round=4 local utility u=0.518824 metrics={'f1_val': 0.37306606018310795, 'auprc': 0.7769420178235673, 'loss_val': 0.9795030500964936, 'psi': 0.5346164432392917}-{'f1_val': 0.23422891035838933, 'auprc': 0.7650373942804702, 'loss_val': 1.1484145373998487, 'psi': 0.44655230392722167}
[S9] START round=4 head_norm_before_train=0.891663 cos_to_last_merge=0.9964 (last merge round=2)
[S9] round=4 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9701985687280215, 'loss_val': 1.1916275474567073, 'psi': 0.4729182017752062}-{'f1_val': 0.141397957139996, 'auprc': 0.9977930274065161, 'loss_val': 1.263783334134098, 'psi': 0.48395598524660405}
[S10] START round=4 head_norm_before_train=0.912603 cos_to_last_merge=1.0000 (last merge round=3)
[S10] round=4 local utility u=0.386978 metrics={'f1_val': 0.40936829675102443, 'auprc': 0.6684575839693374, 'loss_val': 0.8492576234692836, 'psi': 0.5130040116383496}-{'f1_val': 0.33615454293380326, 'auprc': 0.612444744047503, 'loss_val': 1.01589301891419, 'psi': 0.4466706233792832}
[S11] START round=4 head_norm_before_train=0.941009 cos_to_last_merge=0.9875 (last merge round=1)
[S11] round=4 local utility u=0.014811 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.5990027960743389, 'loss_val': 1.1788405944048514, 'psi': 0.3238493284536019}-{'f1_val': 0.14041368337311058, 'auprc': 0.6146646603441904, 'loss_val': 1.2554486026537555, 'psi': 0.33011407416154254}
[S13] START round=4 head_norm_before_train=1.278410 (no previous merge yet)
[S13] round=4 local utility u=0.923547 metrics={'f1_val': 0.6266741774415805, 'auprc': 0.763635694359484, 'loss_val': 0.7294167439207204, 'psi': 0.6814587842087418}-{'f1_val': 0.3724150130313311, 'auprc': 0.7382178833544033, 'loss_val': 0.9747019622172993, 'psi': 0.51873616116056}
[S14] START round=4 head_norm_before_train=1.255752 (no previous merge yet)
[S14] round=4 local utility u=0.244386 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8515337132264615, 'loss_val': 1.2168947889070483, 'psi': 0.4248281970202069}-{'f1_val': 0.14035785288270378, 'auprc': 0.7023696187900124, 'loss_val': 1.2581747191784225, 'psi': 0.3651625592456272}
[S15] START round=4 head_norm_before_train=0.819792 cos_to_last_merge=1.0000 (last merge round=3)
[S15] round=4 local utility u=0.090172 metrics={'f1_val': 0.4170305028984703, 'auprc': 0.7995857015052314, 'loss_val': 0.8899733716191776, 'psi': 0.5700525823411748}-{'f1_val': 0.4163758395072774, 'auprc': 0.7937653847947864, 'loss_val': 1.0489278938966935, 'psi': 0.567331657622281}
[S16] START round=4 head_norm_before_train=0.902623 cos_to_last_merge=0.9888 (last merge round=1)
[S16] round=4 local utility u=0.046160 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8129547581202943, 'loss_val': 1.2405397006968824, 'psi': 0.4095643733676396}-{'f1_val': 0.14063745019920318, 'auprc': 0.7997676778004593, 'loss_val': 1.2932991335634765, 'psi': 0.4042895412397056}
[S17] START round=4 head_norm_before_train=1.003875 cos_to_last_merge=0.9704 (last merge round=1)
[S17] round=4 local utility u=0.081451 metrics={'f1_val': 0.3654147891903988, 'auprc': 0.8517035492139484, 'loss_val': 0.8550624952967898, 'psi': 0.5599302931998187}-{'f1_val': 0.3826847269593948, 'auprc': 0.8291054528386528, 'loss_val': 1.0537901131568417, 'psi': 0.561253017311098}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S14] → sending delta(kind=head bytes=1791) to S6@127.0.0.1:39407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S15] → sending delta(kind=head bytes=1788) to S10@127.0.0.1:39411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:39403
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:39408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:39402
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:39408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:39415
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:39415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:39407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:39410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:39411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S6] → sending delta(kind=head bytes=1792) to S8@127.0.0.1:39409
[S4] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S15] sending update (kind=head size=1788 to 1 peers)
[S14] sending update (kind=head size=1791 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1792 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1799) from S11
[S7] cosine check vs S11: cos=0.0319
[S7] RECEIVED delta(kind=head bytes=1803) from S10
[S7] cosine check vs S10: cos=0.6183
[S6] RECEIVED delta(kind=head bytes=1796) from S16
[S6] cosine check vs S16: cos=-0.0352
[S6] DROPPED delta from S16 (cos=-0.0352 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1801) from S4
[S2] cosine check vs S4: cos=0.7025
[S10] RECEIVED delta(kind=head bytes=1798) from S2
[S10] cosine check vs S2: cos=0.0016
[S10] RECEIVED delta(kind=head bytes=1788) from S15
[S10] cosine check vs S15: cos=0.6041
[S8] RECEIVED delta(kind=head bytes=1792) from S6
[S8] cosine check vs S6: cos=0.9292
[S9] RECEIVED delta(kind=head bytes=1797) from S5
[S9] cosine check vs S5: cos=-0.0411
[S9] DROPPED delta from S5 (cos=-0.0411 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1795) from S8
[S3] cosine check vs S8: cos=-0.1498
[S3] DROPPED delta from S8 (cos=-0.1498 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1791) from S14
[S6] cosine check vs S14: cos=-0.0483
[S6] DROPPED delta from S14 (cos=-0.0483 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1796) from S7
[S15] cosine check vs S7: cos=0.0233
[S15] RECEIVED delta(kind=head bytes=1798) from S13
[S15] cosine check vs S13: cos=0.4472
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] → sending delta(kind=head bytes=1793) to S8@127.0.0.1:39409
[S17] sending update (kind=head size=1793 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1793) from S17
[S8] cosine check vs S17: cos=-0.0282
[S8] DROPPED delta from S17 (cos=-0.0282 < 0.0)
[S10] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=4 metric=0.4094 head_norm=0.990878
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.792871e-01
[S10] stored merged vector for next round verification (round=4)
[S10] DEBUG after merge:  round=4 metric=0.3863 head_norm=0.707430 delta_norm=0.479287
[S10] aggregate: ROLLBACK (f1_val pre=0.409 post=0.386 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=4 metric=0.4170 head_norm=0.901887
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.690581e-01
[S15] stored merged vector for next round verification (round=4)
[S15] DEBUG after merge:  round=4 metric=0.7147 head_norm=0.706031 delta_norm=0.469058
[S15] aggregate: ACCEPT kept=['S7', 'S13'] (k=2/2) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=4 metric=0.6050 head_norm=1.050178
[S2] _apply_head_vector_avg (torch): Δ‖w‖=5.088165e-01
[S2] stored merged vector for next round verification (round=4)
[S2] DEBUG after merge:  round=4 metric=0.6052 head_norm=1.145716 delta_norm=0.508817
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=4 metric=0.1421 head_norm=0.773758
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.819032e-01
[S7] stored merged vector for next round verification (round=4)
[S7] DEBUG after merge:  round=4 metric=0.1421 head_norm=0.628408 delta_norm=0.381903
[S7] aggregate: ACCEPT kept=['S11', 'S10'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=4 metric=0.3731 head_norm=1.102475
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.629748e-01
[S8] stored merged vector for next round verification (round=4)
[S8] DEBUG after merge:  round=4 metric=0.3731 head_norm=1.208062 delta_norm=0.262975
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=5 head_norm_before_train=1.145716 cos_to_last_merge=1.0000 (last merge round=4)
[S2] round=5 local utility u=0.000000 metrics={'f1_val': 0.6138700593606596, 'auprc': 0.6438873420837496, 'loss_val': 0.8061658164774894, 'psi': 0.6258769724498956}-{'f1_val': 0.6049791465121709, 'auprc': 0.7763529078871922, 'loss_val': 0.9060111366989375, 'psi': 0.6735286510621794}
[S3] START round=5 head_norm_before_train=1.261516 (no previous merge yet)
[S3] round=5 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.6307760185115596, 'loss_val': 1.1734985488217444, 'psi': 0.3362144467730881}-{'f1_val': 0.13984006561410703, 'auprc': 0.8169373264782592, 'loss_val': 1.2233668075862838, 'psi': 0.41067896995976794}
[S4] START round=5 head_norm_before_train=1.428372 (no previous merge yet)
[S4] round=5 local utility u=0.295156 metrics={'f1_val': 0.6639702320921734, 'auprc': 0.7849347464966225, 'loss_val': 0.5249991556405259, 'psi': 0.7123560378539531}-{'f1_val': 0.6547969077792758, 'auprc': 0.650559966807895, 'loss_val': 0.6571469763649115, 'psi': 0.6531021313907235}
[S5] START round=5 head_norm_before_train=1.293677 (no previous merge yet)
[S5] round=5 local utility u=0.887438 metrics={'f1_val': 0.41654174186412063, 'auprc': 0.7585519000720446, 'loss_val': 1.0797409848277555, 'psi': 0.5533458051472903}-{'f1_val': 0.14226190476190476, 'auprc': 0.7491920773455587, 'loss_val': 1.180859219097049, 'psi': 0.38503397379536636}
[S6] START round=5 head_norm_before_train=1.357089 (no previous merge yet)
[S6] round=5 local utility u=0.738177 metrics={'f1_val': 0.6141408358330686, 'auprc': 0.794878141931902, 'loss_val': 0.6398905369341554, 'psi': 0.686435758272602}-{'f1_val': 0.40530928811977895, 'auprc': 0.7769133888246712, 'loss_val': 0.8093614601905378, 'psi': 0.5539509284017359}
[S7] START round=5 head_norm_before_train=0.628408 cos_to_last_merge=1.0000 (last merge round=4)
[S7] round=5 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7775683533082851, 'loss_val': 1.2804043816056447, 'psi': 0.39626143496076904}-{'f1_val': 0.14205682272909165, 'auprc': 0.7922675474744139, 'loss_val': 1.2833794216277759, 'psi': 0.4021411126272206}
[S8] START round=5 head_norm_before_train=1.208062 cos_to_last_merge=1.0000 (last merge round=4)
[S8] round=5 local utility u=0.191687 metrics={'f1_val': 0.37307134877987713, 'auprc': 0.8645327253031223, 'loss_val': 0.8589326660950214, 'psi': 0.5696558993891752}-{'f1_val': 0.37306606018310795, 'auprc': 0.7769420178235673, 'loss_val': 0.9795030500964936, 'psi': 0.5346164432392917}
[S9] START round=5 head_norm_before_train=0.920141 cos_to_last_merge=0.9871 (last merge round=2)
[S9] round=5 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8739067294298073, 'loss_val': 1.1070399279144678, 'psi': 0.43440146605592056}-{'f1_val': 0.141397957139996, 'auprc': 0.9701985687280215, 'loss_val': 1.1916275474567073, 'psi': 0.4729182017752062}
[S10] START round=5 head_norm_before_train=0.707430 cos_to_last_merge=1.0000 (last merge round=4)
[S10] round=5 local utility u=0.509789 metrics={'f1_val': 0.4265026363188058, 'auprc': 0.9488431809811465, 'loss_val': 0.773642236554225, 'psi': 0.6354388541837421}-{'f1_val': 0.40936829675102443, 'auprc': 0.6684575839693374, 'loss_val': 0.8492576234692836, 'psi': 0.5130040116383496}
[S11] START round=5 head_norm_before_train=0.972598 cos_to_last_merge=0.9755 (last merge round=1)
[S11] round=5 local utility u=0.859728 metrics={'f1_val': 0.406123072298019, 'auprc': 0.59932934520326, 'loss_val': 1.054620947411172, 'psi': 0.48340558146011536}-{'f1_val': 0.14041368337311058, 'auprc': 0.5990027960743389, 'loss_val': 1.1788405944048514, 'psi': 0.3238493284536019}
[S13] START round=5 head_norm_before_train=1.340388 (no previous merge yet)
[S13] round=5 local utility u=0.333209 metrics={'f1_val': 0.7132262943575028, 'auprc': 0.757312437020051, 'loss_val': 0.5633407521497669, 'psi': 0.7308607514225222}-{'f1_val': 0.6266741774415805, 'auprc': 0.763635694359484, 'loss_val': 0.7294167439207204, 'psi': 0.6814587842087418}
[S14] START round=5 head_norm_before_train=1.285911 (no previous merge yet)
[S14] round=5 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.81977318754529, 'loss_val': 1.149696425403078, 'psi': 0.4121239867477383}-{'f1_val': 0.14035785288270378, 'auprc': 0.8515337132264615, 'loss_val': 1.2168947889070483, 'psi': 0.4248281970202069}
[S15] START round=5 head_norm_before_train=0.706031 cos_to_last_merge=1.0000 (last merge round=4)
[S15] round=5 local utility u=0.056034 metrics={'f1_val': 0.41251892923894706, 'auprc': 0.8283104198232445, 'loss_val': 0.8370096688806978, 'psi': 0.578835525472666}-{'f1_val': 0.4170305028984703, 'auprc': 0.7995857015052314, 'loss_val': 0.8899733716191776, 'psi': 0.5700525823411748}
[S16] START round=5 head_norm_before_train=0.940743 cos_to_last_merge=0.9766 (last merge round=1)
[S16] round=5 local utility u=0.202522 metrics={'f1_val': 0.20420920824290442, 'auprc': 0.7941516824513081, 'loss_val': 1.1605177644918951, 'psi': 0.4401861979262659}-{'f1_val': 0.14063745019920318, 'auprc': 0.8129547581202943, 'loss_val': 1.2405397006968824, 'psi': 0.4095643733676396}
[S17] START round=5 head_norm_before_train=1.096028 cos_to_last_merge=0.9379 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.938
[S17] round=5 local utility u=0.000000 metrics={'f1_val': 0.3530850275723532, 'auprc': 0.7210037989451401, 'loss_val': 0.892016081132148, 'psi': 0.500252536121468}-{'f1_val': 0.3654147891903988, 'auprc': 0.8517035492139484, 'loss_val': 0.8550624952967898, 'psi': 0.5599302931998187}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:39410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] → sending delta(kind=head bytes=1792) to S10@127.0.0.1:39411
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:39409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S13] → sending delta(kind=head bytes=1790) to S15@127.0.0.1:39415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:39402
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S16] → sending delta(kind=head bytes=1792) to S6@127.0.0.1:39407
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S7@127.0.0.1:39408
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S8] → sending delta(kind=head bytes=1791) to S3@127.0.0.1:39403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:39408
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1791 to 1 peers)
[S16] sending update (kind=head size=1792 to 1 peers)
[S11] sending update (kind=head size=1794 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1790 to 1 peers)
[S6] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1792 to 1 peers)
[S5] sending update (kind=head size=1794 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1802) from S10
[S7] cosine check vs S10: cos=0.6744
[S7] RECEIVED delta(kind=head bytes=1794) from S11
[S7] cosine check vs S11: cos=0.3842
[S6] RECEIVED delta(kind=head bytes=1792) from S16
[S6] cosine check vs S16: cos=-0.0338
[S6] DROPPED delta from S16 (cos=-0.0338 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1790) from S13
[S15] cosine check vs S13: cos=0.7041
[S2] RECEIVED delta(kind=head bytes=1796) from S4
[S2] cosine check vs S4: cos=0.9074
[S10] RECEIVED delta(kind=head bytes=1792) from S15
[S10] cosine check vs S15: cos=0.6958
[S8] RECEIVED delta(kind=head bytes=1796) from S6
[S8] cosine check vs S6: cos=0.9705
[S9] RECEIVED delta(kind=head bytes=1794) from S5
[S9] cosine check vs S5: cos=-0.0391
[S9] DROPPED delta from S5 (cos=-0.0391 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1791) from S8
[S3] cosine check vs S8: cos=-0.1515
[S3] DROPPED delta from S8 (cos=-0.1515 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] ⇄ pheromone p=0.389 → S6@127.0.0.1:39407
[S9] ⇄ pheromone p=0.331 → S3@127.0.0.1:39403
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=5 metric=0.1421 head_norm=0.648391
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.473534e-01
[S7] stored merged vector for next round verification (round=5)
[S7] DEBUG after merge:  round=5 metric=0.1421 head_norm=0.602491 delta_norm=0.247353
[S7] aggregate: ACCEPT kept=['S10', 'S11'] (k=2/2) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.333 → S15@127.0.0.1:39415
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=5 metric=0.6139 head_norm=1.197396
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.317768e-01
[S2] stored merged vector for next round verification (round=5)
[S2] DEBUG after merge:  round=5 metric=0.5649 head_norm=1.326878 delta_norm=0.331777
[S2] aggregate: ROLLBACK (f1_val pre=0.614 post=0.565 tol_abs=0.005 tol_rel=0.0)
[S2] ⇄ pheromone p=0.475 → S10@127.0.0.1:39411
[S3] ⇄ pheromone p=0.369 → S15@127.0.0.1:39415
[S6] ⇄ pheromone p=0.626 → S8@127.0.0.1:39409
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=5 metric=0.3731 head_norm=1.267367
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.789124e-01
[S8] stored merged vector for next round verification (round=5)
[S8] DEBUG after merge:  round=5 metric=0.3731 head_norm=1.332029 delta_norm=0.178912
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.594 → S3@127.0.0.1:39403
[S4] ⇄ pheromone p=0.630 → S2@127.0.0.1:39402
[S13] ⇄ pheromone p=0.673 → S15@127.0.0.1:39415
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=5 metric=0.4265 head_norm=0.805811
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.128454e-01
[S10] stored merged vector for next round verification (round=5)
[S10] DEBUG after merge:  round=5 metric=0.4349 head_norm=0.738626 delta_norm=0.312845
[S10] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.591 → S7@127.0.0.1:39408
[S5] ⇄ pheromone p=0.517 → S9@127.0.0.1:39410
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=5 metric=0.4125 head_norm=0.798467
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.082066e-01
[S15] stored merged vector for next round verification (round=5)
[S15] DEBUG after merge:  round=5 metric=0.4168 head_norm=1.024027 delta_norm=0.508207
[S15] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.556 → S10@127.0.0.1:39411
[S16] ⇄ pheromone p=0.383 → S6@127.0.0.1:39407
[S11] ⇄ pheromone p=0.509 → S7@127.0.0.1:39408
[S17] ⇄ pheromone p=0.447 → S8@127.0.0.1:39409
[S2] START round=6 head_norm_before_train=1.326878 cos_to_last_merge=1.0000 (last merge round=5)
[S2] round=6 local utility u=0.394407 metrics={'f1_val': 0.7015109138377981, 'auprc': 0.7116863819181798, 'loss_val': 0.7465946292785418, 'psi': 0.7055811010699508}-{'f1_val': 0.6138700593606596, 'auprc': 0.6438873420837496, 'loss_val': 0.8061658164774894, 'psi': 0.6258769724498956}
[S3] START round=6 head_norm_before_train=1.295593 (no previous merge yet)
[S3] round=6 local utility u=1.000000 metrics={'f1_val': 0.4076089163011673, 'auprc': 0.8609127656871394, 'loss_val': 1.0786499971322963, 'psi': 0.5889304560555562}-{'f1_val': 0.13984006561410703, 'auprc': 0.6307760185115596, 'loss_val': 1.1734985488217444, 'psi': 0.3362144467730881}
[S4] START round=6 head_norm_before_train=1.519081 (no previous merge yet)
[S4] round=6 local utility u=0.246254 metrics={'f1_val': 0.6650828274222297, 'auprc': 0.9344894457261592, 'loss_val': 0.4878303881231057, 'psi': 0.7728454747438016}-{'f1_val': 0.6639702320921734, 'auprc': 0.7849347464966225, 'loss_val': 0.5249991556405259, 'psi': 0.7123560378539531}
[S5] START round=6 head_norm_before_train=1.330531 (no previous merge yet)
[S5] round=6 local utility u=0.097188 metrics={'f1_val': 0.4179091272005397, 'auprc': 0.7764657954477964, 'loss_val': 0.9473107352666343, 'psi': 0.5613317944994424}-{'f1_val': 0.41654174186412063, 'auprc': 0.7585519000720446, 'loss_val': 1.0797409848277555, 'psi': 0.5533458051472903}
[S6] START round=6 head_norm_before_train=1.416476 (no previous merge yet)
[S6] round=6 local utility u=0.358338 metrics={'f1_val': 0.7136516776548333, 'auprc': 0.7937242916133711, 'loss_val': 0.5168182680337694, 'psi': 0.7456807232382484}-{'f1_val': 0.6141408358330686, 'auprc': 0.794878141931902, 'loss_val': 0.6398905369341554, 'psi': 0.686435758272602}
[S7] START round=6 head_norm_before_train=0.602491 cos_to_last_merge=1.0000 (last merge round=5)
[S7] round=6 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.5795057407720575, 'loss_val': 1.2694797580408104, 'psi': 0.31703638994627803}-{'f1_val': 0.14205682272909165, 'auprc': 0.7775683533082851, 'loss_val': 1.2804043816056447, 'psi': 0.39626143496076904}
[S8] START round=6 head_norm_before_train=1.332029 cos_to_last_merge=1.0000 (last merge round=5)
[S8] round=6 local utility u=0.046003 metrics={'f1_val': 0.37306554171580314, 'auprc': 0.8664577448328464, 'loss_val': 0.7726670436498188, 'psi': 0.5704224229626205}-{'f1_val': 0.37307134877987713, 'auprc': 0.8645327253031223, 'loss_val': 0.8589326660950214, 'psi': 0.5696558993891752}
[S9] START round=6 head_norm_before_train=0.950895 cos_to_last_merge=0.9758 (last merge round=2)
[S9] round=6 local utility u=0.215843 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9677447030387407, 'loss_val': 0.9568687159078588, 'psi': 0.47193665549949393}-{'f1_val': 0.141397957139996, 'auprc': 0.8739067294298073, 'loss_val': 1.1070399279144678, 'psi': 0.43440146605592056}
[S10] START round=6 head_norm_before_train=0.738626 cos_to_last_merge=1.0000 (last merge round=5)
[S10] round=6 local utility u=0.337203 metrics={'f1_val': 0.5173773745777791, 'auprc': 0.957367094905342, 'loss_val': 0.6700573381778996, 'psi': 0.6933732627088043}-{'f1_val': 0.4265026363188058, 'auprc': 0.9488431809811465, 'loss_val': 0.773642236554225, 'psi': 0.6354388541837421}
[S11] START round=6 head_norm_before_train=1.008732 cos_to_last_merge=0.9609 (last merge round=1)
[S11] round=6 local utility u=0.342028 metrics={'f1_val': 0.39651855440916606, 'auprc': 0.7946686908340719, 'loss_val': 0.8989551905755463, 'psi': 0.5557786089791283}-{'f1_val': 0.406123072298019, 'auprc': 0.59932934520326, 'loss_val': 1.054620947411172, 'psi': 0.48340558146011536}
[S13] START round=6 head_norm_before_train=1.405795 (no previous merge yet)
[S13] round=6 local utility u=0.021233 metrics={'f1_val': 0.7116895582362373, 'auprc': 0.751678766926768, 'loss_val': 0.4947529814204599, 'psi': 0.7276852417124495}-{'f1_val': 0.7132262943575028, 'auprc': 0.757312437020051, 'loss_val': 0.5633407521497669, 'psi': 0.7308607514225222}
[S14] START round=6 head_norm_before_train=1.316451 (no previous merge yet)
[S14] round=6 local utility u=0.839400 metrics={'f1_val': 0.39659360338126215, 'auprc': 0.8223819587757099, 'loss_val': 1.0161382123161862, 'psi': 0.5669089455390413}-{'f1_val': 0.14035785288270378, 'auprc': 0.81977318754529, 'loss_val': 1.149696425403078, 'psi': 0.4121239867477383}
[S15] START round=6 head_norm_before_train=1.024027 cos_to_last_merge=1.0000 (last merge round=5)
[S15] round=6 local utility u=0.000000 metrics={'f1_val': 0.41653611723511863, 'auprc': 0.7976422399940818, 'loss_val': 0.8937285420609145, 'psi': 0.5689785663387039}-{'f1_val': 0.41251892923894706, 'auprc': 0.8283104198232445, 'loss_val': 0.8370096688806978, 'psi': 0.578835525472666}
[S16] START round=6 head_norm_before_train=0.986345 cos_to_last_merge=0.9602 (last merge round=1)
[S16] round=6 local utility u=0.545152 metrics={'f1_val': 0.38460972536536436, 'auprc': 0.7599114107546268, 'loss_val': 1.0498951449034084, 'psi': 0.5347303995210693}-{'f1_val': 0.20420920824290442, 'auprc': 0.7941516824513081, 'loss_val': 1.1605177644918951, 'psi': 0.4401861979262659}
[S17] START round=6 head_norm_before_train=1.177993 cos_to_last_merge=0.9091 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.909
[S17] round=6 local utility u=0.000000 metrics={'f1_val': 0.3459036797490703, 'auprc': 0.7478663359277568, 'loss_val': 1.0393872124562589, 'psi': 0.5066887422205449}-{'f1_val': 0.3530850275723532, 'auprc': 0.7210037989451401, 'loss_val': 0.892016081132148, 'psi': 0.500252536121468}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S5] → sending delta(kind=head bytes=1792) to S9@127.0.0.1:39410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] → sending delta(kind=head bytes=1794) to S6@127.0.0.1:39407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:39415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] → sending delta(kind=head bytes=1794) to S7@127.0.0.1:39408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:39411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] → sending delta(kind=head bytes=1793) to S2@127.0.0.1:39402
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:39409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S16] → sending delta(kind=head bytes=1790) to S6@127.0.0.1:39407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:39403
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:39408
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:39403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S3] → sending delta(kind=head bytes=1790) to S15@127.0.0.1:39415
[S8] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1790 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1794 to 1 peers)
[S3] sending update (kind=head size=1790 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1792 to 1 peers)
[S14] sending update (kind=head size=1794 to 1 peers)
[S4] sending update (kind=head size=1793 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1790) from S16
[S6] cosine check vs S16: cos=-0.0306
[S6] DROPPED delta from S16 (cos=-0.0306 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1792) from S5
[S9] cosine check vs S5: cos=-0.0370
[S9] DROPPED delta from S5 (cos=-0.0370 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1794) from S14
[S6] cosine check vs S14: cos=-0.0553
[S6] DROPPED delta from S14 (cos=-0.0553 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1790) from S3
[S15] cosine check vs S3: cos=0.0559
[S15] RECEIVED delta(kind=head bytes=1802) from S13
[S15] cosine check vs S13: cos=0.9213
[S10] RECEIVED delta(kind=head bytes=1801) from S2
[S10] cosine check vs S2: cos=0.1273
[S8] RECEIVED delta(kind=head bytes=1799) from S6
[S8] cosine check vs S6: cos=0.9830
[S3] RECEIVED delta(kind=head bytes=1800) from S8
[S3] cosine check vs S8: cos=-0.1484
[S3] DROPPED delta from S8 (cos=-0.1484 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1797) from S9
[S3] cosine check vs S9: cos=-0.0675
[S3] DROPPED delta from S9 (cos=-0.0675 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1793) from S4
[S2] cosine check vs S4: cos=0.9539
[S7] RECEIVED delta(kind=head bytes=1798) from S11
[S7] cosine check vs S11: cos=0.6066
[S7] RECEIVED delta(kind=head bytes=1794) from S10
[S7] cosine check vs S10: cos=0.6535
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=6 metric=0.1421 head_norm=0.619369
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.624773e-01
[S7] stored merged vector for next round verification (round=6)
[S7] DEBUG after merge:  round=6 metric=0.1421 head_norm=0.627642 delta_norm=0.162477
[S7] aggregate: ACCEPT kept=['S11', 'S10'] (k=2/2) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=6 metric=0.7015 head_norm=1.380875
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.487704e-01
[S2] stored merged vector for next round verification (round=6)
[S2] DEBUG after merge:  round=6 metric=0.7011 head_norm=1.469584 delta_norm=0.248770
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=6 metric=0.3731 head_norm=1.384522
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.407608e-01
[S8] stored merged vector for next round verification (round=6)
[S8] DEBUG after merge:  round=6 metric=0.3731 head_norm=1.427341 delta_norm=0.140761
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=6 metric=0.5174 head_norm=0.837400
[S10] _apply_head_vector_avg (torch): Δ‖w‖=7.605312e-01
[S10] stored merged vector for next round verification (round=6)
[S10] DEBUG after merge:  round=6 metric=0.3865 head_norm=0.851834 delta_norm=0.760531
[S10] aggregate: ROLLBACK (f1_val pre=0.517 post=0.386 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=6 metric=0.4165 head_norm=1.091360
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.897215e-01
[S15] stored merged vector for next round verification (round=6)
[S15] DEBUG after merge:  round=6 metric=0.4165 head_norm=0.961093 delta_norm=0.389721
[S15] aggregate: ACCEPT kept=['S3', 'S13'] (k=2/2) mode=median trim_p=0.1
[S2] START round=7 head_norm_before_train=1.469584 cos_to_last_merge=1.0000 (last merge round=6)
[S2] round=7 local utility u=0.000000 metrics={'f1_val': 0.7003119064471419, 'auprc': 0.6627214880295281, 'loss_val': 0.6156698119982467, 'psi': 0.6852757390800964}-{'f1_val': 0.7015109138377981, 'auprc': 0.7116863819181798, 'loss_val': 0.7465946292785418, 'psi': 0.7055811010699508}
[S3] START round=7 head_norm_before_train=1.317600 (no previous merge yet)
[S3] round=7 local utility u=0.001904 metrics={'f1_val': 0.396483704974271, 'auprc': 0.8346317526732032, 'loss_val': 0.92924755897307, 'psi': 0.5717429240538439}-{'f1_val': 0.4076089163011673, 'auprc': 0.8609127656871394, 'loss_val': 1.0786499971322963, 'psi': 0.5889304560555562}
[S4] START round=7 head_norm_before_train=1.592580 (no previous merge yet)
[S4] round=7 local utility u=0.847308 metrics={'f1_val': 0.9440257178517757, 'auprc': 0.9437030575118185, 'loss_val': 0.49451240941250074, 'psi': 0.9438966537157928}-{'f1_val': 0.6650828274222297, 'auprc': 0.9344894457261592, 'loss_val': 0.4878303881231057, 'psi': 0.7728454747438016}
[S5] START round=7 head_norm_before_train=1.364173 (no previous merge yet)
[S5] round=7 local utility u=0.100445 metrics={'f1_val': 0.4176671856330787, 'auprc': 0.7947493197889587, 'loss_val': 0.7998190159609309, 'psi': 0.5685000392954307}-{'f1_val': 0.4179091272005397, 'auprc': 0.7764657954477964, 'loss_val': 0.9473107352666343, 'psi': 0.5613317944994424}
[S6] START round=7 head_norm_before_train=1.482340 (no previous merge yet)
[S6] round=7 local utility u=0.038146 metrics={'f1_val': 0.7112916357900456, 'auprc': 0.7938312925512807, 'loss_val': 0.426686698719951, 'psi': 0.7443074984945397}-{'f1_val': 0.7136516776548333, 'auprc': 0.7937242916133711, 'loss_val': 0.5168182680337694, 'psi': 0.7456807232382484}
[S7] START round=7 head_norm_before_train=0.627642 cos_to_last_merge=1.0000 (last merge round=6)
[S7] round=7 local utility u=0.304991 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7769721033792027, 'loss_val': 1.2518962342896758, 'psi': 0.3960229349891361}-{'f1_val': 0.14205682272909165, 'auprc': 0.5795057407720575, 'loss_val': 1.2694797580408104, 'psi': 0.31703638994627803}
[S8] START round=7 head_norm_before_train=1.427341 cos_to_last_merge=1.0000 (last merge round=6)
[S8] round=7 local utility u=0.294399 metrics={'f1_val': 0.3734663743501038, 'auprc': 0.9857006578581602, 'loss_val': 0.5440033525891161, 'psi': 0.6183600877533264}-{'f1_val': 0.37306554171580314, 'auprc': 0.8664577448328464, 'loss_val': 0.7726670436498188, 'psi': 0.5704224229626205}
[S9] START round=7 head_norm_before_train=0.988750 cos_to_last_merge=0.9623 (last merge round=2)
[S9] round=7 local utility u=1.000000 metrics={'f1_val': 0.7002607581974862, 'auprc': 0.9998225949751146, 'loss_val': 0.7873537934356349, 'psi': 0.8200854929085376}-{'f1_val': 0.141397957139996, 'auprc': 0.9677447030387407, 'loss_val': 0.9568687159078588, 'psi': 0.47193665549949393}
[S10] START round=7 head_norm_before_train=0.851834 cos_to_last_merge=1.0000 (last merge round=6)
[S10] round=7 local utility u=0.571728 metrics={'f1_val': 0.701236798752475, 'auprc': 0.9516001712217323, 'loss_val': 0.6124563820618242, 'psi': 0.8013821477401779}-{'f1_val': 0.5173773745777791, 'auprc': 0.957367094905342, 'loss_val': 0.6700573381778996, 'psi': 0.6933732627088043}
[S11] START round=7 head_norm_before_train=1.054260 cos_to_last_merge=0.9434 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.943
[S11] round=7 local utility u=0.347523 metrics={'f1_val': 0.3910974264933649, 'auprc': 0.9962807554042311, 'loss_val': 0.776219382956871, 'psi': 0.6331707580577114}-{'f1_val': 0.39651855440916606, 'auprc': 0.7946686908340719, 'loss_val': 0.8989551905755463, 'psi': 0.5557786089791283}
[S13] START round=7 head_norm_before_train=1.455296 (no previous merge yet)
[S13] round=7 local utility u=0.000000 metrics={'f1_val': 0.5804121962861738, 'auprc': 0.8011458656184062, 'loss_val': 0.6419757435392364, 'psi': 0.6687056640190667}-{'f1_val': 0.7116895582362373, 'auprc': 0.751678766926768, 'loss_val': 0.4947529814204599, 'psi': 0.7276852417124495}
[S14] START round=7 head_norm_before_train=1.354911 (no previous merge yet)
[S14] round=7 local utility u=0.255910 metrics={'f1_val': 0.39157364782119924, 'auprc': 0.9410354219714058, 'loss_val': 0.8301582520128612, 'psi': 0.6113583574812819}-{'f1_val': 0.39659360338126215, 'auprc': 0.8223819587757099, 'loss_val': 1.0161382123161862, 'psi': 0.5669089455390413}
[S15] START round=7 head_norm_before_train=0.961093 cos_to_last_merge=1.0000 (last merge round=6)
[S15] round=7 local utility u=0.592335 metrics={'f1_val': 0.5725435900652367, 'auprc': 0.8407657012943492, 'loss_val': 0.7744736564658401, 'psi': 0.6798324345568817}-{'f1_val': 0.41653611723511863, 'auprc': 0.7976422399940818, 'loss_val': 0.8937285420609145, 'psi': 0.5689785663387039}
[S16] START round=7 head_norm_before_train=1.024983 cos_to_last_merge=0.9402 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.940
[S16] round=7 local utility u=0.051872 metrics={'f1_val': 0.3839912614612282, 'auprc': 0.7555473065475564, 'loss_val': 0.9293472334625283, 'psi': 0.5326136794957596}-{'f1_val': 0.38460972536536436, 'auprc': 0.7599114107546268, 'loss_val': 1.0498951449034084, 'psi': 0.5347303995210693}
[S17] START round=7 head_norm_before_train=1.219097 cos_to_last_merge=0.8908 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.891
[S17] round=7 local utility u=0.481415 metrics={'f1_val': 0.39077719641068737, 'auprc': 0.8637480143814118, 'loss_val': 0.6934436816004967, 'psi': 0.5799655235989771}-{'f1_val': 0.3459036797490703, 'auprc': 0.7478663359277568, 'loss_val': 1.0393872124562589, 'psi': 0.5066887422205449}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S2@127.0.0.1:39402
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S3] → sending delta(kind=head bytes=1792) to S15@127.0.0.1:39415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:39408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S16] → sending delta(kind=head bytes=1791) to S6@127.0.0.1:39407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:39409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:39403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:39408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:39410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:39407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] → sending delta(kind=head bytes=1792) to S10@127.0.0.1:39411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:39403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:39415
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S15] sending update (kind=head size=1792 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1791 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1792 to 1 peers)
[S4] sending update (kind=head size=1803 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1796) from S11
[S7] cosine check vs S11: cos=0.6902
[S7] RECEIVED delta(kind=head bytes=1800) from S10
[S7] cosine check vs S10: cos=0.4886
[S6] RECEIVED delta(kind=head bytes=1799) from S14
[S6] cosine check vs S14: cos=-0.0534
[S6] DROPPED delta from S14 (cos=-0.0534 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1791) from S16
[S6] cosine check vs S16: cos=-0.0278
[S6] DROPPED delta from S16 (cos=-0.0278 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1803) from S4
[S2] cosine check vs S4: cos=0.9705
[S10] RECEIVED delta(kind=head bytes=1792) from S15
[S10] cosine check vs S15: cos=0.3487
[S15] RECEIVED delta(kind=head bytes=1792) from S3
[S15] cosine check vs S3: cos=0.3529
[S8] RECEIVED delta(kind=head bytes=1798) from S6
[S8] cosine check vs S6: cos=0.9885
[S3] RECEIVED delta(kind=head bytes=1795) from S9
[S3] cosine check vs S9: cos=-0.0694
[S3] DROPPED delta from S9 (cos=-0.0694 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1799) from S5
[S9] cosine check vs S5: cos=-0.0357
[S9] DROPPED delta from S5 (cos=-0.0357 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1803) from S8
[S3] cosine check vs S8: cos=-0.1481
[S3] DROPPED delta from S8 (cos=-0.1481 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1801) from S7
[S15] cosine check vs S7: cos=0.3061
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:39409
[S17] sending update (kind=head size=1799 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1799) from S17
[S8] cosine check vs S17: cos=-0.0200
[S8] DROPPED delta from S17 (cos=-0.0200 < 0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=7 metric=0.7003 head_norm=1.531538
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.006040e-01
[S2] stored merged vector for next round verification (round=7)
[S2] DEBUG after merge:  round=7 metric=0.6998 head_norm=1.575917 delta_norm=0.200604
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=7 metric=0.3735 head_norm=1.485518
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.186005e-01
[S8] stored merged vector for next round verification (round=7)
[S8] DEBUG after merge:  round=7 metric=0.3752 head_norm=1.511152 delta_norm=0.118601
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=7 metric=0.7012 head_norm=0.936741
[S10] _apply_head_vector_avg (torch): Δ‖w‖=5.619056e-01
[S10] stored merged vector for next round verification (round=7)
[S10] DEBUG after merge:  round=7 metric=0.6978 head_norm=0.807196 delta_norm=0.561906
[S10] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=7 metric=0.1421 head_norm=0.646752
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.161548e-01
[S7] stored merged vector for next round verification (round=7)
[S7] DEBUG after merge:  round=7 metric=0.1421 head_norm=0.664416 delta_norm=0.216155
[S7] aggregate: ACCEPT kept=['S11', 'S10'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=7 metric=0.5725 head_norm=1.028164
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.849070e-01
[S15] stored merged vector for next round verification (round=7)
[S15] DEBUG after merge:  round=7 metric=0.7145 head_norm=0.762856 delta_norm=0.484907
[S15] aggregate: ACCEPT kept=['S3', 'S7'] (k=2/2) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=1.575917 cos_to_last_merge=1.0000 (last merge round=7)
[S2] round=8 local utility u=0.143067 metrics={'f1_val': 0.7000513605313681, 'auprc': 0.7236598751542855, 'loss_val': 0.5107872930905369, 'psi': 0.7094947663805351}-{'f1_val': 0.7003119064471419, 'auprc': 0.6627214880295281, 'loss_val': 0.6156698119982467, 'psi': 0.6852757390800964}
[S3] START round=8 head_norm_before_train=1.350676 (no previous merge yet)
[S3] round=8 local utility u=0.690364 metrics={'f1_val': 0.5476104092250867, 'auprc': 0.9468875745471961, 'loss_val': 0.7920472035957069, 'psi': 0.7073212753539304}-{'f1_val': 0.396483704974271, 'auprc': 0.8346317526732032, 'loss_val': 0.92924755897307, 'psi': 0.5717429240538439}
[S4] START round=8 head_norm_before_train=1.643747 (no previous merge yet)
[S4] round=8 local utility u=0.000000 metrics={'f1_val': 0.6658804114251845, 'auprc': 0.9209425247001495, 'loss_val': 0.41355574393762756, 'psi': 0.7679052567351705}-{'f1_val': 0.9440257178517757, 'auprc': 0.9437030575118185, 'loss_val': 0.49451240941250074, 'psi': 0.9438966537157928}
[S5] START round=8 head_norm_before_train=1.395539 (no previous merge yet)
[S5] round=8 local utility u=0.878217 metrics={'f1_val': 0.7148917047076433, 'auprc': 0.7623010218795035, 'loss_val': 0.7293866879191592, 'psi': 0.7338554315763874}-{'f1_val': 0.4176671856330787, 'auprc': 0.7947493197889587, 'loss_val': 0.7998190159609309, 'psi': 0.5685000392954307}
[S6] START round=8 head_norm_before_train=1.545487 (no previous merge yet)
[S6] round=8 local utility u=0.000000 metrics={'f1_val': 0.6848528104000366, 'auprc': 0.7636976684564731, 'loss_val': 0.5518453601668873, 'psi': 0.7163907536226113}-{'f1_val': 0.7112916357900456, 'auprc': 0.7938312925512807, 'loss_val': 0.426686698719951, 'psi': 0.7443074984945397}
[S7] START round=8 head_norm_before_train=0.664416 cos_to_last_merge=1.0000 (last merge round=7)
[S7] round=8 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7344582112947878, 'loss_val': 1.2034532248574077, 'psi': 0.3790173781553701}-{'f1_val': 0.14205682272909165, 'auprc': 0.7769721033792027, 'loss_val': 1.2518962342896758, 'psi': 0.3960229349891361}
[S8] START round=8 head_norm_before_train=1.511152 cos_to_last_merge=1.0000 (last merge round=7)
[S8] round=8 local utility u=1.000000 metrics={'f1_val': 0.9938666393810386, 'auprc': 0.9959337933563706, 'loss_val': 0.3612465652089406, 'psi': 0.9946935009711714}-{'f1_val': 0.3734663743501038, 'auprc': 0.9857006578581602, 'loss_val': 0.5440033525891161, 'psi': 0.6183600877533264}
[S9] START round=8 head_norm_before_train=1.035197 cos_to_last_merge=0.9465 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.946
[S9] round=8 local utility u=0.087351 metrics={'f1_val': 0.701513881536201, 'auprc': 0.9994143045762311, 'loss_val': 0.6189464838668111, 'psi': 0.820674050752213}-{'f1_val': 0.7002607581974862, 'auprc': 0.9998225949751146, 'loss_val': 0.7873537934356349, 'psi': 0.8200854929085376}
[S10] START round=8 head_norm_before_train=0.807196 cos_to_last_merge=1.0000 (last merge round=7)
[S10] round=8 local utility u=0.106033 metrics={'f1_val': 0.6900909708148993, 'auprc': 0.9899420945019329, 'loss_val': 0.4485406206222662, 'psi': 0.8100314202897128}-{'f1_val': 0.701236798752475, 'auprc': 0.9516001712217323, 'loss_val': 0.6124563820618242, 'psi': 0.8013821477401779}
[S11] START round=8 head_norm_before_train=1.105433 cos_to_last_merge=0.9248 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.925
[S11] round=8 local utility u=0.000000 metrics={'f1_val': 0.39996606480610053, 'auprc': 0.8451928344301304, 'loss_val': 0.774552152316192, 'psi': 0.5780567726557124}-{'f1_val': 0.3910974264933649, 'auprc': 0.9962807554042311, 'loss_val': 0.776219382956871, 'psi': 0.6331707580577114}
[S13] START round=8 head_norm_before_train=1.487848 (no previous merge yet)
[S13] round=8 local utility u=0.389271 metrics={'f1_val': 0.7109137403339029, 'auprc': 0.744138020479249, 'loss_val': 0.4754197810886947, 'psi': 0.7242034523920413}-{'f1_val': 0.5804121962861738, 'auprc': 0.8011458656184062, 'loss_val': 0.6419757435392364, 'psi': 0.6687056640190667}
[S14] START round=8 head_norm_before_train=1.395796 (no previous merge yet)
[S14] round=8 local utility u=0.129494 metrics={'f1_val': 0.4213172103875202, 'auprc': 0.9323558370097627, 'loss_val': 0.7235934700993988, 'psi': 0.6257326610364171}-{'f1_val': 0.39157364782119924, 'auprc': 0.9410354219714058, 'loss_val': 0.8301582520128612, 'psi': 0.6113583574812819}
[S15] START round=8 head_norm_before_train=0.762856 cos_to_last_merge=1.0000 (last merge round=7)
[S15] round=8 local utility u=0.998931 metrics={'f1_val': 0.8243101532456877, 'auprc': 0.9767764536987221, 'loss_val': 0.6952432709214748, 'psi': 0.8852966734269014}-{'f1_val': 0.5725435900652367, 'auprc': 0.8407657012943492, 'loss_val': 0.7744736564658401, 'psi': 0.6798324345568817}
[S16] START round=8 head_norm_before_train=1.070685 cos_to_last_merge=0.9184 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.918
[S16] round=8 local utility u=0.012048 metrics={'f1_val': 0.3829160864086098, 'auprc': 0.7523289999632383, 'loss_val': 0.8891459694071825, 'psi': 0.5306812518304612}-{'f1_val': 0.3839912614612282, 'auprc': 0.7555473065475564, 'loss_val': 0.9293472334625283, 'psi': 0.5326136794957596}
[S17] START round=8 head_norm_before_train=1.250825 cos_to_last_merge=0.8798 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.880
[S17] round=8 local utility u=0.000808 metrics={'f1_val': 0.39136353735972695, 'auprc': 0.8563244556276015, 'loss_val': 0.6730757268625576, 'psi': 0.5773479046668768}-{'f1_val': 0.39077719641068737, 'auprc': 0.8637480143814118, 'loss_val': 0.6934436816004967, 'psi': 0.5799655235989771}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:39403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S10] → sending delta(kind=head bytes=1790) to S7@127.0.0.1:39408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:39411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:39407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:39415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:39415
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] → sending delta(kind=head bytes=1794) to S10@127.0.0.1:39411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:39407
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:39410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:39403
[S9] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1794 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1790 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1790) from S10
[S7] cosine check vs S10: cos=0.5532
[S10] RECEIVED delta(kind=head bytes=1794) from S15
[S10] cosine check vs S15: cos=0.7733
[S10] RECEIVED delta(kind=head bytes=1796) from S2
[S10] cosine check vs S2: cos=0.4275
[S9] RECEIVED delta(kind=head bytes=1801) from S5
[S9] cosine check vs S5: cos=-0.0367
[S9] DROPPED delta from S5 (cos=-0.0367 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1797) from S16
[S6] cosine check vs S16: cos=-0.0259
[S6] DROPPED delta from S16 (cos=-0.0259 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1798) from S8
[S3] cosine check vs S8: cos=-0.1505
[S3] DROPPED delta from S8 (cos=-0.1505 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1798) from S3
[S15] cosine check vs S3: cos=0.6305
[S6] RECEIVED delta(kind=head bytes=1798) from S14
[S6] cosine check vs S14: cos=-0.0500
[S6] DROPPED delta from S14 (cos=-0.0500 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1800) from S13
[S15] cosine check vs S13: cos=0.6089
[S3] RECEIVED delta(kind=head bytes=1798) from S9
[S3] cosine check vs S9: cos=-0.0711
[S3] DROPPED delta from S9 (cos=-0.0711 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:39409
[S17] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1800) from S17
[S8] cosine check vs S17: cos=-0.0131
[S8] DROPPED delta from S17 (cos=-0.0131 < 0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=8 metric=0.1421 head_norm=0.680024
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.911053e-01
[S7] stored merged vector for next round verification (round=8)
[S7] DEBUG after merge:  round=8 metric=0.1421 head_norm=0.705285 delta_norm=0.391105
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=8 metric=0.8243 head_norm=0.837892
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.579741e-01
[S15] stored merged vector for next round verification (round=8)
[S15] DEBUG after merge:  round=8 metric=0.9105 head_norm=0.904705 delta_norm=0.257974
[S15] aggregate: ACCEPT kept=['S3', 'S13'] (k=2/2) mode=median trim_p=0.1
[S10] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=8 metric=0.6901 head_norm=0.915614
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.394371e-01
[S10] stored merged vector for next round verification (round=8)
[S10] DEBUG after merge:  round=8 metric=0.6822 head_norm=0.856099 delta_norm=0.339437
[S10] aggregate: ROLLBACK (f1_val pre=0.690 post=0.682 tol_abs=0.005 tol_rel=0.0)
[S2] START round=9 head_norm_before_train=1.640296 cos_to_last_merge=0.9958 (last merge round=7)
[S2] round=9 local utility u=0.000000 metrics={'f1_val': 0.6996105493161282, 'auprc': 0.6561091765145575, 'loss_val': 0.3993029781797823, 'psi': 0.6822100001954999}-{'f1_val': 0.7000513605313681, 'auprc': 0.7236598751542855, 'loss_val': 0.5107872930905369, 'psi': 0.7094947663805351}
[S3] START round=9 head_norm_before_train=1.392743 (no previous merge yet)
[S3] round=9 local utility u=0.000000 metrics={'f1_val': 0.4024484509855121, 'auprc': 0.9977596085339889, 'loss_val': 0.7641033032666426, 'psi': 0.6405729140049028}-{'f1_val': 0.5476104092250867, 'auprc': 0.9468875745471961, 'loss_val': 0.7920472035957069, 'psi': 0.7073212753539304}
[S4] START round=9 head_norm_before_train=1.688086 (no previous merge yet)
[S4] round=9 local utility u=0.900398 metrics={'f1_val': 0.9420230144839844, 'auprc': 0.9534355496665257, 'loss_val': 0.3670948800158703, 'psi': 0.946588028557001}-{'f1_val': 0.6658804114251845, 'auprc': 0.9209425247001495, 'loss_val': 0.41355574393762756, 'psi': 0.7679052567351705}
[S5] START round=9 head_norm_before_train=1.426726 (no previous merge yet)
[S5] round=9 local utility u=0.107015 metrics={'f1_val': 0.714986591715879, 'auprc': 0.7948196761952432, 'loss_val': 0.6134810046892362, 'psi': 0.7469198255076246}-{'f1_val': 0.7148917047076433, 'auprc': 0.7623010218795035, 'loss_val': 0.7293866879191592, 'psi': 0.7338554315763874}
[S6] START round=9 head_norm_before_train=1.598162 (no previous merge yet)
[S6] round=9 local utility u=0.462518 metrics={'f1_val': 0.7105966106954307, 'auprc': 0.9476017890332641, 'loss_val': 0.3329851134535327, 'psi': 0.8053986820305641}-{'f1_val': 0.6848528104000366, 'auprc': 0.7636976684564731, 'loss_val': 0.5518453601668873, 'psi': 0.7163907536226113}
[S7] START round=9 head_norm_before_train=0.705285 cos_to_last_merge=1.0000 (last merge round=8)
[S7] round=9 local utility u=0.579705 metrics={'f1_val': 0.4045306944724949, 'auprc': 0.5749447876619717, 'loss_val': 1.140346425345176, 'psi': 0.4726963317482856}-{'f1_val': 0.14205682272909165, 'auprc': 0.7344582112947878, 'loss_val': 1.2034532248574077, 'psi': 0.3790173781553701}
[S8] START round=9 head_norm_before_train=1.573376 cos_to_last_merge=0.9976 (last merge round=7)
[S8] round=9 local utility u=0.089238 metrics={'f1_val': 0.9969258055879406, 'auprc': 0.9994545859338275, 'loss_val': 0.21168801276665083, 'psi': 0.9979373177262953}-{'f1_val': 0.9938666393810386, 'auprc': 0.9959337933563706, 'loss_val': 0.3612465652089406, 'psi': 0.9946935009711714}
[S9] START round=9 head_norm_before_train=1.091211 cos_to_last_merge=0.9288 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.929
[S9] round=9 local utility u=0.084785 metrics={'f1_val': 0.7016148490515617, 'auprc': 0.9991225727406282, 'loss_val': 0.44910799167639326, 'psi': 0.8206179385271883}-{'f1_val': 0.701513881536201, 'auprc': 0.9994143045762311, 'loss_val': 0.6189464838668111, 'psi': 0.820674050752213}
[S10] START round=9 head_norm_before_train=0.856099 cos_to_last_merge=1.0000 (last merge round=8)
[S10] round=9 local utility u=0.044475 metrics={'f1_val': 0.7136270458370887, 'auprc': 0.9875226419506868, 'loss_val': 0.49354909103971106, 'psi': 0.823185284282528}-{'f1_val': 0.6900909708148993, 'auprc': 0.9899420945019329, 'loss_val': 0.4485406206222662, 'psi': 0.8100314202897128}
[S11] START round=9 head_norm_before_train=1.156461 cos_to_last_merge=0.9069 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.907
[S11] round=9 local utility u=0.148029 metrics={'f1_val': 0.39992541946910537, 'auprc': 0.9277953551052587, 'loss_val': 0.7260585507121415, 'psi': 0.6110733937235666}-{'f1_val': 0.39996606480610053, 'auprc': 0.8451928344301304, 'loss_val': 0.774552152316192, 'psi': 0.5780567726557124}
[S13] START round=9 head_norm_before_train=1.505506 (no previous merge yet)
[S13] round=9 local utility u=0.000000 metrics={'f1_val': 0.6173558199478849, 'auprc': 0.7274315780073893, 'loss_val': 0.5901651274506458, 'psi': 0.6613861231716867}-{'f1_val': 0.7109137403339029, 'auprc': 0.744138020479249, 'loss_val': 0.4754197810886947, 'psi': 0.7242034523920413}
[S14] START round=9 head_norm_before_train=1.439420 (no previous merge yet)
[S14] round=9 local utility u=0.464035 metrics={'f1_val': 0.5214197611329444, 'auprc': 0.9945989061465287, 'loss_val': 0.5828672677907819, 'psi': 0.7106914191383782}-{'f1_val': 0.4213172103875202, 'auprc': 0.9323558370097627, 'loss_val': 0.7235934700993988, 'psi': 0.6257326610364171}
[S15] START round=9 head_norm_before_train=0.904705 cos_to_last_merge=1.0000 (last merge round=8)
[S15] round=9 local utility u=0.000000 metrics={'f1_val': 0.5959869961824013, 'auprc': 0.8632749956905661, 'loss_val': 0.6945564276023024, 'psi': 0.7029021959856672}-{'f1_val': 0.8243101532456877, 'auprc': 0.9767764536987221, 'loss_val': 0.6952432709214748, 'psi': 0.8852966734269014}
[S16] START round=9 head_norm_before_train=1.115098 cos_to_last_merge=0.8954 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.895
[S16] round=9 local utility u=0.033112 metrics={'f1_val': 0.38509683073350054, 'auprc': 0.7583460679859054, 'loss_val': 0.8540576531224353, 'psi': 0.5343965256344625}-{'f1_val': 0.3829160864086098, 'auprc': 0.7523289999632383, 'loss_val': 0.8891459694071825, 'psi': 0.5306812518304612}
[S17] START round=9 head_norm_before_train=1.278798 cos_to_last_merge=0.8721 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.872
[S17] round=9 local utility u=0.000000 metrics={'f1_val': 0.3862756898680145, 'auprc': 0.7935875643185457, 'loss_val': 0.8054822032421821, 'psi': 0.5492004396482271}-{'f1_val': 0.39136353735972695, 'auprc': 0.8563244556276015, 'loss_val': 0.6730757268625576, 'psi': 0.5773479046668768}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S10] → sending delta(kind=head bytes=1786) to S7@127.0.0.1:39408
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:39402
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:39408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S8] → sending delta(kind=head bytes=1807) to S3@127.0.0.1:39403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:39415
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:39410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:39403
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:39407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:39409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:39407
[S6] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1807 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1786 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1799) from S7
[S15] cosine check vs S7: cos=0.6155
[S7] RECEIVED delta(kind=head bytes=1802) from S11
[S7] cosine check vs S11: cos=0.3671
[S7] RECEIVED delta(kind=head bytes=1786) from S10
[S7] cosine check vs S10: cos=0.8896
[S6] RECEIVED delta(kind=head bytes=1803) from S14
[S6] cosine check vs S14: cos=-0.0474
[S6] DROPPED delta from S14 (cos=-0.0474 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1801) from S4
[S2] cosine check vs S4: cos=0.9625
[S8] RECEIVED delta(kind=head bytes=1799) from S6
[S8] cosine check vs S6: cos=0.9861
[S9] RECEIVED delta(kind=head bytes=1800) from S5
[S9] cosine check vs S5: cos=-0.0395
[S9] DROPPED delta from S5 (cos=-0.0395 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1798) from S16
[S6] cosine check vs S16: cos=-0.0248
[S6] DROPPED delta from S16 (cos=-0.0248 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1795) from S9
[S3] cosine check vs S9: cos=-0.0732
[S3] DROPPED delta from S9 (cos=-0.0732 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1807) from S8
[S3] cosine check vs S8: cos=-0.1516
[S3] DROPPED delta from S8 (cos=-0.1516 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=9 metric=0.6996 head_norm=1.708819
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.345937e-01
[S2] stored merged vector for next round verification (round=9)
[S2] DEBUG after merge:  round=9 metric=0.6996 head_norm=1.697403 delta_norm=0.234594
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=9 metric=0.9969 head_norm=1.628014
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.359707e-01
[S8] stored merged vector for next round verification (round=9)
[S8] DEBUG after merge:  round=9 metric=0.9969 head_norm=1.623801 delta_norm=0.135971
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=9 metric=0.4045 head_norm=0.718569
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.327255e-01
[S7] stored merged vector for next round verification (round=9)
[S7] DEBUG after merge:  round=9 metric=0.4163 head_norm=0.717339 delta_norm=0.232726
[S7] aggregate: ACCEPT kept=['S11', 'S10'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=9 metric=0.5960 head_norm=0.976496
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.892878e-01
[S15] stored merged vector for next round verification (round=9)
[S15] DEBUG after merge:  round=9 metric=0.7145 head_norm=0.763805 delta_norm=0.389288
[S15] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=1.697403 cos_to_last_merge=1.0000 (last merge round=9)
[S2] round=10 local utility u=0.149496 metrics={'f1_val': 0.7017379166026221, 'auprc': 0.7610933861838971, 'loss_val': 0.42802738051567013, 'psi': 0.7254801044351321}-{'f1_val': 0.6996105493161282, 'auprc': 0.6561091765145575, 'loss_val': 0.3993029781797823, 'psi': 0.6822100001954999}
[S3] START round=10 head_norm_before_train=1.438878 (no previous merge yet)
[S3] round=10 local utility u=0.262117 metrics={'f1_val': 0.4698106880455007, 'auprc': 0.9979215533377434, 'loss_val': 0.6445283366993287, 'psi': 0.6810550341623978}-{'f1_val': 0.4024484509855121, 'auprc': 0.9977596085339889, 'loss_val': 0.7641033032666426, 'psi': 0.6405729140049028}
[S4] START round=10 head_norm_before_train=1.718244 (no previous merge yet)
[S4] round=10 local utility u=0.000000 metrics={'f1_val': 0.9412123515558062, 'auprc': 0.9386986598235038, 'loss_val': 0.3612286490359263, 'psi': 0.9402068748628851}-{'f1_val': 0.9420230144839844, 'auprc': 0.9534355496665257, 'loss_val': 0.3670948800158703, 'psi': 0.946588028557001}
[S5] START round=10 head_norm_before_train=1.461490 (no previous merge yet)
[S5] round=10 local utility u=0.030844 metrics={'f1_val': 0.7096550932275287, 'auprc': 0.794838041202119, 'loss_val': 0.519859738483143, 'psi': 0.7437282724173648}-{'f1_val': 0.714986591715879, 'auprc': 0.7948196761952432, 'loss_val': 0.6134810046892362, 'psi': 0.7469198255076246}
[S6] START round=10 head_norm_before_train=1.630953 (no previous merge yet)
[S6] round=10 local utility u=0.023297 metrics={'f1_val': 0.709766858737967, 'auprc': 0.9557435977263893, 'loss_val': 0.3058384133437159, 'psi': 0.8081575543333359}-{'f1_val': 0.7105966106954307, 'auprc': 0.9476017890332641, 'loss_val': 0.3329851134535327, 'psi': 0.8053986820305641}
[S7] START round=10 head_norm_before_train=0.717339 cos_to_last_merge=1.0000 (last merge round=9)
[S7] round=10 local utility u=0.070908 metrics={'f1_val': 0.4172807768329403, 'auprc': 0.5745795424457093, 'loss_val': 1.0739343225564035, 'psi': 0.48020028307804785}-{'f1_val': 0.4045306944724949, 'auprc': 0.5749447876619717, 'loss_val': 1.140346425345176, 'psi': 0.4726963317482856}
[S8] START round=10 head_norm_before_train=1.623801 cos_to_last_merge=1.0000 (last merge round=9)
[S8] round=10 local utility u=0.000000 metrics={'f1_val': 0.989330400594974, 'auprc': 0.9982450535519594, 'loss_val': 0.18430923573475944, 'psi': 0.9928962617777681}-{'f1_val': 0.9969258055879406, 'auprc': 0.9994545859338275, 'loss_val': 0.21168801276665083, 'psi': 0.9979373177262953}
[S9] START round=10 head_norm_before_train=1.150966 cos_to_last_merge=0.9117 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.912
[S9] round=10 local utility u=0.046864 metrics={'f1_val': 0.7016148490515617, 'auprc': 0.9990205167095999, 'loss_val': 0.3550729951813215, 'psi': 0.820577116114777}-{'f1_val': 0.7016148490515617, 'auprc': 0.9991225727406282, 'loss_val': 0.44910799167639326, 'psi': 0.8206179385271883}
[S10] START round=10 head_norm_before_train=0.946321 cos_to_last_merge=0.9905 (last merge round=8)
[S10] round=10 local utility u=0.951526 metrics={'f1_val': 0.9933985882335752, 'auprc': 0.9944421368391999, 'loss_val': 0.2898840392900631, 'psi': 0.9938160076758251}-{'f1_val': 0.7136270458370887, 'auprc': 0.9875226419506868, 'loss_val': 0.49354909103971106, 'psi': 0.823185284282528}
[S11] START round=10 head_norm_before_train=1.197736 cos_to_last_merge=0.8933 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.893
[S11] round=10 local utility u=0.122761 metrics={'f1_val': 0.39992541946910537, 'auprc': 0.9987435934023678, 'loss_val': 0.6933804778298461, 'psi': 0.6394526890424104}-{'f1_val': 0.39992541946910537, 'auprc': 0.9277953551052587, 'loss_val': 0.7260585507121415, 'psi': 0.6110733937235666}
[S13] START round=10 head_norm_before_train=1.528107 (no previous merge yet)
[S13] round=10 local utility u=0.000000 metrics={'f1_val': 0.5863512759828085, 'auprc': 0.718936345770786, 'loss_val': 0.6699216663707098, 'psi': 0.6393853038979995}-{'f1_val': 0.6173558199478849, 'auprc': 0.7274315780073893, 'loss_val': 0.5901651274506458, 'psi': 0.6613861231716867}
[S14] START round=10 head_norm_before_train=1.485473 (no previous merge yet)
[S14] round=10 local utility u=0.074296 metrics={'f1_val': 0.5265776588025708, 'auprc': 0.9959681266045726, 'loss_val': 0.4693312116493676, 'psi': 0.7143338459233715}-{'f1_val': 0.5214197611329444, 'auprc': 0.9945989061465287, 'loss_val': 0.5828672677907819, 'psi': 0.7106914191383782}
[S15] START round=10 head_norm_before_train=0.763805 cos_to_last_merge=1.0000 (last merge round=9)
[S15] round=10 local utility u=0.295203 metrics={'f1_val': 0.7108894818106866, 'auprc': 0.8227603230207166, 'loss_val': 0.6720216999628992, 'psi': 0.7556378182946986}-{'f1_val': 0.5959869961824013, 'auprc': 0.8632749956905661, 'loss_val': 0.6945564276023024, 'psi': 0.7029021959856672}
[S16] START round=10 head_norm_before_train=1.156430 cos_to_last_merge=0.8756 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.876
[S16] round=10 local utility u=0.063119 metrics={'f1_val': 0.38580359402762504, 'auprc': 0.766786242081662, 'loss_val': 0.7573807111766749, 'psi': 0.5381966532492398}-{'f1_val': 0.38509683073350054, 'auprc': 0.7583460679859054, 'loss_val': 0.8540576531224353, 'psi': 0.5343965256344625}
[S17] START round=10 head_norm_before_train=1.302780 cos_to_last_merge=0.8663 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.866
[S17] round=10 local utility u=0.158757 metrics={'f1_val': 0.39919169556568657, 'auprc': 0.8394508706567096, 'loss_val': 0.7030550122799147, 'psi': 0.5752953656020958}-{'f1_val': 0.3862756898680145, 'auprc': 0.7935875643185457, 'loss_val': 0.8054822032421821, 'psi': 0.5492004396482271}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:39415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:39408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:39407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:39409
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] → sending delta(kind=head bytes=1794) to S6@127.0.0.1:39407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S10@127.0.0.1:39411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:39411
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:39408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:39415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:39410
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:39403
[S9] sending update (kind=head size=1795 to 1 peers)
[S3] sending update (kind=head size=1803 to 1 peers)
[S2] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1804 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1794 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1796) from S2
[S10] cosine check vs S2: cos=0.6316
[S10] RECEIVED delta(kind=head bytes=1804) from S15
[S10] cosine check vs S15: cos=0.8014
[S8] RECEIVED delta(kind=head bytes=1797) from S6
[S8] cosine check vs S6: cos=0.9927
[S15] RECEIVED delta(kind=head bytes=1803) from S3
[S15] cosine check vs S3: cos=0.4490
[S15] RECEIVED delta(kind=head bytes=1799) from S7
[S15] cosine check vs S7: cos=0.7669
[S9] RECEIVED delta(kind=head bytes=1799) from S5
[S9] cosine check vs S5: cos=-0.0427
[S9] DROPPED delta from S5 (cos=-0.0427 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1802) from S11
[S7] cosine check vs S11: cos=0.6076
[S7] RECEIVED delta(kind=head bytes=1800) from S10
[S7] cosine check vs S10: cos=0.8007
[S6] RECEIVED delta(kind=head bytes=1794) from S16
[S6] cosine check vs S16: cos=-0.0223
[S6] DROPPED delta from S16 (cos=-0.0223 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1803) from S14
[S6] cosine check vs S14: cos=-0.0462
[S6] DROPPED delta from S14 (cos=-0.0462 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1795) from S9
[S3] cosine check vs S9: cos=-0.0749
[S3] DROPPED delta from S9 (cos=-0.0749 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:39409
[S17] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1801) from S17
[S8] cosine check vs S17: cos=-0.0082
[S8] DROPPED delta from S17 (cos=-0.0082 < 0.0)
[S4] ⇄ pheromone p=0.457 → S2@127.0.0.1:39402
[S13] ⇄ pheromone p=0.272 → S15@127.0.0.1:39415
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=10 metric=0.9893 head_norm=1.677273
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.009957e-01
[S8] stored merged vector for next round verification (round=10)
[S8] DEBUG after merge:  round=10 metric=0.9893 head_norm=1.667495 delta_norm=0.100996
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.371 → S3@127.0.0.1:39403
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=10 metric=0.4173 head_norm=0.738289
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.311383e-01
[S7] stored merged vector for next round verification (round=10)
[S7] DEBUG after merge:  round=10 metric=0.4173 head_norm=0.773979 delta_norm=0.131138
[S7] aggregate: ACCEPT kept=['S11', 'S10'] (k=2/2) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.247 → S15@127.0.0.1:39415
[S11] ⇄ pheromone p=0.279 → S7@127.0.0.1:39408
[S3] ⇄ pheromone p=0.344 → S15@127.0.0.1:39415
[S6] ⇄ pheromone p=0.317 → S8@127.0.0.1:39409
[S5] ⇄ pheromone p=0.323 → S9@127.0.0.1:39410
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=10 metric=0.7109 head_norm=0.849751
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.319739e-01
[S15] stored merged vector for next round verification (round=10)
[S15] DEBUG after merge:  round=10 metric=0.7072 head_norm=0.796848 delta_norm=0.331974
[S15] aggregate: ACCEPT kept=['S3', 'S7'] (k=2/2) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.430 → S10@127.0.0.1:39411
[S16] ⇄ pheromone p=0.195 → S6@127.0.0.1:39407
[S14] ⇄ pheromone p=0.328 → S6@127.0.0.1:39407
[S10] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=10 metric=0.9934 head_norm=1.033515
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.742265e-01
[S10] stored merged vector for next round verification (round=10)
[S10] DEBUG after merge:  round=10 metric=0.9932 head_norm=0.999093 delta_norm=0.274226
[S10] aggregate: ACCEPT kept=['S2', 'S15'] (k=2/2) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.491 → S7@127.0.0.1:39408
[S9] ⇄ pheromone p=0.263 → S3@127.0.0.1:39403
[S2] ⇄ pheromone p=0.236 → S10@127.0.0.1:39411
[S17] ⇄ pheromone p=0.228 → S8@127.0.0.1:39409
[S2] START round=11 head_norm_before_train=1.749782 cos_to_last_merge=0.9986 (last merge round=9)
[S2] round=11 local utility u=0.000000 metrics={'f1_val': 0.6983478455883432, 'auprc': 0.6563663211768518, 'loss_val': 0.3713792393209422, 'psi': 0.6815552358237467}-{'f1_val': 0.7017379166026221, 'auprc': 0.7610933861838971, 'loss_val': 0.42802738051567013, 'psi': 0.7254801044351321}
[S3] START round=11 head_norm_before_train=1.489825 (no previous merge yet)
[S3] round=11 local utility u=0.000000 metrics={'f1_val': 0.4715325553516389, 'auprc': 0.971460077845609, 'loss_val': 0.6490100083188537, 'psi': 0.6715035643492269}-{'f1_val': 0.4698106880455007, 'auprc': 0.9979215533377434, 'loss_val': 0.6445283366993287, 'psi': 0.6810550341623978}
[S4] START round=11 head_norm_before_train=1.746441 (no previous merge yet)
[S4] round=11 local utility u=0.107946 metrics={'f1_val': 0.9553051786580435, 'auprc': 0.9582495195264473, 'loss_val': 0.2885463897536056, 'psi': 0.956482915005405}-{'f1_val': 0.9412123515558062, 'auprc': 0.9386986598235038, 'loss_val': 0.3612286490359263, 'psi': 0.9402068748628851}
[S5] START round=11 head_norm_before_train=1.499565 (no previous merge yet)
[S5] round=11 local utility u=0.000000 metrics={'f1_val': 0.7008168588441903, 'auprc': 0.7917449455251703, 'loss_val': 0.4605925319901932, 'psi': 0.7371880935165823}-{'f1_val': 0.7096550932275287, 'auprc': 0.794838041202119, 'loss_val': 0.519859738483143, 'psi': 0.7437282724173648}
[S6] START round=11 head_norm_before_train=1.663801 (no previous merge yet)
[S6] round=11 local utility u=0.011130 metrics={'f1_val': 0.7103768425516556, 'auprc': 0.9557430159077215, 'loss_val': 0.2872370927987574, 'psi': 0.808523311894082}-{'f1_val': 0.709766858737967, 'auprc': 0.9557435977263893, 'loss_val': 0.3058384133437159, 'psi': 0.8081575543333359}
[S7] START round=11 head_norm_before_train=0.773979 cos_to_last_merge=1.0000 (last merge round=10)
[S7] round=11 local utility u=0.133280 metrics={'f1_val': 0.41703542715461484, 'auprc': 0.6407715947843622, 'loss_val': 1.0044776570759943, 'psi': 0.5065298942065137}-{'f1_val': 0.4172807768329403, 'auprc': 0.5745795424457093, 'loss_val': 1.0739343225564035, 'psi': 0.48020028307804785}
[S8] START round=11 head_norm_before_train=1.667495 cos_to_last_merge=1.0000 (last merge round=10)
[S8] round=11 local utility u=0.053756 metrics={'f1_val': 0.9966394137733288, 'auprc': 0.9993309426336225, 'loss_val': 0.12390895003471107, 'psi': 0.9977160253174462}-{'f1_val': 0.989330400594974, 'auprc': 0.9982450535519594, 'loss_val': 0.18430923573475944, 'psi': 0.9928962617777681}
[S9] START round=11 head_norm_before_train=1.211729 cos_to_last_merge=0.8956 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.896
[S9] round=11 local utility u=0.021379 metrics={'f1_val': 0.7015406642019387, 'auprc': 0.9985158817114869, 'loss_val': 0.3103560435970622, 'psi': 0.820330751205758}-{'f1_val': 0.7016148490515617, 'auprc': 0.9990205167095999, 'loss_val': 0.3550729951813215, 'psi': 0.820577116114777}
[S10] START round=11 head_norm_before_train=0.999093 cos_to_last_merge=1.0000 (last merge round=10)
[S10] round=11 local utility u=0.000000 metrics={'f1_val': 0.9943096789853013, 'auprc': 0.9923002955245924, 'loss_val': 0.2907093587000463, 'psi': 0.9935059256010177}-{'f1_val': 0.9933985882335752, 'auprc': 0.9944421368391999, 'loss_val': 0.2898840392900631, 'psi': 0.9938160076758251}
[S11] START round=11 head_norm_before_train=1.232234 cos_to_last_merge=0.8822 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.882
[S11] round=11 local utility u=0.614792 metrics={'f1_val': 0.5837623433681103, 'auprc': 0.9982484828528002, 'loss_val': 0.5653319955118854, 'psi': 0.7495567991619863}-{'f1_val': 0.39992541946910537, 'auprc': 0.9987435934023678, 'loss_val': 0.6933804778298461, 'psi': 0.6394526890424104}
[S13] START round=11 head_norm_before_train=1.556014 (no previous merge yet)
[S13] round=11 local utility u=0.000000 metrics={'f1_val': 0.5956694681017338, 'auprc': 0.5509597333358706, 'loss_val': 0.7323644228059156, 'psi': 0.5777855741953886}-{'f1_val': 0.5863512759828085, 'auprc': 0.718936345770786, 'loss_val': 0.6699216663707098, 'psi': 0.6393853038979995}
[S14] START round=11 head_norm_before_train=1.516129 (no previous merge yet)
[S14] round=11 local utility u=0.443000 metrics={'f1_val': 0.6753710816587092, 'auprc': 0.9972359132657939, 'loss_val': 0.4798941494799959, 'psi': 0.804117014301543}-{'f1_val': 0.5265776588025708, 'auprc': 0.9959681266045726, 'loss_val': 0.4693312116493676, 'psi': 0.7143338459233715}
[S15] START round=11 head_norm_before_train=0.796848 cos_to_last_merge=1.0000 (last merge round=10)
[S15] round=11 local utility u=0.028945 metrics={'f1_val': 0.7298011315508568, 'auprc': 0.8054511373936044, 'loss_val': 0.6756735728753273, 'psi': 0.7600611338879559}-{'f1_val': 0.7108894818106866, 'auprc': 0.8227603230207166, 'loss_val': 0.6720216999628992, 'psi': 0.7556378182946986}
[S16] START round=11 head_norm_before_train=1.199332 cos_to_last_merge=0.8578 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.858
[S16] round=11 local utility u=0.180999 metrics={'f1_val': 0.43752092479463833, 'auprc': 0.7761848882983873, 'loss_val': 0.7338827686822589, 'psi': 0.572986510196138}-{'f1_val': 0.38580359402762504, 'auprc': 0.766786242081662, 'loss_val': 0.7573807111766749, 'psi': 0.5381966532492398}
[S17] START round=11 head_norm_before_train=1.335135 cos_to_last_merge=0.8623 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.862
[S17] round=11 local utility u=0.585916 metrics={'f1_val': 0.5902595864568672, 'auprc': 0.8613597667579185, 'loss_val': 0.7433566374086075, 'psi': 0.6986996585772878}-{'f1_val': 0.39919169556568657, 'auprc': 0.8394508706567096, 'loss_val': 0.7030550122799147, 'psi': 0.5752953656020958}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:39408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S16] → sending delta(kind=head bytes=1792) to S6@127.0.0.1:39407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:39403
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:39407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:39403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:39415
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:39411
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:39409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S2@127.0.0.1:39402
[S6] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1794 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1792 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S4] sending update (kind=head size=1803 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1803) from S11
[S7] cosine check vs S11: cos=0.6878
[S6] RECEIVED delta(kind=head bytes=1800) from S14
[S6] cosine check vs S14: cos=-0.0457
[S6] DROPPED delta from S14 (cos=-0.0457 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1792) from S16
[S6] cosine check vs S16: cos=-0.0205
[S6] DROPPED delta from S16 (cos=-0.0205 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1801) from S8
[S3] cosine check vs S8: cos=-0.1523
[S3] DROPPED delta from S8 (cos=-0.1523 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1803) from S4
[S2] cosine check vs S4: cos=0.9725
[S10] RECEIVED delta(kind=head bytes=1797) from S15
[S10] cosine check vs S15: cos=0.6556
[S15] RECEIVED delta(kind=head bytes=1797) from S7
[S15] cosine check vs S7: cos=0.6627
[S8] RECEIVED delta(kind=head bytes=1798) from S6
[S8] cosine check vs S6: cos=0.9949
[S3] RECEIVED delta(kind=head bytes=1794) from S9
[S3] cosine check vs S9: cos=-0.0771
[S3] DROPPED delta from S9 (cos=-0.0771 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:39409
[S17] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1801) from S17
[S8] cosine check vs S17: cos=-0.0046
[S8] DROPPED delta from S17 (cos=-0.0046 < 0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=11 metric=0.6983 head_norm=1.795425
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.094590e-01
[S2] stored merged vector for next round verification (round=11)
[S2] DEBUG after merge:  round=11 metric=0.6968 head_norm=1.771091 delta_norm=0.209459
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=11 metric=0.9943 head_norm=1.080318
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.171738e-01
[S10] stored merged vector for next round verification (round=11)
[S10] DEBUG after merge:  round=11 metric=0.9952 head_norm=0.894296 delta_norm=0.417174
[S10] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=11 metric=0.9966 head_norm=1.717685
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.639561e-02
[S8] stored merged vector for next round verification (round=11)
[S8] DEBUG after merge:  round=11 metric=0.9966 head_norm=1.705773 delta_norm=0.086396
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=11 metric=0.4170 head_norm=0.803909
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.614972e-01
[S7] stored merged vector for next round verification (round=11)
[S7] DEBUG after merge:  round=11 metric=0.6828 head_norm=0.956092 delta_norm=0.461497
[S7] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=11 metric=0.7298 head_norm=0.883466
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.483761e-01
[S15] stored merged vector for next round verification (round=11)
[S15] DEBUG after merge:  round=11 metric=0.7185 head_norm=0.769432 delta_norm=0.348376
[S15] aggregate: ROLLBACK (f1_val pre=0.730 post=0.718 tol_abs=0.005 tol_rel=0.0)
[S2] START round=12 head_norm_before_train=1.771091 cos_to_last_merge=1.0000 (last merge round=11)
[S2] round=12 local utility u=0.000000 metrics={'f1_val': 0.6995240028229347, 'auprc': 0.6601537747107952, 'loss_val': 0.43477160104713125, 'psi': 0.6837759115780788}-{'f1_val': 0.6983478455883432, 'auprc': 0.6563663211768518, 'loss_val': 0.3713792393209422, 'psi': 0.6815552358237467}
[S3] START round=12 head_norm_before_train=1.539330 (no previous merge yet)
[S3] round=12 local utility u=0.856247 metrics={'f1_val': 0.7010863553524592, 'auprc': 0.9950057837061687, 'loss_val': 0.3844758776244346, 'psi': 0.8186541266939431}-{'f1_val': 0.4715325553516389, 'auprc': 0.971460077845609, 'loss_val': 0.6490100083188537, 'psi': 0.6715035643492269}
[S4] START round=12 head_norm_before_train=1.771361 (no previous merge yet)
[S4] round=12 local utility u=0.000000 metrics={'f1_val': 0.9374378089591753, 'auprc': 0.9261667352397103, 'loss_val': 0.3203777300799695, 'psi': 0.9329293794713893}-{'f1_val': 0.9553051786580435, 'auprc': 0.9582495195264473, 'loss_val': 0.2885463897536056, 'psi': 0.956482915005405}
[S5] START round=12 head_norm_before_train=1.535968 (no previous merge yet)
[S5] round=12 local utility u=0.030710 metrics={'f1_val': 0.7008563225598777, 'auprc': 0.7918598023289347, 'loss_val': 0.39975291610621655, 'psi': 0.7372577144675005}-{'f1_val': 0.7008168588441903, 'auprc': 0.7917449455251703, 'loss_val': 0.4605925319901932, 'psi': 0.7371880935165823}
[S6] START round=12 head_norm_before_train=1.698178 (no previous merge yet)
[S6] round=12 local utility u=0.000000 metrics={'f1_val': 0.6776547971303359, 'auprc': 0.8155298358317967, 'loss_val': 0.3814313675668556, 'psi': 0.7328048126109203}-{'f1_val': 0.7103768425516556, 'auprc': 0.9557430159077215, 'loss_val': 0.2872370927987574, 'psi': 0.808523311894082}
[S7] START round=12 head_norm_before_train=0.956092 cos_to_last_merge=1.0000 (last merge round=11)
[S7] round=12 local utility u=0.165671 metrics={'f1_val': 0.4169130971024577, 'auprc': 0.7470158395402204, 'loss_val': 0.9911338403921445, 'psi': 0.5489541940775629}-{'f1_val': 0.41703542715461484, 'auprc': 0.6407715947843622, 'loss_val': 1.0044776570759943, 'psi': 0.5065298942065137}
[S8] START round=12 head_norm_before_train=1.705773 cos_to_last_merge=1.0000 (last merge round=11)
[S8] round=12 local utility u=0.011795 metrics={'f1_val': 0.996776381273096, 'auprc': 0.9990685787701333, 'loss_val': 0.10035283150549457, 'psi': 0.997693260271911}-{'f1_val': 0.9966394137733288, 'auprc': 0.9993309426336225, 'loss_val': 0.12390895003471107, 'psi': 0.9977160253174462}
[S9] START round=12 head_norm_before_train=1.267728 cos_to_last_merge=0.8812 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.881
[S9] round=12 local utility u=0.021157 metrics={'f1_val': 0.7014667606303384, 'auprc': 0.9981560730224873, 'loss_val': 0.26651954893709584, 'psi': 0.8201424855871979}-{'f1_val': 0.7015406642019387, 'auprc': 0.9985158817114869, 'loss_val': 0.3103560435970622, 'psi': 0.820330751205758}
[S10] START round=12 head_norm_before_train=0.894296 cos_to_last_merge=1.0000 (last merge round=11)
[S10] round=12 local utility u=0.025973 metrics={'f1_val': 0.9940903254969471, 'auprc': 0.9944083047017255, 'loss_val': 0.2437719246532914, 'psi': 0.9942175171788584}-{'f1_val': 0.9943096789853013, 'auprc': 0.9923002955245924, 'loss_val': 0.2907093587000463, 'psi': 0.9935059256010177}
[S11] START round=12 head_norm_before_train=1.268036 cos_to_last_merge=0.8719 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.872
[S11] round=12 local utility u=0.354862 metrics={'f1_val': 0.6941394848823197, 'auprc': 0.9987889730913819, 'loss_val': 0.519493070187771, 'psi': 0.8159992801659446}-{'f1_val': 0.5837623433681103, 'auprc': 0.9982484828528002, 'loss_val': 0.5653319955118854, 'psi': 0.7495567991619863}
[S13] START round=12 head_norm_before_train=1.590411 (no previous merge yet)
[S13] round=12 local utility u=0.283677 metrics={'f1_val': 0.6140779407141632, 'auprc': 0.6665461372015997, 'loss_val': 0.6222212286325874, 'psi': 0.6350652193091378}-{'f1_val': 0.5956694681017338, 'auprc': 0.5509597333358706, 'loss_val': 0.7323644228059156, 'psi': 0.5777855741953886}
[S14] START round=12 head_norm_before_train=1.539701 (no previous merge yet)
[S14] round=12 local utility u=0.803531 metrics={'f1_val': 0.9176532677511928, 'auprc': 0.9991398082329781, 'loss_val': 0.3322378810154381, 'psi': 0.950247883943907}-{'f1_val': 0.6753710816587092, 'auprc': 0.9972359132657939, 'loss_val': 0.4798941494799959, 'psi': 0.804117014301543}
[S15] START round=12 head_norm_before_train=0.769432 cos_to_last_merge=1.0000 (last merge round=11)
[S15] round=12 local utility u=0.168584 metrics={'f1_val': 0.7789055820253883, 'auprc': 0.8076262187873162, 'loss_val': 0.6396578718908771, 'psi': 0.7903938367301595}-{'f1_val': 0.7298011315508568, 'auprc': 0.8054511373936044, 'loss_val': 0.6756735728753273, 'psi': 0.7600611338879559}
[S16] START round=12 head_norm_before_train=1.247077 cos_to_last_merge=0.8427 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.843
[S16] round=12 local utility u=0.214240 metrics={'f1_val': 0.488119379085614, 'auprc': 0.79120444609718, 'loss_val': 0.6540518630169022, 'psi': 0.6093534058902403}-{'f1_val': 0.43752092479463833, 'auprc': 0.7761848882983873, 'loss_val': 0.7338827686822589, 'psi': 0.572986510196138}
[S17] START round=12 head_norm_before_train=1.376974 cos_to_last_merge=0.8596 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.860
[S17] round=12 local utility u=0.266889 metrics={'f1_val': 0.6483491778742916, 'auprc': 0.8802586142995485, 'loss_val': 0.6148130958713685, 'psi': 0.7411129524443945}-{'f1_val': 0.5902595864568672, 'auprc': 0.8613597667579185, 'loss_val': 0.7433566374086075, 'psi': 0.6986996585772878}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:39415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:39408
[S8] not sending this round → trigger blocked (psi=0.998)
[S7] not sending this round → trigger blocked (psi=0.549)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:39410
[S9] not sending this round → trigger blocked (psi=0.820)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] → sending delta(kind=head bytes=1805) to S15@127.0.0.1:39415
[S14] not sending this round → trigger blocked (psi=0.950)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.609)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.816)
[S15] not sending this round → trigger blocked (psi=0.790)
[S3] sending update (kind=head size=1805 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1800) from S13
[S15] cosine check vs S13: cos=0.4391
[S7] RECEIVED delta(kind=head bytes=1795) from S10
[S7] cosine check vs S10: cos=0.4379
[S9] RECEIVED delta(kind=head bytes=1796) from S5
[S9] cosine check vs S5: cos=-0.0509
[S9] DROPPED delta from S5 (cos=-0.0509 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1805) from S3
[S15] cosine check vs S3: cos=0.4408
[S17] not sending this round → trigger blocked (psi=0.741)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=12 metric=0.4169 head_norm=0.980327
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.262545e-01
[S7] stored merged vector for next round verification (round=12)
[S7] DEBUG after merge:  round=12 metric=0.4169 head_norm=0.841552 delta_norm=0.526255
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=12 metric=0.7789 head_norm=0.854800
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.625915e-01
[S15] stored merged vector for next round verification (round=12)
[S15] DEBUG after merge:  round=12 metric=0.7870 head_norm=0.903099 delta_norm=0.462592
[S15] aggregate: ACCEPT kept=['S13', 'S3'] (k=2/2) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.808758 cos_to_last_merge=0.9995 (last merge round=11)
[S2] round=13 local utility u=0.041863 metrics={'f1_val': 0.6995194354795238, 'auprc': 0.6847309611797582, 'loss_val': 0.4247488122517124, 'psi': 0.6936040457596175}-{'f1_val': 0.6995240028229347, 'auprc': 0.6601537747107952, 'loss_val': 0.43477160104713125, 'psi': 0.6837759115780788}
[S3] START round=13 head_norm_before_train=1.584787 (no previous merge yet)
[S3] round=13 local utility u=0.015308 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9881097125738432, 'loss_val': 0.3311914496824731, 'psi': 0.815697607270717}-{'f1_val': 0.7010863553524592, 'auprc': 0.9950057837061687, 'loss_val': 0.3844758776244346, 'psi': 0.8186541266939431}
[S4] START round=13 head_norm_before_train=1.790324 (no previous merge yet)
[S4] round=13 local utility u=0.147094 metrics={'f1_val': 0.951987551802957, 'auprc': 0.9824253851623748, 'loss_val': 0.28226510914893116, 'psi': 0.9641626851467241}-{'f1_val': 0.9374378089591753, 'auprc': 0.9261667352397103, 'loss_val': 0.3203777300799695, 'psi': 0.9329293794713893}
[S5] START round=13 head_norm_before_train=1.565764 (no previous merge yet)
[S5] round=13 local utility u=0.327511 metrics={'f1_val': 0.7006090940057808, 'auprc': 0.9946679500701966, 'loss_val': 0.3516725211366505, 'psi': 0.8182326364315471}-{'f1_val': 0.7008563225598777, 'auprc': 0.7918598023289347, 'loss_val': 0.39975291610621655, 'psi': 0.7372577144675005}
[S6] START round=13 head_norm_before_train=1.722351 (no previous merge yet)
[S6] round=13 local utility u=0.257257 metrics={'f1_val': 0.7811262762000983, 'auprc': 0.8102013273637236, 'loss_val': 0.47176071782566636, 'psi': 0.7927562966655485}-{'f1_val': 0.6776547971303359, 'auprc': 0.8155298358317967, 'loss_val': 0.3814313675668556, 'psi': 0.7328048126109203}
[S7] START round=13 head_norm_before_train=0.841552 cos_to_last_merge=1.0000 (last merge round=12)
[S7] round=13 local utility u=0.063500 metrics={'f1_val': 0.41683246609844005, 'auprc': 0.7610865015233084, 'loss_val': 0.9058625236764819, 'psi': 0.5545340802683874}-{'f1_val': 0.4169130971024577, 'auprc': 0.7470158395402204, 'loss_val': 0.9911338403921445, 'psi': 0.5489541940775629}
[S8] START round=13 head_norm_before_train=1.757979 cos_to_last_merge=0.9990 (last merge round=11)
[S8] round=13 local utility u=0.004697 metrics={'f1_val': 0.9960417523249225, 'auprc': 0.9992498516521596, 'loss_val': 0.08709470034911236, 'psi': 0.9973249920558174}-{'f1_val': 0.996776381273096, 'auprc': 0.9990685787701333, 'loss_val': 0.10035283150549457, 'psi': 0.997693260271911}
[S9] START round=13 head_norm_before_train=1.317042 cos_to_last_merge=0.8688 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.869
[S9] round=13 local utility u=0.026390 metrics={'f1_val': 0.7014667606303384, 'auprc': 0.9981423550274988, 'loss_val': 0.2136986547497233, 'psi': 0.8201369983892026}-{'f1_val': 0.7014667606303384, 'auprc': 0.9981560730224873, 'loss_val': 0.26651954893709584, 'psi': 0.8201424855871979}
[S10] START round=13 head_norm_before_train=1.004622 cos_to_last_merge=0.9925 (last merge round=11)
[S10] round=13 local utility u=0.041539 metrics={'f1_val': 0.993871046050545, 'auprc': 0.9932056365235304, 'loss_val': 0.155770171675443, 'psi': 0.9936048822397392}-{'f1_val': 0.9940903254969471, 'auprc': 0.9944083047017255, 'loss_val': 0.2437719246532914, 'psi': 0.9942175171788584}
[S11] START round=13 head_norm_before_train=1.303296 cos_to_last_merge=0.8626 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.863
[S11] round=13 local utility u=0.080806 metrics={'f1_val': 0.7017589383281313, 'auprc': 0.9983878148961033, 'loss_val': 0.4023938798774991, 'psi': 0.8204104889553201}-{'f1_val': 0.6941394848823197, 'auprc': 0.9987889730913819, 'loss_val': 0.519493070187771, 'psi': 0.8159992801659446}
[S13] START round=13 head_norm_before_train=1.614654 (no previous merge yet)
[S13] round=13 local utility u=0.000000 metrics={'f1_val': 0.6027324844436202, 'auprc': 0.6808790090927774, 'loss_val': 0.704301608953972, 'psi': 0.633991094303283}-{'f1_val': 0.6140779407141632, 'auprc': 0.6665461372015997, 'loss_val': 0.6222212286325874, 'psi': 0.6350652193091378}
[S14] START round=13 head_norm_before_train=1.562418 (no previous merge yet)
[S14] round=13 local utility u=0.264845 metrics={'f1_val': 0.9933291383437515, 'auprc': 0.9991974871982481, 'loss_val': 0.2567755930654342, 'psi': 0.9956764778855501}-{'f1_val': 0.9176532677511928, 'auprc': 0.9991398082329781, 'loss_val': 0.3322378810154381, 'psi': 0.950247883943907}
[S15] START round=13 head_norm_before_train=0.903099 cos_to_last_merge=1.0000 (last merge round=12)
[S15] round=13 local utility u=0.210105 metrics={'f1_val': 0.8157819977106124, 'auprc': 0.8379403915479003, 'loss_val': 0.5316488165858928, 'psi': 0.8246453552455276}-{'f1_val': 0.7789055820253883, 'auprc': 0.8076262187873162, 'loss_val': 0.6396578718908771, 'psi': 0.7903938367301595}
[S16] START round=13 head_norm_before_train=1.292670 cos_to_last_merge=0.8295 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.830
[S16] round=13 local utility u=0.000000 metrics={'f1_val': 0.45379209783421276, 'auprc': 0.7981592977018206, 'loss_val': 0.6427371514543757, 'psi': 0.5915389777812559}-{'f1_val': 0.488119379085614, 'auprc': 0.79120444609718, 'loss_val': 0.6540518630169022, 'psi': 0.6093534058902403}
[S17] START round=13 head_norm_before_train=1.432232 cos_to_last_merge=0.8544 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.854
[S17] round=13 local utility u=0.700833 metrics={'f1_val': 0.7924377065914869, 'auprc': 0.9787255096898577, 'loss_val': 0.3730788993730262, 'psi': 0.8669528278308353}-{'f1_val': 0.6483491778742916, 'auprc': 0.8802586142995485, 'loss_val': 0.6148130958713685, 'psi': 0.7411129524443945}
[S3] not sending this round → trigger blocked (psi=0.816)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:39403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:39403
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:39402
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:39415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:39409
[S10] not sending this round → trigger blocked (psi=0.994)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:39407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:39408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S15] → sending delta(kind=head bytes=1787) to S10@127.0.0.1:39411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:39411
[S5] not sending this round → trigger blocked (psi=0.818)
[S2] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1787 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1796) from S14
[S6] cosine check vs S14: cos=-0.0463
[S6] DROPPED delta from S14 (cos=-0.0463 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1798) from S11
[S7] cosine check vs S11: cos=0.6053
[S2] RECEIVED delta(kind=head bytes=1800) from S4
[S2] cosine check vs S4: cos=0.9848
[S3] RECEIVED delta(kind=head bytes=1799) from S8
[S3] cosine check vs S8: cos=-0.1539
[S3] DROPPED delta from S8 (cos=-0.1539 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1798) from S9
[S3] cosine check vs S9: cos=-0.0810
[S3] DROPPED delta from S9 (cos=-0.0810 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1800) from S6
[S8] cosine check vs S6: cos=0.9917
[S10] RECEIVED delta(kind=head bytes=1798) from S2
[S10] cosine check vs S2: cos=0.5009
[S10] RECEIVED delta(kind=head bytes=1787) from S15
[S10] cosine check vs S15: cos=0.7958
[S15] RECEIVED delta(kind=head bytes=1796) from S7
[S15] cosine check vs S7: cos=0.6957
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:39409
[S17] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1801) from S17
[S8] cosine check vs S17: cos=0.0036
[S10] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=13 metric=0.9939 head_norm=1.117865
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.693602e-01
[S10] stored merged vector for next round verification (round=13)
[S10] DEBUG after merge:  round=13 metric=0.9937 head_norm=1.043631 delta_norm=0.369360
[S10] aggregate: ACCEPT kept=['S2', 'S15'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=13 metric=0.8158 head_norm=0.986120
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.668422e-01
[S15] stored merged vector for next round verification (round=13)
[S15] DEBUG after merge:  round=13 metric=0.8115 head_norm=0.858190 delta_norm=0.366842
[S15] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=13 metric=0.9960 head_norm=1.808228
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.011229e-01
[S8] stored merged vector for next round verification (round=13)
[S8] DEBUG after merge:  round=13 metric=0.9942 head_norm=1.388069 delta_norm=0.601123
[S8] aggregate: ACCEPT kept=['S6', 'S17'] (k=2/2) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=13 metric=0.4168 head_norm=0.877321
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.367215e-01
[S7] stored merged vector for next round verification (round=13)
[S7] DEBUG after merge:  round=13 metric=0.4168 head_norm=1.001529 delta_norm=0.536721
[S7] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=13 metric=0.6995 head_norm=1.836210
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.595060e-01
[S2] stored merged vector for next round verification (round=13)
[S2] DEBUG after merge:  round=13 metric=0.6995 head_norm=1.814274 delta_norm=0.159506
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.814274 cos_to_last_merge=1.0000 (last merge round=13)
[S2] round=14 local utility u=0.120008 metrics={'f1_val': 0.7060435389296725, 'auprc': 0.7690719374847884, 'loss_val': 0.4769010180793596, 'psi': 0.7312548983517189}-{'f1_val': 0.6995194354795238, 'auprc': 0.6847309611797582, 'loss_val': 0.4247488122517124, 'psi': 0.6936040457596175}
[S3] START round=14 head_norm_before_train=1.628431 (no previous merge yet)
[S3] round=14 local utility u=0.020592 metrics={'f1_val': 0.7010108237857944, 'auprc': 0.9938734976299562, 'loss_val': 0.30882689941200336, 'psi': 0.8181558933234592}-{'f1_val': 0.7007562037352997, 'auprc': 0.9881097125738432, 'loss_val': 0.3311914496824731, 'psi': 0.815697607270717}
[S4] START round=14 head_norm_before_train=1.806210 (no previous merge yet)
[S4] round=14 local utility u=0.000000 metrics={'f1_val': 0.9439430238490907, 'auprc': 0.9597150178613552, 'loss_val': 0.2965581067585289, 'psi': 0.9502518214539966}-{'f1_val': 0.951987551802957, 'auprc': 0.9824253851623748, 'loss_val': 0.28226510914893116, 'psi': 0.9641626851467241}
[S5] START round=14 head_norm_before_train=1.589263 (no previous merge yet)
[S5] round=14 local utility u=0.022277 metrics={'f1_val': 0.7006090940057808, 'auprc': 0.99825129892097, 'loss_val': 0.3178681149513295, 'psi': 0.8196659759718565}-{'f1_val': 0.7006090940057808, 'auprc': 0.9946679500701966, 'loss_val': 0.3516725211366505, 'psi': 0.8182326364315471}
[S6] START round=14 head_norm_before_train=1.740524 (no previous merge yet)
[S6] round=14 local utility u=0.938931 metrics={'f1_val': 0.9603900995785121, 'auprc': 0.9764676629774955, 'loss_val': 0.16828027884073143, 'psi': 0.9668211249381053}-{'f1_val': 0.7811262762000983, 'auprc': 0.8102013273637236, 'loss_val': 0.47176071782566636, 'psi': 0.7927562966655485}
[S7] START round=14 head_norm_before_train=1.001529 cos_to_last_merge=1.0000 (last merge round=13)
[S7] round=14 local utility u=0.704482 metrics={'f1_val': 0.6604170162275234, 'auprc': 0.7445987465741482, 'loss_val': 0.9089421686874202, 'psi': 0.6940897083661732}-{'f1_val': 0.41683246609844005, 'auprc': 0.7610865015233084, 'loss_val': 0.9058625236764819, 'psi': 0.5545340802683874}
[S8] START round=14 head_norm_before_train=1.388069 cos_to_last_merge=1.0000 (last merge round=13)
[S8] round=14 local utility u=0.000000 metrics={'f1_val': 0.9952315552607698, 'auprc': 0.9991151761882138, 'loss_val': 0.13305029310543792, 'psi': 0.9967850036317474}-{'f1_val': 0.9960417523249225, 'auprc': 0.9992498516521596, 'loss_val': 0.08709470034911236, 'psi': 0.9973249920558174}
[S9] START round=14 head_norm_before_train=1.358641 cos_to_last_merge=0.8585 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.858
[S9] round=14 local utility u=0.000000 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9980656942749291, 'loss_val': 0.22591843729163077, 'psi': 0.8199562261739828}-{'f1_val': 0.7014667606303384, 'auprc': 0.9981423550274988, 'loss_val': 0.2136986547497233, 'psi': 0.8201369983892026}
[S10] START round=14 head_norm_before_train=1.043631 cos_to_last_merge=1.0000 (last merge round=13)
[S10] round=14 local utility u=0.000000 metrics={'f1_val': 0.9940903254969471, 'auprc': 0.9943278055285651, 'loss_val': 0.18299350613062082, 'psi': 0.9941853175095943}-{'f1_val': 0.993871046050545, 'auprc': 0.9932056365235304, 'loss_val': 0.155770171675443, 'psi': 0.9936048822397392}
[S11] START round=14 head_norm_before_train=1.346317 cos_to_last_merge=0.8528 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.853
[S11] round=14 local utility u=0.032387 metrics={'f1_val': 0.702242488399264, 'auprc': 0.9984214370848984, 'loss_val': 0.3406218300418121, 'psi': 0.8207140678735177}-{'f1_val': 0.7017589383281313, 'auprc': 0.9983878148961033, 'loss_val': 0.4023938798774991, 'psi': 0.8204104889553201}
[S13] START round=14 head_norm_before_train=1.634113 (no previous merge yet)
[S13] round=14 local utility u=0.000000 metrics={'f1_val': 0.5970247267068887, 'auprc': 0.6509439054031446, 'loss_val': 0.8020620901485618, 'psi': 0.618592398185391}-{'f1_val': 0.6027324844436202, 'auprc': 0.6808790090927774, 'loss_val': 0.704301608953972, 'psi': 0.633991094303283}
[S14] START round=14 head_norm_before_train=1.588754 (no previous merge yet)
[S14] round=14 local utility u=0.031686 metrics={'f1_val': 0.99496713747233, 'auprc': 0.9974828436832133, 'loss_val': 0.19808830005696607, 'psi': 0.9959734199566833}-{'f1_val': 0.9933291383437515, 'auprc': 0.9991974871982481, 'loss_val': 0.2567755930654342, 'psi': 0.9956764778855501}
[S15] START round=14 head_norm_before_train=0.858190 cos_to_last_merge=1.0000 (last merge round=13)
[S15] round=14 local utility u=0.003365 metrics={'f1_val': 0.7859795473376476, 'auprc': 0.8942480355376394, 'loss_val': 0.5150272258697424, 'psi': 0.8292869426176444}-{'f1_val': 0.8157819977106124, 'auprc': 0.8379403915479003, 'loss_val': 0.5316488165858928, 'psi': 0.8246453552455276}
[S16] START round=14 head_norm_before_train=1.342085 cos_to_last_merge=0.8186 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.819
[S16] round=14 local utility u=0.165442 metrics={'f1_val': 0.5201298946574935, 'auprc': 0.8002499869388473, 'loss_val': 0.7161511663423983, 'psi': 0.6321779315700351}-{'f1_val': 0.45379209783421276, 'auprc': 0.7981592977018206, 'loss_val': 0.6427371514543757, 'psi': 0.5915389777812559}
[S17] START round=14 head_norm_before_train=1.488056 cos_to_last_merge=0.8501 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.850
[S17] round=14 local utility u=0.000000 metrics={'f1_val': 0.676752989425565, 'auprc': 0.9229723200406034, 'loss_val': 0.4624696787658766, 'psi': 0.7752407216715804}-{'f1_val': 0.7924377065914869, 'auprc': 0.9787255096898577, 'loss_val': 0.3730788993730262, 'psi': 0.8669528278308353}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] → sending delta(kind=head bytes=1793) to S10@127.0.0.1:39411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S7] → sending delta(kind=head bytes=1791) to S15@127.0.0.1:39415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:39409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:39407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] → sending delta(kind=head bytes=1804) to S10@127.0.0.1:39411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:39410
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:39407
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:39415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:39408
[S3] sending update (kind=head size=1804 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1804 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1791 to 1 peers)
[S15] sending update (kind=head size=1793 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1804) from S2
[S10] cosine check vs S2: cos=0.7000
[S10] RECEIVED delta(kind=head bytes=1793) from S15
[S10] cosine check vs S15: cos=0.8117
[S8] RECEIVED delta(kind=head bytes=1795) from S6
[S8] cosine check vs S6: cos=0.9568
[S9] RECEIVED delta(kind=head bytes=1802) from S5
[S9] cosine check vs S5: cos=-0.0529
[S9] DROPPED delta from S5 (cos=-0.0529 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1804) from S3
[S15] cosine check vs S3: cos=0.4724
[S7] RECEIVED delta(kind=head bytes=1797) from S11
[S7] cosine check vs S11: cos=0.9223
[S6] RECEIVED delta(kind=head bytes=1802) from S14
[S6] cosine check vs S14: cos=-0.0464
[S6] DROPPED delta from S14 (cos=-0.0464 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1800) from S16
[S6] cosine check vs S16: cos=-0.0117
[S6] DROPPED delta from S16 (cos=-0.0117 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1791) from S7
[S15] cosine check vs S7: cos=0.6446
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=14 metric=0.9941 head_norm=1.134554
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.484795e-01
[S10] stored merged vector for next round verification (round=14)
[S10] DEBUG after merge:  round=14 metric=0.9939 head_norm=1.109255 delta_norm=0.248479
[S10] aggregate: ACCEPT kept=['S2', 'S15'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=14 metric=0.9952 head_norm=1.440360
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.821652e-01
[S8] stored merged vector for next round verification (round=14)
[S8] DEBUG after merge:  round=14 metric=0.9952 head_norm=1.581025 delta_norm=0.282165
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=14 metric=0.6604 head_norm=1.027699
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.990814e-01
[S7] stored merged vector for next round verification (round=14)
[S7] DEBUG after merge:  round=14 metric=0.4173 head_norm=1.188196 delta_norm=0.299081
[S7] aggregate: ROLLBACK (f1_val pre=0.660 post=0.417 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=14 metric=0.7860 head_norm=0.945707
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.650791e-01
[S15] stored merged vector for next round verification (round=14)
[S15] DEBUG after merge:  round=14 metric=0.7691 head_norm=0.904842 delta_norm=0.365079
[S15] aggregate: ROLLBACK (f1_val pre=0.786 post=0.769 tol_abs=0.005 tol_rel=0.0)
[S2] START round=15 head_norm_before_train=1.846633 cos_to_last_merge=0.9997 (last merge round=13)
[S2] round=15 local utility u=0.000000 metrics={'f1_val': 0.6823073865831856, 'auprc': 0.7737962334048393, 'loss_val': 0.6062568146172913, 'psi': 0.7189029253118471}-{'f1_val': 0.7060435389296725, 'auprc': 0.7690719374847884, 'loss_val': 0.4769010180793596, 'psi': 0.7312548983517189}
[S3] START round=15 head_norm_before_train=1.666269 (no previous merge yet)
[S3] round=15 local utility u=0.009100 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9935488812549695, 'loss_val': 0.2876739040065296, 'psi': 0.8178281283011887}-{'f1_val': 0.7010108237857944, 'auprc': 0.9938734976299562, 'loss_val': 0.30882689941200336, 'psi': 0.8181558933234592}
[S4] START round=15 head_norm_before_train=1.828186 (no previous merge yet)
[S4] round=15 local utility u=0.019892 metrics={'f1_val': 0.9494785394984407, 'auprc': 0.9532478956388164, 'loss_val': 0.27058675768434165, 'psi': 0.9509862819545909}-{'f1_val': 0.9439430238490907, 'auprc': 0.9597150178613552, 'loss_val': 0.2965581067585289, 'psi': 0.9502518214539966}
[S5] START round=15 head_norm_before_train=1.609920 (no previous merge yet)
[S5] round=15 local utility u=0.011174 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9976565113726803, 'loss_val': 0.29373125879974815, 'psi': 0.8194276401466767}-{'f1_val': 0.7006090940057808, 'auprc': 0.99825129892097, 'loss_val': 0.3178681149513295, 'psi': 0.8196659759718565}
[S6] START round=15 head_norm_before_train=1.756098 (no previous merge yet)
[S6] round=15 local utility u=0.000000 metrics={'f1_val': 0.9416735986357093, 'auprc': 0.9678216524116532, 'loss_val': 0.19231731335757252, 'psi': 0.9521328201460868}-{'f1_val': 0.9603900995785121, 'auprc': 0.9764676629774955, 'loss_val': 0.16828027884073143, 'psi': 0.9668211249381053}
[S7] START round=15 head_norm_before_train=1.188196 cos_to_last_merge=1.0000 (last merge round=14)
[S7] round=15 local utility u=0.000000 metrics={'f1_val': 0.43953027061594196, 'auprc': 0.7135290682680265, 'loss_val': 0.9207623429472297, 'psi': 0.5491297896767758}-{'f1_val': 0.6604170162275234, 'auprc': 0.7445987465741482, 'loss_val': 0.9089421686874202, 'psi': 0.6940897083661732}
[S8] START round=15 head_norm_before_train=1.581025 cos_to_last_merge=1.0000 (last merge round=14)
[S8] round=15 local utility u=0.021729 metrics={'f1_val': 0.9949323051384696, 'auprc': 0.9988148349780908, 'loss_val': 0.08689524262673473, 'psi': 0.996485317074318}-{'f1_val': 0.9952315552607698, 'auprc': 0.9991151761882138, 'loss_val': 0.13305029310543792, 'psi': 0.9967850036317474}
[S9] START round=15 head_norm_before_train=1.393535 cos_to_last_merge=0.8509 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.851
[S9] round=15 local utility u=0.635393 metrics={'f1_val': 0.9019679502864293, 'auprc': 0.9981914804737585, 'loss_val': 0.16001843274638383, 'psi': 0.9404573623613609}-{'f1_val': 0.7012165807733519, 'auprc': 0.9980656942749291, 'loss_val': 0.22591843729163077, 'psi': 0.8199562261739828}
[S10] START round=15 head_norm_before_train=1.109255 cos_to_last_merge=1.0000 (last merge round=14)
[S10] round=15 local utility u=0.005599 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.9959072003585883, 'loss_val': 0.1725878932115837, 'psi': 0.9944225050359788}-{'f1_val': 0.9940903254969471, 'auprc': 0.9943278055285651, 'loss_val': 0.18299350613062082, 'psi': 0.9941853175095943}
[S11] START round=15 head_norm_before_train=1.395118 cos_to_last_merge=0.8419 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.842
[S11] round=15 local utility u=0.036036 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9975454433411862, 'loss_val': 0.26407875841053974, 'psi': 0.8201793673154665}-{'f1_val': 0.702242488399264, 'auprc': 0.9984214370848984, 'loss_val': 0.3406218300418121, 'psi': 0.8207140678735177}
[S13] START round=15 head_norm_before_train=1.653921 (no previous merge yet)
[S13] round=15 local utility u=0.000000 metrics={'f1_val': 0.5701572309436372, 'auprc': 0.6990728332285837, 'loss_val': 0.8967321909127576, 'psi': 0.6217234718576159}-{'f1_val': 0.5970247267068887, 'auprc': 0.6509439054031446, 'loss_val': 0.8020620901485618, 'psi': 0.618592398185391}
[S14] START round=15 head_norm_before_train=1.618555 (no previous merge yet)
[S14] round=15 local utility u=0.009416 metrics={'f1_val': 0.9940044445943582, 'auprc': 0.9991954349139164, 'loss_val': 0.17861840018722724, 'psi': 0.9960808407221815}-{'f1_val': 0.99496713747233, 'auprc': 0.9974828436832133, 'loss_val': 0.19808830005696607, 'psi': 0.9959734199566833}
[S15] START round=15 head_norm_before_train=0.904842 cos_to_last_merge=1.0000 (last merge round=14)
[S15] round=15 local utility u=0.000000 metrics={'f1_val': 0.7770265388041101, 'auprc': 0.938349511184595, 'loss_val': 0.6805163679832058, 'psi': 0.841555727756304}-{'f1_val': 0.7859795473376476, 'auprc': 0.8942480355376394, 'loss_val': 0.5150272258697424, 'psi': 0.8292869426176444}
[S16] START round=15 head_norm_before_train=1.386237 cos_to_last_merge=0.8084 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.808
[S16] round=15 local utility u=0.145280 metrics={'f1_val': 0.49129410082674024, 'auprc': 0.887808640926622, 'loss_val': 0.5152519560672512, 'psi': 0.649899916866693}-{'f1_val': 0.5201298946574935, 'auprc': 0.8002499869388473, 'loss_val': 0.7161511663423983, 'psi': 0.6321779315700351}
[S17] START round=15 head_norm_before_train=1.540818 cos_to_last_merge=0.8451 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.845
[S17] round=15 local utility u=0.000000 metrics={'f1_val': 0.663954369998393, 'auprc': 0.8890575468212472, 'loss_val': 0.6345598728571448, 'psi': 0.7539956407275347}-{'f1_val': 0.676752989425565, 'auprc': 0.9229723200406034, 'loss_val': 0.4624696787658766, 'psi': 0.7752407216715804}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.996)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:39403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:39408
[S11] not sending this round → trigger blocked (psi=0.820)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.818)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:39402
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:39403
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.819)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.650)
[S9] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1802) from S10
[S7] cosine check vs S10: cos=0.3048
[S3] RECEIVED delta(kind=head bytes=1800) from S8
[S3] cosine check vs S8: cos=-0.1477
[S3] DROPPED delta from S8 (cos=-0.1477 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1799) from S4
[S2] cosine check vs S4: cos=0.9901
[S3] RECEIVED delta(kind=head bytes=1800) from S9
[S3] cosine check vs S9: cos=-0.0815
[S3] DROPPED delta from S9 (cos=-0.0815 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] ⇄ pheromone p=0.207 → S15@127.0.0.1:39415
[S6] ⇄ pheromone p=0.288 → S8@127.0.0.1:39409
[S11] ⇄ pheromone p=0.201 → S7@127.0.0.1:39408
[S14] ⇄ pheromone p=0.267 → S6@127.0.0.1:39407
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=15 metric=0.6823 head_norm=1.880881
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.318427e-01
[S2] stored merged vector for next round verification (round=15)
[S2] DEBUG after merge:  round=15 metric=0.6666 head_norm=1.860776 delta_norm=0.131843
[S2] aggregate: ROLLBACK (f1_val pre=0.682 post=0.667 tol_abs=0.005 tol_rel=0.0)
[S2] ⇄ pheromone p=0.102 → S10@127.0.0.1:39411
[S15] ⇄ pheromone p=0.188 → S10@127.0.0.1:39411
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=15 metric=0.4395 head_norm=1.210604
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.108291e-01
[S7] stored merged vector for next round verification (round=15)
[S7] DEBUG after merge:  round=15 metric=0.5918 head_norm=0.973792 delta_norm=0.710829
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.230 → S15@127.0.0.1:39415
[S5] ⇄ pheromone p=0.157 → S9@127.0.0.1:39410
[S13] ⇄ pheromone p=0.118 → S15@127.0.0.1:39415
[S9] ⇄ pheromone p=0.220 → S3@127.0.0.1:39403
[S10] ⇄ pheromone p=0.170 → S7@127.0.0.1:39408
[S8] ⇄ pheromone p=0.132 → S3@127.0.0.1:39403
[S4] ⇄ pheromone p=0.181 → S2@127.0.0.1:39402
[S16] ⇄ pheromone p=0.156 → S6@127.0.0.1:39407
[S17] ⇄ pheromone p=0.240 → S8@127.0.0.1:39409
[S2] START round=16 head_norm_before_train=1.860776 cos_to_last_merge=1.0000 (last merge round=15)
[S2] round=16 local utility u=0.000000 metrics={'f1_val': 0.6548834440300263, 'auprc': 0.7351573629238708, 'loss_val': 0.8584114980635459, 'psi': 0.6869930115875641}-{'f1_val': 0.6823073865831856, 'auprc': 0.7737962334048393, 'loss_val': 0.6062568146172913, 'psi': 0.7189029253118471}
[S3] START round=16 head_norm_before_train=1.697209 (no previous merge yet)
[S3] round=16 local utility u=0.005194 metrics={'f1_val': 0.7010108237857944, 'auprc': 0.9937894104040551, 'loss_val': 0.279987149328353, 'psi': 0.8181222584330987}-{'f1_val': 0.7006809596653347, 'auprc': 0.9935488812549695, 'loss_val': 0.2876739040065296, 'psi': 0.8178281283011887}
[S4] START round=16 head_norm_before_train=1.849871 (no previous merge yet)
[S4] round=16 local utility u=0.000000 metrics={'f1_val': 0.9446827582839477, 'auprc': 0.954972535231904, 'loss_val': 0.2856134736606643, 'psi': 0.9487986690631303}-{'f1_val': 0.9494785394984407, 'auprc': 0.9532478956388164, 'loss_val': 0.27058675768434165, 'psi': 0.9509862819545909}
[S5] START round=16 head_norm_before_train=1.627602 (no previous merge yet)
[S5] round=16 local utility u=0.000000 metrics={'f1_val': 0.7087540686086581, 'auprc': 0.7937009752758796, 'loss_val': 0.32774048269386413, 'psi': 0.7427328312755467}-{'f1_val': 0.7006083926626743, 'auprc': 0.9976565113726803, 'loss_val': 0.29373125879974815, 'psi': 0.8194276401466767}
[S6] START round=16 head_norm_before_train=1.775524 (no previous merge yet)
[S6] round=16 local utility u=0.000000 metrics={'f1_val': 0.6716590245215364, 'auprc': 0.9547080500291525, 'loss_val': 0.618796878015707, 'psi': 0.7848786347245829}-{'f1_val': 0.9416735986357093, 'auprc': 0.9678216524116532, 'loss_val': 0.19231731335757252, 'psi': 0.9521328201460868}
[S7] START round=16 head_norm_before_train=0.973792 cos_to_last_merge=1.0000 (last merge round=15)
[S7] round=16 local utility u=0.733605 metrics={'f1_val': 0.6343734573927883, 'auprc': 0.7661651567873531, 'loss_val': 0.780519564537884, 'psi': 0.6870901371506142}-{'f1_val': 0.43953027061594196, 'auprc': 0.7135290682680265, 'loss_val': 0.9207623429472297, 'psi': 0.5491297896767758}
[S8] START round=16 head_norm_before_train=1.628153 cos_to_last_merge=0.9993 (last merge round=14)
[S8] round=16 local utility u=0.000000 metrics={'f1_val': 0.7374621933505962, 'auprc': 0.9984361884541473, 'loss_val': 0.16336332789377833, 'psi': 0.8418517913920166}-{'f1_val': 0.9949323051384696, 'auprc': 0.9988148349780908, 'loss_val': 0.08689524262673473, 'psi': 0.996485317074318}
[S9] START round=16 head_norm_before_train=1.422654 cos_to_last_merge=0.8448 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.845
[S9] round=16 local utility u=0.266213 metrics={'f1_val': 0.9878214512971564, 'auprc': 0.9984624599221145, 'loss_val': 0.14352626510503216, 'psi': 0.9920778547471396}-{'f1_val': 0.9019679502864293, 'auprc': 0.9981914804737585, 'loss_val': 0.16001843274638383, 'psi': 0.9404573623613609}
[S10] START round=16 head_norm_before_train=1.200640 cos_to_last_merge=0.9946 (last merge round=14)
[S10] round=16 local utility u=0.025522 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9916259821568576, 'loss_val': 0.11659566634101473, 'psi': 0.9934995583943665}-{'f1_val': 0.9934327081542391, 'auprc': 0.9959072003585883, 'loss_val': 0.1725878932115837, 'psi': 0.9944225050359788}
[S11] START round=16 head_norm_before_train=1.444744 cos_to_last_merge=0.8328 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.833
[S11] round=16 local utility u=0.022634 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9983472632598425, 'loss_val': 0.2212168470751863, 'psi': 0.8205000952829291}-{'f1_val': 0.7019353166316534, 'auprc': 0.9975454433411862, 'loss_val': 0.26407875841053974, 'psi': 0.8201793673154665}
[S13] START round=16 head_norm_before_train=1.665942 (no previous merge yet)
[S13] round=16 local utility u=0.232336 metrics={'f1_val': 0.6072003768661354, 'auprc': 0.6741747268941485, 'loss_val': 0.5796237568358241, 'psi': 0.6339901168773406}-{'f1_val': 0.5701572309436372, 'auprc': 0.6990728332285837, 'loss_val': 0.8967321909127576, 'psi': 0.6217234718576159}
[S14] START round=16 head_norm_before_train=1.643919 (no previous merge yet)
[S14] round=16 local utility u=0.020554 metrics={'f1_val': 0.9961524104048237, 'auprc': 0.9974921087594534, 'loss_val': 0.14528830733664125, 'psi': 0.9966882897466756}-{'f1_val': 0.9940044445943582, 'auprc': 0.9991954349139164, 'loss_val': 0.17861840018722724, 'psi': 0.9960808407221815}
[S15] START round=16 head_norm_before_train=0.977944 cos_to_last_merge=0.9940 (last merge round=14)
[S15] round=16 local utility u=0.000000 metrics={'f1_val': 0.7055106427242188, 'auprc': 0.9870136448566884, 'loss_val': 0.4913720280873382, 'psi': 0.8181118435772067}-{'f1_val': 0.7770265388041101, 'auprc': 0.938349511184595, 'loss_val': 0.6805163679832058, 'psi': 0.841555727756304}
[S16] START round=16 head_norm_before_train=1.427839 cos_to_last_merge=0.7985 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.798
[S16] round=16 local utility u=0.586756 metrics={'f1_val': 0.6696264755679759, 'auprc': 0.9087250333700303, 'loss_val': 0.4744830364244728, 'psi': 0.7652658986887977}-{'f1_val': 0.49129410082674024, 'auprc': 0.887808640926622, 'loss_val': 0.5152519560672512, 'psi': 0.649899916866693}
[S17] START round=16 head_norm_before_train=1.589503 cos_to_last_merge=0.8414 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.841
[S17] round=16 local utility u=0.178052 metrics={'f1_val': 0.7037845358005158, 'auprc': 0.9042071372972228, 'loss_val': 0.5628850671310012, 'psi': 0.7839535763991986}-{'f1_val': 0.663954369998393, 'auprc': 0.8890575468212472, 'loss_val': 0.6345598728571448, 'psi': 0.7539956407275347}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:39415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:39407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] → sending delta(kind=head bytes=1794) to S6@127.0.0.1:39407
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:39415
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.993)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:39415
[S9] not sending this round → trigger blocked (psi=0.992)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:39408
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S16] sending update (kind=head size=1794 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1803 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1802) from S13
[S15] cosine check vs S13: cos=0.3707
[S15] RECEIVED delta(kind=head bytes=1798) from S7
[S15] cosine check vs S7: cos=0.7041
[S7] RECEIVED delta(kind=head bytes=1802) from S11
[S7] cosine check vs S11: cos=0.7047
[S6] RECEIVED delta(kind=head bytes=1794) from S16
[S6] cosine check vs S16: cos=-0.0089
[S6] DROPPED delta from S16 (cos=-0.0089 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1803) from S3
[S15] cosine check vs S3: cos=0.6735
[S6] RECEIVED delta(kind=head bytes=1800) from S14
[S6] cosine check vs S14: cos=-0.0464
[S6] DROPPED delta from S14 (cos=-0.0464 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:39409
[S17] sending update (kind=head size=1803 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1803) from S17
[S8] cosine check vs S17: cos=0.1111
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=16 metric=0.7375 head_norm=1.675347
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.102147e+00
[S8] stored merged vector for next round verification (round=16)
[S8] DEBUG after merge:  round=16 metric=0.9953 head_norm=1.232139 delta_norm=1.102147
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=16 metric=0.6344 head_norm=1.004999
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.292202e-01
[S7] stored merged vector for next round verification (round=16)
[S7] DEBUG after merge:  round=16 metric=0.5924 head_norm=1.155659 delta_norm=0.529220
[S7] aggregate: ROLLBACK (f1_val pre=0.634 post=0.592 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=16 metric=0.7055 head_norm=1.038281
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.351784e-01
[S15] stored merged vector for next round verification (round=16)
[S15] DEBUG after merge:  round=16 metric=0.7016 head_norm=0.936946 delta_norm=0.235178
[S15] aggregate: ACCEPT kept=['S13', 'S7', 'S3'] (k=3/3) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.887622 cos_to_last_merge=0.9998 (last merge round=15)
[S2] round=17 local utility u=0.051233 metrics={'f1_val': 0.6661401242333452, 'auprc': 0.7258853045281277, 'loss_val': 0.7956694429094916, 'psi': 0.6900381963512583}-{'f1_val': 0.6548834440300263, 'auprc': 0.7351573629238708, 'loss_val': 0.8584114980635459, 'psi': 0.6869930115875641}
[S3] START round=17 head_norm_before_train=1.722271 (no previous merge yet)
[S3] round=17 local utility u=0.001933 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9937341275199941, 'loss_val': 0.274427209856502, 'psi': 0.8179473732491774}-{'f1_val': 0.7010108237857944, 'auprc': 0.9937894104040551, 'loss_val': 0.279987149328353, 'psi': 0.8181222584330987}
[S4] START round=17 head_norm_before_train=1.858280 (no previous merge yet)
[S4] round=17 local utility u=0.000000 metrics={'f1_val': 0.941813858397198, 'auprc': 0.9535775069039855, 'loss_val': 0.2983311802655344, 'psi': 0.9465193177999129}-{'f1_val': 0.9446827582839477, 'auprc': 0.954972535231904, 'loss_val': 0.2856134736606643, 'psi': 0.9487986690631303}
[S5] START round=17 head_norm_before_train=1.640970 (no previous merge yet)
[S5] round=17 local utility u=0.290631 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.989169289599859, 'loss_val': 0.2840096048470619, 'psi': 0.8160327514375482}-{'f1_val': 0.7087540686086581, 'auprc': 0.7937009752758796, 'loss_val': 0.32774048269386413, 'psi': 0.7427328312755467}
[S6] START round=17 head_norm_before_train=1.796516 (no previous merge yet)
[S6] round=17 local utility u=0.232396 metrics={'f1_val': 0.7433841855839706, 'auprc': 0.9510254918512182, 'loss_val': 0.5733090774331983, 'psi': 0.8264407080908697}-{'f1_val': 0.6716590245215364, 'auprc': 0.9547080500291525, 'loss_val': 0.618796878015707, 'psi': 0.7848786347245829}
[S7] START round=17 head_norm_before_train=1.155659 cos_to_last_merge=1.0000 (last merge round=16)
[S7] round=17 local utility u=0.000000 metrics={'f1_val': 0.5291724227818477, 'auprc': 0.7791980292195481, 'loss_val': 0.8539650668273004, 'psi': 0.6291826653569279}-{'f1_val': 0.6343734573927883, 'auprc': 0.7661651567873531, 'loss_val': 0.780519564537884, 'psi': 0.6870901371506142}
[S8] START round=17 head_norm_before_train=1.232139 cos_to_last_merge=1.0000 (last merge round=16)
[S8] round=17 local utility u=0.754201 metrics={'f1_val': 0.9942060797282372, 'auprc': 0.9993807908851771, 'loss_val': 0.19825767037173236, 'psi': 0.996275964191013}-{'f1_val': 0.7374621933505962, 'auprc': 0.9984361884541473, 'loss_val': 0.16336332789377833, 'psi': 0.8418517913920166}
[S9] START round=17 head_norm_before_train=1.452517 cos_to_last_merge=0.8396 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.840
[S9] round=17 local utility u=0.021832 metrics={'f1_val': 0.9916350289240425, 'auprc': 0.9984622050538167, 'loss_val': 0.12274301754962251, 'psi': 0.9943658993759522}-{'f1_val': 0.9878214512971564, 'auprc': 0.9984624599221145, 'loss_val': 0.14352626510503216, 'psi': 0.9920778547471396}
[S10] START round=17 head_norm_before_train=1.291816 cos_to_last_merge=0.9840 (last merge round=14)
[S10] round=17 local utility u=0.013951 metrics={'f1_val': 0.993871046050545, 'auprc': 0.9935062003595109, 'loss_val': 0.08906892820128348, 'psi': 0.9937251077741314}-{'f1_val': 0.9947486092193725, 'auprc': 0.9916259821568576, 'loss_val': 0.11659566634101473, 'psi': 0.9934995583943665}
[S11] START round=17 head_norm_before_train=1.490376 cos_to_last_merge=0.8245 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.825
[S11] round=17 local utility u=0.444941 metrics={'f1_val': 0.8445296811295857, 'auprc': 0.997856907479535, 'loss_val': 0.18542965868393452, 'psi': 0.9058605716695655}-{'f1_val': 0.7019353166316534, 'auprc': 0.9983472632598425, 'loss_val': 0.2212168470751863, 'psi': 0.8205000952829291}
[S13] START round=17 head_norm_before_train=1.672472 (no previous merge yet)
[S13] round=17 local utility u=0.000000 metrics={'f1_val': 0.5491801016461616, 'auprc': 0.6956421948401345, 'loss_val': 0.9591685141885113, 'psi': 0.6077649389237507}-{'f1_val': 0.6072003768661354, 'auprc': 0.6741747268941485, 'loss_val': 0.5796237568358241, 'psi': 0.6339901168773406}
[S14] START round=17 head_norm_before_train=1.667235 (no previous merge yet)
[S14] round=17 local utility u=0.008114 metrics={'f1_val': 0.9942958007018045, 'auprc': 0.998985190119038, 'loss_val': 0.12239994803801686, 'psi': 0.9961715564686978}-{'f1_val': 0.9961524104048237, 'auprc': 0.9974921087594534, 'loss_val': 0.14528830733664125, 'psi': 0.9966882897466756}
[S15] START round=17 head_norm_before_train=0.936946 cos_to_last_merge=1.0000 (last merge round=16)
[S15] round=17 local utility u=0.652543 metrics={'f1_val': 0.8989760715278742, 'auprc': 0.9915096093979323, 'loss_val': 0.36056707169514185, 'psi': 0.9359894866758975}-{'f1_val': 0.7055106427242188, 'auprc': 0.9870136448566884, 'loss_val': 0.4913720280873382, 'psi': 0.8181118435772067}
[S16] START round=17 head_norm_before_train=1.466884 cos_to_last_merge=0.7886 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.789
[S16] round=17 local utility u=0.022848 metrics={'f1_val': 0.8201614988612891, 'auprc': 0.7823290280831359, 'loss_val': 0.9528089913166099, 'psi': 0.8050285105500278}-{'f1_val': 0.6696264755679759, 'auprc': 0.9087250333700303, 'loss_val': 0.4744830364244728, 'psi': 0.7652658986887977}
[S17] START round=17 head_norm_before_train=1.630644 cos_to_last_merge=0.8386 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.839
[S17] round=17 local utility u=0.000000 metrics={'f1_val': 0.6570159794365263, 'auprc': 0.8796305592257971, 'loss_val': 0.8436606548755776, 'psi': 0.7460618113522346}-{'f1_val': 0.7037845358005158, 'auprc': 0.9042071372972228, 'loss_val': 0.5628850671310012, 'psi': 0.7839535763991986}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:39411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:39410
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.906)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:39408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:39409
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:39403
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.996)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:39403
[S16] not sending this round → trigger blocked (psi=0.805)
[S3] not sending this round → trigger blocked (psi=0.818)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S15] → sending delta(kind=head bytes=1789) to S10@127.0.0.1:39411
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1795 to 1 peers)
[S15] sending update (kind=head size=1789 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1798) from S10
[S7] cosine check vs S10: cos=0.4466
[S3] RECEIVED delta(kind=head bytes=1796) from S8
[S3] cosine check vs S8: cos=-0.0803
[S3] DROPPED delta from S8 (cos=-0.0803 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1800) from S9
[S3] cosine check vs S9: cos=-0.0818
[S3] DROPPED delta from S9 (cos=-0.0818 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1789) from S15
[S10] cosine check vs S15: cos=0.6940
[S8] RECEIVED delta(kind=head bytes=1798) from S6
[S8] cosine check vs S6: cos=0.7020
[S9] RECEIVED delta(kind=head bytes=1799) from S5
[S9] cosine check vs S5: cos=-0.0531
[S9] DROPPED delta from S5 (cos=-0.0531 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1795) from S2
[S10] cosine check vs S2: cos=0.7373
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=17 metric=0.5292 head_norm=1.186716
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.727726e-01
[S7] stored merged vector for next round verification (round=17)
[S7] DEBUG after merge:  round=17 metric=0.5685 head_norm=1.082381 delta_norm=0.672773
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=17 metric=0.9942 head_norm=1.305000
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.452269e-01
[S8] stored merged vector for next round verification (round=17)
[S8] DEBUG after merge:  round=17 metric=0.9942 head_norm=1.440691 delta_norm=0.645227
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=17 metric=0.9939 head_norm=1.356485
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.991733e-01
[S10] stored merged vector for next round verification (round=17)
[S10] DEBUG after merge:  round=17 metric=0.9939 head_norm=1.231580 delta_norm=0.299173
[S10] aggregate: ACCEPT kept=['S15', 'S2'] (k=2/2) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.902995 cos_to_last_merge=0.9995 (last merge round=15)
[S2] round=18 local utility u=0.000000 metrics={'f1_val': 0.6291036503766776, 'auprc': 0.7248576910337683, 'loss_val': 1.053218636000364, 'psi': 0.6674052666395138}-{'f1_val': 0.6661401242333452, 'auprc': 0.7258853045281277, 'loss_val': 0.7956694429094916, 'psi': 0.6900381963512583}
[S3] START round=18 head_norm_before_train=1.745788 (no previous merge yet)
[S3] round=18 local utility u=0.005471 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9951129730577906, 'loss_val': 0.26762191640523836, 'psi': 0.818498911464296}-{'f1_val': 0.7007562037352997, 'auprc': 0.9937341275199941, 'loss_val': 0.274427209856502, 'psi': 0.8179473732491774}
[S4] START round=18 head_norm_before_train=1.871106 (no previous merge yet)
[S4] round=18 local utility u=0.012660 metrics={'f1_val': 0.9415542919212957, 'auprc': 0.9623412565101496, 'loss_val': 0.29774597137835007, 'psi': 0.9498690777568373}-{'f1_val': 0.941813858397198, 'auprc': 0.9535775069039855, 'loss_val': 0.2983311802655344, 'psi': 0.9465193177999129}
[S5] START round=18 head_norm_before_train=1.655315 (no previous merge yet)
[S5] round=18 local utility u=0.018314 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9962444302114299, 'loss_val': 0.2686076778013532, 'psi': 0.8188628076821766}-{'f1_val': 0.7006083926626743, 'auprc': 0.989169289599859, 'loss_val': 0.2840096048470619, 'psi': 0.8160327514375482}
[S6] START round=18 head_norm_before_train=1.811295 (no previous merge yet)
[S6] round=18 local utility u=0.490698 metrics={'f1_val': 0.8661556458866662, 'auprc': 0.9631482787081507, 'loss_val': 0.364909999458126, 'psi': 0.90495269901526}-{'f1_val': 0.7433841855839706, 'auprc': 0.9510254918512182, 'loss_val': 0.5733090774331983, 'psi': 0.8264407080908697}
[S7] START round=18 head_norm_before_train=1.082381 cos_to_last_merge=1.0000 (last merge round=17)
[S7] round=18 local utility u=0.000000 metrics={'f1_val': 0.4806462858528864, 'auprc': 0.7659609908526057, 'loss_val': 0.8922592335824647, 'psi': 0.5947721678527742}-{'f1_val': 0.5291724227818477, 'auprc': 0.7791980292195481, 'loss_val': 0.8539650668273004, 'psi': 0.6291826653569279}
[S8] START round=18 head_norm_before_train=1.440691 cos_to_last_merge=1.0000 (last merge round=17)
[S8] round=18 local utility u=0.063568 metrics={'f1_val': 0.9949323051384696, 'auprc': 0.9992411612560879, 'loss_val': 0.0750602371209168, 'psi': 0.996655847585517}-{'f1_val': 0.9942060797282372, 'auprc': 0.9993807908851771, 'loss_val': 0.19825767037173236, 'psi': 0.996275964191013}
[S9] START round=18 head_norm_before_train=1.484305 cos_to_last_merge=0.8337 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.834
[S9] round=18 local utility u=0.008888 metrics={'f1_val': 0.9895530216146718, 'auprc': 0.9988555400907219, 'loss_val': 0.09365558117009026, 'psi': 0.9932740290050919}-{'f1_val': 0.9916350289240425, 'auprc': 0.9984622050538167, 'loss_val': 0.12274301754962251, 'psi': 0.9943658993759522}
[S10] START round=18 head_norm_before_train=1.231580 cos_to_last_merge=1.0000 (last merge round=17)
[S10] round=18 local utility u=0.000000 metrics={'f1_val': 0.9931477914946747, 'auprc': 0.9961002295194872, 'loss_val': 0.13788729917872572, 'psi': 0.9943287667045997}-{'f1_val': 0.993871046050545, 'auprc': 0.9935062003595109, 'loss_val': 0.08906892820128348, 'psi': 0.9937251077741314}
[S11] START round=18 head_norm_before_train=1.526704 cos_to_last_merge=0.8180 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.818
[S11] round=18 local utility u=0.171703 metrics={'f1_val': 0.9166891882108064, 'auprc': 0.9967064832720817, 'loss_val': 0.27152900234170413, 'psi': 0.9486961062353165}-{'f1_val': 0.8445296811295857, 'auprc': 0.997856907479535, 'loss_val': 0.18542965868393452, 'psi': 0.9058605716695655}
[S13] START round=18 head_norm_before_train=1.680918 (no previous merge yet)
[S13] round=18 local utility u=0.279006 metrics={'f1_val': 0.6044935833268694, 'auprc': 0.6883687869258404, 'loss_val': 0.7112162675391382, 'psi': 0.6380436647664578}-{'f1_val': 0.5491801016461616, 'auprc': 0.6956421948401345, 'loss_val': 0.9591685141885113, 'psi': 0.6077649389237507}
[S14] START round=18 head_norm_before_train=1.690245 (no previous merge yet)
[S14] round=18 local utility u=0.018829 metrics={'f1_val': 0.9976760408229349, 'auprc': 0.9974187575463158, 'loss_val': 0.1003246658879932, 'psi': 0.9975731275122873}-{'f1_val': 0.9942958007018045, 'auprc': 0.998985190119038, 'loss_val': 0.12239994803801686, 'psi': 0.9961715564686978}
[S15] START round=18 head_norm_before_train=1.010538 cos_to_last_merge=0.9965 (last merge round=16)
[S15] round=18 local utility u=0.000000 metrics={'f1_val': 0.8747232416747504, 'auprc': 0.9921932925330106, 'loss_val': 0.34156550853844364, 'psi': 0.9217112620180544}-{'f1_val': 0.8989760715278742, 'auprc': 0.9915096093979323, 'loss_val': 0.36056707169514185, 'psi': 0.9359894866758975}
[S16] START round=18 head_norm_before_train=1.500714 cos_to_last_merge=0.7811 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.781
[S16] round=18 local utility u=0.373741 metrics={'f1_val': 0.8184696263904185, 'auprc': 0.9087042269771777, 'loss_val': 0.5743007146591474, 'psi': 0.8545634666251223}-{'f1_val': 0.8201614988612891, 'auprc': 0.7823290280831359, 'loss_val': 0.9528089913166099, 'psi': 0.8050285105500278}
[S17] START round=18 head_norm_before_train=1.660884 cos_to_last_merge=0.8360 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.836
[S17] round=18 local utility u=0.000000 metrics={'f1_val': 0.6598471987476157, 'auprc': 0.8868872627364057, 'loss_val': 0.9033372852275191, 'psi': 0.7506632243431317}-{'f1_val': 0.6570159794365263, 'auprc': 0.8796305592257971, 'loss_val': 0.8436606548755776, 'psi': 0.7460618113522346}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:39415
[S5] not sending this round → trigger blocked (psi=0.819)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:39407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:39415
[S6] not sending this round → trigger blocked (psi=0.905)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S11] → sending delta(kind=head bytes=1807) to S7@127.0.0.1:39408
[S9] not sending this round → trigger blocked (psi=0.993)
[S8] not sending this round → trigger blocked (psi=0.997)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S14] → sending delta(kind=head bytes=1808) to S6@127.0.0.1:39407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S2@127.0.0.1:39402
[S14] sending update (kind=head size=1808 to 1 peers)
[S11] sending update (kind=head size=1807 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1803 to 1 peers)
[S4] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1807) from S11
[S7] cosine check vs S11: cos=0.6165
[S6] RECEIVED delta(kind=head bytes=1808) from S14
[S6] cosine check vs S14: cos=-0.0483
[S6] DROPPED delta from S14 (cos=-0.0483 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1796) from S3
[S15] cosine check vs S3: cos=0.5959
[S6] RECEIVED delta(kind=head bytes=1803) from S16
[S6] cosine check vs S16: cos=-0.0074
[S6] DROPPED delta from S16 (cos=-0.0074 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1803) from S4
[S2] cosine check vs S4: cos=0.9941
[S15] RECEIVED delta(kind=head bytes=1800) from S13
[S15] cosine check vs S13: cos=0.5162
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=18 metric=0.4806 head_norm=1.115357
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.185550e-01
[S7] stored merged vector for next round verification (round=18)
[S7] DEBUG after merge:  round=18 metric=0.4404 head_norm=1.206049 delta_norm=0.618555
[S7] aggregate: ROLLBACK (f1_val pre=0.481 post=0.440 tol_abs=0.005 tol_rel=0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=18 metric=0.6291 head_norm=1.913875
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.040634e-01
[S2] stored merged vector for next round verification (round=18)
[S2] DEBUG after merge:  round=18 metric=0.6318 head_norm=1.900800 delta_norm=0.104063
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=18 metric=0.8747 head_norm=1.088766
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.996446e-01
[S15] stored merged vector for next round verification (round=18)
[S15] DEBUG after merge:  round=18 metric=0.8807 head_norm=1.099591 delta_norm=0.399645
[S15] aggregate: ACCEPT kept=['S3', 'S13'] (k=2/2) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.900800 cos_to_last_merge=1.0000 (last merge round=18)
[S2] round=19 local utility u=0.051691 metrics={'f1_val': 0.6285163756456382, 'auprc': 0.7403853120302697, 'loss_val': 0.9928958406862559, 'psi': 0.6732639501994908}-{'f1_val': 0.6291036503766776, 'auprc': 0.7248576910337683, 'loss_val': 1.053218636000364, 'psi': 0.6674052666395138}
[S3] START round=19 head_norm_before_train=1.769760 (no previous merge yet)
[S3] round=19 local utility u=0.004614 metrics={'f1_val': 0.7009355793019081, 'auprc': 0.9952656400696714, 'loss_val': 0.259927406992334, 'psi': 0.8186676036090135}-{'f1_val': 0.7007562037352997, 'auprc': 0.9951129730577906, 'loss_val': 0.26762191640523836, 'psi': 0.818498911464296}
[S4] START round=19 head_norm_before_train=1.893362 (no previous merge yet)
[S4] round=19 local utility u=0.039847 metrics={'f1_val': 0.9452473106963711, 'auprc': 0.9779601856730302, 'loss_val': 0.28706757335816924, 'psi': 0.9583324606870347}-{'f1_val': 0.9415542919212957, 'auprc': 0.9623412565101496, 'loss_val': 0.29774597137835007, 'psi': 0.9498690777568373}
[S5] START round=19 head_norm_before_train=1.671381 (no previous merge yet)
[S5] round=19 local utility u=0.000000 metrics={'f1_val': 0.7144667326210086, 'auprc': 0.7915982194155262, 'loss_val': 0.4895811379118143, 'psi': 0.7453193273388157}-{'f1_val': 0.7006083926626743, 'auprc': 0.9962444302114299, 'loss_val': 0.2686076778013532, 'psi': 0.8188628076821766}
[S6] START round=19 head_norm_before_train=1.829884 (no previous merge yet)
[S6] round=19 local utility u=0.067368 metrics={'f1_val': 0.8706061608846034, 'auprc': 0.9711341166629344, 'loss_val': 0.28083414101737086, 'psi': 0.9108173431959358}-{'f1_val': 0.8661556458866662, 'auprc': 0.9631482787081507, 'loss_val': 0.364909999458126, 'psi': 0.90495269901526}
[S7] START round=19 head_norm_before_train=1.206049 cos_to_last_merge=1.0000 (last merge round=18)
[S7] round=19 local utility u=0.617375 metrics={'f1_val': 0.6360012196682592, 'auprc': 0.7931794813561988, 'loss_val': 0.6712949661843131, 'psi': 0.698872524343435}-{'f1_val': 0.4806462858528864, 'auprc': 0.7659609908526057, 'loss_val': 0.8922592335824647, 'psi': 0.5947721678527742}
[S8] START round=19 head_norm_before_train=1.538823 cos_to_last_merge=0.9975 (last merge round=17)
[S8] round=19 local utility u=0.003600 metrics={'f1_val': 0.9945027674103043, 'auprc': 0.9981678506975982, 'loss_val': 0.06206228814116956, 'psi': 0.9959688007252219}-{'f1_val': 0.9949323051384696, 'auprc': 0.9992411612560879, 'loss_val': 0.0750602371209168, 'psi': 0.996655847585517}
[S9] START round=19 head_norm_before_train=1.517944 cos_to_last_merge=0.8274 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.827
[S9] round=19 local utility u=0.018410 metrics={'f1_val': 0.9916752349893785, 'auprc': 0.9988488219600482, 'loss_val': 0.06954793913148774, 'psi': 0.9945446697776464}-{'f1_val': 0.9895530216146718, 'auprc': 0.9988555400907219, 'loss_val': 0.09365558117009026, 'psi': 0.9932740290050919}
[S10] START round=19 head_norm_before_train=1.287758 cos_to_last_merge=0.9985 (last merge round=17)
[S10] round=19 local utility u=0.015361 metrics={'f1_val': 0.9940903254969471, 'auprc': 0.9936187299823928, 'loss_val': 0.10537572092508113, 'psi': 0.9939016872911254}-{'f1_val': 0.9931477914946747, 'auprc': 0.9961002295194872, 'loss_val': 0.13788729917872572, 'psi': 0.9943287667045997}
[S11] START round=19 head_norm_before_train=1.558944 cos_to_last_merge=0.8115 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.811
[S11] round=19 local utility u=0.282506 metrics={'f1_val': 0.9967189926998994, 'auprc': 0.9964534327878491, 'loss_val': 0.18593614928575516, 'psi': 0.9966127687350792}-{'f1_val': 0.9166891882108064, 'auprc': 0.9967064832720817, 'loss_val': 0.27152900234170413, 'psi': 0.9486961062353165}
[S13] START round=19 head_norm_before_train=1.691617 (no previous merge yet)
[S13] round=19 local utility u=0.000000 metrics={'f1_val': 0.580559136540062, 'auprc': 0.6911187906654892, 'loss_val': 0.8653054769254692, 'psi': 0.6247829981902329}-{'f1_val': 0.6044935833268694, 'auprc': 0.6883687869258404, 'loss_val': 0.7112162675391382, 'psi': 0.6380436647664578}
[S14] START round=19 head_norm_before_train=1.714543 (no previous merge yet)
[S14] round=19 local utility u=0.007343 metrics={'f1_val': 0.9980871226256064, 'auprc': 0.9974323737673261, 'loss_val': 0.08814669622243554, 'psi': 0.9978252230822944}-{'f1_val': 0.9976760408229349, 'auprc': 0.9974187575463158, 'loss_val': 0.1003246658879932, 'psi': 0.9975731275122873}
[S15] START round=19 head_norm_before_train=1.099591 cos_to_last_merge=1.0000 (last merge round=18)
[S15] round=19 local utility u=0.107545 metrics={'f1_val': 0.9150397398262288, 'auprc': 0.9886670947978211, 'loss_val': 0.35779653586276516, 'psi': 0.9444906818148657}-{'f1_val': 0.8747232416747504, 'auprc': 0.9921932925330106, 'loss_val': 0.34156550853844364, 'psi': 0.9217112620180544}
[S16] START round=19 head_norm_before_train=1.531081 cos_to_last_merge=0.7758 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.776
[S16] round=19 local utility u=0.000000 metrics={'f1_val': 0.8240824821152444, 'auprc': 0.7861489194218391, 'loss_val': 0.9957331205528595, 'psi': 0.8089090570378823}-{'f1_val': 0.8184696263904185, 'auprc': 0.9087042269771777, 'loss_val': 0.5743007146591474, 'psi': 0.8545634666251223}
[S17] START round=19 head_norm_before_train=1.686734 cos_to_last_merge=0.8338 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.834
[S17] round=19 local utility u=0.140140 metrics={'f1_val': 0.6764875976378654, 'auprc': 0.8955362104586333, 'loss_val': 0.7488467811934655, 'psi': 0.7641070427661726}-{'f1_val': 0.6598471987476157, 'auprc': 0.8868872627364057, 'loss_val': 0.9033372852275191, 'psi': 0.7506632243431317}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:39403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:39415
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:39402
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:39415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1810 reason=None
[S14] → sending delta(kind=head bytes=1810) to S6@127.0.0.1:39407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:39408
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:39403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] → sending delta(kind=head bytes=1805) to S7@127.0.0.1:39408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:39411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:39409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] → sending delta(kind=head bytes=1793) to S10@127.0.0.1:39411
[S6] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1805 to 1 peers)
[S15] sending update (kind=head size=1793 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1810 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1793) from S15
[S10] cosine check vs S15: cos=0.5556
[S10] RECEIVED delta(kind=head bytes=1802) from S2
[S10] cosine check vs S2: cos=0.7983
[S8] RECEIVED delta(kind=head bytes=1799) from S6
[S8] cosine check vs S6: cos=0.9416
[S3] RECEIVED delta(kind=head bytes=1801) from S9
[S3] cosine check vs S9: cos=-0.0823
[S3] DROPPED delta from S9 (cos=-0.0823 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1802) from S8
[S3] cosine check vs S8: cos=-0.1196
[S3] DROPPED delta from S8 (cos=-0.1196 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1796) from S7
[S15] cosine check vs S7: cos=0.3166
[S15] RECEIVED delta(kind=head bytes=1801) from S3
[S15] cosine check vs S3: cos=0.6921
[S7] RECEIVED delta(kind=head bytes=1805) from S11
[S7] cosine check vs S11: cos=0.9268
[S7] RECEIVED delta(kind=head bytes=1797) from S10
[S7] cosine check vs S10: cos=0.5117
[S6] RECEIVED delta(kind=head bytes=1810) from S14
[S6] cosine check vs S14: cos=-0.0488
[S6] DROPPED delta from S14 (cos=-0.0488 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1800) from S4
[S2] cosine check vs S4: cos=0.9976
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:39409
[S17] sending update (kind=head size=1795 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1795) from S17
[S8] cosine check vs S17: cos=0.2806
[S5] r=20 psi=0.745 u=0.0000 p_local=0.1044 f1=0.714 auprc=0.792 bytes=21556
[S13] r=20 psi=0.625 u=0.0000 p_local=0.1169 f1=0.581 auprc=0.691 bytes=16183
[S10] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=19 metric=0.9941 head_norm=1.335434
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.491131e-01
[S10] stored merged vector for next round verification (round=19)
[S10] DEBUG after merge:  round=19 metric=0.9939 head_norm=1.230914 delta_norm=0.249113
[S10] aggregate: ACCEPT kept=['S15', 'S2'] (k=2/2) mode=median trim_p=0.1
[S10] r=20 psi=0.994 u=0.0154 p_local=0.0771 f1=0.994 auprc=0.994 bytes=23344
[S11] r=20 psi=0.997 u=0.2825 p_local=0.2255 f1=0.997 auprc=0.996 bytes=23392
[S6] r=20 psi=0.911 u=0.0674 p_local=0.2397 f1=0.871 auprc=0.971 bytes=23351
[S3] r=20 psi=0.819 u=0.0046 p_local=0.0875 f1=0.701 auprc=0.995 bytes=19764
[S14] r=20 psi=0.998 u=0.0073 p_local=0.1170 f1=0.998 auprc=0.997 bytes=25182
[S9] r=20 psi=0.995 u=0.0184 p_local=0.1255 f1=0.992 auprc=0.999 bytes=19760
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=19 metric=0.6360 head_norm=1.234916
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.756050e-01
[S7] stored merged vector for next round verification (round=19)
[S7] DEBUG after merge:  round=19 metric=0.6280 head_norm=1.165740 delta_norm=0.175605
[S7] aggregate: ROLLBACK (f1_val pre=0.636 post=0.628 tol_abs=0.005 tol_rel=0.0)
[S7] r=20 psi=0.699 u=0.6174 p_local=0.2927 f1=0.636 auprc=0.793 bytes=17970
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=19 metric=0.9945 head_norm=1.604132
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.861442e-01
[S8] stored merged vector for next round verification (round=19)
[S8] DEBUG after merge:  round=19 metric=0.9945 head_norm=1.387545 delta_norm=0.386144
[S8] aggregate: ACCEPT kept=['S6', 'S17'] (k=2/2) mode=median trim_p=0.1
[S8] r=20 psi=0.996 u=0.0036 p_local=0.1615 f1=0.995 auprc=0.998 bytes=23383
[S4] r=20 psi=0.958 u=0.0398 p_local=0.0843 f1=0.945 auprc=0.978 bytes=21593
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=19 metric=0.9150 head_norm=1.171332
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.011358e-01
[S15] stored merged vector for next round verification (round=19)
[S15] DEBUG after merge:  round=19 metric=0.8955 head_norm=1.056612 delta_norm=0.401136
[S15] aggregate: ROLLBACK (f1_val pre=0.915 post=0.896 tol_abs=0.005 tol_rel=0.0)
[S15] r=20 psi=0.944 u=0.1075 p_local=0.1820 f1=0.915 auprc=0.989 bytes=21515
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=19 metric=0.6285 head_norm=1.910780
[S2] _apply_head_vector_avg (torch): Δ‖w‖=6.673469e-02
[S2] stored merged vector for next round verification (round=19)
[S2] DEBUG after merge:  round=19 metric=0.6304 head_norm=1.903736 delta_norm=0.066735
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] r=20 psi=0.673 u=0.0517 p_local=0.0587 f1=0.629 auprc=0.740 bytes=16192
[S16] r=20 psi=0.809 u=0.0000 p_local=0.1868 f1=0.824 auprc=0.786 bytes=21543
[S17] r=20 psi=0.764 u=0.1401 p_local=0.1444 f1=0.676 auprc=0.896 bytes=17987
[S2] START round=20 head_norm_before_train=1.903736 cos_to_last_merge=1.0000 (last merge round=19)
[S2] round=20 local utility u=0.272684 metrics={'f1_val': 0.6809477718595247, 'auprc': 0.7433162723287485, 'loss_val': 0.7709083691263212, 'psi': 0.7058951720472142}-{'f1_val': 0.6285163756456382, 'auprc': 0.7403853120302697, 'loss_val': 0.9928958406862559, 'psi': 0.6732639501994908}
[S3] START round=20 head_norm_before_train=1.792471 (no previous merge yet)
[S3] round=20 local utility u=0.000000 metrics={'f1_val': 0.7006060025002057, 'auprc': 0.988394652560855, 'loss_val': 0.26533751140269085, 'psi': 0.8157214625244653}-{'f1_val': 0.7009355793019081, 'auprc': 0.9952656400696714, 'loss_val': 0.259927406992334, 'psi': 0.8186676036090135}
[S4] START round=20 head_norm_before_train=1.899012 (no previous merge yet)
[S4] round=20 local utility u=0.033855 metrics={'f1_val': 0.9530498746045876, 'auprc': 0.9827945335604407, 'loss_val': 0.2806764765428839, 'psi': 0.9649477381869288}-{'f1_val': 0.9452473106963711, 'auprc': 0.9779601856730302, 'loss_val': 0.28706757335816924, 'psi': 0.9583324606870347}
[S5] START round=20 head_norm_before_train=1.689670 (no previous merge yet)
[S5] round=20 local utility u=0.385986 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9960882958313656, 'loss_val': 0.24792849902850503, 'psi': 0.8188003539301508}-{'f1_val': 0.7144667326210086, 'auprc': 0.7915982194155262, 'loss_val': 0.4895811379118143, 'psi': 0.7453193273388157}
[S6] START round=20 head_norm_before_train=1.842407 (no previous merge yet)
[S6] round=20 local utility u=0.429800 metrics={'f1_val': 0.9839024724501167, 'auprc': 0.9817372967407384, 'loss_val': 0.13282181555641695, 'psi': 0.9830364021663653}-{'f1_val': 0.8706061608846034, 'auprc': 0.9711341166629344, 'loss_val': 0.28083414101737086, 'psi': 0.9108173431959358}
[S7] START round=20 head_norm_before_train=1.165740 cos_to_last_merge=1.0000 (last merge round=19)
[S7] round=20 local utility u=0.000000 metrics={'f1_val': 0.5252174950989988, 'auprc': 0.771441753879155, 'loss_val': 0.9093473539888176, 'psi': 0.6237071986110614}-{'f1_val': 0.6360012196682592, 'auprc': 0.7931794813561988, 'loss_val': 0.6712949661843131, 'psi': 0.698872524343435}
[S8] START round=20 head_norm_before_train=1.387545 cos_to_last_merge=1.0000 (last merge round=19)
[S8] round=20 local utility u=0.000000 metrics={'f1_val': 0.994753542178155, 'auprc': 0.9988191491923868, 'loss_val': 0.08806310011138505, 'psi': 0.9963797849838478}-{'f1_val': 0.9945027674103043, 'auprc': 0.9981678506975982, 'loss_val': 0.06206228814116956, 'psi': 0.9959688007252219}
[S9] START round=20 head_norm_before_train=1.548986 cos_to_last_merge=0.8220 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.822
[S9] round=20 local utility u=0.002851 metrics={'f1_val': 0.9908021981609972, 'auprc': 0.9988465785938343, 'loss_val': 0.058601267900745976, 'psi': 0.994019950334132}-{'f1_val': 0.9916752349893785, 'auprc': 0.9988488219600482, 'loss_val': 0.06954793913148774, 'psi': 0.9945446697776464}
[S10] START round=20 head_norm_before_train=1.230914 cos_to_last_merge=1.0000 (last merge round=19)
[S10] round=20 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9918046081205443, 'loss_val': 0.1677572962076863, 'psi': 0.9937027551672635}-{'f1_val': 0.9940903254969471, 'auprc': 0.9936187299823928, 'loss_val': 0.10537572092508113, 'psi': 0.9939016872911254}
[S11] START round=20 head_norm_before_train=1.583538 cos_to_last_merge=0.8068 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.807
[S11] round=20 local utility u=0.019389 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9976826962466225, 'loss_val': 0.14836212175510308, 'psi': 0.9968561789799656}-{'f1_val': 0.9967189926998994, 'auprc': 0.9964534327878491, 'loss_val': 0.18593614928575516, 'psi': 0.9966127687350792}
[S13] START round=20 head_norm_before_train=1.703900 (no previous merge yet)
[S13] round=20 local utility u=0.000000 metrics={'f1_val': 0.5760885171765121, 'auprc': 0.6922254437971, 'loss_val': 0.8945626242267957, 'psi': 0.6225432878247472}-{'f1_val': 0.580559136540062, 'auprc': 0.6911187906654892, 'loss_val': 0.8653054769254692, 'psi': 0.6247829981902329}
[S14] START round=20 head_norm_before_train=1.738198 (no previous merge yet)
[S14] round=20 local utility u=0.000816 metrics={'f1_val': 0.9978207838439215, 'auprc': 0.9972771597715792, 'loss_val': 0.08445062770170574, 'psi': 0.9976033342149846}-{'f1_val': 0.9980871226256064, 'auprc': 0.9974323737673261, 'loss_val': 0.08814669622243554, 'psi': 0.9978252230822944}
[S15] START round=20 head_norm_before_train=1.056612 cos_to_last_merge=1.0000 (last merge round=19)
[S15] round=20 local utility u=0.220804 metrics={'f1_val': 0.9748832797160609, 'auprc': 0.9957522251514753, 'loss_val': 0.2965059873924062, 'psi': 0.9832308578902267}-{'f1_val': 0.9150397398262288, 'auprc': 0.9886670947978211, 'loss_val': 0.35779653586276516, 'psi': 0.9444906818148657}
[S16] START round=20 head_norm_before_train=1.560833 cos_to_last_merge=0.7705 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.771
[S16] round=20 local utility u=1.000000 metrics={'f1_val': 0.9355222687722835, 'auprc': 0.987390956608627, 'loss_val': 0.2560269457412966, 'psi': 0.9562697439068208}-{'f1_val': 0.8240824821152444, 'auprc': 0.7861489194218391, 'loss_val': 0.9957331205528595, 'psi': 0.8089090570378823}
[S17] START round=20 head_norm_before_train=1.709643 cos_to_last_merge=0.8320 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.832
[S17] round=20 local utility u=0.000000 metrics={'f1_val': 0.6705526289020504, 'auprc': 0.898174458815086, 'loss_val': 0.8812496066666824, 'psi': 0.7616013608672646}-{'f1_val': 0.6764875976378654, 'auprc': 0.8955362104586333, 'loss_val': 0.7488467811934655, 'psi': 0.7641070427661726}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:39403
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:39402
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:39407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:39407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:39411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:39409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S15] → sending delta(kind=head bytes=1789) to S10@127.0.0.1:39411
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:39410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:39408
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1789 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1803) from S11
[S7] cosine check vs S11: cos=0.8772
[S6] RECEIVED delta(kind=head bytes=1803) from S14
[S6] cosine check vs S14: cos=-0.0494
[S6] DROPPED delta from S14 (cos=-0.0494 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1796) from S6
[S8] cosine check vs S6: cos=0.8778
[S10] RECEIVED delta(kind=head bytes=1789) from S15
[S10] cosine check vs S15: cos=0.5824
[S10] RECEIVED delta(kind=head bytes=1799) from S2
[S10] cosine check vs S2: cos=0.8236
[S6] RECEIVED delta(kind=head bytes=1800) from S16
[S6] cosine check vs S16: cos=-0.0062
[S6] DROPPED delta from S16 (cos=-0.0062 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1800) from S5
[S9] cosine check vs S5: cos=-0.0523
[S9] DROPPED delta from S5 (cos=-0.0523 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1798) from S9
[S3] cosine check vs S9: cos=-0.0830
[S3] DROPPED delta from S9 (cos=-0.0830 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1800) from S4
[S2] cosine check vs S4: cos=0.9987
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] ⇄ pheromone p=0.070 → S15@127.0.0.1:39415
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=20 metric=0.5252 head_norm=1.185002
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.020627e-01
[S7] stored merged vector for next round verification (round=20)
[S7] DEBUG after merge:  round=20 metric=0.5231 head_norm=1.353814 delta_norm=0.402063
[S7] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.234 → S15@127.0.0.1:39415
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=20 metric=0.9948 head_norm=1.439059
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.554676e-01
[S8] stored merged vector for next round verification (round=20)
[S8] DEBUG after merge:  round=20 metric=0.9946 head_norm=1.598469 delta_norm=0.455468
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.129 → S3@127.0.0.1:39403
[S10] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=20 metric=0.9950 head_norm=1.287201
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.007500e-01
[S10] stored merged vector for next round verification (round=20)
[S10] DEBUG after merge:  round=20 metric=0.9947 head_norm=1.214145 delta_norm=0.200750
[S10] aggregate: ACCEPT kept=['S15', 'S2'] (k=2/2) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.062 → S7@127.0.0.1:39408
[S13] ⇄ pheromone p=0.093 → S15@127.0.0.1:39415
[S11] ⇄ pheromone p=0.184 → S7@127.0.0.1:39408
[S15] ⇄ pheromone p=0.190 → S10@127.0.0.1:39411
[S9] ⇄ pheromone p=0.101 → S3@127.0.0.1:39403
[S4] ⇄ pheromone p=0.074 → S2@127.0.0.1:39402
[S5] ⇄ pheromone p=0.161 → S9@127.0.0.1:39410
[S6] ⇄ pheromone p=0.278 → S8@127.0.0.1:39409
[S16] ⇄ pheromone p=0.349 → S6@127.0.0.1:39407
[S14] ⇄ pheromone p=0.094 → S6@127.0.0.1:39407
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=20 metric=0.6809 head_norm=1.913340
[S2] _apply_head_vector_avg (torch): Δ‖w‖=4.879504e-02
[S2] stored merged vector for next round verification (round=20)
[S2] DEBUG after merge:  round=20 metric=0.6769 head_norm=1.911211 delta_norm=0.048795
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.101 → S10@127.0.0.1:39411
[S17] ⇄ pheromone p=0.116 → S8@127.0.0.1:39409
[S2] START round=21 head_norm_before_train=1.911211 cos_to_last_merge=1.0000 (last merge round=20)
[S2] round=21 local utility u=0.000000 metrics={'f1_val': 0.6192349829732765, 'auprc': 0.6886260302015719, 'loss_val': 0.9553582476217977, 'psi': 0.6469914018645946}-{'f1_val': 0.6809477718595247, 'auprc': 0.7433162723287485, 'loss_val': 0.7709083691263212, 'psi': 0.7058951720472142}
[S3] START round=21 head_norm_before_train=1.811357 (no previous merge yet)
[S3] round=21 local utility u=0.018732 metrics={'f1_val': 0.7006060025002057, 'auprc': 0.9965671783146829, 'loss_val': 0.2523908541780015, 'psi': 0.8189904728259965}-{'f1_val': 0.7006060025002057, 'auprc': 0.988394652560855, 'loss_val': 0.26533751140269085, 'psi': 0.8157214625244653}
[S4] START round=21 head_norm_before_train=1.910326 (no previous merge yet)
[S4] round=21 local utility u=0.000000 metrics={'f1_val': 0.9444832974771867, 'auprc': 0.9612195720080243, 'loss_val': 0.29157225594762626, 'psi': 0.9511778072895217}-{'f1_val': 0.9530498746045876, 'auprc': 0.9827945335604407, 'loss_val': 0.2806764765428839, 'psi': 0.9649477381869288}
[S5] START round=21 head_norm_before_train=1.705573 (no previous merge yet)
[S5] round=21 local utility u=0.000000 metrics={'f1_val': 0.7144667326210086, 'auprc': 0.7923968053672384, 'loss_val': 0.46845706876098336, 'psi': 0.7456387617195006}-{'f1_val': 0.7006083926626743, 'auprc': 0.9960882958313656, 'loss_val': 0.24792849902850503, 'psi': 0.8188003539301508}
[S6] START round=21 head_norm_before_train=1.858552 (no previous merge yet)
[S6] round=21 local utility u=0.000000 metrics={'f1_val': 0.6848421549086368, 'auprc': 0.935020533805697, 'loss_val': 0.7231958596741259, 'psi': 0.7849135064674608}-{'f1_val': 0.9839024724501167, 'auprc': 0.9817372967407384, 'loss_val': 0.13282181555641695, 'psi': 0.9830364021663653}
[S7] START round=21 head_norm_before_train=1.353814 cos_to_last_merge=1.0000 (last merge round=20)
[S7] round=21 local utility u=0.139555 metrics={'f1_val': 0.5585884850489148, 'auprc': 0.777346302944881, 'loss_val': 0.8481779339518386, 'psi': 0.6460916122073013}-{'f1_val': 0.5252174950989988, 'auprc': 0.771441753879155, 'loss_val': 0.9093473539888176, 'psi': 0.6237071986110614}
[S8] START round=21 head_norm_before_train=1.598469 cos_to_last_merge=1.0000 (last merge round=20)
[S8] round=21 local utility u=0.000000 metrics={'f1_val': 0.9912324562030403, 'auprc': 0.9959410901030933, 'loss_val': 0.0685332697483095, 'psi': 0.9931159097630615}-{'f1_val': 0.994753542178155, 'auprc': 0.9988191491923868, 'loss_val': 0.08806310011138505, 'psi': 0.9963797849838478}
[S9] START round=21 head_norm_before_train=1.577625 cos_to_last_merge=0.8172 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.817
[S9] round=21 local utility u=0.023282 metrics={'f1_val': 0.9962461149658858, 'auprc': 0.9988434430027147, 'loss_val': 0.04469064839751053, 'psi': 0.9972850461806173}-{'f1_val': 0.9908021981609972, 'auprc': 0.9988465785938343, 'loss_val': 0.058601267900745976, 'psi': 0.994019950334132}
[S10] START round=21 head_norm_before_train=1.214145 cos_to_last_merge=1.0000 (last merge round=20)
[S10] round=21 local utility u=0.005056 metrics={'f1_val': 0.9940903254969471, 'auprc': 0.9915104927487086, 'loss_val': 0.15149614011336732, 'psi': 0.9930583923976517}-{'f1_val': 0.9949681865317428, 'auprc': 0.9918046081205443, 'loss_val': 0.1677572962076863, 'psi': 0.9937027551672635}
[S11] START round=21 head_norm_before_train=1.607701 cos_to_last_merge=0.8029 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.803
[S11] round=21 local utility u=0.021079 metrics={'f1_val': 0.996960829744628, 'auprc': 0.9983452618561441, 'loss_val': 0.11212539878481492, 'psi': 0.9975146025892344}-{'f1_val': 0.996305167468861, 'auprc': 0.9976826962466225, 'loss_val': 0.14836212175510308, 'psi': 0.9968561789799656}
[S13] START round=21 head_norm_before_train=1.712398 (no previous merge yet)
[S13] round=21 local utility u=0.138935 metrics={'f1_val': 0.5994468732116213, 'auprc': 0.6910294756374427, 'loss_val': 0.7532554998915412, 'psi': 0.6360799141819498}-{'f1_val': 0.5760885171765121, 'auprc': 0.6922254437971, 'loss_val': 0.8945626242267957, 'psi': 0.6225432878247472}
[S14] START round=21 head_norm_before_train=1.759978 (no previous merge yet)
[S14] round=21 local utility u=0.003404 metrics={'f1_val': 0.9974331919232962, 'auprc': 0.9957763388863052, 'loss_val': 0.07081453417361197, 'psi': 0.9967704507084998}-{'f1_val': 0.9978207838439215, 'auprc': 0.9972771597715792, 'loss_val': 0.08445062770170574, 'psi': 0.9976033342149846}
[S15] START round=21 head_norm_before_train=1.119481 cos_to_last_merge=0.9966 (last merge round=19)
[S15] round=21 local utility u=0.000000 metrics={'f1_val': 0.7151698453961992, 'auprc': 0.8953075338965366, 'loss_val': 0.45688042083601116, 'psi': 0.7872249207963342}-{'f1_val': 0.9748832797160609, 'auprc': 0.9957522251514753, 'loss_val': 0.2965059873924062, 'psi': 0.9832308578902267}
[S16] START round=21 head_norm_before_train=1.584650 cos_to_last_merge=0.7671 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.767
[S16] round=21 local utility u=0.000000 metrics={'f1_val': 0.876151512053085, 'auprc': 0.983950633364669, 'loss_val': 0.2684472214568371, 'psi': 0.9192711605777186}-{'f1_val': 0.9355222687722835, 'auprc': 0.987390956608627, 'loss_val': 0.2560269457412966, 'psi': 0.9562697439068208}
[S17] START round=21 head_norm_before_train=1.731390 cos_to_last_merge=0.8302 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.830
[S17] round=21 local utility u=0.000000 metrics={'f1_val': 0.6592907500448182, 'auprc': 0.8842988564298844, 'loss_val': 1.1024451757685116, 'psi': 0.7492939925988447}-{'f1_val': 0.6705526289020504, 'auprc': 0.898174458815086, 'loss_val': 0.8812496066666824, 'psi': 0.7616013608672646}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:39407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:39415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:39408
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:39403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] → sending delta(kind=head bytes=1794) to S7@127.0.0.1:39408
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] → sending delta(kind=head bytes=1805) to S15@127.0.0.1:39415
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:39415
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1805 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1794 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1803) from S9
[S3] cosine check vs S9: cos=-0.0837
[S3] DROPPED delta from S9 (cos=-0.0837 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1794) from S10
[S7] cosine check vs S10: cos=0.3557
[S15] RECEIVED delta(kind=head bytes=1796) from S7
[S15] cosine check vs S7: cos=0.3843
[S15] RECEIVED delta(kind=head bytes=1805) from S3
[S15] cosine check vs S3: cos=0.7595
[S15] RECEIVED delta(kind=head bytes=1800) from S13
[S15] cosine check vs S13: cos=0.4267
[S6] RECEIVED delta(kind=head bytes=1800) from S14
[S6] cosine check vs S14: cos=-0.0497
[S6] DROPPED delta from S14 (cos=-0.0497 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1799) from S11
[S7] cosine check vs S11: cos=0.9754
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=21 metric=0.7152 head_norm=1.201309
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.841336e-01
[S15] stored merged vector for next round verification (round=21)
[S15] DEBUG after merge:  round=21 metric=0.7111 head_norm=1.045349 delta_norm=0.284134
[S15] aggregate: ACCEPT kept=['S7', 'S3', 'S13'] (k=3/3) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=21 metric=0.5586 head_norm=1.369375
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.804293e-01
[S7] stored merged vector for next round verification (round=21)
[S7] DEBUG after merge:  round=21 metric=0.5571 head_norm=1.218068 delta_norm=0.280429
[S7] aggregate: ACCEPT kept=['S10', 'S11'] (k=2/2) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=1.920874 cos_to_last_merge=0.9999 (last merge round=20)
[S2] round=22 local utility u=0.400450 metrics={'f1_val': 0.6943074304940152, 'auprc': 0.732181838277129, 'loss_val': 0.7355599380701326, 'psi': 0.7094571936072607}-{'f1_val': 0.6192349829732765, 'auprc': 0.6886260302015719, 'loss_val': 0.9553582476217977, 'psi': 0.6469914018645946}
[S3] START round=22 head_norm_before_train=1.829555 (no previous merge yet)
[S3] round=22 local utility u=0.000000 metrics={'f1_val': 0.7006060025002057, 'auprc': 0.9982910313064157, 'loss_val': 0.27134092988532216, 'psi': 0.8196800140226896}-{'f1_val': 0.7006060025002057, 'auprc': 0.9965671783146829, 'loss_val': 0.2523908541780015, 'psi': 0.8189904728259965}
[S4] START round=22 head_norm_before_train=1.910794 (no previous merge yet)
[S4] round=22 local utility u=0.032051 metrics={'f1_val': 0.9475282038735302, 'auprc': 0.9753570737597885, 'loss_val': 0.28815295214649833, 'psi': 0.9586597518280335}-{'f1_val': 0.9444832974771867, 'auprc': 0.9612195720080243, 'loss_val': 0.29157225594762626, 'psi': 0.9511778072895217}
[S5] START round=22 head_norm_before_train=1.716834 (no previous merge yet)
[S5] round=22 local utility u=0.370186 metrics={'f1_val': 0.7006090940057808, 'auprc': 0.9972027290325445, 'loss_val': 0.25935775101861214, 'psi': 0.8192465480164863}-{'f1_val': 0.7144667326210086, 'auprc': 0.7923968053672384, 'loss_val': 0.46845706876098336, 'psi': 0.7456387617195006}
[S6] START round=22 head_norm_before_train=1.873442 (no previous merge yet)
[S6] round=22 local utility u=0.915198 metrics={'f1_val': 0.8864167374546372, 'auprc': 0.9739708854110315, 'loss_val': 0.21909778089254206, 'psi': 0.921438396637195}-{'f1_val': 0.6848421549086368, 'auprc': 0.935020533805697, 'loss_val': 0.7231958596741259, 'psi': 0.7849135064674608}
[S7] START round=22 head_norm_before_train=1.218068 cos_to_last_merge=1.0000 (last merge round=21)
[S7] round=22 local utility u=0.063981 metrics={'f1_val': 0.5697344628609643, 'auprc': 0.7830645877518425, 'loss_val': 0.804247199110749, 'psi': 0.6550665128173156}-{'f1_val': 0.5585884850489148, 'auprc': 0.777346302944881, 'loss_val': 0.8481779339518386, 'psi': 0.6460916122073013}
[S8] START round=22 head_norm_before_train=1.645380 cos_to_last_merge=0.9996 (last merge round=20)
[S8] round=22 local utility u=0.002567 metrics={'f1_val': 0.9928898770479506, 'auprc': 0.988864103704328, 'loss_val': 0.05211222787736388, 'psi': 0.9912795677105015}-{'f1_val': 0.9912324562030403, 'auprc': 0.9959410901030933, 'loss_val': 0.0685332697483095, 'psi': 0.9931159097630615}
[S9] START round=22 head_norm_before_train=1.603630 cos_to_last_merge=0.8131 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.813
[S9] round=22 local utility u=0.000000 metrics={'f1_val': 0.9925154678702236, 'auprc': 0.9988511814994202, 'loss_val': 0.04439602600826525, 'psi': 0.9950497533219023}-{'f1_val': 0.9962461149658858, 'auprc': 0.9988434430027147, 'loss_val': 0.04469064839751053, 'psi': 0.9972850461806173}
[S10] START round=22 head_norm_before_train=1.289591 cos_to_last_merge=0.9935 (last merge round=20)
[S10] round=22 local utility u=0.026912 metrics={'f1_val': 0.9929696616913117, 'auprc': 0.9924509275830814, 'loss_val': 0.09376962463615211, 'psi': 0.9927621680480196}-{'f1_val': 0.9940903254969471, 'auprc': 0.9915104927487086, 'loss_val': 0.15149614011336732, 'psi': 0.9930583923976517}
[S11] START round=22 head_norm_before_train=1.633543 cos_to_last_merge=0.7993 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.799
[S11] round=22 local utility u=0.007040 metrics={'f1_val': 0.996960829744628, 'auprc': 0.9981354205522224, 'loss_val': 0.0974154935720262, 'psi': 0.9974306660676657}-{'f1_val': 0.996960829744628, 'auprc': 0.9983452618561441, 'loss_val': 0.11212539878481492, 'psi': 0.9975146025892344}
[S13] START round=22 head_norm_before_train=1.718117 (no previous merge yet)
[S13] round=22 local utility u=0.000000 metrics={'f1_val': 0.5809763385367445, 'auprc': 0.6971493980086284, 'loss_val': 0.8575005372595003, 'psi': 0.627445562325498}-{'f1_val': 0.5994468732116213, 'auprc': 0.6910294756374427, 'loss_val': 0.7532554998915412, 'psi': 0.6360799141819498}
[S14] START round=22 head_norm_before_train=1.780004 (no previous merge yet)
[S14] round=22 local utility u=0.008613 metrics={'f1_val': 0.9979187620675374, 'auprc': 0.9971593716898681, 'loss_val': 0.06065147742903564, 'psi': 0.9976150059164697}-{'f1_val': 0.9974331919232962, 'auprc': 0.9957763388863052, 'loss_val': 0.07081453417361197, 'psi': 0.9967704507084998}
[S15] START round=22 head_norm_before_train=1.045349 cos_to_last_merge=1.0000 (last merge round=21)
[S15] round=22 local utility u=0.320645 metrics={'f1_val': 0.7686272321183643, 'auprc': 0.9902875297750664, 'loss_val': 0.4212740296639787, 'psi': 0.8572913511810452}-{'f1_val': 0.7151698453961992, 'auprc': 0.8953075338965366, 'loss_val': 0.45688042083601116, 'psi': 0.7872249207963342}
[S16] START round=22 head_norm_before_train=1.609924 cos_to_last_merge=0.7638 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.764
[S16] round=22 local utility u=0.000000 metrics={'f1_val': 0.8644557496866934, 'auprc': 0.9296259806803828, 'loss_val': 0.622633574731406, 'psi': 0.8905238420841692}-{'f1_val': 0.876151512053085, 'auprc': 0.983950633364669, 'loss_val': 0.2684472214568371, 'psi': 0.9192711605777186}
[S17] START round=22 head_norm_before_train=1.747511 cos_to_last_merge=0.8290 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.829
[S17] round=22 local utility u=0.000000 metrics={'f1_val': 0.6581725436742629, 'auprc': 0.8791353056746827, 'loss_val': 1.1291745439760992, 'psi': 0.7465576484744308}-{'f1_val': 0.6592907500448182, 'auprc': 0.8842988564298844, 'loss_val': 1.1024451757685116, 'psi': 0.7492939925988447}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:39409
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:39408
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:39411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:39402
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:39410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] → sending delta(kind=head bytes=1793) to S10@127.0.0.1:39411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:39403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:39407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] → sending delta(kind=head bytes=1805) to S15@127.0.0.1:39415
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:39408
[S11] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1804 to 1 peers)
[S15] sending update (kind=head size=1793 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1805 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1804 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1793) from S15
[S10] cosine check vs S15: cos=0.5849
[S10] RECEIVED delta(kind=head bytes=1796) from S2
[S10] cosine check vs S2: cos=0.8095
[S15] RECEIVED delta(kind=head bytes=1805) from S7
[S15] cosine check vs S7: cos=0.5329
[S8] RECEIVED delta(kind=head bytes=1804) from S6
[S8] cosine check vs S6: cos=0.9727
[S9] RECEIVED delta(kind=head bytes=1804) from S5
[S9] cosine check vs S5: cos=-0.0516
[S9] DROPPED delta from S5 (cos=-0.0516 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1797) from S10
[S7] cosine check vs S10: cos=0.5134
[S7] RECEIVED delta(kind=head bytes=1800) from S11
[S7] cosine check vs S11: cos=0.9236
[S6] RECEIVED delta(kind=head bytes=1799) from S14
[S6] cosine check vs S14: cos=-0.0501
[S6] DROPPED delta from S14 (cos=-0.0501 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1795) from S8
[S3] cosine check vs S8: cos=-0.1169
[S3] DROPPED delta from S8 (cos=-0.1169 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1801) from S4
[S2] cosine check vs S4: cos=0.9979
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=22 metric=0.6943 head_norm=1.932061
[S2] _apply_head_vector_avg (torch): Δ‖w‖=6.214256e-02
[S2] stored merged vector for next round verification (round=22)
[S2] DEBUG after merge:  round=22 metric=0.6924 head_norm=1.923681 delta_norm=0.062143
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=22 metric=0.9929 head_norm=1.681855
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.318052e-01
[S8] stored merged vector for next round verification (round=22)
[S8] DEBUG after merge:  round=22 metric=0.9929 head_norm=1.771641 delta_norm=0.231805
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=22 metric=0.9930 head_norm=1.371095
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.360594e-01
[S10] stored merged vector for next round verification (round=22)
[S10] DEBUG after merge:  round=22 metric=0.9923 head_norm=1.256170 delta_norm=0.236059
[S10] aggregate: ACCEPT kept=['S15', 'S2'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=22 metric=0.7686 head_norm=1.122259
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.700152e-01
[S15] stored merged vector for next round verification (round=22)
[S15] DEBUG after merge:  round=22 metric=0.7549 head_norm=1.029426 delta_norm=0.570015
[S15] aggregate: ROLLBACK (f1_val pre=0.769 post=0.755 tol_abs=0.005 tol_rel=0.0)
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=22 metric=0.5697 head_norm=1.228742
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.512865e-01
[S7] stored merged vector for next round verification (round=22)
[S7] DEBUG after merge:  round=22 metric=0.5687 head_norm=1.182691 delta_norm=0.151286
[S7] aggregate: ACCEPT kept=['S10', 'S11'] (k=2/2) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=1.923681 cos_to_last_merge=1.0000 (last merge round=22)
[S2] round=23 local utility u=0.085539 metrics={'f1_val': 0.7155363793011694, 'auprc': 0.7384235020764648, 'loss_val': 0.7105813322012142, 'psi': 0.7246912284112876}-{'f1_val': 0.6943074304940152, 'auprc': 0.732181838277129, 'loss_val': 0.7355599380701326, 'psi': 0.7094571936072607}
[S3] START round=23 head_norm_before_train=1.850254 (no previous merge yet)
[S3] round=23 local utility u=0.765114 metrics={'f1_val': 0.9348495175805944, 'auprc': 0.9983360282018345, 'loss_val': 0.14670995892914582, 'psi': 0.9602441218290905}-{'f1_val': 0.7006060025002057, 'auprc': 0.9982910313064157, 'loss_val': 0.27134092988532216, 'psi': 0.8196800140226896}
[S4] START round=23 head_norm_before_train=1.917280 (no previous merge yet)
[S4] round=23 local utility u=0.000000 metrics={'f1_val': 0.9423534767829238, 'auprc': 0.9838057341700456, 'loss_val': 0.2877321625044543, 'psi': 0.9589343797377725}-{'f1_val': 0.9475282038735302, 'auprc': 0.9753570737597885, 'loss_val': 0.28815295214649833, 'psi': 0.9586597518280335}
[S5] START round=23 head_norm_before_train=1.726048 (no previous merge yet)
[S5] round=23 local utility u=0.000000 metrics={'f1_val': 0.6660880633247546, 'auprc': 0.7928680172269738, 'loss_val': 0.8024686385532719, 'psi': 0.7168000448856422}-{'f1_val': 0.7006090940057808, 'auprc': 0.9972027290325445, 'loss_val': 0.25935775101861214, 'psi': 0.8192465480164863}
[S6] START round=23 head_norm_before_train=1.885803 (no previous merge yet)
[S6] round=23 local utility u=0.000000 metrics={'f1_val': 0.8730110683865153, 'auprc': 0.9772446412182433, 'loss_val': 0.2809279061006926, 'psi': 0.9147044975192066}-{'f1_val': 0.8864167374546372, 'auprc': 0.9739708854110315, 'loss_val': 0.21909778089254206, 'psi': 0.921438396637195}
[S7] START round=23 head_norm_before_train=1.182691 cos_to_last_merge=1.0000 (last merge round=22)
[S7] round=23 local utility u=0.578442 metrics={'f1_val': 0.678427654847389, 'auprc': 0.8677067668671373, 'loss_val': 0.5534487822617454, 'psi': 0.7541392996552883}-{'f1_val': 0.5697344628609643, 'auprc': 0.7830645877518425, 'loss_val': 0.804247199110749, 'psi': 0.6550665128173156}
[S8] START round=23 head_norm_before_train=1.771641 cos_to_last_merge=1.0000 (last merge round=22)
[S8] round=23 local utility u=0.017962 metrics={'f1_val': 0.9931113357884451, 'auprc': 0.9990020554416411, 'loss_val': 0.04793003653624844, 'psi': 0.9954676236497235}-{'f1_val': 0.9928898770479506, 'auprc': 0.988864103704328, 'loss_val': 0.05211222787736388, 'psi': 0.9912795677105015}
[S9] START round=23 head_norm_before_train=1.628492 cos_to_last_merge=0.8098 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.810
[S9] round=23 local utility u=0.015366 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9989199458182119, 'loss_val': 0.03640467451591165, 'psi': 0.9973305957655284}-{'f1_val': 0.9925154678702236, 'auprc': 0.9988511814994202, 'loss_val': 0.04439602600826525, 'psi': 0.9950497533219023}
[S10] START round=23 head_norm_before_train=1.256170 cos_to_last_merge=1.0000 (last merge round=22)
[S10] round=23 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9934279428000383, 'loss_val': 0.12330654062332261, 'psi': 0.9942203426516388}-{'f1_val': 0.9929696616913117, 'auprc': 0.9924509275830814, 'loss_val': 0.09376962463615211, 'psi': 0.9927621680480196}
[S11] START round=23 head_norm_before_train=1.662551 cos_to_last_merge=0.7953 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.795
[S11] round=23 local utility u=0.005903 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9984321096434652, 'loss_val': 0.08401738106898163, 'psi': 0.9973010465655399}-{'f1_val': 0.996960829744628, 'auprc': 0.9981354205522224, 'loss_val': 0.0974154935720262, 'psi': 0.9974306660676657}
[S13] START round=23 head_norm_before_train=1.731786 (no previous merge yet)
[S13] round=23 local utility u=0.149104 metrics={'f1_val': 0.604236280404636, 'auprc': 0.7035998512739071, 'loss_val': 0.7182026864116612, 'psi': 0.6439817087523444}-{'f1_val': 0.5809763385367445, 'auprc': 0.6971493980086284, 'loss_val': 0.8575005372595003, 'psi': 0.627445562325498}
[S14] START round=23 head_norm_before_train=1.804670 (no previous merge yet)
[S14] round=23 local utility u=0.001908 metrics={'f1_val': 0.9974830777164877, 'auprc': 0.9971331543432969, 'loss_val': 0.054141843603988216, 'psi': 0.9973431083672113}-{'f1_val': 0.9979187620675374, 'auprc': 0.9971593716898681, 'loss_val': 0.06065147742903564, 'psi': 0.9976150059164697}
[S15] START round=23 head_norm_before_train=1.029426 cos_to_last_merge=1.0000 (last merge round=22)
[S15] round=23 local utility u=0.595313 metrics={'f1_val': 0.945266494199725, 'auprc': 0.9962948195072491, 'loss_val': 0.30850466871322135, 'psi': 0.9656778243227346}-{'f1_val': 0.7686272321183643, 'auprc': 0.9902875297750664, 'loss_val': 0.4212740296639787, 'psi': 0.8572913511810452}
[S16] START round=23 head_norm_before_train=1.634630 cos_to_last_merge=0.7602 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.760
[S16] round=23 local utility u=0.508612 metrics={'f1_val': 0.9388366641668461, 'auprc': 0.9927831437387802, 'loss_val': 0.24116692392136233, 'psi': 0.9604152559956197}-{'f1_val': 0.8644557496866934, 'auprc': 0.9296259806803828, 'loss_val': 0.622633574731406, 'psi': 0.8905238420841692}
[S17] START round=23 head_norm_before_train=1.755260 cos_to_last_merge=0.8288 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.829
[S17] round=23 local utility u=0.195202 metrics={'f1_val': 0.6686368145448448, 'auprc': 0.8917144194926563, 'loss_val': 0.8392937855356929, 'psi': 0.7578678565239694}-{'f1_val': 0.6581725436742629, 'auprc': 0.8791353056746827, 'loss_val': 1.1291745439760992, 'psi': 0.7465576484744308}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:39403
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:39415
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] → sending delta(kind=head bytes=1805) to S6@127.0.0.1:39407
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S2] → sending delta(kind=head bytes=1806) to S10@127.0.0.1:39411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:39407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:39415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:39411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:39415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S9] → sending delta(kind=head bytes=1807) to S3@127.0.0.1:39403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:39408
[S2] sending update (kind=head size=1806 to 1 peers)
[S9] sending update (kind=head size=1807 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1805 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1803) from S11
[S7] cosine check vs S11: cos=0.8737
[S6] RECEIVED delta(kind=head bytes=1800) from S14
[S6] cosine check vs S14: cos=-0.0507
[S6] DROPPED delta from S14 (cos=-0.0507 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1805) from S16
[S6] cosine check vs S16: cos=-0.0023
[S6] DROPPED delta from S16 (cos=-0.0023 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1799) from S15
[S10] cosine check vs S15: cos=0.6479
[S10] RECEIVED delta(kind=head bytes=1806) from S2
[S10] cosine check vs S2: cos=0.8378
[S3] RECEIVED delta(kind=head bytes=1807) from S9
[S3] cosine check vs S9: cos=-0.0858
[S3] DROPPED delta from S9 (cos=-0.0858 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1799) from S8
[S3] cosine check vs S8: cos=-0.1198
[S3] DROPPED delta from S8 (cos=-0.1198 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1801) from S13
[S15] cosine check vs S13: cos=0.3784
[S15] RECEIVED delta(kind=head bytes=1797) from S3
[S15] cosine check vs S3: cos=0.3886
[S15] RECEIVED delta(kind=head bytes=1797) from S7
[S15] cosine check vs S7: cos=0.8790
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S17] → sending delta(kind=head bytes=1807) to S8@127.0.0.1:39409
[S17] sending update (kind=head size=1807 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1807) from S17
[S8] cosine check vs S17: cos=0.0923
[S10] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=23 metric=0.9947 head_norm=1.309007
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.168022e-01
[S10] stored merged vector for next round verification (round=23)
[S10] DEBUG after merge:  round=23 metric=0.9939 head_norm=1.254759 delta_norm=0.216802
[S10] aggregate: ACCEPT kept=['S15', 'S2'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=23 metric=0.9453 head_norm=1.091426
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.492254e-01
[S15] stored merged vector for next round verification (round=23)
[S15] DEBUG after merge:  round=23 metric=0.9509 head_norm=0.994407 delta_norm=0.249225
[S15] aggregate: ACCEPT kept=['S13', 'S3', 'S7'] (k=3/3) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=23 metric=0.9931 head_norm=1.796198
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.200756e+00
[S8] stored merged vector for next round verification (round=23)
[S8] DEBUG after merge:  round=23 metric=0.9924 head_norm=1.317189 delta_norm=1.200756
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=23 metric=0.6784 head_norm=1.191102
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.371904e-01
[S7] stored merged vector for next round verification (round=23)
[S7] DEBUG after merge:  round=23 metric=0.6763 head_norm=1.398438 delta_norm=0.437190
[S7] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=1.941483 cos_to_last_merge=0.9999 (last merge round=22)
[S2] round=24 local utility u=0.000000 metrics={'f1_val': 0.6812003935059476, 'auprc': 0.7329454941632559, 'loss_val': 0.7970540742844707, 'psi': 0.701898433768871}-{'f1_val': 0.7155363793011694, 'auprc': 0.7384235020764648, 'loss_val': 0.7105813322012142, 'psi': 0.7246912284112876}
[S3] START round=24 head_norm_before_train=1.869483 (no previous merge yet)
[S3] round=24 local utility u=0.000000 metrics={'f1_val': 0.9312257537480487, 'auprc': 0.9981324512876586, 'loss_val': 0.15167236460617065, 'psi': 0.9579884327638928}-{'f1_val': 0.9348495175805944, 'auprc': 0.9983360282018345, 'loss_val': 0.14670995892914582, 'psi': 0.9602441218290905}
[S4] START round=24 head_norm_before_train=1.936247 (no previous merge yet)
[S4] round=24 local utility u=0.023077 metrics={'f1_val': 0.951500284417711, 'auprc': 0.9800252218984338, 'loss_val': 0.28511765303573994, 'psi': 0.9629102594100001}-{'f1_val': 0.9423534767829238, 'auprc': 0.9838057341700456, 'loss_val': 0.2877321625044543, 'psi': 0.9589343797377725}
[S5] START round=24 head_norm_before_train=1.732641 (no previous merge yet)
[S5] round=24 local utility u=0.691693 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9960468740600165, 'loss_val': 0.23574052848584717, 'psi': 0.8187837852216111}-{'f1_val': 0.6660880633247546, 'auprc': 0.7928680172269738, 'loss_val': 0.8024686385532719, 'psi': 0.7168000448856422}
[S6] START round=24 head_norm_before_train=1.897230 (no previous merge yet)
[S6] round=24 local utility u=0.000000 metrics={'f1_val': 0.738701987136908, 'auprc': 0.9518543139135371, 'loss_val': 0.6066637219912477, 'psi': 0.8239629178475596}-{'f1_val': 0.8730110683865153, 'auprc': 0.9772446412182433, 'loss_val': 0.2809279061006926, 'psi': 0.9147044975192066}
[S7] START round=24 head_norm_before_train=1.398438 cos_to_last_merge=1.0000 (last merge round=23)
[S7] round=24 local utility u=0.000000 metrics={'f1_val': 0.39677584786771153, 'auprc': 0.6768940077711713, 'loss_val': 1.3548282596337526, 'psi': 0.5088231118290955}-{'f1_val': 0.678427654847389, 'auprc': 0.8677067668671373, 'loss_val': 0.5534487822617454, 'psi': 0.7541392996552883}
[S8] START round=24 head_norm_before_train=1.317189 cos_to_last_merge=1.0000 (last merge round=23)
[S8] round=24 local utility u=0.000000 metrics={'f1_val': 0.7141743438394846, 'auprc': 0.9879254847212124, 'loss_val': 0.29026995707626, 'psi': 0.8236748001921758}-{'f1_val': 0.9931113357884451, 'auprc': 0.9990020554416411, 'loss_val': 0.04793003653624844, 'psi': 0.9954676236497235}
[S9] START round=24 head_norm_before_train=1.650853 cos_to_last_merge=0.8069 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.807
[S9] round=24 local utility u=0.000000 metrics={'f1_val': 0.9929348022347503, 'auprc': 0.9988523189860398, 'loss_val': 0.03733552100253482, 'psi': 0.9953018089352661}-{'f1_val': 0.9962710290637395, 'auprc': 0.9989199458182119, 'loss_val': 0.03640467451591165, 'psi': 0.9973305957655284}
[S10] START round=24 head_norm_before_train=1.254759 cos_to_last_merge=1.0000 (last merge round=23)
[S10] round=24 local utility u=0.000000 metrics={'f1_val': 0.9932304850534869, 'auprc': 0.9954762676928172, 'loss_val': 0.12979099901850658, 'psi': 0.994128798109219}-{'f1_val': 0.9947486092193725, 'auprc': 0.9934279428000383, 'loss_val': 0.12330654062332261, 'psi': 0.9942203426516388}
[S11] START round=24 head_norm_before_train=1.695525 cos_to_last_merge=0.7907 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.791
[S11] round=24 local utility u=0.004074 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9970968656238426, 'loss_val': 0.07186316863160405, 'psi': 0.9967669489576908}-{'f1_val': 0.9965470045135896, 'auprc': 0.9984321096434652, 'loss_val': 0.08401738106898163, 'psi': 0.9973010465655399}
[S13] START round=24 head_norm_before_train=1.750299 (no previous merge yet)
[S13] round=24 local utility u=0.000000 metrics={'f1_val': 0.5661774287421653, 'auprc': 0.695452793631858, 'loss_val': 0.8503703369909477, 'psi': 0.6178875746980423}-{'f1_val': 0.604236280404636, 'auprc': 0.7035998512739071, 'loss_val': 0.7182026864116612, 'psi': 0.6439817087523444}
[S14] START round=24 head_norm_before_train=1.833575 (no previous merge yet)
[S14] round=24 local utility u=0.003537 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9971311225883839, 'loss_val': 0.045605410442335584, 'psi': 0.9971966630588294}-{'f1_val': 0.9974830777164877, 'auprc': 0.9971331543432969, 'loss_val': 0.054141843603988216, 'psi': 0.9973431083672113}
[S15] START round=24 head_norm_before_train=0.994407 cos_to_last_merge=1.0000 (last merge round=23)
[S15] round=24 local utility u=0.175641 metrics={'f1_val': 0.9903433437289243, 'auprc': 0.9966729557576005, 'loss_val': 0.22881777752544047, 'psi': 0.9928751885403948}-{'f1_val': 0.945266494199725, 'auprc': 0.9962948195072491, 'loss_val': 0.30850466871322135, 'psi': 0.9656778243227346}
[S16] START round=24 head_norm_before_train=1.657375 cos_to_last_merge=0.7576 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.758
[S16] round=24 local utility u=0.252283 metrics={'f1_val': 0.9924273222311046, 'auprc': 0.9952585162067898, 'loss_val': 0.06557114474961988, 'psi': 0.9935597998213788}-{'f1_val': 0.9388366641668461, 'auprc': 0.9927831437387802, 'loss_val': 0.24116692392136233, 'psi': 0.9604152559956197}
[S17] START round=24 head_norm_before_train=1.768411 cos_to_last_merge=0.8281 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.828
[S17] round=24 local utility u=0.330905 metrics={'f1_val': 0.7432726449504607, 'auprc': 0.9053439963557449, 'loss_val': 0.6661865957109049, 'psi': 0.8081011855125744}-{'f1_val': 0.6686368145448448, 'auprc': 0.8917144194926563, 'loss_val': 0.8392937855356929, 'psi': 0.7578678565239694}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:39407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:39407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:39410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:39411
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S2@127.0.0.1:39402
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:39408
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1803 to 1 peers)
[S4] sending update (kind=head size=1794 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1803 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1800) from S14
[S6] cosine check vs S14: cos=-0.0511
[S6] DROPPED delta from S14 (cos=-0.0511 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1803) from S11
[S7] cosine check vs S11: cos=0.9769
[S10] RECEIVED delta(kind=head bytes=1795) from S15
[S10] cosine check vs S15: cos=0.6657
[S9] RECEIVED delta(kind=head bytes=1798) from S5
[S9] cosine check vs S5: cos=-0.0510
[S9] DROPPED delta from S5 (cos=-0.0510 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1794) from S4
[S2] cosine check vs S4: cos=0.9982
[S6] RECEIVED delta(kind=head bytes=1803) from S16
[S6] cosine check vs S16: cos=-0.0017
[S6] DROPPED delta from S16 (cos=-0.0017 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:39409
[S17] sending update (kind=head size=1797 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1797) from S17
[S8] cosine check vs S17: cos=0.6985
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=24 metric=0.3968 head_norm=1.406501
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.326023e-01
[S7] stored merged vector for next round verification (round=24)
[S7] DEBUG after merge:  round=24 metric=0.3958 head_norm=1.558807 delta_norm=0.232602
[S7] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=24 metric=0.7142 head_norm=1.388204
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.441045e-01
[S8] stored merged vector for next round verification (round=24)
[S8] DEBUG after merge:  round=24 metric=0.9208 head_norm=1.466343 delta_norm=0.644105
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=24 metric=0.6812 head_norm=1.955647
[S2] _apply_head_vector_avg (torch): Δ‖w‖=5.818430e-02
[S2] stored merged vector for next round verification (round=24)
[S2] DEBUG after merge:  round=24 metric=0.6832 head_norm=1.950069 delta_norm=0.058184
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=24 metric=0.9932 head_norm=1.313748
[S10] _apply_head_vector_avg (torch): Δ‖w‖=5.010488e-01
[S10] stored merged vector for next round verification (round=24)
[S10] DEBUG after merge:  round=24 metric=0.9930 head_norm=1.094275 delta_norm=0.501049
[S10] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=25 head_norm_before_train=1.950069 cos_to_last_merge=1.0000 (last merge round=24)
[S2] round=25 local utility u=0.045829 metrics={'f1_val': 0.694965916611789, 'auprc': 0.7321784039529728, 'loss_val': 0.7856872165319246, 'psi': 0.7098509115482625}-{'f1_val': 0.6812003935059476, 'auprc': 0.7329454941632559, 'loss_val': 0.7970540742844707, 'psi': 0.701898433768871}
[S3] START round=25 head_norm_before_train=1.890817 (no previous merge yet)
[S3] round=25 local utility u=0.236199 metrics={'f1_val': 0.9973696976584205, 'auprc': 0.9986896202751061, 'loss_val': 0.0778089228990737, 'psi': 0.9978976667050947}-{'f1_val': 0.9312257537480487, 'auprc': 0.9981324512876586, 'loss_val': 0.15167236460617065, 'psi': 0.9579884327638928}
[S4] START round=25 head_norm_before_train=1.946216 (no previous merge yet)
[S4] round=25 local utility u=0.000000 metrics={'f1_val': 0.9417751543724544, 'auprc': 0.9443026681253619, 'loss_val': 0.29738652913563146, 'psi': 0.9427861598736174}-{'f1_val': 0.951500284417711, 'auprc': 0.9800252218984338, 'loss_val': 0.28511765303573994, 'psi': 0.9629102594100001}
[S5] START round=25 head_norm_before_train=1.735356 (no previous merge yet)
[S5] round=25 local utility u=0.006477 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9958339511063722, 'loss_val': 0.22214855576982837, 'psi': 0.8186986160401535}-{'f1_val': 0.7006083926626743, 'auprc': 0.9960468740600165, 'loss_val': 0.23574052848584717, 'psi': 0.8187837852216111}
[S6] START round=25 head_norm_before_train=1.912913 (no previous merge yet)
[S6] round=25 local utility u=0.087113 metrics={'f1_val': 0.7567850022356202, 'auprc': 0.9546410220486404, 'loss_val': 0.5492968508177338, 'psi': 0.8359274101608283}-{'f1_val': 0.738701987136908, 'auprc': 0.9518543139135371, 'loss_val': 0.6066637219912477, 'psi': 0.8239629178475596}
[S7] START round=25 head_norm_before_train=1.558807 cos_to_last_merge=1.0000 (last merge round=24)
[S7] round=25 local utility u=1.000000 metrics={'f1_val': 0.8041516994582625, 'auprc': 0.9963568771037545, 'loss_val': 0.3520557179418442, 'psi': 0.8810337705164593}-{'f1_val': 0.39677584786771153, 'auprc': 0.6768940077711713, 'loss_val': 1.3548282596337526, 'psi': 0.5088231118290955}
[S8] START round=25 head_norm_before_train=1.466343 cos_to_last_merge=1.0000 (last merge round=24)
[S8] round=25 local utility u=0.886508 metrics={'f1_val': 0.9902890463068262, 'auprc': 0.9993849291315677, 'loss_val': 0.2083202446600098, 'psi': 0.9939273994367228}-{'f1_val': 0.7141743438394846, 'auprc': 0.9879254847212124, 'loss_val': 0.29026995707626, 'psi': 0.8236748001921758}
[S9] START round=25 head_norm_before_train=1.669276 cos_to_last_merge=0.8048 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.805
[S9] round=25 local utility u=0.010059 metrics={'f1_val': 0.9954400132154921, 'auprc': 0.9989433226228969, 'loss_val': 0.032522455754632945, 'psi': 0.996841336978454}-{'f1_val': 0.9929348022347503, 'auprc': 0.9988523189860398, 'loss_val': 0.03733552100253482, 'psi': 0.9953018089352661}
[S10] START round=25 head_norm_before_train=1.094275 cos_to_last_merge=1.0000 (last merge round=24)
[S10] round=25 local utility u=0.001264 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9947384771806077, 'loss_val': 0.13415807684991338, 'psi': 0.9947445564038666}-{'f1_val': 0.9932304850534869, 'auprc': 0.9954762676928172, 'loss_val': 0.12979099901850658, 'psi': 0.994128798109219}
[S11] START round=25 head_norm_before_train=1.729081 cos_to_last_merge=0.7862 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.786
[S11] round=25 local utility u=0.000000 metrics={'f1_val': 0.995892772286759, 'auprc': 0.9966976870274212, 'loss_val': 0.06798370405619404, 'psi': 0.9962147381830239}-{'f1_val': 0.9965470045135896, 'auprc': 0.9970968656238426, 'loss_val': 0.07186316863160405, 'psi': 0.9967669489576908}
[S13] START round=25 head_norm_before_train=1.758331 (no previous merge yet)
[S13] round=25 local utility u=0.046012 metrics={'f1_val': 0.5816097693672154, 'auprc': 0.6959340382210967, 'loss_val': 0.8523841260078507, 'psi': 0.6273394769087679}-{'f1_val': 0.5661774287421653, 'auprc': 0.695452793631858, 'loss_val': 0.8503703369909477, 'psi': 0.6178875746980423}
[S14] START round=25 head_norm_before_train=1.859713 (no previous merge yet)
[S14] round=25 local utility u=0.002073 metrics={'f1_val': 0.9976483782674455, 'auprc': 0.997130759392211, 'loss_val': 0.04390581318310568, 'psi': 0.9974413307173516}-{'f1_val': 0.997240356705793, 'auprc': 0.9971311225883839, 'loss_val': 0.045605410442335584, 'psi': 0.9971966630588294}
[S15] START round=25 head_norm_before_train=1.082146 cos_to_last_merge=0.9934 (last merge round=23)
[S15] round=25 local utility u=0.000000 metrics={'f1_val': 0.8539613577972016, 'auprc': 0.993884025224363, 'loss_val': 0.30525444276920183, 'psi': 0.9099304247680662}-{'f1_val': 0.9903433437289243, 'auprc': 0.9966729557576005, 'loss_val': 0.22881777752544047, 'psi': 0.9928751885403948}
[S16] START round=25 head_norm_before_train=1.681502 cos_to_last_merge=0.7557 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.756
[S16] round=25 local utility u=0.000000 metrics={'f1_val': 0.9308830880912966, 'auprc': 0.9930115045207386, 'loss_val': 0.2871652663912951, 'psi': 0.9557344546630735}-{'f1_val': 0.9924273222311046, 'auprc': 0.9952585162067898, 'loss_val': 0.06557114474961988, 'psi': 0.9935597998213788}
[S17] START round=25 head_norm_before_train=1.789679 cos_to_last_merge=0.8263 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.826
[S17] round=25 local utility u=0.000000 metrics={'f1_val': 0.7158490294494814, 'auprc': 0.9183146838920673, 'loss_val': 0.6713282390564995, 'psi': 0.7968352912265158}-{'f1_val': 0.7432726449504607, 'auprc': 0.9053439963557449, 'loss_val': 0.6661865957109049, 'psi': 0.8081011855125744}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:39415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:39415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:39411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S8] → sending delta(kind=head bytes=1806) to S3@127.0.0.1:39403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:39409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:39415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] → sending delta(kind=head bytes=1805) to S6@127.0.0.1:39407
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:39410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S10] → sending delta(kind=head bytes=1792) to S7@127.0.0.1:39408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:39403
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1792 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1806 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1795 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1805 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1792) from S10
[S7] cosine check vs S10: cos=0.4858
[S6] RECEIVED delta(kind=head bytes=1805) from S14
[S6] cosine check vs S14: cos=-0.0511
[S6] DROPPED delta from S14 (cos=-0.0511 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1798) from S2
[S10] cosine check vs S2: cos=0.6369
[S8] RECEIVED delta(kind=head bytes=1795) from S6
[S8] cosine check vs S6: cos=0.3996
[S9] RECEIVED delta(kind=head bytes=1799) from S5
[S9] cosine check vs S5: cos=-0.0508
[S9] DROPPED delta from S5 (cos=-0.0508 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1802) from S9
[S3] cosine check vs S9: cos=-0.0886
[S3] DROPPED delta from S9 (cos=-0.0886 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1806) from S8
[S3] cosine check vs S8: cos=0.0039
[S15] RECEIVED delta(kind=head bytes=1800) from S7
[S15] cosine check vs S7: cos=0.5716
[S15] RECEIVED delta(kind=head bytes=1795) from S13
[S15] cosine check vs S13: cos=0.5224
[S15] RECEIVED delta(kind=head bytes=1797) from S3
[S15] cosine check vs S3: cos=0.4798
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=25 metric=0.8540 head_norm=1.179137
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.435795e-01
[S15] stored merged vector for next round verification (round=25)
[S15] DEBUG after merge:  round=25 metric=0.8592 head_norm=1.065519 delta_norm=0.243579
[S15] aggregate: ACCEPT kept=['S7', 'S13', 'S3'] (k=3/3) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.199 → S10@127.0.0.1:39411
[S4] ⇄ pheromone p=0.031 → S2@127.0.0.1:39402
[S11] ⇄ pheromone p=0.064 → S7@127.0.0.1:39408
[S6] ⇄ pheromone p=0.202 → S8@127.0.0.1:39409
[S5] ⇄ pheromone p=0.203 → S9@127.0.0.1:39410
[S14] ⇄ pheromone p=0.033 → S6@127.0.0.1:39407
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=25 metric=0.8042 head_norm=1.564674
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.157475e-01
[S7] stored merged vector for next round verification (round=25)
[S7] DEBUG after merge:  round=25 metric=0.7371 head_norm=1.187938 delta_norm=0.715747
[S7] aggregate: ROLLBACK (f1_val pre=0.804 post=0.737 tol_abs=0.005 tol_rel=0.0)
[S7] ⇄ pheromone p=0.369 → S15@127.0.0.1:39415
[S13] ⇄ pheromone p=0.070 → S15@127.0.0.1:39415
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=25 metric=0.9903 head_norm=1.532334
[S8] _apply_head_vector_avg (torch): Δ‖w‖=9.636711e-01
[S8] stored merged vector for next round verification (round=25)
[S8] DEBUG after merge:  round=25 metric=0.9910 head_norm=1.453213 delta_norm=0.963671
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.222 → S3@127.0.0.1:39403
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=25 metric=0.9947 head_norm=1.182699
[S10] _apply_head_vector_avg (torch): Δ‖w‖=7.577363e-01
[S10] stored merged vector for next round verification (round=25)
[S10] DEBUG after merge:  round=25 metric=0.9952 head_norm=1.433023 delta_norm=0.757736
[S10] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.024 → S7@127.0.0.1:39408
[S2] ⇄ pheromone p=0.094 → S10@127.0.0.1:39411
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=25 metric=0.9974 head_norm=1.914910
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.223913e+00
[S3] stored merged vector for next round verification (round=25)
[S3] DEBUG after merge:  round=25 metric=0.9978 head_norm=1.228618 delta_norm=1.223913
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.170 → S15@127.0.0.1:39415
[S9] ⇄ pheromone p=0.039 → S3@127.0.0.1:39403
[S16] ⇄ pheromone p=0.220 → S6@127.0.0.1:39407
[S17] ⇄ pheromone p=0.116 → S8@127.0.0.1:39409
[S2] START round=26 head_norm_before_train=1.963838 cos_to_last_merge=0.9999 (last merge round=24)
[S2] round=26 local utility u=0.000000 metrics={'f1_val': 0.6871407252477617, 'auprc': 0.7210650008912649, 'loss_val': 0.8593365693621405, 'psi': 0.700710435505163}-{'f1_val': 0.694965916611789, 'auprc': 0.7321784039529728, 'loss_val': 0.7856872165319246, 'psi': 0.7098509115482625}
[S3] START round=26 head_norm_before_train=1.228618 cos_to_last_merge=1.0000 (last merge round=25)
[S3] round=26 local utility u=0.000000 metrics={'f1_val': 0.960995754132836, 'auprc': 0.9980436966320341, 'loss_val': 0.19661321732520343, 'psi': 0.9758149311325153}-{'f1_val': 0.9973696976584205, 'auprc': 0.9986896202751061, 'loss_val': 0.0778089228990737, 'psi': 0.9978976667050947}
[S4] START round=26 head_norm_before_train=1.952439 (no previous merge yet)
[S4] round=26 local utility u=0.000000 metrics={'f1_val': 0.9391833903084077, 'auprc': 0.9316672892577542, 'loss_val': 0.3066934240747422, 'psi': 0.9361769498881464}-{'f1_val': 0.9417751543724544, 'auprc': 0.9443026681253619, 'loss_val': 0.29738652913563146, 'psi': 0.9427861598736174}
[S5] START round=26 head_norm_before_train=1.737444 (no previous merge yet)
[S5] round=26 local utility u=0.000000 metrics={'f1_val': 0.6902144438457353, 'auprc': 0.7926761181059153, 'loss_val': 0.7197106858860377, 'psi': 0.7311991135498073}-{'f1_val': 0.7006083926626743, 'auprc': 0.9958339511063722, 'loss_val': 0.22214855576982837, 'psi': 0.8186986160401535}
[S6] START round=26 head_norm_before_train=1.932079 (no previous merge yet)
[S6] round=26 local utility u=0.249396 metrics={'f1_val': 0.8052137006587536, 'auprc': 0.9743257712749528, 'loss_val': 0.40013106627493417, 'psi': 0.8728585289052333}-{'f1_val': 0.7567850022356202, 'auprc': 0.9546410220486404, 'loss_val': 0.5492968508177338, 'psi': 0.8359274101608283}
[S7] START round=26 head_norm_before_train=1.187938 cos_to_last_merge=1.0000 (last merge round=25)
[S7] round=26 local utility u=0.000000 metrics={'f1_val': 0.5216989847092947, 'auprc': 0.7697833971861318, 'loss_val': 0.970974585890767, 'psi': 0.6209327497000294}-{'f1_val': 0.8041516994582625, 'auprc': 0.9963568771037545, 'loss_val': 0.3520557179418442, 'psi': 0.8810337705164593}
[S8] START round=26 head_norm_before_train=1.453213 cos_to_last_merge=1.0000 (last merge round=25)
[S8] round=26 local utility u=0.000000 metrics={'f1_val': 0.9401718511680478, 'auprc': 0.9938578479858049, 'loss_val': 0.19083754653350804, 'psi': 0.9616462498951506}-{'f1_val': 0.9902890463068262, 'auprc': 0.9993849291315677, 'loss_val': 0.2083202446600098, 'psi': 0.9939273994367228}
[S9] START round=26 head_norm_before_train=1.686790 cos_to_last_merge=0.8030 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.803
[S9] round=26 local utility u=0.004098 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9991487928934624, 'loss_val': 0.029928566979911985, 'psi': 0.9974221345956287}-{'f1_val': 0.9954400132154921, 'auprc': 0.9989433226228969, 'loss_val': 0.032522455754632945, 'psi': 0.996841336978454}
[S10] START round=26 head_norm_before_train=1.433023 cos_to_last_merge=1.0000 (last merge round=25)
[S10] round=26 local utility u=0.001995 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9910997597537877, 'loss_val': 0.11935972856467321, 'psi': 0.9932997941270325}-{'f1_val': 0.9947486092193725, 'auprc': 0.9947384771806077, 'loss_val': 0.13415807684991338, 'psi': 0.9947445564038666}
[S11] START round=26 head_norm_before_train=1.760901 cos_to_last_merge=0.7821 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.782
[S11] round=26 local utility u=0.000000 metrics={'f1_val': 0.9946901021354234, 'auprc': 0.9966509114931417, 'loss_val': 0.068691770293553, 'psi': 0.9954744258785106}-{'f1_val': 0.995892772286759, 'auprc': 0.9966976870274212, 'loss_val': 0.06798370405619404, 'psi': 0.9962147381830239}
[S13] START round=26 head_norm_before_train=1.771687 (no previous merge yet)
[S13] round=26 local utility u=0.000000 metrics={'f1_val': 0.5379535272888659, 'auprc': 0.6999738576153157, 'loss_val': 0.9967037678497523, 'psi': 0.6027616594194458}-{'f1_val': 0.5816097693672154, 'auprc': 0.6959340382210967, 'loss_val': 0.8523841260078507, 'psi': 0.6273394769087679}
[S14] START round=26 head_norm_before_train=1.884112 (no previous merge yet)
[S14] round=26 local utility u=0.000000 metrics={'f1_val': 0.9957445751558393, 'auprc': 0.9971299331628793, 'loss_val': 0.04681491262557668, 'psi': 0.9962987183586552}-{'f1_val': 0.9976483782674455, 'auprc': 0.997130759392211, 'loss_val': 0.04390581318310568, 'psi': 0.9974413307173516}
[S15] START round=26 head_norm_before_train=1.065519 cos_to_last_merge=1.0000 (last merge round=25)
[S15] round=26 local utility u=0.126336 metrics={'f1_val': 0.8980389453527786, 'auprc': 0.9823067924477213, 'loss_val': 0.28231692934022906, 'psi': 0.9317460841907557}-{'f1_val': 0.8539613577972016, 'auprc': 0.993884025224363, 'loss_val': 0.30525444276920183, 'psi': 0.9099304247680662}
[S16] START round=26 head_norm_before_train=1.705809 cos_to_last_merge=0.7539 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.754
[S16] round=26 local utility u=0.000000 metrics={'f1_val': 0.8877282143317293, 'auprc': 0.9947199390353398, 'loss_val': 0.4395744570971248, 'psi': 0.9305249042131736}-{'f1_val': 0.9308830880912966, 'auprc': 0.9930115045207386, 'loss_val': 0.2871652663912951, 'psi': 0.9557344546630735}
[S17] START round=26 head_norm_before_train=1.806761 cos_to_last_merge=0.8248 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.825
[S17] round=26 local utility u=0.000000 metrics={'f1_val': 0.6623640517104304, 'auprc': 0.8545352625602094, 'loss_val': 1.1907398177622026, 'psi': 0.739232536050342}-{'f1_val': 0.7158490294494814, 'auprc': 0.9183146838920673, 'loss_val': 0.6713282390564995, 'psi': 0.7968352912265158}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:39403
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] → sending delta(kind=head bytes=1794) to S7@127.0.0.1:39408
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S6] → sending delta(kind=head bytes=1792) to S8@127.0.0.1:39409
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:39411
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1792 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1794 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1792) from S6
[S8] cosine check vs S6: cos=0.8813
[S7] RECEIVED delta(kind=head bytes=1794) from S10
[S7] cosine check vs S10: cos=0.6228
[S10] RECEIVED delta(kind=head bytes=1801) from S15
[S10] cosine check vs S15: cos=0.4758
[S3] RECEIVED delta(kind=head bytes=1799) from S9
[S3] cosine check vs S9: cos=-0.0495
[S3] DROPPED delta from S9 (cos=-0.0495 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=26 metric=0.5217 head_norm=1.194076
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.027124e-01
[S7] stored merged vector for next round verification (round=26)
[S7] DEBUG after merge:  round=26 metric=0.4755 head_norm=1.217728 delta_norm=0.602712
[S7] aggregate: ROLLBACK (f1_val pre=0.522 post=0.476 tol_abs=0.005 tol_rel=0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=26 metric=0.9402 head_norm=1.553425
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.653389e-01
[S8] stored merged vector for next round verification (round=26)
[S8] DEBUG after merge:  round=26 metric=0.9352 head_norm=1.695294 delta_norm=0.465339
[S8] aggregate: ROLLBACK (f1_val pre=0.940 post=0.935 tol_abs=0.005 tol_rel=0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=26 metric=0.9948 head_norm=1.505467
[S10] _apply_head_vector_avg (torch): Δ‖w‖=6.959422e-01
[S10] stored merged vector for next round verification (round=26)
[S10] DEBUG after merge:  round=26 metric=0.9945 head_norm=1.142179 delta_norm=0.695942
[S10] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=27 head_norm_before_train=1.985768 cos_to_last_merge=0.9996 (last merge round=24)
[S2] round=27 local utility u=0.000000 metrics={'f1_val': 0.6703909783878238, 'auprc': 0.732951948023876, 'loss_val': 0.9086659602927708, 'psi': 0.6954153662422446}-{'f1_val': 0.6871407252477617, 'auprc': 0.7210650008912649, 'loss_val': 0.8593365693621405, 'psi': 0.700710435505163}
[S3] START round=27 head_norm_before_train=1.275363 cos_to_last_merge=0.9988 (last merge round=25)
[S3] round=27 local utility u=0.143749 metrics={'f1_val': 0.9969520501205896, 'auprc': 0.9980390138955554, 'loss_val': 0.12483830757163784, 'psi': 0.997386835630576}-{'f1_val': 0.960995754132836, 'auprc': 0.9980436966320341, 'loss_val': 0.19661321732520343, 'psi': 0.9758149311325153}
[S4] START round=27 head_norm_before_train=1.958227 (no previous merge yet)
[S4] round=27 local utility u=0.046704 metrics={'f1_val': 0.9451860620567206, 'auprc': 0.9446387484637825, 'loss_val': 0.28821595914399734, 'psi': 0.9449671366195453}-{'f1_val': 0.9391833903084077, 'auprc': 0.9316672892577542, 'loss_val': 0.3066934240747422, 'psi': 0.9361769498881464}
[S5] START round=27 head_norm_before_train=1.740059 (no previous merge yet)
[S5] round=27 local utility u=0.587875 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9944748172187179, 'loss_val': 0.21172147162952928, 'psi': 0.8181549624850917}-{'f1_val': 0.6902144438457353, 'auprc': 0.7926761181059153, 'loss_val': 0.7197106858860377, 'psi': 0.7311991135498073}
[S6] START round=27 head_norm_before_train=1.941133 (no previous merge yet)
[S6] round=27 local utility u=0.000000 metrics={'f1_val': 0.611992236598522, 'auprc': 0.8918017532784779, 'loss_val': 0.7874534654914529, 'psi': 0.7239160432705043}-{'f1_val': 0.8052137006587536, 'auprc': 0.9743257712749528, 'loss_val': 0.40013106627493417, 'psi': 0.8728585289052333}
[S7] START round=27 head_norm_before_train=1.217728 cos_to_last_merge=1.0000 (last merge round=26)
[S7] round=27 local utility u=0.856048 metrics={'f1_val': 0.6869074683419318, 'auprc': 0.8823891043417375, 'loss_val': 0.587946709535878, 'psi': 0.7651001227418541}-{'f1_val': 0.5216989847092947, 'auprc': 0.7697833971861318, 'loss_val': 0.970974585890767, 'psi': 0.6209327497000294}
[S8] START round=27 head_norm_before_train=1.695294 cos_to_last_merge=1.0000 (last merge round=26)
[S8] round=27 local utility u=0.219689 metrics={'f1_val': 0.9895116842672763, 'auprc': 0.9957208722671049, 'loss_val': 0.05308714157110449, 'psi': 0.9919953594672077}-{'f1_val': 0.9401718511680478, 'auprc': 0.9938578479858049, 'loss_val': 0.19083754653350804, 'psi': 0.9616462498951506}
[S9] START round=27 head_norm_before_train=1.704804 cos_to_last_merge=0.8013 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.801
[S9] round=27 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.996715378246954, 'loss_val': 0.027843111574081293, 'psi': 0.9969478988060673}-{'f1_val': 0.9962710290637395, 'auprc': 0.9991487928934624, 'loss_val': 0.029928566979911985, 'psi': 0.9974221345956287}
[S10] START round=27 head_norm_before_train=1.142179 cos_to_last_merge=1.0000 (last merge round=26)
[S10] round=27 local utility u=0.000000 metrics={'f1_val': 0.9945468312215635, 'auprc': 0.9917354593377531, 'loss_val': 0.1291629443312413, 'psi': 0.9934222824680393}-{'f1_val': 0.9947664837091956, 'auprc': 0.9910997597537877, 'loss_val': 0.11935972856467321, 'psi': 0.9932997941270325}
[S11] START round=27 head_norm_before_train=1.784906 cos_to_last_merge=0.7791 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.779
[S11] round=27 local utility u=0.010036 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.996306585182418, 'loss_val': 0.05479642394910651, 'psi': 0.9960577367941157}-{'f1_val': 0.9946901021354234, 'auprc': 0.9966509114931417, 'loss_val': 0.068691770293553, 'psi': 0.9954744258785106}
[S13] START round=27 head_norm_before_train=1.783869 (no previous merge yet)
[S13] round=27 local utility u=0.046744 metrics={'f1_val': 0.5573046147262002, 'auprc': 0.7091316407829429, 'loss_val': 1.0467949577624274, 'psi': 0.6180354251488973}-{'f1_val': 0.5379535272888659, 'auprc': 0.6999738576153157, 'loss_val': 0.9967037678497523, 'psi': 0.6027616594194458}
[S14] START round=27 head_norm_before_train=1.902422 (no previous merge yet)
[S14] round=27 local utility u=0.015040 metrics={'f1_val': 0.9976538428159559, 'auprc': 0.9990113689731834, 'loss_val': 0.03383475904031623, 'psi': 0.998196853278847}-{'f1_val': 0.9957445751558393, 'auprc': 0.9971299331628793, 'loss_val': 0.04681491262557668, 'psi': 0.9962987183586552}
[S15] START round=27 head_norm_before_train=1.145157 cos_to_last_merge=0.9970 (last merge round=25)
[S15] round=27 local utility u=0.000000 metrics={'f1_val': 0.7800743719094408, 'auprc': 0.9889067765195876, 'loss_val': 0.37049046961642923, 'psi': 0.8636073337534995}-{'f1_val': 0.8980389453527786, 'auprc': 0.9823067924477213, 'loss_val': 0.28231692934022906, 'psi': 0.9317460841907557}
[S16] START round=27 head_norm_before_train=1.728845 cos_to_last_merge=0.7529 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.753
[S16] round=27 local utility u=0.137136 metrics={'f1_val': 0.9198642464361563, 'auprc': 0.9939845124459442, 'loss_val': 0.3559130542279747, 'psi': 0.9495123528400714}-{'f1_val': 0.8877282143317293, 'auprc': 0.9947199390353398, 'loss_val': 0.4395744570971248, 'psi': 0.9305249042131736}
[S17] START round=27 head_norm_before_train=1.822243 cos_to_last_merge=0.8236 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.824
[S17] round=27 local utility u=0.144236 metrics={'f1_val': 0.6765049918384398, 'auprc': 0.8929016186438824, 'loss_val': 1.1022121074894986, 'psi': 0.7630636425606169}-{'f1_val': 0.6623640517104304, 'auprc': 0.8545352625602094, 'loss_val': 1.1907398177622026, 'psi': 0.739232536050342}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:39403
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:39415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:39407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:39407
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:39402
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:39415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:39410
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S11] → sending delta(kind=head bytes=1807) to S7@127.0.0.1:39408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:39415
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1804 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S16] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1807 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1807) from S11
[S7] cosine check vs S11: cos=0.5446
[S15] RECEIVED delta(kind=head bytes=1797) from S3
[S15] cosine check vs S3: cos=0.5315
[S6] RECEIVED delta(kind=head bytes=1803) from S14
[S6] cosine check vs S14: cos=-0.0524
[S6] DROPPED delta from S14 (cos=-0.0524 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1802) from S16
[S6] cosine check vs S16: cos=-0.0007
[S6] DROPPED delta from S16 (cos=-0.0007 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1802) from S4
[S2] cosine check vs S4: cos=0.9967
[S9] RECEIVED delta(kind=head bytes=1804) from S5
[S9] cosine check vs S5: cos=-0.0500
[S9] DROPPED delta from S5 (cos=-0.0500 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1795) from S7
[S15] cosine check vs S7: cos=0.6637
[S3] RECEIVED delta(kind=head bytes=1801) from S8
[S3] cosine check vs S8: cos=0.2681
[S15] RECEIVED delta(kind=head bytes=1797) from S13
[S15] cosine check vs S13: cos=0.5848
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:39409
[S17] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1800) from S17
[S8] cosine check vs S17: cos=0.1976
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=27 metric=0.6704 head_norm=2.013704
[S2] _apply_head_vector_avg (torch): Δ‖w‖=8.355879e-02
[S2] stored merged vector for next round verification (round=27)
[S2] DEBUG after merge:  round=27 metric=0.6599 head_norm=1.988747 delta_norm=0.083559
[S2] aggregate: ROLLBACK (f1_val pre=0.670 post=0.660 tol_abs=0.005 tol_rel=0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=27 metric=0.6869 head_norm=1.224267
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.665994e-01
[S7] stored merged vector for next round verification (round=27)
[S7] DEBUG after merge:  round=27 metric=0.6832 head_norm=1.338477 delta_norm=0.766599
[S7] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=27 metric=0.9895 head_norm=1.750064
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.137740e+00
[S8] stored merged vector for next round verification (round=27)
[S8] DEBUG after merge:  round=27 metric=0.9807 head_norm=1.389545 delta_norm=1.137740
[S8] aggregate: ROLLBACK (f1_val pre=0.990 post=0.981 tol_abs=0.005 tol_rel=0.0)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=27 metric=0.9970 head_norm=1.339125
[S3] _apply_head_vector_avg (torch): Δ‖w‖=9.485722e-01
[S3] stored merged vector for next round verification (round=27)
[S3] DEBUG after merge:  round=27 metric=0.9936 head_norm=1.236204 delta_norm=0.948572
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=27 metric=0.7801 head_norm=1.213580
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.375319e-01
[S15] stored merged vector for next round verification (round=27)
[S15] DEBUG after merge:  round=27 metric=0.7777 head_norm=1.057254 delta_norm=0.337532
[S15] aggregate: ACCEPT kept=['S3', 'S7', 'S13'] (k=3/3) mode=median trim_p=0.1
[S2] START round=28 head_norm_before_train=1.988747 cos_to_last_merge=1.0000 (last merge round=27)
[S2] round=28 local utility u=0.000000 metrics={'f1_val': 0.6439969254986498, 'auprc': 0.7271386052407022, 'loss_val': 1.0194108420809835, 'psi': 0.6772535973954708}-{'f1_val': 0.6703909783878238, 'auprc': 0.732951948023876, 'loss_val': 0.9086659602927708, 'psi': 0.6954153662422446}
[S3] START round=28 head_norm_before_train=1.236204 cos_to_last_merge=1.0000 (last merge round=27)
[S3] round=28 local utility u=0.000000 metrics={'f1_val': 0.932811158571069, 'auprc': 0.9603786944353296, 'loss_val': 0.40168699360107296, 'psi': 0.9438381729167733}-{'f1_val': 0.9969520501205896, 'auprc': 0.9980390138955554, 'loss_val': 0.12483830757163784, 'psi': 0.997386835630576}
[S4] START round=28 head_norm_before_train=1.967026 (no previous merge yet)
[S4] round=28 local utility u=0.000000 metrics={'f1_val': 0.9349060447684022, 'auprc': 0.9362727429119, 'loss_val': 0.2955997791374217, 'psi': 0.9354527240258013}-{'f1_val': 0.9451860620567206, 'auprc': 0.9446387484637825, 'loss_val': 0.28821595914399734, 'psi': 0.9449671366195453}
[S5] START round=28 head_norm_before_train=1.742992 (no previous merge yet)
[S5] round=28 local utility u=0.000000 metrics={'f1_val': 0.7145330545296904, 'auprc': 0.7925799787316311, 'loss_val': 0.5193443369936981, 'psi': 0.7457518242104667}-{'f1_val': 0.7006083926626743, 'auprc': 0.9944748172187179, 'loss_val': 0.21172147162952928, 'psi': 0.8181549624850917}
[S6] START round=28 head_norm_before_train=1.955014 (no previous merge yet)
[S6] round=28 local utility u=0.624661 metrics={'f1_val': 0.7587939102919427, 'auprc': 0.9376677985897557, 'loss_val': 0.5565394765179142, 'psi': 0.8303434656110679}-{'f1_val': 0.611992236598522, 'auprc': 0.8918017532784779, 'loss_val': 0.7874534654914529, 'psi': 0.7239160432705043}
[S7] START round=28 head_norm_before_train=1.338477 cos_to_last_merge=1.0000 (last merge round=27)
[S7] round=28 local utility u=0.000000 metrics={'f1_val': 0.4898839937299967, 'auprc': 0.7182454255872932, 'loss_val': 1.1357800733496903, 'psi': 0.5812285664729153}-{'f1_val': 0.6869074683419318, 'auprc': 0.8823891043417375, 'loss_val': 0.587946709535878, 'psi': 0.7651001227418541}
[S8] START round=28 head_norm_before_train=1.389545 cos_to_last_merge=1.0000 (last merge round=27)
[S8] round=28 local utility u=0.000000 metrics={'f1_val': 0.9848983937828014, 'auprc': 0.999389162762357, 'loss_val': 0.13551054800729664, 'psi': 0.9906947013746237}-{'f1_val': 0.9895116842672763, 'auprc': 0.9957208722671049, 'loss_val': 0.05308714157110449, 'psi': 0.9919953594672077}
[S9] START round=28 head_norm_before_train=1.721911 cos_to_last_merge=0.7998 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.800
[S9] round=28 local utility u=0.001536 metrics={'f1_val': 0.9962461149658858, 'auprc': 0.998913628953144, 'loss_val': 0.026225206967262975, 'psi': 0.997313120560789}-{'f1_val': 0.9971029125121428, 'auprc': 0.996715378246954, 'loss_val': 0.027843111574081293, 'psi': 0.9969478988060673}
[S10] START round=28 head_norm_before_train=1.221976 cos_to_last_merge=0.9960 (last merge round=26)
[S10] round=28 local utility u=0.022678 metrics={'f1_val': 0.9943272539091932, 'auprc': 0.9920894598877509, 'loss_val': 0.08355086889594661, 'psi': 0.9934321363006162}-{'f1_val': 0.9945468312215635, 'auprc': 0.9917354593377531, 'loss_val': 0.1291629443312413, 'psi': 0.9934222824680393}
[S11] START round=28 head_norm_before_train=1.805425 cos_to_last_merge=0.7770 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.777
[S11] round=28 local utility u=0.000079 metrics={'f1_val': 0.995892772286759, 'auprc': 0.9966936767933773, 'loss_val': 0.0558057620091664, 'psi': 0.9962131340894063}-{'f1_val': 0.9958918378685807, 'auprc': 0.996306585182418, 'loss_val': 0.05479642394910651, 'psi': 0.9960577367941157}
[S13] START round=28 head_norm_before_train=1.805264 (no previous merge yet)
[S13] round=28 local utility u=0.498532 metrics={'f1_val': 0.6308933946988489, 'auprc': 0.7399092532510605, 'loss_val': 0.5835970931605686, 'psi': 0.6744997381197335}-{'f1_val': 0.5573046147262002, 'auprc': 0.7091316407829429, 'loss_val': 1.0467949577624274, 'psi': 0.6180354251488973}
[S14] START round=28 head_norm_before_train=1.916449 (no previous merge yet)
[S14] round=28 local utility u=0.000921 metrics={'f1_val': 0.9976538428159559, 'auprc': 0.9991473029484774, 'loss_val': 0.03239975210562127, 'psi': 0.9982512268689645}-{'f1_val': 0.9976538428159559, 'auprc': 0.9990113689731834, 'loss_val': 0.03383475904031623, 'psi': 0.998196853278847}
[S15] START round=28 head_norm_before_train=1.057254 cos_to_last_merge=1.0000 (last merge round=27)
[S15] round=28 local utility u=0.000000 metrics={'f1_val': 0.7678182357208112, 'auprc': 0.9906935127393768, 'loss_val': 0.3904840643973218, 'psi': 0.8569683465282374}-{'f1_val': 0.7800743719094408, 'auprc': 0.9889067765195876, 'loss_val': 0.37049046961642923, 'psi': 0.8636073337534995}
[S16] START round=28 head_norm_before_train=1.750431 cos_to_last_merge=0.7523 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.752
[S16] round=28 local utility u=0.000000 metrics={'f1_val': 0.8793975711837799, 'auprc': 0.9950548521796585, 'loss_val': 0.48576780388716423, 'psi': 0.9256604835821314}-{'f1_val': 0.9198642464361563, 'auprc': 0.9939845124459442, 'loss_val': 0.3559130542279747, 'psi': 0.9495123528400714}
[S17] START round=28 head_norm_before_train=1.840612 cos_to_last_merge=0.8220 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.822
[S17] round=28 local utility u=0.843711 metrics={'f1_val': 0.8175207343241276, 'auprc': 0.9404648765879804, 'loss_val': 0.4035736551758541, 'psi': 0.8666983912296687}-{'f1_val': 0.6765049918384398, 'auprc': 0.8929016186438824, 'loss_val': 1.1022121074894986, 'psi': 0.7630636425606169}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:39403
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:39408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] → sending delta(kind=head bytes=1794) to S15@127.0.0.1:39415
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:39409
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:39408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:39407
[S10] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1795 to 1 peers)
[S13] sending update (kind=head size=1794 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1798) from S9
[S3] cosine check vs S9: cos=0.0326
[S7] RECEIVED delta(kind=head bytes=1800) from S10
[S7] cosine check vs S10: cos=0.6601
[S8] RECEIVED delta(kind=head bytes=1795) from S6
[S8] cosine check vs S6: cos=0.6322
[S7] RECEIVED delta(kind=head bytes=1802) from S11
[S7] cosine check vs S11: cos=0.9230
[S6] RECEIVED delta(kind=head bytes=1798) from S14
[S6] cosine check vs S14: cos=-0.0528
[S6] DROPPED delta from S14 (cos=-0.0528 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1794) from S13
[S15] cosine check vs S13: cos=0.5530
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:39409
[S17] sending update (kind=head size=1795 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1795) from S17
[S8] cosine check vs S17: cos=0.7637
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=28 metric=0.4899 head_norm=1.347943
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.123734e-01
[S7] stored merged vector for next round verification (round=28)
[S7] DEBUG after merge:  round=28 metric=0.4960 head_norm=1.313308 delta_norm=0.112373
[S7] aggregate: ACCEPT kept=['S10', 'S11'] (k=2/2) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=28 metric=0.9328 head_norm=1.287195
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.064415e+00
[S3] stored merged vector for next round verification (round=28)
[S3] DEBUG after merge:  round=28 metric=0.9204 head_norm=1.098160 delta_norm=1.064415
[S3] aggregate: ROLLBACK (f1_val pre=0.933 post=0.920 tol_abs=0.005 tol_rel=0.0)
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=28 metric=0.9849 head_norm=1.443012
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.250483e-01
[S8] stored merged vector for next round verification (round=28)
[S8] DEBUG after merge:  round=28 metric=0.9828 head_norm=1.390353 delta_norm=0.125048
[S8] aggregate: ACCEPT kept=['S6', 'S17'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=28 metric=0.7678 head_norm=1.125212
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.616505e-01
[S15] stored merged vector for next round verification (round=28)
[S15] DEBUG after merge:  round=28 metric=0.7771 head_norm=1.309329 delta_norm=0.761651
[S15] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=29 head_norm_before_train=2.014582 cos_to_last_merge=0.9998 (last merge round=27)
[S2] round=29 local utility u=0.299651 metrics={'f1_val': 0.7060700926703852, 'auprc': 0.7329390959059182, 'loss_val': 0.8099493549538341, 'psi': 0.7168176939645985}-{'f1_val': 0.6439969254986498, 'auprc': 0.7271386052407022, 'loss_val': 1.0194108420809835, 'psi': 0.6772535973954708}
[S3] START round=29 head_norm_before_train=1.098160 cos_to_last_merge=1.0000 (last merge round=28)
[S3] round=29 local utility u=0.101598 metrics={'f1_val': 0.9624238080555565, 'auprc': 0.9972227840367532, 'loss_val': 0.48670006580898245, 'psi': 0.9763433984480352}-{'f1_val': 0.932811158571069, 'auprc': 0.9603786944353296, 'loss_val': 0.40168699360107296, 'psi': 0.9438381729167733}
[S4] START round=29 head_norm_before_train=1.974389 (no previous merge yet)
[S4] round=29 local utility u=0.027658 metrics={'f1_val': 0.9416365096150838, 'auprc': 0.9393416638728458, 'loss_val': 0.2898738489605777, 'psi': 0.9407185713181886}-{'f1_val': 0.9349060447684022, 'auprc': 0.9362727429119, 'loss_val': 0.2955997791374217, 'psi': 0.9354527240258013}
[S5] START round=29 head_norm_before_train=1.751095 (no previous merge yet)
[S5] round=29 local utility u=0.435720 metrics={'f1_val': 0.700320598491359, 'auprc': 0.997507116789082, 'loss_val': 0.17741133476478838, 'psi': 0.8191952058104481}-{'f1_val': 0.7145330545296904, 'auprc': 0.7925799787316311, 'loss_val': 0.5193443369936981, 'psi': 0.7457518242104667}
[S6] START round=29 head_norm_before_train=1.960142 (no previous merge yet)
[S6] round=29 local utility u=0.000000 metrics={'f1_val': 0.7418885904667825, 'auprc': 0.9633479740030358, 'loss_val': 0.669958980442093, 'psi': 0.8304723438812838}-{'f1_val': 0.7587939102919427, 'auprc': 0.9376677985897557, 'loss_val': 0.5565394765179142, 'psi': 0.8303434656110679}
[S7] START round=29 head_norm_before_train=1.313308 cos_to_last_merge=1.0000 (last merge round=28)
[S7] round=29 local utility u=1.000000 metrics={'f1_val': 0.6875318577576142, 'auprc': 0.8891053463611307, 'loss_val': 0.44003211183623814, 'psi': 0.7681612531990207}-{'f1_val': 0.4898839937299967, 'auprc': 0.7182454255872932, 'loss_val': 1.1357800733496903, 'psi': 0.5812285664729153}
[S8] START round=29 head_norm_before_train=1.390353 cos_to_last_merge=1.0000 (last merge round=28)
[S8] round=29 local utility u=0.028754 metrics={'f1_val': 0.9928776631628903, 'auprc': 0.990337853999772, 'loss_val': 0.09872413510822062, 'psi': 0.991861739497643}-{'f1_val': 0.9848983937828014, 'auprc': 0.999389162762357, 'loss_val': 0.13551054800729664, 'psi': 0.9906947013746237}
[S9] START round=29 head_norm_before_train=1.738102 cos_to_last_merge=0.7985 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.799
[S9] round=29 local utility u=0.000000 metrics={'f1_val': 0.9901493298847097, 'auprc': 0.9992435482291934, 'loss_val': 0.038524827331438694, 'psi': 0.9937870172225032}-{'f1_val': 0.9962461149658858, 'auprc': 0.998913628953144, 'loss_val': 0.026225206967262975, 'psi': 0.997313120560789}
[S10] START round=29 head_norm_before_train=1.297424 cos_to_last_merge=0.9885 (last merge round=26)
[S10] round=29 local utility u=0.008295 metrics={'f1_val': 0.9943272539091932, 'auprc': 0.9919363293897906, 'loss_val': 0.06650070958823354, 'psi': 0.9933708841014322}-{'f1_val': 0.9943272539091932, 'auprc': 0.9920894598877509, 'loss_val': 0.08355086889594661, 'psi': 0.9934321363006162}
[S11] START round=29 head_norm_before_train=1.824514 cos_to_last_merge=0.7748 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.775
[S11] round=29 local utility u=0.000091 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9966926446057256, 'loss_val': 0.057066279166018155, 'psi': 0.9963572627902758}-{'f1_val': 0.995892772286759, 'auprc': 0.9966936767933773, 'loss_val': 0.0558057620091664, 'psi': 0.9962131340894063}
[S13] START round=29 head_norm_before_train=1.822857 (no previous merge yet)
[S13] round=29 local utility u=0.000000 metrics={'f1_val': 0.5831716671378779, 'auprc': 0.7386757231902453, 'loss_val': 1.0802039315592555, 'psi': 0.6453732895588249}-{'f1_val': 0.6308933946988489, 'auprc': 0.7399092532510605, 'loss_val': 0.5835970931605686, 'psi': 0.6744997381197335}
[S14] START round=29 head_norm_before_train=1.933696 (no previous merge yet)
[S14] round=29 local utility u=0.000000 metrics={'f1_val': 0.6812372320153847, 'auprc': 0.9251194603227398, 'loss_val': 0.4788927379668133, 'psi': 0.7787901233383268}-{'f1_val': 0.9976538428159559, 'auprc': 0.9991473029484774, 'loss_val': 0.03239975210562127, 'psi': 0.9982512268689645}
[S15] START round=29 head_norm_before_train=1.309329 cos_to_last_merge=1.0000 (last merge round=28)
[S15] round=29 local utility u=0.777427 metrics={'f1_val': 0.9806405064779143, 'auprc': 0.9970070319564949, 'loss_val': 0.13150461234566924, 'psi': 0.9871871166693466}-{'f1_val': 0.7678182357208112, 'auprc': 0.9906935127393768, 'loss_val': 0.3904840643973218, 'psi': 0.8569683465282374}
[S16] START round=29 head_norm_before_train=1.769049 cos_to_last_merge=0.7517 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.752
[S16] round=29 local utility u=0.075991 metrics={'f1_val': 0.8960964025389031, 'auprc': 0.9925478440802127, 'loss_val': 0.42645729054443005, 'psi': 0.9346769791554269}-{'f1_val': 0.8793975711837799, 'auprc': 0.9950548521796585, 'loss_val': 0.48576780388716423, 'psi': 0.9256604835821314}
[S17] START round=29 head_norm_before_train=1.857031 cos_to_last_merge=0.8208 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.821
[S17] round=29 local utility u=0.000000 metrics={'f1_val': 0.6847669969399041, 'auprc': 0.8785818221944106, 'loss_val': 1.1632426831448384, 'psi': 0.7622929270417067}-{'f1_val': 0.8175207343241276, 'auprc': 0.9404648765879804, 'loss_val': 0.4035736551758541, 'psi': 0.8666983912296687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:39415
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:39408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:39410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:39411
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:39403
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:39411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] → sending delta(kind=head bytes=1793) to S15@127.0.0.1:39415
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:39407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:39402
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:39408
[S11] sending update (kind=head size=1804 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1793 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1803) from S5
[S9] cosine check vs S5: cos=-0.0485
[S9] DROPPED delta from S5 (cos=-0.0485 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1793) from S3
[S15] cosine check vs S3: cos=0.0463
[S3] RECEIVED delta(kind=head bytes=1803) from S8
[S3] cosine check vs S8: cos=0.5221
[S7] RECEIVED delta(kind=head bytes=1804) from S11
[S7] cosine check vs S11: cos=0.9046
[S7] RECEIVED delta(kind=head bytes=1796) from S10
[S7] cosine check vs S10: cos=0.6964
[S6] RECEIVED delta(kind=head bytes=1802) from S16
[S6] cosine check vs S16: cos=0.0014
[S15] RECEIVED delta(kind=head bytes=1800) from S7
[S15] cosine check vs S7: cos=0.4144
[S2] RECEIVED delta(kind=head bytes=1800) from S4
[S2] cosine check vs S4: cos=0.9966
[S10] RECEIVED delta(kind=head bytes=1798) from S15
[S10] cosine check vs S15: cos=0.6797
[S10] RECEIVED delta(kind=head bytes=1797) from S2
[S10] cosine check vs S2: cos=0.6828
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=29 metric=0.7419 head_norm=1.965977
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.326411e+00
[S6] stored merged vector for next round verification (round=29)
[S6] DEBUG after merge:  round=29 metric=0.6836 head_norm=1.328326 delta_norm=1.326411
[S6] aggregate: ROLLBACK (f1_val pre=0.742 post=0.684 tol_abs=0.005 tol_rel=0.0)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=29 metric=0.9624 head_norm=1.142623
[S3] _apply_head_vector_avg (torch): Δ‖w‖=6.508641e-01
[S3] stored merged vector for next round verification (round=29)
[S3] DEBUG after merge:  round=29 metric=0.9601 head_norm=1.137640 delta_norm=0.650864
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=29 metric=0.6875 head_norm=1.323687
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.741449e-02
[S7] stored merged vector for next round verification (round=29)
[S7] DEBUG after merge:  round=29 metric=0.6879 head_norm=1.317832 delta_norm=0.067414
[S7] aggregate: ACCEPT kept=['S11', 'S10'] (k=2/2) mode=median trim_p=0.1
[S10] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=29 metric=0.9943 head_norm=1.360168
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.415809e-01
[S10] stored merged vector for next round verification (round=29)
[S10] DEBUG after merge:  round=29 metric=0.9941 head_norm=1.302407 delta_norm=0.341581
[S10] aggregate: ACCEPT kept=['S15', 'S2'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=29 metric=0.9806 head_norm=1.370274
[S15] _apply_head_vector_avg (torch): Δ‖w‖=6.875628e-01
[S15] stored merged vector for next round verification (round=29)
[S15] DEBUG after merge:  round=29 metric=0.9780 head_norm=0.940637 delta_norm=0.687563
[S15] aggregate: ACCEPT kept=['S3', 'S7'] (k=2/2) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=29 metric=0.7061 head_norm=2.037542
[S2] _apply_head_vector_avg (torch): Δ‖w‖=8.821288e-02
[S2] stored merged vector for next round verification (round=29)
[S2] DEBUG after merge:  round=29 metric=0.7073 head_norm=2.006141 delta_norm=0.088213
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=30 head_norm_before_train=2.006141 cos_to_last_merge=1.0000 (last merge round=29)
[S2] round=30 local utility u=0.029955 metrics={'f1_val': 0.7099456905217864, 'auprc': 0.7326787633416613, 'loss_val': 0.7725126814266974, 'psi': 0.7190389196497363}-{'f1_val': 0.7060700926703852, 'auprc': 0.7329390959059182, 'loss_val': 0.8099493549538341, 'psi': 0.7168176939645985}
[S3] START round=30 head_norm_before_train=1.137640 cos_to_last_merge=1.0000 (last merge round=29)
[S3] round=30 local utility u=0.112482 metrics={'f1_val': 0.9944707343992324, 'auprc': 0.9957184934639532, 'loss_val': 0.4495040206460976, 'psi': 0.9949698380251208}-{'f1_val': 0.9624238080555565, 'auprc': 0.9972227840367532, 'loss_val': 0.48670006580898245, 'psi': 0.9763433984480352}
[S4] START round=30 head_norm_before_train=1.978180 (no previous merge yet)
[S4] round=30 local utility u=0.000000 metrics={'f1_val': 0.9338985539142854, 'auprc': 0.9344036858910474, 'loss_val': 0.2995300356338291, 'psi': 0.9341006067049902}-{'f1_val': 0.9416365096150838, 'auprc': 0.9393416638728458, 'loss_val': 0.2898738489605777, 'psi': 0.9407185713181886}
[S5] START round=30 head_norm_before_train=1.758913 (no previous merge yet)
[S5] round=30 local utility u=0.035681 metrics={'f1_val': 0.7260377993856297, 'auprc': 0.9905814877303883, 'loss_val': 0.23957604764595025, 'psi': 0.8318552747235333}-{'f1_val': 0.700320598491359, 'auprc': 0.997507116789082, 'loss_val': 0.17741133476478838, 'psi': 0.8191952058104481}
[S6] START round=30 head_norm_before_train=1.328326 cos_to_last_merge=1.0000 (last merge round=29)
[S6] round=30 local utility u=0.075361 metrics={'f1_val': 0.7604407993366116, 'auprc': 0.934333413986801, 'loss_val': 0.5435056567392966, 'psi': 0.8299978451966874}-{'f1_val': 0.7418885904667825, 'auprc': 0.9633479740030358, 'loss_val': 0.669958980442093, 'psi': 0.8304723438812838}
[S7] START round=30 head_norm_before_train=1.317832 cos_to_last_merge=1.0000 (last merge round=29)
[S7] round=30 local utility u=0.000000 metrics={'f1_val': 0.4906597791876959, 'auprc': 0.7470839976080499, 'loss_val': 1.0646507121627216, 'psi': 0.5932294665558375}-{'f1_val': 0.6875318577576142, 'auprc': 0.8891053463611307, 'loss_val': 0.44003211183623814, 'psi': 0.7681612531990207}
[S8] START round=30 head_norm_before_train=1.459489 cos_to_last_merge=0.9975 (last merge round=28)
[S8] round=30 local utility u=0.017087 metrics={'f1_val': 0.9899422292962364, 'auprc': 0.9990370231337773, 'loss_val': 0.07303461574783977, 'psi': 0.9935801468312528}-{'f1_val': 0.9928776631628903, 'auprc': 0.990337853999772, 'loss_val': 0.09872413510822062, 'psi': 0.991861739497643}
[S9] START round=30 head_norm_before_train=1.752065 cos_to_last_merge=0.7975 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.797
[S9] round=30 local utility u=0.024455 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.999226128339196, 'loss_val': 0.026293498427027297, 'psi': 0.997453068773922}-{'f1_val': 0.9901493298847097, 'auprc': 0.9992435482291934, 'loss_val': 0.038524827331438694, 'psi': 0.9937870172225032}
[S10] START round=30 head_norm_before_train=1.302407 cos_to_last_merge=1.0000 (last merge round=29)
[S10] round=30 local utility u=0.000000 metrics={'f1_val': 0.9943272539091932, 'auprc': 0.991758085970345, 'loss_val': 0.08519826452159532, 'psi': 0.9932995867336539}-{'f1_val': 0.9943272539091932, 'auprc': 0.9919363293897906, 'loss_val': 0.06650070958823354, 'psi': 0.9933708841014322}
[S11] START round=30 head_norm_before_train=1.845981 cos_to_last_merge=0.7723 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.772
[S11] round=30 local utility u=0.007507 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.9970567396800405, 'loss_val': 0.04169325977145247, 'psi': 0.9963577985931646}-{'f1_val': 0.9961336749133093, 'auprc': 0.9966926446057256, 'loss_val': 0.057066279166018155, 'psi': 0.9963572627902758}
[S13] START round=30 head_norm_before_train=1.831713 (no previous merge yet)
[S13] round=30 local utility u=0.298409 metrics={'f1_val': 0.619432313211445, 'auprc': 0.7675652688568639, 'loss_val': 0.7876183734281487, 'psi': 0.6786854954696127}-{'f1_val': 0.5831716671378779, 'auprc': 0.7386757231902453, 'loss_val': 1.0802039315592555, 'psi': 0.6453732895588249}
[S14] START round=30 head_norm_before_train=1.944251 (no previous merge yet)
[S14] round=30 local utility u=1.000000 metrics={'f1_val': 0.9978938390605482, 'auprc': 0.9992304518154181, 'loss_val': 0.028974002875595657, 'psi': 0.9984284841624962}-{'f1_val': 0.6812372320153847, 'auprc': 0.9251194603227398, 'loss_val': 0.4788927379668133, 'psi': 0.7787901233383268}
[S15] START round=30 head_norm_before_train=0.940637 cos_to_last_merge=1.0000 (last merge round=29)
[S15] round=30 local utility u=0.000000 metrics={'f1_val': 0.9100762938886656, 'auprc': 0.9966513830698295, 'loss_val': 0.2808315619072959, 'psi': 0.9447063295611312}-{'f1_val': 0.9806405064779143, 'auprc': 0.9970070319564949, 'loss_val': 0.13150461234566924, 'psi': 0.9871871166693466}
[S16] START round=30 head_norm_before_train=1.783976 cos_to_last_merge=0.7511 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.751
[S16] round=30 local utility u=0.206511 metrics={'f1_val': 0.9371360190391895, 'auprc': 0.993249008506117, 'loss_val': 0.2617760361891558, 'psi': 0.9595812148259606}-{'f1_val': 0.8960964025389031, 'auprc': 0.9925478440802127, 'loss_val': 0.42645729054443005, 'psi': 0.9346769791554269}
[S17] START round=30 head_norm_before_train=1.860386 cos_to_last_merge=0.8212 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.821
[S17] round=30 local utility u=0.015401 metrics={'f1_val': 0.6806628930894657, 'auprc': 0.8811759842197816, 'loss_val': 1.1155978498636967, 'psi': 0.760868129541592}-{'f1_val': 0.6847669969399041, 'auprc': 0.8785818221944106, 'loss_val': 1.1632426831448384, 'psi': 0.7622929270417067}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:39409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:39405
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:39404
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S8] → sending delta(kind=head bytes=1808) to S6@127.0.0.1:39407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:39416
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1808 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1803) from S6
[S16] cosine check vs S6: cos=0.6424
[S4] RECEIVED delta(kind=head bytes=1801) from S2
[S4] cosine check vs S2: cos=0.9983
[S6] RECEIVED delta(kind=head bytes=1808) from S8
[S6] cosine check vs S8: cos=0.5435
[S5] RECEIVED delta(kind=head bytes=1795) from S9
[S5] cosine check vs S9: cos=-0.0481
[S5] DROPPED delta from S9 (cos=-0.0481 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1799) from S3
[S8] cosine check vs S3: cos=0.8774
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S7] ⇄ pheromone p=0.368 → S11@127.0.0.1:39412
[S10] ⇄ pheromone p=0.012 → S15@127.0.0.1:39415
[S15] ⇄ pheromone p=0.200 → S7@127.0.0.1:39408
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=30 metric=0.9339 head_norm=1.995616
[S4] _apply_head_vector_avg (torch): Δ‖w‖=6.070115e-02
[S4] stored merged vector for next round verification (round=30)
[S4] DEBUG after merge:  round=30 metric=0.9346 head_norm=2.010294 delta_norm=0.060701
[S4] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.018 → S5@127.0.0.1:39405
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=30 metric=0.9899 head_norm=1.525441
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.747181e-01
[S8] stored merged vector for next round verification (round=30)
[S8] DEBUG after merge:  round=30 metric=0.9896 head_norm=1.310007 delta_norm=0.374718
[S8] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.103 → S6@127.0.0.1:39407
[S3] ⇄ pheromone p=0.109 → S8@127.0.0.1:39409
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=30 metric=0.7604 head_norm=1.379724
[S6] _apply_head_vector_avg (torch): Δ‖w‖=6.969333e-01
[S6] stored merged vector for next round verification (round=30)
[S6] DEBUG after merge:  round=30 metric=0.7285 head_norm=1.276553 delta_norm=0.696933
[S6] aggregate: ROLLBACK (f1_val pre=0.760 post=0.728 tol_abs=0.005 tol_rel=0.0)
[S6] ⇄ pheromone p=0.182 → S16@127.0.0.1:39416
[S2] ⇄ pheromone p=0.085 → S4@127.0.0.1:39404
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=30 metric=0.9371 head_norm=1.797544
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.979471e-01
[S16] stored merged vector for next round verification (round=30)
[S16] DEBUG after merge:  round=30 metric=0.9323 head_norm=1.442314 delta_norm=0.697947
[S16] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=31 head_norm_before_train=2.026685 cos_to_last_merge=0.9999 (last merge round=29)
[S2] round=31 local utility u=0.000000 metrics={'f1_val': 0.689475228599389, 'auprc': 0.7324575492375405, 'loss_val': 0.8302078159127415, 'psi': 0.7066681568546496}-{'f1_val': 0.7099456905217864, 'auprc': 0.7326787633416613, 'loss_val': 0.7725126814266974, 'psi': 0.7190389196497363}
[S3] START round=31 head_norm_before_train=1.177325 cos_to_last_merge=0.9907 (last merge round=29)
[S3] round=31 local utility u=0.000000 metrics={'f1_val': 0.9348495175805944, 'auprc': 0.9714273170000618, 'loss_val': 0.32316191623494844, 'psi': 0.9494806373483813}-{'f1_val': 0.9944707343992324, 'auprc': 0.9957184934639532, 'loss_val': 0.4495040206460976, 'psi': 0.9949698380251208}
[S4] START round=31 head_norm_before_train=2.010294 cos_to_last_merge=1.0000 (last merge round=30)
[S4] round=31 local utility u=0.074286 metrics={'f1_val': 0.9430164543871201, 'auprc': 0.9511199910904761, 'loss_val': 0.25581466694825306, 'psi': 0.9462578690684624}-{'f1_val': 0.9338985539142854, 'auprc': 0.9344036858910474, 'loss_val': 0.2995300356338291, 'psi': 0.9341006067049902}
[S5] START round=31 head_norm_before_train=1.763810 (no previous merge yet)
[S5] round=31 local utility u=0.000000 metrics={'f1_val': 0.7145982412546548, 'auprc': 0.8764137312044075, 'loss_val': 0.28485762409409193, 'psi': 0.7793244372345558}-{'f1_val': 0.7260377993856297, 'auprc': 0.9905814877303883, 'loss_val': 0.23957604764595025, 'psi': 0.8318552747235333}
[S6] START round=31 head_norm_before_train=1.276553 cos_to_last_merge=1.0000 (last merge round=30)
[S6] round=31 local utility u=0.000000 metrics={'f1_val': 0.7214777905220947, 'auprc': 0.904419134234783, 'loss_val': 0.5901573649067685, 'psi': 0.7946543280071701}-{'f1_val': 0.7604407993366116, 'auprc': 0.934333413986801, 'loss_val': 0.5435056567392966, 'psi': 0.8299978451966874}
[S7] START round=31 head_norm_before_train=1.326527 cos_to_last_merge=0.9999 (last merge round=29)
[S7] round=31 local utility u=1.000000 metrics={'f1_val': 0.7013138973192434, 'auprc': 0.9456400979970665, 'loss_val': 0.3778996362782928, 'psi': 0.7990443775903726}-{'f1_val': 0.4906597791876959, 'auprc': 0.7470839976080499, 'loss_val': 1.0646507121627216, 'psi': 0.5932294665558375}
[S8] START round=31 head_norm_before_train=1.310007 cos_to_last_merge=1.0000 (last merge round=30)
[S8] round=31 local utility u=0.001901 metrics={'f1_val': 0.9917345774119155, 'auprc': 0.9991209519664715, 'loss_val': 0.0802385290957023, 'psi': 0.9946891272337379}-{'f1_val': 0.9899422292962364, 'auprc': 0.9990370231337773, 'loss_val': 0.07303461574783977, 'psi': 0.9935801468312528}
[S9] START round=31 head_norm_before_train=1.765009 cos_to_last_merge=0.7964 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.796
[S9] round=31 local utility u=0.000000 metrics={'f1_val': 0.9910040044536889, 'auprc': 0.9992260343311303, 'loss_val': 0.032666259578171174, 'psi': 0.9942928164046655}-{'f1_val': 0.9962710290637395, 'auprc': 0.999226128339196, 'loss_val': 0.026293498427027297, 'psi': 0.997453068773922}
[S10] START round=31 head_norm_before_train=1.351614 cos_to_last_merge=0.9992 (last merge round=29)
[S10] round=31 local utility u=0.008504 metrics={'f1_val': 0.9934496907403657, 'auprc': 0.9934289668483725, 'loss_val': 0.06793744464115042, 'psi': 0.9934414011835684}-{'f1_val': 0.9943272539091932, 'auprc': 0.991758085970345, 'loss_val': 0.08519826452159532, 'psi': 0.9932995867336539}
[S11] START round=31 head_norm_before_train=1.869035 cos_to_last_merge=0.7699 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.770
[S11] round=31 local utility u=0.000000 metrics={'f1_val': 0.9408085502956752, 'auprc': 0.9962719158112816, 'loss_val': 0.19839178554267067, 'psi': 0.9629938965019178}-{'f1_val': 0.9958918378685807, 'auprc': 0.9970567396800405, 'loss_val': 0.04169325977145247, 'psi': 0.9963577985931646}
[S13] START round=31 head_norm_before_train=1.845297 (no previous merge yet)
[S13] round=31 local utility u=0.159114 metrics={'f1_val': 0.6510550607319731, 'auprc': 0.7718428151207994, 'loss_val': 0.6719591614911286, 'psi': 0.6993701624875037}-{'f1_val': 0.619432313211445, 'auprc': 0.7675652688568639, 'loss_val': 0.7876183734281487, 'psi': 0.6786854954696127}
[S14] START round=31 head_norm_before_train=1.951903 (no previous merge yet)
[S14] round=31 local utility u=0.000567 metrics={'f1_val': 0.9980850197418996, 'auprc': 0.9991742528194567, 'loss_val': 0.028818817222680346, 'psi': 0.9985207129729223}-{'f1_val': 0.9978938390605482, 'auprc': 0.9992304518154181, 'loss_val': 0.028974002875595657, 'psi': 0.9984284841624962}
[S15] START round=31 head_norm_before_train=1.030897 cos_to_last_merge=0.9919 (last merge round=29)
[S15] round=31 local utility u=0.000000 metrics={'f1_val': 0.700679445504905, 'auprc': 0.8737663742999432, 'loss_val': 0.49539277419844613, 'psi': 0.7699142170229203}-{'f1_val': 0.9100762938886656, 'auprc': 0.9966513830698295, 'loss_val': 0.2808315619072959, 'psi': 0.9447063295611312}
[S16] START round=31 head_norm_before_train=1.442314 cos_to_last_merge=1.0000 (last merge round=30)
[S16] round=31 local utility u=0.014633 metrics={'f1_val': 0.939434987109136, 'auprc': 0.9910157950587104, 'loss_val': 0.23960420716376626, 'psi': 0.9600673102889659}-{'f1_val': 0.9371360190391895, 'auprc': 0.993249008506117, 'loss_val': 0.2617760361891558, 'psi': 0.9595812148259606}
[S17] START round=31 head_norm_before_train=1.864841 cos_to_last_merge=0.8211 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.821
[S17] round=31 local utility u=0.821262 metrics={'f1_val': 0.8014951016946089, 'auprc': 0.939960426953959, 'loss_val': 0.37442043666408054, 'psi': 0.856881231798349}-{'f1_val': 0.6806628930894657, 'auprc': 0.8811759842197816, 'loss_val': 1.1155978498636967, 'psi': 0.760868129541592}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:39402
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:39407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:39407
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:39415
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] → sending delta(kind=head bytes=1805) to S15@127.0.0.1:39415
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] sending update (kind=head size=1806 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1805 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1805) from S7
[S15] cosine check vs S7: cos=0.6790
[S15] RECEIVED delta(kind=head bytes=1798) from S10
[S15] cosine check vs S10: cos=0.7727
[S6] RECEIVED delta(kind=head bytes=1800) from S8
[S6] cosine check vs S8: cos=0.8784
[S2] RECEIVED delta(kind=head bytes=1798) from S4
[S2] cosine check vs S4: cos=0.9989
[S6] RECEIVED delta(kind=head bytes=1802) from S16
[S6] cosine check vs S16: cos=0.6126
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=31 metric=0.6895 head_norm=2.053154
[S2] _apply_head_vector_avg (torch): Δ‖w‖=4.970806e-02
[S2] stored merged vector for next round verification (round=31)
[S2] DEBUG after merge:  round=31 metric=0.6923 head_norm=2.040582 delta_norm=0.049708
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=31 metric=0.7215 head_norm=1.356518
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.572335e-01
[S6] stored merged vector for next round verification (round=31)
[S6] DEBUG after merge:  round=31 metric=0.7122 head_norm=1.222030 delta_norm=0.257234
[S6] aggregate: ROLLBACK (f1_val pre=0.721 post=0.712 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=31 metric=0.7007 head_norm=1.135565
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.778629e-01
[S15] stored merged vector for next round verification (round=31)
[S15] DEBUG after merge:  round=31 metric=0.7005 head_norm=1.128118 delta_norm=0.377863
[S15] aggregate: ACCEPT kept=['S7', 'S10'] (k=2/2) mode=median trim_p=0.1
[S2] START round=32 head_norm_before_train=2.040582 cos_to_last_merge=1.0000 (last merge round=31)
[S2] round=32 local utility u=0.000000 metrics={'f1_val': 0.6729937818744688, 'auprc': 0.7382983212620019, 'loss_val': 0.9068677748328756, 'psi': 0.699115597629482}-{'f1_val': 0.689475228599389, 'auprc': 0.7324575492375405, 'loss_val': 0.8302078159127415, 'psi': 0.7066681568546496}
[S3] START round=32 head_norm_before_train=1.230062 cos_to_last_merge=0.9704 (last merge round=29)
[S3] round=32 local utility u=0.278802 metrics={'f1_val': 0.9915430329930095, 'auprc': 0.9959611114981552, 'loss_val': 0.17932005579787103, 'psi': 0.9933102643950679}-{'f1_val': 0.9348495175805944, 'auprc': 0.9714273170000618, 'loss_val': 0.32316191623494844, 'psi': 0.9494806373483813}
[S4] START round=32 head_norm_before_train=2.029150 cos_to_last_merge=0.9999 (last merge round=30)
[S4] round=32 local utility u=0.060087 metrics={'f1_val': 0.9533085642768678, 'auprc': 0.9771413898710177, 'loss_val': 0.2754582867616213, 'psi': 0.9628416945145277}-{'f1_val': 0.9430164543871201, 'auprc': 0.9511199910904761, 'loss_val': 0.25581466694825306, 'psi': 0.9462578690684624}
[S5] START round=32 head_norm_before_train=1.769661 (no previous merge yet)
[S5] round=32 local utility u=1.000000 metrics={'f1_val': 0.996625909096903, 'auprc': 0.9971913776322667, 'loss_val': 0.1279365218980227, 'psi': 0.9968520965110486}-{'f1_val': 0.7145982412546548, 'auprc': 0.8764137312044075, 'loss_val': 0.28485762409409193, 'psi': 0.7793244372345558}
[S6] START round=32 head_norm_before_train=1.222030 cos_to_last_merge=1.0000 (last merge round=31)
[S6] round=32 local utility u=0.169371 metrics={'f1_val': 0.756995657096546, 'auprc': 0.9260136384814246, 'loss_val': 0.5293064600055948, 'psi': 0.8246028496504975}-{'f1_val': 0.7214777905220947, 'auprc': 0.904419134234783, 'loss_val': 0.5901573649067685, 'psi': 0.7946543280071701}
[S7] START round=32 head_norm_before_train=1.335979 cos_to_last_merge=0.9998 (last merge round=29)
[S7] round=32 local utility u=0.000000 metrics={'f1_val': 0.5268767841710364, 'auprc': 0.755517266846135, 'loss_val': 1.0155060467058068, 'psi': 0.6183329772410759}-{'f1_val': 0.7013138973192434, 'auprc': 0.9456400979970665, 'loss_val': 0.3778996362782928, 'psi': 0.7990443775903726}
[S8] START round=32 head_norm_before_train=1.373974 cos_to_last_merge=0.9989 (last merge round=30)
[S8] round=32 local utility u=0.015641 metrics={'f1_val': 0.9939539858461368, 'auprc': 0.9993646474065505, 'loss_val': 0.06300431068564208, 'psi': 0.9961182504703023}-{'f1_val': 0.9917345774119155, 'auprc': 0.9991209519664715, 'loss_val': 0.0802385290957023, 'psi': 0.9946891272337379}
[S9] START round=32 head_norm_before_train=1.776389 cos_to_last_merge=0.7956 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.796
[S9] round=32 local utility u=0.006380 metrics={'f1_val': 0.992684475148198, 'auprc': 0.9991179071644448, 'loss_val': 0.029663921581982135, 'psi': 0.9952578479546967}-{'f1_val': 0.9910040044536889, 'auprc': 0.9992260343311303, 'loss_val': 0.032666259578171174, 'psi': 0.9942928164046655}
[S10] START round=32 head_norm_before_train=1.401373 cos_to_last_merge=0.9970 (last merge round=29)
[S10] round=32 local utility u=0.008718 metrics={'f1_val': 0.993560617225544, 'auprc': 0.9964470150259079, 'loss_val': 0.06022100948226764, 'psi': 0.9947151763456896}-{'f1_val': 0.9934496907403657, 'auprc': 0.9934289668483725, 'loss_val': 0.06793744464115042, 'psi': 0.9934414011835684}
[S11] START round=32 head_norm_before_train=1.887118 cos_to_last_merge=0.7678 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.768
[S11] round=32 local utility u=0.235872 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.9963139287659267, 'loss_val': 0.05727421663138356, 'psi': 0.9960606742275191}-{'f1_val': 0.9408085502956752, 'auprc': 0.9962719158112816, 'loss_val': 0.19839178554267067, 'psi': 0.9629938965019178}
[S13] START round=32 head_norm_before_train=1.858294 (no previous merge yet)
[S13] round=32 local utility u=0.000000 metrics={'f1_val': 0.6517197305079048, 'auprc': 0.7779696680228354, 'loss_val': 0.7866592873768852, 'psi': 0.702219705513877}-{'f1_val': 0.6510550607319731, 'auprc': 0.7718428151207994, 'loss_val': 0.6719591614911286, 'psi': 0.6993701624875037}
[S14] START round=32 head_norm_before_train=1.962879 (no previous merge yet)
[S14] round=32 local utility u=0.000000 metrics={'f1_val': 0.9343244128016128, 'auprc': 0.996787616206104, 'loss_val': 0.11296893577750682, 'psi': 0.9593096941634093}-{'f1_val': 0.9980850197418996, 'auprc': 0.9991742528194567, 'loss_val': 0.028818817222680346, 'psi': 0.9985207129729223}
[S15] START round=32 head_norm_before_train=1.128118 cos_to_last_merge=1.0000 (last merge round=31)
[S15] round=32 local utility u=0.340201 metrics={'f1_val': 0.7809642386518688, 'auprc': 0.9149465023837218, 'loss_val': 0.4202405016824787, 'psi': 0.83455714414461}-{'f1_val': 0.700679445504905, 'auprc': 0.8737663742999432, 'loss_val': 0.49539277419844613, 'psi': 0.7699142170229203}
[S16] START round=32 head_norm_before_train=1.464754 cos_to_last_merge=0.9999 (last merge round=30)
[S16] round=32 local utility u=0.248004 metrics={'f1_val': 0.9915768828693267, 'auprc': 0.9954798670097212, 'loss_val': 0.06984025467095409, 'psi': 0.9931380765254845}-{'f1_val': 0.939434987109136, 'auprc': 0.9910157950587104, 'loss_val': 0.23960420716376626, 'psi': 0.9600673102889659}
[S17] START round=32 head_norm_before_train=1.875083 cos_to_last_merge=0.8203 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.820
[S17] round=32 local utility u=0.000000 metrics={'f1_val': 0.6841376913963648, 'auprc': 0.8729525957717458, 'loss_val': 1.229875996526442, 'psi': 0.7596636531465173}-{'f1_val': 0.8014951016946089, 'auprc': 0.939960426953959, 'loss_val': 0.37442043666408054, 'psi': 0.856881231798349}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:39416
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:39407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:39415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:39410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:39402
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:39405
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:39409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:39408
[S9] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1797) from S10
[S15] cosine check vs S10: cos=0.8800
[S7] RECEIVED delta(kind=head bytes=1799) from S11
[S7] cosine check vs S11: cos=0.8875
[S5] RECEIVED delta(kind=head bytes=1801) from S9
[S5] cosine check vs S9: cos=-0.0472
[S5] DROPPED delta from S9 (cos=-0.0472 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1798) from S4
[S2] cosine check vs S4: cos=0.9992
[S8] RECEIVED delta(kind=head bytes=1797) from S3
[S8] cosine check vs S3: cos=0.9044
[S9] RECEIVED delta(kind=head bytes=1797) from S5
[S9] cosine check vs S5: cos=-0.0472
[S9] DROPPED delta from S5 (cos=-0.0472 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1802) from S6
[S16] cosine check vs S6: cos=0.6908
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:39408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S16] → sending delta(kind=head bytes=1807) to S6@127.0.0.1:39407
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1807 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1796) from S15
[S7] cosine check vs S15: cos=0.8185
[S6] RECEIVED delta(kind=head bytes=1807) from S16
[S6] cosine check vs S16: cos=0.6908
[S8] sending update (kind=head size=1797 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1797) from S8
[S6] cosine check vs S8: cos=0.8500
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=32 metric=0.5269 head_norm=1.348018
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.347503e-01
[S7] stored merged vector for next round verification (round=32)
[S7] DEBUG after merge:  round=32 metric=0.5250 head_norm=1.350932 delta_norm=0.134750
[S7] aggregate: ACCEPT kept=['S11', 'S15'] (k=2/2) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=32 metric=0.7570 head_norm=1.310836
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.767154e-01
[S6] stored merged vector for next round verification (round=32)
[S6] DEBUG after merge:  round=32 metric=0.7546 head_norm=1.225902 delta_norm=0.176715
[S6] aggregate: ACCEPT kept=['S16', 'S8'] (k=2/2) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=32 metric=0.6730 head_norm=2.063897
[S2] _apply_head_vector_avg (torch): Δ‖w‖=4.603901e-02
[S2] stored merged vector for next round verification (round=32)
[S2] DEBUG after merge:  round=32 metric=0.6702 head_norm=2.043040 delta_norm=0.046039
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=32 metric=0.9916 head_norm=1.498293
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.589520e-01
[S16] stored merged vector for next round verification (round=32)
[S16] DEBUG after merge:  round=32 metric=0.9904 head_norm=1.291960 delta_norm=0.558952
[S16] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=32 metric=0.7810 head_norm=1.214206
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.452813e-01
[S15] stored merged vector for next round verification (round=32)
[S15] DEBUG after merge:  round=32 metric=0.7819 head_norm=1.291047 delta_norm=0.345281
[S15] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=32 metric=0.9940 head_norm=1.423901
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.038542e-01
[S8] stored merged vector for next round verification (round=32)
[S8] DEBUG after merge:  round=32 metric=0.9940 head_norm=1.325046 delta_norm=0.303854
[S8] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=33 head_norm_before_train=2.043040 cos_to_last_merge=1.0000 (last merge round=32)
[S2] round=33 local utility u=0.000000 metrics={'f1_val': 0.6590955341452587, 'auprc': 0.7315740279101637, 'loss_val': 1.0177033617700866, 'psi': 0.6880869316512207}-{'f1_val': 0.6729937818744688, 'auprc': 0.7382983212620019, 'loss_val': 0.9068677748328756, 'psi': 0.699115597629482}
[S3] START round=33 head_norm_before_train=1.291764 cos_to_last_merge=0.9477 (last merge round=29)
[S3] ⚠️ Model drifted since last merge! cos=0.948
[S3] round=33 local utility u=0.000000 metrics={'f1_val': 0.9834700229051168, 'auprc': 0.9974524337306107, 'loss_val': 0.13855271178666592, 'psi': 0.9890629872353143}-{'f1_val': 0.9915430329930095, 'auprc': 0.9959611114981552, 'loss_val': 0.17932005579787103, 'psi': 0.9933102643950679}
[S4] START round=33 head_norm_before_train=2.023016 cos_to_last_merge=0.9996 (last merge round=30)
[S4] round=33 local utility u=0.000000 metrics={'f1_val': 0.9328371169432147, 'auprc': 0.9411121702187766, 'loss_val': 0.30842853417566307, 'psi': 0.9361471382534394}-{'f1_val': 0.9533085642768678, 'auprc': 0.9771413898710177, 'loss_val': 0.2754582867616213, 'psi': 0.9628416945145277}
[S5] START round=33 head_norm_before_train=1.774154 (no previous merge yet)
[S5] round=33 local utility u=0.008273 metrics={'f1_val': 0.9964804002465358, 'auprc': 0.9975884815103487, 'loss_val': 0.11170870495379827, 'psi': 0.996923632752061}-{'f1_val': 0.996625909096903, 'auprc': 0.9971913776322667, 'loss_val': 0.1279365218980227, 'psi': 0.9968520965110486}
[S6] START round=33 head_norm_before_train=1.225902 cos_to_last_merge=1.0000 (last merge round=32)
[S6] round=33 local utility u=0.262853 metrics={'f1_val': 0.8131344428670295, 'auprc': 0.9587843710509546, 'loss_val': 0.4387453299930754, 'psi': 0.8713944141405996}-{'f1_val': 0.756995657096546, 'auprc': 0.9260136384814246, 'loss_val': 0.5293064600055948, 'psi': 0.8246028496504975}
[S7] START round=33 head_norm_before_train=1.350932 cos_to_last_merge=1.0000 (last merge round=32)
[S7] round=33 local utility u=0.544710 metrics={'f1_val': 0.6261118673323768, 'auprc': 0.7965306584569516, 'loss_val': 0.6445367786124498, 'psi': 0.6942793837822068}-{'f1_val': 0.5268767841710364, 'auprc': 0.755517266846135, 'loss_val': 1.0155060467058068, 'psi': 0.6183329772410759}
[S8] START round=33 head_norm_before_train=1.325046 cos_to_last_merge=1.0000 (last merge round=32)
[S8] round=33 local utility u=0.000000 metrics={'f1_val': 0.994249246104514, 'auprc': 0.9917421681205655, 'loss_val': 0.07843367006325738, 'psi': 0.9932464149109346}-{'f1_val': 0.9939539858461368, 'auprc': 0.9993646474065505, 'loss_val': 0.06300431068564208, 'psi': 0.9961182504703023}
[S9] START round=33 head_norm_before_train=1.787367 cos_to_last_merge=0.7947 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.795
[S9] round=33 local utility u=0.013342 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9986411119039407, 'loss_val': 0.023068539376955792, 'psi': 0.9972190621998199}-{'f1_val': 0.992684475148198, 'auprc': 0.9991179071644448, 'loss_val': 0.029663921581982135, 'psi': 0.9952578479546967}
[S10] START round=33 head_norm_before_train=1.448361 cos_to_last_merge=0.9943 (last merge round=29)
[S10] round=33 local utility u=0.002288 metrics={'f1_val': 0.9948838907637279, 'auprc': 0.9922203355818797, 'loss_val': 0.0509048546718026, 'psi': 0.9938184686909887}-{'f1_val': 0.993560617225544, 'auprc': 0.9964470150259079, 'loss_val': 0.06022100948226764, 'psi': 0.9947151763456896}
[S11] START round=33 head_norm_before_train=1.900826 cos_to_last_merge=0.7662 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.766
[S11] round=33 local utility u=0.005509 metrics={'f1_val': 0.9959130523161147, 'auprc': 0.996715060253216, 'loss_val': 0.0475874213131235, 'psi': 0.9962338554909552}-{'f1_val': 0.9958918378685807, 'auprc': 0.9963139287659267, 'loss_val': 0.05727421663138356, 'psi': 0.9960606742275191}
[S13] START round=33 head_norm_before_train=1.872151 (no previous merge yet)
[S13] round=33 local utility u=0.000000 metrics={'f1_val': 0.6075458570087335, 'auprc': 0.7281084477835363, 'loss_val': 1.0746603648979034, 'psi': 0.6557708933186546}-{'f1_val': 0.6517197305079048, 'auprc': 0.7779696680228354, 'loss_val': 0.7866592873768852, 'psi': 0.702219705513877}
[S14] START round=33 head_norm_before_train=1.972301 (no previous merge yet)
[S14] round=33 local utility u=0.233385 metrics={'f1_val': 0.997841853906109, 'auprc': 0.9971527483585384, 'loss_val': 0.02839879547384498, 'psi': 0.9975662116870808}-{'f1_val': 0.9343244128016128, 'auprc': 0.996787616206104, 'loss_val': 0.11296893577750682, 'psi': 0.9593096941634093}
[S15] START round=33 head_norm_before_train=1.291047 cos_to_last_merge=1.0000 (last merge round=32)
[S15] round=33 local utility u=0.260665 metrics={'f1_val': 0.8149612979683589, 'auprc': 0.9927017440638606, 'loss_val': 0.33615936222836595, 'psi': 0.8860574764065596}-{'f1_val': 0.7809642386518688, 'auprc': 0.9149465023837218, 'loss_val': 0.4202405016824787, 'psi': 0.83455714414461}
[S16] START round=33 head_norm_before_train=1.291960 cos_to_last_merge=1.0000 (last merge round=32)
[S16] round=33 local utility u=0.000000 metrics={'f1_val': 0.9930849640890562, 'auprc': 0.9963143336720761, 'loss_val': 0.11126981206315177, 'psi': 0.9943767119222642}-{'f1_val': 0.9915768828693267, 'auprc': 0.9954798670097212, 'loss_val': 0.06984025467095409, 'psi': 0.9931380765254845}
[S17] START round=33 head_norm_before_train=1.883107 cos_to_last_merge=0.8200 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.820
[S17] round=33 local utility u=0.282361 metrics={'f1_val': 0.6946290112680336, 'auprc': 0.8998494390542641, 'loss_val': 0.8087927866241893, 'psi': 0.7767171823825259}-{'f1_val': 0.6841376913963648, 'auprc': 0.8729525957717458, 'loss_val': 1.229875996526442, 'psi': 0.7596636531465173}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:39405
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:39416
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] → sending delta(kind=head bytes=1794) to S7@127.0.0.1:39408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:39410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:39415
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:39415
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:39408
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1794 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1801) from S10
[S15] cosine check vs S10: cos=0.9657
[S15] RECEIVED delta(kind=head bytes=1798) from S7
[S15] cosine check vs S7: cos=0.7148
[S7] RECEIVED delta(kind=head bytes=1797) from S11
[S7] cosine check vs S11: cos=0.9102
[S7] RECEIVED delta(kind=head bytes=1794) from S15
[S7] cosine check vs S15: cos=0.7148
[S9] RECEIVED delta(kind=head bytes=1799) from S5
[S9] cosine check vs S5: cos=-0.0466
[S9] DROPPED delta from S5 (cos=-0.0466 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1798) from S9
[S5] cosine check vs S9: cos=-0.0466
[S5] DROPPED delta from S9 (cos=-0.0466 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1801) from S6
[S16] cosine check vs S6: cos=0.9155
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S5
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S15
[S6]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S16
[S7]  timeout peer S17
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S16
[S10]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S2]  timeout peer S3
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S16
[S14]  timeout peer S17
[S3]  timeout peer S2
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S15]  timeout peer S2
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S11
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S16
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S5]  timeout peer S17
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=33 metric=0.9931 head_norm=1.340291
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.740256e-01
[S16] stored merged vector for next round verification (round=33)
[S16] DEBUG after merge:  round=33 metric=0.9931 head_norm=1.304113 delta_norm=0.274026
[S16] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=33 metric=0.6261 head_norm=1.361607
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.514751e-02
[S7] stored merged vector for next round verification (round=33)
[S7] DEBUG after merge:  round=33 metric=0.6243 head_norm=1.359885 delta_norm=0.055148
[S7] aggregate: ACCEPT kept=['S11', 'S15'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=33 metric=0.8150 head_norm=1.357929
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.199006e-01
[S15] stored merged vector for next round verification (round=33)
[S15] DEBUG after merge:  round=33 metric=0.8126 head_norm=1.297388 delta_norm=0.219901
[S15] aggregate: ACCEPT kept=['S10', 'S7'] (k=2/2) mode=median trim_p=0.1
[S2] START round=34 head_norm_before_train=2.061504 cos_to_last_merge=0.9999 (last merge round=32)
[S2] round=34 local utility u=0.000000 metrics={'f1_val': 0.6563938647419199, 'auprc': 0.7333752324883012, 'loss_val': 1.0489504477879141, 'psi': 0.6871864118404725}-{'f1_val': 0.6590955341452587, 'auprc': 0.7315740279101637, 'loss_val': 1.0177033617700866, 'psi': 0.6880869316512207}
[S3] START round=34 head_norm_before_train=1.355529 cos_to_last_merge=0.9273 (last merge round=29)
[S3] ⚠️ Model drifted since last merge! cos=0.927
[S3] round=34 local utility u=0.018127 metrics={'f1_val': 0.9847627515137729, 'auprc': 0.9972415901420373, 'loss_val': 0.10942184656907787, 'psi': 0.9897542869650786}-{'f1_val': 0.9834700229051168, 'auprc': 0.9974524337306107, 'loss_val': 0.13855271178666592, 'psi': 0.9890629872353143}
[S4] START round=34 head_norm_before_train=2.027270 cos_to_last_merge=0.9992 (last merge round=30)
[S4] round=34 local utility u=0.079500 metrics={'f1_val': 0.9460926112480343, 'auprc': 0.9622532877906284, 'loss_val': 0.292385410812709, 'psi': 0.9525568818650719}-{'f1_val': 0.9328371169432147, 'auprc': 0.9411121702187766, 'loss_val': 0.30842853417566307, 'psi': 0.9361471382534394}
[S5] START round=34 head_norm_before_train=1.782528 (no previous merge yet)
[S5] round=34 local utility u=0.000825 metrics={'f1_val': 0.9963332086366786, 'auprc': 0.997571955468113, 'loss_val': 0.10912683472352756, 'psi': 0.9968287073692523}-{'f1_val': 0.9964804002465358, 'auprc': 0.9975884815103487, 'loss_val': 0.11170870495379827, 'psi': 0.996923632752061}
[S6] START round=34 head_norm_before_train=1.324849 cos_to_last_merge=0.9965 (last merge round=32)
[S6] round=34 local utility u=0.000000 metrics={'f1_val': 0.7291378668218428, 'auprc': 0.9452471352687247, 'loss_val': 0.5984947066005375, 'psi': 0.8155815742005956}-{'f1_val': 0.8131344428670295, 'auprc': 0.9587843710509546, 'loss_val': 0.4387453299930754, 'psi': 0.8713944141405996}
[S7] START round=34 head_norm_before_train=1.359885 cos_to_last_merge=1.0000 (last merge round=33)
[S7] round=34 local utility u=0.000000 metrics={'f1_val': 0.6020398253063248, 'auprc': 0.7955088276273558, 'loss_val': 0.6892675042865916, 'psi': 0.6794274262347373}-{'f1_val': 0.6261118673323768, 'auprc': 0.7965306584569516, 'loss_val': 0.6445367786124498, 'psi': 0.6942793837822068}
[S8] START round=34 head_norm_before_train=1.377370 cos_to_last_merge=0.9991 (last merge round=32)
[S8] round=34 local utility u=0.012136 metrics={'f1_val': 0.9920973070316986, 'auprc': 0.9991847046558339, 'loss_val': 0.06357803513125532, 'psi': 0.9949322660813527}-{'f1_val': 0.994249246104514, 'auprc': 0.9917421681205655, 'loss_val': 0.07843367006325738, 'psi': 0.9932464149109346}
[S9] START round=34 head_norm_before_train=1.798561 cos_to_last_merge=0.7938 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.794
[S9] round=34 local utility u=0.000000 metrics={'f1_val': 0.9939393793306803, 'auprc': 0.9988417148162678, 'loss_val': 0.02736501505734635, 'psi': 0.9959003135249154}-{'f1_val': 0.9962710290637395, 'auprc': 0.9986411119039407, 'loss_val': 0.023068539376955792, 'psi': 0.9972190621998199}
[S10] START round=34 head_norm_before_train=1.485525 cos_to_last_merge=0.9920 (last merge round=29)
[S10] round=34 local utility u=0.000000 metrics={'f1_val': 0.9940063275949004, 'auprc': 0.9923663440495643, 'loss_val': 0.04754510383962206, 'psi': 0.993350334176766}-{'f1_val': 0.9948838907637279, 'auprc': 0.9922203355818797, 'loss_val': 0.0509048546718026, 'psi': 0.9938184686909887}
[S11] START round=34 head_norm_before_train=1.913134 cos_to_last_merge=0.7649 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.765
[S11] round=34 local utility u=0.007896 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.996712898215367, 'loss_val': 0.03311334939591086, 'psi': 0.9963653642341324}-{'f1_val': 0.9959130523161147, 'auprc': 0.996715060253216, 'loss_val': 0.0475874213131235, 'psi': 0.9962338554909552}
[S13] START round=34 head_norm_before_train=1.889244 (no previous merge yet)
[S13] round=34 local utility u=0.360097 metrics={'f1_val': 0.662431523789802, 'auprc': 0.7925717359287764, 'loss_val': 0.8771711830456438, 'psi': 0.7144876086453917}-{'f1_val': 0.6075458570087335, 'auprc': 0.7281084477835363, 'loss_val': 1.0746603648979034, 'psi': 0.6557708933186546}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S14] START round=34 head_norm_before_train=1.979097 (no previous merge yet)
[S14] round=34 local utility u=0.001387 metrics={'f1_val': 0.9978217593544257, 'auprc': 0.9975281314336374, 'loss_val': 0.026629809520344057, 'psi': 0.9977043081861103}-{'f1_val': 0.997841853906109, 'auprc': 0.9971527483585384, 'loss_val': 0.02839879547384498, 'psi': 0.9975662116870808}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] sending update (kind=head size=1794 to 1 peers)
[S15] START round=34 head_norm_before_train=1.297388 cos_to_last_merge=1.0000 (last merge round=33)
[S15] round=34 local utility u=0.000000 metrics={'f1_val': 0.700679445504905, 'auprc': 0.8029148035211257, 'loss_val': 0.5245769098097606, 'psi': 0.7415735887113932}-{'f1_val': 0.8149612979683589, 'auprc': 0.9927017440638606, 'loss_val': 0.33615936222836595, 'psi': 0.8860574764065596}
[S16] START round=34 head_norm_before_train=1.304113 cos_to_last_merge=1.0000 (last merge round=33)
[S16] round=34 local utility u=0.000000 metrics={'f1_val': 0.9926172978209893, 'auprc': 0.9951201784861639, 'loss_val': 0.13661123264600827, 'psi': 0.9936184500870591}-{'f1_val': 0.9930849640890562, 'auprc': 0.9963143336720761, 'loss_val': 0.11126981206315177, 'psi': 0.9943767119222642}
[S17] START round=34 head_norm_before_train=1.895049 cos_to_last_merge=0.8192 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.819
[S17] round=34 local utility u=1.000000 metrics={'f1_val': 0.9230365521164914, 'auprc': 0.9914733849077956, 'loss_val': 0.18407942759530516, 'psi': 0.950411285233013}-{'f1_val': 0.6946290112680336, 'auprc': 0.8998494390542641, 'loss_val': 0.8087927866241893, 'psi': 0.7767171823825259}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:39408
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:39402
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:39410
[S5] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:39409
[S7] RECEIVED delta(kind=head bytes=1798) from S11
[S7] cosine check vs S11: cos=0.8981
[S9] RECEIVED delta(kind=head bytes=1799) from S5
[S9] cosine check vs S5: cos=-0.0461
[S9] DROPPED delta from S5 (cos=-0.0461 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1799) from S4
[S2] cosine check vs S4: cos=0.9989
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:39407
[S3] sending update (kind=head size=1802 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] RECEIVED delta(kind=head bytes=1802) from S3
[S8] cosine check vs S3: cos=0.9345
[S8] sending update (kind=head size=1801 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1801) from S8
[S6] cosine check vs S8: cos=0.8028
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=34 metric=0.9921 head_norm=1.432599
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.580898e-01
[S8] stored merged vector for next round verification (round=34)
[S8] DEBUG after merge:  round=34 metric=0.9921 head_norm=1.401986 delta_norm=0.258090
[S8] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=34 metric=0.7291 head_norm=1.409313
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.462746e-01
[S6] stored merged vector for next round verification (round=34)
[S6] DEBUG after merge:  round=34 metric=0.7293 head_norm=1.349107 delta_norm=0.446275
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S7] CommDone barrier timeout: have=1 need=2 — continuing
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=34 metric=0.6020 head_norm=1.368983
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.607110e-01
[S7] stored merged vector for next round verification (round=34)
[S7] DEBUG after merge:  round=34 metric=0.5956 head_norm=1.606687 delta_norm=0.460711
[S7] aggregate: ROLLBACK (f1_val pre=0.602 post=0.596 tol_abs=0.005 tol_rel=0.0)
[S15] RoundReady barrier timeout: have=2 need=3 — continuing
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3]  timeout peer S8
[S3]  timeout peer S9
[S2]  timeout peer S4
[S6]  timeout peer S14
[S6]  timeout peer S16
[S15]  timeout peer S3
[S15]  timeout peer S7
[S15]  timeout peer S13
[S9]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S17
[S7]  timeout peer S10
[S7]  timeout peer S11
[S10]  timeout peer S2
[S10]  timeout peer S15
[S2] START round=35 head_norm_before_train=2.074494 cos_to_last_merge=0.9997 (last merge round=32)
[S2] round=35 local utility u=0.070104 metrics={'f1_val': 0.6635215028836086, 'auprc': 0.7398352764430028, 'loss_val': 0.9708877938096521, 'psi': 0.6940470123073663}-{'f1_val': 0.6563938647419199, 'auprc': 0.7333752324883012, 'loss_val': 1.0489504477879141, 'psi': 0.6871864118404725}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=35 metric=0.6635 head_norm=2.087371
[S2] _apply_head_vector_avg (torch): Δ‖w‖=6.214045e-02
[S2] stored merged vector for next round verification (round=35)
[S2] DEBUG after merge:  round=35 metric=0.6613 head_norm=2.058346 delta_norm=0.062140
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S3] START round=35 head_norm_before_train=1.418453 cos_to_last_merge=0.9102 (last merge round=29)
[S3] ⚠️ Model drifted since last merge! cos=0.910
[S3] round=35 local utility u=0.000000 metrics={'f1_val': 0.9302895454487666, 'auprc': 0.9974668168972425, 'loss_val': 0.22461638227460967, 'psi': 0.957160454028157}-{'f1_val': 0.9847627515137729, 'auprc': 0.9972415901420373, 'loss_val': 0.10942184656907787, 'psi': 0.9897542869650786}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=35 head_norm_before_train=2.030807 cos_to_last_merge=0.9991 (last merge round=30)
[S4] round=35 local utility u=0.000000 metrics={'f1_val': 0.934976143114017, 'auprc': 0.9398189508211426, 'loss_val': 0.27841076774139484, 'psi': 0.9369132661968672}-{'f1_val': 0.9460926112480343, 'auprc': 0.9622532877906284, 'loss_val': 0.292385410812709, 'psi': 0.9525568818650719}
[S5] START round=35 head_norm_before_train=1.792329 (no previous merge yet)
[S5] round=35 local utility u=0.011873 metrics={'f1_val': 0.996625909096903, 'auprc': 0.997520954164326, 'loss_val': 0.0869837935478429, 'psi': 0.9969839271238722}-{'f1_val': 0.9963332086366786, 'auprc': 0.997571955468113, 'loss_val': 0.10912683472352756, 'psi': 0.9968287073692523}
[S6] START round=35 head_norm_before_train=1.349107 cos_to_last_merge=1.0000 (last merge round=34)
[S6] round=35 local utility u=0.401113 metrics={'f1_val': 0.8229421132540624, 'auprc': 0.9611997757507487, 'loss_val': 0.4069525673995418, 'psi': 0.878245178252737}-{'f1_val': 0.7291378668218428, 'auprc': 0.9452471352687247, 'loss_val': 0.5984947066005375, 'psi': 0.8155815742005956}
[S7] START round=35 head_norm_before_train=1.606687 cos_to_last_merge=1.0000 (last merge round=34)
[S7] round=35 local utility u=0.840938 metrics={'f1_val': 0.7156994379175958, 'auprc': 0.9876922597947594, 'loss_val': 0.2658998396263235, 'psi': 0.8244965666684613}-{'f1_val': 0.6020398253063248, 'auprc': 0.7955088276273558, 'loss_val': 0.6892675042865916, 'psi': 0.6794274262347373}
[S8] START round=35 head_norm_before_train=1.401986 cos_to_last_merge=1.0000 (last merge round=34)
[S8] round=35 local utility u=0.000000 metrics={'f1_val': 0.986952513052197, 'auprc': 0.9973874031072582, 'loss_val': 0.08507404201809322, 'psi': 0.9911264690742215}-{'f1_val': 0.9920973070316986, 'auprc': 0.9991847046558339, 'loss_val': 0.06357803513125532, 'psi': 0.9949322660813527}
[S9] START round=35 head_norm_before_train=1.807080 cos_to_last_merge=0.7931 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.793
[S9] round=35 local utility u=0.000573 metrics={'f1_val': 0.9939393793306803, 'auprc': 0.9988472247853676, 'loss_val': 0.02623464317464735, 'psi': 0.9959025175125553}-{'f1_val': 0.9939393793306803, 'auprc': 0.9988417148162678, 'loss_val': 0.02736501505734635, 'psi': 0.9959003135249154}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=35 head_norm_before_train=1.519603 cos_to_last_merge=0.9898 (last merge round=29)
[S10] round=35 local utility u=0.001017 metrics={'f1_val': 0.9937871219080217, 'auprc': 0.9925591716826462, 'loss_val': 0.0447742223134235, 'psi': 0.9932959418178715}-{'f1_val': 0.9940063275949004, 'auprc': 0.9923663440495643, 'loss_val': 0.04754510383962206, 'psi': 0.993350334176766}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] sending update (kind=head size=1794 to 1 peers)
[S11] START round=35 head_norm_before_train=1.926988 cos_to_last_merge=0.7639 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.764
[S11] round=35 local utility u=0.003363 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9979150716078957, 'loss_val': 0.02999433170460422, 'psi': 0.9968462335911439}-{'f1_val': 0.9961336749133093, 'auprc': 0.996712898215367, 'loss_val': 0.03311334939591086, 'psi': 0.9963653642341324}
[S13] START round=35 head_norm_before_train=1.902050 (no previous merge yet)
[S13] round=35 local utility u=0.186747 metrics={'f1_val': 0.7279561842728497, 'auprc': 0.7882155300762645, 'loss_val': 0.8837565576234704, 'psi': 0.7520599225942156}-{'f1_val': 0.662431523789802, 'auprc': 0.7925717359287764, 'loss_val': 0.8771711830456438, 'psi': 0.7144876086453917}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=35 head_norm_before_train=1.987924 (no previous merge yet)
[S14] round=35 local utility u=0.000000 metrics={'f1_val': 0.9398044906760981, 'auprc': 0.9971825381352502, 'loss_val': 0.10445435101862563, 'psi': 0.962755709659759}-{'f1_val': 0.9978217593544257, 'auprc': 0.9975281314336374, 'loss_val': 0.026629809520344057, 'psi': 0.9977043081861103}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=35 head_norm_before_train=1.349241 cos_to_last_merge=0.9988 (last merge round=33)
[S15] round=35 local utility u=0.463575 metrics={'f1_val': 0.7845805601869429, 'auprc': 0.9074437099793898, 'loss_val': 0.4144199926257401, 'psi': 0.8337258201039217}-{'f1_val': 0.700679445504905, 'auprc': 0.8029148035211257, 'loss_val': 0.5245769098097606, 'psi': 0.7415735887113932}
[S16] START round=35 head_norm_before_train=1.365385 cos_to_last_merge=0.9968 (last merge round=33)
[S16] round=35 local utility u=0.000000 metrics={'f1_val': 0.9292562076866886, 'auprc': 0.9949195935133797, 'loss_val': 0.30778513454058787, 'psi': 0.955521562017365}-{'f1_val': 0.9926172978209893, 'auprc': 0.9951201784861639, 'loss_val': 0.13661123264600827, 'psi': 0.9936184500870591}
[S17] START round=35 head_norm_before_train=1.909757 cos_to_last_merge=0.8179 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.818
[S17] round=35 local utility u=0.000000 metrics={'f1_val': 0.7189207988385704, 'auprc': 0.9099462908911697, 'loss_val': 0.8584526317137525, 'psi': 0.7953309956596102}-{'f1_val': 0.9230365521164914, 'auprc': 0.9914733849077956, 'loss_val': 0.18407942759530516, 'psi': 0.950411285233013}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=36 head_norm_before_train=2.058346 cos_to_last_merge=1.0000 (last merge round=35)
[S2] round=36 local utility u=0.000000 metrics={'f1_val': 0.6372055155210643, 'auprc': 0.7376191705733043, 'loss_val': 1.0836909798250929, 'psi': 0.6773709775419603}-{'f1_val': 0.6635215028836086, 'auprc': 0.7398352764430028, 'loss_val': 0.9708877938096521, 'psi': 0.6940470123073663}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=36 head_norm_before_train=1.473359 cos_to_last_merge=0.8971 (last merge round=29)
[S3] ⚠️ Model drifted since last merge! cos=0.897
[S3] round=36 local utility u=0.234057 metrics={'f1_val': 0.9882998237075507, 'auprc': 0.9984587987414458, 'loss_val': 0.10753953147425255, 'psi': 0.9923634137211087}-{'f1_val': 0.9302895454487666, 'auprc': 0.9974668168972425, 'loss_val': 0.22461638227460967, 'psi': 0.957160454028157}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S3] sending update (kind=head size=1806 to 1 peers)
[S4] START round=36 head_norm_before_train=2.035305 cos_to_last_merge=0.9990 (last merge round=30)
[S4] round=36 local utility u=0.036050 metrics={'f1_val': 0.9429189541191088, 'auprc': 0.9525727203943353, 'loss_val': 0.29222961887456367, 'psi': 0.9467804606291994}-{'f1_val': 0.934976143114017, 'auprc': 0.9398189508211426, 'loss_val': 0.27841076774139484, 'psi': 0.9369132661968672}
[S5] START round=36 head_norm_before_train=1.803949 (no previous merge yet)
[S5] round=36 local utility u=0.000000 metrics={'f1_val': 0.7191028586633352, 'auprc': 0.9916791444840252, 'loss_val': 0.18952191180925768, 'psi': 0.8281333729916112}-{'f1_val': 0.996625909096903, 'auprc': 0.997520954164326, 'loss_val': 0.0869837935478429, 'psi': 0.9969839271238722}
[S6] START round=36 head_norm_before_train=1.409231 cos_to_last_merge=0.9991 (last merge round=34)
[S6] round=36 local utility u=0.000000 metrics={'f1_val': 0.6239422199123336, 'auprc': 0.9398299627415744, 'loss_val': 0.7031254893905277, 'psi': 0.7502973170440299}-{'f1_val': 0.8229421132540624, 'auprc': 0.9611997757507487, 'loss_val': 0.4069525673995418, 'psi': 0.878245178252737}
[S7] START round=36 head_norm_before_train=1.618806 cos_to_last_merge=0.9999 (last merge round=34)
[S7] round=36 local utility u=0.000000 metrics={'f1_val': 0.5405974241846925, 'auprc': 0.7455533445647988, 'loss_val': 1.0344390091454547, 'psi': 0.622579792336735}-{'f1_val': 0.7156994379175958, 'auprc': 0.9876922597947594, 'loss_val': 0.2658998396263235, 'psi': 0.8244965666684613}
[S8] START round=36 head_norm_before_train=1.459995 cos_to_last_merge=0.9988 (last merge round=34)
[S8] round=36 local utility u=0.031281 metrics={'f1_val': 0.9919561654725609, 'auprc': 0.9992946323127486, 'loss_val': 0.05825647771556753, 'psi': 0.9948915522086361}-{'f1_val': 0.986952513052197, 'auprc': 0.9973874031072582, 'loss_val': 0.08507404201809322, 'psi': 0.9911264690742215}
[S9] START round=36 head_norm_before_train=1.817557 cos_to_last_merge=0.7923 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.792
[S9] round=36 local utility u=0.008454 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.996677695091019, 'loss_val': 0.021799056154674184, 'psi': 0.9969328255436933}-{'f1_val': 0.9939393793306803, 'auprc': 0.9988472247853676, 'loss_val': 0.02623464317464735, 'psi': 0.9959025175125553}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=36 head_norm_before_train=1.549797 cos_to_last_merge=0.9879 (last merge round=29)
[S10] round=36 local utility u=0.002321 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9938859187238672, 'loss_val': 0.04279746933872948, 'psi': 0.9936951613087035}-{'f1_val': 0.9937871219080217, 'auprc': 0.9925591716826462, 'loss_val': 0.0447742223134235, 'psi': 0.9932959418178715}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=36 head_norm_before_train=1.941756 cos_to_last_merge=0.7628 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.763
[S11] round=36 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9968376783042754, 'loss_val': 0.03343551114876646, 'psi': 0.9964275561681574}-{'f1_val': 0.9961336749133093, 'auprc': 0.9979150716078957, 'loss_val': 0.02999433170460422, 'psi': 0.9968462335911439}
[S13] START round=36 head_norm_before_train=1.910704 (no previous merge yet)
[S13] round=36 local utility u=0.000000 metrics={'f1_val': 0.6739265964879928, 'auprc': 0.7825317364770867, 'loss_val': 1.0007839698945031, 'psi': 0.7173686524836304}-{'f1_val': 0.7279561842728497, 'auprc': 0.7882155300762645, 'loss_val': 0.8837565576234704, 'psi': 0.7520599225942156}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=36 head_norm_before_train=1.995613 (no previous merge yet)
[S14] round=36 local utility u=0.216493 metrics={'f1_val': 0.9980850197418996, 'auprc': 0.999228231494075, 'loss_val': 0.027288501186120664, 'psi': 0.9985423044427697}-{'f1_val': 0.9398044906760981, 'auprc': 0.9971825381352502, 'loss_val': 0.10445435101862563, 'psi': 0.962755709659759}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=36 head_norm_before_train=1.397219 cos_to_last_merge=0.9963 (last merge round=33)
[S15] round=36 local utility u=0.653314 metrics={'f1_val': 0.918835317241337, 'auprc': 0.9955166017025949, 'loss_val': 0.17753951174894622, 'psi': 0.9495078310258402}-{'f1_val': 0.7845805601869429, 'auprc': 0.9074437099793898, 'loss_val': 0.4144199926257401, 'psi': 0.8337258201039217}
[S16] START round=36 head_norm_before_train=1.437377 cos_to_last_merge=0.9885 (last merge round=33)
[S16] round=36 local utility u=0.082025 metrics={'f1_val': 0.9403121714404397, 'auprc': 0.9953160356022372, 'loss_val': 0.21126032432278982, 'psi': 0.9623137171051587}-{'f1_val': 0.9292562076866886, 'auprc': 0.9949195935133797, 'loss_val': 0.30778513454058787, 'psi': 0.955521562017365}
[S17] START round=36 head_norm_before_train=1.923944 cos_to_last_merge=0.8166 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.817
[S17] round=36 local utility u=0.000000 metrics={'f1_val': 0.6825764844669142, 'auprc': 0.8917648363262435, 'loss_val': 1.3211835099888938, 'psi': 0.7662518252106459}-{'f1_val': 0.7189207988385704, 'auprc': 0.9099462908911697, 'loss_val': 0.8584526317137525, 'psi': 0.7953309956596102}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S16] sending update (kind=head size=1807 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=37 head_norm_before_train=2.076983 cos_to_last_merge=0.9999 (last merge round=35)
[S2] round=37 local utility u=0.385497 metrics={'f1_val': 0.7166821855118339, 'auprc': 0.7391667051321784, 'loss_val': 0.794198720567644, 'psi': 0.7256759933599717}-{'f1_val': 0.6372055155210643, 'auprc': 0.7376191705733043, 'loss_val': 1.0836909798250929, 'psi': 0.6773709775419603}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] sending update (kind=head size=1795 to 1 peers)
[S3] START round=37 head_norm_before_train=1.511523 cos_to_last_merge=0.8886 (last merge round=29)
[S3] ⚠️ Model drifted since last merge! cos=0.889
[S3] round=37 local utility u=0.052499 metrics={'f1_val': 0.9978389274664787, 'auprc': 0.9987886914708515, 'loss_val': 0.06076497504335781, 'psi': 0.9982188330682279}-{'f1_val': 0.9882998237075507, 'auprc': 0.9984587987414458, 'loss_val': 0.10753953147425255, 'psi': 0.9923634137211087}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=37 head_norm_before_train=2.038826 cos_to_last_merge=0.9987 (last merge round=30)
[S4] round=37 local utility u=0.000000 metrics={'f1_val': 0.9410975451521012, 'auprc': 0.9477685573015762, 'loss_val': 0.2925360394892309, 'psi': 0.9437659500118912}-{'f1_val': 0.9429189541191088, 'auprc': 0.9525727203943353, 'loss_val': 0.29222961887456367, 'psi': 0.9467804606291994}
[S5] START round=37 head_norm_before_train=1.813523 (no previous merge yet)
[S5] round=37 local utility u=0.894899 metrics={'f1_val': 0.9967731002659072, 'auprc': 0.9978666304767928, 'loss_val': 0.08430753776250483, 'psi': 0.9972105123502615}-{'f1_val': 0.7191028586633352, 'auprc': 0.9916791444840252, 'loss_val': 0.18952191180925768, 'psi': 0.8281333729916112}
[S6] START round=37 head_norm_before_train=1.463716 cos_to_last_merge=0.9971 (last merge round=34)
[S6] round=37 local utility u=0.372176 metrics={'f1_val': 0.7251771428052238, 'auprc': 0.9532334824816335, 'loss_val': 0.6063937317117571, 'psi': 0.8163996786757877}-{'f1_val': 0.6239422199123336, 'auprc': 0.9398299627415744, 'loss_val': 0.7031254893905277, 'psi': 0.7502973170440299}
[S7] START round=37 head_norm_before_train=1.628807 cos_to_last_merge=0.9998 (last merge round=34)
[S7] round=37 local utility u=0.495106 metrics={'f1_val': 0.6206186996236835, 'auprc': 0.7936456271199958, 'loss_val': 0.668631535949511, 'psi': 0.6898294706222085}-{'f1_val': 0.5405974241846925, 'auprc': 0.7455533445647988, 'loss_val': 1.0344390091454547, 'psi': 0.622579792336735}
[S8] START round=37 head_norm_before_train=1.517580 cos_to_last_merge=0.9961 (last merge round=34)
[S8] round=37 local utility u=0.000000 metrics={'f1_val': 0.9907967929876987, 'auprc': 0.9878242966979217, 'loss_val': 0.06291665288106488, 'psi': 0.9896077944717879}-{'f1_val': 0.9919561654725609, 'auprc': 0.9992946323127486, 'loss_val': 0.05825647771556753, 'psi': 0.9948915522086361}
[S9] START round=37 head_norm_before_train=1.825322 cos_to_last_merge=0.7915 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.791
[S9] round=37 local utility u=0.000000 metrics={'f1_val': 0.9910040044536889, 'auprc': 0.9989629651404262, 'loss_val': 0.0321441336851057, 'psi': 0.9941875887283838}-{'f1_val': 0.9971029125121428, 'auprc': 0.996677695091019, 'loss_val': 0.021799056154674184, 'psi': 0.9969328255436933}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=37 head_norm_before_train=1.576883 cos_to_last_merge=0.9861 (last merge round=29)
[S10] round=37 local utility u=0.000000 metrics={'f1_val': 0.9937871219080217, 'auprc': 0.9921725519915092, 'loss_val': 0.04088368407979575, 'psi': 0.9931412939414167}-{'f1_val': 0.9935679896985945, 'auprc': 0.9938859187238672, 'loss_val': 0.04279746933872948, 'psi': 0.9936951613087035}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=37 head_norm_before_train=1.954982 cos_to_last_merge=0.7614 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.761
[S11] round=37 local utility u=0.000000 metrics={'f1_val': 0.9908845452422027, 'auprc': 0.9977095488191587, 'loss_val': 0.06284156428712508, 'psi': 0.9936145466729851}-{'f1_val': 0.9961541414107454, 'auprc': 0.9968376783042754, 'loss_val': 0.03343551114876646, 'psi': 0.9964275561681574}
[S13] START round=37 head_norm_before_train=1.921655 (no previous merge yet)
[S13] round=37 local utility u=0.231501 metrics={'f1_val': 0.7033719110995107, 'auprc': 0.7791163410451676, 'loss_val': 0.7042080554177459, 'psi': 0.7336696830777735}-{'f1_val': 0.6739265964879928, 'auprc': 0.7825317364770867, 'loss_val': 1.0007839698945031, 'psi': 0.7173686524836304}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=37 head_norm_before_train=2.004108 (no previous merge yet)
[S14] round=37 local utility u=0.000000 metrics={'f1_val': 0.9976483782674455, 'auprc': 0.999188979148951, 'loss_val': 0.027819459193746832, 'psi': 0.9982646186200477}-{'f1_val': 0.9980850197418996, 'auprc': 0.999228231494075, 'loss_val': 0.027288501186120664, 'psi': 0.9985423044427697}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=37 head_norm_before_train=1.441094 cos_to_last_merge=0.9936 (last merge round=33)
[S15] round=37 local utility u=0.034686 metrics={'f1_val': 0.9277964219252391, 'auprc': 0.9968210526080714, 'loss_val': 0.16584684013386733, 'psi': 0.9554062741983721}-{'f1_val': 0.918835317241337, 'auprc': 0.9955166017025949, 'loss_val': 0.17753951174894622, 'psi': 0.9495078310258402}
[S16] START round=37 head_norm_before_train=1.505440 cos_to_last_merge=0.9789 (last merge round=33)
[S16] round=37 local utility u=0.234109 metrics={'f1_val': 0.99237896144217, 'auprc': 0.9964026560269436, 'loss_val': 0.05870276296217816, 'psi': 0.9939884392760794}-{'f1_val': 0.9403121714404397, 'auprc': 0.9953160356022372, 'loss_val': 0.21126032432278982, 'psi': 0.9623137171051587}
[S17] START round=37 head_norm_before_train=1.935711 cos_to_last_merge=0.8156 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.816
[S17] round=37 local utility u=0.818850 metrics={'f1_val': 0.8066655469459822, 'auprc': 0.9338698736780436, 'loss_val': 0.5543337740868608, 'psi': 0.8575472776388069}-{'f1_val': 0.6825764844669142, 'auprc': 0.8917648363262435, 'loss_val': 1.3211835099888938, 'psi': 0.7662518252106459}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=38 head_norm_before_train=2.096546 cos_to_last_merge=0.9998 (last merge round=35)
[S2] round=38 local utility u=0.000000 metrics={'f1_val': 0.6998253466668142, 'auprc': 0.7570608860416976, 'loss_val': 0.8337448250904275, 'psi': 0.7227195624167676}-{'f1_val': 0.7166821855118339, 'auprc': 0.7391667051321784, 'loss_val': 0.794198720567644, 'psi': 0.7256759933599717}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=38 head_norm_before_train=1.544110 cos_to_last_merge=0.8820 (last merge round=29)
[S3] ⚠️ Model drifted since last merge! cos=0.882
[S3] round=38 local utility u=0.000000 metrics={'f1_val': 0.961498813606586, 'auprc': 0.9978440688649968, 'loss_val': 0.09018586771029469, 'psi': 0.9760369157099502}-{'f1_val': 0.9978389274664787, 'auprc': 0.9987886914708515, 'loss_val': 0.06076497504335781, 'psi': 0.9982188330682279}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=38 head_norm_before_train=2.045612 cos_to_last_merge=0.9985 (last merge round=30)
[S4] round=38 local utility u=0.000000 metrics={'f1_val': 0.9385143206835764, 'auprc': 0.945257988029922, 'loss_val': 0.2886546741169096, 'psi': 0.9412117876221147}-{'f1_val': 0.9410975451521012, 'auprc': 0.9477685573015762, 'loss_val': 0.2925360394892309, 'psi': 0.9437659500118912}
[S5] START round=38 head_norm_before_train=1.821407 (no previous merge yet)
[S5] round=38 local utility u=0.006256 metrics={'f1_val': 0.996625909096903, 'auprc': 0.9974904540625641, 'loss_val': 0.06978425816284299, 'psi': 0.9969717270831675}-{'f1_val': 0.9967731002659072, 'auprc': 0.9978666304767928, 'loss_val': 0.08430753776250483, 'psi': 0.9972105123502615}
[S6] START round=38 head_norm_before_train=1.519907 cos_to_last_merge=0.9941 (last merge round=34)
[S6] round=38 local utility u=0.000000 metrics={'f1_val': 0.6274072190242618, 'auprc': 0.9407202582268205, 'loss_val': 0.7758909581393514, 'psi': 0.7527324347052853}-{'f1_val': 0.7251771428052238, 'auprc': 0.9532334824816335, 'loss_val': 0.6063937317117571, 'psi': 0.8163996786757877}
[S7] START round=38 head_norm_before_train=1.635147 cos_to_last_merge=0.9996 (last merge round=34)
[S7] round=38 local utility u=0.000000 metrics={'f1_val': 0.6017027429977502, 'auprc': 0.7910820055977466, 'loss_val': 0.7189801983478032, 'psi': 0.6774544480377487}-{'f1_val': 0.6206186996236835, 'auprc': 0.7936456271199958, 'loss_val': 0.668631535949511, 'psi': 0.6898294706222085}
[S8] START round=38 head_norm_before_train=1.558092 cos_to_last_merge=0.9938 (last merge round=34)
[S8] round=38 local utility u=0.000000 metrics={'f1_val': 0.9842176914798477, 'auprc': 0.9974633431538079, 'loss_val': 0.06102275690292769, 'psi': 0.9895159521494318}-{'f1_val': 0.9907967929876987, 'auprc': 0.9878242966979217, 'loss_val': 0.06291665288106488, 'psi': 0.9896077944717879}
[S9] START round=38 head_norm_before_train=1.834660 cos_to_last_merge=0.7908 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.791
[S9] round=38 local utility u=0.020899 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9970848252134739, 'loss_val': 0.021305118212708172, 'psi': 0.9970956775926753}-{'f1_val': 0.9910040044536889, 'auprc': 0.9989629651404262, 'loss_val': 0.0321441336851057, 'psi': 0.9941875887283838}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=38 head_norm_before_train=1.599640 cos_to_last_merge=0.9848 (last merge round=29)
[S10] round=38 local utility u=0.000559 metrics={'f1_val': 0.9933073753875716, 'auprc': 0.9937912116190911, 'loss_val': 0.041743047428019465, 'psi': 0.9935009098801794}-{'f1_val': 0.9937871219080217, 'auprc': 0.9921725519915092, 'loss_val': 0.04088368407979575, 'psi': 0.9931412939414167}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] START round=38 head_norm_before_train=1.968209 cos_to_last_merge=0.7601 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.760
[S11] round=38 local utility u=0.029386 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9973700459828749, 'loss_val': 0.03466831019138289, 'psi': 0.9966405032395972}-{'f1_val': 0.9908845452422027, 'auprc': 0.9977095488191587, 'loss_val': 0.06284156428712508, 'psi': 0.9936145466729851}
[S13] START round=38 head_norm_before_train=1.932148 (no previous merge yet)
[S13] round=38 local utility u=0.000000 metrics={'f1_val': 0.7274287928721905, 'auprc': 0.7512197867512832, 'loss_val': 0.8568384816267411, 'psi': 0.7369451904238276}-{'f1_val': 0.7033719110995107, 'auprc': 0.7791163410451676, 'loss_val': 0.7042080554177459, 'psi': 0.7336696830777735}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=38 head_norm_before_train=2.013237 (no previous merge yet)
[S14] round=38 local utility u=0.000000 metrics={'f1_val': 0.9961605687915402, 'auprc': 0.9988228279432597, 'loss_val': 0.0358116940003639, 'psi': 0.997225472452228}-{'f1_val': 0.9976483782674455, 'auprc': 0.999188979148951, 'loss_val': 0.027819459193746832, 'psi': 0.9982646186200477}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=38 head_norm_before_train=1.476815 cos_to_last_merge=0.9912 (last merge round=33)
[S15] round=38 local utility u=0.000000 metrics={'f1_val': 0.9225477396476127, 'auprc': 0.996476987087499, 'loss_val': 0.17501140819082536, 'psi': 0.9521194386235672}-{'f1_val': 0.9277964219252391, 'auprc': 0.9968210526080714, 'loss_val': 0.16584684013386733, 'psi': 0.9554062741983721}
[S16] START round=38 head_norm_before_train=1.563251 cos_to_last_merge=0.9709 (last merge round=33)
[S16] round=38 local utility u=0.000000 metrics={'f1_val': 0.9740417492696054, 'auprc': 0.9961210735348677, 'loss_val': 0.09584782161137724, 'psi': 0.9828734789757103}-{'f1_val': 0.99237896144217, 'auprc': 0.9964026560269436, 'loss_val': 0.05870276296217816, 'psi': 0.9939884392760794}
[S17] START round=38 head_norm_before_train=1.935030 cos_to_last_merge=0.8160 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.816
[S17] round=38 local utility u=0.596093 metrics={'f1_val': 0.9370977794648901, 'auprc': 0.9747349745868785, 'loss_val': 0.26733729573086773, 'psi': 0.9521526575136855}-{'f1_val': 0.8066655469459822, 'auprc': 0.9338698736780436, 'loss_val': 0.5543337740868608, 'psi': 0.8575472776388069}
[S17] not sending this round → trigger blocked (psi=0.952)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.997)
[S2] START round=39 head_norm_before_train=2.115505 cos_to_last_merge=0.9995 (last merge round=35)
[S2] round=39 local utility u=0.001341 metrics={'f1_val': 0.709565043112073, 'auprc': 0.7393319283840531, 'loss_val': 0.836315077873606, 'psi': 0.7214717972208651}-{'f1_val': 0.6998253466668142, 'auprc': 0.7570608860416976, 'loss_val': 0.8337448250904275, 'psi': 0.7227195624167676}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] sending update (kind=head size=1794 to 1 peers)
[S2] r=40 psi=0.721 u=0.0013 p_local=0.0667 f1=0.710 auprc=0.739 bytes=32378
[S3] START round=39 head_norm_before_train=1.574689 cos_to_last_merge=0.8765 (last merge round=29)
[S3] ⚠️ Model drifted since last merge! cos=0.876
[S3] round=39 local utility u=0.000000 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.99797776753325, 'loss_val': 0.11826833456201845, 'psi': 0.9758361582529722}-{'f1_val': 0.961498813606586, 'auprc': 0.9978440688649968, 'loss_val': 0.09018586771029469, 'psi': 0.9760369157099502}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=40 psi=0.976 u=0.0000 p_local=0.0582 f1=0.961 auprc=0.998 bytes=37759
[S4] START round=39 head_norm_before_train=2.058355 cos_to_last_merge=0.9984 (last merge round=30)
[S4] round=39 local utility u=0.044293 metrics={'f1_val': 0.9426309077089634, 'auprc': 0.9665801546974164, 'loss_val': 0.28873446907953176, 'psi': 0.9522106065043446}-{'f1_val': 0.9385143206835764, 'auprc': 0.945257988029922, 'loss_val': 0.2886546741169096, 'psi': 0.9412117876221147}
[S5] START round=39 head_norm_before_train=1.826843 (no previous merge yet)
[S5] round=39 local utility u=0.000000 metrics={'f1_val': 0.9964794802860635, 'auprc': 0.9970639268562786, 'loss_val': 0.07214911455111822, 'psi': 0.9967132589141495}-{'f1_val': 0.996625909096903, 'auprc': 0.9974904540625641, 'loss_val': 0.06978425816284299, 'psi': 0.9969717270831675}
[S6] START round=39 head_norm_before_train=1.573660 cos_to_last_merge=0.9911 (last merge round=34)
[S6] round=39 local utility u=0.792495 metrics={'f1_val': 0.821835392043327, 'auprc': 0.9667911019961217, 'loss_val': 0.43568181775119746, 'psi': 0.8798176760244449}-{'f1_val': 0.6274072190242618, 'auprc': 0.9407202582268205, 'loss_val': 0.7758909581393514, 'psi': 0.7527324347052853}
[S7] START round=39 head_norm_before_train=1.640685 cos_to_last_merge=0.9995 (last merge round=34)
[S7] round=39 local utility u=0.000000 metrics={'f1_val': 0.571535433884684, 'auprc': 0.7828337029404793, 'loss_val': 0.8366217618618247, 'psi': 0.6560547415070022}-{'f1_val': 0.6017027429977502, 'auprc': 0.7910820055977466, 'loss_val': 0.7189801983478032, 'psi': 0.6774544480377487}
[S8] START round=39 head_norm_before_train=1.594648 cos_to_last_merge=0.9914 (last merge round=34)
[S8] round=39 local utility u=0.018262 metrics={'f1_val': 0.987796047040849, 'auprc': 0.9994915186030568, 'loss_val': 0.05205287801770194, 'psi': 0.9924742356657321}-{'f1_val': 0.9842176914798477, 'auprc': 0.9974633431538079, 'loss_val': 0.06102275690292769, 'psi': 0.9895159521494318}
[S9] START round=39 head_norm_before_train=1.844399 cos_to_last_merge=0.7901 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.790
[S9] round=39 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9959506132207487, 'loss_val': 0.021082542968552515, 'psi': 0.9966419927955852}-{'f1_val': 0.9971029125121428, 'auprc': 0.9970848252134739, 'loss_val': 0.021305118212708172, 'psi': 0.9970956775926753}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=40 psi=0.997 u=0.0000 p_local=0.0077 f1=0.997 auprc=0.996 bytes=41360
[S10] START round=39 head_norm_before_train=1.620221 cos_to_last_merge=0.9836 (last merge round=29)
[S10] round=39 local utility u=0.000833 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9929480608015128, 'loss_val': 0.039111223047807425, 'psi': 0.9933200181397618}-{'f1_val': 0.9933073753875716, 'auprc': 0.9937912116190911, 'loss_val': 0.041743047428019465, 'psi': 0.9935009098801794}
[S10] not sending this round → trigger blocked (psi=0.993)
[S10] r=40 psi=0.993 u=0.0008 p_local=0.0030 f1=0.994 auprc=0.993 bytes=44899
[S11] START round=39 head_norm_before_train=1.980089 cos_to_last_merge=0.7591 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.759
[S11] round=39 local utility u=0.002570 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.9974263527702316, 'loss_val': 0.028123957145249456, 'psi': 0.996505643829241}-{'f1_val': 0.9961541414107454, 'auprc': 0.9973700459828749, 'loss_val': 0.03466831019138289, 'psi': 0.9966405032395972}
[S13] START round=39 head_norm_before_train=1.946347 (no previous merge yet)
[S13] round=39 local utility u=0.000000 metrics={'f1_val': 0.7045637828499899, 'auprc': 0.7452658632030854, 'loss_val': 1.0912759545381558, 'psi': 0.7208446149912281}-{'f1_val': 0.7274287928721905, 'auprc': 0.7512197867512832, 'loss_val': 0.8568384816267411, 'psi': 0.7369451904238276}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=40 psi=0.721 u=0.0000 p_local=0.0942 f1=0.705 auprc=0.745 bytes=34174
[S14] START round=39 head_norm_before_train=2.023520 (no previous merge yet)
[S14] round=39 local utility u=0.008932 metrics={'f1_val': 0.9974055297193176, 'auprc': 0.9991715899947384, 'loss_val': 0.02646402062218478, 'psi': 0.9981119538294859}-{'f1_val': 0.9961605687915402, 'auprc': 0.9988228279432597, 'loss_val': 0.0358116940003639, 'psi': 0.997225472452228}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S14] r=40 psi=0.998 u=0.0089 p_local=0.0648 f1=0.997 auprc=0.999 bytes=50386
[S15] START round=39 head_norm_before_train=1.509972 cos_to_last_merge=0.9888 (last merge round=33)
[S15] round=39 local utility u=0.000000 metrics={'f1_val': 0.894065678633402, 'auprc': 0.9813251744380571, 'loss_val': 0.2726884290367557, 'psi': 0.9289694769552641}-{'f1_val': 0.9225477396476127, 'auprc': 0.996476987087499, 'loss_val': 0.17501140819082536, 'psi': 0.9521194386235672}
[S16] START round=39 head_norm_before_train=1.610440 cos_to_last_merge=0.9652 (last merge round=33)
[S16] round=39 local utility u=0.000000 metrics={'f1_val': 0.8353320902162757, 'auprc': 0.9827213434262122, 'loss_val': 0.9645268728885761, 'psi': 0.8942877915002503}-{'f1_val': 0.9740417492696054, 'auprc': 0.9961210735348677, 'loss_val': 0.09584782161137724, 'psi': 0.9828734789757103}
[S17] START round=39 head_norm_before_train=1.939170 cos_to_last_merge=0.8161 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.816
[S17] round=39 local utility u=0.000000 metrics={'f1_val': 0.6770103972605239, 'auprc': 0.8784582862784421, 'loss_val': 1.338213116215258, 'psi': 0.7575895528676913}-{'f1_val': 0.9370977794648901, 'auprc': 0.9747349745868785, 'loss_val': 0.26733729573086773, 'psi': 0.9521526575136855}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=40 psi=0.758 u=0.0000 p_local=0.3301 f1=0.677 auprc=0.878 bytes=34178
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[S11] not sending this round → trigger blocked (psi=0.997)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S4] r=40 psi=0.952 u=0.0443 p_local=0.0254 f1=0.943 auprc=0.967 bytes=39582
[S8] r=40 psi=0.992 u=0.0183 p_local=0.0222 f1=0.988 auprc=0.999 bytes=43193
[S5] r=40 psi=0.997 u=0.0000 p_local=0.1863 f1=0.996 auprc=0.997 bytes=43160
[S6] r=40 psi=0.880 u=0.7925 p_local=0.2843 f1=0.822 auprc=0.967 bytes=43145
[S15] r=40 psi=0.929 u=0.0000 p_local=0.1641 f1=0.894 auprc=0.981 bytes=41275
[S16] r=40 psi=0.894 u=0.0000 p_local=0.0680 f1=0.835 auprc=0.983 bytes=39573
[S11] r=40 psi=0.997 u=0.0026 p_local=0.0194 f1=0.996 auprc=0.997 bytes=48612
[S7] r=40 psi=0.656 u=0.0000 p_local=0.2438 f1=0.572 auprc=0.783 bytes=35964
[S2] START round=40 head_norm_before_train=2.133021 cos_to_last_merge=0.9993 (last merge round=35)
[S2] round=40 local utility u=0.000000 metrics={'f1_val': 0.6721401156259437, 'auprc': 0.7346398168938311, 'loss_val': 1.03076003334019, 'psi': 0.6971399961330986}-{'f1_val': 0.709565043112073, 'auprc': 0.7393319283840531, 'loss_val': 0.836315077873606, 'psi': 0.7214717972208651}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=40 head_norm_before_train=1.599595 cos_to_last_merge=0.8722 (last merge round=29)
[S3] ⚠️ Model drifted since last merge! cos=0.872
[S3] round=40 local utility u=0.146930 metrics={'f1_val': 0.9974271292865575, 'auprc': 0.9990380102222056, 'loss_val': 0.04570192011288354, 'psi': 0.9980714816608168}-{'f1_val': 0.9610750853994537, 'auprc': 0.99797776753325, 'loss_val': 0.11826833456201845, 'psi': 0.9758361582529722}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=40 head_norm_before_train=2.064410 cos_to_last_merge=0.9983 (last merge round=30)
[S4] round=40 local utility u=0.000000 metrics={'f1_val': 0.9391902385507671, 'auprc': 0.9704047159659677, 'loss_val': 0.2854354562529944, 'psi': 0.9516760295168474}-{'f1_val': 0.9426309077089634, 'auprc': 0.9665801546974164, 'loss_val': 0.28873446907953176, 'psi': 0.9522106065043446}
[S5] START round=40 head_norm_before_train=1.831477 (no previous merge yet)
[S5] round=40 local utility u=0.000021 metrics={'f1_val': 0.9967731002659072, 'auprc': 0.9978511977458152, 'loss_val': 0.07623021665321636, 'psi': 0.9972043392578704}-{'f1_val': 0.9964794802860635, 'auprc': 0.9970639268562786, 'loss_val': 0.07214911455111822, 'psi': 0.9967132589141495}
[S6] START round=40 head_norm_before_train=1.615923 cos_to_last_merge=0.9884 (last merge round=34)
[S6] round=40 local utility u=0.000000 metrics={'f1_val': 0.754468570102605, 'auprc': 0.971579470550788, 'loss_val': 0.5113581136505065, 'psi': 0.8413129302818783}-{'f1_val': 0.821835392043327, 'auprc': 0.9667911019961217, 'loss_val': 0.43568181775119746, 'psi': 0.8798176760244449}
[S7] START round=40 head_norm_before_train=1.648932 cos_to_last_merge=0.9992 (last merge round=34)
[S7] round=40 local utility u=0.151970 metrics={'f1_val': 0.5952922616771283, 'auprc': 0.7910289827542603, 'loss_val': 0.6998089494548159, 'psi': 0.6735869501079812}-{'f1_val': 0.571535433884684, 'auprc': 0.7828337029404793, 'loss_val': 0.8366217618618247, 'psi': 0.6560547415070022}
[S8] START round=40 head_norm_before_train=1.620683 cos_to_last_merge=0.9895 (last merge round=34)
[S8] round=40 local utility u=0.014210 metrics={'f1_val': 0.9945089764462749, 'auprc': 0.9912902252259406, 'loss_val': 0.03930694631015748, 'psi': 0.9932214759581411}-{'f1_val': 0.987796047040849, 'auprc': 0.9994915186030568, 'loss_val': 0.05205287801770194, 'psi': 0.9924742356657321}
[S9] START round=40 head_norm_before_train=1.853510 cos_to_last_merge=0.7895 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.790
[S9] round=40 local utility u=0.000000 metrics={'f1_val': 0.9901183584159563, 'auprc': 0.9995314844416272, 'loss_val': 0.037209658776649925, 'psi': 0.9938836088262246}-{'f1_val': 0.9971029125121428, 'auprc': 0.9959506132207487, 'loss_val': 0.021082542968552515, 'psi': 0.9966419927955852}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=40 head_norm_before_train=1.637587 cos_to_last_merge=0.9827 (last merge round=29)
[S10] round=40 local utility u=0.001430 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9938590263954749, 'loss_val': 0.038984868953502595, 'psi': 0.9936844043773466}-{'f1_val': 0.9935679896985945, 'auprc': 0.9929480608015128, 'loss_val': 0.039111223047807425, 'psi': 0.9933200181397618}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=40 head_norm_before_train=1.992577 cos_to_last_merge=0.7583 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.758
[S11] round=40 local utility u=0.003434 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9981906143445962, 'loss_val': 0.025122821978290605, 'psi': 0.9969687305842857}-{'f1_val': 0.9958918378685807, 'auprc': 0.9974263527702316, 'loss_val': 0.028123957145249456, 'psi': 0.996505643829241}
[S13] START round=40 head_norm_before_train=1.957406 (no previous merge yet)
[S13] round=40 local utility u=0.000000 metrics={'f1_val': 0.6252327508859933, 'auprc': 0.7548735621392223, 'loss_val': 1.04286318778529, 'psi': 0.6770890753872849}-{'f1_val': 0.7045637828499899, 'auprc': 0.7452658632030854, 'loss_val': 1.0912759545381558, 'psi': 0.7208446149912281}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=40 head_norm_before_train=2.036700 (no previous merge yet)
[S14] round=40 local utility u=0.000000 metrics={'f1_val': 0.9974055297193176, 'auprc': 0.9991942740968467, 'loss_val': 0.027299992395755014, 'psi': 0.9981210274703293}-{'f1_val': 0.9974055297193176, 'auprc': 0.9991715899947384, 'loss_val': 0.02646402062218478, 'psi': 0.9981119538294859}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=40 head_norm_before_train=1.541922 cos_to_last_merge=0.9866 (last merge round=33)
[S15] round=40 local utility u=0.000000 metrics={'f1_val': 0.878429890212737, 'auprc': 0.9952554872576049, 'loss_val': 0.29807395971735123, 'psi': 0.9251601290306841}-{'f1_val': 0.894065678633402, 'auprc': 0.9813251744380571, 'loss_val': 0.2726884290367557, 'psi': 0.9289694769552641}
[S16] START round=40 head_norm_before_train=1.646586 cos_to_last_merge=0.9616 (last merge round=33)
[S16] round=40 local utility u=0.111011 metrics={'f1_val': 0.8515958123122, 'auprc': 0.9855222848423638, 'loss_val': 0.8484897151184413, 'psi': 0.9051664013242656}-{'f1_val': 0.8353320902162757, 'auprc': 0.9827213434262122, 'loss_val': 0.9645268728885761, 'psi': 0.8942877915002503}
[S17] START round=40 head_norm_before_train=1.950846 cos_to_last_merge=0.8155 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.816
[S17] round=40 local utility u=1.000000 metrics={'f1_val': 0.9400841001899143, 'auprc': 0.9911084554033899, 'loss_val': 0.21502018295645225, 'psi': 0.9604938422753045}-{'f1_val': 0.6770103972605239, 'auprc': 0.8784582862784421, 'loss_val': 1.338213116215258, 'psi': 0.7575895528676913}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] sending update (kind=head size=1804 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S16] sending update (kind=head size=1808 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=41 head_norm_before_train=2.146453 cos_to_last_merge=0.9990 (last merge round=35)
[S2] round=41 local utility u=0.000083 metrics={'f1_val': 0.6747300223829256, 'auprc': 0.7297621882276062, 'loss_val': 1.0315006740690675, 'psi': 0.6967428887207978}-{'f1_val': 0.6721401156259437, 'auprc': 0.7346398168938311, 'loss_val': 1.03076003334019, 'psi': 0.6971399961330986}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] sending update (kind=head size=1795 to 1 peers)
[S3] START round=41 head_norm_before_train=1.619468 cos_to_last_merge=0.8689 (last merge round=29)
[S3] ⚠️ Model drifted since last merge! cos=0.869
[S3] round=41 local utility u=0.003439 metrics={'f1_val': 0.9973982357793907, 'auprc': 0.9987556436765515, 'loss_val': 0.03780278354536762, 'psi': 0.9979411989382551}-{'f1_val': 0.9974271292865575, 'auprc': 0.9990380102222056, 'loss_val': 0.04570192011288354, 'psi': 0.9980714816608168}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=41 head_norm_before_train=2.070682 cos_to_last_merge=0.9981 (last merge round=30)
[S4] round=41 local utility u=0.036676 metrics={'f1_val': 0.9522182715666794, 'auprc': 0.9713044082030982, 'loss_val': 0.292951510649573, 'psi': 0.9598527262212468}-{'f1_val': 0.9391902385507671, 'auprc': 0.9704047159659677, 'loss_val': 0.2854354562529944, 'psi': 0.9516760295168474}
[S5] START round=41 head_norm_before_train=1.836557 (no previous merge yet)
[S5] round=41 local utility u=0.004144 metrics={'f1_val': 0.996625909096903, 'auprc': 0.9974586905245938, 'loss_val': 0.06588218597601025, 'psi': 0.9969590216679793}-{'f1_val': 0.9967731002659072, 'auprc': 0.9978511977458152, 'loss_val': 0.07623021665321636, 'psi': 0.9972043392578704}
[S6] START round=41 head_norm_before_train=1.640290 cos_to_last_merge=0.9859 (last merge round=34)
[S6] round=41 local utility u=0.000000 metrics={'f1_val': 0.6266752270708127, 'auprc': 0.9424495549175281, 'loss_val': 0.8434048650665344, 'psi': 0.752984958209499}-{'f1_val': 0.754468570102605, 'auprc': 0.971579470550788, 'loss_val': 0.5113581136505065, 'psi': 0.8413129302818783}
[S7] START round=41 head_norm_before_train=1.655507 cos_to_last_merge=0.9990 (last merge round=34)
[S7] round=41 local utility u=0.155589 metrics={'f1_val': 0.6261368838409873, 'auprc': 0.794612595454803, 'loss_val': 0.5844490166523699, 'psi': 0.6935271684865136}-{'f1_val': 0.5952922616771283, 'auprc': 0.7910289827542603, 'loss_val': 0.6998089494548159, 'psi': 0.6735869501079812}
[S8] START round=41 head_norm_before_train=1.640273 cos_to_last_merge=0.9880 (last merge round=34)
[S8] round=41 local utility u=0.005807 metrics={'f1_val': 0.992384245702453, 'auprc': 0.9995054477259607, 'loss_val': 0.0395894320775171, 'psi': 0.995232726511856}-{'f1_val': 0.9945089764462749, 'auprc': 0.9912902252259406, 'loss_val': 0.03930694631015748, 'psi': 0.9932214759581411}
[S9] START round=41 head_norm_before_train=1.861640 cos_to_last_merge=0.7891 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.789
[S9] round=41 local utility u=0.019774 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.994369953338226, 'loss_val': 0.021621525826266665, 'psi': 0.9957634760941477}-{'f1_val': 0.9901183584159563, 'auprc': 0.9995314844416272, 'loss_val': 0.037209658776649925, 'psi': 0.9938836088262246}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=41 head_norm_before_train=1.654033 cos_to_last_merge=0.9818 (last merge round=29)
[S10] round=41 local utility u=0.000147 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9936889540538012, 'loss_val': 0.038181400036696594, 'psi': 0.9936163754406772}-{'f1_val': 0.9935679896985945, 'auprc': 0.9938590263954749, 'loss_val': 0.038984868953502595, 'psi': 0.9936844043773466}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=41 head_norm_before_train=2.005332 cos_to_last_merge=0.7574 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.757
[S11] round=41 local utility u=0.000000 metrics={'f1_val': 0.9951905258982896, 'auprc': 0.9985285375874293, 'loss_val': 0.02539751334849093, 'psi': 0.9965257305739454}-{'f1_val': 0.9961541414107454, 'auprc': 0.9981906143445962, 'loss_val': 0.025122821978290605, 'psi': 0.9969687305842857}
[S13] START round=41 head_norm_before_train=1.963665 (no previous merge yet)
[S13] round=41 local utility u=0.408356 metrics={'f1_val': 0.7285819461135562, 'auprc': 0.7587171314904649, 'loss_val': 0.8577766223652796, 'psi': 0.7406360202643197}-{'f1_val': 0.6252327508859933, 'auprc': 0.7548735621392223, 'loss_val': 1.04286318778529, 'psi': 0.6770890753872849}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=41 head_norm_before_train=2.049892 (no previous merge yet)
[S14] round=41 local utility u=0.000000 metrics={'f1_val': 0.9622344257187566, 'auprc': 0.9992333080008177, 'loss_val': 0.05127931856198254, 'psi': 0.9770339786315809}-{'f1_val': 0.9974055297193176, 'auprc': 0.9991942740968467, 'loss_val': 0.027299992395755014, 'psi': 0.9981210274703293}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=41 head_norm_before_train=1.569094 cos_to_last_merge=0.9847 (last merge round=33)
[S15] round=41 local utility u=0.046166 metrics={'f1_val': 0.8958280027795023, 'auprc': 0.9824653919213113, 'loss_val': 0.271759951254248, 'psi': 0.9304829584362259}-{'f1_val': 0.878429890212737, 'auprc': 0.9952554872576049, 'loss_val': 0.29807395971735123, 'psi': 0.9251601290306841}
[S16] START round=41 head_norm_before_train=1.674670 cos_to_last_merge=0.9591 (last merge round=33)
[S16] round=41 local utility u=0.849751 metrics={'f1_val': 0.9935043980999925, 'auprc': 0.9981331973426711, 'loss_val': 0.038271781449752525, 'psi': 0.9953559177970639}-{'f1_val': 0.8515958123122, 'auprc': 0.9855222848423638, 'loss_val': 0.8484897151184413, 'psi': 0.9051664013242656}
[S17] START round=41 head_norm_before_train=1.961152 cos_to_last_merge=0.8146 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.815
[S17] round=41 local utility u=0.000000 metrics={'f1_val': 0.7709281614358303, 'auprc': 0.9170013176907186, 'loss_val': 0.5499298849102786, 'psi': 0.8293574239377857}-{'f1_val': 0.9400841001899143, 'auprc': 0.9911084554033899, 'loss_val': 0.21502018295645225, 'psi': 0.9604938422753045}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S2] START round=42 head_norm_before_train=2.151692 cos_to_last_merge=0.9987 (last merge round=35)
[S2] round=42 local utility u=0.017739 metrics={'f1_val': 0.6905346351987709, 'auprc': 0.7224410433508914, 'loss_val': 1.0688861977517217, 'psi': 0.703297198459619}-{'f1_val': 0.6747300223829256, 'auprc': 0.7297621882276062, 'loss_val': 1.0315006740690675, 'psi': 0.6967428887207978}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=42 head_norm_before_train=1.639486 cos_to_last_merge=0.8659 (last merge round=29)
[S3] ⚠️ Model drifted since last merge! cos=0.866
[S3] round=42 local utility u=0.000000 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.9989114036210799, 'loss_val': 0.147034222149283, 'psi': 0.9762096126881042}-{'f1_val': 0.9973982357793907, 'auprc': 0.9987556436765515, 'loss_val': 0.03780278354536762, 'psi': 0.9979411989382551}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=42 head_norm_before_train=2.082256 cos_to_last_merge=0.9981 (last merge round=30)
[S4] round=42 local utility u=0.000000 metrics={'f1_val': 0.9427428133663858, 'auprc': 0.9602988312553877, 'loss_val': 0.29220529972416176, 'psi': 0.9497652205219865}-{'f1_val': 0.9522182715666794, 'auprc': 0.9713044082030982, 'loss_val': 0.292951510649573, 'psi': 0.9598527262212468}
[S5] START round=42 head_norm_before_train=1.842989 (no previous merge yet)
[S5] round=42 local utility u=0.004556 metrics={'f1_val': 0.996625909096903, 'auprc': 0.9977136760374139, 'loss_val': 0.057535510512161485, 'psi': 0.9970610158731074}-{'f1_val': 0.996625909096903, 'auprc': 0.9974586905245938, 'loss_val': 0.06588218597601025, 'psi': 0.9969590216679793}
[S6] START round=42 head_norm_before_train=1.669542 cos_to_last_merge=0.9833 (last merge round=34)
[S6] round=42 local utility u=1.000000 metrics={'f1_val': 0.8776610190923944, 'auprc': 0.9759790256988284, 'loss_val': 0.3037441123796538, 'psi': 0.916988221734968}-{'f1_val': 0.6266752270708127, 'auprc': 0.9424495549175281, 'loss_val': 0.8434048650665344, 'psi': 0.752984958209499}
[S7] START round=42 head_norm_before_train=1.662400 cos_to_last_merge=0.9987 (last merge round=34)
[S7] round=42 local utility u=0.000000 metrics={'f1_val': 0.6247289580469586, 'auprc': 0.7933450753194444, 'loss_val': 0.64308147533211, 'psi': 0.692175404955953}-{'f1_val': 0.6261368838409873, 'auprc': 0.794612595454803, 'loss_val': 0.5844490166523699, 'psi': 0.6935271684865136}
[S8] START round=42 head_norm_before_train=1.659839 cos_to_last_merge=0.9868 (last merge round=34)
[S8] round=42 local utility u=0.000000 metrics={'f1_val': 0.9921395546714198, 'auprc': 0.9995592000704665, 'loss_val': 0.03973402683724542, 'psi': 0.9951074128310384}-{'f1_val': 0.992384245702453, 'auprc': 0.9995054477259607, 'loss_val': 0.0395894320775171, 'psi': 0.995232726511856}
[S9] START round=42 head_norm_before_train=1.867865 cos_to_last_merge=0.7885 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.788
[S9] round=42 local utility u=0.000757 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9946180111766615, 'loss_val': 0.020851168471315185, 'psi': 0.9958626992295219}-{'f1_val': 0.9966924912647621, 'auprc': 0.994369953338226, 'loss_val': 0.021621525826266665, 'psi': 0.9957634760941477}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=42 head_norm_before_train=1.670086 cos_to_last_merge=0.9808 (last merge round=29)
[S10] round=42 local utility u=0.000459 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9938970510916505, 'loss_val': 0.037887840379234754, 'psi': 0.9936996142558169}-{'f1_val': 0.9935679896985945, 'auprc': 0.9936889540538012, 'loss_val': 0.038181400036696594, 'psi': 0.9936163754406772}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=42 head_norm_before_train=2.018448 cos_to_last_merge=0.7564 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.756
[S11] round=42 local utility u=0.002331 metrics={'f1_val': 0.9956519930682886, 'auprc': 0.998567687684129, 'loss_val': 0.023622116714253363, 'psi': 0.9968182709146247}-{'f1_val': 0.9951905258982896, 'auprc': 0.9985285375874293, 'loss_val': 0.02539751334849093, 'psi': 0.9965257305739454}
[S13] START round=42 head_norm_before_train=1.967675 (no previous merge yet)
[S13] round=42 local utility u=0.000000 metrics={'f1_val': 0.7208470190088784, 'auprc': 0.7546304321486079, 'loss_val': 0.8854799687996894, 'psi': 0.7343603842647702}-{'f1_val': 0.7285819461135562, 'auprc': 0.7587171314904649, 'loss_val': 0.8577766223652796, 'psi': 0.7406360202643197}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=42 head_norm_before_train=2.056557 (no previous merge yet)
[S14] round=42 local utility u=0.053289 metrics={'f1_val': 0.9789050063361895, 'auprc': 0.9992336848416854, 'loss_val': 0.044726641745182205, 'psi': 0.9870364777383879}-{'f1_val': 0.9622344257187566, 'auprc': 0.9992333080008177, 'loss_val': 0.05127931856198254, 'psi': 0.9770339786315809}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=42 head_norm_before_train=1.591457 cos_to_last_merge=0.9831 (last merge round=33)
[S15] round=42 local utility u=0.000000 metrics={'f1_val': 0.8200375005172515, 'auprc': 0.9101547942881026, 'loss_val': 0.4061039467225648, 'psi': 0.856084418025592}-{'f1_val': 0.8958280027795023, 'auprc': 0.9824653919213113, 'loss_val': 0.271759951254248, 'psi': 0.9304829584362259}
[S16] START round=42 head_norm_before_train=1.698239 cos_to_last_merge=0.9570 (last merge round=33)
[S16] round=42 local utility u=0.001937 metrics={'f1_val': 0.993727015440479, 'auprc': 0.9982264128752718, 'loss_val': 0.03601293044267493, 'psi': 0.9955267744143962}-{'f1_val': 0.9935043980999925, 'auprc': 0.9981331973426711, 'loss_val': 0.038271781449752525, 'psi': 0.9953559177970639}
[S17] START round=42 head_norm_before_train=1.968456 cos_to_last_merge=0.8138 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.814
[S17] round=42 local utility u=0.445415 metrics={'f1_val': 0.8839417000192804, 'auprc': 0.9415156182287641, 'loss_val': 0.4107230738998904, 'psi': 0.9069712673030739}-{'f1_val': 0.7709281614358303, 'auprc': 0.9170013176907186, 'loss_val': 0.5499298849102786, 'psi': 0.8293574239377857}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S17] sending update (kind=head size=1791 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=43 head_norm_before_train=2.154335 cos_to_last_merge=0.9982 (last merge round=35)
[S2] round=43 local utility u=0.078246 metrics={'f1_val': 0.7048536080233555, 'auprc': 0.7234045545792342, 'loss_val': 1.0011979902125907, 'psi': 0.7122739866457071}-{'f1_val': 0.6905346351987709, 'auprc': 0.7224410433508914, 'loss_val': 1.0688861977517217, 'psi': 0.703297198459619}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=43 head_norm_before_train=1.658404 cos_to_last_merge=0.8632 (last merge round=29)
[S3] ⚠️ Model drifted since last merge! cos=0.863
[S3] round=43 local utility u=0.117592 metrics={'f1_val': 0.983867992857389, 'auprc': 0.9993213714713155, 'loss_val': 0.049837656684603805, 'psi': 0.9900493443029597}-{'f1_val': 0.9610750853994537, 'auprc': 0.9989114036210799, 'loss_val': 0.147034222149283, 'psi': 0.9762096126881042}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=43 head_norm_before_train=2.093977 cos_to_last_merge=0.9980 (last merge round=30)
[S4] round=43 local utility u=0.000007 metrics={'f1_val': 0.9419210435399892, 'auprc': 0.9621166267976886, 'loss_val': 0.2927136893257254, 'psi': 0.949999276843069}-{'f1_val': 0.9427428133663858, 'auprc': 0.9602988312553877, 'loss_val': 0.29220529972416176, 'psi': 0.9497652205219865}
[S5] START round=43 head_norm_before_train=1.856071 (no previous merge yet)
[S5] round=43 local utility u=0.002099 metrics={'f1_val': 0.996625909096903, 'auprc': 0.9978530264338992, 'loss_val': 0.0537554771400179, 'psi': 0.9971167560317015}-{'f1_val': 0.996625909096903, 'auprc': 0.9977136760374139, 'loss_val': 0.057535510512161485, 'psi': 0.9970610158731074}
[S6] START round=43 head_norm_before_train=1.687753 cos_to_last_merge=0.9816 (last merge round=34)
[S6] round=43 local utility u=0.000000 metrics={'f1_val': 0.777396348828702, 'auprc': 0.9611942588763085, 'loss_val': 0.4946504813118447, 'psi': 0.8509155128477446}-{'f1_val': 0.8776610190923944, 'auprc': 0.9759790256988284, 'loss_val': 0.3037441123796538, 'psi': 0.916988221734968}
[S7] START round=43 head_norm_before_train=1.670345 cos_to_last_merge=0.9983 (last merge round=34)
[S7] round=43 local utility u=0.057002 metrics={'f1_val': 0.6345916376033273, 'auprc': 0.7981455266689481, 'loss_val': 0.6026550116176391, 'psi': 0.7000131932295757}-{'f1_val': 0.6247289580469586, 'auprc': 0.7933450753194444, 'loss_val': 0.64308147533211, 'psi': 0.692175404955953}
[S8] START round=43 head_norm_before_train=1.677123 cos_to_last_merge=0.9855 (last merge round=34)
[S8] round=43 local utility u=0.003873 metrics={'f1_val': 0.9935879766866298, 'auprc': 0.9977937019606373, 'loss_val': 0.035382777763127954, 'psi': 0.9952702667962328}-{'f1_val': 0.9921395546714198, 'auprc': 0.9995592000704665, 'loss_val': 0.03973402683724542, 'psi': 0.9951074128310384}
[S9] START round=43 head_norm_before_train=1.874065 cos_to_last_merge=0.7884 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.788
[S9] round=43 local utility u=0.000000 metrics={'f1_val': 0.9763315374145405, 'auprc': 0.9997627727985126, 'loss_val': 0.08300759115270735, 'psi': 0.9857040315681292}-{'f1_val': 0.9966924912647621, 'auprc': 0.9946180111766615, 'loss_val': 0.020851168471315185, 'psi': 0.9958626992295219}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=43 head_norm_before_train=1.686039 cos_to_last_merge=0.9798 (last merge round=29)
[S10] round=43 local utility u=0.000563 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9939552110428489, 'loss_val': 0.03693658668576271, 'psi': 0.9937228782362962}-{'f1_val': 0.9935679896985945, 'auprc': 0.9938970510916505, 'loss_val': 0.037887840379234754, 'psi': 0.9936996142558169}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=43 head_norm_before_train=2.031425 cos_to_last_merge=0.7556 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.756
[S11] round=43 local utility u=0.000000 metrics={'f1_val': 0.9944691022269249, 'auprc': 0.9985758731997796, 'loss_val': 0.026066414852434192, 'psi': 0.9961118106160667}-{'f1_val': 0.9956519930682886, 'auprc': 0.998567687684129, 'loss_val': 0.023622116714253363, 'psi': 0.9968182709146247}
[S13] START round=43 head_norm_before_train=1.969646 (no previous merge yet)
[S13] round=43 local utility u=0.000000 metrics={'f1_val': 0.7004497124409065, 'auprc': 0.7436764112786822, 'loss_val': 0.9485437366163348, 'psi': 0.7177403919760168}-{'f1_val': 0.7208470190088784, 'auprc': 0.7546304321486079, 'loss_val': 0.8854799687996894, 'psi': 0.7343603842647702}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=43 head_norm_before_train=2.064286 (no previous merge yet)
[S14] round=43 local utility u=0.068991 metrics={'f1_val': 0.9980646079025537, 'auprc': 0.9992261129939842, 'loss_val': 0.021679587193632895, 'psi': 0.9985292099391259}-{'f1_val': 0.9789050063361895, 'auprc': 0.9992336848416854, 'loss_val': 0.044726641745182205, 'psi': 0.9870364777383879}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=43 head_norm_before_train=1.612691 cos_to_last_merge=0.9815 (last merge round=33)
[S15] round=43 local utility u=0.290934 metrics={'f1_val': 0.8746451232455267, 'auprc': 0.9691721196294888, 'loss_val': 0.3289338666303744, 'psi': 0.9124559217991115}-{'f1_val': 0.8200375005172515, 'auprc': 0.9101547942881026, 'loss_val': 0.4061039467225648, 'psi': 0.856084418025592}
[S16] START round=43 head_norm_before_train=1.716844 cos_to_last_merge=0.9558 (last merge round=33)
[S16] round=43 local utility u=0.000000 metrics={'f1_val': 0.9276919763963096, 'auprc': 0.9903041068538674, 'loss_val': 0.39453746136412216, 'psi': 0.9527368285793327}-{'f1_val': 0.993727015440479, 'auprc': 0.9982264128752718, 'loss_val': 0.03601293044267493, 'psi': 0.9955267744143962}
[S17] START round=43 head_norm_before_train=1.975386 cos_to_last_merge=0.8137 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.814
[S17] round=43 local utility u=0.089616 metrics={'f1_val': 0.8975879816634281, 'auprc': 0.9704162573752719, 'loss_val': 0.4000716574218283, 'psi': 0.9267192919481656}-{'f1_val': 0.8839417000192804, 'auprc': 0.9415156182287641, 'loss_val': 0.4107230738998904, 'psi': 0.9069712673030739}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S7]  timeout peer S15
[S6]  timeout peer S8
[S15]  timeout peer S10
[S4]  timeout peer S2
[S8]  timeout peer S3
[S16]  timeout peer S6
[S11]  timeout peer S7
[S5]  timeout peer S9
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] sending update (kind=head size=1805 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] sending update (kind=head size=1793 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=44 head_norm_before_train=2.161956 cos_to_last_merge=0.9979 (last merge round=35)
[S2] round=44 local utility u=0.000000 metrics={'f1_val': 0.671542536677899, 'auprc': 0.729697020724048, 'loss_val': 1.100865592183972, 'psi': 0.6948043302963586}-{'f1_val': 0.7048536080233555, 'auprc': 0.7234045545792342, 'loss_val': 1.0011979902125907, 'psi': 0.7122739866457071}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=44 head_norm_before_train=1.675435 cos_to_last_merge=0.8608 (last merge round=29)
[S3] ⚠️ Model drifted since last merge! cos=0.861
[S3] round=44 local utility u=0.049602 metrics={'f1_val': 0.9973982357793907, 'auprc': 0.9988066427034261, 'loss_val': 0.030271049383526302, 'psi': 0.9979615985490049}-{'f1_val': 0.983867992857389, 'auprc': 0.9993213714713155, 'loss_val': 0.049837656684603805, 'psi': 0.9900493443029597}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] sending update (kind=head size=1803 to 1 peers)
[S4] START round=44 head_norm_before_train=2.098470 cos_to_last_merge=0.9975 (last merge round=30)
[S4] round=44 local utility u=0.000000 metrics={'f1_val': 0.9419366486305075, 'auprc': 0.9623253623044272, 'loss_val': 0.29440051770510334, 'psi': 0.9500921341000754}-{'f1_val': 0.9419210435399892, 'auprc': 0.9621166267976886, 'loss_val': 0.2927136893257254, 'psi': 0.949999276843069}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=44 head_norm_before_train=1.867855 (no previous merge yet)
[S5] round=44 local utility u=0.001891 metrics={'f1_val': 0.996625909096903, 'auprc': 0.9978467081921878, 'loss_val': 0.04995441114265243, 'psi': 0.997114228735017}-{'f1_val': 0.996625909096903, 'auprc': 0.9978530264338992, 'loss_val': 0.0537554771400179, 'psi': 0.9971167560317015}
[S5] not sending this round → trigger blocked (psi=0.997)
[S6] START round=44 head_norm_before_train=1.705549 cos_to_last_merge=0.9802 (last merge round=34)
[S6] round=44 local utility u=0.000000 metrics={'f1_val': 0.7135950531252283, 'auprc': 0.9729805428081048, 'loss_val': 0.4869718809853305, 'psi': 0.8173492489983789}-{'f1_val': 0.777396348828702, 'auprc': 0.9611942588763085, 'loss_val': 0.4946504813118447, 'psi': 0.8509155128477446}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=44 head_norm_before_train=1.678683 cos_to_last_merge=0.9979 (last merge round=34)
[S7] round=44 local utility u=0.000000 metrics={'f1_val': 0.6219593265569522, 'auprc': 0.7990915977961829, 'loss_val': 0.6929466408010664, 'psi': 0.6928122350526444}-{'f1_val': 0.6345916376033273, 'auprc': 0.7981455266689481, 'loss_val': 0.6026550116176391, 'psi': 0.7000131932295757}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=44 head_norm_before_train=1.694473 cos_to_last_merge=0.9841 (last merge round=34)
[S8] round=44 local utility u=0.001399 metrics={'f1_val': 0.9931022471969293, 'auprc': 0.9993800443874279, 'loss_val': 0.03443028163133103, 'psi': 0.9956133660731287}-{'f1_val': 0.9935879766866298, 'auprc': 0.9977937019606373, 'loss_val': 0.035382777763127954, 'psi': 0.9952702667962328}
[S8] not sending this round → trigger blocked (psi=0.996)
[S9] START round=44 head_norm_before_train=1.880573 cos_to_last_merge=0.7883 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.788
[S9] round=44 local utility u=0.087156 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9972343625925449, 'loss_val': 0.020747420551635243, 'psi': 0.9966563624752617}-{'f1_val': 0.9763315374145405, 'auprc': 0.9997627727985126, 'loss_val': 0.08300759115270735, 'psi': 0.9857040315681292}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=44 head_norm_before_train=1.701584 cos_to_last_merge=0.9787 (last merge round=29)
[S10] round=44 local utility u=0.001038 metrics={'f1_val': 0.9937871219080217, 'auprc': 0.9937296405908018, 'loss_val': 0.0354978672105072, 'psi': 0.9937641293811338}-{'f1_val': 0.9935679896985945, 'auprc': 0.9939552110428489, 'loss_val': 0.03693658668576271, 'psi': 0.9937228782362962}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] START round=44 head_norm_before_train=2.043035 cos_to_last_merge=0.7546 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.755
[S11] round=44 local utility u=0.004678 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9980574468186523, 'loss_val': 0.02514259371923381, 'psi': 0.9969031836754465}-{'f1_val': 0.9944691022269249, 'auprc': 0.9985758731997796, 'loss_val': 0.026066414852434192, 'psi': 0.9961118106160667}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=44 head_norm_before_train=1.973741 (no previous merge yet)
[S13] round=44 local utility u=0.000000 metrics={'f1_val': 0.63617868909968, 'auprc': 0.744084984771091, 'loss_val': 0.9319337781311671, 'psi': 0.6793412073682444}-{'f1_val': 0.7004497124409065, 'auprc': 0.7436764112786822, 'loss_val': 0.9485437366163348, 'psi': 0.7177403919760168}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=44 head_norm_before_train=2.073979 (no previous merge yet)
[S14] round=44 local utility u=0.000701 metrics={'f1_val': 0.9980646079025537, 'auprc': 0.9992300790942653, 'loss_val': 0.020289804100172854, 'psi': 0.9985307963792384}-{'f1_val': 0.9980646079025537, 'auprc': 0.9992261129939842, 'loss_val': 0.021679587193632895, 'psi': 0.9985292099391259}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=44 head_norm_before_train=1.632262 cos_to_last_merge=0.9801 (last merge round=33)
[S15] round=44 local utility u=0.000000 metrics={'f1_val': 0.817343285676056, 'auprc': 0.9107131274455272, 'loss_val': 0.4272405803212618, 'psi': 0.8546912223838445}-{'f1_val': 0.8746451232455267, 'auprc': 0.9691721196294888, 'loss_val': 0.3289338666303744, 'psi': 0.9124559217991115}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=44 head_norm_before_train=1.731161 cos_to_last_merge=0.9549 (last merge round=33)
[S16] round=44 local utility u=0.000000 metrics={'f1_val': 0.8673418045183034, 'auprc': 0.9892749877447355, 'loss_val': 0.780193829027878, 'psi': 0.9161150778088762}-{'f1_val': 0.9276919763963096, 'auprc': 0.9903041068538674, 'loss_val': 0.39453746136412216, 'psi': 0.9527368285793327}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=44 head_norm_before_train=1.984654 cos_to_last_merge=0.8134 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.813
[S17] round=44 local utility u=0.000000 metrics={'f1_val': 0.8831270422364805, 'auprc': 0.9342665917337927, 'loss_val': 0.5112471705653575, 'psi': 0.9035828620354054}-{'f1_val': 0.8975879816634281, 'auprc': 0.9704162573752719, 'loss_val': 0.4000716574218283, 'psi': 0.9267192919481656}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=45 head_norm_before_train=2.172104 cos_to_last_merge=0.9978 (last merge round=35)
[S2] round=45 local utility u=0.000000 metrics={'f1_val': 0.6634740031021006, 'auprc': 0.7334069542095563, 'loss_val': 1.179415657767392, 'psi': 0.6914471835450828}-{'f1_val': 0.671542536677899, 'auprc': 0.729697020724048, 'loss_val': 1.100865592183972, 'psi': 0.6948043302963586}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=45 head_norm_before_train=1.691861 cos_to_last_merge=0.8585 (last merge round=29)
[S3] ⚠️ Model drifted since last merge! cos=0.859
[S3] round=45 local utility u=0.000000 metrics={'f1_val': 0.9773331375862475, 'auprc': 0.9995007593403884, 'loss_val': 0.06185236125950046, 'psi': 0.9862001862879038}-{'f1_val': 0.9973982357793907, 'auprc': 0.9988066427034261, 'loss_val': 0.030271049383526302, 'psi': 0.9979615985490049}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=45 head_norm_before_train=2.103983 cos_to_last_merge=0.9970 (last merge round=30)
[S4] round=45 local utility u=0.038786 metrics={'f1_val': 0.9482521558777263, 'auprc': 0.9758891714518003, 'loss_val': 0.29541336772247834, 'psi': 0.9593069621073559}-{'f1_val': 0.9419366486305075, 'auprc': 0.9623253623044272, 'loss_val': 0.29440051770510334, 'psi': 0.9500921341000754}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] sending update (kind=head size=1793 to 1 peers)
[S5] START round=45 head_norm_before_train=1.878967 (no previous merge yet)
[S5] round=45 local utility u=0.000000 metrics={'f1_val': 0.9950781168959197, 'auprc': 0.9915217826260558, 'loss_val': 0.09417867619397918, 'psi': 0.9936555831879742}-{'f1_val': 0.996625909096903, 'auprc': 0.9978467081921878, 'loss_val': 0.04995441114265243, 'psi': 0.997114228735017}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=45 head_norm_before_train=1.721961 cos_to_last_merge=0.9784 (last merge round=34)
[S6] round=45 local utility u=0.000000 metrics={'f1_val': 0.6583585263609383, 'auprc': 0.9264651737500531, 'loss_val': 0.7846419757609541, 'psi': 0.7656011853165843}-{'f1_val': 0.7135950531252283, 'auprc': 0.9729805428081048, 'loss_val': 0.4869718809853305, 'psi': 0.8173492489983789}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=45 head_norm_before_train=1.689425 cos_to_last_merge=0.9974 (last merge round=34)
[S7] round=45 local utility u=0.000000 metrics={'f1_val': 0.620767125960513, 'auprc': 0.7963686580166676, 'loss_val': 0.7066409157179037, 'psi': 0.6910077387829748}-{'f1_val': 0.6219593265569522, 'auprc': 0.7990915977961829, 'loss_val': 0.6929466408010664, 'psi': 0.6928122350526444}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=45 head_norm_before_train=1.712544 cos_to_last_merge=0.9828 (last merge round=34)
[S8] round=45 local utility u=0.000000 metrics={'f1_val': 0.9943863538992247, 'auprc': 0.9896337002065144, 'loss_val': 0.03282586706298473, 'psi': 0.9924852924221406}-{'f1_val': 0.9931022471969293, 'auprc': 0.9993800443874279, 'loss_val': 0.03443028163133103, 'psi': 0.9956133660731287}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=45 head_norm_before_train=1.886685 cos_to_last_merge=0.7878 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.788
[S9] round=45 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9944812720664284, 'loss_val': 0.019699086683722798, 'psi': 0.996054256333857}-{'f1_val': 0.9962710290637395, 'auprc': 0.9972343625925449, 'loss_val': 0.020747420551635243, 'psi': 0.9966563624752617}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=45 head_norm_before_train=1.714404 cos_to_last_merge=0.9779 (last merge round=29)
[S10] round=45 local utility u=0.000000 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9939419356098864, 'loss_val': 0.0359785472521949, 'psi': 0.9937175680631112}-{'f1_val': 0.9937871219080217, 'auprc': 0.9937296405908018, 'loss_val': 0.0354978672105072, 'psi': 0.9937641293811338}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=45 head_norm_before_train=2.051930 cos_to_last_merge=0.7536 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.754
[S11] round=45 local utility u=0.000000 metrics={'f1_val': 0.858927152717077, 'auprc': 0.9970716294039487, 'loss_val': 0.15444495109020615, 'psi': 0.9141849433918257}-{'f1_val': 0.9961336749133093, 'auprc': 0.9980574468186523, 'loss_val': 0.02514259371923381, 'psi': 0.9969031836754465}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=45 head_norm_before_train=1.980878 (no previous merge yet)
[S13] round=45 local utility u=0.000000 metrics={'f1_val': 0.6262223212833059, 'auprc': 0.7428207705810176, 'loss_val': 1.091074518004436, 'psi': 0.6728617010023905}-{'f1_val': 0.63617868909968, 'auprc': 0.744084984771091, 'loss_val': 0.9319337781311671, 'psi': 0.6793412073682444}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=45 head_norm_before_train=2.085767 (no previous merge yet)
[S14] round=45 local utility u=0.000000 metrics={'f1_val': 0.9978217593544257, 'auprc': 0.9991356426493809, 'loss_val': 0.019549713022444213, 'psi': 0.9983473126724078}-{'f1_val': 0.9980646079025537, 'auprc': 0.9992300790942653, 'loss_val': 0.020289804100172854, 'psi': 0.9985307963792384}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=45 head_norm_before_train=1.650376 cos_to_last_merge=0.9789 (last merge round=33)
[S15] round=45 local utility u=0.197668 metrics={'f1_val': 0.8534794399289702, 'auprc': 0.9470956376585, 'loss_val': 0.35786827133699023, 'psi': 0.8909259190207821}-{'f1_val': 0.817343285676056, 'auprc': 0.9107131274455272, 'loss_val': 0.4272405803212618, 'psi': 0.8546912223838445}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=45 head_norm_before_train=1.745263 cos_to_last_merge=0.9538 (last merge round=33)
[S16] round=45 local utility u=0.000000 metrics={'f1_val': 0.8444689094417347, 'auprc': 0.9019906880482355, 'loss_val': 1.0298228031989207, 'psi': 0.8674776208843349}-{'f1_val': 0.8673418045183034, 'auprc': 0.9892749877447355, 'loss_val': 0.780193829027878, 'psi': 0.9161150778088762}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=45 head_norm_before_train=1.996221 cos_to_last_merge=0.8126 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.813
[S17] round=45 local utility u=0.332003 metrics={'f1_val': 0.933386876653611, 'auprc': 0.9827812976813409, 'loss_val': 0.294344630137822, 'psi': 0.953144645064703}-{'f1_val': 0.8831270422364805, 'auprc': 0.9342665917337927, 'loss_val': 0.5112471705653575, 'psi': 0.9035828620354054}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] START round=46 head_norm_before_train=2.182583 cos_to_last_merge=0.9977 (last merge round=35)
[S2] round=46 local utility u=0.192654 metrics={'f1_val': 0.703893233855595, 'auprc': 0.7273300232114991, 'loss_val': 1.0183919508952604, 'psi': 0.7132679495979566}-{'f1_val': 0.6634740031021006, 'auprc': 0.7334069542095563, 'loss_val': 1.179415657767392, 'psi': 0.6914471835450828}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[S3] START round=46 head_norm_before_train=1.707436 cos_to_last_merge=0.8565 (last merge round=29)
[S3] ⚠️ Model drifted since last merge! cos=0.856
[S3] round=46 local utility u=0.025282 metrics={'f1_val': 0.9838348379227521, 'auprc': 0.9983199255431762, 'loss_val': 0.04675675178084163, 'psi': 0.9896288729709217}-{'f1_val': 0.9773331375862475, 'auprc': 0.9995007593403884, 'loss_val': 0.06185236125950046, 'psi': 0.9862001862879038}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=46 head_norm_before_train=2.110184 cos_to_last_merge=0.9963 (last merge round=30)
[S4] round=46 local utility u=0.001106 metrics={'f1_val': 0.9435153775037308, 'auprc': 0.9843817951816831, 'loss_val': 0.2902578532294553, 'psi': 0.9598619445749117}-{'f1_val': 0.9482521558777263, 'auprc': 0.9758891714518003, 'loss_val': 0.29541336772247834, 'psi': 0.9593069621073559}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=46 head_norm_before_train=1.885532 (no previous merge yet)
[S5] round=46 local utility u=0.035058 metrics={'f1_val': 0.9964794802860635, 'auprc': 0.9966452627654424, 'loss_val': 0.04784050996095911, 'psi': 0.996545793277815}-{'f1_val': 0.9950781168959197, 'auprc': 0.9915217826260558, 'loss_val': 0.09417867619397918, 'psi': 0.9936555831879742}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] START round=46 head_norm_before_train=1.740093 cos_to_last_merge=0.9774 (last merge round=34)
[S6] round=46 local utility u=0.000000 metrics={'f1_val': 0.510452007859515, 'auprc': 0.8425145692525486, 'loss_val': 0.8939056334617528, 'psi': 0.6432770324167285}-{'f1_val': 0.6583585263609383, 'auprc': 0.9264651737500531, 'loss_val': 0.7846419757609541, 'psi': 0.7656011853165843}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=46 head_norm_before_train=1.697525 cos_to_last_merge=0.9970 (last merge round=34)
[S7] round=46 local utility u=0.355669 metrics={'f1_val': 0.6703111953515256, 'auprc': 0.8259687845817925, 'loss_val': 0.3813670253051115, 'psi': 0.7325742310436324}-{'f1_val': 0.620767125960513, 'auprc': 0.7963686580166676, 'loss_val': 0.7066409157179037, 'psi': 0.6910077387829748}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=46 head_norm_before_train=1.727503 cos_to_last_merge=0.9816 (last merge round=34)
[S8] round=46 local utility u=0.000000 metrics={'f1_val': 0.9917768254438665, 'auprc': 0.9994372952925324, 'loss_val': 0.04661496266656822, 'psi': 0.9948410133833328}-{'f1_val': 0.9943863538992247, 'auprc': 0.9896337002065144, 'loss_val': 0.03282586706298473, 'psi': 0.9924852924221406}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=46 head_norm_before_train=1.895001 cos_to_last_merge=0.7872 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.787
[S9] round=46 local utility u=0.003366 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.999557424417166, 'loss_val': 0.020538878300025896, 'psi': 0.9973190007853776}-{'f1_val': 0.9971029125121428, 'auprc': 0.9944812720664284, 'loss_val': 0.019699086683722798, 'psi': 0.996054256333857}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=46 head_norm_before_train=1.727344 cos_to_last_merge=0.9771 (last merge round=29)
[S10] round=46 local utility u=0.000000 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.9939054172808577, 'loss_val': 0.035976697162764415, 'psi': 0.9936217918048866}-{'f1_val': 0.9935679896985945, 'auprc': 0.9939419356098864, 'loss_val': 0.0359785472521949, 'psi': 0.9937175680631112}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=46 head_norm_before_train=2.061131 cos_to_last_merge=0.7527 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.753
[S11] round=46 local utility u=0.472441 metrics={'f1_val': 0.9949523906435326, 'auprc': 0.9983779795930089, 'loss_val': 0.029632837030615228, 'psi': 0.9963226262233231}-{'f1_val': 0.858927152717077, 'auprc': 0.9970716294039487, 'loss_val': 0.15444495109020615, 'psi': 0.9141849433918257}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=46 head_norm_before_train=1.988134 (no previous merge yet)
[S13] round=46 local utility u=0.000000 metrics={'f1_val': 0.6290061329064092, 'auprc': 0.7323820304538285, 'loss_val': 1.1676520213446546, 'psi': 0.6703564919253768}-{'f1_val': 0.6262223212833059, 'auprc': 0.7428207705810176, 'loss_val': 1.091074518004436, 'psi': 0.6728617010023905}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=46 head_norm_before_train=2.098047 (no previous merge yet)
[S14] round=46 local utility u=0.000000 metrics={'f1_val': 0.9977975102598944, 'auprc': 0.9987647606822536, 'loss_val': 0.02153677484218074, 'psi': 0.9981844104288381}-{'f1_val': 0.9978217593544257, 'auprc': 0.9991356426493809, 'loss_val': 0.019549713022444213, 'psi': 0.9983473126724078}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=46 head_norm_before_train=1.665186 cos_to_last_merge=0.9776 (last merge round=33)
[S15] round=46 local utility u=0.519433 metrics={'f1_val': 0.959752111813208, 'auprc': 0.9964938530167606, 'loss_val': 0.10483255677630852, 'psi': 0.974448808294629}-{'f1_val': 0.8534794399289702, 'auprc': 0.9470956376585, 'loss_val': 0.35786827133699023, 'psi': 0.8909259190207821}
[S15] not sending this round → trigger blocked (psi=0.974)
[S16] START round=46 head_norm_before_train=1.757840 cos_to_last_merge=0.9528 (last merge round=33)
[S16] round=46 local utility u=0.351588 metrics={'f1_val': 0.8709708584247204, 'auprc': 0.9885863573180196, 'loss_val': 0.7454454713290225, 'psi': 0.9180170579820401}-{'f1_val': 0.8444689094417347, 'auprc': 0.9019906880482355, 'loss_val': 1.0298228031989207, 'psi': 0.8674776208843349}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S17] START round=46 head_norm_before_train=2.004689 cos_to_last_merge=0.8120 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.812
[S17] round=46 local utility u=0.000000 metrics={'f1_val': 0.6747321367870893, 'auprc': 0.8838227579984375, 'loss_val': 1.3984576565348357, 'psi': 0.7583683852716285}-{'f1_val': 0.933386876653611, 'auprc': 0.9827812976813409, 'loss_val': 0.294344630137822, 'psi': 0.953144645064703}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=47 head_norm_before_train=2.190624 cos_to_last_merge=0.9976 (last merge round=35)
[S2] round=47 local utility u=0.000000 metrics={'f1_val': 0.6664179362489675, 'auprc': 0.7353130869760343, 'loss_val': 1.1554862338245406, 'psi': 0.6939759965397942}-{'f1_val': 0.703893233855595, 'auprc': 0.7273300232114991, 'loss_val': 1.0183919508952604, 'psi': 0.7132679495979566}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=47 head_norm_before_train=1.719646 cos_to_last_merge=0.8549 (last merge round=29)
[S3] ⚠️ Model drifted since last merge! cos=0.855
[S3] round=47 local utility u=0.049383 metrics={'f1_val': 0.9978100342676263, 'auprc': 0.9986956184332508, 'loss_val': 0.03296982814040728, 'psi': 0.998164267933876}-{'f1_val': 0.9838348379227521, 'auprc': 0.9983199255431762, 'loss_val': 0.04675675178084163, 'psi': 0.9896288729709217}
[S3] not sending this round → trigger blocked (psi=0.998)
[S4] START round=47 head_norm_before_train=2.110995 cos_to_last_merge=0.9958 (last merge round=30)
[S4] round=47 local utility u=0.000000 metrics={'f1_val': 0.9391940367444991, 'auprc': 0.9832813893185385, 'loss_val': 0.3000593284532978, 'psi': 0.9568289777741148}-{'f1_val': 0.9435153775037308, 'auprc': 0.9843817951816831, 'loss_val': 0.2902578532294553, 'psi': 0.9598619445749117}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=47 head_norm_before_train=1.892514 (no previous merge yet)
[S5] round=47 local utility u=0.000000 metrics={'f1_val': 0.9964794802860635, 'auprc': 0.9957824913380922, 'loss_val': 0.045780178642299614, 'psi': 0.996200684706875}-{'f1_val': 0.9964794802860635, 'auprc': 0.9966452627654424, 'loss_val': 0.04784050996095911, 'psi': 0.996545793277815}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=47 head_norm_before_train=1.756414 cos_to_last_merge=0.9764 (last merge round=34)
[S6] round=47 local utility u=1.000000 metrics={'f1_val': 0.7426847908004266, 'auprc': 0.9537867138443286, 'loss_val': 0.5372048694783671, 'psi': 0.8271255600179874}-{'f1_val': 0.510452007859515, 'auprc': 0.8425145692525486, 'loss_val': 0.8939056334617528, 'psi': 0.6432770324167285}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] START round=47 head_norm_before_train=1.703703 cos_to_last_merge=0.9967 (last merge round=34)
[S7] round=47 local utility u=0.000000 metrics={'f1_val': 0.624620189461712, 'auprc': 0.8018224906003382, 'loss_val': 0.5459560072616816, 'psi': 0.6955011099171625}-{'f1_val': 0.6703111953515256, 'auprc': 0.8259687845817925, 'loss_val': 0.3813670253051115, 'psi': 0.7325742310436324}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=47 head_norm_before_train=1.736301 cos_to_last_merge=0.9813 (last merge round=34)
[S8] round=47 local utility u=0.000000 metrics={'f1_val': 0.9926334147146996, 'auprc': 0.9872152727235479, 'loss_val': 0.043071398756110074, 'psi': 0.990466157918239}-{'f1_val': 0.9917768254438665, 'auprc': 0.9994372952925324, 'loss_val': 0.04661496266656822, 'psi': 0.9948410133833328}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=47 head_norm_before_train=1.903023 cos_to_last_merge=0.7868 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.787
[S9] round=47 local utility u=0.000000 metrics={'f1_val': 0.9901297741397954, 'auprc': 0.9989017849753883, 'loss_val': 0.03393985239538789, 'psi': 0.9936385784740326}-{'f1_val': 0.9958267183641853, 'auprc': 0.999557424417166, 'loss_val': 0.020538878300025896, 'psi': 0.9973190007853776}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=47 head_norm_before_train=1.740429 cos_to_last_merge=0.9763 (last merge round=29)
[S10] round=47 local utility u=0.000152 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.9939451960441584, 'loss_val': 0.0357911986278575, 'psi': 0.9936377033102068}-{'f1_val': 0.9934327081542391, 'auprc': 0.9939054172808577, 'loss_val': 0.035976697162764415, 'psi': 0.9936217918048866}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=47 head_norm_before_train=2.068416 cos_to_last_merge=0.7519 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.752
[S11] round=47 local utility u=0.008309 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9987333228826898, 'loss_val': 0.021290726564015497, 'psi': 0.9971858139995231}-{'f1_val': 0.9949523906435326, 'auprc': 0.9983779795930089, 'loss_val': 0.029632837030615228, 'psi': 0.9963226262233231}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=47 head_norm_before_train=1.994193 (no previous merge yet)
[S13] round=47 local utility u=0.617784 metrics={'f1_val': 0.7335843629847127, 'auprc': 0.7741031845829065, 'loss_val': 0.6847159449263868, 'psi': 0.7497918916239903}-{'f1_val': 0.6290061329064092, 'auprc': 0.7323820304538285, 'loss_val': 1.1676520213446546, 'psi': 0.6703564919253768}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=47 head_norm_before_train=2.108723 (no previous merge yet)
[S14] round=47 local utility u=0.000754 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.9987925062311164, 'loss_val': 0.02024374943764693, 'psi': 0.9982087132727776}-{'f1_val': 0.9977975102598944, 'auprc': 0.9987647606822536, 'loss_val': 0.02153677484218074, 'psi': 0.9981844104288381}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] sending update (kind=head size=1795 to 1 peers)
[S15] START round=47 head_norm_before_train=1.678558 cos_to_last_merge=0.9765 (last merge round=33)
[S15] round=47 local utility u=0.134638 metrics={'f1_val': 0.9929451707458037, 'auprc': 0.9973720891940819, 'loss_val': 0.037349366821441195, 'psi': 0.9947159381251149}-{'f1_val': 0.959752111813208, 'auprc': 0.9964938530167606, 'loss_val': 0.10483255677630852, 'psi': 0.974448808294629}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] sending update (kind=head size=1802 to 1 peers)
[S16] START round=47 head_norm_before_train=1.769166 cos_to_last_merge=0.9518 (last merge round=33)
[S16] round=47 local utility u=0.453921 metrics={'f1_val': 0.9431886046711041, 'auprc': 0.9952690958581739, 'loss_val': 0.29095772814179227, 'psi': 0.964020801145932}-{'f1_val': 0.8709708584247204, 'auprc': 0.9885863573180196, 'loss_val': 0.7454454713290225, 'psi': 0.9180170579820401}
[S16] not sending this round → trigger blocked (psi=0.964)
[S17] START round=47 head_norm_before_train=2.013798 cos_to_last_merge=0.8113 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.811
[S17] round=47 local utility u=1.000000 metrics={'f1_val': 0.9354263098550673, 'auprc': 0.9933842312422866, 'loss_val': 0.15991485818679407, 'psi': 0.958609478409955}-{'f1_val': 0.6747321367870893, 'auprc': 0.8838227579984375, 'loss_val': 1.3984576565348357, 'psi': 0.7583683852716285}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=48 head_norm_before_train=2.198829 cos_to_last_merge=0.9975 (last merge round=35)
[S2] round=48 local utility u=0.165430 metrics={'f1_val': 0.6865977789839155, 'auprc': 0.7437818663545293, 'loss_val': 0.9711110644553984, 'psi': 0.709471413932161}-{'f1_val': 0.6664179362489675, 'auprc': 0.7353130869760343, 'loss_val': 1.1554862338245406, 'psi': 0.6939759965397942}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=48 head_norm_before_train=1.729903 cos_to_last_merge=0.8536 (last merge round=29)
[S3] ⚠️ Model drifted since last merge! cos=0.854
[S3] round=48 local utility u=0.000000 metrics={'f1_val': 0.9608296089712303, 'auprc': 0.9984235181923116, 'loss_val': 0.13431797279661373, 'psi': 0.9758671726596628}-{'f1_val': 0.9978100342676263, 'auprc': 0.9986956184332508, 'loss_val': 0.03296982814040728, 'psi': 0.998164267933876}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=48 head_norm_before_train=2.114675 cos_to_last_merge=0.9956 (last merge round=30)
[S4] round=48 local utility u=0.000000 metrics={'f1_val': 0.9342988713991359, 'auprc': 0.9846188587364852, 'loss_val': 0.29802633827009045, 'psi': 0.9544268663340756}-{'f1_val': 0.9391940367444991, 'auprc': 0.9832813893185385, 'loss_val': 0.3000593284532978, 'psi': 0.9568289777741148}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=48 head_norm_before_train=1.903275 (no previous merge yet)
[S5] round=48 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9941522811127874, 'loss_val': 0.04486752797393409, 'psi': 0.9953725264307016}-{'f1_val': 0.9964794802860635, 'auprc': 0.9957824913380922, 'loss_val': 0.045780178642299614, 'psi': 0.996200684706875}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=48 head_norm_before_train=1.769576 cos_to_last_merge=0.9756 (last merge round=34)
[S6] round=48 local utility u=0.000000 metrics={'f1_val': 0.43454713628533326, 'auprc': 0.7819844387477801, 'loss_val': 1.2829480932520179, 'psi': 0.573522057270312}-{'f1_val': 0.7426847908004266, 'auprc': 0.9537867138443286, 'loss_val': 0.5372048694783671, 'psi': 0.8271255600179874}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=48 head_norm_before_train=1.708083 cos_to_last_merge=0.9964 (last merge round=34)
[S7] round=48 local utility u=0.000000 metrics={'f1_val': 0.6244245052391434, 'auprc': 0.7968881525167046, 'loss_val': 0.6112428833509364, 'psi': 0.6934099641501679}-{'f1_val': 0.624620189461712, 'auprc': 0.8018224906003382, 'loss_val': 0.5459560072616816, 'psi': 0.6955011099171625}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=48 head_norm_before_train=1.749369 cos_to_last_merge=0.9804 (last merge round=34)
[S8] round=48 local utility u=0.023147 metrics={'f1_val': 0.9931113357884451, 'auprc': 0.9988618205969096, 'loss_val': 0.03458436271840904, 'psi': 0.9954115297118309}-{'f1_val': 0.9926334147146996, 'auprc': 0.9872152727235479, 'loss_val': 0.043071398756110074, 'psi': 0.990466157918239}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=48 head_norm_before_train=1.911370 cos_to_last_merge=0.7863 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.786
[S9] round=48 local utility u=0.016925 metrics={'f1_val': 0.9941897064172326, 'auprc': 0.9992021953336538, 'loss_val': 0.025351106015811333, 'psi': 0.9961947019838011}-{'f1_val': 0.9901297741397954, 'auprc': 0.9989017849753883, 'loss_val': 0.03393985239538789, 'psi': 0.9936385784740326}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=48 head_norm_before_train=1.752124 cos_to_last_merge=0.9755 (last merge round=29)
[S10] round=48 local utility u=0.000298 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.9938894543435983, 'loss_val': 0.0350279136646793, 'psi': 0.9936154066299828}-{'f1_val': 0.9934327081542391, 'auprc': 0.9939451960441584, 'loss_val': 0.0357911986278575, 'psi': 0.9936377033102068}
[S10] not sending this round → trigger blocked (psi=0.994)
[S11] START round=48 head_norm_before_train=2.076813 cos_to_last_merge=0.7513 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.751
[S11] round=48 local utility u=0.000795 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9985804776862386, 'loss_val': 0.021598655246067574, 'psi': 0.9973603937826492}-{'f1_val': 0.9961541414107454, 'auprc': 0.9987333228826898, 'loss_val': 0.021290726564015497, 'psi': 0.9971858139995231}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=48 head_norm_before_train=1.993604 (no previous merge yet)
[S13] round=48 local utility u=0.000000 metrics={'f1_val': 0.6354287947532258, 'auprc': 0.7502008762371069, 'loss_val': 1.129029183920625, 'psi': 0.6813376273467782}-{'f1_val': 0.7335843629847127, 'auprc': 0.7741031845829065, 'loss_val': 0.6847159449263868, 'psi': 0.7497918916239903}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=48 head_norm_before_train=2.118019 (no previous merge yet)
[S14] round=48 local utility u=0.000481 metrics={'f1_val': 0.9980403583402068, 'auprc': 0.9988187269066165, 'loss_val': 0.02068632796023629, 'psi': 0.9983517057667708}-{'f1_val': 0.9978195179672185, 'auprc': 0.9987925062311164, 'loss_val': 0.02024374943764693, 'psi': 0.9982087132727776}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=48 head_norm_before_train=1.691628 cos_to_last_merge=0.9756 (last merge round=33)
[S15] round=48 local utility u=0.000000 metrics={'f1_val': 0.9027820490347966, 'auprc': 0.9942133566505578, 'loss_val': 0.2724958974561131, 'psi': 0.9393545720811011}-{'f1_val': 0.9929451707458037, 'auprc': 0.9973720891940819, 'loss_val': 0.037349366821441195, 'psi': 0.9947159381251149}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=48 head_norm_before_train=1.781724 cos_to_last_merge=0.9506 (last merge round=33)
[S16] round=48 local utility u=0.082639 metrics={'f1_val': 0.9477944597960417, 'auprc': 0.9952583372435728, 'loss_val': 0.15328290198197028, 'psi': 0.9667800107750542}-{'f1_val': 0.9431886046711041, 'auprc': 0.9952690958581739, 'loss_val': 0.29095772814179227, 'psi': 0.964020801145932}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S16] sending update (kind=head size=1808 to 1 peers)
[S17] START round=48 head_norm_before_train=2.021678 cos_to_last_merge=0.8104 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.810
[S17] round=48 local utility u=0.000000 metrics={'f1_val': 0.7284446052972723, 'auprc': 0.8877166511045143, 'loss_val': 0.974405198565071, 'psi': 0.792153423620169}-{'f1_val': 0.9354263098550673, 'auprc': 0.9933842312422866, 'loss_val': 0.15991485818679407, 'psi': 0.958609478409955}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=49 head_norm_before_train=2.205698 cos_to_last_merge=0.9973 (last merge round=35)
[S2] round=49 local utility u=0.069399 metrics={'f1_val': 0.7020230269300288, 'auprc': 0.7405585400044132, 'loss_val': 0.9151952825669999, 'psi': 0.7174372321597826}-{'f1_val': 0.6865977789839155, 'auprc': 0.7437818663545293, 'loss_val': 0.9711110644553984, 'psi': 0.709471413932161}
[S2] not sending this round → trigger blocked (psi=0.717)
[S3] START round=49 head_norm_before_train=1.739240 cos_to_last_merge=0.8524 (last merge round=29)
[S3] ⚠️ Model drifted since last merge! cos=0.852
[S3] round=49 local utility u=0.000000 metrics={'f1_val': 0.9123575602574369, 'auprc': 0.9976614572752395, 'loss_val': 0.15846927485791912, 'psi': 0.946479119064558}-{'f1_val': 0.9608296089712303, 'auprc': 0.9984235181923116, 'loss_val': 0.13431797279661373, 'psi': 0.9758671726596628}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=49 head_norm_before_train=2.118074 cos_to_last_merge=0.9954 (last merge round=30)
[S4] round=49 local utility u=0.000000 metrics={'f1_val': 0.934032467215526, 'auprc': 0.9654599866562807, 'loss_val': 0.29640923699737903, 'psi': 0.9466034749918278}-{'f1_val': 0.9342988713991359, 'auprc': 0.9846188587364852, 'loss_val': 0.29802633827009045, 'psi': 0.9544268663340756}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=49 head_norm_before_train=1.914308 (no previous merge yet)
[S5] round=49 local utility u=0.008390 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9978436745953478, 'loss_val': 0.03916186352846902, 'psi': 0.9968490838237257}-{'f1_val': 0.996186023309311, 'auprc': 0.9941522811127874, 'loss_val': 0.04486752797393409, 'psi': 0.9953725264307016}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] START round=49 head_norm_before_train=1.784671 cos_to_last_merge=0.9742 (last merge round=34)
[S6] round=49 local utility u=1.000000 metrics={'f1_val': 0.7366228094026186, 'auprc': 0.9719170843284124, 'loss_val': 0.49319773796953686, 'psi': 0.8307405193729361}-{'f1_val': 0.43454713628533326, 'auprc': 0.7819844387477801, 'loss_val': 1.2829480932520179, 'psi': 0.573522057270312}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=49 head_norm_before_train=1.713222 cos_to_last_merge=0.9961 (last merge round=34)
[S7] round=49 local utility u=0.000000 metrics={'f1_val': 0.5992128717286471, 'auprc': 0.7929718381369609, 'loss_val': 0.8167058021253271, 'psi': 0.6767164582919727}-{'f1_val': 0.6244245052391434, 'auprc': 0.7968881525167046, 'loss_val': 0.6112428833509364, 'psi': 0.6934099641501679}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=49 head_norm_before_train=1.762438 cos_to_last_merge=0.9794 (last merge round=34)
[S8] round=49 local utility u=0.000000 metrics={'f1_val': 0.9410031280818639, 'auprc': 0.9851380111228928, 'loss_val': 0.09724763059261139, 'psi': 0.9586570812982755}-{'f1_val': 0.9931113357884451, 'auprc': 0.9988618205969096, 'loss_val': 0.03458436271840904, 'psi': 0.9954115297118309}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=49 head_norm_before_train=1.916922 cos_to_last_merge=0.7859 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.786
[S9] round=49 local utility u=0.008795 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9992825987317295, 'loss_val': 0.020490607094042178, 'psi': 0.9974756569309355}-{'f1_val': 0.9941897064172326, 'auprc': 0.9992021953336538, 'loss_val': 0.025351106015811333, 'psi': 0.9961947019838011}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=49 head_norm_before_train=1.762562 cos_to_last_merge=0.9749 (last merge round=29)
[S10] round=49 local utility u=0.000113 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.9940830447623428, 'loss_val': 0.03538293154618453, 'psi': 0.9936928427974806}-{'f1_val': 0.9934327081542391, 'auprc': 0.9938894543435983, 'loss_val': 0.0350279136646793, 'psi': 0.9936154066299828}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] sending update (kind=head size=1793 to 1 peers)
[S11] START round=49 head_norm_before_train=2.086099 cos_to_last_merge=0.7506 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.751
[S11] round=49 local utility u=0.000818 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9988039768512711, 'loss_val': 0.020633316559817042, 'psi': 0.9974497934486621}-{'f1_val': 0.9965470045135896, 'auprc': 0.9985804776862386, 'loss_val': 0.021598655246067574, 'psi': 0.9973603937826492}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=49 head_norm_before_train=1.999035 (no previous merge yet)
[S13] round=49 local utility u=0.664485 metrics={'f1_val': 0.7540047946914044, 'auprc': 0.7919672551382058, 'loss_val': 0.6368134438072817, 'psi': 0.769189778870125}-{'f1_val': 0.6354287947532258, 'auprc': 0.7502008762371069, 'loss_val': 1.129029183920625, 'psi': 0.6813376273467782}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=49 head_norm_before_train=2.124648 (no previous merge yet)
[S14] round=49 local utility u=0.000000 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.9987701672658315, 'loss_val': 0.019507095383135137, 'psi': 0.9981997776866636}-{'f1_val': 0.9980403583402068, 'auprc': 0.9988187269066165, 'loss_val': 0.02068632796023629, 'psi': 0.9983517057667708}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=49 head_norm_before_train=1.706249 cos_to_last_merge=0.9746 (last merge round=33)
[S15] round=49 local utility u=0.380579 metrics={'f1_val': 0.9895831161076509, 'auprc': 0.9970971217019137, 'loss_val': 0.04079635681344243, 'psi': 0.992588718345356}-{'f1_val': 0.9027820490347966, 'auprc': 0.9942133566505578, 'loss_val': 0.2724958974561131, 'psi': 0.9393545720811011}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] sending update (kind=head size=1805 to 1 peers)
[S16] START round=49 head_norm_before_train=1.792019 cos_to_last_merge=0.9501 (last merge round=33)
[S16] round=49 local utility u=0.139036 metrics={'f1_val': 0.9808877940125513, 'auprc': 0.9954154120587961, 'loss_val': 0.0742417782052664, 'psi': 0.9866988412310493}-{'f1_val': 0.9477944597960417, 'auprc': 0.9952583372435728, 'loss_val': 0.15328290198197028, 'psi': 0.9667800107750542}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] sending update (kind=head size=1805 to 1 peers)
[S17] START round=49 head_norm_before_train=2.032247 cos_to_last_merge=0.8094 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.809
[S17] round=49 local utility u=1.000000 metrics={'f1_val': 0.936216946271956, 'auprc': 0.9894279288232248, 'loss_val': 0.20340348019386825, 'psi': 0.9575013392924635}-{'f1_val': 0.7284446052972723, 'auprc': 0.8877166511045143, 'loss_val': 0.974405198565071, 'psi': 0.792153423620169}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[runner] rounds complete.
[runner] all agents stopped.
