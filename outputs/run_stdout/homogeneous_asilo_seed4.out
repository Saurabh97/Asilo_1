[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:49103
[S3] → join 127.0.0.1:49102
[S4] → join 127.0.0.1:49102
[S5] → join 127.0.0.1:49102
[S6] → join 127.0.0.1:49102
[S7] → join 127.0.0.1:49102
[S8] → join 127.0.0.1:49102
[S9] → join 127.0.0.1:49102
[S10] → join 127.0.0.1:49102
[S11] → join 127.0.0.1:49102
[S13] → join 127.0.0.1:49102
[S14] → join 127.0.0.1:49102
[S15] → join 127.0.0.1:49102
[S16] → join 127.0.0.1:49102
[S17] → join 127.0.0.1:49102
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.176594 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.170407 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.076700 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.211336 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.145084 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.136464 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.183496 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.111806 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.193061 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.204177 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.158702 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.178213 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.142474 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.150253 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.076963 (no previous merge yet)
[S2]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S4] + discovered S2
[S3] + discovered S14
[S3] + discovered S5
[S3] + discovered S7
[S3] + discovered S8
[S3] + discovered S4
[S3] + discovered S13
[S3] + discovered S11
[S3] + discovered S16
[S3] + discovered S10
[S3] + discovered S6
[S3] + discovered S17
[S3] + discovered S9
[S3] + discovered S15
[S4] + discovered S3
[S4] + discovered S11
[S4] + discovered S7
[S4] + discovered S13
[S5] + discovered S2
[S4] + discovered S9
[S4] + discovered S6
[S4] + discovered S15
[S4] + discovered S5
[S4] + discovered S10
[S5] + discovered S3
[S4] + discovered S17
[S4] + discovered S8
[S5] + discovered S4
[S4] + discovered S16
[S4] + discovered S14
[S5] + discovered S14
[S5] + discovered S17
[S5] + discovered S15
[S5] + discovered S10
[S6] + discovered S5
[S5] + discovered S13
[S5] + discovered S11
[S5] + discovered S8
[S5] + discovered S6
[S6] + discovered S2
[S6] + discovered S3
[S5] + discovered S16
[S5] + discovered S7
[S5] + discovered S9
[S6] + discovered S4
[S7] + discovered S6
[S6] + discovered S17
[S6] + discovered S13
[S6] + discovered S7
[S7] + discovered S2
[S7] + discovered S3
[S6] + discovered S8
[S6] + discovered S14
[S6] + discovered S16
[S7] + discovered S5
[S6] + discovered S10
[S6] + discovered S9
[S7] + discovered S4
[S6] + discovered S11
[S6] + discovered S15
[S7] + discovered S14
[S8] + discovered S6
[S7] + discovered S10
[S7] + discovered S8
[S7] + discovered S16
[S8] + discovered S7
[S8] + discovered S4
[S7] + discovered S15
[S7] + discovered S13
[S7] + discovered S11
[S8] + discovered S3
[S7] + discovered S9
[S8] + discovered S2
[S8] + discovered S5
[S7] + discovered S17
[S9] + discovered S3
[S9] + discovered S8
[S8] + discovered S13
[S9] + discovered S2
[S8] + discovered S9
[S9] + discovered S6
[S8] + discovered S14
[S8] + discovered S15
[S9] + discovered S5
[S8] + discovered S16
[S9] + discovered S7
[S8] + discovered S11
[S9] + discovered S4
[S8] + discovered S10
[S8] + discovered S17
[S10] + discovered S3
[S9] + discovered S13
[S10] + discovered S9
[S10] + discovered S2
[S9] + discovered S17
[S9] + discovered S10
[S10] + discovered S4
[S10] + discovered S8
[S10] + discovered S7
[S10] + discovered S6
[S10] + discovered S5
[S9] + discovered S16
[S9] + discovered S15
[S9] + discovered S11
[S9] + discovered S14
[S10] + discovered S16
[S10] + discovered S13
[S10] + discovered S15
[S10] + discovered S11
[S10] + discovered S17
[S11] + discovered S6
[S11] + discovered S10
[S11] + discovered S3
[S11] + discovered S9
[S10] + discovered S14
[S11] + discovered S5
[S11] + discovered S2
[S11] + discovered S8
[S11] + discovered S7
[S11] + discovered S4
[S11] + discovered S13
[S11] + discovered S17
[S13] + discovered S5
[S13] + discovered S4
[S11] + discovered S14
[S11] + discovered S16
[S11] + discovered S15
[S13] + discovered S3
[S13] + discovered S7
[S13] + discovered S10
[S13] + discovered S2
[S13] + discovered S8
[S13] + discovered S9
[S13] + discovered S6
[S13] + discovered S11
[S14] + discovered S2
[S14] + discovered S5
[S14] + discovered S7
[S14] + discovered S11
[S14] + discovered S9
[S14] + discovered S3
[S14] + discovered S4
[S13] + discovered S16
[S13] + discovered S17
[S13] + discovered S14
[S13] + discovered S15
[S14] + discovered S6
[S14] + discovered S8
[S14] + discovered S13
[S14] + discovered S10
[S15] + discovered S8
[S15] + discovered S3
[S15] + discovered S7
[S15] + discovered S6
[S15] + discovered S11
[S15] + discovered S10
[S15] + discovered S5
[S14] + discovered S16
[S15] + discovered S13
[S15] + discovered S9
[S15] + discovered S4
[S15] + discovered S14
[S14] + discovered S17
[S14] + discovered S15
[S15] + discovered S2
[S16] + discovered S15
[S16] + discovered S10
[S16] + discovered S5
[S16] + discovered S13
[S16] + discovered S4
[S16] + discovered S2
[S16] + discovered S8
[S16] + discovered S3
[S16] + discovered S14
[S16] + discovered S7
[S15] + discovered S16
[S15] + discovered S17
[S16] + discovered S11
[S16] + discovered S9
[S16] + discovered S6
[S17] + discovered S9
[S17] + discovered S14
[S17] + discovered S5
[S17] + discovered S4
[S17] + discovered S7
[S17] + discovered S15
[S17] + discovered S3
[S17] + discovered S8
[S17] + discovered S2
[S17] + discovered S11
[S17] + discovered S16
[S17] + discovered S10
[S17] + discovered S6
[S16] + discovered S17
[S17] + discovered S13
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] ⇄ pheromone p=1.000 → S16@127.0.0.1:49116
[S4] ⇄ pheromone p=1.000 → S7@127.0.0.1:49108
[S13] ⇄ pheromone p=1.000 → S11@127.0.0.1:49112
[S14] ⇄ pheromone p=1.000 → S10@127.0.0.1:49111
[S11] ⇄ pheromone p=1.000 → S16@127.0.0.1:49116
[S2] ⇄ pheromone p=1.000 → S9@127.0.0.1:49110
[S10] ⇄ pheromone p=1.000 → S3@127.0.0.1:49103
[S3] ⇄ pheromone p=1.000 → S4@127.0.0.1:49104
[S8] ⇄ pheromone p=1.000 → S13@127.0.0.1:49113
[S15] ⇄ pheromone p=1.000 → S2@127.0.0.1:49102
[S16] ⇄ pheromone p=1.000 → S10@127.0.0.1:49111
[S6] ⇄ pheromone p=1.000 → S11@127.0.0.1:49112
[S9] ⇄ pheromone p=1.000 → S6@127.0.0.1:49107
[S7] ⇄ pheromone p=1.000 → S16@127.0.0.1:49116
[S17] ⇄ pheromone p=1.000 → S4@127.0.0.1:49104
[S2] START round=1 head_norm_before_train=1.185027 (no previous merge yet)
[S2] round=1 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.8387979283879445, 'loss_val': 1.3066447874723994, 'psi': 0.4205854513883179}-{'f1_val': 0.41551540209778626, 'auprc': 0.7792028110413971, 'loss_val': 1.3516249079726728, 'psi': 0.5609903656752306}
[S3] START round=1 head_norm_before_train=1.175858 (no previous merge yet)
[S3] round=1 local utility u=0.038371 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.6885354841715383, 'loss_val': 1.3057345780073841, 'psi': 0.35931823303707955}-{'f1_val': 0.13984006561410703, 'auprc': 0.6742257325529153, 'loss_val': 1.3395483101595524, 'psi': 0.35359433238963034}
[S4] START round=1 head_norm_before_train=1.086160 (no previous merge yet)
[S4] round=1 local utility u=0.430495 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.6850347257561605, 'loss_val': 1.3259892884129953, 'psi': 0.3581498676395747}-{'f1_val': 0.14022662889518414, 'auprc': 0.4076715664500573, 'loss_val': 1.3548907958390233, 'psi': 0.24720460391713342}
[S5] START round=1 head_norm_before_train=1.217993 (no previous merge yet)
[S5] round=1 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.5498484115328663, 'loss_val': 1.3185295303738447, 'psi': 0.3052965074702894}-{'f1_val': 0.38029497168428916, 'auprc': 0.553313895890087, 'loss_val': 1.3647359258605796, 'psi': 0.4495025413666083}
[S6] START round=1 head_norm_before_train=1.150851 (no previous merge yet)
[S6] round=1 local utility u=0.046252 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8405463690628066, 'loss_val': 1.3247448572335576, 'psi': 0.42107431685589186}-{'f1_val': 0.14142628205128205, 'auprc': 0.8201551082484851, 'loss_val': 1.356074745138655, 'psi': 0.4129178125301633}
[S7] START round=1 head_norm_before_train=1.150073 (no previous merge yet)
[S7] round=1 local utility u=0.022384 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.57434721301409, 'loss_val': 1.3147577489184945, 'psi': 0.314972978843091}-{'f1_val': 0.14205682272909165, 'auprc': 0.5722550470892156, 'loss_val': 1.3532502102528428, 'psi': 0.3141361124731412}
[S8] START round=1 head_norm_before_train=1.193385 (no previous merge yet)
[S8] round=1 local utility u=0.019204 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.635035411016391, 'loss_val': 1.340899706417835, 'psi': 0.33798775384233076}-{'f1_val': 0.1599671792183648, 'auprc': 0.5939647770383185, 'loss_val': 1.3761623677242891, 'psi': 0.3335662183463463}
[S9] START round=1 head_norm_before_train=1.119711 (no previous merge yet)
[S9] round=1 local utility u=0.031616 metrics={'f1_val': 0.141397957139996, 'auprc': 0.7668171620078856, 'loss_val': 1.3304509169431094, 'psi': 0.39156563908715186}-{'f1_val': 0.1480511445922506, 'auprc': 0.7461174265174666, 'loss_val': 1.371503565376614, 'psi': 0.387277657362337}
[S10] START round=1 head_norm_before_train=1.202910 (no previous merge yet)
[S10] round=1 local utility u=0.017685 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6409743888631729, 'loss_val': 1.2998248157577739, 'psi': 0.3395627380703035}-{'f1_val': 0.13862163754172394, 'auprc': 0.6376420376695978, 'loss_val': 1.3251967973027108, 'psi': 0.33822979759287347}
[S11] START round=1 head_norm_before_train=1.197612 (no previous merge yet)
[S11] round=1 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.8538344348287382, 'loss_val': 1.3452008547174035, 'psi': 0.42578198395536165}-{'f1_val': 0.30625, 'auprc': 0.5889936514082184, 'loss_val': 1.3807632831482983, 'psi': 0.4193474605632873}
[S13] START round=1 head_norm_before_train=1.159357 (no previous merge yet)
[S13] round=1 local utility u=0.108967 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5993842741053991, 'loss_val': 1.3260403966579588, 'psi': 0.3239851671883915}-{'f1_val': 0.1403857625770531, 'auprc': 0.5390265689125894, 'loss_val': 1.3629006597636681, 'psi': 0.29984208511126764}
[S14] START round=1 head_norm_before_train=1.183843 (no previous merge yet)
[S14] round=1 local utility u=0.280547 metrics={'f1_val': 0.39749663731561286, 'auprc': 0.8400718889426775, 'loss_val': 1.3295499799135442, 'psi': 0.5745267379664387}-{'f1_val': 0.3840719928658809, 'auprc': 0.6869184820675718, 'loss_val': 1.3506365509502338, 'psi': 0.5052105885465572}
[S15] START round=1 head_norm_before_train=1.143393 (no previous merge yet)
[S15] round=1 local utility u=1.000000 metrics={'f1_val': 0.3622216476664067, 'auprc': 0.7615159725608058, 'loss_val': 1.3678634171910602, 'psi': 0.5219393776241663}-{'f1_val': 0.11362116247413404, 'auprc': 0.4434618236275536, 'loss_val': 1.3984740142673429, 'psi': 0.24555742693550187}
[S16] START round=1 head_norm_before_train=1.152917 (no previous merge yet)
[S16] round=1 local utility u=0.386673 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.6699884152844748, 'loss_val': 1.3330706098043557, 'psi': 0.35237783623331187}-{'f1_val': 0.14063745019920318, 'auprc': 0.42259611552168636, 'loss_val': 1.364240522466633, 'psi': 0.25342091632819647}
[S17] START round=1 head_norm_before_train=1.085511 (no previous merge yet)
[S17] round=1 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5977570993584225, 'loss_val': 1.308111833131674, 'psi': 0.3236722177337996}-{'f1_val': 0.14094896331738438, 'auprc': 0.8019927052352508, 'loss_val': 1.3397227813250352, 'psi': 0.405366460084531}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S4] → sending delta(kind=head bytes=1790) to S8@127.0.0.1:49109
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S8] → sending delta(kind=head bytes=1788) to S4@127.0.0.1:49104
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S16] → sending delta(kind=head bytes=1791) to S5@127.0.0.1:49105
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S9] → sending delta(kind=head bytes=1788) to S8@127.0.0.1:49109
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S10] → sending delta(kind=head bytes=1786) to S13@127.0.0.1:49113
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S3] → sending delta(kind=head bytes=1792) to S17@127.0.0.1:49117
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S13] → sending delta(kind=head bytes=1789) to S2@127.0.0.1:49102
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S7] → sending delta(kind=head bytes=1786) to S17@127.0.0.1:49117
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] → sending delta(kind=head bytes=1793) to S17@127.0.0.1:49117
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S14] → sending delta(kind=head bytes=1789) to S2@127.0.0.1:49102
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S15] → sending delta(kind=head bytes=1791) to S10@127.0.0.1:49111
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1791 to 1 peers)
[S9] sending update (kind=head size=1788 to 1 peers)
[S13] sending update (kind=head size=1789 to 1 peers)
[S3] sending update (kind=head size=1792 to 1 peers)
[S7] sending update (kind=head size=1786 to 1 peers)
[S14] sending update (kind=head size=1789 to 1 peers)
[S6] sending update (kind=head size=1793 to 1 peers)
[S10] sending update (kind=head size=1786 to 1 peers)
[S16] sending update (kind=head size=1791 to 1 peers)
[S8] sending update (kind=head size=1788 to 1 peers)
[S4] sending update (kind=head size=1790 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1791) from S15
[S10] cosine check vs S15: cos=-0.0868
[S10] DROPPED delta from S15 (cos=-0.0868 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1786) from S7
[S17] cosine check vs S7: cos=0.0674
[S5] RECEIVED delta(kind=head bytes=1791) from S16
[S5] cosine check vs S16: cos=0.0799
[S17] RECEIVED delta(kind=head bytes=1793) from S6
[S17] cosine check vs S6: cos=0.0209
[S2] RECEIVED delta(kind=head bytes=1789) from S14
[S2] cosine check vs S14: cos=0.0026
[S2] RECEIVED delta(kind=head bytes=1789) from S13
[S2] cosine check vs S13: cos=0.0211
[S4] RECEIVED delta(kind=head bytes=1788) from S8
[S4] cosine check vs S8: cos=-0.0590
[S4] DROPPED delta from S8 (cos=-0.0590 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1786) from S10
[S13] cosine check vs S10: cos=0.1025
[S8] RECEIVED delta(kind=head bytes=1788) from S9
[S8] cosine check vs S9: cos=0.0563
[S8] RECEIVED delta(kind=head bytes=1790) from S4
[S8] cosine check vs S4: cos=-0.0590
[S8] DROPPED delta from S4 (cos=-0.0590 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1792) from S3
[S17] cosine check vs S3: cos=0.1066
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=1 metric=0.1423 head_norm=1.234062
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.145467e-01
[S5] stored merged vector for next round verification (round=1)
[S5] DEBUG after merge:  round=1 metric=0.1423 head_norm=0.882343 delta_norm=0.814547
[S5] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=1 metric=0.1418 head_norm=1.203929
[S2] _apply_head_vector_avg (torch): Δ‖w‖=7.127542e-01
[S2] stored merged vector for next round verification (round=1)
[S2] DEBUG after merge:  round=1 metric=0.1418 head_norm=0.724462 delta_norm=0.712754
[S2] aggregate: ACCEPT kept=['S14', 'S13'] (k=2/2) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=1 metric=0.1404 head_norm=1.172622
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.022084e-01
[S13] stored merged vector for next round verification (round=1)
[S13] DEBUG after merge:  round=1 metric=0.1404 head_norm=0.889046 delta_norm=0.802208
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=1 metric=0.1400 head_norm=1.213754
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.074649e-01
[S8] stored merged vector for next round verification (round=1)
[S8] DEBUG after merge:  round=1 metric=0.1145 head_norm=0.854169 delta_norm=0.807465
[S8] aggregate: ROLLBACK (f1_val pre=0.140 post=0.114 tol_abs=0.005 tol_rel=0.0)
[S17] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=1 metric=0.1409 head_norm=1.101124
[S17] _apply_head_vector_avg (torch): Δ‖w‖=6.143869e-01
[S17] stored merged vector for next round verification (round=1)
[S17] DEBUG after merge:  round=1 metric=0.1409 head_norm=0.679131 delta_norm=0.614387
[S17] aggregate: ACCEPT kept=['S7', 'S6', 'S3'] (k=3/3) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=0.724462 cos_to_last_merge=1.0000 (last merge round=1)
[S2] round=2 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.796864237153418, 'loss_val': 1.304679473225808, 'psi': 0.40381197489450726}-{'f1_val': 0.1417771333885667, 'auprc': 0.8387979283879445, 'loss_val': 1.3066447874723994, 'psi': 0.4205854513883179}
[S3] START round=2 head_norm_before_train=1.191977 (no previous merge yet)
[S3] round=2 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.6692016165836575, 'loss_val': 1.2664450319387375, 'psi': 0.35158468600192727}-{'f1_val': 0.13984006561410703, 'auprc': 0.6885354841715383, 'loss_val': 1.3057345780073841, 'psi': 0.35931823303707955}
[S4] START round=2 head_norm_before_train=1.103853 (no previous merge yet)
[S4] round=2 local utility u=0.092718 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7341558133876546, 'loss_val': 1.287916696049509, 'psi': 0.3777983026921723}-{'f1_val': 0.14022662889518414, 'auprc': 0.6850347257561605, 'loss_val': 1.3259892884129953, 'psi': 0.3581498676395747}
[S5] START round=2 head_norm_before_train=0.882343 cos_to_last_merge=1.0000 (last merge round=1)
[S5] round=2 local utility u=0.022086 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.557908777139894, 'loss_val': 1.2985386814028919, 'psi': 0.30852065371310045}-{'f1_val': 0.14226190476190476, 'auprc': 0.5498484115328663, 'loss_val': 1.3185295303738447, 'psi': 0.3052965074702894}
[S6] START round=2 head_norm_before_train=1.168132 (no previous merge yet)
[S6] round=2 local utility u=0.042524 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8576846026303685, 'loss_val': 1.2911124001067797, 'psi': 0.42792961028291665}-{'f1_val': 0.14142628205128205, 'auprc': 0.8405463690628066, 'loss_val': 1.3247448572335576, 'psi': 0.42107431685589186}
[S7] START round=2 head_norm_before_train=1.173165 (no previous merge yet)
[S7] round=2 local utility u=0.198800 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.6961286672537808, 'loss_val': 1.2825023395492667, 'psi': 0.3636855605389673}-{'f1_val': 0.14205682272909165, 'auprc': 0.57434721301409, 'loss_val': 1.3147577489184945, 'psi': 0.314972978843091}
[S8] START round=2 head_norm_before_train=0.854169 cos_to_last_merge=1.0000 (last merge round=1)
[S8] round=2 local utility u=0.776586 metrics={'f1_val': 0.3854510803710899, 'auprc': 0.6623496185223485, 'loss_val': 1.3426418628484282, 'psi': 0.49621049563159336}-{'f1_val': 0.13995598239295717, 'auprc': 0.635035411016391, 'loss_val': 1.340899706417835, 'psi': 0.33798775384233076}
[S9] START round=2 head_norm_before_train=1.135786 (no previous merge yet)
[S9] round=2 local utility u=0.078724 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8019205574217805, 'loss_val': 1.2783137893111536, 'psi': 0.4056069972527098}-{'f1_val': 0.141397957139996, 'auprc': 0.7668171620078856, 'loss_val': 1.3304509169431094, 'psi': 0.39156563908715186}
[S10] START round=2 head_norm_before_train=1.221817 (no previous merge yet)
[S10] round=2 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6167831205320616, 'loss_val': 1.273934676493912, 'psi': 0.32988623073785905}-{'f1_val': 0.13862163754172394, 'auprc': 0.6409743888631729, 'loss_val': 1.2998248157577739, 'psi': 0.3395627380703035}
[S11] START round=2 head_norm_before_train=1.201223 (no previous merge yet)
[S11] round=2 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7570770298132443, 'loss_val': 1.3078791219783907, 'psi': 0.3870790219491641}-{'f1_val': 0.14041368337311058, 'auprc': 0.8538344348287382, 'loss_val': 1.3452008547174035, 'psi': 0.42578198395536165}
[S13] START round=2 head_norm_before_train=0.889046 cos_to_last_merge=1.0000 (last merge round=1)
[S13] round=2 local utility u=0.181052 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7131083873286513, 'loss_val': 1.305108538344863, 'psi': 0.36947481247769237}-{'f1_val': 0.1403857625770531, 'auprc': 0.5993842741053991, 'loss_val': 1.3260403966579588, 'psi': 0.3239851671883915}
[S14] START round=2 head_norm_before_train=1.199198 (no previous merge yet)
[S14] round=2 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8541953794986122, 'loss_val': 1.3032279765849206, 'psi': 0.4258928635290672}-{'f1_val': 0.39749663731561286, 'auprc': 0.8400718889426775, 'loss_val': 1.3295499799135442, 'psi': 0.5745267379664387}
[S15] START round=2 head_norm_before_train=1.154648 (no previous merge yet)
[S15] round=2 local utility u=0.053781 metrics={'f1_val': 0.3724776844659374, 'auprc': 0.7654752604613261, 'loss_val': 1.3337153382358102, 'psi': 0.5296767148640928}-{'f1_val': 0.3622216476664067, 'auprc': 0.7615159725608058, 'loss_val': 1.3678634171910602, 'psi': 0.5219393776241663}
[S16] START round=2 head_norm_before_train=1.166671 (no previous merge yet)
[S16] round=2 local utility u=0.030586 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.6790917793293683, 'loss_val': 1.2992082449412479, 'psi': 0.35601918185126924}-{'f1_val': 0.14063745019920318, 'auprc': 0.6699884152844748, 'loss_val': 1.3330706098043557, 'psi': 0.35237783623331187}
[S17] START round=2 head_norm_before_train=0.679131 cos_to_last_merge=1.0000 (last merge round=1)
[S17] round=2 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5622063488875759, 'loss_val': 1.3064667644208694, 'psi': 0.309451917545461}-{'f1_val': 0.14094896331738438, 'auprc': 0.5977570993584225, 'loss_val': 1.308111833131674, 'psi': 0.3236722177337996}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:49102
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:49109
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S4] → sending delta(kind=head bytes=1790) to S10@127.0.0.1:49111
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S9] → sending delta(kind=head bytes=1788) to S17@127.0.0.1:49117
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S7] → sending delta(kind=head bytes=1790) to S2@127.0.0.1:49102
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:49105
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:49117
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:49114
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:49110
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1788 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1794 to 1 peers)
[S7] sending update (kind=head size=1790 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1790 to 1 peers)
[S16] sending update (kind=head size=1794 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1788) from S9
[S17] cosine check vs S9: cos=-0.0835
[S17] DROPPED delta from S9 (cos=-0.0835 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1790) from S4
[S10] cosine check vs S4: cos=-0.0149
[S10] DROPPED delta from S4 (cos=-0.0149 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1799) from S13
[S5] cosine check vs S13: cos=0.0735
[S2] RECEIVED delta(kind=head bytes=1790) from S7
[S2] cosine check vs S7: cos=0.0398
[S2] RECEIVED delta(kind=head bytes=1798) from S15
[S2] cosine check vs S15: cos=-0.0848
[S2] DROPPED delta from S15 (cos=-0.0848 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1794) from S16
[S14] cosine check vs S16: cos=-0.0058
[S14] DROPPED delta from S16 (cos=-0.0058 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1797) from S6
[S8] cosine check vs S6: cos=-0.0797
[S8] DROPPED delta from S6 (cos=-0.0797 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1794) from S8
[S9] cosine check vs S8: cos=0.6847
[S17] RECEIVED delta(kind=head bytes=1799) from S5
[S17] cosine check vs S5: cos=0.1234
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=2 metric=0.1418 head_norm=0.746804
[S2] _apply_head_vector_avg (torch): Δ‖w‖=6.929543e-01
[S2] stored merged vector for next round verification (round=2)
[S2] DEBUG after merge:  round=2 metric=0.1418 head_norm=0.718184 delta_norm=0.692954
[S2] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=2 metric=0.1414 head_norm=1.160734
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.249002e-01
[S9] stored merged vector for next round verification (round=2)
[S9] DEBUG after merge:  round=2 metric=0.1414 head_norm=0.935813 delta_norm=0.424900
[S9] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=2 metric=0.1423 head_norm=0.905409
[S5] _apply_head_vector_avg (torch): Δ‖w‖=6.171110e-01
[S5] stored merged vector for next round verification (round=2)
[S5] DEBUG after merge:  round=2 metric=0.1423 head_norm=0.664283 delta_norm=0.617111
[S5] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=2 metric=0.1409 head_norm=0.701652
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.374273e-01
[S17] stored merged vector for next round verification (round=2)
[S17] DEBUG after merge:  round=2 metric=0.1409 head_norm=0.605981 delta_norm=0.537427
[S17] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=3 head_norm_before_train=0.718184 cos_to_last_merge=1.0000 (last merge round=2)
[S2] round=3 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7142871185905753, 'loss_val': 1.282281899587083, 'psi': 0.37078112746937014}-{'f1_val': 0.1417771333885667, 'auprc': 0.796864237153418, 'loss_val': 1.304679473225808, 'psi': 0.40381197489450726}
[S3] START round=3 head_norm_before_train=1.215345 (no previous merge yet)
[S3] round=3 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.6168523857197534, 'loss_val': 1.2130064524489192, 'psi': 0.33064499365636557}-{'f1_val': 0.13984006561410703, 'auprc': 0.6692016165836575, 'loss_val': 1.2664450319387375, 'psi': 0.35158468600192727}
[S4] START round=3 head_norm_before_train=1.129953 (no previous merge yet)
[S4] round=3 local utility u=0.070627 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7615106075898485, 'loss_val': 1.2287274323016368, 'psi': 0.3887402203730499}-{'f1_val': 0.14022662889518414, 'auprc': 0.7341558133876546, 'loss_val': 1.287916696049509, 'psi': 0.3777983026921723}
[S5] START round=3 head_norm_before_train=0.664283 cos_to_last_merge=1.0000 (last merge round=2)
[S5] round=3 local utility u=0.261559 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7286378833211318, 'loss_val': 1.2876072110942647, 'psi': 0.3768122961855956}-{'f1_val': 0.14226190476190476, 'auprc': 0.557908777139894, 'loss_val': 1.2985386814028919, 'psi': 0.30852065371310045}
[S6] START round=3 head_norm_before_train=1.195265 (no previous merge yet)
[S6] round=3 local utility u=0.014842 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8560487602312368, 'loss_val': 1.2565205376544175, 'psi': 0.4272752733232639}-{'f1_val': 0.14142628205128205, 'auprc': 0.8576846026303685, 'loss_val': 1.2911124001067797, 'psi': 0.42792961028291665}
[S7] START round=3 head_norm_before_train=1.197594 (no previous merge yet)
[S7] round=3 local utility u=0.151256 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7893022405648439, 'loss_val': 1.259511774488234, 'psi': 0.40095498986339256}-{'f1_val': 0.14205682272909165, 'auprc': 0.6961286672537808, 'loss_val': 1.2825023395492667, 'psi': 0.3636855605389673}
[S8] START round=3 head_norm_before_train=0.874795 cos_to_last_merge=0.9971 (last merge round=1)
[S8] round=3 local utility u=0.122697 metrics={'f1_val': 0.4228440820360761, 'auprc': 0.658158203145899, 'loss_val': 1.3090310144733872, 'psi': 0.5169697304800053}-{'f1_val': 0.3854510803710899, 'auprc': 0.6623496185223485, 'loss_val': 1.3426418628484282, 'psi': 0.49621049563159336}
[S9] START round=3 head_norm_before_train=0.935813 cos_to_last_merge=1.0000 (last merge round=2)
[S9] round=3 local utility u=0.017029 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8018853961073198, 'loss_val': 1.244150949867951, 'psi': 0.40559293272692554}-{'f1_val': 0.141397957139996, 'auprc': 0.8019205574217805, 'loss_val': 1.2783137893111536, 'psi': 0.4056069972527098}
[S10] START round=3 head_norm_before_train=1.243962 (no previous merge yet)
[S10] round=3 local utility u=0.015842 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6174268460395013, 'loss_val': 1.2441826427129632, 'psi': 0.3301437209408349}-{'f1_val': 0.13862163754172394, 'auprc': 0.6167831205320616, 'loss_val': 1.273934676493912, 'psi': 0.32988623073785905}
[S11] START round=3 head_norm_before_train=1.217289 (no previous merge yet)
[S11] round=3 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7454212004112584, 'loss_val': 1.2730260769150201, 'psi': 0.3824166901883697}-{'f1_val': 0.14041368337311058, 'auprc': 0.7570770298132443, 'loss_val': 1.3078791219783907, 'psi': 0.3870790219491641}
[S13] START round=3 head_norm_before_train=0.907981 cos_to_last_merge=0.9976 (last merge round=1)
[S13] round=3 local utility u=0.015083 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7123811711561814, 'loss_val': 1.2727599647353869, 'psi': 0.3691839260087044}-{'f1_val': 0.1403857625770531, 'auprc': 0.7131083873286513, 'loss_val': 1.305108538344863, 'psi': 0.36947481247769237}
[S14] START round=3 head_norm_before_train=1.222363 (no previous merge yet)
[S14] round=3 local utility u=0.036738 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8667452805567758, 'loss_val': 1.2674024490618807, 'psi': 0.4309128239523326}-{'f1_val': 0.14035785288270378, 'auprc': 0.8541953794986122, 'loss_val': 1.3032279765849206, 'psi': 0.4258928635290672}
[S15] START round=3 head_norm_before_train=1.176489 (no previous merge yet)
[S15] round=3 local utility u=0.000000 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7580614932321579, 'loss_val': 1.2907149963343851, 'psi': 0.38706478810979816}-{'f1_val': 0.3724776844659374, 'auprc': 0.7654752604613261, 'loss_val': 1.3337153382358102, 'psi': 0.5296767148640928}
[S16] START round=3 head_norm_before_train=1.189908 (no previous merge yet)
[S16] round=3 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.6592128632985349, 'loss_val': 1.2543529965107214, 'psi': 0.34806761543893583}-{'f1_val': 0.14063745019920318, 'auprc': 0.6790917793293683, 'loss_val': 1.2992082449412479, 'psi': 0.35601918185126924}
[S17] START round=3 head_norm_before_train=0.605981 cos_to_last_merge=1.0000 (last merge round=2)
[S17] round=3 local utility u=0.038257 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5785749437364842, 'loss_val': 1.2790590674679942, 'psi': 0.31599935548502434}-{'f1_val': 0.14094896331738438, 'auprc': 0.5622063488875759, 'loss_val': 1.3064667644208694, 'psi': 0.309451917545461}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:49116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] → sending delta(kind=head bytes=1794) to S11@127.0.0.1:49112
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S9] → sending delta(kind=head bytes=1791) to S6@127.0.0.1:49107
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S13@127.0.0.1:49113
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] → sending delta(kind=head bytes=1794) to S10@127.0.0.1:49111
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S7] → sending delta(kind=head bytes=1790) to S16@127.0.0.1:49116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:49112
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:49108
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S10] → sending delta(kind=head bytes=1788) to S3@127.0.0.1:49103
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:49104
[S6] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1790 to 1 peers)
[S10] sending update (kind=head size=1788 to 1 peers)
[S14] sending update (kind=head size=1794 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1793 to 1 peers)
[S9] sending update (kind=head size=1791 to 1 peers)
[S13] sending update (kind=head size=1794 to 1 peers)
[S4] sending update (kind=head size=1795 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1794) from S14
[S10] cosine check vs S14: cos=0.0390
[S7] RECEIVED delta(kind=head bytes=1795) from S4
[S7] cosine check vs S4: cos=-0.0064
[S7] DROPPED delta from S4 (cos=-0.0064 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1793) from S8
[S13] cosine check vs S8: cos=-0.0218
[S13] DROPPED delta from S8 (cos=-0.0218 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1794) from S13
[S11] cosine check vs S13: cos=-0.0096
[S11] DROPPED delta from S13 (cos=-0.0096 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1795) from S6
[S11] cosine check vs S6: cos=0.0009
[S16] RECEIVED delta(kind=head bytes=1790) from S7
[S16] cosine check vs S7: cos=0.0207
[S6] RECEIVED delta(kind=head bytes=1791) from S9
[S6] cosine check vs S9: cos=-0.0549
[S6] DROPPED delta from S9 (cos=-0.0549 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1796) from S5
[S16] cosine check vs S5: cos=0.4976
[S3] RECEIVED delta(kind=head bytes=1788) from S10
[S3] cosine check vs S10: cos=-0.0346
[S3] DROPPED delta from S10 (cos=-0.0346 < 0.0)
[S17] sending update (kind=head size=1800 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1800) from S17
[S4] cosine check vs S17: cos=0.0707
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=3 metric=0.1404 head_norm=1.239479
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.722320e-01
[S11] stored merged vector for next round verification (round=3)
[S11] DEBUG after merge:  round=3 metric=0.1404 head_norm=0.873056 delta_norm=0.872232
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=3 metric=0.1402 head_norm=1.164398
[S4] _apply_head_vector_avg (torch): Δ‖w‖=6.431892e-01
[S4] stored merged vector for next round verification (round=3)
[S4] DEBUG after merge:  round=3 metric=0.1402 head_norm=0.682646 delta_norm=0.643189
[S4] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=3 metric=0.1386 head_norm=1.266888
[S10] _apply_head_vector_avg (torch): Δ‖w‖=8.728598e-01
[S10] stored merged vector for next round verification (round=3)
[S10] DEBUG after merge:  round=3 metric=0.1386 head_norm=0.907569 delta_norm=0.872860
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=3 metric=0.1406 head_norm=1.222888
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.286922e-01
[S16] stored merged vector for next round verification (round=3)
[S16] DEBUG after merge:  round=3 metric=0.1406 head_norm=0.787670 delta_norm=0.628692
[S16] aggregate: ACCEPT kept=['S7', 'S5'] (k=2/2) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=0.739894 cos_to_last_merge=0.9938 (last merge round=2)
[S2] round=4 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6107974617943808, 'loss_val': 1.2147319555129232, 'psi': 0.32938526475089236}-{'f1_val': 0.1417771333885667, 'auprc': 0.7142871185905753, 'loss_val': 1.282281899587083, 'psi': 0.37078112746937014}
[S3] START round=4 head_norm_before_train=1.242209 (no previous merge yet)
[S3] round=4 local utility u=0.035502 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.6134418845602702, 'loss_val': 1.1317713134130152, 'psi': 0.3292807931925723}-{'f1_val': 0.13984006561410703, 'auprc': 0.6168523857197534, 'loss_val': 1.2130064524489192, 'psi': 0.33064499365636557}
[S4] START round=4 head_norm_before_train=0.682646 cos_to_last_merge=1.0000 (last merge round=3)
[S4] round=4 local utility u=0.007188 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7640435709108683, 'loss_val': 1.221950380735098, 'psi': 0.38975340570145783}-{'f1_val': 0.14022662889518414, 'auprc': 0.7615106075898485, 'loss_val': 1.2287274323016368, 'psi': 0.3887402203730499}
[S5] START round=4 head_norm_before_train=0.689284 cos_to_last_merge=0.9955 (last merge round=2)
[S5] round=4 local utility u=0.013458 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7287428063721584, 'loss_val': 1.2610051317041424, 'psi': 0.3768542654060062}-{'f1_val': 0.14226190476190476, 'auprc': 0.7286378833211318, 'loss_val': 1.2876072110942647, 'psi': 0.3768122961855956}
[S6] START round=4 head_norm_before_train=1.228708 (no previous merge yet)
[S6] round=4 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.841354724169901, 'loss_val': 1.2194266751488998, 'psi': 0.4213976588987296}-{'f1_val': 0.14142628205128205, 'auprc': 0.8560487602312368, 'loss_val': 1.2565205376544175, 'psi': 0.4272752733232639}
[S7] START round=4 head_norm_before_train=1.220703 (no previous merge yet)
[S7] round=4 local utility u=0.019372 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7945166870888526, 'loss_val': 1.2364120771886538, 'psi': 0.403040768472996}-{'f1_val': 0.14205682272909165, 'auprc': 0.7893022405648439, 'loss_val': 1.259511774488234, 'psi': 0.40095498986339256}
[S8] START round=4 head_norm_before_train=0.903697 cos_to_last_merge=0.9893 (last merge round=1)
[S8] round=4 local utility u=0.000000 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.6553719841545361, 'loss_val': 1.262780611925225, 'psi': 0.3461223830975888}-{'f1_val': 0.4228440820360761, 'auprc': 0.658158203145899, 'loss_val': 1.3090310144733872, 'psi': 0.5169697304800053}
[S9] START round=4 head_norm_before_train=0.967327 cos_to_last_merge=0.9976 (last merge round=2)
[S9] round=4 local utility u=0.031938 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8023400825613867, 'loss_val': 1.1816395580652754, 'psi': 0.4057748073085523}-{'f1_val': 0.141397957139996, 'auprc': 0.8018853961073198, 'loss_val': 1.244150949867951, 'psi': 0.40559293272692554}
[S10] START round=4 head_norm_before_train=0.907569 cos_to_last_merge=1.0000 (last merge round=3)
[S10] round=4 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.614639529710964, 'loss_val': 1.23771348214979, 'psi': 0.32902879440942}-{'f1_val': 0.13862163754172394, 'auprc': 0.6174268460395013, 'loss_val': 1.2441826427129632, 'psi': 0.3301437209408349}
[S11] START round=4 head_norm_before_train=0.873056 cos_to_last_merge=1.0000 (last merge round=3)
[S11] round=4 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.741127024894072, 'loss_val': 1.2820604915328566, 'psi': 0.38069901998149513}-{'f1_val': 0.14041368337311058, 'auprc': 0.7454212004112584, 'loss_val': 1.2730260769150201, 'psi': 0.3824166901883697}
[S13] START round=4 head_norm_before_train=0.933709 cos_to_last_merge=0.9920 (last merge round=1)
[S13] round=4 local utility u=0.015078 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7133785558486425, 'loss_val': 1.2455959368020588, 'psi': 0.3695828798856889}-{'f1_val': 0.1403857625770531, 'auprc': 0.7123811711561814, 'loss_val': 1.2727599647353869, 'psi': 0.3691839260087044}
[S14] START round=4 head_norm_before_train=1.251449 (no previous merge yet)
[S14] round=4 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8107192069187984, 'loss_val': 1.2164486539995603, 'psi': 0.40850239449714165}-{'f1_val': 0.14035785288270378, 'auprc': 0.8667452805567758, 'loss_val': 1.2674024490618807, 'psi': 0.4309128239523326}
[S15] START round=4 head_norm_before_train=1.207012 (no previous merge yet)
[S15] round=4 local utility u=0.037589 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7696512405295071, 'loss_val': 1.2503066084081706, 'psi': 0.39170068702873784}-{'f1_val': 0.13973365136155833, 'auprc': 0.7580614932321579, 'loss_val': 1.2907149963343851, 'psi': 0.38706478810979816}
[S16] START round=4 head_norm_before_train=0.787670 cos_to_last_merge=1.0000 (last merge round=3)
[S16] round=4 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.6275959759333342, 'loss_val': 1.242861274266507, 'psi': 0.3354208604928556}-{'f1_val': 0.14063745019920318, 'auprc': 0.6592128632985349, 'loss_val': 1.2543529965107214, 'psi': 0.34806761543893583}
[S17] START round=4 head_norm_before_train=0.635275 cos_to_last_merge=0.9920 (last merge round=2)
[S17] round=4 local utility u=0.017923 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5585447432337249, 'loss_val': 1.183123196270213, 'psi': 0.3079872752839206}-{'f1_val': 0.14094896331738438, 'auprc': 0.5785749437364842, 'loss_val': 1.2790590674679942, 'psi': 0.31599935548502434}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:49102
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:49108
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S5] → sending delta(kind=head bytes=1792) to S16@127.0.0.1:49116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:49104
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S7] → sending delta(kind=head bytes=1791) to S16@127.0.0.1:49116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1784 reason=None
[S9] → sending delta(kind=head bytes=1784) to S6@127.0.0.1:49107
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S13] → sending delta(kind=head bytes=1791) to S11@127.0.0.1:49112
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1803 to 1 peers)
[S9] sending update (kind=head size=1784 to 1 peers)
[S7] sending update (kind=head size=1791 to 1 peers)
[S13] sending update (kind=head size=1791 to 1 peers)
[S5] sending update (kind=head size=1792 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1791) from S7
[S16] cosine check vs S7: cos=0.4046
[S16] RECEIVED delta(kind=head bytes=1792) from S5
[S16] cosine check vs S5: cos=0.6316
[S7] RECEIVED delta(kind=head bytes=1803) from S4
[S7] cosine check vs S4: cos=0.0646
[S11] RECEIVED delta(kind=head bytes=1791) from S13
[S11] cosine check vs S13: cos=-0.0287
[S11] DROPPED delta from S13 (cos=-0.0287 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1784) from S9
[S6] cosine check vs S9: cos=-0.0539
[S6] DROPPED delta from S9 (cos=-0.0539 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1799) from S3
[S4] cosine check vs S3: cos=0.0022
[S2] RECEIVED delta(kind=head bytes=1798) from S15
[S2] cosine check vs S15: cos=-0.1604
[S2] DROPPED delta from S15 (cos=-0.1604 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:49104
[S17] sending update (kind=head size=1800 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1800) from S17
[S4] cosine check vs S17: cos=0.4864
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=4 metric=0.1421 head_norm=1.244362
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.988817e-01
[S7] stored merged vector for next round verification (round=4)
[S7] DEBUG after merge:  round=4 metric=0.1421 head_norm=0.739230 delta_norm=0.698882
[S7] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=4 metric=0.1402 head_norm=0.722050
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.712589e-01
[S4] stored merged vector for next round verification (round=4)
[S4] DEBUG after merge:  round=4 metric=0.1510 head_norm=0.584698 delta_norm=0.471259
[S4] aggregate: ACCEPT kept=['S3', 'S17'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=4 metric=0.1406 head_norm=0.822549
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.349788e-01
[S16] stored merged vector for next round verification (round=4)
[S16] DEBUG after merge:  round=4 metric=0.1406 head_norm=0.710374 delta_norm=0.334979
[S16] aggregate: ACCEPT kept=['S7', 'S5'] (k=2/2) mode=median trim_p=0.1
[S2] START round=5 head_norm_before_train=0.770129 cos_to_last_merge=0.9791 (last merge round=2)
[S2] round=5 local utility u=0.138251 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6826574669744259, 'loss_val': 1.1538094792897546, 'psi': 0.3581292668229104}-{'f1_val': 0.1417771333885667, 'auprc': 0.6107974617943808, 'loss_val': 1.2147319555129232, 'psi': 0.32938526475089236}
[S3] START round=5 head_norm_before_train=1.275754 (no previous merge yet)
[S3] round=5 local utility u=1.000000 metrics={'f1_val': 0.41934555104902105, 'auprc': 0.7944705740421982, 'loss_val': 0.9896038991376679, 'psi': 0.5693955602462919}-{'f1_val': 0.13984006561410703, 'auprc': 0.6134418845602702, 'loss_val': 1.1317713134130152, 'psi': 0.3292807931925723}
[S4] START round=5 head_norm_before_train=0.584698 cos_to_last_merge=1.0000 (last merge round=4)
[S4] round=5 local utility u=0.010869 metrics={'f1_val': 0.14227002855198964, 'auprc': 0.7642622033054249, 'loss_val': 1.2131295425682274, 'psi': 0.3910668984533638}-{'f1_val': 0.14022662889518414, 'auprc': 0.7640435709108683, 'loss_val': 1.221950380735098, 'psi': 0.38975340570145783}
[S5] START round=5 head_norm_before_train=0.713490 cos_to_last_merge=0.9859 (last merge round=2)
[S5] round=5 local utility u=0.032020 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7364835630062458, 'loss_val': 1.2201871357061667, 'psi': 0.3799505680596412}-{'f1_val': 0.14226190476190476, 'auprc': 0.7287428063721584, 'loss_val': 1.2610051317041424, 'psi': 0.3768542654060062}
[S6] START round=5 head_norm_before_train=1.248160 (no previous merge yet)
[S6] round=5 local utility u=0.092849 metrics={'f1_val': 0.16387093217355533, 'auprc': 0.839611575676221, 'loss_val': 1.1631663557113185, 'psi': 0.43416718957462164}-{'f1_val': 0.14142628205128205, 'auprc': 0.841354724169901, 'loss_val': 1.2194266751488998, 'psi': 0.4213976588987296}
[S7] START round=5 head_norm_before_train=0.739230 cos_to_last_merge=1.0000 (last merge round=4)
[S7] round=5 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7669930945844602, 'loss_val': 1.2376307073287605, 'psi': 0.3920313314712391}-{'f1_val': 0.14205682272909165, 'auprc': 0.7945166870888526, 'loss_val': 1.2364120771886538, 'psi': 0.403040768472996}
[S8] START round=5 head_norm_before_train=0.938588 cos_to_last_merge=0.9793 (last merge round=1)
[S8] round=5 local utility u=0.120720 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7176424385782947, 'loss_val': 1.2081529050766902, 'psi': 0.3710305648670922}-{'f1_val': 0.13995598239295717, 'auprc': 0.6553719841545361, 'loss_val': 1.262780611925225, 'psi': 0.3461223830975888}
[S9] START round=5 head_norm_before_train=1.004779 cos_to_last_merge=0.9916 (last merge round=2)
[S9] round=5 local utility u=0.044043 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8026283456842367, 'loss_val': 1.0944184343246768, 'psi': 0.4058901125576923}-{'f1_val': 0.141397957139996, 'auprc': 0.8023400825613867, 'loss_val': 1.1816395580652754, 'psi': 0.4057748073085523}
[S10] START round=5 head_norm_before_train=0.932953 cos_to_last_merge=0.9981 (last merge round=3)
[S10] round=5 local utility u=0.033555 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6101560397792831, 'loss_val': 1.1571531458600577, 'psi': 0.32723539843674765}-{'f1_val': 0.13862163754172394, 'auprc': 0.614639529710964, 'loss_val': 1.23771348214979, 'psi': 0.32902879440942}
[S11] START round=5 head_norm_before_train=0.893283 cos_to_last_merge=0.9974 (last merge round=3)
[S11] round=5 local utility u=0.031879 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7483976063187564, 'loss_val': 1.2401150404056427, 'psi': 0.3836072525513689}-{'f1_val': 0.14041368337311058, 'auprc': 0.741127024894072, 'loss_val': 1.2820604915328566, 'psi': 0.38069901998149513}
[S13] START round=5 head_norm_before_train=0.952486 cos_to_last_merge=0.9863 (last merge round=1)
[S13] round=5 local utility u=0.036080 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7239223512504647, 'loss_val': 1.205067502523815, 'psi': 0.37380039804641774}-{'f1_val': 0.1403857625770531, 'auprc': 0.7133785558486425, 'loss_val': 1.2455959368020588, 'psi': 0.3695828798856889}
[S14] START round=5 head_norm_before_train=1.283398 (no previous merge yet)
[S14] round=5 local utility u=0.043884 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8098802362173163, 'loss_val': 1.1261642553955713, 'psi': 0.40816680621654877}-{'f1_val': 0.14035785288270378, 'auprc': 0.8107192069187984, 'loss_val': 1.2164486539995603, 'psi': 0.40850239449714165}
[S15] START round=5 head_norm_before_train=1.238150 (no previous merge yet)
[S15] round=5 local utility u=0.045790 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.782806313593376, 'loss_val': 1.1981928233456698, 'psi': 0.3969627162542854}-{'f1_val': 0.13973365136155833, 'auprc': 0.7696512405295071, 'loss_val': 1.2503066084081706, 'psi': 0.39170068702873784}
[S16] START round=5 head_norm_before_train=0.710374 cos_to_last_merge=1.0000 (last merge round=4)
[S16] round=5 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.4421308870572386, 'loss_val': 1.2116930089150366, 'psi': 0.26123482494241734}-{'f1_val': 0.14063745019920318, 'auprc': 0.6275959759333342, 'loss_val': 1.242861274266507, 'psi': 0.3354208604928556}
[S17] START round=5 head_norm_before_train=0.676444 cos_to_last_merge=0.9710 (last merge round=2)
[S17] round=5 local utility u=0.395817 metrics={'f1_val': 0.24382857248922887, 'auprc': 0.5752375429872667, 'loss_val': 1.0588449526813282, 'psi': 0.376392160688444}-{'f1_val': 0.14094896331738438, 'auprc': 0.5585447432337249, 'loss_val': 1.183123196270213, 'psi': 0.3079872752839206}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:49102
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] → sending delta(kind=head bytes=1792) to S6@127.0.0.1:49107
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:49116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:49103
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:49110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:49111
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:49116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:49112
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S8] → sending delta(kind=head bytes=1792) to S13@127.0.0.1:49113
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:49108
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:49112
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] → sending delta(kind=head bytes=1793) to S4@127.0.0.1:49104
[S9] sending update (kind=head size=1792 to 1 peers)
[S3] sending update (kind=head size=1793 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1795 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1792 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1795) from S6
[S11] cosine check vs S6: cos=0.6628
[S10] RECEIVED delta(kind=head bytes=1800) from S14
[S10] cosine check vs S14: cos=0.6884
[S7] RECEIVED delta(kind=head bytes=1799) from S4
[S7] cosine check vs S4: cos=0.4145
[S16] RECEIVED delta(kind=head bytes=1799) from S5
[S16] cosine check vs S5: cos=0.6535
[S16] RECEIVED delta(kind=head bytes=1801) from S11
[S16] cosine check vs S11: cos=0.0172
[S6] RECEIVED delta(kind=head bytes=1792) from S9
[S6] cosine check vs S9: cos=-0.0529
[S6] DROPPED delta from S9 (cos=-0.0529 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1795) from S10
[S3] cosine check vs S10: cos=-0.0148
[S3] DROPPED delta from S10 (cos=-0.0148 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1793) from S3
[S4] cosine check vs S3: cos=0.5508
[S11] RECEIVED delta(kind=head bytes=1796) from S13
[S11] cosine check vs S13: cos=-0.0272
[S11] DROPPED delta from S13 (cos=-0.0272 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1798) from S2
[S9] cosine check vs S2: cos=-0.0086
[S9] DROPPED delta from S2 (cos=-0.0086 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1792) from S8
[S13] cosine check vs S8: cos=-0.0043
[S13] DROPPED delta from S8 (cos=-0.0043 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1795) from S15
[S2] cosine check vs S15: cos=-0.1591
[S2] DROPPED delta from S15 (cos=-0.1591 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] → sending delta(kind=head bytes=1794) to S4@127.0.0.1:49104
[S17] sending update (kind=head size=1794 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1794) from S17
[S4] cosine check vs S17: cos=0.6497
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=5 metric=0.1421 head_norm=0.763561
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.785325e-01
[S7] stored merged vector for next round verification (round=5)
[S7] DEBUG after merge:  round=5 metric=0.1421 head_norm=0.581895 delta_norm=0.378532
[S7] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.372 → S16@127.0.0.1:49116
[S13] ⇄ pheromone p=0.367 → S11@127.0.0.1:49112
[S5] ⇄ pheromone p=0.372 → S16@127.0.0.1:49116
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=5 metric=0.1386 head_norm=0.971173
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.789128e-01
[S10] stored merged vector for next round verification (round=5)
[S10] DEBUG after merge:  round=5 metric=0.1386 head_norm=1.053627 delta_norm=0.478913
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.338 → S3@127.0.0.1:49103
[S8] ⇄ pheromone p=0.449 → S13@127.0.0.1:49113
[S6] ⇄ pheromone p=0.356 → S11@127.0.0.1:49112
[S15] ⇄ pheromone p=0.430 → S2@127.0.0.1:49102
[S2] ⇄ pheromone p=0.355 → S9@127.0.0.1:49110
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=5 metric=0.1423 head_norm=0.617051
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.721746e-01
[S4] stored merged vector for next round verification (round=5)
[S4] DEBUG after merge:  round=5 metric=0.4142 head_norm=0.664338 delta_norm=0.272175
[S4] aggregate: ACCEPT kept=['S3', 'S17'] (k=2/2) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.385 → S7@127.0.0.1:49108
[S14] ⇄ pheromone p=0.364 → S10@127.0.0.1:49111
[S3] ⇄ pheromone p=0.537 → S4@127.0.0.1:49104
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=5 metric=0.1404 head_norm=0.915936
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.783996e-01
[S11] stored merged vector for next round verification (round=5)
[S11] DEBUG after merge:  round=5 metric=0.1404 head_norm=1.001266 delta_norm=0.478400
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.334 → S16@127.0.0.1:49116
[S9] ⇄ pheromone p=0.354 → S6@127.0.0.1:49107
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=5 metric=0.1406 head_norm=0.741639
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.719534e-01
[S16] stored merged vector for next round verification (round=5)
[S16] DEBUG after merge:  round=5 metric=0.1406 head_norm=0.568034 delta_norm=0.371953
[S16] aggregate: ACCEPT kept=['S5', 'S11'] (k=2/2) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.362 → S10@127.0.0.1:49111
[S17] ⇄ pheromone p=0.415 → S4@127.0.0.1:49104
[S2] START round=6 head_norm_before_train=0.796930 cos_to_last_merge=0.9655 (last merge round=2)
[S2] round=6 local utility u=1.000000 metrics={'f1_val': 0.4165165486077186, 'auprc': 0.7753086270751838, 'loss_val': 1.0751727932444168, 'psi': 0.5600333799947047}-{'f1_val': 0.1417771333885667, 'auprc': 0.6826574669744259, 'loss_val': 1.1538094792897546, 'psi': 0.3581292668229104}
[S3] START round=6 head_norm_before_train=1.312376 (no previous merge yet)
[S3] round=6 local utility u=0.023652 metrics={'f1_val': 0.4010090932274478, 'auprc': 0.7961502497686404, 'loss_val': 0.8373211221913847, 'psi': 0.5590655558439248}-{'f1_val': 0.41934555104902105, 'auprc': 0.7944705740421982, 'loss_val': 0.9896038991376679, 'psi': 0.5693955602462919}
[S4] START round=6 head_norm_before_train=0.664338 cos_to_last_merge=1.0000 (last merge round=5)
[S4] round=6 local utility u=0.009841 metrics={'f1_val': 0.14159059035220026, 'auprc': 0.7602997619727829, 'loss_val': 1.1774840909975215, 'psi': 0.38907425900043335}-{'f1_val': 0.14227002855198964, 'auprc': 0.7642622033054249, 'loss_val': 1.2131295425682274, 'psi': 0.3910668984533638}
[S5] START round=6 head_norm_before_train=0.736424 cos_to_last_merge=0.9760 (last merge round=2)
[S5] round=6 local utility u=0.082273 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7712026790469567, 'loss_val': 1.1597983914809338, 'psi': 0.39383821447592554}-{'f1_val': 0.14226190476190476, 'auprc': 0.7364835630062458, 'loss_val': 1.2201871357061667, 'psi': 0.3799505680596412}
[S6] START round=6 head_norm_before_train=1.274308 (no previous merge yet)
[S6] round=6 local utility u=0.835661 metrics={'f1_val': 0.4168551858772006, 'auprc': 0.8495215520063424, 'loss_val': 1.039479495748869, 'psi': 0.5899217323288574}-{'f1_val': 0.16387093217355533, 'auprc': 0.839611575676221, 'loss_val': 1.1631663557113185, 'psi': 0.43416718957462164}
[S7] START round=6 head_norm_before_train=0.581895 cos_to_last_merge=1.0000 (last merge round=5)
[S7] round=6 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.5877839153062192, 'loss_val': 1.2420481270578239, 'psi': 0.32034765975994267}-{'f1_val': 0.14205682272909165, 'auprc': 0.7669930945844602, 'loss_val': 1.2376307073287605, 'psi': 0.3920313314712391}
[S8] START round=6 head_norm_before_train=0.980356 cos_to_last_merge=0.9670 (last merge round=1)
[S8] round=6 local utility u=1.000000 metrics={'f1_val': 0.4822344463731397, 'auprc': 0.7660130701820866, 'loss_val': 1.1221631673755361, 'psi': 0.5957458958967186}-{'f1_val': 0.13995598239295717, 'auprc': 0.7176424385782947, 'loss_val': 1.2081529050766902, 'psi': 0.3710305648670922}
[S9] START round=6 head_norm_before_train=1.032793 cos_to_last_merge=0.9860 (last merge round=2)
[S9] round=6 local utility u=0.888333 metrics={'f1_val': 0.4165724968026165, 'auprc': 0.8026937635475924, 'loss_val': 0.9689960501437669, 'psi': 0.5710210035006068}-{'f1_val': 0.141397957139996, 'auprc': 0.8026283456842367, 'loss_val': 1.0944184343246768, 'psi': 0.4058901125576923}
[S10] START round=6 head_norm_before_train=1.053627 cos_to_last_merge=1.0000 (last merge round=5)
[S10] round=6 local utility u=0.027871 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6095040297843461, 'loss_val': 1.0994555048683394, 'psi': 0.32697459443877286}-{'f1_val': 0.13862163754172394, 'auprc': 0.6101560397792831, 'loss_val': 1.1571531458600577, 'psi': 0.32723539843674765}
[S11] START round=6 head_norm_before_train=1.001266 cos_to_last_merge=1.0000 (last merge round=5)
[S11] round=6 local utility u=0.018029 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7532523887393451, 'loss_val': 1.2186212744428044, 'psi': 0.3855491655196044}-{'f1_val': 0.14041368337311058, 'auprc': 0.7483976063187564, 'loss_val': 1.2401150404056427, 'psi': 0.3836072525513689}
[S13] START round=6 head_norm_before_train=0.972820 cos_to_last_merge=0.9798 (last merge round=1)
[S13] round=6 local utility u=0.219047 metrics={'f1_val': 0.19838881464245253, 'auprc': 0.732576326759888, 'loss_val': 1.1409543584542727, 'psi': 0.4120638194894267}-{'f1_val': 0.1403857625770531, 'auprc': 0.7239223512504647, 'loss_val': 1.205067502523815, 'psi': 0.37380039804641774}
[S14] START round=6 head_norm_before_train=1.317497 (no previous merge yet)
[S14] round=6 local utility u=0.986545 metrics={'f1_val': 0.39652757107859105, 'auprc': 0.9137212307996638, 'loss_val': 1.0016159488753607, 'psi': 0.6034050349670201}-{'f1_val': 0.14035785288270378, 'auprc': 0.8098802362173163, 'loss_val': 1.1261642553955713, 'psi': 0.40816680621654877}
[S15] START round=6 head_norm_before_train=1.274620 (no previous merge yet)
[S15] round=6 local utility u=1.000000 metrics={'f1_val': 0.5328391194440583, 'auprc': 0.7911507888164241, 'loss_val': 1.1135816649250543, 'psi': 0.6361637871930046}-{'f1_val': 0.13973365136155833, 'auprc': 0.782806313593376, 'loss_val': 1.1981928233456698, 'psi': 0.3969627162542854}
[S16] START round=6 head_norm_before_train=0.568034 cos_to_last_merge=1.0000 (last merge round=5)
[S16] round=6 local utility u=0.871065 metrics={'f1_val': 0.4150731431819776, 'auprc': 0.45161604480842593, 'loss_val': 1.1446322045287491, 'psi': 0.4296903038325569}-{'f1_val': 0.14063745019920318, 'auprc': 0.4421308870572386, 'loss_val': 1.2116930089150366, 'psi': 0.26123482494241734}
[S17] START round=6 head_norm_before_train=0.719561 cos_to_last_merge=0.9452 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.945
[S17] round=6 local utility u=0.565068 metrics={'f1_val': 0.3894191465836961, 'auprc': 0.6336365945258826, 'loss_val': 0.9774497881198696, 'psi': 0.48710612576057066}-{'f1_val': 0.24382857248922887, 'auprc': 0.5752375429872667, 'loss_val': 1.0588449526813282, 'psi': 0.376392160688444}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:49103
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:49116
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:49107
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:49110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:49102
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:49111
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:49112
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:49111
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:49112
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S7@127.0.0.1:49108
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S13@127.0.0.1:49113
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:49116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:49104
[S8] sending update (kind=head size=1793 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1794 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1794 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1795 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1802) from S16
[S10] cosine check vs S16: cos=0.1210
[S2] RECEIVED delta(kind=head bytes=1802) from S15
[S2] cosine check vs S15: cos=-0.1608
[S2] DROPPED delta from S15 (cos=-0.1608 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1797) from S14
[S10] cosine check vs S14: cos=0.9258
[S11] RECEIVED delta(kind=head bytes=1797) from S13
[S11] cosine check vs S13: cos=-0.0391
[S11] DROPPED delta from S13 (cos=-0.0391 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1801) from S3
[S4] cosine check vs S3: cos=0.7589
[S3] RECEIVED delta(kind=head bytes=1794) from S10
[S3] cosine check vs S10: cos=0.0010
[S13] RECEIVED delta(kind=head bytes=1793) from S8
[S13] cosine check vs S8: cos=0.0016
[S9] RECEIVED delta(kind=head bytes=1795) from S2
[S9] cosine check vs S2: cos=-0.0096
[S9] DROPPED delta from S2 (cos=-0.0096 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1799) from S6
[S11] cosine check vs S6: cos=0.9232
[S6] RECEIVED delta(kind=head bytes=1797) from S9
[S6] cosine check vs S9: cos=-0.0523
[S6] DROPPED delta from S9 (cos=-0.0523 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1796) from S11
[S16] cosine check vs S11: cos=0.3941
[S16] RECEIVED delta(kind=head bytes=1801) from S5
[S16] cosine check vs S5: cos=0.7726
[S7] RECEIVED delta(kind=head bytes=1794) from S4
[S7] cosine check vs S4: cos=0.6505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S17] → sending delta(kind=head bytes=1789) to S4@127.0.0.1:49104
[S17] sending update (kind=head size=1789 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1789) from S17
[S4] cosine check vs S17: cos=0.6335
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=6 metric=0.1421 head_norm=0.609226
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.731889e-01
[S7] stored merged vector for next round verification (round=6)
[S7] DEBUG after merge:  round=6 metric=0.1421 head_norm=0.588924 delta_norm=0.273189
[S7] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=6 metric=0.1386 head_norm=1.083457
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.636693e-01
[S10] stored merged vector for next round verification (round=6)
[S10] DEBUG after merge:  round=6 metric=0.1386 head_norm=0.889448 delta_norm=0.263669
[S10] aggregate: ACCEPT kept=['S16', 'S14'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=6 metric=0.4151 head_norm=0.605776
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.288175e-01
[S16] stored merged vector for next round verification (round=6)
[S16] DEBUG after merge:  round=6 metric=0.3253 head_norm=0.593430 delta_norm=0.228817
[S16] aggregate: ROLLBACK (f1_val pre=0.415 post=0.325 tol_abs=0.005 tol_rel=0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=6 metric=0.1404 head_norm=1.016462
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.723807e-01
[S11] stored merged vector for next round verification (round=6)
[S11] DEBUG after merge:  round=6 metric=0.1404 head_norm=1.144969 delta_norm=0.272381
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=6 metric=0.4010 head_norm=1.350169
[S3] _apply_head_vector_avg (torch): Δ‖w‖=8.651497e-01
[S3] stored merged vector for next round verification (round=6)
[S3] DEBUG after merge:  round=6 metric=0.4010 head_norm=0.865987 delta_norm=0.865150
[S3] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=6 metric=0.1984 head_norm=0.992666
[S13] _apply_head_vector_avg (torch): Δ‖w‖=7.077515e-01
[S13] stored merged vector for next round verification (round=6)
[S13] DEBUG after merge:  round=6 metric=0.4093 head_norm=0.708875 delta_norm=0.707752
[S13] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=6 metric=0.1416 head_norm=0.686856
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.813721e-01
[S4] stored merged vector for next round verification (round=6)
[S4] DEBUG after merge:  round=6 metric=0.3797 head_norm=0.743616 delta_norm=0.181372
[S4] aggregate: ACCEPT kept=['S3', 'S17'] (k=2/2) mode=median trim_p=0.1
[S2] START round=7 head_norm_before_train=0.829789 cos_to_last_merge=0.9498 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.950
[S2] round=7 local utility u=0.045933 metrics={'f1_val': 0.4168583781965898, 'auprc': 0.7749521525704206, 'loss_val': 0.9842888190469665, 'psi': 0.5600958879461221}-{'f1_val': 0.4165165486077186, 'auprc': 0.7753086270751838, 'loss_val': 1.0751727932444168, 'psi': 0.5600333799947047}
[S3] START round=7 head_norm_before_train=0.865987 cos_to_last_merge=1.0000 (last merge round=6)
[S3] round=7 local utility u=0.016464 metrics={'f1_val': 0.40375458928096164, 'auprc': 0.7955203461201461, 'loss_val': 0.8189773383139051, 'psi': 0.5604608920166354}-{'f1_val': 0.4010090932274478, 'auprc': 0.7961502497686404, 'loss_val': 0.8373211221913847, 'psi': 0.5590655558439248}
[S4] START round=7 head_norm_before_train=0.743616 cos_to_last_merge=1.0000 (last merge round=6)
[S4] round=7 local utility u=0.875055 metrics={'f1_val': 0.4150135411368775, 'auprc': 0.7663746561119879, 'loss_val': 1.0861359393634014, 'psi': 0.5555579871269216}-{'f1_val': 0.14159059035220026, 'auprc': 0.7602997619727829, 'loss_val': 1.1774840909975215, 'psi': 0.38907425900043335}
[S5] START round=7 head_norm_before_train=0.762640 cos_to_last_merge=0.9645 (last merge round=2)
[S5] round=7 local utility u=0.864392 metrics={'f1_val': 0.4177505557824055, 'auprc': 0.7778127735488581, 'loss_val': 1.1037772224730935, 'psi': 0.5617754428889865}-{'f1_val': 0.14226190476190476, 'auprc': 0.7712026790469567, 'loss_val': 1.1597983914809338, 'psi': 0.39383821447592554}
[S6] START round=7 head_norm_before_train=1.317990 (no previous merge yet)
[S6] round=7 local utility u=0.098053 metrics={'f1_val': 0.4168551858772006, 'auprc': 0.8687769300682952, 'loss_val': 0.9011394244265768, 'psi': 0.5976238835536385}-{'f1_val': 0.4168551858772006, 'auprc': 0.8495215520063424, 'loss_val': 1.039479495748869, 'psi': 0.5899217323288574}
[S7] START round=7 head_norm_before_train=0.588924 cos_to_last_merge=1.0000 (last merge round=6)
[S7] round=7 local utility u=0.026177 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.5908099800212223, 'loss_val': 1.1987718724412775, 'psi': 0.3215580856459439}-{'f1_val': 0.14205682272909165, 'auprc': 0.5877839153062192, 'loss_val': 1.2420481270578239, 'psi': 0.32034765975994267}
[S8] START round=7 head_norm_before_train=1.010666 cos_to_last_merge=0.9591 (last merge round=1)
[S8] round=7 local utility u=0.771487 metrics={'f1_val': 0.71525550077189, 'auprc': 0.7670606454247446, 'loss_val': 0.9804574505056413, 'psi': 0.7359775586330319}-{'f1_val': 0.4822344463731397, 'auprc': 0.7660130701820866, 'loss_val': 1.1221631673755361, 'psi': 0.5957458958967186}
[S9] START round=7 head_norm_before_train=1.063390 cos_to_last_merge=0.9798 (last merge round=2)
[S9] round=7 local utility u=0.000000 metrics={'f1_val': 0.41685404846439245, 'auprc': 0.7104085769379532, 'loss_val': 0.8177984896483882, 'psi': 0.5342758598538168}-{'f1_val': 0.4165724968026165, 'auprc': 0.8026937635475924, 'loss_val': 0.9689960501437669, 'psi': 0.5710210035006068}
[S10] START round=7 head_norm_before_train=0.889448 cos_to_last_merge=1.0000 (last merge round=6)
[S10] round=7 local utility u=1.000000 metrics={'f1_val': 0.43660842300994535, 'auprc': 0.7363503870913832, 'loss_val': 1.0280737598951968, 'psi': 0.5565052086425205}-{'f1_val': 0.13862163754172394, 'auprc': 0.6095040297843461, 'loss_val': 1.0994555048683394, 'psi': 0.32697459443877286}
[S11] START round=7 head_norm_before_train=1.144969 cos_to_last_merge=1.0000 (last merge round=6)
[S11] round=7 local utility u=0.039271 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7595500461091844, 'loss_val': 1.1589717807495095, 'psi': 0.38806822846754013}-{'f1_val': 0.14041368337311058, 'auprc': 0.7532523887393451, 'loss_val': 1.2186212744428044, 'psi': 0.3855491655196044}
[S13] START round=7 head_norm_before_train=0.708875 cos_to_last_merge=1.0000 (last merge round=6)
[S13] round=7 local utility u=0.702708 metrics={'f1_val': 0.41643344272875704, 'auprc': 0.7629067959313809, 'loss_val': 1.1347970104829297, 'psi': 0.5550227840098065}-{'f1_val': 0.19838881464245253, 'auprc': 0.732576326759888, 'loss_val': 1.1409543584542727, 'psi': 0.4120638194894267}
[S14] START round=7 head_norm_before_train=1.359654 (no previous merge yet)
[S14] round=7 local utility u=0.568494 metrics={'f1_val': 0.5179080195943557, 'auprc': 0.9788402911051517, 'loss_val': 0.788268197153539, 'psi': 0.7022809281986742}-{'f1_val': 0.39652757107859105, 'auprc': 0.9137212307996638, 'loss_val': 1.0016159488753607, 'psi': 0.6034050349670201}
[S15] START round=7 head_norm_before_train=1.303081 (no previous merge yet)
[S15] round=7 local utility u=0.321329 metrics={'f1_val': 0.6180063820671831, 'auprc': 0.79425386005918, 'loss_val': 0.9912370487483307, 'psi': 0.6885053732639819}-{'f1_val': 0.5328391194440583, 'auprc': 0.7911507888164241, 'loss_val': 1.1135816649250543, 'psi': 0.6361637871930046}
[S16] START round=7 head_norm_before_train=0.593430 cos_to_last_merge=1.0000 (last merge round=6)
[S16] round=7 local utility u=0.000000 metrics={'f1_val': 0.38745438899855206, 'auprc': 0.4442360720661508, 'loss_val': 1.1318262081807755, 'psi': 0.4101670622255915}-{'f1_val': 0.4150731431819776, 'auprc': 0.45161604480842593, 'loss_val': 1.1446322045287491, 'psi': 0.4296903038325569}
[S17] START round=7 head_norm_before_train=0.772944 cos_to_last_merge=0.9131 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.913
[S17] round=7 local utility u=0.000000 metrics={'f1_val': 0.3552306902587901, 'auprc': 0.6679715514246066, 'loss_val': 0.930619023238114, 'psi': 0.48032703472511673}-{'f1_val': 0.3894191465836961, 'auprc': 0.6336365945258826, 'loss_val': 0.9774497881198696, 'psi': 0.48710612576057066}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:49112
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:49116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:49112
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:49108
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S13@127.0.0.1:49113
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:49116
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:49104
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:49102
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] → sending delta(kind=head bytes=1804) to S10@127.0.0.1:49111
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:49110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S10] → sending delta(kind=head bytes=1789) to S3@127.0.0.1:49103
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:49116
[S14] sending update (kind=head size=1804 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1793 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1789 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1800) from S5
[S16] cosine check vs S5: cos=0.7531
[S10] RECEIVED delta(kind=head bytes=1804) from S14
[S10] cosine check vs S14: cos=0.9210
[S4] RECEIVED delta(kind=head bytes=1795) from S3
[S4] cosine check vs S3: cos=0.6267
[S2] RECEIVED delta(kind=head bytes=1802) from S15
[S2] cosine check vs S15: cos=-0.1629
[S2] DROPPED delta from S15 (cos=-0.1629 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1798) from S11
[S16] cosine check vs S11: cos=0.6072
[S11] RECEIVED delta(kind=head bytes=1798) from S6
[S11] cosine check vs S6: cos=0.9738
[S7] RECEIVED delta(kind=head bytes=1795) from S4
[S7] cosine check vs S4: cos=0.8333
[S3] RECEIVED delta(kind=head bytes=1789) from S10
[S3] cosine check vs S10: cos=0.5859
[S9] RECEIVED delta(kind=head bytes=1797) from S2
[S9] cosine check vs S2: cos=-0.0078
[S9] DROPPED delta from S2 (cos=-0.0078 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1797) from S13
[S11] cosine check vs S13: cos=-0.0792
[S11] DROPPED delta from S13 (cos=-0.0792 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1798) from S7
[S16] cosine check vs S7: cos=0.4098
[S13] RECEIVED delta(kind=head bytes=1793) from S8
[S13] cosine check vs S8: cos=0.6981
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=7 metric=0.1404 head_norm=1.159413
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.760610e-01
[S11] stored merged vector for next round verification (round=7)
[S11] DEBUG after merge:  round=7 metric=0.4229 head_norm=1.252874 delta_norm=0.176061
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=7 metric=0.4366 head_norm=0.921748
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.333040e-01
[S10] stored merged vector for next round verification (round=7)
[S10] DEBUG after merge:  round=7 metric=0.1872 head_norm=1.143937 delta_norm=0.333304
[S10] aggregate: ROLLBACK (f1_val pre=0.437 post=0.187 tol_abs=0.005 tol_rel=0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=7 metric=0.4150 head_norm=0.766255
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.675098e-01
[S4] stored merged vector for next round verification (round=7)
[S4] DEBUG after merge:  round=7 metric=0.4227 head_norm=0.755947 delta_norm=0.367510
[S4] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=7 metric=0.4164 head_norm=0.731339
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.751791e-01
[S13] stored merged vector for next round verification (round=7)
[S13] DEBUG after merge:  round=7 metric=0.4163 head_norm=0.822062 delta_norm=0.375179
[S13] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=7 metric=0.1421 head_norm=0.617727
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.120428e-01
[S7] stored merged vector for next round verification (round=7)
[S7] DEBUG after merge:  round=7 metric=0.1421 head_norm=0.662876 delta_norm=0.212043
[S7] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=7 metric=0.4038 head_norm=0.908786
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.164968e-01
[S3] stored merged vector for next round verification (round=7)
[S3] DEBUG after merge:  round=7 metric=0.4008 head_norm=0.815037 delta_norm=0.416497
[S3] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=7 metric=0.3875 head_norm=0.632615
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.718484e-01
[S16] stored merged vector for next round verification (round=7)
[S16] DEBUG after merge:  round=7 metric=0.3899 head_norm=0.561854 delta_norm=0.171848
[S16] aggregate: ACCEPT kept=['S5', 'S11', 'S7'] (k=3/3) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=0.872956 cos_to_last_merge=0.9309 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.931
[S2] round=8 local utility u=0.023546 metrics={'f1_val': 0.41622585620987596, 'auprc': 0.7752953464853609, 'loss_val': 0.9344322550416869, 'psi': 0.5598536523200699}-{'f1_val': 0.4168583781965898, 'auprc': 0.7749521525704206, 'loss_val': 0.9842888190469665, 'psi': 0.5600958879461221}
[S3] START round=8 head_norm_before_train=0.815037 cos_to_last_merge=1.0000 (last merge round=7)
[S3] round=8 local utility u=0.000000 metrics={'f1_val': 0.4010090932274478, 'auprc': 0.7948892556924437, 'loss_val': 0.8797028303271627, 'psi': 0.5585611582134462}-{'f1_val': 0.40375458928096164, 'auprc': 0.7955203461201461, 'loss_val': 0.8189773383139051, 'psi': 0.5604608920166354}
[S4] START round=8 head_norm_before_train=0.755947 cos_to_last_merge=1.0000 (last merge round=7)
[S4] round=8 local utility u=0.670325 metrics={'f1_val': 0.6828536289165243, 'auprc': 0.6647667743134001, 'loss_val': 1.047702966161155, 'psi': 0.6756188870752746}-{'f1_val': 0.4150135411368775, 'auprc': 0.7663746561119879, 'loss_val': 1.0861359393634014, 'psi': 0.5555579871269216}
[S5] START round=8 head_norm_before_train=0.785362 cos_to_last_merge=0.9544 (last merge round=2)
[S5] round=8 local utility u=0.050464 metrics={'f1_val': 0.41770847824441854, 'auprc': 0.7777348098422058, 'loss_val': 1.0023623200257814, 'psi': 0.5617190108835335}-{'f1_val': 0.4177505557824055, 'auprc': 0.7778127735488581, 'loss_val': 1.1037772224730935, 'psi': 0.5617754428889865}
[S6] START round=8 head_norm_before_train=1.362770 (no previous merge yet)
[S6] round=8 local utility u=1.000000 metrics={'f1_val': 0.6988964912039294, 'auprc': 0.9904895400937938, 'loss_val': 0.5863747933983168, 'psi': 0.8155337107598751}-{'f1_val': 0.4168551858772006, 'auprc': 0.8687769300682952, 'loss_val': 0.9011394244265768, 'psi': 0.5976238835536385}
[S7] START round=8 head_norm_before_train=0.662876 cos_to_last_merge=1.0000 (last merge round=7)
[S7] round=8 local utility u=0.029752 metrics={'f1_val': 0.1487601051252145, 'auprc': 0.5775280549563108, 'loss_val': 1.139642582281493, 'psi': 0.320267285057653}-{'f1_val': 0.14205682272909165, 'auprc': 0.5908099800212223, 'loss_val': 1.1987718724412775, 'psi': 0.3215580856459439}
[S8] START round=8 head_norm_before_train=1.047967 cos_to_last_merge=0.9492 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.949
[S8] round=8 local utility u=0.190588 metrics={'f1_val': 0.7017139222932179, 'auprc': 0.8305039568893907, 'loss_val': 0.7083618067476836, 'psi': 0.753229936131687}-{'f1_val': 0.71525550077189, 'auprc': 0.7670606454247446, 'loss_val': 0.9804574505056413, 'psi': 0.7359775586330319}
[S9] START round=8 head_norm_before_train=1.109213 cos_to_last_merge=0.9707 (last merge round=2)
[S9] round=8 local utility u=1.000000 metrics={'f1_val': 0.7017167946673312, 'auprc': 0.9999588457386003, 'loss_val': 0.61747699974028, 'psi': 0.8210136150958388}-{'f1_val': 0.41685404846439245, 'auprc': 0.7104085769379532, 'loss_val': 0.8177984896483882, 'psi': 0.5342758598538168}
[S10] START round=8 head_norm_before_train=1.143937 cos_to_last_merge=1.0000 (last merge round=7)
[S10] round=8 local utility u=0.000000 metrics={'f1_val': 0.3298360235456624, 'auprc': 0.7451594472991787, 'loss_val': 0.9364046338158276, 'psi': 0.49596539304706894}-{'f1_val': 0.43660842300994535, 'auprc': 0.7363503870913832, 'loss_val': 1.0280737598951968, 'psi': 0.5565052086425205}
[S11] START round=8 head_norm_before_train=1.252874 cos_to_last_merge=1.0000 (last merge round=7)
[S11] round=8 local utility u=0.845268 metrics={'f1_val': 0.39655223592620625, 'auprc': 0.7770411922545077, 'loss_val': 1.05774126558983, 'psi': 0.5487478184575268}-{'f1_val': 0.14041368337311058, 'auprc': 0.7595500461091844, 'loss_val': 1.1589717807495095, 'psi': 0.38806822846754013}
[S13] START round=8 head_norm_before_train=0.822062 cos_to_last_merge=1.0000 (last merge round=7)
[S13] round=8 local utility u=0.039273 metrics={'f1_val': 0.41592377599636055, 'auprc': 0.7643908453605198, 'loss_val': 1.0576458558298465, 'psi': 0.5553106037420242}-{'f1_val': 0.41643344272875704, 'auprc': 0.7629067959313809, 'loss_val': 1.1347970104829297, 'psi': 0.5550227840098065}
[S14] START round=8 head_norm_before_train=1.410584 (no previous merge yet)
[S14] round=8 local utility u=0.812648 metrics={'f1_val': 0.7440672942298658, 'auprc': 0.9970216965837915, 'loss_val': 0.5744711751009741, 'psi': 0.8452490551714361}-{'f1_val': 0.5179080195943557, 'auprc': 0.9788402911051517, 'loss_val': 0.788268197153539, 'psi': 0.7022809281986742}
[S15] START round=8 head_norm_before_train=1.339102 (no previous merge yet)
[S15] round=8 local utility u=0.380644 metrics={'f1_val': 0.7073262516232021, 'auprc': 0.7881133747550975, 'loss_val': 0.7474475232702421, 'psi': 0.7396411008759602}-{'f1_val': 0.6180063820671831, 'auprc': 0.79425386005918, 'loss_val': 0.9912370487483307, 'psi': 0.6885053732639819}
[S16] START round=8 head_norm_before_train=0.561854 cos_to_last_merge=1.0000 (last merge round=7)
[S16] round=8 local utility u=0.060327 metrics={'f1_val': 0.3997944456624903, 'auprc': 0.4454696159217973, 'loss_val': 1.0889127960900293, 'psi': 0.4180645137662131}-{'f1_val': 0.38745438899855206, 'auprc': 0.4442360720661508, 'loss_val': 1.1318262081807755, 'psi': 0.4101670622255915}
[S17] START round=8 head_norm_before_train=0.831144 cos_to_last_merge=0.8797 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.880
[S17] round=8 local utility u=0.000000 metrics={'f1_val': 0.3515489095253228, 'auprc': 0.6039530445203733, 'loss_val': 0.9369648900208609, 'psi': 0.452510563523343}-{'f1_val': 0.3552306902587901, 'auprc': 0.6679715514246066, 'loss_val': 0.930619023238114, 'psi': 0.48032703472511673}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:49108
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:49102
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:49111
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:49116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] → sending delta(kind=head bytes=1794) to S11@127.0.0.1:49112
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:49112
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:49116
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] → sending delta(kind=head bytes=1794) to S6@127.0.0.1:49107
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:49110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S8] → sending delta(kind=head bytes=1790) to S13@127.0.0.1:49113
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S11] → sending delta(kind=head bytes=1791) to S16@127.0.0.1:49116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] → sending delta(kind=head bytes=1804) to S10@127.0.0.1:49111
[S2] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1791 to 1 peers)
[S13] sending update (kind=head size=1794 to 1 peers)
[S8] sending update (kind=head size=1790 to 1 peers)
[S14] sending update (kind=head size=1804 to 1 peers)
[S9] sending update (kind=head size=1794 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1798) from S2
[S9] cosine check vs S2: cos=-0.0069
[S9] DROPPED delta from S2 (cos=-0.0069 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1797) from S15
[S2] cosine check vs S15: cos=-0.1655
[S2] DROPPED delta from S15 (cos=-0.1655 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1800) from S7
[S16] cosine check vs S7: cos=0.5434
[S11] RECEIVED delta(kind=head bytes=1796) from S6
[S11] cosine check vs S6: cos=0.9847
[S6] RECEIVED delta(kind=head bytes=1794) from S9
[S6] cosine check vs S9: cos=-0.0441
[S6] DROPPED delta from S9 (cos=-0.0441 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1794) from S13
[S11] cosine check vs S13: cos=-0.0837
[S11] DROPPED delta from S13 (cos=-0.0837 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1791) from S11
[S16] cosine check vs S11: cos=0.5589
[S10] RECEIVED delta(kind=head bytes=1804) from S14
[S10] cosine check vs S14: cos=0.9726
[S16] RECEIVED delta(kind=head bytes=1795) from S5
[S16] cosine check vs S5: cos=0.7666
[S13] RECEIVED delta(kind=head bytes=1790) from S8
[S13] cosine check vs S8: cos=0.9255
[S10] RECEIVED delta(kind=head bytes=1799) from S16
[S10] cosine check vs S16: cos=0.1017
[S7] RECEIVED delta(kind=head bytes=1799) from S4
[S7] cosine check vs S4: cos=0.8133
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=8 metric=0.3298 head_norm=1.176822
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.528929e-01
[S10] stored merged vector for next round verification (round=8)
[S10] DEBUG after merge:  round=8 metric=0.3053 head_norm=0.969952 delta_norm=0.252893
[S10] aggregate: ROLLBACK (f1_val pre=0.330 post=0.305 tol_abs=0.005 tol_rel=0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=8 metric=0.3966 head_norm=1.268969
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.352668e-01
[S11] stored merged vector for next round verification (round=8)
[S11] DEBUG after merge:  round=8 metric=0.3965 head_norm=1.332281 delta_norm=0.135267
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=8 metric=0.1488 head_norm=0.686947
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.277583e-01
[S7] stored merged vector for next round verification (round=8)
[S7] DEBUG after merge:  round=8 metric=0.1421 head_norm=0.697218 delta_norm=0.227758
[S7] aggregate: ROLLBACK (f1_val pre=0.149 post=0.142 tol_abs=0.005 tol_rel=0.0)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=8 metric=0.4159 head_norm=0.846824
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.212718e-01
[S13] stored merged vector for next round verification (round=8)
[S13] DEBUG after merge:  round=8 metric=0.4161 head_norm=0.949821 delta_norm=0.221272
[S13] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=8 metric=0.3998 head_norm=0.607859
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.328671e-01
[S16] stored merged vector for next round verification (round=8)
[S16] DEBUG after merge:  round=8 metric=0.4035 head_norm=0.578280 delta_norm=0.132867
[S16] aggregate: ACCEPT kept=['S7', 'S11', 'S5'] (k=3/3) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=0.923473 cos_to_last_merge=0.9103 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.910
[S2] round=9 local utility u=0.096989 metrics={'f1_val': 0.4332949229386599, 'auprc': 0.7756165187208165, 'loss_val': 0.8438321050055748, 'psi': 0.5702235612515225}-{'f1_val': 0.41622585620987596, 'auprc': 0.7752953464853609, 'loss_val': 0.9344322550416869, 'psi': 0.5598536523200699}
[S3] START round=9 head_norm_before_train=0.856152 cos_to_last_merge=0.9932 (last merge round=7)
[S3] round=9 local utility u=0.309200 metrics={'f1_val': 0.401708470248874, 'auprc': 0.9717728138209211, 'loss_val': 0.7961491023580948, 'psi': 0.6297342076776928}-{'f1_val': 0.4010090932274478, 'auprc': 0.7948892556924437, 'loss_val': 0.8797028303271627, 'psi': 0.5585611582134462}
[S4] START round=9 head_norm_before_train=0.777223 cos_to_last_merge=0.9901 (last merge round=7)
[S4] round=9 local utility u=0.007245 metrics={'f1_val': 0.6763252968734653, 'auprc': 0.6485182316580334, 'loss_val': 0.9452964442500975, 'psi': 0.6652024707872926}-{'f1_val': 0.6828536289165243, 'auprc': 0.6647667743134001, 'loss_val': 1.047702966161155, 'psi': 0.6756188870752746}
[S5] START round=9 head_norm_before_train=0.811649 cos_to_last_merge=0.9408 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.941
[S5] round=9 local utility u=0.041273 metrics={'f1_val': 0.4176671856330787, 'auprc': 0.7772738958393677, 'loss_val': 0.918186580250437, 'psi': 0.5615098697155942}-{'f1_val': 0.41770847824441854, 'auprc': 0.7777348098422058, 'loss_val': 1.0023623200257814, 'psi': 0.5617190108835335}
[S6] START round=9 head_norm_before_train=1.405794 (no previous merge yet)
[S6] round=9 local utility u=0.000000 metrics={'f1_val': 0.6175819349745525, 'auprc': 0.9454093160347611, 'loss_val': 0.5610123066875463, 'psi': 0.748712887398636}-{'f1_val': 0.6988964912039294, 'auprc': 0.9904895400937938, 'loss_val': 0.5863747933983168, 'psi': 0.8155337107598751}
[S7] START round=9 head_norm_before_train=0.697218 cos_to_last_merge=1.0000 (last merge round=8)
[S7] round=9 local utility u=0.819158 metrics={'f1_val': 0.41695504393391747, 'auprc': 0.5691680117012896, 'loss_val': 1.085416943002638, 'psi': 0.47784023104086637}-{'f1_val': 0.1487601051252145, 'auprc': 0.5775280549563108, 'loss_val': 1.139642582281493, 'psi': 0.320267285057653}
[S8] START round=9 head_norm_before_train=1.088637 cos_to_last_merge=0.9375 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.938
[S8] round=9 local utility u=0.393413 metrics={'f1_val': 0.7144610111876308, 'auprc': 0.9985715940079692, 'loss_val': 0.5022205637019997, 'psi': 0.8281052443157662}-{'f1_val': 0.7017139222932179, 'auprc': 0.8305039568893907, 'loss_val': 0.7083618067476836, 'psi': 0.753229936131687}
[S9] START round=9 head_norm_before_train=1.156805 cos_to_last_merge=0.9602 (last merge round=2)
[S9] round=9 local utility u=0.066280 metrics={'f1_val': 0.7015406642019387, 'auprc': 0.9997310924549277, 'loss_val': 0.4831769699155411, 'psi': 0.8208168355031343}-{'f1_val': 0.7017167946673312, 'auprc': 0.9999588457386003, 'loss_val': 0.61747699974028, 'psi': 0.8210136150958388}
[S10] START round=9 head_norm_before_train=0.969952 cos_to_last_merge=1.0000 (last merge round=8)
[S10] round=9 local utility u=0.589146 metrics={'f1_val': 0.4363896569219587, 'auprc': 0.891808392868346, 'loss_val': 0.8373811230912352, 'psi': 0.6185571513005137}-{'f1_val': 0.3298360235456624, 'auprc': 0.7451594472991787, 'loss_val': 0.9364046338158276, 'psi': 0.49596539304706894}
[S11] START round=9 head_norm_before_train=1.332281 cos_to_last_merge=1.0000 (last merge round=8)
[S11] round=9 local utility u=0.406734 metrics={'f1_val': 0.396484976660716, 'auprc': 0.9934742471356564, 'loss_val': 0.8931693351978973, 'psi': 0.6352806848506922}-{'f1_val': 0.39655223592620625, 'auprc': 0.7770411922545077, 'loss_val': 1.05774126558983, 'psi': 0.5487478184575268}
[S13] START round=9 head_norm_before_train=0.949821 cos_to_last_merge=1.0000 (last merge round=8)
[S13] round=9 local utility u=0.000000 metrics={'f1_val': 0.3980730532565541, 'auprc': 0.7281253132929196, 'loss_val': 1.0116656886225655, 'psi': 0.5300939572711003}-{'f1_val': 0.41592377599636055, 'auprc': 0.7643908453605198, 'loss_val': 1.0576458558298465, 'psi': 0.5553106037420242}
[S14] START round=9 head_norm_before_train=1.468567 (no previous merge yet)
[S14] round=9 local utility u=0.802799 metrics={'f1_val': 0.9917211200248336, 'auprc': 0.9929398892023119, 'loss_val': 0.44255077862697845, 'psi': 0.992208627695825}-{'f1_val': 0.7440672942298658, 'auprc': 0.9970216965837915, 'loss_val': 0.5744711751009741, 'psi': 0.8452490551714361}
[S15] START round=9 head_norm_before_train=1.385562 (no previous merge yet)
[S15] round=9 local utility u=0.138618 metrics={'f1_val': 0.6903645755253742, 'auprc': 0.8657301503954625, 'loss_val': 0.6012925114515446, 'psi': 0.7605108054734095}-{'f1_val': 0.7073262516232021, 'auprc': 0.7881133747550975, 'loss_val': 0.7474475232702421, 'psi': 0.7396411008759602}
[S16] START round=9 head_norm_before_train=0.578280 cos_to_last_merge=1.0000 (last merge round=8)
[S16] round=9 local utility u=0.000000 metrics={'f1_val': 0.35249002963425546, 'auprc': 0.5091869305917148, 'loss_val': 1.0350395771553682, 'psi': 0.4151687900172392}-{'f1_val': 0.3997944456624903, 'auprc': 0.4454696159217973, 'loss_val': 1.0889127960900293, 'psi': 0.4180645137662131}
[S17] START round=9 head_norm_before_train=0.884624 cos_to_last_merge=0.8505 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.851
[S17] round=9 local utility u=0.000000 metrics={'f1_val': 0.35125194739393545, 'auprc': 0.5858781101563795, 'loss_val': 0.9348421056722286, 'psi': 0.4451024124989131}-{'f1_val': 0.3515489095253228, 'auprc': 0.6039530445203733, 'loss_val': 0.9369648900208609, 'psi': 0.452510563523343}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:49107
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:49116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:49116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:49102
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] → sending delta(kind=head bytes=1794) to S4@127.0.0.1:49104
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] → sending delta(kind=head bytes=1805) to S9@127.0.0.1:49110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:49113
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:49111
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:49108
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S16@127.0.0.1:49116
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:49103
[S9] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1794 to 1 peers)
[S2] sending update (kind=head size=1805 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1794 to 1 peers)
[S10] sending update (kind=head size=1794 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1797) from S4
[S7] cosine check vs S4: cos=0.9350
[S16] RECEIVED delta(kind=head bytes=1802) from S7
[S16] cosine check vs S7: cos=0.5825
[S4] RECEIVED delta(kind=head bytes=1794) from S3
[S4] cosine check vs S3: cos=0.6980
[S9] RECEIVED delta(kind=head bytes=1805) from S2
[S9] cosine check vs S2: cos=-0.0072
[S9] DROPPED delta from S2 (cos=-0.0072 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1798) from S14
[S10] cosine check vs S14: cos=0.9445
[S3] RECEIVED delta(kind=head bytes=1794) from S10
[S3] cosine check vs S10: cos=0.8055
[S13] RECEIVED delta(kind=head bytes=1800) from S8
[S13] cosine check vs S8: cos=0.9659
[S16] RECEIVED delta(kind=head bytes=1799) from S5
[S16] cosine check vs S5: cos=0.7535
[S2] RECEIVED delta(kind=head bytes=1802) from S15
[S2] cosine check vs S15: cos=-0.1694
[S2] DROPPED delta from S15 (cos=-0.1694 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1794) from S11
[S16] cosine check vs S11: cos=0.5359
[S6] RECEIVED delta(kind=head bytes=1797) from S9
[S6] cosine check vs S9: cos=-0.0399
[S6] DROPPED delta from S9 (cos=-0.0399 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=9 metric=0.3981 head_norm=0.971629
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.587496e-01
[S13] stored merged vector for next round verification (round=9)
[S13] DEBUG after merge:  round=9 metric=0.4339 head_norm=1.042837 delta_norm=0.158750
[S13] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=9 metric=0.4170 head_norm=0.719701
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.464373e-01
[S7] stored merged vector for next round verification (round=9)
[S7] DEBUG after merge:  round=9 metric=0.1421 head_norm=0.755532 delta_norm=0.146437
[S7] aggregate: ROLLBACK (f1_val pre=0.417 post=0.142 tol_abs=0.005 tol_rel=0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=9 metric=0.4364 head_norm=1.011312
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.299188e-01
[S10] stored merged vector for next round verification (round=9)
[S10] DEBUG after merge:  round=9 metric=0.2465 head_norm=1.251237 delta_norm=0.329919
[S10] aggregate: ROLLBACK (f1_val pre=0.436 post=0.246 tol_abs=0.005 tol_rel=0.0)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=9 metric=0.4017 head_norm=0.908768
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.033426e-01
[S3] stored merged vector for next round verification (round=9)
[S3] DEBUG after merge:  round=9 metric=0.4017 head_norm=0.912299 delta_norm=0.303343
[S3] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=9 metric=0.6763 head_norm=0.816442
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.379028e-01
[S4] stored merged vector for next round verification (round=9)
[S4] DEBUG after merge:  round=9 metric=0.6784 head_norm=0.795009 delta_norm=0.337903
[S4] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=9 metric=0.3525 head_norm=0.628541
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.182519e-01
[S16] stored merged vector for next round verification (round=9)
[S16] DEBUG after merge:  round=9 metric=0.3520 head_norm=0.600811 delta_norm=0.118252
[S16] aggregate: ACCEPT kept=['S7', 'S5', 'S11'] (k=3/3) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=0.973296 cos_to_last_merge=0.8917 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.892
[S2] round=10 local utility u=0.094600 metrics={'f1_val': 0.4693667390147714, 'auprc': 0.7735955927861053, 'loss_val': 0.8650004054597665, 'psi': 0.591058280523305}-{'f1_val': 0.4332949229386599, 'auprc': 0.7756165187208165, 'loss_val': 0.8438321050055748, 'psi': 0.5702235612515225}
[S3] START round=10 head_norm_before_train=0.912299 cos_to_last_merge=1.0000 (last merge round=9)
[S3] round=10 local utility u=0.400412 metrics={'f1_val': 0.6161615825939625, 'auprc': 0.7955379742433262, 'loss_val': 0.7533395890408441, 'psi': 0.687912139253708}-{'f1_val': 0.401708470248874, 'auprc': 0.9717728138209211, 'loss_val': 0.7961491023580948, 'psi': 0.6297342076776928}
[S4] START round=10 head_norm_before_train=0.795009 cos_to_last_merge=1.0000 (last merge round=9)
[S4] round=10 local utility u=0.020167 metrics={'f1_val': 0.6675671030226373, 'auprc': 0.6602182602383914, 'loss_val': 0.8875130202034225, 'psi': 0.6646275659089389}-{'f1_val': 0.6763252968734653, 'auprc': 0.6485182316580334, 'loss_val': 0.9452964442500975, 'psi': 0.6652024707872926}
[S5] START round=10 head_norm_before_train=0.845600 cos_to_last_merge=0.9242 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.924
[S5] round=10 local utility u=0.253258 metrics={'f1_val': 0.530396417451964, 'auprc': 0.6928302200628726, 'loss_val': 0.8347140645916001, 'psi': 0.5953699384963274}-{'f1_val': 0.4176671856330787, 'auprc': 0.7772738958393677, 'loss_val': 0.918186580250437, 'psi': 0.5615098697155942}
[S6] START round=10 head_norm_before_train=1.445839 (no previous merge yet)
[S6] round=10 local utility u=0.000000 metrics={'f1_val': 0.5556683963277688, 'auprc': 0.7212532271220231, 'loss_val': 0.6224686141215395, 'psi': 0.6219023286454706}-{'f1_val': 0.6175819349745525, 'auprc': 0.9454093160347611, 'loss_val': 0.5610123066875463, 'psi': 0.748712887398636}
[S7] START round=10 head_norm_before_train=0.755532 cos_to_last_merge=1.0000 (last merge round=9)
[S7] round=10 local utility u=0.007514 metrics={'f1_val': 0.41683246609844005, 'auprc': 0.5598237610870263, 'loss_val': 1.0416207458496696, 'psi': 0.47402898409387456}-{'f1_val': 0.41695504393391747, 'auprc': 0.5691680117012896, 'loss_val': 1.085416943002638, 'psi': 0.47784023104086637}
[S8] START round=10 head_norm_before_train=1.131971 cos_to_last_merge=0.9236 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.924
[S8] round=10 local utility u=0.010141 metrics={'f1_val': 0.701432261124125, 'auprc': 0.9915435129943453, 'loss_val': 0.38268112721757563, 'psi': 0.8174767618722132}-{'f1_val': 0.7144610111876308, 'auprc': 0.9985715940079692, 'loss_val': 0.5022205637019997, 'psi': 0.8281052443157662}
[S9] START round=10 head_norm_before_train=1.209727 cos_to_last_merge=0.9486 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.949
[S9] round=10 local utility u=0.060532 metrics={'f1_val': 0.7014667606303384, 'auprc': 0.998639203677955, 'loss_val': 0.35839420863163435, 'psi': 0.8203357378493851}-{'f1_val': 0.7015406642019387, 'auprc': 0.9997310924549277, 'loss_val': 0.4831769699155411, 'psi': 0.8208168355031343}
[S10] START round=10 head_norm_before_train=1.251237 cos_to_last_merge=1.0000 (last merge round=9)
[S10] round=10 local utility u=0.181174 metrics={'f1_val': 0.4708876480290289, 'auprc': 0.9146117972719214, 'loss_val': 0.7504317219380502, 'psi': 0.6483773077261858}-{'f1_val': 0.4363896569219587, 'auprc': 0.891808392868346, 'loss_val': 0.8373811230912352, 'psi': 0.6185571513005137}
[S11] START round=10 head_norm_before_train=1.351634 cos_to_last_merge=0.9978 (last merge round=8)
[S11] round=10 local utility u=0.805959 metrics={'f1_val': 0.6471774014139967, 'auprc': 0.9664675914961572, 'loss_val': 0.7043852246928983, 'psi': 0.774893477446861}-{'f1_val': 0.396484976660716, 'auprc': 0.9934742471356564, 'loss_val': 0.8931693351978973, 'psi': 0.6352806848506922}
[S13] START round=10 head_norm_before_train=1.042837 cos_to_last_merge=1.0000 (last merge round=9)
[S13] round=10 local utility u=0.000000 metrics={'f1_val': 0.3755828805556426, 'auprc': 0.7037095276767009, 'loss_val': 0.982007250514469, 'psi': 0.506833539404066}-{'f1_val': 0.3980730532565541, 'auprc': 0.7281253132929196, 'loss_val': 1.0116656886225655, 'psi': 0.5300939572711003}
[S14] START round=10 head_norm_before_train=1.525166 (no previous merge yet)
[S14] round=10 local utility u=0.087833 metrics={'f1_val': 0.9974340800368326, 'auprc': 0.9957265313140078, 'loss_val': 0.30952201851809513, 'psi': 0.9967510605477027}-{'f1_val': 0.9917211200248336, 'auprc': 0.9929398892023119, 'loss_val': 0.44255077862697845, 'psi': 0.992208627695825}
[S15] START round=10 head_norm_before_train=1.426863 (no previous merge yet)
[S15] round=10 local utility u=0.020133 metrics={'f1_val': 0.6333515639557018, 'auprc': 0.9870829818498016, 'loss_val': 0.5830078833527851, 'psi': 0.7748441311133418}-{'f1_val': 0.6903645755253742, 'auprc': 0.8657301503954625, 'loss_val': 0.6012925114515446, 'psi': 0.7605108054734095}
[S16] START round=10 head_norm_before_train=0.600811 cos_to_last_merge=1.0000 (last merge round=9)
[S16] round=10 local utility u=0.419361 metrics={'f1_val': 0.3732532077377891, 'auprc': 0.7229336699975701, 'loss_val': 0.962136837847248, 'psi': 0.5131253926417014}-{'f1_val': 0.35249002963425546, 'auprc': 0.5091869305917148, 'loss_val': 1.0350395771553682, 'psi': 0.4151687900172392}
[S17] START round=10 head_norm_before_train=0.931462 cos_to_last_merge=0.8257 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.826
[S17] round=10 local utility u=0.428607 metrics={'f1_val': 0.46551410528343307, 'auprc': 0.6215522657889447, 'loss_val': 0.8702229351933498, 'psi': 0.5279293694856377}-{'f1_val': 0.35125194739393545, 'auprc': 0.5858781101563795, 'loss_val': 0.9348421056722286, 'psi': 0.4451024124989131}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:49107
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:49103
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:49111
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:49110
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:49116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:49116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] → sending delta(kind=head bytes=1794) to S4@127.0.0.1:49104
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S2@127.0.0.1:49102
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:49108
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:49113
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:49116
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:49111
[S2] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S16] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1794 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1803) from S9
[S6] cosine check vs S9: cos=-0.0384
[S6] DROPPED delta from S9 (cos=-0.0384 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1797) from S5
[S16] cosine check vs S5: cos=0.7322
[S16] RECEIVED delta(kind=head bytes=1797) from S11
[S16] cosine check vs S11: cos=0.5356
[S10] RECEIVED delta(kind=head bytes=1800) from S14
[S10] cosine check vs S14: cos=0.9798
[S10] RECEIVED delta(kind=head bytes=1803) from S16
[S10] cosine check vs S16: cos=0.1341
[S7] RECEIVED delta(kind=head bytes=1797) from S4
[S7] cosine check vs S4: cos=0.8783
[S16] RECEIVED delta(kind=head bytes=1799) from S7
[S16] cosine check vs S7: cos=0.6218
[S9] RECEIVED delta(kind=head bytes=1797) from S2
[S9] cosine check vs S2: cos=-0.0082
[S9] DROPPED delta from S2 (cos=-0.0082 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1799) from S10
[S3] cosine check vs S10: cos=0.9103
[S4] RECEIVED delta(kind=head bytes=1794) from S3
[S4] cosine check vs S3: cos=0.8102
[S2] RECEIVED delta(kind=head bytes=1803) from S15
[S2] cosine check vs S15: cos=-0.1733
[S2] DROPPED delta from S15 (cos=-0.1733 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1801) from S8
[S13] cosine check vs S8: cos=0.9778
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S17] → sending delta(kind=head bytes=1789) to S4@127.0.0.1:49104
[S17] sending update (kind=head size=1789 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1789) from S17
[S4] cosine check vs S17: cos=0.2589
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=10 metric=0.3756 head_norm=1.066467
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.301908e-01
[S13] stored merged vector for next round verification (round=10)
[S13] DEBUG after merge:  round=10 metric=0.3762 head_norm=1.115285 delta_norm=0.130191
[S13] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.215 → S11@127.0.0.1:49112
[S6] ⇄ pheromone p=0.323 → S11@127.0.0.1:49112
[S15] ⇄ pheromone p=0.331 → S2@127.0.0.1:49102
[S8] ⇄ pheromone p=0.397 → S13@127.0.0.1:49113
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=10 metric=0.6162 head_norm=0.951046
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.889448e-01
[S3] stored merged vector for next round verification (round=10)
[S3] DEBUG after merge:  round=10 metric=0.6008 head_norm=1.095086 delta_norm=0.288945
[S3] aggregate: ROLLBACK (f1_val pre=0.616 post=0.601 tol_abs=0.005 tol_rel=0.0)
[S3] ⇄ pheromone p=0.309 → S4@127.0.0.1:49104
[S2] ⇄ pheromone p=0.241 → S9@127.0.0.1:49110
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=10 metric=0.6676 head_norm=0.825442
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.935014e-01
[S4] stored merged vector for next round verification (round=10)
[S4] DEBUG after merge:  round=10 metric=0.6691 head_norm=0.712691 delta_norm=0.293501
[S4] aggregate: ACCEPT kept=['S3', 'S17'] (k=2/2) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.307 → S7@127.0.0.1:49108
[S5] ⇄ pheromone p=0.281 → S16@127.0.0.1:49116
[S14] ⇄ pheromone p=0.508 → S10@127.0.0.1:49111
[S9] ⇄ pheromone p=0.340 → S6@127.0.0.1:49107
[S16] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=10 metric=0.3733 head_norm=0.651516
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.019307e-01
[S16] stored merged vector for next round verification (round=10)
[S16] DEBUG after merge:  round=10 metric=0.3630 head_norm=0.629220 delta_norm=0.101931
[S16] aggregate: ROLLBACK (f1_val pre=0.373 post=0.363 tol_abs=0.005 tol_rel=0.0)
[S16] ⇄ pheromone p=0.282 → S10@127.0.0.1:49111
[S10] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=10 metric=0.4709 head_norm=1.288766
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.742445e-01
[S10] stored merged vector for next round verification (round=10)
[S10] DEBUG after merge:  round=10 metric=0.4261 head_norm=1.059576 delta_norm=0.274244
[S10] aggregate: ROLLBACK (f1_val pre=0.471 post=0.426 tol_abs=0.005 tol_rel=0.0)
[S10] ⇄ pheromone p=0.346 → S3@127.0.0.1:49103
[S11] ⇄ pheromone p=0.449 → S16@127.0.0.1:49116
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=10 metric=0.4168 head_norm=0.778809
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.991556e-01
[S7] stored merged vector for next round verification (round=10)
[S7] DEBUG after merge:  round=10 metric=0.4170 head_norm=0.777358 delta_norm=0.199156
[S7] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.261 → S16@127.0.0.1:49116
[S17] ⇄ pheromone p=0.268 → S4@127.0.0.1:49104
[S2] START round=11 head_norm_before_train=1.025608 cos_to_last_merge=0.8735 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.873
[S2] round=11 local utility u=0.534488 metrics={'f1_val': 0.6363059014608501, 'auprc': 0.7727894193911744, 'loss_val': 0.7952401531121139, 'psi': 0.6908993086329798}-{'f1_val': 0.4693667390147714, 'auprc': 0.7735955927861053, 'loss_val': 0.8650004054597665, 'psi': 0.591058280523305}
[S3] START round=11 head_norm_before_train=1.095086 cos_to_last_merge=1.0000 (last merge round=10)
[S3] round=11 local utility u=0.076303 metrics={'f1_val': 0.6047415341210418, 'auprc': 0.8693818472733993, 'loss_val': 0.7537442835251174, 'psi': 0.7105976593819848}-{'f1_val': 0.6161615825939625, 'auprc': 0.7955379742433262, 'loss_val': 0.7533395890408441, 'psi': 0.687912139253708}
[S4] START round=11 head_norm_before_train=0.712691 cos_to_last_merge=1.0000 (last merge round=10)
[S4] round=11 local utility u=0.030656 metrics={'f1_val': 0.6648028922187924, 'auprc': 0.6595263388479364, 'loss_val': 0.8075396179494674, 'psi': 0.66269227087045}-{'f1_val': 0.6675671030226373, 'auprc': 0.6602182602383914, 'loss_val': 0.8875130202034225, 'psi': 0.6646275659089389}
[S5] START round=11 head_norm_before_train=0.881946 cos_to_last_merge=0.9065 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.907
[S5] round=11 local utility u=0.391467 metrics={'f1_val': 0.6077310799328196, 'auprc': 0.7764648930150609, 'loss_val': 0.7666924764582921, 'psi': 0.6752246051657161}-{'f1_val': 0.530396417451964, 'auprc': 0.6928302200628726, 'loss_val': 0.8347140645916001, 'psi': 0.5953699384963274}
[S6] START round=11 head_norm_before_train=1.485890 (no previous merge yet)
[S6] round=11 local utility u=0.848342 metrics={'f1_val': 0.6792022306318574, 'auprc': 0.95689171999526, 'loss_val': 0.37390271902485206, 'psi': 0.7902780263772184}-{'f1_val': 0.5556683963277688, 'auprc': 0.7212532271220231, 'loss_val': 0.6224686141215395, 'psi': 0.6219023286454706}
[S7] START round=11 head_norm_before_train=0.777358 cos_to_last_merge=1.0000 (last merge round=10)
[S7] round=11 local utility u=0.646896 metrics={'f1_val': 0.5731594290223665, 'auprc': 0.6606670430125912, 'loss_val': 0.9883207084510218, 'psi': 0.6081624746184564}-{'f1_val': 0.41683246609844005, 'auprc': 0.5598237610870263, 'loss_val': 1.0416207458496696, 'psi': 0.47402898409387456}
[S8] START round=11 head_norm_before_train=1.176550 cos_to_last_merge=0.9092 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.909
[S8] round=11 local utility u=0.073349 metrics={'f1_val': 0.7143033874680186, 'auprc': 0.9980013167709519, 'loss_val': 0.332583040822675, 'psi': 0.8277825591891919}-{'f1_val': 0.701432261124125, 'auprc': 0.9915435129943453, 'loss_val': 0.38268112721757563, 'psi': 0.8174767618722132}
[S9] START round=11 head_norm_before_train=1.262655 cos_to_last_merge=0.9358 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.936
[S9] round=11 local utility u=0.028081 metrics={'f1_val': 0.7014667606303384, 'auprc': 0.9981465592366884, 'loss_val': 0.3007541777538659, 'psi': 0.8201386800728784}-{'f1_val': 0.7014667606303384, 'auprc': 0.998639203677955, 'loss_val': 0.35839420863163435, 'psi': 0.8203357378493851}
[S10] START round=11 head_norm_before_train=1.059576 cos_to_last_merge=1.0000 (last merge round=10)
[S10] round=11 local utility u=0.000000 metrics={'f1_val': 0.4678933805215379, 'auprc': 0.7095120721336927, 'loss_val': 0.7127769680353543, 'psi': 0.5645408571663998}-{'f1_val': 0.4708876480290289, 'auprc': 0.9146117972719214, 'loss_val': 0.7504317219380502, 'psi': 0.6483773077261858}
[S11] START round=11 head_norm_before_train=1.383626 cos_to_last_merge=0.9920 (last merge round=8)
[S11] round=11 local utility u=0.053776 metrics={'f1_val': 0.6255716678524019, 'auprc': 0.9978190443908623, 'loss_val': 0.5612530824444023, 'psi': 0.7744706184677861}-{'f1_val': 0.6471774014139967, 'auprc': 0.9664675914961572, 'loss_val': 0.7043852246928983, 'psi': 0.774893477446861}
[S13] START round=11 head_norm_before_train=1.115285 cos_to_last_merge=1.0000 (last merge round=10)
[S13] round=11 local utility u=0.363143 metrics={'f1_val': 0.45937410785315136, 'auprc': 0.7457255384507605, 'loss_val': 0.8845176228359755, 'psi': 0.573914680092195}-{'f1_val': 0.3755828805556426, 'auprc': 0.7037095276767009, 'loss_val': 0.982007250514469, 'psi': 0.506833539404066}
[S14] START round=11 head_norm_before_train=1.569978 (no previous merge yet)
[S14] round=11 local utility u=0.039036 metrics={'f1_val': 0.9963384221964082, 'auprc': 0.9957243306559189, 'loss_val': 0.22487014740288472, 'psi': 0.9960927855802124}-{'f1_val': 0.9974340800368326, 'auprc': 0.9957265313140078, 'loss_val': 0.30952201851809513, 'psi': 0.9967510605477027}
[S15] START round=11 head_norm_before_train=1.460823 (no previous merge yet)
[S15] round=11 local utility u=0.221855 metrics={'f1_val': 0.6850462009169499, 'auprc': 0.9897304513353928, 'loss_val': 0.4574082011283624, 'psi': 0.8069199010843271}-{'f1_val': 0.6333515639557018, 'auprc': 0.9870829818498016, 'loss_val': 0.5830078833527851, 'psi': 0.7748441311133418}
[S16] START round=11 head_norm_before_train=0.629220 cos_to_last_merge=1.0000 (last merge round=10)
[S16] round=11 local utility u=0.195317 metrics={'f1_val': 0.4375974944249222, 'auprc': 0.7229054005204366, 'loss_val': 0.9574844239028458, 'psi': 0.5517206568631279}-{'f1_val': 0.3732532077377891, 'auprc': 0.7229336699975701, 'loss_val': 0.962136837847248, 'psi': 0.5131253926417014}
[S17] START round=11 head_norm_before_train=0.970991 cos_to_last_merge=0.8066 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.807
[S17] round=11 local utility u=0.000000 metrics={'f1_val': 0.35724665297483527, 'auprc': 0.6440719611905111, 'loss_val': 0.8575311882037728, 'psi': 0.4719767762611056}-{'f1_val': 0.46551410528343307, 'auprc': 0.6215522657889447, 'loss_val': 0.8702229351933498, 'psi': 0.5279293694856377}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:49112
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:49116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:49107
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:49108
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:49102
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:49113
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:49116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:49112
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:49111
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:49111
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] → sending delta(kind=head bytes=1793) to S4@127.0.0.1:49104
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:49110
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:49116
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1793 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1795 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1803) from S14
[S10] cosine check vs S14: cos=0.9558
[S7] RECEIVED delta(kind=head bytes=1799) from S4
[S7] cosine check vs S4: cos=0.9141
[S2] RECEIVED delta(kind=head bytes=1799) from S15
[S2] cosine check vs S15: cos=-0.1768
[S2] DROPPED delta from S15 (cos=-0.1768 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1800) from S13
[S11] cosine check vs S13: cos=-0.0781
[S11] DROPPED delta from S13 (cos=-0.0781 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1802) from S7
[S16] cosine check vs S7: cos=0.6371
[S16] RECEIVED delta(kind=head bytes=1801) from S5
[S16] cosine check vs S5: cos=0.7173
[S16] RECEIVED delta(kind=head bytes=1799) from S11
[S16] cosine check vs S11: cos=0.5317
[S4] RECEIVED delta(kind=head bytes=1793) from S3
[S4] cosine check vs S3: cos=0.7240
[S13] RECEIVED delta(kind=head bytes=1803) from S8
[S13] cosine check vs S8: cos=0.9849
[S11] RECEIVED delta(kind=head bytes=1795) from S6
[S11] cosine check vs S6: cos=0.9606
[S10] RECEIVED delta(kind=head bytes=1798) from S16
[S10] cosine check vs S16: cos=0.2866
[S9] RECEIVED delta(kind=head bytes=1799) from S2
[S9] cosine check vs S2: cos=-0.0107
[S9] DROPPED delta from S2 (cos=-0.0107 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1802) from S9
[S6] cosine check vs S9: cos=-0.0387
[S6] DROPPED delta from S9 (cos=-0.0387 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=11 metric=0.4679 head_norm=1.103783
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.582016e-01
[S10] stored merged vector for next round verification (round=11)
[S10] DEBUG after merge:  round=11 metric=0.3880 head_norm=0.990983 delta_norm=0.158202
[S10] aggregate: ROLLBACK (f1_val pre=0.468 post=0.388 tol_abs=0.005 tol_rel=0.0)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=11 metric=0.4594 head_norm=1.141682
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.100975e-01
[S13] stored merged vector for next round verification (round=11)
[S13] DEBUG after merge:  round=11 metric=0.4643 head_norm=1.177058 delta_norm=0.110097
[S13] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=11 metric=0.6648 head_norm=0.752429
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.902096e-01
[S4] stored merged vector for next round verification (round=11)
[S4] DEBUG after merge:  round=11 metric=0.6775 head_norm=0.875473 delta_norm=0.390210
[S4] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=11 metric=0.6256 head_norm=1.419993
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.129125e-01
[S11] stored merged vector for next round verification (round=11)
[S11] DEBUG after merge:  round=11 metric=0.6324 head_norm=1.457625 delta_norm=0.212912
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=11 metric=0.4376 head_norm=0.682300
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.000158e-01
[S16] stored merged vector for next round verification (round=11)
[S16] DEBUG after merge:  round=11 metric=0.4377 head_norm=0.653652 delta_norm=0.100016
[S16] aggregate: ACCEPT kept=['S7', 'S5', 'S11'] (k=3/3) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=11 metric=0.5732 head_norm=0.801643
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.628081e-01
[S7] stored merged vector for next round verification (round=11)
[S7] DEBUG after merge:  round=11 metric=0.4167 head_norm=0.760187 delta_norm=0.162808
[S7] aggregate: ROLLBACK (f1_val pre=0.573 post=0.417 tol_abs=0.005 tol_rel=0.0)
[S2] START round=12 head_norm_before_train=1.075211 cos_to_last_merge=0.8576 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.858
[S2] round=12 local utility u=0.024458 metrics={'f1_val': 0.636575253897523, 'auprc': 0.7681226998115974, 'loss_val': 0.7339407832699216, 'psi': 0.6891942322631528}-{'f1_val': 0.6363059014608501, 'auprc': 0.7727894193911744, 'loss_val': 0.7952401531121139, 'psi': 0.6908993086329798}
[S3] START round=12 head_norm_before_train=1.127512 cos_to_last_merge=0.9960 (last merge round=10)
[S3] round=12 local utility u=0.381750 metrics={'f1_val': 0.7005813959920884, 'auprc': 0.86819454311413, 'loss_val': 0.5617222333784937, 'psi': 0.767626654840905}-{'f1_val': 0.6047415341210418, 'auprc': 0.8693818472733993, 'loss_val': 0.7537442835251174, 'psi': 0.7105976593819848}
[S4] START round=12 head_norm_before_train=0.875473 cos_to_last_merge=1.0000 (last merge round=11)
[S4] round=12 local utility u=0.341992 metrics={'f1_val': 0.6785663430613651, 'auprc': 0.8537887215573927, 'loss_val': 0.7889242863516913, 'psi': 0.7486552944597762}-{'f1_val': 0.6648028922187924, 'auprc': 0.6595263388479364, 'loss_val': 0.8075396179494674, 'psi': 0.66269227087045}
[S5] START round=12 head_norm_before_train=0.919102 cos_to_last_merge=0.8902 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.890
[S5] round=12 local utility u=0.039422 metrics={'f1_val': 0.6486730641547293, 'auprc': 0.6971595474898313, 'loss_val': 0.6955852178677603, 'psi': 0.6680676574887701}-{'f1_val': 0.6077310799328196, 'auprc': 0.7764648930150609, 'loss_val': 0.7666924764582921, 'psi': 0.6752246051657161}
[S6] START round=12 head_norm_before_train=1.524343 (no previous merge yet)
[S6] round=12 local utility u=0.000000 metrics={'f1_val': 0.685111600626169, 'auprc': 0.8006447629576567, 'loss_val': 0.4278572035162049, 'psi': 0.7313248655587641}-{'f1_val': 0.6792022306318574, 'auprc': 0.95689171999526, 'loss_val': 0.37390271902485206, 'psi': 0.7902780263772184}
[S7] START round=12 head_norm_before_train=0.760187 cos_to_last_merge=1.0000 (last merge round=11)
[S7] round=12 local utility u=0.416012 metrics={'f1_val': 0.6640234262596751, 'auprc': 0.7329053308182499, 'loss_val': 0.9181960869368346, 'psi': 0.6915761880831051}-{'f1_val': 0.5731594290223665, 'auprc': 0.6606670430125912, 'loss_val': 0.9883207084510218, 'psi': 0.6081624746184564}
[S8] START round=12 head_norm_before_train=1.221367 cos_to_last_merge=0.8954 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.895
[S8] round=12 local utility u=0.000000 metrics={'f1_val': 0.7011928360964077, 'auprc': 0.967442849190164, 'loss_val': 0.33886199169570563, 'psi': 0.8076928413339102}-{'f1_val': 0.7143033874680186, 'auprc': 0.9980013167709519, 'loss_val': 0.332583040822675, 'psi': 0.8277825591891919}
[S9] START round=12 head_norm_before_train=1.310601 cos_to_last_merge=0.9227 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.923
[S9] round=12 local utility u=0.023533 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9980448073541079, 'loss_val': 0.2518824920683189, 'psi': 0.8199478714056543}-{'f1_val': 0.7014667606303384, 'auprc': 0.9981465592366884, 'loss_val': 0.3007541777538659, 'psi': 0.8201386800728784}
[S10] START round=12 head_norm_before_train=0.990983 cos_to_last_merge=1.0000 (last merge round=11)
[S10] round=12 local utility u=0.846077 metrics={'f1_val': 0.6878786214371089, 'auprc': 0.8005507582135629, 'loss_val': 0.6136514006314198, 'psi': 0.7329474761476904}-{'f1_val': 0.4678933805215379, 'auprc': 0.7095120721336927, 'loss_val': 0.7127769680353543, 'psi': 0.5645408571663998}
[S11] START round=12 head_norm_before_train=1.457625 cos_to_last_merge=1.0000 (last merge round=11)
[S11] round=12 local utility u=0.267109 metrics={'f1_val': 0.702242488399264, 'auprc': 0.9970412161042601, 'loss_val': 0.4847267032914256, 'psi': 0.8201619794812625}-{'f1_val': 0.6255716678524019, 'auprc': 0.9978190443908623, 'loss_val': 0.5612530824444023, 'psi': 0.7744706184677861}
[S13] START round=12 head_norm_before_train=1.177058 cos_to_last_merge=1.0000 (last merge round=11)
[S13] round=12 local utility u=0.000000 metrics={'f1_val': 0.5009893656717375, 'auprc': 0.6363235197058089, 'loss_val': 0.8958920456852961, 'psi': 0.555123027285366}-{'f1_val': 0.45937410785315136, 'auprc': 0.7457255384507605, 'loss_val': 0.8845176228359755, 'psi': 0.573914680092195}
[S14] START round=12 head_norm_before_train=1.609571 (no previous merge yet)
[S14] round=12 local utility u=0.008881 metrics={'f1_val': 0.9979161758042404, 'auprc': 0.9963371493109663, 'loss_val': 0.21841361462310646, 'psi': 0.9972845652069308}-{'f1_val': 0.9963384221964082, 'auprc': 0.9957243306559189, 'loss_val': 0.22487014740288472, 'psi': 0.9960927855802124}
[S15] START round=12 head_norm_before_train=1.489976 (no previous merge yet)
[S15] round=12 local utility u=0.102357 metrics={'f1_val': 0.7108639774006297, 'auprc': 0.9874487381355049, 'loss_val': 0.40075577476647595, 'psi': 0.8214978816945798}-{'f1_val': 0.6850462009169499, 'auprc': 0.9897304513353928, 'loss_val': 0.4574082011283624, 'psi': 0.8069199010843271}
[S16] START round=12 head_norm_before_train=0.653652 cos_to_last_merge=1.0000 (last merge round=11)
[S16] round=12 local utility u=0.552009 metrics={'f1_val': 0.6049844798698005, 'auprc': 0.7335769244914305, 'loss_val': 0.8898033499403935, 'psi': 0.6564214577184526}-{'f1_val': 0.4375974944249222, 'auprc': 0.7229054005204366, 'loss_val': 0.9574844239028458, 'psi': 0.5517206568631279}
[S17] START round=12 head_norm_before_train=1.004180 cos_to_last_merge=0.7918 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.792
[S17] round=12 local utility u=0.030203 metrics={'f1_val': 0.35752216895617495, 'auprc': 0.6630237723552315, 'loss_val': 0.855633282399473, 'psi': 0.47972281031579755}-{'f1_val': 0.35724665297483527, 'auprc': 0.6440719611905111, 'loss_val': 0.8575311882037728, 'psi': 0.4719767762611056}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:49116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S2@127.0.0.1:49102
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:49108
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:49104
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:49111
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:49110
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:49107
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] → sending delta(kind=head bytes=1804) to S10@127.0.0.1:49111
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:49116
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:49116
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:49103
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S17] → sending delta(kind=head bytes=1791) to S4@127.0.0.1:49104
[S4] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1804 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1804 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1799) from S14
[S10] cosine check vs S14: cos=0.9350
[S2] RECEIVED delta(kind=head bytes=1804) from S15
[S2] cosine check vs S15: cos=-0.1788
[S2] DROPPED delta from S15 (cos=-0.1788 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1801) from S9
[S6] cosine check vs S9: cos=-0.0407
[S6] DROPPED delta from S9 (cos=-0.0407 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1796) from S11
[S16] cosine check vs S11: cos=0.5213
[S16] RECEIVED delta(kind=head bytes=1801) from S5
[S16] cosine check vs S5: cos=0.7091
[S4] RECEIVED delta(kind=head bytes=1796) from S3
[S4] cosine check vs S3: cos=0.9356
[S9] RECEIVED delta(kind=head bytes=1800) from S2
[S9] cosine check vs S2: cos=-0.0152
[S9] DROPPED delta from S2 (cos=-0.0152 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1801) from S10
[S3] cosine check vs S10: cos=0.9489
[S7] RECEIVED delta(kind=head bytes=1797) from S4
[S7] cosine check vs S4: cos=0.8548
[S10] RECEIVED delta(kind=head bytes=1804) from S16
[S10] cosine check vs S16: cos=0.4145
[S17] sending update (kind=head size=1791 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1791) from S17
[S4] cosine check vs S17: cos=0.2787
[S7] sending update (kind=head size=1799 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1799) from S7
[S16] cosine check vs S7: cos=0.7076
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=12 metric=0.7006 head_norm=1.170652
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.882910e-01
[S3] stored merged vector for next round verification (round=12)
[S3] DEBUG after merge:  round=12 metric=0.7006 head_norm=1.090407 delta_norm=0.188291
[S3] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=12 metric=0.6879 head_norm=1.038487
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.065851e-01
[S10] stored merged vector for next round verification (round=12)
[S10] DEBUG after merge:  round=12 metric=0.6874 head_norm=0.980115 delta_norm=0.106585
[S10] aggregate: ACCEPT kept=['S14', 'S16'] (k=2/2) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=12 metric=0.6786 head_norm=0.905026
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.307349e-01
[S4] stored merged vector for next round verification (round=12)
[S4] DEBUG after merge:  round=12 metric=0.6854 head_norm=0.824040 delta_norm=0.230735
[S4] aggregate: ACCEPT kept=['S3', 'S17'] (k=2/2) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=12 metric=0.6640 head_norm=0.788274
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.349418e-01
[S7] stored merged vector for next round verification (round=12)
[S7] DEBUG after merge:  round=12 metric=0.6670 head_norm=0.815492 delta_norm=0.234942
[S7] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=12 metric=0.6050 head_norm=0.707012
[S16] _apply_head_vector_avg (torch): Δ‖w‖=9.687864e-02
[S16] stored merged vector for next round verification (round=12)
[S16] DEBUG after merge:  round=12 metric=0.6217 head_norm=0.676774 delta_norm=0.096879
[S16] aggregate: ACCEPT kept=['S11', 'S5', 'S7'] (k=3/3) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.130029 cos_to_last_merge=0.8416 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.842
[S2] round=13 local utility u=0.335705 metrics={'f1_val': 0.7120117472303769, 'auprc': 0.7846699165275045, 'loss_val': 0.5647916661378681, 'psi': 0.7410750149492279}-{'f1_val': 0.636575253897523, 'auprc': 0.7681226998115974, 'loss_val': 0.7339407832699216, 'psi': 0.6891942322631528}
[S3] START round=13 head_norm_before_train=1.090407 cos_to_last_merge=1.0000 (last merge round=12)
[S3] round=13 local utility u=0.203859 metrics={'f1_val': 0.7005813959920884, 'auprc': 0.9993247900041023, 'loss_val': 0.5473955810023013, 'psi': 0.820078753596894}-{'f1_val': 0.7005813959920884, 'auprc': 0.86819454311413, 'loss_val': 0.5617222333784937, 'psi': 0.767626654840905}
[S4] START round=13 head_norm_before_train=0.824040 cos_to_last_merge=1.0000 (last merge round=12)
[S4] round=13 local utility u=0.140717 metrics={'f1_val': 0.6635790364005343, 'auprc': 0.9418437193686866, 'loss_val': 0.6817309676457705, 'psi': 0.7748849095877952}-{'f1_val': 0.6785663430613651, 'auprc': 0.8537887215573927, 'loss_val': 0.7889242863516913, 'psi': 0.7486552944597762}
[S5] START round=13 head_norm_before_train=0.944499 cos_to_last_merge=0.8785 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.879
[S5] round=13 local utility u=0.315789 metrics={'f1_val': 0.7004090841190582, 'auprc': 0.7930070390273768, 'loss_val': 0.6619648584716252, 'psi': 0.7374482660823857}-{'f1_val': 0.6486730641547293, 'auprc': 0.6971595474898313, 'loss_val': 0.6955852178677603, 'psi': 0.6680676574887701}
[S6] START round=13 head_norm_before_train=1.562165 (no previous merge yet)
[S6] round=13 local utility u=0.000000 metrics={'f1_val': 0.6297547723221546, 'auprc': 0.8161035944620025, 'loss_val': 0.483101180904432, 'psi': 0.7042943011780938}-{'f1_val': 0.685111600626169, 'auprc': 0.8006447629576567, 'loss_val': 0.4278572035162049, 'psi': 0.7313248655587641}
[S7] START round=13 head_norm_before_train=0.815492 cos_to_last_merge=1.0000 (last merge round=12)
[S7] round=13 local utility u=0.000000 metrics={'f1_val': 0.37460771026513506, 'auprc': 0.5656964105071599, 'loss_val': 1.0792956631190367, 'psi': 0.45104319036194496}-{'f1_val': 0.6640234262596751, 'auprc': 0.7329053308182499, 'loss_val': 0.9181960869368346, 'psi': 0.6915761880831051}
[S8] START round=13 head_norm_before_train=1.262708 cos_to_last_merge=0.8833 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.883
[S8] round=13 local utility u=0.084753 metrics={'f1_val': 0.7142391053978291, 'auprc': 0.99757320103065, 'loss_val': 0.3380253014245936, 'psi': 0.8275727436509575}-{'f1_val': 0.7011928360964077, 'auprc': 0.967442849190164, 'loss_val': 0.33886199169570563, 'psi': 0.8076928413339102}
[S9] START round=13 head_norm_before_train=1.356282 cos_to_last_merge=0.9102 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.910
[S9] round=13 local utility u=0.000000 metrics={'f1_val': 0.6926782676589199, 'auprc': 0.9980898956744128, 'loss_val': 0.2196076366638606, 'psi': 0.8148429188651171}-{'f1_val': 0.7012165807733519, 'auprc': 0.9980448073541079, 'loss_val': 0.2518824920683189, 'psi': 0.8199478714056543}
[S10] START round=13 head_norm_before_train=0.980115 cos_to_last_merge=1.0000 (last merge round=12)
[S10] round=13 local utility u=0.336504 metrics={'f1_val': 0.6887135971856682, 'auprc': 0.9968911946963801, 'loss_val': 0.5346738851401405, 'psi': 0.811984636189953}-{'f1_val': 0.6878786214371089, 'auprc': 0.8005507582135629, 'loss_val': 0.6136514006314198, 'psi': 0.7329474761476904}
[S11] START round=13 head_norm_before_train=1.495027 cos_to_last_merge=0.9989 (last merge round=11)
[S11] round=13 local utility u=0.029508 metrics={'f1_val': 0.702242488399264, 'auprc': 0.9945420430315621, 'loss_val': 0.4182139241227171, 'psi': 0.8191623102521832}-{'f1_val': 0.702242488399264, 'auprc': 0.9970412161042601, 'loss_val': 0.4847267032914256, 'psi': 0.8201619794812625}
[S13] START round=13 head_norm_before_train=1.205485 cos_to_last_merge=0.9982 (last merge round=11)
[S13] round=13 local utility u=0.815000 metrics={'f1_val': 0.6889064238237951, 'auprc': 0.7416688344252765, 'loss_val': 0.7094305161498631, 'psi': 0.7100113880643877}-{'f1_val': 0.5009893656717375, 'auprc': 0.6363235197058089, 'loss_val': 0.8958920456852961, 'psi': 0.555123027285366}
[S14] START round=13 head_norm_before_train=1.641848 (no previous merge yet)
[S14] round=13 local utility u=0.000000 metrics={'f1_val': 0.9780570968509723, 'auprc': 0.9957161387565003, 'loss_val': 0.177763048535376, 'psi': 0.9851207136131834}-{'f1_val': 0.9979161758042404, 'auprc': 0.9963371493109663, 'loss_val': 0.21841361462310646, 'psi': 0.9972845652069308}
[S15] START round=13 head_norm_before_train=1.514706 (no previous merge yet)
[S15] round=13 local utility u=0.000000 metrics={'f1_val': 0.6924005062259557, 'auprc': 0.979666593582426, 'loss_val': 0.3828134255964536, 'psi': 0.8073069411685438}-{'f1_val': 0.7108639774006297, 'auprc': 0.9874487381355049, 'loss_val': 0.40075577476647595, 'psi': 0.8214978816945798}
[S16] START round=13 head_norm_before_train=0.676774 cos_to_last_merge=1.0000 (last merge round=12)
[S16] round=13 local utility u=0.000000 metrics={'f1_val': 0.5459065005731212, 'auprc': 0.7627927682139657, 'loss_val': 0.7916085347707316, 'psi': 0.632661007629459}-{'f1_val': 0.6049844798698005, 'auprc': 0.7335769244914305, 'loss_val': 0.8898033499403935, 'psi': 0.6564214577184526}
[S17] START round=13 head_norm_before_train=1.032356 cos_to_last_merge=0.7796 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.780
[S17] round=13 local utility u=0.001691 metrics={'f1_val': 0.3550841086000084, 'auprc': 0.6714134342260695, 'loss_val': 0.862792882178113, 'psi': 0.48161583885043285}-{'f1_val': 0.35752216895617495, 'auprc': 0.6630237723552315, 'loss_val': 0.855633282399473, 'psi': 0.47972281031579755}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:49103
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:49115
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:49111
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S13] → sending delta(kind=head bytes=1791) to S8@127.0.0.1:49109
[S3] sending update (kind=head size=1795 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1800) from S2
[S15] cosine check vs S2: cos=-0.1805
[S15] DROPPED delta from S2 (cos=-0.1805 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1795) from S3
[S10] cosine check vs S3: cos=0.9688
[S3] RECEIVED delta(kind=head bytes=1798) from S4
[S3] cosine check vs S4: cos=0.8741
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1791 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1791) from S13
[S8] cosine check vs S13: cos=0.9812
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:49114
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:49107
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1784 reason=None
[S17] sending update (kind=head size=1784 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1796) from S10
[S14] cosine check vs S10: cos=0.9226
[S6] RECEIVED delta(kind=head bytes=1799) from S11
[S6] cosine check vs S11: cos=0.9741
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=13 metric=0.6298 head_norm=1.593101
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.804379e-01
[S6] stored merged vector for next round verification (round=13)
[S6] DEBUG after merge:  round=13 metric=0.6475 head_norm=1.551951 delta_norm=0.180438
[S6] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=13 metric=0.7006 head_norm=1.134408
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.827489e-01
[S3] stored merged vector for next round verification (round=13)
[S3] DEBUG after merge:  round=13 metric=0.7006 head_norm=0.968167 delta_norm=0.282749
[S3] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=13 metric=0.7142 head_norm=1.294779
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.263204e-01
[S8] stored merged vector for next round verification (round=13)
[S8] DEBUG after merge:  round=13 metric=0.7142 head_norm=1.257999 delta_norm=0.126320
[S8] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=13 metric=0.6887 head_norm=1.027418
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.451128e-01
[S10] stored merged vector for next round verification (round=13)
[S10] DEBUG after merge:  round=13 metric=0.6890 head_norm=1.072463 delta_norm=0.145113
[S10] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=13 metric=0.9781 head_norm=1.670768
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.121942e-01
[S14] stored merged vector for next round verification (round=13)
[S14] DEBUG after merge:  round=13 metric=0.9887 head_norm=1.324244 delta_norm=0.412194
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.185777 cos_to_last_merge=0.8268 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.827
[S2] round=14 local utility u=0.042704 metrics={'f1_val': 0.7119986693664153, 'auprc': 0.7866465119060279, 'loss_val': 0.48523551460232306, 'psi': 0.7418578063822603}-{'f1_val': 0.7120117472303769, 'auprc': 0.7846699165275045, 'loss_val': 0.5647916661378681, 'psi': 0.7410750149492279}
[S3] START round=14 head_norm_before_train=0.968167 cos_to_last_merge=1.0000 (last merge round=13)
[S3] round=14 local utility u=0.047725 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9985736587825528, 'loss_val': 0.4507403318986277, 'psi': 0.8198831857542008}-{'f1_val': 0.7005813959920884, 'auprc': 0.9993247900041023, 'loss_val': 0.5473955810023013, 'psi': 0.820078753596894}
[S4] START round=14 head_norm_before_train=0.864700 cos_to_last_merge=0.9937 (last merge round=12)
[S4] round=14 local utility u=0.840840 metrics={'f1_val': 0.9500226112774898, 'auprc': 0.8948722344160748, 'loss_val': 0.5777976753911892, 'psi': 0.9279624605329237}-{'f1_val': 0.6635790364005343, 'auprc': 0.9418437193686866, 'loss_val': 0.6817309676457705, 'psi': 0.7748849095877952}
[S5] START round=14 head_norm_before_train=0.971893 cos_to_last_merge=0.8676 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.868
[S5] round=14 local utility u=0.000000 metrics={'f1_val': 0.7024966656793308, 'auprc': 0.7721115144824449, 'loss_val': 0.6177330473718361, 'psi': 0.7303426052005764}-{'f1_val': 0.7004090841190582, 'auprc': 0.7930070390273768, 'loss_val': 0.6619648584716252, 'psi': 0.7374482660823857}
[S6] START round=14 head_norm_before_train=1.551951 cos_to_last_merge=1.0000 (last merge round=13)
[S6] round=14 local utility u=0.837485 metrics={'f1_val': 0.8630460002510066, 'auprc': 0.8899137985885794, 'loss_val': 0.4293101193511003, 'psi': 0.8737931195860358}-{'f1_val': 0.6297547723221546, 'auprc': 0.8161035944620025, 'loss_val': 0.483101180904432, 'psi': 0.7042943011780938}
[S7] START round=14 head_norm_before_train=0.838824 cos_to_last_merge=0.9972 (last merge round=12)
[S7] round=14 local utility u=0.119003 metrics={'f1_val': 0.3782960971243944, 'auprc': 0.6168029438910709, 'loss_val': 1.0167402876732343, 'psi': 0.473698835831065}-{'f1_val': 0.37460771026513506, 'auprc': 0.5656964105071599, 'loss_val': 1.0792956631190367, 'psi': 0.45104319036194496}
[S8] START round=14 head_norm_before_train=1.257999 cos_to_last_merge=1.0000 (last merge round=13)
[S8] round=14 local utility u=0.231998 metrics={'f1_val': 0.7725677620579388, 'auprc': 0.998419363039271, 'loss_val': 0.22653901131943974, 'psi': 0.8629084024504716}-{'f1_val': 0.7142391053978291, 'auprc': 0.99757320103065, 'loss_val': 0.3380253014245936, 'psi': 0.8275727436509575}
[S9] START round=14 head_norm_before_train=1.399654 cos_to_last_merge=0.8990 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.899
[S9] round=14 local utility u=0.283346 metrics={'f1_val': 0.7806847509120289, 'auprc': 0.9984636200051337, 'loss_val': 0.1820754831977282, 'psi': 0.8677962985492709}-{'f1_val': 0.6926782676589199, 'auprc': 0.9980898956744128, 'loss_val': 0.2196076366638606, 'psi': 0.8148429188651171}
[S10] START round=14 head_norm_before_train=1.072463 cos_to_last_merge=1.0000 (last merge round=13)
[S10] round=14 local utility u=0.100992 metrics={'f1_val': 0.7003629452913912, 'auprc': 0.9974707486924321, 'loss_val': 0.40432436294159535, 'psi': 0.8192060666518076}-{'f1_val': 0.6887135971856682, 'auprc': 0.9968911946963801, 'loss_val': 0.5346738851401405, 'psi': 0.811984636189953}
[S11] START round=14 head_norm_before_train=1.531093 cos_to_last_merge=0.9966 (last merge round=11)
[S11] round=14 local utility u=0.040371 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9940097267441917, 'loss_val': 0.33403142730843083, 'psi': 0.8187650806766688}-{'f1_val': 0.702242488399264, 'auprc': 0.9945420430315621, 'loss_val': 0.4182139241227171, 'psi': 0.8191623102521832}
[S13] START round=14 head_norm_before_train=1.233120 cos_to_last_merge=0.9947 (last merge round=11)
[S13] round=14 local utility u=0.000000 metrics={'f1_val': 0.5084269825631574, 'auprc': 0.6653655369731559, 'loss_val': 0.78282996711888, 'psi': 0.5712024043271569}-{'f1_val': 0.6889064238237951, 'auprc': 0.7416688344252765, 'loss_val': 0.7094305161498631, 'psi': 0.7100113880643877}
[S14] START round=14 head_norm_before_train=1.324244 cos_to_last_merge=1.0000 (last merge round=13)
[S14] round=14 local utility u=0.048208 metrics={'f1_val': 0.9972626935085508, 'auprc': 0.997066970992561, 'loss_val': 0.20063281941459676, 'psi': 0.997184404502155}-{'f1_val': 0.9780570968509723, 'auprc': 0.9957161387565003, 'loss_val': 0.177763048535376, 'psi': 0.9851207136131834}
[S15] START round=14 head_norm_before_train=1.534725 (no previous merge yet)
[S15] round=14 local utility u=0.081869 metrics={'f1_val': 0.6938109970918405, 'auprc': 0.9969706829431684, 'loss_val': 0.279450242714687, 'psi': 0.8150748714323717}-{'f1_val': 0.6924005062259557, 'auprc': 0.979666593582426, 'loss_val': 0.3828134255964536, 'psi': 0.8073069411685438}
[S16] START round=14 head_norm_before_train=0.730731 cos_to_last_merge=0.9946 (last merge round=12)
[S16] round=14 local utility u=0.000000 metrics={'f1_val': 0.44696051465914993, 'auprc': 0.7519734169683441, 'loss_val': 0.7642888401958345, 'psi': 0.5689656755828276}-{'f1_val': 0.5459065005731212, 'auprc': 0.7627927682139657, 'loss_val': 0.7916085347707316, 'psi': 0.632661007629459}
[S17] START round=14 head_norm_before_train=1.050294 cos_to_last_merge=0.7725 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.772
[S17] round=14 local utility u=0.000000 metrics={'f1_val': 0.35317771804322007, 'auprc': 0.6594639202018142, 'loss_val': 0.9155977886723976, 'psi': 0.4756921989066577}-{'f1_val': 0.3550841086000084, 'auprc': 0.6714134342260695, 'loss_val': 0.862792882178113, 'psi': 0.48161583885043285}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:49107
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:49111
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:49114
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:49110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:49103
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] sending update (kind=head size=1804 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:49115
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:49104
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S9] → sending delta(kind=head bytes=1806) to S2@127.0.0.1:49102
[S4] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1806 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1801) from S10
[S14] cosine check vs S10: cos=0.9592
[S10] RECEIVED delta(kind=head bytes=1795) from S3
[S10] cosine check vs S3: cos=0.9547
[S15] RECEIVED delta(kind=head bytes=1798) from S2
[S15] cosine check vs S2: cos=-0.1838
[S15] DROPPED delta from S2 (cos=-0.1838 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1796) from S4
[S3] cosine check vs S4: cos=0.9367
[S2] RECEIVED delta(kind=head bytes=1806) from S9
[S2] cosine check vs S9: cos=-0.0286
[S2] DROPPED delta from S9 (cos=-0.0286 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1798) from S11
[S6] cosine check vs S11: cos=0.9884
[S4] RECEIVED delta(kind=head bytes=1799) from S7
[S4] cosine check vs S7: cos=0.9421
[S9] RECEIVED delta(kind=head bytes=1799) from S6
[S9] cosine check vs S6: cos=-0.0360
[S9] DROPPED delta from S6 (cos=-0.0360 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=14 metric=0.9973 head_norm=1.361206
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.131239e-01
[S14] stored merged vector for next round verification (round=14)
[S14] DEBUG after merge:  round=14 metric=0.9973 head_norm=1.229044 delta_norm=0.213124
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=14 metric=0.7008 head_norm=1.023653
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.803222e-01
[S3] stored merged vector for next round verification (round=14)
[S3] DEBUG after merge:  round=14 metric=0.7008 head_norm=0.956127 delta_norm=0.180322
[S3] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=14 metric=0.8630 head_norm=1.578430
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.197102e-01
[S6] stored merged vector for next round verification (round=14)
[S6] DEBUG after merge:  round=14 metric=0.6725 head_norm=1.567565 delta_norm=0.119710
[S6] aggregate: ROLLBACK (f1_val pre=0.863 post=0.673 tol_abs=0.005 tol_rel=0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=14 metric=0.7004 head_norm=1.122079
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.685570e-01
[S10] stored merged vector for next round verification (round=14)
[S10] DEBUG after merge:  round=14 metric=0.7001 head_norm=1.060685 delta_norm=0.168557
[S10] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=14 metric=0.9500 head_norm=0.919524
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.541472e-01
[S4] stored merged vector for next round verification (round=14)
[S4] DEBUG after merge:  round=14 metric=0.9237 head_norm=0.876984 delta_norm=0.154147
[S4] aggregate: ROLLBACK (f1_val pre=0.950 post=0.924 tol_abs=0.005 tol_rel=0.0)
[S2] START round=15 head_norm_before_train=1.239935 cos_to_last_merge=0.8141 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.814
[S2] round=15 local utility u=0.004303 metrics={'f1_val': 0.6990303697204915, 'auprc': 0.7843681840688514, 'loss_val': 0.39198499971080514, 'psi': 0.7331654954598354}-{'f1_val': 0.7119986693664153, 'auprc': 0.7866465119060279, 'loss_val': 0.48523551460232306, 'psi': 0.7418578063822603}
[S3] START round=15 head_norm_before_train=0.956127 cos_to_last_merge=1.0000 (last merge round=14)
[S3] round=15 local utility u=0.019047 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9985382757677217, 'loss_val': 0.4125403521609735, 'psi': 0.8198690325482685}-{'f1_val': 0.7007562037352997, 'auprc': 0.9985736587825528, 'loss_val': 0.4507403318986277, 'psi': 0.8198831857542008}
[S4] START round=15 head_norm_before_train=0.876984 cos_to_last_merge=1.0000 (last merge round=14)
[S4] round=15 local utility u=0.059012 metrics={'f1_val': 0.9462598329496981, 'auprc': 0.9170036467993582, 'loss_val': 0.5035920406133956, 'psi': 0.9345573584895621}-{'f1_val': 0.9500226112774898, 'auprc': 0.8948722344160748, 'loss_val': 0.5777976753911892, 'psi': 0.9279624605329237}
[S5] START round=15 head_norm_before_train=0.996339 cos_to_last_merge=0.8585 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.858
[S5] round=15 local utility u=0.000000 metrics={'f1_val': 0.7008162875368863, 'auprc': 0.7022670346875735, 'loss_val': 0.5711576414635712, 'psi': 0.7013965863971612}-{'f1_val': 0.7024966656793308, 'auprc': 0.7721115144824449, 'loss_val': 0.6177330473718361, 'psi': 0.7303426052005764}
[S6] START round=15 head_norm_before_train=1.567565 cos_to_last_merge=1.0000 (last merge round=14)
[S6] round=15 local utility u=0.000000 metrics={'f1_val': 0.824540588153206, 'auprc': 0.8750291263154953, 'loss_val': 0.3774210073875255, 'psi': 0.8447360034181217}-{'f1_val': 0.8630460002510066, 'auprc': 0.8899137985885794, 'loss_val': 0.4293101193511003, 'psi': 0.8737931195860358}
[S7] START round=15 head_norm_before_train=0.860349 cos_to_last_merge=0.9918 (last merge round=12)
[S7] round=15 local utility u=0.053636 metrics={'f1_val': 0.3880056592723988, 'auprc': 0.6258052229107426, 'loss_val': 0.9947329789521341, 'psi': 0.4831254847277363}-{'f1_val': 0.3782960971243944, 'auprc': 0.6168029438910709, 'loss_val': 1.0167402876732343, 'psi': 0.473698835831065}
[S8] START round=15 head_norm_before_train=1.283684 cos_to_last_merge=0.9997 (last merge round=13)
[S8] round=15 local utility u=0.000000 metrics={'f1_val': 0.7142391053978291, 'auprc': 0.9984823810273205, 'loss_val': 0.20960349038707757, 'psi': 0.8279364156496256}-{'f1_val': 0.7725677620579388, 'auprc': 0.998419363039271, 'loss_val': 0.22653901131943974, 'psi': 0.8629084024504716}
[S9] START round=15 head_norm_before_train=1.432590 cos_to_last_merge=0.8899 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.890
[S9] round=15 local utility u=0.000000 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9988436772330959, 'loss_val': 0.18350923965750726, 'psi': 0.8202674193572494}-{'f1_val': 0.7806847509120289, 'auprc': 0.9984636200051337, 'loss_val': 0.1820754831977282, 'psi': 0.8677962985492709}
[S10] START round=15 head_norm_before_train=1.060685 cos_to_last_merge=1.0000 (last merge round=14)
[S10] round=15 local utility u=0.008021 metrics={'f1_val': 0.7012347983485312, 'auprc': 0.9942494513299163, 'loss_val': 0.38385036389628674, 'psi': 0.8184406595410852}-{'f1_val': 0.7003629452913912, 'auprc': 0.9974707486924321, 'loss_val': 0.40432436294159535, 'psi': 0.8192060666518076}
[S11] START round=15 head_norm_before_train=1.565803 cos_to_last_merge=0.9939 (last merge round=11)
[S11] round=15 local utility u=0.036255 metrics={'f1_val': 0.7021770286274283, 'auprc': 0.9963218979727508, 'loss_val': 0.26990841385501674, 'psi': 0.8198349763655572}-{'f1_val': 0.7019353166316534, 'auprc': 0.9940097267441917, 'loss_val': 0.33403142730843083, 'psi': 0.8187650806766688}
[S13] START round=15 head_norm_before_train=1.259903 cos_to_last_merge=0.9909 (last merge round=11)
[S13] round=15 local utility u=0.777139 metrics={'f1_val': 0.7107491609135325, 'auprc': 0.7278349406538377, 'loss_val': 0.6298926044025496, 'psi': 0.7175834728096546}-{'f1_val': 0.5084269825631574, 'auprc': 0.6653655369731559, 'loss_val': 0.78282996711888, 'psi': 0.5712024043271569}
[S14] START round=15 head_norm_before_train=1.229044 cos_to_last_merge=1.0000 (last merge round=14)
[S14] round=15 local utility u=0.000000 metrics={'f1_val': 0.9766451219118534, 'auprc': 0.9970919551966655, 'loss_val': 0.2153124550865265, 'psi': 0.9848238552257782}-{'f1_val': 0.9972626935085508, 'auprc': 0.997066970992561, 'loss_val': 0.20063281941459676, 'psi': 0.997184404502155}
[S15] START round=15 head_norm_before_train=1.565193 (no previous merge yet)
[S15] round=15 local utility u=0.000000 metrics={'f1_val': 0.6967221813158355, 'auprc': 0.9867717261549092, 'loss_val': 0.32104236491484334, 'psi': 0.812741999251465}-{'f1_val': 0.6938109970918405, 'auprc': 0.9969706829431684, 'loss_val': 0.279450242714687, 'psi': 0.8150748714323717}
[S16] START round=15 head_norm_before_train=0.789313 cos_to_last_merge=0.9839 (last merge round=12)
[S16] round=15 local utility u=0.853368 metrics={'f1_val': 0.7208764386750932, 'auprc': 0.7672147064194509, 'loss_val': 0.7467716085442836, 'psi': 0.7394117457728363}-{'f1_val': 0.44696051465914993, 'auprc': 0.7519734169683441, 'loss_val': 0.7642888401958345, 'psi': 0.5689656755828276}
[S17] START round=15 head_norm_before_train=1.064110 cos_to_last_merge=0.7680 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.768
[S17] round=15 local utility u=0.000483 metrics={'f1_val': 0.3528973082439505, 'auprc': 0.6674090777893886, 'loss_val': 0.9367851683595255, 'psi': 0.4787020160621257}-{'f1_val': 0.35317771804322007, 'auprc': 0.6594639202018142, 'loss_val': 0.9155977886723976, 'psi': 0.4756921989066577}
[S3]  timeout peer S2
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S2]  timeout peer S3
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S16
[S2]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S16
[S8]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S15
[S10]  timeout peer S17
[S4]  timeout peer S2
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S5]  timeout peer S17
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S6
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S6]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S16
[S14]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:49104
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S17] sending update (kind=head size=1790 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:49114
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:49109
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S3] → sending delta(kind=head bytes=1791) to S10@127.0.0.1:49111
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:49107
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:49103
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] ⇄ pheromone p=0.309 → S9@127.0.0.1:49110
[S7] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1791 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1795 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1799) from S7
[S4] cosine check vs S7: cos=0.9745
[S8] RECEIVED delta(kind=head bytes=1797) from S13
[S8] cosine check vs S13: cos=0.9863
[S14] RECEIVED delta(kind=head bytes=1795) from S10
[S14] cosine check vs S10: cos=0.9626
[S10] RECEIVED delta(kind=head bytes=1791) from S3
[S10] cosine check vs S3: cos=0.9478
[S6] RECEIVED delta(kind=head bytes=1801) from S11
[S6] cosine check vs S11: cos=0.9943
[S3] RECEIVED delta(kind=head bytes=1795) from S4
[S3] cosine check vs S4: cos=0.9574
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=15 metric=0.7008 head_norm=1.011864
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.471246e-01
[S3] stored merged vector for next round verification (round=15)
[S3] DEBUG after merge:  round=15 metric=0.7008 head_norm=0.962835 delta_norm=0.147125
[S3] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.184 → S10@127.0.0.1:49111
[S7] ⇄ pheromone p=0.211 → S4@127.0.0.1:49104
[S13] ⇄ pheromone p=0.360 → S8@127.0.0.1:49109
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=15 metric=0.7142 head_norm=1.312236
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.085755e-01
[S8] stored merged vector for next round verification (round=15)
[S8] DEBUG after merge:  round=15 metric=0.7142 head_norm=1.292597 delta_norm=0.108575
[S8] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] → sending delta(kind=head bytes=1794) to S11@127.0.0.1:49112
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:49115
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=15 metric=0.9463 head_norm=0.934625
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.058176e-01
[S4] stored merged vector for next round verification (round=15)
[S4] DEBUG after merge:  round=15 metric=0.9260 head_norm=0.902803 delta_norm=0.105818
[S4] aggregate: ROLLBACK (f1_val pre=0.946 post=0.926 tol_abs=0.005 tol_rel=0.0)
[S4] ⇄ pheromone p=0.303 → S3@127.0.0.1:49103
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=15 metric=0.7012 head_norm=1.108536
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.777344e-01
[S10] stored merged vector for next round verification (round=15)
[S10] DEBUG after merge:  round=15 metric=0.7012 head_norm=1.046313 delta_norm=0.177734
[S10] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.261 → S14@127.0.0.1:49114
[S2] sending update (kind=head size=1800 to 1 peers)
[S9] ⇄ pheromone p=0.161 → S2@127.0.0.1:49102
[S16] sending update (kind=head size=1794 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1794) from S16
[S11] cosine check vs S16: cos=0.4985
[S15] RECEIVED delta(kind=head bytes=1800) from S2
[S15] cosine check vs S2: cos=-0.1866
[S15] DROPPED delta from S2 (cos=-0.1866 < 0.0)
[S2] ⇄ pheromone p=0.176 → S15@127.0.0.1:49115
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=15 metric=0.7022 head_norm=1.601242
[S11] _apply_head_vector_avg (torch): Δ‖w‖=6.945440e-01
[S11] stored merged vector for next round verification (round=15)
[S11] DEBUG after merge:  round=15 metric=0.7019 head_norm=1.077288 delta_norm=0.694544
[S11] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.197 → S6@127.0.0.1:49107
[S16] CommDone barrier timeout: have=1 need=2 — continuing
[S2] START round=16 head_norm_before_train=1.283361 cos_to_last_merge=0.8052 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.805
[S2] round=16 local utility u=0.015888 metrics={'f1_val': 0.6992159751265115, 'auprc': 0.7861347121424727, 'loss_val': 0.3666225413369387, 'psi': 0.733983469932896}-{'f1_val': 0.6990303697204915, 'auprc': 0.7843681840688514, 'loss_val': 0.39198499971080514, 'psi': 0.7331654954598354}
[S3] START round=16 head_norm_before_train=0.962835 cos_to_last_merge=1.0000 (last merge round=15)
[S3] round=16 local utility u=0.011957 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9991877786880542, 'loss_val': 0.3905757420373204, 'psi': 0.8201288337164014}-{'f1_val': 0.7007562037352997, 'auprc': 0.9985382757677217, 'loss_val': 0.4125403521609735, 'psi': 0.8198690325482685}
[S4] START round=16 head_norm_before_train=0.902803 cos_to_last_merge=1.0000 (last merge round=15)
[S4] round=16 local utility u=0.089574 metrics={'f1_val': 0.9504091090260083, 'auprc': 0.9544767427144427, 'loss_val': 0.46175993896485945, 'psi': 0.952036162501382}-{'f1_val': 0.9462598329496981, 'auprc': 0.9170036467993582, 'loss_val': 0.5035920406133956, 'psi': 0.9345573584895621}
[S5] START round=16 head_norm_before_train=1.029147 cos_to_last_merge=0.8483 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.848
[S5] round=16 local utility u=0.058432 metrics={'f1_val': 0.7008175646132602, 'auprc': 0.7130062006797615, 'loss_val': 0.4865189564059029, 'psi': 0.7056930190398607}-{'f1_val': 0.7008162875368863, 'auprc': 0.7022670346875735, 'loss_val': 0.5711576414635712, 'psi': 0.7013965863971612}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] START round=16 head_norm_before_train=1.592595 cos_to_last_merge=0.9997 (last merge round=14)
[S6] round=16 local utility u=0.000000 metrics={'f1_val': 0.6092018955296933, 'auprc': 0.7903384211546847, 'loss_val': 0.6019691393252502, 'psi': 0.6816565057796898}-{'f1_val': 0.824540588153206, 'auprc': 0.8750291263154953, 'loss_val': 0.3774210073875255, 'psi': 0.8447360034181217}
[S7] START round=16 head_norm_before_train=0.882596 cos_to_last_merge=0.9855 (last merge round=12)
[S7] round=16 local utility u=0.000000 metrics={'f1_val': 0.3803154686849074, 'auprc': 0.6266100160538132, 'loss_val': 1.0159989881943234, 'psi': 0.4788332876324697}-{'f1_val': 0.3880056592723988, 'auprc': 0.6258052229107426, 'loss_val': 0.9947329789521341, 'psi': 0.4831254847277363}
[S8] START round=16 head_norm_before_train=1.292597 cos_to_last_merge=1.0000 (last merge round=15)
[S8] round=16 local utility u=0.277068 metrics={'f1_val': 0.8046750718015356, 'auprc': 0.9987259402721558, 'loss_val': 0.19881471897862613, 'psi': 0.8822954191897837}-{'f1_val': 0.7142391053978291, 'auprc': 0.9984823810273205, 'loss_val': 0.20960349038707757, 'psi': 0.8279364156496256}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=16 head_norm_before_train=1.461886 cos_to_last_merge=0.8818 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.882
[S9] round=16 local utility u=0.887161 metrics={'f1_val': 0.9882473538397808, 'auprc': 0.9988280208141196, 'loss_val': 0.13132555299187085, 'psi': 0.9924796206295163}-{'f1_val': 0.7012165807733519, 'auprc': 0.9988436772330959, 'loss_val': 0.18350923965750726, 'psi': 0.8202674193572494}
[S10] START round=16 head_norm_before_train=1.046313 cos_to_last_merge=1.0000 (last merge round=15)
[S10] round=16 local utility u=0.335345 metrics={'f1_val': 0.8087738082476807, 'auprc': 0.9957185232378036, 'loss_val': 0.3628016966961944, 'psi': 0.8835516942437298}-{'f1_val': 0.7012347983485312, 'auprc': 0.9942494513299163, 'loss_val': 0.38385036389628674, 'psi': 0.8184406595410852}
[S11] START round=16 head_norm_before_train=1.077288 cos_to_last_merge=1.0000 (last merge round=15)
[S11] round=16 local utility u=0.701118 metrics={'f1_val': 0.9591104080300948, 'auprc': 0.996373814557483, 'loss_val': 0.40942845281739876, 'psi': 0.97401577064105}-{'f1_val': 0.7021770286274283, 'auprc': 0.9963218979727508, 'loss_val': 0.26990841385501674, 'psi': 0.8198349763655572}
[S13] START round=16 head_norm_before_train=1.281883 cos_to_last_merge=0.9880 (last merge round=11)
[S13] round=16 local utility u=0.000000 metrics={'f1_val': 0.6939106476102413, 'auprc': 0.7285996382483508, 'loss_val': 0.6053191121649565, 'psi': 0.7077862438654852}-{'f1_val': 0.7107491609135325, 'auprc': 0.7278349406538377, 'loss_val': 0.6298926044025496, 'psi': 0.7175834728096546}
[S14] START round=16 head_norm_before_train=1.273497 cos_to_last_merge=0.9991 (last merge round=14)
[S14] round=16 local utility u=0.103017 metrics={'f1_val': 0.9978938390605482, 'auprc': 0.9970659267042042, 'loss_val': 0.13669183783897734, 'psi': 0.9975626741180106}-{'f1_val': 0.9766451219118534, 'auprc': 0.9970919551966655, 'loss_val': 0.2153124550865265, 'psi': 0.9848238552257782}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S14] sending update (kind=head size=1808 to 1 peers)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=16 metric=0.9979 head_norm=1.320122
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.058409e-01
[S14] stored merged vector for next round verification (round=16)
[S14] DEBUG after merge:  round=16 metric=0.9979 head_norm=1.201423 delta_norm=0.205841
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S15] START round=16 head_norm_before_train=1.604596 (no previous merge yet)
[S15] round=16 local utility u=0.066813 metrics={'f1_val': 0.6988880656119524, 'auprc': 0.9955373669322667, 'loss_val': 0.22670877476593046, 'psi': 0.8175477861400782}-{'f1_val': 0.6967221813158355, 'auprc': 0.9867717261549092, 'loss_val': 0.32104236491484334, 'psi': 0.812741999251465}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=16 head_norm_before_train=0.849650 cos_to_last_merge=0.9726 (last merge round=12)
[S16] round=16 local utility u=0.413221 metrics={'f1_val': 0.8232183473495929, 'auprc': 0.803823010114322, 'loss_val': 0.6442060977862162, 'psi': 0.8154602124554845}-{'f1_val': 0.7208764386750932, 'auprc': 0.7672147064194509, 'loss_val': 0.7467716085442836, 'psi': 0.7394117457728363}
[S17] START round=16 head_norm_before_train=1.078531 cos_to_last_merge=0.7636 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.764
[S17] round=16 local utility u=0.492585 metrics={'f1_val': 0.526839201731533, 'auprc': 0.6641816132896171, 'loss_val': 0.9855850266432341, 'psi': 0.5817761663547666}-{'f1_val': 0.3528973082439505, 'auprc': 0.6674090777893886, 'loss_val': 0.9367851683595255, 'psi': 0.4787020160621257}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S17] sending update (kind=head size=1788 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] sending update (kind=head size=1795 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S4] sending update (kind=head size=1791 to 1 peers)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=16 metric=0.6092 head_norm=1.612842
[S6] _apply_head_vector_avg (torch): Δ‖w‖=9.655102e-02
[S6] stored merged vector for next round verification (round=16)
[S6] DEBUG after merge:  round=16 metric=0.6108 head_norm=1.604150 delta_norm=0.096551
[S6] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S4]  timeout peer S3
[S4]  timeout peer S17
[S16]  timeout peer S5
[S16]  timeout peer S7
[S16]  timeout peer S11
[S7]  timeout peer S4
[S13]  timeout peer S8
[S11]  timeout peer S6
[S11]  timeout peer S13
[S6]  timeout peer S9
[S3]  timeout peer S10
[S2]  timeout peer S15
[S9]  timeout peer S2
[S10]  timeout peer S14
[S10]  timeout peer S16
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] sending update (kind=head size=1795 to 1 peers)
[S2] START round=17 head_norm_before_train=1.323994 cos_to_last_merge=0.7973 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.797
[S2] round=17 local utility u=0.000000 metrics={'f1_val': 0.6969865609021697, 'auprc': 0.6608789332526325, 'loss_val': 0.3440020084212605, 'psi': 0.6825435098423549}-{'f1_val': 0.6992159751265115, 'auprc': 0.7861347121424727, 'loss_val': 0.3666225413369387, 'psi': 0.733983469932896}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=17 head_norm_before_train=1.016676 cos_to_last_merge=0.9978 (last merge round=15)
[S3] round=17 local utility u=0.000000 metrics={'f1_val': 0.6994323627958012, 'auprc': 0.9340702356515451, 'loss_val': 0.4019587718232162, 'psi': 0.7932875119380988}-{'f1_val': 0.7007562037352997, 'auprc': 0.9991877786880542, 'loss_val': 0.3905757420373204, 'psi': 0.8201288337164014}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=17 head_norm_before_train=0.953468 cos_to_last_merge=0.9981 (last merge round=15)
[S4] round=17 local utility u=0.054485 metrics={'f1_val': 0.9483127317386671, 'auprc': 0.9725737027979264, 'loss_val': 0.39450183906502284, 'psi': 0.9580171201623708}-{'f1_val': 0.9504091090260083, 'auprc': 0.9544767427144427, 'loss_val': 0.46175993896485945, 'psi': 0.952036162501382}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=17 head_norm_before_train=1.064549 cos_to_last_merge=0.8383 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.838
[S5] round=17 local utility u=0.088087 metrics={'f1_val': 0.6982091163121088, 'auprc': 0.7812454156427557, 'loss_val': 0.49941118389728956, 'psi': 0.7314236360443676}-{'f1_val': 0.7008175646132602, 'auprc': 0.7130062006797615, 'loss_val': 0.4865189564059029, 'psi': 0.7056930190398607}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] sending update (kind=head size=1794 to 1 peers)
[S6] START round=17 head_norm_before_train=1.604150 cos_to_last_merge=1.0000 (last merge round=16)
[S6] round=17 local utility u=1.000000 metrics={'f1_val': 0.9372890348171184, 'auprc': 0.9481351951361341, 'loss_val': 0.2541236536234372, 'psi': 0.9416274989447248}-{'f1_val': 0.6092018955296933, 'auprc': 0.7903384211546847, 'loss_val': 0.6019691393252502, 'psi': 0.6816565057796898}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] sending update (kind=head size=1796 to 1 peers)
[S7] START round=17 head_norm_before_train=0.903881 cos_to_last_merge=0.9794 (last merge round=12)
[S7] round=17 local utility u=0.000000 metrics={'f1_val': 0.3786372263616118, 'auprc': 0.6298716132002039, 'loss_val': 1.029402438573641, 'psi': 0.47913098109704866}-{'f1_val': 0.3803154686849074, 'auprc': 0.6266100160538132, 'loss_val': 1.0159989881943234, 'psi': 0.4788332876324697}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=17 head_norm_before_train=1.324013 cos_to_last_merge=0.9994 (last merge round=15)
[S8] round=17 local utility u=0.587176 metrics={'f1_val': 0.9953090256598752, 'auprc': 0.9989424069257172, 'loss_val': 0.1689157640370723, 'psi': 0.996762378166212}-{'f1_val': 0.8046750718015356, 'auprc': 0.9987259402721558, 'loss_val': 0.19881471897862613, 'psi': 0.8822954191897837}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S8] sending update (kind=head size=1806 to 1 peers)
[S9] START round=17 head_norm_before_train=1.490298 cos_to_last_merge=0.8746 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.875
[S9] round=17 local utility u=0.014670 metrics={'f1_val': 0.9899455008418782, 'auprc': 0.9988221115922347, 'loss_val': 0.11215756502511912, 'psi': 0.9934961451420208}-{'f1_val': 0.9882473538397808, 'auprc': 0.9988280208141196, 'loss_val': 0.13132555299187085, 'psi': 0.9924796206295163}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=17 head_norm_before_train=1.086089 cos_to_last_merge=0.9983 (last merge round=15)
[S10] round=17 local utility u=0.382175 metrics={'f1_val': 0.9239330835380296, 'auprc': 0.9962563685129794, 'loss_val': 0.291021168878081, 'psi': 0.9528623975280095}-{'f1_val': 0.8087738082476807, 'auprc': 0.9957185232378036, 'loss_val': 0.3628016966961944, 'psi': 0.8835516942437298}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=17 head_norm_before_train=1.121417 cos_to_last_merge=0.9990 (last merge round=15)
[S11] round=17 local utility u=0.053888 metrics={'f1_val': 0.9574810798704112, 'auprc': 0.9957856931886435, 'loss_val': 0.2901123588439086, 'psi': 0.9728029251977042}-{'f1_val': 0.9591104080300948, 'auprc': 0.996373814557483, 'loss_val': 0.40942845281739876, 'psi': 0.97401577064105}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] sending update (kind=head size=1803 to 1 peers)
[S13] START round=17 head_norm_before_train=1.306652 cos_to_last_merge=0.9849 (last merge round=11)
[S13] round=17 local utility u=0.000000 metrics={'f1_val': 0.6268785771121226, 'auprc': 0.7397730056623336, 'loss_val': 0.5938322537942156, 'psi': 0.672036348532207}-{'f1_val': 0.6939106476102413, 'auprc': 0.7285996382483508, 'loss_val': 0.6053191121649565, 'psi': 0.7077862438654852}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=17 head_norm_before_train=1.201423 cos_to_last_merge=1.0000 (last merge round=16)
[S14] round=17 local utility u=0.000000 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.9978693285670285, 'loss_val': 0.17963873902392744, 'psi': 0.9978394422071424}-{'f1_val': 0.9978938390605482, 'auprc': 0.9970659267042042, 'loss_val': 0.13669183783897734, 'psi': 0.9975626741180106}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=17 head_norm_before_train=1.638731 (no previous merge yet)
[S15] round=17 local utility u=0.000000 metrics={'f1_val': 0.6956520056461066, 'auprc': 0.9876600153884335, 'loss_val': 0.25271130503273226, 'psi': 0.8124552095430373}-{'f1_val': 0.6988880656119524, 'auprc': 0.9955373669322667, 'loss_val': 0.22670877476593046, 'psi': 0.8175477861400782}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=17 head_norm_before_train=0.909220 cos_to_last_merge=0.9610 (last merge round=12)
[S16] round=17 local utility u=0.198097 metrics={'f1_val': 0.8525443128416493, 'auprc': 0.8542813458614789, 'loss_val': 0.575342619321774, 'psi': 0.8532391260495812}-{'f1_val': 0.8232183473495929, 'auprc': 0.803823010114322, 'loss_val': 0.6442060977862162, 'psi': 0.8154602124554845}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] sending update (kind=head size=1795 to 1 peers)
[S17] START round=17 head_norm_before_train=1.092649 cos_to_last_merge=0.7585 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.759
[S17] round=17 local utility u=0.000000 metrics={'f1_val': 0.34753741415347866, 'auprc': 0.6674829570016536, 'loss_val': 1.0032902857564163, 'psi': 0.47551563129274865}-{'f1_val': 0.526839201731533, 'auprc': 0.6641816132896171, 'loss_val': 0.9855850266432341, 'psi': 0.5817761663547666}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=18 head_norm_before_train=1.356665 cos_to_last_merge=0.7915 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.791
[S2] round=18 local utility u=0.124869 metrics={'f1_val': 0.6991410006860137, 'auprc': 0.7403764447661347, 'loss_val': 0.34568397728974426, 'psi': 0.7156351783180621}-{'f1_val': 0.6969865609021697, 'auprc': 0.6608789332526325, 'loss_val': 0.3440020084212605, 'psi': 0.6825435098423549}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=18 head_norm_before_train=1.066670 cos_to_last_merge=0.9934 (last merge round=15)
[S3] round=18 local utility u=0.157847 metrics={'f1_val': 0.7018768808926283, 'auprc': 0.9989767978937197, 'loss_val': 0.29565143228480883, 'psi': 0.8207168476930649}-{'f1_val': 0.6994323627958012, 'auprc': 0.9340702356515451, 'loss_val': 0.4019587718232162, 'psi': 0.7932875119380988}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S3] sending update (kind=head size=1790 to 1 peers)
[S4] START round=18 head_norm_before_train=1.005468 cos_to_last_merge=0.9932 (last merge round=15)
[S4] round=18 local utility u=0.000000 metrics={'f1_val': 0.9450980913769524, 'auprc': 0.9585916104969149, 'loss_val': 0.3508010957333163, 'psi': 0.9504954990249375}-{'f1_val': 0.9483127317386671, 'auprc': 0.9725737027979264, 'loss_val': 0.39450183906502284, 'psi': 0.9580171201623708}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=18 head_norm_before_train=1.098464 cos_to_last_merge=0.8294 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.829
[S5] round=18 local utility u=0.072661 metrics={'f1_val': 0.7005691551769304, 'auprc': 0.7858175201581403, 'loss_val': 0.3819660934025223, 'psi': 0.7346685011694144}-{'f1_val': 0.6982091163121088, 'auprc': 0.7812454156427557, 'loss_val': 0.49941118389728956, 'psi': 0.7314236360443676}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=18 head_norm_before_train=1.617614 cos_to_last_merge=0.9998 (last merge round=16)
[S6] round=18 local utility u=0.000000 metrics={'f1_val': 0.7050737229533859, 'auprc': 0.774368496009151, 'loss_val': 0.5455512397123581, 'psi': 0.732791632175692}-{'f1_val': 0.9372890348171184, 'auprc': 0.9481351951361341, 'loss_val': 0.2541236536234372, 'psi': 0.9416274989447248}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=18 head_norm_before_train=0.928240 cos_to_last_merge=0.9723 (last merge round=12)
[S7] round=18 local utility u=0.000000 metrics={'f1_val': 0.3793935889642782, 'auprc': 0.6150952085072197, 'loss_val': 1.0798702627639016, 'psi': 0.4736742367814548}-{'f1_val': 0.3786372263616118, 'auprc': 0.6298716132002039, 'loss_val': 1.029402438573641, 'psi': 0.47913098109704866}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=18 head_norm_before_train=1.359285 cos_to_last_merge=0.9974 (last merge round=15)
[S8] round=18 local utility u=0.000299 metrics={'f1_val': 0.9935178734003183, 'auprc': 0.9971768821326079, 'loss_val': 0.15227417909295488, 'psi': 0.9949814768932341}-{'f1_val': 0.9953090256598752, 'auprc': 0.9989424069257172, 'loss_val': 0.1689157640370723, 'psi': 0.996762378166212}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=18 head_norm_before_train=1.517678 cos_to_last_merge=0.8683 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.868
[S9] round=18 local utility u=0.011086 metrics={'f1_val': 0.9903686845626269, 'auprc': 0.9988265282900917, 'loss_val': 0.09253822560102976, 'psi': 0.9937518220536128}-{'f1_val': 0.9899455008418782, 'auprc': 0.9988221115922347, 'loss_val': 0.11215756502511912, 'psi': 0.9934961451420208}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=18 head_norm_before_train=1.127847 cos_to_last_merge=0.9943 (last merge round=15)
[S10] round=18 local utility u=0.234976 metrics={'f1_val': 0.9941424730579679, 'auprc': 0.993730590667526, 'loss_val': 0.23474916790615996, 'psi': 0.9939777201017912}-{'f1_val': 0.9239330835380296, 'auprc': 0.9962563685129794, 'loss_val': 0.291021168878081, 'psi': 0.9528623975280095}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=18 head_norm_before_train=1.172632 cos_to_last_merge=0.9959 (last merge round=15)
[S11] round=18 local utility u=0.142551 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9948750906031343, 'loss_val': 0.23667377676675433, 'psi': 0.9958782389494074}-{'f1_val': 0.9574810798704112, 'auprc': 0.9957856931886435, 'loss_val': 0.2901123588439086, 'psi': 0.9728029251977042}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S11] sending update (kind=head size=1807 to 1 peers)
[S13] START round=18 head_norm_before_train=1.331528 cos_to_last_merge=0.9816 (last merge round=11)
[S13] round=18 local utility u=0.046960 metrics={'f1_val': 0.652730680238295, 'auprc': 0.7140788148012815, 'loss_val': 0.5779428302524867, 'psi': 0.6772699340634896}-{'f1_val': 0.6268785771121226, 'auprc': 0.7397730056623336, 'loss_val': 0.5938322537942156, 'psi': 0.672036348532207}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=18 head_norm_before_train=1.238877 cos_to_last_merge=0.9993 (last merge round=16)
[S14] round=18 local utility u=0.014771 metrics={'f1_val': 0.9964355805212295, 'auprc': 0.997059619542908, 'loss_val': 0.13936328702954864, 'psi': 0.9966851961299008}-{'f1_val': 0.9978195179672185, 'auprc': 0.9978693285670285, 'loss_val': 0.17963873902392744, 'psi': 0.9978394422071424}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=18 head_norm_before_train=1.668684 (no previous merge yet)
[S15] round=18 local utility u=0.286318 metrics={'f1_val': 0.7817937291423285, 'auprc': 0.9896347158948411, 'loss_val': 0.20285048228379315, 'psi': 0.8649301238433336}-{'f1_val': 0.6956520056461066, 'auprc': 0.9876600153884335, 'loss_val': 0.25271130503273226, 'psi': 0.8124552095430373}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] sending update (kind=head size=1804 to 1 peers)
[S16] START round=18 head_norm_before_train=0.964665 cos_to_last_merge=0.9498 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.950
[S16] round=18 local utility u=0.312856 metrics={'f1_val': 0.9105245521586207, 'auprc': 0.9074880369587706, 'loss_val': 0.4571325994256817, 'psi': 0.9093099460786807}-{'f1_val': 0.8525443128416493, 'auprc': 0.8542813458614789, 'loss_val': 0.575342619321774, 'psi': 0.8532391260495812}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S17] START round=18 head_norm_before_train=1.104259 cos_to_last_merge=0.7556 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.756
[S17] round=18 local utility u=0.037786 metrics={'f1_val': 0.35192025901315815, 'auprc': 0.6768797261478046, 'loss_val': 0.9822049185693965, 'psi': 0.48190404586701674}-{'f1_val': 0.34753741415347866, 'auprc': 0.6674829570016536, 'loss_val': 1.0032902857564163, 'psi': 0.47551563129274865}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1784 reason=None
[S17] sending update (kind=head size=1784 to 1 peers)
[S2] START round=19 head_norm_before_train=1.386128 cos_to_last_merge=0.7866 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.787
[S2] round=19 local utility u=0.000000 metrics={'f1_val': 0.7123514883338347, 'auprc': 0.7870366135949329, 'loss_val': 0.6278901902638504, 'psi': 0.742225538438274}-{'f1_val': 0.6991410006860137, 'auprc': 0.7403764447661347, 'loss_val': 0.34568397728974426, 'psi': 0.7156351783180621}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=20 psi=0.742 u=0.0000 p_local=0.0936 f1=0.712 auprc=0.787 bytes=23388
[S3] START round=19 head_norm_before_train=1.114302 cos_to_last_merge=0.9882 (last merge round=15)
[S3] round=19 local utility u=0.000000 metrics={'f1_val': 0.7033783484418332, 'auprc': 0.9876181992107763, 'loss_val': 0.3079568113526649, 'psi': 0.8170742887494105}-{'f1_val': 0.7018768808926283, 'auprc': 0.9989767978937197, 'loss_val': 0.29565143228480883, 'psi': 0.8207168476930649}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=20 psi=0.817 u=0.0000 p_local=0.1019 f1=0.703 auprc=0.988 bytes=25123
[S4] START round=19 head_norm_before_train=1.044929 cos_to_last_merge=0.9883 (last merge round=15)
[S4] round=19 local utility u=0.013339 metrics={'f1_val': 0.9407256392073031, 'auprc': 0.9628323842373547, 'loss_val': 0.3106110895988532, 'psi': 0.9495683372193238}-{'f1_val': 0.9450980913769524, 'auprc': 0.9585916104969149, 'loss_val': 0.3508010957333163, 'psi': 0.9504954990249375}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S4] r=20 psi=0.950 u=0.0133 p_local=0.1428 f1=0.941 auprc=0.963 bytes=32334
[S5] START round=19 head_norm_before_train=1.129639 cos_to_last_merge=0.8224 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.822
[S5] round=19 local utility u=0.000000 metrics={'f1_val': 0.4178296265806952, 'auprc': 0.7585377113643336, 'loss_val': 1.0756154913433664, 'psi': 0.5541128604941505}-{'f1_val': 0.7005691551769304, 'auprc': 0.7858175201581403, 'loss_val': 0.3819660934025223, 'psi': 0.7346685011694144}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=20 psi=0.554 u=0.0000 p_local=0.0979 f1=0.418 auprc=0.759 bytes=26970
[S6] START round=19 head_norm_before_train=1.631219 cos_to_last_merge=0.9995 (last merge round=16)
[S6] round=19 local utility u=0.000000 metrics={'f1_val': 0.5893534974150846, 'auprc': 0.7900175236091421, 'loss_val': 0.6489916224205713, 'psi': 0.6696191078927076}-{'f1_val': 0.7050737229533859, 'auprc': 0.774368496009151, 'loss_val': 0.5455512397123581, 'psi': 0.732791632175692}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=20 psi=0.670 u=0.0000 p_local=0.2547 f1=0.589 auprc=0.790 bytes=17963
[S7] START round=19 head_norm_before_train=0.953832 cos_to_last_merge=0.9650 (last merge round=12)
[S7] round=19 local utility u=0.000000 metrics={'f1_val': 0.3761400688657305, 'auprc': 0.5838989495883585, 'loss_val': 1.1706036163323603, 'psi': 0.4592436211547817}-{'f1_val': 0.3793935889642782, 'auprc': 0.6150952085072197, 'loss_val': 1.0798702627639016, 'psi': 0.4736742367814548}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] r=20 psi=0.459 u=0.0000 p_local=0.0864 f1=0.376 auprc=0.584 bytes=21555
[S8] START round=19 head_norm_before_train=1.392320 cos_to_last_merge=0.9944 (last merge round=15)
[S8] round=19 local utility u=0.015944 metrics={'f1_val': 0.9927466462064712, 'auprc': 0.9983736682091995, 'loss_val': 0.11934833837493751, 'psi': 0.9949974550075625}-{'f1_val': 0.9935178734003183, 'auprc': 0.9971768821326079, 'loss_val': 0.15227417909295488, 'psi': 0.9949814768932341}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] sending update (kind=head size=1804 to 1 peers)
[S8] r=20 psi=0.995 u=0.0159 p_local=0.1822 f1=0.993 auprc=0.998 bytes=28759
[S9] START round=19 head_norm_before_train=1.545254 cos_to_last_merge=0.8621 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.862
[S9] round=19 local utility u=0.017196 metrics={'f1_val': 0.992904783397339, 'auprc': 0.9988280538128659, 'loss_val': 0.07336714903763131, 'psi': 0.9952740915635498}-{'f1_val': 0.9903686845626269, 'auprc': 0.9988265282900917, 'loss_val': 0.09253822560102976, 'psi': 0.9937518220536128}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S9] r=20 psi=0.995 u=0.0172 p_local=0.1640 f1=0.993 auprc=0.999 bytes=28742
[S10] START round=19 head_norm_before_train=1.171244 cos_to_last_merge=0.9891 (last merge round=15)
[S10] round=19 local utility u=0.026353 metrics={'f1_val': 0.9947314934809462, 'auprc': 0.9962385507299649, 'loss_val': 0.19310036790085724, 'psi': 0.9953343163805537}-{'f1_val': 0.9941424730579679, 'auprc': 0.993730590667526, 'loss_val': 0.23474916790615996, 'psi': 0.9939777201017912}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S10] r=20 psi=0.995 u=0.0264 p_local=0.2330 f1=0.995 auprc=0.996 bytes=26927
[S11] START round=19 head_norm_before_train=1.226466 cos_to_last_merge=0.9914 (last merge round=15)
[S11] round=19 local utility u=0.025940 metrics={'f1_val': 0.9968091830929121, 'auprc': 0.9954734710136948, 'loss_val': 0.1881622716414334, 'psi': 0.9962748982612252}-{'f1_val': 0.9965470045135896, 'auprc': 0.9948750906031343, 'loss_val': 0.23667377676675433, 'psi': 0.9958782389494074}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S11] r=20 psi=0.996 u=0.0259 p_local=0.1872 f1=0.997 auprc=0.995 bytes=26981
[S13] START round=19 head_norm_before_train=1.356318 cos_to_last_merge=0.9780 (last merge round=11)
[S13] round=19 local utility u=0.000000 metrics={'f1_val': 0.6262760386144235, 'auprc': 0.6986624842520157, 'loss_val': 0.5944843227334633, 'psi': 0.6552306168694604}-{'f1_val': 0.652730680238295, 'auprc': 0.7140788148012815, 'loss_val': 0.5779428302524867, 'psi': 0.6772699340634896}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=20 psi=0.655 u=0.0000 p_local=0.1550 f1=0.626 auprc=0.699 bytes=21546
[S14] START round=19 head_norm_before_train=1.268775 cos_to_last_merge=0.9980 (last merge round=16)
[S14] round=19 local utility u=0.000000 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9969424478687487, 'loss_val': 0.21005913557050715, 'psi': 0.9971211931709754}-{'f1_val': 0.9964355805212295, 'auprc': 0.997059619542908, 'loss_val': 0.13936328702954864, 'psi': 0.9966851961299008}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=20 psi=0.997 u=0.0000 p_local=0.0860 f1=0.997 auprc=0.997 bytes=23396
[S15] START round=19 head_norm_before_train=1.700024 (no previous merge yet)
[S15] round=19 local utility u=0.325710 metrics={'f1_val': 0.8862866439389763, 'auprc': 0.9892898409211581, 'loss_val': 0.17735429251707413, 'psi': 0.927487922731849}-{'f1_val': 0.7817937291423285, 'auprc': 0.9896347158948411, 'loss_val': 0.20285048228379315, 'psi': 0.8649301238433336}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] sending update (kind=head size=1802 to 1 peers)
[S15] r=20 psi=0.927 u=0.3257 p_local=0.1793 f1=0.886 auprc=0.989 bytes=26998
[S16] START round=19 head_norm_before_train=1.013159 cos_to_last_merge=0.9409 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.941
[S16] round=19 local utility u=0.000000 metrics={'f1_val': 0.8532634529619474, 'auprc': 0.9142132084333431, 'loss_val': 0.5580623606486923, 'psi': 0.8776433551505057}-{'f1_val': 0.9105245521586207, 'auprc': 0.9074880369587706, 'loss_val': 0.4571325994256817, 'psi': 0.9093099460786807}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] r=20 psi=0.878 u=0.0000 p_local=0.2552 f1=0.853 auprc=0.914 bytes=19771
[S17] START round=19 head_norm_before_train=1.117242 cos_to_last_merge=0.7522 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.752
[S17] round=19 local utility u=0.000000 metrics={'f1_val': 0.3521394294854705, 'auprc': 0.6669218592097838, 'loss_val': 0.9885649768109847, 'psi': 0.4780524013751958}-{'f1_val': 0.35192025901315815, 'auprc': 0.6768797261478046, 'loss_val': 0.9822049185693965, 'psi': 0.48190404586701674}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=20 psi=0.478 u=0.0000 p_local=0.0938 f1=0.352 auprc=0.667 bytes=17909
[S2] START round=20 head_norm_before_train=1.412326 cos_to_last_merge=0.7828 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.783
[S2] round=20 local utility u=0.045112 metrics={'f1_val': 0.7117115910560842, 'auprc': 0.790238617021719, 'loss_val': 0.5434331512916716, 'psi': 0.7431224014423381}-{'f1_val': 0.7123514883338347, 'auprc': 0.7870366135949329, 'loss_val': 0.6278901902638504, 'psi': 0.742225538438274}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S2] sending update (kind=head size=1792 to 1 peers)
[S3] START round=20 head_norm_before_train=1.158580 cos_to_last_merge=0.9832 (last merge round=15)
[S3] round=20 local utility u=0.480945 metrics={'f1_val': 0.8531861385290341, 'auprc': 0.995570436462071, 'loss_val': 0.26877067538863786, 'psi': 0.9101398577022488}-{'f1_val': 0.7033783484418332, 'auprc': 0.9876181992107763, 'loss_val': 0.3079568113526649, 'psi': 0.8170742887494105}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=20 head_norm_before_train=1.082896 cos_to_last_merge=0.9828 (last merge round=15)
[S4] round=20 local utility u=0.068158 metrics={'f1_val': 0.950745671177401, 'auprc': 0.9787232256236748, 'loss_val': 0.2820870845558414, 'psi': 0.9619366929559106}-{'f1_val': 0.9407256392073031, 'auprc': 0.9628323842373547, 'loss_val': 0.3106110895988532, 'psi': 0.9495683372193238}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S5] START round=20 head_norm_before_train=1.152830 cos_to_last_merge=0.8168 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.817
[S5] round=20 local utility u=1.000000 metrics={'f1_val': 0.7005699347162762, 'auprc': 0.9450965903829498, 'loss_val': 0.3480044442614229, 'psi': 0.7983805969829456}-{'f1_val': 0.4178296265806952, 'auprc': 0.7585377113643336, 'loss_val': 1.0756154913433664, 'psi': 0.5541128604941505}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] START round=20 head_norm_before_train=1.645732 cos_to_last_merge=0.9990 (last merge round=16)
[S6] round=20 local utility u=0.842946 metrics={'f1_val': 0.7904514119700394, 'auprc': 0.8988057905984297, 'loss_val': 0.49605148690177847, 'psi': 0.8337931634213955}-{'f1_val': 0.5893534974150846, 'auprc': 0.7900175236091421, 'loss_val': 0.6489916224205713, 'psi': 0.6696191078927076}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=20 head_norm_before_train=0.978591 cos_to_last_merge=0.9579 (last merge round=12)
[S7] round=20 local utility u=1.000000 metrics={'f1_val': 0.6610069857535351, 'auprc': 0.8433852007656697, 'loss_val': 0.5641787294519524, 'psi': 0.733958271758389}-{'f1_val': 0.3761400688657305, 'auprc': 0.5838989495883585, 'loss_val': 1.1706036163323603, 'psi': 0.4592436211547817}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=20 head_norm_before_train=1.426985 cos_to_last_merge=0.9907 (last merge round=15)
[S8] round=20 local utility u=0.000000 metrics={'f1_val': 0.9927720833909908, 'auprc': 0.9856315564426281, 'loss_val': 0.11841853106693362, 'psi': 0.9899158726116457}-{'f1_val': 0.9927466462064712, 'auprc': 0.9983736682091995, 'loss_val': 0.11934833837493751, 'psi': 0.9949974550075625}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=20 head_norm_before_train=1.572521 cos_to_last_merge=0.8560 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.856
[S9] round=20 local utility u=0.017569 metrics={'f1_val': 0.9962461149658858, 'auprc': 0.9988227068822846, 'loss_val': 0.05826195764042942, 'psi': 0.9972767517324453}-{'f1_val': 0.992904783397339, 'auprc': 0.9988280538128659, 'loss_val': 0.07336714903763131, 'psi': 0.9952740915635498}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] sending update (kind=head size=1793 to 1 peers)
[S10] START round=20 head_norm_before_train=1.211267 cos_to_last_merge=0.9836 (last merge round=15)
[S10] round=20 local utility u=0.012927 metrics={'f1_val': 0.994073654859311, 'auprc': 0.9962410642024485, 'loss_val': 0.16330659413636175, 'psi': 0.994940618596566}-{'f1_val': 0.9947314934809462, 'auprc': 0.9962385507299649, 'loss_val': 0.19310036790085724, 'psi': 0.9953343163805537}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=20 head_norm_before_train=1.277862 cos_to_last_merge=0.9864 (last merge round=15)
[S11] round=20 local utility u=0.023040 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9949226545604445, 'loss_val': 0.13885735048678136, 'psi': 0.9958972645323315}-{'f1_val': 0.9968091830929121, 'auprc': 0.9954734710136948, 'loss_val': 0.1881622716414334, 'psi': 0.9962748982612252}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=20 head_norm_before_train=1.377749 cos_to_last_merge=0.9747 (last merge round=11)
[S13] round=20 local utility u=0.000000 metrics={'f1_val': 0.614111607377204, 'auprc': 0.7033881277115681, 'loss_val': 0.619692964067634, 'psi': 0.6498222155109497}-{'f1_val': 0.6262760386144235, 'auprc': 0.6986624842520157, 'loss_val': 0.5944843227334633, 'psi': 0.6552306168694604}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=20 head_norm_before_train=1.301620 cos_to_last_merge=0.9960 (last merge round=16)
[S14] round=20 local utility u=0.049928 metrics={'f1_val': 0.9970728011695729, 'auprc': 0.997065055479715, 'loss_val': 0.1095652646463686, 'psi': 0.9970697028936297}-{'f1_val': 0.997240356705793, 'auprc': 0.9969424478687487, 'loss_val': 0.21005913557050715, 'psi': 0.9971211931709754}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=20 head_norm_before_train=1.735724 (no previous merge yet)
[S15] round=20 local utility u=0.000000 metrics={'f1_val': 0.8326784400614471, 'auprc': 0.9895821064551943, 'loss_val': 0.1786866510110812, 'psi': 0.895439906618946}-{'f1_val': 0.8862866439389763, 'auprc': 0.9892898409211581, 'loss_val': 0.17735429251707413, 'psi': 0.927487922731849}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=20 head_norm_before_train=1.063109 cos_to_last_merge=0.9327 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.933
[S16] round=20 local utility u=0.235680 metrics={'f1_val': 0.8749581105714143, 'auprc': 0.9543973511236679, 'loss_val': 0.3374221691125033, 'psi': 0.9067338067923156}-{'f1_val': 0.8532634529619474, 'auprc': 0.9142132084333431, 'loss_val': 0.5580623606486923, 'psi': 0.8776433551505057}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S16] sending update (kind=head size=1791 to 1 peers)
[S17] START round=20 head_norm_before_train=1.130182 cos_to_last_merge=0.7490 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.749
[S17] round=20 local utility u=0.000000 metrics={'f1_val': 0.34791138118133635, 'auprc': 0.6836342345388209, 'loss_val': 1.0216163897804489, 'psi': 0.4822005225243302}-{'f1_val': 0.3521394294854705, 'auprc': 0.6669218592097838, 'loss_val': 0.9885649768109847, 'psi': 0.4780524013751958}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=21 head_norm_before_train=1.436340 cos_to_last_merge=0.7797 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.780
[S2] round=21 local utility u=0.000000 metrics={'f1_val': 0.6219425099922786, 'auprc': 0.6398729510291807, 'loss_val': 0.5757021485270423, 'psi': 0.6291146864070395}-{'f1_val': 0.7117115910560842, 'auprc': 0.790238617021719, 'loss_val': 0.5434331512916716, 'psi': 0.7431224014423381}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=21 head_norm_before_train=1.197491 cos_to_last_merge=0.9787 (last merge round=15)
[S3] round=21 local utility u=0.000000 metrics={'f1_val': 0.8661281906873394, 'auprc': 0.9916787076315615, 'loss_val': 0.34005465358085785, 'psi': 0.9163483974650282}-{'f1_val': 0.8531861385290341, 'auprc': 0.995570436462071, 'loss_val': 0.26877067538863786, 'psi': 0.9101398577022488}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=21 head_norm_before_train=1.118719 cos_to_last_merge=0.9776 (last merge round=15)
[S4] round=21 local utility u=0.004894 metrics={'f1_val': 0.9471835091359138, 'auprc': 0.9833376241775522, 'loss_val': 0.2647692925263593, 'psi': 0.9616451551525691}-{'f1_val': 0.950745671177401, 'auprc': 0.9787232256236748, 'loss_val': 0.2820870845558414, 'psi': 0.9619366929559106}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S4] sending update (kind=head size=1792 to 1 peers)
[S5] START round=21 head_norm_before_train=1.167833 cos_to_last_merge=0.8126 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.813
[S5] round=21 local utility u=0.050842 metrics={'f1_val': 0.7003221706489986, 'auprc': 0.974458628737185, 'loss_val': 0.3329203009816615, 'psi': 0.8099767538842733}-{'f1_val': 0.7005699347162762, 'auprc': 0.9450965903829498, 'loss_val': 0.3480044442614229, 'psi': 0.7983805969829456}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] START round=21 head_norm_before_train=1.656206 cos_to_last_merge=0.9983 (last merge round=16)
[S6] round=21 local utility u=0.000000 metrics={'f1_val': 0.7979710786612174, 'auprc': 0.8663049265343823, 'loss_val': 0.49322339726636133, 'psi': 0.8253046178104834}-{'f1_val': 0.7904514119700394, 'auprc': 0.8988057905984297, 'loss_val': 0.49605148690177847, 'psi': 0.8337931634213955}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=21 head_norm_before_train=0.995824 cos_to_last_merge=0.9531 (last merge round=12)
[S7] round=21 local utility u=0.000000 metrics={'f1_val': 0.38128706752657204, 'auprc': 0.6053393964429836, 'loss_val': 1.1744292788480328, 'psi': 0.4709079990931367}-{'f1_val': 0.6610069857535351, 'auprc': 0.8433852007656697, 'loss_val': 0.5641787294519524, 'psi': 0.733958271758389}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=21 head_norm_before_train=1.460455 cos_to_last_merge=0.9871 (last merge round=15)
[S8] round=21 local utility u=0.014875 metrics={'f1_val': 0.9927976282173978, 'auprc': 0.9856838671471487, 'loss_val': 0.08897798696162898, 'psi': 0.9899521237892982}-{'f1_val': 0.9927720833909908, 'auprc': 0.9856315564426281, 'loss_val': 0.11841853106693362, 'psi': 0.9899158726116457}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=21 head_norm_before_train=1.596965 cos_to_last_merge=0.8510 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.851
[S9] round=21 local utility u=0.000000 metrics={'f1_val': 0.990399656971262, 'auprc': 0.9988449141759426, 'loss_val': 0.05922957715055934, 'psi': 0.9937777598531342}-{'f1_val': 0.9962461149658858, 'auprc': 0.9988227068822846, 'loss_val': 0.05826195764042942, 'psi': 0.9972767517324453}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=21 head_norm_before_train=1.250067 cos_to_last_merge=0.9780 (last merge round=15)
[S10] round=21 local utility u=0.011685 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9945874450992878, 'loss_val': 0.14166019764952056, 'psi': 0.9949476814513399}-{'f1_val': 0.994073654859311, 'auprc': 0.9962410642024485, 'loss_val': 0.16330659413636175, 'psi': 0.994940618596566}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=21 head_norm_before_train=1.325645 cos_to_last_merge=0.9811 (last merge round=15)
[S11] round=21 local utility u=0.000000 metrics={'f1_val': 0.9892192607095243, 'auprc': 0.9963311271872042, 'loss_val': 0.17427791791642194, 'psi': 0.9920640073005962}-{'f1_val': 0.9965470045135896, 'auprc': 0.9949226545604445, 'loss_val': 0.13885735048678136, 'psi': 0.9958972645323315}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=21 head_norm_before_train=1.395535 cos_to_last_merge=0.9716 (last merge round=11)
[S13] round=21 local utility u=0.057353 metrics={'f1_val': 0.6497226900886615, 'auprc': 0.6541346795052763, 'loss_val': 0.5708932147422673, 'psi': 0.6514874858553075}-{'f1_val': 0.614111607377204, 'auprc': 0.7033881277115681, 'loss_val': 0.619692964067634, 'psi': 0.6498222155109497}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=21 head_norm_before_train=1.330287 cos_to_last_merge=0.9939 (last merge round=16)
[S14] round=21 local utility u=0.008229 metrics={'f1_val': 0.9972630104447024, 'auprc': 0.9970651936837767, 'loss_val': 0.09424901599800632, 'psi': 0.9971838837403322}-{'f1_val': 0.9970728011695729, 'auprc': 0.997065055479715, 'loss_val': 0.1095652646463686, 'psi': 0.9970697028936297}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] sending update (kind=head size=1804 to 1 peers)
[S15] START round=21 head_norm_before_train=1.765262 (no previous merge yet)
[S15] round=21 local utility u=0.000000 metrics={'f1_val': 0.7695190493343212, 'auprc': 0.9750423194700799, 'loss_val': 0.2848030036976455, 'psi': 0.8517283573886247}-{'f1_val': 0.8326784400614471, 'auprc': 0.9895821064551943, 'loss_val': 0.1786866510110812, 'psi': 0.895439906618946}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=21 head_norm_before_train=1.113451 cos_to_last_merge=0.9244 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.924
[S16] round=21 local utility u=0.000000 metrics={'f1_val': 0.8639795583053902, 'auprc': 0.9533732712574883, 'loss_val': 0.5245518773934126, 'psi': 0.8997370434862294}-{'f1_val': 0.8749581105714143, 'auprc': 0.9543973511236679, 'loss_val': 0.3374221691125033, 'psi': 0.9067338067923156}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=21 head_norm_before_train=1.140566 cos_to_last_merge=0.7468 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.747
[S17] round=21 local utility u=0.568429 metrics={'f1_val': 0.49637494479111155, 'auprc': 0.7523978822801172, 'loss_val': 0.9818297302719659, 'psi': 0.5987841197867139}-{'f1_val': 0.34791138118133635, 'auprc': 0.6836342345388209, 'loss_val': 1.0216163897804489, 'psi': 0.4822005225243302}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S17] sending update (kind=head size=1790 to 1 peers)
[S2] START round=22 head_norm_before_train=1.456172 cos_to_last_merge=0.7773 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.777
[S2] round=22 local utility u=0.546611 metrics={'f1_val': 0.7025460010156788, 'auprc': 0.7883093548970844, 'loss_val': 0.4114106945156972, 'psi': 0.736851342568241}-{'f1_val': 0.6219425099922786, 'auprc': 0.6398729510291807, 'loss_val': 0.5757021485270423, 'psi': 0.6291146864070395}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=22 head_norm_before_train=1.231187 cos_to_last_merge=0.9743 (last merge round=15)
[S3] round=22 local utility u=0.000000 metrics={'f1_val': 0.7226363067458311, 'auprc': 0.8243372501628659, 'loss_val': 0.4312840213512563, 'psi': 0.7633166841126451}-{'f1_val': 0.8661281906873394, 'auprc': 0.9916787076315615, 'loss_val': 0.34005465358085785, 'psi': 0.9163483974650282}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=22 head_norm_before_train=1.147861 cos_to_last_merge=0.9730 (last merge round=15)
[S4] round=22 local utility u=0.019240 metrics={'f1_val': 0.9527814592512982, 'auprc': 0.9837738049026488, 'loss_val': 0.26118610799600067, 'psi': 0.9651783975118384}-{'f1_val': 0.9471835091359138, 'auprc': 0.9833376241775522, 'loss_val': 0.2647692925263593, 'psi': 0.9616451551525691}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S5] START round=22 head_norm_before_train=1.182439 cos_to_last_merge=0.8073 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.807
[S5] round=22 local utility u=0.000000 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.7921693773452739, 'loss_val': 0.3742878897794956, 'psi': 0.7372327865357142}-{'f1_val': 0.7003221706489986, 'auprc': 0.974458628737185, 'loss_val': 0.3329203009816615, 'psi': 0.8099767538842733}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=22 head_norm_before_train=1.667188 cos_to_last_merge=0.9975 (last merge round=16)
[S6] round=22 local utility u=0.000000 metrics={'f1_val': 0.5994167559532209, 'auprc': 0.7752316354369793, 'loss_val': 0.7739116657139528, 'psi': 0.6697427077467242}-{'f1_val': 0.7979710786612174, 'auprc': 0.8663049265343823, 'loss_val': 0.49322339726636133, 'psi': 0.8253046178104834}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=22 head_norm_before_train=1.006954 cos_to_last_merge=0.9491 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.949
[S7] round=22 local utility u=0.321380 metrics={'f1_val': 0.39808042787337233, 'auprc': 0.739233047454027, 'loss_val': 1.0341094286836963, 'psi': 0.5345414757056342}-{'f1_val': 0.38128706752657204, 'auprc': 0.6053393964429836, 'loss_val': 1.1744292788480328, 'psi': 0.4709079990931367}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] sending update (kind=head size=1795 to 1 peers)
[S8] START round=22 head_norm_before_train=1.494146 cos_to_last_merge=0.9840 (last merge round=15)
[S8] round=22 local utility u=0.003956 metrics={'f1_val': 0.9924309654389881, 'auprc': 0.9856268224669301, 'loss_val': 0.07869403423158665, 'psi': 0.9897093082501649}-{'f1_val': 0.9927976282173978, 'auprc': 0.9856838671471487, 'loss_val': 0.08897798696162898, 'psi': 0.9899521237892982}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] sending update (kind=head size=1803 to 1 peers)
[S9] START round=22 head_norm_before_train=1.621498 cos_to_last_merge=0.8471 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.847
[S9] round=22 local utility u=0.014845 metrics={'f1_val': 0.9933237369199828, 'auprc': 0.998831500781862, 'loss_val': 0.047044165661664986, 'psi': 0.9955268424647344}-{'f1_val': 0.990399656971262, 'auprc': 0.9988449141759426, 'loss_val': 0.05922957715055934, 'psi': 0.9937777598531342}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=22 head_norm_before_train=1.289302 cos_to_last_merge=0.9722 (last merge round=15)
[S10] round=22 local utility u=0.007022 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9931556313235147, 'loss_val': 0.12331980659990437, 'psi': 0.9943749559410306}-{'f1_val': 0.9951878390193748, 'auprc': 0.9945874450992878, 'loss_val': 0.14166019764952056, 'psi': 0.9949476814513399}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=22 head_norm_before_train=1.368288 cos_to_last_merge=0.9763 (last merge round=15)
[S11] round=22 local utility u=0.060816 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9959757817677171, 'loss_val': 0.09566864930533701, 'psi': 0.9963307950908151}-{'f1_val': 0.9892192607095243, 'auprc': 0.9963311271872042, 'loss_val': 0.17427791791642194, 'psi': 0.9920640073005962}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] sending update (kind=head size=1804 to 1 peers)
[S13] START round=22 head_norm_before_train=1.414861 cos_to_last_merge=0.9685 (last merge round=11)
[S13] round=22 local utility u=0.000000 metrics={'f1_val': 0.613598019301939, 'auprc': 0.6750729692756332, 'loss_val': 0.6150652604213442, 'psi': 0.6381879992914168}-{'f1_val': 0.6497226900886615, 'auprc': 0.6541346795052763, 'loss_val': 0.5708932147422673, 'psi': 0.6514874858553075}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=22 head_norm_before_train=1.360379 cos_to_last_merge=0.9918 (last merge round=16)
[S14] round=22 local utility u=0.000000 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9959368074657645, 'loss_val': 0.09377924951700327, 'psi': 0.996965393816218}-{'f1_val': 0.9972630104447024, 'auprc': 0.9970651936837767, 'loss_val': 0.09424901599800632, 'psi': 0.9971838837403322}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=22 head_norm_before_train=1.792870 (no previous merge yet)
[S15] round=22 local utility u=0.674946 metrics={'f1_val': 0.9559589721476371, 'auprc': 0.9951174627204683, 'loss_val': 0.11377516392580107, 'psi': 0.9716223683767696}-{'f1_val': 0.7695190493343212, 'auprc': 0.9750423194700799, 'loss_val': 0.2848030036976455, 'psi': 0.8517283573886247}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] sending update (kind=head size=1804 to 1 peers)
[S16] START round=22 head_norm_before_train=1.161574 cos_to_last_merge=0.9162 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.916
[S16] round=22 local utility u=0.000000 metrics={'f1_val': 0.8289600306178881, 'auprc': 0.9407545809501024, 'loss_val': 0.7143149625595784, 'psi': 0.8736778507507739}-{'f1_val': 0.8639795583053902, 'auprc': 0.9533732712574883, 'loss_val': 0.5245518773934126, 'psi': 0.8997370434862294}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=22 head_norm_before_train=1.147909 cos_to_last_merge=0.7448 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.745
[S17] round=22 local utility u=0.000000 metrics={'f1_val': 0.35214207793772434, 'auprc': 0.6601469564253157, 'loss_val': 0.9815673392815053, 'psi': 0.47534402933276093}-{'f1_val': 0.49637494479111155, 'auprc': 0.7523978822801172, 'loss_val': 0.9818297302719659, 'psi': 0.5987841197867139}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=23 head_norm_before_train=1.473964 cos_to_last_merge=0.7755 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.776
[S2] round=23 local utility u=0.000000 metrics={'f1_val': 0.6993103830389796, 'auprc': 0.662525242037841, 'loss_val': 0.37200855686158757, 'psi': 0.6845963266385242}-{'f1_val': 0.7025460010156788, 'auprc': 0.7883093548970844, 'loss_val': 0.4114106945156972, 'psi': 0.736851342568241}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=23 head_norm_before_train=1.262528 cos_to_last_merge=0.9699 (last merge round=15)
[S3] round=23 local utility u=0.912883 metrics={'f1_val': 0.9168533105318634, 'auprc': 0.9741877057352589, 'loss_val': 0.22037078278200983, 'psi': 0.9397870686132215}-{'f1_val': 0.7226363067458311, 'auprc': 0.8243372501628659, 'loss_val': 0.4312840213512563, 'psi': 0.7633166841126451}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=23 head_norm_before_train=1.171933 cos_to_last_merge=0.9692 (last merge round=15)
[S4] round=23 local utility u=0.000000 metrics={'f1_val': 0.9453851106835591, 'auprc': 0.9744139456316134, 'loss_val': 0.25837602724911457, 'psi': 0.9569966446627809}-{'f1_val': 0.9527814592512982, 'auprc': 0.9837738049026488, 'loss_val': 0.26118610799600067, 'psi': 0.9651783975118384}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=23 head_norm_before_train=1.197753 cos_to_last_merge=0.8026 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.803
[S5] round=23 local utility u=0.323751 metrics={'f1_val': 0.7006090940057808, 'auprc': 0.9905314919024468, 'loss_val': 0.3218765485810669, 'psi': 0.8165780531644472}-{'f1_val': 0.7006083926626743, 'auprc': 0.7921693773452739, 'loss_val': 0.3742878897794956, 'psi': 0.7372327865357142}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S5] sending update (kind=head size=1806 to 1 peers)
[S6] START round=23 head_norm_before_train=1.677856 cos_to_last_merge=0.9967 (last merge round=16)
[S6] round=23 local utility u=1.000000 metrics={'f1_val': 0.8200235266842552, 'auprc': 0.9429481046085304, 'loss_val': 0.3651257301510484, 'psi': 0.8691933578539652}-{'f1_val': 0.5994167559532209, 'auprc': 0.7752316354369793, 'loss_val': 0.7739116657139528, 'psi': 0.6697427077467242}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] sending update (kind=head size=1794 to 1 peers)
[S7] START round=23 head_norm_before_train=1.020834 cos_to_last_merge=0.9447 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.945
[S7] round=23 local utility u=0.896920 metrics={'f1_val': 0.6211741240426094, 'auprc': 0.7854090036488756, 'loss_val': 0.7173591151216352, 'psi': 0.6868680758851159}-{'f1_val': 0.39808042787337233, 'auprc': 0.739233047454027, 'loss_val': 1.0341094286836963, 'psi': 0.5345414757056342}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=23 head_norm_before_train=1.524208 cos_to_last_merge=0.9818 (last merge round=15)
[S8] round=23 local utility u=0.008464 metrics={'f1_val': 0.9930017911527874, 'auprc': 0.9871720763421965, 'loss_val': 0.06982596930104469, 'psi': 0.990669905228551}-{'f1_val': 0.9924309654389881, 'auprc': 0.9856268224669301, 'loss_val': 0.07869403423158665, 'psi': 0.9897093082501649}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=23 head_norm_before_train=1.642290 cos_to_last_merge=0.8439 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.844
[S9] round=23 local utility u=0.007226 metrics={'f1_val': 0.9945775144926113, 'auprc': 0.9988256281659986, 'loss_val': 0.04009661263651788, 'psi': 0.9962767599619662}-{'f1_val': 0.9933237369199828, 'auprc': 0.998831500781862, 'loss_val': 0.047044165661664986, 'psi': 0.9955268424647344}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=23 head_norm_before_train=1.329697 cos_to_last_merge=0.9662 (last merge round=15)
[S10] round=23 local utility u=0.016835 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9935702874384071, 'loss_val': 0.09089344487235487, 'psi': 0.9945408183869877}-{'f1_val': 0.9951878390193748, 'auprc': 0.9931556313235147, 'loss_val': 0.12331980659990437, 'psi': 0.9943749559410306}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=23 head_norm_before_train=1.409109 cos_to_last_merge=0.9716 (last merge round=15)
[S11] round=23 local utility u=0.010426 metrics={'f1_val': 0.997050770792581, 'auprc': 0.9974060724504162, 'loss_val': 0.0820077665758987, 'psi': 0.9971928914557151}-{'f1_val': 0.996567470639547, 'auprc': 0.9959757817677171, 'loss_val': 0.09566864930533701, 'psi': 0.9963307950908151}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] sending update (kind=head size=1803 to 1 peers)
[S13] START round=23 head_norm_before_train=1.433815 cos_to_last_merge=0.9654 (last merge round=11)
[S13] round=23 local utility u=0.013986 metrics={'f1_val': 0.6234135761713121, 'auprc': 0.6665583310457612, 'loss_val': 0.6204421566558855, 'psi': 0.6406714781210918}-{'f1_val': 0.613598019301939, 'auprc': 0.6750729692756332, 'loss_val': 0.6150652604213442, 'psi': 0.6381879992914168}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=23 head_norm_before_train=1.394091 cos_to_last_merge=0.9895 (last merge round=16)
[S14] round=23 local utility u=0.014256 metrics={'f1_val': 0.9983050875260411, 'auprc': 0.9970647394476979, 'loss_val': 0.07257401979882125, 'psi': 0.9978089482947039}-{'f1_val': 0.9976511180498535, 'auprc': 0.9959368074657645, 'loss_val': 0.09377924951700327, 'psi': 0.996965393816218}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=23 head_norm_before_train=1.818710 (no previous merge yet)
[S15] round=23 local utility u=0.000000 metrics={'f1_val': 0.9088973495032959, 'auprc': 0.9900107511706105, 'loss_val': 0.12093756166077536, 'psi': 0.9413427101702219}-{'f1_val': 0.9559589721476371, 'auprc': 0.9951174627204683, 'loss_val': 0.11377516392580107, 'psi': 0.9716223683767696}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=23 head_norm_before_train=1.204732 cos_to_last_merge=0.9088 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.909
[S16] round=23 local utility u=0.451240 metrics={'f1_val': 0.9074861423726099, 'auprc': 0.9773796911077208, 'loss_val': 0.39286609738302813, 'psi': 0.9354435618666543}-{'f1_val': 0.8289600306178881, 'auprc': 0.9407545809501024, 'loss_val': 0.7143149625595784, 'psi': 0.8736778507507739}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] sending update (kind=head size=1793 to 1 peers)
[S17] START round=23 head_norm_before_train=1.157997 cos_to_last_merge=0.7406 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.741
[S17] round=23 local utility u=0.107750 metrics={'f1_val': 0.35214207793772434, 'auprc': 0.7316660041524704, 'loss_val': 0.9806235032134637, 'psi': 0.5039516484236228}-{'f1_val': 0.35214207793772434, 'auprc': 0.6601469564253157, 'loss_val': 0.9815673392815053, 'psi': 0.47534402933276093}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S17] sending update (kind=head size=1791 to 1 peers)
[S2] START round=24 head_norm_before_train=1.489099 cos_to_last_merge=0.7743 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.774
[S2] round=24 local utility u=0.032943 metrics={'f1_val': 0.712146643795324, 'auprc': 0.7761798490477992, 'loss_val': 0.7241043684868487, 'psi': 0.7377599258963141}-{'f1_val': 0.6993103830389796, 'auprc': 0.662525242037841, 'loss_val': 0.37200855686158757, 'psi': 0.6845963266385242}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] sending update (kind=head size=1793 to 1 peers)
[S3] START round=24 head_norm_before_train=1.291763 cos_to_last_merge=0.9656 (last merge round=15)
[S3] round=24 local utility u=0.000000 metrics={'f1_val': 0.48898762040424526, 'auprc': 0.803447061861807, 'loss_val': 0.7171770586880927, 'psi': 0.61477139698727}-{'f1_val': 0.9168533105318634, 'auprc': 0.9741877057352589, 'loss_val': 0.22037078278200983, 'psi': 0.9397870686132215}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=24 head_norm_before_train=1.191267 cos_to_last_merge=0.9661 (last merge round=15)
[S4] round=24 local utility u=0.000000 metrics={'f1_val': 0.9334558867341055, 'auprc': 0.9456414082412883, 'loss_val': 0.25709114655309884, 'psi': 0.9383300953369786}-{'f1_val': 0.9453851106835591, 'auprc': 0.9744139456316134, 'loss_val': 0.25837602724911457, 'psi': 0.9569966446627809}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=24 head_norm_before_train=1.217783 cos_to_last_merge=0.7969 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.797
[S5] round=24 local utility u=0.000000 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.8097349848559298, 'loss_val': 0.33563937558551526, 'psi': 0.7442590295399765}-{'f1_val': 0.7006090940057808, 'auprc': 0.9905314919024468, 'loss_val': 0.3218765485810669, 'psi': 0.8165780531644472}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=24 head_norm_before_train=1.688834 cos_to_last_merge=0.9957 (last merge round=16)
[S6] round=24 local utility u=0.000000 metrics={'f1_val': 0.8226031298042285, 'auprc': 0.9448274835287089, 'loss_val': 0.3962720202248169, 'psi': 0.8714928712940206}-{'f1_val': 0.8200235266842552, 'auprc': 0.9429481046085304, 'loss_val': 0.3651257301510484, 'psi': 0.8691933578539652}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=24 head_norm_before_train=1.035504 cos_to_last_merge=0.9402 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.940
[S7] round=24 local utility u=0.343008 metrics={'f1_val': 0.6694200013313871, 'auprc': 0.8561664005361319, 'loss_val': 0.5330905920995078, 'psi': 0.744118561013285}-{'f1_val': 0.6211741240426094, 'auprc': 0.7854090036488756, 'loss_val': 0.7173591151216352, 'psi': 0.6868680758851159}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=24 head_norm_before_train=1.548106 cos_to_last_merge=0.9795 (last merge round=15)
[S8] round=24 local utility u=0.005860 metrics={'f1_val': 0.9933673104406822, 'auprc': 0.9883124259754484, 'loss_val': 0.06371967447812903, 'psi': 0.9913453566545887}-{'f1_val': 0.9930017911527874, 'auprc': 0.9871720763421965, 'loss_val': 0.06982596930104469, 'psi': 0.990669905228551}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=24 head_norm_before_train=1.662795 cos_to_last_merge=0.8408 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.841
[S9] round=24 local utility u=0.001697 metrics={'f1_val': 0.9945775144926113, 'auprc': 0.9988252371180109, 'loss_val': 0.036700805000328504, 'psi': 0.9962766035427711}-{'f1_val': 0.9945775144926113, 'auprc': 0.9988256281659986, 'loss_val': 0.04009661263651788, 'psi': 0.9962767599619662}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=24 head_norm_before_train=1.366412 cos_to_last_merge=0.9610 (last merge round=15)
[S10] round=24 local utility u=0.003103 metrics={'f1_val': 0.9936273830841322, 'auprc': 0.9959997698244716, 'loss_val': 0.08261367673024593, 'psi': 0.994576337780268}-{'f1_val': 0.9951878390193748, 'auprc': 0.9935702874384071, 'loss_val': 0.09089344487235487, 'psi': 0.9945408183869877}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=24 head_norm_before_train=1.448738 cos_to_last_merge=0.9670 (last merge round=15)
[S11] round=24 local utility u=0.000000 metrics={'f1_val': 0.9963958538641108, 'auprc': 0.9968644533254309, 'loss_val': 0.09061150681099164, 'psi': 0.996583293648639}-{'f1_val': 0.997050770792581, 'auprc': 0.9974060724504162, 'loss_val': 0.0820077665758987, 'psi': 0.9971928914557151}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=24 head_norm_before_train=1.452588 cos_to_last_merge=0.9624 (last merge round=11)
[S13] round=24 local utility u=0.029624 metrics={'f1_val': 0.6282978401062779, 'auprc': 0.6684985273258667, 'loss_val': 0.5963208220331311, 'psi': 0.6443781149941135}-{'f1_val': 0.6234135761713121, 'auprc': 0.6665583310457612, 'loss_val': 0.6204421566558855, 'psi': 0.6406714781210918}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=24 head_norm_before_train=1.429948 cos_to_last_merge=0.9868 (last merge round=16)
[S14] round=24 local utility u=0.000253 metrics={'f1_val': 0.9976483782674455, 'auprc': 0.9969231121401345, 'loss_val': 0.06770386802298677, 'psi': 0.997358271816521}-{'f1_val': 0.9983050875260411, 'auprc': 0.9970647394476979, 'loss_val': 0.07257401979882125, 'psi': 0.9978089482947039}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=24 head_norm_before_train=1.843525 (no previous merge yet)
[S15] round=24 local utility u=0.252952 metrics={'f1_val': 0.9834798842843651, 'auprc': 0.9956192686299846, 'loss_val': 0.07935486191650068, 'psi': 0.9883356380226129}-{'f1_val': 0.9088973495032959, 'auprc': 0.9900107511706105, 'loss_val': 0.12093756166077536, 'psi': 0.9413427101702219}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=24 head_norm_before_train=1.243021 cos_to_last_merge=0.9025 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.902
[S16] round=24 local utility u=0.119802 metrics={'f1_val': 0.931504977232098, 'auprc': 0.9807652402781839, 'loss_val': 0.3075326765946073, 'psi': 0.9512090824505324}-{'f1_val': 0.9074861423726099, 'auprc': 0.9773796911077208, 'loss_val': 0.39286609738302813, 'psi': 0.9354435618666543}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] sending update (kind=head size=1793 to 1 peers)
[S17] START round=24 head_norm_before_train=1.168732 cos_to_last_merge=0.7371 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.737
[S17] round=24 local utility u=0.058834 metrics={'f1_val': 0.35413340746910676, 'auprc': 0.7732172898889398, 'loss_val': 0.9995568579020826, 'psi': 0.52176696043704}-{'f1_val': 0.35214207793772434, 'auprc': 0.7316660041524704, 'loss_val': 0.9806235032134637, 'psi': 0.5039516484236228}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] sending update (kind=head size=1794 to 1 peers)
[S2] START round=25 head_norm_before_train=1.503481 cos_to_last_merge=0.7733 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.773
[S2] round=25 local utility u=0.117524 metrics={'f1_val': 0.6994666774377963, 'auprc': 0.7720413233518675, 'loss_val': 0.40056128189384027, 'psi': 0.7284965358034248}-{'f1_val': 0.712146643795324, 'auprc': 0.7761798490477992, 'loss_val': 0.7241043684868487, 'psi': 0.7377599258963141}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] sending update (kind=head size=1794 to 1 peers)
[S3] START round=25 head_norm_before_train=1.317304 cos_to_last_merge=0.9622 (last merge round=15)
[S3] round=25 local utility u=1.000000 metrics={'f1_val': 0.9984129976004323, 'auprc': 0.9991271146182211, 'loss_val': 0.12186303347108614, 'psi': 0.9986986444075479}-{'f1_val': 0.48898762040424526, 'auprc': 0.803447061861807, 'loss_val': 0.7171770586880927, 'psi': 0.61477139698727}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=25 head_norm_before_train=1.205745 cos_to_last_merge=0.9633 (last merge round=15)
[S4] round=25 local utility u=0.045946 metrics={'f1_val': 0.9463414786383234, 'auprc': 0.9539893381999089, 'loss_val': 0.2675564708355064, 'psi': 0.9494006224629576}-{'f1_val': 0.9334558867341055, 'auprc': 0.9456414082412883, 'loss_val': 0.25709114655309884, 'psi': 0.9383300953369786}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=25 head_norm_before_train=1.239764 cos_to_last_merge=0.7923 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.792
[S5] round=25 local utility u=0.000000 metrics={'f1_val': 0.7009506580665973, 'auprc': 0.7805259531866257, 'loss_val': 0.3899207470291197, 'psi': 0.7327807761146086}-{'f1_val': 0.7006083926626743, 'auprc': 0.8097349848559298, 'loss_val': 0.33563937558551526, 'psi': 0.7442590295399765}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=25 head_norm_before_train=1.705959 cos_to_last_merge=0.9944 (last merge round=16)
[S6] round=25 local utility u=0.357381 metrics={'f1_val': 0.922358337718759, 'auprc': 0.9466226007055392, 'loss_val': 0.28542590895831277, 'psi': 0.932064042913471}-{'f1_val': 0.8226031298042285, 'auprc': 0.9448274835287089, 'loss_val': 0.3962720202248169, 'psi': 0.8714928712940206}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=25 head_norm_before_train=1.052372 cos_to_last_merge=0.9356 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.936
[S7] round=25 local utility u=0.000000 metrics={'f1_val': 0.40895048178147997, 'auprc': 0.7750063293023736, 'loss_val': 0.9632398037436702, 'psi': 0.5553728207898374}-{'f1_val': 0.6694200013313871, 'auprc': 0.8561664005361319, 'loss_val': 0.5330905920995078, 'psi': 0.744118561013285}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=25 head_norm_before_train=1.574403 cos_to_last_merge=0.9768 (last merge round=15)
[S8] round=25 local utility u=0.009700 metrics={'f1_val': 0.9933593890417576, 'auprc': 0.9929804183665316, 'loss_val': 0.05827533446734999, 'psi': 0.9932078007716671}-{'f1_val': 0.9933673104406822, 'auprc': 0.9883124259754484, 'loss_val': 0.06371967447812903, 'psi': 0.9913453566545887}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=25 head_norm_before_train=1.683096 cos_to_last_merge=0.8381 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.838
[S9] round=25 local utility u=0.004450 metrics={'f1_val': 0.9954158325366191, 'auprc': 0.9989468885125917, 'loss_val': 0.03319499862246234, 'psi': 0.9968282549270082}-{'f1_val': 0.9945775144926113, 'auprc': 0.9988252371180109, 'loss_val': 0.036700805000328504, 'psi': 0.9962766035427711}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=25 head_norm_before_train=1.400117 cos_to_last_merge=0.9563 (last merge round=15)
[S10] round=25 local utility u=0.006922 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9938862444024529, 'loss_val': 0.07047404224129916, 'psi': 0.9945354096800268}-{'f1_val': 0.9936273830841322, 'auprc': 0.9959997698244716, 'loss_val': 0.08261367673024593, 'psi': 0.994576337780268}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=25 head_norm_before_train=1.485260 cos_to_last_merge=0.9625 (last merge round=15)
[S11] round=25 local utility u=0.003196 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9965418842295157, 'loss_val': 0.08180100795117559, 'psi': 0.9963092385382535}-{'f1_val': 0.9963958538641108, 'auprc': 0.9968644533254309, 'loss_val': 0.09061150681099164, 'psi': 0.996583293648639}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=25 head_norm_before_train=1.467595 cos_to_last_merge=0.9598 (last merge round=11)
[S13] round=25 local utility u=0.000000 metrics={'f1_val': 0.6099926734791945, 'auprc': 0.6805427279017983, 'loss_val': 0.6675396654697954, 'psi': 0.638212695248236}-{'f1_val': 0.6282978401062779, 'auprc': 0.6684985273258667, 'loss_val': 0.5963208220331311, 'psi': 0.6443781149941135}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=25 head_norm_before_train=1.469653 cos_to_last_merge=0.9838 (last merge round=16)
[S14] round=25 local utility u=0.008209 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9969727256373966, 'loss_val': 0.05145141420516401, 'psi': 0.9973797610848708}-{'f1_val': 0.9976483782674455, 'auprc': 0.9969231121401345, 'loss_val': 0.06770386802298677, 'psi': 0.997358271816521}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=25 head_norm_before_train=1.864484 (no previous merge yet)
[S15] round=25 local utility u=0.000000 metrics={'f1_val': 0.6980437827638051, 'auprc': 0.9398535762001861, 'loss_val': 0.43492898918052314, 'psi': 0.7947677001383575}-{'f1_val': 0.9834798842843651, 'auprc': 0.9956192686299846, 'loss_val': 0.07935486191650068, 'psi': 0.9883356380226129}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=25 head_norm_before_train=1.279105 cos_to_last_merge=0.8965 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.897
[S16] round=25 local utility u=0.000000 metrics={'f1_val': 0.823174888880728, 'auprc': 0.8738653681243307, 'loss_val': 0.8336788467994449, 'psi': 0.8434510805781691}-{'f1_val': 0.931504977232098, 'auprc': 0.9807652402781839, 'loss_val': 0.3075326765946073, 'psi': 0.9512090824505324}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=25 head_norm_before_train=1.178491 cos_to_last_merge=0.7346 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.735
[S17] round=25 local utility u=0.000000 metrics={'f1_val': 0.3679433005319882, 'auprc': 0.7497393405270555, 'loss_val': 1.0522035138392154, 'psi': 0.5206617165300151}-{'f1_val': 0.35413340746910676, 'auprc': 0.7732172898889398, 'loss_val': 0.9995568579020826, 'psi': 0.52176696043704}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=26 head_norm_before_train=1.519396 cos_to_last_merge=0.7724 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.772
[S2] round=26 local utility u=0.000000 metrics={'f1_val': 0.6931100779133709, 'auprc': 0.7446345793063256, 'loss_val': 0.40250758940931214, 'psi': 0.7137198784705527}-{'f1_val': 0.6994666774377963, 'auprc': 0.7720413233518675, 'loss_val': 0.40056128189384027, 'psi': 0.7284965358034248}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=26 head_norm_before_train=1.336782 cos_to_last_merge=0.9597 (last merge round=15)
[S3] round=26 local utility u=0.000000 metrics={'f1_val': 0.6499959584161505, 'auprc': 0.8098015460344661, 'loss_val': 0.53013431353675, 'psi': 0.7139181934634767}-{'f1_val': 0.9984129976004323, 'auprc': 0.9991271146182211, 'loss_val': 0.12186303347108614, 'psi': 0.9986986444075479}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=26 head_norm_before_train=1.223828 cos_to_last_merge=0.9600 (last merge round=15)
[S4] round=26 local utility u=0.027114 metrics={'f1_val': 0.9476456833087074, 'auprc': 0.9690252993950278, 'loss_val': 0.2662623656821489, 'psi': 0.9561975297432355}-{'f1_val': 0.9463414786383234, 'auprc': 0.9539893381999089, 'loss_val': 0.2675564708355064, 'psi': 0.9494006224629576}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] sending update (kind=head size=1795 to 1 peers)
[S5] START round=26 head_norm_before_train=1.262752 cos_to_last_merge=0.7902 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.790
[S5] round=26 local utility u=0.297449 metrics={'f1_val': 0.7006090940057808, 'auprc': 0.9534455723960127, 'loss_val': 0.31173201789035393, 'psi': 0.8017436853618736}-{'f1_val': 0.7009506580665973, 'auprc': 0.7805259531866257, 'loss_val': 0.3899207470291197, 'psi': 0.7327807761146086}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=26 head_norm_before_train=1.722874 cos_to_last_merge=0.9929 (last merge round=16)
[S6] round=26 local utility u=0.000000 metrics={'f1_val': 0.8729557497429221, 'auprc': 0.9171121820546992, 'loss_val': 0.3187415317091231, 'psi': 0.890618322667633}-{'f1_val': 0.922358337718759, 'auprc': 0.9466226007055392, 'loss_val': 0.28542590895831277, 'psi': 0.932064042913471}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=26 head_norm_before_train=1.069248 cos_to_last_merge=0.9308 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.931
[S7] round=26 local utility u=0.000000 metrics={'f1_val': 0.38471683120476424, 'auprc': 0.7700373228834013, 'loss_val': 1.111173559135411, 'psi': 0.5388450278762191}-{'f1_val': 0.40895048178147997, 'auprc': 0.7750063293023736, 'loss_val': 0.9632398037436702, 'psi': 0.5553728207898374}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=26 head_norm_before_train=1.600019 cos_to_last_merge=0.9743 (last merge round=15)
[S8] round=26 local utility u=0.007886 metrics={'f1_val': 0.9923588464459678, 'auprc': 0.9984629676609176, 'loss_val': 0.05294863693093455, 'psi': 0.9948004949319478}-{'f1_val': 0.9933593890417576, 'auprc': 0.9929804183665316, 'loss_val': 0.05827533446734999, 'psi': 0.9932078007716671}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=26 head_norm_before_train=1.701950 cos_to_last_merge=0.8360 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.836
[S9] round=26 local utility u=0.000000 metrics={'f1_val': 0.9926544572506684, 'auprc': 0.9990153264797954, 'loss_val': 0.0361314716668287, 'psi': 0.9951988049423192}-{'f1_val': 0.9954158325366191, 'auprc': 0.9989468885125917, 'loss_val': 0.03319499862246234, 'psi': 0.9968282549270082}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=26 head_norm_before_train=1.431273 cos_to_last_merge=0.9520 (last merge round=15)
[S10] round=26 local utility u=0.000800 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9920458468613533, 'loss_val': 0.06467032338223414, 'psi': 0.9939310421561662}-{'f1_val': 0.9949681865317428, 'auprc': 0.9938862444024529, 'loss_val': 0.07047404224129916, 'psi': 0.9945354096800268}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=26 head_norm_before_train=1.518885 cos_to_last_merge=0.9584 (last merge round=15)
[S11] round=26 local utility u=0.000000 metrics={'f1_val': 0.8832523642860508, 'auprc': 0.9950910208685992, 'loss_val': 0.15735473714169637, 'psi': 0.9279878269190701}-{'f1_val': 0.9961541414107454, 'auprc': 0.9965418842295157, 'loss_val': 0.08180100795117559, 'psi': 0.9963092385382535}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=26 head_norm_before_train=1.477147 cos_to_last_merge=0.9579 (last merge round=11)
[S13] round=26 local utility u=0.047199 metrics={'f1_val': 0.6217875970013305, 'auprc': 0.672435387894707, 'loss_val': 0.619588846233288, 'psi': 0.6420467133586811}-{'f1_val': 0.6099926734791945, 'auprc': 0.6805427279017983, 'loss_val': 0.6675396654697954, 'psi': 0.638212695248236}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=26 head_norm_before_train=1.509029 cos_to_last_merge=0.9806 (last merge round=16)
[S14] round=26 local utility u=0.000781 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9969588904853126, 'loss_val': 0.049848707875516866, 'psi': 0.9973742270240372}-{'f1_val': 0.9976511180498535, 'auprc': 0.9969727256373966, 'loss_val': 0.05145141420516401, 'psi': 0.9973797610848708}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S14] sending update (kind=head size=1806 to 1 peers)
[S15] START round=26 head_norm_before_train=1.885201 (no previous merge yet)
[S15] round=26 local utility u=0.753347 metrics={'f1_val': 0.8815107836872262, 'auprc': 0.9923170159043697, 'loss_val': 0.1864267630745866, 'psi': 0.9258332765740837}-{'f1_val': 0.6980437827638051, 'auprc': 0.9398535762001861, 'loss_val': 0.43492898918052314, 'psi': 0.7947677001383575}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] sending update (kind=head size=1804 to 1 peers)
[S16] START round=26 head_norm_before_train=1.310412 cos_to_last_merge=0.8914 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.891
[S16] round=26 local utility u=0.823222 metrics={'f1_val': 0.9402449986069934, 'auprc': 0.9827754270767352, 'loss_val': 0.2163847114807084, 'psi': 0.9572571699948901}-{'f1_val': 0.823174888880728, 'auprc': 0.8738653681243307, 'loss_val': 0.8336788467994449, 'psi': 0.8434510805781691}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=26 head_norm_before_train=1.189174 cos_to_last_merge=0.7326 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.733
[S17] round=26 local utility u=0.098261 metrics={'f1_val': 0.3709988087207383, 'auprc': 0.7961528729352306, 'loss_val': 1.0132544030242825, 'psi': 0.5410604344065353}-{'f1_val': 0.3679433005319882, 'auprc': 0.7497393405270555, 'loss_val': 1.0522035138392154, 'psi': 0.5206617165300151}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S17] sending update (kind=head size=1788 to 1 peers)
[S2] START round=27 head_norm_before_train=1.534151 cos_to_last_merge=0.7718 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.772
[S2] round=27 local utility u=0.064130 metrics={'f1_val': 0.7050207919654701, 'auprc': 0.7756683486032079, 'loss_val': 0.43881244424203775, 'psi': 0.7332798146205652}-{'f1_val': 0.6931100779133709, 'auprc': 0.7446345793063256, 'loss_val': 0.40250758940931214, 'psi': 0.7137198784705527}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=27 head_norm_before_train=1.352358 cos_to_last_merge=0.9576 (last merge round=15)
[S3] round=27 local utility u=0.809598 metrics={'f1_val': 0.8495380366749373, 'auprc': 0.8737170974283255, 'loss_val': 0.29993835546247644, 'psi': 0.8592096609762925}-{'f1_val': 0.6499959584161505, 'auprc': 0.8098015460344661, 'loss_val': 0.53013431353675, 'psi': 0.7139181934634767}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=27 head_norm_before_train=1.245573 cos_to_last_merge=0.9558 (last merge round=15)
[S4] round=27 local utility u=0.012706 metrics={'f1_val': 0.9473173641059565, 'auprc': 0.9746701250795143, 'loss_val': 0.2558147625688594, 'psi': 0.9582584684953797}-{'f1_val': 0.9476456833087074, 'auprc': 0.9690252993950278, 'loss_val': 0.2662623656821489, 'psi': 0.9561975297432355}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=27 head_norm_before_train=1.282332 cos_to_last_merge=0.7881 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.788
[S5] round=27 local utility u=0.000000 metrics={'f1_val': 0.7006076189339416, 'auprc': 0.7831985002204847, 'loss_val': 0.3987488740694638, 'psi': 0.7336439714485589}-{'f1_val': 0.7006090940057808, 'auprc': 0.9534455723960127, 'loss_val': 0.31173201789035393, 'psi': 0.8017436853618736}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=27 head_norm_before_train=1.734920 cos_to_last_merge=0.9912 (last merge round=16)
[S6] round=27 local utility u=0.000000 metrics={'f1_val': 0.8204980862363109, 'auprc': 0.9429990745969645, 'loss_val': 0.4931613088306374, 'psi': 0.8694984815805724}-{'f1_val': 0.8729557497429221, 'auprc': 0.9171121820546992, 'loss_val': 0.3187415317091231, 'psi': 0.890618322667633}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=27 head_norm_before_train=1.085193 cos_to_last_merge=0.9264 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.926
[S7] round=27 local utility u=1.000000 metrics={'f1_val': 0.6544024682542244, 'auprc': 0.8033381749713014, 'loss_val': 0.5925618374196471, 'psi': 0.7139767509410553}-{'f1_val': 0.38471683120476424, 'auprc': 0.7700373228834013, 'loss_val': 1.111173559135411, 'psi': 0.5388450278762191}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S8] START round=27 head_norm_before_train=1.622862 cos_to_last_merge=0.9721 (last merge round=15)
[S8] round=27 local utility u=0.000000 metrics={'f1_val': 0.9939009886418481, 'auprc': 0.9856267380693703, 'loss_val': 0.05538827359540855, 'psi': 0.9905912884128569}-{'f1_val': 0.9923588464459678, 'auprc': 0.9984629676609176, 'loss_val': 0.05294863693093455, 'psi': 0.9948004949319478}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=27 head_norm_before_train=1.719261 cos_to_last_merge=0.8343 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.834
[S9] round=27 local utility u=0.014008 metrics={'f1_val': 0.9962461149658858, 'auprc': 0.9988208900158344, 'loss_val': 0.02908241856619809, 'psi': 0.9972760249858652}-{'f1_val': 0.9926544572506684, 'auprc': 0.9990153264797954, 'loss_val': 0.0361314716668287, 'psi': 0.9951988049423192}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=27 head_norm_before_train=1.461350 cos_to_last_merge=0.9479 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.948
[S10] round=27 local utility u=0.005918 metrics={'f1_val': 0.9945046060794613, 'auprc': 0.995980518752878, 'loss_val': 0.06053856433609641, 'psi': 0.9950949711488281}-{'f1_val': 0.9951878390193748, 'auprc': 0.9920458468613533, 'loss_val': 0.06467032338223414, 'psi': 0.9939310421561662}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=27 head_norm_before_train=1.548892 cos_to_last_merge=0.9546 (last merge round=15)
[S11] round=27 local utility u=0.396794 metrics={'f1_val': 0.9966374415637795, 'auprc': 0.9973467847648861, 'loss_val': 0.05084517439733519, 'psi': 0.9969211788442222}-{'f1_val': 0.8832523642860508, 'auprc': 0.9950910208685992, 'loss_val': 0.15735473714169637, 'psi': 0.9279878269190701}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=27 head_norm_before_train=1.487207 cos_to_last_merge=0.9563 (last merge round=11)
[S13] round=27 local utility u=0.015881 metrics={'f1_val': 0.6254734917995437, 'auprc': 0.670693005323586, 'loss_val': 0.6047145441331333, 'psi': 0.6435612972091607}-{'f1_val': 0.6217875970013305, 'auprc': 0.672435387894707, 'loss_val': 0.619588846233288, 'psi': 0.6420467133586811}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=27 head_norm_before_train=1.546080 cos_to_last_merge=0.9777 (last merge round=16)
[S14] round=27 local utility u=0.000000 metrics={'f1_val': 0.9949791102532123, 'auprc': 0.9969751308781107, 'loss_val': 0.048140802401652014, 'psi': 0.9957775185031716}-{'f1_val': 0.9976511180498535, 'auprc': 0.9969588904853126, 'loss_val': 0.049848707875516866, 'psi': 0.9973742270240372}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=27 head_norm_before_train=1.905207 (no previous merge yet)
[S15] round=27 local utility u=0.389988 metrics={'f1_val': 0.99057022965652, 'auprc': 0.9952878483265704, 'loss_val': 0.06971907106990205, 'psi': 0.9924572771245401}-{'f1_val': 0.8815107836872262, 'auprc': 0.9923170159043697, 'loss_val': 0.1864267630745866, 'psi': 0.9258332765740837}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=27 head_norm_before_train=1.335973 cos_to_last_merge=0.8873 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.887
[S16] round=27 local utility u=0.000000 metrics={'f1_val': 0.9392013099533963, 'auprc': 0.9847730507139649, 'loss_val': 0.23068062395096692, 'psi': 0.9574300062576238}-{'f1_val': 0.9402449986069934, 'auprc': 0.9827754270767352, 'loss_val': 0.2163847114807084, 'psi': 0.9572571699948901}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=27 head_norm_before_train=1.200109 cos_to_last_merge=0.7319 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.732
[S17] round=27 local utility u=0.046978 metrics={'f1_val': 0.37291552108709447, 'auprc': 0.8143396879066418, 'loss_val': 0.9853581943304702, 'psi': 0.5494851878149134}-{'f1_val': 0.3709988087207383, 'auprc': 0.7961528729352306, 'loss_val': 1.0132544030242825, 'psi': 0.5410604344065353}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S17] sending update (kind=head size=1792 to 1 peers)
[S2] START round=28 head_norm_before_train=1.550783 cos_to_last_merge=0.7716 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.772
[S2] round=28 local utility u=0.000000 metrics={'f1_val': 0.6951713518039357, 'auprc': 0.7645353325650496, 'loss_val': 0.507475087872299, 'psi': 0.7229169441083813}-{'f1_val': 0.7050207919654701, 'auprc': 0.7756683486032079, 'loss_val': 0.43881244424203775, 'psi': 0.7332798146205652}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=28 head_norm_before_train=1.367239 cos_to_last_merge=0.9555 (last merge round=15)
[S3] round=28 local utility u=0.000000 metrics={'f1_val': 0.6416618111754039, 'auprc': 0.8075870549022348, 'loss_val': 0.5628353642934004, 'psi': 0.7080319086661362}-{'f1_val': 0.8495380366749373, 'auprc': 0.8737170974283255, 'loss_val': 0.29993835546247644, 'psi': 0.8592096609762925}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=28 head_norm_before_train=1.261419 cos_to_last_merge=0.9524 (last merge round=15)
[S4] round=28 local utility u=0.000000 metrics={'f1_val': 0.9369190498232491, 'auprc': 0.9714081450685066, 'loss_val': 0.2749946519059315, 'psi': 0.9507146879213522}-{'f1_val': 0.9473173641059565, 'auprc': 0.9746701250795143, 'loss_val': 0.2558147625688594, 'psi': 0.9582584684953797}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=28 head_norm_before_train=1.294876 cos_to_last_merge=0.7854 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.785
[S5] round=28 local utility u=0.085617 metrics={'f1_val': 0.6789012589519858, 'auprc': 0.8737969372043587, 'loss_val': 0.3690712552524692, 'psi': 0.756859530252935}-{'f1_val': 0.7006076189339416, 'auprc': 0.7831985002204847, 'loss_val': 0.3987488740694638, 'psi': 0.7336439714485589}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] sending update (kind=head size=1795 to 1 peers)
[S6] START round=28 head_norm_before_train=1.747456 cos_to_last_merge=0.9897 (last merge round=16)
[S6] round=28 local utility u=0.489612 metrics={'f1_val': 0.9369575339381917, 'auprc': 0.9552822284696034, 'loss_val': 0.24954350947401538, 'psi': 0.9442874117507565}-{'f1_val': 0.8204980862363109, 'auprc': 0.9429990745969645, 'loss_val': 0.4931613088306374, 'psi': 0.8694984815805724}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=28 head_norm_before_train=1.097288 cos_to_last_merge=0.9231 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.923
[S7] round=28 local utility u=0.000000 metrics={'f1_val': 0.4204516052900704, 'auprc': 0.7778682476814913, 'loss_val': 0.8807286765887951, 'psi': 0.5634182622466388}-{'f1_val': 0.6544024682542244, 'auprc': 0.8033381749713014, 'loss_val': 0.5925618374196471, 'psi': 0.7139767509410553}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=28 head_norm_before_train=1.642191 cos_to_last_merge=0.9703 (last merge round=15)
[S8] round=28 local utility u=0.000000 metrics={'f1_val': 0.7139758603458082, 'auprc': 0.987293453133492, 'loss_val': 0.39638300340113175, 'psi': 0.8233028974608817}-{'f1_val': 0.9939009886418481, 'auprc': 0.9856267380693703, 'loss_val': 0.05538827359540855, 'psi': 0.9905912884128569}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=28 head_norm_before_train=1.733790 cos_to_last_merge=0.8327 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.833
[S9] round=28 local utility u=0.000000 metrics={'f1_val': 0.9951655063899485, 'auprc': 0.9988218930112158, 'loss_val': 0.02861022952714671, 'psi': 0.9966280610384554}-{'f1_val': 0.9962461149658858, 'auprc': 0.9988208900158344, 'loss_val': 0.02908241856619809, 'psi': 0.9972760249858652}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=28 head_norm_before_train=1.489066 cos_to_last_merge=0.9440 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.944
[S10] round=28 local utility u=0.000782 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9930754374189877, 'loss_val': 0.053041299160480226, 'psi': 0.9942110868866407}-{'f1_val': 0.9945046060794613, 'auprc': 0.995980518752878, 'loss_val': 0.06053856433609641, 'psi': 0.9950949711488281}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=28 head_norm_before_train=1.577047 cos_to_last_merge=0.9511 (last merge round=15)
[S11] round=28 local utility u=0.000000 metrics={'f1_val': 0.9951254857265296, 'auprc': 0.9981113686452414, 'loss_val': 0.047498108569555414, 'psi': 0.9963198388940143}-{'f1_val': 0.9966374415637795, 'auprc': 0.9973467847648861, 'loss_val': 0.05084517439733519, 'psi': 0.9969211788442222}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=28 head_norm_before_train=1.496723 cos_to_last_merge=0.9548 (last merge round=11)
[S13] round=28 local utility u=0.000000 metrics={'f1_val': 0.5828327705244686, 'auprc': 0.6875956055952399, 'loss_val': 0.7527073951320368, 'psi': 0.6247379045527771}-{'f1_val': 0.6254734917995437, 'auprc': 0.670693005323586, 'loss_val': 0.6047145441331333, 'psi': 0.6435612972091607}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=28 head_norm_before_train=1.579899 cos_to_last_merge=0.9745 (last merge round=16)
[S14] round=28 local utility u=0.014684 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9970134400124118, 'loss_val': 0.03492042522032189, 'psi': 0.9973960468348768}-{'f1_val': 0.9949791102532123, 'auprc': 0.9969751308781107, 'loss_val': 0.048140802401652014, 'psi': 0.9957775185031716}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] sending update (kind=head size=1795 to 1 peers)
[S15] START round=28 head_norm_before_train=1.925960 (no previous merge yet)
[S15] round=28 local utility u=0.000000 metrics={'f1_val': 0.9146014779607884, 'auprc': 0.9904925753317082, 'loss_val': 0.1059039174051728, 'psi': 0.9449579169091564}-{'f1_val': 0.99057022965652, 'auprc': 0.9952878483265704, 'loss_val': 0.06971907106990205, 'psi': 0.9924572771245401}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=28 head_norm_before_train=1.360478 cos_to_last_merge=0.8838 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.884
[S16] round=28 local utility u=0.000000 metrics={'f1_val': 0.8449115884850297, 'auprc': 0.9840212351114683, 'loss_val': 0.7246360057255641, 'psi': 0.9005554471356052}-{'f1_val': 0.9392013099533963, 'auprc': 0.9847730507139649, 'loss_val': 0.23068062395096692, 'psi': 0.9574300062576238}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=28 head_norm_before_train=1.212838 cos_to_last_merge=0.7294 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.729
[S17] round=28 local utility u=0.008119 metrics={'f1_val': 0.3746118753687938, 'auprc': 0.8129578738134204, 'loss_val': 0.9751532268184373, 'psi': 0.5499502747466445}-{'f1_val': 0.37291552108709447, 'auprc': 0.8143396879066418, 'loss_val': 0.9853581943304702, 'psi': 0.5494851878149134}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] START round=29 head_norm_before_train=1.568419 cos_to_last_merge=0.7712 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.771
[S2] round=29 local utility u=0.000000 metrics={'f1_val': 0.6875352564031323, 'auprc': 0.7684303799354809, 'loss_val': 0.595201192020591, 'psi': 0.7198933058160717}-{'f1_val': 0.6951713518039357, 'auprc': 0.7645353325650496, 'loss_val': 0.507475087872299, 'psi': 0.7229169441083813}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=29 head_norm_before_train=1.382459 cos_to_last_merge=0.9534 (last merge round=15)
[S3] round=29 local utility u=1.000000 metrics={'f1_val': 0.960621378487214, 'auprc': 0.997198447533711, 'loss_val': 0.14991739771919252, 'psi': 0.9752522061058129}-{'f1_val': 0.6416618111754039, 'auprc': 0.8075870549022348, 'loss_val': 0.5628353642934004, 'psi': 0.7080319086661362}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=29 head_norm_before_train=1.275418 cos_to_last_merge=0.9499 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.950
[S4] round=29 local utility u=0.000000 metrics={'f1_val': 0.902722129852672, 'auprc': 0.8897399652517595, 'loss_val': 0.3827773567287347, 'psi': 0.897529264012307}-{'f1_val': 0.9369190498232491, 'auprc': 0.9714081450685066, 'loss_val': 0.2749946519059315, 'psi': 0.9507146879213522}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=29 head_norm_before_train=1.307869 cos_to_last_merge=0.7827 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.783
[S5] round=29 local utility u=0.204766 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9478411652076071, 'loss_val': 0.3101881321276607, 'psi': 0.7993288251778583}-{'f1_val': 0.6789012589519858, 'auprc': 0.8737969372043587, 'loss_val': 0.3690712552524692, 'psi': 0.756859530252935}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=29 head_norm_before_train=1.760633 cos_to_last_merge=0.9887 (last merge round=16)
[S6] round=29 local utility u=0.000000 metrics={'f1_val': 0.648925408711082, 'auprc': 0.8862546032595529, 'loss_val': 0.84328168465471, 'psi': 0.7438570865304703}-{'f1_val': 0.9369575339381917, 'auprc': 0.9552822284696034, 'loss_val': 0.24954350947401538, 'psi': 0.9442874117507565}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=29 head_norm_before_train=1.109474 cos_to_last_merge=0.9199 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.920
[S7] round=29 local utility u=0.183454 metrics={'f1_val': 0.48238545700659785, 'auprc': 0.7766371050527109, 'loss_val': 0.8817307567850683, 'psi': 0.600086116225043}-{'f1_val': 0.4204516052900704, 'auprc': 0.7778682476814913, 'loss_val': 0.8807286765887951, 'psi': 0.5634182622466388}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=29 head_norm_before_train=1.659330 cos_to_last_merge=0.9687 (last merge round=15)
[S8] round=29 local utility u=1.000000 metrics={'f1_val': 0.987557559395217, 'auprc': 0.9989804892827907, 'loss_val': 0.05486497230603489, 'psi': 0.9921267313502465}-{'f1_val': 0.7139758603458082, 'auprc': 0.987293453133492, 'loss_val': 0.39638300340113175, 'psi': 0.8233028974608817}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] sending update (kind=head size=1805 to 1 peers)
[S9] START round=29 head_norm_before_train=1.747788 cos_to_last_merge=0.8312 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.831
[S9] round=29 local utility u=0.000000 metrics={'f1_val': 0.9926544572506684, 'auprc': 0.9988295605078013, 'loss_val': 0.03254777412629313, 'psi': 0.9951244985535215}-{'f1_val': 0.9951655063899485, 'auprc': 0.9988218930112158, 'loss_val': 0.02861022952714671, 'psi': 0.9966280610384554}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=29 head_norm_before_train=1.516029 cos_to_last_merge=0.9404 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.940
[S10] round=29 local utility u=0.002001 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9935201479911555, 'loss_val': 0.049056642143632416, 'psi': 0.9942572247280856}-{'f1_val': 0.9949681865317428, 'auprc': 0.9930754374189877, 'loss_val': 0.053041299160480226, 'psi': 0.9942110868866407}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=29 head_norm_before_train=1.603122 cos_to_last_merge=0.9479 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.948
[S11] round=29 local utility u=0.004681 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.996038906890411, 'loss_val': 0.04044777139076772, 'psi': 0.9963437654643181}-{'f1_val': 0.9951254857265296, 'auprc': 0.9981113686452414, 'loss_val': 0.047498108569555414, 'psi': 0.9963198388940143}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=29 head_norm_before_train=1.507384 cos_to_last_merge=0.9535 (last merge round=11)
[S13] round=29 local utility u=0.165305 metrics={'f1_val': 0.6248211995091224, 'auprc': 0.6516952793304988, 'loss_val': 0.5663268479972838, 'psi': 0.6355708314376729}-{'f1_val': 0.5828327705244686, 'auprc': 0.6875956055952399, 'loss_val': 0.7527073951320368, 'psi': 0.6247379045527771}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=29 head_norm_before_train=1.611399 cos_to_last_merge=0.9717 (last merge round=16)
[S14] round=29 local utility u=0.000000 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9969710309751781, 'loss_val': 0.03448278775039585, 'psi': 0.9971326264135472}-{'f1_val': 0.9976511180498535, 'auprc': 0.9970134400124118, 'loss_val': 0.03492042522032189, 'psi': 0.9973960468348768}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=29 head_norm_before_train=1.945493 (no previous merge yet)
[S15] round=29 local utility u=0.000000 metrics={'f1_val': 0.8812533479081182, 'auprc': 0.9925682050616274, 'loss_val': 0.18915107474045337, 'psi': 0.9257792907695218}-{'f1_val': 0.9146014779607884, 'auprc': 0.9904925753317082, 'loss_val': 0.1059039174051728, 'psi': 0.9449579169091564}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=29 head_norm_before_train=1.383558 cos_to_last_merge=0.8806 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.881
[S16] round=29 local utility u=0.000000 metrics={'f1_val': 0.8371960332548025, 'auprc': 0.9815751234564465, 'loss_val': 0.8045269100979355, 'psi': 0.8949476693354601}-{'f1_val': 0.8449115884850297, 'auprc': 0.9840212351114683, 'loss_val': 0.7246360057255641, 'psi': 0.9005554471356052}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=29 head_norm_before_train=1.226269 cos_to_last_merge=0.7257 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.726
[S17] round=29 local utility u=0.027704 metrics={'f1_val': 0.37531191607187586, 'auprc': 0.8220392369167527, 'loss_val': 0.9511895712276971, 'psi': 0.5540028444098266}-{'f1_val': 0.3746118753687938, 'auprc': 0.8129578738134204, 'loss_val': 0.9751532268184373, 'psi': 0.5499502747466445}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] START round=30 head_norm_before_train=1.584781 cos_to_last_merge=0.7706 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.771
[S2] round=30 local utility u=0.000000 metrics={'f1_val': 0.677340409017954, 'auprc': 0.7393965378166856, 'loss_val': 0.7433076476509837, 'psi': 0.7021628605374466}-{'f1_val': 0.6875352564031323, 'auprc': 0.7684303799354809, 'loss_val': 0.595201192020591, 'psi': 0.7198933058160717}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=30 head_norm_before_train=1.397287 cos_to_last_merge=0.9513 (last merge round=15)
[S3] round=30 local utility u=0.000000 metrics={'f1_val': 0.45539055629233294, 'auprc': 0.8032751481830211, 'loss_val': 0.8239182044426301, 'psi': 0.5945443930486083}-{'f1_val': 0.960621378487214, 'auprc': 0.997198447533711, 'loss_val': 0.14991739771919252, 'psi': 0.9752522061058129}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=30 head_norm_before_train=1.294212 cos_to_last_merge=0.9469 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.947
[S4] round=30 local utility u=0.142785 metrics={'f1_val': 0.9040828091150725, 'auprc': 0.9594525807431138, 'loss_val': 0.3145102471616895, 'psi': 0.926230717766289}-{'f1_val': 0.902722129852672, 'auprc': 0.8897399652517595, 'loss_val': 0.3827773567287347, 'psi': 0.897529264012307}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=30 head_norm_before_train=1.325139 cos_to_last_merge=0.7799 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.780
[S5] round=30 local utility u=0.024132 metrics={'f1_val': 0.6981739569172122, 'auprc': 0.9600711972014798, 'loss_val': 0.28573530489381144, 'psi': 0.8029328530309192}-{'f1_val': 0.700320598491359, 'auprc': 0.9478411652076071, 'loss_val': 0.3101881321276607, 'psi': 0.7993288251778583}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=30 head_norm_before_train=1.770678 cos_to_last_merge=0.9880 (last merge round=16)
[S6] round=30 local utility u=0.654842 metrics={'f1_val': 0.8013452387519114, 'auprc': 0.9258697019606309, 'loss_val': 0.5669615213712983, 'psi': 0.8511550240353992}-{'f1_val': 0.648925408711082, 'auprc': 0.8862546032595529, 'loss_val': 0.84328168465471, 'psi': 0.7438570865304703}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] sending update (kind=head size=1796 to 1 peers)
[S7] START round=30 head_norm_before_train=1.123649 cos_to_last_merge=0.9164 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.916
[S7] round=30 local utility u=0.633571 metrics={'f1_val': 0.6323266171120907, 'auprc': 0.8050817771253143, 'loss_val': 0.5995706559808653, 'psi': 0.7014286811173802}-{'f1_val': 0.48238545700659785, 'auprc': 0.7766371050527109, 'loss_val': 0.8817307567850683, 'psi': 0.600086116225043}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S7] sending update (kind=head size=1807 to 1 peers)
[S8] START round=30 head_norm_before_train=1.673039 cos_to_last_merge=0.9674 (last merge round=15)
[S8] round=30 local utility u=0.000000 metrics={'f1_val': 0.9929047892228047, 'auprc': 0.9851879096161769, 'loss_val': 0.06124840890991696, 'psi': 0.9898180373801536}-{'f1_val': 0.987557559395217, 'auprc': 0.9989804892827907, 'loss_val': 0.05486497230603489, 'psi': 0.9921267313502465}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=30 head_norm_before_train=1.760795 cos_to_last_merge=0.8303 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.830
[S9] round=30 local utility u=0.013389 metrics={'f1_val': 0.9959957888192151, 'auprc': 0.9988190394742226, 'loss_val': 0.025786258230294165, 'psi': 0.997125089081218}-{'f1_val': 0.9926544572506684, 'auprc': 0.9988295605078013, 'loss_val': 0.03254777412629313, 'psi': 0.9951244985535215}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=30 head_norm_before_train=1.540959 cos_to_last_merge=0.9374 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.937
[S10] round=30 local utility u=0.002167 metrics={'f1_val': 0.9940903254969471, 'auprc': 0.9955592806486402, 'loss_val': 0.046891130833107114, 'psi': 0.9946779075576243}-{'f1_val': 0.9947486092193725, 'auprc': 0.9935201479911555, 'loss_val': 0.049056642143632416, 'psi': 0.9942572247280856}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] sending update (kind=head size=1804 to 1 peers)
[S11] START round=30 head_norm_before_train=1.622110 cos_to_last_merge=0.9455 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.946
[S11] round=30 local utility u=0.000000 metrics={'f1_val': 0.9939921762939778, 'auprc': 0.9977145350220281, 'loss_val': 0.04636411235033257, 'psi': 0.9954811197851979}-{'f1_val': 0.9965470045135896, 'auprc': 0.996038906890411, 'loss_val': 0.04044777139076772, 'psi': 0.9963437654643181}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=30 head_norm_before_train=1.517271 cos_to_last_merge=0.9522 (last merge round=11)
[S13] round=30 local utility u=0.000000 metrics={'f1_val': 0.5738921008314906, 'auprc': 0.6903208525362794, 'loss_val': 0.828231094166768, 'psi': 0.6204636015134062}-{'f1_val': 0.6248211995091224, 'auprc': 0.6516952793304988, 'loss_val': 0.5663268479972838, 'psi': 0.6355708314376729}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=30 head_norm_before_train=1.638260 cos_to_last_merge=0.9694 (last merge round=16)
[S14] round=30 local utility u=0.000000 metrics={'f1_val': 0.9966503922901382, 'auprc': 0.9957614264527342, 'loss_val': 0.03176272641493543, 'psi': 0.9962948059551766}-{'f1_val': 0.997240356705793, 'auprc': 0.9969710309751781, 'loss_val': 0.03448278775039585, 'psi': 0.9971326264135472}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=30 head_norm_before_train=1.959016 (no previous merge yet)
[S15] round=30 local utility u=0.000000 metrics={'f1_val': 0.6976924893654441, 'auprc': 0.8556698328579676, 'loss_val': 0.5523062391865954, 'psi': 0.7608834267624536}-{'f1_val': 0.8812533479081182, 'auprc': 0.9925682050616274, 'loss_val': 0.18915107474045337, 'psi': 0.9257792907695218}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=30 head_norm_before_train=1.404996 cos_to_last_merge=0.8772 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.877
[S16] round=30 local utility u=0.081174 metrics={'f1_val': 0.8472325113495096, 'auprc': 0.9869837767689442, 'loss_val': 0.7186245492462494, 'psi': 0.9031330175172835}-{'f1_val': 0.8371960332548025, 'auprc': 0.9815751234564465, 'loss_val': 0.8045269100979355, 'psi': 0.8949476693354601}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=30 head_norm_before_train=1.239874 cos_to_last_merge=0.7248 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.725
[S17] round=30 local utility u=0.000000 metrics={'f1_val': 0.37465365328470895, 'auprc': 0.8130148485742741, 'loss_val': 0.9651004105531258, 'psi': 0.549998131400535}-{'f1_val': 0.37531191607187586, 'auprc': 0.8220392369167527, 'loss_val': 0.9511895712276971, 'psi': 0.5540028444098266}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=31 head_norm_before_train=1.602453 cos_to_last_merge=0.7696 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.770
[S2] round=31 local utility u=0.036935 metrics={'f1_val': 0.690935908949707, 'auprc': 0.7481176721850202, 'loss_val': 0.7771748389137947, 'psi': 0.7138086142438322}-{'f1_val': 0.677340409017954, 'auprc': 0.7393965378166856, 'loss_val': 0.7433076476509837, 'psi': 0.7021628605374466}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=31 head_norm_before_train=1.409701 cos_to_last_merge=0.9498 (last merge round=15)
[S3] ⚠️ Model drifted since last merge! cos=0.950
[S3] round=31 local utility u=1.000000 metrics={'f1_val': 0.961810367574427, 'auprc': 0.9981321648580606, 'loss_val': 0.11332727514317786, 'psi': 0.9763390864878805}-{'f1_val': 0.45539055629233294, 'auprc': 0.8032751481830211, 'loss_val': 0.8239182044426301, 'psi': 0.5945443930486083}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=31 head_norm_before_train=1.310727 cos_to_last_merge=0.9436 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.944
[S4] round=31 local utility u=0.061846 metrics={'f1_val': 0.9298552026437161, 'auprc': 0.9514688692239011, 'loss_val': 0.32150176097872846, 'psi': 0.93850066927579}-{'f1_val': 0.9040828091150725, 'auprc': 0.9594525807431138, 'loss_val': 0.3145102471616895, 'psi': 0.926230717766289}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=31 head_norm_before_train=1.346444 cos_to_last_merge=0.7748 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.775
[S5] round=31 local utility u=0.000000 metrics={'f1_val': 0.629234991135205, 'auprc': 0.8625277146071749, 'loss_val': 0.38612489134558753, 'psi': 0.7225520805239929}-{'f1_val': 0.6981739569172122, 'auprc': 0.9600711972014798, 'loss_val': 0.28573530489381144, 'psi': 0.8029328530309192}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=31 head_norm_before_train=1.783702 cos_to_last_merge=0.9875 (last merge round=16)
[S6] round=31 local utility u=0.297164 metrics={'f1_val': 0.8554308072161704, 'auprc': 0.9535124194256226, 'loss_val': 0.3800742148498746, 'psi': 0.8946634520999512}-{'f1_val': 0.8013452387519114, 'auprc': 0.9258697019606309, 'loss_val': 0.5669615213712983, 'psi': 0.8511550240353992}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] sending update (kind=head size=1804 to 1 peers)
[S7] START round=31 head_norm_before_train=1.137416 cos_to_last_merge=0.9134 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.913
[S7] round=31 local utility u=0.000000 metrics={'f1_val': 0.5836554495091486, 'auprc': 0.7792542144698729, 'loss_val': 0.7849173711388396, 'psi': 0.6618949554934384}-{'f1_val': 0.6323266171120907, 'auprc': 0.8050817771253143, 'loss_val': 0.5995706559808653, 'psi': 0.7014286811173802}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=31 head_norm_before_train=1.687726 cos_to_last_merge=0.9663 (last merge round=15)
[S8] round=31 local utility u=0.022138 metrics={'f1_val': 0.9912267239616498, 'auprc': 0.9984701838006999, 'loss_val': 0.04674988922986326, 'psi': 0.9941241078972698}-{'f1_val': 0.9929047892228047, 'auprc': 0.9851879096161769, 'loss_val': 0.06124840890991696, 'psi': 0.9898180373801536}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] sending update (kind=head size=1805 to 1 peers)
[S9] START round=31 head_norm_before_train=1.773897 cos_to_last_merge=0.8293 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.829
[S9] round=31 local utility u=0.000000 metrics={'f1_val': 0.9939393793306803, 'auprc': 0.9990105797120926, 'loss_val': 0.030105413965403515, 'psi': 0.9959678594832453}-{'f1_val': 0.9959957888192151, 'auprc': 0.9988190394742226, 'loss_val': 0.025786258230294165, 'psi': 0.997125089081218}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=31 head_norm_before_train=1.563967 cos_to_last_merge=0.9347 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.935
[S10] round=31 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9921187829747732, 'loss_val': 0.04341681782327567, 'psi': 0.9936966787215328}-{'f1_val': 0.9940903254969471, 'auprc': 0.9955592806486402, 'loss_val': 0.046891130833107114, 'psi': 0.9946779075576243}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=31 head_norm_before_train=1.637657 cos_to_last_merge=0.9436 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.944
[S11] round=31 local utility u=0.000000 metrics={'f1_val': 0.9875846008345079, 'auprc': 0.9968848659625303, 'loss_val': 0.08017490455483958, 'psi': 0.9913047068857169}-{'f1_val': 0.9939921762939778, 'auprc': 0.9977145350220281, 'loss_val': 0.04636411235033257, 'psi': 0.9954811197851979}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=31 head_norm_before_train=1.527524 cos_to_last_merge=0.9507 (last merge round=11)
[S13] round=31 local utility u=0.207274 metrics={'f1_val': 0.6206660667070768, 'auprc': 0.6620136890111479, 'loss_val': 0.6094049232963809, 'psi': 0.6372051156287053}-{'f1_val': 0.5738921008314906, 'auprc': 0.6903208525362794, 'loss_val': 0.828231094166768, 'psi': 0.6204636015134062}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] sending update (kind=head size=1806 to 1 peers)
[S14] START round=31 head_norm_before_train=1.660753 cos_to_last_merge=0.9675 (last merge round=16)
[S14] round=31 local utility u=0.006680 metrics={'f1_val': 0.9969987740343681, 'auprc': 0.9986672083500081, 'loss_val': 0.029209794568441416, 'psi': 0.9976661477606241}-{'f1_val': 0.9966503922901382, 'auprc': 0.9957614264527342, 'loss_val': 0.03176272641493543, 'psi': 0.9962948059551766}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=31 head_norm_before_train=1.971653 (no previous merge yet)
[S15] round=31 local utility u=1.000000 metrics={'f1_val': 0.9941266690227756, 'auprc': 0.9972584638922569, 'loss_val': 0.033590393630361315, 'psi': 0.995379386970568}-{'f1_val': 0.6976924893654441, 'auprc': 0.8556698328579676, 'loss_val': 0.5523062391865954, 'psi': 0.7608834267624536}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=31 head_norm_before_train=1.426467 cos_to_last_merge=0.8740 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.874
[S16] round=31 local utility u=0.000000 metrics={'f1_val': 0.8422009247426112, 'auprc': 0.9844471643474976, 'loss_val': 0.7859508063920468, 'psi': 0.8990994205845657}-{'f1_val': 0.8472325113495096, 'auprc': 0.9869837767689442, 'loss_val': 0.7186245492462494, 'psi': 0.9031330175172835}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=31 head_norm_before_train=1.255411 cos_to_last_merge=0.7236 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.724
[S17] round=31 local utility u=0.000000 metrics={'f1_val': 0.3691084913780157, 'auprc': 0.7987841010469887, 'loss_val': 1.032141753862568, 'psi': 0.5409787352456049}-{'f1_val': 0.37465365328470895, 'auprc': 0.8130148485742741, 'loss_val': 0.9651004105531258, 'psi': 0.549998131400535}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=32 head_norm_before_train=1.620121 cos_to_last_merge=0.7686 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.769
[S2] round=32 local utility u=0.013809 metrics={'f1_val': 0.7159532433898881, 'auprc': 0.7354961503154723, 'loss_val': 0.8617967606095115, 'psi': 0.7237704061601218}-{'f1_val': 0.690935908949707, 'auprc': 0.7481176721850202, 'loss_val': 0.7771748389137947, 'psi': 0.7138086142438322}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=32 head_norm_before_train=1.419244 cos_to_last_merge=0.9486 (last merge round=15)
[S3] ⚠️ Model drifted since last merge! cos=0.949
[S3] round=32 local utility u=0.000000 metrics={'f1_val': 0.9513479794679052, 'auprc': 0.9879766169742739, 'loss_val': 0.13074585659493324, 'psi': 0.9659994344704526}-{'f1_val': 0.961810367574427, 'auprc': 0.9981321648580606, 'loss_val': 0.11332727514317786, 'psi': 0.9763390864878805}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=32 head_norm_before_train=1.325004 cos_to_last_merge=0.9409 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.941
[S4] round=32 local utility u=0.032654 metrics={'f1_val': 0.9230218761515259, 'auprc': 0.9780112294888147, 'loss_val': 0.2948200654738689, 'psi': 0.9450176174864413}-{'f1_val': 0.9298552026437161, 'auprc': 0.9514688692239011, 'loss_val': 0.32150176097872846, 'psi': 0.93850066927579}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=32 head_norm_before_train=1.365506 cos_to_last_merge=0.7711 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.771
[S5] round=32 local utility u=0.485470 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9895587287521213, 'loss_val': 0.22279637050209283, 'psi': 0.8160162819611967}-{'f1_val': 0.629234991135205, 'auprc': 0.8625277146071749, 'loss_val': 0.38612489134558753, 'psi': 0.7225520805239929}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=32 head_norm_before_train=1.799769 cos_to_last_merge=0.9867 (last merge round=16)
[S6] round=32 local utility u=0.000000 metrics={'f1_val': 0.5996034061643433, 'auprc': 0.7929993534219542, 'loss_val': 0.9533717095493917, 'psi': 0.6769617850673877}-{'f1_val': 0.8554308072161704, 'auprc': 0.9535124194256226, 'loss_val': 0.3800742148498746, 'psi': 0.8946634520999512}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=32 head_norm_before_train=1.148791 cos_to_last_merge=0.9106 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.911
[S7] round=32 local utility u=0.319310 metrics={'f1_val': 0.6368048231263919, 'auprc': 0.8112923210089242, 'loss_val': 0.561307291204991, 'psi': 0.7065998222794048}-{'f1_val': 0.5836554495091486, 'auprc': 0.7792542144698729, 'loss_val': 0.7849173711388396, 'psi': 0.6618949554934384}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=32 head_norm_before_train=1.701023 cos_to_last_merge=0.9655 (last merge round=15)
[S8] round=32 local utility u=0.000000 metrics={'f1_val': 0.9945717084929089, 'auprc': 0.9858197847943679, 'loss_val': 0.044227658631010615, 'psi': 0.9910709390134924}-{'f1_val': 0.9912267239616498, 'auprc': 0.9984701838006999, 'loss_val': 0.04674988922986326, 'psi': 0.9941241078972698}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=32 head_norm_before_train=1.786241 cos_to_last_merge=0.8286 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.829
[S9] round=32 local utility u=0.006240 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9950002581885037, 'loss_val': 0.02457499863693591, 'psi': 0.9962618507826871}-{'f1_val': 0.9939393793306803, 'auprc': 0.9990105797120926, 'loss_val': 0.030105413965403515, 'psi': 0.9959678594832453}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=32 head_norm_before_train=1.582402 cos_to_last_merge=0.9325 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.933
[S10] round=32 local utility u=0.002548 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9933767394363651, 'loss_val': 0.04209535500652727, 'psi': 0.9941998613061696}-{'f1_val': 0.9947486092193725, 'auprc': 0.9921187829747732, 'loss_val': 0.04341681782327567, 'psi': 0.9936966787215328}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=32 head_norm_before_train=1.651967 cos_to_last_merge=0.9419 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.942
[S11] round=32 local utility u=0.045713 metrics={'f1_val': 0.996129246008257, 'auprc': 0.9963363751010894, 'loss_val': 0.038370954495421404, 'psi': 0.99621209764539}-{'f1_val': 0.9875846008345079, 'auprc': 0.9968848659625303, 'loss_val': 0.08017490455483958, 'psi': 0.9913047068857169}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=32 head_norm_before_train=1.534883 cos_to_last_merge=0.9495 (last merge round=11)
[S13] ⚠️ Model drifted since last merge! cos=0.949
[S13] round=32 local utility u=0.000000 metrics={'f1_val': 0.6072064084299261, 'auprc': 0.6776429547481584, 'loss_val': 0.7055851940105602, 'psi': 0.6353810269572191}-{'f1_val': 0.6206660667070768, 'auprc': 0.6620136890111479, 'loss_val': 0.6094049232963809, 'psi': 0.6372051156287053}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=32 head_norm_before_train=1.677969 cos_to_last_merge=0.9661 (last merge round=16)
[S14] round=32 local utility u=0.000000 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.9959498401655693, 'loss_val': 0.03621051050633811, 'psi': 0.996332275032678}-{'f1_val': 0.9969987740343681, 'auprc': 0.9986672083500081, 'loss_val': 0.029209794568441416, 'psi': 0.9976661477606241}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=32 head_norm_before_train=1.983265 (no previous merge yet)
[S15] round=32 local utility u=0.000000 metrics={'f1_val': 0.9966196520233872, 'auprc': 0.993250732166214, 'loss_val': 0.04080180087149365, 'psi': 0.9952720840805179}-{'f1_val': 0.9941266690227756, 'auprc': 0.9972584638922569, 'loss_val': 0.033590393630361315, 'psi': 0.995379386970568}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=32 head_norm_before_train=1.446239 cos_to_last_merge=0.8714 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.871
[S16] round=32 local utility u=0.535607 metrics={'f1_val': 0.9362846992987516, 'auprc': 0.989004004222888, 'loss_val': 0.29291041240561044, 'psi': 0.9573724212684062}-{'f1_val': 0.8422009247426112, 'auprc': 0.9844471643474976, 'loss_val': 0.7859508063920468, 'psi': 0.8990994205845657}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=32 head_norm_before_train=1.271407 cos_to_last_merge=0.7215 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.721
[S17] round=32 local utility u=0.037781 metrics={'f1_val': 0.3758981502985024, 'auprc': 0.7986444290755366, 'loss_val': 0.9968983200776443, 'psi': 0.544996661809316}-{'f1_val': 0.3691084913780157, 'auprc': 0.7987841010469887, 'loss_val': 1.032141753862568, 'psi': 0.5409787352456049}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] sending update (kind=head size=1793 to 1 peers)
[S2] START round=33 head_norm_before_train=1.638424 cos_to_last_merge=0.7675 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.767
[S2] round=33 local utility u=0.000000 metrics={'f1_val': 0.7098011411574253, 'auprc': 0.7328271155591086, 'loss_val': 0.8685568931563399, 'psi': 0.7190115309180987}-{'f1_val': 0.7159532433898881, 'auprc': 0.7354961503154723, 'loss_val': 0.8617967606095115, 'psi': 0.7237704061601218}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=33 head_norm_before_train=1.428939 cos_to_last_merge=0.9472 (last merge round=15)
[S3] ⚠️ Model drifted since last merge! cos=0.947
[S3] round=33 local utility u=0.000000 metrics={'f1_val': 0.7216205889320831, 'auprc': 0.8212151966253682, 'loss_val': 0.46852487331373066, 'psi': 0.7614584320093972}-{'f1_val': 0.9513479794679052, 'auprc': 0.9879766169742739, 'loss_val': 0.13074585659493324, 'psi': 0.9659994344704526}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=33 head_norm_before_train=1.335537 cos_to_last_merge=0.9387 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.939
[S4] round=33 local utility u=0.000000 metrics={'f1_val': 0.9255141209578781, 'auprc': 0.9323336967572465, 'loss_val': 0.29659189136849845, 'psi': 0.9282419512776254}-{'f1_val': 0.9230218761515259, 'auprc': 0.9780112294888147, 'loss_val': 0.2948200654738689, 'psi': 0.9450176174864413}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=33 head_norm_before_train=1.382230 cos_to_last_merge=0.7692 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.769
[S5] round=33 local utility u=0.000000 metrics={'f1_val': 0.4729204976643755, 'auprc': 0.832937724178226, 'loss_val': 0.6886853642639321, 'psi': 0.6169273882699157}-{'f1_val': 0.7003213174339138, 'auprc': 0.9895587287521213, 'loss_val': 0.22279637050209283, 'psi': 0.8160162819611967}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=33 head_norm_before_train=1.812929 cos_to_last_merge=0.9857 (last merge round=16)
[S6] round=33 local utility u=1.000000 metrics={'f1_val': 0.8277132983579538, 'auprc': 0.9575151159394385, 'loss_val': 0.29827254080787274, 'psi': 0.8796340253905477}-{'f1_val': 0.5996034061643433, 'auprc': 0.7929993534219542, 'loss_val': 0.9533717095493917, 'psi': 0.6769617850673877}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] sending update (kind=head size=1805 to 1 peers)
[S7] START round=33 head_norm_before_train=1.162946 cos_to_last_merge=0.9074 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.907
[S7] round=33 local utility u=0.000000 metrics={'f1_val': 0.5327364674352868, 'auprc': 0.7794444290601878, 'loss_val': 0.8397386710738612, 'psi': 0.6314196520852473}-{'f1_val': 0.6368048231263919, 'auprc': 0.8112923210089242, 'loss_val': 0.561307291204991, 'psi': 0.7065998222794048}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=33 head_norm_before_train=1.713330 cos_to_last_merge=0.9651 (last merge round=15)
[S8] round=33 local utility u=0.011640 metrics={'f1_val': 0.9937185965290795, 'auprc': 0.9946266169760225, 'loss_val': 0.04224982237313384, 'psi': 0.9940818047078567}-{'f1_val': 0.9945717084929089, 'auprc': 0.9858197847943679, 'loss_val': 0.044227658631010615, 'psi': 0.9910709390134924}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=33 head_norm_before_train=1.799689 cos_to_last_merge=0.8276 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.828
[S9] round=33 local utility u=0.000000 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9942636854105074, 'loss_val': 0.024032872571670638, 'psi': 0.9957209689230603}-{'f1_val': 0.9971029125121428, 'auprc': 0.9950002581885037, 'loss_val': 0.02457499863693591, 'psi': 0.9962618507826871}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=33 head_norm_before_train=1.597050 cos_to_last_merge=0.9306 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.931
[S10] round=33 local utility u=0.001474 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9940044079181136, 'loss_val': 0.04102989865879114, 'psi': 0.994450928698869}-{'f1_val': 0.9947486092193725, 'auprc': 0.9933767394363651, 'loss_val': 0.04209535500652727, 'psi': 0.9941998613061696}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=33 head_norm_before_train=1.666616 cos_to_last_merge=0.9402 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.940
[S11] round=33 local utility u=0.000000 metrics={'f1_val': 0.9585002444310197, 'auprc': 0.9971951217927958, 'loss_val': 0.07811339376653414, 'psi': 0.97397819537573}-{'f1_val': 0.996129246008257, 'auprc': 0.9963363751010894, 'loss_val': 0.038370954495421404, 'psi': 0.99621209764539}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=33 head_norm_before_train=1.541861 cos_to_last_merge=0.9484 (last merge round=11)
[S13] ⚠️ Model drifted since last merge! cos=0.948
[S13] round=33 local utility u=0.054295 metrics={'f1_val': 0.6204287725341274, 'auprc': 0.6679249610479606, 'loss_val': 0.6471751168039497, 'psi': 0.6394272479396608}-{'f1_val': 0.6072064084299261, 'auprc': 0.6776429547481584, 'loss_val': 0.7055851940105602, 'psi': 0.6353810269572191}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=33 head_norm_before_train=1.693622 cos_to_last_merge=0.9649 (last merge round=16)
[S14] round=33 local utility u=0.005655 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9970473907691283, 'loss_val': 0.030655505271446445, 'psi': 0.9970174612022504}-{'f1_val': 0.9965872316107504, 'auprc': 0.9959498401655693, 'loss_val': 0.03621051050633811, 'psi': 0.996332275032678}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[S15] START round=33 head_norm_before_train=1.988401 (no previous merge yet)
[S15] round=33 local utility u=0.000000 metrics={'f1_val': 0.6992694232345967, 'auprc': 0.9216746218200021, 'loss_val': 0.4540916868897308, 'psi': 0.788231502668759}-{'f1_val': 0.9966196520233872, 'auprc': 0.993250732166214, 'loss_val': 0.04080180087149365, 'psi': 0.9952720840805179}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=33 head_norm_before_train=1.463705 cos_to_last_merge=0.8687 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.869
[S16] round=33 local utility u=0.261428 metrics={'f1_val': 0.9895530799987301, 'auprc': 0.9837958448783098, 'loss_val': 0.07404041504656064, 'psi': 0.987250185950562}-{'f1_val': 0.9362846992987516, 'auprc': 0.989004004222888, 'loss_val': 0.29291041240561044, 'psi': 0.9573724212684062}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=33 head_norm_before_train=1.289555 cos_to_last_merge=0.7192 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.719
[S17] round=33 local utility u=0.065140 metrics={'f1_val': 0.3842054705257405, 'auprc': 0.8028248675517407, 'loss_val': 0.9290037722842298, 'psi': 0.5516532293361406}-{'f1_val': 0.3758981502985024, 'auprc': 0.7986444290755366, 'loss_val': 0.9968983200776443, 'psi': 0.544996661809316}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S17] sending update (kind=head size=1791 to 1 peers)
[S2] START round=34 head_norm_before_train=1.655153 cos_to_last_merge=0.7666 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.767
[S2] round=34 local utility u=0.000000 metrics={'f1_val': 0.7066004797157123, 'auprc': 0.7298680500469862, 'loss_val': 0.8995879477835506, 'psi': 0.7159075078482218}-{'f1_val': 0.7098011411574253, 'auprc': 0.7328271155591086, 'loss_val': 0.8685568931563399, 'psi': 0.7190115309180987}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=34 head_norm_before_train=1.441928 cos_to_last_merge=0.9451 (last merge round=15)
[S3] ⚠️ Model drifted since last merge! cos=0.945
[S3] round=34 local utility u=1.000000 metrics={'f1_val': 0.93207327602225, 'auprc': 0.9979599924772102, 'loss_val': 0.18565498639853883, 'psi': 0.9584279626042341}-{'f1_val': 0.7216205889320831, 'auprc': 0.8212151966253682, 'loss_val': 0.46852487331373066, 'psi': 0.7614584320093972}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=34 head_norm_before_train=1.343984 cos_to_last_merge=0.9360 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.936
[S4] round=34 local utility u=0.044455 metrics={'f1_val': 0.9240619006100098, 'auprc': 0.9577664712640833, 'loss_val': 0.2752675763467769, 'psi': 0.9375437288716393}-{'f1_val': 0.9255141209578781, 'auprc': 0.9323336967572465, 'loss_val': 0.29659189136849845, 'psi': 0.9282419512776254}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=34 head_norm_before_train=1.395055 cos_to_last_merge=0.7679 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.768
[S5] round=34 local utility u=1.000000 metrics={'f1_val': 0.7003221706489986, 'auprc': 0.9904918389533197, 'loss_val': 0.20375574099243898, 'psi': 0.8163900379707271}-{'f1_val': 0.4729204976643755, 'auprc': 0.832937724178226, 'loss_val': 0.6886853642639321, 'psi': 0.6169273882699157}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=34 head_norm_before_train=1.821077 cos_to_last_merge=0.9848 (last merge round=16)
[S6] round=34 local utility u=0.505775 metrics={'f1_val': 0.9646925539390936, 'auprc': 0.9755413954093226, 'loss_val': 0.1626767441797409, 'psi': 0.9690320905271852}-{'f1_val': 0.8277132983579538, 'auprc': 0.9575151159394385, 'loss_val': 0.29827254080787274, 'psi': 0.8796340253905477}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] sending update (kind=head size=1805 to 1 peers)
[S7] START round=34 head_norm_before_train=1.175289 cos_to_last_merge=0.9045 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.905
[S7] round=34 local utility u=0.000000 metrics={'f1_val': 0.40167725370428475, 'auprc': 0.7781506635822913, 'loss_val': 1.0542191942272547, 'psi': 0.5522666176554873}-{'f1_val': 0.5327364674352868, 'auprc': 0.7794444290601878, 'loss_val': 0.8397386710738612, 'psi': 0.6314196520852473}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=34 head_norm_before_train=1.721909 cos_to_last_merge=0.9648 (last merge round=15)
[S8] round=34 local utility u=0.000000 metrics={'f1_val': 0.9838877351206077, 'auprc': 0.9986207157146662, 'loss_val': 0.06104900834209104, 'psi': 0.9897809273582311}-{'f1_val': 0.9937185965290795, 'auprc': 0.9946266169760225, 'loss_val': 0.04224982237313384, 'psi': 0.9940818047078567}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=34 head_norm_before_train=1.812096 cos_to_last_merge=0.8264 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.826
[S9] round=34 local utility u=0.000000 metrics={'f1_val': 0.9897381162675762, 'auprc': 0.9995934413447545, 'loss_val': 0.03895753653180155, 'psi': 0.9936802462984475}-{'f1_val': 0.9966924912647621, 'auprc': 0.9942636854105074, 'loss_val': 0.024032872571670638, 'psi': 0.9957209689230603}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=34 head_norm_before_train=1.612564 cos_to_last_merge=0.9288 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.929
[S10] round=34 local utility u=0.001503 metrics={'f1_val': 0.9944449605296568, 'auprc': 0.9953760768862708, 'loss_val': 0.0403167949850351, 'psi': 0.9948174070723024}-{'f1_val': 0.9947486092193725, 'auprc': 0.9940044079181136, 'loss_val': 0.04102989865879114, 'psi': 0.994450928698869}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=34 head_norm_before_train=1.681987 cos_to_last_merge=0.9383 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.938
[S11] round=34 local utility u=0.133117 metrics={'f1_val': 0.9954332224704452, 'auprc': 0.9969220169695345, 'loss_val': 0.032657876130890405, 'psi': 0.9960287402700809}-{'f1_val': 0.9585002444310197, 'auprc': 0.9971951217927958, 'loss_val': 0.07811339376653414, 'psi': 0.97397819537573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=34 head_norm_before_train=1.549109 cos_to_last_merge=0.9473 (last merge round=11)
[S13] ⚠️ Model drifted since last merge! cos=0.947
[S13] round=34 local utility u=0.000000 metrics={'f1_val': 0.5954926544639598, 'auprc': 0.6837052120641881, 'loss_val': 0.7406851663493706, 'psi': 0.6307776775040512}-{'f1_val': 0.6204287725341274, 'auprc': 0.6679249610479606, 'loss_val': 0.6471751168039497, 'psi': 0.6394272479396608}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=34 head_norm_before_train=1.708991 cos_to_last_merge=0.9634 (last merge round=16)
[S14] round=34 local utility u=0.000093 metrics={'f1_val': 0.9968189060544872, 'auprc': 0.9969718133378959, 'loss_val': 0.029171222844971832, 'psi': 0.9968800689678508}-{'f1_val': 0.9969975081576651, 'auprc': 0.9970473907691283, 'loss_val': 0.030655505271446445, 'psi': 0.9970174612022504}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=34 head_norm_before_train=1.993723 (no previous merge yet)
[S15] round=34 local utility u=1.000000 metrics={'f1_val': 0.9966196520233872, 'auprc': 0.9975326190544826, 'loss_val': 0.026058168417584775, 'psi': 0.9969848388358253}-{'f1_val': 0.6992694232345967, 'auprc': 0.9216746218200021, 'loss_val': 0.4540916868897308, 'psi': 0.788231502668759}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=34 head_norm_before_train=1.481217 cos_to_last_merge=0.8662 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.866
[S16] round=34 local utility u=0.000000 metrics={'f1_val': 0.9423426971616432, 'auprc': 0.986661368210968, 'loss_val': 0.20424784593783785, 'psi': 0.960070165581373}-{'f1_val': 0.9895530799987301, 'auprc': 0.9837958448783098, 'loss_val': 0.07404041504656064, 'psi': 0.987250185950562}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=34 head_norm_before_train=1.307038 cos_to_last_merge=0.7169 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.717
[S17] round=34 local utility u=0.023805 metrics={'f1_val': 0.3852752039522391, 'auprc': 0.8014918624201375, 'loss_val': 0.8838140086938896, 'psi': 0.5517618673393985}-{'f1_val': 0.3842054705257405, 'auprc': 0.8028248675517407, 'loss_val': 0.9290037722842298, 'psi': 0.5516532293361406}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S17] sending update (kind=head size=1792 to 1 peers)
[S2] START round=35 head_norm_before_train=1.673570 cos_to_last_merge=0.7655 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.766
[S2] round=35 local utility u=0.015211 metrics={'f1_val': 0.7160700222807072, 'auprc': 0.7311551258359766, 'loss_val': 0.9298440635397325, 'psi': 0.7221040637028149}-{'f1_val': 0.7066004797157123, 'auprc': 0.7298680500469862, 'loss_val': 0.8995879477835506, 'psi': 0.7159075078482218}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=35 head_norm_before_train=1.454992 cos_to_last_merge=0.9430 (last merge round=15)
[S3] ⚠️ Model drifted since last merge! cos=0.943
[S3] round=35 local utility u=0.222503 metrics={'f1_val': 0.990414928338515, 'auprc': 0.9995793833381714, 'loss_val': 0.09555670807390512, 'psi': 0.9940807103383775}-{'f1_val': 0.93207327602225, 'auprc': 0.9979599924772102, 'loss_val': 0.18565498639853883, 'psi': 0.9584279626042341}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=35 head_norm_before_train=1.355196 cos_to_last_merge=0.9332 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.933
[S4] round=35 local utility u=0.000000 metrics={'f1_val': 0.9240233602392105, 'auprc': 0.950946893122286, 'loss_val': 0.2857432980660799, 'psi': 0.9347927733924406}-{'f1_val': 0.9240619006100098, 'auprc': 0.9577664712640833, 'loss_val': 0.2752675763467769, 'psi': 0.9375437288716393}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=35 head_norm_before_train=1.404352 cos_to_last_merge=0.7665 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.767
[S5] round=35 local utility u=0.000000 metrics={'f1_val': 0.67705794229925, 'auprc': 0.8538720744002423, 'loss_val': 0.38974882074528766, 'psi': 0.747783595139647}-{'f1_val': 0.7003221706489986, 'auprc': 0.9904918389533197, 'loss_val': 0.20375574099243898, 'psi': 0.8163900379707271}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=35 head_norm_before_train=1.829243 cos_to_last_merge=0.9842 (last merge round=16)
[S6] round=35 local utility u=0.000000 metrics={'f1_val': 0.41588308903900795, 'auprc': 0.6388680885640615, 'loss_val': 2.0047084199216014, 'psi': 0.5050770888490294}-{'f1_val': 0.9646925539390936, 'auprc': 0.9755413954093226, 'loss_val': 0.1626767441797409, 'psi': 0.9690320905271852}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=35 head_norm_before_train=1.182905 cos_to_last_merge=0.9026 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.903
[S7] round=35 local utility u=1.000000 metrics={'f1_val': 0.6725156064227376, 'auprc': 0.830083563905297, 'loss_val': 0.4267797240716863, 'psi': 0.7355427894157613}-{'f1_val': 0.40167725370428475, 'auprc': 0.7781506635822913, 'loss_val': 1.0542191942272547, 'psi': 0.5522666176554873}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S7] sending update (kind=head size=1807 to 1 peers)
[S8] START round=35 head_norm_before_train=1.729743 cos_to_last_merge=0.9643 (last merge round=15)
[S8] round=35 local utility u=0.035528 metrics={'f1_val': 0.9937185965290795, 'auprc': 0.995766213396115, 'loss_val': 0.040415251625646784, 'psi': 0.9945376432758937}-{'f1_val': 0.9838877351206077, 'auprc': 0.9986207157146662, 'loss_val': 0.06104900834209104, 'psi': 0.9897809273582311}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=35 head_norm_before_train=1.820858 cos_to_last_merge=0.8260 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.826
[S9] round=35 local utility u=0.023751 metrics={'f1_val': 0.9951655063899485, 'auprc': 0.9995668041814432, 'loss_val': 0.023939175049789797, 'psi': 0.9969260255065463}-{'f1_val': 0.9897381162675762, 'auprc': 0.9995934413447545, 'loss_val': 0.03895753653180155, 'psi': 0.9936802462984475}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=35 head_norm_before_train=1.628272 cos_to_last_merge=0.9269 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.927
[S10] round=35 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9932092823191174, 'loss_val': 0.03812747607565085, 'psi': 0.9941328784592705}-{'f1_val': 0.9944449605296568, 'auprc': 0.9953760768862708, 'loss_val': 0.0403167949850351, 'psi': 0.9948174070723024}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=35 head_norm_before_train=1.695984 cos_to_last_merge=0.9366 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.937
[S11] round=35 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9966643539014709, 'loss_val': 0.0525685362964422, 'psi': 0.9963582264070356}-{'f1_val': 0.9954332224704452, 'auprc': 0.9969220169695345, 'loss_val': 0.032657876130890405, 'psi': 0.9960287402700809}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=35 head_norm_before_train=1.559503 cos_to_last_merge=0.9456 (last merge round=11)
[S13] ⚠️ Model drifted since last merge! cos=0.946
[S13] round=35 local utility u=0.030193 metrics={'f1_val': 0.6065982943982571, 'auprc': 0.6805214984513593, 'loss_val': 0.7373821748998788, 'psi': 0.636167576019498}-{'f1_val': 0.5954926544639598, 'auprc': 0.6837052120641881, 'loss_val': 0.7406851663493706, 'psi': 0.6307776775040512}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S14] START round=35 head_norm_before_train=1.723949 cos_to_last_merge=0.9620 (last merge round=16)
[S14] round=35 local utility u=0.007733 metrics={'f1_val': 0.9978938390605482, 'auprc': 0.9986678746249257, 'loss_val': 0.02524221805911474, 'psi': 0.9982034532862991}-{'f1_val': 0.9968189060544872, 'auprc': 0.9969718133378959, 'loss_val': 0.029171222844971832, 'psi': 0.9968800689678508}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S14] sending update (kind=head size=1807 to 1 peers)
[S15] START round=35 head_norm_before_train=2.000669 (no previous merge yet)
[S15] round=35 local utility u=0.000000 metrics={'f1_val': 0.898412497399726, 'auprc': 0.9939517125587362, 'loss_val': 0.1407730045929771, 'psi': 0.9366281834633301}-{'f1_val': 0.9966196520233872, 'auprc': 0.9975326190544826, 'loss_val': 0.026058168417584775, 'psi': 0.9969848388358253}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=35 head_norm_before_train=1.497103 cos_to_last_merge=0.8642 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.864
[S16] round=35 local utility u=0.000000 metrics={'f1_val': 0.9352412237945494, 'auprc': 0.9869911951647419, 'loss_val': 0.3063517516476928, 'psi': 0.9559412123426264}-{'f1_val': 0.9423426971616432, 'auprc': 0.986661368210968, 'loss_val': 0.20424784593783785, 'psi': 0.960070165581373}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=35 head_norm_before_train=1.327130 cos_to_last_merge=0.7144 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.714
[S17] round=35 local utility u=0.084316 metrics={'f1_val': 0.3929186431395952, 'auprc': 0.8130940540495941, 'loss_val': 0.7958486470664999, 'psi': 0.5609888075035947}-{'f1_val': 0.3852752039522391, 'auprc': 0.8014918624201375, 'loss_val': 0.8838140086938896, 'psi': 0.5517618673393985}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S17] sending update (kind=head size=1791 to 1 peers)
[S2] START round=36 head_norm_before_train=1.690959 cos_to_last_merge=0.7645 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.765
[S2] round=36 local utility u=0.000000 metrics={'f1_val': 0.7163817679958397, 'auprc': 0.7291311520582612, 'loss_val': 0.9384156531850304, 'psi': 0.7214815216208084}-{'f1_val': 0.7160700222807072, 'auprc': 0.7311551258359766, 'loss_val': 0.9298440635397325, 'psi': 0.7221040637028149}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=36 head_norm_before_train=1.468095 cos_to_last_merge=0.9412 (last merge round=15)
[S3] ⚠️ Model drifted since last merge! cos=0.941
[S3] round=36 local utility u=0.000000 metrics={'f1_val': 0.7254578426789207, 'auprc': 0.8205933034525578, 'loss_val': 0.47481909535300304, 'psi': 0.7635120269883755}-{'f1_val': 0.990414928338515, 'auprc': 0.9995793833381714, 'loss_val': 0.09555670807390512, 'psi': 0.9940807103383775}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=36 head_norm_before_train=1.369545 cos_to_last_merge=0.9307 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.931
[S4] round=36 local utility u=0.043305 metrics={'f1_val': 0.9193343086949128, 'auprc': 0.9799270856961114, 'loss_val': 0.2579390901061171, 'psi': 0.9435714194953922}-{'f1_val': 0.9240233602392105, 'auprc': 0.950946893122286, 'loss_val': 0.2857432980660799, 'psi': 0.9347927733924406}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=36 head_norm_before_train=1.409346 cos_to_last_merge=0.7671 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.767
[S5] round=36 local utility u=0.087829 metrics={'f1_val': 0.700320598491359, 'auprc': 0.8561332023216857, 'loss_val': 0.36045065188887804, 'psi': 0.7626456400234897}-{'f1_val': 0.67705794229925, 'auprc': 0.8538720744002423, 'loss_val': 0.38974882074528766, 'psi': 0.747783595139647}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=36 head_norm_before_train=1.834281 cos_to_last_merge=0.9836 (last merge round=16)
[S6] round=36 local utility u=1.000000 metrics={'f1_val': 0.8267962778479009, 'auprc': 0.9454353375949534, 'loss_val': 0.42887897803829267, 'psi': 0.8742519017467218}-{'f1_val': 0.41588308903900795, 'auprc': 0.6388680885640615, 'loss_val': 2.0047084199216014, 'psi': 0.5050770888490294}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] sending update (kind=head size=1804 to 1 peers)
[S7] START round=36 head_norm_before_train=1.191436 cos_to_last_merge=0.9010 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.901
[S7] round=36 local utility u=0.000000 metrics={'f1_val': 0.5658843404835101, 'auprc': 0.7840066152455558, 'loss_val': 0.7673713811234145, 'psi': 0.6531332503883285}-{'f1_val': 0.6725156064227376, 'auprc': 0.830083563905297, 'loss_val': 0.4267797240716863, 'psi': 0.7355427894157613}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=36 head_norm_before_train=1.740933 cos_to_last_merge=0.9632 (last merge round=15)
[S8] round=36 local utility u=0.000000 metrics={'f1_val': 0.9938366423490096, 'auprc': 0.9856409718310035, 'loss_val': 0.04087116286609655, 'psi': 0.9905583741418071}-{'f1_val': 0.9937185965290795, 'auprc': 0.995766213396115, 'loss_val': 0.040415251625646784, 'psi': 0.9945376432758937}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=36 head_norm_before_train=1.829093 cos_to_last_merge=0.8256 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.826
[S9] round=36 local utility u=0.000000 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9935095755503351, 'loss_val': 0.023387152041364514, 'psi': 0.9951538870877006}-{'f1_val': 0.9951655063899485, 'auprc': 0.9995668041814432, 'loss_val': 0.023939175049789797, 'psi': 0.9969260255065463}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=36 head_norm_before_train=1.643645 cos_to_last_merge=0.9252 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.925
[S10] round=36 local utility u=0.000674 metrics={'f1_val': 0.9940903254969471, 'auprc': 0.9951488496181498, 'loss_val': 0.0386484349478067, 'psi': 0.9945137351454282}-{'f1_val': 0.9947486092193725, 'auprc': 0.9932092823191174, 'loss_val': 0.03812747607565085, 'psi': 0.9941328784592705}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=36 head_norm_before_train=1.709909 cos_to_last_merge=0.9350 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.935
[S11] round=36 local utility u=0.000000 metrics={'f1_val': 0.9548214012780991, 'auprc': 0.9964358570645546, 'loss_val': 0.09419162244060596, 'psi': 0.9714671835926814}-{'f1_val': 0.9961541414107454, 'auprc': 0.9966643539014709, 'loss_val': 0.0525685362964422, 'psi': 0.9963582264070356}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=36 head_norm_before_train=1.570700 cos_to_last_merge=0.9442 (last merge round=11)
[S13] ⚠️ Model drifted since last merge! cos=0.944
[S13] round=36 local utility u=0.000000 metrics={'f1_val': 0.5898887126870909, 'auprc': 0.6860645789074186, 'loss_val': 0.7965512877032517, 'psi': 0.628359059175222}-{'f1_val': 0.6065982943982571, 'auprc': 0.6805214984513593, 'loss_val': 0.7373821748998788, 'psi': 0.636167576019498}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=36 head_norm_before_train=1.735410 cos_to_last_merge=0.9611 (last merge round=16)
[S14] round=36 local utility u=0.000000 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9969711201916637, 'loss_val': 0.025727421070874494, 'psi': 0.9971326621001413}-{'f1_val': 0.9978938390605482, 'auprc': 0.9986678746249257, 'loss_val': 0.02524221805911474, 'psi': 0.9982034532862991}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=36 head_norm_before_train=2.008903 (no previous merge yet)
[S15] round=36 local utility u=0.000000 metrics={'f1_val': 0.896846608050297, 'auprc': 0.9959446673329639, 'loss_val': 0.1996184879436749, 'psi': 0.9364858317633638}-{'f1_val': 0.898412497399726, 'auprc': 0.9939517125587362, 'loss_val': 0.1407730045929771, 'psi': 0.9366281834633301}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=36 head_norm_before_train=1.512188 cos_to_last_merge=0.8623 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.862
[S16] round=36 local utility u=0.276906 metrics={'f1_val': 0.9896141648290095, 'auprc': 0.9824306861478379, 'loss_val': 0.06509524624992746, 'psi': 0.9867407733565409}-{'f1_val': 0.9352412237945494, 'auprc': 0.9869911951647419, 'loss_val': 0.3063517516476928, 'psi': 0.9559412123426264}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S17] START round=36 head_norm_before_train=1.349244 cos_to_last_merge=0.7117 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.712
[S17] round=36 local utility u=0.000000 metrics={'f1_val': 0.3880674993446591, 'auprc': 0.8016836393164999, 'loss_val': 0.8520465319233863, 'psi': 0.5535139553333954}-{'f1_val': 0.3929186431395952, 'auprc': 0.8130940540495941, 'loss_val': 0.7958486470664999, 'psi': 0.5609888075035947}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=37 head_norm_before_train=1.704862 cos_to_last_merge=0.7637 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.764
[S2] round=37 local utility u=0.000000 metrics={'f1_val': 0.6891540223983988, 'auprc': 0.7292228593984666, 'loss_val': 0.9654708059590608, 'psi': 0.7051815571984259}-{'f1_val': 0.7163817679958397, 'auprc': 0.7291311520582612, 'loss_val': 0.9384156531850304, 'psi': 0.7214815216208084}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=37 head_norm_before_train=1.479857 cos_to_last_merge=0.9402 (last merge round=15)
[S3] ⚠️ Model drifted since last merge! cos=0.940
[S3] round=37 local utility u=1.000000 metrics={'f1_val': 0.9953430406044481, 'auprc': 0.9992589762388706, 'loss_val': 0.07833518170558022, 'psi': 0.9969094148582172}-{'f1_val': 0.7254578426789207, 'auprc': 0.8205933034525578, 'loss_val': 0.47481909535300304, 'psi': 0.7635120269883755}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=37 head_norm_before_train=1.380678 cos_to_last_merge=0.9285 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.929
[S4] round=37 local utility u=0.083673 metrics={'f1_val': 0.945830328798253, 'auprc': 0.9774664528292538, 'loss_val': 0.24218781677925733, 'psi': 0.9584847784106534}-{'f1_val': 0.9193343086949128, 'auprc': 0.9799270856961114, 'loss_val': 0.2579390901061171, 'psi': 0.9435714194953922}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=37 head_norm_before_train=1.415156 cos_to_last_merge=0.7676 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.768
[S5] round=37 local utility u=0.281186 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9919497228017025, 'loss_val': 0.20553173505238004, 'psi': 0.8169726795810293}-{'f1_val': 0.700320598491359, 'auprc': 0.8561332023216857, 'loss_val': 0.36045065188887804, 'psi': 0.7626456400234897}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=37 head_norm_before_train=1.836386 cos_to_last_merge=0.9833 (last merge round=16)
[S6] round=37 local utility u=0.563422 metrics={'f1_val': 0.9640665176018319, 'auprc': 0.955199075230615, 'loss_val': 0.1549471380887809, 'psi': 0.9605195406533451}-{'f1_val': 0.8267962778479009, 'auprc': 0.9454353375949534, 'loss_val': 0.42887897803829267, 'psi': 0.8742519017467218}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[S7] START round=37 head_norm_before_train=1.198608 cos_to_last_merge=0.8995 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.900
[S7] round=37 local utility u=1.000000 metrics={'f1_val': 0.723832395486955, 'auprc': 0.9922458649771935, 'loss_val': 0.25054699686192183, 'psi': 0.8311977832830504}-{'f1_val': 0.5658843404835101, 'auprc': 0.7840066152455558, 'loss_val': 0.7673713811234145, 'psi': 0.6531332503883285}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] sending update (kind=head size=1806 to 1 peers)
[S8] START round=37 head_norm_before_train=1.753562 cos_to_last_merge=0.9618 (last merge round=15)
[S8] round=37 local utility u=0.000000 metrics={'f1_val': 0.7567081881366, 'auprc': 0.9986598996958681, 'loss_val': 0.528118449895409, 'psi': 0.8534888727603073}-{'f1_val': 0.9938366423490096, 'auprc': 0.9856409718310035, 'loss_val': 0.04087116286609655, 'psi': 0.9905583741418071}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=37 head_norm_before_train=1.838971 cos_to_last_merge=0.8250 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.825
[S9] round=37 local utility u=0.000000 metrics={'f1_val': 0.9871446711497952, 'auprc': 0.9986543119709598, 'loss_val': 0.05236223282861869, 'psi': 0.991748527478261}-{'f1_val': 0.9962500947792776, 'auprc': 0.9935095755503351, 'loss_val': 0.023387152041364514, 'psi': 0.9951538870877006}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=37 head_norm_before_train=1.658580 cos_to_last_merge=0.9235 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.924
[S10] round=37 local utility u=0.000000 metrics={'f1_val': 0.9937871219080217, 'auprc': 0.9955561012926271, 'loss_val': 0.03861255222183418, 'psi': 0.9944947136618638}-{'f1_val': 0.9940903254969471, 'auprc': 0.9951488496181498, 'loss_val': 0.0386484349478067, 'psi': 0.9945137351454282}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=37 head_norm_before_train=1.723721 cos_to_last_merge=0.9334 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.933
[S11] round=37 local utility u=0.139150 metrics={'f1_val': 0.9959145417079399, 'auprc': 0.9965172186023348, 'loss_val': 0.06269528409943365, 'psi': 0.9961556124656978}-{'f1_val': 0.9548214012780991, 'auprc': 0.9964358570645546, 'loss_val': 0.09419162244060596, 'psi': 0.9714671835926814}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=37 head_norm_before_train=1.580806 cos_to_last_merge=0.9429 (last merge round=11)
[S13] ⚠️ Model drifted since last merge! cos=0.943
[S13] round=37 local utility u=0.206831 metrics={'f1_val': 0.6308555703163188, 'auprc': 0.6593575389488744, 'loss_val': 0.5485697112319003, 'psi': 0.642256357769341}-{'f1_val': 0.5898887126870909, 'auprc': 0.6860645789074186, 'loss_val': 0.7965512877032517, 'psi': 0.628359059175222}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=37 head_norm_before_train=1.749038 cos_to_last_merge=0.9600 (last merge round=16)
[S14] round=37 local utility u=0.000000 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.9932089492477159, 'loss_val': 0.03252833287076061, 'psi': 0.9952359186655365}-{'f1_val': 0.997240356705793, 'auprc': 0.9969711201916637, 'loss_val': 0.025727421070874494, 'psi': 0.9971326621001413}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=37 head_norm_before_train=2.018094 (no previous merge yet)
[S15] round=37 local utility u=0.000000 metrics={'f1_val': 0.7732502762552941, 'auprc': 0.9916687399471231, 'loss_val': 0.348578855116679, 'psi': 0.8606176617320257}-{'f1_val': 0.896846608050297, 'auprc': 0.9959446673329639, 'loss_val': 0.1996184879436749, 'psi': 0.9364858317633638}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=37 head_norm_before_train=1.526931 cos_to_last_merge=0.8605 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.860
[S16] round=37 local utility u=0.000000 metrics={'f1_val': 0.8609780974997958, 'auprc': 0.9882001076349507, 'loss_val': 0.6450747131151829, 'psi': 0.9118669015538579}-{'f1_val': 0.9896141648290095, 'auprc': 0.9824306861478379, 'loss_val': 0.06509524624992746, 'psi': 0.9867407733565409}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=37 head_norm_before_train=1.370246 cos_to_last_merge=0.7093 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.709
[S17] round=37 local utility u=0.000000 metrics={'f1_val': 0.3931059116441985, 'auprc': 0.7861818756691462, 'loss_val': 0.8414765474621645, 'psi': 0.5503362972541777}-{'f1_val': 0.3880674993446591, 'auprc': 0.8016836393164999, 'loss_val': 0.8520465319233863, 'psi': 0.5535139553333954}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=38 head_norm_before_train=1.716315 cos_to_last_merge=0.7630 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.763
[S2] round=38 local utility u=0.086459 metrics={'f1_val': 0.7160061327106417, 'auprc': 0.7304323342629686, 'loss_val': 0.9572937419981044, 'psi': 0.7217766133315724}-{'f1_val': 0.6891540223983988, 'auprc': 0.7292228593984666, 'loss_val': 0.9654708059590608, 'psi': 0.7051815571984259}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=38 head_norm_before_train=1.491160 cos_to_last_merge=0.9387 (last merge round=15)
[S3] ⚠️ Model drifted since last merge! cos=0.939
[S3] round=38 local utility u=0.000000 metrics={'f1_val': 0.7837206353923556, 'auprc': 0.8394501347297365, 'loss_val': 0.3747183778576417, 'psi': 0.8060124351273079}-{'f1_val': 0.9953430406044481, 'auprc': 0.9992589762388706, 'loss_val': 0.07833518170558022, 'psi': 0.9969094148582172}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=38 head_norm_before_train=1.389593 cos_to_last_merge=0.9265 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.927
[S4] round=38 local utility u=0.015878 metrics={'f1_val': 0.9482351773781763, 'auprc': 0.9829731827584125, 'loss_val': 0.24138158013977856, 'psi': 0.9621303795302708}-{'f1_val': 0.945830328798253, 'auprc': 0.9774664528292538, 'loss_val': 0.24218781677925733, 'psi': 0.9584847784106534}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] sending update (kind=head size=1794 to 1 peers)
[S5] START round=38 head_norm_before_train=1.423292 cos_to_last_merge=0.7668 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.767
[S5] round=38 local utility u=0.000000 metrics={'f1_val': 0.42984235621534, 'auprc': 0.8551308231771901, 'loss_val': 1.007444649080519, 'psi': 0.5999577430000801}-{'f1_val': 0.7003213174339138, 'auprc': 0.9919497228017025, 'loss_val': 0.20553173505238004, 'psi': 0.8169726795810293}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=38 head_norm_before_train=1.840386 cos_to_last_merge=0.9832 (last merge round=16)
[S6] round=38 local utility u=0.000000 metrics={'f1_val': 0.6247172665801676, 'auprc': 0.9210051157677429, 'loss_val': 0.8216753530289168, 'psi': 0.7432324062551977}-{'f1_val': 0.9640665176018319, 'auprc': 0.955199075230615, 'loss_val': 0.1549471380887809, 'psi': 0.9605195406533451}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=38 head_norm_before_train=1.209081 cos_to_last_merge=0.8976 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.898
[S7] round=38 local utility u=0.000000 metrics={'f1_val': 0.4388665709000593, 'auprc': 0.7776048222635189, 'loss_val': 1.0268488133404774, 'psi': 0.5743618714454433}-{'f1_val': 0.723832395486955, 'auprc': 0.9922458649771935, 'loss_val': 0.25054699686192183, 'psi': 0.8311977832830504}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=38 head_norm_before_train=1.765881 cos_to_last_merge=0.9607 (last merge round=15)
[S8] round=38 local utility u=0.091234 metrics={'f1_val': 0.7419020398223752, 'auprc': 0.9844822540788921, 'loss_val': 0.21427991967331314, 'psi': 0.838934125524982}-{'f1_val': 0.7567081881366, 'auprc': 0.9986598996958681, 'loss_val': 0.528118449895409, 'psi': 0.8534888727603073}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=38 head_norm_before_train=1.848143 cos_to_last_merge=0.8246 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.825
[S9] round=38 local utility u=0.041686 metrics={'f1_val': 0.9959957888192151, 'auprc': 0.9988102737051625, 'loss_val': 0.02256451296973607, 'psi': 0.997121582773594}-{'f1_val': 0.9871446711497952, 'auprc': 0.9986543119709598, 'loss_val': 0.05236223282861869, 'psi': 0.991748527478261}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=38 head_norm_before_train=1.671996 cos_to_last_merge=0.9220 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.922
[S10] round=38 local utility u=0.000346 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9934091802654517, 'loss_val': 0.035932384657406356, 'psi': 0.9940811361852173}-{'f1_val': 0.9937871219080217, 'auprc': 0.9955561012926271, 'loss_val': 0.03861255222183418, 'psi': 0.9944947136618638}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=38 head_norm_before_train=1.736575 cos_to_last_merge=0.9319 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.932
[S11] round=38 local utility u=0.000000 metrics={'f1_val': 0.8525991644664732, 'auprc': 0.9957440455506743, 'loss_val': 0.19248080584362812, 'psi': 0.9098571169001537}-{'f1_val': 0.9959145417079399, 'auprc': 0.9965172186023348, 'loss_val': 0.06269528409943365, 'psi': 0.9961556124656978}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=38 head_norm_before_train=1.589223 cos_to_last_merge=0.9417 (last merge round=11)
[S13] ⚠️ Model drifted since last merge! cos=0.942
[S13] round=38 local utility u=0.000000 metrics={'f1_val': 0.573240061248309, 'auprc': 0.6923162535667974, 'loss_val': 0.929022580700281, 'psi': 0.6208705381757044}-{'f1_val': 0.6308555703163188, 'auprc': 0.6593575389488744, 'loss_val': 0.5485697112319003, 'psi': 0.642256357769341}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=38 head_norm_before_train=1.762754 cos_to_last_merge=0.9590 (last merge round=16)
[S14] round=38 local utility u=0.011052 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9969696267038188, 'loss_val': 0.024167331078169582, 'psi': 0.9969863555761266}-{'f1_val': 0.9965872316107504, 'auprc': 0.9932089492477159, 'loss_val': 0.03252833287076061, 'psi': 0.9952359186655365}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] sending update (kind=head size=1804 to 1 peers)
[S15] START round=38 head_norm_before_train=2.029791 (no previous merge yet)
[S15] round=38 local utility u=0.825634 metrics={'f1_val': 0.996248502210966, 'auprc': 0.9923909167185893, 'loss_val': 0.03746584302666398, 'psi': 0.9947054680140153}-{'f1_val': 0.7732502762552941, 'auprc': 0.9916687399471231, 'loss_val': 0.348578855116679, 'psi': 0.8606176617320257}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=38 head_norm_before_train=1.541130 cos_to_last_merge=0.8586 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.859
[S16] round=38 local utility u=0.478135 metrics={'f1_val': 0.9438136785462292, 'auprc': 0.9884379936776638, 'loss_val': 0.18653183052698924, 'psi': 0.9616634045988031}-{'f1_val': 0.8609780974997958, 'auprc': 0.9882001076349507, 'loss_val': 0.6450747131151829, 'psi': 0.9118669015538579}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=38 head_norm_before_train=1.392358 cos_to_last_merge=0.7073 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.707
[S17] round=38 local utility u=0.001858 metrics={'f1_val': 0.3908673141174741, 'auprc': 0.7977475840249817, 'loss_val': 0.8590263566668596, 'psi': 0.5536194220804771}-{'f1_val': 0.3931059116441985, 'auprc': 0.7861818756691462, 'loss_val': 0.8414765474621645, 'psi': 0.5503362972541777}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] START round=39 head_norm_before_train=1.729801 cos_to_last_merge=0.7623 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.762
[S2] round=39 local utility u=0.000000 metrics={'f1_val': 0.703897207764125, 'auprc': 0.7280096836252565, 'loss_val': 0.961200423904304, 'psi': 0.7135421981085777}-{'f1_val': 0.7160061327106417, 'auprc': 0.7304323342629686, 'loss_val': 0.9572937419981044, 'psi': 0.7217766133315724}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=40 psi=0.714 u=0.0000 p_local=0.0227 f1=0.704 auprc=0.728 bytes=39560
[S3] START round=39 head_norm_before_train=1.503474 cos_to_last_merge=0.9368 (last merge round=15)
[S3] ⚠️ Model drifted since last merge! cos=0.937
[S3] round=39 local utility u=0.063222 metrics={'f1_val': 0.7893664710346568, 'auprc': 0.8629593055867649, 'loss_val': 0.3526770395414402, 'psi': 0.8188036048555001}-{'f1_val': 0.7837206353923556, 'auprc': 0.8394501347297365, 'loss_val': 0.3747183778576417, 'psi': 0.8060124351273079}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S3] r=40 psi=0.819 u=0.0632 p_local=0.3071 f1=0.789 auprc=0.863 bytes=43105
[S4] START round=39 head_norm_before_train=1.399440 cos_to_last_merge=0.9243 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.924
[S4] round=39 local utility u=0.001431 metrics={'f1_val': 0.9482382092151791, 'auprc': 0.9830901070202546, 'loss_val': 0.2388881605230236, 'psi': 0.9621789683372093}-{'f1_val': 0.9482351773781763, 'auprc': 0.9829731827584125, 'loss_val': 0.24138158013977856, 'psi': 0.9621303795302708}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S4] r=40 psi=0.962 u=0.0014 p_local=0.0310 f1=0.948 auprc=0.983 bytes=57498
[S5] START round=39 head_norm_before_train=1.429831 cos_to_last_merge=0.7668 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.767
[S5] round=39 local utility u=1.000000 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9920035565825744, 'loss_val': 0.2026044988977792, 'psi': 0.816994213093378}-{'f1_val': 0.42984235621534, 'auprc': 0.8551308231771901, 'loss_val': 1.007444649080519, 'psi': 0.5999577430000801}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S5] r=40 psi=0.817 u=1.0000 p_local=0.3467 f1=0.700 auprc=0.992 bytes=48573
[S6] START round=39 head_norm_before_train=1.844911 cos_to_last_merge=0.9826 (last merge round=16)
[S6] round=39 local utility u=0.567037 metrics={'f1_val': 0.7764551464279605, 'auprc': 0.9145578712177475, 'loss_val': 0.5786874163415405, 'psi': 0.8316962363438754}-{'f1_val': 0.6247172665801676, 'auprc': 0.9210051157677429, 'loss_val': 0.8216753530289168, 'psi': 0.7432324062551977}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S6] r=40 psi=0.832 u=0.5670 p_local=0.4236 f1=0.776 auprc=0.915 bytes=37774
[S7] START round=39 head_norm_before_train=1.214967 cos_to_last_merge=0.8961 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.896
[S7] round=39 local utility u=0.922052 metrics={'f1_val': 0.6443311100423919, 'auprc': 0.8074818435027824, 'loss_val': 0.50516244221834, 'psi': 0.709591403426548}-{'f1_val': 0.4388665709000593, 'auprc': 0.7776048222635189, 'loss_val': 1.0268488133404774, 'psi': 0.5743618714454433}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] sending update (kind=head size=1806 to 1 peers)
[S7] r=40 psi=0.710 u=0.9221 p_local=0.4552 f1=0.644 auprc=0.807 bytes=41388
[S8] START round=39 head_norm_before_train=1.775008 cos_to_last_merge=0.9600 (last merge round=15)
[S8] round=39 local utility u=0.855288 metrics={'f1_val': 0.9911508091644092, 'auprc': 0.9985432550337754, 'loss_val': 0.04138032531139269, 'psi': 0.9941077875121558}-{'f1_val': 0.7419020398223752, 'auprc': 0.9844822540788921, 'loss_val': 0.21427991967331314, 'psi': 0.838934125524982}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S8] r=40 psi=0.994 u=0.8553 p_local=0.2138 f1=0.991 auprc=0.999 bytes=50375
[S9] START round=39 head_norm_before_train=1.854541 cos_to_last_merge=0.8242 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.824
[S9] round=39 local utility u=0.001512 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9984252424936955, 'loss_val': 0.022374720401784846, 'psi': 0.997366404085813}-{'f1_val': 0.9959957888192151, 'auprc': 0.9988102737051625, 'loss_val': 0.02256451296973607, 'psi': 0.997121582773594}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] sending update (kind=head size=1793 to 1 peers)
[S9] r=40 psi=0.997 u=0.0015 p_local=0.0118 f1=0.997 auprc=0.998 bytes=48516
[S10] START round=39 head_norm_before_train=1.684850 cos_to_last_merge=0.9206 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.921
[S10] round=39 local utility u=0.000000 metrics={'f1_val': 0.9933489306849028, 'auprc': 0.99613590706221, 'loss_val': 0.03922032278416382, 'psi': 0.9944637212358257}-{'f1_val': 0.9945291067983943, 'auprc': 0.9934091802654517, 'loss_val': 0.035932384657406356, 'psi': 0.9940811361852173}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] r=40 psi=0.994 u=0.0000 p_local=0.0036 f1=0.993 auprc=0.996 bytes=55728
[S11] START round=39 head_norm_before_train=1.749156 cos_to_last_merge=0.9305 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.931
[S11] round=39 local utility u=0.501469 metrics={'f1_val': 0.9966374415637795, 'auprc': 0.9965422998311574, 'loss_val': 0.05616684534563225, 'psi': 0.9965993848707306}-{'f1_val': 0.8525991644664732, 'auprc': 0.9957440455506743, 'loss_val': 0.19248080584362812, 'psi': 0.9098571169001537}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S11] r=40 psi=0.997 u=0.5015 p_local=0.1369 f1=0.997 auprc=0.997 bytes=44991
[S13] START round=39 head_norm_before_train=1.597062 cos_to_last_merge=0.9406 (last merge round=11)
[S13] ⚠️ Model drifted since last merge! cos=0.941
[S13] round=39 local utility u=0.089456 metrics={'f1_val': 0.5912865245755641, 'auprc': 0.6753802602164724, 'loss_val': 0.8075819151230836, 'psi': 0.6249240188319274}-{'f1_val': 0.573240061248309, 'auprc': 0.6923162535667974, 'loss_val': 0.929022580700281, 'psi': 0.6208705381757044}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S13] r=40 psi=0.625 u=0.0895 p_local=0.0632 f1=0.591 auprc=0.675 bytes=41353
[S14] START round=39 head_norm_before_train=1.777261 cos_to_last_merge=0.9578 (last merge round=16)
[S14] round=39 local utility u=0.000000 metrics={'f1_val': 0.9370821931164188, 'auprc': 0.9957185222367565, 'loss_val': 0.11720722462807041, 'psi': 0.9605367247645539}-{'f1_val': 0.9969975081576651, 'auprc': 0.9969696267038188, 'loss_val': 0.024167331078169582, 'psi': 0.9969863555761266}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=40 psi=0.961 u=0.0000 p_local=0.0045 f1=0.937 auprc=0.996 bytes=45023
[S15] START round=39 head_norm_before_train=2.040773 (no previous merge yet)
[S15] round=39 local utility u=0.000000 metrics={'f1_val': 0.8998488334912587, 'auprc': 0.9927415349230202, 'loss_val': 0.16505051383729535, 'psi': 0.9370059140639633}-{'f1_val': 0.996248502210966, 'auprc': 0.9923909167185893, 'loss_val': 0.03746584302666398, 'psi': 0.9947054680140153}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] r=40 psi=0.937 u=0.0000 p_local=0.2517 f1=0.900 auprc=0.993 bytes=39602
[S16] START round=39 head_norm_before_train=1.551855 cos_to_last_merge=0.8568 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.857
[S16] round=39 local utility u=0.000000 metrics={'f1_val': 0.8765700175267426, 'auprc': 0.98290930305502, 'loss_val': 0.38223743764389895, 'psi': 0.9191057317380535}-{'f1_val': 0.9438136785462292, 'auprc': 0.9884379936776638, 'loss_val': 0.18653183052698924, 'psi': 0.9616634045988031}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] r=40 psi=0.919 u=0.0000 p_local=0.1593 f1=0.877 auprc=0.983 bytes=35942
[S17] START round=39 head_norm_before_train=1.417422 cos_to_last_merge=0.7056 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.706
[S17] round=39 local utility u=0.714483 metrics={'f1_val': 0.6118953439341228, 'auprc': 0.8143328730891024, 'loss_val': 0.8059846288671811, 'psi': 0.6928703555961147}-{'f1_val': 0.3908673141174741, 'auprc': 0.7977475840249817, 'loss_val': 0.8590263566668596, 'psi': 0.5536194220804771}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S17] r=40 psi=0.693 u=0.7145 p_local=0.1633 f1=0.612 auprc=0.814 bytes=41222
[S2] START round=40 head_norm_before_train=1.742944 cos_to_last_merge=0.7615 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.762
[S2] round=40 local utility u=0.040560 metrics={'f1_val': 0.7173856379529664, 'auprc': 0.7307856235107123, 'loss_val': 0.9693382005368046, 'psi': 0.7227456321760648}-{'f1_val': 0.703897207764125, 'auprc': 0.7280096836252565, 'loss_val': 0.961200423904304, 'psi': 0.7135421981085777}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[S3] START round=40 head_norm_before_train=1.516779 cos_to_last_merge=0.9346 (last merge round=15)
[S3] ⚠️ Model drifted since last merge! cos=0.935
[S3] round=40 local utility u=0.618583 metrics={'f1_val': 0.9043842323778517, 'auprc': 0.9806070300463056, 'loss_val': 0.15856142747219557, 'psi': 0.9348733514452332}-{'f1_val': 0.7893664710346568, 'auprc': 0.8629593055867649, 'loss_val': 0.3526770395414402, 'psi': 0.8188036048555001}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=40 head_norm_before_train=1.411559 cos_to_last_merge=0.9225 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.922
[S4] round=40 local utility u=0.023082 metrics={'f1_val': 0.9543953113714068, 'auprc': 0.9848609137410209, 'loss_val': 0.23497822681744163, 'psi': 0.9665815523192525}-{'f1_val': 0.9482382092151791, 'auprc': 0.9830901070202546, 'loss_val': 0.2388881605230236, 'psi': 0.9621789683372093}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=40 head_norm_before_train=1.434362 cos_to_last_merge=0.7667 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.767
[S5] round=40 local utility u=0.000000 metrics={'f1_val': 0.44019707663735874, 'auprc': 0.8530937815457758, 'loss_val': 0.786086786348083, 'psi': 0.6053557586007255}-{'f1_val': 0.7003213174339138, 'auprc': 0.9920035565825744, 'loss_val': 0.2026044988977792, 'psi': 0.816994213093378}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=40 head_norm_before_train=1.852811 cos_to_last_merge=0.9819 (last merge round=16)
[S6] round=40 local utility u=0.449555 metrics={'f1_val': 0.866209169956436, 'auprc': 0.9571023276292121, 'loss_val': 0.34573536705801355, 'psi': 0.9025664330255465}-{'f1_val': 0.7764551464279605, 'auprc': 0.9145578712177475, 'loss_val': 0.5786874163415405, 'psi': 0.8316962363438754}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[S7] START round=40 head_norm_before_train=1.220087 cos_to_last_merge=0.8948 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.895
[S7] round=40 local utility u=0.000000 metrics={'f1_val': 0.6355770986081705, 'auprc': 0.7966358664265328, 'loss_val': 0.5587251411898667, 'psi': 0.7000006057355155}-{'f1_val': 0.6443311100423919, 'auprc': 0.8074818435027824, 'loss_val': 0.50516244221834, 'psi': 0.709591403426548}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=40 head_norm_before_train=1.782885 cos_to_last_merge=0.9591 (last merge round=15)
[S8] round=40 local utility u=0.004974 metrics={'f1_val': 0.9922296351413602, 'auprc': 0.9983730536070148, 'loss_val': 0.03739529793451674, 'psi': 0.994687002527622}-{'f1_val': 0.9911508091644092, 'auprc': 0.9985432550337754, 'loss_val': 0.04138032531139269, 'psi': 0.9941077875121558}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] sending update (kind=head size=1795 to 1 peers)
[S9] START round=40 head_norm_before_train=1.860629 cos_to_last_merge=0.8240 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.824
[S9] round=40 local utility u=0.000000 metrics={'f1_val': 0.9905518720143266, 'auprc': 0.9984443037373876, 'loss_val': 0.03323671047654559, 'psi': 0.9937088447035509}-{'f1_val': 0.9966605118138915, 'auprc': 0.9984252424936955, 'loss_val': 0.022374720401784846, 'psi': 0.997366404085813}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=40 head_norm_before_train=1.697580 cos_to_last_merge=0.9192 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.919
[S10] round=40 local utility u=0.000523 metrics={'f1_val': 0.9940903254969471, 'auprc': 0.9938337923700393, 'loss_val': 0.0357153734112341, 'psi': 0.993987712246184}-{'f1_val': 0.9933489306849028, 'auprc': 0.99613590706221, 'loss_val': 0.03922032278416382, 'psi': 0.9944637212358257}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=40 head_norm_before_train=1.762578 cos_to_last_merge=0.9290 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.929
[S11] round=40 local utility u=0.000000 metrics={'f1_val': 0.8523894063833246, 'auprc': 0.9958385931357667, 'loss_val': 0.19103366981359277, 'psi': 0.9097690810843015}-{'f1_val': 0.9966374415637795, 'auprc': 0.9965422998311574, 'loss_val': 0.05616684534563225, 'psi': 0.9965993848707306}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=40 head_norm_before_train=1.601366 cos_to_last_merge=0.9401 (last merge round=11)
[S13] ⚠️ Model drifted since last merge! cos=0.940
[S13] round=40 local utility u=0.093747 metrics={'f1_val': 0.6129695373942777, 'auprc': 0.6658723839127535, 'loss_val': 0.721661448691625, 'psi': 0.6341306760016681}-{'f1_val': 0.5912865245755641, 'auprc': 0.6753802602164724, 'loss_val': 0.8075819151230836, 'psi': 0.6249240188319274}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=40 head_norm_before_train=1.785777 cos_to_last_merge=0.9567 (last merge round=16)
[S14] round=40 local utility u=0.235267 metrics={'f1_val': 0.9978938390605482, 'auprc': 0.9986675333534928, 'loss_val': 0.020390554725641993, 'psi': 0.998203316777726}-{'f1_val': 0.9370821931164188, 'auprc': 0.9957185222367565, 'loss_val': 0.11720722462807041, 'psi': 0.9605367247645539}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] sending update (kind=head size=1804 to 1 peers)
[S15] START round=40 head_norm_before_train=2.054905 (no previous merge yet)
[S15] round=40 local utility u=0.000000 metrics={'f1_val': 0.8230301527075501, 'auprc': 0.9897377601387876, 'loss_val': 0.2506478974528796, 'psi': 0.889713195680045}-{'f1_val': 0.8998488334912587, 'auprc': 0.9927415349230202, 'loss_val': 0.16505051383729535, 'psi': 0.9370059140639633}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=40 head_norm_before_train=1.562190 cos_to_last_merge=0.8554 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.855
[S16] round=40 local utility u=0.317157 metrics={'f1_val': 0.9465442499515996, 'auprc': 0.9860315620671678, 'loss_val': 0.17713474326546244, 'psi': 0.9623391747978268}-{'f1_val': 0.8765700175267426, 'auprc': 0.98290930305502, 'loss_val': 0.38223743764389895, 'psi': 0.9191057317380535}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=40 head_norm_before_train=1.447276 cos_to_last_merge=0.7037 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.704
[S17] round=40 local utility u=0.000000 metrics={'f1_val': 0.61171576112564, 'auprc': 0.8113516339111504, 'loss_val': 0.8787584760734317, 'psi': 0.6915701102398442}-{'f1_val': 0.6118953439341228, 'auprc': 0.8143328730891024, 'loss_val': 0.8059846288671811, 'psi': 0.6928703555961147}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=41 head_norm_before_train=1.753434 cos_to_last_merge=0.7609 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.761
[S2] round=41 local utility u=0.000000 metrics={'f1_val': 0.7171687892326438, 'auprc': 0.7290685807864328, 'loss_val': 0.9781232989187916, 'psi': 0.7219287058541595}-{'f1_val': 0.7173856379529664, 'auprc': 0.7307856235107123, 'loss_val': 0.9693382005368046, 'psi': 0.7227456321760648}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=41 head_norm_before_train=1.530860 cos_to_last_merge=0.9325 (last merge round=15)
[S3] ⚠️ Model drifted since last merge! cos=0.932
[S3] round=41 local utility u=0.000000 metrics={'f1_val': 0.6625415984567924, 'auprc': 0.8188833281092993, 'loss_val': 0.6189384590153358, 'psi': 0.7250782903177952}-{'f1_val': 0.9043842323778517, 'auprc': 0.9806070300463056, 'loss_val': 0.15856142747219557, 'psi': 0.9348733514452332}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=41 head_norm_before_train=1.420825 cos_to_last_merge=0.9211 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.921
[S4] round=41 local utility u=0.000000 metrics={'f1_val': 0.9478398097021327, 'auprc': 0.9795162014783849, 'loss_val': 0.23719166871613584, 'psi': 0.9605103664126335}-{'f1_val': 0.9543953113714068, 'auprc': 0.9848609137410209, 'loss_val': 0.23497822681744163, 'psi': 0.9665815523192525}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=41 head_norm_before_train=1.440330 cos_to_last_merge=0.7666 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.767
[S5] round=41 local utility u=1.000000 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9919693823614897, 'loss_val': 0.2023680539759789, 'psi': 0.8169805434049442}-{'f1_val': 0.44019707663735874, 'auprc': 0.8530937815457758, 'loss_val': 0.786086786348083, 'psi': 0.6053557586007255}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] START round=41 head_norm_before_train=1.865418 cos_to_last_merge=0.9811 (last merge round=16)
[S6] round=41 local utility u=0.000000 metrics={'f1_val': 0.6000339478256306, 'auprc': 0.810444208816725, 'loss_val': 0.9706061121943016, 'psi': 0.6841980522220683}-{'f1_val': 0.866209169956436, 'auprc': 0.9571023276292121, 'loss_val': 0.34573536705801355, 'psi': 0.9025664330255465}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=41 head_norm_before_train=1.228601 cos_to_last_merge=0.8928 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.893
[S7] round=41 local utility u=0.000000 metrics={'f1_val': 0.6238028653413404, 'auprc': 0.7964951547991982, 'loss_val': 0.5919066358650941, 'psi': 0.6928797811244836}-{'f1_val': 0.6355770986081705, 'auprc': 0.7966358664265328, 'loss_val': 0.5587251411898667, 'psi': 0.7000006057355155}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=41 head_norm_before_train=1.790138 cos_to_last_merge=0.9578 (last merge round=15)
[S8] round=41 local utility u=0.000000 metrics={'f1_val': 0.9761368354100979, 'auprc': 0.9879073493171306, 'loss_val': 0.08315673363554081, 'psi': 0.980845040972911}-{'f1_val': 0.9922296351413602, 'auprc': 0.9983730536070148, 'loss_val': 0.03739529793451674, 'psi': 0.994687002527622}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=41 head_norm_before_train=1.868335 cos_to_last_merge=0.8236 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.824
[S9] round=41 local utility u=0.024809 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9987997293707175, 'loss_val': 0.021337744753617854, 'psi': 0.9975161988366219}-{'f1_val': 0.9905518720143266, 'auprc': 0.9984443037373876, 'loss_val': 0.03323671047654559, 'psi': 0.9937088447035509}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=41 head_norm_before_train=1.706883 cos_to_last_merge=0.9180 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.918
[S10] round=41 local utility u=0.000093 metrics={'f1_val': 0.9940903254969471, 'auprc': 0.9937382134417554, 'loss_val': 0.035241805453819594, 'psi': 0.9939494806748704}-{'f1_val': 0.9940903254969471, 'auprc': 0.9938337923700393, 'loss_val': 0.0357153734112341, 'psi': 0.993987712246184}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=41 head_norm_before_train=1.774979 cos_to_last_merge=0.9276 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.928
[S11] round=41 local utility u=0.000000 metrics={'f1_val': 0.8356410618533908, 'auprc': 0.9957338209785591, 'loss_val': 0.23781956158844372, 'psi': 0.8996781655034582}-{'f1_val': 0.8523894063833246, 'auprc': 0.9958385931357667, 'loss_val': 0.19103366981359277, 'psi': 0.9097690810843015}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=41 head_norm_before_train=1.603465 cos_to_last_merge=0.9399 (last merge round=11)
[S13] ⚠️ Model drifted since last merge! cos=0.940
[S13] round=41 local utility u=0.000000 metrics={'f1_val': 0.5771733310195795, 'auprc': 0.6891340587893693, 'loss_val': 0.8759039776555901, 'psi': 0.6219576221274954}-{'f1_val': 0.6129695373942777, 'auprc': 0.6658723839127535, 'loss_val': 0.721661448691625, 'psi': 0.6341306760016681}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=41 head_norm_before_train=1.792312 cos_to_last_merge=0.9557 (last merge round=16)
[S14] round=41 local utility u=0.000000 metrics={'f1_val': 0.9970233560109115, 'auprc': 0.9943049722119324, 'loss_val': 0.024242602360736148, 'psi': 0.9959360024913199}-{'f1_val': 0.9978938390605482, 'auprc': 0.9986675333534928, 'loss_val': 0.020390554725641993, 'psi': 0.998203316777726}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=41 head_norm_before_train=2.068874 (no previous merge yet)
[S15] round=41 local utility u=0.634756 metrics={'f1_val': 0.9938142430606698, 'auprc': 0.9984789038730597, 'loss_val': 0.03206382063512752, 'psi': 0.9956801073856258}-{'f1_val': 0.8230301527075501, 'auprc': 0.9897377601387876, 'loss_val': 0.2506478974528796, 'psi': 0.889713195680045}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=41 head_norm_before_train=1.572926 cos_to_last_merge=0.8541 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.854
[S16] round=41 local utility u=0.000000 metrics={'f1_val': 0.9317084584860622, 'auprc': 0.9856653190298121, 'loss_val': 0.3516702650259969, 'psi': 0.9532912027035623}-{'f1_val': 0.9465442499515996, 'auprc': 0.9860315620671678, 'loss_val': 0.17713474326546244, 'psi': 0.9623391747978268}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=41 head_norm_before_train=1.477288 cos_to_last_merge=0.7017 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.702
[S17] round=41 local utility u=0.074975 metrics={'f1_val': 0.5979518056163243, 'auprc': 0.8382954436575915, 'loss_val': 0.7270560046449284, 'psi': 0.6940892608328312}-{'f1_val': 0.61171576112564, 'auprc': 0.8113516339111504, 'loss_val': 0.8787584760734317, 'psi': 0.6915701102398442}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=42 head_norm_before_train=1.763384 cos_to_last_merge=0.7603 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.760
[S2] round=42 local utility u=0.000000 metrics={'f1_val': 0.7178337483972587, 'auprc': 0.7290857247007415, 'loss_val': 0.9854559783919218, 'psi': 0.7223345389186517}-{'f1_val': 0.7171687892326438, 'auprc': 0.7290685807864328, 'loss_val': 0.9781232989187916, 'psi': 0.7219287058541595}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=42 head_norm_before_train=1.543048 cos_to_last_merge=0.9305 (last merge round=15)
[S3] ⚠️ Model drifted since last merge! cos=0.930
[S3] round=42 local utility u=0.760503 metrics={'f1_val': 0.7961522206190101, 'auprc': 0.9620217306525802, 'loss_val': 0.32901080882779576, 'psi': 0.8625000246324381}-{'f1_val': 0.6625415984567924, 'auprc': 0.8188833281092993, 'loss_val': 0.6189384590153358, 'psi': 0.7250782903177952}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=42 head_norm_before_train=1.430271 cos_to_last_merge=0.9199 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.920
[S4] round=42 local utility u=0.000000 metrics={'f1_val': 0.9304522990027091, 'auprc': 0.9817780881794964, 'loss_val': 0.25469163128270567, 'psi': 0.9509826146734239}-{'f1_val': 0.9478398097021327, 'auprc': 0.9795162014783849, 'loss_val': 0.23719166871613584, 'psi': 0.9605103664126335}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=42 head_norm_before_train=1.443704 cos_to_last_merge=0.7663 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.766
[S5] round=42 local utility u=0.000000 metrics={'f1_val': 0.43281363104298043, 'auprc': 0.8539558686965792, 'loss_val': 0.8681334015359167, 'psi': 0.60127052610442}-{'f1_val': 0.7003213174339138, 'auprc': 0.9919693823614897, 'loss_val': 0.2023680539759789, 'psi': 0.8169805434049442}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=42 head_norm_before_train=1.874687 cos_to_last_merge=0.9801 (last merge round=16)
[S6] round=42 local utility u=1.000000 metrics={'f1_val': 0.8480110298675043, 'auprc': 0.9051672055652815, 'loss_val': 0.39796022034719486, 'psi': 0.8708735001466151}-{'f1_val': 0.6000339478256306, 'auprc': 0.810444208816725, 'loss_val': 0.9706061121943016, 'psi': 0.6841980522220683}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] sending update (kind=head size=1795 to 1 peers)
[S7] START round=42 head_norm_before_train=1.238514 cos_to_last_merge=0.8908 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.891
[S7] round=42 local utility u=0.000000 metrics={'f1_val': 0.47107159780719743, 'auprc': 0.777278542894076, 'loss_val': 0.920275074037789, 'psi': 0.5935543758419488}-{'f1_val': 0.6238028653413404, 'auprc': 0.7964951547991982, 'loss_val': 0.5919066358650941, 'psi': 0.6928797811244836}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=42 head_norm_before_train=1.798397 cos_to_last_merge=0.9567 (last merge round=15)
[S8] round=42 local utility u=0.061977 metrics={'f1_val': 0.9857804966617716, 'auprc': 0.9986422652367588, 'loss_val': 0.049270378069310894, 'psi': 0.9909252040917664}-{'f1_val': 0.9761368354100979, 'auprc': 0.9879073493171306, 'loss_val': 0.08315673363554081, 'psi': 0.980845040972911}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=42 head_norm_before_train=1.875790 cos_to_last_merge=0.8231 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.823
[S9] round=42 local utility u=0.000000 metrics={'f1_val': 0.9951655063899485, 'auprc': 0.9984284396773208, 'loss_val': 0.023087425855155157, 'psi': 0.9964706797048973}-{'f1_val': 0.9966605118138915, 'auprc': 0.9987997293707175, 'loss_val': 0.021337744753617854, 'psi': 0.9975161988366219}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=42 head_norm_before_train=1.717238 cos_to_last_merge=0.9168 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.917
[S10] round=42 local utility u=0.000000 metrics={'f1_val': 0.9934769336626772, 'auprc': 0.9963351979367271, 'loss_val': 0.04444550401874918, 'psi': 0.9946202393722972}-{'f1_val': 0.9940903254969471, 'auprc': 0.9937382134417554, 'loss_val': 0.035241805453819594, 'psi': 0.9939494806748704}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=42 head_norm_before_train=1.785551 cos_to_last_merge=0.9265 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.926
[S11] round=42 local utility u=0.589516 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9966996055185715, 'loss_val': 0.024763254111410754, 'psi': 0.9963723270538758}-{'f1_val': 0.8356410618533908, 'auprc': 0.9957338209785591, 'loss_val': 0.23781956158844372, 'psi': 0.8996781655034582}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=42 head_norm_before_train=1.609172 cos_to_last_merge=0.9391 (last merge round=11)
[S13] ⚠️ Model drifted since last merge! cos=0.939
[S13] round=42 local utility u=0.000000 metrics={'f1_val': 0.5657027669714583, 'auprc': 0.6747749739264483, 'loss_val': 0.8262267278099686, 'psi': 0.6093316497534542}-{'f1_val': 0.5771733310195795, 'auprc': 0.6891340587893693, 'loss_val': 0.8759039776555901, 'psi': 0.6219576221274954}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=42 head_norm_before_train=1.797717 cos_to_last_merge=0.9548 (last merge round=16)
[S14] round=42 local utility u=0.000000 metrics={'f1_val': 0.9970007132142444, 'auprc': 0.9905491679818876, 'loss_val': 0.030995601112625847, 'psi': 0.9944200951213018}-{'f1_val': 0.9970233560109115, 'auprc': 0.9943049722119324, 'loss_val': 0.024242602360736148, 'psi': 0.9959360024913199}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=42 head_norm_before_train=2.079432 (no previous merge yet)
[S15] round=42 local utility u=0.000000 metrics={'f1_val': 0.7647344162590421, 'auprc': 0.9844412292965583, 'loss_val': 0.40276733980675633, 'psi': 0.8526171414740487}-{'f1_val': 0.9938142430606698, 'auprc': 0.9984789038730597, 'loss_val': 0.03206382063512752, 'psi': 0.9956801073856258}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=42 head_norm_before_train=1.584261 cos_to_last_merge=0.8526 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.853
[S16] round=42 local utility u=0.328707 metrics={'f1_val': 0.9895618889012239, 'auprc': 0.9906954397542498, 'loss_val': 0.05646630420348419, 'psi': 0.9900153092424342}-{'f1_val': 0.9317084584860622, 'auprc': 0.9856653190298121, 'loss_val': 0.3516702650259969, 'psi': 0.9532912027035623}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S17] START round=42 head_norm_before_train=1.504683 cos_to_last_merge=0.7001 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.700
[S17] round=42 local utility u=0.000000 metrics={'f1_val': 0.6057599332367002, 'auprc': 0.8057210991346478, 'loss_val': 1.0081929050032836, 'psi': 0.6857443995958793}-{'f1_val': 0.5979518056163243, 'auprc': 0.8382954436575915, 'loss_val': 0.7270560046449284, 'psi': 0.6940892608328312}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=43 head_norm_before_train=1.773501 cos_to_last_merge=0.7598 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.760
[S2] round=43 local utility u=0.000000 metrics={'f1_val': 0.7172845786516757, 'auprc': 0.7271555782375676, 'loss_val': 0.9964496022025467, 'psi': 0.7212329784860325}-{'f1_val': 0.7178337483972587, 'auprc': 0.7290857247007415, 'loss_val': 0.9854559783919218, 'psi': 0.7223345389186517}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=43 head_norm_before_train=1.556091 cos_to_last_merge=0.9286 (last merge round=15)
[S3] ⚠️ Model drifted since last merge! cos=0.929
[S3] round=43 local utility u=0.000000 metrics={'f1_val': 0.7804781187943659, 'auprc': 0.8499528146498929, 'loss_val': 0.40399684074282316, 'psi': 0.8082679971365767}-{'f1_val': 0.7961522206190101, 'auprc': 0.9620217306525802, 'loss_val': 0.32901080882779576, 'psi': 0.8625000246324381}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=43 head_norm_before_train=1.441774 cos_to_last_merge=0.9185 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.918
[S4] round=43 local utility u=0.033767 metrics={'f1_val': 0.9389834021116443, 'auprc': 0.9811995021859469, 'loss_val': 0.2366082945892631, 'psi': 0.9558698421413654}-{'f1_val': 0.9304522990027091, 'auprc': 0.9817780881794964, 'loss_val': 0.25469163128270567, 'psi': 0.9509826146734239}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S4] sending update (kind=head size=1807 to 1 peers)
[S5] START round=43 head_norm_before_train=1.448423 cos_to_last_merge=0.7657 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.766
[S5] round=43 local utility u=0.955166 metrics={'f1_val': 0.6652497575588954, 'auprc': 0.8634594066822766, 'loss_val': 0.38092797332231987, 'psi': 0.7445336172082478}-{'f1_val': 0.43281363104298043, 'auprc': 0.8539558686965792, 'loss_val': 0.8681334015359167, 'psi': 0.60127052610442}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=43 head_norm_before_train=1.883397 cos_to_last_merge=0.9794 (last merge round=16)
[S6] round=43 local utility u=0.000000 metrics={'f1_val': 0.6724664296532875, 'auprc': 0.9102954584702825, 'loss_val': 0.6813344936290322, 'psi': 0.7675980411800856}-{'f1_val': 0.8480110298675043, 'auprc': 0.9051672055652815, 'loss_val': 0.39796022034719486, 'psi': 0.8708735001466151}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=43 head_norm_before_train=1.252549 cos_to_last_merge=0.8881 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.888
[S7] round=43 local utility u=0.648283 metrics={'f1_val': 0.6209290547091371, 'auprc': 0.7947602015018604, 'loss_val': 0.5752985608707145, 'psi': 0.6904615134262264}-{'f1_val': 0.47107159780719743, 'auprc': 0.777278542894076, 'loss_val': 0.920275074037789, 'psi': 0.5935543758419488}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S7] sending update (kind=head size=1809 to 1 peers)
[S8] START round=43 head_norm_before_train=1.805889 cos_to_last_merge=0.9560 (last merge round=15)
[S8] round=43 local utility u=0.025024 metrics={'f1_val': 0.9923731935991286, 'auprc': 0.9981992205600376, 'loss_val': 0.037449764196530656, 'psi': 0.9947036043834921}-{'f1_val': 0.9857804966617716, 'auprc': 0.9986422652367588, 'loss_val': 0.049270378069310894, 'psi': 0.9909252040917664}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=43 head_norm_before_train=1.882532 cos_to_last_merge=0.8229 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.823
[S9] round=43 local utility u=0.003035 metrics={'f1_val': 0.9959957888192151, 'auprc': 0.9984285142842055, 'loss_val': 0.021998853128759904, 'psi': 0.9969688790052113}-{'f1_val': 0.9951655063899485, 'auprc': 0.9984284396773208, 'loss_val': 0.023087425855155157, 'psi': 0.9964706797048973}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] sending update (kind=head size=1794 to 1 peers)
[S10] START round=43 head_norm_before_train=1.727853 cos_to_last_merge=0.9155 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.916
[S10] round=43 local utility u=0.004090 metrics={'f1_val': 0.9948838907637279, 'auprc': 0.9921748167472675, 'loss_val': 0.0322259696589281, 'psi': 0.9938002611571437}-{'f1_val': 0.9934769336626772, 'auprc': 0.9963351979367271, 'loss_val': 0.04444550401874918, 'psi': 0.9946202393722972}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=43 head_norm_before_train=1.796245 cos_to_last_merge=0.9253 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.925
[S11] round=43 local utility u=0.002748 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9980283045596355, 'loss_val': 0.023130575010318236, 'psi': 0.9968915267718398}-{'f1_val': 0.9961541414107454, 'auprc': 0.9966996055185715, 'loss_val': 0.024763254111410754, 'psi': 0.9963723270538758}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] sending update (kind=head size=1805 to 1 peers)
[S13] START round=43 head_norm_before_train=1.616531 cos_to_last_merge=0.9379 (last merge round=11)
[S13] ⚠️ Model drifted since last merge! cos=0.938
[S13] round=43 local utility u=0.033924 metrics={'f1_val': 0.576756183697342, 'auprc': 0.6739277832781236, 'loss_val': 0.8221577365338596, 'psi': 0.6156248235296546}-{'f1_val': 0.5657027669714583, 'auprc': 0.6747749739264483, 'loss_val': 0.8262267278099686, 'psi': 0.6093316497534542}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=43 head_norm_before_train=1.801967 cos_to_last_merge=0.9543 (last merge round=16)
[S14] round=43 local utility u=0.011737 metrics={'f1_val': 0.9968300801588782, 'auprc': 0.9960534342450004, 'loss_val': 0.0230106869669023, 'psi': 0.9965194217933271}-{'f1_val': 0.9970007132142444, 'auprc': 0.9905491679818876, 'loss_val': 0.030995601112625847, 'psi': 0.9944200951213018}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=43 head_norm_before_train=2.087505 (no previous merge yet)
[S15] round=43 local utility u=0.000000 metrics={'f1_val': 0.7085076627612786, 'auprc': 0.9300335341724031, 'loss_val': 0.5012692429699154, 'psi': 0.7971180113257283}-{'f1_val': 0.7647344162590421, 'auprc': 0.9844412292965583, 'loss_val': 0.40276733980675633, 'psi': 0.8526171414740487}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=43 head_norm_before_train=1.596065 cos_to_last_merge=0.8511 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.851
[S16] round=43 local utility u=0.001558 metrics={'f1_val': 0.9908793938683479, 'auprc': 0.9880412047292328, 'loss_val': 0.053293348104809464, 'psi': 0.9897441182127018}-{'f1_val': 0.9895618889012239, 'auprc': 0.9906954397542498, 'loss_val': 0.05646630420348419, 'psi': 0.9900153092424342}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=43 head_norm_before_train=1.529612 cos_to_last_merge=0.6987 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.699
[S17] round=43 local utility u=0.090868 metrics={'f1_val': 0.6086781014241428, 'auprc': 0.8142639925695484, 'loss_val': 0.8695951294858746, 'psi': 0.690912457882305}-{'f1_val': 0.6057599332367002, 'auprc': 0.8057210991346478, 'loss_val': 1.0081929050032836, 'psi': 0.6857443995958793}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=44 head_norm_before_train=1.784101 cos_to_last_merge=0.7592 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.759
[S2] round=44 local utility u=0.001407 metrics={'f1_val': 0.7164524674676735, 'auprc': 0.7302614683357266, 'loss_val': 0.9979604735100536, 'psi': 0.7219760678148948}-{'f1_val': 0.7172845786516757, 'auprc': 0.7271555782375676, 'loss_val': 0.9964496022025467, 'psi': 0.7212329784860325}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] sending update (kind=head size=1795 to 1 peers)
[S3] START round=44 head_norm_before_train=1.567730 cos_to_last_merge=0.9271 (last merge round=15)
[S3] ⚠️ Model drifted since last merge! cos=0.927
[S3] round=44 local utility u=1.000000 metrics={'f1_val': 0.9942900549913304, 'auprc': 0.9995933054129432, 'loss_val': 0.0433538167077912, 'psi': 0.9964113551599755}-{'f1_val': 0.7804781187943659, 'auprc': 0.8499528146498929, 'loss_val': 0.40399684074282316, 'psi': 0.8082679971365767}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=44 head_norm_before_train=1.449783 cos_to_last_merge=0.9175 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.918
[S4] round=44 local utility u=0.056826 metrics={'f1_val': 0.9566728330511862, 'auprc': 0.984513262268103, 'loss_val': 0.2390348744757361, 'psi': 0.967809004737953}-{'f1_val': 0.9389834021116443, 'auprc': 0.9811995021859469, 'loss_val': 0.2366082945892631, 'psi': 0.9558698421413654}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] START round=44 head_norm_before_train=1.453728 cos_to_last_merge=0.7654 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.765
[S5] round=44 local utility u=0.154993 metrics={'f1_val': 0.6534496598937442, 'auprc': 0.9593587440105442, 'loss_val': 0.28783894584704445, 'psi': 0.7758132935404642}-{'f1_val': 0.6652497575588954, 'auprc': 0.8634594066822766, 'loss_val': 0.38092797332231987, 'psi': 0.7445336172082478}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=44 head_norm_before_train=1.892204 cos_to_last_merge=0.9788 (last merge round=16)
[S6] round=44 local utility u=0.790477 metrics={'f1_val': 0.8666072984736775, 'auprc': 0.955477321609734, 'loss_val': 0.40077218152762745, 'psi': 0.9021553077281}-{'f1_val': 0.6724664296532875, 'auprc': 0.9102954584702825, 'loss_val': 0.6813344936290322, 'psi': 0.7675980411800856}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[S7] START round=44 head_norm_before_train=1.264169 cos_to_last_merge=0.8858 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.886
[S7] round=44 local utility u=0.000000 metrics={'f1_val': 0.591663291194457, 'auprc': 0.7858919504963903, 'loss_val': 0.6777009794378062, 'psi': 0.6693547549152303}-{'f1_val': 0.6209290547091371, 'auprc': 0.7947602015018604, 'loss_val': 0.5752985608707145, 'psi': 0.6904615134262264}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=44 head_norm_before_train=1.816168 cos_to_last_merge=0.9551 (last merge round=15)
[S8] round=44 local utility u=0.000000 metrics={'f1_val': 0.9930017911527874, 'auprc': 0.9960003401919385, 'loss_val': 0.03707685341936202, 'psi': 0.9942012107684479}-{'f1_val': 0.9923731935991286, 'auprc': 0.9981992205600376, 'loss_val': 0.037449764196530656, 'psi': 0.9947036043834921}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=44 head_norm_before_train=1.888499 cos_to_last_merge=0.8224 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.822
[S9] round=44 local utility u=0.000000 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9938385491235402, 'loss_val': 0.02115554297325299, 'psi': 0.9955509144082734}-{'f1_val': 0.9959957888192151, 'auprc': 0.9984285142842055, 'loss_val': 0.021998853128759904, 'psi': 0.9969688790052113}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=44 head_norm_before_train=1.737062 cos_to_last_merge=0.9144 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.914
[S10] round=44 local utility u=0.001532 metrics={'f1_val': 0.9941851168862865, 'auprc': 0.9964756750208058, 'loss_val': 0.03787200613361542, 'psi': 0.9951013401400942}-{'f1_val': 0.9948838907637279, 'auprc': 0.9921748167472675, 'loss_val': 0.0322259696589281, 'psi': 0.9938002611571437}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] sending update (kind=head size=1804 to 1 peers)
[S11] START round=44 head_norm_before_train=1.807239 cos_to_last_merge=0.9241 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.924
[S11] round=44 local utility u=0.002886 metrics={'f1_val': 0.9967887165093644, 'auprc': 0.9982650637110303, 'loss_val': 0.021998585832592028, 'psi': 0.9973792553900307}-{'f1_val': 0.9961336749133093, 'auprc': 0.9980283045596355, 'loss_val': 0.023130575010318236, 'psi': 0.9968915267718398}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=44 head_norm_before_train=1.624527 cos_to_last_merge=0.9370 (last merge round=11)
[S13] ⚠️ Model drifted since last merge! cos=0.937
[S13] round=44 local utility u=0.016128 metrics={'f1_val': 0.57378904657204, 'auprc': 0.6730066104149832, 'loss_val': 0.7693357328724503, 'psi': 0.6134760721092173}-{'f1_val': 0.576756183697342, 'auprc': 0.6739277832781236, 'loss_val': 0.8221577365338596, 'psi': 0.6156248235296546}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=44 head_norm_before_train=1.809509 cos_to_last_merge=0.9536 (last merge round=16)
[S14] round=44 local utility u=0.000558 metrics={'f1_val': 0.9970007132142444, 'auprc': 0.9966774025293306, 'loss_val': 0.02479075854086327, 'psi': 0.9968713889402789}-{'f1_val': 0.9968300801588782, 'auprc': 0.9960534342450004, 'loss_val': 0.0230106869669023, 'psi': 0.9965194217933271}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] sending update (kind=head size=1804 to 1 peers)
[S15] START round=44 head_norm_before_train=2.095729 (no previous merge yet)
[S15] round=44 local utility u=1.000000 metrics={'f1_val': 0.9964553122065998, 'auprc': 0.9988141827500312, 'loss_val': 0.02080812419724326, 'psi': 0.9973988604239724}-{'f1_val': 0.7085076627612786, 'auprc': 0.9300335341724031, 'loss_val': 0.5012692429699154, 'psi': 0.7971180113257283}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=44 head_norm_before_train=1.607908 cos_to_last_merge=0.8496 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.850
[S16] round=44 local utility u=0.000000 metrics={'f1_val': 0.9895618889012239, 'auprc': 0.9905610152531522, 'loss_val': 0.05519914385583631, 'psi': 0.9899615394419952}-{'f1_val': 0.9908793938683479, 'auprc': 0.9880412047292328, 'loss_val': 0.053293348104809464, 'psi': 0.9897441182127018}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=44 head_norm_before_train=1.550658 cos_to_last_merge=0.6978 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.698
[S17] round=44 local utility u=0.000000 metrics={'f1_val': 0.6125301359049536, 'auprc': 0.8211289387515632, 'loss_val': 0.9412209048007569, 'psi': 0.6959696570435975}-{'f1_val': 0.6086781014241428, 'auprc': 0.8142639925695484, 'loss_val': 0.8695951294858746, 'psi': 0.690912457882305}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=45 head_norm_before_train=1.792585 cos_to_last_merge=0.7587 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.759
[S2] round=45 local utility u=0.000000 metrics={'f1_val': 0.7048305769134866, 'auprc': 0.7254836181468075, 'loss_val': 1.0211485155151159, 'psi': 0.713091793406815}-{'f1_val': 0.7164524674676735, 'auprc': 0.7302614683357266, 'loss_val': 0.9979604735100536, 'psi': 0.7219760678148948}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=45 head_norm_before_train=1.576127 cos_to_last_merge=0.9259 (last merge round=15)
[S3] ⚠️ Model drifted since last merge! cos=0.926
[S3] round=45 local utility u=0.000000 metrics={'f1_val': 0.6568003056054105, 'auprc': 0.8364335373696378, 'loss_val': 0.6490043246969451, 'psi': 0.7286535983111014}-{'f1_val': 0.9942900549913304, 'auprc': 0.9995933054129432, 'loss_val': 0.0433538167077912, 'psi': 0.9964113551599755}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=45 head_norm_before_train=1.457195 cos_to_last_merge=0.9165 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.917
[S4] round=45 local utility u=0.000000 metrics={'f1_val': 0.9536166740830934, 'auprc': 0.9845418776236908, 'loss_val': 0.22820447175980568, 'psi': 0.9659867554993323}-{'f1_val': 0.9566728330511862, 'auprc': 0.984513262268103, 'loss_val': 0.2390348744757361, 'psi': 0.967809004737953}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=45 head_norm_before_train=1.461732 cos_to_last_merge=0.7644 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.764
[S5] round=45 local utility u=0.133464 metrics={'f1_val': 0.7004069097142683, 'auprc': 0.9590162406333761, 'loss_val': 0.30162770270253586, 'psi': 0.8038506420819115}-{'f1_val': 0.6534496598937442, 'auprc': 0.9593587440105442, 'loss_val': 0.28783894584704445, 'psi': 0.7758132935404642}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=45 head_norm_before_train=1.902976 cos_to_last_merge=0.9784 (last merge round=16)
[S6] round=45 local utility u=0.000000 metrics={'f1_val': 0.6153298409827528, 'auprc': 0.8705023371568105, 'loss_val': 0.970750570887359, 'psi': 0.7173988394523758}-{'f1_val': 0.8666072984736775, 'auprc': 0.955477321609734, 'loss_val': 0.40077218152762745, 'psi': 0.9021553077281}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=45 head_norm_before_train=1.275627 cos_to_last_merge=0.8834 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.883
[S7] round=45 local utility u=0.000000 metrics={'f1_val': 0.5787461801085614, 'auprc': 0.7836728949212881, 'loss_val': 0.7202160999645932, 'psi': 0.6607168660336521}-{'f1_val': 0.591663291194457, 'auprc': 0.7858919504963903, 'loss_val': 0.6777009794378062, 'psi': 0.6693547549152303}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=45 head_norm_before_train=1.823944 cos_to_last_merge=0.9546 (last merge round=15)
[S8] round=45 local utility u=0.000000 metrics={'f1_val': 0.9897367044659179, 'auprc': 0.998423291591647, 'loss_val': 0.04160942594094522, 'psi': 0.9932113393162094}-{'f1_val': 0.9930017911527874, 'auprc': 0.9960003401919385, 'loss_val': 0.03707685341936202, 'psi': 0.9942012107684479}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=45 head_norm_before_train=1.896605 cos_to_last_merge=0.8214 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.821
[S9] round=45 local utility u=0.010432 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9995512772767039, 'loss_val': 0.01989231685226229, 'psi': 0.9980822584179673}-{'f1_val': 0.9966924912647621, 'auprc': 0.9938385491235402, 'loss_val': 0.02115554297325299, 'psi': 0.9955509144082734}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] sending update (kind=head size=1793 to 1 peers)
[S10] START round=45 head_norm_before_train=1.744529 cos_to_last_merge=0.9134 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.913
[S10] round=45 local utility u=0.000000 metrics={'f1_val': 0.9944449605296568, 'auprc': 0.993337541301605, 'loss_val': 0.03270591720289687, 'psi': 0.994001992838436}-{'f1_val': 0.9941851168862865, 'auprc': 0.9964756750208058, 'loss_val': 0.03787200613361542, 'psi': 0.9951013401400942}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=45 head_norm_before_train=1.818232 cos_to_last_merge=0.9229 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.923
[S11] round=45 local utility u=0.000000 metrics={'f1_val': 0.7576981892121254, 'auprc': 0.9957136091537183, 'loss_val': 0.5726131812499339, 'psi': 0.8529043571887626}-{'f1_val': 0.9967887165093644, 'auprc': 0.9982650637110303, 'loss_val': 0.021998585832592028, 'psi': 0.9973792553900307}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=45 head_norm_before_train=1.631165 cos_to_last_merge=0.9361 (last merge round=11)
[S13] ⚠️ Model drifted since last merge! cos=0.936
[S13] round=45 local utility u=0.193914 metrics={'f1_val': 0.6174721165066981, 'auprc': 0.6768626332521112, 'loss_val': 0.6551744747241387, 'psi': 0.6412283232048633}-{'f1_val': 0.57378904657204, 'auprc': 0.6730066104149832, 'loss_val': 0.7693357328724503, 'psi': 0.6134760721092173}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=45 head_norm_before_train=1.818468 cos_to_last_merge=0.9532 (last merge round=16)
[S14] round=45 local utility u=0.000000 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.9947337928792297, 'loss_val': 0.024806137593331015, 'psi': 0.995845856118142}-{'f1_val': 0.9970007132142444, 'auprc': 0.9966774025293306, 'loss_val': 0.02479075854086327, 'psi': 0.9968713889402789}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=45 head_norm_before_train=2.103282 (no previous merge yet)
[S15] round=45 local utility u=0.000000 metrics={'f1_val': 0.9025988760013092, 'auprc': 0.9968937768487085, 'loss_val': 0.139749521640281, 'psi': 0.9403168363402689}-{'f1_val': 0.9964553122065998, 'auprc': 0.9988141827500312, 'loss_val': 0.02080812419724326, 'psi': 0.9973988604239724}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=45 head_norm_before_train=1.617065 cos_to_last_merge=0.8482 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.848
[S16] round=45 local utility u=0.000000 metrics={'f1_val': 0.9800091745088947, 'auprc': 0.9903933329388588, 'loss_val': 0.08114916456443243, 'psi': 0.9841628378808802}-{'f1_val': 0.9895618889012239, 'auprc': 0.9905610152531522, 'loss_val': 0.05519914385583631, 'psi': 0.9899615394419952}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=45 head_norm_before_train=1.570786 cos_to_last_merge=0.6971 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.697
[S17] round=45 local utility u=0.087916 metrics={'f1_val': 0.6145979973425844, 'auprc': 0.8360962795293797, 'loss_val': 0.8226985906076264, 'psi': 0.7031973102173025}-{'f1_val': 0.6125301359049536, 'auprc': 0.8211289387515632, 'loss_val': 0.9412209048007569, 'psi': 0.6959696570435975}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=46 head_norm_before_train=1.797758 cos_to_last_merge=0.7583 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.758
[S2] round=46 local utility u=0.018228 metrics={'f1_val': 0.7111530107309256, 'auprc': 0.7252323985657214, 'loss_val': 1.0218738375602576, 'psi': 0.716784765864844}-{'f1_val': 0.7048305769134866, 'auprc': 0.7254836181468075, 'loss_val': 1.0211485155151159, 'psi': 0.713091793406815}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] sending update (kind=head size=1794 to 1 peers)
[S3] START round=46 head_norm_before_train=1.583246 cos_to_last_merge=0.9248 (last merge round=15)
[S3] ⚠️ Model drifted since last merge! cos=0.925
[S3] round=46 local utility u=0.506461 metrics={'f1_val': 0.7381594561845315, 'auprc': 0.9499266636770268, 'loss_val': 0.46471758240968153, 'psi': 0.8228663391815296}-{'f1_val': 0.6568003056054105, 'auprc': 0.8364335373696378, 'loss_val': 0.6490043246969451, 'psi': 0.7286535983111014}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=46 head_norm_before_train=1.463303 cos_to_last_merge=0.9156 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.916
[S4] round=46 local utility u=0.000000 metrics={'f1_val': 0.943002026388447, 'auprc': 0.9550220622250127, 'loss_val': 0.22688344312560557, 'psi': 0.9478100407230733}-{'f1_val': 0.9536166740830934, 'auprc': 0.9845418776236908, 'loss_val': 0.22820447175980568, 'psi': 0.9659867554993323}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=46 head_norm_before_train=1.472953 cos_to_last_merge=0.7623 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.762
[S5] round=46 local utility u=0.050243 metrics={'f1_val': 0.7004932948021524, 'auprc': 0.9895013606259611, 'loss_val': 0.29311612849556434, 'psi': 0.816096521131676}-{'f1_val': 0.7004069097142683, 'auprc': 0.9590162406333761, 'loss_val': 0.30162770270253586, 'psi': 0.8038506420819115}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=46 head_norm_before_train=1.912021 cos_to_last_merge=0.9779 (last merge round=16)
[S6] round=46 local utility u=0.948741 metrics={'f1_val': 0.8100603914698962, 'auprc': 0.9464830016207232, 'loss_val': 0.46959380999971156, 'psi': 0.864629435530227}-{'f1_val': 0.6153298409827528, 'auprc': 0.8705023371568105, 'loss_val': 0.970750570887359, 'psi': 0.7173988394523758}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[S7] START round=46 head_norm_before_train=1.284470 cos_to_last_merge=0.8815 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.881
[S7] round=46 local utility u=0.000000 metrics={'f1_val': 0.5156304476285344, 'auprc': 0.7792189260228123, 'loss_val': 0.8763798678489073, 'psi': 0.6210658389862456}-{'f1_val': 0.5787461801085614, 'auprc': 0.7836728949212881, 'loss_val': 0.7202160999645932, 'psi': 0.6607168660336521}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=46 head_norm_before_train=1.831740 cos_to_last_merge=0.9547 (last merge round=15)
[S8] round=46 local utility u=0.010775 metrics={'f1_val': 0.9926368238932805, 'auprc': 0.9981787565387299, 'loss_val': 0.036727164251948496, 'psi': 0.9948535969514603}-{'f1_val': 0.9897367044659179, 'auprc': 0.998423291591647, 'loss_val': 0.04160942594094522, 'psi': 0.9932113393162094}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] sending update (kind=head size=1795 to 1 peers)
[S9] START round=46 head_norm_before_train=1.901785 cos_to_last_merge=0.8208 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.821
[S9] round=46 local utility u=0.000000 metrics={'f1_val': 0.9880286744602689, 'auprc': 0.9995889809690186, 'loss_val': 0.04530311746479617, 'psi': 0.9926527970637687}-{'f1_val': 0.9971029125121428, 'auprc': 0.9995512772767039, 'loss_val': 0.01989231685226229, 'psi': 0.9980822584179673}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=46 head_norm_before_train=1.753225 cos_to_last_merge=0.9125 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.912
[S10] round=46 local utility u=0.000179 metrics={'f1_val': 0.9944449605296568, 'auprc': 0.9933395445187506, 'loss_val': 0.03235383121572001, 'psi': 0.9940027941252944}-{'f1_val': 0.9944449605296568, 'auprc': 0.993337541301605, 'loss_val': 0.03270591720289687, 'psi': 0.994001992838436}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=46 head_norm_before_train=1.828084 cos_to_last_merge=0.9218 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.922
[S11] round=46 local utility u=0.532930 metrics={'f1_val': 0.867067257134699, 'auprc': 0.9959435018221715, 'loss_val': 0.16365768672118744, 'psi': 0.918617755009688}-{'f1_val': 0.7576981892121254, 'auprc': 0.9957136091537183, 'loss_val': 0.5726131812499339, 'psi': 0.8529043571887626}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=46 head_norm_before_train=1.637725 cos_to_last_merge=0.9353 (last merge round=11)
[S13] ⚠️ Model drifted since last merge! cos=0.935
[S13] round=46 local utility u=0.000000 metrics={'f1_val': 0.5523345062851881, 'auprc': 0.7000755133174991, 'loss_val': 0.8835792500855562, 'psi': 0.6114309090981125}-{'f1_val': 0.6174721165066981, 'auprc': 0.6768626332521112, 'loss_val': 0.6551744747241387, 'psi': 0.6412283232048633}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=46 head_norm_before_train=1.826271 cos_to_last_merge=0.9527 (last merge round=16)
[S14] round=46 local utility u=0.004789 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9966685361581762, 'loss_val': 0.023493968453869335, 'psi': 0.9968659193578695}-{'f1_val': 0.9965872316107504, 'auprc': 0.9947337928792297, 'loss_val': 0.024806137593331015, 'psi': 0.995845856118142}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] sending update (kind=head size=1805 to 1 peers)
[S15] START round=46 head_norm_before_train=2.112016 (no previous merge yet)
[S15] round=46 local utility u=0.000000 metrics={'f1_val': 0.700957864484732, 'auprc': 0.99006903587167, 'loss_val': 0.46653898485049455, 'psi': 0.8166023330395071}-{'f1_val': 0.9025988760013092, 'auprc': 0.9968937768487085, 'loss_val': 0.139749521640281, 'psi': 0.9403168363402689}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=46 head_norm_before_train=1.624532 cos_to_last_merge=0.8467 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.847
[S16] round=46 local utility u=0.000000 metrics={'f1_val': 0.9519655044036336, 'auprc': 0.9880368742175566, 'loss_val': 0.16137018774371362, 'psi': 0.9663940523292027}-{'f1_val': 0.9800091745088947, 'auprc': 0.9903933329388588, 'loss_val': 0.08114916456443243, 'psi': 0.9841628378808802}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=46 head_norm_before_train=1.594618 cos_to_last_merge=0.6965 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.696
[S17] round=46 local utility u=0.113952 metrics={'f1_val': 0.6085328271945593, 'auprc': 0.8851229924577798, 'loss_val': 0.7054835414520462, 'psi': 0.7191688932998475}-{'f1_val': 0.6145979973425844, 'auprc': 0.8360962795293797, 'loss_val': 0.8226985906076264, 'psi': 0.7031973102173025}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=47 head_norm_before_train=1.802919 cos_to_last_merge=0.7580 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.758
[S2] round=47 local utility u=0.024245 metrics={'f1_val': 0.7179496726321271, 'auprc': 0.7255457930038463, 'loss_val': 1.0151036695236713, 'psi': 0.7209881207808148}-{'f1_val': 0.7111530107309256, 'auprc': 0.7252323985657214, 'loss_val': 1.0218738375602576, 'psi': 0.716784765864844}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] sending update (kind=head size=1795 to 1 peers)
[S3] START round=47 head_norm_before_train=1.589662 cos_to_last_merge=0.9240 (last merge round=15)
[S3] ⚠️ Model drifted since last merge! cos=0.924
[S3] round=47 local utility u=0.009778 metrics={'f1_val': 0.7425137586336334, 'auprc': 0.9485773347263741, 'loss_val': 0.46723977185744897, 'psi': 0.8249391890707297}-{'f1_val': 0.7381594561845315, 'auprc': 0.9499266636770268, 'loss_val': 0.46471758240968153, 'psi': 0.8228663391815296}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=47 head_norm_before_train=1.467679 cos_to_last_merge=0.9147 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.915
[S4] round=47 local utility u=0.043476 metrics={'f1_val': 0.9444109828101628, 'auprc': 0.9833734461692355, 'loss_val': 0.23343969599121517, 'psi': 0.9599959681537918}-{'f1_val': 0.943002026388447, 'auprc': 0.9550220622250127, 'loss_val': 0.22688344312560557, 'psi': 0.9478100407230733}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=47 head_norm_before_train=1.480177 cos_to_last_merge=0.7603 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.760
[S5] round=47 local utility u=0.000000 metrics={'f1_val': 0.6919597877151511, 'auprc': 0.9458298632679983, 'loss_val': 0.3140327458213899, 'psi': 0.79350781793629}-{'f1_val': 0.7004932948021524, 'auprc': 0.9895013606259611, 'loss_val': 0.29311612849556434, 'psi': 0.816096521131676}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=47 head_norm_before_train=1.921424 cos_to_last_merge=0.9773 (last merge round=16)
[S6] round=47 local utility u=0.000000 metrics={'f1_val': 0.6964504800742414, 'auprc': 0.892820197206933, 'loss_val': 0.731410956246608, 'psi': 0.7749983669273179}-{'f1_val': 0.8100603914698962, 'auprc': 0.9464830016207232, 'loss_val': 0.46959380999971156, 'psi': 0.864629435530227}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=47 head_norm_before_train=1.292352 cos_to_last_merge=0.8801 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.880
[S7] round=47 local utility u=0.402408 metrics={'f1_val': 0.6041459389356441, 'auprc': 0.7911752055097963, 'loss_val': 0.6385263079981279, 'psi': 0.678957645565305}-{'f1_val': 0.5156304476285344, 'auprc': 0.7792189260228123, 'loss_val': 0.8763798678489073, 'psi': 0.6210658389862456}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S7] sending update (kind=head size=1807 to 1 peers)
[S8] START round=47 head_norm_before_train=1.841026 cos_to_last_merge=0.9544 (last merge round=15)
[S8] round=47 local utility u=0.000000 metrics={'f1_val': 0.9926368238932805, 'auprc': 0.9982333220304018, 'loss_val': 0.03699840014769045, 'psi': 0.9948754231481289}-{'f1_val': 0.9926368238932805, 'auprc': 0.9981787565387299, 'loss_val': 0.036727164251948496, 'psi': 0.9948535969514603}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=47 head_norm_before_train=1.905687 cos_to_last_merge=0.8207 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.821
[S9] round=47 local utility u=0.040117 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9995545347615589, 'loss_val': 0.019410304378087086, 'psi': 0.9980835614119092}-{'f1_val': 0.9880286744602689, 'auprc': 0.9995889809690186, 'loss_val': 0.04530311746479617, 'psi': 0.9926527970637687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=47 head_norm_before_train=1.762492 cos_to_last_merge=0.9115 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.911
[S10] round=47 local utility u=0.000000 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9956255753671739, 'loss_val': 0.035296792289625976, 'psi': 0.9943910239660262}-{'f1_val': 0.9944449605296568, 'auprc': 0.9933395445187506, 'loss_val': 0.03235383121572001, 'psi': 0.9940027941252944}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=47 head_norm_before_train=1.834250 cos_to_last_merge=0.9212 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.921
[S11] round=47 local utility u=0.461671 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9976998227593913, 'loss_val': 0.022463035625111476, 'psi': 0.9970081318119103}-{'f1_val': 0.867067257134699, 'auprc': 0.9959435018221715, 'loss_val': 0.16365768672118744, 'psi': 0.918617755009688}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S11] sending update (kind=head size=1806 to 1 peers)
[S13] START round=47 head_norm_before_train=1.643506 cos_to_last_merge=0.9345 (last merge round=11)
[S13] ⚠️ Model drifted since last merge! cos=0.934
[S13] round=47 local utility u=0.145650 metrics={'f1_val': 0.5664015536670677, 'auprc': 0.6910763112315237, 'loss_val': 0.6496836940814741, 'psi': 0.61627145669285}-{'f1_val': 0.5523345062851881, 'auprc': 0.7000755133174991, 'loss_val': 0.8835792500855562, 'psi': 0.6114309090981125}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=47 head_norm_before_train=1.833693 cos_to_last_merge=0.9519 (last merge round=16)
[S14] round=47 local utility u=0.004036 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9969719036804792, 'loss_val': 0.020254429636566724, 'psi': 0.9973794323021038}-{'f1_val': 0.9969975081576651, 'auprc': 0.9966685361581762, 'loss_val': 0.023493968453869335, 'psi': 0.9968659193578695}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[S15] START round=47 head_norm_before_train=2.122591 (no previous merge yet)
[S15] round=47 local utility u=0.766160 metrics={'f1_val': 0.901471908377172, 'auprc': 0.9961815592802187, 'loss_val': 0.15564112495131271, 'psi': 0.9393557687383907}-{'f1_val': 0.700957864484732, 'auprc': 0.99006903587167, 'loss_val': 0.46653898485049455, 'psi': 0.8166023330395071}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=47 head_norm_before_train=1.633369 cos_to_last_merge=0.8452 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.845
[S16] round=47 local utility u=0.000000 metrics={'f1_val': 0.9437710676031097, 'auprc': 0.9879954044020194, 'loss_val': 0.19400223312013035, 'psi': 0.9614608023226736}-{'f1_val': 0.9519655044036336, 'auprc': 0.9880368742175566, 'loss_val': 0.16137018774371362, 'psi': 0.9663940523292027}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=47 head_norm_before_train=1.619586 cos_to_last_merge=0.6959 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.696
[S17] round=47 local utility u=0.000000 metrics={'f1_val': 0.6098364394344145, 'auprc': 0.8115303715505197, 'loss_val': 1.0615480011619962, 'psi': 0.6905140122808565}-{'f1_val': 0.6085328271945593, 'auprc': 0.8851229924577798, 'loss_val': 0.7054835414520462, 'psi': 0.7191688932998475}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=48 head_norm_before_train=1.808453 cos_to_last_merge=0.7577 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.758
[S2] round=48 local utility u=0.000000 metrics={'f1_val': 0.7168362891292207, 'auprc': 0.7245662498322675, 'loss_val': 1.0279679970022144, 'psi': 0.7199282734104394}-{'f1_val': 0.7179496726321271, 'auprc': 0.7255457930038463, 'loss_val': 1.0151036695236713, 'psi': 0.7209881207808148}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=48 head_norm_before_train=1.597083 cos_to_last_merge=0.9231 (last merge round=15)
[S3] ⚠️ Model drifted since last merge! cos=0.923
[S3] round=48 local utility u=0.449719 metrics={'f1_val': 0.8467106934644105, 'auprc': 0.9763024177020199, 'loss_val': 0.2761587493272446, 'psi': 0.8985473831594543}-{'f1_val': 0.7425137586336334, 'auprc': 0.9485773347263741, 'loss_val': 0.46723977185744897, 'psi': 0.8249391890707297}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=48 head_norm_before_train=1.474342 cos_to_last_merge=0.9139 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.914
[S4] round=48 local utility u=0.028708 metrics={'f1_val': 0.9515703156803434, 'auprc': 0.9847681778670893, 'loss_val': 0.22316433095385407, 'psi': 0.9648494605550417}-{'f1_val': 0.9444109828101628, 'auprc': 0.9833734461692355, 'loss_val': 0.23343969599121517, 'psi': 0.9599959681537918}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S5] START round=48 head_norm_before_train=1.488103 cos_to_last_merge=0.7593 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.759
[S5] round=48 local utility u=0.000000 metrics={'f1_val': 0.6164365857212105, 'auprc': 0.8624426890320708, 'loss_val': 0.507742104193502, 'psi': 0.7148390270455547}-{'f1_val': 0.6919597877151511, 'auprc': 0.9458298632679983, 'loss_val': 0.3140327458213899, 'psi': 0.79350781793629}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=48 head_norm_before_train=1.927227 cos_to_last_merge=0.9764 (last merge round=16)
[S6] round=48 local utility u=0.000000 metrics={'f1_val': 0.6060773672459974, 'auprc': 0.8736068047012728, 'loss_val': 0.9878600932919097, 'psi': 0.7130891422281076}-{'f1_val': 0.6964504800742414, 'auprc': 0.892820197206933, 'loss_val': 0.731410956246608, 'psi': 0.7749983669273179}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=48 head_norm_before_train=1.297225 cos_to_last_merge=0.8790 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.879
[S7] round=48 local utility u=0.130048 metrics={'f1_val': 0.6354171488254787, 'auprc': 0.7958848668915106, 'loss_val': 0.5801863826078402, 'psi': 0.6996042360518915}-{'f1_val': 0.6041459389356441, 'auprc': 0.7911752055097963, 'loss_val': 0.6385263079981279, 'psi': 0.678957645565305}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] sending update (kind=head size=1806 to 1 peers)
[S8] START round=48 head_norm_before_train=1.844805 cos_to_last_merge=0.9542 (last merge round=15)
[S8] round=48 local utility u=0.000000 metrics={'f1_val': 0.9889889874193012, 'auprc': 0.9985741586682044, 'loss_val': 0.0452757939054673, 'psi': 0.9928230559188626}-{'f1_val': 0.9926368238932805, 'auprc': 0.9982333220304018, 'loss_val': 0.03699840014769045, 'psi': 0.9948754231481289}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=48 head_norm_before_train=1.912985 cos_to_last_merge=0.8202 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.820
[S9] round=48 local utility u=0.000080 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9995506099701102, 'loss_val': 0.019238128937352144, 'psi': 0.9980819914953298}-{'f1_val': 0.9971029125121428, 'auprc': 0.9995545347615589, 'loss_val': 0.019410304378087086, 'psi': 0.9980835614119092}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=48 head_norm_before_train=1.771928 cos_to_last_merge=0.9104 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.910
[S10] round=48 local utility u=0.000030 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9956475340244936, 'loss_val': 0.035302428363989835, 'psi': 0.9943998074289541}-{'f1_val': 0.9935679896985945, 'auprc': 0.9956255753671739, 'loss_val': 0.035296792289625976, 'psi': 0.9943910239660262}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=48 head_norm_before_train=1.837729 cos_to_last_merge=0.9209 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.921
[S11] round=48 local utility u=0.000000 metrics={'f1_val': 0.9638714655816377, 'auprc': 0.9980193368858332, 'loss_val': 0.09408382783285942, 'psi': 0.977530614103316}-{'f1_val': 0.9965470045135896, 'auprc': 0.9976998227593913, 'loss_val': 0.022463035625111476, 'psi': 0.9970081318119103}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=48 head_norm_before_train=1.650107 cos_to_last_merge=0.9333 (last merge round=11)
[S13] ⚠️ Model drifted since last merge! cos=0.933
[S13] round=48 local utility u=0.000000 metrics={'f1_val': 0.5387288561346204, 'auprc': 0.6527244532526353, 'loss_val': 0.9059144725832966, 'psi': 0.5843270949818264}-{'f1_val': 0.5664015536670677, 'auprc': 0.6910763112315237, 'loss_val': 0.6496836940814741, 'psi': 0.61627145669285}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=48 head_norm_before_train=1.841768 cos_to_last_merge=0.9512 (last merge round=16)
[S14] round=48 local utility u=0.000000 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9955387873984416, 'loss_val': 0.021087224271014067, 'psi': 0.996660476660412}-{'f1_val': 0.9976511180498535, 'auprc': 0.9969719036804792, 'loss_val': 0.020254429636566724, 'psi': 0.9973794323021038}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=48 head_norm_before_train=2.132512 (no previous merge yet)
[S15] round=48 local utility u=0.354463 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9977809910903166, 'loss_val': 0.023161743859670042, 'psi': 0.9971603974686389}-{'f1_val': 0.901471908377172, 'auprc': 0.9961815592802187, 'loss_val': 0.15564112495131271, 'psi': 0.9393557687383907}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=48 head_norm_before_train=1.643060 cos_to_last_merge=0.8439 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.844
[S16] round=48 local utility u=0.000000 metrics={'f1_val': 0.8557117107183889, 'auprc': 0.9823283027138867, 'loss_val': 0.8045621146809826, 'psi': 0.9063583475165881}-{'f1_val': 0.9437710676031097, 'auprc': 0.9879954044020194, 'loss_val': 0.19400223312013035, 'psi': 0.9614608023226736}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=48 head_norm_before_train=1.639926 cos_to_last_merge=0.6952 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.695
[S17] round=48 local utility u=0.000000 metrics={'f1_val': 0.6123350217900441, 'auprc': 0.7994272030802206, 'loss_val': 1.1196454144866357, 'psi': 0.6871718943061147}-{'f1_val': 0.6098364394344145, 'auprc': 0.8115303715505197, 'loss_val': 1.0615480011619962, 'psi': 0.6905140122808565}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=49 head_norm_before_train=1.815069 cos_to_last_merge=0.7573 (last merge round=2)
[S2] ⚠️ Model drifted since last merge! cos=0.757
[S2] round=49 local utility u=0.001649 metrics={'f1_val': 0.7167352370503384, 'auprc': 0.7246531802495242, 'loss_val': 1.0243254527027574, 'psi': 0.7199024143300127}-{'f1_val': 0.7168362891292207, 'auprc': 0.7245662498322675, 'loss_val': 1.0279679970022144, 'psi': 0.7199282734104394}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=49 head_norm_before_train=1.605062 cos_to_last_merge=0.9222 (last merge round=15)
[S3] ⚠️ Model drifted since last merge! cos=0.922
[S3] round=49 local utility u=0.184159 metrics={'f1_val': 0.8880020384633193, 'auprc': 0.9822608399499861, 'loss_val': 0.17346373182246527, 'psi': 0.9257055590579859}-{'f1_val': 0.8467106934644105, 'auprc': 0.9763024177020199, 'loss_val': 0.2761587493272446, 'psi': 0.8985473831594543}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=49 head_norm_before_train=1.481231 cos_to_last_merge=0.9129 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.913
[S4] round=49 local utility u=0.019267 metrics={'f1_val': 0.9574023115248159, 'auprc': 0.9851839263954651, 'loss_val': 0.22086886158806351, 'psi': 0.9685149574730756}-{'f1_val': 0.9515703156803434, 'auprc': 0.9847681778670893, 'loss_val': 0.22316433095385407, 'psi': 0.9648494605550417}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=49 head_norm_before_train=1.496305 cos_to_last_merge=0.7592 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.759
[S5] round=49 local utility u=0.604535 metrics={'f1_val': 0.7005691551769304, 'auprc': 0.9933218503207913, 'loss_val': 0.196105348077814, 'psi': 0.8176702332344747}-{'f1_val': 0.6164365857212105, 'auprc': 0.8624426890320708, 'loss_val': 0.507742104193502, 'psi': 0.7148390270455547}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] START round=49 head_norm_before_train=1.935159 cos_to_last_merge=0.9760 (last merge round=16)
[S6] round=49 local utility u=1.000000 metrics={'f1_val': 0.8501788040202831, 'auprc': 0.9477862692877327, 'loss_val': 0.4179823322445904, 'psi': 0.889221790127263}-{'f1_val': 0.6060773672459974, 'auprc': 0.8736068047012728, 'loss_val': 0.9878600932919097, 'psi': 0.7130891422281076}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] START round=49 head_norm_before_train=1.304327 cos_to_last_merge=0.8788 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.879
[S7] round=49 local utility u=0.000000 metrics={'f1_val': 0.5746373532942195, 'auprc': 0.7805521013706498, 'loss_val': 0.7322308226569281, 'psi': 0.6570032525247916}-{'f1_val': 0.6354171488254787, 'auprc': 0.7958848668915106, 'loss_val': 0.5801863826078402, 'psi': 0.6996042360518915}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=49 head_norm_before_train=1.850508 cos_to_last_merge=0.9538 (last merge round=15)
[S8] round=49 local utility u=0.002075 metrics={'f1_val': 0.9893480400613308, 'auprc': 0.9986470498749677, 'loss_val': 0.043499742887084025, 'psi': 0.9930676439867856}-{'f1_val': 0.9889889874193012, 'auprc': 0.9985741586682044, 'loss_val': 0.0452757939054673, 'psi': 0.9928230559188626}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=49 head_norm_before_train=1.919545 cos_to_last_merge=0.8201 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.820
[S9] round=49 local utility u=0.000075 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9995479365043547, 'loss_val': 0.01907929468931483, 'psi': 0.9980809221090275}-{'f1_val': 0.9971029125121428, 'auprc': 0.9995506099701102, 'loss_val': 0.019238128937352144, 'psi': 0.9980819914953298}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=49 head_norm_before_train=1.779486 cos_to_last_merge=0.9095 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.909
[S10] round=49 local utility u=0.000000 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9940778700348354, 'loss_val': 0.03423986991547968, 'psi': 0.9937719418330908}-{'f1_val': 0.9935679896985945, 'auprc': 0.9956475340244936, 'loss_val': 0.035302428363989835, 'psi': 0.9943998074289541}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=49 head_norm_before_train=1.844053 cos_to_last_merge=0.9202 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.920
[S11] round=49 local utility u=0.000000 metrics={'f1_val': 0.9577863675311751, 'auprc': 0.9979956477893551, 'loss_val': 0.10666087947327303, 'psi': 0.973870079634447}-{'f1_val': 0.9638714655816377, 'auprc': 0.9980193368858332, 'loss_val': 0.09408382783285942, 'psi': 0.977530614103316}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=49 head_norm_before_train=1.658189 cos_to_last_merge=0.9321 (last merge round=11)
[S13] ⚠️ Model drifted since last merge! cos=0.932
[S13] round=49 local utility u=0.337883 metrics={'f1_val': 0.5991933122846784, 'auprc': 0.6729389124394701, 'loss_val': 0.6535785093191311, 'psi': 0.628691552346595}-{'f1_val': 0.5387288561346204, 'auprc': 0.6527244532526353, 'loss_val': 0.9059144725832966, 'psi': 0.5843270949818264}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=49 head_norm_before_train=1.851957 cos_to_last_merge=0.9505 (last merge round=16)
[S14] round=49 local utility u=0.000000 metrics={'f1_val': 0.9965760575063591, 'auprc': 0.9961629151296997, 'loss_val': 0.023696026236091246, 'psi': 0.9964108005556953}-{'f1_val': 0.9974082695017256, 'auprc': 0.9955387873984416, 'loss_val': 0.021087224271014067, 'psi': 0.996660476660412}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=49 head_norm_before_train=2.142602 (no previous merge yet)
[S15] round=49 local utility u=0.000000 metrics={'f1_val': 0.9696155723403876, 'auprc': 0.9959272098046648, 'loss_val': 0.05282578367436508, 'psi': 0.9801402273260985}-{'f1_val': 0.9967466683875206, 'auprc': 0.9977809910903166, 'loss_val': 0.023161743859670042, 'psi': 0.9971603974686389}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=49 head_norm_before_train=1.651486 cos_to_last_merge=0.8431 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.843
[S16] round=49 local utility u=0.131571 metrics={'f1_val': 0.8721391550992028, 'auprc': 0.9855954131941103, 'loss_val': 0.6497853307727673, 'psi': 0.9175216583371658}-{'f1_val': 0.8557117107183889, 'auprc': 0.9823283027138867, 'loss_val': 0.8045621146809826, 'psi': 0.9063583475165881}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=49 head_norm_before_train=1.657606 cos_to_last_merge=0.6951 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.695
[S17] round=49 local utility u=0.386418 metrics={'f1_val': 0.6164477693793962, 'auprc': 0.9062357446256846, 'loss_val': 0.6919117880182084, 'psi': 0.7323629594779115}-{'f1_val': 0.6123350217900441, 'auprc': 0.7994272030802206, 'loss_val': 1.1196454144866357, 'psi': 0.6871718943061147}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[runner] rounds complete.
[runner] all agents stopped.
