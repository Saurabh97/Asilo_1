[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:49103
[S3] → join 127.0.0.1:49102
[S4] → join 127.0.0.1:49102
[S5] → join 127.0.0.1:49102
[S6] → join 127.0.0.1:49102
[S7] → join 127.0.0.1:49102
[S8] → join 127.0.0.1:49102
[S9] → join 127.0.0.1:49102
[S10] → join 127.0.0.1:49102
[S11] → join 127.0.0.1:49102
[S13] → join 127.0.0.1:49102
[S14] → join 127.0.0.1:49102
[S15] → join 127.0.0.1:49102
[S16] → join 127.0.0.1:49102
[S17] → join 127.0.0.1:49102
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.129944 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.169807 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.144500 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.201045 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.185626 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.170074 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.146506 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.205376 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.142389 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.141019 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.152351 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.175435 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.235202 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.135789 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.107216 (no previous merge yet)
[S16]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S3] + discovered S13
[S3] + discovered S14
[S3] + discovered S8
[S3] + discovered S10
[S3] + discovered S11
[S3] + discovered S16
[S3] + discovered S7
[S3] + discovered S4
[S3] + discovered S15
[S3] + discovered S9
[S3] + discovered S6
[S3] + discovered S5
[S4] + discovered S2
[S4] + discovered S3
[S3] + discovered S17
[S4] + discovered S14
[S4] + discovered S16
[S4] + discovered S15
[S4] + discovered S6
[S4] + discovered S13
[S4] + discovered S11
[S4] + discovered S5
[S4] + discovered S7
[S4] + discovered S9
[S5] + discovered S4
[S4] + discovered S8
[S4] + discovered S17
[S5] + discovered S3
[S5] + discovered S2
[S4] + discovered S10
[S6] + discovered S2
[S6] + discovered S3
[S5] + discovered S10
[S5] + discovered S17
[S6] + discovered S5
[S5] + discovered S7
[S5] + discovered S6
[S6] + discovered S4
[S5] + discovered S15
[S5] + discovered S11
[S5] + discovered S8
[S5] + discovered S13
[S5] + discovered S16
[S5] + discovered S9
[S5] + discovered S14
[S6] + discovered S8
[S6] + discovered S9
[S6] + discovered S11
[S6] + discovered S16
[S7] + discovered S3
[S6] + discovered S7
[S7] + discovered S6
[S6] + discovered S15
[S6] + discovered S17
[S6] + discovered S10
[S6] + discovered S14
[S7] + discovered S2
[S6] + discovered S13
[S7] + discovered S4
[S7] + discovered S5
[S8] + discovered S4
[S8] + discovered S3
[S7] + discovered S8
[S7] + discovered S17
[S7] + discovered S9
[S7] + discovered S16
[S7] + discovered S10
[S7] + discovered S11
[S7] + discovered S13
[S7] + discovered S14
[S7] + discovered S15
[S8] + discovered S6
[S8] + discovered S7
[S8] + discovered S5
[S8] + discovered S2
[S8] + discovered S16
[S9] + discovered S2
[S9] + discovered S7
[S8] + discovered S11
[S8] + discovered S10
[S8] + discovered S13
[S9] + discovered S4
[S9] + discovered S3
[S9] + discovered S6
[S8] + discovered S9
[S9] + discovered S8
[S9] + discovered S5
[S8] + discovered S14
[S8] + discovered S15
[S8] + discovered S17
[S9] + discovered S17
[S9] + discovered S16
[S9] + discovered S11
[S9] + discovered S10
[S9] + discovered S15
[S9] + discovered S13
[S10] + discovered S2
[S10] + discovered S9
[S10] + discovered S5
[S10] + discovered S8
[S10] + discovered S7
[S10] + discovered S3
[S9] + discovered S14
[S10] + discovered S4
[S10] + discovered S6
[S11] + discovered S4
[S11] + discovered S10
[S11] + discovered S7
[S11] + discovered S8
[S11] + discovered S6
[S11] + discovered S3
[S11] + discovered S5
[S11] + discovered S2
[S10] + discovered S14
[S10] + discovered S13
[S10] + discovered S15
[S10] + discovered S16
[S10] + discovered S11
[S11] + discovered S9
[S10] + discovered S17
[S13] + discovered S4
[S11] + discovered S13
[S13] + discovered S10
[S11] + discovered S15
[S13] + discovered S7
[S11] + discovered S16
[S13] + discovered S5
[S13] + discovered S3
[S11] + discovered S14
[S13] + discovered S6
[S11] + discovered S17
[S13] + discovered S11
[S13] + discovered S9
[S13] + discovered S8
[S13] + discovered S2
[S14] + discovered S4
[S14] + discovered S6
[S13] + discovered S14
[S14] + discovered S8
[S14] + discovered S11
[S14] + discovered S10
[S14] + discovered S2
[S13] + discovered S17
[S13] + discovered S16
[S13] + discovered S15
[S14] + discovered S9
[S14] + discovered S3
[S14] + discovered S13
[S14] + discovered S5
[S14] + discovered S7
[S15] + discovered S8
[S15] + discovered S5
[S15] + discovered S14
[S14] + discovered S17
[S14] + discovered S16
[S14] + discovered S15
[S15] + discovered S4
[S15] + discovered S2
[S15] + discovered S13
[S15] + discovered S10
[S15] + discovered S11
[S15] + discovered S3
[S15] + discovered S9
[S15] + discovered S6
[S15] + discovered S7
[S16] + discovered S6
[S16] + discovered S10
[S16] + discovered S14
[S16] + discovered S5
[S16] + discovered S15
[S16] + discovered S11
[S15] + discovered S16
[S16] + discovered S9
[S16] + discovered S13
[S15] + discovered S17
[S16] + discovered S4
[S16] + discovered S3
[S16] + discovered S8
[S16] + discovered S2
[S16] + discovered S7
[S17] + discovered S8
[S17] + discovered S16
[S17] + discovered S9
[S17] + discovered S4
[S17] + discovered S7
[S17] + discovered S14
[S17] + discovered S5
[S17] + discovered S11
[S17] + discovered S13
[S16] + discovered S17
[S17] + discovered S3
[S17] + discovered S15
[S17] + discovered S10
[S17] + discovered S6
[S17] + discovered S2
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] ⇄ pheromone p=1.000 → S16@127.0.0.1:49116
[S11] ⇄ pheromone p=1.000 → S16@127.0.0.1:49116
[S8] ⇄ pheromone p=1.000 → S13@127.0.0.1:49113
[S16] ⇄ pheromone p=1.000 → S10@127.0.0.1:49111
[S3] ⇄ pheromone p=1.000 → S4@127.0.0.1:49104
[S13] ⇄ pheromone p=1.000 → S11@127.0.0.1:49112
[S6] ⇄ pheromone p=1.000 → S11@127.0.0.1:49112
[S10] ⇄ pheromone p=1.000 → S3@127.0.0.1:49103
[S4] ⇄ pheromone p=1.000 → S7@127.0.0.1:49108
[S2] ⇄ pheromone p=1.000 → S9@127.0.0.1:49110
[S9] ⇄ pheromone p=1.000 → S6@127.0.0.1:49107
[S15] ⇄ pheromone p=1.000 → S2@127.0.0.1:49102
[S7] ⇄ pheromone p=1.000 → S16@127.0.0.1:49116
[S14] ⇄ pheromone p=1.000 → S10@127.0.0.1:49111
[S17] ⇄ pheromone p=1.000 → S4@127.0.0.1:49104
[S2] START round=1 head_norm_before_train=1.134615 (no previous merge yet)
[S2] round=1 local utility u=0.034975 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.5904838607699701, 'loss_val': 1.3167651078046332, 'psi': 0.32125982434112804}-{'f1_val': 0.1417771333885667, 'auprc': 0.5802421810075484, 'loss_val': 1.3559903794259387, 'psi': 0.3171631524361594}
[S3] START round=1 head_norm_before_train=1.175570 (no previous merge yet)
[S3] round=1 local utility u=0.871018 metrics={'f1_val': 0.4009668676591264, 'auprc': 0.637034211865888, 'loss_val': 1.3352306504395768, 'psi': 0.4953938053418311}-{'f1_val': 0.10474797479747974, 'auprc': 0.6626390007308615, 'loss_val': 1.3767673369512148, 'psi': 0.3279043851708324}
[S4] START round=1 head_norm_before_train=1.143842 (no previous merge yet)
[S4] round=1 local utility u=0.224005 metrics={'f1_val': 0.17254206964807023, 'auprc': 0.7712644017218216, 'loss_val': 1.3417881587727203, 'psi': 0.41203100247757085}-{'f1_val': 0.10637591321673677, 'auprc': 0.7665740836175324, 'loss_val': 1.3787312583473748, 'psi': 0.370455181377055}
[S5] START round=1 head_norm_before_train=1.206559 (no previous merge yet)
[S5] round=1 local utility u=0.486696 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7116176066112025, 'loss_val': 1.315004866070242, 'psi': 0.3700041855016239}-{'f1_val': 0.14226190476190476, 'auprc': 0.3969207163149952, 'loss_val': 1.3443069490512174, 'psi': 0.24412542938314094}
[S6] START round=1 head_norm_before_train=1.190989 (no previous merge yet)
[S6] round=1 local utility u=0.983147 metrics={'f1_val': 0.4005363426348238, 'auprc': 0.8286615630929967, 'loss_val': 1.3282604202439174, 'psi': 0.5717864308180929}-{'f1_val': 0.10398230088495575, 'auprc': 0.7766666206743795, 'loss_val': 1.3592444803294366, 'psi': 0.37305602880072525}
[S7] START round=1 head_norm_before_train=1.176556 (no previous merge yet)
[S7] round=1 local utility u=0.232857 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.6669581506762858, 'loss_val': 1.3167734401251947, 'psi': 0.35201735390796934}-{'f1_val': 0.14205682272909165, 'auprc': 0.5220979568297371, 'loss_val': 1.3479074118736483, 'psi': 0.2940732763693499}
[S8] START round=1 head_norm_before_train=1.153727 (no previous merge yet)
[S8] round=1 local utility u=0.000000 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7767637415970583, 'loss_val': 1.3090735729524046, 'psi': 0.3946790860745977}-{'f1_val': 0.39142297119173725, 'auprc': 0.7323959962206685, 'loss_val': 1.3426098911442141, 'psi': 0.5278121812033097}
[S9] START round=1 head_norm_before_train=1.212524 (no previous merge yet)
[S9] round=1 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.7950933644669693, 'loss_val': 1.2874328046561094, 'psi': 0.4028761200707854}-{'f1_val': 0.15533553355335533, 'auprc': 0.793886936803183, 'loss_val': 1.3244767644990711, 'psi': 0.41075609485328646}
[S10] START round=1 head_norm_before_train=1.143964 (no previous merge yet)
[S10] round=1 local utility u=1.000000 metrics={'f1_val': 0.394976092354837, 'auprc': 0.6146921251690001, 'loss_val': 1.3309761430011204, 'psi': 0.48286250548050225}-{'f1_val': 0.10265544041450778, 'auprc': 0.4176666714186838, 'loss_val': 1.3648106251033139, 'psi': 0.2286599328161782}
[S11] START round=1 head_norm_before_train=1.153671 (no previous merge yet)
[S11] round=1 local utility u=0.099917 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.6971842381356212, 'loss_val': 1.310225152771096, 'psi': 0.36312190527811483}-{'f1_val': 0.14041368337311058, 'auprc': 0.64058981367842, 'loss_val': 1.3402761613343492, 'psi': 0.3404841354952344}
[S13] START round=1 head_norm_before_train=1.162567 (no previous merge yet)
[S13] round=1 local utility u=0.000000 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5609693785958932, 'loss_val': 1.3028942706964675, 'psi': 0.30861920898458917}-{'f1_val': 0.1403857625770531, 'auprc': 0.5833727788978655, 'loss_val': 1.3311295138817754, 'psi': 0.3175805691053781}
[S14] START round=1 head_norm_before_train=1.185501 (no previous merge yet)
[S14] round=1 local utility u=0.449360 metrics={'f1_val': 0.3902822179915466, 'auprc': 0.8564386925789519, 'loss_val': 1.3245437004934668, 'psi': 0.5767448078265087}-{'f1_val': 0.30824071473912806, 'auprc': 0.7290818960159968, 'loss_val': 1.3489447459630823, 'psi': 0.4765771872498756}
[S15] START round=1 head_norm_before_train=1.240889 (no previous merge yet)
[S15] round=1 local utility u=0.469886 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.6883156173122978, 'loss_val': 1.3206586387581514, 'psi': 0.35916643774185414}-{'f1_val': 0.13973365136155833, 'auprc': 0.38281133379690474, 'loss_val': 1.3439174492504409, 'psi': 0.23696472433569687}
[S16] START round=1 head_norm_before_train=1.145005 (no previous merge yet)
[S16] round=1 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8653893565066637, 'loss_val': 1.3137748539181489, 'psi': 0.4305382127221874}-{'f1_val': 0.2562316359249517, 'auprc': 0.8624062602399927, 'loss_val': 1.3480839702935283, 'psi': 0.4987014856509681}
[S17] START round=1 head_norm_before_train=1.119783 (no previous merge yet)
[S17] round=1 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.562029166336597, 'loss_val': 1.33744869946064, 'psi': 0.3093810445250694}-{'f1_val': 0.26582728818853907, 'auprc': 0.5370253363889161, 'loss_val': 1.3700526817670593, 'psi': 0.3743065074686899}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S5] → sending delta(kind=head bytes=1788) to S8@127.0.0.1:49109
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S6] → sending delta(kind=head bytes=1786) to S4@127.0.0.1:49104
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] → sending delta(kind=head bytes=1793) to S6@127.0.0.1:49107
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S7] → sending delta(kind=head bytes=1789) to S9@127.0.0.1:49110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S4] → sending delta(kind=head bytes=1788) to S13@127.0.0.1:49113
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:49117
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1784 reason=None
[S15] → sending delta(kind=head bytes=1784) to S2@127.0.0.1:49102
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S14] → sending delta(kind=head bytes=1790) to S17@127.0.0.1:49117
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1784 reason=None
[S10] → sending delta(kind=head bytes=1784) to S17@127.0.0.1:49117
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S11] → sending delta(kind=head bytes=1790) to S2@127.0.0.1:49102
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1790 to 1 peers)
[S10] sending update (kind=head size=1784 to 1 peers)
[S4] sending update (kind=head size=1788 to 1 peers)
[S7] sending update (kind=head size=1789 to 1 peers)
[S15] sending update (kind=head size=1784 to 1 peers)
[S11] sending update (kind=head size=1790 to 1 peers)
[S6] sending update (kind=head size=1786 to 1 peers)
[S5] sending update (kind=head size=1788 to 1 peers)
[S3] sending update (kind=head size=1793 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1799) from S2
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.151400)
[S17] loaded HEAD from S2 (vec_in norm=1.151400)
[S17] cosine check vs S2: cos=-0.0074
[S17] DROPPED delta from S2 (cos=-0.0074 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1786) from S6
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.202561)
[S4] loaded HEAD from S6 (vec_in norm=1.202561)
[S4] cosine check vs S6: cos=0.0435
[S4] BUFFERED delta from S6 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1788) from S4
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.154409)
[S13] loaded HEAD from S4 (vec_in norm=1.154409)
[S13] cosine check vs S4: cos=0.0165
[S13] BUFFERED delta from S4 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1789) from S7
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.192033)
[S9] loaded HEAD from S7 (vec_in norm=1.192033)
[S9] cosine check vs S7: cos=-0.0165
[S9] DROPPED delta from S7 (cos=-0.0165 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1788) from S5
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.216970)
[S8] loaded HEAD from S5 (vec_in norm=1.216970)
[S8] cosine check vs S5: cos=-0.0064
[S8] DROPPED delta from S5 (cos=-0.0064 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1784) from S10
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.153509)
[S17] loaded HEAD from S10 (vec_in norm=1.153509)
[S17] cosine check vs S10: cos=0.0557
[S17] BUFFERED delta from S10 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1793) from S3
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.192759)
[S6] loaded HEAD from S3 (vec_in norm=1.192759)
[S6] cosine check vs S3: cos=-0.0484
[S6] DROPPED delta from S3 (cos=-0.0484 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1790) from S11
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.173658)
[S2] loaded HEAD from S11 (vec_in norm=1.173658)
[S2] cosine check vs S11: cos=0.0143
[S2] BUFFERED delta from S11 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1784) from S15
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.252885)
[S2] loaded HEAD from S15 (vec_in norm=1.252885)
[S2] cosine check vs S15: cos=0.0553
[S2] BUFFERED delta from S15 (total buffered=2)
[S17] RECEIVED delta(kind=head bytes=1790) from S14
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.206589)
[S17] loaded HEAD from S14 (vec_in norm=1.206589)
[S17] cosine check vs S14: cos=-0.0694
[S17] DROPPED delta from S14 (cos=-0.0694 < 0.0)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=1 metric=0.1404 head_norm=1.178860
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.181267e-01
[S13] stored merged vector for next round verification (round=1)
[S13] DEBUG after merge:  round=1 metric=0.1404 head_norm=0.831778 delta_norm=0.818127
[S13] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=1 metric=0.1725 head_norm=1.154409
[S4] _apply_head_vector_avg (torch): Δ‖w‖=8.151878e-01
[S4] stored merged vector for next round verification (round=1)
[S4] DEBUG after merge:  round=1 metric=0.1064 head_norm=0.851396 delta_norm=0.815188
[S4] aggregate: ROLLBACK (f1_val pre=0.173 post=0.106 tol_abs=0.005 tol_rel=0.0)
[S2] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=1 metric=0.1418 head_norm=1.151400
[S2] _apply_head_vector_avg (torch): Δ‖w‖=6.944675e-01
[S2] stored merged vector for next round verification (round=1)
[S2] DEBUG after merge:  round=1 metric=0.1418 head_norm=0.729263 delta_norm=0.694468
[S2] aggregate: ACCEPT kept=['S11', 'S15'] (k=2/2) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=1 metric=0.1409 head_norm=1.141318
[S17] _apply_head_vector_avg (torch): Δ‖w‖=7.884430e-01
[S17] stored merged vector for next round verification (round=1)
[S17] DEBUG after merge:  round=1 metric=0.3803 head_norm=0.833638 delta_norm=0.788443
[S17] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=0.729263 cos_to_last_merge=1.0000 (last merge round=1)
[S2] round=2 local utility u=0.021595 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6016555673165885, 'loss_val': 1.307090129566715, 'psi': 0.32572850695977545}-{'f1_val': 0.1417771333885667, 'auprc': 0.5904838607699701, 'loss_val': 1.3167651078046332, 'psi': 0.32125982434112804}
[S3] START round=2 head_norm_before_train=1.192759 (no previous merge yet)
[S3] round=2 local utility u=0.000000 metrics={'f1_val': 0.1652294580142006, 'auprc': 0.8149433904991609, 'loss_val': 1.2776804103476251, 'psi': 0.42511503100818476}-{'f1_val': 0.4009668676591264, 'auprc': 0.637034211865888, 'loss_val': 1.3352306504395768, 'psi': 0.4953938053418311}
[S4] START round=2 head_norm_before_train=0.851396 cos_to_last_merge=1.0000 (last merge round=1)
[S4] round=2 local utility u=0.622189 metrics={'f1_val': 0.38781344345535096, 'auprc': 0.7522892756311298, 'loss_val': 1.3321138304873503, 'psi': 0.5336037763256625}-{'f1_val': 0.17254206964807023, 'auprc': 0.7712644017218216, 'loss_val': 1.3417881587727203, 'psi': 0.41203100247757085}
[S5] START round=2 head_norm_before_train=1.216970 (no previous merge yet)
[S5] round=2 local utility u=0.040658 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7281736646228656, 'loss_val': 1.2833577261804445, 'psi': 0.3766266087062891}-{'f1_val': 0.14226190476190476, 'auprc': 0.7116176066112025, 'loss_val': 1.315004866070242, 'psi': 0.3700041855016239}
[S6] START round=2 head_norm_before_train=1.202561 (no previous merge yet)
[S6] round=2 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8284925377440833, 'loss_val': 1.2934112020278892, 'psi': 0.4162527843284025}-{'f1_val': 0.4005363426348238, 'auprc': 0.8286615630929967, 'loss_val': 1.3282604202439174, 'psi': 0.5717864308180929}
[S7] START round=2 head_norm_before_train=1.192033 (no previous merge yet)
[S7] round=2 local utility u=0.149430 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7568651642287556, 'loss_val': 1.2876349718775084, 'psi': 0.38798015932895724}-{'f1_val': 0.14205682272909165, 'auprc': 0.6669581506762858, 'loss_val': 1.3167734401251947, 'psi': 0.35201735390796934}
[S8] START round=2 head_norm_before_train=1.167181 (no previous merge yet)
[S8] round=2 local utility u=0.014374 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7728332481775898, 'loss_val': 1.2685332653600525, 'psi': 0.39310688870681026}-{'f1_val': 0.13995598239295717, 'auprc': 0.7767637415970583, 'loss_val': 1.3090735729524046, 'psi': 0.3946790860745977}
[S9] START round=2 head_norm_before_train=1.229890 (no previous merge yet)
[S9] round=2 local utility u=0.025041 metrics={'f1_val': 0.141397957139996, 'auprc': 0.7960586506350833, 'loss_val': 1.240246184856886, 'psi': 0.40326223453803095}-{'f1_val': 0.141397957139996, 'auprc': 0.7950933644669693, 'loss_val': 1.2874328046561094, 'psi': 0.4028761200707854}
[S10] START round=2 head_norm_before_train=1.153509 (no previous merge yet)
[S10] round=2 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6151345167271325, 'loss_val': 1.2912566310700127, 'psi': 0.3292267892158873}-{'f1_val': 0.394976092354837, 'auprc': 0.6146921251690001, 'loss_val': 1.3309761430011204, 'psi': 0.48286250548050225}
[S11] START round=2 head_norm_before_train=1.173658 (no previous merge yet)
[S11] round=2 local utility u=0.177892 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.8028501566236668, 'loss_val': 1.2714383532606266, 'psi': 0.40538827267333305}-{'f1_val': 0.14041368337311058, 'auprc': 0.6971842381356212, 'loss_val': 1.310225152771096, 'psi': 0.36312190527811483}
[S13] START round=2 head_norm_before_train=0.831778 cos_to_last_merge=1.0000 (last merge round=1)
[S13] round=2 local utility u=0.000000 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5464218470264405, 'loss_val': 1.313577569260929, 'psi': 0.30280019635680805}-{'f1_val': 0.1403857625770531, 'auprc': 0.5609693785958932, 'loss_val': 1.3028942706964675, 'psi': 0.30861920898458917}
[S14] START round=2 head_norm_before_train=1.206589 (no previous merge yet)
[S14] round=2 local utility u=0.094520 metrics={'f1_val': 0.4100653578612298, 'auprc': 0.869553178000402, 'loss_val': 1.2935459901417834, 'psi': 0.5938604859168987}-{'f1_val': 0.3902822179915466, 'auprc': 0.8564386925789519, 'loss_val': 1.3245437004934668, 'psi': 0.5767448078265087}
[S15] START round=2 head_norm_before_train=1.252885 (no previous merge yet)
[S15] round=2 local utility u=0.122771 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7633739705620382, 'loss_val': 1.3002911388813037, 'psi': 0.3891897790417503}-{'f1_val': 0.13973365136155833, 'auprc': 0.6883156173122978, 'loss_val': 1.3206586387581514, 'psi': 0.35916643774185414}
[S16] START round=2 head_norm_before_train=1.162550 (no previous merge yet)
[S16] round=2 local utility u=0.019732 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8656326362899824, 'loss_val': 1.2750413139884358, 'psi': 0.4306355246355149}-{'f1_val': 0.14063745019920318, 'auprc': 0.8653893565066637, 'loss_val': 1.3137748539181489, 'psi': 0.4305382127221874}
[S17] START round=2 head_norm_before_train=0.833638 cos_to_last_merge=1.0000 (last merge round=1)
[S17] round=2 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5493961955617896, 'loss_val': 1.3238219560414446, 'psi': 0.30432785621514646}-{'f1_val': 0.14094896331738438, 'auprc': 0.562029166336597, 'loss_val': 1.33744869946064, 'psi': 0.3093810445250694}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1784 reason=None
[S15] → sending delta(kind=head bytes=1784) to S10@127.0.0.1:49111
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:49105
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] → sending delta(kind=head bytes=1793) to S6@127.0.0.1:49107
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S9] → sending delta(kind=head bytes=1791) to S10@127.0.0.1:49111
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S7] → sending delta(kind=head bytes=1790) to S17@127.0.0.1:49117
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:49102
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:49107
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S5] → sending delta(kind=head bytes=1791) to S17@127.0.0.1:49117
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:49115
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:49115
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1784 to 1 peers)
[S11] sending update (kind=head size=1793 to 1 peers)
[S7] sending update (kind=head size=1790 to 1 peers)
[S9] sending update (kind=head size=1791 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1791 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1799) from S16
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.185653)
[S5] loaded HEAD from S16 (vec_in norm=1.185653)
[S5] cosine check vs S16: cos=-0.1249
[S5] DROPPED delta from S16 (cos=-0.1249 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1793) from S11
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.203461)
[S6] loaded HEAD from S11 (vec_in norm=1.203461)
[S6] cosine check vs S11: cos=-0.0868
[S6] DROPPED delta from S11 (cos=-0.0868 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1795) from S14
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.239026)
[S2] loaded HEAD from S14 (vec_in norm=1.239026)
[S2] cosine check vs S14: cos=0.0429
[S2] BUFFERED delta from S14 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1796) from S8
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.189922)
[S15] loaded HEAD from S8 (vec_in norm=1.189922)
[S15] cosine check vs S8: cos=0.1159
[S15] BUFFERED delta from S8 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1784) from S15
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.265181)
[S10] loaded HEAD from S15 (vec_in norm=1.265181)
[S10] cosine check vs S15: cos=0.1447
[S10] BUFFERED delta from S15 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1791) from S5
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.231867)
[S17] loaded HEAD from S5 (vec_in norm=1.231867)
[S17] cosine check vs S5: cos=-0.0110
[S17] DROPPED delta from S5 (cos=-0.0110 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1791) from S9
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.256375)
[S10] loaded HEAD from S9 (vec_in norm=1.256375)
[S10] cosine check vs S9: cos=0.1842
[S10] BUFFERED delta from S9 (total buffered=2)
[S17] RECEIVED delta(kind=head bytes=1790) from S7
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.209834)
[S17] loaded HEAD from S7 (vec_in norm=1.209834)
[S17] cosine check vs S7: cos=-0.0758
[S17] DROPPED delta from S7 (cos=-0.0758 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1801) from S4
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.870137)
[S15] loaded HEAD from S4 (vec_in norm=0.870137)
[S15] cosine check vs S4: cos=0.0899
[S15] BUFFERED delta from S4 (total buffered=2)
[S6] RECEIVED delta(kind=head bytes=1796) from S2
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=0.752813)
[S6] loaded HEAD from S2 (vec_in norm=0.752813)
[S6] cosine check vs S2: cos=0.0786
[S6] BUFFERED delta from S2 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=2 metric=0.1414 head_norm=1.223352
[S6] _apply_head_vector_avg (torch): Δ‖w‖=6.925663e-01
[S6] stored merged vector for next round verification (round=2)
[S6] DEBUG after merge:  round=2 metric=0.1538 head_norm=0.742974 delta_norm=0.692566
[S6] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=2 metric=0.1386 head_norm=1.173852
[S10] _apply_head_vector_avg (torch): Δ‖w‖=6.676308e-01
[S10] stored merged vector for next round verification (round=2)
[S10] DEBUG after merge:  round=2 metric=0.1386 head_norm=0.830099 delta_norm=0.667631
[S10] aggregate: ACCEPT kept=['S15', 'S9'] (k=2/2) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=2 metric=0.1418 head_norm=0.752813
[S2] _apply_head_vector_avg (torch): Δ‖w‖=7.109632e-01
[S2] stored merged vector for next round verification (round=2)
[S2] DEBUG after merge:  round=2 metric=0.1418 head_norm=0.738571 delta_norm=0.710963
[S2] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=2 metric=0.1397 head_norm=1.265181
[S15] _apply_head_vector_avg (torch): Δ‖w‖=6.920148e-01
[S15] stored merged vector for next round verification (round=2)
[S15] DEBUG after merge:  round=2 metric=0.1397 head_norm=0.784615 delta_norm=0.692015
[S15] aggregate: ACCEPT kept=['S8', 'S4'] (k=2/2) mode=median trim_p=0.1
[S2] START round=3 head_norm_before_train=0.738571 cos_to_last_merge=1.0000 (last merge round=2)
[S2] round=3 local utility u=0.016716 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6092575002931988, 'loss_val': 1.2964637829067998, 'psi': 0.32876928015041956}-{'f1_val': 0.1417771333885667, 'auprc': 0.6016555673165885, 'loss_val': 1.307090129566715, 'psi': 0.32572850695977545}
[S3] START round=3 head_norm_before_train=1.217741 (no previous merge yet)
[S3] round=3 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.6129482348207327, 'loss_val': 1.1912870009178378, 'psi': 0.3290833332967573}-{'f1_val': 0.1652294580142006, 'auprc': 0.8149433904991609, 'loss_val': 1.2776804103476251, 'psi': 0.42511503100818476}
[S4] START round=3 head_norm_before_train=0.870137 cos_to_last_merge=0.9964 (last merge round=1)
[S4] round=3 local utility u=0.078293 metrics={'f1_val': 0.40055257978538134, 'auprc': 0.7652560020178102, 'loss_val': 1.2908637725829049, 'psi': 0.5464339486783529}-{'f1_val': 0.38781344345535096, 'auprc': 0.7522892756311298, 'loss_val': 1.3321138304873503, 'psi': 0.5336037763256625}
[S5] START round=3 head_norm_before_train=1.231867 (no previous merge yet)
[S5] round=3 local utility u=0.013968 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7286468415012775, 'loss_val': 1.2568413706253252, 'psi': 0.3768158794576538}-{'f1_val': 0.14226190476190476, 'auprc': 0.7281736646228656, 'loss_val': 1.2833577261804445, 'psi': 0.3766266087062891}
[S6] START round=3 head_norm_before_train=0.742974 cos_to_last_merge=1.0000 (last merge round=2)
[S6] round=3 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.829369843276075, 'loss_val': 1.3023402385668763, 'psi': 0.4166037065411992}-{'f1_val': 0.14142628205128205, 'auprc': 0.8284925377440833, 'loss_val': 1.2934112020278892, 'psi': 0.4162527843284025}
[S7] START round=3 head_norm_before_train=1.209834 (no previous merge yet)
[S7] round=3 local utility u=0.044281 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7756541365422813, 'loss_val': 1.2554400334724627, 'psi': 0.39549574825436756}-{'f1_val': 0.14205682272909165, 'auprc': 0.7568651642287556, 'loss_val': 1.2876349718775084, 'psi': 0.38798015932895724}
[S8] START round=3 head_norm_before_train=1.189922 (no previous merge yet)
[S8] round=3 local utility u=0.032118 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7769857964923413, 'loss_val': 1.2167542364137025, 'psi': 0.3947679080327109}-{'f1_val': 0.13995598239295717, 'auprc': 0.7728332481775898, 'loss_val': 1.2685332653600525, 'psi': 0.39310688870681026}
[S9] START round=3 head_norm_before_train=1.256375 (no previous merge yet)
[S9] round=3 local utility u=0.336420 metrics={'f1_val': 0.141397957139996, 'auprc': 0.999419754247269, 'loss_val': 1.1774886967586136, 'psi': 0.48460667598290524}-{'f1_val': 0.141397957139996, 'auprc': 0.7960586506350833, 'loss_val': 1.240246184856886, 'psi': 0.40326223453803095}
[S10] START round=3 head_norm_before_train=0.830099 cos_to_last_merge=1.0000 (last merge round=2)
[S10] round=3 local utility u=0.030748 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6333638666430688, 'loss_val': 1.284448191209353, 'psi': 0.3365185291822619}-{'f1_val': 0.13862163754172394, 'auprc': 0.6151345167271325, 'loss_val': 1.2912566310700127, 'psi': 0.3292267892158873}
[S11] START round=3 head_norm_before_train=1.203461 (no previous merge yet)
[S11] round=3 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7709164788769529, 'loss_val': 1.2211688066107302, 'psi': 0.3926148015746475}-{'f1_val': 0.14041368337311058, 'auprc': 0.8028501566236668, 'loss_val': 1.2714383532606266, 'psi': 0.40538827267333305}
[S13] START round=3 head_norm_before_train=0.850051 cos_to_last_merge=0.9973 (last merge round=1)
[S13] round=3 local utility u=0.042131 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5620160894396977, 'loss_val': 1.2760983152367769, 'psi': 0.30903789332211096}-{'f1_val': 0.1403857625770531, 'auprc': 0.5464218470264405, 'loss_val': 1.313577569260929, 'psi': 0.30280019635680805}
[S14] START round=3 head_norm_before_train=1.239026 (no previous merge yet)
[S14] round=3 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8410539383749792, 'loss_val': 1.24677704711186, 'psi': 0.420636287079614}-{'f1_val': 0.4100653578612298, 'auprc': 0.869553178000402, 'loss_val': 1.2935459901417834, 'psi': 0.5938604859168987}
[S15] START round=3 head_norm_before_train=0.784615 cos_to_last_merge=1.0000 (last merge round=2)
[S15] round=3 local utility u=0.005688 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7702690423970934, 'loss_val': 1.3095994743985466, 'psi': 0.39194780777577237}-{'f1_val': 0.13973365136155833, 'auprc': 0.7633739705620382, 'loss_val': 1.3002911388813037, 'psi': 0.3891897790417503}
[S16] START round=3 head_norm_before_train=1.185653 (no previous merge yet)
[S16] round=3 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8233195075272495, 'loss_val': 1.228366673083052, 'psi': 0.41371027313042175}-{'f1_val': 0.14063745019920318, 'auprc': 0.8656326362899824, 'loss_val': 1.2750413139884358, 'psi': 0.4306355246355149}
[S17] START round=3 head_norm_before_train=0.858878 cos_to_last_merge=0.9962 (last merge round=1)
[S17] round=3 local utility u=0.040862 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5581569958360361, 'loss_val': 1.2683799203981212, 'psi': 0.30783217632484505}-{'f1_val': 0.14094896331738438, 'auprc': 0.5493961955617896, 'loss_val': 1.3238219560414446, 'psi': 0.30432785621514646}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S9] → sending delta(kind=head bytes=1791) to S6@127.0.0.1:49107
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S7] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:49116
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] → sending delta(kind=head bytes=1793) to S7@127.0.0.1:49108
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:49103
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:49112
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:49110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1785 reason=None
[S5] → sending delta(kind=head bytes=1785) to S16@127.0.0.1:49116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] → sending delta(kind=head bytes=1793) to S2@127.0.0.1:49102
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:49113
[S4] sending update (kind=head size=1793 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1793 to 1 peers)
[S2] sending update (kind=head size=1803 to 1 peers)
[S9] sending update (kind=head size=1791 to 1 peers)
[S5] sending update (kind=head size=1785 to 1 peers)
[S15] sending update (kind=head size=1793 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1802) from S10
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=0.855778)
[S3] loaded HEAD from S10 (vec_in norm=0.855778)
[S3] cosine check vs S10: cos=-0.0497
[S3] DROPPED delta from S10 (cos=-0.0497 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1803) from S2
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=0.755682)
[S9] loaded HEAD from S2 (vec_in norm=0.755682)
[S9] cosine check vs S2: cos=0.0501
[S9] BUFFERED delta from S2 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1785) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.247945)
[S16] loaded HEAD from S5 (vec_in norm=1.247945)
[S16] cosine check vs S5: cos=-0.1181
[S16] DROPPED delta from S5 (cos=-0.1181 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1793) from S7
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.235315)
[S16] loaded HEAD from S7 (vec_in norm=1.235315)
[S16] cosine check vs S7: cos=0.0706
[S16] BUFFERED delta from S7 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1793) from S4
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.898316)
[S7] loaded HEAD from S4 (vec_in norm=0.898316)
[S7] cosine check vs S4: cos=0.0486
[S7] BUFFERED delta from S4 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1791) from S9
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.288295)
[S6] loaded HEAD from S9 (vec_in norm=1.288295)
[S6] cosine check vs S9: cos=0.0769
[S6] BUFFERED delta from S9 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1796) from S8
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.216891)
[S13] loaded HEAD from S8 (vec_in norm=1.216891)
[S13] cosine check vs S8: cos=0.0389
[S13] BUFFERED delta from S8 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1793) from S15
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.803131)
[S2] loaded HEAD from S15 (vec_in norm=0.803131)
[S2] cosine check vs S15: cos=0.3595
[S2] BUFFERED delta from S15 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1797) from S13
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=0.877690)
[S11] loaded HEAD from S13 (vec_in norm=0.877690)
[S11] cosine check vs S13: cos=0.0331
[S11] BUFFERED delta from S13 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:49104
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] sending update (kind=head size=1799 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1799) from S17
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=0.896030)
[S4] loaded HEAD from S17 (vec_in norm=0.896030)
[S4] cosine check vs S17: cos=0.0513
[S4] BUFFERED delta from S17 (total buffered=1)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=3 metric=0.1414 head_norm=0.771084
[S6] _apply_head_vector_avg (torch): Δ‖w‖=7.248132e-01
[S6] stored merged vector for next round verification (round=3)
[S6] DEBUG after merge:  round=3 metric=0.1414 head_norm=0.775747 delta_norm=0.724813
[S6] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=3 metric=0.1404 head_norm=1.237545
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.466546e-01
[S11] stored merged vector for next round verification (round=3)
[S11] DEBUG after merge:  round=3 metric=0.1404 head_norm=0.770347 delta_norm=0.746655
[S11] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=3 metric=0.1421 head_norm=1.235315
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.458546e-01
[S7] stored merged vector for next round verification (round=3)
[S7] DEBUG after merge:  round=3 metric=0.1421 head_norm=0.781146 delta_norm=0.745855
[S7] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=3 metric=0.1414 head_norm=1.288295
[S9] _apply_head_vector_avg (torch): Δ‖w‖=7.302624e-01
[S9] stored merged vector for next round verification (round=3)
[S9] DEBUG after merge:  round=3 metric=0.1414 head_norm=0.762953 delta_norm=0.730262
[S9] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=3 metric=0.1418 head_norm=0.755682
[S2] _apply_head_vector_avg (torch): Δ‖w‖=4.414929e-01
[S2] stored merged vector for next round verification (round=3)
[S2] DEBUG after merge:  round=3 metric=0.1418 head_norm=0.642745 delta_norm=0.441493
[S2] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=3 metric=0.4006 head_norm=0.898316
[S4] _apply_head_vector_avg (torch): Δ‖w‖=6.179137e-01
[S4] stored merged vector for next round verification (round=3)
[S4] DEBUG after merge:  round=3 metric=0.3792 head_norm=0.650464 delta_norm=0.617914
[S4] aggregate: ROLLBACK (f1_val pre=0.401 post=0.379 tol_abs=0.005 tol_rel=0.0)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=3 metric=0.1404 head_norm=0.877690
[S13] _apply_head_vector_avg (torch): Δ‖w‖=7.362139e-01
[S13] stored merged vector for next round verification (round=3)
[S13] DEBUG after merge:  round=3 metric=0.1404 head_norm=0.763918 delta_norm=0.736214
[S13] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=3 metric=0.1406 head_norm=1.213559
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.347297e-01
[S16] stored merged vector for next round verification (round=3)
[S16] DEBUG after merge:  round=3 metric=0.1406 head_norm=0.895875 delta_norm=0.834730
[S16] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=0.642745 cos_to_last_merge=1.0000 (last merge round=3)
[S2] round=4 local utility u=0.177795 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7177000481023799, 'loss_val': 1.2662013387435533, 'psi': 0.372146299274092}-{'f1_val': 0.1417771333885667, 'auprc': 0.6092575002931988, 'loss_val': 1.2964637829067998, 'psi': 0.32876928015041956}
[S3] START round=4 head_norm_before_train=1.248627 (no previous merge yet)
[S3] round=4 local utility u=0.056086 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.6133974409664733, 'loss_val': 1.0804634248489786, 'psi': 0.32926301575505357}-{'f1_val': 0.13984006561410703, 'auprc': 0.6129482348207327, 'loss_val': 1.1912870009178378, 'psi': 0.3290833332967573}
[S4] START round=4 head_norm_before_train=0.650464 cos_to_last_merge=1.0000 (last merge round=3)
[S4] round=4 local utility u=0.703006 metrics={'f1_val': 0.6221777604598517, 'auprc': 0.7820947028671414, 'loss_val': 1.2651192152891937, 'psi': 0.6861445374227677}-{'f1_val': 0.40055257978538134, 'auprc': 0.7652560020178102, 'loss_val': 1.2908637725829049, 'psi': 0.5464339486783529}
[S5] START round=4 head_norm_before_train=1.247945 (no previous merge yet)
[S5] round=4 local utility u=0.012693 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7296682428181773, 'loss_val': 1.2345189325880277, 'psi': 0.3772244399844138}-{'f1_val': 0.14226190476190476, 'auprc': 0.7286468415012775, 'loss_val': 1.2568413706253252, 'psi': 0.3768158794576538}
[S6] START round=4 head_norm_before_train=0.775747 cos_to_last_merge=1.0000 (last merge round=3)
[S6] round=4 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.7841689542131612, 'loss_val': 1.2691775040519315, 'psi': 0.39852335091603375}-{'f1_val': 0.14142628205128205, 'auprc': 0.829369843276075, 'loss_val': 1.3023402385668763, 'psi': 0.4166037065411992}
[S7] START round=4 head_norm_before_train=0.781146 cos_to_last_merge=1.0000 (last merge round=3)
[S7] round=4 local utility u=0.003832 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7789758092729939, 'loss_val': 1.2577419386841557, 'psi': 0.3968244173466526}-{'f1_val': 0.14205682272909165, 'auprc': 0.7756541365422813, 'loss_val': 1.2554400334724627, 'psi': 0.39549574825436756}
[S8] START round=4 head_norm_before_train=1.216891 (no previous merge yet)
[S8] round=4 local utility u=0.753481 metrics={'f1_val': 0.3789508428156918, 'auprc': 0.7771094568229187, 'loss_val': 1.1441329279299688, 'psi': 0.5382142884185825}-{'f1_val': 0.13995598239295717, 'auprc': 0.7769857964923413, 'loss_val': 1.2167542364137025, 'psi': 0.3947679080327109}
[S9] START round=4 head_norm_before_train=0.762953 cos_to_last_merge=1.0000 (last merge round=3)
[S9] round=4 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9999965173981333, 'loss_val': 1.179756667479082, 'psi': 0.484837381243251}-{'f1_val': 0.141397957139996, 'auprc': 0.999419754247269, 'loss_val': 1.1774886967586136, 'psi': 0.48460667598290524}
[S10] START round=4 head_norm_before_train=0.855778 cos_to_last_merge=0.9970 (last merge round=2)
[S10] round=4 local utility u=0.018143 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6334759641818373, 'loss_val': 1.248498809187571, 'psi': 0.3365633681977693}-{'f1_val': 0.13862163754172394, 'auprc': 0.6333638666430688, 'loss_val': 1.284448191209353, 'psi': 0.3365185291822619}
[S11] START round=4 head_norm_before_train=0.770347 cos_to_last_merge=1.0000 (last merge round=3)
[S11] round=4 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7649588275577653, 'loss_val': 1.2181273118277431, 'psi': 0.3902317410469725}-{'f1_val': 0.14041368337311058, 'auprc': 0.7709164788769529, 'loss_val': 1.2211688066107302, 'psi': 0.3926148015746475}
[S13] START round=4 head_norm_before_train=0.763918 cos_to_last_merge=1.0000 (last merge round=3)
[S13] round=4 local utility u=0.000000 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5262178132986984, 'loss_val': 1.2679926835050566, 'psi': 0.29471858286571123}-{'f1_val': 0.1403857625770531, 'auprc': 0.5620160894396977, 'loss_val': 1.2760983152367769, 'psi': 0.30903789332211096}
[S14] START round=4 head_norm_before_train=1.282869 (no previous merge yet)
[S14] round=4 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.6484052690617769, 'loss_val': 1.184474622533846, 'psi': 0.343576819354333}-{'f1_val': 0.14035785288270378, 'auprc': 0.8410539383749792, 'loss_val': 1.24677704711186, 'psi': 0.420636287079614}
[S15] START round=4 head_norm_before_train=0.803131 cos_to_last_merge=0.9978 (last merge round=2)
[S15] round=4 local utility u=0.022839 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7750463646599701, 'loss_val': 1.278252639932452, 'psi': 0.3938587366809231}-{'f1_val': 0.13973365136155833, 'auprc': 0.7702690423970934, 'loss_val': 1.3095994743985466, 'psi': 0.39194780777577237}
[S16] START round=4 head_norm_before_train=0.895875 cos_to_last_merge=1.0000 (last merge round=3)
[S16] round=4 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8141624145725723, 'loss_val': 1.2183830494470156, 'psi': 0.41004743594855086}-{'f1_val': 0.14063745019920318, 'auprc': 0.8233195075272495, 'loss_val': 1.228366673083052, 'psi': 0.41371027313042175}
[S17] START round=4 head_norm_before_train=0.896030 cos_to_last_merge=0.9855 (last merge round=1)
[S17] round=4 local utility u=0.033547 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5550700425666626, 'loss_val': 1.1920254029978001, 'psi': 0.3065973950170957}-{'f1_val': 0.14094896331738438, 'auprc': 0.5581569958360361, 'loss_val': 1.2683799203981212, 'psi': 0.30783217632484505}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:49108
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S5] → sending delta(kind=head bytes=1791) to S16@127.0.0.1:49116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:49110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:49113
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:49116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:49102
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:49103
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:49104
[S3] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1791 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1791) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.262764)
[S16] loaded HEAD from S5 (vec_in norm=1.262764)
[S16] cosine check vs S5: cos=-0.0576
[S16] DROPPED delta from S5 (cos=-0.0576 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1802) from S10
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=0.879712)
[S3] loaded HEAD from S10 (vec_in norm=0.879712)
[S3] cosine check vs S10: cos=-0.0515
[S3] DROPPED delta from S10 (cos=-0.0515 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1798) from S7
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.809540)
[S16] loaded HEAD from S7 (vec_in norm=0.809540)
[S16] cosine check vs S7: cos=0.6166
[S16] BUFFERED delta from S7 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1795) from S8
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.247709)
[S13] loaded HEAD from S8 (vec_in norm=1.247709)
[S13] cosine check vs S8: cos=0.7958
[S13] BUFFERED delta from S8 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1798) from S2
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=0.662731)
[S9] loaded HEAD from S2 (vec_in norm=0.662731)
[S9] cosine check vs S2: cos=0.4724
[S9] BUFFERED delta from S2 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1802) from S3
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.280788)
[S4] loaded HEAD from S3 (vec_in norm=1.280788)
[S4] cosine check vs S3: cos=-0.1394
[S4] DROPPED delta from S3 (cos=-0.1394 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1795) from S15
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.830857)
[S2] loaded HEAD from S15 (vec_in norm=0.830857)
[S2] cosine check vs S15: cos=0.8175
[S2] BUFFERED delta from S15 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1798) from S4
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.687387)
[S7] loaded HEAD from S4 (vec_in norm=0.687387)
[S7] cosine check vs S4: cos=0.4045
[S7] BUFFERED delta from S4 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:49104
[S17] sending update (kind=head size=1799 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1799) from S17
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=0.938665)
[S4] loaded HEAD from S17 (vec_in norm=0.938665)
[S4] cosine check vs S17: cos=0.6976
[S4] BUFFERED delta from S17 (total buffered=1)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=4 metric=0.1414 head_norm=0.800010
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.802391e-01
[S9] stored merged vector for next round verification (round=4)
[S9] DEBUG after merge:  round=4 metric=0.1414 head_norm=0.628516 delta_norm=0.380239
[S9] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=4 metric=0.1404 head_norm=0.788457
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.913991e-01
[S13] stored merged vector for next round verification (round=4)
[S13] DEBUG after merge:  round=4 metric=0.1404 head_norm=0.967485 delta_norm=0.391399
[S13] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=4 metric=0.1406 head_norm=0.921339
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.822190e-01
[S16] stored merged vector for next round verification (round=4)
[S16] DEBUG after merge:  round=4 metric=0.1406 head_norm=0.778472 delta_norm=0.382219
[S16] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=4 metric=0.1418 head_norm=0.662731
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.393821e-01
[S2] stored merged vector for next round verification (round=4)
[S2] DEBUG after merge:  round=4 metric=0.1655 head_norm=0.712365 delta_norm=0.239382
[S2] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=4 metric=0.6222 head_norm=0.687387
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.366740e-01
[S4] stored merged vector for next round verification (round=4)
[S4] DEBUG after merge:  round=4 metric=0.6842 head_norm=0.750631 delta_norm=0.336674
[S4] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=4 metric=0.1421 head_norm=0.809540
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.116176e-01
[S7] stored merged vector for next round verification (round=4)
[S7] DEBUG after merge:  round=4 metric=0.1421 head_norm=0.628092 delta_norm=0.411618
[S7] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=5 head_norm_before_train=0.712365 cos_to_last_merge=1.0000 (last merge round=4)
[S2] round=5 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6122079789283731, 'loss_val': 1.2135387520985474, 'psi': 0.3299494716044893}-{'f1_val': 0.1417771333885667, 'auprc': 0.7177000481023799, 'loss_val': 1.2662013387435533, 'psi': 0.372146299274092}
[S3] START round=5 head_norm_before_train=1.280788 (no previous merge yet)
[S3] round=5 local utility u=1.000000 metrics={'f1_val': 0.39626584025733846, 'auprc': 0.7959315542921358, 'loss_val': 0.9295003918275804, 'psi': 0.5561321258712574}-{'f1_val': 0.13984006561410703, 'auprc': 0.6133974409664733, 'loss_val': 1.0804634248489786, 'psi': 0.32926301575505357}
[S4] START round=5 head_norm_before_train=0.750631 cos_to_last_merge=1.0000 (last merge round=4)
[S4] round=5 local utility u=0.000000 metrics={'f1_val': 0.3900935064093215, 'auprc': 0.7635999687194751, 'loss_val': 1.1882099043509156, 'psi': 0.5394960913333829}-{'f1_val': 0.6221777604598517, 'auprc': 0.7820947028671414, 'loss_val': 1.2651192152891937, 'psi': 0.6861445374227677}
[S5] START round=5 head_norm_before_train=1.262764 (no previous merge yet)
[S5] round=5 local utility u=0.056735 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7549483277650407, 'loss_val': 1.196889972733044, 'psi': 0.3873364739631592}-{'f1_val': 0.14226190476190476, 'auprc': 0.7296682428181773, 'loss_val': 1.2345189325880277, 'psi': 0.3772244399844138}
[S6] START round=5 head_norm_before_train=0.803221 cos_to_last_merge=0.9956 (last merge round=3)
[S6] round=5 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.7320349190270989, 'loss_val': 1.2061236279728187, 'psi': 0.3776697368416088}-{'f1_val': 0.14142628205128205, 'auprc': 0.7841689542131612, 'loss_val': 1.2691775040519315, 'psi': 0.39852335091603375}
[S7] START round=5 head_norm_before_train=0.628092 cos_to_last_merge=1.0000 (last merge round=4)
[S7] round=5 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.766132578324779, 'loss_val': 1.2670900943438748, 'psi': 0.39168712496736663}-{'f1_val': 0.14205682272909165, 'auprc': 0.7789758092729939, 'loss_val': 1.2577419386841557, 'psi': 0.3968244173466526}
[S8] START round=5 head_norm_before_train=1.247709 (no previous merge yet)
[S8] round=5 local utility u=0.188726 metrics={'f1_val': 0.4217907183616708, 'auprc': 0.7770916066742835, 'loss_val': 1.0236670829492007, 'psi': 0.5639110736867159}-{'f1_val': 0.3789508428156918, 'auprc': 0.7771094568229187, 'loss_val': 1.1441329279299688, 'psi': 0.5382142884185825}
[S9] START round=5 head_norm_before_train=0.628516 cos_to_last_merge=1.0000 (last merge round=4)
[S9] round=5 local utility u=0.094553 metrics={'f1_val': 0.19656326352160547, 'auprc': 0.9420545366048443, 'loss_val': 1.1478169889029666, 'psi': 0.494759772754901}-{'f1_val': 0.141397957139996, 'auprc': 0.9999965173981333, 'loss_val': 1.179756667479082, 'psi': 0.484837381243251}
[S10] START round=5 head_norm_before_train=0.879712 cos_to_last_merge=0.9909 (last merge round=2)
[S10] round=5 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.60979805492038, 'loss_val': 1.1955054385537927, 'psi': 0.3270922044931863}-{'f1_val': 0.13862163754172394, 'auprc': 0.6334759641818373, 'loss_val': 1.248498809187571, 'psi': 0.3365633681977693}
[S11] START round=5 head_norm_before_train=0.808023 cos_to_last_merge=0.9968 (last merge round=3)
[S11] round=5 local utility u=0.042114 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7651760190936192, 'loss_val': 1.1345505051369478, 'psi': 0.39031861766131404}-{'f1_val': 0.14041368337311058, 'auprc': 0.7649588275577653, 'loss_val': 1.2181273118277431, 'psi': 0.3902317410469725}
[S13] START round=5 head_norm_before_train=0.967485 cos_to_last_merge=1.0000 (last merge round=4)
[S13] round=5 local utility u=0.027019 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5351463642489485, 'loss_val': 1.2407411781746844, 'psi': 0.29829000324581123}-{'f1_val': 0.1403857625770531, 'auprc': 0.5262178132986984, 'loss_val': 1.2679926835050566, 'psi': 0.29471858286571123}
[S14] START round=5 head_norm_before_train=1.334452 (no previous merge yet)
[S14] round=5 local utility u=0.822519 metrics={'f1_val': 0.39656053564365834, 'auprc': 0.6530489314612239, 'loss_val': 1.090583830283167, 'psi': 0.4991558939706846}-{'f1_val': 0.14035785288270378, 'auprc': 0.6484052690617769, 'loss_val': 1.184474622533846, 'psi': 0.343576819354333}
[S15] START round=5 head_norm_before_train=0.830857 cos_to_last_merge=0.9913 (last merge round=2)
[S15] round=5 local utility u=0.018150 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7757311867974057, 'loss_val': 1.2440072155580244, 'psi': 0.3941326655358973}-{'f1_val': 0.13973365136155833, 'auprc': 0.7750463646599701, 'loss_val': 1.278252639932452, 'psi': 0.3938587366809231}
[S16] START round=5 head_norm_before_train=0.778472 cos_to_last_merge=1.0000 (last merge round=4)
[S16] round=5 local utility u=0.003366 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8060156897240551, 'loss_val': 1.187211260115602, 'psi': 0.40678874600914394}-{'f1_val': 0.14063745019920318, 'auprc': 0.8141624145725723, 'loss_val': 1.2183830494470156, 'psi': 0.41004743594855086}
[S17] START round=5 head_norm_before_train=0.938665 cos_to_last_merge=0.9717 (last merge round=1)
[S17] round=5 local utility u=0.816249 metrics={'f1_val': 0.3900403966470958, 'auprc': 0.560220646774162, 'loss_val': 1.069528551015077, 'psi': 0.4581124966979222}-{'f1_val': 0.14094896331738438, 'auprc': 0.5550700425666626, 'loss_val': 1.1920254029978001, 'psi': 0.3065973950170957}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S15] → sending delta(kind=head bytes=1790) to S2@127.0.0.1:49102
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S5] → sending delta(kind=head bytes=1790) to S16@127.0.0.1:49116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:49111
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:49107
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S13] → sending delta(kind=head bytes=1792) to S11@127.0.0.1:49112
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:49116
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] → sending delta(kind=head bytes=1794) to S10@127.0.0.1:49111
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:49113
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:49104
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S13] sending update (kind=head size=1792 to 1 peers)
[S15] sending update (kind=head size=1790 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1790 to 1 peers)
[S16] sending update (kind=head size=1794 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1790) from S15
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.860767)
[S2] loaded HEAD from S15 (vec_in norm=0.860767)
[S2] cosine check vs S15: cos=0.9429
[S2] BUFFERED delta from S15 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1790) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.276876)
[S16] loaded HEAD from S5 (vec_in norm=1.276876)
[S16] cosine check vs S5: cos=-0.0312
[S16] DROPPED delta from S5 (cos=-0.0312 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1795) from S3
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.317106)
[S4] loaded HEAD from S3 (vec_in norm=1.317106)
[S4] cosine check vs S3: cos=-0.1160
[S4] DROPPED delta from S3 (cos=-0.1160 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1800) from S8
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.286787)
[S13] loaded HEAD from S8 (vec_in norm=1.286787)
[S13] cosine check vs S8: cos=0.9565
[S13] BUFFERED delta from S8 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1794) from S16
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.802488)
[S10] loaded HEAD from S16 (vec_in norm=0.802488)
[S10] cosine check vs S16: cos=0.0197
[S10] BUFFERED delta from S16 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1800) from S9
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.666117)
[S6] loaded HEAD from S9 (vec_in norm=0.666117)
[S6] cosine check vs S9: cos=0.6876
[S6] BUFFERED delta from S9 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1792) from S13
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=0.980963)
[S11] loaded HEAD from S13 (vec_in norm=0.980963)
[S11] cosine check vs S13: cos=0.1825
[S11] BUFFERED delta from S13 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1796) from S11
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=0.851937)
[S16] loaded HEAD from S11 (vec_in norm=0.851937)
[S16] cosine check vs S11: cos=0.1269
[S16] BUFFERED delta from S11 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1800) from S14
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.383911)
[S10] loaded HEAD from S14 (vec_in norm=1.383911)
[S10] cosine check vs S14: cos=0.0389
[S10] BUFFERED delta from S14 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:49104
[S17] sending update (kind=head size=1798 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1798) from S17
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=0.978891)
[S4] loaded HEAD from S17 (vec_in norm=0.978891)
[S4] cosine check vs S17: cos=0.9166
[S4] BUFFERED delta from S17 (total buffered=1)
[S7] ⇄ pheromone p=0.368 → S16@127.0.0.1:49116
[S10] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=5 metric=0.1386 head_norm=0.907452
[S10] _apply_head_vector_avg (torch): Δ‖w‖=6.029187e-01
[S10] stored merged vector for next round verification (round=5)
[S10] DEBUG after merge:  round=5 metric=0.1386 head_norm=0.628564 delta_norm=0.602919
[S10] aggregate: ACCEPT kept=['S16', 'S14'] (k=2/2) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.416 → S3@127.0.0.1:49103
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=5 metric=0.1418 head_norm=0.735278
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.483299e-01
[S2] stored merged vector for next round verification (round=5)
[S2] DEBUG after merge:  round=5 metric=0.1624 head_norm=0.786622 delta_norm=0.148330
[S2] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.363 → S9@127.0.0.1:49110
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=5 metric=0.3901 head_norm=0.784362
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.037000e-01
[S4] stored merged vector for next round verification (round=5)
[S4] DEBUG after merge:  round=5 metric=0.4168 head_norm=0.863268 delta_norm=0.203700
[S4] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.532 → S7@127.0.0.1:49108
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=5 metric=0.1414 head_norm=0.838252
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.076106e-01
[S6] stored merged vector for next round verification (round=5)
[S6] DEBUG after merge:  round=5 metric=0.1414 head_norm=0.691784 delta_norm=0.307611
[S6] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.408 → S11@127.0.0.1:49112
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=5 metric=0.1406 head_norm=0.802488
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.468735e-01
[S16] stored merged vector for next round verification (round=5)
[S16] DEBUG after merge:  round=5 metric=0.1406 head_norm=0.621145 delta_norm=0.546873
[S16] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.330 → S10@127.0.0.1:49111
[S5] ⇄ pheromone p=0.387 → S16@127.0.0.1:49116
[S9] ⇄ pheromone p=0.392 → S6@127.0.0.1:49107
[S15] ⇄ pheromone p=0.387 → S2@127.0.0.1:49102
[S3] ⇄ pheromone p=0.608 → S4@127.0.0.1:49104
[S14] ⇄ pheromone p=0.539 → S10@127.0.0.1:49111
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=5 metric=0.1404 head_norm=0.980963
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.254905e-01
[S13] stored merged vector for next round verification (round=5)
[S13] DEBUG after merge:  round=5 metric=0.1404 head_norm=1.121699 delta_norm=0.225490
[S13] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.338 → S11@127.0.0.1:49112
[S8] ⇄ pheromone p=0.492 → S13@127.0.0.1:49113
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=5 metric=0.1404 head_norm=0.851937
[S11] _apply_head_vector_avg (torch): Δ‖w‖=5.880048e-01
[S11] stored merged vector for next round verification (round=5)
[S11] DEBUG after merge:  round=5 metric=0.1404 head_norm=0.705899 delta_norm=0.588005
[S11] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.363 → S16@127.0.0.1:49116
[S17] ⇄ pheromone p=0.502 → S4@127.0.0.1:49104
[S2] START round=6 head_norm_before_train=0.786622 cos_to_last_merge=1.0000 (last merge round=5)
[S2] round=6 local utility u=0.105936 metrics={'f1_val': 0.16707346839150597, 'auprc': 0.6101413474272277, 'loss_val': 1.1472454187016277, 'psi': 0.34430062000579464}-{'f1_val': 0.1417771333885667, 'auprc': 0.6122079789283731, 'loss_val': 1.2135387520985474, 'psi': 0.3299494716044893}
[S3] START round=6 head_norm_before_train=1.317106 (no previous merge yet)
[S3] round=6 local utility u=0.068738 metrics={'f1_val': 0.4010090932274478, 'auprc': 0.7961929404420287, 'loss_val': 0.8212676619526732, 'psi': 0.5590826321132801}-{'f1_val': 0.39626584025733846, 'auprc': 0.7959315542921358, 'loss_val': 0.9295003918275804, 'psi': 0.5561321258712574}
[S4] START round=6 head_norm_before_train=0.863268 cos_to_last_merge=1.0000 (last merge round=5)
[S4] round=6 local utility u=0.130810 metrics={'f1_val': 0.4148091473984988, 'auprc': 0.761462361338798, 'loss_val': 1.0684718761983028, 'psi': 0.5534704329746185}-{'f1_val': 0.3900935064093215, 'auprc': 0.7635999687194751, 'loss_val': 1.1882099043509156, 'psi': 0.5394960913333829}
[S5] START round=6 head_norm_before_train=1.276876 (no previous merge yet)
[S5] round=6 local utility u=0.101074 metrics={'f1_val': 0.15730708332595333, 'auprc': 0.7718586058303466, 'loss_val': 1.1357430164781388, 'psi': 0.4031276923277107}-{'f1_val': 0.14226190476190476, 'auprc': 0.7549483277650407, 'loss_val': 1.196889972733044, 'psi': 0.3873364739631592}
[S6] START round=6 head_norm_before_train=0.691784 cos_to_last_merge=1.0000 (last merge round=5)
[S6] round=6 local utility u=0.698230 metrics={'f1_val': 0.4150420236907487, 'auprc': 0.6294385299210837, 'loss_val': 1.1435679930687754, 'psi': 0.5008006261828828}-{'f1_val': 0.14142628205128205, 'auprc': 0.7320349190270989, 'loss_val': 1.2061236279728187, 'psi': 0.3776697368416088}
[S7] START round=6 head_norm_before_train=0.651232 cos_to_last_merge=0.9965 (last merge round=4)
[S7] round=6 local utility u=0.049142 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7860244679856773, 'loss_val': 1.2284809695645802, 'psi': 0.3996438808317259}-{'f1_val': 0.14205682272909165, 'auprc': 0.766132578324779, 'loss_val': 1.2670900943438748, 'psi': 0.39168712496736663}
[S8] START round=6 head_norm_before_train=1.286787 (no previous merge yet)
[S8] round=6 local utility u=0.000000 metrics={'f1_val': 0.39142700823716925, 'auprc': 0.7771082287440579, 'loss_val': 0.8875020671188322, 'psi': 0.5456994964399247}-{'f1_val': 0.4217907183616708, 'auprc': 0.7770916066742835, 'loss_val': 1.0236670829492007, 'psi': 0.5639110736867159}
[S9] START round=6 head_norm_before_train=0.666117 cos_to_last_merge=0.9944 (last merge round=4)
[S9] round=6 local utility u=0.795421 metrics={'f1_val': 0.41685404846439245, 'auprc': 0.9845963723211822, 'loss_val': 1.0063457725063738, 'psi': 0.6439509780071084}-{'f1_val': 0.19656326352160547, 'auprc': 0.9420545366048443, 'loss_val': 1.1478169889029666, 'psi': 0.494759772754901}
[S10] START round=6 head_norm_before_train=0.628564 cos_to_last_merge=1.0000 (last merge round=5)
[S10] round=6 local utility u=0.015586 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6130844137195968, 'loss_val': 1.174192061039086, 'psi': 0.32840674801287306}-{'f1_val': 0.13862163754172394, 'auprc': 0.60979805492038, 'loss_val': 1.1955054385537927, 'psi': 0.3270922044931863}
[S11] START round=6 head_norm_before_train=0.705899 cos_to_last_merge=1.0000 (last merge round=5)
[S11] round=6 local utility u=0.905036 metrics={'f1_val': 0.42273739039721175, 'auprc': 0.7837048076089534, 'loss_val': 1.0740076867225115, 'psi': 0.5671243572819085}-{'f1_val': 0.14041368337311058, 'auprc': 0.7651760190936192, 'loss_val': 1.1345505051369478, 'psi': 0.39031861766131404}
[S13] START round=6 head_norm_before_train=1.121699 cos_to_last_merge=1.0000 (last merge round=5)
[S13] round=6 local utility u=0.047950 metrics={'f1_val': 0.14299127802384587, 'auprc': 0.544576850736037, 'loss_val': 1.1887648225075478, 'psi': 0.3036255071087223}-{'f1_val': 0.1403857625770531, 'auprc': 0.5351463642489485, 'loss_val': 1.2407411781746844, 'psi': 0.29829000324581123}
[S14] START round=6 head_norm_before_train=1.383911 (no previous merge yet)
[S14] round=6 local utility u=0.238576 metrics={'f1_val': 0.3964292957175209, 'auprc': 0.7695337466990168, 'loss_val': 0.9620982775564791, 'psi': 0.5456710761101192}-{'f1_val': 0.39656053564365834, 'auprc': 0.6530489314612239, 'loss_val': 1.090583830283167, 'psi': 0.4991558939706846}
[S15] START round=6 head_norm_before_train=0.860767 cos_to_last_merge=0.9824 (last merge round=2)
[S15] round=6 local utility u=0.021830 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7762607288454667, 'loss_val': 1.2019366041382678, 'psi': 0.3943444823551217}-{'f1_val': 0.13973365136155833, 'auprc': 0.7757311867974057, 'loss_val': 1.2440072155580244, 'psi': 0.3941326655358973}
[S16] START round=6 head_norm_before_train=0.621145 cos_to_last_merge=1.0000 (last merge round=5)
[S16] round=6 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.6148056547320283, 'loss_val': 1.1582506500937706, 'psi': 0.33030473201233324}-{'f1_val': 0.14063745019920318, 'auprc': 0.8060156897240551, 'loss_val': 1.187211260115602, 'psi': 0.40678874600914394}
[S17] START round=6 head_norm_before_train=0.978891 cos_to_last_merge=0.9572 (last merge round=1)
[S17] round=6 local utility u=0.102813 metrics={'f1_val': 0.392174807429541, 'auprc': 0.5952972038075011, 'loss_val': 0.9819392959686021, 'psi': 0.473423765980725}-{'f1_val': 0.3900403966470958, 'auprc': 0.560220646774162, 'loss_val': 1.069528551015077, 'psi': 0.4581124966979222}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:49112
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:49104
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:49103
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:49107
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:49116
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] → sending delta(kind=head bytes=1793) to S9@127.0.0.1:49110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] → sending delta(kind=head bytes=1794) to S11@127.0.0.1:49112
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:49111
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] → sending delta(kind=head bytes=1794) to S2@127.0.0.1:49102
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:49116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] → sending delta(kind=head bytes=1805) to S16@127.0.0.1:49116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:49108
[S2] sending update (kind=head size=1793 to 1 peers)
[S15] sending update (kind=head size=1794 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1794 to 1 peers)
[S11] sending update (kind=head size=1805 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1795 to 1 peers)
[S3] sending update (kind=head size=1803 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1793) from S2
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=0.811305)
[S9] loaded HEAD from S2 (vec_in norm=0.811305)
[S9] cosine check vs S2: cos=0.6379
[S9] BUFFERED delta from S2 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1798) from S9
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.709646)
[S6] loaded HEAD from S9 (vec_in norm=0.709646)
[S6] cosine check vs S9: cos=0.8751
[S6] BUFFERED delta from S9 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1801) from S14
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.435950)
[S10] loaded HEAD from S14 (vec_in norm=1.435950)
[S10] cosine check vs S14: cos=0.5770
[S10] BUFFERED delta from S14 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1794) from S15
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.891165)
[S2] loaded HEAD from S15 (vec_in norm=0.891165)
[S2] cosine check vs S15: cos=0.9698
[S2] BUFFERED delta from S15 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1800) from S10
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=0.660709)
[S3] loaded HEAD from S10 (vec_in norm=0.660709)
[S3] cosine check vs S10: cos=-0.1265
[S3] DROPPED delta from S10 (cos=-0.1265 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1803) from S3
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.358718)
[S4] loaded HEAD from S3 (vec_in norm=1.358718)
[S4] cosine check vs S3: cos=-0.1030
[S4] DROPPED delta from S3 (cos=-0.1030 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1795) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.724961)
[S11] loaded HEAD from S6 (vec_in norm=0.724961)
[S11] cosine check vs S6: cos=0.1485
[S11] BUFFERED delta from S6 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1799) from S4
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.896238)
[S7] loaded HEAD from S4 (vec_in norm=0.896238)
[S7] cosine check vs S4: cos=0.4845
[S7] BUFFERED delta from S4 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1794) from S13
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.130821)
[S11] loaded HEAD from S13 (vec_in norm=1.130821)
[S11] cosine check vs S13: cos=0.7237
[S11] BUFFERED delta from S13 (total buffered=2)
[S16] RECEIVED delta(kind=head bytes=1800) from S7
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.673088)
[S16] loaded HEAD from S7 (vec_in norm=0.673088)
[S16] cosine check vs S7: cos=0.5595
[S16] BUFFERED delta from S7 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1796) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.289581)
[S16] loaded HEAD from S5 (vec_in norm=1.289581)
[S16] cosine check vs S5: cos=-0.0365
[S16] DROPPED delta from S5 (cos=-0.0365 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1805) from S11
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=0.741714)
[S16] loaded HEAD from S11 (vec_in norm=0.741714)
[S16] cosine check vs S11: cos=0.5832
[S16] BUFFERED delta from S11 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:49104
[S17] sending update (kind=head size=1800 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1800) from S17
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.024863)
[S4] loaded HEAD from S17 (vec_in norm=1.024863)
[S4] cosine check vs S17: cos=0.9602
[S4] BUFFERED delta from S17 (total buffered=1)
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=6 metric=0.1406 head_norm=0.652411
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.214848e-01
[S16] stored merged vector for next round verification (round=6)
[S16] DEBUG after merge:  round=6 metric=0.1406 head_norm=0.559474 delta_norm=0.221485
[S16] aggregate: ACCEPT kept=['S7', 'S11'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=6 metric=0.4169 head_norm=0.709646
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.268481e-01
[S9] stored merged vector for next round verification (round=6)
[S9] DEBUG after merge:  round=6 metric=0.4169 head_norm=0.688533 delta_norm=0.326848
[S9] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=6 metric=0.4148 head_norm=0.896238
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.496836e-01
[S4] stored merged vector for next round verification (round=6)
[S4] DEBUG after merge:  round=6 metric=0.4174 head_norm=0.950993 delta_norm=0.149684
[S4] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=6 metric=0.1671 head_norm=0.811305
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.117938e-01
[S2] stored merged vector for next round verification (round=6)
[S2] DEBUG after merge:  round=6 metric=0.1672 head_norm=0.844806 delta_norm=0.111794
[S2] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=6 metric=0.1386 head_norm=0.660709
[S10] _apply_head_vector_avg (torch): Δ‖w‖=5.923820e-01
[S10] stored merged vector for next round verification (round=6)
[S10] DEBUG after merge:  round=6 metric=0.1712 head_norm=0.947802 delta_norm=0.592382
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=6 metric=0.1421 head_norm=0.673088
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.098119e-01
[S7] stored merged vector for next round verification (round=6)
[S7] DEBUG after merge:  round=6 metric=0.1043 head_norm=0.678380 delta_norm=0.409812
[S7] aggregate: ROLLBACK (f1_val pre=0.142 post=0.104 tol_abs=0.005 tol_rel=0.0)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=6 metric=0.4150 head_norm=0.724961
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.793990e-01
[S6] stored merged vector for next round verification (round=6)
[S6] DEBUG after merge:  round=6 metric=0.4167 head_norm=0.694550 delta_norm=0.179399
[S6] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=6 metric=0.4227 head_norm=0.741714
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.139693e-01
[S11] stored merged vector for next round verification (round=6)
[S11] DEBUG after merge:  round=6 metric=0.1404 head_norm=0.664842 delta_norm=0.313969
[S11] aggregate: ROLLBACK (f1_val pre=0.423 post=0.140 tol_abs=0.005 tol_rel=0.0)
[S2] START round=7 head_norm_before_train=0.844806 cos_to_last_merge=1.0000 (last merge round=6)
[S2] round=7 local utility u=1.000000 metrics={'f1_val': 0.4160872254026517, 'auprc': 0.7591740383108496, 'loss_val': 1.0564159171162961, 'psi': 0.5533219505659309}-{'f1_val': 0.16707346839150597, 'auprc': 0.6101413474272277, 'loss_val': 1.1472454187016277, 'psi': 0.34430062000579464}
[S3] START round=7 head_norm_before_train=1.358718 (no previous merge yet)
[S3] round=7 local utility u=0.349945 metrics={'f1_val': 0.401708470248874, 'auprc': 0.9978792212959817, 'loss_val': 0.7306332965350194, 'psi': 0.640176770667717}-{'f1_val': 0.4010090932274478, 'auprc': 0.7961929404420287, 'loss_val': 0.8212676619526732, 'psi': 0.5590826321132801}
[S4] START round=7 head_norm_before_train=0.950993 cos_to_last_merge=1.0000 (last merge round=6)
[S4] round=7 local utility u=0.865875 metrics={'f1_val': 0.6812310194558018, 'auprc': 0.7597675136371553, 'loss_val': 0.9301678834457039, 'psi': 0.7126456171283433}-{'f1_val': 0.4148091473984988, 'auprc': 0.761462361338798, 'loss_val': 1.0684718761983028, 'psi': 0.5534704329746185}
[S5] START round=7 head_norm_before_train=1.289581 (no previous merge yet)
[S5] round=7 local utility u=0.837519 metrics={'f1_val': 0.41734838192522206, 'auprc': 0.7777985294105656, 'loss_val': 1.0387728296352385, 'psi': 0.5615284409193595}-{'f1_val': 0.15730708332595333, 'auprc': 0.7718586058303466, 'loss_val': 1.1357430164781388, 'psi': 0.4031276923277107}
[S6] START round=7 head_norm_before_train=0.694550 cos_to_last_merge=1.0000 (last merge round=6)
[S6] round=7 local utility u=0.275472 metrics={'f1_val': 0.4171358730402079, 'auprc': 0.7746189744687455, 'loss_val': 1.0407289438267413, 'psi': 0.5601291136116229}-{'f1_val': 0.4150420236907487, 'auprc': 0.6294385299210837, 'loss_val': 1.1435679930687754, 'psi': 0.5008006261828828}
[S7] START round=7 head_norm_before_train=0.678380 cos_to_last_merge=1.0000 (last merge round=6)
[S7] round=7 local utility u=0.546999 metrics={'f1_val': 0.4168747328879592, 'auprc': 0.5883923221759485, 'loss_val': 1.1904939108101127, 'psi': 0.4854817686031549}-{'f1_val': 0.14205682272909165, 'auprc': 0.7860244679856773, 'loss_val': 1.2284809695645802, 'psi': 0.3996438808317259}
[S8] START round=7 head_norm_before_train=1.323689 (no previous merge yet)
[S8] round=7 local utility u=0.200125 metrics={'f1_val': 0.4326057005693632, 'auprc': 0.7771011677112212, 'loss_val': 0.7343028640364643, 'psi': 0.5704038874261064}-{'f1_val': 0.39142700823716925, 'auprc': 0.7771082287440579, 'loss_val': 0.8875020671188322, 'psi': 0.5456994964399247}
[S9] START round=7 head_norm_before_train=0.688533 cos_to_last_merge=1.0000 (last merge round=6)
[S9] round=7 local utility u=0.000000 metrics={'f1_val': 0.4168129756059391, 'auprc': 0.8899208733236632, 'loss_val': 0.9326511716698896, 'psi': 0.6060561346930288}-{'f1_val': 0.41685404846439245, 'auprc': 0.9845963723211822, 'loss_val': 1.0063457725063738, 'psi': 0.6439509780071084}
[S10] START round=7 head_norm_before_train=0.947802 cos_to_last_merge=1.0000 (last merge round=6)
[S10] round=7 local utility u=0.159350 metrics={'f1_val': 0.17452436281808928, 'auprc': 0.6282128435545284, 'loss_val': 1.1162935772221334, 'psi': 0.35599975511266496}-{'f1_val': 0.13862163754172394, 'auprc': 0.6130844137195968, 'loss_val': 1.174192061039086, 'psi': 0.32840674801287306}
[S11] START round=7 head_norm_before_train=0.664842 cos_to_last_merge=1.0000 (last merge round=6)
[S11] round=7 local utility u=0.071351 metrics={'f1_val': 0.39655223592620625, 'auprc': 0.868052901209452, 'loss_val': 1.0272386612413518, 'psi': 0.5851525020395045}-{'f1_val': 0.42273739039721175, 'auprc': 0.7837048076089534, 'loss_val': 1.0740076867225115, 'psi': 0.5671243572819085}
[S13] START round=7 head_norm_before_train=1.130821 cos_to_last_merge=0.9987 (last merge round=5)
[S13] round=7 local utility u=0.939515 metrics={'f1_val': 0.41627458463323097, 'auprc': 0.6008647867211757, 'loss_val': 1.1182976557039572, 'psi': 0.49011066546840887}-{'f1_val': 0.14299127802384587, 'auprc': 0.544576850736037, 'loss_val': 1.1887648225075478, 'psi': 0.3036255071087223}
[S14] START round=7 head_norm_before_train=1.435950 (no previous merge yet)
[S14] round=7 local utility u=0.243850 metrics={'f1_val': 0.3964292957175209, 'auprc': 0.8661429202377617, 'loss_val': 0.7642257523399854, 'psi': 0.5843147455256172}-{'f1_val': 0.3964292957175209, 'auprc': 0.7695337466990168, 'loss_val': 0.9620982775564791, 'psi': 0.5456710761101192}
[S15] START round=7 head_norm_before_train=0.891165 cos_to_last_merge=0.9721 (last merge round=2)
[S15] round=7 local utility u=0.061506 metrics={'f1_val': 0.14785221888552047, 'auprc': 0.7763128114989926, 'loss_val': 1.1277925036875096, 'psi': 0.3992364559309093}-{'f1_val': 0.13973365136155833, 'auprc': 0.7762607288454667, 'loss_val': 1.2019366041382678, 'psi': 0.3943444823551217}
[S16] START round=7 head_norm_before_train=0.559474 cos_to_last_merge=1.0000 (last merge round=6)
[S16] round=7 local utility u=0.770412 metrics={'f1_val': 0.41526982732562534, 'auprc': 0.5617264915941197, 'loss_val': 1.1059841600595797, 'psi': 0.4738524930330231}-{'f1_val': 0.14063745019920318, 'auprc': 0.6148056547320283, 'loss_val': 1.1582506500937706, 'psi': 0.33030473201233324}
[S17] START round=7 head_norm_before_train=1.024863 cos_to_last_merge=0.9397 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.940
[S17] round=7 local utility u=0.263900 metrics={'f1_val': 0.3823353938421018, 'auprc': 0.7432017977816547, 'loss_val': 0.8388166767887193, 'psi': 0.526681955417923}-{'f1_val': 0.392174807429541, 'auprc': 0.5952972038075011, 'loss_val': 0.9819392959686021, 'psi': 0.473423765980725}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S16@127.0.0.1:49116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:49103
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:49113
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:49112
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S11] → sending delta(kind=head bytes=1806) to S16@127.0.0.1:49116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:49108
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:49112
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:49110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] → sending delta(kind=head bytes=1806) to S16@127.0.0.1:49116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:49111
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S15] → sending delta(kind=head bytes=1789) to S2@127.0.0.1:49102
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:49111
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S3] → sending delta(kind=head bytes=1807) to S4@127.0.0.1:49104
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:49104
[S14] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1806 to 1 peers)
[S15] sending update (kind=head size=1789 to 1 peers)
[S16] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1806 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1794 to 1 peers)
[S5] sending update (kind=head size=1794 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1807 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1802) from S16
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.597274)
[S10] loaded HEAD from S16 (vec_in norm=0.597274)
[S10] cosine check vs S16: cos=0.2231
[S10] BUFFERED delta from S16 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1789) from S15
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.918858)
[S2] loaded HEAD from S15 (vec_in norm=0.918858)
[S2] cosine check vs S15: cos=0.9774
[S2] BUFFERED delta from S15 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1802) from S4
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.983999)
[S7] loaded HEAD from S4 (vec_in norm=0.983999)
[S7] cosine check vs S4: cos=0.8466
[S7] BUFFERED delta from S4 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1794) from S10
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=0.965724)
[S3] loaded HEAD from S10 (vec_in norm=0.965724)
[S3] cosine check vs S10: cos=-0.1716
[S3] DROPPED delta from S10 (cos=-0.1716 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1794) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.306605)
[S16] loaded HEAD from S5 (vec_in norm=1.306605)
[S16] cosine check vs S5: cos=-0.0355
[S16] DROPPED delta from S5 (cos=-0.0355 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1797) from S8
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.359200)
[S13] loaded HEAD from S8 (vec_in norm=1.359200)
[S13] cosine check vs S8: cos=0.9730
[S13] BUFFERED delta from S8 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1797) from S13
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.144516)
[S11] loaded HEAD from S13 (vec_in norm=1.144516)
[S11] cosine check vs S13: cos=0.8482
[S11] BUFFERED delta from S13 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1800) from S2
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=0.870083)
[S9] loaded HEAD from S2 (vec_in norm=0.870083)
[S9] cosine check vs S2: cos=0.8722
[S9] BUFFERED delta from S2 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1798) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.726288)
[S11] loaded HEAD from S6 (vec_in norm=0.726288)
[S11] cosine check vs S6: cos=0.4448
[S11] BUFFERED delta from S6 (total buffered=2)
[S4] RECEIVED delta(kind=head bytes=1807) from S3
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.406461)
[S4] loaded HEAD from S3 (vec_in norm=1.406461)
[S4] cosine check vs S3: cos=-0.0982
[S4] DROPPED delta from S3 (cos=-0.0982 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1806) from S11
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=0.698454)
[S16] loaded HEAD from S11 (vec_in norm=0.698454)
[S16] cosine check vs S11: cos=0.5977
[S16] BUFFERED delta from S11 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1802) from S14
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.486868)
[S10] loaded HEAD from S14 (vec_in norm=1.486868)
[S10] cosine check vs S14: cos=0.9381
[S10] BUFFERED delta from S14 (total buffered=2)
[S16] RECEIVED delta(kind=head bytes=1806) from S7
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.694243)
[S16] loaded HEAD from S7 (vec_in norm=0.694243)
[S16] cosine check vs S7: cos=0.4870
[S16] BUFFERED delta from S7 (total buffered=2)
[S17] sending update (kind=head size=1797 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1797) from S17
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.076718)
[S4] loaded HEAD from S17 (vec_in norm=1.076718)
[S4] cosine check vs S17: cos=0.9726
[S4] BUFFERED delta from S17 (total buffered=1)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=7 metric=0.4168 head_norm=0.734156
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.131789e-01
[S9] stored merged vector for next round verification (round=7)
[S9] DEBUG after merge:  round=7 metric=0.4166 head_norm=0.776253 delta_norm=0.213179
[S9] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=7 metric=0.3966 head_norm=0.698454
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.848202e-01
[S11] stored merged vector for next round verification (round=7)
[S11] DEBUG after merge:  round=7 metric=0.4061 head_norm=0.697137 delta_norm=0.184820
[S11] aggregate: ACCEPT kept=['S13', 'S6'] (k=2/2) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=7 metric=0.4163 head_norm=1.144516
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.804418e-01
[S13] stored merged vector for next round verification (round=7)
[S13] DEBUG after merge:  round=7 metric=0.4165 head_norm=1.243427 delta_norm=0.180442
[S13] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=7 metric=0.4161 head_norm=0.870083
[S2] _apply_head_vector_avg (torch): Δ‖w‖=9.812041e-02
[S2] stored merged vector for next round verification (round=7)
[S2] DEBUG after merge:  round=7 metric=0.4113 head_norm=0.889407 delta_norm=0.098120
[S2] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=7 metric=0.6812 head_norm=0.983999
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.291010e-01
[S4] stored merged vector for next round verification (round=7)
[S4] DEBUG after merge:  round=7 metric=0.6698 head_norm=1.023289 delta_norm=0.129101
[S4] aggregate: ROLLBACK (f1_val pre=0.681 post=0.670 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=7 metric=0.4153 head_norm=0.597274
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.209650e-01
[S16] stored merged vector for next round verification (round=7)
[S16] DEBUG after merge:  round=7 metric=0.1406 head_norm=0.523884 delta_norm=0.220965
[S16] aggregate: ROLLBACK (f1_val pre=0.415 post=0.141 tol_abs=0.005 tol_rel=0.0)
[S10] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=7 metric=0.1745 head_norm=0.965724
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.001550e-01
[S10] stored merged vector for next round verification (round=7)
[S10] DEBUG after merge:  round=7 metric=0.1682 head_norm=0.881987 delta_norm=0.200155
[S10] aggregate: ROLLBACK (f1_val pre=0.175 post=0.168 tol_abs=0.005 tol_rel=0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=7 metric=0.4169 head_norm=0.694243
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.709104e-01
[S7] stored merged vector for next round verification (round=7)
[S7] DEBUG after merge:  round=7 metric=0.1043 head_norm=0.807293 delta_norm=0.270910
[S7] aggregate: ROLLBACK (f1_val pre=0.417 post=0.104 tol_abs=0.005 tol_rel=0.0)
[S2] START round=8 head_norm_before_train=0.889407 cos_to_last_merge=1.0000 (last merge round=7)
[S2] round=8 local utility u=0.513039 metrics={'f1_val': 0.5736916995096809, 'auprc': 0.7517260969009902, 'loss_val': 0.953621425675287, 'psi': 0.6449054584662046}-{'f1_val': 0.4160872254026517, 'auprc': 0.7591740383108496, 'loss_val': 1.0564159171162961, 'psi': 0.5533219505659309}
[S3] START round=8 head_norm_before_train=1.406461 (no previous merge yet)
[S3] round=8 local utility u=0.017415 metrics={'f1_val': 0.40310226040402647, 'auprc': 0.9990477484790016, 'loss_val': 0.7076718470595894, 'psi': 0.6414804556340166}-{'f1_val': 0.401708470248874, 'auprc': 0.9978792212959817, 'loss_val': 0.7306332965350194, 'psi': 0.640176770667717}
[S4] START round=8 head_norm_before_train=1.023289 cos_to_last_merge=1.0000 (last merge round=7)
[S4] round=8 local utility u=0.000000 metrics={'f1_val': 0.3813854691493491, 'auprc': 0.6634662286027481, 'loss_val': 0.8119338536247046, 'psi': 0.4942177729307087}-{'f1_val': 0.6812310194558018, 'auprc': 0.7597675136371553, 'loss_val': 0.9301678834457039, 'psi': 0.7126456171283433}
[S5] START round=8 head_norm_before_train=1.306605 (no previous merge yet)
[S5] round=8 local utility u=0.067151 metrics={'f1_val': 0.4189613441527838, 'auprc': 0.7774947921373724, 'loss_val': 0.9132381344013674, 'psi': 0.5623747233466192}-{'f1_val': 0.41734838192522206, 'auprc': 0.7777985294105656, 'loss_val': 1.0387728296352385, 'psi': 0.5615284409193595}
[S6] START round=8 head_norm_before_train=0.726288 cos_to_last_merge=0.9932 (last merge round=6)
[S6] round=8 local utility u=0.371040 metrics={'f1_val': 0.41693552313656757, 'auprc': 0.9829891938907567, 'loss_val': 0.922558457111505, 'psi': 0.6433569914382432}-{'f1_val': 0.4171358730402079, 'auprc': 0.7746189744687455, 'loss_val': 1.0407289438267413, 'psi': 0.5601291136116229}
[S7] START round=8 head_norm_before_train=0.807293 cos_to_last_merge=1.0000 (last merge round=7)
[S7] round=8 local utility u=0.176180 metrics={'f1_val': 0.4171579869317734, 'auprc': 0.6721404354019163, 'loss_val': 1.0910786110021766, 'psi': 0.5191509663198306}-{'f1_val': 0.4168747328879592, 'auprc': 0.5883923221759485, 'loss_val': 1.1904939108101127, 'psi': 0.4854817686031549}
[S8] START round=8 head_norm_before_train=1.359200 (no previous merge yet)
[S8] round=8 local utility u=0.052105 metrics={'f1_val': 0.43655094092802615, 'auprc': 0.7769969582536594, 'loss_val': 0.6534523779354718, 'psi': 0.5727293478582796}-{'f1_val': 0.4326057005693632, 'auprc': 0.7771011677112212, 'loss_val': 0.7343028640364643, 'psi': 0.5704038874261064}
[S9] START round=8 head_norm_before_train=0.776253 cos_to_last_merge=1.0000 (last merge round=7)
[S9] round=8 local utility u=0.006305 metrics={'f1_val': 0.4164908106574855, 'auprc': 0.8671497797284643, 'loss_val': 0.84979418588183, 'psi': 0.5967543982858771}-{'f1_val': 0.4168129756059391, 'auprc': 0.8899208733236632, 'loss_val': 0.9326511716698896, 'psi': 0.6060561346930288}
[S10] START round=8 head_norm_before_train=0.881987 cos_to_last_merge=1.0000 (last merge round=7)
[S10] round=8 local utility u=1.000000 metrics={'f1_val': 0.7014667009264342, 'auprc': 0.7816301835610906, 'loss_val': 1.023995536453801, 'psi': 0.7335320939802967}-{'f1_val': 0.17452436281808928, 'auprc': 0.6282128435545284, 'loss_val': 1.1162935772221334, 'psi': 0.35599975511266496}
[S11] START round=8 head_norm_before_train=0.697137 cos_to_last_merge=1.0000 (last merge round=7)
[S11] round=8 local utility u=0.179417 metrics={'f1_val': 0.39655223592620625, 'auprc': 0.9604821016056854, 'loss_val': 0.9456931921613912, 'psi': 0.6221241821979979}-{'f1_val': 0.39655223592620625, 'auprc': 0.868052901209452, 'loss_val': 1.0272386612413518, 'psi': 0.5851525020395045}
[S13] START round=8 head_norm_before_train=1.243427 cos_to_last_merge=1.0000 (last merge round=7)
[S13] round=8 local utility u=0.066604 metrics={'f1_val': 0.4161203556905605, 'auprc': 0.6227746996762614, 'loss_val': 1.049893386215907, 'psi': 0.4987820932848409}-{'f1_val': 0.41627458463323097, 'auprc': 0.6008647867211757, 'loss_val': 1.1182976557039572, 'psi': 0.49011066546840887}
[S14] START round=8 head_norm_before_train=1.486868 (no previous merge yet)
[S14] round=8 local utility u=0.641749 metrics={'f1_val': 0.5200921865120711, 'auprc': 0.9985090696374646, 'loss_val': 0.6198030949915971, 'psi': 0.7114589397622285}-{'f1_val': 0.3964292957175209, 'auprc': 0.8661429202377617, 'loss_val': 0.7642257523399854, 'psi': 0.5843147455256172}
[S15] START round=8 head_norm_before_train=0.918858 cos_to_last_merge=0.9615 (last merge round=2)
[S15] round=8 local utility u=0.904608 metrics={'f1_val': 0.4167593395843331, 'auprc': 0.7979447495204585, 'loss_val': 0.9969140747323817, 'psi': 0.5692335035587832}-{'f1_val': 0.14785221888552047, 'auprc': 0.7763128114989926, 'loss_val': 1.1277925036875096, 'psi': 0.3992364559309093}
[S16] START round=8 head_norm_before_train=0.523884 cos_to_last_merge=1.0000 (last merge round=7)
[S16] round=8 local utility u=0.000000 metrics={'f1_val': 0.4171177572574632, 'auprc': 0.5376623458342935, 'loss_val': 1.0777675736678658, 'psi': 0.46533559268819535}-{'f1_val': 0.41526982732562534, 'auprc': 0.5617264915941197, 'loss_val': 1.1059841600595797, 'psi': 0.4738524930330231}
[S17] START round=8 head_norm_before_train=1.076718 cos_to_last_merge=0.9198 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.920
[S17] round=8 local utility u=0.000000 metrics={'f1_val': 0.35332495072624465, 'auprc': 0.7249845548455363, 'loss_val': 0.8634153363394492, 'psi': 0.5019887923739612}-{'f1_val': 0.3823353938421018, 'auprc': 0.7432017977816547, 'loss_val': 0.8388166767887193, 'psi': 0.526681955417923}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S4@127.0.0.1:49104
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] → sending delta(kind=head bytes=1794) to S6@127.0.0.1:49107
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:49112
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S15] → sending delta(kind=head bytes=1788) to S2@127.0.0.1:49102
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1784 reason=None
[S10] → sending delta(kind=head bytes=1784) to S3@127.0.0.1:49103
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:49116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:49110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S16@127.0.0.1:49116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:49112
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] → sending delta(kind=head bytes=1804) to S10@127.0.0.1:49111
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:49116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S8] → sending delta(kind=head bytes=1791) to S13@127.0.0.1:49113
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1804 to 1 peers)
[S8] sending update (kind=head size=1791 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1784 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1794 to 1 peers)
[S15] sending update (kind=head size=1788 to 1 peers)
[S5] sending update (kind=head size=1794 to 1 peers)
[S3] sending update (kind=head size=1804 to 1 peers)
[S2] sending update (kind=head size=1794 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1794) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.333756)
[S16] loaded HEAD from S5 (vec_in norm=1.333756)
[S16] cosine check vs S5: cos=-0.0325
[S16] DROPPED delta from S5 (cos=-0.0325 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1796) from S11
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=0.731006)
[S16] loaded HEAD from S11 (vec_in norm=0.731006)
[S16] cosine check vs S11: cos=0.6538
[S16] BUFFERED delta from S11 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1791) from S8
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.397807)
[S13] loaded HEAD from S8 (vec_in norm=1.397807)
[S13] cosine check vs S8: cos=0.9862
[S13] BUFFERED delta from S8 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1797) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.766558)
[S11] loaded HEAD from S6 (vec_in norm=0.766558)
[S11] cosine check vs S6: cos=0.5466
[S11] BUFFERED delta from S6 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1796) from S13
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.259096)
[S11] loaded HEAD from S13 (vec_in norm=1.259096)
[S11] cosine check vs S13: cos=0.8467
[S11] BUFFERED delta from S13 (total buffered=2)
[S6] RECEIVED delta(kind=head bytes=1794) from S9
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.821840)
[S6] loaded HEAD from S9 (vec_in norm=0.821840)
[S6] cosine check vs S9: cos=0.7371
[S6] BUFFERED delta from S9 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1804) from S14
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.535589)
[S10] loaded HEAD from S14 (vec_in norm=1.535589)
[S10] cosine check vs S14: cos=0.9352
[S10] BUFFERED delta from S14 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1794) from S2
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=0.922884)
[S9] loaded HEAD from S2 (vec_in norm=0.922884)
[S9] cosine check vs S2: cos=0.9426
[S9] BUFFERED delta from S2 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1784) from S10
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=0.904078)
[S3] loaded HEAD from S10 (vec_in norm=0.904078)
[S3] cosine check vs S10: cos=-0.1720
[S3] DROPPED delta from S10 (cos=-0.1720 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1796) from S7
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.823993)
[S16] loaded HEAD from S7 (vec_in norm=0.823993)
[S16] cosine check vs S7: cos=0.5469
[S16] BUFFERED delta from S7 (total buffered=2)
[S2] RECEIVED delta(kind=head bytes=1788) from S15
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.957246)
[S2] loaded HEAD from S15 (vec_in norm=0.957246)
[S2] cosine check vs S15: cos=0.9775
[S2] BUFFERED delta from S15 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1804) from S3
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.452202)
[S4] loaded HEAD from S3 (vec_in norm=1.452202)
[S4] cosine check vs S3: cos=-0.0978
[S4] DROPPED delta from S3 (cos=-0.0978 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=8 metric=0.4161 head_norm=1.259096
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.301396e-01
[S13] stored merged vector for next round verification (round=8)
[S13] DEBUG after merge:  round=8 metric=0.4160 head_norm=1.323879 delta_norm=0.130140
[S13] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=8 metric=0.4165 head_norm=0.821840
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.559150e-01
[S9] stored merged vector for next round verification (round=8)
[S9] DEBUG after merge:  round=8 metric=0.4165 head_norm=0.859802 delta_norm=0.155915
[S9] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=8 metric=0.3966 head_norm=0.731006
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.550873e-01
[S11] stored merged vector for next round verification (round=8)
[S11] DEBUG after merge:  round=8 metric=0.3966 head_norm=0.752898 delta_norm=0.155087
[S11] aggregate: ACCEPT kept=['S6', 'S13'] (k=2/2) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=8 metric=0.7015 head_norm=0.904078
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.804049e-01
[S10] stored merged vector for next round verification (round=8)
[S10] DEBUG after merge:  round=8 metric=0.5989 head_norm=1.201244 delta_norm=0.380405
[S10] aggregate: ROLLBACK (f1_val pre=0.701 post=0.599 tol_abs=0.005 tol_rel=0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=8 metric=0.5737 head_norm=0.922884
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.012134e-01
[S2] stored merged vector for next round verification (round=8)
[S2] DEBUG after merge:  round=8 metric=0.6123 head_norm=0.934759 delta_norm=0.101213
[S2] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=8 metric=0.4169 head_norm=0.766558
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.890772e-01
[S6] stored merged vector for next round verification (round=8)
[S6] DEBUG after merge:  round=8 metric=0.4169 head_norm=0.740237 delta_norm=0.289077
[S6] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=8 metric=0.4171 head_norm=0.567095
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.934369e-01
[S16] stored merged vector for next round verification (round=8)
[S16] DEBUG after merge:  round=8 metric=0.4163 head_norm=0.548389 delta_norm=0.193437
[S16] aggregate: ACCEPT kept=['S11', 'S7'] (k=2/2) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=0.934759 cos_to_last_merge=1.0000 (last merge round=8)
[S2] round=9 local utility u=0.421992 metrics={'f1_val': 0.7040405905676412, 'auprc': 0.7314615269568316, 'loss_val': 0.8309372166802086, 'psi': 0.7150089651233174}-{'f1_val': 0.5736916995096809, 'auprc': 0.7517260969009902, 'loss_val': 0.953621425675287, 'psi': 0.6449054584662046}
[S3] START round=9 head_norm_before_train=1.452202 (no previous merge yet)
[S3] round=9 local utility u=0.088224 metrics={'f1_val': 0.4271969601253779, 'auprc': 0.9994383257189973, 'loss_val': 0.6769631837360258, 'psi': 0.6560935063628257}-{'f1_val': 0.40310226040402647, 'auprc': 0.9990477484790016, 'loss_val': 0.7076718470595894, 'psi': 0.6414804556340166}
[S4] START round=9 head_norm_before_train=1.061866 cos_to_last_merge=0.9956 (last merge round=7)
[S4] round=9 local utility u=0.175680 metrics={'f1_val': 0.37757197334646186, 'auprc': 0.7540509549129211, 'loss_val': 0.7094464985833083, 'psi': 0.5281635659730455}-{'f1_val': 0.3813854691493491, 'auprc': 0.6634662286027481, 'loss_val': 0.8119338536247046, 'psi': 0.4942177729307087}
[S5] START round=9 head_norm_before_train=1.333756 (no previous merge yet)
[S5] round=9 local utility u=0.119755 metrics={'f1_val': 0.41823357465624633, 'auprc': 0.8160697954688023, 'loss_val': 0.785087428079547, 'psi': 0.5773680629812687}-{'f1_val': 0.4189613441527838, 'auprc': 0.7774947921373724, 'loss_val': 0.9132381344013674, 'psi': 0.5623747233466192}
[S6] START round=9 head_norm_before_train=0.740237 cos_to_last_merge=1.0000 (last merge round=8)
[S6] round=9 local utility u=0.015881 metrics={'f1_val': 0.41701511304337235, 'auprc': 0.9728045995988229, 'loss_val': 0.8607195780576047, 'psi': 0.6393309076655527}-{'f1_val': 0.41693552313656757, 'auprc': 0.9829891938907567, 'loss_val': 0.922558457111505, 'psi': 0.6433569914382432}
[S7] START round=9 head_norm_before_train=0.823993 cos_to_last_merge=0.9946 (last merge round=7)
[S7] round=9 local utility u=0.203964 metrics={'f1_val': 0.41703542715461484, 'auprc': 0.7679693179588646, 'loss_val': 0.9699013119102602, 'psi': 0.5574089834763147}-{'f1_val': 0.4171579869317734, 'auprc': 0.6721404354019163, 'loss_val': 1.0910786110021766, 'psi': 0.5191509663198306}
[S8] START round=9 head_norm_before_train=1.397807 (no previous merge yet)
[S8] round=9 local utility u=0.612200 metrics={'f1_val': 0.6335583011293269, 'auprc': 0.775546497665258, 'loss_val': 0.6067453790854086, 'psi': 0.6903535797436993}-{'f1_val': 0.43655094092802615, 'auprc': 0.7769969582536594, 'loss_val': 0.6534523779354718, 'psi': 0.5727293478582796}
[S9] START round=9 head_norm_before_train=0.859802 cos_to_last_merge=1.0000 (last merge round=8)
[S9] round=9 local utility u=0.197857 metrics={'f1_val': 0.39756258118891413, 'auprc': 0.999659624509193, 'loss_val': 0.7380408036109721, 'psi': 0.6384013985170257}-{'f1_val': 0.4164908106574855, 'auprc': 0.8671497797284643, 'loss_val': 0.84979418588183, 'psi': 0.5967543982858771}
[S10] START round=9 head_norm_before_train=1.201244 cos_to_last_merge=1.0000 (last merge round=8)
[S10] round=9 local utility u=0.000000 metrics={'f1_val': 0.7011259999537992, 'auprc': 0.7075068084365783, 'loss_val': 0.8776975681923521, 'psi': 0.7036783233469108}-{'f1_val': 0.7014667009264342, 'auprc': 0.7816301835610906, 'loss_val': 1.023995536453801, 'psi': 0.7335320939802967}
[S11] START round=9 head_norm_before_train=0.752898 cos_to_last_merge=1.0000 (last merge round=8)
[S11] round=9 local utility u=0.000000 metrics={'f1_val': 0.39718307134577835, 'auprc': 0.913065689408963, 'loss_val': 0.8565809605407165, 'psi': 0.6035361185710523}-{'f1_val': 0.39655223592620625, 'auprc': 0.9604821016056854, 'loss_val': 0.9456931921613912, 'psi': 0.6221241821979979}
[S13] START round=9 head_norm_before_train=1.323879 cos_to_last_merge=1.0000 (last merge round=8)
[S13] round=9 local utility u=0.000000 metrics={'f1_val': 0.3716616846250217, 'auprc': 0.5385074807271016, 'loss_val': 1.000310600175262, 'psi': 0.4384000030658537}-{'f1_val': 0.4161203556905605, 'auprc': 0.6227746996762614, 'loss_val': 1.049893386215907, 'psi': 0.4987820932848409}
[S14] START round=9 head_norm_before_train=1.535589 (no previous merge yet)
[S14] round=9 local utility u=0.589413 metrics={'f1_val': 0.7018194222859705, 'auprc': 0.9973582980101214, 'loss_val': 0.5278881155761337, 'psi': 0.8200349725756308}-{'f1_val': 0.5200921865120711, 'auprc': 0.9985090696374646, 'loss_val': 0.6198030949915971, 'psi': 0.7114589397622285}
[S15] START round=9 head_norm_before_train=0.957246 cos_to_last_merge=0.9472 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.947
[S15] round=9 local utility u=0.086616 metrics={'f1_val': 0.4180512532430229, 'auprc': 0.7878282943728042, 'loss_val': 0.801084225116778, 'psi': 0.5659620696949355}-{'f1_val': 0.4167593395843331, 'auprc': 0.7979447495204585, 'loss_val': 0.9969140747323817, 'psi': 0.5692335035587832}
[S16] START round=9 head_norm_before_train=0.548389 cos_to_last_merge=1.0000 (last merge round=8)
[S16] round=9 local utility u=0.050821 metrics={'f1_val': 0.43644520801015857, 'auprc': 0.5280389161661899, 'loss_val': 1.0632197599254674, 'psi': 0.47308269127257113}-{'f1_val': 0.4171177572574632, 'auprc': 0.5376623458342935, 'loss_val': 1.0777675736678658, 'psi': 0.46533559268819535}
[S17] START round=9 head_norm_before_train=1.122247 cos_to_last_merge=0.9017 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.902
[S17] round=9 local utility u=0.000000 metrics={'f1_val': 0.3521394294854705, 'auprc': 0.6916684601889557, 'loss_val': 0.9017693689244365, 'psi': 0.48795104176686455}-{'f1_val': 0.35332495072624465, 'auprc': 0.7249845548455363, 'loss_val': 0.8634153363394492, 'psi': 0.5019887923739612}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:49104
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:49108
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:49116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:49113
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S16@127.0.0.1:49116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:49112
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] → sending delta(kind=head bytes=1793) to S6@127.0.0.1:49107
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:49111
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:49110
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:49111
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S15] → sending delta(kind=head bytes=1786) to S2@127.0.0.1:49102
[S2] sending update (kind=head size=1794 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1793 to 1 peers)
[S15] sending update (kind=head size=1786 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1794 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1803 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1794) from S2
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=0.974755)
[S9] loaded HEAD from S2 (vec_in norm=0.974755)
[S9] cosine check vs S2: cos=0.9648
[S9] BUFFERED delta from S2 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1800) from S3
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.491963)
[S4] loaded HEAD from S3 (vec_in norm=1.491963)
[S4] cosine check vs S3: cos=-0.1062
[S4] DROPPED delta from S3 (cos=-0.1062 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1794) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.363846)
[S16] loaded HEAD from S5 (vec_in norm=1.363846)
[S16] cosine check vs S5: cos=-0.0212
[S16] DROPPED delta from S5 (cos=-0.0212 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1793) from S9
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.902207)
[S6] loaded HEAD from S9 (vec_in norm=0.902207)
[S6] cosine check vs S9: cos=0.8786
[S6] BUFFERED delta from S9 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1798) from S7
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.851255)
[S16] loaded HEAD from S7 (vec_in norm=0.851255)
[S16] cosine check vs S7: cos=0.6897
[S16] BUFFERED delta from S7 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1795) from S8
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.432780)
[S13] loaded HEAD from S8 (vec_in norm=1.432780)
[S13] cosine check vs S8: cos=0.9908
[S13] BUFFERED delta from S8 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1801) from S16
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.596266)
[S10] loaded HEAD from S16 (vec_in norm=0.596266)
[S10] cosine check vs S16: cos=0.2341
[S10] BUFFERED delta from S16 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1799) from S14
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.585201)
[S10] loaded HEAD from S14 (vec_in norm=1.585201)
[S10] cosine check vs S14: cos=0.9783
[S10] BUFFERED delta from S14 (total buffered=2)
[S11] RECEIVED delta(kind=head bytes=1797) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.780099)
[S11] loaded HEAD from S6 (vec_in norm=0.780099)
[S11] cosine check vs S6: cos=0.6554
[S11] BUFFERED delta from S6 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1786) from S15
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.005949)
[S2] loaded HEAD from S15 (vec_in norm=1.005949)
[S2] cosine check vs S15: cos=0.9771
[S2] BUFFERED delta from S15 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1803) from S4
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.111227)
[S7] loaded HEAD from S4 (vec_in norm=1.111227)
[S7] cosine check vs S4: cos=0.9208
[S7] BUFFERED delta from S4 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=9 metric=0.3717 head_norm=1.342307
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.042836e-01
[S13] stored merged vector for next round verification (round=9)
[S13] DEBUG after merge:  round=9 metric=0.3717 head_norm=1.384358 delta_norm=0.104284
[S13] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=9 metric=0.3972 head_norm=0.789729
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.258480e-01
[S11] stored merged vector for next round verification (round=9)
[S11] DEBUG after merge:  round=9 metric=0.7000 head_norm=0.714098 delta_norm=0.325848
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=9 metric=0.7011 head_norm=1.224875
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.303810e-01
[S10] stored merged vector for next round verification (round=9)
[S10] DEBUG after merge:  round=9 metric=0.4130 head_norm=1.043221 delta_norm=0.230381
[S10] aggregate: ROLLBACK (f1_val pre=0.701 post=0.413 tol_abs=0.005 tol_rel=0.0)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=9 metric=0.4170 head_norm=0.780099
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.155181e-01
[S6] stored merged vector for next round verification (round=9)
[S6] DEBUG after merge:  round=9 metric=0.4170 head_norm=0.815364 delta_norm=0.215518
[S6] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=9 metric=0.3976 head_norm=0.902207
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.296127e-01
[S9] stored merged vector for next round verification (round=9)
[S9] DEBUG after merge:  round=9 metric=0.4190 head_norm=0.930195 delta_norm=0.129613
[S9] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=9 metric=0.4364 head_norm=0.596266
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.082474e-01
[S16] stored merged vector for next round verification (round=9)
[S16] DEBUG after merge:  round=9 metric=0.4369 head_norm=0.667134 delta_norm=0.308247
[S16] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=9 metric=0.4170 head_norm=0.851255
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.331214e-01
[S7] stored merged vector for next round verification (round=9)
[S7] DEBUG after merge:  round=9 metric=0.4176 head_norm=0.961969 delta_norm=0.233121
[S7] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=9 metric=0.7040 head_norm=0.974755
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.071388e-01
[S2] stored merged vector for next round verification (round=9)
[S2] DEBUG after merge:  round=9 metric=0.6996 head_norm=0.984663 delta_norm=0.107139
[S2] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=0.984663 cos_to_last_merge=1.0000 (last merge round=9)
[S2] round=10 local utility u=0.132912 metrics={'f1_val': 0.7111100576400716, 'auprc': 0.7736501278570944, 'loss_val': 0.7340967626927483, 'psi': 0.7361260857268808}-{'f1_val': 0.7040405905676412, 'auprc': 0.7314615269568316, 'loss_val': 0.8309372166802086, 'psi': 0.7150089651233174}
[S3] START round=10 head_norm_before_train=1.491963 (no previous merge yet)
[S3] round=10 local utility u=0.934518 metrics={'f1_val': 0.700330919019862, 'auprc': 0.9978452532728341, 'loss_val': 0.4419517026009716, 'psi': 0.8193366527210508}-{'f1_val': 0.4271969601253779, 'auprc': 0.9994383257189973, 'loss_val': 0.6769631837360258, 'psi': 0.6560935063628257}
[S4] START round=10 head_norm_before_train=1.111227 cos_to_last_merge=0.9851 (last merge round=7)
[S4] round=10 local utility u=0.028816 metrics={'f1_val': 0.420373061457001, 'auprc': 0.6624189982900216, 'loss_val': 0.6337261272179048, 'psi': 0.5171914361902092}-{'f1_val': 0.37757197334646186, 'auprc': 0.7540509549129211, 'loss_val': 0.7094464985833083, 'psi': 0.5281635659730455}
[S5] START round=10 head_norm_before_train=1.363846 (no previous merge yet)
[S5] round=10 local utility u=0.202340 metrics={'f1_val': 0.41758608903622574, 'auprc': 0.9313679283948189, 'loss_val': 0.72241654288041, 'psi': 0.6230988247796629}-{'f1_val': 0.41823357465624633, 'auprc': 0.8160697954688023, 'loss_val': 0.785087428079547, 'psi': 0.5773680629812687}
[S6] START round=10 head_norm_before_train=0.815364 cos_to_last_merge=1.0000 (last merge round=9)
[S6] round=10 local utility u=0.295710 metrics={'f1_val': 0.5003905554303996, 'auprc': 0.9719922500220973, 'loss_val': 0.7671159563051984, 'psi': 0.6890312332670787}-{'f1_val': 0.41701511304337235, 'auprc': 0.9728045995988229, 'loss_val': 0.8607195780576047, 'psi': 0.6393309076655527}
[S7] START round=10 head_norm_before_train=0.961969 cos_to_last_merge=1.0000 (last merge round=9)
[S7] round=10 local utility u=0.000000 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.677530282988148, 'loss_val': 0.9194323766764547, 'psi': 0.5210381840618732}-{'f1_val': 0.41703542715461484, 'auprc': 0.7679693179588646, 'loss_val': 0.9699013119102602, 'psi': 0.5574089834763147}
[S8] START round=10 head_norm_before_train=1.432780 (no previous merge yet)
[S8] round=10 local utility u=0.417383 metrics={'f1_val': 0.700123921499437, 'auprc': 0.8876366602005535, 'loss_val': 0.5076429034508265, 'psi': 0.7751290169798837}-{'f1_val': 0.6335583011293269, 'auprc': 0.775546497665258, 'loss_val': 0.6067453790854086, 'psi': 0.6903535797436993}
[S9] START round=10 head_norm_before_train=0.930195 cos_to_last_merge=1.0000 (last merge round=9)
[S9] round=10 local utility u=0.057228 metrics={'f1_val': 0.40065388838226906, 'auprc': 0.999489687554236, 'loss_val': 0.6416229060469874, 'psi': 0.6401882080510558}-{'f1_val': 0.39756258118891413, 'auprc': 0.999659624509193, 'loss_val': 0.7380408036109721, 'psi': 0.6384013985170257}
[S10] START round=10 head_norm_before_train=1.043221 cos_to_last_merge=1.0000 (last merge round=9)
[S10] round=10 local utility u=0.000000 metrics={'f1_val': 0.6988658387082196, 'auprc': 0.6647055998478082, 'loss_val': 0.7973441931642833, 'psi': 0.6852017431640551}-{'f1_val': 0.7011259999537992, 'auprc': 0.7075068084365783, 'loss_val': 0.8776975681923521, 'psi': 0.7036783233469108}
[S11] START round=10 head_norm_before_train=0.714098 cos_to_last_merge=1.0000 (last merge round=9)
[S11] round=10 local utility u=0.969735 metrics={'f1_val': 0.7015826949324591, 'auprc': 0.9386100699211066, 'loss_val': 0.820141616250472, 'psi': 0.7963936449279181}-{'f1_val': 0.39718307134577835, 'auprc': 0.913065689408963, 'loss_val': 0.8565809605407165, 'psi': 0.6035361185710523}
[S13] START round=10 head_norm_before_train=1.384358 cos_to_last_merge=1.0000 (last merge round=9)
[S13] round=10 local utility u=0.448737 metrics={'f1_val': 0.4061580226359609, 'auprc': 0.7293422528995628, 'loss_val': 0.8823186457299761, 'psi': 0.5354317147414016}-{'f1_val': 0.3716616846250217, 'auprc': 0.5385074807271016, 'loss_val': 1.000310600175262, 'psi': 0.4384000030658537}
[S14] START round=10 head_norm_before_train=1.585201 (no previous merge yet)
[S14] round=10 local utility u=0.654697 metrics={'f1_val': 0.9041210432679754, 'auprc': 0.9945976371121787, 'loss_val': 0.4240215505182072, 'psi': 0.9403116808056566}-{'f1_val': 0.7018194222859705, 'auprc': 0.9973582980101214, 'loss_val': 0.5278881155761337, 'psi': 0.8200349725756308}
[S15] START round=10 head_norm_before_train=1.005949 cos_to_last_merge=0.9290 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.929
[S15] round=10 local utility u=1.000000 metrics={'f1_val': 0.6932870653774112, 'auprc': 0.962712663923894, 'loss_val': 0.6441087667623281, 'psi': 0.8010573047960043}-{'f1_val': 0.4180512532430229, 'auprc': 0.7878282943728042, 'loss_val': 0.801084225116778, 'psi': 0.5659620696949355}
[S16] START round=10 head_norm_before_train=0.667134 cos_to_last_merge=1.0000 (last merge round=9)
[S16] round=10 local utility u=0.000000 metrics={'f1_val': 0.3527851701339047, 'auprc': 0.5551747382405373, 'loss_val': 1.0264083705693963, 'psi': 0.43374099737655775}-{'f1_val': 0.43644520801015857, 'auprc': 0.5280389161661899, 'loss_val': 1.0632197599254674, 'psi': 0.47308269127257113}
[S17] START round=10 head_norm_before_train=1.159086 cos_to_last_merge=0.8868 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.887
[S17] round=10 local utility u=0.000000 metrics={'f1_val': 0.32911254918772886, 'auprc': 0.6854505453515229, 'loss_val': 1.1033865725555245, 'psi': 0.47164774765324646}-{'f1_val': 0.3521394294854705, 'auprc': 0.6916684601889557, 'loss_val': 0.9017693689244365, 'psi': 0.48795104176686455}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:49112
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:49116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:49112
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S2] → sending delta(kind=head bytes=1792) to S9@127.0.0.1:49110
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S9] → sending delta(kind=head bytes=1788) to S6@127.0.0.1:49107
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:49108
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:49113
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S5] → sending delta(kind=head bytes=1792) to S16@127.0.0.1:49116
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S15] → sending delta(kind=head bytes=1790) to S2@127.0.0.1:49102
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:49111
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S3] → sending delta(kind=head bytes=1806) to S4@127.0.0.1:49104
[S5] sending update (kind=head size=1792 to 1 peers)
[S15] sending update (kind=head size=1790 to 1 peers)
[S2] sending update (kind=head size=1792 to 1 peers)
[S3] sending update (kind=head size=1806 to 1 peers)
[S9] sending update (kind=head size=1788 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1803 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1792) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.397743)
[S16] loaded HEAD from S5 (vec_in norm=1.397743)
[S16] cosine check vs S5: cos=-0.0205
[S16] DROPPED delta from S5 (cos=-0.0205 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1788) from S9
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.972849)
[S6] loaded HEAD from S9 (vec_in norm=0.972849)
[S6] cosine check vs S9: cos=0.9380
[S6] BUFFERED delta from S9 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1800) from S11
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=0.751832)
[S16] loaded HEAD from S11 (vec_in norm=0.751832)
[S16] cosine check vs S11: cos=0.4057
[S16] BUFFERED delta from S11 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1802) from S14
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.631337)
[S10] loaded HEAD from S14 (vec_in norm=1.631337)
[S10] cosine check vs S14: cos=0.9588
[S10] BUFFERED delta from S14 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1797) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.855092)
[S11] loaded HEAD from S6 (vec_in norm=0.855092)
[S11] cosine check vs S6: cos=0.8648
[S11] BUFFERED delta from S6 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1792) from S2
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.028227)
[S9] loaded HEAD from S2 (vec_in norm=1.028227)
[S9] cosine check vs S2: cos=0.9738
[S9] BUFFERED delta from S2 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1790) from S15
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.057554)
[S2] loaded HEAD from S15 (vec_in norm=1.057554)
[S2] cosine check vs S15: cos=0.9776
[S2] BUFFERED delta from S15 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1798) from S13
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.406281)
[S11] loaded HEAD from S13 (vec_in norm=1.406281)
[S11] cosine check vs S13: cos=0.6307
[S11] BUFFERED delta from S13 (total buffered=2)
[S13] RECEIVED delta(kind=head bytes=1803) from S8
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.464923)
[S13] loaded HEAD from S8 (vec_in norm=1.464923)
[S13] cosine check vs S8: cos=0.9929
[S13] BUFFERED delta from S8 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1803) from S4
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.164580)
[S7] loaded HEAD from S4 (vec_in norm=1.164580)
[S7] cosine check vs S4: cos=0.9674
[S7] BUFFERED delta from S4 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1806) from S3
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.534210)
[S4] loaded HEAD from S3 (vec_in norm=1.534210)
[S4] cosine check vs S3: cos=-0.1138
[S4] DROPPED delta from S3 (cos=-0.1138 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=10 metric=0.7016 head_norm=0.751832
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.500727e-01
[S11] stored merged vector for next round verification (round=10)
[S11] DEBUG after merge:  round=10 metric=0.7018 head_norm=0.820957 delta_norm=0.250073
[S11] aggregate: ACCEPT kept=['S6', 'S13'] (k=2/2) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.417 → S16@127.0.0.1:49116
[S14] ⇄ pheromone p=0.528 → S10@127.0.0.1:49111
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=10 metric=0.5004 head_norm=0.855092
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.709982e-01
[S6] stored merged vector for next round verification (round=10)
[S6] DEBUG after merge:  round=10 metric=0.4169 head_norm=0.899760 delta_norm=0.170998
[S6] aggregate: ROLLBACK (f1_val pre=0.500 post=0.417 tol_abs=0.005 tol_rel=0.0)
[S6] ⇄ pheromone p=0.328 → S11@127.0.0.1:49112
[S15] ⇄ pheromone p=0.464 → S2@127.0.0.1:49102
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=10 metric=0.4167 head_norm=0.990832
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.623720e-01
[S7] stored merged vector for next round verification (round=10)
[S7] DEBUG after merge:  round=10 metric=0.4167 head_norm=1.068940 delta_norm=0.162372
[S7] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.236 → S16@127.0.0.1:49116
[S5] ⇄ pheromone p=0.289 → S16@127.0.0.1:49116
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=10 metric=0.6989 head_norm=1.076895
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.361895e-01
[S10] stored merged vector for next round verification (round=10)
[S10] DEBUG after merge:  round=10 metric=0.3998 head_norm=1.340693 delta_norm=0.336190
[S10] aggregate: ROLLBACK (f1_val pre=0.699 post=0.400 tol_abs=0.005 tol_rel=0.0)
[S10] ⇄ pheromone p=0.282 → S3@127.0.0.1:49103
[S4] ⇄ pheromone p=0.308 → S7@127.0.0.1:49108
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=10 metric=0.7111 head_norm=1.028227
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.113396e-01
[S2] stored merged vector for next round verification (round=10)
[S2] DEBUG after merge:  round=10 metric=0.7006 head_norm=1.037034 delta_norm=0.111340
[S2] aggregate: ROLLBACK (f1_val pre=0.711 post=0.701 tol_abs=0.005 tol_rel=0.0)
[S2] ⇄ pheromone p=0.390 → S9@127.0.0.1:49110
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=10 metric=0.4062 head_norm=1.406281
[S13] _apply_head_vector_avg (torch): Δ‖w‖=9.064198e-02
[S13] stored merged vector for next round verification (round=10)
[S13] DEBUG after merge:  round=10 metric=0.3985 head_norm=1.433038 delta_norm=0.090642
[S13] aggregate: ROLLBACK (f1_val pre=0.406 post=0.398 tol_abs=0.005 tol_rel=0.0)
[S13] ⇄ pheromone p=0.309 → S11@127.0.0.1:49112
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=10 metric=0.3528 head_norm=0.712282
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.994073e-01
[S16] stored merged vector for next round verification (round=10)
[S16] DEBUG after merge:  round=10 metric=0.4343 head_norm=0.613818 delta_norm=0.399407
[S16] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.195 → S10@127.0.0.1:49111
[S3] ⇄ pheromone p=0.444 → S4@127.0.0.1:49104
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=10 metric=0.4007 head_norm=0.972849
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.177794e-01
[S9] stored merged vector for next round verification (round=10)
[S9] DEBUG after merge:  round=10 metric=0.4184 head_norm=0.993967 delta_norm=0.117779
[S9] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.238 → S6@127.0.0.1:49107
[S8] ⇄ pheromone p=0.370 → S13@127.0.0.1:49113
[S17] ⇄ pheromone p=0.200 → S4@127.0.0.1:49104
[S2] START round=11 head_norm_before_train=1.037034 cos_to_last_merge=1.0000 (last merge round=10)
[S2] round=11 local utility u=0.028317 metrics={'f1_val': 0.6986896439092822, 'auprc': 0.7764452383681997, 'loss_val': 0.6113259141014248, 'psi': 0.7297918816928493}-{'f1_val': 0.7111100576400716, 'auprc': 0.7736501278570944, 'loss_val': 0.7340967626927483, 'psi': 0.7361260857268808}
[S3] START round=11 head_norm_before_train=1.534210 (no previous merge yet)
[S3] round=11 local utility u=0.000000 metrics={'f1_val': 0.5889486595230284, 'auprc': 0.9995047020562668, 'loss_val': 0.5262324589564176, 'psi': 0.7531710765363238}-{'f1_val': 0.700330919019862, 'auprc': 0.9978452532728341, 'loss_val': 0.4419517026009716, 'psi': 0.8193366527210508}
[S4] START round=11 head_norm_before_train=1.164580 cos_to_last_merge=0.9722 (last merge round=7)
[S4] round=11 local utility u=0.771912 metrics={'f1_val': 0.6638395282605308, 'auprc': 0.660832269018239, 'loss_val': 0.545940338982983, 'psi': 0.6626366245636142}-{'f1_val': 0.420373061457001, 'auprc': 0.6624189982900216, 'loss_val': 0.6337261272179048, 'psi': 0.5171914361902092}
[S5] START round=11 head_norm_before_train=1.397743 (no previous merge yet)
[S5] round=11 local utility u=0.000000 metrics={'f1_val': 0.41774624146170947, 'auprc': 0.8593964955777896, 'loss_val': 0.7203057065568337, 'psi': 0.5944063431081416}-{'f1_val': 0.41758608903622574, 'auprc': 0.9313679283948189, 'loss_val': 0.72241654288041, 'psi': 0.6230988247796629}
[S6] START round=11 head_norm_before_train=0.899760 cos_to_last_merge=1.0000 (last merge round=10)
[S6] round=11 local utility u=0.322186 metrics={'f1_val': 0.5980603358493177, 'auprc': 0.9648731336582789, 'loss_val': 0.6874044925603027, 'psi': 0.7447854549729022}-{'f1_val': 0.5003905554303996, 'auprc': 0.9719922500220973, 'loss_val': 0.7671159563051984, 'psi': 0.6890312332670787}
[S7] START round=11 head_norm_before_train=1.068940 cos_to_last_merge=1.0000 (last merge round=10)
[S7] round=11 local utility u=0.000000 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.6176017908456252, 'loss_val': 0.8886717048232773, 'psi': 0.49706678720486414}-{'f1_val': 0.41671011811102343, 'auprc': 0.677530282988148, 'loss_val': 0.9194323766764547, 'psi': 0.5210381840618732}
[S8] START round=11 head_norm_before_train=1.464923 (no previous merge yet)
[S8] round=11 local utility u=0.205645 metrics={'f1_val': 0.701080486870783, 'auprc': 0.9979886191284906, 'loss_val': 0.433148971732511, 'psi': 0.819843739773866}-{'f1_val': 0.700123921499437, 'auprc': 0.8876366602005535, 'loss_val': 0.5076429034508265, 'psi': 0.7751290169798837}
[S9] START round=11 head_norm_before_train=0.993967 cos_to_last_merge=1.0000 (last merge round=10)
[S9] round=11 local utility u=0.943082 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9901410877667554, 'loss_val': 0.5307891443681062, 'psi': 0.8167863835707133}-{'f1_val': 0.40065388838226906, 'auprc': 0.999489687554236, 'loss_val': 0.6416229060469874, 'psi': 0.6401882080510558}
[S10] START round=11 head_norm_before_train=1.340693 cos_to_last_merge=1.0000 (last merge round=10)
[S10] round=11 local utility u=0.490432 metrics={'f1_val': 0.6996249493750508, 'auprc': 0.9350750160128715, 'loss_val': 0.6321435717512777, 'psi': 0.7938049760301791}-{'f1_val': 0.6988658387082196, 'auprc': 0.6647055998478082, 'loss_val': 0.7973441931642833, 'psi': 0.6852017431640551}
[S11] START round=11 head_norm_before_train=0.820957 cos_to_last_merge=1.0000 (last merge round=10)
[S11] round=11 local utility u=0.017451 metrics={'f1_val': 0.7018246587012323, 'auprc': 0.9148125954827598, 'loss_val': 0.7152997261626939, 'psi': 0.7870198334138434}-{'f1_val': 0.7015826949324591, 'auprc': 0.9386100699211066, 'loss_val': 0.820141616250472, 'psi': 0.7963936449279181}
[S13] START round=11 head_norm_before_train=1.433038 cos_to_last_merge=1.0000 (last merge round=10)
[S13] round=11 local utility u=0.520502 metrics={'f1_val': 0.6732459141382546, 'auprc': 0.5429154249629728, 'loss_val': 0.8845615444724213, 'psi': 0.6211137184681419}-{'f1_val': 0.4061580226359609, 'auprc': 0.7293422528995628, 'loss_val': 0.8823186457299761, 'psi': 0.5354317147414016}
[S14] START round=11 head_norm_before_train=1.631337 (no previous merge yet)
[S14] round=11 local utility u=0.354921 metrics={'f1_val': 0.996249506438875, 'auprc': 0.9991445746026473, 'loss_val': 0.28059061484206155, 'psi': 0.9974075337043838}-{'f1_val': 0.9041210432679754, 'auprc': 0.9945976371121787, 'loss_val': 0.4240215505182072, 'psi': 0.9403116808056566}
[S15] START round=11 head_norm_before_train=1.057554 cos_to_last_merge=0.9092 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.909
[S15] round=11 local utility u=0.000000 metrics={'f1_val': 0.6972060456308447, 'auprc': 0.7766947947603687, 'loss_val': 0.540035498395043, 'psi': 0.7290015452826543}-{'f1_val': 0.6932870653774112, 'auprc': 0.962712663923894, 'loss_val': 0.6441087667623281, 'psi': 0.8010573047960043}
[S16] START round=11 head_norm_before_train=0.613818 cos_to_last_merge=1.0000 (last merge round=10)
[S16] round=11 local utility u=0.228245 metrics={'f1_val': 0.43669027937366955, 'auprc': 0.537921440133039, 'loss_val': 1.0215882629058661, 'psi': 0.4771827436774173}-{'f1_val': 0.3527851701339047, 'auprc': 0.5551747382405373, 'loss_val': 1.0264083705693963, 'psi': 0.43374099737655775}
[S17] START round=11 head_norm_before_train=1.185222 cos_to_last_merge=0.8743 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.874
[S17] round=11 local utility u=0.080366 metrics={'f1_val': 0.3350461482407392, 'auprc': 0.7112872723477589, 'loss_val': 1.0557667587230704, 'psi': 0.4855425978835471}-{'f1_val': 0.32911254918772886, 'auprc': 0.6854505453515229, 'loss_val': 1.1033865725555245, 'psi': 0.47164774765324646}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:49108
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S2] → sending delta(kind=head bytes=1790) to S9@127.0.0.1:49110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:49116
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S13@127.0.0.1:49113
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:49103
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:49107
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:49112
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] → sending delta(kind=head bytes=1794) to S11@127.0.0.1:49112
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:49111
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] → sending delta(kind=head bytes=1804) to S10@127.0.0.1:49111
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S4@127.0.0.1:49104
[S13] sending update (kind=head size=1794 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1790 to 1 peers)
[S8] sending update (kind=head size=1793 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1804 to 1 peers)
[S11] sending update (kind=head size=1793 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1796) from S9
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.039073)
[S6] loaded HEAD from S9 (vec_in norm=1.039073)
[S6] cosine check vs S9: cos=0.9607
[S6] BUFFERED delta from S9 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1798) from S4
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.218266)
[S7] loaded HEAD from S4 (vec_in norm=1.218266)
[S7] cosine check vs S4: cos=0.9808
[S7] BUFFERED delta from S4 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1793) from S11
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=0.859427)
[S16] loaded HEAD from S11 (vec_in norm=0.859427)
[S16] cosine check vs S11: cos=0.7987
[S16] BUFFERED delta from S11 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1799) from S16
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.661074)
[S10] loaded HEAD from S16 (vec_in norm=0.661074)
[S10] cosine check vs S16: cos=0.3008
[S10] BUFFERED delta from S16 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1794) from S13
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.455969)
[S11] loaded HEAD from S13 (vec_in norm=1.455969)
[S11] cosine check vs S13: cos=0.7976
[S11] BUFFERED delta from S13 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1793) from S8
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.489146)
[S13] loaded HEAD from S8 (vec_in norm=1.489146)
[S13] cosine check vs S8: cos=0.9945
[S13] BUFFERED delta from S8 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1798) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.939765)
[S11] loaded HEAD from S6 (vec_in norm=0.939765)
[S11] cosine check vs S6: cos=0.7942
[S11] BUFFERED delta from S6 (total buffered=2)
[S9] RECEIVED delta(kind=head bytes=1790) from S2
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.085611)
[S9] loaded HEAD from S2 (vec_in norm=1.085611)
[S9] cosine check vs S2: cos=0.9789
[S9] BUFFERED delta from S2 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1804) from S14
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.665213)
[S10] loaded HEAD from S14 (vec_in norm=1.665213)
[S10] cosine check vs S14: cos=0.9856
[S10] BUFFERED delta from S14 (total buffered=2)
[S17] sending update (kind=head size=1804 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1804) from S17
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.207042)
[S4] loaded HEAD from S17 (vec_in norm=1.207042)
[S4] cosine check vs S17: cos=0.9147
[S4] BUFFERED delta from S17 (total buffered=1)
[S10] sending update (kind=head size=1796 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1796) from S10
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.373216)
[S3] loaded HEAD from S10 (vec_in norm=1.373216)
[S3] cosine check vs S10: cos=-0.1678
[S3] DROPPED delta from S10 (cos=-0.1678 < 0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=11 metric=0.4167 head_norm=1.095181
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.287883e-01
[S7] stored merged vector for next round verification (round=11)
[S7] DEBUG after merge:  round=11 metric=0.4167 head_norm=1.151178 delta_norm=0.128788
[S7] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=11 metric=0.6638 head_norm=1.218266
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.505086e-01
[S4] stored merged vector for next round verification (round=11)
[S4] DEBUG after merge:  round=11 metric=0.6653 head_norm=1.186510 delta_norm=0.250509
[S4] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=11 metric=0.7018 head_norm=0.859427
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.764059e-01
[S11] stored merged vector for next round verification (round=11)
[S11] DEBUG after merge:  round=11 metric=0.7021 head_norm=0.922406 delta_norm=0.176406
[S11] aggregate: ACCEPT kept=['S13', 'S6'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=11 metric=0.7012 head_norm=1.039073
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.116289e-01
[S9] stored merged vector for next round verification (round=11)
[S9] DEBUG after merge:  round=11 metric=0.7012 head_norm=1.056717 delta_norm=0.111629
[S9] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=11 metric=0.6732 head_norm=1.455969
[S13] _apply_head_vector_avg (torch): Δ‖w‖=7.927623e-02
[S13] stored merged vector for next round verification (round=11)
[S13] DEBUG after merge:  round=11 metric=0.6696 head_norm=1.470516 delta_norm=0.079276
[S13] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=11 metric=0.5981 head_norm=0.939765
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.472168e-01
[S6] stored merged vector for next round verification (round=11)
[S6] DEBUG after merge:  round=11 metric=0.4803 head_norm=0.979664 delta_norm=0.147217
[S6] aggregate: ROLLBACK (f1_val pre=0.598 post=0.480 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=11 metric=0.4367 head_norm=0.661074
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.588700e-01
[S16] stored merged vector for next round verification (round=11)
[S16] DEBUG after merge:  round=11 metric=0.4367 head_norm=0.721667 delta_norm=0.258870
[S16] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=11 metric=0.6996 head_norm=1.373216
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.658717e-01
[S10] stored merged vector for next round verification (round=11)
[S10] DEBUG after merge:  round=11 metric=0.6989 head_norm=1.155054 delta_norm=0.265872
[S10] aggregate: ACCEPT kept=['S16', 'S14'] (k=2/2) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.085611 cos_to_last_merge=0.9969 (last merge round=10)
[S2] round=12 local utility u=0.000000 metrics={'f1_val': 0.6969865609021697, 'auprc': 0.7451071313698995, 'loss_val': 0.5221978197046164, 'psi': 0.7162347890892616}-{'f1_val': 0.6986896439092822, 'auprc': 0.7764452383681997, 'loss_val': 0.6113259141014248, 'psi': 0.7297918816928493}
[S3] START round=12 head_norm_before_train=1.569086 (no previous merge yet)
[S3] round=12 local utility u=0.301381 metrics={'f1_val': 0.6715433818800839, 'auprc': 0.9995802954721016, 'loss_val': 0.4192657341354827, 'psi': 0.802758147316891}-{'f1_val': 0.5889486595230284, 'auprc': 0.9995047020562668, 'loss_val': 0.5262324589564176, 'psi': 0.7531710765363238}
[S4] START round=12 head_norm_before_train=1.186510 cos_to_last_merge=1.0000 (last merge round=11)
[S4] round=12 local utility u=0.023365 metrics={'f1_val': 0.6671413354828197, 'auprc': 0.6589179062249926, 'loss_val': 0.513277831162373, 'psi': 0.6638519637796889}-{'f1_val': 0.6638395282605308, 'auprc': 0.660832269018239, 'loss_val': 0.545940338982983, 'psi': 0.6626366245636142}
[S5] START round=12 head_norm_before_train=1.424778 (no previous merge yet)
[S5] round=12 local utility u=0.920240 metrics={'f1_val': 0.6952541832445711, 'auprc': 0.8645322791584751, 'loss_val': 0.5602816940876928, 'psi': 0.7629654216101327}-{'f1_val': 0.41774624146170947, 'auprc': 0.8593964955777896, 'loss_val': 0.7203057065568337, 'psi': 0.5944063431081416}
[S6] START round=12 head_norm_before_train=0.979664 cos_to_last_merge=1.0000 (last merge round=11)
[S6] round=12 local utility u=0.394096 metrics={'f1_val': 0.7105019078496762, 'auprc': 0.9657815432016712, 'loss_val': 0.5765873297198831, 'psi': 0.8126137619904742}-{'f1_val': 0.5980603358493177, 'auprc': 0.9648731336582789, 'loss_val': 0.6874044925603027, 'psi': 0.7447854549729022}
[S7] START round=12 head_norm_before_train=1.151178 cos_to_last_merge=1.0000 (last merge round=11)
[S7] round=12 local utility u=0.093638 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.6687852411477969, 'loss_val': 0.8549450795704469, 'psi': 0.5175401673257328}-{'f1_val': 0.41671011811102343, 'auprc': 0.6176017908456252, 'loss_val': 0.8886717048232773, 'psi': 0.49706678720486414}
[S8] START round=12 head_norm_before_train=1.489146 (no previous merge yet)
[S8] round=12 local utility u=0.000000 metrics={'f1_val': 0.714881305139466, 'auprc': 0.7770971143805192, 'loss_val': 0.48782523676743805, 'psi': 0.7397676288358873}-{'f1_val': 0.701080486870783, 'auprc': 0.9979886191284906, 'loss_val': 0.433148971732511, 'psi': 0.819843739773866}
[S9] START round=12 head_norm_before_train=1.056717 cos_to_last_merge=1.0000 (last merge round=11)
[S9] round=12 local utility u=0.083626 metrics={'f1_val': 0.7012182915391405, 'auprc': 0.9987542958432442, 'loss_val': 0.3893862326621183, 'psi': 0.820232693260782}-{'f1_val': 0.7012165807733519, 'auprc': 0.9901410877667554, 'loss_val': 0.5307891443681062, 'psi': 0.8167863835707133}
[S10] START round=12 head_norm_before_train=1.155054 cos_to_last_merge=1.0000 (last merge round=11)
[S10] round=12 local utility u=0.141236 metrics={'f1_val': 0.7011019754182817, 'auprc': 0.9925703829021921, 'loss_val': 0.5310188765247188, 'psi': 0.8176893384118459}-{'f1_val': 0.6996249493750508, 'auprc': 0.9350750160128715, 'loss_val': 0.6321435717512777, 'psi': 0.7938049760301791}
[S11] START round=12 head_norm_before_train=0.922406 cos_to_last_merge=1.0000 (last merge round=11)
[S11] round=12 local utility u=0.035157 metrics={'f1_val': 0.7017589383281313, 'auprc': 0.9079219041299174, 'loss_val': 0.6239184737674008, 'psi': 0.7842241246488457}-{'f1_val': 0.7018246587012323, 'auprc': 0.9148125954827598, 'loss_val': 0.7152997261626939, 'psi': 0.7870198334138434}
[S13] START round=12 head_norm_before_train=1.470516 cos_to_last_merge=1.0000 (last merge round=11)
[S13] round=12 local utility u=0.191915 metrics={'f1_val': 0.6191966416394484, 'auprc': 0.7521579249782767, 'loss_val': 0.8041644007232411, 'psi': 0.6723811549749797}-{'f1_val': 0.6732459141382546, 'auprc': 0.5429154249629728, 'loss_val': 0.8845615444724213, 'psi': 0.6211137184681419}
[S14] START round=12 head_norm_before_train=1.665213 (no previous merge yet)
[S14] round=12 local utility u=0.023568 metrics={'f1_val': 0.99717063186501, 'auprc': 0.9971980976914178, 'loss_val': 0.23314209807854216, 'psi': 0.997181618195573}-{'f1_val': 0.996249506438875, 'auprc': 0.9991445746026473, 'loss_val': 0.28059061484206155, 'psi': 0.9974075337043838}
[S15] START round=12 head_norm_before_train=1.112418 cos_to_last_merge=0.8900 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.890
[S15] round=12 local utility u=0.225694 metrics={'f1_val': 0.6731085437703954, 'auprc': 0.9547669842577982, 'loss_val': 0.47827934793965104, 'psi': 0.7857719199653566}-{'f1_val': 0.6972060456308447, 'auprc': 0.7766947947603687, 'loss_val': 0.540035498395043, 'psi': 0.7290015452826543}
[S16] START round=12 head_norm_before_train=0.721667 cos_to_last_merge=1.0000 (last merge round=11)
[S16] round=12 local utility u=0.231548 metrics={'f1_val': 0.46074278720712925, 'auprc': 0.6106613864147472, 'loss_val': 0.921026955825366, 'psi': 0.5207102268901764}-{'f1_val': 0.43669027937366955, 'auprc': 0.537921440133039, 'loss_val': 1.0215882629058661, 'psi': 0.4771827436774173}
[S17] START round=12 head_norm_before_train=1.207042 cos_to_last_merge=0.8635 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.864
[S17] round=12 local utility u=0.219856 metrics={'f1_val': 0.36361236564975963, 'auprc': 0.7433657471433588, 'loss_val': 0.8836882677242553, 'psi': 0.5155137182471993}-{'f1_val': 0.3350461482407392, 'auprc': 0.7112872723477589, 'loss_val': 1.0557667587230704, 'psi': 0.4855425978835471}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S9] → sending delta(kind=head bytes=1789) to S2@127.0.0.1:49102
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S6@127.0.0.1:49107
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:49111
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S10] → sending delta(kind=head bytes=1789) to S14@127.0.0.1:49114
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:49109
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S6] → sending delta(kind=head bytes=1788) to S9@127.0.0.1:49110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:49104
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S15] sending update (kind=head size=1791 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1795 to 1 peers)
[S11] sending update (kind=head size=1794 to 1 peers)
[S10] sending update (kind=head size=1789 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1788 to 1 peers)
[S9] sending update (kind=head size=1789 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1789) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.193502)
[S14] loaded HEAD from S10 (vec_in norm=1.193502)
[S14] cosine check vs S10: cos=0.9686
[S14] BUFFERED delta from S10 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1795) from S13
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.494318)
[S8] loaded HEAD from S13 (vec_in norm=1.494318)
[S8] cosine check vs S13: cos=0.9956
[S8] BUFFERED delta from S13 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1802) from S3
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.597590)
[S10] loaded HEAD from S3 (vec_in norm=1.597590)
[S10] cosine check vs S3: cos=-0.1662
[S10] DROPPED delta from S3 (cos=-0.1662 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1788) from S6
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.017287)
[S9] loaded HEAD from S6 (vec_in norm=1.017287)
[S9] cosine check vs S6: cos=0.9728
[S9] BUFFERED delta from S6 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1789) from S9
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.106092)
[S2] loaded HEAD from S9 (vec_in norm=1.106092)
[S2] cosine check vs S9: cos=0.9840
[S2] BUFFERED delta from S9 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1796) from S7
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.175792)
[S4] loaded HEAD from S7 (vec_in norm=1.175792)
[S4] cosine check vs S7: cos=0.9765
[S4] BUFFERED delta from S7 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1794) from S11
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=0.958803)
[S6] loaded HEAD from S11 (vec_in norm=0.958803)
[S6] cosine check vs S11: cos=0.7656
[S6] BUFFERED delta from S11 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:49112
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:49103
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] sending update (kind=head size=1793 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] RECEIVED delta(kind=head bytes=1796) from S16
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.765633)
[S11] loaded HEAD from S16 (vec_in norm=0.765633)
[S11] cosine check vs S16: cos=0.9163
[S11] BUFFERED delta from S16 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1801) from S4
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.230575)
[S3] loaded HEAD from S4 (vec_in norm=1.230575)
[S3] cosine check vs S4: cos=-0.1126
[S3] DROPPED delta from S4 (cos=-0.1126 < 0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=12 metric=0.7149 head_norm=1.513228
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.155795e-02
[S8] stored merged vector for next round verification (round=12)
[S8] DEBUG after merge:  round=12 metric=0.7149 head_norm=1.502099 delta_norm=0.071558
[S8] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=12 metric=0.7012 head_norm=1.106092
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.315022e-01
[S9] stored merged vector for next round verification (round=12)
[S9] DEBUG after merge:  round=12 metric=0.7012 head_norm=1.054449 delta_norm=0.131502
[S9] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=12 metric=0.7105 head_norm=1.017287
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.393865e-01
[S6] stored merged vector for next round verification (round=12)
[S6] DEBUG after merge:  round=12 metric=0.7107 head_norm=0.928388 delta_norm=0.339386
[S6] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=12 metric=0.7018 head_norm=0.958803
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.001347e-01
[S11] stored merged vector for next round verification (round=12)
[S11] DEBUG after merge:  round=12 metric=0.7018 head_norm=0.844212 delta_norm=0.200135
[S11] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=12 metric=0.9972 head_norm=1.691481
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.060725e-01
[S14] stored merged vector for next round verification (round=12)
[S14] DEBUG after merge:  round=12 metric=0.9972 head_norm=1.431466 delta_norm=0.306073
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=12 metric=0.6970 head_norm=1.137541
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.014105e-01
[S2] stored merged vector for next round verification (round=12)
[S2] DEBUG after merge:  round=12 metric=0.6970 head_norm=1.117334 delta_norm=0.101411
[S2] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=12 metric=0.6671 head_norm=1.230575
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.332084e-01
[S4] stored merged vector for next round verification (round=12)
[S4] DEBUG after merge:  round=12 metric=0.6668 head_norm=1.196100 delta_norm=0.133208
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.117334 cos_to_last_merge=1.0000 (last merge round=12)
[S2] round=13 local utility u=0.000000 metrics={'f1_val': 0.6984284904282416, 'auprc': 0.7112340790111431, 'loss_val': 0.44512371467117146, 'psi': 0.7035507258614022}-{'f1_val': 0.6969865609021697, 'auprc': 0.7451071313698995, 'loss_val': 0.5221978197046164, 'psi': 0.7162347890892616}
[S3] START round=13 head_norm_before_train=1.597590 (no previous merge yet)
[S3] round=13 local utility u=0.000000 metrics={'f1_val': 0.6428977324631927, 'auprc': 0.9997908123448891, 'loss_val': 0.4298769889154692, 'psi': 0.7856549644158712}-{'f1_val': 0.6715433818800839, 'auprc': 0.9995802954721016, 'loss_val': 0.4192657341354827, 'psi': 0.802758147316891}
[S4] START round=13 head_norm_before_train=1.196100 cos_to_last_merge=1.0000 (last merge round=12)
[S4] round=13 local utility u=0.249139 metrics={'f1_val': 0.6670236276197749, 'auprc': 0.801121982661932, 'loss_val': 0.4409049751689758, 'psi': 0.7206629696366378}-{'f1_val': 0.6671413354828197, 'auprc': 0.6589179062249926, 'loss_val': 0.513277831162373, 'psi': 0.6638519637796889}
[S5] START round=13 head_norm_before_train=1.449236 (no previous merge yet)
[S5] round=13 local utility u=0.223162 metrics={'f1_val': 0.7010644289311239, 'auprc': 0.968950823613107, 'loss_val': 0.4620750119485915, 'psi': 0.8082189868039171}-{'f1_val': 0.6952541832445711, 'auprc': 0.8645322791584751, 'loss_val': 0.5602816940876928, 'psi': 0.7629654216101327}
[S6] START round=13 head_norm_before_train=0.928388 cos_to_last_merge=1.0000 (last merge round=12)
[S6] round=13 local utility u=0.000000 metrics={'f1_val': 0.7103285141806854, 'auprc': 0.8354036680379477, 'loss_val': 0.5387523301156574, 'psi': 0.7603585757235904}-{'f1_val': 0.7105019078496762, 'auprc': 0.9657815432016712, 'loss_val': 0.5765873297198831, 'psi': 0.8126137619904742}
[S7] START round=13 head_norm_before_train=1.175792 cos_to_last_merge=0.9980 (last merge round=11)
[S7] round=13 local utility u=0.000000 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.6659679548455051, 'loss_val': 0.8573177505892996, 'psi': 0.5164132528048161}-{'f1_val': 0.41671011811102343, 'auprc': 0.6687852411477969, 'loss_val': 0.8549450795704469, 'psi': 0.5175401673257328}
[S8] START round=13 head_norm_before_train=1.502099 cos_to_last_merge=1.0000 (last merge round=12)
[S8] round=13 local utility u=0.405568 metrics={'f1_val': 0.7147063974352749, 'auprc': 0.998127945431257, 'loss_val': 0.3387326311165301, 'psi': 0.8280750166336677}-{'f1_val': 0.714881305139466, 'auprc': 0.7770971143805192, 'loss_val': 0.48782523676743805, 'psi': 0.7397676288358873}
[S9] START round=13 head_norm_before_train=1.054449 cos_to_last_merge=1.0000 (last merge round=12)
[S9] round=13 local utility u=0.014365 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9953660838933118, 'loss_val': 0.3504820625270676, 'psi': 0.8188763820213358}-{'f1_val': 0.7012182915391405, 'auprc': 0.9987542958432442, 'loss_val': 0.3893862326621183, 'psi': 0.820232693260782}
[S10] START round=13 head_norm_before_train=1.193502 cos_to_last_merge=0.9972 (last merge round=11)
[S10] round=13 local utility u=0.067687 metrics={'f1_val': 0.7012746546573891, 'auprc': 0.9953697526139691, 'loss_val': 0.4050781112407605, 'psi': 0.8189126938400211}-{'f1_val': 0.7011019754182817, 'auprc': 0.9925703829021921, 'loss_val': 0.5310188765247188, 'psi': 0.8176893384118459}
[S11] START round=13 head_norm_before_train=0.844212 cos_to_last_merge=1.0000 (last merge round=12)
[S11] round=13 local utility u=0.023803 metrics={'f1_val': 0.7021324793760719, 'auprc': 0.9087832501727375, 'loss_val': 0.5811373458095166, 'psi': 0.7847927876947383}-{'f1_val': 0.7017589383281313, 'auprc': 0.9079219041299174, 'loss_val': 0.6239184737674008, 'psi': 0.7842241246488457}
[S13] START round=13 head_norm_before_train=1.494318 cos_to_last_merge=0.9993 (last merge round=11)
[S13] round=13 local utility u=0.000000 metrics={'f1_val': 0.37148979094291945, 'auprc': 0.594404468578018, 'loss_val': 0.8975600637004486, 'psi': 0.46065566199695884}-{'f1_val': 0.6191966416394484, 'auprc': 0.7521579249782767, 'loss_val': 0.8041644007232411, 'psi': 0.6723811549749797}
[S14] START round=13 head_norm_before_train=1.431466 cos_to_last_merge=1.0000 (last merge round=12)
[S14] round=13 local utility u=0.032654 metrics={'f1_val': 0.9974127808288098, 'auprc': 0.9992153932418809, 'loss_val': 0.17533892929463754, 'psi': 0.9981338257940382}-{'f1_val': 0.99717063186501, 'auprc': 0.9971980976914178, 'loss_val': 0.23314209807854216, 'psi': 0.997181618195573}
[S15] START round=13 head_norm_before_train=1.169594 cos_to_last_merge=0.8707 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.871
[S15] round=13 local utility u=0.152555 metrics={'f1_val': 0.6940531275915237, 'auprc': 0.9696193353505858, 'loss_val': 0.34339326727223923, 'psi': 0.8042796106951485}-{'f1_val': 0.6731085437703954, 'auprc': 0.9547669842577982, 'loss_val': 0.47827934793965104, 'psi': 0.7857719199653566}
[S16] START round=13 head_norm_before_train=0.765633 cos_to_last_merge=0.9920 (last merge round=11)
[S16] round=13 local utility u=0.718626 metrics={'f1_val': 0.5546941971827423, 'auprc': 0.8647740438060695, 'loss_val': 0.8098208089182717, 'psi': 0.6787261358320732}-{'f1_val': 0.46074278720712925, 'auprc': 0.6106613864147472, 'loss_val': 0.921026955825366, 'psi': 0.5207102268901764}
[S17] START round=13 head_norm_before_train=1.225428 cos_to_last_merge=0.8539 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.854
[S17] round=13 local utility u=0.045529 metrics={'f1_val': 0.3652738005862376, 'auprc': 0.7527793058100738, 'loss_val': 0.8308400414215312, 'psi': 0.5202760026757721}-{'f1_val': 0.36361236564975963, 'auprc': 0.7433657471433588, 'loss_val': 0.8836882677242553, 'psi': 0.5155137182471993}
[S2]  timeout peer S3
[S3]  timeout peer S2
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:49103
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:49114
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:49107
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] sending update (kind=head size=1794 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] → sending delta(kind=head bytes=1794) to S2@127.0.0.1:49102
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:49112
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1794 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1800) from S4
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.239824)
[S3] loaded HEAD from S4 (vec_in norm=1.239824)
[S3] cosine check vs S4: cos=-0.1198
[S3] DROPPED delta from S4 (cos=-0.1198 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1802) from S16
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.820652)
[S11] loaded HEAD from S16 (vec_in norm=0.820652)
[S11] cosine check vs S16: cos=0.9512
[S11] BUFFERED delta from S16 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1796) from S11
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=0.891812)
[S6] loaded HEAD from S11 (vec_in norm=0.891812)
[S6] cosine check vs S11: cos=0.9094
[S6] BUFFERED delta from S11 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1796) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.239830)
[S14] loaded HEAD from S10 (vec_in norm=1.239830)
[S14] cosine check vs S10: cos=0.9810
[S14] BUFFERED delta from S10 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1794) from S9
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.107828)
[S2] loaded HEAD from S9 (vec_in norm=1.107828)
[S2] cosine check vs S9: cos=0.9749
[S2] BUFFERED delta from S9 (total buffered=1)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=13 metric=0.6984 head_norm=1.164836
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.304138e-01
[S2] stored merged vector for next round verification (round=13)
[S2] DEBUG after merge:  round=13 metric=0.6984 head_norm=1.129183 delta_norm=0.130414
[S2] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=13 metric=0.7021 head_norm=0.891812
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.383018e-01
[S11] stored merged vector for next round verification (round=13)
[S11] DEBUG after merge:  round=13 metric=0.7021 head_norm=0.845737 delta_norm=0.138302
[S11] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=13 metric=0.9974 head_norm=1.462806
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.722759e-01
[S14] stored merged vector for next round verification (round=13)
[S14] DEBUG after merge:  round=13 metric=0.9972 head_norm=1.344920 delta_norm=0.172276
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=13 metric=0.7103 head_norm=0.968367
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.014600e-01
[S6] stored merged vector for next round verification (round=13)
[S6] DEBUG after merge:  round=13 metric=0.7103 head_norm=0.908815 delta_norm=0.201460
[S6] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.129183 cos_to_last_merge=1.0000 (last merge round=13)
[S2] round=14 local utility u=0.189910 metrics={'f1_val': 0.699329985880033, 'auprc': 0.8194079946067035, 'loss_val': 0.3952341808811611, 'psi': 0.7473611893707013}-{'f1_val': 0.6984284904282416, 'auprc': 0.7112340790111431, 'loss_val': 0.44512371467117146, 'psi': 0.7035507258614022}
[S3] START round=14 head_norm_before_train=1.625901 (no previous merge yet)
[S3] round=14 local utility u=0.233855 metrics={'f1_val': 0.7005813959920884, 'auprc': 0.9992069999874517, 'loss_val': 0.3065175875825193, 'psi': 0.8200316375902337}-{'f1_val': 0.6428977324631927, 'auprc': 0.9997908123448891, 'loss_val': 0.4298769889154692, 'psi': 0.7856549644158712}
[S4] START round=14 head_norm_before_train=1.239824 cos_to_last_merge=0.9990 (last merge round=12)
[S4] round=14 local utility u=1.000000 metrics={'f1_val': 0.9521226448272749, 'auprc': 0.9222638507428875, 'loss_val': 0.4072523514617398, 'psi': 0.94017912719352}-{'f1_val': 0.6670236276197749, 'auprc': 0.801121982661932, 'loss_val': 0.4409049751689758, 'psi': 0.7206629696366378}
[S5] START round=14 head_norm_before_train=1.475828 (no previous merge yet)
[S5] round=14 local utility u=0.000000 metrics={'f1_val': 0.41806969411822237, 'auprc': 0.790376389421658, 'loss_val': 0.7254327819837845, 'psi': 0.5669923722395966}-{'f1_val': 0.7010644289311239, 'auprc': 0.968950823613107, 'loss_val': 0.4620750119485915, 'psi': 0.8082189868039171}
[S6] START round=14 head_norm_before_train=0.908815 cos_to_last_merge=1.0000 (last merge round=13)
[S6] round=14 local utility u=0.000000 metrics={'f1_val': 0.709965291213394, 'auprc': 0.8188790470204466, 'loss_val': 0.5309631826152761, 'psi': 0.753530793536215}-{'f1_val': 0.7103285141806854, 'auprc': 0.8354036680379477, 'loss_val': 0.5387523301156574, 'psi': 0.7603585757235904}
[S7] START round=14 head_norm_before_train=1.202627 cos_to_last_merge=0.9929 (last merge round=11)
[S7] round=14 local utility u=0.199272 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.7654719107834767, 'loss_val': 0.7572853481520417, 'psi': 0.5562148351800047}-{'f1_val': 0.41671011811102343, 'auprc': 0.6659679548455051, 'loss_val': 0.8573177505892996, 'psi': 0.5164132528048161}
[S8] START round=14 head_norm_before_train=1.522517 cos_to_last_merge=0.9993 (last merge round=12)
[S8] round=14 local utility u=0.000000 metrics={'f1_val': 0.7149691070173029, 'auprc': 0.7950302686810139, 'loss_val': 0.4185813846761598, 'psi': 0.7469935716827873}-{'f1_val': 0.7147063974352749, 'auprc': 0.998127945431257, 'loss_val': 0.3387326311165301, 'psi': 0.8280750166336677}
[S9] START round=14 head_norm_before_train=1.107828 cos_to_last_merge=0.9980 (last merge round=12)
[S9] round=14 local utility u=0.938400 metrics={'f1_val': 0.9941601000394567, 'auprc': 0.9981945965266661, 'loss_val': 0.2398282308450494, 'psi': 0.9957738986343404}-{'f1_val': 0.7012165807733519, 'auprc': 0.9953660838933118, 'loss_val': 0.3504820625270676, 'psi': 0.8188763820213358}
[S10] START round=14 head_norm_before_train=1.239830 cos_to_last_merge=0.9910 (last merge round=11)
[S10] round=14 local utility u=0.000000 metrics={'f1_val': 0.70100473150176, 'auprc': 0.9647710327912414, 'loss_val': 0.37418513611615545, 'psi': 0.8065112520175526}-{'f1_val': 0.7012746546573891, 'auprc': 0.9953697526139691, 'loss_val': 0.4050781112407605, 'psi': 0.8189126938400211}
[S11] START round=14 head_norm_before_train=0.845737 cos_to_last_merge=1.0000 (last merge round=13)
[S11] round=14 local utility u=0.045051 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9127393923857005, 'loss_val': 0.5002696529196061, 'psi': 0.786111844706435}-{'f1_val': 0.7021324793760719, 'auprc': 0.9087832501727375, 'loss_val': 0.5811373458095166, 'psi': 0.7847927876947383}
[S13] START round=14 head_norm_before_train=1.515338 cos_to_last_merge=0.9979 (last merge round=11)
[S13] round=14 local utility u=1.000000 metrics={'f1_val': 0.5783027832936243, 'auprc': 0.8409388305809954, 'loss_val': 0.7413175547802101, 'psi': 0.6833572022085728}-{'f1_val': 0.37148979094291945, 'auprc': 0.594404468578018, 'loss_val': 0.8975600637004486, 'psi': 0.46065566199695884}
[S14] START round=14 head_norm_before_train=1.344920 cos_to_last_merge=1.0000 (last merge round=13)
[S14] round=14 local utility u=0.002511 metrics={'f1_val': 0.9976986947957521, 'auprc': 0.999509305879366, 'loss_val': 0.17291391871995868, 'psi': 0.9984229392291977}-{'f1_val': 0.9974127808288098, 'auprc': 0.9992153932418809, 'loss_val': 0.17533892929463754, 'psi': 0.9981338257940382}
[S15] START round=14 head_norm_before_train=1.224516 cos_to_last_merge=0.8545 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.854
[S15] round=14 local utility u=0.000000 metrics={'f1_val': 0.6966151656399058, 'auprc': 0.9671307301350752, 'loss_val': 0.35972465865823894, 'psi': 0.8048213914379736}-{'f1_val': 0.6940531275915237, 'auprc': 0.9696193353505858, 'loss_val': 0.34339326727223923, 'psi': 0.8042796106951485}
[S16] START round=14 head_norm_before_train=0.820652 cos_to_last_merge=0.9743 (last merge round=11)
[S16] round=14 local utility u=0.208183 metrics={'f1_val': 0.5752184742638248, 'auprc': 0.929743841781565, 'loss_val': 0.7115096063146927, 'psi': 0.7170286212709209}-{'f1_val': 0.5546941971827423, 'auprc': 0.8647740438060695, 'loss_val': 0.8098208089182717, 'psi': 0.6787261358320732}
[S17] START round=14 head_norm_before_train=1.245286 cos_to_last_merge=0.8462 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.846
[S17] round=14 local utility u=0.187957 metrics={'f1_val': 0.3850016017754938, 'auprc': 0.796729479903246, 'loss_val': 0.7051440253644945, 'psi': 0.5496927530265947}-{'f1_val': 0.3652738005862376, 'auprc': 0.7527793058100738, 'loss_val': 0.8308400414215312, 'psi': 0.5202760026757721}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:49115
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S3@127.0.0.1:49103
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1795 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] RECEIVED delta(kind=head bytes=1795) from S2
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.175583)
[S15] loaded HEAD from S2 (vec_in norm=1.175583)
[S15] cosine check vs S2: cos=0.9266
[S15] BUFFERED delta from S2 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S10@127.0.0.1:49111
[S4] sending update (kind=head size=1804 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1804) from S4
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.283026)
[S3] loaded HEAD from S4 (vec_in norm=1.283026)
[S3] cosine check vs S4: cos=-0.1223
[S3] DROPPED delta from S4 (cos=-0.1223 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] → sending delta(kind=head bytes=1793) to S11@127.0.0.1:49112
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1785 reason=None
[S9] → sending delta(kind=head bytes=1785) to S2@127.0.0.1:49102
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:49109
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] sending update (kind=head size=1795 to 1 peers)
[S3] sending update (kind=head size=1804 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1804) from S3
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.654820)
[S10] loaded HEAD from S3 (vec_in norm=1.654820)
[S10] cosine check vs S3: cos=-0.1717
[S10] DROPPED delta from S3 (cos=-0.1717 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:49104
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:49107
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] sending update (kind=head size=1805 to 1 peers)
[S16] sending update (kind=head size=1793 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1793) from S16
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.875794)
[S11] loaded HEAD from S16 (vec_in norm=0.875794)
[S11] cosine check vs S16: cos=0.9668
[S11] BUFFERED delta from S16 (total buffered=1)
[S13] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1785 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1785) from S9
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.155621)
[S2] loaded HEAD from S9 (vec_in norm=1.155621)
[S2] cosine check vs S9: cos=0.9853
[S2] BUFFERED delta from S9 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1797) from S13
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.532150)
[S8] loaded HEAD from S13 (vec_in norm=1.532150)
[S8] cosine check vs S13: cos=0.9931
[S8] BUFFERED delta from S13 (total buffered=1)
[S11] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1798) from S7
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.227907)
[S4] loaded HEAD from S7 (vec_in norm=1.227907)
[S4] cosine check vs S7: cos=0.9819
[S4] BUFFERED delta from S7 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1797) from S11
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=0.893819)
[S6] loaded HEAD from S11 (vec_in norm=0.893819)
[S6] cosine check vs S11: cos=0.9434
[S6] BUFFERED delta from S11 (total buffered=1)
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S5]  timeout peer S17
[S4]  timeout peer S2
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S6
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S16
[S8]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S6]  timeout peer S17
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S15
[S10]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S16
[S14]  timeout peer S17
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S16
[S2]  timeout peer S17
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=14 metric=0.6966 head_norm=1.271539
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.391057e-01
[S15] stored merged vector for next round verification (round=14)
[S15] DEBUG after merge:  round=14 metric=0.6966 head_norm=1.200930 delta_norm=0.239106
[S15] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=14 metric=0.7100 head_norm=0.949126
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.573365e-01
[S6] stored merged vector for next round verification (round=14)
[S6] DEBUG after merge:  round=14 metric=0.7100 head_norm=0.908362 delta_norm=0.157337
[S6] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=14 metric=0.7150 head_norm=1.545067
[S8] _apply_head_vector_avg (torch): Δ‖w‖=9.030014e-02
[S8] stored merged vector for next round verification (round=14)
[S8] DEBUG after merge:  round=14 metric=0.7150 head_norm=1.535970 delta_norm=0.090300
[S8] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=14 metric=0.6993 head_norm=1.175583
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.002781e-01
[S2] stored merged vector for next round verification (round=14)
[S2] DEBUG after merge:  round=14 metric=0.6991 head_norm=1.161324 delta_norm=0.100278
[S2] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=14 metric=0.9521 head_norm=1.283026
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.226476e-01
[S4] stored merged vector for next round verification (round=14)
[S4] DEBUG after merge:  round=14 metric=0.6682 head_norm=1.249765 delta_norm=0.122648
[S4] aggregate: ROLLBACK (f1_val pre=0.952 post=0.668 tol_abs=0.005 tol_rel=0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=14 metric=0.7017 head_norm=0.893819
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.143821e-01
[S11] stored merged vector for next round verification (round=14)
[S11] DEBUG after merge:  round=14 metric=0.7017 head_norm=0.877428 delta_norm=0.114382
[S11] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.161324 cos_to_last_merge=1.0000 (last merge round=14)
[S2] round=15 local utility u=0.000000 metrics={'f1_val': 0.6990717968887176, 'auprc': 0.7799795226312307, 'loss_val': 0.36387899379695204, 'psi': 0.7314348871857228}-{'f1_val': 0.699329985880033, 'auprc': 0.8194079946067035, 'loss_val': 0.3952341808811611, 'psi': 0.7473611893707013}
[S3] START round=15 head_norm_before_train=1.654820 (no previous merge yet)
[S3] round=15 local utility u=0.010912 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9988322012756964, 'loss_val': 0.28461902825626034, 'psi': 0.8199866027514584}-{'f1_val': 0.7005813959920884, 'auprc': 0.9992069999874517, 'loss_val': 0.3065175875825193, 'psi': 0.8200316375902337}
[S4] START round=15 head_norm_before_train=1.249765 cos_to_last_merge=1.0000 (last merge round=14)
[S4] round=15 local utility u=0.000000 metrics={'f1_val': 0.6322768773549452, 'auprc': 0.945328143008421, 'loss_val': 0.44537811844190134, 'psi': 0.7574973836163356}-{'f1_val': 0.9521226448272749, 'auprc': 0.9222638507428875, 'loss_val': 0.4072523514617398, 'psi': 0.94017912719352}
[S5] START round=15 head_norm_before_train=1.502811 (no previous merge yet)
[S5] round=15 local utility u=1.000000 metrics={'f1_val': 0.7011046720655897, 'auprc': 0.9978591774399701, 'loss_val': 0.3576353661285045, 'psi': 0.8198064742153419}-{'f1_val': 0.41806969411822237, 'auprc': 0.790376389421658, 'loss_val': 0.7254327819837845, 'psi': 0.5669923722395966}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] sending update (kind=head size=1793 to 1 peers)
[S6] START round=15 head_norm_before_train=0.908362 cos_to_last_merge=1.0000 (last merge round=14)
[S6] round=15 local utility u=0.211717 metrics={'f1_val': 0.709965291213394, 'auprc': 0.9470658105456519, 'loss_val': 0.49208980442763683, 'psi': 0.8048054989462972}-{'f1_val': 0.709965291213394, 'auprc': 0.8188790470204466, 'loss_val': 0.5309631826152761, 'psi': 0.753530793536215}
[S7] START round=15 head_norm_before_train=1.227907 cos_to_last_merge=0.9871 (last merge round=11)
[S7] round=15 local utility u=0.707930 metrics={'f1_val': 0.6602885533136404, 'auprc': 0.7611701966300555, 'loss_val': 0.7899901222186183, 'psi': 0.7006412106402065}-{'f1_val': 0.41671011811102343, 'auprc': 0.7654719107834767, 'loss_val': 0.7572853481520417, 'psi': 0.5562148351800047}
[S8] START round=15 head_norm_before_train=1.535970 cos_to_last_merge=1.0000 (last merge round=14)
[S8] round=15 local utility u=0.355509 metrics={'f1_val': 0.7016655216109727, 'auprc': 0.9983806882701141, 'loss_val': 0.2377927202484001, 'psi': 0.8203515882746293}-{'f1_val': 0.7149691070173029, 'auprc': 0.7950302686810139, 'loss_val': 0.4185813846761598, 'psi': 0.7469935716827873}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=15 head_norm_before_train=1.155621 cos_to_last_merge=0.9941 (last merge round=12)
[S9] round=15 local utility u=0.017299 metrics={'f1_val': 0.9937421749897083, 'auprc': 0.9991824760413208, 'loss_val': 0.20568616979708942, 'psi': 0.9959182954103534}-{'f1_val': 0.9941601000394567, 'auprc': 0.9981945965266661, 'loss_val': 0.2398282308450494, 'psi': 0.9957738986343404}
[S10] START round=15 head_norm_before_train=1.288603 cos_to_last_merge=0.9841 (last merge round=11)
[S10] round=15 local utility u=0.000000 metrics={'f1_val': 0.6829637823277876, 'auprc': 0.9864672487434403, 'loss_val': 0.3321080342834105, 'psi': 0.8043651688940487}-{'f1_val': 0.70100473150176, 'auprc': 0.9647710327912414, 'loss_val': 0.37418513611615545, 'psi': 0.8065112520175526}
[S11] START round=15 head_norm_before_train=0.877428 cos_to_last_merge=1.0000 (last merge round=14)
[S11] round=15 local utility u=0.044158 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9260448846907355, 'loss_val': 0.45186974041423245, 'psi': 0.7914340416284491}-{'f1_val': 0.7016934795869249, 'auprc': 0.9127393923857005, 'loss_val': 0.5002696529196061, 'psi': 0.786111844706435}
[S13] START round=15 head_norm_before_train=1.532150 cos_to_last_merge=0.9965 (last merge round=11)
[S13] round=15 local utility u=0.041237 metrics={'f1_val': 0.6436015778454327, 'auprc': 0.7123899318086223, 'loss_val': 0.6649893968795204, 'psi': 0.6711169194307085}-{'f1_val': 0.5783027832936243, 'auprc': 0.8409388305809954, 'loss_val': 0.7413175547802101, 'psi': 0.6833572022085728}
[S14] START round=15 head_norm_before_train=1.381191 cos_to_last_merge=0.9995 (last merge round=13)
[S14] round=15 local utility u=0.022270 metrics={'f1_val': 0.9976760408229349, 'auprc': 0.9992307403242834, 'loss_val': 0.12740329583087126, 'psi': 0.9982979206234743}-{'f1_val': 0.9976986947957521, 'auprc': 0.999509305879366, 'loss_val': 0.17291391871995868, 'psi': 0.9984229392291977}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=15 head_norm_before_train=1.200930 cos_to_last_merge=1.0000 (last merge round=14)
[S15] round=15 local utility u=0.010701 metrics={'f1_val': 0.6955917601516459, 'auprc': 0.9705790021673029, 'loss_val': 0.34252758599530053, 'psi': 0.8055866569579087}-{'f1_val': 0.6966151656399058, 'auprc': 0.9671307301350752, 'loss_val': 0.35972465865823894, 'psi': 0.8048213914379736}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] sending update (kind=head size=1794 to 1 peers)
[S16] START round=15 head_norm_before_train=0.875794 cos_to_last_merge=0.9553 (last merge round=11)
[S16] round=15 local utility u=0.323765 metrics={'f1_val': 0.6326667781530497, 'auprc': 0.9796527111480456, 'loss_val': 0.5583961257815984, 'psi': 0.7714611513510481}-{'f1_val': 0.5752184742638248, 'auprc': 0.929743841781565, 'loss_val': 0.7115096063146927, 'psi': 0.7170286212709209}
[S17] START round=15 head_norm_before_train=1.266310 cos_to_last_merge=0.8398 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.840
[S17] round=15 local utility u=0.028548 metrics={'f1_val': 0.38804231462700023, 'auprc': 0.8028020995174339, 'loss_val': 0.6845111454576284, 'psi': 0.5539462285831738}-{'f1_val': 0.3850016017754938, 'auprc': 0.796729479903246, 'loss_val': 0.7051440253644945, 'psi': 0.5496927530265947}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:49104
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:49110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:49111
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:49109
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S9] → sending delta(kind=head bytes=1791) to S2@127.0.0.1:49102
[S3] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1791 to 1 peers)
[S2] ⇄ pheromone p=0.160 → S15@127.0.0.1:49115
[S7] sending update (kind=head size=1802 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] RECEIVED delta(kind=head bytes=1791) from S9
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.199942)
[S2] loaded HEAD from S9 (vec_in norm=1.199942)
[S2] cosine check vs S9: cos=0.9898
[S2] BUFFERED delta from S9 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1798) from S3
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.678956)
[S10] loaded HEAD from S3 (vec_in norm=1.678956)
[S10] cosine check vs S3: cos=-0.1734
[S10] DROPPED delta from S3 (cos=-0.1734 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1802) from S7
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.249780)
[S4] loaded HEAD from S7 (vec_in norm=1.249780)
[S4] cosine check vs S7: cos=0.9906
[S4] BUFFERED delta from S7 (total buffered=1)
[S7] ⇄ pheromone p=0.260 → S4@127.0.0.1:49104
[S9] ⇄ pheromone p=0.319 → S2@127.0.0.1:49102
[S3] ⇄ pheromone p=0.216 → S10@127.0.0.1:49111
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:49107
[S10] ⇄ pheromone p=0.156 → S14@127.0.0.1:49114
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=15 metric=0.6323 head_norm=1.290642
[S4] _apply_head_vector_avg (torch): Δ‖w‖=8.931336e-02
[S4] stored merged vector for next round verification (round=15)
[S4] DEBUG after merge:  round=15 metric=0.9439 head_norm=1.267232 delta_norm=0.089313
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.358 → S3@127.0.0.1:49103
[S11] sending update (kind=head size=1796 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1796) from S11
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=0.926463)
[S6] loaded HEAD from S11 (vec_in norm=0.926463)
[S6] cosine check vs S11: cos=0.9586
[S6] BUFFERED delta from S11 (total buffered=1)
[S13] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1802) from S6
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.953203)
[S9] loaded HEAD from S6 (vec_in norm=0.953203)
[S9] cosine check vs S6: cos=0.7764
[S9] BUFFERED delta from S6 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1797) from S13
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.550446)
[S8] loaded HEAD from S13 (vec_in norm=1.550446)
[S8] cosine check vs S13: cos=0.9964
[S8] BUFFERED delta from S13 (total buffered=1)
[S13] ⇄ pheromone p=0.332 → S8@127.0.0.1:49109
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=15 metric=0.7100 head_norm=0.953203
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.359117e-01
[S6] stored merged vector for next round verification (round=15)
[S6] DEBUG after merge:  round=15 metric=0.7102 head_norm=0.930050 delta_norm=0.135912
[S6] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.217 → S9@127.0.0.1:49110
[S16] RoundReady barrier timeout: have=1 need=2 — continuing
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S3]  timeout peer S10
[S4]  timeout peer S3
[S4]  timeout peer S17
[S13]  timeout peer S8
[S11]  timeout peer S6
[S11]  timeout peer S13
[S9]  timeout peer S2
[S6]  timeout peer S9
[S7]  timeout peer S4
[S2]  timeout peer S15
[S10]  timeout peer S14
[S10]  timeout peer S16
[S16]  timeout peer S5
[S16]  timeout peer S7
[S16]  timeout peer S11
[S2] START round=16 head_norm_before_train=1.205098 cos_to_last_merge=0.9989 (last merge round=14)
[S2] round=16 local utility u=0.000000 metrics={'f1_val': 0.6987113246857126, 'auprc': 0.7421632176535565, 'loss_val': 0.33783852176209844, 'psi': 0.7160920818728502}-{'f1_val': 0.6990717968887176, 'auprc': 0.7799795226312307, 'loss_val': 0.36387899379695204, 'psi': 0.7314348871857228}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=16 metric=0.6987 head_norm=1.245385
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.044863e-01
[S2] stored merged vector for next round verification (round=16)
[S2] DEBUG after merge:  round=16 metric=0.6987 head_norm=1.218403 delta_norm=0.104486
[S2] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S3] START round=16 head_norm_before_train=1.678956 (no previous merge yet)
[S3] round=16 local utility u=0.000037 metrics={'f1_val': 0.7008362290767893, 'auprc': 0.9999947389684937, 'loss_val': 0.2885131397820929, 'psi': 0.8204996330334711}-{'f1_val': 0.7007562037352997, 'auprc': 0.9988322012756964, 'loss_val': 0.28461902825626034, 'psi': 0.8199866027514584}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] sending update (kind=head size=1803 to 1 peers)
[S4] START round=16 head_norm_before_train=1.267232 cos_to_last_merge=1.0000 (last merge round=15)
[S4] round=16 local utility u=0.000000 metrics={'f1_val': 0.6176984034135793, 'auprc': 0.9319219937572287, 'loss_val': 0.44042686422080085, 'psi': 0.743387839551039}-{'f1_val': 0.6322768773549452, 'auprc': 0.945328143008421, 'loss_val': 0.44537811844190134, 'psi': 0.7574973836163356}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=16 head_norm_before_train=1.523396 (no previous merge yet)
[S5] round=16 local utility u=0.000000 metrics={'f1_val': 0.7008563225598777, 'auprc': 0.8767734855780718, 'loss_val': 0.3584128655555768, 'psi': 0.7712231877671554}-{'f1_val': 0.7011046720655897, 'auprc': 0.9978591774399701, 'loss_val': 0.3576353661285045, 'psi': 0.8198064742153419}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=16 head_norm_before_train=0.930050 cos_to_last_merge=1.0000 (last merge round=15)
[S6] round=16 local utility u=0.000000 metrics={'f1_val': 0.6205594242244391, 'auprc': 0.7926867840097082, 'loss_val': 0.5854764027613357, 'psi': 0.6894103681385467}-{'f1_val': 0.709965291213394, 'auprc': 0.9470658105456519, 'loss_val': 0.49208980442763683, 'psi': 0.8048054989462972}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=16 head_norm_before_train=1.249780 cos_to_last_merge=0.9824 (last merge round=11)
[S7] round=16 local utility u=0.000000 metrics={'f1_val': 0.3760765749868473, 'auprc': 0.6299514982372931, 'loss_val': 0.9156810758649977, 'psi': 0.47762654428702567}-{'f1_val': 0.6602885533136404, 'auprc': 0.7611701966300555, 'loss_val': 0.7899901222186183, 'psi': 0.7006412106402065}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=16 head_norm_before_train=1.555477 cos_to_last_merge=0.9996 (last merge round=14)
[S8] round=16 local utility u=0.048881 metrics={'f1_val': 0.7161618468619506, 'auprc': 0.998485525616946, 'loss_val': 0.22732349094539853, 'psi': 0.8290913183639488}-{'f1_val': 0.7016655216109727, 'auprc': 0.9983806882701141, 'loss_val': 0.2377927202484001, 'psi': 0.8203515882746293}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=16 metric=0.7162 head_norm=1.577917
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.233822e-02
[S8] stored merged vector for next round verification (round=16)
[S8] DEBUG after merge:  round=16 metric=0.7150 head_norm=1.562074 delta_norm=0.082338
[S8] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S9] START round=16 head_norm_before_train=1.199942 cos_to_last_merge=0.9894 (last merge round=12)
[S9] round=16 local utility u=0.000000 metrics={'f1_val': 0.9882315997877942, 'auprc': 0.9962318153896024, 'loss_val': 0.17465272689768901, 'psi': 0.9914316860285175}-{'f1_val': 0.9937421749897083, 'auprc': 0.9991824760413208, 'loss_val': 0.20568616979708942, 'psi': 0.9959182954103534}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=16 metric=0.9882 head_norm=1.244080
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.965627e-01
[S9] stored merged vector for next round verification (round=16)
[S9] DEBUG after merge:  round=16 metric=0.9874 head_norm=1.034845 delta_norm=0.396563
[S9] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S10] START round=16 head_norm_before_train=1.334857 cos_to_last_merge=0.9778 (last merge round=11)
[S10] round=16 local utility u=0.000000 metrics={'f1_val': 0.6581134219461005, 'auprc': 0.8715858398859234, 'loss_val': 0.5673040048445954, 'psi': 0.7435023891220296}-{'f1_val': 0.6829637823277876, 'auprc': 0.9864672487434403, 'loss_val': 0.3321080342834105, 'psi': 0.8043651688940487}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=16 head_norm_before_train=0.926463 cos_to_last_merge=0.9973 (last merge round=14)
[S11] round=16 local utility u=0.119498 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9862956759535617, 'loss_val': 0.39507628727957855, 'psi': 0.8156794603604167}-{'f1_val': 0.7016934795869249, 'auprc': 0.9260448846907355, 'loss_val': 0.45186974041423245, 'psi': 0.7914340416284491}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=16 head_norm_before_train=1.550446 cos_to_last_merge=0.9950 (last merge round=11)
[S13] round=16 local utility u=0.000000 metrics={'f1_val': 0.6264726015364129, 'auprc': 0.7029645145887629, 'loss_val': 0.6539483448732633, 'psi': 0.657069366757353}-{'f1_val': 0.6436015778454327, 'auprc': 0.7123899318086223, 'loss_val': 0.6649893968795204, 'psi': 0.6711169194307085}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=16 head_norm_before_train=1.429894 cos_to_last_merge=0.9977 (last merge round=13)
[S14] round=16 local utility u=0.016746 metrics={'f1_val': 0.9976760408229349, 'auprc': 0.9991693721040132, 'loss_val': 0.09372724986991265, 'psi': 0.9982733733353664}-{'f1_val': 0.9976760408229349, 'auprc': 0.9992307403242834, 'loss_val': 0.12740329583087126, 'psi': 0.9982979206234743}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=16 head_norm_before_train=1.243172 cos_to_last_merge=0.9991 (last merge round=14)
[S15] round=16 local utility u=0.139078 metrics={'f1_val': 0.7264696873817766, 'auprc': 0.983042337764804, 'loss_val': 0.28702878832321244, 'psi': 0.8290987475349876}-{'f1_val': 0.6955917601516459, 'auprc': 0.9705790021673029, 'loss_val': 0.34252758599530053, 'psi': 0.8055866569579087}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] sending update (kind=head size=1792 to 1 peers)
[S16] START round=16 head_norm_before_train=0.936804 cos_to_last_merge=0.9359 (last merge round=11)
[S16] ⚠️ Model drifted since last merge! cos=0.936
[S16] round=16 local utility u=0.268251 metrics={'f1_val': 0.6906134692195214, 'auprc': 0.9828588569045648, 'loss_val': 0.3791923948668776, 'psi': 0.8075116242935387}-{'f1_val': 0.6326667781530497, 'auprc': 0.9796527111480456, 'loss_val': 0.5583961257815984, 'psi': 0.7714611513510481}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=16 head_norm_before_train=1.282676 cos_to_last_merge=0.8350 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.835
[S17] round=16 local utility u=0.564216 metrics={'f1_val': 0.514236851640381, 'auprc': 0.9005995846905495, 'loss_val': 0.6066384739681351, 'psi': 0.6687819448604484}-{'f1_val': 0.38804231462700023, 'auprc': 0.8028020995174339, 'loss_val': 0.6845111454576284, 'psi': 0.5539462285831738}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] START round=17 head_norm_before_train=1.218403 cos_to_last_merge=1.0000 (last merge round=16)
[S2] round=17 local utility u=0.000000 metrics={'f1_val': 0.6979904929899468, 'auprc': 0.6724175894340987, 'loss_val': 0.3371674744274472, 'psi': 0.6877613315676075}-{'f1_val': 0.6987113246857126, 'auprc': 0.7421632176535565, 'loss_val': 0.33783852176209844, 'psi': 0.7160920818728502}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=17 head_norm_before_train=1.697631 (no previous merge yet)
[S3] round=17 local utility u=0.006530 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9988322012756964, 'loss_val': 0.2714857133495079, 'psi': 0.8199866027514584}-{'f1_val': 0.7008362290767893, 'auprc': 0.9999947389684937, 'loss_val': 0.2885131397820929, 'psi': 0.8204996330334711}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=17 head_norm_before_train=1.304564 cos_to_last_merge=0.9992 (last merge round=15)
[S4] round=17 local utility u=0.013464 metrics={'f1_val': 0.6190759520787136, 'auprc': 0.9425085020194511, 'loss_val': 0.45352439454118343, 'psi': 0.7484489720550087}-{'f1_val': 0.6176984034135793, 'auprc': 0.9319219937572287, 'loss_val': 0.44042686422080085, 'psi': 0.743387839551039}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=17 head_norm_before_train=1.548680 (no previous merge yet)
[S5] round=17 local utility u=0.172063 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9790683345315897, 'loss_val': 0.31968366733773174, 'psi': 0.8119923694102404}-{'f1_val': 0.7008563225598777, 'auprc': 0.8767734855780718, 'loss_val': 0.3584128655555768, 'psi': 0.7712231877671554}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=17 head_norm_before_train=0.973198 cos_to_last_merge=0.9975 (last merge round=15)
[S6] round=17 local utility u=0.030944 metrics={'f1_val': 0.6205216692265898, 'auprc': 0.8032334263402574, 'loss_val': 0.5550012032224494, 'psi': 0.6936063720720569}-{'f1_val': 0.6205594242244391, 'auprc': 0.7926867840097082, 'loss_val': 0.5854764027613357, 'psi': 0.6894103681385467}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=17 head_norm_before_train=1.269546 cos_to_last_merge=0.9784 (last merge round=11)
[S7] round=17 local utility u=1.000000 metrics={'f1_val': 0.6723787494221085, 'auprc': 0.7815388759272576, 'loss_val': 0.553472181457972, 'psi': 0.7160428000241681}-{'f1_val': 0.3760765749868473, 'auprc': 0.6299514982372931, 'loss_val': 0.9156810758649977, 'psi': 0.47762654428702567}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=17 head_norm_before_train=1.562074 cos_to_last_merge=1.0000 (last merge round=16)
[S8] round=17 local utility u=0.453097 metrics={'f1_val': 0.8614392228109606, 'auprc': 0.999369911981953, 'loss_val': 0.19544686147708826, 'psi': 0.9166114984793576}-{'f1_val': 0.7161618468619506, 'auprc': 0.998485525616946, 'loss_val': 0.22732349094539853, 'psi': 0.8290913183639488}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=17 head_norm_before_train=1.034845 cos_to_last_merge=1.0000 (last merge round=16)
[S9] round=17 local utility u=0.008805 metrics={'f1_val': 0.9954158325366191, 'auprc': 0.9981963630532042, 'loss_val': 0.20604152598654338, 'psi': 0.9965280447432532}-{'f1_val': 0.9882315997877942, 'auprc': 0.9962318153896024, 'loss_val': 0.17465272689768901, 'psi': 0.9914316860285175}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=17 head_norm_before_train=1.369624 cos_to_last_merge=0.9730 (last merge round=11)
[S10] round=17 local utility u=0.736200 metrics={'f1_val': 0.7919590240711953, 'auprc': 0.9863711030365271, 'loss_val': 0.24233366520009594, 'psi': 0.869723855657328}-{'f1_val': 0.6581134219461005, 'auprc': 0.8715858398859234, 'loss_val': 0.5673040048445954, 'psi': 0.7435023891220296}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=17 head_norm_before_train=0.971037 cos_to_last_merge=0.9919 (last merge round=14)
[S11] round=17 local utility u=0.022997 metrics={'f1_val': 0.7016282822309048, 'auprc': 0.986910941840075, 'loss_val': 0.3490859133047232, 'psi': 0.8157413460745728}-{'f1_val': 0.7019353166316534, 'auprc': 0.9862956759535617, 'loss_val': 0.39507628727957855, 'psi': 0.8156794603604167}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=17 head_norm_before_train=1.569538 cos_to_last_merge=0.9933 (last merge round=11)
[S13] round=17 local utility u=0.000000 metrics={'f1_val': 0.5970401730764539, 'auprc': 0.6320184922926604, 'loss_val': 0.6934504934509764, 'psi': 0.6110315007629364}-{'f1_val': 0.6264726015364129, 'auprc': 0.7029645145887629, 'loss_val': 0.6539483448732633, 'psi': 0.657069366757353}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=17 head_norm_before_train=1.485315 cos_to_last_merge=0.9945 (last merge round=13)
[S14] round=17 local utility u=0.006069 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9973693032085392, 'loss_val': 0.07357398185743433, 'psi': 0.9972919353068915}-{'f1_val': 0.9976760408229349, 'auprc': 0.9991693721040132, 'loss_val': 0.09372724986991265, 'psi': 0.9982733733353664}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=17 head_norm_before_train=1.287351 cos_to_last_merge=0.9964 (last merge round=14)
[S15] round=17 local utility u=0.615443 metrics={'f1_val': 0.9153389919738119, 'auprc': 0.9879906086044025, 'loss_val': 0.2042026259246312, 'psi': 0.944399638626048}-{'f1_val': 0.7264696873817766, 'auprc': 0.983042337764804, 'loss_val': 0.28702878832321244, 'psi': 0.8290987475349876}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S15] sending update (kind=head size=1791 to 1 peers)
[S16] START round=17 head_norm_before_train=0.996082 cos_to_last_merge=0.9194 (last merge round=11)
[S16] ⚠️ Model drifted since last merge! cos=0.919
[S16] round=17 local utility u=0.749409 metrics={'f1_val': 0.9364226333100425, 'auprc': 0.9919165468833566, 'loss_val': 0.3824025952726809, 'psi': 0.9586201987393681}-{'f1_val': 0.6906134692195214, 'auprc': 0.9828588569045648, 'loss_val': 0.3791923948668776, 'psi': 0.8075116242935387}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=17 head_norm_before_train=1.299294 cos_to_last_merge=0.8308 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.831
[S17] round=17 local utility u=0.000000 metrics={'f1_val': 0.3922278785622122, 'auprc': 0.8990752446840615, 'loss_val': 0.5878984409404729, 'psi': 0.594966825010952}-{'f1_val': 0.514236851640381, 'auprc': 0.9005995846905495, 'loss_val': 0.6066384739681351, 'psi': 0.6687819448604484}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=18 head_norm_before_train=1.250604 cos_to_last_merge=0.9995 (last merge round=16)
[S2] round=18 local utility u=0.000000 metrics={'f1_val': 0.6983508905217484, 'auprc': 0.6669508680879814, 'loss_val': 0.32667814518162175, 'psi': 0.6857908815482416}-{'f1_val': 0.6979904929899468, 'auprc': 0.6724175894340987, 'loss_val': 0.3371674744274472, 'psi': 0.6877613315676075}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=18 head_norm_before_train=1.710920 (no previous merge yet)
[S3] round=18 local utility u=0.002128 metrics={'f1_val': 0.7004261945879899, 'auprc': 0.998831353565193, 'loss_val': 0.2652479878385348, 'psi': 0.8197882581788711}-{'f1_val': 0.7007562037352997, 'auprc': 0.9988322012756964, 'loss_val': 0.2714857133495079, 'psi': 0.8199866027514584}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=18 head_norm_before_train=1.339830 cos_to_last_merge=0.9973 (last merge round=15)
[S4] round=18 local utility u=0.000000 metrics={'f1_val': 0.6169475831685253, 'auprc': 0.9453835678609256, 'loss_val': 0.45537444969850094, 'psi': 0.7483219770454854}-{'f1_val': 0.6190759520787136, 'auprc': 0.9425085020194511, 'loss_val': 0.45352439454118343, 'psi': 0.7484489720550087}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=18 head_norm_before_train=1.578069 (no previous merge yet)
[S5] round=18 local utility u=0.021899 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9875876675711799, 'loss_val': 0.3014442047261201, 'psi': 0.8154001026260765}-{'f1_val': 0.7006083926626743, 'auprc': 0.9790683345315897, 'loss_val': 0.31968366733773174, 'psi': 0.8119923694102404}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] sending update (kind=head size=1795 to 1 peers)
[S6] START round=18 head_norm_before_train=1.010078 cos_to_last_merge=0.9926 (last merge round=15)
[S6] round=18 local utility u=0.622548 metrics={'f1_val': 0.7099110706243735, 'auprc': 0.9734378872002235, 'loss_val': 0.35685525437572857, 'psi': 0.8153217972547135}-{'f1_val': 0.6205216692265898, 'auprc': 0.8032334263402574, 'loss_val': 0.5550012032224494, 'psi': 0.6936063720720569}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] START round=18 head_norm_before_train=1.285656 cos_to_last_merge=0.9750 (last merge round=11)
[S7] round=18 local utility u=0.000000 metrics={'f1_val': 0.37874757814000426, 'auprc': 0.6303330122465123, 'loss_val': 0.9580467217569708, 'psi': 0.47938175178260745}-{'f1_val': 0.6723787494221085, 'auprc': 0.7815388759272576, 'loss_val': 0.553472181457972, 'psi': 0.7160428000241681}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=18 head_norm_before_train=1.583334 cos_to_last_merge=0.9993 (last merge round=16)
[S8] round=18 local utility u=0.000000 metrics={'f1_val': 0.7157173879417495, 'auprc': 0.9991113724189618, 'loss_val': 0.19076650018748173, 'psi': 0.8290749817326344}-{'f1_val': 0.8614392228109606, 'auprc': 0.999369911981953, 'loss_val': 0.19544686147708826, 'psi': 0.9166114984793576}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=18 head_norm_before_train=1.079690 cos_to_last_merge=0.9988 (last merge round=16)
[S9] round=18 local utility u=0.002822 metrics={'f1_val': 0.9903801002864661, 'auprc': 0.9980173294904076, 'loss_val': 0.16964685056080764, 'psi': 0.9934349919680426}-{'f1_val': 0.9954158325366191, 'auprc': 0.9981963630532042, 'loss_val': 0.20604152598654338, 'psi': 0.9965280447432532}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=18 head_norm_before_train=1.392201 cos_to_last_merge=0.9699 (last merge round=11)
[S10] round=18 local utility u=0.518047 metrics={'f1_val': 0.9573147607456628, 'auprc': 0.9915974769659612, 'loss_val': 0.21405271791672947, 'psi': 0.9710278472337822}-{'f1_val': 0.7919590240711953, 'auprc': 0.9863711030365271, 'loss_val': 0.24233366520009594, 'psi': 0.869723855657328}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] sending update (kind=head size=1805 to 1 peers)
[S11] START round=18 head_norm_before_train=1.014145 cos_to_last_merge=0.9853 (last merge round=14)
[S11] round=18 local utility u=0.032757 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9976463045485743, 'loss_val': 0.3176198560244937, 'psi': 0.8202197117984218}-{'f1_val': 0.7016282822309048, 'auprc': 0.986910941840075, 'loss_val': 0.3490859133047232, 'psi': 0.8157413460745728}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=18 head_norm_before_train=1.592586 cos_to_last_merge=0.9912 (last merge round=11)
[S13] round=18 local utility u=0.000000 metrics={'f1_val': 0.5901476252173365, 'auprc': 0.5964408363836601, 'loss_val': 0.7458225726747036, 'psi': 0.592664909683866}-{'f1_val': 0.5970401730764539, 'auprc': 0.6320184922926604, 'loss_val': 0.6934504934509764, 'psi': 0.6110315007629364}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=18 head_norm_before_train=1.536864 cos_to_last_merge=0.9910 (last merge round=13)
[S14] round=18 local utility u=0.007071 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9972042783476559, 'loss_val': 0.05996039208331559, 'psi': 0.9973283078997592}-{'f1_val': 0.997240356705793, 'auprc': 0.9973693032085392, 'loss_val': 0.07357398185743433, 'psi': 0.9972919353068915}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=18 head_norm_before_train=1.330120 cos_to_last_merge=0.9929 (last merge round=14)
[S15] round=18 local utility u=0.000000 metrics={'f1_val': 0.8835124789054292, 'auprc': 0.9751112003736773, 'loss_val': 0.22776588022760025, 'psi': 0.9201519674927284}-{'f1_val': 0.9153389919738119, 'auprc': 0.9879906086044025, 'loss_val': 0.2042026259246312, 'psi': 0.944399638626048}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=18 head_norm_before_train=1.046887 cos_to_last_merge=0.9079 (last merge round=11)
[S16] ⚠️ Model drifted since last merge! cos=0.908
[S16] round=18 local utility u=0.188055 metrics={'f1_val': 0.9819361845524053, 'auprc': 0.9920531708193471, 'loss_val': 0.2797844375670696, 'psi': 0.9859829790591821}-{'f1_val': 0.9364226333100425, 'auprc': 0.9919165468833566, 'loss_val': 0.3824025952726809, 'psi': 0.9586201987393681}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1785 reason=None
[S16] sending update (kind=head size=1785 to 1 peers)
[S17] START round=18 head_norm_before_train=1.313503 cos_to_last_merge=0.8277 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.828
[S17] round=18 local utility u=0.000000 metrics={'f1_val': 0.39488412558022884, 'auprc': 0.8889015261866267, 'loss_val': 0.6059062283185775, 'psi': 0.592491085822788}-{'f1_val': 0.3922278785622122, 'auprc': 0.8990752446840615, 'loss_val': 0.5878984409404729, 'psi': 0.594966825010952}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=19 head_norm_before_train=1.281907 cos_to_last_merge=0.9981 (last merge round=16)
[S2] round=19 local utility u=0.000000 metrics={'f1_val': 0.6787250217131575, 'auprc': 0.6723633859979657, 'loss_val': 0.39444875793806283, 'psi': 0.6761803674270808}-{'f1_val': 0.6983508905217484, 'auprc': 0.6669508680879814, 'loss_val': 0.32667814518162175, 'psi': 0.6857908815482416}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=20 psi=0.676 u=0.0000 p_local=0.0657 f1=0.679 auprc=0.672 bytes=19754
[S3] START round=19 head_norm_before_train=1.726214 (no previous merge yet)
[S3] round=19 local utility u=0.004481 metrics={'f1_val': 0.7010863553524592, 'auprc': 0.9998755152113115, 'loss_val': 0.26337898133832816, 'psi': 0.8206020192960002}-{'f1_val': 0.7004261945879899, 'auprc': 0.998831353565193, 'loss_val': 0.2652479878385348, 'psi': 0.8197882581788711}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] sending update (kind=head size=1804 to 1 peers)
[S3] r=20 psi=0.821 u=0.0045 p_local=0.0905 f1=0.701 auprc=1.000 bytes=27023
[S4] START round=19 head_norm_before_train=1.372452 cos_to_last_merge=0.9947 (last merge round=15)
[S4] round=19 local utility u=0.981684 metrics={'f1_val': 0.9407895994538849, 'auprc': 0.9391627829197271, 'loss_val': 0.41639608655523286, 'psi': 0.9401388728402218}-{'f1_val': 0.6169475831685253, 'auprc': 0.9453835678609256, 'loss_val': 0.45537444969850094, 'psi': 0.7483219770454854}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S4] r=20 psi=0.940 u=0.9817 p_local=0.3448 f1=0.941 auprc=0.939 bytes=25193
[S5] START round=19 head_norm_before_train=1.603171 (no previous merge yet)
[S5] round=19 local utility u=0.007698 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9876143752640175, 'loss_val': 0.28612814915854046, 'psi': 0.8154107857032116}-{'f1_val': 0.7006083926626743, 'auprc': 0.9875876675711799, 'loss_val': 0.3014442047261201, 'psi': 0.8154001026260765}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S5] r=20 psi=0.815 u=0.0077 p_local=0.1981 f1=0.701 auprc=0.988 bytes=28689
[S6] START round=19 head_norm_before_train=1.042892 cos_to_last_merge=0.9871 (last merge round=15)
[S6] round=19 local utility u=0.000000 metrics={'f1_val': 0.644262682731249, 'auprc': 0.8208554522685108, 'loss_val': 0.43090305859131534, 'psi': 0.7148997905461536}-{'f1_val': 0.7099110706243735, 'auprc': 0.9734378872002235, 'loss_val': 0.35685525437572857, 'psi': 0.8153217972547135}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=20 psi=0.715 u=0.0000 p_local=0.1923 f1=0.644 auprc=0.821 bytes=19756
[S7] START round=19 head_norm_before_train=1.298194 cos_to_last_merge=0.9722 (last merge round=11)
[S7] round=19 local utility u=1.000000 metrics={'f1_val': 0.6730886331768569, 'auprc': 0.7844212997807807, 'loss_val': 0.5056199574537379, 'psi': 0.7176216998184264}-{'f1_val': 0.37874757814000426, 'auprc': 0.6303330122465123, 'loss_val': 0.9580467217569708, 'psi': 0.47938175178260745}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S7] r=20 psi=0.718 u=1.0000 p_local=0.4346 f1=0.673 auprc=0.784 bytes=23370
[S8] START round=19 head_norm_before_train=1.608400 cos_to_last_merge=0.9978 (last merge round=16)
[S8] round=19 local utility u=0.863755 metrics={'f1_val': 0.9970768230533491, 'auprc': 0.9996184699969269, 'loss_val': 0.1529343323028948, 'psi': 0.9980934818307803}-{'f1_val': 0.7157173879417495, 'auprc': 0.9991113724189618, 'loss_val': 0.19076650018748173, 'psi': 0.8290749817326344}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S8] r=20 psi=0.998 u=0.8638 p_local=0.3427 f1=0.997 auprc=1.000 bytes=25162
[S9] START round=19 head_norm_before_train=1.130548 cos_to_last_merge=0.9955 (last merge round=16)
[S9] round=19 local utility u=0.031978 metrics={'f1_val': 0.9941897064172326, 'auprc': 0.9981843786175398, 'loss_val': 0.12905012902738874, 'psi': 0.9957875752973555}-{'f1_val': 0.9903801002864661, 'auprc': 0.9980173294904076, 'loss_val': 0.16964685056080764, 'psi': 0.9934349919680426}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S9] r=20 psi=0.996 u=0.0320 p_local=0.1387 f1=0.994 auprc=0.998 bytes=26902
[S10] START round=19 head_norm_before_train=1.407800 cos_to_last_merge=0.9679 (last merge round=11)
[S10] round=19 local utility u=0.076670 metrics={'f1_val': 0.9809959875619002, 'auprc': 0.9856440330556671, 'loss_val': 0.18494011266099972, 'psi': 0.9828552057594069}-{'f1_val': 0.9573147607456628, 'auprc': 0.9915974769659612, 'loss_val': 0.21405271791672947, 'psi': 0.9710278472337822}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S10] r=20 psi=0.983 u=0.0767 p_local=0.2562 f1=0.981 auprc=0.986 bytes=21551
[S11] START round=19 head_norm_before_train=1.054259 cos_to_last_merge=0.9792 (last merge round=14)
[S11] round=19 local utility u=0.012977 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9976023372474576, 'loss_val': 0.29008271325223167, 'psi': 0.8200570226511379}-{'f1_val': 0.7019353166316534, 'auprc': 0.9976463045485743, 'loss_val': 0.3176198560244937, 'psi': 0.8202197117984218}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S11] r=20 psi=0.820 u=0.0130 p_local=0.0889 f1=0.702 auprc=0.998 bytes=28753
[S13] START round=19 head_norm_before_train=1.618012 cos_to_last_merge=0.9887 (last merge round=11)
[S13] round=19 local utility u=0.062083 metrics={'f1_val': 0.5882950424545696, 'auprc': 0.6291920360237824, 'loss_val': 0.7087937245594675, 'psi': 0.6046538398822547}-{'f1_val': 0.5901476252173365, 'auprc': 0.5964408363836601, 'loss_val': 0.7458225726747036, 'psi': 0.592664909683866}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S13] r=20 psi=0.605 u=0.0621 p_local=0.1484 f1=0.588 auprc=0.629 bytes=19760
[S14] START round=19 head_norm_before_train=1.585444 cos_to_last_merge=0.9876 (last merge round=13)
[S14] round=19 local utility u=0.004195 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9969226287362238, 'loss_val': 0.049702581006598884, 'psi': 0.9971132655179653}-{'f1_val': 0.9974109942678281, 'auprc': 0.9972042783476559, 'loss_val': 0.05996039208331559, 'psi': 0.9973283078997592}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S14] r=20 psi=0.997 u=0.0042 p_local=0.0920 f1=0.997 auprc=0.997 bytes=30583
[S15] START round=19 head_norm_before_train=1.369005 cos_to_last_merge=0.9893 (last merge round=14)
[S15] round=19 local utility u=0.000000 metrics={'f1_val': 0.8508018129129511, 'auprc': 0.9675776120559928, 'loss_val': 0.24715469288457467, 'psi': 0.8975121325701678}-{'f1_val': 0.8835124789054292, 'auprc': 0.9751112003736773, 'loss_val': 0.22776588022760025, 'psi': 0.9201519674927284}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] r=20 psi=0.898 u=0.0000 p_local=0.1737 f1=0.851 auprc=0.968 bytes=26855
[S16] START round=19 head_norm_before_train=1.095601 cos_to_last_merge=0.8995 (last merge round=11)
[S16] ⚠️ Model drifted since last merge! cos=0.899
[S16] round=19 local utility u=0.038416 metrics={'f1_val': 0.9858445274446405, 'auprc': 0.9914862682665849, 'loss_val': 0.22470185823576802, 'psi': 0.9881012237734181}-{'f1_val': 0.9819361845524053, 'auprc': 0.9920531708193471, 'loss_val': 0.2797844375670696, 'psi': 0.9859829790591821}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S16] sending update (kind=head size=1791 to 1 peers)
[S16] r=20 psi=0.988 u=0.0384 p_local=0.2826 f1=0.986 auprc=0.991 bytes=23356
[S17] START round=19 head_norm_before_train=1.325702 cos_to_last_merge=0.8253 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.825
[S17] round=19 local utility u=1.000000 metrics={'f1_val': 0.7148222707437736, 'auprc': 0.9160138855211202, 'loss_val': 0.539939191799517, 'psi': 0.7952989166547122}-{'f1_val': 0.39488412558022884, 'auprc': 0.8889015261866267, 'loss_val': 0.6059062283185775, 'psi': 0.592491085822788}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] sending update (kind=head size=1794 to 1 peers)
[S17] r=20 psi=0.795 u=1.0000 p_local=0.3136 f1=0.715 auprc=0.916 bytes=21596
[S2] START round=20 head_norm_before_train=1.310281 cos_to_last_merge=0.9969 (last merge round=16)
[S2] round=20 local utility u=0.000000 metrics={'f1_val': 0.6567936266134501, 'auprc': 0.6631774938516294, 'loss_val': 0.49242872060168114, 'psi': 0.6593471735087217}-{'f1_val': 0.6787250217131575, 'auprc': 0.6723633859979657, 'loss_val': 0.39444875793806283, 'psi': 0.6761803674270808}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=20 head_norm_before_train=1.740604 (no previous merge yet)
[S3] round=20 local utility u=0.002449 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.999503938104129, 'loss_val': 0.25538488138179266, 'psi': 0.8202552974828314}-{'f1_val': 0.7010863553524592, 'auprc': 0.9998755152113115, 'loss_val': 0.26337898133832816, 'psi': 0.8206020192960002}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] sending update (kind=head size=1804 to 1 peers)
[S4] START round=20 head_norm_before_train=1.401659 cos_to_last_merge=0.9919 (last merge round=15)
[S4] round=20 local utility u=0.023618 metrics={'f1_val': 0.9403167632189082, 'auprc': 0.9541185674471473, 'loss_val': 0.411190946426422, 'psi': 0.9458374849102038}-{'f1_val': 0.9407895994538849, 'auprc': 0.9391627829197271, 'loss_val': 0.41639608655523286, 'psi': 0.9401388728402218}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=20 head_norm_before_train=1.623776 (no previous merge yet)
[S5] round=20 local utility u=0.009570 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9891023521804787, 'loss_val': 0.27145201020353643, 'psi': 0.816005976469796}-{'f1_val': 0.7006083926626743, 'auprc': 0.9876143752640175, 'loss_val': 0.28612814915854046, 'psi': 0.8154107857032116}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=20 head_norm_before_train=1.074712 cos_to_last_merge=0.9816 (last merge round=15)
[S6] round=20 local utility u=0.866185 metrics={'f1_val': 0.8344303555033471, 'auprc': 0.967655892225031, 'loss_val': 0.2799411846334646, 'psi': 0.8877205701920207}-{'f1_val': 0.644262682731249, 'auprc': 0.8208554522685108, 'loss_val': 0.43090305859131534, 'psi': 0.7148997905461536}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=20 head_norm_before_train=1.308073 cos_to_last_merge=0.9698 (last merge round=11)
[S7] round=20 local utility u=0.000000 metrics={'f1_val': 0.3764585045080646, 'auprc': 0.6195788921662524, 'loss_val': 1.0379980662673722, 'psi': 0.4737066595713397}-{'f1_val': 0.6730886331768569, 'auprc': 0.7844212997807807, 'loss_val': 0.5056199574537379, 'psi': 0.7176216998184264}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=20 head_norm_before_train=1.635078 cos_to_last_merge=0.9959 (last merge round=16)
[S8] round=20 local utility u=0.000000 metrics={'f1_val': 0.7160041338397789, 'auprc': 0.9983102113588206, 'loss_val': 0.16861415184848402, 'psi': 0.8289265648473956}-{'f1_val': 0.9970768230533491, 'auprc': 0.9996184699969269, 'loss_val': 0.1529343323028948, 'psi': 0.9980934818307803}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=20 head_norm_before_train=1.179055 cos_to_last_merge=0.9909 (last merge round=16)
[S9] round=20 local utility u=0.012395 metrics={'f1_val': 0.9941666514823342, 'auprc': 0.9981862557849391, 'loss_val': 0.10412661433263211, 'psi': 0.9957744932033762}-{'f1_val': 0.9941897064172326, 'auprc': 0.9981843786175398, 'loss_val': 0.12905012902738874, 'psi': 0.9957875752973555}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=20 head_norm_before_train=1.419928 cos_to_last_merge=0.9663 (last merge round=11)
[S10] round=20 local utility u=0.069813 metrics={'f1_val': 0.992603459253572, 'auprc': 0.997278094354771, 'loss_val': 0.14986171206039275, 'psi': 0.9944733132940515}-{'f1_val': 0.9809959875619002, 'auprc': 0.9856440330556671, 'loss_val': 0.18494011266099972, 'psi': 0.9828552057594069}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=20 head_norm_before_train=1.085180 cos_to_last_merge=0.9743 (last merge round=14)
[S11] round=20 local utility u=0.016845 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9976245352328192, 'loss_val': 0.2579107861506249, 'psi': 0.8202110040721198}-{'f1_val': 0.7016934795869249, 'auprc': 0.9976023372474576, 'loss_val': 0.29008271325223167, 'psi': 0.8200570226511379}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=20 head_norm_before_train=1.639661 cos_to_last_merge=0.9863 (last merge round=11)
[S13] round=20 local utility u=0.226693 metrics={'f1_val': 0.6020999827986386, 'auprc': 0.7481201042676604, 'loss_val': 0.6950211933481814, 'psi': 0.6605080313862473}-{'f1_val': 0.5882950424545696, 'auprc': 0.6291920360237824, 'loss_val': 0.7087937245594675, 'psi': 0.6046538398822547}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=20 head_norm_before_train=1.628496 cos_to_last_merge=0.9843 (last merge round=13)
[S14] round=20 local utility u=0.003863 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9972381927661353, 'loss_val': 0.04292312482916126, 'psi': 0.99723949112993}-{'f1_val': 0.997240356705793, 'auprc': 0.9969226287362238, 'loss_val': 0.049702581006598884, 'psi': 0.9971132655179653}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=20 head_norm_before_train=1.402290 cos_to_last_merge=0.9862 (last merge round=14)
[S15] round=20 local utility u=0.455704 metrics={'f1_val': 0.9806707935168588, 'auprc': 0.9742049289276115, 'loss_val': 0.13484241308315753, 'psi': 0.9780844476811599}-{'f1_val': 0.8508018129129511, 'auprc': 0.9675776120559928, 'loss_val': 0.24715469288457467, 'psi': 0.8975121325701678}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] sending update (kind=head size=1794 to 1 peers)
[S16] START round=20 head_norm_before_train=1.142338 cos_to_last_merge=0.8925 (last merge round=11)
[S16] ⚠️ Model drifted since last merge! cos=0.892
[S16] round=20 local utility u=0.016412 metrics={'f1_val': 0.9858445274446405, 'auprc': 0.991308596316769, 'loss_val': 0.1913456572526469, 'psi': 0.9880301549934918}-{'f1_val': 0.9858445274446405, 'auprc': 0.9914862682665849, 'loss_val': 0.22470185823576802, 'psi': 0.9881012237734181}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] sending update (kind=head size=1794 to 1 peers)
[S17] START round=20 head_norm_before_train=1.334434 cos_to_last_merge=0.8236 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.824
[S17] round=20 local utility u=0.000000 metrics={'f1_val': 0.5106138830140258, 'auprc': 0.8649512583830894, 'loss_val': 0.5892961303143567, 'psi': 0.6523488331616512}-{'f1_val': 0.7148222707437736, 'auprc': 0.9160138855211202, 'loss_val': 0.539939191799517, 'psi': 0.7952989166547122}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=21 head_norm_before_train=1.334699 cos_to_last_merge=0.9958 (last merge round=16)
[S2] round=21 local utility u=0.149763 metrics={'f1_val': 0.6816077778698098, 'auprc': 0.669662614675212, 'loss_val': 0.3612431205436697, 'psi': 0.6768297125919707}-{'f1_val': 0.6567936266134501, 'auprc': 0.6631774938516294, 'loss_val': 0.49242872060168114, 'psi': 0.6593471735087217}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S2] sending update (kind=head size=1791 to 1 peers)
[S3] START round=21 head_norm_before_train=1.756569 (no previous merge yet)
[S3] round=21 local utility u=0.005096 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9995028721923621, 'loss_val': 0.2447372658677469, 'psi': 0.8202097246761457}-{'f1_val': 0.7007562037352997, 'auprc': 0.999503938104129, 'loss_val': 0.25538488138179266, 'psi': 0.8202552974828314}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S3] sending update (kind=head size=1806 to 1 peers)
[S4] START round=21 head_norm_before_train=1.426307 cos_to_last_merge=0.9893 (last merge round=15)
[S4] round=21 local utility u=0.065414 metrics={'f1_val': 0.9525372421095208, 'auprc': 0.9531110650088077, 'loss_val': 0.3506641838640622, 'psi': 0.9527667712692356}-{'f1_val': 0.9403167632189082, 'auprc': 0.9541185674471473, 'loss_val': 0.411190946426422, 'psi': 0.9458374849102038}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=21 head_norm_before_train=1.639502 (no previous merge yet)
[S5] round=21 local utility u=0.000000 metrics={'f1_val': 0.6498098601045139, 'auprc': 0.8233962780128868, 'loss_val': 0.47857637912346473, 'psi': 0.7192444272678631}-{'f1_val': 0.7006083926626743, 'auprc': 0.9891023521804787, 'loss_val': 0.27145201020353643, 'psi': 0.816005976469796}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=21 head_norm_before_train=1.102427 cos_to_last_merge=0.9765 (last merge round=15)
[S6] round=21 local utility u=0.000000 metrics={'f1_val': 0.6223871007963536, 'auprc': 0.7921070134434659, 'loss_val': 0.6337645489903866, 'psi': 0.6902750658551986}-{'f1_val': 0.8344303555033471, 'auprc': 0.967655892225031, 'loss_val': 0.2799411846334646, 'psi': 0.8877205701920207}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=21 head_norm_before_train=1.315775 cos_to_last_merge=0.9680 (last merge round=11)
[S7] round=21 local utility u=0.245995 metrics={'f1_val': 0.4248143946939231, 'auprc': 0.6441045062080526, 'loss_val': 0.9097210261062235, 'psi': 0.5125304392995749}-{'f1_val': 0.3764585045080646, 'auprc': 0.6195788921662524, 'loss_val': 1.0379980662673722, 'psi': 0.4737066595713397}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=21 head_norm_before_train=1.659139 cos_to_last_merge=0.9941 (last merge round=16)
[S8] round=21 local utility u=0.863480 metrics={'f1_val': 0.9957129912683976, 'auprc': 0.99962158990749, 'loss_val': 0.1238415184741638, 'psi': 0.9972764307240346}-{'f1_val': 0.7160041338397789, 'auprc': 0.9983102113588206, 'loss_val': 0.16861415184848402, 'psi': 0.8289265648473956}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] sending update (kind=head size=1805 to 1 peers)
[S9] START round=21 head_norm_before_train=1.224019 cos_to_last_merge=0.9862 (last merge round=16)
[S9] round=21 local utility u=0.006832 metrics={'f1_val': 0.9937492462693716, 'auprc': 0.9981809450137952, 'loss_val': 0.08794282945858865, 'psi': 0.9955219257671409}-{'f1_val': 0.9941666514823342, 'auprc': 0.9981862557849391, 'loss_val': 0.10412661433263211, 'psi': 0.9957744932033762}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=21 head_norm_before_train=1.429693 cos_to_last_merge=0.9651 (last merge round=11)
[S10] round=21 local utility u=0.000000 metrics={'f1_val': 0.9921323303044471, 'auprc': 0.9936594636870778, 'loss_val': 0.16477212194476118, 'psi': 0.9927431836574994}-{'f1_val': 0.992603459253572, 'auprc': 0.997278094354771, 'loss_val': 0.14986171206039275, 'psi': 0.9944733132940515}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=21 head_norm_before_train=1.111698 cos_to_last_merge=0.9702 (last merge round=14)
[S11] round=21 local utility u=0.015175 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9977670962314474, 'loss_val': 0.22798867365725706, 'psi': 0.8202680284715711}-{'f1_val': 0.7019353166316534, 'auprc': 0.9976245352328192, 'loss_val': 0.2579107861506249, 'psi': 0.8202110040721198}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=21 head_norm_before_train=1.661195 cos_to_last_merge=0.9839 (last merge round=11)
[S13] round=21 local utility u=0.136180 metrics={'f1_val': 0.6278536361755249, 'auprc': 0.753453844341071, 'loss_val': 0.5931838592048386, 'psi': 0.6780937194417433}-{'f1_val': 0.6020999827986386, 'auprc': 0.7481201042676604, 'loss_val': 0.6950211933481814, 'psi': 0.6605080313862473}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=21 head_norm_before_train=1.659336 cos_to_last_merge=0.9819 (last merge round=13)
[S14] round=21 local utility u=0.003227 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9972583256679082, 'loss_val': 0.038994942150684296, 'psi': 0.9974940010970754}-{'f1_val': 0.997240356705793, 'auprc': 0.9972381927661353, 'loss_val': 0.04292312482916126, 'psi': 0.99723949112993}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=21 head_norm_before_train=1.437221 cos_to_last_merge=0.9826 (last merge round=14)
[S15] round=21 local utility u=0.000000 metrics={'f1_val': 0.8477514862772328, 'auprc': 0.9775769038833699, 'loss_val': 0.23964341043936185, 'psi': 0.8996816533196876}-{'f1_val': 0.9806707935168588, 'auprc': 0.9742049289276115, 'loss_val': 0.13484241308315753, 'psi': 0.9780844476811599}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=21 head_norm_before_train=1.188262 cos_to_last_merge=0.8862 (last merge round=11)
[S16] ⚠️ Model drifted since last merge! cos=0.886
[S16] round=21 local utility u=0.000000 metrics={'f1_val': 0.9252476328713544, 'auprc': 0.9933144477842544, 'loss_val': 0.33892950031806557, 'psi': 0.9524743588365143}-{'f1_val': 0.9858445274446405, 'auprc': 0.991308596316769, 'loss_val': 0.1913456572526469, 'psi': 0.9880301549934918}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=21 head_norm_before_train=1.348362 cos_to_last_merge=0.8213 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.821
[S17] round=21 local utility u=0.443807 metrics={'f1_val': 0.6221456159297459, 'auprc': 0.9256377016347692, 'loss_val': 0.5529323968675748, 'psi': 0.7435424502117552}-{'f1_val': 0.5106138830140258, 'auprc': 0.8649512583830894, 'loss_val': 0.5892961303143567, 'psi': 0.6523488331616512}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] sending update (kind=head size=1795 to 1 peers)
[S2] START round=22 head_norm_before_train=1.354998 cos_to_last_merge=0.9944 (last merge round=16)
[S2] round=22 local utility u=0.123366 metrics={'f1_val': 0.6988915559443626, 'auprc': 0.6965065917915929, 'loss_val': 0.29874508098163854, 'psi': 0.6979375702832546}-{'f1_val': 0.6816077778698098, 'auprc': 0.669662614675212, 'loss_val': 0.3612431205436697, 'psi': 0.6768297125919707}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] sending update (kind=head size=1793 to 1 peers)
[S3] START round=22 head_norm_before_train=1.776724 (no previous merge yet)
[S3] round=22 local utility u=0.007931 metrics={'f1_val': 0.701952049433578, 'auprc': 0.9995045284151014, 'loss_val': 0.23650593970914596, 'psi': 0.8209730410261874}-{'f1_val': 0.7006809596653347, 'auprc': 0.9995028721923621, 'loss_val': 0.2447372658677469, 'psi': 0.8202097246761457}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] sending update (kind=head size=1805 to 1 peers)
[S4] START round=22 head_norm_before_train=1.447069 cos_to_last_merge=0.9870 (last merge round=15)
[S4] round=22 local utility u=0.042304 metrics={'f1_val': 0.9544952474531582, 'auprc': 0.9629242062694345, 'loss_val': 0.30724311582735486, 'psi': 0.9578668309796687}-{'f1_val': 0.9525372421095208, 'auprc': 0.9531110650088077, 'loss_val': 0.3506641838640622, 'psi': 0.9527667712692356}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=22 head_norm_before_train=1.654836 (no previous merge yet)
[S5] round=22 local utility u=0.514278 metrics={'f1_val': 0.7006090940057808, 'auprc': 0.9874306519467766, 'loss_val': 0.2469194163114355, 'psi': 0.8153377171821792}-{'f1_val': 0.6498098601045139, 'auprc': 0.8233962780128868, 'loss_val': 0.47857637912346473, 'psi': 0.7192444272678631}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] START round=22 head_norm_before_train=1.125032 cos_to_last_merge=0.9719 (last merge round=15)
[S6] round=22 local utility u=1.000000 metrics={'f1_val': 0.9610983104816071, 'auprc': 0.9741329827026118, 'loss_val': 0.22777800669291814, 'psi': 0.966312179370009}-{'f1_val': 0.6223871007963536, 'auprc': 0.7921070134434659, 'loss_val': 0.6337645489903866, 'psi': 0.6902750658551986}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] START round=22 head_norm_before_train=1.322872 cos_to_last_merge=0.9664 (last merge round=11)
[S7] round=22 local utility u=0.320145 metrics={'f1_val': 0.5069751910652625, 'auprc': 0.64786967354945, 'loss_val': 0.7736920140606064, 'psi': 0.5633329840589375}-{'f1_val': 0.4248143946939231, 'auprc': 0.6441045062080526, 'loss_val': 0.9097210261062235, 'psi': 0.5125304392995749}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=22 head_norm_before_train=1.683134 cos_to_last_merge=0.9923 (last merge round=16)
[S8] round=22 local utility u=0.010256 metrics={'f1_val': 0.9965258743408478, 'auprc': 0.9996077063106837, 'loss_val': 0.10816579064438729, 'psi': 0.9977586071287823}-{'f1_val': 0.9957129912683976, 'auprc': 0.99962158990749, 'loss_val': 0.1238415184741638, 'psi': 0.9972764307240346}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=22 head_norm_before_train=1.264482 cos_to_last_merge=0.9817 (last merge round=16)
[S9] round=22 local utility u=0.000000 metrics={'f1_val': 0.9903923264803052, 'auprc': 0.9982597767752684, 'loss_val': 0.08396744716559194, 'psi': 0.9935393065982905}-{'f1_val': 0.9937492462693716, 'auprc': 0.9981809450137952, 'loss_val': 0.08794282945858865, 'psi': 0.9955219257671409}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=22 head_norm_before_train=1.438308 cos_to_last_merge=0.9641 (last merge round=11)
[S10] round=22 local utility u=0.011660 metrics={'f1_val': 0.9920543019470257, 'auprc': 0.9954798150926767, 'loss_val': 0.14644539356816394, 'psi': 0.9934245072052861}-{'f1_val': 0.9921323303044471, 'auprc': 0.9936594636870778, 'loss_val': 0.16477212194476118, 'psi': 0.9927431836574994}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S10] sending update (kind=head size=1792 to 1 peers)
[S11] START round=22 head_norm_before_train=1.137515 cos_to_last_merge=0.9659 (last merge round=14)
[S11] round=22 local utility u=0.765973 metrics={'f1_val': 0.9568770330867039, 'auprc': 0.9972109782290863, 'loss_val': 0.22402442349581597, 'psi': 0.9730106111436568}-{'f1_val': 0.7019353166316534, 'auprc': 0.9977670962314474, 'loss_val': 0.22798867365725706, 'psi': 0.8202680284715711}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=22 head_norm_before_train=1.679165 cos_to_last_merge=0.9816 (last merge round=11)
[S13] round=22 local utility u=0.000000 metrics={'f1_val': 0.5934671123497378, 'auprc': 0.7711371823622226, 'loss_val': 0.7847768096608885, 'psi': 0.6645351403547317}-{'f1_val': 0.6278536361755249, 'auprc': 0.753453844341071, 'loss_val': 0.5931838592048386, 'psi': 0.6780937194417433}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=22 head_norm_before_train=1.686407 cos_to_last_merge=0.9797 (last merge round=13)
[S14] round=22 local utility u=0.004752 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9989317356768236, 'loss_val': 0.03451217160114493, 'psi': 0.9981633651006416}-{'f1_val': 0.9976511180498535, 'auprc': 0.9972583256679082, 'loss_val': 0.038994942150684296, 'psi': 0.9974940010970754}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=22 head_norm_before_train=1.472193 cos_to_last_merge=0.9787 (last merge round=14)
[S15] round=22 local utility u=0.413245 metrics={'f1_val': 0.9675865419106954, 'auprc': 0.9738913007880694, 'loss_val': 0.12110740451478667, 'psi': 0.970108445461645}-{'f1_val': 0.8477514862772328, 'auprc': 0.9775769038833699, 'loss_val': 0.23964341043936185, 'psi': 0.8996816533196876}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=22 head_norm_before_train=1.228889 cos_to_last_merge=0.8811 (last merge round=11)
[S16] ⚠️ Model drifted since last merge! cos=0.881
[S16] round=22 local utility u=0.000000 metrics={'f1_val': 0.9070779264791157, 'auprc': 0.9939798407166833, 'loss_val': 0.37132664594084724, 'psi': 0.9418386921741427}-{'f1_val': 0.9252476328713544, 'auprc': 0.9933144477842544, 'loss_val': 0.33892950031806557, 'psi': 0.9524743588365143}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=22 head_norm_before_train=1.368493 cos_to_last_merge=0.8184 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.818
[S17] round=22 local utility u=0.000000 metrics={'f1_val': 0.5699088642378094, 'auprc': 0.8983440742406954, 'loss_val': 0.5749610351808173, 'psi': 0.7012829482389638}-{'f1_val': 0.6221456159297459, 'auprc': 0.9256377016347692, 'loss_val': 0.5529323968675748, 'psi': 0.7435424502117552}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=23 head_norm_before_train=1.373624 cos_to_last_merge=0.9932 (last merge round=16)
[S2] round=23 local utility u=0.000000 metrics={'f1_val': 0.6990717968887176, 'auprc': 0.6777035320869065, 'loss_val': 0.29823065207407645, 'psi': 0.6905244909679931}-{'f1_val': 0.6988915559443626, 'auprc': 0.6965065917915929, 'loss_val': 0.29874508098163854, 'psi': 0.6979375702832546}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=23 head_norm_before_train=1.799090 (no previous merge yet)
[S3] round=23 local utility u=0.013097 metrics={'f1_val': 0.703143065141181, 'auprc': 0.9995036016213165, 'loss_val': 0.21745546373340222, 'psi': 0.8216872797332352}-{'f1_val': 0.701952049433578, 'auprc': 0.9995045284151014, 'loss_val': 0.23650593970914596, 'psi': 0.8209730410261874}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=23 head_norm_before_train=1.468683 cos_to_last_merge=0.9844 (last merge round=15)
[S4] round=23 local utility u=0.000000 metrics={'f1_val': 0.9494390042284817, 'auprc': 0.9602162233370635, 'loss_val': 0.3011728192043211, 'psi': 0.9537498918719145}-{'f1_val': 0.9544952474531582, 'auprc': 0.9629242062694345, 'loss_val': 0.30724311582735486, 'psi': 0.9578668309796687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=23 head_norm_before_train=1.668898 (no previous merge yet)
[S5] round=23 local utility u=0.000000 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.8589653112104931, 'loss_val': 0.31794160197525734, 'psi': 0.7639511600818019}-{'f1_val': 0.7006090940057808, 'auprc': 0.9874306519467766, 'loss_val': 0.2469194163114355, 'psi': 0.8153377171821792}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=23 head_norm_before_train=1.141716 cos_to_last_merge=0.9682 (last merge round=15)
[S6] round=23 local utility u=0.000000 metrics={'f1_val': 0.5085694847657073, 'auprc': 0.790435307693938, 'loss_val': 0.9251487032465749, 'psi': 0.6213158139369996}-{'f1_val': 0.9610983104816071, 'auprc': 0.9741329827026118, 'loss_val': 0.22777800669291814, 'psi': 0.966312179370009}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=23 head_norm_before_train=1.333000 cos_to_last_merge=0.9643 (last merge round=11)
[S7] round=23 local utility u=0.000000 metrics={'f1_val': 0.47549445221198594, 'auprc': 0.6475980205264105, 'loss_val': 0.8410688730544011, 'psi': 0.5443358795377558}-{'f1_val': 0.5069751910652625, 'auprc': 0.64786967354945, 'loss_val': 0.7736920140606064, 'psi': 0.5633329840589375}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=23 head_norm_before_train=1.704076 cos_to_last_merge=0.9910 (last merge round=16)
[S8] round=23 local utility u=0.000000 metrics={'f1_val': 0.7142391053978291, 'auprc': 0.9970541375396018, 'loss_val': 0.22993071073202537, 'psi': 0.8273651182545383}-{'f1_val': 0.9965258743408478, 'auprc': 0.9996077063106837, 'loss_val': 0.10816579064438729, 'psi': 0.9977586071287823}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=23 head_norm_before_train=1.299689 cos_to_last_merge=0.9777 (last merge round=16)
[S9] round=23 local utility u=0.028096 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9980233969624779, 'loss_val': 0.06467641963850576, 'psi': 0.997205665873326}-{'f1_val': 0.9903923264803052, 'auprc': 0.9982597767752684, 'loss_val': 0.08396744716559194, 'psi': 0.9935393065982905}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=23 head_norm_before_train=1.447415 cos_to_last_merge=0.9632 (last merge round=11)
[S10] round=23 local utility u=0.013158 metrics={'f1_val': 0.9932373317559413, 'auprc': 0.9954227218640073, 'loss_val': 0.12705677320834688, 'psi': 0.9941114877991677}-{'f1_val': 0.9920543019470257, 'auprc': 0.9954798150926767, 'loss_val': 0.14644539356816394, 'psi': 0.9934245072052861}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=23 head_norm_before_train=1.163929 cos_to_last_merge=0.9615 (last merge round=14)
[S11] round=23 local utility u=0.023507 metrics={'f1_val': 0.9574493080804242, 'auprc': 0.9977305138846824, 'loss_val': 0.18200294360809238, 'psi': 0.9735617904021274}-{'f1_val': 0.9568770330867039, 'auprc': 0.9972109782290863, 'loss_val': 0.22402442349581597, 'psi': 0.9730106111436568}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=23 head_norm_before_train=1.694801 cos_to_last_merge=0.9793 (last merge round=11)
[S13] round=23 local utility u=0.227301 metrics={'f1_val': 0.6471026089532234, 'auprc': 0.7221114087101874, 'loss_val': 0.5049101679840001, 'psi': 0.677106128856009}-{'f1_val': 0.5934671123497378, 'auprc': 0.7711371823622226, 'loss_val': 0.7847768096608885, 'psi': 0.6645351403547317}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=23 head_norm_before_train=1.711812 cos_to_last_merge=0.9777 (last merge round=13)
[S14] round=23 local utility u=0.000000 metrics={'f1_val': 0.9972435617623723, 'auprc': 0.9990346051850069, 'loss_val': 0.03285253414660608, 'psi': 0.9979599791314261}-{'f1_val': 0.9976511180498535, 'auprc': 0.9989317356768236, 'loss_val': 0.03451217160114493, 'psi': 0.9981633651006416}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=23 head_norm_before_train=1.501354 cos_to_last_merge=0.9751 (last merge round=14)
[S15] round=23 local utility u=0.000000 metrics={'f1_val': 0.8196021189263014, 'auprc': 0.97393324498411, 'loss_val': 0.26851542641448184, 'psi': 0.8813345693494249}-{'f1_val': 0.9675865419106954, 'auprc': 0.9738913007880694, 'loss_val': 0.12110740451478667, 'psi': 0.970108445461645}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=23 head_norm_before_train=1.267682 cos_to_last_merge=0.8767 (last merge round=11)
[S16] ⚠️ Model drifted since last merge! cos=0.877
[S16] round=23 local utility u=0.358316 metrics={'f1_val': 0.9877869441455281, 'auprc': 0.990448816652538, 'loss_val': 0.12835487847841273, 'psi': 0.9888516931483322}-{'f1_val': 0.9070779264791157, 'auprc': 0.9939798407166833, 'loss_val': 0.37132664594084724, 'psi': 0.9418386921741427}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] sending update (kind=head size=1794 to 1 peers)
[S17] START round=23 head_norm_before_train=1.392508 cos_to_last_merge=0.8152 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.815
[S17] round=23 local utility u=0.094707 metrics={'f1_val': 0.5800933216989062, 'auprc': 0.9405345153099219, 'loss_val': 0.5732248335044976, 'psi': 0.7242697991433125}-{'f1_val': 0.5699088642378094, 'auprc': 0.8983440742406954, 'loss_val': 0.5749610351808173, 'psi': 0.7012829482389638}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] START round=24 head_norm_before_train=1.390780 cos_to_last_merge=0.9921 (last merge round=16)
[S2] round=24 local utility u=0.000000 metrics={'f1_val': 0.6982702466129149, 'auprc': 0.6645259311821151, 'loss_val': 0.3064074165210651, 'psi': 0.684772520440595}-{'f1_val': 0.6990717968887176, 'auprc': 0.6777035320869065, 'loss_val': 0.29823065207407645, 'psi': 0.6905244909679931}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=24 head_norm_before_train=1.822520 (no previous merge yet)
[S3] round=24 local utility u=0.084618 metrics={'f1_val': 0.7270204623173622, 'auprc': 0.9993838327665118, 'loss_val': 0.1911243443002515, 'psi': 0.835965810497022}-{'f1_val': 0.703143065141181, 'auprc': 0.9995036016213165, 'loss_val': 0.21745546373340222, 'psi': 0.8216872797332352}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S3] sending update (kind=head size=1806 to 1 peers)
[S4] START round=24 head_norm_before_train=1.486061 cos_to_last_merge=0.9821 (last merge round=15)
[S4] round=24 local utility u=0.009487 metrics={'f1_val': 0.9495538701964279, 'auprc': 0.9594265850109671, 'loss_val': 0.2805181327218553, 'psi': 0.9535029561222437}-{'f1_val': 0.9494390042284817, 'auprc': 0.9602162233370635, 'loss_val': 0.3011728192043211, 'psi': 0.9537498918719145}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=24 head_norm_before_train=1.685025 (no previous merge yet)
[S5] round=24 local utility u=0.000000 metrics={'f1_val': 0.66824816895316, 'auprc': 0.8622943916603533, 'loss_val': 0.3665700089020234, 'psi': 0.7458666580360374}-{'f1_val': 0.7006083926626743, 'auprc': 0.8589653112104931, 'loss_val': 0.31794160197525734, 'psi': 0.7639511600818019}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=24 head_norm_before_train=1.160322 cos_to_last_merge=0.9648 (last merge round=15)
[S6] round=24 local utility u=1.000000 metrics={'f1_val': 0.9624896750622381, 'auprc': 0.9678388922105639, 'loss_val': 0.24030272635200986, 'psi': 0.9646293619215685}-{'f1_val': 0.5085694847657073, 'auprc': 0.790435307693938, 'loss_val': 0.9251487032465749, 'psi': 0.6213158139369996}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] sending update (kind=head size=1794 to 1 peers)
[S7] START round=24 head_norm_before_train=1.345810 cos_to_last_merge=0.9616 (last merge round=11)
[S7] round=24 local utility u=0.915778 metrics={'f1_val': 0.6560928047140492, 'auprc': 0.7839224775948644, 'loss_val': 0.502075574170951, 'psi': 0.7072246738663752}-{'f1_val': 0.47549445221198594, 'auprc': 0.6475980205264105, 'loss_val': 0.8410688730544011, 'psi': 0.5443358795377558}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=24 head_norm_before_train=1.717656 cos_to_last_merge=0.9898 (last merge round=16)
[S8] round=24 local utility u=0.919033 metrics={'f1_val': 0.9965556289389758, 'auprc': 0.9996005732699536, 'loss_val': 0.09340390220145427, 'psi': 0.9977736066713669}-{'f1_val': 0.7142391053978291, 'auprc': 0.9970541375396018, 'loss_val': 0.22993071073202537, 'psi': 0.8273651182545383}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=24 head_norm_before_train=1.330395 cos_to_last_merge=0.9741 (last merge round=16)
[S9] round=24 local utility u=0.000000 metrics={'f1_val': 0.9937266016594926, 'auprc': 0.9984915591357651, 'loss_val': 0.06124081487678776, 'psi': 0.9956325846500016}-{'f1_val': 0.9966605118138915, 'auprc': 0.9980233969624779, 'loss_val': 0.06467641963850576, 'psi': 0.997205665873326}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=24 head_norm_before_train=1.458085 cos_to_last_merge=0.9621 (last merge round=11)
[S10] round=24 local utility u=0.000000 metrics={'f1_val': 0.9943563983784213, 'auprc': 0.9917322438242064, 'loss_val': 0.1516452211957241, 'psi': 0.9933067365567354}-{'f1_val': 0.9932373317559413, 'auprc': 0.9954227218640073, 'loss_val': 0.12705677320834688, 'psi': 0.9941114877991677}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=24 head_norm_before_train=1.189443 cos_to_last_merge=0.9573 (last merge round=14)
[S11] round=24 local utility u=0.115461 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9955628806838407, 'loss_val': 0.17916405872272917, 'psi': 0.99615335498169}-{'f1_val': 0.9574493080804242, 'auprc': 0.9977305138846824, 'loss_val': 0.18200294360809238, 'psi': 0.9735617904021274}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=24 head_norm_before_train=1.707490 cos_to_last_merge=0.9776 (last merge round=11)
[S13] round=24 local utility u=0.000000 metrics={'f1_val': 0.6161372630642264, 'auprc': 0.7367212498264706, 'loss_val': 0.7073440407276497, 'psi': 0.6643708577691241}-{'f1_val': 0.6471026089532234, 'auprc': 0.7221114087101874, 'loss_val': 0.5049101679840001, 'psi': 0.677106128856009}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=24 head_norm_before_train=1.734218 cos_to_last_merge=0.9760 (last merge round=13)
[S14] round=24 local utility u=0.000000 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9971448671206742, 'loss_val': 0.03303738158148291, 'psi': 0.9970564517428687}-{'f1_val': 0.9972435617623723, 'auprc': 0.9990346051850069, 'loss_val': 0.03285253414660608, 'psi': 0.9979599791314261}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=24 head_norm_before_train=1.520814 cos_to_last_merge=0.9726 (last merge round=14)
[S15] round=24 local utility u=0.295255 metrics={'f1_val': 0.8957225517692462, 'auprc': 0.9894496184899116, 'loss_val': 0.18127792417015412, 'psi': 0.9332133784575123}-{'f1_val': 0.8196021189263014, 'auprc': 0.97393324498411, 'loss_val': 0.26851542641448184, 'psi': 0.8813345693494249}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=24 head_norm_before_train=1.304435 cos_to_last_merge=0.8729 (last merge round=11)
[S16] ⚠️ Model drifted since last merge! cos=0.873
[S16] round=24 local utility u=0.000000 metrics={'f1_val': 0.9329636380729098, 'auprc': 0.9947092631367326, 'loss_val': 0.24742568826685046, 'psi': 0.957661888098439}-{'f1_val': 0.9877869441455281, 'auprc': 0.990448816652538, 'loss_val': 0.12835487847841273, 'psi': 0.9888516931483322}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=24 head_norm_before_train=1.420133 cos_to_last_merge=0.8116 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.812
[S17] round=24 local utility u=0.000022 metrics={'f1_val': 0.590012053010754, 'auprc': 0.9264708786412321, 'loss_val': 0.5905028068183046, 'psi': 0.7245955832629453}-{'f1_val': 0.5800933216989062, 'auprc': 0.9405345153099219, 'loss_val': 0.5732248335044976, 'psi': 0.7242697991433125}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] sending update (kind=head size=1805 to 1 peers)
[S2] START round=25 head_norm_before_train=1.405001 cos_to_last_merge=0.9908 (last merge round=16)
[S2] round=25 local utility u=0.000000 metrics={'f1_val': 0.6774474400198016, 'auprc': 0.7745245896672288, 'loss_val': 0.711598984113422, 'psi': 0.7162782998787725}-{'f1_val': 0.6982702466129149, 'auprc': 0.6645259311821151, 'loss_val': 0.3064074165210651, 'psi': 0.684772520440595}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=25 head_norm_before_train=1.843340 (no previous merge yet)
[S3] round=25 local utility u=0.662943 metrics={'f1_val': 0.9454044042393515, 'auprc': 0.9997589001088878, 'loss_val': 0.17666673554387266, 'psi': 0.967146202587166}-{'f1_val': 0.7270204623173622, 'auprc': 0.9993838327665118, 'loss_val': 0.1911243443002515, 'psi': 0.835965810497022}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] sending update (kind=head size=1803 to 1 peers)
[S4] START round=25 head_norm_before_train=1.503795 cos_to_last_merge=0.9794 (last merge round=15)
[S4] round=25 local utility u=0.044228 metrics={'f1_val': 0.9569543104750466, 'auprc': 0.9618283223039521, 'loss_val': 0.24367062004846143, 'psi': 0.9589039152066088}-{'f1_val': 0.9495538701964279, 'auprc': 0.9594265850109671, 'loss_val': 0.2805181327218553, 'psi': 0.9535029561222437}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] sending update (kind=head size=1805 to 1 peers)
[S5] START round=25 head_norm_before_train=1.699899 (no previous merge yet)
[S5] round=25 local utility u=0.276179 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9592198826938731, 'loss_val': 0.2991493892700202, 'psi': 0.8040529886751538}-{'f1_val': 0.66824816895316, 'auprc': 0.8622943916603533, 'loss_val': 0.3665700089020234, 'psi': 0.7458666580360374}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] sending update (kind=head size=1793 to 1 peers)
[S6] START round=25 head_norm_before_train=1.173384 cos_to_last_merge=0.9623 (last merge round=15)
[S6] round=25 local utility u=0.000000 metrics={'f1_val': 0.9595638646557084, 'auprc': 0.9682348916651277, 'loss_val': 0.2327435428275527, 'psi': 0.9630322754594762}-{'f1_val': 0.9624896750622381, 'auprc': 0.9678388922105639, 'loss_val': 0.24030272635200986, 'psi': 0.9646293619215685}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=25 head_norm_before_train=1.358794 cos_to_last_merge=0.9591 (last merge round=11)
[S7] round=25 local utility u=0.000000 metrics={'f1_val': 0.3756616899964575, 'auprc': 0.6226049855066114, 'loss_val': 1.2408510302822953, 'psi': 0.47443900820051904}-{'f1_val': 0.6560928047140492, 'auprc': 0.7839224775948644, 'loss_val': 0.502075574170951, 'psi': 0.7072246738663752}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=25 head_norm_before_train=1.729816 cos_to_last_merge=0.9879 (last merge round=16)
[S8] round=25 local utility u=0.000000 metrics={'f1_val': 0.9956522998669254, 'auprc': 0.9985311455445469, 'loss_val': 0.1055405436312744, 'psi': 0.996803838137974}-{'f1_val': 0.9965556289389758, 'auprc': 0.9996005732699536, 'loss_val': 0.09340390220145427, 'psi': 0.9977736066713669}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=25 head_norm_before_train=1.355986 cos_to_last_merge=0.9713 (last merge round=16)
[S9] round=25 local utility u=0.000000 metrics={'f1_val': 0.9907831782622126, 'auprc': 0.9986182717262875, 'loss_val': 0.06157638042615151, 'psi': 0.9939172156478426}-{'f1_val': 0.9937266016594926, 'auprc': 0.9984915591357651, 'loss_val': 0.06124081487678776, 'psi': 0.9956325846500016}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=25 head_norm_before_train=1.475454 cos_to_last_merge=0.9602 (last merge round=11)
[S10] round=25 local utility u=0.000000 metrics={'f1_val': 0.8851884144634257, 'auprc': 0.9912022911731497, 'loss_val': 0.2616664371132365, 'psi': 0.9275939651473153}-{'f1_val': 0.9943563983784213, 'auprc': 0.9917322438242064, 'loss_val': 0.1516452211957241, 'psi': 0.9933067365567354}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=25 head_norm_before_train=1.214503 cos_to_last_merge=0.9529 (last merge round=14)
[S11] round=25 local utility u=0.010829 metrics={'f1_val': 0.9948729078564705, 'auprc': 0.9946748847082162, 'loss_val': 0.14479847070454135, 'psi': 0.9947936985971688}-{'f1_val': 0.9965470045135896, 'auprc': 0.9955628806838407, 'loss_val': 0.17916405872272917, 'psi': 0.99615335498169}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] sending update (kind=head size=1804 to 1 peers)
[S13] START round=25 head_norm_before_train=1.715930 cos_to_last_merge=0.9765 (last merge round=11)
[S13] round=25 local utility u=0.029055 metrics={'f1_val': 0.6232668833831563, 'auprc': 0.7333885370083195, 'loss_val': 0.6820126830622624, 'psi': 0.6673155448332215}-{'f1_val': 0.6161372630642264, 'auprc': 0.7367212498264706, 'loss_val': 0.7073440407276497, 'psi': 0.6643708577691241}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=25 head_norm_before_train=1.752549 cos_to_last_merge=0.9745 (last merge round=13)
[S14] round=25 local utility u=0.000000 metrics={'f1_val': 0.9970007132142444, 'auprc': 0.9969705195412679, 'loss_val': 0.03414314237547883, 'psi': 0.9969886357450539}-{'f1_val': 0.9969975081576651, 'auprc': 0.9971448671206742, 'loss_val': 0.03303738158148291, 'psi': 0.9970564517428687}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=25 head_norm_before_train=1.538995 cos_to_last_merge=0.9706 (last merge round=14)
[S15] round=25 local utility u=0.344381 metrics={'f1_val': 0.9922192831658143, 'auprc': 0.9905958474754677, 'loss_val': 0.07493456931663305, 'psi': 0.9915699088896757}-{'f1_val': 0.8957225517692462, 'auprc': 0.9894496184899116, 'loss_val': 0.18127792417015412, 'psi': 0.9332133784575123}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] sending update (kind=head size=1794 to 1 peers)
[S16] START round=25 head_norm_before_train=1.338663 cos_to_last_merge=0.8694 (last merge round=11)
[S16] ⚠️ Model drifted since last merge! cos=0.869
[S16] round=25 local utility u=0.213763 metrics={'f1_val': 0.9831893707588936, 'auprc': 0.9951508615152128, 'loss_val': 0.1225783955162886, 'psi': 0.9879739670614212}-{'f1_val': 0.9329636380729098, 'auprc': 0.9947092631367326, 'loss_val': 0.24742568826685046, 'psi': 0.957661888098439}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S17] START round=25 head_norm_before_train=1.448492 cos_to_last_merge=0.8087 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.809
[S17] round=25 local utility u=0.000000 metrics={'f1_val': 0.5658515059075203, 'auprc': 0.8257304404324338, 'loss_val': 0.7215540469947604, 'psi': 0.6698030797174858}-{'f1_val': 0.590012053010754, 'auprc': 0.9264708786412321, 'loss_val': 0.5905028068183046, 'psi': 0.7245955832629453}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=26 head_norm_before_train=1.418709 cos_to_last_merge=0.9902 (last merge round=16)
[S2] round=26 local utility u=0.094384 metrics={'f1_val': 0.695283033528696, 'auprc': 0.6712505210796413, 'loss_val': 0.3200214322201487, 'psi': 0.6856700285490742}-{'f1_val': 0.6774474400198016, 'auprc': 0.7745245896672288, 'loss_val': 0.711598984113422, 'psi': 0.7162782998787725}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=26 head_norm_before_train=1.863835 (no previous merge yet)
[S3] round=26 local utility u=0.171336 metrics={'f1_val': 0.9982526394021946, 'auprc': 0.9998771906225955, 'loss_val': 0.15143842352210973, 'psi': 0.998902459890355}-{'f1_val': 0.9454044042393515, 'auprc': 0.9997589001088878, 'loss_val': 0.17666673554387266, 'psi': 0.967146202587166}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=26 head_norm_before_train=1.518979 cos_to_last_merge=0.9773 (last merge round=15)
[S4] round=26 local utility u=0.000000 metrics={'f1_val': 0.9363465065402474, 'auprc': 0.9315021180892927, 'loss_val': 0.36784720258954745, 'psi': 0.9344087511598655}-{'f1_val': 0.9569543104750466, 'auprc': 0.9618283223039521, 'loss_val': 0.24367062004846143, 'psi': 0.9589039152066088}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=26 head_norm_before_train=1.712623 (no previous merge yet)
[S5] round=26 local utility u=0.000000 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9533488702364123, 'loss_val': 0.29442530767077457, 'psi': 0.8017045836921695}-{'f1_val': 0.7006083926626743, 'auprc': 0.9592198826938731, 'loss_val': 0.2991493892700202, 'psi': 0.8040529886751538}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=26 head_norm_before_train=1.182350 cos_to_last_merge=0.9603 (last merge round=15)
[S6] round=26 local utility u=0.000000 metrics={'f1_val': 0.4627598996768748, 'auprc': 0.7782022604876351, 'loss_val': 0.7556318534476336, 'psi': 0.5889368440011788}-{'f1_val': 0.9595638646557084, 'auprc': 0.9682348916651277, 'loss_val': 0.2327435428275527, 'psi': 0.9630322754594762}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=26 head_norm_before_train=1.368853 cos_to_last_merge=0.9570 (last merge round=11)
[S7] round=26 local utility u=1.000000 metrics={'f1_val': 0.6583838675661964, 'auprc': 0.7872024834265515, 'loss_val': 0.48055969943704696, 'psi': 0.7099113139103385}-{'f1_val': 0.3756616899964575, 'auprc': 0.6226049855066114, 'loss_val': 1.2408510302822953, 'psi': 0.47443900820051904}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=26 head_norm_before_train=1.748167 cos_to_last_merge=0.9858 (last merge round=16)
[S8] round=26 local utility u=0.027449 metrics={'f1_val': 0.9972129601295068, 'auprc': 0.9995860077158736, 'loss_val': 0.06317033686965748, 'psi': 0.9981621791640535}-{'f1_val': 0.9956522998669254, 'auprc': 0.9985311455445469, 'loss_val': 0.1055405436312744, 'psi': 0.996803838137974}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=26 head_norm_before_train=1.380906 cos_to_last_merge=0.9685 (last merge round=16)
[S9] round=26 local utility u=0.007129 metrics={'f1_val': 0.9920653202133933, 'auprc': 0.9990521967218643, 'loss_val': 0.0563139309715052, 'psi': 0.9948600708167817}-{'f1_val': 0.9907831782622126, 'auprc': 0.9986182717262875, 'loss_val': 0.06157638042615151, 'psi': 0.9939172156478426}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=26 head_norm_before_train=1.494172 cos_to_last_merge=0.9580 (last merge round=11)
[S10] round=26 local utility u=0.409835 metrics={'f1_val': 0.9947723700160056, 'auprc': 0.992180097478039, 'loss_val': 0.10243409315962097, 'psi': 0.9937354610008189}-{'f1_val': 0.8851884144634257, 'auprc': 0.9912022911731497, 'loss_val': 0.2616664371132365, 'psi': 0.9275939651473153}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=26 head_norm_before_train=1.241700 cos_to_last_merge=0.9486 (last merge round=14)
[S11] ⚠️ Model drifted since last merge! cos=0.949
[S11] round=26 local utility u=0.000000 metrics={'f1_val': 0.9682210902255103, 'auprc': 0.9952422781268739, 'loss_val': 0.13062953982803907, 'psi': 0.9790295653860557}-{'f1_val': 0.9948729078564705, 'auprc': 0.9946748847082162, 'loss_val': 0.14479847070454135, 'psi': 0.9947936985971688}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=26 head_norm_before_train=1.723883 cos_to_last_merge=0.9758 (last merge round=11)
[S13] round=26 local utility u=0.000000 metrics={'f1_val': 0.5903363608527077, 'auprc': 0.7434719571209549, 'loss_val': 0.8490366061267913, 'psi': 0.6515905993600066}-{'f1_val': 0.6232668833831563, 'auprc': 0.7333885370083195, 'loss_val': 0.6820126830622624, 'psi': 0.6673155448332215}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=26 head_norm_before_train=1.768346 cos_to_last_merge=0.9733 (last merge round=13)
[S14] round=26 local utility u=0.000923 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9968678824023504, 'loss_val': 0.03196933281578654, 'psi': 0.9969456578555391}-{'f1_val': 0.9970007132142444, 'auprc': 0.9969705195412679, 'loss_val': 0.03414314237547883, 'psi': 0.9969886357450539}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=26 head_norm_before_train=1.554505 cos_to_last_merge=0.9691 (last merge round=14)
[S15] round=26 local utility u=0.000000 metrics={'f1_val': 0.9205565161152308, 'auprc': 0.9690989891756152, 'loss_val': 0.14776545726084842, 'psi': 0.9399735053393845}-{'f1_val': 0.9922192831658143, 'auprc': 0.9905958474754677, 'loss_val': 0.07493456931663305, 'psi': 0.9915699088896757}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=26 head_norm_before_train=1.368906 cos_to_last_merge=0.8663 (last merge round=11)
[S16] ⚠️ Model drifted since last merge! cos=0.866
[S16] round=26 local utility u=0.000000 metrics={'f1_val': 0.9728615936310241, 'auprc': 0.9958801065860723, 'loss_val': 0.12575140334469023, 'psi': 0.9820689988130433}-{'f1_val': 0.9831893707588936, 'auprc': 0.9951508615152128, 'loss_val': 0.1225783955162886, 'psi': 0.9879739670614212}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=26 head_norm_before_train=1.476842 cos_to_last_merge=0.8058 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.806
[S17] round=26 local utility u=0.087371 metrics={'f1_val': 0.5795403489888039, 'auprc': 0.8194023561269635, 'loss_val': 0.6099609109669575, 'psi': 0.6754851518440679}-{'f1_val': 0.5658515059075203, 'auprc': 0.8257304404324338, 'loss_val': 0.7215540469947604, 'psi': 0.6698030797174858}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=27 head_norm_before_train=1.430785 cos_to_last_merge=0.9896 (last merge round=16)
[S2] round=27 local utility u=0.000000 metrics={'f1_val': 0.6824925176489346, 'auprc': 0.665237359673552, 'loss_val': 0.37511269893118837, 'psi': 0.6755904544587816}-{'f1_val': 0.695283033528696, 'auprc': 0.6712505210796413, 'loss_val': 0.3200214322201487, 'psi': 0.6856700285490742}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=27 head_norm_before_train=1.884212 (no previous merge yet)
[S3] round=27 local utility u=0.000000 metrics={'f1_val': 0.9007034727059126, 'auprc': 0.9401543178458405, 'loss_val': 0.20183886866983294, 'psi': 0.9164838107618837}-{'f1_val': 0.9982526394021946, 'auprc': 0.9998771906225955, 'loss_val': 0.15143842352210973, 'psi': 0.998902459890355}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=27 head_norm_before_train=1.528886 cos_to_last_merge=0.9758 (last merge round=15)
[S4] round=27 local utility u=0.139869 metrics={'f1_val': 0.9437313561243069, 'auprc': 0.9760640106677365, 'loss_val': 0.26610369997438227, 'psi': 0.9566644179416788}-{'f1_val': 0.9363465065402474, 'auprc': 0.9315021180892927, 'loss_val': 0.36784720258954745, 'psi': 0.9344087511598655}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=27 head_norm_before_train=1.722609 (no previous merge yet)
[S5] round=27 local utility u=0.060197 metrics={'f1_val': 0.700781124122831, 'auprc': 0.9793808202926636, 'loss_val': 0.2531643355645115, 'psi': 0.812221002590764}-{'f1_val': 0.7006083926626743, 'auprc': 0.9533488702364123, 'loss_val': 0.29442530767077457, 'psi': 0.8017045836921695}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=27 head_norm_before_train=1.189633 cos_to_last_merge=0.9589 (last merge round=15)
[S6] round=27 local utility u=1.000000 metrics={'f1_val': 0.9603548176655936, 'auprc': 0.9718052287412535, 'loss_val': 0.23863306316938596, 'psi': 0.9649349820958575}-{'f1_val': 0.4627598996768748, 'auprc': 0.7782022604876351, 'loss_val': 0.7556318534476336, 'psi': 0.5889368440011788}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S6] sending update (kind=head size=1788 to 1 peers)
[S7] START round=27 head_norm_before_train=1.376116 cos_to_last_merge=0.9557 (last merge round=11)
[S7] round=27 local utility u=0.000000 metrics={'f1_val': 0.5072246059917259, 'auprc': 0.7755612200416954, 'loss_val': 0.8169777056609245, 'psi': 0.6145592516117138}-{'f1_val': 0.6583838675661964, 'auprc': 0.7872024834265515, 'loss_val': 0.48055969943704696, 'psi': 0.7099113139103385}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=27 head_norm_before_train=1.769571 cos_to_last_merge=0.9837 (last merge round=16)
[S8] round=27 local utility u=0.000000 metrics={'f1_val': 0.9956682381346691, 'auprc': 0.9993624867709809, 'loss_val': 0.06206249933178356, 'psi': 0.9971459375891939}-{'f1_val': 0.9972129601295068, 'auprc': 0.9995860077158736, 'loss_val': 0.06317033686965748, 'psi': 0.9981621791640535}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=27 head_norm_before_train=1.404983 cos_to_last_merge=0.9657 (last merge round=16)
[S9] round=27 local utility u=0.000000 metrics={'f1_val': 0.9890937803291044, 'auprc': 0.9984029740345313, 'loss_val': 0.058874957955757146, 'psi': 0.9928174578112752}-{'f1_val': 0.9920653202133933, 'auprc': 0.9990521967218643, 'loss_val': 0.0563139309715052, 'psi': 0.9948600708167817}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=27 head_norm_before_train=1.514634 cos_to_last_merge=0.9557 (last merge round=11)
[S10] round=27 local utility u=0.002974 metrics={'f1_val': 0.9939350594097902, 'auprc': 0.9916345184660702, 'loss_val': 0.0898264564507186, 'psi': 0.9930148430323021}-{'f1_val': 0.9947723700160056, 'auprc': 0.992180097478039, 'loss_val': 0.10243409315962097, 'psi': 0.9937354610008189}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] sending update (kind=head size=1805 to 1 peers)
[S11] START round=27 head_norm_before_train=1.271129 cos_to_last_merge=0.9441 (last merge round=14)
[S11] ⚠️ Model drifted since last merge! cos=0.944
[S11] round=27 local utility u=0.000000 metrics={'f1_val': 0.9636261274344677, 'auprc': 0.9957562844935557, 'loss_val': 0.1197391032527006, 'psi': 0.9764781902581029}-{'f1_val': 0.9682210902255103, 'auprc': 0.9952422781268739, 'loss_val': 0.13062953982803907, 'psi': 0.9790295653860557}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=27 head_norm_before_train=1.731181 cos_to_last_merge=0.9748 (last merge round=11)
[S13] round=27 local utility u=0.112959 metrics={'f1_val': 0.6085545481209205, 'auprc': 0.71810060949205, 'loss_val': 0.6563144807194246, 'psi': 0.6523729726693723}-{'f1_val': 0.5903363608527077, 'auprc': 0.7434719571209549, 'loss_val': 0.8490366061267913, 'psi': 0.6515905993600066}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=27 head_norm_before_train=1.785917 cos_to_last_merge=0.9719 (last merge round=13)
[S14] round=27 local utility u=0.002063 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9972364175937711, 'loss_val': 0.028949715672503967, 'psi': 0.9970930719321075}-{'f1_val': 0.9969975081576651, 'auprc': 0.9968678824023504, 'loss_val': 0.03196933281578654, 'psi': 0.9969456578555391}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=27 head_norm_before_train=1.572191 cos_to_last_merge=0.9675 (last merge round=14)
[S15] round=27 local utility u=0.000000 metrics={'f1_val': 0.8671359008089725, 'auprc': 0.9784052517038785, 'loss_val': 0.25874196282941153, 'psi': 0.9116436411669349}-{'f1_val': 0.9205565161152308, 'auprc': 0.9690989891756152, 'loss_val': 0.14776545726084842, 'psi': 0.9399735053393845}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=27 head_norm_before_train=1.396752 cos_to_last_merge=0.8634 (last merge round=11)
[S16] ⚠️ Model drifted since last merge! cos=0.863
[S16] round=27 local utility u=0.000000 metrics={'f1_val': 0.9599237711147275, 'auprc': 0.9963922816241229, 'loss_val': 0.13073612446999067, 'psi': 0.9745111753184856}-{'f1_val': 0.9728615936310241, 'auprc': 0.9958801065860723, 'loss_val': 0.12575140334469023, 'psi': 0.9820689988130433}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=27 head_norm_before_train=1.505627 cos_to_last_merge=0.8030 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.803
[S17] round=27 local utility u=0.000000 metrics={'f1_val': 0.5170137275677759, 'auprc': 0.7299442313534223, 'loss_val': 0.7734784473476942, 'psi': 0.6021859290820344}-{'f1_val': 0.5795403489888039, 'auprc': 0.8194023561269635, 'loss_val': 0.6099609109669575, 'psi': 0.6754851518440679}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=28 head_norm_before_train=1.442602 cos_to_last_merge=0.9889 (last merge round=16)
[S2] round=28 local utility u=0.091664 metrics={'f1_val': 0.6992497273755923, 'auprc': 0.6696370062076825, 'loss_val': 0.30552606492650375, 'psi': 0.6874046389084284}-{'f1_val': 0.6824925176489346, 'auprc': 0.665237359673552, 'loss_val': 0.37511269893118837, 'psi': 0.6755904544587816}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[S3] START round=28 head_norm_before_train=1.905728 (no previous merge yet)
[S3] round=28 local utility u=0.410173 metrics={'f1_val': 0.9927939321561938, 'auprc': 0.9996033785614356, 'loss_val': 0.11238242570840767, 'psi': 0.9955177107182905}-{'f1_val': 0.9007034727059126, 'auprc': 0.9401543178458405, 'loss_val': 0.20183886866983294, 'psi': 0.9164838107618837}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=28 head_norm_before_train=1.535614 cos_to_last_merge=0.9750 (last merge round=15)
[S4] round=28 local utility u=0.025701 metrics={'f1_val': 0.9558151921751731, 'auprc': 0.9631997213886675, 'loss_val': 0.24861119773675341, 'psi': 0.9587690038605708}-{'f1_val': 0.9437313561243069, 'auprc': 0.9760640106677365, 'loss_val': 0.26610369997438227, 'psi': 0.9566644179416788}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S4] sending update (kind=head size=1806 to 1 peers)
[S5] START round=28 head_norm_before_train=1.732602 (no previous merge yet)
[S5] round=28 local utility u=0.000000 metrics={'f1_val': 0.7006536512124258, 'auprc': 0.8712038936187557, 'loss_val': 0.3142019672160493, 'psi': 0.7688737481749578}-{'f1_val': 0.700781124122831, 'auprc': 0.9793808202926636, 'loss_val': 0.2531643355645115, 'psi': 0.812221002590764}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=28 head_norm_before_train=1.195391 cos_to_last_merge=0.9579 (last merge round=15)
[S6] round=28 local utility u=0.000000 metrics={'f1_val': 0.6418007914726364, 'auprc': 0.81386760704543, 'loss_val': 0.5373202360162647, 'psi': 0.7106275177017538}-{'f1_val': 0.9603548176655936, 'auprc': 0.9718052287412535, 'loss_val': 0.23863306316938596, 'psi': 0.9649349820958575}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=28 head_norm_before_train=1.382494 cos_to_last_merge=0.9545 (last merge round=11)
[S7] round=28 local utility u=0.000000 metrics={'f1_val': 0.39495614763320297, 'auprc': 0.6450893837331779, 'loss_val': 1.1555148106955355, 'psi': 0.495009442073193}-{'f1_val': 0.5072246059917259, 'auprc': 0.7755612200416954, 'loss_val': 0.8169777056609245, 'psi': 0.6145592516117138}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=28 head_norm_before_train=1.791147 cos_to_last_merge=0.9813 (last merge round=16)
[S8] round=28 local utility u=0.007045 metrics={'f1_val': 0.99573403996194, 'auprc': 0.9995626254244802, 'loss_val': 0.04896741497614863, 'psi': 0.9972654741469561}-{'f1_val': 0.9956682381346691, 'auprc': 0.9993624867709809, 'loss_val': 0.06206249933178356, 'psi': 0.9971459375891939}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=28 head_norm_before_train=1.427080 cos_to_last_merge=0.9633 (last merge round=16)
[S9] round=28 local utility u=0.020093 metrics={'f1_val': 0.9937421749897083, 'auprc': 0.9985478046351196, 'loss_val': 0.04701426649896268, 'psi': 0.9956644268478729}-{'f1_val': 0.9890937803291044, 'auprc': 0.9984029740345313, 'loss_val': 0.058874957955757146, 'psi': 0.9928174578112752}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=28 head_norm_before_train=1.537615 cos_to_last_merge=0.9532 (last merge round=11)
[S10] round=28 local utility u=0.015130 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9955962180895646, 'loss_val': 0.07896737273989275, 'psi': 0.9953511906474506}-{'f1_val': 0.9939350594097902, 'auprc': 0.9916345184660702, 'loss_val': 0.0898264564507186, 'psi': 0.9930148430323021}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] sending update (kind=head size=1805 to 1 peers)
[S11] START round=28 head_norm_before_train=1.297966 cos_to_last_merge=0.9396 (last merge round=14)
[S11] ⚠️ Model drifted since last merge! cos=0.940
[S11] round=28 local utility u=0.091585 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9925145697533078, 'loss_val': 0.12291893581873174, 'psi': 0.9947889283826397}-{'f1_val': 0.9636261274344677, 'auprc': 0.9957562844935557, 'loss_val': 0.1197391032527006, 'psi': 0.9764781902581029}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=28 head_norm_before_train=1.736398 cos_to_last_merge=0.9735 (last merge round=11)
[S13] round=28 local utility u=0.000000 metrics={'f1_val': 0.5946799724559544, 'auprc': 0.7226254889336815, 'loss_val': 0.8176515305068005, 'psi': 0.6458581790470452}-{'f1_val': 0.6085545481209205, 'auprc': 0.71810060949205, 'loss_val': 0.6563144807194246, 'psi': 0.6523729726693723}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=28 head_norm_before_train=1.804173 cos_to_last_merge=0.9705 (last merge round=13)
[S14] round=28 local utility u=0.001811 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9972339782571986, 'loss_val': 0.02778478971879792, 'psi': 0.9973385530039148}-{'f1_val': 0.9969975081576651, 'auprc': 0.9972364175937711, 'loss_val': 0.028949715672503967, 'psi': 0.9970930719321075}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=28 head_norm_before_train=1.590695 cos_to_last_merge=0.9657 (last merge round=14)
[S15] round=28 local utility u=0.000000 metrics={'f1_val': 0.7930781745545885, 'auprc': 0.988086312549831, 'loss_val': 0.2912174057166429, 'psi': 0.8710814297526855}-{'f1_val': 0.8671359008089725, 'auprc': 0.9784052517038785, 'loss_val': 0.25874196282941153, 'psi': 0.9116436411669349}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=28 head_norm_before_train=1.420882 cos_to_last_merge=0.8608 (last merge round=11)
[S16] ⚠️ Model drifted since last merge! cos=0.861
[S16] round=28 local utility u=0.112132 metrics={'f1_val': 0.9902923306282351, 'auprc': 0.9940022597889051, 'loss_val': 0.0815140303238045, 'psi': 0.991776302292503}-{'f1_val': 0.9599237711147275, 'auprc': 0.9963922816241229, 'loss_val': 0.13073612446999067, 'psi': 0.9745111753184856}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=28 head_norm_before_train=1.532861 cos_to_last_merge=0.8004 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.800
[S17] round=28 local utility u=1.000000 metrics={'f1_val': 0.6912097686512102, 'auprc': 0.9825861727453373, 'loss_val': 0.5276548889321101, 'psi': 0.8077603302888611}-{'f1_val': 0.5170137275677759, 'auprc': 0.7299442313534223, 'loss_val': 0.7734784473476942, 'psi': 0.6021859290820344}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=29 head_norm_before_train=1.454386 cos_to_last_merge=0.9881 (last merge round=16)
[S2] round=29 local utility u=0.018539 metrics={'f1_val': 0.7085699322450747, 'auprc': 0.7764204770241916, 'loss_val': 0.6447187323494207, 'psi': 0.7357101501567215}-{'f1_val': 0.6992497273755923, 'auprc': 0.6696370062076825, 'loss_val': 0.30552606492650375, 'psi': 0.6874046389084284}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=29 head_norm_before_train=1.927011 (no previous merge yet)
[S3] round=29 local utility u=0.000000 metrics={'f1_val': 0.7690132379919408, 'auprc': 0.8342888284439495, 'loss_val': 0.36015904135898563, 'psi': 0.7951234741727442}-{'f1_val': 0.9927939321561938, 'auprc': 0.9996033785614356, 'loss_val': 0.11238242570840767, 'psi': 0.9955177107182905}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=29 head_norm_before_train=1.540961 cos_to_last_merge=0.9741 (last merge round=15)
[S4] round=29 local utility u=0.000000 metrics={'f1_val': 0.9290966276036942, 'auprc': 0.9457222213225672, 'loss_val': 0.31878468076908034, 'psi': 0.9357468650912435}-{'f1_val': 0.9558151921751731, 'auprc': 0.9631997213886675, 'loss_val': 0.24861119773675341, 'psi': 0.9587690038605708}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=29 head_norm_before_train=1.742108 (no previous merge yet)
[S5] round=29 local utility u=0.000000 metrics={'f1_val': 0.6299515297858136, 'auprc': 0.8584429994110641, 'loss_val': 0.3937258218090414, 'psi': 0.7213481176359138}-{'f1_val': 0.7006536512124258, 'auprc': 0.8712038936187557, 'loss_val': 0.3142019672160493, 'psi': 0.7688737481749578}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=29 head_norm_before_train=1.205994 cos_to_last_merge=0.9562 (last merge round=15)
[S6] round=29 local utility u=0.874601 metrics={'f1_val': 0.8247125566117202, 'auprc': 0.9679457365872347, 'loss_val': 0.3478236474896867, 'psi': 0.8820058286019259}-{'f1_val': 0.6418007914726364, 'auprc': 0.81386760704543, 'loss_val': 0.5373202360162647, 'psi': 0.7106275177017538}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=29 head_norm_before_train=1.390065 cos_to_last_merge=0.9529 (last merge round=11)
[S7] round=29 local utility u=1.000000 metrics={'f1_val': 0.6477996961768924, 'auprc': 0.8628535645640287, 'loss_val': 0.49203991909040923, 'psi': 0.7338212435317469}-{'f1_val': 0.39495614763320297, 'auprc': 0.6450893837331779, 'loss_val': 1.1555148106955355, 'psi': 0.495009442073193}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=29 head_norm_before_train=1.817152 cos_to_last_merge=0.9789 (last merge round=16)
[S8] round=29 local utility u=0.000000 metrics={'f1_val': 0.9958165761649177, 'auprc': 0.9995674649431316, 'loss_val': 0.055480783773758015, 'psi': 0.9973169316762034}-{'f1_val': 0.99573403996194, 'auprc': 0.9995626254244802, 'loss_val': 0.04896741497614863, 'psi': 0.9972654741469561}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=29 head_norm_before_train=1.447623 cos_to_last_merge=0.9609 (last merge round=16)
[S9] round=29 local utility u=0.004352 metrics={'f1_val': 0.994583549332968, 'auprc': 0.998182702865563, 'loss_val': 0.04226347029542662, 'psi': 0.9960232107460061}-{'f1_val': 0.9937421749897083, 'auprc': 0.9985478046351196, 'loss_val': 0.04701426649896268, 'psi': 0.9956644268478729}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=29 head_norm_before_train=1.555824 cos_to_last_merge=0.9512 (last merge round=11)
[S10] round=29 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9939878162749152, 'loss_val': 0.09403896195860138, 'psi': 0.9947078299215909}-{'f1_val': 0.9951878390193748, 'auprc': 0.9955962180895646, 'loss_val': 0.07896737273989275, 'psi': 0.9953511906474506}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=29 head_norm_before_train=1.323341 cos_to_last_merge=0.9351 (last merge round=14)
[S11] ⚠️ Model drifted since last merge! cos=0.935
[S11] round=29 local utility u=0.012997 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9922590535727014, 'loss_val': 0.09760872703453956, 'psi': 0.9948318241372343}-{'f1_val': 0.996305167468861, 'auprc': 0.9925145697533078, 'loss_val': 0.12291893581873174, 'psi': 0.9947889283826397}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=29 head_norm_before_train=1.740689 cos_to_last_merge=0.9727 (last merge round=11)
[S13] round=29 local utility u=0.070473 metrics={'f1_val': 0.6113119474230673, 'auprc': 0.7087201796700516, 'loss_val': 0.7347807595182632, 'psi': 0.650275240321861}-{'f1_val': 0.5946799724559544, 'auprc': 0.7226254889336815, 'loss_val': 0.8176515305068005, 'psi': 0.6458581790470452}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=29 head_norm_before_train=1.819679 cos_to_last_merge=0.9693 (last merge round=13)
[S14] round=29 local utility u=0.000000 metrics={'f1_val': 0.9492083668878748, 'auprc': 0.9972436199506176, 'loss_val': 0.08695266725264911, 'psi': 0.968422468112972}-{'f1_val': 0.9974082695017256, 'auprc': 0.9972339782571986, 'loss_val': 0.02778478971879792, 'psi': 0.9973385530039148}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=29 head_norm_before_train=1.610684 cos_to_last_merge=0.9636 (last merge round=14)
[S15] round=29 local utility u=0.673052 metrics={'f1_val': 0.9800593395817278, 'auprc': 0.9932460814391384, 'loss_val': 0.08248057177685363, 'psi': 0.9853340363246921}-{'f1_val': 0.7930781745545885, 'auprc': 0.988086312549831, 'loss_val': 0.2912174057166429, 'psi': 0.8710814297526855}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=29 head_norm_before_train=1.444823 cos_to_last_merge=0.8581 (last merge round=11)
[S16] ⚠️ Model drifted since last merge! cos=0.858
[S16] round=29 local utility u=0.000000 metrics={'f1_val': 0.9049084333374584, 'auprc': 0.9919457713027274, 'loss_val': 0.31329628640670965, 'psi': 0.939723368523566}-{'f1_val': 0.9902923306282351, 'auprc': 0.9940022597889051, 'loss_val': 0.0815140303238045, 'psi': 0.991776302292503}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=29 head_norm_before_train=1.558946 cos_to_last_merge=0.7979 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.798
[S17] round=29 local utility u=0.000000 metrics={'f1_val': 0.5906754369145981, 'auprc': 0.9749036096030823, 'loss_val': 0.5900324646040633, 'psi': 0.7443667059899918}-{'f1_val': 0.6912097686512102, 'auprc': 0.9825861727453373, 'loss_val': 0.5276548889321101, 'psi': 0.8077603302888611}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=30 head_norm_before_train=1.466777 cos_to_last_merge=0.9872 (last merge round=16)
[S2] round=30 local utility u=0.050739 metrics={'f1_val': 0.7051380052813155, 'auprc': 0.7713451594703016, 'loss_val': 0.5074235015056919, 'psi': 0.73162086695691}-{'f1_val': 0.7085699322450747, 'auprc': 0.7764204770241916, 'loss_val': 0.6447187323494207, 'psi': 0.7357101501567215}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=30 head_norm_before_train=1.948007 (no previous merge yet)
[S3] round=30 local utility u=0.301363 metrics={'f1_val': 0.8261802675207486, 'auprc': 0.8981616330746592, 'loss_val': 0.2920535114642138, 'psi': 0.8549728137423129}-{'f1_val': 0.7690132379919408, 'auprc': 0.8342888284439495, 'loss_val': 0.36015904135898563, 'psi': 0.7951234741727442}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=30 head_norm_before_train=1.546120 cos_to_last_merge=0.9732 (last merge round=15)
[S4] round=30 local utility u=0.034358 metrics={'f1_val': 0.9361484880842552, 'auprc': 0.937075010290771, 'loss_val': 0.2664389371595076, 'psi': 0.9365190969668615}-{'f1_val': 0.9290966276036942, 'auprc': 0.9457222213225672, 'loss_val': 0.31878468076908034, 'psi': 0.9357468650912435}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=30 head_norm_before_train=1.750695 (no previous merge yet)
[S5] round=30 local utility u=0.516901 metrics={'f1_val': 0.7009432789550658, 'auprc': 0.991901951851929, 'loss_val': 0.18625084014178284, 'psi': 0.8173267481138111}-{'f1_val': 0.6299515297858136, 'auprc': 0.8584429994110641, 'loss_val': 0.3937258218090414, 'psi': 0.7213481176359138}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] sending update (kind=head size=1794 to 1 peers)
[S6] START round=30 head_norm_before_train=1.216683 cos_to_last_merge=0.9542 (last merge round=15)
[S6] round=30 local utility u=0.000000 metrics={'f1_val': 0.8084370190503966, 'auprc': 0.8199722855857213, 'loss_val': 0.48514126383324213, 'psi': 0.8130511256645265}-{'f1_val': 0.8247125566117202, 'auprc': 0.9679457365872347, 'loss_val': 0.3478236474896867, 'psi': 0.8820058286019259}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=30 head_norm_before_train=1.396439 cos_to_last_merge=0.9517 (last merge round=11)
[S7] round=30 local utility u=0.000000 metrics={'f1_val': 0.42734619819901776, 'auprc': 0.7802258998725805, 'loss_val': 1.0417843866945922, 'psi': 0.5684980788684428}-{'f1_val': 0.6477996961768924, 'auprc': 0.8628535645640287, 'loss_val': 0.49203991909040923, 'psi': 0.7338212435317469}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=30 head_norm_before_train=1.840106 cos_to_last_merge=0.9770 (last merge round=16)
[S8] round=30 local utility u=0.000000 metrics={'f1_val': 0.9928127407686298, 'auprc': 0.9995720519638287, 'loss_val': 0.0499129631485647, 'psi': 0.9955164652467093}-{'f1_val': 0.9958165761649177, 'auprc': 0.9995674649431316, 'loss_val': 0.055480783773758015, 'psi': 0.9973169316762034}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=30 head_norm_before_train=1.463913 cos_to_last_merge=0.9593 (last merge round=16)
[S9] round=30 local utility u=0.000000 metrics={'f1_val': 0.9905518720143266, 'auprc': 0.9981740565364099, 'loss_val': 0.046689817810262796, 'psi': 0.9936007458231599}-{'f1_val': 0.994583549332968, 'auprc': 0.998182702865563, 'loss_val': 0.04226347029542662, 'psi': 0.9960232107460061}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=30 head_norm_before_train=1.571033 cos_to_last_merge=0.9496 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.950
[S10] round=30 local utility u=0.000000 metrics={'f1_val': 0.9939350594097902, 'auprc': 0.9923259769482988, 'loss_val': 0.09592080012126257, 'psi': 0.9932914264251936}-{'f1_val': 0.9951878390193748, 'auprc': 0.9939878162749152, 'loss_val': 0.09403896195860138, 'psi': 0.9947078299215909}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=30 head_norm_before_train=1.348915 cos_to_last_merge=0.9309 (last merge round=14)
[S11] ⚠️ Model drifted since last merge! cos=0.931
[S11] round=30 local utility u=0.000000 metrics={'f1_val': 0.9581847857455288, 'auprc': 0.9966848541760099, 'loss_val': 0.09938200074513566, 'psi': 0.9735848131177212}-{'f1_val': 0.9965470045135896, 'auprc': 0.9922590535727014, 'loss_val': 0.09760872703453956, 'psi': 0.9948318241372343}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=30 head_norm_before_train=1.745172 cos_to_last_merge=0.9721 (last merge round=11)
[S13] round=30 local utility u=0.002094 metrics={'f1_val': 0.614736507380415, 'auprc': 0.6611936347008884, 'loss_val': 0.6085598096823501, 'psi': 0.6333193583086043}-{'f1_val': 0.6113119474230673, 'auprc': 0.7087201796700516, 'loss_val': 0.7347807595182632, 'psi': 0.650275240321861}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S14] START round=30 head_norm_before_train=1.834096 cos_to_last_merge=0.9682 (last merge round=13)
[S14] round=30 local utility u=0.150601 metrics={'f1_val': 0.9902896058779449, 'auprc': 0.998971148913153, 'loss_val': 0.037421649175761004, 'psi': 0.9937622230920281}-{'f1_val': 0.9492083668878748, 'auprc': 0.9972436199506176, 'loss_val': 0.08695266725264911, 'psi': 0.968422468112972}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=30 head_norm_before_train=1.632849 cos_to_last_merge=0.9613 (last merge round=14)
[S15] round=30 local utility u=0.000000 metrics={'f1_val': 0.896097627587648, 'auprc': 0.9924422839804053, 'loss_val': 0.19459827894908024, 'psi': 0.9346354901447509}-{'f1_val': 0.9800593395817278, 'auprc': 0.9932460814391384, 'loss_val': 0.08248057177685363, 'psi': 0.9853340363246921}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=30 head_norm_before_train=1.465531 cos_to_last_merge=0.8559 (last merge round=11)
[S16] ⚠️ Model drifted since last merge! cos=0.856
[S16] round=30 local utility u=0.391356 metrics={'f1_val': 0.9914337497278158, 'auprc': 0.9955126970067014, 'loss_val': 0.0604374262674275, 'psi': 0.99306532863937}-{'f1_val': 0.9049084333374584, 'auprc': 0.9919457713027274, 'loss_val': 0.31329628640670965, 'psi': 0.939723368523566}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=30 head_norm_before_train=1.582596 cos_to_last_merge=0.7959 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.796
[S17] round=30 local utility u=0.000000 metrics={'f1_val': 0.5938564918924845, 'auprc': 0.9663843140184287, 'loss_val': 0.6088512057975757, 'psi': 0.7428676207428622}-{'f1_val': 0.5906754369145981, 'auprc': 0.9749036096030823, 'loss_val': 0.5900324646040633, 'psi': 0.7443667059899918}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=31 head_norm_before_train=1.478575 cos_to_last_merge=0.9865 (last merge round=16)
[S2] round=31 local utility u=0.055154 metrics={'f1_val': 0.6992468487673049, 'auprc': 0.7509979496548107, 'loss_val': 0.30072678079957643, 'psi': 0.7199472891223073}-{'f1_val': 0.7051380052813155, 'auprc': 0.7713451594703016, 'loss_val': 0.5074235015056919, 'psi': 0.73162086695691}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=31 head_norm_before_train=1.967345 (no previous merge yet)
[S3] round=31 local utility u=0.000000 metrics={'f1_val': 0.749061740803185, 'auprc': 0.8285099192766012, 'loss_val': 0.45028686101558063, 'psi': 0.7808410121925515}-{'f1_val': 0.8261802675207486, 'auprc': 0.8981616330746592, 'loss_val': 0.2920535114642138, 'psi': 0.8549728137423129}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=31 head_norm_before_train=1.549221 cos_to_last_merge=0.9732 (last merge round=15)
[S4] round=31 local utility u=0.073894 metrics={'f1_val': 0.9513911377901768, 'auprc': 0.950249534180622, 'loss_val': 0.24962943609062035, 'psi': 0.9509344963463549}-{'f1_val': 0.9361484880842552, 'auprc': 0.937075010290771, 'loss_val': 0.2664389371595076, 'psi': 0.9365190969668615}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=31 head_norm_before_train=1.760441 (no previous merge yet)
[S5] round=31 local utility u=0.000000 metrics={'f1_val': 0.4178296265806952, 'auprc': 0.7735916185310103, 'loss_val': 1.5694636030899738, 'psi': 0.5601344233608213}-{'f1_val': 0.7009432789550658, 'auprc': 0.991901951851929, 'loss_val': 0.18625084014178284, 'psi': 0.8173267481138111}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=31 head_norm_before_train=1.227682 cos_to_last_merge=0.9519 (last merge round=15)
[S6] round=31 local utility u=0.764386 metrics={'f1_val': 0.9492436723977596, 'auprc': 0.9651730574910556, 'loss_val': 0.2368117466749519, 'psi': 0.955615426435078}-{'f1_val': 0.8084370190503966, 'auprc': 0.8199722855857213, 'loss_val': 0.48514126383324213, 'psi': 0.8130511256645265}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] START round=31 head_norm_before_train=1.405137 cos_to_last_merge=0.9503 (last merge round=11)
[S7] round=31 local utility u=1.000000 metrics={'f1_val': 0.6413703156291246, 'auprc': 0.8459968249636984, 'loss_val': 0.5065557182261728, 'psi': 0.7232209193629542}-{'f1_val': 0.42734619819901776, 'auprc': 0.7802258998725805, 'loss_val': 1.0417843866945922, 'psi': 0.5684980788684428}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S8] START round=31 head_norm_before_train=1.862324 cos_to_last_merge=0.9743 (last merge round=16)
[S8] round=31 local utility u=0.008742 metrics={'f1_val': 0.9947116379946571, 'auprc': 0.9994621547119903, 'loss_val': 0.043492796637191924, 'psi': 0.9966118446815904}-{'f1_val': 0.9928127407686298, 'auprc': 0.9995720519638287, 'loss_val': 0.0499129631485647, 'psi': 0.9955164652467093}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=31 head_norm_before_train=1.477553 cos_to_last_merge=0.9577 (last merge round=16)
[S9] round=31 local utility u=0.005218 metrics={'f1_val': 0.9918149940667227, 'auprc': 0.9981782008180307, 'loss_val': 0.04384546521550044, 'psi': 0.9943602767672458}-{'f1_val': 0.9905518720143266, 'auprc': 0.9981740565364099, 'loss_val': 0.046689817810262796, 'psi': 0.9936007458231599}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=31 head_norm_before_train=1.584189 cos_to_last_merge=0.9482 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.948
[S10] round=31 local utility u=0.021077 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9940054466913418, 'loss_val': 0.06379314326875692, 'psi': 0.994462068902054}-{'f1_val': 0.9939350594097902, 'auprc': 0.9923259769482988, 'loss_val': 0.09592080012126257, 'psi': 0.9932914264251936}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S10] sending update (kind=head size=1807 to 1 peers)
[S11] START round=31 head_norm_before_train=1.374538 cos_to_last_merge=0.9268 (last merge round=14)
[S11] ⚠️ Model drifted since last merge! cos=0.927
[S11] round=31 local utility u=0.111200 metrics={'f1_val': 0.9931905527185116, 'auprc': 0.9937983357110896, 'loss_val': 0.07835613742386242, 'psi': 0.9934336659155428}-{'f1_val': 0.9581847857455288, 'auprc': 0.9966848541760099, 'loss_val': 0.09938200074513566, 'psi': 0.9735848131177212}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] sending update (kind=head size=1793 to 1 peers)
[S13] START round=31 head_norm_before_train=1.751804 cos_to_last_merge=0.9709 (last merge round=11)
[S13] round=31 local utility u=0.000000 metrics={'f1_val': 0.6074425956267493, 'auprc': 0.6880263358506326, 'loss_val': 0.7750981343690675, 'psi': 0.6396760917163027}-{'f1_val': 0.614736507380415, 'auprc': 0.6611936347008884, 'loss_val': 0.6085598096823501, 'psi': 0.6333193583086043}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=31 head_norm_before_train=1.847407 cos_to_last_merge=0.9671 (last merge round=13)
[S14] round=31 local utility u=0.028252 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9989717944711518, 'loss_val': 0.023632413026440167, 'psi': 0.9980336794894961}-{'f1_val': 0.9902896058779449, 'auprc': 0.998971148913153, 'loss_val': 0.037421649175761004, 'psi': 0.9937622230920281}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] sending update (kind=head size=1805 to 1 peers)
[S15] START round=31 head_norm_before_train=1.652508 cos_to_last_merge=0.9595 (last merge round=14)
[S15] round=31 local utility u=0.242486 metrics={'f1_val': 0.9587796404324889, 'auprc': 0.9955569023472036, 'loss_val': 0.09506234270618855, 'psi': 0.9734905451983749}-{'f1_val': 0.896097627587648, 'auprc': 0.9924422839804053, 'loss_val': 0.19459827894908024, 'psi': 0.9346354901447509}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=31 head_norm_before_train=1.484886 cos_to_last_merge=0.8539 (last merge round=11)
[S16] ⚠️ Model drifted since last merge! cos=0.854
[S16] round=31 local utility u=0.000214 metrics={'f1_val': 0.9906533999658295, 'auprc': 0.9974058211656062, 'loss_val': 0.06100641726134287, 'psi': 0.9933543684457401}-{'f1_val': 0.9914337497278158, 'auprc': 0.9955126970067014, 'loss_val': 0.0604374262674275, 'psi': 0.99306532863937}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=31 head_norm_before_train=1.603586 cos_to_last_merge=0.7942 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.794
[S17] round=31 local utility u=0.000000 metrics={'f1_val': 0.5738120786501587, 'auprc': 0.8693637842638721, 'loss_val': 0.7251294347518326, 'psi': 0.692032760895644}-{'f1_val': 0.5938564918924845, 'auprc': 0.9663843140184287, 'loss_val': 0.6088512057975757, 'psi': 0.7428676207428622}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=32 head_norm_before_train=1.490966 cos_to_last_merge=0.9858 (last merge round=16)
[S2] round=32 local utility u=0.007465 metrics={'f1_val': 0.693661266140993, 'auprc': 0.7758996104469572, 'loss_val': 0.3269880970025053, 'psi': 0.7265566038633787}-{'f1_val': 0.6992468487673049, 'auprc': 0.7509979496548107, 'loss_val': 0.30072678079957643, 'psi': 0.7199472891223073}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] sending update (kind=head size=1793 to 1 peers)
[S3] START round=32 head_norm_before_train=1.983891 (no previous merge yet)
[S3] round=32 local utility u=0.968873 metrics={'f1_val': 0.940745664257042, 'auprc': 0.9814277819174194, 'loss_val': 0.1213975747813191, 'psi': 0.957018511321193}-{'f1_val': 0.749061740803185, 'auprc': 0.8285099192766012, 'loss_val': 0.45028686101558063, 'psi': 0.7808410121925515}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] sending update (kind=head size=1803 to 1 peers)
[S4] START round=32 head_norm_before_train=1.554687 cos_to_last_merge=0.9734 (last merge round=15)
[S4] round=32 local utility u=0.029039 metrics={'f1_val': 0.9493177166391603, 'auprc': 0.9760141711541126, 'loss_val': 0.25640505456401913, 'psi': 0.9599962984451412}-{'f1_val': 0.9513911377901768, 'auprc': 0.950249534180622, 'loss_val': 0.24962943609062035, 'psi': 0.9509344963463549}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] sending update (kind=head size=1805 to 1 peers)
[S5] START round=32 head_norm_before_train=1.768142 (no previous merge yet)
[S5] round=32 local utility u=1.000000 metrics={'f1_val': 0.7006090940057808, 'auprc': 0.918424342977452, 'loss_val': 0.3679231548471209, 'psi': 0.7877351935944492}-{'f1_val': 0.4178296265806952, 'auprc': 0.7735916185310103, 'loss_val': 1.5694636030899738, 'psi': 0.5601344233608213}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] START round=32 head_norm_before_train=1.248678 cos_to_last_merge=0.9478 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.948
[S6] round=32 local utility u=0.000000 metrics={'f1_val': 0.7208432729220294, 'auprc': 0.8087255533975262, 'loss_val': 0.6035743032431754, 'psi': 0.7559961851122281}-{'f1_val': 0.9492436723977596, 'auprc': 0.9651730574910556, 'loss_val': 0.2368117466749519, 'psi': 0.955615426435078}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=32 head_norm_before_train=1.412607 cos_to_last_merge=0.9490 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.949
[S7] round=32 local utility u=0.000000 metrics={'f1_val': 0.5853665690183003, 'auprc': 0.8114467877388055, 'loss_val': 0.7136327032504048, 'psi': 0.6757986565065024}-{'f1_val': 0.6413703156291246, 'auprc': 0.8459968249636984, 'loss_val': 0.5065557182261728, 'psi': 0.7232209193629542}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=32 head_norm_before_train=1.885020 cos_to_last_merge=0.9713 (last merge round=16)
[S8] round=32 local utility u=0.000000 metrics={'f1_val': 0.7152925010211846, 'auprc': 0.9890776404646342, 'loss_val': 0.14705343645776867, 'psi': 0.8248065567985645}-{'f1_val': 0.9947116379946571, 'auprc': 0.9994621547119903, 'loss_val': 0.043492796637191924, 'psi': 0.9966118446815904}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=32 head_norm_before_train=1.489633 cos_to_last_merge=0.9562 (last merge round=16)
[S9] round=32 local utility u=0.011930 metrics={'f1_val': 0.9947440946163844, 'auprc': 0.9981903402538026, 'loss_val': 0.037596398202650955, 'psi': 0.9961225928713517}-{'f1_val': 0.9918149940667227, 'auprc': 0.9981782008180307, 'loss_val': 0.04384546521550044, 'psi': 0.9943602767672458}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] sending update (kind=head size=1804 to 1 peers)
[S10] START round=32 head_norm_before_train=1.599414 cos_to_last_merge=0.9469 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.947
[S10] round=32 local utility u=0.000269 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.9961693711222137, 'loss_val': 0.06174360765019957, 'psi': 0.994527373341429}-{'f1_val': 0.9947664837091956, 'auprc': 0.9940054466913418, 'loss_val': 0.06379314326875692, 'psi': 0.994462068902054}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=32 head_norm_before_train=1.397643 cos_to_last_merge=0.9231 (last merge round=14)
[S11] ⚠️ Model drifted since last merge! cos=0.923
[S11] round=32 local utility u=0.000000 metrics={'f1_val': 0.9948966361412585, 'auprc': 0.9938453872278568, 'loss_val': 0.13094970635144815, 'psi': 0.9944761365758978}-{'f1_val': 0.9931905527185116, 'auprc': 0.9937983357110896, 'loss_val': 0.07835613742386242, 'psi': 0.9934336659155428}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=32 head_norm_before_train=1.757923 cos_to_last_merge=0.9701 (last merge round=11)
[S13] round=32 local utility u=0.127901 metrics={'f1_val': 0.6245195638020394, 'auprc': 0.6886030853433731, 'loss_val': 0.6234878741244383, 'psi': 0.650152972418573}-{'f1_val': 0.6074425956267493, 'auprc': 0.6880263358506326, 'loss_val': 0.7750981343690675, 'psi': 0.6396760917163027}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=32 head_norm_before_train=1.861337 cos_to_last_merge=0.9660 (last merge round=13)
[S14] round=32 local utility u=0.000000 metrics={'f1_val': 0.9970007132142444, 'auprc': 0.9988965935800985, 'loss_val': 0.02499702944540947, 'psi': 0.9977590653605861}-{'f1_val': 0.9974082695017256, 'auprc': 0.9989717944711518, 'loss_val': 0.023632413026440167, 'psi': 0.9980336794894961}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=32 head_norm_before_train=1.670589 cos_to_last_merge=0.9577 (last merge round=14)
[S15] round=32 local utility u=0.000000 metrics={'f1_val': 0.8708207262250933, 'auprc': 0.9926660348925821, 'loss_val': 0.2720888662218427, 'psi': 0.9195588496920888}-{'f1_val': 0.9587796404324889, 'auprc': 0.9955569023472036, 'loss_val': 0.09506234270618855, 'psi': 0.9734905451983749}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=32 head_norm_before_train=1.503921 cos_to_last_merge=0.8519 (last merge round=11)
[S16] ⚠️ Model drifted since last merge! cos=0.852
[S16] round=32 local utility u=0.000000 metrics={'f1_val': 0.9817435622778636, 'auprc': 0.9963275485317207, 'loss_val': 0.08382451212877, 'psi': 0.9875771567794065}-{'f1_val': 0.9906533999658295, 'auprc': 0.9974058211656062, 'loss_val': 0.06100641726134287, 'psi': 0.9933543684457401}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=32 head_norm_before_train=1.625851 cos_to_last_merge=0.7924 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.792
[S17] round=32 local utility u=0.000000 metrics={'f1_val': 0.5799640159743531, 'auprc': 0.827964175907024, 'loss_val': 0.7801781361951571, 'psi': 0.6791640799474215}-{'f1_val': 0.5738120786501587, 'auprc': 0.8693637842638721, 'loss_val': 0.7251294347518326, 'psi': 0.692032760895644}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=33 head_norm_before_train=1.503635 cos_to_last_merge=0.9851 (last merge round=16)
[S2] round=33 local utility u=0.000000 metrics={'f1_val': 0.6889350577508607, 'auprc': 0.6696721120504157, 'loss_val': 0.39006328273795304, 'psi': 0.6812298794706827}-{'f1_val': 0.693661266140993, 'auprc': 0.7758996104469572, 'loss_val': 0.3269880970025053, 'psi': 0.7265566038633787}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=33 head_norm_before_train=1.995707 (no previous merge yet)
[S3] round=33 local utility u=0.093283 metrics={'f1_val': 0.9590901013360722, 'auprc': 0.9939665562911998, 'loss_val': 0.082514834974517, 'psi': 0.9730406833181232}-{'f1_val': 0.940745664257042, 'auprc': 0.9814277819174194, 'loss_val': 0.1213975747813191, 'psi': 0.957018511321193}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=33 head_norm_before_train=1.563801 cos_to_last_merge=0.9727 (last merge round=15)
[S4] round=33 local utility u=0.000000 metrics={'f1_val': 0.9416288570627362, 'auprc': 0.9562173976423292, 'loss_val': 0.29438581000661396, 'psi': 0.9474642732945735}-{'f1_val': 0.9493177166391603, 'auprc': 0.9760141711541126, 'loss_val': 0.25640505456401913, 'psi': 0.9599962984451412}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=33 head_norm_before_train=1.770324 (no previous merge yet)
[S5] round=33 local utility u=0.176621 metrics={'f1_val': 0.7005120070508268, 'auprc': 0.9905540972881236, 'loss_val': 0.23048760183775477, 'psi': 0.8165288431457456}-{'f1_val': 0.7006090940057808, 'auprc': 0.918424342977452, 'loss_val': 0.3679231548471209, 'psi': 0.7877351935944492}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] START round=33 head_norm_before_train=1.268801 cos_to_last_merge=0.9435 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.944
[S6] round=33 local utility u=1.000000 metrics={'f1_val': 0.9539161772933535, 'auprc': 0.9523692630156282, 'loss_val': 0.16957244587036374, 'psi': 0.9532974115822634}-{'f1_val': 0.7208432729220294, 'auprc': 0.8087255533975262, 'loss_val': 0.6035743032431754, 'psi': 0.7559961851122281}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=33 head_norm_before_train=1.419110 cos_to_last_merge=0.9479 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.948
[S7] round=33 local utility u=0.000000 metrics={'f1_val': 0.5463883680134491, 'auprc': 0.7983920904690369, 'loss_val': 0.7833495325669353, 'psi': 0.6471898569956842}-{'f1_val': 0.5853665690183003, 'auprc': 0.8114467877388055, 'loss_val': 0.7136327032504048, 'psi': 0.6757986565065024}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=33 head_norm_before_train=1.903245 cos_to_last_merge=0.9690 (last merge round=16)
[S8] round=33 local utility u=0.834328 metrics={'f1_val': 0.9753373243123729, 'auprc': 0.9997462912555851, 'loss_val': 0.07067273536292866, 'psi': 0.9851009110896578}-{'f1_val': 0.7152925010211846, 'auprc': 0.9890776404646342, 'loss_val': 0.14705343645776867, 'psi': 0.8248065567985645}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=33 head_norm_before_train=1.502109 cos_to_last_merge=0.9547 (last merge round=16)
[S9] round=33 local utility u=0.003033 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9960411942048388, 'loss_val': 0.03411874677625927, 'psi': 0.9961665345495021}-{'f1_val': 0.9947440946163844, 'auprc': 0.9981903402538026, 'loss_val': 0.037596398202650955, 'psi': 0.9961225928713517}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=33 head_norm_before_train=1.616625 cos_to_last_merge=0.9454 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.945
[S10] round=33 local utility u=0.001805 metrics={'f1_val': 0.9932304850534869, 'auprc': 0.9957972014551607, 'loss_val': 0.055803332424914705, 'psi': 0.9942571716141564}-{'f1_val': 0.9934327081542391, 'auprc': 0.9961693711222137, 'loss_val': 0.06174360765019957, 'psi': 0.994527373341429}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S10] sending update (kind=head size=1806 to 1 peers)
[S11] START round=33 head_norm_before_train=1.419806 cos_to_last_merge=0.9196 (last merge round=14)
[S11] ⚠️ Model drifted since last merge! cos=0.920
[S11] round=33 local utility u=0.000000 metrics={'f1_val': 0.8417846233200402, 'auprc': 0.9934171453805067, 'loss_val': 0.21058295519314577, 'psi': 0.9024376321442269}-{'f1_val': 0.9948966361412585, 'auprc': 0.9938453872278568, 'loss_val': 0.13094970635144815, 'psi': 0.9944761365758978}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=33 head_norm_before_train=1.760745 cos_to_last_merge=0.9699 (last merge round=11)
[S13] round=33 local utility u=0.000000 metrics={'f1_val': 0.5722738392018629, 'auprc': 0.7132323268566015, 'loss_val': 0.9578576436357522, 'psi': 0.6286572342637584}-{'f1_val': 0.6245195638020394, 'auprc': 0.6886030853433731, 'loss_val': 0.6234878741244383, 'psi': 0.650152972418573}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=33 head_norm_before_train=1.873403 cos_to_last_merge=0.9652 (last merge round=13)
[S14] round=33 local utility u=0.000000 metrics={'f1_val': 0.9970007132142444, 'auprc': 0.997225211843719, 'loss_val': 0.026393843461304693, 'psi': 0.9970905126660343}-{'f1_val': 0.9970007132142444, 'auprc': 0.9988965935800985, 'loss_val': 0.02499702944540947, 'psi': 0.9977590653605861}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=33 head_norm_before_train=1.689320 cos_to_last_merge=0.9561 (last merge round=14)
[S15] round=33 local utility u=0.000000 metrics={'f1_val': 0.6975858144641373, 'auprc': 0.9876952743376528, 'loss_val': 0.48308692353442356, 'psi': 0.8136295984135435}-{'f1_val': 0.8708207262250933, 'auprc': 0.9926660348925821, 'loss_val': 0.2720888662218427, 'psi': 0.9195588496920888}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=33 head_norm_before_train=1.520458 cos_to_last_merge=0.8501 (last merge round=11)
[S16] ⚠️ Model drifted since last merge! cos=0.850
[S16] round=33 local utility u=0.000000 metrics={'f1_val': 0.932506044842818, 'auprc': 0.9941790470626445, 'loss_val': 0.24142110035616604, 'psi': 0.9571752457307485}-{'f1_val': 0.9817435622778636, 'auprc': 0.9963275485317207, 'loss_val': 0.08382451212877, 'psi': 0.9875771567794065}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=33 head_norm_before_train=1.648575 cos_to_last_merge=0.7905 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.790
[S17] round=33 local utility u=0.000000 metrics={'f1_val': 0.5779289136509334, 'auprc': 0.784263705733786, 'loss_val': 0.8563183521406369, 'psi': 0.6604628304840744}-{'f1_val': 0.5799640159743531, 'auprc': 0.827964175907024, 'loss_val': 0.7801781361951571, 'psi': 0.6791640799474215}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=34 head_norm_before_train=1.513619 cos_to_last_merge=0.9844 (last merge round=16)
[S2] round=34 local utility u=0.170255 metrics={'f1_val': 0.7050010488724225, 'auprc': 0.7440376348684172, 'loss_val': 0.3690451993098321, 'psi': 0.7206156832708204}-{'f1_val': 0.6889350577508607, 'auprc': 0.6696721120504157, 'loss_val': 0.39006328273795304, 'psi': 0.6812298794706827}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=34 head_norm_before_train=2.005316 (no previous merge yet)
[S3] round=34 local utility u=0.000000 metrics={'f1_val': 0.9420003179661349, 'auprc': 0.9858382266620423, 'loss_val': 0.10414566690689828, 'psi': 0.959535481444498}-{'f1_val': 0.9590901013360722, 'auprc': 0.9939665562911998, 'loss_val': 0.082514834974517, 'psi': 0.9730406833181232}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=34 head_norm_before_train=1.570992 cos_to_last_merge=0.9719 (last merge round=15)
[S4] round=34 local utility u=0.000000 metrics={'f1_val': 0.937454814328146, 'auprc': 0.9577438167061183, 'loss_val': 0.288425595309406, 'psi': 0.9455704152793349}-{'f1_val': 0.9416288570627362, 'auprc': 0.9562173976423292, 'loss_val': 0.29438581000661396, 'psi': 0.9474642732945735}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=34 head_norm_before_train=1.770584 (no previous merge yet)
[S5] round=34 local utility u=0.000000 metrics={'f1_val': 0.7006099296049884, 'auprc': 0.9858248030743186, 'loss_val': 0.283592554495941, 'psi': 0.8146958789927206}-{'f1_val': 0.7005120070508268, 'auprc': 0.9905540972881236, 'loss_val': 0.23048760183775477, 'psi': 0.8165288431457456}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=34 head_norm_before_train=1.289309 cos_to_last_merge=0.9392 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.939
[S6] round=34 local utility u=0.000000 metrics={'f1_val': 0.6022187547271061, 'auprc': 0.7981748792783684, 'loss_val': 0.7005529969957542, 'psi': 0.680601204547611}-{'f1_val': 0.9539161772933535, 'auprc': 0.9523692630156282, 'loss_val': 0.16957244587036374, 'psi': 0.9532974115822634}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=34 head_norm_before_train=1.424073 cos_to_last_merge=0.9471 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.947
[S7] round=34 local utility u=0.431272 metrics={'f1_val': 0.6312610825833044, 'auprc': 0.831753531443596, 'loss_val': 0.5301261343341934, 'psi': 0.711458062127421}-{'f1_val': 0.5463883680134491, 'auprc': 0.7983920904690369, 'loss_val': 0.7833495325669353, 'psi': 0.6471898569956842}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] sending update (kind=head size=1806 to 1 peers)
[S8] START round=34 head_norm_before_train=1.915333 cos_to_last_merge=0.9675 (last merge round=16)
[S8] round=34 local utility u=0.050136 metrics={'f1_val': 0.9937768194178856, 'auprc': 0.9896430676315697, 'loss_val': 0.050728192930027644, 'psi': 0.9921233187033593}-{'f1_val': 0.9753373243123729, 'auprc': 0.9997462912555851, 'loss_val': 0.07067273536292866, 'psi': 0.9851009110896578}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] sending update (kind=head size=1804 to 1 peers)
[S9] START round=34 head_norm_before_train=1.514196 cos_to_last_merge=0.9529 (last merge round=16)
[S9] round=34 local utility u=0.005801 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9985557517279073, 'loss_val': 0.03252278625734678, 'psi': 0.9974186077794978}-{'f1_val': 0.9962500947792776, 'auprc': 0.9960411942048388, 'loss_val': 0.03411874677625927, 'psi': 0.9961665345495021}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=34 head_norm_before_train=1.639403 cos_to_last_merge=0.9431 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.943
[S10] round=34 local utility u=0.001162 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9922400300059879, 'loss_val': 0.05202310990954581, 'psi': 0.9937559022279125}-{'f1_val': 0.9932304850534869, 'auprc': 0.9957972014551607, 'loss_val': 0.055803332424914705, 'psi': 0.9942571716141564}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] sending update (kind=head size=1804 to 1 peers)
[S11] START round=34 head_norm_before_train=1.441446 cos_to_last_merge=0.9164 (last merge round=14)
[S11] ⚠️ Model drifted since last merge! cos=0.916
[S11] round=34 local utility u=0.542514 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9939942947045342, 'loss_val': 0.05586139407005355, 'psi': 0.9955259205899674}-{'f1_val': 0.8417846233200402, 'auprc': 0.9934171453805067, 'loss_val': 0.21058295519314577, 'psi': 0.9024376321442269}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=34 head_norm_before_train=1.764209 cos_to_last_merge=0.9697 (last merge round=11)
[S13] round=34 local utility u=0.242592 metrics={'f1_val': 0.6214650001435382, 'auprc': 0.678239343989879, 'loss_val': 0.6628409572825674, 'psi': 0.6441747376820746}-{'f1_val': 0.5722738392018629, 'auprc': 0.7132323268566015, 'loss_val': 0.9578576436357522, 'psi': 0.6286572342637584}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=34 head_norm_before_train=1.882877 cos_to_last_merge=0.9645 (last merge round=13)
[S14] round=34 local utility u=0.000000 metrics={'f1_val': 0.9970007132142444, 'auprc': 0.9970512681502243, 'loss_val': 0.026918237452817063, 'psi': 0.9970209351886363}-{'f1_val': 0.9970007132142444, 'auprc': 0.997225211843719, 'loss_val': 0.026393843461304693, 'psi': 0.9970905126660343}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=34 head_norm_before_train=1.707008 cos_to_last_merge=0.9546 (last merge round=14)
[S15] round=34 local utility u=0.887402 metrics={'f1_val': 0.9284451646013625, 'auprc': 0.9954456910311476, 'loss_val': 0.11669064490773837, 'psi': 0.9552453751732766}-{'f1_val': 0.6975858144641373, 'auprc': 0.9876952743376528, 'loss_val': 0.48308692353442356, 'psi': 0.8136295984135435}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=34 head_norm_before_train=1.536359 cos_to_last_merge=0.8484 (last merge round=11)
[S16] ⚠️ Model drifted since last merge! cos=0.848
[S16] round=34 local utility u=0.231078 metrics={'f1_val': 0.9812470588371902, 'auprc': 0.997561289799934, 'loss_val': 0.08185879862456685, 'psi': 0.9877727512222878}-{'f1_val': 0.932506044842818, 'auprc': 0.9941790470626445, 'loss_val': 0.24142110035616604, 'psi': 0.9571752457307485}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S17] START round=34 head_norm_before_train=1.673369 cos_to_last_merge=0.7884 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.788
[S17] round=34 local utility u=0.000000 metrics={'f1_val': 0.5489175834603655, 'auprc': 0.7421016454153677, 'loss_val': 0.9515474189253589, 'psi': 0.6261912082423664}-{'f1_val': 0.5779289136509334, 'auprc': 0.784263705733786, 'loss_val': 0.8563183521406369, 'psi': 0.6604628304840744}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=35 head_norm_before_train=1.522698 cos_to_last_merge=0.9836 (last merge round=16)
[S2] round=35 local utility u=0.000000 metrics={'f1_val': 0.6582197194373406, 'auprc': 0.7784994875078025, 'loss_val': 0.8565072370009829, 'psi': 0.7063316266655254}-{'f1_val': 0.7050010488724225, 'auprc': 0.7440376348684172, 'loss_val': 0.3690451993098321, 'psi': 0.7206156832708204}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=35 head_norm_before_train=2.015073 (no previous merge yet)
[S3] round=35 local utility u=0.000000 metrics={'f1_val': 0.9252159753259668, 'auprc': 0.9815586327802033, 'loss_val': 0.1173226441757806, 'psi': 0.9477530383076614}-{'f1_val': 0.9420003179661349, 'auprc': 0.9858382266620423, 'loss_val': 0.10414566690689828, 'psi': 0.959535481444498}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=35 head_norm_before_train=1.578059 cos_to_last_merge=0.9706 (last merge round=15)
[S4] round=35 local utility u=0.064396 metrics={'f1_val': 0.953852586707731, 'auprc': 0.9433082596140948, 'loss_val': 0.2147132293502381, 'psi': 0.9496348558702765}-{'f1_val': 0.937454814328146, 'auprc': 0.9577438167061183, 'loss_val': 0.288425595309406, 'psi': 0.9455704152793349}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=35 head_norm_before_train=1.769326 (no previous merge yet)
[S5] round=35 local utility u=0.000000 metrics={'f1_val': 0.7009432789550658, 'auprc': 0.8936529817809215, 'loss_val': 0.3134171493560545, 'psi': 0.7780271600854081}-{'f1_val': 0.7006099296049884, 'auprc': 0.9858248030743186, 'loss_val': 0.283592554495941, 'psi': 0.8146958789927206}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=35 head_norm_before_train=1.307429 cos_to_last_merge=0.9356 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.936
[S6] round=35 local utility u=0.264601 metrics={'f1_val': 0.6774758029696073, 'auprc': 0.80530458053897, 'loss_val': 0.6442828695512358, 'psi': 0.7286073139973523}-{'f1_val': 0.6022187547271061, 'auprc': 0.7981748792783684, 'loss_val': 0.7005529969957542, 'psi': 0.680601204547611}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] START round=35 head_norm_before_train=1.431047 cos_to_last_merge=0.9458 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.946
[S7] round=35 local utility u=0.000000 metrics={'f1_val': 0.5630239389640264, 'auprc': 0.7999784515558466, 'loss_val': 0.7009196898462722, 'psi': 0.6578057440007545}-{'f1_val': 0.6312610825833044, 'auprc': 0.831753531443596, 'loss_val': 0.5301261343341934, 'psi': 0.711458062127421}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=35 head_norm_before_train=1.928518 cos_to_last_merge=0.9671 (last merge round=16)
[S8] round=35 local utility u=0.000000 metrics={'f1_val': 0.918662106458151, 'auprc': 0.9994586894135209, 'loss_val': 0.15545389951961566, 'psi': 0.950980739640299}-{'f1_val': 0.9937768194178856, 'auprc': 0.9896430676315697, 'loss_val': 0.050728192930027644, 'psi': 0.9921233187033593}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=35 head_norm_before_train=1.526719 cos_to_last_merge=0.9511 (last merge round=16)
[S9] round=35 local utility u=0.000000 metrics={'f1_val': 0.980713803842767, 'auprc': 0.9918308789089403, 'loss_val': 0.07390908769789217, 'psi': 0.9851606338692362}-{'f1_val': 0.9966605118138915, 'auprc': 0.9985557517279073, 'loss_val': 0.03252278625734678, 'psi': 0.9974186077794978}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=35 head_norm_before_train=1.663170 cos_to_last_merge=0.9407 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.941
[S10] round=35 local utility u=0.003627 metrics={'f1_val': 0.9936689701867679, 'auprc': 0.9956157449468259, 'loss_val': 0.04831143281942733, 'psi': 0.9944476800907911}-{'f1_val': 0.9947664837091956, 'auprc': 0.9922400300059879, 'loss_val': 0.05202310990954581, 'psi': 0.9937559022279125}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=35 head_norm_before_train=1.463487 cos_to_last_merge=0.9132 (last merge round=14)
[S11] ⚠️ Model drifted since last merge! cos=0.913
[S11] round=35 local utility u=0.000000 metrics={'f1_val': 0.9631627306067694, 'auprc': 0.995607574730448, 'loss_val': 0.06989857003146739, 'psi': 0.9761406682562408}-{'f1_val': 0.9965470045135896, 'auprc': 0.9939942947045342, 'loss_val': 0.05586139407005355, 'psi': 0.9955259205899674}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=35 head_norm_before_train=1.768192 cos_to_last_merge=0.9689 (last merge round=11)
[S13] round=35 local utility u=0.000000 metrics={'f1_val': 0.5723182235312091, 'auprc': 0.7004373696817121, 'loss_val': 0.9510706381999887, 'psi': 0.6235658819914103}-{'f1_val': 0.6214650001435382, 'auprc': 0.678239343989879, 'loss_val': 0.6628409572825674, 'psi': 0.6441747376820746}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=35 head_norm_before_train=1.893747 cos_to_last_merge=0.9638 (last merge round=13)
[S14] round=35 local utility u=0.004739 metrics={'f1_val': 0.9970007132142444, 'auprc': 0.9990725467033496, 'loss_val': 0.023504690133542408, 'psi': 0.9978294466098865}-{'f1_val': 0.9970007132142444, 'auprc': 0.9970512681502243, 'loss_val': 0.026918237452817063, 'psi': 0.9970209351886363}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=35 head_norm_before_train=1.722426 cos_to_last_merge=0.9533 (last merge round=14)
[S15] round=35 local utility u=0.000000 metrics={'f1_val': 0.7793042734087288, 'auprc': 0.9883507595149703, 'loss_val': 0.34898924848467944, 'psi': 0.8629228678512254}-{'f1_val': 0.9284451646013625, 'auprc': 0.9954456910311476, 'loss_val': 0.11669064490773837, 'psi': 0.9552453751732766}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=35 head_norm_before_train=1.551864 cos_to_last_merge=0.8467 (last merge round=11)
[S16] ⚠️ Model drifted since last merge! cos=0.847
[S16] round=35 local utility u=0.039435 metrics={'f1_val': 0.9911657354723618, 'auprc': 0.993961483779513, 'loss_val': 0.05170161266704042, 'psi': 0.9922840347952222}-{'f1_val': 0.9812470588371902, 'auprc': 0.997561289799934, 'loss_val': 0.08185879862456685, 'psi': 0.9877727512222878}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=35 head_norm_before_train=1.693719 cos_to_last_merge=0.7867 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.787
[S17] round=35 local utility u=0.324780 metrics={'f1_val': 0.5876342623929336, 'auprc': 0.8555305034712843, 'loss_val': 0.8745743391086729, 'psi': 0.6947927588242739}-{'f1_val': 0.5489175834603655, 'auprc': 0.7421016454153677, 'loss_val': 0.9515474189253589, 'psi': 0.6261912082423664}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[S2] START round=36 head_norm_before_train=1.531491 cos_to_last_merge=0.9828 (last merge round=16)
[S2] round=36 local utility u=0.000000 metrics={'f1_val': 0.5569637158555948, 'auprc': 0.6014143772703018, 'loss_val': 1.1670414569374805, 'psi': 0.5747439804214776}-{'f1_val': 0.6582197194373406, 'auprc': 0.7784994875078025, 'loss_val': 0.8565072370009829, 'psi': 0.7063316266655254}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=36 head_norm_before_train=2.027098 (no previous merge yet)
[S3] round=36 local utility u=0.000000 metrics={'f1_val': 0.7636235958234454, 'auprc': 0.837158406548537, 'loss_val': 0.475293857580453, 'psi': 0.793037520113482}-{'f1_val': 0.9252159753259668, 'auprc': 0.9815586327802033, 'loss_val': 0.1173226441757806, 'psi': 0.9477530383076614}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=36 head_norm_before_train=1.581174 cos_to_last_merge=0.9697 (last merge round=15)
[S4] round=36 local utility u=0.000000 metrics={'f1_val': 0.9413104057852719, 'auprc': 0.9617161918626699, 'loss_val': 0.21681067309954463, 'psi': 0.9494727202162311}-{'f1_val': 0.953852586707731, 'auprc': 0.9433082596140948, 'loss_val': 0.2147132293502381, 'psi': 0.9496348558702765}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=36 head_norm_before_train=1.767090 (no previous merge yet)
[S5] round=36 local utility u=0.028890 metrics={'f1_val': 0.7007413541402552, 'auprc': 0.9019988185146022, 'loss_val': 0.2794637667092892, 'psi': 0.781244339889994}-{'f1_val': 0.7009432789550658, 'auprc': 0.8936529817809215, 'loss_val': 0.3134171493560545, 'psi': 0.7780271600854081}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=36 head_norm_before_train=1.319965 cos_to_last_merge=0.9332 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.933
[S6] round=36 local utility u=1.000000 metrics={'f1_val': 0.9799984916569872, 'auprc': 0.9596710729064286, 'loss_val': 0.1211760626204077, 'psi': 0.9718675241567637}-{'f1_val': 0.6774758029696073, 'auprc': 0.80530458053897, 'loss_val': 0.6442828695512358, 'psi': 0.7286073139973523}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=36 head_norm_before_train=1.440563 cos_to_last_merge=0.9440 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.944
[S7] round=36 local utility u=0.379587 metrics={'f1_val': 0.6383163015024628, 'auprc': 0.8322401226999507, 'loss_val': 0.4902845962087711, 'psi': 0.715885829981458}-{'f1_val': 0.5630239389640264, 'auprc': 0.7999784515558466, 'loss_val': 0.7009196898462722, 'psi': 0.6578057440007545}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=36 head_norm_before_train=1.940747 cos_to_last_merge=0.9664 (last merge round=16)
[S8] round=36 local utility u=0.000000 metrics={'f1_val': 0.8080332830023079, 'auprc': 0.9889214544770157, 'loss_val': 0.131067656638971, 'psi': 0.8803885515921911}-{'f1_val': 0.918662106458151, 'auprc': 0.9994586894135209, 'loss_val': 0.15545389951961566, 'psi': 0.950980739640299}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=36 head_norm_before_train=1.538812 cos_to_last_merge=0.9496 (last merge round=16)
[S9] ⚠️ Model drifted since last merge! cos=0.950
[S9] round=36 local utility u=0.078767 metrics={'f1_val': 0.9962461149658858, 'auprc': 0.9989334396494398, 'loss_val': 0.03087625844975746, 'psi': 0.9973210448393074}-{'f1_val': 0.980713803842767, 'auprc': 0.9918308789089403, 'loss_val': 0.07390908769789217, 'psi': 0.9851606338692362}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] sending update (kind=head size=1794 to 1 peers)
[S10] START round=36 head_norm_before_train=1.686622 cos_to_last_merge=0.9385 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.938
[S10] round=36 local utility u=0.000000 metrics={'f1_val': 0.9933667052737687, 'auprc': 0.9957314279554315, 'loss_val': 0.049307347025237876, 'psi': 0.9943125943464337}-{'f1_val': 0.9936689701867679, 'auprc': 0.9956157449468259, 'loss_val': 0.04831143281942733, 'psi': 0.9944476800907911}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=36 head_norm_before_train=1.484016 cos_to_last_merge=0.9100 (last merge round=14)
[S11] ⚠️ Model drifted since last merge! cos=0.910
[S11] round=36 local utility u=0.096799 metrics={'f1_val': 0.993611924360192, 'auprc': 0.994398120107865, 'loss_val': 0.055368171218043126, 'psi': 0.9939264026592611}-{'f1_val': 0.9631627306067694, 'auprc': 0.995607574730448, 'loss_val': 0.06989857003146739, 'psi': 0.9761406682562408}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=36 head_norm_before_train=1.776005 cos_to_last_merge=0.9679 (last merge round=11)
[S13] round=36 local utility u=0.000000 metrics={'f1_val': 0.5721550959692192, 'auprc': 0.7054956056138803, 'loss_val': 0.9763590088727014, 'psi': 0.6254912998270836}-{'f1_val': 0.5723182235312091, 'auprc': 0.7004373696817121, 'loss_val': 0.9510706381999887, 'psi': 0.6235658819914103}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=36 head_norm_before_train=1.902785 cos_to_last_merge=0.9632 (last merge round=13)
[S14] round=36 local utility u=0.000804 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9989701535845873, 'loss_val': 0.021569486322255554, 'psi': 0.997786566328434}-{'f1_val': 0.9970007132142444, 'auprc': 0.9990725467033496, 'loss_val': 0.023504690133542408, 'psi': 0.9978294466098865}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=36 head_norm_before_train=1.734996 cos_to_last_merge=0.9521 (last merge round=14)
[S15] round=36 local utility u=0.803501 metrics={'f1_val': 0.9925656298522604, 'auprc': 0.9961200708559008, 'loss_val': 0.044864121686939415, 'psi': 0.9939874062537166}-{'f1_val': 0.7793042734087288, 'auprc': 0.9883507595149703, 'loss_val': 0.34898924848467944, 'psi': 0.8629228678512254}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] sending update (kind=head size=1793 to 1 peers)
[S16] START round=36 head_norm_before_train=1.566318 cos_to_last_merge=0.8453 (last merge round=11)
[S16] ⚠️ Model drifted since last merge! cos=0.845
[S16] round=36 local utility u=0.000000 metrics={'f1_val': 0.8790125397308639, 'auprc': 0.9902124489014392, 'loss_val': 0.419969642888581, 'psi': 0.923492503399094}-{'f1_val': 0.9911657354723618, 'auprc': 0.993961483779513, 'loss_val': 0.05170161266704042, 'psi': 0.9922840347952222}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=36 head_norm_before_train=1.709896 cos_to_last_merge=0.7853 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.785
[S17] round=36 local utility u=0.000000 metrics={'f1_val': 0.5763297223099983, 'auprc': 0.7801969037836931, 'loss_val': 0.9311803678428093, 'psi': 0.6578765948994763}-{'f1_val': 0.5876342623929336, 'auprc': 0.8555305034712843, 'loss_val': 0.8745743391086729, 'psi': 0.6947927588242739}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=37 head_norm_before_train=1.539797 cos_to_last_merge=0.9821 (last merge round=16)
[S2] round=37 local utility u=1.000000 metrics={'f1_val': 0.7099883180447586, 'auprc': 0.7939360153077948, 'loss_val': 0.5343600506471592, 'psi': 0.7435673969499731}-{'f1_val': 0.5569637158555948, 'auprc': 0.6014143772703018, 'loss_val': 1.1670414569374805, 'psi': 0.5747439804214776}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=37 head_norm_before_train=2.037352 (no previous merge yet)
[S3] round=37 local utility u=0.239094 metrics={'f1_val': 0.8117725127567963, 'auprc': 0.86805972767405, 'loss_val': 0.37870329298426475, 'psi': 0.8342873987236978}-{'f1_val': 0.7636235958234454, 'auprc': 0.837158406548537, 'loss_val': 0.475293857580453, 'psi': 0.793037520113482}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=37 head_norm_before_train=1.584942 cos_to_last_merge=0.9688 (last merge round=15)
[S4] round=37 local utility u=0.000000 metrics={'f1_val': 0.9337069248340591, 'auprc': 0.9609975792527402, 'loss_val': 0.31195851439697664, 'psi': 0.9446231866015316}-{'f1_val': 0.9413104057852719, 'auprc': 0.9617161918626699, 'loss_val': 0.21681067309954463, 'psi': 0.9494727202162311}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=37 head_norm_before_train=1.765315 (no previous merge yet)
[S5] round=37 local utility u=0.000000 metrics={'f1_val': 0.6688010825405635, 'auprc': 0.8671977704873988, 'loss_val': 0.36123910360087286, 'psi': 0.7481597577192975}-{'f1_val': 0.7007413541402552, 'auprc': 0.9019988185146022, 'loss_val': 0.2794637667092892, 'psi': 0.781244339889994}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=37 head_norm_before_train=1.329244 cos_to_last_merge=0.9316 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.932
[S6] round=37 local utility u=0.000000 metrics={'f1_val': 0.5063367766195991, 'auprc': 0.7844600280369948, 'loss_val': 0.9020047517087035, 'psi': 0.6175860771865573}-{'f1_val': 0.9799984916569872, 'auprc': 0.9596710729064286, 'loss_val': 0.1211760626204077, 'psi': 0.9718675241567637}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=37 head_norm_before_train=1.448831 cos_to_last_merge=0.9421 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.942
[S7] round=37 local utility u=0.042600 metrics={'f1_val': 0.6457374788843744, 'auprc': 0.8362240734059831, 'loss_val': 0.46156388693527584, 'psi': 0.7219321166930179}-{'f1_val': 0.6383163015024628, 'auprc': 0.8322401226999507, 'loss_val': 0.4902845962087711, 'psi': 0.715885829981458}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S8] START round=37 head_norm_before_train=1.952835 cos_to_last_merge=0.9661 (last merge round=16)
[S8] round=37 local utility u=0.622882 metrics={'f1_val': 0.994249246104514, 'auprc': 0.999359426420669, 'loss_val': 0.03391244770126312, 'psi': 0.996293318230976}-{'f1_val': 0.8080332830023079, 'auprc': 0.9889214544770157, 'loss_val': 0.131067656638971, 'psi': 0.8803885515921911}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=37 head_norm_before_train=1.550264 cos_to_last_merge=0.9482 (last merge round=16)
[S9] ⚠️ Model drifted since last merge! cos=0.948
[S9] round=37 local utility u=0.000000 metrics={'f1_val': 0.9954158325366191, 'auprc': 0.9993078641313761, 'loss_val': 0.031821980843592286, 'psi': 0.996972645174522}-{'f1_val': 0.9962461149658858, 'auprc': 0.9989334396494398, 'loss_val': 0.03087625844975746, 'psi': 0.9973210448393074}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=37 head_norm_before_train=1.709742 cos_to_last_merge=0.9362 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.936
[S10] round=37 local utility u=0.000000 metrics={'f1_val': 0.9936689701867679, 'auprc': 0.9927737599090813, 'loss_val': 0.04404016127305882, 'psi': 0.9933108860756933}-{'f1_val': 0.9933667052737687, 'auprc': 0.9957314279554315, 'loss_val': 0.049307347025237876, 'psi': 0.9943125943464337}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=37 head_norm_before_train=1.501601 cos_to_last_merge=0.9072 (last merge round=14)
[S11] ⚠️ Model drifted since last merge! cos=0.907
[S11] round=37 local utility u=0.000000 metrics={'f1_val': 0.8491306096734439, 'auprc': 0.9928391951449413, 'loss_val': 0.18985115984323078, 'psi': 0.9066140438620429}-{'f1_val': 0.993611924360192, 'auprc': 0.994398120107865, 'loss_val': 0.055368171218043126, 'psi': 0.9939264026592611}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=37 head_norm_before_train=1.785423 cos_to_last_merge=0.9666 (last merge round=11)
[S13] round=37 local utility u=0.171620 metrics={'f1_val': 0.6108557078031057, 'auprc': 0.6725391004007272, 'loss_val': 0.7664540700669157, 'psi': 0.6355290648421543}-{'f1_val': 0.5721550959692192, 'auprc': 0.7054956056138803, 'loss_val': 0.9763590088727014, 'psi': 0.6254912998270836}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S14] START round=37 head_norm_before_train=1.908872 cos_to_last_merge=0.9633 (last merge round=13)
[S14] round=37 local utility u=0.000000 metrics={'f1_val': 0.9971652929977585, 'auprc': 0.9972353697872502, 'loss_val': 0.022186189069096567, 'psi': 0.9971933237135553}-{'f1_val': 0.9969975081576651, 'auprc': 0.9989701535845873, 'loss_val': 0.021569486322255554, 'psi': 0.997786566328434}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=37 head_norm_before_train=1.748096 cos_to_last_merge=0.9509 (last merge round=14)
[S15] round=37 local utility u=0.000000 metrics={'f1_val': 0.8881500490440154, 'auprc': 0.9906905930780198, 'loss_val': 0.20098375819583175, 'psi': 0.929166266657617}-{'f1_val': 0.9925656298522604, 'auprc': 0.9961200708559008, 'loss_val': 0.044864121686939415, 'psi': 0.9939874062537166}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=37 head_norm_before_train=1.578979 cos_to_last_merge=0.8440 (last merge round=11)
[S16] ⚠️ Model drifted since last merge! cos=0.844
[S16] round=37 local utility u=0.522982 metrics={'f1_val': 0.9892737135469275, 'auprc': 0.9974236727273469, 'loss_val': 0.057207181746512806, 'psi': 0.9925336972190952}-{'f1_val': 0.8790125397308639, 'auprc': 0.9902124489014392, 'loss_val': 0.419969642888581, 'psi': 0.923492503399094}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] sending update (kind=head size=1804 to 1 peers)
[S17] START round=37 head_norm_before_train=1.721859 cos_to_last_merge=0.7845 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.784
[S17] round=37 local utility u=0.000000 metrics={'f1_val': 0.5522854129254052, 'auprc': 0.7641078927752015, 'loss_val': 1.0067403407489084, 'psi': 0.6370144048653237}-{'f1_val': 0.5763297223099983, 'auprc': 0.7801969037836931, 'loss_val': 0.9311803678428093, 'psi': 0.6578765948994763}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=38 head_norm_before_train=1.548394 cos_to_last_merge=0.9813 (last merge round=16)
[S2] round=38 local utility u=0.000000 metrics={'f1_val': 0.7094063070790732, 'auprc': 0.7897161279037322, 'loss_val': 0.5673469777645073, 'psi': 0.7415302354089368}-{'f1_val': 0.7099883180447586, 'auprc': 0.7939360153077948, 'loss_val': 0.5343600506471592, 'psi': 0.7435673969499731}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=38 head_norm_before_train=2.047734 (no previous merge yet)
[S3] round=38 local utility u=0.289094 metrics={'f1_val': 0.8466001566489472, 'auprc': 0.9565402866571369, 'loss_val': 0.2749224406370907, 'psi': 0.8905762086522231}-{'f1_val': 0.8117725127567963, 'auprc': 0.86805972767405, 'loss_val': 0.37870329298426475, 'psi': 0.8342873987236978}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=38 head_norm_before_train=1.589454 cos_to_last_merge=0.9680 (last merge round=15)
[S4] round=38 local utility u=0.079691 metrics={'f1_val': 0.9450160375581337, 'auprc': 0.9629882673726802, 'loss_val': 0.22640407604849302, 'psi': 0.9522049294839523}-{'f1_val': 0.9337069248340591, 'auprc': 0.9609975792527402, 'loss_val': 0.31195851439697664, 'psi': 0.9446231866015316}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S4] sending update (kind=head size=1806 to 1 peers)
[S5] START round=38 head_norm_before_train=1.767897 (no previous merge yet)
[S5] round=38 local utility u=0.342416 metrics={'f1_val': 0.7007413541402552, 'auprc': 0.9841541062065738, 'loss_val': 0.21891836779859025, 'psi': 0.8141064549667827}-{'f1_val': 0.6688010825405635, 'auprc': 0.8671977704873988, 'loss_val': 0.36123910360087286, 'psi': 0.7481597577192975}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] START round=38 head_norm_before_train=1.335398 cos_to_last_merge=0.9302 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.930
[S6] round=38 local utility u=1.000000 metrics={'f1_val': 0.9597138973472144, 'auprc': 0.9636378305395645, 'loss_val': 0.1867415497149739, 'psi': 0.9612834706241544}-{'f1_val': 0.5063367766195991, 'auprc': 0.7844600280369948, 'loss_val': 0.9020047517087035, 'psi': 0.6175860771865573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=38 head_norm_before_train=1.454615 cos_to_last_merge=0.9406 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.941
[S7] round=38 local utility u=0.132403 metrics={'f1_val': 0.6701691917773083, 'auprc': 0.8570169065770314, 'loss_val': 0.40572723131589705, 'psi': 0.7449082776971976}-{'f1_val': 0.6457374788843744, 'auprc': 0.8362240734059831, 'loss_val': 0.46156388693527584, 'psi': 0.7219321166930179}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] sending update (kind=head size=1797 to 1 peers)
[S8] START round=38 head_norm_before_train=1.961588 cos_to_last_merge=0.9660 (last merge round=16)
[S8] round=38 local utility u=0.001020 metrics={'f1_val': 0.9935325668363719, 'auprc': 0.9996713326029927, 'loss_val': 0.028507140217004814, 'psi': 0.9959880731430202}-{'f1_val': 0.994249246104514, 'auprc': 0.999359426420669, 'loss_val': 0.03391244770126312, 'psi': 0.996293318230976}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S8] sending update (kind=head size=1806 to 1 peers)
[S9] START round=38 head_norm_before_train=1.560352 cos_to_last_merge=0.9474 (last merge round=16)
[S9] ⚠️ Model drifted since last merge! cos=0.947
[S9] round=38 local utility u=0.000000 metrics={'f1_val': 0.9905518720143266, 'auprc': 0.9985380272015965, 'loss_val': 0.04038626664240673, 'psi': 0.9937463340892345}-{'f1_val': 0.9954158325366191, 'auprc': 0.9993078641313761, 'loss_val': 0.031821980843592286, 'psi': 0.996972645174522}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=38 head_norm_before_train=1.727962 cos_to_last_merge=0.9346 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.935
[S10] round=38 local utility u=0.000000 metrics={'f1_val': 0.9929696616913117, 'auprc': 0.992570231470017, 'loss_val': 0.04369853757555454, 'psi': 0.9928098896027939}-{'f1_val': 0.9936689701867679, 'auprc': 0.9927737599090813, 'loss_val': 0.04404016127305882, 'psi': 0.9933108860756933}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=38 head_norm_before_train=1.517941 cos_to_last_merge=0.9047 (last merge round=14)
[S11] ⚠️ Model drifted since last merge! cos=0.905
[S11] round=38 local utility u=0.502002 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9938939180377048, 'loss_val': 0.07102921373836243, 'psi': 0.9952377721630675}-{'f1_val': 0.8491306096734439, 'auprc': 0.9928391951449413, 'loss_val': 0.18985115984323078, 'psi': 0.9066140438620429}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=38 head_norm_before_train=1.793251 cos_to_last_merge=0.9648 (last merge round=11)
[S13] round=38 local utility u=0.012387 metrics={'f1_val': 0.612270712760348, 'auprc': 0.6708088367077468, 'loss_val': 0.7449790488128166, 'psi': 0.6356859623393074}-{'f1_val': 0.6108557078031057, 'auprc': 0.6725391004007272, 'loss_val': 0.7664540700669157, 'psi': 0.6355290648421543}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=38 head_norm_before_train=1.916819 cos_to_last_merge=0.9630 (last merge round=13)
[S14] round=38 local utility u=0.001503 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.9972002285146764, 'loss_val': 0.023000877923915822, 'psi': 0.9975718021862016}-{'f1_val': 0.9971652929977585, 'auprc': 0.9972353697872502, 'loss_val': 0.022186189069096567, 'psi': 0.9971933237135553}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=38 head_norm_before_train=1.760601 cos_to_last_merge=0.9497 (last merge round=14)
[S15] ⚠️ Model drifted since last merge! cos=0.950
[S15] round=38 local utility u=0.030831 metrics={'f1_val': 0.8974054368367941, 'auprc': 0.9951475033747427, 'loss_val': 0.20822541464496958, 'psi': 0.9365022634519735}-{'f1_val': 0.8881500490440154, 'auprc': 0.9906905930780198, 'loss_val': 0.20098375819583175, 'psi': 0.929166266657617}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] sending update (kind=head size=1794 to 1 peers)
[S16] START round=38 head_norm_before_train=1.590997 cos_to_last_merge=0.8428 (last merge round=11)
[S16] ⚠️ Model drifted since last merge! cos=0.843
[S16] round=38 local utility u=0.000000 metrics={'f1_val': 0.959258904533075, 'auprc': 0.9974173177838266, 'loss_val': 0.10728212469059077, 'psi': 0.9745222698333756}-{'f1_val': 0.9892737135469275, 'auprc': 0.9974236727273469, 'loss_val': 0.057207181746512806, 'psi': 0.9925336972190952}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=38 head_norm_before_train=1.733990 cos_to_last_merge=0.7835 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.784
[S17] round=38 local utility u=0.434483 metrics={'f1_val': 0.6103581880270053, 'auprc': 0.9012376818295, 'loss_val': 0.8976005645689922, 'psi': 0.7267099855480033}-{'f1_val': 0.5522854129254052, 'auprc': 0.7641078927752015, 'loss_val': 1.0067403407489084, 'psi': 0.6370144048653237}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=39 head_norm_before_train=1.559135 cos_to_last_merge=0.9803 (last merge round=16)
[S2] round=39 local utility u=0.000000 metrics={'f1_val': 0.6039467281395537, 'auprc': 0.7387516047598706, 'loss_val': 0.915618930194048, 'psi': 0.6578686787876805}-{'f1_val': 0.7094063070790732, 'auprc': 0.7897161279037322, 'loss_val': 0.5673469777645073, 'psi': 0.7415302354089368}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=40 psi=0.658 u=0.0000 p_local=0.1475 f1=0.604 auprc=0.739 bytes=37715
[S3] START round=39 head_norm_before_train=2.058414 (no previous merge yet)
[S3] round=39 local utility u=0.306380 metrics={'f1_val': 0.911855950628589, 'auprc': 0.991684207185307, 'loss_val': 0.15912872035054249, 'psi': 0.9437872532512762}-{'f1_val': 0.8466001566489472, 'auprc': 0.9565402866571369, 'loss_val': 0.2749224406370907, 'psi': 0.8905762086522231}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S3] r=40 psi=0.944 u=0.3064 p_local=0.2083 f1=0.912 auprc=0.992 bytes=52261
[S4] START round=39 head_norm_before_train=1.593716 cos_to_last_merge=0.9676 (last merge round=15)
[S4] round=39 local utility u=0.025015 metrics={'f1_val': 0.9507477749487274, 'auprc': 0.9632914749616146, 'loss_val': 0.21167460865386553, 'psi': 0.9557652549538822}-{'f1_val': 0.9450160375581337, 'auprc': 0.9629882673726802, 'loss_val': 0.22640407604849302, 'psi': 0.9522049294839523}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S4] r=40 psi=0.956 u=0.0250 p_local=0.0349 f1=0.951 auprc=0.963 bytes=48624
[S5] START round=39 head_norm_before_train=1.770397 (no previous merge yet)
[S5] round=39 local utility u=0.000000 metrics={'f1_val': 0.7006536512124258, 'auprc': 0.8538482327939203, 'loss_val': 0.42826265976857947, 'psi': 0.7619314838450236}-{'f1_val': 0.7007413541402552, 'auprc': 0.9841541062065738, 'loss_val': 0.21891836779859025, 'psi': 0.8141064549667827}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=40 psi=0.762 u=0.0000 p_local=0.1307 f1=0.701 auprc=0.854 bytes=44856
[S6] START round=39 head_norm_before_train=1.341125 cos_to_last_merge=0.9290 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.929
[S6] round=39 local utility u=0.000000 metrics={'f1_val': 0.6739551187503585, 'auprc': 0.820008214675681, 'loss_val': 0.7147004513830126, 'psi': 0.7323763571204875}-{'f1_val': 0.9597138973472144, 'auprc': 0.9636378305395645, 'loss_val': 0.1867415497149739, 'psi': 0.9612834706241544}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=40 psi=0.732 u=0.0000 p_local=0.4109 f1=0.674 auprc=0.820 bytes=37730
[S7] START round=39 head_norm_before_train=1.458534 cos_to_last_merge=0.9398 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.940
[S7] round=39 local utility u=0.000000 metrics={'f1_val': 0.6513515138450411, 'auprc': 0.8361257467783708, 'loss_val': 0.4483176360684326, 'psi': 0.725261207018373}-{'f1_val': 0.6701691917773083, 'auprc': 0.8570169065770314, 'loss_val': 0.40572723131589705, 'psi': 0.7449082776971976}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] r=40 psi=0.725 u=0.0000 p_local=0.1736 f1=0.651 auprc=0.836 bytes=41398
[S8] START round=39 head_norm_before_train=1.969385 cos_to_last_merge=0.9658 (last merge round=16)
[S8] round=39 local utility u=0.001257 metrics={'f1_val': 0.9938980864455479, 'auprc': 0.9997431466644764, 'loss_val': 0.028402284825593538, 'psi': 0.9962361105331192}-{'f1_val': 0.9935325668363719, 'auprc': 0.9996713326029927, 'loss_val': 0.028507140217004814, 'psi': 0.9959880731430202}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S8] r=40 psi=0.996 u=0.0013 p_local=0.1415 f1=0.994 auprc=1.000 bytes=44978
[S9] START round=39 head_norm_before_train=1.570480 cos_to_last_merge=0.9464 (last merge round=16)
[S9] ⚠️ Model drifted since last merge! cos=0.946
[S9] round=39 local utility u=0.018657 metrics={'f1_val': 0.9951655063899485, 'auprc': 0.9981912753684383, 'loss_val': 0.029713465378138904, 'psi': 0.9963758139813443}-{'f1_val': 0.9905518720143266, 'auprc': 0.9985380272015965, 'loss_val': 0.04038626664240673, 'psi': 0.9937463340892345}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S9] r=40 psi=0.996 u=0.0187 p_local=0.0153 f1=0.995 auprc=0.998 bytes=48484
[S10] START round=39 head_norm_before_train=1.739711 cos_to_last_merge=0.9338 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.934
[S10] round=39 local utility u=0.000000 metrics={'f1_val': 0.9924914830162053, 'auprc': 0.9959748229393063, 'loss_val': 0.053548568871174915, 'psi': 0.9938848189854457}-{'f1_val': 0.9929696616913117, 'auprc': 0.992570231470017, 'loss_val': 0.04369853757555454, 'psi': 0.9928098896027939}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] r=40 psi=0.994 u=0.0000 p_local=0.0093 f1=0.992 auprc=0.996 bytes=41380
[S11] START round=39 head_norm_before_train=1.535288 cos_to_last_merge=0.9022 (last merge round=14)
[S11] ⚠️ Model drifted since last merge! cos=0.902
[S11] round=39 local utility u=0.015987 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9942528453010222, 'loss_val': 0.040132202143622175, 'psi': 0.9953813430683944}-{'f1_val': 0.9961336749133093, 'auprc': 0.9938939180377048, 'loss_val': 0.07102921373836243, 'psi': 0.9952377721630675}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S11] r=40 psi=0.995 u=0.0160 p_local=0.1402 f1=0.996 auprc=0.994 bytes=52137
[S13] START round=39 head_norm_before_train=1.798102 cos_to_last_merge=0.9637 (last merge round=11)
[S13] round=39 local utility u=0.000000 metrics={'f1_val': 0.5826979045824863, 'auprc': 0.689031288355413, 'loss_val': 0.8837307638305568, 'psi': 0.625231258091657}-{'f1_val': 0.612270712760348, 'auprc': 0.6708088367077468, 'loss_val': 0.7449790488128166, 'psi': 0.6356859623393074}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=40 psi=0.625 u=0.0000 p_local=0.0527 f1=0.583 auprc=0.689 bytes=39574
[S14] START round=39 head_norm_before_train=1.922836 cos_to_last_merge=0.9626 (last merge round=13)
[S14] round=39 local utility u=0.000000 metrics={'f1_val': 0.9965760575063591, 'auprc': 0.9972628936531509, 'loss_val': 0.02349128653247028, 'psi': 0.9968507919650758}-{'f1_val': 0.9978195179672185, 'auprc': 0.9972002285146764, 'loss_val': 0.023000877923915822, 'psi': 0.9975718021862016}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=40 psi=0.997 u=0.0000 p_local=0.0069 f1=0.997 auprc=0.997 bytes=50386
[S15] START round=39 head_norm_before_train=1.770506 cos_to_last_merge=0.9490 (last merge round=14)
[S15] ⚠️ Model drifted since last merge! cos=0.949
[S15] round=39 local utility u=0.355824 metrics={'f1_val': 0.991688730169527, 'auprc': 0.9961146650377721, 'loss_val': 0.06517941332590842, 'psi': 0.993459104116825}-{'f1_val': 0.8974054368367941, 'auprc': 0.9951475033747427, 'loss_val': 0.20822541464496958, 'psi': 0.9365022634519735}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S15] sending update (kind=head size=1787 to 1 peers)
[S15] r=40 psi=0.993 u=0.3558 p_local=0.2494 f1=0.992 auprc=0.996 bytes=44803
[S16] START round=39 head_norm_before_train=1.603828 cos_to_last_merge=0.8414 (last merge round=11)
[S16] ⚠️ Model drifted since last merge! cos=0.841
[S16] round=39 local utility u=0.000000 metrics={'f1_val': 0.8768039191241275, 'auprc': 0.9887508928555224, 'loss_val': 0.3802993580908227, 'psi': 0.9215827086166855}-{'f1_val': 0.959258904533075, 'auprc': 0.9974173177838266, 'loss_val': 0.10728212469059077, 'psi': 0.9745222698333756}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] r=40 psi=0.922 u=0.0000 p_local=0.1050 f1=0.877 auprc=0.989 bytes=39548
[S17] START round=39 head_norm_before_train=1.749081 cos_to_last_merge=0.7823 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.782
[S17] round=39 local utility u=0.057951 metrics={'f1_val': 0.6138631467925777, 'auprc': 0.9451458081771048, 'loss_val': 0.9344523866880895, 'psi': 0.7463762113463885}-{'f1_val': 0.6103581880270053, 'auprc': 0.9012376818295, 'loss_val': 0.8976005645689922, 'psi': 0.7267099855480033}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S17] r=40 psi=0.746 u=0.0580 p_local=0.1316 f1=0.614 auprc=0.945 bytes=35984
[S2] START round=40 head_norm_before_train=1.571668 cos_to_last_merge=0.9790 (last merge round=16)
[S2] round=40 local utility u=0.513844 metrics={'f1_val': 0.7009125083341353, 'auprc': 0.784125268305845, 'loss_val': 0.6058474923131283, 'psi': 0.7341976123228191}-{'f1_val': 0.6039467281395537, 'auprc': 0.7387516047598706, 'loss_val': 0.915618930194048, 'psi': 0.6578686787876805}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=40 head_norm_before_train=2.068194 (no previous merge yet)
[S3] round=40 local utility u=0.000000 metrics={'f1_val': 0.7196151649998194, 'auprc': 0.9144428600251227, 'loss_val': 0.6928489452711094, 'psi': 0.7975462430099407}-{'f1_val': 0.911855950628589, 'auprc': 0.991684207185307, 'loss_val': 0.15912872035054249, 'psi': 0.9437872532512762}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=40 head_norm_before_train=1.602377 cos_to_last_merge=0.9662 (last merge round=15)
[S4] round=40 local utility u=0.000000 metrics={'f1_val': 0.9424407671292457, 'auprc': 0.9608504344234674, 'loss_val': 0.21017529094935333, 'psi': 0.9498046340469344}-{'f1_val': 0.9507477749487274, 'auprc': 0.9632914749616146, 'loss_val': 0.21167460865386553, 'psi': 0.9557652549538822}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=40 head_norm_before_train=1.775522 (no previous merge yet)
[S5] round=40 local utility u=1.000000 metrics={'f1_val': 0.9964353361434509, 'auprc': 0.9923364199887126, 'loss_val': 0.11863342482599515, 'psi': 0.9947957696815555}-{'f1_val': 0.7006536512124258, 'auprc': 0.8538482327939203, 'loss_val': 0.42826265976857947, 'psi': 0.7619314838450236}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=40 head_norm_before_train=1.352822 cos_to_last_merge=0.9266 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.927
[S6] round=40 local utility u=0.039945 metrics={'f1_val': 0.6570815109217301, 'auprc': 0.8785212829164695, 'loss_val': 0.7091077660414788, 'psi': 0.7456574197196258}-{'f1_val': 0.6739551187503585, 'auprc': 0.820008214675681, 'loss_val': 0.7147004513830126, 'psi': 0.7323763571204875}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=40 head_norm_before_train=1.463987 cos_to_last_merge=0.9388 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.939
[S7] round=40 local utility u=0.000000 metrics={'f1_val': 0.5748679441385101, 'auprc': 0.7985604119349602, 'loss_val': 0.6783469532029123, 'psi': 0.6643449312570902}-{'f1_val': 0.6513515138450411, 'auprc': 0.8361257467783708, 'loss_val': 0.4483176360684326, 'psi': 0.725261207018373}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=40 head_norm_before_train=1.979754 cos_to_last_merge=0.9651 (last merge round=16)
[S8] round=40 local utility u=0.000000 metrics={'f1_val': 0.9891389744852626, 'auprc': 0.9991933583589757, 'loss_val': 0.03445523176563575, 'psi': 0.9931607280347478}-{'f1_val': 0.9938980864455479, 'auprc': 0.9997431466644764, 'loss_val': 0.028402284825593538, 'psi': 0.9962361105331192}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=40 head_norm_before_train=1.579824 cos_to_last_merge=0.9453 (last merge round=16)
[S9] ⚠️ Model drifted since last merge! cos=0.945
[S9] round=40 local utility u=0.005432 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9981917600991058, 'loss_val': 0.027820465641840774, 'psi': 0.9972730111279772}-{'f1_val': 0.9951655063899485, 'auprc': 0.9981912753684383, 'loss_val': 0.029713465378138904, 'psi': 0.9963758139813443}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] sending update (kind=head size=1803 to 1 peers)
[S10] START round=40 head_norm_before_train=1.752079 cos_to_last_merge=0.9327 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.933
[S10] round=40 local utility u=0.002042 metrics={'f1_val': 0.9929696616913117, 'auprc': 0.9922793281980947, 'loss_val': 0.041246585557298265, 'psi': 0.992693528294025}-{'f1_val': 0.9924914830162053, 'auprc': 0.9959748229393063, 'loss_val': 0.053548568871174915, 'psi': 0.9938848189854457}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=40 head_norm_before_train=1.551502 cos_to_last_merge=0.8999 (last merge round=14)
[S11] ⚠️ Model drifted since last merge! cos=0.900
[S11] round=40 local utility u=0.000644 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9930224709593234, 'loss_val': 0.03763334917171935, 'psi': 0.9951371910918831}-{'f1_val': 0.9961336749133093, 'auprc': 0.9942528453010222, 'loss_val': 0.040132202143622175, 'psi': 0.9953813430683944}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=40 head_norm_before_train=1.804570 cos_to_last_merge=0.9627 (last merge round=11)
[S13] round=40 local utility u=0.049499 metrics={'f1_val': 0.5845523621752483, 'auprc': 0.7305029274342689, 'loss_val': 0.9202739376097716, 'psi': 0.6429325882788566}-{'f1_val': 0.5826979045824863, 'auprc': 0.689031288355413, 'loss_val': 0.8837307638305568, 'psi': 0.625231258091657}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=40 head_norm_before_train=1.929040 cos_to_last_merge=0.9623 (last merge round=13)
[S14] round=40 local utility u=0.006552 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9990279714265726, 'loss_val': 0.02069127608221791, 'psi': 0.9980577851313259}-{'f1_val': 0.9965760575063591, 'auprc': 0.9972628936531509, 'loss_val': 0.02349128653247028, 'psi': 0.9968507919650758}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[S15] START round=40 head_norm_before_train=1.780352 cos_to_last_merge=0.9484 (last merge round=14)
[S15] ⚠️ Model drifted since last merge! cos=0.948
[S15] round=40 local utility u=0.000000 metrics={'f1_val': 0.6968887903990659, 'auprc': 0.8388453759726016, 'loss_val': 0.5699264737098708, 'psi': 0.7536714246284801}-{'f1_val': 0.991688730169527, 'auprc': 0.9961146650377721, 'loss_val': 0.06517941332590842, 'psi': 0.993459104116825}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=40 head_norm_before_train=1.614067 cos_to_last_merge=0.8403 (last merge round=11)
[S16] ⚠️ Model drifted since last merge! cos=0.840
[S16] round=40 local utility u=0.515054 metrics={'f1_val': 0.9917089919190707, 'auprc': 0.9908400054777278, 'loss_val': 0.04589009542589383, 'psi': 0.9913613973425335}-{'f1_val': 0.8768039191241275, 'auprc': 0.9887508928555224, 'loss_val': 0.3802993580908227, 'psi': 0.9215827086166855}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=40 head_norm_before_train=1.761842 cos_to_last_merge=0.7812 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.781
[S17] round=40 local utility u=0.000000 metrics={'f1_val': 0.580232949029675, 'auprc': 0.821357049953559, 'loss_val': 1.094486486292658, 'psi': 0.6766825893992285}-{'f1_val': 0.6138631467925777, 'auprc': 0.9451458081771048, 'loss_val': 0.9344523866880895, 'psi': 0.7463762113463885}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=41 head_norm_before_train=1.584491 cos_to_last_merge=0.9774 (last merge round=16)
[S2] round=41 local utility u=0.000000 metrics={'f1_val': 0.6941371307664947, 'auprc': 0.7695046655142119, 'loss_val': 0.7206038455636261, 'psi': 0.7242841446655817}-{'f1_val': 0.7009125083341353, 'auprc': 0.784125268305845, 'loss_val': 0.6058474923131283, 'psi': 0.7341976123228191}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=41 head_norm_before_train=2.073499 (no previous merge yet)
[S3] round=41 local utility u=1.000000 metrics={'f1_val': 0.9964441752082729, 'auprc': 0.9996839675197898, 'loss_val': 0.029247089899992293, 'psi': 0.9977400921328797}-{'f1_val': 0.7196151649998194, 'auprc': 0.9144428600251227, 'loss_val': 0.6928489452711094, 'psi': 0.7975462430099407}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=41 head_norm_before_train=1.611034 cos_to_last_merge=0.9646 (last merge round=15)
[S4] round=41 local utility u=0.011925 metrics={'f1_val': 0.9462113579846628, 'auprc': 0.9629796141086457, 'loss_val': 0.21533725112175184, 'psi': 0.952918660434256}-{'f1_val': 0.9424407671292457, 'auprc': 0.9608504344234674, 'loss_val': 0.21017529094935333, 'psi': 0.9498046340469344}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=41 head_norm_before_train=1.781575 (no previous merge yet)
[S5] round=41 local utility u=0.000000 metrics={'f1_val': 0.7058963581820821, 'auprc': 0.8183000968778615, 'loss_val': 0.5698093416576606, 'psi': 0.7508578536603938}-{'f1_val': 0.9964353361434509, 'auprc': 0.9923364199887126, 'loss_val': 0.11863342482599515, 'psi': 0.9947957696815555}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=41 head_norm_before_train=1.361887 cos_to_last_merge=0.9251 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.925
[S6] round=41 local utility u=0.806066 metrics={'f1_val': 0.8260898952031599, 'auprc': 0.9607597417456537, 'loss_val': 0.357742045463561, 'psi': 0.8799578338201575}-{'f1_val': 0.6570815109217301, 'auprc': 0.8785212829164695, 'loss_val': 0.7091077660414788, 'psi': 0.7456574197196258}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] sending update (kind=head size=1795 to 1 peers)
[S7] START round=41 head_norm_before_train=1.470990 cos_to_last_merge=0.9375 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.937
[S7] round=41 local utility u=0.000000 metrics={'f1_val': 0.570754234661578, 'auprc': 0.7978401576634577, 'loss_val': 0.7020981745674469, 'psi': 0.66158860386233}-{'f1_val': 0.5748679441385101, 'auprc': 0.7985604119349602, 'loss_val': 0.6783469532029123, 'psi': 0.6643449312570902}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=41 head_norm_before_train=1.991501 cos_to_last_merge=0.9641 (last merge round=16)
[S8] round=41 local utility u=0.016468 metrics={'f1_val': 0.9936536506497753, 'auprc': 0.9996305748131694, 'loss_val': 0.029919689531277986, 'psi': 0.996044420315133}-{'f1_val': 0.9891389744852626, 'auprc': 0.9991933583589757, 'loss_val': 0.03445523176563575, 'psi': 0.9931607280347478}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=41 head_norm_before_train=1.588678 cos_to_last_merge=0.9440 (last merge round=16)
[S9] ⚠️ Model drifted since last merge! cos=0.944
[S9] round=41 local utility u=0.000000 metrics={'f1_val': 0.9947440946163844, 'auprc': 0.9981886147439026, 'loss_val': 0.03013868096211193, 'psi': 0.9961219026673918}-{'f1_val': 0.9966605118138915, 'auprc': 0.9981917600991058, 'loss_val': 0.027820465641840774, 'psi': 0.9972730111279772}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=41 head_norm_before_train=1.765896 cos_to_last_merge=0.9315 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.932
[S10] round=41 local utility u=0.003351 metrics={'f1_val': 0.9929696616913117, 'auprc': 0.9941525090057552, 'loss_val': 0.04016360819601481, 'psi': 0.9934428006170892}-{'f1_val': 0.9929696616913117, 'auprc': 0.9922793281980947, 'loss_val': 0.041246585557298265, 'psi': 0.992693528294025}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S10] sending update (kind=head size=1806 to 1 peers)
[S11] START round=41 head_norm_before_train=1.565642 cos_to_last_merge=0.8976 (last merge round=14)
[S11] ⚠️ Model drifted since last merge! cos=0.898
[S11] round=41 local utility u=0.002904 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.994560105068456, 'loss_val': 0.03643873085300322, 'psi': 0.9957522447355361}-{'f1_val': 0.9965470045135896, 'auprc': 0.9930224709593234, 'loss_val': 0.03763334917171935, 'psi': 0.9951371910918831}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=41 head_norm_before_train=1.815638 cos_to_last_merge=0.9617 (last merge round=11)
[S13] round=41 local utility u=0.000000 metrics={'f1_val': 0.5841405367899672, 'auprc': 0.7260873378163454, 'loss_val': 0.9383247588439564, 'psi': 0.6409192572005185}-{'f1_val': 0.5845523621752483, 'auprc': 0.7305029274342689, 'loss_val': 0.9202739376097716, 'psi': 0.6429325882788566}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=41 head_norm_before_train=1.934735 cos_to_last_merge=0.9619 (last merge round=13)
[S14] round=41 local utility u=0.000000 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9989700026773538, 'loss_val': 0.02119220169540761, 'psi': 0.9980329627719768}-{'f1_val': 0.9974109942678281, 'auprc': 0.9990279714265726, 'loss_val': 0.02069127608221791, 'psi': 0.9980577851313259}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=41 head_norm_before_train=1.791138 cos_to_last_merge=0.9475 (last merge round=14)
[S15] ⚠️ Model drifted since last merge! cos=0.948
[S15] round=41 local utility u=1.000000 metrics={'f1_val': 0.9774149404348504, 'auprc': 0.9952826571536277, 'loss_val': 0.06678152165816262, 'psi': 0.9845620271223613}-{'f1_val': 0.6968887903990659, 'auprc': 0.8388453759726016, 'loss_val': 0.5699264737098708, 'psi': 0.7536714246284801}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=41 head_norm_before_train=1.624275 cos_to_last_merge=0.8391 (last merge round=11)
[S16] ⚠️ Model drifted since last merge! cos=0.839
[S16] round=41 local utility u=0.000000 metrics={'f1_val': 0.8956659114760448, 'auprc': 0.9962598466160003, 'loss_val': 0.3634269204204059, 'psi': 0.935903485532027}-{'f1_val': 0.9917089919190707, 'auprc': 0.9908400054777278, 'loss_val': 0.04589009542589383, 'psi': 0.9913613973425335}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=41 head_norm_before_train=1.774784 cos_to_last_merge=0.7802 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.780
[S17] round=41 local utility u=0.000000 metrics={'f1_val': 0.5518159657054529, 'auprc': 0.7250779718861573, 'loss_val': 1.1869177755255387, 'psi': 0.6211207681777347}-{'f1_val': 0.580232949029675, 'auprc': 0.821357049953559, 'loss_val': 1.094486486292658, 'psi': 0.6766825893992285}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=42 head_norm_before_train=1.596841 cos_to_last_merge=0.9759 (last merge round=16)
[S2] round=42 local utility u=0.000000 metrics={'f1_val': 0.686380146638258, 'auprc': 0.7693723390957132, 'loss_val': 0.7689225786418304, 'psi': 0.7195770236212401}-{'f1_val': 0.6941371307664947, 'auprc': 0.7695046655142119, 'loss_val': 0.7206038455636261, 'psi': 0.7242841446655817}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=42 head_norm_before_train=2.080594 (no previous merge yet)
[S3] round=42 local utility u=0.000000 metrics={'f1_val': 0.836024839294418, 'auprc': 0.9617501251249896, 'loss_val': 0.3279673830117615, 'psi': 0.8863149536266466}-{'f1_val': 0.9964441752082729, 'auprc': 0.9996839675197898, 'loss_val': 0.029247089899992293, 'psi': 0.9977400921328797}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=42 head_norm_before_train=1.620842 cos_to_last_merge=0.9632 (last merge round=15)
[S4] round=42 local utility u=0.000000 metrics={'f1_val': 0.9457756020577077, 'auprc': 0.9629560459712003, 'loss_val': 0.23298315232146652, 'psi': 0.9526477796231048}-{'f1_val': 0.9462113579846628, 'auprc': 0.9629796141086457, 'loss_val': 0.21533725112175184, 'psi': 0.952918660434256}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=42 head_norm_before_train=1.785388 (no previous merge yet)
[S5] round=42 local utility u=0.689203 metrics={'f1_val': 0.7842815509310224, 'auprc': 0.9899816616150738, 'loss_val': 0.1767593469411575, 'psi': 0.8665615952046429}-{'f1_val': 0.7058963581820821, 'auprc': 0.8183000968778615, 'loss_val': 0.5698093416576606, 'psi': 0.7508578536603938}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=42 head_norm_before_train=1.370728 cos_to_last_merge=0.9238 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.924
[S6] round=42 local utility u=0.000000 metrics={'f1_val': 0.5843805349645185, 'auprc': 0.7983542572257268, 'loss_val': 0.8006794757981636, 'psi': 0.6699700238690018}-{'f1_val': 0.8260898952031599, 'auprc': 0.9607597417456537, 'loss_val': 0.357742045463561, 'psi': 0.8799578338201575}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=42 head_norm_before_train=1.478249 cos_to_last_merge=0.9362 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.936
[S7] round=42 local utility u=0.499514 metrics={'f1_val': 0.662989308112481, 'auprc': 0.8459653073598417, 'loss_val': 0.40085688187812496, 'psi': 0.7361797078114253}-{'f1_val': 0.570754234661578, 'auprc': 0.7978401576634577, 'loss_val': 0.7020981745674469, 'psi': 0.66158860386233}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] sending update (kind=head size=1806 to 1 peers)
[S8] START round=42 head_norm_before_train=2.002521 cos_to_last_merge=0.9636 (last merge round=16)
[S8] round=42 local utility u=0.000000 metrics={'f1_val': 0.9839094172069973, 'auprc': 0.9994251721759849, 'loss_val': 0.04434996561370007, 'psi': 0.9901157191945924}-{'f1_val': 0.9936536506497753, 'auprc': 0.9996305748131694, 'loss_val': 0.029919689531277986, 'psi': 0.996044420315133}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=42 head_norm_before_train=1.598295 cos_to_last_merge=0.9428 (last merge round=16)
[S9] ⚠️ Model drifted since last merge! cos=0.943
[S9] round=42 local utility u=0.000000 metrics={'f1_val': 0.9875711251504857, 'auprc': 0.9955964358205893, 'loss_val': 0.05042199899109893, 'psi': 0.9907812494185272}-{'f1_val': 0.9947440946163844, 'auprc': 0.9981886147439026, 'loss_val': 0.03013868096211193, 'psi': 0.9961219026673918}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=42 head_norm_before_train=1.781006 cos_to_last_merge=0.9302 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.930
[S10] round=42 local utility u=0.008130 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9936926110622857, 'loss_val': 0.035833387181472, 'psi': 0.9945897478365391}-{'f1_val': 0.9929696616913117, 'auprc': 0.9941525090057552, 'loss_val': 0.04016360819601481, 'psi': 0.9934428006170892}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=42 head_norm_before_train=1.578904 cos_to_last_merge=0.8956 (last merge round=14)
[S11] ⚠️ Model drifted since last merge! cos=0.896
[S11] round=42 local utility u=0.000836 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.994661999028914, 'loss_val': 0.03507289059271655, 'psi': 0.9957930023197193}-{'f1_val': 0.9965470045135896, 'auprc': 0.994560105068456, 'loss_val': 0.03643873085300322, 'psi': 0.9957522447355361}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=42 head_norm_before_train=1.824121 cos_to_last_merge=0.9610 (last merge round=11)
[S13] round=42 local utility u=0.000000 metrics={'f1_val': 0.5781226302070389, 'auprc': 0.6894739456499956, 'loss_val': 0.9636077985797236, 'psi': 0.6226631563842215}-{'f1_val': 0.5841405367899672, 'auprc': 0.7260873378163454, 'loss_val': 0.9383247588439564, 'psi': 0.6409192572005185}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=42 head_norm_before_train=1.939170 cos_to_last_merge=0.9616 (last merge round=13)
[S14] round=42 local utility u=0.000000 metrics={'f1_val': 0.9949110635196168, 'auprc': 0.9988612010389397, 'loss_val': 0.029217539995477593, 'psi': 0.996491118527346}-{'f1_val': 0.9974082695017256, 'auprc': 0.9989700026773538, 'loss_val': 0.02119220169540761, 'psi': 0.9980329627719768}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=42 head_norm_before_train=1.802973 cos_to_last_merge=0.9464 (last merge round=14)
[S15] ⚠️ Model drifted since last merge! cos=0.946
[S15] round=42 local utility u=0.052111 metrics={'f1_val': 0.992785030910577, 'auprc': 0.9913263915542219, 'loss_val': 0.042911578763990786, 'psi': 0.992201575168035}-{'f1_val': 0.9774149404348504, 'auprc': 0.9952826571536277, 'loss_val': 0.06678152165816262, 'psi': 0.9845620271223613}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] sending update (kind=head size=1793 to 1 peers)
[S16] START round=42 head_norm_before_train=1.634420 cos_to_last_merge=0.8380 (last merge round=11)
[S16] ⚠️ Model drifted since last merge! cos=0.838
[S16] round=42 local utility u=0.000000 metrics={'f1_val': 0.8413685525145014, 'auprc': 0.9948155413737453, 'loss_val': 0.7629163754700186, 'psi': 0.9027473480581989}-{'f1_val': 0.8956659114760448, 'auprc': 0.9962598466160003, 'loss_val': 0.3634269204204059, 'psi': 0.935903485532027}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=42 head_norm_before_train=1.783896 cos_to_last_merge=0.7794 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.779
[S17] round=42 local utility u=0.460284 metrics={'f1_val': 0.6021608621245929, 'auprc': 0.8930205441438784, 'loss_val': 1.072246415385077, 'psi': 0.718504734932307}-{'f1_val': 0.5518159657054529, 'auprc': 0.7250779718861573, 'loss_val': 1.1869177755255387, 'psi': 0.6211207681777347}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[S2] START round=43 head_norm_before_train=1.610489 cos_to_last_merge=0.9742 (last merge round=16)
[S2] round=43 local utility u=0.000000 metrics={'f1_val': 0.5967158553415628, 'auprc': 0.7313247841604273, 'loss_val': 1.2408610577634094, 'psi': 0.6505594268691086}-{'f1_val': 0.686380146638258, 'auprc': 0.7693723390957132, 'loss_val': 0.7689225786418304, 'psi': 0.7195770236212401}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=43 head_norm_before_train=2.089255 (no previous merge yet)
[S3] round=43 local utility u=0.692042 metrics={'f1_val': 0.9972910954329135, 'auprc': 0.9997154332861868, 'loss_val': 0.025376237747848928, 'psi': 0.9982608305742228}-{'f1_val': 0.836024839294418, 'auprc': 0.9617501251249896, 'loss_val': 0.3279673830117615, 'psi': 0.8863149536266466}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] sending update (kind=head size=1805 to 1 peers)
[S4] START round=43 head_norm_before_train=1.630339 cos_to_last_merge=0.9617 (last merge round=15)
[S4] round=43 local utility u=0.000000 metrics={'f1_val': 0.94675758672878, 'auprc': 0.9619036113131691, 'loss_val': 0.2520465994132109, 'psi': 0.9528159965625356}-{'f1_val': 0.9457756020577077, 'auprc': 0.9629560459712003, 'loss_val': 0.23298315232146652, 'psi': 0.9526477796231048}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=43 head_norm_before_train=1.787148 (no previous merge yet)
[S5] round=43 local utility u=0.000000 metrics={'f1_val': 0.7006542225197299, 'auprc': 0.9860477609757692, 'loss_val': 0.3004138105315996, 'psi': 0.8148116379021456}-{'f1_val': 0.7842815509310224, 'auprc': 0.9899816616150738, 'loss_val': 0.1767593469411575, 'psi': 0.8665615952046429}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=43 head_norm_before_train=1.380695 cos_to_last_merge=0.9221 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.922
[S6] round=43 local utility u=0.000000 metrics={'f1_val': 0.5988089704829964, 'auprc': 0.7988127979305053, 'loss_val': 0.9156485034210312, 'psi': 0.6788105014620001}-{'f1_val': 0.5843805349645185, 'auprc': 0.7983542572257268, 'loss_val': 0.8006794757981636, 'psi': 0.6699700238690018}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=43 head_norm_before_train=1.487252 cos_to_last_merge=0.9352 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.935
[S7] round=43 local utility u=0.000000 metrics={'f1_val': 0.56868680825862, 'auprc': 0.7947662125999846, 'loss_val': 0.7077397788500734, 'psi': 0.6591185699951658}-{'f1_val': 0.662989308112481, 'auprc': 0.8459653073598417, 'loss_val': 0.40085688187812496, 'psi': 0.7361797078114253}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=43 head_norm_before_train=2.013757 cos_to_last_merge=0.9626 (last merge round=16)
[S8] round=43 local utility u=0.032270 metrics={'f1_val': 0.9927839159422629, 'auprc': 0.9987649007127584, 'loss_val': 0.031076031994195785, 'psi': 0.9951763098504611}-{'f1_val': 0.9839094172069973, 'auprc': 0.9994251721759849, 'loss_val': 0.04434996561370007, 'psi': 0.9901157191945924}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=43 head_norm_before_train=1.608127 cos_to_last_merge=0.9417 (last merge round=16)
[S9] ⚠️ Model drifted since last merge! cos=0.942
[S9] round=43 local utility u=0.036800 metrics={'f1_val': 0.9947496160742828, 'auprc': 0.9985567120822287, 'loss_val': 0.028772958350242756, 'psi': 0.9962724544774613}-{'f1_val': 0.9875711251504857, 'auprc': 0.9955964358205893, 'loss_val': 0.05042199899109893, 'psi': 0.9907812494185272}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=43 head_norm_before_train=1.796280 cos_to_last_merge=0.9288 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.929
[S10] round=43 local utility u=0.000000 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9919058414747421, 'loss_val': 0.03535263185231184, 'psi': 0.9936222268154142}-{'f1_val': 0.9951878390193748, 'auprc': 0.9936926110622857, 'loss_val': 0.035833387181472, 'psi': 0.9945897478365391}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=43 head_norm_before_train=1.590707 cos_to_last_merge=0.8938 (last merge round=14)
[S11] ⚠️ Model drifted since last merge! cos=0.894
[S11] round=43 local utility u=0.000608 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9946639705639914, 'loss_val': 0.03386218417383188, 'psi': 0.9957937909337503}-{'f1_val': 0.9965470045135896, 'auprc': 0.994661999028914, 'loss_val': 0.03507289059271655, 'psi': 0.9957930023197193}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=43 head_norm_before_train=1.830986 cos_to_last_merge=0.9601 (last merge round=11)
[S13] round=43 local utility u=0.189476 metrics={'f1_val': 0.6138133302910997, 'auprc': 0.673655187089701, 'loss_val': 0.7513428762292653, 'psi': 0.6377500730105403}-{'f1_val': 0.5781226302070389, 'auprc': 0.6894739456499956, 'loss_val': 0.9636077985797236, 'psi': 0.6226631563842215}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=43 head_norm_before_train=1.947289 cos_to_last_merge=0.9611 (last merge round=13)
[S14] round=43 local utility u=0.000000 metrics={'f1_val': 0.9797321483163108, 'auprc': 0.9954279544911984, 'loss_val': 0.046861056311985304, 'psi': 0.9860104707862658}-{'f1_val': 0.9949110635196168, 'auprc': 0.9988612010389397, 'loss_val': 0.029217539995477593, 'psi': 0.996491118527346}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=43 head_norm_before_train=1.815456 cos_to_last_merge=0.9454 (last merge round=14)
[S15] ⚠️ Model drifted since last merge! cos=0.945
[S15] round=43 local utility u=0.000000 metrics={'f1_val': 0.8117902498876927, 'auprc': 0.9922610657874591, 'loss_val': 0.3584650202530207, 'psi': 0.8839785762475992}-{'f1_val': 0.992785030910577, 'auprc': 0.9913263915542219, 'loss_val': 0.042911578763990786, 'psi': 0.992201575168035}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=43 head_norm_before_train=1.643159 cos_to_last_merge=0.8369 (last merge round=11)
[S16] ⚠️ Model drifted since last merge! cos=0.837
[S16] round=43 local utility u=0.152322 metrics={'f1_val': 0.8562393730361283, 'auprc': 0.9962524104040931, 'loss_val': 0.5518080153444196, 'psi': 0.9122445879833142}-{'f1_val': 0.8413685525145014, 'auprc': 0.9948155413737453, 'loss_val': 0.7629163754700186, 'psi': 0.9027473480581989}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=43 head_norm_before_train=1.793526 cos_to_last_merge=0.7786 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.779
[S17] round=43 local utility u=0.170628 metrics={'f1_val': 0.6123637226341311, 'auprc': 0.980326353119336, 'loss_val': 1.0541259196497135, 'psi': 0.759548774828213}-{'f1_val': 0.6021608621245929, 'auprc': 0.8930205441438784, 'loss_val': 1.072246415385077, 'psi': 0.718504734932307}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] START round=44 head_norm_before_train=1.623558 cos_to_last_merge=0.9724 (last merge round=16)
[S2] round=44 local utility u=0.566244 metrics={'f1_val': 0.6998365782475149, 'auprc': 0.7520581412793141, 'loss_val': 0.7892969451302594, 'psi': 0.7207252034602346}-{'f1_val': 0.5967158553415628, 'auprc': 0.7313247841604273, 'loss_val': 1.2408610577634094, 'psi': 0.6505594268691086}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=44 head_norm_before_train=2.098821 (no previous merge yet)
[S3] round=44 local utility u=0.000000 metrics={'f1_val': 0.6640318874265052, 'auprc': 0.9144135730449582, 'loss_val': 0.8453649637920209, 'psi': 0.7641845616738864}-{'f1_val': 0.9972910954329135, 'auprc': 0.9997154332861868, 'loss_val': 0.025376237747848928, 'psi': 0.9982608305742228}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=44 head_norm_before_train=1.640908 cos_to_last_merge=0.9603 (last merge round=15)
[S4] round=44 local utility u=0.008051 metrics={'f1_val': 0.9499018781021558, 'auprc': 0.9639960767442943, 'loss_val': 0.261087153262435, 'psi': 0.9555395575590111}-{'f1_val': 0.94675758672878, 'auprc': 0.9619036113131691, 'loss_val': 0.2520465994132109, 'psi': 0.9528159965625356}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=44 head_norm_before_train=1.788056 (no previous merge yet)
[S5] round=44 local utility u=0.041358 metrics={'f1_val': 0.7009022086989503, 'auprc': 0.9876334587857393, 'loss_val': 0.22394233550543827, 'psi': 0.8155947087336659}-{'f1_val': 0.7006542225197299, 'auprc': 0.9860477609757692, 'loss_val': 0.3004138105315996, 'psi': 0.8148116379021456}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=44 head_norm_before_train=1.394012 cos_to_last_merge=0.9201 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.920
[S6] round=44 local utility u=1.000000 metrics={'f1_val': 0.9757627921122027, 'auprc': 0.9683057091575026, 'loss_val': 0.11135205185657965, 'psi': 0.9727799589303227}-{'f1_val': 0.5988089704829964, 'auprc': 0.7988127979305053, 'loss_val': 0.9156485034210312, 'psi': 0.6788105014620001}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] START round=44 head_norm_before_train=1.494652 cos_to_last_merge=0.9340 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.934
[S7] round=44 local utility u=0.730127 metrics={'f1_val': 0.6911205010060325, 'auprc': 0.9039716546609612, 'loss_val': 0.3097042522635187, 'psi': 0.7762609624680039}-{'f1_val': 0.56868680825862, 'auprc': 0.7947662125999846, 'loss_val': 0.7077397788500734, 'psi': 0.6591185699951658}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=44 head_norm_before_train=2.025939 cos_to_last_merge=0.9619 (last merge round=16)
[S8] round=44 local utility u=0.000000 metrics={'f1_val': 0.9863726826243866, 'auprc': 0.9994006470726804, 'loss_val': 0.038707594405319797, 'psi': 0.9915838684037042}-{'f1_val': 0.9927839159422629, 'auprc': 0.9987649007127584, 'loss_val': 0.031076031994195785, 'psi': 0.9951763098504611}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=44 head_norm_before_train=1.616183 cos_to_last_merge=0.9404 (last merge round=16)
[S9] ⚠️ Model drifted since last merge! cos=0.940
[S9] round=44 local utility u=0.000000 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9938376362319304, 'loss_val': 0.026301806570320555, 'psi': 0.9952851113603387}-{'f1_val': 0.9947496160742828, 'auprc': 0.9985567120822287, 'loss_val': 0.028772958350242756, 'psi': 0.9962724544774613}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=44 head_norm_before_train=1.809514 cos_to_last_merge=0.9276 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.928
[S10] round=44 local utility u=0.005685 metrics={'f1_val': 0.9943096789853013, 'auprc': 0.996093019292134, 'loss_val': 0.03380348093945868, 'psi': 0.9950230151080344}-{'f1_val': 0.9947664837091956, 'auprc': 0.9919058414747421, 'loss_val': 0.03535263185231184, 'psi': 0.9936222268154142}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=44 head_norm_before_train=1.603236 cos_to_last_merge=0.8921 (last merge round=14)
[S11] ⚠️ Model drifted since last merge! cos=0.892
[S11] round=44 local utility u=0.000219 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9944249321623188, 'loss_val': 0.0327077321332213, 'psi': 0.9956981755730813}-{'f1_val': 0.9965470045135896, 'auprc': 0.9946639705639914, 'loss_val': 0.03386218417383188, 'psi': 0.9957937909337503}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=44 head_norm_before_train=1.837167 cos_to_last_merge=0.9593 (last merge round=11)
[S13] round=44 local utility u=0.000000 metrics={'f1_val': 0.5746180924556001, 'auprc': 0.6933273041472646, 'loss_val': 1.0255040671608615, 'psi': 0.6221017771322659}-{'f1_val': 0.6138133302910997, 'auprc': 0.673655187089701, 'loss_val': 0.7513428762292653, 'psi': 0.6377500730105403}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=44 head_norm_before_train=1.955283 cos_to_last_merge=0.9606 (last merge round=13)
[S14] round=44 local utility u=0.072227 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9990762340867332, 'loss_val': 0.019425817988539578, 'psi': 0.9980770901953901}-{'f1_val': 0.9797321483163108, 'auprc': 0.9954279544911984, 'loss_val': 0.046861056311985304, 'psi': 0.9860104707862658}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S14] sending update (kind=head size=1806 to 1 peers)
[S15] START round=44 head_norm_before_train=1.826770 cos_to_last_merge=0.9447 (last merge round=14)
[S15] ⚠️ Model drifted since last merge! cos=0.945
[S15] round=44 local utility u=0.000000 metrics={'f1_val': 0.6998106688528072, 'auprc': 0.9911456131976093, 'loss_val': 0.46403102232085414, 'psi': 0.816344646590728}-{'f1_val': 0.8117902498876927, 'auprc': 0.9922610657874591, 'loss_val': 0.3584650202530207, 'psi': 0.8839785762475992}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=44 head_norm_before_train=1.653078 cos_to_last_merge=0.8359 (last merge round=11)
[S16] ⚠️ Model drifted since last merge! cos=0.836
[S16] round=44 local utility u=0.654806 metrics={'f1_val': 0.9914260686974311, 'auprc': 0.9931766705867949, 'loss_val': 0.04408876627334426, 'psi': 0.9921263094531767}-{'f1_val': 0.8562393730361283, 'auprc': 0.9962524104040931, 'loss_val': 0.5518080153444196, 'psi': 0.9122445879833142}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S17] START round=44 head_norm_before_train=1.806303 cos_to_last_merge=0.7774 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.777
[S17] round=44 local utility u=0.047843 metrics={'f1_val': 0.628957951501522, 'auprc': 0.9741575035730107, 'loss_val': 1.039498354909521, 'psi': 0.7670377723301175}-{'f1_val': 0.6123637226341311, 'auprc': 0.980326353119336, 'loss_val': 1.0541259196497135, 'psi': 0.759548774828213}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] START round=45 head_norm_before_train=1.633408 cos_to_last_merge=0.9710 (last merge round=16)
[S2] round=45 local utility u=0.000000 metrics={'f1_val': 0.7170581998840457, 'auprc': 0.7364184790086492, 'loss_val': 0.8734579981839875, 'psi': 0.7248023115338871}-{'f1_val': 0.6998365782475149, 'auprc': 0.7520581412793141, 'loss_val': 0.7892969451302594, 'psi': 0.7207252034602346}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=45 head_norm_before_train=2.106264 (no previous merge yet)
[S3] round=45 local utility u=0.468135 metrics={'f1_val': 0.7651938231883212, 'auprc': 0.9418760553218861, 'loss_val': 0.5984533035047709, 'psi': 0.8358667160417472}-{'f1_val': 0.6640318874265052, 'auprc': 0.9144135730449582, 'loss_val': 0.8453649637920209, 'psi': 0.7641845616738864}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=45 head_norm_before_train=1.648869 cos_to_last_merge=0.9595 (last merge round=15)
[S4] round=45 local utility u=0.000000 metrics={'f1_val': 0.9499018781021558, 'auprc': 0.9632933813228682, 'loss_val': 0.2672943588585268, 'psi': 0.9552584793904407}-{'f1_val': 0.9499018781021558, 'auprc': 0.9639960767442943, 'loss_val': 0.261087153262435, 'psi': 0.9555395575590111}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=45 head_norm_before_train=1.790213 (no previous merge yet)
[S5] round=45 local utility u=0.433755 metrics={'f1_val': 0.8480952633734178, 'auprc': 0.9784503092889658, 'loss_val': 0.21204214273487085, 'psi': 0.9002372817396369}-{'f1_val': 0.7009022086989503, 'auprc': 0.9876334587857393, 'loss_val': 0.22394233550543827, 'psi': 0.8155947087336659}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=45 head_norm_before_train=1.404748 cos_to_last_merge=0.9184 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.918
[S6] round=45 local utility u=0.000000 metrics={'f1_val': 0.8254080161817682, 'auprc': 0.9560136132380749, 'loss_val': 0.40694906614025694, 'psi': 0.8776502550042908}-{'f1_val': 0.9757627921122027, 'auprc': 0.9683057091575026, 'loss_val': 0.11135205185657965, 'psi': 0.9727799589303227}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=45 head_norm_before_train=1.500783 cos_to_last_merge=0.9329 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.933
[S7] round=45 local utility u=0.000000 metrics={'f1_val': 0.566612146353361, 'auprc': 0.7850671870757919, 'loss_val': 0.7433461831137993, 'psi': 0.6539941626423333}-{'f1_val': 0.6911205010060325, 'auprc': 0.9039716546609612, 'loss_val': 0.3097042522635187, 'psi': 0.7762609624680039}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=45 head_norm_before_train=2.040052 cos_to_last_merge=0.9604 (last merge round=16)
[S8] round=45 local utility u=0.021044 metrics={'f1_val': 0.9917243555205874, 'auprc': 0.9995269043811313, 'loss_val': 0.029109008072078942, 'psi': 0.994845375064805}-{'f1_val': 0.9863726826243866, 'auprc': 0.9994006470726804, 'loss_val': 0.038707594405319797, 'psi': 0.9915838684037042}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=45 head_norm_before_train=1.623771 cos_to_last_merge=0.9392 (last merge round=16)
[S9] ⚠️ Model drifted since last merge! cos=0.939
[S9] round=45 local utility u=0.000000 metrics={'f1_val': 0.9920653202133933, 'auprc': 0.9985501034483674, 'loss_val': 0.03479849399490867, 'psi': 0.994659233507383}-{'f1_val': 0.9962500947792776, 'auprc': 0.9938376362319304, 'loss_val': 0.026301806570320555, 'psi': 0.9952851113603387}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=45 head_norm_before_train=1.821189 cos_to_last_merge=0.9265 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.927
[S10] round=45 local utility u=0.000000 metrics={'f1_val': 0.9943510225075977, 'auprc': 0.9920512567604206, 'loss_val': 0.033590782887131555, 'psi': 0.9934311162087268}-{'f1_val': 0.9943096789853013, 'auprc': 0.996093019292134, 'loss_val': 0.03380348093945868, 'psi': 0.9950230151080344}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=45 head_norm_before_train=1.616220 cos_to_last_merge=0.8904 (last merge round=14)
[S11] ⚠️ Model drifted since last merge! cos=0.890
[S11] round=45 local utility u=0.000259 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9942961603534137, 'loss_val': 0.03180307391692316, 'psi': 0.9956466668495192}-{'f1_val': 0.9965470045135896, 'auprc': 0.9944249321623188, 'loss_val': 0.0327077321332213, 'psi': 0.9956981755730813}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=45 head_norm_before_train=1.842891 cos_to_last_merge=0.9587 (last merge round=11)
[S13] round=45 local utility u=0.141278 metrics={'f1_val': 0.6052470521322346, 'auprc': 0.6820750718820828, 'loss_val': 0.8929646037012162, 'psi': 0.635978260032174}-{'f1_val': 0.5746180924556001, 'auprc': 0.6933273041472646, 'loss_val': 1.0255040671608615, 'psi': 0.6221017771322659}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=45 head_norm_before_train=1.963147 cos_to_last_merge=0.9600 (last merge round=13)
[S14] round=45 local utility u=0.000328 metrics={'f1_val': 0.9976319732898762, 'auprc': 0.9986121708530126, 'loss_val': 0.01870445163972045, 'psi': 0.9980240523151308}-{'f1_val': 0.9974109942678281, 'auprc': 0.9990762340867332, 'loss_val': 0.019425817988539578, 'psi': 0.9980770901953901}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=45 head_norm_before_train=1.836332 cos_to_last_merge=0.9440 (last merge round=14)
[S15] ⚠️ Model drifted since last merge! cos=0.944
[S15] round=45 local utility u=0.391936 metrics={'f1_val': 0.8135637421669116, 'auprc': 0.9925923768311735, 'loss_val': 0.3670175683644115, 'psi': 0.8851751960326164}-{'f1_val': 0.6998106688528072, 'auprc': 0.9911456131976093, 'loss_val': 0.46403102232085414, 'psi': 0.816344646590728}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=45 head_norm_before_train=1.661557 cos_to_last_merge=0.8350 (last merge round=11)
[S16] ⚠️ Model drifted since last merge! cos=0.835
[S16] round=45 local utility u=0.005131 metrics={'f1_val': 0.992802230401369, 'auprc': 0.9919048946981163, 'loss_val': 0.03826865974546636, 'psi': 0.9924432961200679}-{'f1_val': 0.9914260686974311, 'auprc': 0.9931766705867949, 'loss_val': 0.04408876627334426, 'psi': 0.9921263094531767}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] sending update (kind=head size=1805 to 1 peers)
[S17] START round=45 head_norm_before_train=1.818564 cos_to_last_merge=0.7763 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.776
[S17] round=45 local utility u=0.000000 metrics={'f1_val': 0.590397664735595, 'auprc': 0.822309657838998, 'loss_val': 1.2082028512583474, 'psi': 0.6831624619769562}-{'f1_val': 0.628957951501522, 'auprc': 0.9741575035730107, 'loss_val': 1.039498354909521, 'psi': 0.7670377723301175}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=46 head_norm_before_train=1.642030 cos_to_last_merge=0.9698 (last merge round=16)
[S2] round=46 local utility u=0.000000 metrics={'f1_val': 0.6997656430905879, 'auprc': 0.7462148514634723, 'loss_val': 0.8236320156302551, 'psi': 0.7183453264397417}-{'f1_val': 0.7170581998840457, 'auprc': 0.7364184790086492, 'loss_val': 0.8734579981839875, 'psi': 0.7248023115338871}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=46 head_norm_before_train=2.112644 (no previous merge yet)
[S3] round=46 local utility u=1.000000 metrics={'f1_val': 0.9983824998017676, 'auprc': 0.9996659022639529, 'loss_val': 0.020507490453542186, 'psi': 0.9988958607866418}-{'f1_val': 0.7651938231883212, 'auprc': 0.9418760553218861, 'loss_val': 0.5984533035047709, 'psi': 0.8358667160417472}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=46 head_norm_before_train=1.655093 cos_to_last_merge=0.9586 (last merge round=15)
[S4] round=46 local utility u=0.002890 metrics={'f1_val': 0.9531059802862236, 'auprc': 0.9592708053120789, 'loss_val': 0.2686706199556874, 'psi': 0.9555719102965656}-{'f1_val': 0.9499018781021558, 'auprc': 0.9632933813228682, 'loss_val': 0.2672943588585268, 'psi': 0.9552584793904407}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=46 head_norm_before_train=1.793005 (no previous merge yet)
[S5] round=46 local utility u=0.127780 metrics={'f1_val': 0.889887331306843, 'auprc': 0.9805487272314202, 'loss_val': 0.21352983265176367, 'psi': 0.9261518896766738}-{'f1_val': 0.8480952633734178, 'auprc': 0.9784503092889658, 'loss_val': 0.21204214273487085, 'psi': 0.9002372817396369}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=46 head_norm_before_train=1.415634 cos_to_last_merge=0.9150 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.915
[S6] round=46 local utility u=0.000000 metrics={'f1_val': 0.7119803555723768, 'auprc': 0.8219630103122304, 'loss_val': 0.7209268198880805, 'psi': 0.7559734174683184}-{'f1_val': 0.8254080161817682, 'auprc': 0.9560136132380749, 'loss_val': 0.40694906614025694, 'psi': 0.8776502550042908}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=46 head_norm_before_train=1.504066 cos_to_last_merge=0.9321 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.932
[S7] round=46 local utility u=0.775796 metrics={'f1_val': 0.6933525008950194, 'auprc': 0.9040610687322925, 'loss_val': 0.3091775946982913, 'psi': 0.7776359280299286}-{'f1_val': 0.566612146353361, 'auprc': 0.7850671870757919, 'loss_val': 0.7433461831137993, 'psi': 0.6539941626423333}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S8] START round=46 head_norm_before_train=2.053419 cos_to_last_merge=0.9593 (last merge round=16)
[S8] round=46 local utility u=0.000980 metrics={'f1_val': 0.9922049056737585, 'auprc': 0.9994954988698871, 'loss_val': 0.029938057494156678, 'psi': 0.99512114295221}-{'f1_val': 0.9917243555205874, 'auprc': 0.9995269043811313, 'loss_val': 0.029109008072078942, 'psi': 0.994845375064805}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=46 head_norm_before_train=1.631931 cos_to_last_merge=0.9381 (last merge round=16)
[S9] ⚠️ Model drifted since last merge! cos=0.938
[S9] round=46 local utility u=0.000000 metrics={'f1_val': 0.9888602739236441, 'auprc': 0.9981028795831404, 'loss_val': 0.0451638358374492, 'psi': 0.9925573161874426}-{'f1_val': 0.9920653202133933, 'auprc': 0.9985501034483674, 'loss_val': 0.03479849399490867, 'psi': 0.994659233507383}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=46 head_norm_before_train=1.832885 cos_to_last_merge=0.9255 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.926
[S10] round=46 local utility u=0.000189 metrics={'f1_val': 0.9933667052737687, 'auprc': 0.996333567462284, 'loss_val': 0.04015307177685482, 'psi': 0.9945534501491748}-{'f1_val': 0.9943510225075977, 'auprc': 0.9920512567604206, 'loss_val': 0.033590782887131555, 'psi': 0.9934311162087268}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=46 head_norm_before_train=1.628500 cos_to_last_merge=0.8888 (last merge round=14)
[S11] ⚠️ Model drifted since last merge! cos=0.889
[S11] round=46 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9929391022545373, 'loss_val': 0.031321284040408716, 'psi': 0.9948558458498005}-{'f1_val': 0.9965470045135896, 'auprc': 0.9942961603534137, 'loss_val': 0.03180307391692316, 'psi': 0.9956466668495192}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=46 head_norm_before_train=1.850576 cos_to_last_merge=0.9581 (last merge round=11)
[S13] round=46 local utility u=0.000000 metrics={'f1_val': 0.567052529564213, 'auprc': 0.699046406773982, 'loss_val': 1.1630977512642213, 'psi': 0.6198500804481206}-{'f1_val': 0.6052470521322346, 'auprc': 0.6820750718820828, 'loss_val': 0.8929646037012162, 'psi': 0.635978260032174}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=46 head_norm_before_train=1.972574 cos_to_last_merge=0.9593 (last merge round=13)
[S14] round=46 local utility u=0.000000 metrics={'f1_val': 0.9971680177638609, 'auprc': 0.9972301349700642, 'loss_val': 0.02162611551171372, 'psi': 0.9971928646463422}-{'f1_val': 0.9976319732898762, 'auprc': 0.9986121708530126, 'loss_val': 0.01870445163972045, 'psi': 0.9980240523151308}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=46 head_norm_before_train=1.844584 cos_to_last_merge=0.9433 (last merge round=14)
[S15] ⚠️ Model drifted since last merge! cos=0.943
[S15] round=46 local utility u=0.163711 metrics={'f1_val': 0.8723881036957144, 'auprc': 0.9730587847147946, 'loss_val': 0.333941000112307, 'psi': 0.9126563761033464}-{'f1_val': 0.8135637421669116, 'auprc': 0.9925923768311735, 'loss_val': 0.3670175683644115, 'psi': 0.8851751960326164}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=46 head_norm_before_train=1.667539 cos_to_last_merge=0.8342 (last merge round=11)
[S16] ⚠️ Model drifted since last merge! cos=0.834
[S16] round=46 local utility u=0.000000 metrics={'f1_val': 0.992844676947359, 'auprc': 0.9918575559821927, 'loss_val': 0.042442113663390804, 'psi': 0.9924498285612926}-{'f1_val': 0.992802230401369, 'auprc': 0.9919048946981163, 'loss_val': 0.03826865974546636, 'psi': 0.9924432961200679}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=46 head_norm_before_train=1.830635 cos_to_last_merge=0.7754 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.775
[S17] round=46 local utility u=0.000000 metrics={'f1_val': 0.5797964480217148, 'auprc': 0.7625887134506054, 'loss_val': 1.250381651013972, 'psi': 0.652913354193271}-{'f1_val': 0.590397664735595, 'auprc': 0.822309657838998, 'loss_val': 1.2082028512583474, 'psi': 0.6831624619769562}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=47 head_norm_before_train=1.650797 cos_to_last_merge=0.9685 (last merge round=16)
[S2] round=47 local utility u=0.000000 metrics={'f1_val': 0.6922709901262398, 'auprc': 0.7518375862396542, 'loss_val': 0.880422630394145, 'psi': 0.7160976285716056}-{'f1_val': 0.6997656430905879, 'auprc': 0.7462148514634723, 'loss_val': 0.8236320156302551, 'psi': 0.7183453264397417}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=47 head_norm_before_train=2.120633 (no previous merge yet)
[S3] round=47 local utility u=0.000000 metrics={'f1_val': 0.9429136523330395, 'auprc': 0.9890153029622404, 'loss_val': 0.11654207679508709, 'psi': 0.9613543125847199}-{'f1_val': 0.9983824998017676, 'auprc': 0.9996659022639529, 'loss_val': 0.020507490453542186, 'psi': 0.9988958607866418}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=47 head_norm_before_train=1.661014 cos_to_last_merge=0.9574 (last merge round=15)
[S4] round=47 local utility u=0.000000 metrics={'f1_val': 0.9415560990278036, 'auprc': 0.9521129777507562, 'loss_val': 0.28786338223503605, 'psi': 0.9457788505169846}-{'f1_val': 0.9531059802862236, 'auprc': 0.9592708053120789, 'loss_val': 0.2686706199556874, 'psi': 0.9555719102965656}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=47 head_norm_before_train=1.796056 (no previous merge yet)
[S5] round=47 local utility u=0.000000 metrics={'f1_val': 0.7008152523037622, 'auprc': 0.8652264557309357, 'loss_val': 0.36346104036380944, 'psi': 0.7665797336746316}-{'f1_val': 0.889887331306843, 'auprc': 0.9805487272314202, 'loss_val': 0.21352983265176367, 'psi': 0.9261518896766738}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=47 head_norm_before_train=1.428370 cos_to_last_merge=0.9119 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.912
[S6] round=47 local utility u=0.000000 metrics={'f1_val': 0.5279999935568034, 'auprc': 0.7903725769714467, 'loss_val': 1.103486049114616, 'psi': 0.6329490269226608}-{'f1_val': 0.7119803555723768, 'auprc': 0.8219630103122304, 'loss_val': 0.7209268198880805, 'psi': 0.7559734174683184}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=47 head_norm_before_train=1.507309 cos_to_last_merge=0.9314 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.931
[S7] round=47 local utility u=0.000000 metrics={'f1_val': 0.6190029480704372, 'auprc': 0.7993841618345149, 'loss_val': 0.6048460148248301, 'psi': 0.6911554335760683}-{'f1_val': 0.6933525008950194, 'auprc': 0.9040610687322925, 'loss_val': 0.3091775946982913, 'psi': 0.7776359280299286}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=47 head_norm_before_train=2.064394 cos_to_last_merge=0.9587 (last merge round=16)
[S8] round=47 local utility u=0.000000 metrics={'f1_val': 0.9869991501429988, 'auprc': 0.9992769193338393, 'loss_val': 0.036182818528055785, 'psi': 0.991910257819335}-{'f1_val': 0.9922049056737585, 'auprc': 0.9994954988698871, 'loss_val': 0.029938057494156678, 'psi': 0.99512114295221}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=47 head_norm_before_train=1.640343 cos_to_last_merge=0.9371 (last merge round=16)
[S9] ⚠️ Model drifted since last merge! cos=0.937
[S9] round=47 local utility u=0.024650 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9932604202137261, 'loss_val': 0.02567484325677806, 'psi': 0.995054224953057}-{'f1_val': 0.9888602739236441, 'auprc': 0.9981028795831404, 'loss_val': 0.0451638358374492, 'psi': 0.9925573161874426}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] sending update (kind=head size=1794 to 1 peers)
[S10] START round=47 head_norm_before_train=1.843705 cos_to_last_merge=0.9247 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.925
[S10] round=47 local utility u=0.001203 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9931548528821063, 'loss_val': 0.036609713526806247, 'psi': 0.9941218313783599}-{'f1_val': 0.9933667052737687, 'auprc': 0.996333567462284, 'loss_val': 0.04015307177685482, 'psi': 0.9945534501491748}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=47 head_norm_before_train=1.639992 cos_to_last_merge=0.8872 (last merge round=14)
[S11] ⚠️ Model drifted since last merge! cos=0.887
[S11] round=47 local utility u=0.000182 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9928528909571912, 'loss_val': 0.030698744798558476, 'psi': 0.9948213613308621}-{'f1_val': 0.9961336749133093, 'auprc': 0.9929391022545373, 'loss_val': 0.031321284040408716, 'psi': 0.9948558458498005}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=47 head_norm_before_train=1.854197 cos_to_last_merge=0.9574 (last merge round=11)
[S13] round=47 local utility u=0.342948 metrics={'f1_val': 0.6253939009588327, 'auprc': 0.6623834946082798, 'loss_val': 0.7172608647025144, 'psi': 0.6401897384186116}-{'f1_val': 0.567052529564213, 'auprc': 0.699046406773982, 'loss_val': 1.1630977512642213, 'psi': 0.6198500804481206}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] sending update (kind=head size=1806 to 1 peers)
[S14] START round=47 head_norm_before_train=1.980850 cos_to_last_merge=0.9587 (last merge round=13)
[S14] round=47 local utility u=0.000000 metrics={'f1_val': 0.9971680177638609, 'auprc': 0.9968588815278638, 'loss_val': 0.023840021187352817, 'psi': 0.9970443632694621}-{'f1_val': 0.9971680177638609, 'auprc': 0.9972301349700642, 'loss_val': 0.02162611551171372, 'psi': 0.9971928646463422}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=47 head_norm_before_train=1.853675 cos_to_last_merge=0.9424 (last merge round=14)
[S15] ⚠️ Model drifted since last merge! cos=0.942
[S15] round=47 local utility u=0.397525 metrics={'f1_val': 0.9695627273083611, 'auprc': 0.9753037349813987, 'loss_val': 0.12867382931013602, 'psi': 0.9718591303775761}-{'f1_val': 0.8723881036957144, 'auprc': 0.9730587847147946, 'loss_val': 0.333941000112307, 'psi': 0.9126563761033464}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=47 head_norm_before_train=1.675553 cos_to_last_merge=0.8333 (last merge round=11)
[S16] ⚠️ Model drifted since last merge! cos=0.833
[S16] round=47 local utility u=0.000000 metrics={'f1_val': 0.7788293968888069, 'auprc': 0.9259507992319977, 'loss_val': 0.9407171311584129, 'psi': 0.8376779578260832}-{'f1_val': 0.992844676947359, 'auprc': 0.9918575559821927, 'loss_val': 0.042442113663390804, 'psi': 0.9924498285612926}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=47 head_norm_before_train=1.840819 cos_to_last_merge=0.7746 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.775
[S17] round=47 local utility u=0.000000 metrics={'f1_val': 0.5536667457529403, 'auprc': 0.751572876959663, 'loss_val': 1.3581270695720729, 'psi': 0.6328291982356293}-{'f1_val': 0.5797964480217148, 'auprc': 0.7625887134506054, 'loss_val': 1.250381651013972, 'psi': 0.652913354193271}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=48 head_norm_before_train=1.659755 cos_to_last_merge=0.9673 (last merge round=16)
[S2] round=48 local utility u=0.007011 metrics={'f1_val': 0.6934589332441159, 'auprc': 0.7521351327808514, 'loss_val': 0.8744202640350174, 'psi': 0.7169294130588102}-{'f1_val': 0.6922709901262398, 'auprc': 0.7518375862396542, 'loss_val': 0.880422630394145, 'psi': 0.7160976285716056}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=48 head_norm_before_train=2.127450 (no previous merge yet)
[S3] round=48 local utility u=0.140481 metrics={'f1_val': 0.9754508479949865, 'auprc': 0.9975245426811057, 'loss_val': 0.05633032445863483, 'psi': 0.9842803258694341}-{'f1_val': 0.9429136523330395, 'auprc': 0.9890153029622404, 'loss_val': 0.11654207679508709, 'psi': 0.9613543125847199}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] sending update (kind=head size=1805 to 1 peers)
[S4] START round=48 head_norm_before_train=1.669762 cos_to_last_merge=0.9560 (last merge round=15)
[S4] round=48 local utility u=0.005165 metrics={'f1_val': 0.9413559795254743, 'auprc': 0.9576064878268904, 'loss_val': 0.2928132182889739, 'psi': 0.9478561828460408}-{'f1_val': 0.9415560990278036, 'auprc': 0.9521129777507562, 'loss_val': 0.28786338223503605, 'psi': 0.9457788505169846}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=48 head_norm_before_train=1.799508 (no previous merge yet)
[S5] round=48 local utility u=0.691201 metrics={'f1_val': 0.8322048799703601, 'auprc': 0.9904191673653298, 'loss_val': 0.14497561891460287, 'psi': 0.8954905949283479}-{'f1_val': 0.7008152523037622, 'auprc': 0.8652264557309357, 'loss_val': 0.36346104036380944, 'psi': 0.7665797336746316}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S5] sending update (kind=head size=1807 to 1 peers)
[S6] START round=48 head_norm_before_train=1.437894 cos_to_last_merge=0.9094 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.909
[S6] round=48 local utility u=1.000000 metrics={'f1_val': 0.9875549694614034, 'auprc': 0.9594348563086934, 'loss_val': 0.10006986133912883, 'psi': 0.9763069242003194}-{'f1_val': 0.5279999935568034, 'auprc': 0.7903725769714467, 'loss_val': 1.103486049114616, 'psi': 0.6329490269226608}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] sending update (kind=head size=1795 to 1 peers)
[S7] START round=48 head_norm_before_train=1.513775 cos_to_last_merge=0.9302 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.930
[S7] round=48 local utility u=0.000000 metrics={'f1_val': 0.5682319892740175, 'auprc': 0.7941032392497209, 'loss_val': 0.7537097698848286, 'psi': 0.6585804892642989}-{'f1_val': 0.6190029480704372, 'auprc': 0.7993841618345149, 'loss_val': 0.6048460148248301, 'psi': 0.6911554335760683}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=48 head_norm_before_train=2.073823 cos_to_last_merge=0.9580 (last merge round=16)
[S8] round=48 local utility u=0.000000 metrics={'f1_val': 0.9709193637124511, 'auprc': 0.998076608126802, 'loss_val': 0.0650369557155549, 'psi': 0.9817822614781915}-{'f1_val': 0.9869991501429988, 'auprc': 0.9992769193338393, 'loss_val': 0.036182818528055785, 'psi': 0.991910257819335}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=48 head_norm_before_train=1.648444 cos_to_last_merge=0.9361 (last merge round=16)
[S9] ⚠️ Model drifted since last merge! cos=0.936
[S9] round=48 local utility u=0.009470 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.998176555131262, 'loss_val': 0.023944813521372475, 'psi': 0.9972669291408397}-{'f1_val': 0.9962500947792776, 'auprc': 0.9932604202137261, 'loss_val': 0.02567484325677806, 'psi': 0.995054224953057}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=48 head_norm_before_train=1.851096 cos_to_last_merge=0.9241 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.924
[S10] round=48 local utility u=0.000000 metrics={'f1_val': 0.9929696616913117, 'auprc': 0.9926423065576445, 'loss_val': 0.036753841843193726, 'psi': 0.9928387196378449}-{'f1_val': 0.9947664837091956, 'auprc': 0.9931548528821063, 'loss_val': 0.036609713526806247, 'psi': 0.9941218313783599}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=48 head_norm_before_train=1.651277 cos_to_last_merge=0.8858 (last merge round=14)
[S11] ⚠️ Model drifted since last merge! cos=0.886
[S11] round=48 local utility u=0.000959 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9932420890486983, 'loss_val': 0.029947794655732173, 'psi': 0.9949770405674649}-{'f1_val': 0.9961336749133093, 'auprc': 0.9928528909571912, 'loss_val': 0.030698744798558476, 'psi': 0.9948213613308621}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=48 head_norm_before_train=1.854141 cos_to_last_merge=0.9572 (last merge round=11)
[S13] round=48 local utility u=0.000000 metrics={'f1_val': 0.5604373937988361, 'auprc': 0.7010996310236212, 'loss_val': 1.1706224151035254, 'psi': 0.6167022886887501}-{'f1_val': 0.6253939009588327, 'auprc': 0.6623834946082798, 'loss_val': 0.7172608647025144, 'psi': 0.6401897384186116}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=48 head_norm_before_train=1.985873 cos_to_last_merge=0.9582 (last merge round=13)
[S14] round=48 local utility u=0.004636 metrics={'f1_val': 0.9970007132142444, 'auprc': 0.999075328493482, 'loss_val': 0.02021425409775372, 'psi': 0.9978305593259396}-{'f1_val': 0.9971680177638609, 'auprc': 0.9968588815278638, 'loss_val': 0.023840021187352817, 'psi': 0.9970443632694621}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] sending update (kind=head size=1804 to 1 peers)
[S15] START round=48 head_norm_before_train=1.860466 cos_to_last_merge=0.9418 (last merge round=14)
[S15] ⚠️ Model drifted since last merge! cos=0.942
[S15] round=48 local utility u=0.000000 metrics={'f1_val': 0.9076311108628641, 'auprc': 0.9970691459488695, 'loss_val': 0.16433070653538198, 'psi': 0.9434063248972663}-{'f1_val': 0.9695627273083611, 'auprc': 0.9753037349813987, 'loss_val': 0.12867382931013602, 'psi': 0.9718591303775761}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=48 head_norm_before_train=1.684594 cos_to_last_merge=0.8324 (last merge round=11)
[S16] ⚠️ Model drifted since last merge! cos=0.832
[S16] round=48 local utility u=1.000000 metrics={'f1_val': 0.99170615891566, 'auprc': 0.9962118107879865, 'loss_val': 0.04082915465521377, 'psi': 0.9935084196645907}-{'f1_val': 0.7788293968888069, 'auprc': 0.9259507992319977, 'loss_val': 0.9407171311584129, 'psi': 0.8376779578260832}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] sending update (kind=head size=1804 to 1 peers)
[S17] START round=48 head_norm_before_train=1.852402 cos_to_last_merge=0.7737 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.774
[S17] round=48 local utility u=0.250733 metrics={'f1_val': 0.6035947972421914, 'auprc': 0.7768642951891396, 'loss_val': 1.2321046313515167, 'psi': 0.6729025964209707}-{'f1_val': 0.5536667457529403, 'auprc': 0.751572876959663, 'loss_val': 1.3581270695720729, 'psi': 0.6328291982356293}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] START round=49 head_norm_before_train=1.666401 cos_to_last_merge=0.9664 (last merge round=16)
[S2] round=49 local utility u=0.037616 metrics={'f1_val': 0.7171765994630479, 'auprc': 0.7320441467424892, 'loss_val': 0.8812214280286733, 'psi': 0.7231236183748244}-{'f1_val': 0.6934589332441159, 'auprc': 0.7521351327808514, 'loss_val': 0.8744202640350174, 'psi': 0.7169294130588102}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=49 head_norm_before_train=2.138033 (no previous merge yet)
[S3] round=49 local utility u=0.016339 metrics={'f1_val': 0.9786364335039747, 'auprc': 0.9982852303283665, 'loss_val': 0.04504702175951157, 'psi': 0.9864959522337314}-{'f1_val': 0.9754508479949865, 'auprc': 0.9975245426811057, 'loss_val': 0.05633032445863483, 'psi': 0.9842803258694341}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] sending update (kind=head size=1804 to 1 peers)
[S4] START round=49 head_norm_before_train=1.675180 cos_to_last_merge=0.9552 (last merge round=15)
[S4] round=49 local utility u=0.000000 metrics={'f1_val': 0.9404834209063722, 'auprc': 0.9474779498294166, 'loss_val': 0.31345391937361095, 'psi': 0.9432812324755899}-{'f1_val': 0.9413559795254743, 'auprc': 0.9576064878268904, 'loss_val': 0.2928132182889739, 'psi': 0.9478561828460408}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=49 head_norm_before_train=1.804059 (no previous merge yet)
[S5] round=49 local utility u=0.000000 metrics={'f1_val': 0.7006947214685414, 'auprc': 0.8544440457316532, 'loss_val': 0.5196664787554114, 'psi': 0.7621944511737861}-{'f1_val': 0.8322048799703601, 'auprc': 0.9904191673653298, 'loss_val': 0.14497561891460287, 'psi': 0.8954905949283479}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=49 head_norm_before_train=1.447074 cos_to_last_merge=0.9078 (last merge round=15)
[S6] ⚠️ Model drifted since last merge! cos=0.908
[S6] round=49 local utility u=0.000000 metrics={'f1_val': 0.8240063835965632, 'auprc': 0.9494324676424734, 'loss_val': 0.5042968107254749, 'psi': 0.8741768172149272}-{'f1_val': 0.9875549694614034, 'auprc': 0.9594348563086934, 'loss_val': 0.10006986133912883, 'psi': 0.9763069242003194}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=49 head_norm_before_train=1.521189 cos_to_last_merge=0.9290 (last merge round=11)
[S7] ⚠️ Model drifted since last merge! cos=0.929
[S7] round=49 local utility u=0.177229 metrics={'f1_val': 0.6025714721877741, 'auprc': 0.8026188080385328, 'loss_val': 0.6308358311806356, 'psi': 0.6825904065280776}-{'f1_val': 0.5682319892740175, 'auprc': 0.7941032392497209, 'loss_val': 0.7537097698848286, 'psi': 0.6585804892642989}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=49 head_norm_before_train=2.081496 cos_to_last_merge=0.9576 (last merge round=16)
[S8] round=49 local utility u=0.085174 metrics={'f1_val': 0.9924393115056276, 'auprc': 0.9994950059623151, 'loss_val': 0.028063453619526123, 'psi': 0.9952615892883026}-{'f1_val': 0.9709193637124511, 'auprc': 0.998076608126802, 'loss_val': 0.0650369557155549, 'psi': 0.9817822614781915}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=49 head_norm_before_train=1.656060 cos_to_last_merge=0.9354 (last merge round=16)
[S9] ⚠️ Model drifted since last merge! cos=0.935
[S9] round=49 local utility u=0.000000 metrics={'f1_val': 0.9854657388091037, 'auprc': 0.9817759647091732, 'loss_val': 0.06063254084123982, 'psi': 0.9839898291691316}-{'f1_val': 0.9966605118138915, 'auprc': 0.998176555131262, 'loss_val': 0.023944813521372475, 'psi': 0.9972669291408397}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=49 head_norm_before_train=1.857960 cos_to_last_merge=0.9235 (last merge round=11)
[S10] ⚠️ Model drifted since last merge! cos=0.924
[S10] round=49 local utility u=0.001846 metrics={'f1_val': 0.9927344652802075, 'auprc': 0.9961492800508659, 'loss_val': 0.04217103435263913, 'psi': 0.9941003911884708}-{'f1_val': 0.9929696616913117, 'auprc': 0.9926423065576445, 'loss_val': 0.036753841843193726, 'psi': 0.9928387196378449}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] sending update (kind=head size=1804 to 1 peers)
[S11] START round=49 head_norm_before_train=1.661282 cos_to_last_merge=0.8845 (last merge round=14)
[S11] ⚠️ Model drifted since last merge! cos=0.884
[S11] round=49 local utility u=0.001270 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9938191375750117, 'loss_val': 0.029138806629469174, 'psi': 0.9952078599779903}-{'f1_val': 0.9961336749133093, 'auprc': 0.9932420890486983, 'loss_val': 0.029947794655732173, 'psi': 0.9949770405674649}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=49 head_norm_before_train=1.856359 cos_to_last_merge=0.9569 (last merge round=11)
[S13] round=49 local utility u=0.242702 metrics={'f1_val': 0.6012238447603002, 'auprc': 0.683644241937686, 'loss_val': 0.8775717244284269, 'psi': 0.6341920036312545}-{'f1_val': 0.5604373937988361, 'auprc': 0.7010996310236212, 'loss_val': 1.1706224151035254, 'psi': 0.6167022886887501}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=49 head_norm_before_train=1.986900 cos_to_last_merge=0.9582 (last merge round=13)
[S14] round=49 local utility u=0.001562 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9989754412624161, 'loss_val': 0.019236279338961035, 'psi': 0.9980351382060018}-{'f1_val': 0.9970007132142444, 'auprc': 0.999075328493482, 'loss_val': 0.02021425409775372, 'psi': 0.9978305593259396}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S14] sending update (kind=head size=1806 to 1 peers)
[S15] START round=49 head_norm_before_train=1.866792 cos_to_last_merge=0.9412 (last merge round=14)
[S15] ⚠️ Model drifted since last merge! cos=0.941
[S15] round=49 local utility u=0.255664 metrics={'f1_val': 0.976506685110904, 'auprc': 0.9928012668896893, 'loss_val': 0.053452930819163476, 'psi': 0.9830245178224181}-{'f1_val': 0.9076311108628641, 'auprc': 0.9970691459488695, 'loss_val': 0.16433070653538198, 'psi': 0.9434063248972663}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=49 head_norm_before_train=1.692714 cos_to_last_merge=0.8316 (last merge round=11)
[S16] ⚠️ Model drifted since last merge! cos=0.832
[S16] round=49 local utility u=0.000000 metrics={'f1_val': 0.9239569516130829, 'auprc': 0.9945527726647573, 'loss_val': 0.3115566458148475, 'psi': 0.9521952800337526}-{'f1_val': 0.99170615891566, 'auprc': 0.9962118107879865, 'loss_val': 0.04082915465521377, 'psi': 0.9935084196645907}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=49 head_norm_before_train=1.860406 cos_to_last_merge=0.7730 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.773
[S17] round=49 local utility u=0.080809 metrics={'f1_val': 0.6088521138947804, 'auprc': 0.8249242759541189, 'loss_val': 1.2462109366741116, 'psi': 0.6952809787185159}-{'f1_val': 0.6035947972421914, 'auprc': 0.7768642951891396, 'loss_val': 1.2321046313515167, 'psi': 0.6729025964209707}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[runner] rounds complete.
[runner] all agents stopped.
