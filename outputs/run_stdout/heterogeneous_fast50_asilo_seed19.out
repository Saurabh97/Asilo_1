[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:52803
[S3] → join 127.0.0.1:52802
[S4] → join 127.0.0.1:52802
[S5] → join 127.0.0.1:52802
[S6] → join 127.0.0.1:52802
[S7] → join 127.0.0.1:52802
[S8] → join 127.0.0.1:52802
[S9] → join 127.0.0.1:52802
[S10] → join 127.0.0.1:52802
[S11] → join 127.0.0.1:52802
[S13] → join 127.0.0.1:52802
[S14] → join 127.0.0.1:52802
[S15] → join 127.0.0.1:52802
[S16] → join 127.0.0.1:52802
[S17] → join 127.0.0.1:52802
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.129828 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.136106 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.147446 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.162032 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.184381 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.173659 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.123749 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.185031 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.191354 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.181540 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.115344 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.123352 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.120925 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.119875 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.163864 (no previous merge yet)
[S3]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S4] + discovered S2
[S3] + discovered S11
[S3] + discovered S16
[S3] + discovered S13
[S3] + discovered S5
[S3] + discovered S7
[S3] + discovered S4
[S3] + discovered S15
[S3] + discovered S14
[S3] + discovered S6
[S3] + discovered S10
[S3] + discovered S9
[S3] + discovered S17
[S3] + discovered S8
[S4] + discovered S3
[S4] + discovered S8
[S4] + discovered S10
[S4] + discovered S17
[S4] + discovered S9
[S4] + discovered S7
[S4] + discovered S16
[S4] + discovered S11
[S4] + discovered S6
[S4] + discovered S15
[S4] + discovered S14
[S4] + discovered S5
[S4] + discovered S13
[S5] + discovered S3
[S5] + discovered S2
[S5] + discovered S4
[S6] + discovered S4
[S6] + discovered S5
[S6] + discovered S2
[S6] + discovered S3
[S5] + discovered S8
[S5] + discovered S13
[S5] + discovered S7
[S5] + discovered S6
[S5] + discovered S15
[S5] + discovered S14
[S5] + discovered S11
[S5] + discovered S16
[S5] + discovered S17
[S5] + discovered S9
[S5] + discovered S10
[S6] + discovered S9
[S6] + discovered S17
[S6] + discovered S11
[S6] + discovered S13
[S6] + discovered S8
[S6] + discovered S10
[S6] + discovered S16
[S6] + discovered S15
[S6] + discovered S14
[S6] + discovered S7
[S7] + discovered S6
[S7] + discovered S4
[S7] + discovered S5
[S7] + discovered S2
[S7] + discovered S3
[S8] + discovered S4
[S8] + discovered S6
[S8] + discovered S7
[S8] + discovered S3
[S8] + discovered S2
[S8] + discovered S5
[S7] + discovered S16
[S7] + discovered S14
[S7] + discovered S10
[S7] + discovered S8
[S7] + discovered S17
[S7] + discovered S15
[S7] + discovered S13
[S7] + discovered S11
[S7] + discovered S9
[S9] + discovered S2
[S9] + discovered S3
[S9] + discovered S4
[S9] + discovered S5
[S9] + discovered S7
[S9] + discovered S6
[S9] + discovered S8
[S8] + discovered S11
[S8] + discovered S9
[S8] + discovered S13
[S8] + discovered S15
[S8] + discovered S17
[S8] + discovered S10
[S8] + discovered S14
[S8] + discovered S16
[S9] + discovered S14
[S10] + discovered S7
[S10] + discovered S8
[S10] + discovered S6
[S10] + discovered S9
[S10] + discovered S2
[S10] + discovered S4
[S10] + discovered S5
[S10] + discovered S3
[S9] + discovered S13
[S9] + discovered S16
[S9] + discovered S11
[S9] + discovered S15
[S9] + discovered S17
[S9] + discovered S10
[S10] + discovered S13
[S10] + discovered S11
[S10] + discovered S14
[S10] + discovered S15
[S10] + discovered S16
[S10] + discovered S17
[S11] + discovered S8
[S11] + discovered S4
[S11] + discovered S9
[S11] + discovered S6
[S11] + discovered S7
[S11] + discovered S2
[S11] + discovered S5
[S11] + discovered S3
[S11] + discovered S10
[S13] + discovered S2
[S13] + discovered S11
[S13] + discovered S10
[S11] + discovered S17
[S13] + discovered S6
[S11] + discovered S16
[S11] + discovered S15
[S11] + discovered S14
[S13] + discovered S3
[S13] + discovered S7
[S13] + discovered S8
[S13] + discovered S5
[S13] + discovered S9
[S11] + discovered S13
[S13] + discovered S4
[S14] + discovered S7
[S14] + discovered S9
[S14] + discovered S13
[S14] + discovered S11
[S14] + discovered S8
[S14] + discovered S6
[S14] + discovered S10
[S14] + discovered S5
[S13] + discovered S15
[S13] + discovered S14
[S13] + discovered S17
[S13] + discovered S16
[S14] + discovered S3
[S14] + discovered S2
[S14] + discovered S4
[S14] + discovered S15
[S14] + discovered S17
[S14] + discovered S16
[S15] + discovered S7
[S15] + discovered S13
[S15] + discovered S14
[S15] + discovered S3
[S15] + discovered S2
[S15] + discovered S4
[S15] + discovered S9
[S15] + discovered S8
[S15] + discovered S6
[S15] + discovered S10
[S15] + discovered S11
[S15] + discovered S5
[S16] + discovered S6
[S16] + discovered S8
[S16] + discovered S11
[S16] + discovered S2
[S16] + discovered S3
[S16] + discovered S5
[S15] + discovered S17
[S15] + discovered S16
[S16] + discovered S10
[S16] + discovered S4
[S16] + discovered S9
[S16] + discovered S14
[S16] + discovered S15
[S16] + discovered S13
[S16] + discovered S7
[S17] + discovered S8
[S17] + discovered S2
[S17] + discovered S11
[S17] + discovered S13
[S17] + discovered S9
[S17] + discovered S6
[S17] + discovered S3
[S17] + discovered S5
[S17] + discovered S7
[S17] + discovered S16
[S17] + discovered S10
[S17] + discovered S15
[S17] + discovered S14
[S17] + discovered S4
[S16] + discovered S17
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] ⇄ pheromone p=1.000 → S8@127.0.0.1:52809
[S9] ⇄ pheromone p=1.000 → S17@127.0.0.1:52817
[S6] ⇄ pheromone p=1.000 → S17@127.0.0.1:52817
[S10] ⇄ pheromone p=1.000 → S14@127.0.0.1:52814
[S13] ⇄ pheromone p=1.000 → S7@127.0.0.1:52808
[S2] ⇄ pheromone p=1.000 → S8@127.0.0.1:52809
[S7] ⇄ pheromone p=1.000 → S17@127.0.0.1:52817
[S8] ⇄ pheromone p=1.000 → S15@127.0.0.1:52815
[S15] ⇄ pheromone p=1.000 → S9@127.0.0.1:52810
[S14] ⇄ pheromone p=1.000 → S8@127.0.0.1:52809
[S16] ⇄ pheromone p=1.000 → S7@127.0.0.1:52808
[S3] ⇄ pheromone p=1.000 → S11@127.0.0.1:52812
[S5] ⇄ pheromone p=1.000 → S11@127.0.0.1:52812
[S4] ⇄ pheromone p=1.000 → S8@127.0.0.1:52809
[S17] ⇄ pheromone p=1.000 → S13@127.0.0.1:52813
[S2] START round=1 head_norm_before_train=1.143695 (no previous merge yet)
[S2] round=1 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7693881707068563, 'loss_val': 1.2580226836631805, 'psi': 0.39282154831588256}-{'f1_val': 0.31266391533325033, 'auprc': 0.7644576546204437, 'loss_val': 1.3438298109036977, 'psi': 0.4933814110481277}
[S3] START round=1 head_norm_before_train=1.146160 (no previous merge yet)
[S3] round=1 local utility u=0.355822 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8952025211076104, 'loss_val': 1.3297833611329875, 'psi': 0.4419850478115084}-{'f1_val': 0.10474797479747974, 'auprc': 0.7387671305987732, 'loss_val': 1.361568418930296, 'psi': 0.3583556371179971}
[S4] START round=1 head_norm_before_train=1.165083 (no previous merge yet)
[S4] round=1 local utility u=0.038845 metrics={'f1_val': 0.40024525459115723, 'auprc': 0.7838832780295022, 'loss_val': 1.2469681277717526, 'psi': 0.5537004639664953}-{'f1_val': 0.3948909777524071, 'auprc': 0.7933900748140652, 'loss_val': 1.3210530463576295, 'psi': 0.5542906165770703}
[S5] START round=1 head_norm_before_train=1.167173 (no previous merge yet)
[S5] round=1 local utility u=1.000000 metrics={'f1_val': 0.3939603428268922, 'auprc': 0.7697158091935795, 'loss_val': 1.342591438367393, 'psi': 0.5442625293735671}-{'f1_val': 0.10408432147562582, 'auprc': 0.5892099446006445, 'loss_val': 1.379659776021598, 'psi': 0.2981345707256333}
[S6] START round=1 head_norm_before_train=1.188055 (no previous merge yet)
[S6] round=1 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.861239723537448, 'loss_val': 1.282529961247121, 'psi': 0.4293516586457484}-{'f1_val': 0.39737151983380536, 'auprc': 0.8291052499780533, 'loss_val': 1.3521235763986184, 'psi': 0.5700650118915045}
[S7] START round=1 head_norm_before_train=1.183544 (no previous merge yet)
[S7] round=1 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7786453212268487, 'loss_val': 1.3358722790955644, 'psi': 0.3966922221281945}-{'f1_val': 0.3710598754010964, 'auprc': 0.7281644220433685, 'loss_val': 1.3747119724834103, 'psi': 0.5139016940580052}
[S8] START round=1 head_norm_before_train=1.135681 (no previous merge yet)
[S8] round=1 local utility u=0.000000 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7162819896483363, 'loss_val': 1.294521440016801, 'psi': 0.37048638529510886}-{'f1_val': 0.3730767263257798, 'auprc': 0.6597965774437987, 'loss_val': 1.3592346362381469, 'psi': 0.48776466677298735}
[S9] START round=1 head_norm_before_train=1.184146 (no previous merge yet)
[S9] round=1 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9393404380925199, 'loss_val': 1.3081719763034594, 'psi': 0.4605749495210056}-{'f1_val': 0.4158150203185748, 'auprc': 0.7801955991388796, 'loss_val': 1.3479198365664922, 'psi': 0.5615672518466968}
[S10] START round=1 head_norm_before_train=1.197813 (no previous merge yet)
[S10] round=1 local utility u=0.128468 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6353164182617328, 'loss_val': 1.2945532143469185, 'psi': 0.3372995498297275}-{'f1_val': 0.13862163754172394, 'auprc': 0.5668328167508532, 'loss_val': 1.346037935785391, 'psi': 0.30990610922537565}
[S11] START round=1 head_norm_before_train=1.177915 (no previous merge yet)
[S11] round=1 local utility u=0.000000 metrics={'f1_val': 0.42255365455174765, 'auprc': 0.5355161845939909, 'loss_val': 1.3456581659225932, 'psi': 0.46773866656864493}-{'f1_val': 0.543859750423688, 'auprc': 0.5293502728859195, 'loss_val': 1.3752434652418237, 'psi': 0.5380559594085805}
[S13] START round=1 head_norm_before_train=1.117948 (no previous merge yet)
[S13] round=1 local utility u=0.117706 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7224026996046857, 'loss_val': 1.2953210781682232, 'psi': 0.37319253738810615}-{'f1_val': 0.1403857625770531, 'auprc': 0.6585681909380743, 'loss_val': 1.3392294758660022, 'psi': 0.34765873392146157}
[S14] START round=1 head_norm_before_train=1.130178 (no previous merge yet)
[S14] round=1 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.9782134914882326, 'loss_val': 1.3239553119304577, 'psi': 0.4755001083249153}-{'f1_val': 0.14035785288270378, 'auprc': 0.9907043248365269, 'loss_val': 1.3467387086591969, 'psi': 0.48049644166423305}
[S15] START round=1 head_norm_before_train=1.139827 (no previous merge yet)
[S15] round=1 local utility u=0.000000 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7688229092491817, 'loss_val': 1.267644787342352, 'psi': 0.3913693545166077}-{'f1_val': 0.4218198474858389, 'auprc': 0.7443087323195543, 'loss_val': 1.3327638821526604, 'psi': 0.5508154014193251}
[S16] START round=1 head_norm_before_train=1.120768 (no previous merge yet)
[S16] round=1 local utility u=0.639770 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.9757820260978176, 'loss_val': 1.3287986592242997, 'psi': 0.47469528055864896}-{'f1_val': 0.1406935033878039, 'auprc': 0.5571721389852142, 'loss_val': 1.3528452669479452, 'psi': 0.30728495762676805}
[S17] START round=1 head_norm_before_train=1.173704 (no previous merge yet)
[S17] round=1 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.610993071380474, 'loss_val': 1.2833955560847654, 'psi': 0.3289666065426202}-{'f1_val': 0.14094896331738438, 'auprc': 0.7595810701174579, 'loss_val': 1.3313282812012772, 'psi': 0.3884018060374138}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S16] → sending delta(kind=head bytes=1790) to S7@127.0.0.1:52808
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] → sending delta(kind=head bytes=1794) to S6@127.0.0.1:52807
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:52807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:52805
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S5] → sending delta(kind=head bytes=1787) to S9@127.0.0.1:52810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] → sending delta(kind=head bytes=1793) to S9@127.0.0.1:52810
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1793 to 1 peers)
[S5] sending update (kind=head size=1787 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S3] sending update (kind=head size=1794 to 1 peers)
[S16] sending update (kind=head size=1790 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1794) from S3
[S6] cosine check vs S3: cos=0.1018
[S9] RECEIVED delta(kind=head bytes=1793) from S4
[S9] cosine check vs S4: cos=-0.0550
[S9] DROPPED delta from S4 (cos=-0.0550 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1787) from S5
[S9] cosine check vs S5: cos=0.0370
[S7] RECEIVED delta(kind=head bytes=1790) from S16
[S7] cosine check vs S16: cos=-0.0064
[S7] DROPPED delta from S16 (cos=-0.0064 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1796) from S10
[S5] cosine check vs S10: cos=0.1260
[S6] RECEIVED delta(kind=head bytes=1796) from S13
[S6] cosine check vs S13: cos=0.0007
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=1 metric=0.1414 head_norm=1.222561
[S6] _apply_head_vector_avg (torch): Δ‖w‖=7.001728e-01
[S6] stored merged vector for next round verification (round=1)
[S6] DEBUG after merge:  round=1 metric=0.1414 head_norm=0.750443 delta_norm=0.700173
[S6] aggregate: ACCEPT kept=['S3', 'S13'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=1 metric=0.1414 head_norm=1.195595
[S9] _apply_head_vector_avg (torch): Δ‖w‖=8.253021e-01
[S9] stored merged vector for next round verification (round=1)
[S9] DEBUG after merge:  round=1 metric=0.4014 head_norm=0.856445 delta_norm=0.825302
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=1 metric=0.3940 head_norm=1.183130
[S5] _apply_head_vector_avg (torch): Δ‖w‖=7.960094e-01
[S5] stored merged vector for next round verification (round=1)
[S5] DEBUG after merge:  round=1 metric=0.1423 head_norm=0.903435 delta_norm=0.796009
[S5] aggregate: ROLLBACK (f1_val pre=0.394 post=0.142 tol_abs=0.005 tol_rel=0.0)
[S2] START round=2 head_norm_before_train=1.187263 (no previous merge yet)
[S2] round=2 local utility u=0.001999 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7438711604494567, 'loss_val': 1.1774737599031417, 'psi': 0.38261474421292274}-{'f1_val': 0.1417771333885667, 'auprc': 0.7693881707068563, 'loss_val': 1.2580226836631805, 'psi': 0.39282154831588256}
[S3] START round=2 head_norm_before_train=1.164127 (no previous merge yet)
[S3] round=2 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8642143047390217, 'loss_val': 1.2889376707141038, 'psi': 0.4295897612640729}-{'f1_val': 0.13984006561410703, 'auprc': 0.8952025211076104, 'loss_val': 1.3297833611329875, 'psi': 0.4419850478115084}
[S4] START round=2 head_norm_before_train=1.208487 (no previous merge yet)
[S4] round=2 local utility u=0.000000 metrics={'f1_val': 0.14090945936924823, 'auprc': 0.7937068023755589, 'loss_val': 1.0965031406839236, 'psi': 0.4020283965717725}-{'f1_val': 0.40024525459115723, 'auprc': 0.7838832780295022, 'loss_val': 1.2469681277717526, 'psi': 0.5537004639664953}
[S5] START round=2 head_norm_before_train=0.903435 cos_to_last_merge=1.0000 (last merge round=1)
[S5] round=2 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7694536969253168, 'loss_val': 1.3296481764453698, 'psi': 0.3931386216272696}-{'f1_val': 0.3939603428268922, 'auprc': 0.7697158091935795, 'loss_val': 1.342591438367393, 'psi': 0.5442625293735671}
[S6] START round=2 head_norm_before_train=0.750443 cos_to_last_merge=1.0000 (last merge round=1)
[S6] round=2 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6562088450392687, 'loss_val': 1.2349512587310199, 'psi': 0.3473393072464767}-{'f1_val': 0.14142628205128205, 'auprc': 0.861239723537448, 'loss_val': 1.282529961247121, 'psi': 0.4293516586457484}
[S7] START round=2 head_norm_before_train=1.198297 (no previous merge yet)
[S7] round=2 local utility u=0.021955 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7793683324295351, 'loss_val': 1.2941315493881353, 'psi': 0.39698142660926905}-{'f1_val': 0.14205682272909165, 'auprc': 0.7786453212268487, 'loss_val': 1.3358722790955644, 'psi': 0.3966922221281945}
[S8] START round=2 head_norm_before_train=1.173623 (no previous merge yet)
[S8] round=2 local utility u=0.114479 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7657984830394967, 'loss_val': 1.21411204824707, 'psi': 0.39029298265157303}-{'f1_val': 0.13995598239295717, 'auprc': 0.7162819896483363, 'loss_val': 1.294521440016801, 'psi': 0.37048638529510886}
[S9] START round=2 head_norm_before_train=0.856445 cos_to_last_merge=1.0000 (last merge round=1)
[S9] round=2 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8662544747978571, 'loss_val': 1.3151948556320265, 'psi': 0.4313405642031405}-{'f1_val': 0.141397957139996, 'auprc': 0.9393404380925199, 'loss_val': 1.3081719763034594, 'psi': 0.4605749495210056}
[S10] START round=2 head_norm_before_train=1.224686 (no previous merge yet)
[S10] round=2 local utility u=0.036642 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6426774980540746, 'loss_val': 1.2433517974548833, 'psi': 0.3402439817466642}-{'f1_val': 0.13862163754172394, 'auprc': 0.6353164182617328, 'loss_val': 1.2945532143469185, 'psi': 0.3372995498297275}
[S11] START round=2 head_norm_before_train=1.184063 (no previous merge yet)
[S11] round=2 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.6671261003777749, 'loss_val': 1.3120851530593538, 'psi': 0.3510986501749763}-{'f1_val': 0.42255365455174765, 'auprc': 0.5355161845939909, 'loss_val': 1.3456581659225932, 'psi': 0.46773866656864493}
[S13] START round=2 head_norm_before_train=1.148520 (no previous merge yet)
[S13] round=2 local utility u=0.029298 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7249348308157628, 'loss_val': 1.244321962848779, 'psi': 0.374205389872537}-{'f1_val': 0.1403857625770531, 'auprc': 0.7224026996046857, 'loss_val': 1.2953210781682232, 'psi': 0.37319253738810615}
[S14] START round=2 head_norm_before_train=1.146623 (no previous merge yet)
[S14] round=2 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8190802034241396, 'loss_val': 1.2925582047611504, 'psi': 0.4118467930992781}-{'f1_val': 0.14035785288270378, 'auprc': 0.9782134914882326, 'loss_val': 1.3239553119304577, 'psi': 0.4755001083249153}
[S15] START round=2 head_norm_before_train=1.186350 (no previous merge yet)
[S15] round=2 local utility u=0.238458 metrics={'f1_val': 0.19814991043439317, 'auprc': 0.7751650234470228, 'loss_val': 1.1602535160534693, 'psi': 0.428955955639445}-{'f1_val': 0.13973365136155833, 'auprc': 0.7688229092491817, 'loss_val': 1.267644787342352, 'psi': 0.3913693545166077}
[S16] START round=2 head_norm_before_train=1.131087 (no previous merge yet)
[S16] round=2 local utility u=0.022952 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.9810190258041706, 'loss_val': 1.298606333021695, 'psi': 0.4767900804411902}-{'f1_val': 0.14063745019920318, 'auprc': 0.9757820260978176, 'loss_val': 1.3287986592242997, 'psi': 0.47469528055864896}
[S17] START round=2 head_norm_before_train=1.205761 (no previous merge yet)
[S17] round=2 local utility u=0.005894 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5838538869125932, 'loss_val': 1.1901893184363803, 'psi': 0.3181109327554679}-{'f1_val': 0.14094896331738438, 'auprc': 0.610993071380474, 'loss_val': 1.2833955560847654, 'psi': 0.3289666065426202}
[S10] not sending this round → trigger blocked (psi=0.340)
[S16] not sending this round → trigger blocked (psi=0.477)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:52816
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S7] → sending delta(kind=head bytes=1793) to S10@127.0.0.1:52811
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:52816
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.374)
[S15] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1793 to 1 peers)
[S2] sending update (kind=head size=1795 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1793) from S7
[S10] cosine check vs S7: cos=-0.0109
[S10] DROPPED delta from S7 (cos=-0.0109 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1795) from S2
[S8] cosine check vs S2: cos=0.0902
[S16] RECEIVED delta(kind=head bytes=1797) from S8
[S16] cosine check vs S8: cos=0.0444
[S16] RECEIVED delta(kind=head bytes=1801) from S15
[S16] cosine check vs S15: cos=0.0207
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:52816
[S17] sending update (kind=head size=1800 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1800) from S17
[S16] cosine check vs S17: cos=-0.0016
[S16] DROPPED delta from S17 (cos=-0.0016 < 0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=2 metric=0.1400 head_norm=1.220749
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.272792e-01
[S8] stored merged vector for next round verification (round=2)
[S8] DEBUG after merge:  round=2 metric=0.1400 head_norm=0.905619 delta_norm=0.827279
[S8] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=2 metric=0.1406 head_norm=1.151860
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.112875e-01
[S16] stored merged vector for next round verification (round=2)
[S16] DEBUG after merge:  round=2 metric=0.1406 head_norm=0.742965 delta_norm=0.711287
[S16] aggregate: ACCEPT kept=['S8', 'S15'] (k=2/2) mode=median trim_p=0.1
[S2] START round=3 head_norm_before_train=1.232414 (no previous merge yet)
[S2] round=3 local utility u=0.949980 metrics={'f1_val': 0.4158821818019893, 'auprc': 0.7765408035438495, 'loss_val': 1.0201525263378224, 'psi': 0.5601456304987333}-{'f1_val': 0.1417771333885667, 'auprc': 0.7438711604494567, 'loss_val': 1.1774737599031417, 'psi': 0.38261474421292274}
[S3] START round=3 head_norm_before_train=1.190750 (no previous merge yet)
[S3] round=3 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.628428994576194, 'loss_val': 1.2449529872032348, 'psi': 0.3352756371989418}-{'f1_val': 0.13984006561410703, 'auprc': 0.8642143047390217, 'loss_val': 1.2889376707141038, 'psi': 0.4295897612640729}
[S4] START round=3 head_norm_before_train=1.270321 (no previous merge yet)
[S4] round=3 local utility u=1.000000 metrics={'f1_val': 0.6833734078323682, 'auprc': 0.7849602698653086, 'loss_val': 0.8356346927933119, 'psi': 0.7240081526455444}-{'f1_val': 0.14090945936924823, 'auprc': 0.7937068023755589, 'loss_val': 1.0965031406839236, 'psi': 0.4020283965717725}
[S5] START round=3 head_norm_before_train=0.919589 cos_to_last_merge=0.9972 (last merge round=1)
[S5] round=3 local utility u=0.004947 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7579086493484608, 'loss_val': 1.285119841567706, 'psi': 0.3885206025965272}-{'f1_val': 0.14226190476190476, 'auprc': 0.7694536969253168, 'loss_val': 1.3296481764453698, 'psi': 0.3931386216272696}
[S6] START round=3 head_norm_before_train=0.810225 cos_to_last_merge=0.9914 (last merge round=1)
[S6] round=3 local utility u=0.816670 metrics={'f1_val': 0.4036129717905665, 'auprc': 0.6430378718600739, 'loss_val': 1.135219415292317, 'psi': 0.49938293181836946}-{'f1_val': 0.14142628205128205, 'auprc': 0.6562088450392687, 'loss_val': 1.2349512587310199, 'psi': 0.3473393072464767}
[S7] START round=3 head_norm_before_train=1.221192 (no previous merge yet)
[S7] round=3 local utility u=0.032176 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7875478237840526, 'loss_val': 1.2543183035216952, 'psi': 0.4002532231510761}-{'f1_val': 0.14205682272909165, 'auprc': 0.7793683324295351, 'loss_val': 1.2941315493881353, 'psi': 0.39698142660926905}
[S8] START round=3 head_norm_before_train=0.905619 cos_to_last_merge=1.0000 (last merge round=2)
[S8] round=3 local utility u=0.194153 metrics={'f1_val': 0.19084635894871618, 'auprc': 0.7834076633544826, 'loss_val': 1.183974904608864, 'psi': 0.4278708807110228}-{'f1_val': 0.13995598239295717, 'auprc': 0.7657984830394967, 'loss_val': 1.21411204824707, 'psi': 0.39029298265157303}
[S9] START round=3 head_norm_before_train=0.872785 cos_to_last_merge=0.9968 (last merge round=1)
[S9] round=3 local utility u=0.075377 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8999582790278957, 'loss_val': 1.2655528429104712, 'psi': 0.4448220858951559}-{'f1_val': 0.141397957139996, 'auprc': 0.8662544747978571, 'loss_val': 1.3151948556320265, 'psi': 0.4313405642031405}
[S10] START round=3 head_norm_before_train=1.264792 (no previous merge yet)
[S10] round=3 local utility u=0.117000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6908321510748503, 'loss_val': 1.1538155778002368, 'psi': 0.3595058429549745}-{'f1_val': 0.13862163754172394, 'auprc': 0.6426774980540746, 'loss_val': 1.2433517974548833, 'psi': 0.3402439817466642}
[S11] START round=3 head_norm_before_train=1.198709 (no previous merge yet)
[S11] round=3 local utility u=0.067777 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.6979432267997583, 'loss_val': 1.268982015925799, 'psi': 0.36342550074376967}-{'f1_val': 0.14041368337311058, 'auprc': 0.6671261003777749, 'loss_val': 1.3120851530593538, 'psi': 0.3510986501749763}
[S13] START round=3 head_norm_before_train=1.192172 (no previous merge yet)
[S13] round=3 local utility u=0.425673 metrics={'f1_val': 0.26262665509750904, 'auprc': 0.7313803974189038, 'loss_val': 1.145757931633521, 'psi': 0.45012815202606693}-{'f1_val': 0.1403857625770531, 'auprc': 0.7249348308157628, 'loss_val': 1.244321962848779, 'psi': 0.374205389872537}
[S14] START round=3 head_norm_before_train=1.172956 (no previous merge yet)
[S14] round=3 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7545426127529233, 'loss_val': 1.251311679691422, 'psi': 0.3860317568307916}-{'f1_val': 0.14035785288270378, 'auprc': 0.8190802034241396, 'loss_val': 1.2925582047611504, 'psi': 0.4118467930992781}
[S15] START round=3 head_norm_before_train=1.244507 (no previous merge yet)
[S15] round=3 local utility u=0.783124 metrics={'f1_val': 0.4167593395843331, 'auprc': 0.7815532546258311, 'loss_val': 0.9248266483377768, 'psi': 0.5626769056009323}-{'f1_val': 0.19814991043439317, 'auprc': 0.7751650234470228, 'loss_val': 1.1602535160534693, 'psi': 0.428955955639445}
[S16] START round=3 head_norm_before_train=0.742965 cos_to_last_merge=1.0000 (last merge round=2)
[S16] round=3 local utility u=0.002385 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.9839821912634783, 'loss_val': 1.3027261657013633, 'psi': 0.47797534662491326}-{'f1_val': 0.14063745019920318, 'auprc': 0.9810190258041706, 'loss_val': 1.298606333021695, 'psi': 0.4767900804411902}
[S17] START round=3 head_norm_before_train=1.254050 (no previous merge yet)
[S17] round=3 local utility u=0.944784 metrics={'f1_val': 0.38284075793788674, 'auprc': 0.6700544836332822, 'loss_val': 1.010573282923163, 'psi': 0.49772624821604494}-{'f1_val': 0.14094896331738438, 'auprc': 0.5838538869125932, 'loss_val': 1.1901893184363803, 'psi': 0.3181109327554679}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:52808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S11] → sending delta(kind=head bytes=1788) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:52814
[S15] not sending this round → trigger blocked (psi=0.563)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.428)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] → sending delta(kind=head bytes=1794) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:52812
[S2] not sending this round → trigger blocked (psi=0.560)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S6] → sending delta(kind=head bytes=1790) to S17@127.0.0.1:52817
[S7] not sending this round → trigger blocked (psi=0.400)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:52808
[S6] sending update (kind=head size=1790 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1794 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1788 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1798) from S13
[S7] cosine check vs S13: cos=0.0944
[S14] RECEIVED delta(kind=head bytes=1800) from S10
[S14] cosine check vs S10: cos=0.0405
[S17] RECEIVED delta(kind=head bytes=1790) from S6
[S17] cosine check vs S6: cos=0.0290
[S17] RECEIVED delta(kind=head bytes=1794) from S9
[S17] cosine check vs S9: cos=0.0937
[S8] RECEIVED delta(kind=head bytes=1801) from S4
[S8] cosine check vs S4: cos=-0.0632
[S8] DROPPED delta from S4 (cos=-0.0632 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1788) from S11
[S8] cosine check vs S11: cos=0.0296
[S11] RECEIVED delta(kind=head bytes=1796) from S5
[S11] cosine check vs S5: cos=0.0083
[S7] RECEIVED delta(kind=head bytes=1796) from S16
[S7] cosine check vs S16: cos=0.0914
[S17] not sending this round → trigger blocked (psi=0.498)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=3 metric=0.1908 head_norm=0.940185
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.593267e-01
[S8] stored merged vector for next round verification (round=3)
[S8] DEBUG after merge:  round=3 metric=0.4076 head_norm=0.781389 delta_norm=0.759327
[S8] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=3 metric=0.1404 head_norm=1.205028
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.698826e-01
[S14] stored merged vector for next round verification (round=3)
[S14] DEBUG after merge:  round=3 metric=0.1404 head_norm=0.905748 delta_norm=0.869883
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=3 metric=0.1421 head_norm=1.248947
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.729493e-01
[S7] stored merged vector for next round verification (round=3)
[S7] DEBUG after merge:  round=3 metric=0.1421 head_norm=0.754765 delta_norm=0.672949
[S7] aggregate: ACCEPT kept=['S13', 'S16'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=3 metric=0.1404 head_norm=1.220796
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.689022e-01
[S11] stored merged vector for next round verification (round=3)
[S11] DEBUG after merge:  round=3 metric=0.1404 head_norm=0.775071 delta_norm=0.768902
[S11] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=3 metric=0.3828 head_norm=1.315547
[S17] _apply_head_vector_avg (torch): Δ‖w‖=7.059582e-01
[S17] stored merged vector for next round verification (round=3)
[S17] DEBUG after merge:  round=3 metric=0.3829 head_norm=0.755155 delta_norm=0.705958
[S17] aggregate: ACCEPT kept=['S6', 'S9'] (k=2/2) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=1.282716 (no previous merge yet)
[S2] round=4 local utility u=0.891124 metrics={'f1_val': 0.701033183700571, 'auprc': 0.7179715654675081, 'loss_val': 0.7731032347280222, 'psi': 0.7078085364073459}-{'f1_val': 0.4158821818019893, 'auprc': 0.7765408035438495, 'loss_val': 1.0201525263378224, 'psi': 0.5601456304987333}
[S3] START round=4 head_norm_before_train=1.219007 (no previous merge yet)
[S3] round=4 local utility u=0.001441 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.6137674247108273, 'loss_val': 1.1980866661445866, 'psi': 0.3294110092527952}-{'f1_val': 0.13984006561410703, 'auprc': 0.628428994576194, 'loss_val': 1.2449529872032348, 'psi': 0.3352756371989418}
[S4] START round=4 head_norm_before_train=1.336764 (no previous merge yet)
[S4] round=4 local utility u=0.019571 metrics={'f1_val': 0.670783802298687, 'auprc': 0.7530464115113445, 'loss_val': 0.6252141916677714, 'psi': 0.70368884598375}-{'f1_val': 0.6833734078323682, 'auprc': 0.7849602698653086, 'loss_val': 0.8356346927933119, 'psi': 0.7240081526455444}
[S5] START round=4 head_norm_before_train=0.945278 cos_to_last_merge=0.9890 (last merge round=1)
[S5] round=4 local utility u=0.013567 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7520092673001797, 'loss_val': 1.2402885973820525, 'psi': 0.38616084977721477}-{'f1_val': 0.14226190476190476, 'auprc': 0.7579086493484608, 'loss_val': 1.285119841567706, 'psi': 0.3885206025965272}
[S6] START round=4 head_norm_before_train=0.868287 cos_to_last_merge=0.9767 (last merge round=1)
[S6] round=4 local utility u=0.336134 metrics={'f1_val': 0.4172560359570804, 'auprc': 0.764236610907124, 'loss_val': 0.9084064776274902, 'psi': 0.5560482659370979}-{'f1_val': 0.4036129717905665, 'auprc': 0.6430378718600739, 'loss_val': 1.135219415292317, 'psi': 0.49938293181836946}
[S7] START round=4 head_norm_before_train=0.754765 cos_to_last_merge=1.0000 (last merge round=3)
[S7] round=4 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.74165831363226, 'loss_val': 1.2565815533090927, 'psi': 0.381897419090359}-{'f1_val': 0.14205682272909165, 'auprc': 0.7875478237840526, 'loss_val': 1.2543183035216952, 'psi': 0.4002532231510761}
[S8] START round=4 head_norm_before_train=0.781389 cos_to_last_merge=1.0000 (last merge round=3)
[S8] round=4 local utility u=0.654245 metrics={'f1_val': 0.39140334724156245, 'auprc': 0.7771068428558265, 'loss_val': 1.0599234467837562, 'psi': 0.5456847454872681}-{'f1_val': 0.19084635894871618, 'auprc': 0.7834076633544826, 'loss_val': 1.183974904608864, 'psi': 0.4278708807110228}
[S9] START round=4 head_norm_before_train=0.897814 cos_to_last_merge=0.9884 (last merge round=1)
[S9] round=4 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8662160054724479, 'loss_val': 1.206481706140961, 'psi': 0.4313251764729768}-{'f1_val': 0.141397957139996, 'auprc': 0.8999582790278957, 'loss_val': 1.2655528429104712, 'psi': 0.4448220858951559}
[S10] START round=4 head_norm_before_train=1.304629 (no previous merge yet)
[S10] round=4 local utility u=1.000000 metrics={'f1_val': 0.4170518629654155, 'auprc': 0.8570929278882896, 'loss_val': 0.894577725433438, 'psi': 0.5930682889345651}-{'f1_val': 0.13862163754172394, 'auprc': 0.6908321510748503, 'loss_val': 1.1538155778002368, 'psi': 0.3595058429549745}
[S11] START round=4 head_norm_before_train=0.775071 cos_to_last_merge=1.0000 (last merge round=3)
[S11] round=4 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.6089829626885733, 'loss_val': 1.2647929131782685, 'psi': 0.32784139509929566}-{'f1_val': 0.14041368337311058, 'auprc': 0.6979432267997583, 'loss_val': 1.268982015925799, 'psi': 0.36342550074376967}
[S13] START round=4 head_norm_before_train=1.236102 (no previous merge yet)
[S13] round=4 local utility u=0.472349 metrics={'f1_val': 0.3723879833594762, 'auprc': 0.7471534397487319, 'loss_val': 0.9069473521441904, 'psi': 0.5222941659151785}-{'f1_val': 0.26262665509750904, 'auprc': 0.7313803974189038, 'loss_val': 1.145757931633521, 'psi': 0.45012815202606693}
[S14] START round=4 head_norm_before_train=0.905748 cos_to_last_merge=1.0000 (last merge round=3)
[S14] round=4 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7323715019322118, 'loss_val': 1.2580625895726005, 'psi': 0.37716331250250695}-{'f1_val': 0.14035785288270378, 'auprc': 0.7545426127529233, 'loss_val': 1.251311679691422, 'psi': 0.3860317568307916}
[S15] START round=4 head_norm_before_train=1.311927 (no previous merge yet)
[S15] round=4 local utility u=0.113684 metrics={'f1_val': 0.4179372592884578, 'auprc': 0.7995376119795131, 'loss_val': 0.7584792126093804, 'psi': 0.57057740036488}-{'f1_val': 0.4167593395843331, 'auprc': 0.7815532546258311, 'loss_val': 0.9248266483377768, 'psi': 0.5626769056009323}
[S16] START round=4 head_norm_before_train=0.770774 cos_to_last_merge=0.9962 (last merge round=2)
[S16] round=4 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8640258733962907, 'loss_val': 1.2594779376658853, 'psi': 0.42999281947803825}-{'f1_val': 0.14063745019920318, 'auprc': 0.9839821912634783, 'loss_val': 1.3027261657013633, 'psi': 0.47797534662491326}
[S17] START round=4 head_norm_before_train=0.755155 cos_to_last_merge=1.0000 (last merge round=3)
[S17] round=4 local utility u=0.146563 metrics={'f1_val': 0.3922160499017747, 'auprc': 0.7100534934206679, 'loss_val': 0.8936965662590656, 'psi': 0.519351027309332}-{'f1_val': 0.38284075793788674, 'auprc': 0.6700544836332822, 'loss_val': 1.010573282923163, 'psi': 0.49772624821604494}
[S13] not sending this round → trigger blocked (psi=0.522)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.593)
[S4] not sending this round → trigger blocked (psi=0.704)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:52810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:52812
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.386)
[S6] not sending this round → trigger blocked (psi=0.556)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:52815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:52809
[S8] sending update (kind=head size=1796 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1796) from S8
[S15] cosine check vs S8: cos=0.0459
[S9] RECEIVED delta(kind=head bytes=1795) from S15
[S9] cosine check vs S15: cos=-0.0051
[S9] DROPPED delta from S15 (cos=-0.0051 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1801) from S2
[S8] cosine check vs S2: cos=0.3871
[S11] RECEIVED delta(kind=head bytes=1795) from S3
[S11] cosine check vs S3: cos=-0.0496
[S11] DROPPED delta from S3 (cos=-0.0496 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] → sending delta(kind=head bytes=1793) to S13@127.0.0.1:52813
[S17] sending update (kind=head size=1793 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1793) from S17
[S13] cosine check vs S17: cos=0.0978
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=4 metric=0.3724 head_norm=1.291658
[S13] _apply_head_vector_avg (torch): Δ‖w‖=7.358423e-01
[S13] stored merged vector for next round verification (round=4)
[S13] DEBUG after merge:  round=4 metric=0.4162 head_norm=0.804978 delta_norm=0.735842
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=4 metric=0.4179 head_norm=1.369170
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.848769e-01
[S15] stored merged vector for next round verification (round=4)
[S15] DEBUG after merge:  round=4 metric=0.4181 head_norm=0.817556 delta_norm=0.784877
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=4 metric=0.3914 head_norm=0.833206
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.424024e-01
[S8] stored merged vector for next round verification (round=4)
[S8] DEBUG after merge:  round=4 metric=0.3731 head_norm=0.921331 delta_norm=0.642402
[S8] aggregate: ROLLBACK (f1_val pre=0.391 post=0.373 tol_abs=0.005 tol_rel=0.0)
[S2] START round=5 head_norm_before_train=1.352342 (no previous merge yet)
[S2] round=5 local utility u=0.005539 metrics={'f1_val': 0.7018107941894467, 'auprc': 0.6447761339653287, 'loss_val': 0.5471047943571952, 'psi': 0.6789969300997996}-{'f1_val': 0.701033183700571, 'auprc': 0.7179715654675081, 'loss_val': 0.7731032347280222, 'psi': 0.7078085364073459}
[S3] START round=5 head_norm_before_train=1.249916 (no previous merge yet)
[S3] round=5 local utility u=0.042840 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.6151186599118141, 'loss_val': 1.1164604063369208, 'psi': 0.3299515033331899}-{'f1_val': 0.13984006561410703, 'auprc': 0.6137674247108273, 'loss_val': 1.1980866661445866, 'psi': 0.3294110092527952}
[S4] START round=5 head_norm_before_train=1.414583 (no previous merge yet)
[S4] round=5 local utility u=0.000000 metrics={'f1_val': 0.6887810839036039, 'auprc': 0.6610109708043955, 'loss_val': 0.4886818304745959, 'psi': 0.6776730386639206}-{'f1_val': 0.670783802298687, 'auprc': 0.7530464115113445, 'loss_val': 0.6252141916677714, 'psi': 0.70368884598375}
[S5] START round=5 head_norm_before_train=0.972771 cos_to_last_merge=0.9783 (last merge round=1)
[S5] round=5 local utility u=0.052078 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7695663269957189, 'loss_val': 1.1888037429853022, 'psi': 0.39318367365543044}-{'f1_val': 0.14226190476190476, 'auprc': 0.7520092673001797, 'loss_val': 1.2402885973820525, 'psi': 0.38616084977721477}
[S6] START round=5 head_norm_before_train=0.932416 cos_to_last_merge=0.9581 (last merge round=1)
[S6] round=5 local utility u=0.120783 metrics={'f1_val': 0.4169753086419753, 'auprc': 0.794963719270486, 'loss_val': 0.757337686774308, 'psi': 0.5681706728933796}-{'f1_val': 0.4172560359570804, 'auprc': 0.764236610907124, 'loss_val': 0.9084064776274902, 'psi': 0.5560482659370979}
[S7] START round=5 head_norm_before_train=0.777435 cos_to_last_merge=0.9980 (last merge round=3)
[S7] round=5 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.6595539884261741, 'loss_val': 1.2186719810820952, 'psi': 0.3490556890079246}-{'f1_val': 0.14205682272909165, 'auprc': 0.74165831363226, 'loss_val': 1.2565815533090927, 'psi': 0.381897419090359}
[S8] START round=5 head_norm_before_train=0.921331 cos_to_last_merge=1.0000 (last merge round=4)
[S8] round=5 local utility u=1.000000 metrics={'f1_val': 0.709769721876787, 'auprc': 0.776632468413812, 'loss_val': 0.9105102200121384, 'psi': 0.736514820491597}-{'f1_val': 0.39140334724156245, 'auprc': 0.7771068428558265, 'loss_val': 1.0599234467837562, 'psi': 0.5456847454872681}
[S9] START round=5 head_norm_before_train=0.931204 cos_to_last_merge=0.9769 (last merge round=1)
[S9] round=5 local utility u=0.035141 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8634911260291582, 'loss_val': 1.1280250737052142, 'psi': 0.43023522469566094}-{'f1_val': 0.141397957139996, 'auprc': 0.8662160054724479, 'loss_val': 1.206481706140961, 'psi': 0.4313251764729768}
[S10] START round=5 head_norm_before_train=1.352586 (no previous merge yet)
[S10] round=5 local utility u=1.000000 metrics={'f1_val': 0.7014667009264342, 'auprc': 0.9417645195367645, 'loss_val': 0.5678903659183655, 'psi': 0.7975858283705664}-{'f1_val': 0.4170518629654155, 'auprc': 0.8570929278882896, 'loss_val': 0.894577725433438, 'psi': 0.5930682889345651}
[S11] START round=5 head_norm_before_train=0.804486 cos_to_last_merge=0.9964 (last merge round=3)
[S11] round=5 local utility u=0.026559 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.6042044911920447, 'loss_val': 1.1973404810960186, 'psi': 0.3259300065006842}-{'f1_val': 0.14041368337311058, 'auprc': 0.6089829626885733, 'loss_val': 1.2647929131782685, 'psi': 0.32784139509929566}
[S13] START round=5 head_norm_before_train=0.804978 cos_to_last_merge=1.0000 (last merge round=4)
[S13] round=5 local utility u=0.000000 metrics={'f1_val': 0.37164206347340256, 'auprc': 0.6794903938742546, 'loss_val': 0.8321199573091632, 'psi': 0.49478139563374335}-{'f1_val': 0.3723879833594762, 'auprc': 0.7471534397487319, 'loss_val': 0.9069473521441904, 'psi': 0.5222941659151785}
[S14] START round=5 head_norm_before_train=0.936356 cos_to_last_merge=0.9974 (last merge round=3)
[S14] round=5 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.592817308435178, 'loss_val': 1.2020892651259272, 'psi': 0.32134163510369346}-{'f1_val': 0.14035785288270378, 'auprc': 0.7323715019322118, 'loss_val': 1.2580625895726005, 'psi': 0.37716331250250695}
[S15] START round=5 head_norm_before_train=0.817556 cos_to_last_merge=1.0000 (last merge round=4)
[S15] round=5 local utility u=0.000000 metrics={'f1_val': 0.4368738182286977, 'auprc': 0.6758093072689955, 'loss_val': 0.7524300145970088, 'psi': 0.5324480138448169}-{'f1_val': 0.4179372592884578, 'auprc': 0.7995376119795131, 'loss_val': 0.7584792126093804, 'psi': 0.57057740036488}
[S16] START round=5 head_norm_before_train=0.805004 cos_to_last_merge=0.9873 (last merge round=2)
[S16] round=5 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7758440494266073, 'loss_val': 1.2429047929410268, 'psi': 0.3947200898901648}-{'f1_val': 0.14063745019920318, 'auprc': 0.8640258733962907, 'loss_val': 1.2594779376658853, 'psi': 0.42999281947803825}
[S17] START round=5 head_norm_before_train=0.842927 cos_to_last_merge=0.9837 (last merge round=3)
[S17] round=5 local utility u=0.000000 metrics={'f1_val': 0.35195921220828397, 'auprc': 0.7172942869914478, 'loss_val': 0.9898251300700915, 'psi': 0.4980932421215495}-{'f1_val': 0.3922160499017747, 'auprc': 0.7100534934206679, 'loss_val': 0.8936965662590656, 'psi': 0.519351027309332}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.737)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S5] → sending delta(kind=head bytes=1789) to S11@127.0.0.1:52812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:52817
[S2] not sending this round → trigger blocked (psi=0.679)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S6] → sending delta(kind=head bytes=1791) to S17@127.0.0.1:52817
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:52814
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S11] → sending delta(kind=head bytes=1791) to S8@127.0.0.1:52809
[S3] not sending this round → trigger blocked (psi=0.330)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1791 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1791 to 1 peers)
[S5] sending update (kind=head size=1789 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1800) from S10
[S14] cosine check vs S10: cos=0.6984
[S17] RECEIVED delta(kind=head bytes=1791) from S6
[S17] cosine check vs S6: cos=0.2729
[S17] RECEIVED delta(kind=head bytes=1799) from S9
[S17] cosine check vs S9: cos=0.3171
[S8] RECEIVED delta(kind=head bytes=1791) from S11
[S8] cosine check vs S11: cos=0.2263
[S11] RECEIVED delta(kind=head bytes=1789) from S5
[S11] cosine check vs S5: cos=0.5767
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] ⇄ pheromone p=0.471 → S9@127.0.0.1:52810
[S4] ⇄ pheromone p=0.462 → S8@127.0.0.1:52809
[S13] ⇄ pheromone p=0.470 → S7@127.0.0.1:52808
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=5 metric=0.7098 head_norm=0.968975
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.644640e-01
[S8] stored merged vector for next round verification (round=5)
[S8] DEBUG after merge:  round=5 metric=0.4676 head_norm=0.708901 delta_norm=0.564464
[S8] aggregate: ROLLBACK (f1_val pre=0.710 post=0.468 tol_abs=0.005 tol_rel=0.0)
[S8] ⇄ pheromone p=0.669 → S15@127.0.0.1:52815
[S7] ⇄ pheromone p=0.334 → S17@127.0.0.1:52817
[S3] ⇄ pheromone p=0.366 → S11@127.0.0.1:52812
[S2] ⇄ pheromone p=0.593 → S8@127.0.0.1:52809
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=5 metric=0.1404 head_norm=0.972261
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.067458e-01
[S14] stored merged vector for next round verification (round=5)
[S14] DEBUG after merge:  round=5 metric=0.1404 head_norm=1.103676 delta_norm=0.506746
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.328 → S8@127.0.0.1:52809
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=5 metric=0.1404 head_norm=0.838693
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.286609e-01
[S11] stored merged vector for next round verification (round=5)
[S11] DEBUG after merge:  round=5 metric=0.1404 head_norm=0.816614 delta_norm=0.428661
[S11] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.342 → S8@127.0.0.1:52809
[S10] ⇄ pheromone p=0.717 → S14@127.0.0.1:52814
[S9] ⇄ pheromone p=0.344 → S17@127.0.0.1:52817
[S6] ⇄ pheromone p=0.510 → S17@127.0.0.1:52817
[S5] ⇄ pheromone p=0.423 → S11@127.0.0.1:52812
[S16] ⇄ pheromone p=0.383 → S7@127.0.0.1:52808
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=5 metric=0.3520 head_norm=0.940523
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.581438e-01
[S17] stored merged vector for next round verification (round=5)
[S17] DEBUG after merge:  round=5 metric=0.3516 head_norm=0.694997 delta_norm=0.458144
[S17] aggregate: ACCEPT kept=['S6', 'S9'] (k=2/2) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.473 → S13@127.0.0.1:52813
[S2] START round=6 head_norm_before_train=1.432502 (no previous merge yet)
[S2] round=6 local utility u=0.108690 metrics={'f1_val': 0.7016506089258296, 'auprc': 0.6653292838423164, 'loss_val': 0.39042242003868516, 'psi': 0.6871220788924244}-{'f1_val': 0.7018107941894467, 'auprc': 0.6447761339653287, 'loss_val': 0.5471047943571952, 'psi': 0.6789969300997996}
[S3] START round=6 head_norm_before_train=1.274575 (no previous merge yet)
[S3] round=6 local utility u=0.643148 metrics={'f1_val': 0.24505887040752639, 'auprc': 0.7956091678094873, 'loss_val': 1.0029486492418151, 'psi': 0.46527898936831075}-{'f1_val': 0.13984006561410703, 'auprc': 0.6151186599118141, 'loss_val': 1.1164604063369208, 'psi': 0.3299515033331899}
[S4] START round=6 head_norm_before_train=1.504218 (no previous merge yet)
[S4] round=6 local utility u=0.000000 metrics={'f1_val': 0.6656355965427583, 'auprc': 0.6589193890843418, 'loss_val': 0.43713413345610574, 'psi': 0.6629491135593917}-{'f1_val': 0.6887810839036039, 'auprc': 0.6610109708043955, 'loss_val': 0.4886818304745959, 'psi': 0.6776730386639206}
[S5] START round=6 head_norm_before_train=0.998905 cos_to_last_merge=0.9684 (last merge round=1)
[S5] round=6 local utility u=0.864152 metrics={'f1_val': 0.41694544507090897, 'auprc': 0.7718342669625258, 'loss_val': 1.1154045175398908, 'psi': 0.5589009738275557}-{'f1_val': 0.14226190476190476, 'auprc': 0.7695663269957189, 'loss_val': 1.1888037429853022, 'psi': 0.39318367365543044}
[S6] START round=6 head_norm_before_train=1.006855 cos_to_last_merge=0.9364 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.936
[S6] round=6 local utility u=0.678644 metrics={'f1_val': 0.6201275173784461, 'auprc': 0.791720200386689, 'loss_val': 0.6092325646381664, 'psi': 0.6887645905817432}-{'f1_val': 0.4169753086419753, 'auprc': 0.794963719270486, 'loss_val': 0.757337686774308, 'psi': 0.5681706728933796}
[S7] START round=6 head_norm_before_train=0.798164 cos_to_last_merge=0.9937 (last merge round=3)
[S7] round=6 local utility u=0.765593 metrics={'f1_val': 0.416467909967687, 'auprc': 0.5931756249297764, 'loss_val': 1.134818192004242, 'psi': 0.48715099595252276}-{'f1_val': 0.14205682272909165, 'auprc': 0.6595539884261741, 'loss_val': 1.2186719810820952, 'psi': 0.3490556890079246}
[S8] START round=6 head_norm_before_train=0.708901 cos_to_last_merge=1.0000 (last merge round=5)
[S8] round=6 local utility u=0.000000 metrics={'f1_val': 0.4007393942363109, 'auprc': 0.7852070467896649, 'loss_val': 0.8090299805160788, 'psi': 0.5545264552576525}-{'f1_val': 0.709769721876787, 'auprc': 0.776632468413812, 'loss_val': 0.9105102200121384, 'psi': 0.736514820491597}
[S9] START round=6 head_norm_before_train=0.965088 cos_to_last_merge=0.9665 (last merge round=1)
[S9] round=6 local utility u=0.921937 metrics={'f1_val': 0.41637066856105454, 'auprc': 0.8827802940123824, 'loss_val': 0.9918550525712226, 'psi': 0.6029345187415857}-{'f1_val': 0.141397957139996, 'auprc': 0.8634911260291582, 'loss_val': 1.1280250737052142, 'psi': 0.43023522469566094}
[S10] START round=6 head_norm_before_train=1.415801 (no previous merge yet)
[S10] round=6 local utility u=0.183126 metrics={'f1_val': 0.6999338133859518, 'auprc': 0.9974219977163705, 'loss_val': 0.3594143202506614, 'psi': 0.8189290871181194}-{'f1_val': 0.7014667009264342, 'auprc': 0.9417645195367645, 'loss_val': 0.5678903659183655, 'psi': 0.7975858283705664}
[S11] START round=6 head_norm_before_train=0.816614 cos_to_last_merge=1.0000 (last merge round=5)
[S11] round=6 local utility u=0.025643 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.6048737084300512, 'loss_val': 1.1480619504306822, 'psi': 0.32619769339588683}-{'f1_val': 0.14041368337311058, 'auprc': 0.6042044911920447, 'loss_val': 1.1973404810960186, 'psi': 0.3259300065006842}
[S13] START round=6 head_norm_before_train=0.881616 cos_to_last_merge=0.9851 (last merge round=4)
[S13] round=6 local utility u=1.000000 metrics={'f1_val': 0.7115091406168195, 'auprc': 0.7158005522875324, 'loss_val': 0.685886178011962, 'psi': 0.7132257052851046}-{'f1_val': 0.37164206347340256, 'auprc': 0.6794903938742546, 'loss_val': 0.8321199573091632, 'psi': 0.49478139563374335}
[S14] START round=6 head_norm_before_train=1.103676 cos_to_last_merge=1.0000 (last merge round=5)
[S14] round=6 local utility u=0.309662 metrics={'f1_val': 0.15808436162761547, 'auprc': 0.7470675892003558, 'loss_val': 1.1518760446414193, 'psi': 0.39367765265671156}-{'f1_val': 0.14035785288270378, 'auprc': 0.592817308435178, 'loss_val': 1.2020892651259272, 'psi': 0.32134163510369346}
[S15] START round=6 head_norm_before_train=0.897474 cos_to_last_merge=0.9894 (last merge round=4)
[S15] round=6 local utility u=1.000000 metrics={'f1_val': 0.701315205763202, 'auprc': 0.7991188763210706, 'loss_val': 0.5863151356057226, 'psi': 0.7404366739863495}-{'f1_val': 0.4368738182286977, 'auprc': 0.6758093072689955, 'loss_val': 0.7524300145970088, 'psi': 0.5324480138448169}
[S16] START round=6 head_norm_before_train=0.845648 cos_to_last_merge=0.9745 (last merge round=2)
[S16] round=6 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.5987542915752504, 'loss_val': 1.174100810591372, 'psi': 0.32388418674962205}-{'f1_val': 0.14063745019920318, 'auprc': 0.7758440494266073, 'loss_val': 1.2429047929410268, 'psi': 0.3947200898901648}
[S17] START round=6 head_norm_before_train=0.694997 cos_to_last_merge=1.0000 (last merge round=5)
[S17] round=6 local utility u=0.000000 metrics={'f1_val': 0.35236581484865914, 'auprc': 0.655402919398629, 'loss_val': 0.913609091052051, 'psi': 0.4735806566686471}-{'f1_val': 0.35195921220828397, 'auprc': 0.7172942869914478, 'loss_val': 0.9898251300700915, 'psi': 0.4980932421215495}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:52817
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.603)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.559)
[S11] not sending this round → trigger blocked (psi=0.326)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:52812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:52809
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] → sending delta(kind=head bytes=1794) to S7@127.0.0.1:52808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:52810
[S10] not sending this round → trigger blocked (psi=0.819)
[S6] not sending this round → trigger blocked (psi=0.689)
[S15] sending update (kind=head size=1794 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1795 to 1 peers)
[S13] sending update (kind=head size=1794 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1797) from S3
[S11] cosine check vs S3: cos=0.0189
[S8] RECEIVED delta(kind=head bytes=1799) from S2
[S8] cosine check vs S2: cos=0.5292
[S9] RECEIVED delta(kind=head bytes=1794) from S15
[S9] cosine check vs S15: cos=0.0559
[S8] RECEIVED delta(kind=head bytes=1795) from S14
[S8] cosine check vs S14: cos=0.1129
[S17] RECEIVED delta(kind=head bytes=1798) from S7
[S17] cosine check vs S7: cos=0.1390
[S7] RECEIVED delta(kind=head bytes=1794) from S13
[S7] cosine check vs S13: cos=0.4106
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=6 metric=0.4007 head_norm=0.774493
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.316853e-01
[S8] stored merged vector for next round verification (round=6)
[S8] DEBUG after merge:  round=6 metric=0.6959 head_norm=0.737962 delta_norm=0.431685
[S8] aggregate: ACCEPT kept=['S2', 'S14'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=6 metric=0.4164 head_norm=1.002433
[S9] _apply_head_vector_avg (torch): Δ‖w‖=6.863019e-01
[S9] stored merged vector for next round verification (round=6)
[S9] DEBUG after merge:  round=6 metric=0.4365 head_norm=0.725782 delta_norm=0.686302
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=6 metric=0.1404 head_norm=0.840121
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.674711e-01
[S11] stored merged vector for next round verification (round=6)
[S11] DEBUG after merge:  round=6 metric=0.1855 head_norm=0.780840 delta_norm=0.767471
[S11] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=6 metric=0.4165 head_norm=0.831232
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.888340e-01
[S7] stored merged vector for next round verification (round=6)
[S7] DEBUG after merge:  round=6 metric=0.1421 head_norm=0.752503 delta_norm=0.488834
[S7] aggregate: ROLLBACK (f1_val pre=0.416 post=0.142 tol_abs=0.005 tol_rel=0.0)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=6 metric=0.3524 head_norm=0.788771
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.316932e-01
[S17] stored merged vector for next round verification (round=6)
[S17] DEBUG after merge:  round=6 metric=0.3523 head_norm=0.611437 delta_norm=0.531693
[S17] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=7 head_norm_before_train=1.509338 (no previous merge yet)
[S2] round=7 local utility u=0.021850 metrics={'f1_val': 0.6999461206362424, 'auprc': 0.6669572200250659, 'loss_val': 0.34137900979981806, 'psi': 0.6867505603917718}-{'f1_val': 0.7016506089258296, 'auprc': 0.6653292838423164, 'loss_val': 0.39042242003868516, 'psi': 0.6871220788924244}
[S3] START round=7 head_norm_before_train=1.300631 (no previous merge yet)
[S3] round=7 local utility u=1.000000 metrics={'f1_val': 0.6962372125553103, 'auprc': 0.7961477574623599, 'loss_val': 0.8546562445916902, 'psi': 0.7362014305181301}-{'f1_val': 0.24505887040752639, 'auprc': 0.7956091678094873, 'loss_val': 1.0029486492418151, 'psi': 0.46527898936831075}
[S4] START round=7 head_norm_before_train=1.588002 (no previous merge yet)
[S4] round=7 local utility u=0.266035 metrics={'f1_val': 0.6655828826364671, 'auprc': 0.8553043408668972, 'loss_val': 0.49390188865063056, 'psi': 0.7414714659286392}-{'f1_val': 0.6656355965427583, 'auprc': 0.6589193890843418, 'loss_val': 0.43713413345610574, 'psi': 0.6629491135593917}
[S5] START round=7 head_norm_before_train=1.021309 cos_to_last_merge=0.9606 (last merge round=1)
[S5] round=7 local utility u=0.069555 metrics={'f1_val': 0.41782980503278466, 'auprc': 0.7777977447859147, 'loss_val': 0.9994916448671148, 'psi': 0.5618169809340366}-{'f1_val': 0.41694544507090897, 'auprc': 0.7718342669625258, 'loss_val': 1.1154045175398908, 'psi': 0.5589009738275557}
[S6] START round=7 head_norm_before_train=1.078620 cos_to_last_merge=0.9135 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.914
[S6] round=7 local utility u=0.615517 metrics={'f1_val': 0.7026415262338399, 'auprc': 0.9743828751659657, 'loss_val': 0.4212698877787961, 'psi': 0.8113380658066902}-{'f1_val': 0.6201275173784461, 'auprc': 0.791720200386689, 'loss_val': 0.6092325646381664, 'psi': 0.6887645905817432}
[S7] START round=7 head_norm_before_train=0.752503 cos_to_last_merge=1.0000 (last merge round=6)
[S7] round=7 local utility u=0.061763 metrics={'f1_val': 0.4170778520170104, 'auprc': 0.6018615208407012, 'loss_val': 1.0410104817572055, 'psi': 0.4909913195464868}-{'f1_val': 0.416467909967687, 'auprc': 0.5931756249297764, 'loss_val': 1.134818192004242, 'psi': 0.48715099595252276}
[S8] START round=7 head_norm_before_train=0.737962 cos_to_last_merge=1.0000 (last merge round=6)
[S8] round=7 local utility u=0.946393 metrics={'f1_val': 0.6957053916854523, 'auprc': 0.7942947749539607, 'loss_val': 0.7133032461115903, 'psi': 0.7351411449928558}-{'f1_val': 0.4007393942363109, 'auprc': 0.7852070467896649, 'loss_val': 0.8090299805160788, 'psi': 0.5545264552576525}
[S9] START round=7 head_norm_before_train=0.725782 cos_to_last_merge=1.0000 (last merge round=6)
[S9] round=7 local utility u=0.200123 metrics={'f1_val': 0.4169327861386615, 'auprc': 0.9934987514230033, 'loss_val': 0.9271378938509965, 'psi': 0.6475591722523982}-{'f1_val': 0.41637066856105454, 'auprc': 0.8827802940123824, 'loss_val': 0.9918550525712226, 'psi': 0.6029345187415857}
[S10] START round=7 head_norm_before_train=1.494404 (no previous merge yet)
[S10] round=7 local utility u=0.000000 metrics={'f1_val': 0.6888879679487039, 'auprc': 0.9844647772164273, 'loss_val': 0.2750403320824379, 'psi': 0.8071186916557933}-{'f1_val': 0.6999338133859518, 'auprc': 0.9974219977163705, 'loss_val': 0.3594143202506614, 'psi': 0.8189290871181194}
[S11] START round=7 head_norm_before_train=0.780840 cos_to_last_merge=1.0000 (last merge round=6)
[S11] round=7 local utility u=1.000000 metrics={'f1_val': 0.39686005108508027, 'auprc': 0.7949371123540103, 'loss_val': 1.0832578268481325, 'psi': 0.5560908755926524}-{'f1_val': 0.14041368337311058, 'auprc': 0.6048737084300512, 'loss_val': 1.1480619504306822, 'psi': 0.32619769339588683}
[S13] START round=7 head_norm_before_train=0.958901 cos_to_last_merge=0.9607 (last merge round=4)
[S13] round=7 local utility u=0.000000 metrics={'f1_val': 0.7029681996494106, 'auprc': 0.6909908945862822, 'loss_val': 0.6015126118651402, 'psi': 0.6981772776241593}-{'f1_val': 0.7115091406168195, 'auprc': 0.7158005522875324, 'loss_val': 0.685886178011962, 'psi': 0.7132257052851046}
[S14] START round=7 head_norm_before_train=1.119279 cos_to_last_merge=0.9979 (last merge round=5)
[S14] round=7 local utility u=1.000000 metrics={'f1_val': 0.6699726204878154, 'auprc': 0.7900583074133941, 'loss_val': 1.0079674753267203, 'psi': 0.718006895258047}-{'f1_val': 0.15808436162761547, 'auprc': 0.7470675892003558, 'loss_val': 1.1518760446414193, 'psi': 0.39367765265671156}
[S15] START round=7 head_norm_before_train=0.995323 cos_to_last_merge=0.9658 (last merge round=4)
[S15] round=7 local utility u=0.124634 metrics={'f1_val': 0.7013127984932164, 'auprc': 0.8253719726367698, 'loss_val': 0.41579162534001607, 'psi': 0.7509364681506376}-{'f1_val': 0.701315205763202, 'auprc': 0.7991188763210706, 'loss_val': 0.5863151356057226, 'psi': 0.7404366739863495}
[S16] START round=7 head_norm_before_train=0.874197 cos_to_last_merge=0.9648 (last merge round=2)
[S16] round=7 local utility u=0.817493 metrics={'f1_val': 0.41605479710452475, 'auprc': 0.5682775859767331, 'loss_val': 1.1001879923421878, 'psi': 0.4769439126534081}-{'f1_val': 0.14063745019920318, 'auprc': 0.5987542915752504, 'loss_val': 1.174100810591372, 'psi': 0.32388418674962205}
[S17] START round=7 head_norm_before_train=0.611437 cos_to_last_merge=1.0000 (last merge round=6)
[S17] round=7 local utility u=0.000000 metrics={'f1_val': 0.3536207091334382, 'auprc': 0.6191308461535058, 'loss_val': 0.9069623177639605, 'psi': 0.4598247639414652}-{'f1_val': 0.35236581484865914, 'auprc': 0.655402919398629, 'loss_val': 0.913609091052051, 'psi': 0.4735806566686471}
[S3] not sending this round → trigger blocked (psi=0.736)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.751)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:52809
[S14] not sending this round → trigger blocked (psi=0.718)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:52815
[S7] not sending this round → trigger blocked (psi=0.491)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:52812
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.687)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:52808
[S5] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1798) from S6
[S17] cosine check vs S6: cos=0.3332
[S15] RECEIVED delta(kind=head bytes=1798) from S8
[S15] cosine check vs S8: cos=0.3174
[S17] RECEIVED delta(kind=head bytes=1800) from S9
[S17] cosine check vs S9: cos=0.3842
[S8] RECEIVED delta(kind=head bytes=1796) from S4
[S8] cosine check vs S4: cos=-0.0801
[S8] DROPPED delta from S4 (cos=-0.0801 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1797) from S11
[S8] cosine check vs S11: cos=0.2133
[S7] RECEIVED delta(kind=head bytes=1798) from S16
[S7] cosine check vs S16: cos=0.1610
[S11] RECEIVED delta(kind=head bytes=1796) from S5
[S11] cosine check vs S5: cos=0.5224
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=7 metric=0.4171 head_norm=0.780828
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.492301e-01
[S7] stored merged vector for next round verification (round=7)
[S7] DEBUG after merge:  round=7 metric=0.4128 head_norm=0.644905 delta_norm=0.549230
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=7 metric=0.3969 head_norm=0.808756
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.684481e-01
[S11] stored merged vector for next round verification (round=7)
[S11] DEBUG after merge:  round=7 metric=0.4222 head_norm=0.815982 delta_norm=0.468448
[S11] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=7 metric=0.6957 head_norm=0.805745
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.063025e-01
[S8] stored merged vector for next round verification (round=7)
[S8] DEBUG after merge:  round=7 metric=0.6957 head_norm=0.628740 delta_norm=0.506303
[S8] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=7 metric=0.3536 head_norm=0.725365
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.596645e-01
[S17] stored merged vector for next round verification (round=7)
[S17] DEBUG after merge:  round=7 metric=0.3536 head_norm=0.613140 delta_norm=0.359664
[S17] aggregate: ACCEPT kept=['S6', 'S9'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=7 metric=0.7013 head_norm=1.092871
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.667068e-01
[S15] stored merged vector for next round verification (round=7)
[S15] DEBUG after merge:  round=7 metric=0.7013 head_norm=0.775010 delta_norm=0.566707
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=1.567242 (no previous merge yet)
[S2] round=8 local utility u=0.000000 metrics={'f1_val': 0.7013104596155267, 'auprc': 0.6688964834419655, 'loss_val': 0.37033564494951643, 'psi': 0.6883448691461023}-{'f1_val': 0.6999461206362424, 'auprc': 0.6669572200250659, 'loss_val': 0.34137900979981806, 'psi': 0.6867505603917718}
[S3] START round=8 head_norm_before_train=1.336831 (no previous merge yet)
[S3] round=8 local utility u=0.000000 metrics={'f1_val': 0.6423099435964327, 'auprc': 0.795942197349652, 'loss_val': 0.7381253725463511, 'psi': 0.7037628450977205}-{'f1_val': 0.6962372125553103, 'auprc': 0.7961477574623599, 'loss_val': 0.8546562445916902, 'psi': 0.7362014305181301}
[S4] START round=8 head_norm_before_train=1.647551 (no previous merge yet)
[S4] round=8 local utility u=0.144978 metrics={'f1_val': 0.669557973297922, 'auprc': 0.9458289510207981, 'loss_val': 0.49936931970622256, 'psi': 0.7800663643870724}-{'f1_val': 0.6655828826364671, 'auprc': 0.8553043408668972, 'loss_val': 0.49390188865063056, 'psi': 0.7414714659286392}
[S5] START round=8 head_norm_before_train=1.056623 cos_to_last_merge=0.9489 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.949
[S5] round=8 local utility u=0.067284 metrics={'f1_val': 0.4176671856330787, 'auprc': 0.7776116662652753, 'loss_val': 0.8633895186512857, 'psi': 0.5616449778859574}-{'f1_val': 0.41782980503278466, 'auprc': 0.7777977447859147, 'loss_val': 0.9994916448671148, 'psi': 0.5618169809340366}
[S6] START round=8 head_norm_before_train=1.152354 cos_to_last_merge=0.8937 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.894
[S6] round=8 local utility u=0.000000 metrics={'f1_val': 0.6612537946328059, 'auprc': 0.7745269779633721, 'loss_val': 0.5548393876433135, 'psi': 0.7065630679650323}-{'f1_val': 0.7026415262338399, 'auprc': 0.9743828751659657, 'loss_val': 0.4212698877787961, 'psi': 0.8113380658066902}
[S7] START round=8 head_norm_before_train=0.644905 cos_to_last_merge=1.0000 (last merge round=7)
[S7] round=8 local utility u=0.000000 metrics={'f1_val': 0.4169130971024577, 'auprc': 0.5685622025859735, 'loss_val': 1.0129619168564339, 'psi': 0.477572739295864}-{'f1_val': 0.4170778520170104, 'auprc': 0.6018615208407012, 'loss_val': 1.0410104817572055, 'psi': 0.4909913195464868}
[S8] START round=8 head_norm_before_train=0.628740 cos_to_last_merge=1.0000 (last merge round=7)
[S8] round=8 local utility u=0.381480 metrics={'f1_val': 0.705337233744213, 'auprc': 0.9976233837280877, 'loss_val': 0.6181198131637803, 'psi': 0.8222516937377629}-{'f1_val': 0.6957053916854523, 'auprc': 0.7942947749539607, 'loss_val': 0.7133032461115903, 'psi': 0.7351411449928558}
[S9] START round=8 head_norm_before_train=0.770244 cos_to_last_merge=0.9958 (last merge round=6)
[S9] round=8 local utility u=0.000000 metrics={'f1_val': 0.4167327429296869, 'auprc': 0.8485648784624167, 'loss_val': 0.7906927432261507, 'psi': 0.5894655971427788}-{'f1_val': 0.4169327861386615, 'auprc': 0.9934987514230033, 'loss_val': 0.9271378938509965, 'psi': 0.6475591722523982}
[S10] START round=8 head_norm_before_train=1.562423 (no previous merge yet)
[S10] round=8 local utility u=0.103672 metrics={'f1_val': 0.7007525356214388, 'auprc': 0.9978204847037699, 'loss_val': 0.17895157118396998, 'psi': 0.8195797152543713}-{'f1_val': 0.6888879679487039, 'auprc': 0.9844647772164273, 'loss_val': 0.2750403320824379, 'psi': 0.8071186916557933}
[S11] START round=8 head_norm_before_train=0.815982 cos_to_last_merge=1.0000 (last merge round=7)
[S11] round=8 local utility u=0.000000 metrics={'f1_val': 0.39658602128368947, 'auprc': 0.7354824000371165, 'loss_val': 0.9670519144797668, 'psi': 0.5321445727850603}-{'f1_val': 0.39686005108508027, 'auprc': 0.7949371123540103, 'loss_val': 1.0832578268481325, 'psi': 0.5560908755926524}
[S13] START round=8 head_norm_before_train=1.025995 cos_to_last_merge=0.9400 (last merge round=4)
[S13] ⚠️ Model drifted since last merge! cos=0.940
[S13] round=8 local utility u=0.000000 metrics={'f1_val': 0.6534811493491122, 'auprc': 0.6778007136019362, 'loss_val': 0.5658940794266393, 'psi': 0.6632089750502418}-{'f1_val': 0.7029681996494106, 'auprc': 0.6909908945862822, 'loss_val': 0.6015126118651402, 'psi': 0.6981772776241593}
[S14] START round=8 head_norm_before_train=1.148252 cos_to_last_merge=0.9910 (last merge round=5)
[S14] round=8 local utility u=0.000000 metrics={'f1_val': 0.5045609611619217, 'auprc': 0.9812648495754818, 'loss_val': 0.8543010444669785, 'psi': 0.6952425165273457}-{'f1_val': 0.6699726204878154, 'auprc': 0.7900583074133941, 'loss_val': 1.0079674753267203, 'psi': 0.718006895258047}
[S15] START round=8 head_norm_before_train=0.775010 cos_to_last_merge=1.0000 (last merge round=7)
[S15] round=8 local utility u=0.000000 metrics={'f1_val': 0.7004597157501931, 'auprc': 0.8339074528092707, 'loss_val': 0.4552544397049641, 'psi': 0.7538388105738241}-{'f1_val': 0.7013127984932164, 'auprc': 0.8253719726367698, 'loss_val': 0.41579162534001607, 'psi': 0.7509364681506376}
[S16] START round=8 head_norm_before_train=0.908526 cos_to_last_merge=0.9514 (last merge round=2)
[S16] round=8 local utility u=0.042235 metrics={'f1_val': 0.4175811969315686, 'auprc': 0.5496013703752358, 'loss_val': 0.9688477412489748, 'psi': 0.4703892663090355}-{'f1_val': 0.41605479710452475, 'auprc': 0.5682775859767331, 'loss_val': 1.1001879923421878, 'psi': 0.4769439126534081}
[S17] START round=8 head_norm_before_train=0.613140 cos_to_last_merge=1.0000 (last merge round=7)
[S17] round=8 local utility u=0.138307 metrics={'f1_val': 0.3975147710860809, 'auprc': 0.6249594424287126, 'loss_val': 0.9111986090048885, 'psi': 0.4884926396231336}-{'f1_val': 0.3536207091334382, 'auprc': 0.6191308461535058, 'loss_val': 0.9069623177639605, 'psi': 0.4598247639414652}
[S8] not sending this round → trigger blocked (psi=0.822)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.780)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.562)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:52814
[S16] not sending this round → trigger blocked (psi=0.470)
[S10] sending update (kind=head size=1803 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1803) from S10
[S14] cosine check vs S10: cos=0.8814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:52813
[S17] sending update (kind=head size=1798 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1798) from S17
[S13] cosine check vs S17: cos=0.4760
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=8 metric=0.5046 head_norm=1.189125
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.968540e-01
[S14] stored merged vector for next round verification (round=8)
[S14] DEBUG after merge:  round=8 metric=0.3151 head_norm=1.357908 delta_norm=0.396854
[S14] aggregate: ROLLBACK (f1_val pre=0.505 post=0.315 tol_abs=0.005 tol_rel=0.0)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=8 metric=0.6535 head_norm=1.089226
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.899492e-01
[S13] stored merged vector for next round verification (round=8)
[S13] DEBUG after merge:  round=8 metric=0.6631 head_norm=0.784689 delta_norm=0.489949
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=1.612942 (no previous merge yet)
[S2] round=9 local utility u=0.000000 metrics={'f1_val': 0.7015644331403206, 'auprc': 0.6654569962002514, 'loss_val': 0.3745146081165981, 'psi': 0.6871214583642928}-{'f1_val': 0.7013104596155267, 'auprc': 0.6688964834419655, 'loss_val': 0.37033564494951643, 'psi': 0.6883448691461023}
[S3] START round=9 head_norm_before_train=1.379159 (no previous merge yet)
[S3] round=9 local utility u=0.223620 metrics={'f1_val': 0.6993228192077114, 'auprc': 0.7957953483499993, 'loss_val': 0.632521888764562, 'psi': 0.7379118308646266}-{'f1_val': 0.6423099435964327, 'auprc': 0.795942197349652, 'loss_val': 0.7381253725463511, 'psi': 0.7037628450977205}
[S4] START round=9 head_norm_before_train=1.688885 (no previous merge yet)
[S4] round=9 local utility u=0.000000 metrics={'f1_val': 0.6211019263617317, 'auprc': 0.9483313040634753, 'loss_val': 0.49383461821466434, 'psi': 0.7519936774424292}-{'f1_val': 0.669557973297922, 'auprc': 0.9458289510207981, 'loss_val': 0.49936931970622256, 'psi': 0.7800663643870724}
[S5] START round=9 head_norm_before_train=1.101632 cos_to_last_merge=0.9333 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.933
[S5] round=9 local utility u=0.764094 metrics={'f1_val': 0.6529261512045073, 'auprc': 0.7774294453778552, 'loss_val': 0.7462088674418774, 'psi': 0.7027274688738464}-{'f1_val': 0.4176671856330787, 'auprc': 0.7776116662652753, 'loss_val': 0.8633895186512857, 'psi': 0.5616449778859574}
[S6] START round=9 head_norm_before_train=1.207746 cos_to_last_merge=0.8829 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.883
[S6] round=9 local utility u=0.533759 metrics={'f1_val': 0.7101023317538621, 'auprc': 0.9605268935026616, 'loss_val': 0.33841146635894126, 'psi': 0.8102721564533819}-{'f1_val': 0.6612537946328059, 'auprc': 0.7745269779633721, 'loss_val': 0.5548393876433135, 'psi': 0.7065630679650323}
[S7] START round=9 head_norm_before_train=0.681445 cos_to_last_merge=0.9948 (last merge round=7)
[S7] round=9 local utility u=0.000000 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.4790301087034981, 'loss_val': 0.922462170620713, 'psi': 0.4416381143480133}-{'f1_val': 0.4169130971024577, 'auprc': 0.5685622025859735, 'loss_val': 1.0129619168564339, 'psi': 0.477572739295864}
[S8] START round=9 head_norm_before_train=0.712441 cos_to_last_merge=0.9783 (last merge round=7)
[S8] round=9 local utility u=0.086759 metrics={'f1_val': 0.701432261124125, 'auprc': 0.9976294182136562, 'loss_val': 0.42118909574954666, 'psi': 0.8199111239599375}-{'f1_val': 0.705337233744213, 'auprc': 0.9976233837280877, 'loss_val': 0.6181198131637803, 'psi': 0.8222516937377629}
[S9] START round=9 head_norm_before_train=0.829508 cos_to_last_merge=0.9825 (last merge round=6)
[S9] round=9 local utility u=1.000000 metrics={'f1_val': 0.700796407679956, 'auprc': 0.9992323684877671, 'loss_val': 0.5508543227756755, 'psi': 0.8201707920030805}-{'f1_val': 0.4167327429296869, 'auprc': 0.8485648784624167, 'loss_val': 0.7906927432261507, 'psi': 0.5894655971427788}
[S10] START round=9 head_norm_before_train=1.608973 (no previous merge yet)
[S10] round=9 local utility u=0.912221 metrics={'f1_val': 0.9957531238588277, 'auprc': 0.9979199716533975, 'loss_val': 0.12481060531385262, 'psi': 0.9966198629766557}-{'f1_val': 0.7007525356214388, 'auprc': 0.9978204847037699, 'loss_val': 0.17895157118396998, 'psi': 0.8195797152543713}
[S11] START round=9 head_norm_before_train=0.849295 cos_to_last_merge=0.9920 (last merge round=7)
[S11] round=9 local utility u=0.196888 metrics={'f1_val': 0.3907005960072405, 'auprc': 0.8360207943152322, 'loss_val': 0.8395794018976445, 'psi': 0.5688286753304372}-{'f1_val': 0.39658602128368947, 'auprc': 0.7354824000371165, 'loss_val': 0.9670519144797668, 'psi': 0.5321445727850603}
[S13] START round=9 head_norm_before_train=0.784689 cos_to_last_merge=1.0000 (last merge round=8)
[S13] round=9 local utility u=0.000000 metrics={'f1_val': 0.5980239289525746, 'auprc': 0.6794576197232913, 'loss_val': 0.7238625220756661, 'psi': 0.6305974052608614}-{'f1_val': 0.6534811493491122, 'auprc': 0.6778007136019362, 'loss_val': 0.5658940794266393, 'psi': 0.6632089750502418}
[S14] START round=9 head_norm_before_train=1.357908 cos_to_last_merge=1.0000 (last merge round=8)
[S14] round=9 local utility u=0.000000 metrics={'f1_val': 0.38473545872113096, 'auprc': 0.9943170389378652, 'loss_val': 0.7937108392349146, 'psi': 0.6285680908078246}-{'f1_val': 0.5045609611619217, 'auprc': 0.9812648495754818, 'loss_val': 0.8543010444669785, 'psi': 0.6952425165273457}
[S15] START round=9 head_norm_before_train=0.878208 cos_to_last_merge=0.9906 (last merge round=7)
[S15] round=9 local utility u=0.135660 metrics={'f1_val': 0.7013097945345418, 'auprc': 0.8916870061761977, 'loss_val': 0.36237346304076673, 'psi': 0.7774606791912042}-{'f1_val': 0.7004597157501931, 'auprc': 0.8339074528092707, 'loss_val': 0.4552544397049641, 'psi': 0.7538388105738241}
[S16] START round=9 head_norm_before_train=0.952949 cos_to_last_merge=0.9335 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.934
[S16] round=9 local utility u=0.131553 metrics={'f1_val': 0.3508286060660811, 'auprc': 0.7563955677012544, 'loss_val': 0.9256080988148744, 'psi': 0.5130553907201504}-{'f1_val': 0.4175811969315686, 'auprc': 0.5496013703752358, 'loss_val': 0.9688477412489748, 'psi': 0.4703892663090355}
[S17] START round=9 head_norm_before_train=0.724679 cos_to_last_merge=0.9663 (last merge round=7)
[S17] round=9 local utility u=0.000000 metrics={'f1_val': 0.3894187570435932, 'auprc': 0.6057449553755384, 'loss_val': 0.9151646690759355, 'psi': 0.47594923637637127}-{'f1_val': 0.3975147710860809, 'auprc': 0.6249594424287126, 'loss_val': 0.9111986090048885, 'psi': 0.4884926396231336}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S10] → sending delta(kind=head bytes=1808) to S14@127.0.0.1:52814
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S6] → sending delta(kind=head bytes=1806) to S17@127.0.0.1:52817
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] → sending delta(kind=head bytes=1793) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:52812
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:52810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:52812
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] → sending delta(kind=head bytes=1793) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S16] → sending delta(kind=head bytes=1791) to S7@127.0.0.1:52808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:52815
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1793 to 1 peers)
[S16] sending update (kind=head size=1791 to 1 peers)
[S9] sending update (kind=head size=1793 to 1 peers)
[S6] sending update (kind=head size=1806 to 1 peers)
[S10] sending update (kind=head size=1808 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1793) from S9
[S17] cosine check vs S9: cos=0.4163
[S17] RECEIVED delta(kind=head bytes=1806) from S6
[S17] cosine check vs S6: cos=0.5188
[S7] RECEIVED delta(kind=head bytes=1791) from S16
[S7] cosine check vs S16: cos=0.7583
[S14] RECEIVED delta(kind=head bytes=1808) from S10
[S14] cosine check vs S10: cos=0.9651
[S15] RECEIVED delta(kind=head bytes=1799) from S8
[S15] cosine check vs S8: cos=0.5276
[S11] RECEIVED delta(kind=head bytes=1798) from S5
[S11] cosine check vs S5: cos=0.8429
[S8] RECEIVED delta(kind=head bytes=1793) from S11
[S8] cosine check vs S11: cos=0.6143
[S9] RECEIVED delta(kind=head bytes=1796) from S15
[S9] cosine check vs S15: cos=0.6133
[S11] RECEIVED delta(kind=head bytes=1798) from S3
[S11] cosine check vs S3: cos=0.4382
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=9 metric=0.4167 head_norm=0.723771
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.284916e-01
[S7] stored merged vector for next round verification (round=9)
[S7] DEBUG after merge:  round=9 metric=0.4168 head_norm=0.812445 delta_norm=0.328492
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=9 metric=0.3847 head_norm=1.389847
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.383246e-01
[S14] stored merged vector for next round verification (round=9)
[S14] DEBUG after merge:  round=9 metric=0.3151 head_norm=1.506147 delta_norm=0.238325
[S14] aggregate: ROLLBACK (f1_val pre=0.385 post=0.315 tol_abs=0.005 tol_rel=0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=9 metric=0.7014 head_norm=0.823574
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.790895e-01
[S8] stored merged vector for next round verification (round=9)
[S8] DEBUG after merge:  round=9 metric=0.9967 head_norm=0.772789 delta_norm=0.379090
[S8] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=9 metric=0.7008 head_norm=0.887968
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.162732e-01
[S9] stored merged vector for next round verification (round=9)
[S9] DEBUG after merge:  round=9 metric=0.6885 head_norm=0.845100 delta_norm=0.416273
[S9] aggregate: ROLLBACK (f1_val pre=0.701 post=0.689 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=9 metric=0.7013 head_norm=0.993210
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.476426e-01
[S15] stored merged vector for next round verification (round=9)
[S15] DEBUG after merge:  round=9 metric=0.7012 head_norm=0.794975 delta_norm=0.447643
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=9 metric=0.3907 head_norm=0.896409
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.708180e-01
[S11] stored merged vector for next round verification (round=9)
[S11] DEBUG after merge:  round=9 metric=0.3907 head_norm=0.887215 delta_norm=0.270818
[S11] aggregate: ACCEPT kept=['S5', 'S3'] (k=2/2) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=9 metric=0.3894 head_norm=0.827664
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.300381e-01
[S17] stored merged vector for next round verification (round=9)
[S17] DEBUG after merge:  round=9 metric=0.3524 head_norm=0.729384 delta_norm=0.330038
[S17] aggregate: ROLLBACK (f1_val pre=0.389 post=0.352 tol_abs=0.005 tol_rel=0.0)
[S2] START round=10 head_norm_before_train=1.647877 (no previous merge yet)
[S2] round=10 local utility u=0.000000 metrics={'f1_val': 0.574004272101331, 'auprc': 0.6446952138724431, 'loss_val': 0.7007599737737097, 'psi': 0.6022806488097758}-{'f1_val': 0.7015644331403206, 'auprc': 0.6654569962002514, 'loss_val': 0.3745146081165981, 'psi': 0.6871214583642928}
[S3] START round=10 head_norm_before_train=1.428107 (no previous merge yet)
[S3] round=10 local utility u=0.071271 metrics={'f1_val': 0.6871113738022745, 'auprc': 0.863730095279915, 'loss_val': 0.6205151877057805, 'psi': 0.7577588623933307}-{'f1_val': 0.6993228192077114, 'auprc': 0.7957953483499993, 'loss_val': 0.632521888764562, 'psi': 0.7379118308646266}
[S4] START round=10 head_norm_before_train=1.726661 (no previous merge yet)
[S4] round=10 local utility u=0.000000 metrics={'f1_val': 0.6201712909378901, 'auprc': 0.9464485141921124, 'loss_val': 0.48470249412489474, 'psi': 0.7506821802395791}-{'f1_val': 0.6211019263617317, 'auprc': 0.9483313040634753, 'loss_val': 0.49383461821466434, 'psi': 0.7519936774424292}
[S5] START round=10 head_norm_before_train=1.146926 cos_to_last_merge=0.9164 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.916
[S5] round=10 local utility u=0.000000 metrics={'f1_val': 0.6218113726447786, 'auprc': 0.794090879398614, 'loss_val': 0.6810086576577752, 'psi': 0.6907231753463128}-{'f1_val': 0.6529261512045073, 'auprc': 0.7774294453778552, 'loss_val': 0.7462088674418774, 'psi': 0.7027274688738464}
[S6] START round=10 head_norm_before_train=1.257889 cos_to_last_merge=0.8728 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.873
[S6] round=10 local utility u=0.000000 metrics={'f1_val': 0.6217686126727133, 'auprc': 0.7781027154698124, 'loss_val': 0.5423318505472313, 'psi': 0.684302253791553}-{'f1_val': 0.7101023317538621, 'auprc': 0.9605268935026616, 'loss_val': 0.33841146635894126, 'psi': 0.8102721564533819}
[S7] START round=10 head_norm_before_train=0.812445 cos_to_last_merge=1.0000 (last merge round=9)
[S7] round=10 local utility u=0.000000 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.4577644627616692, 'loss_val': 0.9178001838139016, 'psi': 0.43313185597128173}-{'f1_val': 0.41671011811102343, 'auprc': 0.4790301087034981, 'loss_val': 0.922462170620713, 'psi': 0.4416381143480133}
[S8] START round=10 head_norm_before_train=0.772789 cos_to_last_merge=1.0000 (last merge round=9)
[S8] round=10 local utility u=0.748292 metrics={'f1_val': 0.9506657104821837, 'auprc': 0.9960089084740151, 'loss_val': 0.41514499933382126, 'psi': 0.9688029896789163}-{'f1_val': 0.701432261124125, 'auprc': 0.9976294182136562, 'loss_val': 0.42118909574954666, 'psi': 0.8199111239599375}
[S9] START round=10 head_norm_before_train=0.845100 cos_to_last_merge=1.0000 (last merge round=9)
[S9] round=10 local utility u=0.002336 metrics={'f1_val': 0.7017906989076834, 'auprc': 0.9988330316803176, 'loss_val': 0.5509503430377154, 'psi': 0.820607632016737}-{'f1_val': 0.700796407679956, 'auprc': 0.9992323684877671, 'loss_val': 0.5508543227756755, 'psi': 0.8201707920030805}
[S10] START round=10 head_norm_before_train=1.648903 (no previous merge yet)
[S10] round=10 local utility u=0.017006 metrics={'f1_val': 0.9960202599216732, 'auprc': 0.9968873087753546, 'loss_val': 0.08930430535940614, 'psi': 0.9963670794631457}-{'f1_val': 0.9957531238588277, 'auprc': 0.9979199716533975, 'loss_val': 0.12481060531385262, 'psi': 0.9966198629766557}
[S11] START round=10 head_norm_before_train=0.887215 cos_to_last_merge=1.0000 (last merge round=9)
[S11] round=10 local utility u=0.744416 metrics={'f1_val': 0.6033306461877891, 'auprc': 0.8719606828203572, 'loss_val': 0.7343467869223577, 'psi': 0.7107826608408163}-{'f1_val': 0.3907005960072405, 'auprc': 0.8360207943152322, 'loss_val': 0.8395794018976445, 'psi': 0.5688286753304372}
[S13] START round=10 head_norm_before_train=0.850953 cos_to_last_merge=0.9950 (last merge round=8)
[S13] round=10 local utility u=0.105517 metrics={'f1_val': 0.6145417687450047, 'auprc': 0.686914089344853, 'loss_val': 0.6343054722311582, 'psi': 0.643490696984944}-{'f1_val': 0.5980239289525746, 'auprc': 0.6794576197232913, 'loss_val': 0.7238625220756661, 'psi': 0.6305974052608614}
[S14] START round=10 head_norm_before_train=1.506147 cos_to_last_merge=1.0000 (last merge round=9)
[S14] round=10 local utility u=1.000000 metrics={'f1_val': 0.9661413532265255, 'auprc': 0.9971556085050677, 'loss_val': 0.6683135197779998, 'psi': 0.9785470553379423}-{'f1_val': 0.38473545872113096, 'auprc': 0.9943170389378652, 'loss_val': 0.7937108392349146, 'psi': 0.6285680908078246}
[S15] START round=10 head_norm_before_train=0.794975 cos_to_last_merge=1.0000 (last merge round=9)
[S15] round=10 local utility u=0.000000 metrics={'f1_val': 0.6992965014272702, 'auprc': 0.8102136749104638, 'loss_val': 0.4473937694399673, 'psi': 0.7436633708205476}-{'f1_val': 0.7013097945345418, 'auprc': 0.8916870061761977, 'loss_val': 0.36237346304076673, 'psi': 0.7774606791912042}
[S16] START round=10 head_norm_before_train=1.006033 cos_to_last_merge=0.9134 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.913
[S16] round=10 local utility u=0.294511 metrics={'f1_val': 0.4376418734983624, 'auprc': 0.7453202806258686, 'loss_val': 0.8242406640746541, 'psi': 0.560713236349365}-{'f1_val': 0.3508286060660811, 'auprc': 0.7563955677012544, 'loss_val': 0.9256080988148744, 'psi': 0.5130553907201504}
[S17] START round=10 head_norm_before_train=0.729384 cos_to_last_merge=1.0000 (last merge round=9)
[S17] round=10 local utility u=0.000000 metrics={'f1_val': 0.14295200525969756, 'auprc': 0.5613550516307789, 'loss_val': 1.6536906553267297, 'psi': 0.3103132238081301}-{'f1_val': 0.3894187570435932, 'auprc': 0.6057449553755384, 'loss_val': 0.9151646690759355, 'psi': 0.47594923637637127}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:52808
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:52814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:52815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:52817
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] → sending delta(kind=head bytes=1794) to S7@127.0.0.1:52808
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:52812
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1794 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1801) from S3
[S11] cosine check vs S3: cos=0.6397
[S14] RECEIVED delta(kind=head bytes=1800) from S10
[S14] cosine check vs S10: cos=0.9847
[S15] RECEIVED delta(kind=head bytes=1803) from S8
[S15] cosine check vs S8: cos=0.6638
[S17] RECEIVED delta(kind=head bytes=1799) from S9
[S17] cosine check vs S9: cos=0.4522
[S7] RECEIVED delta(kind=head bytes=1796) from S13
[S7] cosine check vs S13: cos=0.3039
[S8] RECEIVED delta(kind=head bytes=1798) from S14
[S8] cosine check vs S14: cos=0.4262
[S8] RECEIVED delta(kind=head bytes=1795) from S11
[S8] cosine check vs S11: cos=0.8317
[S7] RECEIVED delta(kind=head bytes=1794) from S16
[S7] cosine check vs S16: cos=0.9369
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=10 metric=0.4167 head_norm=0.843894
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.137177e-01
[S7] stored merged vector for next round verification (round=10)
[S7] DEBUG after merge:  round=10 metric=0.4167 head_norm=0.764521 delta_norm=0.213718
[S7] aggregate: ACCEPT kept=['S13', 'S16'] (k=2/2) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.179 → S17@127.0.0.1:52817
[S6] ⇄ pheromone p=0.371 → S17@127.0.0.1:52817
[S5] ⇄ pheromone p=0.347 → S11@127.0.0.1:52812
[S2] ⇄ pheromone p=0.206 → S8@127.0.0.1:52809
[S4] ⇄ pheromone p=0.197 → S8@127.0.0.1:52809
[S10] ⇄ pheromone p=0.413 → S14@127.0.0.1:52814
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=10 metric=0.9507 head_norm=0.863589
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.954129e-01
[S8] stored merged vector for next round verification (round=10)
[S8] DEBUG after merge:  round=10 metric=0.9950 head_norm=0.879140 delta_norm=0.395413
[S8] aggregate: ACCEPT kept=['S14', 'S11'] (k=2/2) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.528 → S15@127.0.0.1:52815
[S9] ⇄ pheromone p=0.369 → S17@127.0.0.1:52817
[S16] ⇄ pheromone p=0.294 → S7@127.0.0.1:52808
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=10 metric=0.9661 head_norm=1.533773
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.615587e-01
[S14] stored merged vector for next round verification (round=10)
[S14] DEBUG after merge:  round=10 metric=0.7727 head_norm=1.606554 delta_norm=0.161559
[S14] aggregate: ROLLBACK (f1_val pre=0.966 post=0.773 tol_abs=0.005 tol_rel=0.0)
[S14] ⇄ pheromone p=0.435 → S8@127.0.0.1:52809
[S13] ⇄ pheromone p=0.257 → S7@127.0.0.1:52808
[S3] ⇄ pheromone p=0.325 → S11@127.0.0.1:52812
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=10 metric=0.6033 head_norm=0.930797
[S11] _apply_head_vector_avg (torch): Δ‖w‖=5.667483e-01
[S11] stored merged vector for next round verification (round=10)
[S11] DEBUG after merge:  round=10 metric=0.6315 head_norm=1.095096 delta_norm=0.566748
[S11] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.397 → S8@127.0.0.1:52809
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=10 metric=0.1430 head_norm=0.804865
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.455222e-01
[S17] stored merged vector for next round verification (round=10)
[S17] DEBUG after merge:  round=10 metric=0.1368 head_norm=0.723206 delta_norm=0.445522
[S17] aggregate: ROLLBACK (f1_val pre=0.143 post=0.137 tol_abs=0.005 tol_rel=0.0)
[S17] ⇄ pheromone p=0.173 → S13@127.0.0.1:52813
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=10 metric=0.6993 head_norm=0.907642
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.636544e-01
[S15] stored merged vector for next round verification (round=10)
[S15] DEBUG after merge:  round=10 metric=0.6991 head_norm=0.807809 delta_norm=0.363654
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.271 → S9@127.0.0.1:52810
[S2] START round=11 head_norm_before_train=1.673087 (no previous merge yet)
[S2] round=11 local utility u=0.605280 metrics={'f1_val': 0.7057878779221993, 'auprc': 0.7163066095832222, 'loss_val': 0.4957366456006074, 'psi': 0.7099953705866084}-{'f1_val': 0.574004272101331, 'auprc': 0.6446952138724431, 'loss_val': 0.7007599737737097, 'psi': 0.6022806488097758}
[S3] START round=11 head_norm_before_train=1.474617 (no previous merge yet)
[S3] round=11 local utility u=0.293559 metrics={'f1_val': 0.7008362290767893, 'auprc': 0.9830753589186219, 'loss_val': 0.4737830547920924, 'psi': 0.8137318810135223}-{'f1_val': 0.6871113738022745, 'auprc': 0.863730095279915, 'loss_val': 0.6205151877057805, 'psi': 0.7577588623933307}
[S4] START round=11 head_norm_before_train=1.754034 (no previous merge yet)
[S4] round=11 local utility u=1.000000 metrics={'f1_val': 0.9445834108707589, 'auprc': 0.9472116746698938, 'loss_val': 0.41558275618728907, 'psi': 0.9456347163904129}-{'f1_val': 0.6201712909378901, 'auprc': 0.9464485141921124, 'loss_val': 0.48470249412489474, 'psi': 0.7506821802395791}
[S5] START round=11 head_norm_before_train=1.184484 cos_to_last_merge=0.9007 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.901
[S5] round=11 local utility u=0.000000 metrics={'f1_val': 0.4192761065959803, 'auprc': 0.7754076734372989, 'loss_val': 0.6555529707464315, 'psi': 0.5617287333325077}-{'f1_val': 0.6218113726447786, 'auprc': 0.794090879398614, 'loss_val': 0.6810086576577752, 'psi': 0.6907231753463128}
[S6] START round=11 head_norm_before_train=1.310734 cos_to_last_merge=0.8621 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.862
[S6] round=11 local utility u=0.000000 metrics={'f1_val': 0.6185903554101133, 'auprc': 0.7771489514024803, 'loss_val': 0.6409045032055308, 'psi': 0.6820137938070601}-{'f1_val': 0.6217686126727133, 'auprc': 0.7781027154698124, 'loss_val': 0.5423318505472313, 'psi': 0.684302253791553}
[S7] START round=11 head_norm_before_train=0.764521 cos_to_last_merge=1.0000 (last merge round=10)
[S7] round=11 local utility u=0.016089 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.46376614023469337, 'loss_val': 0.9036268044433658, 'psi': 0.4355325269604914}-{'f1_val': 0.41671011811102343, 'auprc': 0.4577644627616692, 'loss_val': 0.9178001838139016, 'psi': 0.43313185597128173}
[S8] START round=11 head_norm_before_train=0.879140 cos_to_last_merge=1.0000 (last merge round=10)
[S8] round=11 local utility u=0.155555 metrics={'f1_val': 0.996776381273096, 'auprc': 0.9977054885463874, 'loss_val': 0.3857885417424018, 'psi': 0.9971480241824127}-{'f1_val': 0.9506657104821837, 'auprc': 0.9960089084740151, 'loss_val': 0.41514499933382126, 'psi': 0.9688029896789163}
[S9] START round=11 head_norm_before_train=0.891754 cos_to_last_merge=0.9957 (last merge round=9)
[S9] round=11 local utility u=0.053704 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9987226675347989, 'loss_val': 0.44021003598483355, 'psi': 0.8202633571384577}-{'f1_val': 0.7017906989076834, 'auprc': 0.9988330316803176, 'loss_val': 0.5509503430377154, 'psi': 0.820607632016737}
[S10] START round=11 head_norm_before_train=1.691678 (no previous merge yet)
[S10] round=11 local utility u=0.009545 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9968631993387648, 'loss_val': 0.06514835723101557, 'psi': 0.9958579831471308}-{'f1_val': 0.9960202599216732, 'auprc': 0.9968873087753546, 'loss_val': 0.08930430535940614, 'psi': 0.9963670794631457}
[S11] START round=11 head_norm_before_train=1.095096 cos_to_last_merge=1.0000 (last merge round=10)
[S11] round=11 local utility u=0.322518 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.866720093836215, 'loss_val': 0.6637650713127801, 'psi': 0.7677041252866409}-{'f1_val': 0.6033306461877891, 'auprc': 0.8719606828203572, 'loss_val': 0.7343467869223577, 'psi': 0.7107826608408163}
[S13] START round=11 head_norm_before_train=0.939468 cos_to_last_merge=0.9816 (last merge round=8)
[S13] round=11 local utility u=0.000000 metrics={'f1_val': 0.582683152722465, 'auprc': 0.6914247182460083, 'loss_val': 0.7217029308106175, 'psi': 0.6261797789318823}-{'f1_val': 0.6145417687450047, 'auprc': 0.686914089344853, 'loss_val': 0.6343054722311582, 'psi': 0.643490696984944}
[S14] START round=11 head_norm_before_train=1.606554 cos_to_last_merge=1.0000 (last merge round=10)
[S14] round=11 local utility u=0.000000 metrics={'f1_val': 0.9307849438578448, 'auprc': 0.995695166640612, 'loss_val': 0.5978026287395815, 'psi': 0.9567490329709516}-{'f1_val': 0.9661413532265255, 'auprc': 0.9971556085050677, 'loss_val': 0.6683135197779998, 'psi': 0.9785470553379423}
[S15] START round=11 head_norm_before_train=0.807809 cos_to_last_merge=1.0000 (last merge round=10)
[S15] round=11 local utility u=0.254891 metrics={'f1_val': 0.7010713433702593, 'auprc': 0.964869004421083, 'loss_val': 0.4122275967991855, 'psi': 0.8065904077905888}-{'f1_val': 0.6992965014272702, 'auprc': 0.8102136749104638, 'loss_val': 0.4473937694399673, 'psi': 0.7436633708205476}
[S16] START round=11 head_norm_before_train=1.058210 cos_to_last_merge=0.8957 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.896
[S16] round=11 local utility u=0.173486 metrics={'f1_val': 0.4710429991904598, 'auprc': 0.7685449617365888, 'loss_val': 0.7473494027558096, 'psi': 0.5900437842089115}-{'f1_val': 0.4376418734983624, 'auprc': 0.7453202806258686, 'loss_val': 0.8242406640746541, 'psi': 0.560713236349365}
[S17] START round=11 head_norm_before_train=0.723206 cos_to_last_merge=1.0000 (last merge round=10)
[S17] round=11 local utility u=1.000000 metrics={'f1_val': 0.3481797683390315, 'auprc': 0.6740566840945276, 'loss_val': 0.9601726074062111, 'psi': 0.47853053464122997}-{'f1_val': 0.14295200525969756, 'auprc': 0.5613550516307789, 'loss_val': 1.6536906553267297, 'psi': 0.3103132238081301}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:52814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:52815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:52810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:52808
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:52817
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:52809
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:52812
[S11] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1804 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1801) from S3
[S11] cosine check vs S3: cos=0.9279
[S17] RECEIVED delta(kind=head bytes=1799) from S7
[S17] cosine check vs S7: cos=0.4873
[S17] RECEIVED delta(kind=head bytes=1796) from S9
[S17] cosine check vs S9: cos=0.8004
[S8] RECEIVED delta(kind=head bytes=1802) from S11
[S8] cosine check vs S11: cos=0.6328
[S14] RECEIVED delta(kind=head bytes=1804) from S10
[S14] cosine check vs S10: cos=0.9909
[S8] RECEIVED delta(kind=head bytes=1802) from S4
[S8] cosine check vs S4: cos=-0.0081
[S8] DROPPED delta from S4 (cos=-0.0081 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1797) from S16
[S7] cosine check vs S16: cos=0.8750
[S15] RECEIVED delta(kind=head bytes=1798) from S8
[S15] cosine check vs S8: cos=0.7402
[S9] RECEIVED delta(kind=head bytes=1797) from S15
[S9] cosine check vs S15: cos=0.7161
[S8] RECEIVED delta(kind=head bytes=1797) from S2
[S8] cosine check vs S2: cos=0.1292
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:52813
[S17] sending update (kind=head size=1801 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1801) from S17
[S13] cosine check vs S17: cos=0.5187
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=11 metric=0.9308 head_norm=1.633654
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.244675e-01
[S14] stored merged vector for next round verification (round=11)
[S14] DEBUG after merge:  round=11 metric=0.7121 head_norm=1.680733 delta_norm=0.124468
[S14] aggregate: ROLLBACK (f1_val pre=0.931 post=0.712 tol_abs=0.005 tol_rel=0.0)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=11 metric=0.5827 head_norm=1.025532
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.577892e-01
[S13] stored merged vector for next round verification (round=11)
[S13] DEBUG after merge:  round=11 metric=0.5826 head_norm=0.795563 delta_norm=0.457789
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=11 metric=0.7017 head_norm=1.135158
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.142453e-01
[S11] stored merged vector for next round verification (round=11)
[S11] DEBUG after merge:  round=11 metric=0.7017 head_norm=1.302921 delta_norm=0.314245
[S11] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=11 metric=0.7011 head_norm=0.917000
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.387324e-01
[S15] stored merged vector for next round verification (round=11)
[S15] DEBUG after merge:  round=11 metric=0.7011 head_norm=0.875162 delta_norm=0.338732
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=11 metric=0.9968 head_norm=0.959379
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.156991e-01
[S8] stored merged vector for next round verification (round=11)
[S8] DEBUG after merge:  round=11 metric=0.9968 head_norm=0.845924 delta_norm=0.515699
[S8] aggregate: ACCEPT kept=['S11', 'S2'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=11 metric=0.7013 head_norm=0.951824
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.523905e-01
[S9] stored merged vector for next round verification (round=11)
[S9] DEBUG after merge:  round=11 metric=0.7015 head_norm=0.865592 delta_norm=0.352391
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=11 metric=0.4167 head_norm=0.799970
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.826725e-01
[S7] stored merged vector for next round verification (round=11)
[S7] DEBUG after merge:  round=11 metric=0.4167 head_norm=0.926393 delta_norm=0.282672
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=11 metric=0.3482 head_norm=0.795780
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.583543e-01
[S17] stored merged vector for next round verification (round=11)
[S17] DEBUG after merge:  round=11 metric=0.3481 head_norm=0.724563 delta_norm=0.258354
[S17] aggregate: ACCEPT kept=['S7', 'S9'] (k=2/2) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.694319 (no previous merge yet)
[S2] round=12 local utility u=0.000000 metrics={'f1_val': 0.6074575560271196, 'auprc': 0.6250462430808696, 'loss_val': 0.8150595577360438, 'psi': 0.6144930308486196}-{'f1_val': 0.7057878779221993, 'auprc': 0.7163066095832222, 'loss_val': 0.4957366456006074, 'psi': 0.7099953705866084}
[S3] START round=12 head_norm_before_train=1.517934 (no previous merge yet)
[S3] round=12 local utility u=0.026497 metrics={'f1_val': 0.7008362290767893, 'auprc': 0.9838967505860141, 'loss_val': 0.4232538752574757, 'psi': 0.8140604376804792}-{'f1_val': 0.7008362290767893, 'auprc': 0.9830753589186219, 'loss_val': 0.4737830547920924, 'psi': 0.8137318810135223}
[S4] START round=12 head_norm_before_train=1.772644 (no previous merge yet)
[S4] round=12 local utility u=0.083930 metrics={'f1_val': 0.951171332623034, 'auprc': 0.9570860019413575, 'loss_val': 0.3168742082687092, 'psi': 0.9535372003503635}-{'f1_val': 0.9445834108707589, 'auprc': 0.9472116746698938, 'loss_val': 0.41558275618728907, 'psi': 0.9456347163904129}
[S5] START round=12 head_norm_before_train=1.218414 cos_to_last_merge=0.8873 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.887
[S5] round=12 local utility u=0.745789 metrics={'f1_val': 0.7010650608352189, 'auprc': 0.672318450813621, 'loss_val': 0.5454411741650114, 'psi': 0.6895664168265797}-{'f1_val': 0.4192761065959803, 'auprc': 0.7754076734372989, 'loss_val': 0.6555529707464315, 'psi': 0.5617287333325077}
[S6] START round=12 head_norm_before_train=1.351699 cos_to_last_merge=0.8550 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.855
[S6] round=12 local utility u=0.000000 metrics={'f1_val': 0.4917553383759286, 'auprc': 0.7791144135479288, 'loss_val': 0.5419380393453038, 'psi': 0.6066989684447287}-{'f1_val': 0.6185903554101133, 'auprc': 0.7771489514024803, 'loss_val': 0.6409045032055308, 'psi': 0.6820137938070601}
[S7] START round=12 head_norm_before_train=0.926393 cos_to_last_merge=1.0000 (last merge round=11)
[S7] round=12 local utility u=0.047703 metrics={'f1_val': 0.41662931103489464, 'auprc': 0.4892074867841804, 'loss_val': 0.8840590378147966, 'psi': 0.44566058133460895}-{'f1_val': 0.41671011811102343, 'auprc': 0.46376614023469337, 'loss_val': 0.9036268044433658, 'psi': 0.4355325269604914}
[S8] START round=12 head_norm_before_train=0.845924 cos_to_last_merge=1.0000 (last merge round=11)
[S8] round=12 local utility u=0.030711 metrics={'f1_val': 0.9941452904260921, 'auprc': 0.9954580816756988, 'loss_val': 0.30183690406348457, 'psi': 0.9946704069259348}-{'f1_val': 0.996776381273096, 'auprc': 0.9977054885463874, 'loss_val': 0.3857885417424018, 'psi': 0.9971480241824127}
[S9] START round=12 head_norm_before_train=0.865592 cos_to_last_merge=1.0000 (last merge round=11)
[S9] round=12 local utility u=0.000000 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9985537689443528, 'loss_val': 0.4443858005750926, 'psi': 0.8201957977022791}-{'f1_val': 0.7012904835408967, 'auprc': 0.9987226675347989, 'loss_val': 0.44021003598483355, 'psi': 0.8202633571384577}
[S10] START round=12 head_norm_before_train=1.735478 (no previous merge yet)
[S10] round=12 local utility u=0.009803 metrics={'f1_val': 0.9960202599216732, 'auprc': 0.9968420866669243, 'loss_val': 0.050472724981168005, 'psi': 0.9963489906197736}-{'f1_val': 0.9951878390193748, 'auprc': 0.9968631993387648, 'loss_val': 0.06514835723101557, 'psi': 0.9958579831471308}
[S11] START round=12 head_norm_before_train=1.302921 cos_to_last_merge=1.0000 (last merge round=11)
[S11] round=12 local utility u=0.047096 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.8645835087771458, 'loss_val': 0.5631624386994482, 'psi': 0.7668494912630133}-{'f1_val': 0.7016934795869249, 'auprc': 0.866720093836215, 'loss_val': 0.6637650713127801, 'psi': 0.7677041252866409}
[S13] START round=12 head_norm_before_train=0.795563 cos_to_last_merge=1.0000 (last merge round=11)
[S13] round=12 local utility u=0.000000 metrics={'f1_val': 0.6159716681081691, 'auprc': 0.5994400451720863, 'loss_val': 0.715356891855232, 'psi': 0.6093590189337359}-{'f1_val': 0.582683152722465, 'auprc': 0.6914247182460083, 'loss_val': 0.7217029308106175, 'psi': 0.6261797789318823}
[S14] START round=12 head_norm_before_train=1.680733 cos_to_last_merge=1.0000 (last merge round=11)
[S14] round=12 local utility u=0.000000 metrics={'f1_val': 0.6922396284822254, 'auprc': 0.9958120543648838, 'loss_val': 0.49767929780719955, 'psi': 0.8136685988352887}-{'f1_val': 0.9307849438578448, 'auprc': 0.995695166640612, 'loss_val': 0.5978026287395815, 'psi': 0.9567490329709516}
[S15] START round=12 head_norm_before_train=0.875162 cos_to_last_merge=1.0000 (last merge round=11)
[S15] round=12 local utility u=0.210677 metrics={'f1_val': 0.7534381654180619, 'auprc': 0.9884538475894542, 'loss_val': 0.3758294294544533, 'psi': 0.8474444382866189}-{'f1_val': 0.7010713433702593, 'auprc': 0.964869004421083, 'loss_val': 0.4122275967991855, 'psi': 0.8065904077905888}
[S16] START round=12 head_norm_before_train=1.111874 cos_to_last_merge=0.8805 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.881
[S16] round=12 local utility u=0.000000 metrics={'f1_val': 0.4351592867057308, 'auprc': 0.7656296353098433, 'loss_val': 0.7261623081286417, 'psi': 0.5673474261473759}-{'f1_val': 0.4710429991904598, 'auprc': 0.7685449617365888, 'loss_val': 0.7473494027558096, 'psi': 0.5900437842089115}
[S17] START round=12 head_norm_before_train=0.724563 cos_to_last_merge=1.0000 (last merge round=11)
[S17] round=12 local utility u=0.202838 metrics={'f1_val': 0.3676619270869419, 'auprc': 0.7290177348130281, 'loss_val': 0.8362718708744277, 'psi': 0.5122042501773765}-{'f1_val': 0.3481797683390315, 'auprc': 0.6740566840945276, 'loss_val': 0.9601726074062111, 'psi': 0.47853053464122997}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S10] → sending delta(kind=head bytes=1806) to S14@127.0.0.1:52814
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:52810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S11@127.0.0.1:52812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S11@127.0.0.1:52812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:52815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:52809
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:52817
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1804 to 1 peers)
[S5] sending update (kind=head size=1794 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1806 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1798) from S7
[S17] cosine check vs S7: cos=0.5799
[S14] RECEIVED delta(kind=head bytes=1806) from S10
[S14] cosine check vs S10: cos=0.9939
[S15] RECEIVED delta(kind=head bytes=1797) from S8
[S15] cosine check vs S8: cos=0.8245
[S9] RECEIVED delta(kind=head bytes=1801) from S15
[S9] cosine check vs S15: cos=0.8298
[S8] RECEIVED delta(kind=head bytes=1803) from S11
[S8] cosine check vs S11: cos=0.6056
[S8] RECEIVED delta(kind=head bytes=1801) from S4
[S8] cosine check vs S4: cos=-0.0134
[S8] DROPPED delta from S4 (cos=-0.0134 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1804) from S3
[S11] cosine check vs S3: cos=0.9757
[S11] RECEIVED delta(kind=head bytes=1794) from S5
[S11] cosine check vs S5: cos=0.2553
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] → sending delta(kind=head bytes=1794) to S13@127.0.0.1:52813
[S17] sending update (kind=head size=1794 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1794) from S17
[S13] cosine check vs S17: cos=0.7894
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=12 metric=0.6160 head_norm=0.860295
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.710575e-01
[S13] stored merged vector for next round verification (round=12)
[S13] DEBUG after merge:  round=12 metric=0.6166 head_norm=0.785897 delta_norm=0.271058
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=12 metric=0.7013 head_norm=0.922367
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.775811e-01
[S9] stored merged vector for next round verification (round=12)
[S9] DEBUG after merge:  round=12 metric=0.7013 head_norm=0.906572 delta_norm=0.277581
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=12 metric=0.6922 head_norm=1.711532
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.016953e-01
[S14] stored merged vector for next round verification (round=12)
[S14] DEBUG after merge:  round=12 metric=0.6918 head_norm=1.742071 delta_norm=0.101695
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=12 metric=0.7534 head_norm=0.973184
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.840393e-01
[S15] stored merged vector for next round verification (round=12)
[S15] DEBUG after merge:  round=12 metric=0.7773 head_norm=0.914441 delta_norm=0.284039
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=12 metric=0.7017 head_norm=1.339519
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.327467e-01
[S11] stored merged vector for next round verification (round=12)
[S11] DEBUG after merge:  round=12 metric=0.7029 head_norm=1.159446 delta_norm=0.332747
[S11] aggregate: ACCEPT kept=['S3', 'S5'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=12 metric=0.9941 head_norm=0.941635
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.369520e-01
[S8] stored merged vector for next round verification (round=12)
[S8] DEBUG after merge:  round=12 metric=0.9964 head_norm=1.025757 delta_norm=0.536952
[S8] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=12 metric=0.3677 head_norm=0.801315
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.081336e-01
[S17] stored merged vector for next round verification (round=12)
[S17] DEBUG after merge:  round=12 metric=0.3682 head_norm=0.781116 delta_norm=0.408134
[S17] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.716626 (no previous merge yet)
[S2] round=13 local utility u=0.000000 metrics={'f1_val': 0.5063274090289386, 'auprc': 0.5921130921496013, 'loss_val': 1.2495109672353673, 'psi': 0.5406416822772037}-{'f1_val': 0.6074575560271196, 'auprc': 0.6250462430808696, 'loss_val': 0.8150595577360438, 'psi': 0.6144930308486196}
[S3] START round=13 head_norm_before_train=1.559932 (no previous merge yet)
[S3] round=13 local utility u=0.034808 metrics={'f1_val': 0.7008317350254774, 'auprc': 0.9871318606318537, 'loss_val': 0.3633163358851504, 'psi': 0.8153517852680279}-{'f1_val': 0.7008362290767893, 'auprc': 0.9838967505860141, 'loss_val': 0.4232538752574757, 'psi': 0.8140604376804792}
[S4] START round=13 head_norm_before_train=1.798309 (no previous merge yet)
[S4] round=13 local utility u=0.000000 metrics={'f1_val': 0.9485644927403085, 'auprc': 0.9516241728258297, 'loss_val': 0.3027284075218923, 'psi': 0.9497883647745169}-{'f1_val': 0.951171332623034, 'auprc': 0.9570860019413575, 'loss_val': 0.3168742082687092, 'psi': 0.9535372003503635}
[S5] START round=13 head_norm_before_train=1.252388 cos_to_last_merge=0.8758 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.876
[S5] round=13 local utility u=0.136707 metrics={'f1_val': 0.6988995658400323, 'auprc': 0.7668827758483565, 'loss_val': 0.5427265409521509, 'psi': 0.726092849843362}-{'f1_val': 0.7010650608352189, 'auprc': 0.672318450813621, 'loss_val': 0.5454411741650114, 'psi': 0.6895664168265797}
[S6] START round=13 head_norm_before_train=1.375630 cos_to_last_merge=0.8496 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.850
[S6] round=13 local utility u=0.591821 metrics={'f1_val': 0.6436309092311878, 'auprc': 0.8211816983335656, 'loss_val': 0.39575209907879, 'psi': 0.714651224872139}-{'f1_val': 0.4917553383759286, 'auprc': 0.7791144135479288, 'loss_val': 0.5419380393453038, 'psi': 0.6066989684447287}
[S7] START round=13 head_norm_before_train=0.954633 cos_to_last_merge=0.9969 (last merge round=11)
[S7] round=13 local utility u=0.203468 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.6123997196624534, 'loss_val': 0.8471845096778677, 'psi': 0.49498595873159545}-{'f1_val': 0.41662931103489464, 'auprc': 0.4892074867841804, 'loss_val': 0.8840590378147966, 'psi': 0.44566058133460895}
[S8] START round=13 head_norm_before_train=1.025757 cos_to_last_merge=1.0000 (last merge round=12)
[S8] round=13 local utility u=0.013166 metrics={'f1_val': 0.9964894426023416, 'auprc': 0.9968948810089107, 'loss_val': 0.29388086055524076, 'psi': 0.9966516179649693}-{'f1_val': 0.9941452904260921, 'auprc': 0.9954580816756988, 'loss_val': 0.30183690406348457, 'psi': 0.9946704069259348}
[S9] START round=13 head_norm_before_train=0.906572 cos_to_last_merge=1.0000 (last merge round=12)
[S9] round=13 local utility u=0.005582 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9987779046940601, 'loss_val': 0.4334514819678383, 'psi': 0.8202411103416352}-{'f1_val': 0.7012904835408967, 'auprc': 0.9985537689443528, 'loss_val': 0.4443858005750926, 'psi': 0.8201957977022791}
[S10] START round=13 head_norm_before_train=1.777909 (no previous merge yet)
[S10] round=13 local utility u=0.003863 metrics={'f1_val': 0.9960202599216732, 'auprc': 0.9967568010288668, 'loss_val': 0.042490991482198995, 'psi': 0.9963148763645506}-{'f1_val': 0.9960202599216732, 'auprc': 0.9968420866669243, 'loss_val': 0.050472724981168005, 'psi': 0.9963489906197736}
[S11] START round=13 head_norm_before_train=1.159446 cos_to_last_merge=1.0000 (last merge round=12)
[S11] round=13 local utility u=0.034745 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.8637601234200739, 'loss_val': 0.4912026824779366, 'psi': 0.7665201371201844}-{'f1_val': 0.7016934795869249, 'auprc': 0.8645835087771458, 'loss_val': 0.5631624386994482, 'psi': 0.7668494912630133}
[S13] START round=13 head_norm_before_train=0.785897 cos_to_last_merge=1.0000 (last merge round=12)
[S13] round=13 local utility u=0.000000 metrics={'f1_val': 0.622447872022341, 'auprc': 0.5501032815915547, 'loss_val': 0.7595857864040823, 'psi': 0.5935100358500265}-{'f1_val': 0.6159716681081691, 'auprc': 0.5994400451720863, 'loss_val': 0.715356891855232, 'psi': 0.6093590189337359}
[S14] START round=13 head_norm_before_train=1.742071 cos_to_last_merge=1.0000 (last merge round=12)
[S14] round=13 local utility u=0.964308 metrics={'f1_val': 0.9961161430937879, 'auprc': 0.9971528567807139, 'loss_val': 0.3963457627602728, 'psi': 0.9965308285685583}-{'f1_val': 0.6922396284822254, 'auprc': 0.9958120543648838, 'loss_val': 0.49767929780719955, 'psi': 0.8136685988352887}
[S15] START round=13 head_norm_before_train=0.914441 cos_to_last_merge=1.0000 (last merge round=12)
[S15] round=13 local utility u=0.000000 metrics={'f1_val': 0.7009169771696235, 'auprc': 0.984639437248826, 'loss_val': 0.4255403928222867, 'psi': 0.8144059612013045}-{'f1_val': 0.7534381654180619, 'auprc': 0.9884538475894542, 'loss_val': 0.3758294294544533, 'psi': 0.8474444382866189}
[S16] START round=13 head_norm_before_train=1.168315 cos_to_last_merge=0.8667 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.867
[S16] round=13 local utility u=0.392305 metrics={'f1_val': 0.5508564304679244, 'auprc': 0.7924657149881574, 'loss_val': 0.716243778745353, 'psi': 0.6475001442760177}-{'f1_val': 0.4351592867057308, 'auprc': 0.7656296353098433, 'loss_val': 0.7261623081286417, 'psi': 0.5673474261473759}
[S17] START round=13 head_norm_before_train=0.781116 cos_to_last_merge=1.0000 (last merge round=12)
[S17] round=13 local utility u=0.000000 metrics={'f1_val': 0.3613624254822737, 'auprc': 0.6664968017349013, 'loss_val': 0.8968531685479891, 'psi': 0.48341617598332476}-{'f1_val': 0.3676619270869419, 'auprc': 0.7290177348130281, 'loss_val': 0.8362718708744277, 'psi': 0.5122042501773765}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S11@127.0.0.1:52812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:52814
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:52812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:52809
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:52808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:52815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S7] → sending delta(kind=head bytes=1790) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S9] → sending delta(kind=head bytes=1789) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:52817
[S6] sending update (kind=head size=1803 to 1 peers)
[S9] sending update (kind=head size=1789 to 1 peers)
[S7] sending update (kind=head size=1790 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1803) from S6
[S17] cosine check vs S6: cos=0.1533
[S17] RECEIVED delta(kind=head bytes=1789) from S9
[S17] cosine check vs S9: cos=0.5831
[S17] RECEIVED delta(kind=head bytes=1790) from S7
[S17] cosine check vs S7: cos=0.8440
[S14] RECEIVED delta(kind=head bytes=1803) from S10
[S14] cosine check vs S10: cos=0.9960
[S15] RECEIVED delta(kind=head bytes=1798) from S8
[S15] cosine check vs S8: cos=0.7763
[S8] RECEIVED delta(kind=head bytes=1801) from S11
[S8] cosine check vs S11: cos=0.9180
[S7] RECEIVED delta(kind=head bytes=1796) from S16
[S7] cosine check vs S16: cos=0.9509
[S8] RECEIVED delta(kind=head bytes=1801) from S14
[S8] cosine check vs S14: cos=0.2688
[S11] RECEIVED delta(kind=head bytes=1798) from S5
[S11] cosine check vs S5: cos=0.4637
[S11] RECEIVED delta(kind=head bytes=1803) from S3
[S11] cosine check vs S3: cos=0.9204
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=13 metric=0.9961 head_norm=1.771363
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.320248e-02
[S14] stored merged vector for next round verification (round=13)
[S14] DEBUG after merge:  round=13 metric=0.9922 head_norm=1.792091 delta_norm=0.083202
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=13 metric=0.9965 head_norm=1.084168
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.630568e-01
[S8] stored merged vector for next round verification (round=13)
[S8] DEBUG after merge:  round=13 metric=0.9965 head_norm=1.034624 delta_norm=0.463057
[S8] aggregate: ACCEPT kept=['S11', 'S14'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=13 metric=0.7017 head_norm=1.201541
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.857456e-01
[S11] stored merged vector for next round verification (round=13)
[S11] DEBUG after merge:  round=13 metric=0.7016 head_norm=1.128693 delta_norm=0.185746
[S11] aggregate: ACCEPT kept=['S5', 'S3'] (k=2/2) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=13 metric=0.4167 head_norm=0.982567
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.092898e-01
[S7] stored merged vector for next round verification (round=13)
[S7] DEBUG after merge:  round=13 metric=0.4167 head_norm=1.088888 delta_norm=0.209290
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=13 metric=0.3614 head_norm=0.853799
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.302661e-01
[S17] stored merged vector for next round verification (round=13)
[S17] DEBUG after merge:  round=13 metric=0.3587 head_norm=0.750317 delta_norm=0.230266
[S17] aggregate: ACCEPT kept=['S6', 'S9', 'S7'] (k=3/3) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=13 metric=0.7009 head_norm=1.016829
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.527836e-01
[S15] stored merged vector for next round verification (round=13)
[S15] DEBUG after merge:  round=13 metric=0.7009 head_norm=0.990063 delta_norm=0.352784
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.739799 (no previous merge yet)
[S2] round=14 local utility u=0.232009 metrics={'f1_val': 0.5267795104948034, 'auprc': 0.6092898884338592, 'loss_val': 0.9597353892003808, 'psi': 0.5597836616704257}-{'f1_val': 0.5063274090289386, 'auprc': 0.5921130921496013, 'loss_val': 1.2495109672353673, 'psi': 0.5406416822772037}
[S3] START round=14 head_norm_before_train=1.593879 (no previous merge yet)
[S3] round=14 local utility u=0.019122 metrics={'f1_val': 0.7005813959920884, 'auprc': 0.9931545607099215, 'loss_val': 0.34163880610479863, 'psi': 0.8176106618792216}-{'f1_val': 0.7008317350254774, 'auprc': 0.9871318606318537, 'loss_val': 0.3633163358851504, 'psi': 0.8153517852680279}
[S4] START round=14 head_norm_before_train=1.835733 (no previous merge yet)
[S4] round=14 local utility u=0.000000 metrics={'f1_val': 0.9418911626144342, 'auprc': 0.9279607443829773, 'loss_val': 0.3004846300452022, 'psi': 0.9363189953218515}-{'f1_val': 0.9485644927403085, 'auprc': 0.9516241728258297, 'loss_val': 0.3027284075218923, 'psi': 0.9497883647745169}
[S5] START round=14 head_norm_before_train=1.285533 cos_to_last_merge=0.8656 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.866
[S5] round=14 local utility u=0.000000 metrics={'f1_val': 0.7011046720655897, 'auprc': 0.6673976136882285, 'loss_val': 0.41978592625209055, 'psi': 0.6876218487146453}-{'f1_val': 0.6988995658400323, 'auprc': 0.7668827758483565, 'loss_val': 0.5427265409521509, 'psi': 0.726092849843362}
[S6] START round=14 head_norm_before_train=1.397764 cos_to_last_merge=0.8451 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.845
[S6] round=14 local utility u=1.000000 metrics={'f1_val': 0.9342775368097486, 'auprc': 0.9515010423181142, 'loss_val': 0.22222677290817985, 'psi': 0.9411669390130948}-{'f1_val': 0.6436309092311878, 'auprc': 0.8211816983335656, 'loss_val': 0.39575209907879, 'psi': 0.714651224872139}
[S7] START round=14 head_norm_before_train=1.088888 cos_to_last_merge=1.0000 (last merge round=13)
[S7] round=14 local utility u=0.000000 metrics={'f1_val': 0.4360934349537117, 'auprc': 0.5287900146960642, 'loss_val': 0.8674824952405442, 'psi': 0.4731720668506527}-{'f1_val': 0.41671011811102343, 'auprc': 0.6123997196624534, 'loss_val': 0.8471845096778677, 'psi': 0.49498595873159545}
[S8] START round=14 head_norm_before_train=1.034624 cos_to_last_merge=1.0000 (last merge round=13)
[S8] round=14 local utility u=0.000000 metrics={'f1_val': 0.996776381273096, 'auprc': 0.9967686732342411, 'loss_val': 0.3048854246450721, 'psi': 0.9967732980575541}-{'f1_val': 0.9964894426023416, 'auprc': 0.9968948810089107, 'loss_val': 0.29388086055524076, 'psi': 0.9966516179649693}
[S9] START round=14 head_norm_before_train=0.960105 cos_to_last_merge=0.9942 (last merge round=12)
[S9] round=14 local utility u=0.045980 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9982197432930202, 'loss_val': 0.3398160771707691, 'psi': 0.8200178457812193}-{'f1_val': 0.7012165807733519, 'auprc': 0.9987779046940601, 'loss_val': 0.4334514819678383, 'psi': 0.8202411103416352}
[S10] START round=14 head_norm_before_train=1.816397 (no previous merge yet)
[S10] round=14 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9958287966892974, 'loss_val': 0.03902988967717389, 'psi': 0.9954442220873438}-{'f1_val': 0.9960202599216732, 'auprc': 0.9967568010288668, 'loss_val': 0.042490991482198995, 'psi': 0.9963148763645506}
[S11] START round=14 head_norm_before_train=1.128693 cos_to_last_merge=1.0000 (last merge round=13)
[S11] round=14 local utility u=0.013503 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.8650255701405534, 'loss_val': 0.46944484738774367, 'psi': 0.7671714180352134}-{'f1_val': 0.7016934795869249, 'auprc': 0.8637601234200739, 'loss_val': 0.4912026824779366, 'psi': 0.7665201371201844}
[S13] START round=14 head_norm_before_train=0.856739 cos_to_last_merge=0.9895 (last merge round=12)
[S13] round=14 local utility u=0.247127 metrics={'f1_val': 0.6222459346653677, 'auprc': 0.6876924235669771, 'loss_val': 0.6768868270214607, 'psi': 0.6484245302260114}-{'f1_val': 0.622447872022341, 'auprc': 0.5501032815915547, 'loss_val': 0.7595857864040823, 'psi': 0.5935100358500265}
[S14] START round=14 head_norm_before_train=1.792091 cos_to_last_merge=1.0000 (last merge round=13)
[S14] round=14 local utility u=0.064007 metrics={'f1_val': 0.9965995512732648, 'auprc': 0.9971565397244286, 'loss_val': 0.27124341489190446, 'psi': 0.9968223466537304}-{'f1_val': 0.9961161430937879, 'auprc': 0.9971528567807139, 'loss_val': 0.3963457627602728, 'psi': 0.9965308285685583}
[S15] START round=14 head_norm_before_train=0.990063 cos_to_last_merge=1.0000 (last merge round=13)
[S15] round=14 local utility u=0.248264 metrics={'f1_val': 0.7743754654392606, 'auprc': 0.9879777517522337, 'loss_val': 0.37977907836392594, 'psi': 0.8598163799644498}-{'f1_val': 0.7009169771696235, 'auprc': 0.984639437248826, 'loss_val': 0.4255403928222867, 'psi': 0.8144059612013045}
[S16] START round=14 head_norm_before_train=1.222097 cos_to_last_merge=0.8556 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.856
[S16] round=14 local utility u=0.199033 metrics={'f1_val': 0.5377521715095024, 'auprc': 0.8832901220641203, 'loss_val': 0.5120254453043271, 'psi': 0.6759673517313496}-{'f1_val': 0.5508564304679244, 'auprc': 0.7924657149881574, 'loss_val': 0.716243778745353, 'psi': 0.6475001442760177}
[S17] START round=14 head_norm_before_train=0.750317 cos_to_last_merge=1.0000 (last merge round=13)
[S17] round=14 local utility u=0.062713 metrics={'f1_val': 0.3651551393028049, 'auprc': 0.7046941987584017, 'loss_val': 0.9087756104849056, 'psi': 0.5009707630850436}-{'f1_val': 0.3613624254822737, 'auprc': 0.6664968017349013, 'loss_val': 0.8968531685479891, 'psi': 0.48341617598332476}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:52808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] → sending delta(kind=head bytes=1805) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] → sending delta(kind=head bytes=1793) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S14] → sending delta(kind=head bytes=1806) to S8@127.0.0.1:52809
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:52817
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:52808
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:52810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:52809
[S14] sending update (kind=head size=1806 to 1 peers)
[S2] sending update (kind=head size=1805 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1793 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1801) from S15
[S9] cosine check vs S15: cos=0.8153
[S8] RECEIVED delta(kind=head bytes=1806) from S14
[S8] cosine check vs S14: cos=0.6177
[S8] RECEIVED delta(kind=head bytes=1800) from S11
[S8] cosine check vs S11: cos=0.8711
[S8] RECEIVED delta(kind=head bytes=1805) from S2
[S8] cosine check vs S2: cos=0.1525
[S7] RECEIVED delta(kind=head bytes=1802) from S13
[S7] cosine check vs S13: cos=0.4023
[S17] RECEIVED delta(kind=head bytes=1799) from S6
[S17] cosine check vs S6: cos=0.2876
[S7] RECEIVED delta(kind=head bytes=1799) from S16
[S7] cosine check vs S16: cos=0.9829
[S17] RECEIVED delta(kind=head bytes=1793) from S9
[S17] cosine check vs S9: cos=0.6656
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:52813
[S17] sending update (kind=head size=1799 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1799) from S17
[S13] cosine check vs S17: cos=0.7842
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:52812
[S3] sending update (kind=head size=1800 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1800) from S3
[S11] cosine check vs S3: cos=0.8697
[S8] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=14 metric=0.9968 head_norm=1.087768
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.090779e-01
[S8] stored merged vector for next round verification (round=14)
[S8] DEBUG after merge:  round=14 metric=0.9968 head_norm=0.998904 delta_norm=0.209078
[S8] aggregate: ACCEPT kept=['S14', 'S11', 'S2'] (k=3/3) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=14 metric=0.7012 head_norm=1.022342
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.200755e-01
[S9] stored merged vector for next round verification (round=14)
[S9] DEBUG after merge:  round=14 metric=0.7012 head_norm=1.000016 delta_norm=0.320076
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=14 metric=0.4361 head_norm=1.108391
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.495435e-01
[S7] stored merged vector for next round verification (round=14)
[S7] DEBUG after merge:  round=14 metric=0.4071 head_norm=0.983187 delta_norm=0.249544
[S7] aggregate: ROLLBACK (f1_val pre=0.436 post=0.407 tol_abs=0.005 tol_rel=0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=14 metric=0.7019 head_norm=1.170342
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.197359e-01
[S11] stored merged vector for next round verification (round=14)
[S11] DEBUG after merge:  round=14 metric=0.7019 head_norm=1.353609 delta_norm=0.419736
[S11] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=14 metric=0.6222 head_norm=0.946864
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.964580e-01
[S13] stored merged vector for next round verification (round=14)
[S13] DEBUG after merge:  round=14 metric=0.6196 head_norm=0.835505 delta_norm=0.296458
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=14 metric=0.3652 head_norm=0.821804
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.777753e-01
[S17] stored merged vector for next round verification (round=14)
[S17] DEBUG after merge:  round=14 metric=0.3569 head_norm=0.768029 delta_norm=0.377775
[S17] aggregate: ROLLBACK (f1_val pre=0.365 post=0.357 tol_abs=0.005 tol_rel=0.0)
[S2] START round=15 head_norm_before_train=1.761181 (no previous merge yet)
[S2] round=15 local utility u=0.571250 metrics={'f1_val': 0.620075474607233, 'auprc': 0.7307466846375182, 'loss_val': 0.7413811726115646, 'psi': 0.6643439586193471}-{'f1_val': 0.5267795104948034, 'auprc': 0.6092898884338592, 'loss_val': 0.9597353892003808, 'psi': 0.5597836616704257}
[S3] START round=15 head_norm_before_train=1.627013 (no previous merge yet)
[S3] round=15 local utility u=0.015288 metrics={'f1_val': 0.7008317350254774, 'auprc': 0.9953064395783024, 'loss_val': 0.3190199858397839, 'psi': 0.8186216168466074}-{'f1_val': 0.7005813959920884, 'auprc': 0.9931545607099215, 'loss_val': 0.34163880610479863, 'psi': 0.8176106618792216}
[S4] START round=15 head_norm_before_train=1.864654 (no previous merge yet)
[S4] round=15 local utility u=0.077660 metrics={'f1_val': 0.945223083656461, 'auprc': 0.9656780181766901, 'loss_val': 0.2783070726574128, 'psi': 0.9534050574645527}-{'f1_val': 0.9418911626144342, 'auprc': 0.9279607443829773, 'loss_val': 0.3004846300452022, 'psi': 0.9363189953218515}
[S5] START round=15 head_norm_before_train=1.312146 cos_to_last_merge=0.8561 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.856
[S5] round=15 local utility u=0.044795 metrics={'f1_val': 0.7008563225598777, 'auprc': 0.6855578252431398, 'loss_val': 0.3831866862314803, 'psi': 0.6947369236331825}-{'f1_val': 0.7011046720655897, 'auprc': 0.6673976136882285, 'loss_val': 0.41978592625209055, 'psi': 0.6876218487146453}
[S6] START round=15 head_norm_before_train=1.417894 cos_to_last_merge=0.8409 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.841
[S6] round=15 local utility u=0.000000 metrics={'f1_val': 0.6423623484090074, 'auprc': 0.8186330222509307, 'loss_val': 0.4595939460175795, 'psi': 0.7128706179457768}-{'f1_val': 0.9342775368097486, 'auprc': 0.9515010423181142, 'loss_val': 0.22222677290817985, 'psi': 0.9411669390130948}
[S7] START round=15 head_norm_before_train=0.983187 cos_to_last_merge=1.0000 (last merge round=14)
[S7] round=15 local utility u=0.000000 metrics={'f1_val': 0.3760115345305238, 'auprc': 0.572624971857032, 'loss_val': 0.891615197060384, 'psi': 0.4546569094611271}-{'f1_val': 0.4360934349537117, 'auprc': 0.5287900146960642, 'loss_val': 0.8674824952405442, 'psi': 0.4731720668506527}
[S8] START round=15 head_norm_before_train=0.998904 cos_to_last_merge=1.0000 (last merge round=14)
[S8] round=15 local utility u=0.032253 metrics={'f1_val': 0.9964894426023416, 'auprc': 0.9969969398254535, 'loss_val': 0.23934269078894874, 'psi': 0.9966924414915864}-{'f1_val': 0.996776381273096, 'auprc': 0.9967686732342411, 'loss_val': 0.3048854246450721, 'psi': 0.9967732980575541}
[S9] START round=15 head_norm_before_train=1.000016 cos_to_last_merge=1.0000 (last merge round=14)
[S9] round=15 local utility u=0.000000 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9988469028244343, 'loss_val': 0.3505251342336452, 'psi': 0.8202687095937848}-{'f1_val': 0.7012165807733519, 'auprc': 0.9982197432930202, 'loss_val': 0.3398160771707691, 'psi': 0.8200178457812193}
[S10] START round=15 head_norm_before_train=1.846506 (no previous merge yet)
[S10] round=15 local utility u=0.003999 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9963267463532405, 'loss_val': 0.03505628955184605, 'psi': 0.995896490650308}-{'f1_val': 0.9951878390193748, 'auprc': 0.9958287966892974, 'loss_val': 0.03902988967717389, 'psi': 0.9954442220873438}
[S11] START round=15 head_norm_before_train=1.353609 cos_to_last_merge=1.0000 (last merge round=14)
[S11] round=15 local utility u=0.032360 metrics={'f1_val': 0.7016282822309048, 'auprc': 0.8645313458420314, 'loss_val': 0.4013991238475394, 'psi': 0.7667895076753555}-{'f1_val': 0.7019353166316534, 'auprc': 0.8650255701405534, 'loss_val': 0.46944484738774367, 'psi': 0.7671714180352134}
[S13] START round=15 head_norm_before_train=0.835505 cos_to_last_merge=1.0000 (last merge round=14)
[S13] round=15 local utility u=0.000000 metrics={'f1_val': 0.5742639368326582, 'auprc': 0.6731910322799204, 'loss_val': 0.8463764556579011, 'psi': 0.6138347750115631}-{'f1_val': 0.6222459346653677, 'auprc': 0.6876924235669771, 'loss_val': 0.6768868270214607, 'psi': 0.6484245302260114}
[S14] START round=15 head_norm_before_train=1.822444 cos_to_last_merge=0.9995 (last merge round=13)
[S14] round=15 local utility u=0.036959 metrics={'f1_val': 0.9973283609287906, 'auprc': 0.9971572664446974, 'loss_val': 0.20170118314822705, 'psi': 0.9972599231351533}-{'f1_val': 0.9965995512732648, 'auprc': 0.9971565397244286, 'loss_val': 0.27124341489190446, 'psi': 0.9968223466537304}
[S15] START round=15 head_norm_before_train=1.076930 cos_to_last_merge=0.9886 (last merge round=13)
[S15] round=15 local utility u=0.000000 metrics={'f1_val': 0.7009191843683342, 'auprc': 0.9843797428700176, 'loss_val': 0.3868153956962346, 'psi': 0.8143034077690077}-{'f1_val': 0.7743754654392606, 'auprc': 0.9879777517522337, 'loss_val': 0.37977907836392594, 'psi': 0.8598163799644498}
[S16] START round=15 head_norm_before_train=1.272736 cos_to_last_merge=0.8477 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.848
[S16] round=15 local utility u=0.963001 metrics={'f1_val': 0.8175066684559673, 'auprc': 0.9531933609483378, 'loss_val': 0.474259388334652, 'psi': 0.8717813454529155}-{'f1_val': 0.5377521715095024, 'auprc': 0.8832901220641203, 'loss_val': 0.5120254453043271, 'psi': 0.6759673517313496}
[S17] START round=15 head_norm_before_train=0.768029 cos_to_last_merge=1.0000 (last merge round=14)
[S17] round=15 local utility u=0.000000 metrics={'f1_val': 0.35553677425124586, 'auprc': 0.6840384603863311, 'loss_val': 0.9343373236096237, 'psi': 0.48693744870528}-{'f1_val': 0.3651551393028049, 'auprc': 0.7046941987584017, 'loss_val': 0.9087756104849056, 'psi': 0.5009707630850436}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:52812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:52815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S14] → sending delta(kind=head bytes=1809) to S8@127.0.0.1:52809
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:52808
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:52814
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:52812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:52809
[S2] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1809 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1800) from S10
[S14] cosine check vs S10: cos=0.9946
[S15] RECEIVED delta(kind=head bytes=1803) from S8
[S15] cosine check vs S8: cos=0.8394
[S8] RECEIVED delta(kind=head bytes=1798) from S2
[S8] cosine check vs S2: cos=0.2889
[S8] RECEIVED delta(kind=head bytes=1803) from S11
[S8] cosine check vs S11: cos=0.7391
[S8] RECEIVED delta(kind=head bytes=1809) from S14
[S8] cosine check vs S14: cos=0.6320
[S8] RECEIVED delta(kind=head bytes=1801) from S4
[S8] cosine check vs S4: cos=0.0051
[S7] RECEIVED delta(kind=head bytes=1797) from S16
[S7] cosine check vs S16: cos=0.9505
[S11] RECEIVED delta(kind=head bytes=1797) from S3
[S11] cosine check vs S3: cos=0.9708
[S11] RECEIVED delta(kind=head bytes=1798) from S5
[S11] cosine check vs S5: cos=0.3303
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] ⇄ pheromone p=0.357 → S17@127.0.0.1:52817
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=15 metric=0.3760 head_norm=1.004364
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.390009e-01
[S7] stored merged vector for next round verification (round=15)
[S7] DEBUG after merge:  round=15 metric=0.3760 head_norm=1.146376 delta_norm=0.239001
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.091 → S17@127.0.0.1:52817
[S8] aggregate: batch=4 kept=4 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=15 metric=0.9965 head_norm=1.077347
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.914144e-01
[S8] stored merged vector for next round verification (round=15)
[S8] DEBUG after merge:  round=15 metric=0.9968 head_norm=0.934599 delta_norm=0.291414
[S8] aggregate: ACCEPT kept=['S2', 'S11', 'S14', 'S4'] (k=4/4) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.197 → S15@127.0.0.1:52815
[S2] ⇄ pheromone p=0.268 → S8@127.0.0.1:52809
[S5] ⇄ pheromone p=0.217 → S11@127.0.0.1:52812
[S4] ⇄ pheromone p=0.171 → S8@127.0.0.1:52809
[S9] ⇄ pheromone p=0.133 → S17@127.0.0.1:52817
[S10] ⇄ pheromone p=0.138 → S14@127.0.0.1:52814
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=15 metric=0.7016 head_norm=1.388155
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.972588e-01
[S11] stored merged vector for next round verification (round=15)
[S11] DEBUG after merge:  round=15 metric=0.7016 head_norm=1.229923 delta_norm=0.297259
[S11] aggregate: ACCEPT kept=['S3', 'S5'] (k=2/2) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.174 → S8@127.0.0.1:52809
[S3] ⇄ pheromone p=0.144 → S11@127.0.0.1:52812
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=15 metric=0.7009 head_norm=1.174958
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.224981e-01
[S15] stored merged vector for next round verification (round=15)
[S15] DEBUG after merge:  round=15 metric=0.7021 head_norm=1.080091 delta_norm=0.322498
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.171 → S9@127.0.0.1:52810
[S16] ⇄ pheromone p=0.385 → S7@127.0.0.1:52808
[S13] ⇄ pheromone p=0.124 → S7@127.0.0.1:52808
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=15 metric=0.9973 head_norm=1.855824
[S14] _apply_head_vector_avg (torch): Δ‖w‖=9.746899e-02
[S14] stored merged vector for next round verification (round=15)
[S14] DEBUG after merge:  round=15 metric=0.9973 head_norm=1.862519 delta_norm=0.097469
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.284 → S8@127.0.0.1:52809
[S17] ⇄ pheromone p=0.169 → S13@127.0.0.1:52813
[S2] START round=16 head_norm_before_train=1.778729 (no previous merge yet)
[S2] round=16 local utility u=0.399035 metrics={'f1_val': 0.7108325448599232, 'auprc': 0.7778348468103029, 'loss_val': 0.6291187418447155, 'psi': 0.7376334656400751}-{'f1_val': 0.620075474607233, 'auprc': 0.7307466846375182, 'loss_val': 0.7413811726115646, 'psi': 0.6643439586193471}
[S3] START round=16 head_norm_before_train=1.657369 (no previous merge yet)
[S3] round=16 local utility u=0.000000 metrics={'f1_val': 0.6136514486208002, 'auprc': 0.9970308528314227, 'loss_val': 0.48549138196985697, 'psi': 0.7670032103050493}-{'f1_val': 0.7008317350254774, 'auprc': 0.9953064395783024, 'loss_val': 0.3190199858397839, 'psi': 0.8186216168466074}
[S4] START round=16 head_norm_before_train=1.880855 (no previous merge yet)
[S4] round=16 local utility u=0.000000 metrics={'f1_val': 0.9422942550013444, 'auprc': 0.9260185515439159, 'loss_val': 0.29263980829699365, 'psi': 0.9357839736183731}-{'f1_val': 0.945223083656461, 'auprc': 0.9656780181766901, 'loss_val': 0.2783070726574128, 'psi': 0.9534050574645527}
[S5] START round=16 head_norm_before_train=1.341659 cos_to_last_merge=0.8459 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.846
[S5] round=16 local utility u=0.060974 metrics={'f1_val': 0.7008563225598777, 'auprc': 0.7126161593867334, 'loss_val': 0.34241304466805983, 'psi': 0.70556025729062}-{'f1_val': 0.7008563225598777, 'auprc': 0.6855578252431398, 'loss_val': 0.3831866862314803, 'psi': 0.6947369236331825}
[S6] START round=16 head_norm_before_train=1.441805 cos_to_last_merge=0.8363 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.836
[S6] round=16 local utility u=0.860414 metrics={'f1_val': 0.8453806582661642, 'auprc': 0.9495728855682395, 'loss_val': 0.3496944515036828, 'psi': 0.8870575491869943}-{'f1_val': 0.6423623484090074, 'auprc': 0.8186330222509307, 'loss_val': 0.4595939460175795, 'psi': 0.7128706179457768}
[S7] START round=16 head_norm_before_train=1.146376 cos_to_last_merge=1.0000 (last merge round=15)
[S7] round=16 local utility u=1.000000 metrics={'f1_val': 0.6579530001281206, 'auprc': 0.7117000525393153, 'loss_val': 0.8032129880795461, 'psi': 0.6794518210925985}-{'f1_val': 0.3760115345305238, 'auprc': 0.572624971857032, 'loss_val': 0.891615197060384, 'psi': 0.4546569094611271}
[S8] START round=16 head_norm_before_train=0.934599 cos_to_last_merge=1.0000 (last merge round=15)
[S8] round=16 local utility u=0.005954 metrics={'f1_val': 0.996776381273096, 'auprc': 0.9948963696919528, 'loss_val': 0.22285389250403992, 'psi': 0.9960243766406387}-{'f1_val': 0.9964894426023416, 'auprc': 0.9969969398254535, 'loss_val': 0.23934269078894874, 'psi': 0.9966924414915864}
[S9] START round=16 head_norm_before_train=1.051212 cos_to_last_merge=0.9960 (last merge round=14)
[S9] round=16 local utility u=0.041587 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9981155825016442, 'loss_val': 0.26515816757549154, 'psi': 0.8199761814646689}-{'f1_val': 0.7012165807733519, 'auprc': 0.9988469028244343, 'loss_val': 0.3505251342336452, 'psi': 0.8202687095937848}
[S10] START round=16 head_norm_before_train=1.874266 (no previous merge yet)
[S10] round=16 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.996340625684645, 'loss_val': 0.03264118171187208, 'psi': 0.9956489536854829}-{'f1_val': 0.9956096535150197, 'auprc': 0.9963267463532405, 'loss_val': 0.03505628955184605, 'psi': 0.995896490650308}
[S11] START round=16 head_norm_before_train=1.229923 cos_to_last_merge=1.0000 (last merge round=15)
[S11] round=16 local utility u=0.004885 metrics={'f1_val': 0.7021118300140827, 'auprc': 0.8648863180127977, 'loss_val': 0.3955959532883188, 'psi': 0.7672216252135687}-{'f1_val': 0.7016282822309048, 'auprc': 0.8645313458420314, 'loss_val': 0.4013991238475394, 'psi': 0.7667895076753555}
[S13] START round=16 head_norm_before_train=0.897441 cos_to_last_merge=0.9948 (last merge round=14)
[S13] round=16 local utility u=0.307805 metrics={'f1_val': 0.6315813175422276, 'auprc': 0.6981590941458826, 'loss_val': 0.6495744019651069, 'psi': 0.6582124281836896}-{'f1_val': 0.5742639368326582, 'auprc': 0.6731910322799204, 'loss_val': 0.8463764556579011, 'psi': 0.6138347750115631}
[S14] START round=16 head_norm_before_train=1.862519 cos_to_last_merge=1.0000 (last merge round=15)
[S14] round=16 local utility u=0.026172 metrics={'f1_val': 0.9976737714957896, 'auprc': 0.9971574848889228, 'loss_val': 0.15142970997023766, 'psi': 0.9974672568530428}-{'f1_val': 0.9973283609287906, 'auprc': 0.9971572664446974, 'loss_val': 0.20170118314822705, 'psi': 0.9972599231351533}
[S15] START round=16 head_norm_before_train=1.080091 cos_to_last_merge=1.0000 (last merge round=15)
[S15] round=16 local utility u=0.541388 metrics={'f1_val': 0.8634082993095387, 'auprc': 0.9903652537069632, 'loss_val': 0.29693088064217593, 'psi': 0.9141910810685084}-{'f1_val': 0.7009191843683342, 'auprc': 0.9843797428700176, 'loss_val': 0.3868153956962346, 'psi': 0.8143034077690077}
[S16] START round=16 head_norm_before_train=1.316758 cos_to_last_merge=0.8417 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.842
[S16] round=16 local utility u=0.200392 metrics={'f1_val': 0.8588076454963626, 'auprc': 0.9951757459550843, 'loss_val': 0.4472287409384214, 'psi': 0.9133548856798512}-{'f1_val': 0.8175066684559673, 'auprc': 0.9531933609483378, 'loss_val': 0.474259388334652, 'psi': 0.8717813454529155}
[S17] START round=16 head_norm_before_train=0.837640 cos_to_last_merge=0.9872 (last merge round=14)
[S17] round=16 local utility u=0.000000 metrics={'f1_val': 0.35391560672066175, 'auprc': 0.6865293509743235, 'loss_val': 0.9499170458929165, 'psi': 0.4869611044221265}-{'f1_val': 0.35553677425124586, 'auprc': 0.6840384603863311, 'loss_val': 0.9343373236096237, 'psi': 0.48693744870528}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:52808
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:52810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:52808
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:52812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] → sending delta(kind=head bytes=1805) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:52815
[S6] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1805 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1803 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1800) from S6
[S17] cosine check vs S6: cos=0.5663
[S17] RECEIVED delta(kind=head bytes=1800) from S7
[S17] cosine check vs S7: cos=0.4998
[S8] RECEIVED delta(kind=head bytes=1805) from S11
[S8] cosine check vs S11: cos=0.7592
[S17] RECEIVED delta(kind=head bytes=1797) from S9
[S17] cosine check vs S9: cos=0.6570
[S15] RECEIVED delta(kind=head bytes=1796) from S8
[S15] cosine check vs S8: cos=0.9177
[S9] RECEIVED delta(kind=head bytes=1802) from S15
[S9] cosine check vs S15: cos=0.8963
[S8] RECEIVED delta(kind=head bytes=1803) from S14
[S8] cosine check vs S14: cos=0.5769
[S8] RECEIVED delta(kind=head bytes=1803) from S2
[S8] cosine check vs S2: cos=0.3606
[S7] RECEIVED delta(kind=head bytes=1795) from S13
[S7] cosine check vs S13: cos=0.5907
[S7] RECEIVED delta(kind=head bytes=1798) from S16
[S7] cosine check vs S16: cos=0.9864
[S11] RECEIVED delta(kind=head bytes=1796) from S5
[S11] cosine check vs S5: cos=0.5025
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=16 metric=0.9968 head_norm=1.027008
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.837105e-01
[S8] stored merged vector for next round verification (round=16)
[S8] DEBUG after merge:  round=16 metric=0.9968 head_norm=0.989564 delta_norm=0.183710
[S8] aggregate: ACCEPT kept=['S11', 'S14', 'S2'] (k=3/3) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=16 metric=0.6580 head_norm=1.161570
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.869225e-01
[S7] stored merged vector for next round verification (round=16)
[S7] DEBUG after merge:  round=16 metric=0.6268 head_norm=1.068760 delta_norm=0.186923
[S7] aggregate: ROLLBACK (f1_val pre=0.658 post=0.627 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=16 metric=0.8634 head_norm=1.149134
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.287324e-01
[S15] stored merged vector for next round verification (round=16)
[S15] DEBUG after merge:  round=16 metric=0.8812 head_norm=1.065509 delta_norm=0.228732
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=16 metric=0.7021 head_norm=1.263313
[S11] _apply_head_vector_avg (torch): Δ‖w‖=6.595803e-01
[S11] stored merged vector for next round verification (round=16)
[S11] DEBUG after merge:  round=16 metric=0.7019 head_norm=1.143511 delta_norm=0.659580
[S11] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=16 metric=0.7012 head_norm=1.107222
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.577177e-01
[S9] stored merged vector for next round verification (round=16)
[S9] DEBUG after merge:  round=16 metric=0.7012 head_norm=1.098547 delta_norm=0.257718
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=16 metric=0.3539 head_norm=0.899804
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.293661e-01
[S17] stored merged vector for next round verification (round=16)
[S17] DEBUG after merge:  round=16 metric=0.3547 head_norm=0.824916 delta_norm=0.229366
[S17] aggregate: ACCEPT kept=['S6', 'S7', 'S9'] (k=3/3) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.799929 (no previous merge yet)
[S2] round=17 local utility u=0.000000 metrics={'f1_val': 0.7028142767675309, 'auprc': 0.7701055832802175, 'loss_val': 0.6601209394076862, 'psi': 0.7297307993726057}-{'f1_val': 0.7108325448599232, 'auprc': 0.7778348468103029, 'loss_val': 0.6291187418447155, 'psi': 0.7376334656400751}
[S3] START round=17 head_norm_before_train=1.684214 (no previous merge yet)
[S3] round=17 local utility u=0.339834 metrics={'f1_val': 0.700330919019862, 'auprc': 0.9932603671600273, 'loss_val': 0.3145877992676263, 'psi': 0.8175026982759281}-{'f1_val': 0.6136514486208002, 'auprc': 0.9970308528314227, 'loss_val': 0.48549138196985697, 'psi': 0.7670032103050493}
[S4] START round=17 head_norm_before_train=1.890476 (no previous merge yet)
[S4] round=17 local utility u=0.140456 metrics={'f1_val': 0.955831600093139, 'auprc': 0.9796381469620533, 'loss_val': 0.253810064528688, 'psi': 0.9653542188407047}-{'f1_val': 0.9422942550013444, 'auprc': 0.9260185515439159, 'loss_val': 0.29263980829699365, 'psi': 0.9357839736183731}
[S5] START round=17 head_norm_before_train=1.374542 cos_to_last_merge=0.8352 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.835
[S5] round=17 local utility u=0.000000 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.6672405902363312, 'loss_val': 0.3199025947276901, 'psi': 0.6872612716921371}-{'f1_val': 0.7008563225598777, 'auprc': 0.7126161593867334, 'loss_val': 0.34241304466805983, 'psi': 0.70556025729062}
[S6] START round=17 head_norm_before_train=1.469208 cos_to_last_merge=0.8309 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.831
[S6] round=17 local utility u=0.000000 metrics={'f1_val': 0.5537018969893939, 'auprc': 0.7660469573846551, 'loss_val': 0.7680826555491176, 'psi': 0.6386399211474983}-{'f1_val': 0.8453806582661642, 'auprc': 0.9495728855682395, 'loss_val': 0.3496944515036828, 'psi': 0.8870575491869943}
[S7] START round=17 head_norm_before_train=1.068760 cos_to_last_merge=1.0000 (last merge round=16)
[S7] round=17 local utility u=0.043890 metrics={'f1_val': 0.6488020480575851, 'auprc': 0.7692103813711011, 'loss_val': 0.8330583380646088, 'psi': 0.6969653813829915}-{'f1_val': 0.6579530001281206, 'auprc': 0.7117000525393153, 'loss_val': 0.8032129880795461, 'psi': 0.6794518210925985}
[S8] START round=17 head_norm_before_train=0.989564 cos_to_last_merge=1.0000 (last merge round=16)
[S8] round=17 local utility u=0.018436 metrics={'f1_val': 0.9964894426023416, 'auprc': 0.9949697566017284, 'loss_val': 0.1844805728860318, 'psi': 0.9958815682020964}-{'f1_val': 0.996776381273096, 'auprc': 0.9948963696919528, 'loss_val': 0.22285389250403992, 'psi': 0.9960243766406387}
[S9] START round=17 head_norm_before_train=1.098547 cos_to_last_merge=1.0000 (last merge round=16)
[S9] round=17 local utility u=0.342586 metrics={'f1_val': 0.8172106848534494, 'auprc': 0.9981579471110806, 'loss_val': 0.27607818838837184, 'psi': 0.8895895897565019}-{'f1_val': 0.7012165807733519, 'auprc': 0.9981155825016442, 'loss_val': 0.26515816757549154, 'psi': 0.8199761814646689}
[S10] START round=17 head_norm_before_train=1.900522 (no previous merge yet)
[S10] round=17 local utility u=0.000637 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.99623134181936, 'loss_val': 0.031038490935150927, 'psi': 0.9956052401393689}-{'f1_val': 0.9951878390193748, 'auprc': 0.996340625684645, 'loss_val': 0.03264118171187208, 'psi': 0.9956489536854829}
[S11] START round=17 head_norm_before_train=1.143511 cos_to_last_merge=1.0000 (last merge round=16)
[S11] round=17 local utility u=0.000710 metrics={'f1_val': 0.7016282822309048, 'auprc': 0.8685075201575342, 'loss_val': 0.4021391584265715, 'psi': 0.7683799774015565}-{'f1_val': 0.7021118300140827, 'auprc': 0.8648863180127977, 'loss_val': 0.3955959532883188, 'psi': 0.7672216252135687}
[S13] START round=17 head_norm_before_train=0.954571 cos_to_last_merge=0.9855 (last merge round=14)
[S13] round=17 local utility u=0.000000 metrics={'f1_val': 0.5600100732058707, 'auprc': 0.719406618902514, 'loss_val': 0.8648672839398417, 'psi': 0.623768691484528}-{'f1_val': 0.6315813175422276, 'auprc': 0.6981590941458826, 'loss_val': 0.6495744019651069, 'psi': 0.6582124281836896}
[S14] START round=17 head_norm_before_train=1.898780 cos_to_last_merge=0.9996 (last merge round=15)
[S14] round=17 local utility u=0.019031 metrics={'f1_val': 0.997288414402867, 'auprc': 0.9957218360386275, 'loss_val': 0.10674944260331563, 'psi': 0.9966617830571711}-{'f1_val': 0.9976737714957896, 'auprc': 0.9971574848889228, 'loss_val': 0.15142970997023766, 'psi': 0.9974672568530428}
[S15] START round=17 head_norm_before_train=1.065509 cos_to_last_merge=1.0000 (last merge round=16)
[S15] round=17 local utility u=0.000000 metrics={'f1_val': 0.8016840835993725, 'auprc': 0.9625360885316423, 'loss_val': 0.42546710141670624, 'psi': 0.8660248855722804}-{'f1_val': 0.8634082993095387, 'auprc': 0.9903652537069632, 'loss_val': 0.29693088064217593, 'psi': 0.9141910810685084}
[S16] START round=17 head_norm_before_train=1.361209 cos_to_last_merge=0.8366 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.837
[S16] round=17 local utility u=0.518146 metrics={'f1_val': 0.9899268415033606, 'auprc': 0.9953317199686605, 'loss_val': 0.19812036441462536, 'psi': 0.9920887928894806}-{'f1_val': 0.8588076454963626, 'auprc': 0.9951757459550843, 'loss_val': 0.4472287409384214, 'psi': 0.9133548856798512}
[S17] START round=17 head_norm_before_train=0.824916 cos_to_last_merge=1.0000 (last merge round=16)
[S17] round=17 local utility u=0.000000 metrics={'f1_val': 0.3547823018633796, 'auprc': 0.6849501019929551, 'loss_val': 0.9525011429559141, 'psi': 0.48684942191520986}-{'f1_val': 0.35391560672066175, 'auprc': 0.6865293509743235, 'loss_val': 0.9499170458929165, 'psi': 0.4869611044221265}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S7] → sending delta(kind=head bytes=1792) to S17@127.0.0.1:52817
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1792 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1792) from S7
[S17] cosine check vs S7: cos=0.6842
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] → sending delta(kind=head bytes=1805) to S14@127.0.0.1:52814
[S10] sending update (kind=head size=1805 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1805) from S10
[S14] cosine check vs S10: cos=0.9944
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:52809
[S9] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:52809
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:52812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:52809
[S17] RECEIVED delta(kind=head bytes=1799) from S9
[S17] cosine check vs S9: cos=0.6991
[S14] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1801) from S3
[S11] cosine check vs S3: cos=0.5860
[S8] RECEIVED delta(kind=head bytes=1798) from S11
[S8] cosine check vs S11: cos=0.7474
[S8] RECEIVED delta(kind=head bytes=1797) from S4
[S8] cosine check vs S4: cos=0.0874
[S8] RECEIVED delta(kind=head bytes=1802) from S14
[S8] cosine check vs S14: cos=0.6005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S16] → sending delta(kind=head bytes=1808) to S7@127.0.0.1:52808
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1808 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1808) from S16
[S7] cosine check vs S16: cos=0.9578
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:52815
[S8] sending update (kind=head size=1801 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1801) from S8
[S15] cosine check vs S8: cos=0.9533
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=17 metric=0.6488 head_norm=1.083727
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.381065e-01
[S7] stored merged vector for next round verification (round=17)
[S7] DEBUG after merge:  round=17 metric=0.5290 head_norm=1.228064 delta_norm=0.238107
[S7] aggregate: ROLLBACK (f1_val pre=0.649 post=0.529 tol_abs=0.005 tol_rel=0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=17 metric=0.7016 head_norm=1.178940
[S11] _apply_head_vector_avg (torch): Δ‖w‖=6.978358e-01
[S11] stored merged vector for next round verification (round=17)
[S11] DEBUG after merge:  round=17 metric=0.7016 head_norm=1.291247 delta_norm=0.697836
[S11] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=17 metric=0.9965 head_norm=1.073704
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.490626e-01
[S8] stored merged vector for next round verification (round=17)
[S8] DEBUG after merge:  round=17 metric=0.9968 head_norm=0.999907 delta_norm=0.349063
[S8] aggregate: ACCEPT kept=['S11', 'S4', 'S14'] (k=3/3) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=17 metric=0.9973 head_norm=1.936884
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.019412e-01
[S14] stored merged vector for next round verification (round=17)
[S14] DEBUG after merge:  round=17 metric=0.9973 head_norm=1.927050 delta_norm=0.101941
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=17 metric=0.8017 head_norm=1.127441
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.702549e-01
[S15] stored merged vector for next round verification (round=17)
[S15] DEBUG after merge:  round=17 metric=0.8089 head_norm=1.087656 delta_norm=0.170255
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=17 metric=0.3548 head_norm=0.871034
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.583477e-01
[S17] stored merged vector for next round verification (round=17)
[S17] DEBUG after merge:  round=17 metric=0.3546 head_norm=0.859283 delta_norm=0.258348
[S17] aggregate: ACCEPT kept=['S7', 'S9'] (k=2/2) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.816548 (no previous merge yet)
[S2] round=18 local utility u=0.066922 metrics={'f1_val': 0.7138119327631763, 'auprc': 0.7968850391371486, 'loss_val': 0.6726013325212246, 'psi': 0.7470411753127653}-{'f1_val': 0.7028142767675309, 'auprc': 0.7701055832802175, 'loss_val': 0.6601209394076862, 'psi': 0.7297307993726057}
[S3] START round=18 head_norm_before_train=1.708418 (no previous merge yet)
[S3] round=18 local utility u=0.011119 metrics={'f1_val': 0.7005813959920884, 'auprc': 0.9945476699185782, 'loss_val': 0.2977146438955685, 'psi': 0.8181679055626843}-{'f1_val': 0.700330919019862, 'auprc': 0.9932603671600273, 'loss_val': 0.3145877992676263, 'psi': 0.8175026982759281}
[S4] START round=18 head_norm_before_train=1.900831 (no previous merge yet)
[S4] round=18 local utility u=0.000000 metrics={'f1_val': 0.9499514908428096, 'auprc': 0.9636635993186314, 'loss_val': 0.2805572843162984, 'psi': 0.9554363342331383}-{'f1_val': 0.955831600093139, 'auprc': 0.9796381469620533, 'loss_val': 0.253810064528688, 'psi': 0.9653542188407047}
[S5] START round=18 head_norm_before_train=1.402730 cos_to_last_merge=0.8269 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.827
[S5] round=18 local utility u=0.179291 metrics={'f1_val': 0.7012357505530417, 'auprc': 0.7931192134540329, 'loss_val': 0.34272097590064565, 'psi': 0.7379891357134382}-{'f1_val': 0.7006083926626743, 'auprc': 0.6672405902363312, 'loss_val': 0.3199025947276901, 'psi': 0.6872612716921371}
[S6] START round=18 head_norm_before_train=1.494775 cos_to_last_merge=0.8280 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.828
[S6] round=18 local utility u=1.000000 metrics={'f1_val': 0.9661257970390132, 'auprc': 0.9472677380032791, 'loss_val': 0.14583279206287247, 'psi': 0.9585825734247195}-{'f1_val': 0.5537018969893939, 'auprc': 0.7660469573846551, 'loss_val': 0.7680826555491176, 'psi': 0.6386399211474983}
[S7] START round=18 head_norm_before_train=1.228064 cos_to_last_merge=1.0000 (last merge round=17)
[S7] round=18 local utility u=0.000000 metrics={'f1_val': 0.42141136051554323, 'auprc': 0.7802009462109086, 'loss_val': 0.8500568929863048, 'psi': 0.5649271947936894}-{'f1_val': 0.6488020480575851, 'auprc': 0.7692103813711011, 'loss_val': 0.8330583380646088, 'psi': 0.6969653813829915}
[S8] START round=18 head_norm_before_train=0.999907 cos_to_last_merge=1.0000 (last merge round=17)
[S8] round=18 local utility u=0.000282 metrics={'f1_val': 0.996776381273096, 'auprc': 0.9957409443232876, 'loss_val': 0.18795274695349282, 'psi': 0.9963622064931728}-{'f1_val': 0.9964894426023416, 'auprc': 0.9949697566017284, 'loss_val': 0.1844805728860318, 'psi': 0.9958815682020964}
[S9] START round=18 head_norm_before_train=1.145379 cos_to_last_merge=0.9972 (last merge round=16)
[S9] round=18 local utility u=0.550454 metrics={'f1_val': 0.9886727075027679, 'auprc': 0.9981123944669841, 'loss_val': 0.20380474295367082, 'psi': 0.9924485822884543}-{'f1_val': 0.8172106848534494, 'auprc': 0.9981579471110806, 'loss_val': 0.27607818838837184, 'psi': 0.8895895897565019}
[S10] START round=18 head_norm_before_train=1.922580 (no previous merge yet)
[S10] round=18 local utility u=0.000149 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9959520497510633, 'loss_val': 0.029902076945937002, 'psi': 0.9954935233120501}-{'f1_val': 0.9951878390193748, 'auprc': 0.99623134181936, 'loss_val': 0.031038490935150927, 'psi': 0.9956052401393689}
[S11] START round=18 head_norm_before_train=1.291247 cos_to_last_merge=1.0000 (last merge round=17)
[S11] round=18 local utility u=0.011034 metrics={'f1_val': 0.7004948113508912, 'auprc': 0.8678252887591087, 'loss_val': 0.3712235937776399, 'psi': 0.7674270023141783}-{'f1_val': 0.7016282822309048, 'auprc': 0.8685075201575342, 'loss_val': 0.4021391584265715, 'psi': 0.7683799774015565}
[S13] START round=18 head_norm_before_train=1.008235 cos_to_last_merge=0.9753 (last merge round=14)
[S13] round=18 local utility u=0.160127 metrics={'f1_val': 0.5905373918095842, 'auprc': 0.7160160938117565, 'loss_val': 0.7176064534946484, 'psi': 0.6407288726104531}-{'f1_val': 0.5600100732058707, 'auprc': 0.719406618902514, 'loss_val': 0.8648672839398417, 'psi': 0.623768691484528}
[S14] START round=18 head_norm_before_train=1.927050 cos_to_last_merge=1.0000 (last merge round=17)
[S14] round=18 local utility u=0.008453 metrics={'f1_val': 0.9969987740343681, 'auprc': 0.9971564350993622, 'loss_val': 0.09240869063383571, 'psi': 0.9970618384603658}-{'f1_val': 0.997288414402867, 'auprc': 0.9957218360386275, 'loss_val': 0.10674944260331563, 'psi': 0.9966617830571711}
[S15] START round=18 head_norm_before_train=1.087656 cos_to_last_merge=1.0000 (last merge round=17)
[S15] round=18 local utility u=0.729343 metrics={'f1_val': 0.9963324108488076, 'auprc': 0.991643768785329, 'loss_val': 0.22199340910198853, 'psi': 0.9944569540234162}-{'f1_val': 0.8016840835993725, 'auprc': 0.9625360885316423, 'loss_val': 0.42546710141670624, 'psi': 0.8660248855722804}
[S16] START round=18 head_norm_before_train=1.398288 cos_to_last_merge=0.8324 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.832
[S16] round=18 local utility u=0.021017 metrics={'f1_val': 0.9888172133910814, 'auprc': 0.9970189267576578, 'loss_val': 0.15449020103953148, 'psi': 0.992097898737712}-{'f1_val': 0.9899268415033606, 'auprc': 0.9953317199686605, 'loss_val': 0.19812036441462536, 'psi': 0.9920887928894806}
[S17] START round=18 head_norm_before_train=0.859283 cos_to_last_merge=1.0000 (last merge round=17)
[S17] round=18 local utility u=0.010221 metrics={'f1_val': 0.3550930564774533, 'auprc': 0.6880740602892493, 'loss_val': 0.9432956259024398, 'psi': 0.4882854580021717}-{'f1_val': 0.3547823018633796, 'auprc': 0.6849501019929551, 'loss_val': 0.9525011429559141, 'psi': 0.48684942191520986}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:52808
[S11] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1796) from S13
[S7] cosine check vs S13: cos=0.5535
[S8] RECEIVED delta(kind=head bytes=1795) from S11
[S8] cosine check vs S11: cos=0.7306
[S8] RECEIVED delta(kind=head bytes=1796) from S14
[S8] cosine check vs S14: cos=0.6823
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] → sending delta(kind=head bytes=1805) to S7@127.0.0.1:52808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:52812
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:52814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] → sending delta(kind=head bytes=1805) to S9@127.0.0.1:52810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:52812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S8] → sending delta(kind=head bytes=1789) to S15@127.0.0.1:52815
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:52813
[S9] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1805 to 1 peers)
[S15] sending update (kind=head size=1805 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S17] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1789 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1798) from S5
[S11] cosine check vs S5: cos=0.4766
[S17] RECEIVED delta(kind=head bytes=1799) from S9
[S17] cosine check vs S9: cos=0.7867
[S17] RECEIVED delta(kind=head bytes=1800) from S6
[S17] cosine check vs S6: cos=0.3061
[S13] RECEIVED delta(kind=head bytes=1801) from S17
[S13] cosine check vs S17: cos=0.7975
[S7] RECEIVED delta(kind=head bytes=1805) from S16
[S7] cosine check vs S16: cos=0.9887
[S14] RECEIVED delta(kind=head bytes=1803) from S10
[S14] cosine check vs S10: cos=0.9971
[S15] RECEIVED delta(kind=head bytes=1789) from S8
[S15] cosine check vs S8: cos=0.9297
[S9] RECEIVED delta(kind=head bytes=1805) from S15
[S9] cosine check vs S15: cos=0.9128
[S11] RECEIVED delta(kind=head bytes=1798) from S3
[S11] cosine check vs S3: cos=0.9243
[S8] RECEIVED delta(kind=head bytes=1802) from S2
[S8] cosine check vs S2: cos=0.2061
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=18 metric=0.4214 head_norm=1.241526
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.155183e-01
[S7] stored merged vector for next round verification (round=18)
[S7] DEBUG after merge:  round=18 metric=0.4649 head_norm=1.135476 delta_norm=0.215518
[S7] aggregate: ACCEPT kept=['S13', 'S16'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=18 metric=0.9968 head_norm=1.088644
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.300779e-01
[S8] stored merged vector for next round verification (round=18)
[S8] DEBUG after merge:  round=18 metric=0.9968 head_norm=1.028336 delta_norm=0.230078
[S8] aggregate: ACCEPT kept=['S11', 'S14', 'S2'] (k=3/3) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=18 metric=0.9963 head_norm=1.158646
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.134991e-01
[S15] stored merged vector for next round verification (round=18)
[S15] DEBUG after merge:  round=18 metric=0.9963 head_norm=1.103731 delta_norm=0.213499
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=18 metric=0.9887 head_norm=1.195235
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.464711e-01
[S9] stored merged vector for next round verification (round=18)
[S9] DEBUG after merge:  round=18 metric=0.9908 head_norm=1.150989 delta_norm=0.246471
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=18 metric=0.7005 head_norm=1.329146
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.905951e-01
[S11] stored merged vector for next round verification (round=18)
[S11] DEBUG after merge:  round=18 metric=0.7010 head_norm=1.245824 delta_norm=0.190595
[S11] aggregate: ACCEPT kept=['S5', 'S3'] (k=2/2) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=18 metric=0.5905 head_norm=1.058111
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.206308e-01
[S13] stored merged vector for next round verification (round=18)
[S13] DEBUG after merge:  round=18 metric=0.6057 head_norm=0.931038 delta_norm=0.320631
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=18 metric=0.9970 head_norm=1.961630
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.471874e-02
[S14] stored merged vector for next round verification (round=18)
[S14] DEBUG after merge:  round=18 metric=0.9972 head_norm=1.949211 delta_norm=0.074719
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=18 metric=0.3551 head_norm=0.905358
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.737681e-01
[S17] stored merged vector for next round verification (round=18)
[S17] DEBUG after merge:  round=18 metric=0.3557 head_norm=0.880627 delta_norm=0.373768
[S17] aggregate: ACCEPT kept=['S9', 'S6'] (k=2/2) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.839027 (no previous merge yet)
[S2] round=19 local utility u=0.000000 metrics={'f1_val': 0.7166325808589236, 'auprc': 0.7921843363965884, 'loss_val': 0.7852129510510858, 'psi': 0.7468532830739896}-{'f1_val': 0.7138119327631763, 'auprc': 0.7968850391371486, 'loss_val': 0.6726013325212246, 'psi': 0.7470411753127653}
[S3] START round=19 head_norm_before_train=1.730800 (no previous merge yet)
[S3] round=19 local utility u=0.017257 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.998908075551959, 'loss_val': 0.27733165665142373, 'psi': 0.8200169524619634}-{'f1_val': 0.7005813959920884, 'auprc': 0.9945476699185782, 'loss_val': 0.2977146438955685, 'psi': 0.8181679055626843}
[S4] START round=19 head_norm_before_train=1.905170 (no previous merge yet)
[S4] round=19 local utility u=0.000000 metrics={'f1_val': 0.941341517857042, 'auprc': 0.9424844062977542, 'loss_val': 0.29217115478506245, 'psi': 0.941798673233327}-{'f1_val': 0.9499514908428096, 'auprc': 0.9636635993186314, 'loss_val': 0.2805572843162984, 'psi': 0.9554363342331383}
[S5] START round=19 head_norm_before_train=1.428953 cos_to_last_merge=0.8209 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.821
[S5] round=19 local utility u=0.299770 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9790424476278521, 'loss_val': 0.2971863683607463, 'psi': 0.8119820146487454}-{'f1_val': 0.7012357505530417, 'auprc': 0.7931192134540329, 'loss_val': 0.34272097590064565, 'psi': 0.7379891357134382}
[S6] START round=19 head_norm_before_train=1.516696 cos_to_last_merge=0.8249 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.825
[S6] round=19 local utility u=0.000000 metrics={'f1_val': 0.8435472099974005, 'auprc': 0.9569702132411673, 'loss_val': 0.3857081165211407, 'psi': 0.8889164112949072}-{'f1_val': 0.9661257970390132, 'auprc': 0.9472677380032791, 'loss_val': 0.14583279206287247, 'psi': 0.9585825734247195}
[S7] START round=19 head_norm_before_train=1.135476 cos_to_last_merge=1.0000 (last merge round=18)
[S7] round=19 local utility u=0.718823 metrics={'f1_val': 0.6491723083944635, 'auprc': 0.7796863363056236, 'loss_val': 0.7774326371591613, 'psi': 0.7013779195589276}-{'f1_val': 0.42141136051554323, 'auprc': 0.7802009462109086, 'loss_val': 0.8500568929863048, 'psi': 0.5649271947936894}
[S8] START round=19 head_norm_before_train=1.028336 cos_to_last_merge=1.0000 (last merge round=18)
[S8] round=19 local utility u=0.016998 metrics={'f1_val': 0.996776381273096, 'auprc': 0.9953566324158809, 'loss_val': 0.15280451116900576, 'psi': 0.9962084817302099}-{'f1_val': 0.996776381273096, 'auprc': 0.9957409443232876, 'loss_val': 0.18795274695349282, 'psi': 0.9963622064931728}
[S9] START round=19 head_norm_before_train=1.150989 cos_to_last_merge=1.0000 (last merge round=18)
[S9] round=19 local utility u=0.014065 metrics={'f1_val': 0.9945775144926113, 'auprc': 0.9985013009829689, 'loss_val': 0.21227051747942283, 'psi': 0.9961470290887544}-{'f1_val': 0.9886727075027679, 'auprc': 0.9981123944669841, 'loss_val': 0.20380474295367082, 'psi': 0.9924485822884543}
[S10] START round=19 head_norm_before_train=1.939594 (no previous merge yet)
[S10] round=19 local utility u=0.000000 metrics={'f1_val': 0.995182342619192, 'auprc': 0.9951323149755327, 'loss_val': 0.029334642902126583, 'psi': 0.9951623315617282}-{'f1_val': 0.9951878390193748, 'auprc': 0.9959520497510633, 'loss_val': 0.029902076945937002, 'psi': 0.9954935233120501}
[S11] START round=19 head_norm_before_train=1.245824 cos_to_last_merge=1.0000 (last merge round=18)
[S11] round=19 local utility u=0.096479 metrics={'f1_val': 0.7018701185892477, 'auprc': 0.9193667248138176, 'loss_val': 0.34114168733333533, 'psi': 0.7888687610790757}-{'f1_val': 0.7004948113508912, 'auprc': 0.8678252887591087, 'loss_val': 0.3712235937776399, 'psi': 0.7674270023141783}
[S13] START round=19 head_norm_before_train=0.931038 cos_to_last_merge=1.0000 (last merge round=18)
[S13] round=19 local utility u=0.000000 metrics={'f1_val': 0.6014853370084625, 'auprc': 0.691706976263348, 'loss_val': 0.7461855777767757, 'psi': 0.6375739927104167}-{'f1_val': 0.5905373918095842, 'auprc': 0.7160160938117565, 'loss_val': 0.7176064534946484, 'psi': 0.6407288726104531}
[S14] START round=19 head_norm_before_train=1.949211 cos_to_last_merge=1.0000 (last merge round=18)
[S14] round=19 local utility u=0.005844 metrics={'f1_val': 0.9970684233841665, 'auprc': 0.9971966057721239, 'loss_val': 0.08125869984274198, 'psi': 0.9971196963393494}-{'f1_val': 0.9969987740343681, 'auprc': 0.9971564350993622, 'loss_val': 0.09240869063383571, 'psi': 0.9970618384603658}
[S15] START round=19 head_norm_before_train=1.103731 cos_to_last_merge=1.0000 (last merge round=18)
[S15] round=19 local utility u=0.012259 metrics={'f1_val': 0.9943844343250337, 'auprc': 0.9946752987773468, 'loss_val': 0.19488187235919247, 'psi': 0.9945007801059589}-{'f1_val': 0.9963324108488076, 'auprc': 0.991643768785329, 'loss_val': 0.22199340910198853, 'psi': 0.9944569540234162}
[S16] START round=19 head_norm_before_train=1.432679 cos_to_last_merge=0.8290 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.829
[S16] round=19 local utility u=0.000000 metrics={'f1_val': 0.8317667007573121, 'auprc': 0.99655479924096, 'loss_val': 0.5923171451917587, 'psi': 0.8976819401507713}-{'f1_val': 0.9888172133910814, 'auprc': 0.9970189267576578, 'loss_val': 0.15449020103953148, 'psi': 0.992097898737712}
[S17] START round=19 head_norm_before_train=0.880627 cos_to_last_merge=1.0000 (last merge round=18)
[S17] round=19 local utility u=0.007774 metrics={'f1_val': 0.35725566491187916, 'auprc': 0.6883034440903593, 'loss_val': 0.9414111704659862, 'psi': 0.4896747765832712}-{'f1_val': 0.3550930564774533, 'auprc': 0.6880740602892493, 'loss_val': 0.9432956259024398, 'psi': 0.4882854580021717}
[S14] not sending this round → trigger blocked (psi=0.997)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.995)
[S3] not sending this round → trigger blocked (psi=0.820)
[S5] not sending this round → trigger blocked (psi=0.812)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.996)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.996)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.789)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] → sending delta(kind=head bytes=1794) to S17@127.0.0.1:52817
[S7] sending update (kind=head size=1794 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1794) from S7
[S17] cosine check vs S7: cos=0.5396
[S17] not sending this round → trigger blocked (psi=0.490)
[S9] r=20 psi=0.996 u=0.0141 p_local=0.1937 f1=0.995 auprc=0.999 bytes=19758
[S5] r=20 psi=0.812 u=0.2998 p_local=0.1836 f1=0.701 auprc=0.979 bytes=17950
[S2] r=20 psi=0.747 u=0.0000 p_local=0.1615 f1=0.717 auprc=0.792 bytes=14400
[S13] r=20 psi=0.638 u=0.0000 p_local=0.1079 f1=0.601 auprc=0.692 bytes=12577
[S14] r=20 psi=0.997 u=0.0058 p_local=0.1238 f1=0.997 auprc=0.997 bytes=14410
[S4] r=20 psi=0.942 u=0.0000 p_local=0.0879 f1=0.941 auprc=0.942 bytes=12591
[S3] r=20 psi=0.820 u=0.0173 p_local=0.1076 f1=0.701 auprc=0.999 bytes=21589
[S11] r=20 psi=0.789 u=0.0965 p_local=0.0931 f1=0.702 auprc=0.919 bytes=23371
[S6] r=20 psi=0.889 u=0.0000 p_local=0.3945 f1=0.844 auprc=0.957 bytes=14387
[S8] r=20 psi=0.996 u=0.0170 p_local=0.0872 f1=0.997 auprc=0.995 bytes=21575
[S10] r=20 psi=0.995 u=0.0000 p_local=0.0567 f1=0.995 auprc=0.995 bytes=21628
[S15] r=20 psi=0.995 u=0.0123 p_local=0.2446 f1=0.994 auprc=0.995 bytes=16192
[S7] r=20 psi=0.701 u=0.7188 p_local=0.2889 f1=0.649 auprc=0.780 bytes=14364
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=19 metric=0.3573 head_norm=0.928595
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.080849e-01
[S17] stored merged vector for next round verification (round=19)
[S17] DEBUG after merge:  round=19 metric=0.3566 head_norm=0.913471 delta_norm=0.508085
[S17] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S17] r=20 psi=0.490 u=0.0078 p_local=0.0725 f1=0.357 auprc=0.688 bytes=12586
[S16] r=20 psi=0.898 u=0.0000 p_local=0.2481 f1=0.832 auprc=0.997 bytes=21569
[S2] START round=20 head_norm_before_train=1.861539 (no previous merge yet)
[S2] round=20 local utility u=0.000000 metrics={'f1_val': 0.6566971751721372, 'auprc': 0.7427249296462426, 'loss_val': 0.8429288673523999, 'psi': 0.6911082769617793}-{'f1_val': 0.7166325808589236, 'auprc': 0.7921843363965884, 'loss_val': 0.7852129510510858, 'psi': 0.7468532830739896}
[S3] START round=20 head_norm_before_train=1.754547 (no previous merge yet)
[S3] round=20 local utility u=0.005014 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9988197057825223, 'loss_val': 0.26658779353520556, 'psi': 0.8199364581122097}-{'f1_val': 0.7007562037352997, 'auprc': 0.998908075551959, 'loss_val': 0.27733165665142373, 'psi': 0.8200169524619634}
[S4] START round=20 head_norm_before_train=1.915298 (no previous merge yet)
[S4] round=20 local utility u=0.000000 metrics={'f1_val': 0.9397773034522405, 'auprc': 0.9254055540624663, 'loss_val': 0.30199730518787055, 'psi': 0.9340286036963308}-{'f1_val': 0.941341517857042, 'auprc': 0.9424844062977542, 'loss_val': 0.29217115478506245, 'psi': 0.941798673233327}
[S5] START round=20 head_norm_before_train=1.448711 cos_to_last_merge=0.8148 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.815
[S5] round=20 local utility u=0.033772 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9978393871710882, 'loss_val': 0.2860333984868251, 'psi': 0.8195007904660399}-{'f1_val': 0.7006083926626743, 'auprc': 0.9790424476278521, 'loss_val': 0.2971863683607463, 'psi': 0.8119820146487454}
[S6] START round=20 head_norm_before_train=1.533374 cos_to_last_merge=0.8223 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.822
[S6] round=20 local utility u=0.000000 metrics={'f1_val': 0.8385962690764054, 'auprc': 0.953015535519777, 'loss_val': 0.4298019945292335, 'psi': 0.884363975653754}-{'f1_val': 0.8435472099974005, 'auprc': 0.9569702132411673, 'loss_val': 0.3857081165211407, 'psi': 0.8889164112949072}
[S7] START round=20 head_norm_before_train=1.150161 cos_to_last_merge=0.9996 (last merge round=18)
[S7] round=20 local utility u=0.000000 metrics={'f1_val': 0.3938102085845886, 'auprc': 0.7014437489844639, 'loss_val': 0.9078211689052038, 'psi': 0.5168636247445387}-{'f1_val': 0.6491723083944635, 'auprc': 0.7796863363056236, 'loss_val': 0.7774326371591613, 'psi': 0.7013779195589276}
[S8] START round=20 head_norm_before_train=1.118068 cos_to_last_merge=0.9944 (last merge round=18)
[S8] round=20 local utility u=0.024406 metrics={'f1_val': 0.9963402451333164, 'auprc': 0.9950837785939056, 'loss_val': 0.10055789547764747, 'psi': 0.9958376585175521}-{'f1_val': 0.996776381273096, 'auprc': 0.9953566324158809, 'loss_val': 0.15280451116900576, 'psi': 0.9962084817302099}
[S9] START round=20 head_norm_before_train=1.193894 cos_to_last_merge=0.9978 (last merge round=18)
[S9] round=20 local utility u=0.038743 metrics={'f1_val': 0.9962421144756511, 'auprc': 0.9983908410839388, 'loss_val': 0.1444411086031328, 'psi': 0.9971016051189663}-{'f1_val': 0.9945775144926113, 'auprc': 0.9985013009829689, 'loss_val': 0.21227051747942283, 'psi': 0.9961470290887544}
[S10] START round=20 head_norm_before_train=1.958334 (no previous merge yet)
[S10] round=20 local utility u=0.001637 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9959542764390388, 'loss_val': 0.02855899282738849, 'psi': 0.9954944139872404}-{'f1_val': 0.995182342619192, 'auprc': 0.9951323149755327, 'loss_val': 0.029334642902126583, 'psi': 0.9951623315617282}
[S11] START round=20 head_norm_before_train=1.278558 cos_to_last_merge=0.9991 (last merge round=18)
[S11] round=20 local utility u=0.045914 metrics={'f1_val': 0.7018701185892477, 'auprc': 0.9418454073427027, 'loss_val': 0.3167496553676594, 'psi': 0.7978602340906298}-{'f1_val': 0.7018701185892477, 'auprc': 0.9193667248138176, 'loss_val': 0.34114168733333533, 'psi': 0.7888687610790757}
[S13] START round=20 head_norm_before_train=0.990348 cos_to_last_merge=0.9975 (last merge round=18)
[S13] round=20 local utility u=0.060438 metrics={'f1_val': 0.6353700298840254, 'auprc': 0.6575336031774466, 'loss_val': 0.7260984188254967, 'psi': 0.6442354592013939}-{'f1_val': 0.6014853370084625, 'auprc': 0.691706976263348, 'loss_val': 0.7461855777767757, 'psi': 0.6375739927104167}
[S14] START round=20 head_norm_before_train=1.976477 cos_to_last_merge=0.9998 (last merge round=18)
[S14] round=20 local utility u=0.007844 metrics={'f1_val': 0.9976516241010662, 'auprc': 0.9972069391385837, 'loss_val': 0.06910077082015183, 'psi': 0.9974737501160732}-{'f1_val': 0.9970684233841665, 'auprc': 0.9971966057721239, 'loss_val': 0.08125869984274198, 'psi': 0.9971196963393494}
[S15] START round=20 head_norm_before_train=1.183574 cos_to_last_merge=0.9931 (last merge round=18)
[S15] round=20 local utility u=0.000000 metrics={'f1_val': 0.8442416821556299, 'auprc': 0.9924649537787955, 'loss_val': 0.27627482639472295, 'psi': 0.9035309908048961}-{'f1_val': 0.9943844343250337, 'auprc': 0.9946752987773468, 'loss_val': 0.19488187235919247, 'psi': 0.9945007801059589}
[S16] START round=20 head_norm_before_train=1.463380 cos_to_last_merge=0.8263 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.826
[S16] round=20 local utility u=0.692170 metrics={'f1_val': 0.9831273390950548, 'auprc': 0.9984068984435949, 'loss_val': 0.12169787548472566, 'psi': 0.9892391628344708}-{'f1_val': 0.8317667007573121, 'auprc': 0.99655479924096, 'loss_val': 0.5923171451917587, 'psi': 0.8976819401507713}
[S17] START round=20 head_norm_before_train=0.913471 cos_to_last_merge=1.0000 (last merge round=19)
[S17] round=20 local utility u=0.445230 metrics={'f1_val': 0.3905241364154228, 'auprc': 0.8367900698889622, 'loss_val': 0.6960216680107056, 'psi': 0.5690305098048386}-{'f1_val': 0.35725566491187916, 'auprc': 0.6883034440903593, 'loss_val': 0.9414111704659862, 'psi': 0.4896747765832712}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:52808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:52815
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:52814
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:52808
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:52812
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S11@127.0.0.1:52812
[S3] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1802) from S9
[S17] cosine check vs S9: cos=0.5960
[S14] RECEIVED delta(kind=head bytes=1800) from S10
[S14] cosine check vs S10: cos=0.9973
[S15] RECEIVED delta(kind=head bytes=1796) from S8
[S15] cosine check vs S8: cos=0.9401
[S8] RECEIVED delta(kind=head bytes=1798) from S11
[S8] cosine check vs S11: cos=0.7561
[S8] RECEIVED delta(kind=head bytes=1798) from S14
[S8] cosine check vs S14: cos=0.6361
[S7] RECEIVED delta(kind=head bytes=1802) from S16
[S7] cosine check vs S16: cos=0.9509
[S11] RECEIVED delta(kind=head bytes=1803) from S3
[S11] cosine check vs S3: cos=0.8684
[S7] RECEIVED delta(kind=head bytes=1797) from S13
[S7] cosine check vs S13: cos=0.7296
[S11] RECEIVED delta(kind=head bytes=1802) from S5
[S11] cosine check vs S5: cos=0.5790
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:52813
[S17] sending update (kind=head size=1798 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1798) from S17
[S13] cosine check vs S17: cos=0.8875
[S6] ⇄ pheromone p=0.316 → S17@127.0.0.1:52817
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=20 metric=0.3938 head_norm=1.164295
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.063131e-01
[S7] stored merged vector for next round verification (round=20)
[S7] DEBUG after merge:  round=20 metric=0.3967 head_norm=1.133726 delta_norm=0.106313
[S7] aggregate: ACCEPT kept=['S16', 'S13'] (k=2/2) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.231 → S17@127.0.0.1:52817
[S4] ⇄ pheromone p=0.070 → S8@127.0.0.1:52809
[S3] ⇄ pheromone p=0.087 → S11@127.0.0.1:52812
[S2] ⇄ pheromone p=0.129 → S8@127.0.0.1:52809
[S9] ⇄ pheromone p=0.163 → S17@127.0.0.1:52817
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=20 metric=0.7019 head_norm=1.312213
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.297394e-01
[S11] stored merged vector for next round verification (round=20)
[S11] DEBUG after merge:  round=20 metric=0.7019 head_norm=1.259615 delta_norm=0.129739
[S11] aggregate: ACCEPT kept=['S3', 'S5'] (k=2/2) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.084 → S8@127.0.0.1:52809
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=20 metric=0.9977 head_norm=2.001011
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.480568e-02
[S14] stored merged vector for next round verification (round=20)
[S14] DEBUG after merge:  round=20 metric=0.9977 head_norm=1.984696 delta_norm=0.074806
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.101 → S8@127.0.0.1:52809
[S5] ⇄ pheromone p=0.154 → S11@127.0.0.1:52812
[S10] ⇄ pheromone p=0.046 → S14@127.0.0.1:52814
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=20 metric=0.9963 head_norm=1.203040
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.574479e-01
[S8] stored merged vector for next round verification (round=20)
[S8] DEBUG after merge:  round=20 metric=0.9963 head_norm=1.220765 delta_norm=0.357448
[S8] aggregate: ACCEPT kept=['S11', 'S14'] (k=2/2) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.075 → S15@127.0.0.1:52815
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=20 metric=0.3905 head_norm=0.958143
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.106194e-01
[S17] stored merged vector for next round verification (round=20)
[S17] DEBUG after merge:  round=20 metric=0.3925 head_norm=0.985040 delta_norm=0.510619
[S17] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.147 → S13@127.0.0.1:52813
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=20 metric=0.8442 head_norm=1.270289
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.165965e-01
[S15] stored merged vector for next round verification (round=20)
[S15] DEBUG after merge:  round=20 metric=0.8668 head_norm=1.218013 delta_norm=0.216597
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.196 → S9@127.0.0.1:52810
[S16] ⇄ pheromone p=0.337 → S7@127.0.0.1:52808
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=20 metric=0.6354 head_norm=1.058064
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.439293e-01
[S13] stored merged vector for next round verification (round=20)
[S13] DEBUG after merge:  round=20 metric=0.6044 head_norm=0.979422 delta_norm=0.243929
[S13] aggregate: ROLLBACK (f1_val pre=0.635 post=0.604 tol_abs=0.005 tol_rel=0.0)
[S13] ⇄ pheromone p=0.098 → S7@127.0.0.1:52808
[S2] START round=21 head_norm_before_train=1.886758 (no previous merge yet)
[S2] round=21 local utility u=0.000000 metrics={'f1_val': 0.5210290581573588, 'auprc': 0.609982912998473, 'loss_val': 1.6269006209763495, 'psi': 0.5566106000938045}-{'f1_val': 0.6566971751721372, 'auprc': 0.7427249296462426, 'loss_val': 0.8429288673523999, 'psi': 0.6911082769617793}
[S3] START round=21 head_norm_before_train=1.777429 (no previous merge yet)
[S3] round=21 local utility u=0.005013 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.999071708272389, 'loss_val': 0.2573176560421507, 'psi': 0.8200372591081564}-{'f1_val': 0.7006809596653347, 'auprc': 0.9988197057825223, 'loss_val': 0.26658779353520556, 'psi': 0.8199364581122097}
[S4] START round=21 head_norm_before_train=1.928839 (no previous merge yet)
[S4] round=21 local utility u=0.029196 metrics={'f1_val': 0.9445953175755929, 'auprc': 0.9295539793351029, 'loss_val': 0.28495930069688813, 'psi': 0.9385787822793968}-{'f1_val': 0.9397773034522405, 'auprc': 0.9254055540624663, 'loss_val': 0.30199730518787055, 'psi': 0.9340286036963308}
[S5] START round=21 head_norm_before_train=1.466569 cos_to_last_merge=0.8081 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.808
[S5] round=21 local utility u=0.000000 metrics={'f1_val': 0.7067338603617284, 'auprc': 0.7960226444323013, 'loss_val': 0.3792641646327474, 'psi': 0.7424493739899576}-{'f1_val': 0.7006083926626743, 'auprc': 0.9978393871710882, 'loss_val': 0.2860333984868251, 'psi': 0.8195007904660399}
[S6] START round=21 head_norm_before_train=1.552269 cos_to_last_merge=0.8205 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.821
[S6] round=21 local utility u=0.515654 metrics={'f1_val': 0.9639693581701005, 'auprc': 0.9532956269151761, 'loss_val': 0.15157334106376988, 'psi': 0.9596998656681308}-{'f1_val': 0.8385962690764054, 'auprc': 0.953015535519777, 'loss_val': 0.4298019945292335, 'psi': 0.884363975653754}
[S7] START round=21 head_norm_before_train=1.133726 cos_to_last_merge=1.0000 (last merge round=20)
[S7] round=21 local utility u=0.951734 metrics={'f1_val': 0.6438275039448396, 'auprc': 0.7802290311755338, 'loss_val': 0.7408123050423524, 'psi': 0.6983881148371173}-{'f1_val': 0.3938102085845886, 'auprc': 0.7014437489844639, 'loss_val': 0.9078211689052038, 'psi': 0.5168636247445387}
[S8] START round=21 head_norm_before_train=1.220765 cos_to_last_merge=1.0000 (last merge round=20)
[S8] round=21 local utility u=0.000000 metrics={'f1_val': 0.9948403229310986, 'auprc': 0.9912724459879408, 'loss_val': 0.15730101431981758, 'psi': 0.9934131721538355}-{'f1_val': 0.9963402451333164, 'auprc': 0.9950837785939056, 'loss_val': 0.10055789547764747, 'psi': 0.9958376585175521}
[S9] START round=21 head_norm_before_train=1.242591 cos_to_last_merge=0.9924 (last merge round=18)
[S9] round=21 local utility u=0.012130 metrics={'f1_val': 0.9946069829493691, 'auprc': 0.9986609553677387, 'loss_val': 0.11117977367652936, 'psi': 0.996228571916717}-{'f1_val': 0.9962421144756511, 'auprc': 0.9983908410839388, 'loss_val': 0.1444411086031328, 'psi': 0.9971016051189663}
[S10] START round=21 head_norm_before_train=1.971086 (no previous merge yet)
[S10] round=21 local utility u=0.000973 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9963116194822632, 'loss_val': 0.027685306905131338, 'psi': 0.9956373512045301}-{'f1_val': 0.9951878390193748, 'auprc': 0.9959542764390388, 'loss_val': 0.02855899282738849, 'psi': 0.9954944139872404}
[S11] START round=21 head_norm_before_train=1.259615 cos_to_last_merge=1.0000 (last merge round=20)
[S11] round=21 local utility u=0.063649 metrics={'f1_val': 0.7018701185892477, 'auprc': 0.9838735597766303, 'loss_val': 0.3155360912132801, 'psi': 0.8146714950642008}-{'f1_val': 0.7018701185892477, 'auprc': 0.9418454073427027, 'loss_val': 0.3167496553676594, 'psi': 0.7978602340906298}
[S13] START round=21 head_norm_before_train=0.979422 cos_to_last_merge=1.0000 (last merge round=20)
[S13] round=21 local utility u=0.000000 metrics={'f1_val': 0.6122464102474038, 'auprc': 0.7210771759229003, 'loss_val': 0.7840869095290596, 'psi': 0.6557787165176023}-{'f1_val': 0.6353700298840254, 'auprc': 0.6575336031774466, 'loss_val': 0.7260984188254967, 'psi': 0.6442354592013939}
[S14] START round=21 head_norm_before_train=1.984696 cos_to_last_merge=1.0000 (last merge round=20)
[S14] round=21 local utility u=0.004293 metrics={'f1_val': 0.9970427648353635, 'auprc': 0.9992213150654168, 'loss_val': 0.0629057044421633, 'psi': 0.9979141849273847}-{'f1_val': 0.9976516241010662, 'auprc': 0.9972069391385837, 'loss_val': 0.06910077082015183, 'psi': 0.9974737501160732}
[S15] START round=21 head_norm_before_train=1.218013 cos_to_last_merge=1.0000 (last merge round=20)
[S15] round=21 local utility u=0.531766 metrics={'f1_val': 0.9951981759039306, 'auprc': 0.9962857677685303, 'loss_val': 0.12994486892949914, 'psi': 0.9956332126497704}-{'f1_val': 0.8442416821556299, 'auprc': 0.9924649537787955, 'loss_val': 0.27627482639472295, 'psi': 0.9035309908048961}
[S16] START round=21 head_norm_before_train=1.489561 cos_to_last_merge=0.8243 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.824
[S16] round=21 local utility u=0.048777 metrics={'f1_val': 0.9931208718948594, 'auprc': 0.9974473679967177, 'loss_val': 0.0812266834915669, 'psi': 0.9948514703356027}-{'f1_val': 0.9831273390950548, 'auprc': 0.9984068984435949, 'loss_val': 0.12169787548472566, 'psi': 0.9892391628344708}
[S17] START round=21 head_norm_before_train=0.985040 cos_to_last_merge=1.0000 (last merge round=20)
[S17] round=21 local utility u=0.035422 metrics={'f1_val': 0.3927733760908926, 'auprc': 0.8512674431356039, 'loss_val': 0.6821043927327343, 'psi': 0.5761710029087771}-{'f1_val': 0.3905241364154228, 'auprc': 0.8367900698889622, 'loss_val': 0.6960216680107056, 'psi': 0.5690305098048386}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S11@127.0.0.1:52812
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:52809
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:52814
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:52810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S16] → sending delta(kind=head bytes=1792) to S7@127.0.0.1:52808
[S11] sending update (kind=head size=1803 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1792 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S3] sending update (kind=head size=1804 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1795 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1803) from S11
[S8] cosine check vs S11: cos=0.7629
[S17] RECEIVED delta(kind=head bytes=1799) from S7
[S17] cosine check vs S7: cos=0.6900
[S17] RECEIVED delta(kind=head bytes=1800) from S6
[S17] cosine check vs S6: cos=0.2172
[S17] RECEIVED delta(kind=head bytes=1797) from S9
[S17] cosine check vs S9: cos=0.9074
[S14] RECEIVED delta(kind=head bytes=1799) from S10
[S14] cosine check vs S10: cos=0.9986
[S9] RECEIVED delta(kind=head bytes=1796) from S15
[S9] cosine check vs S15: cos=0.9288
[S8] RECEIVED delta(kind=head bytes=1803) from S14
[S8] cosine check vs S14: cos=0.7827
[S8] RECEIVED delta(kind=head bytes=1795) from S4
[S8] cosine check vs S4: cos=0.0513
[S7] RECEIVED delta(kind=head bytes=1792) from S16
[S7] cosine check vs S16: cos=0.9320
[S11] RECEIVED delta(kind=head bytes=1804) from S3
[S11] cosine check vs S3: cos=0.8375
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:52813
[S17] sending update (kind=head size=1801 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1801) from S17
[S13] cosine check vs S17: cos=0.8593
[S8] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=21 metric=0.9948 head_norm=1.273302
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.012153e-01
[S8] stored merged vector for next round verification (round=21)
[S8] DEBUG after merge:  round=21 metric=0.9960 head_norm=1.133151 delta_norm=0.301215
[S8] aggregate: ACCEPT kept=['S11', 'S14', 'S4'] (k=3/3) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=21 metric=0.6122 head_norm=1.029114
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.722634e-01
[S13] stored merged vector for next round verification (round=21)
[S13] DEBUG after merge:  round=21 metric=0.6119 head_norm=0.989556 delta_norm=0.272263
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=21 metric=0.9970 head_norm=2.005261
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.276744e-02
[S14] stored merged vector for next round verification (round=21)
[S14] DEBUG after merge:  round=21 metric=0.9970 head_norm=1.995083 delta_norm=0.052767
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=21 metric=0.6438 head_norm=1.146091
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.065296e-01
[S7] stored merged vector for next round verification (round=21)
[S7] DEBUG after merge:  round=21 metric=0.6044 head_norm=1.310118 delta_norm=0.306530
[S7] aggregate: ROLLBACK (f1_val pre=0.644 post=0.604 tol_abs=0.005 tol_rel=0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=21 metric=0.7019 head_norm=1.293032
[S11] _apply_head_vector_avg (torch): Δ‖w‖=5.026894e-01
[S11] stored merged vector for next round verification (round=21)
[S11] DEBUG after merge:  round=21 metric=0.7019 head_norm=1.483186 delta_norm=0.502689
[S11] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=21 metric=0.9946 head_norm=1.288167
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.427528e-01
[S9] stored merged vector for next round verification (round=21)
[S9] DEBUG after merge:  round=21 metric=0.9950 head_norm=1.263435 delta_norm=0.242753
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=21 metric=0.3928 head_norm=1.023535
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.868067e-01
[S17] stored merged vector for next round verification (round=21)
[S17] DEBUG after merge:  round=21 metric=0.3953 head_norm=0.941664 delta_norm=0.186807
[S17] aggregate: ACCEPT kept=['S7', 'S6', 'S9'] (k=3/3) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=1.911284 (no previous merge yet)
[S2] round=22 local utility u=1.000000 metrics={'f1_val': 0.6676661293458057, 'auprc': 0.7954848905786066, 'loss_val': 0.8240832348422723, 'psi': 0.718793633838926}-{'f1_val': 0.5210290581573588, 'auprc': 0.609982912998473, 'loss_val': 1.6269006209763495, 'psi': 0.5566106000938045}
[S3] START round=22 head_norm_before_train=1.798095 (no previous merge yet)
[S3] round=22 local utility u=0.214442 metrics={'f1_val': 0.7686100524706688, 'auprc': 0.9984358711405653, 'loss_val': 0.23410167986608296, 'psi': 0.8605403799386274}-{'f1_val': 0.7006809596653347, 'auprc': 0.999071708272389, 'loss_val': 0.2573176560421507, 'psi': 0.8200372591081564}
[S4] START round=22 head_norm_before_train=1.932955 (no previous merge yet)
[S4] round=22 local utility u=0.054970 metrics={'f1_val': 0.9523759983246795, 'auprc': 0.9481615764344127, 'loss_val': 0.2775261681196977, 'psi': 0.9506902295685726}-{'f1_val': 0.9445953175755929, 'auprc': 0.9295539793351029, 'loss_val': 0.28495930069688813, 'psi': 0.9385787822793968}
[S5] START round=22 head_norm_before_train=1.485442 cos_to_last_merge=0.8021 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.802
[S5] round=22 local utility u=0.335268 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9976109405048526, 'loss_val': 0.2767405746366799, 'psi': 0.8194094117995456}-{'f1_val': 0.7067338603617284, 'auprc': 0.7960226444323013, 'loss_val': 0.3792641646327474, 'psi': 0.7424493739899576}
[S6] START round=22 head_norm_before_train=1.567552 cos_to_last_merge=0.8191 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.819
[S6] round=22 local utility u=0.000000 metrics={'f1_val': 0.5127090541761257, 'auprc': 0.7830055541453967, 'loss_val': 0.8727785451284652, 'psi': 0.620827654163834}-{'f1_val': 0.9639693581701005, 'auprc': 0.9532956269151761, 'loss_val': 0.15157334106376988, 'psi': 0.9596998656681308}
[S7] START round=22 head_norm_before_train=1.310118 cos_to_last_merge=1.0000 (last merge round=21)
[S7] round=22 local utility u=0.000000 metrics={'f1_val': 0.403404013447874, 'auprc': 0.7644526047869467, 'loss_val': 0.9245762142831222, 'psi': 0.5478234499835031}-{'f1_val': 0.6438275039448396, 'auprc': 0.7802290311755338, 'loss_val': 0.7408123050423524, 'psi': 0.6983881148371173}
[S8] START round=22 head_norm_before_train=1.133151 cos_to_last_merge=1.0000 (last merge round=21)
[S8] round=22 local utility u=0.004347 metrics={'f1_val': 0.996776381273096, 'auprc': 0.9969003783131478, 'loss_val': 0.17710699810815672, 'psi': 0.9968259800891168}-{'f1_val': 0.9948403229310986, 'auprc': 0.9912724459879408, 'loss_val': 0.15730101431981758, 'psi': 0.9934131721538355}
[S9] START round=22 head_norm_before_train=1.263435 cos_to_last_merge=1.0000 (last merge round=21)
[S9] round=22 local utility u=0.000000 metrics={'f1_val': 0.9939393793306803, 'auprc': 0.9984369696665816, 'loss_val': 0.13528021198393056, 'psi': 0.9957384154650408}-{'f1_val': 0.9946069829493691, 'auprc': 0.9986609553677387, 'loss_val': 0.11117977367652936, 'psi': 0.996228571916717}
[S10] START round=22 head_norm_before_train=1.986254 (no previous merge yet)
[S10] round=22 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9959613017679482, 'loss_val': 0.026908916573897997, 'psi': 0.995497224118804}-{'f1_val': 0.9951878390193748, 'auprc': 0.9963116194822632, 'loss_val': 0.027685306905131338, 'psi': 0.9956373512045301}
[S11] START round=22 head_norm_before_train=1.483186 cos_to_last_merge=1.0000 (last merge round=21)
[S11] round=22 local utility u=0.029044 metrics={'f1_val': 0.7018701185892477, 'auprc': 0.9952447919303423, 'loss_val': 0.29156093777434844, 'psi': 0.8192199879256856}-{'f1_val': 0.7018701185892477, 'auprc': 0.9838735597766303, 'loss_val': 0.3155360912132801, 'psi': 0.8146714950642008}
[S13] START round=22 head_norm_before_train=0.989556 cos_to_last_merge=1.0000 (last merge round=21)
[S13] round=22 local utility u=0.124482 metrics={'f1_val': 0.6474234982265614, 'auprc': 0.7235040212280172, 'loss_val': 0.7534664130079979, 'psi': 0.6778557074271437}-{'f1_val': 0.6122464102474038, 'auprc': 0.7210771759229003, 'loss_val': 0.7840869095290596, 'psi': 0.6557787165176023}
[S14] START round=22 head_norm_before_train=1.995083 cos_to_last_merge=1.0000 (last merge round=21)
[S14] round=22 local utility u=0.000732 metrics={'f1_val': 0.9980847028057478, 'auprc': 0.9978499019860901, 'loss_val': 0.06357813954573772, 'psi': 0.9979907824778846}-{'f1_val': 0.9970427648353635, 'auprc': 0.9992213150654168, 'loss_val': 0.0629057044421633, 'psi': 0.9979141849273847}
[S15] START round=22 head_norm_before_train=1.284920 cos_to_last_merge=0.9973 (last merge round=20)
[S15] round=22 local utility u=0.000000 metrics={'f1_val': 0.8848884395942781, 'auprc': 0.993072110817925, 'loss_val': 0.23520626108277243, 'psi': 0.9281619080837369}-{'f1_val': 0.9951981759039306, 'auprc': 0.9962857677685303, 'loss_val': 0.12994486892949914, 'psi': 0.9956332126497704}
[S16] START round=22 head_norm_before_train=1.518951 cos_to_last_merge=0.8221 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.822
[S16] round=22 local utility u=0.004339 metrics={'f1_val': 0.992516205783669, 'auprc': 0.9970022461684664, 'loss_val': 0.06758472613979535, 'psi': 0.9943106219375879}-{'f1_val': 0.9931208718948594, 'auprc': 0.9974473679967177, 'loss_val': 0.0812266834915669, 'psi': 0.9948514703356027}
[S17] START round=22 head_norm_before_train=0.941664 cos_to_last_merge=1.0000 (last merge round=21)
[S17] round=22 local utility u=0.674788 metrics={'f1_val': 0.6128765744293518, 'auprc': 0.8483140285385893, 'loss_val': 0.6442879371930611, 'psi': 0.7070515560730468}-{'f1_val': 0.3927733760908926, 'auprc': 0.8512674431356039, 'loss_val': 0.6821043927327343, 'psi': 0.5761710029087771}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:52808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:52812
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S13] → sending delta(kind=head bytes=1793) to S7@127.0.0.1:52808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:52809
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:52815
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:52812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S11] → sending delta(kind=head bytes=1808) to S8@127.0.0.1:52809
[S3] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1793 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1808 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1802) from S2
[S8] cosine check vs S2: cos=0.0830
[S15] RECEIVED delta(kind=head bytes=1799) from S8
[S15] cosine check vs S8: cos=0.8980
[S8] RECEIVED delta(kind=head bytes=1801) from S4
[S8] cosine check vs S4: cos=0.2260
[S8] RECEIVED delta(kind=head bytes=1808) from S11
[S8] cosine check vs S11: cos=0.6849
[S8] RECEIVED delta(kind=head bytes=1802) from S14
[S8] cosine check vs S14: cos=0.7377
[S7] RECEIVED delta(kind=head bytes=1793) from S13
[S7] cosine check vs S13: cos=0.6815
[S7] RECEIVED delta(kind=head bytes=1801) from S16
[S7] cosine check vs S16: cos=0.9846
[S11] RECEIVED delta(kind=head bytes=1800) from S5
[S11] cosine check vs S5: cos=0.3515
[S11] RECEIVED delta(kind=head bytes=1801) from S3
[S11] cosine check vs S3: cos=0.9676
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:52813
[S17] sending update (kind=head size=1795 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1795) from S17
[S13] cosine check vs S17: cos=0.9639
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=22 metric=0.4034 head_norm=1.325752
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.769292e-01
[S7] stored merged vector for next round verification (round=22)
[S7] DEBUG after merge:  round=22 metric=0.4240 head_norm=1.230987 delta_norm=0.176929
[S7] aggregate: ACCEPT kept=['S13', 'S16'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=4 kept=4 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=22 metric=0.9968 head_norm=1.178128
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.922009e-01
[S8] stored merged vector for next round verification (round=22)
[S8] DEBUG after merge:  round=22 metric=0.9968 head_norm=1.022853 delta_norm=0.292201
[S8] aggregate: ACCEPT kept=['S2', 'S4', 'S11', 'S14'] (k=4/4) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=22 metric=0.6474 head_norm=1.046134
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.400561e-01
[S13] stored merged vector for next round verification (round=22)
[S13] DEBUG after merge:  round=22 metric=0.6464 head_norm=1.003619 delta_norm=0.140056
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=22 metric=0.7019 head_norm=1.512312
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.070488e-01
[S11] stored merged vector for next round verification (round=22)
[S11] DEBUG after merge:  round=22 metric=0.7019 head_norm=1.350595 delta_norm=0.307049
[S11] aggregate: ACCEPT kept=['S5', 'S3'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=22 metric=0.8849 head_norm=1.350072
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.975426e-01
[S15] stored merged vector for next round verification (round=22)
[S15] DEBUG after merge:  round=22 metric=0.8887 head_norm=1.231588 delta_norm=0.297543
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=1.926799 (no previous merge yet)
[S2] round=23 local utility u=0.259527 metrics={'f1_val': 0.7140657557984744, 'auprc': 0.8384982268735498, 'loss_val': 0.7124664424712476, 'psi': 0.7638387442285046}-{'f1_val': 0.6676661293458057, 'auprc': 0.7954848905786066, 'loss_val': 0.8240832348422723, 'psi': 0.718793633838926}
[S3] START round=23 head_norm_before_train=1.819546 (no previous merge yet)
[S3] round=23 local utility u=0.000000 metrics={'f1_val': 0.7018768808926283, 'auprc': 0.9991787686930793, 'loss_val': 0.2116956529661862, 'psi': 0.8207976360128088}-{'f1_val': 0.7686100524706688, 'auprc': 0.9984358711405653, 'loss_val': 0.23410167986608296, 'psi': 0.8605403799386274}
[S4] START round=23 head_norm_before_train=1.945804 (no previous merge yet)
[S4] round=23 local utility u=0.000000 metrics={'f1_val': 0.9421392793584289, 'auprc': 0.9282017376060725, 'loss_val': 0.29252305845577387, 'psi': 0.9365642626574863}-{'f1_val': 0.9523759983246795, 'auprc': 0.9481615764344127, 'loss_val': 0.2775261681196977, 'psi': 0.9506902295685726}
[S5] START round=23 head_norm_before_train=1.499577 cos_to_last_merge=0.7977 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.798
[S5] round=23 local utility u=0.000000 metrics={'f1_val': 0.7007514523434957, 'auprc': 0.8836063527271596, 'loss_val': 0.29768032079823004, 'psi': 0.7738934124969612}-{'f1_val': 0.7006083926626743, 'auprc': 0.9976109405048526, 'loss_val': 0.2767405746366799, 'psi': 0.8194094117995456}
[S6] START round=23 head_norm_before_train=1.585084 cos_to_last_merge=0.8172 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.817
[S6] round=23 local utility u=1.000000 metrics={'f1_val': 0.847158682490315, 'auprc': 0.9586539876178519, 'loss_val': 0.32717261364249156, 'psi': 0.8917568045413298}-{'f1_val': 0.5127090541761257, 'auprc': 0.7830055541453967, 'loss_val': 0.8727785451284652, 'psi': 0.620827654163834}
[S7] START round=23 head_norm_before_train=1.230987 cos_to_last_merge=1.0000 (last merge round=22)
[S7] round=23 local utility u=0.492294 metrics={'f1_val': 0.5423974503214339, 'auprc': 0.7738710341026434, 'loss_val': 0.8022034947898544, 'psi': 0.6349868838339177}-{'f1_val': 0.403404013447874, 'auprc': 0.7644526047869467, 'loss_val': 0.9245762142831222, 'psi': 0.5478234499835031}
[S8] START round=23 head_norm_before_train=1.022853 cos_to_last_merge=1.0000 (last merge round=22)
[S8] round=23 local utility u=0.000000 metrics={'f1_val': 0.9949323051384696, 'auprc': 0.9976189249602497, 'loss_val': 0.18731981643299842, 'psi': 0.9960069530671816}-{'f1_val': 0.996776381273096, 'auprc': 0.9969003783131478, 'loss_val': 0.17710699810815672, 'psi': 0.9968259800891168}
[S9] START round=23 head_norm_before_train=1.303387 cos_to_last_merge=0.9990 (last merge round=21)
[S9] round=23 local utility u=0.028317 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9983430676075034, 'loss_val': 0.09734513463720054, 'psi': 0.997598974550287}-{'f1_val': 0.9939393793306803, 'auprc': 0.9984369696665816, 'loss_val': 0.13528021198393056, 'psi': 0.9957384154650408}
[S10] START round=23 head_norm_before_train=2.002236 (no previous merge yet)
[S10] round=23 local utility u=0.000102 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9959384476612125, 'loss_val': 0.026635630387822577, 'psi': 0.9954880824761099}-{'f1_val': 0.9951878390193748, 'auprc': 0.9959613017679482, 'loss_val': 0.026908916573897997, 'psi': 0.995497224118804}
[S11] START round=23 head_norm_before_train=1.350595 cos_to_last_merge=1.0000 (last merge round=22)
[S11] round=23 local utility u=0.004825 metrics={'f1_val': 0.7021118300140827, 'auprc': 0.9982497271605151, 'loss_val': 0.2923760657828055, 'psi': 0.8205669888726557}-{'f1_val': 0.7018701185892477, 'auprc': 0.9952447919303423, 'loss_val': 0.29156093777434844, 'psi': 0.8192199879256856}
[S13] START round=23 head_norm_before_train=1.003619 cos_to_last_merge=1.0000 (last merge round=22)
[S13] round=23 local utility u=0.000000 metrics={'f1_val': 0.63337023402737, 'auprc': 0.651408105961391, 'loss_val': 0.79706727227182, 'psi': 0.6405853828009784}-{'f1_val': 0.6474234982265614, 'auprc': 0.7235040212280172, 'loss_val': 0.7534664130079979, 'psi': 0.6778557074271437}
[S14] START round=23 head_norm_before_train=2.015915 cos_to_last_merge=0.9998 (last merge round=21)
[S14] round=23 local utility u=0.003132 metrics={'f1_val': 0.9974830777164877, 'auprc': 0.9975080416121558, 'loss_val': 0.05267943656611575, 'psi': 0.997493063274755}-{'f1_val': 0.9980847028057478, 'auprc': 0.9978499019860901, 'loss_val': 0.06357813954573772, 'psi': 0.9979907824778846}
[S15] START round=23 head_norm_before_train=1.231588 cos_to_last_merge=1.0000 (last merge round=22)
[S15] round=23 local utility u=0.000000 metrics={'f1_val': 0.7009191843683342, 'auprc': 0.984587943702248, 'loss_val': 0.4372329632344722, 'psi': 0.8143866881018997}-{'f1_val': 0.8848884395942781, 'auprc': 0.993072110817925, 'loss_val': 0.23520626108277243, 'psi': 0.9281619080837369}
[S16] START round=23 head_norm_before_train=1.549630 cos_to_last_merge=0.8201 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.820
[S16] round=23 local utility u=0.000000 metrics={'f1_val': 0.9383162956637551, 'auprc': 0.9969463671398464, 'loss_val': 0.20270965019933074, 'psi': 0.9617683242541917}-{'f1_val': 0.992516205783669, 'auprc': 0.9970022461684664, 'loss_val': 0.06758472613979535, 'psi': 0.9943106219375879}
[S17] START round=23 head_norm_before_train=0.979457 cos_to_last_merge=0.9966 (last merge round=21)
[S17] round=23 local utility u=0.000000 metrics={'f1_val': 0.40195417241733644, 'auprc': 0.712992208972768, 'loss_val': 0.7780919284297318, 'psi': 0.5263693870395091}-{'f1_val': 0.6128765744293518, 'auprc': 0.8483140285385893, 'loss_val': 0.6442879371930611, 'psi': 0.7070515560730468}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S11] → sending delta(kind=head bytes=1807) to S8@127.0.0.1:52809
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:52809
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:52817
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:52809
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:52814
[S2] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1807 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1798) from S7
[S17] cosine check vs S7: cos=0.7150
[S17] RECEIVED delta(kind=head bytes=1796) from S6
[S17] cosine check vs S6: cos=0.3384
[S17] RECEIVED delta(kind=head bytes=1803) from S9
[S17] cosine check vs S9: cos=0.8188
[S14] RECEIVED delta(kind=head bytes=1799) from S10
[S14] cosine check vs S10: cos=0.9983
[S8] RECEIVED delta(kind=head bytes=1798) from S2
[S8] cosine check vs S2: cos=0.2414
[S8] RECEIVED delta(kind=head bytes=1801) from S14
[S8] cosine check vs S14: cos=0.6473
[S8] RECEIVED delta(kind=head bytes=1807) from S11
[S8] cosine check vs S11: cos=0.7510
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=23 metric=0.9949 head_norm=1.082893
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.242993e-01
[S8] stored merged vector for next round verification (round=23)
[S8] DEBUG after merge:  round=23 metric=0.9949 head_norm=1.050294 delta_norm=0.224299
[S8] aggregate: ACCEPT kept=['S2', 'S14', 'S11'] (k=3/3) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=23 metric=0.9975 head_norm=2.036641
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.982213e-02
[S14] stored merged vector for next round verification (round=23)
[S14] DEBUG after merge:  round=23 metric=0.9975 head_norm=2.025274 delta_norm=0.059822
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=23 metric=0.4020 head_norm=1.007791
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.419103e-01
[S17] stored merged vector for next round verification (round=23)
[S17] DEBUG after merge:  round=23 metric=0.4004 head_norm=0.960025 delta_norm=0.141910
[S17] aggregate: ACCEPT kept=['S7', 'S6', 'S9'] (k=3/3) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=1.938239 (no previous merge yet)
[S2] round=24 local utility u=0.000000 metrics={'f1_val': 0.580173483084085, 'auprc': 0.7322501543608616, 'loss_val': 1.4151459261035726, 'psi': 0.6410041515947956}-{'f1_val': 0.7140657557984744, 'auprc': 0.8384982268735498, 'loss_val': 0.7124664424712476, 'psi': 0.7638387442285046}
[S3] START round=24 head_norm_before_train=1.843513 (no previous merge yet)
[S3] round=24 local utility u=0.713685 metrics={'f1_val': 0.9353568035615685, 'auprc': 0.9992460852743232, 'loss_val': 0.18540771262927874, 'psi': 0.9609125162466703}-{'f1_val': 0.7018768808926283, 'auprc': 0.9991787686930793, 'loss_val': 0.2116956529661862, 'psi': 0.8207976360128088}
[S4] START round=24 head_norm_before_train=1.965658 (no previous merge yet)
[S4] round=24 local utility u=0.000000 metrics={'f1_val': 0.9415808081850918, 'auprc': 0.9290458223255027, 'loss_val': 0.2982443195823574, 'psi': 0.9365668138412562}-{'f1_val': 0.9421392793584289, 'auprc': 0.9282017376060725, 'loss_val': 0.29252305845577387, 'psi': 0.9365642626574863}
[S5] START round=24 head_norm_before_train=1.510261 cos_to_last_merge=0.7953 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.795
[S5] round=24 local utility u=0.188498 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.997706311066545, 'loss_val': 0.2621258396100066, 'psi': 0.8194475600242226}-{'f1_val': 0.7007514523434957, 'auprc': 0.8836063527271596, 'loss_val': 0.29768032079823004, 'psi': 0.7738934124969612}
[S6] START round=24 head_norm_before_train=1.598810 cos_to_last_merge=0.8161 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.816
[S6] round=24 local utility u=0.000000 metrics={'f1_val': 0.7437407955705797, 'auprc': 0.946284369891768, 'loss_val': 0.6379597849962407, 'psi': 0.8247582252990551}-{'f1_val': 0.847158682490315, 'auprc': 0.9586539876178519, 'loss_val': 0.32717261364249156, 'psi': 0.8917568045413298}
[S7] START round=24 head_norm_before_train=1.249448 cos_to_last_merge=0.9995 (last merge round=22)
[S7] round=24 local utility u=0.000000 metrics={'f1_val': 0.3948911257141996, 'auprc': 0.7691181514049248, 'loss_val': 1.0173036322305888, 'psi': 0.5445819359904898}-{'f1_val': 0.5423974503214339, 'auprc': 0.7738710341026434, 'loss_val': 0.8022034947898544, 'psi': 0.6349868838339177}
[S8] START round=24 head_norm_before_train=1.050294 cos_to_last_merge=1.0000 (last merge round=23)
[S8] round=24 local utility u=0.019207 metrics={'f1_val': 0.9949323051384696, 'auprc': 0.9966172127511314, 'loss_val': 0.1459001948124146, 'psi': 0.9956062681835343}-{'f1_val': 0.9949323051384696, 'auprc': 0.9976189249602497, 'loss_val': 0.18731981643299842, 'psi': 0.9960069530671816}
[S9] START round=24 head_norm_before_train=1.346244 cos_to_last_merge=0.9963 (last merge round=21)
[S9] round=24 local utility u=0.010469 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9986435784228311, 'loss_val': 0.0758062837886627, 'psi': 0.9975689826244868}-{'f1_val': 0.9971029125121428, 'auprc': 0.9983430676075034, 'loss_val': 0.09734513463720054, 'psi': 0.997598974550287}
[S10] START round=24 head_norm_before_train=2.015619 (no previous merge yet)
[S10] round=24 local utility u=0.000266 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.995957883065205, 'loss_val': 0.02616267749812786, 'psi': 0.9954958566377068}-{'f1_val': 0.9951878390193748, 'auprc': 0.9959384476612125, 'loss_val': 0.026635630387822577, 'psi': 0.9954880824761099}
[S11] START round=24 head_norm_before_train=1.377806 cos_to_last_merge=0.9996 (last merge round=22)
[S11] round=24 local utility u=0.012717 metrics={'f1_val': 0.7018701185892477, 'auprc': 0.9976526923921849, 'loss_val': 0.2637006693916, 'psi': 0.8201831481104227}-{'f1_val': 0.7021118300140827, 'auprc': 0.9982497271605151, 'loss_val': 0.2923760657828055, 'psi': 0.8205669888726557}
[S13] START round=24 head_norm_before_train=1.073321 cos_to_last_merge=0.9944 (last merge round=22)
[S13] round=24 local utility u=0.515195 metrics={'f1_val': 0.7386846845163573, 'auprc': 0.7613038915119746, 'loss_val': 0.7282518598465869, 'psi': 0.7477323673146041}-{'f1_val': 0.63337023402737, 'auprc': 0.651408105961391, 'loss_val': 0.79706727227182, 'psi': 0.6405853828009784}
[S14] START round=24 head_norm_before_train=2.025274 cos_to_last_merge=1.0000 (last merge round=23)
[S14] round=24 local utility u=0.004048 metrics={'f1_val': 0.9972657600632533, 'auprc': 0.9995958250224051, 'loss_val': 0.04954221257681821, 'psi': 0.998197786046914}-{'f1_val': 0.9974830777164877, 'auprc': 0.9975080416121558, 'loss_val': 0.05267943656611575, 'psi': 0.997493063274755}
[S15] START round=24 head_norm_before_train=1.284204 cos_to_last_merge=0.9983 (last merge round=22)
[S15] round=24 local utility u=0.194713 metrics={'f1_val': 0.7564259120585594, 'auprc': 0.9875128525187608, 'loss_val': 0.38962286339578917, 'psi': 0.8488606882426399}-{'f1_val': 0.7009191843683342, 'auprc': 0.984587943702248, 'loss_val': 0.4372329632344722, 'psi': 0.8143866881018997}
[S16] START round=24 head_norm_before_train=1.580537 cos_to_last_merge=0.8183 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.818
[S16] round=24 local utility u=0.000000 metrics={'f1_val': 0.9362572171259025, 'auprc': 0.9983416454067564, 'loss_val': 0.22400096670467876, 'psi': 0.961090988438244}-{'f1_val': 0.9383162956637551, 'auprc': 0.9969463671398464, 'loss_val': 0.20270965019933074, 'psi': 0.9617683242541917}
[S17] START round=24 head_norm_before_train=0.960025 cos_to_last_merge=1.0000 (last merge round=23)
[S17] round=24 local utility u=0.112448 metrics={'f1_val': 0.41117225584516814, 'auprc': 0.7359414468509972, 'loss_val': 0.6773523074932324, 'psi': 0.5410799322474997}-{'f1_val': 0.40195417241733644, 'auprc': 0.712992208972768, 'loss_val': 0.7780919284297318, 'psi': 0.5263693870395091}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:52814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:52810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:52812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S5] → sending delta(kind=head bytes=1808) to S11@127.0.0.1:52812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:52815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:52809
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:52808
[S13] sending update (kind=head size=1795 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1804 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1808 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1808) from S5
[S11] cosine check vs S5: cos=0.5130
[S17] RECEIVED delta(kind=head bytes=1796) from S9
[S17] cosine check vs S9: cos=0.8039
[S14] RECEIVED delta(kind=head bytes=1795) from S10
[S14] cosine check vs S10: cos=0.9990
[S15] RECEIVED delta(kind=head bytes=1804) from S8
[S15] cosine check vs S8: cos=0.9506
[S9] RECEIVED delta(kind=head bytes=1803) from S15
[S9] cosine check vs S15: cos=0.9445
[S8] RECEIVED delta(kind=head bytes=1796) from S14
[S8] cosine check vs S14: cos=0.6486
[S7] RECEIVED delta(kind=head bytes=1795) from S13
[S7] cosine check vs S13: cos=0.7253
[S11] RECEIVED delta(kind=head bytes=1800) from S3
[S11] cosine check vs S3: cos=0.9034
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:52813
[S17] sending update (kind=head size=1797 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1797) from S17
[S13] cosine check vs S17: cos=0.9441
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:52809
[S11] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1801) from S11
[S8] cosine check vs S11: cos=0.7567
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=24 metric=0.3949 head_norm=1.267870
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.499717e-01
[S7] stored merged vector for next round verification (round=24)
[S7] DEBUG after merge:  round=24 metric=0.4065 head_norm=1.117772 delta_norm=0.449972
[S7] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=24 metric=0.9969 head_norm=1.386016
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.280572e-01
[S9] stored merged vector for next round verification (round=24)
[S9] DEBUG after merge:  round=24 metric=0.9971 head_norm=1.340986 delta_norm=0.228057
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=24 metric=0.9949 head_norm=1.130553
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.337230e-01
[S8] stored merged vector for next round verification (round=24)
[S8] DEBUG after merge:  round=24 metric=0.9949 head_norm=1.209160 delta_norm=0.333723
[S8] aggregate: ACCEPT kept=['S14', 'S11'] (k=2/2) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=24 metric=0.7387 head_norm=1.138544
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.918603e-01
[S13] stored merged vector for next round verification (round=24)
[S13] DEBUG after merge:  round=24 metric=0.6804 head_norm=1.052090 delta_norm=0.191860
[S13] aggregate: ROLLBACK (f1_val pre=0.739 post=0.680 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=24 metric=0.9973 head_norm=2.045381
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.615356e-02
[S14] stored merged vector for next round verification (round=24)
[S14] DEBUG after merge:  round=24 metric=0.9973 head_norm=2.034823 delta_norm=0.046154
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=24 metric=0.7019 head_norm=1.404657
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.704080e-01
[S11] stored merged vector for next round verification (round=24)
[S11] DEBUG after merge:  round=24 metric=0.7019 head_norm=1.327978 delta_norm=0.170408
[S11] aggregate: ACCEPT kept=['S5', 'S3'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=24 metric=0.7564 head_norm=1.333966
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.182389e-01
[S15] stored merged vector for next round verification (round=24)
[S15] DEBUG after merge:  round=24 metric=0.7613 head_norm=1.217037 delta_norm=0.218239
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=24 metric=0.4112 head_norm=0.995553
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.164226e-01
[S17] stored merged vector for next round verification (round=24)
[S17] DEBUG after merge:  round=24 metric=0.4839 head_norm=1.132553 delta_norm=0.416423
[S17] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=25 head_norm_before_train=1.951300 (no previous merge yet)
[S2] round=25 local utility u=0.855610 metrics={'f1_val': 0.7154605292108351, 'auprc': 0.8248309571913561, 'loss_val': 0.7933914419586896, 'psi': 0.7592087004030436}-{'f1_val': 0.580173483084085, 'auprc': 0.7322501543608616, 'loss_val': 1.4151459261035726, 'psi': 0.6410041515947956}
[S3] START round=25 head_norm_before_train=1.867181 (no previous merge yet)
[S3] round=25 local utility u=0.000000 metrics={'f1_val': 0.7044045881461305, 'auprc': 0.9992414397220275, 'loss_val': 0.19982910206968046, 'psi': 0.8223393287764893}-{'f1_val': 0.9353568035615685, 'auprc': 0.9992460852743232, 'loss_val': 0.18540771262927874, 'psi': 0.9609125162466703}
[S4] START round=25 head_norm_before_train=1.975940 (no previous merge yet)
[S4] round=25 local utility u=0.009449 metrics={'f1_val': 0.942000706118228, 'auprc': 0.9348040936707699, 'loss_val': 0.2991399622684064, 'psi': 0.9391220611392447}-{'f1_val': 0.9415808081850918, 'auprc': 0.9290458223255027, 'loss_val': 0.2982443195823574, 'psi': 0.9365668138412562}
[S5] START round=25 head_norm_before_train=1.525893 cos_to_last_merge=0.7927 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.793
[S5] round=25 local utility u=0.000000 metrics={'f1_val': 0.7006069008894004, 'auprc': 0.9700908662697088, 'loss_val': 0.26157867557447984, 'psi': 0.8084004870415238}-{'f1_val': 0.7006083926626743, 'auprc': 0.997706311066545, 'loss_val': 0.2621258396100066, 'psi': 0.8194475600242226}
[S6] START round=25 head_norm_before_train=1.606365 cos_to_last_merge=0.8153 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.815
[S6] round=25 local utility u=0.444259 metrics={'f1_val': 0.8468535025016293, 'auprc': 0.9556992176525299, 'loss_val': 0.39636351476887355, 'psi': 0.8903917885619894}-{'f1_val': 0.7437407955705797, 'auprc': 0.946284369891768, 'loss_val': 0.6379597849962407, 'psi': 0.8247582252990551}
[S7] START round=25 head_norm_before_train=1.117772 cos_to_last_merge=1.0000 (last merge round=24)
[S7] round=25 local utility u=0.127183 metrics={'f1_val': 0.4190857993836893, 'auprc': 0.7706264966994818, 'loss_val': 0.9126301739076693, 'psi': 0.5597020783100064}-{'f1_val': 0.3948911257141996, 'auprc': 0.7691181514049248, 'loss_val': 1.0173036322305888, 'psi': 0.5445819359904898}
[S8] START round=25 head_norm_before_train=1.209160 cos_to_last_merge=1.0000 (last merge round=24)
[S8] round=25 local utility u=0.006970 metrics={'f1_val': 0.9949323051384696, 'auprc': 0.9959294376928873, 'loss_val': 0.12989639794830543, 'psi': 0.9953311581602367}-{'f1_val': 0.9949323051384696, 'auprc': 0.9966172127511314, 'loss_val': 0.1459001948124146, 'psi': 0.9956062681835343}
[S9] START round=25 head_norm_before_train=1.340986 cos_to_last_merge=1.0000 (last merge round=24)
[S9] round=25 local utility u=0.000000 metrics={'f1_val': 0.9964388212112862, 'auprc': 0.998658633933257, 'loss_val': 0.1012901329016555, 'psi': 0.9973267463000746}-{'f1_val': 0.9968525854255906, 'auprc': 0.9986435784228311, 'loss_val': 0.0758062837886627, 'psi': 0.9975689826244868}
[S10] START round=25 head_norm_before_train=2.025263 (no previous merge yet)
[S10] round=25 local utility u=0.000219 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9959593240080228, 'loss_val': 0.02572938762383793, 'psi': 0.9954964330148339}-{'f1_val': 0.9951878390193748, 'auprc': 0.995957883065205, 'loss_val': 0.02616267749812786, 'psi': 0.9954958566377068}
[S11] START round=25 head_norm_before_train=1.327978 cos_to_last_merge=1.0000 (last merge round=24)
[S11] round=25 local utility u=0.002406 metrics={'f1_val': 0.7021118300140827, 'auprc': 0.9984225883401465, 'loss_val': 0.2626477775655826, 'psi': 0.8206361333445082}-{'f1_val': 0.7018701185892477, 'auprc': 0.9976526923921849, 'loss_val': 0.2637006693916, 'psi': 0.8201831481104227}
[S13] START round=25 head_norm_before_train=1.052090 cos_to_last_merge=1.0000 (last merge round=24)
[S13] round=25 local utility u=0.000000 metrics={'f1_val': 0.6727965893224309, 'auprc': 0.7408345687774511, 'loss_val': 0.6949917646268801, 'psi': 0.7000117811044391}-{'f1_val': 0.7386846845163573, 'auprc': 0.7613038915119746, 'loss_val': 0.7282518598465869, 'psi': 0.7477323673146041}
[S14] START round=25 head_norm_before_train=2.034823 cos_to_last_merge=1.0000 (last merge round=24)
[S14] round=25 local utility u=0.002252 metrics={'f1_val': 0.9976538428159559, 'auprc': 0.999474491000733, 'loss_val': 0.047002010345749946, 'psi': 0.9983821020898668}-{'f1_val': 0.9972657600632533, 'auprc': 0.9995958250224051, 'loss_val': 0.04954221257681821, 'psi': 0.998197786046914}
[S15] START round=25 head_norm_before_train=1.217037 cos_to_last_merge=1.0000 (last merge round=24)
[S15] round=25 local utility u=0.000000 metrics={'f1_val': 0.749359869205756, 'auprc': 0.9901484996148683, 'loss_val': 0.38809614076668164, 'psi': 0.8456753213694009}-{'f1_val': 0.7564259120585594, 'auprc': 0.9875128525187608, 'loss_val': 0.38962286339578917, 'psi': 0.8488606882426399}
[S16] START round=25 head_norm_before_train=1.606611 cos_to_last_merge=0.8171 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.817
[S16] round=25 local utility u=0.256653 metrics={'f1_val': 0.9926833142060669, 'auprc': 0.998468430897388, 'loss_val': 0.049632668139866366, 'psi': 0.9949973608825953}-{'f1_val': 0.9362572171259025, 'auprc': 0.9983416454067564, 'loss_val': 0.22400096670467876, 'psi': 0.961090988438244}
[S17] START round=25 head_norm_before_train=1.132553 cos_to_last_merge=1.0000 (last merge round=24)
[S17] round=25 local utility u=0.808542 metrics={'f1_val': 0.6162004626345673, 'auprc': 0.8353291850409689, 'loss_val': 0.588600407905357, 'psi': 0.703851951597128}-{'f1_val': 0.41117225584516814, 'auprc': 0.7359414468509972, 'loss_val': 0.6773523074932324, 'psi': 0.5410799322474997}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] → sending delta(kind=head bytes=1805) to S17@127.0.0.1:52817
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:52814
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S11] → sending delta(kind=head bytes=1806) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:52809
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:52815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:52817
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1806 to 1 peers)
[S14] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1805 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1799) from S6
[S17] cosine check vs S6: cos=0.2303
[S17] RECEIVED delta(kind=head bytes=1805) from S7
[S17] cosine check vs S7: cos=0.7583
[S14] RECEIVED delta(kind=head bytes=1803) from S10
[S14] cosine check vs S10: cos=0.9993
[S15] RECEIVED delta(kind=head bytes=1801) from S8
[S15] cosine check vs S8: cos=0.9544
[S8] RECEIVED delta(kind=head bytes=1802) from S2
[S8] cosine check vs S2: cos=0.1658
[S8] RECEIVED delta(kind=head bytes=1806) from S11
[S8] cosine check vs S11: cos=0.7643
[S8] RECEIVED delta(kind=head bytes=1795) from S14
[S8] cosine check vs S14: cos=0.7778
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:52813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:52808
[S17] sending update (kind=head size=1799 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1799) from S17
[S13] cosine check vs S17: cos=0.8988
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:52809
[S4] sending update (kind=head size=1799 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1799) from S4
[S8] cosine check vs S4: cos=0.0773
[S16] sending update (kind=head size=1796 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1796) from S16
[S7] cosine check vs S16: cos=0.8083
[S5] ⇄ pheromone p=0.115 → S11@127.0.0.1:52812
[S9] ⇄ pheromone p=0.060 → S17@127.0.0.1:52817
[S3] ⇄ pheromone p=0.165 → S11@127.0.0.1:52812
[S6] ⇄ pheromone p=0.363 → S17@127.0.0.1:52817
[S2] ⇄ pheromone p=0.349 → S8@127.0.0.1:52809
[S8] aggregate: batch=4 kept=4 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=25 metric=0.9949 head_norm=1.273659
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.992986e-01
[S8] stored merged vector for next round verification (round=25)
[S8] DEBUG after merge:  round=25 metric=0.9949 head_norm=1.078510 delta_norm=0.299299
[S8] aggregate: ACCEPT kept=['S2', 'S11', 'S14', 'S4'] (k=4/4) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.029 → S15@127.0.0.1:52815
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=25 metric=0.4191 head_norm=1.132069
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.887061e-01
[S7] stored merged vector for next round verification (round=25)
[S7] DEBUG after merge:  round=25 metric=0.4011 head_norm=1.315477 delta_norm=0.488706
[S7] aggregate: ROLLBACK (f1_val pre=0.419 post=0.401 tol_abs=0.005 tol_rel=0.0)
[S7] ⇄ pheromone p=0.242 → S17@127.0.0.1:52817
[S10] ⇄ pheromone p=0.015 → S14@127.0.0.1:52814
[S4] ⇄ pheromone p=0.033 → S8@127.0.0.1:52809
[S16] ⇄ pheromone p=0.166 → S7@127.0.0.1:52808
[S11] ⇄ pheromone p=0.039 → S8@127.0.0.1:52809
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=25 metric=0.7494 head_norm=1.267259
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.919184e-01
[S15] stored merged vector for next round verification (round=25)
[S15] DEBUG after merge:  round=25 metric=0.7564 head_norm=1.255883 delta_norm=0.191918
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.139 → S9@127.0.0.1:52810
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=25 metric=0.6728 head_norm=1.132669
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.593549e-01
[S13] stored merged vector for next round verification (round=25)
[S13] DEBUG after merge:  round=25 metric=0.6677 head_norm=1.120890 delta_norm=0.259355
[S13] aggregate: ROLLBACK (f1_val pre=0.673 post=0.668 tol_abs=0.005 tol_rel=0.0)
[S13] ⇄ pheromone p=0.127 → S7@127.0.0.1:52808
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=25 metric=0.6162 head_norm=1.168067
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.133508e-01
[S17] stored merged vector for next round verification (round=25)
[S17] DEBUG after merge:  round=25 metric=0.6008 head_norm=0.990953 delta_norm=0.513351
[S17] aggregate: ROLLBACK (f1_val pre=0.616 post=0.601 tol_abs=0.005 tol_rel=0.0)
[S17] ⇄ pheromone p=0.300 → S13@127.0.0.1:52813
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=25 metric=0.9977 head_norm=2.055148
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.983315e-02
[S14] stored merged vector for next round verification (round=25)
[S14] DEBUG after merge:  round=25 metric=0.9977 head_norm=2.043849 delta_norm=0.039833
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.035 → S8@127.0.0.1:52809
[S2] START round=26 head_norm_before_train=1.962691 (no previous merge yet)
[S2] round=26 local utility u=0.039067 metrics={'f1_val': 0.7157050501465694, 'auprc': 0.8529129821046256, 'loss_val': 0.8009700413481378, 'psi': 0.7705882229297919}-{'f1_val': 0.7154605292108351, 'auprc': 0.8248309571913561, 'loss_val': 0.7933914419586896, 'psi': 0.7592087004030436}
[S3] START round=26 head_norm_before_train=1.889578 (no previous merge yet)
[S3] round=26 local utility u=0.895171 metrics={'f1_val': 0.991512366291151, 'auprc': 0.9991906900545482, 'loss_val': 0.1319814431977894, 'psi': 0.99458369579651}-{'f1_val': 0.7044045881461305, 'auprc': 0.9992414397220275, 'loss_val': 0.19982910206968046, 'psi': 0.8223393287764893}
[S4] START round=26 head_norm_before_train=1.985245 (no previous merge yet)
[S4] round=26 local utility u=0.000000 metrics={'f1_val': 0.9408479716862315, 'auprc': 0.9251227942950838, 'loss_val': 0.306593762102661, 'psi': 0.9345579007297724}-{'f1_val': 0.942000706118228, 'auprc': 0.9348040936707699, 'loss_val': 0.2991399622684064, 'psi': 0.9391220611392447}
[S5] START round=26 head_norm_before_train=1.543774 cos_to_last_merge=0.7906 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.791
[S5] round=26 local utility u=0.051805 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9977071851531686, 'loss_val': 0.2408257130710883, 'psi': 0.819447909658872}-{'f1_val': 0.7006069008894004, 'auprc': 0.9700908662697088, 'loss_val': 0.26157867557447984, 'psi': 0.8084004870415238}
[S6] START round=26 head_norm_before_train=1.613696 cos_to_last_merge=0.8133 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.813
[S6] round=26 local utility u=0.000000 metrics={'f1_val': 0.8382287686961537, 'auprc': 0.9512754197759297, 'loss_val': 0.42374507716112536, 'psi': 0.8834474291280641}-{'f1_val': 0.8468535025016293, 'auprc': 0.9556992176525299, 'loss_val': 0.39636351476887355, 'psi': 0.8903917885619894}
[S7] START round=26 head_norm_before_train=1.315477 cos_to_last_merge=1.0000 (last merge round=25)
[S7] round=26 local utility u=1.000000 metrics={'f1_val': 0.6817802929254628, 'auprc': 0.9199890390902077, 'loss_val': 0.4467420599235175, 'psi': 0.7770637913913607}-{'f1_val': 0.4190857993836893, 'auprc': 0.7706264966994818, 'loss_val': 0.9126301739076693, 'psi': 0.5597020783100064}
[S8] START round=26 head_norm_before_train=1.078510 cos_to_last_merge=1.0000 (last merge round=25)
[S8] round=26 local utility u=0.000000 metrics={'f1_val': 0.9949323051384696, 'auprc': 0.9969177626048763, 'loss_val': 0.1389714734340318, 'psi': 0.9957264881250323}-{'f1_val': 0.9949323051384696, 'auprc': 0.9959294376928873, 'loss_val': 0.12989639794830543, 'psi': 0.9953311581602367}
[S9] START round=26 head_norm_before_train=1.375564 cos_to_last_merge=0.9992 (last merge round=24)
[S9] round=26 local utility u=0.000000 metrics={'f1_val': 0.8233003000507744, 'auprc': 0.9988041652979746, 'loss_val': 0.2368610860518348, 'psi': 0.8935018461496544}-{'f1_val': 0.9964388212112862, 'auprc': 0.998658633933257, 'loss_val': 0.1012901329016555, 'psi': 0.9973267463000746}
[S10] START round=26 head_norm_before_train=2.033268 (no previous merge yet)
[S10] round=26 local utility u=0.000080 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9959392701550953, 'loss_val': 0.025509536894140414, 'psi': 0.995488411473663}-{'f1_val': 0.9951878390193748, 'auprc': 0.9959593240080228, 'loss_val': 0.02572938762383793, 'psi': 0.9954964330148339}
[S11] START round=26 head_norm_before_train=1.356108 cos_to_last_merge=0.9994 (last merge round=24)
[S11] round=26 local utility u=0.593142 metrics={'f1_val': 0.8975021724663113, 'auprc': 0.9949151295183607, 'loss_val': 0.23818346483461622, 'psi': 0.936467355287131}-{'f1_val': 0.7021118300140827, 'auprc': 0.9984225883401465, 'loss_val': 0.2626477775655826, 'psi': 0.8206361333445082}
[S13] START round=26 head_norm_before_train=1.120890 cos_to_last_merge=1.0000 (last merge round=25)
[S13] round=26 local utility u=0.000000 metrics={'f1_val': 0.6716501068988817, 'auprc': 0.6652036557918409, 'loss_val': 0.7545132478155151, 'psi': 0.6690715264560654}-{'f1_val': 0.6727965893224309, 'auprc': 0.7408345687774511, 'loss_val': 0.6949917646268801, 'psi': 0.7000117811044391}
[S14] START round=26 head_norm_before_train=2.043849 cos_to_last_merge=1.0000 (last merge round=25)
[S14] round=26 local utility u=0.000000 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9978834443434483, 'loss_val': 0.05000223100693925, 'psi': 0.9977440485672915}-{'f1_val': 0.9976538428159559, 'auprc': 0.999474491000733, 'loss_val': 0.047002010345749946, 'psi': 0.9983821020898668}
[S15] START round=26 head_norm_before_train=1.255883 cos_to_last_merge=1.0000 (last merge round=25)
[S15] round=26 local utility u=0.873365 metrics={'f1_val': 0.9959021853469847, 'auprc': 0.9942263564983473, 'loss_val': 0.13285266335982462, 'psi': 0.9952318538075298}-{'f1_val': 0.749359869205756, 'auprc': 0.9901484996148683, 'loss_val': 0.38809614076668164, 'psi': 0.8456753213694009}
[S16] START round=26 head_norm_before_train=1.630046 cos_to_last_merge=0.8160 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.816
[S16] round=26 local utility u=0.000000 metrics={'f1_val': 0.9436600456047031, 'auprc': 0.9895676353602014, 'loss_val': 0.1725679157489502, 'psi': 0.9620230815069024}-{'f1_val': 0.9926833142060669, 'auprc': 0.998468430897388, 'loss_val': 0.049632668139866366, 'psi': 0.9949973608825953}
[S17] START round=26 head_norm_before_train=0.990953 cos_to_last_merge=1.0000 (last merge round=25)
[S17] round=26 local utility u=0.255608 metrics={'f1_val': 0.6785566508469008, 'auprc': 0.8675495259463939, 'loss_val': 0.5481823198308218, 'psi': 0.7541538008866979}-{'f1_val': 0.6162004626345673, 'auprc': 0.8353291850409689, 'loss_val': 0.588600407905357, 'psi': 0.703851951597128}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] → sending delta(kind=head bytes=1805) to S8@127.0.0.1:52809
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:52814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:52812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:52810
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] → sending delta(kind=head bytes=1805) to S11@127.0.0.1:52812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] → sending delta(kind=head bytes=1794) to S17@127.0.0.1:52817
[S15] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1794 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1805 to 1 peers)
[S3] sending update (kind=head size=1805 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1801) from S5
[S11] cosine check vs S5: cos=0.5923
[S14] RECEIVED delta(kind=head bytes=1799) from S10
[S14] cosine check vs S10: cos=0.9995
[S11] RECEIVED delta(kind=head bytes=1805) from S3
[S11] cosine check vs S3: cos=0.8550
[S17] RECEIVED delta(kind=head bytes=1794) from S7
[S17] cosine check vs S7: cos=0.6011
[S8] RECEIVED delta(kind=head bytes=1799) from S2
[S8] cosine check vs S2: cos=0.2633
[S8] RECEIVED delta(kind=head bytes=1805) from S11
[S8] cosine check vs S11: cos=0.7636
[S9] RECEIVED delta(kind=head bytes=1797) from S15
[S9] cosine check vs S15: cos=0.9530
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] → sending delta(kind=head bytes=1793) to S13@127.0.0.1:52813
[S17] sending update (kind=head size=1793 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1793) from S17
[S13] cosine check vs S17: cos=0.9323
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=26 metric=0.8233 head_norm=1.408938
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.137114e-01
[S9] stored merged vector for next round verification (round=26)
[S9] DEBUG after merge:  round=26 metric=0.8413 head_norm=1.349239 delta_norm=0.213711
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=26 metric=0.8975 head_norm=1.382384
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.168904e-01
[S11] stored merged vector for next round verification (round=26)
[S11] DEBUG after merge:  round=26 metric=0.8876 head_norm=1.333311 delta_norm=0.116890
[S11] aggregate: ROLLBACK (f1_val pre=0.898 post=0.888 tol_abs=0.005 tol_rel=0.0)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=26 metric=0.6717 head_norm=1.183344
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.163264e-01
[S13] stored merged vector for next round verification (round=26)
[S13] DEBUG after merge:  round=26 metric=0.6726 head_norm=1.092604 delta_norm=0.216326
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=26 metric=0.9949 head_norm=1.147185
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.955800e-01
[S8] stored merged vector for next round verification (round=26)
[S8] DEBUG after merge:  round=26 metric=0.9946 head_norm=1.071941 delta_norm=0.495580
[S8] aggregate: ACCEPT kept=['S2', 'S11'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=26 metric=0.9977 head_norm=2.063061
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.452822e-02
[S14] stored merged vector for next round verification (round=26)
[S14] DEBUG after merge:  round=26 metric=0.9977 head_norm=2.052722 delta_norm=0.034528
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=26 metric=0.6786 head_norm=1.039644
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.463370e-01
[S17] stored merged vector for next round verification (round=26)
[S17] DEBUG after merge:  round=26 metric=0.7145 head_norm=1.064237 delta_norm=0.546337
[S17] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=27 head_norm_before_train=1.973380 (no previous merge yet)
[S2] round=27 local utility u=0.000000 metrics={'f1_val': 0.5967667432978042, 'auprc': 0.720841030148109, 'loss_val': 1.7180769237251043, 'psi': 0.6463964580379261}-{'f1_val': 0.7157050501465694, 'auprc': 0.8529129821046256, 'loss_val': 0.8009700413481378, 'psi': 0.7705882229297919}
[S3] START round=27 head_norm_before_train=1.906102 (no previous merge yet)
[S3] round=27 local utility u=0.000000 metrics={'f1_val': 0.9445896153505978, 'auprc': 0.9949363643731852, 'loss_val': 0.18349946607398138, 'psi': 0.9647283149596328}-{'f1_val': 0.991512366291151, 'auprc': 0.9991906900545482, 'loss_val': 0.1319814431977894, 'psi': 0.99458369579651}
[S4] START round=27 head_norm_before_train=1.998432 (no previous merge yet)
[S4] round=27 local utility u=0.017950 metrics={'f1_val': 0.942002649464142, 'auprc': 0.9328075363735924, 'loss_val': 0.30067605296193767, 'psi': 0.9383246042279222}-{'f1_val': 0.9408479716862315, 'auprc': 0.9251227942950838, 'loss_val': 0.306593762102661, 'psi': 0.9345579007297724}
[S5] START round=27 head_norm_before_train=1.557348 cos_to_last_merge=0.7891 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.789
[S5] round=27 local utility u=0.000000 metrics={'f1_val': 0.7134296633897096, 'auprc': 0.7975117826580543, 'loss_val': 0.4610257539852738, 'psi': 0.7470625110970475}-{'f1_val': 0.7006083926626743, 'auprc': 0.9977071851531686, 'loss_val': 0.2408257130710883, 'psi': 0.819447909658872}
[S6] START round=27 head_norm_before_train=1.635432 cos_to_last_merge=0.8108 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.811
[S6] round=27 local utility u=0.000000 metrics={'f1_val': 0.6337082806762111, 'auprc': 0.8916903770860445, 'loss_val': 0.8793700999815629, 'psi': 0.7369011192401445}-{'f1_val': 0.8382287686961537, 'auprc': 0.9512754197759297, 'loss_val': 0.42374507716112536, 'psi': 0.8834474291280641}
[S7] START round=27 head_norm_before_train=1.334657 cos_to_last_merge=0.9997 (last merge round=25)
[S7] round=27 local utility u=0.000000 metrics={'f1_val': 0.3948911257141996, 'auprc': 0.6171184631282164, 'loss_val': 1.1618903236775484, 'psi': 0.48378206067980634}-{'f1_val': 0.6817802929254628, 'auprc': 0.9199890390902077, 'loss_val': 0.4467420599235175, 'psi': 0.7770637913913607}
[S8] START round=27 head_norm_before_train=1.071941 cos_to_last_merge=1.0000 (last merge round=26)
[S8] round=27 local utility u=0.004923 metrics={'f1_val': 0.9949323051384696, 'auprc': 0.9967036527739881, 'loss_val': 0.12848259767186476, 'psi': 0.995640844192677}-{'f1_val': 0.9949323051384696, 'auprc': 0.9969177626048763, 'loss_val': 0.1389714734340318, 'psi': 0.9957264881250323}
[S9] START round=27 head_norm_before_train=1.349239 cos_to_last_merge=1.0000 (last merge round=26)
[S9] round=27 local utility u=0.567955 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9911215329919021, 'loss_val': 0.11825569603052377, 'psi': 0.9944641079556181}-{'f1_val': 0.8233003000507744, 'auprc': 0.9988041652979746, 'loss_val': 0.2368610860518348, 'psi': 0.8935018461496544}
[S10] START round=27 head_norm_before_train=2.042915 (no previous merge yet)
[S10] round=27 local utility u=0.000366 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9960950027470141, 'loss_val': 0.025245541939003777, 'psi': 0.9955507045104305}-{'f1_val': 0.9951878390193748, 'auprc': 0.9959392701550953, 'loss_val': 0.025509536894140414, 'psi': 0.995488411473663}
[S11] START round=27 head_norm_before_train=1.333311 cos_to_last_merge=1.0000 (last merge round=26)
[S11] round=27 local utility u=0.000000 metrics={'f1_val': 0.7031511311825693, 'auprc': 0.9986209732787144, 'loss_val': 0.24479699417622114, 'psi': 0.8213390680210273}-{'f1_val': 0.8975021724663113, 'auprc': 0.9949151295183607, 'loss_val': 0.23818346483461622, 'psi': 0.936467355287131}
[S13] START round=27 head_norm_before_train=1.092604 cos_to_last_merge=1.0000 (last merge round=26)
[S13] round=27 local utility u=0.150512 metrics={'f1_val': 0.6232774652664849, 'auprc': 0.8982209492709238, 'loss_val': 0.8623051459941309, 'psi': 0.7332548588682604}-{'f1_val': 0.6716501068988817, 'auprc': 0.6652036557918409, 'loss_val': 0.7545132478155151, 'psi': 0.6690715264560654}
[S14] START round=27 head_norm_before_train=2.052722 cos_to_last_merge=1.0000 (last merge round=26)
[S14] round=27 local utility u=0.002529 metrics={'f1_val': 0.997673454559638, 'auprc': 0.9979096435582516, 'loss_val': 0.04515673274657023, 'psi': 0.9977679301590834}-{'f1_val': 0.9976511180498535, 'auprc': 0.9978834443434483, 'loss_val': 0.05000223100693925, 'psi': 0.9977440485672915}
[S15] START round=27 head_norm_before_train=1.321791 cos_to_last_merge=0.9969 (last merge round=25)
[S15] round=27 local utility u=0.000000 metrics={'f1_val': 0.7007681293011265, 'auprc': 0.8065387257202905, 'loss_val': 0.47845330759436133, 'psi': 0.7430763678687922}-{'f1_val': 0.9959021853469847, 'auprc': 0.9942263564983473, 'loss_val': 0.13285266335982462, 'psi': 0.9952318538075298}
[S16] START round=27 head_norm_before_train=1.650837 cos_to_last_merge=0.8145 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.815
[S16] round=27 local utility u=0.219745 metrics={'f1_val': 0.9922499116589072, 'auprc': 0.9969991980246948, 'loss_val': 0.04691232599868159, 'psi': 0.9941496262052223}-{'f1_val': 0.9436600456047031, 'auprc': 0.9895676353602014, 'loss_val': 0.1725679157489502, 'psi': 0.9620230815069024}
[S17] START round=27 head_norm_before_train=1.064237 cos_to_last_merge=1.0000 (last merge round=26)
[S17] round=27 local utility u=0.042267 metrics={'f1_val': 0.65842223647608, 'auprc': 0.9364540558145479, 'loss_val': 0.5495560274574353, 'psi': 0.7696349642114672}-{'f1_val': 0.6785566508469008, 'auprc': 0.8675495259463939, 'loss_val': 0.5481823198308218, 'psi': 0.7541538008866979}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:52802
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:52811
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S16] sending update (kind=head size=1807 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:52817
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:52815
[S13] sending update (kind=head size=1795 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1800) from S8
[S2] cosine check vs S8: cos=0.5929
[S17] RECEIVED delta(kind=head bytes=1795) from S13
[S17] cosine check vs S13: cos=0.8897
[S10] RECEIVED delta(kind=head bytes=1798) from S14
[S10] cosine check vs S14: cos=0.9996
[S15] RECEIVED delta(kind=head bytes=1800) from S9
[S15] cosine check vs S9: cos=0.9876
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:52807
[S17] sending update (kind=head size=1797 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1797) from S17
[S6] cosine check vs S17: cos=0.3120
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=27 metric=0.6337 head_norm=1.652395
[S6] _apply_head_vector_avg (torch): Δ‖w‖=8.407905e-01
[S6] stored merged vector for next round verification (round=27)
[S6] DEBUG after merge:  round=27 metric=0.6372 head_norm=1.132835 delta_norm=0.840791
[S6] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=27 metric=0.5968 head_norm=1.987208
[S2] _apply_head_vector_avg (torch): Δ‖w‖=8.002641e-01
[S2] stored merged vector for next round verification (round=27)
[S2] DEBUG after merge:  round=27 metric=0.5955 head_norm=1.411010 delta_norm=0.800264
[S2] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=27 metric=0.9952 head_norm=2.054838
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.173642e-02
[S10] stored merged vector for next round verification (round=27)
[S10] DEBUG after merge:  round=27 metric=0.9952 head_norm=2.063515 delta_norm=0.031736
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=27 metric=0.7008 head_norm=1.383309
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.086407e-01
[S15] stored merged vector for next round verification (round=27)
[S15] DEBUG after merge:  round=27 metric=0.7008 head_norm=1.373467 delta_norm=0.108641
[S15] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=27 metric=0.6584 head_norm=1.118068
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.643425e-01
[S17] stored merged vector for next round verification (round=27)
[S17] DEBUG after merge:  round=27 metric=0.6605 head_norm=1.093541 delta_norm=0.264343
[S17] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=28 head_norm_before_train=1.411010 cos_to_last_merge=1.0000 (last merge round=27)
[S2] round=28 local utility u=1.000000 metrics={'f1_val': 0.7149041552151069, 'auprc': 0.8307075122123436, 'loss_val': 0.5969999133211952, 'psi': 0.7612254980140016}-{'f1_val': 0.5967667432978042, 'auprc': 0.720841030148109, 'loss_val': 1.7180769237251043, 'psi': 0.6463964580379261}
[S3] START round=28 head_norm_before_train=1.923904 (no previous merge yet)
[S3] round=28 local utility u=0.000000 metrics={'f1_val': 0.9144801528572432, 'auprc': 0.9891590165953168, 'loss_val': 0.1779339715579681, 'psi': 0.9443516983524726}-{'f1_val': 0.9445896153505978, 'auprc': 0.9949363643731852, 'loss_val': 0.18349946607398138, 'psi': 0.9647283149596328}
[S4] START round=28 head_norm_before_train=2.007145 (no previous merge yet)
[S4] round=28 local utility u=0.000000 metrics={'f1_val': 0.9412144015097765, 'auprc': 0.9249603427126202, 'loss_val': 0.30432497015016585, 'psi': 0.934712777990914}-{'f1_val': 0.942002649464142, 'auprc': 0.9328075363735924, 'loss_val': 0.30067605296193767, 'psi': 0.9383246042279222}
[S5] START round=28 head_norm_before_train=1.572479 cos_to_last_merge=0.7872 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.787
[S5] round=28 local utility u=0.374124 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9976840871065992, 'loss_val': 0.23636717876997734, 'psi': 0.8194386704402443}-{'f1_val': 0.7134296633897096, 'auprc': 0.7975117826580543, 'loss_val': 0.4610257539852738, 'psi': 0.7470625110970475}
[S6] START round=28 head_norm_before_train=1.132835 cos_to_last_merge=1.0000 (last merge round=27)
[S6] round=28 local utility u=0.432313 metrics={'f1_val': 0.7125503500075245, 'auprc': 0.9338700156304494, 'loss_val': 0.6143358025703404, 'psi': 0.8010782162566945}-{'f1_val': 0.6337082806762111, 'auprc': 0.8916903770860445, 'loss_val': 0.8793700999815629, 'psi': 0.7369011192401445}
[S7] START round=28 head_norm_before_train=1.349398 cos_to_last_merge=0.9992 (last merge round=25)
[S7] round=28 local utility u=0.416190 metrics={'f1_val': 0.4791778575142704, 'auprc': 0.65297123353937, 'loss_val': 0.942789359436932, 'psi': 0.5486952079243103}-{'f1_val': 0.3948911257141996, 'auprc': 0.6171184631282164, 'loss_val': 1.1618903236775484, 'psi': 0.48378206067980634}
[S8] START round=28 head_norm_before_train=1.146188 cos_to_last_merge=0.9965 (last merge round=26)
[S8] round=28 local utility u=0.016610 metrics={'f1_val': 0.9949323051384696, 'auprc': 0.9957795949934775, 'loss_val': 0.09249058810838144, 'psi': 0.9952712210804727}-{'f1_val': 0.9949323051384696, 'auprc': 0.9967036527739881, 'loss_val': 0.12848259767186476, 'psi': 0.995640844192677}
[S9] START round=28 head_norm_before_train=1.372183 cos_to_last_merge=0.9996 (last merge round=26)
[S9] round=28 local utility u=0.000000 metrics={'f1_val': 0.8462969793336123, 'auprc': 0.9988015914968281, 'loss_val': 0.21461992474828723, 'psi': 0.9072988241988986}-{'f1_val': 0.9966924912647621, 'auprc': 0.9911215329919021, 'loss_val': 0.11825569603052377, 'psi': 0.9944641079556181}
[S10] START round=28 head_norm_before_train=2.063515 cos_to_last_merge=1.0000 (last merge round=27)
[S10] round=28 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9959554503245698, 'loss_val': 0.025084537394909557, 'psi': 0.9954948835414528}-{'f1_val': 0.9951878390193748, 'auprc': 0.9960950027470141, 'loss_val': 0.025245541939003777, 'psi': 0.9955507045104305}
[S11] START round=28 head_norm_before_train=1.357731 cos_to_last_merge=0.9995 (last merge round=26)
[S11] round=28 local utility u=0.907153 metrics={'f1_val': 0.9966988539245482, 'auprc': 0.9979773709983679, 'loss_val': 0.18984732278970387, 'psi': 0.997210260754076}-{'f1_val': 0.7031511311825693, 'auprc': 0.9986209732787144, 'loss_val': 0.24479699417622114, 'psi': 0.8213390680210273}
[S13] START round=28 head_norm_before_train=1.131963 cos_to_last_merge=0.9986 (last merge round=26)
[S13] round=28 local utility u=0.000000 metrics={'f1_val': 0.6272977579820526, 'auprc': 0.6309246452471369, 'loss_val': 0.807439602494663, 'psi': 0.6287485128880863}-{'f1_val': 0.6232774652664849, 'auprc': 0.8982209492709238, 'loss_val': 0.8623051459941309, 'psi': 0.7332548588682604}
[S14] START round=28 head_norm_before_train=2.072642 cos_to_last_merge=0.9999 (last merge round=26)
[S14] round=28 local utility u=0.005742 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9996012858388936, 'loss_val': 0.03861436040015038, 'psi': 0.9984311851654696}-{'f1_val': 0.997673454559638, 'auprc': 0.9979096435582516, 'loss_val': 0.04515673274657023, 'psi': 0.9977679301590834}
[S15] START round=28 head_norm_before_train=1.373467 cos_to_last_merge=1.0000 (last merge round=27)
[S15] round=28 local utility u=0.420605 metrics={'f1_val': 0.7903400170723626, 'auprc': 0.8903545395692807, 'loss_val': 0.4261228171438816, 'psi': 0.8303458260711298}-{'f1_val': 0.7007681293011265, 'auprc': 0.8065387257202905, 'loss_val': 0.47845330759436133, 'psi': 0.7430763678687922}
[S16] START round=28 head_norm_before_train=1.669559 cos_to_last_merge=0.8130 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.813
[S16] round=28 local utility u=0.000000 metrics={'f1_val': 0.9911367318403803, 'auprc': 0.9967954416093858, 'loss_val': 0.058585013334293265, 'psi': 0.9934002157479824}-{'f1_val': 0.9922499116589072, 'auprc': 0.9969991980246948, 'loss_val': 0.04691232599868159, 'psi': 0.9941496262052223}
[S17] START round=28 head_norm_before_train=1.093541 cos_to_last_merge=1.0000 (last merge round=27)
[S17] round=28 local utility u=0.000000 metrics={'f1_val': 0.6526168142191686, 'auprc': 0.7799752103125211, 'loss_val': 0.6994601081231727, 'psi': 0.7035601726565097}-{'f1_val': 0.65842223647608, 'auprc': 0.9364540558145479, 'loss_val': 0.5495560274574353, 'psi': 0.7696349642114672}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:52802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:52816
[S8] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1798) from S7
[S16] cosine check vs S7: cos=0.9617
[S2] RECEIVED delta(kind=head bytes=1800) from S8
[S2] cosine check vs S8: cos=0.8098
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:52803
[S11] sending update (kind=head size=1798 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1798) from S11
[S3] cosine check vs S11: cos=0.8267
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:52811
[S14] sending update (kind=head size=1799 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1799) from S14
[S10] cosine check vs S14: cos=0.9996
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:52809
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=28 metric=0.9145 head_norm=1.944307
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.581672e-01
[S3] stored merged vector for next round verification (round=28)
[S3] DEBUG after merge:  round=28 metric=0.9342 head_norm=1.593015 delta_norm=0.558167
[S3] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=28 metric=0.7149 head_norm=1.447728
[S2] _apply_head_vector_avg (torch): Δ‖w‖=4.250655e-01
[S2] stored merged vector for next round verification (round=28)
[S2] DEBUG after merge:  round=28 metric=0.7121 head_norm=1.263690 delta_norm=0.425066
[S2] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1800) from S15
[S8] cosine check vs S15: cos=0.8872
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=28 metric=0.9949 head_norm=1.208002
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.281454e-01
[S8] stored merged vector for next round verification (round=28)
[S8] DEBUG after merge:  round=28 metric=0.9953 head_norm=1.275855 delta_norm=0.328145
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=28 metric=0.9952 head_norm=2.074562
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.980163e-02
[S10] stored merged vector for next round verification (round=28)
[S10] DEBUG after merge:  round=28 metric=0.9952 head_norm=2.083511 delta_norm=0.029802
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=28 metric=0.9911 head_norm=1.688197
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.664853e-01
[S16] stored merged vector for next round verification (round=28)
[S16] DEBUG after merge:  round=28 metric=0.9920 head_norm=1.509173 delta_norm=0.266485
[S16] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=29 head_norm_before_train=1.263690 cos_to_last_merge=1.0000 (last merge round=28)
[S2] round=29 local utility u=0.000000 metrics={'f1_val': 0.5851076105171584, 'auprc': 0.7151144363563587, 'loss_val': 1.133385957282079, 'psi': 0.6371103408528385}-{'f1_val': 0.7149041552151069, 'auprc': 0.8307075122123436, 'loss_val': 0.5969999133211952, 'psi': 0.7612254980140016}
[S3] START round=29 head_norm_before_train=1.593015 cos_to_last_merge=1.0000 (last merge round=28)
[S3] round=29 local utility u=0.000835 metrics={'f1_val': 0.9271779578757238, 'auprc': 0.972324701718497, 'loss_val': 0.2019470529399729, 'psi': 0.9452366554128331}-{'f1_val': 0.9144801528572432, 'auprc': 0.9891590165953168, 'loss_val': 0.1779339715579681, 'psi': 0.9443516983524726}
[S4] START round=29 head_norm_before_train=2.006095 (no previous merge yet)
[S4] round=29 local utility u=0.046491 metrics={'f1_val': 0.9494331960686342, 'auprc': 0.9376026967332151, 'loss_val': 0.2985818784202428, 'psi': 0.9447009963344666}-{'f1_val': 0.9412144015097765, 'auprc': 0.9249603427126202, 'loss_val': 0.30432497015016585, 'psi': 0.934712777990914}
[S5] START round=29 head_norm_before_train=1.585519 cos_to_last_merge=0.7861 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.786
[S5] round=29 local utility u=0.000000 metrics={'f1_val': 0.700614005059664, 'auprc': 0.9930275726892103, 'loss_val': 0.22590903033659038, 'psi': 0.8175794321114824}-{'f1_val': 0.7006083926626743, 'auprc': 0.9976840871065992, 'loss_val': 0.23636717876997734, 'psi': 0.8194386704402443}
[S6] START round=29 head_norm_before_train=1.195230 cos_to_last_merge=0.9986 (last merge round=27)
[S6] round=29 local utility u=0.465647 metrics={'f1_val': 0.8285292774095614, 'auprc': 0.9482109493061764, 'loss_val': 0.4219381795476184, 'psi': 0.8764019461682073}-{'f1_val': 0.7125503500075245, 'auprc': 0.9338700156304494, 'loss_val': 0.6143358025703404, 'psi': 0.8010782162566945}
[S7] START round=29 head_norm_before_train=1.359126 cos_to_last_merge=0.9987 (last merge round=25)
[S7] round=29 local utility u=1.000000 metrics={'f1_val': 0.681804890150531, 'auprc': 0.8365264438963776, 'loss_val': 0.467843673901968, 'psi': 0.7436935116488697}-{'f1_val': 0.4791778575142704, 'auprc': 0.65297123353937, 'loss_val': 0.942789359436932, 'psi': 0.5486952079243103}
[S8] START round=29 head_norm_before_train=1.275855 cos_to_last_merge=1.0000 (last merge round=28)
[S8] round=29 local utility u=0.007909 metrics={'f1_val': 0.9923086083290242, 'auprc': 0.9979567139420238, 'loss_val': 0.06746101349921961, 'psi': 0.9945678505742241}-{'f1_val': 0.9949323051384696, 'auprc': 0.9957795949934775, 'loss_val': 0.09249058810838144, 'psi': 0.9952712210804727}
[S9] START round=29 head_norm_before_train=1.394930 cos_to_last_merge=0.9984 (last merge round=26)
[S9] round=29 local utility u=0.514129 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9969681875221159, 'loss_val': 0.08569699141563943, 'psi': 0.997049022516132}-{'f1_val': 0.8462969793336123, 'auprc': 0.9988015914968281, 'loss_val': 0.21461992474828723, 'psi': 0.9072988241988986}
[S10] START round=29 head_norm_before_train=2.083511 cos_to_last_merge=1.0000 (last merge round=28)
[S10] round=29 local utility u=0.000100 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9959605069612829, 'loss_val': 0.024900622770370955, 'psi': 0.9954969061961381}-{'f1_val': 0.9951878390193748, 'auprc': 0.9959554503245698, 'loss_val': 0.025084537394909557, 'psi': 0.9954948835414528}
[S11] START round=29 head_norm_before_train=1.384979 cos_to_last_merge=0.9982 (last merge round=26)
[S11] round=29 local utility u=0.000000 metrics={'f1_val': 0.8517433434895357, 'auprc': 0.9503882875441997, 'loss_val': 0.5382420629428876, 'psi': 0.8912013211114014}-{'f1_val': 0.9966988539245482, 'auprc': 0.9979773709983679, 'loss_val': 0.18984732278970387, 'psi': 0.997210260754076}
[S13] START round=29 head_norm_before_train=1.161111 cos_to_last_merge=0.9962 (last merge round=26)
[S13] round=29 local utility u=0.331210 metrics={'f1_val': 0.7179621991424406, 'auprc': 0.6885889248692155, 'loss_val': 0.8619996738905293, 'psi': 0.7062128894331505}-{'f1_val': 0.6272977579820526, 'auprc': 0.6309246452471369, 'loss_val': 0.807439602494663, 'psi': 0.6287485128880863}
[S14] START round=29 head_norm_before_train=2.092847 cos_to_last_merge=0.9997 (last merge round=26)
[S14] round=29 local utility u=0.000000 metrics={'f1_val': 0.9896852751059498, 'auprc': 0.9975089781408345, 'loss_val': 0.05502815938400572, 'psi': 0.9928147563199037}-{'f1_val': 0.9976511180498535, 'auprc': 0.9996012858388936, 'loss_val': 0.03861436040015038, 'psi': 0.9984311851654696}
[S15] START round=29 head_norm_before_train=1.418345 cos_to_last_merge=0.9994 (last merge round=27)
[S15] round=29 local utility u=0.909162 metrics={'f1_val': 0.9819012022249413, 'auprc': 0.9962372059786729, 'loss_val': 0.07481347920829844, 'psi': 0.987635603726434}-{'f1_val': 0.7903400170723626, 'auprc': 0.8903545395692807, 'loss_val': 0.4261228171438816, 'psi': 0.8303458260711298}
[S16] START round=29 head_norm_before_train=1.509173 cos_to_last_merge=1.0000 (last merge round=28)
[S16] round=29 local utility u=0.000000 metrics={'f1_val': 0.9870428232629105, 'auprc': 0.9933809975358198, 'loss_val': 0.07948617755303644, 'psi': 0.9895780929720742}-{'f1_val': 0.9911367318403803, 'auprc': 0.9967954416093858, 'loss_val': 0.058585013334293265, 'psi': 0.9934002157479824}
[S17] START round=29 head_norm_before_train=1.155421 cos_to_last_merge=0.9979 (last merge round=27)
[S17] round=29 local utility u=0.000000 metrics={'f1_val': 0.5843292971634937, 'auprc': 0.7698973089742915, 'loss_val': 0.8161398474309297, 'psi': 0.6585565018878128}-{'f1_val': 0.6526168142191686, 'auprc': 0.7799752103125211, 'loss_val': 0.6994601081231727, 'psi': 0.7035601726565097}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:52809
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S13] → sending delta(kind=head bytes=1793) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:52815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:52802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:52816
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1793 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1793) from S13
[S17] cosine check vs S13: cos=0.9634
[S15] RECEIVED delta(kind=head bytes=1800) from S9
[S15] cosine check vs S9: cos=0.9924
[S16] RECEIVED delta(kind=head bytes=1802) from S7
[S16] cosine check vs S7: cos=0.9869
[S8] RECEIVED delta(kind=head bytes=1800) from S15
[S8] cosine check vs S15: cos=0.9724
[S2] RECEIVED delta(kind=head bytes=1800) from S8
[S2] cosine check vs S8: cos=0.8298
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=29 metric=0.5851 head_norm=1.337266
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.878482e-01
[S2] stored merged vector for next round verification (round=29)
[S2] DEBUG after merge:  round=29 metric=0.5805 head_norm=1.271502 delta_norm=0.387848
[S2] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=29 metric=0.9819 head_norm=1.455198
[S15] _apply_head_vector_avg (torch): Δ‖w‖=9.093936e-02
[S15] stored merged vector for next round verification (round=29)
[S15] DEBUG after merge:  round=29 metric=0.9819 head_norm=1.431687 delta_norm=0.090939
[S15] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=29 metric=0.9923 head_norm=1.321367
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.761443e-01
[S8] stored merged vector for next round verification (round=29)
[S8] DEBUG after merge:  round=29 metric=0.9930 head_norm=1.378687 delta_norm=0.176144
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=29 metric=0.5843 head_norm=1.203843
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.617957e-01
[S17] stored merged vector for next round verification (round=29)
[S17] DEBUG after merge:  round=29 metric=0.5843 head_norm=1.182455 delta_norm=0.161796
[S17] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=29 metric=0.9870 head_norm=1.526414
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.418118e-01
[S16] stored merged vector for next round verification (round=29)
[S16] DEBUG after merge:  round=29 metric=0.9888 head_norm=1.441571 delta_norm=0.141812
[S16] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=30 head_norm_before_train=1.271502 cos_to_last_merge=1.0000 (last merge round=29)
[S2] round=30 local utility u=0.576957 metrics={'f1_val': 0.6726690857895083, 'auprc': 0.7607483532779351, 'loss_val': 0.6417420982933741, 'psi': 0.707900792784879}-{'f1_val': 0.5851076105171584, 'auprc': 0.7151144363563587, 'loss_val': 1.133385957282079, 'psi': 0.6371103408528385}
[S3] START round=30 head_norm_before_train=1.616196 cos_to_last_merge=0.9998 (last merge round=28)
[S3] round=30 local utility u=0.312559 metrics={'f1_val': 0.9979722591986233, 'auprc': 0.9995671256631673, 'loss_val': 0.0833225658751855, 'psi': 0.9986102057844408}-{'f1_val': 0.9271779578757238, 'auprc': 0.972324701718497, 'loss_val': 0.2019470529399729, 'psi': 0.9452366554128331}
[S4] START round=30 head_norm_before_train=2.013362 (no previous merge yet)
[S4] round=30 local utility u=0.002359 metrics={'f1_val': 0.9476704692576886, 'auprc': 0.9419511994884178, 'loss_val': 0.2963334572265438, 'psi': 0.9453827613499802}-{'f1_val': 0.9494331960686342, 'auprc': 0.9376026967332151, 'loss_val': 0.2985818784202428, 'psi': 0.9447009963344666}
[S5] START round=30 head_norm_before_train=1.596034 cos_to_last_merge=0.7849 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.785
[S5] round=30 local utility u=0.023078 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9976847030504435, 'loss_val': 0.19369040605711155, 'psi': 0.819438916817782}-{'f1_val': 0.700614005059664, 'auprc': 0.9930275726892103, 'loss_val': 0.22590903033659038, 'psi': 0.8175794321114824}
[S6] START round=30 head_norm_before_train=1.290760 cos_to_last_merge=0.9931 (last merge round=27)
[S6] round=30 local utility u=0.000000 metrics={'f1_val': 0.5879195375131474, 'auprc': 0.6605735412336853, 'loss_val': 1.0080463792428247, 'psi': 0.6169811390013626}-{'f1_val': 0.8285292774095614, 'auprc': 0.9482109493061764, 'loss_val': 0.4219381795476184, 'psi': 0.8764019461682073}
[S7] START round=30 head_norm_before_train=1.366212 cos_to_last_merge=0.9983 (last merge round=25)
[S7] round=30 local utility u=0.000000 metrics={'f1_val': 0.467493415778137, 'auprc': 0.7732684670077192, 'loss_val': 0.9444232628448578, 'psi': 0.58980343626997}-{'f1_val': 0.681804890150531, 'auprc': 0.8365264438963776, 'loss_val': 0.467843673901968, 'psi': 0.7436935116488697}
[S8] START round=30 head_norm_before_train=1.378687 cos_to_last_merge=1.0000 (last merge round=29)
[S8] round=30 local utility u=0.014417 metrics={'f1_val': 0.9949323051384696, 'auprc': 0.9969731211926641, 'loss_val': 0.05141791066333603, 'psi': 0.9957486315601474}-{'f1_val': 0.9923086083290242, 'auprc': 0.9979567139420238, 'loss_val': 0.06746101349921961, 'psi': 0.9945678505742241}
[S9] START round=30 head_norm_before_train=1.413646 cos_to_last_merge=0.9970 (last merge round=26)
[S9] round=30 local utility u=0.000000 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.992512982040851, 'loss_val': 0.0750922572875195, 'psi': 0.9950206875751977}-{'f1_val': 0.9971029125121428, 'auprc': 0.9969681875221159, 'loss_val': 0.08569699141563943, 'psi': 0.997049022516132}
[S10] START round=30 head_norm_before_train=2.089382 cos_to_last_merge=1.0000 (last merge round=28)
[S10] round=30 local utility u=0.000103 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9959553875006296, 'loss_val': 0.02467938254840639, 'psi': 0.9954948584118767}-{'f1_val': 0.9951878390193748, 'auprc': 0.9959605069612829, 'loss_val': 0.024900622770370955, 'psi': 0.9954969061961381}
[S11] START round=30 head_norm_before_train=1.410105 cos_to_last_merge=0.9963 (last merge round=26)
[S11] round=30 local utility u=0.571681 metrics={'f1_val': 0.9585259374703, 'auprc': 0.9948307786038078, 'loss_val': 0.16890321105091122, 'psi': 0.9730478739237032}-{'f1_val': 0.8517433434895357, 'auprc': 0.9503882875441997, 'loss_val': 0.5382420629428876, 'psi': 0.8912013211114014}
[S13] START round=30 head_norm_before_train=1.183012 cos_to_last_merge=0.9936 (last merge round=26)
[S13] round=30 local utility u=0.371980 metrics={'f1_val': 0.7409939255528416, 'auprc': 0.8160262140952903, 'loss_val': 0.6385416055488896, 'psi': 0.7710068409698211}-{'f1_val': 0.7179621991424406, 'auprc': 0.6885889248692155, 'loss_val': 0.8619996738905293, 'psi': 0.7062128894331505}
[S14] START round=30 head_norm_before_train=2.108189 cos_to_last_merge=0.9993 (last merge round=26)
[S14] round=30 local utility u=0.034701 metrics={'f1_val': 0.9974306056599991, 'auprc': 0.997908726325779, 'loss_val': 0.03329726404711731, 'psi': 0.9976218539263111}-{'f1_val': 0.9896852751059498, 'auprc': 0.9975089781408345, 'loss_val': 0.05502815938400572, 'psi': 0.9928147563199037}
[S15] START round=30 head_norm_before_train=1.431687 cos_to_last_merge=1.0000 (last merge round=29)
[S15] round=30 local utility u=0.000000 metrics={'f1_val': 0.803548141573443, 'auprc': 0.9189089144647624, 'loss_val': 0.3703697161890928, 'psi': 0.8496924507299708}-{'f1_val': 0.9819012022249413, 'auprc': 0.9962372059786729, 'loss_val': 0.07481347920829844, 'psi': 0.987635603726434}
[S16] START round=30 head_norm_before_train=1.441571 cos_to_last_merge=1.0000 (last merge round=29)
[S16] round=30 local utility u=0.000000 metrics={'f1_val': 0.9106413655067216, 'auprc': 0.9937016823830901, 'loss_val': 0.21730984321106528, 'psi': 0.943865492257269}-{'f1_val': 0.9870428232629105, 'auprc': 0.9933809975358198, 'loss_val': 0.07948617755303644, 'psi': 0.9895780929720742}
[S17] START round=30 head_norm_before_train=1.182455 cos_to_last_merge=1.0000 (last merge round=29)
[S17] round=30 local utility u=0.000000 metrics={'f1_val': 0.5435850267013307, 'auprc': 0.7283052079804649, 'loss_val': 0.913225674725923, 'psi': 0.6174730992129844}-{'f1_val': 0.5843292971634937, 'auprc': 0.7698973089742915, 'loss_val': 0.8161398474309297, 'psi': 0.6585565018878128}
[S2]  timeout peer S3
[S3]  timeout peer S2
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:52802
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S11] → sending delta(kind=head bytes=1806) to S3@127.0.0.1:52803
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:52811
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] → sending delta(kind=head bytes=1794) to S17@127.0.0.1:52817
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1806 to 1 peers)
[S13] sending update (kind=head size=1794 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1806) from S11
[S3] cosine check vs S11: cos=0.9320
[S2] RECEIVED delta(kind=head bytes=1801) from S8
[S2] cosine check vs S8: cos=0.8939
[S17] RECEIVED delta(kind=head bytes=1794) from S13
[S17] cosine check vs S13: cos=0.9854
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1800 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1800) from S14
[S10] cosine check vs S14: cos=0.9994
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=30 metric=0.9980 head_norm=1.639667
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.013074e-01
[S3] stored merged vector for next round verification (round=30)
[S3] DEBUG after merge:  round=30 metric=0.9980 head_norm=1.507535 delta_norm=0.301307
[S3] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=30 metric=0.6727 head_norm=1.348900
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.202926e-01
[S2] stored merged vector for next round verification (round=30)
[S2] DEBUG after merge:  round=30 metric=0.6667 head_norm=1.345706 delta_norm=0.320293
[S2] aggregate: ROLLBACK (f1_val pre=0.673 post=0.667 tol_abs=0.005 tol_rel=0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=30 metric=0.9952 head_norm=2.098655
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.884846e-02
[S10] stored merged vector for next round verification (round=30)
[S10] DEBUG after merge:  round=30 metric=0.9952 head_norm=2.109719 delta_norm=0.038848
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.160 → S15@127.0.0.1:52815
[S7] ⇄ pheromone p=0.375 → S16@127.0.0.1:52816
[S11] ⇄ pheromone p=0.292 → S3@127.0.0.1:52803
[S8] ⇄ pheromone p=0.016 → S2@127.0.0.1:52802
[S14] ⇄ pheromone p=0.019 → S10@127.0.0.1:52811
[S15] ⇄ pheromone p=0.316 → S9@127.0.0.1:52810
[S16] ⇄ pheromone p=0.077 → S7@127.0.0.1:52808
[S13] ⇄ pheromone p=0.185 → S17@127.0.0.1:52817
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=30 metric=0.5436 head_norm=1.233779
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.051199e-01
[S17] stored merged vector for next round verification (round=30)
[S17] DEBUG after merge:  round=30 metric=0.5428 head_norm=1.213366 delta_norm=0.105120
[S17] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.124 → S6@127.0.0.1:52807
[S2] START round=31 head_norm_before_train=1.345706 cos_to_last_merge=1.0000 (last merge round=30)
[S2] round=31 local utility u=0.000000 metrics={'f1_val': 0.5930707313532101, 'auprc': 0.7421374725530496, 'loss_val': 0.9896422547527849, 'psi': 0.6526974278331459}-{'f1_val': 0.6726690857895083, 'auprc': 0.7607483532779351, 'loss_val': 0.6417420982933741, 'psi': 0.707900792784879}
[S3] START round=31 head_norm_before_train=1.507535 cos_to_last_merge=1.0000 (last merge round=30)
[S3] round=31 local utility u=0.000000 metrics={'f1_val': 0.7289838833845854, 'auprc': 0.9457301745603932, 'loss_val': 0.40452928272520733, 'psi': 0.8156823998549085}-{'f1_val': 0.9979722591986233, 'auprc': 0.9995671256631673, 'loss_val': 0.0833225658751855, 'psi': 0.9986102057844408}
[S4] START round=31 head_norm_before_train=2.021932 (no previous merge yet)
[S4] round=31 local utility u=0.000000 metrics={'f1_val': 0.9416091780922813, 'auprc': 0.928037617552237, 'loss_val': 0.30318841030408605, 'psi': 0.9361805538762635}-{'f1_val': 0.9476704692576886, 'auprc': 0.9419511994884178, 'loss_val': 0.2963334572265438, 'psi': 0.9453827613499802}
[S5] START round=31 head_norm_before_train=1.605824 cos_to_last_merge=0.7846 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.785
[S5] round=31 local utility u=0.015565 metrics={'f1_val': 0.7082570636824075, 'auprc': 0.9934958188325336, 'loss_val': 0.19588527999189542, 'psi': 0.822352565742458}-{'f1_val': 0.7006083926626743, 'auprc': 0.9976847030504435, 'loss_val': 0.19369040605711155, 'psi': 0.819438916817782}
[S6] START round=31 head_norm_before_train=1.373258 cos_to_last_merge=0.9874 (last merge round=27)
[S6] round=31 local utility u=1.000000 metrics={'f1_val': 0.8448254605120479, 'auprc': 0.965167937597056, 'loss_val': 0.28983994392856405, 'psi': 0.8929624513460512}-{'f1_val': 0.5879195375131474, 'auprc': 0.6605735412336853, 'loss_val': 1.0080463792428247, 'psi': 0.6169811390013626}
[S7] START round=31 head_norm_before_train=1.374512 cos_to_last_merge=0.9978 (last merge round=25)
[S7] round=31 local utility u=0.299363 metrics={'f1_val': 0.5415771968772825, 'auprc': 0.7766616711210398, 'loss_val': 0.800379490006248, 'psi': 0.6356109865747854}-{'f1_val': 0.467493415778137, 'auprc': 0.7732684670077192, 'loss_val': 0.9444232628448578, 'psi': 0.58980343626997}
[S8] START round=31 head_norm_before_train=1.416860 cos_to_last_merge=0.9997 (last merge round=29)
[S8] round=31 local utility u=0.000000 metrics={'f1_val': 0.9927378939946618, 'auprc': 0.9978758660498499, 'loss_val': 0.050274626756181995, 'psi': 0.9947930828167371}-{'f1_val': 0.9949323051384696, 'auprc': 0.9969731211926641, 'loss_val': 0.05141791066333603, 'psi': 0.9957486315601474}
[S9] START round=31 head_norm_before_train=1.434225 cos_to_last_merge=0.9954 (last merge round=26)
[S9] round=31 local utility u=0.000000 metrics={'f1_val': 0.9776526249057064, 'auprc': 0.9979880314664963, 'loss_val': 0.11305490000315234, 'psi': 0.9857867875300224}-{'f1_val': 0.9966924912647621, 'auprc': 0.992512982040851, 'loss_val': 0.0750922572875195, 'psi': 0.9950206875751977}
[S10] START round=31 head_norm_before_train=2.109719 cos_to_last_merge=1.0000 (last merge round=30)
[S10] round=31 local utility u=0.000183 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9959889617343624, 'loss_val': 0.024413318303480806, 'psi': 0.9955082881053698}-{'f1_val': 0.9951878390193748, 'auprc': 0.9959553875006296, 'loss_val': 0.02467938254840639, 'psi': 0.9954948584118767}
[S11] START round=31 head_norm_before_train=1.427722 cos_to_last_merge=0.9947 (last merge round=26)
[S11] round=31 local utility u=0.138021 metrics={'f1_val': 0.9971362493929642, 'auprc': 0.9978175272703242, 'loss_val': 0.13348290947273142, 'psi': 0.9974087605439083}-{'f1_val': 0.9585259374703, 'auprc': 0.9948307786038078, 'loss_val': 0.16890321105091122, 'psi': 0.9730478739237032}
[S13] START round=31 head_norm_before_train=1.201833 cos_to_last_merge=0.9913 (last merge round=26)
[S13] round=31 local utility u=0.000000 metrics={'f1_val': 0.6675761483947346, 'auprc': 0.7528010298382006, 'loss_val': 0.6845555375616326, 'psi': 0.701666100972121}-{'f1_val': 0.7409939255528416, 'auprc': 0.8160262140952903, 'loss_val': 0.6385416055488896, 'psi': 0.7710068409698211}
[S14] START round=31 head_norm_before_train=2.121436 cos_to_last_merge=0.9990 (last merge round=26)
[S14] round=31 local utility u=0.002901 metrics={'f1_val': 0.9970233560109115, 'auprc': 0.9996006913764844, 'loss_val': 0.03012844632728056, 'psi': 0.9980542901571408}-{'f1_val': 0.9974306056599991, 'auprc': 0.997908726325779, 'loss_val': 0.03329726404711731, 'psi': 0.9976218539263111}
[S15] START round=31 head_norm_before_train=1.465112 cos_to_last_merge=0.9998 (last merge round=29)
[S15] round=31 local utility u=0.464629 metrics={'f1_val': 0.8983171997392237, 'auprc': 0.9918335106942875, 'loss_val': 0.2284997780363086, 'psi': 0.9357237241212493}-{'f1_val': 0.803548141573443, 'auprc': 0.9189089144647624, 'loss_val': 0.3703697161890928, 'psi': 0.8496924507299708}
[S16] START round=31 head_norm_before_train=1.463917 cos_to_last_merge=0.9998 (last merge round=29)
[S16] round=31 local utility u=0.000000 metrics={'f1_val': 0.9248773274372327, 'auprc': 0.9898108549650642, 'loss_val': 0.29413154398464314, 'psi': 0.9508507384483653}-{'f1_val': 0.9106413655067216, 'auprc': 0.9937016823830901, 'loss_val': 0.21730984321106528, 'psi': 0.943865492257269}
[S17] START round=31 head_norm_before_train=1.213366 cos_to_last_merge=1.0000 (last merge round=30)
[S17] round=31 local utility u=0.464936 metrics={'f1_val': 0.6095925691635877, 'auprc': 0.8591441969451361, 'loss_val': 0.7719149987123888, 'psi': 0.7094132202762071}-{'f1_val': 0.5435850267013307, 'auprc': 0.7283052079804649, 'loss_val': 0.913225674725923, 'psi': 0.6174730992129844}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:52810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S11] → sending delta(kind=head bytes=1807) to S3@127.0.0.1:52803
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:52814
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:52811
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S7] → sending delta(kind=head bytes=1793) to S13@127.0.0.1:52813
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1807 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1793 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1799) from S14
[S10] cosine check vs S14: cos=0.9996
[S3] RECEIVED delta(kind=head bytes=1807) from S11
[S3] cosine check vs S11: cos=0.9772
[S14] RECEIVED delta(kind=head bytes=1803) from S10
[S14] cosine check vs S10: cos=0.9996
[S9] RECEIVED delta(kind=head bytes=1801) from S15
[S9] cosine check vs S15: cos=0.9940
[S17] RECEIVED delta(kind=head bytes=1799) from S6
[S17] cosine check vs S6: cos=0.6797
[S13] RECEIVED delta(kind=head bytes=1793) from S7
[S13] cosine check vs S7: cos=0.6336
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:52807
[S17] sending update (kind=head size=1796 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1796) from S17
[S6] cosine check vs S17: cos=0.6797
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=31 metric=0.7290 head_norm=1.529440
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.639844e-01
[S3] stored merged vector for next round verification (round=31)
[S3] DEBUG after merge:  round=31 metric=0.7390 head_norm=1.480195 delta_norm=0.163984
[S3] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=31 metric=0.9777 head_norm=1.457432
[S9] _apply_head_vector_avg (torch): Δ‖w‖=8.337750e-02
[S9] stored merged vector for next round verification (round=31)
[S9] DEBUG after merge:  round=31 metric=0.9785 head_norm=1.474325 delta_norm=0.083377
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=31 metric=0.6676 head_norm=1.217844
[S13] _apply_head_vector_avg (torch): Δ‖w‖=5.628936e-01
[S13] stored merged vector for next round verification (round=31)
[S13] DEBUG after merge:  round=31 metric=0.6622 head_norm=1.177975 delta_norm=0.562894
[S13] aggregate: ROLLBACK (f1_val pre=0.668 post=0.662 tol_abs=0.005 tol_rel=0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=31 metric=0.9952 head_norm=2.114092
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.076038e-02
[S10] stored merged vector for next round verification (round=31)
[S10] DEBUG after merge:  round=31 metric=0.9952 head_norm=2.124174 delta_norm=0.030760
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=31 metric=0.8448 head_norm=1.425052
[S6] _apply_head_vector_avg (torch): Δ‖w‖=5.430374e-01
[S6] stored merged vector for next round verification (round=31)
[S6] DEBUG after merge:  round=31 metric=0.8448 head_norm=1.232349 delta_norm=0.543037
[S6] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=31 metric=0.9970 head_norm=2.134651
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.076037e-02
[S14] stored merged vector for next round verification (round=31)
[S14] DEBUG after merge:  round=31 metric=0.9970 head_norm=2.124174 delta_norm=0.030760
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=31 metric=0.6096 head_norm=1.263478
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.430374e-01
[S17] stored merged vector for next round verification (round=31)
[S17] DEBUG after merge:  round=31 metric=0.6085 head_norm=1.232349 delta_norm=0.543037
[S17] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=32 head_norm_before_train=1.452695 cos_to_last_merge=0.9924 (last merge round=30)
[S2] round=32 local utility u=0.652111 metrics={'f1_val': 0.7087929710861129, 'auprc': 0.7995179113269625, 'loss_val': 0.5518957625446562, 'psi': 0.7450829471824527}-{'f1_val': 0.5930707313532101, 'auprc': 0.7421374725530496, 'loss_val': 0.9896422547527849, 'psi': 0.6526974278331459}
[S3] START round=32 head_norm_before_train=1.480195 cos_to_last_merge=1.0000 (last merge round=31)
[S3] round=32 local utility u=0.986650 metrics={'f1_val': 0.983037983226718, 'auprc': 0.9994892302752395, 'loss_val': 0.1168319814437585, 'psi': 0.9896184820461266}-{'f1_val': 0.7289838833845854, 'auprc': 0.9457301745603932, 'loss_val': 0.40452928272520733, 'psi': 0.8156823998549085}
[S4] START round=32 head_norm_before_train=2.022486 (no previous merge yet)
[S4] round=32 local utility u=0.007888 metrics={'f1_val': 0.9418386473354986, 'auprc': 0.9309237156809522, 'loss_val': 0.29744737624805734, 'psi': 0.9374726746736801}-{'f1_val': 0.9416091780922813, 'auprc': 0.928037617552237, 'loss_val': 0.30318841030408605, 'psi': 0.9361805538762635}
[S5] START round=32 head_norm_before_train=1.616471 cos_to_last_merge=0.7836 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.784
[S5] round=32 local utility u=0.001127 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9976769739838671, 'loss_val': 0.16028224522314333, 'psi': 0.8194358251911514}-{'f1_val': 0.7082570636824075, 'auprc': 0.9934958188325336, 'loss_val': 0.19588527999189542, 'psi': 0.822352565742458}
[S6] START round=32 head_norm_before_train=1.232349 cos_to_last_merge=1.0000 (last merge round=31)
[S6] round=32 local utility u=0.000000 metrics={'f1_val': 0.8113854877030707, 'auprc': 0.9400154006625085, 'loss_val': 0.45430259422865704, 'psi': 0.8628374528868459}-{'f1_val': 0.8448254605120479, 'auprc': 0.965167937597056, 'loss_val': 0.28983994392856405, 'psi': 0.8929624513460512}
[S7] START round=32 head_norm_before_train=1.387733 cos_to_last_merge=0.9968 (last merge round=25)
[S7] round=32 local utility u=0.000000 metrics={'f1_val': 0.43982541112285267, 'auprc': 0.7746987921398374, 'loss_val': 0.9671045857421809, 'psi': 0.5737747635296466}-{'f1_val': 0.5415771968772825, 'auprc': 0.7766616711210398, 'loss_val': 0.800379490006248, 'psi': 0.6356109865747854}
[S8] START round=32 head_norm_before_train=1.446883 cos_to_last_merge=0.9991 (last merge round=29)
[S8] round=32 local utility u=0.000000 metrics={'f1_val': 0.9923740886046254, 'auprc': 0.9976808746522791, 'loss_val': 0.04932119417527479, 'psi': 0.9944968030236869}-{'f1_val': 0.9927378939946618, 'auprc': 0.9978758660498499, 'loss_val': 0.050274626756181995, 'psi': 0.9947930828167371}
[S9] START round=32 head_norm_before_train=1.474325 cos_to_last_merge=1.0000 (last merge round=31)
[S9] round=32 local utility u=0.071171 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9926323439452712, 'loss_val': 0.06623086179548085, 'psi': 0.9948029944456751}-{'f1_val': 0.9776526249057064, 'auprc': 0.9979880314664963, 'loss_val': 0.11305490000315234, 'psi': 0.9857867875300224}
[S10] START round=32 head_norm_before_train=2.124174 cos_to_last_merge=1.0000 (last merge round=31)
[S10] round=32 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9959609182433284, 'loss_val': 0.02438259810174458, 'psi': 0.9954970707089562}-{'f1_val': 0.9951878390193748, 'auprc': 0.9959889617343624, 'loss_val': 0.024413318303480806, 'psi': 0.9955082881053698}
[S11] START round=32 head_norm_before_train=1.447947 cos_to_last_merge=0.9922 (last merge round=26)
[S11] round=32 local utility u=0.009522 metrics={'f1_val': 0.9973780864376928, 'auprc': 0.9986295421128791, 'loss_val': 0.11832659109909484, 'psi': 0.9978786687077674}-{'f1_val': 0.9971362493929642, 'auprc': 0.9978175272703242, 'loss_val': 0.13348290947273142, 'psi': 0.9974087605439083}
[S13] START round=32 head_norm_before_train=1.177975 cos_to_last_merge=1.0000 (last merge round=31)
[S13] round=32 local utility u=0.065654 metrics={'f1_val': 0.6835896380278357, 'auprc': 0.7518167075572944, 'loss_val': 0.6463746211292143, 'psi': 0.7108804658396192}-{'f1_val': 0.6675761483947346, 'auprc': 0.7528010298382006, 'loss_val': 0.6845555375616326, 'psi': 0.701666100972121}
[S14] START round=32 head_norm_before_train=2.124174 cos_to_last_merge=1.0000 (last merge round=31)
[S14] round=32 local utility u=0.000000 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9974464424123276, 'loss_val': 0.03476344892327028, 'psi': 0.9973227909884068}-{'f1_val': 0.9970233560109115, 'auprc': 0.9996006913764844, 'loss_val': 0.03012844632728056, 'psi': 0.9980542901571408}
[S15] START round=32 head_norm_before_train=1.495683 cos_to_last_merge=0.9992 (last merge round=29)
[S15] round=32 local utility u=0.021501 metrics={'f1_val': 0.9021914046774486, 'auprc': 0.9928540616235011, 'loss_val': 0.21180460455041203, 'psi': 0.9384564674558695}-{'f1_val': 0.8983171997392237, 'auprc': 0.9918335106942875, 'loss_val': 0.2284997780363086, 'psi': 0.9357237241212493}
[S16] START round=32 head_norm_before_train=1.489655 cos_to_last_merge=0.9994 (last merge round=29)
[S16] round=32 local utility u=0.136290 metrics={'f1_val': 0.942325501358275, 'auprc': 0.9984674355053339, 'loss_val': 0.1522095775748408, 'psi': 0.9647822750170985}-{'f1_val': 0.9248773274372327, 'auprc': 0.9898108549650642, 'loss_val': 0.29413154398464314, 'psi': 0.9508507384483653}
[S17] START round=32 head_norm_before_train=1.232349 cos_to_last_merge=1.0000 (last merge round=31)
[S17] round=32 local utility u=0.000000 metrics={'f1_val': 0.6007765007809941, 'auprc': 0.791350770943757, 'loss_val': 0.8176438084773368, 'psi': 0.6770062088460993}-{'f1_val': 0.6095925691635877, 'auprc': 0.8591441969451361, 'loss_val': 0.7719149987123888, 'psi': 0.7094132202762071}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:52812
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:52808
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1799 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:52810
[S2] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:52815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:52803
[S11] RECEIVED delta(kind=head bytes=1799) from S3
[S11] cosine check vs S3: cos=0.9915
[S8] RECEIVED delta(kind=head bytes=1803) from S2
[S8] cosine check vs S2: cos=0.9157
[S15] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1796) from S13
[S17] cosine check vs S13: cos=0.7945
[S9] RECEIVED delta(kind=head bytes=1803) from S15
[S9] cosine check vs S15: cos=0.9972
[S15] RECEIVED delta(kind=head bytes=1795) from S9
[S15] cosine check vs S9: cos=0.9972
[S3] RECEIVED delta(kind=head bytes=1803) from S11
[S3] cosine check vs S11: cos=0.9915
[S7] RECEIVED delta(kind=head bytes=1796) from S16
[S7] cosine check vs S16: cos=0.9905
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=32 metric=0.9830 head_norm=1.501789
[S3] _apply_head_vector_avg (torch): Δ‖w‖=9.789563e-02
[S3] stored merged vector for next round verification (round=32)
[S3] DEBUG after merge:  round=32 metric=0.9822 head_norm=1.483277 delta_norm=0.097896
[S3] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=32 metric=0.9924 head_norm=1.470074
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.139079e-01
[S8] stored merged vector for next round verification (round=32)
[S8] DEBUG after merge:  round=32 metric=0.9913 head_norm=1.482137 delta_norm=0.313908
[S8] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=32 metric=0.4398 head_norm=1.400571
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.151566e-01
[S7] stored merged vector for next round verification (round=32)
[S7] DEBUG after merge:  round=32 metric=0.4372 head_norm=1.453797 delta_norm=0.115157
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=32 metric=0.9963 head_norm=1.493051
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.847562e-02
[S9] stored merged vector for next round verification (round=32)
[S9] DEBUG after merge:  round=32 metric=0.9963 head_norm=1.508373 delta_norm=0.058476
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=32 metric=0.9022 head_norm=1.525783
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.847562e-02
[S15] stored merged vector for next round verification (round=32)
[S15] DEBUG after merge:  round=32 metric=0.9022 head_norm=1.508373 delta_norm=0.058476
[S15] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=32 metric=0.9974 head_norm=1.471061
[S11] _apply_head_vector_avg (torch): Δ‖w‖=9.789564e-02
[S11] stored merged vector for next round verification (round=32)
[S11] DEBUG after merge:  round=32 metric=0.9974 head_norm=1.483277 delta_norm=0.097896
[S11] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=32 metric=0.6008 head_norm=1.278190
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.989050e-01
[S17] stored merged vector for next round verification (round=32)
[S17] DEBUG after merge:  round=32 metric=0.6042 head_norm=1.173900 delta_norm=0.398905
[S17] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=33 head_norm_before_train=1.558660 cos_to_last_merge=0.9788 (last merge round=30)
[S2] round=33 local utility u=0.000000 metrics={'f1_val': 0.7120267778775833, 'auprc': 0.7892799180375374, 'loss_val': 0.5888451584312147, 'psi': 0.7429280339415649}-{'f1_val': 0.7087929710861129, 'auprc': 0.7995179113269625, 'loss_val': 0.5518957625446562, 'psi': 0.7450829471824527}
[S3] START round=33 head_norm_before_train=1.483277 cos_to_last_merge=1.0000 (last merge round=32)
[S3] round=33 local utility u=0.054805 metrics={'f1_val': 0.9990790987190017, 'auprc': 0.999471808392302, 'loss_val': 0.10341605937111045, 'psi': 0.9992361825883218}-{'f1_val': 0.983037983226718, 'auprc': 0.9994892302752395, 'loss_val': 0.1168319814437585, 'psi': 0.9896184820461266}
[S4] START round=33 head_norm_before_train=2.023457 (no previous merge yet)
[S4] round=33 local utility u=0.001800 metrics={'f1_val': 0.9409302175154579, 'auprc': 0.9359140068600472, 'loss_val': 0.3033675276559334, 'psi': 0.9389237332532936}-{'f1_val': 0.9418386473354986, 'auprc': 0.9309237156809522, 'loss_val': 0.29744737624805734, 'psi': 0.9374726746736801}
[S5] START round=33 head_norm_before_train=1.629658 cos_to_last_merge=0.7827 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.783
[S5] round=33 local utility u=0.885095 metrics={'f1_val': 0.9964794802860635, 'auprc': 0.9934139181617098, 'loss_val': 0.15253003135343232, 'psi': 0.995253255436322}-{'f1_val': 0.7006083926626743, 'auprc': 0.9976769739838671, 'loss_val': 0.16028224522314333, 'psi': 0.8194358251911514}
[S6] START round=33 head_norm_before_train=1.288096 cos_to_last_merge=0.9990 (last merge round=31)
[S6] round=33 local utility u=0.165079 metrics={'f1_val': 0.846918531573182, 'auprc': 0.95250914260589, 'loss_val': 0.3748243431251903, 'psi': 0.8891547759862652}-{'f1_val': 0.8113854877030707, 'auprc': 0.9400154006625085, 'loss_val': 0.45430259422865704, 'psi': 0.8628374528868459}
[S7] START round=33 head_norm_before_train=1.453797 cos_to_last_merge=1.0000 (last merge round=32)
[S7] round=33 local utility u=0.461850 metrics={'f1_val': 0.5607276300849968, 'auprc': 0.7789269146426019, 'loss_val': 0.78150127331889, 'psi': 0.6480073439080389}-{'f1_val': 0.43982541112285267, 'auprc': 0.7746987921398374, 'loss_val': 0.9671045857421809, 'psi': 0.5737747635296466}
[S8] START round=33 head_norm_before_train=1.482137 cos_to_last_merge=1.0000 (last merge round=32)
[S8] round=33 local utility u=0.013157 metrics={'f1_val': 0.9961029169686172, 'auprc': 0.9959998168431923, 'loss_val': 0.040336148320116325, 'psi': 0.9960616769184472}-{'f1_val': 0.9923740886046254, 'auprc': 0.9976808746522791, 'loss_val': 0.04932119417527479, 'psi': 0.9944968030236869}
[S9] START round=33 head_norm_before_train=1.508373 cos_to_last_merge=1.0000 (last merge round=32)
[S9] round=33 local utility u=0.009722 metrics={'f1_val': 0.9958601375429889, 'auprc': 0.9986501028995527, 'loss_val': 0.06250091802359584, 'psi': 0.9969761236856143}-{'f1_val': 0.9962500947792776, 'auprc': 0.9926323439452712, 'loss_val': 0.06623086179548085, 'psi': 0.9948029944456751}
[S10] START round=33 head_norm_before_train=2.131683 cos_to_last_merge=1.0000 (last merge round=31)
[S10] round=33 local utility u=0.000108 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9959694389138366, 'loss_val': 0.024192345095580974, 'psi': 0.9955004789771595}-{'f1_val': 0.9951878390193748, 'auprc': 0.9959609182433284, 'loss_val': 0.02438259810174458, 'psi': 0.9954970707089562}
[S11] START round=33 head_norm_before_train=1.483277 cos_to_last_merge=1.0000 (last merge round=32)
[S11] round=33 local utility u=0.005567 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9964172900067413, 'loss_val': 0.09807373118791517, 'psi': 0.9967454699784428}-{'f1_val': 0.9973780864376928, 'auprc': 0.9986295421128791, 'loss_val': 0.11832659109909484, 'psi': 0.9978786687077674}
[S13] START round=33 head_norm_before_train=1.200234 cos_to_last_merge=0.9997 (last merge round=31)
[S13] round=33 local utility u=0.000000 metrics={'f1_val': 0.7269619497905873, 'auprc': 0.6751121308943866, 'loss_val': 0.8598518614159846, 'psi': 0.706222022232107}-{'f1_val': 0.6835896380278357, 'auprc': 0.7518167075572944, 'loss_val': 0.6463746211292143, 'psi': 0.7108804658396192}
[S14] START round=33 head_norm_before_train=2.136904 cos_to_last_merge=1.0000 (last merge round=31)
[S14] round=33 local utility u=0.004576 metrics={'f1_val': 0.9970229111636145, 'auprc': 0.9995736033028407, 'loss_val': 0.03068775629100559, 'psi': 0.998043188019305}-{'f1_val': 0.997240356705793, 'auprc': 0.9974464424123276, 'loss_val': 0.03476344892327028, 'psi': 0.9973227909884068}
[S15] START round=33 head_norm_before_train=1.508373 cos_to_last_merge=1.0000 (last merge round=32)
[S15] round=33 local utility u=0.061521 metrics={'f1_val': 0.9159623904920733, 'auprc': 0.9908366605356773, 'loss_val': 0.1653355551752922, 'psi': 0.9459120985095149}-{'f1_val': 0.9021914046774486, 'auprc': 0.9928540616235011, 'loss_val': 0.21180460455041203, 'psi': 0.9384564674558695}
[S16] START round=33 head_norm_before_train=1.513926 cos_to_last_merge=0.9984 (last merge round=29)
[S16] round=33 local utility u=0.000000 metrics={'f1_val': 0.9378952663208698, 'auprc': 0.9967757971737258, 'loss_val': 0.2223116337885228, 'psi': 0.9614474786620122}-{'f1_val': 0.942325501358275, 'auprc': 0.9984674355053339, 'loss_val': 0.1522095775748408, 'psi': 0.9647822750170985}
[S17] START round=33 head_norm_before_train=1.173900 cos_to_last_merge=1.0000 (last merge round=32)
[S17] round=33 local utility u=0.000000 metrics={'f1_val': 0.5817978636360369, 'auprc': 0.7785315082736446, 'loss_val': 0.8760145290399389, 'psi': 0.6604913214910799}-{'f1_val': 0.6007765007809941, 'auprc': 0.791350770943757, 'loss_val': 0.8176438084773368, 'psi': 0.6770062088460993}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:52812
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:52802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:52811
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:52810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:52814
[S3] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:52803
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S13@127.0.0.1:52813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:52815
[S11] RECEIVED delta(kind=head bytes=1802) from S3
[S11] cosine check vs S3: cos=0.9993
[S9] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1804 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1803) from S9
[S15] cosine check vs S9: cos=0.9998
[S9] RECEIVED delta(kind=head bytes=1800) from S15
[S9] cosine check vs S15: cos=0.9998
[S3] RECEIVED delta(kind=head bytes=1803) from S11
[S3] cosine check vs S11: cos=0.9993
[S10] RECEIVED delta(kind=head bytes=1801) from S14
[S10] cosine check vs S14: cos=0.9999
[S2] RECEIVED delta(kind=head bytes=1795) from S8
[S2] cosine check vs S8: cos=0.9677
[S13] RECEIVED delta(kind=head bytes=1804) from S7
[S13] cosine check vs S7: cos=0.8830
[S17] RECEIVED delta(kind=head bytes=1799) from S6
[S17] cosine check vs S6: cos=0.9191
[S14] RECEIVED delta(kind=head bytes=1800) from S10
[S14] cosine check vs S10: cos=0.9999
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=33 metric=0.7120 head_norm=1.651284
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.137362e-01
[S2] stored merged vector for next round verification (round=33)
[S2] DEBUG after merge:  round=33 metric=0.7090 head_norm=1.563539 delta_norm=0.213736
[S2] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=33 metric=0.9991 head_norm=1.513572
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.926537e-02
[S3] stored merged vector for next round verification (round=33)
[S3] DEBUG after merge:  round=33 metric=0.9991 head_norm=1.511223 delta_norm=0.029265
[S3] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=33 metric=0.7270 head_norm=1.229915
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.452807e-01
[S13] stored merged vector for next round verification (round=33)
[S13] DEBUG after merge:  round=33 metric=0.6871 head_norm=1.307646 delta_norm=0.345281
[S13] aggregate: ROLLBACK (f1_val pre=0.727 post=0.687 tol_abs=0.005 tol_rel=0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=33 metric=0.9952 head_norm=2.140594
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.497228e-02
[S10] stored merged vector for next round verification (round=33)
[S10] DEBUG after merge:  round=33 metric=0.9952 head_norm=2.143894 delta_norm=0.014972
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=33 metric=0.9160 head_norm=1.536367
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.696059e-02
[S15] stored merged vector for next round verification (round=33)
[S15] DEBUG after merge:  round=33 metric=0.9154 head_norm=1.530840 delta_norm=0.016961
[S15] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=33 metric=0.9970 head_norm=2.147294
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.497229e-02
[S14] stored merged vector for next round verification (round=33)
[S14] DEBUG after merge:  round=33 metric=0.9970 head_norm=2.143894 delta_norm=0.014972
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=33 metric=0.9959 head_norm=1.525482
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.696060e-02
[S9] stored merged vector for next round verification (round=33)
[S9] DEBUG after merge:  round=33 metric=0.9959 head_norm=1.530840 delta_norm=0.016961
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=33 metric=0.9970 head_norm=1.509437
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.926536e-02
[S11] stored merged vector for next round verification (round=33)
[S11] DEBUG after merge:  round=33 metric=0.9970 head_norm=1.511223 delta_norm=0.029265
[S11] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=33 metric=0.5818 head_norm=1.232094
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.681615e-01
[S17] stored merged vector for next round verification (round=33)
[S17] DEBUG after merge:  round=33 metric=0.5821 head_norm=1.269653 delta_norm=0.268162
[S17] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=34 head_norm_before_train=1.563539 cos_to_last_merge=1.0000 (last merge round=33)
[S2] round=34 local utility u=0.000000 metrics={'f1_val': 0.7033788791233408, 'auprc': 0.7940420110666476, 'loss_val': 0.5823655442984786, 'psi': 0.7396441319006636}-{'f1_val': 0.7120267778775833, 'auprc': 0.7892799180375374, 'loss_val': 0.5888451584312147, 'psi': 0.7429280339415649}
[S3] START round=34 head_norm_before_train=1.511223 cos_to_last_merge=1.0000 (last merge round=33)
[S3] round=34 local utility u=0.000000 metrics={'f1_val': 0.8176554907980609, 'auprc': 0.9572222044990689, 'loss_val': 0.304196314682963, 'psi': 0.8734821762784641}-{'f1_val': 0.9990790987190017, 'auprc': 0.999471808392302, 'loss_val': 0.10341605937111045, 'psi': 0.9992361825883218}
[S4] START round=34 head_norm_before_train=2.039323 (no previous merge yet)
[S4] round=34 local utility u=0.000000 metrics={'f1_val': 0.9414877212668946, 'auprc': 0.9310207050643908, 'loss_val': 0.3065440671590819, 'psi': 0.9373009147858932}-{'f1_val': 0.9409302175154579, 'auprc': 0.9359140068600472, 'loss_val': 0.3033675276559334, 'psi': 0.9389237332532936}
[S5] START round=34 head_norm_before_train=1.640934 cos_to_last_merge=0.7820 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.782
[S5] round=34 local utility u=0.012639 metrics={'f1_val': 0.9964794802860635, 'auprc': 0.9948558972739332, 'loss_val': 0.13157861043968697, 'psi': 0.9958300470812114}-{'f1_val': 0.9964794802860635, 'auprc': 0.9934139181617098, 'loss_val': 0.15253003135343232, 'psi': 0.995253255436322}
[S6] START round=34 head_norm_before_train=1.360075 cos_to_last_merge=0.9954 (last merge round=31)
[S6] round=34 local utility u=0.000000 metrics={'f1_val': 0.7350209175055016, 'auprc': 0.9137187573034564, 'loss_val': 0.610927988862132, 'psi': 0.8065000534246836}-{'f1_val': 0.846918531573182, 'auprc': 0.95250914260589, 'loss_val': 0.3748243431251903, 'psi': 0.8891547759862652}
[S7] START round=34 head_norm_before_train=1.464794 cos_to_last_merge=1.0000 (last merge round=32)
[S7] round=34 local utility u=0.146515 metrics={'f1_val': 0.597983671442473, 'auprc': 0.7790441831120296, 'loss_val': 0.712360301641975, 'psi': 0.6704078761102956}-{'f1_val': 0.5607276300849968, 'auprc': 0.7789269146426019, 'loss_val': 0.78150127331889, 'psi': 0.6480073439080389}
[S8] START round=34 head_norm_before_train=1.501310 cos_to_last_merge=0.9999 (last merge round=32)
[S8] round=34 local utility u=0.000000 metrics={'f1_val': 0.9884940992024185, 'auprc': 0.9984065378993138, 'loss_val': 0.05133316429963247, 'psi': 0.9924590746811766}-{'f1_val': 0.9961029169686172, 'auprc': 0.9959998168431923, 'loss_val': 0.040336148320116325, 'psi': 0.9960616769184472}
[S9] START round=34 head_norm_before_train=1.530840 cos_to_last_merge=1.0000 (last merge round=33)
[S9] round=34 local utility u=0.000000 metrics={'f1_val': 0.9899766087340214, 'auprc': 0.998652354161302, 'loss_val': 0.07061440830463622, 'psi': 0.9934469069049336}-{'f1_val': 0.9958601375429889, 'auprc': 0.9986501028995527, 'loss_val': 0.06250091802359584, 'psi': 0.9969761236856143}
[S10] START round=34 head_norm_before_train=2.143894 cos_to_last_merge=1.0000 (last merge round=33)
[S10] round=34 local utility u=0.000052 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.996008011430981, 'loss_val': 0.02420473113940085, 'psi': 0.9955159079840172}-{'f1_val': 0.9951878390193748, 'auprc': 0.9959694389138366, 'loss_val': 0.024192345095580974, 'psi': 0.9955004789771595}
[S11] START round=34 head_norm_before_train=1.511223 cos_to_last_merge=1.0000 (last merge round=33)
[S11] round=34 local utility u=0.010318 metrics={'f1_val': 0.9973780864376928, 'auprc': 0.9986408132759078, 'loss_val': 0.08659173832918524, 'psi': 0.9978831771729788}-{'f1_val': 0.9969642566262439, 'auprc': 0.9964172900067413, 'loss_val': 0.09807373118791517, 'psi': 0.9967454699784428}
[S13] START round=34 head_norm_before_train=1.307646 cos_to_last_merge=1.0000 (last merge round=33)
[S13] round=34 local utility u=0.149436 metrics={'f1_val': 0.7405416714860619, 'auprc': 0.7027763246968224, 'loss_val': 0.7254509207904236, 'psi': 0.7254355327703661}-{'f1_val': 0.7269619497905873, 'auprc': 0.6751121308943866, 'loss_val': 0.8598518614159846, 'psi': 0.706222022232107}
[S14] START round=34 head_norm_before_train=2.143894 cos_to_last_merge=1.0000 (last merge round=33)
[S14] round=34 local utility u=0.000000 metrics={'f1_val': 0.9968028443251822, 'auprc': 0.9995994742668811, 'loss_val': 0.03060251946193533, 'psi': 0.9979214963018618}-{'f1_val': 0.9970229111636145, 'auprc': 0.9995736033028407, 'loss_val': 0.03068775629100559, 'psi': 0.998043188019305}
[S15] START round=34 head_norm_before_train=1.530840 cos_to_last_merge=1.0000 (last merge round=33)
[S15] round=34 local utility u=0.102107 metrics={'f1_val': 0.9398462864778534, 'auprc': 0.9933639682268376, 'loss_val': 0.11200690302084407, 'psi': 0.961253359177447}-{'f1_val': 0.9159623904920733, 'auprc': 0.9908366605356773, 'loss_val': 0.1653355551752922, 'psi': 0.9459120985095149}
[S16] START round=34 head_norm_before_train=1.540592 cos_to_last_merge=0.9973 (last merge round=29)
[S16] round=34 local utility u=0.015308 metrics={'f1_val': 0.9418609784996922, 'auprc': 0.9919779216413916, 'loss_val': 0.20109716164711736, 'psi': 0.961907755756372}-{'f1_val': 0.9378952663208698, 'auprc': 0.9967757971737258, 'loss_val': 0.2223116337885228, 'psi': 0.9614474786620122}
[S17] START round=34 head_norm_before_train=1.269653 cos_to_last_merge=1.0000 (last merge round=33)
[S17] round=34 local utility u=0.411861 metrics={'f1_val': 0.6162660336186117, 'auprc': 0.9582700317041603, 'loss_val': 0.798316883856792, 'psi': 0.7530676328528312}-{'f1_val': 0.5817978636360369, 'auprc': 0.7785315082736446, 'loss_val': 0.8760145290399389, 'psi': 0.6604913214910799}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:52817
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:52810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:52808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:52803
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:52813
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S10] → sending delta(kind=head bytes=1806) to S14@127.0.0.1:52814
[S10] sending update (kind=head size=1806 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1798) from S13
[S17] cosine check vs S13: cos=0.7529
[S13] RECEIVED delta(kind=head bytes=1803) from S7
[S13] cosine check vs S7: cos=0.9676
[S14] RECEIVED delta(kind=head bytes=1806) from S10
[S14] cosine check vs S10: cos=0.9999
[S9] RECEIVED delta(kind=head bytes=1801) from S15
[S9] cosine check vs S15: cos=0.9998
[S7] RECEIVED delta(kind=head bytes=1800) from S16
[S7] cosine check vs S16: cos=0.9950
[S3] RECEIVED delta(kind=head bytes=1803) from S11
[S3] cosine check vs S11: cos=0.9993
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S8
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S14
[S7]  timeout peer S15
[S7]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S4
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S16
[S9]  timeout peer S17
[S8]  timeout peer S3
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S13
[S8]  timeout peer S15
[S8]  timeout peer S16
[S8]  timeout peer S17
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S16
[S14]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S5]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] → sending delta(kind=head bytes=1794) to S6@127.0.0.1:52807
[S17] sending update (kind=head size=1794 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1794) from S17
[S6] cosine check vs S17: cos=0.9713
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=34 metric=0.8177 head_norm=1.541842
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.877331e-02
[S3] stored merged vector for next round verification (round=34)
[S3] DEBUG after merge:  round=34 metric=0.8183 head_norm=1.539567 delta_norm=0.028773
[S3] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=34 metric=0.9900 head_norm=1.549715
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.639035e-02
[S9] stored merged vector for next round verification (round=34)
[S9] DEBUG after merge:  round=34 metric=0.9900 head_norm=1.553274 delta_norm=0.016390
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=34 metric=0.9968 head_norm=2.154484
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.193821e-02
[S14] stored merged vector for next round verification (round=34)
[S14] DEBUG after merge:  round=34 metric=0.9968 head_norm=2.150798 delta_norm=0.011938
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=34 metric=0.7350 head_norm=1.419208
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.708231e-01
[S6] stored merged vector for next round verification (round=34)
[S6] DEBUG after merge:  round=34 metric=0.7373 head_norm=1.361933 delta_norm=0.170823
[S6] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=34 metric=0.6163 head_norm=1.324362
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.688497e-01
[S17] stored merged vector for next round verification (round=34)
[S17] DEBUG after merge:  round=34 metric=0.6171 head_norm=1.248671 delta_norm=0.468850
[S17] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=34 metric=0.5980 head_norm=1.474931
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.865489e-02
[S7] stored merged vector for next round verification (round=34)
[S7] DEBUG after merge:  round=34 metric=0.5941 head_norm=1.518586 delta_norm=0.088655
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=34 metric=0.7405 head_norm=1.343155
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.910036e-01
[S13] stored merged vector for next round verification (round=34)
[S13] DEBUG after merge:  round=34 metric=0.6950 head_norm=1.397591 delta_norm=0.191004
[S13] aggregate: ROLLBACK (f1_val pre=0.741 post=0.695 tol_abs=0.005 tol_rel=0.0)
[S2] START round=35 head_norm_before_train=1.627860 cos_to_last_merge=0.9991 (last merge round=33)
[S2] round=35 local utility u=0.000000 metrics={'f1_val': 0.5969348086323352, 'auprc': 0.7373846794234113, 'loss_val': 1.3465320238883745, 'psi': 0.6531147569487656}-{'f1_val': 0.7033788791233408, 'auprc': 0.7940420110666476, 'loss_val': 0.5823655442984786, 'psi': 0.7396441319006636}
[S3] START round=35 head_norm_before_train=1.539567 cos_to_last_merge=1.0000 (last merge round=34)
[S3] round=35 local utility u=0.080188 metrics={'f1_val': 0.829492650140317, 'auprc': 0.9766480023393099, 'loss_val': 0.2731208593379289, 'psi': 0.8883547910199141}-{'f1_val': 0.8176554907980609, 'auprc': 0.9572222044990689, 'loss_val': 0.304196314682963, 'psi': 0.8734821762784641}
[S4] START round=35 head_norm_before_train=2.051539 (no previous merge yet)
[S4] round=35 local utility u=0.032173 metrics={'f1_val': 0.9455801783205355, 'auprc': 0.9384836781502194, 'loss_val': 0.28914207663229846, 'psi': 0.9427415782524091}-{'f1_val': 0.9414877212668946, 'auprc': 0.9310207050643908, 'loss_val': 0.3065440671590819, 'psi': 0.9373009147858932}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=35 head_norm_before_train=1.650491 cos_to_last_merge=0.7812 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.781
[S5] round=35 local utility u=0.018697 metrics={'f1_val': 0.9969191576905587, 'auprc': 0.997672072844853, 'loss_val': 0.10527029678673128, 'psi': 0.9972203237522765}-{'f1_val': 0.9964794802860635, 'auprc': 0.9948558972739332, 'loss_val': 0.13157861043968697, 'psi': 0.9958300470812114}
[S5] not sending this round → trigger blocked (psi=0.997)
[S6] START round=35 head_norm_before_train=1.361933 cos_to_last_merge=1.0000 (last merge round=34)
[S6] round=35 local utility u=0.000000 metrics={'f1_val': 0.6312558302594372, 'auprc': 0.872009828568076, 'loss_val': 0.8086006502080048, 'psi': 0.7275574295828928}-{'f1_val': 0.7350209175055016, 'auprc': 0.9137187573034564, 'loss_val': 0.610927988862132, 'psi': 0.8065000534246836}
[S7] START round=35 head_norm_before_train=1.518586 cos_to_last_merge=1.0000 (last merge round=34)
[S7] round=35 local utility u=0.000000 metrics={'f1_val': 0.42185684451930455, 'auprc': 0.7733973756846128, 'loss_val': 1.1275211161400334, 'psi': 0.5624730569854279}-{'f1_val': 0.597983671442473, 'auprc': 0.7790441831120296, 'loss_val': 0.712360301641975, 'psi': 0.6704078761102956}
[S8] START round=35 head_norm_before_train=1.518417 cos_to_last_merge=0.9998 (last merge round=32)
[S8] round=35 local utility u=0.025489 metrics={'f1_val': 0.9949323051384696, 'auprc': 0.9973066997672199, 'loss_val': 0.03568569960007563, 'psi': 0.9958820629899696}-{'f1_val': 0.9884940992024185, 'auprc': 0.9984065378993138, 'loss_val': 0.05133316429963247, 'psi': 0.9924590746811766}
[S9] START round=35 head_norm_before_train=1.553274 cos_to_last_merge=1.0000 (last merge round=34)
[S9] round=35 local utility u=0.023964 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9946076393947765, 'loss_val': 0.05065469301365163, 'psi': 0.9958393628462454}-{'f1_val': 0.9899766087340214, 'auprc': 0.998652354161302, 'loss_val': 0.07061440830463622, 'psi': 0.9934469069049336}
[S10] START round=35 head_norm_before_train=2.147171 cos_to_last_merge=1.0000 (last merge round=33)
[S10] round=35 local utility u=0.000176 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9960680352698366, 'loss_val': 0.024033570861179656, 'psi': 0.9955399175195594}-{'f1_val': 0.9951878390193748, 'auprc': 0.996008011430981, 'loss_val': 0.02420473113940085, 'psi': 0.9955159079840172}
[S11] START round=35 head_norm_before_train=1.537826 cos_to_last_merge=0.9997 (last merge round=33)
[S11] round=35 local utility u=0.000201 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9960448424380436, 'loss_val': 0.07446870832603988, 'psi': 0.9964513887241266}-{'f1_val': 0.9973780864376928, 'auprc': 0.9986408132759078, 'loss_val': 0.08659173832918524, 'psi': 0.9978831771729788}
[S13] START round=35 head_norm_before_train=1.397591 cos_to_last_merge=1.0000 (last merge round=34)
[S13] round=35 local utility u=0.000000 metrics={'f1_val': 0.7041340708018744, 'auprc': 0.707867734954485, 'loss_val': 0.8268036166193442, 'psi': 0.7056275364629186}-{'f1_val': 0.7405416714860619, 'auprc': 0.7027763246968224, 'loss_val': 0.7254509207904236, 'psi': 0.7254355327703661}
[S14] START round=35 head_norm_before_train=2.150798 cos_to_last_merge=1.0000 (last merge round=34)
[S14] round=35 local utility u=0.000000 metrics={'f1_val': 0.9974306056599991, 'auprc': 0.9979066126272382, 'loss_val': 0.03203685457378825, 'psi': 0.9976210084468948}-{'f1_val': 0.9968028443251822, 'auprc': 0.9995994742668811, 'loss_val': 0.03060251946193533, 'psi': 0.9979214963018618}
[S15] START round=35 head_norm_before_train=1.556997 cos_to_last_merge=0.9999 (last merge round=33)
[S15] round=35 local utility u=0.000000 metrics={'f1_val': 0.8076844049596219, 'auprc': 0.9379539115020202, 'loss_val': 0.3810002646939279, 'psi': 0.8597922075765811}-{'f1_val': 0.9398462864778534, 'auprc': 0.9933639682268376, 'loss_val': 0.11200690302084407, 'psi': 0.961253359177447}
[S16] START round=35 head_norm_before_train=1.566047 cos_to_last_merge=0.9962 (last merge round=29)
[S16] round=35 local utility u=0.000000 metrics={'f1_val': 0.9342558683646082, 'auprc': 0.9899020532186806, 'loss_val': 0.27405625786514054, 'psi': 0.9565143423062372}-{'f1_val': 0.9418609784996922, 'auprc': 0.9919779216413916, 'loss_val': 0.20109716164711736, 'psi': 0.961907755756372}
[S17] START round=35 head_norm_before_train=1.248671 cos_to_last_merge=1.0000 (last merge round=34)
[S17] round=35 local utility u=0.000000 metrics={'f1_val': 0.5547597297223597, 'auprc': 0.7471652092690353, 'loss_val': 0.9929425105628255, 'psi': 0.6317219215410299}-{'f1_val': 0.6162660336186117, 'auprc': 0.9582700317041603, 'loss_val': 0.798316883856792, 'psi': 0.7530676328528312}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:52814
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:52812
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:52815
[S9] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S13] ⇄ pheromone p=0.091 → S17@127.0.0.1:52817
[S2] ⇄ pheromone p=0.185 → S8@127.0.0.1:52809
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] ⇄ pheromone p=0.185 → S17@127.0.0.1:52817
[S14] ⇄ pheromone p=0.007 → S10@127.0.0.1:52811
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] ⇄ pheromone p=0.042 → S7@127.0.0.1:52808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:52803
[S10] sending update (kind=head size=1801 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1803) from S9
[S15] cosine check vs S9: cos=0.9996
[S14] RECEIVED delta(kind=head bytes=1801) from S10
[S14] cosine check vs S10: cos=0.9999
[S11] RECEIVED delta(kind=head bytes=1801) from S3
[S11] cosine check vs S3: cos=0.9986
[S10] ⇄ pheromone p=0.002 → S14@127.0.0.1:52814
[S11] sending update (kind=head size=1801 to 1 peers)
[S3] ⇄ pheromone p=0.186 → S11@127.0.0.1:52812
[S9] ⇄ pheromone p=0.066 → S15@127.0.0.1:52815
[S3] RECEIVED delta(kind=head bytes=1801) from S11
[S3] cosine check vs S11: cos=0.9986
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=35 metric=0.8077 head_norm=1.579909
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.355007e-02
[S15] stored merged vector for next round verification (round=35)
[S15] DEBUG after merge:  round=35 metric=0.8077 head_norm=1.576719 delta_norm=0.023550
[S15] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.168 → S9@127.0.0.1:52810
[S7] ⇄ pheromone p=0.230 → S13@127.0.0.1:52813
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=35 metric=0.9967 head_norm=1.565246
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.220888e-02
[S11] stored merged vector for next round verification (round=35)
[S11] DEBUG after merge:  round=35 metric=0.9967 head_norm=1.568837 delta_norm=0.042209
[S11] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.110 → S3@127.0.0.1:52803
[S17] RoundReady barrier timeout: have=2 need=3 — continuing
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] RoundReady barrier timeout: have=2 need=3 — continuing
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:52802
[S8] sending update (kind=head size=1801 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1801) from S8
[S2] cosine check vs S8: cos=0.9775
[S15]  timeout peer S8
[S17]  timeout peer S7
[S17]  timeout peer S9
[S7]  timeout peer S13
[S11]  timeout peer S5
[S8]  timeout peer S4
[S8]  timeout peer S11
[S8]  timeout peer S14
[S13]  timeout peer S17
[S17] ⇄ pheromone p=0.144 → S6@127.0.0.1:52807
[S8] ⇄ pheromone p=0.012 → S2@127.0.0.1:52802
[S2] START round=36 head_norm_before_train=1.686667 cos_to_last_merge=0.9971 (last merge round=33)
[S2] round=36 local utility u=0.743206 metrics={'f1_val': 0.6959604436517168, 'auprc': 0.8036873313202603, 'loss_val': 0.6531812469898426, 'psi': 0.7390511987191342}-{'f1_val': 0.5969348086323352, 'auprc': 0.7373846794234113, 'loss_val': 1.3465320238883745, 'psi': 0.6531147569487656}
[S3] START round=36 head_norm_before_train=1.573552 cos_to_last_merge=0.9996 (last merge round=34)
[S3] round=36 local utility u=0.455564 metrics={'f1_val': 0.9491082905432615, 'auprc': 0.9932064891925558, 'loss_val': 0.12936263760070368, 'psi': 0.9667475700029793}-{'f1_val': 0.829492650140317, 'auprc': 0.9766480023393099, 'loss_val': 0.2731208593379289, 'psi': 0.8883547910199141}
[S4] START round=36 head_norm_before_train=2.048793 (no previous merge yet)
[S4] round=36 local utility u=0.000000 metrics={'f1_val': 0.9441087865364846, 'auprc': 0.9261133110371607, 'loss_val': 0.30422776027435317, 'psi': 0.936910596336755}-{'f1_val': 0.9455801783205355, 'auprc': 0.9384836781502194, 'loss_val': 0.28914207663229846, 'psi': 0.9427415782524091}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=36 head_norm_before_train=1.662822 cos_to_last_merge=0.7804 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.780
[S5] round=36 local utility u=0.000000 metrics={'f1_val': 0.7148616753480442, 'auprc': 0.904782291040452, 'loss_val': 0.34506408743360856, 'psi': 0.7908299216250074}-{'f1_val': 0.9969191576905587, 'auprc': 0.997672072844853, 'loss_val': 0.10527029678673128, 'psi': 0.9972203237522765}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=36 head_norm_before_train=1.425493 cos_to_last_merge=0.9990 (last merge round=34)
[S6] round=36 local utility u=0.840329 metrics={'f1_val': 0.8063066282470104, 'auprc': 0.954030660365659, 'loss_val': 0.42431021655376344, 'psi': 0.8653962410944698}-{'f1_val': 0.6312558302594372, 'auprc': 0.872009828568076, 'loss_val': 0.8086006502080048, 'psi': 0.7275574295828928}
[S7] START round=36 head_norm_before_train=1.525601 cos_to_last_merge=1.0000 (last merge round=34)
[S7] round=36 local utility u=0.223847 metrics={'f1_val': 0.4705226034826412, 'auprc': 0.7740480499403668, 'loss_val': 0.9737732461847651, 'psi': 0.5919327820657314}-{'f1_val': 0.42185684451930455, 'auprc': 0.7733973756846128, 'loss_val': 1.1275211161400334, 'psi': 0.5624730569854279}
[S8] START round=36 head_norm_before_train=1.535507 cos_to_last_merge=0.9995 (last merge round=32)
[S8] round=36 local utility u=0.000000 metrics={'f1_val': 0.9895694841884839, 'auprc': 0.9980278340678528, 'loss_val': 0.04195665416457465, 'psi': 0.9929528241402314}-{'f1_val': 0.9949323051384696, 'auprc': 0.9973066997672199, 'loss_val': 0.03568569960007563, 'psi': 0.9958820629899696}
[S9] START round=36 head_norm_before_train=1.573875 cos_to_last_merge=0.9999 (last merge round=34)
[S9] round=36 local utility u=0.000000 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9924917364542573, 'loss_val': 0.045515527559286235, 'psi': 0.9947467514492695}-{'f1_val': 0.9966605118138915, 'auprc': 0.9946076393947765, 'loss_val': 0.05065469301365163, 'psi': 0.9958393628462454}
[S10] START round=36 head_norm_before_train=2.154070 cos_to_last_merge=0.9999 (last merge round=33)
[S10] round=36 local utility u=0.000084 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9960794393157453, 'loss_val': 0.023899635226109474, 'psi': 0.9955444791379229}-{'f1_val': 0.9951878390193748, 'auprc': 0.9960680352698366, 'loss_val': 0.024033570861179656, 'psi': 0.9955399175195594}
[S11] START round=36 head_norm_before_train=1.568837 cos_to_last_merge=1.0000 (last merge round=35)
[S11] round=36 local utility u=0.008121 metrics={'f1_val': 0.9973780864376928, 'auprc': 0.998628198106646, 'loss_val': 0.06991120965854832, 'psi': 0.9978781311052741}-{'f1_val': 0.9967224195815153, 'auprc': 0.9960448424380436, 'loss_val': 0.07446870832603988, 'psi': 0.9964513887241266}
[S13] START round=36 head_norm_before_train=1.440433 cos_to_last_merge=0.9984 (last merge round=34)
[S13] round=36 local utility u=0.000000 metrics={'f1_val': 0.6431008780821411, 'auprc': 0.6589996720079898, 'loss_val': 0.9040223031667545, 'psi': 0.6494603956524806}-{'f1_val': 0.7041340708018744, 'auprc': 0.707867734954485, 'loss_val': 0.8268036166193442, 'psi': 0.7056275364629186}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=36 head_norm_before_train=2.160907 cos_to_last_merge=1.0000 (last merge round=34)
[S14] round=36 local utility u=0.000000 metrics={'f1_val': 0.9742454110352095, 'auprc': 0.9970342198512073, 'loss_val': 0.05528070795031778, 'psi': 0.9833609345616086}-{'f1_val': 0.9974306056599991, 'auprc': 0.9979066126272382, 'loss_val': 0.03203685457378825, 'psi': 0.9976210084468948}
[S15] START round=36 head_norm_before_train=1.576719 cos_to_last_merge=1.0000 (last merge round=35)
[S15] round=36 local utility u=0.000000 metrics={'f1_val': 0.780983982424601, 'auprc': 0.9156627296863739, 'loss_val': 0.4388849875981461, 'psi': 0.8348554813293101}-{'f1_val': 0.8076844049596219, 'auprc': 0.9379539115020202, 'loss_val': 0.3810002646939279, 'psi': 0.8597922075765811}
[S16] START round=36 head_norm_before_train=1.587776 cos_to_last_merge=0.9954 (last merge round=29)
[S16] round=36 local utility u=0.163525 metrics={'f1_val': 0.9577364673833328, 'auprc': 0.9953976962513007, 'loss_val': 0.1043759408797346, 'psi': 0.97280095893052}-{'f1_val': 0.9342558683646082, 'auprc': 0.9899020532186806, 'loss_val': 0.27405625786514054, 'psi': 0.9565143423062372}
[S17] START round=36 head_norm_before_train=1.301118 cos_to_last_merge=0.9989 (last merge round=34)
[S17] round=36 local utility u=0.000000 metrics={'f1_val': 0.4803491789148112, 'auprc': 0.6938285870134631, 'loss_val': 1.2229653541366645, 'psi': 0.565740942154272}-{'f1_val': 0.5547597297223597, 'auprc': 0.7471652092690353, 'loss_val': 0.9929425105628255, 'psi': 0.6317219215410299}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:52816
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:52814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:52812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] → sending delta(kind=head bytes=1804) to S3@127.0.0.1:52803
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:52809
[S6] sending update (kind=head size=1804 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1804 to 1 peers)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=36 metric=0.9742 head_norm=2.169442
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.897133e-02
[S14] stored merged vector for next round verification (round=36)
[S14] DEBUG after merge:  round=36 metric=0.9747 head_norm=2.161686 delta_norm=0.018971
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S7] sending update (kind=head size=1798 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1804) from S6
[S17] cosine check vs S6: cos=0.8747
[S14] RECEIVED delta(kind=head bytes=1800) from S10
[S14] cosine check vs S10: cos=1.0000
[S16] RECEIVED delta(kind=head bytes=1798) from S7
[S16] cosine check vs S7: cos=0.9976
[S8] RECEIVED delta(kind=head bytes=1798) from S2
[S8] cosine check vs S2: cos=0.9715
[S11] RECEIVED delta(kind=head bytes=1802) from S3
[S11] cosine check vs S3: cos=0.9981
[S3] RECEIVED delta(kind=head bytes=1804) from S11
[S3] cosine check vs S11: cos=0.9981
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=36 metric=0.9491 head_norm=1.612253
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.779097e-02
[S3] stored merged vector for next round verification (round=36)
[S3] DEBUG after merge:  round=36 metric=0.9508 head_norm=1.594841 delta_norm=0.057791
[S3] aggregate: ACCEPT kept=['S11', 'S11'] (k=2/2) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=36 metric=0.6960 head_norm=1.737623
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.177494e-01
[S2] stored merged vector for next round verification (round=36)
[S2] DEBUG after merge:  round=36 metric=0.6931 head_norm=1.625160 delta_norm=0.217749
[S2] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=36 metric=0.9974 head_norm=1.593676
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.964283e-02
[S11] stored merged vector for next round verification (round=36)
[S11] DEBUG after merge:  round=36 metric=0.9974 head_norm=1.602223 delta_norm=0.049643
[S11] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=36 metric=0.4803 head_norm=1.346388
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.577860e-01
[S17] stored merged vector for next round verification (round=36)
[S17] DEBUG after merge:  round=36 metric=0.4838 head_norm=1.364242 delta_norm=0.357786
[S17] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=37 head_norm_before_train=1.625160 cos_to_last_merge=1.0000 (last merge round=36)
[S2] round=37 local utility u=0.000000 metrics={'f1_val': 0.6430152564122749, 'auprc': 0.774779863041464, 'loss_val': 0.8671744458117139, 'psi': 0.6957210990639505}-{'f1_val': 0.6959604436517168, 'auprc': 0.8036873313202603, 'loss_val': 0.6531812469898426, 'psi': 0.7390511987191342}
[S3] START round=37 head_norm_before_train=1.594841 cos_to_last_merge=1.0000 (last merge round=36)
[S3] round=37 local utility u=0.047596 metrics={'f1_val': 0.9625030579278266, 'auprc': 0.994378306376767, 'loss_val': 0.11805428389441987, 'psi': 0.9752531573074028}-{'f1_val': 0.9491082905432615, 'auprc': 0.9932064891925558, 'loss_val': 0.12936263760070368, 'psi': 0.9667475700029793}
[S4] START round=37 head_norm_before_train=2.051483 (no previous merge yet)
[S4] round=37 local utility u=0.000000 metrics={'f1_val': 0.9417168315433524, 'auprc': 0.9272891306321545, 'loss_val': 0.3058946274541933, 'psi': 0.9359457511788732}-{'f1_val': 0.9441087865364846, 'auprc': 0.9261133110371607, 'loss_val': 0.30422776027435317, 'psi': 0.936910596336755}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=37 head_norm_before_train=1.673305 cos_to_last_merge=0.7796 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.780
[S5] round=37 local utility u=1.000000 metrics={'f1_val': 0.9967728679684698, 'auprc': 0.9977209042744977, 'loss_val': 0.07442351891943033, 'psi': 0.9971520824908809}-{'f1_val': 0.7148616753480442, 'auprc': 0.904782291040452, 'loss_val': 0.34506408743360856, 'psi': 0.7908299216250074}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=37 head_norm_before_train=1.471588 cos_to_last_merge=0.9975 (last merge round=34)
[S6] round=37 local utility u=0.000000 metrics={'f1_val': 0.7414133083700818, 'auprc': 0.953951134294907, 'loss_val': 0.5822767279377375, 'psi': 0.8264284387400118}-{'f1_val': 0.8063066282470104, 'auprc': 0.954030660365659, 'loss_val': 0.42431021655376344, 'psi': 0.8653962410944698}
[S7] START round=37 head_norm_before_train=1.530955 cos_to_last_merge=0.9999 (last merge round=34)
[S7] round=37 local utility u=0.658995 metrics={'f1_val': 0.6261833581082046, 'auprc': 0.7815271245940966, 'loss_val': 0.6121852549585377, 'psi': 0.6883208647025614}-{'f1_val': 0.4705226034826412, 'auprc': 0.7740480499403668, 'loss_val': 0.9737732461847651, 'psi': 0.5919327820657314}
[S8] START round=37 head_norm_before_train=1.553684 cos_to_last_merge=0.9992 (last merge round=32)
[S8] round=37 local utility u=0.017821 metrics={'f1_val': 0.9943440443697734, 'auprc': 0.9980697039230609, 'loss_val': 0.035087645112956256, 'psi': 0.9958343081910884}-{'f1_val': 0.9895694841884839, 'auprc': 0.9980278340678528, 'loss_val': 0.04195665416457465, 'psi': 0.9929528241402314}
[S9] START round=37 head_norm_before_train=1.595247 cos_to_last_merge=0.9995 (last merge round=34)
[S9] round=37 local utility u=0.009662 metrics={'f1_val': 0.9958601375429889, 'auprc': 0.9984168255952559, 'loss_val': 0.04162700657636531, 'psi': 0.9968828127638956}-{'f1_val': 0.9962500947792776, 'auprc': 0.9924917364542573, 'loss_val': 0.045515527559286235, 'psi': 0.9947467514492695}
[S10] START round=37 head_norm_before_train=2.162537 cos_to_last_merge=0.9999 (last merge round=33)
[S10] round=37 local utility u=0.000015 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9960904173929416, 'loss_val': 0.023901989410856934, 'psi': 0.9955488703688015}-{'f1_val': 0.9951878390193748, 'auprc': 0.9960794393157453, 'loss_val': 0.023899635226109474, 'psi': 0.9955444791379229}
[S11] START round=37 head_norm_before_train=1.602223 cos_to_last_merge=1.0000 (last merge round=36)
[S11] round=37 local utility u=0.005152 metrics={'f1_val': 0.9973780864376928, 'auprc': 0.998845686614482, 'loss_val': 0.060259514646969714, 'psi': 0.9979651265084085}-{'f1_val': 0.9973780864376928, 'auprc': 0.998628198106646, 'loss_val': 0.06991120965854832, 'psi': 0.9978781311052741}
[S13] START round=37 head_norm_before_train=1.474208 cos_to_last_merge=0.9956 (last merge round=34)
[S13] round=37 local utility u=0.000000 metrics={'f1_val': 0.6503032807299375, 'auprc': 0.6020282470420637, 'loss_val': 0.9287342416227043, 'psi': 0.630993267254788}-{'f1_val': 0.6431008780821411, 'auprc': 0.6589996720079898, 'loss_val': 0.9040223031667545, 'psi': 0.6494603956524806}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=37 head_norm_before_train=2.161686 cos_to_last_merge=1.0000 (last merge round=36)
[S14] round=37 local utility u=0.089645 metrics={'f1_val': 0.9976538428159559, 'auprc': 0.9996036351845297, 'loss_val': 0.02414885387446229, 'psi': 0.9984337597633854}-{'f1_val': 0.9742454110352095, 'auprc': 0.9970342198512073, 'loss_val': 0.05528070795031778, 'psi': 0.9833609345616086}
[S15] START round=37 head_norm_before_train=1.601210 cos_to_last_merge=0.9999 (last merge round=35)
[S15] round=37 local utility u=0.768181 metrics={'f1_val': 0.9412618979763847, 'auprc': 0.995965917158555, 'loss_val': 0.10510087723071714, 'psi': 0.9631435056492528}-{'f1_val': 0.780983982424601, 'auprc': 0.9156627296863739, 'loss_val': 0.4388849875981461, 'psi': 0.8348554813293101}
[S16] START round=37 head_norm_before_train=1.608039 cos_to_last_merge=0.9946 (last merge round=29)
[S16] round=37 local utility u=0.141242 metrics={'f1_val': 0.9922255596773846, 'auprc': 0.9991486497665922, 'loss_val': 0.04007995247354774, 'psi': 0.9949947957130676}-{'f1_val': 0.9577364673833328, 'auprc': 0.9953976962513007, 'loss_val': 0.1043759408797346, 'psi': 0.97280095893052}
[S17] START round=37 head_norm_before_train=1.364242 cos_to_last_merge=1.0000 (last merge round=36)
[S17] round=37 local utility u=0.844110 metrics={'f1_val': 0.599734365552878, 'auprc': 0.9302646904315046, 'loss_val': 0.9603656202997622, 'psi': 0.7319464955043287}-{'f1_val': 0.4803491789148112, 'auprc': 0.6938285870134631, 'loss_val': 1.2229653541366645, 'psi': 0.565740942154272}
[S10] not sending this round → trigger blocked (psi=0.996)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.688)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:52811
[S3] not sending this round → trigger blocked (psi=0.975)
[S16] not sending this round → trigger blocked (psi=0.995)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:52802
[S11] not sending this round → trigger blocked (psi=0.998)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:52815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:52810
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:52807
[S14] sending update (kind=head size=1798 to 1 peers)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=37 metric=0.9922 head_norm=1.628043
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.771651e-02
[S16] stored merged vector for next round verification (round=37)
[S16] DEBUG after merge:  round=37 metric=0.9922 head_norm=1.578333 delta_norm=0.077717
[S16] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S15] sending update (kind=head size=1803 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1801) from S9
[S15] cosine check vs S9: cos=0.9987
[S2] RECEIVED delta(kind=head bytes=1800) from S8
[S2] cosine check vs S8: cos=0.9874
[S10] RECEIVED delta(kind=head bytes=1798) from S14
[S10] cosine check vs S14: cos=0.9999
[S9] RECEIVED delta(kind=head bytes=1803) from S15
[S9] cosine check vs S15: cos=0.9987
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=37 metric=0.9413 head_norm=1.623554
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.192406e-02
[S15] stored merged vector for next round verification (round=37)
[S15] DEBUG after merge:  round=37 metric=0.9403 head_norm=1.618654 delta_norm=0.041924
[S15] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=37 metric=0.9959 head_norm=1.614828
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.192406e-02
[S9] stored merged vector for next round verification (round=37)
[S9] DEBUG after merge:  round=37 metric=0.9959 head_norm=1.618654 delta_norm=0.041924
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=37 metric=0.9943 head_norm=1.567111
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.169480e-01
[S8] stored merged vector for next round verification (round=37)
[S8] DEBUG after merge:  round=37 metric=0.9943 head_norm=1.640280 delta_norm=0.216948
[S8] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=37 metric=0.9977 head_norm=2.171270
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.451246e-02
[S14] stored merged vector for next round verification (round=37)
[S14] DEBUG after merge:  round=37 metric=0.9977 head_norm=2.166859 delta_norm=0.014512
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S17] sending update (kind=head size=1799 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1799) from S17
[S6] cosine check vs S17: cos=0.9648
[S2] START round=38 head_norm_before_train=1.671655 cos_to_last_merge=0.9996 (last merge round=36)
[S2] round=38 local utility u=0.275029 metrics={'f1_val': 0.6948277546733382, 'auprc': 0.7883615313382409, 'loss_val': 0.6687360358430098, 'psi': 0.7322412653392993}-{'f1_val': 0.6430152564122749, 'auprc': 0.774779863041464, 'loss_val': 0.8671744458117139, 'psi': 0.6957210990639505}
[S3] START round=38 head_norm_before_train=1.634676 cos_to_last_merge=0.9995 (last merge round=36)
[S3] round=38 local utility u=0.031840 metrics={'f1_val': 0.9624632639299391, 'auprc': 0.9996380077784145, 'loss_val': 0.06991471945316663, 'psi': 0.9773331614693292}-{'f1_val': 0.9625030579278266, 'auprc': 0.994378306376767, 'loss_val': 0.11805428389441987, 'psi': 0.9752531573074028}
[S4] START round=38 head_norm_before_train=2.056615 (no previous merge yet)
[S4] round=38 local utility u=0.050228 metrics={'f1_val': 0.9439822754612796, 'auprc': 0.9516836732627253, 'loss_val': 0.29221530154427583, 'psi': 0.9470628345818579}-{'f1_val': 0.9417168315433524, 'auprc': 0.9272891306321545, 'loss_val': 0.3058946274541933, 'psi': 0.9359457511788732}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] START round=38 head_norm_before_train=1.686203 cos_to_last_merge=0.7783 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.778
[S5] round=38 local utility u=0.000000 metrics={'f1_val': 0.94224147933958, 'auprc': 0.9913219351017724, 'loss_val': 0.12194901368335427, 'psi': 0.961873661644457}-{'f1_val': 0.9967728679684698, 'auprc': 0.9977209042744977, 'loss_val': 0.07442351891943033, 'psi': 0.9971520824908809}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=38 head_norm_before_train=1.515391 cos_to_last_merge=0.9954 (last merge round=34)
[S6] round=38 local utility u=0.222078 metrics={'f1_val': 0.7960948387552695, 'auprc': 0.9651208064537944, 'loss_val': 0.4997191309758597, 'psi': 0.8637052258346795}-{'f1_val': 0.7414133083700818, 'auprc': 0.953951134294907, 'loss_val': 0.5822767279377375, 'psi': 0.8264284387400118}
[S7] START round=38 head_norm_before_train=1.535984 cos_to_last_merge=0.9999 (last merge round=34)
[S7] round=38 local utility u=0.000000 metrics={'f1_val': 0.6002152032359214, 'auprc': 0.7802013735227876, 'loss_val': 0.6579860741719735, 'psi': 0.6722096713506679}-{'f1_val': 0.6261833581082046, 'auprc': 0.7815271245940966, 'loss_val': 0.6121852549585377, 'psi': 0.6883208647025614}
[S8] START round=38 head_norm_before_train=1.640280 cos_to_last_merge=1.0000 (last merge round=37)
[S8] round=38 local utility u=0.002392 metrics={'f1_val': 0.9949323051384696, 'auprc': 0.9974363047907059, 'loss_val': 0.0319330792475148, 'psi': 0.9959339049993641}-{'f1_val': 0.9943440443697734, 'auprc': 0.9980697039230609, 'loss_val': 0.035087645112956256, 'psi': 0.9958343081910884}
[S9] START round=38 head_norm_before_train=1.618654 cos_to_last_merge=1.0000 (last merge round=37)
[S9] round=38 local utility u=0.000000 metrics={'f1_val': 0.9895654130089716, 'auprc': 0.9984164375691578, 'loss_val': 0.05488794875245051, 'psi': 0.993105822833046}-{'f1_val': 0.9958601375429889, 'auprc': 0.9984168255952559, 'loss_val': 0.04162700657636531, 'psi': 0.9968828127638956}
[S10] START round=38 head_norm_before_train=2.168273 cos_to_last_merge=0.9998 (last merge round=33)
[S10] round=38 local utility u=0.000339 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9961912385304825, 'loss_val': 0.023525593745920573, 'psi': 0.9955891988238179}-{'f1_val': 0.9951878390193748, 'auprc': 0.9960904173929416, 'loss_val': 0.023901989410856934, 'psi': 0.9955488703688015}
[S11] START round=38 head_norm_before_train=1.622919 cos_to_last_merge=0.9999 (last merge round=36)
[S11] round=38 local utility u=0.000000 metrics={'f1_val': 0.9962850284706224, 'auprc': 0.9979498579253541, 'loss_val': 0.054645326455833115, 'psi': 0.9969509602525151}-{'f1_val': 0.9973780864376928, 'auprc': 0.998845686614482, 'loss_val': 0.060259514646969714, 'psi': 0.9979651265084085}
[S13] START round=38 head_norm_before_train=1.502028 cos_to_last_merge=0.9925 (last merge round=34)
[S13] round=38 local utility u=0.616131 metrics={'f1_val': 0.7535932291454988, 'auprc': 0.763512440236171, 'loss_val': 0.8006651920682987, 'psi': 0.7575609135817676}-{'f1_val': 0.6503032807299375, 'auprc': 0.6020282470420637, 'loss_val': 0.9287342416227043, 'psi': 0.630993267254788}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S13] sending update (kind=head size=1792 to 1 peers)
[S14] START round=38 head_norm_before_train=2.166859 cos_to_last_merge=1.0000 (last merge round=37)
[S14] round=38 local utility u=0.000000 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9995958545079553, 'loss_val': 0.029170836524253615, 'psi': 0.9984290126330942}-{'f1_val': 0.9976538428159559, 'auprc': 0.9996036351845297, 'loss_val': 0.02414885387446229, 'psi': 0.9984337597633854}
[S15] START round=38 head_norm_before_train=1.618654 cos_to_last_merge=1.0000 (last merge round=37)
[S15] round=38 local utility u=0.000000 metrics={'f1_val': 0.8188283938599569, 'auprc': 0.9779726675687728, 'loss_val': 0.3423465476197173, 'psi': 0.8824861033434832}-{'f1_val': 0.9412618979763847, 'auprc': 0.995965917158555, 'loss_val': 0.10510087723071714, 'psi': 0.9631435056492528}
[S16] START round=38 head_norm_before_train=1.578333 cos_to_last_merge=1.0000 (last merge round=37)
[S16] round=38 local utility u=0.000000 metrics={'f1_val': 0.9922316907829952, 'auprc': 0.9988116628743775, 'loss_val': 0.047128790213701505, 'psi': 0.9948636796195481}-{'f1_val': 0.9922255596773846, 'auprc': 0.9991486497665922, 'loss_val': 0.04007995247354774, 'psi': 0.9949947957130676}
[S17] START round=38 head_norm_before_train=1.398604 cos_to_last_merge=0.9997 (last merge round=36)
[S17] round=38 local utility u=0.000000 metrics={'f1_val': 0.5944565648035205, 'auprc': 0.8392478721112365, 'loss_val': 1.003182936253693, 'psi': 0.692373087726607}-{'f1_val': 0.599734365552878, 'auprc': 0.9302646904315046, 'loss_val': 0.9603656202997622, 'psi': 0.7319464955043287}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S6] → sending delta(kind=head bytes=1806) to S17@127.0.0.1:52817
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:52812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:52809
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.996)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:52814
[S10] sending update (kind=head size=1796 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1806 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1802) from S2
[S8] cosine check vs S2: cos=0.9978
[S14] RECEIVED delta(kind=head bytes=1796) from S10
[S14] cosine check vs S10: cos=0.9997
[S17] RECEIVED delta(kind=head bytes=1806) from S6
[S17] cosine check vs S6: cos=0.9589
[S11] RECEIVED delta(kind=head bytes=1799) from S3
[S11] cosine check vs S3: cos=0.9984
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=38 metric=0.7961 head_norm=1.553419
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.210207e-01
[S6] stored merged vector for next round verification (round=38)
[S6] DEBUG after merge:  round=38 metric=0.8010 head_norm=1.461421 delta_norm=0.221021
[S6] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=38 metric=0.6948 head_norm=1.726179
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.735130e-01
[S2] stored merged vector for next round verification (round=38)
[S2] DEBUG after merge:  round=38 metric=0.6871 head_norm=1.639408 delta_norm=0.173513
[S2] aggregate: ROLLBACK (f1_val pre=0.695 post=0.687 tol_abs=0.005 tol_rel=0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=38 metric=0.9952 head_norm=2.165582
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.838350e-02
[S10] stored merged vector for next round verification (round=38)
[S10] DEBUG after merge:  round=38 metric=0.9952 head_norm=2.168242 delta_norm=0.028383
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=38 metric=0.5945 head_norm=1.426874
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.225383e-01
[S17] stored merged vector for next round verification (round=38)
[S17] DEBUG after merge:  round=38 metric=0.5945 head_norm=1.474794 delta_norm=0.222538
[S17] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=39 head_norm_before_train=1.639408 cos_to_last_merge=1.0000 (last merge round=38)
[S2] round=39 local utility u=0.000000 metrics={'f1_val': 0.6049538657163672, 'auprc': 0.7521231912049643, 'loss_val': 1.2912868328486642, 'psi': 0.6638215959118061}-{'f1_val': 0.6948277546733382, 'auprc': 0.7883615313382409, 'loss_val': 0.6687360358430098, 'psi': 0.7322412653392993}
[S3] START round=39 head_norm_before_train=1.669103 cos_to_last_merge=0.9985 (last merge round=36)
[S3] round=39 local utility u=0.011551 metrics={'f1_val': 0.96522067484392, 'auprc': 0.9996222224942372, 'loss_val': 0.06331056405952909, 'psi': 0.9789812939040469}-{'f1_val': 0.9624632639299391, 'auprc': 0.9996380077784145, 'loss_val': 0.06991471945316663, 'psi': 0.9773331614693292}
[S4] START round=39 head_norm_before_train=2.060476 (no previous merge yet)
[S4] round=39 local utility u=0.004274 metrics={'f1_val': 0.9500475497484313, 'auprc': 0.9437197371834183, 'loss_val': 0.29616706073720084, 'psi': 0.947516424722426}-{'f1_val': 0.9439822754612796, 'auprc': 0.9516836732627253, 'loss_val': 0.29221530154427583, 'psi': 0.9470628345818579}
[S4] not sending this round → trigger blocked (psi=0.948)
[S4] r=40 psi=0.948 u=0.0043 p_local=0.0147 f1=0.950 auprc=0.944 bytes=30590
[S5] START round=39 head_norm_before_train=1.696267 cos_to_last_merge=0.7773 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.777
[S5] round=39 local utility u=0.201486 metrics={'f1_val': 0.9964794802860635, 'auprc': 0.998066372756119, 'loss_val': 0.0646385157363742, 'psi': 0.9971142372740857}-{'f1_val': 0.94224147933958, 'auprc': 0.9913219351017724, 'loss_val': 0.12194901368335427, 'psi': 0.961873661644457}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] sending update (kind=head size=1805 to 1 peers)
[S5] r=40 psi=0.997 u=0.2015 p_local=0.2303 f1=0.996 auprc=0.998 bytes=39580
[S6] START round=39 head_norm_before_train=1.461421 cos_to_last_merge=1.0000 (last merge round=38)
[S6] round=39 local utility u=0.352314 metrics={'f1_val': 0.8818941433839758, 'auprc': 0.9543835477624278, 'loss_val': 0.2776749718351997, 'psi': 0.9108899051353566}-{'f1_val': 0.7960948387552695, 'auprc': 0.9651208064537944, 'loss_val': 0.4997191309758597, 'psi': 0.8637052258346795}
[S7] START round=39 head_norm_before_train=1.543619 cos_to_last_merge=0.9998 (last merge round=34)
[S7] round=39 local utility u=0.000000 metrics={'f1_val': 0.548316116720627, 'auprc': 0.7761823841900723, 'loss_val': 0.7652985182042522, 'psi': 0.6394626237084051}-{'f1_val': 0.6002152032359214, 'auprc': 0.7802013735227876, 'loss_val': 0.6579860741719735, 'psi': 0.6722096713506679}
[S8] START round=39 head_norm_before_train=1.653214 cos_to_last_merge=1.0000 (last merge round=37)
[S8] round=39 local utility u=0.000000 metrics={'f1_val': 0.9879145188369769, 'auprc': 0.9983988301885978, 'loss_val': 0.044202776295764606, 'psi': 0.9921082433776252}-{'f1_val': 0.9949323051384696, 'auprc': 0.9974363047907059, 'loss_val': 0.0319330792475148, 'psi': 0.9959339049993641}
[S9] START round=39 head_norm_before_train=1.636486 cos_to_last_merge=0.9999 (last merge round=37)
[S9] round=39 local utility u=0.027716 metrics={'f1_val': 0.9958601375429889, 'auprc': 0.998426393781147, 'loss_val': 0.03725410051059591, 'psi': 0.9968866400382521}-{'f1_val': 0.9895654130089716, 'auprc': 0.9984164375691578, 'loss_val': 0.05488794875245051, 'psi': 0.993105822833046}
[S10] START round=39 head_norm_before_train=2.168242 cos_to_last_merge=1.0000 (last merge round=38)
[S10] round=39 local utility u=0.000100 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9961998765826232, 'loss_val': 0.02335092523614522, 'psi': 0.9955926540446741}-{'f1_val': 0.9951878390193748, 'auprc': 0.9961912385304825, 'loss_val': 0.023525593745920573, 'psi': 0.9955891988238179}
[S11] START round=39 head_norm_before_train=1.642961 cos_to_last_merge=0.9996 (last merge round=36)
[S11] round=39 local utility u=0.005779 metrics={'f1_val': 0.9973780864376928, 'auprc': 0.9982655000510399, 'loss_val': 0.05059258133684104, 'psi': 0.9977330518830316}-{'f1_val': 0.9962850284706224, 'auprc': 0.9979498579253541, 'loss_val': 0.054645326455833115, 'psi': 0.9969509602525151}
[S13] START round=39 head_norm_before_train=1.521304 cos_to_last_merge=0.9900 (last merge round=34)
[S13] round=39 local utility u=0.016020 metrics={'f1_val': 0.7637812193859548, 'auprc': 0.7513992563141598, 'loss_val': 0.7934136542662877, 'psi': 0.7588284341572368}-{'f1_val': 0.7535932291454988, 'auprc': 0.763512440236171, 'loss_val': 0.8006651920682987, 'psi': 0.7575609135817676}
[S13] not sending this round → trigger blocked (psi=0.759)
[S13] r=40 psi=0.759 u=0.0160 p_local=0.1391 f1=0.764 auprc=0.751 bytes=28730
[S14] START round=39 head_norm_before_train=2.177077 cos_to_last_merge=1.0000 (last merge round=37)
[S14] round=39 local utility u=0.000000 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9995257754533471, 'loss_val': 0.029783954728952143, 'psi': 0.9982552718823742}-{'f1_val': 0.9976511180498535, 'auprc': 0.9995958545079553, 'loss_val': 0.029170836524253615, 'psi': 0.9984290126330942}
[S15] START round=39 head_norm_before_train=1.638214 cos_to_last_merge=1.0000 (last merge round=37)
[S15] round=39 local utility u=0.339820 metrics={'f1_val': 0.9033321865438193, 'auprc': 0.9932770178020409, 'loss_val': 0.2156428105628134, 'psi': 0.939310119047108}-{'f1_val': 0.8188283938599569, 'auprc': 0.9779726675687728, 'loss_val': 0.3423465476197173, 'psi': 0.8824861033434832}
[S16] START round=39 head_norm_before_train=1.596031 cos_to_last_merge=1.0000 (last merge round=37)
[S16] round=39 local utility u=0.002203 metrics={'f1_val': 0.9922322836520087, 'auprc': 0.9985012584955473, 'loss_val': 0.04179541512338315, 'psi': 0.9947398735894242}-{'f1_val': 0.9922316907829952, 'auprc': 0.9988116628743775, 'loss_val': 0.047128790213701505, 'psi': 0.9948636796195481}
[S17] START round=39 head_norm_before_train=1.474794 cos_to_last_merge=1.0000 (last merge round=38)
[S17] round=39 local utility u=0.000000 metrics={'f1_val': 0.5090786897122637, 'auprc': 0.6901446112934061, 'loss_val': 1.2200727455400067, 'psi': 0.5815050583447205}-{'f1_val': 0.5944565648035205, 'auprc': 0.8392478721112365, 'loss_val': 1.003182936253693, 'psi': 0.692373087726607}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:52815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.996)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.979)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:52803
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:52810
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.911)
[S6] r=40 psi=0.911 u=0.3523 p_local=0.2676 f1=0.882 auprc=0.954 bytes=30591
[S15] sending update (kind=head size=1797 to 1 peers)
[S10] r=40 psi=0.996 u=0.0001 p_local=0.0008 f1=0.995 auprc=0.996 bytes=48624
[S11] sending update (kind=head size=1795 to 1 peers)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=39 metric=0.9974 head_norm=2.188653
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.000239e-02
[S14] stored merged vector for next round verification (round=39)
[S14] DEBUG after merge:  round=39 metric=0.9974 head_norm=2.176941 delta_norm=0.030002
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] r=40 psi=0.998 u=0.0000 p_local=0.0144 f1=0.997 auprc=1.000 bytes=36000
[S3] r=40 psi=0.979 u=0.0116 p_local=0.1365 f1=0.965 auprc=1.000 bytes=43198
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=39 metric=0.9879 head_norm=1.666379
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.604498e-02
[S8] stored merged vector for next round verification (round=39)
[S8] DEBUG after merge:  round=39 metric=0.9879 head_norm=1.695256 delta_norm=0.066045
[S8] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S8] r=40 psi=0.992 u=0.0000 p_local=0.0076 f1=0.988 auprc=0.998 bytes=41372
[S16] r=40 psi=0.995 u=0.0022 p_local=0.0523 f1=0.992 auprc=0.999 bytes=37765
[S7] r=40 psi=0.639 u=0.0000 p_local=0.2014 f1=0.548 auprc=0.776 bytes=32358
[S9] sending update (kind=head size=1803 to 1 peers)
[S2] r=40 psi=0.664 u=0.0000 p_local=0.1959 f1=0.605 auprc=0.752 bytes=30601
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] RECEIVED delta(kind=head bytes=1795) from S11
[S3] cosine check vs S11: cos=0.9969
[S9] RECEIVED delta(kind=head bytes=1797) from S15
[S9] cosine check vs S15: cos=0.9996
[S15] RECEIVED delta(kind=head bytes=1803) from S9
[S15] cosine check vs S9: cos=0.9996
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=39 metric=0.9974 head_norm=1.662878
[S11] _apply_head_vector_avg (torch): Δ‖w‖=5.310246e-02
[S11] stored merged vector for next round verification (round=39)
[S11] DEBUG after merge:  round=39 metric=0.9974 head_norm=1.665147 delta_norm=0.053102
[S11] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S11] r=40 psi=0.998 u=0.0058 p_local=0.0478 f1=0.997 auprc=0.998 bytes=52219
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=39 metric=0.9033 head_norm=1.657517
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.349381e-02
[S15] stored merged vector for next round verification (round=39)
[S15] DEBUG after merge:  round=39 metric=0.9028 head_norm=1.654643 delta_norm=0.023494
[S15] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S15] r=40 psi=0.939 u=0.3398 p_local=0.2352 f1=0.903 auprc=0.993 bytes=35993
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=39 metric=0.9959 head_norm=1.652099
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.349380e-02
[S9] stored merged vector for next round verification (round=39)
[S9] DEBUG after merge:  round=39 metric=0.9959 head_norm=1.654643 delta_norm=0.023494
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S9] r=40 psi=0.997 u=0.0277 p_local=0.0337 f1=0.996 auprc=0.998 bytes=39561
[S17] r=40 psi=0.582 u=0.0000 p_local=0.1672 f1=0.509 auprc=0.690 bytes=30555
[S2] START round=40 head_norm_before_train=1.693554 cos_to_last_merge=0.9994 (last merge round=38)
[S2] round=40 local utility u=0.688111 metrics={'f1_val': 0.6999199247856087, 'auprc': 0.8016577297663484, 'loss_val': 0.6334641307356265, 'psi': 0.7406150467779047}-{'f1_val': 0.6049538657163672, 'auprc': 0.7521231912049643, 'loss_val': 1.2912868328486642, 'psi': 0.6638215959118061}
[S3] START round=40 head_norm_before_train=1.700659 cos_to_last_merge=0.9973 (last merge round=36)
[S3] round=40 local utility u=0.000000 metrics={'f1_val': 0.9559641259850362, 'auprc': 0.9935306077002504, 'loss_val': 0.10730041124413338, 'psi': 0.9709907186711219}-{'f1_val': 0.96522067484392, 'auprc': 0.9996222224942372, 'loss_val': 0.06331056405952909, 'psi': 0.9789812939040469}
[S4] START round=40 head_norm_before_train=2.054084 (no previous merge yet)
[S4] round=40 local utility u=0.000000 metrics={'f1_val': 0.9481535780880691, 'auprc': 0.9394131827633742, 'loss_val': 0.29532730245952843, 'psi': 0.9446574199581911}-{'f1_val': 0.9500475497484313, 'auprc': 0.9437197371834183, 'loss_val': 0.29616706073720084, 'psi': 0.947516424722426}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=40 head_norm_before_train=1.702475 cos_to_last_merge=0.7767 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.777
[S5] round=40 local utility u=0.006621 metrics={'f1_val': 0.9967728679684698, 'auprc': 0.9981778169994723, 'loss_val': 0.05349111429358409, 'psi': 0.9973348475808708}-{'f1_val': 0.9964794802860635, 'auprc': 0.998066372756119, 'loss_val': 0.0646385157363742, 'psi': 0.9971142372740857}
[S5] not sending this round → trigger blocked (psi=0.997)
[S6] START round=40 head_norm_before_train=1.494926 cos_to_last_merge=0.9997 (last merge round=38)
[S6] round=40 local utility u=0.000000 metrics={'f1_val': 0.6381264482809194, 'auprc': 0.8874428897523317, 'loss_val': 0.7863778500237116, 'psi': 0.7378530248694843}-{'f1_val': 0.8818941433839758, 'auprc': 0.9543835477624278, 'loss_val': 0.2776749718351997, 'psi': 0.9108899051353566}
[S7] START round=40 head_norm_before_train=1.550067 cos_to_last_merge=0.9996 (last merge round=34)
[S7] round=40 local utility u=0.492951 metrics={'f1_val': 0.6559601581292657, 'auprc': 0.7969676561909889, 'loss_val': 0.4876164520875084, 'psi': 0.712363157353955}-{'f1_val': 0.548316116720627, 'auprc': 0.7761823841900723, 'loss_val': 0.7652985182042522, 'psi': 0.6394626237084051}
[S8] START round=40 head_norm_before_train=1.695256 cos_to_last_merge=1.0000 (last merge round=39)
[S8] round=40 local utility u=0.000000 metrics={'f1_val': 0.9803445257975303, 'auprc': 0.9973807868167452, 'loss_val': 0.055607723893364075, 'psi': 0.9871590302052162}-{'f1_val': 0.9879145188369769, 'auprc': 0.9983988301885978, 'loss_val': 0.044202776295764606, 'psi': 0.9921082433776252}
[S9] START round=40 head_norm_before_train=1.654643 cos_to_last_merge=1.0000 (last merge round=39)
[S9] round=40 local utility u=0.000000 metrics={'f1_val': 0.9897381162675762, 'auprc': 0.998411904159599, 'loss_val': 0.04981484617627563, 'psi': 0.9932076314243853}-{'f1_val': 0.9958601375429889, 'auprc': 0.998426393781147, 'loss_val': 0.03725410051059591, 'psi': 0.9968866400382521}
[S10] START round=40 head_norm_before_train=2.173125 cos_to_last_merge=1.0000 (last merge round=38)
[S10] round=40 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9961862320951359, 'loss_val': 0.023408542774691836, 'psi': 0.9955871962496792}-{'f1_val': 0.9951878390193748, 'auprc': 0.9961998765826232, 'loss_val': 0.02335092523614522, 'psi': 0.9955926540446741}
[S11] START round=40 head_norm_before_train=1.665147 cos_to_last_merge=1.0000 (last merge round=39)
[S11] round=40 local utility u=0.000318 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9982905231744368, 'loss_val': 0.047548872880961025, 'psi': 0.997494763245521}-{'f1_val': 0.9973780864376928, 'auprc': 0.9982655000510399, 'loss_val': 0.05059258133684104, 'psi': 0.9977330518830316}
[S13] START round=40 head_norm_before_train=1.534261 cos_to_last_merge=0.9882 (last merge round=34)
[S13] round=40 local utility u=0.000000 metrics={'f1_val': 0.6678852650133666, 'auprc': 0.6784250641888327, 'loss_val': 0.8814549998492505, 'psi': 0.6721011846835531}-{'f1_val': 0.7637812193859548, 'auprc': 0.7513992563141598, 'loss_val': 0.7934136542662877, 'psi': 0.7588284341572368}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=40 head_norm_before_train=2.176941 cos_to_last_merge=1.0000 (last merge round=39)
[S14] round=40 local utility u=0.000000 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9975057079998058, 'loss_val': 0.027286713140118497, 'psi': 0.9975929540298345}-{'f1_val': 0.9974082695017256, 'auprc': 0.9995257754533471, 'loss_val': 0.029783954728952143, 'psi': 0.9982552718823742}
[S15] START round=40 head_norm_before_train=1.654643 cos_to_last_merge=1.0000 (last merge round=39)
[S15] round=40 local utility u=0.000000 metrics={'f1_val': 0.7004174622349693, 'auprc': 0.7381240153026227, 'loss_val': 0.6252403105404969, 'psi': 0.7155000834620306}-{'f1_val': 0.9033321865438193, 'auprc': 0.9932770178020409, 'loss_val': 0.2156428105628134, 'psi': 0.939310119047108}
[S16] START round=40 head_norm_before_train=1.612753 cos_to_last_merge=0.9998 (last merge round=37)
[S16] round=40 local utility u=0.005758 metrics={'f1_val': 0.992885629362925, 'auprc': 0.99901057233916, 'loss_val': 0.03572669230732071, 'psi': 0.995335606553419}-{'f1_val': 0.9922322836520087, 'auprc': 0.9985012584955473, 'loss_val': 0.04179541512338315, 'psi': 0.9947398735894242}
[S17] START round=40 head_norm_before_train=1.500855 cos_to_last_merge=0.9998 (last merge round=38)
[S17] round=40 local utility u=1.000000 metrics={'f1_val': 0.6893701357069805, 'auprc': 0.879208364199657, 'loss_val': 0.8542800328152923, 'psi': 0.7653054271040511}-{'f1_val': 0.5090786897122637, 'auprc': 0.6901446112934061, 'loss_val': 1.2200727455400067, 'psi': 0.5815050583447205}
[S16] not sending this round → trigger blocked (psi=0.995)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.997)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:52816
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1803 to 1 peers)
[S6] ⇄ pheromone p=0.214 → S17@127.0.0.1:52817
[S2] sending update (kind=head size=1804 to 1 peers)
[S9] ⇄ pheromone p=0.027 → S15@127.0.0.1:52815
[S14] ⇄ pheromone p=0.012 → S10@127.0.0.1:52811
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=40 metric=0.9560 head_norm=1.730031
[S3] _apply_head_vector_avg (torch): Δ‖w‖=8.670130e-02
[S3] stored merged vector for next round verification (round=40)
[S3] DEBUG after merge:  round=40 metric=0.9560 head_norm=1.694570 delta_norm=0.086701
[S3] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.109 → S11@127.0.0.1:52812
[S8] ⇄ pheromone p=0.006 → S2@127.0.0.1:52802
[S11] ⇄ pheromone p=0.038 → S3@127.0.0.1:52803
[S15] ⇄ pheromone p=0.188 → S9@127.0.0.1:52810
[S10] ⇄ pheromone p=0.001 → S14@127.0.0.1:52814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:52807
[S16] RECEIVED delta(kind=head bytes=1803) from S7
[S16] cosine check vs S7: cos=0.9974
[S8] RECEIVED delta(kind=head bytes=1804) from S2
[S8] cosine check vs S2: cos=0.9998
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] ⇄ pheromone p=0.294 → S8@127.0.0.1:52809
[S7] ⇄ pheromone p=0.260 → S16@127.0.0.1:52816
[S6] RECEIVED delta(kind=head bytes=1800) from S17
[S6] cosine check vs S17: cos=0.9976
[S17] ⇄ pheromone p=0.334 → S6@127.0.0.1:52807
[S2] START round=41 head_norm_before_train=1.740972 cos_to_last_merge=0.9982 (last merge round=38)
[S2] round=41 local utility u=0.034611 metrics={'f1_val': 0.701583553858809, 'auprc': 0.8221879669862565, 'loss_val': 0.6358141639635069, 'psi': 0.749825319109788}-{'f1_val': 0.6999199247856087, 'auprc': 0.8016577297663484, 'loss_val': 0.6334641307356265, 'psi': 0.7406150467779047}
[S3] START round=41 head_norm_before_train=1.694570 cos_to_last_merge=1.0000 (last merge round=40)
[S3] round=41 local utility u=0.089605 metrics={'f1_val': 0.9747179186294904, 'auprc': 0.9994650674142063, 'loss_val': 0.058416305941902835, 'psi': 0.9846167781433768}-{'f1_val': 0.9559641259850362, 'auprc': 0.9935306077002504, 'loss_val': 0.10730041124413338, 'psi': 0.9709907186711219}
[S4] START round=41 head_norm_before_train=2.053452 (no previous merge yet)
[S4] round=41 local utility u=0.025686 metrics={'f1_val': 0.9518541892366101, 'auprc': 0.9481636857718874, 'loss_val': 0.29241009857477346, 'psi': 0.950377987850721}-{'f1_val': 0.9481535780880691, 'auprc': 0.9394131827633742, 'loss_val': 0.29532730245952843, 'psi': 0.9446574199581911}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=41 head_norm_before_train=1.711142 cos_to_last_merge=0.7758 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.776
[S5] round=41 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9935488832208705, 'loss_val': 0.05363188701276878, 'psi': 0.9952198404664823}-{'f1_val': 0.9967728679684698, 'auprc': 0.9981778169994723, 'loss_val': 0.05349111429358409, 'psi': 0.9973348475808708}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=41 head_norm_before_train=1.524014 cos_to_last_merge=0.9993 (last merge round=38)
[S6] round=41 local utility u=1.000000 metrics={'f1_val': 0.8684783706561472, 'auprc': 0.9577049067637762, 'loss_val': 0.3320602805586429, 'psi': 0.9041689850991987}-{'f1_val': 0.6381264482809194, 'auprc': 0.8874428897523317, 'loss_val': 0.7863778500237116, 'psi': 0.7378530248694843}
[S7] START round=41 head_norm_before_train=1.556205 cos_to_last_merge=0.9995 (last merge round=34)
[S7] round=41 local utility u=0.000000 metrics={'f1_val': 0.4220010124882133, 'auprc': 0.7675051102673407, 'loss_val': 1.157431697811198, 'psi': 0.5602026515998644}-{'f1_val': 0.6559601581292657, 'auprc': 0.7969676561909889, 'loss_val': 0.4876164520875084, 'psi': 0.712363157353955}
[S8] START round=41 head_norm_before_train=1.706397 cos_to_last_merge=1.0000 (last merge round=39)
[S8] round=41 local utility u=0.056295 metrics={'f1_val': 0.9941986149874398, 'auprc': 0.9985671993458427, 'loss_val': 0.029701847607005002, 'psi': 0.995946048730801}-{'f1_val': 0.9803445257975303, 'auprc': 0.9973807868167452, 'loss_val': 0.055607723893364075, 'psi': 0.9871590302052162}
[S9] START round=41 head_norm_before_train=1.667169 cos_to_last_merge=1.0000 (last merge round=39)
[S9] round=41 local utility u=0.026970 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.996129406795194, 'loss_val': 0.03321624058384706, 'psi': 0.9967135102253633}-{'f1_val': 0.9897381162675762, 'auprc': 0.998411904159599, 'loss_val': 0.04981484617627563, 'psi': 0.9932076314243853}
[S10] START round=41 head_norm_before_train=2.178899 cos_to_last_merge=1.0000 (last merge round=38)
[S10] round=41 local utility u=0.000185 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9962110389838548, 'loss_val': 0.023112474217023275, 'psi': 0.9955971190051667}-{'f1_val': 0.9951878390193748, 'auprc': 0.9961862320951359, 'loss_val': 0.023408542774691836, 'psi': 0.9955871962496792}
[S11] START round=41 head_norm_before_train=1.684472 cos_to_last_merge=0.9999 (last merge round=39)
[S11] round=41 local utility u=0.001802 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9982614384283762, 'loss_val': 0.04385667108250412, 'psi': 0.9974831293470967}-{'f1_val': 0.9969642566262439, 'auprc': 0.9982905231744368, 'loss_val': 0.047548872880961025, 'psi': 0.997494763245521}
[S13] START round=41 head_norm_before_train=1.547651 cos_to_last_merge=0.9864 (last merge round=34)
[S13] round=41 local utility u=0.000000 metrics={'f1_val': 0.6471772322878131, 'auprc': 0.6487637761051295, 'loss_val': 0.9600012951325889, 'psi': 0.6478118498147396}-{'f1_val': 0.6678852650133666, 'auprc': 0.6784250641888327, 'loss_val': 0.8814549998492505, 'psi': 0.6721011846835531}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=41 head_norm_before_train=2.186693 cos_to_last_merge=1.0000 (last merge round=39)
[S14] round=41 local utility u=0.004605 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9992043291483352, 'loss_val': 0.023171995440578068, 'psi': 0.9982724024892462}-{'f1_val': 0.9976511180498535, 'auprc': 0.9975057079998058, 'loss_val': 0.027286713140118497, 'psi': 0.9975929540298345}
[S15] START round=41 head_norm_before_train=1.672652 cos_to_last_merge=1.0000 (last merge round=39)
[S15] round=41 local utility u=1.000000 metrics={'f1_val': 0.9744931657485024, 'auprc': 0.9921467840241112, 'loss_val': 0.058869910669739574, 'psi': 0.9815546130587458}-{'f1_val': 0.7004174622349693, 'auprc': 0.7381240153026227, 'loss_val': 0.6252403105404969, 'psi': 0.7155000834620306}
[S16] START round=41 head_norm_before_train=1.628192 cos_to_last_merge=0.9996 (last merge round=37)
[S16] round=41 local utility u=0.001731 metrics={'f1_val': 0.9933235837495409, 'auprc': 0.9990005241103033, 'loss_val': 0.03486258036819579, 'psi': 0.9955943598938458}-{'f1_val': 0.992885629362925, 'auprc': 0.99901057233916, 'loss_val': 0.03572669230732071, 'psi': 0.995335606553419}
[S17] START round=41 head_norm_before_train=1.525590 cos_to_last_merge=0.9994 (last merge round=38)
[S17] round=41 local utility u=0.000000 metrics={'f1_val': 0.5887528498486294, 'auprc': 0.8678286481203207, 'loss_val': 1.07515181528948, 'psi': 0.7003831691573059}-{'f1_val': 0.6893701357069805, 'auprc': 0.879208364199657, 'loss_val': 0.8542800328152923, 'psi': 0.7653054271040511}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:52803
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:52810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:52811
[S2] not sending this round → trigger blocked (psi=0.750)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:52812
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:52802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:52808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:52814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:52815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:52817
[S10] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1799) from S15
[S9] cosine check vs S15: cos=0.9998
[S15] RECEIVED delta(kind=head bytes=1799) from S9
[S15] cosine check vs S9: cos=0.9998
[S17] RECEIVED delta(kind=head bytes=1799) from S6
[S17] cosine check vs S6: cos=0.9957
[S7] RECEIVED delta(kind=head bytes=1801) from S16
[S7] cosine check vs S16: cos=0.9966
[S14] RECEIVED delta(kind=head bytes=1799) from S10
[S14] cosine check vs S10: cos=0.9998
[S10] RECEIVED delta(kind=head bytes=1803) from S14
[S10] cosine check vs S14: cos=0.9998
[S2] RECEIVED delta(kind=head bytes=1799) from S8
[S2] cosine check vs S8: cos=0.9992
[S3] RECEIVED delta(kind=head bytes=1798) from S11
[S3] cosine check vs S11: cos=0.9991
[S11] RECEIVED delta(kind=head bytes=1802) from S3
[S11] cosine check vs S3: cos=0.9991
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=41 metric=0.8685 head_norm=1.554417
[S6] _apply_head_vector_avg (torch): Δ‖w‖=6.695583e-02
[S6] stored merged vector for next round verification (round=41)
[S6] DEBUG after merge:  round=41 metric=0.8643 head_norm=1.538615 delta_norm=0.066956
[S6] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=41 metric=0.9971 head_norm=1.679893
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.828402e-02
[S9] stored merged vector for next round verification (round=41)
[S9] DEBUG after merge:  round=41 metric=0.9971 head_norm=1.682694 delta_norm=0.018284
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=41 metric=0.9970 head_norm=1.703793
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.717855e-02
[S11] stored merged vector for next round verification (round=41)
[S11] DEBUG after merge:  round=41 metric=0.9970 head_norm=1.711444 delta_norm=0.037179
[S11] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=41 metric=0.9745 head_norm=1.685689
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.828403e-02
[S15] stored merged vector for next round verification (round=41)
[S15] DEBUG after merge:  round=41 metric=0.9732 head_norm=1.682694 delta_norm=0.018284
[S15] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=41 metric=0.9747 head_norm=1.719864
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.717856e-02
[S3] stored merged vector for next round verification (round=41)
[S3] DEBUG after merge:  round=41 metric=0.9743 head_norm=1.711444 delta_norm=0.037179
[S3] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=41 metric=0.9942 head_norm=1.717371
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.354503e-02
[S8] stored merged vector for next round verification (round=41)
[S8] DEBUG after merge:  round=41 metric=0.9942 head_norm=1.729051 delta_norm=0.023545
[S8] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=41 metric=0.9933 head_norm=1.644478
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.722615e-02
[S16] stored merged vector for next round verification (round=41)
[S16] DEBUG after merge:  round=41 metric=0.9935 head_norm=1.599086 delta_norm=0.077226
[S16] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=41 metric=0.9952 head_norm=2.182396
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.125745e-02
[S10] stored merged vector for next round verification (round=41)
[S10] DEBUG after merge:  round=41 metric=0.9952 head_norm=2.188395 delta_norm=0.021257
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=41 metric=0.9977 head_norm=2.194583
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.125745e-02
[S14] stored merged vector for next round verification (round=41)
[S14] DEBUG after merge:  round=41 metric=0.9977 head_norm=2.188395 delta_norm=0.021257
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=41 metric=0.5888 head_norm=1.545020
[S17] _apply_head_vector_avg (torch): Δ‖w‖=7.238612e-02
[S17] stored merged vector for next round verification (round=41)
[S17] DEBUG after merge:  round=41 metric=0.5888 head_norm=1.548034 delta_norm=0.072386
[S17] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=42 head_norm_before_train=1.785944 cos_to_last_merge=0.9965 (last merge round=38)
[S2] round=42 local utility u=0.000000 metrics={'f1_val': 0.5862727801207995, 'auprc': 0.7706124796198669, 'loss_val': 1.345945180537318, 'psi': 0.6600086599204265}-{'f1_val': 0.701583553858809, 'auprc': 0.8221879669862565, 'loss_val': 0.6358141639635069, 'psi': 0.749825319109788}
[S3] START round=42 head_norm_before_train=1.711444 cos_to_last_merge=1.0000 (last merge round=41)
[S3] round=42 local utility u=0.030620 metrics={'f1_val': 0.9834700229051168, 'auprc': 0.9995197764407234, 'loss_val': 0.04985393302155623, 'psi': 0.9898899243193594}-{'f1_val': 0.9747179186294904, 'auprc': 0.9994650674142063, 'loss_val': 0.058416305941902835, 'psi': 0.9846167781433768}
[S4] START round=42 head_norm_before_train=2.064727 (no previous merge yet)
[S4] round=42 local utility u=0.000881 metrics={'f1_val': 0.9519498039699876, 'auprc': 0.9531595811091278, 'loss_val': 0.3062086926047796, 'psi': 0.9524337148256437}-{'f1_val': 0.9518541892366101, 'auprc': 0.9481636857718874, 'loss_val': 0.29241009857477346, 'psi': 0.950377987850721}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S5] START round=42 head_norm_before_train=1.719674 cos_to_last_merge=0.7748 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.775
[S5] round=42 local utility u=0.013380 metrics={'f1_val': 0.9967728679684698, 'auprc': 0.9982326534453239, 'loss_val': 0.04355844219475284, 'psi': 0.9973567821592114}-{'f1_val': 0.9963338119635569, 'auprc': 0.9935488832208705, 'loss_val': 0.05363188701276878, 'psi': 0.9952198404664823}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=42 head_norm_before_train=1.538615 cos_to_last_merge=1.0000 (last merge round=41)
[S6] round=42 local utility u=0.000000 metrics={'f1_val': 0.606875818709962, 'auprc': 0.8391435792477764, 'loss_val': 0.8991940953353043, 'psi': 0.6997829229250878}-{'f1_val': 0.8684783706561472, 'auprc': 0.9577049067637762, 'loss_val': 0.3320602805586429, 'psi': 0.9041689850991987}
[S7] START round=42 head_norm_before_train=1.562774 cos_to_last_merge=0.9993 (last merge round=34)
[S7] round=42 local utility u=1.000000 metrics={'f1_val': 0.6710444989235839, 'auprc': 0.8170759317339825, 'loss_val': 0.3990799673232157, 'psi': 0.7294570720477433}-{'f1_val': 0.4220010124882133, 'auprc': 0.7675051102673407, 'loss_val': 1.157431697811198, 'psi': 0.5602026515998644}
[S8] START round=42 head_norm_before_train=1.729051 cos_to_last_merge=1.0000 (last merge round=41)
[S8] round=42 local utility u=0.000134 metrics={'f1_val': 0.9945651807947898, 'auprc': 0.9980261874121228, 'loss_val': 0.030011173609531133, 'psi': 0.9959495834417229}-{'f1_val': 0.9941986149874398, 'auprc': 0.9985671993458427, 'loss_val': 0.029701847607005002, 'psi': 0.995946048730801}
[S9] START round=42 head_norm_before_train=1.682694 cos_to_last_merge=1.0000 (last merge round=41)
[S9] round=42 local utility u=0.000000 metrics={'f1_val': 0.9947734239942433, 'auprc': 0.9987323695894259, 'loss_val': 0.035192158205308986, 'psi': 0.9963570022323164}-{'f1_val': 0.9971029125121428, 'auprc': 0.996129406795194, 'loss_val': 0.03321624058384706, 'psi': 0.9967135102253633}
[S10] START round=42 head_norm_before_train=2.188395 cos_to_last_merge=1.0000 (last merge round=41)
[S10] round=42 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9961975092616419, 'loss_val': 0.023238562352246403, 'psi': 0.9955917071162816}-{'f1_val': 0.9951878390193748, 'auprc': 0.9962110389838548, 'loss_val': 0.023112474217023275, 'psi': 0.9955971190051667}
[S11] START round=42 head_norm_before_train=1.711444 cos_to_last_merge=1.0000 (last merge round=41)
[S11] round=42 local utility u=0.001069 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9981552159724372, 'loss_val': 0.04140091251250374, 'psi': 0.9974406403647211}-{'f1_val': 0.9969642566262439, 'auprc': 0.9982614384283762, 'loss_val': 0.04385667108250412, 'psi': 0.9974831293470967}
[S13] START round=42 head_norm_before_train=1.562986 cos_to_last_merge=0.9846 (last merge round=34)
[S13] round=42 local utility u=0.000000 metrics={'f1_val': 0.6421698461848462, 'auprc': 0.6678214060099873, 'loss_val': 1.023824562746424, 'psi': 0.6524304701149026}-{'f1_val': 0.6471772322878131, 'auprc': 0.6487637761051295, 'loss_val': 0.9600012951325889, 'psi': 0.6478118498147396}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=42 head_norm_before_train=2.188395 cos_to_last_merge=1.0000 (last merge round=41)
[S14] round=42 local utility u=0.000000 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9975078986423485, 'loss_val': 0.023496330823565604, 'psi': 0.9972016643515385}-{'f1_val': 0.9976511180498535, 'auprc': 0.9992043291483352, 'loss_val': 0.023171995440578068, 'psi': 0.9982724024892462}
[S15] START round=42 head_norm_before_train=1.682694 cos_to_last_merge=1.0000 (last merge round=41)
[S15] round=42 local utility u=0.000000 metrics={'f1_val': 0.8893078584145211, 'auprc': 0.9824573248133537, 'loss_val': 0.27753319232878726, 'psi': 0.9265676449740541}-{'f1_val': 0.9744931657485024, 'auprc': 0.9921467840241112, 'loss_val': 0.058869910669739574, 'psi': 0.9815546130587458}
[S16] START round=42 head_norm_before_train=1.599086 cos_to_last_merge=1.0000 (last merge round=41)
[S16] round=42 local utility u=0.000000 metrics={'f1_val': 0.992885629362925, 'auprc': 0.9988794295117011, 'loss_val': 0.03709561137732566, 'psi': 0.9952831494224355}-{'f1_val': 0.9933235837495409, 'auprc': 0.9990005241103033, 'loss_val': 0.03486258036819579, 'psi': 0.9955943598938458}
[S17] START round=42 head_norm_before_train=1.548034 cos_to_last_merge=1.0000 (last merge round=41)
[S17] round=42 local utility u=0.678890 metrics={'f1_val': 0.7126116470906263, 'auprc': 0.9752643380486348, 'loss_val': 0.7828308433173856, 'psi': 0.8176727234738297}-{'f1_val': 0.5887528498486294, 'auprc': 0.8678286481203207, 'loss_val': 1.07515181528948, 'psi': 0.7003831691573059}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:52802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:52812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] sending update (kind=head size=1796 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:52803
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=42 metric=0.6710 head_norm=1.568402
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.845775e-02
[S7] stored merged vector for next round verification (round=42)
[S7] DEBUG after merge:  round=42 metric=0.6749 head_norm=1.604973 delta_norm=0.078458
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S8] sending update (kind=head size=1796 to 1 peers)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=42 metric=0.5863 head_norm=1.818965
[S2] _apply_head_vector_avg (torch): Δ‖w‖=6.988280e-02
[S2] stored merged vector for next round verification (round=42)
[S2] DEBUG after merge:  round=42 metric=0.5863 head_norm=1.767516 delta_norm=0.069883
[S2] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:52807
[S11] RECEIVED delta(kind=head bytes=1798) from S3
[S11] cosine check vs S3: cos=0.9998
[S3] RECEIVED delta(kind=head bytes=1803) from S11
[S3] cosine check vs S11: cos=0.9998
[S2] RECEIVED delta(kind=head bytes=1796) from S8
[S2] cosine check vs S8: cos=0.9997
[S17] sending update (kind=head size=1802 to 1 peers)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=42 metric=0.9835 head_norm=1.734144
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.572847e-02
[S3] stored merged vector for next round verification (round=42)
[S3] DEBUG after merge:  round=42 metric=0.9835 head_norm=1.731970 delta_norm=0.015728
[S3] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=42 metric=0.9970 head_norm=1.729936
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.572848e-02
[S11] stored merged vector for next round verification (round=42)
[S11] DEBUG after merge:  round=42 metric=0.9970 head_norm=1.731970 delta_norm=0.015728
[S11] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S6] RECEIVED delta(kind=head bytes=1802) from S17
[S6] cosine check vs S17: cos=0.9996
[S2] START round=43 head_norm_before_train=1.767516 cos_to_last_merge=1.0000 (last merge round=42)
[S2] round=43 local utility u=0.775640 metrics={'f1_val': 0.7216740550627047, 'auprc': 0.7998776710333656, 'loss_val': 0.6948677308498955, 'psi': 0.752955501450969}-{'f1_val': 0.5862727801207995, 'auprc': 0.7706124796198669, 'loss_val': 1.345945180537318, 'psi': 0.6600086599204265}
[S3] START round=43 head_norm_before_train=1.731970 cos_to_last_merge=1.0000 (last merge round=42)
[S3] round=43 local utility u=0.000000 metrics={'f1_val': 0.9587802750969339, 'auprc': 0.9870297731027241, 'loss_val': 0.10656455363138236, 'psi': 0.9700800742992499}-{'f1_val': 0.9834700229051168, 'auprc': 0.9995197764407234, 'loss_val': 0.04985393302155623, 'psi': 0.9898899243193594}
[S4] START round=43 head_norm_before_train=2.071038 (no previous merge yet)
[S4] round=43 local utility u=0.000000 metrics={'f1_val': 0.9400253765123638, 'auprc': 0.941667182423977, 'loss_val': 0.30684341308725854, 'psi': 0.940682098877009}-{'f1_val': 0.9519498039699876, 'auprc': 0.9531595811091278, 'loss_val': 0.3062086926047796, 'psi': 0.9524337148256437}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=43 head_norm_before_train=1.735605 cos_to_last_merge=0.7730 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.773
[S5] round=43 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9968274275081079, 'loss_val': 0.03999178909186983, 'psi': 0.9965312581813772}-{'f1_val': 0.9967728679684698, 'auprc': 0.9982326534453239, 'loss_val': 0.04355844219475284, 'psi': 0.9973567821592114}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=43 head_norm_before_train=1.565207 cos_to_last_merge=0.9999 (last merge round=41)
[S6] round=43 local utility u=0.970298 metrics={'f1_val': 0.8183371378207485, 'auprc': 0.9099042227504781, 'loss_val': 0.4396478377993824, 'psi': 0.8549639717926403}-{'f1_val': 0.606875818709962, 'auprc': 0.8391435792477764, 'loss_val': 0.8991940953353043, 'psi': 0.6997829229250878}
[S7] START round=43 head_norm_before_train=1.604973 cos_to_last_merge=1.0000 (last merge round=42)
[S7] round=43 local utility u=0.000000 metrics={'f1_val': 0.4661994306817905, 'auprc': 0.7738959706599695, 'loss_val': 0.9665645758112278, 'psi': 0.589278046673062}-{'f1_val': 0.6710444989235839, 'auprc': 0.8170759317339825, 'loss_val': 0.3990799673232157, 'psi': 0.7294570720477433}
[S8] START round=43 head_norm_before_train=1.739478 cos_to_last_merge=1.0000 (last merge round=41)
[S8] round=43 local utility u=0.000000 metrics={'f1_val': 0.9670208421745561, 'auprc': 0.9984307338764705, 'loss_val': 0.08312010533661923, 'psi': 0.9795847988553219}-{'f1_val': 0.9945651807947898, 'auprc': 0.9980261874121228, 'loss_val': 0.030011173609531133, 'psi': 0.9959495834417229}
[S9] START round=43 head_norm_before_train=1.694880 cos_to_last_merge=1.0000 (last merge round=41)
[S9] round=43 local utility u=0.007265 metrics={'f1_val': 0.9966891482978385, 'auprc': 0.9983623532053332, 'loss_val': 0.03104701894517859, 'psi': 0.9973584302608364}-{'f1_val': 0.9947734239942433, 'auprc': 0.9987323695894259, 'loss_val': 0.035192158205308986, 'psi': 0.9963570022323164}
[S10] START round=43 head_norm_before_train=2.195365 cos_to_last_merge=1.0000 (last merge round=41)
[S10] round=43 local utility u=0.000115 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9962052728511771, 'loss_val': 0.023031989154981544, 'psi': 0.9955948125520957}-{'f1_val': 0.9951878390193748, 'auprc': 0.9961975092616419, 'loss_val': 0.023238562352246403, 'psi': 0.9955917071162816}
[S11] START round=43 head_norm_before_train=1.731970 cos_to_last_merge=1.0000 (last merge round=42)
[S11] round=43 local utility u=0.001580 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9983219082425165, 'loss_val': 0.03874104787958856, 'psi': 0.9975073172727529}-{'f1_val': 0.9969642566262439, 'auprc': 0.9981552159724372, 'loss_val': 0.04140091251250374, 'psi': 0.9974406403647211}
[S13] START round=43 head_norm_before_train=1.574707 cos_to_last_merge=0.9831 (last merge round=34)
[S13] round=43 local utility u=0.261492 metrics={'f1_val': 0.6745802137167636, 'auprc': 0.7192518923173308, 'loss_val': 0.8495950720296727, 'psi': 0.6924488851569904}-{'f1_val': 0.6421698461848462, 'auprc': 0.6678214060099873, 'loss_val': 1.023824562746424, 'psi': 0.6524304701149026}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=43 head_norm_before_train=2.196343 cos_to_last_merge=1.0000 (last merge round=41)
[S14] round=43 local utility u=0.000000 metrics={'f1_val': 0.9965760575063591, 'auprc': 0.9970791074163013, 'loss_val': 0.037184513579806025, 'psi': 0.9967772774703361}-{'f1_val': 0.9969975081576651, 'auprc': 0.9975078986423485, 'loss_val': 0.023496330823565604, 'psi': 0.9972016643515385}
[S15] START round=43 head_norm_before_train=1.696139 cos_to_last_merge=1.0000 (last merge round=41)
[S15] round=43 local utility u=0.000000 metrics={'f1_val': 0.8010596295475013, 'auprc': 0.91537021351936, 'loss_val': 0.4524140152115776, 'psi': 0.8467838631362448}-{'f1_val': 0.8893078584145211, 'auprc': 0.9824573248133537, 'loss_val': 0.27753319232878726, 'psi': 0.9265676449740541}
[S16] START round=43 head_norm_before_train=1.615774 cos_to_last_merge=1.0000 (last merge round=41)
[S16] round=43 local utility u=0.000163 metrics={'f1_val': 0.992885629362925, 'auprc': 0.9988738874380156, 'loss_val': 0.03675269973502716, 'psi': 0.9952809325929612}-{'f1_val': 0.992885629362925, 'auprc': 0.9988794295117011, 'loss_val': 0.03709561137732566, 'psi': 0.9952831494224355}
[S17] START round=43 head_norm_before_train=1.568759 cos_to_last_merge=0.9999 (last merge round=41)
[S17] round=43 local utility u=0.000000 metrics={'f1_val': 0.5459172476536144, 'auprc': 0.7413652033766392, 'loss_val': 1.2097855706326799, 'psi': 0.6240964299428243}-{'f1_val': 0.7126116470906263, 'auprc': 0.9752643380486348, 'loss_val': 0.7828308433173856, 'psi': 0.8176727234738297}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:52803
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:52817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:52815
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:52808
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:52814
[S16] sending update (kind=head size=1803 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1794 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1794) from S11
[S3] cosine check vs S11: cos=0.9998
[S15] RECEIVED delta(kind=head bytes=1797) from S9
[S15] cosine check vs S9: cos=0.9998
[S17] RECEIVED delta(kind=head bytes=1798) from S6
[S17] cosine check vs S6: cos=0.9987
[S8] RECEIVED delta(kind=head bytes=1798) from S2
[S8] cosine check vs S2: cos=0.9992
[S7] RECEIVED delta(kind=head bytes=1803) from S16
[S7] cosine check vs S16: cos=0.9998
[S14] RECEIVED delta(kind=head bytes=1798) from S10
[S14] cosine check vs S10: cos=0.9999
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=43 metric=0.8183 head_norm=1.592277
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.438733e-02
[S6] stored merged vector for next round verification (round=43)
[S6] DEBUG after merge:  round=43 metric=0.8212 head_norm=1.580188 delta_norm=0.034387
[S6] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=43 metric=0.7217 head_norm=1.796553
[S2] _apply_head_vector_avg (torch): Δ‖w‖=4.361081e-02
[S2] stored merged vector for next round verification (round=43)
[S2] DEBUG after merge:  round=43 metric=0.7209 head_norm=1.767707 delta_norm=0.043611
[S2] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=43 metric=0.5459 head_norm=1.586672
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.040311e-02
[S17] stored merged vector for next round verification (round=43)
[S17] DEBUG after merge:  round=43 metric=0.5459 head_norm=1.588964 delta_norm=0.040403
[S17] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=44 head_norm_before_train=1.767707 cos_to_last_merge=1.0000 (last merge round=43)
[S2] round=44 local utility u=0.105205 metrics={'f1_val': 0.7134562631630185, 'auprc': 0.8589751697836083, 'loss_val': 0.6124442057377114, 'psi': 0.7716638258112545}-{'f1_val': 0.7216740550627047, 'auprc': 0.7998776710333656, 'loss_val': 0.6948677308498955, 'psi': 0.752955501450969}
[S3] START round=44 head_norm_before_train=1.754492 cos_to_last_merge=0.9999 (last merge round=42)
[S3] round=44 local utility u=0.000000 metrics={'f1_val': 0.9099470148019679, 'auprc': 0.968922195304456, 'loss_val': 0.2012771142163928, 'psi': 0.9335370870029631}-{'f1_val': 0.9587802750969339, 'auprc': 0.9870297731027241, 'loss_val': 0.10656455363138236, 'psi': 0.9700800742992499}
[S4] START round=44 head_norm_before_train=2.077130 (no previous merge yet)
[S4] round=44 local utility u=0.020286 metrics={'f1_val': 0.9447167441004631, 'auprc': 0.9455795449547, 'loss_val': 0.30615690125414863, 'psi': 0.9450618644421579}-{'f1_val': 0.9400253765123638, 'auprc': 0.941667182423977, 'loss_val': 0.30684341308725854, 'psi': 0.940682098877009}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=44 head_norm_before_train=1.753995 cos_to_last_merge=0.7706 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.771
[S5] round=44 local utility u=0.001801 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9971626200243536, 'loss_val': 0.03739607798804753, 'psi': 0.9966653351878756}-{'f1_val': 0.9963338119635569, 'auprc': 0.9968274275081079, 'loss_val': 0.03999178909186983, 'psi': 0.9965312581813772}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S5] sending update (kind=head size=1806 to 1 peers)
[S6] START round=44 head_norm_before_train=1.580188 cos_to_last_merge=1.0000 (last merge round=43)
[S6] round=44 local utility u=0.000000 metrics={'f1_val': 0.7954942603471399, 'auprc': 0.9447516988334596, 'loss_val': 0.468623248776207, 'psi': 0.8551972357416677}-{'f1_val': 0.8183371378207485, 'auprc': 0.9099042227504781, 'loss_val': 0.4396478377993824, 'psi': 0.8549639717926403}
[S7] START round=44 head_norm_before_train=1.609681 cos_to_last_merge=1.0000 (last merge round=42)
[S7] round=44 local utility u=0.528487 metrics={'f1_val': 0.5866504994763259, 'auprc': 0.7789719609061719, 'loss_val': 0.6475251657599901, 'psi': 0.6635790840482643}-{'f1_val': 0.4661994306817905, 'auprc': 0.7738959706599695, 'loss_val': 0.9665645758112278, 'psi': 0.589278046673062}
[S8] START round=44 head_norm_before_train=1.751857 cos_to_last_merge=0.9999 (last merge round=41)
[S8] round=44 local utility u=0.109980 metrics={'f1_val': 0.9942788405856967, 'auprc': 0.9986523232179105, 'loss_val': 0.02737217918943908, 'psi': 0.9960282336385823}-{'f1_val': 0.9670208421745561, 'auprc': 0.9984307338764705, 'loss_val': 0.08312010533661923, 'psi': 0.9795847988553219}
[S9] START round=44 head_norm_before_train=1.706228 cos_to_last_merge=0.9999 (last merge round=41)
[S9] round=44 local utility u=0.000000 metrics={'f1_val': 0.9958601375429889, 'auprc': 0.9985296388972298, 'loss_val': 0.02991799587351549, 'psi': 0.9969279380846852}-{'f1_val': 0.9966891482978385, 'auprc': 0.9983623532053332, 'loss_val': 0.03104701894517859, 'psi': 0.9973584302608364}
[S10] START round=44 head_norm_before_train=2.200083 cos_to_last_merge=1.0000 (last merge round=41)
[S10] round=44 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.996188079885386, 'loss_val': 0.023024978130841298, 'psi': 0.9955879353657793}-{'f1_val': 0.9951878390193748, 'auprc': 0.9962052728511771, 'loss_val': 0.023031989154981544, 'psi': 0.9955948125520957}
[S11] START round=44 head_norm_before_train=1.749892 cos_to_last_merge=0.9999 (last merge round=42)
[S11] round=44 local utility u=0.001169 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9982949281498672, 'loss_val': 0.036321920467197254, 'psi': 0.9974965252356931}-{'f1_val': 0.9969642566262439, 'auprc': 0.9983219082425165, 'loss_val': 0.03874104787958856, 'psi': 0.9975073172727529}
[S13] START round=44 head_norm_before_train=1.592053 cos_to_last_merge=0.9811 (last merge round=34)
[S13] round=44 local utility u=0.030729 metrics={'f1_val': 0.7193088334553426, 'auprc': 0.689232927869174, 'loss_val': 0.966451195320634, 'psi': 0.7072784712208752}-{'f1_val': 0.6745802137167636, 'auprc': 0.7192518923173308, 'loss_val': 0.8495950720296727, 'psi': 0.6924488851569904}
[S13] not sending this round → trigger blocked (psi=0.707)
[S14] START round=44 head_norm_before_train=2.203896 cos_to_last_merge=1.0000 (last merge round=41)
[S14] round=44 local utility u=0.010040 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9975127813642318, 'loss_val': 0.02341459772110076, 'psi': 0.9974517091063897}-{'f1_val': 0.9965760575063591, 'auprc': 0.9970791074163013, 'loss_val': 0.037184513579806025, 'psi': 0.9967772774703361}
[S15] START round=44 head_norm_before_train=1.711679 cos_to_last_merge=0.9999 (last merge round=41)
[S15] round=44 local utility u=0.689310 metrics={'f1_val': 0.9367630757419951, 'auprc': 0.9935305157237206, 'loss_val': 0.1224961740254042, 'psi': 0.9594700517346854}-{'f1_val': 0.8010596295475013, 'auprc': 0.91537021351936, 'loss_val': 0.4524140152115776, 'psi': 0.8467838631362448}
[S16] START round=44 head_norm_before_train=1.629653 cos_to_last_merge=0.9999 (last merge round=41)
[S16] round=44 local utility u=0.000000 metrics={'f1_val': 0.9424048531846781, 'auprc': 0.9913178497081084, 'loss_val': 0.1899229267964453, 'psi': 0.9619700517940503}-{'f1_val': 0.992885629362925, 'auprc': 0.9988738874380156, 'loss_val': 0.03675269973502716, 'psi': 0.9952809325929612}
[S17] START round=44 head_norm_before_train=1.588964 cos_to_last_merge=1.0000 (last merge round=43)
[S17] round=44 local utility u=0.365794 metrics={'f1_val': 0.5863890527336129, 'auprc': 0.856032957765437, 'loss_val': 1.0650316142851222, 'psi': 0.6942466147463425}-{'f1_val': 0.5459172476536144, 'auprc': 0.7413652033766392, 'loss_val': 1.2097855706326799, 'psi': 0.6240964299428243}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.997)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.772)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:52810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:52811
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S2@127.0.0.1:52802
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=44 metric=0.9099 head_norm=1.775291
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.038020e-02
[S3] stored merged vector for next round verification (round=44)
[S3] DEBUG after merge:  round=44 metric=0.9104 head_norm=1.762376 delta_norm=0.030380
[S3] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S8] sending update (kind=head size=1794 to 1 peers)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=44 metric=0.5867 head_norm=1.614043
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.908697e-02
[S7] stored merged vector for next round verification (round=44)
[S7] DEBUG after merge:  round=44 metric=0.5833 head_norm=1.621755 delta_norm=0.019087
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:52807
[S2] RECEIVED delta(kind=head bytes=1794) from S8
[S2] cosine check vs S8: cos=0.9991
[S9] RECEIVED delta(kind=head bytes=1795) from S15
[S9] cosine check vs S15: cos=0.9996
[S10] RECEIVED delta(kind=head bytes=1801) from S14
[S10] cosine check vs S14: cos=0.9998
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=44 metric=0.9943 head_norm=1.761133
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.213409e-02
[S8] stored merged vector for next round verification (round=44)
[S8] DEBUG after merge:  round=44 metric=0.9943 head_norm=1.778432 delta_norm=0.042134
[S8] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=44 metric=0.9974 head_norm=2.212512
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.791818e-02
[S14] stored merged vector for next round verification (round=44)
[S14] DEBUG after merge:  round=44 metric=0.9974 head_norm=2.206234 delta_norm=0.017918
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S17] sending update (kind=head size=1801 to 1 peers)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=44 metric=0.9368 head_norm=1.724894
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.315533e-02
[S15] stored merged vector for next round verification (round=44)
[S15] DEBUG after merge:  round=44 metric=0.9352 head_norm=1.715430 delta_norm=0.023155
[S15] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S6] RECEIVED delta(kind=head bytes=1801) from S17
[S6] cosine check vs S17: cos=0.9996
[S2] START round=45 head_norm_before_train=1.799648 cos_to_last_merge=0.9998 (last merge round=43)
[S2] round=45 local utility u=0.000000 metrics={'f1_val': 0.702568258538407, 'auprc': 0.8533689437411198, 'loss_val': 0.6504664700858257, 'psi': 0.7628885326194921}-{'f1_val': 0.7134562631630185, 'auprc': 0.8589751697836083, 'loss_val': 0.6124442057377114, 'psi': 0.7716638258112545}
[S3] START round=45 head_norm_before_train=1.762376 cos_to_last_merge=1.0000 (last merge round=44)
[S3] round=45 local utility u=0.378828 metrics={'f1_val': 0.9937519492170659, 'auprc': 0.9994768074490213, 'loss_val': 0.038114298592376646, 'psi': 0.996041892509848}-{'f1_val': 0.9099470148019679, 'auprc': 0.968922195304456, 'loss_val': 0.2012771142163928, 'psi': 0.9335370870029631}
[S4] START round=45 head_norm_before_train=2.092297 (no previous merge yet)
[S4] round=45 local utility u=0.004223 metrics={'f1_val': 0.9415180230023317, 'auprc': 0.9542661365963868, 'loss_val': 0.3045779072287117, 'psi': 0.9466172684399536}-{'f1_val': 0.9447167441004631, 'auprc': 0.9455795449547, 'loss_val': 0.30615690125414863, 'psi': 0.9450618644421579}
[S4] not sending this round → trigger blocked (psi=0.947)
[S5] START round=45 head_norm_before_train=1.767596 cos_to_last_merge=0.7685 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.769
[S5] round=45 local utility u=0.004108 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9987276432039378, 'loss_val': 0.03387447428067786, 'psi': 0.9972913444597091}-{'f1_val': 0.9963338119635569, 'auprc': 0.9971626200243536, 'loss_val': 0.03739607798804753, 'psi': 0.9966653351878756}
[S5] not sending this round → trigger blocked (psi=0.997)
[S6] START round=45 head_norm_before_train=1.613893 cos_to_last_merge=0.9999 (last merge round=43)
[S6] round=45 local utility u=0.000000 metrics={'f1_val': 0.728184496481981, 'auprc': 0.9124785490416047, 'loss_val': 0.7494572550413635, 'psi': 0.8019021175058305}-{'f1_val': 0.7954942603471399, 'auprc': 0.9447516988334596, 'loss_val': 0.468623248776207, 'psi': 0.8551972357416677}
[S7] START round=45 head_norm_before_train=1.621755 cos_to_last_merge=1.0000 (last merge round=44)
[S7] round=45 local utility u=0.000000 metrics={'f1_val': 0.5605295264465616, 'auprc': 0.7768306870398356, 'loss_val': 0.7620904267850898, 'psi': 0.6470499906838711}-{'f1_val': 0.5866504994763259, 'auprc': 0.7789719609061719, 'loss_val': 0.6475251657599901, 'psi': 0.6635790840482643}
[S8] START round=45 head_norm_before_train=1.778432 cos_to_last_merge=1.0000 (last merge round=44)
[S8] round=45 local utility u=0.002325 metrics={'f1_val': 0.9950793871653353, 'auprc': 0.9983042293217277, 'loss_val': 0.02648059666302859, 'psi': 0.9963693240278921}-{'f1_val': 0.9942788405856967, 'auprc': 0.9986523232179105, 'loss_val': 0.02737217918943908, 'psi': 0.9960282336385823}
[S9] START round=45 head_norm_before_train=1.717196 cos_to_last_merge=0.9998 (last merge round=41)
[S9] round=45 local utility u=0.000000 metrics={'f1_val': 0.9954108212552283, 'auprc': 0.9985235614771844, 'loss_val': 0.030658025080296535, 'psi': 0.9966559173440106}-{'f1_val': 0.9958601375429889, 'auprc': 0.9985296388972298, 'loss_val': 0.02991799587351549, 'psi': 0.9969279380846852}
[S10] START round=45 head_norm_before_train=2.204437 cos_to_last_merge=0.9999 (last merge round=41)
[S10] round=45 local utility u=0.000090 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9962003500686597, 'loss_val': 0.02288219761027129, 'psi': 0.9955928434390887}-{'f1_val': 0.9951878390193748, 'auprc': 0.996188079885386, 'loss_val': 0.023024978130841298, 'psi': 0.9955879353657793}
[S11] START round=45 head_norm_before_train=1.765334 cos_to_last_merge=0.9998 (last merge round=42)
[S11] round=45 local utility u=0.001055 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9982943998576637, 'loss_val': 0.03420945349886245, 'psi': 0.9974963139188118}-{'f1_val': 0.9969642566262439, 'auprc': 0.9982949281498672, 'loss_val': 0.036321920467197254, 'psi': 0.9974965252356931}
[S13] START round=45 head_norm_before_train=1.610111 cos_to_last_merge=0.9787 (last merge round=34)
[S13] round=45 local utility u=0.637257 metrics={'f1_val': 0.8019671294193427, 'auprc': 0.8251758826836588, 'loss_val': 0.5957160816878633, 'psi': 0.8112506307250691}-{'f1_val': 0.7193088334553426, 'auprc': 0.689232927869174, 'loss_val': 0.966451195320634, 'psi': 0.7072784712208752}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=45 head_norm_before_train=2.206234 cos_to_last_merge=1.0000 (last merge round=44)
[S14] round=45 local utility u=0.003018 metrics={'f1_val': 0.9971907882668205, 'auprc': 0.9994138512477123, 'loss_val': 0.02176033373615674, 'psi': 0.9980800134591773}-{'f1_val': 0.9974109942678281, 'auprc': 0.9975127813642318, 'loss_val': 0.02341459772110076, 'psi': 0.9974517091063897}
[S15] START round=45 head_norm_before_train=1.715430 cos_to_last_merge=1.0000 (last merge round=44)
[S15] round=45 local utility u=0.000000 metrics={'f1_val': 0.8006933842312296, 'auprc': 0.9147065143306183, 'loss_val': 0.4604640015665466, 'psi': 0.846298636270985}-{'f1_val': 0.9367630757419951, 'auprc': 0.9935305157237206, 'loss_val': 0.1224961740254042, 'psi': 0.9594700517346854}
[S16] START round=45 head_norm_before_train=1.642360 cos_to_last_merge=0.9997 (last merge round=41)
[S16] round=45 local utility u=0.082779 metrics={'f1_val': 0.9533214399307457, 'auprc': 0.9965131104232025, 'loss_val': 0.10544974310412362, 'psi': 0.9705981081277284}-{'f1_val': 0.9424048531846781, 'auprc': 0.9913178497081084, 'loss_val': 0.1899229267964453, 'psi': 0.9619700517940503}
[S17] START round=45 head_norm_before_train=1.602966 cos_to_last_merge=0.9999 (last merge round=43)
[S17] round=45 local utility u=1.000000 metrics={'f1_val': 0.8332566932196007, 'auprc': 0.9820356718672631, 'loss_val': 0.4796700848925047, 'psi': 0.8927682846786658}-{'f1_val': 0.5863890527336129, 'auprc': 0.856032957765437, 'loss_val': 1.0650316142851222, 'psi': 0.6942466147463425}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:52814
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.996)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:52812
[S14] not sending this round → trigger blocked (psi=0.998)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:52803
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:52808
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1801 to 1 peers)
[S17] not sending this round → trigger blocked (psi=0.893)
[S3] sending update (kind=head size=1795 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=45 metric=0.9954 head_norm=1.727762
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.889027e-02
[S9] stored merged vector for next round verification (round=45)
[S9] DEBUG after merge:  round=45 metric=0.9954 head_norm=1.726087 delta_norm=0.028890
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.012 → S15@127.0.0.1:52815
[S14] ⇄ pheromone p=0.006 → S10@127.0.0.1:52811
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=45 metric=0.7026 head_norm=1.832990
[S2] _apply_head_vector_avg (torch): Δ‖w‖=6.268345e-02
[S2] stored merged vector for next round verification (round=45)
[S2] DEBUG after merge:  round=45 metric=0.7025 head_norm=1.796327 delta_norm=0.062683
[S2] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.215 → S8@127.0.0.1:52809
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=45 metric=0.7282 head_norm=1.652872
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.527210e-02
[S6] stored merged vector for next round verification (round=45)
[S6] DEBUG after merge:  round=45 metric=0.7252 head_norm=1.627481 delta_norm=0.045272
[S6] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.276 → S17@127.0.0.1:52817
[S10] sending update (kind=head size=1795 to 1 peers)
[S8] ⇄ pheromone p=0.025 → S2@127.0.0.1:52802
[S15] ⇄ pheromone p=0.254 → S9@127.0.0.1:52810
[S7] RECEIVED delta(kind=head bytes=1798) from S16
[S7] cosine check vs S16: cos=0.9996
[S11] RECEIVED delta(kind=head bytes=1795) from S3
[S11] cosine check vs S3: cos=0.9993
[S3] RECEIVED delta(kind=head bytes=1801) from S11
[S3] cosine check vs S11: cos=0.9993
[S14] RECEIVED delta(kind=head bytes=1795) from S10
[S14] cosine check vs S10: cos=0.9999
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=45 metric=0.9938 head_norm=1.783899
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.337837e-02
[S3] stored merged vector for next round verification (round=45)
[S3] DEBUG after merge:  round=45 metric=0.9938 head_norm=1.782020 delta_norm=0.033378
[S3] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.122 → S11@127.0.0.1:52812
[S16] ⇄ pheromone p=0.031 → S7@127.0.0.1:52808
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=45 metric=0.9952 head_norm=2.211572
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.162699e-02
[S10] stored merged vector for next round verification (round=45)
[S10] DEBUG after merge:  round=45 metric=0.9952 head_norm=2.211936 delta_norm=0.021627
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.000 → S14@127.0.0.1:52814
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=45 metric=0.9970 head_norm=1.780764
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.337836e-02
[S11] stored merged vector for next round verification (round=45)
[S11] DEBUG after merge:  round=45 metric=0.9970 head_norm=1.782020 delta_norm=0.033378
[S11] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.013 → S3@127.0.0.1:52803
[S17] ⇄ pheromone p=0.437 → S6@127.0.0.1:52807
[S2] START round=46 head_norm_before_train=1.796327 cos_to_last_merge=1.0000 (last merge round=45)
[S2] round=46 local utility u=0.000000 metrics={'f1_val': 0.7097763154718957, 'auprc': 0.8248800003910639, 'loss_val': 0.622002207191685, 'psi': 0.755817789439563}-{'f1_val': 0.702568258538407, 'auprc': 0.8533689437411198, 'loss_val': 0.6504664700858257, 'psi': 0.7628885326194921}
[S3] START round=46 head_norm_before_train=1.782020 cos_to_last_merge=1.0000 (last merge round=45)
[S3] round=46 local utility u=0.000000 metrics={'f1_val': 0.9506291721765108, 'auprc': 0.9893719130703621, 'loss_val': 0.1117782451874382, 'psi': 0.9661262685340513}-{'f1_val': 0.9937519492170659, 'auprc': 0.9994768074490213, 'loss_val': 0.038114298592376646, 'psi': 0.996041892509848}
[S4] START round=46 head_norm_before_train=2.105597 (no previous merge yet)
[S4] round=46 local utility u=0.011388 metrics={'f1_val': 0.943615129981897, 'auprc': 0.958292334664161, 'loss_val': 0.30646245255910415, 'psi': 0.9494860118548025}-{'f1_val': 0.9415180230023317, 'auprc': 0.9542661365963868, 'loss_val': 0.3045779072287117, 'psi': 0.9466172684399536}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] sending update (kind=head size=1805 to 1 peers)
[S5] START round=46 head_norm_before_train=1.783741 cos_to_last_merge=0.7665 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.767
[S5] round=46 local utility u=0.000772 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9988167413640126, 'loss_val': 0.03259847723456287, 'psi': 0.9973269837237391}-{'f1_val': 0.9963338119635569, 'auprc': 0.9987276432039378, 'loss_val': 0.03387447428067786, 'psi': 0.9972913444597091}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=46 head_norm_before_train=1.627481 cos_to_last_merge=1.0000 (last merge round=45)
[S6] round=46 local utility u=0.060714 metrics={'f1_val': 0.7445775093047141, 'auprc': 0.8977739806042248, 'loss_val': 0.6822744865655835, 'psi': 0.8058560978245184}-{'f1_val': 0.728184496481981, 'auprc': 0.9124785490416047, 'loss_val': 0.7494572550413635, 'psi': 0.8019021175058305}
[S7] START round=46 head_norm_before_train=1.630674 cos_to_last_merge=1.0000 (last merge round=44)
[S7] round=46 local utility u=0.000000 metrics={'f1_val': 0.49085202112864956, 'auprc': 0.7758065484364527, 'loss_val': 0.9866643477119309, 'psi': 0.6048338320517708}-{'f1_val': 0.5605295264465616, 'auprc': 0.7768306870398356, 'loss_val': 0.7620904267850898, 'psi': 0.6470499906838711}
[S8] START round=46 head_norm_before_train=1.788113 cos_to_last_merge=1.0000 (last merge round=44)
[S8] round=46 local utility u=0.000000 metrics={'f1_val': 0.9931808101287989, 'auprc': 0.9986624431392114, 'loss_val': 0.027808722973364418, 'psi': 0.9953734633329638}-{'f1_val': 0.9950793871653353, 'auprc': 0.9983042293217277, 'loss_val': 0.02648059666302859, 'psi': 0.9963693240278921}
[S9] START round=46 head_norm_before_train=1.726087 cos_to_last_merge=1.0000 (last merge round=45)
[S9] round=46 local utility u=0.000000 metrics={'f1_val': 0.9916752349893785, 'auprc': 0.9987088206319575, 'loss_val': 0.0360579875825381, 'psi': 0.9944886692464101}-{'f1_val': 0.9954108212552283, 'auprc': 0.9985235614771844, 'loss_val': 0.030658025080296535, 'psi': 0.9966559173440106}
[S10] START round=46 head_norm_before_train=2.211936 cos_to_last_merge=1.0000 (last merge round=45)
[S10] round=46 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9961574588119017, 'loss_val': 0.023158784266274886, 'psi': 0.9955756869363854}-{'f1_val': 0.9951878390193748, 'auprc': 0.9962003500686597, 'loss_val': 0.02288219761027129, 'psi': 0.9955928434390887}
[S11] START round=46 head_norm_before_train=1.782020 cos_to_last_merge=1.0000 (last merge round=45)
[S11] round=46 local utility u=0.000490 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9982916525415483, 'loss_val': 0.0332203336783021, 'psi': 0.9974952149923656}-{'f1_val': 0.9969642566262439, 'auprc': 0.9982943998576637, 'loss_val': 0.03420945349886245, 'psi': 0.9974963139188118}
[S13] START round=46 head_norm_before_train=1.625116 cos_to_last_merge=0.9767 (last merge round=34)
[S13] round=46 local utility u=0.000000 metrics={'f1_val': 0.5616826567645435, 'auprc': 0.5683306335483487, 'loss_val': 1.4343627087226969, 'psi': 0.5643418474780656}-{'f1_val': 0.8019671294193427, 'auprc': 0.8251758826836588, 'loss_val': 0.5957160816878633, 'psi': 0.8112506307250691}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=46 head_norm_before_train=2.215663 cos_to_last_merge=1.0000 (last merge round=44)
[S14] round=46 local utility u=0.000000 metrics={'f1_val': 0.9965760575063591, 'auprc': 0.9974725666029514, 'loss_val': 0.03910367830793088, 'psi': 0.9969346611449961}-{'f1_val': 0.9971907882668205, 'auprc': 0.9994138512477123, 'loss_val': 0.02176033373615674, 'psi': 0.9980800134591773}
[S15] START round=46 head_norm_before_train=1.728389 cos_to_last_merge=1.0000 (last merge round=44)
[S15] round=46 local utility u=0.898546 metrics={'f1_val': 0.9887886891363633, 'auprc': 0.9957789741305765, 'loss_val': 0.035160872918407506, 'psi': 0.9915848031340486}-{'f1_val': 0.8006933842312296, 'auprc': 0.9147065143306183, 'loss_val': 0.4604640015665466, 'psi': 0.846298636270985}
[S16] START round=46 head_norm_before_train=1.656954 cos_to_last_merge=0.9994 (last merge round=41)
[S16] round=46 local utility u=0.158920 metrics={'f1_val': 0.9930368238508391, 'auprc': 0.9991877957116719, 'loss_val': 0.03392610060163515, 'psi': 0.9954972125951722}-{'f1_val': 0.9533214399307457, 'auprc': 0.9965131104232025, 'loss_val': 0.10544974310412362, 'psi': 0.9705981081277284}
[S17] START round=46 head_norm_before_train=1.620252 cos_to_last_merge=0.9997 (last merge round=43)
[S17] round=46 local utility u=0.000000 metrics={'f1_val': 0.5674401766439501, 'auprc': 0.7491619654575754, 'loss_val': 1.1521150682157641, 'psi': 0.6401288921694002}-{'f1_val': 0.8332566932196007, 'auprc': 0.9820356718672631, 'loss_val': 0.4796700848925047, 'psi': 0.8927682846786658}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:52817
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:52808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:52810
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:52803
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1798 to 1 peers)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=46 metric=0.9966 head_norm=2.223004
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.931309e-02
[S14] stored merged vector for next round verification (round=46)
[S14] DEBUG after merge:  round=46 metric=0.9957 head_norm=2.217211 delta_norm=0.019313
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1804 to 1 peers)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=46 metric=0.4909 head_norm=1.639705
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.838345e-02
[S7] stored merged vector for next round verification (round=46)
[S7] DEBUG after merge:  round=46 metric=0.4914 head_norm=1.648107 delta_norm=0.028383
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] RECEIVED delta(kind=head bytes=1800) from S16
[S7] cosine check vs S16: cos=0.9997
[S3] RECEIVED delta(kind=head bytes=1798) from S11
[S3] cosine check vs S11: cos=0.9999
[S9] RECEIVED delta(kind=head bytes=1799) from S15
[S9] cosine check vs S15: cos=0.9999
[S17] RECEIVED delta(kind=head bytes=1804) from S6
[S17] cosine check vs S6: cos=0.9985
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=46 metric=0.5674 head_norm=1.639091
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.597130e-02
[S17] stored merged vector for next round verification (round=46)
[S17] DEBUG after merge:  round=46 metric=0.5673 head_norm=1.647469 delta_norm=0.045971
[S17] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=47 head_norm_before_train=1.823578 cos_to_last_merge=0.9999 (last merge round=45)
[S2] round=47 local utility u=0.000000 metrics={'f1_val': 0.71054347078541, 'auprc': 0.8209815570907408, 'loss_val': 0.6242429170759136, 'psi': 0.7547187053075424}-{'f1_val': 0.7097763154718957, 'auprc': 0.8248800003910639, 'loss_val': 0.622002207191685, 'psi': 0.755817789439563}
[S3] START round=47 head_norm_before_train=1.802025 cos_to_last_merge=0.9999 (last merge round=45)
[S3] round=47 local utility u=0.000000 metrics={'f1_val': 0.9315332327237167, 'auprc': 0.9684364522713457, 'loss_val': 0.18223147923620928, 'psi': 0.9462945205427683}-{'f1_val': 0.9506291721765108, 'auprc': 0.9893719130703621, 'loss_val': 0.1117782451874382, 'psi': 0.9661262685340513}
[S4] START round=47 head_norm_before_train=2.115340 (no previous merge yet)
[S4] round=47 local utility u=0.015573 metrics={'f1_val': 0.9450667171139264, 'auprc': 0.9659790818886643, 'loss_val': 0.3070865270649253, 'psi': 0.9534316630238215}-{'f1_val': 0.943615129981897, 'auprc': 0.958292334664161, 'loss_val': 0.30646245255910415, 'psi': 0.9494860118548025}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=47 head_norm_before_train=1.798244 cos_to_last_merge=0.7648 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.765
[S5] round=47 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9962699761869211, 'loss_val': 0.03329086488006188, 'psi': 0.9963082776529025}-{'f1_val': 0.9963338119635569, 'auprc': 0.9988167413640126, 'loss_val': 0.03259847723456287, 'psi': 0.9973269837237391}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=47 head_norm_before_train=1.657081 cos_to_last_merge=0.9999 (last merge round=45)
[S6] round=47 local utility u=0.000000 metrics={'f1_val': 0.7216166669524168, 'auprc': 0.8878394079040965, 'loss_val': 0.6790016218589855, 'psi': 0.7881057633330887}-{'f1_val': 0.7445775093047141, 'auprc': 0.8977739806042248, 'loss_val': 0.6822744865655835, 'psi': 0.8058560978245184}
[S7] START round=47 head_norm_before_train=1.648107 cos_to_last_merge=1.0000 (last merge round=46)
[S7] round=47 local utility u=0.476250 metrics={'f1_val': 0.5981100592030033, 'auprc': 0.7828955955242034, 'loss_val': 0.6989794291622251, 'psi': 0.6720242737314833}-{'f1_val': 0.49085202112864956, 'auprc': 0.7758065484364527, 'loss_val': 0.9866643477119309, 'psi': 0.6048338320517708}
[S8] START round=47 head_norm_before_train=1.798446 cos_to_last_merge=0.9999 (last merge round=44)
[S8] round=47 local utility u=0.007540 metrics={'f1_val': 0.9950793871653353, 'auprc': 0.9987652427850825, 'loss_val': 0.02442877167659819, 'psi': 0.9965537294132341}-{'f1_val': 0.9931808101287989, 'auprc': 0.9986624431392114, 'loss_val': 0.027808722973364418, 'psi': 0.9953734633329638}
[S9] START round=47 head_norm_before_train=1.736476 cos_to_last_merge=1.0000 (last merge round=45)
[S9] round=47 local utility u=0.013987 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.995331365642404, 'loss_val': 0.027862937574998494, 'psi': 0.9961288533452964}-{'f1_val': 0.9916752349893785, 'auprc': 0.9987088206319575, 'loss_val': 0.0360579875825381, 'psi': 0.9944886692464101}
[S10] START round=47 head_norm_before_train=2.219837 cos_to_last_merge=1.0000 (last merge round=45)
[S10] round=47 local utility u=0.000169 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9961938922753737, 'loss_val': 0.0229302971116546, 'psi': 0.9955902603217743}-{'f1_val': 0.9951878390193748, 'auprc': 0.9961574588119017, 'loss_val': 0.023158784266274886, 'psi': 0.9955756869363854}
[S11] START round=47 head_norm_before_train=1.796892 cos_to_last_merge=1.0000 (last merge round=45)
[S11] round=47 local utility u=0.000781 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.99827973224931, 'loss_val': 0.03162260639665741, 'psi': 0.9974904468754703}-{'f1_val': 0.9969642566262439, 'auprc': 0.9982916525415483, 'loss_val': 0.0332203336783021, 'psi': 0.9974952149923656}
[S13] START round=47 head_norm_before_train=1.632884 cos_to_last_merge=0.9754 (last merge round=34)
[S13] round=47 local utility u=1.000000 metrics={'f1_val': 0.8023544661413538, 'auprc': 0.8821793808669015, 'loss_val': 0.5172868127216826, 'psi': 0.8342844320315728}-{'f1_val': 0.5616826567645435, 'auprc': 0.5683306335483487, 'loss_val': 1.4343627087226969, 'psi': 0.5643418474780656}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=47 head_norm_before_train=2.217211 cos_to_last_merge=1.0000 (last merge round=46)
[S14] round=47 local utility u=0.016162 metrics={'f1_val': 0.9980646079025537, 'auprc': 0.9992126701772532, 'loss_val': 0.020931209296342144, 'psi': 0.9985238328124335}-{'f1_val': 0.9965760575063591, 'auprc': 0.9974725666029514, 'loss_val': 0.03910367830793088, 'psi': 0.9969346611449961}
[S15] START round=47 head_norm_before_train=1.740364 cos_to_last_merge=0.9999 (last merge round=44)
[S15] round=47 local utility u=0.000000 metrics={'f1_val': 0.7689586921150723, 'auprc': 0.9150931471235788, 'loss_val': 0.5114932952010032, 'psi': 0.827412474118475}-{'f1_val': 0.9887886891363633, 'auprc': 0.9957789741305765, 'loss_val': 0.035160872918407506, 'psi': 0.9915848031340486}
[S16] START round=47 head_norm_before_train=1.668830 cos_to_last_merge=0.9991 (last merge round=41)
[S16] round=47 local utility u=0.000000 metrics={'f1_val': 0.9928180934770892, 'auprc': 0.9991506292182789, 'loss_val': 0.035094041660246995, 'psi': 0.9953511077735651}-{'f1_val': 0.9930368238508391, 'auprc': 0.9991877957116719, 'loss_val': 0.03392610060163515, 'psi': 0.9954972125951722}
[S17] START round=47 head_norm_before_train=1.647469 cos_to_last_merge=1.0000 (last merge round=46)
[S17] round=47 local utility u=1.000000 metrics={'f1_val': 0.8265519474294919, 'auprc': 0.9848105959379029, 'loss_val': 0.5307026378813419, 'psi': 0.8898554068328564}-{'f1_val': 0.5674401766439501, 'auprc': 0.7491619654575754, 'loss_val': 1.1521150682157641, 'psi': 0.6401288921694002}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:52802
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:52816
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:52803
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:52811
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:52814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:52815
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=47 metric=0.9315 head_norm=1.819422
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.473124e-02
[S3] stored merged vector for next round verification (round=47)
[S3] DEBUG after merge:  round=47 metric=0.9315 head_norm=1.808023 delta_norm=0.024731
[S3] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:52807
[S8] sending update (kind=head size=1802 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1798) from S11
[S3] cosine check vs S11: cos=0.9999
[S2] RECEIVED delta(kind=head bytes=1802) from S8
[S2] cosine check vs S8: cos=0.9992
[S14] RECEIVED delta(kind=head bytes=1800) from S10
[S14] cosine check vs S10: cos=1.0000
[S15] RECEIVED delta(kind=head bytes=1797) from S9
[S15] cosine check vs S9: cos=0.9997
[S16] RECEIVED delta(kind=head bytes=1798) from S7
[S16] cosine check vs S7: cos=0.9994
[S10] RECEIVED delta(kind=head bytes=1800) from S14
[S10] cosine check vs S14: cos=1.0000
[S17] sending update (kind=head size=1795 to 1 peers)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=47 metric=0.5981 head_norm=1.654389
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.373952e-02
[S7] stored merged vector for next round verification (round=47)
[S7] DEBUG after merge:  round=47 metric=0.5983 head_norm=1.661456 delta_norm=0.023740
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=47 metric=0.9981 head_norm=2.222429
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.128449e-03
[S14] stored merged vector for next round verification (round=47)
[S14] DEBUG after merge:  round=47 metric=0.9981 head_norm=2.224239 delta_norm=0.006128
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=47 metric=0.9952 head_norm=2.226065
[S10] _apply_head_vector_avg (torch): Δ‖w‖=6.128439e-03
[S10] stored merged vector for next round verification (round=47)
[S10] DEBUG after merge:  round=47 metric=0.9952 head_norm=2.224239 delta_norm=0.006128
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=47 metric=0.9967 head_norm=1.746932
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.847836e-02
[S9] stored merged vector for next round verification (round=47)
[S9] DEBUG after merge:  round=47 metric=0.9967 head_norm=1.743553 delta_norm=0.018478
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S6] RECEIVED delta(kind=head bytes=1795) from S17
[S6] cosine check vs S17: cos=0.9991
[S2] START round=48 head_norm_before_train=1.848667 cos_to_last_merge=0.9996 (last merge round=45)
[S2] round=48 local utility u=0.006315 metrics={'f1_val': 0.7153119649883672, 'auprc': 0.8175672462219192, 'loss_val': 0.6299811490676642, 'psi': 0.756214077481788}-{'f1_val': 0.71054347078541, 'auprc': 0.8209815570907408, 'loss_val': 0.6242429170759136, 'psi': 0.7547187053075424}
[S3] START round=48 head_norm_before_train=1.808023 cos_to_last_merge=1.0000 (last merge round=47)
[S3] round=48 local utility u=0.199141 metrics={'f1_val': 0.9651137583636428, 'auprc': 0.996810038795683, 'loss_val': 0.0705527259796455, 'psi': 0.9777922705364588}-{'f1_val': 0.9315332327237167, 'auprc': 0.9684364522713457, 'loss_val': 0.18223147923620928, 'psi': 0.9462945205427683}
[S4] START round=48 head_norm_before_train=2.126459 (no previous merge yet)
[S4] round=48 local utility u=0.010586 metrics={'f1_val': 0.9462844055730879, 'auprc': 0.9700222479037788, 'loss_val': 0.30535057096528473, 'psi': 0.9557795425053643}-{'f1_val': 0.9450667171139264, 'auprc': 0.9659790818886643, 'loss_val': 0.3070865270649253, 'psi': 0.9534316630238215}
[S4] not sending this round → trigger blocked (psi=0.956)
[S5] START round=48 head_norm_before_train=1.806692 cos_to_last_merge=0.7643 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.764
[S5] round=48 local utility u=0.004519 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9983120888202853, 'loss_val': 0.03038016523609037, 'psi': 0.9971251227062482}-{'f1_val': 0.9963338119635569, 'auprc': 0.9962699761869211, 'loss_val': 0.03329086488006188, 'psi': 0.9963082776529025}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=48 head_norm_before_train=1.681763 cos_to_last_merge=0.9997 (last merge round=45)
[S6] round=48 local utility u=0.287321 metrics={'f1_val': 0.7700096017473322, 'auprc': 0.9472234927803704, 'loss_val': 0.5728702562541297, 'psi': 0.8408951581605475}-{'f1_val': 0.7216166669524168, 'auprc': 0.8878394079040965, 'loss_val': 0.6790016218589855, 'psi': 0.7881057633330887}
[S7] START round=48 head_norm_before_train=1.661456 cos_to_last_merge=1.0000 (last merge round=47)
[S7] round=48 local utility u=0.289719 metrics={'f1_val': 0.6532157454075955, 'auprc': 0.7952368695710093, 'loss_val': 0.48719886222708375, 'psi': 0.7100241950729611}-{'f1_val': 0.5981100592030033, 'auprc': 0.7828955955242034, 'loss_val': 0.6989794291622251, 'psi': 0.6720242737314833}
[S8] START round=48 head_norm_before_train=1.805667 cos_to_last_merge=0.9999 (last merge round=44)
[S8] round=48 local utility u=0.000845 metrics={'f1_val': 0.9953657279690348, 'auprc': 0.9985936196191906, 'loss_val': 0.023942765547405157, 'psi': 0.9966568846290971}-{'f1_val': 0.9950793871653353, 'auprc': 0.9987652427850825, 'loss_val': 0.02442877167659819, 'psi': 0.9965537294132341}
[S9] START round=48 head_norm_before_train=1.743553 cos_to_last_merge=1.0000 (last merge round=47)
[S9] round=48 local utility u=0.000000 metrics={'f1_val': 0.9950237510807955, 'auprc': 0.9987157546530179, 'loss_val': 0.030242201768855937, 'psi': 0.9965005525096845}-{'f1_val': 0.9966605118138915, 'auprc': 0.995331365642404, 'loss_val': 0.027862937574998494, 'psi': 0.9961288533452964}
[S10] START round=48 head_norm_before_train=2.224239 cos_to_last_merge=1.0000 (last merge round=47)
[S10] round=48 local utility u=0.000035 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9961815456425818, 'loss_val': 0.022823397202676995, 'psi': 0.9955853216686575}-{'f1_val': 0.9951878390193748, 'auprc': 0.9961938922753737, 'loss_val': 0.0229302971116546, 'psi': 0.9955902603217743}
[S11] START round=48 head_norm_before_train=1.810483 cos_to_last_merge=0.9999 (last merge round=45)
[S11] round=48 local utility u=0.000485 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9982564763287891, 'loss_val': 0.03058223665255948, 'psi': 0.997481144507262}-{'f1_val': 0.9969642566262439, 'auprc': 0.99827973224931, 'loss_val': 0.03162260639665741, 'psi': 0.9974904468754703}
[S13] START round=48 head_norm_before_train=1.635454 cos_to_last_merge=0.9747 (last merge round=34)
[S13] round=48 local utility u=0.000000 metrics={'f1_val': 0.7599401228060325, 'auprc': 0.7782009394455162, 'loss_val': 0.8544751138338986, 'psi': 0.767244449461826}-{'f1_val': 0.8023544661413538, 'auprc': 0.8821793808669015, 'loss_val': 0.5172868127216826, 'psi': 0.8342844320315728}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=48 head_norm_before_train=2.224239 cos_to_last_merge=1.0000 (last merge round=47)
[S14] round=48 local utility u=0.000000 metrics={'f1_val': 0.9972435617623723, 'auprc': 0.9992237061025184, 'loss_val': 0.021373014185348607, 'psi': 0.9980356194984308}-{'f1_val': 0.9980646079025537, 'auprc': 0.9992126701772532, 'loss_val': 0.020931209296342144, 'psi': 0.9985238328124335}
[S15] START round=48 head_norm_before_train=1.754256 cos_to_last_merge=0.9999 (last merge round=44)
[S15] round=48 local utility u=0.674516 metrics={'f1_val': 0.9054431842867382, 'auprc': 0.993324664038149, 'loss_val': 0.2160626744467299, 'psi': 0.9405957761873025}-{'f1_val': 0.7689586921150723, 'auprc': 0.9150931471235788, 'loss_val': 0.5114932952010032, 'psi': 0.827412474118475}
[S16] START round=48 head_norm_before_train=1.682006 cos_to_last_merge=0.9987 (last merge round=41)
[S16] round=48 local utility u=0.000000 metrics={'f1_val': 0.9785800687638221, 'auprc': 0.994115764629105, 'loss_val': 0.06960411427234822, 'psi': 0.9847943471099352}-{'f1_val': 0.9928180934770892, 'auprc': 0.9991506292182789, 'loss_val': 0.035094041660246995, 'psi': 0.9953511077735651}
[S17] START round=48 head_norm_before_train=1.662753 cos_to_last_merge=1.0000 (last merge round=46)
[S17] round=48 local utility u=0.316929 metrics={'f1_val': 0.9087738193783175, 'auprc': 0.9815118160774987, 'loss_val': 0.3802787732712157, 'psi': 0.93786901805799}-{'f1_val': 0.8265519474294919, 'auprc': 0.9848105959379029, 'loss_val': 0.5307026378813419, 'psi': 0.8898554068328564}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.710)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.997)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:52810
[S10] not sending this round → trigger blocked (psi=0.996)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:52812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:52809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:52817
[S3] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S17] not sending this round → trigger blocked (psi=0.938)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=48 metric=0.9786 head_norm=1.694589
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.874455e-02
[S16] stored merged vector for next round verification (round=48)
[S16] DEBUG after merge:  round=48 metric=0.9792 head_norm=1.674162 delta_norm=0.038745
[S16] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S6] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1799) from S6
[S17] cosine check vs S6: cos=0.9985
[S9] RECEIVED delta(kind=head bytes=1795) from S15
[S9] cosine check vs S15: cos=0.9998
[S8] RECEIVED delta(kind=head bytes=1800) from S2
[S8] cosine check vs S2: cos=0.9986
[S11] RECEIVED delta(kind=head bytes=1800) from S3
[S11] cosine check vs S3: cos=0.9996
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=48 metric=0.7700 head_norm=1.694654
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.397125e-02
[S6] stored merged vector for next round verification (round=48)
[S6] DEBUG after merge:  round=48 metric=0.7719 head_norm=1.678203 delta_norm=0.043971
[S6] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=48 metric=0.7153 head_norm=1.872734
[S2] _apply_head_vector_avg (torch): Δ‖w‖=5.677135e-02
[S2] stored merged vector for next round verification (round=48)
[S2] DEBUG after merge:  round=48 metric=0.7150 head_norm=1.838630 delta_norm=0.056771
[S2] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=48 metric=0.9054 head_norm=1.767746
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.707302e-02
[S15] stored merged vector for next round verification (round=48)
[S15] DEBUG after merge:  round=48 metric=0.9054 head_norm=1.757161 delta_norm=0.027073
[S15] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=48 metric=0.9651 head_norm=1.826972
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.464847e-02
[S3] stored merged vector for next round verification (round=48)
[S3] DEBUG after merge:  round=48 metric=0.9633 head_norm=1.818579 delta_norm=0.024648
[S3] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=48 metric=0.9088 head_norm=1.679218
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.736101e-02
[S17] stored merged vector for next round verification (round=48)
[S17] DEBUG after merge:  round=48 metric=0.9088 head_norm=1.686289 delta_norm=0.047361
[S17] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=49 head_norm_before_train=1.838630 cos_to_last_merge=1.0000 (last merge round=48)
[S2] round=49 local utility u=0.059010 metrics={'f1_val': 0.7156242667176845, 'auprc': 0.8522386257716852, 'loss_val': 0.6178490842270168, 'psi': 0.7702700103392848}-{'f1_val': 0.7153119649883672, 'auprc': 0.8175672462219192, 'loss_val': 0.6299811490676642, 'psi': 0.756214077481788}
[S3] START round=49 head_norm_before_train=1.818579 cos_to_last_merge=1.0000 (last merge round=48)
[S3] round=49 local utility u=0.000000 metrics={'f1_val': 0.9581020125037736, 'auprc': 0.9875769089300571, 'loss_val': 0.12198512640647782, 'psi': 0.969891971074287}-{'f1_val': 0.9651137583636428, 'auprc': 0.996810038795683, 'loss_val': 0.0705527259796455, 'psi': 0.9777922705364588}
[S4] START round=49 head_norm_before_train=2.125443 (no previous merge yet)
[S4] round=49 local utility u=0.019896 metrics={'f1_val': 0.9535351373929718, 'auprc': 0.9687603836594474, 'loss_val': 0.3052777551343492, 'psi': 0.9596252358995621}-{'f1_val': 0.9462844055730879, 'auprc': 0.9700222479037788, 'loss_val': 0.30535057096528473, 'psi': 0.9557795425053643}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=49 head_norm_before_train=1.816523 cos_to_last_merge=0.7638 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.764
[S5] round=49 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9923253585862395, 'loss_val': 0.04716779437055541, 'psi': 0.9947304306126299}-{'f1_val': 0.9963338119635569, 'auprc': 0.9983120888202853, 'loss_val': 0.03038016523609037, 'psi': 0.9971251227062482}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=49 head_norm_before_train=1.678203 cos_to_last_merge=1.0000 (last merge round=48)
[S6] round=49 local utility u=0.025108 metrics={'f1_val': 0.7732626301158001, 'auprc': 0.9536295088944237, 'loss_val': 0.5613901382596413, 'psi': 0.8454093816272494}-{'f1_val': 0.7700096017473322, 'auprc': 0.9472234927803704, 'loss_val': 0.5728702562541297, 'psi': 0.8408951581605475}
[S7] START round=49 head_norm_before_train=1.670871 cos_to_last_merge=1.0000 (last merge round=47)
[S7] round=49 local utility u=0.000000 metrics={'f1_val': 0.6114245788365628, 'auprc': 0.7752843337096114, 'loss_val': 0.6832281700708515, 'psi': 0.6769684807857822}-{'f1_val': 0.6532157454075955, 'auprc': 0.7952368695710093, 'loss_val': 0.48719886222708375, 'psi': 0.7100241950729611}
[S8] START round=49 head_norm_before_train=1.810620 cos_to_last_merge=0.9998 (last merge round=44)
[S8] round=49 local utility u=0.000000 metrics={'f1_val': 0.993467150337892, 'auprc': 0.9983865977356632, 'loss_val': 0.02744451417131583, 'psi': 0.9954349292970005}-{'f1_val': 0.9953657279690348, 'auprc': 0.9985936196191906, 'loss_val': 0.023942765547405157, 'psi': 0.9966568846290971}
[S9] START round=49 head_norm_before_train=1.753421 cos_to_last_merge=1.0000 (last merge round=47)
[S9] round=49 local utility u=0.003554 metrics={'f1_val': 0.9960207019771873, 'auprc': 0.9986200236584303, 'loss_val': 0.028828654138456304, 'psi': 0.9970604306496844}-{'f1_val': 0.9950237510807955, 'auprc': 0.9987157546530179, 'loss_val': 0.030242201768855937, 'psi': 0.9965005525096845}
[S10] START round=49 head_norm_before_train=2.224815 cos_to_last_merge=1.0000 (last merge round=47)
[S10] round=49 local utility u=0.000114 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.996210609576923, 'loss_val': 0.022683198093663755, 'psi': 0.995596947242394}-{'f1_val': 0.9951878390193748, 'auprc': 0.9961815456425818, 'loss_val': 0.022823397202676995, 'psi': 0.9955853216686575}
[S11] START round=49 head_norm_before_train=1.822767 cos_to_last_merge=0.9997 (last merge round=45)
[S11] round=49 local utility u=0.000707 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.998301742882237, 'loss_val': 0.029304369356245002, 'psi': 0.9974992511286411}-{'f1_val': 0.9969642566262439, 'auprc': 0.9982564763287891, 'loss_val': 0.03058223665255948, 'psi': 0.997481144507262}
[S13] START round=49 head_norm_before_train=1.637974 cos_to_last_merge=0.9742 (last merge round=34)
[S13] round=49 local utility u=0.037797 metrics={'f1_val': 0.722315681565827, 'auprc': 0.860160483578478, 'loss_val': 0.7990135022944435, 'psi': 0.7774536023708875}-{'f1_val': 0.7599401228060325, 'auprc': 0.7782009394455162, 'loss_val': 0.8544751138338986, 'psi': 0.767244449461826}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=49 head_norm_before_train=2.230113 cos_to_last_merge=1.0000 (last merge round=47)
[S14] round=49 local utility u=0.000000 metrics={'f1_val': 0.9970007132142444, 'auprc': 0.9991261909208368, 'loss_val': 0.0226981008416726, 'psi': 0.9978509042968814}-{'f1_val': 0.9972435617623723, 'auprc': 0.9992237061025184, 'loss_val': 0.021373014185348607, 'psi': 0.9980356194984308}
[S15] START round=49 head_norm_before_train=1.757161 cos_to_last_merge=1.0000 (last merge round=48)
[S15] round=49 local utility u=0.000666 metrics={'f1_val': 0.9054431842867382, 'auprc': 0.9931426236229322, 'loss_val': 0.21418361121582927, 'psi': 0.9405229600212157}-{'f1_val': 0.9054431842867382, 'auprc': 0.993324664038149, 'loss_val': 0.2160626744467299, 'psi': 0.9405957761873025}
[S16] START round=49 head_norm_before_train=1.674162 cos_to_last_merge=1.0000 (last merge round=48)
[S16] round=49 local utility u=0.000000 metrics={'f1_val': 0.9409410798251728, 'auprc': 0.9904799267118571, 'loss_val': 0.20729268992506344, 'psi': 0.9607566185798465}-{'f1_val': 0.9785800687638221, 'auprc': 0.994115764629105, 'loss_val': 0.06960411427234822, 'psi': 0.9847943471099352}
[S17] START round=49 head_norm_before_train=1.686289 cos_to_last_merge=1.0000 (last merge round=48)
[S17] round=49 local utility u=0.000000 metrics={'f1_val': 0.6244127341118435, 'auprc': 0.8222554499527704, 'loss_val': 1.113510193616183, 'psi': 0.7035498204482142}-{'f1_val': 0.9087738193783175, 'auprc': 0.9815118160774987, 'loss_val': 0.3802787732712157, 'psi': 0.93786901805799}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:52803
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:52814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:52815
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.845)
[S2] not sending this round → trigger blocked (psi=0.770)
[S15] not sending this round → trigger blocked (psi=0.941)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=49 metric=0.9935 head_norm=1.817735
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.858740e-02
[S8] stored merged vector for next round verification (round=49)
[S8] DEBUG after merge:  round=49 metric=0.9935 head_norm=1.844509 delta_norm=0.058587
[S8] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S11] sending update (kind=head size=1794 to 1 peers)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] RECEIVED delta(kind=head bytes=1796) from S9
[S15] cosine check vs S9: cos=0.9999
[S14] RECEIVED delta(kind=head bytes=1798) from S10
[S14] cosine check vs S10: cos=0.9998
[S3] RECEIVED delta(kind=head bytes=1794) from S11
[S3] cosine check vs S11: cos=0.9996
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=49 metric=0.9970 head_norm=1.835431
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.137155e-02
[S11] stored merged vector for next round verification (round=49)
[S11] DEBUG after merge:  round=49 metric=0.9970 head_norm=1.830937 delta_norm=0.031372
[S11] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=49 metric=0.9960 head_norm=1.762282
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.240006e-02
[S9] stored merged vector for next round verification (round=49)
[S9] DEBUG after merge:  round=49 metric=0.9960 head_norm=1.764874 delta_norm=0.022400
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[runner] rounds complete.
[runner] all agents stopped.
