[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:59803
[S3] → join 127.0.0.1:59802
[S4] → join 127.0.0.1:59802
[S5] → join 127.0.0.1:59802
[S6] → join 127.0.0.1:59802
[S7] → join 127.0.0.1:59802
[S8] → join 127.0.0.1:59802
[S9] → join 127.0.0.1:59802
[S10] → join 127.0.0.1:59802
[S11] → join 127.0.0.1:59802
[S13] → join 127.0.0.1:59802
[S14] → join 127.0.0.1:59802
[S15] → join 127.0.0.1:59802
[S16] → join 127.0.0.1:59802
[S17] → join 127.0.0.1:59802
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.108719 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.175445 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.121490 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.232357 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.161366 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.151006 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.120733 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.153253 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.158645 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.123302 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.131026 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.124597 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.147047 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.191535 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.202853 (no previous merge yet)
[S4]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S3] + discovered S16
[S3] + discovered S15
[S3] + discovered S13
[S3] + discovered S7
[S3] + discovered S14
[S3] + discovered S4
[S3] + discovered S6
[S3] + discovered S9
[S4] + discovered S2
[S4] + discovered S3
[S3] + discovered S8
[S3] + discovered S10
[S3] + discovered S5
[S3] + discovered S17
[S3] + discovered S11
[S4] + discovered S5
[S4] + discovered S17
[S4] + discovered S10
[S4] + discovered S11
[S4] + discovered S8
[S4] + discovered S13
[S4] + discovered S16
[S4] + discovered S15
[S4] + discovered S7
[S4] + discovered S14
[S4] + discovered S9
[S5] + discovered S2
[S4] + discovered S6
[S5] + discovered S3
[S5] + discovered S4
[S6] + discovered S4
[S6] + discovered S3
[S6] + discovered S2
[S6] + discovered S5
[S5] + discovered S9
[S5] + discovered S14
[S5] + discovered S13
[S5] + discovered S11
[S5] + discovered S10
[S5] + discovered S17
[S5] + discovered S6
[S5] + discovered S7
[S5] + discovered S15
[S5] + discovered S16
[S5] + discovered S8
[S6] + discovered S10
[S6] + discovered S16
[S6] + discovered S7
[S6] + discovered S14
[S6] + discovered S13
[S6] + discovered S8
[S6] + discovered S15
[S6] + discovered S17
[S6] + discovered S11
[S6] + discovered S9
[S7] + discovered S5
[S7] + discovered S2
[S7] + discovered S6
[S7] + discovered S4
[S7] + discovered S3
[S8] + discovered S5
[S8] + discovered S4
[S8] + discovered S6
[S8] + discovered S3
[S8] + discovered S2
[S8] + discovered S7
[S7] + discovered S9
[S7] + discovered S11
[S7] + discovered S17
[S7] + discovered S15
[S7] + discovered S13
[S7] + discovered S16
[S7] + discovered S14
[S7] + discovered S8
[S7] + discovered S10
[S9] + discovered S2
[S8] + discovered S16
[S8] + discovered S15
[S8] + discovered S17
[S9] + discovered S7
[S8] + discovered S10
[S8] + discovered S11
[S9] + discovered S6
[S9] + discovered S5
[S8] + discovered S9
[S8] + discovered S14
[S9] + discovered S4
[S9] + discovered S3
[S8] + discovered S13
[S9] + discovered S8
[S9] + discovered S15
[S10] + discovered S7
[S10] + discovered S6
[S10] + discovered S3
[S10] + discovered S9
[S10] + discovered S2
[S10] + discovered S5
[S10] + discovered S4
[S10] + discovered S8
[S9] + discovered S10
[S9] + discovered S17
[S9] + discovered S16
[S9] + discovered S14
[S9] + discovered S11
[S9] + discovered S13
[S11] + discovered S4
[S10] + discovered S16
[S10] + discovered S17
[S10] + discovered S13
[S10] + discovered S15
[S10] + discovered S14
[S10] + discovered S11
[S11] + discovered S7
[S11] + discovered S3
[S11] + discovered S2
[S11] + discovered S10
[S11] + discovered S5
[S11] + discovered S6
[S11] + discovered S8
[S11] + discovered S9
[S11] + discovered S17
[S11] + discovered S14
[S11] + discovered S13
[S11] + discovered S15
[S11] + discovered S16
[S13] + discovered S10
[S13] + discovered S6
[S13] + discovered S3
[S13] + discovered S7
[S13] + discovered S9
[S13] + discovered S11
[S13] + discovered S4
[S13] + discovered S8
[S13] + discovered S5
[S13] + discovered S2
[S14] + discovered S8
[S14] + discovered S9
[S14] + discovered S3
[S14] + discovered S6
[S14] + discovered S2
[S14] + discovered S7
[S14] + discovered S13
[S14] + discovered S5
[S14] + discovered S4
[S14] + discovered S11
[S14] + discovered S10
[S13] + discovered S16
[S13] + discovered S15
[S13] + discovered S14
[S13] + discovered S17
[S15] + discovered S4
[S15] + discovered S7
[S15] + discovered S13
[S15] + discovered S6
[S15] + discovered S14
[S15] + discovered S10
[S15] + discovered S11
[S15] + discovered S5
[S15] + discovered S2
[S15] + discovered S3
[S15] + discovered S9
[S15] + discovered S8
[S14] + discovered S17
[S14] + discovered S16
[S14] + discovered S15
[S16] + discovered S2
[S16] + discovered S10
[S16] + discovered S8
[S16] + discovered S11
[S16] + discovered S7
[S15] + discovered S16
[S16] + discovered S14
[S15] + discovered S17
[S16] + discovered S9
[S16] + discovered S13
[S16] + discovered S15
[S16] + discovered S4
[S16] + discovered S6
[S16] + discovered S5
[S16] + discovered S3
[S16] + discovered S17
[S17] + discovered S7
[S17] + discovered S11
[S17] + discovered S6
[S17] + discovered S4
[S17] + discovered S15
[S17] + discovered S5
[S17] + discovered S10
[S17] + discovered S13
[S17] + discovered S3
[S17] + discovered S9
[S17] + discovered S2
[S17] + discovered S16
[S17] + discovered S8
[S17] + discovered S14
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] ⇄ pheromone p=1.000 → S14@127.0.0.1:59814
[S16] ⇄ pheromone p=1.000 → S4@127.0.0.1:59804
[S3] ⇄ pheromone p=1.000 → S2@127.0.0.1:59802
[S6] ⇄ pheromone p=1.000 → S15@127.0.0.1:59815
[S7] ⇄ pheromone p=1.000 → S6@127.0.0.1:59807
[S4] ⇄ pheromone p=1.000 → S5@127.0.0.1:59805
[S10] ⇄ pheromone p=1.000 → S4@127.0.0.1:59804
[S8] ⇄ pheromone p=1.000 → S6@127.0.0.1:59807
[S14] ⇄ pheromone p=1.000 → S11@127.0.0.1:59812
[S2] ⇄ pheromone p=1.000 → S6@127.0.0.1:59807
[S15] ⇄ pheromone p=1.000 → S14@127.0.0.1:59814
[S5] ⇄ pheromone p=1.000 → S9@127.0.0.1:59810
[S13] ⇄ pheromone p=1.000 → S9@127.0.0.1:59810
[S11] ⇄ pheromone p=1.000 → S9@127.0.0.1:59810
[S17] ⇄ pheromone p=1.000 → S5@127.0.0.1:59805
[S2] START round=1 head_norm_before_train=1.134095 (no previous merge yet)
[S2] round=1 local utility u=0.058794 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6054082800566445, 'loss_val': 1.2312629984141739, 'psi': 0.3272295920557978}-{'f1_val': 0.1417771333885667, 'auprc': 0.590330574697649, 'loss_val': 1.3036187274364572, 'psi': 0.32119850991219967}
[S3] START round=1 head_norm_before_train=1.180236 (no previous merge yet)
[S3] round=1 local utility u=0.678309 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.823567192392149, 'loss_val': 1.327686603261735, 'psi': 0.4133309163253238}-{'f1_val': 0.1070528967254408, 'auprc': 0.44613316808140446, 'loss_val': 1.355280112649567, 'psi': 0.24268500526782627}
[S4] START round=1 head_norm_before_train=1.131025 (no previous merge yet)
[S4] round=1 local utility u=0.589162 metrics={'f1_val': 0.36878382938157805, 'auprc': 0.7771567626574392, 'loss_val': 1.2711093349156006, 'psi': 0.5321330026919225}-{'f1_val': 0.19844685615189644, 'auprc': 0.7470040883330653, 'loss_val': 1.3369530054079968, 'psi': 0.41786974902436397}
[S5] START round=1 head_norm_before_train=1.238021 (no previous merge yet)
[S5] round=1 local utility u=0.225460 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.769056205228799, 'loss_val': 1.3061232654149517, 'psi': 0.3929796249486625}-{'f1_val': 0.14226190476190476, 'auprc': 0.6277727854445041, 'loss_val': 1.3331936233491288, 'psi': 0.3364662570349445}
[S6] START round=1 head_norm_before_train=1.177039 (no previous merge yet)
[S6] round=1 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8500613357557476, 'loss_val': 1.258995611006535, 'psi': 0.42488030353306827}-{'f1_val': 0.14142628205128205, 'auprc': 0.9554019347944332, 'loss_val': 1.3278479469709303, 'psi': 0.4670165431485425}
[S7] START round=1 head_norm_before_train=1.157407 (no previous merge yet)
[S7] round=1 local utility u=0.029337 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.794534432042667, 'loss_val': 1.3059558373313702, 'psi': 0.40304786645452184}-{'f1_val': 0.14205682272909165, 'auprc': 0.7873224482174768, 'loss_val': 1.3429947525314219, 'psi': 0.4001630729244457}
[S8] START round=1 head_norm_before_train=1.126026 (no previous merge yet)
[S8] round=1 local utility u=0.212060 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7471347418866736, 'loss_val': 1.2661298857964547, 'psi': 0.38282748619044377}-{'f1_val': 0.13995598239295717, 'auprc': 0.627589683251766, 'loss_val': 1.3316148593701755, 'psi': 0.33500946273648075}
[S9] START round=1 head_norm_before_train=1.157634 (no previous merge yet)
[S9] round=1 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9993416006192515, 'loss_val': 1.3134240615279626, 'psi': 0.4845754145316982}-{'f1_val': 0.3344650776053215, 'auprc': 0.815713129204386, 'loss_val': 1.3646173103355101, 'psi': 0.5269642982449474}
[S10] START round=1 head_norm_before_train=1.171737 (no previous merge yet)
[S10] round=1 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.5983326451969285, 'loss_val': 1.2817371448959007, 'psi': 0.3225060406038058}-{'f1_val': 0.1527829163199627, 'auprc': 0.6104932920740781, 'loss_val': 1.3554704798539834, 'psi': 0.33586706662160887}
[S11] START round=1 head_norm_before_train=1.130054 (no previous merge yet)
[S11] round=1 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.6098900373989798, 'loss_val': 1.3264011705429477, 'psi': 0.3282042249834583}-{'f1_val': 0.3925123205210987, 'auprc': 0.5134055304170209, 'loss_val': 1.3603581729552545, 'psi': 0.44086960447946755}
[S13] START round=1 head_norm_before_train=1.147351 (no previous merge yet)
[S13] round=1 local utility u=0.091161 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7486175103617456, 'loss_val': 1.2715307571793961, 'psi': 0.3836784616909301}-{'f1_val': 0.1403857625770531, 'auprc': 0.712164965009829, 'loss_val': 1.3444957215056779, 'psi': 0.36909744355016344}
[S14] START round=1 head_norm_before_train=1.129709 (no previous merge yet)
[S14] round=1 local utility u=0.444742 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.49736847803488915, 'loss_val': 1.3535871590616138, 'psi': 0.2831621029435779}-{'f1_val': 0.035263490012770016, 'auprc': 0.4199000088865115, 'loss_val': 1.3800988367638618, 'psi': 0.1891180975622666}
[S15] START round=1 head_norm_before_train=1.160076 (no previous merge yet)
[S15] round=1 local utility u=0.036289 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7713673254766119, 'loss_val': 1.2742805488911118, 'psi': 0.3923871210075798}-{'f1_val': 0.13973365136155833, 'auprc': 0.7647724351806777, 'loss_val': 1.3270736544279078, 'psi': 0.38974916488920613}
[S16] START round=1 head_norm_before_train=1.187850 (no previous merge yet)
[S16] round=1 local utility u=0.561196 metrics={'f1_val': 0.16753864447086803, 'auprc': 0.47582667706228754, 'loss_val': 1.3504765080143346, 'psi': 0.29085385750743586}-{'f1_val': 0.015766814410281094, 'auprc': 0.41345353345747726, 'loss_val': 1.3751171359276058, 'psi': 0.17484150202915957}
[S17] START round=1 head_norm_before_train=1.222605 (no previous merge yet)
[S17] round=1 local utility u=0.134478 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.536510412695314, 'loss_val': 1.2682002504358871, 'psi': 0.29917354306855626}-{'f1_val': 0.14094896331738438, 'auprc': 0.4701949904686208, 'loss_val': 1.338210077838234, 'psi': 0.272647374177879}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S14] → sending delta(kind=head bytes=1787) to S10@127.0.0.1:59811
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S4] → sending delta(kind=head bytes=1789) to S9@127.0.0.1:59810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S3] → sending delta(kind=head bytes=1790) to S11@127.0.0.1:59812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1785 reason=None
[S5] → sending delta(kind=head bytes=1785) to S4@127.0.0.1:59804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S7] → sending delta(kind=head bytes=1792) to S17@127.0.0.1:59817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] → sending delta(kind=head bytes=1793) to S17@127.0.0.1:59817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:59802
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:59810
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] → sending delta(kind=head bytes=1793) to S13@127.0.0.1:59813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1783 reason=None
[S16] → sending delta(kind=head bytes=1783) to S13@127.0.0.1:59813
[S15] sending update (kind=head size=1793 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1793 to 1 peers)
[S7] sending update (kind=head size=1792 to 1 peers)
[S5] sending update (kind=head size=1785 to 1 peers)
[S3] sending update (kind=head size=1790 to 1 peers)
[S4] sending update (kind=head size=1789 to 1 peers)
[S14] sending update (kind=head size=1787 to 1 peers)
[S16] sending update (kind=head size=1783 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1787) from S14
[S10] cosine check vs S14: cos=0.0282
[S17] RECEIVED delta(kind=head bytes=1793) from S2
[S17] cosine check vs S2: cos=0.0185
[S17] RECEIVED delta(kind=head bytes=1792) from S7
[S17] cosine check vs S7: cos=0.0054
[S9] RECEIVED delta(kind=head bytes=1798) from S13
[S9] cosine check vs S13: cos=0.0153
[S13] RECEIVED delta(kind=head bytes=1783) from S16
[S13] cosine check vs S16: cos=-0.0681
[S13] DROPPED delta from S16 (cos=-0.0681 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1789) from S4
[S9] cosine check vs S4: cos=-0.0618
[S9] DROPPED delta from S4 (cos=-0.0618 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1790) from S3
[S11] cosine check vs S3: cos=-0.0874
[S11] DROPPED delta from S3 (cos=-0.0874 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1801) from S8
[S2] cosine check vs S8: cos=0.0497
[S4] RECEIVED delta(kind=head bytes=1785) from S5
[S4] cosine check vs S5: cos=-0.0609
[S4] DROPPED delta from S5 (cos=-0.0609 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1793) from S15
[S13] cosine check vs S15: cos=-0.0256
[S13] DROPPED delta from S15 (cos=-0.0256 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] → sending delta(kind=head bytes=1793) to S7@127.0.0.1:59808
[S17] sending update (kind=head size=1793 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1793) from S17
[S7] cosine check vs S17: cos=0.0054
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=1 metric=0.1414 head_norm=1.174456
[S9] _apply_head_vector_avg (torch): Δ‖w‖=8.295705e-01
[S9] stored merged vector for next round verification (round=1)
[S9] DEBUG after merge:  round=1 metric=0.1414 head_norm=0.842320 delta_norm=0.829570
[S9] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=1 metric=0.1386 head_norm=1.214215
[S10] _apply_head_vector_avg (torch): Δ‖w‖=8.225694e-01
[S10] stored merged vector for next round verification (round=1)
[S10] DEBUG after merge:  round=1 metric=0.1386 head_norm=0.846075 delta_norm=0.822569
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=1 metric=0.1418 head_norm=1.179230
[S2] _apply_head_vector_avg (torch): Δ‖w‖=8.074247e-01
[S2] stored merged vector for next round verification (round=1)
[S2] DEBUG after merge:  round=1 metric=0.1418 head_norm=0.848557 delta_norm=0.807425
[S2] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=1 metric=0.1421 head_norm=1.173936
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.618948e-01
[S7] stored merged vector for next round verification (round=1)
[S7] DEBUG after merge:  round=1 metric=0.1421 head_norm=0.866528 delta_norm=0.861895
[S7] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=1 metric=0.1409 head_norm=1.268598
[S17] _apply_head_vector_avg (torch): Δ‖w‖=7.628222e-01
[S17] stored merged vector for next round verification (round=1)
[S17] DEBUG after merge:  round=1 metric=0.1409 head_norm=0.774413 delta_norm=0.762822
[S17] aggregate: ACCEPT kept=['S2', 'S7'] (k=2/2) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=0.848557 cos_to_last_merge=1.0000 (last merge round=1)
[S2] round=2 local utility u=0.285175 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7757504623567084, 'loss_val': 1.1719399050230759, 'psi': 0.39536646497582345}-{'f1_val': 0.1417771333885667, 'auprc': 0.6054082800566445, 'loss_val': 1.2312629984141739, 'psi': 0.3272295920557978}
[S3] START round=2 head_norm_before_train=1.194304 (no previous merge yet)
[S3] round=2 local utility u=0.273712 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9963655928307851, 'loss_val': 1.2986584377715367, 'psi': 0.4824502765007783}-{'f1_val': 0.13984006561410703, 'auprc': 0.823567192392149, 'loss_val': 1.327686603261735, 'psi': 0.4133309163253238}
[S4] START round=2 head_norm_before_train=1.167728 (no previous merge yet)
[S4] round=2 local utility u=1.000000 metrics={'f1_val': 0.6849778536514195, 'auprc': 0.7805699865709939, 'loss_val': 1.1344006935964546, 'psi': 0.7232147068192493}-{'f1_val': 0.36878382938157805, 'auprc': 0.7771567626574392, 'loss_val': 1.2711093349156006, 'psi': 0.5321330026919225}
[S5] START round=2 head_norm_before_train=1.248254 (no previous merge yet)
[S5] round=2 local utility u=0.016193 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7694910186642604, 'loss_val': 1.275041857571204, 'psi': 0.39315355032284705}-{'f1_val': 0.14226190476190476, 'auprc': 0.769056205228799, 'loss_val': 1.3061232654149517, 'psi': 0.3929796249486625}
[S6] START round=2 head_norm_before_train=1.222104 (no previous merge yet)
[S6] round=2 local utility u=0.039799 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8535261136874569, 'loss_val': 1.189791871966033, 'psi': 0.426266214705752}-{'f1_val': 0.14142628205128205, 'auprc': 0.8500613357557476, 'loss_val': 1.258995611006535, 'psi': 0.42488030353306827}
[S7] START round=2 head_norm_before_train=0.866528 cos_to_last_merge=1.0000 (last merge round=1)
[S7] round=2 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.77774805887124, 'loss_val': 1.3126399862062887, 'psi': 0.396333317185951}-{'f1_val': 0.14205682272909165, 'auprc': 0.794534432042667, 'loss_val': 1.3059558373313702, 'psi': 0.40304786645452184}
[S8] START round=2 head_norm_before_train=1.163350 (no previous merge yet)
[S8] round=2 local utility u=0.173229 metrics={'f1_val': 0.17057585808294107, 'auprc': 0.7657467367924339, 'loss_val': 1.159227869769584, 'psi': 0.4086442095667382}-{'f1_val': 0.13995598239295717, 'auprc': 0.7471347418866736, 'loss_val': 1.2661298857964547, 'psi': 0.38282748619044377}
[S9] START round=2 head_norm_before_train=0.842320 cos_to_last_merge=1.0000 (last merge round=1)
[S9] round=2 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9755530743829837, 'loss_val': 1.2903207680653657, 'psi': 0.4750600040371911}-{'f1_val': 0.141397957139996, 'auprc': 0.9993416006192515, 'loss_val': 1.3134240615279626, 'psi': 0.4845754145316982}
[S10] START round=2 head_norm_before_train=0.846075 cos_to_last_merge=1.0000 (last merge round=1)
[S10] round=2 local utility u=0.018975 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.5918012048283081, 'loss_val': 1.224192823856623, 'psi': 0.3198934644563576}-{'f1_val': 0.13862163754172394, 'auprc': 0.5983326451969285, 'loss_val': 1.2817371448959007, 'psi': 0.3225060406038058}
[S11] START round=2 head_norm_before_train=1.143584 (no previous merge yet)
[S11] round=2 local utility u=0.007115 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.6017154374604988, 'loss_val': 1.2876468671546693, 'psi': 0.3249343850080659}-{'f1_val': 0.14041368337311058, 'auprc': 0.6098900373989798, 'loss_val': 1.3264011705429477, 'psi': 0.3282042249834583}
[S13] START round=2 head_norm_before_train=1.189973 (no previous merge yet)
[S13] round=2 local utility u=0.000000 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7124727183320632, 'loss_val': 1.181101865558019, 'psi': 0.36922054487905714}-{'f1_val': 0.1403857625770531, 'auprc': 0.7486175103617456, 'loss_val': 1.2715307571793961, 'psi': 0.3836784616909301}
[S14] START round=2 head_norm_before_train=1.144818 (no previous merge yet)
[S14] round=2 local utility u=0.299525 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.6864788231577373, 'loss_val': 1.3218675231230963, 'psi': 0.3588062409927172}-{'f1_val': 0.14035785288270378, 'auprc': 0.49736847803488915, 'loss_val': 1.3535871590616138, 'psi': 0.2831621029435779}
[S15] START round=2 head_norm_before_train=1.201354 (no previous merge yet)
[S15] round=2 local utility u=0.042401 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7770515294255819, 'loss_val': 1.2065313519779293, 'psi': 0.3946608025871678}-{'f1_val': 0.13973365136155833, 'auprc': 0.7713673254766119, 'loss_val': 1.2742805488911118, 'psi': 0.3923871210075798}
[S16] START round=2 head_norm_before_train=1.192070 (no previous merge yet)
[S16] round=2 local utility u=0.313140 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.727590477235929, 'loss_val': 1.3180815099993513, 'psi': 0.37541866101389354}-{'f1_val': 0.16753864447086803, 'auprc': 0.47582667706228754, 'loss_val': 1.3504765080143346, 'psi': 0.29085385750743586}
[S17] START round=2 head_norm_before_train=0.774413 cos_to_last_merge=1.0000 (last merge round=1)
[S17] round=2 local utility u=0.011727 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5215551861440577, 'loss_val': 1.1998807171183814, 'psi': 0.2931914524480537}-{'f1_val': 0.14094896331738438, 'auprc': 0.536510412695314, 'loss_val': 1.2682002504358871, 'psi': 0.29917354306855626}
[S2] not sending this round → trigger blocked (psi=0.395)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.723)
[S14] not sending this round → trigger blocked (psi=0.359)
[S5] not sending this round → trigger blocked (psi=0.393)
[S8] not sending this round → trigger blocked (psi=0.409)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:59812
[S3] not sending this round → trigger blocked (psi=0.482)
[S16] not sending this round → trigger blocked (psi=0.375)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.395)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:59814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:59808
[S11] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1799) from S11
[S14] cosine check vs S11: cos=-0.0372
[S14] DROPPED delta from S11 (cos=-0.0372 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1799) from S6
[S7] cosine check vs S6: cos=-0.0471
[S7] DROPPED delta from S6 (cos=-0.0471 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1799) from S10
[S11] cosine check vs S10: cos=0.0468
[S17] not sending this round → trigger blocked (psi=0.293)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=2 metric=0.1404 head_norm=1.164427
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.187825e-01
[S11] stored merged vector for next round verification (round=2)
[S11] DEBUG after merge:  round=2 metric=0.1404 head_norm=0.752114 delta_norm=0.718783
[S11] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=3 head_norm_before_train=0.898136 cos_to_last_merge=0.9944 (last merge round=1)
[S2] round=3 local utility u=0.877286 metrics={'f1_val': 0.4166479977574128, 'auprc': 0.771776572472326, 'loss_val': 1.0546717722012553, 'psi': 0.5586994276433781}-{'f1_val': 0.1417771333885667, 'auprc': 0.7757504623567084, 'loss_val': 1.1719399050230759, 'psi': 0.39536646497582345}
[S3] START round=3 head_norm_before_train=1.217086 (no previous merge yet)
[S3] round=3 local utility u=0.007954 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9904328496618232, 'loss_val': 1.2649522873964163, 'psi': 0.4800771792331935}-{'f1_val': 0.13984006561410703, 'auprc': 0.9963655928307851, 'loss_val': 1.2986584377715367, 'psi': 0.4824502765007783}
[S4] START round=3 head_norm_before_train=1.236440 (no previous merge yet)
[S4] round=3 local utility u=0.137300 metrics={'f1_val': 0.6708205523369667, 'auprc': 0.7853723963805376, 'loss_val': 0.7892650899882591, 'psi': 0.716641289954395}-{'f1_val': 0.6849778536514195, 'auprc': 0.7805699865709939, 'loss_val': 1.1344006935964546, 'psi': 0.7232147068192493}
[S5] START round=3 head_norm_before_train=1.265386 (no previous merge yet)
[S5] round=3 local utility u=0.014583 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7700237711528735, 'loss_val': 1.247473489983078, 'psi': 0.39336665131829224}-{'f1_val': 0.14226190476190476, 'auprc': 0.7694910186642604, 'loss_val': 1.275041857571204, 'psi': 0.39315355032284705}
[S6] START round=3 head_norm_before_train=1.281105 (no previous merge yet)
[S6] round=3 local utility u=0.911887 metrics={'f1_val': 0.41605123052148413, 'auprc': 0.851432741785108, 'loss_val': 1.0074872861148425, 'psi': 0.5902038350269336}-{'f1_val': 0.14142628205128205, 'auprc': 0.8535261136874569, 'loss_val': 1.189791871966033, 'psi': 0.426266214705752}
[S7] START round=3 head_norm_before_train=0.882073 cos_to_last_merge=0.9967 (last merge round=1)
[S7] round=3 local utility u=0.021278 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7778246992551738, 'loss_val': 1.270313102478298, 'psi': 0.39636397333952456}-{'f1_val': 0.14205682272909165, 'auprc': 0.77774805887124, 'loss_val': 1.3126399862062887, 'psi': 0.396333317185951}
[S8] START round=3 head_norm_before_train=1.213346 (no previous merge yet)
[S8] round=3 local utility u=1.000000 metrics={'f1_val': 0.6693043681091674, 'auprc': 0.7769794867203683, 'loss_val': 1.0054184499992758, 'psi': 0.7123744155536478}-{'f1_val': 0.17057585808294107, 'auprc': 0.7657467367924339, 'loss_val': 1.159227869769584, 'psi': 0.4086442095667382}
[S9] START round=3 head_norm_before_train=0.866183 cos_to_last_merge=0.9963 (last merge round=1)
[S9] round=3 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.866099412382251, 'loss_val': 1.2249024758435199, 'psi': 0.431278539236898}-{'f1_val': 0.141397957139996, 'auprc': 0.9755530743829837, 'loss_val': 1.2903207680653657, 'psi': 0.4750600040371911}
[S10] START round=3 head_norm_before_train=0.899309 cos_to_last_merge=0.9905 (last merge round=1)
[S10] round=3 local utility u=0.991593 metrics={'f1_val': 0.41694859683592245, 'auprc': 0.6413099953402491, 'loss_val': 1.059494520007431, 'psi': 0.5066931562376531}-{'f1_val': 0.13862163754172394, 'auprc': 0.5918012048283081, 'loss_val': 1.224192823856623, 'psi': 0.3198934644563576}
[S11] START round=3 head_norm_before_train=0.752114 cos_to_last_merge=1.0000 (last merge round=2)
[S11] round=3 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.5988126487070636, 'loss_val': 1.2993396289484531, 'psi': 0.32377326950669183}-{'f1_val': 0.14041368337311058, 'auprc': 0.6017154374604988, 'loss_val': 1.2876468671546693, 'psi': 0.3249343850080659}
[S13] START round=3 head_norm_before_train=1.247609 (no previous merge yet)
[S13] round=3 local utility u=0.740825 metrics={'f1_val': 0.41643344272875704, 'auprc': 0.6037875972964672, 'loss_val': 1.029683053347113, 'psi': 0.4913751045558411}-{'f1_val': 0.1403857625770531, 'auprc': 0.7124727183320632, 'loss_val': 1.181101865558019, 'psi': 0.36922054487905714}
[S14] START round=3 head_norm_before_train=1.167313 (no previous merge yet)
[S14] round=3 local utility u=0.107998 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7458763042266685, 'loss_val': 1.2840643382964345, 'psi': 0.38256523342028964}-{'f1_val': 0.14035785288270378, 'auprc': 0.6864788231577373, 'loss_val': 1.3218675231230963, 'psi': 0.3588062409927172}
[S15] START round=3 head_norm_before_train=1.259805 (no previous merge yet)
[S15] round=3 local utility u=0.892164 metrics={'f1_val': 0.4163758395072774, 'auprc': 0.7770560836842715, 'loss_val': 1.0820697942456485, 'psi': 0.560647937178075}-{'f1_val': 0.13973365136155833, 'auprc': 0.7770515294255819, 'loss_val': 1.2065313519779293, 'psi': 0.3946608025871678}
[S16] START round=3 head_norm_before_train=1.206500 (no previous merge yet)
[S16] round=3 local utility u=0.120842 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7936150185761737, 'loss_val': 1.2744704239167244, 'psi': 0.4018284775499914}-{'f1_val': 0.14063745019920318, 'auprc': 0.727590477235929, 'loss_val': 1.3180815099993513, 'psi': 0.37541866101389354}
[S17] START round=3 head_norm_before_train=0.833427 cos_to_last_merge=0.9888 (last merge round=1)
[S17] round=3 local utility u=0.804849 metrics={'f1_val': 0.38871999052858847, 'auprc': 0.5169420784965963, 'loss_val': 1.0629704164351597, 'psi': 0.44000882571579164}-{'f1_val': 0.14094896331738438, 'auprc': 0.5215551861440577, 'loss_val': 1.1998807171183814, 'psi': 0.2931914524480537}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:59805
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:59807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S3] → sending delta(kind=head bytes=1791) to S2@127.0.0.1:59802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S5] → sending delta(kind=head bytes=1790) to S9@127.0.0.1:59810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:59807
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.507)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:59807
[S6] not sending this round → trigger blocked (psi=0.590)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:59814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S16] → sending delta(kind=head bytes=1788) to S4@127.0.0.1:59804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:59812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:59810
[S2] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1788 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1790 to 1 peers)
[S3] sending update (kind=head size=1791 to 1 peers)
[S4] sending update (kind=head size=1794 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1798) from S7
[S6] cosine check vs S7: cos=-0.0498
[S6] DROPPED delta from S7 (cos=-0.0498 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1797) from S8
[S6] cosine check vs S8: cos=0.0425
[S14] RECEIVED delta(kind=head bytes=1796) from S15
[S14] cosine check vs S15: cos=0.0570
[S4] RECEIVED delta(kind=head bytes=1788) from S16
[S4] cosine check vs S16: cos=-0.0402
[S4] DROPPED delta from S16 (cos=-0.0402 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1794) from S4
[S5] cosine check vs S4: cos=-0.0569
[S5] DROPPED delta from S4 (cos=-0.0569 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1803) from S13
[S9] cosine check vs S13: cos=0.6724
[S9] RECEIVED delta(kind=head bytes=1790) from S5
[S9] cosine check vs S5: cos=-0.1066
[S9] DROPPED delta from S5 (cos=-0.1066 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1797) from S14
[S11] cosine check vs S14: cos=0.3482
[S2] RECEIVED delta(kind=head bytes=1791) from S3
[S2] cosine check vs S3: cos=0.0668
[S6] RECEIVED delta(kind=head bytes=1800) from S2
[S6] cosine check vs S2: cos=0.0175
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:59805
[S17] sending update (kind=head size=1794 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1794) from S17
[S5] cosine check vs S17: cos=0.0409
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=3 metric=0.1414 head_norm=0.898968
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.858486e-01
[S9] stored merged vector for next round verification (round=3)
[S9] DEBUG after merge:  round=3 metric=0.1414 head_norm=1.014635 delta_norm=0.485849
[S9] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=3 metric=0.4161 head_norm=1.334262
[S6] _apply_head_vector_avg (torch): Δ‖w‖=8.234227e-01
[S6] stored merged vector for next round verification (round=3)
[S6] DEBUG after merge:  round=3 metric=0.4168 head_norm=0.851517 delta_norm=0.823423
[S6] aggregate: ACCEPT kept=['S8', 'S2'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=3 metric=0.1404 head_norm=0.771251
[S11] _apply_head_vector_avg (torch): Δ‖w‖=5.872378e-01
[S11] stored merged vector for next round verification (round=3)
[S11] DEBUG after merge:  round=3 metric=0.1404 head_norm=0.815775 delta_norm=0.587238
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=3 metric=0.1404 head_norm=1.194089
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.647795e-01
[S14] stored merged vector for next round verification (round=3)
[S14] DEBUG after merge:  round=3 metric=0.1404 head_norm=0.915254 delta_norm=0.864779
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=3 metric=0.4166 head_norm=0.944783
[S2] _apply_head_vector_avg (torch): Δ‖w‖=7.565503e-01
[S2] stored merged vector for next round verification (round=3)
[S2] DEBUG after merge:  round=3 metric=0.4166 head_norm=0.806890 delta_norm=0.756550
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=3 metric=0.1423 head_norm=1.280579
[S5] _apply_head_vector_avg (torch): Δ‖w‖=7.681047e-01
[S5] stored merged vector for next round verification (round=3)
[S5] DEBUG after merge:  round=3 metric=0.1423 head_norm=0.798286 delta_norm=0.768105
[S5] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=0.806890 cos_to_last_merge=1.0000 (last merge round=3)
[S2] round=4 local utility u=0.020786 metrics={'f1_val': 0.41723108036439727, 'auprc': 0.7741570681489158, 'loss_val': 1.023740071042337, 'psi': 0.5600014754782047}-{'f1_val': 0.4166479977574128, 'auprc': 0.771776572472326, 'loss_val': 1.0546717722012553, 'psi': 0.5586994276433781}
[S3] START round=4 head_norm_before_train=1.246701 (no previous merge yet)
[S3] round=4 local utility u=0.015725 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9877638771005489, 'loss_val': 1.2254948997920536, 'psi': 0.47900959020868383}-{'f1_val': 0.13984006561410703, 'auprc': 0.9904328496618232, 'loss_val': 1.2649522873964163, 'psi': 0.4800771792331935}
[S4] START round=4 head_norm_before_train=1.334352 (no previous merge yet)
[S4] round=4 local utility u=0.000000 metrics={'f1_val': 0.6662523885536008, 'auprc': 0.6615647946382724, 'loss_val': 0.4745413142668685, 'psi': 0.6643773509874695}-{'f1_val': 0.6708205523369667, 'auprc': 0.7853723963805376, 'loss_val': 0.7892650899882591, 'psi': 0.716641289954395}
[S5] START round=4 head_norm_before_train=0.798286 cos_to_last_merge=1.0000 (last merge round=3)
[S5] round=4 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7699983151494604, 'loss_val': 1.2578348571764528, 'psi': 0.39335646891692705}-{'f1_val': 0.14226190476190476, 'auprc': 0.7700237711528735, 'loss_val': 1.247473489983078, 'psi': 0.39336665131829224}
[S6] START round=4 head_norm_before_train=0.851517 cos_to_last_merge=1.0000 (last merge round=3)
[S6] round=4 local utility u=0.000000 metrics={'f1_val': 0.41605123052148413, 'auprc': 0.7946990637880278, 'loss_val': 0.9047310073166901, 'psi': 0.5675103638281016}-{'f1_val': 0.41605123052148413, 'auprc': 0.851432741785108, 'loss_val': 1.0074872861148425, 'psi': 0.5902038350269336}
[S7] START round=4 head_norm_before_train=0.906537 cos_to_last_merge=0.9873 (last merge round=1)
[S7] round=4 local utility u=0.013016 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7777993725841346, 'loss_val': 1.2442054422963775, 'psi': 0.39635384267110885}-{'f1_val': 0.14205682272909165, 'auprc': 0.7778246992551738, 'loss_val': 1.270313102478298, 'psi': 0.39636397333952456}
[S8] START round=4 head_norm_before_train=1.269946 (no previous merge yet)
[S8] round=4 local utility u=0.000000 metrics={'f1_val': 0.3727318090052443, 'auprc': 0.7721013161417795, 'loss_val': 0.8355591239458166, 'psi': 0.5324796118598584}-{'f1_val': 0.6693043681091674, 'auprc': 0.7769794867203683, 'loss_val': 1.0054184499992758, 'psi': 0.7123744155536478}
[S9] START round=4 head_norm_before_train=1.014635 cos_to_last_merge=1.0000 (last merge round=3)
[S9] round=4 local utility u=0.014024 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8659703885781976, 'loss_val': 1.196468302744468, 'psi': 0.4312269297152767}-{'f1_val': 0.141397957139996, 'auprc': 0.866099412382251, 'loss_val': 1.2249024758435199, 'psi': 0.431278539236898}
[S10] START round=4 head_norm_before_train=0.964386 cos_to_last_merge=0.9700 (last merge round=1)
[S10] round=4 local utility u=0.353995 metrics={'f1_val': 0.3926386670093843, 'auprc': 0.8425487263747778, 'loss_val': 0.8093602052292295, 'psi': 0.5726026907555417}-{'f1_val': 0.41694859683592245, 'auprc': 0.6413099953402491, 'loss_val': 1.059494520007431, 'psi': 0.5066931562376531}
[S11] START round=4 head_norm_before_train=0.815775 cos_to_last_merge=1.0000 (last merge round=3)
[S11] round=4 local utility u=0.054172 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.6344784832024838, 'loss_val': 1.2979923338757067, 'psi': 0.3380396033048599}-{'f1_val': 0.14041368337311058, 'auprc': 0.5988126487070636, 'loss_val': 1.2993396289484531, 'psi': 0.32377326950669183}
[S13] START round=4 head_norm_before_train=1.312601 (no previous merge yet)
[S13] round=4 local utility u=1.000000 metrics={'f1_val': 0.7113338601562683, 'auprc': 0.736468350066133, 'loss_val': 0.7823399151130088, 'psi': 0.7213876561202142}-{'f1_val': 0.41643344272875704, 'auprc': 0.6037875972964672, 'loss_val': 1.029683053347113, 'psi': 0.4913751045558411}
[S14] START round=4 head_norm_before_train=0.915254 cos_to_last_merge=1.0000 (last merge round=3)
[S14] round=4 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7388447995333307, 'loss_val': 1.2763479271992786, 'psi': 0.3797526315429545}-{'f1_val': 0.14035785288270378, 'auprc': 0.7458763042266685, 'loss_val': 1.2840643382964345, 'psi': 0.38256523342028964}
[S15] START round=4 head_norm_before_train=1.321068 (no previous merge yet)
[S15] round=4 local utility u=0.186595 metrics={'f1_val': 0.417152535761773, 'auprc': 0.7996687446008577, 'loss_val': 0.7813788749930952, 'psi': 0.5701590192974069}-{'f1_val': 0.4163758395072774, 'auprc': 0.7770560836842715, 'loss_val': 1.0820697942456485, 'psi': 0.560647937178075}
[S16] START round=4 head_norm_before_train=1.229495 (no previous merge yet)
[S16] round=4 local utility u=0.038629 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8007671445198188, 'loss_val': 1.218668159707512, 'psi': 0.4046893279274495}-{'f1_val': 0.14063745019920318, 'auprc': 0.7936150185761737, 'loss_val': 1.2744704239167244, 'psi': 0.4018284775499914}
[S17] START round=4 head_norm_before_train=0.902556 cos_to_last_merge=0.9664 (last merge round=1)
[S17] round=4 local utility u=0.292256 metrics={'f1_val': 0.3771094291243887, 'auprc': 0.6629229477248131, 'loss_val': 0.8467367413863861, 'psi': 0.4914348365645585}-{'f1_val': 0.38871999052858847, 'auprc': 0.5169420784965963, 'loss_val': 1.0629704164351597, 'psi': 0.44000882571579164}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:59810
[S2] not sending this round → trigger blocked (psi=0.560)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S10] → sending delta(kind=head bytes=1806) to S4@127.0.0.1:59804
[S7] not sending this round → trigger blocked (psi=0.396)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:59814
[S3] not sending this round → trigger blocked (psi=0.479)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.405)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.570)
[S13] not sending this round → trigger blocked (psi=0.721)
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1806 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1806) from S10
[S4] cosine check vs S10: cos=0.0410
[S14] RECEIVED delta(kind=head bytes=1796) from S9
[S14] cosine check vs S9: cos=0.0392
[S9] RECEIVED delta(kind=head bytes=1796) from S11
[S9] cosine check vs S11: cos=0.0608
[S17] not sending this round → trigger blocked (psi=0.491)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=4 metric=0.1404 head_norm=0.941888
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.866180e-01
[S14] stored merged vector for next round verification (round=4)
[S14] DEBUG after merge:  round=4 metric=0.1404 head_norm=0.713962 delta_norm=0.686618
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=4 metric=0.6663 head_norm=1.452338
[S4] _apply_head_vector_avg (torch): Δ‖w‖=8.729343e-01
[S4] stored merged vector for next round verification (round=4)
[S4] DEBUG after merge:  round=4 metric=0.6662 head_norm=0.907356 delta_norm=0.872934
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=4 metric=0.1414 head_norm=1.036928
[S9] _apply_head_vector_avg (torch): Δ‖w‖=6.441746e-01
[S9] stored merged vector for next round verification (round=4)
[S9] DEBUG after merge:  round=4 metric=0.1414 head_norm=0.683581 delta_norm=0.644175
[S9] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=5 head_norm_before_train=0.856051 cos_to_last_merge=0.9893 (last merge round=3)
[S2] round=5 local utility u=0.493334 metrics={'f1_val': 0.552533386883245, 'auprc': 0.7764474269704265, 'loss_val': 0.8557564853649815, 'psi': 0.6420990029181176}-{'f1_val': 0.41723108036439727, 'auprc': 0.7741570681489158, 'loss_val': 1.023740071042337, 'psi': 0.5600014754782047}
[S3] START round=5 head_norm_before_train=1.279970 (no previous merge yet)
[S3] round=5 local utility u=0.027573 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9844718591571036, 'loss_val': 1.1604720911029642, 'psi': 0.4776927830313057}-{'f1_val': 0.13984006561410703, 'auprc': 0.9877638771005489, 'loss_val': 1.2254948997920536, 'psi': 0.47900959020868383}
[S4] START round=5 head_norm_before_train=0.907356 cos_to_last_merge=1.0000 (last merge round=4)
[S4] round=5 local utility u=0.000000 metrics={'f1_val': 0.6664184780295077, 'auprc': 0.6543790853469605, 'loss_val': 0.5174185634017389, 'psi': 0.6616027209564888}-{'f1_val': 0.6662523885536008, 'auprc': 0.6615647946382724, 'loss_val': 0.4745413142668685, 'psi': 0.6643773509874695}
[S5] START round=5 head_norm_before_train=0.820105 cos_to_last_merge=0.9975 (last merge round=3)
[S5] round=5 local utility u=0.016499 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7701861471247169, 'loss_val': 1.2254004371936942, 'psi': 0.3934316017070296}-{'f1_val': 0.14226190476190476, 'auprc': 0.7699983151494604, 'loss_val': 1.2578348571764528, 'psi': 0.39335646891692705}
[S6] START round=5 head_norm_before_train=0.919784 cos_to_last_merge=0.9921 (last merge round=3)
[S6] round=5 local utility u=0.013923 metrics={'f1_val': 0.41508160222532486, 'auprc': 0.7801857736478942, 'loss_val': 0.8275280989021413, 'psi': 0.5611232707943526}-{'f1_val': 0.41605123052148413, 'auprc': 0.7946990637880278, 'loss_val': 0.9047310073166901, 'psi': 0.5675103638281016}
[S7] START round=5 head_norm_before_train=0.933830 cos_to_last_merge=0.9758 (last merge round=1)
[S7] round=5 local utility u=0.012972 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7778815918427194, 'loss_val': 1.2185089549214512, 'psi': 0.3963867303745428}-{'f1_val': 0.14205682272909165, 'auprc': 0.7777993725841346, 'loss_val': 1.2442054422963775, 'psi': 0.39635384267110885}
[S8] START round=5 head_norm_before_train=1.334939 (no previous merge yet)
[S8] round=5 local utility u=0.209781 metrics={'f1_val': 0.3729316501988709, 'auprc': 0.8664631350210477, 'loss_val': 0.700281012744318, 'psi': 0.5703442441277417}-{'f1_val': 0.3727318090052443, 'auprc': 0.7721013161417795, 'loss_val': 0.8355591239458166, 'psi': 0.5324796118598584}
[S9] START round=5 head_norm_before_train=0.683581 cos_to_last_merge=1.0000 (last merge round=4)
[S9] round=5 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8659516725649777, 'loss_val': 1.196825334818731, 'psi': 0.43121944330998874}-{'f1_val': 0.141397957139996, 'auprc': 0.8659703885781976, 'loss_val': 1.196468302744468, 'psi': 0.4312269297152767}
[S10] START round=5 head_norm_before_train=1.030209 cos_to_last_merge=0.9475 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.947
[S10] round=5 local utility u=1.000000 metrics={'f1_val': 0.6954765057117567, 'auprc': 0.9890552486727258, 'loss_val': 0.6184901605080741, 'psi': 0.8129080028961444}-{'f1_val': 0.3926386670093843, 'auprc': 0.8425487263747778, 'loss_val': 0.8093602052292295, 'psi': 0.5726026907555417}
[S11] START round=5 head_norm_before_train=0.830221 cos_to_last_merge=0.9965 (last merge round=3)
[S11] round=5 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.5993183804273265, 'loss_val': 1.2331699014318802, 'psi': 0.32397556219479695}-{'f1_val': 0.14041368337311058, 'auprc': 0.6344784832024838, 'loss_val': 1.2979923338757067, 'psi': 0.3380396033048599}
[S13] START round=5 head_norm_before_train=1.371721 (no previous merge yet)
[S13] round=5 local utility u=0.000000 metrics={'f1_val': 0.45448025057744, 'auprc': 0.6229982543213006, 'loss_val': 0.7560433719109239, 'psi': 0.5218874520749842}-{'f1_val': 0.7113338601562683, 'auprc': 0.736468350066133, 'loss_val': 0.7823399151130088, 'psi': 0.7213876561202142}
[S14] START round=5 head_norm_before_train=0.713962 cos_to_last_merge=1.0000 (last merge round=4)
[S14] round=5 local utility u=0.044928 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7681953394413722, 'loss_val': 1.2745439225418953, 'psi': 0.39149284750617114}-{'f1_val': 0.14035785288270378, 'auprc': 0.7388447995333307, 'loss_val': 1.2763479271992786, 'psi': 0.3797526315429545}
[S15] START round=5 head_norm_before_train=1.400933 (no previous merge yet)
[S15] round=5 local utility u=0.532113 metrics={'f1_val': 0.6348594819742517, 'auprc': 0.6649420108913935, 'loss_val': 0.6192148346998739, 'psi': 0.6468924935411084}-{'f1_val': 0.417152535761773, 'auprc': 0.7996687446008577, 'loss_val': 0.7813788749930952, 'psi': 0.5701590192974069}
[S16] START round=5 head_norm_before_train=1.260477 (no previous merge yet)
[S16] round=5 local utility u=0.000000 metrics={'f1_val': 0.1879600248021301, 'auprc': 0.591032030096735, 'loss_val': 1.1418509705428894, 'psi': 0.34918882691997205}-{'f1_val': 0.14063745019920318, 'auprc': 0.8007671445198188, 'loss_val': 1.218668159707512, 'psi': 0.4046893279274495}
[S17] START round=5 head_norm_before_train=0.998442 cos_to_last_merge=0.9327 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.933
[S17] round=5 local utility u=0.000000 metrics={'f1_val': 0.33146316200312237, 'auprc': 0.6967353933401486, 'loss_val': 0.9525417758510325, 'psi': 0.47757205453793283}-{'f1_val': 0.3771094291243887, 'auprc': 0.6629229477248131, 'loss_val': 0.8467367413863861, 'psi': 0.4914348365645585}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S11@127.0.0.1:59812
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:59810
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.813)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:59802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:59814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:59807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:59807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:59807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:59815
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1799) from S7
[S6] cosine check vs S7: cos=-0.0420
[S6] DROPPED delta from S7 (cos=-0.0420 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1800) from S8
[S6] cosine check vs S8: cos=0.5080
[S9] RECEIVED delta(kind=head bytes=1795) from S5
[S9] cosine check vs S5: cos=-0.0377
[S9] DROPPED delta from S5 (cos=-0.0377 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1796) from S2
[S6] cosine check vs S2: cos=0.2851
[S15] RECEIVED delta(kind=head bytes=1800) from S6
[S15] cosine check vs S6: cos=0.0809
[S14] RECEIVED delta(kind=head bytes=1802) from S15
[S14] cosine check vs S15: cos=0.4581
[S11] RECEIVED delta(kind=head bytes=1803) from S14
[S11] cosine check vs S14: cos=0.4789
[S2] RECEIVED delta(kind=head bytes=1795) from S3
[S2] cosine check vs S3: cos=0.7044
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] ⇄ pheromone p=0.713 → S4@127.0.0.1:59804
[S13] ⇄ pheromone p=0.590 → S9@127.0.0.1:59810
[S4] ⇄ pheromone p=0.496 → S5@127.0.0.1:59805
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=5 metric=0.1404 head_norm=0.855500
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.090773e-01
[S11] stored merged vector for next round verification (round=5)
[S11] DEBUG after merge:  round=5 metric=0.1404 head_norm=0.684211 delta_norm=0.409077
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.337 → S9@127.0.0.1:59810
[S9] ⇄ pheromone p=0.330 → S14@127.0.0.1:59814
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=5 metric=0.4151 head_norm=0.999481
[S6] _apply_head_vector_avg (torch): Δ‖w‖=5.028955e-01
[S6] stored merged vector for next round verification (round=5)
[S6] DEBUG after merge:  round=5 metric=0.4150 head_norm=0.861980 delta_norm=0.502895
[S6] aggregate: ACCEPT kept=['S8', 'S2'] (k=2/2) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.451 → S15@127.0.0.1:59815
[S3] ⇄ pheromone p=0.420 → S2@127.0.0.1:59802
[S8] ⇄ pheromone p=0.533 → S6@127.0.0.1:59807
[S7] ⇄ pheromone p=0.337 → S6@127.0.0.1:59807
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=5 metric=0.6349 head_norm=1.482570
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.598098e-01
[S15] stored merged vector for next round verification (round=5)
[S15] DEBUG after merge:  round=5 metric=0.5289 head_norm=0.926938 delta_norm=0.859810
[S15] aggregate: ROLLBACK (f1_val pre=0.635 post=0.529 tol_abs=0.005 tol_rel=0.0)
[S15] ⇄ pheromone p=0.585 → S14@127.0.0.1:59814
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=5 metric=0.5525 head_norm=0.924605
[S2] _apply_head_vector_avg (torch): Δ‖w‖=4.665082e-01
[S2] stored merged vector for next round verification (round=5)
[S2] DEBUG after merge:  round=5 metric=0.6635 head_norm=1.036166 delta_norm=0.466508
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.576 → S6@127.0.0.1:59807
[S5] ⇄ pheromone p=0.353 → S9@127.0.0.1:59810
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=5 metric=0.1404 head_norm=0.734232
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.595146e-01
[S14] stored merged vector for next round verification (round=5)
[S14] DEBUG after merge:  round=5 metric=0.1404 head_norm=0.966227 delta_norm=0.659515
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.418 → S11@127.0.0.1:59812
[S16] ⇄ pheromone p=0.427 → S4@127.0.0.1:59804
[S17] ⇄ pheromone p=0.490 → S5@127.0.0.1:59805
[S2] START round=6 head_norm_before_train=1.036166 cos_to_last_merge=1.0000 (last merge round=5)
[S2] round=6 local utility u=0.523254 metrics={'f1_val': 0.7124715188105256, 'auprc': 0.777201071165505, 'loss_val': 0.7711385797329282, 'psi': 0.7383633397525173}-{'f1_val': 0.552533386883245, 'auprc': 0.7764474269704265, 'loss_val': 0.8557564853649815, 'psi': 0.6420990029181176}
[S3] START round=6 head_norm_before_train=1.314399 (no previous merge yet)
[S3] round=6 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8636460485908831, 'loss_val': 1.047672033431729, 'psi': 0.4293624588048175}-{'f1_val': 0.13984006561410703, 'auprc': 0.9844718591571036, 'loss_val': 1.1604720911029642, 'psi': 0.4776927830313057}
[S4] START round=6 head_norm_before_train=1.032645 cos_to_last_merge=0.9901 (last merge round=4)
[S4] round=6 local utility u=0.004469 metrics={'f1_val': 0.6655990972321474, 'auprc': 0.6525825522796901, 'loss_val': 0.4981745295902218, 'psi': 0.6603924792511644}-{'f1_val': 0.6664184780295077, 'auprc': 0.6543790853469605, 'loss_val': 0.5174185634017389, 'psi': 0.6616027209564888}
[S5] START round=6 head_norm_before_train=0.848418 cos_to_last_merge=0.9914 (last merge round=3)
[S5] round=6 local utility u=0.043171 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7775700629131683, 'loss_val': 1.1612103957734543, 'psi': 0.3963851680224102}-{'f1_val': 0.14226190476190476, 'auprc': 0.7701861471247169, 'loss_val': 1.2254004371936942, 'psi': 0.3934316017070296}
[S6] START round=6 head_norm_before_train=0.861980 cos_to_last_merge=1.0000 (last merge round=5)
[S6] round=6 local utility u=0.032644 metrics={'f1_val': 0.4172560359570804, 'auprc': 0.7918948480605884, 'loss_val': 0.8104141267312059, 'psi': 0.5671115607984836}-{'f1_val': 0.41508160222532486, 'auprc': 0.7801857736478942, 'loss_val': 0.8275280989021413, 'psi': 0.5611232707943526}
[S7] START round=6 head_norm_before_train=0.950782 cos_to_last_merge=0.9680 (last merge round=1)
[S7] round=6 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.755343967172578, 'loss_val': 1.1676830427587463, 'psi': 0.38737168050648624}-{'f1_val': 0.14205682272909165, 'auprc': 0.7778815918427194, 'loss_val': 1.2185089549214512, 'psi': 0.3963867303745428}
[S8] START round=6 head_norm_before_train=1.411652 (no previous merge yet)
[S8] round=6 local utility u=1.000000 metrics={'f1_val': 0.7137586021136586, 'auprc': 0.9947604822333538, 'loss_val': 0.3834148473820081, 'psi': 0.8261593541615366}-{'f1_val': 0.3729316501988709, 'auprc': 0.8664631350210477, 'loss_val': 0.700281012744318, 'psi': 0.5703442441277417}
[S9] START round=6 head_norm_before_train=0.709189 cos_to_last_merge=0.9953 (last merge round=4)
[S9] round=6 local utility u=0.053413 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8658180295107856, 'loss_val': 1.0895979154163942, 'psi': 0.43116598608831186}-{'f1_val': 0.141397957139996, 'auprc': 0.8659516725649777, 'loss_val': 1.196825334818731, 'psi': 0.43121944330998874}
[S10] START round=6 head_norm_before_train=1.099023 cos_to_last_merge=0.9207 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.921
[S10] round=6 local utility u=0.064897 metrics={'f1_val': 0.6895926935280803, 'auprc': 0.99198394837644, 'loss_val': 0.462180359389966, 'psi': 0.8105491954674242}-{'f1_val': 0.6954765057117567, 'auprc': 0.9890552486727258, 'loss_val': 0.6184901605080741, 'psi': 0.8129080028961444}
[S11] START round=6 head_norm_before_train=0.684211 cos_to_last_merge=1.0000 (last merge round=5)
[S11] round=6 local utility u=0.008469 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.5990386984701264, 'loss_val': 1.2153931346467417, 'psi': 0.3238636894119169}-{'f1_val': 0.14041368337311058, 'auprc': 0.5993183804273265, 'loss_val': 1.2331699014318802, 'psi': 0.32397556219479695}
[S13] START round=6 head_norm_before_train=1.437068 (no previous merge yet)
[S13] round=6 local utility u=0.648187 metrics={'f1_val': 0.6143177079858024, 'auprc': 0.6926310763335296, 'loss_val': 0.6275932597603731, 'psi': 0.6456430553248933}-{'f1_val': 0.45448025057744, 'auprc': 0.6229982543213006, 'loss_val': 0.7560433719109239, 'psi': 0.5218874520749842}
[S14] START round=6 head_norm_before_train=0.966227 cos_to_last_merge=1.0000 (last merge round=5)
[S14] round=6 local utility u=0.094286 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.817001825104743, 'loss_val': 1.2323921031822267, 'psi': 0.41101544177151944}-{'f1_val': 0.14035785288270378, 'auprc': 0.7681953394413722, 'loss_val': 1.2745439225418953, 'psi': 0.39149284750617114}
[S15] START round=6 head_norm_before_train=0.926938 cos_to_last_merge=1.0000 (last merge round=5)
[S15] round=6 local utility u=0.447414 metrics={'f1_val': 0.6958814914971772, 'auprc': 0.8120311352105449, 'loss_val': 0.531786733766477, 'psi': 0.7423413489825244}-{'f1_val': 0.6348594819742517, 'auprc': 0.6649420108913935, 'loss_val': 0.6192148346998739, 'psi': 0.6468924935411084}
[S16] START round=6 head_norm_before_train=1.293319 (no previous merge yet)
[S16] round=6 local utility u=0.948234 metrics={'f1_val': 0.4173869385094645, 'auprc': 0.7212325499642721, 'loss_val': 1.0125463257608982, 'psi': 0.5389251830913875}-{'f1_val': 0.1879600248021301, 'auprc': 0.591032030096735, 'loss_val': 1.1418509705428894, 'psi': 0.34918882691997205}
[S17] START round=6 head_norm_before_train=1.082611 cos_to_last_merge=0.9045 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.904
[S17] round=6 local utility u=0.095063 metrics={'f1_val': 0.35351202434239126, 'auprc': 0.6986879247875932, 'loss_val': 0.9005667086911346, 'psi': 0.49158238452047204}-{'f1_val': 0.33146316200312237, 'auprc': 0.6967353933401486, 'loss_val': 0.9525417758510325, 'psi': 0.47757205453793283}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:59810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:59814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] → sending delta(kind=head bytes=1794) to S4@127.0.0.1:59804
[S8] not sending this round → trigger blocked (psi=0.826)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.396)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.567)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S4] → sending delta(kind=head bytes=1789) to S5@127.0.0.1:59805
[S2] not sending this round → trigger blocked (psi=0.738)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:59810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:59804
[S15] not sending this round → trigger blocked (psi=0.742)
[S14] not sending this round → trigger blocked (psi=0.411)
[S10] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1789 to 1 peers)
[S16] sending update (kind=head size=1794 to 1 peers)
[S9] sending update (kind=head size=1794 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1794) from S9
[S14] cosine check vs S9: cos=0.3432
[S4] RECEIVED delta(kind=head bytes=1794) from S16
[S4] cosine check vs S16: cos=-0.0735
[S4] DROPPED delta from S16 (cos=-0.0735 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1802) from S13
[S9] cosine check vs S13: cos=0.7134
[S9] RECEIVED delta(kind=head bytes=1796) from S11
[S9] cosine check vs S11: cos=0.8109
[S5] RECEIVED delta(kind=head bytes=1789) from S4
[S5] cosine check vs S4: cos=0.0364
[S4] RECEIVED delta(kind=head bytes=1801) from S10
[S4] cosine check vs S10: cos=0.4749
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:59805
[S17] sending update (kind=head size=1794 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1794) from S17
[S5] cosine check vs S17: cos=0.5516
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=6 metric=0.1404 head_norm=0.981110
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.030489e-01
[S14] stored merged vector for next round verification (round=6)
[S14] DEBUG after merge:  round=6 metric=0.1404 head_norm=0.708835 delta_norm=0.503049
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=6 metric=0.1423 head_norm=0.866666
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.731006e-01
[S5] stored merged vector for next round verification (round=6)
[S5] DEBUG after merge:  round=6 metric=0.1423 head_norm=0.716531 delta_norm=0.473101
[S5] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=6 metric=0.1414 head_norm=0.740563
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.368602e-01
[S9] stored merged vector for next round verification (round=6)
[S9] DEBUG after merge:  round=6 metric=0.1414 head_norm=0.814867 delta_norm=0.236860
[S9] aggregate: ACCEPT kept=['S13', 'S11'] (k=2/2) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=6 metric=0.6656 head_norm=1.143166
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.956417e-01
[S4] stored merged vector for next round verification (round=6)
[S4] DEBUG after merge:  round=6 metric=0.6656 head_norm=0.997996 delta_norm=0.595642
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=7 head_norm_before_train=1.094589 cos_to_last_merge=0.9909 (last merge round=5)
[S2] round=7 local utility u=0.125316 metrics={'f1_val': 0.7111702393413505, 'auprc': 0.7946245642987921, 'loss_val': 0.5649688749849454, 'psi': 0.7445519693243272}-{'f1_val': 0.7124715188105256, 'auprc': 0.777201071165505, 'loss_val': 0.7711385797329282, 'psi': 0.7383633397525173}
[S3] START round=7 head_norm_before_train=1.344027 (no previous merge yet)
[S3] round=7 local utility u=0.874317 metrics={'f1_val': 0.39645225981545407, 'auprc': 0.8636646627863467, 'loss_val': 0.8387669251687754, 'psi': 0.5833372210038111}-{'f1_val': 0.13984006561410703, 'auprc': 0.8636460485908831, 'loss_val': 1.047672033431729, 'psi': 0.4293624588048175}
[S4] START round=7 head_norm_before_train=0.997996 cos_to_last_merge=1.0000 (last merge round=6)
[S4] round=7 local utility u=0.239596 metrics={'f1_val': 0.6657718339990659, 'auprc': 0.8163566386783971, 'loss_val': 0.5113405271100323, 'psi': 0.7260057558707984}-{'f1_val': 0.6655990972321474, 'auprc': 0.6525825522796901, 'loss_val': 0.4981745295902218, 'psi': 0.6603924792511644}
[S5] START round=7 head_norm_before_train=0.716531 cos_to_last_merge=1.0000 (last merge round=6)
[S5] round=7 local utility u=0.832281 metrics={'f1_val': 0.41734838192522206, 'auprc': 0.7778157892173101, 'loss_val': 1.1479053083459732, 'psi': 0.5615353448420572}-{'f1_val': 0.14226190476190476, 'auprc': 0.7775700629131683, 'loss_val': 1.1612103957734543, 'psi': 0.3963851680224102}
[S6] START round=7 head_norm_before_train=0.925549 cos_to_last_merge=0.9918 (last merge round=5)
[S6] round=7 local utility u=0.107032 metrics={'f1_val': 0.43397784312474946, 'auprc': 0.7906408128277315, 'loss_val': 0.6929194431311525, 'psi': 0.5766430310059423}-{'f1_val': 0.4172560359570804, 'auprc': 0.7918948480605884, 'loss_val': 0.8104141267312059, 'psi': 0.5671115607984836}
[S7] START round=7 head_norm_before_train=0.969025 cos_to_last_merge=0.9608 (last merge round=1)
[S7] round=7 local utility u=0.706353 metrics={'f1_val': 0.41748350776510673, 'auprc': 0.6486123221363, 'loss_val': 1.0873419916732232, 'psi': 0.509935033513584}-{'f1_val': 0.14205682272909165, 'auprc': 0.755343967172578, 'loss_val': 1.1676830427587463, 'psi': 0.38737168050648624}
[S8] START round=7 head_norm_before_train=1.498064 (no previous merge yet)
[S8] round=7 local utility u=0.056747 metrics={'f1_val': 0.7138229449839267, 'auprc': 0.9958471046525879, 'loss_val': 0.2735663321484679, 'psi': 0.8266326088513912}-{'f1_val': 0.7137586021136586, 'auprc': 0.9947604822333538, 'loss_val': 0.3834148473820081, 'psi': 0.8261593541615366}
[S9] START round=7 head_norm_before_train=0.814867 cos_to_last_merge=1.0000 (last merge round=6)
[S9] round=7 local utility u=0.166813 metrics={'f1_val': 0.1767192202394913, 'auprc': 0.8659762081512106, 'loss_val': 0.968374045739557, 'psi': 0.45242201540417903}-{'f1_val': 0.141397957139996, 'auprc': 0.8658180295107856, 'loss_val': 1.0895979154163942, 'psi': 0.43116598608831186}
[S10] START round=7 head_norm_before_train=1.180992 cos_to_last_merge=0.8926 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.893
[S10] round=7 local utility u=0.000000 metrics={'f1_val': 0.6874565438828282, 'auprc': 0.9469950056198851, 'loss_val': 0.36600454775900976, 'psi': 0.7912719285776509}-{'f1_val': 0.6895926935280803, 'auprc': 0.99198394837644, 'loss_val': 0.462180359389966, 'psi': 0.8105491954674242}
[S11] START round=7 head_norm_before_train=0.708492 cos_to_last_merge=0.9942 (last merge round=5)
[S11] round=7 local utility u=0.897391 metrics={'f1_val': 0.4222126204677117, 'auprc': 0.5991931726022137, 'loss_val': 1.11186738748658, 'psi': 0.4930048413215125}-{'f1_val': 0.14041368337311058, 'auprc': 0.5990386984701264, 'loss_val': 1.2153931346467417, 'psi': 0.3238636894119169}
[S13] START round=7 head_norm_before_train=1.496019 (no previous merge yet)
[S13] round=7 local utility u=0.000000 metrics={'f1_val': 0.5892829383851299, 'auprc': 0.670136037247336, 'loss_val': 0.6839302135712951, 'psi': 0.6216241779300123}-{'f1_val': 0.6143177079858024, 'auprc': 0.6926310763335296, 'loss_val': 0.6275932597603731, 'psi': 0.6456430553248933}
[S14] START round=7 head_norm_before_train=0.708835 cos_to_last_merge=1.0000 (last merge round=6)
[S14] round=7 local utility u=0.152549 metrics={'f1_val': 0.1539132330499237, 'auprc': 0.8634614494444045, 'loss_val': 1.1480057838721018, 'psi': 0.43773251960771603}-{'f1_val': 0.14035785288270378, 'auprc': 0.817001825104743, 'loss_val': 1.2323921031822267, 'psi': 0.41101544177151944}
[S15] START round=7 head_norm_before_train=1.031418 cos_to_last_merge=0.9939 (last merge round=5)
[S15] round=7 local utility u=0.000000 metrics={'f1_val': 0.6970831609415726, 'auprc': 0.6824024858948562, 'loss_val': 0.4453638359745268, 'psi': 0.691210890922886}-{'f1_val': 0.6958814914971772, 'auprc': 0.8120311352105449, 'loss_val': 0.531786733766477, 'psi': 0.7423413489825244}
[S16] START round=7 head_norm_before_train=1.331359 (no previous merge yet)
[S16] round=7 local utility u=0.000000 metrics={'f1_val': 0.3622813497337844, 'auprc': 0.7448815035579887, 'loss_val': 0.9409834024942367, 'psi': 0.5153214112634661}-{'f1_val': 0.4173869385094645, 'auprc': 0.7212325499642721, 'loss_val': 1.0125463257608982, 'psi': 0.5389251830913875}
[S17] START round=7 head_norm_before_train=1.136285 cos_to_last_merge=0.8870 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.887
[S17] round=7 local utility u=0.213853 metrics={'f1_val': 0.38296825308015475, 'auprc': 0.7238372540490065, 'loss_val': 0.7250470259857218, 'psi': 0.5193158534676954}-{'f1_val': 0.35351202434239126, 'auprc': 0.6986879247875932, 'loss_val': 0.9005667086911346, 'psi': 0.49158238452047204}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:59805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:59810
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:59815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:59812
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:59810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:59807
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:59807
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] → sending delta(kind=head bytes=1792) to S14@127.0.0.1:59814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:59807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:59802
[S3] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S9] sending update (kind=head size=1792 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1794 to 1 peers)
[S2] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1793 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1798) from S3
[S2] cosine check vs S3: cos=0.8608
[S5] RECEIVED delta(kind=head bytes=1793) from S4
[S5] cosine check vs S4: cos=0.4008
[S6] RECEIVED delta(kind=head bytes=1800) from S7
[S6] cosine check vs S7: cos=-0.0295
[S6] DROPPED delta from S7 (cos=-0.0295 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1796) from S6
[S15] cosine check vs S6: cos=0.5123
[S6] RECEIVED delta(kind=head bytes=1803) from S8
[S6] cosine check vs S8: cos=0.7278
[S6] RECEIVED delta(kind=head bytes=1796) from S2
[S6] cosine check vs S2: cos=0.4015
[S14] RECEIVED delta(kind=head bytes=1792) from S9
[S14] cosine check vs S9: cos=0.7543
[S9] RECEIVED delta(kind=head bytes=1794) from S5
[S9] cosine check vs S5: cos=-0.0100
[S9] DROPPED delta from S5 (cos=-0.0100 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1801) from S14
[S11] cosine check vs S14: cos=0.7956
[S9] RECEIVED delta(kind=head bytes=1795) from S11
[S9] cosine check vs S11: cos=0.7328
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:59805
[S17] sending update (kind=head size=1797 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1797) from S17
[S5] cosine check vs S17: cos=0.7594
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=7 metric=0.6971 head_norm=1.149147
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.333374e-01
[S15] stored merged vector for next round verification (round=7)
[S15] DEBUG after merge:  round=7 metric=0.6973 head_norm=0.932404 delta_norm=0.533337
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=7 metric=0.1539 head_norm=0.744325
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.831629e-01
[S14] stored merged vector for next round verification (round=7)
[S14] DEBUG after merge:  round=7 metric=0.1954 head_norm=0.745684 delta_norm=0.283163
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=7 metric=0.7112 head_norm=1.176711
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.536435e-01
[S2] stored merged vector for next round verification (round=7)
[S2] DEBUG after merge:  round=7 metric=0.6992 head_norm=1.237884 delta_norm=0.353644
[S2] aggregate: ROLLBACK (f1_val pre=0.711 post=0.699 tol_abs=0.005 tol_rel=0.0)
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=7 metric=0.4340 head_norm=0.993535
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.891696e-01
[S6] stored merged vector for next round verification (round=7)
[S6] DEBUG after merge:  round=7 metric=0.4170 head_norm=0.975183 delta_norm=0.389170
[S6] aggregate: ROLLBACK (f1_val pre=0.434 post=0.417 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=7 metric=0.4173 head_norm=0.737085
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.548388e-01
[S5] stored merged vector for next round verification (round=7)
[S5] DEBUG after merge:  round=7 metric=0.4178 head_norm=0.743346 delta_norm=0.254839
[S5] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=7 metric=0.1767 head_norm=0.847603
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.946013e-01
[S9] stored merged vector for next round verification (round=7)
[S9] DEBUG after merge:  round=7 metric=0.4039 head_norm=0.740019 delta_norm=0.294601
[S9] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=7 metric=0.4222 head_norm=0.741894
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.375579e-01
[S11] stored merged vector for next round verification (round=7)
[S11] DEBUG after merge:  round=7 metric=0.4227 head_norm=0.704116 delta_norm=0.237558
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=1.237884 cos_to_last_merge=1.0000 (last merge round=7)
[S2] round=8 local utility u=0.000000 metrics={'f1_val': 0.7097073267219312, 'auprc': 0.7878939285532951, 'loss_val': 0.5633797688991278, 'psi': 0.7409819674544768}-{'f1_val': 0.7111702393413505, 'auprc': 0.7946245642987921, 'loss_val': 0.5649688749849454, 'psi': 0.7445519693243272}
[S3] START round=8 head_norm_before_train=1.389313 (no previous merge yet)
[S3] round=8 local utility u=0.243996 metrics={'f1_val': 0.393445203353373, 'auprc': 0.9894032593779649, 'loss_val': 0.7099485940465701, 'psi': 0.6318284257632099}-{'f1_val': 0.39645225981545407, 'auprc': 0.8636646627863467, 'loss_val': 0.8387669251687754, 'psi': 0.5833372210038111}
[S4] START round=8 head_norm_before_train=1.087220 cos_to_last_merge=0.9918 (last merge round=6)
[S4] round=8 local utility u=0.000000 metrics={'f1_val': 0.6664628377874746, 'auprc': 0.6507993005459347, 'loss_val': 0.4880842830298631, 'psi': 0.6601974228908587}-{'f1_val': 0.6657718339990659, 'auprc': 0.8163566386783971, 'loss_val': 0.5113405271100323, 'psi': 0.7260057558707984}
[S5] START round=8 head_norm_before_train=0.743346 cos_to_last_merge=1.0000 (last merge round=7)
[S5] round=8 local utility u=0.034024 metrics={'f1_val': 0.4177505557824055, 'auprc': 0.7778214120623232, 'loss_val': 1.082287254040863, 'psi': 0.5617788982943726}-{'f1_val': 0.41734838192522206, 'auprc': 0.7778157892173101, 'loss_val': 1.1479053083459732, 'psi': 0.5615353448420572}
[S6] START round=8 head_norm_before_train=0.975183 cos_to_last_merge=1.0000 (last merge round=7)
[S6] round=8 local utility u=0.248951 metrics={'f1_val': 0.5200256759283611, 'auprc': 0.7819440410844432, 'loss_val': 0.6852132713646791, 'psi': 0.624793021990794}-{'f1_val': 0.43397784312474946, 'auprc': 0.7906408128277315, 'loss_val': 0.6929194431311525, 'psi': 0.5766430310059423}
[S7] START round=8 head_norm_before_train=0.994495 cos_to_last_merge=0.9516 (last merge round=1)
[S7] round=8 local utility u=0.261303 metrics={'f1_val': 0.4170778520170104, 'auprc': 0.7770261711277222, 'loss_val': 0.947543050224399, 'psi': 0.5610571796612951}-{'f1_val': 0.41748350776510673, 'auprc': 0.6486123221363, 'loss_val': 1.0873419916732232, 'psi': 0.509935033513584}
[S8] START round=8 head_norm_before_train=1.562158 (no previous merge yet)
[S8] round=8 local utility u=0.901058 metrics={'f1_val': 0.9948531060745154, 'auprc': 0.9992329191490129, 'loss_val': 0.16778810468912914, 'psi': 0.9966050313043143}-{'f1_val': 0.7138229449839267, 'auprc': 0.9958471046525879, 'loss_val': 0.2735663321484679, 'psi': 0.8266326088513912}
[S9] START round=8 head_norm_before_train=0.740019 cos_to_last_merge=1.0000 (last merge round=7)
[S9] round=8 local utility u=0.593518 metrics={'f1_val': 0.36662526189834077, 'auprc': 0.865580004986349, 'loss_val': 0.9195864347716679, 'psi': 0.566207159133544}-{'f1_val': 0.1767192202394913, 'auprc': 0.8659762081512106, 'loss_val': 0.968374045739557, 'psi': 0.45242201540417903}
[S10] START round=8 head_norm_before_train=1.263160 cos_to_last_merge=0.8674 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.867
[S10] round=8 local utility u=0.000000 metrics={'f1_val': 0.6616287802697718, 'auprc': 0.9672331897748742, 'loss_val': 0.3061687199387592, 'psi': 0.7838705440718128}-{'f1_val': 0.6874565438828282, 'auprc': 0.9469950056198851, 'loss_val': 0.36600454775900976, 'psi': 0.7912719285776509}
[S11] START round=8 head_norm_before_train=0.704116 cos_to_last_merge=1.0000 (last merge round=7)
[S11] round=8 local utility u=0.020974 metrics={'f1_val': 0.41536960847490034, 'auprc': 0.5989141950740993, 'loss_val': 1.0280253765726355, 'psi': 0.4887874431145799}-{'f1_val': 0.4222126204677117, 'auprc': 0.5991931726022137, 'loss_val': 1.11186738748658, 'psi': 0.4930048413215125}
[S13] START round=8 head_norm_before_train=1.530624 (no previous merge yet)
[S13] round=8 local utility u=0.392487 metrics={'f1_val': 0.6827253613646853, 'auprc': 0.6764543017305347, 'loss_val': 0.4785652102447215, 'psi': 0.680216937511025}-{'f1_val': 0.5892829383851299, 'auprc': 0.670136037247336, 'loss_val': 0.6839302135712951, 'psi': 0.6216241779300123}
[S14] START round=8 head_norm_before_train=0.745684 cos_to_last_merge=1.0000 (last merge round=7)
[S14] round=8 local utility u=0.993140 metrics={'f1_val': 0.39604543601422687, 'auprc': 0.9931703366547002, 'loss_val': 1.0036447102737431, 'psi': 0.6348953962704162}-{'f1_val': 0.1539132330499237, 'auprc': 0.8634614494444045, 'loss_val': 1.1480057838721018, 'psi': 0.43773251960771603}
[S15] START round=8 head_norm_before_train=0.932404 cos_to_last_merge=1.0000 (last merge round=7)
[S15] round=8 local utility u=0.191271 metrics={'f1_val': 0.6969080791989006, 'auprc': 0.8159426673399202, 'loss_val': 0.4623918403093037, 'psi': 0.7445219144553085}-{'f1_val': 0.6970831609415726, 'auprc': 0.6824024858948562, 'loss_val': 0.4453638359745268, 'psi': 0.691210890922886}
[S16] START round=8 head_norm_before_train=1.377250 (no previous merge yet)
[S16] round=8 local utility u=0.221489 metrics={'f1_val': 0.4371835062203995, 'auprc': 0.7343995372331389, 'loss_val': 0.9159727709544477, 'psi': 0.5560699186254953}-{'f1_val': 0.3622813497337844, 'auprc': 0.7448815035579887, 'loss_val': 0.9409834024942367, 'psi': 0.5153214112634661}
[S17] START round=8 head_norm_before_train=1.168537 cos_to_last_merge=0.8769 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.877
[S17] round=8 local utility u=0.023545 metrics={'f1_val': 0.38909083750616436, 'auprc': 0.718598449550335, 'loss_val': 0.6989760803155178, 'psi': 0.5208938823238326}-{'f1_val': 0.38296825308015475, 'auprc': 0.7238372540490065, 'loss_val': 0.7250470259857218, 'psi': 0.5193158534676954}
[S11] not sending this round → trigger blocked (psi=0.489)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.566)
[S5] not sending this round → trigger blocked (psi=0.562)
[S14] not sending this round → trigger blocked (psi=0.635)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] → sending delta(kind=head bytes=1793) to S14@127.0.0.1:59814
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] → sending delta(kind=head bytes=1805) to S9@127.0.0.1:59810
[S7] not sending this round → trigger blocked (psi=0.561)
[S6] not sending this round → trigger blocked (psi=0.625)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:59804
[S3] not sending this round → trigger blocked (psi=0.632)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.997)
[S16] sending update (kind=head size=1795 to 1 peers)
[S15] sending update (kind=head size=1793 to 1 peers)
[S13] sending update (kind=head size=1805 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1805) from S13
[S9] cosine check vs S13: cos=0.6665
[S4] RECEIVED delta(kind=head bytes=1795) from S16
[S4] cosine check vs S16: cos=-0.0616
[S4] DROPPED delta from S16 (cos=-0.0616 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1793) from S15
[S14] cosine check vs S15: cos=0.2266
[S17] not sending this round → trigger blocked (psi=0.521)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=8 metric=0.3666 head_norm=0.779461
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.930316e-01
[S9] stored merged vector for next round verification (round=8)
[S9] DEBUG after merge:  round=8 metric=0.4035 head_norm=1.076463 delta_norm=0.593032
[S9] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=8 metric=0.3960 head_norm=0.786644
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.714700e-01
[S14] stored merged vector for next round verification (round=8)
[S14] DEBUG after merge:  round=8 metric=0.3965 head_norm=0.713840 delta_norm=0.571470
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=1.305507 cos_to_last_merge=0.9939 (last merge round=7)
[S2] round=9 local utility u=0.031608 metrics={'f1_val': 0.7053092103014522, 'auprc': 0.789584072821289, 'loss_val': 0.4788459379600516, 'psi': 0.7390191553093869}-{'f1_val': 0.7097073267219312, 'auprc': 0.7878939285532951, 'loss_val': 0.5633797688991278, 'psi': 0.7409819674544768}
[S3] START round=9 head_norm_before_train=1.439521 (no previous merge yet)
[S3] round=9 local utility u=1.000000 metrics={'f1_val': 0.7008362290767893, 'auprc': 0.9937278272171598, 'loss_val': 0.4631898484108268, 'psi': 0.8179928683329376}-{'f1_val': 0.393445203353373, 'auprc': 0.9894032593779649, 'loss_val': 0.7099485940465701, 'psi': 0.6318284257632099}
[S4] START round=9 head_norm_before_train=1.171866 cos_to_last_merge=0.9773 (last merge round=6)
[S4] round=9 local utility u=1.000000 metrics={'f1_val': 0.9515036691992274, 'auprc': 0.9258945710503594, 'loss_val': 0.48919501887366873, 'psi': 0.9412600299396803}-{'f1_val': 0.6664628377874746, 'auprc': 0.6507993005459347, 'loss_val': 0.4880842830298631, 'psi': 0.6601974228908587}
[S5] START round=9 head_norm_before_train=0.770430 cos_to_last_merge=0.9952 (last merge round=7)
[S5] round=9 local utility u=0.057322 metrics={'f1_val': 0.4175873768787894, 'auprc': 0.7777697719690166, 'loss_val': 0.9665090862889333, 'psi': 0.5616603349148803}-{'f1_val': 0.4177505557824055, 'auprc': 0.7778214120623232, 'loss_val': 1.082287254040863, 'psi': 0.5617788982943726}
[S6] START round=9 head_norm_before_train=1.031190 cos_to_last_merge=0.9946 (last merge round=7)
[S6] round=9 local utility u=0.653100 metrics={'f1_val': 0.6979544949798168, 'auprc': 0.7927461853283206, 'loss_val': 0.4789918961530488, 'psi': 0.7358711711192183}-{'f1_val': 0.5200256759283611, 'auprc': 0.7819440410844432, 'loss_val': 0.6852132713646791, 'psi': 0.624793021990794}
[S7] START round=9 head_norm_before_train=1.033807 cos_to_last_merge=0.9374 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.937
[S7] round=9 local utility u=0.955175 metrics={'f1_val': 0.7142988289087885, 'auprc': 0.7923849052279595, 'loss_val': 0.8665942939995264, 'psi': 0.7455332594364569}-{'f1_val': 0.4170778520170104, 'auprc': 0.7770261711277222, 'loss_val': 0.947543050224399, 'psi': 0.5610571796612951}
[S8] START round=9 head_norm_before_train=1.612023 (no previous merge yet)
[S8] round=9 local utility u=0.013579 metrics={'f1_val': 0.9952289782211529, 'auprc': 0.9960379528482114, 'loss_val': 0.13330027200871433, 'psi': 0.9955525680719763}-{'f1_val': 0.9948531060745154, 'auprc': 0.9992329191490129, 'loss_val': 0.16778810468912914, 'psi': 0.9966050313043143}
[S9] START round=9 head_norm_before_train=1.076463 cos_to_last_merge=1.0000 (last merge round=8)
[S9] round=9 local utility u=1.000000 metrics={'f1_val': 0.7010169755020486, 'auprc': 0.9995852640597079, 'loss_val': 0.7416075187989986, 'psi': 0.8204442909251124}-{'f1_val': 0.36662526189834077, 'auprc': 0.865580004986349, 'loss_val': 0.9195864347716679, 'psi': 0.566207159133544}
[S10] START round=9 head_norm_before_train=1.332109 cos_to_last_merge=0.8460 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.846
[S10] round=9 local utility u=1.000000 metrics={'f1_val': 0.9943951802914437, 'auprc': 0.9977617459674891, 'loss_val': 0.1944201799585792, 'psi': 0.9957418065618618}-{'f1_val': 0.6616287802697718, 'auprc': 0.9672331897748742, 'loss_val': 0.3061687199387592, 'psi': 0.7838705440718128}
[S11] START round=9 head_norm_before_train=0.735949 cos_to_last_merge=0.9930 (last merge round=7)
[S11] round=9 local utility u=0.231513 metrics={'f1_val': 0.4005844218082196, 'auprc': 0.736172035369663, 'loss_val': 0.8880608967401313, 'psi': 0.534819467232797}-{'f1_val': 0.41536960847490034, 'auprc': 0.5989141950740993, 'loss_val': 1.0280253765726355, 'psi': 0.4887874431145799}
[S13] START round=9 head_norm_before_train=1.553499 (no previous merge yet)
[S13] round=9 local utility u=0.000000 metrics={'f1_val': 0.5951663266153846, 'auprc': 0.661979569855565, 'loss_val': 0.6843710007057198, 'psi': 0.6218916239114568}-{'f1_val': 0.6827253613646853, 'auprc': 0.6764543017305347, 'loss_val': 0.4785652102447215, 'psi': 0.680216937511025}
[S14] START round=9 head_norm_before_train=0.713840 cos_to_last_merge=1.0000 (last merge round=8)
[S14] round=9 local utility u=0.046315 metrics={'f1_val': 0.39290418175207026, 'auprc': 0.9934778502030561, 'loss_val': 0.8930897782188674, 'psi': 0.6331336491324646}-{'f1_val': 0.39604543601422687, 'auprc': 0.9931703366547002, 'loss_val': 1.0036447102737431, 'psi': 0.6348953962704162}
[S15] START round=9 head_norm_before_train=1.026392 cos_to_last_merge=0.9923 (last merge round=7)
[S15] round=9 local utility u=0.298105 metrics={'f1_val': 0.6963645075096425, 'auprc': 0.9715775796764232, 'loss_val': 0.3298245167436979, 'psi': 0.8064497363763548}-{'f1_val': 0.6969080791989006, 'auprc': 0.8159426673399202, 'loss_val': 0.4623918403093037, 'psi': 0.7445219144553085}
[S16] START round=9 head_norm_before_train=1.417453 (no previous merge yet)
[S16] round=9 local utility u=0.000000 metrics={'f1_val': 0.40335182128862324, 'auprc': 0.7542789559976265, 'loss_val': 0.7967742420078666, 'psi': 0.5437226751722245}-{'f1_val': 0.4371835062203995, 'auprc': 0.7343995372331389, 'loss_val': 0.9159727709544477, 'psi': 0.5560699186254953}
[S17] START round=9 head_norm_before_train=1.191980 cos_to_last_merge=0.8697 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.870
[S17] round=9 local utility u=0.092398 metrics={'f1_val': 0.3926379638438736, 'auprc': 0.7639765364353361, 'loss_val': 0.67159751296493, 'psi': 0.5411733928804586}-{'f1_val': 0.38909083750616436, 'auprc': 0.718598449550335, 'loss_val': 0.6989760803155178, 'psi': 0.5208938823238326}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:59810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:59815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S9] → sending delta(kind=head bytes=1790) to S14@127.0.0.1:59814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:59807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S10] → sending delta(kind=head bytes=1807) to S4@127.0.0.1:59804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:59810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:59805
[S15] not sending this round → trigger blocked (psi=0.806)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:59807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:59812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:59802
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S7] → sending delta(kind=head bytes=1793) to S6@127.0.0.1:59807
[S3] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1795 to 1 peers)
[S2] sending update (kind=head size=1804 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1807 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1790 to 1 peers)
[S7] sending update (kind=head size=1793 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1804) from S2
[S6] cosine check vs S2: cos=0.5063
[S6] RECEIVED delta(kind=head bytes=1796) from S8
[S6] cosine check vs S8: cos=0.8009
[S15] RECEIVED delta(kind=head bytes=1799) from S6
[S15] cosine check vs S6: cos=0.7110
[S14] RECEIVED delta(kind=head bytes=1790) from S9
[S14] cosine check vs S9: cos=0.4897
[S9] RECEIVED delta(kind=head bytes=1802) from S11
[S9] cosine check vs S11: cos=0.6179
[S9] RECEIVED delta(kind=head bytes=1802) from S5
[S9] cosine check vs S5: cos=0.0042
[S11] RECEIVED delta(kind=head bytes=1795) from S14
[S11] cosine check vs S14: cos=0.6860
[S5] RECEIVED delta(kind=head bytes=1800) from S4
[S5] cosine check vs S4: cos=0.5669
[S2] RECEIVED delta(kind=head bytes=1800) from S3
[S2] cosine check vs S3: cos=0.9069
[S6] RECEIVED delta(kind=head bytes=1793) from S7
[S6] cosine check vs S7: cos=-0.0150
[S6] DROPPED delta from S7 (cos=-0.0150 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1807) from S10
[S4] cosine check vs S10: cos=0.7054
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:59805
[S17] sending update (kind=head size=1799 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1799) from S17
[S5] cosine check vs S17: cos=0.7693
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=9 metric=0.6964 head_norm=1.136608
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.261162e-01
[S15] stored merged vector for next round verification (round=9)
[S15] DEBUG after merge:  round=9 metric=0.6970 head_norm=1.036148 delta_norm=0.426116
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=9 metric=0.7053 head_norm=1.384450
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.139767e-01
[S2] stored merged vector for next round verification (round=9)
[S2] DEBUG after merge:  round=9 metric=0.6996 head_norm=1.402537 delta_norm=0.313977
[S2] aggregate: ROLLBACK (f1_val pre=0.705 post=0.700 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=9 metric=0.4176 head_norm=0.809142
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.018058e-01
[S5] stored merged vector for next round verification (round=9)
[S5] DEBUG after merge:  round=9 metric=0.4178 head_norm=0.837036 delta_norm=0.201806
[S5] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=9 metric=0.7010 head_norm=1.116160
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.140826e-01
[S9] stored merged vector for next round verification (round=9)
[S9] DEBUG after merge:  round=9 metric=0.7010 head_norm=0.731254 delta_norm=0.514083
[S9] aggregate: ACCEPT kept=['S11', 'S5'] (k=2/2) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=9 metric=0.6980 head_norm=1.103847
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.228480e-01
[S6] stored merged vector for next round verification (round=9)
[S6] DEBUG after merge:  round=9 metric=0.6976 head_norm=1.107160 delta_norm=0.322848
[S6] aggregate: ACCEPT kept=['S2', 'S8'] (k=2/2) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=9 metric=0.9515 head_norm=1.230510
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.090625e-01
[S4] stored merged vector for next round verification (round=9)
[S4] DEBUG after merge:  round=9 metric=0.6127 head_norm=1.211738 delta_norm=0.509062
[S4] aggregate: ROLLBACK (f1_val pre=0.952 post=0.613 tol_abs=0.005 tol_rel=0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=9 metric=0.4006 head_norm=0.778730
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.057629e-01
[S11] stored merged vector for next round verification (round=9)
[S11] DEBUG after merge:  round=9 metric=0.3999 head_norm=0.708405 delta_norm=0.305763
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=9 metric=0.3929 head_norm=0.764355
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.985987e-01
[S14] stored merged vector for next round verification (round=9)
[S14] DEBUG after merge:  round=9 metric=0.3963 head_norm=0.816348 delta_norm=0.498599
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=1.402537 cos_to_last_merge=1.0000 (last merge round=9)
[S2] round=10 local utility u=0.000000 metrics={'f1_val': 0.7007103930945783, 'auprc': 0.7576187719077967, 'loss_val': 0.4669060836020357, 'psi': 0.7234737446198656}-{'f1_val': 0.7053092103014522, 'auprc': 0.789584072821289, 'loss_val': 0.4788459379600516, 'psi': 0.7390191553093869}
[S3] START round=10 head_norm_before_train=1.488180 (no previous merge yet)
[S3] round=10 local utility u=0.000000 metrics={'f1_val': 0.6865772624261968, 'auprc': 0.9931445603607254, 'loss_val': 0.4077589783362907, 'psi': 0.8092041816000082}-{'f1_val': 0.7008362290767893, 'auprc': 0.9937278272171598, 'loss_val': 0.4631898484108268, 'psi': 0.8179928683329376}
[S4] START round=10 head_norm_before_train=1.211738 cos_to_last_merge=1.0000 (last merge round=9)
[S4] round=10 local utility u=0.000000 metrics={'f1_val': 0.6131768878117078, 'auprc': 0.9338880271381323, 'loss_val': 0.5103118588269773, 'psi': 0.7414613435422777}-{'f1_val': 0.9515036691992274, 'auprc': 0.9258945710503594, 'loss_val': 0.48919501887366873, 'psi': 0.9412600299396803}
[S5] START round=10 head_norm_before_train=0.837036 cos_to_last_merge=1.0000 (last merge round=9)
[S5] round=10 local utility u=0.249862 metrics={'f1_val': 0.4174261421979377, 'auprc': 0.9109267865079385, 'loss_val': 0.8652888994257638, 'psi': 0.614826399921938}-{'f1_val': 0.4175873768787894, 'auprc': 0.7777697719690166, 'loss_val': 0.9665090862889333, 'psi': 0.5616603349148803}
[S6] START round=10 head_norm_before_train=1.107160 cos_to_last_merge=1.0000 (last merge round=9)
[S6] round=10 local utility u=0.257966 metrics={'f1_val': 0.6961639786304212, 'auprc': 0.9610821393989442, 'loss_val': 0.4573252380522321, 'psi': 0.8021312429378304}-{'f1_val': 0.6979544949798168, 'auprc': 0.7927461853283206, 'loss_val': 0.4789918961530488, 'psi': 0.7358711711192183}
[S7] START round=10 head_norm_before_train=1.074520 cos_to_last_merge=0.9233 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.923
[S7] round=10 local utility u=0.021896 metrics={'f1_val': 0.7134435512157704, 'auprc': 0.7877745196147465, 'loss_val': 0.8038393617645448, 'psi': 0.7431759385753609}-{'f1_val': 0.7142988289087885, 'auprc': 0.7923849052279595, 'loss_val': 0.8665942939995264, 'psi': 0.7455332594364569}
[S8] START round=10 head_norm_before_train=1.661923 (no previous merge yet)
[S8] round=10 local utility u=0.030956 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9990755202746311, 'loss_val': 0.08634560615190977, 'psi': 0.9973520701499441}-{'f1_val': 0.9952289782211529, 'auprc': 0.9960379528482114, 'loss_val': 0.13330027200871433, 'psi': 0.9955525680719763}
[S9] START round=10 head_norm_before_train=0.731254 cos_to_last_merge=1.0000 (last merge round=9)
[S9] round=10 local utility u=0.000885 metrics={'f1_val': 0.701513881536201, 'auprc': 0.9995810125461396, 'loss_val': 0.7428071063883293, 'psi': 0.8207407339401764}-{'f1_val': 0.7010169755020486, 'auprc': 0.9995852640597079, 'loss_val': 0.7416075187989986, 'psi': 0.8204442909251124}
[S10] START round=10 head_norm_before_train=1.393109 cos_to_last_merge=0.8307 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.831
[S10] round=10 local utility u=0.023707 metrics={'f1_val': 0.9948097081739261, 'auprc': 0.997185520334197, 'loss_val': 0.14776397295731386, 'psi': 0.9957600330380345}-{'f1_val': 0.9943951802914437, 'auprc': 0.9977617459674891, 'loss_val': 0.1944201799585792, 'psi': 0.9957418065618618}
[S11] START round=10 head_norm_before_train=0.708405 cos_to_last_merge=1.0000 (last merge round=9)
[S11] round=10 local utility u=0.808472 metrics={'f1_val': 0.6608752119100274, 'auprc': 0.7371728833815809, 'loss_val': 0.8358637059040734, 'psi': 0.6913942804986488}-{'f1_val': 0.4005844218082196, 'auprc': 0.736172035369663, 'loss_val': 0.8880608967401313, 'psi': 0.534819467232797}
[S13] START round=10 head_norm_before_train=1.572542 (no previous merge yet)
[S13] round=10 local utility u=0.204596 metrics={'f1_val': 0.6320661196353445, 'auprc': 0.6781547049113474, 'loss_val': 0.5451035516284364, 'psi': 0.6505015537457457}-{'f1_val': 0.5951663266153846, 'auprc': 0.661979569855565, 'loss_val': 0.6843710007057198, 'psi': 0.6218916239114568}
[S14] START round=10 head_norm_before_train=0.816348 cos_to_last_merge=1.0000 (last merge round=9)
[S14] round=10 local utility u=0.952215 metrics={'f1_val': 0.6839654744609298, 'auprc': 0.9951202938636636, 'loss_val': 0.7399551542589726, 'psi': 0.8084274022220234}-{'f1_val': 0.39290418175207026, 'auprc': 0.9934778502030561, 'loss_val': 0.8930897782188674, 'psi': 0.6331336491324646}
[S15] START round=10 head_norm_before_train=1.036148 cos_to_last_merge=1.0000 (last merge round=9)
[S15] round=10 local utility u=0.000000 metrics={'f1_val': 0.6937978493722929, 'auprc': 0.9652482845975586, 'loss_val': 0.3733972612433315, 'psi': 0.8023780234623992}-{'f1_val': 0.6963645075096425, 'auprc': 0.9715775796764232, 'loss_val': 0.3298245167436979, 'psi': 0.8064497363763548}
[S16] START round=10 head_norm_before_train=1.450809 (no previous merge yet)
[S16] round=10 local utility u=0.325066 metrics={'f1_val': 0.49237343748266504, 'auprc': 0.7692301474567814, 'loss_val': 0.7256247032757074, 'psi': 0.6031161214723115}-{'f1_val': 0.40335182128862324, 'auprc': 0.7542789559976265, 'loss_val': 0.7967742420078666, 'psi': 0.5437226751722245}
[S17] START round=10 head_norm_before_train=1.213563 cos_to_last_merge=0.8644 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.864
[S17] round=10 local utility u=0.059945 metrics={'f1_val': 0.39265804564582507, 'auprc': 0.7972019021683748, 'loss_val': 0.6515040905448759, 'psi': 0.554475588254845}-{'f1_val': 0.3926379638438736, 'auprc': 0.7639765364353361, 'loss_val': 0.67159751296493, 'psi': 0.5411733928804586}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:59807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:59815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S14] → sending delta(kind=head bytes=1790) to S11@127.0.0.1:59812
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:59810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:59804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:59814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:59804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:59810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:59807
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:59810
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1794 to 1 peers)
[S8] sending update (kind=head size=1804 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1790 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1803 to 1 peers)
[S13] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1795 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1803) from S13
[S9] cosine check vs S13: cos=0.8156
[S9] RECEIVED delta(kind=head bytes=1800) from S11
[S9] cosine check vs S11: cos=0.7143
[S6] RECEIVED delta(kind=head bytes=1804) from S8
[S6] cosine check vs S8: cos=0.8334
[S6] RECEIVED delta(kind=head bytes=1795) from S7
[S6] cosine check vs S7: cos=-0.0120
[S6] DROPPED delta from S7 (cos=-0.0120 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1801) from S9
[S14] cosine check vs S9: cos=0.8903
[S15] RECEIVED delta(kind=head bytes=1801) from S6
[S15] cosine check vs S6: cos=0.8348
[S4] RECEIVED delta(kind=head bytes=1803) from S10
[S4] cosine check vs S10: cos=0.9062
[S4] RECEIVED delta(kind=head bytes=1803) from S16
[S4] cosine check vs S16: cos=-0.0462
[S4] DROPPED delta from S16 (cos=-0.0462 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1794) from S5
[S9] cosine check vs S5: cos=0.2966
[S11] RECEIVED delta(kind=head bytes=1790) from S14
[S11] cosine check vs S14: cos=0.8318
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:59805
[S17] sending update (kind=head size=1801 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1801) from S17
[S5] cosine check vs S17: cos=0.7646
[S2] ⇄ pheromone p=0.249 → S6@127.0.0.1:59807
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=10 metric=0.6132 head_norm=1.260633
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.063666e-01
[S4] stored merged vector for next round verification (round=10)
[S4] DEBUG after merge:  round=10 metric=0.6127 head_norm=1.320624 delta_norm=0.306367
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.347 → S5@127.0.0.1:59805
[S3] ⇄ pheromone p=0.418 → S2@127.0.0.1:59802
[S10] ⇄ pheromone p=0.404 → S4@127.0.0.1:59804
[S16] ⇄ pheromone p=0.311 → S4@127.0.0.1:59804
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=10 metric=0.6840 head_norm=0.870704
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.982429e-01
[S14] stored merged vector for next round verification (round=10)
[S14] DEBUG after merge:  round=10 metric=0.5121 head_norm=0.802051 delta_norm=0.198243
[S14] aggregate: ROLLBACK (f1_val pre=0.684 post=0.512 tol_abs=0.005 tol_rel=0.0)
[S14] ⇄ pheromone p=0.485 → S11@127.0.0.1:59812
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=10 metric=0.6609 head_norm=0.748176
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.419255e-01
[S11] stored merged vector for next round verification (round=10)
[S11] DEBUG after merge:  round=10 metric=0.6962 head_norm=0.774867 delta_norm=0.241926
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.404 → S9@127.0.0.1:59810
[S7] ⇄ pheromone p=0.374 → S6@127.0.0.1:59807
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=10 metric=0.4174 head_norm=0.872802
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.979949e-01
[S5] stored merged vector for next round verification (round=10)
[S5] DEBUG after merge:  round=10 metric=0.4174 head_norm=0.989683 delta_norm=0.397995
[S5] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.268 → S9@127.0.0.1:59810
[S9] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=10 metric=0.7015 head_norm=0.779132
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.578838e-01
[S9] stored merged vector for next round verification (round=10)
[S9] DEBUG after merge:  round=10 metric=0.7015 head_norm=0.700547 delta_norm=0.157884
[S9] aggregate: ACCEPT kept=['S13', 'S11', 'S5'] (k=3/3) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.366 → S14@127.0.0.1:59814
[S8] ⇄ pheromone p=0.386 → S6@127.0.0.1:59807
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=10 metric=0.6962 head_norm=1.169974
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.894860e-01
[S6] stored merged vector for next round verification (round=10)
[S6] DEBUG after merge:  round=10 metric=0.6968 head_norm=1.380996 delta_norm=0.489486
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.349 → S15@127.0.0.1:59815
[S13] ⇄ pheromone p=0.338 → S9@127.0.0.1:59810
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=10 metric=0.6938 head_norm=1.123678
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.303048e-01
[S15] stored merged vector for next round verification (round=10)
[S15] DEBUG after merge:  round=10 metric=0.6947 head_norm=1.098474 delta_norm=0.330305
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.301 → S14@127.0.0.1:59814
[S17] ⇄ pheromone p=0.220 → S5@127.0.0.1:59805
[S2] START round=11 head_norm_before_train=1.461385 cos_to_last_merge=0.9972 (last merge round=9)
[S2] round=11 local utility u=0.042176 metrics={'f1_val': 0.7131199050205699, 'auprc': 0.7890762491330383, 'loss_val': 0.551383424759099, 'psi': 0.7435024426655572}-{'f1_val': 0.7007103930945783, 'auprc': 0.7576187719077967, 'loss_val': 0.4669060836020357, 'psi': 0.7234737446198656}
[S3] START round=11 head_norm_before_train=1.533970 (no previous merge yet)
[S3] round=11 local utility u=0.088233 metrics={'f1_val': 0.7005813959920884, 'auprc': 0.9956962702688937, 'loss_val': 0.3229734969836554, 'psi': 0.8186273457028105}-{'f1_val': 0.6865772624261968, 'auprc': 0.9931445603607254, 'loss_val': 0.4077589783362907, 'psi': 0.8092041816000082}
[S4] START round=11 head_norm_before_train=1.320624 cos_to_last_merge=1.0000 (last merge round=10)
[S4] round=11 local utility u=0.000000 metrics={'f1_val': 0.6127674518652969, 'auprc': 0.9384578276675248, 'loss_val': 0.532878792998416, 'psi': 0.7430436021861881}-{'f1_val': 0.6131768878117078, 'auprc': 0.9338880271381323, 'loss_val': 0.5103118588269773, 'psi': 0.7414613435422777}
[S5] START round=11 head_norm_before_train=0.989683 cos_to_last_merge=1.0000 (last merge round=10)
[S5] round=11 local utility u=0.000000 metrics={'f1_val': 0.4175465518408786, 'auprc': 0.7576323246355369, 'loss_val': 0.8306639299025089, 'psi': 0.5535808609587419}-{'f1_val': 0.4174261421979377, 'auprc': 0.9109267865079385, 'loss_val': 0.8652888994257638, 'psi': 0.614826399921938}
[S6] START round=11 head_norm_before_train=1.380996 cos_to_last_merge=1.0000 (last merge round=10)
[S6] round=11 local utility u=0.038900 metrics={'f1_val': 0.6951420718079422, 'auprc': 0.9601440292102947, 'loss_val': 0.37057929051750205, 'psi': 0.8011428547688833}-{'f1_val': 0.6961639786304212, 'auprc': 0.9610821393989442, 'loss_val': 0.4573252380522321, 'psi': 0.8021312429378304}
[S7] START round=11 head_norm_before_train=1.112009 cos_to_last_merge=0.9106 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.911
[S7] round=11 local utility u=0.000000 metrics={'f1_val': 0.6762084979474166, 'auprc': 0.7852365432878359, 'loss_val': 0.7171730993874155, 'psi': 0.7198197160835843}-{'f1_val': 0.7134435512157704, 'auprc': 0.7877745196147465, 'loss_val': 0.8038393617645448, 'psi': 0.7431759385753609}
[S8] START round=11 head_norm_before_train=1.710161 (no previous merge yet)
[S8] round=11 local utility u=0.012329 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9992594033625164, 'loss_val': 0.06313981043447599, 'psi': 0.9975156063063813}-{'f1_val': 0.9962031034001528, 'auprc': 0.9990755202746311, 'loss_val': 0.08634560615190977, 'psi': 0.9973520701499441}
[S9] START round=11 head_norm_before_train=0.700547 cos_to_last_merge=1.0000 (last merge round=10)
[S9] round=11 local utility u=0.045595 metrics={'f1_val': 0.7014391336149548, 'auprc': 0.9992124389617013, 'loss_val': 0.6500622713902375, 'psi': 0.8205484557536533}-{'f1_val': 0.701513881536201, 'auprc': 0.9995810125461396, 'loss_val': 0.7428071063883293, 'psi': 0.8207407339401764}
[S10] START round=11 head_norm_before_train=1.444513 cos_to_last_merge=0.8206 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.821
[S10] round=11 local utility u=0.000000 metrics={'f1_val': 0.8916045858527388, 'auprc': 0.9925460064171967, 'loss_val': 0.257798404676876, 'psi': 0.931981154078522}-{'f1_val': 0.9948097081739261, 'auprc': 0.997185520334197, 'loss_val': 0.14776397295731386, 'psi': 0.9957600330380345}
[S11] START round=11 head_norm_before_train=0.774867 cos_to_last_merge=1.0000 (last merge round=10)
[S11] round=11 local utility u=0.363957 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.8825006593408357, 'loss_val': 0.7902943998688209, 'psi': 0.7741614537153263}-{'f1_val': 0.6608752119100274, 'auprc': 0.7371728833815809, 'loss_val': 0.8358637059040734, 'psi': 0.6913942804986488}
[S13] START round=11 head_norm_before_train=1.598166 (no previous merge yet)
[S13] round=11 local utility u=0.000000 metrics={'f1_val': 0.593616003280157, 'auprc': 0.635830031915492, 'loss_val': 0.8193441179804172, 'psi': 0.610501614734291}-{'f1_val': 0.6320661196353445, 'auprc': 0.6781547049113474, 'loss_val': 0.5451035516284364, 'psi': 0.6505015537457457}
[S14] START round=11 head_norm_before_train=0.802051 cos_to_last_merge=1.0000 (last merge round=10)
[S14] round=11 local utility u=0.109449 metrics={'f1_val': 0.7012661327274514, 'auprc': 0.9975002854687086, 'loss_val': 0.6320006665488216, 'psi': 0.8197597938239543}-{'f1_val': 0.6839654744609298, 'auprc': 0.9951202938636636, 'loss_val': 0.7399551542589726, 'psi': 0.8084274022220234}
[S15] START round=11 head_norm_before_train=1.098474 cos_to_last_merge=1.0000 (last merge round=10)
[S15] round=11 local utility u=0.000000 metrics={'f1_val': 0.695662980773081, 'auprc': 0.9603639594865658, 'loss_val': 0.4206521392761289, 'psi': 0.8015433722584749}-{'f1_val': 0.6937978493722929, 'auprc': 0.9652482845975586, 'loss_val': 0.3733972612433315, 'psi': 0.8023780234623992}
[S16] START round=11 head_norm_before_train=1.484026 (no previous merge yet)
[S16] round=11 local utility u=0.034389 metrics={'f1_val': 0.4762341014168758, 'auprc': 0.8028241301824575, 'loss_val': 0.6607933265036585, 'psi': 0.6068701129231084}-{'f1_val': 0.49237343748266504, 'auprc': 0.7692301474567814, 'loss_val': 0.7256247032757074, 'psi': 0.6031161214723115}
[S17] START round=11 head_norm_before_train=1.230432 cos_to_last_merge=0.8607 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.861
[S17] round=11 local utility u=0.602138 metrics={'f1_val': 0.5706857636080408, 'auprc': 0.8303781374144327, 'loss_val': 0.6149227773848885, 'psi': 0.6745627131305976}-{'f1_val': 0.39265804564582507, 'auprc': 0.7972019021683748, 'loss_val': 0.6515040905448759, 'psi': 0.554475588254845}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] → sending delta(kind=head bytes=1793) to S2@127.0.0.1:59802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:59814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] → sending delta(kind=head bytes=1805) to S6@127.0.0.1:59807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:59812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:59810
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:59815
[S11] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1805 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1794 to 1 peers)
[S6] sending update (kind=head size=1804 to 1 peers)
[S3] sending update (kind=head size=1793 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1801) from S14
[S11] cosine check vs S14: cos=0.9239
[S2] RECEIVED delta(kind=head bytes=1793) from S3
[S2] cosine check vs S3: cos=0.9444
[S14] RECEIVED delta(kind=head bytes=1794) from S9
[S14] cosine check vs S9: cos=0.9657
[S9] RECEIVED delta(kind=head bytes=1796) from S11
[S9] cosine check vs S11: cos=0.8852
[S15] RECEIVED delta(kind=head bytes=1804) from S6
[S15] cosine check vs S6: cos=0.8781
[S6] RECEIVED delta(kind=head bytes=1805) from S8
[S6] cosine check vs S8: cos=0.9620
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:59804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:59807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:59805
[S17] sending update (kind=head size=1802 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1802) from S17
[S5] cosine check vs S17: cos=0.9485
[S4] RECEIVED delta(kind=head bytes=1796) from S16
[S4] cosine check vs S16: cos=-0.0363
[S4] DROPPED delta from S16 (cos=-0.0363 < 0.0)
[S2] sending update (kind=head size=1804 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1804) from S2
[S6] cosine check vs S2: cos=0.3817
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=11 metric=0.4175 head_norm=1.020693
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.136446e-01
[S5] stored merged vector for next round verification (round=11)
[S5] DEBUG after merge:  round=11 metric=0.4177 head_norm=1.119469 delta_norm=0.213645
[S5] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=11 metric=0.6951 head_norm=1.428134
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.307002e-01
[S6] stored merged vector for next round verification (round=11)
[S6] DEBUG after merge:  round=11 metric=0.6951 head_norm=1.313781 delta_norm=0.330700
[S6] aggregate: ACCEPT kept=['S8', 'S2'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=11 metric=0.7014 head_norm=0.756170
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.905277e-01
[S9] stored merged vector for next round verification (round=11)
[S9] DEBUG after merge:  round=11 metric=0.7014 head_norm=0.763074 delta_norm=0.190528
[S9] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=11 metric=0.7013 head_norm=0.859890
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.175862e-01
[S14] stored merged vector for next round verification (round=11)
[S14] DEBUG after merge:  round=11 metric=0.5214 head_norm=0.801109 delta_norm=0.117586
[S14] aggregate: ROLLBACK (f1_val pre=0.701 post=0.521 tol_abs=0.005 tol_rel=0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=11 metric=0.7019 head_norm=0.815704
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.648785e-01
[S11] stored merged vector for next round verification (round=11)
[S11] DEBUG after merge:  round=11 metric=0.7020 head_norm=0.821710 delta_norm=0.164878
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=11 metric=0.6957 head_norm=1.194815
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.429085e-01
[S15] stored merged vector for next round verification (round=11)
[S15] DEBUG after merge:  round=11 metric=0.6960 head_norm=1.271215 delta_norm=0.342909
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=11 metric=0.7131 head_norm=1.513651
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.593237e-01
[S2] stored merged vector for next round verification (round=11)
[S2] DEBUG after merge:  round=11 metric=0.7111 head_norm=1.523157 delta_norm=0.259324
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.523157 cos_to_last_merge=1.0000 (last merge round=11)
[S2] round=12 local utility u=0.003763 metrics={'f1_val': 0.7186824843118195, 'auprc': 0.7857829795953768, 'loss_val': 0.5673529214193749, 'psi': 0.7455226824252424}-{'f1_val': 0.7131199050205699, 'auprc': 0.7890762491330383, 'loss_val': 0.551383424759099, 'psi': 0.7435024426655572}
[S3] START round=12 head_norm_before_train=1.575872 (no previous merge yet)
[S3] round=12 local utility u=0.029553 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9980655057703599, 'loss_val': 0.27157353601131623, 'psi': 0.8196347781073448}-{'f1_val': 0.7005813959920884, 'auprc': 0.9956962702688937, 'loss_val': 0.3229734969836554, 'psi': 0.8186273457028105}
[S4] START round=12 head_norm_before_train=1.383758 cos_to_last_merge=0.9947 (last merge round=10)
[S4] round=12 local utility u=0.969963 metrics={'f1_val': 0.926076783387488, 'auprc': 0.9400301035819103, 'loss_val': 0.47752534680168707, 'psi': 0.9316581114652569}-{'f1_val': 0.6127674518652969, 'auprc': 0.9384578276675248, 'loss_val': 0.532878792998416, 'psi': 0.7430436021861881}
[S5] START round=12 head_norm_before_train=1.119469 cos_to_last_merge=1.0000 (last merge round=11)
[S5] round=12 local utility u=0.846895 metrics={'f1_val': 0.6250635770990443, 'auprc': 0.8621562859128644, 'loss_val': 0.6955484298712005, 'psi': 0.7199006606245724}-{'f1_val': 0.4175465518408786, 'auprc': 0.7576323246355369, 'loss_val': 0.8306639299025089, 'psi': 0.5535808609587419}
[S6] START round=12 head_norm_before_train=1.313781 cos_to_last_merge=1.0000 (last merge round=11)
[S6] round=12 local utility u=0.000000 metrics={'f1_val': 0.7072428994429236, 'auprc': 0.7800781475777342, 'loss_val': 0.48479061620458985, 'psi': 0.7363769986968478}-{'f1_val': 0.6951420718079422, 'auprc': 0.9601440292102947, 'loss_val': 0.37057929051750205, 'psi': 0.8011428547688833}
[S7] START round=12 head_norm_before_train=1.145269 cos_to_last_merge=0.8991 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.899
[S7] round=12 local utility u=0.000000 metrics={'f1_val': 0.5488755007480492, 'auprc': 0.873427475743662, 'loss_val': 0.7393661578258401, 'psi': 0.6786962907462943}-{'f1_val': 0.6762084979474166, 'auprc': 0.7852365432878359, 'loss_val': 0.7171730993874155, 'psi': 0.7198197160835843}
[S8] START round=12 head_norm_before_train=1.752913 (no previous merge yet)
[S8] round=12 local utility u=0.003259 metrics={'f1_val': 0.995982489643123, 'auprc': 0.999312249296832, 'loss_val': 0.05455629205876226, 'psi': 0.9973143935046066}-{'f1_val': 0.9963530749356245, 'auprc': 0.9992594033625164, 'loss_val': 0.06313981043447599, 'psi': 0.9975156063063813}
[S9] START round=12 head_norm_before_train=0.763074 cos_to_last_merge=1.0000 (last merge round=11)
[S9] round=12 local utility u=0.053675 metrics={'f1_val': 0.7014391336149548, 'auprc': 0.9995044892965425, 'loss_val': 0.5435877516990235, 'psi': 0.8206652758875899}-{'f1_val': 0.7014391336149548, 'auprc': 0.9992124389617013, 'loss_val': 0.6500622713902375, 'psi': 0.8205484557536533}
[S10] START round=12 head_norm_before_train=1.482316 cos_to_last_merge=0.8139 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.814
[S10] round=12 local utility u=0.368886 metrics={'f1_val': 0.9953300781987324, 'auprc': 0.9932846386579197, 'loss_val': 0.14459429049007616, 'psi': 0.9945119023824073}-{'f1_val': 0.8916045858527388, 'auprc': 0.9925460064171967, 'loss_val': 0.257798404676876, 'psi': 0.931981154078522}
[S11] START round=12 head_norm_before_train=0.821710 cos_to_last_merge=1.0000 (last merge round=11)
[S11] round=12 local utility u=0.000000 metrics={'f1_val': 0.6958415073386657, 'auprc': 0.793841217482036, 'loss_val': 0.693162860751293, 'psi': 0.7350413913960138}-{'f1_val': 0.7019353166316534, 'auprc': 0.8825006593408357, 'loss_val': 0.7902943998688209, 'psi': 0.7741614537153263}
[S13] START round=12 head_norm_before_train=1.633117 (no previous merge yet)
[S13] round=12 local utility u=0.234321 metrics={'f1_val': 0.6190921423359671, 'auprc': 0.6593549278528983, 'loss_val': 0.5741331462029208, 'psi': 0.6351972565427395}-{'f1_val': 0.593616003280157, 'auprc': 0.635830031915492, 'loss_val': 0.8193441179804172, 'psi': 0.610501614734291}
[S14] START round=12 head_norm_before_train=0.801109 cos_to_last_merge=1.0000 (last merge round=11)
[S14] round=12 local utility u=0.000000 metrics={'f1_val': 0.6413818320954897, 'auprc': 0.9917626139278053, 'loss_val': 0.6144431570803172, 'psi': 0.7815341448284159}-{'f1_val': 0.7012661327274514, 'auprc': 0.9975002854687086, 'loss_val': 0.6320006665488216, 'psi': 0.8197597938239543}
[S15] START round=12 head_norm_before_train=1.271215 cos_to_last_merge=1.0000 (last merge round=11)
[S15] round=12 local utility u=0.024564 metrics={'f1_val': 0.6967945069082401, 'auprc': 0.966065918060013, 'loss_val': 0.39541959622253603, 'psi': 0.8045030713689492}-{'f1_val': 0.695662980773081, 'auprc': 0.9603639594865658, 'loss_val': 0.4206521392761289, 'psi': 0.8015433722584749}
[S16] START round=12 head_norm_before_train=1.522290 (no previous merge yet)
[S16] round=12 local utility u=0.427633 metrics={'f1_val': 0.5757619997883974, 'auprc': 0.8713103069548013, 'loss_val': 0.6081529742610581, 'psi': 0.6939813226549589}-{'f1_val': 0.4762341014168758, 'auprc': 0.8028241301824575, 'loss_val': 0.6607933265036585, 'psi': 0.6068701129231084}
[S17] START round=12 head_norm_before_train=1.247355 cos_to_last_merge=0.8574 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.857
[S17] round=12 local utility u=0.000000 metrics={'f1_val': 0.3947646545437155, 'auprc': 0.9284865875867543, 'loss_val': 0.5842342977733027, 'psi': 0.608253427760931}-{'f1_val': 0.5706857636080408, 'auprc': 0.8303781374144327, 'loss_val': 0.6149227773848885, 'psi': 0.6745627131305976}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:59810
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1803 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1803) from S13
[S9] cosine check vs S13: cos=0.7004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:59810
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:59814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:59807
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:59805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:59814
[S9] RECEIVED delta(kind=head bytes=1797) from S5
[S9] cosine check vs S5: cos=0.0924
[S4] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:59804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:59802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:59807
[S2] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:59804
[S5] RECEIVED delta(kind=head bytes=1801) from S4
[S5] cosine check vs S4: cos=0.1786
[S6] RECEIVED delta(kind=head bytes=1796) from S2
[S6] cosine check vs S2: cos=0.5333
[S14] RECEIVED delta(kind=head bytes=1800) from S15
[S14] cosine check vs S15: cos=0.0898
[S14] RECEIVED delta(kind=head bytes=1800) from S9
[S14] cosine check vs S9: cos=0.9781
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1802) from S8
[S6] cosine check vs S8: cos=0.9130
[S2] RECEIVED delta(kind=head bytes=1798) from S3
[S2] cosine check vs S3: cos=0.9778
[S4] RECEIVED delta(kind=head bytes=1800) from S16
[S4] cosine check vs S16: cos=-0.0349
[S4] DROPPED delta from S16 (cos=-0.0349 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1801) from S10
[S4] cosine check vs S10: cos=0.9235
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=12 metric=0.6251 head_norm=1.149169
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.466123e-01
[S5] stored merged vector for next round verification (round=12)
[S5] DEBUG after merge:  round=12 metric=0.4090 head_norm=1.008774 delta_norm=0.846612
[S5] aggregate: ROLLBACK (f1_val pre=0.625 post=0.409 tol_abs=0.005 tol_rel=0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=12 metric=0.9261 head_norm=1.465661
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.916059e-01
[S4] stored merged vector for next round verification (round=12)
[S4] DEBUG after merge:  round=12 metric=0.6121 head_norm=1.458552 delta_norm=0.291606
[S4] aggregate: ROLLBACK (f1_val pre=0.926 post=0.612 tol_abs=0.005 tol_rel=0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=12 metric=0.7187 head_norm=1.563986
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.689527e-01
[S2] stored merged vector for next round verification (round=12)
[S2] DEBUG after merge:  round=12 metric=0.7186 head_norm=1.579222 delta_norm=0.168953
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=12 metric=0.7014 head_norm=0.827569
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.030465e-01
[S9] stored merged vector for next round verification (round=12)
[S9] DEBUG after merge:  round=12 metric=0.7014 head_norm=0.827439 delta_norm=0.403047
[S9] aggregate: ACCEPT kept=['S13', 'S5'] (k=2/2) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=12 metric=0.7072 head_norm=1.359712
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.151877e-01
[S6] stored merged vector for next round verification (round=12)
[S6] DEBUG after merge:  round=12 metric=0.7072 head_norm=1.313237 delta_norm=0.215188
[S6] aggregate: ACCEPT kept=['S2', 'S8'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=12 metric=0.6414 head_norm=0.852529
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.986071e-01
[S14] stored merged vector for next round verification (round=12)
[S14] DEBUG after merge:  round=12 metric=0.6423 head_norm=0.745364 delta_norm=0.398607
[S14] aggregate: ACCEPT kept=['S15', 'S9'] (k=2/2) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.579222 cos_to_last_merge=1.0000 (last merge round=12)
[S2] round=13 local utility u=0.000000 metrics={'f1_val': 0.7196268902804956, 'auprc': 0.7605210704047883, 'loss_val': 0.6040809761158393, 'psi': 0.7359845623302127}-{'f1_val': 0.7186824843118195, 'auprc': 0.7857829795953768, 'loss_val': 0.5673529214193749, 'psi': 0.7455226824252424}
[S3] START round=13 head_norm_before_train=1.612116 (no previous merge yet)
[S3] round=13 local utility u=0.000000 metrics={'f1_val': 0.7009355793019081, 'auprc': 0.9261985558586832, 'loss_val': 0.30886366174214863, 'psi': 0.7910407699246181}-{'f1_val': 0.7006809596653347, 'auprc': 0.9980655057703599, 'loss_val': 0.27157353601131623, 'psi': 0.8196347781073448}
[S4] START round=13 head_norm_before_train=1.458552 cos_to_last_merge=1.0000 (last merge round=12)
[S4] round=13 local utility u=0.000000 metrics={'f1_val': 0.6200527061044331, 'auprc': 0.9489168985469858, 'loss_val': 0.4791251515448261, 'psi': 0.7515983830814542}-{'f1_val': 0.926076783387488, 'auprc': 0.9400301035819103, 'loss_val': 0.47752534680168707, 'psi': 0.9316581114652569}
[S5] START round=13 head_norm_before_train=1.008774 cos_to_last_merge=1.0000 (last merge round=12)
[S5] round=13 local utility u=0.233440 metrics={'f1_val': 0.667170907636155, 'auprc': 0.933891525900099, 'loss_val': 0.6965175796037768, 'psi': 0.7738591549417326}-{'f1_val': 0.6250635770990443, 'auprc': 0.8621562859128644, 'loss_val': 0.6955484298712005, 'psi': 0.7199006606245724}
[S6] START round=13 head_norm_before_train=1.313237 cos_to_last_merge=1.0000 (last merge round=12)
[S6] round=13 local utility u=0.202462 metrics={'f1_val': 0.6789865782387239, 'auprc': 0.9524588685173898, 'loss_val': 0.4274706207827669, 'psi': 0.7883754943501903}-{'f1_val': 0.7072428994429236, 'auprc': 0.7800781475777342, 'loss_val': 0.48479061620458985, 'psi': 0.7363769986968478}
[S7] START round=13 head_norm_before_train=1.178920 cos_to_last_merge=0.8878 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.888
[S7] round=13 local utility u=0.427825 metrics={'f1_val': 0.6666204177150348, 'auprc': 0.8637550519066914, 'loss_val': 0.5611679093687473, 'psi': 0.7454742713916975}-{'f1_val': 0.5488755007480492, 'auprc': 0.873427475743662, 'loss_val': 0.7393661578258401, 'psi': 0.6786962907462943}
[S8] START round=13 head_norm_before_train=1.790194 (no previous merge yet)
[S8] round=13 local utility u=0.000548 metrics={'f1_val': 0.9964900410640029, 'auprc': 0.9991229048785212, 'loss_val': 0.05593824552940438, 'psi': 0.9975431865898101}-{'f1_val': 0.995982489643123, 'auprc': 0.999312249296832, 'loss_val': 0.05455629205876226, 'psi': 0.9973143935046066}
[S9] START round=13 head_norm_before_train=0.827439 cos_to_last_merge=1.0000 (last merge round=12)
[S9] round=13 local utility u=0.028179 metrics={'f1_val': 0.7014391336149548, 'auprc': 0.9988224153292922, 'loss_val': 0.48518437734620457, 'psi': 0.8203924463006897}-{'f1_val': 0.7014391336149548, 'auprc': 0.9995044892965425, 'loss_val': 0.5435877516990235, 'psi': 0.8206652758875899}
[S10] START round=13 head_norm_before_train=1.508858 cos_to_last_merge=0.8093 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.809
[S10] round=13 local utility u=0.028978 metrics={'f1_val': 0.9941183616473943, 'auprc': 0.9969338998663897, 'loss_val': 0.09031521553112423, 'psi': 0.9952445769349925}-{'f1_val': 0.9953300781987324, 'auprc': 0.9932846386579197, 'loss_val': 0.14459429049007616, 'psi': 0.9945119023824073}
[S11] START round=13 head_norm_before_train=0.863860 cos_to_last_merge=0.9942 (last merge round=11)
[S11] round=13 local utility u=0.265885 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9148905710936539, 'loss_val': 0.5596535908195631, 'psi': 0.7869723161896165}-{'f1_val': 0.6958415073386657, 'auprc': 0.793841217482036, 'loss_val': 0.693162860751293, 'psi': 0.7350413913960138}
[S13] START round=13 head_norm_before_train=1.650246 (no previous merge yet)
[S13] round=13 local utility u=0.000000 metrics={'f1_val': 0.6005182208229137, 'auprc': 0.6783968303292438, 'loss_val': 0.7490541272490433, 'psi': 0.6316696646254458}-{'f1_val': 0.6190921423359671, 'auprc': 0.6593549278528983, 'loss_val': 0.5741331462029208, 'psi': 0.6351972565427395}
[S14] START round=13 head_norm_before_train=0.745364 cos_to_last_merge=1.0000 (last merge round=12)
[S14] round=13 local utility u=0.225520 metrics={'f1_val': 0.701819167019819, 'auprc': 0.9974962747064275, 'loss_val': 0.5432287274297113, 'psi': 0.8200900100944624}-{'f1_val': 0.6413818320954897, 'auprc': 0.9917626139278053, 'loss_val': 0.6144431570803172, 'psi': 0.7815341448284159}
[S15] START round=13 head_norm_before_train=1.348564 cos_to_last_merge=0.9955 (last merge round=11)
[S15] round=13 local utility u=0.045974 metrics={'f1_val': 0.7047310785077084, 'auprc': 0.9618479641044893, 'loss_val': 0.3384368714580206, 'psi': 0.8075778327464207}-{'f1_val': 0.6967945069082401, 'auprc': 0.966065918060013, 'loss_val': 0.39541959622253603, 'psi': 0.8045030713689492}
[S16] START round=13 head_norm_before_train=1.561687 (no previous merge yet)
[S16] round=13 local utility u=0.261981 metrics={'f1_val': 0.6038028059677144, 'auprc': 0.9599394409216369, 'loss_val': 0.5183238707141551, 'psi': 0.7462574599492834}-{'f1_val': 0.5757619997883974, 'auprc': 0.8713103069548013, 'loss_val': 0.6081529742610581, 'psi': 0.6939813226549589}
[S17] START round=13 head_norm_before_train=1.270944 cos_to_last_merge=0.8546 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.855
[S17] round=13 local utility u=1.000000 metrics={'f1_val': 0.7154883185711414, 'auprc': 0.9537372166740478, 'loss_val': 0.4982729289821333, 'psi': 0.8107878778123039}-{'f1_val': 0.3947646545437155, 'auprc': 0.9284865875867543, 'loss_val': 0.5842342977733027, 'psi': 0.608253427760931}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S10] → sending delta(kind=head bytes=1807) to S4@127.0.0.1:59804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] → sending delta(kind=head bytes=1793) to S9@127.0.0.1:59810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:59807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:59804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] → sending delta(kind=head bytes=1794) to S11@127.0.0.1:59812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:59814
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:59810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:59814
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:59807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:59815
[S15] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1794 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1807 to 1 peers)
[S11] sending update (kind=head size=1793 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1799) from S15
[S14] cosine check vs S15: cos=0.5335
[S9] RECEIVED delta(kind=head bytes=1793) from S11
[S9] cosine check vs S11: cos=0.8311
[S9] RECEIVED delta(kind=head bytes=1800) from S5
[S9] cosine check vs S5: cos=0.3819
[S6] RECEIVED delta(kind=head bytes=1803) from S7
[S6] cosine check vs S7: cos=-0.0028
[S6] DROPPED delta from S7 (cos=-0.0028 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1797) from S8
[S6] cosine check vs S8: cos=0.8712
[S4] RECEIVED delta(kind=head bytes=1803) from S16
[S4] cosine check vs S16: cos=-0.0286
[S4] DROPPED delta from S16 (cos=-0.0286 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1807) from S10
[S4] cosine check vs S10: cos=0.9622
[S15] RECEIVED delta(kind=head bytes=1798) from S6
[S15] cosine check vs S6: cos=0.8925
[S14] RECEIVED delta(kind=head bytes=1796) from S9
[S14] cosine check vs S9: cos=0.7959
[S11] RECEIVED delta(kind=head bytes=1794) from S14
[S11] cosine check vs S14: cos=0.8876
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:59805
[S17] sending update (kind=head size=1799 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1799) from S17
[S5] cosine check vs S17: cos=0.6165
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=13 metric=0.6201 head_norm=1.521655
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.103477e-01
[S4] stored merged vector for next round verification (round=13)
[S4] DEBUG after merge:  round=13 metric=0.6112 head_norm=1.513874 delta_norm=0.210348
[S4] aggregate: ROLLBACK (f1_val pre=0.620 post=0.611 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=13 metric=0.6672 head_norm=1.037587
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.286177e-01
[S5] stored merged vector for next round verification (round=13)
[S5] DEBUG after merge:  round=13 metric=0.7011 head_norm=1.057245 delta_norm=0.528618
[S5] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=13 metric=0.7017 head_norm=0.916906
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.113068e-01
[S11] stored merged vector for next round verification (round=13)
[S11] DEBUG after merge:  round=13 metric=0.7017 head_norm=0.833439 delta_norm=0.211307
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=13 metric=0.7047 head_norm=1.421131
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.230680e-01
[S15] stored merged vector for next round verification (round=13)
[S15] DEBUG after merge:  round=13 metric=0.7566 head_norm=1.347891 delta_norm=0.323068
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=13 metric=0.7014 head_norm=0.889302
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.976240e-01
[S9] stored merged vector for next round verification (round=13)
[S9] DEBUG after merge:  round=13 metric=0.7014 head_norm=0.776924 delta_norm=0.297624
[S9] aggregate: ACCEPT kept=['S11', 'S5'] (k=2/2) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=13 metric=0.6790 head_norm=1.350093
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.647022e-01
[S6] stored merged vector for next round verification (round=13)
[S6] DEBUG after merge:  round=13 metric=0.8968 head_norm=1.538067 delta_norm=0.464702
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=13 metric=0.7018 head_norm=0.798640
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.242411e-01
[S14] stored merged vector for next round verification (round=13)
[S14] DEBUG after merge:  round=13 metric=0.7004 head_norm=0.797273 delta_norm=0.224241
[S14] aggregate: ACCEPT kept=['S15', 'S9'] (k=2/2) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.613521 cos_to_last_merge=0.9992 (last merge round=12)
[S2] round=14 local utility u=0.000000 metrics={'f1_val': 0.7059682371377318, 'auprc': 0.7364968943370185, 'loss_val': 0.6187401978578105, 'psi': 0.7181797000174466}-{'f1_val': 0.7196268902804956, 'auprc': 0.7605210704047883, 'loss_val': 0.6040809761158393, 'psi': 0.7359845623302127}
[S3] START round=14 head_norm_before_train=1.645530 (no previous merge yet)
[S3] round=14 local utility u=0.141082 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9963539582886347, 'loss_val': 0.23563885695878037, 'psi': 0.8189501591146547}-{'f1_val': 0.7009355793019081, 'auprc': 0.9261985558586832, 'loss_val': 0.30886366174214863, 'psi': 0.7910407699246181}
[S4] START round=14 head_norm_before_train=1.513874 cos_to_last_merge=1.0000 (last merge round=13)
[S4] round=14 local utility u=0.977540 metrics={'f1_val': 0.9446648046564589, 'auprc': 0.9433556665022398, 'loss_val': 0.4550341276617158, 'psi': 0.9441411493947711}-{'f1_val': 0.6200527061044331, 'auprc': 0.9489168985469858, 'loss_val': 0.4791251515448261, 'psi': 0.7515983830814542}
[S5] START round=14 head_norm_before_train=1.057245 cos_to_last_merge=1.0000 (last merge round=13)
[S5] round=14 local utility u=0.000000 metrics={'f1_val': 0.7008162875368863, 'auprc': 0.8220022154877611, 'loss_val': 0.599714158036018, 'psi': 0.7492906587172362}-{'f1_val': 0.667170907636155, 'auprc': 0.933891525900099, 'loss_val': 0.6965175796037768, 'psi': 0.7738591549417326}
[S6] START round=14 head_norm_before_train=1.538067 cos_to_last_merge=1.0000 (last merge round=13)
[S6] round=14 local utility u=0.115991 metrics={'f1_val': 0.6985697201577344, 'auprc': 0.9479044412070761, 'loss_val': 0.2993233905176095, 'psi': 0.7983036085774711}-{'f1_val': 0.6789865782387239, 'auprc': 0.9524588685173898, 'loss_val': 0.4274706207827669, 'psi': 0.7883754943501903}
[S7] START round=14 head_norm_before_train=1.210854 cos_to_last_merge=0.8779 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.878
[S7] round=14 local utility u=0.000000 metrics={'f1_val': 0.6196986375393259, 'auprc': 0.802404438125873, 'loss_val': 0.6320357495596505, 'psi': 0.6927809577739448}-{'f1_val': 0.6666204177150348, 'auprc': 0.8637550519066914, 'loss_val': 0.5611679093687473, 'psi': 0.7454742713916975}
[S8] START round=14 head_norm_before_train=1.827688 (no previous merge yet)
[S8] round=14 local utility u=0.000000 metrics={'f1_val': 0.9942857583640028, 'auprc': 0.999387396938416, 'loss_val': 0.049602148056228125, 'psi': 0.9963264137937682}-{'f1_val': 0.9964900410640029, 'auprc': 0.9991229048785212, 'loss_val': 0.05593824552940438, 'psi': 0.9975431865898101}
[S9] START round=14 head_norm_before_train=0.776924 cos_to_last_merge=1.0000 (last merge round=13)
[S9] round=14 local utility u=0.012982 metrics={'f1_val': 0.7013646677191758, 'auprc': 0.9987009646740014, 'loss_val': 0.45840900439938487, 'psi': 0.820299186501106}-{'f1_val': 0.7014391336149548, 'auprc': 0.9988224153292922, 'loss_val': 0.48518437734620457, 'psi': 0.8203924463006897}
[S10] START round=14 head_norm_before_train=1.535150 cos_to_last_merge=0.8057 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.806
[S10] round=14 local utility u=0.005155 metrics={'f1_val': 0.9941677348444804, 'auprc': 0.9967902859433216, 'loss_val': 0.07987065616127755, 'psi': 0.9952167552840169}-{'f1_val': 0.9941183616473943, 'auprc': 0.9969338998663897, 'loss_val': 0.09031521553112423, 'psi': 0.9952445769349925}
[S11] START round=14 head_norm_before_train=0.833439 cos_to_last_merge=1.0000 (last merge round=13)
[S11] round=14 local utility u=0.000000 metrics={'f1_val': 0.7017589383281313, 'auprc': 0.8605451194642125, 'loss_val': 0.5578560871309329, 'psi': 0.7652734107825638}-{'f1_val': 0.7016934795869249, 'auprc': 0.9148905710936539, 'loss_val': 0.5596535908195631, 'psi': 0.7869723161896165}
[S13] START round=14 head_norm_before_train=1.666519 (no previous merge yet)
[S13] round=14 local utility u=0.000000 metrics={'f1_val': 0.57618848332359, 'auprc': 0.6935794582772863, 'loss_val': 0.8791659474203647, 'psi': 0.6231448733050684}-{'f1_val': 0.6005182208229137, 'auprc': 0.6783968303292438, 'loss_val': 0.7490541272490433, 'psi': 0.6316696646254458}
[S14] START round=14 head_norm_before_train=0.797273 cos_to_last_merge=1.0000 (last merge round=13)
[S14] round=14 local utility u=0.000000 metrics={'f1_val': 0.7006122110629842, 'auprc': 0.9975033847701902, 'loss_val': 0.5443624033872888, 'psi': 0.8193686805458666}-{'f1_val': 0.701819167019819, 'auprc': 0.9974962747064275, 'loss_val': 0.5432287274297113, 'psi': 0.8200900100944624}
[S15] START round=14 head_norm_before_train=1.347891 cos_to_last_merge=1.0000 (last merge round=13)
[S15] round=14 local utility u=0.000000 metrics={'f1_val': 0.6951377261032485, 'auprc': 0.960155144503027, 'loss_val': 0.4073329775508837, 'psi': 0.8011446934631599}-{'f1_val': 0.7047310785077084, 'auprc': 0.9618479641044893, 'loss_val': 0.3384368714580206, 'psi': 0.8075778327464207}
[S16] START round=14 head_norm_before_train=1.596383 (no previous merge yet)
[S16] round=14 local utility u=0.311533 metrics={'f1_val': 0.6613447331828328, 'auprc': 0.9940643971525738, 'loss_val': 0.34288349720556033, 'psi': 0.7944325987707292}-{'f1_val': 0.6038028059677144, 'auprc': 0.9599394409216369, 'loss_val': 0.5183238707141551, 'psi': 0.7462574599492834}
[S17] START round=14 head_norm_before_train=1.310658 cos_to_last_merge=0.8499 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.850
[S17] round=14 local utility u=0.000000 metrics={'f1_val': 0.6815306385445634, 'auprc': 0.9743352297836957, 'loss_val': 0.46405533064650223, 'psi': 0.7986524750402164}-{'f1_val': 0.7154883185711414, 'auprc': 0.9537372166740478, 'loss_val': 0.4982729289821333, 'psi': 0.8107878778123039}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:59814
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:59815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:59804
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S4] → sending delta(kind=head bytes=1807) to S5@127.0.0.1:59805
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:59802
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:59804
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1807 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1803 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1801) from S16
[S4] cosine check vs S16: cos=-0.0252
[S4] DROPPED delta from S16 (cos=-0.0252 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1801) from S10
[S4] cosine check vs S10: cos=0.9763
[S15] RECEIVED delta(kind=head bytes=1803) from S6
[S15] cosine check vs S6: cos=0.9465
[S5] RECEIVED delta(kind=head bytes=1807) from S4
[S5] cosine check vs S4: cos=0.4077
[S14] RECEIVED delta(kind=head bytes=1800) from S9
[S14] cosine check vs S9: cos=0.7267
[S2] RECEIVED delta(kind=head bytes=1797) from S3
[S2] cosine check vs S3: cos=0.9840
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=14 metric=0.7006 head_norm=0.840711
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.103227e-01
[S14] stored merged vector for next round verification (round=14)
[S14] DEBUG after merge:  round=14 metric=0.6999 head_norm=0.779978 delta_norm=0.310323
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=14 metric=0.7008 head_norm=1.092286
[S5] _apply_head_vector_avg (torch): Δ‖w‖=7.538325e-01
[S5] stored merged vector for next round verification (round=14)
[S5] DEBUG after merge:  round=14 metric=0.6246 head_norm=1.126986 delta_norm=0.753832
[S5] aggregate: ROLLBACK (f1_val pre=0.701 post=0.625 tol_abs=0.005 tol_rel=0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=14 metric=0.7060 head_norm=1.643420
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.491607e-01
[S2] stored merged vector for next round verification (round=14)
[S2] DEBUG after merge:  round=14 metric=0.7012 head_norm=1.652927 delta_norm=0.149161
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=14 metric=0.9447 head_norm=1.575954
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.710148e-01
[S4] stored merged vector for next round verification (round=14)
[S4] DEBUG after merge:  round=14 metric=0.6139 head_norm=1.559226 delta_norm=0.171015
[S4] aggregate: ROLLBACK (f1_val pre=0.945 post=0.614 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=14 metric=0.6951 head_norm=1.425122
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.568106e-01
[S15] stored merged vector for next round verification (round=14)
[S15] DEBUG after merge:  round=14 metric=0.6957 head_norm=1.481396 delta_norm=0.256811
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.652927 cos_to_last_merge=1.0000 (last merge round=14)
[S2] round=15 local utility u=0.011128 metrics={'f1_val': 0.7149387627731132, 'auprc': 0.7317170169083329, 'loss_val': 0.6359674057256677, 'psi': 0.721650064427201}-{'f1_val': 0.7059682371377318, 'auprc': 0.7364968943370185, 'loss_val': 0.6187401978578105, 'psi': 0.7181797000174466}
[S3] START round=15 head_norm_before_train=1.675709 (no previous merge yet)
[S3] round=15 local utility u=0.815314 metrics={'f1_val': 0.9619616648309319, 'auprc': 0.9968065879687348, 'loss_val': 0.1740523346907816, 'psi': 0.9758996340860531}-{'f1_val': 0.7006809596653347, 'auprc': 0.9963539582886347, 'loss_val': 0.23563885695878037, 'psi': 0.8189501591146547}
[S4] START round=15 head_norm_before_train=1.559226 cos_to_last_merge=1.0000 (last merge round=14)
[S4] round=15 local utility u=0.033665 metrics={'f1_val': 0.951491852841343, 'auprc': 0.9404990924658416, 'loss_val': 0.4200973456098284, 'psi': 0.9470947486911425}-{'f1_val': 0.9446648046564589, 'auprc': 0.9433556665022398, 'loss_val': 0.4550341276617158, 'psi': 0.9441411493947711}
[S5] START round=15 head_norm_before_train=1.126986 cos_to_last_merge=1.0000 (last merge round=14)
[S5] round=15 local utility u=0.175357 metrics={'f1_val': 0.7008162875368863, 'auprc': 0.9440590248187761, 'loss_val': 0.6151706456924321, 'psi': 0.7981133824496423}-{'f1_val': 0.7008162875368863, 'auprc': 0.8220022154877611, 'loss_val': 0.599714158036018, 'psi': 0.7492906587172362}
[S6] START round=15 head_norm_before_train=1.577972 cos_to_last_merge=0.9991 (last merge round=13)
[S6] round=15 local utility u=0.722619 metrics={'f1_val': 0.9360996092522254, 'auprc': 0.9485482908412406, 'loss_val': 0.2811970937812083, 'psi': 0.9410790818878315}-{'f1_val': 0.6985697201577344, 'auprc': 0.9479044412070761, 'loss_val': 0.2993233905176095, 'psi': 0.7983036085774711}
[S7] START round=15 head_norm_before_train=1.239783 cos_to_last_merge=0.8697 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.870
[S7] round=15 local utility u=0.000000 metrics={'f1_val': 0.5802338958716028, 'auprc': 0.7983559882921458, 'loss_val': 0.6830327128259261, 'psi': 0.6674827328398201}-{'f1_val': 0.6196986375393259, 'auprc': 0.802404438125873, 'loss_val': 0.6320357495596505, 'psi': 0.6927809577739448}
[S8] START round=15 head_norm_before_train=1.859461 (no previous merge yet)
[S8] round=15 local utility u=0.000000 metrics={'f1_val': 0.9937185965290795, 'auprc': 0.9916417707799492, 'loss_val': 0.07232779082697832, 'psi': 0.9928878662294274}-{'f1_val': 0.9942857583640028, 'auprc': 0.999387396938416, 'loss_val': 0.049602148056228125, 'psi': 0.9963264137937682}
[S9] START round=15 head_norm_before_train=0.838174 cos_to_last_merge=0.9937 (last merge round=13)
[S9] round=15 local utility u=0.041238 metrics={'f1_val': 0.7013646677191758, 'auprc': 0.9985663548957178, 'loss_val': 0.3755297387340717, 'psi': 0.8202453425897926}-{'f1_val': 0.7013646677191758, 'auprc': 0.9987009646740014, 'loss_val': 0.45840900439938487, 'psi': 0.820299186501106}
[S10] START round=15 head_norm_before_train=1.561163 cos_to_last_merge=0.8021 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.802
[S10] round=15 local utility u=0.000000 metrics={'f1_val': 0.9955259082574451, 'auprc': 0.9943418302108737, 'loss_val': 0.08582366349194737, 'psi': 0.9950522770388166}-{'f1_val': 0.9941677348444804, 'auprc': 0.9967902859433216, 'loss_val': 0.07987065616127755, 'psi': 0.9952167552840169}
[S11] START round=15 head_norm_before_train=0.884011 cos_to_last_merge=0.9956 (last merge round=13)
[S11] round=15 local utility u=0.100214 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.90074969006212, 'loss_val': 0.47909967997345226, 'psi': 0.7814610660038401}-{'f1_val': 0.7017589383281313, 'auprc': 0.8605451194642125, 'loss_val': 0.5578560871309329, 'psi': 0.7652734107825638}
[S13] START round=15 head_norm_before_train=1.678593 (no previous merge yet)
[S13] round=15 local utility u=0.355400 metrics={'f1_val': 0.6447286436248372, 'auprc': 0.6649266748701365, 'loss_val': 0.4936484703638737, 'psi': 0.6528078561229569}-{'f1_val': 0.57618848332359, 'auprc': 0.6935794582772863, 'loss_val': 0.8791659474203647, 'psi': 0.6231448733050684}
[S14] START round=15 head_norm_before_train=0.779978 cos_to_last_merge=1.0000 (last merge round=14)
[S14] round=15 local utility u=0.043945 metrics={'f1_val': 0.7000599664364398, 'auprc': 0.9989883017896443, 'loss_val': 0.4576140329252517, 'psi': 0.8196313005777216}-{'f1_val': 0.7006122110629842, 'auprc': 0.9975033847701902, 'loss_val': 0.5443624033872888, 'psi': 0.8193686805458666}
[S15] START round=15 head_norm_before_train=1.481396 cos_to_last_merge=1.0000 (last merge round=14)
[S15] round=15 local utility u=0.004863 metrics={'f1_val': 0.6968849140558677, 'auprc': 0.9661947216317708, 'loss_val': 0.42620865730702684, 'psi': 0.804608837086229}-{'f1_val': 0.6951377261032485, 'auprc': 0.960155144503027, 'loss_val': 0.4073329775508837, 'psi': 0.8011446934631599}
[S16] START round=15 head_norm_before_train=1.626280 (no previous merge yet)
[S16] round=15 local utility u=0.690820 metrics={'f1_val': 0.8719581597170679, 'auprc': 0.996204540804981, 'loss_val': 0.23134373661839783, 'psi': 0.9216567121522331}-{'f1_val': 0.6613447331828328, 'auprc': 0.9940643971525738, 'loss_val': 0.34288349720556033, 'psi': 0.7944325987707292}
[S17] START round=15 head_norm_before_train=1.349710 cos_to_last_merge=0.8460 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.846
[S17] round=15 local utility u=0.000000 metrics={'f1_val': 0.6658547698834197, 'auprc': 0.9704101096221487, 'loss_val': 0.4817964900301859, 'psi': 0.7876769057789113}-{'f1_val': 0.6815306385445634, 'auprc': 0.9743352297836957, 'loss_val': 0.46405533064650223, 'psi': 0.7986524750402164}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] → sending delta(kind=head bytes=1805) to S15@127.0.0.1:59815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:59810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:59814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:59810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:59805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:59810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:59802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:59807
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] → sending delta(kind=head bytes=1792) to S14@127.0.0.1:59814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S14] → sending delta(kind=head bytes=1792) to S11@127.0.0.1:59812
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] → sending delta(kind=head bytes=1804) to S4@127.0.0.1:59804
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1792 to 1 peers)
[S9] sending update (kind=head size=1792 to 1 peers)
[S16] sending update (kind=head size=1804 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1804 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1805 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1804) from S16
[S4] cosine check vs S16: cos=-0.0200
[S4] DROPPED delta from S16 (cos=-0.0200 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1799) from S3
[S2] cosine check vs S3: cos=0.9922
[S9] RECEIVED delta(kind=head bytes=1801) from S5
[S9] cosine check vs S5: cos=0.5502
[S9] RECEIVED delta(kind=head bytes=1799) from S13
[S9] cosine check vs S13: cos=0.6739
[S9] RECEIVED delta(kind=head bytes=1796) from S11
[S9] cosine check vs S11: cos=0.8372
[S11] RECEIVED delta(kind=head bytes=1792) from S14
[S11] cosine check vs S14: cos=0.9122
[S6] RECEIVED delta(kind=head bytes=1799) from S2
[S6] cosine check vs S2: cos=0.3720
[S14] RECEIVED delta(kind=head bytes=1792) from S9
[S14] cosine check vs S9: cos=0.9153
[S15] RECEIVED delta(kind=head bytes=1805) from S6
[S15] cosine check vs S6: cos=0.9806
[S5] RECEIVED delta(kind=head bytes=1804) from S4
[S5] cosine check vs S4: cos=0.8778
[S14] RECEIVED delta(kind=head bytes=1802) from S15
[S14] cosine check vs S15: cos=0.3443
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] ⇄ pheromone p=0.177 → S6@127.0.0.1:59807
[S8] ⇄ pheromone p=0.128 → S6@127.0.0.1:59807
[S10] ⇄ pheromone p=0.175 → S4@127.0.0.1:59804
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=15 metric=0.7001 head_norm=0.832012
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.062148e-01
[S14] stored merged vector for next round verification (round=15)
[S14] DEBUG after merge:  round=15 metric=0.9512 head_norm=0.812157 delta_norm=0.306215
[S14] aggregate: ACCEPT kept=['S9', 'S15'] (k=2/2) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.206 → S11@127.0.0.1:59812
[S13] ⇄ pheromone p=0.206 → S9@127.0.0.1:59810
[S16] ⇄ pheromone p=0.370 → S4@127.0.0.1:59804
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=15 metric=0.9361 head_norm=1.606927
[S6] _apply_head_vector_avg (torch): Δ‖w‖=9.228508e-01
[S6] stored merged vector for next round verification (round=15)
[S6] DEBUG after merge:  round=15 metric=0.9424 head_norm=1.363445 delta_norm=0.922851
[S6] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.307 → S15@127.0.0.1:59815
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=15 metric=0.6969 head_norm=1.543792
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.582194e-01
[S15] stored merged vector for next round verification (round=15)
[S15] DEBUG after merge:  round=15 metric=0.6969 head_norm=1.567712 delta_norm=0.158219
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.108 → S14@127.0.0.1:59814
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=15 metric=0.7019 head_norm=0.939676
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.929231e-01
[S11] stored merged vector for next round verification (round=15)
[S11] DEBUG after merge:  round=15 metric=0.7019 head_norm=0.866255 delta_norm=0.192923
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.216 → S9@127.0.0.1:59810
[S9] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=15 metric=0.7014 head_norm=0.905234
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.806085e-01
[S9] stored merged vector for next round verification (round=15)
[S9] DEBUG after merge:  round=15 metric=0.7014 head_norm=0.876963 delta_norm=0.180608
[S9] aggregate: ACCEPT kept=['S5', 'S13', 'S11'] (k=3/3) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.143 → S14@127.0.0.1:59814
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=15 metric=0.7149 head_norm=1.684950
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.065312e-01
[S2] stored merged vector for next round verification (round=15)
[S2] DEBUG after merge:  round=15 metric=0.7104 head_norm=1.690928 delta_norm=0.106531
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.088 → S6@127.0.0.1:59807
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=15 metric=0.7008 head_norm=1.153511
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.112924e-01
[S5] stored merged vector for next round verification (round=15)
[S5] DEBUG after merge:  round=15 metric=0.6564 head_norm=1.345822 delta_norm=0.411292
[S5] aggregate: ROLLBACK (f1_val pre=0.701 post=0.656 tol_abs=0.005 tol_rel=0.0)
[S5] ⇄ pheromone p=0.239 → S9@127.0.0.1:59810
[S3] ⇄ pheromone p=0.333 → S2@127.0.0.1:59802
[S4] ⇄ pheromone p=0.376 → S5@127.0.0.1:59805
[S17] ⇄ pheromone p=0.249 → S5@127.0.0.1:59805
[S2] START round=16 head_norm_before_train=1.690928 cos_to_last_merge=1.0000 (last merge round=15)
[S2] round=16 local utility u=0.000000 metrics={'f1_val': 0.6971670054074314, 'auprc': 0.7237363532657917, 'loss_val': 0.7243673449144162, 'psi': 0.7077947445507755}-{'f1_val': 0.7149387627731132, 'auprc': 0.7317170169083329, 'loss_val': 0.6359674057256677, 'psi': 0.721650064427201}
[S3] START round=16 head_norm_before_train=1.703560 (no previous merge yet)
[S3] round=16 local utility u=0.128038 metrics={'f1_val': 0.9969520501205896, 'auprc': 0.996920568893767, 'loss_val': 0.128259799183761, 'psi': 0.9969394576298606}-{'f1_val': 0.9619616648309319, 'auprc': 0.9968065879687348, 'loss_val': 0.1740523346907816, 'psi': 0.9758996340860531}
[S4] START round=16 head_norm_before_train=1.621791 cos_to_last_merge=0.9967 (last merge round=14)
[S4] round=16 local utility u=0.047703 metrics={'f1_val': 0.9512101777100173, 'auprc': 0.9525613683106802, 'loss_val': 0.35918770298184294, 'psi': 0.9517506539502825}-{'f1_val': 0.951491852841343, 'auprc': 0.9404990924658416, 'loss_val': 0.4200973456098284, 'psi': 0.9470947486911425}
[S5] START round=16 head_norm_before_train=1.345822 cos_to_last_merge=1.0000 (last merge round=15)
[S5] round=16 local utility u=0.000000 metrics={'f1_val': 0.661513659277044, 'auprc': 0.8673083994520625, 'loss_val': 0.6000730340350975, 'psi': 0.7438315553470514}-{'f1_val': 0.7008162875368863, 'auprc': 0.9440590248187761, 'loss_val': 0.6151706456924321, 'psi': 0.7981133824496423}
[S6] START round=16 head_norm_before_train=1.363445 cos_to_last_merge=1.0000 (last merge round=15)
[S6] round=16 local utility u=0.000000 metrics={'f1_val': 0.801858279034801, 'auprc': 0.967000837877704, 'loss_val': 0.363222919101703, 'psi': 0.8679153025719621}-{'f1_val': 0.9360996092522254, 'auprc': 0.9485482908412406, 'loss_val': 0.2811970937812083, 'psi': 0.9410790818878315}
[S7] START round=16 head_norm_before_train=1.264164 cos_to_last_merge=0.8635 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.864
[S7] round=16 local utility u=0.471715 metrics={'f1_val': 0.6801859380301238, 'auprc': 0.8395665442748346, 'loss_val': 0.46294724046254115, 'psi': 0.7439381805280081}-{'f1_val': 0.5802338958716028, 'auprc': 0.7983559882921458, 'loss_val': 0.6830327128259261, 'psi': 0.6674827328398201}
[S8] START round=16 head_norm_before_train=1.880650 (no previous merge yet)
[S8] round=16 local utility u=0.031483 metrics={'f1_val': 0.9947983930821034, 'auprc': 0.9993671153475474, 'loss_val': 0.03901622521101675, 'psi': 0.9966258819882811}-{'f1_val': 0.9937185965290795, 'auprc': 0.9916417707799492, 'loss_val': 0.07232779082697832, 'psi': 0.9928878662294274}
[S9] START round=16 head_norm_before_train=0.876963 cos_to_last_merge=1.0000 (last merge round=15)
[S9] round=16 local utility u=0.010506 metrics={'f1_val': 0.7013646677191758, 'auprc': 0.9982295530034412, 'loss_val': 0.35350733160363507, 'psi': 0.820110621832882}-{'f1_val': 0.7013646677191758, 'auprc': 0.9985663548957178, 'loss_val': 0.3755297387340717, 'psi': 0.8202453425897926}
[S10] START round=16 head_norm_before_train=1.594599 cos_to_last_merge=0.7974 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.797
[S10] round=16 local utility u=0.012420 metrics={'f1_val': 0.9937452946631335, 'auprc': 0.9964000041418415, 'loss_val': 0.056473782649421114, 'psi': 0.9948071784546166}-{'f1_val': 0.9955259082574451, 'auprc': 0.9943418302108737, 'loss_val': 0.08582366349194737, 'psi': 0.9950522770388166}
[S11] START round=16 head_norm_before_train=0.866255 cos_to_last_merge=1.0000 (last merge round=15)
[S11] round=16 local utility u=0.147325 metrics={'f1_val': 0.7018701185892477, 'auprc': 0.9979339466642944, 'loss_val': 0.4756114345769624, 'psi': 0.8202956498192664}-{'f1_val': 0.7019353166316534, 'auprc': 0.90074969006212, 'loss_val': 0.47909967997345226, 'psi': 0.7814610660038401}
[S13] START round=16 head_norm_before_train=1.685130 (no previous merge yet)
[S13] round=16 local utility u=0.000000 metrics={'f1_val': 0.6090665325273248, 'auprc': 0.6746585282211285, 'loss_val': 0.7277962313669728, 'psi': 0.6353033308048464}-{'f1_val': 0.6447286436248372, 'auprc': 0.6649266748701365, 'loss_val': 0.4936484703638737, 'psi': 0.6528078561229569}
[S14] START round=16 head_norm_before_train=0.812157 cos_to_last_merge=1.0000 (last merge round=15)
[S14] round=16 local utility u=0.836698 metrics={'f1_val': 0.9804394076344582, 'auprc': 0.9960999378731997, 'loss_val': 0.45782926643944183, 'psi': 0.9867036197299548}-{'f1_val': 0.7000599664364398, 'auprc': 0.9989883017896443, 'loss_val': 0.4576140329252517, 'psi': 0.8196313005777216}
[S15] START round=16 head_norm_before_train=1.567712 cos_to_last_merge=1.0000 (last merge round=15)
[S15] round=16 local utility u=0.366965 metrics={'f1_val': 0.7995760537325803, 'auprc': 0.9631656824464422, 'loss_val': 0.29933853001335126, 'psi': 0.8650119052181251}-{'f1_val': 0.6968849140558677, 'auprc': 0.9661947216317708, 'loss_val': 0.42620865730702684, 'psi': 0.804608837086229}
[S16] START round=16 head_norm_before_train=1.658290 (no previous merge yet)
[S16] round=16 local utility u=0.376178 metrics={'f1_val': 0.9892832009190885, 'auprc': 0.9928904089960827, 'loss_val': 0.17299517450136676, 'psi': 0.9907260841498862}-{'f1_val': 0.8719581597170679, 'auprc': 0.996204540804981, 'loss_val': 0.23134373661839783, 'psi': 0.9216567121522331}
[S17] START round=16 head_norm_before_train=1.394899 cos_to_last_merge=0.8411 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.841
[S17] round=16 local utility u=0.124642 metrics={'f1_val': 0.6859507337466253, 'auprc': 0.9808416140668946, 'loss_val': 0.3843824397930689, 'psi': 0.803907085874733}-{'f1_val': 0.6658547698834197, 'auprc': 0.9704101096221487, 'loss_val': 0.4817964900301859, 'psi': 0.7876769057789113}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:59807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] → sending delta(kind=head bytes=1804) to S4@127.0.0.1:59804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:59814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S4] → sending delta(kind=head bytes=1806) to S5@127.0.0.1:59805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:59810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:59814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:59802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:59807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:59812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:59804
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1804 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1806 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1801) from S15
[S14] cosine check vs S15: cos=0.6206
[S6] RECEIVED delta(kind=head bytes=1802) from S7
[S6] cosine check vs S7: cos=-0.0083
[S6] DROPPED delta from S7 (cos=-0.0083 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1797) from S8
[S6] cosine check vs S8: cos=0.6974
[S14] RECEIVED delta(kind=head bytes=1797) from S9
[S14] cosine check vs S9: cos=0.8070
[S4] RECEIVED delta(kind=head bytes=1804) from S16
[S4] cosine check vs S16: cos=-0.0165
[S4] DROPPED delta from S16 (cos=-0.0165 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1803) from S10
[S4] cosine check vs S10: cos=0.9676
[S2] RECEIVED delta(kind=head bytes=1797) from S3
[S2] cosine check vs S3: cos=0.9948
[S5] RECEIVED delta(kind=head bytes=1806) from S4
[S5] cosine check vs S4: cos=0.9706
[S9] RECEIVED delta(kind=head bytes=1796) from S11
[S9] cosine check vs S11: cos=0.9421
[S11] RECEIVED delta(kind=head bytes=1799) from S14
[S11] cosine check vs S14: cos=0.8841
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S17] → sending delta(kind=head bytes=1806) to S5@127.0.0.1:59805
[S17] sending update (kind=head size=1806 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1806) from S17
[S5] cosine check vs S17: cos=0.2553
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=16 metric=0.8019 head_norm=1.395113
[S6] _apply_head_vector_avg (torch): Δ‖w‖=6.821624e-01
[S6] stored merged vector for next round verification (round=16)
[S6] DEBUG after merge:  round=16 metric=0.9599 head_norm=1.521643 delta_norm=0.682162
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=16 metric=0.6972 head_norm=1.722366
[S2] _apply_head_vector_avg (torch): Δ‖w‖=8.861612e-02
[S2] stored merged vector for next round verification (round=16)
[S2] DEBUG after merge:  round=16 metric=0.6944 head_norm=1.725597 delta_norm=0.088616
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=16 metric=0.6615 head_norm=1.369908
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.244141e-01
[S5] stored merged vector for next round verification (round=16)
[S5] DEBUG after merge:  round=16 metric=0.6698 head_norm=1.215199 delta_norm=0.324414
[S5] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=16 metric=0.9512 head_norm=1.683247
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.124722e-01
[S4] stored merged vector for next round verification (round=16)
[S4] DEBUG after merge:  round=16 metric=0.9485 head_norm=1.644879 delta_norm=0.212472
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=16 metric=0.7014 head_norm=0.937600
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.578552e-01
[S9] stored merged vector for next round verification (round=16)
[S9] DEBUG after merge:  round=16 metric=0.7014 head_norm=0.912019 delta_norm=0.157855
[S9] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=16 metric=0.7019 head_norm=0.913401
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.151603e-01
[S11] stored merged vector for next round verification (round=16)
[S11] DEBUG after merge:  round=16 metric=0.7019 head_norm=0.861691 delta_norm=0.215160
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=16 metric=0.9804 head_norm=0.862154
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.959663e-01
[S14] stored merged vector for next round verification (round=16)
[S14] DEBUG after merge:  round=16 metric=0.9979 head_norm=0.892024 delta_norm=0.195966
[S14] aggregate: ACCEPT kept=['S15', 'S9'] (k=2/2) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.725597 cos_to_last_merge=1.0000 (last merge round=16)
[S2] round=17 local utility u=0.000000 metrics={'f1_val': 0.6268564128528085, 'auprc': 0.7205246161118273, 'loss_val': 0.8986876181805461, 'psi': 0.6643236941564159}-{'f1_val': 0.6971670054074314, 'auprc': 0.7237363532657917, 'loss_val': 0.7243673449144162, 'psi': 0.7077947445507755}
[S3] START round=17 head_norm_before_train=1.733358 (no previous merge yet)
[S3] round=17 local utility u=0.000000 metrics={'f1_val': 0.9688212739519485, 'auprc': 0.9968705652609254, 'loss_val': 0.11463885630685149, 'psi': 0.9800409904755393}-{'f1_val': 0.9969520501205896, 'auprc': 0.996920568893767, 'loss_val': 0.128259799183761, 'psi': 0.9969394576298606}
[S4] START round=17 head_norm_before_train=1.644879 cos_to_last_merge=1.0000 (last merge round=16)
[S4] round=17 local utility u=0.012826 metrics={'f1_val': 0.9558756929165089, 'auprc': 0.9461389818420863, 'loss_val': 0.34226101870058623, 'psi': 0.9519810084867399}-{'f1_val': 0.9512101777100173, 'auprc': 0.9525613683106802, 'loss_val': 0.35918770298184294, 'psi': 0.9517506539502825}
[S5] START round=17 head_norm_before_train=1.215199 cos_to_last_merge=1.0000 (last merge round=16)
[S5] round=17 local utility u=0.384733 metrics={'f1_val': 0.7005691551769304, 'auprc': 0.9909552725749011, 'loss_val': 0.43588121036931377, 'psi': 0.8167236021361187}-{'f1_val': 0.661513659277044, 'auprc': 0.8673083994520625, 'loss_val': 0.6000730340350975, 'psi': 0.7438315553470514}
[S6] START round=17 head_norm_before_train=1.521643 cos_to_last_merge=1.0000 (last merge round=16)
[S6] round=17 local utility u=0.123020 metrics={'f1_val': 0.8455819312788464, 'auprc': 0.9521456869796961, 'loss_val': 0.33495957240808416, 'psi': 0.8882074335591863}-{'f1_val': 0.801858279034801, 'auprc': 0.967000837877704, 'loss_val': 0.363222919101703, 'psi': 0.8679153025719621}
[S7] START round=17 head_norm_before_train=1.285763 cos_to_last_merge=0.8585 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.859
[S7] round=17 local utility u=0.000000 metrics={'f1_val': 0.5510655411227242, 'auprc': 0.7852031127669457, 'loss_val': 0.793078008873747, 'psi': 0.6447205697804128}-{'f1_val': 0.6801859380301238, 'auprc': 0.8395665442748346, 'loss_val': 0.46294724046254115, 'psi': 0.7439381805280081}
[S8] START round=17 head_norm_before_train=1.901353 (no previous merge yet)
[S8] round=17 local utility u=0.000000 metrics={'f1_val': 0.9942788405856967, 'auprc': 0.99936048085043, 'loss_val': 0.03668548321691091, 'psi': 0.99631149669159}-{'f1_val': 0.9947983930821034, 'auprc': 0.9993671153475474, 'loss_val': 0.03901622521101675, 'psi': 0.9966258819882811}
[S9] START round=17 head_norm_before_train=0.912019 cos_to_last_merge=1.0000 (last merge round=16)
[S9] round=17 local utility u=0.008694 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9988401333430657, 'loss_val': 0.3375055759593782, 'psi': 0.8203103434617643}-{'f1_val': 0.7013646677191758, 'auprc': 0.9982295530034412, 'loss_val': 0.35350733160363507, 'psi': 0.820110621832882}
[S10] START round=17 head_norm_before_train=1.633469 cos_to_last_merge=0.7917 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.792
[S10] round=17 local utility u=0.004559 metrics={'f1_val': 0.9939487387271932, 'auprc': 0.9965234701541549, 'loss_val': 0.04894697018880826, 'psi': 0.9949786312979778}-{'f1_val': 0.9937452946631335, 'auprc': 0.9964000041418415, 'loss_val': 0.056473782649421114, 'psi': 0.9948071784546166}
[S11] START round=17 head_norm_before_train=0.861691 cos_to_last_merge=1.0000 (last merge round=16)
[S11] round=17 local utility u=0.000000 metrics={'f1_val': 0.7016282822309048, 'auprc': 0.9980853940419212, 'loss_val': 0.4801594731470298, 'psi': 0.8202111269553114}-{'f1_val': 0.7018701185892477, 'auprc': 0.9979339466642944, 'loss_val': 0.4756114345769624, 'psi': 0.8202956498192664}
[S13] START round=17 head_norm_before_train=1.698137 (no previous merge yet)
[S13] round=17 local utility u=0.085697 metrics={'f1_val': 0.6261258370900146, 'auprc': 0.6742509787401108, 'loss_val': 0.6575347125286352, 'psi': 0.6453758937500531}-{'f1_val': 0.6090665325273248, 'auprc': 0.6746585282211285, 'loss_val': 0.7277962313669728, 'psi': 0.6353033308048464}
[S14] START round=17 head_norm_before_train=0.892024 cos_to_last_merge=1.0000 (last merge round=16)
[S14] round=17 local utility u=0.065348 metrics={'f1_val': 0.9974280040892742, 'auprc': 0.9972933953653049, 'loss_val': 0.43264482359340733, 'psi': 0.9973741605996864}-{'f1_val': 0.9804394076344582, 'auprc': 0.9960999378731997, 'loss_val': 0.45782926643944183, 'psi': 0.9867036197299548}
[S15] START round=17 head_norm_before_train=1.611606 cos_to_last_merge=0.9992 (last merge round=15)
[S15] round=17 local utility u=0.672513 metrics={'f1_val': 0.9890915335426116, 'auprc': 0.9745759438190483, 'loss_val': 0.1256353140847515, 'psi': 0.9832852976531863}-{'f1_val': 0.7995760537325803, 'auprc': 0.9631656824464422, 'loss_val': 0.29933853001335126, 'psi': 0.8650119052181251}
[S16] START round=17 head_norm_before_train=1.693308 (no previous merge yet)
[S16] round=17 local utility u=0.000000 metrics={'f1_val': 0.9300819620815817, 'auprc': 0.9916817438999452, 'loss_val': 0.2976523100148754, 'psi': 0.9547218748089271}-{'f1_val': 0.9892832009190885, 'auprc': 0.9928904089960827, 'loss_val': 0.17299517450136676, 'psi': 0.9907260841498862}
[S17] START round=17 head_norm_before_train=1.443276 cos_to_last_merge=0.8356 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.836
[S17] round=17 local utility u=0.000000 metrics={'f1_val': 0.6657067452386514, 'auprc': 0.8287042730440556, 'loss_val': 0.5294619932279393, 'psi': 0.730905756360813}-{'f1_val': 0.6859507337466253, 'auprc': 0.9808416140668946, 'loss_val': 0.3843824397930689, 'psi': 0.803907085874733}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] → sending delta(kind=head bytes=1805) to S5@127.0.0.1:59805
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:59810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:59814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:59804
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:59810
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:59815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S14] → sending delta(kind=head bytes=1789) to S11@127.0.0.1:59812
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:59814
[S15] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1804 to 1 peers)
[S14] sending update (kind=head size=1789 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1805 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1804) from S5
[S9] cosine check vs S5: cos=0.4213
[S11] RECEIVED delta(kind=head bytes=1789) from S14
[S11] cosine check vs S14: cos=0.9059
[S5] RECEIVED delta(kind=head bytes=1805) from S4
[S5] cosine check vs S4: cos=0.8875
[S4] RECEIVED delta(kind=head bytes=1802) from S10
[S4] cosine check vs S10: cos=0.9853
[S15] RECEIVED delta(kind=head bytes=1801) from S6
[S15] cosine check vs S6: cos=0.9746
[S14] RECEIVED delta(kind=head bytes=1795) from S9
[S14] cosine check vs S9: cos=0.7590
[S14] RECEIVED delta(kind=head bytes=1800) from S15
[S14] cosine check vs S15: cos=0.7511
[S9] RECEIVED delta(kind=head bytes=1800) from S13
[S9] cosine check vs S13: cos=0.6651
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=17 metric=0.7016 head_norm=0.910178
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.005398e-01
[S11] stored merged vector for next round verification (round=17)
[S11] DEBUG after merge:  round=17 metric=0.7016 head_norm=0.900962 delta_norm=0.200540
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=17 metric=0.7013 head_norm=0.968054
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.528158e-01
[S9] stored merged vector for next round verification (round=17)
[S9] DEBUG after merge:  round=17 metric=0.7013 head_norm=0.964795 delta_norm=0.352816
[S9] aggregate: ACCEPT kept=['S5', 'S13'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=17 metric=0.7006 head_norm=1.254339
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.060798e-01
[S5] stored merged vector for next round verification (round=17)
[S5] DEBUG after merge:  round=17 metric=0.7007 head_norm=1.428073 delta_norm=0.406080
[S5] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=17 metric=0.9559 head_norm=1.683811
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.438622e-01
[S4] stored merged vector for next round verification (round=17)
[S4] DEBUG after merge:  round=17 metric=0.9559 head_norm=1.669986 delta_norm=0.143862
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=17 metric=0.9974 head_norm=0.935668
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.380180e-01
[S14] stored merged vector for next round verification (round=17)
[S14] DEBUG after merge:  round=17 metric=0.9974 head_norm=0.973420 delta_norm=0.138018
[S14] aggregate: ACCEPT kept=['S9', 'S15'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=17 metric=0.9891 head_norm=1.664146
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.890980e-01
[S15] stored merged vector for next round verification (round=17)
[S15] DEBUG after merge:  round=17 metric=0.9891 head_norm=1.599684 delta_norm=0.189098
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.752375 cos_to_last_merge=0.9995 (last merge round=16)
[S2] round=18 local utility u=0.312111 metrics={'f1_val': 0.7021718359327874, 'auprc': 0.7215037975590343, 'loss_val': 0.7292954435348014, 'psi': 0.7099046205832862}-{'f1_val': 0.6268564128528085, 'auprc': 0.7205246161118273, 'loss_val': 0.8986876181805461, 'psi': 0.6643236941564159}
[S3] START round=18 head_norm_before_train=1.760923 (no previous merge yet)
[S3] round=18 local utility u=0.000000 metrics={'f1_val': 0.9615385219550141, 'auprc': 0.9967396067966607, 'loss_val': 0.10101354061373119, 'psi': 0.9756189558916728}-{'f1_val': 0.9688212739519485, 'auprc': 0.9968705652609254, 'loss_val': 0.11463885630685149, 'psi': 0.9800409904755393}
[S4] START round=18 head_norm_before_train=1.669986 cos_to_last_merge=1.0000 (last merge round=17)
[S4] round=18 local utility u=0.000000 metrics={'f1_val': 0.9493393327296638, 'auprc': 0.960144745600803, 'loss_val': 0.347220876043197, 'psi': 0.9536614978781195}-{'f1_val': 0.9558756929165089, 'auprc': 0.9461389818420863, 'loss_val': 0.34226101870058623, 'psi': 0.9519810084867399}
[S5] START round=18 head_norm_before_train=1.428073 cos_to_last_merge=1.0000 (last merge round=17)
[S5] round=18 local utility u=0.000000 metrics={'f1_val': 0.5719331424966712, 'auprc': 0.8499555439860953, 'loss_val': 0.6139425610961472, 'psi': 0.6831421030924408}-{'f1_val': 0.7005691551769304, 'auprc': 0.9909552725749011, 'loss_val': 0.43588121036931377, 'psi': 0.8167236021361187}
[S6] START round=18 head_norm_before_train=1.555672 cos_to_last_merge=0.9995 (last merge round=16)
[S6] round=18 local utility u=0.000000 metrics={'f1_val': 0.8218540739306776, 'auprc': 0.8236023024552124, 'loss_val': 0.37919681868067356, 'psi': 0.8225533653404915}-{'f1_val': 0.8455819312788464, 'auprc': 0.9521456869796961, 'loss_val': 0.33495957240808416, 'psi': 0.8882074335591863}
[S7] START round=18 head_norm_before_train=1.304225 cos_to_last_merge=0.8542 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.854
[S7] round=18 local utility u=0.000000 metrics={'f1_val': 0.5480645512179739, 'auprc': 0.7859465315113686, 'loss_val': 0.7907778147171802, 'psi': 0.6432173433353319}-{'f1_val': 0.5510655411227242, 'auprc': 0.7852031127669457, 'loss_val': 0.793078008873747, 'psi': 0.6447205697804128}
[S8] START round=18 head_norm_before_train=1.921435 (no previous merge yet)
[S8] round=18 local utility u=0.000000 metrics={'f1_val': 0.9937036553844988, 'auprc': 0.9965535242711292, 'loss_val': 0.04896664153011317, 'psi': 0.994843602939151}-{'f1_val': 0.9942788405856967, 'auprc': 0.99936048085043, 'loss_val': 0.03668548321691091, 'psi': 0.99631149669159}
[S9] START round=18 head_norm_before_train=0.964795 cos_to_last_merge=1.0000 (last merge round=17)
[S9] round=18 local utility u=0.000000 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9982553774481757, 'loss_val': 0.34321688135528483, 'psi': 0.8200764411038084}-{'f1_val': 0.7012904835408967, 'auprc': 0.9988401333430657, 'loss_val': 0.3375055759593782, 'psi': 0.8203103434617643}
[S10] START round=18 head_norm_before_train=1.668495 cos_to_last_merge=0.7871 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.787
[S10] round=18 local utility u=0.000000 metrics={'f1_val': 0.9948838907637279, 'auprc': 0.9938160620379486, 'loss_val': 0.049263924236708515, 'psi': 0.9944567592734161}-{'f1_val': 0.9939487387271932, 'auprc': 0.9965234701541549, 'loss_val': 0.04894697018880826, 'psi': 0.9949786312979778}
[S11] START round=18 head_norm_before_train=0.900962 cos_to_last_merge=1.0000 (last merge round=17)
[S11] round=18 local utility u=0.000000 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9370283563532384, 'loss_val': 0.4850014619217588, 'psi': 0.7959725325202874}-{'f1_val': 0.7016282822309048, 'auprc': 0.9980853940419212, 'loss_val': 0.4801594731470298, 'psi': 0.8202111269553114}
[S13] START round=18 head_norm_before_train=1.710220 (no previous merge yet)
[S13] round=18 local utility u=0.000000 metrics={'f1_val': 0.6132970803465492, 'auprc': 0.6838440344418543, 'loss_val': 0.7348364372093775, 'psi': 0.6415158619846713}-{'f1_val': 0.6261258370900146, 'auprc': 0.6742509787401108, 'loss_val': 0.6575347125286352, 'psi': 0.6453758937500531}
[S14] START round=18 head_norm_before_train=0.973420 cos_to_last_merge=1.0000 (last merge round=17)
[S14] round=18 local utility u=0.000000 metrics={'f1_val': 0.9806544189294047, 'auprc': 0.9971281624913996, 'loss_val': 0.379129085641624, 'psi': 0.9872439163542027}-{'f1_val': 0.9974280040892742, 'auprc': 0.9972933953653049, 'loss_val': 0.43264482359340733, 'psi': 0.9973741605996864}
[S15] START round=18 head_norm_before_train=1.599684 cos_to_last_merge=1.0000 (last merge round=17)
[S15] round=18 local utility u=0.000000 metrics={'f1_val': 0.981946514125714, 'auprc': 0.9664119831481836, 'loss_val': 0.1605954083700449, 'psi': 0.9757327017347017}-{'f1_val': 0.9890915335426116, 'auprc': 0.9745759438190483, 'loss_val': 0.1256353140847515, 'psi': 0.9832852976531863}
[S16] START round=18 head_norm_before_train=1.729838 (no previous merge yet)
[S16] round=18 local utility u=0.057347 metrics={'f1_val': 0.9390473409802311, 'auprc': 0.9915926862627586, 'loss_val': 0.2364826748301176, 'psi': 0.9600654790932421}-{'f1_val': 0.9300819620815817, 'auprc': 0.9916817438999452, 'loss_val': 0.2976523100148754, 'psi': 0.9547218748089271}
[S17] START round=18 head_norm_before_train=1.489339 cos_to_last_merge=0.8308 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.831
[S17] round=18 local utility u=0.238623 metrics={'f1_val': 0.685088351331535, 'auprc': 0.9616792899101507, 'loss_val': 0.5674310008263592, 'psi': 0.7957247267629812}-{'f1_val': 0.6657067452386514, 'auprc': 0.8287042730440556, 'loss_val': 0.5294619932279393, 'psi': 0.730905756360813}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:59807
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] → sending delta(kind=head bytes=1804) to S4@127.0.0.1:59804
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1804 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1804) from S16
[S4] cosine check vs S16: cos=-0.0106
[S4] DROPPED delta from S16 (cos=-0.0106 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1800) from S2
[S6] cosine check vs S2: cos=0.4808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:59805
[S17] sending update (kind=head size=1800 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1800) from S17
[S5] cosine check vs S17: cos=0.2444
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=18 metric=0.5719 head_norm=1.455886
[S5] _apply_head_vector_avg (torch): Δ‖w‖=9.176303e-01
[S5] stored merged vector for next round verification (round=18)
[S5] DEBUG after merge:  round=18 metric=0.4321 head_norm=1.177260 delta_norm=0.917630
[S5] aggregate: ROLLBACK (f1_val pre=0.572 post=0.432 tol_abs=0.005 tol_rel=0.0)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=18 metric=0.8219 head_norm=1.589101
[S6] _apply_head_vector_avg (torch): Δ‖w‖=8.621278e-01
[S6] stored merged vector for next round verification (round=18)
[S6] DEBUG after merge:  round=18 metric=0.6834 head_norm=1.450173 delta_norm=0.862128
[S6] aggregate: ROLLBACK (f1_val pre=0.822 post=0.683 tol_abs=0.005 tol_rel=0.0)
[S2] START round=19 head_norm_before_train=1.779688 cos_to_last_merge=0.9982 (last merge round=16)
[S2] round=19 local utility u=0.000000 metrics={'f1_val': 0.7044927378096336, 'auprc': 0.7184367143548531, 'loss_val': 0.7389682550645945, 'psi': 0.7100703284277214}-{'f1_val': 0.7021718359327874, 'auprc': 0.7215037975590343, 'loss_val': 0.7292954435348014, 'psi': 0.7099046205832862}
[S3] START round=19 head_norm_before_train=1.791081 (no previous merge yet)
[S3] round=19 local utility u=0.129712 metrics={'f1_val': 0.9978100342676263, 'auprc': 0.9967847489024885, 'loss_val': 0.05935426696625491, 'psi': 0.9973999201215711}-{'f1_val': 0.9615385219550141, 'auprc': 0.9967396067966607, 'loss_val': 0.10101354061373119, 'psi': 0.9756189558916728}
[S4] START round=19 head_norm_before_train=1.712548 cos_to_last_merge=0.9989 (last merge round=17)
[S4] round=19 local utility u=0.018620 metrics={'f1_val': 0.9535423783653669, 'auprc': 0.9508923694784097, 'loss_val': 0.3074410568360268, 'psi': 0.952482374810584}-{'f1_val': 0.9493393327296638, 'auprc': 0.960144745600803, 'loss_val': 0.347220876043197, 'psi': 0.9536614978781195}
[S5] START round=19 head_norm_before_train=1.177260 cos_to_last_merge=1.0000 (last merge round=18)
[S5] round=19 local utility u=0.708159 metrics={'f1_val': 0.7003221706489986, 'auprc': 0.9922520597615748, 'loss_val': 0.39484833468508695, 'psi': 0.8170941262940291}-{'f1_val': 0.5719331424966712, 'auprc': 0.8499555439860953, 'loss_val': 0.6139425610961472, 'psi': 0.6831421030924408}
[S6] START round=19 head_norm_before_train=1.450173 cos_to_last_merge=1.0000 (last merge round=18)
[S6] round=19 local utility u=0.000000 metrics={'f1_val': 0.726454898416147, 'auprc': 0.802566763618168, 'loss_val': 0.5351087624686689, 'psi': 0.7568996444969553}-{'f1_val': 0.8218540739306776, 'auprc': 0.8236023024552124, 'loss_val': 0.37919681868067356, 'psi': 0.8225533653404915}
[S7] START round=19 head_norm_before_train=1.320618 cos_to_last_merge=0.8505 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.850
[S7] round=19 local utility u=0.353342 metrics={'f1_val': 0.6250614378131836, 'auprc': 0.8023422891736103, 'loss_val': 0.5952615124809367, 'psi': 0.6959737783573543}-{'f1_val': 0.5480645512179739, 'auprc': 0.7859465315113686, 'loss_val': 0.7907778147171802, 'psi': 0.6432173433353319}
[S8] START round=19 head_norm_before_train=1.946339 (no previous merge yet)
[S8] round=19 local utility u=0.015454 metrics={'f1_val': 0.9946523328827459, 'auprc': 0.9991753923123212, 'loss_val': 0.0316153702469089, 'psi': 0.996461556654576}-{'f1_val': 0.9937036553844988, 'auprc': 0.9965535242711292, 'loss_val': 0.04896664153011317, 'psi': 0.994843602939151}
[S9] START round=19 head_norm_before_train=1.012702 cos_to_last_merge=0.9980 (last merge round=17)
[S9] round=19 local utility u=0.017284 metrics={'f1_val': 0.7013646677191758, 'auprc': 0.9982580067513505, 'loss_val': 0.30910154720978406, 'psi': 0.8201220033320458}-{'f1_val': 0.7012904835408967, 'auprc': 0.9982553774481757, 'loss_val': 0.34321688135528483, 'psi': 0.8200764411038084}
[S10] START round=19 head_norm_before_train=1.700517 cos_to_last_merge=0.7827 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.783
[S10] round=19 local utility u=0.002699 metrics={'f1_val': 0.9948838907637279, 'auprc': 0.9938668336364107, 'loss_val': 0.044018929185784886, 'psi': 0.994477067912801}-{'f1_val': 0.9948838907637279, 'auprc': 0.9938160620379486, 'loss_val': 0.049263924236708515, 'psi': 0.9944567592734161}
[S11] START round=19 head_norm_before_train=0.946780 cos_to_last_merge=0.9968 (last merge round=17)
[S11] round=19 local utility u=0.133969 metrics={'f1_val': 0.7018701185892477, 'auprc': 0.9952795092592699, 'loss_val': 0.39142487173229445, 'psi': 0.8192338748572566}-{'f1_val': 0.7019353166316534, 'auprc': 0.9370283563532384, 'loss_val': 0.4850014619217588, 'psi': 0.7959725325202874}
[S13] START round=19 head_norm_before_train=1.730442 (no previous merge yet)
[S13] round=19 local utility u=0.000000 metrics={'f1_val': 0.5944722586607318, 'auprc': 0.6885717886652328, 'loss_val': 0.8096099824732476, 'psi': 0.6321120706625323}-{'f1_val': 0.6132970803465492, 'auprc': 0.6838440344418543, 'loss_val': 0.7348364372093775, 'psi': 0.6415158619846713}
[S14] START round=19 head_norm_before_train=1.015782 cos_to_last_merge=0.9975 (last merge round=17)
[S14] round=19 local utility u=0.082599 metrics={'f1_val': 0.9975988769325926, 'auprc': 0.9955313637926859, 'loss_val': 0.31080668237266157, 'psi': 0.99677187167663}-{'f1_val': 0.9806544189294047, 'auprc': 0.9971281624913996, 'loss_val': 0.379129085641624, 'psi': 0.9872439163542027}
[S15] START round=19 head_norm_before_train=1.644125 cos_to_last_merge=0.9993 (last merge round=17)
[S15] round=19 local utility u=0.000000 metrics={'f1_val': 0.6926928044035656, 'auprc': 0.854540531568317, 'loss_val': 0.4862659703739204, 'psi': 0.7574318952694662}-{'f1_val': 0.981946514125714, 'auprc': 0.9664119831481836, 'loss_val': 0.1605954083700449, 'psi': 0.9757327017347017}
[S16] START round=19 head_norm_before_train=1.765856 (no previous merge yet)
[S16] round=19 local utility u=0.182446 metrics={'f1_val': 0.9804418173823711, 'auprc': 0.9916431939566867, 'loss_val': 0.12010997597163395, 'psi': 0.9849223680120973}-{'f1_val': 0.9390473409802311, 'auprc': 0.9915926862627586, 'loss_val': 0.2364826748301176, 'psi': 0.9600654790932421}
[S17] START round=19 head_norm_before_train=1.528519 cos_to_last_merge=0.8269 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.827
[S17] round=19 local utility u=0.000000 metrics={'f1_val': 0.6788839732756131, 'auprc': 0.970219535912244, 'loss_val': 0.6298990266404126, 'psi': 0.7954181983302655}-{'f1_val': 0.685088351331535, 'auprc': 0.9616792899101507, 'loss_val': 0.5674310008263592, 'psi': 0.7957247267629812}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S11] → sending delta(kind=head bytes=1790) to S9@127.0.0.1:59810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:59805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S5] → sending delta(kind=head bytes=1806) to S9@127.0.0.1:59810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:59802
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S14] → sending delta(kind=head bytes=1792) to S11@127.0.0.1:59812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:59804
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:59807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:59804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:59814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:59807
[S5] sending update (kind=head size=1806 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1792 to 1 peers)
[S11] sending update (kind=head size=1790 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1792) from S14
[S11] cosine check vs S14: cos=0.9346
[S6] RECEIVED delta(kind=head bytes=1799) from S7
[S6] cosine check vs S7: cos=-0.0104
[S6] DROPPED delta from S7 (cos=-0.0104 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1799) from S9
[S14] cosine check vs S9: cos=0.6236
[S6] RECEIVED delta(kind=head bytes=1798) from S8
[S6] cosine check vs S8: cos=0.6433
[S9] RECEIVED delta(kind=head bytes=1790) from S11
[S9] cosine check vs S11: cos=0.7874
[S2] RECEIVED delta(kind=head bytes=1801) from S3
[S2] cosine check vs S3: cos=0.9890
[S9] RECEIVED delta(kind=head bytes=1806) from S5
[S9] cosine check vs S5: cos=0.4627
[S4] RECEIVED delta(kind=head bytes=1802) from S10
[S4] cosine check vs S10: cos=0.9831
[S4] RECEIVED delta(kind=head bytes=1800) from S16
[S4] cosine check vs S16: cos=-0.0074
[S4] DROPPED delta from S16 (cos=-0.0074 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1802) from S4
[S5] cosine check vs S4: cos=0.6246
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=19 metric=0.7265 head_norm=1.492750
[S6] _apply_head_vector_avg (torch): Δ‖w‖=7.608616e-01
[S6] stored merged vector for next round verification (round=19)
[S6] DEBUG after merge:  round=19 metric=0.7883 head_norm=1.570328 delta_norm=0.760862
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S6] r=20 psi=0.757 u=0.0000 p_local=0.1414 f1=0.726 auprc=0.803 bytes=18006
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=19 metric=0.7045 head_norm=1.797176
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.349221e-01
[S2] stored merged vector for next round verification (round=19)
[S2] DEBUG after merge:  round=19 metric=0.7057 head_norm=1.804135 delta_norm=0.134922
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] r=20 psi=0.710 u=0.0000 p_local=0.0859 f1=0.704 auprc=0.718 bytes=16188
[S13] r=20 psi=0.632 u=0.0000 p_local=0.0952 f1=0.594 auprc=0.689 bytes=14413
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=19 metric=0.9976 head_norm=1.057789
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.585107e-01
[S14] stored merged vector for next round verification (round=19)
[S14] DEBUG after merge:  round=19 metric=0.9947 head_norm=0.952300 delta_norm=0.458511
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S14] r=20 psi=0.997 u=0.0826 p_local=0.1948 f1=0.998 auprc=0.996 bytes=21540
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=19 metric=0.9535 head_norm=1.765760
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.616752e-01
[S4] stored merged vector for next round verification (round=19)
[S4] DEBUG after merge:  round=19 metric=0.9527 head_norm=1.738515 delta_norm=0.161675
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S4] r=20 psi=0.952 u=0.0186 p_local=0.1644 f1=0.954 auprc=0.951 bytes=19790
[S8] r=20 psi=0.996 u=0.0155 p_local=0.0587 f1=0.995 auprc=0.999 bytes=19800
[S7] r=20 psi=0.696 u=0.3533 p_local=0.1915 f1=0.625 auprc=0.802 bytes=16181
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=19 metric=0.7003 head_norm=1.213256
[S5] _apply_head_vector_avg (torch): Δ‖w‖=6.916935e-01
[S5] stored merged vector for next round verification (round=19)
[S5] DEBUG after merge:  round=19 metric=0.7006 head_norm=1.347780 delta_norm=0.691693
[S5] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S5] r=20 psi=0.817 u=0.7082 p_local=0.2890 f1=0.700 auprc=0.992 bytes=19768
[S10] r=20 psi=0.994 u=0.0027 p_local=0.0739 f1=0.995 auprc=0.994 bytes=19832
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=19 metric=0.7014 head_norm=1.056076
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.587935e-01
[S9] stored merged vector for next round verification (round=19)
[S9] DEBUG after merge:  round=19 metric=0.7014 head_norm=0.915676 delta_norm=0.358793
[S9] aggregate: ACCEPT kept=['S11', 'S5'] (k=2/2) mode=median trim_p=0.1
[S9] r=20 psi=0.820 u=0.0173 p_local=0.0642 f1=0.701 auprc=0.998 bytes=23346
[S16] r=20 psi=0.985 u=0.1824 p_local=0.2358 f1=0.980 auprc=0.992 bytes=23375
[S3] r=20 psi=0.997 u=0.1297 p_local=0.1755 f1=0.998 auprc=0.997 bytes=19759
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=19 metric=0.7019 head_norm=0.994152
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.881789e-01
[S11] stored merged vector for next round verification (round=19)
[S11] DEBUG after merge:  round=19 metric=0.7019 head_norm=1.009067 delta_norm=0.188179
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S11] r=20 psi=0.819 u=0.1340 p_local=0.1305 f1=0.702 auprc=0.995 bytes=19759
[S17] r=20 psi=0.795 u=0.0000 p_local=0.1531 f1=0.679 auprc=0.970 bytes=17985
[S15] r=20 psi=0.757 u=0.0000 p_local=0.1679 f1=0.693 auprc=0.855 bytes=16186
[S2] START round=20 head_norm_before_train=1.804135 cos_to_last_merge=1.0000 (last merge round=19)
[S2] round=20 local utility u=0.041817 metrics={'f1_val': 0.7092804527132146, 'auprc': 0.7229042521688942, 'loss_val': 0.6974631802229518, 'psi': 0.7147299724954865}-{'f1_val': 0.7044927378096336, 'auprc': 0.7184367143548531, 'loss_val': 0.7389682550645945, 'psi': 0.7100703284277214}
[S3] START round=20 head_norm_before_train=1.821092 (no previous merge yet)
[S3] round=20 local utility u=0.003653 metrics={'f1_val': 0.9978100342676263, 'auprc': 0.9968773817924226, 'loss_val': 0.05232588111670209, 'psi': 0.9974369732775448}-{'f1_val': 0.9978100342676263, 'auprc': 0.9967847489024885, 'loss_val': 0.05935426696625491, 'psi': 0.9973999201215711}
[S4] START round=20 head_norm_before_train=1.738515 cos_to_last_merge=1.0000 (last merge round=19)
[S4] round=20 local utility u=0.010689 metrics={'f1_val': 0.9521438063190345, 'auprc': 0.9566980267433324, 'loss_val': 0.29508937034129573, 'psi': 0.9539654944887537}-{'f1_val': 0.9535423783653669, 'auprc': 0.9508923694784097, 'loss_val': 0.3074410568360268, 'psi': 0.952482374810584}
[S5] START round=20 head_norm_before_train=1.347780 cos_to_last_merge=1.0000 (last merge round=19)
[S5] round=20 local utility u=0.000000 metrics={'f1_val': 0.4177062138068043, 'auprc': 0.7689066038645889, 'loss_val': 0.8992188111007627, 'psi': 0.5581863698299181}-{'f1_val': 0.7003221706489986, 'auprc': 0.9922520597615748, 'loss_val': 0.39484833468508695, 'psi': 0.8170941262940291}
[S6] START round=20 head_norm_before_train=1.570328 cos_to_last_merge=1.0000 (last merge round=19)
[S6] round=20 local utility u=0.000000 metrics={'f1_val': 0.6881729705777728, 'auprc': 0.7980884200274462, 'loss_val': 0.4416971153248729, 'psi': 0.7321391503576422}-{'f1_val': 0.726454898416147, 'auprc': 0.802566763618168, 'loss_val': 0.5351087624686689, 'psi': 0.7568996444969553}
[S7] START round=20 head_norm_before_train=1.337091 cos_to_last_merge=0.8471 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.847
[S7] round=20 local utility u=0.414960 metrics={'f1_val': 0.6907771495672063, 'auprc': 0.87042260849478, 'loss_val': 0.36387616237544135, 'psi': 0.7626353331382358}-{'f1_val': 0.6250614378131836, 'auprc': 0.8023422891736103, 'loss_val': 0.5952615124809367, 'psi': 0.6959737783573543}
[S8] START round=20 head_norm_before_train=1.965039 (no previous merge yet)
[S8] round=20 local utility u=0.000000 metrics={'f1_val': 0.9924611780272952, 'auprc': 0.9993978292102772, 'loss_val': 0.031709594633576234, 'psi': 0.995235838500488}-{'f1_val': 0.9946523328827459, 'auprc': 0.9991753923123212, 'loss_val': 0.0316153702469089, 'psi': 0.996461556654576}
[S9] START round=20 head_norm_before_train=0.915676 cos_to_last_merge=1.0000 (last merge round=19)
[S9] round=20 local utility u=0.000000 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9980543353586606, 'loss_val': 0.35604556801700743, 'psi': 0.8199960242680023}-{'f1_val': 0.7013646677191758, 'auprc': 0.9982580067513505, 'loss_val': 0.30910154720978406, 'psi': 0.8201220033320458}
[S10] START round=20 head_norm_before_train=1.726047 cos_to_last_merge=0.7798 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.780
[S10] round=20 local utility u=0.003469 metrics={'f1_val': 0.9937452946631335, 'auprc': 0.9966419715917926, 'loss_val': 0.03857385634597401, 'psi': 0.9949039654345971}-{'f1_val': 0.9948838907637279, 'auprc': 0.9938668336364107, 'loss_val': 0.044018929185784886, 'psi': 0.994477067912801}
[S11] START round=20 head_norm_before_train=1.009067 cos_to_last_merge=1.0000 (last merge round=19)
[S11] round=20 local utility u=0.011659 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9984440390918757, 'loss_val': 0.3765409352037894, 'psi': 0.8203937033889053}-{'f1_val': 0.7018701185892477, 'auprc': 0.9952795092592699, 'loss_val': 0.39142487173229445, 'psi': 0.8192338748572566}
[S13] START round=20 head_norm_before_train=1.740719 (no previous merge yet)
[S13] round=20 local utility u=0.236492 metrics={'f1_val': 0.6384864873028295, 'auprc': 0.6697688601089595, 'loss_val': 0.5443031544836179, 'psi': 0.6509994364252816}-{'f1_val': 0.5944722586607318, 'auprc': 0.6885717886652328, 'loss_val': 0.8096099824732476, 'psi': 0.6321120706625323}
[S14] START round=20 head_norm_before_train=0.952300 cos_to_last_merge=1.0000 (last merge round=19)
[S14] round=20 local utility u=0.000000 metrics={'f1_val': 0.981960164297736, 'auprc': 0.9971531834166462, 'loss_val': 0.27193581638527775, 'psi': 0.9880373719453002}-{'f1_val': 0.9975988769325926, 'auprc': 0.9955313637926859, 'loss_val': 0.31080668237266157, 'psi': 0.99677187167663}
[S15] START round=20 head_norm_before_train=1.678933 cos_to_last_merge=0.9980 (last merge round=17)
[S15] round=20 local utility u=0.771357 metrics={'f1_val': 0.8604316848932628, 'auprc': 0.9558231835248312, 'loss_val': 0.2538336097489202, 'psi': 0.8985882843458902}-{'f1_val': 0.6926928044035656, 'auprc': 0.854540531568317, 'loss_val': 0.4862659703739204, 'psi': 0.7574318952694662}
[S16] START round=20 head_norm_before_train=1.801267 (no previous merge yet)
[S16] round=20 local utility u=0.000000 metrics={'f1_val': 0.9682831305049392, 'auprc': 0.9966053832344546, 'loss_val': 0.12547384856574584, 'psi': 0.9796120315967454}-{'f1_val': 0.9804418173823711, 'auprc': 0.9916431939566867, 'loss_val': 0.12010997597163395, 'psi': 0.9849223680120973}
[S17] START round=20 head_norm_before_train=1.561219 cos_to_last_merge=0.8244 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.824
[S17] round=20 local utility u=0.059816 metrics={'f1_val': 0.6990638524099674, 'auprc': 0.9823542862636382, 'loss_val': 0.6677503703876319, 'psi': 0.8123800259514358}-{'f1_val': 0.6788839732756131, 'auprc': 0.970219535912244, 'loss_val': 0.6298990266404126, 'psi': 0.7954181983302655}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:59804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:59810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:59814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:59810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:59807
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S2@127.0.0.1:59802
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:59807
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:59805
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1804 to 1 peers)
[S3] sending update (kind=head size=1803 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1804) from S4
[S5] cosine check vs S4: cos=0.9289
[S6] RECEIVED delta(kind=head bytes=1798) from S7
[S6] cosine check vs S7: cos=-0.0079
[S6] DROPPED delta from S7 (cos=-0.0079 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1798) from S2
[S6] cosine check vs S2: cos=0.5137
[S14] RECEIVED delta(kind=head bytes=1798) from S15
[S14] cosine check vs S15: cos=0.4495
[S9] RECEIVED delta(kind=head bytes=1801) from S13
[S9] cosine check vs S13: cos=0.6002
[S9] RECEIVED delta(kind=head bytes=1796) from S11
[S9] cosine check vs S11: cos=0.7892
[S2] RECEIVED delta(kind=head bytes=1803) from S3
[S2] cosine check vs S3: cos=0.9952
[S4] RECEIVED delta(kind=head bytes=1801) from S10
[S4] cosine check vs S10: cos=0.9899
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:59805
[S17] sending update (kind=head size=1801 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1801) from S17
[S5] cosine check vs S17: cos=0.3883
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=20 metric=0.6882 head_norm=1.618343
[S6] _apply_head_vector_avg (torch): Δ‖w‖=8.534646e-01
[S6] stored merged vector for next round verification (round=20)
[S6] DEBUG after merge:  round=20 metric=0.6413 head_norm=1.498349 delta_norm=0.853465
[S6] aggregate: ROLLBACK (f1_val pre=0.688 post=0.641 tol_abs=0.005 tol_rel=0.0)
[S6] ⇄ pheromone p=0.113 → S15@127.0.0.1:59815
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=20 metric=0.4177 head_norm=1.377077
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.437049e-01
[S5] stored merged vector for next round verification (round=20)
[S5] DEBUG after merge:  round=20 metric=0.4177 head_norm=1.276013 delta_norm=0.243705
[S5] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.231 → S9@127.0.0.1:59810
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=20 metric=0.9521 head_norm=1.791291
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.271327e-01
[S4] stored merged vector for next round verification (round=20)
[S4] DEBUG after merge:  round=20 metric=0.9520 head_norm=1.767123 delta_norm=0.127133
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.134 → S5@127.0.0.1:59805
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=20 metric=0.7093 head_norm=1.824245
[S2] _apply_head_vector_avg (torch): Δ‖w‖=9.108768e-02
[S2] stored merged vector for next round verification (round=20)
[S2] DEBUG after merge:  round=20 metric=0.7090 head_norm=1.833309 delta_norm=0.091088
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.077 → S6@127.0.0.1:59807
[S7] ⇄ pheromone p=0.236 → S6@127.0.0.1:59807
[S3] ⇄ pheromone p=0.141 → S2@127.0.0.1:59802
[S8] ⇄ pheromone p=0.047 → S6@127.0.0.1:59807
[S13] ⇄ pheromone p=0.123 → S9@127.0.0.1:59810
[S10] ⇄ pheromone p=0.060 → S4@127.0.0.1:59804
[S11] ⇄ pheromone p=0.107 → S9@127.0.0.1:59810
[S15] ⇄ pheromone p=0.289 → S14@127.0.0.1:59814
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=20 metric=0.9820 head_norm=0.997904
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.714215e-01
[S14] stored merged vector for next round verification (round=20)
[S14] DEBUG after merge:  round=20 metric=0.9972 head_norm=1.166709 delta_norm=0.771421
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.156 → S11@127.0.0.1:59812
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=20 metric=0.7013 head_norm=0.957187
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.724077e-01
[S9] stored merged vector for next round verification (round=20)
[S9] DEBUG after merge:  round=20 metric=0.7013 head_norm=1.019529 delta_norm=0.372408
[S9] aggregate: ACCEPT kept=['S13', 'S11'] (k=2/2) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.051 → S14@127.0.0.1:59814
[S16] ⇄ pheromone p=0.189 → S4@127.0.0.1:59804
[S17] ⇄ pheromone p=0.134 → S5@127.0.0.1:59805
[S2] START round=21 head_norm_before_train=1.833309 cos_to_last_merge=1.0000 (last merge round=20)
[S2] round=21 local utility u=0.000000 metrics={'f1_val': 0.6621713140894733, 'auprc': 0.7176676143544285, 'loss_val': 0.8886565980718576, 'psi': 0.6843698341954554}-{'f1_val': 0.7092804527132146, 'auprc': 0.7229042521688942, 'loss_val': 0.6974631802229518, 'psi': 0.7147299724954865}
[S3] START round=21 head_norm_before_train=1.846827 (no previous merge yet)
[S3] round=21 local utility u=0.000000 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.9967665419253584, 'loss_val': 0.10840852588970988, 'psi': 0.9753277674334095}-{'f1_val': 0.9978100342676263, 'auprc': 0.9968773817924226, 'loss_val': 0.05232588111670209, 'psi': 0.9974369732775448}
[S4] START round=21 head_norm_before_train=1.767123 cos_to_last_merge=1.0000 (last merge round=20)
[S4] round=21 local utility u=0.008277 metrics={'f1_val': 0.9562047432042488, 'auprc': 0.947419104715955, 'loss_val': 0.2750652063637982, 'psi': 0.9526904878089313}-{'f1_val': 0.9521438063190345, 'auprc': 0.9566980267433324, 'loss_val': 0.29508937034129573, 'psi': 0.9539654944887537}
[S5] START round=21 head_norm_before_train=1.276013 cos_to_last_merge=1.0000 (last merge round=20)
[S5] round=21 local utility u=1.000000 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9876178164052605, 'loss_val': 0.36874868608676137, 'psi': 0.8152399170224525}-{'f1_val': 0.4177062138068043, 'auprc': 0.7689066038645889, 'loss_val': 0.8992188111007627, 'psi': 0.5581863698299181}
[S6] START round=21 head_norm_before_train=1.498349 cos_to_last_merge=1.0000 (last merge round=20)
[S6] round=21 local utility u=0.414682 metrics={'f1_val': 0.7887334378790258, 'auprc': 0.8969480042632876, 'loss_val': 0.5122741678098819, 'psi': 0.8320192644327306}-{'f1_val': 0.6881729705777728, 'auprc': 0.7980884200274462, 'loss_val': 0.4416971153248729, 'psi': 0.7321391503576422}
[S7] START round=21 head_norm_before_train=1.348263 cos_to_last_merge=0.8451 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.845
[S7] round=21 local utility u=0.000000 metrics={'f1_val': 0.4881069465000514, 'auprc': 0.7811795660042359, 'loss_val': 0.9185089289944277, 'psi': 0.6053359943017251}-{'f1_val': 0.6907771495672063, 'auprc': 0.87042260849478, 'loss_val': 0.36387616237544135, 'psi': 0.7626353331382358}
[S8] START round=21 head_norm_before_train=1.983459 (no previous merge yet)
[S8] round=21 local utility u=0.000000 metrics={'f1_val': 0.9892968853633592, 'auprc': 0.9985645659009272, 'loss_val': 0.04092113400225334, 'psi': 0.9930039575783864}-{'f1_val': 0.9924611780272952, 'auprc': 0.9993978292102772, 'loss_val': 0.031709594633576234, 'psi': 0.995235838500488}
[S9] START round=21 head_norm_before_train=1.019529 cos_to_last_merge=1.0000 (last merge round=20)
[S9] round=21 local utility u=0.035198 metrics={'f1_val': 0.7013646677191758, 'auprc': 0.998659140336924, 'loss_val': 0.28790998514717075, 'psi': 0.8202824567662752}-{'f1_val': 0.7012904835408967, 'auprc': 0.9980543353586606, 'loss_val': 0.35604556801700743, 'psi': 0.8199960242680023}
[S10] START round=21 head_norm_before_train=1.751869 cos_to_last_merge=0.7769 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.777
[S10] round=21 local utility u=0.000771 metrics={'f1_val': 0.9937452946631335, 'auprc': 0.9965200792780144, 'loss_val': 0.03666587592059472, 'psi': 0.9948552085090858}-{'f1_val': 0.9937452946631335, 'auprc': 0.9966419715917926, 'loss_val': 0.03857385634597401, 'psi': 0.9949039654345971}
[S11] START round=21 head_norm_before_train=1.052960 cos_to_last_merge=0.9980 (last merge round=19)
[S11] round=21 local utility u=0.792899 metrics={'f1_val': 0.9569423019309666, 'auprc': 0.998602041475071, 'loss_val': 0.3227094565585667, 'psi': 0.9736061977486083}-{'f1_val': 0.7016934795869249, 'auprc': 0.9984440390918757, 'loss_val': 0.3765409352037894, 'psi': 0.8203937033889053}
[S13] START round=21 head_norm_before_train=1.751424 (no previous merge yet)
[S13] round=21 local utility u=0.000000 metrics={'f1_val': 0.5850738550801102, 'auprc': 0.6908126044887647, 'loss_val': 0.8765288241370846, 'psi': 0.6273693548435719}-{'f1_val': 0.6384864873028295, 'auprc': 0.6697688601089595, 'loss_val': 0.5443031544836179, 'psi': 0.6509994364252816}
[S14] START round=21 head_norm_before_train=1.166709 cos_to_last_merge=1.0000 (last merge round=20)
[S14] round=21 local utility u=0.016349 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9970379729209384, 'loss_val': 0.3330371647979383, 'psi': 0.9974058599982876}-{'f1_val': 0.981960164297736, 'auprc': 0.9971531834166462, 'loss_val': 0.27193581638527775, 'psi': 0.9880373719453002}
[S15] START round=21 head_norm_before_train=1.707860 cos_to_last_merge=0.9966 (last merge round=17)
[S15] round=21 local utility u=0.000000 metrics={'f1_val': 0.6970639330318791, 'auprc': 0.9022328895111529, 'loss_val': 0.4957360254114753, 'psi': 0.7791315156235886}-{'f1_val': 0.8604316848932628, 'auprc': 0.9558231835248312, 'loss_val': 0.2538336097489202, 'psi': 0.8985882843458902}
[S16] START round=21 head_norm_before_train=1.831090 (no previous merge yet)
[S16] round=21 local utility u=0.000000 metrics={'f1_val': 0.8862082846548913, 'auprc': 0.9925947633705738, 'loss_val': 0.45388614745241795, 'psi': 0.9287628761411644}-{'f1_val': 0.9682831305049392, 'auprc': 0.9966053832344546, 'loss_val': 0.12547384856574584, 'psi': 0.9796120315967454}
[S17] START round=21 head_norm_before_train=1.582810 cos_to_last_merge=0.8222 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.822
[S17] round=21 local utility u=0.000000 metrics={'f1_val': 0.7014326196716528, 'auprc': 0.9608381595236976, 'loss_val': 0.7251876149664267, 'psi': 0.8051948356124707}-{'f1_val': 0.6990638524099674, 'auprc': 0.9823542862636382, 'loss_val': 0.6677503703876319, 'psi': 0.8123800259514358}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:59804
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S9] → sending delta(kind=head bytes=1790) to S14@127.0.0.1:59814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:59810
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:59815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S4] → sending delta(kind=head bytes=1806) to S5@127.0.0.1:59805
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:59810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:59812
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1806 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1790 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1800) from S6
[S15] cosine check vs S6: cos=0.7869
[S9] RECEIVED delta(kind=head bytes=1798) from S11
[S9] cosine check vs S11: cos=0.8114
[S9] RECEIVED delta(kind=head bytes=1799) from S5
[S9] cosine check vs S5: cos=0.4303
[S14] RECEIVED delta(kind=head bytes=1790) from S9
[S14] cosine check vs S9: cos=0.5843
[S4] RECEIVED delta(kind=head bytes=1803) from S10
[S4] cosine check vs S10: cos=0.9929
[S5] RECEIVED delta(kind=head bytes=1806) from S4
[S5] cosine check vs S4: cos=0.8589
[S11] RECEIVED delta(kind=head bytes=1796) from S14
[S11] cosine check vs S14: cos=0.8781
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=21 metric=0.6971 head_norm=1.738878
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.428849e-01
[S15] stored merged vector for next round verification (round=21)
[S15] DEBUG after merge:  round=21 metric=0.6972 head_norm=1.547108 delta_norm=0.542885
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=21 metric=0.9977 head_norm=1.202614
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.197526e-01
[S14] stored merged vector for next round verification (round=21)
[S14] DEBUG after merge:  round=21 metric=0.9956 head_norm=1.007747 delta_norm=0.519753
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=21 metric=0.9569 head_norm=1.094001
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.883183e-01
[S11] stored merged vector for next round verification (round=21)
[S11] DEBUG after merge:  round=21 metric=0.9574 head_norm=1.112849 delta_norm=0.288318
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=21 metric=0.7014 head_norm=1.060713
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.770348e-01
[S9] stored merged vector for next round verification (round=21)
[S9] DEBUG after merge:  round=21 metric=0.7014 head_norm=0.953381 delta_norm=0.377035
[S9] aggregate: ACCEPT kept=['S11', 'S5'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=21 metric=0.7003 head_norm=1.297024
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.833462e-01
[S5] stored merged vector for next round verification (round=21)
[S5] DEBUG after merge:  round=21 metric=0.7003 head_norm=1.502307 delta_norm=0.483346
[S5] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=21 metric=0.9562 head_norm=1.816267
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.089489e-01
[S4] stored merged vector for next round verification (round=21)
[S4] DEBUG after merge:  round=21 metric=0.9562 head_norm=1.793250 delta_norm=0.108949
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=1.865452 cos_to_last_merge=0.9995 (last merge round=20)
[S2] round=22 local utility u=0.188163 metrics={'f1_val': 0.6991011273067644, 'auprc': 0.7222960828090503, 'loss_val': 0.7477945307248399, 'psi': 0.7083791095076788}-{'f1_val': 0.6621713140894733, 'auprc': 0.7176676143544285, 'loss_val': 0.8886565980718576, 'psi': 0.6843698341954554}
[S3] START round=22 head_norm_before_train=1.867895 (no previous merge yet)
[S3] round=22 local utility u=0.135469 metrics={'f1_val': 0.9961497684139329, 'auprc': 0.9968767983288871, 'loss_val': 0.048488099762658866, 'psi': 0.9964405803799146}-{'f1_val': 0.9610352511054436, 'auprc': 0.9967665419253584, 'loss_val': 0.10840852588970988, 'psi': 0.9753277674334095}
[S4] START round=22 head_norm_before_train=1.793250 cos_to_last_merge=1.0000 (last merge round=21)
[S4] round=22 local utility u=0.000000 metrics={'f1_val': 0.9505093284738367, 'auprc': 0.8980383589831362, 'loss_val': 0.28277270924859804, 'psi': 0.9295209406775566}-{'f1_val': 0.9562047432042488, 'auprc': 0.947419104715955, 'loss_val': 0.2750652063637982, 'psi': 0.9526904878089313}
[S5] START round=22 head_norm_before_train=1.502307 cos_to_last_merge=1.0000 (last merge round=21)
[S5] round=22 local utility u=0.000000 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9660759210162433, 'loss_val': 0.39726391634857666, 'psi': 0.8067954040041019}-{'f1_val': 0.7003213174339138, 'auprc': 0.9876178164052605, 'loss_val': 0.36874868608676137, 'psi': 0.8152399170224525}
[S6] START round=22 head_norm_before_train=1.533895 cos_to_last_merge=0.9991 (last merge round=20)
[S6] round=22 local utility u=0.661005 metrics={'f1_val': 0.9340771473887353, 'auprc': 0.9677975904567282, 'loss_val': 0.27487526981839205, 'psi': 0.9475653246159325}-{'f1_val': 0.7887334378790258, 'auprc': 0.8969480042632876, 'loss_val': 0.5122741678098819, 'psi': 0.8320192644327306}
[S7] START round=22 head_norm_before_train=1.356964 cos_to_last_merge=0.8435 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.844
[S7] round=22 local utility u=0.845650 metrics={'f1_val': 0.6707404541131685, 'auprc': 0.8217683817155483, 'loss_val': 0.44477719775640207, 'psi': 0.7311516251541205}-{'f1_val': 0.4881069465000514, 'auprc': 0.7811795660042359, 'loss_val': 0.9185089289944277, 'psi': 0.6053359943017251}
[S8] START round=22 head_norm_before_train=1.996559 (no previous merge yet)
[S8] round=22 local utility u=0.018460 metrics={'f1_val': 0.9940931887774087, 'auprc': 0.9986672049338712, 'loss_val': 0.03308652784155185, 'psi': 0.9959227952399937}-{'f1_val': 0.9892968853633592, 'auprc': 0.9985645659009272, 'loss_val': 0.04092113400225334, 'psi': 0.9930039575783864}
[S9] START round=22 head_norm_before_train=0.953381 cos_to_last_merge=1.0000 (last merge round=21)
[S9] round=22 local utility u=0.000000 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9981351556549197, 'loss_val': 0.3477870673986619, 'psi': 0.820028352386506}-{'f1_val': 0.7013646677191758, 'auprc': 0.998659140336924, 'loss_val': 0.28790998514717075, 'psi': 0.8202824567662752}
[S10] START round=22 head_norm_before_train=1.776628 cos_to_last_merge=0.7741 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.774
[S10] round=22 local utility u=0.000000 metrics={'f1_val': 0.9935262985458464, 'auprc': 0.9966137736210727, 'loss_val': 0.036040088176515314, 'psi': 0.9947612885759369}-{'f1_val': 0.9937452946631335, 'auprc': 0.9965200792780144, 'loss_val': 0.03666587592059472, 'psi': 0.9948552085090858}
[S11] START round=22 head_norm_before_train=1.112849 cos_to_last_merge=1.0000 (last merge round=21)
[S11] round=22 local utility u=0.000000 metrics={'f1_val': 0.9576813599694372, 'auprc': 0.9981798124158032, 'loss_val': 0.3514569136182066, 'psi': 0.9738807409479835}-{'f1_val': 0.9569423019309666, 'auprc': 0.998602041475071, 'loss_val': 0.3227094565585667, 'psi': 0.9736061977486083}
[S13] START round=22 head_norm_before_train=1.764994 (no previous merge yet)
[S13] round=22 local utility u=0.000000 metrics={'f1_val': 0.5733378756618844, 'auprc': 0.6917006854010266, 'loss_val': 0.947221592901017, 'psi': 0.6206829995575414}-{'f1_val': 0.5850738550801102, 'auprc': 0.6908126044887647, 'loss_val': 0.8765288241370846, 'psi': 0.6273693548435719}
[S14] START round=22 head_norm_before_train=1.007747 cos_to_last_merge=1.0000 (last merge round=21)
[S14] round=22 local utility u=0.019306 metrics={'f1_val': 0.9881675677448523, 'auprc': 0.9969015701741779, 'loss_val': 0.23711451214626814, 'psi': 0.9916611687165825}-{'f1_val': 0.9976511180498535, 'auprc': 0.9970379729209384, 'loss_val': 0.3330371647979383, 'psi': 0.9974058599982876}
[S15] START round=22 head_norm_before_train=1.547108 cos_to_last_merge=1.0000 (last merge round=21)
[S15] round=22 local utility u=0.665191 metrics={'f1_val': 0.842156860221411, 'auprc': 0.9713719589336849, 'loss_val': 0.24332853733795543, 'psi': 0.8938428997063206}-{'f1_val': 0.6970639330318791, 'auprc': 0.9022328895111529, 'loss_val': 0.4957360254114753, 'psi': 0.7791315156235886}
[S16] START round=22 head_norm_before_train=1.857102 (no previous merge yet)
[S16] round=22 local utility u=0.517026 metrics={'f1_val': 0.9915874035838895, 'auprc': 0.9932009119929387, 'loss_val': 0.0539272457505566, 'psi': 0.9922328069475093}-{'f1_val': 0.8862082846548913, 'auprc': 0.9925947633705738, 'loss_val': 0.45388614745241795, 'psi': 0.9287628761411644}
[S17] START round=22 head_norm_before_train=1.597213 cos_to_last_merge=0.8198 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.820
[S17] round=22 local utility u=0.066857 metrics={'f1_val': 0.713005279266758, 'auprc': 0.9651039620269237, 'loss_val': 0.6737073554648082, 'psi': 0.8138447523708243}-{'f1_val': 0.7014326196716528, 'auprc': 0.9608381595236976, 'loss_val': 0.7251876149664267, 'psi': 0.8051948356124707}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:59815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:59802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:59807
[S6] sending update (kind=head size=1803 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1803) from S6
[S15] cosine check vs S6: cos=0.9343
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:59812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:59814
[S3] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:59807
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] RECEIVED delta(kind=head bytes=1800) from S3
[S2] cosine check vs S3: cos=0.9944
[S6] RECEIVED delta(kind=head bytes=1797) from S7
[S6] cosine check vs S7: cos=-0.0102
[S6] DROPPED delta from S7 (cos=-0.0102 < 0.0)
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1802) from S15
[S14] cosine check vs S15: cos=0.5708
[S11] RECEIVED delta(kind=head bytes=1800) from S14
[S11] cosine check vs S14: cos=0.9549
[S2] sending update (kind=head size=1798 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1798) from S2
[S6] cosine check vs S2: cos=0.8652
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:59807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:59805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:59804
[S8] sending update (kind=head size=1795 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1795) from S8
[S6] cosine check vs S8: cos=0.6320
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] sending update (kind=head size=1798 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1798) from S16
[S4] cosine check vs S16: cos=-0.0077
[S4] DROPPED delta from S16 (cos=-0.0077 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1798) from S17
[S5] cosine check vs S17: cos=0.2572
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=22 metric=0.7006 head_norm=1.520190
[S5] _apply_head_vector_avg (torch): Δ‖w‖=9.556874e-01
[S5] stored merged vector for next round verification (round=22)
[S5] DEBUG after merge:  round=22 metric=0.7006 head_norm=1.242755 delta_norm=0.955687
[S5] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=22 metric=0.9577 head_norm=1.146640
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.707884e-01
[S11] stored merged vector for next round verification (round=22)
[S11] DEBUG after merge:  round=22 metric=0.9577 head_norm=1.094027 delta_norm=0.170788
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=22 metric=0.9341 head_norm=1.572251
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.913089e-01
[S6] stored merged vector for next round verification (round=22)
[S6] DEBUG after merge:  round=22 metric=0.9341 head_norm=1.523158 delta_norm=0.191309
[S6] aggregate: ACCEPT kept=['S2', 'S8'] (k=2/2) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=22 metric=0.6991 head_norm=1.890643
[S2] _apply_head_vector_avg (torch): Δ‖w‖=9.960134e-02
[S2] stored merged vector for next round verification (round=22)
[S2] DEBUG after merge:  round=22 metric=0.7116 head_norm=1.886398 delta_norm=0.099601
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=22 metric=0.8422 head_norm=1.595455
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.873064e-01
[S15] stored merged vector for next round verification (round=22)
[S15] DEBUG after merge:  round=22 metric=0.8912 head_norm=1.557620 delta_norm=0.287306
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=22 metric=0.9882 head_norm=1.066464
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.596510e-01
[S14] stored merged vector for next round verification (round=22)
[S14] DEBUG after merge:  round=22 metric=0.9974 head_norm=1.185863 delta_norm=0.659651
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=1.886398 cos_to_last_merge=1.0000 (last merge round=22)
[S2] round=23 local utility u=0.000000 metrics={'f1_val': 0.6837826589009581, 'auprc': 0.7233378622418684, 'loss_val': 0.7363186437914264, 'psi': 0.6996047402373222}-{'f1_val': 0.6991011273067644, 'auprc': 0.7222960828090503, 'loss_val': 0.7477945307248399, 'psi': 0.7083791095076788}
[S3] START round=23 head_norm_before_train=1.887407 (no previous merge yet)
[S3] round=23 local utility u=0.011563 metrics={'f1_val': 0.9977814963782642, 'auprc': 0.9967891019748284, 'loss_val': 0.0348895937065677, 'psi': 0.9973845386168899}-{'f1_val': 0.9961497684139329, 'auprc': 0.9968767983288871, 'loss_val': 0.048488099762658866, 'psi': 0.9964405803799146}
[S4] START round=23 head_norm_before_train=1.831386 cos_to_last_merge=0.9994 (last merge round=21)
[S4] round=23 local utility u=0.085607 metrics={'f1_val': 0.953293645620588, 'auprc': 0.9454756235742132, 'loss_val': 0.2705770788853387, 'psi': 0.9501664368020382}-{'f1_val': 0.9505093284738367, 'auprc': 0.8980383589831362, 'loss_val': 0.28277270924859804, 'psi': 0.9295209406775566}
[S5] START round=23 head_norm_before_train=1.242755 cos_to_last_merge=1.0000 (last merge round=22)
[S5] round=23 local utility u=0.000000 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.8965033827432549, 'loss_val': 0.4286834295491986, 'psi': 0.7789663886949065}-{'f1_val': 0.7006083926626743, 'auprc': 0.9660759210162433, 'loss_val': 0.39726391634857666, 'psi': 0.8067954040041019}
[S6] START round=23 head_norm_before_train=1.523158 cos_to_last_merge=1.0000 (last merge round=22)
[S6] round=23 local utility u=0.000000 metrics={'f1_val': 0.7277977756768372, 'auprc': 0.7834395509761013, 'loss_val': 0.586785016729893, 'psi': 0.7500544857965429}-{'f1_val': 0.9340771473887353, 'auprc': 0.9677975904567282, 'loss_val': 0.27487526981839205, 'psi': 0.9475653246159325}
[S7] START round=23 head_norm_before_train=1.363576 cos_to_last_merge=0.8425 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.843
[S7] round=23 local utility u=0.000000 metrics={'f1_val': 0.6707640943455488, 'auprc': 0.8205012232876436, 'loss_val': 0.44307798809232884, 'psi': 0.7306589459223868}-{'f1_val': 0.6707404541131685, 'auprc': 0.8217683817155483, 'loss_val': 0.44477719775640207, 'psi': 0.7311516251541205}
[S8] START round=23 head_norm_before_train=2.007661 (no previous merge yet)
[S8] round=23 local utility u=0.000000 metrics={'f1_val': 0.9899428277578977, 'auprc': 0.9993056040217277, 'loss_val': 0.03759304106815691, 'psi': 0.9936879382634296}-{'f1_val': 0.9940931887774087, 'auprc': 0.9986672049338712, 'loss_val': 0.03308652784155185, 'psi': 0.9959227952399937}
[S9] START round=23 head_norm_before_train=0.993851 cos_to_last_merge=0.9979 (last merge round=21)
[S9] round=23 local utility u=0.029218 metrics={'f1_val': 0.7013646677191758, 'auprc': 0.9989955497456634, 'loss_val': 0.2923773911032016, 'psi': 0.820417020529771}-{'f1_val': 0.7012904835408967, 'auprc': 0.9981351556549197, 'loss_val': 0.3477870673986619, 'psi': 0.820028352386506}
[S10] START round=23 head_norm_before_train=1.799551 cos_to_last_merge=0.7718 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.772
[S10] round=23 local utility u=0.000530 metrics={'f1_val': 0.9937452946631335, 'auprc': 0.996063992237135, 'loss_val': 0.034644638071464506, 'psi': 0.9946727736927341}-{'f1_val': 0.9935262985458464, 'auprc': 0.9966137736210727, 'loss_val': 0.036040088176515314, 'psi': 0.9947612885759369}
[S11] START round=23 head_norm_before_train=1.094027 cos_to_last_merge=1.0000 (last merge round=22)
[S11] round=23 local utility u=0.139894 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.994141469546022, 'loss_val': 0.2952520530884137, 'psi': 0.9958351417941551}-{'f1_val': 0.9576813599694372, 'auprc': 0.9981798124158032, 'loss_val': 0.3514569136182066, 'psi': 0.9738807409479835}
[S13] START round=23 head_norm_before_train=1.772024 (no previous merge yet)
[S13] round=23 local utility u=0.143689 metrics={'f1_val': 0.5719173150486246, 'auprc': 0.6806793400075543, 'loss_val': 0.6182553796695038, 'psi': 0.6154221250321965}-{'f1_val': 0.5733378756618844, 'auprc': 0.6917006854010266, 'loss_val': 0.947221592901017, 'psi': 0.6206829995575414}
[S14] START round=23 head_norm_before_train=1.185863 cos_to_last_merge=1.0000 (last merge round=22)
[S14] round=23 local utility u=0.004807 metrics={'f1_val': 0.9974055297193176, 'auprc': 0.9970224149941924, 'loss_val': 0.28329146657530807, 'psi': 0.9972522838292676}-{'f1_val': 0.9881675677448523, 'auprc': 0.9969015701741779, 'loss_val': 0.23711451214626814, 'psi': 0.9916611687165825}
[S15] START round=23 head_norm_before_train=1.557620 cos_to_last_merge=1.0000 (last merge round=22)
[S15] round=23 local utility u=0.521995 metrics={'f1_val': 0.9897733505645397, 'auprc': 0.9811185623146024, 'loss_val': 0.11427746655190087, 'psi': 0.9863114352645648}-{'f1_val': 0.842156860221411, 'auprc': 0.9713719589336849, 'loss_val': 0.24332853733795543, 'psi': 0.8938428997063206}
[S16] START round=23 head_norm_before_train=1.881949 (no previous merge yet)
[S16] round=23 local utility u=0.006674 metrics={'f1_val': 0.9919694958537735, 'auprc': 0.9973863556610923, 'loss_val': 0.05542767464716369, 'psi': 0.994136239776701}-{'f1_val': 0.9915874035838895, 'auprc': 0.9932009119929387, 'loss_val': 0.0539272457505566, 'psi': 0.9922328069475093}
[S17] START round=23 head_norm_before_train=1.613871 cos_to_last_merge=0.8178 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.818
[S17] round=23 local utility u=0.000000 metrics={'f1_val': 0.6958874411254288, 'auprc': 0.974418617674978, 'loss_val': 0.6928307682906145, 'psi': 0.8072999117452484}-{'f1_val': 0.713005279266758, 'auprc': 0.9651039620269237, 'loss_val': 0.6737073554648082, 'psi': 0.8138447523708243}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:59814
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:59804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:59804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:59805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:59802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S13] → sending delta(kind=head bytes=1807) to S9@127.0.0.1:59810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:59810
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S14] → sending delta(kind=head bytes=1790) to S11@127.0.0.1:59812
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S15] → sending delta(kind=head bytes=1807) to S14@127.0.0.1:59814
[S11] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1790 to 1 peers)
[S13] sending update (kind=head size=1807 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1807 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1807) from S15
[S14] cosine check vs S15: cos=0.8780
[S4] RECEIVED delta(kind=head bytes=1799) from S10
[S4] cosine check vs S10: cos=0.9917
[S14] RECEIVED delta(kind=head bytes=1797) from S9
[S14] cosine check vs S9: cos=0.5897
[S9] RECEIVED delta(kind=head bytes=1799) from S11
[S9] cosine check vs S11: cos=0.8495
[S9] RECEIVED delta(kind=head bytes=1807) from S13
[S9] cosine check vs S13: cos=0.6106
[S11] RECEIVED delta(kind=head bytes=1790) from S14
[S11] cosine check vs S14: cos=0.8877
[S5] RECEIVED delta(kind=head bytes=1801) from S4
[S5] cosine check vs S4: cos=0.6226
[S2] RECEIVED delta(kind=head bytes=1802) from S3
[S2] cosine check vs S3: cos=0.9969
[S4] RECEIVED delta(kind=head bytes=1796) from S16
[S4] cosine check vs S16: cos=-0.0062
[S4] DROPPED delta from S16 (cos=-0.0062 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=23 metric=0.7006 head_norm=1.268950
[S5] _apply_head_vector_avg (torch): Δ‖w‖=7.337562e-01
[S5] stored merged vector for next round verification (round=23)
[S5] DEBUG after merge:  round=23 metric=0.7006 head_norm=1.419941 delta_norm=0.733756
[S5] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=23 metric=0.6838 head_norm=1.913884
[S2] _apply_head_vector_avg (torch): Δ‖w‖=7.510435e-02
[S2] stored merged vector for next round verification (round=23)
[S2] DEBUG after merge:  round=23 metric=0.6855 head_norm=1.908357 delta_norm=0.075104
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=23 metric=0.9533 head_norm=1.870569
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.216572e-01
[S4] stored merged vector for next round verification (round=23)
[S4] DEBUG after merge:  round=23 metric=0.9533 head_norm=1.841717 delta_norm=0.121657
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=23 metric=0.9970 head_norm=1.139815
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.849629e-01
[S11] stored merged vector for next round verification (round=23)
[S11] DEBUG after merge:  round=23 metric=0.9970 head_norm=1.153172 delta_norm=0.284963
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=23 metric=0.9974 head_norm=1.234035
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.598035e-01
[S14] stored merged vector for next round verification (round=23)
[S14] DEBUG after merge:  round=23 metric=0.9974 head_norm=1.132548 delta_norm=0.159803
[S14] aggregate: ACCEPT kept=['S15', 'S9'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=23 metric=0.7014 head_norm=1.037037
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.633106e-01
[S9] stored merged vector for next round verification (round=23)
[S9] DEBUG after merge:  round=23 metric=0.7014 head_norm=1.093978 delta_norm=0.363311
[S9] aggregate: ACCEPT kept=['S11', 'S13'] (k=2/2) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=1.908357 cos_to_last_merge=1.0000 (last merge round=23)
[S2] round=24 local utility u=0.081124 metrics={'f1_val': 0.7116590064661766, 'auprc': 0.7201893213569511, 'loss_val': 0.731883793010974, 'psi': 0.7150711324224864}-{'f1_val': 0.6837826589009581, 'auprc': 0.7233378622418684, 'loss_val': 0.7363186437914264, 'psi': 0.6996047402373222}
[S3] START round=24 head_norm_before_train=1.905777 (no previous merge yet)
[S3] round=24 local utility u=0.000000 metrics={'f1_val': 0.932811158571069, 'auprc': 0.9457017451299362, 'loss_val': 0.16773812199204227, 'psi': 0.9379673931946159}-{'f1_val': 0.9977814963782642, 'auprc': 0.9967891019748284, 'loss_val': 0.0348895937065677, 'psi': 0.9973845386168899}
[S4] START round=24 head_norm_before_train=1.841717 cos_to_last_merge=1.0000 (last merge round=23)
[S4] round=24 local utility u=0.000000 metrics={'f1_val': 0.9524202021178183, 'auprc': 0.9045427662924354, 'loss_val': 0.27332882133974995, 'psi': 0.9332692277876652}-{'f1_val': 0.953293645620588, 'auprc': 0.9454756235742132, 'loss_val': 0.2705770788853387, 'psi': 0.9501664368020382}
[S5] START round=24 head_norm_before_train=1.419941 cos_to_last_merge=1.0000 (last merge round=23)
[S5] round=24 local utility u=0.215037 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9919780567393268, 'loss_val': 0.2833059387614314, 'psi': 0.8169835817905462}-{'f1_val': 0.7006083926626743, 'auprc': 0.8965033827432549, 'loss_val': 0.4286834295491986, 'psi': 0.7789663886949065}
[S6] START round=24 head_norm_before_train=1.558123 cos_to_last_merge=0.9995 (last merge round=22)
[S6] round=24 local utility u=0.842852 metrics={'f1_val': 0.8866706733183607, 'auprc': 0.9411124456646853, 'loss_val': 0.3273369654441684, 'psi': 0.9084473822568906}-{'f1_val': 0.7277977756768372, 'auprc': 0.7834395509761013, 'loss_val': 0.586785016729893, 'psi': 0.7500544857965429}
[S7] START round=24 head_norm_before_train=1.370182 cos_to_last_merge=0.8415 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.842
[S7] round=24 local utility u=0.000000 metrics={'f1_val': 0.6657152748687143, 'auprc': 0.8112185865485763, 'loss_val': 0.4610013267775286, 'psi': 0.7239165995406591}-{'f1_val': 0.6707640943455488, 'auprc': 0.8205012232876436, 'loss_val': 0.44307798809232884, 'psi': 0.7306589459223868}
[S8] START round=24 head_norm_before_train=2.019301 (no previous merge yet)
[S8] round=24 local utility u=0.001206 metrics={'f1_val': 0.9903023602799178, 'auprc': 0.9990145587989194, 'loss_val': 0.0364641774041493, 'psi': 0.9937872396875185}-{'f1_val': 0.9899428277578977, 'auprc': 0.9993056040217277, 'loss_val': 0.03759304106815691, 'psi': 0.9936879382634296}
[S9] START round=24 head_norm_before_train=1.093978 cos_to_last_merge=1.0000 (last merge round=23)
[S9] round=24 local utility u=0.024639 metrics={'f1_val': 0.7013646677191758, 'auprc': 0.9988172920531189, 'loss_val': 0.24256485705557906, 'psi': 0.8203457174527531}-{'f1_val': 0.7013646677191758, 'auprc': 0.9989955497456634, 'loss_val': 0.2923773911032016, 'psi': 0.820417020529771}
[S10] START round=24 head_norm_before_train=1.820554 cos_to_last_merge=0.7697 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.770
[S10] round=24 local utility u=0.000000 metrics={'f1_val': 0.9948838907637279, 'auprc': 0.9927019331541148, 'loss_val': 0.03358452284089498, 'psi': 0.9940111077198827}-{'f1_val': 0.9937452946631335, 'auprc': 0.996063992237135, 'loss_val': 0.034644638071464506, 'psi': 0.9946727736927341}
[S11] START round=24 head_norm_before_train=1.153172 cos_to_last_merge=1.0000 (last merge round=23)
[S11] round=24 local utility u=0.000000 metrics={'f1_val': 0.9579861920683642, 'auprc': 0.9993890712554662, 'loss_val': 0.319771008064855, 'psi': 0.974547343743205}-{'f1_val': 0.9969642566262439, 'auprc': 0.994141469546022, 'loss_val': 0.2952520530884137, 'psi': 0.9958351417941551}
[S13] START round=24 head_norm_before_train=1.777280 (no previous merge yet)
[S13] round=24 local utility u=0.000000 metrics={'f1_val': 0.5844800945489032, 'auprc': 0.6845074990817908, 'loss_val': 0.996975587743959, 'psi': 0.6244910563620583}-{'f1_val': 0.5719173150486246, 'auprc': 0.6806793400075543, 'loss_val': 0.6182553796695038, 'psi': 0.6154221250321965}
[S14] START round=24 head_norm_before_train=1.132548 cos_to_last_merge=1.0000 (last merge round=23)
[S14] round=24 local utility u=0.002631 metrics={'f1_val': 0.9919775121572035, 'auprc': 0.9969635898442033, 'loss_val': 0.24528470978670325, 'psi': 0.9939719432320034}-{'f1_val': 0.9974055297193176, 'auprc': 0.9970224149941924, 'loss_val': 0.28329146657530807, 'psi': 0.9972522838292676}
[S15] START round=24 head_norm_before_train=1.623991 cos_to_last_merge=0.9975 (last merge round=22)
[S15] round=24 local utility u=0.000000 metrics={'f1_val': 0.7597472127264713, 'auprc': 0.970660582842664, 'loss_val': 0.402201590931695, 'psi': 0.8441125607729483}-{'f1_val': 0.9897733505645397, 'auprc': 0.9811185623146024, 'loss_val': 0.11427746655190087, 'psi': 0.9863114352645648}
[S16] START round=24 head_norm_before_train=1.902200 (no previous merge yet)
[S16] round=24 local utility u=0.000000 metrics={'f1_val': 0.9375658730573637, 'auprc': 0.9961058910720334, 'loss_val': 0.2626232257513729, 'psi': 0.9609818802632315}-{'f1_val': 0.9919694958537735, 'auprc': 0.9973863556610923, 'loss_val': 0.05542767464716369, 'psi': 0.994136239776701}
[S17] START round=24 head_norm_before_train=1.635117 cos_to_last_merge=0.8164 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.816
[S17] round=24 local utility u=0.000000 metrics={'f1_val': 0.7045268481103291, 'auprc': 0.9577246317393457, 'loss_val': 0.7966143245115976, 'psi': 0.8058059615619357}-{'f1_val': 0.6958874411254288, 'auprc': 0.974418617674978, 'loss_val': 0.6928307682906145, 'psi': 0.8072999117452484}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] → sending delta(kind=head bytes=1792) to S14@127.0.0.1:59814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:59810
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:59807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:59812
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:59807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:59815
[S14] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S9] sending update (kind=head size=1792 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1799) from S2
[S6] cosine check vs S2: cos=0.7933
[S15] RECEIVED delta(kind=head bytes=1803) from S6
[S15] cosine check vs S6: cos=0.9777
[S14] RECEIVED delta(kind=head bytes=1792) from S9
[S14] cosine check vs S9: cos=0.6367
[S6] RECEIVED delta(kind=head bytes=1799) from S8
[S6] cosine check vs S8: cos=0.7198
[S9] RECEIVED delta(kind=head bytes=1795) from S5
[S9] cosine check vs S5: cos=0.4133
[S11] RECEIVED delta(kind=head bytes=1801) from S14
[S11] cosine check vs S14: cos=0.9694
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=24 metric=0.7597 head_norm=1.683873
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.785808e-01
[S15] stored merged vector for next round verification (round=24)
[S15] DEBUG after merge:  round=24 metric=0.7655 head_norm=1.629721 delta_norm=0.178581
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=24 metric=0.9580 head_norm=1.193537
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.472629e-01
[S11] stored merged vector for next round verification (round=24)
[S11] DEBUG after merge:  round=24 metric=0.9580 head_norm=1.181443 delta_norm=0.147263
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=24 metric=0.8867 head_norm=1.593844
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.286454e-01
[S6] stored merged vector for next round verification (round=24)
[S6] DEBUG after merge:  round=24 metric=0.8916 head_norm=1.550585 delta_norm=0.128645
[S6] aggregate: ACCEPT kept=['S2', 'S8'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=24 metric=0.7014 head_norm=1.132622
[S9] _apply_head_vector_avg (torch): Δ‖w‖=7.113119e-01
[S9] stored merged vector for next round verification (round=24)
[S9] DEBUG after merge:  round=24 metric=0.7013 head_norm=1.088010 delta_norm=0.711312
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=24 metric=0.9920 head_norm=1.187627
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.950929e-01
[S14] stored merged vector for next round verification (round=24)
[S14] DEBUG after merge:  round=24 metric=0.9634 head_norm=1.049537 delta_norm=0.495093
[S14] aggregate: ROLLBACK (f1_val pre=0.992 post=0.963 tol_abs=0.005 tol_rel=0.0)
[S2] START round=25 head_norm_before_train=1.933328 cos_to_last_merge=0.9997 (last merge round=23)
[S2] round=25 local utility u=0.000000 metrics={'f1_val': 0.6881595709899355, 'auprc': 0.7189225053412112, 'loss_val': 0.9266613605927229, 'psi': 0.7004647447304457}-{'f1_val': 0.7116590064661766, 'auprc': 0.7201893213569511, 'loss_val': 0.731883793010974, 'psi': 0.7150711324224864}
[S3] START round=25 head_norm_before_train=1.921486 (no previous merge yet)
[S3] round=25 local utility u=0.337591 metrics={'f1_val': 0.9973982357793907, 'auprc': 0.9968796326228416, 'loss_val': 0.03361246320736156, 'psi': 0.9971907945167711}-{'f1_val': 0.932811158571069, 'auprc': 0.9457017451299362, 'loss_val': 0.16773812199204227, 'psi': 0.9379673931946159}
[S4] START round=25 head_norm_before_train=1.875259 cos_to_last_merge=0.9996 (last merge round=23)
[S4] round=25 local utility u=0.072002 metrics={'f1_val': 0.9531937593519124, 'auprc': 0.9505676664436977, 'loss_val': 0.27204073395313466, 'psi': 0.9521433221886266}-{'f1_val': 0.9524202021178183, 'auprc': 0.9045427662924354, 'loss_val': 0.27332882133974995, 'psi': 0.9332692277876652}
[S5] START round=25 head_norm_before_train=1.447974 cos_to_last_merge=0.9995 (last merge round=23)
[S5] round=25 local utility u=0.000000 metrics={'f1_val': 0.6451880180855509, 'auprc': 0.9550475285835267, 'loss_val': 0.35476252897438326, 'psi': 0.7691318222847412}-{'f1_val': 0.700320598491359, 'auprc': 0.9919780567393268, 'loss_val': 0.2833059387614314, 'psi': 0.8169835817905462}
[S6] START round=25 head_norm_before_train=1.550585 cos_to_last_merge=1.0000 (last merge round=24)
[S6] round=25 local utility u=0.336669 metrics={'f1_val': 0.9594984414729469, 'auprc': 0.977672197652269, 'loss_val': 0.20064566069794804, 'psi': 0.9667679439446757}-{'f1_val': 0.8866706733183607, 'auprc': 0.9411124456646853, 'loss_val': 0.3273369654441684, 'psi': 0.9084473822568906}
[S7] START round=25 head_norm_before_train=1.379954 cos_to_last_merge=0.8401 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.840
[S7] round=25 local utility u=0.000000 metrics={'f1_val': 0.5928930021162119, 'auprc': 0.7919826336075818, 'loss_val': 0.6935601754115039, 'psi': 0.6725288547127599}-{'f1_val': 0.6657152748687143, 'auprc': 0.8112185865485763, 'loss_val': 0.4610013267775286, 'psi': 0.7239165995406591}
[S8] START round=25 head_norm_before_train=2.031928 (no previous merge yet)
[S8] round=25 local utility u=0.016230 metrics={'f1_val': 0.9941000136901317, 'auprc': 0.9993515870305918, 'loss_val': 0.0278020362707123, 'psi': 0.9962006430263157}-{'f1_val': 0.9903023602799178, 'auprc': 0.9990145587989194, 'loss_val': 0.0364641774041493, 'psi': 0.9937872396875185}
[S9] START round=25 head_norm_before_train=1.088010 cos_to_last_merge=1.0000 (last merge round=24)
[S9] round=25 local utility u=0.841243 metrics={'f1_val': 0.9958513816384016, 'auprc': 0.9971038389426226, 'loss_val': 0.32185945139607247, 'psi': 0.99635236456009}-{'f1_val': 0.7013646677191758, 'auprc': 0.9988172920531189, 'loss_val': 0.24256485705557906, 'psi': 0.8203457174527531}
[S10] START round=25 head_norm_before_train=1.835531 cos_to_last_merge=0.7685 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.768
[S10] round=25 local utility u=0.000331 metrics={'f1_val': 0.9942256070413027, 'auprc': 0.9938351983854465, 'loss_val': 0.03237214429268838, 'psi': 0.9940694435789602}-{'f1_val': 0.9948838907637279, 'auprc': 0.9927019331541148, 'loss_val': 0.03358452284089498, 'psi': 0.9940111077198827}
[S11] START round=25 head_norm_before_train=1.181443 cos_to_last_merge=1.0000 (last merge round=24)
[S11] round=25 local utility u=0.117731 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9933585779089633, 'loss_val': 0.2986350663265463, 'psi': 0.9953768829124945}-{'f1_val': 0.9579861920683642, 'auprc': 0.9993890712554662, 'loss_val': 0.319771008064855, 'psi': 0.974547343743205}
[S13] START round=25 head_norm_before_train=1.785159 (no previous merge yet)
[S13] round=25 local utility u=0.034889 metrics={'f1_val': 0.5667745723546933, 'auprc': 0.6992219028395664, 'loss_val': 0.8651084209384682, 'psi': 0.6197535045486425}-{'f1_val': 0.5844800945489032, 'auprc': 0.6845074990817908, 'loss_val': 0.996975587743959, 'psi': 0.6244910563620583}
[S14] START round=25 head_norm_before_train=1.049537 cos_to_last_merge=1.0000 (last merge round=24)
[S14] round=25 local utility u=0.005461 metrics={'f1_val': 0.982394224864788, 'auprc': 0.9988249389538687, 'loss_val': 0.1824469038133605, 'psi': 0.9889665105004204}-{'f1_val': 0.9919775121572035, 'auprc': 0.9969635898442033, 'loss_val': 0.24528470978670325, 'psi': 0.9939719432320034}
[S15] START round=25 head_norm_before_train=1.629721 cos_to_last_merge=1.0000 (last merge round=24)
[S15] round=25 local utility u=0.814940 metrics={'f1_val': 0.9780528016166121, 'auprc': 0.9833894535666194, 'loss_val': 0.1203410413103785, 'psi': 0.9801874623966151}-{'f1_val': 0.7597472127264713, 'auprc': 0.970660582842664, 'loss_val': 0.402201590931695, 'psi': 0.8441125607729483}
[S16] START round=25 head_norm_before_train=1.920153 (no previous merge yet)
[S16] round=25 local utility u=0.264975 metrics={'f1_val': 0.9915874035838895, 'auprc': 0.9928334458931973, 'loss_val': 0.046984156238721056, 'psi': 0.9920858205076126}-{'f1_val': 0.9375658730573637, 'auprc': 0.9961058910720334, 'loss_val': 0.2626232257513729, 'psi': 0.9609818802632315}
[S17] START round=25 head_norm_before_train=1.654610 cos_to_last_merge=0.8156 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.816
[S17] round=25 local utility u=0.000000 metrics={'f1_val': 0.6899576488171862, 'auprc': 0.8712908419028864, 'loss_val': 0.8609550552177758, 'psi': 0.7624909260514663}-{'f1_val': 0.7045268481103291, 'auprc': 0.9577246317393457, 'loss_val': 0.7966143245115976, 'psi': 0.8058059615619357}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:59804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:59807
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:59814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:59804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:59815
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:59812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] → sending delta(kind=head bytes=1805) to S5@127.0.0.1:59805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:59807
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:59810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S15] → sending delta(kind=head bytes=1807) to S14@127.0.0.1:59814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] → sending delta(kind=head bytes=1793) to S9@127.0.0.1:59810
[S6] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1807 to 1 peers)
[S13] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1793 to 1 peers)
[S3] sending update (kind=head size=1804 to 1 peers)
[S4] sending update (kind=head size=1805 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1804) from S3
[S6] cosine check vs S3: cos=0.7579
[S6] RECEIVED delta(kind=head bytes=1800) from S8
[S6] cosine check vs S8: cos=0.7538
[S15] RECEIVED delta(kind=head bytes=1800) from S6
[S15] cosine check vs S6: cos=0.9884
[S14] RECEIVED delta(kind=head bytes=1807) from S15
[S14] cosine check vs S15: cos=0.5702
[S4] RECEIVED delta(kind=head bytes=1796) from S16
[S4] cosine check vs S16: cos=-0.0075
[S4] DROPPED delta from S16 (cos=-0.0075 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1805) from S4
[S5] cosine check vs S4: cos=0.9297
[S4] RECEIVED delta(kind=head bytes=1801) from S10
[S4] cosine check vs S10: cos=0.9928
[S14] RECEIVED delta(kind=head bytes=1798) from S9
[S14] cosine check vs S9: cos=0.7432
[S9] RECEIVED delta(kind=head bytes=1793) from S11
[S9] cosine check vs S11: cos=0.5838
[S9] RECEIVED delta(kind=head bytes=1803) from S13
[S9] cosine check vs S13: cos=0.4738
[S11] RECEIVED delta(kind=head bytes=1797) from S14
[S11] cosine check vs S14: cos=0.9391
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] ⇄ pheromone p=0.058 → S6@127.0.0.1:59807
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=25 metric=0.6452 head_norm=1.474315
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.818700e-01
[S5] stored merged vector for next round verification (round=25)
[S5] DEBUG after merge:  round=25 metric=0.6619 head_norm=1.661407 delta_norm=0.381870
[S5] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.192 → S9@127.0.0.1:59810
[S7] ⇄ pheromone p=0.164 → S6@127.0.0.1:59807
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=25 metric=0.9532 head_norm=1.907510
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.160859e-01
[S4] stored merged vector for next round verification (round=25)
[S4] DEBUG after merge:  round=25 metric=0.9531 head_norm=1.876423 delta_norm=0.116086
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.070 → S5@127.0.0.1:59805
[S3] ⇄ pheromone p=0.129 → S6@127.0.0.1:59807
[S10] ⇄ pheromone p=0.020 → S4@127.0.0.1:59804
[S16] ⇄ pheromone p=0.169 → S4@127.0.0.1:59804
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=25 metric=0.9595 head_norm=1.587366
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.030995e-01
[S6] stored merged vector for next round verification (round=25)
[S6] DEBUG after merge:  round=25 metric=0.9595 head_norm=1.546973 delta_norm=0.103099
[S6] aggregate: ACCEPT kept=['S3', 'S8'] (k=2/2) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.341 → S15@127.0.0.1:59815
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=25 metric=0.9824 head_norm=1.113393
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.071951e-01
[S14] stored merged vector for next round verification (round=25)
[S14] DEBUG after merge:  round=25 metric=0.9964 head_norm=1.044415 delta_norm=0.307195
[S14] aggregate: ACCEPT kept=['S15', 'S9'] (k=2/2) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.057 → S11@127.0.0.1:59812
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=25 metric=0.9781 head_norm=1.680299
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.328040e-01
[S15] stored merged vector for next round verification (round=25)
[S15] DEBUG after merge:  round=25 metric=0.9856 head_norm=1.629089 delta_norm=0.132804
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.392 → S14@127.0.0.1:59814
[S13] ⇄ pheromone p=0.066 → S9@127.0.0.1:59810
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=25 metric=0.9959 head_norm=1.119139
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.046469e-01
[S9] stored merged vector for next round verification (round=25)
[S9] DEBUG after merge:  round=25 metric=0.7013 head_norm=1.061759 delta_norm=0.504647
[S9] aggregate: ROLLBACK (f1_val pre=0.996 post=0.701 tol_abs=0.005 tol_rel=0.0)
[S9] ⇄ pheromone p=0.196 → S5@127.0.0.1:59805
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=25 metric=0.9967 head_norm=1.225161
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.113965e-01
[S11] stored merged vector for next round verification (round=25)
[S11] DEBUG after merge:  round=25 metric=0.9967 head_norm=1.151366 delta_norm=0.211397
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.141 → S14@127.0.0.1:59814
[S17] ⇄ pheromone p=0.051 → S5@127.0.0.1:59805
[S2] START round=26 head_norm_before_train=1.957954 cos_to_last_merge=0.9988 (last merge round=23)
[S2] round=26 local utility u=0.150414 metrics={'f1_val': 0.7126887492361252, 'auprc': 0.7225011630284258, 'loss_val': 0.7837452845961074, 'psi': 0.7166137147530455}-{'f1_val': 0.6881595709899355, 'auprc': 0.7189225053412112, 'loss_val': 0.9266613605927229, 'psi': 0.7004647447304457}
[S3] START round=26 head_norm_before_train=1.931556 (no previous merge yet)
[S3] round=26 local utility u=0.000709 metrics={'f1_val': 0.9973982357793907, 'auprc': 0.9967614005273286, 'loss_val': 0.03184025348401834, 'psi': 0.9971435016785659}-{'f1_val': 0.9973982357793907, 'auprc': 0.9968796326228416, 'loss_val': 0.03361246320736156, 'psi': 0.9971907945167711}
[S4] START round=26 head_norm_before_train=1.876423 cos_to_last_merge=1.0000 (last merge round=25)
[S4] round=26 local utility u=0.009497 metrics={'f1_val': 0.9549129805862048, 'auprc': 0.9516061740495876, 'loss_val': 0.2664775900686251, 'psi': 0.9535902579715579}-{'f1_val': 0.9531937593519124, 'auprc': 0.9505676664436977, 'loss_val': 0.27204073395313466, 'psi': 0.9521433221886266}
[S5] START round=26 head_norm_before_train=1.661407 cos_to_last_merge=1.0000 (last merge round=25)
[S5] round=26 local utility u=0.000000 metrics={'f1_val': 0.5845054937717399, 'auprc': 0.8572935570478, 'loss_val': 0.5249175600569485, 'psi': 0.6936207190821639}-{'f1_val': 0.6451880180855509, 'auprc': 0.9550475285835267, 'loss_val': 0.35476252897438326, 'psi': 0.7691318222847412}
[S6] START round=26 head_norm_before_train=1.546973 cos_to_last_merge=1.0000 (last merge round=25)
[S6] round=26 local utility u=0.000000 metrics={'f1_val': 0.7340767512492975, 'auprc': 0.8114904984095999, 'loss_val': 0.5490836963903778, 'psi': 0.7650422501134184}-{'f1_val': 0.9594984414729469, 'auprc': 0.977672197652269, 'loss_val': 0.20064566069794804, 'psi': 0.9667679439446757}
[S7] START round=26 head_norm_before_train=1.391497 cos_to_last_merge=0.8386 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.839
[S7] round=26 local utility u=0.295364 metrics={'f1_val': 0.6557062400482621, 'auprc': 0.8047486883603467, 'loss_val': 0.5180093606902476, 'psi': 0.715323219373096}-{'f1_val': 0.5928930021162119, 'auprc': 0.7919826336075818, 'loss_val': 0.6935601754115039, 'psi': 0.6725288547127599}
[S8] START round=26 head_norm_before_train=2.040312 (no previous merge yet)
[S8] round=26 local utility u=0.000000 metrics={'f1_val': 0.9836444136069047, 'auprc': 0.9971527451381321, 'loss_val': 0.05117439615165518, 'psi': 0.9890477462193956}-{'f1_val': 0.9941000136901317, 'auprc': 0.9993515870305918, 'loss_val': 0.0278020362707123, 'psi': 0.9962006430263157}
[S9] START round=26 head_norm_before_train=1.061759 cos_to_last_merge=1.0000 (last merge round=25)
[S9] round=26 local utility u=0.000000 metrics={'f1_val': 0.7013646677191758, 'auprc': 0.9980281074593854, 'loss_val': 0.23251646466900486, 'psi': 0.8200300436152597}-{'f1_val': 0.9958513816384016, 'auprc': 0.9971038389426226, 'loss_val': 0.32185945139607247, 'psi': 0.99635236456009}
[S10] START round=26 head_norm_before_train=1.852104 cos_to_last_merge=0.7669 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.767
[S10] round=26 local utility u=0.001268 metrics={'f1_val': 0.9937209795911728, 'auprc': 0.9962198930781424, 'loss_val': 0.03396212147218582, 'psi': 0.9947205449859606}-{'f1_val': 0.9942256070413027, 'auprc': 0.9938351983854465, 'loss_val': 0.03237214429268838, 'psi': 0.9940694435789602}
[S11] START round=26 head_norm_before_train=1.151366 cos_to_last_merge=1.0000 (last merge round=25)
[S11] round=26 local utility u=0.000000 metrics={'f1_val': 0.9579861920683642, 'auprc': 0.9993851180127405, 'loss_val': 0.2460244845523625, 'psi': 0.9745457624461147}-{'f1_val': 0.9967224195815153, 'auprc': 0.9933585779089633, 'loss_val': 0.2986350663265463, 'psi': 0.9953768829124945}
[S13] START round=26 head_norm_before_train=1.781860 (no previous merge yet)
[S13] round=26 local utility u=0.206347 metrics={'f1_val': 0.5993404241230552, 'auprc': 0.6906906438741909, 'loss_val': 0.6222153497327311, 'psi': 0.6358805120235095}-{'f1_val': 0.5667745723546933, 'auprc': 0.6992219028395664, 'loss_val': 0.8651084209384682, 'psi': 0.6197535045486425}
[S14] START round=26 head_norm_before_train=1.044415 cos_to_last_merge=1.0000 (last merge round=25)
[S14] round=26 local utility u=0.026590 metrics={'f1_val': 0.9953280742010686, 'auprc': 0.99706891720609, 'loss_val': 0.2016024603908248, 'psi': 0.9960244114030772}-{'f1_val': 0.982394224864788, 'auprc': 0.9988249389538687, 'loss_val': 0.1824469038133605, 'psi': 0.9889665105004204}
[S15] START round=26 head_norm_before_train=1.629089 cos_to_last_merge=1.0000 (last merge round=25)
[S15] round=26 local utility u=0.000000 metrics={'f1_val': 0.6969976326418428, 'auprc': 0.9663942270918926, 'loss_val': 0.4409662392775868, 'psi': 0.8047562704218627}-{'f1_val': 0.9780528016166121, 'auprc': 0.9833894535666194, 'loss_val': 0.1203410413103785, 'psi': 0.9801874623966151}
[S16] START round=26 head_norm_before_train=1.937212 (no previous merge yet)
[S16] round=26 local utility u=0.007117 metrics={'f1_val': 0.9924497697178112, 'auprc': 0.9947434117331343, 'loss_val': 0.04365512977024348, 'psi': 0.9933672265239405}-{'f1_val': 0.9915874035838895, 'auprc': 0.9928334458931973, 'loss_val': 0.046984156238721056, 'psi': 0.9920858205076126}
[S17] START round=26 head_norm_before_train=1.668871 cos_to_last_merge=0.8146 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.815
[S17] round=26 local utility u=0.237246 metrics={'f1_val': 0.7108274221878553, 'auprc': 0.9660480109604624, 'loss_val': 0.7959533637096012, 'psi': 0.8129156576968981}-{'f1_val': 0.6899576488171862, 'auprc': 0.8712908419028864, 'loss_val': 0.8609550552177758, 'psi': 0.7624909260514663}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S10] sending update (kind=head size=1807 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S14] → sending delta(kind=head bytes=1792) to S15@127.0.0.1:59815
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:59816
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:59803
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] sending update (kind=head size=1803 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1792 to 1 peers)
[S4] sending update (kind=head size=1804 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1804) from S4
[S16] cosine check vs S4: cos=-0.0105
[S16] DROPPED delta from S4 (cos=-0.0105 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1792) from S14
[S15] cosine check vs S14: cos=0.7146
[S3] RECEIVED delta(kind=head bytes=1799) from S2
[S3] cosine check vs S2: cos=0.9947
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=26 metric=0.9974 head_norm=1.941643
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.020313e-01
[S3] stored merged vector for next round verification (round=26)
[S3] DEBUG after merge:  round=26 metric=0.9974 head_norm=1.955704 delta_norm=0.102031
[S3] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=26 metric=0.6970 head_norm=1.677914
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.888079e-01
[S15] stored merged vector for next round verification (round=26)
[S15] DEBUG after merge:  round=26 metric=0.6966 head_norm=1.292271 delta_norm=0.588808
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=27 head_norm_before_train=1.974942 cos_to_last_merge=0.9981 (last merge round=23)
[S2] round=27 local utility u=0.000000 metrics={'f1_val': 0.6974443188885774, 'auprc': 0.7263428092308162, 'loss_val': 0.7733858263514909, 'psi': 0.7090037150254729}-{'f1_val': 0.7126887492361252, 'auprc': 0.7225011630284258, 'loss_val': 0.7837452845961074, 'psi': 0.7166137147530455}
[S3] START round=27 head_norm_before_train=1.955704 cos_to_last_merge=1.0000 (last merge round=26)
[S3] round=27 local utility u=0.000000 metrics={'f1_val': 0.961498813606586, 'auprc': 0.9970333377934789, 'loss_val': 0.09847519204125178, 'psi': 0.9757126232813431}-{'f1_val': 0.9973982357793907, 'auprc': 0.9967614005273286, 'loss_val': 0.03184025348401834, 'psi': 0.9971435016785659}
[S4] START round=27 head_norm_before_train=1.912404 cos_to_last_merge=0.9996 (last merge round=25)
[S4] round=27 local utility u=0.000000 metrics={'f1_val': 0.950382967312327, 'auprc': 0.9294271092906239, 'loss_val': 0.27880047904817384, 'psi': 0.9420006241036457}-{'f1_val': 0.9549129805862048, 'auprc': 0.9516061740495876, 'loss_val': 0.2664775900686251, 'psi': 0.9535902579715579}
[S5] START round=27 head_norm_before_train=1.682786 cos_to_last_merge=0.9998 (last merge round=25)
[S5] round=27 local utility u=0.000000 metrics={'f1_val': 0.5560103386942381, 'auprc': 0.8551390019692231, 'loss_val': 0.6356013492578655, 'psi': 0.6756618040042321}-{'f1_val': 0.5845054937717399, 'auprc': 0.8572935570478, 'loss_val': 0.5249175600569485, 'psi': 0.6936207190821639}
[S6] START round=27 head_norm_before_train=1.584244 cos_to_last_merge=0.9996 (last merge round=25)
[S6] round=27 local utility u=0.000000 metrics={'f1_val': 0.5882506620013428, 'auprc': 0.7410832480556497, 'loss_val': 0.7929265454046321, 'psi': 0.6493836964230656}-{'f1_val': 0.7340767512492975, 'auprc': 0.8114904984095999, 'loss_val': 0.5490836963903778, 'psi': 0.7650422501134184}
[S7] START round=27 head_norm_before_train=1.400320 cos_to_last_merge=0.8374 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.837
[S7] round=27 local utility u=0.000000 metrics={'f1_val': 0.6507292615206617, 'auprc': 0.8036984559170861, 'loss_val': 0.5348096349089216, 'psi': 0.7119169392792315}-{'f1_val': 0.6557062400482621, 'auprc': 0.8047486883603467, 'loss_val': 0.5180093606902476, 'psi': 0.715323219373096}
[S8] START round=27 head_norm_before_train=2.051192 (no previous merge yet)
[S8] round=27 local utility u=0.000000 metrics={'f1_val': 0.9816765154405315, 'auprc': 0.9992829147587519, 'loss_val': 0.054105219365204675, 'psi': 0.9887190751678196}-{'f1_val': 0.9836444136069047, 'auprc': 0.9971527451381321, 'loss_val': 0.05117439615165518, 'psi': 0.9890477462193956}
[S9] START round=27 head_norm_before_train=1.104964 cos_to_last_merge=0.9983 (last merge round=25)
[S9] round=27 local utility u=0.907823 metrics={'f1_val': 0.9971000495392299, 'auprc': 0.9972047253453911, 'loss_val': 0.1888130402952332, 'psi': 0.9971419198616944}-{'f1_val': 0.7013646677191758, 'auprc': 0.9980281074593854, 'loss_val': 0.23251646466900486, 'psi': 0.8200300436152597}
[S10] START round=27 head_norm_before_train=1.865899 cos_to_last_merge=0.7657 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.766
[S10] round=27 local utility u=0.001224 metrics={'f1_val': 0.9940063275949004, 'auprc': 0.9957922236319345, 'loss_val': 0.03194297132894879, 'psi': 0.994720686009714}-{'f1_val': 0.9937209795911728, 'auprc': 0.9962198930781424, 'loss_val': 0.03396212147218582, 'psi': 0.9947205449859606}
[S11] START round=27 head_norm_before_train=1.197701 cos_to_last_merge=0.9984 (last merge round=25)
[S11] round=27 local utility u=0.148458 metrics={'f1_val': 0.9975731865293843, 'auprc': 0.9991864262838946, 'loss_val': 0.1860342946155355, 'psi': 0.9982184824311884}-{'f1_val': 0.9579861920683642, 'auprc': 0.9993851180127405, 'loss_val': 0.2460244845523625, 'psi': 0.9745457624461147}
[S13] START round=27 head_norm_before_train=1.788232 (no previous merge yet)
[S13] round=27 local utility u=0.000000 metrics={'f1_val': 0.5900383938914449, 'auprc': 0.7154003264457439, 'loss_val': 0.8927754393142101, 'psi': 0.6401831669131646}-{'f1_val': 0.5993404241230552, 'auprc': 0.6906906438741909, 'loss_val': 0.6222153497327311, 'psi': 0.6358805120235095}
[S14] START round=27 head_norm_before_train=1.103594 cos_to_last_merge=0.9981 (last merge round=25)
[S14] round=27 local utility u=0.000000 metrics={'f1_val': 0.9853867313365302, 'auprc': 0.9971287491328907, 'loss_val': 0.15780996464325, 'psi': 0.9900835384550744}-{'f1_val': 0.9953280742010686, 'auprc': 0.99706891720609, 'loss_val': 0.2016024603908248, 'psi': 0.9960244114030772}
[S15] START round=27 head_norm_before_train=1.292271 cos_to_last_merge=1.0000 (last merge round=26)
[S15] round=27 local utility u=0.000000 metrics={'f1_val': 0.6907685370404228, 'auprc': 0.9038898516857375, 'loss_val': 0.4858573454874169, 'psi': 0.7760170628985488}-{'f1_val': 0.6969976326418428, 'auprc': 0.9663942270918926, 'loss_val': 0.4409662392775868, 'psi': 0.8047562704218627}
[S16] START round=27 head_norm_before_train=1.954012 (no previous merge yet)
[S16] round=27 local utility u=0.000535 metrics={'f1_val': 0.9928814568495776, 'auprc': 0.9933818423468274, 'loss_val': 0.041090224233911475, 'psi': 0.9930816110484775}-{'f1_val': 0.9924497697178112, 'auprc': 0.9947434117331343, 'loss_val': 0.04365512977024348, 'psi': 0.9933672265239405}
[S17] START round=27 head_norm_before_train=1.678822 cos_to_last_merge=0.8139 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.814
[S17] round=27 local utility u=0.072328 metrics={'f1_val': 0.7209836595634713, 'auprc': 0.9688394388348631, 'loss_val': 0.7206090853262632, 'psi': 0.820125971272028}-{'f1_val': 0.7108274221878553, 'auprc': 0.9660480109604624, 'loss_val': 0.7959533637096012, 'psi': 0.8129156576968981}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S10] sending update (kind=head size=1809 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] sending update (kind=head size=1794 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:59814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:59805
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1796) from S9
[S5] cosine check vs S9: cos=0.5368
[S14] RECEIVED delta(kind=head bytes=1801) from S11
[S14] cosine check vs S11: cos=0.9724
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=27 metric=0.5560 head_norm=1.703215
[S5] _apply_head_vector_avg (torch): Δ‖w‖=7.279901e-01
[S5] stored merged vector for next round verification (round=27)
[S5] DEBUG after merge:  round=27 metric=0.4551 head_norm=1.257000 delta_norm=0.727990
[S5] aggregate: ROLLBACK (f1_val pre=0.556 post=0.455 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=27 metric=0.9854 head_norm=1.164721
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.467819e-01
[S14] stored merged vector for next round verification (round=27)
[S14] DEBUG after merge:  round=27 metric=0.9793 head_norm=1.195579 delta_norm=0.146782
[S14] aggregate: ROLLBACK (f1_val pre=0.985 post=0.979 tol_abs=0.005 tol_rel=0.0)
[S2] START round=28 head_norm_before_train=1.994419 cos_to_last_merge=0.9972 (last merge round=23)
[S2] round=28 local utility u=0.052214 metrics={'f1_val': 0.7159985171750556, 'auprc': 0.726370521874211, 'loss_val': 0.7803669821079651, 'psi': 0.7201473190547177}-{'f1_val': 0.6974443188885774, 'auprc': 0.7263428092308162, 'loss_val': 0.7733858263514909, 'psi': 0.7090037150254729}
[S3] START round=28 head_norm_before_train=1.964222 cos_to_last_merge=1.0000 (last merge round=26)
[S3] round=28 local utility u=0.142505 metrics={'f1_val': 0.9973696976584205, 'auprc': 0.99680208850491, 'loss_val': 0.02799619231184069, 'psi': 0.9971426539970163}-{'f1_val': 0.961498813606586, 'auprc': 0.9970333377934789, 'loss_val': 0.09847519204125178, 'psi': 0.9757126232813431}
[S4] START round=28 head_norm_before_train=1.941473 cos_to_last_merge=0.9988 (last merge round=25)
[S4] round=28 local utility u=0.043807 metrics={'f1_val': 0.9525581569623187, 'auprc': 0.9543021773471012, 'loss_val': 0.27886204786676555, 'psi': 0.9532557651162317}-{'f1_val': 0.950382967312327, 'auprc': 0.9294271092906239, 'loss_val': 0.27880047904817384, 'psi': 0.9420006241036457}
[S5] START round=28 head_norm_before_train=1.257000 cos_to_last_merge=1.0000 (last merge round=27)
[S5] round=28 local utility u=0.742809 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9839815766806397, 'loss_val': 0.4023759690629342, 'psi': 0.8137854211326041}-{'f1_val': 0.5560103386942381, 'auprc': 0.8551390019692231, 'loss_val': 0.6356013492578655, 'psi': 0.6756618040042321}
[S6] START round=28 head_norm_before_train=1.624544 cos_to_last_merge=0.9983 (last merge round=25)
[S6] round=28 local utility u=1.000000 metrics={'f1_val': 0.957763230503478, 'auprc': 0.96918203518728, 'loss_val': 0.20744095513274627, 'psi': 0.9623307523769988}-{'f1_val': 0.5882506620013428, 'auprc': 0.7410832480556497, 'loss_val': 0.7929265454046321, 'psi': 0.6493836964230656}
[S7] START round=28 head_norm_before_train=1.410558 cos_to_last_merge=0.8362 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.836
[S7] round=28 local utility u=0.000000 metrics={'f1_val': 0.5953694303855409, 'auprc': 0.7919495811553217, 'loss_val': 0.6821714379588559, 'psi': 0.6740014906934533}-{'f1_val': 0.6507292615206617, 'auprc': 0.8036984559170861, 'loss_val': 0.5348096349089216, 'psi': 0.7119169392792315}
[S8] START round=28 head_norm_before_train=2.064079 (no previous merge yet)
[S8] round=28 local utility u=0.000000 metrics={'f1_val': 0.7140636628454178, 'auprc': 0.9890652390887127, 'loss_val': 0.4074793570675628, 'psi': 0.8240642933427358}-{'f1_val': 0.9816765154405315, 'auprc': 0.9992829147587519, 'loss_val': 0.054105219365204675, 'psi': 0.9887190751678196}
[S9] START round=28 head_norm_before_train=1.148518 cos_to_last_merge=0.9940 (last merge round=25)
[S9] round=28 local utility u=0.016920 metrics={'f1_val': 0.9971000495392299, 'auprc': 0.9968766530214122, 'loss_val': 0.15398926590594195, 'psi': 0.9970106909321028}-{'f1_val': 0.9971000495392299, 'auprc': 0.9972047253453911, 'loss_val': 0.1888130402952332, 'psi': 0.9971419198616944}
[S10] START round=28 head_norm_before_train=1.878626 cos_to_last_merge=0.7646 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.765
[S10] round=28 local utility u=0.000000 metrics={'f1_val': 0.9935262985458464, 'auprc': 0.9961907771026328, 'loss_val': 0.03276351330492494, 'psi': 0.994592089968561}-{'f1_val': 0.9940063275949004, 'auprc': 0.9957922236319345, 'loss_val': 0.03194297132894879, 'psi': 0.994720686009714}
[S11] START round=28 head_norm_before_train=1.243114 cos_to_last_merge=0.9949 (last merge round=25)
[S11] round=28 local utility u=0.014271 metrics={'f1_val': 0.9971593530989756, 'auprc': 0.9961520318316319, 'loss_val': 0.14590643622714747, 'psi': 0.9967564245920382}-{'f1_val': 0.9975731865293843, 'auprc': 0.9991864262838946, 'loss_val': 0.1860342946155355, 'psi': 0.9982184824311884}
[S13] START round=28 head_norm_before_train=1.802097 (no previous merge yet)
[S13] round=28 local utility u=0.119651 metrics={'f1_val': 0.6213228158936253, 'auprc': 0.708228387628672, 'loss_val': 0.8196643858531152, 'psi': 0.6560850445876439}-{'f1_val': 0.5900383938914449, 'auprc': 0.7154003264457439, 'loss_val': 0.8927754393142101, 'psi': 0.6401831669131646}
[S14] START round=28 head_norm_before_train=1.195579 cos_to_last_merge=1.0000 (last merge round=27)
[S14] round=28 local utility u=0.000000 metrics={'f1_val': 0.968407415966603, 'auprc': 0.9970743375342908, 'loss_val': 0.12693517316192046, 'psi': 0.979874184593678}-{'f1_val': 0.9853867313365302, 'auprc': 0.9971287491328907, 'loss_val': 0.15780996464325, 'psi': 0.9900835384550744}
[S15] START round=28 head_norm_before_train=1.361041 cos_to_last_merge=0.9982 (last merge round=26)
[S15] round=28 local utility u=0.370804 metrics={'f1_val': 0.7661468871576143, 'auprc': 0.968579434302534, 'loss_val': 0.39058808613793233, 'psi': 0.8471199060155821}-{'f1_val': 0.6907685370404228, 'auprc': 0.9038898516857375, 'loss_val': 0.4858573454874169, 'psi': 0.7760170628985488}
[S16] START round=28 head_norm_before_train=1.969073 (no previous merge yet)
[S16] round=28 local utility u=0.000000 metrics={'f1_val': 0.9923873926502049, 'auprc': 0.9946357684107292, 'loss_val': 0.04248452706066928, 'psi': 0.9932867429544147}-{'f1_val': 0.9928814568495776, 'auprc': 0.9933818423468274, 'loss_val': 0.041090224233911475, 'psi': 0.9930816110484775}
[S17] START round=28 head_norm_before_train=1.692266 cos_to_last_merge=0.8133 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.813
[S17] round=28 local utility u=0.418735 metrics={'f1_val': 0.8096769910507292, 'auprc': 0.978652340916961, 'loss_val': 0.44473716189580176, 'psi': 0.877267130997222}-{'f1_val': 0.7209836595634713, 'auprc': 0.9688394388348631, 'loss_val': 0.7206090853262632, 'psi': 0.820125971272028}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S6] → sending delta(kind=head bytes=1806) to S7@127.0.0.1:59808
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:59810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:59805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:59807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:59816
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:59803
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:59814
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1794 to 1 peers)
[S6] sending update (kind=head size=1806 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1800) from S15
[S6] cosine check vs S15: cos=0.9264
[S5] RECEIVED delta(kind=head bytes=1794) from S9
[S5] cosine check vs S9: cos=0.8117
[S16] RECEIVED delta(kind=head bytes=1803) from S4
[S16] cosine check vs S4: cos=-0.0099
[S16] DROPPED delta from S4 (cos=-0.0099 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1797) from S11
[S14] cosine check vs S11: cos=0.9887
[S7] RECEIVED delta(kind=head bytes=1806) from S6
[S7] cosine check vs S6: cos=-0.0132
[S7] DROPPED delta from S6 (cos=-0.0132 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1796) from S2
[S3] cosine check vs S2: cos=0.9971
[S9] RECEIVED delta(kind=head bytes=1802) from S5
[S9] cosine check vs S5: cos=0.8117
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=28 metric=0.9684 head_norm=1.249567
[S14] _apply_head_vector_avg (torch): Δ‖w‖=9.720963e-02
[S14] stored merged vector for next round verification (round=28)
[S14] DEBUG after merge:  round=28 metric=0.9615 head_norm=1.265167 delta_norm=0.097210
[S14] aggregate: ROLLBACK (f1_val pre=0.968 post=0.962 tol_abs=0.005 tol_rel=0.0)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=28 metric=0.9974 head_norm=1.974157
[S3] _apply_head_vector_avg (torch): Δ‖w‖=7.812693e-02
[S3] stored merged vector for next round verification (round=28)
[S3] DEBUG after merge:  round=28 metric=0.9974 head_norm=1.991213 delta_norm=0.078127
[S3] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=28 metric=0.7003 head_norm=1.274269
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.802471e-01
[S5] stored merged vector for next round verification (round=28)
[S5] DEBUG after merge:  round=28 metric=0.7003 head_norm=1.173263 delta_norm=0.380247
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=28 metric=0.9971 head_norm=1.191011
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.802471e-01
[S9] stored merged vector for next round verification (round=28)
[S9] DEBUG after merge:  round=28 metric=0.9975 head_norm=1.173263 delta_norm=0.380247
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=28 metric=0.9578 head_norm=1.652492
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.156194e-01
[S6] stored merged vector for next round verification (round=28)
[S6] DEBUG after merge:  round=28 metric=0.9530 head_norm=1.510278 delta_norm=0.315619
[S6] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=29 head_norm_before_train=2.011162 cos_to_last_merge=0.9964 (last merge round=23)
[S2] round=29 local utility u=0.000000 metrics={'f1_val': 0.7150343143675777, 'auprc': 0.7271052680726825, 'loss_val': 0.7900971450251193, 'psi': 0.7198626958496196}-{'f1_val': 0.7159985171750556, 'auprc': 0.726370521874211, 'loss_val': 0.7803669821079651, 'psi': 0.7201473190547177}
[S3] START round=29 head_norm_before_train=1.991213 cos_to_last_merge=1.0000 (last merge round=28)
[S3] round=29 local utility u=0.000000 metrics={'f1_val': 0.961498813606586, 'auprc': 0.9975338280419059, 'loss_val': 0.08625464935325854, 'psi': 0.975912819380714}-{'f1_val': 0.9973696976584205, 'auprc': 0.99680208850491, 'loss_val': 0.02799619231184069, 'psi': 0.9971426539970163}
[S4] START round=29 head_norm_before_train=1.963821 cos_to_last_merge=0.9980 (last merge round=25)
[S4] round=29 local utility u=0.007654 metrics={'f1_val': 0.9530540197227801, 'auprc': 0.9585558809757113, 'loss_val': 0.27928942218938546, 'psi': 0.9552547642239526}-{'f1_val': 0.9525581569623187, 'auprc': 0.9543021773471012, 'loss_val': 0.27886204786676555, 'psi': 0.9532557651162317}
[S5] START round=29 head_norm_before_train=1.173263 cos_to_last_merge=1.0000 (last merge round=28)
[S5] round=29 local utility u=0.000000 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.8483590782926327, 'loss_val': 0.4764087791239004, 'psi': 0.7595364217774013}-{'f1_val': 0.7003213174339138, 'auprc': 0.9839815766806397, 'loss_val': 0.4023759690629342, 'psi': 0.8137854211326041}
[S6] START round=29 head_norm_before_train=1.510278 cos_to_last_merge=1.0000 (last merge round=28)
[S6] round=29 local utility u=0.000000 metrics={'f1_val': 0.6153488246184755, 'auprc': 0.7446585766814741, 'loss_val': 0.7067261622525333, 'psi': 0.6670727254436749}-{'f1_val': 0.957763230503478, 'auprc': 0.96918203518728, 'loss_val': 0.20744095513274627, 'psi': 0.9623307523769988}
[S7] START round=29 head_norm_before_train=1.420197 cos_to_last_merge=0.8349 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.835
[S7] round=29 local utility u=0.495425 metrics={'f1_val': 0.6825366720615152, 'auprc': 0.8388679640520299, 'loss_val': 0.35508076489382956, 'psi': 0.7450691888577211}-{'f1_val': 0.5953694303855409, 'auprc': 0.7919495811553217, 'loss_val': 0.6821714379588559, 'psi': 0.6740014906934533}
[S8] START round=29 head_norm_before_train=2.075057 (no previous merge yet)
[S8] round=29 local utility u=0.952143 metrics={'f1_val': 0.9710484465030425, 'auprc': 0.9989337615730753, 'loss_val': 0.07470683637320555, 'psi': 0.9822025725310556}-{'f1_val': 0.7140636628454178, 'auprc': 0.9890652390887127, 'loss_val': 0.4074793570675628, 'psi': 0.8240642933427358}
[S9] START round=29 head_norm_before_train=1.173263 cos_to_last_merge=1.0000 (last merge round=28)
[S9] round=29 local utility u=0.000000 metrics={'f1_val': 0.9975426610709598, 'auprc': 0.996799443306785, 'loss_val': 0.16510121622164262, 'psi': 0.9972453739652899}-{'f1_val': 0.9971000495392299, 'auprc': 0.9968766530214122, 'loss_val': 0.15398926590594195, 'psi': 0.9970106909321028}
[S10] START round=29 head_norm_before_train=1.887695 cos_to_last_merge=0.7641 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.764
[S10] round=29 local utility u=0.000709 metrics={'f1_val': 0.9935262985458464, 'auprc': 0.9964153488734692, 'loss_val': 0.03201973442549489, 'psi': 0.9946819186768955}-{'f1_val': 0.9935262985458464, 'auprc': 0.9961907771026328, 'loss_val': 0.03276351330492494, 'psi': 0.994592089968561}
[S11] START round=29 head_norm_before_train=1.287935 cos_to_last_merge=0.9905 (last merge round=25)
[S11] round=29 local utility u=0.019615 metrics={'f1_val': 0.9975731865293843, 'auprc': 0.9993117054881595, 'loss_val': 0.11863750611734063, 'psi': 0.9982685941128944}-{'f1_val': 0.9971593530989756, 'auprc': 0.9961520318316319, 'loss_val': 0.14590643622714747, 'psi': 0.9967564245920382}
[S13] START round=29 head_norm_before_train=1.813733 (no previous merge yet)
[S13] round=29 local utility u=0.018121 metrics={'f1_val': 0.634108891263168, 'auprc': 0.6931634822206925, 'loss_val': 0.8149446513352637, 'psi': 0.6577307276461779}-{'f1_val': 0.6213228158936253, 'auprc': 0.708228387628672, 'loss_val': 0.8196643858531152, 'psi': 0.6560850445876439}
[S14] START round=29 head_norm_before_train=1.265167 cos_to_last_merge=1.0000 (last merge round=28)
[S14] round=29 local utility u=0.051563 metrics={'f1_val': 0.9812826630753781, 'auprc': 0.9986815819914989, 'loss_val': 0.10588274056027087, 'psi': 0.9882422306418265}-{'f1_val': 0.968407415966603, 'auprc': 0.9970743375342908, 'loss_val': 0.12693517316192046, 'psi': 0.979874184593678}
[S15] START round=29 head_norm_before_train=1.424915 cos_to_last_merge=0.9947 (last merge round=26)
[S15] round=29 local utility u=0.460737 metrics={'f1_val': 0.8792959622628015, 'auprc': 0.9864796895280229, 'loss_val': 0.2017085532436633, 'psi': 0.92216945316889}-{'f1_val': 0.7661468871576143, 'auprc': 0.968579434302534, 'loss_val': 0.39058808613793233, 'psi': 0.8471199060155821}
[S16] START round=29 head_norm_before_train=1.984083 (no previous merge yet)
[S16] round=29 local utility u=0.000000 metrics={'f1_val': 0.9917303825996435, 'auprc': 0.9952105290574962, 'loss_val': 0.05370717872360383, 'psi': 0.9931224411827846}-{'f1_val': 0.9923873926502049, 'auprc': 0.9946357684107292, 'loss_val': 0.04248452706066928, 'psi': 0.9932867429544147}
[S17] START round=29 head_norm_before_train=1.706755 cos_to_last_merge=0.8122 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.812
[S17] round=29 local utility u=0.000000 metrics={'f1_val': 0.7069731649874109, 'auprc': 0.9771831858192914, 'loss_val': 0.9307957869607686, 'psi': 0.815057173320163}-{'f1_val': 0.8096769910507292, 'auprc': 0.978652340916961, 'loss_val': 0.44473716189580176, 'psi': 0.877267130997222}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:59815
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S10] sending update (kind=head size=1809 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:59816
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:59807
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:59814
[S11] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1801) from S15
[S6] cosine check vs S15: cos=0.9742
[S14] RECEIVED delta(kind=head bytes=1801) from S11
[S14] cosine check vs S11: cos=0.9938
[S16] RECEIVED delta(kind=head bytes=1800) from S4
[S16] cosine check vs S4: cos=-0.0105
[S16] DROPPED delta from S4 (cos=-0.0105 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1797) from S14
[S15] cosine check vs S14: cos=0.8349
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S10
[S14]  timeout peer S13
[S14]  timeout peer S16
[S14]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S16
[S8]  timeout peer S17
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S3]  timeout peer S2
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S6]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=29 metric=0.6153 head_norm=1.530167
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.727101e-01
[S6] stored merged vector for next round verification (round=29)
[S6] DEBUG after merge:  round=29 metric=0.6276 head_norm=1.498569 delta_norm=0.172710
[S6] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=29 metric=0.9813 head_norm=1.309892
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.451559e-02
[S14] stored merged vector for next round verification (round=29)
[S14] DEBUG after merge:  round=29 metric=0.9804 head_norm=1.319336 delta_norm=0.074516
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=29 metric=0.8793 head_norm=1.486493
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.104733e-01
[S15] stored merged vector for next round verification (round=29)
[S15] DEBUG after merge:  round=29 metric=0.8789 head_norm=1.339496 delta_norm=0.410473
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=30 head_norm_before_train=2.027762 cos_to_last_merge=0.9955 (last merge round=23)
[S2] round=30 local utility u=0.001298 metrics={'f1_val': 0.7183433349080932, 'auprc': 0.7259047339217383, 'loss_val': 0.8037533595314481, 'psi': 0.7213678945135512}-{'f1_val': 0.7150343143675777, 'auprc': 0.7271052680726825, 'loss_val': 0.7900971450251193, 'psi': 0.7198626958496196}
[S3] START round=30 head_norm_before_train=2.002039 cos_to_last_merge=1.0000 (last merge round=28)
[S3] round=30 local utility u=0.000000 metrics={'f1_val': 0.9605709740356257, 'auprc': 0.9682734653658033, 'loss_val': 0.13932847622129144, 'psi': 0.9636519705676967}-{'f1_val': 0.961498813606586, 'auprc': 0.9975338280419059, 'loss_val': 0.08625464935325854, 'psi': 0.975912819380714}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=30 head_norm_before_train=1.985196 cos_to_last_merge=0.9972 (last merge round=25)
[S4] round=30 local utility u=0.000000 metrics={'f1_val': 0.9514023303962637, 'auprc': 0.9440339859168957, 'loss_val': 0.2858136746725768, 'psi': 0.9484549926045165}-{'f1_val': 0.9530540197227801, 'auprc': 0.9585558809757113, 'loss_val': 0.27928942218938546, 'psi': 0.9552547642239526}
[S5] START round=30 head_norm_before_train=1.203312 cos_to_last_merge=0.9987 (last merge round=28)
[S5] round=30 local utility u=0.000000 metrics={'f1_val': 0.6674945936138609, 'auprc': 0.8522964160960288, 'loss_val': 0.48718210557323516, 'psi': 0.7414153226067282}-{'f1_val': 0.7003213174339138, 'auprc': 0.8483590782926327, 'loss_val': 0.4764087791239004, 'psi': 0.7595364217774013}
[S6] START round=30 head_norm_before_train=1.498569 cos_to_last_merge=1.0000 (last merge round=29)
[S6] round=30 local utility u=0.000000 metrics={'f1_val': 0.5880062208803936, 'auprc': 0.7721538319203732, 'loss_val': 0.6799977070414263, 'psi': 0.6616652652963855}-{'f1_val': 0.6153488246184755, 'auprc': 0.7446585766814741, 'loss_val': 0.7067261622525333, 'psi': 0.6670727254436749}
[S7] START round=30 head_norm_before_train=1.429755 cos_to_last_merge=0.8336 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.834
[S7] round=30 local utility u=0.000000 metrics={'f1_val': 0.4206149204208822, 'auprc': 0.7796685687993632, 'loss_val': 1.0847299826732726, 'psi': 0.5642363797722746}-{'f1_val': 0.6825366720615152, 'auprc': 0.8388679640520299, 'loss_val': 0.35508076489382956, 'psi': 0.7450691888577211}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=30 head_norm_before_train=2.083971 (no previous merge yet)
[S8] round=30 local utility u=0.094546 metrics={'f1_val': 0.9942857583640028, 'auprc': 0.9993473822626117, 'loss_val': 0.0262801025334195, 'psi': 0.9963104079234464}-{'f1_val': 0.9710484465030425, 'auprc': 0.9989337615730753, 'loss_val': 0.07470683637320555, 'psi': 0.9822025725310556}
[S8] not sending this round → trigger blocked (psi=0.996)
[S9] START round=30 head_norm_before_train=1.210496 cos_to_last_merge=0.9992 (last merge round=28)
[S9] round=30 local utility u=0.014375 metrics={'f1_val': 0.9971317563071089, 'auprc': 0.9954862484057203, 'loss_val': 0.1299464860579837, 'psi': 0.9964735531465535}-{'f1_val': 0.9975426610709598, 'auprc': 0.996799443306785, 'loss_val': 0.16510121622164262, 'psi': 0.9972453739652899}
[S10] START round=30 head_norm_before_train=1.900296 cos_to_last_merge=0.7629 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.763
[S10] round=30 local utility u=0.000000 metrics={'f1_val': 0.9933073753875716, 'auprc': 0.9965895921541328, 'loss_val': 0.0328864548793124, 'psi': 0.9946202620941961}-{'f1_val': 0.9935262985458464, 'auprc': 0.9964153488734692, 'loss_val': 0.03201973442549489, 'psi': 0.9946819186768955}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=30 head_norm_before_train=1.332885 cos_to_last_merge=0.9857 (last merge round=25)
[S11] round=30 local utility u=0.006232 metrics={'f1_val': 0.9974011907167429, 'auprc': 0.9970804418251935, 'loss_val': 0.09844809141646352, 'psi': 0.9972728911601232}-{'f1_val': 0.9975731865293843, 'auprc': 0.9993117054881595, 'loss_val': 0.11863750611734063, 'psi': 0.9982685941128944}
[S13] START round=30 head_norm_before_train=1.824176 (no previous merge yet)
[S13] round=30 local utility u=0.000000 metrics={'f1_val': 0.5880307350109854, 'auprc': 0.7367801070680872, 'loss_val': 0.9648277300834921, 'psi': 0.647530483833826}-{'f1_val': 0.634108891263168, 'auprc': 0.6931634822206925, 'loss_val': 0.8149446513352637, 'psi': 0.6577307276461779}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=30 head_norm_before_train=1.319336 cos_to_last_merge=1.0000 (last merge round=29)
[S14] round=30 local utility u=0.056786 metrics={'f1_val': 0.9966100132760906, 'auprc': 0.9985328542782472, 'loss_val': 0.08382960748088766, 'psi': 0.9973791496769533}-{'f1_val': 0.9812826630753781, 'auprc': 0.9986815819914989, 'loss_val': 0.10588274056027087, 'psi': 0.9882422306418265}
[S15] START round=30 head_norm_before_train=1.339496 cos_to_last_merge=1.0000 (last merge round=29)
[S15] round=30 local utility u=0.380735 metrics={'f1_val': 0.9919430181707071, 'auprc': 0.9771771265771454, 'loss_val': 0.08821359657198408, 'psi': 0.9860366615332825}-{'f1_val': 0.8792959622628015, 'auprc': 0.9864796895280229, 'loss_val': 0.2017085532436633, 'psi': 0.92216945316889}
[S16] START round=30 head_norm_before_train=1.992079 (no previous merge yet)
[S16] round=30 local utility u=0.000000 metrics={'f1_val': 0.9913128954493902, 'auprc': 0.9941265146082614, 'loss_val': 0.05402013816404239, 'psi': 0.9924383431129387}-{'f1_val': 0.9917303825996435, 'auprc': 0.9952105290574962, 'loss_val': 0.05370717872360383, 'psi': 0.9931224411827846}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=30 head_norm_before_train=1.725987 cos_to_last_merge=0.8107 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.811
[S17] round=30 local utility u=0.121321 metrics={'f1_val': 0.720802146324642, 'auprc': 0.9686309155038286, 'loss_val': 0.7454698858901673, 'psi': 0.8199336539963167}-{'f1_val': 0.7069731649874109, 'auprc': 0.9771831858192914, 'loss_val': 0.9307957869607686, 'psi': 0.815057173320163}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] → sending delta(kind=head bytes=1805) to S14@127.0.0.1:59814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:59807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:59803
[S2] sending update (kind=head size=1795 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1805 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] RECEIVED delta(kind=head bytes=1805) from S11
[S14] cosine check vs S11: cos=0.9961
[S6] RECEIVED delta(kind=head bytes=1800) from S15
[S6] cosine check vs S15: cos=0.9376
[S3] RECEIVED delta(kind=head bytes=1795) from S2
[S3] cosine check vs S2: cos=0.9982
[S11] ⇄ pheromone p=0.068 → S14@127.0.0.1:59814
[S15] ⇄ pheromone p=0.326 → S6@127.0.0.1:59807
[S2] ⇄ pheromone p=0.038 → S3@127.0.0.1:59803
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:59805
[S9] sending update (kind=head size=1795 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1795) from S9
[S5] cosine check vs S9: cos=0.9907
[S9] CommDone barrier timeout: have=0 need=2 — continuing
[S9] ⇄ pheromone p=0.162 → S5@127.0.0.1:59805
[S14] RoundReady barrier timeout: have=1 need=2 — continuing
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:59815
[S5] RoundReady barrier timeout: have=1 need=2 — continuing
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] CommDone barrier timeout: have=0 need=1 — continuing
[S4] ⇄ pheromone p=0.030 → S16@127.0.0.1:59816
[S6] RoundReady barrier timeout: have=1 need=3 — continuing
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1795 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1795) from S14
[S15] cosine check vs S14: cos=0.9399
[S2]  timeout peer S3
[S6]  timeout peer S8
[S9]  timeout peer S11
[S14]  timeout peer S9
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=30 metric=0.9966 head_norm=1.354076
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.050211e-02
[S14] stored merged vector for next round verification (round=30)
[S14] DEBUG after merge:  round=30 metric=0.9966 head_norm=1.361647 delta_norm=0.060502
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.040 → S11@127.0.0.1:59812
[S4]  timeout peer S10
[S4]  timeout peer S16
[S9]  timeout peer S5
[S9]  timeout peer S13
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S7
[S5]  timeout peer S4
[S5]  timeout peer S17
[S15]  timeout peer S6
[S14]  timeout peer S15
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=30 metric=0.5880 head_norm=1.521336
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.648127e-01
[S6] stored merged vector for next round verification (round=30)
[S6] DEBUG after merge:  round=30 metric=0.5996 head_norm=1.438022 delta_norm=0.264813
[S6] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=30 metric=0.6675 head_norm=1.235243
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.496162e-02
[S5] stored merged vector for next round verification (round=30)
[S5] DEBUG after merge:  round=30 metric=0.6693 head_norm=1.239408 delta_norm=0.084962
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.158 → S9@127.0.0.1:59810
[S2] START round=31 head_norm_before_train=2.042478 cos_to_last_merge=0.9945 (last merge round=23)
[S2] round=31 local utility u=0.000000 metrics={'f1_val': 0.7108103391971055, 'auprc': 0.7237411882500093, 'loss_val': 0.8811562331695302, 'psi': 0.715982678818267}-{'f1_val': 0.7183433349080932, 'auprc': 0.7259047339217383, 'loss_val': 0.8037533595314481, 'psi': 0.7213678945135512}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=31 head_norm_before_train=2.013593 cos_to_last_merge=0.9999 (last merge round=28)
[S3] round=31 local utility u=0.208307 metrics={'f1_val': 0.9976528558298854, 'auprc': 0.9969305464049381, 'loss_val': 0.031176930844294244, 'psi': 0.9973639320599064}-{'f1_val': 0.9605709740356257, 'auprc': 0.9682734653658033, 'loss_val': 0.13932847622129144, 'psi': 0.9636519705676967}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] sending update (kind=head size=1794 to 1 peers)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=31 metric=0.9977 head_norm=2.026455
[S3] _apply_head_vector_avg (torch): Δ‖w‖=6.477494e-02
[S3] stored merged vector for next round verification (round=31)
[S3] DEBUG after merge:  round=31 metric=0.9977 head_norm=2.033451 delta_norm=0.064775
[S3] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S4] START round=31 head_norm_before_train=2.003237 cos_to_last_merge=0.9965 (last merge round=25)
[S4] round=31 local utility u=0.024355 metrics={'f1_val': 0.9546128204649603, 'auprc': 0.9539177289632574, 'loss_val': 0.2860171864009443, 'psi': 0.9543347838642792}-{'f1_val': 0.9514023303962637, 'auprc': 0.9440339859168957, 'loss_val': 0.2858136746725768, 'psi': 0.9484549926045165}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=31 head_norm_before_train=1.239408 cos_to_last_merge=1.0000 (last merge round=30)
[S5] round=31 local utility u=0.000000 metrics={'f1_val': 0.6215377910794215, 'auprc': 0.856714634126887, 'loss_val': 0.5294148830138574, 'psi': 0.7156085282984077}-{'f1_val': 0.6674945936138609, 'auprc': 0.8522964160960288, 'loss_val': 0.48718210557323516, 'psi': 0.7414153226067282}
[S6] START round=31 head_norm_before_train=1.438022 cos_to_last_merge=1.0000 (last merge round=30)
[S6] round=31 local utility u=0.562599 metrics={'f1_val': 0.6712964128851131, 'auprc': 0.9338532448004043, 'loss_val': 0.5396392826584777, 'psi': 0.7763191456512296}-{'f1_val': 0.5880062208803936, 'auprc': 0.7721538319203732, 'loss_val': 0.6799977070414263, 'psi': 0.6616652652963855}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] START round=31 head_norm_before_train=1.438395 cos_to_last_merge=0.8323 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.832
[S7] round=31 local utility u=0.977327 metrics={'f1_val': 0.6387281993212748, 'auprc': 0.801425074555508, 'loss_val': 0.5040255358775414, 'psi': 0.7038069494149681}-{'f1_val': 0.4206149204208822, 'auprc': 0.7796685687993632, 'loss_val': 1.0847299826732726, 'psi': 0.5642363797722746}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=31 head_norm_before_train=2.091344 (no previous merge yet)
[S8] round=31 local utility u=0.000000 metrics={'f1_val': 0.9085328148313868, 'auprc': 0.9907957773425426, 'loss_val': 0.11733763103391263, 'psi': 0.9414379998358492}-{'f1_val': 0.9942857583640028, 'auprc': 0.9993473822626117, 'loss_val': 0.0262801025334195, 'psi': 0.9963104079234464}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=31 head_norm_before_train=1.249351 cos_to_last_merge=0.9969 (last merge round=28)
[S9] round=31 local utility u=0.015138 metrics={'f1_val': 0.9975426610709598, 'auprc': 0.9968952700063802, 'loss_val': 0.10636255147487869, 'psi': 0.9972837046451279}-{'f1_val': 0.9971317563071089, 'auprc': 0.9954862484057203, 'loss_val': 0.1299464860579837, 'psi': 0.9964735531465535}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=31 head_norm_before_train=1.913722 cos_to_last_merge=0.7615 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.762
[S10] round=31 local utility u=0.000189 metrics={'f1_val': 0.9935262985458464, 'auprc': 0.9959906653507345, 'loss_val': 0.03202483196277118, 'psi': 0.9945120452678016}-{'f1_val': 0.9933073753875716, 'auprc': 0.9965895921541328, 'loss_val': 0.0328864548793124, 'psi': 0.9946202620941961}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S10] sending update (kind=head size=1806 to 1 peers)
[S11] START round=31 head_norm_before_train=1.371848 cos_to_last_merge=0.9815 (last merge round=25)
[S11] round=31 local utility u=0.000000 metrics={'f1_val': 0.9795674143997439, 'auprc': 0.9994600104785175, 'loss_val': 0.13166350171053792, 'psi': 0.9875244528312533}-{'f1_val': 0.9974011907167429, 'auprc': 0.9970804418251935, 'loss_val': 0.09844809141646352, 'psi': 0.9972728911601232}
[S13] START round=31 head_norm_before_train=1.829332 (no previous merge yet)
[S13] round=31 local utility u=0.290728 metrics={'f1_val': 0.655647582212245, 'auprc': 0.681388950918522, 'loss_val': 0.6228996884561497, 'psi': 0.6659441296947558}-{'f1_val': 0.5880307350109854, 'auprc': 0.7367801070680872, 'loss_val': 0.9648277300834921, 'psi': 0.647530483833826}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=31 head_norm_before_train=1.361647 cos_to_last_merge=1.0000 (last merge round=30)
[S14] round=31 local utility u=0.005007 metrics={'f1_val': 0.9972435617623723, 'auprc': 0.998017333583218, 'loss_val': 0.07606982886460088, 'psi': 0.9975530704907105}-{'f1_val': 0.9966100132760906, 'auprc': 0.9985328542782472, 'loss_val': 0.08382960748088766, 'psi': 0.9973791496769533}
[S15] START round=31 head_norm_before_train=1.400573 cos_to_last_merge=0.9992 (last merge round=29)
[S15] round=31 local utility u=0.000000 metrics={'f1_val': 0.8951008187996302, 'auprc': 0.9645869645128442, 'loss_val': 0.20212799147660707, 'psi': 0.9228952770849157}-{'f1_val': 0.9919430181707071, 'auprc': 0.9771771265771454, 'loss_val': 0.08821359657198408, 'psi': 0.9860366615332825}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=31 metric=0.8951 head_norm=1.447657
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.559161e-01
[S15] stored merged vector for next round verification (round=31)
[S15] DEBUG after merge:  round=31 metric=0.8955 head_norm=1.378087 delta_norm=0.255916
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S16] START round=31 head_norm_before_train=2.002042 (no previous merge yet)
[S16] round=31 local utility u=0.002521 metrics={'f1_val': 0.9915316888756154, 'auprc': 0.9935151579352792, 'loss_val': 0.048456465915628064, 'psi': 0.9923250764994809}-{'f1_val': 0.9913128954493902, 'auprc': 0.9941265146082614, 'loss_val': 0.05402013816404239, 'psi': 0.9924383431129387}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=31 head_norm_before_train=1.734689 cos_to_last_merge=0.8094 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.809
[S17] round=31 local utility u=0.000000 metrics={'f1_val': 0.721017063019002, 'auprc': 0.9714069396956854, 'loss_val': 0.8300528179198389, 'psi': 0.8211730136896753}-{'f1_val': 0.720802146324642, 'auprc': 0.9686309155038286, 'loss_val': 0.7454698858901673, 'psi': 0.8199336539963167}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:59812
[S14] sending update (kind=head size=1798 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1798) from S14
[S11] cosine check vs S14: cos=0.9975
[S2] START round=32 head_norm_before_train=2.058734 cos_to_last_merge=0.9936 (last merge round=23)
[S2] round=32 local utility u=0.003571 metrics={'f1_val': 0.7013734011408724, 'auprc': 0.7296366948755483, 'loss_val': 0.8350781445245474, 'psi': 0.7126787186347427}-{'f1_val': 0.7108103391971055, 'auprc': 0.7237411882500093, 'loss_val': 0.8811562331695302, 'psi': 0.715982678818267}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=32 head_norm_before_train=2.033451 cos_to_last_merge=1.0000 (last merge round=31)
[S3] round=32 local utility u=0.002394 metrics={'f1_val': 0.9977814963782642, 'auprc': 0.9971595355143086, 'loss_val': 0.02784768294479961, 'psi': 0.997532712032682}-{'f1_val': 0.9976528558298854, 'auprc': 0.9969305464049381, 'loss_val': 0.031176930844294244, 'psi': 0.9973639320599064}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=32 head_norm_before_train=2.014545 cos_to_last_merge=0.9958 (last merge round=25)
[S4] round=32 local utility u=0.019200 metrics={'f1_val': 0.954583697017885, 'auprc': 0.9640309383111939, 'loss_val': 0.2777829899119388, 'psi': 0.9583625935352086}-{'f1_val': 0.9546128204649603, 'auprc': 0.9539177289632574, 'loss_val': 0.2860171864009443, 'psi': 0.9543347838642792}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] START round=32 head_norm_before_train=1.269977 cos_to_last_merge=0.9991 (last merge round=30)
[S5] round=32 local utility u=0.015345 metrics={'f1_val': 0.6203860775966137, 'auprc': 0.8670983989905867, 'loss_val': 0.5229668329847541, 'psi': 0.7190710061542029}-{'f1_val': 0.6215377910794215, 'auprc': 0.856714634126887, 'loss_val': 0.5294148830138574, 'psi': 0.7156085282984077}
[S6] START round=32 head_norm_before_train=1.463938 cos_to_last_merge=0.9996 (last merge round=30)
[S6] round=32 local utility u=0.529850 metrics={'f1_val': 0.8258986594303388, 'auprc': 0.919866901265258, 'loss_val': 0.3655931227637276, 'psi': 0.8634859561643065}-{'f1_val': 0.6712964128851131, 'auprc': 0.9338532448004043, 'loss_val': 0.5396392826584777, 'psi': 0.7763191456512296}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] sending update (kind=head size=1794 to 1 peers)
[S7] START round=32 head_norm_before_train=1.445618 cos_to_last_merge=0.8315 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.832
[S7] round=32 local utility u=0.000000 metrics={'f1_val': 0.6041314791684863, 'auprc': 0.7915941855179149, 'loss_val': 0.6621617022712325, 'psi': 0.6791165617082577}-{'f1_val': 0.6387281993212748, 'auprc': 0.801425074555508, 'loss_val': 0.5040255358775414, 'psi': 0.7038069494149681}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=32 head_norm_before_train=2.098953 (no previous merge yet)
[S8] round=32 local utility u=0.158160 metrics={'f1_val': 0.9597419763962178, 'auprc': 0.9991260891564893, 'loss_val': 0.1332633397341423, 'psi': 0.9754956215003264}-{'f1_val': 0.9085328148313868, 'auprc': 0.9907957773425426, 'loss_val': 0.11733763103391263, 'psi': 0.9414379998358492}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=32 head_norm_before_train=1.287944 cos_to_last_merge=0.9938 (last merge round=28)
[S9] round=32 local utility u=0.007395 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.996836178223362, 'loss_val': 0.08875701270400961, 'psi': 0.9969962187966305}-{'f1_val': 0.9975426610709598, 'auprc': 0.9968952700063802, 'loss_val': 0.10636255147487869, 'psi': 0.9972837046451279}
[S9] not sending this round → trigger blocked (psi=0.997)
[S10] START round=32 head_norm_before_train=1.925322 cos_to_last_merge=0.7604 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.760
[S10] round=32 local utility u=0.000003 metrics={'f1_val': 0.9935262985458464, 'auprc': 0.9960697425601128, 'loss_val': 0.032255906811892346, 'psi': 0.9945436761515529}-{'f1_val': 0.9935262985458464, 'auprc': 0.9959906653507345, 'loss_val': 0.03202483196277118, 'psi': 0.9945120452678016}
[S10] not sending this round → trigger blocked (psi=0.995)
[S11] START round=32 head_norm_before_train=1.402252 cos_to_last_merge=0.9784 (last merge round=25)
[S11] round=32 local utility u=0.081269 metrics={'f1_val': 0.9971593530989756, 'auprc': 0.998816097900446, 'loss_val': 0.07274530792433238, 'psi': 0.9978220510195639}-{'f1_val': 0.9795674143997439, 'auprc': 0.9994600104785175, 'loss_val': 0.13166350171053792, 'psi': 0.9875244528312533}
[S13] START round=32 head_norm_before_train=1.841426 (no previous merge yet)
[S13] round=32 local utility u=0.000000 metrics={'f1_val': 0.6157622816298551, 'auprc': 0.7245270112469595, 'loss_val': 1.0331379742152833, 'psi': 0.659268173476697}-{'f1_val': 0.655647582212245, 'auprc': 0.681388950918522, 'loss_val': 0.6228996884561497, 'psi': 0.6659441296947558}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=32 head_norm_before_train=1.390924 cos_to_last_merge=0.9998 (last merge round=30)
[S14] round=32 local utility u=0.002963 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9985919458630381, 'loss_val': 0.07039118870596987, 'psi': 0.9976352832398143}-{'f1_val': 0.9972435617623723, 'auprc': 0.998017333583218, 'loss_val': 0.07606982886460088, 'psi': 0.9975530704907105}
[S15] START round=32 head_norm_before_train=1.378087 cos_to_last_merge=1.0000 (last merge round=31)
[S15] round=32 local utility u=0.000000 metrics={'f1_val': 0.6971542113916501, 'auprc': 0.6954606058975308, 'loss_val': 0.5047888663412574, 'psi': 0.6964767691940024}-{'f1_val': 0.8951008187996302, 'auprc': 0.9645869645128442, 'loss_val': 0.20212799147660707, 'psi': 0.9228952770849157}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=32 head_norm_before_train=2.013875 (no previous merge yet)
[S16] round=32 local utility u=0.000000 metrics={'f1_val': 0.9367314851593307, 'auprc': 0.9923821796142094, 'loss_val': 0.2857792630138066, 'psi': 0.9589917629412821}-{'f1_val': 0.9915316888756154, 'auprc': 0.9935151579352792, 'loss_val': 0.048456465915628064, 'psi': 0.9923250764994809}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=32 head_norm_before_train=1.748160 cos_to_last_merge=0.8078 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.808
[S17] round=32 local utility u=0.000297 metrics={'f1_val': 0.7256968951219144, 'auprc': 0.9773076450893219, 'loss_val': 0.8752397037470583, 'psi': 0.8263411951088775}-{'f1_val': 0.721017063019002, 'auprc': 0.9714069396956854, 'loss_val': 0.8300528179198389, 'psi': 0.8211730136896753}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:59810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:59814
[S14] not sending this round → trigger blocked (psi=0.998)
[S5] sending update (kind=head size=1804 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1804) from S5
[S9] cosine check vs S5: cos=0.9840
[S14] RECEIVED delta(kind=head bytes=1803) from S11
[S14] cosine check vs S11: cos=0.9959
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=32 metric=0.9972 head_norm=1.425587
[S11] _apply_head_vector_avg (torch): Δ‖w‖=5.862568e-02
[S11] stored merged vector for next round verification (round=32)
[S11] DEBUG after merge:  round=32 metric=0.9972 head_norm=1.407141 delta_norm=0.058626
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=33 head_norm_before_train=2.074924 cos_to_last_merge=0.9927 (last merge round=23)
[S2] round=33 local utility u=0.000000 metrics={'f1_val': 0.6992326414080585, 'auprc': 0.7294224690103936, 'loss_val': 0.8499401375714093, 'psi': 0.7113085724489926}-{'f1_val': 0.7013734011408724, 'auprc': 0.7296366948755483, 'loss_val': 0.8350781445245474, 'psi': 0.7126787186347427}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=33 head_norm_before_train=2.043747 cos_to_last_merge=1.0000 (last merge round=31)
[S3] round=33 local utility u=0.000000 metrics={'f1_val': 0.961498813606586, 'auprc': 0.9959815355877475, 'loss_val': 0.10149084794985712, 'psi': 0.9752919023990505}-{'f1_val': 0.9977814963782642, 'auprc': 0.9971595355143086, 'loss_val': 0.02784768294479961, 'psi': 0.997532712032682}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=33 head_norm_before_train=2.026212 cos_to_last_merge=0.9951 (last merge round=25)
[S4] round=33 local utility u=0.000000 metrics={'f1_val': 0.953110049296651, 'auprc': 0.9479584407089124, 'loss_val': 0.2952485418128702, 'psi': 0.9510494058615556}-{'f1_val': 0.954583697017885, 'auprc': 0.9640309383111939, 'loss_val': 0.2777829899119388, 'psi': 0.9583625935352086}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=33 head_norm_before_train=1.303281 cos_to_last_merge=0.9967 (last merge round=30)
[S5] round=33 local utility u=0.543875 metrics={'f1_val': 0.7004932948021524, 'auprc': 0.9887388886232675, 'loss_val': 0.28078242699647865, 'psi': 0.8157915323305984}-{'f1_val': 0.6203860775966137, 'auprc': 0.8670983989905867, 'loss_val': 0.5229668329847541, 'psi': 0.7190710061542029}
[S6] START round=33 head_norm_before_train=1.490307 cos_to_last_merge=0.9988 (last merge round=30)
[S6] round=33 local utility u=0.000000 metrics={'f1_val': 0.7803650620587318, 'auprc': 0.9226465083559668, 'loss_val': 0.5093580845087383, 'psi': 0.8372776405776259}-{'f1_val': 0.8258986594303388, 'auprc': 0.919866901265258, 'loss_val': 0.3655931227637276, 'psi': 0.8634859561643065}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=33 head_norm_before_train=1.454339 cos_to_last_merge=0.8305 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.831
[S7] round=33 local utility u=0.555164 metrics={'f1_val': 0.6963736456930072, 'auprc': 0.8616123238905848, 'loss_val': 0.3153405318280674, 'psi': 0.7624691169720382}-{'f1_val': 0.6041314791684863, 'auprc': 0.7915941855179149, 'loss_val': 0.6621617022712325, 'psi': 0.6791165617082577}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=33 head_norm_before_train=2.105987 (no previous merge yet)
[S8] round=33 local utility u=0.158057 metrics={'f1_val': 0.994792642153961, 'auprc': 0.9994422193526383, 'loss_val': 0.028401611253830967, 'psi': 0.996652473033432}-{'f1_val': 0.9597419763962178, 'auprc': 0.9991260891564893, 'loss_val': 0.1332633397341423, 'psi': 0.9754956215003264}
[S8] not sending this round → trigger blocked (psi=0.997)
[S9] START round=33 head_norm_before_train=1.322464 cos_to_last_merge=0.9905 (last merge round=28)
[S9] round=33 local utility u=0.004340 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.995073259464517, 'loss_val': 0.07478765436799621, 'psi': 0.9962910512930925}-{'f1_val': 0.9971029125121428, 'auprc': 0.996836178223362, 'loss_val': 0.08875701270400961, 'psi': 0.9969962187966305}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=33 metric=0.9971 head_norm=1.354485
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.322900e-01
[S9] stored merged vector for next round verification (round=33)
[S9] DEBUG after merge:  round=33 metric=0.9971 head_norm=1.322530 delta_norm=0.132290
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S10] START round=33 head_norm_before_train=1.934112 cos_to_last_merge=0.7597 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.760
[S10] round=33 local utility u=0.000250 metrics={'f1_val': 0.9935262985458464, 'auprc': 0.9959606129539654, 'loss_val': 0.03142819039129897, 'psi': 0.994500024309094}-{'f1_val': 0.9935262985458464, 'auprc': 0.9960697425601128, 'loss_val': 0.032255906811892346, 'psi': 0.9945436761515529}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] sending update (kind=head size=1804 to 1 peers)
[S11] START round=33 head_norm_before_train=1.407141 cos_to_last_merge=1.0000 (last merge round=32)
[S11] round=33 local utility u=0.000000 metrics={'f1_val': 0.9974011907167429, 'auprc': 0.9992851259961193, 'loss_val': 0.07729108929318901, 'psi': 0.9981547648284935}-{'f1_val': 0.9971593530989756, 'auprc': 0.998816097900446, 'loss_val': 0.07274530792433238, 'psi': 0.9978220510195639}
[S13] START round=33 head_norm_before_train=1.850101 (no previous merge yet)
[S13] round=33 local utility u=0.000000 metrics={'f1_val': 0.6230188687391448, 'auprc': 0.6023172918742106, 'loss_val': 1.0198849813507675, 'psi': 0.6147382379931712}-{'f1_val': 0.6157622816298551, 'auprc': 0.7245270112469595, 'loss_val': 1.0331379742152833, 'psi': 0.659268173476697}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=33 head_norm_before_train=1.415759 cos_to_last_merge=0.9993 (last merge round=30)
[S14] round=33 local utility u=0.000000 metrics={'f1_val': 0.9965375310696338, 'auprc': 0.9968753635947825, 'loss_val': 0.06469090955172384, 'psi': 0.9966726640796932}-{'f1_val': 0.9969975081576651, 'auprc': 0.9985919458630381, 'loss_val': 0.07039118870596987, 'psi': 0.9976352832398143}
[S15] START round=33 head_norm_before_train=1.434569 cos_to_last_merge=0.9992 (last merge round=31)
[S15] round=33 local utility u=1.000000 metrics={'f1_val': 0.9915045569729221, 'auprc': 0.9799884504135687, 'loss_val': 0.07905601396265502, 'psi': 0.9868981143491806}-{'f1_val': 0.6971542113916501, 'auprc': 0.6954606058975308, 'loss_val': 0.5047888663412574, 'psi': 0.6964767691940024}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=33 head_norm_before_train=2.025162 (no previous merge yet)
[S16] round=33 local utility u=0.004222 metrics={'f1_val': 0.9385900816189043, 'auprc': 0.9894898361890259, 'loss_val': 0.27980904764287645, 'psi': 0.9589499834469529}-{'f1_val': 0.9367314851593307, 'auprc': 0.9923821796142094, 'loss_val': 0.2857792630138066, 'psi': 0.9589917629412821}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=33 head_norm_before_train=1.761208 cos_to_last_merge=0.8061 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.806
[S17] round=33 local utility u=0.044698 metrics={'f1_val': 0.7264137916427565, 'auprc': 0.9725488894703614, 'loss_val': 0.775869270125909, 'psi': 0.8248678307737985}-{'f1_val': 0.7256968951219144, 'auprc': 0.9773076450893219, 'loss_val': 0.8752397037470583, 'psi': 0.8263411951088775}
[S17] not sending this round → trigger blocked (psi=0.825)
[S5] not sending this round → trigger blocked (psi=0.816)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=33 metric=0.9965 head_norm=1.434539
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.139529e-02
[S14] stored merged vector for next round verification (round=33)
[S14] DEBUG after merge:  round=33 metric=0.9965 head_norm=1.428287 delta_norm=0.071395
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=34 head_norm_before_train=2.087888 cos_to_last_merge=0.9919 (last merge round=23)
[S2] round=34 local utility u=0.000000 metrics={'f1_val': 0.6929330333869695, 'auprc': 0.7318414764810837, 'loss_val': 0.8657526393533713, 'psi': 0.7084964106246152}-{'f1_val': 0.6992326414080585, 'auprc': 0.7294224690103936, 'loss_val': 0.8499401375714093, 'psi': 0.7113085724489926}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=34 head_norm_before_train=2.054277 cos_to_last_merge=1.0000 (last merge round=31)
[S3] round=34 local utility u=0.146332 metrics={'f1_val': 0.9976528558298854, 'auprc': 0.9972538400995156, 'loss_val': 0.02956814871285785, 'psi': 0.9974932495377374}-{'f1_val': 0.961498813606586, 'auprc': 0.9959815355877475, 'loss_val': 0.10149084794985712, 'psi': 0.9752919023990505}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=34 head_norm_before_train=2.039589 cos_to_last_merge=0.9945 (last merge round=25)
[S4] round=34 local utility u=0.032248 metrics={'f1_val': 0.9582675037568286, 'auprc': 0.9557128331943178, 'loss_val': 0.28495983526371105, 'psi': 0.9572456355318242}-{'f1_val': 0.953110049296651, 'auprc': 0.9479584407089124, 'loss_val': 0.2952485418128702, 'psi': 0.9510494058615556}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=34 head_norm_before_train=1.332197 cos_to_last_merge=0.9940 (last merge round=30)
[S5] round=34 local utility u=0.000000 metrics={'f1_val': 0.6439411449092747, 'auprc': 0.8554847181592526, 'loss_val': 0.49542242407891146, 'psi': 0.728558574209266}-{'f1_val': 0.7004932948021524, 'auprc': 0.9887388886232675, 'loss_val': 0.28078242699647865, 'psi': 0.8157915323305984}
[S6] START round=34 head_norm_before_train=1.514835 cos_to_last_merge=0.9978 (last merge round=30)
[S6] round=34 local utility u=0.057858 metrics={'f1_val': 0.7859504164008139, 'auprc': 0.9491203944413054, 'loss_val': 0.5065759377210872, 'psi': 0.8512184076170104}-{'f1_val': 0.7803650620587318, 'auprc': 0.9226465083559668, 'loss_val': 0.5093580845087383, 'psi': 0.8372776405776259}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] sending update (kind=head size=1795 to 1 peers)
[S7] START round=34 head_norm_before_train=1.461537 cos_to_last_merge=0.8297 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.830
[S7] round=34 local utility u=0.000000 metrics={'f1_val': 0.5227939495566657, 'auprc': 0.7805073548529324, 'loss_val': 0.9934995322417324, 'psi': 0.6258793116751724}-{'f1_val': 0.6963736456930072, 'auprc': 0.8616123238905848, 'loss_val': 0.3153405318280674, 'psi': 0.7624691169720382}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=34 head_norm_before_train=2.110187 (no previous merge yet)
[S8] round=34 local utility u=0.000000 metrics={'f1_val': 0.9674134413062678, 'auprc': 0.993128130888829, 'loss_val': 0.09017824277944621, 'psi': 0.9776993171392923}-{'f1_val': 0.994792642153961, 'auprc': 0.9994422193526383, 'loss_val': 0.028401611253830967, 'psi': 0.996652473033432}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=34 head_norm_before_train=1.322530 cos_to_last_merge=1.0000 (last merge round=33)
[S9] round=34 local utility u=0.000000 metrics={'f1_val': 0.9971000495392299, 'auprc': 0.9957822254713989, 'loss_val': 0.08263368014445667, 'psi': 0.9965729199120976}-{'f1_val': 0.9971029125121428, 'auprc': 0.995073259464517, 'loss_val': 0.07478765436799621, 'psi': 0.9962910512930925}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=34 head_norm_before_train=1.940793 cos_to_last_merge=0.7592 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.759
[S10] round=34 local utility u=0.000132 metrics={'f1_val': 0.9935262985458464, 'auprc': 0.9960171457161768, 'loss_val': 0.03133462190454649, 'psi': 0.9945226374139786}-{'f1_val': 0.9935262985458464, 'auprc': 0.9959606129539654, 'loss_val': 0.03142819039129897, 'psi': 0.994500024309094}
[S10] not sending this round → trigger blocked (psi=0.995)
[S11] START round=34 head_norm_before_train=1.428702 cos_to_last_merge=0.9999 (last merge round=32)
[S11] round=34 local utility u=0.006057 metrics={'f1_val': 0.9971593530989756, 'auprc': 0.9992267103305448, 'loss_val': 0.06355067414012952, 'psi': 0.9979862959916033}-{'f1_val': 0.9974011907167429, 'auprc': 0.9992851259961193, 'loss_val': 0.07729108929318901, 'psi': 0.9981547648284935}
[S13] START round=34 head_norm_before_train=1.858191 (no previous merge yet)
[S13] round=34 local utility u=0.509709 metrics={'f1_val': 0.6518731400690978, 'auprc': 0.7862273151023158, 'loss_val': 0.7253223906159741, 'psi': 0.7056148100823849}-{'f1_val': 0.6230188687391448, 'auprc': 0.6023172918742106, 'loss_val': 1.0198849813507675, 'psi': 0.6147382379931712}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=34 head_norm_before_train=1.428287 cos_to_last_merge=1.0000 (last merge round=33)
[S14] round=34 local utility u=0.000000 metrics={'f1_val': 0.9971625532153504, 'auprc': 0.9968719003178312, 'loss_val': 0.07269797359066259, 'psi': 0.9970462920563428}-{'f1_val': 0.9965375310696338, 'auprc': 0.9968753635947825, 'loss_val': 0.06469090955172384, 'psi': 0.9966726640796932}
[S15] START round=34 head_norm_before_train=1.478140 cos_to_last_merge=0.9977 (last merge round=31)
[S15] round=34 local utility u=0.000000 metrics={'f1_val': 0.8218032259115191, 'auprc': 0.9899435772402508, 'loss_val': 0.2737035510252372, 'psi': 0.8890593664430118}-{'f1_val': 0.9915045569729221, 'auprc': 0.9799884504135687, 'loss_val': 0.07905601396265502, 'psi': 0.9868981143491806}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=34 head_norm_before_train=2.029567 (no previous merge yet)
[S16] round=34 local utility u=0.283441 metrics={'f1_val': 0.9926690696961031, 'auprc': 0.9932317659607062, 'loss_val': 0.04862680007631575, 'psi': 0.9928941482019443}-{'f1_val': 0.9385900816189043, 'auprc': 0.9894898361890259, 'loss_val': 0.27980904764287645, 'psi': 0.9589499834469529}
[S16] not sending this round → trigger blocked (psi=0.993)
[S17] START round=34 head_norm_before_train=1.775719 cos_to_last_merge=0.8043 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.804
[S17] round=34 local utility u=0.000000 metrics={'f1_val': 0.7129618580640484, 'auprc': 0.9055727986489202, 'loss_val': 0.8791500280778457, 'psi': 0.7900062342979972}-{'f1_val': 0.7264137916427565, 'auprc': 0.9725488894703614, 'loss_val': 0.775869270125909, 'psi': 0.8248678307737985}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:59814
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1798 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1798) from S11
[S14] cosine check vs S11: cos=0.9993
[S2] START round=35 head_norm_before_train=2.102324 cos_to_last_merge=0.9911 (last merge round=23)
[S2] round=35 local utility u=0.081206 metrics={'f1_val': 0.719240534382955, 'auprc': 0.7282028400764845, 'loss_val': 0.8502699185626054, 'psi': 0.7228254566603668}-{'f1_val': 0.6929330333869695, 'auprc': 0.7318414764810837, 'loss_val': 0.8657526393533713, 'psi': 0.7084964106246152}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=35 head_norm_before_train=2.062360 cos_to_last_merge=0.9999 (last merge round=31)
[S3] round=35 local utility u=0.000000 metrics={'f1_val': 0.9751250658045756, 'auprc': 0.9971599428006561, 'loss_val': 0.05792786437727164, 'psi': 0.9839390166030078}-{'f1_val': 0.9976528558298854, 'auprc': 0.9972538400995156, 'loss_val': 0.02956814871285785, 'psi': 0.9974932495377374}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=35 head_norm_before_train=2.052813 cos_to_last_merge=0.9939 (last merge round=25)
[S4] round=35 local utility u=0.000000 metrics={'f1_val': 0.9413975885690302, 'auprc': 0.9307515552103203, 'loss_val': 0.3103108274606283, 'psi': 0.9371391752255462}-{'f1_val': 0.9582675037568286, 'auprc': 0.9557128331943178, 'loss_val': 0.28495983526371105, 'psi': 0.9572456355318242}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=35 head_norm_before_train=1.357733 cos_to_last_merge=0.9913 (last merge round=30)
[S5] round=35 local utility u=0.464447 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9895206098330268, 'loss_val': 0.30691791563675097, 'psi': 0.816001034393559}-{'f1_val': 0.6439411449092747, 'auprc': 0.8554847181592526, 'loss_val': 0.49542242407891146, 'psi': 0.728558574209266}
[S6] START round=35 head_norm_before_train=1.539363 cos_to_last_merge=0.9967 (last merge round=30)
[S6] round=35 local utility u=0.806725 metrics={'f1_val': 0.9847900668529165, 'auprc': 0.9559997542704162, 'loss_val': 0.10680249315603035, 'psi': 0.9732739418199163}-{'f1_val': 0.7859504164008139, 'auprc': 0.9491203944413054, 'loss_val': 0.5065759377210872, 'psi': 0.8512184076170104}
[S6] not sending this round → trigger blocked (psi=0.973)
[S7] START round=35 head_norm_before_train=1.467128 cos_to_last_merge=0.8290 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.829
[S7] round=35 local utility u=1.000000 metrics={'f1_val': 0.6996115068333676, 'auprc': 0.9471523918429576, 'loss_val': 0.2904535653881648, 'psi': 0.7986278608372036}-{'f1_val': 0.5227939495566657, 'auprc': 0.7805073548529324, 'loss_val': 0.9934995322417324, 'psi': 0.6258793116751724}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] sending update (kind=head size=1797 to 1 peers)
[S8] START round=35 head_norm_before_train=2.118061 (no previous merge yet)
[S8] round=35 local utility u=0.000000 metrics={'f1_val': 0.9520259469792856, 'auprc': 0.991344855579553, 'loss_val': 0.09090767390777761, 'psi': 0.9677535104193926}-{'f1_val': 0.9674134413062678, 'auprc': 0.993128130888829, 'loss_val': 0.09017824277944621, 'psi': 0.9776993171392923}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=35 head_norm_before_train=1.351663 cos_to_last_merge=0.9997 (last merge round=33)
[S9] round=35 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9917677857945189, 'loss_val': 0.07144446449253165, 'psi': 0.9949688618250933}-{'f1_val': 0.9971000495392299, 'auprc': 0.9957822254713989, 'loss_val': 0.08263368014445667, 'psi': 0.9965729199120976}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=35 head_norm_before_train=1.950329 cos_to_last_merge=0.7584 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.758
[S10] round=35 local utility u=0.000000 metrics={'f1_val': 0.9935262985458464, 'auprc': 0.9961339332946977, 'loss_val': 0.03243749348440797, 'psi': 0.9945693524453869}-{'f1_val': 0.9935262985458464, 'auprc': 0.9960171457161768, 'loss_val': 0.03133462190454649, 'psi': 0.9945226374139786}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=35 head_norm_before_train=1.454885 cos_to_last_merge=0.9996 (last merge round=32)
[S11] round=35 local utility u=0.000000 metrics={'f1_val': 0.9589619873687946, 'auprc': 0.9994412278068702, 'loss_val': 0.08374318930771665, 'psi': 0.9751536835440249}-{'f1_val': 0.9971593530989756, 'auprc': 0.9992267103305448, 'loss_val': 0.06355067414012952, 'psi': 0.9979862959916033}
[S13] START round=35 head_norm_before_train=1.864616 (no previous merge yet)
[S13] round=35 local utility u=0.056033 metrics={'f1_val': 0.7099741848081791, 'auprc': 0.7844143950315403, 'loss_val': 0.9564239767682946, 'psi': 0.7397502688975236}-{'f1_val': 0.6518731400690978, 'auprc': 0.7862273151023158, 'loss_val': 0.7253223906159741, 'psi': 0.7056148100823849}
[S13] not sending this round → trigger blocked (psi=0.740)
[S14] START round=35 head_norm_before_train=1.446413 cos_to_last_merge=0.9999 (last merge round=33)
[S14] round=35 local utility u=0.000000 metrics={'f1_val': 0.9457993910193792, 'auprc': 0.99885233556196, 'loss_val': 0.10343852087239275, 'psi': 0.9670205688364114}-{'f1_val': 0.9971625532153504, 'auprc': 0.9968719003178312, 'loss_val': 0.07269797359066259, 'psi': 0.9970462920563428}
[S15] START round=35 head_norm_before_train=1.520996 cos_to_last_merge=0.9958 (last merge round=31)
[S15] round=35 local utility u=0.000000 metrics={'f1_val': 0.808832995216038, 'auprc': 0.9895472581592502, 'loss_val': 0.30070539049366807, 'psi': 0.8811187003933229}-{'f1_val': 0.8218032259115191, 'auprc': 0.9899435772402508, 'loss_val': 0.2737035510252372, 'psi': 0.8890593664430118}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=35 head_norm_before_train=2.036081 (no previous merge yet)
[S16] round=35 local utility u=0.000000 metrics={'f1_val': 0.9310705285235946, 'auprc': 0.9941644991635493, 'loss_val': 0.34499101107394364, 'psi': 0.9563081167795766}-{'f1_val': 0.9926690696961031, 'auprc': 0.9932317659607062, 'loss_val': 0.04862680007631575, 'psi': 0.9928941482019443}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=35 head_norm_before_train=1.791211 cos_to_last_merge=0.8031 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.803
[S17] round=35 local utility u=0.000000 metrics={'f1_val': 0.6886927406344784, 'auprc': 0.990598699470436, 'loss_val': 1.0710948399438989, 'psi': 0.8094551241688615}-{'f1_val': 0.7129618580640484, 'auprc': 0.9055727986489202, 'loss_val': 0.8791500280778457, 'psi': 0.7900062342979972}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S5] → sending delta(kind=head bytes=1806) to S9@127.0.0.1:59810
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] ⇄ pheromone p=0.031 → S14@127.0.0.1:59814
[S5] sending update (kind=head size=1806 to 1 peers)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=35 metric=0.9458 head_norm=1.466563
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.560355e-02
[S14] stored merged vector for next round verification (round=35)
[S14] DEBUG after merge:  round=35 metric=0.9438 head_norm=1.460302 delta_norm=0.035604
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S9] RECEIVED delta(kind=head bytes=1806) from S5
[S9] cosine check vs S5: cos=0.9820
[S5] ⇄ pheromone p=0.216 → S9@127.0.0.1:59810
[S2] START round=36 head_norm_before_train=2.114073 cos_to_last_merge=0.9903 (last merge round=23)
[S2] round=36 local utility u=0.000000 metrics={'f1_val': 0.7183383340099723, 'auprc': 0.7268928960899133, 'loss_val': 0.8583101648879854, 'psi': 0.7217601588419487}-{'f1_val': 0.719240534382955, 'auprc': 0.7282028400764845, 'loss_val': 0.8502699185626054, 'psi': 0.7228254566603668}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=36 head_norm_before_train=2.069691 cos_to_last_merge=0.9998 (last merge round=31)
[S3] round=36 local utility u=0.000000 metrics={'f1_val': 0.9615385219550141, 'auprc': 0.9971621100033656, 'loss_val': 0.08920107692381964, 'psi': 0.9757879571743547}-{'f1_val': 0.9751250658045756, 'auprc': 0.9971599428006561, 'loss_val': 0.05792786437727164, 'psi': 0.9839390166030078}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=36 head_norm_before_train=2.061486 cos_to_last_merge=0.9934 (last merge round=25)
[S4] round=36 local utility u=0.051292 metrics={'f1_val': 0.9527746684082394, 'auprc': 0.9413755581223266, 'loss_val': 0.3078608530510292, 'psi': 0.9482150242938743}-{'f1_val': 0.9413975885690302, 'auprc': 0.9307515552103203, 'loss_val': 0.3103108274606283, 'psi': 0.9371391752255462}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=36 head_norm_before_train=1.381145 cos_to_last_merge=0.9886 (last merge round=30)
[S5] round=36 local utility u=0.000000 metrics={'f1_val': 0.44522120930576453, 'auprc': 0.8526449472889446, 'loss_val': 0.7951536895750767, 'psi': 0.6081907044990366}-{'f1_val': 0.7003213174339138, 'auprc': 0.9895206098330268, 'loss_val': 0.30691791563675097, 'psi': 0.816001034393559}
[S6] START round=36 head_norm_before_train=1.557089 cos_to_last_merge=0.9957 (last merge round=30)
[S6] round=36 local utility u=0.000000 metrics={'f1_val': 0.4471620908611248, 'auprc': 0.7458961096850518, 'loss_val': 1.398910625476808, 'psi': 0.5666556983906956}-{'f1_val': 0.9847900668529165, 'auprc': 0.9559997542704162, 'loss_val': 0.10680249315603035, 'psi': 0.9732739418199163}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=36 head_norm_before_train=1.472694 cos_to_last_merge=0.8285 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.828
[S7] round=36 local utility u=0.000000 metrics={'f1_val': 0.6469262594491977, 'auprc': 0.8020237563802044, 'loss_val': 0.5734097370560735, 'psi': 0.7089652582216004}-{'f1_val': 0.6996115068333676, 'auprc': 0.9471523918429576, 'loss_val': 0.2904535653881648, 'psi': 0.7986278608372036}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=36 head_norm_before_train=2.125401 (no previous merge yet)
[S8] round=36 local utility u=0.158070 metrics={'f1_val': 0.9908755629288465, 'auprc': 0.9994165722718404, 'loss_val': 0.03207966417167368, 'psi': 0.9942919666660441}-{'f1_val': 0.9520259469792856, 'auprc': 0.991344855579553, 'loss_val': 0.09090767390777761, 'psi': 0.9677535104193926}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=36 head_norm_before_train=1.378333 cos_to_last_merge=0.9991 (last merge round=33)
[S9] round=36 local utility u=0.011964 metrics={'f1_val': 0.9975138174234109, 'auprc': 0.9958703424352993, 'loss_val': 0.06228876970482413, 'psi': 0.9968564274281663}-{'f1_val': 0.9971029125121428, 'auprc': 0.9917677857945189, 'loss_val': 0.07144446449253165, 'psi': 0.9949688618250933}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=36 metric=0.9975 head_norm=1.404641
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.418104e-01
[S9] stored merged vector for next round verification (round=36)
[S9] DEBUG after merge:  round=36 metric=0.9975 head_norm=1.385705 delta_norm=0.141810
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S10] START round=36 head_norm_before_train=1.961447 cos_to_last_merge=0.7573 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.757
[S10] round=36 local utility u=0.000211 metrics={'f1_val': 0.9935262985458464, 'auprc': 0.9960663439017649, 'loss_val': 0.03181224659306553, 'psi': 0.9945423166882137}-{'f1_val': 0.9935262985458464, 'auprc': 0.9961339332946977, 'loss_val': 0.03243749348440797, 'psi': 0.9945693524453869}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=36 head_norm_before_train=1.480877 cos_to_last_merge=0.9991 (last merge round=32)
[S11] round=36 local utility u=0.126132 metrics={'f1_val': 0.9971593530989756, 'auprc': 0.9964593233094178, 'loss_val': 0.05171736966550288, 'psi': 0.9968793411831525}-{'f1_val': 0.9589619873687946, 'auprc': 0.9994412278068702, 'loss_val': 0.08374318930771665, 'psi': 0.9751536835440249}
[S13] START round=36 head_norm_before_train=1.868356 (no previous merge yet)
[S13] round=36 local utility u=0.000000 metrics={'f1_val': 0.6403164868446791, 'auprc': 0.6731312004130616, 'loss_val': 0.8910780294445246, 'psi': 0.6534423722720322}-{'f1_val': 0.7099741848081791, 'auprc': 0.7844143950315403, 'loss_val': 0.9564239767682946, 'psi': 0.7397502688975236}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=36 head_norm_before_train=1.460302 cos_to_last_merge=1.0000 (last merge round=35)
[S14] round=36 local utility u=0.173018 metrics={'f1_val': 0.9963796748436982, 'auprc': 0.9990960826961264, 'loss_val': 0.06161606804809369, 'psi': 0.9974662379846695}-{'f1_val': 0.9457993910193792, 'auprc': 0.99885233556196, 'loss_val': 0.10343852087239275, 'psi': 0.9670205688364114}
[S15] START round=36 head_norm_before_train=1.566921 cos_to_last_merge=0.9936 (last merge round=31)
[S15] round=36 local utility u=0.000000 metrics={'f1_val': 0.7169562166933309, 'auprc': 0.9846147658966152, 'loss_val': 0.45354454938385463, 'psi': 0.8240196363746446}-{'f1_val': 0.808832995216038, 'auprc': 0.9895472581592502, 'loss_val': 0.30070539049366807, 'psi': 0.8811187003933229}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=36 head_norm_before_train=2.044396 (no previous merge yet)
[S16] round=36 local utility u=0.000000 metrics={'f1_val': 0.926100321297082, 'auprc': 0.9945133996334607, 'loss_val': 0.3846474023724852, 'psi': 0.9534655526316336}-{'f1_val': 0.9310705285235946, 'auprc': 0.9941644991635493, 'loss_val': 0.34499101107394364, 'psi': 0.9563081167795766}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=36 head_norm_before_train=1.801219 cos_to_last_merge=0.8021 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.802
[S17] round=36 local utility u=0.190342 metrics={'f1_val': 0.7254598989212719, 'auprc': 0.9781881851771137, 'loss_val': 0.8737813952683263, 'psi': 0.8265512134236086}-{'f1_val': 0.6886927406344784, 'auprc': 0.990598699470436, 'loss_val': 1.0710948399438989, 'psi': 0.8094551241688615}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:59814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:59812
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1802) from S14
[S11] cosine check vs S14: cos=0.9988
[S14] RECEIVED delta(kind=head bytes=1799) from S11
[S14] cosine check vs S11: cos=0.9988
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=36 metric=0.9972 head_norm=1.501337
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.774785e-02
[S11] stored merged vector for next round verification (round=36)
[S11] DEBUG after merge:  round=36 metric=0.9972 head_norm=1.491008 delta_norm=0.037748
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=36 metric=0.9964 head_norm=1.481570
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.774786e-02
[S14] stored merged vector for next round verification (round=36)
[S14] DEBUG after merge:  round=36 metric=0.9964 head_norm=1.491008 delta_norm=0.037748
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=37 head_norm_before_train=2.123825 cos_to_last_merge=0.9896 (last merge round=23)
[S2] round=37 local utility u=0.000000 metrics={'f1_val': 0.6974702358727428, 'auprc': 0.7261435529767275, 'loss_val': 0.8901893324608955, 'psi': 0.7089395627143367}-{'f1_val': 0.7183383340099723, 'auprc': 0.7268928960899133, 'loss_val': 0.8583101648879854, 'psi': 0.7217601588419487}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=37 head_norm_before_train=2.078974 cos_to_last_merge=0.9997 (last merge round=31)
[S3] round=37 local utility u=0.000000 metrics={'f1_val': 0.9615385219550141, 'auprc': 0.9976783785187558, 'loss_val': 0.09980897556394439, 'psi': 0.9759944645805109}-{'f1_val': 0.9615385219550141, 'auprc': 0.9971621100033656, 'loss_val': 0.08920107692381964, 'psi': 0.9757879571743547}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=37 head_norm_before_train=2.070519 cos_to_last_merge=0.9929 (last merge round=25)
[S4] round=37 local utility u=0.000000 metrics={'f1_val': 0.9469147054195678, 'auprc': 0.9110141300944422, 'loss_val': 0.3148608846514084, 'psi': 0.9325544752895176}-{'f1_val': 0.9527746684082394, 'auprc': 0.9413755581223266, 'loss_val': 0.3078608530510292, 'psi': 0.9482150242938743}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=37 head_norm_before_train=1.397398 cos_to_last_merge=0.9867 (last merge round=30)
[S5] round=37 local utility u=0.550693 metrics={'f1_val': 0.5762537864653074, 'auprc': 0.858704455815281, 'loss_val': 0.49814092185976755, 'psi': 0.6892340542052968}-{'f1_val': 0.44522120930576453, 'auprc': 0.8526449472889446, 'loss_val': 0.7951536895750767, 'psi': 0.6081907044990366}
[S6] START round=37 head_norm_before_train=1.568578 cos_to_last_merge=0.9950 (last merge round=30)
[S6] round=37 local utility u=1.000000 metrics={'f1_val': 0.7383049178529768, 'auprc': 0.7876501820733588, 'loss_val': 0.6366664378065915, 'psi': 0.7580430235411296}-{'f1_val': 0.4471620908611248, 'auprc': 0.7458961096850518, 'loss_val': 1.398910625476808, 'psi': 0.5666556983906956}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S6] sending update (kind=head size=1792 to 1 peers)
[S7] START round=37 head_norm_before_train=1.477585 cos_to_last_merge=0.8277 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.828
[S7] round=37 local utility u=0.090436 metrics={'f1_val': 0.6653142346947757, 'auprc': 0.804278651628662, 'loss_val': 0.5096306486411701, 'psi': 0.7209000014683302}-{'f1_val': 0.6469262594491977, 'auprc': 0.8020237563802044, 'loss_val': 0.5734097370560735, 'psi': 0.7089652582216004}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] sending update (kind=head size=1806 to 1 peers)
[S8] START round=37 head_norm_before_train=2.133075 (no previous merge yet)
[S8] round=37 local utility u=0.000000 metrics={'f1_val': 0.9882230176651405, 'auprc': 0.9957641924627961, 'loss_val': 0.03666303841340207, 'psi': 0.9912394875842028}-{'f1_val': 0.9908755629288465, 'auprc': 0.9994165722718404, 'loss_val': 0.03207966417167368, 'psi': 0.9942919666660441}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=37 head_norm_before_train=1.385705 cos_to_last_merge=1.0000 (last merge round=36)
[S9] round=37 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.994691132403891, 'loss_val': 0.06929264984938498, 'psi': 0.996138200468842}-{'f1_val': 0.9975138174234109, 'auprc': 0.9958703424352993, 'loss_val': 0.06228876970482413, 'psi': 0.9968564274281663}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=37 head_norm_before_train=1.972926 cos_to_last_merge=0.7561 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.756
[S10] round=37 local utility u=0.000000 metrics={'f1_val': 0.9935262985458464, 'auprc': 0.9960129149341297, 'loss_val': 0.03218869962251398, 'psi': 0.9945209451011596}-{'f1_val': 0.9935262985458464, 'auprc': 0.9960663439017649, 'loss_val': 0.03181224659306553, 'psi': 0.9945423166882137}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=37 head_norm_before_train=1.491008 cos_to_last_merge=1.0000 (last merge round=36)
[S11] round=37 local utility u=0.003997 metrics={'f1_val': 0.9974011907167429, 'auprc': 0.9984347584989439, 'loss_val': 0.05110051099716474, 'psi': 0.9978146178296233}-{'f1_val': 0.9971593530989756, 'auprc': 0.9964593233094178, 'loss_val': 0.05171736966550288, 'psi': 0.9968793411831525}
[S13] START round=37 head_norm_before_train=1.876941 (no previous merge yet)
[S13] round=37 local utility u=0.037323 metrics={'f1_val': 0.664578989818943, 'auprc': 0.7083950888373247, 'loss_val': 1.0677985237006327, 'psi': 0.6821054294262957}-{'f1_val': 0.6403164868446791, 'auprc': 0.6731312004130616, 'loss_val': 0.8910780294445246, 'psi': 0.6534423722720322}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=37 head_norm_before_train=1.491008 cos_to_last_merge=1.0000 (last merge round=36)
[S14] round=37 local utility u=0.000000 metrics={'f1_val': 0.9309753195940609, 'auprc': 0.988919191810792, 'loss_val': 0.17050196748915986, 'psi': 0.9541528684807533}-{'f1_val': 0.9963796748436982, 'auprc': 0.9990960826961264, 'loss_val': 0.06161606804809369, 'psi': 0.9974662379846695}
[S15] START round=37 head_norm_before_train=1.607545 cos_to_last_merge=0.9915 (last merge round=31)
[S15] round=37 local utility u=1.000000 metrics={'f1_val': 0.9935098480872134, 'auprc': 0.9942914323732152, 'loss_val': 0.041426650994101755, 'psi': 0.9938224818016141}-{'f1_val': 0.7169562166933309, 'auprc': 0.9846147658966152, 'loss_val': 0.45354454938385463, 'psi': 0.8240196363746446}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=37 head_norm_before_train=2.054802 (no previous merge yet)
[S16] round=37 local utility u=0.000000 metrics={'f1_val': 0.892915035529285, 'auprc': 0.987698613405862, 'loss_val': 0.5390817839134565, 'psi': 0.9308284666799158}-{'f1_val': 0.926100321297082, 'auprc': 0.9945133996334607, 'loss_val': 0.3846474023724852, 'psi': 0.9534655526316336}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=37 head_norm_before_train=1.809043 cos_to_last_merge=0.8015 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.802
[S17] round=37 local utility u=0.951460 metrics={'f1_val': 0.9223895120479171, 'auprc': 0.9884099250673535, 'loss_val': 0.18310429816027624, 'psi': 0.9487976772556916}-{'f1_val': 0.7254598989212719, 'auprc': 0.9781881851771137, 'loss_val': 0.8737813952683263, 'psi': 0.8265512134236086}
[S17] not sending this round → trigger blocked (psi=0.949)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:59810
[S11] not sending this round → trigger blocked (psi=0.998)
[S5] sending update (kind=head size=1800 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1800) from S5
[S9] cosine check vs S5: cos=0.9907
[S2] START round=38 head_norm_before_train=2.133070 cos_to_last_merge=0.9889 (last merge round=23)
[S2] round=38 local utility u=0.000000 metrics={'f1_val': 0.6491151875083057, 'auprc': 0.7337293154340938, 'loss_val': 1.1618975440488544, 'psi': 0.682960838678621}-{'f1_val': 0.6974702358727428, 'auprc': 0.7261435529767275, 'loss_val': 0.8901893324608955, 'psi': 0.7089395627143367}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=38 head_norm_before_train=2.088604 cos_to_last_merge=0.9996 (last merge round=31)
[S3] round=38 local utility u=0.073878 metrics={'f1_val': 0.9794915777741575, 'auprc': 0.9975591946553828, 'loss_val': 0.05941300348535279, 'psi': 0.9867186245266477}-{'f1_val': 0.9615385219550141, 'auprc': 0.9976783785187558, 'loss_val': 0.09980897556394439, 'psi': 0.9759944645805109}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] sending update (kind=head size=1803 to 1 peers)
[S4] START round=38 head_norm_before_train=2.068244 cos_to_last_merge=0.9927 (last merge round=25)
[S4] round=38 local utility u=0.073935 metrics={'f1_val': 0.9534967469800686, 'auprc': 0.9422807199869377, 'loss_val': 0.3002833705042424, 'psi': 0.9490103361828162}-{'f1_val': 0.9469147054195678, 'auprc': 0.9110141300944422, 'loss_val': 0.3148608846514084, 'psi': 0.9325544752895176}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S4] sending update (kind=head size=1806 to 1 peers)
[S5] START round=38 head_norm_before_train=1.411992 cos_to_last_merge=0.9850 (last merge round=30)
[S5] round=38 local utility u=0.702714 metrics={'f1_val': 0.700407554886547, 'auprc': 0.9856931735979412, 'loss_val': 0.2186021343939794, 'psi': 0.8145218023711047}-{'f1_val': 0.5762537864653074, 'auprc': 0.858704455815281, 'loss_val': 0.49814092185976755, 'psi': 0.6892340542052968}
[S6] START round=38 head_norm_before_train=1.579525 cos_to_last_merge=0.9945 (last merge round=30)
[S6] round=38 local utility u=0.179793 metrics={'f1_val': 0.7748494197610921, 'auprc': 0.8026316516385745, 'loss_val': 0.541291465263777, 'psi': 0.785962312512085}-{'f1_val': 0.7383049178529768, 'auprc': 0.7876501820733588, 'loss_val': 0.6366664378065915, 'psi': 0.7580430235411296}
[S6] not sending this round → trigger blocked (psi=0.786)
[S7] START round=38 head_norm_before_train=1.480899 cos_to_last_merge=0.8270 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.827
[S7] round=38 local utility u=0.000000 metrics={'f1_val': 0.5871125339256412, 'auprc': 0.7858371324272484, 'loss_val': 0.7283537768498005, 'psi': 0.666602373326284}-{'f1_val': 0.6653142346947757, 'auprc': 0.804278651628662, 'loss_val': 0.5096306486411701, 'psi': 0.7209000014683302}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=38 head_norm_before_train=2.139470 (no previous merge yet)
[S8] round=38 local utility u=0.029782 metrics={'f1_val': 0.9944672019690619, 'auprc': 0.999598969576333, 'loss_val': 0.026068880139172575, 'psi': 0.9965199090119703}-{'f1_val': 0.9882230176651405, 'auprc': 0.9957641924627961, 'loss_val': 0.03666303841340207, 'psi': 0.9912394875842028}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] START round=38 head_norm_before_train=1.411190 cos_to_last_merge=0.9998 (last merge round=36)
[S9] round=38 local utility u=0.005690 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9956066296323833, 'loss_val': 0.06065990573744388, 'psi': 0.996504399360239}-{'f1_val': 0.9971029125121428, 'auprc': 0.994691132403891, 'loss_val': 0.06929264984938498, 'psi': 0.996138200468842}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=38 metric=0.9971 head_norm=1.436555
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.085676e-01
[S9] stored merged vector for next round verification (round=38)
[S9] DEBUG after merge:  round=38 metric=0.9971 head_norm=1.420183 delta_norm=0.108568
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S10] START round=38 head_norm_before_train=1.981524 cos_to_last_merge=0.7553 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.755
[S10] round=38 local utility u=0.000387 metrics={'f1_val': 0.9935262985458464, 'auprc': 0.995917525080805, 'loss_val': 0.031128491436716164, 'psi': 0.9944827891598298}-{'f1_val': 0.9935262985458464, 'auprc': 0.9960129149341297, 'loss_val': 0.03218869962251398, 'psi': 0.9945209451011596}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=38 head_norm_before_train=1.509503 cos_to_last_merge=1.0000 (last merge round=36)
[S11] round=38 local utility u=0.001122 metrics={'f1_val': 0.9982515059399775, 'auprc': 0.9994071794304237, 'loss_val': 0.05687585242532621, 'psi': 0.998713775336156}-{'f1_val': 0.9974011907167429, 'auprc': 0.9984347584989439, 'loss_val': 0.05110051099716474, 'psi': 0.9978146178296233}
[S13] START round=38 head_norm_before_train=1.891150 (no previous merge yet)
[S13] round=38 local utility u=0.000000 metrics={'f1_val': 0.6456845024014628, 'auprc': 0.6650801993782618, 'loss_val': 0.9457169374667748, 'psi': 0.6534427811921824}-{'f1_val': 0.664578989818943, 'auprc': 0.7083950888373247, 'loss_val': 1.0677985237006327, 'psi': 0.6821054294262957}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=38 head_norm_before_train=1.508509 cos_to_last_merge=0.9999 (last merge round=36)
[S14] round=38 local utility u=0.270873 metrics={'f1_val': 0.996754531653698, 'auprc': 0.9977023669744333, 'loss_val': 0.04978136510633824, 'psi': 0.9971336657819921}-{'f1_val': 0.9309753195940609, 'auprc': 0.988919191810792, 'loss_val': 0.17050196748915986, 'psi': 0.9541528684807533}
[S15] START round=38 head_norm_before_train=1.643283 cos_to_last_merge=0.9895 (last merge round=31)
[S15] round=38 local utility u=0.000000 metrics={'f1_val': 0.7723165326970965, 'auprc': 0.9818547748864636, 'loss_val': 0.4542548735991549, 'psi': 0.8561318295728434}-{'f1_val': 0.9935098480872134, 'auprc': 0.9942914323732152, 'loss_val': 0.041426650994101755, 'psi': 0.9938224818016141}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=38 head_norm_before_train=2.062223 (no previous merge yet)
[S16] round=38 local utility u=0.516485 metrics={'f1_val': 0.9834419425021576, 'auprc': 0.9934930233304422, 'loss_val': 0.06665577529035194, 'psi': 0.9874623748334714}-{'f1_val': 0.892915035529285, 'auprc': 0.987698613405862, 'loss_val': 0.5390817839134565, 'psi': 0.9308284666799158}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S16] sending update (kind=head size=1792 to 1 peers)
[S17] START round=38 head_norm_before_train=1.818579 cos_to_last_merge=0.8008 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.801
[S17] round=38 local utility u=0.000000 metrics={'f1_val': 0.7177209429828177, 'auprc': 0.9790778338784658, 'loss_val': 0.9386497331594046, 'psi': 0.822263699341077}-{'f1_val': 0.9223895120479171, 'auprc': 0.9884099250673535, 'loss_val': 0.18310429816027624, 'psi': 0.9487976772556916}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.815)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:59812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S11] → sending delta(kind=head bytes=1807) to S14@127.0.0.1:59814
[S14] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1807 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1807) from S11
[S14] cosine check vs S11: cos=0.9995
[S11] RECEIVED delta(kind=head bytes=1801) from S14
[S11] cosine check vs S14: cos=0.9995
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=38 metric=0.9983 head_norm=1.528548
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.309735e-02
[S11] stored merged vector for next round verification (round=38)
[S11] DEBUG after merge:  round=38 metric=0.9983 head_norm=1.526011 delta_norm=0.023097
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=38 metric=0.9968 head_norm=1.523819
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.309735e-02
[S14] stored merged vector for next round verification (round=38)
[S14] DEBUG after merge:  round=38 metric=0.9968 head_norm=1.526011 delta_norm=0.023097
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=39 head_norm_before_train=2.140728 cos_to_last_merge=0.9883 (last merge round=23)
[S2] round=39 local utility u=0.219324 metrics={'f1_val': 0.6993862250700358, 'auprc': 0.726337148906574, 'loss_val': 1.0026993942131095, 'psi': 0.710166594604651}-{'f1_val': 0.6491151875083057, 'auprc': 0.7337293154340938, 'loss_val': 1.1618975440488544, 'psi': 0.682960838678621}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S2] r=40 psi=0.710 u=0.2193 p_local=0.0558 f1=0.699 auprc=0.726 bytes=32370
[S3] START round=39 head_norm_before_train=2.096949 cos_to_last_merge=0.9995 (last merge round=31)
[S3] round=39 local utility u=0.068830 metrics={'f1_val': 0.9973696976584205, 'auprc': 0.9971678086984794, 'loss_val': 0.027847818511666518, 'psi': 0.9972889420744441}-{'f1_val': 0.9794915777741575, 'auprc': 0.9975591946553828, 'loss_val': 0.05941300348535279, 'psi': 0.9867186245266477}
[S3] not sending this round → trigger blocked (psi=0.997)
[S3] r=40 psi=0.997 u=0.0688 p_local=0.0504 f1=0.997 auprc=0.997 bytes=37766
[S4] START round=39 head_norm_before_train=2.066068 cos_to_last_merge=0.9922 (last merge round=25)
[S4] round=39 local utility u=0.013321 metrics={'f1_val': 0.9545566754815316, 'auprc': 0.9476383350767101, 'loss_val': 0.29607324941795626, 'psi': 0.9517893393196031}-{'f1_val': 0.9534967469800686, 'auprc': 0.9422807199869377, 'loss_val': 0.3002833705042424, 'psi': 0.9490103361828162}
[S4] not sending this round → trigger blocked (psi=0.952)
[S4] r=40 psi=0.952 u=0.0133 p_local=0.0276 f1=0.955 auprc=0.948 bytes=41424
[S5] START round=39 head_norm_before_train=1.425052 cos_to_last_merge=0.9836 (last merge round=30)
[S5] round=39 local utility u=0.000000 metrics={'f1_val': 0.7004932948021524, 'auprc': 0.949530845761726, 'loss_val': 0.33615425685490374, 'psi': 0.8001083151859818}-{'f1_val': 0.700407554886547, 'auprc': 0.9856931735979412, 'loss_val': 0.2186021343939794, 'psi': 0.8145218023711047}
[S6] START round=39 head_norm_before_train=1.597792 cos_to_last_merge=0.9937 (last merge round=30)
[S6] round=39 local utility u=0.987692 metrics={'f1_val': 0.9625260690119526, 'auprc': 0.9521210922259304, 'loss_val': 0.14043577107261632, 'psi': 0.9583640782975437}-{'f1_val': 0.7748494197610921, 'auprc': 0.8026316516385745, 'loss_val': 0.541291465263777, 'psi': 0.785962312512085}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S6] r=40 psi=0.958 u=0.9877 p_local=0.4975 f1=0.963 auprc=0.952 bytes=35999
[S7] START round=39 head_norm_before_train=1.486672 cos_to_last_merge=0.8258 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.826
[S7] round=39 local utility u=0.376994 metrics={'f1_val': 0.6552619446755863, 'auprc': 0.8061584873850507, 'loss_val': 0.4442263372498321, 'psi': 0.715620561759372}-{'f1_val': 0.5871125339256412, 'auprc': 0.7858371324272484, 'loss_val': 0.7283537768498005, 'psi': 0.666602373326284}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S7] r=40 psi=0.716 u=0.3770 p_local=0.2519 f1=0.655 auprc=0.806 bytes=32382
[S8] START round=39 head_norm_before_train=2.145859 (no previous merge yet)
[S8] round=39 local utility u=0.000000 metrics={'f1_val': 0.9944672019690619, 'auprc': 0.9994274585711822, 'loss_val': 0.026021532884189482, 'psi': 0.9964513046099099}-{'f1_val': 0.9944672019690619, 'auprc': 0.999598969576333, 'loss_val': 0.026068880139172575, 'psi': 0.9965199090119703}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] r=40 psi=0.996 u=0.0000 p_local=0.0598 f1=0.994 auprc=0.999 bytes=32386
[S9] START round=39 head_norm_before_train=1.420183 cos_to_last_merge=1.0000 (last merge round=38)
[S9] round=39 local utility u=0.001125 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9983860220439036, 'loss_val': 0.06674884715792781, 'psi': 0.9976161563248471}-{'f1_val': 0.9971029125121428, 'auprc': 0.9956066296323833, 'loss_val': 0.06065990573744388, 'psi': 0.996504399360239}
[S9] not sending this round → trigger blocked (psi=0.998)
[S9] r=40 psi=0.998 u=0.0011 p_local=0.0252 f1=0.997 auprc=0.998 bytes=43110
[S10] START round=39 head_norm_before_train=1.984702 cos_to_last_merge=0.7552 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.755
[S10] round=39 local utility u=0.001078 metrics={'f1_val': 0.9937871219080217, 'auprc': 0.9959700312572417, 'loss_val': 0.030695314955096604, 'psi': 0.9946602856477097}-{'f1_val': 0.9935262985458464, 'auprc': 0.995917525080805, 'loss_val': 0.031128491436716164, 'psi': 0.9944827891598298}
[S10] not sending this round → trigger blocked (psi=0.995)
[S10] r=40 psi=0.995 u=0.0011 p_local=0.0012 f1=0.994 auprc=0.996 bytes=39668
[S11] START round=39 head_norm_before_train=1.526011 cos_to_last_merge=1.0000 (last merge round=38)
[S11] round=39 local utility u=0.001773 metrics={'f1_val': 0.9971593530989756, 'auprc': 0.9991698241924198, 'loss_val': 0.046064802386432645, 'psi': 0.9979635415363534}-{'f1_val': 0.9982515059399775, 'auprc': 0.9994071794304237, 'loss_val': 0.05687585242532621, 'psi': 0.998713775336156}
[S13] START round=39 head_norm_before_train=1.902101 (no previous merge yet)
[S13] round=39 local utility u=0.675633 metrics={'f1_val': 0.768371645576142, 'auprc': 0.7616731382137386, 'loss_val': 0.6203522784964403, 'psi': 0.7656922426311807}-{'f1_val': 0.6456845024014628, 'auprc': 0.6650801993782618, 'loss_val': 0.9457169374667748, 'psi': 0.6534427811921824}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S13] r=40 psi=0.766 u=0.6756 p_local=0.1953 f1=0.768 auprc=0.762 bytes=32427
[S14] START round=39 head_norm_before_train=1.526011 cos_to_last_merge=1.0000 (last merge round=38)
[S14] round=39 local utility u=0.000000 metrics={'f1_val': 0.9965603779504312, 'auprc': 0.9959956466026897, 'loss_val': 0.05046661015166218, 'psi': 0.9963344854113346}-{'f1_val': 0.996754531653698, 'auprc': 0.9977023669744333, 'loss_val': 0.04978136510633824, 'psi': 0.9971336657819921}
[S15] START round=39 head_norm_before_train=1.673039 cos_to_last_merge=0.9879 (last merge round=31)
[S15] round=39 local utility u=0.000000 metrics={'f1_val': 0.7000668369851027, 'auprc': 0.9013201148534652, 'loss_val': 0.5626724467169842, 'psi': 0.7805681481324478}-{'f1_val': 0.7723165326970965, 'auprc': 0.9818547748864636, 'loss_val': 0.4542548735991549, 'psi': 0.8561318295728434}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] r=40 psi=0.781 u=0.0000 p_local=0.2242 f1=0.700 auprc=0.901 bytes=32397
[S16] START round=39 head_norm_before_train=2.069302 (no previous merge yet)
[S16] round=39 local utility u=0.042562 metrics={'f1_val': 0.9922305443892377, 'auprc': 0.9948692210231912, 'loss_val': 0.038391287689772464, 'psi': 0.9932860150428191}-{'f1_val': 0.9834419425021576, 'auprc': 0.9934930233304422, 'loss_val': 0.06665577529035194, 'psi': 0.9874623748334714}
[S16] not sending this round → trigger blocked (psi=0.993)
[S16] r=40 psi=0.993 u=0.0426 p_local=0.1175 f1=0.992 auprc=0.995 bytes=37748
[S17] START round=39 head_norm_before_train=1.830351 cos_to_last_merge=0.8000 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.800
[S17] round=39 local utility u=0.299946 metrics={'f1_val': 0.7381116099188445, 'auprc': 0.9939312333308522, 'loss_val': 0.5056621941220523, 'psi': 0.8404394592836476}-{'f1_val': 0.7177209429828177, 'auprc': 0.9790778338784658, 'loss_val': 0.9386497331594046, 'psi': 0.822263699341077}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S17] r=40 psi=0.840 u=0.2999 p_local=0.2199 f1=0.738 auprc=0.994 bytes=34182
[S11] not sending this round → trigger blocked (psi=0.998)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=40 psi=0.996 u=0.0000 p_local=0.0668 f1=0.997 auprc=0.996 bytes=41309
[S11] r=40 psi=0.998 u=0.0018 p_local=0.0269 f1=0.997 auprc=0.999 bytes=41356
[S5] r=40 psi=0.800 u=0.0000 p_local=0.2713 f1=0.700 auprc=0.950 bytes=30574
[S2] START round=40 head_norm_before_train=2.146440 cos_to_last_merge=0.9879 (last merge round=23)
[S2] round=40 local utility u=0.148073 metrics={'f1_val': 0.7203094759848999, 'auprc': 0.7333341857270189, 'loss_val': 0.8530833396034673, 'psi': 0.7255193598817475}-{'f1_val': 0.6993862250700358, 'auprc': 0.726337148906574, 'loss_val': 1.0026993942131095, 'psi': 0.710166594604651}
[S2] not sending this round → trigger blocked (psi=0.726)
[S3] START round=40 head_norm_before_train=2.105611 cos_to_last_merge=0.9993 (last merge round=31)
[S3] round=40 local utility u=0.000000 metrics={'f1_val': 0.9846966392084899, 'auprc': 0.997560470485512, 'loss_val': 0.04940067281038776, 'psi': 0.9898421717192988}-{'f1_val': 0.9973696976584205, 'auprc': 0.9971678086984794, 'loss_val': 0.027847818511666518, 'psi': 0.9972889420744441}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=40 head_norm_before_train=2.067407 cos_to_last_merge=0.9919 (last merge round=25)
[S4] round=40 local utility u=0.000000 metrics={'f1_val': 0.9418626855778922, 'auprc': 0.9249943934759827, 'loss_val': 0.3207130198188124, 'psi': 0.9351153687371284}-{'f1_val': 0.9545566754815316, 'auprc': 0.9476383350767101, 'loss_val': 0.29607324941795626, 'psi': 0.9517893393196031}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=40 head_norm_before_train=1.438128 cos_to_last_merge=0.9821 (last merge round=30)
[S5] round=40 local utility u=0.000000 metrics={'f1_val': 0.6687800963575261, 'auprc': 0.8744671470610403, 'loss_val': 0.41347516043891314, 'psi': 0.7510549166389318}-{'f1_val': 0.7004932948021524, 'auprc': 0.949530845761726, 'loss_val': 0.33615425685490374, 'psi': 0.8001083151859818}
[S6] START round=40 head_norm_before_train=1.615476 cos_to_last_merge=0.9929 (last merge round=30)
[S6] round=40 local utility u=0.000000 metrics={'f1_val': 0.7431479859585586, 'auprc': 0.907151197001391, 'loss_val': 0.6625412390232648, 'psi': 0.8087492703756916}-{'f1_val': 0.9625260690119526, 'auprc': 0.9521210922259304, 'loss_val': 0.14043577107261632, 'psi': 0.9583640782975437}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=40 head_norm_before_train=1.493182 cos_to_last_merge=0.8248 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.825
[S7] round=40 local utility u=0.000000 metrics={'f1_val': 0.6358671419666866, 'auprc': 0.8036792646746252, 'loss_val': 0.48275445429701935, 'psi': 0.7029919910498621}-{'f1_val': 0.6552619446755863, 'auprc': 0.8061584873850507, 'loss_val': 0.4442263372498321, 'psi': 0.715620561759372}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=40 head_norm_before_train=2.154679 (no previous merge yet)
[S8] round=40 local utility u=0.000000 metrics={'f1_val': 0.9720486500914776, 'auprc': 0.9992829335408683, 'loss_val': 0.07316909800350815, 'psi': 0.9829423634712338}-{'f1_val': 0.9944672019690619, 'auprc': 0.9994274585711822, 'loss_val': 0.026021532884189482, 'psi': 0.9964513046099099}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=40 head_norm_before_train=1.444029 cos_to_last_merge=0.9998 (last merge round=38)
[S9] round=40 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9958445744283848, 'loss_val': 0.059178060419162244, 'psi': 0.9965995772786396}-{'f1_val': 0.9971029125121428, 'auprc': 0.9983860220439036, 'loss_val': 0.06674884715792781, 'psi': 0.9976161563248471}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=40 head_norm_before_train=1.991123 cos_to_last_merge=0.7546 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.755
[S10] round=40 local utility u=0.000000 metrics={'f1_val': 0.9935262985458464, 'auprc': 0.9960301915328276, 'loss_val': 0.0312888290366541, 'psi': 0.9945278557406388}-{'f1_val': 0.9937871219080217, 'auprc': 0.9959700312572417, 'loss_val': 0.030695314955096604, 'psi': 0.9946602856477097}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=40 head_norm_before_train=1.545528 cos_to_last_merge=1.0000 (last merge round=38)
[S11] round=40 local utility u=0.001746 metrics={'f1_val': 0.9982515059399775, 'auprc': 0.9994485174391788, 'loss_val': 0.04996112302190195, 'psi': 0.9987303105396581}-{'f1_val': 0.9971593530989756, 'auprc': 0.9991698241924198, 'loss_val': 0.046064802386432645, 'psi': 0.9979635415363534}
[S13] START round=40 head_norm_before_train=1.910888 (no previous merge yet)
[S13] round=40 local utility u=0.000000 metrics={'f1_val': 0.6557266775411786, 'auprc': 0.6643845973079856, 'loss_val': 1.0516229421600214, 'psi': 0.6591898454479015}-{'f1_val': 0.768371645576142, 'auprc': 0.7616731382137386, 'loss_val': 0.6203522784964403, 'psi': 0.7656922426311807}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=40 head_norm_before_train=1.543079 cos_to_last_merge=0.9999 (last merge round=38)
[S14] round=40 local utility u=0.005114 metrics={'f1_val': 0.9967577367102773, 'auprc': 0.996871331320482, 'loss_val': 0.04404914244744612, 'psi': 0.9968031745543593}-{'f1_val': 0.9965603779504312, 'auprc': 0.9959956466026897, 'loss_val': 0.05046661015166218, 'psi': 0.9963344854113346}
[S15] START round=40 head_norm_before_train=1.694485 cos_to_last_merge=0.9868 (last merge round=31)
[S15] round=40 local utility u=1.000000 metrics={'f1_val': 0.9873143388184789, 'auprc': 0.9788177600605015, 'loss_val': 0.07186079298358668, 'psi': 0.983915707315288}-{'f1_val': 0.7000668369851027, 'auprc': 0.9013201148534652, 'loss_val': 0.5626724467169842, 'psi': 0.7805681481324478}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=40 head_norm_before_train=2.075325 (no previous merge yet)
[S16] round=40 local utility u=0.001175 metrics={'f1_val': 0.9924497697178112, 'auprc': 0.9951338811281745, 'loss_val': 0.03815112242924684, 'psi': 0.9935234142819566}-{'f1_val': 0.9922305443892377, 'auprc': 0.9948692210231912, 'loss_val': 0.038391287689772464, 'psi': 0.9932860150428191}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=40 head_norm_before_train=1.839544 cos_to_last_merge=0.7990 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.799
[S17] round=40 local utility u=0.000000 metrics={'f1_val': 0.7010070416552427, 'auprc': 0.970939622564907, 'loss_val': 1.0578219822913877, 'psi': 0.8089800740191084}-{'f1_val': 0.7381116099188445, 'auprc': 0.9939312333308522, 'loss_val': 0.5056621941220523, 'psi': 0.8404394592836476}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:59814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S11@127.0.0.1:59812
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] ⇄ pheromone p=0.217 → S9@127.0.0.1:59810
[S11] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1803) from S14
[S11] cosine check vs S14: cos=0.9997
[S14] RECEIVED delta(kind=head bytes=1802) from S11
[S14] cosine check vs S11: cos=0.9997
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=40 metric=0.9983 head_norm=1.562747
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.057157e-02
[S11] stored merged vector for next round verification (round=40)
[S11] DEBUG after merge:  round=40 metric=0.9983 head_norm=1.561494 delta_norm=0.020572
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.022 → S14@127.0.0.1:59814
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=40 metric=0.9968 head_norm=1.560512
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.057157e-02
[S14] stored merged vector for next round verification (round=40)
[S14] DEBUG after merge:  round=40 metric=0.9968 head_norm=1.561494 delta_norm=0.020572
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.054 → S11@127.0.0.1:59812
[S2] START round=41 head_norm_before_train=2.150430 cos_to_last_merge=0.9877 (last merge round=23)
[S2] round=41 local utility u=0.006088 metrics={'f1_val': 0.7209101029520019, 'auprc': 0.7356336631796185, 'loss_val': 0.8514088035989468, 'psi': 0.7267995270430485}-{'f1_val': 0.7203094759848999, 'auprc': 0.7333341857270189, 'loss_val': 0.8530833396034673, 'psi': 0.7255193598817475}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=41 head_norm_before_train=2.113533 cos_to_last_merge=0.9992 (last merge round=31)
[S3] round=41 local utility u=0.000000 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.9566395571708919, 'loss_val': 0.16231482989946858, 'psi': 0.9592769735316229}-{'f1_val': 0.9846966392084899, 'auprc': 0.997560470485512, 'loss_val': 0.04940067281038776, 'psi': 0.9898421717192988}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=41 head_norm_before_train=2.075889 cos_to_last_merge=0.9916 (last merge round=25)
[S4] round=41 local utility u=0.000152 metrics={'f1_val': 0.9414267407783846, 'auprc': 0.9273738675024749, 'loss_val': 0.3249308539791298, 'psi': 0.9358055914680208}-{'f1_val': 0.9418626855778922, 'auprc': 0.9249943934759827, 'loss_val': 0.3207130198188124, 'psi': 0.9351153687371284}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=41 head_norm_before_train=1.449081 cos_to_last_merge=0.9809 (last merge round=30)
[S5] round=41 local utility u=0.000000 metrics={'f1_val': 0.561650128356294, 'auprc': 0.8551699440539839, 'loss_val': 0.6325235289815838, 'psi': 0.67905805463537}-{'f1_val': 0.6687800963575261, 'auprc': 0.8744671470610403, 'loss_val': 0.41347516043891314, 'psi': 0.7510549166389318}
[S6] START round=41 head_norm_before_train=1.626305 cos_to_last_merge=0.9923 (last merge round=30)
[S6] round=41 local utility u=0.503438 metrics={'f1_val': 0.846619536768255, 'auprc': 0.946875474150979, 'loss_val': 0.39566717576407945, 'psi': 0.8867219117213445}-{'f1_val': 0.7431479859585586, 'auprc': 0.907151197001391, 'loss_val': 0.6625412390232648, 'psi': 0.8087492703756916}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] START round=41 head_norm_before_train=1.498944 cos_to_last_merge=0.8239 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.824
[S7] round=41 local utility u=0.000000 metrics={'f1_val': 0.5786780004059142, 'auprc': 0.7884775068071895, 'loss_val': 0.7513615920931329, 'psi': 0.6625978029664243}-{'f1_val': 0.6358671419666866, 'auprc': 0.8036792646746252, 'loss_val': 0.48275445429701935, 'psi': 0.7029919910498621}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=41 head_norm_before_train=2.160275 (no previous merge yet)
[S8] round=41 local utility u=0.091381 metrics={'f1_val': 0.9942788405856967, 'auprc': 0.9997035830498245, 'loss_val': 0.025051161012538358, 'psi': 0.9964487375713479}-{'f1_val': 0.9720486500914776, 'auprc': 0.9992829335408683, 'loss_val': 0.07316909800350815, 'psi': 0.9829423634712338}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] sending update (kind=head size=1793 to 1 peers)
[S9] START round=41 head_norm_before_train=1.466183 cos_to_last_merge=0.9994 (last merge round=38)
[S9] round=41 local utility u=0.007150 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9983961210474936, 'loss_val': 0.052533136180908546, 'psi': 0.9976201959262831}-{'f1_val': 0.9971029125121428, 'auprc': 0.9958445744283848, 'loss_val': 0.059178060419162244, 'psi': 0.9965995772786396}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=41 head_norm_before_train=2.000279 cos_to_last_merge=0.7537 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.754
[S10] round=41 local utility u=0.000000 metrics={'f1_val': 0.9935262985458464, 'auprc': 0.9960230713209705, 'loss_val': 0.03171387332930808, 'psi': 0.994525007655896}-{'f1_val': 0.9935262985458464, 'auprc': 0.9960301915328276, 'loss_val': 0.0312888290366541, 'psi': 0.9945278557406388}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=41 head_norm_before_train=1.561494 cos_to_last_merge=1.0000 (last merge round=40)
[S11] round=41 local utility u=0.000304 metrics={'f1_val': 0.9974011907167429, 'auprc': 0.9976338569402754, 'loss_val': 0.038807234215814876, 'psi': 0.9974942572061559}-{'f1_val': 0.9982515059399775, 'auprc': 0.9994485174391788, 'loss_val': 0.04996112302190195, 'psi': 0.9987303105396581}
[S13] START round=41 head_norm_before_train=1.912584 (no previous merge yet)
[S13] round=41 local utility u=0.240004 metrics={'f1_val': 0.676854862260662, 'auprc': 0.7089999229406074, 'loss_val': 0.8322297686166656, 'psi': 0.6897128865326402}-{'f1_val': 0.6557266775411786, 'auprc': 0.6643845973079856, 'loss_val': 1.0516229421600214, 'psi': 0.6591898454479015}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=41 head_norm_before_train=1.561494 cos_to_last_merge=1.0000 (last merge round=40)
[S14] round=41 local utility u=0.003896 metrics={'f1_val': 0.996754531653698, 'auprc': 0.9989578640372218, 'loss_val': 0.042496753752499866, 'psi': 0.9976358646071075}-{'f1_val': 0.9967577367102773, 'auprc': 0.996871331320482, 'loss_val': 0.04404914244744612, 'psi': 0.9968031745543593}
[S15] START round=41 head_norm_before_train=1.716638 cos_to_last_merge=0.9855 (last merge round=31)
[S15] round=41 local utility u=0.000000 metrics={'f1_val': 0.7747635955718759, 'auprc': 0.9876120736657346, 'loss_val': 0.46415854692345215, 'psi': 0.8599029868094193}-{'f1_val': 0.9873143388184789, 'auprc': 0.9788177600605015, 'loss_val': 0.07186079298358668, 'psi': 0.983915707315288}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=41 head_norm_before_train=2.083413 (no previous merge yet)
[S16] round=41 local utility u=0.000000 metrics={'f1_val': 0.9412469110589818, 'auprc': 0.9892557372287322, 'loss_val': 0.27498056245346975, 'psi': 0.960450441526882}-{'f1_val': 0.9924497697178112, 'auprc': 0.9951338811281745, 'loss_val': 0.03815112242924684, 'psi': 0.9935234142819566}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=41 head_norm_before_train=1.856567 cos_to_last_merge=0.7982 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.798
[S17] round=41 local utility u=1.000000 metrics={'f1_val': 0.9771605087897003, 'auprc': 0.9708799878939468, 'loss_val': 0.09934668049295169, 'psi': 0.9746483004313988}-{'f1_val': 0.7010070416552427, 'auprc': 0.970939622564907, 'loss_val': 1.0578219822913877, 'psi': 0.8089800740191084}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] sending update (kind=head size=1793 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.997)
[S14] not sending this round → trigger blocked (psi=0.998)
[S2] START round=42 head_norm_before_train=2.155647 cos_to_last_merge=0.9874 (last merge round=23)
[S2] round=42 local utility u=0.000000 metrics={'f1_val': 0.7200372818503814, 'auprc': 0.7277771923706209, 'loss_val': 0.8655059278110024, 'psi': 0.7231332460584772}-{'f1_val': 0.7209101029520019, 'auprc': 0.7356336631796185, 'loss_val': 0.8514088035989468, 'psi': 0.7267995270430485}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=42 head_norm_before_train=2.121985 cos_to_last_merge=0.9991 (last merge round=31)
[S3] round=42 local utility u=0.178566 metrics={'f1_val': 0.9821044489856237, 'auprc': 0.9973886371414556, 'loss_val': 0.05384614577790596, 'psi': 0.9882181242479564}-{'f1_val': 0.9610352511054436, 'auprc': 0.9566395571708919, 'loss_val': 0.16231482989946858, 'psi': 0.9592769735316229}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=42 head_norm_before_train=2.086799 cos_to_last_merge=0.9911 (last merge round=25)
[S4] round=42 local utility u=0.002803 metrics={'f1_val': 0.941190353822432, 'auprc': 0.9297215048448911, 'loss_val': 0.3249500002933761, 'psi': 0.9366028142314157}-{'f1_val': 0.9414267407783846, 'auprc': 0.9273738675024749, 'loss_val': 0.3249308539791298, 'psi': 0.9358055914680208}
[S4] not sending this round → trigger blocked (psi=0.937)
[S5] START round=42 head_norm_before_train=1.459253 cos_to_last_merge=0.9798 (last merge round=30)
[S5] round=42 local utility u=0.065774 metrics={'f1_val': 0.5728702530501464, 'auprc': 0.8584656573816443, 'loss_val': 0.5781833004306094, 'psi': 0.6871084147827455}-{'f1_val': 0.561650128356294, 'auprc': 0.8551699440539839, 'loss_val': 0.6325235289815838, 'psi': 0.67905805463537}
[S6] START round=42 head_norm_before_train=1.633799 cos_to_last_merge=0.9916 (last merge round=30)
[S6] round=42 local utility u=0.000000 metrics={'f1_val': 0.8264723831593268, 'auprc': 0.9387967755882618, 'loss_val': 0.41803479783058656, 'psi': 0.8714021401309009}-{'f1_val': 0.846619536768255, 'auprc': 0.946875474150979, 'loss_val': 0.39566717576407945, 'psi': 0.8867219117213445}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=42 head_norm_before_train=1.505386 cos_to_last_merge=0.8231 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.823
[S7] round=42 local utility u=0.177764 metrics={'f1_val': 0.6109937518011817, 'auprc': 0.7938332677151958, 'loss_val': 0.6057953607969377, 'psi': 0.6841295581667873}-{'f1_val': 0.5786780004059142, 'auprc': 0.7884775068071895, 'loss_val': 0.7513615920931329, 'psi': 0.6625978029664243}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=42 head_norm_before_train=2.163598 (no previous merge yet)
[S8] round=42 local utility u=0.000278 metrics={'f1_val': 0.9942857583640028, 'auprc': 0.9997162257431795, 'loss_val': 0.02457451233975797, 'psi': 0.9964579453156736}-{'f1_val': 0.9942788405856967, 'auprc': 0.9997035830498245, 'loss_val': 0.025051161012538358, 'psi': 0.9964487375713479}
[S8] not sending this round → trigger blocked (psi=0.996)
[S9] START round=42 head_norm_before_train=1.488894 cos_to_last_merge=0.9987 (last merge round=38)
[S9] round=42 local utility u=0.002659 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9983647368611999, 'loss_val': 0.04712154073555218, 'psi': 0.9976076422517657}-{'f1_val': 0.9971029125121428, 'auprc': 0.9983961210474936, 'loss_val': 0.052533136180908546, 'psi': 0.9976201959262831}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=42 head_norm_before_train=2.010149 cos_to_last_merge=0.7527 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.753
[S10] round=42 local utility u=0.001503 metrics={'f1_val': 0.9935262985458464, 'auprc': 0.9971446514813421, 'loss_val': 0.03207292093458836, 'psi': 0.9949736397200446}-{'f1_val': 0.9935262985458464, 'auprc': 0.9960230713209705, 'loss_val': 0.03171387332930808, 'psi': 0.994525007655896}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] sending update (kind=head size=1804 to 1 peers)
[S11] START round=42 head_norm_before_train=1.576283 cos_to_last_merge=1.0000 (last merge round=40)
[S11] round=42 local utility u=0.002374 metrics={'f1_val': 0.9971593530989756, 'auprc': 0.9989098039807088, 'loss_val': 0.03643687094802542, 'psi': 0.9978595334516689}-{'f1_val': 0.9974011907167429, 'auprc': 0.9976338569402754, 'loss_val': 0.038807234215814876, 'psi': 0.9974942572061559}
[S13] START round=42 head_norm_before_train=1.916958 (no previous merge yet)
[S13] round=42 local utility u=0.000000 metrics={'f1_val': 0.6235144139715013, 'auprc': 0.6496483848994199, 'loss_val': 1.0976971792023065, 'psi': 0.6339680023426687}-{'f1_val': 0.676854862260662, 'auprc': 0.7089999229406074, 'loss_val': 0.8322297686166656, 'psi': 0.6897128865326402}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=42 head_norm_before_train=1.578462 cos_to_last_merge=0.9999 (last merge round=40)
[S14] round=42 local utility u=0.002686 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9988978144995022, 'loss_val': 0.03840212011086327, 'psi': 0.9977576306943999}-{'f1_val': 0.996754531653698, 'auprc': 0.9989578640372218, 'loss_val': 0.042496753752499866, 'psi': 0.9976358646071075}
[S15] START round=42 head_norm_before_train=1.734539 cos_to_last_merge=0.9845 (last merge round=31)
[S15] round=42 local utility u=0.000000 metrics={'f1_val': 0.7002178920523103, 'auprc': 0.8459143876754995, 'loss_val': 0.6107326675777267, 'psi': 0.7584964903015861}-{'f1_val': 0.7747635955718759, 'auprc': 0.9876120736657346, 'loss_val': 0.46415854692345215, 'psi': 0.8599029868094193}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=42 head_norm_before_train=2.089015 (no previous merge yet)
[S16] round=42 local utility u=0.276480 metrics={'f1_val': 0.992585560930296, 'auprc': 0.9920714562373876, 'loss_val': 0.03849898966424687, 'psi': 0.9923799190531326}-{'f1_val': 0.9412469110589818, 'auprc': 0.9892557372287322, 'loss_val': 0.27498056245346975, 'psi': 0.960450441526882}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S16] sending update (kind=head size=1792 to 1 peers)
[S17] START round=42 head_norm_before_train=1.867547 cos_to_last_merge=0.7981 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.798
[S17] round=42 local utility u=0.000000 metrics={'f1_val': 0.7045313840853517, 'auprc': 0.8009955903160215, 'loss_val': 1.2375345120050314, 'psi': 0.7431170665776197}-{'f1_val': 0.9771605087897003, 'auprc': 0.9708799878939468, 'loss_val': 0.09934668049295169, 'psi': 0.9746483004313988}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:59810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S11@127.0.0.1:59812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] → sending delta(kind=head bytes=1805) to S14@127.0.0.1:59814
[S5] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1805 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1805) from S11
[S14] cosine check vs S11: cos=0.9997
[S11] RECEIVED delta(kind=head bytes=1803) from S14
[S11] cosine check vs S14: cos=0.9997
[S9] RECEIVED delta(kind=head bytes=1799) from S5
[S9] cosine check vs S5: cos=0.9871
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=42 metric=0.9972 head_norm=1.591567
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.834485e-02
[S11] stored merged vector for next round verification (round=42)
[S11] DEBUG after merge:  round=42 metric=0.9972 head_norm=1.592088 delta_norm=0.018345
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=42 metric=0.9970 head_norm=1.592819
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.834485e-02
[S14] stored merged vector for next round verification (round=42)
[S14] DEBUG after merge:  round=42 metric=0.9970 head_norm=1.592088 delta_norm=0.018345
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=43 head_norm_before_train=2.163114 cos_to_last_merge=0.9869 (last merge round=23)
[S2] round=43 local utility u=0.000000 metrics={'f1_val': 0.6883948881154263, 'auprc': 0.7302733213172029, 'loss_val': 0.9285378624293001, 'psi': 0.7051462613961369}-{'f1_val': 0.7200372818503814, 'auprc': 0.7277771923706209, 'loss_val': 0.8655059278110024, 'psi': 0.7231332460584772}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=43 head_norm_before_train=2.131660 cos_to_last_merge=0.9989 (last merge round=31)
[S3] round=43 local utility u=0.000000 metrics={'f1_val': 0.975089227936066, 'auprc': 0.9973935754794372, 'loss_val': 0.06321343859810437, 'psi': 0.9840109669534145}-{'f1_val': 0.9821044489856237, 'auprc': 0.9973886371414556, 'loss_val': 0.05384614577790596, 'psi': 0.9882181242479564}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=43 head_norm_before_train=2.095570 cos_to_last_merge=0.9906 (last merge round=25)
[S4] round=43 local utility u=0.053218 metrics={'f1_val': 0.9422874540228063, 'auprc': 0.9607233570836242, 'loss_val': 0.3181012826260408, 'psi': 0.9496618152471336}-{'f1_val': 0.941190353822432, 'auprc': 0.9297215048448911, 'loss_val': 0.3249500002933761, 'psi': 0.9366028142314157}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=43 head_norm_before_train=1.470239 cos_to_last_merge=0.9786 (last merge round=30)
[S5] round=43 local utility u=0.479441 metrics={'f1_val': 0.7004069097142683, 'auprc': 0.8692969742296004, 'loss_val': 0.41701453783524917, 'psi': 0.7679629355204012}-{'f1_val': 0.5728702530501464, 'auprc': 0.8584656573816443, 'loss_val': 0.5781833004306094, 'psi': 0.6871084147827455}
[S6] START round=43 head_norm_before_train=1.647782 cos_to_last_merge=0.9907 (last merge round=30)
[S6] round=43 local utility u=0.000000 metrics={'f1_val': 0.78783435411153, 'auprc': 0.9168911789818119, 'loss_val': 0.48836614708515713, 'psi': 0.8394570840596427}-{'f1_val': 0.8264723831593268, 'auprc': 0.9387967755882618, 'loss_val': 0.41803479783058656, 'psi': 0.8714021401309009}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=43 head_norm_before_train=1.511178 cos_to_last_merge=0.8224 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.822
[S7] round=43 local utility u=0.253269 metrics={'f1_val': 0.6559890402929328, 'auprc': 0.8109540570282008, 'loss_val': 0.420591907940351, 'psi': 0.7179750469870401}-{'f1_val': 0.6109937518011817, 'auprc': 0.7938332677151958, 'loss_val': 0.6057953607969377, 'psi': 0.6841295581667873}
[S7] not sending this round → trigger blocked (psi=0.718)
[S8] START round=43 head_norm_before_train=2.167967 (no previous merge yet)
[S8] round=43 local utility u=0.000000 metrics={'f1_val': 0.9924707537771836, 'auprc': 0.9996473520243586, 'loss_val': 0.029519599521042633, 'psi': 0.9953413930760536}-{'f1_val': 0.9942857583640028, 'auprc': 0.9997162257431795, 'loss_val': 0.02457451233975797, 'psi': 0.9964579453156736}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=43 head_norm_before_train=1.509530 cos_to_last_merge=0.9978 (last merge round=38)
[S9] round=43 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9958863770690671, 'loss_val': 0.04296208976211947, 'psi': 0.9966162983349125}-{'f1_val': 0.9971029125121428, 'auprc': 0.9983647368611999, 'loss_val': 0.04712154073555218, 'psi': 0.9976076422517657}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=43 metric=0.9971 head_norm=1.528485
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.317079e-01
[S9] stored merged vector for next round verification (round=43)
[S9] DEBUG after merge:  round=43 metric=0.9971 head_norm=1.493850 delta_norm=0.131708
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S10] START round=43 head_norm_before_train=2.016991 cos_to_last_merge=0.7521 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.752
[S10] round=43 local utility u=0.000156 metrics={'f1_val': 0.9935262985458464, 'auprc': 0.9971133244838543, 'loss_val': 0.03166604382095073, 'psi': 0.9949611089210495}-{'f1_val': 0.9935262985458464, 'auprc': 0.9971446514813421, 'loss_val': 0.03207292093458836, 'psi': 0.9949736397200446}
[S10] not sending this round → trigger blocked (psi=0.995)
[S11] START round=43 head_norm_before_train=1.592088 cos_to_last_merge=1.0000 (last merge round=42)
[S11] round=43 local utility u=0.001187 metrics={'f1_val': 0.9978376696242038, 'auprc': 0.9994014577909227, 'loss_val': 0.039607764249769084, 'psi': 0.9984631848908914}-{'f1_val': 0.9971593530989756, 'auprc': 0.9989098039807088, 'loss_val': 0.03643687094802542, 'psi': 0.9978595334516689}
[S13] START round=43 head_norm_before_train=1.924637 (no previous merge yet)
[S13] round=43 local utility u=0.199332 metrics={'f1_val': 0.6561707589143404, 'auprc': 0.6593794522858836, 'loss_val': 0.9241644567949465, 'psi': 0.6574542362629576}-{'f1_val': 0.6235144139715013, 'auprc': 0.6496483848994199, 'loss_val': 1.0976971792023065, 'psi': 0.6339680023426687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=43 head_norm_before_train=1.592088 cos_to_last_merge=1.0000 (last merge round=42)
[S14] round=43 local utility u=0.000000 metrics={'f1_val': 0.9968002980424979, 'auprc': 0.9991285851096114, 'loss_val': 0.04033229197610269, 'psi': 0.9977316128693433}-{'f1_val': 0.9969975081576651, 'auprc': 0.9988978144995022, 'loss_val': 0.03840212011086327, 'psi': 0.9977576306943999}
[S15] START round=43 head_norm_before_train=1.750852 cos_to_last_merge=0.9835 (last merge round=31)
[S15] round=43 local utility u=1.000000 metrics={'f1_val': 0.9837772423515989, 'auprc': 0.9688962189502117, 'loss_val': 0.10500101310563631, 'psi': 0.9778248329910441}-{'f1_val': 0.7002178920523103, 'auprc': 0.8459143876754995, 'loss_val': 0.6107326675777267, 'psi': 0.7584964903015861}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=43 head_norm_before_train=2.091297 (no previous merge yet)
[S16] round=43 local utility u=0.003832 metrics={'f1_val': 0.9920139700014868, 'auprc': 0.9953536675242994, 'loss_val': 0.037251502134657985, 'psi': 0.9933498490106119}-{'f1_val': 0.992585560930296, 'auprc': 0.9920714562373876, 'loss_val': 0.03849898966424687, 'psi': 0.9923799190531326}
[S16] not sending this round → trigger blocked (psi=0.993)
[S17] START round=43 head_norm_before_train=1.877546 cos_to_last_merge=0.7978 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.798
[S17] round=43 local utility u=0.112210 metrics={'f1_val': 0.6926949369990965, 'auprc': 0.8757252142398364, 'loss_val': 1.16628440711572, 'psi': 0.7659070478953924}-{'f1_val': 0.7045313840853517, 'auprc': 0.8009955903160215, 'loss_val': 1.2375345120050314, 'psi': 0.7431170665776197}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.768)
[S11] not sending this round → trigger blocked (psi=0.998)
[S2] START round=44 head_norm_before_train=2.172636 cos_to_last_merge=0.9863 (last merge round=23)
[S2] round=44 local utility u=0.000000 metrics={'f1_val': 0.6712141012816235, 'auprc': 0.7262496756163681, 'loss_val': 1.0592792278488485, 'psi': 0.6932283310155214}-{'f1_val': 0.6883948881154263, 'auprc': 0.7302733213172029, 'loss_val': 0.9285378624293001, 'psi': 0.7051462613961369}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=44 head_norm_before_train=2.141856 cos_to_last_merge=0.9988 (last merge round=31)
[S3] round=44 local utility u=0.036809 metrics={'f1_val': 0.9851594459688122, 'auprc': 0.9977173206041536, 'loss_val': 0.05098851042486982, 'psi': 0.9901825958229488}-{'f1_val': 0.975089227936066, 'auprc': 0.9973935754794372, 'loss_val': 0.06321343859810437, 'psi': 0.9840109669534145}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=44 head_norm_before_train=2.105722 cos_to_last_merge=0.9901 (last merge round=25)
[S4] round=44 local utility u=0.005466 metrics={'f1_val': 0.9521806440285818, 'auprc': 0.9429049128363433, 'loss_val': 0.31307251357253363, 'psi': 0.9484703515516864}-{'f1_val': 0.9422874540228063, 'auprc': 0.9607233570836242, 'loss_val': 0.3181012826260408, 'psi': 0.9496618152471336}
[S4] not sending this round → trigger blocked (psi=0.948)
[S5] START round=44 head_norm_before_train=1.482949 cos_to_last_merge=0.9773 (last merge round=30)
[S5] round=44 local utility u=0.019303 metrics={'f1_val': 0.700320598491359, 'auprc': 0.8807060912743733, 'loss_val': 0.41211846210936515, 'psi': 0.7724747956045648}-{'f1_val': 0.7004069097142683, 'auprc': 0.8692969742296004, 'loss_val': 0.41701453783524917, 'psi': 0.7679629355204012}
[S6] START round=44 head_norm_before_train=1.668408 cos_to_last_merge=0.9895 (last merge round=30)
[S6] round=44 local utility u=0.000000 metrics={'f1_val': 0.7249444119496967, 'auprc': 0.7967717722096641, 'loss_val': 0.7258660494442767, 'psi': 0.7536753560536837}-{'f1_val': 0.78783435411153, 'auprc': 0.9168911789818119, 'loss_val': 0.48836614708515713, 'psi': 0.8394570840596427}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=44 head_norm_before_train=1.519966 cos_to_last_merge=0.8212 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.821
[S7] round=44 local utility u=0.000000 metrics={'f1_val': 0.6253785802809797, 'auprc': 0.801418157064667, 'loss_val': 0.569274297372937, 'psi': 0.6957944109944547}-{'f1_val': 0.6559890402929328, 'auprc': 0.8109540570282008, 'loss_val': 0.420591907940351, 'psi': 0.7179750469870401}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=44 head_norm_before_train=2.175151 (no previous merge yet)
[S8] round=44 local utility u=0.000000 metrics={'f1_val': 0.9878817827888313, 'auprc': 0.9933415449823495, 'loss_val': 0.04054737443321347, 'psi': 0.9900656876662386}-{'f1_val': 0.9924707537771836, 'auprc': 0.9996473520243586, 'loss_val': 0.029519599521042633, 'psi': 0.9953413930760536}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=44 head_norm_before_train=1.493850 cos_to_last_merge=1.0000 (last merge round=43)
[S9] round=44 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9970870541117803, 'loss_val': 0.05332447930191815, 'psi': 0.9970965691519978}-{'f1_val': 0.9971029125121428, 'auprc': 0.9958863770690671, 'loss_val': 0.04296208976211947, 'psi': 0.9966162983349125}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=44 head_norm_before_train=2.024228 cos_to_last_merge=0.7513 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.751
[S10] round=44 local utility u=0.000000 metrics={'f1_val': 0.9935262985458464, 'auprc': 0.9970863645643913, 'loss_val': 0.031770207035797894, 'psi': 0.9949503249532643}-{'f1_val': 0.9935262985458464, 'auprc': 0.9971133244838543, 'loss_val': 0.03166604382095073, 'psi': 0.9949611089210495}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=44 head_norm_before_train=1.605912 cos_to_last_merge=1.0000 (last merge round=42)
[S11] round=44 local utility u=0.000000 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9975771678535446, 'loss_val': 0.03435603276038027, 'psi': 0.997064318890327}-{'f1_val': 0.9978376696242038, 'auprc': 0.9994014577909227, 'loss_val': 0.039607764249769084, 'psi': 0.9984631848908914}
[S13] START round=44 head_norm_before_train=1.935211 (no previous merge yet)
[S13] round=44 local utility u=0.000000 metrics={'f1_val': 0.6269857803985576, 'auprc': 0.6040431986893067, 'loss_val': 1.3103703219150282, 'psi': 0.6178087477148572}-{'f1_val': 0.6561707589143404, 'auprc': 0.6593794522858836, 'loss_val': 0.9241644567949465, 'psi': 0.6574542362629576}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=44 head_norm_before_train=1.603953 cos_to_last_merge=1.0000 (last merge round=42)
[S14] round=44 local utility u=0.000000 metrics={'f1_val': 0.996462697384468, 'auprc': 0.9991667505345782, 'loss_val': 0.04278390646433829, 'psi': 0.9975443186445121}-{'f1_val': 0.9968002980424979, 'auprc': 0.9991285851096114, 'loss_val': 0.04033229197610269, 'psi': 0.9977316128693433}
[S15] START round=44 head_norm_before_train=1.762417 cos_to_last_merge=0.9829 (last merge round=31)
[S15] round=44 local utility u=0.000000 metrics={'f1_val': 0.7007659221024161, 'auprc': 0.9883208358142989, 'loss_val': 0.5432089725746697, 'psi': 0.8157878875871691}-{'f1_val': 0.9837772423515989, 'auprc': 0.9688962189502117, 'loss_val': 0.10500101310563631, 'psi': 0.9778248329910441}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=44 head_norm_before_train=2.097283 (no previous merge yet)
[S16] round=44 local utility u=0.000964 metrics={'f1_val': 0.9927940933411168, 'auprc': 0.9944800003824216, 'loss_val': 0.03738337837109192, 'psi': 0.9934684561576387}-{'f1_val': 0.9920139700014868, 'auprc': 0.9953536675242994, 'loss_val': 0.037251502134657985, 'psi': 0.9933498490106119}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S16] sending update (kind=head size=1790 to 1 peers)
[S17] START round=44 head_norm_before_train=1.884297 cos_to_last_merge=0.7975 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.798
[S17] round=44 local utility u=1.000000 metrics={'f1_val': 0.9938322137427988, 'auprc': 0.985770328299985, 'loss_val': 0.037285353352528215, 'psi': 0.9906074595656733}-{'f1_val': 0.6926949369990965, 'auprc': 0.8757252142398364, 'loss_val': 1.16628440711572, 'psi': 0.7659070478953924}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:59810
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1800 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1800) from S5
[S9] cosine check vs S5: cos=0.9943
[S2] START round=45 head_norm_before_train=2.183158 cos_to_last_merge=0.9855 (last merge round=23)
[S2] round=45 local utility u=0.246622 metrics={'f1_val': 0.7199792781307432, 'auprc': 0.7337722431657138, 'loss_val': 0.8811935527945385, 'psi': 0.7254964641447315}-{'f1_val': 0.6712141012816235, 'auprc': 0.7262496756163681, 'loss_val': 1.0592792278488485, 'psi': 0.6932283310155214}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=45 head_norm_before_train=2.151289 cos_to_last_merge=0.9986 (last merge round=31)
[S3] round=45 local utility u=0.047805 metrics={'f1_val': 0.9978100342676263, 'auprc': 0.9975972926199561, 'loss_val': 0.030922214626214643, 'psi': 0.9977249376085582}-{'f1_val': 0.9851594459688122, 'auprc': 0.9977173206041536, 'loss_val': 0.05098851042486982, 'psi': 0.9901825958229488}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=45 head_norm_before_train=2.113702 cos_to_last_merge=0.9897 (last merge round=25)
[S4] round=45 local utility u=0.021956 metrics={'f1_val': 0.9529660571365812, 'auprc': 0.9542295008197186, 'loss_val': 0.3078462653032025, 'psi': 0.9534714346098361}-{'f1_val': 0.9521806440285818, 'auprc': 0.9429049128363433, 'loss_val': 0.31307251357253363, 'psi': 0.9484703515516864}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=45 head_norm_before_train=1.494263 cos_to_last_merge=0.9762 (last merge round=30)
[S5] round=45 local utility u=0.000000 metrics={'f1_val': 0.6502134024597989, 'auprc': 0.8552407368050646, 'loss_val': 0.527833152366431, 'psi': 0.7322243361979052}-{'f1_val': 0.700320598491359, 'auprc': 0.8807060912743733, 'loss_val': 0.41211846210936515, 'psi': 0.7724747956045648}
[S6] START round=45 head_norm_before_train=1.688967 cos_to_last_merge=0.9882 (last merge round=30)
[S6] round=45 local utility u=0.754658 metrics={'f1_val': 0.8322062133925877, 'auprc': 0.946266919281779, 'loss_val': 0.30860573613602416, 'psi': 0.8778304957482642}-{'f1_val': 0.7249444119496967, 'auprc': 0.7967717722096641, 'loss_val': 0.7258660494442767, 'psi': 0.7536753560536837}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=45 head_norm_before_train=1.527359 cos_to_last_merge=0.8202 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.820
[S7] round=45 local utility u=0.000000 metrics={'f1_val': 0.6093706953599076, 'auprc': 0.7943460013894134, 'loss_val': 0.6464671239978167, 'psi': 0.6833608177717099}-{'f1_val': 0.6253785802809797, 'auprc': 0.801418157064667, 'loss_val': 0.569274297372937, 'psi': 0.6957944109944547}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=45 head_norm_before_train=2.181938 (no previous merge yet)
[S8] round=45 local utility u=0.036384 metrics={'f1_val': 0.9941000136901317, 'auprc': 0.9994816056617921, 'loss_val': 0.02350927267108915, 'psi': 0.9962526504787959}-{'f1_val': 0.9878817827888313, 'auprc': 0.9933415449823495, 'loss_val': 0.04054737443321347, 'psi': 0.9900656876662386}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=45 head_norm_before_train=1.510566 cos_to_last_merge=0.9999 (last merge round=43)
[S9] round=45 local utility u=0.003186 metrics={'f1_val': 0.9966891482978385, 'auprc': 0.9984004159299952, 'loss_val': 0.04841005610431418, 'psi': 0.9973736553507012}-{'f1_val': 0.9971029125121428, 'auprc': 0.9970870541117803, 'loss_val': 0.05332447930191815, 'psi': 0.9970965691519978}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=45 metric=0.9967 head_norm=1.527236
[S9] _apply_head_vector_avg (torch): Δ‖w‖=9.069954e-02
[S9] stored merged vector for next round verification (round=45)
[S9] DEBUG after merge:  round=45 metric=0.9967 head_norm=1.508114 delta_norm=0.090700
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S10] START round=45 head_norm_before_train=2.033305 cos_to_last_merge=0.7504 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.750
[S10] round=45 local utility u=0.000219 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9970450599783572, 'loss_val': 0.03145899531101034, 'psi': 0.9949588178104996}-{'f1_val': 0.9935262985458464, 'auprc': 0.9970863645643913, 'loss_val': 0.031770207035797894, 'psi': 0.9949503249532643}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=45 head_norm_before_train=1.620133 cos_to_last_merge=0.9999 (last merge round=42)
[S11] round=45 local utility u=0.006160 metrics={'f1_val': 0.9974011907167429, 'auprc': 0.9993515032840896, 'loss_val': 0.031431022139056276, 'psi': 0.9981813157436816}-{'f1_val': 0.9967224195815153, 'auprc': 0.9975771678535446, 'loss_val': 0.03435603276038027, 'psi': 0.997064318890327}
[S13] START round=45 head_norm_before_train=1.941299 (no previous merge yet)
[S13] round=45 local utility u=0.111541 metrics={'f1_val': 0.6376071074829961, 'auprc': 0.6224549293945899, 'loss_val': 1.2062522594458456, 'psi': 0.6315462362476336}-{'f1_val': 0.6269857803985576, 'auprc': 0.6040431986893067, 'loss_val': 1.3103703219150282, 'psi': 0.6178087477148572}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=45 head_norm_before_train=1.616524 cos_to_last_merge=0.9999 (last merge round=42)
[S14] round=45 local utility u=0.006734 metrics={'f1_val': 0.9974089034627865, 'auprc': 0.999214759336229, 'loss_val': 0.03513807436103638, 'psi': 0.9981312458121635}-{'f1_val': 0.996462697384468, 'auprc': 0.9991667505345782, 'loss_val': 0.04278390646433829, 'psi': 0.9975443186445121}
[S15] START round=45 head_norm_before_train=1.776455 cos_to_last_merge=0.9820 (last merge round=31)
[S15] round=45 local utility u=1.000000 metrics={'f1_val': 0.9847297370647025, 'auprc': 0.9949447882974611, 'loss_val': 0.04153679557939402, 'psi': 0.9888157575578058}-{'f1_val': 0.7007659221024161, 'auprc': 0.9883208358142989, 'loss_val': 0.5432089725746697, 'psi': 0.8157878875871691}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=45 head_norm_before_train=2.105110 (no previous merge yet)
[S16] round=45 local utility u=0.000390 metrics={'f1_val': 0.9925991268614645, 'auprc': 0.9951244491146628, 'loss_val': 0.03736630649366234, 'psi': 0.9936092557627438}-{'f1_val': 0.9927940933411168, 'auprc': 0.9944800003824216, 'loss_val': 0.03738337837109192, 'psi': 0.9934684561576387}
[S16] not sending this round → trigger blocked (psi=0.994)
[S17] START round=45 head_norm_before_train=1.886109 cos_to_last_merge=0.7972 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.797
[S17] round=45 local utility u=0.000000 metrics={'f1_val': 0.7166451987847432, 'auprc': 0.920991198678645, 'loss_val': 0.9504488186911352, 'psi': 0.798383598742304}-{'f1_val': 0.9938322137427988, 'auprc': 0.985770328299985, 'loss_val': 0.037285353352528215, 'psi': 0.9906074595656733}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] → sending delta(kind=head bytes=1805) to S11@127.0.0.1:59812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:59814
[S14] sending update (kind=head size=1805 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S5] ⇄ pheromone p=0.142 → S9@127.0.0.1:59810
[S14] RECEIVED delta(kind=head bytes=1797) from S11
[S14] cosine check vs S11: cos=0.9996
[S11] RECEIVED delta(kind=head bytes=1805) from S14
[S11] cosine check vs S14: cos=0.9996
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=45 metric=0.9974 head_norm=1.632865
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.273453e-02
[S11] stored merged vector for next round verification (round=45)
[S11] DEBUG after merge:  round=45 metric=0.9974 head_norm=1.630528 delta_norm=0.022735
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.009 → S14@127.0.0.1:59814
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=45 metric=0.9974 head_norm=1.628506
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.273454e-02
[S14] stored merged vector for next round verification (round=45)
[S14] DEBUG after merge:  round=45 metric=0.9974 head_norm=1.630528 delta_norm=0.022735
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.020 → S11@127.0.0.1:59812
[S2] START round=46 head_norm_before_train=2.193776 cos_to_last_merge=0.9849 (last merge round=23)
[S2] round=46 local utility u=0.000000 metrics={'f1_val': 0.6655904951965999, 'auprc': 0.7263926135060096, 'loss_val': 1.123992735892519, 'psi': 0.6899113425203638}-{'f1_val': 0.7199792781307432, 'auprc': 0.7337722431657138, 'loss_val': 0.8811935527945385, 'psi': 0.7254964641447315}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=46 head_norm_before_train=2.161353 cos_to_last_merge=0.9984 (last merge round=31)
[S3] round=46 local utility u=0.000000 metrics={'f1_val': 0.989852487456504, 'auprc': 0.9977135832898454, 'loss_val': 0.0359068640560589, 'psi': 0.9929969257898406}-{'f1_val': 0.9978100342676263, 'auprc': 0.9975972926199561, 'loss_val': 0.030922214626214643, 'psi': 0.9977249376085582}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=46 head_norm_before_train=2.117615 cos_to_last_merge=0.9892 (last merge round=25)
[S4] round=46 local utility u=0.000000 metrics={'f1_val': 0.9506550910324856, 'auprc': 0.9257174359266125, 'loss_val': 0.31729317696421333, 'psi': 0.9406800289901363}-{'f1_val': 0.9529660571365812, 'auprc': 0.9542295008197186, 'loss_val': 0.3078462653032025, 'psi': 0.9534714346098361}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=46 head_norm_before_train=1.505428 cos_to_last_merge=0.9750 (last merge round=30)
[S5] round=46 local utility u=0.032207 metrics={'f1_val': 0.6243926896438576, 'auprc': 0.8980559401558753, 'loss_val': 0.43694068230551675, 'psi': 0.7338579898486647}-{'f1_val': 0.6502134024597989, 'auprc': 0.8552407368050646, 'loss_val': 0.527833152366431, 'psi': 0.7322243361979052}
[S6] START round=46 head_norm_before_train=1.706899 cos_to_last_merge=0.9872 (last merge round=30)
[S6] round=46 local utility u=0.000000 metrics={'f1_val': 0.7174907322808177, 'auprc': 0.7750504153530127, 'loss_val': 0.7436505949692943, 'psi': 0.7405146055096957}-{'f1_val': 0.8322062133925877, 'auprc': 0.946266919281779, 'loss_val': 0.30860573613602416, 'psi': 0.8778304957482642}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=46 head_norm_before_train=1.533507 cos_to_last_merge=0.8194 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.819
[S7] round=46 local utility u=0.212903 metrics={'f1_val': 0.6454771677800286, 'auprc': 0.8071481845991983, 'loss_val': 0.47570729199499867, 'psi': 0.7101455745076966}-{'f1_val': 0.6093706953599076, 'auprc': 0.7943460013894134, 'loss_val': 0.6464671239978167, 'psi': 0.6833608177717099}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=46 head_norm_before_train=2.189671 (no previous merge yet)
[S8] round=46 local utility u=0.000000 metrics={'f1_val': 0.9933329447925694, 'auprc': 0.9993938357481108, 'loss_val': 0.023921155244814758, 'psi': 0.9957573011747859}-{'f1_val': 0.9941000136901317, 'auprc': 0.9994816056617921, 'loss_val': 0.02350927267108915, 'psi': 0.9962526504787959}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=46 head_norm_before_train=1.508114 cos_to_last_merge=1.0000 (last merge round=45)
[S9] round=46 local utility u=0.000000 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9932685438494242, 'loss_val': 0.05503055281114271, 'psi': 0.995322912298627}-{'f1_val': 0.9966891482978385, 'auprc': 0.9984004159299952, 'loss_val': 0.04841005610431418, 'psi': 0.9973736553507012}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=46 head_norm_before_train=2.038953 cos_to_last_merge=0.7499 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.750
[S10] round=46 local utility u=0.000000 metrics={'f1_val': 0.9935262985458464, 'auprc': 0.9970839583146494, 'loss_val': 0.03159669840972578, 'psi': 0.9949493624533676}-{'f1_val': 0.9935679896985945, 'auprc': 0.9970450599783572, 'loss_val': 0.03145899531101034, 'psi': 0.9949588178104996}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=46 head_norm_before_train=1.630528 cos_to_last_merge=1.0000 (last merge round=45)
[S11] round=46 local utility u=0.000624 metrics={'f1_val': 0.9974011907167429, 'auprc': 0.9994006932665486, 'loss_val': 0.030329702387061373, 'psi': 0.9982009917366652}-{'f1_val': 0.9974011907167429, 'auprc': 0.9993515032840896, 'loss_val': 0.031431022139056276, 'psi': 0.9981813157436816}
[S13] START round=46 head_norm_before_train=1.947460 (no previous merge yet)
[S13] round=46 local utility u=0.000000 metrics={'f1_val': 0.6314638089575566, 'auprc': 0.6184592605130007, 'loss_val': 1.2528213719002639, 'psi': 0.6262619895797342}-{'f1_val': 0.6376071074829961, 'auprc': 0.6224549293945899, 'loss_val': 1.2062522594458456, 'psi': 0.6315462362476336}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=46 head_norm_before_train=1.630528 cos_to_last_merge=1.0000 (last merge round=45)
[S14] round=46 local utility u=0.000000 metrics={'f1_val': 0.9437956314670307, 'auprc': 0.997000069867611, 'loss_val': 0.0923572617259856, 'psi': 0.965077406827263}-{'f1_val': 0.9974089034627865, 'auprc': 0.999214759336229, 'loss_val': 0.03513807436103638, 'psi': 0.9981312458121635}
[S15] START round=46 head_norm_before_train=1.792408 cos_to_last_merge=0.9810 (last merge round=31)
[S15] round=46 local utility u=0.000000 metrics={'f1_val': 0.7182707133183666, 'auprc': 0.9891281609943089, 'loss_val': 0.5047433680770651, 'psi': 0.8266136923887435}-{'f1_val': 0.9847297370647025, 'auprc': 0.9949447882974611, 'loss_val': 0.04153679557939402, 'psi': 0.9888157575578058}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=46 head_norm_before_train=2.113808 (no previous merge yet)
[S16] round=46 local utility u=0.000000 metrics={'f1_val': 0.9924497697178112, 'auprc': 0.9954448658130315, 'loss_val': 0.037512435242169385, 'psi': 0.9936478081558994}-{'f1_val': 0.9925991268614645, 'auprc': 0.9951244491146628, 'loss_val': 0.03736630649366234, 'psi': 0.9936092557627438}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=46 head_norm_before_train=1.891765 cos_to_last_merge=0.7967 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.797
[S17] round=46 local utility u=0.591328 metrics={'f1_val': 0.7911434536977198, 'auprc': 0.9868106840640756, 'loss_val': 0.4122410310256951, 'psi': 0.8694103458442621}-{'f1_val': 0.7166451987847432, 'auprc': 0.920991198678645, 'loss_val': 0.9504488186911352, 'psi': 0.798383598742304}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:59814
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:59810
[S5] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1804 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1798) from S5
[S9] cosine check vs S5: cos=0.9967
[S14] RECEIVED delta(kind=head bytes=1804) from S11
[S14] cosine check vs S11: cos=1.0000
[S2] START round=47 head_norm_before_train=2.202228 cos_to_last_merge=0.9842 (last merge round=23)
[S2] round=47 local utility u=0.234588 metrics={'f1_val': 0.712365900014146, 'auprc': 0.7274379279564329, 'loss_val': 0.9386051322171338, 'psi': 0.7183947111910607}-{'f1_val': 0.6655904951965999, 'auprc': 0.7263926135060096, 'loss_val': 1.123992735892519, 'psi': 0.6899113425203638}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=47 head_norm_before_train=2.170590 cos_to_last_merge=0.9982 (last merge round=31)
[S3] round=47 local utility u=0.000000 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.9736725467522294, 'loss_val': 0.14726250875983113, 'psi': 0.9660901693641579}-{'f1_val': 0.989852487456504, 'auprc': 0.9977135832898454, 'loss_val': 0.0359068640560589, 'psi': 0.9929969257898406}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=47 head_norm_before_train=2.121587 cos_to_last_merge=0.9888 (last merge round=25)
[S4] round=47 local utility u=0.034449 metrics={'f1_val': 0.9552488625768655, 'auprc': 0.9393755546201544, 'loss_val': 0.31693294531128735, 'psi': 0.948899539394181}-{'f1_val': 0.9506550910324856, 'auprc': 0.9257174359266125, 'loss_val': 0.31729317696421333, 'psi': 0.9406800289901363}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=47 head_norm_before_train=1.513657 cos_to_last_merge=0.9740 (last merge round=30)
[S5] round=47 local utility u=0.000000 metrics={'f1_val': 0.6755748665804224, 'auprc': 0.8617687925765279, 'loss_val': 0.7121865911804567, 'psi': 0.7500524369788646}-{'f1_val': 0.6243926896438576, 'auprc': 0.8980559401558753, 'loss_val': 0.43694068230551675, 'psi': 0.7338579898486647}
[S6] START round=47 head_norm_before_train=1.724137 cos_to_last_merge=0.9861 (last merge round=30)
[S6] round=47 local utility u=0.710735 metrics={'f1_val': 0.8121261798748045, 'auprc': 0.9440357072377549, 'loss_val': 0.3969499413401426, 'psi': 0.8648899908199846}-{'f1_val': 0.7174907322808177, 'auprc': 0.7750504153530127, 'loss_val': 0.7436505949692943, 'psi': 0.7405146055096957}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] sending update (kind=head size=1795 to 1 peers)
[S7] START round=47 head_norm_before_train=1.539064 cos_to_last_merge=0.8187 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.819
[S7] round=47 local utility u=0.204334 metrics={'f1_val': 0.6738053901029643, 'auprc': 0.838538059963115, 'loss_val': 0.33117740084665026, 'psi': 0.7396984580470245}-{'f1_val': 0.6454771677800286, 'auprc': 0.8071481845991983, 'loss_val': 0.47570729199499867, 'psi': 0.7101455745076966}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=47 head_norm_before_train=2.198447 (no previous merge yet)
[S8] round=47 local utility u=0.000000 metrics={'f1_val': 0.9654516400251782, 'auprc': 0.9994510244466546, 'loss_val': 0.10464243089120752, 'psi': 0.9790513937937688}-{'f1_val': 0.9933329447925694, 'auprc': 0.9993938357481108, 'loss_val': 0.023921155244814758, 'psi': 0.9957573011747859}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=47 head_norm_before_train=1.525876 cos_to_last_merge=0.9999 (last merge round=45)
[S9] round=47 local utility u=0.010227 metrics={'f1_val': 0.9966857875385419, 'auprc': 0.9983971683188186, 'loss_val': 0.049921451020827456, 'psi': 0.9973703398506526}-{'f1_val': 0.9966924912647621, 'auprc': 0.9932685438494242, 'loss_val': 0.05503055281114271, 'psi': 0.995322912298627}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=47 metric=0.9967 head_norm=1.544733
[S9] _apply_head_vector_avg (torch): Δ‖w‖=7.442964e-02
[S9] stored merged vector for next round verification (round=47)
[S9] DEBUG after merge:  round=47 metric=0.9967 head_norm=1.527462 delta_norm=0.074430
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S10] START round=47 head_norm_before_train=2.045654 cos_to_last_merge=0.7492 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.749
[S10] round=47 local utility u=0.000000 metrics={'f1_val': 0.9935262985458464, 'auprc': 0.9971297769574774, 'loss_val': 0.03223074547296454, 'psi': 0.9949676899104988}-{'f1_val': 0.9935262985458464, 'auprc': 0.9970839583146494, 'loss_val': 0.03159669840972578, 'psi': 0.9949493624533676}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=47 head_norm_before_train=1.641836 cos_to_last_merge=1.0000 (last merge round=45)
[S11] round=47 local utility u=0.000000 metrics={'f1_val': 0.9971593530989756, 'auprc': 0.9993952233819106, 'loss_val': 0.03011068666834621, 'psi': 0.9980537012121496}-{'f1_val': 0.9974011907167429, 'auprc': 0.9994006932665486, 'loss_val': 0.030329702387061373, 'psi': 0.9982009917366652}
[S13] START round=47 head_norm_before_train=1.953497 (no previous merge yet)
[S13] round=47 local utility u=0.048713 metrics={'f1_val': 0.6336298602629147, 'auprc': 0.6283573744499887, 'loss_val': 1.198086070963649, 'psi': 0.6315208659377443}-{'f1_val': 0.6314638089575566, 'auprc': 0.6184592605130007, 'loss_val': 1.2528213719002639, 'psi': 0.6262619895797342}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=47 head_norm_before_train=1.640331 cos_to_last_merge=1.0000 (last merge round=45)
[S14] round=47 local utility u=0.190402 metrics={'f1_val': 0.9973794582448391, 'auprc': 0.9987081180007151, 'loss_val': 0.03818106785876811, 'psi': 0.9979109221471895}-{'f1_val': 0.9437956314670307, 'auprc': 0.997000069867611, 'loss_val': 0.0923572617259856, 'psi': 0.965077406827263}
[S15] START round=47 head_norm_before_train=1.810586 cos_to_last_merge=0.9798 (last merge round=31)
[S15] round=47 local utility u=0.886308 metrics={'f1_val': 0.9436709872920923, 'auprc': 0.9930458757419416, 'loss_val': 0.09628170272298146, 'psi': 0.963420942672032}-{'f1_val': 0.7182707133183666, 'auprc': 0.9891281609943089, 'loss_val': 0.5047433680770651, 'psi': 0.8266136923887435}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=47 head_norm_before_train=2.122040 (no previous merge yet)
[S16] round=47 local utility u=0.000985 metrics={'f1_val': 0.9928680781018704, 'auprc': 0.9951849583889538, 'loss_val': 0.03727344496846062, 'psi': 0.9937948302167038}-{'f1_val': 0.9924497697178112, 'auprc': 0.9954448658130315, 'loss_val': 0.037512435242169385, 'psi': 0.9936478081558994}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S17] START round=47 head_norm_before_train=1.899191 cos_to_last_merge=0.7960 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.796
[S17] round=47 local utility u=0.776947 metrics={'f1_val': 0.9907686299870493, 'auprc': 0.9884680899150783, 'loss_val': 0.06107092682253744, 'psi': 0.9898484139582608}-{'f1_val': 0.7911434536977198, 'auprc': 0.9868106840640756, 'loss_val': 0.4122410310256951, 'psi': 0.8694103458442621}
[S17] not sending this round → trigger blocked (psi=0.990)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] → sending delta(kind=head bytes=1805) to S11@127.0.0.1:59812
[S14] sending update (kind=head size=1805 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1805) from S14
[S11] cosine check vs S14: cos=0.9999
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=47 metric=0.9974 head_norm=1.650911
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.225709e-02
[S14] stored merged vector for next round verification (round=47)
[S14] DEBUG after merge:  round=47 metric=0.9974 head_norm=1.646334 delta_norm=0.012257
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=48 head_norm_before_train=2.209765 cos_to_last_merge=0.9837 (last merge round=23)
[S2] round=48 local utility u=0.030548 metrics={'f1_val': 0.7187015176449927, 'auprc': 0.7258261432238369, 'loss_val': 0.9106877225606753, 'psi': 0.7215513678765304}-{'f1_val': 0.712365900014146, 'auprc': 0.7274379279564329, 'loss_val': 0.9386051322171338, 'psi': 0.7183947111910607}
[S2] not sending this round → trigger blocked (psi=0.722)
[S3] START round=48 head_norm_before_train=2.179302 cos_to_last_merge=0.9980 (last merge round=31)
[S3] round=48 local utility u=0.208352 metrics={'f1_val': 0.9973982357793907, 'auprc': 0.9971633071883286, 'loss_val': 0.01920945241008721, 'psi': 0.9973042643429659}-{'f1_val': 0.9610352511054436, 'auprc': 0.9736725467522294, 'loss_val': 0.14726250875983113, 'psi': 0.9660901693641579}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=48 head_norm_before_train=2.123310 cos_to_last_merge=0.9887 (last merge round=25)
[S4] round=48 local utility u=0.005497 metrics={'f1_val': 0.9513370864797814, 'auprc': 0.9507680059563703, 'loss_val': 0.31664573534646395, 'psi': 0.951109454270417}-{'f1_val': 0.9552488625768655, 'auprc': 0.9393755546201544, 'loss_val': 0.31693294531128735, 'psi': 0.948899539394181}
[S4] not sending this round → trigger blocked (psi=0.951)
[S5] START round=48 head_norm_before_train=1.523173 cos_to_last_merge=0.9729 (last merge round=30)
[S5] round=48 local utility u=0.000000 metrics={'f1_val': 0.5850410651398132, 'auprc': 0.8554576691908279, 'loss_val': 0.6482886589795667, 'psi': 0.6932077067602191}-{'f1_val': 0.6755748665804224, 'auprc': 0.8617687925765279, 'loss_val': 0.7121865911804567, 'psi': 0.7500524369788646}
[S6] START round=48 head_norm_before_train=1.740576 cos_to_last_merge=0.9848 (last merge round=30)
[S6] round=48 local utility u=0.000000 metrics={'f1_val': 0.6128734493937325, 'auprc': 0.8897728231720989, 'loss_val': 0.9053781429789066, 'psi': 0.723633198905079}-{'f1_val': 0.8121261798748045, 'auprc': 0.9440357072377549, 'loss_val': 0.3969499413401426, 'psi': 0.8648899908199846}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=48 head_norm_before_train=1.545488 cos_to_last_merge=0.8182 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.818
[S7] round=48 local utility u=0.000000 metrics={'f1_val': 0.617029093726498, 'auprc': 0.7946032651437334, 'loss_val': 0.6425618523324109, 'psi': 0.6880587622933921}-{'f1_val': 0.6738053901029643, 'auprc': 0.838538059963115, 'loss_val': 0.33117740084665026, 'psi': 0.7396984580470245}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=48 head_norm_before_train=2.204582 (no previous merge yet)
[S8] round=48 local utility u=0.122873 metrics={'f1_val': 0.9931893602624928, 'auprc': 0.9996246122476121, 'loss_val': 0.025843640263717625, 'psi': 0.9957634610565406}-{'f1_val': 0.9654516400251782, 'auprc': 0.9994510244466546, 'loss_val': 0.10464243089120752, 'psi': 0.9790513937937688}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=48 head_norm_before_train=1.527462 cos_to_last_merge=1.0000 (last merge round=47)
[S9] round=48 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9945384200896843, 'loss_val': 0.053336166730203666, 'psi': 0.9960771155431594}-{'f1_val': 0.9966857875385419, 'auprc': 0.9983971683188186, 'loss_val': 0.049921451020827456, 'psi': 0.9973703398506526}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=48 head_norm_before_train=2.054188 cos_to_last_merge=0.7484 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.748
[S10] round=48 local utility u=0.000374 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9970900203047364, 'loss_val': 0.03161421387076985, 'psi': 0.9949768019410512}-{'f1_val': 0.9935262985458464, 'auprc': 0.9971297769574774, 'loss_val': 0.03223074547296454, 'psi': 0.9949676899104988}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=48 head_norm_before_train=1.653970 cos_to_last_merge=0.9999 (last merge round=45)
[S11] round=48 local utility u=0.001791 metrics={'f1_val': 0.9982515059399775, 'auprc': 0.9993966394885285, 'loss_val': 0.03308586567752658, 'psi': 0.998709559359398}-{'f1_val': 0.9971593530989756, 'auprc': 0.9993952233819106, 'loss_val': 0.03011068666834621, 'psi': 0.9980537012121496}
[S13] START round=48 head_norm_before_train=1.962042 (no previous merge yet)
[S13] round=48 local utility u=0.358407 metrics={'f1_val': 0.7042957942030733, 'auprc': 0.6788699852549882, 'loss_val': 1.056805330013593, 'psi': 0.6941254706238393}-{'f1_val': 0.6336298602629147, 'auprc': 0.6283573744499887, 'loss_val': 1.198086070963649, 'psi': 0.6315208659377443}
[S13] not sending this round → trigger blocked (psi=0.694)
[S14] START round=48 head_norm_before_train=1.646334 cos_to_last_merge=1.0000 (last merge round=47)
[S14] round=48 local utility u=0.001770 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9986043904875943, 'loss_val': 0.03450344978865208, 'psi': 0.9978867178960731}-{'f1_val': 0.9973794582448391, 'auprc': 0.9987081180007151, 'loss_val': 0.03818106785876811, 'psi': 0.9979109221471895}
[S15] START round=48 head_norm_before_train=1.826343 cos_to_last_merge=0.9788 (last merge round=31)
[S15] round=48 local utility u=0.000000 metrics={'f1_val': 0.9375647370925133, 'auprc': 0.9931706311021976, 'loss_val': 0.11040953416168547, 'psi': 0.959807094696387}-{'f1_val': 0.9436709872920923, 'auprc': 0.9930458757419416, 'loss_val': 0.09628170272298146, 'psi': 0.963420942672032}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=48 head_norm_before_train=2.127753 (no previous merge yet)
[S16] round=48 local utility u=0.000000 metrics={'f1_val': 0.9357775399257074, 'auprc': 0.9844153449371625, 'loss_val': 0.4008919148132456, 'psi': 0.9552326619302894}-{'f1_val': 0.9928680781018704, 'auprc': 0.9951849583889538, 'loss_val': 0.03727344496846062, 'psi': 0.9937948302167038}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=48 head_norm_before_train=1.905501 cos_to_last_merge=0.7952 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.795
[S17] round=48 local utility u=0.000000 metrics={'f1_val': 0.9652167172983572, 'auprc': 0.9760353461580089, 'loss_val': 0.11292474861068724, 'psi': 0.969544168842218}-{'f1_val': 0.9907686299870493, 'auprc': 0.9884680899150783, 'loss_val': 0.06107092682253744, 'psi': 0.9898484139582608}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:59814
[S14] not sending this round → trigger blocked (psi=0.998)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1798 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1798) from S11
[S14] cosine check vs S11: cos=0.9998
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=48 metric=0.9983 head_norm=1.666091
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.834915e-02
[S11] stored merged vector for next round verification (round=48)
[S11] DEBUG after merge:  round=48 metric=0.9983 head_norm=1.658417 delta_norm=0.018349
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=49 head_norm_before_train=2.216768 cos_to_last_merge=0.9833 (last merge round=23)
[S2] round=49 local utility u=0.022219 metrics={'f1_val': 0.7198213571115573, 'auprc': 0.7340763169914317, 'loss_val': 0.8977201387119479, 'psi': 0.725523341063507}-{'f1_val': 0.7187015176449927, 'auprc': 0.7258261432238369, 'loss_val': 0.9106877225606753, 'psi': 0.7215513678765304}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=49 head_norm_before_train=2.188152 cos_to_last_merge=0.9978 (last merge round=31)
[S3] round=49 local utility u=0.000000 metrics={'f1_val': 0.9973982357793907, 'auprc': 0.9975275738742757, 'loss_val': 0.02344720430004501, 'psi': 0.9974499710173448}-{'f1_val': 0.9973982357793907, 'auprc': 0.9971633071883286, 'loss_val': 0.01920945241008721, 'psi': 0.9973042643429659}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=49 head_norm_before_train=2.129403 cos_to_last_merge=0.9884 (last merge round=25)
[S4] round=49 local utility u=0.010065 metrics={'f1_val': 0.9513787061252059, 'auprc': 0.9573494251139582, 'loss_val': 0.316509332074687, 'psi': 0.9537669937207067}-{'f1_val': 0.9513370864797814, 'auprc': 0.9507680059563703, 'loss_val': 0.31664573534646395, 'psi': 0.951109454270417}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=49 head_norm_before_train=1.533354 cos_to_last_merge=0.9718 (last merge round=30)
[S5] round=49 local utility u=0.664439 metrics={'f1_val': 0.7004932948021524, 'auprc': 0.9770340086464968, 'loss_val': 0.3768525316747868, 'psi': 0.8111095803398902}-{'f1_val': 0.5850410651398132, 'auprc': 0.8554576691908279, 'loss_val': 0.6482886589795667, 'psi': 0.6932077067602191}
[S6] START round=49 head_norm_before_train=1.759634 cos_to_last_merge=0.9833 (last merge round=30)
[S6] round=49 local utility u=1.000000 metrics={'f1_val': 0.9662256998574592, 'auprc': 0.9579182257529084, 'loss_val': 0.15787628829620917, 'psi': 0.9629027102156389}-{'f1_val': 0.6128734493937325, 'auprc': 0.8897728231720989, 'loss_val': 0.9053781429789066, 'psi': 0.723633198905079}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=49 head_norm_before_train=1.549342 cos_to_last_merge=0.8178 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.818
[S7] round=49 local utility u=0.430767 metrics={'f1_val': 0.6757309188829064, 'auprc': 0.8475004651806428, 'loss_val': 0.29193139687922603, 'psi': 0.744438737402001}-{'f1_val': 0.617029093726498, 'auprc': 0.7946032651437334, 'loss_val': 0.6425618523324109, 'psi': 0.6880587622933921}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=49 head_norm_before_train=2.208294 (no previous merge yet)
[S8] round=49 local utility u=0.000000 metrics={'f1_val': 0.9921838161133336, 'auprc': 0.9962208183762481, 'loss_val': 0.028660644360497554, 'psi': 0.9937986170184994}-{'f1_val': 0.9931893602624928, 'auprc': 0.9996246122476121, 'loss_val': 0.025843640263717625, 'psi': 0.9957634610565406}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=49 head_norm_before_train=1.545070 cos_to_last_merge=0.9999 (last merge round=47)
[S9] round=49 local utility u=0.008542 metrics={'f1_val': 0.9971000495392299, 'auprc': 0.9983976763658436, 'loss_val': 0.04781251577337914, 'psi': 0.9976191002698754}-{'f1_val': 0.9971029125121428, 'auprc': 0.9945384200896843, 'loss_val': 0.053336166730203666, 'psi': 0.9960771155431594}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] sending update (kind=head size=1804 to 1 peers)
[S10] START round=49 head_norm_before_train=2.056767 cos_to_last_merge=0.7482 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.748
[S10] round=49 local utility u=0.000000 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9968183745401974, 'loss_val': 0.031219672287652326, 'psi': 0.9948681436352356}-{'f1_val': 0.9935679896985945, 'auprc': 0.9970900203047364, 'loss_val': 0.03161421387076985, 'psi': 0.9949768019410512}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=49 head_norm_before_train=1.658417 cos_to_last_merge=1.0000 (last merge round=48)
[S11] round=49 local utility u=0.000000 metrics={'f1_val': 0.9974011907167429, 'auprc': 0.9991544302558983, 'loss_val': 0.02793995007229387, 'psi': 0.9981024865324051}-{'f1_val': 0.9982515059399775, 'auprc': 0.9993966394885285, 'loss_val': 0.03308586567752658, 'psi': 0.998709559359398}
[S13] START round=49 head_norm_before_train=1.975240 (no previous merge yet)
[S13] round=49 local utility u=0.000000 metrics={'f1_val': 0.6747548426891173, 'auprc': 0.7008348695930426, 'loss_val': 0.959530561679139, 'psi': 0.6851868534506874}-{'f1_val': 0.7042957942030733, 'auprc': 0.6788699852549882, 'loss_val': 1.056805330013593, 'psi': 0.6941254706238393}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=49 head_norm_before_train=1.656836 cos_to_last_merge=1.0000 (last merge round=47)
[S14] round=49 local utility u=0.001288 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.9989457766468811, 'loss_val': 0.0354185938031009, 'psi': 0.9982700214390835}-{'f1_val': 0.9974082695017256, 'auprc': 0.9986043904875943, 'loss_val': 0.03450344978865208, 'psi': 0.9978867178960731}
[S15] START round=49 head_norm_before_train=1.843173 cos_to_last_merge=0.9778 (last merge round=31)
[S15] round=49 local utility u=0.000000 metrics={'f1_val': 0.7007659221024161, 'auprc': 0.9803962065686921, 'loss_val': 0.6297055604688866, 'psi': 0.8126180358889266}-{'f1_val': 0.9375647370925133, 'auprc': 0.9931706311021976, 'loss_val': 0.11040953416168547, 'psi': 0.959807094696387}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=49 head_norm_before_train=2.133588 (no previous merge yet)
[S16] round=49 local utility u=0.369830 metrics={'f1_val': 0.9928680781018704, 'auprc': 0.9954538206291812, 'loss_val': 0.03689061345806033, 'psi': 0.9939023751127948}-{'f1_val': 0.9357775399257074, 'auprc': 0.9844153449371625, 'loss_val': 0.4008919148132456, 'psi': 0.9552326619302894}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] sending update (kind=head size=1793 to 1 peers)
[S17] START round=49 head_norm_before_train=1.909096 cos_to_last_merge=0.7943 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.794
[S17] round=49 local utility u=0.000000 metrics={'f1_val': 0.7286053765993122, 'auprc': 0.9160755837014942, 'loss_val': 0.9395808468407122, 'psi': 0.803593459440185}-{'f1_val': 0.9652167172983572, 'auprc': 0.9760353461580089, 'loss_val': 0.11292474861068724, 'psi': 0.969544168842218}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S5] → sending delta(kind=head bytes=1807) to S9@127.0.0.1:59810
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S14] → sending delta(kind=head bytes=1806) to S11@127.0.0.1:59812
[S5] sending update (kind=head size=1807 to 1 peers)
[S14] sending update (kind=head size=1806 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1807) from S5
[S9] cosine check vs S5: cos=0.9960
[S11] RECEIVED delta(kind=head bytes=1806) from S14
[S11] cosine check vs S14: cos=0.9999
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=49 metric=0.9978 head_norm=1.668005
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.862144e-02
[S14] stored merged vector for next round verification (round=49)
[S14] DEBUG after merge:  round=49 metric=0.9978 head_norm=1.666944 delta_norm=0.018621
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[runner] rounds complete.
[runner] all agents stopped.
