[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:44903
[S3] → join 127.0.0.1:44902
[S4] → join 127.0.0.1:44902
[S5] → join 127.0.0.1:44902
[S6] → join 127.0.0.1:44902
[S7] → join 127.0.0.1:44902
[S8] → join 127.0.0.1:44902
[S9] → join 127.0.0.1:44902
[S10] → join 127.0.0.1:44902
[S11] → join 127.0.0.1:44902
[S13] → join 127.0.0.1:44902
[S14] → join 127.0.0.1:44902
[S15] → join 127.0.0.1:44902
[S16] → join 127.0.0.1:44902
[S17] → join 127.0.0.1:44902
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.181503 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.195505 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.155745 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.113502 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.113716 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.168116 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.181627 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.173488 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.153512 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.160484 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.264097 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.177080 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.162451 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.183128 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.177288 (no previous merge yet)
[S4]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S3] + discovered S5
[S3] + discovered S16
[S3] + discovered S6
[S3] + discovered S13
[S3] + discovered S8
[S3] + discovered S15
[S3] + discovered S14
[S3] + discovered S17
[S3] + discovered S7
[S3] + discovered S9
[S3] + discovered S4
[S3] + discovered S11
[S3] + discovered S10
[S4] + discovered S2
[S4] + discovered S3
[S4] + discovered S9
[S4] + discovered S16
[S4] + discovered S5
[S4] + discovered S6
[S4] + discovered S8
[S4] + discovered S14
[S4] + discovered S13
[S4] + discovered S17
[S4] + discovered S15
[S4] + discovered S7
[S4] + discovered S11
[S4] + discovered S10
[S5] + discovered S2
[S5] + discovered S4
[S5] + discovered S3
[S5] + discovered S16
[S5] + discovered S8
[S6] + discovered S5
[S6] + discovered S2
[S6] + discovered S3
[S6] + discovered S4
[S5] + discovered S14
[S5] + discovered S11
[S5] + discovered S7
[S5] + discovered S15
[S5] + discovered S13
[S5] + discovered S6
[S5] + discovered S9
[S5] + discovered S10
[S5] + discovered S17
[S6] + discovered S15
[S6] + discovered S9
[S6] + discovered S10
[S6] + discovered S13
[S7] + discovered S6
[S7] + discovered S3
[S7] + discovered S4
[S7] + discovered S5
[S7] + discovered S2
[S6] + discovered S14
[S6] + discovered S11
[S6] + discovered S16
[S6] + discovered S17
[S6] + discovered S8
[S6] + discovered S7
[S8] + discovered S6
[S8] + discovered S3
[S8] + discovered S5
[S8] + discovered S7
[S8] + discovered S4
[S8] + discovered S2
[S7] + discovered S14
[S7] + discovered S16
[S7] + discovered S17
[S7] + discovered S9
[S7] + discovered S11
[S7] + discovered S8
[S7] + discovered S15
[S7] + discovered S10
[S7] + discovered S13
[S8] + discovered S17
[S8] + discovered S15
[S8] + discovered S9
[S8] + discovered S14
[S8] + discovered S13
[S8] + discovered S10
[S8] + discovered S11
[S8] + discovered S16
[S9] + discovered S2
[S9] + discovered S4
[S9] + discovered S5
[S9] + discovered S3
[S9] + discovered S7
[S9] + discovered S8
[S9] + discovered S6
[S10] + discovered S3
[S10] + discovered S7
[S10] + discovered S9
[S10] + discovered S2
[S10] + discovered S6
[S10] + discovered S8
[S10] + discovered S5
[S10] + discovered S4
[S9] + discovered S11
[S9] + discovered S10
[S9] + discovered S14
[S9] + discovered S17
[S9] + discovered S16
[S9] + discovered S13
[S9] + discovered S15
[S10] + discovered S11
[S11] + discovered S9
[S10] + discovered S16
[S11] + discovered S7
[S10] + discovered S15
[S10] + discovered S14
[S10] + discovered S17
[S10] + discovered S13
[S11] + discovered S2
[S11] + discovered S6
[S11] + discovered S8
[S11] + discovered S10
[S11] + discovered S5
[S11] + discovered S4
[S11] + discovered S3
[S11] + discovered S15
[S11] + discovered S16
[S11] + discovered S13
[S11] + discovered S17
[S11] + discovered S14
[S13] + discovered S3
[S13] + discovered S6
[S13] + discovered S8
[S13] + discovered S5
[S13] + discovered S10
[S13] + discovered S11
[S13] + discovered S2
[S13] + discovered S4
[S13] + discovered S7
[S13] + discovered S9
[S14] + discovered S13
[S14] + discovered S8
[S14] + discovered S11
[S14] + discovered S10
[S14] + discovered S5
[S14] + discovered S6
[S14] + discovered S3
[S13] + discovered S17
[S14] + discovered S9
[S13] + discovered S15
[S14] + discovered S7
[S13] + discovered S14
[S14] + discovered S4
[S13] + discovered S16
[S14] + discovered S2
[S15] + discovered S4
[S14] + discovered S16
[S15] + discovered S7
[S15] + discovered S9
[S15] + discovered S10
[S15] + discovered S5
[S15] + discovered S14
[S15] + discovered S2
[S15] + discovered S6
[S15] + discovered S3
[S15] + discovered S11
[S14] + discovered S17
[S15] + discovered S8
[S15] + discovered S13
[S14] + discovered S15
[S16] + discovered S5
[S16] + discovered S8
[S16] + discovered S4
[S16] + discovered S13
[S16] + discovered S3
[S16] + discovered S6
[S16] + discovered S2
[S16] + discovered S15
[S16] + discovered S14
[S16] + discovered S7
[S16] + discovered S10
[S16] + discovered S9
[S16] + discovered S11
[S15] + discovered S16
[S15] + discovered S17
[S17] + discovered S3
[S17] + discovered S4
[S17] + discovered S14
[S17] + discovered S15
[S17] + discovered S16
[S17] + discovered S5
[S17] + discovered S7
[S17] + discovered S6
[S17] + discovered S13
[S17] + discovered S8
[S16] + discovered S17
[S17] + discovered S2
[S17] + discovered S11
[S17] + discovered S9
[S17] + discovered S10
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] ⇄ pheromone p=1.000 → S14@127.0.0.1:44914
[S4] ⇄ pheromone p=1.000 → S11@127.0.0.1:44912
[S7] ⇄ pheromone p=1.000 → S3@127.0.0.1:44903
[S10] ⇄ pheromone p=1.000 → S9@127.0.0.1:44910
[S5] ⇄ pheromone p=1.000 → S16@127.0.0.1:44916
[S13] ⇄ pheromone p=1.000 → S10@127.0.0.1:44911
[S6] ⇄ pheromone p=1.000 → S8@127.0.0.1:44909
[S8] ⇄ pheromone p=1.000 → S9@127.0.0.1:44910
[S9] ⇄ pheromone p=1.000 → S16@127.0.0.1:44916
[S2] ⇄ pheromone p=1.000 → S15@127.0.0.1:44915
[S14] ⇄ pheromone p=1.000 → S8@127.0.0.1:44909
[S15] ⇄ pheromone p=1.000 → S5@127.0.0.1:44905
[S3] ⇄ pheromone p=1.000 → S2@127.0.0.1:44902
[S11] ⇄ pheromone p=1.000 → S15@127.0.0.1:44915
[S17] ⇄ pheromone p=1.000 → S3@127.0.0.1:44903
[S2] START round=1 head_norm_before_train=1.183269 (no previous merge yet)
[S2] round=1 local utility u=0.034806 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6167696297958534, 'loss_val': 1.3223720182615415, 'psi': 0.33177413195148137}-{'f1_val': 0.16609251968503938, 'auprc': 0.5569868241682192, 'loss_val': 1.3585273140336849, 'psi': 0.3224502414783113}
[S3] START round=1 head_norm_before_train=1.211135 (no previous merge yet)
[S3] round=1 local utility u=0.028601 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9982170205673799, 'loss_val': 1.2756225767657017, 'psi': 0.4831908475954162}-{'f1_val': 0.13984006561410703, 'auprc': 0.9980603208691967, 'loss_val': 1.332354672899993, 'psi': 0.483128167716143}
[S4] START round=1 head_norm_before_train=1.158282 (no previous merge yet)
[S4] round=1 local utility u=0.019991 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7737431624908115, 'loss_val': 1.317504925322091, 'psi': 0.3936332423334351}-{'f1_val': 0.14022662889518414, 'auprc': 0.7707306185576134, 'loss_val': 1.3484483735049697, 'psi': 0.3924282247601559}
[S5] START round=1 head_norm_before_train=1.113069 (no previous merge yet)
[S5] round=1 local utility u=0.294107 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.729582505836064, 'loss_val': 1.2891081365493935, 'psi': 0.37719014519156846}-{'f1_val': 0.14226190476190476, 'auprc': 0.5545557905410419, 'loss_val': 1.35224180860834, 'psi': 0.3071794590735596}
[S6] START round=1 head_norm_before_train=1.115515 (no previous merge yet)
[S6] round=1 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.7212711427644952, 'loss_val': 1.3307644333617357, 'psi': 0.3733642263365673}-{'f1_val': 0.4162147533511509, 'auprc': 0.6705873092794105, 'loss_val': 1.3636655143863803, 'psi': 0.5179637757224547}
[S7] START round=1 head_norm_before_train=1.181042 (no previous merge yet)
[S7] round=1 local utility u=0.041883 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.5875067509773818, 'loss_val': 1.2779740002804174, 'psi': 0.3202367940284077}-{'f1_val': 0.14205682272909165, 'auprc': 0.576829987766769, 'loss_val': 1.3297093611254007, 'psi': 0.3159660887441626}
[S8] START round=1 head_norm_before_train=1.186721 (no previous merge yet)
[S8] round=1 local utility u=0.019366 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7659452456210666, 'loss_val': 1.2941388186117946, 'psi': 0.390351687684201}-{'f1_val': 0.13995598239295717, 'auprc': 0.7643885791866343, 'loss_val': 1.3282009031502726, 'psi': 0.38972902111042806}
[S9] START round=1 head_norm_before_train=1.189524 (no previous merge yet)
[S9] round=1 local utility u=0.287487 metrics={'f1_val': 0.141397957139996, 'auprc': 0.7949018444016512, 'loss_val': 1.2502664491387405, 'psi': 0.40279951204465814}-{'f1_val': 0.141397957139996, 'auprc': 0.6322796269928616, 'loss_val': 1.3373745833298611, 'psi': 0.33775062508114223}
[S10] START round=1 head_norm_before_train=1.160797 (no previous merge yet)
[S10] round=1 local utility u=0.085352 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7274887199357145, 'loss_val': 1.3351158400560241, 'psi': 0.37416847049932017}-{'f1_val': 0.13862163754172394, 'auprc': 0.6803873614300859, 'loss_val': 1.3645162855726194, 'psi': 0.35532792709706873}
[S11] START round=1 head_norm_before_train=1.160830 (no previous merge yet)
[S11] round=1 local utility u=0.202278 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.3884610484469245, 'loss_val': 1.3500985980548839, 'psi': 0.23963262940263613}-{'f1_val': 0.14041368337311058, 'auprc': 0.2638844327588533, 'loss_val': 1.3809238325432525, 'psi': 0.18980198312740768}
[S13] START round=1 head_norm_before_train=1.262375 (no previous merge yet)
[S13] round=1 local utility u=0.000000 metrics={'f1_val': 0.1541484716157205, 'auprc': 0.7734803109037098, 'loss_val': 1.3193389671379543, 'psi': 0.40188120733091626}-{'f1_val': 0.27159589806203566, 'auprc': 0.6139652085446362, 'loss_val': 1.3485339265998537, 'psi': 0.4085436222550759}
[S14] START round=1 head_norm_before_train=1.180717 (no previous merge yet)
[S14] round=1 local utility u=0.233017 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.5809469767888186, 'loss_val': 1.3377164401512418, 'psi': 0.3165935024451497}-{'f1_val': 0.14035785288270378, 'auprc': 0.43380362814475426, 'loss_val': 1.3623198058599941, 'psi': 0.257736162987524}
[S15] START round=1 head_norm_before_train=1.167978 (no previous merge yet)
[S15] round=1 local utility u=0.848892 metrics={'f1_val': 0.36016099234626553, 'auprc': 0.7594767019311636, 'loss_val': 1.3239437926835933, 'psi': 0.5198872761802248}-{'f1_val': 0.09269662921348315, 'auprc': 0.7375799440185677, 'loss_val': 1.351251440319348, 'psi': 0.350649955135517}
[S16] START round=1 head_norm_before_train=1.177877 (no previous merge yet)
[S16] round=1 local utility u=0.091017 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8396145672901587, 'loss_val': 1.325224530864813, 'psi': 0.4202282970355854}-{'f1_val': 0.14063745019920318, 'auprc': 0.7874108071600802, 'loss_val': 1.3506472680152068, 'psi': 0.399346792983554}
[S17] START round=1 head_norm_before_train=1.181976 (no previous merge yet)
[S17] round=1 local utility u=0.282694 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.6543803732845241, 'loss_val': 1.3208876500000446, 'psi': 0.3463215273042403}-{'f1_val': 0.14094896331738438, 'auprc': 0.47400652780588354, 'loss_val': 1.345155097894988, 'psi': 0.27417198911278406}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:44909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S4] → sending delta(kind=head bytes=1792) to S16@127.0.0.1:44916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:44907
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S2] → sending delta(kind=head bytes=1789) to S7@127.0.0.1:44908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S7] → sending delta(kind=head bytes=1788) to S2@127.0.0.1:44902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S14] → sending delta(kind=head bytes=1788) to S15@127.0.0.1:44915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:44910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] → sending delta(kind=head bytes=1794) to S17@127.0.0.1:44917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S5] → sending delta(kind=head bytes=1791) to S17@127.0.0.1:44917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S8] → sending delta(kind=head bytes=1788) to S13@127.0.0.1:44913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S15] → sending delta(kind=head bytes=1787) to S3@127.0.0.1:44903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S16] → sending delta(kind=head bytes=1791) to S6@127.0.0.1:44907
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1791 to 1 peers)
[S15] sending update (kind=head size=1787 to 1 peers)
[S8] sending update (kind=head size=1788 to 1 peers)
[S5] sending update (kind=head size=1791 to 1 peers)
[S3] sending update (kind=head size=1794 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1788 to 1 peers)
[S7] sending update (kind=head size=1788 to 1 peers)
[S2] sending update (kind=head size=1789 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1792 to 1 peers)
[S11] sending update (kind=head size=1794 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1795) from S10
[S9] cosine check vs S10: cos=-0.0321
[S9] DROPPED delta from S10 (cos=-0.0321 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1792) from S4
[S16] cosine check vs S4: cos=0.0058
[S8] RECEIVED delta(kind=head bytes=1794) from S11
[S8] cosine check vs S11: cos=0.0207
[S6] RECEIVED delta(kind=head bytes=1791) from S16
[S6] cosine check vs S16: cos=-0.0612
[S6] DROPPED delta from S16 (cos=-0.0612 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1796) from S9
[S6] cosine check vs S9: cos=0.0191
[S17] RECEIVED delta(kind=head bytes=1791) from S5
[S17] cosine check vs S5: cos=-0.0145
[S17] DROPPED delta from S5 (cos=-0.0145 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1789) from S2
[S7] cosine check vs S2: cos=0.1027
[S17] RECEIVED delta(kind=head bytes=1794) from S3
[S17] cosine check vs S3: cos=-0.0486
[S17] DROPPED delta from S3 (cos=-0.0486 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1788) from S8
[S13] cosine check vs S8: cos=0.0921
[S2] RECEIVED delta(kind=head bytes=1788) from S7
[S2] cosine check vs S7: cos=0.1027
[S15] RECEIVED delta(kind=head bytes=1788) from S14
[S15] cosine check vs S14: cos=-0.0064
[S15] DROPPED delta from S14 (cos=-0.0064 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1787) from S15
[S3] cosine check vs S15: cos=-0.0492
[S3] DROPPED delta from S15 (cos=-0.0492 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S17] → sending delta(kind=head bytes=1788) to S16@127.0.0.1:44916
[S17] sending update (kind=head size=1788 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1788) from S17
[S16] cosine check vs S17: cos=0.0350
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=1 metric=0.1414 head_norm=1.127346
[S6] _apply_head_vector_avg (torch): Δ‖w‖=8.264009e-01
[S6] stored merged vector for next round verification (round=1)
[S6] DEBUG after merge:  round=1 metric=0.1414 head_norm=0.842278 delta_norm=0.826401
[S6] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=1 metric=0.1541 head_norm=1.273060
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.345633e-01
[S13] stored merged vector for next round verification (round=1)
[S13] DEBUG after merge:  round=1 metric=0.1404 head_norm=0.915208 delta_norm=0.834563
[S13] aggregate: ROLLBACK (f1_val pre=0.154 post=0.140 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=1 metric=0.1406 head_norm=1.184186
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.157918e-01
[S16] stored merged vector for next round verification (round=1)
[S16] DEBUG after merge:  round=1 metric=0.1406 head_norm=0.735677 delta_norm=0.715792
[S16] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=1 metric=0.1418 head_norm=1.192886
[S2] _apply_head_vector_avg (torch): Δ‖w‖=8.062804e-01
[S2] stored merged vector for next round verification (round=1)
[S2] DEBUG after merge:  round=1 metric=0.1418 head_norm=0.893762 delta_norm=0.806280
[S2] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=1 metric=0.1400 head_norm=1.203130
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.300477e-01
[S8] stored merged vector for next round verification (round=1)
[S8] DEBUG after merge:  round=1 metric=0.1400 head_norm=0.847396 delta_norm=0.830048
[S8] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=1 metric=0.1421 head_norm=1.214422
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.062804e-01
[S7] stored merged vector for next round verification (round=1)
[S7] DEBUG after merge:  round=1 metric=0.1421 head_norm=0.893762 delta_norm=0.806280
[S7] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=0.893762 cos_to_last_merge=1.0000 (last merge round=1)
[S2] round=2 local utility u=0.049693 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6447502514842943, 'loss_val': 1.3069285192483093, 'psi': 0.3429663806268578}-{'f1_val': 0.1417771333885667, 'auprc': 0.6167696297958534, 'loss_val': 1.3223720182615415, 'psi': 0.33177413195148137}
[S3] START round=2 head_norm_before_train=1.244851 (no previous merge yet)
[S3] round=2 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.6176373361253242, 'loss_val': 1.199328240495291, 'psi': 0.33095897381859396}-{'f1_val': 0.13984006561410703, 'auprc': 0.9982170205673799, 'loss_val': 1.2756225767657017, 'psi': 0.4831908475954162}
[S4] START round=2 head_norm_before_train=1.172014 (no previous merge yet)
[S4] round=2 local utility u=0.027010 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7784070137820965, 'loss_val': 1.277475965809793, 'psi': 0.3954987828499491}-{'f1_val': 0.14022662889518414, 'auprc': 0.7737431624908115, 'loss_val': 1.317504925322091, 'psi': 0.3936332423334351}
[S5] START round=2 head_norm_before_train=1.136570 (no previous merge yet)
[S5] round=2 local utility u=0.047585 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7418196294050841, 'loss_val': 1.2306488072108344, 'psi': 0.3820849946191765}-{'f1_val': 0.14226190476190476, 'auprc': 0.729582505836064, 'loss_val': 1.2891081365493935, 'psi': 0.37719014519156846}
[S6] START round=2 head_norm_before_train=0.842278 cos_to_last_merge=1.0000 (last merge round=1)
[S6] round=2 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6166100607822297, 'loss_val': 1.318882107954966, 'psi': 0.3314997935436611}-{'f1_val': 0.14142628205128205, 'auprc': 0.7212711427644952, 'loss_val': 1.3307644333617357, 'psi': 0.3733642263365673}
[S7] START round=2 head_norm_before_train=0.893762 cos_to_last_merge=1.0000 (last merge round=1)
[S7] round=2 local utility u=0.012516 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.5865660670157592, 'loss_val': 1.2501208228586442, 'psi': 0.3198605204437587}-{'f1_val': 0.14205682272909165, 'auprc': 0.5875067509773818, 'loss_val': 1.2779740002804174, 'psi': 0.3202367940284077}
[S8] START round=2 head_norm_before_train=0.847396 cos_to_last_merge=1.0000 (last merge round=1)
[S8] round=2 local utility u=0.000911 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7660998014790005, 'loss_val': 1.2927811657243196, 'psi': 0.3904135100273745}-{'f1_val': 0.13995598239295717, 'auprc': 0.7659452456210666, 'loss_val': 1.2941388186117946, 'psi': 0.390351687684201}
[S9] START round=2 head_norm_before_train=1.230379 (no previous merge yet)
[S9] round=2 local utility u=0.342421 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9871019736942358, 'loss_val': 1.1420242539771723, 'psi': 0.47967956376169196}-{'f1_val': 0.141397957139996, 'auprc': 0.7949018444016512, 'loss_val': 1.2502664491387405, 'psi': 0.40279951204465814}
[S10] START round=2 head_norm_before_train=1.175892 (no previous merge yet)
[S10] round=2 local utility u=0.078016 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7676197113280958, 'loss_val': 1.2994777967708544, 'psi': 0.3902208670562727}-{'f1_val': 0.13862163754172394, 'auprc': 0.7274887199357145, 'loss_val': 1.3351158400560241, 'psi': 0.37416847049932017}
[S11] START round=2 head_norm_before_train=1.169015 (no previous merge yet)
[S11] round=2 local utility u=0.291894 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.5720724257404789, 'loss_val': 1.3171444424137273, 'psi': 0.31307718032005794}-{'f1_val': 0.14041368337311058, 'auprc': 0.3884610484469245, 'loss_val': 1.3500985980548839, 'psi': 0.23963262940263613}
[S13] START round=2 head_norm_before_train=0.915208 cos_to_last_merge=1.0000 (last merge round=1)
[S13] round=2 local utility u=0.000000 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.6493615698746289, 'loss_val': 1.3166960540503228, 'psi': 0.34397608549608344}-{'f1_val': 0.1541484716157205, 'auprc': 0.7734803109037098, 'loss_val': 1.3193389671379543, 'psi': 0.40188120733091626}
[S14] START round=2 head_norm_before_train=1.197819 (no previous merge yet)
[S14] round=2 local utility u=0.203807 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7074730904082398, 'loss_val': 1.3096805041180701, 'psi': 0.36720394789291816}-{'f1_val': 0.14035785288270378, 'auprc': 0.5809469767888186, 'loss_val': 1.3377164401512418, 'psi': 0.3165935024451497}
[S15] START round=2 head_norm_before_train=1.184975 (no previous merge yet)
[S15] round=2 local utility u=0.000000 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7753971944075218, 'loss_val': 1.2920999220537255, 'psi': 0.3939990685799437}-{'f1_val': 0.36016099234626553, 'auprc': 0.7594767019311636, 'loss_val': 1.3239437926835933, 'psi': 0.5198872761802248}
[S16] START round=2 head_norm_before_train=0.735677 cos_to_last_merge=1.0000 (last merge round=1)
[S16] round=2 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8259488299975579, 'loss_val': 1.3280151674459648, 'psi': 0.4147620021185451}-{'f1_val': 0.14063745019920318, 'auprc': 0.8396145672901587, 'loss_val': 1.325224530864813, 'psi': 0.4202282970355854}
[S17] START round=2 head_norm_before_train=1.198243 (no previous merge yet)
[S17] round=2 local utility u=0.066807 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.6887805817983629, 'loss_val': 1.2904747366455993, 'psi': 0.3600816107097758}-{'f1_val': 0.14094896331738438, 'auprc': 0.6543803732845241, 'loss_val': 1.3208876500000446, 'psi': 0.3463215273042403}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.313)
[S8] not sending this round → trigger blocked (psi=0.390)
[S2] not sending this round → trigger blocked (psi=0.343)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.320)
[S5] not sending this round → trigger blocked (psi=0.382)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.480)
[S10] not sending this round → trigger blocked (psi=0.390)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.395)
[S14] not sending this round → trigger blocked (psi=0.367)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → trigger blocked (psi=0.360)
[S2] START round=3 head_norm_before_train=0.910954 cos_to_last_merge=0.9971 (last merge round=1)
[S2] round=3 local utility u=0.099974 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6969724618828542, 'loss_val': 1.2636462450719654, 'psi': 0.3638552647862817}-{'f1_val': 0.1417771333885667, 'auprc': 0.6447502514842943, 'loss_val': 1.3069285192483093, 'psi': 0.3429663806268578}
[S3] START round=3 head_norm_before_train=1.294539 (no previous merge yet)
[S3] round=3 local utility u=1.000000 metrics={'f1_val': 0.4224727193828194, 'auprc': 0.7956200004289193, 'loss_val': 1.0204630329273952, 'psi': 0.5717316318012593}-{'f1_val': 0.13984006561410703, 'auprc': 0.6176373361253242, 'loss_val': 1.199328240495291, 'psi': 0.33095897381859396}
[S4] START round=3 head_norm_before_train=1.197887 (no previous merge yet)
[S4] round=3 local utility u=0.029466 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7803948797415663, 'loss_val': 1.224507444867831, 'psi': 0.396293929233737}-{'f1_val': 0.14022662889518414, 'auprc': 0.7784070137820965, 'loss_val': 1.277475965809793, 'psi': 0.3954987828499491}
[S5] START round=3 head_norm_before_train=1.165157 (no previous merge yet)
[S5] round=3 local utility u=0.097157 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7764224637969173, 'loss_val': 1.1401431868376626, 'psi': 0.3959261283759098}-{'f1_val': 0.14226190476190476, 'auprc': 0.7418196294050841, 'loss_val': 1.2306488072108344, 'psi': 0.3820849946191765}
[S6] START round=3 head_norm_before_train=0.858634 cos_to_last_merge=0.9965 (last merge round=1)
[S6] round=3 local utility u=0.024703 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.617571928402467, 'loss_val': 1.2723618236482548, 'psi': 0.33188454059175604}-{'f1_val': 0.14142628205128205, 'auprc': 0.6166100607822297, 'loss_val': 1.318882107954966, 'psi': 0.3314997935436611}
[S7] START round=3 head_norm_before_train=0.936716 cos_to_last_merge=0.9945 (last merge round=1)
[S7] round=3 local utility u=0.182469 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.6760785878523639, 'loss_val': 1.1537207419038402, 'psi': 0.3556655287784005}-{'f1_val': 0.14205682272909165, 'auprc': 0.5865660670157592, 'loss_val': 1.2501208228586442, 'psi': 0.3198605204437587}
[S8] START round=3 head_norm_before_train=0.874295 cos_to_last_merge=0.9974 (last merge round=1)
[S8] round=3 local utility u=0.026866 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.768889733073322, 'loss_val': 1.2474193224645826, 'psi': 0.3915294826651031}-{'f1_val': 0.13995598239295717, 'auprc': 0.7660998014790005, 'loss_val': 1.2927811657243196, 'psi': 0.3904135100273745}
[S9] START round=3 head_norm_before_train=1.276109 (no previous merge yet)
[S9] round=3 local utility u=0.815373 metrics={'f1_val': 0.41637066856105454, 'auprc': 0.9089632637361869, 'loss_val': 0.9266978293348264, 'psi': 0.6134077066311074}-{'f1_val': 0.141397957139996, 'auprc': 0.9871019736942358, 'loss_val': 1.1420242539771723, 'psi': 0.47967956376169196}
[S10] START round=3 head_norm_before_train=1.198969 (no previous merge yet)
[S10] round=3 local utility u=0.023506 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7714137691896975, 'loss_val': 1.2638483461808503, 'psi': 0.3917384902009134}-{'f1_val': 0.13862163754172394, 'auprc': 0.7676197113280958, 'loss_val': 1.2994777967708544, 'psi': 0.3902208670562727}
[S11] START round=3 head_norm_before_train=1.185181 (no previous merge yet)
[S11] round=3 local utility u=0.037418 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.583266911752513, 'loss_val': 1.2758910382937214, 'psi': 0.31755497472487154}-{'f1_val': 0.14041368337311058, 'auprc': 0.5720724257404789, 'loss_val': 1.3171444424137273, 'psi': 0.31307718032005794}
[S13] START round=3 head_norm_before_train=0.930983 cos_to_last_merge=0.9971 (last merge round=1)
[S13] round=3 local utility u=0.000000 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5907802339203966, 'loss_val': 1.2869030554016478, 'psi': 0.3205435511143905}-{'f1_val': 0.1403857625770531, 'auprc': 0.6493615698746289, 'loss_val': 1.3166960540503228, 'psi': 0.34397608549608344}
[S14] START round=3 head_norm_before_train=1.222681 (no previous merge yet)
[S14] round=3 local utility u=0.141385 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7903630025589901, 'loss_val': 1.2755795148482756, 'psi': 0.4003599127532183}-{'f1_val': 0.14035785288270378, 'auprc': 0.7074730904082398, 'loss_val': 1.3096805041180701, 'psi': 0.36720394789291816}
[S15] START round=3 head_norm_before_train=1.209991 (no previous merge yet)
[S15] round=3 local utility u=0.033194 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7834421928977747, 'loss_val': 1.249846669653897, 'psi': 0.3972170679760449}-{'f1_val': 0.13973365136155833, 'auprc': 0.7753971944075218, 'loss_val': 1.2920999220537255, 'psi': 0.3939990685799437}
[S16] START round=3 head_norm_before_train=0.754255 cos_to_last_merge=0.9960 (last merge round=1)
[S16] round=3 local utility u=0.018970 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8270155333215418, 'loss_val': 1.2932746401676818, 'psi': 0.41518868344813864}-{'f1_val': 0.14063745019920318, 'auprc': 0.8259488299975579, 'loss_val': 1.3280151674459648, 'psi': 0.4147620021185451}
[S17] START round=3 head_norm_before_train=1.222832 (no previous merge yet)
[S17] round=3 local utility u=0.132339 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.7614495928128208, 'loss_val': 1.243803705759573, 'psi': 0.38914921511555894}-{'f1_val': 0.14094896331738438, 'auprc': 0.6887805817983629, 'loss_val': 1.2904747366455993, 'psi': 0.3600816107097758}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S7] → sending delta(kind=head bytes=1791) to S3@127.0.0.1:44903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S8] → sending delta(kind=head bytes=1792) to S9@127.0.0.1:44910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S6] → sending delta(kind=head bytes=1792) to S8@127.0.0.1:44909
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:44909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S5] → sending delta(kind=head bytes=1791) to S16@127.0.0.1:44916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:44905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:44902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S4] → sending delta(kind=head bytes=1790) to S11@127.0.0.1:44912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:44915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:44910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:44915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:44916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:44914
[S2] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1791 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1790 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1792 to 1 peers)
[S8] sending update (kind=head size=1792 to 1 peers)
[S7] sending update (kind=head size=1791 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1792) from S6
[S8] cosine check vs S6: cos=0.0409
[S5] RECEIVED delta(kind=head bytes=1796) from S15
[S5] cosine check vs S15: cos=0.0763
[S15] RECEIVED delta(kind=head bytes=1801) from S11
[S15] cosine check vs S11: cos=-0.0527
[S15] DROPPED delta from S11 (cos=-0.0527 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1790) from S4
[S11] cosine check vs S4: cos=0.0092
[S9] RECEIVED delta(kind=head bytes=1800) from S10
[S9] cosine check vs S10: cos=-0.0355
[S9] DROPPED delta from S10 (cos=-0.0355 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1797) from S2
[S15] cosine check vs S2: cos=-0.0352
[S15] DROPPED delta from S2 (cos=-0.0352 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1792) from S8
[S9] cosine check vs S8: cos=0.0278
[S14] RECEIVED delta(kind=head bytes=1797) from S16
[S14] cosine check vs S16: cos=-0.0690
[S14] DROPPED delta from S16 (cos=-0.0690 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1791) from S7
[S3] cosine check vs S7: cos=0.0247
[S16] RECEIVED delta(kind=head bytes=1802) from S9
[S16] cosine check vs S9: cos=-0.0256
[S16] DROPPED delta from S9 (cos=-0.0256 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1791) from S5
[S16] cosine check vs S5: cos=0.0503
[S2] RECEIVED delta(kind=head bytes=1796) from S3
[S2] cosine check vs S3: cos=0.0183
[S8] RECEIVED delta(kind=head bytes=1795) from S14
[S8] cosine check vs S14: cos=-0.0315
[S8] DROPPED delta from S14 (cos=-0.0315 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S17] → sending delta(kind=head bytes=1792) to S3@127.0.0.1:44903
[S17] sending update (kind=head size=1792 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1792) from S17
[S3] cosine check vs S17: cos=-0.0324
[S3] DROPPED delta from S17 (cos=-0.0324 < 0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=3 metric=0.1423 head_norm=1.191073
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.274464e-01
[S5] stored merged vector for next round verification (round=3)
[S5] DEBUG after merge:  round=3 metric=0.1423 head_norm=0.893084 delta_norm=0.827446
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=3 metric=0.1418 head_norm=0.936482
[S2] _apply_head_vector_avg (torch): Δ‖w‖=8.128773e-01
[S2] stored merged vector for next round verification (round=3)
[S2] DEBUG after merge:  round=3 metric=0.1418 head_norm=0.826975 delta_norm=0.812877
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=3 metric=0.4164 head_norm=1.324086
[S9] _apply_head_vector_avg (torch): Δ‖w‖=7.920268e-01
[S9] stored merged vector for next round verification (round=3)
[S9] DEBUG after merge:  round=3 metric=0.4160 head_norm=0.812850 delta_norm=0.792027
[S9] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=3 metric=0.1400 head_norm=0.907116
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.207088e-01
[S8] stored merged vector for next round verification (round=3)
[S8] DEBUG after merge:  round=3 metric=0.4227 head_norm=0.646620 delta_norm=0.620709
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=3 metric=0.4225 head_norm=1.346223
[S3] _apply_head_vector_avg (torch): Δ‖w‖=8.229703e-01
[S3] stored merged vector for next round verification (round=3)
[S3] DEBUG after merge:  round=3 metric=0.4225 head_norm=0.842560 delta_norm=0.822970
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=3 metric=0.1406 head_norm=0.785360
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.966693e-01
[S16] stored merged vector for next round verification (round=3)
[S16] DEBUG after merge:  round=3 metric=0.1406 head_norm=0.729640 delta_norm=0.696669
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=3 metric=0.1404 head_norm=1.209643
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.599215e-01
[S11] stored merged vector for next round verification (round=3)
[S11] DEBUG after merge:  round=3 metric=0.1404 head_norm=0.867842 delta_norm=0.859921
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=0.826975 cos_to_last_merge=1.0000 (last merge round=3)
[S2] round=4 local utility u=0.063030 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7406320739093434, 'loss_val': 1.26856454934286, 'psi': 0.3813191095968774}-{'f1_val': 0.1417771333885667, 'auprc': 0.6969724618828542, 'loss_val': 1.2636462450719654, 'psi': 0.3638552647862817}
[S3] START round=4 head_norm_before_train=0.842560 cos_to_last_merge=1.0000 (last merge round=3)
[S3] round=4 local utility u=0.007108 metrics={'f1_val': 0.39629664251078706, 'auprc': 0.8184464716475557, 'loss_val': 0.917670804288621, 'psi': 0.5651565741654945}-{'f1_val': 0.4224727193828194, 'auprc': 0.7956200004289193, 'loss_val': 1.0204630329273952, 'psi': 0.5717316318012593}
[S4] START round=4 head_norm_before_train=1.233691 (no previous merge yet)
[S4] round=4 local utility u=0.043495 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7818386119709636, 'loss_val': 1.1418485484314966, 'psi': 0.3968714221254959}-{'f1_val': 0.14022662889518414, 'auprc': 0.7803948797415663, 'loss_val': 1.224507444867831, 'psi': 0.396293929233737}
[S5] START round=4 head_norm_before_train=0.893084 cos_to_last_merge=1.0000 (last merge round=3)
[S5] round=4 local utility u=0.893349 metrics={'f1_val': 0.4188820209150243, 'auprc': 0.7778207418156877, 'loss_val': 1.0173608715631919, 'psi': 0.5624575092752897}-{'f1_val': 0.14226190476190476, 'auprc': 0.7764224637969173, 'loss_val': 1.1401431868376626, 'psi': 0.3959261283759098}
[S6] START round=4 head_norm_before_train=0.885401 cos_to_last_merge=0.9876 (last merge round=1)
[S6] round=4 local utility u=0.013556 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.614778232067902, 'loss_val': 1.2368685192001467, 'psi': 0.33076706205793005}-{'f1_val': 0.14142628205128205, 'auprc': 0.617571928402467, 'loss_val': 1.2723618236482548, 'psi': 0.33188454059175604}
[S7] START round=4 head_norm_before_train=0.980846 cos_to_last_merge=0.9850 (last merge round=1)
[S7] round=4 local utility u=0.785693 metrics={'f1_val': 0.4172381946317165, 'auprc': 0.5925001995875243, 'loss_val': 0.9826873397917867, 'psi': 0.4873429966140397}-{'f1_val': 0.14205682272909165, 'auprc': 0.6760785878523639, 'loss_val': 1.1537207419038402, 'psi': 0.3556655287784005}
[S8] START round=4 head_norm_before_train=0.646620 cos_to_last_merge=1.0000 (last merge round=3)
[S8] round=4 local utility u=0.000000 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7709040019671209, 'loss_val': 1.2567830305259533, 'psi': 0.3923351902226227}-{'f1_val': 0.13995598239295717, 'auprc': 0.768889733073322, 'loss_val': 1.2474193224645826, 'psi': 0.3915294826651031}
[S9] START round=4 head_norm_before_train=0.812850 cos_to_last_merge=1.0000 (last merge round=3)
[S9] round=4 local utility u=0.000000 metrics={'f1_val': 0.41685404846439245, 'auprc': 0.8656638196515547, 'loss_val': 0.803453256831769, 'psi': 0.5963779569392573}-{'f1_val': 0.41637066856105454, 'auprc': 0.9089632637361869, 'loss_val': 0.9266978293348264, 'psi': 0.6134077066311074}
[S10] START round=4 head_norm_before_train=1.224482 (no previous merge yet)
[S10] round=4 local utility u=0.032047 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7763041449946391, 'loss_val': 1.2144250243179884, 'psi': 0.39369464052289}-{'f1_val': 0.13862163754172394, 'auprc': 0.7714137691896975, 'loss_val': 1.2638483461808503, 'psi': 0.3917384902009134}
[S11] START round=4 head_norm_before_train=0.867842 cos_to_last_merge=1.0000 (last merge round=3)
[S11] round=4 local utility u=0.260860 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7574500506206843, 'loss_val': 1.276720546191302, 'psi': 0.3872282302721401}-{'f1_val': 0.14041368337311058, 'auprc': 0.583266911752513, 'loss_val': 1.2758910382937214, 'psi': 0.31755497472487154}
[S13] START round=4 head_norm_before_train=0.957445 cos_to_last_merge=0.9894 (last merge round=1)
[S13] round=4 local utility u=0.027225 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5938823474195913, 'loss_val': 1.241759113843046, 'psi': 0.3217843965140684}-{'f1_val': 0.1403857625770531, 'auprc': 0.5907802339203966, 'loss_val': 1.2869030554016478, 'psi': 0.3205435511143905}
[S14] START round=4 head_norm_before_train=1.253965 (no previous merge yet)
[S14] round=4 local utility u=0.029020 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7957805599218626, 'loss_val': 1.2337931087914815, 'psi': 0.4025269356983673}-{'f1_val': 0.14035785288270378, 'auprc': 0.7903630025589901, 'loss_val': 1.2755795148482756, 'psi': 0.4003599127532183}
[S15] START round=4 head_norm_before_train=1.243334 (no previous merge yet)
[S15] round=4 local utility u=0.032755 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7892779022771813, 'loss_val': 1.2018446162453813, 'psi': 0.39955135172780754}-{'f1_val': 0.13973365136155833, 'auprc': 0.7834421928977747, 'loss_val': 1.249846669653897, 'psi': 0.3972170679760449}
[S16] START round=4 head_norm_before_train=0.729640 cos_to_last_merge=1.0000 (last merge round=3)
[S16] round=4 local utility u=0.060882 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8616711379149866, 'loss_val': 1.2754767991864753, 'psi': 0.4290509252855166}-{'f1_val': 0.14063745019920318, 'auprc': 0.8270155333215418, 'loss_val': 1.2932746401676818, 'psi': 0.41518868344813864}
[S17] START round=4 head_norm_before_train=1.253985 (no previous merge yet)
[S17] round=4 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.577190229867755, 'loss_val': 1.1530586583872144, 'psi': 0.31544546993753264}-{'f1_val': 0.14094896331738438, 'auprc': 0.7614495928128208, 'loss_val': 1.243803705759573, 'psi': 0.38914921511555894}
[S10] not sending this round → trigger blocked (psi=0.394)
[S15] not sending this round → trigger blocked (psi=0.400)
[S6] not sending this round → trigger blocked (psi=0.331)
[S5] not sending this round → trigger blocked (psi=0.562)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.387)
[S16] not sending this round → trigger blocked (psi=0.429)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] → sending delta(kind=head bytes=1806) to S10@127.0.0.1:44911
[S4] not sending this round → trigger blocked (psi=0.397)
[S14] not sending this round → trigger blocked (psi=0.403)
[S3] not sending this round → trigger blocked (psi=0.565)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.381)
[S7] not sending this round → trigger blocked (psi=0.487)
[S13] sending update (kind=head size=1806 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1806) from S13
[S10] cosine check vs S13: cos=-0.0601
[S10] DROPPED delta from S13 (cos=-0.0601 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=5 head_norm_before_train=0.846248 cos_to_last_merge=0.9968 (last merge round=3)
[S2] round=5 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7150284178537651, 'loss_val': 1.2190459477064928, 'psi': 0.3710776471746461}-{'f1_val': 0.1417771333885667, 'auprc': 0.7406320739093434, 'loss_val': 1.26856454934286, 'psi': 0.3813191095968774}
[S3] START round=5 head_norm_before_train=0.911126 cos_to_last_merge=0.9891 (last merge round=3)
[S3] round=5 local utility u=0.778417 metrics={'f1_val': 0.5965475350326761, 'auprc': 0.871774245799501, 'loss_val': 0.7223245907908477, 'psi': 0.7066382193394061}-{'f1_val': 0.39629664251078706, 'auprc': 0.8184464716475557, 'loss_val': 0.917670804288621, 'psi': 0.5651565741654945}
[S4] START round=5 head_norm_before_train=1.279222 (no previous merge yet)
[S4] round=5 local utility u=0.892360 metrics={'f1_val': 0.4146850260251823, 'auprc': 0.7817571323192838, 'loss_val': 1.0036343374236094, 'psi': 0.5615138685428229}-{'f1_val': 0.14022662889518414, 'auprc': 0.7818386119709636, 'loss_val': 1.1418485484314966, 'psi': 0.3968714221254959}
[S5] START round=5 head_norm_before_train=0.935573 cos_to_last_merge=0.9944 (last merge round=3)
[S5] round=5 local utility u=0.404557 metrics={'f1_val': 0.5244894032399985, 'auprc': 0.776967188898066, 'loss_val': 0.8393304917509371, 'psi': 0.6254805175032255}-{'f1_val': 0.4188820209150243, 'auprc': 0.7778207418156877, 'loss_val': 1.0173608715631919, 'psi': 0.5624575092752897}
[S6] START round=5 head_norm_before_train=0.913823 cos_to_last_merge=0.9768 (last merge round=1)
[S6] round=5 local utility u=0.014543 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6133608724019869, 'loss_val': 1.2035302236906262, 'psi': 0.330200118191564}-{'f1_val': 0.14142628205128205, 'auprc': 0.614778232067902, 'loss_val': 1.2368685192001467, 'psi': 0.33076706205793005}
[S7] START round=5 head_norm_before_train=1.029367 cos_to_last_merge=0.9712 (last merge round=1)
[S7] round=5 local utility u=0.136690 metrics={'f1_val': 0.4169130971024577, 'auprc': 0.6371102340704066, 'loss_val': 0.8411861521505292, 'psi': 0.5049919518896373}-{'f1_val': 0.4172381946317165, 'auprc': 0.5925001995875243, 'loss_val': 0.9826873397917867, 'psi': 0.4873429966140397}
[S8] START round=5 head_norm_before_train=0.675682 cos_to_last_merge=0.9948 (last merge round=3)
[S8] round=5 local utility u=0.039534 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7718290563073681, 'loss_val': 1.1804896970829841, 'psi': 0.3927052119587216}-{'f1_val': 0.13995598239295717, 'auprc': 0.7709040019671209, 'loss_val': 1.2567830305259533, 'psi': 0.3923351902226227}
[S9] START round=5 head_norm_before_train=0.887046 cos_to_last_merge=0.9916 (last merge round=3)
[S9] round=5 local utility u=1.000000 metrics={'f1_val': 0.7015406642019387, 'auprc': 0.9984444414169558, 'loss_val': 0.537916804364811, 'psi': 0.8203021750879456}-{'f1_val': 0.41685404846439245, 'auprc': 0.8656638196515547, 'loss_val': 0.803453256831769, 'psi': 0.5963779569392573}
[S10] START round=5 head_norm_before_train=1.257177 (no previous merge yet)
[S10] round=5 local utility u=0.877121 metrics={'f1_val': 0.41670936461107344, 'auprc': 0.7782209854924088, 'loss_val': 1.134459394307617, 'psi': 0.5613140129636076}-{'f1_val': 0.13862163754172394, 'auprc': 0.7763041449946391, 'loss_val': 1.2144250243179884, 'psi': 0.39369464052289}
[S11] START round=5 head_norm_before_train=0.890645 cos_to_last_merge=0.9973 (last merge round=3)
[S11] round=5 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.6081123507492792, 'loss_val': 1.2143654361605651, 'psi': 0.327493150323578}-{'f1_val': 0.14041368337311058, 'auprc': 0.7574500506206843, 'loss_val': 1.276720546191302, 'psi': 0.3872282302721401}
[S13] START round=5 head_norm_before_train=0.993382 cos_to_last_merge=0.9784 (last merge round=1)
[S13] round=5 local utility u=0.127365 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.6574010897171113, 'loss_val': 1.1775843853508436, 'psi': 0.3471918934330764}-{'f1_val': 0.1403857625770531, 'auprc': 0.5938823474195913, 'loss_val': 1.241759113843046, 'psi': 0.3217843965140684}
[S14] START round=5 head_norm_before_train=1.285606 (no previous merge yet)
[S14] round=5 local utility u=0.136601 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8619766203481494, 'loss_val': 1.1591796988775238, 'psi': 0.429005359868882}-{'f1_val': 0.14035785288270378, 'auprc': 0.7957805599218626, 'loss_val': 1.2337931087914815, 'psi': 0.4025269356983673}
[S15] START round=5 head_norm_before_train=1.276284 (no previous merge yet)
[S15] round=5 local utility u=0.677210 metrics={'f1_val': 0.3525361623657315, 'auprc': 0.7861062190086543, 'loss_val': 1.1147256014922393, 'psi': 0.5259641850229007}-{'f1_val': 0.13973365136155833, 'auprc': 0.7892779022771813, 'loss_val': 1.2018446162453813, 'psi': 0.39955135172780754}
[S16] START round=5 head_norm_before_train=0.759270 cos_to_last_merge=0.9961 (last merge round=3)
[S16] round=5 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.6677786059084759, 'loss_val': 1.2174777346978394, 'psi': 0.3514939124829123}-{'f1_val': 0.14063745019920318, 'auprc': 0.8616711379149866, 'loss_val': 1.2754767991864753, 'psi': 0.4290509252855166}
[S17] START round=5 head_norm_before_train=1.296965 (no previous merge yet)
[S17] round=5 local utility u=1.000000 metrics={'f1_val': 0.3859620586570226, 'auprc': 0.7525368819124887, 'loss_val': 0.9968675348820183, 'psi': 0.532591987959209}-{'f1_val': 0.14094896331738438, 'auprc': 0.577190229867755, 'loss_val': 1.1530586583872144, 'psi': 0.31544546993753264}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:44910
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:44912
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S3] → sending delta(kind=head bytes=1792) to S2@127.0.0.1:44902
[S13] not sending this round → trigger blocked (psi=0.347)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:44910
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:44909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:44903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] → sending delta(kind=head bytes=1792) to S16@127.0.0.1:44916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:44909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:44916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:44905
[S9] sending update (kind=head size=1792 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1792 to 1 peers)
[S6] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1793 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1792) from S3
[S2] cosine check vs S3: cos=0.9227
[S11] RECEIVED delta(kind=head bytes=1798) from S4
[S11] cosine check vs S4: cos=0.6659
[S5] RECEIVED delta(kind=head bytes=1795) from S15
[S5] cosine check vs S15: cos=0.6860
[S3] RECEIVED delta(kind=head bytes=1799) from S7
[S3] cosine check vs S7: cos=0.5004
[S8] RECEIVED delta(kind=head bytes=1796) from S6
[S8] cosine check vs S6: cos=0.6284
[S8] RECEIVED delta(kind=head bytes=1795) from S14
[S8] cosine check vs S14: cos=-0.0203
[S8] DROPPED delta from S14 (cos=-0.0203 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1793) from S5
[S16] cosine check vs S5: cos=0.5958
[S16] RECEIVED delta(kind=head bytes=1792) from S9
[S16] cosine check vs S9: cos=0.0528
[S9] RECEIVED delta(kind=head bytes=1799) from S8
[S9] cosine check vs S8: cos=0.7152
[S9] RECEIVED delta(kind=head bytes=1801) from S10
[S9] cosine check vs S10: cos=-0.0632
[S9] DROPPED delta from S10 (cos=-0.0632 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S17] → sending delta(kind=head bytes=1790) to S3@127.0.0.1:44903
[S17] sending update (kind=head size=1790 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1790) from S17
[S3] cosine check vs S17: cos=0.0205
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=5 metric=0.1418 head_norm=0.874022
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.961647e-01
[S2] stored merged vector for next round verification (round=5)
[S2] DEBUG after merge:  round=5 metric=0.1418 head_norm=0.922495 delta_norm=0.196165
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.359 → S15@127.0.0.1:44915
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=5 metric=0.1404 head_norm=0.920599
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.946082e-01
[S11] stored merged vector for next round verification (round=5)
[S11] DEBUG after merge:  round=5 metric=0.1404 head_norm=1.028014 delta_norm=0.494608
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.421 → S15@127.0.0.1:44915
[S13] ⇄ pheromone p=0.358 → S10@127.0.0.1:44911
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=5 metric=0.5245 head_norm=1.000359
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.782133e-01
[S5] stored merged vector for next round verification (round=5)
[S5] DEBUG after merge:  round=5 metric=0.6059 head_norm=1.060882 delta_norm=0.478213
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.593 → S16@127.0.0.1:44916
[S15] ⇄ pheromone p=0.542 → S5@127.0.0.1:44905
[S6] ⇄ pheromone p=0.336 → S8@127.0.0.1:44909
[S14] ⇄ pheromone p=0.418 → S8@127.0.0.1:44909
[S7] ⇄ pheromone p=0.509 → S3@127.0.0.1:44903
[S4] ⇄ pheromone p=0.521 → S11@127.0.0.1:44912
[S10] ⇄ pheromone p=0.526 → S9@127.0.0.1:44910
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=5 metric=0.7015 head_norm=0.991608
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.465230e-01
[S9] stored merged vector for next round verification (round=5)
[S9] DEBUG after merge:  round=5 metric=0.7016 head_norm=0.792366 delta_norm=0.346523
[S9] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.691 → S16@127.0.0.1:44916
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=5 metric=0.1400 head_norm=0.715931
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.713444e-01
[S8] stored merged vector for next round verification (round=5)
[S8] DEBUG after merge:  round=5 metric=0.3951 head_norm=0.749267 delta_norm=0.371344
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.341 → S9@127.0.0.1:44910
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=5 metric=0.5965 head_norm=1.007493
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.526737e-01
[S3] stored merged vector for next round verification (round=5)
[S3] DEBUG after merge:  round=5 metric=0.6175 head_norm=0.770737 delta_norm=0.552674
[S3] aggregate: ACCEPT kept=['S7', 'S17'] (k=2/2) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.615 → S2@127.0.0.1:44902
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=5 metric=0.1406 head_norm=0.798696
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.998868e-01
[S16] stored merged vector for next round verification (round=5)
[S16] DEBUG after merge:  round=5 metric=0.1406 head_norm=0.647173 delta_norm=0.399887
[S16] aggregate: ACCEPT kept=['S5', 'S9'] (k=2/2) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.347 → S14@127.0.0.1:44914
[S17] ⇄ pheromone p=0.575 → S3@127.0.0.1:44903
[S2] START round=6 head_norm_before_train=0.922495 cos_to_last_merge=1.0000 (last merge round=5)
[S2] round=6 local utility u=0.079232 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7542819878108016, 'loss_val': 1.1783424081840908, 'psi': 0.3867790751574607}-{'f1_val': 0.1417771333885667, 'auprc': 0.7150284178537651, 'loss_val': 1.2190459477064928, 'psi': 0.3710776471746461}
[S3] START round=6 head_norm_before_train=0.770737 cos_to_last_merge=1.0000 (last merge round=5)
[S3] round=6 local utility u=0.000000 metrics={'f1_val': 0.49151645455993276, 'auprc': 0.8729789939964447, 'loss_val': 0.801686390417834, 'psi': 0.6441014703345376}-{'f1_val': 0.5965475350326761, 'auprc': 0.871774245799501, 'loss_val': 0.7223245907908477, 'psi': 0.7066382193394061}
[S4] START round=6 head_norm_before_train=1.324915 (no previous merge yet)
[S4] round=6 local utility u=0.837705 metrics={'f1_val': 0.6808896526349775, 'auprc': 0.7477988555705593, 'loss_val': 0.8235762673967811, 'psi': 0.7076533338092101}-{'f1_val': 0.4146850260251823, 'auprc': 0.7817571323192838, 'loss_val': 1.0036343374236094, 'psi': 0.5615138685428229}
[S5] START round=6 head_norm_before_train=1.060882 cos_to_last_merge=1.0000 (last merge round=5)
[S5] round=6 local utility u=0.000000 metrics={'f1_val': 0.4047897554070294, 'auprc': 0.7198157199974216, 'loss_val': 0.7453261914427042, 'psi': 0.5308001412431862}-{'f1_val': 0.5244894032399985, 'auprc': 0.776967188898066, 'loss_val': 0.8393304917509371, 'psi': 0.6254805175032255}
[S6] START round=6 head_norm_before_train=0.941295 cos_to_last_merge=0.9666 (last merge round=1)
[S6] round=6 local utility u=0.037357 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6133857593989378, 'loss_val': 1.1288912797531725, 'psi': 0.3302100729903443}-{'f1_val': 0.14142628205128205, 'auprc': 0.6133608724019869, 'loss_val': 1.2035302236906262, 'psi': 0.330200118191564}
[S7] START round=6 head_norm_before_train=1.089742 cos_to_last_merge=0.9489 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.949
[S7] round=6 local utility u=0.172719 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.7415811943378289, 'loss_val': 0.8079434684969522, 'psi': 0.5466585486017457}-{'f1_val': 0.4169130971024577, 'auprc': 0.6371102340704066, 'loss_val': 0.8411861521505292, 'psi': 0.5049919518896373}
[S8] START round=6 head_norm_before_train=0.749267 cos_to_last_merge=1.0000 (last merge round=5)
[S8] round=6 local utility u=1.000000 metrics={'f1_val': 0.7137908619333111, 'auprc': 0.7766720099084914, 'loss_val': 1.17088374957822, 'psi': 0.7389433211233832}-{'f1_val': 0.13995598239295717, 'auprc': 0.7718290563073681, 'loss_val': 1.1804896970829841, 'psi': 0.3927052119587216}
[S9] START round=6 head_norm_before_train=0.792366 cos_to_last_merge=1.0000 (last merge round=5)
[S9] round=6 local utility u=0.035965 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9983154707522909, 'loss_val': 0.4640989489234696, 'psi': 0.8201004784254544}-{'f1_val': 0.7015406642019387, 'auprc': 0.9984444414169558, 'loss_val': 0.537916804364811, 'psi': 0.8203021750879456}
[S10] START round=6 head_norm_before_train=1.282588 (no previous merge yet)
[S10] round=6 local utility u=0.111280 metrics={'f1_val': 0.4170518629654155, 'auprc': 0.7922099231097887, 'loss_val': 0.9559221533661761, 'psi': 0.5671150870231647}-{'f1_val': 0.41670936461107344, 'auprc': 0.7782209854924088, 'loss_val': 1.134459394307617, 'psi': 0.5613140129636076}
[S11] START round=6 head_norm_before_train=1.028014 cos_to_last_merge=1.0000 (last merge round=5)
[S11] round=6 local utility u=0.256008 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.76914243186883, 'loss_val': 1.1854396427718297, 'psi': 0.39190518277139835}-{'f1_val': 0.14041368337311058, 'auprc': 0.6081123507492792, 'loss_val': 1.2143654361605651, 'psi': 0.327493150323578}
[S13] START round=6 head_norm_before_train=1.033945 cos_to_last_merge=0.9660 (last merge round=1)
[S13] round=6 local utility u=0.806793 metrics={'f1_val': 0.4158809972763461, 'auprc': 0.6166618683762919, 'loss_val': 1.0947519618818544, 'psi': 0.49619334571632445}-{'f1_val': 0.1403857625770531, 'auprc': 0.6574010897171113, 'loss_val': 1.1775843853508436, 'psi': 0.3471918934330764}
[S14] START round=6 head_norm_before_train=1.316530 (no previous merge yet)
[S14] round=6 local utility u=1.000000 metrics={'f1_val': 0.4165616830781579, 'auprc': 0.9993985446623743, 'loss_val': 1.0440458729883941, 'psi': 0.6496964277118444}-{'f1_val': 0.14035785288270378, 'auprc': 0.8619766203481494, 'loss_val': 1.1591796988775238, 'psi': 0.429005359868882}
[S15] START round=6 head_norm_before_train=1.306752 (no previous merge yet)
[S15] round=6 local utility u=0.279114 metrics={'f1_val': 0.4169508412658852, 'auprc': 0.7874264953338156, 'loss_val': 0.946945621752335, 'psi': 0.5651411028930573}-{'f1_val': 0.3525361623657315, 'auprc': 0.7861062190086543, 'loss_val': 1.1147256014922393, 'psi': 0.5259641850229007}
[S16] START round=6 head_norm_before_train=0.647173 cos_to_last_merge=1.0000 (last merge round=5)
[S16] round=6 local utility u=0.017031 metrics={'f1_val': 0.18523933139964296, 'auprc': 0.5798617497952037, 'loss_val': 1.1872762871276124, 'psi': 0.3430882987578673}-{'f1_val': 0.14063745019920318, 'auprc': 0.6677786059084759, 'loss_val': 1.2174777346978394, 'psi': 0.3514939124829123}
[S17] START round=6 head_norm_before_train=1.341693 (no previous merge yet)
[S17] round=6 local utility u=0.126160 metrics={'f1_val': 0.3580280062609892, 'auprc': 0.8563355881104319, 'loss_val': 0.8883383832497309, 'psi': 0.5573510390007663}-{'f1_val': 0.3859620586570226, 'auprc': 0.7525368819124887, 'loss_val': 0.9968675348820183, 'psi': 0.532591987959209}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:44909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S16] → sending delta(kind=head bytes=1792) to S14@127.0.0.1:44914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:44910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:44912
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:44905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S2] → sending delta(kind=head bytes=1788) to S15@127.0.0.1:44915
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:44903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:44916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:44915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:44910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:44909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:44911
[S8] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1788 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1795 to 1 peers)
[S16] sending update (kind=head size=1792 to 1 peers)
[S6] sending update (kind=head size=1796 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1792) from S16
[S14] cosine check vs S16: cos=0.0141
[S11] RECEIVED delta(kind=head bytes=1798) from S4
[S11] cosine check vs S4: cos=0.9208
[S15] RECEIVED delta(kind=head bytes=1797) from S11
[S15] cosine check vs S11: cos=0.0182
[S15] RECEIVED delta(kind=head bytes=1788) from S2
[S15] cosine check vs S2: cos=-0.0562
[S15] DROPPED delta from S2 (cos=-0.0562 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1798) from S8
[S9] cosine check vs S8: cos=0.8052
[S9] RECEIVED delta(kind=head bytes=1802) from S10
[S9] cosine check vs S10: cos=-0.0818
[S9] DROPPED delta from S10 (cos=-0.0818 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1799) from S13
[S10] cosine check vs S13: cos=-0.0353
[S10] DROPPED delta from S13 (cos=-0.0353 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1797) from S15
[S5] cosine check vs S15: cos=0.9029
[S16] RECEIVED delta(kind=head bytes=1799) from S9
[S16] cosine check vs S9: cos=0.3913
[S3] RECEIVED delta(kind=head bytes=1795) from S7
[S3] cosine check vs S7: cos=0.6236
[S8] RECEIVED delta(kind=head bytes=1797) from S14
[S8] cosine check vs S14: cos=0.0005
[S8] RECEIVED delta(kind=head bytes=1796) from S6
[S8] cosine check vs S6: cos=0.8981
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:44903
[S17] sending update (kind=head size=1796 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1796) from S17
[S3] cosine check vs S17: cos=0.4155
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=6 metric=0.4048 head_norm=1.125627
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.922727e-01
[S5] stored merged vector for next round verification (round=6)
[S5] DEBUG after merge:  round=6 metric=0.4501 head_norm=1.204850 delta_norm=0.292273
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=6 metric=0.4915 head_norm=0.867281
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.442228e-01
[S3] stored merged vector for next round verification (round=6)
[S3] DEBUG after merge:  round=6 metric=0.5222 head_norm=0.824046 delta_norm=0.344223
[S3] aggregate: ACCEPT kept=['S7', 'S17'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=6 metric=0.4170 head_norm=1.344298
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.443224e-01
[S15] stored merged vector for next round verification (round=6)
[S15] DEBUG after merge:  round=6 metric=0.4168 head_norm=0.859327 delta_norm=0.844322
[S15] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=6 metric=0.1852 head_norm=0.676554
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.474460e-01
[S16] stored merged vector for next round verification (round=6)
[S16] DEBUG after merge:  round=6 metric=0.1406 head_norm=0.663683 delta_norm=0.447446
[S16] aggregate: ROLLBACK (f1_val pre=0.185 post=0.141 tol_abs=0.005 tol_rel=0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=6 metric=0.1404 head_norm=1.046665
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.893966e-01
[S11] stored merged vector for next round verification (round=6)
[S11] DEBUG after merge:  round=6 metric=0.1404 head_norm=1.186569 delta_norm=0.289397
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=6 metric=0.7013 head_norm=0.907547
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.698614e-01
[S9] stored merged vector for next round verification (round=6)
[S9] DEBUG after merge:  round=6 metric=0.7013 head_norm=0.798029 delta_norm=0.269861
[S9] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=6 metric=0.4166 head_norm=1.345352
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.486640e-01
[S14] stored merged vector for next round verification (round=6)
[S14] DEBUG after merge:  round=6 metric=0.4532 head_norm=0.757199 delta_norm=0.748664
[S14] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=6 metric=0.7138 head_norm=0.771822
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.959747e-01
[S8] stored merged vector for next round verification (round=6)
[S8] DEBUG after merge:  round=6 metric=0.6644 head_norm=0.701714 delta_norm=0.395975
[S8] aggregate: ROLLBACK (f1_val pre=0.714 post=0.664 tol_abs=0.005 tol_rel=0.0)
[S2] START round=7 head_norm_before_train=0.944271 cos_to_last_merge=0.9977 (last merge round=5)
[S2] round=7 local utility u=0.589674 metrics={'f1_val': 0.3235056493235884, 'auprc': 0.7574031467121677, 'loss_val': 1.0987285461437317, 'psi': 0.49706464827902014}-{'f1_val': 0.1417771333885667, 'auprc': 0.7542819878108016, 'loss_val': 1.1783424081840908, 'psi': 0.3867790751574607}
[S3] START round=7 head_norm_before_train=0.824046 cos_to_last_merge=1.0000 (last merge round=6)
[S3] round=7 local utility u=0.895984 metrics={'f1_val': 0.6930047378052776, 'auprc': 0.9981857344786714, 'loss_val': 0.5942684218006878, 'psi': 0.8150771364746352}-{'f1_val': 0.49151645455993276, 'auprc': 0.8729789939964447, 'loss_val': 0.801686390417834, 'psi': 0.6441014703345376}
[S4] START round=7 head_norm_before_train=1.374003 (no previous merge yet)
[S4] round=7 local utility u=0.000000 metrics={'f1_val': 0.6583851261588132, 'auprc': 0.6562930439584584, 'loss_val': 0.6925352730724175, 'psi': 0.6575482932786713}-{'f1_val': 0.6808896526349775, 'auprc': 0.7477988555705593, 'loss_val': 0.8235762673967811, 'psi': 0.7076533338092101}
[S5] START round=7 head_norm_before_train=1.204850 cos_to_last_merge=1.0000 (last merge round=6)
[S5] round=7 local utility u=1.000000 metrics={'f1_val': 0.7010644289311239, 'auprc': 0.8641721999551809, 'loss_val': 0.6764869241987262, 'psi': 0.7663075373407466}-{'f1_val': 0.4047897554070294, 'auprc': 0.7198157199974216, 'loss_val': 0.7453261914427042, 'psi': 0.5308001412431862}
[S6] START round=7 head_norm_before_train=0.967620 cos_to_last_merge=0.9566 (last merge round=1)
[S6] round=7 local utility u=0.877693 metrics={'f1_val': 0.41605123052148413, 'auprc': 0.6133185526341066, 'loss_val': 1.0210526716352102, 'psi': 0.4949581593665331}-{'f1_val': 0.14142628205128205, 'auprc': 0.6133857593989378, 'loss_val': 1.1288912797531725, 'psi': 0.3302100729903443}
[S7] START round=7 head_norm_before_train=1.147097 cos_to_last_merge=0.9276 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.928
[S7] round=7 local utility u=0.061037 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.7677774803358504, 'loss_val': 0.764458625720602, 'psi': 0.5571370630009542}-{'f1_val': 0.41671011811102343, 'auprc': 0.7415811943378289, 'loss_val': 0.8079434684969522, 'psi': 0.5466585486017457}
[S8] START round=7 head_norm_before_train=0.701714 cos_to_last_merge=1.0000 (last merge round=6)
[S8] round=7 local utility u=0.009399 metrics={'f1_val': 0.7141723980650027, 'auprc': 0.7767723001114103, 'loss_val': 1.1546755156473352, 'psi': 0.7392123588835657}-{'f1_val': 0.7137908619333111, 'auprc': 0.7766720099084914, 'loss_val': 1.17088374957822, 'psi': 0.7389433211233832}
[S9] START round=7 head_norm_before_train=0.798029 cos_to_last_merge=1.0000 (last merge round=6)
[S9] round=7 local utility u=0.030437 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9984281856517162, 'loss_val': 0.403562232741981, 'psi': 0.8201455643852246}-{'f1_val': 0.7012904835408967, 'auprc': 0.9983154707522909, 'loss_val': 0.4640989489234696, 'psi': 0.8201004784254544}
[S10] START round=7 head_norm_before_train=1.306521 (no previous merge yet)
[S10] round=7 local utility u=0.599305 metrics={'f1_val': 0.4841959007200213, 'auprc': 0.997088079690426, 'loss_val': 0.7748103181091959, 'psi': 0.6893527723081831}-{'f1_val': 0.4170518629654155, 'auprc': 0.7922099231097887, 'loss_val': 0.9559221533661761, 'psi': 0.5671150870231647}
[S11] START round=7 head_norm_before_train=1.186569 cos_to_last_merge=1.0000 (last merge round=6)
[S11] round=7 local utility u=0.167760 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.8561266211029354, 'loss_val': 1.1108712829697496, 'psi': 0.4266988584650405}-{'f1_val': 0.14041368337311058, 'auprc': 0.76914243186883, 'loss_val': 1.1854396427718297, 'psi': 0.39190518277139835}
[S13] START round=7 head_norm_before_train=1.068883 cos_to_last_merge=0.9548 (last merge round=1)
[S13] round=7 local utility u=0.000000 metrics={'f1_val': 0.416200286011302, 'auprc': 0.5385469752199459, 'loss_val': 1.0265174377179112, 'psi': 0.46513896169475955}-{'f1_val': 0.4158809972763461, 'auprc': 0.6166618683762919, 'loss_val': 1.0947519618818544, 'psi': 0.49619334571632445}
[S14] START round=7 head_norm_before_train=0.757199 cos_to_last_merge=1.0000 (last merge round=6)
[S14] round=7 local utility u=0.797838 metrics={'f1_val': 0.6782570205252754, 'auprc': 0.9990229700768555, 'loss_val': 1.0174157603023815, 'psi': 0.8065634003459075}-{'f1_val': 0.4165616830781579, 'auprc': 0.9993985446623743, 'loss_val': 1.0440458729883941, 'psi': 0.6496964277118444}
[S15] START round=7 head_norm_before_train=0.859327 cos_to_last_merge=1.0000 (last merge round=6)
[S15] round=7 local utility u=0.000000 metrics={'f1_val': 0.416567672447929, 'auprc': 0.7768532324951917, 'loss_val': 0.9231501609312304, 'psi': 0.5606818964668341}-{'f1_val': 0.4169508412658852, 'auprc': 0.7874264953338156, 'loss_val': 0.946945621752335, 'psi': 0.5651411028930573}
[S16] START round=7 head_norm_before_train=0.663683 cos_to_last_merge=1.0000 (last merge round=6)
[S16] round=7 local utility u=0.672415 metrics={'f1_val': 0.41625059973887696, 'auprc': 0.554810674051735, 'loss_val': 1.1533615241008, 'psi': 0.47167462946402017}-{'f1_val': 0.18523933139964296, 'auprc': 0.5798617497952037, 'loss_val': 1.1872762871276124, 'psi': 0.3430882987578673}
[S17] START round=7 head_norm_before_train=1.389525 (no previous merge yet)
[S17] round=7 local utility u=0.000000 metrics={'f1_val': 0.35332495072624465, 'auprc': 0.6912606314663572, 'loss_val': 0.8806508805026089, 'psi': 0.48849922302228965}-{'f1_val': 0.3580280062609892, 'auprc': 0.8563355881104319, 'loss_val': 0.8883383832497309, 'psi': 0.5573510390007663}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] → sending delta(kind=head bytes=1794) to S15@127.0.0.1:44915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:44909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:44903
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:44914
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:44902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:44909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:44915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S9] → sending delta(kind=head bytes=1788) to S16@127.0.0.1:44916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:44916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:44910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:44910
[S10] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1788 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1794 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1794 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1799) from S11
[S15] cosine check vs S11: cos=0.6014
[S2] RECEIVED delta(kind=head bytes=1797) from S3
[S2] cosine check vs S3: cos=0.7146
[S15] RECEIVED delta(kind=head bytes=1794) from S2
[S15] cosine check vs S2: cos=-0.0310
[S15] DROPPED delta from S2 (cos=-0.0310 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1801) from S6
[S8] cosine check vs S6: cos=0.8301
[S9] RECEIVED delta(kind=head bytes=1802) from S10
[S9] cosine check vs S10: cos=-0.0855
[S9] DROPPED delta from S10 (cos=-0.0855 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1796) from S16
[S14] cosine check vs S16: cos=0.3350
[S16] RECEIVED delta(kind=head bytes=1798) from S5
[S16] cosine check vs S5: cos=0.2156
[S9] RECEIVED delta(kind=head bytes=1797) from S8
[S9] cosine check vs S8: cos=0.7692
[S16] RECEIVED delta(kind=head bytes=1788) from S9
[S16] cosine check vs S9: cos=0.8107
[S3] RECEIVED delta(kind=head bytes=1794) from S7
[S3] cosine check vs S7: cos=0.6353
[S8] RECEIVED delta(kind=head bytes=1803) from S14
[S8] cosine check vs S14: cos=0.5100
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=7 metric=0.7142 head_norm=0.721144
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.356224e-01
[S8] stored merged vector for next round verification (round=7)
[S8] DEBUG after merge:  round=7 metric=0.7140 head_norm=0.683381 delta_norm=0.135622
[S8] aggregate: ACCEPT kept=['S6', 'S14'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=7 metric=0.6783 head_norm=0.804106
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.321223e-01
[S14] stored merged vector for next round verification (round=7)
[S14] DEBUG after merge:  round=7 metric=0.6674 head_norm=0.609322 delta_norm=0.432122
[S14] aggregate: ROLLBACK (f1_val pre=0.678 post=0.667 tol_abs=0.005 tol_rel=0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=7 metric=0.3235 head_norm=0.970235
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.567288e-01
[S2] stored merged vector for next round verification (round=7)
[S2] DEBUG after merge:  round=7 metric=0.4159 head_norm=0.872074 delta_norm=0.356729
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=7 metric=0.6930 head_norm=0.913336
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.686638e-01
[S3] stored merged vector for next round verification (round=7)
[S3] DEBUG after merge:  round=7 metric=0.7003 head_norm=0.956344 delta_norm=0.468664
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=7 metric=0.7013 head_norm=0.917253
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.931784e-01
[S9] stored merged vector for next round verification (round=7)
[S9] DEBUG after merge:  round=7 metric=0.7013 head_norm=0.771199 delta_norm=0.293178
[S9] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=7 metric=0.4163 head_norm=0.685142
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.003174e-01
[S16] stored merged vector for next round verification (round=7)
[S16] DEBUG after merge:  round=7 metric=0.4167 head_norm=0.661710 delta_norm=0.300317
[S16] aggregate: ACCEPT kept=['S5', 'S9'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=7 metric=0.4166 head_norm=0.901644
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.890083e-01
[S15] stored merged vector for next round verification (round=7)
[S15] DEBUG after merge:  round=7 metric=0.4166 head_norm=0.944429 delta_norm=0.489008
[S15] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=0.872074 cos_to_last_merge=1.0000 (last merge round=7)
[S2] round=8 local utility u=0.329120 metrics={'f1_val': 0.4169384018324798, 'auprc': 0.7641600191403837, 'loss_val': 1.0213557288141335, 'psi': 0.5558270487556414}-{'f1_val': 0.3235056493235884, 'auprc': 0.7574031467121677, 'loss_val': 1.0987285461437317, 'psi': 0.49706464827902014}
[S3] START round=8 head_norm_before_train=0.956344 cos_to_last_merge=1.0000 (last merge round=7)
[S3] round=8 local utility u=0.065311 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9984606390880574, 'loss_val': 0.5109793313264449, 'psi': 0.8198379778764027}-{'f1_val': 0.6930047378052776, 'auprc': 0.9981857344786714, 'loss_val': 0.5942684218006878, 'psi': 0.8150771364746352}
[S4] START round=8 head_norm_before_train=1.427426 (no previous merge yet)
[S4] round=8 local utility u=0.004721 metrics={'f1_val': 0.6472516758999612, 'auprc': 0.6569657400597493, 'loss_val': 0.6183104812455836, 'psi': 0.6511373015638765}-{'f1_val': 0.6583851261588132, 'auprc': 0.6562930439584584, 'loss_val': 0.6925352730724175, 'psi': 0.6575482932786713}
[S5] START round=8 head_norm_before_train=1.258176 cos_to_last_merge=0.9951 (last merge round=6)
[S5] round=8 local utility u=0.031992 metrics={'f1_val': 0.7008569501491988, 'auprc': 0.8278805816934824, 'loss_val': 0.5023832141285915, 'psi': 0.7516664027669122}-{'f1_val': 0.7010644289311239, 'auprc': 0.8641721999551809, 'loss_val': 0.6764869241987262, 'psi': 0.7663075373407466}
[S6] START round=8 head_norm_before_train=1.004813 cos_to_last_merge=0.9449 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.945
[S6] round=8 local utility u=0.189367 metrics={'f1_val': 0.37825724744131173, 'auprc': 0.7647597006079607, 'loss_val': 0.8698779713670878, 'psi': 0.5328582287079713}-{'f1_val': 0.41605123052148413, 'auprc': 0.6133185526341066, 'loss_val': 1.0210526716352102, 'psi': 0.4949581593665331}
[S7] START round=8 head_norm_before_train=1.197622 cos_to_last_merge=0.9105 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.911
[S7] round=8 local utility u=0.000000 metrics={'f1_val': 0.3760115345305238, 'auprc': 0.7413092894022619, 'loss_val': 0.8615743240498392, 'psi': 0.5221306364792191}-{'f1_val': 0.41671011811102343, 'auprc': 0.7677774803358504, 'loss_val': 0.764458625720602, 'psi': 0.5571370630009542}
[S8] START round=8 head_norm_before_train=0.683381 cos_to_last_merge=1.0000 (last merge round=7)
[S8] round=8 local utility u=0.057856 metrics={'f1_val': 0.7148108482281725, 'auprc': 0.77657811722293, 'loss_val': 1.0422122014620507, 'psi': 0.7395177558260755}-{'f1_val': 0.7141723980650027, 'auprc': 0.7767723001114103, 'loss_val': 1.1546755156473352, 'psi': 0.7392123588835657}
[S9] START round=8 head_norm_before_train=0.771199 cos_to_last_merge=1.0000 (last merge round=7)
[S9] round=8 local utility u=0.009171 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9984192695119256, 'loss_val': 0.3851929909062399, 'psi': 0.8201419979293083}-{'f1_val': 0.7012904835408967, 'auprc': 0.9984281856517162, 'loss_val': 0.403562232741981, 'psi': 0.8201455643852246}
[S10] START round=8 head_norm_before_train=1.338568 (no previous merge yet)
[S10] round=8 local utility u=0.713261 metrics={'f1_val': 0.6980430300665794, 'auprc': 0.9979986998308032, 'loss_val': 0.6341038917844047, 'psi': 0.8180252979722689}-{'f1_val': 0.4841959007200213, 'auprc': 0.997088079690426, 'loss_val': 0.7748103181091959, 'psi': 0.6893527723081831}
[S11] START round=8 head_norm_before_train=1.203822 cos_to_last_merge=0.9973 (last merge round=6)
[S11] round=8 local utility u=0.945730 metrics={'f1_val': 0.3966539038083521, 'auprc': 0.9150488447892633, 'loss_val': 0.9336185917092364, 'psi': 0.6040118802007166}-{'f1_val': 0.14041368337311058, 'auprc': 0.8561266211029354, 'loss_val': 1.1108712829697496, 'psi': 0.4266988584650405}
[S13] START round=8 head_norm_before_train=1.100901 cos_to_last_merge=0.9433 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.943
[S13] round=8 local utility u=0.166182 metrics={'f1_val': 0.4160038662657951, 'auprc': 0.611926304339559, 'loss_val': 0.9131130769124881, 'psi': 0.49437284149530064}-{'f1_val': 0.416200286011302, 'auprc': 0.5385469752199459, 'loss_val': 1.0265174377179112, 'psi': 0.46513896169475955}
[S14] START round=8 head_norm_before_train=0.609322 cos_to_last_merge=1.0000 (last merge round=7)
[S14] round=8 local utility u=0.000000 metrics={'f1_val': 0.40338309105811965, 'auprc': 0.9983638214817818, 'loss_val': 0.9858754145853229, 'psi': 0.6413753832275846}-{'f1_val': 0.6782570205252754, 'auprc': 0.9990229700768555, 'loss_val': 1.0174157603023815, 'psi': 0.8065634003459075}
[S15] START round=8 head_norm_before_train=0.944429 cos_to_last_merge=1.0000 (last merge round=7)
[S15] round=8 local utility u=0.202282 metrics={'f1_val': 0.4166163667486056, 'auprc': 0.9033376018584025, 'loss_val': 0.8983316507110183, 'psi': 0.6113048607925244}-{'f1_val': 0.416567672447929, 'auprc': 0.7768532324951917, 'loss_val': 0.9231501609312304, 'psi': 0.5606818964668341}
[S16] START round=8 head_norm_before_train=0.661710 cos_to_last_merge=1.0000 (last merge round=7)
[S16] round=8 local utility u=0.000000 metrics={'f1_val': 0.41696372269722326, 'auprc': 0.46926739169672016, 'loss_val': 1.1002014795873436, 'psi': 0.43788519029702205}-{'f1_val': 0.41625059973887696, 'auprc': 0.554810674051735, 'loss_val': 1.1533615241008, 'psi': 0.47167462946402017}
[S17] START round=8 head_norm_before_train=1.427573 (no previous merge yet)
[S17] round=8 local utility u=0.003646 metrics={'f1_val': 0.3559779721641817, 'auprc': 0.6672215470352387, 'loss_val': 0.8171605248086918, 'psi': 0.48047540211260453}-{'f1_val': 0.35332495072624465, 'auprc': 0.6912606314663572, 'loss_val': 0.8806508805026089, 'psi': 0.48849922302228965}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:44910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:44910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:44916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:44915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:44902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:44915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:44909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:44911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] → sending delta(kind=head bytes=1792) to S5@127.0.0.1:44905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S11@127.0.0.1:44912
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:44916
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1804 to 1 peers)
[S15] sending update (kind=head size=1792 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1804 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1792) from S15
[S5] cosine check vs S15: cos=0.4194
[S16] RECEIVED delta(kind=head bytes=1796) from S9
[S16] cosine check vs S9: cos=0.6777
[S16] RECEIVED delta(kind=head bytes=1802) from S5
[S16] cosine check vs S5: cos=0.5640
[S8] RECEIVED delta(kind=head bytes=1801) from S6
[S8] cosine check vs S6: cos=0.8088
[S2] RECEIVED delta(kind=head bytes=1797) from S3
[S2] cosine check vs S3: cos=0.8833
[S11] RECEIVED delta(kind=head bytes=1804) from S4
[S11] cosine check vs S4: cos=0.9516
[S15] RECEIVED delta(kind=head bytes=1798) from S2
[S15] cosine check vs S2: cos=-0.0123
[S15] DROPPED delta from S2 (cos=-0.0123 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1799) from S11
[S15] cosine check vs S11: cos=0.9006
[S10] RECEIVED delta(kind=head bytes=1797) from S13
[S10] cosine check vs S13: cos=-0.0135
[S10] DROPPED delta from S13 (cos=-0.0135 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1801) from S8
[S9] cosine check vs S8: cos=0.8589
[S9] RECEIVED delta(kind=head bytes=1804) from S10
[S9] cosine check vs S10: cos=-0.0711
[S9] DROPPED delta from S10 (cos=-0.0711 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:44903
[S17] sending update (kind=head size=1796 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1796) from S17
[S3] cosine check vs S17: cos=0.2912
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=8 metric=0.7009 head_norm=1.307864
[S5] _apply_head_vector_avg (torch): Δ‖w‖=6.314112e-01
[S5] stored merged vector for next round verification (round=8)
[S5] DEBUG after merge:  round=8 metric=0.7006 head_norm=0.967260 delta_norm=0.631411
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=8 metric=0.7008 head_norm=1.023395
[S3] _apply_head_vector_avg (torch): Δ‖w‖=7.571875e-01
[S3] stored merged vector for next round verification (round=8)
[S3] DEBUG after merge:  round=8 metric=0.7008 head_norm=1.003244 delta_norm=0.757187
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=8 metric=0.3967 head_norm=1.233368
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.446915e-01
[S11] stored merged vector for next round verification (round=8)
[S11] DEBUG after merge:  round=8 metric=0.3967 head_norm=1.342040 delta_norm=0.244691
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=8 metric=0.4166 head_norm=0.978793
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.760543e-01
[S15] stored merged vector for next round verification (round=8)
[S15] DEBUG after merge:  round=8 metric=0.4166 head_norm=1.078615 delta_norm=0.276054
[S15] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=8 metric=0.7013 head_norm=0.887545
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.288386e-01
[S9] stored merged vector for next round verification (round=8)
[S9] DEBUG after merge:  round=8 metric=0.7013 head_norm=0.769926 delta_norm=0.228839
[S9] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=8 metric=0.4169 head_norm=0.909137
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.399464e-01
[S2] stored merged vector for next round verification (round=8)
[S2] DEBUG after merge:  round=8 metric=0.4169 head_norm=0.937742 delta_norm=0.239946
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=8 metric=0.7148 head_norm=0.708922
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.151330e-01
[S8] stored merged vector for next round verification (round=8)
[S8] DEBUG after merge:  round=8 metric=0.7147 head_norm=0.836166 delta_norm=0.315133
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=8 metric=0.4170 head_norm=0.684622
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.948268e-01
[S16] stored merged vector for next round verification (round=8)
[S16] DEBUG after merge:  round=8 metric=0.4348 head_norm=0.704525 delta_norm=0.194827
[S16] aggregate: ACCEPT kept=['S9', 'S5'] (k=2/2) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=0.937742 cos_to_last_merge=1.0000 (last merge round=8)
[S2] round=9 local utility u=0.702604 metrics={'f1_val': 0.6255033836663549, 'auprc': 0.7700624182610765, 'loss_val': 0.8852443977756659, 'psi': 0.6833269975042435}-{'f1_val': 0.4169384018324798, 'auprc': 0.7641600191403837, 'loss_val': 1.0213557288141335, 'psi': 0.5558270487556414}
[S3] START round=9 head_norm_before_train=1.003244 cos_to_last_merge=1.0000 (last merge round=8)
[S3] round=9 local utility u=0.024375 metrics={'f1_val': 0.7004261945879899, 'auprc': 0.9983689468135778, 'loss_val': 0.4599734586049616, 'psi': 0.8196032954782251}-{'f1_val': 0.7007562037352997, 'auprc': 0.9984606390880574, 'loss_val': 0.5109793313264449, 'psi': 0.8198379778764027}
[S4] START round=9 head_norm_before_train=1.483475 (no previous merge yet)
[S4] round=9 local utility u=0.055368 metrics={'f1_val': 0.650794638117455, 'auprc': 0.6561426766591499, 'loss_val': 0.5263629113024846, 'psi': 0.6529338535341329}-{'f1_val': 0.6472516758999612, 'auprc': 0.6569657400597493, 'loss_val': 0.6183104812455836, 'psi': 0.6511373015638765}
[S5] START round=9 head_norm_before_train=0.967260 cos_to_last_merge=1.0000 (last merge round=8)
[S5] round=9 local utility u=0.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.8073383145204588, 'loss_val': 0.5368438751564395, 'psi': 0.7431276849029989}-{'f1_val': 0.7008569501491988, 'auprc': 0.8278805816934824, 'loss_val': 0.5023832141285915, 'psi': 0.7516664027669122}
[S6] START round=9 head_norm_before_train=1.046133 cos_to_last_merge=0.9320 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.932
[S6] round=9 local utility u=0.065252 metrics={'f1_val': 0.39674659097428877, 'auprc': 0.7692025951556992, 'loss_val': 0.8636394375542669, 'psi': 0.5457289926468529}-{'f1_val': 0.37825724744131173, 'auprc': 0.7647597006079607, 'loss_val': 0.8698779713670878, 'psi': 0.5328582287079713}
[S7] START round=9 head_norm_before_train=1.239692 cos_to_last_merge=0.9004 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.900
[S7] round=9 local utility u=0.000000 metrics={'f1_val': 0.3813162386038589, 'auprc': 0.6291978632551305, 'loss_val': 0.9306489068029924, 'psi': 0.4804688884643675}-{'f1_val': 0.3760115345305238, 'auprc': 0.7413092894022619, 'loss_val': 0.8615743240498392, 'psi': 0.5221306364792191}
[S8] START round=9 head_norm_before_train=0.836166 cos_to_last_merge=1.0000 (last merge round=8)
[S8] round=9 local utility u=0.000000 metrics={'f1_val': 0.37319932875242556, 'auprc': 0.7764060525820179, 'loss_val': 0.9113967780772054, 'psi': 0.5344820182842625}-{'f1_val': 0.7148108482281725, 'auprc': 0.77657811722293, 'loss_val': 1.0422122014620507, 'psi': 0.7395177558260755}
[S9] START round=9 head_norm_before_train=0.769926 cos_to_last_merge=1.0000 (last merge round=8)
[S9] round=9 local utility u=0.006054 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9980371601375804, 'loss_val': 0.3714951494190034, 'psi': 0.8199448125190433}-{'f1_val': 0.7012904835408967, 'auprc': 0.9984192695119256, 'loss_val': 0.3851929909062399, 'psi': 0.8201419979293083}
[S10] START round=9 head_norm_before_train=1.367347 (no previous merge yet)
[S10] round=9 local utility u=0.042818 metrics={'f1_val': 0.6957499676872537, 'auprc': 0.9981847856720929, 'loss_val': 0.5352673556150236, 'psi': 0.8167238948811895}-{'f1_val': 0.6980430300665794, 'auprc': 0.9979986998308032, 'loss_val': 0.6341038917844047, 'psi': 0.8180252979722689}
[S11] START round=9 head_norm_before_train=1.342040 cos_to_last_merge=1.0000 (last merge round=8)
[S11] round=9 local utility u=0.138779 metrics={'f1_val': 0.4095369759017879, 'auprc': 0.9401471419657689, 'loss_val': 0.8086543044963687, 'psi': 0.6217810423273803}-{'f1_val': 0.3966539038083521, 'auprc': 0.9150488447892633, 'loss_val': 0.9336185917092364, 'psi': 0.6040118802007166}
[S13] START round=9 head_norm_before_train=1.140183 cos_to_last_merge=0.9296 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.930
[S13] round=9 local utility u=0.752838 metrics={'f1_val': 0.5976419361402157, 'auprc': 0.7232142985838419, 'loss_val': 0.8311297495802269, 'psi': 0.6478708811176661}-{'f1_val': 0.4160038662657951, 'auprc': 0.611926304339559, 'loss_val': 0.9131130769124881, 'psi': 0.49437284149530064}
[S14] START round=9 head_norm_before_train=0.653492 cos_to_last_merge=0.9914 (last merge round=7)
[S14] round=9 local utility u=0.595306 metrics={'f1_val': 0.5792565024973597, 'auprc': 0.9955848644203551, 'loss_val': 0.8421674530873967, 'psi': 0.7457878472665579}-{'f1_val': 0.40338309105811965, 'auprc': 0.9983638214817818, 'loss_val': 0.9858754145853229, 'psi': 0.6413753832275846}
[S15] START round=9 head_norm_before_train=1.078615 cos_to_last_merge=1.0000 (last merge round=8)
[S15] round=9 local utility u=0.123764 metrics={'f1_val': 0.4170699305588984, 'auprc': 0.9698538939808785, 'loss_val': 0.8530731993183571, 'psi': 0.6381835159276905}-{'f1_val': 0.4166163667486056, 'auprc': 0.9033376018584025, 'loss_val': 0.8983316507110183, 'psi': 0.6113048607925244}
[S16] START round=9 head_norm_before_train=0.704525 cos_to_last_merge=1.0000 (last merge round=8)
[S16] round=9 local utility u=0.106900 metrics={'f1_val': 0.4347245028087052, 'auprc': 0.4892404442699197, 'loss_val': 1.052885077504058, 'psi': 0.456530879393191}-{'f1_val': 0.41696372269722326, 'auprc': 0.46926739169672016, 'loss_val': 1.1002014795873436, 'psi': 0.43788519029702205}
[S17] START round=9 head_norm_before_train=1.453384 (no previous merge yet)
[S17] round=9 local utility u=0.041745 metrics={'f1_val': 0.36472685617515954, 'auprc': 0.6638816772793695, 'loss_val': 0.7761446102843377, 'psi': 0.48438878461684354}-{'f1_val': 0.3559779721641817, 'auprc': 0.6672215470352387, 'loss_val': 0.8171605248086918, 'psi': 0.48047540211260453}
[S13] not sending this round → trigger blocked (psi=0.648)
[S11] not sending this round → trigger blocked (psi=0.622)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:44909
[S15] not sending this round → trigger blocked (psi=0.638)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.820)
[S10] not sending this round → trigger blocked (psi=0.817)
[S9] not sending this round → trigger blocked (psi=0.820)
[S6] not sending this round → trigger blocked (psi=0.546)
[S4] not sending this round → trigger blocked (psi=0.653)
[S2] not sending this round → trigger blocked (psi=0.683)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:44914
[S16] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1798) from S14
[S8] cosine check vs S14: cos=0.4713
[S14] RECEIVED delta(kind=head bytes=1801) from S16
[S14] cosine check vs S16: cos=0.5843
[S17] not sending this round → trigger blocked (psi=0.484)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=9 metric=0.3732 head_norm=0.864066
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.088617e-01
[S8] stored merged vector for next round verification (round=9)
[S8] DEBUG after merge:  round=9 metric=0.3732 head_norm=0.673592 delta_norm=0.408862
[S8] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=9 metric=0.5793 head_norm=0.703690
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.271131e-01
[S14] stored merged vector for next round verification (round=9)
[S14] DEBUG after merge:  round=9 metric=0.4912 head_norm=0.638204 delta_norm=0.327113
[S14] aggregate: ROLLBACK (f1_val pre=0.579 post=0.491 tol_abs=0.005 tol_rel=0.0)
[S2] START round=10 head_norm_before_train=0.979446 cos_to_last_merge=0.9973 (last merge round=8)
[S2] round=10 local utility u=0.318827 metrics={'f1_val': 0.7008717589696155, 'auprc': 0.771595356748127, 'loss_val': 0.7043994087239547, 'psi': 0.7291611980810202}-{'f1_val': 0.6255033836663549, 'auprc': 0.7700624182610765, 'loss_val': 0.8852443977756659, 'psi': 0.6833269975042435}
[S3] START round=10 head_norm_before_train=1.075212 cos_to_last_merge=0.9889 (last merge round=8)
[S3] round=10 local utility u=0.051968 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9986186397841063, 'loss_val': 0.35831579015865617, 'psi': 0.8198560317128434}-{'f1_val': 0.7004261945879899, 'auprc': 0.9983689468135778, 'loss_val': 0.4599734586049616, 'psi': 0.8196032954782251}
[S4] START round=10 head_norm_before_train=1.535770 (no previous merge yet)
[S4] round=10 local utility u=0.374041 metrics={'f1_val': 0.6536143883258652, 'auprc': 0.8940947540622433, 'loss_val': 0.5090558328441643, 'psi': 0.7498065346204164}-{'f1_val': 0.650794638117455, 'auprc': 0.6561426766591499, 'loss_val': 0.5263629113024846, 'psi': 0.6529338535341329}
[S5] START round=10 head_norm_before_train=1.032681 cos_to_last_merge=0.9925 (last merge round=8)
[S5] round=10 local utility u=0.261204 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9466866188086326, 'loss_val': 0.4324842376167964, 'psi': 0.7988674379838012}-{'f1_val': 0.700320598491359, 'auprc': 0.8073383145204588, 'loss_val': 0.5368438751564395, 'psi': 0.7431276849029989}
[S6] START round=10 head_norm_before_train=1.096005 cos_to_last_merge=0.9164 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.916
[S6] round=10 local utility u=0.769739 metrics={'f1_val': 0.6073573819890334, 'auprc': 0.7937963381739621, 'loss_val': 0.6616077681059102, 'psi': 0.6819329644630049}-{'f1_val': 0.39674659097428877, 'auprc': 0.7692025951556992, 'loss_val': 0.8636394375542669, 'psi': 0.5457289926468529}
[S7] START round=10 head_norm_before_train=1.272804 cos_to_last_merge=0.8939 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.894
[S7] round=10 local utility u=1.000000 metrics={'f1_val': 0.663626611246694, 'auprc': 0.7716094823295712, 'loss_val': 0.5333745046245044, 'psi': 0.7068197596798449}-{'f1_val': 0.3813162386038589, 'auprc': 0.6291978632551305, 'loss_val': 0.9306489068029924, 'psi': 0.4804688884643675}
[S8] START round=10 head_norm_before_train=0.673592 cos_to_last_merge=1.0000 (last merge round=9)
[S8] round=10 local utility u=1.000000 metrics={'f1_val': 0.7141742661762565, 'auprc': 0.9946071775200735, 'loss_val': 0.8542351074703268, 'psi': 0.8263474307137832}-{'f1_val': 0.37319932875242556, 'auprc': 0.7764060525820179, 'loss_val': 0.9113967780772054, 'psi': 0.5344820182842625}
[S9] START round=10 head_norm_before_train=0.882221 cos_to_last_merge=0.9878 (last merge round=8)
[S9] round=10 local utility u=0.037209 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9980229472591561, 'loss_val': 0.29703443068994406, 'psi': 0.8199391273676736}-{'f1_val': 0.7012165807733519, 'auprc': 0.9980371601375804, 'loss_val': 0.3714951494190034, 'psi': 0.8199448125190433}
[S10] START round=10 head_norm_before_train=1.398481 (no previous merge yet)
[S10] round=10 local utility u=0.053509 metrics={'f1_val': 0.7004721626846612, 'auprc': 0.9976575599106845, 'loss_val': 0.4550010816471854, 'psi': 0.8193463215750705}-{'f1_val': 0.6957499676872537, 'auprc': 0.9981847856720929, 'loss_val': 0.5352673556150236, 'psi': 0.8167238948811895}
[S11] START round=10 head_norm_before_train=1.370802 cos_to_last_merge=0.9980 (last merge round=8)
[S11] round=10 local utility u=0.962816 metrics={'f1_val': 0.7016501368687256, 'auprc': 0.9398407859935368, 'loss_val': 0.634782753402572, 'psi': 0.7969263965186502}-{'f1_val': 0.4095369759017879, 'auprc': 0.9401471419657689, 'loss_val': 0.8086543044963687, 'psi': 0.6217810423273803}
[S13] START round=10 head_norm_before_train=1.181539 cos_to_last_merge=0.9143 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.914
[S13] round=10 local utility u=0.353223 metrics={'f1_val': 0.6872867209045268, 'auprc': 0.7520171928348094, 'loss_val': 0.7489618462119519, 'psi': 0.7131789096766399}-{'f1_val': 0.5976419361402157, 'auprc': 0.7232142985838419, 'loss_val': 0.8311297495802269, 'psi': 0.6478708811176661}
[S14] START round=10 head_norm_before_train=0.638204 cos_to_last_merge=1.0000 (last merge round=9)
[S14] round=10 local utility u=0.102685 metrics={'f1_val': 0.6205637456666455, 'auprc': 0.9946373411594588, 'loss_val': 0.8817980565496795, 'psi': 0.7701931838637708}-{'f1_val': 0.5792565024973597, 'auprc': 0.9955848644203551, 'loss_val': 0.8421674530873967, 'psi': 0.7457878472665579}
[S15] START round=10 head_norm_before_train=1.109125 cos_to_last_merge=0.9961 (last merge round=8)
[S15] round=10 local utility u=0.962411 metrics={'f1_val': 0.701315205763202, 'auprc': 0.9902528397866468, 'loss_val': 0.6949198710561356, 'psi': 0.81689025937258}-{'f1_val': 0.4170699305588984, 'auprc': 0.9698538939808785, 'loss_val': 0.8530731993183571, 'psi': 0.6381835159276905}
[S16] START round=10 head_norm_before_train=0.730367 cos_to_last_merge=0.9910 (last merge round=8)
[S16] round=10 local utility u=0.156653 metrics={'f1_val': 0.3497466717619005, 'auprc': 0.7418631772583291, 'loss_val': 0.9875798962034337, 'psi': 0.5065932739604719}-{'f1_val': 0.4347245028087052, 'auprc': 0.4892404442699197, 'loss_val': 1.052885077504058, 'psi': 0.456530879393191}
[S17] START round=10 head_norm_before_train=1.471295 (no previous merge yet)
[S17] round=10 local utility u=0.128725 metrics={'f1_val': 0.3863465541383304, 'auprc': 0.6825816438814503, 'loss_val': 0.7045123791928759, 'psi': 0.5048405900355784}-{'f1_val': 0.36472685617515954, 'auprc': 0.6638816772793695, 'loss_val': 0.7761446102843377, 'psi': 0.48438878461684354}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:44916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:44902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:44903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:44910
[S14] not sending this round → trigger blocked (psi=0.770)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S10] → sending delta(kind=head bytes=1806) to S9@127.0.0.1:44910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:44911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:44912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:44905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:44915
[S16] not sending this round → trigger blocked (psi=0.507)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:44909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:44915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:44916
[S9] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1806 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1796) from S15
[S5] cosine check vs S15: cos=0.6110
[S16] RECEIVED delta(kind=head bytes=1800) from S9
[S16] cosine check vs S9: cos=0.5852
[S16] RECEIVED delta(kind=head bytes=1800) from S5
[S16] cosine check vs S5: cos=0.6593
[S8] RECEIVED delta(kind=head bytes=1796) from S6
[S8] cosine check vs S6: cos=0.7266
[S2] RECEIVED delta(kind=head bytes=1797) from S3
[S2] cosine check vs S3: cos=0.7600
[S3] RECEIVED delta(kind=head bytes=1799) from S7
[S3] cosine check vs S7: cos=0.4523
[S11] RECEIVED delta(kind=head bytes=1800) from S4
[S11] cosine check vs S4: cos=0.9654
[S15] RECEIVED delta(kind=head bytes=1798) from S2
[S15] cosine check vs S2: cos=-0.0149
[S15] DROPPED delta from S2 (cos=-0.0149 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1800) from S11
[S15] cosine check vs S11: cos=0.9406
[S10] RECEIVED delta(kind=head bytes=1801) from S13
[S10] cosine check vs S13: cos=0.0019
[S9] RECEIVED delta(kind=head bytes=1806) from S10
[S9] cosine check vs S10: cos=-0.0580
[S9] DROPPED delta from S10 (cos=-0.0580 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1798) from S8
[S9] cosine check vs S8: cos=0.8771
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:44903
[S17] sending update (kind=head size=1797 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1797) from S17
[S3] cosine check vs S17: cos=0.7936
[S14] ⇄ pheromone p=0.416 → S8@127.0.0.1:44909
[S7] ⇄ pheromone p=0.387 → S3@127.0.0.1:44903
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=10 metric=0.7142 head_norm=0.713840
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.939064e-01
[S8] stored merged vector for next round verification (round=10)
[S8] DEBUG after merge:  round=10 metric=0.3728 head_norm=0.862528 delta_norm=0.393906
[S8] aggregate: ROLLBACK (f1_val pre=0.714 post=0.373 tol_abs=0.005 tol_rel=0.0)
[S8] ⇄ pheromone p=0.402 → S9@127.0.0.1:44910
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=10 metric=0.7017 head_norm=1.412052
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.137568e-01
[S11] stored merged vector for next round verification (round=10)
[S11] DEBUG after merge:  round=10 metric=0.7017 head_norm=1.483447 delta_norm=0.213757
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.512 → S15@127.0.0.1:44915
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=10 metric=0.7013 head_norm=1.148825
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.559947e-01
[S15] stored merged vector for next round verification (round=10)
[S15] DEBUG after merge:  round=10 metric=0.7004 head_norm=1.261472 delta_norm=0.255995
[S15] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.439 → S5@127.0.0.1:44905
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=10 metric=0.7003 head_norm=1.105940
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.975777e-01
[S5] stored merged vector for next round verification (round=10)
[S5] DEBUG after merge:  round=10 metric=0.7003 head_norm=1.011863 delta_norm=0.497578
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.353 → S16@127.0.0.1:44916
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=10 metric=0.7012 head_norm=0.989471
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.497873e-01
[S9] stored merged vector for next round verification (round=10)
[S9] DEBUG after merge:  round=10 metric=0.7012 head_norm=0.825782 delta_norm=0.249787
[S9] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.242 → S16@127.0.0.1:44916
[S13] ⇄ pheromone p=0.396 → S10@127.0.0.1:44911
[S4] ⇄ pheromone p=0.324 → S11@127.0.0.1:44912
[S6] ⇄ pheromone p=0.392 → S8@127.0.0.1:44909
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=10 metric=0.7005 head_norm=1.434875
[S10] _apply_head_vector_avg (torch): Δ‖w‖=9.422859e-01
[S10] stored merged vector for next round verification (round=10)
[S10] DEBUG after merge:  round=10 metric=0.7012 head_norm=0.944076 delta_norm=0.942286
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.352 → S9@127.0.0.1:44910
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=10 metric=0.7009 head_norm=1.034608
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.830605e-01
[S2] stored merged vector for next round verification (round=10)
[S2] DEBUG after merge:  round=10 metric=0.6996 head_norm=1.026546 delta_norm=0.383060
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.403 → S15@127.0.0.1:44915
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=10 metric=0.7007 head_norm=1.153539
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.637588e-01
[S3] stored merged vector for next round verification (round=10)
[S3] DEBUG after merge:  round=10 metric=0.7007 head_norm=1.043970 delta_norm=0.263759
[S3] aggregate: ACCEPT kept=['S7', 'S17'] (k=2/2) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.316 → S2@127.0.0.1:44902
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=10 metric=0.3497 head_norm=0.772438
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.825591e-01
[S16] stored merged vector for next round verification (round=10)
[S16] DEBUG after merge:  round=10 metric=0.3114 head_norm=0.733871 delta_norm=0.182559
[S16] aggregate: ROLLBACK (f1_val pre=0.350 post=0.311 tol_abs=0.005 tol_rel=0.0)
[S16] ⇄ pheromone p=0.232 → S14@127.0.0.1:44914
[S17] ⇄ pheromone p=0.232 → S3@127.0.0.1:44903
[S2] START round=11 head_norm_before_train=1.026546 cos_to_last_merge=1.0000 (last merge round=10)
[S2] round=11 local utility u=0.076196 metrics={'f1_val': 0.7015719066528542, 'auprc': 0.7770859847728561, 'loss_val': 0.5726801867743185, 'psi': 0.731777537900855}-{'f1_val': 0.7008717589696155, 'auprc': 0.771595356748127, 'loss_val': 0.7043994087239547, 'psi': 0.7291611980810202}
[S3] START round=11 head_norm_before_train=1.043970 cos_to_last_merge=1.0000 (last merge round=10)
[S3] round=11 local utility u=0.000000 metrics={'f1_val': 0.7006060025002057, 'auprc': 0.9982667691281717, 'loss_val': 0.3671906322338069, 'psi': 0.819670309151392}-{'f1_val': 0.7006809596653347, 'auprc': 0.9986186397841063, 'loss_val': 0.35831579015865617, 'psi': 0.8198560317128434}
[S4] START round=11 head_norm_before_train=1.580735 (no previous merge yet)
[S4] round=11 local utility u=0.061469 metrics={'f1_val': 0.6575595522127193, 'auprc': 0.9184614238328233, 'loss_val': 0.4828886339425597, 'psi': 0.7619203008607609}-{'f1_val': 0.6536143883258652, 'auprc': 0.8940947540622433, 'loss_val': 0.5090558328441643, 'psi': 0.7498065346204164}
[S5] START round=11 head_norm_before_train=1.011863 cos_to_last_merge=1.0000 (last merge round=10)
[S5] round=11 local utility u=0.026560 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9908981835235056, 'loss_val': 0.5119951221178938, 'psi': 0.8165516325042177}-{'f1_val': 0.7003213174339138, 'auprc': 0.9466866188086326, 'loss_val': 0.4324842376167964, 'psi': 0.7988674379838012}
[S6] START round=11 head_norm_before_train=1.135194 cos_to_last_merge=0.9028 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.903
[S6] round=11 local utility u=0.560197 metrics={'f1_val': 0.6977258953228864, 'auprc': 0.947637612896215, 'loss_val': 0.5449481433392709, 'psi': 0.7976905823522178}-{'f1_val': 0.6073573819890334, 'auprc': 0.7937963381739621, 'loss_val': 0.6616077681059102, 'psi': 0.6819329644630049}
[S7] START round=11 head_norm_before_train=1.297733 cos_to_last_merge=0.8888 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.889
[S7] round=11 local utility u=0.121991 metrics={'f1_val': 0.664517784615719, 'auprc': 0.8451653974052276, 'loss_val': 0.5154066709916774, 'psi': 0.7367768297315225}-{'f1_val': 0.663626611246694, 'auprc': 0.7716094823295712, 'loss_val': 0.5333745046245044, 'psi': 0.7068197596798449}
[S8] START round=11 head_norm_before_train=0.862528 cos_to_last_merge=1.0000 (last merge round=10)
[S8] round=11 local utility u=0.000000 metrics={'f1_val': 0.37266438550987346, 'auprc': 0.994697360622066, 'loss_val': 0.7236923649224294, 'psi': 0.6214775755547505}-{'f1_val': 0.7141742661762565, 'auprc': 0.9946071775200735, 'loss_val': 0.8542351074703268, 'psi': 0.8263474307137832}
[S9] START round=11 head_norm_before_train=0.825782 cos_to_last_merge=1.0000 (last merge round=10)
[S9] round=11 local utility u=0.000000 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9976298853674394, 'loss_val': 0.30182981102045675, 'psi': 0.8197819026109869}-{'f1_val': 0.7012165807733519, 'auprc': 0.9980229472591561, 'loss_val': 0.29703443068994406, 'psi': 0.8199391273676736}
[S10] START round=11 head_norm_before_train=0.944076 cos_to_last_merge=1.0000 (last merge round=10)
[S10] round=11 local utility u=0.000000 metrics={'f1_val': 0.6986700707622906, 'auprc': 0.9972827698132334, 'loss_val': 0.5519645040618912, 'psi': 0.8181151503826678}-{'f1_val': 0.7004721626846612, 'auprc': 0.9976575599106845, 'loss_val': 0.4550010816471854, 'psi': 0.8193463215750705}
[S11] START round=11 head_norm_before_train=1.483447 cos_to_last_merge=1.0000 (last merge round=10)
[S11] round=11 local utility u=0.068146 metrics={'f1_val': 0.7020664967782734, 'auprc': 0.9410732616191929, 'loss_val': 0.5046857542228165, 'psi': 0.7976692027146413}-{'f1_val': 0.7016501368687256, 'auprc': 0.9398407859935368, 'loss_val': 0.634782753402572, 'psi': 0.7969263965186502}
[S13] START round=11 head_norm_before_train=1.224540 cos_to_last_merge=0.8985 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.898
[S13] round=11 local utility u=0.008494 metrics={'f1_val': 0.6864554765490347, 'auprc': 0.7326329782225942, 'loss_val': 0.6688335427153718, 'psi': 0.7049264772184585}-{'f1_val': 0.6872867209045268, 'auprc': 0.7520171928348094, 'loss_val': 0.7489618462119519, 'psi': 0.7131789096766399}
[S14] START round=11 head_norm_before_train=0.675631 cos_to_last_merge=0.9920 (last merge round=9)
[S14] round=11 local utility u=1.000000 metrics={'f1_val': 0.9968459826427369, 'auprc': 0.9956494911293634, 'loss_val': 0.6943794303921108, 'psi': 0.9963673860373875}-{'f1_val': 0.6205637456666455, 'auprc': 0.9946373411594588, 'loss_val': 0.8817980565496795, 'psi': 0.7701931838637708}
[S15] START round=11 head_norm_before_train=1.261472 cos_to_last_merge=1.0000 (last merge round=10)
[S15] round=11 local utility u=0.000000 metrics={'f1_val': 0.701073687542608, 'auprc': 0.8735568533005358, 'loss_val': 0.6396962150006115, 'psi': 0.7700669538457792}-{'f1_val': 0.701315205763202, 'auprc': 0.9902528397866468, 'loss_val': 0.6949198710561356, 'psi': 0.81689025937258}
[S16] START round=11 head_norm_before_train=0.733871 cos_to_last_merge=1.0000 (last merge round=10)
[S16] round=11 local utility u=0.185410 metrics={'f1_val': 0.41287025302583263, 'auprc': 0.7331648608149108, 'loss_val': 0.9694062853850177, 'psi': 0.5409880961414639}-{'f1_val': 0.3497466717619005, 'auprc': 0.7418631772583291, 'loss_val': 0.9875798962034337, 'psi': 0.5065932739604719}
[S17] START round=11 head_norm_before_train=1.489330 (no previous merge yet)
[S17] round=11 local utility u=0.327166 metrics={'f1_val': 0.4203666096938549, 'auprc': 0.795664288476604, 'loss_val': 0.5935488572528117, 'psi': 0.5704856812069545}-{'f1_val': 0.3863465541383304, 'auprc': 0.6825816438814503, 'loss_val': 0.7045123791928759, 'psi': 0.5048405900355784}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:44909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:44915
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:44915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:44916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S13] → sending delta(kind=head bytes=1792) to S10@127.0.0.1:44911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:44903
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] → sending delta(kind=head bytes=1793) to S14@127.0.0.1:44914
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:44912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:44909
[S5] sending update (kind=head size=1803 to 1 peers)
[S16] sending update (kind=head size=1793 to 1 peers)
[S13] sending update (kind=head size=1792 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1794 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1799) from S14
[S8] cosine check vs S14: cos=0.5516
[S3] RECEIVED delta(kind=head bytes=1794) from S7
[S3] cosine check vs S7: cos=0.5524
[S15] RECEIVED delta(kind=head bytes=1797) from S11
[S15] cosine check vs S11: cos=0.9707
[S16] RECEIVED delta(kind=head bytes=1803) from S5
[S16] cosine check vs S5: cos=0.6113
[S10] RECEIVED delta(kind=head bytes=1792) from S13
[S10] cosine check vs S13: cos=0.6257
[S14] RECEIVED delta(kind=head bytes=1793) from S16
[S14] cosine check vs S16: cos=0.8027
[S8] RECEIVED delta(kind=head bytes=1800) from S6
[S8] cosine check vs S6: cos=0.9380
[S11] RECEIVED delta(kind=head bytes=1800) from S4
[S11] cosine check vs S4: cos=0.9848
[S15] RECEIVED delta(kind=head bytes=1801) from S2
[S15] cosine check vs S2: cos=-0.0168
[S15] DROPPED delta from S2 (cos=-0.0168 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] → sending delta(kind=head bytes=1793) to S3@127.0.0.1:44903
[S17] sending update (kind=head size=1793 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1793) from S17
[S3] cosine check vs S17: cos=0.7745
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=11 metric=0.7006 head_norm=1.111091
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.876730e-01
[S3] stored merged vector for next round verification (round=11)
[S3] DEBUG after merge:  round=11 metric=0.7006 head_norm=1.043975 delta_norm=0.187673
[S3] aggregate: ACCEPT kept=['S7', 'S17'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=11 metric=0.3727 head_norm=0.906287
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.416222e-01
[S8] stored merged vector for next round verification (round=11)
[S8] DEBUG after merge:  round=11 metric=0.3727 head_norm=0.836584 delta_norm=0.141622
[S8] aggregate: ACCEPT kept=['S14', 'S6'] (k=2/2) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=11 metric=0.6987 head_norm=0.992316
[S10] _apply_head_vector_avg (torch): Δ‖w‖=5.049958e-01
[S10] stored merged vector for next round verification (round=11)
[S10] DEBUG after merge:  round=11 metric=0.6999 head_norm=1.021435 delta_norm=0.504996
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=11 metric=0.7011 head_norm=1.290390
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.055000e-01
[S15] stored merged vector for next round verification (round=11)
[S15] DEBUG after merge:  round=11 metric=0.7012 head_norm=1.396133 delta_norm=0.205500
[S15] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=11 metric=0.7021 head_norm=1.522409
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.453757e-01
[S11] stored merged vector for next round verification (round=11)
[S11] DEBUG after merge:  round=11 metric=0.7023 head_norm=1.565708 delta_norm=0.145376
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=11 metric=0.4129 head_norm=0.776157
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.262736e-01
[S16] stored merged vector for next round verification (round=11)
[S16] DEBUG after merge:  round=11 metric=0.3755 head_norm=0.829029 delta_norm=0.426274
[S16] aggregate: ROLLBACK (f1_val pre=0.413 post=0.375 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=11 metric=0.9968 head_norm=0.726139
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.371163e-01
[S14] stored merged vector for next round verification (round=11)
[S14] DEBUG after merge:  round=11 metric=0.6200 head_norm=0.713180 delta_norm=0.237116
[S14] aggregate: ROLLBACK (f1_val pre=0.997 post=0.620 tol_abs=0.005 tol_rel=0.0)
[S2] START round=12 head_norm_before_train=1.081869 cos_to_last_merge=0.9968 (last merge round=10)
[S2] round=12 local utility u=0.000000 metrics={'f1_val': 0.7018318238212289, 'auprc': 0.6868455611498997, 'loss_val': 0.41991840632291727, 'psi': 0.6958373187526972}-{'f1_val': 0.7015719066528542, 'auprc': 0.7770859847728561, 'loss_val': 0.5726801867743185, 'psi': 0.731777537900855}
[S3] START round=12 head_norm_before_train=1.043975 cos_to_last_merge=1.0000 (last merge round=11)
[S3] round=12 local utility u=0.004413 metrics={'f1_val': 0.7006060025002057, 'auprc': 0.9986328999485674, 'loss_val': 0.3594635608213003, 'psi': 0.8198167614795504}-{'f1_val': 0.7006060025002057, 'auprc': 0.9982667691281717, 'loss_val': 0.3671906322338069, 'psi': 0.819670309151392}
[S4] START round=12 head_norm_before_train=1.620933 (no previous merge yet)
[S4] round=12 local utility u=0.000000 metrics={'f1_val': 0.6515996631627723, 'auprc': 0.8905405915166202, 'loss_val': 0.5040604881112446, 'psi': 0.7471760345043115}-{'f1_val': 0.6575595522127193, 'auprc': 0.9184614238328233, 'loss_val': 0.4828886339425597, 'psi': 0.7619203008607609}
[S5] START round=12 head_norm_before_train=1.065634 cos_to_last_merge=0.9949 (last merge round=10)
[S5] round=12 local utility u=0.064407 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9921616511333902, 'loss_val': 0.3869724503648258, 'psi': 0.8170570195481714}-{'f1_val': 0.700320598491359, 'auprc': 0.9908981835235056, 'loss_val': 0.5119951221178938, 'psi': 0.8165516325042177}
[S6] START round=12 head_norm_before_train=1.172315 cos_to_last_merge=0.8896 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.890
[S6] round=12 local utility u=0.000000 metrics={'f1_val': 0.6940654827024352, 'auprc': 0.7887585711002628, 'loss_val': 0.5630218026443073, 'psi': 0.7319427180615663}-{'f1_val': 0.6977258953228864, 'auprc': 0.947637612896215, 'loss_val': 0.5449481433392709, 'psi': 0.7976905823522178}
[S7] START round=12 head_norm_before_train=1.318838 cos_to_last_merge=0.8843 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.884
[S7] round=12 local utility u=0.000000 metrics={'f1_val': 0.4237024885955324, 'auprc': 0.7032897959477826, 'loss_val': 0.9450872077809533, 'psi': 0.5355374115364324}-{'f1_val': 0.664517784615719, 'auprc': 0.8451653974052276, 'loss_val': 0.5154066709916774, 'psi': 0.7367768297315225}
[S8] START round=12 head_norm_before_train=0.836584 cos_to_last_merge=1.0000 (last merge round=11)
[S8] round=12 local utility u=0.400320 metrics={'f1_val': 0.4958757247545934, 'auprc': 0.9958163767075483, 'loss_val': 0.6656780050961332, 'psi': 0.6958519855357754}-{'f1_val': 0.37266438550987346, 'auprc': 0.994697360622066, 'loss_val': 0.7236923649224294, 'psi': 0.6214775755547505}
[S9] START round=12 head_norm_before_train=0.922491 cos_to_last_merge=0.9946 (last merge round=10)
[S9] round=12 local utility u=0.039616 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9979970435668734, 'loss_val': 0.22370020011205125, 'psi': 0.8199287658907605}-{'f1_val': 0.7012165807733519, 'auprc': 0.9976298853674394, 'loss_val': 0.30182981102045675, 'psi': 0.8197819026109869}
[S10] START round=12 head_norm_before_train=1.021435 cos_to_last_merge=1.0000 (last merge round=11)
[S10] round=12 local utility u=0.000000 metrics={'f1_val': 0.7001085408329333, 'auprc': 0.9348794312926655, 'loss_val': 0.6079105946252872, 'psi': 0.7940168970168262}-{'f1_val': 0.6986700707622906, 'auprc': 0.9972827698132334, 'loss_val': 0.5519645040618912, 'psi': 0.8181151503826678}
[S11] START round=12 head_norm_before_train=1.565708 cos_to_last_merge=1.0000 (last merge round=11)
[S11] round=12 local utility u=0.141153 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9984329614203146, 'loss_val': 0.39367149901419946, 'psi': 0.8205343745471179}-{'f1_val': 0.7020664967782734, 'auprc': 0.9410732616191929, 'loss_val': 0.5046857542228165, 'psi': 0.7976692027146413}
[S13] START round=12 head_norm_before_train=1.269648 cos_to_last_merge=0.8850 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.885
[S13] round=12 local utility u=0.000000 metrics={'f1_val': 0.6020983915218272, 'auprc': 0.7405335344320246, 'loss_val': 0.63590641231465, 'psi': 0.6574724486859062}-{'f1_val': 0.6864554765490347, 'auprc': 0.7326329782225942, 'loss_val': 0.6688335427153718, 'psi': 0.7049264772184585}
[S14] START round=12 head_norm_before_train=0.713180 cos_to_last_merge=1.0000 (last merge round=11)
[S14] round=12 local utility u=0.007207 metrics={'f1_val': 0.9936569488964806, 'auprc': 0.9971312390466065, 'loss_val': 0.6652758185546165, 'psi': 0.995046664956531}-{'f1_val': 0.9968459826427369, 'auprc': 0.9956494911293634, 'loss_val': 0.6943794303921108, 'psi': 0.9963673860373875}
[S15] START round=12 head_norm_before_train=1.396133 cos_to_last_merge=1.0000 (last merge round=11)
[S15] round=12 local utility u=0.278221 metrics={'f1_val': 0.7184467533205364, 'auprc': 0.9865554895348833, 'loss_val': 0.5264884690286962, 'psi': 0.8256902478062751}-{'f1_val': 0.701073687542608, 'auprc': 0.8735568533005358, 'loss_val': 0.6396962150006115, 'psi': 0.7700669538457792}
[S16] START round=12 head_norm_before_train=0.829029 cos_to_last_merge=1.0000 (last merge round=11)
[S16] round=12 local utility u=0.000000 metrics={'f1_val': 0.39352732777747373, 'auprc': 0.6924618657400916, 'loss_val': 0.9685985828585086, 'psi': 0.5131011429625209}-{'f1_val': 0.41287025302583263, 'auprc': 0.7331648608149108, 'loss_val': 0.9694062853850177, 'psi': 0.5409880961414639}
[S17] START round=12 head_norm_before_train=1.510396 (no previous merge yet)
[S17] round=12 local utility u=0.000000 metrics={'f1_val': 0.39367469728429044, 'auprc': 0.7453097414025089, 'loss_val': 0.6334524445925164, 'psi': 0.5343287149315779}-{'f1_val': 0.4203666096938549, 'auprc': 0.795664288476604, 'loss_val': 0.5935488572528117, 'psi': 0.5704856812069545}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:44915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:44905
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:44910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:44916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S9] → sending delta(kind=head bytes=1790) to S16@127.0.0.1:44916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:44902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:44909
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1804 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1790 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1795) from S15
[S5] cosine check vs S15: cos=0.7269
[S16] RECEIVED delta(kind=head bytes=1790) from S9
[S16] cosine check vs S9: cos=0.3342
[S16] RECEIVED delta(kind=head bytes=1804) from S5
[S16] cosine check vs S5: cos=0.9139
[S8] RECEIVED delta(kind=head bytes=1796) from S14
[S8] cosine check vs S14: cos=0.6372
[S2] RECEIVED delta(kind=head bytes=1801) from S3
[S2] cosine check vs S3: cos=0.9117
[S15] RECEIVED delta(kind=head bytes=1798) from S11
[S15] cosine check vs S11: cos=0.9819
[S9] RECEIVED delta(kind=head bytes=1796) from S8
[S9] cosine check vs S8: cos=0.8765
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=12 metric=0.7018 head_norm=1.146652
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.385797e-01
[S2] stored merged vector for next round verification (round=12)
[S2] DEBUG after merge:  round=12 metric=0.7018 head_norm=1.108644 delta_norm=0.238580
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=12 metric=0.4959 head_norm=0.884316
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.539218e-01
[S8] stored merged vector for next round verification (round=12)
[S8] DEBUG after merge:  round=12 metric=0.4975 head_norm=0.742033 delta_norm=0.353922
[S8] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=12 metric=0.7003 head_norm=1.158184
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.932460e-01
[S5] stored merged vector for next round verification (round=12)
[S5] DEBUG after merge:  round=12 metric=0.7003 head_norm=1.201385 delta_norm=0.493246
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=12 metric=0.7012 head_norm=1.009604
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.430004e-01
[S9] stored merged vector for next round verification (round=12)
[S9] DEBUG after merge:  round=12 metric=0.7012 head_norm=0.917392 delta_norm=0.243000
[S9] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=12 metric=0.7184 head_norm=1.425428
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.699434e-01
[S15] stored merged vector for next round verification (round=12)
[S15] DEBUG after merge:  round=12 metric=0.8211 head_norm=1.509056 delta_norm=0.169943
[S15] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=12 metric=0.3935 head_norm=0.869771
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.932760e-01
[S16] stored merged vector for next round verification (round=12)
[S16] DEBUG after merge:  round=12 metric=0.3836 head_norm=0.802747 delta_norm=0.193276
[S16] aggregate: ROLLBACK (f1_val pre=0.394 post=0.384 tol_abs=0.005 tol_rel=0.0)
[S2] START round=13 head_norm_before_train=1.108644 cos_to_last_merge=1.0000 (last merge round=12)
[S2] round=13 local utility u=0.004808 metrics={'f1_val': 0.7015710590385817, 'auprc': 0.6745115765976649, 'loss_val': 0.3717353592197062, 'psi': 0.6907472660622149}-{'f1_val': 0.7018318238212289, 'auprc': 0.6868455611498997, 'loss_val': 0.41991840632291727, 'psi': 0.6958373187526972}
[S3] START round=13 head_norm_before_train=1.121255 cos_to_last_merge=0.9939 (last merge round=11)
[S3] round=13 local utility u=0.061253 metrics={'f1_val': 0.7006060025002057, 'auprc': 0.9983797740561919, 'loss_val': 0.23619801875659618, 'psi': 0.8197155111226002}-{'f1_val': 0.7006060025002057, 'auprc': 0.9986328999485674, 'loss_val': 0.3594635608213003, 'psi': 0.8198167614795504}
[S4] START round=13 head_norm_before_train=1.652236 (no previous merge yet)
[S4] round=13 local utility u=0.164144 metrics={'f1_val': 0.6656917718265924, 'auprc': 0.9438701110928769, 'loss_val': 0.420313751170481, 'psi': 0.7769631075331063}-{'f1_val': 0.6515996631627723, 'auprc': 0.8905405915166202, 'loss_val': 0.5040604881112446, 'psi': 0.7471760345043115}
[S5] START round=13 head_norm_before_train=1.201385 cos_to_last_merge=1.0000 (last merge round=12)
[S5] round=13 local utility u=0.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9932345783435008, 'loss_val': 0.40370051224892717, 'psi': 0.8174861904322157}-{'f1_val': 0.700320598491359, 'auprc': 0.9921616511333902, 'loss_val': 0.3869724503648258, 'psi': 0.8170570195481714}
[S6] START round=13 head_norm_before_train=1.217640 cos_to_last_merge=0.8752 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.875
[S6] round=13 local utility u=0.131246 metrics={'f1_val': 0.7093639451143628, 'auprc': 0.8093501998087701, 'loss_val': 0.45409570360692975, 'psi': 0.7493584469921257}-{'f1_val': 0.6940654827024352, 'auprc': 0.7887585711002628, 'loss_val': 0.5630218026443073, 'psi': 0.7319427180615663}
[S7] START round=13 head_norm_before_train=1.335018 cos_to_last_merge=0.8808 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.881
[S7] round=13 local utility u=0.823897 metrics={'f1_val': 0.6172426414782564, 'auprc': 0.77918274380715, 'loss_val': 0.686213548336177, 'psi': 0.6820186824098138}-{'f1_val': 0.4237024885955324, 'auprc': 0.7032897959477826, 'loss_val': 0.9450872077809533, 'psi': 0.5355374115364324}
[S8] START round=13 head_norm_before_train=0.742033 cos_to_last_merge=1.0000 (last merge round=12)
[S8] round=13 local utility u=0.000000 metrics={'f1_val': 0.3873896619561635, 'auprc': 0.9947574664196305, 'loss_val': 0.6802448760559027, 'psi': 0.6303367837415503}-{'f1_val': 0.4958757247545934, 'auprc': 0.9958163767075483, 'loss_val': 0.6656780050961332, 'psi': 0.6958519855357754}
[S9] START round=13 head_norm_before_train=0.917392 cos_to_last_merge=1.0000 (last merge round=12)
[S9] round=13 local utility u=0.882302 metrics={'f1_val': 0.9912340248079128, 'auprc': 0.9966554937035288, 'loss_val': 0.19517612307437968, 'psi': 0.9934026123661591}-{'f1_val': 0.7012165807733519, 'auprc': 0.9979970435668734, 'loss_val': 0.22370020011205125, 'psi': 0.8199287658907605}
[S10] START round=13 head_norm_before_train=1.060900 cos_to_last_merge=0.9957 (last merge round=11)
[S10] round=13 local utility u=0.161700 metrics={'f1_val': 0.6996640466857562, 'auprc': 0.9939392033129566, 'loss_val': 0.45902228654741906, 'psi': 0.8173741093366365}-{'f1_val': 0.7001085408329333, 'auprc': 0.9348794312926655, 'loss_val': 0.6079105946252872, 'psi': 0.7940168970168262}
[S11] START round=13 head_norm_before_train=1.606368 cos_to_last_merge=0.9990 (last merge round=11)
[S11] round=13 local utility u=0.808759 metrics={'f1_val': 0.9544868368168811, 'auprc': 0.9986736446607175, 'loss_val': 0.2921840416358288, 'psi': 0.9721615599544157}-{'f1_val': 0.7019353166316534, 'auprc': 0.9984329614203146, 'loss_val': 0.39367149901419946, 'psi': 0.8205343745471179}
[S13] START round=13 head_norm_before_train=1.308768 cos_to_last_merge=0.8741 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.874
[S13] round=13 local utility u=0.011340 metrics={'f1_val': 0.6377757384914333, 'auprc': 0.6609871391781434, 'loss_val': 0.5886520646743398, 'psi': 0.6470602987661174}-{'f1_val': 0.6020983915218272, 'auprc': 0.7405335344320246, 'loss_val': 0.63590641231465, 'psi': 0.6574724486859062}
[S14] START round=13 head_norm_before_train=0.754807 cos_to_last_merge=0.9925 (last merge round=11)
[S14] round=13 local utility u=0.000000 metrics={'f1_val': 0.7061822265447593, 'auprc': 0.9957210951848324, 'loss_val': 0.5363435274489268, 'psi': 0.8219977740007886}-{'f1_val': 0.9936569488964806, 'auprc': 0.9971312390466065, 'loss_val': 0.6652758185546165, 'psi': 0.995046664956531}
[S15] START round=13 head_norm_before_train=1.509056 cos_to_last_merge=1.0000 (last merge round=12)
[S15] round=13 local utility u=0.000000 metrics={'f1_val': 0.6918464428678572, 'auprc': 0.9865829967888418, 'loss_val': 0.4515338407095951, 'psi': 0.809741064436251}-{'f1_val': 0.7184467533205364, 'auprc': 0.9865554895348833, 'loss_val': 0.5264884690286962, 'psi': 0.8256902478062751}
[S16] START round=13 head_norm_before_train=0.802747 cos_to_last_merge=1.0000 (last merge round=12)
[S16] round=13 local utility u=0.305086 metrics={'f1_val': 0.43472347589521065, 'auprc': 0.7766468679726707, 'loss_val': 0.8581592357509356, 'psi': 0.5714928327261947}-{'f1_val': 0.39352732777747373, 'auprc': 0.6924618657400916, 'loss_val': 0.9685985828585086, 'psi': 0.5131011429625209}
[S17] START round=13 head_norm_before_train=1.528634 (no previous merge yet)
[S17] round=13 local utility u=0.364988 metrics={'f1_val': 0.46020106946705364, 'auprc': 0.8299458457187774, 'loss_val': 0.5565439580385275, 'psi': 0.6080989799677432}-{'f1_val': 0.39367469728429044, 'auprc': 0.7453097414025089, 'loss_val': 0.6334524445925164, 'psi': 0.5343287149315779}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:44910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:44912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:44915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:44902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:44909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:44903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:44915
[S3] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1795 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1799) from S11
[S15] cosine check vs S11: cos=0.9916
[S9] RECEIVED delta(kind=head bytes=1801) from S10
[S9] cosine check vs S10: cos=0.0340
[S8] RECEIVED delta(kind=head bytes=1795) from S6
[S8] cosine check vs S6: cos=0.7219
[S11] RECEIVED delta(kind=head bytes=1796) from S4
[S11] cosine check vs S4: cos=0.9853
[S15] RECEIVED delta(kind=head bytes=1797) from S2
[S15] cosine check vs S2: cos=-0.0337
[S15] DROPPED delta from S2 (cos=-0.0337 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1797) from S3
[S2] cosine check vs S3: cos=0.9679
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:44911
[S13] sending update (kind=head size=1799 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1799) from S13
[S10] cosine check vs S13: cos=0.8596
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:44914
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:44916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:44903
[S16] sending update (kind=head size=1798 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1798) from S16
[S14] cosine check vs S16: cos=0.7780
[S9] sending update (kind=head size=1798 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1798) from S9
[S16] cosine check vs S9: cos=0.5013
[S17] sending update (kind=head size=1799 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1799) from S17
[S3] cosine check vs S17: cos=0.7419
[S7] sending update (kind=head size=1801 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1801) from S7
[S3] cosine check vs S7: cos=0.5820
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=13 metric=0.7006 head_norm=1.188176
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.071057e-01
[S3] stored merged vector for next round verification (round=13)
[S3] DEBUG after merge:  round=13 metric=0.7006 head_norm=1.092786 delta_norm=0.207106
[S3] aggregate: ACCEPT kept=['S17', 'S7'] (k=2/2) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=13 metric=0.6997 head_norm=1.113238
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.438208e-01
[S10] stored merged vector for next round verification (round=13)
[S10] DEBUG after merge:  round=13 metric=0.6997 head_norm=1.184780 delta_norm=0.343821
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=13 metric=0.9545 head_norm=1.646087
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.435211e-01
[S11] stored merged vector for next round verification (round=13)
[S11] DEBUG after merge:  round=13 metric=0.9554 head_norm=1.656051 delta_norm=0.143521
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=13 metric=0.3874 head_norm=0.789363
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.411379e-01
[S8] stored merged vector for next round verification (round=13)
[S8] DEBUG after merge:  round=13 metric=0.4064 head_norm=0.956093 delta_norm=0.441138
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=13 metric=0.6918 head_norm=1.537096
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.164880e-01
[S15] stored merged vector for next round verification (round=13)
[S15] DEBUG after merge:  round=13 metric=0.7633 head_norm=1.588258 delta_norm=0.116488
[S15] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=13 metric=0.7062 head_norm=0.807215
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.756961e-01
[S14] stored merged vector for next round verification (round=13)
[S14] DEBUG after merge:  round=13 metric=0.9845 head_norm=0.778669 delta_norm=0.275696
[S14] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=13 metric=0.9912 head_norm=0.997697
[S9] _apply_head_vector_avg (torch): Δ‖w‖=7.347233e-01
[S9] stored merged vector for next round verification (round=13)
[S9] DEBUG after merge:  round=13 metric=0.9214 head_norm=0.759954 delta_norm=0.734723
[S9] aggregate: ROLLBACK (f1_val pre=0.991 post=0.921 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=13 metric=0.4347 head_norm=0.844436
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.646788e-01
[S16] stored merged vector for next round verification (round=13)
[S16] DEBUG after merge:  round=13 metric=0.5242 head_norm=0.798943 delta_norm=0.464679
[S16] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=13 metric=0.7016 head_norm=1.162333
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.494243e-01
[S2] stored merged vector for next round verification (round=13)
[S2] DEBUG after merge:  round=13 metric=0.7016 head_norm=1.165789 delta_norm=0.149424
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.165789 cos_to_last_merge=1.0000 (last merge round=13)
[S2] round=14 local utility u=0.054484 metrics={'f1_val': 0.7015710590385817, 'auprc': 0.7031203927151257, 'loss_val': 0.3485931918457807, 'psi': 0.7021907925091992}-{'f1_val': 0.7015710590385817, 'auprc': 0.6745115765976649, 'loss_val': 0.3717353592197062, 'psi': 0.6907472660622149}
[S3] START round=14 head_norm_before_train=1.092786 cos_to_last_merge=1.0000 (last merge round=13)
[S3] round=14 local utility u=0.892131 metrics={'f1_val': 0.9971122502560278, 'auprc': 0.998857682188554, 'loss_val': 0.23240799201122433, 'psi': 0.9978104230290383}-{'f1_val': 0.7006060025002057, 'auprc': 0.9983797740561919, 'loss_val': 0.23619801875659618, 'psi': 0.8197155111226002}
[S4] START round=14 head_norm_before_train=1.678275 (no previous merge yet)
[S4] round=14 local utility u=0.000000 metrics={'f1_val': 0.6520595826464126, 'auprc': 0.891726149445748, 'loss_val': 0.5075893037407165, 'psi': 0.7479262093661467}-{'f1_val': 0.6656917718265924, 'auprc': 0.9438701110928769, 'loss_val': 0.420313751170481, 'psi': 0.7769631075331063}
[S5] START round=14 head_norm_before_train=1.275491 cos_to_last_merge=0.9902 (last merge round=12)
[S5] round=14 local utility u=0.000000 metrics={'f1_val': 0.7082306688571478, 'auprc': 0.789222546847536, 'loss_val': 0.42790903932610136, 'psi': 0.7406274200533032}-{'f1_val': 0.700320598491359, 'auprc': 0.9932345783435008, 'loss_val': 0.40370051224892717, 'psi': 0.8174861904322157}
[S6] START round=14 head_norm_before_train=1.262671 cos_to_last_merge=0.8612 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.861
[S6] round=14 local utility u=0.257963 metrics={'f1_val': 0.7036066738014497, 'auprc': 0.9627263432759632, 'loss_val': 0.3637548226604724, 'psi': 0.8072545415912551}-{'f1_val': 0.7093639451143628, 'auprc': 0.8093501998087701, 'loss_val': 0.45409570360692975, 'psi': 0.7493584469921257}
[S7] START round=14 head_norm_before_train=1.354519 cos_to_last_merge=0.8769 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.877
[S7] round=14 local utility u=0.078658 metrics={'f1_val': 0.6308512103350457, 'auprc': 0.7851471814710855, 'loss_val': 0.6284414040622381, 'psi': 0.6925695987894616}-{'f1_val': 0.6172426414782564, 'auprc': 0.77918274380715, 'loss_val': 0.686213548336177, 'psi': 0.6820186824098138}
[S8] START round=14 head_norm_before_train=0.956093 cos_to_last_merge=1.0000 (last merge round=13)
[S8] round=14 local utility u=0.000000 metrics={'f1_val': 0.3725978128855645, 'auprc': 0.9901324784215731, 'loss_val': 0.697083781229131, 'psi': 0.619611679099968}-{'f1_val': 0.3873896619561635, 'auprc': 0.9947574664196305, 'loss_val': 0.6802448760559027, 'psi': 0.6303367837415503}
[S9] START round=14 head_norm_before_train=0.759954 cos_to_last_merge=1.0000 (last merge round=13)
[S9] round=14 local utility u=0.000000 metrics={'f1_val': 0.9916545251190211, 'auprc': 0.9980263836370217, 'loss_val': 0.3053736046586704, 'psi': 0.9942032685262213}-{'f1_val': 0.9912340248079128, 'auprc': 0.9966554937035288, 'loss_val': 0.19517612307437968, 'psi': 0.9934026123661591}
[S10] START round=14 head_norm_before_train=1.184780 cos_to_last_merge=1.0000 (last merge round=13)
[S10] round=14 local utility u=0.000000 metrics={'f1_val': 0.6998387566314846, 'auprc': 0.9937156506501343, 'loss_val': 0.4693237805256481, 'psi': 0.8173895142389445}-{'f1_val': 0.6996640466857562, 'auprc': 0.9939392033129566, 'loss_val': 0.45902228654741906, 'psi': 0.8173741093366365}
[S11] START round=14 head_norm_before_train=1.656051 cos_to_last_merge=1.0000 (last merge round=13)
[S11] round=14 local utility u=0.159935 metrics={'f1_val': 0.9977924134809988, 'auprc': 0.9985182734598097, 'loss_val': 0.23168055367397106, 'psi': 0.9980827574725232}-{'f1_val': 0.9544868368168811, 'auprc': 0.9986736446607175, 'loss_val': 0.2921840416358288, 'psi': 0.9721615599544157}
[S13] START round=14 head_norm_before_train=1.343329 cos_to_last_merge=0.8651 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.865
[S13] round=14 local utility u=0.000000 metrics={'f1_val': 0.5532892959493866, 'auprc': 0.710078356786976, 'loss_val': 0.7258973492007819, 'psi': 0.6160049202844223}-{'f1_val': 0.6377757384914333, 'auprc': 0.6609871391781434, 'loss_val': 0.5886520646743398, 'psi': 0.6470602987661174}
[S14] START round=14 head_norm_before_train=0.778669 cos_to_last_merge=1.0000 (last merge round=13)
[S14] round=14 local utility u=0.684478 metrics={'f1_val': 0.938334773905923, 'auprc': 0.9988513880126544, 'loss_val': 0.5696928349686549, 'psi': 0.9625414195486155}-{'f1_val': 0.7061822265447593, 'auprc': 0.9957210951848324, 'loss_val': 0.5363435274489268, 'psi': 0.8219977740007886}
[S15] START round=14 head_norm_before_train=1.588258 cos_to_last_merge=1.0000 (last merge round=13)
[S15] round=14 local utility u=0.268382 metrics={'f1_val': 0.7670264356410001, 'auprc': 0.986923942314727, 'loss_val': 0.3668721499016052, 'psi': 0.8549854383104909}-{'f1_val': 0.6918464428678572, 'auprc': 0.9865829967888418, 'loss_val': 0.4515338407095951, 'psi': 0.809741064436251}
[S16] START round=14 head_norm_before_train=0.798943 cos_to_last_merge=1.0000 (last merge round=13)
[S16] round=14 local utility u=0.137340 metrics={'f1_val': 0.4743665578465118, 'auprc': 0.7919807894336527, 'loss_val': 0.8673390537552894, 'psi': 0.6014122504813681}-{'f1_val': 0.43472347589521065, 'auprc': 0.7766468679726707, 'loss_val': 0.8581592357509356, 'psi': 0.5714928327261947}
[S17] START round=14 head_norm_before_train=1.549481 (no previous merge yet)
[S17] round=14 local utility u=0.171648 metrics={'f1_val': 0.5229411282645213, 'auprc': 0.8194163928097308, 'loss_val': 0.5581001846443726, 'psi': 0.6415312340826052}-{'f1_val': 0.46020106946705364, 'auprc': 0.8299458457187774, 'loss_val': 0.5565439580385275, 'psi': 0.6080989799677432}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:44915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:44905
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:44915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:44909
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:44903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:44902
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:44914
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:44909
[S15] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1794 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1794) from S16
[S14] cosine check vs S16: cos=0.8906
[S15] RECEIVED delta(kind=head bytes=1799) from S11
[S15] cosine check vs S11: cos=0.9917
[S8] RECEIVED delta(kind=head bytes=1797) from S14
[S8] cosine check vs S14: cos=0.5435
[S8] RECEIVED delta(kind=head bytes=1801) from S6
[S8] cosine check vs S6: cos=0.9485
[S15] RECEIVED delta(kind=head bytes=1802) from S2
[S15] cosine check vs S2: cos=-0.0406
[S15] DROPPED delta from S2 (cos=-0.0406 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1799) from S3
[S2] cosine check vs S3: cos=0.9754
[S5] RECEIVED delta(kind=head bytes=1801) from S15
[S5] cosine check vs S15: cos=0.8344
[S3] RECEIVED delta(kind=head bytes=1801) from S7
[S3] cosine check vs S7: cos=0.6142
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:44903
[S17] sending update (kind=head size=1801 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1801) from S17
[S3] cosine check vs S17: cos=0.7468
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=14 metric=0.7082 head_norm=1.361555
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.449758e-01
[S5] stored merged vector for next round verification (round=14)
[S5] DEBUG after merge:  round=14 metric=0.7037 head_norm=1.425427 delta_norm=0.444976
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=14 metric=0.3726 head_norm=0.992940
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.367455e-01
[S8] stored merged vector for next round verification (round=14)
[S8] DEBUG after merge:  round=14 metric=0.3726 head_norm=0.923995 delta_norm=0.136745
[S8] aggregate: ACCEPT kept=['S14', 'S6'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=14 metric=0.7670 head_norm=1.614268
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.130576e-01
[S15] stored merged vector for next round verification (round=14)
[S15] DEBUG after merge:  round=14 metric=0.7958 head_norm=1.649465 delta_norm=0.113058
[S15] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=14 metric=0.7016 head_norm=1.214085
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.347909e-01
[S2] stored merged vector for next round verification (round=14)
[S2] DEBUG after merge:  round=14 metric=0.7016 head_norm=1.175707 delta_norm=0.134791
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=14 metric=0.9383 head_norm=0.819772
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.943241e-01
[S14] stored merged vector for next round verification (round=14)
[S14] DEBUG after merge:  round=14 metric=0.9971 head_norm=0.806749 delta_norm=0.194324
[S14] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=14 metric=0.9971 head_norm=1.151916
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.508228e-01
[S3] stored merged vector for next round verification (round=14)
[S3] DEBUG after merge:  round=14 metric=0.9942 head_norm=1.088998 delta_norm=0.150823
[S3] aggregate: ACCEPT kept=['S7', 'S17'] (k=2/2) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.175707 cos_to_last_merge=1.0000 (last merge round=14)
[S2] round=15 local utility u=0.050611 metrics={'f1_val': 0.7018318238212289, 'auprc': 0.7345901296921551, 'loss_val': 0.343345103708568, 'psi': 0.7149351461695994}-{'f1_val': 0.7015710590385817, 'auprc': 0.7031203927151257, 'loss_val': 0.3485931918457807, 'psi': 0.7021907925091992}
[S3] START round=15 head_norm_before_train=1.088998 cos_to_last_merge=1.0000 (last merge round=14)
[S3] round=15 local utility u=0.000000 metrics={'f1_val': 0.9715229121240536, 'auprc': 0.9995018606202721, 'loss_val': 0.23895125332408684, 'psi': 0.982714491522541}-{'f1_val': 0.9971122502560278, 'auprc': 0.998857682188554, 'loss_val': 0.23240799201122433, 'psi': 0.9978104230290383}
[S4] START round=15 head_norm_before_train=1.701729 (no previous merge yet)
[S4] round=15 local utility u=1.000000 metrics={'f1_val': 0.9437674888680561, 'auprc': 0.9486564151764766, 'loss_val': 0.40881257155432166, 'psi': 0.9457230593914243}-{'f1_val': 0.6520595826464126, 'auprc': 0.891726149445748, 'loss_val': 0.5075893037407165, 'psi': 0.7479262093661467}
[S5] START round=15 head_norm_before_train=1.425427 cos_to_last_merge=1.0000 (last merge round=14)
[S5] round=15 local utility u=0.316978 metrics={'f1_val': 0.7000725525005456, 'auprc': 0.987102173084523, 'loss_val': 0.33864280593793694, 'psi': 0.8148844007341365}-{'f1_val': 0.7082306688571478, 'auprc': 0.789222546847536, 'loss_val': 0.42790903932610136, 'psi': 0.7406274200533032}
[S6] START round=15 head_norm_before_train=1.303536 cos_to_last_merge=0.8485 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.849
[S6] round=15 local utility u=0.000000 metrics={'f1_val': 0.700215947969351, 'auprc': 0.8025272828706875, 'loss_val': 0.44270811863902954, 'psi': 0.7411404819298857}-{'f1_val': 0.7036066738014497, 'auprc': 0.9627263432759632, 'loss_val': 0.3637548226604724, 'psi': 0.8072545415912551}
[S7] START round=15 head_norm_before_train=1.374821 cos_to_last_merge=0.8735 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.874
[S7] round=15 local utility u=0.123017 metrics={'f1_val': 0.6505923385648748, 'auprc': 0.7998388049996574, 'loss_val': 0.5449295093543803, 'psi': 0.7102909251387879}-{'f1_val': 0.6308512103350457, 'auprc': 0.7851471814710855, 'loss_val': 0.6284414040622381, 'psi': 0.6925695987894616}
[S8] START round=15 head_norm_before_train=0.923995 cos_to_last_merge=1.0000 (last merge round=14)
[S8] round=15 local utility u=0.051449 metrics={'f1_val': 0.37266438550987346, 'auprc': 0.9929060315020711, 'loss_val': 0.6029058371267461, 'psi': 0.6207610439067526}-{'f1_val': 0.3725978128855645, 'auprc': 0.9901324784215731, 'loss_val': 0.697083781229131, 'psi': 0.619611679099968}
[S9] START round=15 head_norm_before_train=0.847875 cos_to_last_merge=0.9861 (last merge round=13)
[S9] round=15 local utility u=0.079823 metrics={'f1_val': 0.9954208167290715, 'auprc': 0.9980211934818821, 'loss_val': 0.16830945570703235, 'psi': 0.9964609674301957}-{'f1_val': 0.9916545251190211, 'auprc': 0.9980263836370217, 'loss_val': 0.3053736046586704, 'psi': 0.9942032685262213}
[S10] START round=15 head_norm_before_train=1.226284 cos_to_last_merge=0.9960 (last merge round=13)
[S10] round=15 local utility u=0.060121 metrics={'f1_val': 0.700188205774084, 'auprc': 0.996727805967244, 'loss_val': 0.36021491124021415, 'psi': 0.818804045851348}-{'f1_val': 0.6998387566314846, 'auprc': 0.9937156506501343, 'loss_val': 0.4693237805256481, 'psi': 0.8173895142389445}
[S11] START round=15 head_norm_before_train=1.691501 cos_to_last_merge=0.9995 (last merge round=13)
[S11] round=15 local utility u=0.000000 metrics={'f1_val': 0.9592476750912324, 'auprc': 0.9990032507272343, 'loss_val': 0.1911375793089601, 'psi': 0.9751499053456332}-{'f1_val': 0.9977924134809988, 'auprc': 0.9985182734598097, 'loss_val': 0.23168055367397106, 'psi': 0.9980827574725232}
[S13] START round=15 head_norm_before_train=1.371464 cos_to_last_merge=0.8581 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.858
[S13] round=15 local utility u=0.007850 metrics={'f1_val': 0.5658097130027016, 'auprc': 0.6857383674311732, 'loss_val': 0.7122990063328892, 'psi': 0.6137811747740902}-{'f1_val': 0.5532892959493866, 'auprc': 0.710078356786976, 'loss_val': 0.7258973492007819, 'psi': 0.6160049202844223}
[S14] START round=15 head_norm_before_train=0.806749 cos_to_last_merge=1.0000 (last merge round=14)
[S14] round=15 local utility u=0.193973 metrics={'f1_val': 0.9975994502496334, 'auprc': 0.997060140810097, 'loss_val': 0.5319602835330697, 'psi': 0.9973837264738188}-{'f1_val': 0.938334773905923, 'auprc': 0.9988513880126544, 'loss_val': 0.5696928349686549, 'psi': 0.9625414195486155}
[S15] START round=15 head_norm_before_train=1.649465 cos_to_last_merge=1.0000 (last merge round=14)
[S15] round=15 local utility u=0.000000 metrics={'f1_val': 0.6926749861842163, 'auprc': 0.9478419443252457, 'loss_val': 0.4340212666596152, 'psi': 0.794741769440628}-{'f1_val': 0.7670264356410001, 'auprc': 0.986923942314727, 'loss_val': 0.3668721499016052, 'psi': 0.8549854383104909}
[S16] START round=15 head_norm_before_train=0.839753 cos_to_last_merge=0.9964 (last merge round=13)
[S16] round=15 local utility u=0.482711 metrics={'f1_val': 0.5902991246226463, 'auprc': 0.8432733456122588, 'loss_val': 0.7513900020080276, 'psi': 0.6914888130184913}-{'f1_val': 0.4743665578465118, 'auprc': 0.7919807894336527, 'loss_val': 0.8673390537552894, 'psi': 0.6014122504813681}
[S17] START round=15 head_norm_before_train=1.573687 (no previous merge yet)
[S17] round=15 local utility u=0.738112 metrics={'f1_val': 0.7677673144186354, 'auprc': 0.813912413517502, 'loss_val': 0.534321250685599, 'psi': 0.7862253540581821}-{'f1_val': 0.5229411282645213, 'auprc': 0.8194163928097308, 'loss_val': 0.5581001846443726, 'psi': 0.6415312340826052}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:44916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:44910
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S14] → sending delta(kind=head bytes=1790) to S8@127.0.0.1:44909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:44915
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S9@127.0.0.1:44910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:44914
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:44911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:44916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:44903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S4] → sending delta(kind=head bytes=1806) to S11@127.0.0.1:44912
[S10] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1793 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1790 to 1 peers)
[S4] sending update (kind=head size=1806 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1804 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S16] sending update (kind=head size=1795 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1793) from S8
[S9] cosine check vs S8: cos=0.6513
[S9] RECEIVED delta(kind=head bytes=1801) from S10
[S9] cosine check vs S10: cos=0.5964
[S3] RECEIVED delta(kind=head bytes=1802) from S7
[S3] cosine check vs S7: cos=0.6248
[S14] RECEIVED delta(kind=head bytes=1795) from S16
[S14] cosine check vs S16: cos=0.9581
[S16] RECEIVED delta(kind=head bytes=1804) from S5
[S16] cosine check vs S5: cos=0.3736
[S16] RECEIVED delta(kind=head bytes=1797) from S9
[S16] cosine check vs S9: cos=0.6940
[S11] RECEIVED delta(kind=head bytes=1806) from S4
[S11] cosine check vs S4: cos=0.9886
[S15] RECEIVED delta(kind=head bytes=1802) from S2
[S15] cosine check vs S2: cos=-0.0466
[S15] DROPPED delta from S2 (cos=-0.0466 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1802) from S13
[S10] cosine check vs S13: cos=0.9210
[S8] RECEIVED delta(kind=head bytes=1790) from S14
[S8] cosine check vs S14: cos=0.7441
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:44903
[S17] sending update (kind=head size=1801 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1801) from S17
[S3] cosine check vs S17: cos=0.7472
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=15 metric=0.9592 head_norm=1.722542
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.298551e-01
[S11] stored merged vector for next round verification (round=15)
[S11] DEBUG after merge:  round=15 metric=0.9600 head_norm=1.716312 delta_norm=0.129855
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.317 → S15@127.0.0.1:44915
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=15 metric=0.9715 head_norm=1.151430
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.298983e-01
[S3] stored merged vector for next round verification (round=15)
[S3] DEBUG after merge:  round=15 metric=0.9615 head_norm=1.098184 delta_norm=0.129898
[S3] aggregate: ROLLBACK (f1_val pre=0.972 post=0.961 tol_abs=0.005 tol_rel=0.0)
[S3] ⇄ pheromone p=0.255 → S2@127.0.0.1:44902
[S6] ⇄ pheromone p=0.232 → S8@127.0.0.1:44909
[S13] ⇄ pheromone p=0.133 → S10@127.0.0.1:44911
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=15 metric=0.9976 head_norm=0.849591
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.264872e-01
[S14] stored merged vector for next round verification (round=15)
[S14] DEBUG after merge:  round=15 metric=0.9919 head_norm=0.857469 delta_norm=0.126487
[S14] aggregate: ROLLBACK (f1_val pre=0.998 post=0.992 tol_abs=0.005 tol_rel=0.0)
[S14] ⇄ pheromone p=0.367 → S8@127.0.0.1:44909
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=15 metric=0.7002 head_norm=1.274712
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.710534e-01
[S10] stored merged vector for next round verification (round=15)
[S10] DEBUG after merge:  round=15 metric=0.6997 head_norm=1.306678 delta_norm=0.271053
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.148 → S9@127.0.0.1:44910
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=15 metric=0.3727 head_norm=0.959578
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.276137e-01
[S8] stored merged vector for next round verification (round=15)
[S8] DEBUG after merge:  round=15 metric=0.3727 head_norm=0.844966 delta_norm=0.327614
[S8] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.183 → S9@127.0.0.1:44910
[S2] ⇄ pheromone p=0.158 → S15@127.0.0.1:44915
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=15 metric=0.5903 head_norm=0.883571
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.388760e-01
[S16] stored merged vector for next round verification (round=15)
[S16] DEBUG after merge:  round=15 metric=0.5691 head_norm=0.809774 delta_norm=0.338876
[S16] aggregate: ROLLBACK (f1_val pre=0.590 post=0.569 tol_abs=0.005 tol_rel=0.0)
[S16] ⇄ pheromone p=0.249 → S14@127.0.0.1:44914
[S7] ⇄ pheromone p=0.279 → S3@127.0.0.1:44903
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=15 metric=0.9954 head_norm=0.967944
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.456742e-01
[S9] stored merged vector for next round verification (round=15)
[S9] DEBUG after merge:  round=15 metric=0.9950 head_norm=0.854850 delta_norm=0.245674
[S9] aggregate: ACCEPT kept=['S8', 'S10'] (k=2/2) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.212 → S16@127.0.0.1:44916
[S4] ⇄ pheromone p=0.332 → S11@127.0.0.1:44912
[S5] ⇄ pheromone p=0.188 → S16@127.0.0.1:44916
[S15] ⇄ pheromone p=0.215 → S5@127.0.0.1:44905
[S17] ⇄ pheromone p=0.324 → S3@127.0.0.1:44903
[S2] START round=16 head_norm_before_train=1.221907 cos_to_last_merge=0.9980 (last merge round=14)
[S2] round=16 local utility u=0.000000 metrics={'f1_val': 0.6420215115253052, 'auprc': 0.7748941941948457, 'loss_val': 0.5445338011466353, 'psi': 0.6951705845931214}-{'f1_val': 0.7018318238212289, 'auprc': 0.7345901296921551, 'loss_val': 0.343345103708568, 'psi': 0.7149351461695994}
[S3] START round=16 head_norm_before_train=1.098184 cos_to_last_merge=1.0000 (last merge round=15)
[S3] round=16 local utility u=0.000000 metrics={'f1_val': 0.9615385219550141, 'auprc': 0.9994931562116997, 'loss_val': 0.25582855796767107, 'psi': 0.9767203756576883}-{'f1_val': 0.9715229121240536, 'auprc': 0.9995018606202721, 'loss_val': 0.23895125332408684, 'psi': 0.982714491522541}
[S4] START round=16 head_norm_before_train=1.719892 (no previous merge yet)
[S4] round=16 local utility u=0.019507 metrics={'f1_val': 0.9430052998893601, 'auprc': 0.9516086094889862, 'loss_val': 0.3740813400277016, 'psi': 0.9464466237292106}-{'f1_val': 0.9437674888680561, 'auprc': 0.9486564151764766, 'loss_val': 0.40881257155432166, 'psi': 0.9457230593914243}
[S5] START round=16 head_norm_before_train=1.479002 cos_to_last_merge=0.9960 (last merge round=14)
[S5] round=16 local utility u=0.058116 metrics={'f1_val': 0.7000725525005456, 'auprc': 0.9931879732355984, 'loss_val': 0.2406680038474022, 'psi': 0.8173187207945667}-{'f1_val': 0.7000725525005456, 'auprc': 0.987102173084523, 'loss_val': 0.33864280593793694, 'psi': 0.8148844007341365}
[S6] START round=16 head_norm_before_train=1.335482 cos_to_last_merge=0.8385 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.838
[S6] round=16 local utility u=0.644044 metrics={'f1_val': 0.8123007363316369, 'auprc': 0.9606155607898649, 'loss_val': 0.3013932156508315, 'psi': 0.8716266661149281}-{'f1_val': 0.700215947969351, 'auprc': 0.8025272828706875, 'loss_val': 0.44270811863902954, 'psi': 0.7411404819298857}
[S7] START round=16 head_norm_before_train=1.394444 cos_to_last_merge=0.8718 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.872
[S7] round=16 local utility u=0.000000 metrics={'f1_val': 0.5197557104551349, 'auprc': 0.7802029794482102, 'loss_val': 0.8110719385121703, 'psi': 0.623934618052365}-{'f1_val': 0.6505923385648748, 'auprc': 0.7998388049996574, 'loss_val': 0.5449295093543803, 'psi': 0.7102909251387879}
[S8] START round=16 head_norm_before_train=0.844966 cos_to_last_merge=1.0000 (last merge round=15)
[S8] round=16 local utility u=0.853744 metrics={'f1_val': 0.6553452627147397, 'auprc': 0.9961583544464141, 'loss_val': 0.601259732942751, 'psi': 0.7916704994074095}-{'f1_val': 0.37266438550987346, 'auprc': 0.9929060315020711, 'loss_val': 0.6029058371267461, 'psi': 0.6207610439067526}
[S9] START round=16 head_norm_before_train=0.854850 cos_to_last_merge=1.0000 (last merge round=15)
[S9] round=16 local utility u=0.000000 metrics={'f1_val': 0.9949999422209534, 'auprc': 0.9980163346773171, 'loss_val': 0.17884115221212912, 'psi': 0.9962064992034989}-{'f1_val': 0.9954208167290715, 'auprc': 0.9980211934818821, 'loss_val': 0.16830945570703235, 'psi': 0.9964609674301957}
[S10] START round=16 head_norm_before_train=1.306678 cos_to_last_merge=1.0000 (last merge round=15)
[S10] round=16 local utility u=0.733485 metrics={'f1_val': 0.9557968298442056, 'auprc': 0.988867004249999, 'loss_val': 0.4033139858793955, 'psi': 0.9690248996065229}-{'f1_val': 0.700188205774084, 'auprc': 0.996727805967244, 'loss_val': 0.36021491124021415, 'psi': 0.818804045851348}
[S11] START round=16 head_norm_before_train=1.716312 cos_to_last_merge=1.0000 (last merge round=15)
[S11] round=16 local utility u=0.136818 metrics={'f1_val': 0.9973780864376928, 'auprc': 0.9988575139626393, 'loss_val': 0.14584695099109599, 'psi': 0.9979698574476714}-{'f1_val': 0.9592476750912324, 'auprc': 0.9990032507272343, 'loss_val': 0.1911375793089601, 'psi': 0.9751499053456332}
[S13] START round=16 head_norm_before_train=1.391713 cos_to_last_merge=0.8528 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.853
[S13] round=16 local utility u=0.088602 metrics={'f1_val': 0.6016096790137392, 'auprc': 0.6468031402028016, 'loss_val': 0.6330897531887777, 'psi': 0.6196870634893642}-{'f1_val': 0.5658097130027016, 'auprc': 0.6857383674311732, 'loss_val': 0.7122990063328892, 'psi': 0.6137811747740902}
[S14] START round=16 head_norm_before_train=0.857469 cos_to_last_merge=1.0000 (last merge round=15)
[S14] round=16 local utility u=0.023806 metrics={'f1_val': 0.9967774409524363, 'auprc': 0.9971546673525333, 'loss_val': 0.47969983609586053, 'psi': 0.9969283315124751}-{'f1_val': 0.9975994502496334, 'auprc': 0.997060140810097, 'loss_val': 0.5319602835330697, 'psi': 0.9973837264738188}
[S15] START round=16 head_norm_before_train=1.674510 cos_to_last_merge=0.9993 (last merge round=14)
[S15] round=16 local utility u=0.358171 metrics={'f1_val': 0.7685792851270971, 'auprc': 0.9852432269434162, 'loss_val': 0.28530842625456515, 'psi': 0.8552448618536247}-{'f1_val': 0.6926749861842163, 'auprc': 0.9478419443252457, 'loss_val': 0.4340212666596152, 'psi': 0.794741769440628}
[S16] START round=16 head_norm_before_train=0.809774 cos_to_last_merge=1.0000 (last merge round=15)
[S16] round=16 local utility u=0.977050 metrics={'f1_val': 0.8741442861022035, 'auprc': 0.8992775631597136, 'loss_val': 0.6683732270322778, 'psi': 0.8841975969252076}-{'f1_val': 0.5902991246226463, 'auprc': 0.8432733456122588, 'loss_val': 0.7513900020080276, 'psi': 0.6914888130184913}
[S17] START round=16 head_norm_before_train=1.598387 (no previous merge yet)
[S17] round=16 local utility u=0.000000 metrics={'f1_val': 0.5776638414609792, 'auprc': 0.7707197598615444, 'loss_val': 0.5854521681691747, 'psi': 0.6548862088212053}-{'f1_val': 0.7677673144186354, 'auprc': 0.813912413517502, 'loss_val': 0.534321250685599, 'psi': 0.7862253540581821}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:44914
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S14] → sending delta(kind=head bytes=1791) to S8@127.0.0.1:44909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:44911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:44905
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:44912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:44909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:44916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:44910
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:44915
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:44910
[S14] sending update (kind=head size=1791 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1799) from S15
[S5] cosine check vs S15: cos=0.9171
[S8] RECEIVED delta(kind=head bytes=1796) from S6
[S8] cosine check vs S6: cos=0.7515
[S14] RECEIVED delta(kind=head bytes=1797) from S16
[S14] cosine check vs S16: cos=0.9068
[S16] RECEIVED delta(kind=head bytes=1798) from S5
[S16] cosine check vs S5: cos=0.6452
[S11] RECEIVED delta(kind=head bytes=1801) from S4
[S11] cosine check vs S4: cos=0.9947
[S15] RECEIVED delta(kind=head bytes=1802) from S11
[S15] cosine check vs S11: cos=0.9896
[S10] RECEIVED delta(kind=head bytes=1797) from S13
[S10] cosine check vs S13: cos=0.9672
[S9] RECEIVED delta(kind=head bytes=1803) from S10
[S9] cosine check vs S10: cos=0.6370
[S8] RECEIVED delta(kind=head bytes=1791) from S14
[S8] cosine check vs S14: cos=0.9380
[S9] RECEIVED delta(kind=head bytes=1797) from S8
[S9] cosine check vs S8: cos=0.6978
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=16 metric=0.9950 head_norm=0.964445
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.199310e-01
[S9] stored merged vector for next round verification (round=16)
[S9] DEBUG after merge:  round=16 metric=0.9950 head_norm=0.870489 delta_norm=0.219931
[S9] aggregate: ACCEPT kept=['S10', 'S8'] (k=2/2) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=16 metric=0.9558 head_norm=1.345107
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.791511e-01
[S10] stored merged vector for next round verification (round=16)
[S10] DEBUG after merge:  round=16 metric=0.9562 head_norm=1.365964 delta_norm=0.179151
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=16 metric=0.9968 head_norm=0.903625
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.914150e-01
[S14] stored merged vector for next round verification (round=16)
[S14] DEBUG after merge:  round=16 metric=0.9964 head_norm=0.859695 delta_norm=0.191415
[S14] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=16 metric=0.8741 head_norm=0.857258
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.898589e-01
[S16] stored merged vector for next round verification (round=16)
[S16] DEBUG after merge:  round=16 metric=0.6159 head_norm=1.093853 delta_norm=0.589859
[S16] aggregate: ROLLBACK (f1_val pre=0.874 post=0.616 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=16 metric=0.7686 head_norm=1.700069
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.256798e-01
[S15] stored merged vector for next round verification (round=16)
[S15] DEBUG after merge:  round=16 metric=0.7746 head_norm=1.716212 delta_norm=0.125680
[S15] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=16 metric=0.6553 head_norm=0.880211
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.637429e-01
[S8] stored merged vector for next round verification (round=16)
[S8] DEBUG after merge:  round=16 metric=0.6551 head_norm=0.922582 delta_norm=0.163743
[S8] aggregate: ACCEPT kept=['S6', 'S14'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=16 metric=0.9974 head_norm=1.741299
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.946805e-02
[S11] stored merged vector for next round verification (round=16)
[S11] DEBUG after merge:  round=16 metric=0.9974 head_norm=1.738140 delta_norm=0.089468
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=16 metric=0.7001 head_norm=1.534276
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.391150e-01
[S5] stored merged vector for next round verification (round=16)
[S5] DEBUG after merge:  round=16 metric=0.7002 head_norm=1.583389 delta_norm=0.339115
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.264964 cos_to_last_merge=0.9935 (last merge round=14)
[S2] round=17 local utility u=0.292942 metrics={'f1_val': 0.7013121503667978, 'auprc': 0.7689347127560187, 'loss_val': 0.29651552751901283, 'psi': 0.7283611753224861}-{'f1_val': 0.6420215115253052, 'auprc': 0.7748941941948457, 'loss_val': 0.5445338011466353, 'psi': 0.6951705845931214}
[S3] START round=17 head_norm_before_train=1.155401 cos_to_last_merge=0.9968 (last merge round=15)
[S3] round=17 local utility u=0.037678 metrics={'f1_val': 0.9612046783862453, 'auprc': 0.9978769760066224, 'loss_val': 0.1736203097826604, 'psi': 0.9758735974343962}-{'f1_val': 0.9615385219550141, 'auprc': 0.9994931562116997, 'loss_val': 0.25582855796767107, 'psi': 0.9767203756576883}
[S4] START round=17 head_norm_before_train=1.739583 (no previous merge yet)
[S4] round=17 local utility u=0.000000 metrics={'f1_val': 0.9366077597025617, 'auprc': 0.9334151492597196, 'loss_val': 0.3659969421932741, 'psi': 0.9353307155254249}-{'f1_val': 0.9430052998893601, 'auprc': 0.9516086094889862, 'loss_val': 0.3740813400277016, 'psi': 0.9464466237292106}
[S5] START round=17 head_norm_before_train=1.583389 cos_to_last_merge=1.0000 (last merge round=16)
[S5] round=17 local utility u=0.885354 metrics={'f1_val': 0.9960398919057053, 'auprc': 0.994567013556384, 'loss_val': 0.24990116812727392, 'psi': 0.9954507405659767}-{'f1_val': 0.7000725525005456, 'auprc': 0.9931879732355984, 'loss_val': 0.2406680038474022, 'psi': 0.8173187207945667}
[S6] START round=17 head_norm_before_train=1.364573 cos_to_last_merge=0.8298 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.830
[S6] round=17 local utility u=0.000000 metrics={'f1_val': 0.7406068284547429, 'auprc': 0.9624050076769486, 'loss_val': 0.27664028520814893, 'psi': 0.8293261001436252}-{'f1_val': 0.8123007363316369, 'auprc': 0.9606155607898649, 'loss_val': 0.3013932156508315, 'psi': 0.8716266661149281}
[S7] START round=17 head_norm_before_train=1.423635 cos_to_last_merge=0.8698 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.870
[S7] round=17 local utility u=0.424992 metrics={'f1_val': 0.62226778013046, 'auprc': 0.7904655746398401, 'loss_val': 0.6069489626446607, 'psi': 0.6895468979342121}-{'f1_val': 0.5197557104551349, 'auprc': 0.7802029794482102, 'loss_val': 0.8110719385121703, 'psi': 0.623934618052365}
[S8] START round=17 head_norm_before_train=0.922582 cos_to_last_merge=1.0000 (last merge round=16)
[S8] round=17 local utility u=0.013334 metrics={'f1_val': 0.6553452627147397, 'auprc': 0.9942246580623192, 'loss_val': 0.5687899430614999, 'psi': 0.7908970208537716}-{'f1_val': 0.6553452627147397, 'auprc': 0.9961583544464141, 'loss_val': 0.601259732942751, 'psi': 0.7916704994074095}
[S9] START round=17 head_norm_before_train=0.870489 cos_to_last_merge=1.0000 (last merge round=16)
[S9] round=17 local utility u=0.005892 metrics={'f1_val': 0.9954208167290715, 'auprc': 0.9984065669836131, 'loss_val': 0.17075256859201524, 'psi': 0.9966151168308881}-{'f1_val': 0.9949999422209534, 'auprc': 0.9980163346773171, 'loss_val': 0.17884115221212912, 'psi': 0.9962064992034989}
[S10] START round=17 head_norm_before_train=1.365964 cos_to_last_merge=1.0000 (last merge round=16)
[S10] round=17 local utility u=0.000000 metrics={'f1_val': 0.7854527548579712, 'auprc': 0.9944178959604875, 'loss_val': 0.42943387523976323, 'psi': 0.8690388112989778}-{'f1_val': 0.9557968298442056, 'auprc': 0.988867004249999, 'loss_val': 0.4033139858793955, 'psi': 0.9690248996065229}
[S11] START round=17 head_norm_before_train=1.738140 cos_to_last_merge=1.0000 (last merge round=16)
[S11] round=17 local utility u=0.005759 metrics={'f1_val': 0.9986875343358496, 'auprc': 0.999637321854667, 'loss_val': 0.14452541507504205, 'psi': 0.9990674493433767}-{'f1_val': 0.9973780864376928, 'auprc': 0.9988575139626393, 'loss_val': 0.14584695099109599, 'psi': 0.9979698574476714}
[S13] START round=17 head_norm_before_train=1.409465 cos_to_last_merge=0.8487 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.849
[S13] round=17 local utility u=0.000000 metrics={'f1_val': 0.5665587255392697, 'auprc': 0.6944847124423296, 'loss_val': 0.7693929749397161, 'psi': 0.6177291203004937}-{'f1_val': 0.6016096790137392, 'auprc': 0.6468031402028016, 'loss_val': 0.6330897531887777, 'psi': 0.6196870634893642}
[S14] START round=17 head_norm_before_train=0.859695 cos_to_last_merge=1.0000 (last merge round=16)
[S14] round=17 local utility u=0.008054 metrics={'f1_val': 0.9972338922372435, 'auprc': 0.9971553577754222, 'loss_val': 0.46633215505450915, 'psi': 0.997202478452515}-{'f1_val': 0.9967774409524363, 'auprc': 0.9971546673525333, 'loss_val': 0.47969983609586053, 'psi': 0.9969283315124751}
[S15] START round=17 head_norm_before_train=1.716212 cos_to_last_merge=1.0000 (last merge round=16)
[S15] round=17 local utility u=0.000000 metrics={'f1_val': 0.7351257951778325, 'auprc': 0.9878527515340076, 'loss_val': 0.2869211934546576, 'psi': 0.8362165777203026}-{'f1_val': 0.7685792851270971, 'auprc': 0.9852432269434162, 'loss_val': 0.28530842625456515, 'psi': 0.8552448618536247}
[S16] START round=17 head_norm_before_train=1.093853 cos_to_last_merge=1.0000 (last merge round=16)
[S16] round=17 local utility u=0.023926 metrics={'f1_val': 0.8641828562669434, 'auprc': 0.9190597150069056, 'loss_val': 0.6200996603571673, 'psi': 0.8861335997629283}-{'f1_val': 0.8741442861022035, 'auprc': 0.8992775631597136, 'loss_val': 0.6683732270322778, 'psi': 0.8841975969252076}
[S17] START round=17 head_norm_before_train=1.625837 (no previous merge yet)
[S17] round=17 local utility u=0.088744 metrics={'f1_val': 0.5868872978290198, 'auprc': 0.8126713830894264, 'loss_val': 0.5891597132914976, 'psi': 0.6772009319331824}-{'f1_val': 0.5776638414609792, 'auprc': 0.7707197598615444, 'loss_val': 0.5854521681691747, 'psi': 0.6548862088212053}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:44916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:44915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:44916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:44910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] → sending delta(kind=head bytes=1793) to S8@127.0.0.1:44909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:44903
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:44914
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:44902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S2] → sending delta(kind=head bytes=1790) to S15@127.0.0.1:44915
[S16] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1793 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1804 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S2] sending update (kind=head size=1790 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1793) from S14
[S8] cosine check vs S14: cos=0.8403
[S2] RECEIVED delta(kind=head bytes=1800) from S3
[S2] cosine check vs S3: cos=0.9587
[S15] RECEIVED delta(kind=head bytes=1804) from S11
[S15] cosine check vs S11: cos=0.9935
[S16] RECEIVED delta(kind=head bytes=1795) from S9
[S16] cosine check vs S9: cos=0.3196
[S16] RECEIVED delta(kind=head bytes=1803) from S5
[S16] cosine check vs S5: cos=0.9157
[S14] RECEIVED delta(kind=head bytes=1802) from S16
[S14] cosine check vs S16: cos=0.7479
[S3] RECEIVED delta(kind=head bytes=1798) from S7
[S3] cosine check vs S7: cos=0.6185
[S15] RECEIVED delta(kind=head bytes=1790) from S2
[S15] cosine check vs S2: cos=-0.0435
[S15] DROPPED delta from S2 (cos=-0.0435 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1795) from S8
[S9] cosine check vs S8: cos=0.6752
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:44903
[S17] sending update (kind=head size=1797 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1797) from S17
[S3] cosine check vs S17: cos=0.7413
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=17 metric=0.9954 head_norm=0.981161
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.913270e-01
[S9] stored merged vector for next round verification (round=17)
[S9] DEBUG after merge:  round=17 metric=0.9954 head_norm=0.888448 delta_norm=0.391327
[S9] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=17 metric=0.9612 head_norm=1.213585
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.590373e-01
[S3] stored merged vector for next round verification (round=17)
[S3] DEBUG after merge:  round=17 metric=0.9607 head_norm=1.146210 delta_norm=0.159037
[S3] aggregate: ACCEPT kept=['S7', 'S17'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=17 metric=0.8642 head_norm=1.131178
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.021887e-01
[S16] stored merged vector for next round verification (round=17)
[S16] DEBUG after merge:  round=17 metric=0.8690 head_norm=1.029590 delta_norm=0.202189
[S16] aggregate: ACCEPT kept=['S9', 'S5'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=17 metric=0.9972 head_norm=0.905532
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.766361e-01
[S14] stored merged vector for next round verification (round=17)
[S14] DEBUG after merge:  round=17 metric=0.9972 head_norm=0.952849 delta_norm=0.376636
[S14] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=17 metric=0.6553 head_norm=0.960353
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.649007e-01
[S8] stored merged vector for next round verification (round=17)
[S8] DEBUG after merge:  round=17 metric=0.6547 head_norm=0.894964 delta_norm=0.264901
[S8] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=17 metric=0.7013 head_norm=1.302424
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.861351e-01
[S2] stored merged vector for next round verification (round=17)
[S2] DEBUG after merge:  round=17 metric=0.7011 head_norm=1.244951 delta_norm=0.186135
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=17 metric=0.7351 head_norm=1.736886
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.012789e-01
[S15] stored merged vector for next round verification (round=17)
[S15] DEBUG after merge:  round=17 metric=0.7654 head_norm=1.748654 delta_norm=0.101279
[S15] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.244951 cos_to_last_merge=1.0000 (last merge round=17)
[S2] round=18 local utility u=0.000000 metrics={'f1_val': 0.6999381040217714, 'auprc': 0.7768879023338089, 'loss_val': 0.3160352928768293, 'psi': 0.7307180233465864}-{'f1_val': 0.7013121503667978, 'auprc': 0.7689347127560187, 'loss_val': 0.29651552751901283, 'psi': 0.7283611753224861}
[S3] START round=18 head_norm_before_train=1.146210 cos_to_last_merge=1.0000 (last merge round=17)
[S3] round=18 local utility u=0.108221 metrics={'f1_val': 0.9974247332315468, 'auprc': 0.9993995365115292, 'loss_val': 0.17906568250327823, 'psi': 0.9982146545435397}-{'f1_val': 0.9612046783862453, 'auprc': 0.9978769760066224, 'loss_val': 0.1736203097826604, 'psi': 0.9758735974343962}
[S4] START round=18 head_norm_before_train=1.765039 (no previous merge yet)
[S4] round=18 local utility u=0.057212 metrics={'f1_val': 0.943145954891957, 'auprc': 0.9445030097217435, 'loss_val': 0.32406491083098865, 'psi': 0.9436887768238715}-{'f1_val': 0.9366077597025617, 'auprc': 0.9334151492597196, 'loss_val': 0.3659969421932741, 'psi': 0.9353307155254249}
[S5] START round=18 head_norm_before_train=1.625398 cos_to_last_merge=0.9981 (last merge round=16)
[S5] round=18 local utility u=0.023135 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.9921486323116064, 'loss_val': 0.19549633769493557, 'psi': 0.9943954471958463}-{'f1_val': 0.9960398919057053, 'auprc': 0.994567013556384, 'loss_val': 0.24990116812727392, 'psi': 0.9954507405659767}
[S6] START round=18 head_norm_before_train=1.390937 cos_to_last_merge=0.8217 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.822
[S6] round=18 local utility u=0.000000 metrics={'f1_val': 0.5969386067401992, 'auprc': 0.7854479701892348, 'loss_val': 0.5272598825427215, 'psi': 0.6723423521198134}-{'f1_val': 0.7406068284547429, 'auprc': 0.9624050076769486, 'loss_val': 0.27664028520814893, 'psi': 0.8293261001436252}
[S7] START round=18 head_norm_before_train=1.449721 cos_to_last_merge=0.8669 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.867
[S7] round=18 local utility u=0.234286 metrics={'f1_val': 0.6582624528706953, 'auprc': 0.8199357006507074, 'loss_val': 0.44275607268840456, 'psi': 0.7229317519827001}-{'f1_val': 0.62226778013046, 'auprc': 0.7904655746398401, 'loss_val': 0.6069489626446607, 'psi': 0.6895468979342121}
[S8] START round=18 head_norm_before_train=0.894964 cos_to_last_merge=1.0000 (last merge round=17)
[S8] round=18 local utility u=0.204599 metrics={'f1_val': 0.7139540394217572, 'auprc': 0.9920107866982509, 'loss_val': 0.5046028902573854, 'psi': 0.8251767383323547}-{'f1_val': 0.6553452627147397, 'auprc': 0.9942246580623192, 'loss_val': 0.5687899430614999, 'psi': 0.7908970208537716}
[S9] START round=18 head_norm_before_train=0.888448 cos_to_last_merge=1.0000 (last merge round=17)
[S9] round=18 local utility u=0.000000 metrics={'f1_val': 0.9878214512971564, 'auprc': 0.9979216706612144, 'loss_val': 0.14407588785457506, 'psi': 0.9918615390427796}-{'f1_val': 0.9954208167290715, 'auprc': 0.9984065669836131, 'loss_val': 0.17075256859201524, 'psi': 0.9966151168308881}
[S10] START round=18 head_norm_before_train=1.399369 cos_to_last_merge=0.9982 (last merge round=16)
[S10] round=18 local utility u=0.013563 metrics={'f1_val': 0.7837487112455708, 'auprc': 0.995585456172731, 'loss_val': 0.39558640866423705, 'psi': 0.8684834092164349}-{'f1_val': 0.7854527548579712, 'auprc': 0.9944178959604875, 'loss_val': 0.42943387523976323, 'psi': 0.8690388112989778}
[S11] START round=18 head_norm_before_train=1.766161 cos_to_last_merge=0.9996 (last merge round=16)
[S11] round=18 local utility u=0.021527 metrics={'f1_val': 0.9969812955738739, 'auprc': 0.99930020900712, 'loss_val': 0.09022207919031469, 'psi': 0.9979088609471723}-{'f1_val': 0.9986875343358496, 'auprc': 0.999637321854667, 'loss_val': 0.14452541507504205, 'psi': 0.9990674493433767}
[S13] START round=18 head_norm_before_train=1.428182 cos_to_last_merge=0.8455 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.846
[S13] round=18 local utility u=0.179561 metrics={'f1_val': 0.6094882436170892, 'auprc': 0.6827784868297119, 'loss_val': 0.6327298169927118, 'psi': 0.6388043409021382}-{'f1_val': 0.5665587255392697, 'auprc': 0.6944847124423296, 'loss_val': 0.7693929749397161, 'psi': 0.6177291203004937}
[S14] START round=18 head_norm_before_train=0.952849 cos_to_last_merge=1.0000 (last merge round=17)
[S14] round=18 local utility u=0.000000 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.9969532252726797, 'loss_val': 0.47567843836491286, 'psi': 0.9974730008894029}-{'f1_val': 0.9972338922372435, 'auprc': 0.9971553577754222, 'loss_val': 0.46633215505450915, 'psi': 0.997202478452515}
[S15] START round=18 head_norm_before_train=1.748654 cos_to_last_merge=1.0000 (last merge round=17)
[S15] round=18 local utility u=0.000000 metrics={'f1_val': 0.6947924414002149, 'auprc': 0.88210391249724, 'loss_val': 0.4269779581977032, 'psi': 0.769717029839025}-{'f1_val': 0.7351257951778325, 'auprc': 0.9878527515340076, 'loss_val': 0.2869211934546576, 'psi': 0.8362165777203026}
[S16] START round=18 head_norm_before_train=1.029590 cos_to_last_merge=1.0000 (last merge round=17)
[S16] round=18 local utility u=0.113864 metrics={'f1_val': 0.8848759843890246, 'auprc': 0.9407947218698437, 'loss_val': 0.5817348009662776, 'psi': 0.9072434793813522}-{'f1_val': 0.8641828562669434, 'auprc': 0.9190597150069056, 'loss_val': 0.6200996603571673, 'psi': 0.8861335997629283}
[S17] START round=18 head_norm_before_train=1.655017 (no previous merge yet)
[S17] round=18 local utility u=0.000000 metrics={'f1_val': 0.5825283258934818, 'auprc': 0.8134338049847072, 'loss_val': 0.5963557486560078, 'psi': 0.674890517529972}-{'f1_val': 0.5868872978290198, 'auprc': 0.8126713830894264, 'loss_val': 0.5891597132914976, 'psi': 0.6772009319331824}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:44915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] → sending delta(kind=head bytes=1794) to S2@127.0.0.1:44902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:44911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:44910
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:44912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:44914
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] → sending delta(kind=head bytes=1806) to S3@127.0.0.1:44903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:44916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S9@127.0.0.1:44910
[S10] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1794 to 1 peers)
[S8] sending update (kind=head size=1793 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1806 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1794) from S3
[S2] cosine check vs S3: cos=0.9777
[S15] RECEIVED delta(kind=head bytes=1797) from S11
[S15] cosine check vs S11: cos=0.9970
[S9] RECEIVED delta(kind=head bytes=1793) from S8
[S9] cosine check vs S8: cos=0.9044
[S16] RECEIVED delta(kind=head bytes=1801) from S5
[S16] cosine check vs S5: cos=0.8915
[S9] RECEIVED delta(kind=head bytes=1797) from S10
[S9] cosine check vs S10: cos=0.3768
[S14] RECEIVED delta(kind=head bytes=1797) from S16
[S14] cosine check vs S16: cos=0.9346
[S11] RECEIVED delta(kind=head bytes=1800) from S4
[S11] cosine check vs S4: cos=0.9932
[S10] RECEIVED delta(kind=head bytes=1798) from S13
[S10] cosine check vs S13: cos=0.9746
[S3] RECEIVED delta(kind=head bytes=1806) from S7
[S3] cosine check vs S7: cos=0.6305
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=18 metric=0.9878 head_norm=0.997356
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.192063e-01
[S9] stored merged vector for next round verification (round=18)
[S9] DEBUG after merge:  round=18 metric=0.9878 head_norm=0.888876 delta_norm=0.319206
[S9] aggregate: ACCEPT kept=['S8', 'S10'] (k=2/2) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=18 metric=0.6999 head_norm=1.275684
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.357588e-01
[S2] stored merged vector for next round verification (round=18)
[S2] DEBUG after merge:  round=18 metric=0.6997 head_norm=1.231650 delta_norm=0.135759
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=18 metric=0.9978 head_norm=0.992924
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.902357e-01
[S14] stored merged vector for next round verification (round=18)
[S14] DEBUG after merge:  round=18 metric=0.9968 head_norm=1.014029 delta_norm=0.190236
[S14] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=18 metric=0.6948 head_norm=1.766752
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.066048e-02
[S15] stored merged vector for next round verification (round=18)
[S15] DEBUG after merge:  round=18 metric=0.6946 head_norm=1.780739 delta_norm=0.070660
[S15] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=18 metric=0.7837 head_norm=1.427572
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.622990e-01
[S10] stored merged vector for next round verification (round=18)
[S10] DEBUG after merge:  round=18 metric=0.7842 head_norm=1.428137 delta_norm=0.162299
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=18 metric=0.9970 head_norm=1.797397
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.046416e-01
[S11] stored merged vector for next round verification (round=18)
[S11] DEBUG after merge:  round=18 metric=0.9974 head_norm=1.790007 delta_norm=0.104642
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=18 metric=0.8849 head_norm=1.069108
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.301529e-01
[S16] stored merged vector for next round verification (round=18)
[S16] DEBUG after merge:  round=18 metric=0.9055 head_norm=1.330897 delta_norm=0.430153
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=18 metric=0.9974 head_norm=1.201422
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.876552e-01
[S3] stored merged vector for next round verification (round=18)
[S3] DEBUG after merge:  round=18 metric=0.9936 head_norm=1.208742 delta_norm=0.587655
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.231650 cos_to_last_merge=1.0000 (last merge round=18)
[S2] round=19 local utility u=0.000000 metrics={'f1_val': 0.7018318238212289, 'auprc': 0.7715369394539973, 'loss_val': 0.3271888640046308, 'psi': 0.7297138700743362}-{'f1_val': 0.6999381040217714, 'auprc': 0.7768879023338089, 'loss_val': 0.3160352928768293, 'psi': 0.7307180233465864}
[S3] START round=19 head_norm_before_train=1.208742 cos_to_last_merge=1.0000 (last merge round=18)
[S3] round=19 local utility u=0.000000 metrics={'f1_val': 0.9874726426857, 'auprc': 0.998345692400022, 'loss_val': 0.20249841470194527, 'psi': 0.9918218625714288}-{'f1_val': 0.9974247332315468, 'auprc': 0.9993995365115292, 'loss_val': 0.17906568250327823, 'psi': 0.9982146545435397}
[S4] START round=19 head_norm_before_train=1.788717 (no previous merge yet)
[S4] round=19 local utility u=0.006470 metrics={'f1_val': 0.9420978057662561, 'auprc': 0.9464420922142281, 'loss_val': 0.31065349365969486, 'psi': 0.9438355203454449}-{'f1_val': 0.943145954891957, 'auprc': 0.9445030097217435, 'loss_val': 0.32406491083098865, 'psi': 0.9436887768238715}
[S5] START round=19 head_norm_before_train=1.664225 cos_to_last_merge=0.9940 (last merge round=16)
[S5] round=19 local utility u=0.017353 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9914264351663624, 'loss_val': 0.16038089901980396, 'psi': 0.9942821880521315}-{'f1_val': 0.9958933237853395, 'auprc': 0.9921486323116064, 'loss_val': 0.19549633769493557, 'psi': 0.9943954471958463}
[S6] START round=19 head_norm_before_train=1.412010 cos_to_last_merge=0.8145 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.814
[S6] round=19 local utility u=1.000000 metrics={'f1_val': 0.9452430482050664, 'auprc': 0.957532921055434, 'loss_val': 0.23314740521099198, 'psi': 0.9501589973452135}-{'f1_val': 0.5969386067401992, 'auprc': 0.7854479701892348, 'loss_val': 0.5272598825427215, 'psi': 0.6723423521198134}
[S7] START round=19 head_norm_before_train=1.472881 cos_to_last_merge=0.8626 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.863
[S7] round=19 local utility u=0.000000 metrics={'f1_val': 0.5445267065671755, 'auprc': 0.7830175054940933, 'loss_val': 0.743108324794865, 'psi': 0.6399230261379427}-{'f1_val': 0.6582624528706953, 'auprc': 0.8199357006507074, 'loss_val': 0.44275607268840456, 'psi': 0.7229317519827001}
[S8] START round=19 head_norm_before_train=0.931277 cos_to_last_merge=0.9986 (last merge round=17)
[S8] round=19 local utility u=0.916146 metrics={'f1_val': 0.9967901605898053, 'auprc': 0.9972566495633861, 'loss_val': 0.3850644500663317, 'psi': 0.9969767561792376}-{'f1_val': 0.7139540394217572, 'auprc': 0.9920107866982509, 'loss_val': 0.5046028902573854, 'psi': 0.8251767383323547}
[S9] START round=19 head_norm_before_train=0.888876 cos_to_last_merge=1.0000 (last merge round=18)
[S9] round=19 local utility u=0.020967 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9984065242824791, 'loss_val': 0.15416759780458877, 'psi': 0.9971126665805582}-{'f1_val': 0.9878214512971564, 'auprc': 0.9979216706612144, 'loss_val': 0.14407588785457506, 'psi': 0.9918615390427796}
[S10] START round=19 head_norm_before_train=1.428137 cos_to_last_merge=1.0000 (last merge round=18)
[S10] round=19 local utility u=0.264351 metrics={'f1_val': 0.8902609823757717, 'auprc': 0.9726724994794947, 'loss_val': 0.4372193540553654, 'psi': 0.923225589217261}-{'f1_val': 0.7837487112455708, 'auprc': 0.995585456172731, 'loss_val': 0.39558640866423705, 'psi': 0.8684834092164349}
[S11] START round=19 head_norm_before_train=1.790007 cos_to_last_merge=1.0000 (last merge round=18)
[S11] round=19 local utility u=0.006402 metrics={'f1_val': 0.9973780864376928, 'auprc': 0.9986765136909859, 'loss_val': 0.07792850260026708, 'psi': 0.99789745733901}-{'f1_val': 0.9969812955738739, 'auprc': 0.99930020900712, 'loss_val': 0.09022207919031469, 'psi': 0.9979088609471723}
[S13] START round=19 head_norm_before_train=1.447022 cos_to_last_merge=0.8426 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.843
[S13] round=19 local utility u=0.120305 metrics={'f1_val': 0.6431652096945459, 'auprc': 0.6648524687910911, 'loss_val': 0.5404030588657915, 'psi': 0.6518401133331639}-{'f1_val': 0.6094882436170892, 'auprc': 0.6827784868297119, 'loss_val': 0.6327298169927118, 'psi': 0.6388043409021382}
[S14] START round=19 head_norm_before_train=1.014029 cos_to_last_merge=1.0000 (last merge round=18)
[S14] round=19 local utility u=0.019291 metrics={'f1_val': 0.997842298753406, 'auprc': 0.9991722659652221, 'loss_val': 0.44389048963931477, 'psi': 0.9983742856381325}-{'f1_val': 0.9978195179672185, 'auprc': 0.9969532252726797, 'loss_val': 0.47567843836491286, 'psi': 0.9974730008894029}
[S15] START round=19 head_norm_before_train=1.780739 cos_to_last_merge=1.0000 (last merge round=18)
[S15] round=19 local utility u=0.934860 metrics={'f1_val': 0.9203208169536772, 'auprc': 0.9911107946416207, 'loss_val': 0.23744892979137003, 'psi': 0.9486368080288545}-{'f1_val': 0.6947924414002149, 'auprc': 0.88210391249724, 'loss_val': 0.4269779581977032, 'psi': 0.769717029839025}
[S16] START round=19 head_norm_before_train=1.330897 cos_to_last_merge=1.0000 (last merge round=18)
[S16] round=19 local utility u=0.134885 metrics={'f1_val': 0.9046476283781831, 'auprc': 0.9619783619669017, 'loss_val': 0.49414651093322204, 'psi': 0.9275799218136705}-{'f1_val': 0.8848759843890246, 'auprc': 0.9407947218698437, 'loss_val': 0.5817348009662776, 'psi': 0.9072434793813522}
[S17] START round=19 head_norm_before_train=1.685821 (no previous merge yet)
[S17] round=19 local utility u=0.176492 metrics={'f1_val': 0.6503035571175572, 'auprc': 0.7940613025374487, 'loss_val': 0.5919055525954522, 'psi': 0.7078066552855138}-{'f1_val': 0.5825283258934818, 'auprc': 0.8134338049847072, 'loss_val': 0.5963557486560078, 'psi': 0.674890517529972}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:44910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] → sending delta(kind=head bytes=1805) to S16@127.0.0.1:44916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:44909
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:44914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:44912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:44911
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:44916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:44915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:44909
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:44905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S8] → sending delta(kind=head bytes=1790) to S9@127.0.0.1:44910
[S15] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1805 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1790 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1800) from S14
[S8] cosine check vs S14: cos=0.7486
[S14] RECEIVED delta(kind=head bytes=1800) from S16
[S14] cosine check vs S16: cos=0.9053
[S11] RECEIVED delta(kind=head bytes=1799) from S4
[S11] cosine check vs S4: cos=0.9959
[S15] RECEIVED delta(kind=head bytes=1799) from S11
[S15] cosine check vs S11: cos=0.9969
[S10] RECEIVED delta(kind=head bytes=1799) from S13
[S10] cosine check vs S13: cos=0.9899
[S9] RECEIVED delta(kind=head bytes=1790) from S8
[S9] cosine check vs S8: cos=0.8118
[S9] RECEIVED delta(kind=head bytes=1797) from S10
[S9] cosine check vs S10: cos=0.6045
[S16] RECEIVED delta(kind=head bytes=1805) from S5
[S16] cosine check vs S5: cos=0.9750
[S5] RECEIVED delta(kind=head bytes=1797) from S15
[S5] cosine check vs S15: cos=0.9329
[S8] RECEIVED delta(kind=head bytes=1798) from S6
[S8] cosine check vs S6: cos=0.6906
[S16] RECEIVED delta(kind=head bytes=1799) from S9
[S16] cosine check vs S9: cos=0.2999
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:44903
[S17] sending update (kind=head size=1803 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1803) from S17
[S3] cosine check vs S17: cos=0.3889
[S7] r=20 psi=0.640 u=0.0000 p_local=0.2064 f1=0.545 auprc=0.783 bytes=21568
[S2] r=20 psi=0.730 u=0.0000 p_local=0.1021 f1=0.702 auprc=0.772 bytes=19756
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=19 metric=0.9875 head_norm=1.262740
[S3] _apply_head_vector_avg (torch): Δ‖w‖=8.448873e-01
[S3] stored merged vector for next round verification (round=19)
[S3] DEBUG after merge:  round=19 metric=0.9909 head_norm=1.247793 delta_norm=0.844887
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S3] r=20 psi=0.992 u=0.0000 p_local=0.1264 f1=0.987 auprc=0.998 bytes=19764
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=19 metric=0.9968 head_norm=0.964262
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.113014e-01
[S8] stored merged vector for next round verification (round=19)
[S8] DEBUG after merge:  round=19 metric=0.9964 head_norm=0.949259 delta_norm=0.211301
[S8] aggregate: ACCEPT kept=['S14', 'S6'] (k=2/2) mode=median trim_p=0.1
[S8] r=20 psi=0.997 u=0.9161 p_local=0.3800 f1=0.997 auprc=0.997 bytes=23337
[S6] r=20 psi=0.950 u=1.0000 p_local=0.3611 f1=0.945 auprc=0.958 bytes=19772
[S13] r=20 psi=0.652 u=0.1203 p_local=0.1165 f1=0.643 auprc=0.665 bytes=17990
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=19 metric=0.9978 head_norm=1.054832
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.034301e-01
[S14] stored merged vector for next round verification (round=19)
[S14] DEBUG after merge:  round=19 metric=0.9974 head_norm=1.181034 delta_norm=0.303430
[S14] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S14] r=20 psi=0.998 u=0.0193 p_local=0.1578 f1=0.998 auprc=0.999 bytes=23342
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=19 metric=0.9963 head_norm=0.971746
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.998659e-01
[S9] stored merged vector for next round verification (round=19)
[S9] DEBUG after merge:  round=19 metric=0.9963 head_norm=0.919221 delta_norm=0.199866
[S9] aggregate: ACCEPT kept=['S8', 'S10'] (k=2/2) mode=median trim_p=0.1
[S9] r=20 psi=0.997 u=0.0210 p_local=0.0919 f1=0.996 auprc=0.998 bytes=21552
[S4] r=20 psi=0.944 u=0.0065 p_local=0.1485 f1=0.942 auprc=0.946 bytes=21584
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=19 metric=0.9974 head_norm=1.819885
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.238420e-02
[S11] stored merged vector for next round verification (round=19)
[S11] DEBUG after merge:  round=19 metric=0.9974 head_norm=1.813843 delta_norm=0.082384
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] r=20 psi=0.998 u=0.0064 p_local=0.1493 f1=0.997 auprc=0.999 bytes=25185
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=19 metric=0.8903 head_norm=1.445849
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.036143e-01
[S10] stored merged vector for next round verification (round=19)
[S10] DEBUG after merge:  round=19 metric=0.9359 head_norm=1.449756 delta_norm=0.103614
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S10] r=20 psi=0.923 u=0.2644 p_local=0.1908 f1=0.890 auprc=0.973 bytes=21609
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=19 metric=0.9962 head_norm=1.700360
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.240911e-01
[S5] stored merged vector for next round verification (round=19)
[S5] DEBUG after merge:  round=19 metric=0.9962 head_norm=1.720312 delta_norm=0.324091
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S5] r=20 psi=0.994 u=0.0174 p_local=0.2034 f1=0.996 auprc=0.991 bytes=23393
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=19 metric=0.9203 head_norm=1.799386
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.143214e-02
[S15] stored merged vector for next round verification (round=19)
[S15] DEBUG after merge:  round=19 metric=0.9279 head_norm=1.808254 delta_norm=0.071432
[S15] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S15] r=20 psi=0.949 u=0.9349 p_local=0.3118 f1=0.920 auprc=0.991 bytes=17955
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=19 metric=0.9046 head_norm=1.364241
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.512328e-01
[S16] stored merged vector for next round verification (round=19)
[S16] DEBUG after merge:  round=19 metric=0.9055 head_norm=1.180164 delta_norm=0.251233
[S16] aggregate: ACCEPT kept=['S5', 'S9'] (k=2/2) mode=median trim_p=0.1
[S16] r=20 psi=0.928 u=0.1349 p_local=0.2503 f1=0.905 auprc=0.962 bytes=23353
[S17] r=20 psi=0.708 u=0.1765 p_local=0.1796 f1=0.650 auprc=0.794 bytes=21553
[S2] START round=20 head_norm_before_train=1.262552 cos_to_last_merge=0.9992 (last merge round=18)
[S2] round=20 local utility u=0.028699 metrics={'f1_val': 0.7018318238212289, 'auprc': 0.7922548940178675, 'loss_val': 0.33194421990222495, 'psi': 0.7380010518998843}-{'f1_val': 0.7018318238212289, 'auprc': 0.7715369394539973, 'loss_val': 0.3271888640046308, 'psi': 0.7297138700743362}
[S3] START round=20 head_norm_before_train=1.247793 cos_to_last_merge=1.0000 (last merge round=19)
[S3] round=20 local utility u=0.000000 metrics={'f1_val': 0.9523655484453774, 'auprc': 0.9979273913300837, 'loss_val': 0.20854295876968604, 'psi': 0.9705902855992599}-{'f1_val': 0.9874726426857, 'auprc': 0.998345692400022, 'loss_val': 0.20249841470194527, 'psi': 0.9918218625714288}
[S4] START round=20 head_norm_before_train=1.811532 (no previous merge yet)
[S4] round=20 local utility u=0.042759 metrics={'f1_val': 0.9439750396802966, 'auprc': 0.963450714902192, 'loss_val': 0.2874250604384916, 'psi': 0.9517653097690547}-{'f1_val': 0.9420978057662561, 'auprc': 0.9464420922142281, 'loss_val': 0.31065349365969486, 'psi': 0.9438355203454449}
[S5] START round=20 head_norm_before_train=1.720312 cos_to_last_merge=1.0000 (last merge round=19)
[S5] round=20 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9896606604653339, 'loss_val': 0.18844566660832693, 'psi': 0.9935758781717201}-{'f1_val': 0.996186023309311, 'auprc': 0.9914264351663624, 'loss_val': 0.16038089901980396, 'psi': 0.9942821880521315}
[S6] START round=20 head_norm_before_train=1.428773 cos_to_last_merge=0.8092 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.809
[S6] round=20 local utility u=0.000000 metrics={'f1_val': 0.6027536765736745, 'auprc': 0.7835423094196855, 'loss_val': 0.839037770593729, 'psi': 0.675069129712079}-{'f1_val': 0.9452430482050664, 'auprc': 0.957532921055434, 'loss_val': 0.23314740521099198, 'psi': 0.9501589973452135}
[S7] START round=20 head_norm_before_train=1.496024 cos_to_last_merge=0.8585 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.858
[S7] round=20 local utility u=0.059683 metrics={'f1_val': 0.5771982798096433, 'auprc': 0.7824190104362111, 'loss_val': 0.8179771163176276, 'psi': 0.6592865720602704}-{'f1_val': 0.5445267065671755, 'auprc': 0.7830175054940933, 'loss_val': 0.743108324794865, 'psi': 0.6399230261379427}
[S8] START round=20 head_norm_before_train=0.949259 cos_to_last_merge=1.0000 (last merge round=19)
[S8] round=20 local utility u=0.000000 metrics={'f1_val': 0.7143716111285884, 'auprc': 0.9931272601895735, 'loss_val': 0.42136024625857776, 'psi': 0.8258738707529825}-{'f1_val': 0.9967901605898053, 'auprc': 0.9972566495633861, 'loss_val': 0.3850644500663317, 'psi': 0.9969767561792376}
[S9] START round=20 head_norm_before_train=0.919221 cos_to_last_merge=1.0000 (last merge round=19)
[S9] round=20 local utility u=0.000000 metrics={'f1_val': 0.9924939623182388, 'auprc': 0.9984046301706868, 'loss_val': 0.16151741749654633, 'psi': 0.9948582294592181}-{'f1_val': 0.9962500947792776, 'auprc': 0.9984065242824791, 'loss_val': 0.15416759780458877, 'psi': 0.9971126665805582}
[S10] START round=20 head_norm_before_train=1.449756 cos_to_last_merge=1.0000 (last merge round=19)
[S10] round=20 local utility u=0.370699 metrics={'f1_val': 0.9929838396581911, 'auprc': 0.9877535227725679, 'loss_val': 0.3574020853274271, 'psi': 0.9908917129039418}-{'f1_val': 0.8902609823757717, 'auprc': 0.9726724994794947, 'loss_val': 0.4372193540553654, 'psi': 0.923225589217261}
[S11] START round=20 head_norm_before_train=1.813843 cos_to_last_merge=1.0000 (last merge round=19)
[S11] round=20 local utility u=0.004810 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9992908560836308, 'loss_val': 0.06766884964600108, 'psi': 0.9978948964091986}-{'f1_val': 0.9973780864376928, 'auprc': 0.9986765136909859, 'loss_val': 0.07792850260026708, 'psi': 0.99789745733901}
[S13] START round=20 head_norm_before_train=1.461020 cos_to_last_merge=0.8397 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.840
[S13] round=20 local utility u=0.000000 metrics={'f1_val': 0.5357317649942629, 'auprc': 0.7187820526373728, 'loss_val': 0.9102161867047062, 'psi': 0.6089518800515068}-{'f1_val': 0.6431652096945459, 'auprc': 0.6648524687910911, 'loss_val': 0.5404030588657915, 'psi': 0.6518401133331639}
[S14] START round=20 head_norm_before_train=1.181034 cos_to_last_merge=1.0000 (last merge round=19)
[S14] round=20 local utility u=0.010045 metrics={'f1_val': 0.9980850197418996, 'auprc': 0.9992259373816609, 'loss_val': 0.42541687555895386, 'psi': 0.998541386797804}-{'f1_val': 0.997842298753406, 'auprc': 0.9991722659652221, 'loss_val': 0.44389048963931477, 'psi': 0.9983742856381325}
[S15] START round=20 head_norm_before_train=1.808254 cos_to_last_merge=1.0000 (last merge round=19)
[S15] round=20 local utility u=0.000000 metrics={'f1_val': 0.7393393956099059, 'auprc': 0.9878766637641976, 'loss_val': 0.2702867309836454, 'psi': 0.8387543028716227}-{'f1_val': 0.9203208169536772, 'auprc': 0.9911107946416207, 'loss_val': 0.23744892979137003, 'psi': 0.9486368080288545}
[S16] START round=20 head_norm_before_train=1.180164 cos_to_last_merge=1.0000 (last merge round=19)
[S16] round=20 local utility u=0.293570 metrics={'f1_val': 0.9742373242938502, 'auprc': 0.9816016957288012, 'loss_val': 0.3834155360133965, 'psi': 0.9771830728678306}-{'f1_val': 0.9046476283781831, 'auprc': 0.9619783619669017, 'loss_val': 0.49414651093322204, 'psi': 0.9275799218136705}
[S17] START round=20 head_norm_before_train=1.716721 (no previous merge yet)
[S17] round=20 local utility u=0.000000 metrics={'f1_val': 0.57764102311689, 'auprc': 0.8122365447397458, 'loss_val': 0.6638542465718644, 'psi': 0.6714792317660323}-{'f1_val': 0.6503035571175572, 'auprc': 0.7940613025374487, 'loss_val': 0.5919055525954522, 'psi': 0.7078066552855138}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:44915
[S16] not sending this round → trigger blocked (psi=0.977)
[S14] not sending this round → trigger blocked (psi=0.999)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.998)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.991)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.952)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:44903
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1800) from S2
[S15] cosine check vs S2: cos=-0.0491
[S15] DROPPED delta from S2 (cos=-0.0491 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1800) from S7
[S3] cosine check vs S7: cos=0.4494
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] ⇄ pheromone p=0.120 → S15@127.0.0.1:44915
[S4] ⇄ pheromone p=0.127 → S11@127.0.0.1:44912
[S14] ⇄ pheromone p=0.128 → S8@127.0.0.1:44909
[S5] ⇄ pheromone p=0.163 → S16@127.0.0.1:44916
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=20 metric=0.9524 head_norm=1.321746
[S3] _apply_head_vector_avg (torch): Δ‖w‖=7.506984e-01
[S3] stored merged vector for next round verification (round=20)
[S3] DEBUG after merge:  round=20 metric=0.9746 head_norm=1.211353 delta_norm=0.750698
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.101 → S2@127.0.0.1:44902
[S10] ⇄ pheromone p=0.227 → S9@127.0.0.1:44910
[S6] ⇄ pheromone p=0.289 → S8@127.0.0.1:44909
[S15] ⇄ pheromone p=0.249 → S5@127.0.0.1:44905
[S9] ⇄ pheromone p=0.074 → S16@127.0.0.1:44916
[S8] ⇄ pheromone p=0.304 → S9@127.0.0.1:44910
[S13] ⇄ pheromone p=0.093 → S10@127.0.0.1:44911
[S7] ⇄ pheromone p=0.177 → S3@127.0.0.1:44903
[S2] ⇄ pheromone p=0.087 → S15@127.0.0.1:44915
[S17] ⇄ pheromone p=0.144 → S3@127.0.0.1:44903
[S16] ⇄ pheromone p=0.259 → S14@127.0.0.1:44914
[S2] START round=21 head_norm_before_train=1.294137 cos_to_last_merge=0.9971 (last merge round=18)
[S2] round=21 local utility u=0.181404 metrics={'f1_val': 0.7629875793484006, 'auprc': 0.7842970382793277, 'loss_val': 0.31219667925275324, 'psi': 0.7715113629207715}-{'f1_val': 0.7018318238212289, 'auprc': 0.7922548940178675, 'loss_val': 0.33194421990222495, 'psi': 0.7380010518998843}
[S3] START round=21 head_norm_before_train=1.211353 cos_to_last_merge=1.0000 (last merge round=20)
[S3] round=21 local utility u=0.043226 metrics={'f1_val': 0.961283756324695, 'auprc': 0.9981336968577581, 'loss_val': 0.1762182559651072, 'psi': 0.9760237325379202}-{'f1_val': 0.9523655484453774, 'auprc': 0.9979273913300837, 'loss_val': 0.20854295876968604, 'psi': 0.9705902855992599}
[S4] START round=21 head_norm_before_train=1.833364 (no previous merge yet)
[S4] round=21 local utility u=0.023970 metrics={'f1_val': 0.9457993581231305, 'auprc': 0.9724916203270518, 'loss_val': 0.27755397935003306, 'psi': 0.956476263004699}-{'f1_val': 0.9439750396802966, 'auprc': 0.963450714902192, 'loss_val': 0.2874250604384916, 'psi': 0.9517653097690547}
[S5] START round=21 head_norm_before_train=1.761848 cos_to_last_merge=0.9985 (last merge round=19)
[S5] round=21 local utility u=0.041165 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9928923206673201, 'loss_val': 0.11493481043184317, 'psi': 0.9947810578057604}-{'f1_val': 0.996186023309311, 'auprc': 0.9896606604653339, 'loss_val': 0.18844566660832693, 'psi': 0.9935758781717201}
[S6] START round=21 head_norm_before_train=1.446644 cos_to_last_merge=0.8051 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.805
[S6] round=21 local utility u=1.000000 metrics={'f1_val': 0.8394500546310489, 'auprc': 0.9727924617501498, 'loss_val': 0.24318401425566638, 'psi': 0.8927870174786893}-{'f1_val': 0.6027536765736745, 'auprc': 0.7835423094196855, 'loss_val': 0.839037770593729, 'psi': 0.675069129712079}
[S7] START round=21 head_norm_before_train=1.521458 cos_to_last_merge=0.8559 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.856
[S7] round=21 local utility u=0.606477 metrics={'f1_val': 0.681804890150531, 'auprc': 0.8490430187084639, 'loss_val': 0.43253440392513354, 'psi': 0.7487001415737042}-{'f1_val': 0.5771982798096433, 'auprc': 0.7824190104362111, 'loss_val': 0.8179771163176276, 'psi': 0.6592865720602704}
[S8] START round=21 head_norm_before_train=0.976490 cos_to_last_merge=0.9993 (last merge round=19)
[S8] round=21 local utility u=0.000000 metrics={'f1_val': 0.6611552830106036, 'auprc': 0.9436546013396692, 'loss_val': 0.4533682351162516, 'psi': 0.7741550103422298}-{'f1_val': 0.7143716111285884, 'auprc': 0.9931272601895735, 'loss_val': 0.42136024625857776, 'psi': 0.8258738707529825}
[S9] START round=21 head_norm_before_train=1.005265 cos_to_last_merge=0.9947 (last merge round=19)
[S9] round=21 local utility u=0.033052 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9935050642492903, 'loss_val': 0.10325220295996984, 'psi': 0.9951520825672827}-{'f1_val': 0.9924939623182388, 'auprc': 0.9984046301706868, 'loss_val': 0.16151741749654633, 'psi': 0.9948582294592181}
[S10] START round=21 head_norm_before_train=1.462797 cos_to_last_merge=0.9997 (last merge round=19)
[S10] round=21 local utility u=0.043756 metrics={'f1_val': 0.9933750578586366, 'auprc': 0.9929960580390796, 'loss_val': 0.2879653834295319, 'psi': 0.9932234579308137}-{'f1_val': 0.9929838396581911, 'auprc': 0.9877535227725679, 'loss_val': 0.3574020853274271, 'psi': 0.9908917129039418}
[S11] START round=21 head_norm_before_train=1.841611 cos_to_last_merge=0.9997 (last merge round=19)
[S11] round=21 local utility u=0.009287 metrics={'f1_val': 0.9974011907167429, 'auprc': 0.999372307263388, 'loss_val': 0.05196168777766086, 'psi': 0.998189637335401}-{'f1_val': 0.9969642566262439, 'auprc': 0.9992908560836308, 'loss_val': 0.06766884964600108, 'psi': 0.9978948964091986}
[S13] START round=21 head_norm_before_train=1.474046 cos_to_last_merge=0.8366 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.837
[S13] round=21 local utility u=0.145509 metrics={'f1_val': 0.578630326587612, 'auprc': 0.6844647857429197, 'loss_val': 0.7736387105359676, 'psi': 0.6209641102497351}-{'f1_val': 0.5357317649942629, 'auprc': 0.7187820526373728, 'loss_val': 0.9102161867047062, 'psi': 0.6089518800515068}
[S14] START round=21 head_norm_before_train=1.216144 cos_to_last_merge=0.9965 (last merge round=19)
[S14] round=21 local utility u=0.059782 metrics={'f1_val': 0.9967774409524363, 'auprc': 0.9987418210901191, 'loss_val': 0.2965540639636932, 'psi': 0.9975631930075094}-{'f1_val': 0.9980850197418996, 'auprc': 0.9992259373816609, 'loss_val': 0.42541687555895386, 'psi': 0.998541386797804}
[S15] START round=21 head_norm_before_train=1.822829 cos_to_last_merge=0.9998 (last merge round=19)
[S15] round=21 local utility u=0.360245 metrics={'f1_val': 0.8500674600504627, 'auprc': 0.9879082556467789, 'loss_val': 0.2142608510816237, 'psi': 0.9052037782889891}-{'f1_val': 0.7393393956099059, 'auprc': 0.9878766637641976, 'loss_val': 0.2702867309836454, 'psi': 0.8387543028716227}
[S16] START round=21 head_norm_before_train=1.223722 cos_to_last_merge=0.9981 (last merge round=19)
[S16] round=21 local utility u=0.000000 metrics={'f1_val': 0.8456159122178176, 'auprc': 0.9542981165356006, 'loss_val': 0.5989549241199694, 'psi': 0.8890887939449308}-{'f1_val': 0.9742373242938502, 'auprc': 0.9816016957288012, 'loss_val': 0.3834155360133965, 'psi': 0.9771830728678306}
[S17] START round=21 head_norm_before_train=1.746309 (no previous merge yet)
[S17] round=21 local utility u=0.269310 metrics={'f1_val': 0.5923583641123006, 'auprc': 0.945103128703584, 'loss_val': 0.6121381850222978, 'psi': 0.733456269948814}-{'f1_val': 0.57764102311689, 'auprc': 0.8122365447397458, 'loss_val': 0.6638542465718644, 'psi': 0.6714792317660323}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:44915
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] → sending delta(kind=head bytes=1805) to S11@127.0.0.1:44912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:44910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S13] → sending delta(kind=head bytes=1792) to S10@127.0.0.1:44911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:44902
[S7] not sending this round → trigger blocked (psi=0.749)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:44916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S9] → sending delta(kind=head bytes=1805) to S16@127.0.0.1:44916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:44909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:44909
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:44905
[S2] not sending this round → trigger blocked (psi=0.772)
[S3] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1804 to 1 peers)
[S13] sending update (kind=head size=1792 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1805 to 1 peers)
[S9] sending update (kind=head size=1805 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1805) from S9
[S16] cosine check vs S9: cos=0.4537
[S16] RECEIVED delta(kind=head bytes=1800) from S5
[S16] cosine check vs S5: cos=0.9053
[S8] RECEIVED delta(kind=head bytes=1798) from S6
[S8] cosine check vs S6: cos=0.7885
[S8] RECEIVED delta(kind=head bytes=1804) from S14
[S8] cosine check vs S14: cos=0.6396
[S2] RECEIVED delta(kind=head bytes=1802) from S3
[S2] cosine check vs S3: cos=0.9343
[S11] RECEIVED delta(kind=head bytes=1805) from S4
[S11] cosine check vs S4: cos=0.9946
[S15] RECEIVED delta(kind=head bytes=1797) from S11
[S15] cosine check vs S11: cos=0.9966
[S10] RECEIVED delta(kind=head bytes=1792) from S13
[S10] cosine check vs S13: cos=0.9911
[S9] RECEIVED delta(kind=head bytes=1795) from S10
[S9] cosine check vs S10: cos=0.6626
[S5] RECEIVED delta(kind=head bytes=1798) from S15
[S5] cosine check vs S15: cos=0.9620
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:44903
[S17] sending update (kind=head size=1802 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1802) from S17
[S3] cosine check vs S17: cos=0.4837
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=21 metric=0.6612 head_norm=1.001708
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.583971e-01
[S8] stored merged vector for next round verification (round=21)
[S8] DEBUG after merge:  round=21 metric=0.6209 head_norm=1.002199 delta_norm=0.158397
[S8] aggregate: ROLLBACK (f1_val pre=0.661 post=0.621 tol_abs=0.005 tol_rel=0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=21 metric=0.7630 head_norm=1.320814
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.366556e-01
[S2] stored merged vector for next round verification (round=21)
[S2] DEBUG after merge:  round=21 metric=0.7018 head_norm=1.279343 delta_norm=0.236656
[S2] aggregate: ROLLBACK (f1_val pre=0.763 post=0.702 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=21 metric=0.9960 head_norm=1.810305
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.519247e-01
[S5] stored merged vector for next round verification (round=21)
[S5] DEBUG after merge:  round=21 metric=0.9960 head_norm=1.806610 delta_norm=0.251925
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=21 metric=0.9934 head_norm=1.484274
[S10] _apply_head_vector_avg (torch): Δ‖w‖=9.895707e-02
[S10] stored merged vector for next round verification (round=21)
[S10] DEBUG after merge:  round=21 metric=0.9929 head_norm=1.481186 delta_norm=0.098957
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=21 metric=0.9974 head_norm=1.870414
[S11] _apply_head_vector_avg (torch): Δ‖w‖=9.682337e-02
[S11] stored merged vector for next round verification (round=21)
[S11] DEBUG after merge:  round=21 metric=0.9974 head_norm=1.858430 delta_norm=0.096823
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=21 metric=0.9613 head_norm=1.280975
[S3] _apply_head_vector_avg (torch): Δ‖w‖=8.052979e-01
[S3] stored merged vector for next round verification (round=21)
[S3] DEBUG after merge:  round=21 metric=0.9613 head_norm=1.322419 delta_norm=0.805298
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=21 metric=0.8501 head_norm=1.837772
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.764482e-02
[S15] stored merged vector for next round verification (round=21)
[S15] DEBUG after merge:  round=21 metric=0.8501 head_norm=1.852538 delta_norm=0.077645
[S15] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=21 metric=0.9963 head_norm=1.092277
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.584642e-01
[S9] stored merged vector for next round verification (round=21)
[S9] DEBUG after merge:  round=21 metric=0.9963 head_norm=1.177364 delta_norm=0.558464
[S9] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=21 metric=0.8456 head_norm=1.266545
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.710933e-01
[S16] stored merged vector for next round verification (round=21)
[S16] DEBUG after merge:  round=21 metric=0.8485 head_norm=1.175134 delta_norm=0.171093
[S16] aggregate: ACCEPT kept=['S9', 'S5'] (k=2/2) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=1.279343 cos_to_last_merge=1.0000 (last merge round=21)
[S2] round=22 local utility u=0.000000 metrics={'f1_val': 0.7012333617836406, 'auprc': 0.7791639077527149, 'loss_val': 0.3151769457895768, 'psi': 0.7324055801712703}-{'f1_val': 0.7629875793484006, 'auprc': 0.7842970382793277, 'loss_val': 0.31219667925275324, 'psi': 0.7715113629207715}
[S3] START round=22 head_norm_before_train=1.322419 cos_to_last_merge=1.0000 (last merge round=21)
[S3] round=22 local utility u=0.000000 metrics={'f1_val': 0.9027220888701727, 'auprc': 0.9979752974430104, 'loss_val': 0.23995639642069333, 'psi': 0.9408233722993078}-{'f1_val': 0.961283756324695, 'auprc': 0.9981336968577581, 'loss_val': 0.1762182559651072, 'psi': 0.9760237325379202}
[S4] START round=22 head_norm_before_train=1.851439 (no previous merge yet)
[S4] round=22 local utility u=0.000000 metrics={'f1_val': 0.9426599098977704, 'auprc': 0.9538150288257626, 'loss_val': 0.287164775969712, 'psi': 0.9471219574689673}-{'f1_val': 0.9457993581231305, 'auprc': 0.9724916203270518, 'loss_val': 0.27755397935003306, 'psi': 0.956476263004699}
[S5] START round=22 head_norm_before_train=1.806610 cos_to_last_merge=1.0000 (last merge round=21)
[S5] round=22 local utility u=0.001142 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9967419022791255, 'loss_val': 0.12507530748667384, 'psi': 0.9964083748972368}-{'f1_val': 0.9960402158980539, 'auprc': 0.9928923206673201, 'loss_val': 0.11493481043184317, 'psi': 0.9947810578057604}
[S6] START round=22 head_norm_before_train=1.458470 cos_to_last_merge=0.8021 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.802
[S6] round=22 local utility u=0.000000 metrics={'f1_val': 0.5854928947874366, 'auprc': 0.7896048002810009, 'loss_val': 0.6134056320460806, 'psi': 0.6671376569848624}-{'f1_val': 0.8394500546310489, 'auprc': 0.9727924617501498, 'loss_val': 0.24318401425566638, 'psi': 0.8927870174786893}
[S7] START round=22 head_norm_before_train=1.539701 cos_to_last_merge=0.8543 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.854
[S7] round=22 local utility u=0.000000 metrics={'f1_val': 0.6147202383790289, 'auprc': 0.7940577120958429, 'loss_val': 0.6928405747587606, 'psi': 0.6864552278657545}-{'f1_val': 0.681804890150531, 'auprc': 0.8490430187084639, 'loss_val': 0.43253440392513354, 'psi': 0.7487001415737042}
[S8] START round=22 head_norm_before_train=1.002199 cos_to_last_merge=1.0000 (last merge round=21)
[S8] round=22 local utility u=0.193343 metrics={'f1_val': 0.7139521677339791, 'auprc': 0.9888022166510917, 'loss_val': 0.5189066738453041, 'psi': 0.8238921873008241}-{'f1_val': 0.6611552830106036, 'auprc': 0.9436546013396692, 'loss_val': 0.4533682351162516, 'psi': 0.7741550103422298}
[S9] START round=22 head_norm_before_train=1.177364 cos_to_last_merge=1.0000 (last merge round=21)
[S9] round=22 local utility u=0.000000 metrics={'f1_val': 0.9954158325366191, 'auprc': 0.9982805889515091, 'loss_val': 0.1536676489397523, 'psi': 0.9965617351025751}-{'f1_val': 0.9962500947792776, 'auprc': 0.9935050642492903, 'loss_val': 0.10325220295996984, 'psi': 0.9951520825672827}
[S10] START round=22 head_norm_before_train=1.481186 cos_to_last_merge=1.0000 (last merge round=21)
[S10] round=22 local utility u=0.008731 metrics={'f1_val': 0.9927344652802075, 'auprc': 0.9924099222888466, 'loss_val': 0.26490142025483654, 'psi': 0.9926046480836631}-{'f1_val': 0.9933750578586366, 'auprc': 0.9929960580390796, 'loss_val': 0.2879653834295319, 'psi': 0.9932234579308137}
[S11] START round=22 head_norm_before_train=1.858430 cos_to_last_merge=1.0000 (last merge round=21)
[S11] round=22 local utility u=0.000000 metrics={'f1_val': 0.9974011907167429, 'auprc': 0.9992120470613017, 'loss_val': 0.051677013284390644, 'psi': 0.9981255332545664}-{'f1_val': 0.9974011907167429, 'auprc': 0.999372307263388, 'loss_val': 0.05196168777766086, 'psi': 0.998189637335401}
[S13] START round=22 head_norm_before_train=1.484702 cos_to_last_merge=0.8347 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.835
[S13] round=22 local utility u=0.137830 metrics={'f1_val': 0.6162213385519946, 'auprc': 0.6650909106522217, 'loss_val': 0.6654031358178284, 'psi': 0.6357691673920853}-{'f1_val': 0.578630326587612, 'auprc': 0.6844647857429197, 'loss_val': 0.7736387105359676, 'psi': 0.6209641102497351}
[S14] START round=22 head_norm_before_train=1.258889 cos_to_last_merge=0.9881 (last merge round=19)
[S14] round=22 local utility u=0.041545 metrics={'f1_val': 0.997211058727947, 'auprc': 0.9992259922313174, 'loss_val': 0.2175184480183563, 'psi': 0.9980170321292952}-{'f1_val': 0.9967774409524363, 'auprc': 0.9987418210901191, 'loss_val': 0.2965540639636932, 'psi': 0.9975631930075094}
[S15] START round=22 head_norm_before_train=1.852538 cos_to_last_merge=1.0000 (last merge round=21)
[S15] round=22 local utility u=0.000000 metrics={'f1_val': 0.7023115149824265, 'auprc': 0.9850996296444088, 'loss_val': 0.31486998370813973, 'psi': 0.8154267608472194}-{'f1_val': 0.8500674600504627, 'auprc': 0.9879082556467789, 'loss_val': 0.2142608510816237, 'psi': 0.9052037782889891}
[S16] START round=22 head_norm_before_train=1.175134 cos_to_last_merge=1.0000 (last merge round=21)
[S16] round=22 local utility u=0.495168 metrics={'f1_val': 0.9486471561909586, 'auprc': 0.987517297488662, 'loss_val': 0.3264636262347795, 'psi': 0.9641952127100399}-{'f1_val': 0.8456159122178176, 'auprc': 0.9542981165356006, 'loss_val': 0.5989549241199694, 'psi': 0.8890887939449308}
[S17] START round=22 head_norm_before_train=1.775865 (no previous merge yet)
[S17] round=22 local utility u=0.000000 metrics={'f1_val': 0.5815043973906329, 'auprc': 0.9240973365935738, 'loss_val': 0.7627292736550256, 'psi': 0.7185415730718092}-{'f1_val': 0.5923583641123006, 'auprc': 0.945103128703584, 'loss_val': 0.6121381850222978, 'psi': 0.733456269948814}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:44911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:44916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S8] → sending delta(kind=head bytes=1790) to S9@127.0.0.1:44910
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:44909
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:44910
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:44914
[S16] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1804 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1790 to 1 peers)
[S13] sending update (kind=head size=1795 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1795) from S13
[S10] cosine check vs S13: cos=0.9945
[S16] RECEIVED delta(kind=head bytes=1800) from S5
[S16] cosine check vs S5: cos=0.8677
[S8] RECEIVED delta(kind=head bytes=1804) from S14
[S8] cosine check vs S14: cos=0.6880
[S9] RECEIVED delta(kind=head bytes=1796) from S10
[S9] cosine check vs S10: cos=0.9012
[S9] RECEIVED delta(kind=head bytes=1790) from S8
[S9] cosine check vs S8: cos=0.4100
[S14] RECEIVED delta(kind=head bytes=1800) from S16
[S14] cosine check vs S16: cos=0.9537
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=22 metric=0.9954 head_norm=1.250619
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.403471e-01
[S9] stored merged vector for next round verification (round=22)
[S9] DEBUG after merge:  round=22 metric=0.9954 head_norm=1.080898 delta_norm=0.240347
[S9] aggregate: ACCEPT kept=['S10', 'S8'] (k=2/2) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=22 metric=0.9927 head_norm=1.505215
[S10] _apply_head_vector_avg (torch): Δ‖w‖=7.870803e-02
[S10] stored merged vector for next round verification (round=22)
[S10] DEBUG after merge:  round=22 metric=0.9919 head_norm=1.498361 delta_norm=0.078708
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=22 metric=0.9486 head_norm=1.218111
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.980924e-01
[S16] stored merged vector for next round verification (round=22)
[S16] DEBUG after merge:  round=22 metric=0.9653 head_norm=1.483605 delta_norm=0.498092
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=22 metric=0.7140 head_norm=1.023367
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.774087e-01
[S8] stored merged vector for next round verification (round=22)
[S8] DEBUG after merge:  round=22 metric=0.7140 head_norm=1.070536 delta_norm=0.477409
[S8] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=22 metric=0.9972 head_norm=1.304090
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.966050e-01
[S14] stored merged vector for next round verification (round=22)
[S14] DEBUG after merge:  round=22 metric=0.9968 head_norm=1.246423 delta_norm=0.196605
[S14] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=1.300031 cos_to_last_merge=0.9998 (last merge round=21)
[S2] round=23 local utility u=0.000000 metrics={'f1_val': 0.5509527705090247, 'auprc': 0.7619889976638198, 'loss_val': 1.1205484875185285, 'psi': 0.6353672613709427}-{'f1_val': 0.7012333617836406, 'auprc': 0.7791639077527149, 'loss_val': 0.3151769457895768, 'psi': 0.7324055801712703}
[S3] START round=23 head_norm_before_train=1.381350 cos_to_last_merge=0.9982 (last merge round=21)
[S3] round=23 local utility u=0.224733 metrics={'f1_val': 0.9611152572344858, 'auprc': 0.997580230922271, 'loss_val': 0.1396644603241318, 'psi': 0.9757012467095998}-{'f1_val': 0.9027220888701727, 'auprc': 0.9979752974430104, 'loss_val': 0.23995639642069333, 'psi': 0.9408233722993078}
[S4] START round=23 head_norm_before_train=1.865579 (no previous merge yet)
[S4] round=23 local utility u=0.003561 metrics={'f1_val': 0.9435072751226741, 'auprc': 0.9527439134190143, 'loss_val': 0.28191325003802653, 'psi': 0.9472019304412101}-{'f1_val': 0.9426599098977704, 'auprc': 0.9538150288257626, 'loss_val': 0.287164775969712, 'psi': 0.9471219574689673}
[S5] START round=23 head_norm_before_train=1.847854 cos_to_last_merge=0.9989 (last merge round=21)
[S5] round=23 local utility u=0.017348 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9970542097301729, 'loss_val': 0.09131545842163702, 'psi': 0.9965332978776558}-{'f1_val': 0.996186023309311, 'auprc': 0.9967419022791255, 'loss_val': 0.12507530748667384, 'psi': 0.9964083748972368}
[S6] START round=23 head_norm_before_train=1.464555 cos_to_last_merge=0.8004 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.800
[S6] round=23 local utility u=0.730542 metrics={'f1_val': 0.7937347227101869, 'auprc': 0.8083555438732427, 'loss_val': 0.45802484634803986, 'psi': 0.7995830511754092}-{'f1_val': 0.5854928947874366, 'auprc': 0.7896048002810009, 'loss_val': 0.6134056320460806, 'psi': 0.6671376569848624}
[S7] START round=23 head_norm_before_train=1.545072 cos_to_last_merge=0.8533 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.853
[S7] round=23 local utility u=0.000000 metrics={'f1_val': 0.5910699284817702, 'auprc': 0.7861794203168805, 'loss_val': 0.668481469695221, 'psi': 0.6691137252158144}-{'f1_val': 0.6147202383790289, 'auprc': 0.7940577120958429, 'loss_val': 0.6928405747587606, 'psi': 0.6864552278657545}
[S8] START round=23 head_norm_before_train=1.070536 cos_to_last_merge=1.0000 (last merge round=22)
[S8] round=23 local utility u=0.030569 metrics={'f1_val': 0.7024028196612295, 'auprc': 0.9978151197804737, 'loss_val': 0.41551059872756263, 'psi': 0.8205677397089272}-{'f1_val': 0.7139521677339791, 'auprc': 0.9888022166510917, 'loss_val': 0.5189066738453041, 'psi': 0.8238921873008241}
[S9] START round=23 head_norm_before_train=1.080898 cos_to_last_merge=1.0000 (last merge round=22)
[S9] round=23 local utility u=0.008018 metrics={'f1_val': 0.9947496160742828, 'auprc': 0.998237320170646, 'loss_val': 0.13350500336257462, 'psi': 0.9961446977128281}-{'f1_val': 0.9954158325366191, 'auprc': 0.9982805889515091, 'loss_val': 0.1536676489397523, 'psi': 0.9965617351025751}
[S10] START round=23 head_norm_before_train=1.498361 cos_to_last_merge=1.0000 (last merge round=22)
[S10] round=23 local utility u=0.009344 metrics={'f1_val': 0.9931720938432163, 'auprc': 0.9923969958923741, 'loss_val': 0.24879989811305975, 'psi': 0.9928620546628795}-{'f1_val': 0.9927344652802075, 'auprc': 0.9924099222888466, 'loss_val': 0.26490142025483654, 'psi': 0.9926046480836631}
[S11] START round=23 head_norm_before_train=1.882115 cos_to_last_merge=0.9998 (last merge round=21)
[S11] round=23 local utility u=0.002525 metrics={'f1_val': 0.9974011907167429, 'auprc': 0.998489358551646, 'loss_val': 0.04445953187241478, 'psi': 0.9978364578507042}-{'f1_val': 0.9974011907167429, 'auprc': 0.9992120470613017, 'loss_val': 0.051677013284390644, 'psi': 0.9981255332545664}
[S13] START round=23 head_norm_before_train=1.495623 cos_to_last_merge=0.8340 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.834
[S13] round=23 local utility u=0.000000 metrics={'f1_val': 0.5693964908330806, 'auprc': 0.6928662489582966, 'loss_val': 0.9059895937670954, 'psi': 0.618784394083167}-{'f1_val': 0.6162213385519946, 'auprc': 0.6650909106522217, 'loss_val': 0.6654031358178284, 'psi': 0.6357691673920853}
[S14] START round=23 head_norm_before_train=1.246423 cos_to_last_merge=1.0000 (last merge round=22)
[S14] round=23 local utility u=0.000000 metrics={'f1_val': 0.9971882020035234, 'auprc': 0.9990920462779425, 'loss_val': 0.23560470864611308, 'psi': 0.997949739713291}-{'f1_val': 0.997211058727947, 'auprc': 0.9992259922313174, 'loss_val': 0.2175184480183563, 'psi': 0.9980170321292952}
[S15] START round=23 head_norm_before_train=1.871679 cos_to_last_merge=0.9998 (last merge round=21)
[S15] round=23 local utility u=0.323832 metrics={'f1_val': 0.7958685188622433, 'auprc': 0.9853981708126465, 'loss_val': 0.22944408823073906, 'psi': 0.8716803796424046}-{'f1_val': 0.7023115149824265, 'auprc': 0.9850996296444088, 'loss_val': 0.31486998370813973, 'psi': 0.8154267608472194}
[S16] START round=23 head_norm_before_train=1.483605 cos_to_last_merge=1.0000 (last merge round=22)
[S16] round=23 local utility u=0.000000 metrics={'f1_val': 0.9209379751602705, 'auprc': 0.9870973969044217, 'loss_val': 0.3598349130903386, 'psi': 0.947401743857931}-{'f1_val': 0.9486471561909586, 'auprc': 0.987517297488662, 'loss_val': 0.3264636262347795, 'psi': 0.9641952127100399}
[S17] START round=23 head_norm_before_train=1.804733 (no previous merge yet)
[S17] round=23 local utility u=0.000000 metrics={'f1_val': 0.5851890523277812, 'auprc': 0.8919929913800062, 'loss_val': 0.792685589986689, 'psi': 0.7079106279486711}-{'f1_val': 0.5815043973906329, 'auprc': 0.9240973365935738, 'loss_val': 0.7627292736550256, 'psi': 0.7185415730718092}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:44909
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.821)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:44916
[S5] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:44905
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:44912
[S10] not sending this round → trigger blocked (psi=0.993)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:44902
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:44915
[S4] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1804 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1804) from S9
[S16] cosine check vs S9: cos=0.2819
[S2] RECEIVED delta(kind=head bytes=1800) from S3
[S2] cosine check vs S3: cos=0.8856
[S11] RECEIVED delta(kind=head bytes=1800) from S4
[S11] cosine check vs S4: cos=0.9958
[S15] RECEIVED delta(kind=head bytes=1800) from S11
[S15] cosine check vs S11: cos=0.9965
[S5] RECEIVED delta(kind=head bytes=1797) from S15
[S5] cosine check vs S15: cos=0.9751
[S8] RECEIVED delta(kind=head bytes=1802) from S6
[S8] cosine check vs S6: cos=0.4829
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=23 metric=0.7024 head_norm=1.088240
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.703929e-01
[S8] stored merged vector for next round verification (round=23)
[S8] DEBUG after merge:  round=23 metric=0.7024 head_norm=1.105152 delta_norm=0.670393
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=23 metric=0.5510 head_norm=1.315825
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.338286e-01
[S2] stored merged vector for next round verification (round=23)
[S2] DEBUG after merge:  round=23 metric=0.4172 head_norm=1.335178 delta_norm=0.333829
[S2] aggregate: ROLLBACK (f1_val pre=0.551 post=0.417 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=23 metric=0.9962 head_norm=1.888011
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.110008e-01
[S5] stored merged vector for next round verification (round=23)
[S5] DEBUG after merge:  round=23 metric=0.9962 head_norm=1.878473 delta_norm=0.211001
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=23 metric=0.9209 head_norm=1.519878
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.173958e-01
[S16] stored merged vector for next round verification (round=23)
[S16] DEBUG after merge:  round=23 metric=0.9216 head_norm=1.080841 delta_norm=0.817396
[S16] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=23 metric=0.7959 head_norm=1.892559
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.963187e-02
[S15] stored merged vector for next round verification (round=23)
[S15] DEBUG after merge:  round=23 metric=0.7984 head_norm=1.895664 delta_norm=0.079632
[S15] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=23 metric=0.9974 head_norm=1.902102
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.700451e-02
[S11] stored merged vector for next round verification (round=23)
[S11] DEBUG after merge:  round=23 metric=0.9974 head_norm=1.887799 delta_norm=0.087005
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=1.335178 cos_to_last_merge=1.0000 (last merge round=23)
[S2] round=24 local utility u=0.842018 metrics={'f1_val': 0.7014928908785604, 'auprc': 0.7652338859324608, 'loss_val': 0.3494886383504623, 'psi': 0.7269892889001206}-{'f1_val': 0.5509527705090247, 'auprc': 0.7619889976638198, 'loss_val': 1.1205484875185285, 'psi': 0.6353672613709427}
[S3] START round=24 head_norm_before_train=1.434186 cos_to_last_merge=0.9946 (last merge round=21)
[S3] round=24 local utility u=0.148778 metrics={'f1_val': 0.9971723632406959, 'auprc': 0.9990095543529369, 'loss_val': 0.06273827131647589, 'psi': 0.9979072396855924}-{'f1_val': 0.9611152572344858, 'auprc': 0.997580230922271, 'loss_val': 0.1396644603241318, 'psi': 0.9757012467095998}
[S4] START round=24 head_norm_before_train=1.877424 (no previous merge yet)
[S4] round=24 local utility u=0.000000 metrics={'f1_val': 0.9423264576399994, 'auprc': 0.9487988720166639, 'loss_val': 0.28708531515751234, 'psi': 0.9449154233906653}-{'f1_val': 0.9435072751226741, 'auprc': 0.9527439134190143, 'loss_val': 0.28191325003802653, 'psi': 0.9472019304412101}
[S5] START round=24 head_norm_before_train=1.878473 cos_to_last_merge=1.0000 (last merge round=23)
[S5] round=24 local utility u=0.000000 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9904449169159486, 'loss_val': 0.12371954527600214, 'psi': 0.9938020963052119}-{'f1_val': 0.996186023309311, 'auprc': 0.9970542097301729, 'loss_val': 0.09131545842163702, 'psi': 0.9965332978776558}
[S6] START round=24 head_norm_before_train=1.468778 cos_to_last_merge=0.7995 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.800
[S6] round=24 local utility u=0.372129 metrics={'f1_val': 0.8225966066872317, 'auprc': 0.95939381657612, 'loss_val': 0.34005244863204204, 'psi': 0.877315490642787}-{'f1_val': 0.7937347227101869, 'auprc': 0.8083555438732427, 'loss_val': 0.45802484634803986, 'psi': 0.7995830511754092}
[S7] START round=24 head_norm_before_train=1.546996 cos_to_last_merge=0.8519 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.852
[S7] round=24 local utility u=0.068944 metrics={'f1_val': 0.6014435792495243, 'auprc': 0.7934727943915366, 'loss_val': 0.6147155007753329, 'psi': 0.6782552653063292}-{'f1_val': 0.5910699284817702, 'auprc': 0.7861794203168805, 'loss_val': 0.668481469695221, 'psi': 0.6691137252158144}
[S8] START round=24 head_norm_before_train=1.105152 cos_to_last_merge=1.0000 (last merge round=23)
[S8] round=24 local utility u=0.048586 metrics={'f1_val': 0.7143050385042794, 'auprc': 0.9905312584120683, 'loss_val': 0.3678995923178024, 'psi': 0.824795526467395}-{'f1_val': 0.7024028196612295, 'auprc': 0.9978151197804737, 'loss_val': 0.41551059872756263, 'psi': 0.8205677397089272}
[S9] START round=24 head_norm_before_train=1.167338 cos_to_last_merge=0.9928 (last merge round=22)
[S9] round=24 local utility u=0.019099 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9926807942244845, 'loss_val': 0.08763984229805678, 'psi': 0.9948223745573603}-{'f1_val': 0.9947496160742828, 'auprc': 0.998237320170646, 'loss_val': 0.13350500336257462, 'psi': 0.9961446977128281}
[S10] START round=24 head_norm_before_train=1.525294 cos_to_last_merge=0.9991 (last merge round=22)
[S10] round=24 local utility u=0.035982 metrics={'f1_val': 0.993391017001491, 'auprc': 0.9954734295027985, 'loss_val': 0.18737822325114611, 'psi': 0.994223982002014}-{'f1_val': 0.9931720938432163, 'auprc': 0.9923969958923741, 'loss_val': 0.24879989811305975, 'psi': 0.9928620546628795}
[S11] START round=24 head_norm_before_train=1.887799 cos_to_last_merge=1.0000 (last merge round=23)
[S11] round=24 local utility u=0.000089 metrics={'f1_val': 0.9974011907167429, 'auprc': 0.9992737155101662, 'loss_val': 0.04663555805618014, 'psi': 0.9981502006341123}-{'f1_val': 0.9974011907167429, 'auprc': 0.998489358551646, 'loss_val': 0.04445953187241478, 'psi': 0.9978364578507042}
[S13] START round=24 head_norm_before_train=1.509303 cos_to_last_merge=0.8332 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.833
[S13] round=24 local utility u=0.000000 metrics={'f1_val': 0.559543566354678, 'auprc': 0.7002277079394799, 'loss_val': 0.9754198831665158, 'psi': 0.6158172229885988}-{'f1_val': 0.5693964908330806, 'auprc': 0.6928662489582966, 'loss_val': 0.9059895937670954, 'psi': 0.618784394083167}
[S14] START round=24 head_norm_before_train=1.290343 cos_to_last_merge=0.9984 (last merge round=22)
[S14] round=24 local utility u=0.027532 metrics={'f1_val': 0.9970233560109115, 'auprc': 0.9990958737084997, 'loss_val': 0.1795634492145961, 'psi': 0.9978523630899468}-{'f1_val': 0.9971882020035234, 'auprc': 0.9990920462779425, 'loss_val': 0.23560470864611308, 'psi': 0.997949739713291}
[S15] START round=24 head_norm_before_train=1.895664 cos_to_last_merge=1.0000 (last merge round=23)
[S15] round=24 local utility u=0.000000 metrics={'f1_val': 0.7627749277302985, 'auprc': 0.9855609471470047, 'loss_val': 0.2957324973384024, 'psi': 0.851889335496981}-{'f1_val': 0.7958685188622433, 'auprc': 0.9853981708126465, 'loss_val': 0.22944408823073906, 'psi': 0.8716803796424046}
[S16] START round=24 head_norm_before_train=1.080841 cos_to_last_merge=1.0000 (last merge round=23)
[S16] round=24 local utility u=0.034329 metrics={'f1_val': 0.9326152819147266, 'auprc': 0.991103332429829, 'loss_val': 0.37325894836039214, 'psi': 0.9560105021207675}-{'f1_val': 0.9209379751602705, 'auprc': 0.9870973969044217, 'loss_val': 0.3598349130903386, 'psi': 0.947401743857931}
[S17] START round=24 head_norm_before_train=1.828040 (no previous merge yet)
[S17] round=24 local utility u=0.000000 metrics={'f1_val': 0.584073657330039, 'auprc': 0.8578988983790887, 'loss_val': 0.9017014294867793, 'psi': 0.6936037537496589}-{'f1_val': 0.5851890523277812, 'auprc': 0.8919929913800062, 'loss_val': 0.792685589986689, 'psi': 0.7079106279486711}
[S9] not sending this round → trigger blocked (psi=0.995)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] → sending delta(kind=head bytes=1805) to S15@127.0.0.1:44915
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.998)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:44910
[S3] not sending this round → trigger blocked (psi=0.998)
[S6] not sending this round → trigger blocked (psi=0.877)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:44909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:44910
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:44914
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:44903
[S8] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1804 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1805 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1804) from S14
[S8] cosine check vs S14: cos=0.5652
[S9] RECEIVED delta(kind=head bytes=1797) from S10
[S9] cosine check vs S10: cos=0.8124
[S3] RECEIVED delta(kind=head bytes=1800) from S7
[S3] cosine check vs S7: cos=0.4192
[S9] RECEIVED delta(kind=head bytes=1795) from S8
[S9] cosine check vs S8: cos=0.4973
[S14] RECEIVED delta(kind=head bytes=1800) from S16
[S14] cosine check vs S16: cos=0.9064
[S15] RECEIVED delta(kind=head bytes=1805) from S2
[S15] cosine check vs S2: cos=-0.0430
[S15] DROPPED delta from S2 (cos=-0.0430 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=24 metric=0.9963 head_norm=1.243572
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.415117e-01
[S9] stored merged vector for next round verification (round=24)
[S9] DEBUG after merge:  round=24 metric=0.9963 head_norm=1.093010 delta_norm=0.241512
[S9] aggregate: ACCEPT kept=['S10', 'S8'] (k=2/2) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=24 metric=0.9972 head_norm=1.479534
[S3] _apply_head_vector_avg (torch): Δ‖w‖=8.185157e-01
[S3] stored merged vector for next round verification (round=24)
[S3] DEBUG after merge:  round=24 metric=0.9972 head_norm=1.278733 delta_norm=0.818516
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=24 metric=0.7143 head_norm=1.128183
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.812328e-01
[S8] stored merged vector for next round verification (round=24)
[S8] DEBUG after merge:  round=24 metric=0.7143 head_norm=1.090176 delta_norm=0.581233
[S8] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=24 metric=0.9970 head_norm=1.334104
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.846887e-01
[S14] stored merged vector for next round verification (round=24)
[S14] DEBUG after merge:  round=24 metric=0.9970 head_norm=1.201999 delta_norm=0.284689
[S14] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=25 head_norm_before_train=1.349345 cos_to_last_merge=0.9999 (last merge round=23)
[S2] round=25 local utility u=0.004646 metrics={'f1_val': 0.7365459308334366, 'auprc': 0.7049245382475373, 'loss_val': 0.36958729309763866, 'psi': 0.7238973737990768}-{'f1_val': 0.7014928908785604, 'auprc': 0.7652338859324608, 'loss_val': 0.3494886383504623, 'psi': 0.7269892889001206}
[S3] START round=25 head_norm_before_train=1.278733 cos_to_last_merge=1.0000 (last merge round=24)
[S3] round=25 local utility u=0.000000 metrics={'f1_val': 0.8753278887640018, 'auprc': 0.997850582114014, 'loss_val': 0.3161506819275414, 'psi': 0.9243369661040067}-{'f1_val': 0.9971723632406959, 'auprc': 0.9990095543529369, 'loss_val': 0.06273827131647589, 'psi': 0.9979072396855924}
[S4] START round=25 head_norm_before_train=1.886281 (no previous merge yet)
[S4] round=25 local utility u=0.000000 metrics={'f1_val': 0.9411416733904961, 'auprc': 0.9493081478047668, 'loss_val': 0.2923269913259839, 'psi': 0.9444082631562044}-{'f1_val': 0.9423264576399994, 'auprc': 0.9487988720166639, 'loss_val': 0.28708531515751234, 'psi': 0.9449154233906653}
[S5] START round=25 head_norm_before_train=1.916999 cos_to_last_merge=0.9992 (last merge round=23)
[S5] round=25 local utility u=0.025782 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9924311354679085, 'loss_val': 0.07811331481000208, 'psi': 0.9945965837259958}-{'f1_val': 0.9960402158980539, 'auprc': 0.9904449169159486, 'loss_val': 0.12371954527600214, 'psi': 0.9938020963052119}
[S6] START round=25 head_norm_before_train=1.478194 cos_to_last_merge=0.7981 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.798
[S6] round=25 local utility u=0.000000 metrics={'f1_val': 0.6584147297255313, 'auprc': 0.7992290282714399, 'loss_val': 0.6272066769436139, 'psi': 0.7147404491438947}-{'f1_val': 0.8225966066872317, 'auprc': 0.95939381657612, 'loss_val': 0.34005244863204204, 'psi': 0.877315490642787}
[S7] START round=25 head_norm_before_train=1.556030 cos_to_last_merge=0.8505 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.850
[S7] round=25 local utility u=0.161982 metrics={'f1_val': 0.6372957771655842, 'auprc': 0.803582327392455, 'loss_val': 0.5361928121273042, 'psi': 0.7038103972563325}-{'f1_val': 0.6014435792495243, 'auprc': 0.7934727943915366, 'loss_val': 0.6147155007753329, 'psi': 0.6782552653063292}
[S8] START round=25 head_norm_before_train=1.090176 cos_to_last_merge=1.0000 (last merge round=24)
[S8] round=25 local utility u=0.870147 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9974159596635362, 'loss_val': 0.3405485881156452, 'psi': 0.9967782288267892}-{'f1_val': 0.7143050385042794, 'auprc': 0.9905312584120683, 'loss_val': 0.3678995923178024, 'psi': 0.824795526467395}
[S9] START round=25 head_norm_before_train=1.093010 cos_to_last_merge=1.0000 (last merge round=24)
[S9] round=25 local utility u=0.000000 metrics={'f1_val': 0.9949999422209534, 'auprc': 0.9981480479231803, 'loss_val': 0.11481321527339712, 'psi': 0.9962591845018443}-{'f1_val': 0.9962500947792776, 'auprc': 0.9926807942244845, 'loss_val': 0.08763984229805678, 'psi': 0.9948223745573603}
[S10] START round=25 head_norm_before_train=1.559008 cos_to_last_merge=0.9964 (last merge round=22)
[S10] round=25 local utility u=0.021929 metrics={'f1_val': 0.993391017001491, 'auprc': 0.9957596390208271, 'loss_val': 0.14437834596358565, 'psi': 0.9943384658092254}-{'f1_val': 0.993391017001491, 'auprc': 0.9954734295027985, 'loss_val': 0.18737822325114611, 'psi': 0.994223982002014}
[S11] START round=25 head_norm_before_train=1.905794 cos_to_last_merge=0.9999 (last merge round=23)
[S11] round=25 local utility u=0.001258 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9988988501365896, 'loss_val': 0.04037294016671881, 'psi': 0.9977380940303822}-{'f1_val': 0.9974011907167429, 'auprc': 0.9992737155101662, 'loss_val': 0.04663555805618014, 'psi': 0.9981502006341123}
[S13] START round=25 head_norm_before_train=1.525543 cos_to_last_merge=0.8310 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.831
[S13] round=25 local utility u=0.247941 metrics={'f1_val': 0.6084625886441655, 'auprc': 0.6786503615230399, 'loss_val': 0.7083198985000162, 'psi': 0.6365376977957152}-{'f1_val': 0.559543566354678, 'auprc': 0.7002277079394799, 'loss_val': 0.9754198831665158, 'psi': 0.6158172229885988}
[S14] START round=25 head_norm_before_train=1.201999 cos_to_last_merge=1.0000 (last merge round=24)
[S14] round=25 local utility u=0.000000 metrics={'f1_val': 0.9967774409524363, 'auprc': 0.9992016151404455, 'loss_val': 0.21850712748643394, 'psi': 0.9977471106276399}-{'f1_val': 0.9970233560109115, 'auprc': 0.9990958737084997, 'loss_val': 0.1795634492145961, 'psi': 0.9978523630899468}
[S15] START round=25 head_norm_before_train=1.918828 cos_to_last_merge=0.9998 (last merge round=23)
[S15] round=25 local utility u=0.653977 metrics={'f1_val': 0.9598699362838887, 'auprc': 0.9978749162938108, 'loss_val': 0.207290026976259, 'psi': 0.9750719282878575}-{'f1_val': 0.7627749277302985, 'auprc': 0.9855609471470047, 'loss_val': 0.2957324973384024, 'psi': 0.851889335496981}
[S16] START round=25 head_norm_before_train=1.127771 cos_to_last_merge=0.9984 (last merge round=23)
[S16] round=25 local utility u=0.000000 metrics={'f1_val': 0.8477019489077424, 'auprc': 0.9916760426542921, 'loss_val': 0.593306687159404, 'psi': 0.9052915864063622}-{'f1_val': 0.9326152819147266, 'auprc': 0.991103332429829, 'loss_val': 0.37325894836039214, 'psi': 0.9560105021207675}
[S17] START round=25 head_norm_before_train=1.849270 (no previous merge yet)
[S17] round=25 local utility u=0.000000 metrics={'f1_val': 0.5900116468881941, 'auprc': 0.8478185421422363, 'loss_val': 0.9504808341118389, 'psi': 0.6931344049898109}-{'f1_val': 0.584073657330039, 'auprc': 0.8578988983790887, 'loss_val': 0.9017014294867793, 'psi': 0.6936037537496589}
[S10] not sending this round → trigger blocked (psi=0.994)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] → sending delta(kind=head bytes=1805) to S10@127.0.0.1:44911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:44915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:44905
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.724)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:44916
[S7] not sending this round → trigger blocked (psi=0.704)
[S8] not sending this round → trigger blocked (psi=0.997)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1805 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1797) from S11
[S15] cosine check vs S11: cos=0.9964
[S10] RECEIVED delta(kind=head bytes=1805) from S13
[S10] cosine check vs S13: cos=0.9847
[S5] RECEIVED delta(kind=head bytes=1801) from S15
[S5] cosine check vs S15: cos=0.9822
[S16] RECEIVED delta(kind=head bytes=1803) from S5
[S16] cosine check vs S5: cos=0.7292
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] ⇄ pheromone p=0.031 → S16@127.0.0.1:44916
[S2] ⇄ pheromone p=0.179 → S15@127.0.0.1:44915
[S6] ⇄ pheromone p=0.330 → S8@127.0.0.1:44909
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=25 metric=0.9934 head_norm=1.594836
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.403103e-01
[S10] stored merged vector for next round verification (round=25)
[S10] DEBUG after merge:  round=25 metric=0.9932 head_norm=1.557993 delta_norm=0.140310
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.090 → S9@127.0.0.1:44910
[S8] ⇄ pheromone p=0.305 → S9@127.0.0.1:44910
[S4] ⇄ pheromone p=0.044 → S11@127.0.0.1:44912
[S3] ⇄ pheromone p=0.089 → S2@127.0.0.1:44902
[S7] ⇄ pheromone p=0.151 → S3@127.0.0.1:44903
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=25 metric=0.9960 head_norm=1.958227
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.843222e-01
[S5] stored merged vector for next round verification (round=25)
[S5] DEBUG after merge:  round=25 metric=0.9960 head_norm=1.939763 delta_norm=0.184322
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.064 → S16@127.0.0.1:44916
[S13] ⇄ pheromone p=0.106 → S10@127.0.0.1:44911
[S14] ⇄ pheromone p=0.056 → S8@127.0.0.1:44909
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=25 metric=0.8477 head_norm=1.176786
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.816515e-01
[S16] stored merged vector for next round verification (round=25)
[S16] DEBUG after merge:  round=25 metric=0.8495 head_norm=1.464613 delta_norm=0.681651
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.141 → S14@127.0.0.1:44914
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=25 metric=0.9599 head_norm=1.938726
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.279412e-02
[S15] stored merged vector for next round verification (round=25)
[S15] DEBUG after merge:  round=25 metric=0.9524 head_norm=1.929641 delta_norm=0.082794
[S15] aggregate: ROLLBACK (f1_val pre=0.960 post=0.952 tol_abs=0.005 tol_rel=0.0)
[S15] ⇄ pheromone p=0.283 → S5@127.0.0.1:44905
[S11] ⇄ pheromone p=0.041 → S15@127.0.0.1:44915
[S17] ⇄ pheromone p=0.069 → S3@127.0.0.1:44903
[S2] START round=26 head_norm_before_train=1.364336 cos_to_last_merge=0.9994 (last merge round=23)
[S2] round=26 local utility u=0.385259 metrics={'f1_val': 0.8257166012173324, 'auprc': 0.7654523664349533, 'loss_val': 0.31567680253323627, 'psi': 0.8016109073043807}-{'f1_val': 0.7365459308334366, 'auprc': 0.7049245382475373, 'loss_val': 0.36958729309763866, 'psi': 0.7238973737990768}
[S3] START round=26 head_norm_before_train=1.322530 cos_to_last_merge=0.9990 (last merge round=24)
[S3] round=26 local utility u=0.443925 metrics={'f1_val': 0.9894225981143192, 'auprc': 0.9989943272390547, 'loss_val': 0.11630064998925961, 'psi': 0.9932512897642134}-{'f1_val': 0.8753278887640018, 'auprc': 0.997850582114014, 'loss_val': 0.3161506819275414, 'psi': 0.9243369661040067}
[S4] START round=26 head_norm_before_train=1.894394 (no previous merge yet)
[S4] round=26 local utility u=0.028633 metrics={'f1_val': 0.9448664113013381, 'auprc': 0.9585101831151055, 'loss_val': 0.2850164054506457, 'psi': 0.9503239200268451}-{'f1_val': 0.9411416733904961, 'auprc': 0.9493081478047668, 'loss_val': 0.2923269913259839, 'psi': 0.9444082631562044}
[S5] START round=26 head_norm_before_train=1.939763 cos_to_last_merge=1.0000 (last merge round=25)
[S5] round=26 local utility u=0.000000 metrics={'f1_val': 0.9632739468783837, 'auprc': 0.9901757453534421, 'loss_val': 0.14683188299101083, 'psi': 0.9740346662684071}-{'f1_val': 0.9960402158980539, 'auprc': 0.9924311354679085, 'loss_val': 0.07811331481000208, 'psi': 0.9945965837259958}
[S6] START round=26 head_norm_before_train=1.494141 cos_to_last_merge=0.7945 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.795
[S6] round=26 local utility u=1.000000 metrics={'f1_val': 0.9601456592274974, 'auprc': 0.9722489588670716, 'loss_val': 0.16305857304010246, 'psi': 0.9649869790833272}-{'f1_val': 0.6584147297255313, 'auprc': 0.7992290282714399, 'loss_val': 0.6272066769436139, 'psi': 0.7147404491438947}
[S7] START round=26 head_norm_before_train=1.568524 cos_to_last_merge=0.8492 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.849
[S7] round=26 local utility u=0.000000 metrics={'f1_val': 0.5092846359344614, 'auprc': 0.781047329315153, 'loss_val': 0.86075312131446, 'psi': 0.617989713286738}-{'f1_val': 0.6372957771655842, 'auprc': 0.803582327392455, 'loss_val': 0.5361928121273042, 'psi': 0.7038103972563325}
[S8] START round=26 head_norm_before_train=1.109630 cos_to_last_merge=0.9995 (last merge round=24)
[S8] round=26 local utility u=0.022641 metrics={'f1_val': 0.9950790219939822, 'auprc': 0.9958278993679823, 'loss_val': 0.28285841281005625, 'psi': 0.9953785729435822}-{'f1_val': 0.9963530749356245, 'auprc': 0.9974159596635362, 'loss_val': 0.3405485881156452, 'psi': 0.9967782288267892}
[S9] START round=26 head_norm_before_train=1.159356 cos_to_last_merge=0.9975 (last merge round=24)
[S9] round=26 local utility u=0.009395 metrics={'f1_val': 0.9931107490075115, 'auprc': 0.9984109471317693, 'loss_val': 0.0854775616927036, 'psi': 0.9952308282572145}-{'f1_val': 0.9949999422209534, 'auprc': 0.9981480479231803, 'loss_val': 0.11481321527339712, 'psi': 0.9962591845018443}
[S10] START round=26 head_norm_before_train=1.557993 cos_to_last_merge=1.0000 (last merge round=25)
[S10] round=26 local utility u=0.000000 metrics={'f1_val': 0.9929289500455621, 'auprc': 0.9958614314740493, 'loss_val': 0.16260838292408727, 'psi': 0.9941019426169571}-{'f1_val': 0.993391017001491, 'auprc': 0.9957596390208271, 'loss_val': 0.14437834596358565, 'psi': 0.9943384658092254}
[S11] START round=26 head_norm_before_train=1.924080 cos_to_last_merge=0.9996 (last merge round=23)
[S11] round=26 local utility u=0.002490 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9988842988809605, 'loss_val': 0.03534926920723113, 'psi': 0.9977322735281304}-{'f1_val': 0.9969642566262439, 'auprc': 0.9988988501365896, 'loss_val': 0.04037294016671881, 'psi': 0.9977380940303822}
[S13] START round=26 head_norm_before_train=1.533151 cos_to_last_merge=0.8298 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.830
[S13] round=26 local utility u=0.000000 metrics={'f1_val': 0.5997380697373556, 'auprc': 0.6884513611985225, 'loss_val': 0.784039943745309, 'psi': 0.6352233863218224}-{'f1_val': 0.6084625886441655, 'auprc': 0.6786503615230399, 'loss_val': 0.7083198985000162, 'psi': 0.6365376977957152}
[S14] START round=26 head_norm_before_train=1.242574 cos_to_last_merge=0.9987 (last merge round=24)
[S14] round=26 local utility u=0.026264 metrics={'f1_val': 0.9973794582448391, 'auprc': 0.9990099386016125, 'loss_val': 0.16901719978288238, 'psi': 0.9980316503875484}-{'f1_val': 0.9967774409524363, 'auprc': 0.9992016151404455, 'loss_val': 0.21850712748643394, 'psi': 0.9977471106276399}
[S15] START round=26 head_norm_before_train=1.929641 cos_to_last_merge=1.0000 (last merge round=25)
[S15] round=26 local utility u=0.000000 metrics={'f1_val': 0.7010704228661029, 'auprc': 0.9844163954225034, 'loss_val': 0.39775520972493533, 'psi': 0.8144088118886631}-{'f1_val': 0.9598699362838887, 'auprc': 0.9978749162938108, 'loss_val': 0.207290026976259, 'psi': 0.9750719282878575}
[S16] START round=26 head_norm_before_train=1.464613 cos_to_last_merge=1.0000 (last merge round=25)
[S16] round=26 local utility u=0.311077 metrics={'f1_val': 0.9161457643137887, 'auprc': 0.985438799392311, 'loss_val': 0.3631032136737191, 'psi': 0.9438629783451976}-{'f1_val': 0.8477019489077424, 'auprc': 0.9916760426542921, 'loss_val': 0.593306687159404, 'psi': 0.9052915864063622}
[S17] START round=26 head_norm_before_train=1.868668 (no previous merge yet)
[S17] round=26 local utility u=0.000000 metrics={'f1_val': 0.5908991684386341, 'auprc': 0.8424791912391383, 'loss_val': 0.9899389537860782, 'psi': 0.6915311775588358}-{'f1_val': 0.5900116468881941, 'auprc': 0.8478185421422363, 'loss_val': 0.9504808341118389, 'psi': 0.6931344049898109}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S4] sending update (kind=head size=1806 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:44907
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:44916
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:44909
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:44908
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:44904
[S11] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1804 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1803) from S9
[S8] cosine check vs S9: cos=0.6026
[S4] RECEIVED delta(kind=head bytes=1796) from S11
[S4] cosine check vs S11: cos=0.9957
[S7] RECEIVED delta(kind=head bytes=1798) from S3
[S7] cosine check vs S3: cos=0.8236
[S16] RECEIVED delta(kind=head bytes=1804) from S14
[S16] cosine check vs S14: cos=0.9000
[S6] RECEIVED delta(kind=head bytes=1796) from S8
[S6] cosine check vs S8: cos=0.5836
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:44905
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1799 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1799) from S16
[S5] cosine check vs S16: cos=0.9489
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:44903
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1798) from S2
[S3] cosine check vs S2: cos=0.9426
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=26 metric=0.5093 head_norm=1.580518
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.494202e-01
[S7] stored merged vector for next round verification (round=26)
[S7] DEBUG after merge:  round=26 metric=0.4803 head_norm=1.408129 delta_norm=0.449420
[S7] aggregate: ROLLBACK (f1_val pre=0.509 post=0.480 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=26 metric=0.9633 head_norm=1.975297
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.624866e-01
[S5] stored merged vector for next round verification (round=26)
[S5] DEBUG after merge:  round=26 metric=0.9475 head_norm=1.717852 delta_norm=0.362487
[S5] aggregate: ROLLBACK (f1_val pre=0.963 post=0.947 tol_abs=0.005 tol_rel=0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=26 metric=0.9449 head_norm=1.908369
[S4] _apply_head_vector_avg (torch): Δ‖w‖=9.049034e-02
[S4] stored merged vector for next round verification (round=26)
[S4] DEBUG after merge:  round=26 metric=0.9446 head_norm=1.923439 delta_norm=0.090490
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=26 metric=0.9601 head_norm=1.509692
[S6] _apply_head_vector_avg (torch): Δ‖w‖=6.264672e-01
[S6] stored merged vector for next round verification (round=26)
[S6] DEBUG after merge:  round=26 metric=0.9595 head_norm=1.181835 delta_norm=0.626467
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=26 metric=0.9951 head_norm=1.139832
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.281780e-01
[S8] stored merged vector for next round verification (round=26)
[S8] DEBUG after merge:  round=26 metric=0.7033 head_norm=1.058073 delta_norm=0.528178
[S8] aggregate: ROLLBACK (f1_val pre=0.995 post=0.703 tol_abs=0.005 tol_rel=0.0)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=26 metric=0.9894 head_norm=1.368055
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.329468e-01
[S3] stored merged vector for next round verification (round=26)
[S3] DEBUG after merge:  round=26 metric=0.9909 head_norm=1.355058 delta_norm=0.232947
[S3] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=26 metric=0.9161 head_norm=1.504337
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.294786e-01
[S16] stored merged vector for next round verification (round=26)
[S16] DEBUG after merge:  round=26 metric=0.9161 head_norm=1.361448 delta_norm=0.329479
[S16] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=27 head_norm_before_train=1.381782 cos_to_last_merge=0.9986 (last merge round=23)
[S2] round=27 local utility u=0.131631 metrics={'f1_val': 0.827571963755849, 'auprc': 0.8385950914916989, 'loss_val': 0.282975558620253, 'psi': 0.8319812148501889}-{'f1_val': 0.8257166012173324, 'auprc': 0.7654523664349533, 'loss_val': 0.31567680253323627, 'psi': 0.8016109073043807}
[S3] START round=27 head_norm_before_train=1.355058 cos_to_last_merge=1.0000 (last merge round=26)
[S3] round=27 local utility u=0.000000 metrics={'f1_val': 0.9702499221125177, 'auprc': 0.9994536101240523, 'loss_val': 0.09934095938593628, 'psi': 0.9819313973171315}-{'f1_val': 0.9894225981143192, 'auprc': 0.9989943272390547, 'loss_val': 0.11630064998925961, 'psi': 0.9932512897642134}
[S4] START round=27 head_norm_before_train=1.923439 cos_to_last_merge=1.0000 (last merge round=26)
[S4] round=27 local utility u=0.049591 metrics={'f1_val': 0.9483280481338919, 'auprc': 0.977035543133393, 'loss_val': 0.2621804684930743, 'psi': 0.9598110461336924}-{'f1_val': 0.9448664113013381, 'auprc': 0.9585101831151055, 'loss_val': 0.2850164054506457, 'psi': 0.9503239200268451}
[S5] START round=27 head_norm_before_train=1.717852 cos_to_last_merge=1.0000 (last merge round=26)
[S5] round=27 local utility u=0.127273 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9907197385568973, 'loss_val': 0.0905149341481896, 'psi': 0.9939120249615914}-{'f1_val': 0.9632739468783837, 'auprc': 0.9901757453534421, 'loss_val': 0.14683188299101083, 'psi': 0.9740346662684071}
[S6] START round=27 head_norm_before_train=1.181835 cos_to_last_merge=1.0000 (last merge round=26)
[S6] round=27 local utility u=0.000000 metrics={'f1_val': 0.717267873888643, 'auprc': 0.8484001386807942, 'loss_val': 0.5687238536190891, 'psi': 0.7697207798055035}-{'f1_val': 0.9601456592274974, 'auprc': 0.9722489588670716, 'loss_val': 0.16305857304010246, 'psi': 0.9649869790833272}
[S7] START round=27 head_norm_before_train=1.408129 cos_to_last_merge=1.0000 (last merge round=26)
[S7] round=27 local utility u=0.000000 metrics={'f1_val': 0.44321555999175943, 'auprc': 0.7802880673791905, 'loss_val': 0.9355655931007495, 'psi': 0.5780445629467319}-{'f1_val': 0.5092846359344614, 'auprc': 0.781047329315153, 'loss_val': 0.86075312131446, 'psi': 0.617989713286738}
[S8] START round=27 head_norm_before_train=1.058073 cos_to_last_merge=1.0000 (last merge round=26)
[S8] round=27 local utility u=0.009879 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9971031368241687, 'loss_val': 0.27457014506560734, 'psi': 0.9966530996910423}-{'f1_val': 0.9950790219939822, 'auprc': 0.9958278993679823, 'loss_val': 0.28285841281005625, 'psi': 0.9953785729435822}
[S9] START round=27 head_norm_before_train=1.223832 cos_to_last_merge=0.9923 (last merge round=24)
[S9] round=27 local utility u=0.017308 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9955453211737321, 'loss_val': 0.06356266886652662, 'psi': 0.9962144355578277}-{'f1_val': 0.9931107490075115, 'auprc': 0.9984109471317693, 'loss_val': 0.0854775616927036, 'psi': 0.9952308282572145}
[S10] START round=27 head_norm_before_train=1.588368 cos_to_last_merge=0.9994 (last merge round=25)
[S10] round=27 local utility u=0.014592 metrics={'f1_val': 0.9931720938432163, 'auprc': 0.9954084868694908, 'loss_val': 0.1335236447472096, 'psi': 0.9940666510537262}-{'f1_val': 0.9929289500455621, 'auprc': 0.9958614314740493, 'loss_val': 0.16260838292408727, 'psi': 0.9941019426169571}
[S11] START round=27 head_norm_before_train=1.942612 cos_to_last_merge=0.9991 (last merge round=23)
[S11] round=27 local utility u=0.000815 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9980834014061756, 'loss_val': 0.031315672880827934, 'psi': 0.9974119145382165}-{'f1_val': 0.9969642566262439, 'auprc': 0.9988842988809605, 'loss_val': 0.03534926920723113, 'psi': 0.9977322735281304}
[S13] START round=27 head_norm_before_train=1.540156 cos_to_last_merge=0.8295 (last merge round=1)
[S13] ⚠️ Model drifted since last merge! cos=0.830
[S13] round=27 local utility u=0.000000 metrics={'f1_val': 0.5239009222330228, 'auprc': 0.709520013017307, 'loss_val': 0.9559775232860003, 'psi': 0.5981485585467365}-{'f1_val': 0.5997380697373556, 'auprc': 0.6884513611985225, 'loss_val': 0.784039943745309, 'psi': 0.6352233863218224}
[S14] START round=27 head_norm_before_train=1.288861 cos_to_last_merge=0.9950 (last merge round=24)
[S14] round=27 local utility u=0.016735 metrics={'f1_val': 0.9965574496053289, 'auprc': 0.9990074523949912, 'loss_val': 0.13060823529222376, 'psi': 0.9975374507211938}-{'f1_val': 0.9973794582448391, 'auprc': 0.9990099386016125, 'loss_val': 0.16901719978288238, 'psi': 0.9980316503875484}
[S15] START round=27 head_norm_before_train=1.941429 cos_to_last_merge=0.9999 (last merge round=25)
[S15] round=27 local utility u=1.000000 metrics={'f1_val': 0.9971172535281002, 'auprc': 0.9985870437299383, 'loss_val': 0.0874829485608222, 'psi': 0.9977051696088355}-{'f1_val': 0.7010704228661029, 'auprc': 0.9844163954225034, 'loss_val': 0.39775520972493533, 'psi': 0.8144088118886631}
[S16] START round=27 head_norm_before_train=1.361448 cos_to_last_merge=1.0000 (last merge round=26)
[S16] round=27 local utility u=0.116363 metrics={'f1_val': 0.9373910313808391, 'auprc': 0.9893909894578063, 'loss_val': 0.2697044068776226, 'psi': 0.9581910146116259}-{'f1_val': 0.9161457643137887, 'auprc': 0.985438799392311, 'loss_val': 0.3631032136737191, 'psi': 0.9438629783451976}
[S17] START round=27 head_norm_before_train=1.885967 (no previous merge yet)
[S17] round=27 local utility u=0.000000 metrics={'f1_val': 0.5908926886033465, 'auprc': 0.8246299272533131, 'loss_val': 1.0440901136117358, 'psi': 0.6843875840633331}-{'f1_val': 0.5908991684386341, 'auprc': 0.8424791912391383, 'loss_val': 0.9899389537860782, 'psi': 0.6915311775588358}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:44913
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S9] → sending delta(kind=head bytes=1805) to S8@127.0.0.1:44909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] → sending delta(kind=head bytes=1804) to S3@127.0.0.1:44903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:44907
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S4@127.0.0.1:44904
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:44916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:44902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:44915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:44905
[S5] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1794 to 1 peers)
[S2] sending update (kind=head size=1804 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1805 to 1 peers)
[S16] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1803) from S14
[S16] cosine check vs S14: cos=0.9650
[S6] RECEIVED delta(kind=head bytes=1796) from S8
[S6] cosine check vs S8: cos=0.7957
[S4] RECEIVED delta(kind=head bytes=1794) from S11
[S4] cosine check vs S11: cos=0.9982
[S2] RECEIVED delta(kind=head bytes=1798) from S15
[S2] cosine check vs S15: cos=-0.0425
[S2] DROPPED delta from S15 (cos=-0.0425 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1803) from S5
[S15] cosine check vs S5: cos=0.9684
[S13] RECEIVED delta(kind=head bytes=1798) from S10
[S13] cosine check vs S10: cos=0.9887
[S3] RECEIVED delta(kind=head bytes=1804) from S2
[S3] cosine check vs S2: cos=0.9862
[S5] RECEIVED delta(kind=head bytes=1803) from S16
[S5] cosine check vs S16: cos=0.9291
[S8] RECEIVED delta(kind=head bytes=1805) from S9
[S8] cosine check vs S9: cos=0.8934
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=27 metric=0.5239 head_norm=1.543718
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.240391e-01
[S13] stored merged vector for next round verification (round=27)
[S13] DEBUG after merge:  round=27 metric=0.5523 head_norm=1.574671 delta_norm=0.124039
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=27 metric=0.9702 head_norm=1.398245
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.164912e-01
[S3] stored merged vector for next round verification (round=27)
[S3] DEBUG after merge:  round=27 metric=0.9716 head_norm=1.397562 delta_norm=0.116491
[S3] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=27 metric=0.7173 head_norm=1.200990
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.704044e-01
[S6] stored merged vector for next round verification (round=27)
[S6] DEBUG after merge:  round=27 metric=0.6955 head_norm=1.088091 delta_norm=0.370404
[S6] aggregate: ROLLBACK (f1_val pre=0.717 post=0.695 tol_abs=0.005 tol_rel=0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=27 metric=0.9483 head_norm=1.932224
[S4] _apply_head_vector_avg (torch): Δ‖w‖=6.042741e-02
[S4] stored merged vector for next round verification (round=27)
[S4] DEBUG after merge:  round=27 metric=0.9489 head_norm=1.945734 delta_norm=0.060427
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=27 metric=0.9374 head_norm=1.402940
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.843037e-01
[S16] stored merged vector for next round verification (round=27)
[S16] DEBUG after merge:  round=27 metric=0.9374 head_norm=1.356459 delta_norm=0.184304
[S16] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=27 metric=0.9960 head_norm=1.751179
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.426006e-01
[S5] stored merged vector for next round verification (round=27)
[S5] DEBUG after merge:  round=27 metric=0.9960 head_norm=1.549213 delta_norm=0.342601
[S5] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=27 metric=0.9971 head_norm=1.955079
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.539646e-01
[S15] stored merged vector for next round verification (round=27)
[S15] DEBUG after merge:  round=27 metric=0.9971 head_norm=1.838473 delta_norm=0.253965
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=27 metric=0.9964 head_norm=1.095402
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.865975e-01
[S8] stored merged vector for next round verification (round=27)
[S8] DEBUG after merge:  round=27 metric=0.7009 head_norm=1.152071 delta_norm=0.286597
[S8] aggregate: ROLLBACK (f1_val pre=0.996 post=0.701 tol_abs=0.005 tol_rel=0.0)
[S2] START round=28 head_norm_before_train=1.406559 cos_to_last_merge=0.9971 (last merge round=23)
[S2] round=28 local utility u=0.029711 metrics={'f1_val': 0.8382860398757488, 'auprc': 0.8339381537283154, 'loss_val': 0.273866710462419, 'psi': 0.8365468854167755}-{'f1_val': 0.827571963755849, 'auprc': 0.8385950914916989, 'loss_val': 0.282975558620253, 'psi': 0.8319812148501889}
[S3] START round=28 head_norm_before_train=1.397562 cos_to_last_merge=1.0000 (last merge round=27)
[S3] round=28 local utility u=0.000000 metrics={'f1_val': 0.815098949177448, 'auprc': 0.9978393258394413, 'loss_val': 0.3908090390888549, 'psi': 0.8881950998422453}-{'f1_val': 0.9702499221125177, 'auprc': 0.9994536101240523, 'loss_val': 0.09934095938593628, 'psi': 0.9819313973171315}
[S4] START round=28 head_norm_before_train=1.945734 cos_to_last_merge=1.0000 (last merge round=27)
[S4] round=28 local utility u=0.000000 metrics={'f1_val': 0.9408634919980803, 'auprc': 0.9492161174637159, 'loss_val': 0.301742780059057, 'psi': 0.9442045421843345}-{'f1_val': 0.9483280481338919, 'auprc': 0.977035543133393, 'loss_val': 0.2621804684930743, 'psi': 0.9598110461336924}
[S5] START round=28 head_norm_before_train=1.549213 cos_to_last_merge=1.0000 (last merge round=27)
[S5] round=28 local utility u=0.002819 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9909349391260907, 'loss_val': 0.0855234854463435, 'psi': 0.9939981051892687}-{'f1_val': 0.9960402158980539, 'auprc': 0.9907197385568973, 'loss_val': 0.0905149341481896, 'psi': 0.9939120249615914}
[S6] START round=28 head_norm_before_train=1.088091 cos_to_last_merge=1.0000 (last merge round=27)
[S6] round=28 local utility u=1.000000 metrics={'f1_val': 0.9608366600265781, 'auprc': 0.9630533490714412, 'loss_val': 0.3226272152013167, 'psi': 0.9617233356445234}-{'f1_val': 0.717267873888643, 'auprc': 0.8484001386807942, 'loss_val': 0.5687238536190891, 'psi': 0.7697207798055035}
[S7] START round=28 head_norm_before_train=1.418294 cos_to_last_merge=1.0000 (last merge round=26)
[S7] round=28 local utility u=0.607685 metrics={'f1_val': 0.5945821246182081, 'auprc': 0.7891289867351805, 'loss_val': 0.6549184396849638, 'psi': 0.6724008694649971}-{'f1_val': 0.44321555999175943, 'auprc': 0.7802880673791905, 'loss_val': 0.9355655931007495, 'psi': 0.5780445629467319}
[S8] START round=28 head_norm_before_train=1.152071 cos_to_last_merge=1.0000 (last merge round=27)
[S8] round=28 local utility u=0.014679 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9976038304518622, 'loss_val': 0.24671384566624988, 'psi': 0.9968533771421196}-{'f1_val': 0.9963530749356245, 'auprc': 0.9971031368241687, 'loss_val': 0.27457014506560734, 'psi': 0.9966530996910423}
[S9] START round=28 head_norm_before_train=1.272361 cos_to_last_merge=0.9876 (last merge round=24)
[S9] round=28 local utility u=0.009450 metrics={'f1_val': 0.9966891482978385, 'auprc': 0.9983938328448615, 'loss_val': 0.053379132989602035, 'psi': 0.9973710221166477}-{'f1_val': 0.9966605118138915, 'auprc': 0.9955453211737321, 'loss_val': 0.06356266886652662, 'psi': 0.9962144355578277}
[S10] START round=28 head_norm_before_train=1.614584 cos_to_last_merge=0.9982 (last merge round=25)
[S10] round=28 local utility u=0.010612 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9943666262477548, 'loss_val': 0.11731668397184764, 'psi': 0.9944641145781385}-{'f1_val': 0.9931720938432163, 'auprc': 0.9954084868694908, 'loss_val': 0.1335236447472096, 'psi': 0.9940666510537262}
[S11] START round=28 head_norm_before_train=1.961015 cos_to_last_merge=0.9984 (last merge round=23)
[S11] round=28 local utility u=0.002120 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9984743903094531, 'loss_val': 0.028247714488247297, 'psi': 0.9975683100995275}-{'f1_val': 0.9969642566262439, 'auprc': 0.9980834014061756, 'loss_val': 0.031315672880827934, 'psi': 0.9974119145382165}
[S13] START round=28 head_norm_before_train=1.574671 cos_to_last_merge=1.0000 (last merge round=27)
[S13] round=28 local utility u=0.358190 metrics={'f1_val': 0.6084110862646279, 'auprc': 0.6789307064345349, 'loss_val': 0.6548903227070678, 'psi': 0.6366189343325908}-{'f1_val': 0.5239009222330228, 'auprc': 0.709520013017307, 'loss_val': 0.9559775232860003, 'psi': 0.5981485585467365}
[S14] START round=28 head_norm_before_train=1.334037 cos_to_last_merge=0.9904 (last merge round=24)
[S14] round=28 local utility u=0.012397 metrics={'f1_val': 0.9965652232429598, 'auprc': 0.9991098405280767, 'loss_val': 0.10616731754392542, 'psi': 0.9975830701570066}-{'f1_val': 0.9965574496053289, 'auprc': 0.9990074523949912, 'loss_val': 0.13060823529222376, 'psi': 0.9975374507211938}
[S15] START round=28 head_norm_before_train=1.838473 cos_to_last_merge=1.0000 (last merge round=27)
[S15] round=28 local utility u=0.000000 metrics={'f1_val': 0.7009169771696235, 'auprc': 0.9881206941209948, 'loss_val': 0.3767408443692977, 'psi': 0.8157984639501721}-{'f1_val': 0.9971172535281002, 'auprc': 0.9985870437299383, 'loss_val': 0.0874829485608222, 'psi': 0.9977051696088355}
[S16] START round=28 head_norm_before_train=1.356459 cos_to_last_merge=1.0000 (last merge round=27)
[S16] round=28 local utility u=0.000000 metrics={'f1_val': 0.877655904414033, 'auprc': 0.9896309692981695, 'loss_val': 0.456622236712687, 'psi': 0.9224459303676875}-{'f1_val': 0.9373910313808391, 'auprc': 0.9893909894578063, 'loss_val': 0.2697044068776226, 'psi': 0.9581910146116259}
[S17] START round=28 head_norm_before_train=1.900355 (no previous merge yet)
[S17] round=28 local utility u=0.171161 metrics={'f1_val': 0.5885563697432485, 'auprc': 0.9135780252980404, 'loss_val': 0.9545938758162473, 'psi': 0.7185650319651653}-{'f1_val': 0.5908926886033465, 'auprc': 0.8246299272533131, 'loss_val': 1.0440901136117358, 'psi': 0.6843875840633331}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:44913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:44903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:44907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:44916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:44909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:44915
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:44904
[S5] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1804 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1798) from S14
[S16] cosine check vs S14: cos=0.9866
[S4] RECEIVED delta(kind=head bytes=1799) from S11
[S4] cosine check vs S11: cos=0.9991
[S15] RECEIVED delta(kind=head bytes=1798) from S5
[S15] cosine check vs S5: cos=0.9579
[S8] RECEIVED delta(kind=head bytes=1804) from S9
[S8] cosine check vs S9: cos=0.9665
[S13] RECEIVED delta(kind=head bytes=1799) from S10
[S13] cosine check vs S10: cos=0.9947
[S6] RECEIVED delta(kind=head bytes=1800) from S8
[S6] cosine check vs S8: cos=0.8742
[S3] RECEIVED delta(kind=head bytes=1799) from S2
[S3] cosine check vs S2: cos=0.9957
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=28 metric=0.7009 head_norm=1.848979
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.806229e-01
[S15] stored merged vector for next round verification (round=28)
[S15] DEBUG after merge:  round=28 metric=0.7009 head_norm=1.700943 delta_norm=0.280623
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=28 metric=0.6084 head_norm=1.578489
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.937636e-02
[S13] stored merged vector for next round verification (round=28)
[S13] DEBUG after merge:  round=28 metric=0.6130 head_norm=1.609754 delta_norm=0.089376
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=28 metric=0.9409 head_norm=1.953529
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.375970e-02
[S4] stored merged vector for next round verification (round=28)
[S4] DEBUG after merge:  round=28 metric=0.9413 head_norm=1.965513 delta_norm=0.043760
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=28 metric=0.8151 head_norm=1.435038
[S3] _apply_head_vector_avg (torch): Δ‖w‖=6.618726e-02
[S3] stored merged vector for next round verification (round=28)
[S3] DEBUG after merge:  round=28 metric=0.8165 head_norm=1.431453 delta_norm=0.066187
[S3] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=28 metric=0.9608 head_norm=1.116842
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.911322e-01
[S6] stored merged vector for next round verification (round=28)
[S6] DEBUG after merge:  round=28 metric=0.9610 head_norm=1.115939 delta_norm=0.291132
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=28 metric=0.8777 head_norm=1.394350
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.136247e-01
[S16] stored merged vector for next round verification (round=28)
[S16] DEBUG after merge:  round=28 metric=0.8779 head_norm=1.380065 delta_norm=0.113625
[S16] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=28 metric=0.9964 head_norm=1.188620
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.733198e-01
[S8] stored merged vector for next round verification (round=28)
[S8] DEBUG after merge:  round=28 metric=0.7009 head_norm=1.240305 delta_norm=0.173320
[S8] aggregate: ROLLBACK (f1_val pre=0.996 post=0.701 tol_abs=0.005 tol_rel=0.0)
[S2] START round=29 head_norm_before_train=1.430923 cos_to_last_merge=0.9953 (last merge round=23)
[S2] round=29 local utility u=0.013040 metrics={'f1_val': 0.8340992233600593, 'auprc': 0.8473625488641127, 'loss_val': 0.2629388154168929, 'psi': 0.8394045535616805}-{'f1_val': 0.8382860398757488, 'auprc': 0.8339381537283154, 'loss_val': 0.273866710462419, 'psi': 0.8365468854167755}
[S3] START round=29 head_norm_before_train=1.431453 cos_to_last_merge=1.0000 (last merge round=28)
[S3] round=29 local utility u=0.136545 metrics={'f1_val': 0.8457941287740618, 'auprc': 0.9979949091084573, 'loss_val': 0.3023564005771623, 'psi': 0.90667444090782}-{'f1_val': 0.815098949177448, 'auprc': 0.9978393258394413, 'loss_val': 0.3908090390888549, 'psi': 0.8881950998422453}
[S4] START round=29 head_norm_before_train=1.965513 cos_to_last_merge=1.0000 (last merge round=28)
[S4] round=29 local utility u=0.011920 metrics={'f1_val': 0.9416460277263521, 'auprc': 0.9518162460792454, 'loss_val': 0.2903988721851768, 'psi': 0.9457141150675095}-{'f1_val': 0.9408634919980803, 'auprc': 0.9492161174637159, 'loss_val': 0.301742780059057, 'psi': 0.9442045421843345}
[S5] START round=29 head_norm_before_train=1.589084 cos_to_last_merge=0.9994 (last merge round=27)
[S5] round=29 local utility u=0.014161 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9933596305776291, 'loss_val': 0.0644749557129858, 'psi': 0.994967981769884}-{'f1_val': 0.9960402158980539, 'auprc': 0.9909349391260907, 'loss_val': 0.0855234854463435, 'psi': 0.9939981051892687}
[S6] START round=29 head_norm_before_train=1.115939 cos_to_last_merge=1.0000 (last merge round=28)
[S6] round=29 local utility u=0.000000 metrics={'f1_val': 0.9456051761670068, 'auprc': 0.9655993719410504, 'loss_val': 0.33009225862167707, 'psi': 0.9536028544766243}-{'f1_val': 0.9608366600265781, 'auprc': 0.9630533490714412, 'loss_val': 0.3226272152013167, 'psi': 0.9617233356445234}
[S7] START round=29 head_norm_before_train=1.428300 cos_to_last_merge=0.9999 (last merge round=26)
[S7] round=29 local utility u=0.224084 metrics={'f1_val': 0.6482734086787418, 'auprc': 0.7966068689975445, 'loss_val': 0.5513324885842948, 'psi': 0.7076067928062629}-{'f1_val': 0.5945821246182081, 'auprc': 0.7891289867351805, 'loss_val': 0.6549184396849638, 'psi': 0.6724008694649971}
[S8] START round=29 head_norm_before_train=1.240305 cos_to_last_merge=1.0000 (last merge round=28)
[S8] round=29 local utility u=0.018365 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9988114102084676, 'loss_val': 0.21270737838475542, 'psi': 0.9972464261234788}-{'f1_val': 0.9963530749356245, 'auprc': 0.9976038304518622, 'loss_val': 0.24671384566624988, 'psi': 0.9968533771421196}
[S9] START round=29 head_norm_before_train=1.313001 cos_to_last_merge=0.9834 (last merge round=24)
[S9] round=29 local utility u=0.000000 metrics={'f1_val': 0.9910040044536889, 'auprc': 0.998419026208672, 'loss_val': 0.0536335225291033, 'psi': 0.9939700131556821}-{'f1_val': 0.9966891482978385, 'auprc': 0.9983938328448615, 'loss_val': 0.053379132989602035, 'psi': 0.9973710221166477}
[S10] START round=29 head_norm_before_train=1.645286 cos_to_last_merge=0.9961 (last merge round=25)
[S10] round=29 local utility u=0.011078 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.994226243049016, 'loss_val': 0.09869292092883146, 'psi': 0.9948032006312313}-{'f1_val': 0.9945291067983943, 'auprc': 0.9943666262477548, 'loss_val': 0.11731668397184764, 'psi': 0.9944641145781385}
[S11] START round=29 head_norm_before_train=1.978391 cos_to_last_merge=0.9977 (last merge round=23)
[S11] round=29 local utility u=0.001681 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9988315578486049, 'loss_val': 0.025957985114098095, 'psi': 0.9977111771151883}-{'f1_val': 0.9969642566262439, 'auprc': 0.9984743903094531, 'loss_val': 0.028247714488247297, 'psi': 0.9975683100995275}
[S13] START round=29 head_norm_before_train=1.609754 cos_to_last_merge=1.0000 (last merge round=28)
[S13] round=29 local utility u=0.003718 metrics={'f1_val': 0.6107766318716661, 'auprc': 0.6825782759181385, 'loss_val': 0.6725893747231475, 'psi': 0.6394972894902551}-{'f1_val': 0.6084110862646279, 'auprc': 0.6789307064345349, 'loss_val': 0.6548903227070678, 'psi': 0.6366189343325908}
[S14] START round=29 head_norm_before_train=1.375052 cos_to_last_merge=0.9858 (last merge round=24)
[S14] round=29 local utility u=0.007011 metrics={'f1_val': 0.9967584991393483, 'auprc': 0.9991157046093831, 'loss_val': 0.09332178234134518, 'psi': 0.9977013813273623}-{'f1_val': 0.9965652232429598, 'auprc': 0.9991098405280767, 'loss_val': 0.10616731754392542, 'psi': 0.9975830701570066}
[S15] START round=29 head_norm_before_train=1.700943 cos_to_last_merge=1.0000 (last merge round=28)
[S15] round=29 local utility u=0.390237 metrics={'f1_val': 0.8083925123307808, 'auprc': 0.987385359867539, 'loss_val': 0.23891465230103362, 'psi': 0.8799896513454841}-{'f1_val': 0.7009169771696235, 'auprc': 0.9881206941209948, 'loss_val': 0.3767408443692977, 'psi': 0.8157984639501721}
[S16] START round=29 head_norm_before_train=1.380065 cos_to_last_merge=1.0000 (last merge round=28)
[S16] round=29 local utility u=0.191275 metrics={'f1_val': 0.9197044079767872, 'auprc': 0.9919720362990477, 'loss_val': 0.3333858414690642, 'psi': 0.9486114593056915}-{'f1_val': 0.877655904414033, 'auprc': 0.9896309692981695, 'loss_val': 0.456622236712687, 'psi': 0.9224459303676875}
[S17] START round=29 head_norm_before_train=1.913543 (no previous merge yet)
[S17] round=29 local utility u=0.000000 metrics={'f1_val': 0.5777331740184333, 'auprc': 0.8457128414737698, 'loss_val': 1.0361157276192132, 'psi': 0.6849250410005678}-{'f1_val': 0.5885563697432485, 'auprc': 0.9135780252980404, 'loss_val': 0.9545938758162473, 'psi': 0.7185650319651653}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S15] → sending delta(kind=head bytes=1806) to S2@127.0.0.1:44902
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:44903
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:44916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:44904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:44913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:44908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:44907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1804 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1804 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1806 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1804) from S3
[S7] cosine check vs S3: cos=0.8115
[S2] RECEIVED delta(kind=head bytes=1806) from S15
[S2] cosine check vs S15: cos=-0.0206
[S2] DROPPED delta from S15 (cos=-0.0206 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1803) from S10
[S13] cosine check vs S10: cos=0.9971
[S3] RECEIVED delta(kind=head bytes=1800) from S2
[S3] cosine check vs S2: cos=0.9980
[S16] RECEIVED delta(kind=head bytes=1804) from S14
[S16] cosine check vs S14: cos=0.9938
[S6] RECEIVED delta(kind=head bytes=1802) from S8
[S6] cosine check vs S8: cos=0.9372
[S4] RECEIVED delta(kind=head bytes=1799) from S11
[S4] cosine check vs S11: cos=0.9994
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S16] → sending delta(kind=head bytes=1807) to S5@127.0.0.1:44905
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S6]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[S3]  timeout peer S2
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S16
[S5]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S15
[S8]  timeout peer S16
[S8]  timeout peer S17
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S16] sending update (kind=head size=1807 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1807) from S16
[S5] cosine check vs S16: cos=0.9161
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:44915
[S5] sending update (kind=head size=1803 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1803) from S5
[S15] cosine check vs S5: cos=0.9854
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=29 metric=0.9960 head_norm=1.634354
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.302574e-01
[S5] stored merged vector for next round verification (round=29)
[S5] DEBUG after merge:  round=29 metric=0.9960 head_norm=1.491717 delta_norm=0.330257
[S5] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=29 metric=0.9197 head_norm=1.413317
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.830696e-02
[S16] stored merged vector for next round verification (round=29)
[S16] DEBUG after merge:  round=29 metric=0.9207 head_norm=1.407841 delta_norm=0.078307
[S16] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=29 metric=0.9456 head_norm=1.154269
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.228495e-01
[S6] stored merged vector for next round verification (round=29)
[S6] DEBUG after merge:  round=29 metric=0.9426 head_norm=1.194614 delta_norm=0.222850
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=29 metric=0.6108 head_norm=1.614501
[S13] _apply_head_vector_avg (torch): Δ‖w‖=6.998108e-02
[S13] stored merged vector for next round verification (round=29)
[S13] DEBUG after merge:  round=29 metric=0.6128 head_norm=1.644778 delta_norm=0.069981
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=29 metric=0.6483 head_norm=1.441187
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.460812e-01
[S7] stored merged vector for next round verification (round=29)
[S7] DEBUG after merge:  round=29 metric=0.6145 head_norm=1.382355 delta_norm=0.446081
[S7] aggregate: ROLLBACK (f1_val pre=0.648 post=0.614 tol_abs=0.005 tol_rel=0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=29 metric=0.9416 head_norm=1.976391
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.420588e-02
[S4] stored merged vector for next round verification (round=29)
[S4] DEBUG after merge:  round=29 metric=0.9416 head_norm=1.985065 delta_norm=0.034206
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=29 metric=0.8084 head_norm=1.710881
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.477928e-01
[S15] stored merged vector for next round verification (round=29)
[S15] DEBUG after merge:  round=29 metric=0.8010 head_norm=1.666514 delta_norm=0.147793
[S15] aggregate: ROLLBACK (f1_val pre=0.808 post=0.801 tol_abs=0.005 tol_rel=0.0)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=29 metric=0.8458 head_norm=1.463820
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.690422e-02
[S3] stored merged vector for next round verification (round=29)
[S3] DEBUG after merge:  round=29 metric=0.8474 head_norm=1.457240 delta_norm=0.046904
[S3] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=30 head_norm_before_train=1.452147 cos_to_last_merge=0.9935 (last merge round=23)
[S2] round=30 local utility u=0.045135 metrics={'f1_val': 0.8392600616290703, 'auprc': 0.8680518654809095, 'loss_val': 0.2657012525901778, 'psi': 0.8507767831698059}-{'f1_val': 0.8340992233600593, 'auprc': 0.8473625488641127, 'loss_val': 0.2629388154168929, 'psi': 0.8394045535616805}
[S3] START round=30 head_norm_before_train=1.457240 cos_to_last_merge=1.0000 (last merge round=29)
[S3] round=30 local utility u=0.214996 metrics={'f1_val': 0.8994413303955786, 'auprc': 0.9989496262964302, 'loss_val': 0.1971122772261781, 'psi': 0.9392446487559193}-{'f1_val': 0.8457941287740618, 'auprc': 0.9979949091084573, 'loss_val': 0.3023564005771623, 'psi': 0.90667444090782}
[S4] START round=30 head_norm_before_train=1.985065 cos_to_last_merge=1.0000 (last merge round=29)
[S4] round=30 local utility u=0.034218 metrics={'f1_val': 0.9442682368918164, 'auprc': 0.9639787989641339, 'loss_val': 0.2741845015339961, 'psi': 0.9521524617207433}-{'f1_val': 0.9416460277263521, 'auprc': 0.9518162460792454, 'loss_val': 0.2903988721851768, 'psi': 0.9457141150675095}
[S4] not sending this round → trigger blocked (psi=0.952)
[S5] START round=30 head_norm_before_train=1.491717 cos_to_last_merge=1.0000 (last merge round=29)
[S5] round=30 local utility u=0.003559 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9975240842501009, 'loss_val': 0.069850784936334, 'psi': 0.9966337632388728}-{'f1_val': 0.9960402158980539, 'auprc': 0.9933596305776291, 'loss_val': 0.0644749557129858, 'psi': 0.994967981769884}
[S6] START round=30 head_norm_before_train=1.194614 cos_to_last_merge=1.0000 (last merge round=29)
[S6] round=30 local utility u=0.000000 metrics={'f1_val': 0.6169154145635037, 'auprc': 0.9488175522638354, 'loss_val': 0.6441633713717562, 'psi': 0.7496762696436363}-{'f1_val': 0.9456051761670068, 'auprc': 0.9655993719410504, 'loss_val': 0.33009225862167707, 'psi': 0.9536028544766243}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=30 head_norm_before_train=1.382355 cos_to_last_merge=1.0000 (last merge round=29)
[S7] round=30 local utility u=0.000000 metrics={'f1_val': 0.5131386945868164, 'auprc': 0.7803789503626278, 'loss_val': 0.9245776546604733, 'psi': 0.6200347968971409}-{'f1_val': 0.6482734086787418, 'auprc': 0.7966068689975445, 'loss_val': 0.5513324885842948, 'psi': 0.7076067928062629}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=30 head_norm_before_train=1.273261 cos_to_last_merge=0.9976 (last merge round=28)
[S8] round=30 local utility u=0.022847 metrics={'f1_val': 0.9966398743144329, 'auprc': 0.998002433714885, 'loss_val': 0.16720805392968555, 'psi': 0.9971848980746136}-{'f1_val': 0.9962031034001528, 'auprc': 0.9988114102084676, 'loss_val': 0.21270737838475542, 'psi': 0.9972464261234788}
[S9] START round=30 head_norm_before_train=1.348797 cos_to_last_merge=0.9797 (last merge round=24)
[S9] round=30 local utility u=0.013621 metrics={'f1_val': 0.9939457934366372, 'auprc': 0.9984219883438754, 'loss_val': 0.04405098415114813, 'psi': 0.9957362713995326}-{'f1_val': 0.9910040044536889, 'auprc': 0.998419026208672, 'loss_val': 0.0536335225291033, 'psi': 0.9939700131556821}
[S10] START round=30 head_norm_before_train=1.677430 cos_to_last_merge=0.9937 (last merge round=25)
[S10] round=30 local utility u=0.006051 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9931869392197392, 'loss_val': 0.08347267596974732, 'psi': 0.9943874790995205}-{'f1_val': 0.9951878390193748, 'auprc': 0.994226243049016, 'loss_val': 0.09869292092883146, 'psi': 0.9948032006312313}
[S11] START round=30 head_norm_before_train=1.994288 cos_to_last_merge=0.9970 (last merge round=23)
[S11] round=30 local utility u=0.000125 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9984819449644899, 'loss_val': 0.02466009825874021, 'psi': 0.9975713319615422}-{'f1_val': 0.9969642566262439, 'auprc': 0.9988315578486049, 'loss_val': 0.025957985114098095, 'psi': 0.9977111771151883}
[S13] START round=30 head_norm_before_train=1.644778 cos_to_last_merge=1.0000 (last merge round=29)
[S13] round=30 local utility u=0.000000 metrics={'f1_val': 0.5466059403658816, 'auprc': 0.7065260936329992, 'loss_val': 1.0459809064622625, 'psi': 0.6105740016727286}-{'f1_val': 0.6107766318716661, 'auprc': 0.6825782759181385, 'loss_val': 0.6725893747231475, 'psi': 0.6394972894902551}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=30 head_norm_before_train=1.406709 cos_to_last_merge=0.9821 (last merge round=24)
[S14] round=30 local utility u=0.003321 metrics={'f1_val': 0.9961248879791463, 'auprc': 0.9991157104102489, 'loss_val': 0.08287794835577394, 'psi': 0.9973212169515873}-{'f1_val': 0.9967584991393483, 'auprc': 0.9991157046093831, 'loss_val': 0.09332178234134518, 'psi': 0.9977013813273623}
[S15] START round=30 head_norm_before_train=1.666514 cos_to_last_merge=1.0000 (last merge round=29)
[S15] round=30 local utility u=0.618884 metrics={'f1_val': 0.9956502107966734, 'auprc': 0.9881235048249846, 'loss_val': 0.12690684632852609, 'psi': 0.9926395284079979}-{'f1_val': 0.8083925123307808, 'auprc': 0.987385359867539, 'loss_val': 0.23891465230103362, 'psi': 0.8799896513454841}
[S16] START round=30 head_norm_before_train=1.407841 cos_to_last_merge=1.0000 (last merge round=29)
[S16] round=30 local utility u=0.000000 metrics={'f1_val': 0.824803510948945, 'auprc': 0.9647075212158056, 'loss_val': 0.8141991532752774, 'psi': 0.8807651150556892}-{'f1_val': 0.9197044079767872, 'auprc': 0.9919720362990477, 'loss_val': 0.3333858414690642, 'psi': 0.9486114593056915}
[S17] START round=30 head_norm_before_train=1.925282 (no previous merge yet)
[S17] round=30 local utility u=0.256924 metrics={'f1_val': 0.5937178325333047, 'auprc': 0.9468472817466267, 'loss_val': 0.9215791539842365, 'psi': 0.7349696122186336}-{'f1_val': 0.5777331740184333, 'auprc': 0.8457128414737698, 'loss_val': 1.0361157276192132, 'psi': 0.6849250410005678}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S4@127.0.0.1:44904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:44913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:44903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] → sending delta(kind=head bytes=1805) to S15@127.0.0.1:44915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S14] → sending delta(kind=head bytes=1806) to S16@127.0.0.1:44916
[S5] sending update (kind=head size=1805 to 1 peers)
[S2] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:44908
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1794 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:44907
[S14] sending update (kind=head size=1806 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S2@127.0.0.1:44902
[S3] RECEIVED delta(kind=head bytes=1796) from S2
[S3] cosine check vs S2: cos=0.9985
[S15] RECEIVED delta(kind=head bytes=1805) from S5
[S15] cosine check vs S5: cos=0.9654
[S16] RECEIVED delta(kind=head bytes=1806) from S14
[S16] cosine check vs S14: cos=0.9964
[S4] RECEIVED delta(kind=head bytes=1794) from S11
[S4] cosine check vs S11: cos=0.9997
[S13] RECEIVED delta(kind=head bytes=1798) from S10
[S13] cosine check vs S10: cos=0.9982
[S10] ⇄ pheromone p=0.035 → S13@127.0.0.1:44913
[S2] ⇄ pheromone p=0.119 → S3@127.0.0.1:44903
[S8] sending update (kind=head size=1801 to 1 peers)
[S5] ⇄ pheromone p=0.037 → S15@127.0.0.1:44915
[S14] ⇄ pheromone p=0.025 → S16@127.0.0.1:44916
[S15] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1804 to 1 peers)
[S11] ⇄ pheromone p=0.014 → S4@127.0.0.1:44904
[S6] RECEIVED delta(kind=head bytes=1801) from S8
[S6] cosine check vs S8: cos=0.9801
[S2] RECEIVED delta(kind=head bytes=1803) from S15
[S2] cosine check vs S15: cos=-0.0117
[S2] DROPPED delta from S15 (cos=-0.0117 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1804) from S3
[S7] cosine check vs S3: cos=0.9441
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=30 metric=0.8248 head_norm=1.436654
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.053657e-02
[S16] stored merged vector for next round verification (round=30)
[S16] DEBUG after merge:  round=30 metric=0.8255 head_norm=1.434327 delta_norm=0.060537
[S16] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.114 → S5@127.0.0.1:44905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S9] → sending delta(kind=head bytes=1805) to S8@127.0.0.1:44909
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=30 metric=0.8994 head_norm=1.488471
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.096597e-02
[S3] stored merged vector for next round verification (round=30)
[S3] DEBUG after merge:  round=30 metric=0.9006 head_norm=1.481312 delta_norm=0.040966
[S3] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.130 → S7@127.0.0.1:44908
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=30 metric=0.9957 head_norm=1.683785
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.240084e-01
[S15] stored merged vector for next round verification (round=30)
[S15] DEBUG after merge:  round=30 metric=0.9856 head_norm=1.596780 delta_norm=0.224008
[S15] aggregate: ROLLBACK (f1_val pre=0.996 post=0.986 tol_abs=0.005 tol_rel=0.0)
[S15] ⇄ pheromone p=0.382 → S2@127.0.0.1:44902
[S9] sending update (kind=head size=1805 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1805) from S9
[S8] cosine check vs S9: cos=0.9727
[S9] ⇄ pheromone p=0.017 → S8@127.0.0.1:44909
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=30 metric=0.9966 head_norm=1.309752
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.605694e-01
[S8] stored merged vector for next round verification (round=30)
[S8] DEBUG after merge:  round=30 metric=0.9966 head_norm=1.334615 delta_norm=0.160569
[S8] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.112 → S6@127.0.0.1:44907
[S2] START round=31 head_norm_before_train=1.475257 cos_to_last_merge=0.9914 (last merge round=23)
[S2] round=31 local utility u=0.021133 metrics={'f1_val': 0.8345826789156834, 'auprc': 0.8961007377616828, 'loss_val': 0.27951763948733366, 'psi': 0.8591899024540831}-{'f1_val': 0.8392600616290703, 'auprc': 0.8680518654809095, 'loss_val': 0.2657012525901778, 'psi': 0.8507767831698059}
[S3] START round=31 head_norm_before_train=1.481312 cos_to_last_merge=1.0000 (last merge round=30)
[S3] round=31 local utility u=0.256387 metrics={'f1_val': 0.965423706818603, 'auprc': 0.9996383909159691, 'loss_val': 0.08229901588417424, 'psi': 0.9791095804575494}-{'f1_val': 0.8994413303955786, 'auprc': 0.9989496262964302, 'loss_val': 0.1971122772261781, 'psi': 0.9392446487559193}
[S4] START round=31 head_norm_before_train=1.993794 cos_to_last_merge=1.0000 (last merge round=29)
[S4] round=31 local utility u=0.063107 metrics={'f1_val': 0.9548416339216452, 'auprc': 0.9806165236708004, 'loss_val': 0.26132333482545655, 'psi': 0.9651515898213072}-{'f1_val': 0.9442682368918164, 'auprc': 0.9639787989641339, 'loss_val': 0.2741845015339961, 'psi': 0.9521524617207433}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=31 metric=0.9548 head_norm=2.003929
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.031674e-02
[S4] stored merged vector for next round verification (round=31)
[S4] DEBUG after merge:  round=31 metric=0.9548 head_norm=2.004917 delta_norm=0.030317
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S5] START round=31 head_norm_before_train=1.537739 cos_to_last_merge=0.9992 (last merge round=29)
[S5] round=31 local utility u=0.006610 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9977009983133011, 'loss_val': 0.05803683591933265, 'psi': 0.996792013310907}-{'f1_val': 0.9960402158980539, 'auprc': 0.9975240842501009, 'loss_val': 0.069850784936334, 'psi': 0.9966337632388728}
[S6] START round=31 head_norm_before_train=1.239011 cos_to_last_merge=0.9982 (last merge round=29)
[S6] round=31 local utility u=1.000000 metrics={'f1_val': 0.9641214555591796, 'auprc': 0.988424252114191, 'loss_val': 0.21854819600202996, 'psi': 0.9738425741811843}-{'f1_val': 0.6169154145635037, 'auprc': 0.9488175522638354, 'loss_val': 0.6441633713717562, 'psi': 0.7496762696436363}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=31 metric=0.9641 head_norm=1.282170
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.560046e-01
[S6] stored merged vector for next round verification (round=31)
[S6] DEBUG after merge:  round=31 metric=0.9633 head_norm=1.286611 delta_norm=0.156005
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S7] START round=31 head_norm_before_train=1.401750 cos_to_last_merge=0.9998 (last merge round=29)
[S7] round=31 local utility u=0.652949 metrics={'f1_val': 0.6547812443538625, 'auprc': 0.8001659256135968, 'loss_val': 0.5278961696841574, 'psi': 0.7129351168577562}-{'f1_val': 0.5131386945868164, 'auprc': 0.7803789503626278, 'loss_val': 0.9245776546604733, 'psi': 0.6200347968971409}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=31 metric=0.6548 head_norm=1.429646
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.575646e-01
[S7] stored merged vector for next round verification (round=31)
[S7] DEBUG after merge:  round=31 metric=0.6288 head_norm=1.436446 delta_norm=0.257565
[S7] aggregate: ROLLBACK (f1_val pre=0.655 post=0.629 tol_abs=0.005 tol_rel=0.0)
[S8] START round=31 head_norm_before_train=1.334615 cos_to_last_merge=1.0000 (last merge round=30)
[S8] round=31 local utility u=0.005723 metrics={'f1_val': 0.9964900410640029, 'auprc': 0.999196894416247, 'loss_val': 0.15844596132544922, 'psi': 0.9975727824049005}-{'f1_val': 0.9966398743144329, 'auprc': 0.998002433714885, 'loss_val': 0.16720805392968555, 'psi': 0.9971848980746136}
[S9] START round=31 head_norm_before_train=1.377864 cos_to_last_merge=0.9766 (last merge round=24)
[S9] round=31 local utility u=0.003886 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9931842298396699, 'loss_val': 0.03704587379525545, 'psi': 0.9952891866947253}-{'f1_val': 0.9939457934366372, 'auprc': 0.9984219883438754, 'loss_val': 0.04405098415114813, 'psi': 0.9957362713995326}
[S10] START round=31 head_norm_before_train=1.709624 cos_to_last_merge=0.9911 (last merge round=25)
[S10] round=31 local utility u=0.004912 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9926211848251034, 'loss_val': 0.07195116369021039, 'psi': 0.9941611773416662}-{'f1_val': 0.9951878390193748, 'auprc': 0.9931869392197392, 'loss_val': 0.08347267596974732, 'psi': 0.9943874790995205}
[S11] START round=31 head_norm_before_train=2.006363 cos_to_last_merge=0.9966 (last merge round=23)
[S11] round=31 local utility u=0.001382 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.998939569758377, 'loss_val': 0.023269032804186483, 'psi': 0.997754381879097}-{'f1_val': 0.9969642566262439, 'auprc': 0.9984819449644899, 'loss_val': 0.02466009825874021, 'psi': 0.9975713319615422}
[S13] START round=31 head_norm_before_train=1.650204 cos_to_last_merge=1.0000 (last merge round=29)
[S13] round=31 local utility u=0.178263 metrics={'f1_val': 0.5823509535584017, 'auprc': 0.6997326019065586, 'loss_val': 0.8835445424371478, 'psi': 0.6293036128976645}-{'f1_val': 0.5466059403658816, 'auprc': 0.7065260936329992, 'loss_val': 1.0459809064622625, 'psi': 0.6105740016727286}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=31 metric=0.5824 head_norm=1.655047
[S13] _apply_head_vector_avg (torch): Δ‖w‖=5.812088e-02
[S13] stored merged vector for next round verification (round=31)
[S13] DEBUG after merge:  round=31 metric=0.5824 head_norm=1.681553 delta_norm=0.058121
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] START round=31 head_norm_before_train=1.434553 cos_to_last_merge=0.9791 (last merge round=24)
[S14] round=31 local utility u=0.003554 metrics={'f1_val': 0.995904197515876, 'auprc': 0.9990044412435133, 'loss_val': 0.07411145751505743, 'psi': 0.9971442950069309}-{'f1_val': 0.9961248879791463, 'auprc': 0.9991157104102489, 'loss_val': 0.08287794835577394, 'psi': 0.9973212169515873}
[S15] START round=31 head_norm_before_train=1.596780 cos_to_last_merge=1.0000 (last merge round=30)
[S15] round=31 local utility u=0.013919 metrics={'f1_val': 0.9960644514889518, 'auprc': 0.9917720095606362, 'loss_val': 0.11249942647336446, 'psi': 0.9943474747176255}-{'f1_val': 0.9956502107966734, 'auprc': 0.9881235048249846, 'loss_val': 0.12690684632852609, 'psi': 0.9926395284079979}
[S16] START round=31 head_norm_before_train=1.434327 cos_to_last_merge=1.0000 (last merge round=30)
[S16] round=31 local utility u=0.708520 metrics={'f1_val': 0.9485203480970734, 'auprc': 0.9805325092505267, 'loss_val': 0.18693563455559228, 'psi': 0.9613252125584547}-{'f1_val': 0.824803510948945, 'auprc': 0.9647075212158056, 'loss_val': 0.8141991532752774, 'psi': 0.8807651150556892}
[S17] START round=31 head_norm_before_train=1.933440 (no previous merge yet)
[S17] round=31 local utility u=0.000000 metrics={'f1_val': 0.5865543323493879, 'auprc': 0.8411901643648056, 'loss_val': 1.064596445975359, 'psi': 0.688408665155555}-{'f1_val': 0.5937178325333047, 'auprc': 0.9468472817466267, 'loss_val': 0.9215791539842365, 'psi': 0.7349696122186336}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:44913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S14] → sending delta(kind=head bytes=1807) to S16@127.0.0.1:44916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:44915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:44903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S4@127.0.0.1:44904
[S2] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1794 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] → sending delta(kind=head bytes=1805) to S2@127.0.0.1:44902
[S14] sending update (kind=head size=1807 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:44907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:44905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:44908
[S13] RECEIVED delta(kind=head bytes=1803) from S10
[S13] cosine check vs S10: cos=0.9990
[S16] RECEIVED delta(kind=head bytes=1807) from S14
[S16] cosine check vs S14: cos=0.9973
[S4] RECEIVED delta(kind=head bytes=1794) from S11
[S4] cosine check vs S11: cos=0.9998
[S3] RECEIVED delta(kind=head bytes=1800) from S2
[S3] cosine check vs S2: cos=0.9988
[S15] RECEIVED delta(kind=head bytes=1800) from S5
[S15] cosine check vs S5: cos=0.9890
[S16] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1805 to 1 peers)
[S8] sending update (kind=head size=1804 to 1 peers)
[S3] sending update (kind=head size=1803 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1805) from S15
[S2] cosine check vs S15: cos=0.0003
[S5] RECEIVED delta(kind=head bytes=1802) from S16
[S5] cosine check vs S16: cos=0.9509
[S7] RECEIVED delta(kind=head bytes=1803) from S3
[S7] cosine check vs S3: cos=0.9839
[S6] RECEIVED delta(kind=head bytes=1804) from S8
[S6] cosine check vs S8: cos=0.9857
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=31 metric=0.9485 head_norm=1.461937
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.329304e-02
[S16] stored merged vector for next round verification (round=31)
[S16] DEBUG after merge:  round=31 metric=0.9444 head_norm=1.460832 delta_norm=0.053293
[S16] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=31 metric=0.9961 head_norm=1.615474
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.196181e-01
[S15] stored merged vector for next round verification (round=31)
[S15] DEBUG after merge:  round=31 metric=0.9961 head_norm=1.594690 delta_norm=0.119618
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=31 metric=0.9654 head_norm=1.505359
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.691435e-02
[S3] stored merged vector for next round verification (round=31)
[S3] DEBUG after merge:  round=31 metric=0.9663 head_norm=1.501633 delta_norm=0.036914
[S3] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:44909
[S9] sending update (kind=head size=1804 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1804) from S9
[S8] cosine check vs S9: cos=0.9871
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=31 metric=0.9965 head_norm=1.367206
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.126665e-01
[S8] stored merged vector for next round verification (round=31)
[S8] DEBUG after merge:  round=31 metric=0.9965 head_norm=1.380433 delta_norm=0.112667
[S8] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=32 head_norm_before_train=1.498807 cos_to_last_merge=0.9890 (last merge round=23)
[S2] round=32 local utility u=0.000000 metrics={'f1_val': 0.8071440930067626, 'auprc': 0.830793692163728, 'loss_val': 0.3847398170071664, 'psi': 0.8166039326695488}-{'f1_val': 0.8345826789156834, 'auprc': 0.8961007377616828, 'loss_val': 0.27951763948733366, 'psi': 0.8591899024540831}
[S3] START round=32 head_norm_before_train=1.501633 cos_to_last_merge=1.0000 (last merge round=31)
[S3] round=32 local utility u=0.031330 metrics={'f1_val': 0.9743552445841991, 'auprc': 0.9983883191543382, 'loss_val': 0.06947816696337215, 'psi': 0.9839684744122548}-{'f1_val': 0.965423706818603, 'auprc': 0.9996383909159691, 'loss_val': 0.08229901588417424, 'psi': 0.9791095804575494}
[S4] START round=32 head_norm_before_train=2.004917 cos_to_last_merge=1.0000 (last merge round=31)
[S4] round=32 local utility u=0.000000 metrics={'f1_val': 0.9500745646266854, 'auprc': 0.9620366751363946, 'loss_val': 0.27032106707386966, 'psi': 0.9548594088305691}-{'f1_val': 0.9548416339216452, 'auprc': 0.9806165236708004, 'loss_val': 0.26132333482545655, 'psi': 0.9651515898213072}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=32 metric=0.9501 head_norm=2.015887
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.474603e-02
[S4] stored merged vector for next round verification (round=32)
[S4] DEBUG after merge:  round=32 metric=0.9501 head_norm=2.016479 delta_norm=0.024746
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S5] START round=32 head_norm_before_train=1.582697 cos_to_last_merge=0.9975 (last merge round=29)
[S5] round=32 local utility u=0.003139 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9972643916805586, 'loss_val': 0.050448041729659485, 'psi': 0.9966173706578101}-{'f1_val': 0.996186023309311, 'auprc': 0.9977009983133011, 'loss_val': 0.05803683591933265, 'psi': 0.996792013310907}
[S6] START round=32 head_norm_before_train=1.286611 cos_to_last_merge=1.0000 (last merge round=31)
[S6] round=32 local utility u=0.000000 metrics={'f1_val': 0.8259931337975227, 'auprc': 0.9673300208759096, 'loss_val': 0.3556515433423513, 'psi': 0.8825278886288774}-{'f1_val': 0.9641214555591796, 'auprc': 0.988424252114191, 'loss_val': 0.21854819600202996, 'psi': 0.9738425741811843}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=32 metric=0.8260 head_norm=1.330384
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.435955e-01
[S6] stored merged vector for next round verification (round=32)
[S6] DEBUG after merge:  round=32 metric=0.8246 head_norm=1.341256 delta_norm=0.143596
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S7] START round=32 head_norm_before_train=1.436446 cos_to_last_merge=1.0000 (last merge round=31)
[S7] round=32 local utility u=0.000000 metrics={'f1_val': 0.5640633906499517, 'auprc': 0.7821126191529242, 'loss_val': 0.8335005423998448, 'psi': 0.6512830820511407}-{'f1_val': 0.6547812443538625, 'auprc': 0.8001659256135968, 'loss_val': 0.5278961696841574, 'psi': 0.7129351168577562}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=32 metric=0.5641 head_norm=1.476185
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.580643e-01
[S7] stored merged vector for next round verification (round=32)
[S7] DEBUG after merge:  round=32 metric=0.5387 head_norm=1.482440 delta_norm=0.158064
[S7] aggregate: ROLLBACK (f1_val pre=0.564 post=0.539 tol_abs=0.005 tol_rel=0.0)
[S8] START round=32 head_norm_before_train=1.380433 cos_to_last_merge=1.0000 (last merge round=31)
[S8] round=32 local utility u=0.001835 metrics={'f1_val': 0.9950949602617258, 'auprc': 0.9992447358956911, 'loss_val': 0.14654965785134694, 'psi': 0.996754870515312}-{'f1_val': 0.9964900410640029, 'auprc': 0.999196894416247, 'loss_val': 0.15844596132544922, 'psi': 0.9975727824049005}
[S9] START round=32 head_norm_before_train=1.402613 cos_to_last_merge=0.9740 (last merge round=24)
[S9] round=32 local utility u=0.005543 metrics={'f1_val': 0.9958601375429889, 'auprc': 0.9984138420494384, 'loss_val': 0.03665474947772042, 'psi': 0.9968816193455686}-{'f1_val': 0.9966924912647621, 'auprc': 0.9931842298396699, 'loss_val': 0.03704587379525545, 'psi': 0.9952891866947253}
[S10] START round=32 head_norm_before_train=1.738838 cos_to_last_merge=0.9889 (last merge round=25)
[S10] round=32 local utility u=0.004922 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9938220891894376, 'loss_val': 0.06175747418409687, 'psi': 0.9942462997548116}-{'f1_val': 0.9951878390193748, 'auprc': 0.9926211848251034, 'loss_val': 0.07195116369021039, 'psi': 0.9941611773416662}
[S11] START round=32 head_norm_before_train=2.017374 cos_to_last_merge=0.9961 (last merge round=23)
[S11] round=32 local utility u=0.000000 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9982661015410839, 'loss_val': 0.02277213286262058, 'psi': 0.9974849945921798}-{'f1_val': 0.9969642566262439, 'auprc': 0.998939569758377, 'loss_val': 0.023269032804186483, 'psi': 0.997754381879097}
[S13] START round=32 head_norm_before_train=1.681553 cos_to_last_merge=1.0000 (last merge round=31)
[S13] round=32 local utility u=0.157980 metrics={'f1_val': 0.6079285057395349, 'auprc': 0.6856425810217945, 'loss_val': 0.6787800060978318, 'psi': 0.6390141358524388}-{'f1_val': 0.5823509535584017, 'auprc': 0.6997326019065586, 'loss_val': 0.8835445424371478, 'psi': 0.6293036128976645}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=32 metric=0.6079 head_norm=1.687181
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.863719e-02
[S13] stored merged vector for next round verification (round=32)
[S13] DEBUG after merge:  round=32 metric=0.6083 head_norm=1.712514 delta_norm=0.048637
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] START round=32 head_norm_before_train=1.461671 cos_to_last_merge=0.9762 (last merge round=24)
[S14] round=32 local utility u=0.004325 metrics={'f1_val': 0.9963144732565343, 'auprc': 0.9988957867024152, 'loss_val': 0.06759760056965704, 'psi': 0.9973469986348866}-{'f1_val': 0.995904197515876, 'auprc': 0.9990044412435133, 'loss_val': 0.07411145751505743, 'psi': 0.9971442950069309}
[S15] START round=32 head_norm_before_train=1.594690 cos_to_last_merge=1.0000 (last merge round=31)
[S15] round=32 local utility u=0.000000 metrics={'f1_val': 0.821097081372612, 'auprc': 0.9889440030211009, 'loss_val': 0.23499205054693348, 'psi': 0.8882358500320076}-{'f1_val': 0.9960644514889518, 'auprc': 0.9917720095606362, 'loss_val': 0.11249942647336446, 'psi': 0.9943474747176255}
[S16] START round=32 head_norm_before_train=1.460832 cos_to_last_merge=1.0000 (last merge round=31)
[S16] round=32 local utility u=0.000000 metrics={'f1_val': 0.859742165840038, 'auprc': 0.9377040152094995, 'loss_val': 0.5937974735920764, 'psi': 0.8909269055878226}-{'f1_val': 0.9485203480970734, 'auprc': 0.9805325092505267, 'loss_val': 0.18693563455559228, 'psi': 0.9613252125584547}
[S17] START round=32 head_norm_before_train=1.942793 (no previous merge yet)
[S17] round=32 local utility u=0.000000 metrics={'f1_val': 0.576313590526429, 'auprc': 0.8031379392523913, 'loss_val': 1.169285324450679, 'psi': 0.6670433300168139}-{'f1_val': 0.5865543323493879, 'auprc': 0.8411901643648056, 'loss_val': 1.064596445975359, 'psi': 0.688408665155555}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:44915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S14] → sending delta(kind=head bytes=1806) to S16@127.0.0.1:44916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:44913
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=32 metric=0.8071 head_norm=1.520810
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.108712e+00
[S2] stored merged vector for next round verification (round=32)
[S2] DEBUG after merge:  round=32 metric=0.7811 head_norm=1.109986 delta_norm=1.108712
[S2] aggregate: ROLLBACK (f1_val pre=0.807 post=0.781 tol_abs=0.005 tol_rel=0.0)
[S10] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:44908
[S14] sending update (kind=head size=1806 to 1 peers)
[S5] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:44907
[S16] RECEIVED delta(kind=head bytes=1806) from S14
[S16] cosine check vs S14: cos=0.9980
[S15] RECEIVED delta(kind=head bytes=1804) from S5
[S15] cosine check vs S5: cos=0.9957
[S13] RECEIVED delta(kind=head bytes=1796) from S10
[S13] cosine check vs S10: cos=0.9993
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=32 metric=0.9962 head_norm=1.614115
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.592159e-01
[S5] stored merged vector for next round verification (round=32)
[S5] DEBUG after merge:  round=32 metric=0.9962 head_norm=1.517933 delta_norm=0.259216
[S5] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S8] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1799) from S3
[S7] cosine check vs S3: cos=0.9940
[S6] RECEIVED delta(kind=head bytes=1797) from S8
[S6] cosine check vs S8: cos=0.9908
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=32 metric=0.8211 head_norm=1.618213
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.470212e-02
[S15] stored merged vector for next round verification (round=32)
[S15] DEBUG after merge:  round=32 metric=0.8156 head_norm=1.614438 delta_norm=0.074702
[S15] aggregate: ROLLBACK (f1_val pre=0.821 post=0.816 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=32 metric=0.8597 head_norm=1.484792
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.681189e-02
[S16] stored merged vector for next round verification (round=32)
[S16] DEBUG after merge:  round=32 metric=0.8597 head_norm=1.484697 delta_norm=0.046812
[S16] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:44909
[S9] sending update (kind=head size=1803 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1803) from S9
[S8] cosine check vs S9: cos=0.9919
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=32 metric=0.9951 head_norm=1.411420
[S8] _apply_head_vector_avg (torch): Δ‖w‖=9.041138e-02
[S8] stored merged vector for next round verification (round=32)
[S8] DEBUG after merge:  round=32 metric=0.9955 head_norm=1.413303 delta_norm=0.090411
[S8] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=33 head_norm_before_train=1.109986 cos_to_last_merge=1.0000 (last merge round=32)
[S2] round=33 local utility u=0.216746 metrics={'f1_val': 0.8914512161063218, 'auprc': 0.8299599967424318, 'loss_val': 0.45459018237510906, 'psi': 0.8668547283607659}-{'f1_val': 0.8071440930067626, 'auprc': 0.830793692163728, 'loss_val': 0.3847398170071664, 'psi': 0.8166039326695488}
[S3] START round=33 head_norm_before_train=1.520390 cos_to_last_merge=0.9999 (last merge round=31)
[S3] round=33 local utility u=0.000000 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.9996658988360951, 'loss_val': 0.12229350152739868, 'psi': 0.9765114107741103}-{'f1_val': 0.9743552445841991, 'auprc': 0.9983883191543382, 'loss_val': 0.06947816696337215, 'psi': 0.9839684744122548}
[S4] START round=33 head_norm_before_train=2.016479 cos_to_last_merge=1.0000 (last merge round=32)
[S4] round=33 local utility u=0.000000 metrics={'f1_val': 0.9482045009981208, 'auprc': 0.9634643906342523, 'loss_val': 0.2702502515380602, 'psi': 0.9543084568525735}-{'f1_val': 0.9500745646266854, 'auprc': 0.9620366751363946, 'loss_val': 0.27032106707386966, 'psi': 0.9548594088305691}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=33 head_norm_before_train=1.517933 cos_to_last_merge=1.0000 (last merge round=32)
[S5] round=33 local utility u=0.000000 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9897376024901161, 'loss_val': 0.06474041116792169, 'psi': 0.9935191705348788}-{'f1_val': 0.996186023309311, 'auprc': 0.9972643916805586, 'loss_val': 0.050448041729659485, 'psi': 0.9966173706578101}
[S6] START round=33 head_norm_before_train=1.341256 cos_to_last_merge=1.0000 (last merge round=32)
[S6] round=33 local utility u=0.000000 metrics={'f1_val': 0.7829250329427525, 'auprc': 0.9533691650677285, 'loss_val': 0.487555164004203, 'psi': 0.8511026857927428}-{'f1_val': 0.8259931337975227, 'auprc': 0.9673300208759096, 'loss_val': 0.3556515433423513, 'psi': 0.8825278886288774}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=33 metric=0.7829 head_norm=1.390821
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.275662e-01
[S6] stored merged vector for next round verification (round=33)
[S6] DEBUG after merge:  round=33 metric=0.7819 head_norm=1.395339 delta_norm=0.127566
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S7] START round=33 head_norm_before_train=1.482440 cos_to_last_merge=1.0000 (last merge round=32)
[S7] round=33 local utility u=0.295088 metrics={'f1_val': 0.620349477346313, 'auprc': 0.7914233605951664, 'loss_val': 0.6089735963038407, 'psi': 0.6887790306458543}-{'f1_val': 0.5640633906499517, 'auprc': 0.7821126191529242, 'loss_val': 0.8335005423998448, 'psi': 0.6512830820511407}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=33 metric=0.6203 head_norm=1.510749
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.030751e-01
[S7] stored merged vector for next round verification (round=33)
[S7] DEBUG after merge:  round=33 metric=0.6174 head_norm=1.512068 delta_norm=0.103075
[S7] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S8] START round=33 head_norm_before_train=1.413303 cos_to_last_merge=1.0000 (last merge round=32)
[S8] round=33 local utility u=0.015616 metrics={'f1_val': 0.9966398743144329, 'auprc': 0.9989987401185063, 'loss_val': 0.12384824771545294, 'psi': 0.9975834206360622}-{'f1_val': 0.9950949602617258, 'auprc': 0.9992447358956911, 'loss_val': 0.14654965785134694, 'psi': 0.996754870515312}
[S9] START round=33 head_norm_before_train=1.420949 cos_to_last_merge=0.9721 (last merge round=24)
[S9] round=33 local utility u=0.000000 metrics={'f1_val': 0.9937788533032199, 'auprc': 0.9987778010435677, 'loss_val': 0.037615985685059965, 'psi': 0.995778432399359}-{'f1_val': 0.9958601375429889, 'auprc': 0.9984138420494384, 'loss_val': 0.03665474947772042, 'psi': 0.9968816193455686}
[S10] START round=33 head_norm_before_train=1.765516 cos_to_last_merge=0.9869 (last merge round=25)
[S10] round=33 local utility u=0.000910 metrics={'f1_val': 0.9931720938432163, 'auprc': 0.9959813767117132, 'loss_val': 0.05827317508200777, 'psi': 0.994295806990615}-{'f1_val': 0.9945291067983943, 'auprc': 0.9938220891894376, 'loss_val': 0.06175747418409687, 'psi': 0.9942462997548116}
[S11] START round=33 head_norm_before_train=2.028274 cos_to_last_merge=0.9956 (last merge round=23)
[S11] round=33 local utility u=0.000000 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9989310568002083, 'loss_val': 0.022306778661286917, 'psi': 0.9975029757171416}-{'f1_val': 0.9969642566262439, 'auprc': 0.9982661015410839, 'loss_val': 0.02277213286262058, 'psi': 0.9974849945921798}
[S13] START round=33 head_norm_before_train=1.712514 cos_to_last_merge=1.0000 (last merge round=32)
[S13] round=33 local utility u=0.000000 metrics={'f1_val': 0.5325481625690504, 'auprc': 0.7232777228198094, 'loss_val': 1.0062312450745434, 'psi': 0.6088399866693539}-{'f1_val': 0.6079285057395349, 'auprc': 0.6856425810217945, 'loss_val': 0.6787800060978318, 'psi': 0.6390141358524388}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=33 metric=0.5325 head_norm=1.720189
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.121467e-02
[S13] stored merged vector for next round verification (round=33)
[S13] DEBUG after merge:  round=33 metric=0.5466 head_norm=1.742512 delta_norm=0.041215
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] START round=33 head_norm_before_train=1.486077 cos_to_last_merge=0.9737 (last merge round=24)
[S14] round=33 local utility u=0.005444 metrics={'f1_val': 0.9967552940827689, 'auprc': 0.9990084418303677, 'loss_val': 0.05969207248660374, 'psi': 0.9976565531818085}-{'f1_val': 0.9963144732565343, 'auprc': 0.9988957867024152, 'loss_val': 0.06759760056965704, 'psi': 0.9973469986348866}
[S15] START round=33 head_norm_before_train=1.614438 cos_to_last_merge=1.0000 (last merge round=32)
[S15] round=33 local utility u=0.184793 metrics={'f1_val': 0.8756750059074114, 'auprc': 0.9921455367784253, 'loss_val': 0.20247892854242283, 'psi': 0.922263218255817}-{'f1_val': 0.821097081372612, 'auprc': 0.9889440030211009, 'loss_val': 0.23499205054693348, 'psi': 0.8882358500320076}
[S16] START round=33 head_norm_before_train=1.484697 cos_to_last_merge=1.0000 (last merge round=32)
[S16] round=33 local utility u=0.280449 metrics={'f1_val': 0.8821440144567123, 'auprc': 0.978915743551797, 'loss_val': 0.2909448444841019, 'psi': 0.9208527060947461}-{'f1_val': 0.859742165840038, 'auprc': 0.9377040152094995, 'loss_val': 0.5937974735920764, 'psi': 0.8909269055878226}
[S17] START round=33 head_norm_before_train=1.950316 (no previous merge yet)
[S17] round=33 local utility u=0.099919 metrics={'f1_val': 0.6000683371240367, 'auprc': 0.823502045577883, 'loss_val': 1.1730686482991912, 'psi': 0.6894418205055752}-{'f1_val': 0.576313590526429, 'auprc': 0.8031379392523913, 'loss_val': 1.169285324450679, 'psi': 0.6670433300168139}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S14] not sending this round → trigger blocked (psi=0.998)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:44903
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.994)
[S2] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S2@127.0.0.1:44902
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.998)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:44905
[S3] RECEIVED delta(kind=head bytes=1802) from S2
[S3] cosine check vs S2: cos=0.6986
[S16] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1800) from S16
[S5] cosine check vs S16: cos=0.9781
[S2] RECEIVED delta(kind=head bytes=1803) from S15
[S2] cosine check vs S15: cos=0.7199
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=33 metric=0.9611 head_norm=1.541222
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.520511e-01
[S3] stored merged vector for next round verification (round=33)
[S3] DEBUG after merge:  round=33 metric=0.9611 head_norm=1.233531 delta_norm=0.552051
[S3] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=34 head_norm_before_train=1.130202 cos_to_last_merge=0.9996 (last merge round=32)
[S2] round=34 local utility u=0.013876 metrics={'f1_val': 0.8337615075777693, 'auprc': 0.9274927565616196, 'loss_val': 0.3732983760847108, 'psi': 0.8712540071713095}-{'f1_val': 0.8914512161063218, 'auprc': 0.8299599967424318, 'loss_val': 0.45459018237510906, 'psi': 0.8668547283607659}
[S3] START round=34 head_norm_before_train=1.233531 cos_to_last_merge=1.0000 (last merge round=33)
[S3] round=34 local utility u=0.130763 metrics={'f1_val': 0.9978389274664787, 'auprc': 0.9984935091429844, 'loss_val': 0.07783410063039135, 'psi': 0.998100760137081}-{'f1_val': 0.9610750853994537, 'auprc': 0.9996658988360951, 'loss_val': 0.12229350152739868, 'psi': 0.9765114107741103}
[S4] START round=34 head_norm_before_train=2.027078 cos_to_last_merge=1.0000 (last merge round=32)
[S4] round=34 local utility u=0.036818 metrics={'f1_val': 0.9510381571691009, 'auprc': 0.9809691687726548, 'loss_val': 0.2661304915129621, 'psi': 0.9630105618105225}-{'f1_val': 0.9482045009981208, 'auprc': 0.9634643906342523, 'loss_val': 0.2702502515380602, 'psi': 0.9543084568525735}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=34 head_norm_before_train=1.547190 cos_to_last_merge=0.9998 (last merge round=32)
[S5] round=34 local utility u=0.015574 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9959085256131156, 'loss_val': 0.052104290628560423, 'psi': 0.9959875397840786}-{'f1_val': 0.9960402158980539, 'auprc': 0.9897376024901161, 'loss_val': 0.06474041116792169, 'psi': 0.9935191705348788}
[S6] START round=34 head_norm_before_train=1.395339 cos_to_last_merge=1.0000 (last merge round=33)
[S6] round=34 local utility u=0.210573 metrics={'f1_val': 0.8312903414271089, 'auprc': 0.9645551122127308, 'loss_val': 0.3901591533323716, 'psi': 0.8845962497413578}-{'f1_val': 0.7829250329427525, 'auprc': 0.9533691650677285, 'loss_val': 0.487555164004203, 'psi': 0.8511026857927428}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] sending update (kind=head size=1804 to 1 peers)
[S7] START round=34 head_norm_before_train=1.512068 cos_to_last_merge=1.0000 (last merge round=33)
[S7] round=34 local utility u=0.000000 metrics={'f1_val': 0.558200591477303, 'auprc': 0.7823595856051813, 'loss_val': 0.8683745120231737, 'psi': 0.6478641891284543}-{'f1_val': 0.620349477346313, 'auprc': 0.7914233605951664, 'loss_val': 0.6089735963038407, 'psi': 0.6887790306458543}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=34 head_norm_before_train=1.445584 cos_to_last_merge=0.9990 (last merge round=32)
[S8] round=34 local utility u=0.012260 metrics={'f1_val': 0.9964900410640029, 'auprc': 0.998972592801196, 'loss_val': 0.0983508900713918, 'psi': 0.9974830617588801}-{'f1_val': 0.9966398743144329, 'auprc': 0.9989987401185063, 'loss_val': 0.12384824771545294, 'psi': 0.9975834206360622}
[S9] START round=34 head_norm_before_train=1.438679 cos_to_last_merge=0.9703 (last merge round=24)
[S9] round=34 local utility u=0.004719 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9953601071968686, 'loss_val': 0.032752371441758105, 'psi': 0.995894099746314}-{'f1_val': 0.9937788533032199, 'auprc': 0.9987778010435677, 'loss_val': 0.037615985685059965, 'psi': 0.995778432399359}
[S10] START round=34 head_norm_before_train=1.789071 cos_to_last_merge=0.9851 (last merge round=25)
[S10] round=34 local utility u=0.001623 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9925972056868879, 'loss_val': 0.05301761693055021, 'psi': 0.9937563463537917}-{'f1_val': 0.9931720938432163, 'auprc': 0.9959813767117132, 'loss_val': 0.05827317508200777, 'psi': 0.994295806990615}
[S11] START round=34 head_norm_before_train=2.037212 cos_to_last_merge=0.9953 (last merge round=23)
[S11] round=34 local utility u=0.001885 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9989395638629913, 'loss_val': 0.021042669570990918, 'psi': 0.9977543795209428}-{'f1_val': 0.9965509216617638, 'auprc': 0.9989310568002083, 'loss_val': 0.022306778661286917, 'psi': 0.9975029757171416}
[S13] START round=34 head_norm_before_train=1.742512 cos_to_last_merge=1.0000 (last merge round=33)
[S13] round=34 local utility u=0.178129 metrics={'f1_val': 0.5689010229018447, 'auprc': 0.7155797280211663, 'loss_val': 0.8449968985817298, 'psi': 0.6275725049495734}-{'f1_val': 0.5325481625690504, 'auprc': 0.7232777228198094, 'loss_val': 1.0062312450745434, 'psi': 0.6088399866693539}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=34 head_norm_before_train=1.509305 cos_to_last_merge=0.9714 (last merge round=24)
[S14] round=34 local utility u=0.000000 metrics={'f1_val': 0.9961248879791463, 'auprc': 0.9990045827132702, 'loss_val': 0.05623384586641496, 'psi': 0.9972767658727959}-{'f1_val': 0.9967552940827689, 'auprc': 0.9990084418303677, 'loss_val': 0.05969207248660374, 'psi': 0.9976565531818085}
[S15] START round=34 head_norm_before_train=1.640420 cos_to_last_merge=0.9998 (last merge round=32)
[S15] round=34 local utility u=0.000000 metrics={'f1_val': 0.8287856480454654, 'auprc': 0.9901443111522722, 'loss_val': 0.22002506089166332, 'psi': 0.8933291132881882}-{'f1_val': 0.8756750059074114, 'auprc': 0.9921455367784253, 'loss_val': 0.20247892854242283, 'psi': 0.922263218255817}
[S16] START round=34 head_norm_before_train=1.500457 cos_to_last_merge=0.9999 (last merge round=32)
[S16] round=34 local utility u=0.000000 metrics={'f1_val': 0.8614287599726517, 'auprc': 0.9910595652126745, 'loss_val': 0.5836062872610986, 'psi': 0.9132810820686608}-{'f1_val': 0.8821440144567123, 'auprc': 0.978915743551797, 'loss_val': 0.2909448444841019, 'psi': 0.9208527060947461}
[S17] START round=34 head_norm_before_train=1.959151 (no previous merge yet)
[S17] round=34 local utility u=0.113902 metrics={'f1_val': 0.5983242274666173, 'auprc': 0.887748791946803, 'loss_val': 1.1275401085154024, 'psi': 0.7140940532586916}-{'f1_val': 0.6000683371240367, 'auprc': 0.823502045577883, 'loss_val': 1.1730686482991912, 'psi': 0.6894418205055752}
[S17] not sending this round → trigger blocked (psi=0.714)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:44915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:44904
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:44913
[S2] not sending this round → trigger blocked (psi=0.871)
[S10] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S8] → sending delta(kind=head bytes=1806) to S6@127.0.0.1:44907
[S5] sending update (kind=head size=1804 to 1 peers)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=34 metric=0.8338 head_norm=1.164517
[S2] _apply_head_vector_avg (torch): Δ‖w‖=5.855147e-01
[S2] stored merged vector for next round verification (round=34)
[S2] DEBUG after merge:  round=34 metric=0.8322 head_norm=1.296423 delta_norm=0.585515
[S2] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S11] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:44908
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] RECEIVED delta(kind=head bytes=1804) from S5
[S15] cosine check vs S5: cos=0.9822
[S13] RECEIVED delta(kind=head bytes=1800) from S10
[S13] cosine check vs S10: cos=0.9991
[S4] RECEIVED delta(kind=head bytes=1796) from S11
[S4] cosine check vs S11: cos=0.9995
[S8] sending update (kind=head size=1806 to 1 peers)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=34 metric=0.9960 head_norm=1.587164
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.802674e-01
[S5] stored merged vector for next round verification (round=34)
[S5] DEBUG after merge:  round=34 metric=0.9960 head_norm=1.533862 delta_norm=0.180267
[S5] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S3] sending update (kind=head size=1800 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1806) from S8
[S6] cosine check vs S8: cos=0.9903
[S7] RECEIVED delta(kind=head bytes=1800) from S3
[S7] cosine check vs S3: cos=0.9418
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=34 metric=0.8288 head_norm=1.670531
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.590343e-01
[S15] stored merged vector for next round verification (round=34)
[S15] DEBUG after merge:  round=34 metric=0.8196 head_norm=1.621601 delta_norm=0.159034
[S15] aggregate: ROLLBACK (f1_val pre=0.829 post=0.820 tol_abs=0.005 tol_rel=0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:44909
[S9] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1800) from S9
[S8] cosine check vs S9: cos=0.9896
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=34 metric=0.9965 head_norm=1.476819
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.060193e-01
[S8] stored merged vector for next round verification (round=34)
[S8] DEBUG after merge:  round=34 metric=0.9965 head_norm=1.463182 delta_norm=0.106019
[S8] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=35 head_norm_before_train=1.296423 cos_to_last_merge=1.0000 (last merge round=34)
[S2] round=35 local utility u=0.000000 metrics={'f1_val': 0.9084306323157173, 'auprc': 0.830797786711452, 'loss_val': 0.557337789138376, 'psi': 0.8773774940740111}-{'f1_val': 0.8337615075777693, 'auprc': 0.9274927565616196, 'loss_val': 0.3732983760847108, 'psi': 0.8712540071713095}
[S3] START round=35 head_norm_before_train=1.265292 cos_to_last_merge=0.9997 (last merge round=33)
[S3] round=35 local utility u=0.006527 metrics={'f1_val': 0.9971434701490716, 'auprc': 0.9983759643604763, 'loss_val': 0.06025442392303292, 'psi': 0.9976364678336334}-{'f1_val': 0.9978389274664787, 'auprc': 0.9984935091429844, 'loss_val': 0.07783410063039135, 'psi': 0.998100760137081}
[S4] START round=35 head_norm_before_train=2.032703 cos_to_last_merge=0.9999 (last merge round=32)
[S4] round=35 local utility u=0.000000 metrics={'f1_val': 0.9504203488030398, 'auprc': 0.9713347807168285, 'loss_val': 0.2678763878435576, 'psi': 0.9587861215685554}-{'f1_val': 0.9510381571691009, 'auprc': 0.9809691687726548, 'loss_val': 0.2661304915129621, 'psi': 0.9630105618105225}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=35 metric=0.9504 head_norm=2.036453
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.637879e-02
[S4] stored merged vector for next round verification (round=35)
[S4] DEBUG after merge:  round=35 metric=0.9505 head_norm=2.041310 delta_norm=0.036379
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S5] START round=35 head_norm_before_train=1.533862 cos_to_last_merge=1.0000 (last merge round=34)
[S5] round=35 local utility u=0.000000 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9911943672463921, 'loss_val': 0.05702539520611793, 'psi': 0.9941018764373892}-{'f1_val': 0.9960402158980539, 'auprc': 0.9959085256131156, 'loss_val': 0.052104290628560423, 'psi': 0.9959875397840786}
[S6] START round=35 head_norm_before_train=1.441650 cos_to_last_merge=0.9988 (last merge round=33)
[S6] round=35 local utility u=0.000000 metrics={'f1_val': 0.8223279512968513, 'auprc': 0.9604595863646473, 'loss_val': 0.3959894047086171, 'psi': 0.8775806053239698}-{'f1_val': 0.8312903414271089, 'auprc': 0.9645551122127308, 'loss_val': 0.3901591533323716, 'psi': 0.8845962497413578}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=35 metric=0.8223 head_norm=1.488905
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.313808e-01
[S6] stored merged vector for next round verification (round=35)
[S6] DEBUG after merge:  round=35 metric=0.8224 head_norm=1.477043 delta_norm=0.131381
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S7] START round=35 head_norm_before_train=1.546484 cos_to_last_merge=0.9994 (last merge round=33)
[S7] round=35 local utility u=0.182954 metrics={'f1_val': 0.5976280462694241, 'auprc': 0.7874189946465902, 'loss_val': 0.7542085343370665, 'psi': 0.6735444256202905}-{'f1_val': 0.558200591477303, 'auprc': 0.7823595856051813, 'loss_val': 0.8683745120231737, 'psi': 0.6478641891284543}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=35 metric=0.5976 head_norm=1.572436
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.888875e-01
[S7] stored merged vector for next round verification (round=35)
[S7] DEBUG after merge:  round=35 metric=0.5903 head_norm=1.397606 delta_norm=0.288888
[S7] aggregate: ROLLBACK (f1_val pre=0.598 post=0.590 tol_abs=0.005 tol_rel=0.0)
[S8] START round=35 head_norm_before_train=1.463182 cos_to_last_merge=1.0000 (last merge round=34)
[S8] round=35 local utility u=0.000000 metrics={'f1_val': 0.9953659596578323, 'auprc': 0.9979981360257697, 'loss_val': 0.10536606927887077, 'psi': 0.9964188302050072}-{'f1_val': 0.9964900410640029, 'auprc': 0.998972592801196, 'loss_val': 0.0983508900713918, 'psi': 0.9974830617588801}
[S9] START round=35 head_norm_before_train=1.457151 cos_to_last_merge=0.9684 (last merge round=24)
[S9] round=35 local utility u=0.000000 metrics={'f1_val': 0.9718870025817585, 'auprc': 0.9984206023327755, 'loss_val': 0.09070871180137725, 'psi': 0.9825004424821653}-{'f1_val': 0.9962500947792776, 'auprc': 0.9953601071968686, 'loss_val': 0.032752371441758105, 'psi': 0.995894099746314}
[S10] START round=35 head_norm_before_train=1.810511 cos_to_last_merge=0.9835 (last merge round=25)
[S10] round=35 local utility u=0.002308 metrics={'f1_val': 0.993391017001491, 'auprc': 0.9954873039407677, 'loss_val': 0.0502426801861965, 'psi': 0.9942295317772016}-{'f1_val': 0.9945291067983943, 'auprc': 0.9925972056868879, 'loss_val': 0.05301761693055021, 'psi': 0.9937563463537917}
[S11] START round=35 head_norm_before_train=2.046803 cos_to_last_merge=0.9948 (last merge round=23)
[S11] round=35 local utility u=0.000260 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9988217394922829, 'loss_val': 0.02016921967316474, 'psi': 0.9977072497726595}-{'f1_val': 0.9969642566262439, 'auprc': 0.9989395638629913, 'loss_val': 0.021042669570990918, 'psi': 0.9977543795209428}
[S13] START round=35 head_norm_before_train=1.747216 cos_to_last_merge=1.0000 (last merge round=33)
[S13] round=35 local utility u=0.203670 metrics={'f1_val': 0.6153689726598071, 'auprc': 0.7047905948683131, 'loss_val': 0.6840972427822958, 'psi': 0.6511376215432094}-{'f1_val': 0.5689010229018447, 'auprc': 0.7155797280211663, 'loss_val': 0.8449968985817298, 'psi': 0.6275725049495734}
[S13] not sending this round → trigger blocked (psi=0.651)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=35 metric=0.6154 head_norm=1.751358
[S13] _apply_head_vector_avg (torch): Δ‖w‖=5.205146e-02
[S13] stored merged vector for next round verification (round=35)
[S13] DEBUG after merge:  round=35 metric=0.5774 head_norm=1.780420 delta_norm=0.052051
[S13] aggregate: ROLLBACK (f1_val pre=0.615 post=0.577 tol_abs=0.005 tol_rel=0.0)
[S14] START round=35 head_norm_before_train=1.529806 cos_to_last_merge=0.9693 (last merge round=24)
[S14] round=35 local utility u=0.005685 metrics={'f1_val': 0.9973862616479148, 'auprc': 0.9987437816808603, 'loss_val': 0.05165066056444306, 'psi': 0.997929269661093}-{'f1_val': 0.9961248879791463, 'auprc': 0.9990045827132702, 'loss_val': 0.05623384586641496, 'psi': 0.9972767658727959}
[S15] START round=35 head_norm_before_train=1.621601 cos_to_last_merge=1.0000 (last merge round=34)
[S15] round=35 local utility u=0.185918 metrics={'f1_val': 0.8847854509834117, 'auprc': 0.9944978082809279, 'loss_val': 0.19724902560911917, 'psi': 0.9286703939024182}-{'f1_val': 0.8287856480454654, 'auprc': 0.9901443111522722, 'loss_val': 0.22002506089166332, 'psi': 0.8933291132881882}
[S16] START round=35 head_norm_before_train=1.512828 cos_to_last_merge=0.9997 (last merge round=32)
[S16] round=35 local utility u=0.268090 metrics={'f1_val': 0.9179993258523191, 'auprc': 0.9874563217051122, 'loss_val': 0.37604009434330876, 'psi': 0.9457821241934363}-{'f1_val': 0.8614287599726517, 'auprc': 0.9910595652126745, 'loss_val': 0.5836062872610986, 'psi': 0.9132810820686608}
[S17] START round=35 head_norm_before_train=1.968102 (no previous merge yet)
[S17] round=35 local utility u=0.198115 metrics={'f1_val': 0.6045396459932573, 'auprc': 0.9734059519526969, 'loss_val': 1.0255738760730393, 'psi': 0.7520861683770331}-{'f1_val': 0.5983242274666173, 'auprc': 0.887748791946803, 'loss_val': 1.1275401085154024, 'psi': 0.7140940532586916}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[S10] not sending this round → trigger blocked (psi=0.994)
[S11] not sending this round → trigger blocked (psi=0.998)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:44916
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:44902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:44905
[S14] sending update (kind=head size=1800 to 1 peers)
[S11] ⇄ pheromone p=0.005 → S4@127.0.0.1:44904
[S3] not sending this round → trigger blocked (psi=0.998)
[S10] ⇄ pheromone p=0.013 → S13@127.0.0.1:44913
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] ⇄ pheromone p=0.071 → S3@127.0.0.1:44903
[S5] ⇄ pheromone p=0.016 → S15@127.0.0.1:44915
[S16] RECEIVED delta(kind=head bytes=1800) from S14
[S16] cosine check vs S14: cos=0.9971
[S14] ⇄ pheromone p=0.011 → S16@127.0.0.1:44916
[S16] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1802) from S16
[S5] cosine check vs S16: cos=0.9899
[S2] RECEIVED delta(kind=head bytes=1802) from S15
[S2] cosine check vs S15: cos=0.9301
[S3] ⇄ pheromone p=0.089 → S7@127.0.0.1:44908
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=35 metric=0.9180 head_norm=1.527847
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.975300e-02
[S16] stored merged vector for next round verification (round=35)
[S16] DEBUG after merge:  round=35 metric=0.9182 head_norm=1.536282 delta_norm=0.059753
[S16] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.185 → S5@127.0.0.1:44905
[S15] ⇄ pheromone p=0.187 → S2@127.0.0.1:44902
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] ⇄ pheromone p=0.007 → S8@127.0.0.1:44909
[S8] ⇄ pheromone p=0.041 → S6@127.0.0.1:44907
[S2] START round=36 head_norm_before_train=1.320191 cos_to_last_merge=0.9984 (last merge round=34)
[S2] round=36 local utility u=0.000000 metrics={'f1_val': 0.829126599201406, 'auprc': 0.9165814143881222, 'loss_val': 0.43409713547781514, 'psi': 0.8641085252760925}-{'f1_val': 0.9084306323157173, 'auprc': 0.830797786711452, 'loss_val': 0.557337789138376, 'psi': 0.8773774940740111}
[S3] START round=36 head_norm_before_train=1.307940 cos_to_last_merge=0.9985 (last merge round=33)
[S3] round=36 local utility u=0.000000 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.9984750859323595, 'loss_val': 0.1277786136943684, 'psi': 0.9760350856126161}-{'f1_val': 0.9971434701490716, 'auprc': 0.9983759643604763, 'loss_val': 0.06025442392303292, 'psi': 0.9976364678336334}
[S4] START round=36 head_norm_before_train=2.041310 cos_to_last_merge=1.0000 (last merge round=35)
[S4] round=36 local utility u=0.000000 metrics={'f1_val': 0.9399611049565559, 'auprc': 0.9584545312503209, 'loss_val': 0.28272652775038143, 'psi': 0.9473584754740619}-{'f1_val': 0.9504203488030398, 'auprc': 0.9713347807168285, 'loss_val': 0.2678763878435576, 'psi': 0.9587861215685554}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=36 head_norm_before_train=1.574916 cos_to_last_merge=0.9995 (last merge round=34)
[S5] round=36 local utility u=0.000000 metrics={'f1_val': 0.8826613818781699, 'auprc': 0.9877368620665978, 'loss_val': 0.1680710008885144, 'psi': 0.9246915739535411}-{'f1_val': 0.9960402158980539, 'auprc': 0.9911943672463921, 'loss_val': 0.05702539520611793, 'psi': 0.9941018764373892}
[S6] START round=36 head_norm_before_train=1.477043 cos_to_last_merge=1.0000 (last merge round=35)
[S6] round=36 local utility u=0.094754 metrics={'f1_val': 0.8368862892702479, 'auprc': 0.9726248783922222, 'loss_val': 0.3303264051126469, 'psi': 0.8911817249190376}-{'f1_val': 0.8223279512968513, 'auprc': 0.9604595863646473, 'loss_val': 0.3959894047086171, 'psi': 0.8775806053239698}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=36 head_norm_before_train=1.397606 cos_to_last_merge=1.0000 (last merge round=35)
[S7] round=36 local utility u=0.178778 metrics={'f1_val': 0.618358543240666, 'auprc': 0.7999869843572748, 'loss_val': 0.5587387933258567, 'psi': 0.6910099196873095}-{'f1_val': 0.5976280462694241, 'auprc': 0.7874189946465902, 'loss_val': 0.7542085343370665, 'psi': 0.6735444256202905}
[S7] not sending this round → trigger blocked (psi=0.691)
[S8] START round=36 head_norm_before_train=1.490348 cos_to_last_merge=0.9996 (last merge round=34)
[S8] round=36 local utility u=0.014385 metrics={'f1_val': 0.9964900410640029, 'auprc': 0.9982767169162969, 'loss_val': 0.08417637504150274, 'psi': 0.9972047114049205}-{'f1_val': 0.9953659596578323, 'auprc': 0.9979981360257697, 'loss_val': 0.10536606927887077, 'psi': 0.9964188302050072}
[S9] START round=36 head_norm_before_train=1.474563 cos_to_last_merge=0.9666 (last merge round=24)
[S9] round=36 local utility u=0.091820 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9907710551722687, 'loss_val': 0.030298514283702702, 'psi': 0.994058478936474}-{'f1_val': 0.9718870025817585, 'auprc': 0.9984206023327755, 'loss_val': 0.09070871180137725, 'psi': 0.9825004424821653}
[S10] START round=36 head_norm_before_train=1.829748 cos_to_last_merge=0.9820 (last merge round=25)
[S10] round=36 local utility u=0.000807 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9925624835647914, 'loss_val': 0.04668213785280674, 'psi': 0.9937424575049532}-{'f1_val': 0.993391017001491, 'auprc': 0.9954873039407677, 'loss_val': 0.0502426801861965, 'psi': 0.9942295317772016}
[S11] START round=36 head_norm_before_train=2.056362 cos_to_last_merge=0.9943 (last merge round=23)
[S11] round=36 local utility u=0.000046 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9986545222086534, 'loss_val': 0.019574647949241363, 'psi': 0.9976403628592077}-{'f1_val': 0.9969642566262439, 'auprc': 0.9988217394922829, 'loss_val': 0.02016921967316474, 'psi': 0.9977072497726595}
[S13] START round=36 head_norm_before_train=1.780420 cos_to_last_merge=1.0000 (last merge round=35)
[S13] round=36 local utility u=0.000000 metrics={'f1_val': 0.5958476825232155, 'auprc': 0.7359748712264389, 'loss_val': 0.8411660988409052, 'psi': 0.6518985580045049}-{'f1_val': 0.6153689726598071, 'auprc': 0.7047905948683131, 'loss_val': 0.6840972427822958, 'psi': 0.6511376215432094}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=36 head_norm_before_train=1.546980 cos_to_last_merge=0.9673 (last merge round=24)
[S14] round=36 local utility u=0.000000 metrics={'f1_val': 0.9959048342865731, 'auprc': 0.9990046055864436, 'loss_val': 0.050472780480693924, 'psi': 0.9971447428065212}-{'f1_val': 0.9973862616479148, 'auprc': 0.9987437816808603, 'loss_val': 0.05165066056444306, 'psi': 0.997929269661093}
[S15] START round=36 head_norm_before_train=1.652360 cos_to_last_merge=0.9997 (last merge round=34)
[S15] round=36 local utility u=0.203604 metrics={'f1_val': 0.937539252194447, 'auprc': 0.9964331862738816, 'loss_val': 0.11236991895450733, 'psi': 0.9610968258262209}-{'f1_val': 0.8847854509834117, 'auprc': 0.9944978082809279, 'loss_val': 0.19724902560911917, 'psi': 0.9286703939024182}
[S16] START round=36 head_norm_before_train=1.536282 cos_to_last_merge=1.0000 (last merge round=35)
[S16] round=36 local utility u=0.000000 metrics={'f1_val': 0.8952162452454542, 'auprc': 0.9895658450496295, 'loss_val': 0.2656996323691372, 'psi': 0.9329560851671244}-{'f1_val': 0.9179993258523191, 'auprc': 0.9874563217051122, 'loss_val': 0.37604009434330876, 'psi': 0.9457821241934363}
[S17] START round=36 head_norm_before_train=1.978661 (no previous merge yet)
[S17] round=36 local utility u=0.000000 metrics={'f1_val': 0.5857739457247788, 'auprc': 0.8841859539449127, 'loss_val': 1.219861173446546, 'psi': 0.7051387490128324}-{'f1_val': 0.6045396459932573, 'auprc': 0.9734059519526969, 'loss_val': 1.0255738760730393, 'psi': 0.7520861683770331}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:44913
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:44904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1811 reason=None
[S8] → sending delta(kind=head bytes=1811) to S6@127.0.0.1:44907
[S10] sending update (kind=head size=1797 to 1 peers)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=36 metric=0.8827 head_norm=1.609113
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.330975e-01
[S5] stored merged vector for next round verification (round=36)
[S5] DEBUG after merge:  round=36 metric=0.8670 head_norm=1.563350 delta_norm=0.133097
[S5] aggregate: ROLLBACK (f1_val pre=0.883 post=0.867 tol_abs=0.005 tol_rel=0.0)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1797 to 1 peers)
[S15] not sending this round → trigger blocked (psi=0.961)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=36 metric=0.8291 head_norm=1.353151
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.487554e-01
[S2] stored merged vector for next round verification (round=36)
[S2] DEBUG after merge:  round=36 metric=0.8286 head_norm=1.469362 delta_norm=0.348755
[S2] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S4] RECEIVED delta(kind=head bytes=1797) from S11
[S4] cosine check vs S11: cos=0.9996
[S13] RECEIVED delta(kind=head bytes=1797) from S10
[S13] cosine check vs S10: cos=0.9991
[S8] sending update (kind=head size=1811 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1811) from S8
[S6] cosine check vs S8: cos=0.9904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S9] → sending delta(kind=head bytes=1806) to S8@127.0.0.1:44909
[S9] sending update (kind=head size=1806 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1806) from S9
[S8] cosine check vs S9: cos=0.9923
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=36 metric=0.9965 head_norm=1.515980
[S8] _apply_head_vector_avg (torch): Δ‖w‖=9.410203e-02
[S8] stored merged vector for next round verification (round=36)
[S8] DEBUG after merge:  round=36 metric=0.9965 head_norm=1.499249 delta_norm=0.094102
[S8] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=37 head_norm_before_train=1.469362 cos_to_last_merge=1.0000 (last merge round=36)
[S2] round=37 local utility u=0.000000 metrics={'f1_val': 0.8275816687108184, 'auprc': 0.9143063235203093, 'loss_val': 0.48783748767733587, 'psi': 0.8622715306346147}-{'f1_val': 0.829126599201406, 'auprc': 0.9165814143881222, 'loss_val': 0.43409713547781514, 'psi': 0.8641085252760925}
[S3] START round=37 head_norm_before_train=1.353754 cos_to_last_merge=0.9966 (last merge round=33)
[S3] round=37 local utility u=0.055270 metrics={'f1_val': 0.9724918820927569, 'auprc': 0.9985336732934549, 'loss_val': 0.08591417244890455, 'psi': 0.9829085985730361}-{'f1_val': 0.9610750853994537, 'auprc': 0.9984750859323595, 'loss_val': 0.1277786136943684, 'psi': 0.9760350856126161}
[S4] START round=37 head_norm_before_train=2.044881 cos_to_last_merge=1.0000 (last merge round=35)
[S4] round=37 local utility u=0.002700 metrics={'f1_val': 0.9410670797738854, 'auprc': 0.9596659826972993, 'loss_val': 0.2875967131762164, 'psi': 0.948506640943251}-{'f1_val': 0.9399611049565559, 'auprc': 0.9584545312503209, 'loss_val': 0.28272652775038143, 'psi': 0.9473584754740619}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=37 metric=0.9411 head_norm=2.048074
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.288503e-02
[S4] stored merged vector for next round verification (round=37)
[S4] DEBUG after merge:  round=37 metric=0.9411 head_norm=2.056511 delta_norm=0.032885
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S5] START round=37 head_norm_before_train=1.563350 cos_to_last_merge=1.0000 (last merge round=36)
[S5] round=37 local utility u=0.402126 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9912640288711962, 'loss_val': 0.05467382238857972, 'psi': 0.9941297410873109}-{'f1_val': 0.8826613818781699, 'auprc': 0.9877368620665978, 'loss_val': 0.1680710008885144, 'psi': 0.9246915739535411}
[S6] START round=37 head_norm_before_train=1.519031 cos_to_last_merge=0.9993 (last merge round=35)
[S6] round=37 local utility u=0.000000 metrics={'f1_val': 0.8310584435209021, 'auprc': 0.9714212999849052, 'loss_val': 0.3248117486188994, 'psi': 0.8872035861065033}-{'f1_val': 0.8368862892702479, 'auprc': 0.9726248783922222, 'loss_val': 0.3303264051126469, 'psi': 0.8911817249190376}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=37 metric=0.8311 head_norm=1.556493
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.288782e-01
[S6] stored merged vector for next round verification (round=37)
[S6] DEBUG after merge:  round=37 metric=0.8311 head_norm=1.530955 delta_norm=0.128878
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S7] START round=37 head_norm_before_train=1.425806 cos_to_last_merge=0.9995 (last merge round=35)
[S7] round=37 local utility u=0.000000 metrics={'f1_val': 0.5515307269108232, 'auprc': 0.7867623309230036, 'loss_val': 0.87255365977944, 'psi': 0.6456233685156954}-{'f1_val': 0.618358543240666, 'auprc': 0.7999869843572748, 'loss_val': 0.5587387933258567, 'psi': 0.6910099196873095}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=37 head_norm_before_train=1.499249 cos_to_last_merge=1.0000 (last merge round=36)
[S8] round=37 local utility u=0.000000 metrics={'f1_val': 0.9950949602617258, 'auprc': 0.9983164326399129, 'loss_val': 0.11261695757712217, 'psi': 0.9963835492130007}-{'f1_val': 0.9964900410640029, 'auprc': 0.9982767169162969, 'loss_val': 0.08417637504150274, 'psi': 0.9972047114049205}
[S9] START round=37 head_norm_before_train=1.488290 cos_to_last_merge=0.9652 (last merge round=24)
[S9] round=37 local utility u=0.000000 metrics={'f1_val': 0.9893150859224193, 'auprc': 0.9982933758333015, 'loss_val': 0.045323882756743615, 'psi': 0.9929064018867721}-{'f1_val': 0.9962500947792776, 'auprc': 0.9907710551722687, 'loss_val': 0.030298514283702702, 'psi': 0.994058478936474}
[S10] START round=37 head_norm_before_train=1.846743 cos_to_last_merge=0.9806 (last merge round=25)
[S10] round=37 local utility u=0.001611 metrics={'f1_val': 0.993391017001491, 'auprc': 0.9958806500222719, 'loss_val': 0.046586410264596576, 'psi': 0.9943868702098033}-{'f1_val': 0.9945291067983943, 'auprc': 0.9925624835647914, 'loss_val': 0.04668213785280674, 'psi': 0.9937424575049532}
[S11] START round=37 head_norm_before_train=2.065438 cos_to_last_merge=0.9938 (last merge round=23)
[S11] round=37 local utility u=0.000109 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9986421013158587, 'loss_val': 0.019319347146649003, 'psi': 0.9976353945020897}-{'f1_val': 0.9969642566262439, 'auprc': 0.9986545222086534, 'loss_val': 0.019574647949241363, 'psi': 0.9976403628592077}
[S13] START round=37 head_norm_before_train=1.787054 cos_to_last_merge=1.0000 (last merge round=35)
[S13] round=37 local utility u=0.126221 metrics={'f1_val': 0.6228347235965515, 'auprc': 0.7427685534958387, 'loss_val': 0.7710281022267355, 'psi': 0.6708082555562664}-{'f1_val': 0.5958476825232155, 'auprc': 0.7359748712264389, 'loss_val': 0.8411660988409052, 'psi': 0.6518985580045049}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=37 metric=0.6228 head_norm=1.792653
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.849783e-02
[S13] stored merged vector for next round verification (round=37)
[S13] DEBUG after merge:  round=37 metric=0.6187 head_norm=1.819253 delta_norm=0.048498
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] START round=37 head_norm_before_train=1.559269 cos_to_last_merge=0.9658 (last merge round=24)
[S14] round=37 local utility u=0.003118 metrics={'f1_val': 0.9965123182311155, 'auprc': 0.9990064334845163, 'loss_val': 0.04788791684161969, 'psi': 0.9975099643324759}-{'f1_val': 0.9959048342865731, 'auprc': 0.9990046055864436, 'loss_val': 0.050472780480693924, 'psi': 0.9971447428065212}
[S15] START round=37 head_norm_before_train=1.684413 cos_to_last_merge=0.9989 (last merge round=34)
[S15] round=37 local utility u=0.000000 metrics={'f1_val': 0.9261812905260913, 'auprc': 0.9960236428339985, 'loss_val': 0.11240875395196577, 'psi': 0.9541182314492542}-{'f1_val': 0.937539252194447, 'auprc': 0.9964331862738816, 'loss_val': 0.11236991895450733, 'psi': 0.9610968258262209}
[S16] START round=37 head_norm_before_train=1.552250 cos_to_last_merge=0.9999 (last merge round=35)
[S16] round=37 local utility u=0.385137 metrics={'f1_val': 0.9905802878935278, 'auprc': 0.991920757025839, 'loss_val': 0.07467455720821646, 'psi': 0.9911164755464523}-{'f1_val': 0.8952162452454542, 'auprc': 0.9895658450496295, 'loss_val': 0.2656996323691372, 'psi': 0.9329560851671244}
[S17] START round=37 head_norm_before_train=1.986911 (no previous merge yet)
[S17] round=37 local utility u=0.071895 metrics={'f1_val': 0.5878868005287032, 'auprc': 0.8975891714883328, 'loss_val': 1.1289571240223815, 'psi': 0.7117677489125551}-{'f1_val': 0.5857739457247788, 'auprc': 0.8841859539449127, 'loss_val': 1.219861173446546, 'psi': 0.7051387490128324}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:44916
[S11] not sending this round → trigger blocked (psi=0.998)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:44915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:44913
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] → sending delta(kind=head bytes=1805) to S7@127.0.0.1:44908
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1797 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:44905
[S15] RECEIVED delta(kind=head bytes=1799) from S5
[S15] cosine check vs S5: cos=0.9660
[S13] RECEIVED delta(kind=head bytes=1797) from S10
[S13] cosine check vs S10: cos=0.9996
[S16] RECEIVED delta(kind=head bytes=1801) from S14
[S16] cosine check vs S14: cos=0.9979
[S16] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1805 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1799) from S16
[S5] cosine check vs S16: cos=0.9937
[S7] RECEIVED delta(kind=head bytes=1805) from S3
[S7] cosine check vs S3: cos=0.9742
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=37 metric=0.9262 head_norm=1.713251
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.234744e-01
[S15] stored merged vector for next round verification (round=37)
[S15] DEBUG after merge:  round=37 metric=0.9188 head_norm=1.639725 delta_norm=0.223474
[S15] aggregate: ROLLBACK (f1_val pre=0.926 post=0.919 tol_abs=0.005 tol_rel=0.0)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=37 metric=0.9906 head_norm=1.568841
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.044529e-02
[S16] stored merged vector for next round verification (round=37)
[S16] DEBUG after merge:  round=37 metric=0.9906 head_norm=1.568838 delta_norm=0.050445
[S16] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=38 head_norm_before_train=1.498896 cos_to_last_merge=0.9978 (last merge round=36)
[S2] round=38 local utility u=0.060158 metrics={'f1_val': 0.8501210782559869, 'auprc': 0.9005475604138735, 'loss_val': 0.46148067073743804, 'psi': 0.8702916711191415}-{'f1_val': 0.8275816687108184, 'auprc': 0.9143063235203093, 'loss_val': 0.48783748767733587, 'psi': 0.8622715306346147}
[S3] START round=38 head_norm_before_train=1.396333 cos_to_last_merge=0.9945 (last merge round=33)
[S3] round=38 local utility u=0.093044 metrics={'f1_val': 0.9957630865773888, 'auprc': 0.9985643484986241, 'loss_val': 0.03954580766977786, 'psi': 0.9968835913458829}-{'f1_val': 0.9724918820927569, 'auprc': 0.9985336732934549, 'loss_val': 0.08591417244890455, 'psi': 0.9829085985730361}
[S4] START round=38 head_norm_before_train=2.056511 cos_to_last_merge=1.0000 (last merge round=37)
[S4] round=38 local utility u=0.035607 metrics={'f1_val': 0.9454528478430244, 'auprc': 0.9681371932702942, 'loss_val': 0.26811085443340904, 'psi': 0.9545265860139324}-{'f1_val': 0.9410670797738854, 'auprc': 0.9596659826972993, 'loss_val': 0.2875967131762164, 'psi': 0.948506640943251}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] sending update (kind=head size=1794 to 1 peers)
[S5] START round=38 head_norm_before_train=1.594380 cos_to_last_merge=0.9997 (last merge round=36)
[S5] round=38 local utility u=0.003360 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9911196353148858, 'loss_val': 0.04752100549907618, 'psi': 0.9940719836647867}-{'f1_val': 0.9960402158980539, 'auprc': 0.9912640288711962, 'loss_val': 0.05467382238857972, 'psi': 0.9941297410873109}
[S6] START round=38 head_norm_before_train=1.530955 cos_to_last_merge=1.0000 (last merge round=37)
[S6] round=38 local utility u=0.000000 metrics={'f1_val': 0.8243798816468659, 'auprc': 0.9643332688760641, 'loss_val': 0.40007525039749603, 'psi': 0.8803612365385451}-{'f1_val': 0.8310584435209021, 'auprc': 0.9714212999849052, 'loss_val': 0.3248117486188994, 'psi': 0.8872035861065033}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=38 head_norm_before_train=1.470019 cos_to_last_merge=0.9977 (last merge round=35)
[S7] round=38 local utility u=0.174282 metrics={'f1_val': 0.5904661443174143, 'auprc': 0.7927560767800389, 'loss_val': 0.7755835334544311, 'psi': 0.6713821173024641}-{'f1_val': 0.5515307269108232, 'auprc': 0.7867623309230036, 'loss_val': 0.87255365977944, 'psi': 0.6456233685156954}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=38 metric=0.5905 head_norm=1.500618
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.834405e-01
[S7] stored merged vector for next round verification (round=38)
[S7] DEBUG after merge:  round=38 metric=0.5814 head_norm=1.437759 delta_norm=0.183441
[S7] aggregate: ROLLBACK (f1_val pre=0.590 post=0.581 tol_abs=0.005 tol_rel=0.0)
[S8] START round=38 head_norm_before_train=1.519645 cos_to_last_merge=0.9998 (last merge round=36)
[S8] round=38 local utility u=0.000000 metrics={'f1_val': 0.9911986237799583, 'auprc': 0.9986097198934957, 'loss_val': 0.10241255429309898, 'psi': 0.9941630622253732}-{'f1_val': 0.9950949602617258, 'auprc': 0.9983164326399129, 'loss_val': 0.11261695757712217, 'psi': 0.9963835492130007}
[S9] START round=38 head_norm_before_train=1.500703 cos_to_last_merge=0.9640 (last merge round=24)
[S9] round=38 local utility u=0.028670 metrics={'f1_val': 0.99644216417821, 'auprc': 0.9973540030114253, 'loss_val': 0.0279281198233621, 'psi': 0.996806899711496}-{'f1_val': 0.9893150859224193, 'auprc': 0.9982933758333015, 'loss_val': 0.045323882756743615, 'psi': 0.9929064018867721}
[S10] START round=38 head_norm_before_train=1.863262 cos_to_last_merge=0.9792 (last merge round=25)
[S10] round=38 local utility u=0.000583 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9926147767703439, 'loss_val': 0.04245115196282062, 'psi': 0.9937633747871741}-{'f1_val': 0.993391017001491, 'auprc': 0.9958806500222719, 'loss_val': 0.046586410264596576, 'psi': 0.9943868702098033}
[S11] START round=38 head_norm_before_train=2.072752 cos_to_last_merge=0.9935 (last merge round=23)
[S11] round=38 local utility u=0.000481 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.998722911585716, 'loss_val': 0.01860023879694641, 'psi': 0.9976677186100327}-{'f1_val': 0.9969642566262439, 'auprc': 0.9986421013158587, 'loss_val': 0.019319347146649003, 'psi': 0.9976353945020897}
[S13] START round=38 head_norm_before_train=1.819253 cos_to_last_merge=1.0000 (last merge round=37)
[S13] round=38 local utility u=0.102987 metrics={'f1_val': 0.6415811889827483, 'auprc': 0.7547367700843707, 'loss_val': 0.7134368674870426, 'psi': 0.6868434214233973}-{'f1_val': 0.6228347235965515, 'auprc': 0.7427685534958387, 'loss_val': 0.7710281022267355, 'psi': 0.6708082555562664}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=38 metric=0.6416 head_norm=1.827714
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.415961e-02
[S13] stored merged vector for next round verification (round=38)
[S13] DEBUG after merge:  round=38 metric=0.6465 head_norm=1.845257 delta_norm=0.034160
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] START round=38 head_norm_before_train=1.570455 cos_to_last_merge=0.9644 (last merge round=24)
[S14] round=38 local utility u=0.000546 metrics={'f1_val': 0.9963222473248441, 'auprc': 0.9990073334073055, 'loss_val': 0.04565872418070851, 'psi': 0.9973962817578286}-{'f1_val': 0.9965123182311155, 'auprc': 0.9990064334845163, 'loss_val': 0.04788791684161969, 'psi': 0.9975099643324759}
[S15] START round=38 head_norm_before_train=1.639725 cos_to_last_merge=1.0000 (last merge round=37)
[S15] round=38 local utility u=0.000000 metrics={'f1_val': 0.7708379602966549, 'auprc': 0.9878575668901112, 'loss_val': 0.2802509606315434, 'psi': 0.8576458029340375}-{'f1_val': 0.9261812905260913, 'auprc': 0.9960236428339985, 'loss_val': 0.11240875395196577, 'psi': 0.9541182314492542}
[S16] START round=38 head_norm_before_train=1.568838 cos_to_last_merge=1.0000 (last merge round=37)
[S16] round=38 local utility u=0.000000 metrics={'f1_val': 0.8638799122619505, 'auprc': 0.990739028317007, 'loss_val': 0.6268895724792013, 'psi': 0.914623558683973}-{'f1_val': 0.9905802878935278, 'auprc': 0.991920757025839, 'loss_val': 0.07467455720821646, 'psi': 0.9911164755464523}
[S17] START round=38 head_norm_before_train=1.991929 (no previous merge yet)
[S17] round=38 local utility u=0.098548 metrics={'f1_val': 0.5963703556616158, 'auprc': 0.9406251539982428, 'loss_val': 1.1118710796622835, 'psi': 0.7340722749962666}-{'f1_val': 0.5878868005287032, 'auprc': 0.8975891714883328, 'loss_val': 1.1289571240223815, 'psi': 0.7117677489125551}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:44915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:44916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:44903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:44913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] → sending delta(kind=head bytes=1793) to S4@127.0.0.1:44904
[S2] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1793 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:44908
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] RECEIVED delta(kind=head bytes=1802) from S5
[S15] cosine check vs S5: cos=0.9897
[S13] RECEIVED delta(kind=head bytes=1801) from S10
[S13] cosine check vs S10: cos=0.9998
[S4] RECEIVED delta(kind=head bytes=1793) from S11
[S4] cosine check vs S11: cos=0.9997
[S3] RECEIVED delta(kind=head bytes=1799) from S2
[S3] cosine check vs S2: cos=0.5366
[S16] RECEIVED delta(kind=head bytes=1799) from S14
[S16] cosine check vs S14: cos=0.9989
[S3] sending update (kind=head size=1799 to 1 peers)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=38 metric=0.9960 head_norm=1.631441
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.095822e-01
[S5] stored merged vector for next round verification (round=38)
[S5] DEBUG after merge:  round=38 metric=0.9960 head_norm=1.596691 delta_norm=0.109582
[S5] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S7] RECEIVED delta(kind=head bytes=1799) from S3
[S7] cosine check vs S3: cos=0.9915
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=38 metric=0.7708 head_norm=1.663566
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.193632e-01
[S15] stored merged vector for next round verification (round=38)
[S15] DEBUG after merge:  round=38 metric=0.7613 head_norm=1.643253 delta_norm=0.119363
[S15] aggregate: ROLLBACK (f1_val pre=0.771 post=0.761 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=38 metric=0.8639 head_norm=1.586746
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.665248e-02
[S16] stored merged vector for next round verification (round=38)
[S16] DEBUG after merge:  round=38 metric=0.8641 head_norm=1.584883 delta_norm=0.036652
[S16] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:44909
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=38 metric=0.9958 head_norm=1.432395
[S3] _apply_head_vector_avg (torch): Δ‖w‖=7.151445e-01
[S3] stored merged vector for next round verification (round=38)
[S3] DEBUG after merge:  round=38 metric=0.9958 head_norm=1.299934 delta_norm=0.715145
[S3] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S9] sending update (kind=head size=1798 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1798) from S9
[S8] cosine check vs S9: cos=0.9950
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=38 metric=0.9912 head_norm=1.542906
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.796903e-02
[S8] stored merged vector for next round verification (round=38)
[S8] DEBUG after merge:  round=38 metric=0.9889 head_norm=1.526536 delta_norm=0.077969
[S8] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=39 head_norm_before_train=1.533220 cos_to_last_merge=0.9924 (last merge round=36)
[S2] round=39 local utility u=0.000000 metrics={'f1_val': 0.654665519511196, 'auprc': 0.8311041357929183, 'loss_val': 0.720836570412107, 'psi': 0.725240966023885}-{'f1_val': 0.8501210782559869, 'auprc': 0.9005475604138735, 'loss_val': 0.46148067073743804, 'psi': 0.8702916711191415}
[S3] START round=39 head_norm_before_train=1.299934 cos_to_last_merge=1.0000 (last merge round=38)
[S3] round=39 local utility u=0.000000 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.9972981229855449, 'loss_val': 0.14502163349643052, 'psi': 0.9755643004338902}-{'f1_val': 0.9957630865773888, 'auprc': 0.9985643484986241, 'loss_val': 0.03954580766977786, 'psi': 0.9968835913458829}
[S4] START round=39 head_norm_before_train=2.060468 cos_to_last_merge=1.0000 (last merge round=37)
[S4] round=39 local utility u=0.007563 metrics={'f1_val': 0.9450986482289198, 'auprc': 0.9764205871197233, 'loss_val': 0.2757097687153209, 'psi': 0.9576274237852412}-{'f1_val': 0.9454528478430244, 'auprc': 0.9681371932702942, 'loss_val': 0.26811085443340904, 'psi': 0.9545265860139324}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=39 metric=0.9451 head_norm=2.060642
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.995580e-02
[S4] stored merged vector for next round verification (round=39)
[S4] DEBUG after merge:  round=39 metric=0.9451 head_norm=2.070408 delta_norm=0.029956
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S4] r=40 psi=0.958 u=0.0076 p_local=0.0162 f1=0.945 auprc=0.976 bytes=39577
[S5] START round=39 head_norm_before_train=1.596691 cos_to_last_merge=1.0000 (last merge round=38)
[S5] round=39 local utility u=0.009651 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9975371309018134, 'loss_val': 0.04747101720362021, 'psi': 0.9966389818995578}-{'f1_val': 0.9960402158980539, 'auprc': 0.9911196353148858, 'loss_val': 0.04752100549907618, 'psi': 0.9940719836647867}
[S6] START round=39 head_norm_before_train=1.558863 cos_to_last_merge=0.9996 (last merge round=37)
[S6] round=39 local utility u=0.167602 metrics={'f1_val': 0.8476466670266524, 'auprc': 0.9878902445356127, 'loss_val': 0.27514369060258026, 'psi': 0.9037440980302365}-{'f1_val': 0.8243798816468659, 'auprc': 0.9643332688760641, 'loss_val': 0.40007525039749603, 'psi': 0.8803612365385451}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] sending update (kind=head size=1804 to 1 peers)
[S6] r=40 psi=0.904 u=0.1676 p_local=0.1332 f1=0.848 auprc=0.988 bytes=34179
[S7] START round=39 head_norm_before_train=1.437759 cos_to_last_merge=1.0000 (last merge round=38)
[S7] round=39 local utility u=0.000000 metrics={'f1_val': 0.5014701986177085, 'auprc': 0.7823295480857284, 'loss_val': 0.908580631925977, 'psi': 0.6138139384049164}-{'f1_val': 0.5904661443174143, 'auprc': 0.7927560767800389, 'loss_val': 0.7755835334544311, 'psi': 0.6713821173024641}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=39 metric=0.5015 head_norm=1.461717
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.080243e-01
[S7] stored merged vector for next round verification (round=39)
[S7] DEBUG after merge:  round=39 metric=0.4918 head_norm=1.443093 delta_norm=0.108024
[S7] aggregate: ROLLBACK (f1_val pre=0.501 post=0.492 tol_abs=0.005 tol_rel=0.0)
[S7] r=40 psi=0.614 u=0.0000 p_local=0.1205 f1=0.501 auprc=0.782 bytes=35980
[S8] START round=39 head_norm_before_train=1.526536 cos_to_last_merge=1.0000 (last merge round=38)
[S8] round=39 local utility u=0.019936 metrics={'f1_val': 0.994792642153961, 'auprc': 0.9990307774622397, 'loss_val': 0.08536794778714399, 'psi': 0.9964878962772725}-{'f1_val': 0.9911986237799583, 'auprc': 0.9986097198934957, 'loss_val': 0.10241255429309898, 'psi': 0.9941630622253732}
[S9] START round=39 head_norm_before_train=1.514010 cos_to_last_merge=0.9627 (last merge round=24)
[S9] round=39 local utility u=0.000000 metrics={'f1_val': 0.995999768632607, 'auprc': 0.9982936032416028, 'loss_val': 0.029561118104783943, 'psi': 0.9969173024762054}-{'f1_val': 0.99644216417821, 'auprc': 0.9973540030114253, 'loss_val': 0.0279281198233621, 'psi': 0.996806899711496}
[S10] START round=39 head_norm_before_train=1.878020 cos_to_last_merge=0.9782 (last merge round=25)
[S10] round=39 local utility u=0.000000 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.992590570204617, 'loss_val': 0.04256252426617326, 'psi': 0.9937536921608834}-{'f1_val': 0.9945291067983943, 'auprc': 0.9926147767703439, 'loss_val': 0.04245115196282062, 'psi': 0.9937633747871741}
[S11] START round=39 head_norm_before_train=2.080559 cos_to_last_merge=0.9932 (last merge round=23)
[S11] round=39 local utility u=0.000257 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.998735532552411, 'loss_val': 0.018123646273826944, 'psi': 0.9976727669967107}-{'f1_val': 0.9969642566262439, 'auprc': 0.998722911585716, 'loss_val': 0.01860023879694641, 'psi': 0.9976677186100327}
[S13] START round=39 head_norm_before_train=1.845257 cos_to_last_merge=1.0000 (last merge round=38)
[S13] round=39 local utility u=0.094509 metrics={'f1_val': 0.6540206481645341, 'auprc': 0.7588224478344989, 'loss_val': 0.6113126274279679, 'psi': 0.69594136803252}-{'f1_val': 0.6415811889827483, 'auprc': 0.7547367700843707, 'loss_val': 0.7134368674870426, 'psi': 0.6868434214233973}
[S13] not sending this round → trigger blocked (psi=0.696)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=39 metric=0.6540 head_norm=1.852165
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.495977e-02
[S13] stored merged vector for next round verification (round=39)
[S13] DEBUG after merge:  round=39 metric=0.6503 head_norm=1.864970 delta_norm=0.024960
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S13] r=40 psi=0.696 u=0.0945 p_local=0.1034 f1=0.654 auprc=0.759 bytes=35998
[S14] START round=39 head_norm_before_train=1.583866 cos_to_last_merge=0.9630 (last merge round=24)
[S14] round=39 local utility u=0.001780 metrics={'f1_val': 0.9965155232876948, 'auprc': 0.9990069199768241, 'loss_val': 0.04325722908325543, 'psi': 0.9975120819633465}-{'f1_val': 0.9963222473248441, 'auprc': 0.9990073334073055, 'loss_val': 0.04565872418070851, 'psi': 0.9973962817578286}
[S15] START round=39 head_norm_before_train=1.643253 cos_to_last_merge=1.0000 (last merge round=38)
[S15] round=39 local utility u=0.786478 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9955503673506124, 'loss_val': 0.08582618736274039, 'psi': 0.9962681479727573}-{'f1_val': 0.7708379602966549, 'auprc': 0.9878575668901112, 'loss_val': 0.2802509606315434, 'psi': 0.8576458029340375}
[S16] START round=39 head_norm_before_train=1.584883 cos_to_last_merge=1.0000 (last merge round=38)
[S16] round=39 local utility u=0.000000 metrics={'f1_val': 0.8483191026069812, 'auprc': 0.9942863941130671, 'loss_val': 0.7411276933766572, 'psi': 0.9067060192094156}-{'f1_val': 0.8638799122619505, 'auprc': 0.990739028317007, 'loss_val': 0.6268895724792013, 'psi': 0.914623558683973}
[S17] START round=39 head_norm_before_train=1.997487 (no previous merge yet)
[S17] round=39 local utility u=0.000000 metrics={'f1_val': 0.5934132629097072, 'auprc': 0.9482388425144336, 'loss_val': 1.1424531537195843, 'psi': 0.7353434947515978}-{'f1_val': 0.5963703556616158, 'auprc': 0.9406251539982428, 'loss_val': 1.1118710796622835, 'psi': 0.7340722749962666}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=40 psi=0.735 u=0.0000 p_local=0.0668 f1=0.593 auprc=0.948 bytes=34143
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:44904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] → sending delta(kind=head bytes=1805) to S15@127.0.0.1:44915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:44916
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:44907
[S14] sending update (kind=head size=1801 to 1 peers)
[S10] r=40 psi=0.994 u=0.0000 p_local=0.0058 f1=0.995 auprc=0.993 bytes=44989
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S15] → sending delta(kind=head bytes=1807) to S2@127.0.0.1:44902
[S2] r=40 psi=0.725 u=0.0000 p_local=0.0385 f1=0.655 auprc=0.831 bytes=37759
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1805 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] RECEIVED delta(kind=head bytes=1799) from S11
[S4] cosine check vs S11: cos=0.9999
[S15] RECEIVED delta(kind=head bytes=1805) from S5
[S15] cosine check vs S5: cos=0.9925
[S16] RECEIVED delta(kind=head bytes=1801) from S14
[S16] cosine check vs S14: cos=0.9993
[S11] r=40 psi=0.998 u=0.0003 p_local=0.0022 f1=0.997 auprc=0.999 bytes=48540
[S5] r=40 psi=0.997 u=0.0097 p_local=0.0603 f1=0.996 auprc=0.998 bytes=46819
[S15] sending update (kind=head size=1807 to 1 peers)
[S14] r=40 psi=0.998 u=0.0018 p_local=0.0053 f1=0.997 auprc=0.999 bytes=48583
[S8] sending update (kind=head size=1804 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1807) from S15
[S2] cosine check vs S15: cos=0.9289
[S6] RECEIVED delta(kind=head bytes=1804) from S8
[S6] cosine check vs S8: cos=0.9865
[S3] r=40 psi=0.976 u=0.0000 p_local=0.0585 f1=0.961 auprc=0.997 bytes=37778
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=39 metric=0.8483 head_norm=1.603916
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.110365e-02
[S16] stored merged vector for next round verification (round=39)
[S16] DEBUG after merge:  round=39 metric=0.8488 head_norm=1.600078 delta_norm=0.031104
[S16] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S16] r=40 psi=0.907 u=0.0000 p_local=0.1251 f1=0.848 auprc=0.994 bytes=39565
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=39 metric=0.9967 head_norm=1.667912
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.026693e-01
[S15] stored merged vector for next round verification (round=39)
[S15] DEBUG after merge:  round=39 metric=0.9964 head_norm=1.645710 delta_norm=0.102669
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S15] r=40 psi=0.996 u=0.7865 p_local=0.2547 f1=0.997 auprc=0.996 bytes=35975
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=40 psi=0.997 u=0.0000 p_local=0.0169 f1=0.996 auprc=0.998 bytes=41389
[S8] r=40 psi=0.996 u=0.0199 p_local=0.0224 f1=0.995 auprc=0.999 bytes=44939
[S2] START round=40 head_norm_before_train=1.565017 cos_to_last_merge=0.9864 (last merge round=36)
[S2] round=40 local utility u=0.633349 metrics={'f1_val': 0.7977131416804903, 'auprc': 0.8775193846030371, 'loss_val': 0.4516705326617246, 'psi': 0.829635638849509}-{'f1_val': 0.654665519511196, 'auprc': 0.8311041357929183, 'loss_val': 0.720836570412107, 'psi': 0.725240966023885}
[S3] START round=40 head_norm_before_train=1.346213 cos_to_last_merge=0.9989 (last merge round=38)
[S3] round=40 local utility u=0.140081 metrics={'f1_val': 0.9949293084644328, 'auprc': 0.9974782235884145, 'loss_val': 0.06852558047086417, 'psi': 0.9959488745140255}-{'f1_val': 0.9610750853994537, 'auprc': 0.9972981229855449, 'loss_val': 0.14502163349643052, 'psi': 0.9755643004338902}
[S4] START round=40 head_norm_before_train=2.070408 cos_to_last_merge=1.0000 (last merge round=39)
[S4] round=40 local utility u=0.044531 metrics={'f1_val': 0.9545092335895101, 'auprc': 0.9815766270888882, 'loss_val': 0.2585798320067322, 'psi': 0.9653361909892613}-{'f1_val': 0.9450986482289198, 'auprc': 0.9764205871197233, 'loss_val': 0.2757097687153209, 'psi': 0.9576274237852412}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] sending update (kind=head size=1794 to 1 peers)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=40 metric=0.9545 head_norm=2.074551
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.185758e-02
[S4] stored merged vector for next round verification (round=40)
[S4] DEBUG after merge:  round=40 metric=0.9538 head_norm=2.081328 delta_norm=0.021858
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S5] START round=40 head_norm_before_train=1.629686 cos_to_last_merge=0.9997 (last merge round=38)
[S5] round=40 local utility u=0.003615 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9980782324991864, 'loss_val': 0.04186462348540654, 'psi': 0.9968554225385069}-{'f1_val': 0.9960402158980539, 'auprc': 0.9975371309018134, 'loss_val': 0.04747101720362021, 'psi': 0.9966389818995578}
[S6] START round=40 head_norm_before_train=1.582945 cos_to_last_merge=0.9988 (last merge round=37)
[S6] round=40 local utility u=0.470692 metrics={'f1_val': 0.9833846279372573, 'auprc': 0.9738996181046423, 'loss_val': 0.10621587087572351, 'psi': 0.9795906240042114}-{'f1_val': 0.8476466670266524, 'auprc': 0.9878902445356127, 'loss_val': 0.27514369060258026, 'psi': 0.9037440980302365}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=40 metric=0.9834 head_norm=1.605863
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.446227e-01
[S6] stored merged vector for next round verification (round=40)
[S6] DEBUG after merge:  round=40 metric=0.9830 head_norm=1.568632 delta_norm=0.144623
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S7] START round=40 head_norm_before_train=1.443093 cos_to_last_merge=1.0000 (last merge round=39)
[S7] round=40 local utility u=0.792578 metrics={'f1_val': 0.6592087731153857, 'auprc': 0.8275710363906258, 'loss_val': 0.40558063679828016, 'psi': 0.7265536784254818}-{'f1_val': 0.5014701986177085, 'auprc': 0.7823295480857284, 'loss_val': 0.908580631925977, 'psi': 0.6138139384049164}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=40 head_norm_before_train=1.544103 cos_to_last_merge=0.9999 (last merge round=38)
[S8] round=40 local utility u=0.002148 metrics={'f1_val': 0.9946459649293765, 'auprc': 0.999104811291042, 'loss_val': 0.08041492532538302, 'psi': 0.9964295034740427}-{'f1_val': 0.994792642153961, 'auprc': 0.9990307774622397, 'loss_val': 0.08536794778714399, 'psi': 0.9964878962772725}
[S9] START round=40 head_norm_before_train=1.521610 cos_to_last_merge=0.9620 (last merge round=24)
[S9] round=40 local utility u=0.000000 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9918019901297082, 'loss_val': 0.026318690573948922, 'psi': 0.9947362908107406}-{'f1_val': 0.995999768632607, 'auprc': 0.9982936032416028, 'loss_val': 0.029561118104783943, 'psi': 0.9969173024762054}
[S10] START round=40 head_norm_before_train=1.891544 cos_to_last_merge=0.9772 (last merge round=25)
[S10] round=40 local utility u=0.000200 metrics={'f1_val': 0.993871046050545, 'auprc': 0.9941059304222455, 'loss_val': 0.04275979035998425, 'psi': 0.9939649997992251}-{'f1_val': 0.9945291067983943, 'auprc': 0.992590570204617, 'loss_val': 0.04256252426617326, 'psi': 0.9937536921608834}
[S11] START round=40 head_norm_before_train=2.088312 cos_to_last_merge=0.9927 (last merge round=23)
[S11] round=40 local utility u=0.000000 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.998694752986427, 'loss_val': 0.018405496006712672, 'psi': 0.9976564551703171}-{'f1_val': 0.9969642566262439, 'auprc': 0.998735532552411, 'loss_val': 0.018123646273826944, 'psi': 0.9976727669967107}
[S13] START round=40 head_norm_before_train=1.864970 cos_to_last_merge=1.0000 (last merge round=39)
[S13] round=40 local utility u=0.117369 metrics={'f1_val': 0.7058949614593881, 'auprc': 0.7916426989234693, 'loss_val': 0.7862815178726184, 'psi': 0.7401940564450206}-{'f1_val': 0.6540206481645341, 'auprc': 0.7588224478344989, 'loss_val': 0.6113126274279679, 'psi': 0.69594136803252}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=40 head_norm_before_train=1.596836 cos_to_last_merge=0.9615 (last merge round=24)
[S14] round=40 local utility u=0.000522 metrics={'f1_val': 0.996345017535854, 'auprc': 0.9990062442744891, 'loss_val': 0.04118865483855268, 'psi': 0.9974095082313081}-{'f1_val': 0.9965155232876948, 'auprc': 0.9990069199768241, 'loss_val': 0.04325722908325543, 'psi': 0.9975120819633465}
[S15] START round=40 head_norm_before_train=1.645710 cos_to_last_merge=1.0000 (last merge round=39)
[S15] round=40 local utility u=0.000000 metrics={'f1_val': 0.7283852303836417, 'auprc': 0.9562235684610222, 'loss_val': 0.3977644954991606, 'psi': 0.8195205656145939}-{'f1_val': 0.9967466683875206, 'auprc': 0.9955503673506124, 'loss_val': 0.08582618736274039, 'psi': 0.9962681479727573}
[S16] START round=40 head_norm_before_train=1.600078 cos_to_last_merge=1.0000 (last merge round=39)
[S16] round=40 local utility u=0.483321 metrics={'f1_val': 0.9371372999845466, 'auprc': 0.9948883600957013, 'loss_val': 0.3092015316490635, 'psi': 0.9602377240290085}-{'f1_val': 0.8483191026069812, 'auprc': 0.9942863941130671, 'loss_val': 0.7411276933766572, 'psi': 0.9067060192094156}
[S17] START round=40 head_norm_before_train=2.004279 (no previous merge yet)
[S17] round=40 local utility u=0.000000 metrics={'f1_val': 0.6131218097239222, 'auprc': 0.8390605190725509, 'loss_val': 1.145998024773735, 'psi': 0.7034972934633736}-{'f1_val': 0.5934132629097072, 'auprc': 0.9482388425144336, 'loss_val': 1.1424531537195843, 'psi': 0.7353434947515978}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:44913
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.997)
[S14] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:44903
[S2] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:44908
[S14] ⇄ pheromone p=0.004 → S16@127.0.0.1:44916
[S8] not sending this round → trigger blocked (psi=0.996)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:44905
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] ⇄ pheromone p=0.049 → S15@127.0.0.1:44915
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] ⇄ pheromone p=0.002 → S4@127.0.0.1:44904
[S3] RECEIVED delta(kind=head bytes=1803) from S2
[S3] cosine check vs S2: cos=0.8735
[S13] RECEIVED delta(kind=head bytes=1795) from S10
[S13] cosine check vs S10: cos=0.9997
[S10] ⇄ pheromone p=0.005 → S13@127.0.0.1:44913
[S16] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=40 metric=0.7977 head_norm=1.592099
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.289656e-01
[S2] stored merged vector for next round verification (round=40)
[S2] DEBUG after merge:  round=40 metric=0.7967 head_norm=1.596915 delta_norm=0.328966
[S2] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.157 → S3@127.0.0.1:44903
[S5] RECEIVED delta(kind=head bytes=1798) from S16
[S5] cosine check vs S16: cos=0.9925
[S7] RECEIVED delta(kind=head bytes=1800) from S3
[S7] cosine check vs S3: cos=0.8721
[S15] ⇄ pheromone p=0.204 → S2@127.0.0.1:44902
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=40 metric=0.9949 head_norm=1.395594
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.874958e-01
[S3] stored merged vector for next round verification (round=40)
[S3] DEBUG after merge:  round=40 metric=0.9949 head_norm=1.446056 delta_norm=0.387496
[S3] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.075 → S7@127.0.0.1:44908
[S16] ⇄ pheromone p=0.197 → S5@127.0.0.1:44905
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] ⇄ pheromone p=0.014 → S8@127.0.0.1:44909
[S8] ⇄ pheromone p=0.018 → S6@127.0.0.1:44907
[S2] START round=41 head_norm_before_train=1.596915 cos_to_last_merge=1.0000 (last merge round=40)
[S2] round=41 local utility u=0.317278 metrics={'f1_val': 0.9139660517282441, 'auprc': 0.8395647029398252, 'loss_val': 0.4007683585383387, 'psi': 0.8842055122128765}-{'f1_val': 0.7977131416804903, 'auprc': 0.8775193846030371, 'loss_val': 0.4516705326617246, 'psi': 0.829635638849509}
[S3] START round=41 head_norm_before_train=1.446056 cos_to_last_merge=1.0000 (last merge round=40)
[S3] round=41 local utility u=0.000000 metrics={'f1_val': 0.9608604911886242, 'auprc': 0.9967100888629374, 'loss_val': 0.15151834133400793, 'psi': 0.9752003302583494}-{'f1_val': 0.9949293084644328, 'auprc': 0.9974782235884145, 'loss_val': 0.06852558047086417, 'psi': 0.9959488745140255}
[S4] START round=41 head_norm_before_train=2.081328 cos_to_last_merge=1.0000 (last merge round=40)
[S4] round=41 local utility u=0.000000 metrics={'f1_val': 0.945434388016071, 'auprc': 0.9709679100566854, 'loss_val': 0.262317777539281, 'psi': 0.9556477968323167}-{'f1_val': 0.9545092335895101, 'auprc': 0.9815766270888882, 'loss_val': 0.2585798320067322, 'psi': 0.9653361909892613}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=41 head_norm_before_train=1.658401 cos_to_last_merge=0.9991 (last merge round=38)
[S5] round=41 local utility u=0.002496 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9985752565956512, 'loss_val': 0.038363923719397446, 'psi': 0.9970542321770929}-{'f1_val': 0.9960402158980539, 'auprc': 0.9980782324991864, 'loss_val': 0.04186462348540654, 'psi': 0.9968554225385069}
[S6] START round=41 head_norm_before_train=1.568632 cos_to_last_merge=1.0000 (last merge round=40)
[S6] round=41 local utility u=0.000000 metrics={'f1_val': 0.5956874534290837, 'auprc': 0.9536404175479019, 'loss_val': 0.7419916524009239, 'psi': 0.7388686390766109}-{'f1_val': 0.9833846279372573, 'auprc': 0.9738996181046423, 'loss_val': 0.10621587087572351, 'psi': 0.9795906240042114}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=41 head_norm_before_train=1.467052 cos_to_last_merge=0.9997 (last merge round=39)
[S7] round=41 local utility u=0.000000 metrics={'f1_val': 0.6444473886063082, 'auprc': 0.8048196047192269, 'loss_val': 0.5873214435631082, 'psi': 0.7085962750514756}-{'f1_val': 0.6592087731153857, 'auprc': 0.8275710363906258, 'loss_val': 0.40558063679828016, 'psi': 0.7265536784254818}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=41 metric=0.6444 head_norm=1.503643
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.764526e-01
[S7] stored merged vector for next round verification (round=41)
[S7] DEBUG after merge:  round=41 metric=0.6486 head_norm=1.400927 delta_norm=0.376453
[S7] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S8] START round=41 head_norm_before_train=1.556263 cos_to_last_merge=0.9996 (last merge round=38)
[S8] round=41 local utility u=0.002619 metrics={'f1_val': 0.9946459649293765, 'auprc': 0.9991470300714951, 'loss_val': 0.07530452452697661, 'psi': 0.996446390986224}-{'f1_val': 0.9946459649293765, 'auprc': 0.999104811291042, 'loss_val': 0.08041492532538302, 'psi': 0.9964295034740427}
[S9] START round=41 head_norm_before_train=1.533106 cos_to_last_merge=0.9609 (last merge round=24)
[S9] round=41 local utility u=0.005588 metrics={'f1_val': 0.9956098104564366, 'auprc': 0.9984229861503608, 'loss_val': 0.02851042467733299, 'psi': 0.9967350807340063}-{'f1_val': 0.9966924912647621, 'auprc': 0.9918019901297082, 'loss_val': 0.026318690573948922, 'psi': 0.9947362908107406}
[S10] START round=41 head_norm_before_train=1.904768 cos_to_last_merge=0.9761 (last merge round=25)
[S10] round=41 local utility u=0.000000 metrics={'f1_val': 0.9936100131187782, 'auprc': 0.9938647330506136, 'loss_val': 0.041915587013031656, 'psi': 0.9937119010915123}-{'f1_val': 0.993871046050545, 'auprc': 0.9941059304222455, 'loss_val': 0.04275979035998425, 'psi': 0.9939649997992251}
[S11] START round=41 head_norm_before_train=2.094264 cos_to_last_merge=0.9925 (last merge round=23)
[S11] round=41 local utility u=0.001101 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9991920812198359, 'loss_val': 0.01769449813543945, 'psi': 0.9978553864636807}-{'f1_val': 0.9969642566262439, 'auprc': 0.998694752986427, 'loss_val': 0.018405496006712672, 'psi': 0.9976564551703171}
[S13] START round=41 head_norm_before_train=1.869047 cos_to_last_merge=1.0000 (last merge round=39)
[S13] round=41 local utility u=0.000000 metrics={'f1_val': 0.6451442993878, 'auprc': 0.7862682223265178, 'loss_val': 0.75663478913817, 'psi': 0.7015938685632872}-{'f1_val': 0.7058949614593881, 'auprc': 0.7916426989234693, 'loss_val': 0.7862815178726184, 'psi': 0.7401940564450206}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=41 metric=0.6451 head_norm=1.873422
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.043252e-02
[S13] stored merged vector for next round verification (round=41)
[S13] DEBUG after merge:  round=41 metric=0.6439 head_norm=1.888915 delta_norm=0.030433
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] START round=41 head_norm_before_train=1.610441 cos_to_last_merge=0.9602 (last merge round=24)
[S14] round=41 local utility u=0.000791 metrics={'f1_val': 0.9965123182311155, 'auprc': 0.9990063080924154, 'loss_val': 0.040609672186159664, 'psi': 0.9975099141756355}-{'f1_val': 0.996345017535854, 'auprc': 0.9990062442744891, 'loss_val': 0.04118865483855268, 'psi': 0.9974095082313081}
[S15] START round=41 head_norm_before_train=1.675977 cos_to_last_merge=0.9997 (last merge round=39)
[S15] round=41 local utility u=1.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9985175929549739, 'loss_val': 0.06521938659489722, 'psi': 0.9974550382145019}-{'f1_val': 0.7283852303836417, 'auprc': 0.9562235684610222, 'loss_val': 0.3977644954991606, 'psi': 0.8195205656145939}
[S16] START round=41 head_norm_before_train=1.618590 cos_to_last_merge=0.9999 (last merge round=39)
[S16] round=41 local utility u=0.289328 metrics={'f1_val': 0.9914846203576928, 'auprc': 0.9959137901859123, 'loss_val': 0.05970667186077747, 'psi': 0.9932562882889806}-{'f1_val': 0.9371372999845466, 'auprc': 0.9948883600957013, 'loss_val': 0.3092015316490635, 'psi': 0.9602377240290085}
[S17] START round=41 head_norm_before_train=2.011920 (no previous merge yet)
[S17] round=41 local utility u=0.000000 metrics={'f1_val': 0.5604737944207603, 'auprc': 0.7846715108700745, 'loss_val': 1.4398024271175756, 'psi': 0.650152881000486}-{'f1_val': 0.6131218097239222, 'auprc': 0.8390605190725509, 'loss_val': 1.145998024773735, 'psi': 0.7034972934633736}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:44903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:44916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:44904
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:44915
[S11] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:44907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:44902
[S14] sending update (kind=head size=1800 to 1 peers)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:44905
[S15] RECEIVED delta(kind=head bytes=1796) from S5
[S15] cosine check vs S5: cos=0.9947
[S16] RECEIVED delta(kind=head bytes=1800) from S14
[S16] cosine check vs S14: cos=0.9988
[S4] RECEIVED delta(kind=head bytes=1798) from S11
[S4] cosine check vs S11: cos=0.9999
[S3] RECEIVED delta(kind=head bytes=1800) from S2
[S3] cosine check vs S2: cos=0.9109
[S16] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=41 metric=0.9960 head_norm=1.684550
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.175728e-01
[S5] stored merged vector for next round verification (round=41)
[S5] DEBUG after merge:  round=41 metric=0.9960 head_norm=1.647710 delta_norm=0.117573
[S5] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S6] RECEIVED delta(kind=head bytes=1803) from S8
[S6] cosine check vs S8: cos=0.9951
[S5] RECEIVED delta(kind=head bytes=1799) from S16
[S5] cosine check vs S16: cos=0.9976
[S2] RECEIVED delta(kind=head bytes=1798) from S15
[S2] cosine check vs S15: cos=0.9716
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:44909
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=41 metric=0.9609 head_norm=1.495593
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.338922e-01
[S3] stored merged vector for next round verification (round=41)
[S3] DEBUG after merge:  round=41 metric=0.9609 head_norm=1.521526 delta_norm=0.333892
[S3] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S9] sending update (kind=head size=1794 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1794) from S9
[S8] cosine check vs S9: cos=0.9960
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=41 metric=0.9915 head_norm=1.637709
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.124474e-02
[S16] stored merged vector for next round verification (round=41)
[S16] DEBUG after merge:  round=41 metric=0.9915 head_norm=1.630118 delta_norm=0.041245
[S16] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=41 metric=0.9967 head_norm=1.707719
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.820055e-02
[S15] stored merged vector for next round verification (round=41)
[S15] DEBUG after merge:  round=41 metric=0.9967 head_norm=1.693879 delta_norm=0.088201
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=41 metric=0.9946 head_norm=1.568113
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.066839e-02
[S8] stored merged vector for next round verification (round=41)
[S8] DEBUG after merge:  round=41 metric=0.9946 head_norm=1.555176 delta_norm=0.070668
[S8] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=42 head_norm_before_train=1.617483 cos_to_last_merge=0.9995 (last merge round=40)
[S2] round=42 local utility u=0.000000 metrics={'f1_val': 0.8521427443969802, 'auprc': 0.8741519417002499, 'loss_val': 0.33663883300641234, 'psi': 0.8609464233182881}-{'f1_val': 0.9139660517282441, 'auprc': 0.8395647029398252, 'loss_val': 0.4007683585383387, 'psi': 0.8842055122128765}
[S3] START round=42 head_norm_before_train=1.521526 cos_to_last_merge=1.0000 (last merge round=41)
[S3] round=42 local utility u=0.019216 metrics={'f1_val': 0.970347000379377, 'auprc': 0.9971088684481932, 'loss_val': 0.17120208178493465, 'psi': 0.9810517476069035}-{'f1_val': 0.9608604911886242, 'auprc': 0.9967100888629374, 'loss_val': 0.15151834133400793, 'psi': 0.9752003302583494}
[S4] START round=42 head_norm_before_train=2.085271 cos_to_last_merge=1.0000 (last merge round=40)
[S4] round=42 local utility u=0.000000 metrics={'f1_val': 0.9354968583373646, 'auprc': 0.9573021437884066, 'loss_val': 0.2853603263760758, 'psi': 0.9442189725177814}-{'f1_val': 0.945434388016071, 'auprc': 0.9709679100566854, 'loss_val': 0.262317777539281, 'psi': 0.9556477968323167}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=42 metric=0.9355 head_norm=2.091039
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.190377e-02
[S4] stored merged vector for next round verification (round=42)
[S4] DEBUG after merge:  round=42 metric=0.9354 head_norm=2.095523 delta_norm=0.021904
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S5] START round=42 head_norm_before_train=1.647710 cos_to_last_merge=1.0000 (last merge round=41)
[S5] round=42 local utility u=0.000000 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9942079569627961, 'loss_val': 0.04303619290949003, 'psi': 0.9953073123239509}-{'f1_val': 0.9960402158980539, 'auprc': 0.9985752565956512, 'loss_val': 0.038363923719397446, 'psi': 0.9970542321770929}
[S6] START round=42 head_norm_before_train=1.588800 cos_to_last_merge=0.9998 (last merge round=40)
[S6] round=42 local utility u=1.000000 metrics={'f1_val': 0.8695221279273451, 'auprc': 0.969982751239389, 'loss_val': 0.2790633865014608, 'psi': 0.9097063772521626}-{'f1_val': 0.5956874534290837, 'auprc': 0.9536404175479019, 'loss_val': 0.7419916524009239, 'psi': 0.7388686390766109}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=42 metric=0.8695 head_norm=1.609868
[S6] _apply_head_vector_avg (torch): Δ‖w‖=9.390805e-02
[S6] stored merged vector for next round verification (round=42)
[S6] DEBUG after merge:  round=42 metric=0.8680 head_norm=1.586350 delta_norm=0.093908
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S7] START round=42 head_norm_before_train=1.400927 cos_to_last_merge=1.0000 (last merge round=41)
[S7] round=42 local utility u=0.000000 metrics={'f1_val': 0.5924927739928987, 'auprc': 0.7937979079842539, 'loss_val': 0.7631037617291995, 'psi': 0.6730148275894408}-{'f1_val': 0.6444473886063082, 'auprc': 0.8048196047192269, 'loss_val': 0.5873214435631082, 'psi': 0.7085962750514756}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=42 head_norm_before_train=1.555176 cos_to_last_merge=1.0000 (last merge round=41)
[S8] round=42 local utility u=0.000000 metrics={'f1_val': 0.9946459649293765, 'auprc': 0.9991495354781001, 'loss_val': 0.07952005443782913, 'psi': 0.996447393148866}-{'f1_val': 0.9946459649293765, 'auprc': 0.9991470300714951, 'loss_val': 0.07530452452697661, 'psi': 0.996446390986224}
[S9] START round=42 head_norm_before_train=1.545367 cos_to_last_merge=0.9597 (last merge round=24)
[S9] round=42 local utility u=0.005477 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9984132869664811, 'loss_val': 0.02402358056944985, 'psi': 0.9973808095454497}-{'f1_val': 0.9956098104564366, 'auprc': 0.9984229861503608, 'loss_val': 0.02851042467733299, 'psi': 0.9967350807340063}
[S10] START round=42 head_norm_before_train=1.917102 cos_to_last_merge=0.9752 (last merge round=25)
[S10] round=42 local utility u=0.000284 metrics={'f1_val': 0.993391017001491, 'auprc': 0.9941764958652168, 'loss_val': 0.040968554924260915, 'psi': 0.9937052085469813}-{'f1_val': 0.9936100131187782, 'auprc': 0.9938647330506136, 'loss_val': 0.041915587013031656, 'psi': 0.9937119010915123}
[S11] START round=42 head_norm_before_train=2.100227 cos_to_last_merge=0.9921 (last merge round=23)
[S11] round=42 local utility u=0.001040 metrics={'f1_val': 0.9974011907167429, 'auprc': 0.999219533139891, 'loss_val': 0.018317548137638445, 'psi': 0.9981285276860021}-{'f1_val': 0.9969642566262439, 'auprc': 0.9991920812198359, 'loss_val': 0.01769449813543945, 'psi': 0.9978553864636807}
[S13] START round=42 head_norm_before_train=1.888915 cos_to_last_merge=1.0000 (last merge round=41)
[S13] round=42 local utility u=0.345542 metrics={'f1_val': 0.7467235907099633, 'auprc': 0.8065702206542876, 'loss_val': 0.7359331829884278, 'psi': 0.770662242687693}-{'f1_val': 0.6451442993878, 'auprc': 0.7862682223265178, 'loss_val': 0.75663478913817, 'psi': 0.7015938685632872}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=42 head_norm_before_train=1.623540 cos_to_last_merge=0.9587 (last merge round=24)
[S14] round=42 local utility u=0.000568 metrics={'f1_val': 0.9965123182311155, 'auprc': 0.9988998141296529, 'loss_val': 0.03915374675476083, 'psi': 0.9974673165905305}-{'f1_val': 0.9965123182311155, 'auprc': 0.9990063080924154, 'loss_val': 0.040609672186159664, 'psi': 0.9975099141756355}
[S15] START round=42 head_norm_before_train=1.693879 cos_to_last_merge=1.0000 (last merge round=41)
[S15] round=42 local utility u=0.000000 metrics={'f1_val': 0.8579368894374428, 'auprc': 0.9883493582200832, 'loss_val': 0.1959624753596326, 'psi': 0.9101018769504989}-{'f1_val': 0.9967466683875206, 'auprc': 0.9985175929549739, 'loss_val': 0.06521938659489722, 'psi': 0.9974550382145019}
[S16] START round=42 head_norm_before_train=1.630118 cos_to_last_merge=1.0000 (last merge round=41)
[S16] round=42 local utility u=0.004875 metrics={'f1_val': 0.992556494393827, 'auprc': 0.9963713072809053, 'loss_val': 0.057760798125558614, 'psi': 0.9940824195486584}-{'f1_val': 0.9914846203576928, 'auprc': 0.9959137901859123, 'loss_val': 0.05970667186077747, 'psi': 0.9932562882889806}
[S17] START round=42 head_norm_before_train=2.018750 (no previous merge yet)
[S17] round=42 local utility u=0.291449 metrics={'f1_val': 0.5749736372572682, 'auprc': 0.8870347525435838, 'loss_val': 1.2509927527645686, 'psi': 0.6997980833717945}-{'f1_val': 0.5604737944207603, 'auprc': 0.7846715108700745, 'loss_val': 1.4398024271175756, 'psi': 0.650152881000486}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S14] not sending this round → trigger blocked (psi=0.997)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:44913
[S11] not sending this round → trigger blocked (psi=0.998)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=42 metric=0.9960 head_norm=1.670614
[S5] _apply_head_vector_avg (torch): Δ‖w‖=6.944837e-02
[S5] stored merged vector for next round verification (round=42)
[S5] DEBUG after merge:  round=42 metric=0.9960 head_norm=1.652785 delta_norm=0.069448
[S5] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:44908
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=42 metric=0.8521 head_norm=1.643639
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.253244e-01
[S2] stored merged vector for next round verification (round=42)
[S2] DEBUG after merge:  round=42 metric=0.8450 head_norm=1.660769 delta_norm=0.225324
[S2] aggregate: ROLLBACK (f1_val pre=0.852 post=0.845 tol_abs=0.005 tol_rel=0.0)
[S16] not sending this round → trigger blocked (psi=0.994)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] RECEIVED delta(kind=head bytes=1798) from S10
[S13] cosine check vs S10: cos=0.9997
[S3] sending update (kind=head size=1801 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1801) from S3
[S7] cosine check vs S3: cos=0.7930
[S9] not sending this round → trigger blocked (psi=0.997)
[S2] START round=43 head_norm_before_train=1.660769 cos_to_last_merge=1.0000 (last merge round=42)
[S2] round=43 local utility u=0.006293 metrics={'f1_val': 0.8781458767419896, 'auprc': 0.8418820572125592, 'loss_val': 0.38326151466115693, 'psi': 0.8636403489302173}-{'f1_val': 0.8521427443969802, 'auprc': 0.8741519417002499, 'loss_val': 0.33663883300641234, 'psi': 0.8609464233182881}
[S3] START round=43 head_norm_before_train=1.579178 cos_to_last_merge=0.9969 (last merge round=41)
[S3] round=43 local utility u=0.000000 metrics={'f1_val': 0.8267781244369726, 'auprc': 0.9858041179579218, 'loss_val': 0.382040941354639, 'psi': 0.8903885218453523}-{'f1_val': 0.970347000379377, 'auprc': 0.9971088684481932, 'loss_val': 0.17120208178493465, 'psi': 0.9810517476069035}
[S4] START round=43 head_norm_before_train=2.095523 cos_to_last_merge=1.0000 (last merge round=42)
[S4] round=43 local utility u=0.060371 metrics={'f1_val': 0.9492859566882897, 'auprc': 0.9634408158375797, 'loss_val': 0.26576917283656587, 'psi': 0.9549479003480057}-{'f1_val': 0.9354968583373646, 'auprc': 0.9573021437884066, 'loss_val': 0.2853603263760758, 'psi': 0.9442189725177814}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=43 head_norm_before_train=1.652785 cos_to_last_merge=1.0000 (last merge round=42)
[S5] round=43 local utility u=0.005309 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.997513789896982, 'loss_val': 0.0423355611498752, 'psi': 0.9966296454976252}-{'f1_val': 0.9960402158980539, 'auprc': 0.9942079569627961, 'loss_val': 0.04303619290949003, 'psi': 0.9953073123239509}
[S6] START round=43 head_norm_before_train=1.586350 cos_to_last_merge=1.0000 (last merge round=42)
[S6] round=43 local utility u=0.000000 metrics={'f1_val': 0.6882698118320572, 'auprc': 0.9524482744385656, 'loss_val': 0.5901849832721859, 'psi': 0.7939411968746606}-{'f1_val': 0.8695221279273451, 'auprc': 0.969982751239389, 'loss_val': 0.2790633865014608, 'psi': 0.9097063772521626}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=43 head_norm_before_train=1.436978 cos_to_last_merge=0.9993 (last merge round=41)
[S7] round=43 local utility u=0.000000 metrics={'f1_val': 0.5562191920939358, 'auprc': 0.7853579487760267, 'loss_val': 0.8952325440533792, 'psi': 0.6478746947667722}-{'f1_val': 0.5924927739928987, 'auprc': 0.7937979079842539, 'loss_val': 0.7631037617291995, 'psi': 0.6730148275894408}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=43 metric=0.5562 head_norm=1.462595
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.992473e-01
[S7] stored merged vector for next round verification (round=43)
[S7] DEBUG after merge:  round=43 metric=0.5643 head_norm=1.437792 delta_norm=0.499247
[S7] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S8] START round=43 head_norm_before_train=1.568929 cos_to_last_merge=0.9999 (last merge round=41)
[S8] round=43 local utility u=0.001920 metrics={'f1_val': 0.9946459649293765, 'auprc': 0.9991216826647357, 'loss_val': 0.07559632375737663, 'psi': 0.9964362520235202}-{'f1_val': 0.9946459649293765, 'auprc': 0.9991495354781001, 'loss_val': 0.07952005443782913, 'psi': 0.996447393148866}
[S9] START round=43 head_norm_before_train=1.556293 cos_to_last_merge=0.9587 (last merge round=24)
[S9] round=43 local utility u=0.000903 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9988877856650809, 'loss_val': 0.023641189827463518, 'psi': 0.9975706090248897}-{'f1_val': 0.9966924912647621, 'auprc': 0.9984132869664811, 'loss_val': 0.02402358056944985, 'psi': 0.9973808095454497}
[S10] START round=43 head_norm_before_train=1.928366 cos_to_last_merge=0.9744 (last merge round=25)
[S10] round=43 local utility u=0.000614 metrics={'f1_val': 0.9940903254969471, 'auprc': 0.9926090731710049, 'loss_val': 0.039233934587174064, 'psi': 0.9934978245665702}-{'f1_val': 0.993391017001491, 'auprc': 0.9941764958652168, 'loss_val': 0.040968554924260915, 'psi': 0.9937052085469813}
[S11] START round=43 head_norm_before_train=2.105304 cos_to_last_merge=0.9919 (last merge round=23)
[S11] round=43 local utility u=0.000000 metrics={'f1_val': 0.9969878514242156, 'auprc': 0.9991724025512976, 'loss_val': 0.018694167531816325, 'psi': 0.9978616718750485}-{'f1_val': 0.9974011907167429, 'auprc': 0.999219533139891, 'loss_val': 0.018317548137638445, 'psi': 0.9981285276860021}
[S13] START round=43 head_norm_before_train=1.895432 cos_to_last_merge=1.0000 (last merge round=41)
[S13] round=43 local utility u=0.000000 metrics={'f1_val': 0.653437018017956, 'auprc': 0.7849459338408987, 'loss_val': 0.8072607554290511, 'psi': 0.7060405843471331}-{'f1_val': 0.7467235907099633, 'auprc': 0.8065702206542876, 'loss_val': 0.7359331829884278, 'psi': 0.770662242687693}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=43 metric=0.6534 head_norm=1.901635
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.204346e-02
[S13] stored merged vector for next round verification (round=43)
[S13] DEBUG after merge:  round=43 metric=0.6516 head_norm=1.914779 delta_norm=0.032043
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] START round=43 head_norm_before_train=1.637296 cos_to_last_merge=0.9572 (last merge round=24)
[S14] round=43 local utility u=0.001921 metrics={'f1_val': 0.996923079575176, 'auprc': 0.9990107127184706, 'loss_val': 0.0381088741970145, 'psi': 0.9977581328324938}-{'f1_val': 0.9965123182311155, 'auprc': 0.9988998141296529, 'loss_val': 0.03915374675476083, 'psi': 0.9974673165905305}
[S15] START round=43 head_norm_before_train=1.718498 cos_to_last_merge=0.9998 (last merge round=41)
[S15] round=43 local utility u=0.112595 metrics={'f1_val': 0.8927858745731498, 'auprc': 0.9950479237506024, 'loss_val': 0.1999617550217617, 'psi': 0.9336906942441309}-{'f1_val': 0.8579368894374428, 'auprc': 0.9883493582200832, 'loss_val': 0.1959624753596326, 'psi': 0.9101018769504989}
[S16] START round=43 head_norm_before_train=1.647490 cos_to_last_merge=0.9999 (last merge round=41)
[S16] round=43 local utility u=0.000000 metrics={'f1_val': 0.9925848006226844, 'auprc': 0.9912742330285202, 'loss_val': 0.05359454643016845, 'psi': 0.9920605735850188}-{'f1_val': 0.992556494393827, 'auprc': 0.9963713072809053, 'loss_val': 0.057760798125558614, 'psi': 0.9940824195486584}
[S17] START round=43 head_norm_before_train=2.022744 (no previous merge yet)
[S17] round=43 local utility u=0.820846 metrics={'f1_val': 0.7286484090954337, 'auprc': 0.9369317064034534, 'loss_val': 0.6810401322730708, 'psi': 0.8119617280186415}-{'f1_val': 0.5749736372572682, 'auprc': 0.8870347525435838, 'loss_val': 1.2509927527645686, 'psi': 0.6997980833717945}
[S17] not sending this round → trigger blocked (psi=0.812)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:44903
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.993)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:44916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:44915
[S5] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S8] → sending delta(kind=head bytes=1808) to S6@127.0.0.1:44907
[S2] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:44902
[S15] RECEIVED delta(kind=head bytes=1801) from S5
[S15] cosine check vs S5: cos=0.9911
[S3] RECEIVED delta(kind=head bytes=1803) from S2
[S3] cosine check vs S2: cos=0.9237
[S16] RECEIVED delta(kind=head bytes=1798) from S14
[S16] cosine check vs S14: cos=0.9988
[S15] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1808 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1808) from S8
[S6] cosine check vs S8: cos=0.9959
[S2] RECEIVED delta(kind=head bytes=1800) from S15
[S2] cosine check vs S15: cos=0.9839
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=43 metric=0.8268 head_norm=1.645066
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.268339e-01
[S3] stored merged vector for next round verification (round=43)
[S3] DEBUG after merge:  round=43 metric=0.8329 head_norm=1.636948 delta_norm=0.326834
[S3] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=43 metric=0.9926 head_norm=1.662513
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.133565e-02
[S16] stored merged vector for next round verification (round=43)
[S16] DEBUG after merge:  round=43 metric=0.9926 head_norm=1.655692 delta_norm=0.041336
[S16] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=43 metric=0.8928 head_norm=1.740436
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.179002e-01
[S15] stored merged vector for next round verification (round=43)
[S15] DEBUG after merge:  round=43 metric=0.8880 head_norm=1.706646 delta_norm=0.117900
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:44909
[S9] sending update (kind=head size=1802 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1802) from S9
[S8] cosine check vs S9: cos=0.9975
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=43 metric=0.9946 head_norm=1.585352
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.604660e-02
[S8] stored merged vector for next round verification (round=43)
[S8] DEBUG after merge:  round=43 metric=0.9950 head_norm=1.575802 delta_norm=0.056047
[S8] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=44 head_norm_before_train=1.693103 cos_to_last_merge=0.9989 (last merge round=42)
[S2] round=44 local utility u=0.033445 metrics={'f1_val': 0.8714659209383266, 'auprc': 0.8603731951285098, 'loss_val': 0.33176514844667965, 'psi': 0.8670288306144}-{'f1_val': 0.8781458767419896, 'auprc': 0.8418820572125592, 'loss_val': 0.38326151466115693, 'psi': 0.8636403489302173}
[S3] START round=44 head_norm_before_train=1.636948 cos_to_last_merge=1.0000 (last merge round=43)
[S3] round=44 local utility u=0.000000 metrics={'f1_val': 0.6476371496254645, 'auprc': 0.9765002028749495, 'loss_val': 0.7094384130020263, 'psi': 0.7791823709252585}-{'f1_val': 0.8267781244369726, 'auprc': 0.9858041179579218, 'loss_val': 0.382040941354639, 'psi': 0.8903885218453523}
[S4] START round=44 head_norm_before_train=2.099877 cos_to_last_merge=1.0000 (last merge round=42)
[S4] round=44 local utility u=0.046609 metrics={'f1_val': 0.95888112231236, 'auprc': 0.9751752704554175, 'loss_val': 0.26532484148598834, 'psi': 0.965398781569583}-{'f1_val': 0.9492859566882897, 'auprc': 0.9634408158375797, 'loss_val': 0.26576917283656587, 'psi': 0.9549479003480057}
[S4] not sending this round → trigger blocked (psi=0.965)
[S5] START round=44 head_norm_before_train=1.680465 cos_to_last_merge=0.9998 (last merge round=42)
[S5] round=44 local utility u=0.000000 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9922627774582257, 'loss_val': 0.03831181707424584, 'psi': 0.9945292405221227}-{'f1_val': 0.9960402158980539, 'auprc': 0.997513789896982, 'loss_val': 0.0423355611498752, 'psi': 0.9966296454976252}
[S6] START round=44 head_norm_before_train=1.610243 cos_to_last_merge=0.9998 (last merge round=42)
[S6] round=44 local utility u=0.528374 metrics={'f1_val': 0.8419843447074017, 'auprc': 0.9539095437981209, 'loss_val': 0.4601089806487171, 'psi': 0.8867544243436893}-{'f1_val': 0.6882698118320572, 'auprc': 0.9524482744385656, 'loss_val': 0.5901849832721859, 'psi': 0.7939411968746606}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] sending update (kind=head size=1804 to 1 peers)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=44 metric=0.8420 head_norm=1.629480
[S6] _apply_head_vector_avg (torch): Δ‖w‖=8.719822e-02
[S6] stored merged vector for next round verification (round=44)
[S6] DEBUG after merge:  round=44 metric=0.8384 head_norm=1.605201 delta_norm=0.087198
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S7] START round=44 head_norm_before_train=1.437792 cos_to_last_merge=1.0000 (last merge round=43)
[S7] round=44 local utility u=0.286688 metrics={'f1_val': 0.6089328564635004, 'auprc': 0.7952157847717988, 'loss_val': 0.6677112263872568, 'psi': 0.6834460277868197}-{'f1_val': 0.5562191920939358, 'auprc': 0.7853579487760267, 'loss_val': 0.8952325440533792, 'psi': 0.6478746947667722}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=44 head_norm_before_train=1.575802 cos_to_last_merge=1.0000 (last merge round=43)
[S8] round=44 local utility u=0.000000 metrics={'f1_val': 0.9895700826501451, 'auprc': 0.9992585924926589, 'loss_val': 0.09180452542544171, 'psi': 0.9934454865871506}-{'f1_val': 0.9946459649293765, 'auprc': 0.9991216826647357, 'loss_val': 0.07559632375737663, 'psi': 0.9964362520235202}
[S9] START round=44 head_norm_before_train=1.568198 cos_to_last_merge=0.9575 (last merge round=24)
[S9] round=44 local utility u=0.000000 metrics={'f1_val': 0.9551010039242319, 'auprc': 0.9991872474250906, 'loss_val': 0.10370711681226515, 'psi': 0.9727355013245754}-{'f1_val': 0.9966924912647621, 'auprc': 0.9988877856650809, 'loss_val': 0.023641189827463518, 'psi': 0.9975706090248897}
[S10] START round=44 head_norm_before_train=1.939821 cos_to_last_merge=0.9736 (last merge round=25)
[S10] round=44 local utility u=0.001159 metrics={'f1_val': 0.9931720938432163, 'auprc': 0.9953630241799277, 'loss_val': 0.039668749898440984, 'psi': 0.9940484659779009}-{'f1_val': 0.9940903254969471, 'auprc': 0.9926090731710049, 'loss_val': 0.039233934587174064, 'psi': 0.9934978245665702}
[S11] START round=44 head_norm_before_train=2.111608 cos_to_last_merge=0.9915 (last merge round=23)
[S11] round=44 local utility u=0.000000 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.998361954197697, 'loss_val': 0.01862398637128507, 'psi': 0.9975233356548251}-{'f1_val': 0.9969878514242156, 'auprc': 0.9991724025512976, 'loss_val': 0.018694167531816325, 'psi': 0.9978616718750485}
[S13] START round=44 head_norm_before_train=1.914779 cos_to_last_merge=1.0000 (last merge round=43)
[S13] round=44 local utility u=0.000000 metrics={'f1_val': 0.616970502680366, 'auprc': 0.8006356105837577, 'loss_val': 1.0195419220272737, 'psi': 0.6904365458417226}-{'f1_val': 0.653437018017956, 'auprc': 0.7849459338408987, 'loss_val': 0.8072607554290511, 'psi': 0.7060405843471331}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=44 head_norm_before_train=1.649878 cos_to_last_merge=0.9560 (last merge round=24)
[S14] round=44 local utility u=0.000000 metrics={'f1_val': 0.9906494377639183, 'auprc': 0.9990135895724683, 'loss_val': 0.049666412348329504, 'psi': 0.9939950984873384}-{'f1_val': 0.996923079575176, 'auprc': 0.9990107127184706, 'loss_val': 0.0381088741970145, 'psi': 0.9977581328324938}
[S15] START round=44 head_norm_before_train=1.706646 cos_to_last_merge=1.0000 (last merge round=43)
[S15] round=44 local utility u=0.248249 metrics={'f1_val': 0.963544059995152, 'auprc': 0.9964492304256146, 'loss_val': 0.13221604086910124, 'psi': 0.976706128167337}-{'f1_val': 0.8927858745731498, 'auprc': 0.9950479237506024, 'loss_val': 0.1999617550217617, 'psi': 0.9336906942441309}
[S16] START round=44 head_norm_before_train=1.655692 cos_to_last_merge=1.0000 (last merge round=43)
[S16] round=44 local utility u=0.008259 metrics={'f1_val': 0.992556494393827, 'auprc': 0.9974548617077792, 'loss_val': 0.05544872309043347, 'psi': 0.994515841319408}-{'f1_val': 0.9925848006226844, 'auprc': 0.9912742330285202, 'loss_val': 0.05359454643016845, 'psi': 0.9920605735850188}
[S17] START round=44 head_norm_before_train=2.023404 (no previous merge yet)
[S17] round=44 local utility u=0.000000 metrics={'f1_val': 0.5920206372855925, 'auprc': 0.8241672699101877, 'loss_val': 1.2640975892059585, 'psi': 0.6848792903354306}-{'f1_val': 0.7286484090954337, 'auprc': 0.9369317064034534, 'loss_val': 0.6810401322730708, 'psi': 0.8119617280186415}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.867)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:44913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:44905
[S10] sending update (kind=head size=1798 to 1 peers)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.977)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=44 metric=0.8715 head_norm=1.736261
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.944699e-01
[S2] stored merged vector for next round verification (round=44)
[S2] DEBUG after merge:  round=44 metric=0.8674 head_norm=1.727438 delta_norm=0.194470
[S2] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S13] RECEIVED delta(kind=head bytes=1798) from S10
[S13] cosine check vs S10: cos=0.9997
[S16] sending update (kind=head size=1796 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1796) from S16
[S5] cosine check vs S16: cos=0.9966
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=45 head_norm_before_train=1.727438 cos_to_last_merge=1.0000 (last merge round=44)
[S2] round=45 local utility u=0.066282 metrics={'f1_val': 0.8550461237556972, 'auprc': 0.9311099124121744, 'loss_val': 0.31289171432988977, 'psi': 0.8854716392182882}-{'f1_val': 0.8714659209383266, 'auprc': 0.8603731951285098, 'loss_val': 0.33176514844667965, 'psi': 0.8670288306144}
[S3] START round=45 head_norm_before_train=1.689531 cos_to_last_merge=0.9979 (last merge round=43)
[S3] round=45 local utility u=1.000000 metrics={'f1_val': 0.9876262740930827, 'auprc': 0.996728875147431, 'loss_val': 0.08502838117012233, 'psi': 0.9912673145148221}-{'f1_val': 0.6476371496254645, 'auprc': 0.9765002028749495, 'loss_val': 0.7094384130020263, 'psi': 0.7791823709252585}
[S4] START round=45 head_norm_before_train=2.106414 cos_to_last_merge=0.9999 (last merge round=42)
[S4] round=45 local utility u=0.000000 metrics={'f1_val': 0.9540469146280273, 'auprc': 0.9820100726137254, 'loss_val': 0.2689888184484033, 'psi': 0.9652321778223065}-{'f1_val': 0.95888112231236, 'auprc': 0.9751752704554175, 'loss_val': 0.26532484148598834, 'psi': 0.965398781569583}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=45 head_norm_before_train=1.708628 cos_to_last_merge=0.9993 (last merge round=42)
[S5] round=45 local utility u=0.010368 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9979771990015246, 'loss_val': 0.03559481220337538, 'psi': 0.9969024935861964}-{'f1_val': 0.9960402158980539, 'auprc': 0.9922627774582257, 'loss_val': 0.03831181707424584, 'psi': 0.9945292405221227}
[S6] START round=45 head_norm_before_train=1.605201 cos_to_last_merge=1.0000 (last merge round=44)
[S6] round=45 local utility u=0.028241 metrics={'f1_val': 0.8256908844975942, 'auprc': 0.975846806357131, 'loss_val': 0.3716786709705768, 'psi': 0.885753253241409}-{'f1_val': 0.8419843447074017, 'auprc': 0.9539095437981209, 'loss_val': 0.4601089806487171, 'psi': 0.8867544243436893}
[S6] not sending this round → trigger blocked (psi=0.886)
[S7] START round=45 head_norm_before_train=1.468276 cos_to_last_merge=0.9991 (last merge round=43)
[S7] round=45 local utility u=0.075587 metrics={'f1_val': 0.6252319057812181, 'auprc': 0.7993881160841865, 'loss_val': 0.626848163970823, 'psi': 0.6948943899024054}-{'f1_val': 0.6089328564635004, 'auprc': 0.7952157847717988, 'loss_val': 0.6677112263872568, 'psi': 0.6834460277868197}
[S7] not sending this round → trigger blocked (psi=0.695)
[S8] START round=45 head_norm_before_train=1.593273 cos_to_last_merge=0.9999 (last merge round=43)
[S8] round=45 local utility u=0.022736 metrics={'f1_val': 0.9942788405856967, 'auprc': 0.9974255422895547, 'loss_val': 0.06908553429976813, 'psi': 0.9955375212672399}-{'f1_val': 0.9895700826501451, 'auprc': 0.9992585924926589, 'loss_val': 0.09180452542544171, 'psi': 0.9934454865871506}
[S9] START round=45 head_norm_before_train=1.577987 cos_to_last_merge=0.9565 (last merge round=24)
[S9] round=45 local utility u=0.152179 metrics={'f1_val': 0.9958401597823502, 'auprc': 0.9929097154927591, 'loss_val': 0.024951645396954866, 'psi': 0.9946679820665137}-{'f1_val': 0.9551010039242319, 'auprc': 0.9991872474250906, 'loss_val': 0.10370711681226515, 'psi': 0.9727355013245754}
[S10] START round=45 head_norm_before_train=1.951166 cos_to_last_merge=0.9727 (last merge round=25)
[S10] round=45 local utility u=0.000000 metrics={'f1_val': 0.993871046050545, 'auprc': 0.9927143092763833, 'loss_val': 0.03676693550338176, 'psi': 0.9934083513408802}-{'f1_val': 0.9931720938432163, 'auprc': 0.9953630241799277, 'loss_val': 0.039668749898440984, 'psi': 0.9940484659779009}
[S11] START round=45 head_norm_before_train=2.118999 cos_to_last_merge=0.9911 (last merge round=23)
[S11] round=45 local utility u=0.000000 metrics={'f1_val': 0.9965268648289654, 'auprc': 0.9968825833823476, 'loss_val': 0.01875270002789706, 'psi': 0.9966691522503182}-{'f1_val': 0.9969642566262439, 'auprc': 0.998361954197697, 'loss_val': 0.01862398637128507, 'psi': 0.9975233356548251}
[S13] START round=45 head_norm_before_train=1.921978 cos_to_last_merge=1.0000 (last merge round=43)
[S13] round=45 local utility u=0.546597 metrics={'f1_val': 0.7490464238050132, 'auprc': 0.8079614381972092, 'loss_val': 0.740781728002041, 'psi': 0.7726124295618917}-{'f1_val': 0.616970502680366, 'auprc': 0.8006356105837577, 'loss_val': 1.0195419220272737, 'psi': 0.6904365458417226}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=45 metric=0.7490 head_norm=1.926764
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.177927e-02
[S13] stored merged vector for next round verification (round=45)
[S13] DEBUG after merge:  round=45 metric=0.7485 head_norm=1.938743 delta_norm=0.031779
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] START round=45 head_norm_before_train=1.661948 cos_to_last_merge=0.9549 (last merge round=24)
[S14] round=45 local utility u=0.000000 metrics={'f1_val': 0.9523348929685167, 'auprc': 0.999037932591746, 'loss_val': 0.08969675319069591, 'psi': 0.9710161088178084}-{'f1_val': 0.9906494377639183, 'auprc': 0.9990135895724683, 'loss_val': 0.049666412348329504, 'psi': 0.9939950984873384}
[S15] START round=45 head_norm_before_train=1.731095 cos_to_last_merge=0.9998 (last merge round=43)
[S15] round=45 local utility u=0.000000 metrics={'f1_val': 0.9228129330410436, 'auprc': 0.9972579722640724, 'loss_val': 0.12274631479971558, 'psi': 0.9525909487302551}-{'f1_val': 0.963544059995152, 'auprc': 0.9964492304256146, 'loss_val': 0.13221604086910124, 'psi': 0.976706128167337}
[S16] START round=45 head_norm_before_train=1.670655 cos_to_last_merge=0.9999 (last merge round=43)
[S16] round=45 local utility u=0.000000 metrics={'f1_val': 0.992556494393827, 'auprc': 0.9962218148072265, 'loss_val': 0.05243058221250891, 'psi': 0.9940226225591868}-{'f1_val': 0.992556494393827, 'auprc': 0.9974548617077792, 'loss_val': 0.05544872309043347, 'psi': 0.994515841319408}
[S17] START round=45 head_norm_before_train=2.024016 (no previous merge yet)
[S17] round=45 local utility u=0.232093 metrics={'f1_val': 0.5932482988220591, 'auprc': 0.9320270592373452, 'loss_val': 1.130857276187812, 'psi': 0.7287598029881736}-{'f1_val': 0.5920206372855925, 'auprc': 0.8241672699101877, 'loss_val': 1.2640975892059585, 'psi': 0.6848792903354306}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:44915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S2] → sending delta(kind=head bytes=1806) to S3@127.0.0.1:44903
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] ⇄ pheromone p=0.002 → S16@127.0.0.1:44916
[S11] ⇄ pheromone p=0.001 → S4@127.0.0.1:44904
[S10] ⇄ pheromone p=0.002 → S13@127.0.0.1:44913
[S2] sending update (kind=head size=1806 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:44907
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1800 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:44908
[S15] RECEIVED delta(kind=head bytes=1800) from S5
[S15] cosine check vs S5: cos=0.9956
[S3] RECEIVED delta(kind=head bytes=1806) from S2
[S3] cosine check vs S2: cos=0.9500
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=45 metric=0.9962 head_norm=1.729219
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.550518e-02
[S5] stored merged vector for next round verification (round=45)
[S5] DEBUG after merge:  round=45 metric=0.9962 head_norm=1.698038 delta_norm=0.085505
[S5] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.019 → S15@127.0.0.1:44915
[S2] ⇄ pheromone p=0.097 → S3@127.0.0.1:44903
[S8] sending update (kind=head size=1804 to 1 peers)
[S3] sending update (kind=head size=1804 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1804) from S8
[S6] cosine check vs S8: cos=0.9974
[S7] RECEIVED delta(kind=head bytes=1804) from S3
[S7] cosine check vs S3: cos=0.9113
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S9] → sending delta(kind=head bytes=1805) to S8@127.0.0.1:44909
[S16] ⇄ pheromone p=0.090 → S5@127.0.0.1:44905
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=45 metric=0.9228 head_norm=1.753987
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.266152e-02
[S15] stored merged vector for next round verification (round=45)
[S15] DEBUG after merge:  round=45 metric=0.9180 head_norm=1.739684 delta_norm=0.082662
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.203 → S2@127.0.0.1:44902
[S9] sending update (kind=head size=1805 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1805) from S9
[S8] cosine check vs S9: cos=0.9979
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=45 metric=0.9876 head_norm=1.737149
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.775709e-01
[S3] stored merged vector for next round verification (round=45)
[S3] DEBUG after merge:  round=45 metric=0.9879 head_norm=1.730377 delta_norm=0.277571
[S3] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.226 → S7@127.0.0.1:44908
[S9] ⇄ pheromone p=0.036 → S8@127.0.0.1:44909
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=45 metric=0.9943 head_norm=1.609204
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.358651e-02
[S8] stored merged vector for next round verification (round=45)
[S8] DEBUG after merge:  round=45 metric=0.9943 head_norm=1.596222 delta_norm=0.053587
[S8] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.011 → S6@127.0.0.1:44907
[S2] START round=46 head_norm_before_train=1.767715 cos_to_last_merge=0.9988 (last merge round=44)
[S2] round=46 local utility u=0.000000 metrics={'f1_val': 0.886238014460457, 'auprc': 0.8330795316795042, 'loss_val': 0.3725081379811176, 'psi': 0.8649746213480759}-{'f1_val': 0.8550461237556972, 'auprc': 0.9311099124121744, 'loss_val': 0.31289171432988977, 'psi': 0.8854716392182882}
[S3] START round=46 head_norm_before_train=1.730377 cos_to_last_merge=1.0000 (last merge round=45)
[S3] round=46 local utility u=0.020893 metrics={'f1_val': 0.9947523743726271, 'auprc': 0.9955228714125951, 'loss_val': 0.08238115604779218, 'psi': 0.9950605731886143}-{'f1_val': 0.9876262740930827, 'auprc': 0.996728875147431, 'loss_val': 0.08502838117012233, 'psi': 0.9912673145148221}
[S4] START round=46 head_norm_before_train=2.111649 cos_to_last_merge=0.9998 (last merge round=42)
[S4] round=46 local utility u=0.000000 metrics={'f1_val': 0.9415121938149146, 'auprc': 0.953438018222242, 'loss_val': 0.28624936415219854, 'psi': 0.9462825235778456}-{'f1_val': 0.9540469146280273, 'auprc': 0.9820100726137254, 'loss_val': 0.2689888184484033, 'psi': 0.9652321778223065}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=46 head_norm_before_train=1.698038 cos_to_last_merge=1.0000 (last merge round=45)
[S5] round=46 local utility u=0.001398 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9994649134806456, 'loss_val': 0.037261148962168956, 'psi': 0.9974975793778449}-{'f1_val': 0.996186023309311, 'auprc': 0.9979771990015246, 'loss_val': 0.03559481220337538, 'psi': 0.9969024935861964}
[S6] START round=46 head_norm_before_train=1.617108 cos_to_last_merge=0.9999 (last merge round=44)
[S6] round=46 local utility u=0.000000 metrics={'f1_val': 0.6794296352658248, 'auprc': 0.9561752111123968, 'loss_val': 0.5558175410822527, 'psi': 0.7901278656044536}-{'f1_val': 0.8256908844975942, 'auprc': 0.975846806357131, 'loss_val': 0.3716786709705768, 'psi': 0.885753253241409}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=46 metric=0.6794 head_norm=1.634068
[S6] _apply_head_vector_avg (torch): Δ‖w‖=7.155951e-02
[S6] stored merged vector for next round verification (round=46)
[S6] DEBUG after merge:  round=46 metric=0.6803 head_norm=1.620104 delta_norm=0.071560
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S7] START round=46 head_norm_before_train=1.500050 cos_to_last_merge=0.9966 (last merge round=43)
[S7] round=46 local utility u=0.792124 metrics={'f1_val': 0.7278187538258462, 'auprc': 0.9850581744334839, 'loss_val': 0.21513134817341026, 'psi': 0.8307145220689013}-{'f1_val': 0.6252319057812181, 'auprc': 0.7993881160841865, 'loss_val': 0.626848163970823, 'psi': 0.6948943899024054}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=46 metric=0.7278 head_norm=1.530081
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.751975e-01
[S7] stored merged vector for next round verification (round=46)
[S7] DEBUG after merge:  round=46 metric=0.8039 head_norm=1.593312 delta_norm=0.375198
[S7] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S8] START round=46 head_norm_before_train=1.596222 cos_to_last_merge=1.0000 (last merge round=45)
[S8] round=46 local utility u=0.000000 metrics={'f1_val': 0.9928159069878363, 'auprc': 0.9986701092750792, 'loss_val': 0.07043440629041742, 'psi': 0.9951575879027335}-{'f1_val': 0.9942788405856967, 'auprc': 0.9974255422895547, 'loss_val': 0.06908553429976813, 'psi': 0.9955375212672399}
[S9] START round=46 head_norm_before_train=1.584946 cos_to_last_merge=0.9558 (last merge round=24)
[S9] round=46 local utility u=0.000000 metrics={'f1_val': 0.9880286744602689, 'auprc': 0.9984878093595465, 'loss_val': 0.051678512452179096, 'psi': 0.99221232841998}-{'f1_val': 0.9958401597823502, 'auprc': 0.9929097154927591, 'loss_val': 0.024951645396954866, 'psi': 0.9946679820665137}
[S10] START round=46 head_norm_before_train=1.962268 cos_to_last_merge=0.9718 (last merge round=25)
[S10] round=46 local utility u=0.001222 metrics={'f1_val': 0.9931720938432163, 'auprc': 0.9952674765615376, 'loss_val': 0.037787944626501174, 'psi': 0.9940102469305448}-{'f1_val': 0.993871046050545, 'auprc': 0.9927143092763833, 'loss_val': 0.03676693550338176, 'psi': 0.9934083513408802}
[S11] START round=46 head_norm_before_train=2.126347 cos_to_last_merge=0.9907 (last merge round=23)
[S11] round=46 local utility u=0.000000 metrics={'f1_val': 0.9966559062161475, 'auprc': 0.9967623029739685, 'loss_val': 0.019247653075272014, 'psi': 0.9966984649192759}-{'f1_val': 0.9965268648289654, 'auprc': 0.9968825833823476, 'loss_val': 0.01875270002789706, 'psi': 0.9966691522503182}
[S13] START round=46 head_norm_before_train=1.938743 cos_to_last_merge=1.0000 (last merge round=45)
[S13] round=46 local utility u=0.000000 metrics={'f1_val': 0.6484738674014758, 'auprc': 0.7593055292777782, 'loss_val': 0.9563167573693763, 'psi': 0.6928065321519967}-{'f1_val': 0.7490464238050132, 'auprc': 0.8079614381972092, 'loss_val': 0.740781728002041, 'psi': 0.7726124295618917}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=46 head_norm_before_train=1.673210 cos_to_last_merge=0.9538 (last merge round=24)
[S14] round=46 local utility u=0.116285 metrics={'f1_val': 0.98447218960495, 'auprc': 0.9990153556683984, 'loss_val': 0.04988338214112201, 'psi': 0.9902894560303294}-{'f1_val': 0.9523348929685167, 'auprc': 0.999037932591746, 'loss_val': 0.08969675319069591, 'psi': 0.9710161088178084}
[S15] START round=46 head_norm_before_train=1.739684 cos_to_last_merge=1.0000 (last merge round=45)
[S15] round=46 local utility u=0.000000 metrics={'f1_val': 0.768311678295772, 'auprc': 0.967765939462292, 'loss_val': 0.3753977454563998, 'psi': 0.84809338276238}-{'f1_val': 0.9228129330410436, 'auprc': 0.9972579722640724, 'loss_val': 0.12274631479971558, 'psi': 0.9525909487302551}
[S16] START round=46 head_norm_before_train=1.683594 cos_to_last_merge=0.9998 (last merge round=43)
[S16] round=46 local utility u=0.000000 metrics={'f1_val': 0.992804978828382, 'auprc': 0.9914253947610405, 'loss_val': 0.04861169733489605, 'psi': 0.9922531452014454}-{'f1_val': 0.992556494393827, 'auprc': 0.9962218148072265, 'loss_val': 0.05243058221250891, 'psi': 0.9940226225591868}
[S17] START round=46 head_norm_before_train=2.028027 (no previous merge yet)
[S17] round=46 local utility u=0.254984 metrics={'f1_val': 0.6291455882468668, 'auprc': 0.9710316403029908, 'loss_val': 0.9532874376775008, 'psi': 0.7659000090693164}-{'f1_val': 0.5932482988220591, 'auprc': 0.9320270592373452, 'loss_val': 1.130857276187812, 'psi': 0.7287598029881736}
[S17] not sending this round → trigger blocked (psi=0.766)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:44913
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:44916
[S5] not sending this round → trigger blocked (psi=0.997)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1797 to 1 peers)
[S3] not sending this round → trigger blocked (psi=0.995)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1801 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] RECEIVED delta(kind=head bytes=1797) from S14
[S16] cosine check vs S14: cos=0.9985
[S13] RECEIVED delta(kind=head bytes=1801) from S10
[S13] cosine check vs S10: cos=0.9997
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=46 metric=0.9928 head_norm=1.696450
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.698705e-02
[S16] stored merged vector for next round verification (round=46)
[S16] DEBUG after merge:  round=46 metric=0.9928 head_norm=1.689875 delta_norm=0.046987
[S16] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=47 head_norm_before_train=1.805433 cos_to_last_merge=0.9961 (last merge round=44)
[S2] round=47 local utility u=0.000000 metrics={'f1_val': 0.8331350558364273, 'auprc': 0.8997127594849601, 'loss_val': 0.36655729754241395, 'psi': 0.8597661372958405}-{'f1_val': 0.886238014460457, 'auprc': 0.8330795316795042, 'loss_val': 0.3725081379811176, 'psi': 0.8649746213480759}
[S3] START round=47 head_norm_before_train=1.778740 cos_to_last_merge=0.9989 (last merge round=45)
[S3] round=47 local utility u=0.000000 metrics={'f1_val': 0.9638845123915619, 'auprc': 0.9973798316300304, 'loss_val': 0.08353359326645085, 'psi': 0.9772826400869492}-{'f1_val': 0.9947523743726271, 'auprc': 0.9955228714125951, 'loss_val': 0.08238115604779218, 'psi': 0.9950605731886143}
[S4] START round=47 head_norm_before_train=2.117494 cos_to_last_merge=0.9998 (last merge round=42)
[S4] round=47 local utility u=0.000000 metrics={'f1_val': 0.9417756748205481, 'auprc': 0.949671145284539, 'loss_val': 0.2872578980699713, 'psi': 0.9449338630061445}-{'f1_val': 0.9415121938149146, 'auprc': 0.953438018222242, 'loss_val': 0.28624936415219854, 'psi': 0.9462825235778456}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=47 head_norm_before_train=1.720628 cos_to_last_merge=0.9999 (last merge round=45)
[S5] round=47 local utility u=0.000000 metrics={'f1_val': 0.8374727650332852, 'auprc': 0.985757690462833, 'loss_val': 0.24173237877439, 'psi': 0.8967867352051042}-{'f1_val': 0.996186023309311, 'auprc': 0.9994649134806456, 'loss_val': 0.037261148962168956, 'psi': 0.9974975793778449}
[S6] START round=47 head_norm_before_train=1.620104 cos_to_last_merge=1.0000 (last merge round=46)
[S6] round=47 local utility u=0.438042 metrics={'f1_val': 0.7901765411635437, 'auprc': 0.9748136891729082, 'loss_val': 0.4001296271557411, 'psi': 0.8640314003672895}-{'f1_val': 0.6794296352658248, 'auprc': 0.9561752111123968, 'loss_val': 0.5558175410822527, 'psi': 0.7901278656044536}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] sending update (kind=head size=1804 to 1 peers)
[S7] START round=47 head_norm_before_train=1.593312 cos_to_last_merge=1.0000 (last merge round=46)
[S7] round=47 local utility u=0.000000 metrics={'f1_val': 0.5305795429872253, 'auprc': 0.7768282608214335, 'loss_val': 1.013777083906366, 'psi': 0.6290790301209086}-{'f1_val': 0.7278187538258462, 'auprc': 0.9850581744334839, 'loss_val': 0.21513134817341026, 'psi': 0.8307145220689013}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=47 head_norm_before_train=1.612507 cos_to_last_merge=0.9999 (last merge round=45)
[S8] round=47 local utility u=0.006630 metrics={'f1_val': 0.9939122747783468, 'auprc': 0.9983759760652668, 'loss_val': 0.06287063501385864, 'psi': 0.9956977552931148}-{'f1_val': 0.9928159069878363, 'auprc': 0.9986701092750792, 'loss_val': 0.07043440629041742, 'psi': 0.9951575879027335}
[S9] START round=47 head_norm_before_train=1.591144 cos_to_last_merge=0.9552 (last merge round=24)
[S9] round=47 local utility u=0.038904 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9986950240517658, 'loss_val': 0.02382081955970564, 'psi': 0.9972280664882729}-{'f1_val': 0.9880286744602689, 'auprc': 0.9984878093595465, 'loss_val': 0.051678512452179096, 'psi': 0.99221232841998}
[S10] START round=47 head_norm_before_train=1.972012 cos_to_last_merge=0.9712 (last merge round=25)
[S10] round=47 local utility u=0.000000 metrics={'f1_val': 0.993391017001491, 'auprc': 0.993995495219579, 'loss_val': 0.03588911192568696, 'psi': 0.9936328082887261}-{'f1_val': 0.9931720938432163, 'auprc': 0.9952674765615376, 'loss_val': 0.037787944626501174, 'psi': 0.9940102469305448}
[S11] START round=47 head_norm_before_train=2.131904 cos_to_last_merge=0.9904 (last merge round=23)
[S11] round=47 local utility u=0.000000 metrics={'f1_val': 0.9815940215768301, 'auprc': 0.9982498739965835, 'loss_val': 0.05372875011141232, 'psi': 0.9882563625447314}-{'f1_val': 0.9966559062161475, 'auprc': 0.9967623029739685, 'loss_val': 0.019247653075272014, 'psi': 0.9966984649192759}
[S13] START round=47 head_norm_before_train=1.943725 cos_to_last_merge=1.0000 (last merge round=45)
[S13] round=47 local utility u=0.056290 metrics={'f1_val': 0.6178080137036318, 'auprc': 0.8092607298408266, 'loss_val': 0.8096066927486087, 'psi': 0.6943891001585097}-{'f1_val': 0.6484738674014758, 'auprc': 0.7593055292777782, 'loss_val': 0.9563167573693763, 'psi': 0.6928065321519967}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=47 metric=0.6178 head_norm=1.946437
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.817821e-02
[S13] stored merged vector for next round verification (round=47)
[S13] DEBUG after merge:  round=47 metric=0.6193 head_norm=1.959063 delta_norm=0.028178
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] START round=47 head_norm_before_train=1.684585 cos_to_last_merge=0.9526 (last merge round=24)
[S14] round=47 local utility u=0.042599 metrics={'f1_val': 0.9962860000590879, 'auprc': 0.9990119868207216, 'loss_val': 0.03555722120172183, 'psi': 0.9973763947637413}-{'f1_val': 0.98447218960495, 'auprc': 0.9990153556683984, 'loss_val': 0.04988338214112201, 'psi': 0.9902894560303294}
[S15] START round=47 head_norm_before_train=1.760577 cos_to_last_merge=0.9999 (last merge round=45)
[S15] round=47 local utility u=0.285187 metrics={'f1_val': 0.8269118390117142, 'auprc': 0.9925910874277071, 'loss_val': 0.23110053582509535, 'psi': 0.8931835383781114}-{'f1_val': 0.768311678295772, 'auprc': 0.967765939462292, 'loss_val': 0.3753977454563998, 'psi': 0.84809338276238}
[S16] START round=47 head_norm_before_train=1.689875 cos_to_last_merge=1.0000 (last merge round=46)
[S16] round=47 local utility u=0.000000 metrics={'f1_val': 0.9918426177823569, 'auprc': 0.9878198690355885, 'loss_val': 0.055032000504749365, 'psi': 0.9902335182836496}-{'f1_val': 0.992804978828382, 'auprc': 0.9914253947610405, 'loss_val': 0.04861169733489605, 'psi': 0.9922531452014454}
[S17] START round=47 head_norm_before_train=2.031997 (no previous merge yet)
[S17] round=47 local utility u=0.000000 metrics={'f1_val': 0.5877310984971368, 'auprc': 0.9530934864379024, 'loss_val': 1.1098488418054875, 'psi': 0.733876053673443}-{'f1_val': 0.6291455882468668, 'auprc': 0.9710316403029908, 'loss_val': 0.9532874376775008, 'psi': 0.7659000090693164}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.997)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] → sending delta(kind=head bytes=1805) to S6@127.0.0.1:44907
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S2@127.0.0.1:44902
[S15] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1805 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1805) from S8
[S6] cosine check vs S8: cos=0.9979
[S2] RECEIVED delta(kind=head bytes=1803) from S15
[S2] cosine check vs S15: cos=0.9698
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:44909
[S9] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1800) from S9
[S8] cosine check vs S9: cos=0.9981
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=47 metric=0.9939 head_norm=1.632064
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.238028e-02
[S8] stored merged vector for next round verification (round=47)
[S8] DEBUG after merge:  round=47 metric=0.9939 head_norm=1.614811 delta_norm=0.052380
[S8] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=48 head_norm_before_train=1.841634 cos_to_last_merge=0.9929 (last merge round=44)
[S2] round=48 local utility u=0.000000 metrics={'f1_val': 0.7542372384123166, 'auprc': 0.835797623654011, 'loss_val': 0.42200400563263807, 'psi': 0.7868613925089943}-{'f1_val': 0.8331350558364273, 'auprc': 0.8997127594849601, 'loss_val': 0.36655729754241395, 'psi': 0.8597661372958405}
[S3] START round=48 head_norm_before_train=1.822941 cos_to_last_merge=0.9965 (last merge round=45)
[S3] round=48 local utility u=0.084649 metrics={'f1_val': 0.9881874584154944, 'auprc': 0.9969920314355012, 'loss_val': 0.05888892709162404, 'psi': 0.9917092876234971}-{'f1_val': 0.9638845123915619, 'auprc': 0.9973798316300304, 'loss_val': 0.08353359326645085, 'psi': 0.9772826400869492}
[S4] START round=48 head_norm_before_train=2.120462 cos_to_last_merge=0.9997 (last merge round=42)
[S4] round=48 local utility u=0.032823 metrics={'f1_val': 0.9477811780402532, 'auprc': 0.9583088197574319, 'loss_val': 0.28355753970665126, 'psi': 0.9519922347271247}-{'f1_val': 0.9417756748205481, 'auprc': 0.949671145284539, 'loss_val': 0.2872578980699713, 'psi': 0.9449338630061445}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=48 head_norm_before_train=1.736394 cos_to_last_merge=0.9996 (last merge round=45)
[S5] round=48 local utility u=0.600383 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9994927419136874, 'loss_val': 0.03357596147911026, 'psi': 0.9974212263043074}-{'f1_val': 0.8374727650332852, 'auprc': 0.985757690462833, 'loss_val': 0.24173237877439, 'psi': 0.8967867352051042}
[S6] START round=48 head_norm_before_train=1.639242 cos_to_last_merge=0.9999 (last merge round=46)
[S6] round=48 local utility u=0.050965 metrics={'f1_val': 0.8143524291048252, 'auprc': 0.9634327608560949, 'loss_val': 0.40911302946780204, 'psi': 0.873984561805333}-{'f1_val': 0.7901765411635437, 'auprc': 0.9748136891729082, 'loss_val': 0.4001296271557411, 'psi': 0.8640314003672895}
[S6] not sending this round → trigger blocked (psi=0.874)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=48 metric=0.8144 head_norm=1.658335
[S6] _apply_head_vector_avg (torch): Δ‖w‖=6.605861e-02
[S6] stored merged vector for next round verification (round=48)
[S6] DEBUG after merge:  round=48 metric=0.8135 head_norm=1.643926 delta_norm=0.066059
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S7] START round=48 head_norm_before_train=1.620125 cos_to_last_merge=0.9993 (last merge round=46)
[S7] round=48 local utility u=0.498415 metrics={'f1_val': 0.6212553684738962, 'auprc': 0.797920904580352, 'loss_val': 0.6242803046876058, 'psi': 0.6919215829164784}-{'f1_val': 0.5305795429872253, 'auprc': 0.7768282608214335, 'loss_val': 1.013777083906366, 'psi': 0.6290790301209086}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=48 head_norm_before_train=1.614811 cos_to_last_merge=1.0000 (last merge round=47)
[S8] round=48 local utility u=0.000000 metrics={'f1_val': 0.9935301257143457, 'auprc': 0.9886030304758632, 'loss_val': 0.06827801331591224, 'psi': 0.9915592876189527}-{'f1_val': 0.9939122747783468, 'auprc': 0.9983759760652668, 'loss_val': 0.06287063501385864, 'psi': 0.9956977552931148}
[S9] START round=48 head_norm_before_train=1.599088 cos_to_last_merge=0.9544 (last merge round=24)
[S9] round=48 local utility u=0.000003 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9985810533811282, 'loss_val': 0.023473704001640335, 'psi': 0.9971824782200178}-{'f1_val': 0.9962500947792776, 'auprc': 0.9986950240517658, 'loss_val': 0.02382081955970564, 'psi': 0.9972280664882729}
[S10] START round=48 head_norm_before_train=1.981275 cos_to_last_merge=0.9706 (last merge round=25)
[S10] round=48 local utility u=0.000843 metrics={'f1_val': 0.9931720938432163, 'auprc': 0.9952774876688955, 'loss_val': 0.03673471919012398, 'psi': 0.994014251373488}-{'f1_val': 0.993391017001491, 'auprc': 0.993995495219579, 'loss_val': 0.03588911192568696, 'psi': 0.9936328082887261}
[S11] START round=48 head_norm_before_train=2.137162 cos_to_last_merge=0.9901 (last merge round=23)
[S11] round=48 local utility u=0.059870 metrics={'f1_val': 0.9962850284706224, 'auprc': 0.9974662654038692, 'loss_val': 0.019784782946351106, 'psi': 0.9967575232439212}-{'f1_val': 0.9815940215768301, 'auprc': 0.9982498739965835, 'loss_val': 0.05372875011141232, 'psi': 0.9882563625447314}
[S13] START round=48 head_norm_before_train=1.959063 cos_to_last_merge=1.0000 (last merge round=47)
[S13] round=48 local utility u=0.036229 metrics={'f1_val': 0.6600800096163517, 'auprc': 0.7640782102569441, 'loss_val': 0.8552335229553863, 'psi': 0.7016792898725888}-{'f1_val': 0.6178080137036318, 'auprc': 0.8092607298408266, 'loss_val': 0.8096066927486087, 'psi': 0.6943891001585097}
[S13] not sending this round → trigger blocked (psi=0.702)
[S14] START round=48 head_norm_before_train=1.695062 cos_to_last_merge=0.9516 (last merge round=24)
[S14] round=48 local utility u=0.003277 metrics={'f1_val': 0.996702949447409, 'auprc': 0.9990102435960622, 'loss_val': 0.03149914900134541, 'psi': 0.9976258671068703}-{'f1_val': 0.9962860000590879, 'auprc': 0.9990119868207216, 'loss_val': 0.03555722120172183, 'psi': 0.9973763947637413}
[S15] START round=48 head_norm_before_train=1.780694 cos_to_last_merge=0.9996 (last merge round=45)
[S15] round=48 local utility u=0.000000 metrics={'f1_val': 0.792498149356112, 'auprc': 0.9577814929365511, 'loss_val': 0.3558339649291302, 'psi': 0.8586114867882877}-{'f1_val': 0.8269118390117142, 'auprc': 0.9925910874277071, 'loss_val': 0.23110053582509535, 'psi': 0.8931835383781114}
[S16] START round=48 head_norm_before_train=1.703893 cos_to_last_merge=1.0000 (last merge round=46)
[S16] round=48 local utility u=0.000000 metrics={'f1_val': 0.9539522937712921, 'auprc': 0.9807437263620988, 'loss_val': 0.1366227987239278, 'psi': 0.9646688668076148}-{'f1_val': 0.9918426177823569, 'auprc': 0.9878198690355885, 'loss_val': 0.055032000504749365, 'psi': 0.9902335182836496}
[S17] START round=48 head_norm_before_train=2.037107 (no previous merge yet)
[S17] round=48 local utility u=0.000000 metrics={'f1_val': 0.6124654901654114, 'auprc': 0.9060397495836263, 'loss_val': 1.1253058968870007, 'psi': 0.7298951939326974}-{'f1_val': 0.5877310984971368, 'auprc': 0.9530934864379024, 'loss_val': 1.1098488418054875, 'psi': 0.733876053673443}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:44904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:44915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:44913
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S14] → sending delta(kind=head bytes=1792) to S16@127.0.0.1:44916
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1792 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:44908
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=48 metric=0.7542 head_norm=1.871539
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.472207e-01
[S2] stored merged vector for next round verification (round=48)
[S2] DEBUG after merge:  round=48 metric=0.7545 head_norm=1.809875 delta_norm=0.247221
[S2] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S13] RECEIVED delta(kind=head bytes=1798) from S10
[S13] cosine check vs S10: cos=0.9998
[S16] RECEIVED delta(kind=head bytes=1792) from S14
[S16] cosine check vs S14: cos=0.9990
[S4] RECEIVED delta(kind=head bytes=1803) from S11
[S4] cosine check vs S11: cos=0.9991
[S15] RECEIVED delta(kind=head bytes=1796) from S5
[S15] cosine check vs S5: cos=0.9948
[S3] sending update (kind=head size=1802 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1802) from S3
[S7] cosine check vs S3: cos=0.9482
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=48 metric=0.9540 head_norm=1.718042
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.926687e-02
[S16] stored merged vector for next round verification (round=48)
[S16] DEBUG after merge:  round=48 metric=0.9516 head_norm=1.711072 delta_norm=0.039267
[S16] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=48 metric=0.7925 head_norm=1.803113
[S15] _apply_head_vector_avg (torch): Δ‖w‖=9.336600e-02
[S15] stored merged vector for next round verification (round=48)
[S15] DEBUG after merge:  round=48 metric=0.7864 head_norm=1.777380 delta_norm=0.093366
[S15] aggregate: ROLLBACK (f1_val pre=0.792 post=0.786 tol_abs=0.005 tol_rel=0.0)
[S9] not sending this round → trigger blocked (psi=0.997)
[S2] START round=49 head_norm_before_train=1.809875 cos_to_last_merge=1.0000 (last merge round=48)
[S2] round=49 local utility u=0.439751 metrics={'f1_val': 0.8327439034019405, 'auprc': 0.9404204145671189, 'loss_val': 0.3274111561434782, 'psi': 0.8758145078680118}-{'f1_val': 0.7542372384123166, 'auprc': 0.835797623654011, 'loss_val': 0.42200400563263807, 'psi': 0.7868613925089943}
[S3] START round=49 head_norm_before_train=1.861403 cos_to_last_merge=0.9940 (last merge round=45)
[S3] round=49 local utility u=0.000000 metrics={'f1_val': 0.6966687187221007, 'auprc': 0.9920836140899678, 'loss_val': 0.6873328929018411, 'psi': 0.8148346768692476}-{'f1_val': 0.9881874584154944, 'auprc': 0.9969920314355012, 'loss_val': 0.05888892709162404, 'psi': 0.9917092876234971}
[S4] START round=49 head_norm_before_train=2.122513 cos_to_last_merge=0.9995 (last merge round=42)
[S4] round=49 local utility u=0.035417 metrics={'f1_val': 0.9585957592440583, 'auprc': 0.961815898033618, 'loss_val': 0.2881322798254343, 'psi': 0.9598838147598822}-{'f1_val': 0.9477811780402532, 'auprc': 0.9583088197574319, 'loss_val': 0.28355753970665126, 'psi': 0.9519922347271247}
[S4] not sending this round → trigger blocked (psi=0.960)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=49 metric=0.9586 head_norm=2.126062
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.921742e-02
[S4] stored merged vector for next round verification (round=49)
[S4] DEBUG after merge:  round=49 metric=0.9586 head_norm=2.133044 delta_norm=0.049217
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S5] START round=49 head_norm_before_train=1.756240 cos_to_last_merge=0.9993 (last merge round=45)
[S5] round=49 local utility u=0.000000 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9958808214207303, 'loss_val': 0.03277690673696878, 'psi': 0.9959764581071245}-{'f1_val': 0.9960402158980539, 'auprc': 0.9994927419136874, 'loss_val': 0.03357596147911026, 'psi': 0.9974212263043074}
[S6] START round=49 head_norm_before_train=1.643926 cos_to_last_merge=1.0000 (last merge round=48)
[S6] round=49 local utility u=0.255647 metrics={'f1_val': 0.8757350831501345, 'auprc': 0.9724285530904934, 'loss_val': 0.29310197162853374, 'psi': 0.914412471126278}-{'f1_val': 0.8143524291048252, 'auprc': 0.9634327608560949, 'loss_val': 0.40911302946780204, 'psi': 0.873984561805333}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S6] sending update (kind=head size=1806 to 1 peers)
[S7] START round=49 head_norm_before_train=1.647161 cos_to_last_merge=0.9977 (last merge round=46)
[S7] round=49 local utility u=0.282458 metrics={'f1_val': 0.6624534951676622, 'auprc': 0.8228406434710893, 'loss_val': 0.381311810302542, 'psi': 0.726608354489033}-{'f1_val': 0.6212553684738962, 'auprc': 0.797920904580352, 'loss_val': 0.6242803046876058, 'psi': 0.6919215829164784}
[S7] not sending this round → trigger blocked (psi=0.727)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=49 metric=0.6625 head_norm=1.677873
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.212794e-01
[S7] stored merged vector for next round verification (round=49)
[S7] DEBUG after merge:  round=49 metric=0.6797 head_norm=1.742647 delta_norm=0.321279
[S7] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S8] START round=49 head_norm_before_train=1.633845 cos_to_last_merge=0.9999 (last merge round=47)
[S8] round=49 local utility u=0.021288 metrics={'f1_val': 0.9939122747783468, 'auprc': 0.9985850460562518, 'loss_val': 0.057941764978513735, 'psi': 0.9957813832895087}-{'f1_val': 0.9935301257143457, 'auprc': 0.9886030304758632, 'loss_val': 0.06827801331591224, 'psi': 0.9915592876189527}
[S9] START round=49 head_norm_before_train=1.608887 cos_to_last_merge=0.9534 (last merge round=24)
[S9] round=49 local utility u=0.000000 metrics={'f1_val': 0.9899884433541285, 'auprc': 0.9990501991858906, 'loss_val': 0.03530286607561545, 'psi': 0.9936131456868333}-{'f1_val': 0.9962500947792776, 'auprc': 0.9985810533811282, 'loss_val': 0.023473704001640335, 'psi': 0.9971824782200178}
[S10] START round=49 head_norm_before_train=1.990467 cos_to_last_merge=0.9699 (last merge round=25)
[S10] round=49 local utility u=0.000000 metrics={'f1_val': 0.993391017001491, 'auprc': 0.9942391724011029, 'loss_val': 0.03519185733970208, 'psi': 0.9937302791613357}-{'f1_val': 0.9931720938432163, 'auprc': 0.9952774876688955, 'loss_val': 0.03673471919012398, 'psi': 0.994014251373488}
[S11] START round=49 head_norm_before_train=2.141135 cos_to_last_merge=0.9898 (last merge round=23)
[S11] round=49 local utility u=0.005203 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9987916639282141, 'loss_val': 0.017430400098280962, 'psi': 0.9976952195470319}-{'f1_val': 0.9962850284706224, 'auprc': 0.9974662654038692, 'loss_val': 0.019784782946351106, 'psi': 0.9967575232439212}
[S13] START round=49 head_norm_before_train=1.961623 cos_to_last_merge=1.0000 (last merge round=47)
[S13] round=49 local utility u=0.164970 metrics={'f1_val': 0.6819395558742098, 'auprc': 0.8040486602162908, 'loss_val': 0.7763617019876505, 'psi': 0.7307831976110423}-{'f1_val': 0.6600800096163517, 'auprc': 0.7640782102569441, 'loss_val': 0.8552335229553863, 'psi': 0.7016792898725888}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=49 metric=0.6819 head_norm=1.963621
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.379270e-02
[S13] stored merged vector for next round verification (round=49)
[S13] DEBUG after merge:  round=49 metric=0.6809 head_norm=1.976946 delta_norm=0.023793
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] START round=49 head_norm_before_train=1.704978 cos_to_last_merge=0.9506 (last merge round=24)
[S14] round=49 local utility u=0.000000 metrics={'f1_val': 0.9958819122162035, 'auprc': 0.9990051624495051, 'loss_val': 0.031008166970728213, 'psi': 0.9971312123095242}-{'f1_val': 0.996702949447409, 'auprc': 0.9990102435960622, 'loss_val': 0.03149914900134541, 'psi': 0.9976258671068703}
[S15] START round=49 head_norm_before_train=1.777380 cos_to_last_merge=1.0000 (last merge round=48)
[S15] round=49 local utility u=0.273762 metrics={'f1_val': 0.8587217013439523, 'auprc': 0.9861404639532555, 'loss_val': 0.2907290428063768, 'psi': 0.9096892063876736}-{'f1_val': 0.792498149356112, 'auprc': 0.9577814929365511, 'loss_val': 0.3558339649291302, 'psi': 0.8586114867882877}
[S16] START round=49 head_norm_before_train=1.711072 cos_to_last_merge=1.0000 (last merge round=48)
[S16] round=49 local utility u=0.000000 metrics={'f1_val': 0.9400863068964652, 'auprc': 0.9951155598098728, 'loss_val': 0.2278218642220382, 'psi': 0.9620980080618282}-{'f1_val': 0.9539522937712921, 'auprc': 0.9807437263620988, 'loss_val': 0.1366227987239278, 'psi': 0.9646688668076148}
[S17] START round=49 head_norm_before_train=2.041727 (no previous merge yet)
[S17] round=49 local utility u=0.000000 metrics={'f1_val': 0.39383093715721385, 'auprc': 0.6813087160111582, 'loss_val': 1.8096255292230976, 'psi': 0.5088220486987916}-{'f1_val': 0.6124654901654114, 'auprc': 0.9060397495836263, 'loss_val': 1.1253058968870007, 'psi': 0.7298951939326974}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.998)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:44903
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S2@127.0.0.1:44902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:44907
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] RECEIVED delta(kind=head bytes=1797) from S2
[S3] cosine check vs S2: cos=0.9564
[S8] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1803) from S15
[S2] cosine check vs S15: cos=0.9866
[S6] RECEIVED delta(kind=head bytes=1803) from S8
[S6] cosine check vs S8: cos=0.9980
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=49 metric=0.6967 head_norm=1.891402
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.764783e-01
[S3] stored merged vector for next round verification (round=49)
[S3] DEBUG after merge:  round=49 metric=0.7285 head_norm=1.839374 delta_norm=0.276478
[S3] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[runner] rounds complete.
[runner] all agents stopped.
