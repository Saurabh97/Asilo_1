[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:33203
[S3] → join 127.0.0.1:33202
[S4] → join 127.0.0.1:33202
[S5] → join 127.0.0.1:33202
[S6] → join 127.0.0.1:33202
[S7] → join 127.0.0.1:33202
[S8] → join 127.0.0.1:33202
[S9] → join 127.0.0.1:33202
[S10] → join 127.0.0.1:33202
[S11] → join 127.0.0.1:33202
[S13] → join 127.0.0.1:33202
[S14] → join 127.0.0.1:33202
[S15] → join 127.0.0.1:33202
[S16] → join 127.0.0.1:33202
[S17] → join 127.0.0.1:33202
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.183716 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.120378 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.182412 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.173348 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.135175 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.145687 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.171297 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.074918 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.095627 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.155424 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.249482 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.160581 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.183282 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.107409 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.109359 (no previous merge yet)
[S10]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S3] + discovered S17
[S3] + discovered S9
[S4] + discovered S3
[S4] + discovered S2
[S3] + discovered S4
[S3] + discovered S5
[S3] + discovered S14
[S3] + discovered S16
[S3] + discovered S6
[S3] + discovered S15
[S3] + discovered S13
[S3] + discovered S11
[S3] + discovered S7
[S3] + discovered S10
[S3] + discovered S8
[S4] + discovered S10
[S4] + discovered S9
[S5] + discovered S3
[S5] + discovered S4
[S5] + discovered S2
[S4] + discovered S14
[S4] + discovered S5
[S4] + discovered S17
[S4] + discovered S6
[S4] + discovered S15
[S4] + discovered S16
[S4] + discovered S13
[S4] + discovered S11
[S4] + discovered S7
[S4] + discovered S8
[S5] + discovered S10
[S5] + discovered S8
[S5] + discovered S11
[S5] + discovered S14
[S5] + discovered S9
[S5] + discovered S17
[S5] + discovered S7
[S5] + discovered S13
[S5] + discovered S15
[S5] + discovered S16
[S5] + discovered S6
[S6] + discovered S3
[S6] + discovered S5
[S6] + discovered S4
[S6] + discovered S2
[S7] + discovered S5
[S7] + discovered S3
[S7] + discovered S4
[S6] + discovered S7
[S7] + discovered S2
[S6] + discovered S8
[S7] + discovered S6
[S6] + discovered S9
[S6] + discovered S10
[S6] + discovered S15
[S6] + discovered S14
[S6] + discovered S13
[S6] + discovered S11
[S6] + discovered S17
[S6] + discovered S16
[S8] + discovered S4
[S8] + discovered S2
[S8] + discovered S7
[S8] + discovered S5
[S7] + discovered S16
[S8] + discovered S3
[S8] + discovered S6
[S7] + discovered S17
[S7] + discovered S13
[S7] + discovered S11
[S7] + discovered S8
[S7] + discovered S14
[S7] + discovered S15
[S7] + discovered S10
[S7] + discovered S9
[S9] + discovered S6
[S8] + discovered S9
[S8] + discovered S10
[S8] + discovered S13
[S8] + discovered S11
[S8] + discovered S14
[S8] + discovered S15
[S9] + discovered S8
[S8] + discovered S16
[S9] + discovered S7
[S9] + discovered S3
[S8] + discovered S17
[S9] + discovered S4
[S9] + discovered S5
[S9] + discovered S2
[S10] + discovered S3
[S10] + discovered S5
[S9] + discovered S11
[S10] + discovered S7
[S9] + discovered S15
[S9] + discovered S17
[S9] + discovered S14
[S9] + discovered S16
[S10] + discovered S8
[S10] + discovered S4
[S10] + discovered S2
[S10] + discovered S6
[S9] + discovered S10
[S9] + discovered S13
[S10] + discovered S9
[S11] + discovered S6
[S11] + discovered S5
[S11] + discovered S4
[S11] + discovered S10
[S10] + discovered S13
[S11] + discovered S3
[S11] + discovered S7
[S11] + discovered S2
[S11] + discovered S9
[S11] + discovered S8
[S10] + discovered S11
[S10] + discovered S14
[S10] + discovered S16
[S10] + discovered S17
[S10] + discovered S15
[S13] + discovered S3
[S13] + discovered S4
[S13] + discovered S7
[S13] + discovered S8
[S13] + discovered S9
[S11] + discovered S17
[S13] + discovered S2
[S13] + discovered S10
[S13] + discovered S5
[S13] + discovered S6
[S13] + discovered S11
[S11] + discovered S14
[S11] + discovered S13
[S11] + discovered S16
[S11] + discovered S15
[S14] + discovered S10
[S14] + discovered S2
[S14] + discovered S9
[S14] + discovered S5
[S13] + discovered S16
[S13] + discovered S14
[S14] + discovered S4
[S13] + discovered S17
[S13] + discovered S15
[S14] + discovered S13
[S14] + discovered S11
[S14] + discovered S3
[S14] + discovered S7
[S14] + discovered S8
[S14] + discovered S6
[S15] + discovered S2
[S15] + discovered S14
[S15] + discovered S13
[S15] + discovered S5
[S15] + discovered S4
[S15] + discovered S11
[S15] + discovered S7
[S15] + discovered S6
[S15] + discovered S9
[S15] + discovered S10
[S15] + discovered S3
[S14] + discovered S17
[S14] + discovered S16
[S14] + discovered S15
[S15] + discovered S8
[S16] + discovered S2
[S16] + discovered S5
[S16] + discovered S11
[S16] + discovered S4
[S16] + discovered S7
[S16] + discovered S13
[S16] + discovered S6
[S16] + discovered S15
[S16] + discovered S8
[S16] + discovered S10
[S16] + discovered S9
[S16] + discovered S3
[S16] + discovered S14
[S15] + discovered S17
[S15] + discovered S16
[S17] + discovered S8
[S17] + discovered S10
[S17] + discovered S14
[S17] + discovered S2
[S17] + discovered S9
[S17] + discovered S3
[S16] + discovered S17
[S17] + discovered S16
[S17] + discovered S5
[S17] + discovered S4
[S17] + discovered S11
[S17] + discovered S15
[S17] + discovered S6
[S17] + discovered S7
[S17] + discovered S13
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] ⇄ pheromone p=1.000 → S17@127.0.0.1:33217
[S6] ⇄ pheromone p=1.000 → S11@127.0.0.1:33212
[S7] ⇄ pheromone p=1.000 → S14@127.0.0.1:33214
[S11] ⇄ pheromone p=1.000 → S13@127.0.0.1:33213
[S4] ⇄ pheromone p=1.000 → S8@127.0.0.1:33209
[S5] ⇄ pheromone p=1.000 → S16@127.0.0.1:33216
[S3] ⇄ pheromone p=1.000 → S9@127.0.0.1:33210
[S2] ⇄ pheromone p=1.000 → S13@127.0.0.1:33213
[S14] ⇄ pheromone p=1.000 → S15@127.0.0.1:33215
[S15] ⇄ pheromone p=1.000 → S11@127.0.0.1:33212
[S8] ⇄ pheromone p=1.000 → S4@127.0.0.1:33204
[S10] ⇄ pheromone p=1.000 → S3@127.0.0.1:33203
[S9] ⇄ pheromone p=1.000 → S17@127.0.0.1:33217
[S13] ⇄ pheromone p=1.000 → S4@127.0.0.1:33204
[S17] ⇄ pheromone p=1.000 → S3@127.0.0.1:33203
[S2] START round=1 head_norm_before_train=1.208077 (no previous merge yet)
[S2] round=1 local utility u=0.088168 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7741795893541501, 'loss_val': 1.2420333728341157, 'psi': 0.3947381157748001}-{'f1_val': 0.1417771333885667, 'auprc': 0.7477706328401752, 'loss_val': 1.3391433516998352, 'psi': 0.38417453316921013}
[S3] START round=1 head_norm_before_train=1.132410 (no previous merge yet)
[S3] round=1 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8685149760944538, 'loss_val': 1.3205437949254253, 'psi': 0.4313100298062458}-{'f1_val': 0.39638969140647473, 'auprc': 0.7127170894868791, 'loss_val': 1.3530235966065027, 'psi': 0.5229206506386365}
[S4] START round=1 head_norm_before_train=1.186388 (no previous merge yet)
[S4] round=1 local utility u=0.348675 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7715840637843475, 'loss_val': 1.2791439917508982, 'psi': 0.3927696028508495}-{'f1_val': 0.14022662889518414, 'auprc': 0.5587211148467948, 'loss_val': 1.3379058306644922, 'psi': 0.3076244232758284}
[S5] START round=1 head_norm_before_train=1.176929 (no previous merge yet)
[S5] round=1 local utility u=0.450746 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7212051692815495, 'loss_val': 1.3240475741797737, 'psi': 0.37383921056976266}-{'f1_val': 0.14226190476190476, 'auprc': 0.4311684216101234, 'loss_val': 1.355428450717608, 'psi': 0.25782451150119223}
[S6] START round=1 head_norm_before_train=1.155469 (no previous merge yet)
[S6] round=1 local utility u=0.043421 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8138649917833811, 'loss_val': 1.2647223916483483, 'psi': 0.4104017659441217}-{'f1_val': 0.14142628205128205, 'auprc': 0.8054628071983836, 'loss_val': 1.326357797836708, 'psi': 0.4070408921101227}
[S7] START round=1 head_norm_before_train=1.148718 (no previous merge yet)
[S7] round=1 local utility u=0.190921 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.5753888170221658, 'loss_val': 1.3365149274424346, 'psi': 0.31538962044632135}-{'f1_val': 0.14205682272909165, 'auprc': 0.4585609345588417, 'loss_val': 1.3678727487076046, 'psi': 0.2686584674609917}
[S8] START round=1 head_norm_before_train=1.189571 (no previous merge yet)
[S8] round=1 local utility u=0.161858 metrics={'f1_val': 0.4162799983110498, 'auprc': 0.7708873870172509, 'loss_val': 1.2294455825107582, 'psi': 0.5581229537935303}-{'f1_val': 0.37308219280302063, 'auprc': 0.7827113825024351, 'loss_val': 1.3294464212229982, 'psi': 0.5369338686827865}
[S9] START round=1 head_norm_before_train=1.084028 (no previous merge yet)
[S9] round=1 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.6606608728616217, 'loss_val': 1.295627124093828, 'psi': 0.3491031234286463}-{'f1_val': 0.40187830590429907, 'auprc': 0.65029873814, 'loss_val': 1.329371730374289, 'psi': 0.5012464787985795}
[S10] START round=1 head_norm_before_train=1.112262 (no previous merge yet)
[S10] round=1 local utility u=0.088799 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.646449242630256, 'loss_val': 1.258113785730436, 'psi': 0.3417526795771368}-{'f1_val': 0.13862163754172394, 'auprc': 0.6098338731603496, 'loss_val': 1.3258650301483208, 'psi': 0.32710653178917426}
[S11] START round=1 head_norm_before_train=1.158315 (no previous merge yet)
[S11] round=1 local utility u=0.201040 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.5989561360481406, 'loss_val': 1.3131605926037098, 'psi': 0.3238306644431226}-{'f1_val': 0.14041368337311058, 'auprc': 0.47449297934917545, 'loss_val': 1.3418514664053982, 'psi': 0.27404540176353653}
[S13] START round=1 head_norm_before_train=1.255470 (no previous merge yet)
[S13] round=1 local utility u=0.075070 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5990474382573857, 'loss_val': 1.2667380994520225, 'psi': 0.32385043284918613}-{'f1_val': 0.1403857625770531, 'auprc': 0.5669644881051273, 'loss_val': 1.3206296425087947, 'psi': 0.3110172527882828}
[S14] START round=1 head_norm_before_train=1.167278 (no previous merge yet)
[S14] round=1 local utility u=0.654798 metrics={'f1_val': 0.3142057207498384, 'auprc': 0.5100850646709818, 'loss_val': 1.348327737483494, 'psi': 0.39255745831829575}-{'f1_val': 0.13981912144702843, 'auprc': 0.43012289804014586, 'loss_val': 1.3717174886942176, 'psi': 0.2559406320842754}
[S15] START round=1 head_norm_before_train=1.193295 (no previous merge yet)
[S15] round=1 local utility u=0.000000 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7673043830676075, 'loss_val': 1.287610200325231, 'psi': 0.390761944043978}-{'f1_val': 0.13973365136155833, 'auprc': 0.7926000126379046, 'loss_val': 1.3390016378782212, 'psi': 0.40088019587209683}
[S16] START round=1 head_norm_before_train=1.108180 (no previous merge yet)
[S16] round=1 local utility u=1.000000 metrics={'f1_val': 0.4158660438240812, 'auprc': 0.6322362122242782, 'loss_val': 1.3398954878608011, 'psi': 0.50241411118416}-{'f1_val': 0.09148550724637682, 'auprc': 0.49794878933430625, 'loss_val': 1.3652122499938841, 'psi': 0.2540708200815486}
[S17] START round=1 head_norm_before_train=1.130883 (no previous merge yet)
[S17] round=1 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.6093314125424074, 'loss_val': 1.2608189352114831, 'psi': 0.32830194300739357}-{'f1_val': 0.14094896331738438, 'auprc': 0.6465319690328852, 'loss_val': 1.3301050195679922, 'psi': 0.3431821656035847}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S7] → sending delta(kind=head bytes=1789) to S2@127.0.0.1:33202
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S16] → sending delta(kind=head bytes=1791) to S9@127.0.0.1:33210
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:33211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S5] → sending delta(kind=head bytes=1786) to S13@127.0.0.1:33213
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S2] → sending delta(kind=head bytes=1788) to S3@127.0.0.1:33203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:33212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S13] → sending delta(kind=head bytes=1791) to S7@127.0.0.1:33208
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S11] → sending delta(kind=head bytes=1786) to S5@127.0.0.1:33205
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S14] → sending delta(kind=head bytes=1786) to S8@127.0.0.1:33209
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S7@127.0.0.1:33208
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:33211
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1794 to 1 peers)
[S14] sending update (kind=head size=1786 to 1 peers)
[S11] sending update (kind=head size=1786 to 1 peers)
[S2] sending update (kind=head size=1788 to 1 peers)
[S13] sending update (kind=head size=1791 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1786 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1789 to 1 peers)
[S16] sending update (kind=head size=1791 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1786) from S11
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.167701)
[S5] loaded HEAD from S11 (vec_in norm=1.167701)
[S5] cosine check vs S11: cos=0.0780
[S5] BUFFERED delta from S11 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1786) from S5
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.191112)
[S13] loaded HEAD from S5 (vec_in norm=1.191112)
[S13] cosine check vs S5: cos=0.0160
[S13] BUFFERED delta from S5 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1788) from S2
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.258021)
[S3] loaded HEAD from S2 (vec_in norm=1.258021)
[S3] cosine check vs S2: cos=0.0441
[S3] BUFFERED delta from S2 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1795) from S10
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.157246)
[S11] loaded HEAD from S10 (vec_in norm=1.157246)
[S11] cosine check vs S10: cos=0.0027
[S11] BUFFERED delta from S10 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1795) from S4
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.213254)
[S10] loaded HEAD from S4 (vec_in norm=1.213254)
[S10] cosine check vs S4: cos=-0.0317
[S10] DROPPED delta from S4 (cos=-0.0317 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1791) from S13
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.286826)
[S7] loaded HEAD from S13 (vec_in norm=1.286826)
[S7] cosine check vs S13: cos=-0.0773
[S7] DROPPED delta from S13 (cos=-0.0773 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1799) from S6
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.196685)
[S10] loaded HEAD from S6 (vec_in norm=1.196685)
[S10] cosine check vs S6: cos=-0.0002
[S10] DROPPED delta from S6 (cos=-0.0002 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1789) from S7
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.157383)
[S2] loaded HEAD from S7 (vec_in norm=1.157383)
[S2] cosine check vs S7: cos=0.0336
[S2] BUFFERED delta from S7 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1791) from S16
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.121092)
[S9] loaded HEAD from S16 (vec_in norm=1.121092)
[S9] cosine check vs S16: cos=-0.0038
[S9] DROPPED delta from S16 (cos=-0.0038 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1786) from S14
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.182319)
[S8] loaded HEAD from S14 (vec_in norm=1.182319)
[S8] cosine check vs S14: cos=-0.0144
[S8] DROPPED delta from S14 (cos=-0.0144 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1794) from S8
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.235734)
[S7] loaded HEAD from S8 (vec_in norm=1.235734)
[S7] cosine check vs S8: cos=0.1373
[S7] BUFFERED delta from S8 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=1 metric=0.1398 head_norm=1.153387
[S3] _apply_head_vector_avg (torch): Δ‖w‖=8.344141e-01
[S3] stored merged vector for next round verification (round=1)
[S3] DEBUG after merge:  round=1 metric=0.1398 head_norm=0.871902 delta_norm=0.834414
[S3] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=1 metric=0.1421 head_norm=1.157383
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.864021e-01
[S7] stored merged vector for next round verification (round=1)
[S7] DEBUG after merge:  round=1 metric=0.1421 head_norm=0.902695 delta_norm=0.786402
[S7] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=1 metric=0.1404 head_norm=1.167701
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.208861e-01
[S11] stored merged vector for next round verification (round=1)
[S11] DEBUG after merge:  round=1 metric=0.1404 head_norm=0.823114 delta_norm=0.820886
[S11] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=1 metric=0.1404 head_norm=1.286826
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.697336e-01
[S13] stored merged vector for next round verification (round=1)
[S13] DEBUG after merge:  round=1 metric=0.1404 head_norm=0.883684 delta_norm=0.869734
[S13] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=1 metric=0.1418 head_norm=1.258021
[S2] _apply_head_vector_avg (torch): Δ‖w‖=8.402755e-01
[S2] stored merged vector for next round verification (round=1)
[S2] DEBUG after merge:  round=1 metric=0.1418 head_norm=0.868915 delta_norm=0.840276
[S2] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=1 metric=0.1423 head_norm=1.191112
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.008415e-01
[S5] stored merged vector for next round verification (round=1)
[S5] DEBUG after merge:  round=1 metric=0.1423 head_norm=0.865904 delta_norm=0.800842
[S5] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=0.868915 cos_to_last_merge=1.0000 (last merge round=1)
[S2] round=2 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7539773139311133, 'loss_val': 1.2118241174998126, 'psi': 0.3866572056055854}-{'f1_val': 0.1417771333885667, 'auprc': 0.7741795893541501, 'loss_val': 1.2420333728341157, 'psi': 0.3947381157748001}
[S3] START round=2 head_norm_before_train=0.871902 cos_to_last_merge=1.0000 (last merge round=1)
[S3] round=2 local utility u=0.038937 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8932206380284125, 'loss_val': 1.31678654184048, 'psi': 0.4411922945798292}-{'f1_val': 0.13984006561410703, 'auprc': 0.8685149760944538, 'loss_val': 1.3205437949254253, 'psi': 0.4313100298062458}
[S4] START round=2 head_norm_before_train=1.213254 (no previous merge yet)
[S4] round=2 local utility u=0.049417 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7708404285298157, 'loss_val': 1.1780799418102696, 'psi': 0.3924721487490368}-{'f1_val': 0.14022662889518414, 'auprc': 0.7715840637843475, 'loss_val': 1.2791439917508982, 'psi': 0.3927696028508495}
[S5] START round=2 head_norm_before_train=0.865904 cos_to_last_merge=1.0000 (last merge round=1)
[S5] round=2 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7099082137556425, 'loss_val': 1.3210164630923864, 'psi': 0.3693204283593999}-{'f1_val': 0.14226190476190476, 'auprc': 0.7212051692815495, 'loss_val': 1.3240475741797737, 'psi': 0.37383921056976266}
[S6] START round=2 head_norm_before_train=1.196685 (no previous merge yet)
[S6] round=2 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.7940705205908396, 'loss_val': 1.2265952445352906, 'psi': 0.40248397746710507}-{'f1_val': 0.14142628205128205, 'auprc': 0.8138649917833811, 'loss_val': 1.2647223916483483, 'psi': 0.4104017659441217}
[S7] START round=2 head_norm_before_train=0.902695 cos_to_last_merge=1.0000 (last merge round=1)
[S7] round=2 local utility u=0.308153 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7759550464043327, 'loss_val': 1.3219078547359022, 'psi': 0.3956161121991881}-{'f1_val': 0.14205682272909165, 'auprc': 0.5753888170221658, 'loss_val': 1.3365149274424346, 'psi': 0.31538962044632135}
[S8] START round=2 head_norm_before_train=1.235734 (no previous merge yet)
[S8] round=2 local utility u=0.099696 metrics={'f1_val': 0.4168449666512448, 'auprc': 0.7663797047218764, 'loss_val': 1.0199211308356626, 'psi': 0.5566588618794974}-{'f1_val': 0.4162799983110498, 'auprc': 0.7708873870172509, 'loss_val': 1.2294455825107582, 'psi': 0.5581229537935303}
[S9] START round=2 head_norm_before_train=1.100571 (no previous merge yet)
[S9] round=2 local utility u=0.327434 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8650795725164788, 'loss_val': 1.254015094973076, 'psi': 0.4308706032905892}-{'f1_val': 0.141397957139996, 'auprc': 0.6606608728616217, 'loss_val': 1.295627124093828, 'psi': 0.3491031234286463}
[S10] START round=2 head_norm_before_train=1.157246 (no previous merge yet)
[S10] round=2 local utility u=0.034680 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6302611161568112, 'loss_val': 1.14018991835231, 'psi': 0.33527742898775886}-{'f1_val': 0.13862163754172394, 'auprc': 0.646449242630256, 'loss_val': 1.258113785730436, 'psi': 0.3417526795771368}
[S11] START round=2 head_norm_before_train=0.823114 cos_to_last_merge=1.0000 (last merge round=1)
[S11] round=2 local utility u=0.341871 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.825967760413785, 'loss_val': 1.3104535519595895, 'psi': 0.4146353141893803}-{'f1_val': 0.14041368337311058, 'auprc': 0.5989561360481406, 'loss_val': 1.3131605926037098, 'psi': 0.3238306644431226}
[S13] START round=2 head_norm_before_train=0.883684 cos_to_last_merge=1.0000 (last merge round=1)
[S13] round=2 local utility u=0.001965 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5942531013940701, 'loss_val': 1.2484246943337525, 'psi': 0.3219326981038599}-{'f1_val': 0.1403857625770531, 'auprc': 0.5990474382573857, 'loss_val': 1.2667380994520225, 'psi': 0.32385043284918613}
[S14] START round=2 head_norm_before_train=1.182319 (no previous merge yet)
[S14] round=2 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7386207923724947, 'loss_val': 1.323155186705693, 'psi': 0.3796630286786201}-{'f1_val': 0.3142057207498384, 'auprc': 0.5100850646709818, 'loss_val': 1.348327737483494, 'psi': 0.39255745831829575}
[S15] START round=2 head_norm_before_train=1.230244 (no previous merge yet)
[S15] round=2 local utility u=0.041164 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7761088513414649, 'loss_val': 1.231695847430685, 'psi': 0.39428373135352096}-{'f1_val': 0.13973365136155833, 'auprc': 0.7673043830676075, 'loss_val': 1.287610200325231, 'psi': 0.390761944043978}
[S16] START round=2 head_norm_before_train=1.121092 (no previous merge yet)
[S16] round=2 local utility u=0.000000 metrics={'f1_val': 0.2768749616490854, 'auprc': 0.6454409395143331, 'loss_val': 1.3058713859205253, 'psi': 0.42430135279518455}-{'f1_val': 0.4158660438240812, 'auprc': 0.6322362122242782, 'loss_val': 1.3398954878608011, 'psi': 0.50241411118416}
[S17] START round=2 head_norm_before_train=1.176019 (no previous merge yet)
[S17] round=2 local utility u=0.034611 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5868066811194812, 'loss_val': 1.1240219050042777, 'psi': 0.3192920504382231}-{'f1_val': 0.14094896331738438, 'auprc': 0.6093314125424074, 'loss_val': 1.2608189352114831, 'psi': 0.32830194300739357}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S4@127.0.0.1:33204
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:33203
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:33203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:33214
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] → sending delta(kind=head bytes=1794) to S11@127.0.0.1:33212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S10] → sending delta(kind=head bytes=1791) to S9@127.0.0.1:33210
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S9] → sending delta(kind=head bytes=1791) to S15@127.0.0.1:33215
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:33217
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] → sending delta(kind=head bytes=1793) to S13@127.0.0.1:33213
[S13] sending update (kind=head size=1794 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1793 to 1 peers)
[S9] sending update (kind=head size=1791 to 1 peers)
[S10] sending update (kind=head size=1791 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1804 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1798) from S15
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.276628)
[S3] loaded HEAD from S15 (vec_in norm=1.276628)
[S3] cosine check vs S15: cos=-0.0636
[S3] DROPPED delta from S15 (cos=-0.0636 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1804) from S7
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.918030)
[S4] loaded HEAD from S7 (vec_in norm=0.918030)
[S4] cosine check vs S7: cos=0.1293
[S4] BUFFERED delta from S7 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1791) from S10
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.213343)
[S9] loaded HEAD from S10 (vec_in norm=1.213343)
[S9] cosine check vs S10: cos=-0.0773
[S9] DROPPED delta from S10 (cos=-0.0773 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1802) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.303747)
[S3] loaded HEAD from S8 (vec_in norm=1.303747)
[S3] cosine check vs S8: cos=-0.0159
[S3] DROPPED delta from S8 (cos=-0.0159 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1794) from S13
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=0.924389)
[S11] loaded HEAD from S13 (vec_in norm=0.924389)
[S11] cosine check vs S13: cos=0.1302
[S11] BUFFERED delta from S13 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1791) from S9
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.126168)
[S15] loaded HEAD from S9 (vec_in norm=1.126168)
[S15] cosine check vs S9: cos=0.1114
[S15] BUFFERED delta from S9 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1793) from S11
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=0.839751)
[S13] loaded HEAD from S11 (vec_in norm=0.839751)
[S13] cosine check vs S11: cos=0.1302
[S13] BUFFERED delta from S11 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1797) from S3
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=0.893708)
[S14] loaded HEAD from S3 (vec_in norm=0.893708)
[S14] cosine check vs S3: cos=0.0356
[S14] BUFFERED delta from S3 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1796) from S4
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.268189)
[S17] loaded HEAD from S4 (vec_in norm=1.268189)
[S17] cosine check vs S4: cos=-0.0360
[S17] DROPPED delta from S4 (cos=-0.0360 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] → sending delta(kind=head bytes=1794) to S16@127.0.0.1:33216
[S17] sending update (kind=head size=1794 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1794) from S17
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.238210)
[S16] loaded HEAD from S17 (vec_in norm=1.238210)
[S16] cosine check vs S17: cos=-0.0561
[S16] DROPPED delta from S17 (cos=-0.0561 < 0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=2 metric=0.1404 head_norm=1.203200
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.365032e-01
[S14] stored merged vector for next round verification (round=2)
[S14] DEBUG after merge:  round=2 metric=0.1038 head_norm=0.762080 delta_norm=0.736503
[S14] aggregate: ROLLBACK (f1_val pre=0.140 post=0.104 tol_abs=0.005 tol_rel=0.0)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=2 metric=0.1404 head_norm=0.924389
[S13] _apply_head_vector_avg (torch): Δ‖w‖=5.825673e-01
[S13] stored merged vector for next round verification (round=2)
[S13] DEBUG after merge:  round=2 metric=0.1404 head_norm=0.663667 delta_norm=0.582567
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=2 metric=0.1404 head_norm=0.839751
[S11] _apply_head_vector_avg (torch): Δ‖w‖=5.825673e-01
[S11] stored merged vector for next round verification (round=2)
[S11] DEBUG after merge:  round=2 metric=0.1404 head_norm=0.663667 delta_norm=0.582567
[S11] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=2 metric=0.1397 head_norm=1.276628
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.027551e-01
[S15] stored merged vector for next round verification (round=2)
[S15] DEBUG after merge:  round=2 metric=0.1397 head_norm=0.896996 delta_norm=0.802755
[S15] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=2 metric=0.1402 head_norm=1.268189
[S4] _apply_head_vector_avg (torch): Δ‖w‖=7.331644e-01
[S4] stored merged vector for next round verification (round=2)
[S4] DEBUG after merge:  round=2 metric=0.1402 head_norm=0.829464 delta_norm=0.733164
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=3 head_norm_before_train=0.921540 cos_to_last_merge=0.9929 (last merge round=1)
[S2] round=3 local utility u=0.916927 metrics={'f1_val': 0.4160938496492347, 'auprc': 0.7810725445586966, 'loss_val': 1.1051569616624395, 'psi': 0.5620853276130194}-{'f1_val': 0.1417771333885667, 'auprc': 0.7539773139311133, 'loss_val': 1.2118241174998126, 'psi': 0.3866572056055854}
[S3] START round=3 head_norm_before_train=0.893708 cos_to_last_merge=0.9968 (last merge round=1)
[S3] round=3 local utility u=0.008221 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.879526470860347, 'loss_val': 1.2592623266028968, 'psi': 0.43571462771260305}-{'f1_val': 0.13984006561410703, 'auprc': 0.8932206380284125, 'loss_val': 1.31678654184048, 'psi': 0.4411922945798292}
[S4] START round=3 head_norm_before_train=0.829464 cos_to_last_merge=1.0000 (last merge round=2)
[S4] round=3 local utility u=0.060680 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7739021224685565, 'loss_val': 1.0659045530001205, 'psi': 0.3936968263245331}-{'f1_val': 0.14022662889518414, 'auprc': 0.7708404285298157, 'loss_val': 1.1780799418102696, 'psi': 0.3924721487490368}
[S5] START round=3 head_norm_before_train=0.884392 cos_to_last_merge=0.9973 (last merge round=1)
[S5] round=3 local utility u=0.045587 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7279817948767218, 'loss_val': 1.2840629797115142, 'psi': 0.3765498608078316}-{'f1_val': 0.14226190476190476, 'auprc': 0.7099082137556425, 'loss_val': 1.3210164630923864, 'psi': 0.3693204283593999}
[S6] START round=3 head_norm_before_train=1.252970 (no previous merge yet)
[S6] round=3 local utility u=0.584590 metrics={'f1_val': 0.374082753302354, 'auprc': 0.6732674477915818, 'loss_val': 1.0909441491664118, 'psi': 0.49375663109804513}-{'f1_val': 0.14142628205128205, 'auprc': 0.7940705205908396, 'loss_val': 1.2265952445352906, 'psi': 0.40248397746710507}
[S7] START round=3 head_norm_before_train=0.918030 cos_to_last_merge=0.9971 (last merge round=1)
[S7] round=3 local utility u=0.019976 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.777105075077116, 'loss_val': 1.2854061237129941, 'psi': 0.3960761236683014}-{'f1_val': 0.14205682272909165, 'auprc': 0.7759550464043327, 'loss_val': 1.3219078547359022, 'psi': 0.3956161121991881}
[S8] START round=3 head_norm_before_train=1.303747 (no previous merge yet)
[S8] round=3 local utility u=0.116654 metrics={'f1_val': 0.37319932875242556, 'auprc': 0.8641461875350898, 'loss_val': 0.8180379776166897, 'psi': 0.5695780722654913}-{'f1_val': 0.4168449666512448, 'auprc': 0.7663797047218764, 'loss_val': 1.0199211308356626, 'psi': 0.5566588618794974}
[S9] START round=3 head_norm_before_train=1.126168 (no previous merge yet)
[S9] round=3 local utility u=0.027649 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8656364096756767, 'loss_val': 1.2003875044900265, 'psi': 0.4310933381542683}-{'f1_val': 0.141397957139996, 'auprc': 0.8650795725164788, 'loss_val': 1.254015094973076, 'psi': 0.4308706032905892}
[S10] START round=3 head_norm_before_train=1.213343 (no previous merge yet)
[S10] round=3 local utility u=0.971777 metrics={'f1_val': 0.41694859683592245, 'auprc': 0.6431974208378295, 'loss_val': 0.9054058959564372, 'psi': 0.5074481264366852}-{'f1_val': 0.13862163754172394, 'auprc': 0.6302611161568112, 'loss_val': 1.14018991835231, 'psi': 0.33527742898775886}
[S11] START round=3 head_norm_before_train=0.663667 cos_to_last_merge=1.0000 (last merge round=2)
[S11] round=3 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.8170279722460896, 'loss_val': 1.3004962169560872, 'psi': 0.4110593989223022}-{'f1_val': 0.14041368337311058, 'auprc': 0.825967760413785, 'loss_val': 1.3104535519595895, 'psi': 0.4146353141893803}
[S13] START round=3 head_norm_before_train=0.663667 cos_to_last_merge=1.0000 (last merge round=2)
[S13] round=3 local utility u=0.000000 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5619222015591523, 'loss_val': 1.20122370271413, 'psi': 0.3090003381698928}-{'f1_val': 0.1403857625770531, 'auprc': 0.5942531013940701, 'loss_val': 1.2484246943337525, 'psi': 0.3219326981038599}
[S14] START round=3 head_norm_before_train=0.762080 cos_to_last_merge=1.0000 (last merge round=2)
[S14] round=3 local utility u=0.909020 metrics={'f1_val': 0.4108877804922776, 'auprc': 0.8072241769332509, 'loss_val': 1.3341040425377833, 'psi': 0.5694223390686669}-{'f1_val': 0.14035785288270378, 'auprc': 0.7386207923724947, 'loss_val': 1.323155186705693, 'psi': 0.3796630286786201}
[S15] START round=3 head_norm_before_train=0.896996 cos_to_last_merge=1.0000 (last merge round=2)
[S15] round=3 local utility u=0.022838 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7770336666512521, 'loss_val': 1.188793848231921, 'psi': 0.39465365747743586}-{'f1_val': 0.13973365136155833, 'auprc': 0.7761088513414649, 'loss_val': 1.231695847430685, 'psi': 0.39428373135352096}
[S16] START round=3 head_norm_before_train=1.145278 (no previous merge yet)
[S16] round=3 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.6547392820262873, 'loss_val': 1.2563748140754294, 'psi': 0.34627818293003687}-{'f1_val': 0.2768749616490854, 'auprc': 0.6454409395143331, 'loss_val': 1.3058713859205253, 'psi': 0.42430135279518455}
[S17] START round=3 head_norm_before_train=1.238210 (no previous merge yet)
[S17] round=3 local utility u=0.839642 metrics={'f1_val': 0.36473077343116034, 'auprc': 0.6493791443368597, 'loss_val': 0.9751455117590165, 'psi': 0.47859012179344007}-{'f1_val': 0.14094896331738438, 'auprc': 0.5868066811194812, 'loss_val': 1.1240219050042777, 'psi': 0.3192920504382231}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:33217
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:33212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S3@127.0.0.1:33203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:33215
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:33212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:33217
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1782 reason=None
[S4] → sending delta(kind=head bytes=1782) to S10@127.0.0.1:33211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:33214
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:33210
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:33213
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S5] → sending delta(kind=head bytes=1789) to S16@127.0.0.1:33216
[S8] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1789 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1794 to 1 peers)
[S4] sending update (kind=head size=1782 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1804 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1800) from S3
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=0.925182)
[S9] loaded HEAD from S3 (vec_in norm=0.925182)
[S9] cosine check vs S3: cos=-0.1222
[S9] DROPPED delta from S3 (cos=-0.1222 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1802) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.377029)
[S17] loaded HEAD from S8 (vec_in norm=1.377029)
[S17] cosine check vs S8: cos=0.0867
[S17] BUFFERED delta from S8 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1795) from S9
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.155880)
[S17] loaded HEAD from S9 (vec_in norm=1.155880)
[S17] cosine check vs S9: cos=-0.0411
[S17] DROPPED delta from S9 (cos=-0.0411 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1800) from S2
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=0.961273)
[S13] loaded HEAD from S2 (vec_in norm=0.961273)
[S13] cosine check vs S2: cos=-0.0520
[S13] DROPPED delta from S2 (cos=-0.0520 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1802) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.288775)
[S11] loaded HEAD from S6 (vec_in norm=1.288775)
[S11] cosine check vs S6: cos=-0.0274
[S11] DROPPED delta from S6 (cos=-0.0274 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1804) from S10
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.277406)
[S3] loaded HEAD from S10 (vec_in norm=1.277406)
[S3] cosine check vs S10: cos=-0.0003
[S3] DROPPED delta from S10 (cos=-0.0003 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1798) from S15
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.958992)
[S11] loaded HEAD from S15 (vec_in norm=0.958992)
[S11] cosine check vs S15: cos=-0.0059
[S11] DROPPED delta from S15 (cos=-0.0059 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1794) from S7
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.945424)
[S14] loaded HEAD from S7 (vec_in norm=0.945424)
[S14] cosine check vs S7: cos=-0.0194
[S14] DROPPED delta from S7 (cos=-0.0194 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1782) from S4
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.895304)
[S10] loaded HEAD from S4 (vec_in norm=0.895304)
[S10] cosine check vs S4: cos=-0.0293
[S10] DROPPED delta from S4 (cos=-0.0293 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1789) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.910516)
[S16] loaded HEAD from S5 (vec_in norm=0.910516)
[S16] cosine check vs S5: cos=-0.1010
[S16] DROPPED delta from S5 (cos=-0.1010 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1801) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.783701)
[S15] loaded HEAD from S14 (vec_in norm=0.783701)
[S15] cosine check vs S14: cos=-0.0824
[S15] DROPPED delta from S14 (cos=-0.0824 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:33203
[S17] sending update (kind=head size=1799 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1799) from S17
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.296011)
[S3] loaded HEAD from S17 (vec_in norm=1.296011)
[S3] cosine check vs S17: cos=0.0283
[S3] BUFFERED delta from S17 (total buffered=1)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=3 metric=0.1398 head_norm=0.925182
[S3] _apply_head_vector_avg (torch): Δ‖w‖=7.854456e-01
[S3] stored merged vector for next round verification (round=3)
[S3] DEBUG after merge:  round=3 metric=0.1398 head_norm=0.806770 delta_norm=0.785446
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=3 metric=0.3647 head_norm=1.296011
[S17] _apply_head_vector_avg (torch): Δ‖w‖=9.036483e-01
[S17] stored merged vector for next round verification (round=3)
[S17] DEBUG after merge:  round=3 metric=0.3897 head_norm=0.985570 delta_norm=0.903648
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=0.961273 cos_to_last_merge=0.9830 (last merge round=1)
[S2] round=4 local utility u=0.061980 metrics={'f1_val': 0.41698068739424143, 'auprc': 0.7718244263738125, 'loss_val': 0.9587733854631191, 'psi': 0.5589181829860699}-{'f1_val': 0.4160938496492347, 'auprc': 0.7810725445586966, 'loss_val': 1.1051569616624395, 'psi': 0.5620853276130194}
[S3] START round=4 head_norm_before_train=0.806770 cos_to_last_merge=1.0000 (last merge round=3)
[S3] round=4 local utility u=0.133346 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9667771202931701, 'loss_val': 1.2543222866638055, 'psi': 0.4706148874857323}-{'f1_val': 0.13984006561410703, 'auprc': 0.879526470860347, 'loss_val': 1.2592623266028968, 'psi': 0.43571462771260305}
[S4] START round=4 head_norm_before_train=0.895304 cos_to_last_merge=0.9935 (last merge round=2)
[S4] round=4 local utility u=0.685511 metrics={'f1_val': 0.3844314787461823, 'auprc': 0.6694001654191383, 'loss_val': 0.8466059406369588, 'psi': 0.4984189534153647}-{'f1_val': 0.14022662889518414, 'auprc': 0.7739021224685565, 'loss_val': 1.0659045530001205, 'psi': 0.3936968263245331}
[S5] START round=4 head_norm_before_train=0.910516 cos_to_last_merge=0.9899 (last merge round=1)
[S5] round=4 local utility u=0.019057 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7288747180735937, 'loss_val': 1.2486280900060485, 'psi': 0.37690703008658033}-{'f1_val': 0.14226190476190476, 'auprc': 0.7279817948767218, 'loss_val': 1.2840629797115142, 'psi': 0.3765498608078316}
[S6] START round=4 head_norm_before_train=1.288775 (no previous merge yet)
[S6] round=4 local utility u=0.310188 metrics={'f1_val': 0.41673395620738773, 'auprc': 0.6881761258843084, 'loss_val': 0.7712016917988572, 'psi': 0.525310824078156}-{'f1_val': 0.374082753302354, 'auprc': 0.6732674477915818, 'loss_val': 1.0909441491664118, 'psi': 0.49375663109804513}
[S7] START round=4 head_norm_before_train=0.945424 cos_to_last_merge=0.9895 (last merge round=1)
[S7] round=4 local utility u=0.013794 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7774573691265377, 'loss_val': 1.2588756313145948, 'psi': 0.3962170412880701}-{'f1_val': 0.14205682272909165, 'auprc': 0.777105075077116, 'loss_val': 1.2854061237129941, 'psi': 0.3960761236683014}
[S8] START round=4 head_norm_before_train=1.377029 (no previous merge yet)
[S8] round=4 local utility u=0.106608 metrics={'f1_val': 0.38614770201938875, 'auprc': 0.8664293646260185, 'loss_val': 0.6893619720431156, 'psi': 0.5782603670620406}-{'f1_val': 0.37319932875242556, 'auprc': 0.8641461875350898, 'loss_val': 0.8180379776166897, 'psi': 0.5695780722654913}
[S9] START round=4 head_norm_before_train=1.155880 (no previous merge yet)
[S9] round=4 local utility u=0.036302 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8656296303041777, 'loss_val': 1.1277631236815566, 'psi': 0.4310906264056687}-{'f1_val': 0.141397957139996, 'auprc': 0.8656364096756767, 'loss_val': 1.2003875044900265, 'psi': 0.4310933381542683}
[S10] START round=4 head_norm_before_train=1.277406 (no previous merge yet)
[S10] round=4 local utility u=0.330045 metrics={'f1_val': 0.3889428747875011, 'auprc': 0.8573509926056422, 'loss_val': 0.7197429760424165, 'psi': 0.5763061219147575}-{'f1_val': 0.41694859683592245, 'auprc': 0.6431974208378295, 'loss_val': 0.9054058959564372, 'psi': 0.5074481264366852}
[S11] START round=4 head_norm_before_train=0.686215 cos_to_last_merge=0.9952 (last merge round=2)
[S11] round=4 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7681288977345099, 'loss_val': 1.254115544854444, 'psi': 0.3914997691176703}-{'f1_val': 0.14041368337311058, 'auprc': 0.8170279722460896, 'loss_val': 1.3004962169560872, 'psi': 0.4110593989223022}
[S13] START round=4 head_norm_before_train=0.721231 cos_to_last_merge=0.9884 (last merge round=2)
[S13] round=4 local utility u=1.000000 metrics={'f1_val': 0.4163539771616168, 'auprc': 0.7113451965289564, 'loss_val': 1.067651861869516, 'psi': 0.5343504649085526}-{'f1_val': 0.1403857625770531, 'auprc': 0.5619222015591523, 'loss_val': 1.20122370271413, 'psi': 0.3090003381698928}
[S14] START round=4 head_norm_before_train=0.783701 cos_to_last_merge=0.9965 (last merge round=2)
[S14] round=4 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8031599972371606, 'loss_val': 1.2925716624349293, 'psi': 0.4054787106244865}-{'f1_val': 0.4108877804922776, 'auprc': 0.8072241769332509, 'loss_val': 1.3341040425377833, 'psi': 0.5694223390686669}
[S15] START round=4 head_norm_before_train=0.958992 cos_to_last_merge=0.9943 (last merge round=2)
[S15] round=4 local utility u=0.977859 metrics={'f1_val': 0.416567672447929, 'auprc': 0.8000248466295311, 'loss_val': 0.9630536423279774, 'psi': 0.56995054212057}-{'f1_val': 0.13973365136155833, 'auprc': 0.7770336666512521, 'loss_val': 1.188793848231921, 'psi': 0.39465365747743586}
[S16] START round=4 head_norm_before_train=1.178612 (no previous merge yet)
[S16] round=4 local utility u=0.861301 metrics={'f1_val': 0.41428462841297564, 'auprc': 0.652662352500739, 'loss_val': 1.1694258805048467, 'psi': 0.5096357180480809}-{'f1_val': 0.14063745019920318, 'auprc': 0.6547392820262873, 'loss_val': 1.2563748140754294, 'psi': 0.34627818293003687}
[S17] START round=4 head_norm_before_train=0.985570 cos_to_last_merge=1.0000 (last merge round=3)
[S17] round=4 local utility u=0.055803 metrics={'f1_val': 0.389226774833401, 'auprc': 0.5949990617160795, 'loss_val': 0.8473761152778928, 'psi': 0.4715356895864724}-{'f1_val': 0.36473077343116034, 'auprc': 0.6493791443368597, 'loss_val': 0.9751455117590165, 'psi': 0.47859012179344007}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:33214
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:33210
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:33212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S17@127.0.0.1:33217
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:33204
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] → sending delta(kind=head bytes=1793) to S17@127.0.0.1:33217
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:33213
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:33212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:33203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:33217
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:33211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S5] → sending delta(kind=head bytes=1790) to S16@127.0.0.1:33216
[S10] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1790 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1793 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1794 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1795 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1795) from S7
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.976359)
[S14] loaded HEAD from S7 (vec_in norm=0.976359)
[S14] cosine check vs S7: cos=-0.0139
[S14] DROPPED delta from S7 (cos=-0.0139 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1796) from S4
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.980319)
[S10] loaded HEAD from S4 (vec_in norm=0.980319)
[S10] cosine check vs S4: cos=-0.0359
[S10] DROPPED delta from S4 (cos=-0.0359 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1790) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.932492)
[S16] loaded HEAD from S5 (vec_in norm=0.932492)
[S16] cosine check vs S5: cos=-0.1093
[S16] DROPPED delta from S5 (cos=-0.1093 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1802) from S10
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.364671)
[S3] loaded HEAD from S10 (vec_in norm=1.364671)
[S3] cosine check vs S10: cos=-0.0066
[S3] DROPPED delta from S10 (cos=-0.0066 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1799) from S9
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.192268)
[S17] loaded HEAD from S9 (vec_in norm=1.192268)
[S17] cosine check vs S9: cos=0.0205
[S17] BUFFERED delta from S9 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1801) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.349904)
[S11] loaded HEAD from S6 (vec_in norm=1.349904)
[S11] cosine check vs S6: cos=-0.0183
[S11] DROPPED delta from S6 (cos=-0.0183 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1793) from S16
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.220154)
[S17] loaded HEAD from S16 (vec_in norm=1.220154)
[S17] cosine check vs S16: cos=-0.0023
[S17] DROPPED delta from S16 (cos=-0.0023 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1800) from S15
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.034663)
[S11] loaded HEAD from S15 (vec_in norm=1.034663)
[S11] cosine check vs S15: cos=0.0023
[S11] BUFFERED delta from S15 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1794) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.455347)
[S17] loaded HEAD from S8 (vec_in norm=1.455347)
[S17] cosine check vs S8: cos=0.7054
[S17] BUFFERED delta from S8 (total buffered=2)
[S9] RECEIVED delta(kind=head bytes=1795) from S3
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=0.829404)
[S9] loaded HEAD from S3 (vec_in norm=0.829404)
[S9] cosine check vs S3: cos=-0.1053
[S9] DROPPED delta from S3 (cos=-0.1053 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1796) from S13
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=0.772560)
[S4] loaded HEAD from S13 (vec_in norm=0.772560)
[S4] cosine check vs S13: cos=0.0474
[S4] BUFFERED delta from S13 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1797) from S2
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.016178)
[S13] loaded HEAD from S2 (vec_in norm=1.016178)
[S13] cosine check vs S2: cos=-0.0433
[S13] DROPPED delta from S2 (cos=-0.0433 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S17] → sending delta(kind=head bytes=1807) to S3@127.0.0.1:33203
[S17] sending update (kind=head size=1807 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1807) from S17
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.056023)
[S3] loaded HEAD from S17 (vec_in norm=1.056023)
[S3] cosine check vs S17: cos=0.5909
[S3] BUFFERED delta from S17 (total buffered=1)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=4 metric=0.1404 head_norm=0.716325
[S11] _apply_head_vector_avg (torch): Δ‖w‖=6.285369e-01
[S11] stored merged vector for next round verification (round=4)
[S11] DEBUG after merge:  round=4 metric=0.1404 head_norm=0.629894 delta_norm=0.628537
[S11] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=4 metric=0.1398 head_norm=0.829404
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.381858e-01
[S3] stored merged vector for next round verification (round=4)
[S3] DEBUG after merge:  round=4 metric=0.1398 head_norm=0.842343 delta_norm=0.438186
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=4 metric=0.3844 head_norm=0.980319
[S4] _apply_head_vector_avg (torch): Δ‖w‖=6.095103e-01
[S4] stored merged vector for next round verification (round=4)
[S4] DEBUG after merge:  round=4 metric=0.6501 head_norm=0.638306 delta_norm=0.609510
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=4 metric=0.3892 head_norm=1.056023
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.886057e-01
[S17] stored merged vector for next round verification (round=4)
[S17] DEBUG after merge:  round=4 metric=0.3894 head_norm=0.890894 delta_norm=0.488606
[S17] aggregate: ACCEPT kept=['S9', 'S8'] (k=2/2) mode=median trim_p=0.1
[S2] START round=5 head_norm_before_train=1.016178 cos_to_last_merge=0.9667 (last merge round=1)
[S2] round=5 local utility u=0.744307 metrics={'f1_val': 0.6292757806911062, 'auprc': 0.7749040606228463, 'loss_val': 0.7531689422499619, 'psi': 0.6875270926638022}-{'f1_val': 0.41698068739424143, 'auprc': 0.7718244263738125, 'loss_val': 0.9587733854631191, 'psi': 0.5589181829860699}
[S3] START round=5 head_norm_before_train=0.842343 cos_to_last_merge=1.0000 (last merge round=4)
[S3] round=5 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9600750330299859, 'loss_val': 1.2474208026232692, 'psi': 0.4679340525804586}-{'f1_val': 0.13984006561410703, 'auprc': 0.9667771202931701, 'loss_val': 1.2543222866638055, 'psi': 0.4706148874857323}
[S4] START round=5 head_norm_before_train=0.638306 cos_to_last_merge=1.0000 (last merge round=4)
[S4] round=5 local utility u=0.323165 metrics={'f1_val': 0.39359853346160156, 'auprc': 0.8637615257527607, 'loss_val': 0.8383630861732726, 'psi': 0.5816637303780652}-{'f1_val': 0.3844314787461823, 'auprc': 0.6694001654191383, 'loss_val': 0.8466059406369588, 'psi': 0.4984189534153647}
[S5] START round=5 head_norm_before_train=0.932492 cos_to_last_merge=0.9817 (last merge round=1)
[S5] round=5 local utility u=0.037205 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7381869266825296, 'loss_val': 1.202155221433129, 'psi': 0.3806319135301547}-{'f1_val': 0.14226190476190476, 'auprc': 0.7288747180735937, 'loss_val': 1.2486280900060485, 'psi': 0.37690703008658033}
[S6] START round=5 head_norm_before_train=1.349904 (no previous merge yet)
[S6] round=5 local utility u=1.000000 metrics={'f1_val': 0.6956102092223666, 'auprc': 0.792608426577035, 'loss_val': 0.4943326835226029, 'psi': 0.734409496164234}-{'f1_val': 0.41673395620738773, 'auprc': 0.6881761258843084, 'loss_val': 0.7712016917988572, 'psi': 0.525310824078156}
[S7] START round=5 head_norm_before_train=0.976359 cos_to_last_merge=0.9799 (last merge round=1)
[S7] round=5 local utility u=0.012702 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7776109465126385, 'loss_val': 1.233931687130614, 'psi': 0.3962784722425104}-{'f1_val': 0.14205682272909165, 'auprc': 0.7774573691265377, 'loss_val': 1.2588756313145948, 'psi': 0.3962170412880701}
[S8] START round=5 head_norm_before_train=1.455347 (no previous merge yet)
[S8] round=5 local utility u=0.974365 metrics={'f1_val': 0.6087603652988924, 'auprc': 0.9933534621558346, 'loss_val': 0.45708108572861966, 'psi': 0.7625976040416693}-{'f1_val': 0.38614770201938875, 'auprc': 0.8664293646260185, 'loss_val': 0.6893619720431156, 'psi': 0.5782603670620406}
[S9] START round=5 head_norm_before_train=1.192268 (no previous merge yet)
[S9] round=5 local utility u=0.110426 metrics={'f1_val': 0.15454523609883306, 'auprc': 0.8658644734076477, 'loss_val': 0.9864992885998293, 'psi': 0.43907293102235895}-{'f1_val': 0.141397957139996, 'auprc': 0.8656296303041777, 'loss_val': 1.1277631236815566, 'psi': 0.4310906264056687}
[S10] START round=5 head_norm_before_train=1.364671 (no previous merge yet)
[S10] round=5 local utility u=1.000000 metrics={'f1_val': 0.7014667009264342, 'auprc': 0.943030950383312, 'loss_val': 0.5002090840414085, 'psi': 0.7980924007091853}-{'f1_val': 0.3889428747875011, 'auprc': 0.8573509926056422, 'loss_val': 0.7197429760424165, 'psi': 0.5763061219147575}
[S11] START round=5 head_norm_before_train=0.629894 cos_to_last_merge=1.0000 (last merge round=4)
[S11] round=5 local utility u=0.039062 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7883519311633557, 'loss_val': 1.2366615837187307, 'psi': 0.39958898248920866}-{'f1_val': 0.14041368337311058, 'auprc': 0.7681288977345099, 'loss_val': 1.254115544854444, 'psi': 0.3914997691176703}
[S13] START round=5 head_norm_before_train=0.772560 cos_to_last_merge=0.9714 (last merge round=2)
[S13] round=5 local utility u=0.000000 metrics={'f1_val': 0.4160038662657951, 'auprc': 0.4961428836194989, 'loss_val': 0.9397564061356486, 'psi': 0.4480594732072766}-{'f1_val': 0.4163539771616168, 'auprc': 0.7113451965289564, 'loss_val': 1.067651861869516, 'psi': 0.5343504649085526}
[S14] START round=5 head_norm_before_train=0.817827 cos_to_last_merge=0.9866 (last merge round=2)
[S14] round=5 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7872649934373566, 'loss_val': 1.2468134964321835, 'psi': 0.3991207091045649}-{'f1_val': 0.14035785288270378, 'auprc': 0.8031599972371606, 'loss_val': 1.2925716624349293, 'psi': 0.4054787106244865}
[S15] START round=5 head_norm_before_train=1.034663 cos_to_last_merge=0.9790 (last merge round=2)
[S15] round=5 local utility u=1.000000 metrics={'f1_val': 0.6961523630216103, 'auprc': 0.7999393945045538, 'loss_val': 0.6352760747804443, 'psi': 0.7376671756147877}-{'f1_val': 0.416567672447929, 'auprc': 0.8000248466295311, 'loss_val': 0.9630536423279774, 'psi': 0.56995054212057}
[S16] START round=5 head_norm_before_train=1.220154 (no previous merge yet)
[S16] round=5 local utility u=0.061212 metrics={'f1_val': 0.41742175001598325, 'auprc': 0.6348679859417456, 'loss_val': 1.0124421618423878, 'psi': 0.5044002443862883}-{'f1_val': 0.41428462841297564, 'auprc': 0.652662352500739, 'loss_val': 1.1694258805048467, 'psi': 0.5096357180480809}
[S17] START round=5 head_norm_before_train=0.890894 cos_to_last_merge=1.0000 (last merge round=4)
[S17] round=5 local utility u=0.061536 metrics={'f1_val': 0.354308856722404, 'auprc': 0.7237645279584799, 'loss_val': 0.9010930505562553, 'psi': 0.5020911252168343}-{'f1_val': 0.389226774833401, 'auprc': 0.5949990617160795, 'loss_val': 0.8473761152778928, 'psi': 0.4715356895864724}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:33217
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:33213
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S5] → sending delta(kind=head bytes=1792) to S16@127.0.0.1:33216
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] → sending delta(kind=head bytes=1794) to S17@127.0.0.1:33217
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S7] → sending delta(kind=head bytes=1791) to S14@127.0.0.1:33214
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:33212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:33211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] → sending delta(kind=head bytes=1793) to S13@127.0.0.1:33213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:33203
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:33212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:33217
[S2] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1793 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1791 to 1 peers)
[S5] sending update (kind=head size=1792 to 1 peers)
[S16] sending update (kind=head size=1794 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1794) from S16
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.270191)
[S17] loaded HEAD from S16 (vec_in norm=1.270191)
[S17] cosine check vs S16: cos=0.0139
[S17] BUFFERED delta from S16 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1799) from S9
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.228274)
[S17] loaded HEAD from S9 (vec_in norm=1.228274)
[S17] cosine check vs S9: cos=0.3399
[S17] BUFFERED delta from S9 (total buffered=2)
[S17] RECEIVED delta(kind=head bytes=1801) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.518723)
[S17] loaded HEAD from S8 (vec_in norm=1.518723)
[S17] cosine check vs S8: cos=0.7875
[S17] BUFFERED delta from S8 (total buffered=3)
[S13] RECEIVED delta(kind=head bytes=1793) from S11
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=0.656361)
[S13] loaded HEAD from S11 (vec_in norm=0.656361)
[S13] cosine check vs S11: cos=0.5308
[S13] BUFFERED delta from S11 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1800) from S2
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.085786)
[S13] loaded HEAD from S2 (vec_in norm=1.085786)
[S13] cosine check vs S2: cos=-0.0419
[S13] DROPPED delta from S2 (cos=-0.0419 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1802) from S10
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.452031)
[S3] loaded HEAD from S10 (vec_in norm=1.452031)
[S3] cosine check vs S10: cos=0.0012
[S3] BUFFERED delta from S10 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1796) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.415402)
[S11] loaded HEAD from S6 (vec_in norm=1.415402)
[S11] cosine check vs S6: cos=0.0566
[S11] BUFFERED delta from S6 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1799) from S15
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.126350)
[S11] loaded HEAD from S15 (vec_in norm=1.126350)
[S11] cosine check vs S15: cos=0.7831
[S11] BUFFERED delta from S15 (total buffered=2)
[S14] RECEIVED delta(kind=head bytes=1791) from S7
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.998365)
[S14] loaded HEAD from S7 (vec_in norm=0.998365)
[S14] cosine check vs S7: cos=-0.0107
[S14] DROPPED delta from S7 (cos=-0.0107 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1796) from S4
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.745692)
[S10] loaded HEAD from S4 (vec_in norm=0.745692)
[S10] cosine check vs S4: cos=0.1607
[S10] BUFFERED delta from S4 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1792) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.951838)
[S16] loaded HEAD from S5 (vec_in norm=0.951838)
[S16] cosine check vs S5: cos=-0.1170
[S16] DROPPED delta from S5 (cos=-0.1170 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:33203
[S17] sending update (kind=head size=1794 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1794) from S17
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=0.965007)
[S3] loaded HEAD from S17 (vec_in norm=0.965007)
[S3] cosine check vs S17: cos=0.7557
[S3] BUFFERED delta from S17 (total buffered=2)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=5 metric=0.4160 head_norm=0.839065
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.708572e-01
[S13] stored merged vector for next round verification (round=5)
[S13] DEBUG after merge:  round=5 metric=0.4160 head_norm=0.655656 delta_norm=0.370857
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.494 → S4@127.0.0.1:33204
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=5 metric=0.1398 head_norm=0.861797
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.631663e-01
[S3] stored merged vector for next round verification (round=5)
[S3] DEBUG after merge:  round=5 metric=0.1398 head_norm=0.727673 delta_norm=0.463166
[S3] aggregate: ACCEPT kept=['S10', 'S17'] (k=2/2) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.354 → S9@127.0.0.1:33210
[S14] ⇄ pheromone p=0.498 → S15@127.0.0.1:33215
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=5 metric=0.1404 head_norm=0.656361
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.111612e-01
[S11] stored merged vector for next round verification (round=5)
[S11] DEBUG after merge:  round=5 metric=0.1404 head_norm=0.696271 delta_norm=0.411161
[S11] aggregate: ACCEPT kept=['S6', 'S15'] (k=2/2) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.387 → S13@127.0.0.1:33213
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=5 metric=0.7015 head_norm=1.452031
[S10] _apply_head_vector_avg (torch): Δ‖w‖=7.609940e-01
[S10] stored merged vector for next round verification (round=5)
[S10] DEBUG after merge:  round=5 metric=0.7015 head_norm=0.867821 delta_norm=0.760994
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.716 → S3@127.0.0.1:33203
[S2] ⇄ pheromone p=0.611 → S13@127.0.0.1:33213
[S8] ⇄ pheromone p=0.578 → S17@127.0.0.1:33217
[S15] ⇄ pheromone p=0.691 → S11@127.0.0.1:33212
[S16] ⇄ pheromone p=0.560 → S17@127.0.0.1:33217
[S7] ⇄ pheromone p=0.382 → S14@127.0.0.1:33214
[S5] ⇄ pheromone p=0.381 → S16@127.0.0.1:33216
[S4] ⇄ pheromone p=0.543 → S10@127.0.0.1:33211
[S6] ⇄ pheromone p=0.656 → S11@127.0.0.1:33212
[S9] ⇄ pheromone p=0.393 → S17@127.0.0.1:33217
[S17] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=5 metric=0.3543 head_norm=0.965007
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.886945e-01
[S17] stored merged vector for next round verification (round=5)
[S17] DEBUG after merge:  round=5 metric=0.3545 head_norm=0.803152 delta_norm=0.388694
[S17] aggregate: ACCEPT kept=['S16', 'S9', 'S8'] (k=3/3) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.460 → S3@127.0.0.1:33203
[S2] START round=6 head_norm_before_train=1.085786 cos_to_last_merge=0.9445 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.945
[S2] round=6 local utility u=0.357560 metrics={'f1_val': 0.7016407651533589, 'auprc': 0.7937912173529066, 'loss_val': 0.5289005718351243, 'psi': 0.738500946033178}-{'f1_val': 0.6292757806911062, 'auprc': 0.7749040606228463, 'loss_val': 0.7531689422499619, 'psi': 0.6875270926638022}
[S3] START round=6 head_norm_before_train=0.727673 cos_to_last_merge=1.0000 (last merge round=5)
[S3] round=6 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.7558049223275698, 'loss_val': 1.1971324457012016, 'psi': 0.38622600829949216}-{'f1_val': 0.13984006561410703, 'auprc': 0.9600750330299859, 'loss_val': 1.2474208026232692, 'psi': 0.4679340525804586}
[S4] START round=6 head_norm_before_train=0.745692 cos_to_last_merge=0.9825 (last merge round=4)
[S4] round=6 local utility u=0.883039 metrics={'f1_val': 0.6564665596266077, 'auprc': 0.8932839466235384, 'loss_val': 0.7380602867323001, 'psi': 0.7511935144253801}-{'f1_val': 0.39359853346160156, 'auprc': 0.8637615257527607, 'loss_val': 0.8383630861732726, 'psi': 0.5816637303780652}
[S5] START round=6 head_norm_before_train=0.951838 cos_to_last_merge=0.9740 (last merge round=1)
[S5] round=6 local utility u=0.887887 metrics={'f1_val': 0.4091401106817494, 'auprc': 0.7701233325820123, 'loss_val': 1.1234587976773944, 'psi': 0.5535333994418545}-{'f1_val': 0.14226190476190476, 'auprc': 0.7381869266825296, 'loss_val': 1.202155221433129, 'psi': 0.3806319135301547}
[S6] START round=6 head_norm_before_train=1.415402 (no previous merge yet)
[S6] round=6 local utility u=0.007408 metrics={'f1_val': 0.7070412635198414, 'auprc': 0.7817034991908629, 'loss_val': 0.5153892265871093, 'psi': 0.7369061577882501}-{'f1_val': 0.6956102092223666, 'auprc': 0.792608426577035, 'loss_val': 0.4943326835226029, 'psi': 0.734409496164234}
[S7] START round=6 head_norm_before_train=0.998365 cos_to_last_merge=0.9722 (last merge round=1)
[S7] round=6 local utility u=0.021990 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7777996823937428, 'loss_val': 1.1905170675573629, 'psi': 0.3963539665949521}-{'f1_val': 0.14205682272909165, 'auprc': 0.7776109465126385, 'loss_val': 1.233931687130614, 'psi': 0.3962784722425104}
[S8] START round=6 head_norm_before_train=1.518723 (no previous merge yet)
[S8] round=6 local utility u=0.426984 metrics={'f1_val': 0.7149513830905807, 'auprc': 0.9960019274410725, 'loss_val': 0.24820539901634067, 'psi': 0.8273716008307774}-{'f1_val': 0.6087603652988924, 'auprc': 0.9933534621558346, 'loss_val': 0.45708108572861966, 'psi': 0.7625976040416693}
[S9] START round=6 head_norm_before_train=1.228274 (no previous merge yet)
[S9] round=6 local utility u=1.000000 metrics={'f1_val': 0.49411210305488806, 'auprc': 0.8662090793126151, 'loss_val': 0.7664965493822248, 'psi': 0.6429508935579789}-{'f1_val': 0.15454523609883306, 'auprc': 0.8658644734076477, 'loss_val': 0.9864992885998293, 'psi': 0.43907293102235895}
[S10] START round=6 head_norm_before_train=0.867821 cos_to_last_merge=1.0000 (last merge round=5)
[S10] round=6 local utility u=0.103401 metrics={'f1_val': 0.6998932897468348, 'auprc': 0.99530823893714, 'loss_val': 0.44079874319259643, 'psi': 0.8180592694229569}-{'f1_val': 0.7014667009264342, 'auprc': 0.943030950383312, 'loss_val': 0.5002090840414085, 'psi': 0.7980924007091853}
[S11] START round=6 head_norm_before_train=0.696271 cos_to_last_merge=1.0000 (last merge round=5)
[S11] round=6 local utility u=0.082819 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.8263407573585986, 'loss_val': 1.1849900158398021, 'psi': 0.4147845129673058}-{'f1_val': 0.14041368337311058, 'auprc': 0.7883519311633557, 'loss_val': 1.2366615837187307, 'psi': 0.39958898248920866}
[S13] START round=6 head_norm_before_train=0.655656 cos_to_last_merge=1.0000 (last merge round=5)
[S13] round=6 local utility u=0.000000 metrics={'f1_val': 0.41580726865236384, 'auprc': 0.4687501364297036, 'loss_val': 0.9298088683360543, 'psi': 0.4369844157632997}-{'f1_val': 0.4160038662657951, 'auprc': 0.4961428836194989, 'loss_val': 0.9397564061356486, 'psi': 0.4480594732072766}
[S14] START round=6 head_norm_before_train=0.857785 cos_to_last_merge=0.9728 (last merge round=2)
[S14] round=6 local utility u=0.119621 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8423426380674399, 'loss_val': 1.1728047703180569, 'psi': 0.42115176695659823}-{'f1_val': 0.14035785288270378, 'auprc': 0.7872649934373566, 'loss_val': 1.2468134964321835, 'psi': 0.3991207091045649}
[S15] START round=6 head_norm_before_train=1.126350 cos_to_last_merge=0.9550 (last merge round=2)
[S15] round=6 local utility u=0.067548 metrics={'f1_val': 0.6986457399140302, 'auprc': 0.7993636026109985, 'loss_val': 0.5134138320700097, 'psi': 0.7389328849928175}-{'f1_val': 0.6961523630216103, 'auprc': 0.7999393945045538, 'loss_val': 0.6352760747804443, 'psi': 0.7376671756147877}
[S16] START round=6 head_norm_before_train=1.270191 (no previous merge yet)
[S16] round=6 local utility u=0.060077 metrics={'f1_val': 0.417193595187378, 'auprc': 0.644494698778762, 'loss_val': 0.9197994872147375, 'psi': 0.5081140366239316}-{'f1_val': 0.41742175001598325, 'auprc': 0.6348679859417456, 'loss_val': 1.0124421618423878, 'psi': 0.5044002443862883}
[S17] START round=6 head_norm_before_train=0.803152 cos_to_last_merge=1.0000 (last merge round=5)
[S17] round=6 local utility u=0.000000 metrics={'f1_val': 0.35134329211318677, 'auprc': 0.6348483367660009, 'loss_val': 0.9362778669333239, 'psi': 0.46474530997431246}-{'f1_val': 0.354308856722404, 'auprc': 0.7237645279584799, 'loss_val': 0.9010930505562553, 'psi': 0.5020911252168343}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:33213
[S2] sending update (kind=head size=1795 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1795) from S2
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.175974)
[S13] loaded HEAD from S2 (vec_in norm=1.175974)
[S13] cosine check vs S2: cos=-0.0680
[S13] DROPPED delta from S2 (cos=-0.0680 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:33217
[S9] sending update (kind=head size=1795 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1795) from S9
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.277423)
[S17] loaded HEAD from S9 (vec_in norm=1.277423)
[S17] cosine check vs S9: cos=0.4536
[S17] BUFFERED delta from S9 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:33212
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:33215
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S10] → sending delta(kind=head bytes=1791) to S3@127.0.0.1:33203
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:33217
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S7] → sending delta(kind=head bytes=1792) to S14@127.0.0.1:33214
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:33213
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1800) from S15
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.237952)
[S11] loaded HEAD from S15 (vec_in norm=1.237952)
[S11] cosine check vs S15: cos=0.7708
[S11] BUFFERED delta from S15 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1796) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.888551)
[S15] loaded HEAD from S14 (vec_in norm=0.888551)
[S15] cosine check vs S14: cos=-0.0245
[S15] DROPPED delta from S14 (cos=-0.0245 < 0.0)
[S11] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1792 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:33216
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S4] → sending delta(kind=head bytes=1792) to S10@127.0.0.1:33211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:33212
[S13] RECEIVED delta(kind=head bytes=1795) from S11
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=0.717161)
[S13] loaded HEAD from S11 (vec_in norm=0.717161)
[S13] cosine check vs S11: cos=0.5395
[S13] BUFFERED delta from S11 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1792) from S7
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.018573)
[S14] loaded HEAD from S7 (vec_in norm=1.018573)
[S14] cosine check vs S7: cos=-0.0091
[S14] DROPPED delta from S7 (cos=-0.0091 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1795) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.578379)
[S17] loaded HEAD from S8 (vec_in norm=1.578379)
[S17] cosine check vs S8: cos=0.7364
[S17] BUFFERED delta from S8 (total buffered=2)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:33217
[S6] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1792 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1797) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.470497)
[S11] loaded HEAD from S6 (vec_in norm=1.470497)
[S11] cosine check vs S6: cos=0.5502
[S11] BUFFERED delta from S6 (total buffered=2)
[S10] RECEIVED delta(kind=head bytes=1792) from S4
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.872451)
[S10] loaded HEAD from S4 (vec_in norm=0.872451)
[S10] cosine check vs S4: cos=0.4866
[S10] BUFFERED delta from S4 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1795) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.976544)
[S16] loaded HEAD from S5 (vec_in norm=0.976544)
[S16] cosine check vs S5: cos=-0.1271
[S16] DROPPED delta from S5 (cos=-0.1271 < 0.0)
[S16] sending update (kind=head size=1795 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1795) from S16
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.318284)
[S17] loaded HEAD from S16 (vec_in norm=1.318284)
[S17] cosine check vs S16: cos=0.2654
[S17] BUFFERED delta from S16 (total buffered=3)
[S10] sending update (kind=head size=1791 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1791) from S10
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=0.983805)
[S3] loaded HEAD from S10 (vec_in norm=0.983805)
[S3] cosine check vs S10: cos=0.5376
[S3] BUFFERED delta from S10 (total buffered=1)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=6 metric=0.6999 head_norm=0.983805
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.726836e-01
[S10] stored merged vector for next round verification (round=6)
[S10] DEBUG after merge:  round=6 metric=0.6985 head_norm=0.800682 delta_norm=0.472684
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=6 metric=0.1404 head_norm=0.717161
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.395864e-01
[S11] stored merged vector for next round verification (round=6)
[S11] DEBUG after merge:  round=6 metric=0.1404 head_norm=0.830445 delta_norm=0.239586
[S11] aggregate: ACCEPT kept=['S15', 'S6'] (k=2/2) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=6 metric=0.4158 head_norm=0.736833
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.489568e-01
[S13] stored merged vector for next round verification (round=6)
[S13] DEBUG after merge:  round=6 metric=0.4158 head_norm=0.637849 delta_norm=0.348957
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=6 metric=0.3513 head_norm=0.882640
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.787744e-01
[S17] stored merged vector for next round verification (round=6)
[S17] DEBUG after merge:  round=6 metric=0.3497 head_norm=0.819179 delta_norm=0.278774
[S17] aggregate: ACCEPT kept=['S9', 'S8', 'S16'] (k=3/3) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=6 metric=0.1398 head_norm=0.750938
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.293661e-01
[S3] stored merged vector for next round verification (round=6)
[S3] DEBUG after merge:  round=6 metric=0.1398 head_norm=0.762585 delta_norm=0.429366
[S3] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=7 head_norm_before_train=1.175974 cos_to_last_merge=0.9179 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.918
[S2] round=7 local utility u=0.000000 metrics={'f1_val': 0.4475262632393062, 'auprc': 0.6083293124543938, 'loss_val': 0.9330674733867788, 'psi': 0.5118474829253412}-{'f1_val': 0.7016407651533589, 'auprc': 0.7937912173529066, 'loss_val': 0.5289005718351243, 'psi': 0.738500946033178}
[S3] START round=7 head_norm_before_train=0.762585 cos_to_last_merge=1.0000 (last merge round=6)
[S3] round=7 local utility u=0.264929 metrics={'f1_val': 0.1949685534591195, 'auprc': 0.7956044250994387, 'loss_val': 1.1174446253776924, 'psi': 0.43522290211524717}-{'f1_val': 0.13984006561410703, 'auprc': 0.7558049223275698, 'loss_val': 1.1971324457012016, 'psi': 0.38622600829949216}
[S4] START round=7 head_norm_before_train=0.872451 cos_to_last_merge=0.9548 (last merge round=4)
[S4] round=7 local utility u=0.124472 metrics={'f1_val': 0.6564920045436193, 'auprc': 0.9321382605545881, 'loss_val': 0.6058326206834314, 'psi': 0.7667505069480068}-{'f1_val': 0.6564665596266077, 'auprc': 0.8932839466235384, 'loss_val': 0.7380602867323001, 'psi': 0.7511935144253801}
[S5] START round=7 head_norm_before_train=0.976544 cos_to_last_merge=0.9644 (last merge round=1)
[S5] round=7 local utility u=0.087950 metrics={'f1_val': 0.41795135763108626, 'auprc': 0.7744502746970024, 'loss_val': 1.0134074962295117, 'psi': 0.5605509244574527}-{'f1_val': 0.4091401106817494, 'auprc': 0.7701233325820123, 'loss_val': 1.1234587976773944, 'psi': 0.5535333994418545}
[S6] START round=7 head_norm_before_train=1.470497 (no previous merge yet)
[S6] round=7 local utility u=0.263078 metrics={'f1_val': 0.6918366574322778, 'auprc': 0.952173911524954, 'loss_val': 0.4094161856737273, 'psi': 0.7959715590693484}-{'f1_val': 0.7070412635198414, 'auprc': 0.7817034991908629, 'loss_val': 0.5153892265871093, 'psi': 0.7369061577882501}
[S7] START round=7 head_norm_before_train=1.018573 cos_to_last_merge=0.9651 (last merge round=1)
[S7] round=7 local utility u=0.482989 metrics={'f1_val': 0.2918145207022179, 'auprc': 0.7771249499266667, 'loss_val': 1.1210606932938831, 'psi': 0.4859386923919975}-{'f1_val': 0.14205682272909165, 'auprc': 0.7777996823937428, 'loss_val': 1.1905170675573629, 'psi': 0.3963539665949521}
[S8] START round=7 head_norm_before_train=1.578379 (no previous merge yet)
[S8] round=7 local utility u=0.891103 metrics={'f1_val': 0.9956712880364682, 'auprc': 0.9974934487781879, 'loss_val': 0.1547934935192846, 'psi': 0.996400152333156}-{'f1_val': 0.7149513830905807, 'auprc': 0.9960019274410725, 'loss_val': 0.24820539901634067, 'psi': 0.8273716008307774}
[S9] START round=7 head_norm_before_train=1.277423 (no previous merge yet)
[S9] round=7 local utility u=0.933485 metrics={'f1_val': 0.7016893154854569, 'auprc': 0.9997944595794152, 'loss_val': 0.5457452638572847, 'psi': 0.8209313731230402}-{'f1_val': 0.49411210305488806, 'auprc': 0.8662090793126151, 'loss_val': 0.7664965493822248, 'psi': 0.6429508935579789}
[S10] START round=7 head_norm_before_train=0.800682 cos_to_last_merge=1.0000 (last merge round=6)
[S10] round=7 local utility u=0.000000 metrics={'f1_val': 0.6890692334955134, 'auprc': 0.9847939439265927, 'loss_val': 0.4436578018501306, 'psi': 0.8073591176679451}-{'f1_val': 0.6998932897468348, 'auprc': 0.99530823893714, 'loss_val': 0.44079874319259643, 'psi': 0.8180592694229569}
[S11] START round=7 head_norm_before_train=0.830445 cos_to_last_merge=1.0000 (last merge round=6)
[S11] round=7 local utility u=1.000000 metrics={'f1_val': 0.4204555390001421, 'auprc': 0.9341528626712653, 'loss_val': 1.085447497143633, 'psi': 0.6259344684685914}-{'f1_val': 0.14041368337311058, 'auprc': 0.8263407573585986, 'loss_val': 1.1849900158398021, 'psi': 0.4147845129673058}
[S13] START round=7 head_norm_before_train=0.637849 cos_to_last_merge=1.0000 (last merge round=6)
[S13] round=7 local utility u=0.000000 metrics={'f1_val': 0.37327035496065397, 'auprc': 0.48742584381610954, 'loss_val': 0.914465933987056, 'psi': 0.4189325505028362}-{'f1_val': 0.41580726865236384, 'auprc': 0.4687501364297036, 'loss_val': 0.9298088683360543, 'psi': 0.4369844157632997}
[S14] START round=7 head_norm_before_train=0.888551 cos_to_last_merge=0.9620 (last merge round=2)
[S14] round=7 local utility u=0.611523 metrics={'f1_val': 0.2853511798032541, 'auprc': 0.9203741450747742, 'loss_val': 1.0538124172267866, 'psi': 0.5393603659118622}-{'f1_val': 0.14035785288270378, 'auprc': 0.8423426380674399, 'loss_val': 1.1728047703180569, 'psi': 0.42115176695659823}
[S15] START round=7 head_norm_before_train=1.237952 cos_to_last_merge=0.9261 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.926
[S15] round=7 local utility u=0.974271 metrics={'f1_val': 0.8854839422265419, 'auprc': 0.9904998353246981, 'loss_val': 0.25930881673731315, 'psi': 0.9274902994658043}-{'f1_val': 0.6986457399140302, 'auprc': 0.7993636026109985, 'loss_val': 0.5134138320700097, 'psi': 0.7389328849928175}
[S16] START round=7 head_norm_before_train=1.318284 (no previous merge yet)
[S16] round=7 local utility u=0.014911 metrics={'f1_val': 0.4171583814486223, 'auprc': 0.6448471801948401, 'loss_val': 0.8908232942329722, 'psi': 0.5082339009471094}-{'f1_val': 0.417193595187378, 'auprc': 0.644494698778762, 'loss_val': 0.9197994872147375, 'psi': 0.5081140366239316}
[S17] START round=7 head_norm_before_train=0.819179 cos_to_last_merge=1.0000 (last merge round=6)
[S17] round=7 local utility u=0.368823 metrics={'f1_val': 0.437439894798601, 'auprc': 0.7046328660561647, 'loss_val': 0.9245654605444644, 'psi': 0.5443170833016264}-{'f1_val': 0.35134329211318677, 'auprc': 0.6348483367660009, 'loss_val': 0.9362778669333239, 'psi': 0.46474530997431246}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:33217
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:33212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S5] → sending delta(kind=head bytes=1786) to S16@127.0.0.1:33216
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:33215
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:33212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:33214
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S11] → sending delta(kind=head bytes=1787) to S13@127.0.0.1:33213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:33210
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:33217
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S4] → sending delta(kind=head bytes=1786) to S10@127.0.0.1:33211
[S7] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1787 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1786 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1786 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1796) from S9
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.335413)
[S17] loaded HEAD from S9 (vec_in norm=1.335413)
[S17] cosine check vs S9: cos=0.5080
[S17] BUFFERED delta from S9 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1799) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.642135)
[S17] loaded HEAD from S8 (vec_in norm=1.642135)
[S17] cosine check vs S8: cos=0.6852
[S17] BUFFERED delta from S8 (total buffered=2)
[S9] RECEIVED delta(kind=head bytes=1795) from S3
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=0.785414)
[S9] loaded HEAD from S3 (vec_in norm=0.785414)
[S9] cosine check vs S3: cos=-0.0864
[S9] DROPPED delta from S3 (cos=-0.0864 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1787) from S11
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=0.850509)
[S13] loaded HEAD from S11 (vec_in norm=0.850509)
[S13] cosine check vs S11: cos=0.7050
[S13] BUFFERED delta from S11 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1802) from S15
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.331061)
[S11] loaded HEAD from S15 (vec_in norm=1.331061)
[S11] cosine check vs S15: cos=0.7022
[S11] BUFFERED delta from S15 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1801) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.512985)
[S11] loaded HEAD from S6 (vec_in norm=1.512985)
[S11] cosine check vs S6: cos=0.6888
[S11] BUFFERED delta from S6 (total buffered=2)
[S14] RECEIVED delta(kind=head bytes=1800) from S7
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.045233)
[S14] loaded HEAD from S7 (vec_in norm=1.045233)
[S14] cosine check vs S7: cos=-0.0065
[S14] DROPPED delta from S7 (cos=-0.0065 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1786) from S4
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.989221)
[S10] loaded HEAD from S4 (vec_in norm=0.989221)
[S10] cosine check vs S4: cos=0.7449
[S10] BUFFERED delta from S4 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1786) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.005730)
[S16] loaded HEAD from S5 (vec_in norm=1.005730)
[S16] cosine check vs S5: cos=-0.1374
[S16] DROPPED delta from S5 (cos=-0.1374 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1796) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.933295)
[S15] loaded HEAD from S14 (vec_in norm=0.933295)
[S15] cosine check vs S14: cos=-0.0174
[S15] DROPPED delta from S14 (cos=-0.0174 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:33203
[S17] sending update (kind=head size=1796 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1796) from S17
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=0.889296)
[S3] loaded HEAD from S17 (vec_in norm=0.889296)
[S3] cosine check vs S17: cos=0.2980
[S3] BUFFERED delta from S17 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] → sending delta(kind=head bytes=1793) to S17@127.0.0.1:33217
[S16] sending update (kind=head size=1793 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1793) from S16
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.351260)
[S17] loaded HEAD from S16 (vec_in norm=1.351260)
[S17] cosine check vs S16: cos=0.4133
[S17] BUFFERED delta from S16 (total buffered=3)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=7 metric=0.6891 head_norm=0.910183
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.412051e-01
[S10] stored merged vector for next round verification (round=7)
[S10] DEBUG after merge:  round=7 metric=0.6888 head_norm=0.887173 delta_norm=0.341205
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=7 metric=0.4205 head_norm=0.850509
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.609436e-01
[S11] stored merged vector for next round verification (round=7)
[S11] DEBUG after merge:  round=7 metric=0.3967 head_norm=0.930894 delta_norm=0.160944
[S11] aggregate: ROLLBACK (f1_val pre=0.420 post=0.397 tol_abs=0.005 tol_rel=0.0)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=7 metric=0.1950 head_norm=0.785414
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.978400e-01
[S3] stored merged vector for next round verification (round=7)
[S3] DEBUG after merge:  round=7 metric=0.1954 head_norm=0.675290 delta_norm=0.497840
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=7 metric=0.3733 head_norm=0.716608
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.072068e-01
[S13] stored merged vector for next round verification (round=7)
[S13] DEBUG after merge:  round=7 metric=0.3734 head_norm=0.723927 delta_norm=0.307207
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=7 metric=0.4374 head_norm=0.889296
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.270777e-01
[S17] stored merged vector for next round verification (round=7)
[S17] DEBUG after merge:  round=7 metric=0.3530 head_norm=0.856324 delta_norm=0.227078
[S17] aggregate: ROLLBACK (f1_val pre=0.437 post=0.353 tol_abs=0.005 tol_rel=0.0)
[S2] START round=8 head_norm_before_train=1.266817 cos_to_last_merge=0.8944 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.894
[S2] round=8 local utility u=1.000000 metrics={'f1_val': 0.7015262127820588, 'auprc': 0.7077332029529293, 'loss_val': 0.4279680890189782, 'psi': 0.704009008850407}-{'f1_val': 0.4475262632393062, 'auprc': 0.6083293124543938, 'loss_val': 0.9330674733867788, 'psi': 0.5118474829253412}
[S3] START round=8 head_norm_before_train=0.675290 cos_to_last_merge=1.0000 (last merge round=7)
[S3] round=8 local utility u=0.634827 metrics={'f1_val': 0.396483704974271, 'auprc': 0.8006201431155265, 'loss_val': 1.0719282094653484, 'psi': 0.5581382802307733}-{'f1_val': 0.1949685534591195, 'auprc': 0.7956044250994387, 'loss_val': 1.1174446253776924, 'psi': 0.43522290211524717}
[S4] START round=8 head_norm_before_train=0.989221 cos_to_last_merge=0.9311 (last merge round=4)
[S4] ⚠️ Model drifted since last merge! cos=0.931
[S4] round=8 local utility u=0.982823 metrics={'f1_val': 0.9525472360970996, 'auprc': 0.9447319427239316, 'loss_val': 0.4542995685805405, 'psi': 0.9494211187478323}-{'f1_val': 0.6564920045436193, 'auprc': 0.9321382605545881, 'loss_val': 0.6058326206834314, 'psi': 0.7667505069480068}
[S5] START round=8 head_norm_before_train=1.005730 cos_to_last_merge=0.9527 (last merge round=1)
[S5] round=8 local utility u=0.069487 metrics={'f1_val': 0.41823357465624633, 'auprc': 0.7774384838743134, 'loss_val': 0.8850921715060858, 'psi': 0.5619155383434731}-{'f1_val': 0.41795135763108626, 'auprc': 0.7744502746970024, 'loss_val': 1.0134074962295117, 'psi': 0.5605509244574527}
[S6] START round=8 head_norm_before_train=1.512985 (no previous merge yet)
[S6] round=8 local utility u=0.000000 metrics={'f1_val': 0.7029857100189055, 'auprc': 0.7787273031989157, 'loss_val': 0.49175620956961585, 'psi': 0.7332823472909096}-{'f1_val': 0.6918366574322778, 'auprc': 0.952173911524954, 'loss_val': 0.4094161856737273, 'psi': 0.7959715590693484}
[S7] START round=8 head_norm_before_train=1.045233 cos_to_last_merge=0.9563 (last merge round=1)
[S7] round=8 local utility u=0.108928 metrics={'f1_val': 0.41736073619820624, 'auprc': 0.5756000579667201, 'loss_val': 1.05190818282754, 'psi': 0.48065646490561176}-{'f1_val': 0.2918145207022179, 'auprc': 0.7771249499266667, 'loss_val': 1.1210606932938831, 'psi': 0.4859386923919975}
[S8] START round=8 head_norm_before_train=1.642135 (no previous merge yet)
[S8] round=8 local utility u=0.025917 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9991711997400052, 'loss_val': 0.11208410500143681, 'psi': 0.9974803248573769}-{'f1_val': 0.9956712880364682, 'auprc': 0.9974934487781879, 'loss_val': 0.1547934935192846, 'psi': 0.996400152333156}
[S9] START round=8 head_norm_before_train=1.335413 (no previous merge yet)
[S9] round=8 local utility u=0.082533 metrics={'f1_val': 0.7015406642019387, 'auprc': 0.9988681206812785, 'loss_val': 0.3770078650810185, 'psi': 0.8204716467936746}-{'f1_val': 0.7016893154854569, 'auprc': 0.9997944595794152, 'loss_val': 0.5457452638572847, 'psi': 0.8209313731230402}
[S10] START round=8 head_norm_before_train=0.887173 cos_to_last_merge=1.0000 (last merge round=7)
[S10] round=8 local utility u=0.028736 metrics={'f1_val': 0.6926391573371826, 'auprc': 0.9866679100230051, 'loss_val': 0.4132274575672, 'psi': 0.8102506584115117}-{'f1_val': 0.6890692334955134, 'auprc': 0.9847939439265927, 'loss_val': 0.4436578018501306, 'psi': 0.8073591176679451}
[S11] START round=8 head_norm_before_train=0.930894 cos_to_last_merge=1.0000 (last merge round=7)
[S11] round=8 local utility u=0.000000 metrics={'f1_val': 0.39651855440916606, 'auprc': 0.9247807960926886, 'loss_val': 0.9655674238787882, 'psi': 0.6078234510825751}-{'f1_val': 0.4204555390001421, 'auprc': 0.9341528626712653, 'loss_val': 1.085447497143633, 'psi': 0.6259344684685914}
[S13] START round=8 head_norm_before_train=0.723927 cos_to_last_merge=1.0000 (last merge round=7)
[S13] round=8 local utility u=0.625558 metrics={'f1_val': 0.571690165521798, 'auprc': 0.5023283880767246, 'loss_val': 0.8985766618029352, 'psi': 0.5439454545437686}-{'f1_val': 0.37327035496065397, 'auprc': 0.48742584381610954, 'loss_val': 0.914465933987056, 'psi': 0.4189325505028362}
[S14] START round=8 head_norm_before_train=0.933295 cos_to_last_merge=0.9486 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.949
[S14] round=8 local utility u=0.666303 metrics={'f1_val': 0.43624683106234663, 'auprc': 0.9951160190806121, 'loss_val': 0.8508066031599902, 'psi': 0.6597945062696529}-{'f1_val': 0.2853511798032541, 'auprc': 0.9203741450747742, 'loss_val': 1.0538124172267866, 'psi': 0.5393603659118622}
[S15] START round=8 head_norm_before_train=1.331061 cos_to_last_merge=0.9035 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.903
[S15] round=8 local utility u=0.386648 metrics={'f1_val': 0.9958002360096897, 'auprc': 0.9969011514821727, 'loss_val': 0.16711451543111602, 'psi': 0.9962406021986829}-{'f1_val': 0.8854839422265419, 'auprc': 0.9904998353246981, 'loss_val': 0.25930881673731315, 'psi': 0.9274902994658043}
[S16] START round=8 head_norm_before_train=1.351260 (no previous merge yet)
[S16] round=8 local utility u=0.009223 metrics={'f1_val': 0.41700358386742975, 'auprc': 0.6463143155138555, 'loss_val': 0.875850402232675, 'psi': 0.508727876526}-{'f1_val': 0.4171583814486223, 'auprc': 0.6448471801948401, 'loss_val': 0.8908232942329722, 'psi': 0.5082339009471094}
[S17] START round=8 head_norm_before_train=0.856324 cos_to_last_merge=1.0000 (last merge round=7)
[S17] round=8 local utility u=0.000000 metrics={'f1_val': 0.3842239759222157, 'auprc': 0.7088501263840676, 'loss_val': 0.7814878862814765, 'psi': 0.5140744361069565}-{'f1_val': 0.437439894798601, 'auprc': 0.7046328660561647, 'loss_val': 0.9245654605444644, 'psi': 0.5443170833016264}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] → sending delta(kind=head bytes=1794) to S4@127.0.0.1:33204
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:33212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:33210
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:33203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] → sending delta(kind=head bytes=1794) to S15@127.0.0.1:33215
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:33217
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:33216
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S4] → sending delta(kind=head bytes=1790) to S10@127.0.0.1:33211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] → sending delta(kind=head bytes=1794) to S17@127.0.0.1:33217
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S2] → sending delta(kind=head bytes=1791) to S13@127.0.0.1:33213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:33214
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:33217
[S8] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1794 to 1 peers)
[S4] sending update (kind=head size=1790 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1794 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1795 to 1 peers)
[S2] sending update (kind=head size=1791 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1794 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1790) from S4
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.089413)
[S10] loaded HEAD from S4 (vec_in norm=1.089413)
[S10] cosine check vs S4: cos=0.8629
[S10] BUFFERED delta from S4 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1796) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.036794)
[S16] loaded HEAD from S5 (vec_in norm=1.036794)
[S16] cosine check vs S5: cos=-0.1429
[S16] DROPPED delta from S5 (cos=-0.1429 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1798) from S3
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=0.703983)
[S9] loaded HEAD from S3 (vec_in norm=0.703983)
[S9] cosine check vs S3: cos=0.2509
[S9] BUFFERED delta from S3 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1794) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.987853)
[S15] loaded HEAD from S14 (vec_in norm=0.987853)
[S15] cosine check vs S14: cos=-0.0145
[S15] DROPPED delta from S14 (cos=-0.0145 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1796) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.687311)
[S17] loaded HEAD from S8 (vec_in norm=1.687311)
[S17] cosine check vs S8: cos=0.6537
[S17] BUFFERED delta from S8 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1794) from S16
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.377857)
[S17] loaded HEAD from S16 (vec_in norm=1.377857)
[S17] cosine check vs S16: cos=0.4931
[S17] BUFFERED delta from S16 (total buffered=2)
[S17] RECEIVED delta(kind=head bytes=1798) from S9
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.398848)
[S17] loaded HEAD from S9 (vec_in norm=1.398848)
[S17] cosine check vs S9: cos=0.5387
[S17] BUFFERED delta from S9 (total buffered=3)
[S4] RECEIVED delta(kind=head bytes=1794) from S13
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=0.792571)
[S4] loaded HEAD from S13 (vec_in norm=0.792571)
[S4] cosine check vs S13: cos=0.2510
[S4] BUFFERED delta from S13 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1791) from S2
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.333845)
[S13] loaded HEAD from S2 (vec_in norm=1.333845)
[S13] cosine check vs S2: cos=-0.0057
[S13] DROPPED delta from S2 (cos=-0.0057 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1803) from S10
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=0.979207)
[S3] loaded HEAD from S10 (vec_in norm=0.979207)
[S3] cosine check vs S10: cos=0.5121
[S3] BUFFERED delta from S10 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1802) from S15
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.397898)
[S11] loaded HEAD from S15 (vec_in norm=1.397898)
[S11] cosine check vs S15: cos=0.6762
[S11] BUFFERED delta from S15 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1795) from S7
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.067293)
[S14] loaded HEAD from S7 (vec_in norm=1.067293)
[S14] cosine check vs S7: cos=-0.0035
[S14] DROPPED delta from S7 (cos=-0.0035 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=8 metric=0.3965 head_norm=0.955516
[S11] _apply_head_vector_avg (torch): Δ‖w‖=5.149235e-01
[S11] stored merged vector for next round verification (round=8)
[S11] DEBUG after merge:  round=8 metric=0.4189 head_norm=1.080934 delta_norm=0.514924
[S11] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=8 metric=0.9525 head_norm=1.089413
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.876852e-01
[S4] stored merged vector for next round verification (round=8)
[S4] DEBUG after merge:  round=8 metric=0.6638 head_norm=0.749747 delta_norm=0.587685
[S4] aggregate: ROLLBACK (f1_val pre=0.953 post=0.664 tol_abs=0.005 tol_rel=0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=8 metric=0.6926 head_norm=0.979207
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.759286e-01
[S10] stored merged vector for next round verification (round=8)
[S10] DEBUG after merge:  round=8 metric=0.9445 head_norm=0.998347 delta_norm=0.275929
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=8 metric=0.7015 head_norm=1.398848
[S9] _apply_head_vector_avg (torch): Δ‖w‖=6.996815e-01
[S9] stored merged vector for next round verification (round=8)
[S9] DEBUG after merge:  round=8 metric=0.7016 head_norm=0.858271 delta_norm=0.699682
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=8 metric=0.3965 head_norm=0.703983
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.325595e-01
[S3] stored merged vector for next round verification (round=8)
[S3] DEBUG after merge:  round=8 metric=0.1950 head_norm=0.734923 delta_norm=0.432559
[S3] aggregate: ROLLBACK (f1_val pre=0.396 post=0.195 tol_abs=0.005 tol_rel=0.0)
[S17] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=8 metric=0.3842 head_norm=0.923493
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.981199e-01
[S17] stored merged vector for next round verification (round=8)
[S17] DEBUG after merge:  round=8 metric=0.3827 head_norm=0.896976 delta_norm=0.198120
[S17] aggregate: ACCEPT kept=['S8', 'S16', 'S9'] (k=3/3) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=1.333845 cos_to_last_merge=0.8779 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.878
[S2] round=9 local utility u=0.000000 metrics={'f1_val': 0.7039857743573343, 'auprc': 0.7011014872856909, 'loss_val': 0.4791869059801164, 'psi': 0.702832059528677}-{'f1_val': 0.7015262127820588, 'auprc': 0.7077332029529293, 'loss_val': 0.4279680890189782, 'psi': 0.704009008850407}
[S3] START round=9 head_norm_before_train=0.734923 cos_to_last_merge=1.0000 (last merge round=8)
[S3] round=9 local utility u=0.000000 metrics={'f1_val': 0.396483704974271, 'auprc': 0.6864537566831879, 'loss_val': 0.9902891579737069, 'psi': 0.5124717256578377}-{'f1_val': 0.396483704974271, 'auprc': 0.8006201431155265, 'loss_val': 1.0719282094653484, 'psi': 0.5581382802307733}
[S4] START round=9 head_norm_before_train=0.749747 cos_to_last_merge=1.0000 (last merge round=8)
[S4] round=9 local utility u=0.028645 metrics={'f1_val': 0.9543552733061442, 'auprc': 0.956181799031084, 'loss_val': 0.44220819886971063, 'psi': 0.9550858835961202}-{'f1_val': 0.9525472360970996, 'auprc': 0.9447319427239316, 'loss_val': 0.4542995685805405, 'psi': 0.9494211187478323}
[S5] START round=9 head_norm_before_train=1.036794 cos_to_last_merge=0.9394 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.939
[S5] round=9 local utility u=0.033598 metrics={'f1_val': 0.41758608903622574, 'auprc': 0.7638130297371133, 'loss_val': 0.7731353015591437, 'psi': 0.5560768653165807}-{'f1_val': 0.41823357465624633, 'auprc': 0.7774384838743134, 'loss_val': 0.8850921715060858, 'psi': 0.5619155383434731}
[S6] START round=9 head_norm_before_train=1.546849 (no previous merge yet)
[S6] round=9 local utility u=0.449972 metrics={'f1_val': 0.7608461592513939, 'auprc': 0.9233539043436633, 'loss_val': 0.37285538463112994, 'psi': 0.8258492572883016}-{'f1_val': 0.7029857100189055, 'auprc': 0.7787273031989157, 'loss_val': 0.49175620956961585, 'psi': 0.7332823472909096}
[S7] START round=9 head_norm_before_train=1.067293 cos_to_last_merge=0.9475 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.947
[S7] round=9 local utility u=0.293235 metrics={'f1_val': 0.4820302629850088, 'auprc': 0.5999521025304513, 'loss_val': 0.9265107029790103, 'psi': 0.5291989988031858}-{'f1_val': 0.41736073619820624, 'auprc': 0.5756000579667201, 'loss_val': 1.05190818282754, 'psi': 0.48065646490561176}
[S8] START round=9 head_norm_before_train=1.687311 (no previous merge yet)
[S8] round=9 local utility u=0.010442 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9991516961962057, 'loss_val': 0.09114258684205047, 'psi': 0.997472523439857}-{'f1_val': 0.9963530749356245, 'auprc': 0.9991711997400052, 'loss_val': 0.11208410500143681, 'psi': 0.9974803248573769}
[S9] START round=9 head_norm_before_train=0.858271 cos_to_last_merge=1.0000 (last merge round=8)
[S9] round=9 local utility u=0.000000 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9983256300903843, 'loss_val': 0.44204329723818747, 'psi': 0.8201045421606918}-{'f1_val': 0.7015406642019387, 'auprc': 0.9988681206812785, 'loss_val': 0.3770078650810185, 'psi': 0.8204716467936746}
[S10] START round=9 head_norm_before_train=0.998347 cos_to_last_merge=1.0000 (last merge round=8)
[S10] round=9 local utility u=0.505167 metrics={'f1_val': 0.8543350967053147, 'auprc': 0.9961133846215517, 'loss_val': 0.40140563481751657, 'psi': 0.9110464118718096}-{'f1_val': 0.6926391573371826, 'auprc': 0.9866679100230051, 'loss_val': 0.4132274575672, 'psi': 0.8102506584115117}
[S11] START round=9 head_norm_before_train=1.080934 cos_to_last_merge=1.0000 (last merge round=8)
[S11] round=9 local utility u=0.249227 metrics={'f1_val': 0.46191330290387655, 'auprc': 0.9304184345888236, 'loss_val': 0.8763954929331419, 'psi': 0.6493153555778554}-{'f1_val': 0.39651855440916606, 'auprc': 0.9247807960926886, 'loss_val': 0.9655674238787882, 'psi': 0.6078234510825751}
[S13] START round=9 head_norm_before_train=0.792571 cos_to_last_merge=0.9837 (last merge round=7)
[S13] round=9 local utility u=0.000000 metrics={'f1_val': 0.5582303093810032, 'auprc': 0.49889863448798627, 'loss_val': 0.8471889296099918, 'psi': 0.5344976394237964}-{'f1_val': 0.571690165521798, 'auprc': 0.5023283880767246, 'loss_val': 0.8985766618029352, 'psi': 0.5439454545437686}
[S14] START round=9 head_norm_before_train=0.987853 cos_to_last_merge=0.9331 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.933
[S14] round=9 local utility u=1.000000 metrics={'f1_val': 0.9310009265213104, 'auprc': 0.9939093232760127, 'loss_val': 0.6194797197351061, 'psi': 0.9561642852231913}-{'f1_val': 0.43624683106234663, 'auprc': 0.9951160190806121, 'loss_val': 0.8508066031599902, 'psi': 0.6597945062696529}
[S15] START round=9 head_norm_before_train=1.397898 cos_to_last_merge=0.8900 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.890
[S15] round=9 local utility u=0.000000 metrics={'f1_val': 0.991021582113119, 'auprc': 0.9897268687549539, 'loss_val': 0.16108252127042025, 'psi': 0.9905036967698528}-{'f1_val': 0.9958002360096897, 'auprc': 0.9969011514821727, 'loss_val': 0.16711451543111602, 'psi': 0.9962406021986829}
[S16] START round=9 head_norm_before_train=1.377857 (no previous merge yet)
[S16] round=9 local utility u=0.099610 metrics={'f1_val': 0.4308011943302592, 'auprc': 0.6728563147509711, 'loss_val': 0.8390418136881204, 'psi': 0.527623242498544}-{'f1_val': 0.41700358386742975, 'auprc': 0.6463143155138555, 'loss_val': 0.875850402232675, 'psi': 0.508727876526}
[S17] START round=9 head_norm_before_train=0.896976 cos_to_last_merge=1.0000 (last merge round=8)
[S17] round=9 local utility u=0.026519 metrics={'f1_val': 0.3866448536479984, 'auprc': 0.7128181370488649, 'loss_val': 0.7548790719167531, 'psi': 0.517114167008345}-{'f1_val': 0.3842239759222157, 'auprc': 0.7088501263840676, 'loss_val': 0.7814878862814765, 'psi': 0.5140744361069565}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S4] → sending delta(kind=head bytes=1792) to S10@127.0.0.1:33211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] → sending delta(kind=head bytes=1805) to S11@127.0.0.1:33212
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:33216
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S3@127.0.0.1:33203
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:33217
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:33213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:33215
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:33214
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:33217
[S7] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1804 to 1 peers)
[S5] sending update (kind=head size=1793 to 1 peers)
[S6] sending update (kind=head size=1805 to 1 peers)
[S4] sending update (kind=head size=1792 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1797) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.733991)
[S17] loaded HEAD from S8 (vec_in norm=1.733991)
[S17] cosine check vs S8: cos=0.6357
[S17] BUFFERED delta from S8 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1797) from S16
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.407781)
[S17] loaded HEAD from S16 (vec_in norm=1.407781)
[S17] cosine check vs S16: cos=0.5344
[S17] BUFFERED delta from S16 (total buffered=2)
[S13] RECEIVED delta(kind=head bytes=1795) from S11
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.106639)
[S13] loaded HEAD from S11 (vec_in norm=1.106639)
[S13] cosine check vs S11: cos=0.7394
[S13] BUFFERED delta from S11 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1804) from S10
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.071415)
[S3] loaded HEAD from S10 (vec_in norm=1.071415)
[S3] cosine check vs S10: cos=0.8577
[S3] BUFFERED delta from S10 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1805) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.571286)
[S11] loaded HEAD from S6 (vec_in norm=1.571286)
[S11] cosine check vs S6: cos=0.3428
[S11] BUFFERED delta from S6 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1792) from S4
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.855177)
[S10] loaded HEAD from S4 (vec_in norm=0.855177)
[S10] cosine check vs S4: cos=0.8533
[S10] BUFFERED delta from S4 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1795) from S7
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.098701)
[S14] loaded HEAD from S7 (vec_in norm=1.098701)
[S14] cosine check vs S7: cos=-0.0009
[S14] DROPPED delta from S7 (cos=-0.0009 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1793) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.067755)
[S16] loaded HEAD from S5 (vec_in norm=1.067755)
[S16] cosine check vs S5: cos=-0.1448
[S16] DROPPED delta from S5 (cos=-0.1448 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1797) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.050713)
[S15] loaded HEAD from S14 (vec_in norm=1.050713)
[S15] cosine check vs S14: cos=-0.0146
[S15] DROPPED delta from S14 (cos=-0.0146 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:33203
[S17] sending update (kind=head size=1798 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1798) from S17
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=0.967137)
[S3] loaded HEAD from S17 (vec_in norm=0.967137)
[S3] cosine check vs S17: cos=0.3983
[S3] BUFFERED delta from S17 (total buffered=2)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=9 metric=0.5582 head_norm=0.877020
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.736808e-01
[S13] stored merged vector for next round verification (round=9)
[S13] DEBUG after merge:  round=9 metric=0.5541 head_norm=0.925889 delta_norm=0.373681
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=9 metric=0.3965 head_norm=0.769875
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.980316e-01
[S3] stored merged vector for next round verification (round=9)
[S3] DEBUG after merge:  round=9 metric=0.3965 head_norm=0.735677 delta_norm=0.198032
[S3] aggregate: ACCEPT kept=['S10', 'S17'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=9 metric=0.4619 head_norm=1.106639
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.908076e-01
[S11] stored merged vector for next round verification (round=9)
[S11] DEBUG after merge:  round=9 metric=0.6244 head_norm=1.105178 delta_norm=0.790808
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=9 metric=0.8543 head_norm=1.071415
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.808939e-01
[S10] stored merged vector for next round verification (round=9)
[S10] DEBUG after merge:  round=9 metric=0.7828 head_norm=0.927754 delta_norm=0.280894
[S10] aggregate: ROLLBACK (f1_val pre=0.854 post=0.783 tol_abs=0.005 tol_rel=0.0)
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=9 metric=0.3866 head_norm=0.967137
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.547072e-01
[S17] stored merged vector for next round verification (round=9)
[S17] DEBUG after merge:  round=9 metric=0.3856 head_norm=1.011276 delta_norm=0.354707
[S17] aggregate: ACCEPT kept=['S8', 'S16'] (k=2/2) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=1.387106 cos_to_last_merge=0.8662 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.866
[S2] round=10 local utility u=0.000000 metrics={'f1_val': 0.7012976160311829, 'auprc': 0.6673175602351188, 'loss_val': 0.4045770437540137, 'psi': 0.6877055937127572}-{'f1_val': 0.7039857743573343, 'auprc': 0.7011014872856909, 'loss_val': 0.4791869059801164, 'psi': 0.702832059528677}
[S3] START round=10 head_norm_before_train=0.735677 cos_to_last_merge=1.0000 (last merge round=9)
[S3] round=10 local utility u=0.188308 metrics={'f1_val': 0.397126933948974, 'auprc': 0.7975783942885469, 'loss_val': 0.950906686012624, 'psi': 0.5573075180848032}-{'f1_val': 0.396483704974271, 'auprc': 0.6864537566831879, 'loss_val': 0.9902891579737069, 'psi': 0.5124717256578377}
[S4] START round=10 head_norm_before_train=0.855177 cos_to_last_merge=0.9903 (last merge round=8)
[S4] round=10 local utility u=0.051250 metrics={'f1_val': 0.9528048536743662, 'auprc': 0.9629818071198216, 'loss_val': 0.35080636593692105, 'psi': 0.9568756350525482}-{'f1_val': 0.9543552733061442, 'auprc': 0.956181799031084, 'loss_val': 0.44220819886971063, 'psi': 0.9550858835961202}
[S5] START round=10 head_norm_before_train=1.067755 cos_to_last_merge=0.9256 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.926
[S5] round=10 local utility u=0.547150 metrics={'f1_val': 0.6298732544258827, 'auprc': 0.6719688682129462, 'loss_val': 0.6770266700584355, 'psi': 0.6467114999407082}-{'f1_val': 0.41758608903622574, 'auprc': 0.7638130297371133, 'loss_val': 0.7731353015591437, 'psi': 0.5560768653165807}
[S6] START round=10 head_norm_before_train=1.571286 (no previous merge yet)
[S6] round=10 local utility u=0.000000 metrics={'f1_val': 0.5210370912609206, 'auprc': 0.77859486752773, 'loss_val': 0.6389052124672855, 'psi': 0.6240602017676443}-{'f1_val': 0.7608461592513939, 'auprc': 0.9233539043436633, 'loss_val': 0.37285538463112994, 'psi': 0.8258492572883016}
[S7] START round=10 head_norm_before_train=1.098701 cos_to_last_merge=0.9342 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.934
[S7] round=10 local utility u=0.145011 metrics={'f1_val': 0.4169130971024577, 'auprc': 0.7933338486197793, 'loss_val': 0.825930897295684, 'psi': 0.5674813977093864}-{'f1_val': 0.4820302629850088, 'auprc': 0.5999521025304513, 'loss_val': 0.9265107029790103, 'psi': 0.5291989988031858}
[S8] START round=10 head_norm_before_train=1.733991 (no previous merge yet)
[S8] round=10 local utility u=0.011968 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.999132532076712, 'loss_val': 0.06714944184326498, 'psi': 0.9974648577920595}-{'f1_val': 0.9963530749356245, 'auprc': 0.9991516961962057, 'loss_val': 0.09114258684205047, 'psi': 0.997472523439857}
[S9] START round=10 head_norm_before_train=0.927027 cos_to_last_merge=0.9960 (last merge round=8)
[S9] round=10 local utility u=0.045733 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9983229343333386, 'loss_val': 0.3505688003027231, 'psi': 0.8201034638578735}-{'f1_val': 0.7012904835408967, 'auprc': 0.9983256300903843, 'loss_val': 0.44204329723818747, 'psi': 0.8201045421606918}
[S10] START round=10 head_norm_before_train=0.927754 cos_to_last_merge=1.0000 (last merge round=9)
[S10] round=10 local utility u=0.436771 metrics={'f1_val': 0.9926312138726139, 'auprc': 0.9962257641745813, 'loss_val': 0.3579783406079405, 'psi': 0.9940690339934009}-{'f1_val': 0.8543350967053147, 'auprc': 0.9961133846215517, 'loss_val': 0.40140563481751657, 'psi': 0.9110464118718096}
[S11] START round=10 head_norm_before_train=1.105178 cos_to_last_merge=1.0000 (last merge round=9)
[S11] round=10 local utility u=0.821808 metrics={'f1_val': 0.7018246587012323, 'auprc': 0.9400058832055534, 'loss_val': 0.7010106114960833, 'psi': 0.7970971485029608}-{'f1_val': 0.46191330290387655, 'auprc': 0.9304184345888236, 'loss_val': 0.8763954929331419, 'psi': 0.6493153555778554}
[S13] START round=10 head_norm_before_train=0.925889 cos_to_last_merge=1.0000 (last merge round=9)
[S13] round=10 local utility u=0.000000 metrics={'f1_val': 0.5362766807899984, 'auprc': 0.4994598944970554, 'loss_val': 0.9334360113346457, 'psi': 0.5215499662728211}-{'f1_val': 0.5582303093810032, 'auprc': 0.49889863448798627, 'loss_val': 0.8471889296099918, 'psi': 0.5344976394237964}
[S14] START round=10 head_norm_before_train=1.050713 cos_to_last_merge=0.9148 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.915
[S14] round=10 local utility u=0.279273 metrics={'f1_val': 0.9981093320151594, 'auprc': 0.9945664403436876, 'loss_val': 0.46555629778988356, 'psi': 0.9966921753465707}-{'f1_val': 0.9310009265213104, 'auprc': 0.9939093232760127, 'loss_val': 0.6194797197351061, 'psi': 0.9561642852231913}
[S15] START round=10 head_norm_before_train=1.452616 cos_to_last_merge=0.8812 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.881
[S15] round=10 local utility u=0.056478 metrics={'f1_val': 0.9946060968988898, 'auprc': 0.9982960217338186, 'loss_val': 0.09534124136722992, 'psi': 0.9960820668328614}-{'f1_val': 0.991021582113119, 'auprc': 0.9897268687549539, 'loss_val': 0.16108252127042025, 'psi': 0.9905036967698528}
[S16] START round=10 head_norm_before_train=1.407781 (no previous merge yet)
[S16] round=10 local utility u=0.000000 metrics={'f1_val': 0.39203646036433876, 'auprc': 0.6827846282065584, 'loss_val': 0.8186936343105446, 'psi': 0.5083357275012266}-{'f1_val': 0.4308011943302592, 'auprc': 0.6728563147509711, 'loss_val': 0.8390418136881204, 'psi': 0.527623242498544}
[S17] START round=10 head_norm_before_train=1.011276 cos_to_last_merge=1.0000 (last merge round=9)
[S17] round=10 local utility u=0.000000 metrics={'f1_val': 0.38110077086514377, 'auprc': 0.7178204405334795, 'loss_val': 0.7661358579101865, 'psi': 0.515788638732478}-{'f1_val': 0.3866448536479984, 'auprc': 0.7128181370488649, 'loss_val': 0.7548790719167531, 'psi': 0.517114167008345}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:33212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:33217
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:33216
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S9] → sending delta(kind=head bytes=1789) to S17@127.0.0.1:33217
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:33203
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:33210
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:33213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:33215
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S4] → sending delta(kind=head bytes=1791) to S10@127.0.0.1:33211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S7] → sending delta(kind=head bytes=1792) to S14@127.0.0.1:33214
[S3] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1792 to 1 peers)
[S4] sending update (kind=head size=1791 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1789 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1800) from S3
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=0.772627)
[S9] loaded HEAD from S3 (vec_in norm=0.772627)
[S9] cosine check vs S3: cos=0.3831
[S9] BUFFERED delta from S3 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1791) from S4
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.977882)
[S10] loaded HEAD from S4 (vec_in norm=0.977882)
[S10] cosine check vs S4: cos=0.9218
[S10] BUFFERED delta from S4 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1792) from S7
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.147551)
[S14] loaded HEAD from S7 (vec_in norm=1.147551)
[S14] cosine check vs S7: cos=0.0027
[S14] BUFFERED delta from S7 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1789) from S9
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.004717)
[S17] loaded HEAD from S9 (vec_in norm=1.004717)
[S17] cosine check vs S9: cos=0.5342
[S17] BUFFERED delta from S9 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1803) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.773427)
[S17] loaded HEAD from S8 (vec_in norm=1.773427)
[S17] cosine check vs S8: cos=0.7464
[S17] BUFFERED delta from S8 (total buffered=2)
[S15] RECEIVED delta(kind=head bytes=1797) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.119546)
[S15] loaded HEAD from S14 (vec_in norm=1.119546)
[S15] cosine check vs S14: cos=-0.0146
[S15] DROPPED delta from S14 (cos=-0.0146 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1803) from S11
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.139046)
[S13] loaded HEAD from S11 (vec_in norm=1.139046)
[S13] cosine check vs S11: cos=0.7542
[S13] BUFFERED delta from S11 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1797) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.097382)
[S16] loaded HEAD from S5 (vec_in norm=1.097382)
[S16] cosine check vs S5: cos=-0.1455
[S16] DROPPED delta from S5 (cos=-0.1455 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1801) from S15
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.496903)
[S11] loaded HEAD from S15 (vec_in norm=1.496903)
[S11] cosine check vs S15: cos=0.4832
[S11] BUFFERED delta from S15 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1801) from S10
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.006321)
[S3] loaded HEAD from S10 (vec_in norm=1.006321)
[S3] cosine check vs S10: cos=0.8090
[S3] BUFFERED delta from S10 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=10 metric=0.5363 head_norm=0.984420
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.791853e-01
[S13] stored merged vector for next round verification (round=10)
[S13] DEBUG after merge:  round=10 metric=0.5398 head_norm=0.994722 delta_norm=0.379185
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.242 → S4@127.0.0.1:33204
[S2] ⇄ pheromone p=0.358 → S13@127.0.0.1:33213
[S6] ⇄ pheromone p=0.314 → S11@127.0.0.1:33212
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=10 metric=0.7013 head_norm=1.004717
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.029067e-01
[S9] stored merged vector for next round verification (round=10)
[S9] DEBUG after merge:  round=10 metric=0.7013 head_norm=0.741815 delta_norm=0.502907
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.326 → S17@127.0.0.1:33217
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=10 metric=0.9926 head_norm=1.006321
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.966760e-01
[S10] stored merged vector for next round verification (round=10)
[S10] DEBUG after merge:  round=10 metric=0.9919 head_norm=0.972515 delta_norm=0.196676
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.415 → S3@127.0.0.1:33203
[S15] ⇄ pheromone p=0.393 → S11@127.0.0.1:33212
[S7] ⇄ pheromone p=0.266 → S14@127.0.0.1:33214
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=10 metric=0.7018 head_norm=1.139046
[S11] _apply_head_vector_avg (torch): Δ‖w‖=6.874575e-01
[S11] stored merged vector for next round verification (round=10)
[S11] DEBUG after merge:  round=10 metric=0.7021 head_norm=1.138628 delta_norm=0.687458
[S11] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.440 → S13@127.0.0.1:33213
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=10 metric=0.9981 head_norm=1.119546
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.005106e-01
[S14] stored merged vector for next round verification (round=10)
[S14] DEBUG after merge:  round=10 metric=0.9977 head_norm=0.802690 delta_norm=0.800511
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.537 → S15@127.0.0.1:33215
[S4] ⇄ pheromone p=0.404 → S10@127.0.0.1:33211
[S5] ⇄ pheromone p=0.330 → S16@127.0.0.1:33216
[S8] ⇄ pheromone p=0.323 → S17@127.0.0.1:33217
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=10 metric=0.3971 head_norm=0.772627
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.964808e-01
[S3] stored merged vector for next round verification (round=10)
[S3] DEBUG after merge:  round=10 metric=0.3971 head_norm=0.846709 delta_norm=0.296481
[S3] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.262 → S9@127.0.0.1:33210
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=10 metric=0.3811 head_norm=1.066644
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.303277e-01
[S17] stored merged vector for next round verification (round=10)
[S17] DEBUG after merge:  round=10 metric=0.3806 head_norm=1.049432 delta_norm=0.330328
[S17] aggregate: ACCEPT kept=['S9', 'S8'] (k=2/2) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.193 → S3@127.0.0.1:33203
[S16] ⇄ pheromone p=0.207 → S17@127.0.0.1:33217
[S2] START round=11 head_norm_before_train=1.426798 cos_to_last_merge=0.8591 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.859
[S2] round=11 local utility u=0.033849 metrics={'f1_val': 0.700869554091637, 'auprc': 0.6653697901067894, 'loss_val': 0.3284670483292004, 'psi': 0.686669648497698}-{'f1_val': 0.7012976160311829, 'auprc': 0.6673175602351188, 'loss_val': 0.4045770437540137, 'psi': 0.6877055937127572}
[S3] START round=11 head_norm_before_train=0.846709 cos_to_last_merge=1.0000 (last merge round=10)
[S3] round=11 local utility u=0.378190 metrics={'f1_val': 0.48123546492238317, 'auprc': 0.8645032213963377, 'loss_val': 0.8999522164525704, 'psi': 0.6345425675119649}-{'f1_val': 0.397126933948974, 'auprc': 0.7975783942885469, 'loss_val': 0.950906686012624, 'psi': 0.5573075180848032}
[S4] START round=11 head_norm_before_train=0.977882 cos_to_last_merge=0.9705 (last merge round=8)
[S4] round=11 local utility u=0.000000 metrics={'f1_val': 0.9463677502228935, 'auprc': 0.9551697469001186, 'loss_val': 0.31941692227341156, 'psi': 0.9498885488937835}-{'f1_val': 0.9528048536743662, 'auprc': 0.9629818071198216, 'loss_val': 0.35080636593692105, 'psi': 0.9568756350525482}
[S5] START round=11 head_norm_before_train=1.097382 cos_to_last_merge=0.9126 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.913
[S5] round=11 local utility u=0.000000 metrics={'f1_val': 0.5896830968369757, 'auprc': 0.7029788463828182, 'loss_val': 0.6585405104698435, 'psi': 0.6350013966553127}-{'f1_val': 0.6298732544258827, 'auprc': 0.6719688682129462, 'loss_val': 0.6770266700584355, 'psi': 0.6467114999407082}
[S6] START round=11 head_norm_before_train=1.594880 (no previous merge yet)
[S6] round=11 local utility u=1.000000 metrics={'f1_val': 0.8875879597352083, 'auprc': 0.9121501842911224, 'loss_val': 0.3461860921086436, 'psi': 0.8974128495575739}-{'f1_val': 0.5210370912609206, 'auprc': 0.77859486752773, 'loss_val': 0.6389052124672855, 'psi': 0.6240602017676443}
[S7] START round=11 head_norm_before_train=1.147551 cos_to_last_merge=0.9154 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.915
[S7] round=11 local utility u=0.225347 metrics={'f1_val': 0.48396192710667274, 'auprc': 0.7920491926334366, 'loss_val': 0.7736768026518044, 'psi': 0.6071968333173783}-{'f1_val': 0.4169130971024577, 'auprc': 0.7933338486197793, 'loss_val': 0.825930897295684, 'psi': 0.5674813977093864}
[S8] START round=11 head_norm_before_train=1.773427 (no previous merge yet)
[S8] round=11 local utility u=0.001359 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9990328749993005, 'loss_val': 0.06413194714695342, 'psi': 0.9974249949610949}-{'f1_val': 0.9963530749356245, 'auprc': 0.999132532076712, 'loss_val': 0.06714944184326498, 'psi': 0.9974648577920595}
[S9] START round=11 head_norm_before_train=0.741815 cos_to_last_merge=1.0000 (last merge round=10)
[S9] round=11 local utility u=0.000000 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9979400620010703, 'loss_val': 0.445766985401976, 'psi': 0.8199059732644393}-{'f1_val': 0.7012904835408967, 'auprc': 0.9983229343333386, 'loss_val': 0.3505688003027231, 'psi': 0.8201034638578735}
[S10] START round=11 head_norm_before_train=0.972515 cos_to_last_merge=1.0000 (last merge round=10)
[S10] round=11 local utility u=0.034030 metrics={'f1_val': 0.9946480472226495, 'auprc': 0.9967494966466679, 'loss_val': 0.3035912340835327, 'psi': 0.9954886269922569}-{'f1_val': 0.9926312138726139, 'auprc': 0.9962257641745813, 'loss_val': 0.3579783406079405, 'psi': 0.9940690339934009}
[S11] START round=11 head_norm_before_train=1.138628 cos_to_last_merge=1.0000 (last merge round=10)
[S11] round=11 local utility u=0.028898 metrics={'f1_val': 0.7020007759458987, 'auprc': 0.9320326191130726, 'loss_val': 0.6203525102557603, 'psi': 0.7940135132127683}-{'f1_val': 0.7018246587012323, 'auprc': 0.9400058832055534, 'loss_val': 0.7010106114960833, 'psi': 0.7970971485029608}
[S13] START round=11 head_norm_before_train=0.994722 cos_to_last_merge=1.0000 (last merge round=10)
[S13] round=11 local utility u=0.080277 metrics={'f1_val': 0.5609192665242442, 'auprc': 0.5018000452787954, 'loss_val': 0.9277573207603252, 'psi': 0.5372715780260646}-{'f1_val': 0.5362766807899984, 'auprc': 0.4994598944970554, 'loss_val': 0.9334360113346457, 'psi': 0.5215499662728211}
[S14] START round=11 head_norm_before_train=0.802690 cos_to_last_merge=1.0000 (last merge round=10)
[S14] round=11 local utility u=0.000000 metrics={'f1_val': 0.9976760408229349, 'auprc': 0.9956805622857986, 'loss_val': 0.5709469500839703, 'psi': 0.9968778494080804}-{'f1_val': 0.9981093320151594, 'auprc': 0.9945664403436876, 'loss_val': 0.46555629778988356, 'psi': 0.9966921753465707}
[S15] START round=11 head_norm_before_train=1.496903 cos_to_last_merge=0.8748 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.875
[S15] round=11 local utility u=0.000000 metrics={'f1_val': 0.897516210634206, 'auprc': 0.9890292074075753, 'loss_val': 0.18342094966955136, 'psi': 0.9341214093435537}-{'f1_val': 0.9946060968988898, 'auprc': 0.9982960217338186, 'loss_val': 0.09534124136722992, 'psi': 0.9960820668328614}
[S16] START round=11 head_norm_before_train=1.442291 (no previous merge yet)
[S16] round=11 local utility u=0.000000 metrics={'f1_val': 0.37509490543215496, 'auprc': 0.7200689289494576, 'loss_val': 0.8418218924450659, 'psi': 0.513084514839076}-{'f1_val': 0.39203646036433876, 'auprc': 0.6827846282065584, 'loss_val': 0.8186936343105446, 'psi': 0.5083357275012266}
[S17] START round=11 head_norm_before_train=1.049432 cos_to_last_merge=1.0000 (last merge round=10)
[S17] round=11 local utility u=0.000000 metrics={'f1_val': 0.3653552972058479, 'auprc': 0.6775958708815144, 'loss_val': 0.8450645067790622, 'psi': 0.4902515266761145}-{'f1_val': 0.38110077086514377, 'auprc': 0.7178204405334795, 'loss_val': 0.7661358579101865, 'psi': 0.515788638732478}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:33213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:33217
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:33213
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:33212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:33204
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:33210
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:33203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S7] → sending delta(kind=head bytes=1793) to S14@127.0.0.1:33214
[S3] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1793 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1803 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1799) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.802344)
[S17] loaded HEAD from S8 (vec_in norm=1.802344)
[S17] cosine check vs S8: cos=0.8438
[S17] BUFFERED delta from S8 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1795) from S3
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=0.883850)
[S9] loaded HEAD from S3 (vec_in norm=0.883850)
[S9] cosine check vs S3: cos=0.5878
[S9] BUFFERED delta from S3 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1799) from S13
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.040818)
[S4] loaded HEAD from S13 (vec_in norm=1.040818)
[S4] cosine check vs S13: cos=0.4497
[S4] BUFFERED delta from S13 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1800) from S11
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.177074)
[S13] loaded HEAD from S11 (vec_in norm=1.177074)
[S13] cosine check vs S11: cos=0.9012
[S13] BUFFERED delta from S11 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1803) from S2
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.457824)
[S13] loaded HEAD from S2 (vec_in norm=1.457824)
[S13] cosine check vs S2: cos=0.0454
[S13] BUFFERED delta from S2 (total buffered=2)
[S11] RECEIVED delta(kind=head bytes=1801) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.618845)
[S11] loaded HEAD from S6 (vec_in norm=1.618845)
[S11] cosine check vs S6: cos=0.4588
[S11] BUFFERED delta from S6 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1795) from S10
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.056744)
[S3] loaded HEAD from S10 (vec_in norm=1.056744)
[S3] cosine check vs S10: cos=0.9289
[S3] BUFFERED delta from S10 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1793) from S7
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.195804)
[S14] loaded HEAD from S7 (vec_in norm=1.195804)
[S14] cosine check vs S7: cos=0.6642
[S14] BUFFERED delta from S7 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=11 metric=0.9464 head_norm=1.068416
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.533164e-01
[S4] stored merged vector for next round verification (round=11)
[S4] DEBUG after merge:  round=11 metric=0.6698 head_norm=0.897914 delta_norm=0.553316
[S4] aggregate: ROLLBACK (f1_val pre=0.946 post=0.670 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=11 metric=0.7012 head_norm=0.807801
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.854734e-01
[S9] stored merged vector for next round verification (round=11)
[S9] DEBUG after merge:  round=11 metric=0.7013 head_norm=0.753841 delta_norm=0.385473
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=11 metric=0.9977 head_norm=0.863576
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.482917e-01
[S14] stored merged vector for next round verification (round=11)
[S14] DEBUG after merge:  round=11 metric=0.9977 head_norm=0.941748 delta_norm=0.448292
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=11 metric=0.4812 head_norm=0.883850
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.016905e-01
[S3] stored merged vector for next round verification (round=11)
[S3] DEBUG after merge:  round=11 metric=0.5262 head_norm=0.953032 delta_norm=0.201691
[S3] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=11 metric=0.5609 head_norm=1.040818
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.458218e-01
[S13] stored merged vector for next round verification (round=11)
[S13] DEBUG after merge:  round=11 metric=0.5641 head_norm=0.886122 delta_norm=0.445822
[S13] aggregate: ACCEPT kept=['S11', 'S2'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=11 metric=0.7020 head_norm=1.177074
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.512862e-01
[S11] stored merged vector for next round verification (round=11)
[S11] DEBUG after merge:  round=11 metric=0.7020 head_norm=1.199437 delta_norm=0.751286
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=11 metric=0.3654 head_norm=1.098928
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.276105e-01
[S17] stored merged vector for next round verification (round=11)
[S17] DEBUG after merge:  round=11 metric=0.3676 head_norm=1.396306 delta_norm=0.527611
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.457824 cos_to_last_merge=0.8543 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.854
[S2] round=12 local utility u=0.000000 metrics={'f1_val': 0.629855923943889, 'auprc': 0.646736078846589, 'loss_val': 0.5507470237170677, 'psi': 0.636607985904969}-{'f1_val': 0.700869554091637, 'auprc': 0.6653697901067894, 'loss_val': 0.3284670483292004, 'psi': 0.686669648497698}
[S3] START round=12 head_norm_before_train=0.953032 cos_to_last_merge=1.0000 (last merge round=11)
[S3] round=12 local utility u=0.511393 metrics={'f1_val': 0.583845926110842, 'auprc': 0.9569185785281635, 'loss_val': 0.7700758859534158, 'psi': 0.7330749870777706}-{'f1_val': 0.48123546492238317, 'auprc': 0.8645032213963377, 'loss_val': 0.8999522164525704, 'psi': 0.6345425675119649}
[S4] START round=12 head_norm_before_train=0.897914 cos_to_last_merge=1.0000 (last merge round=11)
[S4] round=12 local utility u=0.000000 metrics={'f1_val': 0.9433104370415104, 'auprc': 0.9376030474434165, 'loss_val': 0.3874860349888969, 'psi': 0.9410274812022729}-{'f1_val': 0.9463677502228935, 'auprc': 0.9551697469001186, 'loss_val': 0.31941692227341156, 'psi': 0.9498885488937835}
[S5] START round=12 head_norm_before_train=1.118661 cos_to_last_merge=0.9024 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.902
[S5] round=12 local utility u=0.312778 metrics={'f1_val': 0.7010644289311239, 'auprc': 0.6631834694128215, 'loss_val': 0.5818862935009664, 'psi': 0.6859120451238029}-{'f1_val': 0.5896830968369757, 'auprc': 0.7029788463828182, 'loss_val': 0.6585405104698435, 'psi': 0.6350013966553127}
[S6] START round=12 head_norm_before_train=1.618845 (no previous merge yet)
[S6] round=12 local utility u=0.219268 metrics={'f1_val': 0.9253406367124557, 'auprc': 0.9553407812210216, 'loss_val': 0.26373797643684044, 'psi': 0.937340694515882}-{'f1_val': 0.8875879597352083, 'auprc': 0.9121501842911224, 'loss_val': 0.3461860921086436, 'psi': 0.8974128495575739}
[S7] START round=12 head_norm_before_train=1.195804 cos_to_last_merge=0.8970 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.897
[S7] round=12 local utility u=0.723682 metrics={'f1_val': 0.7129305285785872, 'auprc': 0.7870991659231741, 'loss_val': 0.6852747245326253, 'psi': 0.7425979835164219}-{'f1_val': 0.48396192710667274, 'auprc': 0.7920491926334366, 'loss_val': 0.7736768026518044, 'psi': 0.6071968333173783}
[S8] START round=12 head_norm_before_train=1.802344 (no previous merge yet)
[S8] round=12 local utility u=0.001833 metrics={'f1_val': 0.995891061604723, 'auprc': 0.9992450163768836, 'loss_val': 0.05833003014570735, 'psi': 0.9972326435135872}-{'f1_val': 0.9963530749356245, 'auprc': 0.9990328749993005, 'loss_val': 0.06413194714695342, 'psi': 0.9974249949610949}
[S9] START round=12 head_norm_before_train=0.753841 cos_to_last_merge=1.0000 (last merge round=11)
[S9] round=12 local utility u=0.000000 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9967036881735066, 'loss_val': 0.5711797179656074, 'psi': 0.8194114237334138}-{'f1_val': 0.7012165807733519, 'auprc': 0.9979400620010703, 'loss_val': 0.445766985401976, 'psi': 0.8199059732644393}
[S10] START round=12 head_norm_before_train=1.056744 cos_to_last_merge=0.9905 (last merge round=10)
[S10] round=12 local utility u=0.046367 metrics={'f1_val': 0.994512139992592, 'auprc': 0.9966059993283395, 'loss_val': 0.2096117866173355, 'psi': 0.9953496837268909}-{'f1_val': 0.9946480472226495, 'auprc': 0.9967494966466679, 'loss_val': 0.3035912340835327, 'psi': 0.9954886269922569}
[S11] START round=12 head_norm_before_train=1.199437 cos_to_last_merge=1.0000 (last merge round=11)
[S11] round=12 local utility u=0.081440 metrics={'f1_val': 0.702242488399264, 'auprc': 0.940525401083817, 'loss_val': 0.48440209032628345, 'psi': 0.7975556534730852}-{'f1_val': 0.7020007759458987, 'auprc': 0.9320326191130726, 'loss_val': 0.6203525102557603, 'psi': 0.7940135132127683}
[S13] START round=12 head_norm_before_train=0.886122 cos_to_last_merge=1.0000 (last merge round=11)
[S13] round=12 local utility u=0.157921 metrics={'f1_val': 0.598092179071446, 'auprc': 0.50707089580901, 'loss_val': 0.8507656269430406, 'psi': 0.5616836657664717}-{'f1_val': 0.5609192665242442, 'auprc': 0.5018000452787954, 'loss_val': 0.9277573207603252, 'psi': 0.5372715780260646}
[S14] START round=12 head_norm_before_train=0.941748 cos_to_last_merge=1.0000 (last merge round=11)
[S14] round=12 local utility u=0.000000 metrics={'f1_val': 0.975406022265831, 'auprc': 0.9944238096465611, 'loss_val': 0.6329880374416946, 'psi': 0.983013137218123}-{'f1_val': 0.9976760408229349, 'auprc': 0.9956805622857986, 'loss_val': 0.5709469500839703, 'psi': 0.9968778494080804}
[S15] START round=12 head_norm_before_train=1.544914 cos_to_last_merge=0.8685 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.868
[S15] round=12 local utility u=0.363692 metrics={'f1_val': 0.9968092060862683, 'auprc': 0.9916330358487444, 'loss_val': 0.05960625752867389, 'psi': 0.9947387379912587}-{'f1_val': 0.897516210634206, 'auprc': 0.9890292074075753, 'loss_val': 0.18342094966955136, 'psi': 0.9341214093435537}
[S16] START round=12 head_norm_before_train=1.479699 (no previous merge yet)
[S16] round=12 local utility u=0.014858 metrics={'f1_val': 0.3746239421558209, 'auprc': 0.73904900520716, 'loss_val': 0.8662207204169243, 'psi': 0.5203939673763566}-{'f1_val': 0.37509490543215496, 'auprc': 0.7200689289494576, 'loss_val': 0.8418218924450659, 'psi': 0.513084514839076}
[S17] START round=12 head_norm_before_train=1.396306 cos_to_last_merge=1.0000 (last merge round=11)
[S17] round=12 local utility u=0.192366 metrics={'f1_val': 0.3754961890957733, 'auprc': 0.7663059613890774, 'loss_val': 0.7873072134361645, 'psi': 0.5318200980130949}-{'f1_val': 0.3653552972058479, 'auprc': 0.6775958708815144, 'loss_val': 0.8450645067790622, 'psi': 0.4902515266761145}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:33214
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:33210
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:33217
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:33217
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:33216
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:33203
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S13] → sending delta(kind=head bytes=1790) to S4@127.0.0.1:33204
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S11@127.0.0.1:33212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:33213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:33212
[S6] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1804 to 1 peers)
[S13] sending update (kind=head size=1790 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1795) from S16
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.517461)
[S17] loaded HEAD from S16 (vec_in norm=1.517461)
[S17] cosine check vs S16: cos=0.2070
[S17] BUFFERED delta from S16 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1795) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.835557)
[S17] loaded HEAD from S8 (vec_in norm=1.835557)
[S17] cosine check vs S8: cos=0.9647
[S17] BUFFERED delta from S8 (total buffered=2)
[S4] RECEIVED delta(kind=head bytes=1790) from S13
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=0.932933)
[S4] loaded HEAD from S13 (vec_in norm=0.932933)
[S4] cosine check vs S13: cos=0.7516
[S4] BUFFERED delta from S13 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1801) from S11
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.240404)
[S13] loaded HEAD from S11 (vec_in norm=1.240404)
[S13] cosine check vs S11: cos=0.8091
[S13] BUFFERED delta from S11 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1798) from S10
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.139775)
[S3] loaded HEAD from S10 (vec_in norm=1.139775)
[S3] cosine check vs S10: cos=0.9689
[S3] BUFFERED delta from S10 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1798) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.639882)
[S11] loaded HEAD from S6 (vec_in norm=1.639882)
[S11] cosine check vs S6: cos=0.8895
[S11] BUFFERED delta from S6 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1804) from S15
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.589226)
[S11] loaded HEAD from S15 (vec_in norm=1.589226)
[S11] cosine check vs S15: cos=0.4581
[S11] BUFFERED delta from S15 (total buffered=2)
[S9] RECEIVED delta(kind=head bytes=1796) from S3
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=0.990321)
[S9] loaded HEAD from S3 (vec_in norm=0.990321)
[S9] cosine check vs S3: cos=0.7980
[S9] BUFFERED delta from S3 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1800) from S7
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.234952)
[S14] loaded HEAD from S7 (vec_in norm=1.234952)
[S14] cosine check vs S7: cos=0.9006
[S14] BUFFERED delta from S7 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1801) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.140409)
[S16] loaded HEAD from S5 (vec_in norm=1.140409)
[S16] cosine check vs S5: cos=-0.1457
[S16] DROPPED delta from S5 (cos=-0.1457 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S17] → sending delta(kind=head bytes=1807) to S3@127.0.0.1:33203
[S17] sending update (kind=head size=1807 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1807) from S17
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.426829)
[S3] loaded HEAD from S17 (vec_in norm=1.426829)
[S3] cosine check vs S17: cos=0.2936
[S3] BUFFERED delta from S17 (total buffered=2)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=12 metric=0.7012 head_norm=0.804918
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.985114e-01
[S9] stored merged vector for next round verification (round=12)
[S9] DEBUG after merge:  round=12 metric=0.7012 head_norm=0.851590 delta_norm=0.298511
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=12 metric=0.9754 head_norm=0.977354
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.767141e-01
[S14] stored merged vector for next round verification (round=12)
[S14] DEBUG after merge:  round=12 metric=0.9299 head_norm=1.078700 delta_norm=0.276714
[S14] aggregate: ROLLBACK (f1_val pre=0.975 post=0.930 tol_abs=0.005 tol_rel=0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=12 metric=0.9433 head_norm=0.980518
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.379361e-01
[S4] stored merged vector for next round verification (round=12)
[S4] DEBUG after merge:  round=12 metric=0.9553 head_norm=0.895371 delta_norm=0.337936
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=12 metric=0.7022 head_norm=1.240404
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.104189e-01
[S11] stored merged vector for next round verification (round=12)
[S11] DEBUG after merge:  round=12 metric=0.7022 head_norm=1.183425 delta_norm=0.210419
[S11] aggregate: ACCEPT kept=['S6', 'S15'] (k=2/2) mode=median trim_p=0.1
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=12 metric=0.5838 head_norm=0.990321
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.374375e-01
[S3] stored merged vector for next round verification (round=12)
[S3] DEBUG after merge:  round=12 metric=0.6389 head_norm=0.931727 delta_norm=0.337437
[S3] aggregate: ACCEPT kept=['S10', 'S17'] (k=2/2) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=12 metric=0.5981 head_norm=0.932933
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.661471e-01
[S13] stored merged vector for next round verification (round=12)
[S13] DEBUG after merge:  round=12 metric=0.5977 head_norm=1.034611 delta_norm=0.366147
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=12 metric=0.3755 head_norm=1.426829
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.902774e-01
[S17] stored merged vector for next round verification (round=12)
[S17] DEBUG after merge:  round=12 metric=0.3771 head_norm=1.280495 delta_norm=0.390277
[S17] aggregate: ACCEPT kept=['S16', 'S8'] (k=2/2) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.484779 cos_to_last_merge=0.8508 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.851
[S2] round=13 local utility u=0.397147 metrics={'f1_val': 0.7010383782032549, 'auprc': 0.7263422258449812, 'loss_val': 0.42236575329327414, 'psi': 0.7111599172599454}-{'f1_val': 0.629855923943889, 'auprc': 0.646736078846589, 'loss_val': 0.5507470237170677, 'psi': 0.636607985904969}
[S3] START round=13 head_norm_before_train=0.931727 cos_to_last_merge=1.0000 (last merge round=12)
[S3] round=13 local utility u=0.000000 metrics={'f1_val': 0.5881849247156895, 'auprc': 0.9184493679526364, 'loss_val': 0.7923917673491935, 'psi': 0.7202907020104683}-{'f1_val': 0.583845926110842, 'auprc': 0.9569185785281635, 'loss_val': 0.7700758859534158, 'psi': 0.7330749870777706}
[S4] START round=13 head_norm_before_train=0.895371 cos_to_last_merge=1.0000 (last merge round=12)
[S4] round=13 local utility u=0.066729 metrics={'f1_val': 0.9537345127975417, 'auprc': 0.9659620162538509, 'loss_val': 0.40164951661423054, 'psi': 0.9586255141800654}-{'f1_val': 0.9433104370415104, 'auprc': 0.9376030474434165, 'loss_val': 0.3874860349888969, 'psi': 0.9410274812022729}
[S5] START round=13 head_norm_before_train=1.140409 cos_to_last_merge=0.8915 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.892
[S5] round=13 local utility u=0.051083 metrics={'f1_val': 0.7008168588441903, 'auprc': 0.6755113440948447, 'loss_val': 0.5152184456999661, 'psi': 0.6906946529444521}-{'f1_val': 0.7010644289311239, 'auprc': 0.6631834694128215, 'loss_val': 0.5818862935009664, 'psi': 0.6859120451238029}
[S6] START round=13 head_norm_before_train=1.639882 (no previous merge yet)
[S6] round=13 local utility u=0.000000 metrics={'f1_val': 0.7357701989899, 'auprc': 0.7995879947044429, 'loss_val': 0.5501873941068509, 'psi': 0.7612973172757171}-{'f1_val': 0.9253406367124557, 'auprc': 0.9553407812210216, 'loss_val': 0.26373797643684044, 'psi': 0.937340694515882}
[S7] START round=13 head_norm_before_train=1.234952 cos_to_last_merge=0.8820 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.882
[S7] round=13 local utility u=0.000000 metrics={'f1_val': 0.5349370758556495, 'auprc': 0.7879025257647334, 'loss_val': 0.7341822566756228, 'psi': 0.6361232558192831}-{'f1_val': 0.7129305285785872, 'auprc': 0.7870991659231741, 'loss_val': 0.6852747245326253, 'psi': 0.7425979835164219}
[S8] START round=13 head_norm_before_train=1.835557 (no previous merge yet)
[S8] round=13 local utility u=0.006782 metrics={'f1_val': 0.9964900410640029, 'auprc': 0.9991832219521919, 'loss_val': 0.0481736180110281, 'psi': 0.9975673134192784}-{'f1_val': 0.995891061604723, 'auprc': 0.9992450163768836, 'loss_val': 0.05833003014570735, 'psi': 0.9972326435135872}
[S9] START round=13 head_norm_before_train=0.851590 cos_to_last_merge=1.0000 (last merge round=12)
[S9] round=13 local utility u=0.000000 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9985499562332767, 'loss_val': 0.6005391825255209, 'psi': 0.8201499309573218}-{'f1_val': 0.7012165807733519, 'auprc': 0.9967036881735066, 'loss_val': 0.5711797179656074, 'psi': 0.8194114237334138}
[S10] START round=13 head_norm_before_train=1.139775 cos_to_last_merge=0.9749 (last merge round=10)
[S10] round=13 local utility u=0.030557 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9951207315536087, 'loss_val': 0.14677828869073825, 'psi': 0.9950292045404892}-{'f1_val': 0.994512139992592, 'auprc': 0.9966059993283395, 'loss_val': 0.2096117866173355, 'psi': 0.9953496837268909}
[S11] START round=13 head_norm_before_train=1.183425 cos_to_last_merge=1.0000 (last merge round=12)
[S11] round=13 local utility u=0.012615 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.935367804974026, 'loss_val': 0.4404057443859075, 'psi': 0.7951632097417654}-{'f1_val': 0.702242488399264, 'auprc': 0.940525401083817, 'loss_val': 0.48440209032628345, 'psi': 0.7975556534730852}
[S13] START round=13 head_norm_before_train=1.034611 cos_to_last_merge=1.0000 (last merge round=12)
[S13] round=13 local utility u=0.000000 metrics={'f1_val': 0.5396962269805339, 'auprc': 0.48749182083077347, 'loss_val': 0.9622180239297119, 'psi': 0.5188144645206297}-{'f1_val': 0.598092179071446, 'auprc': 0.50707089580901, 'loss_val': 0.8507656269430406, 'psi': 0.5616836657664717}
[S14] START round=13 head_norm_before_train=1.078700 cos_to_last_merge=1.0000 (last merge round=12)
[S14] round=13 local utility u=0.049752 metrics={'f1_val': 0.9901340652854123, 'auprc': 0.9957244224162405, 'loss_val': 0.6257534028741203, 'psi': 0.9923702081377435}-{'f1_val': 0.975406022265831, 'auprc': 0.9944238096465611, 'loss_val': 0.6329880374416946, 'psi': 0.983013137218123}
[S15] START round=13 head_norm_before_train=1.589226 cos_to_last_merge=0.8622 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.862
[S15] round=13 local utility u=0.000000 metrics={'f1_val': 0.9020590268424324, 'auprc': 0.9960340783808685, 'loss_val': 0.15363193295429062, 'psi': 0.9396490474578069}-{'f1_val': 0.9968092060862683, 'auprc': 0.9916330358487444, 'loss_val': 0.05960625752867389, 'psi': 0.9947387379912587}
[S16] START round=13 head_norm_before_train=1.517461 (no previous merge yet)
[S16] round=13 local utility u=0.458700 metrics={'f1_val': 0.5107522556158095, 'auprc': 0.7594355468735583, 'loss_val': 0.8267493855380079, 'psi': 0.610225572118909}-{'f1_val': 0.3746239421558209, 'auprc': 0.73904900520716, 'loss_val': 0.8662207204169243, 'psi': 0.5203939673763566}
[S17] START round=13 head_norm_before_train=1.280495 cos_to_last_merge=1.0000 (last merge round=12)
[S17] round=13 local utility u=0.044111 metrics={'f1_val': 0.37730278199869804, 'auprc': 0.791411497757579, 'loss_val': 0.7852413863487485, 'psi': 0.5429462683022505}-{'f1_val': 0.3754961890957733, 'auprc': 0.7663059613890774, 'loss_val': 0.7873072134361645, 'psi': 0.5318200980130949}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:33213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:33211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:33203
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:33213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S14] → sending delta(kind=head bytes=1792) to S15@127.0.0.1:33215
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:33217
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:33216
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:33217
[S2] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1792 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1801) from S4
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.982507)
[S10] loaded HEAD from S4 (vec_in norm=0.982507)
[S10] cosine check vs S4: cos=0.6833
[S10] BUFFERED delta from S4 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1800) from S16
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.553559)
[S17] loaded HEAD from S16 (vec_in norm=1.553559)
[S17] cosine check vs S16: cos=0.4362
[S17] BUFFERED delta from S16 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1801) from S11
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.220386)
[S13] loaded HEAD from S11 (vec_in norm=1.220386)
[S13] cosine check vs S11: cos=0.9549
[S13] BUFFERED delta from S11 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1798) from S2
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.509983)
[S13] loaded HEAD from S2 (vec_in norm=1.509983)
[S13] cosine check vs S2: cos=0.2382
[S13] BUFFERED delta from S2 (total buffered=2)
[S17] RECEIVED delta(kind=head bytes=1803) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.867488)
[S17] loaded HEAD from S8 (vec_in norm=1.867488)
[S17] cosine check vs S8: cos=0.9129
[S17] BUFFERED delta from S8 (total buffered=2)
[S3] RECEIVED delta(kind=head bytes=1799) from S10
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.221039)
[S3] loaded HEAD from S10 (vec_in norm=1.221039)
[S3] cosine check vs S10: cos=0.8762
[S3] BUFFERED delta from S10 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1797) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.165832)
[S16] loaded HEAD from S5 (vec_in norm=1.165832)
[S16] cosine check vs S5: cos=-0.1453
[S16] DROPPED delta from S5 (cos=-0.1453 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1792) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.103225)
[S15] loaded HEAD from S14 (vec_in norm=1.103225)
[S15] cosine check vs S14: cos=-0.0483
[S15] DROPPED delta from S14 (cos=-0.0483 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:33203
[S17] sending update (kind=head size=1798 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1798) from S17
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.313987)
[S3] loaded HEAD from S17 (vec_in norm=1.313987)
[S3] cosine check vs S17: cos=0.5469
[S3] BUFFERED delta from S17 (total buffered=2)
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=13 metric=0.5882 head_norm=0.969331
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.755247e-01
[S3] stored merged vector for next round verification (round=13)
[S3] DEBUG after merge:  round=13 metric=0.5817 head_norm=0.947446 delta_norm=0.175525
[S3] aggregate: ROLLBACK (f1_val pre=0.588 post=0.582 tol_abs=0.005 tol_rel=0.0)
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=13 metric=0.5397 head_norm=1.075658
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.611419e-01
[S13] stored merged vector for next round verification (round=13)
[S13] DEBUG after merge:  round=13 metric=0.5469 head_norm=0.975018 delta_norm=0.361142
[S13] aggregate: ACCEPT kept=['S11', 'S2'] (k=2/2) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=13 metric=0.9950 head_norm=1.221039
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.519037e-01
[S10] stored merged vector for next round verification (round=13)
[S10] DEBUG after merge:  round=13 metric=0.9950 head_norm=1.011885 delta_norm=0.451904
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=13 metric=0.3773 head_norm=1.313987
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.269276e-01
[S17] stored merged vector for next round verification (round=13)
[S17] DEBUG after merge:  round=13 metric=0.3785 head_norm=1.271553 delta_norm=0.226928
[S17] aggregate: ACCEPT kept=['S16', 'S8'] (k=2/2) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.509983 cos_to_last_merge=0.8485 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.848
[S2] round=14 local utility u=0.000000 metrics={'f1_val': 0.47936775025745243, 'auprc': 0.5901737272647782, 'loss_val': 1.27770526358649, 'psi': 0.5236901410603828}-{'f1_val': 0.7010383782032549, 'auprc': 0.7263422258449812, 'loss_val': 0.42236575329327414, 'psi': 0.7111599172599454}
[S3] START round=14 head_norm_before_train=0.947446 cos_to_last_merge=1.0000 (last merge round=13)
[S3] round=14 local utility u=0.129822 metrics={'f1_val': 0.619378748147364, 'auprc': 0.9280195976033876, 'loss_val': 0.7486223090832635, 'psi': 0.7428350879297735}-{'f1_val': 0.5881849247156895, 'auprc': 0.9184493679526364, 'loss_val': 0.7923917673491935, 'psi': 0.7202907020104683}
[S4] START round=14 head_norm_before_train=0.982507 cos_to_last_merge=0.9873 (last merge round=12)
[S4] round=14 local utility u=0.040875 metrics={'f1_val': 0.955081629619052, 'auprc': 0.9676543811327281, 'loss_val': 0.3330589012999398, 'psi': 0.9601107302245224}-{'f1_val': 0.9537345127975417, 'auprc': 0.9659620162538509, 'loss_val': 0.40164951661423054, 'psi': 0.9586255141800654}
[S5] START round=14 head_norm_before_train=1.165832 cos_to_last_merge=0.8778 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.878
[S5] round=14 local utility u=0.188322 metrics={'f1_val': 0.7005691551769304, 'auprc': 0.7831662723533834, 'loss_val': 0.4600526873429714, 'psi': 0.7336080020475116}-{'f1_val': 0.7008168588441903, 'auprc': 0.6755113440948447, 'loss_val': 0.5152184456999661, 'psi': 0.6906946529444521}
[S6] START round=14 head_norm_before_train=1.665744 (no previous merge yet)
[S6] round=14 local utility u=0.562875 metrics={'f1_val': 0.808780026446375, 'auprc': 0.9527177620092686, 'loss_val': 0.3218859574729552, 'psi': 0.8663551206715324}-{'f1_val': 0.7357701989899, 'auprc': 0.7995879947044429, 'loss_val': 0.5501873941068509, 'psi': 0.7612973172757171}
[S7] START round=14 head_norm_before_train=1.270011 cos_to_last_merge=0.8696 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.870
[S7] round=14 local utility u=0.506326 metrics={'f1_val': 0.6690702798966826, 'auprc': 0.7860964541387291, 'loss_val': 0.5209118619712747, 'psi': 0.7158807495935011}-{'f1_val': 0.5349370758556495, 'auprc': 0.7879025257647334, 'loss_val': 0.7341822566756228, 'psi': 0.6361232558192831}
[S8] START round=14 head_norm_before_train=1.867488 (no previous merge yet)
[S8] round=14 local utility u=0.004529 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9990446558318047, 'loss_val': 0.03787870912842023, 'psi': 0.9974297072940966}-{'f1_val': 0.9964900410640029, 'auprc': 0.9991832219521919, 'loss_val': 0.0481736180110281, 'psi': 0.9975673134192784}
[S9] START round=14 head_norm_before_train=0.889926 cos_to_last_merge=0.9906 (last merge round=12)
[S9] round=14 local utility u=0.084833 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9979959549520483, 'loss_val': 0.42921206166855586, 'psi': 0.8199283304448305}-{'f1_val': 0.7012165807733519, 'auprc': 0.9985499562332767, 'loss_val': 0.6005391825255209, 'psi': 0.8201499309573218}
[S10] START round=14 head_norm_before_train=1.011885 cos_to_last_merge=1.0000 (last merge round=13)
[S10] round=14 local utility u=0.000000 metrics={'f1_val': 0.9938465784352174, 'auprc': 0.9965898817404557, 'loss_val': 0.20146244988062786, 'psi': 0.9949438997573128}-{'f1_val': 0.9949681865317428, 'auprc': 0.9951207315536087, 'loss_val': 0.14677828869073825, 'psi': 0.9950292045404892}
[S11] START round=14 head_norm_before_train=1.220386 cos_to_last_merge=0.9979 (last merge round=12)
[S11] round=14 local utility u=0.098793 metrics={'f1_val': 0.702242488399264, 'auprc': 0.9814654031559301, 'loss_val': 0.3844068186282582, 'psi': 0.8139316543019304}-{'f1_val': 0.7016934795869249, 'auprc': 0.935367804974026, 'loss_val': 0.4404057443859075, 'psi': 0.7951632097417654}
[S13] START round=14 head_norm_before_train=0.975018 cos_to_last_merge=1.0000 (last merge round=13)
[S13] round=14 local utility u=0.243275 metrics={'f1_val': 0.588385673138069, 'auprc': 0.5149387229630914, 'loss_val': 0.8501444427265455, 'psi': 0.5590068930680779}-{'f1_val': 0.5396962269805339, 'auprc': 0.48749182083077347, 'loss_val': 0.9622180239297119, 'psi': 0.5188144645206297}
[S14] START round=14 head_norm_before_train=1.103225 cos_to_last_merge=0.9941 (last merge round=12)
[S14] round=14 local utility u=0.120299 metrics={'f1_val': 0.997673454559638, 'auprc': 0.9971563862668475, 'loss_val': 0.43468725324832097, 'psi': 0.9974666272425218}-{'f1_val': 0.9901340652854123, 'auprc': 0.9957244224162405, 'loss_val': 0.6257534028741203, 'psi': 0.9923702081377435}
[S15] START round=14 head_norm_before_train=1.632679 cos_to_last_merge=0.8563 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.856
[S15] round=14 local utility u=0.000000 metrics={'f1_val': 0.8999994470983359, 'auprc': 0.9928563047270987, 'loss_val': 0.17770397846232017, 'psi': 0.937142190149841}-{'f1_val': 0.9020590268424324, 'auprc': 0.9960340783808685, 'loss_val': 0.15363193295429062, 'psi': 0.9396490474578069}
[S16] START round=14 head_norm_before_train=1.553559 (no previous merge yet)
[S16] round=14 local utility u=0.000000 metrics={'f1_val': 0.4301513514344757, 'auprc': 0.7452135017632973, 'loss_val': 0.7890320507927667, 'psi': 0.5561762115660043}-{'f1_val': 0.5107522556158095, 'auprc': 0.7594355468735583, 'loss_val': 0.8267493855380079, 'psi': 0.610225572118909}
[S17] START round=14 head_norm_before_train=1.271553 cos_to_last_merge=1.0000 (last merge round=13)
[S17] round=14 local utility u=0.000000 metrics={'f1_val': 0.3636911475870318, 'auprc': 0.7461983402065513, 'loss_val': 0.8486294378232782, 'psi': 0.5166940246348396}-{'f1_val': 0.37730278199869804, 'auprc': 0.791411497757579, 'loss_val': 0.7852413863487485, 'psi': 0.5429462683022505}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:33217
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:33216
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:33210
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:33211
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:33204
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:33214
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:33212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:33215
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:33217
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:33213
[S14] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1795) from S3
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=0.986219)
[S9] loaded HEAD from S3 (vec_in norm=0.986219)
[S9] cosine check vs S3: cos=0.8568
[S9] BUFFERED delta from S3 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1798) from S9
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.947503)
[S17] loaded HEAD from S9 (vec_in norm=0.947503)
[S17] cosine check vs S9: cos=0.3779
[S17] BUFFERED delta from S9 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1798) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.902698)
[S17] loaded HEAD from S8 (vec_in norm=1.902698)
[S17] cosine check vs S8: cos=0.8597
[S17] BUFFERED delta from S8 (total buffered=2)
[S4] RECEIVED delta(kind=head bytes=1799) from S13
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.019747)
[S4] loaded HEAD from S13 (vec_in norm=1.019747)
[S4] cosine check vs S13: cos=0.7930
[S4] BUFFERED delta from S13 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1803) from S11
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.256925)
[S13] loaded HEAD from S11 (vec_in norm=1.256925)
[S13] cosine check vs S11: cos=0.8530
[S13] BUFFERED delta from S11 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1798) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.686231)
[S11] loaded HEAD from S6 (vec_in norm=1.686231)
[S11] cosine check vs S6: cos=0.8104
[S11] BUFFERED delta from S6 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1803) from S7
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.298622)
[S14] loaded HEAD from S7 (vec_in norm=1.298622)
[S14] cosine check vs S7: cos=0.9190
[S14] BUFFERED delta from S7 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1797) from S4
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.082169)
[S10] loaded HEAD from S4 (vec_in norm=1.082169)
[S10] cosine check vs S4: cos=0.8835
[S10] BUFFERED delta from S4 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1800) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.194393)
[S16] loaded HEAD from S5 (vec_in norm=1.194393)
[S16] cosine check vs S5: cos=-0.1443
[S16] DROPPED delta from S5 (cos=-0.1443 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1796) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.144411)
[S15] loaded HEAD from S14 (vec_in norm=1.144411)
[S15] cosine check vs S14: cos=-0.0420
[S15] DROPPED delta from S14 (cos=-0.0420 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=14 metric=0.9938 head_norm=1.100464
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.634877e-01
[S10] stored merged vector for next round verification (round=14)
[S10] DEBUG after merge:  round=14 metric=0.9936 head_norm=1.059070 delta_norm=0.263488
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=14 metric=0.7022 head_norm=1.256925
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.969946e-01
[S11] stored merged vector for next round verification (round=14)
[S11] DEBUG after merge:  round=14 metric=0.7022 head_norm=1.401647 delta_norm=0.496995
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=14 metric=0.5884 head_norm=1.019747
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.290094e-01
[S13] stored merged vector for next round verification (round=14)
[S13] DEBUG after merge:  round=14 metric=0.5848 head_norm=1.096187 delta_norm=0.329009
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=14 metric=0.9551 head_norm=1.082169
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.393990e-01
[S4] stored merged vector for next round verification (round=14)
[S4] DEBUG after merge:  round=14 metric=0.9575 head_norm=0.995135 delta_norm=0.339399
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=14 metric=0.7012 head_norm=0.947503
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.594051e-01
[S9] stored merged vector for next round verification (round=14)
[S9] DEBUG after merge:  round=14 metric=0.7012 head_norm=0.931614 delta_norm=0.259405
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=14 metric=0.9977 head_norm=1.144411
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.571860e-01
[S14] stored merged vector for next round verification (round=14)
[S14] DEBUG after merge:  round=14 metric=0.9977 head_norm=1.196621 delta_norm=0.257186
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=14 metric=0.3637 head_norm=1.305753
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.704090e-01
[S17] stored merged vector for next round verification (round=14)
[S17] DEBUG after merge:  round=14 metric=0.3726 head_norm=1.199528 delta_norm=0.370409
[S17] aggregate: ACCEPT kept=['S9', 'S8'] (k=2/2) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.531480 cos_to_last_merge=0.8466 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.847
[S2] round=15 local utility u=1.000000 metrics={'f1_val': 0.6489331039431521, 'auprc': 0.7582785685438116, 'loss_val': 0.6341983746731863, 'psi': 0.6926712897834159}-{'f1_val': 0.47936775025745243, 'auprc': 0.5901737272647782, 'loss_val': 1.27770526358649, 'psi': 0.5236901410603828}
[S3] START round=15 head_norm_before_train=0.986219 cos_to_last_merge=0.9965 (last merge round=13)
[S3] round=15 local utility u=0.401845 metrics={'f1_val': 0.7003264167718803, 'auprc': 0.9800568609641576, 'loss_val': 0.586730777654149, 'psi': 0.8122185944487912}-{'f1_val': 0.619378748147364, 'auprc': 0.9280195976033876, 'loss_val': 0.7486223090832635, 'psi': 0.7428350879297735}
[S4] START round=15 head_norm_before_train=0.995135 cos_to_last_merge=1.0000 (last merge round=14)
[S4] round=15 local utility u=0.000000 metrics={'f1_val': 0.9538909014094512, 'auprc': 0.9617978315018194, 'loss_val': 0.3368737248953774, 'psi': 0.9570536734463985}-{'f1_val': 0.955081629619052, 'auprc': 0.9676543811327281, 'loss_val': 0.3330589012999398, 'psi': 0.9601107302245224}
[S5] START round=15 head_norm_before_train=1.194393 cos_to_last_merge=0.8638 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.864
[S5] round=15 local utility u=0.000000 metrics={'f1_val': 0.6415455234720147, 'auprc': 0.7612244058926089, 'loss_val': 0.5211976049622298, 'psi': 0.6894170764402523}-{'f1_val': 0.7005691551769304, 'auprc': 0.7831662723533834, 'loss_val': 0.4600526873429714, 'psi': 0.7336080020475116}
[S6] START round=15 head_norm_before_train=1.686231 (no previous merge yet)
[S6] round=15 local utility u=0.000000 metrics={'f1_val': 0.8095689204116782, 'auprc': 0.9174489312961387, 'loss_val': 0.4466600349454286, 'psi': 0.8527209247654624}-{'f1_val': 0.808780026446375, 'auprc': 0.9527177620092686, 'loss_val': 0.3218859574729552, 'psi': 0.8663551206715324}
[S7] START round=15 head_norm_before_train=1.298622 cos_to_last_merge=0.8591 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.859
[S7] round=15 local utility u=0.000000 metrics={'f1_val': 0.46437510736040477, 'auprc': 0.7723743598899651, 'loss_val': 0.8369690635215258, 'psi': 0.587574808372229}-{'f1_val': 0.6690702798966826, 'auprc': 0.7860964541387291, 'loss_val': 0.5209118619712747, 'psi': 0.7158807495935011}
[S8] START round=15 head_norm_before_train=1.902698 (no previous merge yet)
[S8] round=15 local utility u=0.000000 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9987072905728269, 'loss_val': 0.05244551276345951, 'psi': 0.9972047782692225}-{'f1_val': 0.9963530749356245, 'auprc': 0.9990446558318047, 'loss_val': 0.03787870912842023, 'psi': 0.9974297072940966}
[S9] START round=15 head_norm_before_train=0.931614 cos_to_last_merge=1.0000 (last merge round=14)
[S9] round=15 local utility u=0.000000 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9975838755587181, 'loss_val': 0.4476686866522785, 'psi': 0.8197634986874984}-{'f1_val': 0.7012165807733519, 'auprc': 0.9979959549520483, 'loss_val': 0.42921206166855586, 'psi': 0.8199283304448305}
[S10] START round=15 head_norm_before_train=1.059070 cos_to_last_merge=1.0000 (last merge round=14)
[S10] round=15 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9962437436042404, 'loss_val': 0.20627157022016337, 'psi': 0.9953466629733196}-{'f1_val': 0.9938465784352174, 'auprc': 0.9965898817404557, 'loss_val': 0.20146244988062786, 'psi': 0.9949438997573128}
[S11] START round=15 head_norm_before_train=1.401647 cos_to_last_merge=1.0000 (last merge round=14)
[S11] round=15 local utility u=0.000000 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.964855632413452, 'loss_val': 0.3533052487657832, 'psi': 0.8069583407175357}-{'f1_val': 0.702242488399264, 'auprc': 0.9814654031559301, 'loss_val': 0.3844068186282582, 'psi': 0.8139316543019304}
[S13] START round=15 head_norm_before_train=1.096187 cos_to_last_merge=1.0000 (last merge round=14)
[S13] round=15 local utility u=0.000000 metrics={'f1_val': 0.5781984227560442, 'auprc': 0.5068452557003822, 'loss_val': 0.8660299273259564, 'psi': 0.5496571559337793}-{'f1_val': 0.588385673138069, 'auprc': 0.5149387229630914, 'loss_val': 0.8501444427265455, 'psi': 0.5590068930680779}
[S14] START round=15 head_norm_before_train=1.196621 cos_to_last_merge=1.0000 (last merge round=14)
[S14] round=15 local utility u=0.000000 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9971555943576879, 'loss_val': 0.4438675438763696, 'psi': 0.997206451766551}-{'f1_val': 0.997673454559638, 'auprc': 0.9971563862668475, 'loss_val': 0.43468725324832097, 'psi': 0.9974666272425218}
[S15] START round=15 head_norm_before_train=1.668539 cos_to_last_merge=0.8517 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.852
[S15] round=15 local utility u=0.000000 metrics={'f1_val': 0.8432167605081567, 'auprc': 0.9909738546707897, 'loss_val': 0.2114987856514217, 'psi': 0.90231959817321}-{'f1_val': 0.8999994470983359, 'auprc': 0.9928563047270987, 'loss_val': 0.17770397846232017, 'psi': 0.937142190149841}
[S16] START round=15 head_norm_before_train=1.583715 (no previous merge yet)
[S16] round=15 local utility u=0.425591 metrics={'f1_val': 0.5473469250772625, 'auprc': 0.7714919992335757, 'loss_val': 0.7198584273237624, 'psi': 0.6370049547397878}-{'f1_val': 0.4301513514344757, 'auprc': 0.7452135017632973, 'loss_val': 0.7890320507927667, 'psi': 0.5561762115660043}
[S17] START round=15 head_norm_before_train=1.199528 cos_to_last_merge=1.0000 (last merge round=14)
[S17] round=15 local utility u=0.099030 metrics={'f1_val': 0.3797938366651571, 'auprc': 0.7712262671558229, 'loss_val': 0.8222692205597156, 'psi': 0.5363668088614234}-{'f1_val': 0.3636911475870318, 'auprc': 0.7461983402065513, 'loss_val': 0.8486294378232782, 'psi': 0.5166940246348396}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S3] → sending delta(kind=head bytes=1792) to S9@127.0.0.1:33210
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:33217
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:33213
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1792 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1800) from S2
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.543251)
[S13] loaded HEAD from S2 (vec_in norm=1.543251)
[S13] cosine check vs S2: cos=0.2775
[S13] BUFFERED delta from S2 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1801) from S16
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.611730)
[S17] loaded HEAD from S16 (vec_in norm=1.611730)
[S17] cosine check vs S16: cos=0.3546
[S17] BUFFERED delta from S16 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1792) from S3
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.023554)
[S9] loaded HEAD from S3 (vec_in norm=1.023554)
[S9] cosine check vs S3: cos=0.9323
[S9] BUFFERED delta from S3 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:33203
[S17] sending update (kind=head size=1796 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1796) from S17
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.237774)
[S3] loaded HEAD from S17 (vec_in norm=1.237774)
[S3] cosine check vs S17: cos=0.7538
[S3] BUFFERED delta from S17 (total buffered=1)
[S14] ⇄ pheromone p=0.201 → S15@127.0.0.1:33215
[S4] ⇄ pheromone p=0.147 → S10@127.0.0.1:33211
[S7] ⇄ pheromone p=0.261 → S14@127.0.0.1:33214
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=15 metric=0.5782 head_norm=1.145246
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.234498e-01
[S13] stored merged vector for next round verification (round=15)
[S13] DEBUG after merge:  round=15 metric=0.5926 head_norm=1.080989 delta_norm=0.823450
[S13] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.141 → S4@127.0.0.1:33204
[S8] ⇄ pheromone p=0.108 → S17@127.0.0.1:33217
[S10] ⇄ pheromone p=0.147 → S3@127.0.0.1:33203
[S5] ⇄ pheromone p=0.177 → S16@127.0.0.1:33216
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=15 metric=0.7012 head_norm=0.981357
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.855797e-01
[S9] stored merged vector for next round verification (round=15)
[S9] DEBUG after merge:  round=15 metric=0.7012 head_norm=0.985354 delta_norm=0.185580
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.120 → S17@127.0.0.1:33217
[S6] ⇄ pheromone p=0.297 → S11@127.0.0.1:33212
[S11] ⇄ pheromone p=0.172 → S13@127.0.0.1:33213
[S16] ⇄ pheromone p=0.213 → S17@127.0.0.1:33217
[S2] ⇄ pheromone p=0.371 → S13@127.0.0.1:33213
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=15 metric=0.7003 head_norm=1.023554
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.091936e-01
[S3] stored merged vector for next round verification (round=15)
[S3] DEBUG after merge:  round=15 metric=0.7003 head_norm=1.059450 delta_norm=0.409194
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.270 → S9@127.0.0.1:33210
[S15] ⇄ pheromone p=0.166 → S11@127.0.0.1:33212
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=15 metric=0.3798 head_norm=1.237774
[S17] _apply_head_vector_avg (torch): Δ‖w‖=8.238727e-01
[S17] stored merged vector for next round verification (round=15)
[S17] DEBUG after merge:  round=15 metric=0.3643 head_norm=1.177333 delta_norm=0.823873
[S17] aggregate: ROLLBACK (f1_val pre=0.380 post=0.364 tol_abs=0.005 tol_rel=0.0)
[S17] ⇄ pheromone p=0.108 → S3@127.0.0.1:33203
[S2] START round=16 head_norm_before_train=1.543251 cos_to_last_merge=0.8452 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.845
[S2] round=16 local utility u=0.000000 metrics={'f1_val': 0.5142199956953446, 'auprc': 0.6046709831735572, 'loss_val': 0.9379985615659083, 'psi': 0.5504003906866297}-{'f1_val': 0.6489331039431521, 'auprc': 0.7582785685438116, 'loss_val': 0.6341983746731863, 'psi': 0.6926712897834159}
[S3] START round=16 head_norm_before_train=1.059450 cos_to_last_merge=1.0000 (last merge round=15)
[S3] round=16 local utility u=0.000000 metrics={'f1_val': 0.7008317350254774, 'auprc': 0.9405711916474656, 'loss_val': 0.6180973617212334, 'psi': 0.7967275176742727}-{'f1_val': 0.7003264167718803, 'auprc': 0.9800568609641576, 'loss_val': 0.586730777654149, 'psi': 0.8122185944487912}
[S4] START round=16 head_norm_before_train=1.085578 cos_to_last_merge=0.9918 (last merge round=14)
[S4] round=16 local utility u=0.000000 metrics={'f1_val': 0.939786182829853, 'auprc': 0.902162132744151, 'loss_val': 0.32135649320447146, 'psi': 0.9247365627955721}-{'f1_val': 0.9538909014094512, 'auprc': 0.9617978315018194, 'loss_val': 0.3368737248953774, 'psi': 0.9570536734463985}
[S5] START round=16 head_norm_before_train=1.228967 cos_to_last_merge=0.8491 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.849
[S5] round=16 local utility u=0.399501 metrics={'f1_val': 0.7008569501491988, 'auprc': 0.8566044051210813, 'loss_val': 0.3642036751325119, 'psi': 0.7631559321379517}-{'f1_val': 0.6415455234720147, 'auprc': 0.7612244058926089, 'loss_val': 0.5211976049622298, 'psi': 0.6894170764402523}
[S6] START round=16 head_norm_before_train=1.715470 (no previous merge yet)
[S6] round=16 local utility u=0.483376 metrics={'f1_val': 0.9167520311814042, 'auprc': 0.9579845441048176, 'loss_val': 0.244613737944504, 'psi': 0.9332450363507696}-{'f1_val': 0.8095689204116782, 'auprc': 0.9174489312961387, 'loss_val': 0.4466600349454286, 'psi': 0.8527209247654624}
[S7] START round=16 head_norm_before_train=1.319647 cos_to_last_merge=0.8506 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.851
[S7] round=16 local utility u=0.317538 metrics={'f1_val': 0.5555865286517081, 'auprc': 0.7702108622079082, 'loss_val': 0.7426716227218793, 'psi': 0.6414362620741882}-{'f1_val': 0.46437510736040477, 'auprc': 0.7723743598899651, 'loss_val': 0.8369690635215258, 'psi': 0.587574808372229}
[S8] START round=16 head_norm_before_train=1.923803 (no previous merge yet)
[S8] round=16 local utility u=0.000000 metrics={'f1_val': 0.9940645577230776, 'auprc': 0.9989000811502653, 'loss_val': 0.05725250100289097, 'psi': 0.9959987670939527}-{'f1_val': 0.9962031034001528, 'auprc': 0.9987072905728269, 'loss_val': 0.05244551276345951, 'psi': 0.9972047782692225}
[S9] START round=16 head_norm_before_train=0.985354 cos_to_last_merge=1.0000 (last merge round=15)
[S9] round=16 local utility u=0.017488 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9978307113151947, 'loss_val': 0.41343307975835997, 'psi': 0.8198622329900891}-{'f1_val': 0.7012165807733519, 'auprc': 0.9975838755587181, 'loss_val': 0.4476686866522785, 'psi': 0.8197634986874984}
[S10] START round=16 head_norm_before_train=1.143595 cos_to_last_merge=0.9934 (last merge round=14)
[S10] round=16 local utility u=0.036847 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9956696571030645, 'loss_val': 0.1308552061345106, 'psi': 0.9951170283728493}-{'f1_val': 0.9947486092193725, 'auprc': 0.9962437436042404, 'loss_val': 0.20627157022016337, 'psi': 0.9953466629733196}
[S11] START round=16 head_norm_before_train=1.426104 cos_to_last_merge=0.9993 (last merge round=14)
[S11] round=16 local utility u=0.072437 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9969936983545361, 'loss_val': 0.3062964334491508, 'psi': 0.8199586693208065}-{'f1_val': 0.7016934795869249, 'auprc': 0.964855632413452, 'loss_val': 0.3533052487657832, 'psi': 0.8069583407175357}
[S13] START round=16 head_norm_before_train=1.080989 cos_to_last_merge=1.0000 (last merge round=15)
[S13] round=16 local utility u=0.008070 metrics={'f1_val': 0.5733683555853454, 'auprc': 0.5165896419217265, 'loss_val': 0.8501432732252262, 'psi': 0.5506568701198978}-{'f1_val': 0.5781984227560442, 'auprc': 0.5068452557003822, 'loss_val': 0.8660299273259564, 'psi': 0.5496571559337793}
[S14] START round=16 head_norm_before_train=1.227535 cos_to_last_merge=0.9956 (last merge round=14)
[S14] round=16 local utility u=0.062275 metrics={'f1_val': 0.9974830777164877, 'auprc': 0.9971152025646668, 'loss_val': 0.32065204036017647, 'psi': 0.9973359276557593}-{'f1_val': 0.997240356705793, 'auprc': 0.9971555943576879, 'loss_val': 0.4438675438763696, 'psi': 0.997206451766551}
[S15] START round=16 head_norm_before_train=1.698263 cos_to_last_merge=0.8485 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.849
[S15] round=16 local utility u=0.484504 metrics={'f1_val': 0.9779297378484484, 'auprc': 0.9958829844419557, 'loss_val': 0.06549559343776323, 'psi': 0.9851110364858513}-{'f1_val': 0.8432167605081567, 'auprc': 0.9909738546707897, 'loss_val': 0.2114987856514217, 'psi': 0.90231959817321}
[S16] START round=16 head_norm_before_train=1.611730 (no previous merge yet)
[S16] round=16 local utility u=0.575515 metrics={'f1_val': 0.7264794197299914, 'auprc': 0.7715069087804532, 'loss_val': 0.6436690503570607, 'psi': 0.7444904153501761}-{'f1_val': 0.5473469250772625, 'auprc': 0.7714919992335757, 'loss_val': 0.7198584273237624, 'psi': 0.6370049547397878}
[S17] START round=16 head_norm_before_train=1.177333 cos_to_last_merge=1.0000 (last merge round=15)
[S17] round=16 local utility u=0.000000 metrics={'f1_val': 0.3885146558407343, 'auprc': 0.7023503859443876, 'loss_val': 0.7470884923495839, 'psi': 0.5140489478821957}-{'f1_val': 0.3797938366651571, 'auprc': 0.7712262671558229, 'loss_val': 0.8222692205597156, 'psi': 0.5363668088614234}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S15] → sending delta(kind=head bytes=1806) to S11@127.0.0.1:33212
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:33216
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] → sending delta(kind=head bytes=1794) to S15@127.0.0.1:33215
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:33203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:33217
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:33212
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] → sending delta(kind=head bytes=1805) to S13@127.0.0.1:33213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] → sending delta(kind=head bytes=1793) to S17@127.0.0.1:33217
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:33214
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S13] → sending delta(kind=head bytes=1790) to S4@127.0.0.1:33204
[S11] sending update (kind=head size=1805 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1794 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1790 to 1 peers)
[S15] sending update (kind=head size=1806 to 1 peers)
[S9] sending update (kind=head size=1793 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1793) from S9
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.031724)
[S17] loaded HEAD from S9 (vec_in norm=1.031724)
[S17] cosine check vs S9: cos=0.4954
[S17] BUFFERED delta from S9 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1801) from S16
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.638507)
[S17] loaded HEAD from S16 (vec_in norm=1.638507)
[S17] cosine check vs S16: cos=0.8518
[S17] BUFFERED delta from S16 (total buffered=2)
[S16] RECEIVED delta(kind=head bytes=1801) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.256309)
[S16] loaded HEAD from S5 (vec_in norm=1.256309)
[S16] cosine check vs S5: cos=-0.1416
[S16] DROPPED delta from S5 (cos=-0.1416 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1790) from S13
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.125846)
[S4] loaded HEAD from S13 (vec_in norm=1.125846)
[S4] cosine check vs S13: cos=0.7613
[S4] BUFFERED delta from S13 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1805) from S11
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.453842)
[S13] loaded HEAD from S11 (vec_in norm=1.453842)
[S13] cosine check vs S11: cos=0.5461
[S13] BUFFERED delta from S11 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1794) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.268465)
[S15] loaded HEAD from S14 (vec_in norm=1.268465)
[S15] cosine check vs S14: cos=-0.0355
[S15] DROPPED delta from S14 (cos=-0.0355 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1797) from S10
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.242790)
[S3] loaded HEAD from S10 (vec_in norm=1.242790)
[S3] cosine check vs S10: cos=0.5115
[S3] BUFFERED delta from S10 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1799) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.734802)
[S11] loaded HEAD from S6 (vec_in norm=1.734802)
[S11] cosine check vs S6: cos=0.9537
[S11] BUFFERED delta from S6 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1806) from S15
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.731314)
[S11] loaded HEAD from S15 (vec_in norm=1.731314)
[S11] cosine check vs S15: cos=0.2937
[S11] BUFFERED delta from S15 (total buffered=2)
[S14] RECEIVED delta(kind=head bytes=1802) from S7
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.337719)
[S14] loaded HEAD from S7 (vec_in norm=1.337719)
[S14] cosine check vs S7: cos=0.9333
[S14] BUFFERED delta from S7 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=16 metric=0.9398 head_norm=1.177243
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.985789e-01
[S4] stored merged vector for next round verification (round=16)
[S4] DEBUG after merge:  round=16 metric=0.9398 head_norm=1.080671 delta_norm=0.398579
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=16 metric=0.7008 head_norm=1.087348
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.797532e-01
[S3] stored merged vector for next round verification (round=16)
[S3] DEBUG after merge:  round=16 metric=0.7008 head_norm=1.013564 delta_norm=0.579753
[S3] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=16 metric=0.9975 head_norm=1.268465
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.403162e-01
[S14] stored merged vector for next round verification (round=16)
[S14] DEBUG after merge:  round=16 metric=0.9979 head_norm=1.281209 delta_norm=0.240316
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=16 metric=0.5734 head_norm=1.125846
[S13] _apply_head_vector_avg (torch): Δ‖w‖=6.311744e-01
[S13] stored merged vector for next round verification (round=16)
[S13] DEBUG after merge:  round=16 metric=0.5731 head_norm=1.136755 delta_norm=0.631174
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=16 metric=0.7019 head_norm=1.453842
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.681495e-01
[S11] stored merged vector for next round verification (round=16)
[S11] DEBUG after merge:  round=16 metric=0.7019 head_norm=1.306839 delta_norm=0.368150
[S11] aggregate: ACCEPT kept=['S6', 'S15'] (k=2/2) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=16 metric=0.3885 head_norm=1.219178
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.363873e-01
[S17] stored merged vector for next round verification (round=16)
[S17] DEBUG after merge:  round=16 metric=0.5317 head_norm=1.103750 delta_norm=0.236387
[S17] aggregate: ACCEPT kept=['S9', 'S16'] (k=2/2) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.552258 cos_to_last_merge=0.8443 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.844
[S2] round=17 local utility u=0.681822 metrics={'f1_val': 0.6343685361594971, 'auprc': 0.7003596453254577, 'loss_val': 0.5823127568437619, 'psi': 0.6607649798258813}-{'f1_val': 0.5142199956953446, 'auprc': 0.6046709831735572, 'loss_val': 0.9379985615659083, 'psi': 0.5504003906866297}
[S3] START round=17 head_norm_before_train=1.013564 cos_to_last_merge=1.0000 (last merge round=16)
[S3] round=17 local utility u=0.000000 metrics={'f1_val': 0.604406993061628, 'auprc': 0.9851075127688422, 'loss_val': 0.6513177782186796, 'psi': 0.7566872009445138}-{'f1_val': 0.7008317350254774, 'auprc': 0.9405711916474656, 'loss_val': 0.6180973617212334, 'psi': 0.7967275176742727}
[S4] START round=17 head_norm_before_train=1.080671 cos_to_last_merge=1.0000 (last merge round=16)
[S4] round=17 local utility u=0.106503 metrics={'f1_val': 0.9454975228649614, 'auprc': 0.956733247127698, 'loss_val': 0.3063319435357064, 'psi': 0.9499918125700559}-{'f1_val': 0.939786182829853, 'auprc': 0.902162132744151, 'loss_val': 0.32135649320447146, 'psi': 0.9247365627955721}
[S5] START round=17 head_norm_before_train=1.256309 cos_to_last_merge=0.8376 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.838
[S5] round=17 local utility u=0.217395 metrics={'f1_val': 0.7005691551769304, 'auprc': 0.9919404961545769, 'loss_val': 0.3336948008217448, 'psi': 0.817117691567989}-{'f1_val': 0.7008569501491988, 'auprc': 0.8566044051210813, 'loss_val': 0.3642036751325119, 'psi': 0.7631559321379517}
[S6] START round=17 head_norm_before_train=1.734802 (no previous merge yet)
[S6] round=17 local utility u=0.000000 metrics={'f1_val': 0.781710854428491, 'auprc': 0.9296344637295679, 'loss_val': 0.4820946461669602, 'psi': 0.8408802981489217}-{'f1_val': 0.9167520311814042, 'auprc': 0.9579845441048176, 'loss_val': 0.244613737944504, 'psi': 0.9332450363507696}
[S7] START round=17 head_norm_before_train=1.337719 cos_to_last_merge=0.8442 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.844
[S7] round=17 local utility u=0.589758 metrics={'f1_val': 0.6673339902179098, 'auprc': 0.8565076246484147, 'loss_val': 0.49253012795606665, 'psi': 0.7430034439901119}-{'f1_val': 0.5555865286517081, 'auprc': 0.7702108622079082, 'loss_val': 0.7426716227218793, 'psi': 0.6414362620741882}
[S8] START round=17 head_norm_before_train=1.942781 (no previous merge yet)
[S8] round=17 local utility u=0.009577 metrics={'f1_val': 0.9944672019690619, 'auprc': 0.9986804460240168, 'loss_val': 0.03985623329801815, 'psi': 0.9961524995910438}-{'f1_val': 0.9940645577230776, 'auprc': 0.9989000811502653, 'loss_val': 0.05725250100289097, 'psi': 0.9959987670939527}
[S9] START round=17 head_norm_before_train=1.031724 cos_to_last_merge=0.9944 (last merge round=15)
[S9] round=17 local utility u=0.634771 metrics={'f1_val': 0.8908125792089935, 'auprc': 0.9975231182091092, 'loss_val': 0.2805452685767125, 'psi': 0.9334967948090398}-{'f1_val': 0.7012165807733519, 'auprc': 0.9978307113151947, 'loss_val': 0.41343307975835997, 'psi': 0.8198622329900891}
[S10] START round=17 head_norm_before_train=1.242790 cos_to_last_merge=0.9787 (last merge round=14)
[S10] round=17 local utility u=0.016808 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9934952666998847, 'loss_val': 0.09203401792618984, 'psi': 0.9943790185989996}-{'f1_val': 0.9947486092193725, 'auprc': 0.9956696571030645, 'loss_val': 0.1308552061345106, 'psi': 0.9951170283728493}
[S11] START round=17 head_norm_before_train=1.306839 cos_to_last_merge=1.0000 (last merge round=16)
[S11] round=17 local utility u=0.000370 metrics={'f1_val': 0.7016282822309048, 'auprc': 0.9976903927907315, 'loss_val': 0.30580395822434603, 'psi': 0.8200531264548354}-{'f1_val': 0.7019353166316534, 'auprc': 0.9969936983545361, 'loss_val': 0.3062964334491508, 'psi': 0.8199586693208065}
[S13] START round=17 head_norm_before_train=1.136755 cos_to_last_merge=1.0000 (last merge round=16)
[S13] round=17 local utility u=0.000000 metrics={'f1_val': 0.5181838588320553, 'auprc': 0.5281063415070942, 'loss_val': 0.9986082579693754, 'psi': 0.5221528519020708}-{'f1_val': 0.5733683555853454, 'auprc': 0.5165896419217265, 'loss_val': 0.8501432732252262, 'psi': 0.5506568701198978}
[S14] START round=17 head_norm_before_train=1.281209 cos_to_last_merge=1.0000 (last merge round=16)
[S14] round=17 local utility u=0.000000 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9972230902821447, 'loss_val': 0.34306050350024037, 'psi': 0.9972334501363338}-{'f1_val': 0.9974830777164877, 'auprc': 0.9971152025646668, 'loss_val': 0.32065204036017647, 'psi': 0.9973359276557593}
[S15] START round=17 head_norm_before_train=1.731314 cos_to_last_merge=0.8449 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.845
[S15] round=17 local utility u=0.000000 metrics={'f1_val': 0.9034366446455795, 'auprc': 0.9960830088372665, 'loss_val': 0.12389197218217284, 'psi': 0.9404951903222543}-{'f1_val': 0.9779297378484484, 'auprc': 0.9958829844419557, 'loss_val': 0.06549559343776323, 'psi': 0.9851110364858513}
[S16] START round=17 head_norm_before_train=1.638507 (no previous merge yet)
[S16] round=17 local utility u=0.316482 metrics={'f1_val': 0.8176964909308491, 'auprc': 0.8096459828060022, 'loss_val': 0.6724247001279268, 'psi': 0.8144762876809103}-{'f1_val': 0.7264794197299914, 'auprc': 0.7715069087804532, 'loss_val': 0.6436690503570607, 'psi': 0.7444904153501761}
[S17] START round=17 head_norm_before_train=1.103750 cos_to_last_merge=1.0000 (last merge round=16)
[S17] round=17 local utility u=0.000000 metrics={'f1_val': 0.3715686515781673, 'auprc': 0.6190914260718001, 'loss_val': 0.8077223144085859, 'psi': 0.47057776137562046}-{'f1_val': 0.3885146558407343, 'auprc': 0.7023503859443876, 'loss_val': 0.7470884923495839, 'psi': 0.5140489478821957}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:33203
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:33213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:33216
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:33217
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:33211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S2] → sending delta(kind=head bytes=1792) to S13@127.0.0.1:33213
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:33217
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:33217
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:33214
[S9] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1804 to 1 peers)
[S2] sending update (kind=head size=1792 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1803 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1799) from S9
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.088491)
[S17] loaded HEAD from S9 (vec_in norm=1.088491)
[S17] cosine check vs S9: cos=0.5689
[S17] BUFFERED delta from S9 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1800) from S16
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.666160)
[S17] loaded HEAD from S16 (vec_in norm=1.666160)
[S17] cosine check vs S16: cos=0.8513
[S17] BUFFERED delta from S16 (total buffered=2)
[S17] RECEIVED delta(kind=head bytes=1797) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.962995)
[S17] loaded HEAD from S8 (vec_in norm=1.962995)
[S17] cosine check vs S8: cos=0.4874
[S17] BUFFERED delta from S8 (total buffered=3)
[S13] RECEIVED delta(kind=head bytes=1792) from S2
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.565838)
[S13] loaded HEAD from S2 (vec_in norm=1.565838)
[S13] cosine check vs S2: cos=0.4592
[S13] BUFFERED delta from S2 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1803) from S11
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.331849)
[S13] loaded HEAD from S11 (vec_in norm=1.331849)
[S13] cosine check vs S11: cos=0.8858
[S13] BUFFERED delta from S11 (total buffered=2)
[S3] RECEIVED delta(kind=head bytes=1801) from S10
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.329182)
[S3] loaded HEAD from S10 (vec_in norm=1.329182)
[S3] cosine check vs S10: cos=0.8827
[S3] BUFFERED delta from S10 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1804) from S7
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.351428)
[S14] loaded HEAD from S7 (vec_in norm=1.351428)
[S14] cosine check vs S7: cos=0.9681
[S14] BUFFERED delta from S7 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1803) from S4
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.161746)
[S10] loaded HEAD from S4 (vec_in norm=1.161746)
[S10] cosine check vs S4: cos=0.7572
[S10] BUFFERED delta from S4 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1798) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.281465)
[S16] loaded HEAD from S5 (vec_in norm=1.281465)
[S16] cosine check vs S5: cos=-0.1391
[S16] DROPPED delta from S5 (cos=-0.1391 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=17 metric=0.6044 head_norm=1.048854
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.184808e-01
[S3] stored merged vector for next round verification (round=17)
[S3] DEBUG after merge:  round=17 metric=0.6067 head_norm=1.154114 delta_norm=0.318481
[S3] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=17 metric=0.5182 head_norm=1.191847
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.688600e-01
[S13] stored merged vector for next round verification (round=17)
[S13] DEBUG after merge:  round=17 metric=0.5207 head_norm=1.097218 delta_norm=0.268860
[S13] aggregate: ACCEPT kept=['S2', 'S11'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=17 metric=0.9972 head_norm=1.313830
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.692206e-01
[S14] stored merged vector for next round verification (round=17)
[S14] DEBUG after merge:  round=17 metric=0.9977 head_norm=1.321975 delta_norm=0.169221
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=17 metric=0.9950 head_norm=1.329182
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.410312e-01
[S10] stored merged vector for next round verification (round=17)
[S10] DEBUG after merge:  round=17 metric=0.9950 head_norm=1.167767 delta_norm=0.441031
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=17 metric=0.3716 head_norm=1.156654
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.390545e-01
[S17] stored merged vector for next round verification (round=17)
[S17] DEBUG after merge:  round=17 metric=0.4330 head_norm=1.050922 delta_norm=0.339054
[S17] aggregate: ACCEPT kept=['S9', 'S16', 'S8'] (k=3/3) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.565838 cos_to_last_merge=0.8433 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.843
[S2] round=18 local utility u=0.324594 metrics={'f1_val': 0.713928850280712, 'auprc': 0.7725987009259367, 'loss_val': 0.6272031864971488, 'psi': 0.7373967905388019}-{'f1_val': 0.6343685361594971, 'auprc': 0.7003596453254577, 'loss_val': 0.5823127568437619, 'psi': 0.6607649798258813}
[S3] START round=18 head_norm_before_train=1.154114 cos_to_last_merge=1.0000 (last merge round=17)
[S3] round=18 local utility u=0.320800 metrics={'f1_val': 0.6876195516123381, 'auprc': 0.9877309166227564, 'loss_val': 0.5168633832254982, 'psi': 0.8076640976165055}-{'f1_val': 0.604406993061628, 'auprc': 0.9851075127688422, 'loss_val': 0.6513177782186796, 'psi': 0.7566872009445138}
[S4] START round=18 head_norm_before_train=1.161746 cos_to_last_merge=0.9953 (last merge round=16)
[S4] round=18 local utility u=0.029113 metrics={'f1_val': 0.9466338532468453, 'auprc': 0.9616492581520548, 'loss_val': 0.2696717589392269, 'psi': 0.9526400152089292}-{'f1_val': 0.9454975228649614, 'auprc': 0.956733247127698, 'loss_val': 0.3063319435357064, 'psi': 0.9499918125700559}
[S5] START round=18 head_norm_before_train=1.281465 cos_to_last_merge=0.8257 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.826
[S5] round=18 local utility u=0.000000 metrics={'f1_val': 0.6399186134663917, 'auprc': 0.7761256203020827, 'loss_val': 0.5733882117314992, 'psi': 0.6944014162006681}-{'f1_val': 0.7005691551769304, 'auprc': 0.9919404961545769, 'loss_val': 0.3336948008217448, 'psi': 0.817117691567989}
[S6] START round=18 head_norm_before_train=1.749521 (no previous merge yet)
[S6] round=18 local utility u=0.000000 metrics={'f1_val': 0.4425387455705306, 'auprc': 0.7267607417634951, 'loss_val': 1.0156394769458659, 'psi': 0.5562275440477165}-{'f1_val': 0.781710854428491, 'auprc': 0.9296344637295679, 'loss_val': 0.4820946461669602, 'psi': 0.8408802981489217}
[S7] START round=18 head_norm_before_train=1.351428 cos_to_last_merge=0.8399 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.840
[S7] round=18 local utility u=0.000000 metrics={'f1_val': 0.510449207920687, 'auprc': 0.7802691070809846, 'loss_val': 0.8420234251359692, 'psi': 0.6183771675848061}-{'f1_val': 0.6673339902179098, 'auprc': 0.8565076246484147, 'loss_val': 0.49253012795606665, 'psi': 0.7430034439901119}
[S8] START round=18 head_norm_before_train=1.962995 (no previous merge yet)
[S8] round=18 local utility u=0.000000 metrics={'f1_val': 0.7142391053978291, 'auprc': 0.9866563659660331, 'loss_val': 0.46926376405199616, 'psi': 0.8232060096251108}-{'f1_val': 0.9944672019690619, 'auprc': 0.9986804460240168, 'loss_val': 0.03985623329801815, 'psi': 0.9961524995910438}
[S9] START round=18 head_norm_before_train=1.088491 cos_to_last_merge=0.9815 (last merge round=15)
[S9] round=18 local utility u=0.260912 metrics={'f1_val': 0.9689501653521664, 'auprc': 0.9962603415959109, 'loss_val': 0.22375794332569032, 'psi': 0.9798742358496642}-{'f1_val': 0.8908125792089935, 'auprc': 0.9975231182091092, 'loss_val': 0.2805452685767125, 'psi': 0.9334967948090398}
[S10] START round=18 head_norm_before_train=1.167767 cos_to_last_merge=1.0000 (last merge round=17)
[S10] round=18 local utility u=0.000000 metrics={'f1_val': 0.9943096789853013, 'auprc': 0.9956989721991877, 'loss_val': 0.1480106114751005, 'psi': 0.9948653962708558}-{'f1_val': 0.9949681865317428, 'auprc': 0.9934952666998847, 'loss_val': 0.09203401792618984, 'psi': 0.9943790185989996}
[S11] START round=18 head_norm_before_train=1.331849 cos_to_last_merge=0.9994 (last merge round=16)
[S11] round=18 local utility u=0.767919 metrics={'f1_val': 0.9511068363154068, 'auprc': 0.9978331645462444, 'loss_val': 0.2672662257498194, 'psi': 0.9697973676077418}-{'f1_val': 0.7016282822309048, 'auprc': 0.9976903927907315, 'loss_val': 0.30580395822434603, 'psi': 0.8200531264548354}
[S13] START round=18 head_norm_before_train=1.097218 cos_to_last_merge=1.0000 (last merge round=17)
[S13] round=18 local utility u=0.130502 metrics={'f1_val': 0.5469727631862207, 'auprc': 0.5301028391306857, 'loss_val': 0.9163279879792081, 'psi': 0.5402247935640067}-{'f1_val': 0.5181838588320553, 'auprc': 0.5281063415070942, 'loss_val': 0.9986082579693754, 'psi': 0.5221528519020708}
[S14] START round=18 head_norm_before_train=1.321975 cos_to_last_merge=1.0000 (last merge round=17)
[S14] round=18 local utility u=0.000000 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.996008464755429, 'loss_val': 0.3439949781467281, 'psi': 0.9969940567320837}-{'f1_val': 0.997240356705793, 'auprc': 0.9972230902821447, 'loss_val': 0.34306050350024037, 'psi': 0.9972334501363338}
[S15] START round=18 head_norm_before_train=1.757768 cos_to_last_merge=0.8423 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.842
[S15] round=18 local utility u=0.136731 metrics={'f1_val': 0.9407487051204269, 'auprc': 0.995924605398244, 'loss_val': 0.0738278408310281, 'psi': 0.9628190652315537}-{'f1_val': 0.9034366446455795, 'auprc': 0.9960830088372665, 'loss_val': 0.12389197218217284, 'psi': 0.9404951903222543}
[S16] START round=18 head_norm_before_train=1.666160 (no previous merge yet)
[S16] round=18 local utility u=0.136084 metrics={'f1_val': 0.8307739137996837, 'auprc': 0.8409920225582447, 'loss_val': 0.5727599423718076, 'psi': 0.8348611573031081}-{'f1_val': 0.8176964909308491, 'auprc': 0.8096459828060022, 'loss_val': 0.6724247001279268, 'psi': 0.8144762876809103}
[S17] START round=18 head_norm_before_train=1.050922 cos_to_last_merge=1.0000 (last merge round=17)
[S17] round=18 local utility u=0.268796 metrics={'f1_val': 0.410323683871142, 'auprc': 0.752179160687776, 'loss_val': 0.9019237250658942, 'psi': 0.5470658745977957}-{'f1_val': 0.3715686515781673, 'auprc': 0.6190914260718001, 'loss_val': 0.8077223144085859, 'psi': 0.47057776137562046}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:33204
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:33217
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:33213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:33213
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:33217
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S3] → sending delta(kind=head bytes=1790) to S9@127.0.0.1:33210
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:33211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:33212
[S4] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1790 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1803 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1802) from S9
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.143742)
[S17] loaded HEAD from S9 (vec_in norm=1.143742)
[S17] cosine check vs S9: cos=0.7385
[S17] BUFFERED delta from S9 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1797) from S16
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.693423)
[S17] loaded HEAD from S16 (vec_in norm=1.693423)
[S17] cosine check vs S16: cos=0.6722
[S17] BUFFERED delta from S16 (total buffered=2)
[S9] RECEIVED delta(kind=head bytes=1790) from S3
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.183589)
[S9] loaded HEAD from S3 (vec_in norm=1.183589)
[S9] cosine check vs S3: cos=0.8395
[S9] BUFFERED delta from S3 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1799) from S2
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.580800)
[S13] loaded HEAD from S2 (vec_in norm=1.580800)
[S13] cosine check vs S2: cos=0.6103
[S13] BUFFERED delta from S2 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1795) from S11
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.363333)
[S13] loaded HEAD from S11 (vec_in norm=1.363333)
[S13] cosine check vs S11: cos=0.8026
[S13] BUFFERED delta from S11 (total buffered=2)
[S4] RECEIVED delta(kind=head bytes=1803) from S13
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.147274)
[S4] loaded HEAD from S13 (vec_in norm=1.147274)
[S4] cosine check vs S13: cos=0.8757
[S4] BUFFERED delta from S13 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1801) from S15
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.779914)
[S11] loaded HEAD from S15 (vec_in norm=1.779914)
[S11] cosine check vs S15: cos=0.5065
[S11] BUFFERED delta from S15 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1799) from S4
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.246545)
[S10] loaded HEAD from S4 (vec_in norm=1.246545)
[S10] cosine check vs S4: cos=0.9121
[S10] BUFFERED delta from S4 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] → sending delta(kind=head bytes=1793) to S3@127.0.0.1:33203
[S17] sending update (kind=head size=1793 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1793) from S17
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.108399)
[S3] loaded HEAD from S17 (vec_in norm=1.108399)
[S3] cosine check vs S17: cos=0.5030
[S3] BUFFERED delta from S17 (total buffered=1)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=18 metric=0.9943 head_norm=1.245904
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.612307e-01
[S10] stored merged vector for next round verification (round=18)
[S10] DEBUG after merge:  round=18 metric=0.9941 head_norm=1.218537 delta_norm=0.261231
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=18 metric=0.9690 head_norm=1.143742
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.302506e-01
[S9] stored merged vector for next round verification (round=18)
[S9] DEBUG after merge:  round=18 metric=0.7012 head_norm=1.115997 delta_norm=0.330251
[S9] aggregate: ROLLBACK (f1_val pre=0.969 post=0.701 tol_abs=0.005 tol_rel=0.0)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=18 metric=0.6876 head_norm=1.183589
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.722026e-01
[S3] stored merged vector for next round verification (round=18)
[S3] DEBUG after merge:  round=18 metric=0.6449 head_norm=0.993629 delta_norm=0.572203
[S3] aggregate: ROLLBACK (f1_val pre=0.688 post=0.645 tol_abs=0.005 tol_rel=0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=18 metric=0.9511 head_norm=1.363333
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.013687e-01
[S11] stored merged vector for next round verification (round=18)
[S11] DEBUG after merge:  round=18 metric=0.7019 head_norm=1.367915 delta_norm=0.801369
[S11] aggregate: ROLLBACK (f1_val pre=0.951 post=0.702 tol_abs=0.005 tol_rel=0.0)
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=18 metric=0.5470 head_norm=1.147274
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.720801e-01
[S13] stored merged vector for next round verification (round=18)
[S13] DEBUG after merge:  round=18 metric=0.5493 head_norm=1.100348 delta_norm=0.172080
[S13] aggregate: ACCEPT kept=['S2', 'S11'] (k=2/2) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=18 metric=0.9466 head_norm=1.246545
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.021997e-01
[S4] stored merged vector for next round verification (round=18)
[S4] DEBUG after merge:  round=18 metric=0.9462 head_norm=1.159194 delta_norm=0.302200
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=18 metric=0.4103 head_norm=1.108399
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.354346e-01
[S17] stored merged vector for next round verification (round=18)
[S17] DEBUG after merge:  round=18 metric=0.3767 head_norm=1.074408 delta_norm=0.235435
[S17] aggregate: ROLLBACK (f1_val pre=0.410 post=0.377 tol_abs=0.005 tol_rel=0.0)
[S2] START round=19 head_norm_before_train=1.580800 cos_to_last_merge=0.8423 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.842
[S2] round=19 local utility u=0.000000 metrics={'f1_val': 0.6248520154740906, 'auprc': 0.6989969453615092, 'loss_val': 0.9573407965821222, 'psi': 0.6545099874290581}-{'f1_val': 0.713928850280712, 'auprc': 0.7725987009259367, 'loss_val': 0.6272031864971488, 'psi': 0.7373967905388019}
[S3] START round=19 head_norm_before_train=0.993629 cos_to_last_merge=1.0000 (last merge round=18)
[S3] round=19 local utility u=0.000000 metrics={'f1_val': 0.6995786553134029, 'auprc': 0.9516231024217601, 'loss_val': 0.5195210652838325, 'psi': 0.8003964341567458}-{'f1_val': 0.6876195516123381, 'auprc': 0.9877309166227564, 'loss_val': 0.5168633832254982, 'psi': 0.8076640976165055}
[S4] START round=19 head_norm_before_train=1.159194 cos_to_last_merge=1.0000 (last merge round=18)
[S4] round=19 local utility u=0.000000 metrics={'f1_val': 0.9418139735561961, 'auprc': 0.9286201946775007, 'loss_val': 0.2935467850944799, 'psi': 0.936536462004718}-{'f1_val': 0.9466338532468453, 'auprc': 0.9616492581520548, 'loss_val': 0.2696717589392269, 'psi': 0.9526400152089292}
[S5] START round=19 head_norm_before_train=1.312268 cos_to_last_merge=0.8189 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.819
[S5] round=19 local utility u=0.627333 metrics={'f1_val': 0.7006090940057808, 'auprc': 0.9858789308683673, 'loss_val': 0.3121241055200335, 'psi': 0.8147170287508154}-{'f1_val': 0.6399186134663917, 'auprc': 0.7761256203020827, 'loss_val': 0.5733882117314992, 'psi': 0.6944014162006681}
[S6] START round=19 head_norm_before_train=1.760246 (no previous merge yet)
[S6] round=19 local utility u=1.000000 metrics={'f1_val': 0.9574869983638192, 'auprc': 0.9647585579735135, 'loss_val': 0.1739238979862276, 'psi': 0.9603956222076969}-{'f1_val': 0.4425387455705306, 'auprc': 0.7267607417634951, 'loss_val': 1.0156394769458659, 'psi': 0.5562275440477165}
[S7] START round=19 head_norm_before_train=1.361439 cos_to_last_merge=0.8365 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.836
[S7] round=19 local utility u=0.097885 metrics={'f1_val': 0.5361030006352249, 'auprc': 0.7833397874195525, 'loss_val': 0.8093879987005259, 'psi': 0.6349977153489559}-{'f1_val': 0.510449207920687, 'auprc': 0.7802691070809846, 'loss_val': 0.8420234251359692, 'psi': 0.6183771675848061}
[S8] START round=19 head_norm_before_train=1.977247 (no previous merge yet)
[S8] round=19 local utility u=0.153752 metrics={'f1_val': 0.7388970843614528, 'auprc': 0.9986997851145238, 'loss_val': 0.3458374786547262, 'psi': 0.8428181646626813}-{'f1_val': 0.7142391053978291, 'auprc': 0.9866563659660331, 'loss_val': 0.46926376405199616, 'psi': 0.8232060096251108}
[S9] START round=19 head_norm_before_train=1.115997 cos_to_last_merge=1.0000 (last merge round=18)
[S9] round=19 local utility u=0.081468 metrics={'f1_val': 0.9954158325366191, 'auprc': 0.9951223823818002, 'loss_val': 0.21620180302412956, 'psi': 0.9952984524746915}-{'f1_val': 0.9689501653521664, 'auprc': 0.9962603415959109, 'loss_val': 0.22375794332569032, 'psi': 0.9798742358496642}
[S10] START round=19 head_norm_before_train=1.218537 cos_to_last_merge=1.0000 (last merge round=18)
[S10] round=19 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9940655499097693, 'loss_val': 0.15691041009039702, 'psi': 0.9946071318829535}-{'f1_val': 0.9943096789853013, 'auprc': 0.9956989721991877, 'loss_val': 0.1480106114751005, 'psi': 0.9948653962708558}
[S11] START round=19 head_norm_before_train=1.367915 cos_to_last_merge=1.0000 (last merge round=18)
[S11] round=19 local utility u=0.065653 metrics={'f1_val': 0.9805090036601898, 'auprc': 0.9961226851111473, 'loss_val': 0.30724197082623084, 'psi': 0.9867544762405728}-{'f1_val': 0.9511068363154068, 'auprc': 0.9978331645462444, 'loss_val': 0.2672662257498194, 'psi': 0.9697973676077418}
[S13] START round=19 head_norm_before_train=1.100348 cos_to_last_merge=1.0000 (last merge round=18)
[S13] round=19 local utility u=0.223340 metrics={'f1_val': 0.5985753581657752, 'auprc': 0.5359361116357384, 'loss_val': 0.7967636577246963, 'psi': 0.5735196595537605}-{'f1_val': 0.5469727631862207, 'auprc': 0.5301028391306857, 'loss_val': 0.9163279879792081, 'psi': 0.5402247935640067}
[S14] START round=19 head_norm_before_train=1.351634 cos_to_last_merge=0.9970 (last merge round=17)
[S14] round=19 local utility u=0.053364 metrics={'f1_val': 0.9968300801588782, 'auprc': 0.9974565920448892, 'loss_val': 0.23668609984752287, 'psi': 0.9970806849132825}-{'f1_val': 0.9976511180498535, 'auprc': 0.996008464755429, 'loss_val': 0.3439949781467281, 'psi': 0.9969940567320837}
[S15] START round=19 head_norm_before_train=1.779914 cos_to_last_merge=0.8404 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.840
[S15] round=19 local utility u=0.190052 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9967889399834984, 'loss_val': 0.03230520399081165, 'psi': 0.9967635770259117}-{'f1_val': 0.9407487051204269, 'auprc': 0.995924605398244, 'loss_val': 0.0738278408310281, 'psi': 0.9628190652315537}
[S16] START round=19 head_norm_before_train=1.693423 (no previous merge yet)
[S16] round=19 local utility u=0.169762 metrics={'f1_val': 0.8176918777145257, 'auprc': 0.9131215529511507, 'loss_val': 0.371131846508908, 'psi': 0.8558637478091757}-{'f1_val': 0.8307739137996837, 'auprc': 0.8409920225582447, 'loss_val': 0.5727599423718076, 'psi': 0.8348611573031081}
[S17] START round=19 head_norm_before_train=1.074408 cos_to_last_merge=1.0000 (last merge round=18)
[S17] round=19 local utility u=0.000000 metrics={'f1_val': 0.36887814195465063, 'auprc': 0.8126000397233546, 'loss_val': 0.9071442248117219, 'psi': 0.5463669010621321}-{'f1_val': 0.410323683871142, 'auprc': 0.752179160687776, 'loss_val': 0.9019237250658942, 'psi': 0.5470658745977957}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:33215
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:33212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:33213
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:33216
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:33214
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:33217
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:33212
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] → sending delta(kind=head bytes=1794) to S4@127.0.0.1:33204
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S17@127.0.0.1:33217
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:33217
[S8] sending update (kind=head size=1794 to 1 peers)
[S13] sending update (kind=head size=1794 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1795 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1798) from S16
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.723468)
[S17] loaded HEAD from S16 (vec_in norm=1.723468)
[S17] cosine check vs S16: cos=0.7653
[S17] BUFFERED delta from S16 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1794) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.989327)
[S17] loaded HEAD from S8 (vec_in norm=1.989327)
[S17] cosine check vs S8: cos=0.5340
[S17] BUFFERED delta from S8 (total buffered=2)
[S17] RECEIVED delta(kind=head bytes=1797) from S9
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.161760)
[S17] loaded HEAD from S9 (vec_in norm=1.161760)
[S17] cosine check vs S9: cos=0.6210
[S17] BUFFERED delta from S9 (total buffered=3)
[S4] RECEIVED delta(kind=head bytes=1794) from S13
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.140032)
[S4] loaded HEAD from S13 (vec_in norm=1.140032)
[S4] cosine check vs S13: cos=0.9426
[S4] BUFFERED delta from S13 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1803) from S11
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.398869)
[S13] loaded HEAD from S11 (vec_in norm=1.398869)
[S13] cosine check vs S11: cos=0.5934
[S13] BUFFERED delta from S11 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1797) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.770792)
[S11] loaded HEAD from S6 (vec_in norm=1.770792)
[S11] cosine check vs S6: cos=0.4807
[S11] BUFFERED delta from S6 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1802) from S15
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.800988)
[S11] loaded HEAD from S15 (vec_in norm=1.800988)
[S11] cosine check vs S15: cos=0.8935
[S11] BUFFERED delta from S15 (total buffered=2)
[S14] RECEIVED delta(kind=head bytes=1803) from S7
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.372055)
[S14] loaded HEAD from S7 (vec_in norm=1.372055)
[S14] cosine check vs S7: cos=0.9630
[S14] BUFFERED delta from S7 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1795) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.393711)
[S15] loaded HEAD from S14 (vec_in norm=1.393711)
[S15] cosine check vs S14: cos=-0.0333
[S15] DROPPED delta from S14 (cos=-0.0333 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1801) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.335559)
[S16] loaded HEAD from S5 (vec_in norm=1.335559)
[S16] cosine check vs S5: cos=-0.1361
[S16] DROPPED delta from S5 (cos=-0.1361 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] r=20 psi=0.995 u=0.0000 p_local=0.0663 f1=0.995 auprc=0.994 bytes=25183
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=19 metric=0.9418 head_norm=1.233527
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.063263e-01
[S4] stored merged vector for next round verification (round=19)
[S4] DEBUG after merge:  round=19 metric=0.9419 head_norm=1.169641 delta_norm=0.206326
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S4] r=20 psi=0.937 u=0.0000 p_local=0.0787 f1=0.942 auprc=0.929 bytes=25116
[S2] r=20 psi=0.655 u=0.0000 p_local=0.2911 f1=0.625 auprc=0.699 bytes=19763
[S3] r=20 psi=0.800 u=0.0000 p_local=0.1621 f1=0.700 auprc=0.952 bytes=19753
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=19 metric=0.5986 head_norm=1.140032
[S13] _apply_head_vector_avg (torch): Δ‖w‖=5.839054e-01
[S13] stored merged vector for next round verification (round=19)
[S13] DEBUG after merge:  round=19 metric=0.5979 head_norm=1.134596 delta_norm=0.583905
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S13] r=20 psi=0.574 u=0.2233 p_local=0.1241 f1=0.599 auprc=0.536 bytes=17950
[S15] r=20 psi=0.997 u=0.1901 p_local=0.1774 f1=0.997 auprc=0.997 bytes=21613
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=19 metric=0.9968 head_norm=1.393711
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.884050e-01
[S14] stored merged vector for next round verification (round=19)
[S14] DEBUG after merge:  round=19 metric=0.9973 head_norm=1.370032 delta_norm=0.188405
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] r=20 psi=0.997 u=0.0534 p_local=0.0996 f1=0.997 auprc=0.997 bytes=19744
[S6] r=20 psi=0.960 u=1.0000 p_local=0.3713 f1=0.957 auprc=0.965 bytes=21594
[S9] r=20 psi=0.995 u=0.0815 p_local=0.1904 f1=0.995 auprc=0.995 bytes=23351
[S5] r=20 psi=0.815 u=0.6273 p_local=0.2667 f1=0.701 auprc=0.986 bytes=26922
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=19 metric=0.9805 head_norm=1.398869
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.227190e-01
[S11] stored merged vector for next round verification (round=19)
[S11] DEBUG after merge:  round=19 metric=0.9586 head_norm=1.330584 delta_norm=0.222719
[S11] aggregate: ROLLBACK (f1_val pre=0.981 post=0.959 tol_abs=0.005 tol_rel=0.0)
[S11] r=20 psi=0.987 u=0.0657 p_local=0.2141 f1=0.981 auprc=0.996 bytes=26963
[S7] r=20 psi=0.635 u=0.0979 p_local=0.2344 f1=0.536 auprc=0.783 bytes=28752
[S16] r=20 psi=0.856 u=0.1698 p_local=0.2425 f1=0.818 auprc=0.913 bytes=25149
[S8] r=20 psi=0.843 u=0.1538 p_local=0.0761 f1=0.739 auprc=0.999 bytes=28769
[S17] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=19 metric=0.3689 head_norm=1.129329
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.529730e-01
[S17] stored merged vector for next round verification (round=19)
[S17] DEBUG after merge:  round=19 metric=0.3636 head_norm=1.065860 delta_norm=0.252973
[S17] aggregate: ROLLBACK (f1_val pre=0.369 post=0.364 tol_abs=0.005 tol_rel=0.0)
[S17] r=20 psi=0.546 u=0.0000 p_local=0.0874 f1=0.369 auprc=0.813 bytes=17982
[S2] START round=20 head_norm_before_train=1.603175 cos_to_last_merge=0.8408 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.841
[S2] round=20 local utility u=0.132275 metrics={'f1_val': 0.6456938893518755, 'auprc': 0.7437833000668758, 'loss_val': 0.9522007336116382, 'psi': 0.6849296536378756}-{'f1_val': 0.6248520154740906, 'auprc': 0.6989969453615092, 'loss_val': 0.9573407965821222, 'psi': 0.6545099874290581}
[S3] START round=20 head_norm_before_train=1.027302 cos_to_last_merge=0.9981 (last merge round=18)
[S3] round=20 local utility u=0.088178 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9755766241129725, 'loss_val': 0.4220908272496715, 'psi': 0.8106843718863688}-{'f1_val': 0.6995786553134029, 'auprc': 0.9516231024217601, 'loss_val': 0.5195210652838325, 'psi': 0.8003964341567458}
[S4] START round=20 head_norm_before_train=1.169641 cos_to_last_merge=1.0000 (last merge round=19)
[S4] round=20 local utility u=0.035986 metrics={'f1_val': 0.9435204045998817, 'auprc': 0.9525314564136094, 'loss_val': 0.30354766778728465, 'psi': 0.9471248253253728}-{'f1_val': 0.9418139735561961, 'auprc': 0.9286201946775007, 'loss_val': 0.2935467850944799, 'psi': 0.936536462004718}
[S5] START round=20 head_norm_before_train=1.335559 cos_to_last_merge=0.8134 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.813
[S5] round=20 local utility u=0.000000 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.8547991232612474, 'loss_val': 0.3393715005672539, 'psi': 0.7622846849021035}-{'f1_val': 0.7006090940057808, 'auprc': 0.9858789308683673, 'loss_val': 0.3121241055200335, 'psi': 0.8147170287508154}
[S6] START round=20 head_norm_before_train=1.770792 (no previous merge yet)
[S6] round=20 local utility u=0.000000 metrics={'f1_val': 0.6041340034144669, 'auprc': 0.8025591268537049, 'loss_val': 0.9522645566995711, 'psi': 0.6835040527901621}-{'f1_val': 0.9574869983638192, 'auprc': 0.9647585579735135, 'loss_val': 0.1739238979862276, 'psi': 0.9603956222076969}
[S7] START round=20 head_norm_before_train=1.372055 cos_to_last_merge=0.8339 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.834
[S7] round=20 local utility u=0.430243 metrics={'f1_val': 0.6257611479255341, 'auprc': 0.8150480605762597, 'loss_val': 0.5819756047063984, 'psi': 0.7014759129858243}-{'f1_val': 0.5361030006352249, 'auprc': 0.7833397874195525, 'loss_val': 0.8093879987005259, 'psi': 0.6349977153489559}
[S8] START round=20 head_norm_before_train=1.989327 (no previous merge yet)
[S8] round=20 local utility u=0.881508 metrics={'f1_val': 0.9843044951922839, 'auprc': 0.9987034575445577, 'loss_val': 0.05527741379823657, 'psi': 0.9900640801331935}-{'f1_val': 0.7388970843614528, 'auprc': 0.9986997851145238, 'loss_val': 0.3458374786547262, 'psi': 0.8428181646626813}
[S9] START round=20 head_norm_before_train=1.161760 cos_to_last_merge=0.9980 (last merge round=18)
[S9] round=20 local utility u=0.021640 metrics={'f1_val': 0.992904783397339, 'auprc': 0.9961889458199005, 'loss_val': 0.16105461075200223, 'psi': 0.9942184483663636}-{'f1_val': 0.9954158325366191, 'auprc': 0.9951223823818002, 'loss_val': 0.21620180302412956, 'psi': 0.9952984524746915}
[S10] START round=20 head_norm_before_train=1.296832 cos_to_last_merge=0.9938 (last merge round=18)
[S10] round=20 local utility u=0.017423 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9921257256680914, 'loss_val': 0.11756367710656554, 'psi': 0.9939629936788614}-{'f1_val': 0.9949681865317428, 'auprc': 0.9940655499097693, 'loss_val': 0.15691041009039702, 'psi': 0.9946071318829535}
[S11] START round=20 head_norm_before_train=1.330584 cos_to_last_merge=1.0000 (last merge round=19)
[S11] round=20 local utility u=0.080912 metrics={'f1_val': 0.9958874089635285, 'auprc': 0.9978130544452655, 'loss_val': 0.24275970225950477, 'psi': 0.9966576671562233}-{'f1_val': 0.9805090036601898, 'auprc': 0.9961226851111473, 'loss_val': 0.30724197082623084, 'psi': 0.9867544762405728}
[S13] START round=20 head_norm_before_train=1.134596 cos_to_last_merge=1.0000 (last merge round=19)
[S13] round=20 local utility u=0.000000 metrics={'f1_val': 0.5070583541766842, 'auprc': 0.5263938315950689, 'loss_val': 1.0346699011469849, 'psi': 0.514792545144038}-{'f1_val': 0.5985753581657752, 'auprc': 0.5359361116357384, 'loss_val': 0.7967636577246963, 'psi': 0.5735196595537605}
[S14] START round=20 head_norm_before_train=1.370032 cos_to_last_merge=1.0000 (last merge round=19)
[S14] round=20 local utility u=0.000000 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9956292670610967, 'loss_val': 0.2529816569345934, 'psi': 0.9968423776543508}-{'f1_val': 0.9968300801588782, 'auprc': 0.9974565920448892, 'loss_val': 0.23668609984752287, 'psi': 0.9970806849132825}
[S15] START round=20 head_norm_before_train=1.800988 cos_to_last_merge=0.8386 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.839
[S15] round=20 local utility u=0.000000 metrics={'f1_val': 0.8002032439461246, 'auprc': 0.9929157594862388, 'loss_val': 0.2830153264652017, 'psi': 0.8772882501621703}-{'f1_val': 0.9967466683875206, 'auprc': 0.9967889399834984, 'loss_val': 0.03230520399081165, 'psi': 0.9967635770259117}
[S16] START round=20 head_norm_before_train=1.723468 (no previous merge yet)
[S16] round=20 local utility u=0.128932 metrics={'f1_val': 0.8461544461328845, 'auprc': 0.9244146469826282, 'loss_val': 0.31792261234419333, 'psi': 0.8774585264727819}-{'f1_val': 0.8176918777145257, 'auprc': 0.9131215529511507, 'loss_val': 0.371131846508908, 'psi': 0.8558637478091757}
[S17] START round=20 head_norm_before_train=1.065860 cos_to_last_merge=1.0000 (last merge round=19)
[S17] round=20 local utility u=0.176736 metrics={'f1_val': 0.4263781124095452, 'auprc': 0.7977412774838362, 'loss_val': 0.8540955567476636, 'psi': 0.5749233784392616}-{'f1_val': 0.36887814195465063, 'auprc': 0.8126000397233546, 'loss_val': 0.9071442248117219, 'psi': 0.5463669010621321}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S13@127.0.0.1:33213
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] → sending delta(kind=head bytes=1805) to S17@127.0.0.1:33217
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:33203
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:33217
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:33214
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S3] → sending delta(kind=head bytes=1790) to S9@127.0.0.1:33210
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:33217
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:33213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:33211
[S4] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S16] sending update (kind=head size=1805 to 1 peers)
[S11] sending update (kind=head size=1794 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1800) from S2
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.625482)
[S13] loaded HEAD from S2 (vec_in norm=1.625482)
[S13] cosine check vs S2: cos=0.3470
[S13] BUFFERED delta from S2 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1795) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.998567)
[S17] loaded HEAD from S8 (vec_in norm=1.998567)
[S17] cosine check vs S8: cos=0.6671
[S17] BUFFERED delta from S8 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1799) from S9
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.211818)
[S17] loaded HEAD from S9 (vec_in norm=1.211818)
[S17] cosine check vs S9: cos=0.7102
[S17] BUFFERED delta from S9 (total buffered=2)
[S17] RECEIVED delta(kind=head bytes=1805) from S16
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.752700)
[S17] loaded HEAD from S16 (vec_in norm=1.752700)
[S17] cosine check vs S16: cos=0.6362
[S17] BUFFERED delta from S16 (total buffered=3)
[S3] RECEIVED delta(kind=head bytes=1797) from S10
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.371711)
[S3] loaded HEAD from S10 (vec_in norm=1.371711)
[S3] cosine check vs S10: cos=0.7106
[S3] BUFFERED delta from S10 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1802) from S7
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.385671)
[S14] loaded HEAD from S7 (vec_in norm=1.385671)
[S14] cosine check vs S7: cos=0.9787
[S14] BUFFERED delta from S7 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1803) from S4
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.235232)
[S10] loaded HEAD from S4 (vec_in norm=1.235232)
[S10] cosine check vs S4: cos=0.8734
[S10] BUFFERED delta from S4 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1794) from S11
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.361785)
[S13] loaded HEAD from S11 (vec_in norm=1.361785)
[S13] cosine check vs S11: cos=0.9320
[S13] BUFFERED delta from S11 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:33203
[S17] sending update (kind=head size=1798 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1798) from S17
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.129028)
[S3] loaded HEAD from S17 (vec_in norm=1.129028)
[S3] cosine check vs S17: cos=0.8768
[S3] BUFFERED delta from S17 (total buffered=2)
[S3] sending update (kind=head size=1790 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1790) from S3
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.071719)
[S9] loaded HEAD from S3 (vec_in norm=1.071719)
[S9] cosine check vs S3: cos=0.9233
[S9] BUFFERED delta from S3 (total buffered=1)
[S5] ⇄ pheromone p=0.213 → S16@127.0.0.1:33216
[S6] ⇄ pheromone p=0.297 → S11@127.0.0.1:33212
[S8] ⇄ pheromone p=0.237 → S17@127.0.0.1:33217
[S7] ⇄ pheromone p=0.274 → S14@127.0.0.1:33214
[S2] ⇄ pheromone p=0.259 → S13@127.0.0.1:33213
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=20 metric=0.9952 head_norm=1.371711
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.345926e-01
[S10] stored merged vector for next round verification (round=20)
[S10] DEBUG after merge:  round=20 metric=0.9952 head_norm=1.261643 delta_norm=0.334593
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.057 → S3@127.0.0.1:33203
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=20 metric=0.9929 head_norm=1.211818
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.338553e-01
[S9] stored merged vector for next round verification (round=20)
[S9] DEBUG after merge:  round=20 metric=0.9925 head_norm=1.119756 delta_norm=0.233855
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.157 → S17@127.0.0.1:33217
[S11] ⇄ pheromone p=0.187 → S13@127.0.0.1:33213
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=20 metric=0.9977 head_norm=1.405112
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.442607e-01
[S14] stored merged vector for next round verification (round=20)
[S14] DEBUG after merge:  round=20 metric=0.9977 head_norm=1.387949 delta_norm=0.144261
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.080 → S15@127.0.0.1:33215
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=20 metric=0.7008 head_norm=1.071719
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.795955e-01
[S3] stored merged vector for next round verification (round=20)
[S3] DEBUG after merge:  round=20 metric=0.7008 head_norm=1.041645 delta_norm=0.179595
[S3] aggregate: ACCEPT kept=['S10', 'S17'] (k=2/2) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.147 → S9@127.0.0.1:33210
[S15] ⇄ pheromone p=0.142 → S11@127.0.0.1:33212
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=20 metric=0.5071 head_norm=1.166940
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.061934e-01
[S13] stored merged vector for next round verification (round=20)
[S13] DEBUG after merge:  round=20 metric=0.5078 head_norm=1.078597 delta_norm=0.306193
[S13] aggregate: ACCEPT kept=['S2', 'S11'] (k=2/2) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.099 → S4@127.0.0.1:33204
[S16] ⇄ pheromone p=0.220 → S17@127.0.0.1:33217
[S4] ⇄ pheromone p=0.070 → S10@127.0.0.1:33211
[S17] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=20 metric=0.4264 head_norm=1.129028
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.550857e-01
[S17] stored merged vector for next round verification (round=20)
[S17] DEBUG after merge:  round=20 metric=0.4198 head_norm=1.097918 delta_norm=0.155086
[S17] aggregate: ROLLBACK (f1_val pre=0.426 post=0.420 tol_abs=0.005 tol_rel=0.0)
[S17] ⇄ pheromone p=0.105 → S3@127.0.0.1:33203
[S2] START round=21 head_norm_before_train=1.625482 cos_to_last_merge=0.8391 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.839
[S2] round=21 local utility u=0.000000 metrics={'f1_val': 0.6397688752373717, 'auprc': 0.7346285395979633, 'loss_val': 1.0899865476029422, 'psi': 0.6777127409816084}-{'f1_val': 0.6456938893518755, 'auprc': 0.7437833000668758, 'loss_val': 0.9522007336116382, 'psi': 0.6849296536378756}
[S3] START round=21 head_norm_before_train=1.041645 cos_to_last_merge=1.0000 (last merge round=20)
[S3] round=21 local utility u=0.043120 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9978012288141546, 'loss_val': 0.40252428101277965, 'psi': 0.8195742137668416}-{'f1_val': 0.7007562037352997, 'auprc': 0.9755766241129725, 'loss_val': 0.4220908272496715, 'psi': 0.8106843718863688}
[S4] START round=21 head_norm_before_train=1.235232 cos_to_last_merge=0.9958 (last merge round=19)
[S4] round=21 local utility u=0.000000 metrics={'f1_val': 0.9412056426653285, 'auprc': 0.9410090423708701, 'loss_val': 0.2863149645774595, 'psi': 0.9411270025475451}-{'f1_val': 0.9435204045998817, 'auprc': 0.9525314564136094, 'loss_val': 0.30354766778728465, 'psi': 0.9471248253253728}
[S5] START round=21 head_norm_before_train=1.354802 cos_to_last_merge=0.8054 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.805
[S5] round=21 local utility u=0.227676 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9875745937221205, 'loss_val': 0.2823450654817062, 'psi': 0.8153948730864529}-{'f1_val': 0.7006083926626743, 'auprc': 0.8547991232612474, 'loss_val': 0.3393715005672539, 'psi': 0.7622846849021035}
[S6] START round=21 head_norm_before_train=1.780170 (no previous merge yet)
[S6] round=21 local utility u=1.000000 metrics={'f1_val': 0.8362183266403906, 'auprc': 0.9317269796884831, 'loss_val': 0.5024649972721, 'psi': 0.8744217878596275}-{'f1_val': 0.6041340034144669, 'auprc': 0.8025591268537049, 'loss_val': 0.9522645566995711, 'psi': 0.6835040527901621}
[S7] START round=21 head_norm_before_train=1.385671 cos_to_last_merge=0.8312 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.831
[S7] round=21 local utility u=0.381381 metrics={'f1_val': 0.6839022017489234, 'auprc': 0.8872011953007541, 'loss_val': 0.384519388255546, 'psi': 0.7652217991696557}-{'f1_val': 0.6257611479255341, 'auprc': 0.8150480605762597, 'loss_val': 0.5819756047063984, 'psi': 0.7014759129858243}
[S8] START round=21 head_norm_before_train=1.998567 (no previous merge yet)
[S8] round=21 local utility u=0.043364 metrics={'f1_val': 0.994792642153961, 'auprc': 0.9988115821080203, 'loss_val': 0.031801851328370746, 'psi': 0.9964002181355848}-{'f1_val': 0.9843044951922839, 'auprc': 0.9987034575445577, 'loss_val': 0.05527741379823657, 'psi': 0.9900640801331935}
[S9] START round=21 head_norm_before_train=1.119756 cos_to_last_merge=1.0000 (last merge round=20)
[S9] round=21 local utility u=0.008692 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.99721209217452, 'loss_val': 0.16927480591711253, 'psi': 0.9968811439581429}-{'f1_val': 0.992904783397339, 'auprc': 0.9961889458199005, 'loss_val': 0.16105461075200223, 'psi': 0.9942184483663636}
[S10] START round=21 head_norm_before_train=1.261643 cos_to_last_merge=1.0000 (last merge round=20)
[S10] round=21 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9934460729138067, 'loss_val': 0.15463751883149396, 'psi': 0.9944911325771475}-{'f1_val': 0.9951878390193748, 'auprc': 0.9921257256680914, 'loss_val': 0.11756367710656554, 'psi': 0.9939629936788614}
[S11] START round=21 head_norm_before_train=1.361785 cos_to_last_merge=0.9990 (last merge round=19)
[S11] round=21 local utility u=0.014310 metrics={'f1_val': 0.9967887165093644, 'auprc': 0.9961561210229996, 'loss_val': 0.21457653308887126, 'psi': 0.9965356783148185}-{'f1_val': 0.9958874089635285, 'auprc': 0.9978130544452655, 'loss_val': 0.24275970225950477, 'psi': 0.9966576671562233}
[S13] START round=21 head_norm_before_train=1.078597 cos_to_last_merge=1.0000 (last merge round=20)
[S13] round=21 local utility u=0.451517 metrics={'f1_val': 0.5653205618368254, 'auprc': 0.6582505079287129, 'loss_val': 0.8767788428664798, 'psi': 0.6024925402735803}-{'f1_val': 0.5070583541766842, 'auprc': 0.5263938315950689, 'loss_val': 1.0346699011469849, 'psi': 0.514792545144038}
[S14] START round=21 head_norm_before_train=1.387949 cos_to_last_merge=1.0000 (last merge round=20)
[S14] round=21 local utility u=0.000823 metrics={'f1_val': 0.9974055297193176, 'auprc': 0.9959734410916744, 'loss_val': 0.25089445992004983, 'psi': 0.9968326942682604}-{'f1_val': 0.9976511180498535, 'auprc': 0.9956292670610967, 'loss_val': 0.2529816569345934, 'psi': 0.9968423776543508}
[S15] START round=21 head_norm_before_train=1.823164 cos_to_last_merge=0.8366 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.837
[S15] round=21 local utility u=0.728442 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9985333607178303, 'loss_val': 0.022245298801651235, 'psi': 0.9974613453196445}-{'f1_val': 0.8002032439461246, 'auprc': 0.9929157594862388, 'loss_val': 0.2830153264652017, 'psi': 0.8772882501621703}
[S16] START round=21 head_norm_before_train=1.752700 (no previous merge yet)
[S16] round=21 local utility u=0.000000 metrics={'f1_val': 0.8308243372306598, 'auprc': 0.9214381487388095, 'loss_val': 0.6954636836594185, 'psi': 0.8670698618339197}-{'f1_val': 0.8461544461328845, 'auprc': 0.9244146469826282, 'loss_val': 0.31792261234419333, 'psi': 0.8774585264727819}
[S17] START round=21 head_norm_before_train=1.097918 cos_to_last_merge=1.0000 (last merge round=20)
[S17] round=21 local utility u=0.795541 metrics={'f1_val': 0.6687862517597143, 'auprc': 0.8653974579279993, 'loss_val': 0.9204307093032527, 'psi': 0.7474307342270283}-{'f1_val': 0.4263781124095452, 'auprc': 0.7977412774838362, 'loss_val': 0.8540955567476636, 'psi': 0.5749233784392616}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] → sending delta(kind=head bytes=1793) to S13@127.0.0.1:33213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S7] → sending delta(kind=head bytes=1808) to S14@127.0.0.1:33214
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:33217
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:33216
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:33215
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] → sending delta(kind=head bytes=1793) to S9@127.0.0.1:33210
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:33217
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:33212
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:33212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:33204
[S13] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1808 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1793 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1793 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1797) from S9
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.169483)
[S17] loaded HEAD from S9 (vec_in norm=1.169483)
[S17] cosine check vs S9: cos=0.8290
[S17] BUFFERED delta from S9 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1793) from S3
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.085471)
[S9] loaded HEAD from S3 (vec_in norm=1.085471)
[S9] cosine check vs S3: cos=0.9687
[S9] BUFFERED delta from S3 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1800) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=2.011317)
[S17] loaded HEAD from S8 (vec_in norm=2.011317)
[S17] cosine check vs S8: cos=0.7199
[S17] BUFFERED delta from S8 (total buffered=2)
[S4] RECEIVED delta(kind=head bytes=1800) from S13
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.126850)
[S4] loaded HEAD from S13 (vec_in norm=1.126850)
[S4] cosine check vs S13: cos=0.8991
[S4] BUFFERED delta from S13 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1793) from S11
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.394724)
[S13] loaded HEAD from S11 (vec_in norm=1.394724)
[S13] cosine check vs S11: cos=0.8249
[S13] BUFFERED delta from S11 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1802) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.794372)
[S11] loaded HEAD from S6 (vec_in norm=1.794372)
[S11] cosine check vs S6: cos=0.6149
[S11] BUFFERED delta from S6 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1808) from S7
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.396438)
[S14] loaded HEAD from S7 (vec_in norm=1.396438)
[S14] cosine check vs S7: cos=0.9851
[S14] BUFFERED delta from S7 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1803) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.376878)
[S16] loaded HEAD from S5 (vec_in norm=1.376878)
[S16] cosine check vs S5: cos=-0.1301
[S16] DROPPED delta from S5 (cos=-0.1301 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1799) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.419091)
[S15] loaded HEAD from S14 (vec_in norm=1.419091)
[S15] cosine check vs S14: cos=-0.0426
[S15] DROPPED delta from S14 (cos=-0.0426 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1796) from S15
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.843391)
[S11] loaded HEAD from S15 (vec_in norm=1.843391)
[S11] cosine check vs S15: cos=0.8091
[S11] BUFFERED delta from S15 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:33203
[S17] sending update (kind=head size=1799 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1799) from S17
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.153776)
[S3] loaded HEAD from S17 (vec_in norm=1.153776)
[S3] cosine check vs S17: cos=0.8590
[S3] BUFFERED delta from S17 (total buffered=1)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=21 metric=0.9412 head_norm=1.297373
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.845871e-01
[S4] stored merged vector for next round verification (round=21)
[S4] DEBUG after merge:  round=21 metric=0.9411 head_norm=1.181310 delta_norm=0.284587
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=21 metric=0.7008 head_norm=1.085471
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.991048e-01
[S3] stored merged vector for next round verification (round=21)
[S3] DEBUG after merge:  round=21 metric=0.7008 head_norm=1.079472 delta_norm=0.299105
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=21 metric=0.9968 head_norm=1.394724
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.379775e-01
[S11] stored merged vector for next round verification (round=21)
[S11] DEBUG after merge:  round=21 metric=0.9968 head_norm=1.352222 delta_norm=0.137977
[S11] aggregate: ACCEPT kept=['S6', 'S15'] (k=2/2) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=21 metric=0.5653 head_norm=1.126850
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.943347e-01
[S13] stored merged vector for next round verification (round=21)
[S13] DEBUG after merge:  round=21 metric=0.5650 head_norm=1.204999 delta_norm=0.394335
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=21 metric=0.9974 head_norm=1.419091
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.220837e-01
[S14] stored merged vector for next round verification (round=21)
[S14] DEBUG after merge:  round=21 metric=0.9962 head_norm=1.402506 delta_norm=0.122084
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=21 metric=0.9967 head_norm=1.169483
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.471207e-01
[S9] stored merged vector for next round verification (round=21)
[S9] DEBUG after merge:  round=21 metric=0.9967 head_norm=1.118626 delta_norm=0.147121
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=21 metric=0.6688 head_norm=1.153776
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.407684e-01
[S17] stored merged vector for next round verification (round=21)
[S17] DEBUG after merge:  round=21 metric=0.4012 head_norm=1.229107 delta_norm=0.340768
[S17] aggregate: ROLLBACK (f1_val pre=0.669 post=0.401 tol_abs=0.005 tol_rel=0.0)
[S2] START round=22 head_norm_before_train=1.650171 cos_to_last_merge=0.8369 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.837
[S2] round=22 local utility u=0.000000 metrics={'f1_val': 0.6443158469477882, 'auprc': 0.7342082556605007, 'loss_val': 1.117370065700555, 'psi': 0.6802728104328732}-{'f1_val': 0.6397688752373717, 'auprc': 0.7346285395979633, 'loss_val': 1.0899865476029422, 'psi': 0.6777127409816084}
[S3] START round=22 head_norm_before_train=1.079472 cos_to_last_merge=1.0000 (last merge round=21)
[S3] round=22 local utility u=0.000000 metrics={'f1_val': 0.7003512381127298, 'auprc': 0.9036751140365185, 'loss_val': 0.40161587184311864, 'psi': 0.7816807884822452}-{'f1_val': 0.7007562037352997, 'auprc': 0.9978012288141546, 'loss_val': 0.40252428101277965, 'psi': 0.8195742137668416}
[S4] START round=22 head_norm_before_train=1.181310 cos_to_last_merge=1.0000 (last merge round=21)
[S4] round=22 local utility u=0.000212 metrics={'f1_val': 0.9402637963458447, 'auprc': 0.951180264098682, 'loss_val': 0.3107534626756017, 'psi': 0.9446303834469796}-{'f1_val': 0.9412056426653285, 'auprc': 0.9410090423708701, 'loss_val': 0.2863149645774595, 'psi': 0.9411270025475451}
[S5] START round=22 head_norm_before_train=1.376878 cos_to_last_merge=0.7948 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.795
[S5] round=22 local utility u=0.000000 metrics={'f1_val': 0.44008443944238296, 'auprc': 0.837086719564438, 'loss_val': 0.7020333642977378, 'psi': 0.598885351491205}-{'f1_val': 0.7006083926626743, 'auprc': 0.9875745937221205, 'loss_val': 0.2823450654817062, 'psi': 0.8153948730864529}
[S6] START round=22 head_norm_before_train=1.794372 (no previous merge yet)
[S6] round=22 local utility u=0.541684 metrics={'f1_val': 0.9510595068501807, 'auprc': 0.9647935065365216, 'loss_val': 0.20734463974760842, 'psi': 0.956553106724717}-{'f1_val': 0.8362183266403906, 'auprc': 0.9317269796884831, 'loss_val': 0.5024649972721, 'psi': 0.8744217878596275}
[S7] START round=22 head_norm_before_train=1.396438 cos_to_last_merge=0.8289 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.829
[S7] round=22 local utility u=0.000000 metrics={'f1_val': 0.40837003186597165, 'auprc': 0.7513189845859974, 'loss_val': 1.1494450912751006, 'psi': 0.545549612953982}-{'f1_val': 0.6839022017489234, 'auprc': 0.8872011953007541, 'loss_val': 0.384519388255546, 'psi': 0.7652217991696557}
[S8] START round=22 head_norm_before_train=2.011317 (no previous merge yet)
[S8] round=22 local utility u=0.000000 metrics={'f1_val': 0.9908644703267051, 'auprc': 0.9987405970722621, 'loss_val': 0.03719251262053352, 'psi': 0.9940149210249278}-{'f1_val': 0.994792642153961, 'auprc': 0.9988115821080203, 'loss_val': 0.031801851328370746, 'psi': 0.9964002181355848}
[S9] START round=22 head_norm_before_train=1.118626 cos_to_last_merge=1.0000 (last merge round=21)
[S9] round=22 local utility u=0.000000 metrics={'f1_val': 0.9937421749897083, 'auprc': 0.9978068060154901, 'loss_val': 0.16907491927738996, 'psi': 0.9953680274000211}-{'f1_val': 0.9966605118138915, 'auprc': 0.99721209217452, 'loss_val': 0.16927480591711253, 'psi': 0.9968811439581429}
[S10] START round=22 head_norm_before_train=1.324253 cos_to_last_merge=0.9969 (last merge round=20)
[S10] round=22 local utility u=0.027842 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9960795157499885, 'loss_val': 0.10553545255809656, 'psi': 0.9954127182190411}-{'f1_val': 0.9951878390193748, 'auprc': 0.9934460729138067, 'loss_val': 0.15463751883149396, 'psi': 0.9944911325771475}
[S11] START round=22 head_norm_before_train=1.352222 cos_to_last_merge=1.0000 (last merge round=21)
[S11] round=22 local utility u=0.023814 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9977361413354939, 'loss_val': 0.17023754797379131, 'psi': 0.9970226592423513}-{'f1_val': 0.9967887165093644, 'auprc': 0.9961561210229996, 'loss_val': 0.21457653308887126, 'psi': 0.9965356783148185}
[S13] START round=22 head_norm_before_train=1.204999 cos_to_last_merge=1.0000 (last merge round=21)
[S13] round=22 local utility u=0.000000 metrics={'f1_val': 0.540313315787037, 'auprc': 0.6935791443973086, 'loss_val': 0.9418687210119651, 'psi': 0.6016196472311457}-{'f1_val': 0.5653205618368254, 'auprc': 0.6582505079287129, 'loss_val': 0.8767788428664798, 'psi': 0.6024925402735803}
[S14] START round=22 head_norm_before_train=1.402506 cos_to_last_merge=1.0000 (last merge round=21)
[S14] round=22 local utility u=0.008709 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9956311933894153, 'loss_val': 0.2300013308710244, 'psi': 0.9964509822503651}-{'f1_val': 0.9974055297193176, 'auprc': 0.9959734410916744, 'loss_val': 0.25089445992004983, 'psi': 0.9968326942682604}
[S15] START round=22 head_norm_before_train=1.843391 cos_to_last_merge=0.8345 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.834
[S15] round=22 local utility u=0.000000 metrics={'f1_val': 0.7095612070999026, 'auprc': 0.868649716316674, 'loss_val': 0.4664230513257614, 'psi': 0.7731966107866111}-{'f1_val': 0.9967466683875206, 'auprc': 0.9985333607178303, 'loss_val': 0.022245298801651235, 'psi': 0.9974613453196445}
[S16] START round=22 head_norm_before_train=1.782889 (no previous merge yet)
[S16] round=22 local utility u=0.465138 metrics={'f1_val': 0.9102680670617413, 'auprc': 0.9507387228456999, 'loss_val': 0.32975231753663925, 'psi': 0.9264563293753247}-{'f1_val': 0.8308243372306598, 'auprc': 0.9214381487388095, 'loss_val': 0.6954636836594185, 'psi': 0.8670698618339197}
[S17] START round=22 head_norm_before_train=1.229107 cos_to_last_merge=1.0000 (last merge round=21)
[S17] round=22 local utility u=0.005821 metrics={'f1_val': 0.6245591814465772, 'auprc': 0.8939378741279416, 'loss_val': 0.7290466040195878, 'psi': 0.732310658519123}-{'f1_val': 0.6687862517597143, 'auprc': 0.8653974579279993, 'loss_val': 0.9204307093032527, 'psi': 0.7474307342270283}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:33217
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:33211
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:33212
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:33213
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:33215
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:33203
[S10] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1803 to 1 peers)
[S16] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1801) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.807317)
[S11] loaded HEAD from S6 (vec_in norm=1.807317)
[S11] cosine check vs S6: cos=0.6713
[S11] BUFFERED delta from S6 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1802) from S10
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.388526)
[S3] loaded HEAD from S10 (vec_in norm=1.388526)
[S3] cosine check vs S10: cos=0.5944
[S3] BUFFERED delta from S10 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1803) from S16
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.810954)
[S17] loaded HEAD from S16 (vec_in norm=1.810954)
[S17] cosine check vs S16: cos=0.3691
[S17] BUFFERED delta from S16 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1803) from S4
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.246348)
[S10] loaded HEAD from S4 (vec_in norm=1.246348)
[S10] cosine check vs S4: cos=0.9134
[S10] BUFFERED delta from S4 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1803) from S11
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.382834)
[S13] loaded HEAD from S11 (vec_in norm=1.382834)
[S13] cosine check vs S11: cos=0.9565
[S13] BUFFERED delta from S11 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1802) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.432893)
[S15] loaded HEAD from S14 (vec_in norm=1.432893)
[S15] cosine check vs S14: cos=-0.0449
[S15] DROPPED delta from S14 (cos=-0.0449 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:33203
[S17] sending update (kind=head size=1796 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1796) from S17
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.273563)
[S3] loaded HEAD from S17 (vec_in norm=1.273563)
[S3] cosine check vs S17: cos=0.9287
[S3] BUFFERED delta from S17 (total buffered=2)
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=22 metric=0.7004 head_norm=1.118185
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.340734e-01
[S3] stored merged vector for next round verification (round=22)
[S3] DEBUG after merge:  round=22 metric=0.7004 head_norm=1.085125 delta_norm=0.234073
[S3] aggregate: ACCEPT kept=['S10', 'S17'] (k=2/2) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=22 metric=0.5403 head_norm=1.251927
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.048528e-01
[S13] stored merged vector for next round verification (round=22)
[S13] DEBUG after merge:  round=22 metric=0.5375 head_norm=1.303001 delta_norm=0.204853
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=22 metric=0.9965 head_norm=1.382834
[S11] _apply_head_vector_avg (torch): Δ‖w‖=6.751405e-01
[S11] stored merged vector for next round verification (round=22)
[S11] DEBUG after merge:  round=22 metric=0.9965 head_norm=1.460649 delta_norm=0.675141
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=22 metric=0.9950 head_norm=1.388526
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.828804e-01
[S10] stored merged vector for next round verification (round=22)
[S10] DEBUG after merge:  round=22 metric=0.9947 head_norm=1.288671 delta_norm=0.282880
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=22 metric=0.6246 head_norm=1.273563
[S17] _apply_head_vector_avg (torch): Δ‖w‖=8.943132e-01
[S17] stored merged vector for next round verification (round=22)
[S17] DEBUG after merge:  round=22 metric=0.6151 head_norm=1.284898 delta_norm=0.894313
[S17] aggregate: ROLLBACK (f1_val pre=0.625 post=0.615 tol_abs=0.005 tol_rel=0.0)
[S2] START round=23 head_norm_before_train=1.676146 cos_to_last_merge=0.8340 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.834
[S2] round=23 local utility u=0.000000 metrics={'f1_val': 0.5832915503144919, 'auprc': 0.7269406095579888, 'loss_val': 1.4447106236032508, 'psi': 0.6407511740118906}-{'f1_val': 0.6443158469477882, 'auprc': 0.7342082556605007, 'loss_val': 1.117370065700555, 'psi': 0.6802728104328732}
[S3] START round=23 head_norm_before_train=1.085125 cos_to_last_merge=1.0000 (last merge round=22)
[S3] round=23 local utility u=0.141533 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9878786891865705, 'loss_val': 0.3731384186643428, 'psi': 0.815560051473829}-{'f1_val': 0.7003512381127298, 'auprc': 0.9036751140365185, 'loss_val': 0.40161587184311864, 'psi': 0.7816807884822452}
[S4] START round=23 head_norm_before_train=1.246348 cos_to_last_merge=0.9968 (last merge round=21)
[S4] round=23 local utility u=0.024749 metrics={'f1_val': 0.9454446506987421, 'auprc': 0.9466638331505692, 'loss_val': 0.27879051099825136, 'psi': 0.945932323679473}-{'f1_val': 0.9402637963458447, 'auprc': 0.951180264098682, 'loss_val': 0.3107534626756017, 'psi': 0.9446303834469796}
[S5] START round=23 head_norm_before_train=1.402529 cos_to_last_merge=0.7822 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.782
[S5] round=23 local utility u=0.000000 metrics={'f1_val': 0.4478924428532851, 'auprc': 0.8025951243412173, 'loss_val': 0.7415573464288054, 'psi': 0.589773515448458}-{'f1_val': 0.44008443944238296, 'auprc': 0.837086719564438, 'loss_val': 0.7020333642977378, 'psi': 0.598885351491205}
[S6] START round=23 head_norm_before_train=1.807317 (no previous merge yet)
[S6] round=23 local utility u=0.000000 metrics={'f1_val': 0.6440298679970822, 'auprc': 0.8892670831710807, 'loss_val': 0.782391716294628, 'psi': 0.7421247540666815}-{'f1_val': 0.9510595068501807, 'auprc': 0.9647935065365216, 'loss_val': 0.20734463974760842, 'psi': 0.956553106724717}
[S7] START round=23 head_norm_before_train=1.405904 cos_to_last_merge=0.8268 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.827
[S7] round=23 local utility u=1.000000 metrics={'f1_val': 0.6409833179144535, 'auprc': 0.8156604488820661, 'loss_val': 0.5400215596452267, 'psi': 0.7108541703014986}-{'f1_val': 0.40837003186597165, 'auprc': 0.7513189845859974, 'loss_val': 1.1494450912751006, 'psi': 0.545549612953982}
[S8] START round=23 head_norm_before_train=2.026938 (no previous merge yet)
[S8] round=23 local utility u=0.000000 metrics={'f1_val': 0.9900973316212444, 'auprc': 0.998720661856719, 'loss_val': 0.036745967505854404, 'psi': 0.9935466637154342}-{'f1_val': 0.9908644703267051, 'auprc': 0.9987405970722621, 'loss_val': 0.03719251262053352, 'psi': 0.9940149210249278}
[S9] START round=23 head_norm_before_train=1.170482 cos_to_last_merge=0.9981 (last merge round=21)
[S9] round=23 local utility u=0.032550 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9980054779775365, 'loss_val': 0.12208125643319527, 'psi': 0.9971984982793495}-{'f1_val': 0.9937421749897083, 'auprc': 0.9978068060154901, 'loss_val': 0.16907491927738996, 'psi': 0.9953680274000211}
[S10] START round=23 head_norm_before_train=1.288671 cos_to_last_merge=1.0000 (last merge round=22)
[S10] round=23 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9935247088415895, 'loss_val': 0.13766759199854875, 'psi': 0.9945225869482606}-{'f1_val': 0.9949681865317428, 'auprc': 0.9960795157499885, 'loss_val': 0.10553545255809656, 'psi': 0.9954127182190411}
[S11] START round=23 head_norm_before_train=1.460649 cos_to_last_merge=1.0000 (last merge round=22)
[S11] round=23 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.996151247729907, 'loss_val': 0.19224617209856637, 'psi': 0.9961407040399484}-{'f1_val': 0.9965470045135896, 'auprc': 0.9977361413354939, 'loss_val': 0.17023754797379131, 'psi': 0.9970226592423513}
[S13] START round=23 head_norm_before_train=1.303001 cos_to_last_merge=1.0000 (last merge round=22)
[S13] round=23 local utility u=0.000000 metrics={'f1_val': 0.5319982965091294, 'auprc': 0.6910737515439483, 'loss_val': 0.9450256211710854, 'psi': 0.595628478523057}-{'f1_val': 0.540313315787037, 'auprc': 0.6935791443973086, 'loss_val': 0.9418687210119651, 'psi': 0.6016196472311457}
[S14] START round=23 head_norm_before_train=1.432893 cos_to_last_merge=0.9975 (last merge round=21)
[S14] round=23 local utility u=0.026884 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9956112271334383, 'loss_val': 0.1761725022907952, 'psi': 0.9964429957479743}-{'f1_val': 0.9969975081576651, 'auprc': 0.9956311933894153, 'loss_val': 0.2300013308710244, 'psi': 0.9964509822503651}
[S15] START round=23 head_norm_before_train=1.856982 cos_to_last_merge=0.8334 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.833
[S15] round=23 local utility u=0.191515 metrics={'f1_val': 0.7021604299989732, 'auprc': 0.9786641761976892, 'loss_val': 0.3690311068921589, 'psi': 0.8127619284784596}-{'f1_val': 0.7095612070999026, 'auprc': 0.868649716316674, 'loss_val': 0.4664230513257614, 'psi': 0.7731966107866111}
[S16] START round=23 head_norm_before_train=1.810954 (no previous merge yet)
[S16] round=23 local utility u=0.000000 metrics={'f1_val': 0.8447663954755364, 'auprc': 0.9502672196552238, 'loss_val': 0.6570558268617969, 'psi': 0.8869667251474114}-{'f1_val': 0.9102680670617413, 'auprc': 0.9507387228456999, 'loss_val': 0.32975231753663925, 'psi': 0.9264563293753247}
[S17] START round=23 head_norm_before_train=1.284898 cos_to_last_merge=1.0000 (last merge round=22)
[S17] round=23 local utility u=0.000000 metrics={'f1_val': 0.6316709565964436, 'auprc': 0.8595189616682568, 'loss_val': 0.8254718309144452, 'psi': 0.722810158625169}-{'f1_val': 0.6245591814465772, 'auprc': 0.8939378741279416, 'loss_val': 0.7290466040195878, 'psi': 0.732310658519123}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:33215
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S15] → sending delta(kind=head bytes=1806) to S11@127.0.0.1:33212
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:33211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:33217
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:33210
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:33214
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1804 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1806 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1801) from S9
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.221311)
[S17] loaded HEAD from S9 (vec_in norm=1.221311)
[S17] cosine check vs S9: cos=0.6012
[S17] BUFFERED delta from S9 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1806) from S15
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.868460)
[S11] loaded HEAD from S15 (vec_in norm=1.868460)
[S11] cosine check vs S15: cos=0.4042
[S11] BUFFERED delta from S15 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1804) from S7
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.414905)
[S14] loaded HEAD from S7 (vec_in norm=1.414905)
[S14] cosine check vs S7: cos=0.9763
[S14] BUFFERED delta from S7 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1802) from S4
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.317930)
[S10] loaded HEAD from S4 (vec_in norm=1.317930)
[S10] cosine check vs S4: cos=0.9609
[S10] BUFFERED delta from S4 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1799) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.472379)
[S15] loaded HEAD from S14 (vec_in norm=1.472379)
[S15] cosine check vs S14: cos=-0.0384
[S15] DROPPED delta from S14 (cos=-0.0384 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1795) from S3
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.125925)
[S9] loaded HEAD from S3 (vec_in norm=1.125925)
[S9] cosine check vs S3: cos=0.9636
[S9] BUFFERED delta from S3 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=23 metric=0.9952 head_norm=1.360030
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.883299e-01
[S10] stored merged vector for next round verification (round=23)
[S10] DEBUG after merge:  round=23 metric=0.9950 head_norm=1.325837 delta_norm=0.188330
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=23 metric=0.9961 head_norm=1.490530
[S11] _apply_head_vector_avg (torch): Δ‖w‖=9.302502e-01
[S11] stored merged vector for next round verification (round=23)
[S11] DEBUG after merge:  round=23 metric=0.9961 head_norm=1.411044 delta_norm=0.930250
[S11] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=23 metric=0.9970 head_norm=1.472379
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.598378e-01
[S14] stored merged vector for next round verification (round=23)
[S14] DEBUG after merge:  round=23 metric=0.9970 head_norm=1.435054 delta_norm=0.159838
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=23 metric=0.9967 head_norm=1.221311
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.653035e-01
[S9] stored merged vector for next round verification (round=23)
[S9] DEBUG after merge:  round=23 metric=0.9967 head_norm=1.162897 delta_norm=0.165303
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=23 metric=0.6317 head_norm=1.330345
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.718212e-01
[S17] stored merged vector for next round verification (round=23)
[S17] DEBUG after merge:  round=23 metric=0.6243 head_norm=1.141810 delta_norm=0.571821
[S17] aggregate: ROLLBACK (f1_val pre=0.632 post=0.624 tol_abs=0.005 tol_rel=0.0)
[S2] START round=24 head_norm_before_train=1.701050 cos_to_last_merge=0.8314 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.831
[S2] round=24 local utility u=0.517944 metrics={'f1_val': 0.6844380717520525, 'auprc': 0.7449117344981773, 'loss_val': 1.0696150253354846, 'psi': 0.7086275368505024}-{'f1_val': 0.5832915503144919, 'auprc': 0.7269406095579888, 'loss_val': 1.4447106236032508, 'psi': 0.6407511740118906}
[S3] START round=24 head_norm_before_train=1.125925 cos_to_last_merge=0.9987 (last merge round=22)
[S3] round=24 local utility u=0.031765 metrics={'f1_val': 0.7003512381127298, 'auprc': 0.9978676135165113, 'loss_val': 0.3375960164793428, 'psi': 0.8193577882742424}-{'f1_val': 0.7006809596653347, 'auprc': 0.9878786891865705, 'loss_val': 0.3731384186643428, 'psi': 0.815560051473829}
[S4] START round=24 head_norm_before_train=1.317930 cos_to_last_merge=0.9888 (last merge round=21)
[S4] round=24 local utility u=0.000000 metrics={'f1_val': 0.9385780846830805, 'auprc': 0.8980719641856185, 'loss_val': 0.34203470979406037, 'psi': 0.9223756364840957}-{'f1_val': 0.9454446506987421, 'auprc': 0.9466638331505692, 'loss_val': 0.27879051099825136, 'psi': 0.945932323679473}
[S5] START round=24 head_norm_before_train=1.425050 cos_to_last_merge=0.7740 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.774
[S5] round=24 local utility u=0.863130 metrics={'f1_val': 0.6451880180855509, 'auprc': 0.8633028574304833, 'loss_val': 0.3811934738967749, 'psi': 0.7324339538235238}-{'f1_val': 0.4478924428532851, 'auprc': 0.8025951243412173, 'loss_val': 0.7415573464288054, 'psi': 0.589773515448458}
[S6] START round=24 head_norm_before_train=1.821022 (no previous merge yet)
[S6] round=24 local utility u=0.266884 metrics={'f1_val': 0.7583037422095423, 'auprc': 0.8014990479033302, 'loss_val': 0.6709631003151051, 'psi': 0.7755818644870575}-{'f1_val': 0.6440298679970822, 'auprc': 0.8892670831710807, 'loss_val': 0.782391716294628, 'psi': 0.7421247540666815}
[S7] START round=24 head_norm_before_train=1.414905 cos_to_last_merge=0.8249 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.825
[S7] round=24 local utility u=0.066235 metrics={'f1_val': 0.6569745089623458, 'auprc': 0.8171592119235691, 'loss_val': 0.5079943949416181, 'psi': 0.7210483901468352}-{'f1_val': 0.6409833179144535, 'auprc': 0.8156604488820661, 'loss_val': 0.5400215596452267, 'psi': 0.7108541703014986}
[S8] START round=24 head_norm_before_train=2.042538 (no previous merge yet)
[S8] round=24 local utility u=0.000000 metrics={'f1_val': 0.9651384907555774, 'auprc': 0.9987776250377135, 'loss_val': 0.10276812759422689, 'psi': 0.9785941444684318}-{'f1_val': 0.9900973316212444, 'auprc': 0.998720661856719, 'loss_val': 0.036745967505854404, 'psi': 0.9935466637154342}
[S9] START round=24 head_norm_before_train=1.162897 cos_to_last_merge=1.0000 (last merge round=23)
[S9] round=24 local utility u=0.000000 metrics={'f1_val': 0.9895217784513768, 'auprc': 0.9990503318044461, 'loss_val': 0.14384313486233608, 'psi': 0.9933331997926045}-{'f1_val': 0.9966605118138915, 'auprc': 0.9980054779775365, 'loss_val': 0.12208125643319527, 'psi': 0.9971984982793495}
[S10] START round=24 head_norm_before_train=1.325837 cos_to_last_merge=1.0000 (last merge round=23)
[S10] round=24 local utility u=0.003930 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9927533302607836, 'loss_val': 0.1274942090916585, 'psi': 0.9942140355159383}-{'f1_val': 0.9951878390193748, 'auprc': 0.9935247088415895, 'loss_val': 0.13766759199854875, 'psi': 0.9945225869482606}
[S11] START round=24 head_norm_before_train=1.411044 cos_to_last_merge=1.0000 (last merge round=23)
[S11] round=24 local utility u=0.018191 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9961348823063035, 'loss_val': 0.1582944715794079, 'psi': 0.9963821556306751}-{'f1_val': 0.9961336749133093, 'auprc': 0.996151247729907, 'loss_val': 0.19224617209856637, 'psi': 0.9961407040399484}
[S13] START round=24 head_norm_before_train=1.346333 cos_to_last_merge=0.9982 (last merge round=22)
[S13] round=24 local utility u=0.155220 metrics={'f1_val': 0.5888388401103776, 'auprc': 0.6436257763210282, 'loss_val': 0.8332850844749196, 'psi': 0.6107536145946378}-{'f1_val': 0.5319982965091294, 'auprc': 0.6910737515439483, 'loss_val': 0.9450256211710854, 'psi': 0.595628478523057}
[S14] START round=24 head_norm_before_train=1.435054 cos_to_last_merge=1.0000 (last merge round=23)
[S14] round=24 local utility u=0.001681 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9972254322286894, 'loss_val': 0.17765225241917093, 'psi': 0.9970886777860748}-{'f1_val': 0.9969975081576651, 'auprc': 0.9956112271334383, 'loss_val': 0.1761725022907952, 'psi': 0.9964429957479743}
[S15] START round=24 head_norm_before_train=1.868460 cos_to_last_merge=0.8323 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.832
[S15] round=24 local utility u=1.000000 metrics={'f1_val': 0.996836310220466, 'auprc': 0.9994173187306781, 'loss_val': 0.024518012876241748, 'psi': 0.9978687136245509}-{'f1_val': 0.7021604299989732, 'auprc': 0.9786641761976892, 'loss_val': 0.3690311068921589, 'psi': 0.8127619284784596}
[S16] START round=24 head_norm_before_train=1.835723 (no previous merge yet)
[S16] round=24 local utility u=0.489305 metrics={'f1_val': 0.9256566361293271, 'auprc': 0.9808511033181087, 'loss_val': 0.2555379553254744, 'psi': 0.9477344230048397}-{'f1_val': 0.8447663954755364, 'auprc': 0.9502672196552238, 'loss_val': 0.6570558268617969, 'psi': 0.8869667251474114}
[S17] START round=24 head_norm_before_train=1.141810 cos_to_last_merge=1.0000 (last merge round=23)
[S17] round=24 local utility u=0.002559 metrics={'f1_val': 0.6164127039489947, 'auprc': 0.8709152190254317, 'loss_val': 0.7629926986707453, 'psi': 0.7182137099795696}-{'f1_val': 0.6316709565964436, 'auprc': 0.8595189616682568, 'loss_val': 0.8254718309144452, 'psi': 0.722810158625169}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] → sending delta(kind=head bytes=1805) to S11@127.0.0.1:33212
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:33213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:33215
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:33203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:33212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:33210
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:33204
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:33213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:33216
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:33217
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] → sending delta(kind=head bytes=1806) to S14@127.0.0.1:33214
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1806 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1803 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1805 to 1 peers)
[S2] sending update (kind=head size=1803 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1800) from S15
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.880014)
[S11] loaded HEAD from S15 (vec_in norm=1.880014)
[S11] cosine check vs S15: cos=0.8687
[S11] BUFFERED delta from S15 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1805) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.836223)
[S11] loaded HEAD from S6 (vec_in norm=1.836223)
[S11] cosine check vs S6: cos=0.5379
[S11] BUFFERED delta from S6 (total buffered=2)
[S9] RECEIVED delta(kind=head bytes=1799) from S3
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.165186)
[S9] loaded HEAD from S3 (vec_in norm=1.165186)
[S9] cosine check vs S3: cos=0.9834
[S9] BUFFERED delta from S3 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1800) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.442256)
[S16] loaded HEAD from S5 (vec_in norm=1.442256)
[S16] cosine check vs S5: cos=-0.1215
[S16] DROPPED delta from S5 (cos=-0.1215 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1806) from S7
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.425928)
[S14] loaded HEAD from S7 (vec_in norm=1.425928)
[S14] cosine check vs S7: cos=0.9862
[S14] BUFFERED delta from S7 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1798) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.472448)
[S15] loaded HEAD from S14 (vec_in norm=1.472448)
[S15] cosine check vs S14: cos=-0.0464
[S15] DROPPED delta from S14 (cos=-0.0464 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1803) from S16
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.860580)
[S17] loaded HEAD from S16 (vec_in norm=1.860580)
[S17] cosine check vs S16: cos=0.6571
[S17] BUFFERED delta from S16 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1796) from S13
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.386791)
[S4] loaded HEAD from S13 (vec_in norm=1.386791)
[S4] cosine check vs S13: cos=0.7904
[S4] BUFFERED delta from S13 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1800) from S11
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.444958)
[S13] loaded HEAD from S11 (vec_in norm=1.444958)
[S13] cosine check vs S11: cos=0.9602
[S13] BUFFERED delta from S11 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1803) from S2
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.724729)
[S13] loaded HEAD from S2 (vec_in norm=1.724729)
[S13] cosine check vs S2: cos=0.1655
[S13] BUFFERED delta from S2 (total buffered=2)
[S3] RECEIVED delta(kind=head bytes=1799) from S10
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.407041)
[S3] loaded HEAD from S10 (vec_in norm=1.407041)
[S3] cosine check vs S10: cos=0.6929
[S3] BUFFERED delta from S10 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:33203
[S17] sending update (kind=head size=1798 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1798) from S17
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.187831)
[S3] loaded HEAD from S17 (vec_in norm=1.187831)
[S3] cosine check vs S17: cos=0.8994
[S3] BUFFERED delta from S17 (total buffered=2)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=24 metric=0.9895 head_norm=1.207036
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.101853e-01
[S9] stored merged vector for next round verification (round=24)
[S9] DEBUG after merge:  round=24 metric=0.9899 head_norm=1.181167 delta_norm=0.110185
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=24 metric=0.9386 head_norm=1.372807
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.466833e-01
[S4] stored merged vector for next round verification (round=24)
[S4] DEBUG after merge:  round=24 metric=0.9388 head_norm=1.305515 delta_norm=0.446683
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=24 metric=0.9970 head_norm=1.472448
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.224242e-01
[S14] stored merged vector for next round verification (round=24)
[S14] DEBUG after merge:  round=24 metric=0.9970 head_norm=1.444195 delta_norm=0.122424
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=24 metric=0.9965 head_norm=1.444958
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.808809e-01
[S11] stored merged vector for next round verification (round=24)
[S11] DEBUG after merge:  round=24 metric=0.9965 head_norm=1.387936 delta_norm=0.180881
[S11] aggregate: ACCEPT kept=['S15', 'S6'] (k=2/2) mode=median trim_p=0.1
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=24 metric=0.5888 head_norm=1.386791
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.707711e-01
[S13] stored merged vector for next round verification (round=24)
[S13] DEBUG after merge:  round=24 metric=0.5909 head_norm=1.175406 delta_norm=0.470771
[S13] aggregate: ACCEPT kept=['S11', 'S2'] (k=2/2) mode=median trim_p=0.1
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=24 metric=0.7004 head_norm=1.165186
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.288609e-01
[S3] stored merged vector for next round verification (round=24)
[S3] DEBUG after merge:  round=24 metric=0.7004 head_norm=1.114805 delta_norm=0.228861
[S3] aggregate: ACCEPT kept=['S10', 'S17'] (k=2/2) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=24 metric=0.6164 head_norm=1.187831
[S17] _apply_head_vector_avg (torch): Δ‖w‖=7.014980e-01
[S17] stored merged vector for next round verification (round=24)
[S17] DEBUG after merge:  round=24 metric=0.6130 head_norm=1.394364 delta_norm=0.701498
[S17] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=25 head_norm_before_train=1.724729 cos_to_last_merge=0.8290 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.829
[S2] round=25 local utility u=0.000000 metrics={'f1_val': 0.6333675611984764, 'auprc': 0.7543619646946352, 'loss_val': 1.0962806394181892, 'psi': 0.68176532259694}-{'f1_val': 0.6844380717520525, 'auprc': 0.7449117344981773, 'loss_val': 1.0696150253354846, 'psi': 0.7086275368505024}
[S3] START round=25 head_norm_before_train=1.114805 cos_to_last_merge=1.0000 (last merge round=24)
[S3] round=25 local utility u=0.000000 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9987578977237844, 'loss_val': 0.3542743416773808, 'psi': 0.8199568813306936}-{'f1_val': 0.7003512381127298, 'auprc': 0.9978676135165113, 'loss_val': 0.3375960164793428, 'psi': 0.8193577882742424}
[S4] START round=25 head_norm_before_train=1.305515 cos_to_last_merge=1.0000 (last merge round=24)
[S4] round=25 local utility u=0.124522 metrics={'f1_val': 0.9421417439275631, 'auprc': 0.9578875300183017, 'loss_val': 0.2938184990676566, 'psi': 0.9484400583638586}-{'f1_val': 0.9385780846830805, 'auprc': 0.8980719641856185, 'loss_val': 0.34203470979406037, 'psi': 0.9223756364840957}
[S5] START round=25 head_norm_before_train=1.442256 cos_to_last_merge=0.7699 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.770
[S5] round=25 local utility u=0.000000 metrics={'f1_val': 0.43208175636730195, 'auprc': 0.8531581995933153, 'loss_val': 0.8661549049987141, 'psi': 0.6005123336577073}-{'f1_val': 0.6451880180855509, 'auprc': 0.8633028574304833, 'loss_val': 0.3811934738967749, 'psi': 0.7324339538235238}
[S6] START round=25 head_norm_before_train=1.836223 (no previous merge yet)
[S6] round=25 local utility u=0.576256 metrics={'f1_val': 0.8259668975907664, 'auprc': 0.9299637844691984, 'loss_val': 0.30982512770448517, 'psi': 0.8675656523421391}-{'f1_val': 0.7583037422095423, 'auprc': 0.8014990479033302, 'loss_val': 0.6709631003151051, 'psi': 0.7755818644870575}
[S7] START round=25 head_norm_before_train=1.425928 cos_to_last_merge=0.8222 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.822
[S7] round=25 local utility u=0.000000 metrics={'f1_val': 0.6207906535701989, 'auprc': 0.7910835065170015, 'loss_val': 0.6374968663684291, 'psi': 0.6889077947489199}-{'f1_val': 0.6569745089623458, 'auprc': 0.8171592119235691, 'loss_val': 0.5079943949416181, 'psi': 0.7210483901468352}
[S8] START round=25 head_norm_before_train=2.059710 (no previous merge yet)
[S8] round=25 local utility u=0.106975 metrics={'f1_val': 0.9897367044659179, 'auprc': 0.9987546774838337, 'loss_val': 0.03633956159076208, 'psi': 0.9933438936730842}-{'f1_val': 0.9651384907555774, 'auprc': 0.9987776250377135, 'loss_val': 0.10276812759422689, 'psi': 0.9785941444684318}
[S9] START round=25 head_norm_before_train=1.181167 cos_to_last_merge=1.0000 (last merge round=24)
[S9] round=25 local utility u=0.019541 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9950663202183669, 'loss_val': 0.1356418426288863, 'psi': 0.9960228351756817}-{'f1_val': 0.9895217784513768, 'auprc': 0.9990503318044461, 'loss_val': 0.14384313486233608, 'psi': 0.9933331997926045}
[S10] START round=25 head_norm_before_train=1.407041 cos_to_last_merge=0.9944 (last merge round=23)
[S10] round=25 local utility u=0.028495 metrics={'f1_val': 0.9951633020469546, 'auprc': 0.9962169323573669, 'loss_val': 0.08074872383870035, 'psi': 0.9955847541711195}-{'f1_val': 0.9951878390193748, 'auprc': 0.9927533302607836, 'loss_val': 0.1274942090916585, 'psi': 0.9942140355159383}
[S11] START round=25 head_norm_before_train=1.387936 cos_to_last_merge=1.0000 (last merge round=24)
[S11] round=25 local utility u=0.000000 metrics={'f1_val': 0.9880923386741293, 'auprc': 0.997631707129095, 'loss_val': 0.13234243825764608, 'psi': 0.9919080860561156}-{'f1_val': 0.9965470045135896, 'auprc': 0.9961348823063035, 'loss_val': 0.1582944715794079, 'psi': 0.9963821556306751}
[S13] START round=25 head_norm_before_train=1.175406 cos_to_last_merge=1.0000 (last merge round=24)
[S13] round=25 local utility u=0.000000 metrics={'f1_val': 0.5101692025848282, 'auprc': 0.6897250418155593, 'loss_val': 0.9645636252627301, 'psi': 0.5819915382771206}-{'f1_val': 0.5888388401103776, 'auprc': 0.6436257763210282, 'loss_val': 0.8332850844749196, 'psi': 0.6107536145946378}
[S14] START round=25 head_norm_before_train=1.444195 cos_to_last_merge=1.0000 (last merge round=24)
[S14] round=25 local utility u=0.000846 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9968632410583105, 'loss_val': 0.17487380944892822, 'psi': 0.9969438013179233}-{'f1_val': 0.9969975081576651, 'auprc': 0.9972254322286894, 'loss_val': 0.17765225241917093, 'psi': 0.9970886777860748}
[S15] START round=25 head_norm_before_train=1.880014 cos_to_last_merge=0.8312 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.831
[S15] round=25 local utility u=0.000000 metrics={'f1_val': 0.9749723297864531, 'auprc': 0.9969397177765221, 'loss_val': 0.04917435230925854, 'psi': 0.9837592849824807}-{'f1_val': 0.996836310220466, 'auprc': 0.9994173187306781, 'loss_val': 0.024518012876241748, 'psi': 0.9978687136245509}
[S16] START round=25 head_norm_before_train=1.860580 (no previous merge yet)
[S16] round=25 local utility u=0.000000 metrics={'f1_val': 0.9076827026513663, 'auprc': 0.9831076856318239, 'loss_val': 0.36723598589339834, 'psi': 0.9378526958435494}-{'f1_val': 0.9256566361293271, 'auprc': 0.9808511033181087, 'loss_val': 0.2555379553254744, 'psi': 0.9477344230048397}
[S17] START round=25 head_norm_before_train=1.394364 cos_to_last_merge=1.0000 (last merge round=24)
[S17] round=25 local utility u=0.000000 metrics={'f1_val': 0.6146252749459403, 'auprc': 0.8552637075431083, 'loss_val': 0.9114973333022302, 'psi': 0.7108806479848075}-{'f1_val': 0.6164127039489947, 'auprc': 0.8709152190254317, 'loss_val': 0.7629926986707453, 'psi': 0.7182137099795696}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:33213
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1795 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1795) from S4
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.354711)
[S13] loaded HEAD from S4 (vec_in norm=1.354711)
[S13] cosine check vs S4: cos=0.9610
[S13] BUFFERED delta from S4 (total buffered=1)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] → sending delta(kind=head bytes=1792) to S3@127.0.0.1:33203
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S8] sending update (kind=head size=1790 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.868)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.996)
[S9] sending update (kind=head size=1792 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1792) from S9
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.220841)
[S3] loaded HEAD from S9 (vec_in norm=1.220841)
[S3] cosine check vs S9: cos=0.9798
[S3] BUFFERED delta from S9 (total buffered=1)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=25 metric=0.7008 head_norm=1.151417
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.242065e-01
[S3] stored merged vector for next round verification (round=25)
[S3] DEBUG after merge:  round=25 metric=0.7007 head_norm=1.180119 delta_norm=0.124207
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.075 → S17@127.0.0.1:33217
[S4] ⇄ pheromone p=0.051 → S13@127.0.0.1:33213
[S14] ⇄ pheromone p=0.031 → S7@127.0.0.1:33208
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=25 metric=0.5102 head_norm=1.208530
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.929714e-01
[S13] stored merged vector for next round verification (round=25)
[S13] DEBUG after merge:  round=25 metric=0.5110 head_norm=1.269116 delta_norm=0.192971
[S13] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.094 → S2@127.0.0.1:33202
[S11] ⇄ pheromone p=0.068 → S6@127.0.0.1:33207
[S16] ⇄ pheromone p=0.198 → S5@127.0.0.1:33205
[S10] ⇄ pheromone p=0.028 → S4@127.0.0.1:33204
[S9] ⇄ pheromone p=0.060 → S3@127.0.0.1:33203
[S17] ⇄ pheromone p=0.101 → S8@127.0.0.1:33209
[S15] ⇄ pheromone p=0.291 → S14@127.0.0.1:33214
[S2] START round=26 head_norm_before_train=1.740673 cos_to_last_merge=0.8271 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.827
[S2] round=26 local utility u=0.425804 metrics={'f1_val': 0.7100049517367288, 'auprc': 0.7825439283342499, 'loss_val': 0.7890431874046222, 'psi': 0.7390205423757372}-{'f1_val': 0.6333675611984764, 'auprc': 0.7543619646946352, 'loss_val': 1.0962806394181892, 'psi': 0.68176532259694}
[S3] START round=26 head_norm_before_train=1.180119 cos_to_last_merge=1.0000 (last merge round=25)
[S3] round=26 local utility u=0.013826 metrics={'f1_val': 0.7003512381127298, 'auprc': 0.9988583557538682, 'loss_val': 0.32449486117986576, 'psi': 0.8197540851691851}-{'f1_val': 0.7007562037352997, 'auprc': 0.9987578977237844, 'loss_val': 0.3542743416773808, 'psi': 0.8199568813306936}
[S4] START round=26 head_norm_before_train=1.354711 cos_to_last_merge=0.9982 (last merge round=24)
[S4] round=26 local utility u=0.002714 metrics={'f1_val': 0.9412016203194806, 'auprc': 0.9571975308208327, 'loss_val': 0.28067919518314133, 'psi': 0.9475999845200215}-{'f1_val': 0.9421417439275631, 'auprc': 0.9578875300183017, 'loss_val': 0.2938184990676566, 'psi': 0.9484400583638586}
[S5] START round=26 head_norm_before_train=1.456432 cos_to_last_merge=0.7659 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.766
[S5] round=26 local utility u=1.000000 metrics={'f1_val': 0.7004938661094564, 'auprc': 0.9894695731987321, 'loss_val': 0.22947216583705984, 'psi': 0.8160841489451667}-{'f1_val': 0.43208175636730195, 'auprc': 0.8531581995933153, 'loss_val': 0.8661549049987141, 'psi': 0.6005123336577073}
[S6] START round=26 head_norm_before_train=1.846907 (no previous merge yet)
[S6] round=26 local utility u=0.000000 metrics={'f1_val': 0.7205062622063977, 'auprc': 0.8804550547961523, 'loss_val': 0.8095272923873659, 'psi': 0.7844857792422995}-{'f1_val': 0.8259668975907664, 'auprc': 0.9299637844691984, 'loss_val': 0.30982512770448517, 'psi': 0.8675656523421391}
[S7] START round=26 head_norm_before_train=1.436832 cos_to_last_merge=0.8191 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.819
[S7] round=26 local utility u=0.129080 metrics={'f1_val': 0.6421023274383392, 'auprc': 0.8012421595087884, 'loss_val': 0.5376836088849761, 'psi': 0.7057582602665189}-{'f1_val': 0.6207906535701989, 'auprc': 0.7910835065170015, 'loss_val': 0.6374968663684291, 'psi': 0.6889077947489199}
[S8] START round=26 head_norm_before_train=2.071124 (no previous merge yet)
[S8] round=26 local utility u=0.000000 metrics={'f1_val': 0.9861776023323788, 'auprc': 0.9988226876471455, 'loss_val': 0.040881374667841586, 'psi': 0.9912356364582855}-{'f1_val': 0.9897367044659179, 'auprc': 0.9987546774838337, 'loss_val': 0.03633956159076208, 'psi': 0.9933438936730842}
[S9] START round=26 head_norm_before_train=1.220841 cos_to_last_merge=0.9991 (last merge round=24)
[S9] round=26 local utility u=0.020795 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9984164156544725, 'loss_val': 0.10410296832919808, 'psi': 0.9973628733501239}-{'f1_val': 0.9966605118138915, 'auprc': 0.9950663202183669, 'loss_val': 0.1356418426288863, 'psi': 0.9960228351756817}
[S10] START round=26 head_norm_before_train=1.487459 cos_to_last_merge=0.9840 (last merge round=23)
[S10] round=26 local utility u=0.007010 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9953686487120088, 'loss_val': 0.06169558316711319, 'psi': 0.994996625016427}-{'f1_val': 0.9951633020469546, 'auprc': 0.9962169323573669, 'loss_val': 0.08074872383870035, 'psi': 0.9955847541711195}
[S11] START round=26 head_norm_before_train=1.428963 cos_to_last_merge=0.9987 (last merge round=24)
[S11] round=26 local utility u=0.044715 metrics={'f1_val': 0.9967887165093644, 'auprc': 0.9973341953796664, 'loss_val': 0.09419722703328608, 'psi': 0.9970069080574853}-{'f1_val': 0.9880923386741293, 'auprc': 0.997631707129095, 'loss_val': 0.13234243825764608, 'psi': 0.9919080860561156}
[S13] START round=26 head_norm_before_train=1.269116 cos_to_last_merge=1.0000 (last merge round=25)
[S13] round=26 local utility u=0.208317 metrics={'f1_val': 0.5777306483762985, 'auprc': 0.6573112601179286, 'loss_val': 0.8560568881113996, 'psi': 0.6095628930729505}-{'f1_val': 0.5101692025848282, 'auprc': 0.6897250418155593, 'loss_val': 0.9645636252627301, 'psi': 0.5819915382771206}
[S14] START round=26 head_norm_before_train=1.480193 cos_to_last_merge=0.9985 (last merge round=24)
[S14] round=26 local utility u=0.022763 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9971534440946808, 'loss_val': 0.13167463690844117, 'psi': 0.9972055916613481}-{'f1_val': 0.9969975081576651, 'auprc': 0.9968632410583105, 'loss_val': 0.17487380944892822, 'psi': 0.9969438013179233}
[S15] START round=26 head_norm_before_train=1.891299 cos_to_last_merge=0.8306 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.831
[S15] round=26 local utility u=0.078535 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9976776109176, 'loss_val': 0.02496450117381186, 'psi': 0.9971190453995523}-{'f1_val': 0.9749723297864531, 'auprc': 0.9969397177765221, 'loss_val': 0.04917435230925854, 'psi': 0.9837592849824807}
[S16] START round=26 head_norm_before_train=1.881355 (no previous merge yet)
[S16] round=26 local utility u=0.000000 metrics={'f1_val': 0.8521992649299613, 'auprc': 0.9793390316777071, 'loss_val': 0.6561415840930197, 'psi': 0.9030551716290596}-{'f1_val': 0.9076827026513663, 'auprc': 0.9831076856318239, 'loss_val': 0.36723598589339834, 'psi': 0.9378526958435494}
[S17] START round=26 head_norm_before_train=1.439109 cos_to_last_merge=0.9984 (last merge round=24)
[S17] round=26 local utility u=0.083436 metrics={'f1_val': 0.6215610431043327, 'auprc': 0.8632721014058939, 'loss_val': 0.8102656413306725, 'psi': 0.7182454664249572}-{'f1_val': 0.6146252749459403, 'auprc': 0.8552637075431083, 'loss_val': 0.9114973333022302, 'psi': 0.7108806479848075}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:33213
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S7] → sending delta(kind=head bytes=1808) to S14@127.0.0.1:33214
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:33216
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:33202
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:33207
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:33215
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:33217
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:33203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] → sending delta(kind=head bytes=1805) to S13@127.0.0.1:33213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:33204
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:33214
[S15] sending update (kind=head size=1804 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1808 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1805 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1800) from S13
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.298676)
[S2] loaded HEAD from S13 (vec_in norm=1.298676)
[S2] cosine check vs S13: cos=0.4371
[S2] BUFFERED delta from S13 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1802) from S11
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.470618)
[S6] loaded HEAD from S11 (vec_in norm=1.470618)
[S6] cosine check vs S11: cos=0.6369
[S6] BUFFERED delta from S11 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1803) from S10
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.549685)
[S4] loaded HEAD from S10 (vec_in norm=1.549685)
[S4] cosine check vs S10: cos=0.9035
[S4] BUFFERED delta from S10 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1801) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.466470)
[S16] loaded HEAD from S5 (vec_in norm=1.466470)
[S16] cosine check vs S5: cos=-0.1173
[S16] DROPPED delta from S5 (cos=-0.1173 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1803) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.517478)
[S15] loaded HEAD from S14 (vec_in norm=1.517478)
[S15] cosine check vs S14: cos=-0.0469
[S15] DROPPED delta from S14 (cos=-0.0469 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1800) from S4
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.409083)
[S13] loaded HEAD from S4 (vec_in norm=1.409083)
[S13] cosine check vs S4: cos=0.9830
[S13] BUFFERED delta from S4 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1805) from S2
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.753518)
[S13] loaded HEAD from S2 (vec_in norm=1.753518)
[S13] cosine check vs S2: cos=0.4371
[S13] BUFFERED delta from S2 (total buffered=2)
[S14] RECEIVED delta(kind=head bytes=1808) from S7
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.446018)
[S14] loaded HEAD from S7 (vec_in norm=1.446018)
[S14] cosine check vs S7: cos=0.9818
[S14] BUFFERED delta from S7 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1800) from S9
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.263327)
[S3] loaded HEAD from S9 (vec_in norm=1.263327)
[S3] cosine check vs S9: cos=0.9920
[S3] BUFFERED delta from S9 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1804) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.904072)
[S14] loaded HEAD from S15 (vec_in norm=1.904072)
[S14] cosine check vs S15: cos=-0.0469
[S14] DROPPED delta from S15 (cos=-0.0469 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1798) from S3
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.215671)
[S17] loaded HEAD from S3 (vec_in norm=1.215671)
[S17] cosine check vs S3: cos=0.6074
[S17] BUFFERED delta from S3 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:33209
[S17] sending update (kind=head size=1797 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1797) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.481637)
[S8] loaded HEAD from S17 (vec_in norm=1.481637)
[S8] cosine check vs S17: cos=0.3389
[S8] BUFFERED delta from S17 (total buffered=1)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=26 metric=0.9862 head_norm=2.081883
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.053385e+00
[S8] stored merged vector for next round verification (round=26)
[S8] DEBUG after merge:  round=26 metric=0.9880 head_norm=1.468034 delta_norm=1.053385
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=26 metric=0.7205 head_norm=1.859913
[S6] _apply_head_vector_avg (torch): Δ‖w‖=7.310992e-01
[S6] stored merged vector for next round verification (round=26)
[S6] DEBUG after merge:  round=26 metric=0.7237 head_norm=1.508804 delta_norm=0.731099
[S6] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=26 metric=0.7004 head_norm=1.215671
[S3] _apply_head_vector_avg (torch): Δ‖w‖=8.198223e-02
[S3] stored merged vector for next round verification (round=26)
[S3] DEBUG after merge:  round=26 metric=0.7004 head_norm=1.237015 delta_norm=0.081982
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=26 metric=0.7100 head_norm=1.753518
[S2] _apply_head_vector_avg (torch): Δ‖w‖=8.322744e-01
[S2] stored merged vector for next round verification (round=26)
[S2] DEBUG after merge:  round=26 metric=0.7092 head_norm=1.299235 delta_norm=0.832274
[S2] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=26 metric=0.5777 head_norm=1.298676
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.101053e-01
[S13] stored merged vector for next round verification (round=26)
[S13] DEBUG after merge:  round=26 metric=0.5890 head_norm=1.251111 delta_norm=0.410105
[S13] aggregate: ACCEPT kept=['S4', 'S2'] (k=2/2) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=26 metric=0.9412 head_norm=1.409083
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.320369e-01
[S4] stored merged vector for next round verification (round=26)
[S4] DEBUG after merge:  round=26 metric=0.9413 head_norm=1.443354 delta_norm=0.332037
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=26 metric=0.9972 head_norm=1.517478
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.459244e-01
[S14] stored merged vector for next round verification (round=26)
[S14] DEBUG after merge:  round=26 metric=0.9972 head_norm=1.474978 delta_norm=0.145924
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=26 metric=0.6216 head_norm=1.481637
[S17] _apply_head_vector_avg (torch): Δ‖w‖=6.092933e-01
[S17] stored merged vector for next round verification (round=26)
[S17] DEBUG after merge:  round=26 metric=0.6219 head_norm=1.210502 delta_norm=0.609293
[S17] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=27 head_norm_before_train=1.299235 cos_to_last_merge=1.0000 (last merge round=26)
[S2] round=27 local utility u=0.000000 metrics={'f1_val': 0.6358750022602275, 'auprc': 0.7619403517944886, 'loss_val': 0.8283311481071891, 'psi': 0.686301142073932}-{'f1_val': 0.7100049517367288, 'auprc': 0.7825439283342499, 'loss_val': 0.7890431874046222, 'psi': 0.7390205423757372}
[S3] START round=27 head_norm_before_train=1.237015 cos_to_last_merge=1.0000 (last merge round=26)
[S3] round=27 local utility u=0.008476 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9990981377075993, 'loss_val': 0.31024123693127575, 'psi': 0.8200478308822405}-{'f1_val': 0.7003512381127298, 'auprc': 0.9988583557538682, 'loss_val': 0.32449486117986576, 'psi': 0.8197540851691851}
[S4] START round=27 head_norm_before_train=1.443354 cos_to_last_merge=1.0000 (last merge round=26)
[S4] round=27 local utility u=0.006932 metrics={'f1_val': 0.9404178519900148, 'auprc': 0.9629878109158213, 'loss_val': 0.2794828088468643, 'psi': 0.9494458355603373}-{'f1_val': 0.9412016203194806, 'auprc': 0.9571975308208327, 'loss_val': 0.28067919518314133, 'psi': 0.9475999845200215}
[S5] START round=27 head_norm_before_train=1.466470 cos_to_last_merge=0.7648 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.765
[S5] round=27 local utility u=0.000000 metrics={'f1_val': 0.591961562708596, 'auprc': 0.8533529272647009, 'loss_val': 0.5117672603883516, 'psi': 0.696518108531038}-{'f1_val': 0.7004938661094564, 'auprc': 0.9894695731987321, 'loss_val': 0.22947216583705984, 'psi': 0.8160841489451667}
[S6] START round=27 head_norm_before_train=1.508804 cos_to_last_merge=1.0000 (last merge round=26)
[S6] round=27 local utility u=0.372599 metrics={'f1_val': 0.7858794501068427, 'auprc': 0.9076153952184056, 'loss_val': 0.5380492927533064, 'psi': 0.8345738281514679}-{'f1_val': 0.7205062622063977, 'auprc': 0.8804550547961523, 'loss_val': 0.8095272923873659, 'psi': 0.7844857792422995}
[S7] START round=27 head_norm_before_train=1.446018 cos_to_last_merge=0.8160 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.816
[S7] round=27 local utility u=0.246630 metrics={'f1_val': 0.680675969100097, 'auprc': 0.8408428919001294, 'loss_val': 0.39466670717379587, 'psi': 0.74474273822011}-{'f1_val': 0.6421023274383392, 'auprc': 0.8012421595087884, 'loss_val': 0.5376836088849761, 'psi': 0.7057582602665189}
[S8] START round=27 head_norm_before_train=1.468034 cos_to_last_merge=1.0000 (last merge round=26)
[S8] round=27 local utility u=0.000000 metrics={'f1_val': 0.9896943903875475, 'auprc': 0.9983919203701275, 'loss_val': 0.06790056548327898, 'psi': 0.9931734023805795}-{'f1_val': 0.9861776023323788, 'auprc': 0.9988226876471455, 'loss_val': 0.040881374667841586, 'psi': 0.9912356364582855}
[S9] START round=27 head_norm_before_train=1.263327 cos_to_last_merge=0.9965 (last merge round=24)
[S9] round=27 local utility u=0.000000 metrics={'f1_val': 0.9903801002864661, 'auprc': 0.9985516949392832, 'loss_val': 0.09351210373809234, 'psi': 0.9936487381475929}-{'f1_val': 0.9966605118138915, 'auprc': 0.9984164156544725, 'loss_val': 0.10410296832919808, 'psi': 0.9973628733501239}
[S10] START round=27 head_norm_before_train=1.549685 cos_to_last_merge=0.9754 (last merge round=23)
[S10] round=27 local utility u=0.003432 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9945918403805023, 'loss_val': 0.05250176985937766, 'psi': 0.9946859016838244}-{'f1_val': 0.9947486092193725, 'auprc': 0.9953686487120088, 'loss_val': 0.06169558316711319, 'psi': 0.994996625016427}
[S11] START round=27 head_norm_before_train=1.470618 cos_to_last_merge=0.9956 (last merge round=24)
[S11] round=27 local utility u=0.000000 metrics={'f1_val': 0.983795381845061, 'auprc': 0.9965087095644212, 'loss_val': 0.13549119747944324, 'psi': 0.9888807129328051}-{'f1_val': 0.9967887165093644, 'auprc': 0.9973341953796664, 'loss_val': 0.09419722703328608, 'psi': 0.9970069080574853}
[S13] START round=27 head_norm_before_train=1.251111 cos_to_last_merge=1.0000 (last merge round=26)
[S13] round=27 local utility u=0.000000 metrics={'f1_val': 0.5568657348125794, 'auprc': 0.6527007692831837, 'loss_val': 0.8658974616427738, 'psi': 0.5951997486008211}-{'f1_val': 0.5777306483762985, 'auprc': 0.6573112601179286, 'loss_val': 0.8560568881113996, 'psi': 0.6095628930729505}
[S14] START round=27 head_norm_before_train=1.474978 cos_to_last_merge=1.0000 (last merge round=26)
[S14] round=27 local utility u=0.000000 metrics={'f1_val': 0.996754531653698, 'auprc': 0.9968410694280698, 'loss_val': 0.15365838901920162, 'psi': 0.9967891467634468}-{'f1_val': 0.997240356705793, 'auprc': 0.9971534440946808, 'loss_val': 0.13167463690844117, 'psi': 0.9972055916613481}
[S15] START round=27 head_norm_before_train=1.904072 cos_to_last_merge=0.8296 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.830
[S15] round=27 local utility u=0.000000 metrics={'f1_val': 0.9963164379542544, 'auprc': 0.9910029911260244, 'loss_val': 0.023543795435219672, 'psi': 0.9941910592229624}-{'f1_val': 0.9967466683875206, 'auprc': 0.9976776109176, 'loss_val': 0.02496450117381186, 'psi': 0.9971190453995523}
[S16] START round=27 head_norm_before_train=1.899388 (no previous merge yet)
[S16] round=27 local utility u=0.481309 metrics={'f1_val': 0.9282025265589078, 'auprc': 0.983460582014394, 'loss_val': 0.16190851529585049, 'psi': 0.9503057487411023}-{'f1_val': 0.8521992649299613, 'auprc': 0.9793390316777071, 'loss_val': 0.6561415840930197, 'psi': 0.9030551716290596}
[S17] START round=27 head_norm_before_train=1.210502 cos_to_last_merge=1.0000 (last merge round=26)
[S17] round=27 local utility u=0.032040 metrics={'f1_val': 0.6267659986176345, 'auprc': 0.8982730523065303, 'loss_val': 0.8824185844040944, 'psi': 0.7353688200931928}-{'f1_val': 0.6215610431043327, 'auprc': 0.8632721014058939, 'loss_val': 0.8102656413306725, 'psi': 0.7182454664249572}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:33205
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:33217
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:33214
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:33212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] → sending delta(kind=head bytes=1805) to S4@127.0.0.1:33204
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:33213
[S4] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1805 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S16] sending update (kind=head size=1802 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1802) from S16
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.917600)
[S5] loaded HEAD from S16 (vec_in norm=1.917600)
[S5] cosine check vs S16: cos=-0.1161
[S5] DROPPED delta from S16 (cos=-0.1161 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1800) from S4
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.490460)
[S13] loaded HEAD from S4 (vec_in norm=1.490460)
[S13] cosine check vs S4: cos=0.9344
[S13] BUFFERED delta from S4 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1801) from S3
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.269288)
[S17] loaded HEAD from S3 (vec_in norm=1.269288)
[S17] cosine check vs S3: cos=0.8646
[S17] BUFFERED delta from S3 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1805) from S10
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.594018)
[S4] loaded HEAD from S10 (vec_in norm=1.594018)
[S4] cosine check vs S10: cos=0.9741
[S4] BUFFERED delta from S10 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1799) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.534638)
[S11] loaded HEAD from S6 (vec_in norm=1.534638)
[S11] cosine check vs S6: cos=0.8760
[S11] BUFFERED delta from S6 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1802) from S7
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.457417)
[S14] loaded HEAD from S7 (vec_in norm=1.457417)
[S14] cosine check vs S7: cos=0.9897
[S14] BUFFERED delta from S7 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S17] → sending delta(kind=head bytes=1807) to S8@127.0.0.1:33209
[S17] sending update (kind=head size=1807 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1807) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.246528)
[S8] loaded HEAD from S17 (vec_in norm=1.246528)
[S8] cosine check vs S17: cos=0.7920
[S8] BUFFERED delta from S17 (total buffered=1)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=27 metric=0.9838 head_norm=1.509194
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.790942e-01
[S11] stored merged vector for next round verification (round=27)
[S11] DEBUG after merge:  round=27 metric=0.9724 head_norm=1.474000 delta_norm=0.379094
[S11] aggregate: ROLLBACK (f1_val pre=0.984 post=0.972 tol_abs=0.005 tol_rel=0.0)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=27 metric=0.5569 head_norm=1.282582
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.711518e-01
[S13] stored merged vector for next round verification (round=27)
[S13] DEBUG after merge:  round=27 metric=0.5745 head_norm=1.363716 delta_norm=0.271152
[S13] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=27 metric=0.9897 head_norm=1.525777
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.661021e-01
[S8] stored merged vector for next round verification (round=27)
[S8] DEBUG after merge:  round=27 metric=0.9901 head_norm=1.312883 delta_norm=0.466102
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=27 metric=0.9968 head_norm=1.503553
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.089478e-01
[S14] stored merged vector for next round verification (round=27)
[S14] DEBUG after merge:  round=27 metric=0.9968 head_norm=1.476651 delta_norm=0.108948
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=27 metric=0.9404 head_norm=1.490460
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.830280e-01
[S4] stored merged vector for next round verification (round=27)
[S4] DEBUG after merge:  round=27 metric=0.9412 head_norm=1.532215 delta_norm=0.183028
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=27 metric=0.6268 head_norm=1.246528
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.274283e-01
[S17] stored merged vector for next round verification (round=27)
[S17] DEBUG after merge:  round=27 metric=0.6284 head_norm=1.214600 delta_norm=0.327428
[S17] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=28 head_norm_before_train=1.335481 cos_to_last_merge=0.9996 (last merge round=26)
[S2] round=28 local utility u=0.377277 metrics={'f1_val': 0.7154711648110692, 'auprc': 0.787656641531713, 'loss_val': 0.6285021977934862, 'psi': 0.7443453554993267}-{'f1_val': 0.6358750022602275, 'auprc': 0.7619403517944886, 'loss_val': 0.8283311481071891, 'psi': 0.686301142073932}
[S3] START round=28 head_norm_before_train=1.269288 cos_to_last_merge=0.9996 (last merge round=26)
[S3] round=28 local utility u=0.000000 metrics={'f1_val': 0.6808405138444917, 'auprc': 0.99680319826943, 'loss_val': 0.37053184321492627, 'psi': 0.807225587614467}-{'f1_val': 0.7006809596653347, 'auprc': 0.9990981377075993, 'loss_val': 0.31024123693127575, 'psi': 0.8200478308822405}
[S4] START round=28 head_norm_before_train=1.532215 cos_to_last_merge=1.0000 (last merge round=27)
[S4] round=28 local utility u=0.000000 metrics={'f1_val': 0.9399365181418762, 'auprc': 0.9555002887342755, 'loss_val': 0.29459525359027555, 'psi': 0.946162026378836}-{'f1_val': 0.9404178519900148, 'auprc': 0.9629878109158213, 'loss_val': 0.2794828088468643, 'psi': 0.9494458355603373}
[S5] START round=28 head_norm_before_train=1.474574 cos_to_last_merge=0.7662 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.766
[S5] round=28 local utility u=0.680624 metrics={'f1_val': 0.7004083344258929, 'auprc': 0.9882006469862488, 'loss_val': 0.20574386533756273, 'psi': 0.8155252594500353}-{'f1_val': 0.591961562708596, 'auprc': 0.8533529272647009, 'loss_val': 0.5117672603883516, 'psi': 0.696518108531038}
[S6] START round=28 head_norm_before_train=1.534638 cos_to_last_merge=0.9998 (last merge round=26)
[S6] round=28 local utility u=0.000000 metrics={'f1_val': 0.5440241865442922, 'auprc': 0.7064416776121111, 'loss_val': 0.9289025519700799, 'psi': 0.6089911829714197}-{'f1_val': 0.7858794501068427, 'auprc': 0.9076153952184056, 'loss_val': 0.5380492927533064, 'psi': 0.8345738281514679}
[S7] START round=28 head_norm_before_train=1.457417 cos_to_last_merge=0.8124 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.812
[S7] round=28 local utility u=0.000000 metrics={'f1_val': 0.5550180205959832, 'auprc': 0.7843106397541539, 'loss_val': 0.7669066380075489, 'psi': 0.6467350682592514}-{'f1_val': 0.680675969100097, 'auprc': 0.8408428919001294, 'loss_val': 0.39466670717379587, 'psi': 0.74474273822011}
[S8] START round=28 head_norm_before_train=1.312883 cos_to_last_merge=1.0000 (last merge round=27)
[S8] round=28 local utility u=0.000000 metrics={'f1_val': 0.9713081436470392, 'auprc': 0.9987415708441352, 'loss_val': 0.127030838776689, 'psi': 0.9822815145258776}-{'f1_val': 0.9896943903875475, 'auprc': 0.9983919203701275, 'loss_val': 0.06790056548327898, 'psi': 0.9931734023805795}
[S9] START round=28 head_norm_before_train=1.302796 cos_to_last_merge=0.9933 (last merge round=24)
[S9] round=28 local utility u=0.025253 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9951157670304347, 'loss_val': 0.07038150859907513, 'psi': 0.9960426139005087}-{'f1_val': 0.9903801002864661, 'auprc': 0.9985516949392832, 'loss_val': 0.09351210373809234, 'psi': 0.9936487381475929}
[S10] START round=28 head_norm_before_train=1.594018 cos_to_last_merge=0.9696 (last merge round=23)
[S10] round=28 local utility u=0.003758 metrics={'f1_val': 0.9943096789853013, 'auprc': 0.9961930965918757, 'loss_val': 0.04715564463965034, 'psi': 0.995063046027931}-{'f1_val': 0.9947486092193725, 'auprc': 0.9945918403805023, 'loss_val': 0.05250176985937766, 'psi': 0.9946859016838244}
[S11] START round=28 head_norm_before_train=1.474000 cos_to_last_merge=1.0000 (last merge round=27)
[S11] round=28 local utility u=0.053921 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9962746120338442, 'loss_val': 0.1009759188808399, 'psi': 0.9961900497615233}-{'f1_val': 0.983795381845061, 'auprc': 0.9965087095644212, 'loss_val': 0.13549119747944324, 'psi': 0.9888807129328051}
[S13] START round=28 head_norm_before_train=1.363716 cos_to_last_merge=1.0000 (last merge round=27)
[S13] round=28 local utility u=0.000000 metrics={'f1_val': 0.5393311048508719, 'auprc': 0.6717821706655135, 'loss_val': 0.9645232846704932, 'psi': 0.5923115311767285}-{'f1_val': 0.5568657348125794, 'auprc': 0.6527007692831837, 'loss_val': 0.8658974616427738, 'psi': 0.5951997486008211}
[S14] START round=28 head_norm_before_train=1.476651 cos_to_last_merge=1.0000 (last merge round=27)
[S14] round=28 local utility u=0.000000 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9950545880561126, 'loss_val': 0.1597516237578909, 'psi': 0.9964667969234804}-{'f1_val': 0.996754531653698, 'auprc': 0.9968410694280698, 'loss_val': 0.15365838901920162, 'psi': 0.9967891467634468}
[S15] START round=28 head_norm_before_train=1.919083 cos_to_last_merge=0.8282 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.828
[S15] round=28 local utility u=0.000000 metrics={'f1_val': 0.9016001089992542, 'auprc': 0.9939489526326997, 'loss_val': 0.264961051644437, 'psi': 0.9385396464526324}-{'f1_val': 0.9963164379542544, 'auprc': 0.9910029911260244, 'loss_val': 0.023543795435219672, 'psi': 0.9941910592229624}
[S16] START round=28 head_norm_before_train=1.917600 (no previous merge yet)
[S16] round=28 local utility u=0.000000 metrics={'f1_val': 0.9200591049509645, 'auprc': 0.9934027965090206, 'loss_val': 0.3163081529038162, 'psi': 0.9493965815741869}-{'f1_val': 0.9282025265589078, 'auprc': 0.983460582014394, 'loss_val': 0.16190851529585049, 'psi': 0.9503057487411023}
[S17] START round=28 head_norm_before_train=1.214600 cos_to_last_merge=1.0000 (last merge round=27)
[S17] round=28 local utility u=0.000000 metrics={'f1_val': 0.596945604830545, 'auprc': 0.8196306520471921, 'loss_val': 0.9564137905882351, 'psi': 0.6860196237172038}-{'f1_val': 0.6267659986176345, 'auprc': 0.8982730523065303, 'loss_val': 0.8824185844040944, 'psi': 0.7353688200931928}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:33203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:33204
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:33207
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S5] → sending delta(kind=head bytes=1807) to S16@127.0.0.1:33216
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1807 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1800) from S11
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.509107)
[S6] loaded HEAD from S11 (vec_in norm=1.509107)
[S6] cosine check vs S11: cos=0.9636
[S6] BUFFERED delta from S11 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1807) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.480947)
[S16] loaded HEAD from S5 (vec_in norm=1.480947)
[S16] cosine check vs S5: cos=-0.1146
[S16] DROPPED delta from S5 (cos=-0.1146 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1797) from S9
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.337005)
[S3] loaded HEAD from S9 (vec_in norm=1.337005)
[S3] cosine check vs S9: cos=0.9908
[S3] BUFFERED delta from S9 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1802) from S10
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.628419)
[S4] loaded HEAD from S10 (vec_in norm=1.628419)
[S4] cosine check vs S10: cos=0.9916
[S4] BUFFERED delta from S10 (total buffered=1)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:33213
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1801 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1801) from S2
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.389605)
[S13] loaded HEAD from S2 (vec_in norm=1.389605)
[S13] cosine check vs S2: cos=0.8611
[S13] BUFFERED delta from S2 (total buffered=1)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=28 metric=0.5440 head_norm=1.578189
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.111287e-01
[S6] stored merged vector for next round verification (round=28)
[S6] DEBUG after merge:  round=28 metric=0.5366 head_norm=1.529532 delta_norm=0.211129
[S6] aggregate: ROLLBACK (f1_val pre=0.544 post=0.537 tol_abs=0.005 tol_rel=0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=28 metric=0.9399 head_norm=1.562864
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.082182e-01
[S4] stored merged vector for next round verification (round=28)
[S4] DEBUG after merge:  round=28 metric=0.9399 head_norm=1.592305 delta_norm=0.108218
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=28 metric=0.6808 head_norm=1.294667
[S3] _apply_head_vector_avg (torch): Δ‖w‖=9.184749e-02
[S3] stored merged vector for next round verification (round=28)
[S3] DEBUG after merge:  round=28 metric=0.6734 head_norm=1.312797 delta_norm=0.091847
[S3] aggregate: ROLLBACK (f1_val pre=0.681 post=0.673 tol_abs=0.005 tol_rel=0.0)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=28 metric=0.5393 head_norm=1.385406
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.656219e-01
[S13] stored merged vector for next round verification (round=28)
[S13] DEBUG after merge:  round=28 metric=0.5327 head_norm=1.338468 delta_norm=0.365622
[S13] aggregate: ROLLBACK (f1_val pre=0.539 post=0.533 tol_abs=0.005 tol_rel=0.0)
[S2] START round=29 head_norm_before_train=1.389605 cos_to_last_merge=0.9982 (last merge round=26)
[S2] round=29 local utility u=0.000000 metrics={'f1_val': 0.7134230333744953, 'auprc': 0.7770166766804236, 'loss_val': 0.6510110499042601, 'psi': 0.7388604906968667}-{'f1_val': 0.7154711648110692, 'auprc': 0.787656641531713, 'loss_val': 0.6285021977934862, 'psi': 0.7443453554993267}
[S3] START round=29 head_norm_before_train=1.312797 cos_to_last_merge=1.0000 (last merge round=28)
[S3] round=29 local utility u=0.094220 metrics={'f1_val': 0.6988201799346228, 'auprc': 0.9992109335463568, 'loss_val': 0.2971925954707369, 'psi': 0.8189764813793163}-{'f1_val': 0.6808405138444917, 'auprc': 0.99680319826943, 'loss_val': 0.37053184321492627, 'psi': 0.807225587614467}
[S4] START round=29 head_norm_before_train=1.592305 cos_to_last_merge=1.0000 (last merge round=28)
[S4] round=29 local utility u=0.000000 metrics={'f1_val': 0.9397664599744945, 'auprc': 0.9547756945036179, 'loss_val': 0.30315425567960175, 'psi': 0.9457701537861438}-{'f1_val': 0.9399365181418762, 'auprc': 0.9555002887342755, 'loss_val': 0.29459525359027555, 'psi': 0.946162026378836}
[S5] START round=29 head_norm_before_train=1.480947 cos_to_last_merge=0.7653 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.765
[S5] round=29 local utility u=0.000000 metrics={'f1_val': 0.43544613859604414, 'auprc': 0.8535346877013134, 'loss_val': 0.844667130428946, 'psi': 0.6026815582381518}-{'f1_val': 0.7004083344258929, 'auprc': 0.9882006469862488, 'loss_val': 0.20574386533756273, 'psi': 0.8155252594500353}
[S6] START round=29 head_norm_before_train=1.529532 cos_to_last_merge=1.0000 (last merge round=28)
[S6] round=29 local utility u=1.000000 metrics={'f1_val': 0.838107126560003, 'auprc': 0.9392439247272052, 'loss_val': 0.4729757576533663, 'psi': 0.8785618458268839}-{'f1_val': 0.5440241865442922, 'auprc': 0.7064416776121111, 'loss_val': 0.9289025519700799, 'psi': 0.6089911829714197}
[S7] START round=29 head_norm_before_train=1.469862 cos_to_last_merge=0.8098 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.810
[S7] round=29 local utility u=0.408240 metrics={'f1_val': 0.6432013358767218, 'auprc': 0.8029283212324245, 'loss_val': 0.535378576019334, 'psi': 0.707092130019003}-{'f1_val': 0.5550180205959832, 'auprc': 0.7843106397541539, 'loss_val': 0.7669066380075489, 'psi': 0.6467350682592514}
[S8] START round=29 head_norm_before_train=1.406831 cos_to_last_merge=0.9970 (last merge round=27)
[S8] round=29 local utility u=0.085775 metrics={'f1_val': 0.9896943903875475, 'auprc': 0.9983967429229024, 'loss_val': 0.06476414701982677, 'psi': 0.9931753314016895}-{'f1_val': 0.9713081436470392, 'auprc': 0.9987415708441352, 'loss_val': 0.127030838776689, 'psi': 0.9822815145258776}
[S9] START round=29 head_norm_before_train=1.337005 cos_to_last_merge=0.9902 (last merge round=24)
[S9] round=29 local utility u=0.001654 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9941168781032825, 'loss_val': 0.06161510458605402, 'psi': 0.9953968081088795}-{'f1_val': 0.9966605118138915, 'auprc': 0.9951157670304347, 'loss_val': 0.07038150859907513, 'psi': 0.9960426139005087}
[S10] START round=29 head_norm_before_train=1.628419 cos_to_last_merge=0.9655 (last merge round=23)
[S10] round=29 local utility u=0.000934 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9945500801832768, 'loss_val': 0.042991971277486274, 'psi': 0.9946691976049342}-{'f1_val': 0.9943096789853013, 'auprc': 0.9961930965918757, 'loss_val': 0.04715564463965034, 'psi': 0.995063046027931}
[S11] START round=29 head_norm_before_train=1.509107 cos_to_last_merge=0.9996 (last merge round=27)
[S11] round=29 local utility u=0.000000 metrics={'f1_val': 0.8215749917294137, 'auprc': 0.9962004748130797, 'loss_val': 0.30829165049511054, 'psi': 0.8914251849628801}-{'f1_val': 0.9961336749133093, 'auprc': 0.9962746120338442, 'loss_val': 0.1009759188808399, 'psi': 0.9961900497615233}
[S13] START round=29 head_norm_before_train=1.338468 cos_to_last_merge=1.0000 (last merge round=28)
[S13] round=29 local utility u=0.085851 metrics={'f1_val': 0.5426855677861139, 'auprc': 0.6835919318793929, 'loss_val': 0.8483775991496544, 'psi': 0.5990481134234256}-{'f1_val': 0.5393311048508719, 'auprc': 0.6717821706655135, 'loss_val': 0.9645232846704932, 'psi': 0.5923115311767285}
[S14] START round=29 head_norm_before_train=1.507301 cos_to_last_merge=0.9989 (last merge round=27)
[S14] round=29 local utility u=0.017480 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9969694296092289, 'loss_val': 0.12807211969229723, 'psi': 0.9969862767382907}-{'f1_val': 0.9974082695017256, 'auprc': 0.9950545880561126, 'loss_val': 0.1597516237578909, 'psi': 0.9964667969234804}
[S15] START round=29 head_norm_before_train=1.935611 cos_to_last_merge=0.8268 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.827
[S15] round=29 local utility u=0.321642 metrics={'f1_val': 0.9736417895137133, 'auprc': 0.9936565756736908, 'loss_val': 0.053050992084082815, 'psi': 0.9816477039777043}-{'f1_val': 0.9016001089992542, 'auprc': 0.9939489526326997, 'loss_val': 0.264961051644437, 'psi': 0.9385396464526324}
[S16] START round=29 head_norm_before_train=1.934417 (no previous merge yet)
[S16] round=29 local utility u=0.000000 metrics={'f1_val': 0.8303412918477153, 'auprc': 0.9498165672900063, 'loss_val': 1.0028917750162205, 'psi': 0.8781314020246317}-{'f1_val': 0.9200591049509645, 'auprc': 0.9934027965090206, 'loss_val': 0.3163081529038162, 'psi': 0.9493965815741869}
[S17] START round=29 head_norm_before_train=1.250586 cos_to_last_merge=0.9992 (last merge round=27)
[S17] round=29 local utility u=0.131705 metrics={'f1_val': 0.6059445010475097, 'auprc': 0.8933013279833002, 'loss_val': 0.9680082597085437, 'psi': 0.7208872318218259}-{'f1_val': 0.596945604830545, 'auprc': 0.8196306520471921, 'loss_val': 0.9564137905882351, 'psi': 0.6860196237172038}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:33217
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:33203
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1810 reason=None
[S7] → sending delta(kind=head bytes=1810) to S14@127.0.0.1:33214
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:33217
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:33212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:33214
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:33204
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:33202
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:33215
[S13] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1810 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1803) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.527849)
[S17] loaded HEAD from S8 (vec_in norm=1.527849)
[S17] cosine check vs S8: cos=0.8789
[S17] BUFFERED delta from S8 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1803) from S3
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.335925)
[S17] loaded HEAD from S3 (vec_in norm=1.335925)
[S17] cosine check vs S3: cos=0.9490
[S17] BUFFERED delta from S3 (total buffered=2)
[S4] RECEIVED delta(kind=head bytes=1801) from S10
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.657678)
[S4] loaded HEAD from S10 (vec_in norm=1.657678)
[S4] cosine check vs S10: cos=0.9967
[S4] BUFFERED delta from S10 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1801) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.577971)
[S11] loaded HEAD from S6 (vec_in norm=1.577971)
[S11] cosine check vs S6: cos=0.9860
[S11] BUFFERED delta from S6 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1799) from S9
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.366110)
[S3] loaded HEAD from S9 (vec_in norm=1.366110)
[S3] cosine check vs S9: cos=0.9953
[S3] BUFFERED delta from S9 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1802) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.951649)
[S14] loaded HEAD from S15 (vec_in norm=1.951649)
[S14] cosine check vs S15: cos=-0.0510
[S14] DROPPED delta from S15 (cos=-0.0510 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1810) from S7
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.485643)
[S14] loaded HEAD from S7 (vec_in norm=1.485643)
[S14] cosine check vs S7: cos=0.9876
[S14] BUFFERED delta from S7 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1802) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.537935)
[S15] loaded HEAD from S14 (vec_in norm=1.537935)
[S15] cosine check vs S14: cos=-0.0510
[S15] DROPPED delta from S14 (cos=-0.0510 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1801) from S13
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.358363)
[S2] loaded HEAD from S13 (vec_in norm=1.358363)
[S2] cosine check vs S13: cos=0.9583
[S2] BUFFERED delta from S13 (total buffered=1)
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S16
[S15]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S6]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S16
[S11]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S3]  timeout peer S2
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S9]  timeout peer S2
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S2]  timeout peer S3
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S16
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S16
[S14]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S11
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S13]  timeout peer S3
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:33209
[S17] sending update (kind=head size=1802 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1802) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.294003)
[S8] loaded HEAD from S17 (vec_in norm=1.294003)
[S8] cosine check vs S17: cos=0.8789
[S8] BUFFERED delta from S17 (total buffered=1)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=29 metric=0.7134 head_norm=1.431365
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.045824e-01
[S2] stored merged vector for next round verification (round=29)
[S2] DEBUG after merge:  round=29 metric=0.7133 head_norm=1.380262 delta_norm=0.204582
[S2] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=29 metric=0.9398 head_norm=1.610972
[S4] _apply_head_vector_avg (torch): Δ‖w‖=7.030843e-02
[S4] stored merged vector for next round verification (round=29)
[S4] DEBUG after merge:  round=29 metric=0.9398 head_norm=1.632979 delta_norm=0.070308
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=29 metric=0.8216 head_norm=1.539665
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.319430e-01
[S11] stored merged vector for next round verification (round=29)
[S11] DEBUG after merge:  round=29 metric=0.8216 head_norm=1.553342 delta_norm=0.131943
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=29 metric=0.6059 head_norm=1.294003
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.704641e-01
[S17] stored merged vector for next round verification (round=29)
[S17] DEBUG after merge:  round=29 metric=0.6106 head_norm=1.310783 delta_norm=0.170464
[S17] aggregate: ACCEPT kept=['S8', 'S3'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=29 metric=0.9897 head_norm=1.527849
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.652398e-01
[S8] stored merged vector for next round verification (round=29)
[S8] DEBUG after merge:  round=29 metric=0.9901 head_norm=1.367839 delta_norm=0.365240
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=29 metric=0.6988 head_norm=1.335925
[S3] _apply_head_vector_avg (torch): Δ‖w‖=6.697641e-02
[S3] stored merged vector for next round verification (round=29)
[S3] DEBUG after merge:  round=29 metric=0.6983 head_norm=1.349441 delta_norm=0.066976
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=29 metric=0.9970 head_norm=1.537935
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.218303e-01
[S14] stored merged vector for next round verification (round=29)
[S14] DEBUG after merge:  round=29 metric=0.9970 head_norm=1.507099 delta_norm=0.121830
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=30 head_norm_before_train=1.380262 cos_to_last_merge=1.0000 (last merge round=29)
[S2] round=30 local utility u=0.000000 metrics={'f1_val': 0.6577938827544434, 'auprc': 0.7582012258436542, 'loss_val': 0.8753924952121721, 'psi': 0.6979568199901278}-{'f1_val': 0.7134230333744953, 'auprc': 0.7770166766804236, 'loss_val': 0.6510110499042601, 'psi': 0.7388604906968667}
[S3] START round=30 head_norm_before_train=1.349441 cos_to_last_merge=1.0000 (last merge round=29)
[S3] round=30 local utility u=0.022662 metrics={'f1_val': 0.7008317350254774, 'auprc': 0.9994677783255895, 'loss_val': 0.2647079762400615, 'psi': 0.8202861523455223}-{'f1_val': 0.6988201799346228, 'auprc': 0.9992109335463568, 'loss_val': 0.2971925954707369, 'psi': 0.8189764813793163}
[S4] START round=30 head_norm_before_train=1.632979 cos_to_last_merge=1.0000 (last merge round=29)
[S4] round=30 local utility u=0.055954 metrics={'f1_val': 0.9514977640586081, 'auprc': 0.9576721611812804, 'loss_val': 0.2703226147973469, 'psi': 0.9539675229076771}-{'f1_val': 0.9397664599744945, 'auprc': 0.9547756945036179, 'loss_val': 0.30315425567960175, 'psi': 0.9457701537861438}
[S5] START round=30 head_norm_before_train=1.486695 cos_to_last_merge=0.7641 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.764
[S5] round=30 local utility u=1.000000 metrics={'f1_val': 0.7005802511973405, 'auprc': 0.9895235459138806, 'loss_val': 0.19539596437452025, 'psi': 0.8161575690839565}-{'f1_val': 0.43544613859604414, 'auprc': 0.8535346877013134, 'loss_val': 0.844667130428946, 'psi': 0.6026815582381518}
[S6] START round=30 head_norm_before_train=1.577971 cos_to_last_merge=0.9995 (last merge round=28)
[S6] round=30 local utility u=0.000000 metrics={'f1_val': 0.785223837795794, 'auprc': 0.900101504476683, 'loss_val': 0.6070333014797257, 'psi': 0.8311749044681496}-{'f1_val': 0.838107126560003, 'auprc': 0.9392439247272052, 'loss_val': 0.4729757576533663, 'psi': 0.8785618458268839}
[S7] START round=30 head_norm_before_train=1.485643 cos_to_last_merge=0.8075 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.808
[S7] round=30 local utility u=0.051261 metrics={'f1_val': 0.6516187325274423, 'auprc': 0.8098169852077592, 'loss_val': 0.5040271684408122, 'psi': 0.714898033599569}-{'f1_val': 0.6432013358767218, 'auprc': 0.8029283212324245, 'loss_val': 0.535378576019334, 'psi': 0.707092130019003}
[S8] START round=30 head_norm_before_train=1.367839 cos_to_last_merge=1.0000 (last merge round=29)
[S8] round=30 local utility u=0.000000 metrics={'f1_val': 0.9829002842217747, 'auprc': 0.9987200846010027, 'loss_val': 0.08360711075955181, 'psi': 0.9892282043734659}-{'f1_val': 0.9896943903875475, 'auprc': 0.9983967429229024, 'loss_val': 0.06476414701982677, 'psi': 0.9931753314016895}
[S9] START round=30 head_norm_before_train=1.366110 cos_to_last_merge=0.9874 (last merge round=24)
[S9] round=30 local utility u=0.008015 metrics={'f1_val': 0.9958601375429889, 'auprc': 0.9982614978317927, 'loss_val': 0.0556786674820161, 'psi': 0.9968206816585103}-{'f1_val': 0.9962500947792776, 'auprc': 0.9941168781032825, 'loss_val': 0.06161510458605402, 'psi': 0.9953968081088795}
[S10] START round=30 head_norm_before_train=1.657678 cos_to_last_merge=0.9620 (last merge round=23)
[S10] round=30 local utility u=0.002838 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.996082470013451, 'loss_val': 0.040596676957100786, 'psi': 0.995150452084417}-{'f1_val': 0.9947486092193725, 'auprc': 0.9945500801832768, 'loss_val': 0.042991971277486274, 'psi': 0.9946691976049342}
[S11] START round=30 head_norm_before_train=1.553342 cos_to_last_merge=1.0000 (last merge round=29)
[S11] round=30 local utility u=0.652278 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9978595952453326, 'loss_val': 0.05854545137086889, 'psi': 0.9970720408062868}-{'f1_val': 0.8215749917294137, 'auprc': 0.9962004748130797, 'loss_val': 0.30829165049511054, 'psi': 0.8914251849628801}
[S13] START round=30 head_norm_before_train=1.358363 cos_to_last_merge=0.9996 (last merge round=28)
[S13] round=30 local utility u=0.000000 metrics={'f1_val': 0.5843610705234374, 'auprc': 0.5741619553651748, 'loss_val': 0.8260668280707841, 'psi': 0.5802814244601324}-{'f1_val': 0.5426855677861139, 'auprc': 0.6835919318793929, 'loss_val': 0.8483775991496544, 'psi': 0.5990481134234256}
[S14] START round=30 head_norm_before_train=1.507099 cos_to_last_merge=1.0000 (last merge round=29)
[S14] round=30 local utility u=0.000000 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9951477045835609, 'loss_val': 0.13773016638504998, 'psi': 0.9965040435344598}-{'f1_val': 0.9969975081576651, 'auprc': 0.9969694296092289, 'loss_val': 0.12807211969229723, 'psi': 0.9969862767382907}
[S15] START round=30 head_norm_before_train=1.951649 cos_to_last_merge=0.8253 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.825
[S15] round=30 local utility u=0.000000 metrics={'f1_val': 0.9033183004617408, 'auprc': 0.9965241534006284, 'loss_val': 0.21090432993559277, 'psi': 0.9406006416372958}-{'f1_val': 0.9736417895137133, 'auprc': 0.9936565756736908, 'loss_val': 0.053050992084082815, 'psi': 0.9816477039777043}
[S16] START round=30 head_norm_before_train=1.946516 (no previous merge yet)
[S16] round=30 local utility u=0.298147 metrics={'f1_val': 0.8271536529705559, 'auprc': 0.986711671933621, 'loss_val': 0.4981581404144298, 'psi': 0.890976860555782}-{'f1_val': 0.8303412918477153, 'auprc': 0.9498165672900063, 'loss_val': 1.0028917750162205, 'psi': 0.8781314020246317}
[S17] START round=30 head_norm_before_train=1.310783 cos_to_last_merge=1.0000 (last merge round=29)
[S17] round=30 local utility u=0.000000 metrics={'f1_val': 0.5959317047215748, 'auprc': 0.8244890797480139, 'loss_val': 1.0431256221955074, 'psi': 0.6873546547321504}-{'f1_val': 0.6059445010475097, 'auprc': 0.8933013279833002, 'loss_val': 0.9680082597085437, 'psi': 0.7208872318218259}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:33216
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:33203
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] → sending delta(kind=head bytes=1806) to S14@127.0.0.1:33214
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:33204
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:33205
[S10] sending update (kind=head size=1802 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1806 to 1 peers)
[S15] ⇄ pheromone p=0.153 → S14@127.0.0.1:33214
[S9] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] ⇄ pheromone p=0.327 → S11@127.0.0.1:33212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:33213
[S8] ⇄ pheromone p=0.047 → S17@127.0.0.1:33217
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:33207
[S16] sending update (kind=head size=1804 to 1 peers)
[S2] ⇄ pheromone p=0.138 → S13@127.0.0.1:33213
[S3] RECEIVED delta(kind=head bytes=1803) from S9
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.392874)
[S3] loaded HEAD from S9 (vec_in norm=1.392874)
[S3] cosine check vs S9: cos=0.9970
[S3] BUFFERED delta from S9 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1806) from S7
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.497375)
[S14] loaded HEAD from S7 (vec_in norm=1.497375)
[S14] cosine check vs S7: cos=0.9934
[S14] BUFFERED delta from S7 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1802) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.493546)
[S16] loaded HEAD from S5 (vec_in norm=1.493546)
[S16] cosine check vs S5: cos=-0.1130
[S16] DROPPED delta from S5 (cos=-0.1130 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1802) from S10
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.683182)
[S4] loaded HEAD from S10 (vec_in norm=1.683182)
[S4] cosine check vs S10: cos=0.9984
[S4] BUFFERED delta from S10 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1804) from S16
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.956203)
[S5] loaded HEAD from S16 (vec_in norm=1.956203)
[S5] cosine check vs S16: cos=-0.1130
[S5] DROPPED delta from S16 (cos=-0.1130 < 0.0)
[S16] ⇄ pheromone p=0.174 → S5@127.0.0.1:33205
[S11] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:33217
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] ⇄ pheromone p=0.443 → S16@127.0.0.1:33216
[S9] ⇄ pheromone p=0.027 → S3@127.0.0.1:33203
[S7] ⇄ pheromone p=0.196 → S14@127.0.0.1:33214
[S10] ⇄ pheromone p=0.011 → S4@127.0.0.1:33204
[S13] RECEIVED delta(kind=head bytes=1801) from S4
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.648074)
[S13] loaded HEAD from S4 (vec_in norm=1.648074)
[S13] cosine check vs S4: cos=0.8925
[S13] BUFFERED delta from S4 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1799) from S11
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.580237)
[S6] loaded HEAD from S11 (vec_in norm=1.580237)
[S6] cosine check vs S11: cos=0.9930
[S6] BUFFERED delta from S11 (total buffered=1)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=30 metric=0.9974 head_norm=1.534920
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.914146e-02
[S14] stored merged vector for next round verification (round=30)
[S14] DEBUG after merge:  round=30 metric=0.9974 head_norm=1.513641 delta_norm=0.089141
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.015 → S7@127.0.0.1:33208
[S3] sending update (kind=head size=1803 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1803) from S3
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.370544)
[S17] loaded HEAD from S3 (vec_in norm=1.370544)
[S17] cosine check vs S3: cos=0.9384
[S17] BUFFERED delta from S3 (total buffered=1)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=30 metric=0.9515 head_norm=1.648074
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.964658e-02
[S4] stored merged vector for next round verification (round=30)
[S4] DEBUG after merge:  round=30 metric=0.9515 head_norm=1.664981 delta_norm=0.049647
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.029 → S13@127.0.0.1:33213
[S11] ⇄ pheromone p=0.163 → S6@127.0.0.1:33207
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=30 metric=0.5844 head_norm=1.389094
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.739424e-01
[S13] stored merged vector for next round verification (round=30)
[S13] DEBUG after merge:  round=30 metric=0.5922 head_norm=1.477509 delta_norm=0.373942
[S13] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.062 → S11@127.0.0.1:33212
[S17] RoundReady barrier timeout: have=2 need=3 — continuing
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] CommDone barrier timeout: have=1 need=2 — continuing
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=30 metric=0.7008 head_norm=1.370544
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.424229e-02
[S3] stored merged vector for next round verification (round=30)
[S3] DEBUG after merge:  round=30 metric=0.7008 head_norm=1.380689 delta_norm=0.054242
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.046 → S17@127.0.0.1:33217
[S13]  timeout peer S11
[S9]  timeout peer S3
[S17]  timeout peer S9
[S17]  timeout peer S16
[S15]  timeout peer S14
[S3]  timeout peer S10
[S3]  timeout peer S17
[S10]  timeout peer S4
[S4]  timeout peer S13
[S11]  timeout peer S15
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=30 metric=0.5959 head_norm=1.354938
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.392691e-01
[S17] stored merged vector for next round verification (round=30)
[S17] DEBUG after merge:  round=30 metric=0.5973 head_norm=1.341594 delta_norm=0.239269
[S17] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.064 → S8@127.0.0.1:33209
[S2] START round=31 head_norm_before_train=1.431054 cos_to_last_merge=0.9995 (last merge round=29)
[S2] round=31 local utility u=0.000000 metrics={'f1_val': 0.5942085575683425, 'auprc': 0.6726817309876575, 'loss_val': 1.293508342126165, 'psi': 0.6255978269360685}-{'f1_val': 0.6577938827544434, 'auprc': 0.7582012258436542, 'loss_val': 0.8753924952121721, 'psi': 0.6979568199901278}
[S3] START round=31 head_norm_before_train=1.380689 cos_to_last_merge=1.0000 (last merge round=30)
[S3] round=31 local utility u=0.022386 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9990477335954279, 'loss_val': 0.21777194605550484, 'psi': 0.820027669237372}-{'f1_val': 0.7008317350254774, 'auprc': 0.9994677783255895, 'loss_val': 0.2647079762400615, 'psi': 0.8202861523455223}
[S4] START round=31 head_norm_before_train=1.664981 cos_to_last_merge=1.0000 (last merge round=30)
[S4] round=31 local utility u=0.000000 metrics={'f1_val': 0.9350501270983498, 'auprc': 0.9541821259334349, 'loss_val': 0.33669528216323635, 'psi': 0.9427029266323838}-{'f1_val': 0.9514977640586081, 'auprc': 0.9576721611812804, 'loss_val': 0.2703226147973469, 'psi': 0.9539675229076771}
[S5] START round=31 head_norm_before_train=1.493546 cos_to_last_merge=0.7616 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.762
[S5] round=31 local utility u=0.000000 metrics={'f1_val': 0.44243322840916643, 'auprc': 0.8556986982545405, 'loss_val': 0.7428754655464035, 'psi': 0.6077394163473161}-{'f1_val': 0.7005802511973405, 'auprc': 0.9895235459138806, 'loss_val': 0.19539596437452025, 'psi': 0.8161575690839565}
[S6] START round=31 head_norm_before_train=1.638788 cos_to_last_merge=0.9977 (last merge round=28)
[S6] round=31 local utility u=0.000000 metrics={'f1_val': 0.6206348367806764, 'auprc': 0.7617106590114491, 'loss_val': 0.934276026713202, 'psi': 0.6770651656729856}-{'f1_val': 0.785223837795794, 'auprc': 0.900101504476683, 'loss_val': 0.6070333014797257, 'psi': 0.8311749044681496}
[S7] START round=31 head_norm_before_train=1.497375 cos_to_last_merge=0.8058 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.806
[S7] round=31 local utility u=0.000000 metrics={'f1_val': 0.6140623711457132, 'auprc': 0.7989369728950261, 'loss_val': 0.6249283265190798, 'psi': 0.6880122118454384}-{'f1_val': 0.6516187325274423, 'auprc': 0.8098169852077592, 'loss_val': 0.5040271684408122, 'psi': 0.714898033599569}
[S8] START round=31 head_norm_before_train=1.485363 cos_to_last_merge=0.9968 (last merge round=29)
[S8] round=31 local utility u=0.020711 metrics={'f1_val': 0.9920456787729849, 'auprc': 0.9899569994598884, 'loss_val': 0.07076875628191343, 'psi': 0.9912102070477462}-{'f1_val': 0.9829002842217747, 'auprc': 0.9987200846010027, 'loss_val': 0.08360711075955181, 'psi': 0.9892282043734659}
[S9] START round=31 head_norm_before_train=1.392874 cos_to_last_merge=0.9848 (last merge round=24)
[S9] round=31 local utility u=0.000000 metrics={'f1_val': 0.9899884433541285, 'auprc': 0.9971996137824745, 'loss_val': 0.061310012762080035, 'psi': 0.9928729115254669}-{'f1_val': 0.9958601375429889, 'auprc': 0.9982614978317927, 'loss_val': 0.0556786674820161, 'psi': 0.9968206816585103}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=31 head_norm_before_train=1.683182 cos_to_last_merge=0.9589 (last merge round=23)
[S10] round=31 local utility u=0.000720 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9955433353682077, 'loss_val': 0.03885578745160051, 'psi': 0.9950664996789066}-{'f1_val': 0.9945291067983943, 'auprc': 0.996082470013451, 'loss_val': 0.040596676957100786, 'psi': 0.995150452084417}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S10] sending update (kind=head size=1807 to 1 peers)
[S11] START round=31 head_norm_before_train=1.580237 cos_to_last_merge=0.9998 (last merge round=29)
[S11] round=31 local utility u=0.002715 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9975842204485827, 'loss_val': 0.05228988801050565, 'psi': 0.9969618908875868}-{'f1_val': 0.9965470045135896, 'auprc': 0.9978595952453326, 'loss_val': 0.05854545137086889, 'psi': 0.9970720408062868}
[S13] START round=31 head_norm_before_train=1.477509 cos_to_last_merge=1.0000 (last merge round=30)
[S13] round=31 local utility u=0.000000 metrics={'f1_val': 0.5342302444652145, 'auprc': 0.6717196311729459, 'loss_val': 1.0257237181863401, 'psi': 0.5892259991483071}-{'f1_val': 0.5843610705234374, 'auprc': 0.5741619553651748, 'loss_val': 0.8260668280707841, 'psi': 0.5802814244601324}
[S14] START round=31 head_norm_before_train=1.513641 cos_to_last_merge=1.0000 (last merge round=30)
[S14] round=31 local utility u=0.004422 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9988910150978463, 'loss_val': 0.13765081783067346, 'psi': 0.9977549109337376}-{'f1_val': 0.9974082695017256, 'auprc': 0.9951477045835609, 'loss_val': 0.13773016638504998, 'psi': 0.9965040435344598}
[S15] START round=31 head_norm_before_train=1.966757 cos_to_last_merge=0.8238 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.824
[S15] round=31 local utility u=0.357106 metrics={'f1_val': 0.9921621803925177, 'auprc': 0.9978065498873725, 'loss_val': 0.03360276313104691, 'psi': 0.9944199281904597}-{'f1_val': 0.9033183004617408, 'auprc': 0.9965241534006284, 'loss_val': 0.21090432993559277, 'psi': 0.9406006416372958}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=31 head_norm_before_train=1.956203 (no previous merge yet)
[S16] round=31 local utility u=0.469204 metrics={'f1_val': 0.9366705003491846, 'auprc': 0.9925229830518904, 'loss_val': 0.23428521428001886, 'psi': 0.9590114934302669}-{'f1_val': 0.8271536529705559, 'auprc': 0.986711671933621, 'loss_val': 0.4981581404144298, 'psi': 0.890976860555782}
[S17] START round=31 head_norm_before_train=1.341594 cos_to_last_merge=1.0000 (last merge round=30)
[S17] round=31 local utility u=0.158604 metrics={'f1_val': 0.6107176116056305, 'auprc': 0.8649269554886271, 'loss_val': 0.9359464916957922, 'psi': 0.7124013491588292}-{'f1_val': 0.5959317047215748, 'auprc': 0.8244890797480139, 'loss_val': 1.0431256221955074, 'psi': 0.6873546547321504}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:33217
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S3] → sending delta(kind=head bytes=1806) to S9@127.0.0.1:33210
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:33207
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] → sending delta(kind=head bytes=1805) to S5@127.0.0.1:33205
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:33208
[S16] sending update (kind=head size=1805 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1806 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:33209
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=31 metric=0.6206 head_norm=1.690857
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.268959e-01
[S6] stored merged vector for next round verification (round=31)
[S6] DEBUG after merge:  round=31 metric=0.6105 head_norm=1.631554 delta_norm=0.126896
[S6] aggregate: ROLLBACK (f1_val pre=0.621 post=0.610 tol_abs=0.005 tol_rel=0.0)
[S8] sending update (kind=head size=1802 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1805) from S16
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.964404)
[S5] loaded HEAD from S16 (vec_in norm=1.964404)
[S5] cosine check vs S16: cos=-0.1119
[S5] DROPPED delta from S16 (cos=-0.1119 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1801) from S11
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.605233)
[S6] loaded HEAD from S11 (vec_in norm=1.605233)
[S6] cosine check vs S11: cos=0.9967
[S6] BUFFERED delta from S11 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1806) from S3
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.402369)
[S9] loaded HEAD from S3 (vec_in norm=1.402369)
[S9] cosine check vs S3: cos=0.9977
[S9] BUFFERED delta from S3 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1802) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.583401)
[S17] loaded HEAD from S8 (vec_in norm=1.583401)
[S17] cosine check vs S8: cos=0.9264
[S17] BUFFERED delta from S8 (total buffered=1)
[S17] sending update (kind=head size=1804 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1798) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.542094)
[S7] loaded HEAD from S14 (vec_in norm=1.542094)
[S7] cosine check vs S14: cos=0.9951
[S7] BUFFERED delta from S14 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1804) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.377596)
[S8] loaded HEAD from S17 (vec_in norm=1.377596)
[S8] cosine check vs S17: cos=0.9264
[S8] BUFFERED delta from S17 (total buffered=1)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=31 metric=0.6107 head_norm=1.377596
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.014772e-01
[S17] stored merged vector for next round verification (round=31)
[S17] DEBUG after merge:  round=31 metric=0.6164 head_norm=1.453126 delta_norm=0.301477
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=32 head_norm_before_train=1.478792 cos_to_last_merge=0.9983 (last merge round=29)
[S2] round=32 local utility u=0.791081 metrics={'f1_val': 0.7221962631006347, 'auprc': 0.7584933712564905, 'loss_val': 0.7367070017357896, 'psi': 0.7367151063629771}-{'f1_val': 0.5942085575683425, 'auprc': 0.6726817309876575, 'loss_val': 1.293508342126165, 'psi': 0.6255978269360685}
[S3] START round=32 head_norm_before_train=1.402369 cos_to_last_merge=0.9997 (last merge round=30)
[S3] round=32 local utility u=0.811630 metrics={'f1_val': 0.9603162089582811, 'auprc': 0.999003272829104, 'loss_val': 0.15219087333899767, 'psi': 0.9757910345066102}-{'f1_val': 0.7006809596653347, 'auprc': 0.9990477335954279, 'loss_val': 0.21777194605550484, 'psi': 0.820027669237372}
[S4] START round=32 head_norm_before_train=1.676216 cos_to_last_merge=0.9999 (last merge round=30)
[S4] round=32 local utility u=0.000000 metrics={'f1_val': 0.7137667595216269, 'auprc': 0.9527476281867072, 'loss_val': 0.5313265996863633, 'psi': 0.8093591069876591}-{'f1_val': 0.9350501270983498, 'auprc': 0.9541821259334349, 'loss_val': 0.33669528216323635, 'psi': 0.9427029266323838}
[S5] START round=32 head_norm_before_train=1.500779 cos_to_last_merge=0.7598 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.760
[S5] round=32 local utility u=1.000000 metrics={'f1_val': 0.7005802511973405, 'auprc': 0.9896067545217674, 'loss_val': 0.1942714706300409, 'psi': 0.8161908525271112}-{'f1_val': 0.44243322840916643, 'auprc': 0.8556986982545405, 'loss_val': 0.7428754655464035, 'psi': 0.6077394163473161}
[S6] START round=32 head_norm_before_train=1.631554 cos_to_last_merge=1.0000 (last merge round=31)
[S6] round=32 local utility u=1.000000 metrics={'f1_val': 0.9069582974104649, 'auprc': 0.9459213223288755, 'loss_val': 0.26130970262324565, 'psi': 0.9225435073778292}-{'f1_val': 0.6206348367806764, 'auprc': 0.7617106590114491, 'loss_val': 0.934276026713202, 'psi': 0.6770651656729856}
[S7] START round=32 head_norm_before_train=1.509239 cos_to_last_merge=0.8031 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.803
[S7] round=32 local utility u=0.000000 metrics={'f1_val': 0.5589071996338129, 'auprc': 0.786225906974614, 'loss_val': 0.8231573949898328, 'psi': 0.6498346825701333}-{'f1_val': 0.6140623711457132, 'auprc': 0.7989369728950261, 'loss_val': 0.6249283265190798, 'psi': 0.6880122118454384}
[S8] START round=32 head_norm_before_train=1.583401 cos_to_last_merge=0.9914 (last merge round=29)
[S8] round=32 local utility u=0.000000 metrics={'f1_val': 0.984123794071937, 'auprc': 0.9988800760274656, 'loss_val': 0.05561161796029128, 'psi': 0.9900263068541485}-{'f1_val': 0.9920456787729849, 'auprc': 0.9899569994598884, 'loss_val': 0.07076875628191343, 'psi': 0.9912102070477462}
[S9] START round=32 head_norm_before_train=1.417151 cos_to_last_merge=0.9824 (last merge round=24)
[S9] round=32 local utility u=0.000000 metrics={'f1_val': 0.9887042205730695, 'auprc': 0.9964451266052657, 'loss_val': 0.06264375786915685, 'psi': 0.991800582985948}-{'f1_val': 0.9899884433541285, 'auprc': 0.9971996137824745, 'loss_val': 0.061310012762080035, 'psi': 0.9928729115254669}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=32 metric=0.9887 head_norm=1.438262
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.725794e-02
[S9] stored merged vector for next round verification (round=32)
[S9] DEBUG after merge:  round=32 metric=0.9887 head_norm=1.419275 delta_norm=0.057258
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S10] START round=32 head_norm_before_train=1.706077 cos_to_last_merge=0.9561 (last merge round=23)
[S10] round=32 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9945850623617709, 'loss_val': 0.03751693474009753, 'psi': 0.9946831904763318}-{'f1_val': 0.9947486092193725, 'auprc': 0.9955433353682077, 'loss_val': 0.03885578745160051, 'psi': 0.9950664996789066}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=32 head_norm_before_train=1.605233 cos_to_last_merge=0.9994 (last merge round=29)
[S11] round=32 local utility u=0.004365 metrics={'f1_val': 0.9967887165093644, 'auprc': 0.9978160010087722, 'loss_val': 0.04570470278923556, 'psi': 0.9971996303091275}-{'f1_val': 0.9965470045135896, 'auprc': 0.9975842204485827, 'loss_val': 0.05228988801050565, 'psi': 0.9969618908875868}
[S13] START round=32 head_norm_before_train=1.498509 cos_to_last_merge=0.9998 (last merge round=30)
[S13] round=32 local utility u=0.223043 metrics={'f1_val': 0.5678720078248523, 'auprc': 0.6869631377430924, 'loss_val': 0.82721902228973, 'psi': 0.6155084597921483}-{'f1_val': 0.5342302444652145, 'auprc': 0.6717196311729459, 'loss_val': 1.0257237181863401, 'psi': 0.5892259991483071}
[S14] START round=32 head_norm_before_train=1.542094 cos_to_last_merge=0.9992 (last merge round=30)
[S14] round=32 local utility u=0.014336 metrics={'f1_val': 0.9969755000837764, 'auprc': 0.9989340385309734, 'loss_val': 0.10897625986679288, 'psi': 0.9977589154626552}-{'f1_val': 0.9969975081576651, 'auprc': 0.9988910150978463, 'loss_val': 0.13765081783067346, 'psi': 0.9977549109337376}
[S15] START round=32 head_norm_before_train=1.981364 cos_to_last_merge=0.8224 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.822
[S15] round=32 local utility u=0.021060 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9981505838047038, 'loss_val': 0.020021440132466626, 'psi': 0.9973082345543939}-{'f1_val': 0.9921621803925177, 'auprc': 0.9978065498873725, 'loss_val': 0.03360276313104691, 'psi': 0.9944199281904597}
[S15] not sending this round → trigger blocked (psi=0.997)
[S16] START round=32 head_norm_before_train=1.964404 (no previous merge yet)
[S16] round=32 local utility u=0.000000 metrics={'f1_val': 0.8341585517508971, 'auprc': 0.935368742856298, 'loss_val': 1.041156969580926, 'psi': 0.8746426281930575}-{'f1_val': 0.9366705003491846, 'auprc': 0.9925229830518904, 'loss_val': 0.23428521428001886, 'psi': 0.9590114934302669}
[S17] START round=32 head_norm_before_train=1.453126 cos_to_last_merge=1.0000 (last merge round=31)
[S17] round=32 local utility u=0.161819 metrics={'f1_val': 0.6376100251871705, 'auprc': 0.8978815766177968, 'loss_val': 0.8725259444305912, 'psi': 0.7417186457594209}-{'f1_val': 0.6107176116056305, 'auprc': 0.8649269554886271, 'loss_val': 0.9359464916957922, 'psi': 0.7124013491588292}
[S3] not sending this round → trigger blocked (psi=0.976)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:33216
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:33212
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1795 to 1 peers)
[S14] not sending this round → trigger blocked (psi=0.998)
[S5] sending update (kind=head size=1803 to 1 peers)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=32 metric=0.5589 head_norm=1.517955
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.824162e-02
[S7] stored merged vector for next round verification (round=32)
[S7] DEBUG after merge:  round=32 metric=0.5660 head_norm=1.528070 delta_norm=0.078242
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S17] not sending this round → trigger blocked (psi=0.742)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:33202
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=32 metric=0.9841 head_norm=1.651520
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.341503e-01
[S8] stored merged vector for next round verification (round=32)
[S8] DEBUG after merge:  round=32 metric=0.9841 head_norm=1.483573 delta_norm=0.334150
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S16] RECEIVED delta(kind=head bytes=1803) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.508228)
[S16] loaded HEAD from S5 (vec_in norm=1.508228)
[S16] cosine check vs S5: cos=-0.1113
[S16] DROPPED delta from S5 (cos=-0.1113 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1795) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.663110)
[S11] loaded HEAD from S6 (vec_in norm=1.663110)
[S11] cosine check vs S6: cos=0.9947
[S11] BUFFERED delta from S6 (total buffered=1)
[S13] sending update (kind=head size=1797 to 1 peers)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=32 metric=0.9070 head_norm=1.663110
[S6] _apply_head_vector_avg (torch): Δ‖w‖=8.225965e-02
[S6] stored merged vector for next round verification (round=32)
[S6] DEBUG after merge:  round=32 metric=0.8990 head_norm=1.632356 delta_norm=0.082260
[S6] aggregate: ROLLBACK (f1_val pre=0.907 post=0.899 tol_abs=0.005 tol_rel=0.0)
[S2] RECEIVED delta(kind=head bytes=1797) from S13
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.508015)
[S2] loaded HEAD from S13 (vec_in norm=1.508015)
[S2] cosine check vs S13: cos=0.9096
[S2] BUFFERED delta from S13 (total buffered=1)
[S2] START round=33 head_norm_before_train=1.507159 cos_to_last_merge=0.9973 (last merge round=29)
[S2] round=33 local utility u=0.059494 metrics={'f1_val': 0.7150968751013369, 'auprc': 0.7904869562249344, 'loss_val': 0.6711040841677183, 'psi': 0.7452529075507759}-{'f1_val': 0.7221962631006347, 'auprc': 0.7584933712564905, 'loss_val': 0.7367070017357896, 'psi': 0.7367151063629771}
[S3] START round=33 head_norm_before_train=1.426997 cos_to_last_merge=0.9986 (last merge round=30)
[S3] round=33 local utility u=0.067116 metrics={'f1_val': 0.9770431974898274, 'auprc': 0.998985572068237, 'loss_val': 0.11826708283099106, 'psi': 0.9858201473211912}-{'f1_val': 0.9603162089582811, 'auprc': 0.999003272829104, 'loss_val': 0.15219087333899767, 'psi': 0.9757910345066102}
[S4] START round=33 head_norm_before_train=1.681942 cos_to_last_merge=0.9997 (last merge round=30)
[S4] round=33 local utility u=0.451231 metrics={'f1_val': 0.8423196121734231, 'auprc': 0.9580886321962836, 'loss_val': 0.4162037524290576, 'psi': 0.8886272201825673}-{'f1_val': 0.7137667595216269, 'auprc': 0.9527476281867072, 'loss_val': 0.5313265996863633, 'psi': 0.8093591069876591}
[S5] START round=33 head_norm_before_train=1.508228 cos_to_last_merge=0.7584 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.758
[S5] round=33 local utility u=0.000000 metrics={'f1_val': 0.6195732942795243, 'auprc': 0.8558274548419267, 'loss_val': 0.5254552414713451, 'psi': 0.7140749585044852}-{'f1_val': 0.7005802511973405, 'auprc': 0.9896067545217674, 'loss_val': 0.1942714706300409, 'psi': 0.8161908525271112}
[S6] START round=33 head_norm_before_train=1.632356 cos_to_last_merge=1.0000 (last merge round=32)
[S6] round=33 local utility u=0.000000 metrics={'f1_val': 0.8161990984835741, 'auprc': 0.9285187352041239, 'loss_val': 0.5355248233091111, 'psi': 0.861126953171794}-{'f1_val': 0.9069582974104649, 'auprc': 0.9459213223288755, 'loss_val': 0.26130970262324565, 'psi': 0.9225435073778292}
[S7] START round=33 head_norm_before_train=1.528070 cos_to_last_merge=1.0000 (last merge round=32)
[S7] round=33 local utility u=0.499998 metrics={'f1_val': 0.6525673700991441, 'auprc': 0.8165631260016859, 'loss_val': 0.47613341748912197, 'psi': 0.7181656724601608}-{'f1_val': 0.5589071996338129, 'auprc': 0.786225906974614, 'loss_val': 0.8231573949898328, 'psi': 0.6498346825701333}
[S8] START round=33 head_norm_before_train=1.483573 cos_to_last_merge=1.0000 (last merge round=32)
[S8] round=33 local utility u=0.000000 metrics={'f1_val': 0.9670025593350691, 'auprc': 0.9989064635585293, 'loss_val': 0.09960196467205533, 'psi': 0.9797641210244531}-{'f1_val': 0.984123794071937, 'auprc': 0.9988800760274656, 'loss_val': 0.05561161796029128, 'psi': 0.9900263068541485}
[S9] START round=33 head_norm_before_train=1.419275 cos_to_last_merge=1.0000 (last merge round=32)
[S9] round=33 local utility u=0.028604 metrics={'f1_val': 0.9958601375429889, 'auprc': 0.9958934619001434, 'loss_val': 0.04671712526411383, 'psi': 0.9958734672858507}-{'f1_val': 0.9887042205730695, 'auprc': 0.9964451266052657, 'loss_val': 0.06264375786915685, 'psi': 0.991800582985948}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S9] sending update (kind=head size=1805 to 1 peers)
[S10] START round=33 head_norm_before_train=1.723955 cos_to_last_merge=0.9542 (last merge round=23)
[S10] round=33 local utility u=0.001511 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.995658692156417, 'loss_val': 0.03639785146786549, 'psi': 0.9949809409416034}-{'f1_val': 0.9947486092193725, 'auprc': 0.9945850623617709, 'loss_val': 0.03751693474009753, 'psi': 0.9946831904763318}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=33 head_norm_before_train=1.627296 cos_to_last_merge=0.9988 (last merge round=29)
[S11] round=33 local utility u=0.000000 metrics={'f1_val': 0.9963753869090841, 'auprc': 0.9967619339127376, 'loss_val': 0.04563285702328191, 'psi': 0.9965300057105455}-{'f1_val': 0.9967887165093644, 'auprc': 0.9978160010087722, 'loss_val': 0.04570470278923556, 'psi': 0.9971996303091275}
[S13] START round=33 head_norm_before_train=1.508015 cos_to_last_merge=0.9992 (last merge round=30)
[S13] round=33 local utility u=0.000000 metrics={'f1_val': 0.5830226339958413, 'auprc': 0.6077118958943986, 'loss_val': 0.8411097346047772, 'psi': 0.5928983387552642}-{'f1_val': 0.5678720078248523, 'auprc': 0.6869631377430924, 'loss_val': 0.82721902228973, 'psi': 0.6155084597921483}
[S14] START round=33 head_norm_before_train=1.574060 cos_to_last_merge=0.9971 (last merge round=30)
[S14] round=33 local utility u=0.008478 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9985620542869316, 'loss_val': 0.09103687849967862, 'psi': 0.9976233266093717}-{'f1_val': 0.9969755000837764, 'auprc': 0.9989340385309734, 'loss_val': 0.10897625986679288, 'psi': 0.9977589154626552}
[S15] START round=33 head_norm_before_train=1.995061 cos_to_last_merge=0.8212 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.821
[S15] round=33 local utility u=0.000000 metrics={'f1_val': 0.9006367235175576, 'auprc': 0.9962448011721943, 'loss_val': 0.22738254806542618, 'psi': 0.9388799545794122}-{'f1_val': 0.9967466683875206, 'auprc': 0.9981505838047038, 'loss_val': 0.020021440132466626, 'psi': 0.9973082345543939}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=33 head_norm_before_train=1.973823 (no previous merge yet)
[S16] round=33 local utility u=0.653551 metrics={'f1_val': 0.9148555000712607, 'auprc': 0.9935586895097953, 'loss_val': 0.392806921267749, 'psi': 0.9463367758466745}-{'f1_val': 0.8341585517508971, 'auprc': 0.935368742856298, 'loss_val': 1.041156969580926, 'psi': 0.8746426281930575}
[S17] START round=33 head_norm_before_train=1.490937 cos_to_last_merge=0.9996 (last merge round=31)
[S17] round=33 local utility u=0.000000 metrics={'f1_val': 0.6327789795338459, 'auprc': 0.8862340851589967, 'loss_val': 1.0397017760540954, 'psi': 0.7341610217839062}-{'f1_val': 0.6376100251871705, 'auprc': 0.8978815766177968, 'loss_val': 0.8725259444305912, 'psi': 0.7417186457594209}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:33214
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:33205
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.745)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:33211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:33210
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=33 metric=0.7151 head_norm=1.532462
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.283767e-01
[S2] stored merged vector for next round verification (round=33)
[S2] DEBUG after merge:  round=33 metric=0.7151 head_norm=1.484400 delta_norm=0.328377
[S2] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:33208
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=33 metric=0.9964 head_norm=1.645862
[S11] _apply_head_vector_avg (torch): Δ‖w‖=9.135536e-02
[S11] stored merged vector for next round verification (round=33)
[S11] DEBUG after merge:  round=33 metric=0.9964 head_norm=1.651984 delta_norm=0.091355
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S14] RECEIVED delta(kind=head bytes=1803) from S7
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.533784)
[S14] loaded HEAD from S7 (vec_in norm=1.533784)
[S14] cosine check vs S7: cos=0.9934
[S14] BUFFERED delta from S7 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1799) from S4
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.692155)
[S10] loaded HEAD from S4 (vec_in norm=1.692155)
[S10] cosine check vs S4: cos=0.9976
[S10] BUFFERED delta from S4 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1801) from S3
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.453235)
[S9] loaded HEAD from S3 (vec_in norm=1.453235)
[S9] cosine check vs S3: cos=0.9956
[S9] BUFFERED delta from S3 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1800) from S16
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.983841)
[S5] loaded HEAD from S16 (vec_in norm=1.983841)
[S5] cosine check vs S16: cos=-0.1112
[S5] DROPPED delta from S16 (cos=-0.1112 < 0.0)
[S14] sending update (kind=head size=1801 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1801) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.603229)
[S7] loaded HEAD from S14 (vec_in norm=1.603229)
[S7] cosine check vs S14: cos=0.9934
[S7] BUFFERED delta from S14 (total buffered=1)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=33 metric=0.9970 head_norm=1.603229
[S14] _apply_head_vector_avg (torch): Δ‖w‖=9.637357e-02
[S14] stored merged vector for next round verification (round=33)
[S14] DEBUG after merge:  round=33 metric=0.9970 head_norm=1.565928 delta_norm=0.096374
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=34 head_norm_before_train=1.484400 cos_to_last_merge=1.0000 (last merge round=33)
[S2] round=34 local utility u=0.000000 metrics={'f1_val': 0.7060222289291107, 'auprc': 0.7761132157059829, 'loss_val': 0.5809744051952763, 'psi': 0.7340586236398596}-{'f1_val': 0.7150968751013369, 'auprc': 0.7904869562249344, 'loss_val': 0.6711040841677183, 'psi': 0.7452529075507759}
[S3] START round=34 head_norm_before_train=1.453235 cos_to_last_merge=0.9965 (last merge round=30)
[S3] round=34 local utility u=0.059444 metrics={'f1_val': 0.9965342232254032, 'auprc': 0.999727517362235, 'loss_val': 0.11855186857488158, 'psi': 0.9978115408801359}-{'f1_val': 0.9770431974898274, 'auprc': 0.998985572068237, 'loss_val': 0.11826708283099106, 'psi': 0.9858201473211912}
[S4] START round=34 head_norm_before_train=1.692155 cos_to_last_merge=0.9995 (last merge round=30)
[S4] round=34 local utility u=0.361790 metrics={'f1_val': 0.9421536409292786, 'auprc': 0.9597112216416341, 'loss_val': 0.29649533175370313, 'psi': 0.9491766732142208}-{'f1_val': 0.8423196121734231, 'auprc': 0.9580886321962836, 'loss_val': 0.4162037524290576, 'psi': 0.8886272201825673}
[S5] START round=34 head_norm_before_train=1.514080 cos_to_last_merge=0.7577 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.758
[S5] round=34 local utility u=0.597106 metrics={'f1_val': 0.7005802511973405, 'auprc': 0.9897062344677534, 'loss_val': 0.2189210225823598, 'psi': 0.8162306445055056}-{'f1_val': 0.6195732942795243, 'auprc': 0.8558274548419267, 'loss_val': 0.5254552414713451, 'psi': 0.7140749585044852}
[S6] START round=34 head_norm_before_train=1.670973 cos_to_last_merge=0.9997 (last merge round=32)
[S6] round=34 local utility u=0.000000 metrics={'f1_val': 0.6560189145574217, 'auprc': 0.8191924053989313, 'loss_val': 0.9720472770456804, 'psi': 0.7212883108940256}-{'f1_val': 0.8161990984835741, 'auprc': 0.9285187352041239, 'loss_val': 0.5355248233091111, 'psi': 0.861126953171794}
[S7] START round=34 head_norm_before_train=1.533784 cos_to_last_merge=1.0000 (last merge round=32)
[S7] round=34 local utility u=0.007308 metrics={'f1_val': 0.6524002147989243, 'auprc': 0.8192197627183864, 'loss_val': 0.4684839802594313, 'psi': 0.7191280339667092}-{'f1_val': 0.6525673700991441, 'auprc': 0.8165631260016859, 'loss_val': 0.47613341748912197, 'psi': 0.7181656724601608}
[S8] START round=34 head_norm_before_train=1.551218 cos_to_last_merge=0.9992 (last merge round=32)
[S8] round=34 local utility u=0.066677 metrics={'f1_val': 0.9830696953248719, 'auprc': 0.9988749930370981, 'loss_val': 0.06255584478843698, 'psi': 0.9893918144097624}-{'f1_val': 0.9670025593350691, 'auprc': 0.9989064635585293, 'loss_val': 0.09960196467205533, 'psi': 0.9797641210244531}
[S9] START round=34 head_norm_before_train=1.438577 cos_to_last_merge=0.9999 (last merge round=32)
[S9] round=34 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9927414041459361, 'loss_val': 0.0424843441341384, 'psi': 0.9950928687467093}-{'f1_val': 0.9958601375429889, 'auprc': 0.9958934619001434, 'loss_val': 0.04671712526411383, 'psi': 0.9958734672858507}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=34 metric=0.9967 head_norm=1.457963
[S9] _apply_head_vector_avg (torch): Δ‖w‖=7.230487e-02
[S9] stored merged vector for next round verification (round=34)
[S9] DEBUG after merge:  round=34 metric=0.9967 head_norm=1.453804 delta_norm=0.072305
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S10] START round=34 head_norm_before_train=1.740687 cos_to_last_merge=0.9524 (last merge round=23)
[S10] round=34 local utility u=0.000975 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9953920749706427, 'loss_val': 0.034965048628868366, 'psi': 0.9950059955198807}-{'f1_val': 0.9945291067983943, 'auprc': 0.995658692156417, 'loss_val': 0.03639785146786549, 'psi': 0.9949809409416034}
[S10] not sending this round → trigger blocked (psi=0.995)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=34 metric=0.9947 head_norm=1.757954
[S10] _apply_head_vector_avg (torch): Δ‖w‖=7.280769e-02
[S10] stored merged vector for next round verification (round=34)
[S10] DEBUG after merge:  round=34 metric=0.9947 head_norm=1.723831 delta_norm=0.072808
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] START round=34 head_norm_before_train=1.651984 cos_to_last_merge=1.0000 (last merge round=33)
[S11] round=34 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9963350642952937, 'loss_val': 0.06035913491456477, 'psi': 0.996214230666103}-{'f1_val': 0.9963753869090841, 'auprc': 0.9967619339127376, 'loss_val': 0.04563285702328191, 'psi': 0.9965300057105455}
[S13] START round=34 head_norm_before_train=1.513831 cos_to_last_merge=0.9985 (last merge round=30)
[S13] round=34 local utility u=0.000000 metrics={'f1_val': 0.5303945482002322, 'auprc': 0.7038867677575351, 'loss_val': 0.9798095330887203, 'psi': 0.5997914360231533}-{'f1_val': 0.5830226339958413, 'auprc': 0.6077118958943986, 'loss_val': 0.8411097346047772, 'psi': 0.5928983387552642}
[S14] START round=34 head_norm_before_train=1.565928 cos_to_last_merge=1.0000 (last merge round=33)
[S14] round=34 local utility u=0.000000 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.998935703380923, 'loss_val': 0.10146800201076958, 'psi': 0.9980192430534045}-{'f1_val': 0.9969975081576651, 'auprc': 0.9985620542869316, 'loss_val': 0.09103687849967862, 'psi': 0.9976233266093717}
[S15] START round=34 head_norm_before_train=2.007845 cos_to_last_merge=0.8200 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.820
[S15] round=34 local utility u=0.394673 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9980288101489986, 'loss_val': 0.020048197176519053, 'psi': 0.9972595250921118}-{'f1_val': 0.9006367235175576, 'auprc': 0.9962448011721943, 'loss_val': 0.22738254806542618, 'psi': 0.9388799545794122}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] sending update (kind=head size=1802 to 1 peers)
[S16] START round=34 head_norm_before_train=1.983841 (no previous merge yet)
[S16] round=34 local utility u=0.026955 metrics={'f1_val': 0.9208961135159583, 'auprc': 0.9914975795639577, 'loss_val': 0.3689565589405179, 'psi': 0.949136699935158}-{'f1_val': 0.9148555000712607, 'auprc': 0.9935586895097953, 'loss_val': 0.392806921267749, 'psi': 0.9463367758466745}
[S17] START round=34 head_norm_before_train=1.523162 cos_to_last_merge=0.9988 (last merge round=31)
[S17] round=34 local utility u=0.048198 metrics={'f1_val': 0.6388058768030689, 'auprc': 0.8940675318849081, 'loss_val': 1.002967700586248, 'psi': 0.7409105388358046}-{'f1_val': 0.6327789795338459, 'auprc': 0.8862340851589967, 'loss_val': 1.0397017760540954, 'psi': 0.7341610217839062}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:33216
[S3] not sending this round → trigger blocked (psi=0.998)
[S16] not sending this round → trigger blocked (psi=0.949)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.719)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:33217
[S4] not sending this round → trigger blocked (psi=0.949)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1796 to 1 peers)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=34 metric=0.6524 head_norm=1.539650
[S7] _apply_head_vector_avg (torch): Δ‖w‖=9.565341e-02
[S7] stored merged vector for next round verification (round=34)
[S7] DEBUG after merge:  round=34 metric=0.6536 head_norm=1.568848 delta_norm=0.095653
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:33209
[S16] RECEIVED delta(kind=head bytes=1801) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.520033)
[S16] loaded HEAD from S5 (vec_in norm=1.520033)
[S16] cosine check vs S5: cos=-0.1102
[S16] DROPPED delta from S5 (cos=-0.1102 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1796) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.618473)
[S17] loaded HEAD from S8 (vec_in norm=1.618473)
[S17] cosine check vs S8: cos=0.9945
[S17] BUFFERED delta from S8 (total buffered=1)
[S17] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1800) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.552112)
[S8] loaded HEAD from S17 (vec_in norm=1.552112)
[S8] cosine check vs S17: cos=0.9945
[S8] BUFFERED delta from S17 (total buffered=1)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=34 metric=0.6388 head_norm=1.552112
[S17] _apply_head_vector_avg (torch): Δ‖w‖=8.942553e-02
[S17] stored merged vector for next round verification (round=34)
[S17] DEBUG after merge:  round=34 metric=0.6390 head_norm=1.583116 delta_norm=0.089426
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=35 head_norm_before_train=1.531292 cos_to_last_merge=0.9994 (last merge round=33)
[S2] round=35 local utility u=0.000000 metrics={'f1_val': 0.7137988714770895, 'auprc': 0.7744858720857175, 'loss_val': 0.6255279658355501, 'psi': 0.7380736717205407}-{'f1_val': 0.7060222289291107, 'auprc': 0.7761132157059829, 'loss_val': 0.5809744051952763, 'psi': 0.7340586236398596}
[S3] START round=35 head_norm_before_train=1.479202 cos_to_last_merge=0.9942 (last merge round=30)
[S3] round=35 local utility u=0.000000 metrics={'f1_val': 0.8929671552438692, 'auprc': 0.9993833536124177, 'loss_val': 0.22629082936931805, 'psi': 0.9355336345912886}-{'f1_val': 0.9965342232254032, 'auprc': 0.999727517362235, 'loss_val': 0.11855186857488158, 'psi': 0.9978115408801359}
[S4] START round=35 head_norm_before_train=1.699052 cos_to_last_merge=0.9991 (last merge round=30)
[S4] round=35 local utility u=0.000000 metrics={'f1_val': 0.9409367833391573, 'auprc': 0.9570348047110121, 'loss_val': 0.3044215218888279, 'psi': 0.9473759918878992}-{'f1_val': 0.9421536409292786, 'auprc': 0.9597112216416341, 'loss_val': 0.29649533175370313, 'psi': 0.9491766732142208}
[S5] START round=35 head_norm_before_train=1.520033 cos_to_last_merge=0.7572 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.757
[S5] round=35 local utility u=0.000000 metrics={'f1_val': 0.5766553246675868, 'auprc': 0.8558496287633337, 'loss_val': 0.5873694967391264, 'psi': 0.6883330463058857}-{'f1_val': 0.7005802511973405, 'auprc': 0.9897062344677534, 'loss_val': 0.2189210225823598, 'psi': 0.8162306445055056}
[S6] START round=35 head_norm_before_train=1.710151 cos_to_last_merge=0.9990 (last merge round=32)
[S6] round=35 local utility u=0.882474 metrics={'f1_val': 0.8141284769746417, 'auprc': 0.9300367611656182, 'loss_val': 0.4882904479108916, 'psi': 0.8604917906510323}-{'f1_val': 0.6560189145574217, 'auprc': 0.8191924053989313, 'loss_val': 0.9720472770456804, 'psi': 0.7212883108940256}
[S7] START round=35 head_norm_before_train=1.568848 cos_to_last_merge=1.0000 (last merge round=34)
[S7] round=35 local utility u=0.000000 metrics={'f1_val': 0.5991323374845666, 'auprc': 0.7983709607649592, 'loss_val': 0.6114687976460929, 'psi': 0.6788277867967236}-{'f1_val': 0.6524002147989243, 'auprc': 0.8192197627183864, 'loss_val': 0.4684839802594313, 'psi': 0.7191280339667092}
[S8] START round=35 head_norm_before_train=1.618473 cos_to_last_merge=0.9974 (last merge round=32)
[S8] round=35 local utility u=0.029450 metrics={'f1_val': 0.9902548310888247, 'auprc': 0.9987500793238734, 'loss_val': 0.04639222659638938, 'psi': 0.9936529303828442}-{'f1_val': 0.9830696953248719, 'auprc': 0.9988749930370981, 'loss_val': 0.06255584478843698, 'psi': 0.9893918144097624}
[S9] START round=35 head_norm_before_train=1.453804 cos_to_last_merge=1.0000 (last merge round=34)
[S9] round=35 local utility u=0.000000 metrics={'f1_val': 0.9954158325366191, 'auprc': 0.995782072382226, 'loss_val': 0.04435767080647932, 'psi': 0.9955623284748619}-{'f1_val': 0.9966605118138915, 'auprc': 0.9927414041459361, 'loss_val': 0.0424843441341384, 'psi': 0.9950928687467093}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=35 head_norm_before_train=1.723831 cos_to_last_merge=1.0000 (last merge round=34)
[S10] round=35 local utility u=0.000000 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9958248621932683, 'loss_val': 0.0365771678617462, 'psi': 0.9950474089563439}-{'f1_val': 0.9947486092193725, 'auprc': 0.9953920749706427, 'loss_val': 0.034965048628868366, 'psi': 0.9950059955198807}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=35 head_norm_before_train=1.668965 cos_to_last_merge=0.9999 (last merge round=33)
[S11] round=35 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9963380212200394, 'loss_val': 0.06884024071408469, 'psi': 0.9962154134360014}-{'f1_val': 0.9961336749133093, 'auprc': 0.9963350642952937, 'loss_val': 0.06035913491456477, 'psi': 0.996214230666103}
[S13] START round=35 head_norm_before_train=1.521282 cos_to_last_merge=0.9980 (last merge round=30)
[S13] round=35 local utility u=0.242127 metrics={'f1_val': 0.5997400036173947, 'auprc': 0.6707060165395526, 'loss_val': 0.812086764856721, 'psi': 0.6281264087862579}-{'f1_val': 0.5303945482002322, 'auprc': 0.7038867677575351, 'loss_val': 0.9798095330887203, 'psi': 0.5997914360231533}
[S14] START round=35 head_norm_before_train=1.591008 cos_to_last_merge=0.9996 (last merge round=33)
[S14] round=35 local utility u=0.007414 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.999024969395246, 'loss_val': 0.08444324471225076, 'psi': 0.9978084926526974}-{'f1_val': 0.9974082695017256, 'auprc': 0.998935703380923, 'loss_val': 0.10146800201076958, 'psi': 0.9980192430534045}
[S15] START round=35 head_norm_before_train=2.020525 cos_to_last_merge=0.8189 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.819
[S15] round=35 local utility u=0.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9979102308662937, 'loss_val': 0.020495105309316655, 'psi': 0.9972120933790298}-{'f1_val': 0.9967466683875206, 'auprc': 0.9980288101489986, 'loss_val': 0.020048197176519053, 'psi': 0.9972595250921118}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=35 head_norm_before_train=1.990530 (no previous merge yet)
[S16] round=35 local utility u=0.000000 metrics={'f1_val': 0.8362135642487929, 'auprc': 0.9837099762654837, 'loss_val': 1.018889819366933, 'psi': 0.8952121290554692}-{'f1_val': 0.9208961135159583, 'auprc': 0.9914975795639577, 'loss_val': 0.3689565589405179, 'psi': 0.949136699935158}
[S17] START round=35 head_norm_before_train=1.583116 cos_to_last_merge=1.0000 (last merge round=34)
[S17] round=35 local utility u=0.000000 metrics={'f1_val': 0.634627629824458, 'auprc': 0.8622481677672944, 'loss_val': 1.081764398268391, 'psi': 0.7256758450015925}-{'f1_val': 0.6388058768030689, 'auprc': 0.8940675318849081, 'loss_val': 1.002967700586248, 'psi': 0.7409105388358046}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.994)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:33212
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] ⇄ pheromone p=0.118 → S9@127.0.0.1:33210
[S6] sending update (kind=head size=1796 to 1 peers)
[S4] ⇄ pheromone p=0.125 → S10@127.0.0.1:33211
[S5] ⇄ pheromone p=0.343 → S16@127.0.0.1:33216
[S7] ⇄ pheromone p=0.130 → S14@127.0.0.1:33214
[S11] ⇄ pheromone p=0.054 → S6@127.0.0.1:33207
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=35 metric=0.9903 head_norm=1.673882
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.174184e-01
[S8] stored merged vector for next round verification (round=35)
[S8] DEBUG after merge:  round=35 metric=0.9903 head_norm=1.609869 delta_norm=0.117418
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.034 → S17@127.0.0.1:33217
[S16] ⇄ pheromone p=0.183 → S5@127.0.0.1:33205
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:33202
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:33208
[S11] RECEIVED delta(kind=head bytes=1796) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.743391)
[S11] loaded HEAD from S6 (vec_in norm=1.743391)
[S11] cosine check vs S6: cos=0.9975
[S11] BUFFERED delta from S6 (total buffered=1)
[S14] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S6] ⇄ pheromone p=0.386 → S11@127.0.0.1:33212
[S2] RECEIVED delta(kind=head bytes=1798) from S13
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.528294)
[S2] loaded HEAD from S13 (vec_in norm=1.528294)
[S2] cosine check vs S13: cos=0.9632
[S2] BUFFERED delta from S13 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1800) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.616176)
[S7] loaded HEAD from S14 (vec_in norm=1.616176)
[S7] cosine check vs S14: cos=0.9987
[S7] BUFFERED delta from S14 (total buffered=1)
[S17] ⇄ pheromone p=0.058 → S3@127.0.0.1:33203
[S13] ⇄ pheromone p=0.091 → S2@127.0.0.1:33202
[S14] ⇄ pheromone p=0.009 → S15@127.0.0.1:33215
[S2] START round=36 head_norm_before_train=1.585705 cos_to_last_merge=0.9979 (last merge round=33)
[S2] round=36 local utility u=0.000000 metrics={'f1_val': 0.6824660101933219, 'auprc': 0.7747062269363376, 'loss_val': 0.7533174822997875, 'psi': 0.7193620968905281}-{'f1_val': 0.7137988714770895, 'auprc': 0.7744858720857175, 'loss_val': 0.6255279658355501, 'psi': 0.7380736717205407}
[S3] START round=36 head_norm_before_train=1.503630 cos_to_last_merge=0.9918 (last merge round=30)
[S3] round=36 local utility u=0.352461 metrics={'f1_val': 0.9881874584154944, 'auprc': 0.9997152902483333, 'loss_val': 0.09368620498544335, 'psi': 0.9927985911486299}-{'f1_val': 0.8929671552438692, 'auprc': 0.9993833536124177, 'loss_val': 0.22629082936931805, 'psi': 0.9355336345912886}
[S4] START round=36 head_norm_before_train=1.709576 cos_to_last_merge=0.9990 (last merge round=30)
[S4] round=36 local utility u=0.000000 metrics={'f1_val': 0.9405743470166742, 'auprc': 0.9535716933439244, 'loss_val': 0.3200602965830138, 'psi': 0.9457732855475743}-{'f1_val': 0.9409367833391573, 'auprc': 0.9570348047110121, 'loss_val': 0.3044215218888279, 'psi': 0.9473759918878992}
[S5] START round=36 head_norm_before_train=1.525136 cos_to_last_merge=0.7570 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.757
[S5] round=36 local utility u=0.298568 metrics={'f1_val': 0.6325881784938234, 'auprc': 0.8742292383556294, 'loss_val': 0.3809696134115744, 'psi': 0.7292446024385457}-{'f1_val': 0.5766553246675868, 'auprc': 0.8558496287633337, 'loss_val': 0.5873694967391264, 'psi': 0.6883330463058857}
[S6] START round=36 head_norm_before_train=1.743391 cos_to_last_merge=0.9983 (last merge round=32)
[S6] round=36 local utility u=0.000000 metrics={'f1_val': 0.7279806435249426, 'auprc': 0.8809030546393335, 'loss_val': 0.7854184943466289, 'psi': 0.789149607970699}-{'f1_val': 0.8141284769746417, 'auprc': 0.9300367611656182, 'loss_val': 0.4882904479108916, 'psi': 0.8604917906510323}
[S7] START round=36 head_norm_before_train=1.575521 cos_to_last_merge=1.0000 (last merge round=34)
[S7] round=36 local utility u=0.159354 metrics={'f1_val': 0.6356225262097872, 'auprc': 0.8040554825571125, 'loss_val': 0.5287556095701549, 'psi': 0.7029957087487173}-{'f1_val': 0.5991323374845666, 'auprc': 0.7983709607649592, 'loss_val': 0.6114687976460929, 'psi': 0.6788277867967236}
[S8] START round=36 head_norm_before_train=1.609869 cos_to_last_merge=1.0000 (last merge round=35)
[S8] round=36 local utility u=0.004265 metrics={'f1_val': 0.9928060536955421, 'auprc': 0.9970804857624428, 'loss_val': 0.04816147154167691, 'psi': 0.9945158265223024}-{'f1_val': 0.9902548310888247, 'auprc': 0.9987500793238734, 'loss_val': 0.04639222659638938, 'psi': 0.9936529303828442}
[S9] START round=36 head_norm_before_train=1.471835 cos_to_last_merge=0.9999 (last merge round=34)
[S9] round=36 local utility u=0.000000 metrics={'f1_val': 0.9903801002864661, 'auprc': 0.9949809303179408, 'loss_val': 0.05054781571592512, 'psi': 0.9922204322990559}-{'f1_val': 0.9954158325366191, 'auprc': 0.995782072382226, 'loss_val': 0.04435767080647932, 'psi': 0.9955623284748619}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=36 head_norm_before_train=1.741021 cos_to_last_merge=1.0000 (last merge round=34)
[S10] round=36 local utility u=0.000078 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9955219315320265, 'loss_val': 0.03551232048596969, 'psi': 0.9949262366918472}-{'f1_val': 0.9945291067983943, 'auprc': 0.9958248621932683, 'loss_val': 0.0365771678617462, 'psi': 0.9950474089563439}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=36 head_norm_before_train=1.686680 cos_to_last_merge=0.9998 (last merge round=33)
[S11] round=36 local utility u=0.000000 metrics={'f1_val': 0.8298676996044743, 'auprc': 0.996330833634939, 'loss_val': 0.2591895389778312, 'psi': 0.8964529532166602}-{'f1_val': 0.9961336749133093, 'auprc': 0.9963380212200394, 'loss_val': 0.06884024071408469, 'psi': 0.9962154134360014}
[S13] START round=36 head_norm_before_train=1.528294 cos_to_last_merge=0.9982 (last merge round=30)
[S13] round=36 local utility u=0.000000 metrics={'f1_val': 0.5234339056078738, 'auprc': 0.7018193986455604, 'loss_val': 1.034487023380119, 'psi': 0.5947881028229485}-{'f1_val': 0.5997400036173947, 'auprc': 0.6707060165395526, 'loss_val': 0.812086764856721, 'psi': 0.6281264087862579}
[S14] START round=36 head_norm_before_train=1.616176 cos_to_last_merge=0.9987 (last merge round=33)
[S14] round=36 local utility u=0.002441 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9970466035710137, 'loss_val': 0.0760897867474934, 'psi': 0.9972636031294408}-{'f1_val': 0.9969975081576651, 'auprc': 0.999024969395246, 'loss_val': 0.08444324471225076, 'psi': 0.9978084926526974}
[S15] START round=36 head_norm_before_train=2.032990 cos_to_last_merge=0.8178 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.818
[S15] round=36 local utility u=0.000000 metrics={'f1_val': 0.9027468058956304, 'auprc': 0.9967751898838382, 'loss_val': 0.24973873516533915, 'psi': 0.9403581594909136}-{'f1_val': 0.9967466683875206, 'auprc': 0.9979102308662937, 'loss_val': 0.020495105309316655, 'psi': 0.9972120933790298}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=36 head_norm_before_train=1.998121 (no previous merge yet)
[S16] round=36 local utility u=0.877842 metrics={'f1_val': 0.9735756345082116, 'auprc': 0.983786765442126, 'loss_val': 0.08760777800395048, 'psi': 0.9776600868817773}-{'f1_val': 0.8362135642487929, 'auprc': 0.9837099762654837, 'loss_val': 1.018889819366933, 'psi': 0.8952121290554692}
[S17] START round=36 head_norm_before_train=1.607767 cos_to_last_merge=0.9999 (last merge round=34)
[S17] round=36 local utility u=0.521461 metrics={'f1_val': 0.7179212652786315, 'auprc': 0.9197801087000328, 'loss_val': 0.711200751295593, 'psi': 0.7986648026471921}-{'f1_val': 0.634627629824458, 'auprc': 0.8622481677672944, 'loss_val': 1.081764398268391, 'psi': 0.7256758450015925}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:33214
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:33217
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:33216
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:33210
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:33205
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1798 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=36 metric=0.8299 head_norm=1.702918
[S11] _apply_head_vector_avg (torch): Δ‖w‖=6.906255e-02
[S11] stored merged vector for next round verification (round=36)
[S11] DEBUG after merge:  round=36 metric=0.8309 head_norm=1.721889 delta_norm=0.069063
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S3] sending update (kind=head size=1798 to 1 peers)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=36 metric=0.6825 head_norm=1.631406
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.359143e-01
[S2] stored merged vector for next round verification (round=36)
[S2] DEBUG after merge:  round=36 metric=0.6766 head_norm=1.562987 delta_norm=0.235914
[S2] aggregate: ROLLBACK (f1_val pre=0.682 post=0.677 tol_abs=0.005 tol_rel=0.0)
[S5] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:33203
[S8] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S14] not sending this round → trigger blocked (psi=0.997)
[S16] RECEIVED delta(kind=head bytes=1801) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.529122)
[S16] loaded HEAD from S5 (vec_in norm=1.529122)
[S16] cosine check vs S5: cos=-0.1091
[S16] DROPPED delta from S5 (cos=-0.1091 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1798) from S3
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.525128)
[S9] loaded HEAD from S3 (vec_in norm=1.525128)
[S9] cosine check vs S3: cos=0.9933
[S9] BUFFERED delta from S3 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1802) from S7
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.584811)
[S14] loaded HEAD from S7 (vec_in norm=1.584811)
[S14] cosine check vs S7: cos=0.9974
[S14] BUFFERED delta from S7 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1798) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.654118)
[S17] loaded HEAD from S8 (vec_in norm=1.654118)
[S17] cosine check vs S8: cos=0.9991
[S17] BUFFERED delta from S8 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1798) from S16
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=2.002087)
[S5] loaded HEAD from S16 (vec_in norm=2.002087)
[S5] cosine check vs S16: cos=-0.1091
[S5] DROPPED delta from S16 (cos=-0.1091 < 0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=36 metric=0.6356 head_norm=1.584811
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.461245e-02
[S7] stored merged vector for next round verification (round=36)
[S7] DEBUG after merge:  round=36 metric=0.6344 head_norm=1.599948 delta_norm=0.044612
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S17] sending update (kind=head size=1795 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1795) from S17
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.623686)
[S3] loaded HEAD from S17 (vec_in norm=1.623686)
[S3] cosine check vs S17: cos=0.8934
[S3] BUFFERED delta from S17 (total buffered=1)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=36 metric=0.9974 head_norm=1.641206
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.428304e-02
[S14] stored merged vector for next round verification (round=36)
[S14] DEBUG after merge:  round=36 metric=0.9974 head_norm=1.611974 delta_norm=0.064283
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=36 metric=0.7179 head_norm=1.623686
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.811729e-02
[S17] stored merged vector for next round verification (round=36)
[S17] DEBUG after merge:  round=36 metric=0.7191 head_norm=1.638530 delta_norm=0.038117
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=37 head_norm_before_train=1.562987 cos_to_last_merge=1.0000 (last merge round=36)
[S2] round=37 local utility u=0.197434 metrics={'f1_val': 0.7101572408932707, 'auprc': 0.7875691289617761, 'loss_val': 0.5631848580029234, 'psi': 0.7411219961206729}-{'f1_val': 0.6824660101933219, 'auprc': 0.7747062269363376, 'loss_val': 0.7533174822997875, 'psi': 0.7193620968905281}
[S3] START round=37 head_norm_before_train=1.525128 cos_to_last_merge=0.9896 (last merge round=30)
[S3] round=37 local utility u=0.000000 metrics={'f1_val': 0.9603561684511364, 'auprc': 0.9993583439233884, 'loss_val': 0.12774674609295883, 'psi': 0.9759570386400371}-{'f1_val': 0.9881874584154944, 'auprc': 0.9997152902483333, 'loss_val': 0.09368620498544335, 'psi': 0.9927985911486299}
[S4] START round=37 head_norm_before_train=1.719929 cos_to_last_merge=0.9988 (last merge round=30)
[S4] round=37 local utility u=0.033110 metrics={'f1_val': 0.9492391848264841, 'auprc': 0.9503022609982926, 'loss_val': 0.2960219082249259, 'psi': 0.9496644152952074}-{'f1_val': 0.9405743470166742, 'auprc': 0.9535716933439244, 'loss_val': 0.3200602965830138, 'psi': 0.9457732855475743}
[S5] START round=37 head_norm_before_train=1.529122 cos_to_last_merge=0.7563 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.756
[S5] round=37 local utility u=0.000000 metrics={'f1_val': 0.5804650123441957, 'auprc': 0.8573264591632959, 'loss_val': 0.517647745813927, 'psi': 0.6912095910718358}-{'f1_val': 0.6325881784938234, 'auprc': 0.8742292383556294, 'loss_val': 0.3809696134115744, 'psi': 0.7292446024385457}
[S6] START round=37 head_norm_before_train=1.767324 cos_to_last_merge=0.9979 (last merge round=32)
[S6] round=37 local utility u=0.000000 metrics={'f1_val': 0.6690492748543562, 'auprc': 0.8583689705888053, 'loss_val': 1.0182163667333322, 'psi': 0.7447771531481358}-{'f1_val': 0.7279806435249426, 'auprc': 0.8809030546393335, 'loss_val': 0.7854184943466289, 'psi': 0.789149607970699}
[S7] START round=37 head_norm_before_train=1.599948 cos_to_last_merge=1.0000 (last merge round=36)
[S7] round=37 local utility u=0.000000 metrics={'f1_val': 0.5232857808645979, 'auprc': 0.7832170963445438, 'loss_val': 0.7958421567572573, 'psi': 0.6272583070565763}-{'f1_val': 0.6356225262097872, 'auprc': 0.8040554825571125, 'loss_val': 0.5287556095701549, 'psi': 0.7029957087487173}
[S8] START round=37 head_norm_before_train=1.654118 cos_to_last_merge=0.9998 (last merge round=35)
[S8] round=37 local utility u=0.000000 metrics={'f1_val': 0.9432485569936719, 'auprc': 0.9988663902058594, 'loss_val': 0.13676484758611746, 'psi': 0.965495690278547}-{'f1_val': 0.9928060536955421, 'auprc': 0.9970804857624428, 'loss_val': 0.04816147154167691, 'psi': 0.9945158265223024}
[S9] START round=37 head_norm_before_train=1.488348 cos_to_last_merge=0.9998 (last merge round=34)
[S9] round=37 local utility u=0.023054 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9935417205787699, 'loss_val': 0.03780373828136936, 'psi': 0.9954129953198428}-{'f1_val': 0.9903801002864661, 'auprc': 0.9949809303179408, 'loss_val': 0.05054781571592512, 'psi': 0.9922204322990559}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=37 metric=0.9967 head_norm=1.503613
[S9] _apply_head_vector_avg (torch): Δ‖w‖=9.136081e-02
[S9] stored merged vector for next round verification (round=37)
[S9] DEBUG after merge:  round=37 metric=0.9967 head_norm=1.511650 delta_norm=0.091361
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S10] START round=37 head_norm_before_train=1.758898 cos_to_last_merge=0.9999 (last merge round=34)
[S10] round=37 local utility u=0.000949 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.995338153299738, 'loss_val': 0.03438039102495935, 'psi': 0.9949844268515187}-{'f1_val': 0.9945291067983943, 'auprc': 0.9955219315320265, 'loss_val': 0.03551232048596969, 'psi': 0.9949262366918472}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=37 head_norm_before_train=1.721889 cos_to_last_merge=1.0000 (last merge round=36)
[S11] round=37 local utility u=0.611720 metrics={'f1_val': 0.9963753869090841, 'auprc': 0.9976660788816469, 'loss_val': 0.038801948303002466, 'psi': 0.9968916636981093}-{'f1_val': 0.8298676996044743, 'auprc': 0.996330833634939, 'loss_val': 0.2591895389778312, 'psi': 0.8964529532166602}
[S13] START round=37 head_norm_before_train=1.532153 cos_to_last_merge=0.9978 (last merge round=30)
[S13] round=37 local utility u=0.000000 metrics={'f1_val': 0.5213450801813417, 'auprc': 0.6991993829607803, 'loss_val': 1.04061688651576, 'psi': 0.5924868012931173}-{'f1_val': 0.5234339056078738, 'auprc': 0.7018193986455604, 'loss_val': 1.034487023380119, 'psi': 0.5947881028229485}
[S14] START round=37 head_norm_before_train=1.611974 cos_to_last_merge=1.0000 (last merge round=36)
[S14] round=37 local utility u=0.000000 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9968437853715402, 'loss_val': 0.07702947603196775, 'psi': 0.996936019043215}-{'f1_val': 0.9974082695017256, 'auprc': 0.9970466035710137, 'loss_val': 0.0760897867474934, 'psi': 0.9972636031294408}
[S15] START round=37 head_norm_before_train=2.043654 cos_to_last_merge=0.8170 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.817
[S15] round=37 local utility u=0.047797 metrics={'f1_val': 0.9026184145866213, 'auprc': 0.9962153675783112, 'loss_val': 0.15169537151913717, 'psi': 0.9400571957832973}-{'f1_val': 0.9027468058956304, 'auprc': 0.9967751898838382, 'loss_val': 0.24973873516533915, 'psi': 0.9403581594909136}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=37 head_norm_before_train=2.002087 (no previous merge yet)
[S16] round=37 local utility u=0.083846 metrics={'f1_val': 0.993348193726548, 'auprc': 0.9851857216469695, 'loss_val': 0.0427472806478304, 'psi': 0.9900832048947166}-{'f1_val': 0.9735756345082116, 'auprc': 0.983786765442126, 'loss_val': 0.08760777800395048, 'psi': 0.9776600868817773}
[S17] START round=37 head_norm_before_train=1.638530 cos_to_last_merge=1.0000 (last merge round=36)
[S17] round=37 local utility u=0.000000 metrics={'f1_val': 0.6278240157370654, 'auprc': 0.8946661149268109, 'loss_val': 1.1614885580103305, 'psi': 0.7345608554129636}-{'f1_val': 0.7179212652786315, 'auprc': 0.9197801087000328, 'loss_val': 0.711200751295593, 'psi': 0.7986648026471921}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:33211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:33207
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:33213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:33205
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1800 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=37 metric=0.9604 head_norm=1.544726
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.701641e-01
[S3] stored merged vector for next round verification (round=37)
[S3] DEBUG after merge:  round=37 metric=0.9604 head_norm=1.540859 delta_norm=0.370164
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1799 to 1 peers)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] RECEIVED delta(kind=head bytes=1799) from S4
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.723342)
[S10] loaded HEAD from S4 (vec_in norm=1.723342)
[S10] cosine check vs S4: cos=0.9973
[S10] BUFFERED delta from S4 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1801) from S11
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.736789)
[S6] loaded HEAD from S11 (vec_in norm=1.736789)
[S6] cosine check vs S11: cos=0.9981
[S6] BUFFERED delta from S11 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1800) from S16
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=2.008904)
[S5] loaded HEAD from S16 (vec_in norm=2.008904)
[S5] cosine check vs S16: cos=-0.1080
[S5] DROPPED delta from S16 (cos=-0.1080 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1802) from S2
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.607476)
[S13] loaded HEAD from S2 (vec_in norm=1.607476)
[S13] cosine check vs S2: cos=0.9836
[S13] BUFFERED delta from S2 (total buffered=1)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=37 metric=0.5213 head_norm=1.539304
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.462904e-01
[S13] stored merged vector for next round verification (round=37)
[S13] DEBUG after merge:  round=37 metric=0.5223 head_norm=1.566945 delta_norm=0.146290
[S13] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=38 head_norm_before_train=1.607476 cos_to_last_merge=0.9995 (last merge round=36)
[S2] round=38 local utility u=0.000000 metrics={'f1_val': 0.7075009148988578, 'auprc': 0.7918160181093647, 'loss_val': 0.586163183812559, 'psi': 0.7412269561830606}-{'f1_val': 0.7101572408932707, 'auprc': 0.7875691289617761, 'loss_val': 0.5631848580029234, 'psi': 0.7411219961206729}
[S3] START round=38 head_norm_before_train=1.540859 cos_to_last_merge=1.0000 (last merge round=37)
[S3] round=38 local utility u=0.000000 metrics={'f1_val': 0.9494717760989486, 'auprc': 0.9933687687090853, 'loss_val': 0.15445645910602163, 'psi': 0.9670305731430032}-{'f1_val': 0.9603561684511364, 'auprc': 0.9993583439233884, 'loss_val': 0.12774674609295883, 'psi': 0.9759570386400371}
[S4] START round=38 head_norm_before_train=1.723342 cos_to_last_merge=0.9986 (last merge round=30)
[S4] round=38 local utility u=0.000000 metrics={'f1_val': 0.9417569064254843, 'auprc': 0.959488318953003, 'loss_val': 0.3042450331374834, 'psi': 0.9488494714364917}-{'f1_val': 0.9492391848264841, 'auprc': 0.9503022609982926, 'loss_val': 0.2960219082249259, 'psi': 0.9496644152952074}
[S5] START round=38 head_norm_before_train=1.534263 cos_to_last_merge=0.7558 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.756
[S5] round=38 local utility u=0.682994 metrics={'f1_val': 0.7005797538498719, 'auprc': 0.9778814840390855, 'loss_val': 0.2340126696711186, 'psi': 0.8115004459255574}-{'f1_val': 0.5804650123441957, 'auprc': 0.8573264591632959, 'loss_val': 0.517647745813927, 'psi': 0.6912095910718358}
[S6] START round=38 head_norm_before_train=1.798009 cos_to_last_merge=0.9970 (last merge round=32)
[S6] round=38 local utility u=0.685428 metrics={'f1_val': 0.7966701723163558, 'auprc': 0.9251787722846072, 'loss_val': 0.6135158768464987, 'psi': 0.8480736123036563}-{'f1_val': 0.6690492748543562, 'auprc': 0.8583689705888053, 'loss_val': 1.0182163667333322, 'psi': 0.7447771531481358}
[S7] START round=38 head_norm_before_train=1.608087 cos_to_last_merge=1.0000 (last merge round=36)
[S7] round=38 local utility u=0.499909 metrics={'f1_val': 0.6355762766580711, 'auprc': 0.8024752785556346, 'loss_val': 0.5275417384976386, 'psi': 0.7023358774170965}-{'f1_val': 0.5232857808645979, 'auprc': 0.7832170963445438, 'loss_val': 0.7958421567572573, 'psi': 0.6272583070565763}
[S8] START round=38 head_norm_before_train=1.691883 cos_to_last_merge=0.9993 (last merge round=35)
[S8] round=38 local utility u=0.192685 metrics={'f1_val': 0.9914375510364866, 'auprc': 0.9983619204853246, 'loss_val': 0.03901603063394448, 'psi': 0.9942072988160218}-{'f1_val': 0.9432485569936719, 'auprc': 0.9988663902058594, 'loss_val': 0.13676484758611746, 'psi': 0.965495690278547}
[S9] START round=38 head_norm_before_train=1.511650 cos_to_last_merge=1.0000 (last merge round=37)
[S9] round=38 local utility u=0.002580 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9953438866148404, 'loss_val': 0.038050547763425174, 'psi': 0.996133861734271}-{'f1_val': 0.9966605118138915, 'auprc': 0.9935417205787699, 'loss_val': 0.03780373828136936, 'psi': 0.9954129953198428}
[S9] not sending this round → trigger blocked (psi=0.996)
[S10] START round=38 head_norm_before_train=1.774396 cos_to_last_merge=0.9997 (last merge round=34)
[S10] round=38 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9945593316400785, 'loss_val': 0.03310528114373513, 'psi': 0.9946728981876549}-{'f1_val': 0.9947486092193725, 'auprc': 0.995338153299738, 'loss_val': 0.03438039102495935, 'psi': 0.9949844268515187}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=38 metric=0.9947 head_norm=1.789596
[S10] _apply_head_vector_avg (torch): Δ‖w‖=7.708430e-02
[S10] stored merged vector for next round verification (round=38)
[S10] DEBUG after merge:  round=38 metric=0.9947 head_norm=1.755089 delta_norm=0.077084
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] START round=38 head_norm_before_train=1.736789 cos_to_last_merge=1.0000 (last merge round=36)
[S11] round=38 local utility u=0.003483 metrics={'f1_val': 0.9967887165093644, 'auprc': 0.9975560842185747, 'loss_val': 0.03398567454652422, 'psi': 0.9970956635930486}-{'f1_val': 0.9963753869090841, 'auprc': 0.9976660788816469, 'loss_val': 0.038801948303002466, 'psi': 0.9968916636981093}
[S13] START round=38 head_norm_before_train=1.566945 cos_to_last_merge=1.0000 (last merge round=37)
[S13] round=38 local utility u=0.000000 metrics={'f1_val': 0.5215454600026957, 'auprc': 0.6878902580095294, 'loss_val': 1.0281831843572822, 'psi': 0.5880833792054292}-{'f1_val': 0.5213450801813417, 'auprc': 0.6991993829607803, 'loss_val': 1.04061688651576, 'psi': 0.5924868012931173}
[S14] START round=38 head_norm_before_train=1.634411 cos_to_last_merge=0.9998 (last merge round=36)
[S14] round=38 local utility u=0.000000 metrics={'f1_val': 0.9963442551067831, 'auprc': 0.9928536076477601, 'loss_val': 0.07268690884806184, 'psi': 0.9949479961231739}-{'f1_val': 0.9969975081576651, 'auprc': 0.9968437853715402, 'loss_val': 0.07702947603196775, 'psi': 0.996936019043215}
[S15] START round=38 head_norm_before_train=2.054491 cos_to_last_merge=0.8159 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.816
[S15] round=38 local utility u=0.000000 metrics={'f1_val': 0.9027624067881995, 'auprc': 0.9967236672076097, 'loss_val': 0.18123714653816664, 'psi': 0.9403469109559637}-{'f1_val': 0.9026184145866213, 'auprc': 0.9962153675783112, 'loss_val': 0.15169537151913717, 'psi': 0.9400571957832973}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=38 head_norm_before_train=2.008904 (no previous merge yet)
[S16] round=38 local utility u=0.005944 metrics={'f1_val': 0.9930602907512753, 'auprc': 0.9878720669022523, 'loss_val': 0.037191717955184604, 'psi': 0.9909850012116661}-{'f1_val': 0.993348193726548, 'auprc': 0.9851857216469695, 'loss_val': 0.0427472806478304, 'psi': 0.9900832048947166}
[S17] START round=38 head_norm_before_train=1.650722 cos_to_last_merge=1.0000 (last merge round=36)
[S17] round=38 local utility u=0.040864 metrics={'f1_val': 0.6317149351119702, 'auprc': 0.8878076427683423, 'loss_val': 1.0825313570578943, 'psi': 0.734152018174519}-{'f1_val': 0.6278240157370654, 'auprc': 0.8946661149268109, 'loss_val': 1.1614885580103305, 'psi': 0.7345608554129636}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:33217
[S11] not sending this round → trigger blocked (psi=0.997)
[S16] not sending this round → trigger blocked (psi=0.991)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] → sending delta(kind=head bytes=1805) to S16@127.0.0.1:33216
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:33212
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1805 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1799 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S3@127.0.0.1:33203
[S16] RECEIVED delta(kind=head bytes=1805) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.539733)
[S16] loaded HEAD from S5 (vec_in norm=1.539733)
[S16] cosine check vs S5: cos=-0.1068
[S16] DROPPED delta from S5 (cos=-0.1068 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1799) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.729147)
[S17] loaded HEAD from S8 (vec_in norm=1.729147)
[S17] cosine check vs S8: cos=0.9985
[S17] BUFFERED delta from S8 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1796) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.816099)
[S11] loaded HEAD from S6 (vec_in norm=1.816099)
[S11] cosine check vs S6: cos=0.9973
[S11] BUFFERED delta from S6 (total buffered=1)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=38 metric=0.7967 head_norm=1.816099
[S6] _apply_head_vector_avg (torch): Δ‖w‖=7.298843e-02
[S6] stored merged vector for next round verification (round=38)
[S6] DEBUG after merge:  round=38 metric=0.7970 head_norm=1.775387 delta_norm=0.072988
[S6] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S17] sending update (kind=head size=1804 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1804) from S17
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.662539)
[S3] loaded HEAD from S17 (vec_in norm=1.662539)
[S3] cosine check vs S17: cos=0.9700
[S3] BUFFERED delta from S17 (total buffered=1)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=38 metric=0.6317 head_norm=1.662539
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.731802e-02
[S17] stored merged vector for next round verification (round=38)
[S17] DEBUG after merge:  round=38 metric=0.6324 head_norm=1.695201 delta_norm=0.057318
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=39 head_norm_before_train=1.654136 cos_to_last_merge=0.9982 (last merge round=36)
[S2] round=39 local utility u=0.013490 metrics={'f1_val': 0.7069645192270024, 'auprc': 0.8052742055039074, 'loss_val': 0.5963391821883919, 'psi': 0.7462883937377645}-{'f1_val': 0.7075009148988578, 'auprc': 0.7918160181093647, 'loss_val': 0.586163183812559, 'psi': 0.7412269561830606}
[S3] START round=39 head_norm_before_train=1.558605 cos_to_last_merge=0.9999 (last merge round=37)
[S3] round=39 local utility u=0.000000 metrics={'f1_val': 0.8122619160492347, 'auprc': 0.9971843283762588, 'loss_val': 0.39957789628186596, 'psi': 0.8862308809800443}-{'f1_val': 0.9494717760989486, 'auprc': 0.9933687687090853, 'loss_val': 0.15445645910602163, 'psi': 0.9670305731430032}
[S4] START round=39 head_norm_before_train=1.727428 cos_to_last_merge=0.9985 (last merge round=30)
[S4] round=39 local utility u=0.018730 metrics={'f1_val': 0.9441013850306859, 'auprc': 0.9665853973391849, 'loss_val': 0.302142764870737, 'psi': 0.9530949899540855}-{'f1_val': 0.9417569064254843, 'auprc': 0.959488318953003, 'loss_val': 0.3042450331374834, 'psi': 0.9488494714364917}
[S5] START round=39 head_norm_before_train=1.539733 cos_to_last_merge=0.7552 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.755
[S5] round=39 local utility u=0.024625 metrics={'f1_val': 0.7005802511973405, 'auprc': 0.9895209503793448, 'loss_val': 0.21968487307771783, 'psi': 0.8161565308701422}-{'f1_val': 0.7005797538498719, 'auprc': 0.9778814840390855, 'loss_val': 0.2340126696711186, 'psi': 0.8115004459255574}
[S6] START round=39 head_norm_before_train=1.775387 cos_to_last_merge=1.0000 (last merge round=38)
[S6] round=39 local utility u=0.000000 metrics={'f1_val': 0.7675125780958514, 'auprc': 0.92055124507775, 'loss_val': 0.7221095342353988, 'psi': 0.8287280448886108}-{'f1_val': 0.7966701723163558, 'auprc': 0.9251787722846072, 'loss_val': 0.6135158768464987, 'psi': 0.8480736123036563}
[S7] START round=39 head_norm_before_train=1.617349 cos_to_last_merge=0.9999 (last merge round=36)
[S7] round=39 local utility u=0.000000 metrics={'f1_val': 0.5925513130091986, 'auprc': 0.7914471459216286, 'loss_val': 0.6733635735668227, 'psi': 0.6721096461741707}-{'f1_val': 0.6355762766580711, 'auprc': 0.8024752785556346, 'loss_val': 0.5275417384976386, 'psi': 0.7023358774170965}
[S8] START round=39 head_norm_before_train=1.729147 cos_to_last_merge=0.9986 (last merge round=35)
[S8] round=39 local utility u=0.000000 metrics={'f1_val': 0.9839526961539431, 'auprc': 0.9986816505339564, 'loss_val': 0.05049081731963154, 'psi': 0.9898442779059484}-{'f1_val': 0.9914375510364866, 'auprc': 0.9983619204853246, 'loss_val': 0.03901603063394448, 'psi': 0.9942072988160218}
[S9] START round=39 head_norm_before_train=1.526723 cos_to_last_merge=1.0000 (last merge round=37)
[S9] round=39 local utility u=0.000000 metrics={'f1_val': 0.9892714523047061, 'auprc': 0.9949499861453939, 'loss_val': 0.05159781258771861, 'psi': 0.9915428658409813}-{'f1_val': 0.9966605118138915, 'auprc': 0.9953438866148404, 'loss_val': 0.038050547763425174, 'psi': 0.996133861734271}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=40 psi=0.992 u=0.0000 p_local=0.0084 f1=0.989 auprc=0.995 bytes=41339
[S10] START round=39 head_norm_before_train=1.755089 cos_to_last_merge=1.0000 (last merge round=38)
[S10] round=39 local utility u=0.000220 metrics={'f1_val': 0.9943096789853013, 'auprc': 0.9960300425975814, 'loss_val': 0.03444376897890319, 'psi': 0.9949978244302133}-{'f1_val': 0.9947486092193725, 'auprc': 0.9945593316400785, 'loss_val': 0.03310528114373513, 'psi': 0.9946728981876549}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S10] r=40 psi=0.995 u=0.0002 p_local=0.0018 f1=0.994 auprc=0.996 bytes=48601
[S11] START round=39 head_norm_before_train=1.751743 cos_to_last_merge=0.9999 (last merge round=36)
[S11] round=39 local utility u=0.001012 metrics={'f1_val': 0.9967887165093644, 'auprc': 0.9976020471557672, 'loss_val': 0.03210013675053729, 'psi': 0.9971140487679255}-{'f1_val': 0.9967887165093644, 'auprc': 0.9975560842185747, 'loss_val': 0.03398567454652422, 'psi': 0.9970956635930486}
[S13] START round=39 head_norm_before_train=1.579069 cos_to_last_merge=0.9999 (last merge round=37)
[S13] round=39 local utility u=0.000000 metrics={'f1_val': 0.521746995915152, 'auprc': 0.6721728116770771, 'loss_val': 1.0652915503706697, 'psi': 0.581917322219922}-{'f1_val': 0.5215454600026957, 'auprc': 0.6878902580095294, 'loss_val': 1.0281831843572822, 'psi': 0.5880833792054292}
[S14] START round=39 head_norm_before_train=1.655806 cos_to_last_merge=0.9994 (last merge round=36)
[S14] round=39 local utility u=0.014193 metrics={'f1_val': 0.9969755000837764, 'auprc': 0.9970431419653708, 'loss_val': 0.06065773704703587, 'psi': 0.9970025568364141}-{'f1_val': 0.9963442551067831, 'auprc': 0.9928536076477601, 'loss_val': 0.07268690884806184, 'psi': 0.9949479961231739}
[S15] START round=39 head_norm_before_train=2.064725 cos_to_last_merge=0.8149 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.815
[S15] round=39 local utility u=0.084936 metrics={'f1_val': 0.9192278940482226, 'auprc': 0.9980736304745869, 'loss_val': 0.11420715599184608, 'psi': 0.9507661886187683}-{'f1_val': 0.9027624067881995, 'auprc': 0.9967236672076097, 'loss_val': 0.18123714653816664, 'psi': 0.9403469109559637}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S15] r=40 psi=0.951 u=0.0849 p_local=0.0824 f1=0.919 auprc=0.998 bytes=37823
[S16] START round=39 head_norm_before_train=2.018791 (no previous merge yet)
[S16] round=39 local utility u=0.001011 metrics={'f1_val': 0.9922260082678341, 'auprc': 0.9906133431581754, 'loss_val': 0.03838738880032282, 'psi': 0.9915809422239706}-{'f1_val': 0.9930602907512753, 'auprc': 0.9878720669022523, 'loss_val': 0.037191717955184604, 'psi': 0.9909850012116661}
[S17] START round=39 head_norm_before_train=1.695201 cos_to_last_merge=1.0000 (last merge round=38)
[S17] round=39 local utility u=0.000000 metrics={'f1_val': 0.6309129121691677, 'auprc': 0.8427727052570967, 'loss_val': 1.2170978623376578, 'psi': 0.7156568294043393}-{'f1_val': 0.6317149351119702, 'auprc': 0.8878076427683423, 'loss_val': 1.0825313570578943, 'psi': 0.734152018174519}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:33205
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:33207
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] → sending delta(kind=head bytes=1805) to S13@127.0.0.1:33213
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.816)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=39 metric=0.8123 head_norm=1.572217
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.073855e-01
[S3] stored merged vector for next round verification (round=39)
[S3] DEBUG after merge:  round=39 metric=0.8076 head_norm=1.604663 delta_norm=0.207386
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S3] r=40 psi=0.886 u=0.0000 p_local=0.0845 f1=0.812 auprc=0.997 bytes=39540
[S5] r=40 psi=0.816 u=0.0246 p_local=0.2854 f1=0.701 auprc=0.990 bytes=43145
[S6] r=40 psi=0.829 u=0.0000 p_local=0.2678 f1=0.768 auprc=0.921 bytes=35989
[S7] r=40 psi=0.672 u=0.0000 p_local=0.1494 f1=0.593 auprc=0.791 bytes=48607
[S2] sending update (kind=head size=1805 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S4] r=40 psi=0.953 u=0.0187 p_local=0.0592 f1=0.944 auprc=0.967 bytes=43117
[S8] r=40 psi=0.990 u=0.0000 p_local=0.0451 f1=0.984 auprc=0.999 bytes=43152
[S16] sending update (kind=head size=1799 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:33208
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] RECEIVED delta(kind=head bytes=1796) from S11
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.766340)
[S6] loaded HEAD from S11 (vec_in norm=1.766340)
[S6] cosine check vs S11: cos=0.9986
[S6] BUFFERED delta from S11 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1799) from S16
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=2.029373)
[S5] loaded HEAD from S16 (vec_in norm=2.029373)
[S5] cosine check vs S16: cos=-0.1060
[S5] DROPPED delta from S16 (cos=-0.1060 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1805) from S2
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.691847)
[S13] loaded HEAD from S2 (vec_in norm=1.691847)
[S13] cosine check vs S2: cos=0.9902
[S13] BUFFERED delta from S2 (total buffered=1)
[S14] sending update (kind=head size=1799 to 1 peers)
[S16] r=40 psi=0.992 u=0.0010 p_local=0.1769 f1=0.992 auprc=0.991 bytes=43168
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=39 metric=0.9968 head_norm=1.766340
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.531703e-02
[S11] stored merged vector for next round verification (round=39)
[S11] DEBUG after merge:  round=39 metric=0.9968 head_norm=1.789808 delta_norm=0.075317
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S11] r=40 psi=0.997 u=0.0010 p_local=0.1012 f1=0.997 auprc=0.998 bytes=44952
[S2] r=40 psi=0.746 u=0.0135 p_local=0.0828 f1=0.707 auprc=0.805 bytes=32376
[S7] RECEIVED delta(kind=head bytes=1799) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.676613)
[S7] loaded HEAD from S14 (vec_in norm=1.676613)
[S7] cosine check vs S14: cos=0.9980
[S7] BUFFERED delta from S14 (total buffered=1)
[S17] r=40 psi=0.716 u=0.0000 p_local=0.0838 f1=0.631 auprc=0.843 bytes=37782
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=39 metric=0.5217 head_norm=1.594887
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.248284e-01
[S13] stored merged vector for next round verification (round=39)
[S13] DEBUG after merge:  round=39 metric=0.5219 head_norm=1.639336 delta_norm=0.124828
[S13] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S13] r=40 psi=0.582 u=0.0000 p_local=0.0375 f1=0.522 auprc=0.672 bytes=28742
[S14] r=40 psi=0.997 u=0.0142 p_local=0.0069 f1=0.997 auprc=0.997 bytes=37745
[S2] START round=40 head_norm_before_train=1.691847 cos_to_last_merge=0.9969 (last merge round=36)
[S2] round=40 local utility u=0.000000 metrics={'f1_val': 0.7139231497817493, 'auprc': 0.78863156440427, 'loss_val': 0.6347945773225814, 'psi': 0.7438065156307576}-{'f1_val': 0.7069645192270024, 'auprc': 0.8052742055039074, 'loss_val': 0.5963391821883919, 'psi': 0.7462883937377645}
[S3] START round=40 head_norm_before_train=1.604663 cos_to_last_merge=1.0000 (last merge round=39)
[S3] round=40 local utility u=0.000000 metrics={'f1_val': 0.6919129775418307, 'auprc': 0.9425309625217577, 'loss_val': 0.6382917570674009, 'psi': 0.7921601715338015}-{'f1_val': 0.8122619160492347, 'auprc': 0.9971843283762588, 'loss_val': 0.39957789628186596, 'psi': 0.8862308809800443}
[S4] START round=40 head_norm_before_train=1.730763 cos_to_last_merge=0.9984 (last merge round=30)
[S4] round=40 local utility u=0.000000 metrics={'f1_val': 0.9406653720746811, 'auprc': 0.9586709000907392, 'loss_val': 0.31755931278428484, 'psi': 0.9478675832811043}-{'f1_val': 0.9441013850306859, 'auprc': 0.9665853973391849, 'loss_val': 0.302142764870737, 'psi': 0.9530949899540855}
[S5] START round=40 head_norm_before_train=1.546737 cos_to_last_merge=0.7555 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.756
[S5] round=40 local utility u=0.000000 metrics={'f1_val': 0.5796677223500821, 'auprc': 0.8535070100528767, 'loss_val': 0.7027260093106323, 'psi': 0.6892034374311999}-{'f1_val': 0.7005802511973405, 'auprc': 0.9895209503793448, 'loss_val': 0.21968487307771783, 'psi': 0.8161565308701422}
[S6] START round=40 head_norm_before_train=1.790523 cos_to_last_merge=0.9999 (last merge round=38)
[S6] round=40 local utility u=0.000000 metrics={'f1_val': 0.6058011860822382, 'auprc': 0.763182429871645, 'loss_val': 1.2377228480437494, 'psi': 0.6687536835980009}-{'f1_val': 0.7675125780958514, 'auprc': 0.92055124507775, 'loss_val': 0.7221095342353988, 'psi': 0.8287280448886108}
[S7] START round=40 head_norm_before_train=1.624403 cos_to_last_merge=0.9998 (last merge round=36)
[S7] round=40 local utility u=0.046681 metrics={'f1_val': 0.6018322392781967, 'auprc': 0.7974978211498014, 'loss_val': 0.6538401357955907, 'psi': 0.6800984720268386}-{'f1_val': 0.5925513130091986, 'auprc': 0.7914471459216286, 'loss_val': 0.6733635735668227, 'psi': 0.6721096461741707}
[S8] START round=40 head_norm_before_train=1.759245 cos_to_last_merge=0.9979 (last merge round=35)
[S8] round=40 local utility u=0.028498 metrics={'f1_val': 0.991074834927764, 'auprc': 0.998886308287664, 'loss_val': 0.03684140422343199, 'psi': 0.994199424271724}-{'f1_val': 0.9839526961539431, 'auprc': 0.9986816505339564, 'loss_val': 0.05049081731963154, 'psi': 0.9898442779059484}
[S9] START round=40 head_norm_before_train=1.540258 cos_to_last_merge=0.9999 (last merge round=37)
[S9] round=40 local utility u=0.022015 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9899157733497994, 'loss_val': 0.03433745907752899, 'psi': 0.9937163662074864}-{'f1_val': 0.9892714523047061, 'auprc': 0.9949499861453939, 'loss_val': 0.05159781258771861, 'psi': 0.9915428658409813}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=40 head_norm_before_train=1.771309 cos_to_last_merge=1.0000 (last merge round=38)
[S10] round=40 local utility u=0.001396 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9958209978547817, 'loss_val': 0.03365914953656617, 'psi': 0.9951775646735361}-{'f1_val': 0.9943096789853013, 'auprc': 0.9960300425975814, 'loss_val': 0.03444376897890319, 'psi': 0.9949978244302133}
[S10] not sending this round → trigger blocked (psi=0.995)
[S11] START round=40 head_norm_before_train=1.789808 cos_to_last_merge=1.0000 (last merge round=39)
[S11] round=40 local utility u=0.000000 metrics={'f1_val': 0.9967887165093644, 'auprc': 0.9975826567087167, 'loss_val': 0.03239104561026375, 'psi': 0.9971062925891053}-{'f1_val': 0.9967887165093644, 'auprc': 0.9976020471557672, 'loss_val': 0.03210013675053729, 'psi': 0.9971140487679255}
[S13] START round=40 head_norm_before_train=1.639336 cos_to_last_merge=1.0000 (last merge round=39)
[S13] round=40 local utility u=0.186767 metrics={'f1_val': 0.5652392185873254, 'auprc': 0.6643431976911037, 'loss_val': 0.9292218373942953, 'psi': 0.6048808102288368}-{'f1_val': 0.521746995915152, 'auprc': 0.6721728116770771, 'loss_val': 1.0652915503706697, 'psi': 0.581917322219922}
[S14] START round=40 head_norm_before_train=1.676613 cos_to_last_merge=0.9987 (last merge round=36)
[S14] round=40 local utility u=0.002888 metrics={'f1_val': 0.9973862616479148, 'auprc': 0.9970464921889175, 'loss_val': 0.05735708924888866, 'psi': 0.9972503538643158}-{'f1_val': 0.9969755000837764, 'auprc': 0.9970431419653708, 'loss_val': 0.06065773704703587, 'psi': 0.9970025568364141}
[S15] START round=40 head_norm_before_train=2.074847 cos_to_last_merge=0.8141 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.814
[S15] round=40 local utility u=0.000000 metrics={'f1_val': 0.9016001089992542, 'auprc': 0.9899749647671882, 'loss_val': 0.31908132079051743, 'psi': 0.9369500513064278}-{'f1_val': 0.9192278940482226, 'auprc': 0.9980736304745869, 'loss_val': 0.11420715599184608, 'psi': 0.9507661886187683}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=40 head_norm_before_train=2.029373 (no previous merge yet)
[S16] round=40 local utility u=0.003774 metrics={'f1_val': 0.9922260082678341, 'auprc': 0.993379406681488, 'loss_val': 0.03913669349882333, 'psi': 0.9926873676332957}-{'f1_val': 0.9922260082678341, 'auprc': 0.9906133431581754, 'loss_val': 0.03838738880032282, 'psi': 0.9915809422239706}
[S17] START round=40 head_norm_before_train=1.710022 cos_to_last_merge=1.0000 (last merge round=38)
[S17] round=40 local utility u=0.683819 metrics={'f1_val': 0.7232704204658832, 'auprc': 0.9523581028039113, 'loss_val': 0.7323602734311234, 'psi': 0.8149054934010944}-{'f1_val': 0.6309129121691677, 'auprc': 0.8427727052570967, 'loss_val': 1.2170978623376578, 'psi': 0.7156568294043393}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.993)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:33217
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1804 to 1 peers)
[S14] not sending this round → trigger blocked (psi=0.997)
[S2] ⇄ pheromone p=0.066 → S13@127.0.0.1:33213
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=40 metric=0.6058 head_norm=1.808691
[S6] _apply_head_vector_avg (torch): Δ‖w‖=5.700560e-02
[S6] stored merged vector for next round verification (round=40)
[S6] DEBUG after merge:  round=40 metric=0.6056 head_norm=1.786732 delta_norm=0.057006
[S6] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.214 → S11@127.0.0.1:33212
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=40 metric=0.6018 head_norm=1.632985
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.843087e-02
[S7] stored merged vector for next round verification (round=40)
[S7] DEBUG after merge:  round=40 metric=0.6049 head_norm=1.653911 delta_norm=0.058431
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.142 → S5@127.0.0.1:33205
[S5] ⇄ pheromone p=0.228 → S16@127.0.0.1:33216
[S11] ⇄ pheromone p=0.081 → S6@127.0.0.1:33207
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S17] → sending delta(kind=head bytes=1806) to S3@127.0.0.1:33203
[S17] RECEIVED delta(kind=head bytes=1804) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.784325)
[S17] loaded HEAD from S8 (vec_in norm=1.784325)
[S17] cosine check vs S8: cos=0.9985
[S17] BUFFERED delta from S8 (total buffered=1)
[S17] sending update (kind=head size=1806 to 1 peers)
[S8] ⇄ pheromone p=0.042 → S17@127.0.0.1:33217
[S3] RECEIVED delta(kind=head bytes=1806) from S17
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.725717)
[S3] loaded HEAD from S17 (vec_in norm=1.725717)
[S3] cosine check vs S17: cos=0.9897
[S3] BUFFERED delta from S17 (total buffered=1)
[S13] ⇄ pheromone p=0.067 → S2@127.0.0.1:33202
[S14] ⇄ pheromone p=0.006 → S7@127.0.0.1:33208
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=40 metric=0.7233 head_norm=1.725717
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.688092e-02
[S17] stored merged vector for next round verification (round=40)
[S17] DEBUG after merge:  round=40 metric=0.7256 head_norm=1.754344 delta_norm=0.056881
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.204 → S3@127.0.0.1:33203
[S2] START round=41 head_norm_before_train=1.723913 cos_to_last_merge=0.9955 (last merge round=36)
[S2] round=41 local utility u=0.000000 metrics={'f1_val': 0.7148233471904178, 'auprc': 0.7892734107789162, 'loss_val': 0.6697725407630376, 'psi': 0.7446033726258172}-{'f1_val': 0.7139231497817493, 'auprc': 0.78863156440427, 'loss_val': 0.6347945773225814, 'psi': 0.7438065156307576}
[S3] START round=41 head_norm_before_train=1.616984 cos_to_last_merge=0.9999 (last merge round=39)
[S3] round=41 local utility u=0.575059 metrics={'f1_val': 0.8209598529209831, 'auprc': 0.9888286323790603, 'loss_val': 0.4013490012990084, 'psi': 0.8881073647042139}-{'f1_val': 0.6919129775418307, 'auprc': 0.9425309625217577, 'loss_val': 0.6382917570674009, 'psi': 0.7921601715338015}
[S4] START round=41 head_norm_before_train=1.737152 cos_to_last_merge=0.9983 (last merge round=30)
[S4] round=41 local utility u=0.014743 metrics={'f1_val': 0.9434492280051394, 'auprc': 0.9595751434272438, 'loss_val': 0.30749002102846956, 'psi': 0.9498995941739812}-{'f1_val': 0.9406653720746811, 'auprc': 0.9586709000907392, 'loss_val': 0.31755931278428484, 'psi': 0.9478675832811043}
[S5] START round=41 head_norm_before_train=1.553676 cos_to_last_merge=0.7554 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.755
[S5] round=41 local utility u=0.797812 metrics={'f1_val': 0.7004938661094564, 'auprc': 0.9895284977226768, 'loss_val': 0.24012428192405744, 'psi': 0.8161077187547445}-{'f1_val': 0.5796677223500821, 'auprc': 0.8535070100528767, 'loss_val': 0.7027260093106323, 'psi': 0.6892034374311999}
[S6] START round=41 head_norm_before_train=1.786732 cos_to_last_merge=1.0000 (last merge round=40)
[S6] round=41 local utility u=1.000000 metrics={'f1_val': 0.7896418966738229, 'auprc': 0.8991046280521802, 'loss_val': 0.4843654364311788, 'psi': 0.8334269892251658}-{'f1_val': 0.6058011860822382, 'auprc': 0.763182429871645, 'loss_val': 1.2377228480437494, 'psi': 0.6687536835980009}
[S7] START round=41 head_norm_before_train=1.653911 cos_to_last_merge=1.0000 (last merge round=40)
[S7] round=41 local utility u=0.074544 metrics={'f1_val': 0.6185904027882553, 'auprc': 0.7993671694929627, 'loss_val': 0.6109086752207816, 'psi': 0.6909011094701383}-{'f1_val': 0.6018322392781967, 'auprc': 0.7974978211498014, 'loss_val': 0.6538401357955907, 'psi': 0.6800984720268386}
[S8] START round=41 head_norm_before_train=1.784325 cos_to_last_merge=0.9972 (last merge round=35)
[S8] round=41 local utility u=0.004319 metrics={'f1_val': 0.9923498862294302, 'auprc': 0.9989160480931699, 'loss_val': 0.03594202267474063, 'psi': 0.9949763509749261}-{'f1_val': 0.991074834927764, 'auprc': 0.998886308287664, 'loss_val': 0.03684140422343199, 'psi': 0.994199424271724}
[S9] START round=41 head_norm_before_train=1.553855 cos_to_last_merge=0.9997 (last merge round=37)
[S9] round=41 local utility u=0.006953 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9920691450373614, 'loss_val': 0.03200783539503906, 'psi': 0.9950894055222302}-{'f1_val': 0.9962500947792776, 'auprc': 0.9899157733497994, 'loss_val': 0.03433745907752899, 'psi': 0.9937163662074864}
[S9] not sending this round → trigger blocked (psi=0.995)
[S10] START round=41 head_norm_before_train=1.785113 cos_to_last_merge=0.9999 (last merge round=38)
[S10] round=41 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.994542089539824, 'loss_val': 0.0328314459527077, 'psi': 0.9946660013475531}-{'f1_val': 0.9947486092193725, 'auprc': 0.9958209978547817, 'loss_val': 0.03365914953656617, 'psi': 0.9951775646735361}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=41 head_norm_before_train=1.803614 cos_to_last_merge=1.0000 (last merge round=39)
[S11] round=41 local utility u=0.000889 metrics={'f1_val': 0.9967887165093644, 'auprc': 0.9975787807811066, 'loss_val': 0.03060104301215612, 'psi': 0.9971047422180612}-{'f1_val': 0.9967887165093644, 'auprc': 0.9975826567087167, 'loss_val': 0.03239104561026375, 'psi': 0.9971062925891053}
[S13] START round=41 head_norm_before_train=1.652042 cos_to_last_merge=0.9999 (last merge round=39)
[S13] round=41 local utility u=0.000000 metrics={'f1_val': 0.520393334306841, 'auprc': 0.5306848074025756, 'loss_val': 1.13777955798409, 'psi': 0.5245099235451348}-{'f1_val': 0.5652392185873254, 'auprc': 0.6643431976911037, 'loss_val': 0.9292218373942953, 'psi': 0.6048808102288368}
[S14] START round=41 head_norm_before_train=1.694918 cos_to_last_merge=0.9980 (last merge round=36)
[S14] round=41 local utility u=0.000000 metrics={'f1_val': 0.9971882020035234, 'auprc': 0.9951235582361677, 'loss_val': 0.05258713948298846, 'psi': 0.9963623444965811}-{'f1_val': 0.9973862616479148, 'auprc': 0.9970464921889175, 'loss_val': 0.05735708924888866, 'psi': 0.9972503538643158}
[S15] START round=41 head_norm_before_train=2.084727 cos_to_last_merge=0.8132 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.813
[S15] round=41 local utility u=0.451539 metrics={'f1_val': 0.9971172535281002, 'auprc': 0.9992421390021663, 'loss_val': 0.016908400323400036, 'psi': 0.9979672077177266}-{'f1_val': 0.9016001089992542, 'auprc': 0.9899749647671882, 'loss_val': 0.31908132079051743, 'psi': 0.9369500513064278}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=41 head_norm_before_train=2.040214 (no previous merge yet)
[S16] round=41 local utility u=0.003273 metrics={'f1_val': 0.9922492709393801, 'auprc': 0.9954983468399302, 'loss_val': 0.039086141311949985, 'psi': 0.9935489012996002}-{'f1_val': 0.9922260082678341, 'auprc': 0.993379406681488, 'loss_val': 0.03913669349882333, 'psi': 0.9926873676332957}
[S17] START round=41 head_norm_before_train=1.754344 cos_to_last_merge=1.0000 (last merge round=40)
[S17] round=41 local utility u=0.000000 metrics={'f1_val': 0.654560245119038, 'auprc': 0.9562315390730372, 'loss_val': 1.0229933151571784, 'psi': 0.7752287627006377}-{'f1_val': 0.7232704204658832, 'auprc': 0.9523581028039113, 'loss_val': 0.7323602734311234, 'psi': 0.8149054934010944}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:33207
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:33212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:33216
[S8] not sending this round → trigger blocked (psi=0.995)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:33205
[S7] not sending this round → trigger blocked (psi=0.691)
[S16] sending update (kind=head size=1801 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=41 metric=0.8210 head_norm=1.626700
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.339016e-01
[S3] stored merged vector for next round verification (round=41)
[S3] DEBUG after merge:  round=41 metric=0.8201 head_norm=1.671585 delta_norm=0.133902
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] RECEIVED delta(kind=head bytes=1799) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.798215)
[S11] loaded HEAD from S6 (vec_in norm=1.798215)
[S11] cosine check vs S6: cos=0.9999
[S11] BUFFERED delta from S6 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1802) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.560522)
[S16] loaded HEAD from S5 (vec_in norm=1.560522)
[S16] cosine check vs S5: cos=-0.1041
[S16] DROPPED delta from S5 (cos=-0.1041 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1801) from S16
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=2.049839)
[S5] loaded HEAD from S16 (vec_in norm=2.049839)
[S5] cosine check vs S16: cos=-0.1041
[S5] DROPPED delta from S16 (cos=-0.1041 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1801) from S11
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.817049)
[S6] loaded HEAD from S11 (vec_in norm=1.817049)
[S6] cosine check vs S11: cos=0.9999
[S6] BUFFERED delta from S11 (total buffered=1)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=41 metric=0.9968 head_norm=1.817049
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.442879e-02
[S11] stored merged vector for next round verification (round=41)
[S11] DEBUG after merge:  round=41 metric=0.9968 head_norm=1.807598 delta_norm=0.014429
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=41 metric=0.7896 head_norm=1.798215
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.442879e-02
[S6] stored merged vector for next round verification (round=41)
[S6] DEBUG after merge:  round=41 metric=0.7903 head_norm=1.807598 delta_norm=0.014429
[S6] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=42 head_norm_before_train=1.755863 cos_to_last_merge=0.9940 (last merge round=36)
[S2] round=42 local utility u=0.000000 metrics={'f1_val': 0.6518794451953605, 'auprc': 0.7662554539832588, 'loss_val': 1.0256010313837802, 'psi': 0.6976298487105198}-{'f1_val': 0.7148233471904178, 'auprc': 0.7892734107789162, 'loss_val': 0.6697725407630376, 'psi': 0.7446033726258172}
[S3] START round=42 head_norm_before_train=1.671585 cos_to_last_merge=1.0000 (last merge round=41)
[S3] round=42 local utility u=0.438528 metrics={'f1_val': 0.930231716864308, 'auprc': 0.9963527182379149, 'loss_val': 0.20249588308608826, 'psi': 0.9566801174137508}-{'f1_val': 0.8209598529209831, 'auprc': 0.9888286323790603, 'loss_val': 0.4013490012990084, 'psi': 0.8881073647042139}
[S4] START round=42 head_norm_before_train=1.741934 cos_to_last_merge=0.9981 (last merge round=30)
[S4] round=42 local utility u=0.000000 metrics={'f1_val': 0.9353132065727384, 'auprc': 0.9524050880370073, 'loss_val': 0.3784948157892825, 'psi': 0.9421499591584459}-{'f1_val': 0.9434492280051394, 'auprc': 0.9595751434272438, 'loss_val': 0.30749002102846956, 'psi': 0.9498995941739812}
[S5] START round=42 head_norm_before_train=1.560522 cos_to_last_merge=0.7543 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.754
[S5] round=42 local utility u=0.000000 metrics={'f1_val': 0.6618048805541505, 'auprc': 0.8887700841510532, 'loss_val': 0.37116680933402574, 'psi': 0.7525909619929116}-{'f1_val': 0.7004938661094564, 'auprc': 0.9895284977226768, 'loss_val': 0.24012428192405744, 'psi': 0.8161077187547445}
[S6] START round=42 head_norm_before_train=1.807598 cos_to_last_merge=1.0000 (last merge round=41)
[S6] round=42 local utility u=0.000000 metrics={'f1_val': 0.7939766768934229, 'auprc': 0.9234536709851849, 'loss_val': 0.6728704341163381, 'psi': 0.8457674745301277}-{'f1_val': 0.7896418966738229, 'auprc': 0.8991046280521802, 'loss_val': 0.4843654364311788, 'psi': 0.8334269892251658}
[S7] START round=42 head_norm_before_train=1.662812 cos_to_last_merge=1.0000 (last merge round=40)
[S7] round=42 local utility u=0.000000 metrics={'f1_val': 0.5832352565903565, 'auprc': 0.7881469768503917, 'loss_val': 0.7340668506367068, 'psi': 0.6651999446943706}-{'f1_val': 0.6185904027882553, 'auprc': 0.7993671694929627, 'loss_val': 0.6109086752207816, 'psi': 0.6909011094701383}
[S8] START round=42 head_norm_before_train=1.803449 cos_to_last_merge=0.9965 (last merge round=35)
[S8] round=42 local utility u=0.000000 metrics={'f1_val': 0.9720866956832231, 'auprc': 0.9989719569573593, 'loss_val': 0.07091633521176058, 'psi': 0.9828408001928776}-{'f1_val': 0.9923498862294302, 'auprc': 0.9989160480931699, 'loss_val': 0.03594202267474063, 'psi': 0.9949763509749261}
[S9] START round=42 head_norm_before_train=1.566778 cos_to_last_merge=0.9996 (last merge round=37)
[S9] round=42 local utility u=0.003688 metrics={'f1_val': 0.9966891482978385, 'auprc': 0.9950063731983076, 'loss_val': 0.030961514278365816, 'psi': 0.9960160382580262}-{'f1_val': 0.9971029125121428, 'auprc': 0.9920691450373614, 'loss_val': 0.03200783539503906, 'psi': 0.9950894055222302}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=42 head_norm_before_train=1.798534 cos_to_last_merge=0.9998 (last merge round=38)
[S10] round=42 local utility u=0.001127 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9951111455518596, 'loss_val': 0.03228559654112905, 'psi': 0.9948936237523673}-{'f1_val': 0.9947486092193725, 'auprc': 0.994542089539824, 'loss_val': 0.0328314459527077, 'psi': 0.9946660013475531}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=42 head_norm_before_train=1.807598 cos_to_last_merge=1.0000 (last merge round=41)
[S11] round=42 local utility u=0.000000 metrics={'f1_val': 0.9963753869090841, 'auprc': 0.9961607913945854, 'loss_val': 0.030613690407104117, 'psi': 0.9962895487032846}-{'f1_val': 0.9967887165093644, 'auprc': 0.9975787807811066, 'loss_val': 0.03060104301215612, 'psi': 0.9971047422180612}
[S13] START round=42 head_norm_before_train=1.663341 cos_to_last_merge=0.9997 (last merge round=39)
[S13] round=42 local utility u=0.407476 metrics={'f1_val': 0.5476474536001401, 'auprc': 0.7006714228942579, 'loss_val': 0.9963126532786478, 'psi': 0.6088570413177872}-{'f1_val': 0.520393334306841, 'auprc': 0.5306848074025756, 'loss_val': 1.13777955798409, 'psi': 0.5245099235451348}
[S14] START round=42 head_norm_before_train=1.711168 cos_to_last_merge=0.9972 (last merge round=36)
[S14] round=42 local utility u=0.003044 metrics={'f1_val': 0.9971625532153504, 'auprc': 0.9969261237277864, 'loss_val': 0.051753747036693824, 'psi': 0.9970679814203248}-{'f1_val': 0.9971882020035234, 'auprc': 0.9951235582361677, 'loss_val': 0.05258713948298846, 'psi': 0.9963623444965811}
[S15] START round=42 head_norm_before_train=2.094410 cos_to_last_merge=0.8124 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.812
[S15] round=42 local utility u=0.000000 metrics={'f1_val': 0.700957864484732, 'auprc': 0.9244144691492647, 'loss_val': 0.5419441159665183, 'psi': 0.7903405063505451}-{'f1_val': 0.9971172535281002, 'auprc': 0.9992421390021663, 'loss_val': 0.016908400323400036, 'psi': 0.9979672077177266}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=42 head_norm_before_train=2.049839 (no previous merge yet)
[S16] round=42 local utility u=0.000000 metrics={'f1_val': 0.9922492709393801, 'auprc': 0.9950471827856862, 'loss_val': 0.03897306834827896, 'psi': 0.9933684356779025}-{'f1_val': 0.9922492709393801, 'auprc': 0.9954983468399302, 'loss_val': 0.039086141311949985, 'psi': 0.9935489012996002}
[S17] START round=42 head_norm_before_train=1.765340 cos_to_last_merge=1.0000 (last merge round=40)
[S17] round=42 local utility u=0.000000 metrics={'f1_val': 0.5672906358234708, 'auprc': 0.7712374657119593, 'loss_val': 1.337439029068853, 'psi': 0.6488693677788662}-{'f1_val': 0.654560245119038, 'auprc': 0.9562315390730372, 'loss_val': 1.0229933151571784, 'psi': 0.7752287627006377}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.957)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:33208
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:33202
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1799) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.724728)
[S7] loaded HEAD from S14 (vec_in norm=1.724728)
[S7] cosine check vs S14: cos=0.9978
[S7] BUFFERED delta from S14 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1801) from S13
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.669773)
[S2] loaded HEAD from S13 (vec_in norm=1.669773)
[S2] cosine check vs S13: cos=0.9929
[S2] BUFFERED delta from S13 (total buffered=1)
[S2] START round=43 head_norm_before_train=1.785454 cos_to_last_merge=0.9925 (last merge round=36)
[S2] round=43 local utility u=0.341478 metrics={'f1_val': 0.7050501166244709, 'auprc': 0.783148268815416, 'loss_val': 0.7123484717636381, 'psi': 0.736289377500849}-{'f1_val': 0.6518794451953605, 'auprc': 0.7662554539832588, 'loss_val': 1.0256010313837802, 'psi': 0.6976298487105198}
[S3] START round=43 head_norm_before_train=1.683147 cos_to_last_merge=0.9999 (last merge round=41)
[S3] round=43 local utility u=0.000000 metrics={'f1_val': 0.9260293252763054, 'auprc': 0.9968078157055341, 'loss_val': 0.18862966482469284, 'psi': 0.9543407214479969}-{'f1_val': 0.930231716864308, 'auprc': 0.9963527182379149, 'loss_val': 0.20249588308608826, 'psi': 0.9566801174137508}
[S4] START round=43 head_norm_before_train=1.747078 cos_to_last_merge=0.9976 (last merge round=30)
[S4] round=43 local utility u=0.054143 metrics={'f1_val': 0.9417892712276027, 'auprc': 0.9552851988651491, 'loss_val': 0.31770462529301396, 'psi': 0.9471876422826213}-{'f1_val': 0.9353132065727384, 'auprc': 0.9524050880370073, 'loss_val': 0.3784948157892825, 'psi': 0.9421499591584459}
[S5] START round=43 head_norm_before_train=1.565835 cos_to_last_merge=0.7528 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.753
[S5] round=43 local utility u=0.000000 metrics={'f1_val': 0.6264882772282359, 'auprc': 0.870566883446341, 'loss_val': 0.43901413161481445, 'psi': 0.724119719715478}-{'f1_val': 0.6618048805541505, 'auprc': 0.8887700841510532, 'loss_val': 0.37116680933402574, 'psi': 0.7525909619929116}
[S6] START round=43 head_norm_before_train=1.832687 cos_to_last_merge=0.9999 (last merge round=41)
[S6] round=43 local utility u=0.000000 metrics={'f1_val': 0.595094594637219, 'auprc': 0.7092276941111179, 'loss_val': 1.455284188973898, 'psi': 0.6407478344267785}-{'f1_val': 0.7939766768934229, 'auprc': 0.9234536709851849, 'loss_val': 0.6728704341163381, 'psi': 0.8457674745301277}
[S7] START round=43 head_norm_before_train=1.669364 cos_to_last_merge=0.9999 (last merge round=40)
[S7] round=43 local utility u=0.198615 metrics={'f1_val': 0.6200225825433863, 'auprc': 0.800165638134545, 'loss_val': 0.5936162239845864, 'psi': 0.6920798047798498}-{'f1_val': 0.5832352565903565, 'auprc': 0.7881469768503917, 'loss_val': 0.7340668506367068, 'psi': 0.6651999446943706}
[S8] START round=43 head_norm_before_train=1.821905 cos_to_last_merge=0.9961 (last merge round=35)
[S8] round=43 local utility u=0.078901 metrics={'f1_val': 0.9923498862294302, 'auprc': 0.9991356933783487, 'loss_val': 0.03518519941823994, 'psi': 0.9950642090889976}-{'f1_val': 0.9720866956832231, 'auprc': 0.9989719569573593, 'loss_val': 0.07091633521176058, 'psi': 0.9828408001928776}
[S9] START round=43 head_norm_before_train=1.579771 cos_to_last_merge=0.9994 (last merge round=37)
[S9] round=43 local utility u=0.000000 metrics={'f1_val': 0.9935215919844088, 'auprc': 0.9949642716247873, 'loss_val': 0.035989108523755184, 'psi': 0.9940986638405602}-{'f1_val': 0.9966891482978385, 'auprc': 0.9950063731983076, 'loss_val': 0.030961514278365816, 'psi': 0.9960160382580262}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=43 head_norm_before_train=1.813086 cos_to_last_merge=0.9996 (last merge round=38)
[S10] round=43 local utility u=0.001155 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9957067261874021, 'loss_val': 0.03176137411406253, 'psi': 0.9951318560065843}-{'f1_val': 0.9947486092193725, 'auprc': 0.9951111455518596, 'loss_val': 0.03228559654112905, 'psi': 0.9948936237523673}
[S10] not sending this round → trigger blocked (psi=0.995)
[S11] START round=43 head_norm_before_train=1.819568 cos_to_last_merge=1.0000 (last merge round=41)
[S11] round=43 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9964125362196059, 'loss_val': 0.044798392283976904, 'psi': 0.996245219435828}-{'f1_val': 0.9963753869090841, 'auprc': 0.9961607913945854, 'loss_val': 0.030613690407104117, 'psi': 0.9962895487032846}
[S13] START round=43 head_norm_before_train=1.669773 cos_to_last_merge=0.9996 (last merge round=39)
[S13] round=43 local utility u=0.064197 metrics={'f1_val': 0.5604799504802688, 'auprc': 0.7048364526850399, 'loss_val': 0.957408976791939, 'psi': 0.6182225513621773}-{'f1_val': 0.5476474536001401, 'auprc': 0.7006714228942579, 'loss_val': 0.9963126532786478, 'psi': 0.6088570413177872}
[S14] START round=43 head_norm_before_train=1.724728 cos_to_last_merge=0.9965 (last merge round=36)
[S14] round=43 local utility u=0.003245 metrics={'f1_val': 0.9971652929977585, 'auprc': 0.997896600522586, 'loss_val': 0.04819162355761604, 'psi': 0.9974578160076895}-{'f1_val': 0.9971625532153504, 'auprc': 0.9969261237277864, 'loss_val': 0.051753747036693824, 'psi': 0.9970679814203248}
[S15] START round=43 head_norm_before_train=2.100120 cos_to_last_merge=0.8119 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.812
[S15] round=43 local utility u=0.694279 metrics={'f1_val': 0.8540122917878697, 'auprc': 0.9990342263676146, 'loss_val': 0.2955725770492885, 'psi': 0.9120210656197677}-{'f1_val': 0.700957864484732, 'auprc': 0.9244144691492647, 'loss_val': 0.5419441159665183, 'psi': 0.7903405063505451}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=43 head_norm_before_train=2.057062 (no previous merge yet)
[S16] round=43 local utility u=0.000000 metrics={'f1_val': 0.9922492709393801, 'auprc': 0.9949049965176857, 'loss_val': 0.03905689162653755, 'psi': 0.9933115611707024}-{'f1_val': 0.9922492709393801, 'auprc': 0.9950471827856862, 'loss_val': 0.03897306834827896, 'psi': 0.9933684356779025}
[S17] START round=43 head_norm_before_train=1.775040 cos_to_last_merge=0.9999 (last merge round=40)
[S17] round=43 local utility u=0.347858 metrics={'f1_val': 0.6265886278409023, 'auprc': 0.8990300862831179, 'loss_val': 1.3808883308680506, 'psi': 0.7355652112177886}-{'f1_val': 0.5672906358234708, 'auprc': 0.7712374657119593, 'loss_val': 1.337439029068853, 'psi': 0.6488693677788662}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:33214
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:33213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:33217
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S17] → sending delta(kind=head bytes=1806) to S3@127.0.0.1:33203
[S14] not sending this round → trigger blocked (psi=0.997)
[S8] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1803 to 1 peers)
[S13] not sending this round → trigger blocked (psi=0.618)
[S7] sending update (kind=head size=1801 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1800) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.839781)
[S17] loaded HEAD from S8 (vec_in norm=1.839781)
[S17] cosine check vs S8: cos=0.9983
[S17] BUFFERED delta from S8 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1803) from S2
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.809733)
[S13] loaded HEAD from S2 (vec_in norm=1.809733)
[S13] cosine check vs S2: cos=0.9915
[S13] BUFFERED delta from S2 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1801) from S7
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.677471)
[S14] loaded HEAD from S7 (vec_in norm=1.677471)
[S14] cosine check vs S7: cos=0.9971
[S14] BUFFERED delta from S7 (total buffered=1)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=43 metric=0.7051 head_norm=1.809733
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.314817e-01
[S2] stored merged vector for next round verification (round=43)
[S2] DEBUG after merge:  round=43 metric=0.7043 head_norm=1.736188 delta_norm=0.131482
[S2] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S17] sending update (kind=head size=1806 to 1 peers)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=43 metric=0.6200 head_norm=1.677471
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.270827e-02
[S7] stored merged vector for next round verification (round=43)
[S7] DEBUG after merge:  round=43 metric=0.6244 head_norm=1.700108 delta_norm=0.062708
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S3] RECEIVED delta(kind=head bytes=1806) from S17
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.790043)
[S3] loaded HEAD from S17 (vec_in norm=1.790043)
[S3] cosine check vs S17: cos=0.9948
[S3] BUFFERED delta from S17 (total buffered=1)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=43 metric=0.5605 head_norm=1.677140
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.316482e-01
[S13] stored merged vector for next round verification (round=43)
[S13] DEBUG after merge:  round=43 metric=0.5618 head_norm=1.739722 delta_norm=0.131648
[S13] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=43 metric=0.9972 head_norm=1.737258
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.141504e-02
[S14] stored merged vector for next round verification (round=43)
[S14] DEBUG after merge:  round=43 metric=0.9972 head_norm=1.706132 delta_norm=0.071415
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=43 metric=0.6266 head_norm=1.790043
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.804494e-02
[S17] stored merged vector for next round verification (round=43)
[S17] DEBUG after merge:  round=43 metric=0.6282 head_norm=1.814154 delta_norm=0.058045
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=44 head_norm_before_train=1.736188 cos_to_last_merge=1.0000 (last merge round=43)
[S2] round=44 local utility u=0.051936 metrics={'f1_val': 0.7115122455814918, 'auprc': 0.7811974805698064, 'loss_val': 0.6413970462244069, 'psi': 0.7393863395768177}-{'f1_val': 0.7050501166244709, 'auprc': 0.783148268815416, 'loss_val': 0.7123484717636381, 'psi': 0.736289377500849}
[S3] START round=44 head_norm_before_train=1.695469 cos_to_last_merge=0.9998 (last merge round=41)
[S3] round=44 local utility u=0.000000 metrics={'f1_val': 0.81148045347971, 'auprc': 0.995573389037302, 'loss_val': 0.45276506791393434, 'psi': 0.8851176277027468}-{'f1_val': 0.9260293252763054, 'auprc': 0.9968078157055341, 'loss_val': 0.18862966482469284, 'psi': 0.9543407214479969}
[S4] START round=44 head_norm_before_train=1.755348 cos_to_last_merge=0.9973 (last merge round=30)
[S4] round=44 local utility u=0.000000 metrics={'f1_val': 0.6202960626970669, 'auprc': 0.9533449987089754, 'loss_val': 0.8681784321392577, 'psi': 0.7535156371018303}-{'f1_val': 0.9417892712276027, 'auprc': 0.9552851988651491, 'loss_val': 0.31770462529301396, 'psi': 0.9471876422826213}
[S5] START round=44 head_norm_before_train=1.572644 cos_to_last_merge=0.7523 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.752
[S5] round=44 local utility u=0.000000 metrics={'f1_val': 0.575285476260893, 'auprc': 0.8556613358728022, 'loss_val': 0.6923539345788849, 'psi': 0.6874358201056567}-{'f1_val': 0.6264882772282359, 'auprc': 0.870566883446341, 'loss_val': 0.43901413161481445, 'psi': 0.724119719715478}
[S6] START round=44 head_norm_before_train=1.858456 cos_to_last_merge=0.9997 (last merge round=41)
[S6] round=44 local utility u=0.300809 metrics={'f1_val': 0.6086888632295038, 'auprc': 0.8129798572837448, 'loss_val': 1.2464876545362664, 'psi': 0.6904052608512001}-{'f1_val': 0.595094594637219, 'auprc': 0.7092276941111179, 'loss_val': 1.455284188973898, 'psi': 0.6407478344267785}
[S7] START round=44 head_norm_before_train=1.700108 cos_to_last_merge=1.0000 (last merge round=43)
[S7] round=44 local utility u=0.000000 metrics={'f1_val': 0.5322575263198093, 'auprc': 0.7841287890660118, 'loss_val': 0.8600040237537294, 'psi': 0.6330060314182904}-{'f1_val': 0.6200225825433863, 'auprc': 0.800165638134545, 'loss_val': 0.5936162239845864, 'psi': 0.6920798047798498}
[S8] START round=44 head_norm_before_train=1.839781 cos_to_last_merge=0.9956 (last merge round=35)
[S8] round=44 local utility u=0.000000 metrics={'f1_val': 0.9865837707449139, 'auprc': 0.9989437555043099, 'loss_val': 0.040927449143533086, 'psi': 0.9915277646486722}-{'f1_val': 0.9923498862294302, 'auprc': 0.9991356933783487, 'loss_val': 0.03518519941823994, 'psi': 0.9950642090889976}
[S9] START round=44 head_norm_before_train=1.592321 cos_to_last_merge=0.9991 (last merge round=37)
[S9] round=44 local utility u=0.000000 metrics={'f1_val': 0.9876029063437939, 'auprc': 0.9949611238961418, 'loss_val': 0.054240922474782224, 'psi': 0.990546193364733}-{'f1_val': 0.9935215919844088, 'auprc': 0.9949642716247873, 'loss_val': 0.035989108523755184, 'psi': 0.9940986638405602}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=44 head_norm_before_train=1.827564 cos_to_last_merge=0.9994 (last merge round=38)
[S10] round=44 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.99454887270782, 'loss_val': 0.031237848105502876, 'psi': 0.9946687146147515}-{'f1_val': 0.9947486092193725, 'auprc': 0.9957067261874021, 'loss_val': 0.03176137411406253, 'psi': 0.9951318560065843}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=44 head_norm_before_train=1.829103 cos_to_last_merge=0.9999 (last merge round=41)
[S11] round=44 local utility u=0.000000 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.9963161328696815, 'loss_val': 0.048050638953201656, 'psi': 0.996061555869021}-{'f1_val': 0.9961336749133093, 'auprc': 0.9964125362196059, 'loss_val': 0.044798392283976904, 'psi': 0.996245219435828}
[S13] START round=44 head_norm_before_train=1.739722 cos_to_last_merge=1.0000 (last merge round=43)
[S13] round=44 local utility u=0.000000 metrics={'f1_val': 0.5334601009385321, 'auprc': 0.6788369032625805, 'loss_val': 1.0598842954541146, 'psi': 0.5916108218681515}-{'f1_val': 0.5604799504802688, 'auprc': 0.7048364526850399, 'loss_val': 0.957408976791939, 'psi': 0.6182225513621773}
[S14] START round=44 head_norm_before_train=1.706132 cos_to_last_merge=1.0000 (last merge round=43)
[S14] round=44 local utility u=0.000000 metrics={'f1_val': 0.9969755000837764, 'auprc': 0.9970459592220917, 'loss_val': 0.04813728743409198, 'psi': 0.9970036837391025}-{'f1_val': 0.9971652929977585, 'auprc': 0.997896600522586, 'loss_val': 0.04819162355761604, 'psi': 0.9974578160076895}
[S15] START round=44 head_norm_before_train=2.103580 cos_to_last_merge=0.8111 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.811
[S15] round=44 local utility u=0.561872 metrics={'f1_val': 0.9966870188820673, 'auprc': 0.9957074354016713, 'loss_val': 0.017896782261659628, 'psi': 0.9962951854899089}-{'f1_val': 0.8540122917878697, 'auprc': 0.9990342263676146, 'loss_val': 0.2955725770492885, 'psi': 0.9120210656197677}
[S15] not sending this round → trigger blocked (psi=0.996)
[S16] START round=44 head_norm_before_train=2.061772 (no previous merge yet)
[S16] round=44 local utility u=0.000000 metrics={'f1_val': 0.8399958534929292, 'auprc': 0.9362850407757692, 'loss_val': 1.1110155643056596, 'psi': 0.8785115284060652}-{'f1_val': 0.9922492709393801, 'auprc': 0.9949049965176857, 'loss_val': 0.03905689162653755, 'psi': 0.9933115611707024}
[S17] START round=44 head_norm_before_train=1.814154 cos_to_last_merge=1.0000 (last merge round=43)
[S17] round=44 local utility u=0.000000 metrics={'f1_val': 0.6022195118172893, 'auprc': 0.8295276079420272, 'loss_val': 1.1397768698547428, 'psi': 0.6931427502671844}-{'f1_val': 0.6265886278409023, 'auprc': 0.8990300862831179, 'loss_val': 1.3808883308680506, 'psi': 0.7355652112177886}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.739)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:33212
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=44 metric=0.8115 head_norm=1.706839
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.042501e-01
[S3] stored merged vector for next round verification (round=44)
[S3] DEBUG after merge:  round=44 metric=0.8092 head_norm=1.745826 delta_norm=0.104250
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S6] sending update (kind=head size=1797 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] RECEIVED delta(kind=head bytes=1797) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.868677)
[S11] loaded HEAD from S6 (vec_in norm=1.868677)
[S11] cosine check vs S6: cos=0.9993
[S11] BUFFERED delta from S6 (total buffered=1)
[S2] START round=45 head_norm_before_train=1.759225 cos_to_last_merge=0.9999 (last merge round=43)
[S2] round=45 local utility u=0.000000 metrics={'f1_val': 0.7089429447860176, 'auprc': 0.7814023271120581, 'loss_val': 0.6563096391725481, 'psi': 0.7379266977164338}-{'f1_val': 0.7115122455814918, 'auprc': 0.7811974805698064, 'loss_val': 0.6413970462244069, 'psi': 0.7393863395768177}
[S3] START round=45 head_norm_before_train=1.745826 cos_to_last_merge=1.0000 (last merge round=44)
[S3] round=45 local utility u=0.000000 metrics={'f1_val': 0.4687086695696586, 'auprc': 0.9341842304862351, 'loss_val': 0.9278792159453019, 'psi': 0.6548988939362892}-{'f1_val': 0.81148045347971, 'auprc': 0.995573389037302, 'loss_val': 0.45276506791393434, 'psi': 0.8851176277027468}
[S4] START round=45 head_norm_before_train=1.765343 cos_to_last_merge=0.9970 (last merge round=30)
[S4] round=45 local utility u=0.112421 metrics={'f1_val': 0.6434145980228031, 'auprc': 0.9376047815477502, 'loss_val': 0.7348266075147312, 'psi': 0.7610906714327819}-{'f1_val': 0.6202960626970669, 'auprc': 0.9533449987089754, 'loss_val': 0.8681784321392577, 'psi': 0.7535156371018303}
[S5] START round=45 head_norm_before_train=1.577406 cos_to_last_merge=0.7523 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.752
[S5] round=45 local utility u=0.801871 metrics={'f1_val': 0.7004938661094564, 'auprc': 0.9896860780759985, 'loss_val': 0.24193601864605824, 'psi': 0.8161707508960733}-{'f1_val': 0.575285476260893, 'auprc': 0.8556613358728022, 'loss_val': 0.6923539345788849, 'psi': 0.6874358201056567}
[S6] START round=45 head_norm_before_train=1.868677 cos_to_last_merge=0.9996 (last merge round=41)
[S6] round=45 local utility u=0.000000 metrics={'f1_val': 0.5500947173675775, 'auprc': 0.7608336077624915, 'loss_val': 1.1060002772144664, 'psi': 0.6343902735255431}-{'f1_val': 0.6086888632295038, 'auprc': 0.8129798572837448, 'loss_val': 1.2464876545362664, 'psi': 0.6904052608512001}
[S7] START round=45 head_norm_before_train=1.706203 cos_to_last_merge=1.0000 (last merge round=43)
[S7] round=45 local utility u=1.000000 metrics={'f1_val': 0.6982374126046913, 'auprc': 0.9458029970933393, 'loss_val': 0.2029886480861673, 'psi': 0.7972636464001506}-{'f1_val': 0.5322575263198093, 'auprc': 0.7841287890660118, 'loss_val': 0.8600040237537294, 'psi': 0.6330060314182904}
[S8] START round=45 head_norm_before_train=1.855900 cos_to_last_merge=0.9951 (last merge round=35)
[S8] round=45 local utility u=0.000000 metrics={'f1_val': 0.9369812230124627, 'auprc': 0.9988417276713806, 'loss_val': 0.14509252109536, 'psi': 0.9617254248760299}-{'f1_val': 0.9865837707449139, 'auprc': 0.9989437555043099, 'loss_val': 0.040927449143533086, 'psi': 0.9915277646486722}
[S9] START round=45 head_norm_before_train=1.604307 cos_to_last_merge=0.9988 (last merge round=37)
[S9] round=45 local utility u=0.038898 metrics={'f1_val': 0.9958601375429889, 'auprc': 0.995751022986466, 'loss_val': 0.02835762473044732, 'psi': 0.9958164917203797}-{'f1_val': 0.9876029063437939, 'auprc': 0.9949611238961418, 'loss_val': 0.054240922474782224, 'psi': 0.990546193364733}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=45 head_norm_before_train=1.841530 cos_to_last_merge=0.9992 (last merge round=38)
[S10] round=45 local utility u=0.001514 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9954890008111721, 'loss_val': 0.031030680532800288, 'psi': 0.9950447658560924}-{'f1_val': 0.9947486092193725, 'auprc': 0.99454887270782, 'loss_val': 0.031237848105502876, 'psi': 0.9946687146147515}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=45 head_norm_before_train=1.839620 cos_to_last_merge=0.9998 (last merge round=41)
[S11] round=45 local utility u=0.000000 metrics={'f1_val': 0.9963958538641108, 'auprc': 0.9963648823697455, 'loss_val': 0.059387232453006665, 'psi': 0.9963834652663648}-{'f1_val': 0.9958918378685807, 'auprc': 0.9963161328696815, 'loss_val': 0.048050638953201656, 'psi': 0.996061555869021}
[S13] START round=45 head_norm_before_train=1.745546 cos_to_last_merge=0.9999 (last merge round=43)
[S13] round=45 local utility u=0.168484 metrics={'f1_val': 0.5639239195778054, 'auprc': 0.6714804087669146, 'loss_val': 0.8836298505400718, 'psi': 0.606946515253449}-{'f1_val': 0.5334601009385321, 'auprc': 0.6788369032625805, 'loss_val': 1.0598842954541146, 'psi': 0.5916108218681515}
[S14] START round=45 head_norm_before_train=1.720536 cos_to_last_merge=1.0000 (last merge round=43)
[S14] round=45 local utility u=0.000000 metrics={'f1_val': 0.9963671647723179, 'auprc': 0.9966754019875884, 'loss_val': 0.04854885564714427, 'psi': 0.9964904596584261}-{'f1_val': 0.9969755000837764, 'auprc': 0.9970459592220917, 'loss_val': 0.04813728743409198, 'psi': 0.9970036837391025}
[S15] START round=45 head_norm_before_train=2.106503 cos_to_last_merge=0.8106 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.811
[S15] round=45 local utility u=0.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9966875710749823, 'loss_val': 0.029575745003012188, 'psi': 0.9967230294625052}-{'f1_val': 0.9966870188820673, 'auprc': 0.9957074354016713, 'loss_val': 0.017896782261659628, 'psi': 0.9962951854899089}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=45 head_norm_before_train=2.067846 (no previous merge yet)
[S16] round=45 local utility u=0.907812 metrics={'f1_val': 0.9502991889218986, 'auprc': 0.9939083341928443, 'loss_val': 0.13008171021691045, 'psi': 0.9677428470302769}-{'f1_val': 0.8399958534929292, 'auprc': 0.9362850407757692, 'loss_val': 1.1110155643056596, 'psi': 0.8785115284060652}
[S17] START round=45 head_norm_before_train=1.826347 cos_to_last_merge=1.0000 (last merge round=43)
[S17] round=45 local utility u=0.196181 metrics={'f1_val': 0.6498386663947668, 'auprc': 0.9290107389439088, 'loss_val': 1.3315784525144296, 'psi': 0.7615074954144236}-{'f1_val': 0.6022195118172893, 'auprc': 0.8295276079420272, 'loss_val': 1.1397768698547428, 'psi': 0.6931427502671844}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:33205
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:33214
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:33216
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S6] ⇄ pheromone p=0.200 → S11@127.0.0.1:33212
[S16] sending update (kind=head size=1802 to 1 peers)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=45 metric=0.9964 head_norm=1.848963
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.903702e-02
[S11] stored merged vector for next round verification (round=45)
[S11] DEBUG after merge:  round=45 metric=0.9964 head_norm=1.858436 delta_norm=0.039037
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.027 → S6@127.0.0.1:33207
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:33202
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:33203
[S2] ⇄ pheromone p=0.074 → S13@127.0.0.1:33213
[S8] ⇄ pheromone p=0.024 → S17@127.0.0.1:33217
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] RECEIVED delta(kind=head bytes=1800) from S7
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.711078)
[S14] loaded HEAD from S7 (vec_in norm=1.711078)
[S14] cosine check vs S7: cos=0.9997
[S14] BUFFERED delta from S7 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1803) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.583033)
[S16] loaded HEAD from S5 (vec_in norm=1.583033)
[S16] cosine check vs S5: cos=-0.1006
[S16] DROPPED delta from S5 (cos=-0.1006 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1802) from S16
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=2.074682)
[S5] loaded HEAD from S16 (vec_in norm=2.074682)
[S5] cosine check vs S16: cos=-0.1006
[S5] DROPPED delta from S16 (cos=-0.1006 < 0.0)
[S17] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S16] ⇄ pheromone p=0.228 → S5@127.0.0.1:33205
[S7] ⇄ pheromone p=0.274 → S14@127.0.0.1:33214
[S5] ⇄ pheromone p=0.301 → S16@127.0.0.1:33216
[S3] RECEIVED delta(kind=head bytes=1802) from S17
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.839210)
[S3] loaded HEAD from S17 (vec_in norm=1.839210)
[S3] cosine check vs S17: cos=0.9973
[S3] BUFFERED delta from S17 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1800) from S13
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.751989)
[S2] loaded HEAD from S13 (vec_in norm=1.751989)
[S2] cosine check vs S13: cos=0.9995
[S2] BUFFERED delta from S13 (total buffered=1)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=45 metric=0.9964 head_norm=1.735800
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.434651e-02
[S14] stored merged vector for next round verification (round=45)
[S14] DEBUG after merge:  round=45 metric=0.9964 head_norm=1.723312 delta_norm=0.024347
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.003 → S7@127.0.0.1:33208
[S13] ⇄ pheromone p=0.106 → S2@127.0.0.1:33202
[S17] ⇄ pheromone p=0.151 → S3@127.0.0.1:33203
[S2] START round=46 head_norm_before_train=1.782949 cos_to_last_merge=0.9997 (last merge round=43)
[S2] round=46 local utility u=0.000000 metrics={'f1_val': 0.6057394253651253, 'auprc': 0.7417222361770579, 'loss_val': 1.3095114851544722, 'psi': 0.6601325496898983}-{'f1_val': 0.7089429447860176, 'auprc': 0.7814023271120581, 'loss_val': 0.6563096391725481, 'psi': 0.7379266977164338}
[S3] START round=46 head_norm_before_train=1.755409 cos_to_last_merge=1.0000 (last merge round=44)
[S3] round=46 local utility u=0.682728 metrics={'f1_val': 0.68045595400377, 'auprc': 0.9153237844637063, 'loss_val': 0.7763254010442772, 'psi': 0.7744030861877444}-{'f1_val': 0.4687086695696586, 'auprc': 0.9341842304862351, 'loss_val': 0.9278792159453019, 'psi': 0.6548988939362892}
[S4] START round=46 head_norm_before_train=1.769806 cos_to_last_merge=0.9965 (last merge round=30)
[S4] round=46 local utility u=1.000000 metrics={'f1_val': 0.9426657406044986, 'auprc': 0.9660833174067062, 'loss_val': 0.3164554149745452, 'psi': 0.9520327713253817}-{'f1_val': 0.6434145980228031, 'auprc': 0.9376047815477502, 'loss_val': 0.7348266075147312, 'psi': 0.7610906714327819}
[S5] START round=46 head_norm_before_train=1.583033 cos_to_last_merge=0.7516 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.752
[S5] round=46 local utility u=0.000000 metrics={'f1_val': 0.6523685253365503, 'auprc': 0.8536900383757453, 'loss_val': 0.5387005064325104, 'psi': 0.7328971305522283}-{'f1_val': 0.7004938661094564, 'auprc': 0.9896860780759985, 'loss_val': 0.24193601864605824, 'psi': 0.8161707508960733}
[S6] START round=46 head_norm_before_train=1.884655 cos_to_last_merge=0.9993 (last merge round=41)
[S6] round=46 local utility u=1.000000 metrics={'f1_val': 0.7632711221709032, 'auprc': 0.9260372183730166, 'loss_val': 0.7773142974932601, 'psi': 0.8283775606517485}-{'f1_val': 0.5500947173675775, 'auprc': 0.7608336077624915, 'loss_val': 1.1060002772144664, 'psi': 0.6343902735255431}
[S7] START round=46 head_norm_before_train=1.711078 cos_to_last_merge=1.0000 (last merge round=43)
[S7] round=46 local utility u=0.000000 metrics={'f1_val': 0.46198407305145606, 'auprc': 0.7817909626899621, 'loss_val': 1.0066959415945582, 'psi': 0.5899068289068585}-{'f1_val': 0.6982374126046913, 'auprc': 0.9458029970933393, 'loss_val': 0.2029886480861673, 'psi': 0.7972636464001506}
[S8] START round=46 head_norm_before_train=1.870784 cos_to_last_merge=0.9945 (last merge round=35)
[S8] round=46 local utility u=0.213929 metrics={'f1_val': 0.9901715563086453, 'auprc': 0.9989133396914056, 'loss_val': 0.03659202596990765, 'psi': 0.9936682696617495}-{'f1_val': 0.9369812230124627, 'auprc': 0.9988417276713806, 'loss_val': 0.14509252109536, 'psi': 0.9617254248760299}
[S9] START round=46 head_norm_before_train=1.616227 cos_to_last_merge=0.9985 (last merge round=37)
[S9] round=46 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9920041364574039, 'loss_val': 0.026458601416596617, 'psi': 0.9950634020902472}-{'f1_val': 0.9958601375429889, 'auprc': 0.995751022986466, 'loss_val': 0.02835762473044732, 'psi': 0.9958164917203797}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=46 head_norm_before_train=1.852910 cos_to_last_merge=0.9990 (last merge round=38)
[S10] round=46 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.995216050690332, 'loss_val': 0.030744105167626164, 'psi': 0.9949355858077563}-{'f1_val': 0.9947486092193725, 'auprc': 0.9954890008111721, 'loss_val': 0.031030680532800288, 'psi': 0.9950447658560924}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=46 head_norm_before_train=1.858436 cos_to_last_merge=1.0000 (last merge round=45)
[S11] round=46 local utility u=0.012251 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9963577654087848, 'loss_val': 0.033291137459168105, 'psi': 0.9962233111114995}-{'f1_val': 0.9963958538641108, 'auprc': 0.9963648823697455, 'loss_val': 0.059387232453006665, 'psi': 0.9963834652663648}
[S13] START round=46 head_norm_before_train=1.751989 cos_to_last_merge=0.9998 (last merge round=43)
[S13] round=46 local utility u=0.000000 metrics={'f1_val': 0.5514215058010202, 'auprc': 0.6687955382281388, 'loss_val': 0.9768580171235062, 'psi': 0.5983711187718677}-{'f1_val': 0.5639239195778054, 'auprc': 0.6714804087669146, 'loss_val': 0.8836298505400718, 'psi': 0.606946515253449}
[S14] START round=46 head_norm_before_train=1.723312 cos_to_last_merge=1.0000 (last merge round=45)
[S14] round=46 local utility u=0.003591 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.9979246950788452, 'loss_val': 0.046435089468065356, 'psi': 0.9971222169979883}-{'f1_val': 0.9963671647723179, 'auprc': 0.9966754019875884, 'loss_val': 0.04854885564714427, 'psi': 0.9964904596584261}
[S15] START round=46 head_norm_before_train=2.109998 cos_to_last_merge=0.8102 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.810
[S15] round=46 local utility u=0.007016 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9976650857513861, 'loss_val': 0.018476238730309097, 'psi': 0.9971140353330668}-{'f1_val': 0.9967466683875206, 'auprc': 0.9966875710749823, 'loss_val': 0.029575745003012188, 'psi': 0.9967230294625052}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=46 head_norm_before_train=2.074682 (no previous merge yet)
[S16] round=46 local utility u=0.033828 metrics={'f1_val': 0.9595220683034276, 'auprc': 0.9919234808555201, 'loss_val': 0.11180788856323942, 'psi': 0.9724826333242647}-{'f1_val': 0.9502991889218986, 'auprc': 0.9939083341928443, 'loss_val': 0.13008171021691045, 'psi': 0.9677428470302769}
[S17] START round=46 head_norm_before_train=1.839210 cos_to_last_merge=0.9999 (last merge round=43)
[S17] round=46 local utility u=0.000000 metrics={'f1_val': 0.6359792989195454, 'auprc': 0.8876117944999687, 'loss_val': 1.4344292786719217, 'psi': 0.7366322971517147}-{'f1_val': 0.6498386663947668, 'auprc': 0.9290107389439088, 'loss_val': 1.3315784525144296, 'psi': 0.7615074954144236}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] → sending delta(kind=head bytes=1805) to S11@127.0.0.1:33212
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:33207
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:33217
[S4] not sending this round → trigger blocked (psi=0.952)
[S16] not sending this round → trigger blocked (psi=0.972)
[S8] sending update (kind=head size=1802 to 1 peers)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S14] → sending delta(kind=head bytes=1792) to S7@127.0.0.1:33208
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=46 metric=0.6805 head_norm=1.762708
[S3] _apply_head_vector_avg (torch): Δ‖w‖=7.986026e-02
[S3] stored merged vector for next round verification (round=46)
[S3] DEBUG after merge:  round=46 metric=0.6805 head_norm=1.799594 delta_norm=0.079860
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1805 to 1 peers)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=46 metric=0.6057 head_norm=1.805795
[S2] _apply_head_vector_avg (torch): Δ‖w‖=4.466922e-02
[S2] stored merged vector for next round verification (round=46)
[S2] DEBUG after merge:  round=46 metric=0.6054 head_norm=1.778534 delta_norm=0.044669
[S2] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S17] RECEIVED delta(kind=head bytes=1802) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.888290)
[S17] loaded HEAD from S8 (vec_in norm=1.888290)
[S17] cosine check vs S8: cos=0.9987
[S17] BUFFERED delta from S8 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1805) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.898502)
[S11] loaded HEAD from S6 (vec_in norm=1.898502)
[S11] cosine check vs S6: cos=0.9993
[S11] BUFFERED delta from S6 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1798) from S11
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.867417)
[S6] loaded HEAD from S11 (vec_in norm=1.867417)
[S6] cosine check vs S11: cos=0.9993
[S6] BUFFERED delta from S11 (total buffered=1)
[S14] sending update (kind=head size=1792 to 1 peers)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=46 metric=0.7633 head_norm=1.898502
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.786797e-02
[S6] stored merged vector for next round verification (round=46)
[S6] DEBUG after merge:  round=46 metric=0.7670 head_norm=1.882643 delta_norm=0.037868
[S6] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=46 metric=0.9961 head_norm=1.867417
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.786796e-02
[S11] stored merged vector for next round verification (round=46)
[S11] DEBUG after merge:  round=46 metric=0.9961 head_norm=1.882643 delta_norm=0.037868
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S7] RECEIVED delta(kind=head bytes=1792) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.736321)
[S7] loaded HEAD from S14 (vec_in norm=1.736321)
[S7] cosine check vs S14: cos=0.9997
[S7] BUFFERED delta from S14 (total buffered=1)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=46 metric=0.6360 head_norm=1.845255
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.247771e-02
[S17] stored merged vector for next round verification (round=46)
[S17] DEBUG after merge:  round=46 metric=0.6357 head_norm=1.866158 delta_norm=0.052478
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=47 head_norm_before_train=1.778534 cos_to_last_merge=1.0000 (last merge round=46)
[S2] round=47 local utility u=0.725215 metrics={'f1_val': 0.7131187511394631, 'auprc': 0.7875102766333074, 'loss_val': 0.640721703174604, 'psi': 0.7428753613370009}-{'f1_val': 0.6057394253651253, 'auprc': 0.7417222361770579, 'loss_val': 1.3095114851544722, 'psi': 0.6601325496898983}
[S3] START round=47 head_norm_before_train=1.799594 cos_to_last_merge=1.0000 (last merge round=46)
[S3] round=47 local utility u=1.000000 metrics={'f1_val': 0.9971149325810758, 'auprc': 0.9993501253735072, 'loss_val': 0.04797244046367484, 'psi': 0.9980090096980483}-{'f1_val': 0.68045595400377, 'auprc': 0.9153237844637063, 'loss_val': 0.7763254010442772, 'psi': 0.7744030861877444}
[S4] START round=47 head_norm_before_train=1.773322 cos_to_last_merge=0.9961 (last merge round=30)
[S4] round=47 local utility u=0.000000 metrics={'f1_val': 0.9434858173643372, 'auprc': 0.9555322388391191, 'loss_val': 0.3180161436190092, 'psi': 0.9483043859542499}-{'f1_val': 0.9426657406044986, 'auprc': 0.9660833174067062, 'loss_val': 0.3164554149745452, 'psi': 0.9520327713253817}
[S5] START round=47 head_norm_before_train=1.585712 cos_to_last_merge=0.7519 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.752
[S5] round=47 local utility u=0.514567 metrics={'f1_val': 0.7005802511973405, 'auprc': 0.9896820340774937, 'loss_val': 0.20681319831580294, 'psi': 0.8162209643494017}-{'f1_val': 0.6523685253365503, 'auprc': 0.8536900383757453, 'loss_val': 0.5387005064325104, 'psi': 0.7328971305522283}
[S6] START round=47 head_norm_before_train=1.882643 cos_to_last_merge=1.0000 (last merge round=46)
[S6] round=47 local utility u=0.000000 metrics={'f1_val': 0.6641389455755548, 'auprc': 0.7738556107511283, 'loss_val': 1.145635481643375, 'psi': 0.7080256116457841}-{'f1_val': 0.7632711221709032, 'auprc': 0.9260372183730166, 'loss_val': 0.7773142974932601, 'psi': 0.8283775606517485}
[S7] START round=47 head_norm_before_train=1.713119 cos_to_last_merge=0.9999 (last merge round=43)
[S7] round=47 local utility u=0.366422 metrics={'f1_val': 0.5505501172654376, 'auprc': 0.7842619173753891, 'loss_val': 0.8126607654785637, 'psi': 0.6440348373094182}-{'f1_val': 0.46198407305145606, 'auprc': 0.7817909626899621, 'loss_val': 1.0066959415945582, 'psi': 0.5899068289068585}
[S8] START round=47 head_norm_before_train=1.888290 cos_to_last_merge=0.9939 (last merge round=35)
[S8] round=47 local utility u=0.012368 metrics={'f1_val': 0.9933673104406822, 'auprc': 0.9991098899499253, 'loss_val': 0.03161975660833712, 'psi': 0.9956643422443794}-{'f1_val': 0.9901715563086453, 'auprc': 0.9989133396914056, 'loss_val': 0.03659202596990765, 'psi': 0.9936682696617495}
[S9] START round=47 head_norm_before_train=1.626647 cos_to_last_merge=0.9983 (last merge round=37)
[S9] round=47 local utility u=0.000000 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9901872181746239, 'loss_val': 0.026238395394724747, 'psi': 0.9940903820287068}-{'f1_val': 0.9971029125121428, 'auprc': 0.9920041364574039, 'loss_val': 0.026458601416596617, 'psi': 0.9950634020902472}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=47 head_norm_before_train=1.864599 cos_to_last_merge=0.9988 (last merge round=38)
[S10] round=47 local utility u=0.000072 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9956201187590795, 'loss_val': 0.030494597365759483, 'psi': 0.9949655115826684}-{'f1_val': 0.9947486092193725, 'auprc': 0.995216050690332, 'loss_val': 0.030744105167626164, 'psi': 0.9949355858077563}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=47 head_norm_before_train=1.882643 cos_to_last_merge=1.0000 (last merge round=46)
[S11] round=47 local utility u=0.002382 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.9973422318132186, 'loss_val': 0.030028744732732707, 'psi': 0.9964719954464358}-{'f1_val': 0.9961336749133093, 'auprc': 0.9963577654087848, 'loss_val': 0.033291137459168105, 'psi': 0.9962233111114995}
[S13] START round=47 head_norm_before_train=1.760607 cos_to_last_merge=0.9998 (last merge round=43)
[S13] round=47 local utility u=0.088430 metrics={'f1_val': 0.5642142807660275, 'auprc': 0.6787996099291396, 'loss_val': 0.9067664193042245, 'psi': 0.6100484124312724}-{'f1_val': 0.5514215058010202, 'auprc': 0.6687955382281388, 'loss_val': 0.9768580171235062, 'psi': 0.5983711187718677}
[S14] START round=47 head_norm_before_train=1.736321 cos_to_last_merge=1.0000 (last merge round=45)
[S14] round=47 local utility u=0.003532 metrics={'f1_val': 0.9967325241656609, 'auprc': 0.9990065034939313, 'loss_val': 0.04348834877498044, 'psi': 0.997642115896969}-{'f1_val': 0.9965872316107504, 'auprc': 0.9979246950788452, 'loss_val': 0.046435089468065356, 'psi': 0.9971222169979883}
[S15] START round=47 head_norm_before_train=2.115821 cos_to_last_merge=0.8095 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.809
[S15] round=47 local utility u=0.000000 metrics={'f1_val': 0.992050046918955, 'auprc': 0.9993859606044965, 'loss_val': 0.0316524223667785, 'psi': 0.9949844123931717}-{'f1_val': 0.9967466683875206, 'auprc': 0.9976650857513861, 'loss_val': 0.018476238730309097, 'psi': 0.9971140353330668}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=47 head_norm_before_train=2.082295 (no previous merge yet)
[S16] round=47 local utility u=0.046208 metrics={'f1_val': 0.9722531811357765, 'auprc': 0.9901331787458579, 'loss_val': 0.0904084031976986, 'psi': 0.9794051801798092}-{'f1_val': 0.9595220683034276, 'auprc': 0.9919234808555201, 'loss_val': 0.11180788856323942, 'psi': 0.9724826333242647}
[S17] START round=47 head_norm_before_train=1.866158 cos_to_last_merge=1.0000 (last merge round=46)
[S17] round=47 local utility u=0.182237 metrics={'f1_val': 0.6508871982432902, 'auprc': 0.9366725229394113, 'loss_val': 1.3065853220985462, 'psi': 0.7652013281217387}-{'f1_val': 0.6359792989195454, 'auprc': 0.8876117944999687, 'loss_val': 1.4344292786719217, 'psi': 0.7366322971517147}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.996)
[S3] not sending this round → trigger blocked (psi=0.998)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] → sending delta(kind=head bytes=1805) to S13@127.0.0.1:33213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:33205
[S11] not sending this round → trigger blocked (psi=0.996)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:33216
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S7] → sending delta(kind=head bytes=1792) to S14@127.0.0.1:33214
[S5] sending update (kind=head size=1800 to 1 peers)
[S14] not sending this round → trigger blocked (psi=0.998)
[S16] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:33202
[S7] sending update (kind=head size=1792 to 1 peers)
[S2] sending update (kind=head size=1805 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:33203
[S5] RECEIVED delta(kind=head bytes=1799) from S16
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=2.090594)
[S5] loaded HEAD from S16 (vec_in norm=2.090594)
[S5] cosine check vs S16: cos=-0.1001
[S5] DROPPED delta from S16 (cos=-0.1001 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1805) from S2
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.795195)
[S13] loaded HEAD from S2 (vec_in norm=1.795195)
[S13] cosine check vs S2: cos=0.9995
[S13] BUFFERED delta from S2 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1792) from S7
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.714615)
[S14] loaded HEAD from S7 (vec_in norm=1.714615)
[S14] cosine check vs S7: cos=0.9995
[S14] BUFFERED delta from S7 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1800) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.586695)
[S16] loaded HEAD from S5 (vec_in norm=1.586695)
[S16] cosine check vs S5: cos=-0.1001
[S16] DROPPED delta from S5 (cos=-0.1001 < 0.0)
[S13] sending update (kind=head size=1800 to 1 peers)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=47 metric=0.5506 head_norm=1.714615
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.317350e-02
[S7] stored merged vector for next round verification (round=47)
[S7] DEBUG after merge:  round=47 metric=0.5522 head_norm=1.725347 delta_norm=0.023174
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1800) from S13
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.769020)
[S2] loaded HEAD from S13 (vec_in norm=1.769020)
[S2] cosine check vs S13: cos=0.9995
[S2] BUFFERED delta from S13 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1803) from S17
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.868490)
[S3] loaded HEAD from S17 (vec_in norm=1.868490)
[S3] cosine check vs S17: cos=0.9982
[S3] BUFFERED delta from S17 (total buffered=1)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=47 metric=0.9967 head_norm=1.749214
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.301677e-02
[S14] stored merged vector for next round verification (round=47)
[S14] DEBUG after merge:  round=47 metric=0.9967 head_norm=1.731686 delta_norm=0.033017
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=47 metric=0.5642 head_norm=1.769020
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.157580e-02
[S13] stored merged vector for next round verification (round=47)
[S13] DEBUG after merge:  round=47 metric=0.5642 head_norm=1.781876 delta_norm=0.031576
[S13] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=48 head_norm_before_train=1.795195 cos_to_last_merge=1.0000 (last merge round=46)
[S2] round=48 local utility u=0.043778 metrics={'f1_val': 0.7144809108800965, 'auprc': 0.8174930202450158, 'loss_val': 0.6512868693116128, 'psi': 0.7556857546260642}-{'f1_val': 0.7131187511394631, 'auprc': 0.7875102766333074, 'loss_val': 0.640721703174604, 'psi': 0.7428753613370009}
[S3] START round=48 head_norm_before_train=1.807033 cos_to_last_merge=1.0000 (last merge round=46)
[S3] round=48 local utility u=0.000000 metrics={'f1_val': 0.930970989360573, 'auprc': 0.9985258072628102, 'loss_val': 0.17677095813572566, 'psi': 0.9579929165214678}-{'f1_val': 0.9971149325810758, 'auprc': 0.9993501253735072, 'loss_val': 0.04797244046367484, 'psi': 0.9980090096980483}
[S4] START round=48 head_norm_before_train=1.778545 cos_to_last_merge=0.9958 (last merge round=30)
[S4] round=48 local utility u=0.000000 metrics={'f1_val': 0.9417701678949916, 'auprc': 0.9575973943669254, 'loss_val': 0.3223916866105977, 'psi': 0.948101058483765}-{'f1_val': 0.9434858173643372, 'auprc': 0.9555322388391191, 'loss_val': 0.3180161436190092, 'psi': 0.9483043859542499}
[S5] START round=48 head_norm_before_train=1.586695 cos_to_last_merge=0.7519 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.752
[S5] round=48 local utility u=0.000000 metrics={'f1_val': 0.6286559326766429, 'auprc': 0.9378216586704551, 'loss_val': 0.3381871547848313, 'psi': 0.7523222230741677}-{'f1_val': 0.7005802511973405, 'auprc': 0.9896820340774937, 'loss_val': 0.20681319831580294, 'psi': 0.8162209643494017}
[S6] START round=48 head_norm_before_train=1.896855 cos_to_last_merge=1.0000 (last merge round=46)
[S6] round=48 local utility u=1.000000 metrics={'f1_val': 0.8429108599291838, 'auprc': 0.947739796671804, 'loss_val': 0.6298197749278645, 'psi': 0.8848424346262319}-{'f1_val': 0.6641389455755548, 'auprc': 0.7738556107511283, 'loss_val': 1.145635481643375, 'psi': 0.7080256116457841}
[S7] START round=48 head_norm_before_train=1.725347 cos_to_last_merge=1.0000 (last merge round=47)
[S7] round=48 local utility u=0.810389 metrics={'f1_val': 0.6889844278791799, 'auprc': 0.8647856215876784, 'loss_val': 0.26405922293102274, 'psi': 0.7593049053625793}-{'f1_val': 0.5505501172654376, 'auprc': 0.7842619173753891, 'loss_val': 0.8126607654785637, 'psi': 0.6440348373094182}
[S8] START round=48 head_norm_before_train=1.904222 cos_to_last_merge=0.9933 (last merge round=35)
[S8] round=48 local utility u=0.000000 metrics={'f1_val': 0.9719769161339837, 'auprc': 0.998399783205549, 'loss_val': 0.06872495517662099, 'psi': 0.9825460629626098}-{'f1_val': 0.9933673104406822, 'auprc': 0.9991098899499253, 'loss_val': 0.03161975660833712, 'psi': 0.9956643422443794}
[S9] START round=48 head_norm_before_train=1.636737 cos_to_last_merge=0.9980 (last merge round=37)
[S9] round=48 local utility u=0.000000 metrics={'f1_val': 0.9910040044536889, 'auprc': 0.9949967708273857, 'loss_val': 0.03765937969692336, 'psi': 0.9926011110031676}-{'f1_val': 0.9966924912647621, 'auprc': 0.9901872181746239, 'loss_val': 0.026238395394724747, 'psi': 0.9940903820287068}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=48 head_norm_before_train=1.876777 cos_to_last_merge=0.9986 (last merge round=38)
[S10] round=48 local utility u=0.000562 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9954297660894693, 'loss_val': 0.030116857323039186, 'psi': 0.9950210719674113}-{'f1_val': 0.9945291067983943, 'auprc': 0.9956201187590795, 'loss_val': 0.030494597365759483, 'psi': 0.9949655115826684}
[S10] not sending this round → trigger blocked (psi=0.995)
[S11] START round=48 head_norm_before_train=1.891892 cos_to_last_merge=1.0000 (last merge round=46)
[S11] round=48 local utility u=0.000000 metrics={'f1_val': 0.993752422297881, 'auprc': 0.996302275850621, 'loss_val': 0.034550822955461906, 'psi': 0.9947723637189769}-{'f1_val': 0.9958918378685807, 'auprc': 0.9973422318132186, 'loss_val': 0.030028744732732707, 'psi': 0.9964719954464358}
[S13] START round=48 head_norm_before_train=1.781876 cos_to_last_merge=1.0000 (last merge round=47)
[S13] round=48 local utility u=0.005853 metrics={'f1_val': 0.5623537567759355, 'auprc': 0.6961180586483, 'loss_val': 0.9358532381466312, 'psi': 0.6158594775248812}-{'f1_val': 0.5642142807660275, 'auprc': 0.6787996099291396, 'loss_val': 0.9067664193042245, 'psi': 0.6100484124312724}
[S14] START round=48 head_norm_before_train=1.731686 cos_to_last_merge=1.0000 (last merge round=47)
[S14] round=48 local utility u=0.000000 metrics={'f1_val': 0.9971432857297993, 'auprc': 0.9981304878012455, 'loss_val': 0.04709392810257713, 'psi': 0.9975381665583778}-{'f1_val': 0.9967325241656609, 'auprc': 0.9990065034939313, 'loss_val': 0.04348834877498044, 'psi': 0.997642115896969}
[S15] START round=48 head_norm_before_train=2.124188 cos_to_last_merge=0.8087 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.809
[S15] round=48 local utility u=0.017040 metrics={'f1_val': 0.9963878930881959, 'auprc': 0.9993040815518375, 'loss_val': 0.02335466714867836, 'psi': 0.9975543684736525}-{'f1_val': 0.992050046918955, 'auprc': 0.9993859606044965, 'loss_val': 0.0316524223667785, 'psi': 0.9949844123931717}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=48 head_norm_before_train=2.090594 (no previous merge yet)
[S16] round=48 local utility u=0.042959 metrics={'f1_val': 0.9828013851105588, 'auprc': 0.9904142422329131, 'loss_val': 0.06862261150005847, 'psi': 0.9858465279595006}-{'f1_val': 0.9722531811357765, 'auprc': 0.9901331787458579, 'loss_val': 0.0904084031976986, 'psi': 0.9794051801798092}
[S17] START round=48 head_norm_before_train=1.868490 cos_to_last_merge=0.9999 (last merge round=46)
[S17] round=48 local utility u=0.000000 metrics={'f1_val': 0.6067106879145648, 'auprc': 0.8941533001347073, 'loss_val': 1.4107264133418138, 'psi': 0.7216877328026219}-{'f1_val': 0.6508871982432902, 'auprc': 0.9366725229394113, 'loss_val': 1.3065853220985462, 'psi': 0.7652013281217387}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.986)
[S7] not sending this round → trigger blocked (psi=0.759)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:33212
[S2] not sending this round → trigger blocked (psi=0.756)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=48 metric=0.7145 head_norm=1.814343
[S2] _apply_head_vector_avg (torch): Δ‖w‖=4.202553e-02
[S2] stored merged vector for next round verification (round=48)
[S2] DEBUG after merge:  round=48 metric=0.7144 head_norm=1.791332 delta_norm=0.042026
[S2] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S6] sending update (kind=head size=1800 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.616)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=48 metric=0.9310 head_norm=1.814007
[S3] _apply_head_vector_avg (torch): Δ‖w‖=6.412851e-02
[S3] stored merged vector for next round verification (round=48)
[S3] DEBUG after merge:  round=48 metric=0.9299 head_norm=1.840333 delta_norm=0.064129
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S11] RECEIVED delta(kind=head bytes=1800) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.914544)
[S11] loaded HEAD from S6 (vec_in norm=1.914544)
[S11] cosine check vs S6: cos=0.9998
[S11] BUFFERED delta from S6 (total buffered=1)
[S14]  timeout peer S15
[S13]  timeout peer S4
[S4]  timeout peer S10
[S3]  timeout peer S9
[S2] START round=49 head_norm_before_train=1.791332 cos_to_last_merge=1.0000 (last merge round=48)
[S2] round=49 local utility u=0.000000 metrics={'f1_val': 0.6519057557108692, 'auprc': 0.7634779141272625, 'loss_val': 1.014534204007473, 'psi': 0.6965346190774265}-{'f1_val': 0.7144809108800965, 'auprc': 0.8174930202450158, 'loss_val': 0.6512868693116128, 'psi': 0.7556857546260642}
[S3] START round=49 head_norm_before_train=1.840333 cos_to_last_merge=1.0000 (last merge round=48)
[S3] round=49 local utility u=0.263098 metrics={'f1_val': 0.9966754250663681, 'auprc': 0.9984187413306098, 'loss_val': 0.04448070703099462, 'psi': 0.9973727515720647}-{'f1_val': 0.930970989360573, 'auprc': 0.9985258072628102, 'loss_val': 0.17677095813572566, 'psi': 0.9579929165214678}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=49 head_norm_before_train=1.787599 cos_to_last_merge=0.9955 (last merge round=30)
[S4] round=49 local utility u=0.000000 metrics={'f1_val': 0.9404792207841292, 'auprc': 0.9584428800959836, 'loss_val': 0.3346771138121664, 'psi': 0.947664684508871}-{'f1_val': 0.9417701678949916, 'auprc': 0.9575973943669254, 'loss_val': 0.3223916866105977, 'psi': 0.948101058483765}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=49 head_norm_before_train=1.592605 cos_to_last_merge=0.7514 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.751
[S5] round=49 local utility u=0.000000 metrics={'f1_val': 0.43692783079575537, 'auprc': 0.8569056439155065, 'loss_val': 1.1668829114652823, 'psi': 0.6049189560436559}-{'f1_val': 0.6286559326766429, 'auprc': 0.9378216586704551, 'loss_val': 0.3381871547848313, 'psi': 0.7523222230741677}
[S6] START round=49 head_norm_before_train=1.914544 cos_to_last_merge=0.9999 (last merge round=46)
[S6] round=49 local utility u=0.000000 metrics={'f1_val': 0.7913225730124148, 'auprc': 0.8839291413566931, 'loss_val': 0.6294178221963446, 'psi': 0.8283652003501261}-{'f1_val': 0.8429108599291838, 'auprc': 0.947739796671804, 'loss_val': 0.6298197749278645, 'psi': 0.8848424346262319}
[S7] START round=49 head_norm_before_train=1.727527 cos_to_last_merge=1.0000 (last merge round=47)
[S7] round=49 local utility u=0.000000 metrics={'f1_val': 0.5806209613201541, 'auprc': 0.7864638384725662, 'loss_val': 0.7187452454313294, 'psi': 0.662958112181119}-{'f1_val': 0.6889844278791799, 'auprc': 0.8647856215876784, 'loss_val': 0.26405922293102274, 'psi': 0.7593049053625793}
[S8] START round=49 head_norm_before_train=1.912008 cos_to_last_merge=0.9930 (last merge round=35)
[S8] round=49 local utility u=0.000000 metrics={'f1_val': 0.9186463881065976, 'auprc': 0.9954232111982619, 'loss_val': 0.18031879269854362, 'psi': 0.9493571173432633}-{'f1_val': 0.9719769161339837, 'auprc': 0.998399783205549, 'loss_val': 0.06872495517662099, 'psi': 0.9825460629626098}
[S9] START round=49 head_norm_before_train=1.644942 cos_to_last_merge=0.9977 (last merge round=37)
[S9] round=49 local utility u=0.024193 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9956781475657179, 'loss_val': 0.025256336760635975, 'psi': 0.9962675661146221}-{'f1_val': 0.9910040044536889, 'auprc': 0.9949967708273857, 'loss_val': 0.03765937969692336, 'psi': 0.9926011110031676}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=49 head_norm_before_train=1.886556 cos_to_last_merge=0.9984 (last merge round=38)
[S10] round=49 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9946039304484322, 'loss_val': 0.029898286596977002, 'psi': 0.9946907377109964}-{'f1_val': 0.9947486092193725, 'auprc': 0.9954297660894693, 'loss_val': 0.030116857323039186, 'psi': 0.9950210719674113}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=49 head_norm_before_train=1.899977 cos_to_last_merge=1.0000 (last merge round=46)
[S11] round=49 local utility u=0.000000 metrics={'f1_val': 0.9129003827638473, 'auprc': 0.9963023852186181, 'loss_val': 0.11943951259874742, 'psi': 0.9462611837457556}-{'f1_val': 0.993752422297881, 'auprc': 0.996302275850621, 'loss_val': 0.034550822955461906, 'psi': 0.9947723637189769}
[S13] START round=49 head_norm_before_train=1.791693 cos_to_last_merge=1.0000 (last merge round=47)
[S13] round=49 local utility u=0.000000 metrics={'f1_val': 0.5616168696975281, 'auprc': 0.6892681962983108, 'loss_val': 0.9839896311385866, 'psi': 0.6126774003378412}-{'f1_val': 0.5623537567759355, 'auprc': 0.6961180586483, 'loss_val': 0.9358532381466312, 'psi': 0.6158594775248812}
[S14] START round=49 head_norm_before_train=1.745377 cos_to_last_merge=1.0000 (last merge round=47)
[S14] round=49 local utility u=0.001258 metrics={'f1_val': 0.9973833833620065, 'auprc': 0.997048517840535, 'loss_val': 0.04277186542648997, 'psi': 0.997249437153418}-{'f1_val': 0.9971432857297993, 'auprc': 0.9981304878012455, 'loss_val': 0.04709392810257713, 'psi': 0.9975381665583778}
[S15] START round=49 head_norm_before_train=2.133000 cos_to_last_merge=0.8081 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.808
[S15] round=49 local utility u=0.000000 metrics={'f1_val': 0.9963164379542544, 'auprc': 0.9978489660630182, 'loss_val': 0.019645577397857553, 'psi': 0.9969294491977599}-{'f1_val': 0.9963878930881959, 'auprc': 0.9993040815518375, 'loss_val': 0.02335466714867836, 'psi': 0.9975543684736525}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=49 head_norm_before_train=2.098144 (no previous merge yet)
[S16] round=49 local utility u=0.028918 metrics={'f1_val': 0.9893318277128644, 'auprc': 0.9924485753956391, 'loss_val': 0.05607253121558294, 'psi': 0.9905785267859742}-{'f1_val': 0.9828013851105588, 'auprc': 0.9904142422329131, 'loss_val': 0.06862261150005847, 'psi': 0.9858465279595006}
[S17] START round=49 head_norm_before_train=1.870089 cos_to_last_merge=0.9997 (last merge round=46)
[S17] round=49 local utility u=0.899462 metrics={'f1_val': 0.7643486799417212, 'auprc': 0.9653801339424537, 'loss_val': 0.7713099921346876, 'psi': 0.8447612615420141}-{'f1_val': 0.6067106879145648, 'auprc': 0.8941533001347073, 'loss_val': 1.4107264133418138, 'psi': 0.7216877328026219}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:33205
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:33208
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=49 metric=0.9129 head_norm=1.906675
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.192585e-02
[S11] stored merged vector for next round verification (round=49)
[S11] DEBUG after merge:  round=49 metric=0.9129 head_norm=1.910488 delta_norm=0.021926
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S14] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:33203
[S7] RECEIVED delta(kind=head bytes=1796) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.759938)
[S7] loaded HEAD from S14 (vec_in norm=1.759938)
[S7] cosine check vs S14: cos=0.9997
[S7] BUFFERED delta from S14 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1798) from S16
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=2.102613)
[S5] loaded HEAD from S16 (vec_in norm=2.102613)
[S5] cosine check vs S16: cos=-0.0987
[S5] DROPPED delta from S16 (cos=-0.0987 < 0.0)
[S17] sending update (kind=head size=1799 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1799) from S17
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.869161)
[S3] loaded HEAD from S17 (vec_in norm=1.869161)
[S3] cosine check vs S17: cos=0.9988
[S3] BUFFERED delta from S17 (total buffered=1)
[runner] rounds complete.
[runner] all agents stopped.
