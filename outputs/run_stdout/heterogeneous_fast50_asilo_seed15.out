[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:33203
[S3] → join 127.0.0.1:33202
[S4] → join 127.0.0.1:33202
[S5] → join 127.0.0.1:33202
[S6] → join 127.0.0.1:33202
[S7] → join 127.0.0.1:33202
[S8] → join 127.0.0.1:33202
[S9] → join 127.0.0.1:33202
[S10] → join 127.0.0.1:33202
[S11] → join 127.0.0.1:33202
[S13] → join 127.0.0.1:33202
[S14] → join 127.0.0.1:33202
[S15] → join 127.0.0.1:33202
[S16] → join 127.0.0.1:33202
[S17] → join 127.0.0.1:33202
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.166986 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.211082 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.183108 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.176587 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.196742 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.176713 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.181023 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.128548 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.136709 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.162353 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.100754 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.144344 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.138662 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.193321 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.154881 (no previous merge yet)
[S8]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S3] + discovered S15
[S3] + discovered S13
[S3] + discovered S5
[S4] + discovered S2
[S4] + discovered S3
[S3] + discovered S4
[S3] + discovered S10
[S3] + discovered S16
[S3] + discovered S11
[S3] + discovered S6
[S3] + discovered S14
[S3] + discovered S17
[S3] + discovered S7
[S3] + discovered S9
[S3] + discovered S8
[S4] + discovered S10
[S4] + discovered S6
[S4] + discovered S11
[S4] + discovered S17
[S4] + discovered S16
[S4] + discovered S14
[S4] + discovered S7
[S4] + discovered S8
[S4] + discovered S9
[S4] + discovered S15
[S4] + discovered S13
[S4] + discovered S5
[S5] + discovered S2
[S5] + discovered S4
[S5] + discovered S3
[S6] + discovered S3
[S6] + discovered S4
[S6] + discovered S5
[S6] + discovered S2
[S5] + discovered S9
[S5] + discovered S13
[S5] + discovered S15
[S5] + discovered S14
[S5] + discovered S16
[S5] + discovered S6
[S5] + discovered S8
[S5] + discovered S7
[S5] + discovered S17
[S5] + discovered S11
[S5] + discovered S10
[S6] + discovered S16
[S6] + discovered S8
[S6] + discovered S17
[S6] + discovered S11
[S6] + discovered S14
[S6] + discovered S7
[S6] + discovered S15
[S6] + discovered S10
[S7] + discovered S4
[S7] + discovered S3
[S7] + discovered S2
[S7] + discovered S6
[S7] + discovered S5
[S6] + discovered S9
[S6] + discovered S13
[S8] + discovered S3
[S8] + discovered S6
[S8] + discovered S7
[S8] + discovered S4
[S8] + discovered S5
[S8] + discovered S2
[S7] + discovered S9
[S7] + discovered S16
[S7] + discovered S8
[S7] + discovered S14
[S7] + discovered S10
[S7] + discovered S15
[S7] + discovered S13
[S7] + discovered S17
[S7] + discovered S11
[S9] + discovered S6
[S8] + discovered S10
[S9] + discovered S3
[S8] + discovered S15
[S8] + discovered S14
[S8] + discovered S9
[S8] + discovered S11
[S8] + discovered S17
[S8] + discovered S13
[S8] + discovered S16
[S9] + discovered S5
[S9] + discovered S8
[S9] + discovered S7
[S9] + discovered S4
[S9] + discovered S2
[S9] + discovered S13
[S9] + discovered S15
[S9] + discovered S16
[S9] + discovered S17
[S9] + discovered S11
[S9] + discovered S14
[S9] + discovered S10
[S10] + discovered S3
[S10] + discovered S7
[S10] + discovered S6
[S10] + discovered S2
[S10] + discovered S8
[S10] + discovered S4
[S10] + discovered S5
[S10] + discovered S9
[S10] + discovered S11
[S10] + discovered S14
[S10] + discovered S13
[S10] + discovered S17
[S10] + discovered S16
[S10] + discovered S15
[S11] + discovered S10
[S11] + discovered S9
[S11] + discovered S5
[S11] + discovered S4
[S11] + discovered S8
[S11] + discovered S6
[S11] + discovered S3
[S11] + discovered S7
[S11] + discovered S2
[S13] + discovered S2
[S13] + discovered S7
[S13] + discovered S4
[S13] + discovered S5
[S13] + discovered S9
[S13] + discovered S3
[S13] + discovered S6
[S13] + discovered S8
[S13] + discovered S11
[S13] + discovered S10
[S11] + discovered S16
[S11] + discovered S14
[S11] + discovered S13
[S11] + discovered S15
[S11] + discovered S17
[S13] + discovered S17
[S13] + discovered S15
[S13] + discovered S14
[S14] + discovered S8
[S14] + discovered S3
[S14] + discovered S5
[S14] + discovered S13
[S14] + discovered S7
[S14] + discovered S11
[S14] + discovered S6
[S14] + discovered S9
[S14] + discovered S4
[S14] + discovered S10
[S14] + discovered S2
[S13] + discovered S16
[S14] + discovered S16
[S15] + discovered S14
[S15] + discovered S6
[S15] + discovered S13
[S15] + discovered S4
[S15] + discovered S3
[S14] + discovered S17
[S15] + discovered S2
[S15] + discovered S10
[S15] + discovered S9
[S15] + discovered S8
[S15] + discovered S11
[S15] + discovered S7
[S14] + discovered S15
[S15] + discovered S5
[S16] + discovered S7
[S16] + discovered S5
[S16] + discovered S2
[S16] + discovered S9
[S16] + discovered S14
[S16] + discovered S15
[S16] + discovered S3
[S16] + discovered S11
[S16] + discovered S10
[S16] + discovered S13
[S16] + discovered S8
[S16] + discovered S4
[S16] + discovered S6
[S15] + discovered S17
[S15] + discovered S16
[S17] + discovered S11
[S17] + discovered S9
[S17] + discovered S7
[S17] + discovered S5
[S17] + discovered S6
[S17] + discovered S4
[S17] + discovered S13
[S17] + discovered S8
[S17] + discovered S3
[S17] + discovered S10
[S17] + discovered S15
[S17] + discovered S16
[S16] + discovered S17
[S17] + discovered S2
[S17] + discovered S14
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] ⇄ pheromone p=1.000 → S17@127.0.0.1:33217
[S13] ⇄ pheromone p=1.000 → S4@127.0.0.1:33204
[S6] ⇄ pheromone p=1.000 → S11@127.0.0.1:33212
[S4] ⇄ pheromone p=1.000 → S8@127.0.0.1:33209
[S2] ⇄ pheromone p=1.000 → S13@127.0.0.1:33213
[S8] ⇄ pheromone p=1.000 → S4@127.0.0.1:33204
[S11] ⇄ pheromone p=1.000 → S13@127.0.0.1:33213
[S15] ⇄ pheromone p=1.000 → S11@127.0.0.1:33212
[S5] ⇄ pheromone p=1.000 → S16@127.0.0.1:33216
[S16] ⇄ pheromone p=1.000 → S17@127.0.0.1:33217
[S14] ⇄ pheromone p=1.000 → S15@127.0.0.1:33215
[S7] ⇄ pheromone p=1.000 → S14@127.0.0.1:33214
[S10] ⇄ pheromone p=1.000 → S3@127.0.0.1:33203
[S3] ⇄ pheromone p=1.000 → S9@127.0.0.1:33210
[S17] ⇄ pheromone p=1.000 → S3@127.0.0.1:33203
[S2] START round=1 head_norm_before_train=1.178775 (no previous merge yet)
[S2] round=1 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6113793283650898, 'loss_val': 1.23693950930019, 'psi': 0.32961801137917596}-{'f1_val': 0.16442469373048282, 'auprc': 0.6174345972516506, 'loss_val': 1.318473039730171, 'psi': 0.34562865513894997}
[S3] START round=1 head_norm_before_train=1.215784 (no previous merge yet)
[S3] round=1 local utility u=1.000000 metrics={'f1_val': 0.3808208128142279, 'auprc': 0.9130412263372383, 'loss_val': 1.3282767226958723, 'psi': 0.5937089782234322}-{'f1_val': 0.08969866853538892, 'auprc': 0.8142435972827525, 'loss_val': 1.36168700946291, 'psi': 0.3795166400343344}
[S4] START round=1 head_norm_before_train=1.208261 (no previous merge yet)
[S4] round=1 local utility u=0.000000 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7816987162578357, 'loss_val': 1.2138339138738887, 'psi': 0.3968154638402448}-{'f1_val': 0.14022662889518414, 'auprc': 0.8584441076059655, 'loss_val': 1.3129306721966447, 'psi': 0.4275136203794967}
[S5] START round=1 head_norm_before_train=1.188419 (no previous merge yet)
[S5] round=1 local utility u=0.142568 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.715735433847727, 'loss_val': 1.3043236133435552, 'psi': 0.37165131639623367}-{'f1_val': 0.14226190476190476, 'auprc': 0.6332487908176425, 'loss_val': 1.3419993020849441, 'psi': 0.33865665918419985}
[S6] START round=1 head_norm_before_train=1.213764 (no previous merge yet)
[S6] round=1 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.7928527184177641, 'loss_val': 1.2581736978577587, 'psi': 0.4019968565978749}-{'f1_val': 0.14142628205128205, 'auprc': 0.8133630196835991, 'loss_val': 1.3190995299885897, 'psi': 0.4102009771042089}
[S7] START round=1 head_norm_before_train=1.182387 (no previous merge yet)
[S7] round=1 local utility u=0.020529 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7872428495361175, 'loss_val': 1.3199040286467842, 'psi': 0.400131233451902}-{'f1_val': 0.14205682272909165, 'auprc': 0.7851207541893377, 'loss_val': 1.354595993806336, 'psi': 0.3992823953131901}
[S8] START round=1 head_norm_before_train=1.198936 (no previous merge yet)
[S8] round=1 local utility u=0.112242 metrics={'f1_val': 0.416084496488008, 'auprc': 0.5130645760999204, 'loss_val': 1.287305093649935, 'psi': 0.4548765283327729}-{'f1_val': 0.41644030110281194, 'auprc': 0.4590368472256429, 'loss_val': 1.3518415795925152, 'psi': 0.4334789195519443}
[S9] START round=1 head_norm_before_train=1.120816 (no previous merge yet)
[S9] round=1 local utility u=0.531603 metrics={'f1_val': 0.141397957139996, 'auprc': 0.7926209474457281, 'loss_val': 1.3203020473576372, 'psi': 0.40188715326228885}-{'f1_val': 0.141397957139996, 'auprc': 0.44997601013399746, 'loss_val': 1.355572304235993, 'psi': 0.2648291783375966}
[S10] START round=1 head_norm_before_train=1.153857 (no previous merge yet)
[S10] round=1 local utility u=0.296368 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.5632567253793374, 'loss_val': 1.2839843580241463, 'psi': 0.30847567267676934}-{'f1_val': 0.13862163754172394, 'auprc': 0.38561482524913243, 'loss_val': 1.3437947079801218, 'psi': 0.23741891262468734}
[S11] START round=1 head_norm_before_train=1.176025 (no previous merge yet)
[S11] round=1 local utility u=0.457224 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.8727556366870769, 'loss_val': 1.302393677934925, 'psi': 0.43335046469869715}-{'f1_val': 0.14041368337311058, 'auprc': 0.5760159204947111, 'loss_val': 1.3266223807467603, 'psi': 0.3146545782217508}
[S13] START round=1 head_norm_before_train=1.124020 (no previous merge yet)
[S13] round=1 local utility u=0.033359 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.6051124311927472, 'loss_val': 1.2304277816972538, 'psi': 0.32627643002333073}-{'f1_val': 0.1403857625770531, 'auprc': 0.6086325827047199, 'loss_val': 1.3077068398656901, 'psi': 0.32768449062811983}
[S14] START round=1 head_norm_before_train=1.153958 (no previous merge yet)
[S14] round=1 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8302576982058304, 'loss_val': 1.3271512023995704, 'psi': 0.41631779101195443}-{'f1_val': 0.3905667623250646, 'auprc': 0.6070001904435349, 'loss_val': 1.3509459313594059, 'psi': 0.4771401335724527}
[S15] START round=1 head_norm_before_train=1.153736 (no previous merge yet)
[S15] round=1 local utility u=0.029745 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7767045780225913, 'loss_val': 1.2785999728838606, 'psi': 0.39452202202597153}-{'f1_val': 0.13973365136155833, 'auprc': 0.7701264284730159, 'loss_val': 1.3183549955476512, 'psi': 0.3918907622061414}
[S16] START round=1 head_norm_before_train=1.197727 (no previous merge yet)
[S16] round=1 local utility u=0.354113 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.9173407013434853, 'loss_val': 1.3107559810717972, 'psi': 0.45131875065691607}-{'f1_val': 0.14063745019920318, 'auprc': 0.6903226267232119, 'loss_val': 1.337927165264822, 'psi': 0.36051152080880666}
[S17] START round=1 head_norm_before_train=1.171598 (no previous merge yet)
[S17] round=1 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.7477821600091147, 'loss_val': 1.275222944377684, 'psi': 0.3836822419940765}-{'f1_val': 0.3517497968305567, 'auprc': 0.7578745343650489, 'loss_val': 1.3354526093870398, 'psi': 0.5141996918443535}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S3] → sending delta(kind=head bytes=1787) to S2@127.0.0.1:33202
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S5] → sending delta(kind=head bytes=1789) to S10@127.0.0.1:33211
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S7] → sending delta(kind=head bytes=1790) to S10@127.0.0.1:33211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:33213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S16] → sending delta(kind=head bytes=1789) to S2@127.0.0.1:33202
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S8] → sending delta(kind=head bytes=1792) to S11@127.0.0.1:33212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S9] → sending delta(kind=head bytes=1788) to S7@127.0.0.1:33208
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S15] → sending delta(kind=head bytes=1789) to S5@127.0.0.1:33205
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S11] → sending delta(kind=head bytes=1791) to S8@127.0.0.1:33209
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:33208
[S16] sending update (kind=head size=1789 to 1 peers)
[S5] sending update (kind=head size=1789 to 1 peers)
[S11] sending update (kind=head size=1791 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1788 to 1 peers)
[S8] sending update (kind=head size=1792 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1790 to 1 peers)
[S3] sending update (kind=head size=1787 to 1 peers)
[S15] sending update (kind=head size=1789 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1796) from S10
[S13] cosine check vs S10: cos=-0.0560
[S13] DROPPED delta from S10 (cos=-0.0560 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1789) from S16
[S2] cosine check vs S16: cos=0.0740
[S2] RECEIVED delta(kind=head bytes=1787) from S3
[S2] cosine check vs S3: cos=-0.1167
[S2] DROPPED delta from S3 (cos=-0.1167 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1791) from S11
[S8] cosine check vs S11: cos=-0.0198
[S8] DROPPED delta from S11 (cos=-0.0198 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1790) from S7
[S10] cosine check vs S7: cos=0.0274
[S10] RECEIVED delta(kind=head bytes=1789) from S5
[S10] cosine check vs S5: cos=-0.0852
[S10] DROPPED delta from S5 (cos=-0.0852 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1798) from S13
[S7] cosine check vs S13: cos=0.0045
[S7] RECEIVED delta(kind=head bytes=1788) from S9
[S7] cosine check vs S9: cos=-0.0502
[S7] DROPPED delta from S9 (cos=-0.0502 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1789) from S15
[S5] cosine check vs S15: cos=-0.0879
[S5] DROPPED delta from S15 (cos=-0.0879 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1792) from S8
[S11] cosine check vs S8: cos=-0.0198
[S11] DROPPED delta from S8 (cos=-0.0198 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=1 metric=0.1418 head_norm=1.221166
[S2] _apply_head_vector_avg (torch): Δ‖w‖=8.275348e-01
[S2] stored merged vector for next round verification (round=1)
[S2] DEBUG after merge:  round=1 metric=0.1418 head_norm=0.891174 delta_norm=0.827535
[S2] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=1 metric=0.1421 head_norm=1.199646
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.380435e-01
[S7] stored merged vector for next round verification (round=1)
[S7] DEBUG after merge:  round=1 metric=0.1421 head_norm=0.841786 delta_norm=0.838043
[S7] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=1 metric=0.1386 head_norm=1.193767
[S10] _apply_head_vector_avg (torch): Δ‖w‖=8.345253e-01
[S10] stored merged vector for next round verification (round=1)
[S10] DEBUG after merge:  round=1 metric=0.1386 head_norm=0.857719 delta_norm=0.834525
[S10] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=0.891174 cos_to_last_merge=1.0000 (last merge round=1)
[S2] round=2 local utility u=0.018006 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6136480139183085, 'loss_val': 1.2077327001753417, 'psi': 0.3305254856004634}-{'f1_val': 0.1417771333885667, 'auprc': 0.6113793283650898, 'loss_val': 1.23693950930019, 'psi': 0.32961801137917596}
[S3] START round=2 head_norm_before_train=1.226321 (no previous merge yet)
[S3] round=2 local utility u=0.000000 metrics={'f1_val': 0.1729647476540705, 'auprc': 0.9984276659090019, 'loss_val': 1.2891370250401755, 'psi': 0.503149914956043}-{'f1_val': 0.3808208128142279, 'auprc': 0.9130412263372383, 'loss_val': 1.3282767226958723, 'psi': 0.5937089782234322}
[S4] START round=2 head_norm_before_train=1.266271 (no previous merge yet)
[S4] round=2 local utility u=1.000000 metrics={'f1_val': 0.5159463335424459, 'auprc': 0.7680125645696907, 'loss_val': 0.9962527743843691, 'psi': 0.6167728259533438}-{'f1_val': 0.14022662889518414, 'auprc': 0.7816987162578357, 'loss_val': 1.2138339138738887, 'psi': 0.3968154638402448}
[S5] START round=2 head_norm_before_train=1.211012 (no previous merge yet)
[S5] round=2 local utility u=0.050704 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7356010649645406, 'loss_val': 1.2625123464606351, 'psi': 0.3795975688429591}-{'f1_val': 0.14226190476190476, 'auprc': 0.715735433847727, 'loss_val': 1.3043236133435552, 'psi': 0.37165131639623367}
[S6] START round=2 head_norm_before_train=1.255316 (no previous merge yet)
[S6] round=2 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.7498277983173639, 'loss_val': 1.1943994915834495, 'psi': 0.38478688855771476}-{'f1_val': 0.14142628205128205, 'auprc': 0.7928527184177641, 'loss_val': 1.2581736978577587, 'psi': 0.4019968565978749}
[S7] START round=2 head_norm_before_train=0.841786 cos_to_last_merge=1.0000 (last merge round=1)
[S7] round=2 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7700504924087868, 'loss_val': 1.3167997940635552, 'psi': 0.3932542906009697}-{'f1_val': 0.14205682272909165, 'auprc': 0.7872428495361175, 'loss_val': 1.3199040286467842, 'psi': 0.400131233451902}
[S8] START round=2 head_norm_before_train=1.240286 (no previous merge yet)
[S8] round=2 local utility u=0.157717 metrics={'f1_val': 0.3439372648953487, 'auprc': 0.722120331887077, 'loss_val': 1.1661556785720337, 'psi': 0.49521049169204007}-{'f1_val': 0.416084496488008, 'auprc': 0.5130645760999204, 'loss_val': 1.287305093649935, 'psi': 0.4548765283327729}
[S9] START round=2 head_norm_before_train=1.127747 (no previous merge yet)
[S9] round=2 local utility u=0.020308 metrics={'f1_val': 0.141397957139996, 'auprc': 0.7926446908025144, 'loss_val': 1.2797570819990465, 'psi': 0.4018966506050034}-{'f1_val': 0.141397957139996, 'auprc': 0.7926209474457281, 'loss_val': 1.3203020473576372, 'psi': 0.40188715326228885}
[S10] START round=2 head_norm_before_train=0.857719 cos_to_last_merge=1.0000 (last merge round=1)
[S10] round=2 local utility u=0.090135 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6169909856666941, 'loss_val': 1.2649166904664764, 'psi': 0.329969376791712}-{'f1_val': 0.13862163754172394, 'auprc': 0.5632567253793374, 'loss_val': 1.2839843580241463, 'psi': 0.30847567267676934}
[S11] START round=2 head_norm_before_train=1.193471 (no previous merge yet)
[S11] round=2 local utility u=0.024022 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.8789424069608992, 'loss_val': 1.272910887526501, 'psi': 0.435825172808226}-{'f1_val': 0.14041368337311058, 'auprc': 0.8727556366870769, 'loss_val': 1.302393677934925, 'psi': 0.43335046469869715}
[S13] START round=2 head_norm_before_train=1.175878 (no previous merge yet)
[S13] round=2 local utility u=0.983639 metrics={'f1_val': 0.39716154379477697, 'auprc': 0.7091735172706259, 'loss_val': 1.1159875000301045, 'psi': 0.5219663331851165}-{'f1_val': 0.1403857625770531, 'auprc': 0.6051124311927472, 'loss_val': 1.2304277816972538, 'psi': 0.32627643002333073}
[S14] START round=2 head_norm_before_train=1.169595 (no previous merge yet)
[S14] round=2 local utility u=0.059354 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8608357001457028, 'loss_val': 1.3001771737779348, 'psi': 0.4285489917879034}-{'f1_val': 0.14035785288270378, 'auprc': 0.8302576982058304, 'loss_val': 1.3271512023995704, 'psi': 0.41631779101195443}
[S15] START round=2 head_norm_before_train=1.187217 (no previous merge yet)
[S15] round=2 local utility u=0.038358 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7770528032515119, 'loss_val': 1.2029281059490096, 'psi': 0.3946613121175398}-{'f1_val': 0.13973365136155833, 'auprc': 0.7767045780225913, 'loss_val': 1.2785999728838606, 'psi': 0.39452202202597153}
[S16] START round=2 head_norm_before_train=1.211100 (no previous merge yet)
[S16] round=2 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8669406017436252, 'loss_val': 1.2792190611753638, 'psi': 0.431158710816972}-{'f1_val': 0.14063745019920318, 'auprc': 0.9173407013434853, 'loss_val': 1.3107559810717972, 'psi': 0.45131875065691607}
[S17] START round=2 head_norm_before_train=1.210919 (no previous merge yet)
[S17] round=2 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5569484341146129, 'loss_val': 1.1439213517867282, 'psi': 0.30734875163627584}-{'f1_val': 0.14094896331738438, 'auprc': 0.7477821600091147, 'loss_val': 1.275222944377684, 'psi': 0.3836822419940765}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.436)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:33216
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:33205
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.495)
[S5] not sending this round → trigger blocked (psi=0.380)
[S10] not sending this round → trigger blocked (psi=0.330)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S14] → sending delta(kind=head bytes=1789) to S10@127.0.0.1:33211
[S13] not sending this round → trigger blocked (psi=0.522)
[S15] not sending this round → trigger blocked (psi=0.395)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.402)
[S14] sending update (kind=head size=1789 to 1 peers)
[S4] sending update (kind=head size=1793 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1789) from S14
[S10] cosine check vs S14: cos=0.0760
[S5] RECEIVED delta(kind=head bytes=1800) from S2
[S5] cosine check vs S2: cos=-0.0296
[S5] DROPPED delta from S2 (cos=-0.0296 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1793) from S4
[S16] cosine check vs S4: cos=0.0192
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=2 metric=0.1386 head_norm=0.902907
[S10] _apply_head_vector_avg (torch): Δ‖w‖=7.203662e-01
[S10] stored merged vector for next round verification (round=2)
[S10] DEBUG after merge:  round=2 metric=0.1386 head_norm=0.775119 delta_norm=0.720366
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=2 metric=0.1406 head_norm=1.235529
[S16] _apply_head_vector_avg (torch): Δ‖w‖=9.052889e-01
[S16] stored merged vector for next round verification (round=2)
[S16] DEBUG after merge:  round=2 metric=0.1406 head_norm=0.922761 delta_norm=0.905289
[S16] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=3 head_norm_before_train=0.939799 cos_to_last_merge=0.9930 (last merge round=1)
[S2] round=3 local utility u=0.394715 metrics={'f1_val': 0.16727761485826, 'auprc': 0.7778888031172917, 'loss_val': 1.0640289168180312, 'psi': 0.4115220901618727}-{'f1_val': 0.1417771333885667, 'auprc': 0.6136480139183085, 'loss_val': 1.2077327001753417, 'psi': 0.3305254856004634}
[S3] START round=3 head_norm_before_train=1.246239 (no previous merge yet)
[S3] round=3 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9988423666431634, 'loss_val': 1.2332083003533174, 'psi': 0.4834409860257296}-{'f1_val': 0.1729647476540705, 'auprc': 0.9984276659090019, 'loss_val': 1.2891370250401755, 'psi': 0.503149914956043}
[S4] START round=3 head_norm_before_train=1.347420 (no previous merge yet)
[S4] round=3 local utility u=0.452008 metrics={'f1_val': 0.668427567222837, 'auprc': 0.6610491717332779, 'loss_val': 0.6862342386589876, 'psi': 0.6654762090270134}-{'f1_val': 0.5159463335424459, 'auprc': 0.7680125645696907, 'loss_val': 0.9962527743843691, 'psi': 0.6167728259533438}
[S5] START round=3 head_norm_before_train=1.240483 (no previous merge yet)
[S5] round=3 local utility u=0.020198 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7368651261118178, 'loss_val': 1.2259094513329907, 'psi': 0.38010319330187}-{'f1_val': 0.14226190476190476, 'auprc': 0.7356010649645406, 'loss_val': 1.2625123464606351, 'psi': 0.3795975688429591}
[S6] START round=3 head_norm_before_train=1.302554 (no previous merge yet)
[S6] round=3 local utility u=0.757744 metrics={'f1_val': 0.4164535851642239, 'auprc': 0.6612821948214214, 'loss_val': 1.0634385146851768, 'psi': 0.5143850290271028}-{'f1_val': 0.14142628205128205, 'auprc': 0.7498277983173639, 'loss_val': 1.1943994915834495, 'psi': 0.38478688855771476}
[S7] START round=3 head_norm_before_train=0.863723 cos_to_last_merge=0.9965 (last merge round=1)
[S7] round=3 local utility u=0.025766 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7771149472395353, 'loss_val': 1.2864612457861027, 'psi': 0.39608007253326916}-{'f1_val': 0.14205682272909165, 'auprc': 0.7700504924087868, 'loss_val': 1.3167997940635552, 'psi': 0.3932542906009697}
[S8] START round=3 head_norm_before_train=1.305732 (no previous merge yet)
[S8] round=3 local utility u=0.387709 metrics={'f1_val': 0.4162109668030748, 'auprc': 0.7693287634546875, 'loss_val': 0.9660046822445143, 'psi': 0.5574580854637199}-{'f1_val': 0.3439372648953487, 'auprc': 0.722120331887077, 'loss_val': 1.1661556785720337, 'psi': 0.49521049169204007}
[S9] START round=3 head_norm_before_train=1.145590 (no previous merge yet)
[S9] round=3 local utility u=0.036615 metrics={'f1_val': 0.141397957139996, 'auprc': 0.7999675792056099, 'loss_val': 1.228495002072712, 'psi': 0.40482580596624157}-{'f1_val': 0.141397957139996, 'auprc': 0.7926446908025144, 'loss_val': 1.2797570819990465, 'psi': 0.4018966506050034}
[S10] START round=3 head_norm_before_train=0.775119 cos_to_last_merge=1.0000 (last merge round=2)
[S10] round=3 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6030237623064977, 'loss_val': 1.2368357992089432, 'psi': 0.3243824874476334}-{'f1_val': 0.13862163754172394, 'auprc': 0.6169909856666941, 'loss_val': 1.2649166904664764, 'psi': 0.329969376791712}
[S11] START round=3 head_norm_before_train=1.217060 (no previous merge yet)
[S11] round=3 local utility u=0.045190 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.8937216752481606, 'loss_val': 1.226868710190229, 'psi': 0.4417368801231306}-{'f1_val': 0.14041368337311058, 'auprc': 0.8789424069608992, 'loss_val': 1.272910887526501, 'psi': 0.435825172808226}
[S13] START round=3 head_norm_before_train=1.233758 (no previous merge yet)
[S13] round=3 local utility u=0.000000 metrics={'f1_val': 0.3718686783021842, 'auprc': 0.5662208541180165, 'loss_val': 0.9887622400363016, 'psi': 0.4496095486285171}-{'f1_val': 0.39716154379477697, 'auprc': 0.7091735172706259, 'loss_val': 1.1159875000301045, 'psi': 0.5219663331851165}
[S14] START round=3 head_norm_before_train=1.193412 (no previous merge yet)
[S14] round=3 local utility u=0.009318 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8565788821342891, 'loss_val': 1.2687705783715273, 'psi': 0.4268462645833379}-{'f1_val': 0.14035785288270378, 'auprc': 0.8608357001457028, 'loss_val': 1.3001771737779348, 'psi': 0.4285489917879034}
[S15] START round=3 head_norm_before_train=1.238619 (no previous merge yet)
[S15] round=3 local utility u=0.934051 metrics={'f1_val': 0.4169508412658852, 'auprc': 0.7856769099218539, 'loss_val': 1.0240010653780232, 'psi': 0.5644412687282727}-{'f1_val': 0.13973365136155833, 'auprc': 0.7770528032515119, 'loss_val': 1.2029281059490096, 'psi': 0.3946613121175398}
[S16] START round=3 head_norm_before_train=0.922761 cos_to_last_merge=1.0000 (last merge round=2)
[S16] round=3 local utility u=0.190782 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.9997543026570954, 'loss_val': 1.296096963427207, 'psi': 0.4842841911823601}-{'f1_val': 0.14063745019920318, 'auprc': 0.8669406017436252, 'loss_val': 1.2792190611753638, 'psi': 0.431158710816972}
[S17] START round=3 head_norm_before_train=1.273374 (no previous merge yet)
[S17] round=3 local utility u=0.993535 metrics={'f1_val': 0.4172163973850558, 'auprc': 0.6024544803340512, 'loss_val': 0.9509743764319692, 'psi': 0.491311630564654}-{'f1_val': 0.14094896331738438, 'auprc': 0.5569484341146129, 'loss_val': 1.1439213517867282, 'psi': 0.30734875163627584}
[S14] not sending this round → trigger blocked (psi=0.427)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:33214
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:33212
[S4] not sending this round → trigger blocked (psi=0.665)
[S2] not sending this round → trigger blocked (psi=0.412)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:33217
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:33212
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:33217
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:33213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] → sending delta(kind=head bytes=1792) to S17@127.0.0.1:33217
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S5] → sending delta(kind=head bytes=1788) to S16@127.0.0.1:33216
[S11] sending update (kind=head size=1803 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1788 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1792 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1795) from S15
[S11] cosine check vs S15: cos=-0.0412
[S11] DROPPED delta from S15 (cos=-0.0412 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1799) from S6
[S11] cosine check vs S6: cos=0.0770
[S13] RECEIVED delta(kind=head bytes=1803) from S11
[S13] cosine check vs S11: cos=-0.0193
[S13] DROPPED delta from S11 (cos=-0.0193 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1792) from S9
[S17] cosine check vs S9: cos=0.0396
[S17] RECEIVED delta(kind=head bytes=1796) from S16
[S17] cosine check vs S16: cos=0.1608
[S17] RECEIVED delta(kind=head bytes=1795) from S8
[S17] cosine check vs S8: cos=0.0158
[S16] RECEIVED delta(kind=head bytes=1788) from S5
[S16] cosine check vs S5: cos=-0.0592
[S16] DROPPED delta from S5 (cos=-0.0592 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1801) from S7
[S14] cosine check vs S7: cos=0.0202
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:33203
[S17] sending update (kind=head size=1800 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1800) from S17
[S3] cosine check vs S17: cos=0.0968
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=3 metric=0.1404 head_norm=1.223490
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.482924e-01
[S14] stored merged vector for next round verification (round=3)
[S14] DEBUG after merge:  round=3 metric=0.1404 head_norm=0.762818 delta_norm=0.748292
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=3 metric=0.1398 head_norm=1.275701
[S3] _apply_head_vector_avg (torch): Δ‖w‖=8.754425e-01
[S3] stored merged vector for next round verification (round=3)
[S3] DEBUG after merge:  round=3 metric=0.1766 head_norm=0.964659 delta_norm=0.875443
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=3 metric=0.1404 head_norm=1.249619
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.826482e-01
[S11] stored merged vector for next round verification (round=3)
[S11] DEBUG after merge:  round=3 metric=0.1404 head_norm=0.953189 delta_norm=0.882648
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=3 metric=0.4172 head_norm=1.329105
[S17] _apply_head_vector_avg (torch): Δ‖w‖=7.030066e-01
[S17] stored merged vector for next round verification (round=3)
[S17] DEBUG after merge:  round=3 metric=0.3891 head_norm=0.779709 delta_norm=0.703007
[S17] aggregate: ROLLBACK (f1_val pre=0.417 post=0.389 tol_abs=0.005 tol_rel=0.0)
[S2] START round=4 head_norm_before_train=0.989437 cos_to_last_merge=0.9764 (last merge round=1)
[S2] round=4 local utility u=1.000000 metrics={'f1_val': 0.6938345288648702, 'auprc': 0.7763973635330687, 'loss_val': 0.8270321327086194, 'psi': 0.7268596627321495}-{'f1_val': 0.16727761485826, 'auprc': 0.7778888031172917, 'loss_val': 1.0640289168180312, 'psi': 0.4115220901618727}
[S3] START round=4 head_norm_before_train=0.964659 cos_to_last_merge=1.0000 (last merge round=3)
[S3] round=4 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8423545160817797, 'loss_val': 1.224641959404189, 'psi': 0.4208458458011761}-{'f1_val': 0.13984006561410703, 'auprc': 0.9988423666431634, 'loss_val': 1.2332083003533174, 'psi': 0.4834409860257296}
[S4] START round=4 head_norm_before_train=1.443573 (no previous merge yet)
[S4] round=4 local utility u=0.155814 metrics={'f1_val': 0.6889174715601776, 'auprc': 0.6600423513500935, 'loss_val': 0.494525236611405, 'psi': 0.677367423476144}-{'f1_val': 0.668427567222837, 'auprc': 0.6610491717332779, 'loss_val': 0.6862342386589876, 'psi': 0.6654762090270134}
[S5] START round=4 head_norm_before_train=1.267468 (no previous merge yet)
[S5] round=4 local utility u=0.059640 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7615439031596792, 'loss_val': 1.1806658425886496, 'psi': 0.3899747041210146}-{'f1_val': 0.14226190476190476, 'auprc': 0.7368651261118178, 'loss_val': 1.2259094513329907, 'psi': 0.38010319330187}
[S6] START round=4 head_norm_before_train=1.346746 (no previous merge yet)
[S6] round=4 local utility u=0.331186 metrics={'f1_val': 0.4168551858772006, 'auprc': 0.7954065072896146, 'loss_val': 0.8058484752299719, 'psi': 0.5682757144421662}-{'f1_val': 0.4164535851642239, 'auprc': 0.6612821948214214, 'loss_val': 1.0634385146851768, 'psi': 0.5143850290271028}
[S7] START round=4 head_norm_before_train=0.886982 cos_to_last_merge=0.9894 (last merge round=1)
[S7] round=4 local utility u=0.002786 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.774874824591771, 'loss_val': 1.2741691821221228, 'psi': 0.3951840234741634}-{'f1_val': 0.14205682272909165, 'auprc': 0.7771149472395353, 'loss_val': 1.2864612457861027, 'psi': 0.39608007253326916}
[S8] START round=4 head_norm_before_train=1.381388 (no previous merge yet)
[S8] round=4 local utility u=1.000000 metrics={'f1_val': 0.7140170479737811, 'auprc': 0.8424321826409681, 'loss_val': 0.7786934704754317, 'psi': 0.7653831018406558}-{'f1_val': 0.4162109668030748, 'auprc': 0.7693287634546875, 'loss_val': 0.9660046822445143, 'psi': 0.5574580854637199}
[S9] START round=4 head_norm_before_train=1.172274 (no previous merge yet)
[S9] round=4 local utility u=0.302220 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9795868396754657, 'loss_val': 1.1629118121692135, 'psi': 0.4766735101541839}-{'f1_val': 0.141397957139996, 'auprc': 0.7999675792056099, 'loss_val': 1.228495002072712, 'psi': 0.40482580596624157}
[S10] START round=4 head_norm_before_train=0.807946 cos_to_last_merge=0.9933 (last merge round=2)
[S10] round=4 local utility u=0.128591 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6555777713527731, 'loss_val': 1.1373161796167492, 'psi': 0.3454040910661436}-{'f1_val': 0.13862163754172394, 'auprc': 0.6030237623064977, 'loss_val': 1.2368357992089432, 'psi': 0.3243824874476334}
[S11] START round=4 head_norm_before_train=0.953189 cos_to_last_merge=1.0000 (last merge round=3)
[S11] round=4 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.6888698332605512, 'loss_val': 1.2320496487567858, 'psi': 0.35979614332808685}-{'f1_val': 0.14041368337311058, 'auprc': 0.8937216752481606, 'loss_val': 1.226868710190229, 'psi': 0.4417368801231306}
[S13] START round=4 head_norm_before_train=1.284741 (no previous merge yet)
[S13] round=4 local utility u=1.000000 metrics={'f1_val': 0.6592798254656965, 'auprc': 0.7226226272976274, 'loss_val': 0.7835169374481518, 'psi': 0.6846169461984688}-{'f1_val': 0.3718686783021842, 'auprc': 0.5662208541180165, 'loss_val': 0.9887622400363016, 'psi': 0.4496095486285171}
[S14] START round=4 head_norm_before_train=0.762818 cos_to_last_merge=1.0000 (last merge round=3)
[S14] round=4 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8104372116320602, 'loss_val': 1.2677738102903, 'psi': 0.4083895963824463}-{'f1_val': 0.14035785288270378, 'auprc': 0.8565788821342891, 'loss_val': 1.2687705783715273, 'psi': 0.4268462645833379}
[S15] START round=4 head_norm_before_train=1.299511 (no previous merge yet)
[S15] round=4 local utility u=0.022666 metrics={'f1_val': 0.4068644533132581, 'auprc': 0.7378722380316814, 'loss_val': 0.7747364866615861, 'psi': 0.5392675672006274}-{'f1_val': 0.4169508412658852, 'auprc': 0.7856769099218539, 'loss_val': 1.0240010653780232, 'psi': 0.5644412687282727}
[S16] START round=4 head_norm_before_train=0.946068 cos_to_last_merge=0.9973 (last merge round=2)
[S16] round=4 local utility u=0.023200 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.9977241455343391, 'loss_val': 1.243605933313574, 'psi': 0.4834721283332576}-{'f1_val': 0.14063745019920318, 'auprc': 0.9997543026570954, 'loss_val': 1.296096963427207, 'psi': 0.4842841911823601}
[S17] START round=4 head_norm_before_train=0.779709 cos_to_last_merge=1.0000 (last merge round=3)
[S17] round=4 local utility u=0.339948 metrics={'f1_val': 0.3896797811616246, 'auprc': 0.8434473528082511, 'loss_val': 0.8288380489926201, 'psi': 0.5711868098202753}-{'f1_val': 0.4172163973850558, 'auprc': 0.6024544803340512, 'loss_val': 0.9509743764319692, 'psi': 0.491311630564654}
[S5] not sending this round → trigger blocked (psi=0.390)
[S16] not sending this round → trigger blocked (psi=0.483)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.765)
[S6] not sending this round → trigger blocked (psi=0.568)
[S9] not sending this round → trigger blocked (psi=0.477)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:33213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:33203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:33211
[S7] not sending this round → trigger blocked (psi=0.395)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.539)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S13] → sending delta(kind=head bytes=1807) to S4@127.0.0.1:33204
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1807 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1794 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1794) from S10
[S3] cosine check vs S10: cos=0.1083
[S10] RECEIVED delta(kind=head bytes=1799) from S4
[S10] cosine check vs S4: cos=0.0338
[S13] RECEIVED delta(kind=head bytes=1797) from S2
[S13] cosine check vs S2: cos=0.0084
[S4] RECEIVED delta(kind=head bytes=1807) from S13
[S4] cosine check vs S13: cos=0.0667
[S17] not sending this round → trigger blocked (psi=0.571)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=4 metric=0.1398 head_norm=0.991966
[S3] _apply_head_vector_avg (torch): Δ‖w‖=6.152998e-01
[S3] stored merged vector for next round verification (round=4)
[S3] DEBUG after merge:  round=4 metric=0.1398 head_norm=0.684998 delta_norm=0.615300
[S3] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=4 metric=0.1386 head_norm=0.843585
[S10] _apply_head_vector_avg (torch): Δ‖w‖=8.662478e-01
[S10] stored merged vector for next round verification (round=4)
[S10] DEBUG after merge:  round=4 metric=0.1386 head_norm=0.891262 delta_norm=0.866248
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=4 metric=0.6889 head_norm=1.542022
[S4] _apply_head_vector_avg (torch): Δ‖w‖=9.917203e-01
[S4] stored merged vector for next round verification (round=4)
[S4] DEBUG after merge:  round=4 metric=0.6887 head_norm=1.059585 delta_norm=0.991720
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=4 metric=0.6593 head_norm=1.354484
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.570742e-01
[S13] stored merged vector for next round verification (round=4)
[S13] DEBUG after merge:  round=4 metric=0.4160 head_norm=0.864084 delta_norm=0.857074
[S13] aggregate: ROLLBACK (f1_val pre=0.659 post=0.416 tol_abs=0.005 tol_rel=0.0)
[S2] START round=5 head_norm_before_train=1.061983 cos_to_last_merge=0.9530 (last merge round=1)
[S2] round=5 local utility u=0.000000 metrics={'f1_val': 0.6997192205205487, 'auprc': 0.6456841770175923, 'loss_val': 0.6746584629685268, 'psi': 0.6781052031193662}-{'f1_val': 0.6938345288648702, 'auprc': 0.7763973635330687, 'loss_val': 0.8270321327086194, 'psi': 0.7268596627321495}
[S3] START round=5 head_norm_before_train=0.684998 cos_to_last_merge=1.0000 (last merge round=4)
[S3] round=5 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.5975236159877556, 'loss_val': 1.2018920590529847, 'psi': 0.3229134857635665}-{'f1_val': 0.13984006561410703, 'auprc': 0.8423545160817797, 'loss_val': 1.224641959404189, 'psi': 0.4208458458011761}
[S4] START round=5 head_norm_before_train=1.059585 cos_to_last_merge=1.0000 (last merge round=4)
[S4] round=5 local utility u=0.003419 metrics={'f1_val': 0.6869113777806337, 'auprc': 0.663638703711545, 'loss_val': 0.48643915535135307, 'psi': 0.6776023081529983}-{'f1_val': 0.6889174715601776, 'auprc': 0.6600423513500935, 'loss_val': 0.494525236611405, 'psi': 0.677367423476144}
[S5] START round=5 head_norm_before_train=1.295516 (no previous merge yet)
[S5] round=5 local utility u=0.872353 metrics={'f1_val': 0.41654174186412063, 'auprc': 0.7701108571635046, 'loss_val': 1.107339224508917, 'psi': 0.5579693879838742}-{'f1_val': 0.14226190476190476, 'auprc': 0.7615439031596792, 'loss_val': 1.1806658425886496, 'psi': 0.3899747041210146}
[S6] START round=5 head_norm_before_train=1.416093 (no previous merge yet)
[S6] round=5 local utility u=1.000000 metrics={'f1_val': 0.7109816062615393, 'auprc': 0.8001814086431804, 'loss_val': 0.5803456144902959, 'psi': 0.7466615272141958}-{'f1_val': 0.4168551858772006, 'auprc': 0.7954065072896146, 'loss_val': 0.8058484752299719, 'psi': 0.5682757144421662}
[S7] START round=5 head_norm_before_train=0.898197 cos_to_last_merge=0.9842 (last merge round=1)
[S7] round=5 local utility u=0.009004 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.77585449220885, 'loss_val': 1.2591001766213759, 'psi': 0.395575890520995}-{'f1_val': 0.14205682272909165, 'auprc': 0.774874824591771, 'loss_val': 1.2741691821221228, 'psi': 0.3951840234741634}
[S8] START round=5 head_norm_before_train=1.449135 (no previous merge yet)
[S8] round=5 local utility u=0.123183 metrics={'f1_val': 0.6693461142741357, 'auprc': 0.9801092500721478, 'loss_val': 0.6773326104836844, 'psi': 0.7936513685933406}-{'f1_val': 0.7140170479737811, 'auprc': 0.8424321826409681, 'loss_val': 0.7786934704754317, 'psi': 0.7653831018406558}
[S9] START round=5 head_norm_before_train=1.204764 (no previous merge yet)
[S9] round=5 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.914087427544803, 'loss_val': 1.0505622894192048, 'psi': 0.4504737453019188}-{'f1_val': 0.141397957139996, 'auprc': 0.9795868396754657, 'loss_val': 1.1629118121692135, 'psi': 0.4766735101541839}
[S10] START round=5 head_norm_before_train=0.891262 cos_to_last_merge=1.0000 (last merge round=4)
[S10] round=5 local utility u=0.864905 metrics={'f1_val': 0.41678903473405027, 'auprc': 0.6204218390698594, 'loss_val': 0.9710435674474142, 'psi': 0.4982421564683739}-{'f1_val': 0.13862163754172394, 'auprc': 0.6555777713527731, 'loss_val': 1.1373161796167492, 'psi': 0.3454040910661436}
[S11] START round=5 head_norm_before_train=0.978529 cos_to_last_merge=0.9973 (last merge round=3)
[S11] round=5 local utility u=0.128900 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7460535617319074, 'loss_val': 1.1458005921280996, 'psi': 0.3826696347166293}-{'f1_val': 0.14041368337311058, 'auprc': 0.6888698332605512, 'loss_val': 1.2320496487567858, 'psi': 0.35979614332808685}
[S13] START round=5 head_norm_before_train=0.864084 cos_to_last_merge=1.0000 (last merge round=4)
[S13] round=5 local utility u=0.150135 metrics={'f1_val': 0.7111349572723155, 'auprc': 0.721083737991076, 'loss_val': 0.7897613529156919, 'psi': 0.7151144695598197}-{'f1_val': 0.6592798254656965, 'auprc': 0.7226226272976274, 'loss_val': 0.7835169374481518, 'psi': 0.6846169461984688}
[S14] START round=5 head_norm_before_train=0.800616 cos_to_last_merge=0.9971 (last merge round=3)
[S14] round=5 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7807914016513418, 'loss_val': 1.2076396572982437, 'psi': 0.39653127239015895}-{'f1_val': 0.14035785288270378, 'auprc': 0.8104372116320602, 'loss_val': 1.2677738102903, 'psi': 0.4083895963824463}
[S15] START round=5 head_norm_before_train=1.364899 (no previous merge yet)
[S15] round=5 local utility u=0.210344 metrics={'f1_val': 0.4482224799684137, 'auprc': 0.7538551404183815, 'loss_val': 0.6501460033637615, 'psi': 0.5704755441484008}-{'f1_val': 0.4068644533132581, 'auprc': 0.7378722380316814, 'loss_val': 0.7747364866615861, 'psi': 0.5392675672006274}
[S16] START round=5 head_norm_before_train=0.979090 cos_to_last_merge=0.9895 (last merge round=2)
[S16] round=5 local utility u=0.020047 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.9962968548727704, 'loss_val': 1.1992294547340134, 'psi': 0.4829012120686301}-{'f1_val': 0.14063745019920318, 'auprc': 0.9977241455343391, 'loss_val': 1.243605933313574, 'psi': 0.4834721283332576}
[S17] START round=5 head_norm_before_train=0.875404 cos_to_last_merge=0.9882 (last merge round=3)
[S17] round=5 local utility u=0.039532 metrics={'f1_val': 0.36970475331367425, 'auprc': 0.9249905365017674, 'loss_val': 0.8745526822400514, 'psi': 0.5918190665889115}-{'f1_val': 0.3896797811616246, 'auprc': 0.8434473528082511, 'loss_val': 0.8288380489926201, 'psi': 0.5711868098202753}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S11] → sending delta(kind=head bytes=1788) to S13@127.0.0.1:33213
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.678)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S5] → sending delta(kind=head bytes=1791) to S16@127.0.0.1:33216
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:33212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:33217
[S10] not sending this round → trigger blocked (psi=0.498)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:33212
[S13] not sending this round → trigger blocked (psi=0.715)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:33214
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:33217
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1791 to 1 peers)
[S11] sending update (kind=head size=1788 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1795) from S8
[S17] cosine check vs S8: cos=0.1793
[S14] RECEIVED delta(kind=head bytes=1798) from S7
[S14] cosine check vs S7: cos=0.5571
[S16] RECEIVED delta(kind=head bytes=1791) from S5
[S16] cosine check vs S5: cos=-0.0397
[S16] DROPPED delta from S5 (cos=-0.0397 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1801) from S16
[S17] cosine check vs S16: cos=0.3738
[S13] RECEIVED delta(kind=head bytes=1788) from S11
[S13] cosine check vs S11: cos=0.0385
[S11] RECEIVED delta(kind=head bytes=1799) from S15
[S11] cosine check vs S15: cos=0.0047
[S11] RECEIVED delta(kind=head bytes=1802) from S6
[S11] cosine check vs S6: cos=0.6999
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:33203
[S17] sending update (kind=head size=1794 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1794) from S17
[S3] cosine check vs S17: cos=0.5546
[S10] ⇄ pheromone p=0.555 → S3@127.0.0.1:33203
[S9] ⇄ pheromone p=0.426 → S17@127.0.0.1:33217
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=5 metric=0.1398 head_norm=0.717983
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.129288e-01
[S3] stored merged vector for next round verification (round=5)
[S3] DEBUG after merge:  round=5 metric=0.1398 head_norm=0.745687 delta_norm=0.412929
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.410 → S9@127.0.0.1:33210
[S4] ⇄ pheromone p=0.514 → S10@127.0.0.1:33211
[S2] ⇄ pheromone p=0.540 → S13@127.0.0.1:33213
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=5 metric=0.7111 head_norm=0.934915
[S13] _apply_head_vector_avg (torch): Δ‖w‖=6.760085e-01
[S13] stored merged vector for next round verification (round=5)
[S13] DEBUG after merge:  round=5 metric=0.6683 head_norm=0.702455 delta_norm=0.676008
[S13] aggregate: ROLLBACK (f1_val pre=0.711 post=0.668 tol_abs=0.005 tol_rel=0.0)
[S13] ⇄ pheromone p=0.621 → S4@127.0.0.1:33204
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=5 metric=0.1404 head_norm=0.843712
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.140516e-01
[S14] stored merged vector for next round verification (round=5)
[S14] DEBUG after merge:  round=5 metric=0.1404 head_norm=0.774501 delta_norm=0.414052
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.335 → S15@127.0.0.1:33215
[S6] ⇄ pheromone p=0.678 → S11@127.0.0.1:33212
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=5 metric=0.1404 head_norm=1.013309
[S11] _apply_head_vector_avg (torch): Δ‖w‖=5.173130e-01
[S11] stored merged vector for next round verification (round=5)
[S11] DEBUG after merge:  round=5 metric=0.1404 head_norm=0.892670 delta_norm=0.517313
[S11] aggregate: ACCEPT kept=['S15', 'S6'] (k=2/2) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.399 → S13@127.0.0.1:33213
[S8] ⇄ pheromone p=0.587 → S17@127.0.0.1:33217
[S16] ⇄ pheromone p=0.389 → S17@127.0.0.1:33217
[S15] ⇄ pheromone p=0.499 → S11@127.0.0.1:33212
[S7] ⇄ pheromone p=0.335 → S14@127.0.0.1:33214
[S5] ⇄ pheromone p=0.531 → S16@127.0.0.1:33216
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=5 metric=0.3697 head_norm=0.968307
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.306902e-01
[S17] stored merged vector for next round verification (round=5)
[S17] DEBUG after merge:  round=5 metric=0.3529 head_norm=0.772735 delta_norm=0.530690
[S17] aggregate: ROLLBACK (f1_val pre=0.370 post=0.353 tol_abs=0.005 tol_rel=0.0)
[S17] ⇄ pheromone p=0.517 → S3@127.0.0.1:33203
[S2] START round=6 head_norm_before_train=1.138902 cos_to_last_merge=0.9289 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.929
[S2] round=6 local utility u=0.059176 metrics={'f1_val': 0.7010364462786205, 'auprc': 0.6493596712553894, 'loss_val': 0.5752370593568139, 'psi': 0.6803657362693281}-{'f1_val': 0.6997192205205487, 'auprc': 0.6456841770175923, 'loss_val': 0.6746584629685268, 'psi': 0.6781052031193662}
[S3] START round=6 head_norm_before_train=0.745687 cos_to_last_merge=1.0000 (last merge round=5)
[S3] round=6 local utility u=0.035510 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.5980465865344489, 'loss_val': 1.132440215081684, 'psi': 0.3231226739822438}-{'f1_val': 0.13984006561410703, 'auprc': 0.5975236159877556, 'loss_val': 1.2018920590529847, 'psi': 0.3229134857635665}
[S4] START round=6 head_norm_before_train=1.170378 cos_to_last_merge=0.9933 (last merge round=4)
[S4] round=6 local utility u=0.162978 metrics={'f1_val': 0.6661431937186301, 'auprc': 0.8153831851816069, 'loss_val': 0.4911075815433698, 'psi': 0.7258391903038208}-{'f1_val': 0.6869113777806337, 'auprc': 0.663638703711545, 'loss_val': 0.48643915535135307, 'psi': 0.6776023081529983}
[S5] START round=6 head_norm_before_train=1.317898 (no previous merge yet)
[S5] round=6 local utility u=0.041430 metrics={'f1_val': 0.41803043574602833, 'auprc': 0.7716739699661308, 'loss_val': 1.0380997801907867, 'psi': 0.5594878494340694}-{'f1_val': 0.41654174186412063, 'auprc': 0.7701108571635046, 'loss_val': 1.107339224508917, 'psi': 0.5579693879838742}
[S6] START round=6 head_norm_before_train=1.482816 (no previous merge yet)
[S6] round=6 local utility u=0.047038 metrics={'f1_val': 0.7087591444839088, 'auprc': 0.7882127375948498, 'loss_val': 0.4370293524762634, 'psi': 0.7405405817282852}-{'f1_val': 0.7109816062615393, 'auprc': 0.8001814086431804, 'loss_val': 0.5803456144902959, 'psi': 0.7466615272141958}
[S7] START round=6 head_norm_before_train=0.911445 cos_to_last_merge=0.9784 (last merge round=1)
[S7] round=6 local utility u=0.016869 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7777716990982724, 'loss_val': 1.2311138764350664, 'psi': 0.396342773276764}-{'f1_val': 0.14205682272909165, 'auprc': 0.77585449220885, 'loss_val': 1.2591001766213759, 'psi': 0.395575890520995}
[S8] START round=6 head_norm_before_train=1.517156 (no previous merge yet)
[S8] round=6 local utility u=0.000000 metrics={'f1_val': 0.7138869500399027, 'auprc': 0.8151632054259699, 'loss_val': 0.49733648995346336, 'psi': 0.7543974521943295}-{'f1_val': 0.6693461142741357, 'auprc': 0.9801092500721478, 'loss_val': 0.6773326104836844, 'psi': 0.7936513685933406}
[S9] START round=6 head_norm_before_train=1.237992 (no previous merge yet)
[S9] round=6 local utility u=1.000000 metrics={'f1_val': 0.4858314719908875, 'auprc': 0.8700710368429859, 'loss_val': 0.8634065063804262, 'psi': 0.6395272979317268}-{'f1_val': 0.141397957139996, 'auprc': 0.914087427544803, 'loss_val': 1.0505622894192048, 'psi': 0.4504737453019188}
[S10] START round=6 head_norm_before_train=0.937162 cos_to_last_merge=0.9918 (last merge round=4)
[S10] round=6 local utility u=0.429446 metrics={'f1_val': 0.43694924022297066, 'auprc': 0.8155780170090263, 'loss_val': 0.8185808133258634, 'psi': 0.588400750937393}-{'f1_val': 0.41678903473405027, 'auprc': 0.6204218390698594, 'loss_val': 0.9710435674474142, 'psi': 0.4982421564683739}
[S11] START round=6 head_norm_before_train=0.892670 cos_to_last_merge=1.0000 (last merge round=5)
[S11] round=6 local utility u=0.652181 metrics={'f1_val': 0.4223876636418746, 'auprc': 0.5983937852383941, 'loss_val': 1.0903025528077053, 'psi': 0.4927901122804824}-{'f1_val': 0.14041368337311058, 'auprc': 0.7460535617319074, 'loss_val': 1.1458005921280996, 'psi': 0.3826696347166293}
[S13] START round=6 head_norm_before_train=0.702455 cos_to_last_merge=1.0000 (last merge round=5)
[S13] round=6 local utility u=0.005189 metrics={'f1_val': 0.7125251305599015, 'auprc': 0.7147799070956544, 'loss_val': 0.7688120565688483, 'psi': 0.7134270411742026}-{'f1_val': 0.7111349572723155, 'auprc': 0.721083737991076, 'loss_val': 0.7897613529156919, 'psi': 0.7151144695598197}
[S14] START round=6 head_norm_before_train=0.774501 cos_to_last_merge=1.0000 (last merge round=5)
[S14] round=6 local utility u=0.000000 metrics={'f1_val': 0.16664154345891083, 'auprc': 0.6787552185000661, 'loss_val': 1.1576924930201455, 'psi': 0.37148701347537294}-{'f1_val': 0.14035785288270378, 'auprc': 0.7807914016513418, 'loss_val': 1.2076396572982437, 'psi': 0.39653127239015895}
[S15] START round=6 head_norm_before_train=1.443582 (no previous merge yet)
[S15] round=6 local utility u=0.978011 metrics={'f1_val': 0.689711378771331, 'auprc': 0.8632987587084581, 'loss_val': 0.471387305831736, 'psi': 0.7591463307461819}-{'f1_val': 0.4482224799684137, 'auprc': 0.7538551404183815, 'loss_val': 0.6501460033637615, 'psi': 0.5704755441484008}
[S16] START round=6 head_norm_before_train=1.015513 cos_to_last_merge=0.9794 (last merge round=2)
[S16] round=6 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.9449731601284204, 'loss_val': 1.1173977562714252, 'psi': 0.46237173417089006}-{'f1_val': 0.14063745019920318, 'auprc': 0.9962968548727704, 'loss_val': 1.1992294547340134, 'psi': 0.4829012120686301}
[S17] START round=6 head_norm_before_train=0.772735 cos_to_last_merge=1.0000 (last merge round=5)
[S17] round=6 local utility u=0.000000 metrics={'f1_val': 0.35199388000949794, 'auprc': 0.8657768936800334, 'loss_val': 0.9080689511633894, 'psi': 0.5575070854777122}-{'f1_val': 0.36970475331367425, 'auprc': 0.9249905365017674, 'loss_val': 0.8745526822400514, 'psi': 0.5918190665889115}
[S7] not sending this round → trigger blocked (psi=0.396)
[S11] not sending this round → trigger blocked (psi=0.493)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:33203
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.759)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:33213
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.559)
[S6] not sending this round → trigger blocked (psi=0.741)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:33211
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:33204
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] → sending delta(kind=head bytes=1792) to S17@127.0.0.1:33217
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:33210
[S9] sending update (kind=head size=1792 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1800) from S2
[S13] cosine check vs S2: cos=0.3726
[S17] RECEIVED delta(kind=head bytes=1792) from S9
[S17] cosine check vs S9: cos=0.1261
[S9] RECEIVED delta(kind=head bytes=1796) from S3
[S9] cosine check vs S3: cos=0.1685
[S4] RECEIVED delta(kind=head bytes=1800) from S13
[S4] cosine check vs S13: cos=0.4061
[S10] RECEIVED delta(kind=head bytes=1800) from S4
[S10] cosine check vs S4: cos=0.6351
[S3] RECEIVED delta(kind=head bytes=1799) from S10
[S3] cosine check vs S10: cos=0.4623
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=6 metric=0.1398 head_norm=0.773294
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.735213e-01
[S3] stored merged vector for next round verification (round=6)
[S3] DEBUG after merge:  round=6 metric=0.1398 head_norm=0.765242 delta_norm=0.473521
[S3] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=6 metric=0.7125 head_norm=0.782217
[S13] _apply_head_vector_avg (torch): Δ‖w‖=5.864920e-01
[S13] stored merged vector for next round verification (round=6)
[S13] DEBUG after merge:  round=6 metric=0.6766 head_norm=0.835147 delta_norm=0.586492
[S13] aggregate: ROLLBACK (f1_val pre=0.713 post=0.677 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=6 metric=0.4858 head_norm=1.274877
[S9] _apply_head_vector_avg (torch): Δ‖w‖=6.875897e-01
[S9] stored merged vector for next round verification (round=6)
[S9] DEBUG after merge:  round=6 metric=0.6912 head_norm=0.799292 delta_norm=0.687590
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=6 metric=0.4369 head_norm=1.010769
[S10] _apply_head_vector_avg (torch): Δ‖w‖=5.026299e-01
[S10] stored merged vector for next round verification (round=6)
[S10] DEBUG after merge:  round=6 metric=0.4369 head_norm=1.034953 delta_norm=0.502630
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=6 metric=0.6661 head_norm=1.275098
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.974074e-01
[S4] stored merged vector for next round verification (round=6)
[S4] DEBUG after merge:  round=6 metric=0.6657 head_norm=0.872911 delta_norm=0.597407
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=6 metric=0.3520 head_norm=0.857027
[S17] _apply_head_vector_avg (torch): Δ‖w‖=7.218424e-01
[S17] stored merged vector for next round verification (round=6)
[S17] DEBUG after merge:  round=6 metric=0.3521 head_norm=0.811693 delta_norm=0.721842
[S17] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=7 head_norm_before_train=1.212858 cos_to_last_merge=0.9080 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.908
[S2] round=7 local utility u=0.062292 metrics={'f1_val': 0.7013141837391442, 'auprc': 0.6523397851178921, 'loss_val': 0.4612604792341093, 'psi': 0.6817244242906434}-{'f1_val': 0.7010364462786205, 'auprc': 0.6493596712553894, 'loss_val': 0.5752370593568139, 'psi': 0.6803657362693281}
[S3] START round=7 head_norm_before_train=0.765242 cos_to_last_merge=1.0000 (last merge round=6)
[S3] round=7 local utility u=1.000000 metrics={'f1_val': 0.39635856801559805, 'auprc': 0.7961483324455626, 'loss_val': 1.0200511345282217, 'psi': 0.5562744737875839}-{'f1_val': 0.13984006561410703, 'auprc': 0.5980465865344489, 'loss_val': 1.132440215081684, 'psi': 0.3231226739822438}
[S4] START round=7 head_norm_before_train=0.872911 cos_to_last_merge=1.0000 (last merge round=6)
[S4] round=7 local utility u=0.168090 metrics={'f1_val': 0.6659596784751727, 'auprc': 0.9393491029074871, 'loss_val': 0.5257250409599581, 'psi': 0.7753154482480984}-{'f1_val': 0.6661431937186301, 'auprc': 0.8153831851816069, 'loss_val': 0.4911075815433698, 'psi': 0.7258391903038208}
[S5] START round=7 head_norm_before_train=1.338426 (no previous merge yet)
[S5] round=7 local utility u=0.086388 metrics={'f1_val': 0.41770847824441854, 'auprc': 0.7778299440335498, 'loss_val': 0.8818603838341417, 'psi': 0.561757064560071}-{'f1_val': 0.41803043574602833, 'auprc': 0.7716739699661308, 'loss_val': 1.0380997801907867, 'psi': 0.5594878494340694}
[S6] START round=7 head_norm_before_train=1.540513 (no previous merge yet)
[S6] round=7 local utility u=0.000000 metrics={'f1_val': 0.705379262243872, 'auprc': 0.7894184202936798, 'loss_val': 0.5385617975508182, 'psi': 0.7389949254637952}-{'f1_val': 0.7087591444839088, 'auprc': 0.7882127375948498, 'loss_val': 0.4370293524762634, 'psi': 0.7405405817282852}
[S7] START round=7 head_norm_before_train=0.929842 cos_to_last_merge=0.9717 (last merge round=1)
[S7] round=7 local utility u=0.019637 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7775724427277753, 'loss_val': 1.1912428990144484, 'psi': 0.3962630707285651}-{'f1_val': 0.14205682272909165, 'auprc': 0.7777716990982724, 'loss_val': 1.2311138764350664, 'psi': 0.396342773276764}
[S8] START round=7 head_norm_before_train=1.563915 (no previous merge yet)
[S8] round=7 local utility u=0.316165 metrics={'f1_val': 0.713360124866679, 'auprc': 0.9822116963965883, 'loss_val': 0.36299018886206186, 'psi': 0.8209007534786428}-{'f1_val': 0.7138869500399027, 'auprc': 0.8151632054259699, 'loss_val': 0.49733648995346336, 'psi': 0.7543974521943295}
[S9] START round=7 head_norm_before_train=0.799292 cos_to_last_merge=1.0000 (last merge round=6)
[S9] round=7 local utility u=0.162618 metrics={'f1_val': 0.5412741008623002, 'auprc': 0.8623966710678262, 'loss_val': 0.8478027632628394, 'psi': 0.6697231289445107}-{'f1_val': 0.4858314719908875, 'auprc': 0.8700710368429859, 'loss_val': 0.8634065063804262, 'psi': 0.6395272979317268}
[S10] START round=7 head_norm_before_train=1.034953 cos_to_last_merge=1.0000 (last merge round=6)
[S10] round=7 local utility u=1.000000 metrics={'f1_val': 0.6973139546888945, 'auprc': 0.8886591414497035, 'loss_val': 0.5872739254317574, 'psi': 0.7738520293932181}-{'f1_val': 0.43694924022297066, 'auprc': 0.8155780170090263, 'loss_val': 0.8185808133258634, 'psi': 0.588400750937393}
[S11] START round=7 head_norm_before_train=0.919396 cos_to_last_merge=0.9966 (last merge round=5)
[S11] round=7 local utility u=0.287342 metrics={'f1_val': 0.39651855440916606, 'auprc': 0.789269076639664, 'loss_val': 0.9330300238169906, 'psi': 0.5536187633013652}-{'f1_val': 0.4223876636418746, 'auprc': 0.5983937852383941, 'loss_val': 1.0903025528077053, 'psi': 0.4927901122804824}
[S13] START round=7 head_norm_before_train=0.835147 cos_to_last_merge=1.0000 (last merge round=6)
[S13] round=7 local utility u=0.000000 metrics={'f1_val': 0.6571765977577841, 'auprc': 0.7082762637430413, 'loss_val': 0.7469652061823095, 'psi': 0.677616464151887}-{'f1_val': 0.7125251305599015, 'auprc': 0.7147799070956544, 'loss_val': 0.7688120565688483, 'psi': 0.7134270411742026}
[S14] START round=7 head_norm_before_train=0.811336 cos_to_last_merge=0.9961 (last merge round=5)
[S14] round=7 local utility u=1.000000 metrics={'f1_val': 0.3964292957175209, 'auprc': 0.894216984329882, 'loss_val': 0.9828421816275376, 'psi': 0.5955443711624653}-{'f1_val': 0.16664154345891083, 'auprc': 0.6787552185000661, 'loss_val': 1.1576924930201455, 'psi': 0.37148701347537294}
[S15] START round=7 head_norm_before_train=1.525811 (no previous merge yet)
[S15] round=7 local utility u=0.112220 metrics={'f1_val': 0.6624420857884399, 'auprc': 0.9491722740690031, 'loss_val': 0.3409525925590092, 'psi': 0.7771341611006652}-{'f1_val': 0.689711378771331, 'auprc': 0.8632987587084581, 'loss_val': 0.471387305831736, 'psi': 0.7591463307461819}
[S16] START round=7 head_norm_before_train=1.045245 cos_to_last_merge=0.9711 (last merge round=2)
[S16] round=7 local utility u=0.474257 metrics={'f1_val': 0.4156626648174509, 'auprc': 0.6678352854390315, 'loss_val': 0.9876221740212909, 'psi': 0.5165317130660831}-{'f1_val': 0.14063745019920318, 'auprc': 0.9449731601284204, 'loss_val': 1.1173977562714252, 'psi': 0.46237173417089006}
[S17] START round=7 head_norm_before_train=0.811693 cos_to_last_merge=1.0000 (last merge round=6)
[S17] round=7 local utility u=0.000000 metrics={'f1_val': 0.3534730578482862, 'auprc': 0.8373533499811279, 'loss_val': 0.9103625852403749, 'psi': 0.5470251747014229}-{'f1_val': 0.35199388000949794, 'auprc': 0.8657768936800334, 'loss_val': 0.9080689511633894, 'psi': 0.5575070854777122}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:33213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:33217
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S11@127.0.0.1:33212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S14] → sending delta(kind=head bytes=1790) to S15@127.0.0.1:33215
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S16@127.0.0.1:33216
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:33213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:33210
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:33203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] → sending delta(kind=head bytes=1794) to S17@127.0.0.1:33217
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:33214
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:33217
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S10@127.0.0.1:33211
[S4] sending update (kind=head size=1794 to 1 peers)
[S16] sending update (kind=head size=1804 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1794 to 1 peers)
[S10] sending update (kind=head size=1794 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S2] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1790 to 1 peers)
[S15] sending update (kind=head size=1804 to 1 peers)
[S5] sending update (kind=head size=1794 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1804) from S15
[S11] cosine check vs S15: cos=0.3975
[S13] RECEIVED delta(kind=head bytes=1796) from S2
[S13] cosine check vs S2: cos=0.8360
[S13] RECEIVED delta(kind=head bytes=1797) from S11
[S13] cosine check vs S11: cos=0.3010
[S17] RECEIVED delta(kind=head bytes=1804) from S16
[S17] cosine check vs S16: cos=0.3452
[S17] RECEIVED delta(kind=head bytes=1794) from S9
[S17] cosine check vs S9: cos=0.9114
[S17] RECEIVED delta(kind=head bytes=1803) from S8
[S17] cosine check vs S8: cos=0.2024
[S16] RECEIVED delta(kind=head bytes=1794) from S5
[S16] cosine check vs S5: cos=-0.0395
[S16] DROPPED delta from S5 (cos=-0.0395 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1796) from S3
[S9] cosine check vs S3: cos=0.4395
[S14] RECEIVED delta(kind=head bytes=1797) from S7
[S14] cosine check vs S7: cos=0.8293
[S15] RECEIVED delta(kind=head bytes=1790) from S14
[S15] cosine check vs S14: cos=0.0377
[S3] RECEIVED delta(kind=head bytes=1794) from S10
[S3] cosine check vs S10: cos=0.7775
[S10] RECEIVED delta(kind=head bytes=1794) from S4
[S10] cosine check vs S4: cos=0.7945
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=7 metric=0.6572 head_norm=0.903649
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.501892e-01
[S13] stored merged vector for next round verification (round=7)
[S13] DEBUG after merge:  round=7 metric=0.6286 head_norm=0.820867 delta_norm=0.250189
[S13] aggregate: ROLLBACK (f1_val pre=0.657 post=0.629 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=7 metric=0.5413 head_norm=0.850869
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.371520e-01
[S9] stored merged vector for next round verification (round=7)
[S9] DEBUG after merge:  round=7 metric=0.5603 head_norm=0.699816 delta_norm=0.437152
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=7 metric=0.3964 head_norm=0.858056
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.684484e-01
[S14] stored merged vector for next round verification (round=7)
[S14] DEBUG after merge:  round=7 metric=0.3965 head_norm=0.866216 delta_norm=0.268448
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=7 metric=0.6973 head_norm=1.107667
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.394002e-01
[S10] stored merged vector for next round verification (round=7)
[S10] DEBUG after merge:  round=7 metric=0.6895 head_norm=0.984653 delta_norm=0.339400
[S10] aggregate: ROLLBACK (f1_val pre=0.697 post=0.689 tol_abs=0.005 tol_rel=0.0)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=7 metric=0.3964 head_norm=0.798568
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.497286e-01
[S3] stored merged vector for next round verification (round=7)
[S3] DEBUG after merge:  round=7 metric=0.3971 head_norm=0.900005 delta_norm=0.349729
[S3] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=7 metric=0.3965 head_norm=0.958835
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.498967e-01
[S11] stored merged vector for next round verification (round=7)
[S11] DEBUG after merge:  round=7 metric=0.4149 head_norm=1.081953 delta_norm=0.749897
[S11] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=7 metric=0.6624 head_norm=1.595798
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.915585e-01
[S15] stored merged vector for next round verification (round=7)
[S15] DEBUG after merge:  round=7 metric=0.6790 head_norm=0.920076 delta_norm=0.891558
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=7 metric=0.3535 head_norm=0.887710
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.569596e-01
[S17] stored merged vector for next round verification (round=7)
[S17] DEBUG after merge:  round=7 metric=0.3535 head_norm=0.740986 delta_norm=0.256960
[S17] aggregate: ACCEPT kept=['S16', 'S9', 'S8'] (k=3/3) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=1.273036 cos_to_last_merge=0.8863 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.886
[S2] round=8 local utility u=0.168731 metrics={'f1_val': 0.7012347841865968, 'auprc': 0.732461619405384, 'loss_val': 0.363687832782853, 'psi': 0.7137255182741117}-{'f1_val': 0.7013141837391442, 'auprc': 0.6523397851178921, 'loss_val': 0.4612604792341093, 'psi': 0.6817244242906434}
[S3] START round=8 head_norm_before_train=0.900005 cos_to_last_merge=1.0000 (last merge round=7)
[S3] round=8 local utility u=0.960343 metrics={'f1_val': 0.6917150261369255, 'auprc': 0.7957307860903391, 'loss_val': 0.8702514060770876, 'psi': 0.7333213301182909}-{'f1_val': 0.39635856801559805, 'auprc': 0.7961483324455626, 'loss_val': 1.0200511345282217, 'psi': 0.5562744737875839}
[S4] START round=8 head_norm_before_train=0.970846 cos_to_last_merge=0.9934 (last merge round=6)
[S4] round=8 local utility u=0.860394 metrics={'f1_val': 0.9435990748392318, 'auprc': 0.9442765980342166, 'loss_val': 0.4855566166232156, 'psi': 0.9438700841172257}-{'f1_val': 0.6659596784751727, 'auprc': 0.9393491029074871, 'loss_val': 0.5257250409599581, 'psi': 0.7753154482480984}
[S5] START round=8 head_norm_before_train=1.374650 (no previous merge yet)
[S5] round=8 local utility u=0.085615 metrics={'f1_val': 0.41823357465624633, 'auprc': 0.7953685979487337, 'loss_val': 0.7663970110265074, 'psi': 0.5690875839732412}-{'f1_val': 0.41770847824441854, 'auprc': 0.7778299440335498, 'loss_val': 0.8818603838341417, 'psi': 0.561757064560071}
[S6] START round=8 head_norm_before_train=1.587406 (no previous merge yet)
[S6] round=8 local utility u=0.000000 metrics={'f1_val': 0.6676788815383383, 'auprc': 0.740675205469375, 'loss_val': 0.5454055192383, 'psi': 0.696877411110753}-{'f1_val': 0.705379262243872, 'auprc': 0.7894184202936798, 'loss_val': 0.5385617975508182, 'psi': 0.7389949254637952}
[S7] START round=8 head_norm_before_train=0.953168 cos_to_last_merge=0.9641 (last merge round=1)
[S7] round=8 local utility u=0.872075 metrics={'f1_val': 0.41606030461571797, 'auprc': 0.7771650189065169, 'loss_val': 1.0898922301545308, 'psi': 0.5605021903320375}-{'f1_val': 0.14205682272909165, 'auprc': 0.7775724427277753, 'loss_val': 1.1912428990144484, 'psi': 0.3962630707285651}
[S8] START round=8 head_norm_before_train=1.611005 (no previous merge yet)
[S8] round=8 local utility u=0.022559 metrics={'f1_val': 0.7139293602936292, 'auprc': 0.983841122013383, 'loss_val': 0.32617508277946256, 'psi': 0.8218940649815307}-{'f1_val': 0.713360124866679, 'auprc': 0.9822116963965883, 'loss_val': 0.36299018886206186, 'psi': 0.8209007534786428}
[S9] START round=8 head_norm_before_train=0.699816 cos_to_last_merge=1.0000 (last merge round=7)
[S9] round=8 local utility u=0.000000 metrics={'f1_val': 0.40253198729167655, 'auprc': 0.8356111608328219, 'loss_val': 0.839081731856078, 'psi': 0.5757636567081348}-{'f1_val': 0.5412741008623002, 'auprc': 0.8623966710678262, 'loss_val': 0.8478027632628394, 'psi': 0.6697231289445107}
[S10] START round=8 head_norm_before_train=0.984653 cos_to_last_merge=1.0000 (last merge round=7)
[S10] round=8 local utility u=0.114608 metrics={'f1_val': 0.6876309051880161, 'auprc': 0.94562110987543, 'loss_val': 0.4708461137192461, 'psi': 0.7908269870629816}-{'f1_val': 0.6973139546888945, 'auprc': 0.8886591414497035, 'loss_val': 0.5872739254317574, 'psi': 0.7738520293932181}
[S11] START round=8 head_norm_before_train=1.081953 cos_to_last_merge=1.0000 (last merge round=7)
[S11] round=8 local utility u=0.000000 metrics={'f1_val': 0.39655223592620625, 'auprc': 0.5462179739656859, 'loss_val': 0.8774284732485821, 'psi': 0.45641853114199815}-{'f1_val': 0.39651855440916606, 'auprc': 0.789269076639664, 'loss_val': 0.9330300238169906, 'psi': 0.5536187633013652}
[S13] START round=8 head_norm_before_train=0.820867 cos_to_last_merge=1.0000 (last merge round=7)
[S13] round=8 local utility u=0.000000 metrics={'f1_val': 0.6297100329585683, 'auprc': 0.6752384493593988, 'loss_val': 0.7124348524342164, 'psi': 0.6479213995189005}-{'f1_val': 0.6571765977577841, 'auprc': 0.7082762637430413, 'loss_val': 0.7469652061823095, 'psi': 0.677616464151887}
[S14] START round=8 head_norm_before_train=0.866216 cos_to_last_merge=1.0000 (last merge round=7)
[S14] round=8 local utility u=0.129056 metrics={'f1_val': 0.39592075487250195, 'auprc': 0.9469499020817215, 'loss_val': 0.8798777796945711, 'psi': 0.6163324137561897}-{'f1_val': 0.3964292957175209, 'auprc': 0.894216984329882, 'loss_val': 0.9828421816275376, 'psi': 0.5955443711624653}
[S15] START round=8 head_norm_before_train=0.920076 cos_to_last_merge=1.0000 (last merge round=7)
[S15] round=8 local utility u=0.090664 metrics={'f1_val': 0.6930438086427546, 'auprc': 0.9737136115887386, 'loss_val': 0.4168590066939656, 'psi': 0.8053117298211482}-{'f1_val': 0.6624420857884399, 'auprc': 0.9491722740690031, 'loss_val': 0.3409525925590092, 'psi': 0.7771341611006652}
[S16] START round=8 head_norm_before_train=1.077222 cos_to_last_merge=0.9621 (last merge round=2)
[S16] round=8 local utility u=0.343306 metrics={'f1_val': 0.3850031874099581, 'auprc': 0.9121127823662276, 'loss_val': 0.8498866560988809, 'psi': 0.5958470253924659}-{'f1_val': 0.4156626648174509, 'auprc': 0.6678352854390315, 'loss_val': 0.9876221740212909, 'psi': 0.5165317130660831}
[S17] START round=8 head_norm_before_train=0.740986 cos_to_last_merge=1.0000 (last merge round=7)
[S17] round=8 local utility u=0.034081 metrics={'f1_val': 0.3735834084536613, 'auprc': 0.813454972090025, 'loss_val': 0.8911676137398223, 'psi': 0.5495320339082068}-{'f1_val': 0.3534730578482862, 'auprc': 0.8373533499811279, 'loss_val': 0.9103625852403749, 'psi': 0.5470251747014229}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S16@127.0.0.1:33216
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:33211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:33212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S7] → sending delta(kind=head bytes=1789) to S14@127.0.0.1:33214
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:33217
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:33217
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:33203
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S3] → sending delta(kind=head bytes=1788) to S9@127.0.0.1:33210
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] → sending delta(kind=head bytes=1793) to S15@127.0.0.1:33215
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:33213
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1793 to 1 peers)
[S3] sending update (kind=head size=1788 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1789 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1794 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1799) from S2
[S13] cosine check vs S2: cos=0.7941
[S17] RECEIVED delta(kind=head bytes=1800) from S8
[S17] cosine check vs S8: cos=0.2859
[S17] RECEIVED delta(kind=head bytes=1802) from S16
[S17] cosine check vs S16: cos=0.4916
[S11] RECEIVED delta(kind=head bytes=1797) from S15
[S11] cosine check vs S15: cos=0.7943
[S16] RECEIVED delta(kind=head bytes=1794) from S5
[S16] cosine check vs S5: cos=-0.0389
[S16] DROPPED delta from S5 (cos=-0.0389 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1788) from S3
[S9] cosine check vs S3: cos=0.6796
[S14] RECEIVED delta(kind=head bytes=1789) from S7
[S14] cosine check vs S7: cos=0.9358
[S15] RECEIVED delta(kind=head bytes=1793) from S14
[S15] cosine check vs S14: cos=0.4578
[S10] RECEIVED delta(kind=head bytes=1797) from S4
[S10] cosine check vs S4: cos=0.9161
[S3] RECEIVED delta(kind=head bytes=1798) from S10
[S3] cosine check vs S10: cos=0.8871
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:33203
[S17] sending update (kind=head size=1798 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1798) from S17
[S3] cosine check vs S17: cos=0.4616
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=8 metric=0.6297 head_norm=0.901091
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.090585e-01
[S13] stored merged vector for next round verification (round=8)
[S13] DEBUG after merge:  round=8 metric=0.6337 head_norm=1.055565 delta_norm=0.409058
[S13] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=8 metric=0.3966 head_norm=1.112168
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.429098e-01
[S11] stored merged vector for next round verification (round=8)
[S11] DEBUG after merge:  round=8 metric=0.3966 head_norm=1.000872 delta_norm=0.342910
[S11] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=8 metric=0.4025 head_norm=0.755853
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.484493e-01
[S9] stored merged vector for next round verification (round=8)
[S9] DEBUG after merge:  round=8 metric=0.4025 head_norm=0.775987 delta_norm=0.348449
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=8 metric=0.6876 head_norm=1.074325
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.210257e-01
[S10] stored merged vector for next round verification (round=8)
[S10] DEBUG after merge:  round=8 metric=0.6869 head_norm=1.056177 delta_norm=0.221026
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=8 metric=0.3959 head_norm=0.905520
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.728122e-01
[S14] stored merged vector for next round verification (round=8)
[S14] DEBUG after merge:  round=8 metric=0.3949 head_norm=0.927605 delta_norm=0.172812
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=8 metric=0.6930 head_norm=1.000873
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.979542e-01
[S15] stored merged vector for next round verification (round=8)
[S15] DEBUG after merge:  round=8 metric=0.6946 head_norm=0.814186 delta_norm=0.497954
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=8 metric=0.6917 head_norm=0.935858
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.383672e-01
[S3] stored merged vector for next round verification (round=8)
[S3] DEBUG after merge:  round=8 metric=0.6996 head_norm=0.826359 delta_norm=0.238367
[S3] aggregate: ACCEPT kept=['S10', 'S17'] (k=2/2) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=8 metric=0.3736 head_norm=0.833767
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.502517e-01
[S17] stored merged vector for next round verification (round=8)
[S17] DEBUG after merge:  round=8 metric=0.3544 head_norm=0.793265 delta_norm=0.450252
[S17] aggregate: ROLLBACK (f1_val pre=0.374 post=0.354 tol_abs=0.005 tol_rel=0.0)
[S2] START round=9 head_norm_before_train=1.323303 cos_to_last_merge=0.8646 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.865
[S2] round=9 local utility u=0.000000 metrics={'f1_val': 0.7010542679632784, 'auprc': 0.6668470031427252, 'loss_val': 0.3090426449200471, 'psi': 0.6873713620350571}-{'f1_val': 0.7012347841865968, 'auprc': 0.732461619405384, 'loss_val': 0.363687832782853, 'psi': 0.7137255182741117}
[S3] START round=9 head_norm_before_train=0.826359 cos_to_last_merge=1.0000 (last merge round=8)
[S3] round=9 local utility u=0.000000 metrics={'f1_val': 0.4045316402820668, 'auprc': 0.694285539132314, 'loss_val': 0.8357466956498311, 'psi': 0.5204331998221656}-{'f1_val': 0.6917150261369255, 'auprc': 0.7957307860903391, 'loss_val': 0.8702514060770876, 'psi': 0.7333213301182909}
[S4] START round=9 head_norm_before_train=1.083767 cos_to_last_merge=0.9792 (last merge round=6)
[S4] round=9 local utility u=0.022794 metrics={'f1_val': 0.9447744278037439, 'auprc': 0.9478474057559465, 'loss_val': 0.45773415145335683, 'psi': 0.9460036189846249}-{'f1_val': 0.9435990748392318, 'auprc': 0.9442765980342166, 'loss_val': 0.4855566166232156, 'psi': 0.9438700841172257}
[S5] START round=9 head_norm_before_train=1.405040 (no previous merge yet)
[S5] round=9 local utility u=0.819965 metrics={'f1_val': 0.6791951446497904, 'auprc': 0.7953796430445568, 'loss_val': 0.6922696123403569, 'psi': 0.7256689440076969}-{'f1_val': 0.41823357465624633, 'auprc': 0.7953685979487337, 'loss_val': 0.7663970110265074, 'psi': 0.5690875839732412}
[S6] START round=9 head_norm_before_train=1.617993 (no previous merge yet)
[S6] round=9 local utility u=0.290066 metrics={'f1_val': 0.7073998828077243, 'auprc': 0.8006942098021268, 'loss_val': 0.38365696105341807, 'psi': 0.7447176136054854}-{'f1_val': 0.6676788815383383, 'auprc': 0.740675205469375, 'loss_val': 0.5454055192383, 'psi': 0.696877411110753}
[S7] START round=9 head_norm_before_train=0.980134 cos_to_last_merge=0.9558 (last merge round=1)
[S7] round=9 local utility u=0.000000 metrics={'f1_val': 0.4172807768329403, 'auprc': 0.72364574537684, 'loss_val': 0.9788289360726679, 'psi': 0.5398267642505001}-{'f1_val': 0.41606030461571797, 'auprc': 0.7771650189065169, 'loss_val': 1.0898922301545308, 'psi': 0.5605021903320375}
[S8] START round=9 head_norm_before_train=1.656675 (no previous merge yet)
[S8] round=9 local utility u=0.935830 metrics={'f1_val': 0.9947005233007624, 'auprc': 0.9878235586614886, 'loss_val': 0.15108837430874153, 'psi': 0.9919497374450529}-{'f1_val': 0.7139293602936292, 'auprc': 0.983841122013383, 'loss_val': 0.32617508277946256, 'psi': 0.8218940649815307}
[S9] START round=9 head_norm_before_train=0.775987 cos_to_last_merge=1.0000 (last merge round=8)
[S9] round=9 local utility u=0.005057 metrics={'f1_val': 0.40253198729167655, 'auprc': 0.8355382513441945, 'loss_val': 0.8287483228112287, 'psi': 0.5757344929126837}-{'f1_val': 0.40253198729167655, 'auprc': 0.8356111608328219, 'loss_val': 0.839081731856078, 'psi': 0.5757636567081348}
[S10] START round=9 head_norm_before_train=1.056177 cos_to_last_merge=1.0000 (last merge round=8)
[S10] round=9 local utility u=0.168571 metrics={'f1_val': 0.6987767787065788, 'auprc': 0.9936665332143007, 'loss_val': 0.3447148947916718, 'psi': 0.8167326805096675}-{'f1_val': 0.6876309051880161, 'auprc': 0.94562110987543, 'loss_val': 0.4708461137192461, 'psi': 0.7908269870629816}
[S11] START round=9 head_norm_before_train=1.000872 cos_to_last_merge=1.0000 (last merge round=8)
[S11] round=9 local utility u=0.299885 metrics={'f1_val': 0.39658602128368947, 'auprc': 0.7364686233980374, 'loss_val': 0.8486125272091016, 'psi': 0.5325390621294287}-{'f1_val': 0.39655223592620625, 'auprc': 0.5462179739656859, 'loss_val': 0.8774284732485821, 'psi': 0.45641853114199815}
[S13] START round=9 head_norm_before_train=1.055565 cos_to_last_merge=1.0000 (last merge round=8)
[S13] round=9 local utility u=0.000000 metrics={'f1_val': 0.6279481080025985, 'auprc': 0.657304018638243, 'loss_val': 0.7219922114678972, 'psi': 0.6396904722568563}-{'f1_val': 0.6297100329585683, 'auprc': 0.6752384493593988, 'loss_val': 0.7124348524342164, 'psi': 0.6479213995189005}
[S14] START round=9 head_norm_before_train=0.927605 cos_to_last_merge=1.0000 (last merge round=8)
[S14] round=9 local utility u=0.142063 metrics={'f1_val': 0.4038407369585293, 'auprc': 0.997366153626052, 'loss_val': 0.7945208945682045, 'psi': 0.6412509036255384}-{'f1_val': 0.39592075487250195, 'auprc': 0.9469499020817215, 'loss_val': 0.8798777796945711, 'psi': 0.6163324137561897}
[S15] START round=9 head_norm_before_train=0.814186 cos_to_last_merge=1.0000 (last merge round=8)
[S15] round=9 local utility u=0.000000 metrics={'f1_val': 0.6916505031969067, 'auprc': 0.8015267957542491, 'loss_val': 0.5093274047657769, 'psi': 0.7356010202198437}-{'f1_val': 0.6930438086427546, 'auprc': 0.9737136115887386, 'loss_val': 0.4168590066939656, 'psi': 0.8053117298211482}
[S16] START round=9 head_norm_before_train=1.117846 cos_to_last_merge=0.9498 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.950
[S16] round=9 local utility u=0.067288 metrics={'f1_val': 0.3863738494485856, 'auprc': 0.9209036191640456, 'loss_val': 0.7499065006811737, 'psi': 0.6001857573347696}-{'f1_val': 0.3850031874099581, 'auprc': 0.9121127823662276, 'loss_val': 0.8498866560988809, 'psi': 0.5958470253924659}
[S17] START round=9 head_norm_before_train=0.793265 cos_to_last_merge=1.0000 (last merge round=8)
[S17] round=9 local utility u=0.000000 metrics={'f1_val': 0.3543718778029237, 'auprc': 0.7434605274476114, 'loss_val': 0.9068030288828329, 'psi': 0.5100073376607988}-{'f1_val': 0.3735834084536613, 'auprc': 0.813454972090025, 'loss_val': 0.8911676137398223, 'psi': 0.5495320339082068}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S5] → sending delta(kind=head bytes=1792) to S16@127.0.0.1:33216
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S10] → sending delta(kind=head bytes=1791) to S3@127.0.0.1:33203
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:33215
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] → sending delta(kind=head bytes=1805) to S17@127.0.0.1:33217
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] → sending delta(kind=head bytes=1793) to S10@127.0.0.1:33211
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:33212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:33217
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S11] → sending delta(kind=head bytes=1786) to S13@127.0.0.1:33213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:33217
[S11] sending update (kind=head size=1786 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1793 to 1 peers)
[S16] sending update (kind=head size=1805 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1791 to 1 peers)
[S5] sending update (kind=head size=1792 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1800) from S6
[S11] cosine check vs S6: cos=0.2044
[S13] RECEIVED delta(kind=head bytes=1786) from S11
[S13] cosine check vs S11: cos=0.1168
[S3] RECEIVED delta(kind=head bytes=1791) from S10
[S3] cosine check vs S10: cos=0.8512
[S17] RECEIVED delta(kind=head bytes=1798) from S9
[S17] cosine check vs S9: cos=0.5781
[S17] RECEIVED delta(kind=head bytes=1801) from S8
[S17] cosine check vs S8: cos=0.6031
[S17] RECEIVED delta(kind=head bytes=1805) from S16
[S17] cosine check vs S16: cos=0.5631
[S16] RECEIVED delta(kind=head bytes=1792) from S5
[S16] cosine check vs S5: cos=-0.0374
[S16] DROPPED delta from S5 (cos=-0.0374 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1796) from S14
[S15] cosine check vs S14: cos=0.7490
[S10] RECEIVED delta(kind=head bytes=1793) from S4
[S10] cosine check vs S4: cos=0.9545
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=9 metric=0.6988 head_norm=1.149891
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.758496e-01
[S10] stored merged vector for next round verification (round=9)
[S10] DEBUG after merge:  round=9 metric=0.6981 head_norm=1.149700 delta_norm=0.175850
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=9 metric=0.3966 head_norm=1.034716
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.773011e-01
[S11] stored merged vector for next round verification (round=9)
[S11] DEBUG after merge:  round=9 metric=0.3368 head_norm=1.057083 delta_norm=0.877301
[S11] aggregate: ROLLBACK (f1_val pre=0.397 post=0.337 tol_abs=0.005 tol_rel=0.0)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=9 metric=0.4045 head_norm=0.870292
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.065950e-01
[S3] stored merged vector for next round verification (round=9)
[S3] DEBUG after merge:  round=9 metric=0.4540 head_norm=0.972537 delta_norm=0.306595
[S3] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=9 metric=0.6279 head_norm=1.122131
[S13] _apply_head_vector_avg (torch): Δ‖w‖=7.174010e-01
[S13] stored merged vector for next round verification (round=9)
[S13] DEBUG after merge:  round=9 metric=0.6232 head_norm=0.806377 delta_norm=0.717401
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=9 metric=0.6917 head_norm=0.914955
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.340994e-01
[S15] stored merged vector for next round verification (round=9)
[S15] DEBUG after merge:  round=9 metric=0.6918 head_norm=0.879763 delta_norm=0.334099
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=9 metric=0.3544 head_norm=0.882528
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.503836e-01
[S17] stored merged vector for next round verification (round=9)
[S17] DEBUG after merge:  round=9 metric=0.3530 head_norm=0.777935 delta_norm=0.250384
[S17] aggregate: ACCEPT kept=['S9', 'S8', 'S16'] (k=3/3) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=1.383382 cos_to_last_merge=0.8460 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.846
[S2] round=10 local utility u=0.000000 metrics={'f1_val': 0.6821320651955853, 'auprc': 0.6530596859649056, 'loss_val': 0.370696533617476, 'psi': 0.6705031135033135}-{'f1_val': 0.7010542679632784, 'auprc': 0.6668470031427252, 'loss_val': 0.3090426449200471, 'psi': 0.6873713620350571}
[S3] START round=10 head_norm_before_train=0.972537 cos_to_last_merge=1.0000 (last merge round=9)
[S3] round=10 local utility u=1.000000 metrics={'f1_val': 0.6995739279432054, 'auprc': 0.7958028360308539, 'loss_val': 0.7056660179775266, 'psi': 0.7380654911782647}-{'f1_val': 0.4045316402820668, 'auprc': 0.694285539132314, 'loss_val': 0.8357466956498311, 'psi': 0.5204331998221656}
[S4] START round=10 head_norm_before_train=1.176102 cos_to_last_merge=0.9668 (last merge round=6)
[S4] round=10 local utility u=0.065234 metrics={'f1_val': 0.9489572019904837, 'auprc': 0.9500853450718697, 'loss_val': 0.35907747616692637, 'psi': 0.9494084592230381}-{'f1_val': 0.9447744278037439, 'auprc': 0.9478474057559465, 'loss_val': 0.45773415145335683, 'psi': 0.9460036189846249}
[S5] START round=10 head_norm_before_train=1.438643 (no previous merge yet)
[S5] round=10 local utility u=0.112834 metrics={'f1_val': 0.7009907355533597, 'auprc': 0.7887540092456539, 'loss_val': 0.5774989101234882, 'psi': 0.7360960450302774}-{'f1_val': 0.6791951446497904, 'auprc': 0.7953796430445568, 'loss_val': 0.6922696123403569, 'psi': 0.7256689440076969}
[S6] START round=10 head_norm_before_train=1.644241 (no previous merge yet)
[S6] round=10 local utility u=1.000000 metrics={'f1_val': 0.9582399310185363, 'auprc': 0.9472519461190932, 'loss_val': 0.241246931302557, 'psi': 0.953844737058759}-{'f1_val': 0.7073998828077243, 'auprc': 0.8006942098021268, 'loss_val': 0.38365696105341807, 'psi': 0.7447176136054854}
[S7] START round=10 head_norm_before_train=1.008347 cos_to_last_merge=0.9472 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.947
[S7] round=10 local utility u=0.781229 metrics={'f1_val': 0.6276310022972457, 'auprc': 0.7873211983301236, 'loss_val': 0.8694977128684241, 'psi': 0.6915070807103969}-{'f1_val': 0.4172807768329403, 'auprc': 0.72364574537684, 'loss_val': 0.9788289360726679, 'psi': 0.5398267642505001}
[S8] START round=10 head_norm_before_train=1.702553 (no previous merge yet)
[S8] round=10 local utility u=0.000000 metrics={'f1_val': 0.7142391053978291, 'auprc': 0.9790531296934529, 'loss_val': 0.4934698806230624, 'psi': 0.8201647151160787}-{'f1_val': 0.9947005233007624, 'auprc': 0.9878235586614886, 'loss_val': 0.15108837430874153, 'psi': 0.9919497374450529}
[S9] START round=10 head_norm_before_train=0.824750 cos_to_last_merge=0.9912 (last merge round=8)
[S9] round=10 local utility u=0.303724 metrics={'f1_val': 0.40253198729167655, 'auprc': 0.9982895403184919, 'loss_val': 0.709554958509677, 'psi': 0.6408350085024027}-{'f1_val': 0.40253198729167655, 'auprc': 0.8355382513441945, 'loss_val': 0.8287483228112287, 'psi': 0.5757344929126837}
[S10] START round=10 head_norm_before_train=1.149700 cos_to_last_merge=1.0000 (last merge round=9)
[S10] round=10 local utility u=0.053793 metrics={'f1_val': 0.7000537794092287, 'auprc': 0.9973303177513495, 'loss_val': 0.25578231939615764, 'psi': 0.8189643947460771}-{'f1_val': 0.6987767787065788, 'auprc': 0.9936665332143007, 'loss_val': 0.3447148947916718, 'psi': 0.8167326805096675}
[S11] START round=10 head_norm_before_train=1.057083 cos_to_last_merge=1.0000 (last merge round=9)
[S11] round=10 local utility u=0.296547 metrics={'f1_val': 0.396639232794319, 'auprc': 0.9241790749350397, 'loss_val': 0.8189682370280515, 'psi': 0.6076551696506073}-{'f1_val': 0.39658602128368947, 'auprc': 0.7364686233980374, 'loss_val': 0.8486125272091016, 'psi': 0.5325390621294287}
[S13] START round=10 head_norm_before_train=0.806377 cos_to_last_merge=1.0000 (last merge round=9)
[S13] round=10 local utility u=0.042066 metrics={'f1_val': 0.6317276340411189, 'auprc': 0.6669530193883887, 'loss_val': 0.6894844815538136, 'psi': 0.6458177881800268}-{'f1_val': 0.6279481080025985, 'auprc': 0.657304018638243, 'loss_val': 0.7219922114678972, 'psi': 0.6396904722568563}
[S14] START round=10 head_norm_before_train=0.966471 cos_to_last_merge=0.9956 (last merge round=8)
[S14] round=10 local utility u=0.028729 metrics={'f1_val': 0.39652757107859105, 'auprc': 0.9955204032908407, 'loss_val': 0.6876469897019344, 'psi': 0.636124703963491}-{'f1_val': 0.4038407369585293, 'auprc': 0.997366153626052, 'loss_val': 0.7945208945682045, 'psi': 0.6412509036255384}
[S15] START round=10 head_norm_before_train=0.879763 cos_to_last_merge=1.0000 (last merge round=9)
[S15] round=10 local utility u=0.254217 metrics={'f1_val': 0.6952757389641915, 'auprc': 0.9467310914074473, 'loss_val': 0.4582574275584492, 'psi': 0.7958578799414937}-{'f1_val': 0.6916505031969067, 'auprc': 0.8015267957542491, 'loss_val': 0.5093274047657769, 'psi': 0.7356010202198437}
[S16] START round=10 head_norm_before_train=1.166948 cos_to_last_merge=0.9352 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.935
[S16] round=10 local utility u=0.598501 metrics={'f1_val': 0.5358538801312969, 'auprc': 0.9816386239925401, 'loss_val': 0.6319903797787974, 'psi': 0.7141677776757942}-{'f1_val': 0.3863738494485856, 'auprc': 0.9209036191640456, 'loss_val': 0.7499065006811737, 'psi': 0.6001857573347696}
[S17] START round=10 head_norm_before_train=0.777935 cos_to_last_merge=1.0000 (last merge round=9)
[S17] round=10 local utility u=0.492645 metrics={'f1_val': 0.5179202215338864, 'auprc': 0.7471717747229764, 'loss_val': 0.9139364175487681, 'psi': 0.6096208428095224}-{'f1_val': 0.3543718778029237, 'auprc': 0.7434605274476114, 'loss_val': 0.9068030288828329, 'psi': 0.5100073376607988}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:33211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:33212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:33213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:33216
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:33210
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] → sending delta(kind=head bytes=1793) to S17@127.0.0.1:33217
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:33217
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:33204
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:33214
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:33212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:33215
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:33203
[S10] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1793 to 1 peers)
[S3] sending update (kind=head size=1794 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1799) from S10
[S3] cosine check vs S10: cos=0.9416
[S11] RECEIVED delta(kind=head bytes=1796) from S6
[S11] cosine check vs S6: cos=0.8581
[S17] RECEIVED delta(kind=head bytes=1801) from S16
[S17] cosine check vs S16: cos=0.6557
[S17] RECEIVED delta(kind=head bytes=1793) from S9
[S17] cosine check vs S9: cos=0.7169
[S16] RECEIVED delta(kind=head bytes=1796) from S5
[S16] cosine check vs S5: cos=-0.0379
[S16] DROPPED delta from S5 (cos=-0.0379 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1794) from S3
[S9] cosine check vs S3: cos=0.7958
[S14] RECEIVED delta(kind=head bytes=1796) from S7
[S14] cosine check vs S7: cos=0.9366
[S10] RECEIVED delta(kind=head bytes=1800) from S4
[S10] cosine check vs S4: cos=0.9708
[S15] RECEIVED delta(kind=head bytes=1800) from S14
[S15] cosine check vs S14: cos=0.8713
[S4] RECEIVED delta(kind=head bytes=1796) from S13
[S4] cosine check vs S13: cos=0.3830
[S11] RECEIVED delta(kind=head bytes=1795) from S15
[S11] cosine check vs S15: cos=0.2636
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:33203
[S17] sending update (kind=head size=1800 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1800) from S17
[S3] cosine check vs S17: cos=0.6173
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1796) from S11
[S13] cosine check vs S11: cos=0.5324
[S2] ⇄ pheromone p=0.210 → S13@127.0.0.1:33213
[S8] ⇄ pheromone p=0.377 → S17@127.0.0.1:33217
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=10 metric=0.7001 head_norm=1.233350
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.499627e-01
[S10] stored merged vector for next round verification (round=10)
[S10] DEBUG after merge:  round=10 metric=0.6999 head_norm=1.231302 delta_norm=0.149963
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.372 → S3@127.0.0.1:33203
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=10 metric=0.4025 head_norm=0.889246
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.100508e-01
[S9] stored merged vector for next round verification (round=10)
[S9] DEBUG after merge:  round=10 metric=0.4025 head_norm=0.902543 delta_norm=0.310051
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.300 → S17@127.0.0.1:33217
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=10 metric=0.6317 head_norm=0.884428
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.872180e-01
[S13] stored merged vector for next round verification (round=10)
[S13] DEBUG after merge:  round=10 metric=0.6186 head_norm=0.867627 delta_norm=0.487218
[S13] aggregate: ROLLBACK (f1_val pre=0.632 post=0.619 tol_abs=0.005 tol_rel=0.0)
[S13] ⇄ pheromone p=0.212 → S4@127.0.0.1:33204
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=10 metric=0.9490 head_norm=1.247411
[S4] _apply_head_vector_avg (torch): Δ‖w‖=6.109924e-01
[S4] stored merged vector for next round verification (round=10)
[S4] DEBUG after merge:  round=10 metric=0.9538 head_norm=0.892083 delta_norm=0.610992
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.326 → S10@127.0.0.1:33211
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=10 metric=0.6996 head_norm=1.015221
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.717857e-01
[S3] stored merged vector for next round verification (round=10)
[S3] DEBUG after merge:  round=10 metric=0.6998 head_norm=0.943539 delta_norm=0.171786
[S3] aggregate: ACCEPT kept=['S10', 'S17'] (k=2/2) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.562 → S9@127.0.0.1:33210
[S7] ⇄ pheromone p=0.381 → S14@127.0.0.1:33214
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=10 metric=0.3965 head_norm=1.014061
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.838203e-01
[S14] stored merged vector for next round verification (round=10)
[S14] DEBUG after merge:  round=10 metric=0.5184 head_norm=1.012492 delta_norm=0.183820
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.257 → S15@127.0.0.1:33215
[S6] ⇄ pheromone p=0.472 → S11@127.0.0.1:33212
[S5] ⇄ pheromone p=0.351 → S16@127.0.0.1:33216
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=10 metric=0.5179 head_norm=0.865706
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.915010e-01
[S17] stored merged vector for next round verification (round=10)
[S17] DEBUG after merge:  round=10 metric=0.3526 head_norm=0.841184 delta_norm=0.291501
[S17] aggregate: ROLLBACK (f1_val pre=0.518 post=0.353 tol_abs=0.005 tol_rel=0.0)
[S17] ⇄ pheromone p=0.272 → S3@127.0.0.1:33203
[S16] ⇄ pheromone p=0.350 → S17@127.0.0.1:33217
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=10 metric=0.6953 head_norm=0.970453
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.525683e-01
[S15] stored merged vector for next round verification (round=10)
[S15] DEBUG after merge:  round=10 metric=0.6955 head_norm=0.959822 delta_norm=0.252568
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.318 → S11@127.0.0.1:33212
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=10 metric=0.3966 head_norm=1.094579
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.494154e-01
[S11] stored merged vector for next round verification (round=10)
[S11] DEBUG after merge:  round=10 metric=0.3368 head_norm=0.994444 delta_norm=0.249415
[S11] aggregate: ROLLBACK (f1_val pre=0.397 post=0.337 tol_abs=0.005 tol_rel=0.0)
[S11] ⇄ pheromone p=0.321 → S13@127.0.0.1:33213
[S2] START round=11 head_norm_before_train=1.433702 cos_to_last_merge=0.8307 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.831
[S2] round=11 local utility u=0.107467 metrics={'f1_val': 0.7009756597039377, 'auprc': 0.6607970611439552, 'loss_val': 0.2920365632841481, 'psi': 0.6849042202799447}-{'f1_val': 0.6821320651955853, 'auprc': 0.6530596859649056, 'loss_val': 0.370696533617476, 'psi': 0.6705031135033135}
[S3] START round=11 head_norm_before_train=0.943539 cos_to_last_merge=1.0000 (last merge round=10)
[S3] round=11 local utility u=0.035880 metrics={'f1_val': 0.700330919019862, 'auprc': 0.7960207125869654, 'loss_val': 0.6391013797736793, 'psi': 0.7386068364467033}-{'f1_val': 0.6995739279432054, 'auprc': 0.7958028360308539, 'loss_val': 0.7056660179775266, 'psi': 0.7380654911782647}
[S4] START round=11 head_norm_before_train=0.892083 cos_to_last_merge=1.0000 (last merge round=10)
[S4] round=11 local utility u=0.000000 metrics={'f1_val': 0.9435574081561755, 'auprc': 0.948149706348087, 'loss_val': 0.3927423222582795, 'psi': 0.94539432743294}-{'f1_val': 0.9489572019904837, 'auprc': 0.9500853450718697, 'loss_val': 0.35907747616692637, 'psi': 0.9494084592230381}
[S5] START round=11 head_norm_before_train=1.472858 (no previous merge yet)
[S5] round=11 local utility u=0.021528 metrics={'f1_val': 0.7010632471997429, 'auprc': 0.7874175286581258, 'loss_val': 0.5308690832261578, 'psi': 0.735604959783096}-{'f1_val': 0.7009907355533597, 'auprc': 0.7887540092456539, 'loss_val': 0.5774989101234882, 'psi': 0.7360960450302774}
[S6] START round=11 head_norm_before_train=1.675067 (no previous merge yet)
[S6] round=11 local utility u=0.000000 metrics={'f1_val': 0.8141835003925643, 'auprc': 0.8761708286753292, 'loss_val': 0.3252001861540938, 'psi': 0.8389784317056703}-{'f1_val': 0.9582399310185363, 'auprc': 0.9472519461190932, 'loss_val': 0.241246931302557, 'psi': 0.953844737058759}
[S7] START round=11 head_norm_before_train=1.043810 cos_to_last_merge=0.9365 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.936
[S7] round=11 local utility u=0.295432 metrics={'f1_val': 0.7141664499618597, 'auprc': 0.7834264207571531, 'loss_val': 0.7861617497242388, 'psi': 0.741870438279977}-{'f1_val': 0.6276310022972457, 'auprc': 0.7873211983301236, 'loss_val': 0.8694977128684241, 'psi': 0.6915070807103969}
[S8] START round=11 head_norm_before_train=1.752278 (no previous merge yet)
[S8] round=11 local utility u=1.000000 metrics={'f1_val': 0.9938621753089841, 'auprc': 0.9883855317916965, 'loss_val': 0.08829113311229303, 'psi': 0.9916715179020692}-{'f1_val': 0.7142391053978291, 'auprc': 0.9790531296934529, 'loss_val': 0.4934698806230624, 'psi': 0.8201647151160787}
[S9] START round=11 head_norm_before_train=0.902543 cos_to_last_merge=1.0000 (last merge round=10)
[S9] round=11 local utility u=0.745402 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.8643206922180607, 'loss_val': 0.6093959872817375, 'psi': 0.7665025670117623}-{'f1_val': 0.40253198729167655, 'auprc': 0.9982895403184919, 'loss_val': 0.709554958509677, 'psi': 0.6408350085024027}
[S10] START round=11 head_norm_before_train=1.231302 cos_to_last_merge=1.0000 (last merge round=10)
[S10] round=11 local utility u=0.905777 metrics={'f1_val': 0.9939955423904683, 'auprc': 0.997094512736943, 'loss_val': 0.2071715147569495, 'psi': 0.9952351305290581}-{'f1_val': 0.7000537794092287, 'auprc': 0.9973303177513495, 'loss_val': 0.25578231939615764, 'psi': 0.8189643947460771}
[S11] START round=11 head_norm_before_train=0.994444 cos_to_last_merge=1.0000 (last merge round=10)
[S11] round=11 local utility u=0.341382 metrics={'f1_val': 0.5001327403418234, 'auprc': 0.9375509304541885, 'loss_val': 0.7972813383846791, 'psi': 0.6751000163867694}-{'f1_val': 0.396639232794319, 'auprc': 0.9241790749350397, 'loss_val': 0.8189682370280515, 'psi': 0.6076551696506073}
[S13] START round=11 head_norm_before_train=0.867627 cos_to_last_merge=1.0000 (last merge round=10)
[S13] round=11 local utility u=0.000000 metrics={'f1_val': 0.6015877848236807, 'auprc': 0.685888121968461, 'loss_val': 0.7713687676502479, 'psi': 0.6353079196815928}-{'f1_val': 0.6317276340411189, 'auprc': 0.6669530193883887, 'loss_val': 0.6894844815538136, 'psi': 0.6458177881800268}
[S14] START round=11 head_norm_before_train=1.012492 cos_to_last_merge=1.0000 (last merge round=10)
[S14] round=11 local utility u=0.044676 metrics={'f1_val': 0.4045265953481674, 'auprc': 0.9969506144939042, 'loss_val': 0.6505800608613117, 'psi': 0.6414962030064622}-{'f1_val': 0.39652757107859105, 'auprc': 0.9955204032908407, 'loss_val': 0.6876469897019344, 'psi': 0.636124703963491}
[S15] START round=11 head_norm_before_train=0.959822 cos_to_last_merge=1.0000 (last merge round=10)
[S15] round=11 local utility u=0.000000 metrics={'f1_val': 0.6904253942742075, 'auprc': 0.7857461299637132, 'loss_val': 0.5314997288871309, 'psi': 0.7285536885500097}-{'f1_val': 0.6952757389641915, 'auprc': 0.9467310914074473, 'loss_val': 0.4582574275584492, 'psi': 0.7958578799414937}
[S16] START round=11 head_norm_before_train=1.221448 cos_to_last_merge=0.9208 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.921
[S16] round=11 local utility u=0.336826 metrics={'f1_val': 0.634113633178911, 'auprc': 0.987399345661863, 'loss_val': 0.5651783431985867, 'psi': 0.7754279181720918}-{'f1_val': 0.5358538801312969, 'auprc': 0.9816386239925401, 'loss_val': 0.6319903797787974, 'psi': 0.7141677776757942}
[S17] START round=11 head_norm_before_train=0.841184 cos_to_last_merge=1.0000 (last merge round=10)
[S17] round=11 local utility u=0.000000 metrics={'f1_val': 0.3533640907749881, 'auprc': 0.8406054562399852, 'loss_val': 0.9232750300061616, 'psi': 0.5482606369609869}-{'f1_val': 0.5179202215338864, 'auprc': 0.7471717747229764, 'loss_val': 0.9139364175487681, 'psi': 0.6096208428095224}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:33217
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:33216
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:33214
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:33213
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:33217
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S3] → sending delta(kind=head bytes=1790) to S9@127.0.0.1:33210
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S3] sending update (kind=head size=1790 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1797) from S7
[S14] cosine check vs S7: cos=0.9666
[S17] RECEIVED delta(kind=head bytes=1796) from S8
[S17] cosine check vs S8: cos=0.2028
[S17] RECEIVED delta(kind=head bytes=1796) from S9
[S17] cosine check vs S9: cos=0.7978
[S16] RECEIVED delta(kind=head bytes=1796) from S5
[S16] cosine check vs S5: cos=-0.0388
[S16] DROPPED delta from S5 (cos=-0.0388 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1800) from S2
[S13] cosine check vs S2: cos=0.3263
[S9] RECEIVED delta(kind=head bytes=1790) from S3
[S9] cosine check vs S3: cos=0.9294
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:33203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:33213
[S11] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1794 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1800) from S11
[S13] cosine check vs S11: cos=0.8489
[S3] RECEIVED delta(kind=head bytes=1794) from S10
[S3] cosine check vs S10: cos=0.9081
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:33215
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1797) from S14
[S15] cosine check vs S14: cos=0.9224
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:33217
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1803 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1803) from S16
[S17] cosine check vs S16: cos=0.7849
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=11 metric=0.7003 head_norm=0.995812
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.865878e-01
[S3] stored merged vector for next round verification (round=11)
[S3] DEBUG after merge:  round=11 metric=0.7006 head_norm=1.120560 delta_norm=0.286588
[S3] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=11 metric=0.6016 head_norm=0.924697
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.257769e-01
[S13] stored merged vector for next round verification (round=11)
[S13] DEBUG after merge:  round=11 metric=0.6014 head_norm=0.856657 delta_norm=0.325777
[S13] aggregate: ACCEPT kept=['S2', 'S11'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=11 metric=0.4045 head_norm=1.049646
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.383513e-01
[S14] stored merged vector for next round verification (round=11)
[S14] DEBUG after merge:  round=11 metric=0.5210 head_norm=1.055379 delta_norm=0.138351
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=11 metric=0.6904 head_norm=1.038332
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.056686e-01
[S15] stored merged vector for next round verification (round=11)
[S15] DEBUG after merge:  round=11 metric=0.6903 head_norm=1.023545 delta_norm=0.205669
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=11 metric=0.7013 head_norm=0.960083
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.845878e-01
[S9] stored merged vector for next round verification (round=11)
[S9] DEBUG after merge:  round=11 metric=0.7013 head_norm=0.960535 delta_norm=0.184588
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=11 metric=0.3534 head_norm=0.914505
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.649182e-01
[S17] stored merged vector for next round verification (round=11)
[S17] DEBUG after merge:  round=11 metric=0.3877 head_norm=0.863297 delta_norm=0.164918
[S17] aggregate: ACCEPT kept=['S8', 'S9', 'S16'] (k=3/3) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.476476 cos_to_last_merge=0.8249 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.825
[S2] round=12 local utility u=0.004734 metrics={'f1_val': 0.7012347841865968, 'auprc': 0.6595820589759247, 'loss_val': 0.2804788690009968, 'psi': 0.6845736941023279}-{'f1_val': 0.7009756597039377, 'auprc': 0.6607970611439552, 'loss_val': 0.2920365632841481, 'psi': 0.6849042202799447}
[S3] START round=12 head_norm_before_train=1.120560 cos_to_last_merge=1.0000 (last merge round=11)
[S3] round=12 local utility u=0.073696 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.7982689582818645, 'loss_val': 0.5010060157738151, 'psi': 0.7397613055539256}-{'f1_val': 0.700330919019862, 'auprc': 0.7960207125869654, 'loss_val': 0.6391013797736793, 'psi': 0.7386068364467033}
[S4] START round=12 head_norm_before_train=0.988147 cos_to_last_merge=0.9950 (last merge round=10)
[S4] round=12 local utility u=0.060978 metrics={'f1_val': 0.9462725653538286, 'auprc': 0.9574292221300238, 'loss_val': 0.31491573445939053, 'psi': 0.9507352280643067}-{'f1_val': 0.9435574081561755, 'auprc': 0.948149706348087, 'loss_val': 0.3927423222582795, 'psi': 0.94539432743294}
[S5] START round=12 head_norm_before_train=1.499759 (no previous merge yet)
[S5] round=12 local utility u=0.033395 metrics={'f1_val': 0.7008168588441903, 'auprc': 0.7873582795548961, 'loss_val': 0.46242364089871274, 'psi': 0.7354334271284726}-{'f1_val': 0.7010632471997429, 'auprc': 0.7874175286581258, 'loss_val': 0.5308690832261578, 'psi': 0.735604959783096}
[S6] START round=12 head_norm_before_train=1.697498 (no previous merge yet)
[S6] round=12 local utility u=0.000000 metrics={'f1_val': 0.6410875582124804, 'auprc': 0.7998843656744989, 'loss_val': 0.4554434740484346, 'psi': 0.7046062811972879}-{'f1_val': 0.8141835003925643, 'auprc': 0.8761708286753292, 'loss_val': 0.3252001861540938, 'psi': 0.8389784317056703}
[S7] START round=12 head_norm_before_train=1.078971 cos_to_last_merge=0.9256 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.926
[S7] round=12 local utility u=0.000000 metrics={'f1_val': 0.6660680834366293, 'auprc': 0.7824187712098396, 'loss_val': 0.7344568520045697, 'psi': 0.7126083585459133}-{'f1_val': 0.7141664499618597, 'auprc': 0.7834264207571531, 'loss_val': 0.7861617497242388, 'psi': 0.741870438279977}
[S8] START round=12 head_norm_before_train=1.783136 (no previous merge yet)
[S8] round=12 local utility u=0.000000 metrics={'f1_val': 0.7138416185186716, 'auprc': 0.9883294497574322, 'loss_val': 0.3069709818528992, 'psi': 0.8236367510141758}-{'f1_val': 0.9938621753089841, 'auprc': 0.9883855317916965, 'loss_val': 0.08829113311229303, 'psi': 0.9916715179020692}
[S9] START round=12 head_norm_before_train=0.960535 cos_to_last_merge=1.0000 (last merge round=11)
[S9] round=12 local utility u=0.198686 metrics={'f1_val': 0.7013646677191758, 'auprc': 0.9676439710241888, 'loss_val': 0.522439762321098, 'psi': 0.8078763890411811}-{'f1_val': 0.7012904835408967, 'auprc': 0.8643206922180607, 'loss_val': 0.6093959872817375, 'psi': 0.7665025670117623}
[S10] START round=12 head_norm_before_train=1.297664 cos_to_last_merge=0.9973 (last merge round=10)
[S10] round=12 local utility u=0.022424 metrics={'f1_val': 0.993560617225544, 'auprc': 0.9969070818639214, 'loss_val': 0.15915068991640027, 'psi': 0.994899203080895}-{'f1_val': 0.9939955423904683, 'auprc': 0.997094512736943, 'loss_val': 0.2071715147569495, 'psi': 0.9952351305290581}
[S11] START round=12 head_norm_before_train=1.031863 cos_to_last_merge=0.9943 (last merge round=10)
[S11] round=12 local utility u=0.000000 metrics={'f1_val': 0.5516139703267231, 'auprc': 0.759905702755691, 'loss_val': 0.8646117702756957, 'psi': 0.6349306632983103}-{'f1_val': 0.5001327403418234, 'auprc': 0.9375509304541885, 'loss_val': 0.7972813383846791, 'psi': 0.6751000163867694}
[S13] START round=12 head_norm_before_train=0.856657 cos_to_last_merge=1.0000 (last merge round=11)
[S13] round=12 local utility u=0.082641 metrics={'f1_val': 0.6272770208927888, 'auprc': 0.669004403896176, 'loss_val': 0.7095701396707117, 'psi': 0.6439679740941437}-{'f1_val': 0.6015877848236807, 'auprc': 0.685888121968461, 'loss_val': 0.7713687676502479, 'psi': 0.6353079196815928}
[S14] START round=12 head_norm_before_train=1.055379 cos_to_last_merge=1.0000 (last merge round=11)
[S14] round=12 local utility u=0.407399 metrics={'f1_val': 0.5308357950615125, 'auprc': 0.9971605559905078, 'loss_val': 0.5942678945352696, 'psi': 0.7173656994331106}-{'f1_val': 0.4045265953481674, 'auprc': 0.9969506144939042, 'loss_val': 0.6505800608613117, 'psi': 0.6414962030064622}
[S15] START round=12 head_norm_before_train=1.023545 cos_to_last_merge=1.0000 (last merge round=11)
[S15] round=12 local utility u=0.058030 metrics={'f1_val': 0.6953185561841557, 'auprc': 0.8012227123388487, 'loss_val': 0.49122800704433056, 'psi': 0.737680218646033}-{'f1_val': 0.6904253942742075, 'auprc': 0.7857461299637132, 'loss_val': 0.5314997288871309, 'psi': 0.7285536885500097}
[S16] START round=12 head_norm_before_train=1.274615 cos_to_last_merge=0.9082 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.908
[S16] round=12 local utility u=0.100491 metrics={'f1_val': 0.6465663486696404, 'auprc': 0.9890388433405533, 'loss_val': 0.4438318793125207, 'psi': 0.7835553465380056}-{'f1_val': 0.634113633178911, 'auprc': 0.987399345661863, 'loss_val': 0.5651783431985867, 'psi': 0.7754279181720918}
[S17] START round=12 head_norm_before_train=0.863297 cos_to_last_merge=1.0000 (last merge round=11)
[S17] round=12 local utility u=0.018664 metrics={'f1_val': 0.36674019607843134, 'auprc': 0.8259557613036935, 'loss_val': 0.9222550835483221, 'psi': 0.5504264221685362}-{'f1_val': 0.3533640907749881, 'auprc': 0.8406054562399852, 'loss_val': 0.9232750300061616, 'psi': 0.5482606369609869}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:33212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] → sending delta(kind=head bytes=1793) to S17@127.0.0.1:33217
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:33203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:33204
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:33210
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:33217
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:33215
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:33213
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:33216
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:33211
[S16] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1793 to 1 peers)
[S9] sending update (kind=head size=1793 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1797) from S13
[S4] cosine check vs S13: cos=0.6412
[S17] RECEIVED delta(kind=head bytes=1793) from S9
[S17] cosine check vs S9: cos=0.8423
[S11] RECEIVED delta(kind=head bytes=1800) from S15
[S11] cosine check vs S15: cos=0.2906
[S16] RECEIVED delta(kind=head bytes=1793) from S5
[S16] cosine check vs S5: cos=-0.0397
[S16] DROPPED delta from S5 (cos=-0.0397 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1795) from S3
[S9] cosine check vs S3: cos=0.9213
[S15] RECEIVED delta(kind=head bytes=1796) from S14
[S15] cosine check vs S14: cos=0.9442
[S3] RECEIVED delta(kind=head bytes=1800) from S10
[S3] cosine check vs S10: cos=0.9726
[S10] RECEIVED delta(kind=head bytes=1797) from S4
[S10] cosine check vs S4: cos=0.8963
[S13] RECEIVED delta(kind=head bytes=1798) from S2
[S13] cosine check vs S2: cos=0.6012
[S17] RECEIVED delta(kind=head bytes=1803) from S16
[S17] cosine check vs S16: cos=0.7737
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:33203
[S17] sending update (kind=head size=1801 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1801) from S17
[S3] cosine check vs S17: cos=0.7193
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=12 metric=0.5516 head_norm=1.078497
[S11] _apply_head_vector_avg (torch): Δ‖w‖=6.481543e-01
[S11] stored merged vector for next round verification (round=12)
[S11] DEBUG after merge:  round=12 metric=0.4340 head_norm=0.874181 delta_norm=0.648154
[S11] aggregate: ROLLBACK (f1_val pre=0.552 post=0.434 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=12 metric=0.7014 head_norm=1.013953
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.292550e-01
[S9] stored merged vector for next round verification (round=12)
[S9] DEBUG after merge:  round=12 metric=0.7014 head_norm=1.069366 delta_norm=0.229255
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=12 metric=0.9463 head_norm=1.088849
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.335873e-01
[S4] stored merged vector for next round verification (round=12)
[S4] DEBUG after merge:  round=12 metric=0.9467 head_norm=0.915095 delta_norm=0.433587
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=12 metric=0.6953 head_norm=1.097924
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.830404e-01
[S15] stored merged vector for next round verification (round=12)
[S15] DEBUG after merge:  round=12 metric=0.6941 head_norm=1.080205 delta_norm=0.183040
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=12 metric=0.9936 head_norm=1.355265
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.070026e-01
[S10] stored merged vector for next round verification (round=12)
[S10] DEBUG after merge:  round=12 metric=0.9931 head_norm=1.190343 delta_norm=0.307003
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=12 metric=0.6273 head_norm=0.930163
[S13] _apply_head_vector_avg (torch): Δ‖w‖=6.017795e-01
[S13] stored merged vector for next round verification (round=12)
[S13] DEBUG after merge:  round=12 metric=0.6271 head_norm=1.097375 delta_norm=0.601780
[S13] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=12 metric=0.7008 head_norm=1.167948
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.555017e-01
[S3] stored merged vector for next round verification (round=12)
[S3] DEBUG after merge:  round=12 metric=0.7008 head_norm=1.088810 delta_norm=0.155502
[S3] aggregate: ACCEPT kept=['S10', 'S17'] (k=2/2) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=12 metric=0.3667 head_norm=0.932123
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.185514e-01
[S17] stored merged vector for next round verification (round=12)
[S17] DEBUG after merge:  round=12 metric=0.3697 head_norm=0.961575 delta_norm=0.218551
[S17] aggregate: ACCEPT kept=['S9', 'S16'] (k=2/2) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.505835 cos_to_last_merge=0.8166 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.817
[S2] round=13 local utility u=0.000000 metrics={'f1_val': 0.7012347841865968, 'auprc': 0.6594392000951366, 'loss_val': 0.2879929971010112, 'psi': 0.6845165505500127}-{'f1_val': 0.7012347841865968, 'auprc': 0.6595820589759247, 'loss_val': 0.2804788690009968, 'psi': 0.6845736941023279}
[S3] START round=13 head_norm_before_train=1.088810 cos_to_last_merge=1.0000 (last merge round=12)
[S3] round=13 local utility u=0.321795 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9971426944174969, 'loss_val': 0.4540376259962065, 'psi': 0.8193108000081786}-{'f1_val': 0.7007562037352997, 'auprc': 0.7982689582818645, 'loss_val': 0.5010060157738151, 'psi': 0.7397613055539256}
[S4] START round=13 head_norm_before_train=0.915095 cos_to_last_merge=1.0000 (last merge round=12)
[S4] round=13 local utility u=0.000000 metrics={'f1_val': 0.9482054242791242, 'auprc': 0.960040858205361, 'loss_val': 0.3466002158517936, 'psi': 0.9529395978496189}-{'f1_val': 0.9462725653538286, 'auprc': 0.9574292221300238, 'loss_val': 0.31491573445939053, 'psi': 0.9507352280643067}
[S5] START round=13 head_norm_before_train=1.518737 (no previous merge yet)
[S5] round=13 local utility u=0.040658 metrics={'f1_val': 0.7011046720655897, 'auprc': 0.7945262728827664, 'loss_val': 0.40433823443036543, 'psi': 0.7384733123924604}-{'f1_val': 0.7008168588441903, 'auprc': 0.7873582795548961, 'loss_val': 0.46242364089871274, 'psi': 0.7354334271284726}
[S6] START round=13 head_norm_before_train=1.717271 (no previous merge yet)
[S6] round=13 local utility u=0.913021 metrics={'f1_val': 0.8449000629131588, 'auprc': 0.9462074002116121, 'loss_val': 0.2912456961713577, 'psi': 0.8854229978325401}-{'f1_val': 0.6410875582124804, 'auprc': 0.7998843656744989, 'loss_val': 0.4554434740484346, 'psi': 0.7046062811972879}
[S7] START round=13 head_norm_before_train=1.113743 cos_to_last_merge=0.9139 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.914
[S7] round=13 local utility u=0.202383 metrics={'f1_val': 0.663626611246694, 'auprc': 0.8938120299069445, 'loss_val': 0.6492217392638604, 'psi': 0.7557007787107942}-{'f1_val': 0.6660680834366293, 'auprc': 0.7824187712098396, 'loss_val': 0.7344568520045697, 'psi': 0.7126083585459133}
[S8] START round=13 head_norm_before_train=1.812779 (no previous merge yet)
[S8] round=13 local utility u=0.962959 metrics={'f1_val': 0.9937777583442691, 'auprc': 0.9885051802250819, 'loss_val': 0.06119702920714732, 'psi': 0.9916687270965943}-{'f1_val': 0.7138416185186716, 'auprc': 0.9883294497574322, 'loss_val': 0.3069709818528992, 'psi': 0.8236367510141758}
[S9] START round=13 head_norm_before_train=1.069366 cos_to_last_merge=1.0000 (last merge round=12)
[S9] round=13 local utility u=0.069891 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.998384933171488, 'loss_val': 0.474436265287096, 'psi': 0.8201282633931333}-{'f1_val': 0.7013646677191758, 'auprc': 0.9676439710241888, 'loss_val': 0.522439762321098, 'psi': 0.8078763890411811}
[S10] START round=13 head_norm_before_train=1.190343 cos_to_last_merge=1.0000 (last merge round=12)
[S10] round=13 local utility u=0.000000 metrics={'f1_val': 0.9947723700160056, 'auprc': 0.9940236298862317, 'loss_val': 0.1862610659360026, 'psi': 0.994472873964096}-{'f1_val': 0.993560617225544, 'auprc': 0.9969070818639214, 'loss_val': 0.15915068991640027, 'psi': 0.994899203080895}
[S11] START round=13 head_norm_before_train=0.874181 cos_to_last_merge=1.0000 (last merge round=12)
[S11] round=13 local utility u=0.723089 metrics={'f1_val': 0.7017589383281313, 'auprc': 0.9061393731239111, 'loss_val': 0.7580038673712308, 'psi': 0.7835111122464433}-{'f1_val': 0.5516139703267231, 'auprc': 0.759905702755691, 'loss_val': 0.8646117702756957, 'psi': 0.6349306632983103}
[S13] START round=13 head_norm_before_train=1.097375 cos_to_last_merge=1.0000 (last merge round=12)
[S13] round=13 local utility u=0.000000 metrics={'f1_val': 0.6169562897978147, 'auprc': 0.6617033006048603, 'loss_val': 0.7763801949249324, 'psi': 0.634855094120633}-{'f1_val': 0.6272770208927888, 'auprc': 0.669004403896176, 'loss_val': 0.7095701396707117, 'psi': 0.6439679740941437}
[S14] START round=13 head_norm_before_train=1.093277 cos_to_last_merge=0.9980 (last merge round=11)
[S14] round=13 local utility u=1.000000 metrics={'f1_val': 0.9318652632945325, 'auprc': 0.9971599183328799, 'loss_val': 0.4730243624678998, 'psi': 0.9579831253098714}-{'f1_val': 0.5308357950615125, 'auprc': 0.9971605559905078, 'loss_val': 0.5942678945352696, 'psi': 0.7173656994331106}
[S15] START round=13 head_norm_before_train=1.080205 cos_to_last_merge=1.0000 (last merge round=12)
[S15] round=13 local utility u=0.146381 metrics={'f1_val': 0.6942914040464104, 'auprc': 0.8935175360956614, 'loss_val': 0.46918728186908754, 'psi': 0.7739818568661109}-{'f1_val': 0.6953185561841557, 'auprc': 0.8012227123388487, 'loss_val': 0.49122800704433056, 'psi': 0.737680218646033}
[S16] START round=13 head_norm_before_train=1.327826 cos_to_last_merge=0.8966 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.897
[S16] round=13 local utility u=0.813611 metrics={'f1_val': 0.9067041947539206, 'auprc': 0.9916531656230683, 'loss_val': 0.38527924686261245, 'psi': 0.9406837831015797}-{'f1_val': 0.6465663486696404, 'auprc': 0.9890388433405533, 'loss_val': 0.4438318793125207, 'psi': 0.7835553465380056}
[S17] START round=13 head_norm_before_train=0.961575 cos_to_last_merge=1.0000 (last merge round=12)
[S17] round=13 local utility u=0.000000 metrics={'f1_val': 0.35317771804322007, 'auprc': 0.7853825803663889, 'loss_val': 0.9248972833120903, 'psi': 0.5260596629724876}-{'f1_val': 0.36674019607843134, 'auprc': 0.8259557613036935, 'loss_val': 0.9222550835483221, 'psi': 0.5504264221685362}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S3] → sending delta(kind=head bytes=1791) to S9@127.0.0.1:33210
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:33215
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:33216
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:33212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:33212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:33217
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:33217
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:33214
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:33213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:33217
[S14] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S3] sending update (kind=head size=1791 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1803 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1791) from S3
[S9] cosine check vs S3: cos=0.9753
[S14] RECEIVED delta(kind=head bytes=1800) from S7
[S14] cosine check vs S7: cos=0.9601
[S15] RECEIVED delta(kind=head bytes=1802) from S14
[S15] cosine check vs S14: cos=0.9627
[S17] RECEIVED delta(kind=head bytes=1796) from S9
[S17] cosine check vs S9: cos=0.8270
[S11] RECEIVED delta(kind=head bytes=1801) from S15
[S11] cosine check vs S15: cos=0.7640
[S11] RECEIVED delta(kind=head bytes=1802) from S6
[S11] cosine check vs S6: cos=0.4783
[S17] RECEIVED delta(kind=head bytes=1803) from S16
[S17] cosine check vs S16: cos=0.8383
[S16] RECEIVED delta(kind=head bytes=1797) from S5
[S16] cosine check vs S5: cos=-0.0408
[S16] DROPPED delta from S5 (cos=-0.0408 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1798) from S11
[S13] cosine check vs S11: cos=0.2989
[S17] RECEIVED delta(kind=head bytes=1795) from S8
[S17] cosine check vs S8: cos=0.1115
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=13 metric=0.6170 head_norm=1.148024
[S13] _apply_head_vector_avg (torch): Δ‖w‖=6.157827e-01
[S13] stored merged vector for next round verification (round=13)
[S13] DEBUG after merge:  round=13 metric=0.6159 head_norm=0.830645 delta_norm=0.615783
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=13 metric=0.9319 head_norm=1.137988
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.615341e-01
[S14] stored merged vector for next round verification (round=13)
[S14] DEBUG after merge:  round=13 metric=0.9282 head_norm=1.132062 delta_norm=0.161534
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=13 metric=0.6943 head_norm=1.154658
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.567388e-01
[S15] stored merged vector for next round verification (round=13)
[S15] DEBUG after merge:  round=13 metric=0.6938 head_norm=1.135588 delta_norm=0.156739
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=13 metric=0.7018 head_norm=0.905737
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.753502e-01
[S11] stored merged vector for next round verification (round=13)
[S11] DEBUG after merge:  round=13 metric=0.7022 head_norm=0.923495 delta_norm=0.275350
[S11] aggregate: ACCEPT kept=['S15', 'S6'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=13 metric=0.7013 head_norm=1.117365
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.251787e-01
[S9] stored merged vector for next round verification (round=13)
[S9] DEBUG after merge:  round=13 metric=0.7013 head_norm=1.118201 delta_norm=0.125179
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=13 metric=0.3532 head_norm=1.018924
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.719599e-01
[S17] stored merged vector for next round verification (round=13)
[S17] DEBUG after merge:  round=13 metric=0.3530 head_norm=0.968647 delta_norm=0.171960
[S17] aggregate: ACCEPT kept=['S9', 'S16', 'S8'] (k=3/3) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.529585 cos_to_last_merge=0.8109 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.811
[S2] round=14 local utility u=0.000000 metrics={'f1_val': 0.7009652472052541, 'auprc': 0.6614774080729984, 'loss_val': 0.3055677820496519, 'psi': 0.6851701115523519}-{'f1_val': 0.7012347841865968, 'auprc': 0.6594392000951366, 'loss_val': 0.2879929971010112, 'psi': 0.6845165505500127}
[S3] START round=14 head_norm_before_train=1.132953 cos_to_last_merge=0.9984 (last merge round=12)
[S3] round=14 local utility u=0.035370 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9988301799908769, 'loss_val': 0.3883608770356022, 'psi': 0.8199857942375306}-{'f1_val': 0.7007562037352997, 'auprc': 0.9971426944174969, 'loss_val': 0.4540376259962065, 'psi': 0.8193108000081786}
[S4] START round=14 head_norm_before_train=1.014919 cos_to_last_merge=0.9920 (last merge round=12)
[S4] round=14 local utility u=0.000000 metrics={'f1_val': 0.9418858398492758, 'auprc': 0.9419475503264848, 'loss_val': 0.3067946838628178, 'psi': 0.9419105240401594}-{'f1_val': 0.9482054242791242, 'auprc': 0.960040858205361, 'loss_val': 0.3466002158517936, 'psi': 0.9529395978496189}
[S5] START round=14 head_norm_before_train=1.541446 (no previous merge yet)
[S5] round=14 local utility u=0.032071 metrics={'f1_val': 0.7011046720655897, 'auprc': 0.8022458739634026, 'loss_val': 0.3633555888816244, 'psi': 0.7415611528247148}-{'f1_val': 0.7011046720655897, 'auprc': 0.7945262728827664, 'loss_val': 0.40433823443036543, 'psi': 0.7384733123924604}
[S6] START round=14 head_norm_before_train=1.742829 (no previous merge yet)
[S6] round=14 local utility u=0.027330 metrics={'f1_val': 0.8443455752855912, 'auprc': 0.9601459345726846, 'loss_val': 0.27507498305874534, 'psi': 0.8906657190004286}-{'f1_val': 0.8449000629131588, 'auprc': 0.9462074002116121, 'loss_val': 0.2912456961713577, 'psi': 0.8854229978325401}
[S7] START round=14 head_norm_before_train=1.149043 cos_to_last_merge=0.9033 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.903
[S7] round=14 local utility u=0.000000 metrics={'f1_val': 0.401561130054904, 'auprc': 0.7719325674042945, 'loss_val': 0.9206548820294238, 'psi': 0.5497097049946602}-{'f1_val': 0.663626611246694, 'auprc': 0.8938120299069445, 'loss_val': 0.6492217392638604, 'psi': 0.7557007787107942}
[S8] START round=14 head_norm_before_train=1.838271 (no previous merge yet)
[S8] round=14 local utility u=0.000000 metrics={'f1_val': 0.8186133361053962, 'auprc': 0.98820302372577, 'loss_val': 0.1413332837688215, 'psi': 0.8864492111535457}-{'f1_val': 0.9937777583442691, 'auprc': 0.9885051802250819, 'loss_val': 0.06119702920714732, 'psi': 0.9916687270965943}
[S9] START round=14 head_norm_before_train=1.118201 cos_to_last_merge=1.0000 (last merge round=13)
[S9] round=14 local utility u=0.023504 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9983926728285615, 'loss_val': 0.42745088769196155, 'psi': 0.8201313592559627}-{'f1_val': 0.7012904835408967, 'auprc': 0.998384933171488, 'loss_val': 0.474436265287096, 'psi': 0.8201282633931333}
[S10] START round=14 head_norm_before_train=1.243226 cos_to_last_merge=0.9985 (last merge round=12)
[S10] round=14 local utility u=0.026299 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.9962096052235443, 'loss_val': 0.13218284052411844, 'psi': 0.9945434669819613}-{'f1_val': 0.9947723700160056, 'auprc': 0.9940236298862317, 'loss_val': 0.1862610659360026, 'psi': 0.994472873964096}
[S11] START round=14 head_norm_before_train=0.923495 cos_to_last_merge=1.0000 (last merge round=13)
[S11] round=14 local utility u=0.117875 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9742656824448945, 'loss_val': 0.7262393749419684, 'psi': 0.8107223607301127}-{'f1_val': 0.7017589383281313, 'auprc': 0.9061393731239111, 'loss_val': 0.7580038673712308, 'psi': 0.7835111122464433}
[S13] START round=14 head_norm_before_train=0.830645 cos_to_last_merge=1.0000 (last merge round=13)
[S13] round=14 local utility u=0.009104 metrics={'f1_val': 0.6069196913592598, 'auprc': 0.6842087343633672, 'loss_val': 0.7654692046325391, 'psi': 0.6378353085609028}-{'f1_val': 0.6169562897978147, 'auprc': 0.6617033006048603, 'loss_val': 0.7763801949249324, 'psi': 0.634855094120633}
[S14] START round=14 head_norm_before_train=1.132062 cos_to_last_merge=1.0000 (last merge round=13)
[S14] round=14 local utility u=0.202199 metrics={'f1_val': 0.9950155876264192, 'auprc': 0.9971572648602991, 'loss_val': 0.44752018073475924, 'psi': 0.9958722585199712}-{'f1_val': 0.9318652632945325, 'auprc': 0.9971599183328799, 'loss_val': 0.4730243624678998, 'psi': 0.9579831253098714}
[S15] START round=14 head_norm_before_train=1.135588 cos_to_last_merge=1.0000 (last merge round=13)
[S15] round=14 local utility u=0.000000 metrics={'f1_val': 0.6912071567626554, 'auprc': 0.8914199826380517, 'loss_val': 0.4702605975597884, 'psi': 0.771292287112814}-{'f1_val': 0.6942914040464104, 'auprc': 0.8935175360956614, 'loss_val': 0.46918728186908754, 'psi': 0.7739818568661109}
[S16] START round=14 head_norm_before_train=1.379009 cos_to_last_merge=0.8866 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.887
[S16] round=14 local utility u=0.128594 metrics={'f1_val': 0.9332015927525237, 'auprc': 0.9926332990516908, 'loss_val': 0.2900165483956581, 'psi': 0.9569742752721906}-{'f1_val': 0.9067041947539206, 'auprc': 0.9916531656230683, 'loss_val': 0.38527924686261245, 'psi': 0.9406837831015797}
[S17] START round=14 head_norm_before_train=0.968647 cos_to_last_merge=1.0000 (last merge round=13)
[S17] round=14 local utility u=0.000000 metrics={'f1_val': 0.3851497657971381, 'auprc': 0.710135547867829, 'loss_val': 0.9115949627651532, 'psi': 0.5151440786254144}-{'f1_val': 0.35317771804322007, 'auprc': 0.7853825803663889, 'loss_val': 0.9248972833120903, 'psi': 0.5260596629724876}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:33212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] → sending delta(kind=head bytes=1794) to S4@127.0.0.1:33204
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S14] → sending delta(kind=head bytes=1806) to S15@127.0.0.1:33215
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:33213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] → sending delta(kind=head bytes=1793) to S17@127.0.0.1:33217
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:33210
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S10] → sending delta(kind=head bytes=1790) to S3@127.0.0.1:33203
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:33216
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:33217
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1790 to 1 peers)
[S16] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1793 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1806 to 1 peers)
[S13] sending update (kind=head size=1794 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1796) from S11
[S13] cosine check vs S11: cos=0.7374
[S17] RECEIVED delta(kind=head bytes=1802) from S16
[S17] cosine check vs S16: cos=0.8106
[S17] RECEIVED delta(kind=head bytes=1793) from S9
[S17] cosine check vs S9: cos=0.8558
[S11] RECEIVED delta(kind=head bytes=1802) from S6
[S11] cosine check vs S6: cos=0.6814
[S16] RECEIVED delta(kind=head bytes=1802) from S5
[S16] cosine check vs S5: cos=-0.0406
[S16] DROPPED delta from S5 (cos=-0.0406 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1801) from S3
[S9] cosine check vs S3: cos=0.9815
[S15] RECEIVED delta(kind=head bytes=1806) from S14
[S15] cosine check vs S14: cos=0.9602
[S4] RECEIVED delta(kind=head bytes=1794) from S13
[S4] cosine check vs S13: cos=0.7683
[S3] RECEIVED delta(kind=head bytes=1790) from S10
[S3] cosine check vs S10: cos=0.9248
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=14 metric=0.9419 head_norm=1.131588
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.622443e-01
[S4] stored merged vector for next round verification (round=14)
[S4] DEBUG after merge:  round=14 metric=0.9418 head_norm=0.947490 delta_norm=0.362244
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=14 metric=0.7013 head_norm=1.168082
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.135319e-01
[S9] stored merged vector for next round verification (round=14)
[S9] DEBUG after merge:  round=14 metric=0.7013 head_norm=1.171154 delta_norm=0.113532
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=14 metric=0.7008 head_norm=1.185144
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.480331e-01
[S3] stored merged vector for next round verification (round=14)
[S3] DEBUG after merge:  round=14 metric=0.7020 head_norm=1.220307 delta_norm=0.248033
[S3] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=14 metric=0.6069 head_norm=0.881716
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.346805e-01
[S13] stored merged vector for next round verification (round=14)
[S13] DEBUG after merge:  round=14 metric=0.6066 head_norm=0.856369 delta_norm=0.334681
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=14 metric=0.7017 head_norm=0.955685
[S11] _apply_head_vector_avg (torch): Δ‖w‖=6.600941e-01
[S11] stored merged vector for next round verification (round=14)
[S11] DEBUG after merge:  round=14 metric=0.7019 head_norm=1.260490 delta_norm=0.660094
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=14 metric=0.6912 head_norm=1.225745
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.711747e-01
[S15] stored merged vector for next round verification (round=14)
[S15] DEBUG after merge:  round=14 metric=0.6910 head_norm=1.185170 delta_norm=0.171175
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=14 metric=0.3851 head_norm=1.026483
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.000116e-01
[S17] stored merged vector for next round verification (round=14)
[S17] DEBUG after merge:  round=14 metric=0.3712 head_norm=1.071387 delta_norm=0.200012
[S17] aggregate: ROLLBACK (f1_val pre=0.385 post=0.371 tol_abs=0.005 tol_rel=0.0)
[S2] START round=15 head_norm_before_train=1.551573 cos_to_last_merge=0.8105 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.810
[S2] round=15 local utility u=0.000000 metrics={'f1_val': 0.7012327640453476, 'auprc': 0.6634462907109697, 'loss_val': 0.32043332517273004, 'psi': 0.6861181747115965}-{'f1_val': 0.7009652472052541, 'auprc': 0.6614774080729984, 'loss_val': 0.3055677820496519, 'psi': 0.6851701115523519}
[S3] START round=15 head_norm_before_train=1.220307 cos_to_last_merge=1.0000 (last merge round=14)
[S3] round=15 local utility u=0.022526 metrics={'f1_val': 0.7030679722274212, 'auprc': 0.9986879902198119, 'loss_val': 0.3567531773545944, 'psi': 0.8213159794243776}-{'f1_val': 0.7007562037352997, 'auprc': 0.9988301799908769, 'loss_val': 0.3883608770356022, 'psi': 0.8199857942375306}
[S4] START round=15 head_norm_before_train=0.947490 cos_to_last_merge=1.0000 (last merge round=14)
[S4] round=15 local utility u=0.017982 metrics={'f1_val': 0.9442771585329173, 'auprc': 0.9572693596874701, 'loss_val': 0.3311442806986889, 'psi': 0.9494740389947384}-{'f1_val': 0.9418858398492758, 'auprc': 0.9419475503264848, 'loss_val': 0.3067946838628178, 'psi': 0.9419105240401594}
[S5] START round=15 head_norm_before_train=1.567618 (no previous merge yet)
[S5] round=15 local utility u=0.051447 metrics={'f1_val': 0.7008563225598777, 'auprc': 0.8292289641782035, 'loss_val': 0.3399214103328482, 'psi': 0.7522053792072081}-{'f1_val': 0.7011046720655897, 'auprc': 0.8022458739634026, 'loss_val': 0.3633555888816244, 'psi': 0.7415611528247148}
[S6] START round=15 head_norm_before_train=1.770815 (no previous merge yet)
[S6] round=15 local utility u=0.000000 metrics={'f1_val': 0.7323621323513554, 'auprc': 0.8803917553490449, 'loss_val': 0.5652725145562627, 'psi': 0.7915739815504312}-{'f1_val': 0.8443455752855912, 'auprc': 0.9601459345726846, 'loss_val': 0.27507498305874534, 'psi': 0.8906657190004286}
[S7] START round=15 head_norm_before_train=1.181945 cos_to_last_merge=0.8946 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.895
[S7] round=15 local utility u=0.999937 metrics={'f1_val': 0.6651546416598052, 'auprc': 0.802466921813039, 'loss_val': 0.593945766596207, 'psi': 0.7200795537210988}-{'f1_val': 0.401561130054904, 'auprc': 0.7719325674042945, 'loss_val': 0.9206548820294238, 'psi': 0.5497097049946602}
[S8] START round=15 head_norm_before_train=1.865480 (no previous merge yet)
[S8] round=15 local utility u=0.567283 metrics={'f1_val': 0.9936566772467331, 'auprc': 0.9883507791133983, 'loss_val': 0.05746986318590197, 'psi': 0.9915343179933992}-{'f1_val': 0.8186133361053962, 'auprc': 0.98820302372577, 'loss_val': 0.1413332837688215, 'psi': 0.8864492111535457}
[S9] START round=15 head_norm_before_train=1.171154 cos_to_last_merge=1.0000 (last merge round=14)
[S9] round=15 local utility u=0.019280 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9985913026960345, 'loss_val': 0.38948669126540447, 'psi': 0.8202108112029518}-{'f1_val': 0.7012904835408967, 'auprc': 0.9983926728285615, 'loss_val': 0.42745088769196155, 'psi': 0.8201313592559627}
[S10] START round=15 head_norm_before_train=1.302603 cos_to_last_merge=0.9943 (last merge round=12)
[S10] round=15 local utility u=0.019824 metrics={'f1_val': 0.993871046050545, 'auprc': 0.9966666541358942, 'loss_val': 0.09653685066443195, 'psi': 0.9949892892846847}-{'f1_val': 0.9934327081542391, 'auprc': 0.9962096052235443, 'loss_val': 0.13218284052411844, 'psi': 0.9945434669819613}
[S11] START round=15 head_norm_before_train=1.260490 cos_to_last_merge=1.0000 (last merge round=14)
[S11] round=15 local utility u=0.077233 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9870346056446351, 'loss_val': 0.6115319437680636, 'psi': 0.8159750322368461}-{'f1_val': 0.7016934795869249, 'auprc': 0.9742656824448945, 'loss_val': 0.7262393749419684, 'psi': 0.8107223607301127}
[S13] START round=15 head_norm_before_train=0.856369 cos_to_last_merge=1.0000 (last merge round=14)
[S13] round=15 local utility u=0.018395 metrics={'f1_val': 0.6107863288392709, 'auprc': 0.6834473878948337, 'loss_val': 0.7495945366201809, 'psi': 0.639850752461496}-{'f1_val': 0.6069196913592598, 'auprc': 0.6842087343633672, 'loss_val': 0.7654692046325391, 'psi': 0.6378353085609028}
[S14] START round=15 head_norm_before_train=1.168506 cos_to_last_merge=0.9988 (last merge round=13)
[S14] round=15 local utility u=0.044712 metrics={'f1_val': 0.9947547728438211, 'auprc': 0.9967412558374478, 'loss_val': 0.355283293737472, 'psi': 0.9955493660412718}-{'f1_val': 0.9950155876264192, 'auprc': 0.9971572648602991, 'loss_val': 0.44752018073475924, 'psi': 0.9958722585199712}
[S15] START round=15 head_norm_before_train=1.185170 cos_to_last_merge=1.0000 (last merge round=14)
[S15] round=15 local utility u=1.000000 metrics={'f1_val': 0.9836073118477493, 'auprc': 0.9893885237612907, 'loss_val': 0.24616814302401024, 'psi': 0.9859197966131659}-{'f1_val': 0.6912071567626554, 'auprc': 0.8914199826380517, 'loss_val': 0.4702605975597884, 'psi': 0.771292287112814}
[S16] START round=15 head_norm_before_train=1.429695 cos_to_last_merge=0.8782 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.878
[S16] round=15 local utility u=0.010867 metrics={'f1_val': 0.9317201086943272, 'auprc': 0.997505662256279, 'loss_val': 0.27401133384870147, 'psi': 0.9580343301191079}-{'f1_val': 0.9332015927525237, 'auprc': 0.9926332990516908, 'loss_val': 0.2900165483956581, 'psi': 0.9569742752721906}
[S17] START round=15 head_norm_before_train=1.071387 cos_to_last_merge=1.0000 (last merge round=14)
[S17] round=15 local utility u=0.114847 metrics={'f1_val': 0.3636016712976184, 'auprc': 0.8112308689225176, 'loss_val': 0.8558988803299629, 'psi': 0.5426533503475781}-{'f1_val': 0.3851497657971381, 'auprc': 0.710135547867829, 'loss_val': 0.9115949627651532, 'psi': 0.5151440786254144}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:33213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:33211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] → sending delta(kind=head bytes=1806) to S4@127.0.0.1:33204
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:33216
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:33210
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:33217
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:33212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:33215
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:33217
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:33217
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:33214
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:33203
[S16] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1806 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1801) from S9
[S17] cosine check vs S9: cos=0.8652
[S17] RECEIVED delta(kind=head bytes=1800) from S8
[S17] cosine check vs S8: cos=0.0905
[S16] RECEIVED delta(kind=head bytes=1798) from S5
[S16] cosine check vs S5: cos=-0.0402
[S16] DROPPED delta from S5 (cos=-0.0402 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1800) from S11
[S13] cosine check vs S11: cos=0.7630
[S9] RECEIVED delta(kind=head bytes=1802) from S3
[S9] cosine check vs S3: cos=0.9638
[S14] RECEIVED delta(kind=head bytes=1801) from S7
[S14] cosine check vs S7: cos=0.9700
[S15] RECEIVED delta(kind=head bytes=1803) from S14
[S15] cosine check vs S14: cos=0.9731
[S4] RECEIVED delta(kind=head bytes=1806) from S13
[S4] cosine check vs S13: cos=0.8264
[S10] RECEIVED delta(kind=head bytes=1800) from S4
[S10] cosine check vs S4: cos=0.7959
[S17] RECEIVED delta(kind=head bytes=1799) from S16
[S17] cosine check vs S16: cos=0.8551
[S3] RECEIVED delta(kind=head bytes=1798) from S10
[S3] cosine check vs S10: cos=0.9752
[S11] RECEIVED delta(kind=head bytes=1799) from S15
[S11] cosine check vs S15: cos=0.1923
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:33203
[S17] sending update (kind=head size=1802 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1802) from S17
[S3] cosine check vs S17: cos=0.7998
[S2] ⇄ pheromone p=0.078 → S13@127.0.0.1:33213
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=15 metric=0.7031 head_norm=1.267973
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.622606e-01
[S3] stored merged vector for next round verification (round=15)
[S3] DEBUG after merge:  round=15 metric=0.7031 head_norm=1.200581 delta_norm=0.162261
[S3] aggregate: ACCEPT kept=['S10', 'S17'] (k=2/2) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.246 → S9@127.0.0.1:33210
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=15 metric=0.9443 head_norm=1.044965
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.952207e-01
[S4] stored merged vector for next round verification (round=15)
[S4] DEBUG after merge:  round=15 metric=0.9443 head_norm=0.935943 delta_norm=0.295221
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.117 → S10@127.0.0.1:33211
[S6] ⇄ pheromone p=0.276 → S11@127.0.0.1:33212
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=15 metric=0.7013 head_norm=1.219581
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.691431e-01
[S9] stored merged vector for next round verification (round=15)
[S9] DEBUG after merge:  round=15 metric=0.7013 head_norm=1.232460 delta_norm=0.169143
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.196 → S17@127.0.0.1:33217
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=15 metric=0.9939 head_norm=1.367351
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.145077e-01
[S10] stored merged vector for next round verification (round=15)
[S10] DEBUG after merge:  round=15 metric=0.9934 head_norm=1.144109 delta_norm=0.414508
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.206 → S3@127.0.0.1:33203
[S7] ⇄ pheromone p=0.375 → S14@127.0.0.1:33214
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=15 metric=0.9948 head_norm=1.206959
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.479334e-01
[S14] stored merged vector for next round verification (round=15)
[S14] DEBUG after merge:  round=15 metric=0.9944 head_norm=1.199196 delta_norm=0.147933
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.299 → S15@127.0.0.1:33215
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=15 metric=0.9836 head_norm=1.259777
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.453837e-01
[S15] stored merged vector for next round verification (round=15)
[S15] DEBUG after merge:  round=15 metric=0.9827 head_norm=1.225054 delta_norm=0.145384
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.329 → S11@127.0.0.1:33212
[S16] ⇄ pheromone p=0.280 → S17@127.0.0.1:33217
[S8] ⇄ pheromone p=0.442 → S17@127.0.0.1:33217
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=15 metric=0.7019 head_norm=1.291204
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.106626e-01
[S11] stored merged vector for next round verification (round=15)
[S11] DEBUG after merge:  round=15 metric=0.5863 head_norm=0.984861 delta_norm=0.810663
[S11] aggregate: ROLLBACK (f1_val pre=0.702 post=0.586 tol_abs=0.005 tol_rel=0.0)
[S11] ⇄ pheromone p=0.260 → S13@127.0.0.1:33213
[S5] ⇄ pheromone p=0.141 → S16@127.0.0.1:33216
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=15 metric=0.6108 head_norm=0.913421
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.188712e-01
[S13] stored merged vector for next round verification (round=15)
[S13] DEBUG after merge:  round=15 metric=0.6120 head_norm=1.036976 delta_norm=0.418871
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.083 → S4@127.0.0.1:33204
[S17] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=15 metric=0.3636 head_norm=1.123567
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.587952e-01
[S17] stored merged vector for next round verification (round=15)
[S17] DEBUG after merge:  round=15 metric=0.3871 head_norm=1.064758 delta_norm=0.158795
[S17] aggregate: ACCEPT kept=['S9', 'S8', 'S16'] (k=3/3) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.114 → S3@127.0.0.1:33203
[S2] START round=16 head_norm_before_train=1.567035 cos_to_last_merge=0.8090 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.809
[S2] round=16 local utility u=0.034185 metrics={'f1_val': 0.707283740924547, 'auprc': 0.7793804440589669, 'loss_val': 0.6361725874213202, 'psi': 0.7361224221783149}-{'f1_val': 0.7012327640453476, 'auprc': 0.6634462907109697, 'loss_val': 0.32043332517273004, 'psi': 0.6861181747115965}
[S3] START round=16 head_norm_before_train=1.200581 cos_to_last_merge=1.0000 (last merge round=15)
[S3] round=16 local utility u=0.004141 metrics={'f1_val': 0.703143065141181, 'auprc': 0.9993808706848644, 'loss_val': 0.3509997623009092, 'psi': 0.8216381873586543}-{'f1_val': 0.7030679722274212, 'auprc': 0.9986879902198119, 'loss_val': 0.3567531773545944, 'psi': 0.8213159794243776}
[S4] START round=16 head_norm_before_train=0.935943 cos_to_last_merge=1.0000 (last merge round=15)
[S4] round=16 local utility u=0.000000 metrics={'f1_val': 0.9404416818549663, 'auprc': 0.9555293036793575, 'loss_val': 0.3681582382285486, 'psi': 0.9464767305847228}-{'f1_val': 0.9442771585329173, 'auprc': 0.9572693596874701, 'loss_val': 0.3311442806986889, 'psi': 0.9494740389947384}
[S5] START round=16 head_norm_before_train=1.594102 (no previous merge yet)
[S5] round=16 local utility u=0.000000 metrics={'f1_val': 0.7006466032507462, 'auprc': 0.8021584665081914, 'loss_val': 0.3498157783206835, 'psi': 0.7412513485537244}-{'f1_val': 0.7008563225598777, 'auprc': 0.8292289641782035, 'loss_val': 0.3399214103328482, 'psi': 0.7522053792072081}
[S6] START round=16 head_norm_before_train=1.786982 (no previous merge yet)
[S6] round=16 local utility u=0.132135 metrics={'f1_val': 0.7484406789186671, 'auprc': 0.9373467107336549, 'loss_val': 0.5683378956515805, 'psi': 0.8240030916446622}-{'f1_val': 0.7323621323513554, 'auprc': 0.8803917553490449, 'loss_val': 0.5652725145562627, 'psi': 0.7915739815504312}
[S7] START round=16 head_norm_before_train=1.209613 cos_to_last_merge=0.8877 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.888
[S7] round=16 local utility u=0.199063 metrics={'f1_val': 0.6760545435049041, 'auprc': 0.8727353947553149, 'loss_val': 0.4720253572272547, 'psi': 0.7547268840050685}-{'f1_val': 0.6651546416598052, 'auprc': 0.802466921813039, 'loss_val': 0.593945766596207, 'psi': 0.7200795537210988}
[S8] START round=16 head_norm_before_train=1.893747 (no previous merge yet)
[S8] round=16 local utility u=0.000000 metrics={'f1_val': 0.9915895183459548, 'auprc': 0.9879846848324316, 'loss_val': 0.049116252066365246, 'psi': 0.9901475849405456}-{'f1_val': 0.9936566772467331, 'auprc': 0.9883507791133983, 'loss_val': 0.05746986318590197, 'psi': 0.9915343179933992}
[S9] START round=16 head_norm_before_train=1.232460 cos_to_last_merge=1.0000 (last merge round=15)
[S9] round=16 local utility u=0.000000 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.690852080392673, 'loss_val': 0.3777612598493791, 'psi': 0.6971151222816072}-{'f1_val': 0.7012904835408967, 'auprc': 0.9985913026960345, 'loss_val': 0.38948669126540447, 'psi': 0.8202108112029518}
[S10] START round=16 head_norm_before_train=1.144109 cos_to_last_merge=1.0000 (last merge round=15)
[S10] round=16 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9964288638380775, 'loss_val': 0.14238571609024003, 'psi': 0.9955524574542767}-{'f1_val': 0.993871046050545, 'auprc': 0.9966666541358942, 'loss_val': 0.09653685066443195, 'psi': 0.9949892892846847}
[S11] START round=16 head_norm_before_train=0.984861 cos_to_last_merge=1.0000 (last merge round=15)
[S11] round=16 local utility u=0.000000 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9845016290291696, 'loss_val': 0.6647767716542833, 'psi': 0.8148167393638228}-{'f1_val': 0.7019353166316534, 'auprc': 0.9870346056446351, 'loss_val': 0.6115319437680636, 'psi': 0.8159750322368461}
[S13] START round=16 head_norm_before_train=1.036976 cos_to_last_merge=1.0000 (last merge round=15)
[S13] round=16 local utility u=0.062500 metrics={'f1_val': 0.628527853231808, 'auprc': 0.662750122478496, 'loss_val': 0.6689514454698169, 'psi': 0.6422167609304832}-{'f1_val': 0.6107863288392709, 'auprc': 0.6834473878948337, 'loss_val': 0.7495945366201809, 'psi': 0.639850752461496}
[S14] START round=16 head_norm_before_train=1.199196 cos_to_last_merge=1.0000 (last merge round=15)
[S14] round=16 local utility u=0.000000 metrics={'f1_val': 0.9628946433839602, 'auprc': 0.9987596024843247, 'loss_val': 0.31280725419498073, 'psi': 0.9772406270241061}-{'f1_val': 0.9947547728438211, 'auprc': 0.9967412558374478, 'loss_val': 0.355283293737472, 'psi': 0.9955493660412718}
[S15] START round=16 head_norm_before_train=1.225054 cos_to_last_merge=1.0000 (last merge round=15)
[S15] round=16 local utility u=0.000000 metrics={'f1_val': 0.9808222346310567, 'auprc': 0.9905170808350351, 'loss_val': 0.2396920686568235, 'psi': 0.9847001731126481}-{'f1_val': 0.9836073118477493, 'auprc': 0.9893885237612907, 'loss_val': 0.24616814302401024, 'psi': 0.9859197966131659}
[S16] START round=16 head_norm_before_train=1.476691 cos_to_last_merge=0.8712 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.871
[S16] round=16 local utility u=0.000000 metrics={'f1_val': 0.91524556437175, 'auprc': 0.997501692403638, 'loss_val': 0.3168550863690293, 'psi': 0.9481480155845052}-{'f1_val': 0.9317201086943272, 'auprc': 0.997505662256279, 'loss_val': 0.27401133384870147, 'psi': 0.9580343301191079}
[S17] START round=16 head_norm_before_train=1.064758 cos_to_last_merge=1.0000 (last merge round=15)
[S17] round=16 local utility u=0.268367 metrics={'f1_val': 0.41784716386688037, 'auprc': 0.8866679668619459, 'loss_val': 0.870950009337211, 'psi': 0.6053754850649066}-{'f1_val': 0.3636016712976184, 'auprc': 0.8112308689225176, 'loss_val': 0.8558988803299629, 'psi': 0.5426533503475781}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:33212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:33204
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:33213
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:33210
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:33214
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1798) from S3
[S9] cosine check vs S3: cos=0.9839
[S11] RECEIVED delta(kind=head bytes=1798) from S6
[S11] cosine check vs S6: cos=0.5898
[S14] RECEIVED delta(kind=head bytes=1803) from S7
[S14] cosine check vs S7: cos=0.9846
[S13] RECEIVED delta(kind=head bytes=1801) from S2
[S13] cosine check vs S2: cos=0.2047
[S4] RECEIVED delta(kind=head bytes=1799) from S13
[S4] cosine check vs S13: cos=0.8189
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:33203
[S17] sending update (kind=head size=1799 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1799) from S17
[S3] cosine check vs S17: cos=0.8655
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=16 metric=0.7017 head_norm=1.011537
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.269198e-01
[S11] stored merged vector for next round verification (round=16)
[S11] DEBUG after merge:  round=16 metric=0.7017 head_norm=1.265624 delta_norm=0.726920
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=16 metric=0.9629 head_norm=1.241419
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.088945e-01
[S14] stored merged vector for next round verification (round=16)
[S14] DEBUG after merge:  round=16 metric=0.9559 head_norm=1.235511 delta_norm=0.108895
[S14] aggregate: ROLLBACK (f1_val pre=0.963 post=0.956 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=16 metric=0.7013 head_norm=1.276915
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.144668e-01
[S9] stored merged vector for next round verification (round=16)
[S9] DEBUG after merge:  round=16 metric=0.7013 head_norm=1.254646 delta_norm=0.114467
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=16 metric=0.9404 head_norm=1.031473
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.207647e-01
[S4] stored merged vector for next round verification (round=16)
[S4] DEBUG after merge:  round=16 metric=0.9405 head_norm=1.012480 delta_norm=0.320765
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=16 metric=0.6285 head_norm=1.091822
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.651968e-01
[S13] stored merged vector for next round verification (round=16)
[S13] DEBUG after merge:  round=16 metric=0.6105 head_norm=1.050105 delta_norm=0.865197
[S13] aggregate: ROLLBACK (f1_val pre=0.629 post=0.611 tol_abs=0.005 tol_rel=0.0)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=16 metric=0.7031 head_norm=1.242565
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.117707e-01
[S3] stored merged vector for next round verification (round=16)
[S3] DEBUG after merge:  round=16 metric=0.7020 head_norm=1.137898 delta_norm=0.311771
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.584454 cos_to_last_merge=0.8060 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.806
[S2] round=17 local utility u=0.000000 metrics={'f1_val': 0.588283451216648, 'auprc': 0.6246589593112009, 'loss_val': 0.7349248560842249, 'psi': 0.6028336544544692}-{'f1_val': 0.707283740924547, 'auprc': 0.7793804440589669, 'loss_val': 0.6361725874213202, 'psi': 0.7361224221783149}
[S3] START round=17 head_norm_before_train=1.137898 cos_to_last_merge=1.0000 (last merge round=16)
[S3] round=17 local utility u=0.000000 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9989709148537536, 'loss_val': 0.3376333763247744, 'psi': 0.8199969417407023}-{'f1_val': 0.703143065141181, 'auprc': 0.9993808706848644, 'loss_val': 0.3509997623009092, 'psi': 0.8216381873586543}
[S4] START round=17 head_norm_before_train=1.012480 cos_to_last_merge=1.0000 (last merge round=16)
[S4] round=17 local utility u=0.020058 metrics={'f1_val': 0.9426695511014678, 'auprc': 0.9553949081541739, 'loss_val': 0.34100558410726084, 'psi': 0.9477596939225502}-{'f1_val': 0.9404416818549663, 'auprc': 0.9555293036793575, 'loss_val': 0.3681582382285486, 'psi': 0.9464767305847228}
[S5] START round=17 head_norm_before_train=1.616328 (no previous merge yet)
[S5] round=17 local utility u=0.185317 metrics={'f1_val': 0.7006090940057808, 'auprc': 0.9146434522457363, 'loss_val': 0.31641238954667283, 'psi': 0.786222837301763}-{'f1_val': 0.7006466032507462, 'auprc': 0.8021584665081914, 'loss_val': 0.3498157783206835, 'psi': 0.7412513485537244}
[S6] START round=17 head_norm_before_train=1.799229 (no previous merge yet)
[S6] round=17 local utility u=0.550089 metrics={'f1_val': 0.8712458708279247, 'auprc': 0.969254817798169, 'loss_val': 0.3007147268810982, 'psi': 0.9104494496160225}-{'f1_val': 0.7484406789186671, 'auprc': 0.9373467107336549, 'loss_val': 0.5683378956515805, 'psi': 0.8240030916446622}
[S7] START round=17 head_norm_before_train=1.239181 cos_to_last_merge=0.8812 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.881
[S7] round=17 local utility u=0.000000 metrics={'f1_val': 0.47933712363731296, 'auprc': 0.7725501162678305, 'loss_val': 0.9499246440702553, 'psi': 0.59662232068952}-{'f1_val': 0.6760545435049041, 'auprc': 0.8727353947553149, 'loss_val': 0.4720253572272547, 'psi': 0.7547268840050685}
[S8] START round=17 head_norm_before_train=1.919847 (no previous merge yet)
[S8] round=17 local utility u=0.009157 metrics={'f1_val': 0.9936566772467331, 'auprc': 0.9882910371950865, 'loss_val': 0.04412520315868054, 'psi': 0.9915104212260745}-{'f1_val': 0.9915895183459548, 'auprc': 0.9879846848324316, 'loss_val': 0.049116252066365246, 'psi': 0.9901475849405456}
[S9] START round=17 head_norm_before_train=1.254646 cos_to_last_merge=1.0000 (last merge round=16)
[S9] round=17 local utility u=0.474130 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9983437647386715, 'loss_val': 0.3519759765721329, 'psi': 0.8201117960200066}-{'f1_val': 0.7012904835408967, 'auprc': 0.690852080392673, 'loss_val': 0.3777612598493791, 'psi': 0.6971151222816072}
[S10] START round=17 head_norm_before_train=1.220003 cos_to_last_merge=0.9968 (last merge round=15)
[S10] round=17 local utility u=0.026945 metrics={'f1_val': 0.9951633020469546, 'auprc': 0.9966160136742078, 'loss_val': 0.0902279156322851, 'psi': 0.9957443866978559}-{'f1_val': 0.9949681865317428, 'auprc': 0.9964288638380775, 'loss_val': 0.14238571609024003, 'psi': 0.9955524574542767}
[S11] START round=17 head_norm_before_train=1.265624 cos_to_last_merge=1.0000 (last merge round=16)
[S11] round=17 local utility u=0.084555 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9959471246757174, 'loss_val': 0.5314547594280182, 'psi': 0.819540039849279}-{'f1_val': 0.7016934795869249, 'auprc': 0.9845016290291696, 'loss_val': 0.6647767716542833, 'psi': 0.8148167393638228}
[S13] START round=17 head_norm_before_train=1.050105 cos_to_last_merge=1.0000 (last merge round=16)
[S13] round=17 local utility u=0.000000 metrics={'f1_val': 0.6005182513771556, 'auprc': 0.666013877526564, 'loss_val': 0.8690673428757998, 'psi': 0.626716501836919}-{'f1_val': 0.628527853231808, 'auprc': 0.662750122478496, 'loss_val': 0.6689514454698169, 'psi': 0.6422167609304832}
[S14] START round=17 head_norm_before_train=1.235511 cos_to_last_merge=1.0000 (last merge round=16)
[S14] round=17 local utility u=0.113826 metrics={'f1_val': 0.9970616270651818, 'auprc': 0.9987644366193336, 'loss_val': 0.29017234897356314, 'psi': 0.9977427508868424}-{'f1_val': 0.9628946433839602, 'auprc': 0.9987596024843247, 'loss_val': 0.31280725419498073, 'psi': 0.9772406270241061}
[S15] START round=17 head_norm_before_train=1.285751 cos_to_last_merge=0.9972 (last merge round=15)
[S15] round=17 local utility u=0.000000 metrics={'f1_val': 0.684743553553813, 'auprc': 0.9631114732196631, 'loss_val': 0.45966329581877163, 'psi': 0.796090721420153}-{'f1_val': 0.9808222346310567, 'auprc': 0.9905170808350351, 'loss_val': 0.2396920686568235, 'psi': 0.9847001731126481}
[S16] START round=17 head_norm_before_train=1.518144 cos_to_last_merge=0.8659 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.866
[S16] round=17 local utility u=0.302226 metrics={'f1_val': 0.9875565113916616, 'auprc': 0.9910956305706866, 'loss_val': 0.1270506718265988, 'psi': 0.9889721590632716}-{'f1_val': 0.91524556437175, 'auprc': 0.997501692403638, 'loss_val': 0.3168550863690293, 'psi': 0.9481480155845052}
[S17] START round=17 head_norm_before_train=1.113578 cos_to_last_merge=0.9969 (last merge round=15)
[S17] round=17 local utility u=1.000000 metrics={'f1_val': 0.8190402150282914, 'auprc': 0.968011828630035, 'loss_val': 0.7987057960789985, 'psi': 0.8786288604689888}-{'f1_val': 0.41784716386688037, 'auprc': 0.8866679668619459, 'loss_val': 0.870950009337211, 'psi': 0.6053754850649066}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:33216
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:33217
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:33217
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:33212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:33211
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:33217
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:33203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:33215
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S13@127.0.0.1:33213
[S11] sending update (kind=head size=1794 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1794) from S11
[S13] cosine check vs S11: cos=0.5181
[S17] RECEIVED delta(kind=head bytes=1796) from S8
[S17] cosine check vs S8: cos=0.1921
[S17] RECEIVED delta(kind=head bytes=1797) from S9
[S17] cosine check vs S9: cos=0.8449
[S17] RECEIVED delta(kind=head bytes=1799) from S16
[S17] cosine check vs S16: cos=0.8125
[S16] RECEIVED delta(kind=head bytes=1801) from S5
[S16] cosine check vs S5: cos=-0.0377
[S16] DROPPED delta from S5 (cos=-0.0377 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1803) from S14
[S15] cosine check vs S14: cos=0.9575
[S11] RECEIVED delta(kind=head bytes=1800) from S6
[S11] cosine check vs S6: cos=0.9392
[S10] RECEIVED delta(kind=head bytes=1798) from S4
[S10] cosine check vs S4: cos=0.7935
[S3] RECEIVED delta(kind=head bytes=1799) from S10
[S3] cosine check vs S10: cos=0.8395
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S3@127.0.0.1:33203
[S17] sending update (kind=head size=1804 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1804) from S17
[S3] cosine check vs S17: cos=0.9485
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=17 metric=0.7007 head_norm=1.184707
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.312054e-01
[S3] stored merged vector for next round verification (round=17)
[S3] DEBUG after merge:  round=17 metric=0.7019 head_norm=1.151236 delta_norm=0.131205
[S3] aggregate: ACCEPT kept=['S10', 'S17'] (k=2/2) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=17 metric=0.6005 head_norm=1.100648
[S13] _apply_head_vector_avg (torch): Δ‖w‖=5.940107e-01
[S13] stored merged vector for next round verification (round=17)
[S13] DEBUG after merge:  round=17 metric=0.6030 head_norm=1.044691 delta_norm=0.594011
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=17 metric=0.6847 head_norm=1.341846
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.937090e-01
[S15] stored merged vector for next round verification (round=17)
[S15] DEBUG after merge:  round=17 metric=0.6839 head_norm=1.293531 delta_norm=0.193709
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=17 metric=0.9952 head_norm=1.311611
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.008087e-01
[S10] stored merged vector for next round verification (round=17)
[S10] DEBUG after merge:  round=17 metric=0.9947 head_norm=1.148923 delta_norm=0.400809
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=17 metric=0.7019 head_norm=1.295002
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.739161e-01
[S11] stored merged vector for next round verification (round=17)
[S11] DEBUG after merge:  round=17 metric=0.7019 head_norm=1.533145 delta_norm=0.373916
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=17 metric=0.8190 head_norm=1.167466
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.663854e-01
[S17] stored merged vector for next round verification (round=17)
[S17] DEBUG after merge:  round=17 metric=0.6068 head_norm=1.113716 delta_norm=0.166385
[S17] aggregate: ROLLBACK (f1_val pre=0.819 post=0.607 tol_abs=0.005 tol_rel=0.0)
[S2] START round=18 head_norm_before_train=1.599737 cos_to_last_merge=0.8039 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.804
[S2] round=18 local utility u=0.587991 metrics={'f1_val': 0.70163055750362, 'auprc': 0.6661405433419163, 'loss_val': 0.3634706575500378, 'psi': 0.6874345518389385}-{'f1_val': 0.588283451216648, 'auprc': 0.6246589593112009, 'loss_val': 0.7349248560842249, 'psi': 0.6028336544544692}
[S3] START round=18 head_norm_before_train=1.151236 cos_to_last_merge=1.0000 (last merge round=17)
[S3] round=18 local utility u=0.901358 metrics={'f1_val': 0.9973136868485526, 'auprc': 0.9960101671124646, 'loss_val': 0.30583123177774924, 'psi': 0.9967922789541174}-{'f1_val': 0.7006809596653347, 'auprc': 0.9989709148537536, 'loss_val': 0.3376333763247744, 'psi': 0.8199969417407023}
[S4] START round=18 head_norm_before_train=1.114011 cos_to_last_merge=0.9871 (last merge round=16)
[S4] round=18 local utility u=0.026605 metrics={'f1_val': 0.943836984472798, 'auprc': 0.9561694133002925, 'loss_val': 0.297122768988259, 'psi': 0.9487699560037957}-{'f1_val': 0.9426695511014678, 'auprc': 0.9553949081541739, 'loss_val': 0.34100558410726084, 'psi': 0.9477596939225502}
[S5] START round=18 head_norm_before_train=1.632472 (no previous merge yet)
[S5] round=18 local utility u=0.033341 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9360988149882472, 'loss_val': 0.3140918275820639, 'psi': 0.7948045615929035}-{'f1_val': 0.7006090940057808, 'auprc': 0.9146434522457363, 'loss_val': 0.31641238954667283, 'psi': 0.786222837301763}
[S6] START round=18 head_norm_before_train=1.817599 (no previous merge yet)
[S6] round=18 local utility u=0.000000 metrics={'f1_val': 0.8481625124730691, 'auprc': 0.9603690597583584, 'loss_val': 0.24832655827811323, 'psi': 0.8930451313871848}-{'f1_val': 0.8712458708279247, 'auprc': 0.969254817798169, 'loss_val': 0.3007147268810982, 'psi': 0.9104494496160225}
[S7] START round=18 head_norm_before_train=1.262266 cos_to_last_merge=0.8757 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.876
[S7] round=18 local utility u=0.651442 metrics={'f1_val': 0.6314207433484942, 'auprc': 0.7910703433376488, 'loss_val': 0.615102416619587, 'psi': 0.695280583344156}-{'f1_val': 0.47933712363731296, 'auprc': 0.7725501162678305, 'loss_val': 0.9499246440702553, 'psi': 0.59662232068952}
[S8] START round=18 head_norm_before_train=1.943725 (no previous merge yet)
[S8] round=18 local utility u=0.000000 metrics={'f1_val': 0.970775898214988, 'auprc': 0.989157992270685, 'loss_val': 0.09413719360504534, 'psi': 0.9781287358372668}-{'f1_val': 0.9936566772467331, 'auprc': 0.9882910371950865, 'loss_val': 0.04412520315868054, 'psi': 0.9915104212260745}
[S9] START round=18 head_norm_before_train=1.296577 cos_to_last_merge=0.9979 (last merge round=16)
[S9] round=18 local utility u=0.016748 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.998621743851982, 'loss_val': 0.3193131251085246, 'psi': 0.8202229876653309}-{'f1_val': 0.7012904835408967, 'auprc': 0.9983437647386715, 'loss_val': 0.3519759765721329, 'psi': 0.8201117960200066}
[S10] START round=18 head_norm_before_train=1.148923 cos_to_last_merge=1.0000 (last merge round=17)
[S10] round=18 local utility u=0.000000 metrics={'f1_val': 0.993871046050545, 'auprc': 0.9952448374600587, 'loss_val': 0.1361083743095736, 'psi': 0.9944205626143504}-{'f1_val': 0.9951633020469546, 'auprc': 0.9966160136742078, 'loss_val': 0.0902279156322851, 'psi': 0.9957443866978559}
[S11] START round=18 head_norm_before_train=1.533145 cos_to_last_merge=1.0000 (last merge round=17)
[S11] round=18 local utility u=0.064507 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9978834821303896, 'loss_val': 0.408249389406478, 'psi': 0.8203145828311479}-{'f1_val': 0.7019353166316534, 'auprc': 0.9959471246757174, 'loss_val': 0.5314547594280182, 'psi': 0.819540039849279}
[S13] START round=18 head_norm_before_train=1.044691 cos_to_last_merge=1.0000 (last merge round=17)
[S13] round=18 local utility u=0.120728 metrics={'f1_val': 0.6126636651476295, 'auprc': 0.6775316903523005, 'loss_val': 0.7350373438187037, 'psi': 0.6386108752294979}-{'f1_val': 0.6005182513771556, 'auprc': 0.666013877526564, 'loss_val': 0.8690673428757998, 'psi': 0.626716501836919}
[S14] START round=18 head_norm_before_train=1.273161 cos_to_last_merge=0.9986 (last merge round=16)
[S14] round=18 local utility u=0.026495 metrics={'f1_val': 0.9975054147531532, 'auprc': 0.9988550288891757, 'loss_val': 0.24011644216054234, 'psi': 0.9980452604075621}-{'f1_val': 0.9970616270651818, 'auprc': 0.9987644366193336, 'loss_val': 0.29017234897356314, 'psi': 0.9977427508868424}
[S15] START round=18 head_norm_before_train=1.293531 cos_to_last_merge=1.0000 (last merge round=17)
[S15] round=18 local utility u=0.224596 metrics={'f1_val': 0.731956597750332, 'auprc': 0.9800981722558708, 'loss_val': 0.3447087368748805, 'psi': 0.8312132275525475}-{'f1_val': 0.684743553553813, 'auprc': 0.9631114732196631, 'loss_val': 0.45966329581877163, 'psi': 0.796090721420153}
[S16] START round=18 head_norm_before_train=1.556704 cos_to_last_merge=0.8620 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.862
[S16] round=18 local utility u=0.000000 metrics={'f1_val': 0.914930972681548, 'auprc': 0.9912233434284305, 'loss_val': 0.3460551824321076, 'psi': 0.9454479209803011}-{'f1_val': 0.9875565113916616, 'auprc': 0.9910956305706866, 'loss_val': 0.1270506718265988, 'psi': 0.9889721590632716}
[S17] START round=18 head_norm_before_train=1.113716 cos_to_last_merge=1.0000 (last merge round=17)
[S17] round=18 local utility u=0.298246 metrics={'f1_val': 0.9131976671766656, 'auprc': 0.9682576305743116, 'loss_val': 0.7678964147107725, 'psi': 0.935221652535724}-{'f1_val': 0.8190402150282914, 'auprc': 0.968011828630035, 'loss_val': 0.7987057960789985, 'psi': 0.8786288604689888}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:33213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:33217
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:33210
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:33213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:33204
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] → sending delta(kind=head bytes=1805) to S15@127.0.0.1:33215
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:33216
[S2] sending update (kind=head size=1803 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1803) from S2
[S13] cosine check vs S2: cos=0.4648
[S3] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1805 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1805) from S14
[S15] cosine check vs S14: cos=0.9797
[S17] RECEIVED delta(kind=head bytes=1799) from S9
[S17] cosine check vs S9: cos=0.8492
[S4] RECEIVED delta(kind=head bytes=1802) from S13
[S4] cosine check vs S13: cos=0.8412
[S13] RECEIVED delta(kind=head bytes=1797) from S11
[S13] cosine check vs S11: cos=0.8496
[S9] RECEIVED delta(kind=head bytes=1801) from S3
[S9] cosine check vs S3: cos=0.9642
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:33211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:33214
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] → sending delta(kind=head bytes=1794) to S11@127.0.0.1:33212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:33203
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1793 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1793) from S5
[S16] cosine check vs S5: cos=-0.0371
[S16] DROPPED delta from S5 (cos=-0.0371 < 0.0)
[S17] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1794 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1800) from S17
[S3] cosine check vs S17: cos=0.9366
[S14] RECEIVED delta(kind=head bytes=1799) from S7
[S14] cosine check vs S7: cos=0.9818
[S10] RECEIVED delta(kind=head bytes=1800) from S4
[S10] cosine check vs S4: cos=0.9326
[S11] RECEIVED delta(kind=head bytes=1794) from S15
[S11] cosine check vs S15: cos=0.0752
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=18 metric=0.9939 head_norm=1.230316
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.246260e-01
[S10] stored merged vector for next round verification (round=18)
[S10] DEBUG after merge:  round=18 metric=0.9934 head_norm=1.201953 delta_norm=0.224626
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=18 metric=0.9973 head_norm=1.200987
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.115632e-01
[S3] stored merged vector for next round verification (round=18)
[S3] DEBUG after merge:  round=18 metric=0.9947 head_norm=1.165269 delta_norm=0.211563
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=18 metric=0.9975 head_norm=1.312062
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.247768e-01
[S14] stored merged vector for next round verification (round=18)
[S14] DEBUG after merge:  round=18 metric=0.9973 head_norm=1.289289 delta_norm=0.124777
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=18 metric=0.7013 head_norm=1.334650
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.821264e-01
[S9] stored merged vector for next round verification (round=18)
[S9] DEBUG after merge:  round=18 metric=0.7013 head_norm=1.256447 delta_norm=0.182126
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=18 metric=0.7019 head_norm=1.559760
[S11] _apply_head_vector_avg (torch): Δ‖w‖=9.923019e-01
[S11] stored merged vector for next round verification (round=18)
[S11] DEBUG after merge:  round=18 metric=0.7019 head_norm=1.069093 delta_norm=0.992302
[S11] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=18 metric=0.6127 head_norm=1.087615
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.437013e-01
[S13] stored merged vector for next round verification (round=18)
[S13] DEBUG after merge:  round=18 metric=0.6148 head_norm=1.089751 delta_norm=0.243701
[S13] aggregate: ACCEPT kept=['S2', 'S11'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=18 metric=0.7320 head_norm=1.349962
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.354291e-01
[S15] stored merged vector for next round verification (round=18)
[S15] DEBUG after merge:  round=18 metric=0.7318 head_norm=1.324239 delta_norm=0.135429
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=18 metric=0.9438 head_norm=1.215161
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.301950e-01
[S4] stored merged vector for next round verification (round=18)
[S4] DEBUG after merge:  round=18 metric=0.9437 head_norm=1.104868 delta_norm=0.330195
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=18 metric=0.9132 head_norm=1.167412
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.528026e-01
[S17] stored merged vector for next round verification (round=18)
[S17] DEBUG after merge:  round=18 metric=0.5897 head_norm=1.203163 delta_norm=0.352803
[S17] aggregate: ROLLBACK (f1_val pre=0.913 post=0.590 tol_abs=0.005 tol_rel=0.0)
[S2] START round=19 head_norm_before_train=1.612083 cos_to_last_merge=0.8028 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.803
[S2] round=19 local utility u=0.126331 metrics={'f1_val': 0.7009621467572489, 'auprc': 0.7504467676664379, 'loss_val': 0.3597175400640001, 'psi': 0.7207559951209245}-{'f1_val': 0.70163055750362, 'auprc': 0.6661405433419163, 'loss_val': 0.3634706575500378, 'psi': 0.6874345518389385}
[S3] START round=19 head_norm_before_train=1.165269 cos_to_last_merge=1.0000 (last merge round=18)
[S3] round=19 local utility u=0.000000 metrics={'f1_val': 0.7028627496674129, 'auprc': 0.983245768229329, 'loss_val': 0.375130571098939, 'psi': 0.8150159570921793}-{'f1_val': 0.9973136868485526, 'auprc': 0.9960101671124646, 'loss_val': 0.30583123177774924, 'psi': 0.9967922789541174}
[S4] START round=19 head_norm_before_train=1.104868 cos_to_last_merge=1.0000 (last merge round=18)
[S4] round=19 local utility u=0.000000 metrics={'f1_val': 0.9458060244638746, 'auprc': 0.9482235141093962, 'loss_val': 0.31258029600783216, 'psi': 0.9467730203220832}-{'f1_val': 0.943836984472798, 'auprc': 0.9561694133002925, 'loss_val': 0.297122768988259, 'psi': 0.9487699560037957}
[S5] START round=19 head_norm_before_train=1.646832 (no previous merge yet)
[S5] round=19 local utility u=0.000000 metrics={'f1_val': 0.7006069008894004, 'auprc': 0.902752289396116, 'loss_val': 0.3256496605422634, 'psi': 0.7814650562920866}-{'f1_val': 0.7006083926626743, 'auprc': 0.9360988149882472, 'loss_val': 0.3140918275820639, 'psi': 0.7948045615929035}
[S6] START round=19 head_norm_before_train=1.830190 (no previous merge yet)
[S6] round=19 local utility u=0.000000 metrics={'f1_val': 0.8403297913599324, 'auprc': 0.9518109580268689, 'loss_val': 0.39245085591603207, 'psi': 0.8849222580267069}-{'f1_val': 0.8481625124730691, 'auprc': 0.9603690597583584, 'loss_val': 0.24832655827811323, 'psi': 0.8930451313871848}
[S7] START round=19 head_norm_before_train=1.278345 cos_to_last_merge=0.8719 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.872
[S7] round=19 local utility u=0.000000 metrics={'f1_val': 0.5011833714386992, 'auprc': 0.7764065972750873, 'loss_val': 0.9375255598765508, 'psi': 0.6112726617732545}-{'f1_val': 0.6314207433484942, 'auprc': 0.7910703433376488, 'loss_val': 0.615102416619587, 'psi': 0.695280583344156}
[S8] START round=19 head_norm_before_train=1.962709 (no previous merge yet)
[S8] round=19 local utility u=0.098494 metrics={'f1_val': 0.9905027553548844, 'auprc': 0.998796093265752, 'loss_val': 0.04442367834444641, 'psi': 0.9938200905192314}-{'f1_val': 0.970775898214988, 'auprc': 0.989157992270685, 'loss_val': 0.09413719360504534, 'psi': 0.9781287358372668}
[S9] START round=19 head_norm_before_train=1.256447 cos_to_last_merge=1.0000 (last merge round=18)
[S9] round=19 local utility u=0.000000 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.7855721988852629, 'loss_val': 0.33197017893080244, 'psi': 0.7350031696786432}-{'f1_val': 0.7012904835408967, 'auprc': 0.998621743851982, 'loss_val': 0.3193131251085246, 'psi': 0.8202229876653309}
[S10] START round=19 head_norm_before_train=1.201953 cos_to_last_merge=1.0000 (last merge round=18)
[S10] round=19 local utility u=0.007403 metrics={'f1_val': 0.9940903254969471, 'auprc': 0.9961513435127278, 'loss_val': 0.12533817418200696, 'psi': 0.9949147327032594}-{'f1_val': 0.993871046050545, 'auprc': 0.9952448374600587, 'loss_val': 0.1361083743095736, 'psi': 0.9944205626143504}
[S11] START round=19 head_norm_before_train=1.069093 cos_to_last_merge=1.0000 (last merge round=18)
[S11] round=19 local utility u=0.000000 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9977963355324699, 'loss_val': 0.5176831622901629, 'psi': 0.82027972419198}-{'f1_val': 0.7019353166316534, 'auprc': 0.9978834821303896, 'loss_val': 0.408249389406478, 'psi': 0.8203145828311479}
[S13] START round=19 head_norm_before_train=1.089751 cos_to_last_merge=1.0000 (last merge round=18)
[S13] round=19 local utility u=0.000000 metrics={'f1_val': 0.6237064505839265, 'auprc': 0.656454392632668, 'loss_val': 0.7461224781414442, 'psi': 0.6368056274034231}-{'f1_val': 0.6126636651476295, 'auprc': 0.6775316903523005, 'loss_val': 0.7350373438187037, 'psi': 0.6386108752294979}
[S14] START round=19 head_norm_before_train=1.289289 cos_to_last_merge=1.0000 (last merge round=18)
[S14] round=19 local utility u=0.000168 metrics={'f1_val': 0.9978938390605482, 'auprc': 0.9988371828235652, 'loss_val': 0.24205815092627633, 'psi': 0.998271176565755}-{'f1_val': 0.9975054147531532, 'auprc': 0.9988550288891757, 'loss_val': 0.24011644216054234, 'psi': 0.9980452604075621}
[S15] START round=19 head_norm_before_train=1.324239 cos_to_last_merge=1.0000 (last merge round=18)
[S15] round=19 local utility u=0.000000 metrics={'f1_val': 0.6902516445645005, 'auprc': 0.9748498942501808, 'loss_val': 0.4697390123708127, 'psi': 0.8040909444387726}-{'f1_val': 0.731956597750332, 'auprc': 0.9800981722558708, 'loss_val': 0.3447087368748805, 'psi': 0.8312132275525475}
[S16] START round=19 head_norm_before_train=1.590558 cos_to_last_merge=0.8586 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.859
[S16] round=19 local utility u=0.025157 metrics={'f1_val': 0.9170866705889785, 'auprc': 0.9939358929326623, 'loss_val': 0.31681373822945896, 'psi': 0.947826359526452}-{'f1_val': 0.914930972681548, 'auprc': 0.9912233434284305, 'loss_val': 0.3460551824321076, 'psi': 0.9454479209803011}
[S17] START round=19 head_norm_before_train=1.203163 cos_to_last_merge=1.0000 (last merge round=18)
[S17] round=19 local utility u=0.000000 metrics={'f1_val': 0.858367426883072, 'auprc': 0.970560635261794, 'loss_val': 0.7036512617943468, 'psi': 0.9032447102345608}-{'f1_val': 0.9131976671766656, 'auprc': 0.9682576305743116, 'loss_val': 0.7678964147107725, 'psi': 0.935221652535724}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:33215
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:33217
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:33203
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:33213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S17@127.0.0.1:33217
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1794 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1798) from S14
[S15] cosine check vs S14: cos=0.9846
[S3] RECEIVED delta(kind=head bytes=1796) from S10
[S3] cosine check vs S10: cos=0.6951
[S13] RECEIVED delta(kind=head bytes=1797) from S2
[S13] cosine check vs S2: cos=0.6115
[S17] RECEIVED delta(kind=head bytes=1794) from S8
[S17] cosine check vs S8: cos=0.1176
[S17] RECEIVED delta(kind=head bytes=1800) from S16
[S17] cosine check vs S16: cos=0.7025
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=19 metric=0.7029 head_norm=1.206454
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.889865e-01
[S3] stored merged vector for next round verification (round=19)
[S3] DEBUG after merge:  round=19 metric=0.6801 head_norm=1.149543 delta_norm=0.488987
[S3] aggregate: ROLLBACK (f1_val pre=0.703 post=0.680 tol_abs=0.005 tol_rel=0.0)
[S3] r=20 psi=0.815 u=0.0000 p_local=0.2455 f1=0.703 auprc=0.983 bytes=21539
[S7] r=20 psi=0.611 u=0.0000 p_local=0.2782 f1=0.501 auprc=0.776 bytes=19771
[S9] r=20 psi=0.735 u=0.0000 p_local=0.1437 f1=0.701 auprc=0.786 bytes=23332
[S5] r=20 psi=0.781 u=0.0000 p_local=0.0867 f1=0.701 auprc=0.903 bytes=25124
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=19 metric=0.6237 head_norm=1.130427
[S13] _apply_head_vector_avg (torch): Δ‖w‖=6.466356e-01
[S13] stored merged vector for next round verification (round=19)
[S13] DEBUG after merge:  round=19 metric=0.6252 head_norm=1.241663 delta_norm=0.646636
[S13] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S13] r=20 psi=0.637 u=0.0000 p_local=0.0598 f1=0.624 auprc=0.656 bytes=16199
[S4] r=20 psi=0.947 u=0.0000 p_local=0.0546 f1=0.946 auprc=0.948 bytes=19771
[S6] r=20 psi=0.885 u=0.0000 p_local=0.1970 f1=0.840 auprc=0.952 bytes=14399
[S11] r=20 psi=0.820 u=0.0000 p_local=0.1276 f1=0.702 auprc=0.998 bytes=21546
[S16] r=20 psi=0.948 u=0.0252 p_local=0.1582 f1=0.917 auprc=0.994 bytes=25207
[S10] r=20 psi=0.995 u=0.0074 p_local=0.0895 f1=0.994 auprc=0.996 bytes=23348
[S14] r=20 psi=0.998 u=0.0002 p_local=0.1413 f1=0.998 auprc=0.999 bytes=23378
[S2] r=20 psi=0.721 u=0.1263 p_local=0.1548 f1=0.701 auprc=0.750 bytes=17991
[S8] r=20 psi=0.994 u=0.0985 p_local=0.2020 f1=0.991 auprc=0.999 bytes=19767
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=19 metric=0.8584 head_norm=1.256118
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.970666e-01
[S17] stored merged vector for next round verification (round=19)
[S17] DEBUG after merge:  round=19 metric=0.8798 head_norm=1.103325 delta_norm=0.597067
[S17] aggregate: ACCEPT kept=['S8', 'S16'] (k=2/2) mode=median trim_p=0.1
[S17] r=20 psi=0.903 u=0.0000 p_local=0.2499 f1=0.858 auprc=0.971 bytes=16198
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=19 metric=0.6903 head_norm=1.369737
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.206465e-01
[S15] stored merged vector for next round verification (round=19)
[S15] DEBUG after merge:  round=19 metric=0.6903 head_norm=1.340059 delta_norm=0.120647
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] r=20 psi=0.804 u=0.0000 p_local=0.1706 f1=0.690 auprc=0.975 bytes=17973
[S2] START round=20 head_norm_before_train=1.625381 cos_to_last_merge=0.8017 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.802
[S2] round=20 local utility u=0.000000 metrics={'f1_val': 0.6271667282693734, 'auprc': 0.6323572476131853, 'loss_val': 0.7498329674949568, 'psi': 0.6292429360068982}-{'f1_val': 0.7009621467572489, 'auprc': 0.7504467676664379, 'loss_val': 0.3597175400640001, 'psi': 0.7207559951209245}
[S3] START round=20 head_norm_before_train=1.149543 cos_to_last_merge=1.0000 (last merge round=19)
[S3] round=20 local utility u=0.000000 metrics={'f1_val': 0.7045382717227334, 'auprc': 0.895465814631216, 'loss_val': 0.4198315436249468, 'psi': 0.7809092888861264}-{'f1_val': 0.7028627496674129, 'auprc': 0.983245768229329, 'loss_val': 0.375130571098939, 'psi': 0.8150159570921793}
[S4] START round=20 head_norm_before_train=1.187060 cos_to_last_merge=0.9945 (last merge round=18)
[S4] round=20 local utility u=0.000000 metrics={'f1_val': 0.8953058039188072, 'auprc': 0.9238244141777157, 'loss_val': 0.3961744416034505, 'psi': 0.9067132480223706}-{'f1_val': 0.9458060244638746, 'auprc': 0.9482235141093962, 'loss_val': 0.31258029600783216, 'psi': 0.9467730203220832}
[S5] START round=20 head_norm_before_train=1.661437 (no previous merge yet)
[S5] round=20 local utility u=0.151016 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9874770432681497, 'loss_val': 0.2778013553623212, 'psi': 0.8153558529048645}-{'f1_val': 0.7006069008894004, 'auprc': 0.902752289396116, 'loss_val': 0.3256496605422634, 'psi': 0.7814650562920866}
[S6] START round=20 head_norm_before_train=1.839016 (no previous merge yet)
[S6] round=20 local utility u=0.000000 metrics={'f1_val': 0.6284591458884987, 'auprc': 0.8262950150815009, 'loss_val': 0.7144335787587571, 'psi': 0.7075934935656996}-{'f1_val': 0.8403297913599324, 'auprc': 0.9518109580268689, 'loss_val': 0.39245085591603207, 'psi': 0.8849222580267069}
[S7] START round=20 head_norm_before_train=1.291952 cos_to_last_merge=0.8691 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.869
[S7] round=20 local utility u=0.169956 metrics={'f1_val': 0.5374221123528016, 'auprc': 0.7832957883912843, 'loss_val': 0.8357143300836432, 'psi': 0.6357715827681947}-{'f1_val': 0.5011833714386992, 'auprc': 0.7764065972750873, 'loss_val': 0.9375255598765508, 'psi': 0.6112726617732545}
[S8] START round=20 head_norm_before_train=1.970485 (no previous merge yet)
[S8] round=20 local utility u=0.000000 metrics={'f1_val': 0.9728380491346826, 'auprc': 0.9887540414643623, 'loss_val': 0.08912481436924657, 'psi': 0.9792044460665545}-{'f1_val': 0.9905027553548844, 'auprc': 0.998796093265752, 'loss_val': 0.04442367834444641, 'psi': 0.9938200905192314}
[S9] START round=20 head_norm_before_train=1.291008 cos_to_last_merge=0.9990 (last merge round=18)
[S9] round=20 local utility u=0.000000 metrics={'f1_val': 0.7024932145862333, 'auprc': 0.6629220314610718, 'loss_val': 0.32501800406563963, 'psi': 0.6866647413361686}-{'f1_val': 0.7012904835408967, 'auprc': 0.7855721988852629, 'loss_val': 0.33197017893080244, 'psi': 0.7350031696786432}
[S10] START round=20 head_norm_before_train=1.290574 cos_to_last_merge=0.9934 (last merge round=18)
[S10] round=20 local utility u=0.022413 metrics={'f1_val': 0.993871046050545, 'auprc': 0.9966265636333077, 'loss_val': 0.08062135491219903, 'psi': 0.99497325308365}-{'f1_val': 0.9940903254969471, 'auprc': 0.9961513435127278, 'loss_val': 0.12533817418200696, 'psi': 0.9949147327032594}
[S11] START round=20 head_norm_before_train=1.099993 cos_to_last_merge=0.9974 (last merge round=18)
[S11] round=20 local utility u=0.062468 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9977922109884447, 'loss_val': 0.3927357867577105, 'psi': 0.82027807437437}-{'f1_val': 0.7019353166316534, 'auprc': 0.9977963355324699, 'loss_val': 0.5176831622901629, 'psi': 0.82027972419198}
[S13] START round=20 head_norm_before_train=1.241663 cos_to_last_merge=1.0000 (last merge round=19)
[S13] round=20 local utility u=0.000000 metrics={'f1_val': 0.5665340926601783, 'auprc': 0.6646927690430214, 'loss_val': 1.066863116896855, 'psi': 0.6057975632133155}-{'f1_val': 0.6237064505839265, 'auprc': 0.656454392632668, 'loss_val': 0.7461224781414442, 'psi': 0.6368056274034231}
[S14] START round=20 head_norm_before_train=1.320776 cos_to_last_merge=0.9992 (last merge round=18)
[S14] round=20 local utility u=0.013760 metrics={'f1_val': 0.9970843782277676, 'auprc': 0.9970686646006826, 'loss_val': 0.20437496892718043, 'psi': 0.9970780927769336}-{'f1_val': 0.9978938390605482, 'auprc': 0.9988371828235652, 'loss_val': 0.24205815092627633, 'psi': 0.998271176565755}
[S15] START round=20 head_norm_before_train=1.340059 cos_to_last_merge=1.0000 (last merge round=19)
[S15] round=20 local utility u=1.000000 metrics={'f1_val': 0.9853779990883862, 'auprc': 0.9921987676084009, 'loss_val': 0.18106659388587687, 'psi': 0.9881063064963921}-{'f1_val': 0.6902516445645005, 'auprc': 0.9748498942501808, 'loss_val': 0.4697390123708127, 'psi': 0.8040909444387726}
[S16] START round=20 head_norm_before_train=1.621157 cos_to_last_merge=0.8562 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.856
[S16] round=20 local utility u=0.336532 metrics={'f1_val': 0.9912820895663431, 'auprc': 0.9906946606959224, 'loss_val': 0.0791979031929901, 'psi': 0.9910471180181748}-{'f1_val': 0.9170866705889785, 'auprc': 0.9939358929326623, 'loss_val': 0.31681373822945896, 'psi': 0.947826359526452}
[S17] START round=20 head_norm_before_train=1.103325 cos_to_last_merge=1.0000 (last merge round=19)
[S17] round=20 local utility u=0.000000 metrics={'f1_val': 0.6387041320675214, 'auprc': 0.8663709850824334, 'loss_val': 0.7714752517150842, 'psi': 0.7297708732734862}-{'f1_val': 0.858367426883072, 'auprc': 0.970560635261794, 'loss_val': 0.7036512617943468, 'psi': 0.9032447102345608}
[S16] not sending this round → trigger blocked (psi=0.991)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:33212
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:33213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] → sending delta(kind=head bytes=1806) to S14@127.0.0.1:33214
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S5] → sending delta(kind=head bytes=1792) to S16@127.0.0.1:33216
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.997)
[S10] not sending this round → trigger blocked (psi=0.995)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1792 to 1 peers)
[S7] sending update (kind=head size=1806 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1806) from S7
[S14] cosine check vs S7: cos=0.9855
[S11] RECEIVED delta(kind=head bytes=1802) from S15
[S11] cosine check vs S15: cos=0.6505
[S13] RECEIVED delta(kind=head bytes=1796) from S11
[S13] cosine check vs S11: cos=0.3664
[S16] RECEIVED delta(kind=head bytes=1792) from S5
[S16] cosine check vs S5: cos=-0.0352
[S16] DROPPED delta from S5 (cos=-0.0352 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] ⇄ pheromone p=0.076 → S3@127.0.0.1:33203
[S2] ⇄ pheromone p=0.124 → S13@127.0.0.1:33213
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=20 metric=0.9971 head_norm=1.352685
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.157965e-01
[S14] stored merged vector for next round verification (round=20)
[S14] DEBUG after merge:  round=20 metric=0.9967 head_norm=1.323726 delta_norm=0.115797
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.116 → S15@127.0.0.1:33215
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=20 metric=0.5665 head_norm=1.276793
[S13] _apply_head_vector_avg (torch): Δ‖w‖=6.818848e-01
[S13] stored merged vector for next round verification (round=20)
[S13] DEBUG after merge:  round=20 metric=0.5688 head_norm=0.998567 delta_norm=0.681885
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.048 → S4@127.0.0.1:33204
[S9] ⇄ pheromone p=0.115 → S17@127.0.0.1:33217
[S8] ⇄ pheromone p=0.162 → S17@127.0.0.1:33217
[S3] ⇄ pheromone p=0.196 → S9@127.0.0.1:33210
[S6] ⇄ pheromone p=0.158 → S11@127.0.0.1:33212
[S4] ⇄ pheromone p=0.044 → S10@127.0.0.1:33211
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=20 metric=0.7019 head_norm=1.137543
[S11] _apply_head_vector_avg (torch): Δ‖w‖=5.390683e-01
[S11] stored merged vector for next round verification (round=20)
[S11] DEBUG after merge:  round=20 metric=0.7019 head_norm=1.146841 delta_norm=0.539068
[S11] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.115 → S13@127.0.0.1:33213
[S5] ⇄ pheromone p=0.100 → S16@127.0.0.1:33216
[S15] ⇄ pheromone p=0.336 → S11@127.0.0.1:33212
[S7] ⇄ pheromone p=0.257 → S14@127.0.0.1:33214
[S17] ⇄ pheromone p=0.200 → S3@127.0.0.1:33203
[S16] ⇄ pheromone p=0.194 → S17@127.0.0.1:33217
[S2] START round=21 head_norm_before_train=1.640943 cos_to_last_merge=0.7999 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.800
[S2] round=21 local utility u=0.531011 metrics={'f1_val': 0.6934522918397259, 'auprc': 0.7469356686929025, 'loss_val': 0.4292597678677401, 'psi': 0.7148456425809966}-{'f1_val': 0.6271667282693734, 'auprc': 0.6323572476131853, 'loss_val': 0.7498329674949568, 'psi': 0.6292429360068982}
[S3] START round=21 head_norm_before_train=1.191359 cos_to_last_merge=0.9992 (last merge round=19)
[S3] round=21 local utility u=1.000000 metrics={'f1_val': 0.9629642435515284, 'auprc': 0.9986904298619678, 'loss_val': 0.23177837535016027, 'psi': 0.9772547180757042}-{'f1_val': 0.7045382717227334, 'auprc': 0.895465814631216, 'loss_val': 0.4198315436249468, 'psi': 0.7809092888861264}
[S4] START round=21 head_norm_before_train=1.256341 cos_to_last_merge=0.9856 (last merge round=18)
[S4] round=21 local utility u=0.254500 metrics={'f1_val': 0.9424726738384412, 'auprc': 0.961652414802233, 'loss_val': 0.2836606014715341, 'psi': 0.9501445702239579}-{'f1_val': 0.8953058039188072, 'auprc': 0.9238244141777157, 'loss_val': 0.3961744416034505, 'psi': 0.9067132480223706}
[S5] START round=21 head_norm_before_train=1.674525 (no previous merge yet)
[S5] round=21 local utility u=0.000000 metrics={'f1_val': 0.6129926086771755, 'auprc': 0.8530825632670223, 'loss_val': 0.5495184016638047, 'psi': 0.7090285905131142}-{'f1_val': 0.7006083926626743, 'auprc': 0.9874770432681497, 'loss_val': 0.2778013553623212, 'psi': 0.8153558529048645}
[S6] START round=21 head_norm_before_train=1.843273 (no previous merge yet)
[S6] round=21 local utility u=0.918885 metrics={'f1_val': 0.8327838966912329, 'auprc': 0.9404773050923716, 'loss_val': 0.44515954000665997, 'psi': 0.8758612600516884}-{'f1_val': 0.6284591458884987, 'auprc': 0.8262950150815009, 'loss_val': 0.7144335787587571, 'psi': 0.7075934935656996}
[S7] START round=21 head_norm_before_train=1.304440 cos_to_last_merge=0.8664 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.866
[S7] round=21 local utility u=0.514908 metrics={'f1_val': 0.6529281787691604, 'auprc': 0.8011004225892602, 'loss_val': 0.5523488087532274, 'psi': 0.7121970762972003}-{'f1_val': 0.5374221123528016, 'auprc': 0.7832957883912843, 'loss_val': 0.8357143300836432, 'psi': 0.6357715827681947}
[S8] START round=21 head_norm_before_train=1.983100 (no previous merge yet)
[S8] round=21 local utility u=0.088377 metrics={'f1_val': 0.993632801855294, 'auprc': 0.9885102109056138, 'loss_val': 0.03640796027231577, 'psi': 0.9915837654754219}-{'f1_val': 0.9728380491346826, 'auprc': 0.9887540414643623, 'loss_val': 0.08912481436924657, 'psi': 0.9792044460665545}
[S9] START round=21 head_norm_before_train=1.325760 cos_to_last_merge=0.9971 (last merge round=18)
[S9] round=21 local utility u=0.515823 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9987910787820826, 'loss_val': 0.2937628892108413, 'psi': 0.8202907216373712}-{'f1_val': 0.7024932145862333, 'auprc': 0.6629220314610718, 'loss_val': 0.32501800406563963, 'psi': 0.6866647413361686}
[S10] START round=21 head_norm_before_train=1.380315 cos_to_last_merge=0.9821 (last merge round=18)
[S10] round=21 local utility u=0.011546 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9959758449978169, 'loss_val': 0.06084184118752789, 'psi': 0.9952395035307502}-{'f1_val': 0.993871046050545, 'auprc': 0.9966265636333077, 'loss_val': 0.08062135491219903, 'psi': 0.99497325308365}
[S11] START round=21 head_norm_before_train=1.146841 cos_to_last_merge=1.0000 (last merge round=20)
[S11] round=21 local utility u=0.000000 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9971085583500322, 'loss_val': 0.4976997530583945, 'psi': 0.8200046133190049}-{'f1_val': 0.7019353166316534, 'auprc': 0.9977922109884447, 'loss_val': 0.3927357867577105, 'psi': 0.82027807437437}
[S13] START round=21 head_norm_before_train=0.998567 cos_to_last_merge=1.0000 (last merge round=20)
[S13] round=21 local utility u=0.365809 metrics={'f1_val': 0.6290826617501792, 'auprc': 0.6633092600342523, 'loss_val': 0.706385070517362, 'psi': 0.6427733010638085}-{'f1_val': 0.5665340926601783, 'auprc': 0.6646927690430214, 'loss_val': 1.066863116896855, 'psi': 0.6057975632133155}
[S14] START round=21 head_norm_before_train=1.323726 cos_to_last_merge=1.0000 (last merge round=20)
[S14] round=21 local utility u=0.000000 metrics={'f1_val': 0.9585049807169124, 'auprc': 0.9987570520495317, 'loss_val': 0.21762953404517563, 'psi': 0.9746058092499601}-{'f1_val': 0.9970843782277676, 'auprc': 0.9970686646006826, 'loss_val': 0.20437496892718043, 'psi': 0.9970780927769336}
[S15] START round=21 head_norm_before_train=1.384801 cos_to_last_merge=0.9985 (last merge round=19)
[S15] round=21 local utility u=0.000000 metrics={'f1_val': 0.8016134354325526, 'auprc': 0.9870669930263783, 'loss_val': 0.26774226650006766, 'psi': 0.8757948584700829}-{'f1_val': 0.9853779990883862, 'auprc': 0.9921987676084009, 'loss_val': 0.18106659388587687, 'psi': 0.9881063064963921}
[S16] START round=21 head_norm_before_train=1.647192 cos_to_last_merge=0.8542 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.854
[S16] round=21 local utility u=0.000000 metrics={'f1_val': 0.9287270047755437, 'auprc': 0.9935135352693992, 'loss_val': 0.29245702816685337, 'psi': 0.9546416169730858}-{'f1_val': 0.9912820895663431, 'auprc': 0.9906946606959224, 'loss_val': 0.0791979031929901, 'psi': 0.9910471180181748}
[S17] START round=21 head_norm_before_train=1.170804 cos_to_last_merge=0.9958 (last merge round=19)
[S17] round=21 local utility u=0.000000 metrics={'f1_val': 0.6391912999512812, 'auprc': 0.7870789910919298, 'loss_val': 0.719063201150567, 'psi': 0.6983463764075406}-{'f1_val': 0.6387041320675214, 'auprc': 0.8663709850824334, 'loss_val': 0.7714752517150842, 'psi': 0.7297708732734862}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:33204
[S7] not sending this round → trigger blocked (psi=0.712)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] → sending delta(kind=head bytes=1794) to S11@127.0.0.1:33212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] → sending delta(kind=head bytes=1792) to S17@127.0.0.1:33217
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:33213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:33217
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:33211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] → sending delta(kind=head bytes=1805) to S9@127.0.0.1:33210
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:33203
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1792 to 1 peers)
[S4] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1805 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1794 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1796) from S13
[S4] cosine check vs S13: cos=0.8603
[S11] RECEIVED delta(kind=head bytes=1794) from S6
[S11] cosine check vs S6: cos=0.3190
[S10] RECEIVED delta(kind=head bytes=1803) from S4
[S10] cosine check vs S4: cos=0.9058
[S13] RECEIVED delta(kind=head bytes=1798) from S2
[S13] cosine check vs S2: cos=0.5966
[S3] RECEIVED delta(kind=head bytes=1800) from S10
[S3] cosine check vs S10: cos=0.9229
[S17] RECEIVED delta(kind=head bytes=1798) from S8
[S17] cosine check vs S8: cos=0.4796
[S17] RECEIVED delta(kind=head bytes=1792) from S9
[S17] cosine check vs S9: cos=0.7720
[S9] RECEIVED delta(kind=head bytes=1805) from S3
[S9] cosine check vs S3: cos=0.9415
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=21 metric=0.7019 head_norm=1.173138
[S11] _apply_head_vector_avg (torch): Δ‖w‖=9.257627e-01
[S11] stored merged vector for next round verification (round=21)
[S11] DEBUG after merge:  round=21 metric=0.9763 head_norm=1.245452 delta_norm=0.925763
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=21 metric=0.7013 head_norm=1.357320
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.297654e-01
[S9] stored merged vector for next round verification (round=21)
[S9] DEBUG after merge:  round=21 metric=0.7013 head_norm=1.276654 delta_norm=0.229765
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=21 metric=0.9947 head_norm=1.453455
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.078476e-01
[S10] stored merged vector for next round verification (round=21)
[S10] DEBUG after merge:  round=21 metric=0.9941 head_norm=1.353897 delta_norm=0.307848
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=21 metric=0.6291 head_norm=1.038311
[S13] _apply_head_vector_avg (torch): Δ‖w‖=6.627312e-01
[S13] stored merged vector for next round verification (round=21)
[S13] DEBUG after merge:  round=21 metric=0.6184 head_norm=1.208917 delta_norm=0.662731
[S13] aggregate: ROLLBACK (f1_val pre=0.629 post=0.618 tol_abs=0.005 tol_rel=0.0)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=21 metric=0.9630 head_norm=1.234081
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.849526e-01
[S3] stored merged vector for next round verification (round=21)
[S3] DEBUG after merge:  round=21 metric=0.9974 head_norm=1.317781 delta_norm=0.284953
[S3] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=21 metric=0.9425 head_norm=1.320257
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.400751e-01
[S4] stored merged vector for next round verification (round=21)
[S4] DEBUG after merge:  round=21 metric=0.9422 head_norm=1.137952 delta_norm=0.340075
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=21 metric=0.6392 head_norm=1.240692
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.621446e-01
[S17] stored merged vector for next round verification (round=21)
[S17] DEBUG after merge:  round=21 metric=0.6420 head_norm=1.172949 delta_norm=0.362145
[S17] aggregate: ACCEPT kept=['S8', 'S9'] (k=2/2) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=1.650241 cos_to_last_merge=0.7995 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.799
[S2] round=22 local utility u=0.000000 metrics={'f1_val': 0.6793704275354409, 'auprc': 0.7694038259923897, 'loss_val': 0.9999279868100935, 'psi': 0.7153837869182204}-{'f1_val': 0.6934522918397259, 'auprc': 0.7469356686929025, 'loss_val': 0.4292597678677401, 'psi': 0.7148456425809966}
[S3] START round=22 head_norm_before_train=1.317781 cos_to_last_merge=1.0000 (last merge round=21)
[S3] round=22 local utility u=0.121838 metrics={'f1_val': 0.9975552686373071, 'auprc': 0.9994021743471772, 'loss_val': 0.19778393449660644, 'psi': 0.9982940309212551}-{'f1_val': 0.9629642435515284, 'auprc': 0.9986904298619678, 'loss_val': 0.23177837535016027, 'psi': 0.9772547180757042}
[S4] START round=22 head_norm_before_train=1.137952 cos_to_last_merge=1.0000 (last merge round=21)
[S4] round=22 local utility u=0.000000 metrics={'f1_val': 0.9413365266316274, 'auprc': 0.953589569562086, 'loss_val': 0.3133678540913483, 'psi': 0.9462377438038109}-{'f1_val': 0.9424726738384412, 'auprc': 0.961652414802233, 'loss_val': 0.2836606014715341, 'psi': 0.9501445702239579}
[S5] START round=22 head_norm_before_train=1.685274 (no previous merge yet)
[S5] round=22 local utility u=0.494497 metrics={'f1_val': 0.6828807994453852, 'auprc': 0.9592248534031396, 'loss_val': 0.29828095681446615, 'psi': 0.7934184210284869}-{'f1_val': 0.6129926086771755, 'auprc': 0.8530825632670223, 'loss_val': 0.5495184016638047, 'psi': 0.7090285905131142}
[S6] START round=22 head_norm_before_train=1.854756 (no previous merge yet)
[S6] round=22 local utility u=0.000000 metrics={'f1_val': 0.7617838527935853, 'auprc': 0.9235682757786922, 'loss_val': 0.583836910726844, 'psi': 0.8264976219876281}-{'f1_val': 0.8327838966912329, 'auprc': 0.9404773050923716, 'loss_val': 0.44515954000665997, 'psi': 0.8758612600516884}
[S7] START round=22 head_norm_before_train=1.315192 cos_to_last_merge=0.8643 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.864
[S7] round=22 local utility u=0.000000 metrics={'f1_val': 0.5868233193744523, 'auprc': 0.7934844529465485, 'loss_val': 0.6666019538359215, 'psi': 0.6694877728032907}-{'f1_val': 0.6529281787691604, 'auprc': 0.8011004225892602, 'loss_val': 0.5523488087532274, 'psi': 0.7121970762972003}
[S8] START round=22 head_norm_before_train=1.998759 (no previous merge yet)
[S8] round=22 local utility u=0.012184 metrics={'f1_val': 0.9925380579155019, 'auprc': 0.998874168275046, 'loss_val': 0.036564216138271634, 'psi': 0.9950725020593196}-{'f1_val': 0.993632801855294, 'auprc': 0.9885102109056138, 'loss_val': 0.03640796027231577, 'psi': 0.9915837654754219}
[S9] START round=22 head_norm_before_train=1.276654 cos_to_last_merge=1.0000 (last merge round=21)
[S9] round=22 local utility u=0.000000 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9985954577653473, 'loss_val': 0.3164874835432063, 'psi': 0.820212473230677}-{'f1_val': 0.7012904835408967, 'auprc': 0.9987910787820826, 'loss_val': 0.2937628892108413, 'psi': 0.8202907216373712}
[S10] START round=22 head_norm_before_train=1.353897 cos_to_last_merge=1.0000 (last merge round=21)
[S10] round=22 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9947584460063992, 'loss_val': 0.0825366027883933, 'psi': 0.9948842903216053}-{'f1_val': 0.9947486092193725, 'auprc': 0.9959758449978169, 'loss_val': 0.06084184118752789, 'psi': 0.9952395035307502}
[S11] START round=22 head_norm_before_train=1.245452 cos_to_last_merge=1.0000 (last merge round=21)
[S11] round=22 local utility u=0.986031 metrics={'f1_val': 0.996960829744628, 'auprc': 0.9977762961781917, 'loss_val': 0.2977940104809746, 'psi': 0.9972870163180534}-{'f1_val': 0.7019353166316534, 'auprc': 0.9971085583500322, 'loss_val': 0.4976997530583945, 'psi': 0.8200046133190049}
[S13] START round=22 head_norm_before_train=1.208917 cos_to_last_merge=1.0000 (last merge round=21)
[S13] round=22 local utility u=0.000000 metrics={'f1_val': 0.5814665616300286, 'auprc': 0.6685288205880187, 'loss_val': 0.9058281724051522, 'psi': 0.6162914652132246}-{'f1_val': 0.6290826617501792, 'auprc': 0.6633092600342523, 'loss_val': 0.706385070517362, 'psi': 0.6427733010638085}
[S14] START round=22 head_norm_before_train=1.361452 cos_to_last_merge=0.9992 (last merge round=20)
[S14] round=22 local utility u=0.140049 metrics={'f1_val': 0.9980850197418996, 'auprc': 0.997061555642154, 'loss_val': 0.1699253347255144, 'psi': 0.9976756341020013}-{'f1_val': 0.9585049807169124, 'auprc': 0.9987570520495317, 'loss_val': 0.21762953404517563, 'psi': 0.9746058092499601}
[S15] START round=22 head_norm_before_train=1.425999 cos_to_last_merge=0.9954 (last merge round=19)
[S15] round=22 local utility u=0.128760 metrics={'f1_val': 0.8388925872877745, 'auprc': 0.9897674771155671, 'loss_val': 0.24199929088275962, 'psi': 0.8992425432188915}-{'f1_val': 0.8016134354325526, 'auprc': 0.9870669930263783, 'loss_val': 0.26774226650006766, 'psi': 0.8757948584700829}
[S16] START round=22 head_norm_before_train=1.671844 cos_to_last_merge=0.8522 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.852
[S16] round=22 local utility u=0.004685 metrics={'f1_val': 0.9297690598118697, 'auprc': 0.9933055134552473, 'loss_val': 0.28871443504395594, 'psi': 0.9551836412692207}-{'f1_val': 0.9287270047755437, 'auprc': 0.9935135352693992, 'loss_val': 0.29245702816685337, 'psi': 0.9546416169730858}
[S17] START round=22 head_norm_before_train=1.172949 cos_to_last_merge=1.0000 (last merge round=21)
[S17] round=22 local utility u=0.144346 metrics={'f1_val': 0.6477276226459908, 'auprc': 0.8689715950141806, 'loss_val': 0.7272675106502835, 'psi': 0.7362252115932668}-{'f1_val': 0.6391912999512812, 'auprc': 0.7870789910919298, 'loss_val': 0.719063201150567, 'psi': 0.6983463764075406}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:33217
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S11] → sending delta(kind=head bytes=1807) to S13@127.0.0.1:33213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:33216
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:33217
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:33215
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] → sending delta(kind=head bytes=1805) to S11@127.0.0.1:33212
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:33210
[S15] sending update (kind=head size=1805 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1807 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S3] sending update (kind=head size=1803 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1807) from S11
[S13] cosine check vs S11: cos=0.3795
[S17] RECEIVED delta(kind=head bytes=1799) from S16
[S17] cosine check vs S16: cos=0.5485
[S17] RECEIVED delta(kind=head bytes=1796) from S8
[S17] cosine check vs S8: cos=0.6653
[S16] RECEIVED delta(kind=head bytes=1800) from S5
[S16] cosine check vs S5: cos=-0.0335
[S16] DROPPED delta from S5 (cos=-0.0335 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1803) from S3
[S9] cosine check vs S3: cos=0.9411
[S15] RECEIVED delta(kind=head bytes=1802) from S14
[S15] cosine check vs S14: cos=0.9765
[S11] RECEIVED delta(kind=head bytes=1805) from S15
[S11] cosine check vs S15: cos=0.3873
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:33203
[S17] sending update (kind=head size=1803 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1803) from S17
[S3] cosine check vs S17: cos=0.5808
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=22 metric=0.7013 head_norm=1.306221
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.300204e-01
[S9] stored merged vector for next round verification (round=22)
[S9] DEBUG after merge:  round=22 metric=0.7013 head_norm=1.312229 delta_norm=0.230020
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=22 metric=0.5815 head_norm=1.234185
[S13] _apply_head_vector_avg (torch): Δ‖w‖=7.000459e-01
[S13] stored merged vector for next round verification (round=22)
[S13] DEBUG after merge:  round=22 metric=0.5827 head_norm=1.043540 delta_norm=0.700046
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=22 metric=0.9976 head_norm=1.357754
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.958192e-01
[S3] stored merged vector for next round verification (round=22)
[S3] DEBUG after merge:  round=22 metric=0.9988 head_norm=1.152490 delta_norm=0.595819
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=22 metric=0.9970 head_norm=1.278619
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.652609e-01
[S11] stored merged vector for next round verification (round=22)
[S11] DEBUG after merge:  round=22 metric=0.9965 head_norm=1.146361 delta_norm=0.765261
[S11] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=22 metric=0.8389 head_norm=1.471280
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.596832e-01
[S15] stored merged vector for next round verification (round=22)
[S15] DEBUG after merge:  round=22 metric=0.8380 head_norm=1.427518 delta_norm=0.159683
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=22 metric=0.6477 head_norm=1.234087
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.128934e-01
[S17] stored merged vector for next round verification (round=22)
[S17] DEBUG after merge:  round=22 metric=0.6520 head_norm=1.224348 delta_norm=0.312893
[S17] aggregate: ACCEPT kept=['S16', 'S8'] (k=2/2) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=1.656717 cos_to_last_merge=0.7988 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.799
[S2] round=23 local utility u=0.059772 metrics={'f1_val': 0.652328971669306, 'auprc': 0.7424704987192364, 'loss_val': 0.6373343446064506, 'psi': 0.6883855824892782}-{'f1_val': 0.6793704275354409, 'auprc': 0.7694038259923897, 'loss_val': 0.9999279868100935, 'psi': 0.7153837869182204}
[S3] START round=23 head_norm_before_train=1.152490 cos_to_last_merge=1.0000 (last merge round=22)
[S3] round=23 local utility u=0.000000 metrics={'f1_val': 0.7889362656828357, 'auprc': 0.9801895584332017, 'loss_val': 0.30135981655202027, 'psi': 0.8654375827829821}-{'f1_val': 0.9975552686373071, 'auprc': 0.9994021743471772, 'loss_val': 0.19778393449660644, 'psi': 0.9982940309212551}
[S4] START round=23 head_norm_before_train=1.195324 cos_to_last_merge=0.9979 (last merge round=21)
[S4] round=23 local utility u=0.020375 metrics={'f1_val': 0.9408135767789407, 'auprc': 0.9613175588021446, 'loss_val': 0.2926637386224312, 'psi': 0.9490151695882223}-{'f1_val': 0.9413365266316274, 'auprc': 0.953589569562086, 'loss_val': 0.3133678540913483, 'psi': 0.9462377438038109}
[S5] START round=23 head_norm_before_train=1.697763 (no previous merge yet)
[S5] round=23 local utility u=0.036286 metrics={'f1_val': 0.7006536512124258, 'auprc': 0.9483001129643849, 'loss_val': 0.29957225902731854, 'psi': 0.7997122359132094}-{'f1_val': 0.6828807994453852, 'auprc': 0.9592248534031396, 'loss_val': 0.29828095681446615, 'psi': 0.7934184210284869}
[S6] START round=23 head_norm_before_train=1.870932 (no previous merge yet)
[S6] round=23 local utility u=0.606370 metrics={'f1_val': 0.8897942396505515, 'auprc': 0.9565165377100687, 'loss_val': 0.23800353415952394, 'psi': 0.9164831588743584}-{'f1_val': 0.7617838527935853, 'auprc': 0.9235682757786922, 'loss_val': 0.583836910726844, 'psi': 0.8264976219876281}
[S7] START round=23 head_norm_before_train=1.325389 cos_to_last_merge=0.8621 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.862
[S7] round=23 local utility u=0.000000 metrics={'f1_val': 0.5757279802882109, 'auprc': 0.7939434940604615, 'loss_val': 0.7087021193625641, 'psi': 0.6630141857971112}-{'f1_val': 0.5868233193744523, 'auprc': 0.7934844529465485, 'loss_val': 0.6666019538359215, 'psi': 0.6694877728032907}
[S8] START round=23 head_norm_before_train=2.015492 (no previous merge yet)
[S8] round=23 local utility u=0.003576 metrics={'f1_val': 0.9938130760262815, 'auprc': 0.9978944805924501, 'loss_val': 0.03412342773720043, 'psi': 0.995445637852749}-{'f1_val': 0.9925380579155019, 'auprc': 0.998874168275046, 'loss_val': 0.036564216138271634, 'psi': 0.9950725020593196}
[S9] START round=23 head_norm_before_train=1.312229 cos_to_last_merge=1.0000 (last merge round=22)
[S9] round=23 local utility u=0.000000 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.6635024210939099, 'loss_val': 0.34063481738150164, 'psi': 0.6861752585621019}-{'f1_val': 0.7012904835408967, 'auprc': 0.9985954577653473, 'loss_val': 0.3164874835432063, 'psi': 0.820212473230677}
[S10] START round=23 head_norm_before_train=1.416897 cos_to_last_merge=0.9987 (last merge round=21)
[S10] round=23 local utility u=0.012142 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9962382653245487, 'loss_val': 0.06137372997374164, 'psi': 0.995344471661443}-{'f1_val': 0.9949681865317428, 'auprc': 0.9947584460063992, 'loss_val': 0.0825366027883933, 'psi': 0.9948842903216053}
[S11] START round=23 head_norm_before_train=1.146361 cos_to_last_merge=1.0000 (last merge round=22)
[S11] round=23 local utility u=0.000000 metrics={'f1_val': 0.9773789765497642, 'auprc': 0.9969113748542093, 'loss_val': 0.3905159648461511, 'psi': 0.9851919358715423}-{'f1_val': 0.996960829744628, 'auprc': 0.9977762961781917, 'loss_val': 0.2977940104809746, 'psi': 0.9972870163180534}
[S13] START round=23 head_norm_before_train=1.043540 cos_to_last_merge=1.0000 (last merge round=22)
[S13] round=23 local utility u=0.046876 metrics={'f1_val': 0.5809041077767324, 'auprc': 0.6883538332669782, 'loss_val': 0.8681757674626303, 'psi': 0.6238839979728308}-{'f1_val': 0.5814665616300286, 'auprc': 0.6685288205880187, 'loss_val': 0.9058281724051522, 'psi': 0.6162914652132246}
[S14] START round=23 head_norm_before_train=1.400695 cos_to_last_merge=0.9971 (last merge round=20)
[S14] round=23 local utility u=0.008872 metrics={'f1_val': 0.9964034173396682, 'auprc': 0.9987439908364794, 'loss_val': 0.1471386506266138, 'psi': 0.9973396467383926}-{'f1_val': 0.9980850197418996, 'auprc': 0.997061555642154, 'loss_val': 0.1699253347255144, 'psi': 0.9976756341020013}
[S15] START round=23 head_norm_before_train=1.427518 cos_to_last_merge=1.0000 (last merge round=22)
[S15] round=23 local utility u=0.000000 metrics={'f1_val': 0.7557266113353805, 'auprc': 0.9898024168645534, 'loss_val': 0.34730544471065816, 'psi': 0.8493569335470497}-{'f1_val': 0.8388925872877745, 'auprc': 0.9897674771155671, 'loss_val': 0.24199929088275962, 'psi': 0.8992425432188915}
[S16] START round=23 head_norm_before_train=1.695231 cos_to_last_merge=0.8505 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.850
[S16] round=23 local utility u=0.121930 metrics={'f1_val': 0.9452195118652043, 'auprc': 0.9959487885539511, 'loss_val': 0.14548609279909927, 'psi': 0.965511222540703}-{'f1_val': 0.9297690598118697, 'auprc': 0.9933055134552473, 'loss_val': 0.28871443504395594, 'psi': 0.9551836412692207}
[S17] START round=23 head_norm_before_train=1.224348 cos_to_last_merge=1.0000 (last merge round=22)
[S17] round=23 local utility u=0.006863 metrics={'f1_val': 0.6579306966446841, 'auprc': 0.8298250023866063, 'loss_val': 0.657319567339606, 'psi': 0.726688418941453}-{'f1_val': 0.6477276226459908, 'auprc': 0.8689715950141806, 'loss_val': 0.7272675106502835, 'psi': 0.7362252115932668}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:33213
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] → sending delta(kind=head bytes=1794) to S11@127.0.0.1:33212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:33217
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:33215
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:33203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S17@127.0.0.1:33217
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S10@127.0.0.1:33211
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] → sending delta(kind=head bytes=1794) to S4@127.0.0.1:33204
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:33216
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S13] sending update (kind=head size=1794 to 1 peers)
[S4] sending update (kind=head size=1804 to 1 peers)
[S8] sending update (kind=head size=1793 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1794 to 1 peers)
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1798) from S10
[S3] cosine check vs S10: cos=0.7982
[S10] RECEIVED delta(kind=head bytes=1804) from S4
[S10] cosine check vs S4: cos=0.9321
[S13] RECEIVED delta(kind=head bytes=1803) from S2
[S13] cosine check vs S2: cos=0.5728
[S17] RECEIVED delta(kind=head bytes=1793) from S8
[S17] cosine check vs S8: cos=0.7182
[S17] RECEIVED delta(kind=head bytes=1800) from S16
[S17] cosine check vs S16: cos=0.6093
[S11] RECEIVED delta(kind=head bytes=1794) from S6
[S11] cosine check vs S6: cos=0.4730
[S16] RECEIVED delta(kind=head bytes=1795) from S5
[S16] cosine check vs S5: cos=-0.0313
[S16] DROPPED delta from S5 (cos=-0.0313 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1803) from S14
[S15] cosine check vs S14: cos=0.9888
[S4] RECEIVED delta(kind=head bytes=1794) from S13
[S4] cosine check vs S13: cos=0.8999
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S17] → sending delta(kind=head bytes=1809) to S3@127.0.0.1:33203
[S17] sending update (kind=head size=1809 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1809) from S17
[S3] cosine check vs S17: cos=0.7873
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=23 metric=0.7889 head_norm=1.198779
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.330426e-01
[S3] stored merged vector for next round verification (round=23)
[S3] DEBUG after merge:  round=23 metric=0.9030 head_norm=1.151802 delta_norm=0.133043
[S3] aggregate: ACCEPT kept=['S10', 'S17'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=23 metric=0.9774 head_norm=1.171980
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.421842e-01
[S11] stored merged vector for next round verification (round=23)
[S11] DEBUG after merge:  round=23 metric=0.9813 head_norm=1.324448 delta_norm=0.842184
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=23 metric=0.9947 head_norm=1.475784
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.725686e-01
[S10] stored merged vector for next round verification (round=23)
[S10] DEBUG after merge:  round=23 metric=0.9943 head_norm=1.348423 delta_norm=0.272569
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=23 metric=0.9408 head_norm=1.267730
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.783664e-01
[S4] stored merged vector for next round verification (round=23)
[S4] DEBUG after merge:  round=23 metric=0.9408 head_norm=1.142304 delta_norm=0.278366
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=23 metric=0.5809 head_norm=1.075896
[S13] _apply_head_vector_avg (torch): Δ‖w‖=6.854793e-01
[S13] stored merged vector for next round verification (round=23)
[S13] DEBUG after merge:  round=23 metric=0.5820 head_norm=1.223353 delta_norm=0.685479
[S13] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=23 metric=0.7557 head_norm=1.472245
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.100687e-01
[S15] stored merged vector for next round verification (round=23)
[S15] DEBUG after merge:  round=23 metric=0.7546 head_norm=1.452257 delta_norm=0.110069
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=23 metric=0.6579 head_norm=1.277449
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.837196e-01
[S17] stored merged vector for next round verification (round=23)
[S17] DEBUG after merge:  round=23 metric=0.6617 head_norm=1.276871 delta_norm=0.183720
[S17] aggregate: ACCEPT kept=['S8', 'S16'] (k=2/2) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=1.665953 cos_to_last_merge=0.7982 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.798
[S2] round=24 local utility u=0.211466 metrics={'f1_val': 0.7100138003758066, 'auprc': 0.7742907384451396, 'loss_val': 0.6559713235719936, 'psi': 0.7357245756035399}-{'f1_val': 0.652328971669306, 'auprc': 0.7424704987192364, 'loss_val': 0.6373343446064506, 'psi': 0.6883855824892782}
[S3] START round=24 head_norm_before_train=1.151802 cos_to_last_merge=1.0000 (last merge round=23)
[S3] round=24 local utility u=0.697539 metrics={'f1_val': 0.9984129976004323, 'auprc': 0.9982237364876092, 'loss_val': 0.21724548681502956, 'psi': 0.9983372931553031}-{'f1_val': 0.7889362656828357, 'auprc': 0.9801895584332017, 'loss_val': 0.30135981655202027, 'psi': 0.8654375827829821}
[S4] START round=24 head_norm_before_train=1.142304 cos_to_last_merge=1.0000 (last merge round=23)
[S4] round=24 local utility u=0.000000 metrics={'f1_val': 0.9394728647392114, 'auprc': 0.9437373394834555, 'loss_val': 0.3388640747131709, 'psi': 0.9411786546369091}-{'f1_val': 0.9408135767789407, 'auprc': 0.9613175588021446, 'loss_val': 0.2926637386224312, 'psi': 0.9490151695882223}
[S5] START round=24 head_norm_before_train=1.712471 (no previous merge yet)
[S5] round=24 local utility u=0.000000 metrics={'f1_val': 0.7006536512124258, 'auprc': 0.8570081731311279, 'loss_val': 0.35081311512098934, 'psi': 0.7631954599799067}-{'f1_val': 0.7006536512124258, 'auprc': 0.9483001129643849, 'loss_val': 0.29957225902731854, 'psi': 0.7997122359132094}
[S6] START round=24 head_norm_before_train=1.885029 (no previous merge yet)
[S6] round=24 local utility u=0.000000 metrics={'f1_val': 0.7943016278671243, 'auprc': 0.9546021047444189, 'loss_val': 0.5337779729287357, 'psi': 0.8584218186180421}-{'f1_val': 0.8897942396505515, 'auprc': 0.9565165377100687, 'loss_val': 0.23800353415952394, 'psi': 0.9164831588743584}
[S7] START round=24 head_norm_before_train=1.339195 cos_to_last_merge=0.8598 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.860
[S7] round=24 local utility u=0.038245 metrics={'f1_val': 0.5838552996907209, 'auprc': 0.7954876068439177, 'loss_val': 0.6856077808449769, 'psi': 0.6685082225519996}-{'f1_val': 0.5757279802882109, 'auprc': 0.7939434940604615, 'loss_val': 0.7087021193625641, 'psi': 0.6630141857971112}
[S8] START round=24 head_norm_before_train=2.024817 (no previous merge yet)
[S8] round=24 local utility u=0.000000 metrics={'f1_val': 0.9892831449862951, 'auprc': 0.9989864972876763, 'loss_val': 0.0431280287328821, 'psi': 0.9931644859068476}-{'f1_val': 0.9938130760262815, 'auprc': 0.9978944805924501, 'loss_val': 0.03412342773720043, 'psi': 0.995445637852749}
[S9] START round=24 head_norm_before_train=1.341120 cos_to_last_merge=0.9995 (last merge round=22)
[S9] round=24 local utility u=0.000000 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.6611692585771591, 'loss_val': 0.3642651845960037, 'psi': 0.6851976518948748}-{'f1_val': 0.7012904835408967, 'auprc': 0.6635024210939099, 'loss_val': 0.34063481738150164, 'psi': 0.6861752585621019}
[S10] START round=24 head_norm_before_train=1.348423 cos_to_last_merge=1.0000 (last merge round=23)
[S10] round=24 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.994816605012286, 'loss_val': 0.08604682861304824, 'psi': 0.9947758075365378}-{'f1_val': 0.9947486092193725, 'auprc': 0.9962382653245487, 'loss_val': 0.06137372997374164, 'psi': 0.995344471661443}
[S11] START round=24 head_norm_before_train=1.324448 cos_to_last_merge=1.0000 (last merge round=23)
[S11] round=24 local utility u=0.128170 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9961912554908845, 'loss_val': 0.24702323908694254, 'psi': 0.9964047049045075}-{'f1_val': 0.9773789765497642, 'auprc': 0.9969113748542093, 'loss_val': 0.3905159648461511, 'psi': 0.9851919358715423}
[S13] START round=24 head_norm_before_train=1.223353 cos_to_last_merge=1.0000 (last merge round=23)
[S13] round=24 local utility u=0.107342 metrics={'f1_val': 0.602473031442613, 'auprc': 0.6855941811268466, 'loss_val': 0.7746272643621597, 'psi': 0.6357214913163065}-{'f1_val': 0.5809041077767324, 'auprc': 0.6883538332669782, 'loss_val': 0.8681757674626303, 'psi': 0.6238839979728308}
[S14] START round=24 head_norm_before_train=1.440426 cos_to_last_merge=0.9941 (last merge round=20)
[S14] round=24 local utility u=0.016572 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9970478090648134, 'loss_val': 0.11639284444112381, 'psi': 0.9974097944558376}-{'f1_val': 0.9964034173396682, 'auprc': 0.9987439908364794, 'loss_val': 0.1471386506266138, 'psi': 0.9973396467383926}
[S15] START round=24 head_norm_before_train=1.452257 cos_to_last_merge=1.0000 (last merge round=23)
[S15] round=24 local utility u=0.772893 metrics={'f1_val': 0.9800162351796465, 'auprc': 0.9906587738741885, 'loss_val': 0.14982565108903717, 'psi': 0.9842732506574634}-{'f1_val': 0.7557266113353805, 'auprc': 0.9898024168645534, 'loss_val': 0.34730544471065816, 'psi': 0.8493569335470497}
[S16] START round=24 head_norm_before_train=1.716006 cos_to_last_merge=0.8488 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.849
[S16] round=24 local utility u=0.186674 metrics={'f1_val': 0.9919154468144851, 'auprc': 0.9965687452434133, 'loss_val': 0.0541740333479105, 'psi': 0.9937767661860564}-{'f1_val': 0.9452195118652043, 'auprc': 0.9959487885539511, 'loss_val': 0.14548609279909927, 'psi': 0.965511222540703}
[S17] START round=24 head_norm_before_train=1.276871 cos_to_last_merge=1.0000 (last merge round=23)
[S17] round=24 local utility u=0.000000 metrics={'f1_val': 0.6473434655286961, 'auprc': 0.7317634488999122, 'loss_val': 0.7386099568785733, 'psi': 0.6811114588771825}-{'f1_val': 0.6579306966446841, 'auprc': 0.8298250023866063, 'loss_val': 0.657319567339606, 'psi': 0.726688418941453}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S15] → sending delta(kind=head bytes=1806) to S11@127.0.0.1:33212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:33217
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:33204
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] → sending delta(kind=head bytes=1805) to S13@127.0.0.1:33213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:33210
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:33213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:33214
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:33215
[S11] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1805 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1806 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1797) from S11
[S13] cosine check vs S11: cos=0.4024
[S17] RECEIVED delta(kind=head bytes=1798) from S16
[S17] cosine check vs S16: cos=0.6275
[S13] RECEIVED delta(kind=head bytes=1805) from S2
[S13] cosine check vs S2: cos=0.9242
[S4] RECEIVED delta(kind=head bytes=1802) from S13
[S4] cosine check vs S13: cos=0.7816
[S9] RECEIVED delta(kind=head bytes=1799) from S3
[S9] cosine check vs S3: cos=0.9241
[S14] RECEIVED delta(kind=head bytes=1800) from S7
[S14] cosine check vs S7: cos=0.9740
[S11] RECEIVED delta(kind=head bytes=1806) from S15
[S11] cosine check vs S15: cos=0.3291
[S15] RECEIVED delta(kind=head bytes=1803) from S14
[S15] cosine check vs S14: cos=0.9923
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=24 metric=0.9395 head_norm=1.208441
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.055320e-01
[S4] stored merged vector for next round verification (round=24)
[S4] DEBUG after merge:  round=24 metric=0.9399 head_norm=1.157381 delta_norm=0.405532
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=24 metric=0.7012 head_norm=1.369667
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.638924e-01
[S9] stored merged vector for next round verification (round=24)
[S9] DEBUG after merge:  round=24 metric=0.7012 head_norm=1.258852 delta_norm=0.263892
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=24 metric=0.9965 head_norm=1.356845
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.298077e-01
[S11] stored merged vector for next round verification (round=24)
[S11] DEBUG after merge:  round=24 metric=0.9965 head_norm=1.165751 delta_norm=0.829808
[S11] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=24 metric=0.6025 head_norm=1.244043
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.952945e-01
[S13] stored merged vector for next round verification (round=24)
[S13] DEBUG after merge:  round=24 metric=0.6047 head_norm=1.159732 delta_norm=0.195295
[S13] aggregate: ACCEPT kept=['S11', 'S2'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=24 metric=0.9800 head_norm=1.501360
[S15] _apply_head_vector_avg (torch): Δ‖w‖=9.297024e-02
[S15] stored merged vector for next round verification (round=24)
[S15] DEBUG after merge:  round=24 metric=0.9798 head_norm=1.486953 delta_norm=0.092970
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=24 metric=0.9977 head_norm=1.478262
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.730412e-01
[S14] stored merged vector for next round verification (round=24)
[S14] DEBUG after merge:  round=24 metric=0.9977 head_norm=1.405974 delta_norm=0.173041
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=24 metric=0.6473 head_norm=1.324463
[S17] _apply_head_vector_avg (torch): Δ‖w‖=6.854725e-01
[S17] stored merged vector for next round verification (round=24)
[S17] DEBUG after merge:  round=24 metric=0.6484 head_norm=1.382583 delta_norm=0.685472
[S17] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=25 head_norm_before_train=1.682623 cos_to_last_merge=0.7969 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.797
[S2] round=25 local utility u=0.000000 metrics={'f1_val': 0.627753526370787, 'auprc': 0.7591544865176327, 'loss_val': 1.4592973054934295, 'psi': 0.6803139104295253}-{'f1_val': 0.7100138003758066, 'auprc': 0.7742907384451396, 'loss_val': 0.6559713235719936, 'psi': 0.7357245756035399}
[S3] START round=25 head_norm_before_train=1.196957 cos_to_last_merge=0.9991 (last merge round=23)
[S3] round=25 local utility u=0.000000 metrics={'f1_val': 0.9790222182170147, 'auprc': 0.9986840133122797, 'loss_val': 0.2861103486360778, 'psi': 0.9868869362551208}-{'f1_val': 0.9984129976004323, 'auprc': 0.9982237364876092, 'loss_val': 0.21724548681502956, 'psi': 0.9983372931553031}
[S4] START round=25 head_norm_before_train=1.157381 cos_to_last_merge=1.0000 (last merge round=24)
[S4] round=25 local utility u=0.055961 metrics={'f1_val': 0.9458474250622342, 'auprc': 0.9609176445162987, 'loss_val': 0.31673087683557966, 'psi': 0.95187551284386}-{'f1_val': 0.9394728647392114, 'auprc': 0.9437373394834555, 'loss_val': 0.3388640747131709, 'psi': 0.9411786546369091}
[S5] START round=25 head_norm_before_train=1.728555 (no previous merge yet)
[S5] round=25 local utility u=0.250982 metrics={'f1_val': 0.7006542225197299, 'auprc': 0.987735671486562, 'loss_val': 0.24103475821704287, 'psi': 0.8154868021064627}-{'f1_val': 0.7006536512124258, 'auprc': 0.8570081731311279, 'loss_val': 0.35081311512098934, 'psi': 0.7631954599799067}
[S6] START round=25 head_norm_before_train=1.900592 (no previous merge yet)
[S6] round=25 local utility u=0.000000 metrics={'f1_val': 0.6650299808198636, 'auprc': 0.9044498812385547, 'loss_val': 0.7817994166287165, 'psi': 0.7607979409873401}-{'f1_val': 0.7943016278671243, 'auprc': 0.9546021047444189, 'loss_val': 0.5337779729287357, 'psi': 0.8584218186180421}
[S7] START round=25 head_norm_before_train=1.352091 cos_to_last_merge=0.8579 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.858
[S7] round=25 local utility u=0.000000 metrics={'f1_val': 0.5322339732624628, 'auprc': 0.7809357881237408, 'loss_val': 0.9151077820382454, 'psi': 0.631714699206974}-{'f1_val': 0.5838552996907209, 'auprc': 0.7954876068439177, 'loss_val': 0.6856077808449769, 'psi': 0.6685082225519996}
[S8] START round=25 head_norm_before_train=2.035251 (no previous merge yet)
[S8] round=25 local utility u=0.004037 metrics={'f1_val': 0.9942822943870275, 'auprc': 0.9889700605240569, 'loss_val': 0.03500038675027231, 'psi': 0.9921574008418393}-{'f1_val': 0.9892831449862951, 'auprc': 0.9989864972876763, 'loss_val': 0.0431280287328821, 'psi': 0.9931644859068476}
[S9] START round=25 head_norm_before_train=1.258852 cos_to_last_merge=1.0000 (last merge round=24)
[S9] round=25 local utility u=0.000000 metrics={'f1_val': 0.6338398744645928, 'auprc': 0.6711888764235173, 'loss_val': 0.38917618401147486, 'psi': 0.6487794752481626}-{'f1_val': 0.7012165807733519, 'auprc': 0.6611692585771591, 'loss_val': 0.3642651845960037, 'psi': 0.6851976518948748}
[S10] START round=25 head_norm_before_train=1.406796 cos_to_last_merge=0.9987 (last merge round=23)
[S10] round=25 local utility u=0.013576 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9964954041304708, 'loss_val': 0.06393189852475388, 'psi': 0.9954473271838118}-{'f1_val': 0.9947486092193725, 'auprc': 0.994816605012286, 'loss_val': 0.08604682861304824, 'psi': 0.9947758075365378}
[S11] START round=25 head_norm_before_train=1.165751 cos_to_last_merge=1.0000 (last merge round=24)
[S11] round=25 local utility u=0.000000 metrics={'f1_val': 0.9967189926998994, 'auprc': 0.9968102777823539, 'loss_val': 0.30918461049457246, 'psi': 0.9967555067328812}-{'f1_val': 0.9965470045135896, 'auprc': 0.9961912554908845, 'loss_val': 0.24702323908694254, 'psi': 0.9964047049045075}
[S13] START round=25 head_norm_before_train=1.159732 cos_to_last_merge=1.0000 (last merge round=24)
[S13] round=25 local utility u=0.000000 metrics={'f1_val': 0.5700056003656002, 'auprc': 0.6718728451372562, 'loss_val': 0.9508299476122063, 'psi': 0.6107524982742626}-{'f1_val': 0.602473031442613, 'auprc': 0.6855941811268466, 'loss_val': 0.7746272643621597, 'psi': 0.6357214913163065}
[S14] START round=25 head_norm_before_train=1.405974 cos_to_last_merge=1.0000 (last merge round=24)
[S14] round=25 local utility u=0.000000 metrics={'f1_val': 0.998062872566559, 'auprc': 0.9986330682962049, 'loss_val': 0.14062949040968778, 'psi': 0.9982909508584173}-{'f1_val': 0.9976511180498535, 'auprc': 0.9970478090648134, 'loss_val': 0.11639284444112381, 'psi': 0.9974097944558376}
[S15] START round=25 head_norm_before_train=1.486953 cos_to_last_merge=1.0000 (last merge round=24)
[S15] round=25 local utility u=0.027345 metrics={'f1_val': 0.9853779990883862, 'auprc': 0.9913160595619062, 'loss_val': 0.12927907088969706, 'psi': 0.9877532232777941}-{'f1_val': 0.9800162351796465, 'auprc': 0.9906587738741885, 'loss_val': 0.14982565108903717, 'psi': 0.9842732506574634}
[S16] START round=25 head_norm_before_train=1.734536 cos_to_last_merge=0.8478 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.848
[S16] round=25 local utility u=0.000000 metrics={'f1_val': 0.8405238615343497, 'auprc': 0.9947979468773734, 'loss_val': 0.8224411737203455, 'psi': 0.9022334956715592}-{'f1_val': 0.9919154468144851, 'auprc': 0.9965687452434133, 'loss_val': 0.0541740333479105, 'psi': 0.9937767661860564}
[S17] START round=25 head_norm_before_train=1.382583 cos_to_last_merge=1.0000 (last merge round=24)
[S17] round=25 local utility u=0.917978 metrics={'f1_val': 0.8032614688437779, 'auprc': 0.955572481028696, 'loss_val': 0.509588474340123, 'psi': 0.8641858737177451}-{'f1_val': 0.6473434655286961, 'auprc': 0.7317634488999122, 'loss_val': 0.7386099568785733, 'psi': 0.6811114588771825}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S17@127.0.0.1:33217
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:33211
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S15] → sending delta(kind=head bytes=1807) to S11@127.0.0.1:33212
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:33203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:33216
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1807 to 1 peers)
[S8] sending update (kind=head size=1794 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1802) from S10
[S3] cosine check vs S10: cos=0.8054
[S10] RECEIVED delta(kind=head bytes=1798) from S4
[S10] cosine check vs S4: cos=0.8609
[S11] RECEIVED delta(kind=head bytes=1807) from S15
[S11] cosine check vs S15: cos=0.8207
[S16] RECEIVED delta(kind=head bytes=1802) from S5
[S16] cosine check vs S5: cos=-0.0286
[S16] DROPPED delta from S5 (cos=-0.0286 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1794) from S8
[S17] cosine check vs S8: cos=0.3306
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:33203
[S17] sending update (kind=head size=1803 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1803) from S17
[S3] cosine check vs S17: cos=0.7277
[S13] ⇄ pheromone p=0.069 → S4@127.0.0.1:33204
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=25 metric=0.9790 head_norm=1.239079
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.224942e-01
[S3] stored merged vector for next round verification (round=25)
[S3] DEBUG after merge:  round=25 metric=0.8987 head_norm=1.193473 delta_norm=0.222494
[S3] aggregate: ROLLBACK (f1_val pre=0.979 post=0.899 tol_abs=0.005 tol_rel=0.0)
[S3] ⇄ pheromone p=0.270 → S9@127.0.0.1:33210
[S2] ⇄ pheromone p=0.126 → S13@127.0.0.1:33213
[S14] ⇄ pheromone p=0.056 → S15@127.0.0.1:33215
[S9] ⇄ pheromone p=0.080 → S17@127.0.0.1:33217
[S6] ⇄ pheromone p=0.205 → S11@127.0.0.1:33212
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=25 metric=0.9967 head_norm=1.198643
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.403937e-01
[S11] stored merged vector for next round verification (round=25)
[S11] DEBUG after merge:  round=25 metric=0.9967 head_norm=1.306388 delta_norm=0.440394
[S11] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.159 → S13@127.0.0.1:33213
[S7] ⇄ pheromone p=0.132 → S14@127.0.0.1:33214
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=25 metric=0.9947 head_norm=1.468718
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.739362e-01
[S10] stored merged vector for next round verification (round=25)
[S10] DEBUG after merge:  round=25 metric=0.9945 head_norm=1.304993 delta_norm=0.373936
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.030 → S3@127.0.0.1:33203
[S4] ⇄ pheromone p=0.049 → S10@127.0.0.1:33211
[S15] ⇄ pheromone p=0.253 → S11@127.0.0.1:33212
[S8] ⇄ pheromone p=0.063 → S17@127.0.0.1:33217
[S5] ⇄ pheromone p=0.138 → S16@127.0.0.1:33216
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=25 metric=0.8033 head_norm=1.423985
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.034804e+00
[S17] stored merged vector for next round verification (round=25)
[S17] DEBUG after merge:  round=25 metric=0.8290 head_norm=1.426028 delta_norm=1.034804
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.265 → S3@127.0.0.1:33203
[S16] ⇄ pheromone p=0.109 → S17@127.0.0.1:33217
[S2] START round=26 head_norm_before_train=1.694954 cos_to_last_merge=0.7957 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.796
[S2] round=26 local utility u=0.000000 metrics={'f1_val': 0.5527993072196927, 'auprc': 0.6127565553926758, 'loss_val': 1.4682092204822623, 'psi': 0.5767822064888859}-{'f1_val': 0.627753526370787, 'auprc': 0.7591544865176327, 'loss_val': 1.4592973054934295, 'psi': 0.6803139104295253}
[S3] START round=26 head_norm_before_train=1.193473 cos_to_last_merge=1.0000 (last merge round=25)
[S3] round=26 local utility u=0.000000 metrics={'f1_val': 0.6894646084820601, 'auprc': 0.8263546937180278, 'loss_val': 0.4952865556650584, 'psi': 0.7442206425764473}-{'f1_val': 0.9790222182170147, 'auprc': 0.9986840133122797, 'loss_val': 0.2861103486360778, 'psi': 0.9868869362551208}
[S4] START round=26 head_norm_before_train=1.236339 cos_to_last_merge=0.9938 (last merge round=24)
[S4] round=26 local utility u=0.000000 metrics={'f1_val': 0.939763755512591, 'auprc': 0.9554035762978108, 'loss_val': 0.3166518486107618, 'psi': 0.9460196838266789}-{'f1_val': 0.9458474250622342, 'auprc': 0.9609176445162987, 'loss_val': 0.31673087683557966, 'psi': 0.95187551284386}
[S5] START round=26 head_norm_before_train=1.746077 (no previous merge yet)
[S5] round=26 local utility u=0.000000 metrics={'f1_val': 0.6705046057304068, 'auprc': 0.8589934937986176, 'loss_val': 0.40241706722490933, 'psi': 0.7459001609576912}-{'f1_val': 0.7006542225197299, 'auprc': 0.987735671486562, 'loss_val': 0.24103475821704287, 'psi': 0.8154868021064627}
[S6] START round=26 head_norm_before_train=1.920831 (no previous merge yet)
[S6] round=26 local utility u=0.727271 metrics={'f1_val': 0.8316219189197667, 'auprc': 0.9395179993045244, 'loss_val': 0.43201403590960125, 'psi': 0.8747803510736698}-{'f1_val': 0.6650299808198636, 'auprc': 0.9044498812385547, 'loss_val': 0.7817994166287165, 'psi': 0.7607979409873401}
[S7] START round=26 head_norm_before_train=1.361905 cos_to_last_merge=0.8564 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.856
[S7] round=26 local utility u=0.000000 metrics={'f1_val': 0.5278740404732741, 'auprc': 0.7843311947057803, 'loss_val': 0.9066026671309423, 'psi': 0.6304569021662766}-{'f1_val': 0.5322339732624628, 'auprc': 0.7809357881237408, 'loss_val': 0.9151077820382454, 'psi': 0.631714699206974}
[S8] START round=26 head_norm_before_train=2.044754 (no previous merge yet)
[S8] round=26 local utility u=0.001079 metrics={'f1_val': 0.9942822943870275, 'auprc': 0.9893680102026025, 'loss_val': 0.03403689125136734, 'psi': 0.9923165807132576}-{'f1_val': 0.9942822943870275, 'auprc': 0.9889700605240569, 'loss_val': 0.03500038675027231, 'psi': 0.9921574008418393}
[S9] START round=26 head_norm_before_train=1.287856 cos_to_last_merge=0.9994 (last merge round=24)
[S9] round=26 local utility u=0.727195 metrics={'f1_val': 0.7024932145862333, 'auprc': 0.9848639240261559, 'loss_val': 0.2877318761651799, 'psi': 0.8154414983622023}-{'f1_val': 0.6338398744645928, 'auprc': 0.6711888764235173, 'loss_val': 0.38917618401147486, 'psi': 0.6487794752481626}
[S10] START round=26 head_norm_before_train=1.304993 cos_to_last_merge=1.0000 (last merge round=25)
[S10] round=26 local utility u=0.000000 metrics={'f1_val': 0.9942851896505369, 'auprc': 0.9962490581172406, 'loss_val': 0.09605814505536184, 'psi': 0.9950707370372184}-{'f1_val': 0.9947486092193725, 'auprc': 0.9964954041304708, 'loss_val': 0.06393189852475388, 'psi': 0.9954473271838118}
[S11] START round=26 head_norm_before_train=1.306388 cos_to_last_merge=1.0000 (last merge round=25)
[S11] round=26 local utility u=0.000000 metrics={'f1_val': 0.996960829744628, 'auprc': 0.9977561686873432, 'loss_val': 0.34083104991154856, 'psi': 0.997278965321714}-{'f1_val': 0.9967189926998994, 'auprc': 0.9968102777823539, 'loss_val': 0.30918461049457246, 'psi': 0.9967555067328812}
[S13] START round=26 head_norm_before_train=1.186994 cos_to_last_merge=0.9985 (last merge round=24)
[S13] round=26 local utility u=0.179635 metrics={'f1_val': 0.6085646925584381, 'auprc': 0.6484182149314794, 'loss_val': 0.752550838223457, 'psi': 0.6245061015076547}-{'f1_val': 0.5700056003656002, 'auprc': 0.6718728451372562, 'loss_val': 0.9508299476122063, 'psi': 0.6107524982742626}
[S14] START round=26 head_norm_before_train=1.441640 cos_to_last_merge=0.9994 (last merge round=24)
[S14] round=26 local utility u=0.012815 metrics={'f1_val': 0.9980623665153463, 'auprc': 0.9986528463833547, 'loss_val': 0.115055573030583, 'psi': 0.9982985584625497}-{'f1_val': 0.998062872566559, 'auprc': 0.9986330682962049, 'loss_val': 0.14062949040968778, 'psi': 0.9982909508584173}
[S15] START round=26 head_norm_before_train=1.537676 cos_to_last_merge=0.9987 (last merge round=24)
[S15] round=26 local utility u=0.000000 metrics={'f1_val': 0.6979397577927536, 'auprc': 0.983068402256243, 'loss_val': 0.43972053157923646, 'psi': 0.8119912155781495}-{'f1_val': 0.9853779990883862, 'auprc': 0.9913160595619062, 'loss_val': 0.12927907088969706, 'psi': 0.9877532232777941}
[S16] START round=26 head_norm_before_train=1.751982 cos_to_last_merge=0.8468 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.847
[S16] round=26 local utility u=0.000000 metrics={'f1_val': 0.8406690113560773, 'auprc': 0.9943851754090063, 'loss_val': 0.8474941869292013, 'psi': 0.9021554769772488}-{'f1_val': 0.8405238615343497, 'auprc': 0.9947979468773734, 'loss_val': 0.8224411737203455, 'psi': 0.9022334956715592}
[S17] START round=26 head_norm_before_train=1.426028 cos_to_last_merge=1.0000 (last merge round=25)
[S17] round=26 local utility u=0.000000 metrics={'f1_val': 0.6436408723281837, 'auprc': 0.7262614803335747, 'loss_val': 0.7496479897130589, 'psi': 0.6766891155303401}-{'f1_val': 0.8032614688437779, 'auprc': 0.955572481028696, 'loss_val': 0.509588474340123, 'psi': 0.8641858737177451}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:33217
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S17@127.0.0.1:33217
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:33204
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:33215
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:33212
[S14] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1794 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1797) from S6
[S11] cosine check vs S6: cos=0.2134
[S17] RECEIVED delta(kind=head bytes=1794) from S8
[S17] cosine check vs S8: cos=0.8721
[S17] RECEIVED delta(kind=head bytes=1799) from S9
[S17] cosine check vs S9: cos=0.4458
[S15] RECEIVED delta(kind=head bytes=1802) from S14
[S15] cosine check vs S14: cos=0.9876
[S4] RECEIVED delta(kind=head bytes=1799) from S13
[S4] cosine check vs S13: cos=0.9268
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=26 metric=0.9970 head_norm=1.334930
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.051723e+00
[S11] stored merged vector for next round verification (round=26)
[S11] DEBUG after merge:  round=26 metric=0.9970 head_norm=1.287443 delta_norm=1.051723
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=26 metric=0.9398 head_norm=1.317476
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.474408e-01
[S4] stored merged vector for next round verification (round=26)
[S4] DEBUG after merge:  round=26 metric=0.9399 head_norm=1.244568 delta_norm=0.247441
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=26 metric=0.6979 head_norm=1.583685
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.312992e-01
[S15] stored merged vector for next round verification (round=26)
[S15] DEBUG after merge:  round=26 metric=0.6990 head_norm=1.527399 delta_norm=0.131299
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=26 metric=0.6436 head_norm=1.463856
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.940573e-01
[S17] stored merged vector for next round verification (round=26)
[S17] DEBUG after merge:  round=26 metric=0.6426 head_norm=1.353065 delta_norm=0.294057
[S17] aggregate: ACCEPT kept=['S8', 'S9'] (k=2/2) mode=median trim_p=0.1
[S2] START round=27 head_norm_before_train=1.704349 cos_to_last_merge=0.7946 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.795
[S2] round=27 local utility u=0.948911 metrics={'f1_val': 0.6664689580247743, 'auprc': 0.7474711007541227, 'loss_val': 0.6565496350884724, 'psi': 0.6988698151165137}-{'f1_val': 0.5527993072196927, 'auprc': 0.6127565553926758, 'loss_val': 1.4682092204822623, 'psi': 0.5767822064888859}
[S3] START round=27 head_norm_before_train=1.234086 cos_to_last_merge=0.9994 (last merge round=25)
[S3] round=27 local utility u=0.816289 metrics={'f1_val': 0.8624879777105943, 'auprc': 0.9533717430447346, 'loss_val': 0.28189983921883827, 'psi': 0.8988414838442504}-{'f1_val': 0.6894646084820601, 'auprc': 0.8263546937180278, 'loss_val': 0.4952865556650584, 'psi': 0.7442206425764473}
[S4] START round=27 head_norm_before_train=1.244568 cos_to_last_merge=1.0000 (last merge round=26)
[S4] round=27 local utility u=0.000000 metrics={'f1_val': 0.7653442976080951, 'auprc': 0.9375723957612246, 'loss_val': 0.5026363247937434, 'psi': 0.8342355368693469}-{'f1_val': 0.939763755512591, 'auprc': 0.9554035762978108, 'loss_val': 0.3166518486107618, 'psi': 0.9460196838266789}
[S5] START round=27 head_norm_before_train=1.758153 (no previous merge yet)
[S5] round=27 local utility u=0.430668 metrics={'f1_val': 0.7068177015791657, 'auprc': 0.9920933362320841, 'loss_val': 0.15825831915085128, 'psi': 0.820927955440333}-{'f1_val': 0.6705046057304068, 'auprc': 0.8589934937986176, 'loss_val': 0.40241706722490933, 'psi': 0.7459001609576912}
[S6] START round=27 head_norm_before_train=1.935258 (no previous merge yet)
[S6] round=27 local utility u=0.000000 metrics={'f1_val': 0.6391475524352124, 'auprc': 0.9408254177910921, 'loss_val': 0.723495553417247, 'psi': 0.7598186985775643}-{'f1_val': 0.8316219189197667, 'auprc': 0.9395179993045244, 'loss_val': 0.43201403590960125, 'psi': 0.8747803510736698}
[S7] START round=27 head_norm_before_train=1.368797 cos_to_last_merge=0.8550 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.855
[S7] round=27 local utility u=0.482789 metrics={'f1_val': 0.6261565442578947, 'auprc': 0.8000384075984168, 'loss_val': 0.5778421107524224, 'psi': 0.6957092895941035}-{'f1_val': 0.5278740404732741, 'auprc': 0.7843311947057803, 'loss_val': 0.9066026671309423, 'psi': 0.6304569021662766}
[S8] START round=27 head_norm_before_train=2.058053 (no previous merge yet)
[S8] round=27 local utility u=0.000000 metrics={'f1_val': 0.9900027071046373, 'auprc': 0.999082041012735, 'loss_val': 0.039374263141670925, 'psi': 0.9936344406678763}-{'f1_val': 0.9942822943870275, 'auprc': 0.9893680102026025, 'loss_val': 0.03403689125136734, 'psi': 0.9923165807132576}
[S9] START round=27 head_norm_before_train=1.319537 cos_to_last_merge=0.9979 (last merge round=24)
[S9] round=27 local utility u=0.867595 metrics={'f1_val': 0.9795724336638646, 'auprc': 0.99568832289685, 'loss_val': 0.24749035473888167, 'psi': 0.9860187893570587}-{'f1_val': 0.7024932145862333, 'auprc': 0.9848639240261559, 'loss_val': 0.2877318761651799, 'psi': 0.8154414983622023}
[S10] START round=27 head_norm_before_train=1.372932 cos_to_last_merge=0.9983 (last merge round=25)
[S10] round=27 local utility u=0.014263 metrics={'f1_val': 0.9940903254969471, 'auprc': 0.9967159616137047, 'loss_val': 0.0677640696595007, 'psi': 0.9951405799436501}-{'f1_val': 0.9942851896505369, 'auprc': 0.9962490581172406, 'loss_val': 0.09605814505536184, 'psi': 0.9950707370372184}
[S11] START round=27 head_norm_before_train=1.287443 cos_to_last_merge=1.0000 (last merge round=26)
[S11] round=27 local utility u=0.072208 metrics={'f1_val': 0.9967189926998994, 'auprc': 0.9977973991795435, 'loss_val': 0.1950884272538927, 'psi': 0.997150355291757}-{'f1_val': 0.996960829744628, 'auprc': 0.9977561686873432, 'loss_val': 0.34083104991154856, 'psi': 0.997278965321714}
[S13] START round=27 head_norm_before_train=1.218447 cos_to_last_merge=0.9949 (last merge round=24)
[S13] round=27 local utility u=0.000000 metrics={'f1_val': 0.5976451844999402, 'auprc': 0.6731404114432367, 'loss_val': 0.9006419203064814, 'psi': 0.6278432752772588}-{'f1_val': 0.6085646925584381, 'auprc': 0.6484182149314794, 'loss_val': 0.752550838223457, 'psi': 0.6245061015076547}
[S14] START round=27 head_norm_before_train=1.480648 cos_to_last_merge=0.9978 (last merge round=24)
[S14] round=27 local utility u=0.010648 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9986393042108377, 'loss_val': 0.09125182052727099, 'psi': 0.9980463925142472}-{'f1_val': 0.9980623665153463, 'auprc': 0.9986528463833547, 'loss_val': 0.115055573030583, 'psi': 0.9982985584625497}
[S15] START round=27 head_norm_before_train=1.527399 cos_to_last_merge=1.0000 (last merge round=26)
[S15] round=27 local utility u=0.050595 metrics={'f1_val': 0.7145709719903273, 'auprc': 0.9806430499482763, 'loss_val': 0.43104214795647416, 'psi': 0.8209998031735068}-{'f1_val': 0.6979397577927536, 'auprc': 0.983068402256243, 'loss_val': 0.43972053157923646, 'psi': 0.8119912155781495}
[S16] START round=27 head_norm_before_train=1.769278 cos_to_last_merge=0.8457 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.846
[S16] round=27 local utility u=0.065473 metrics={'f1_val': 0.850553936240216, 'auprc': 0.9924801778088994, 'loss_val': 0.7701421780700013, 'psi': 0.9073244328676893}-{'f1_val': 0.8406690113560773, 'auprc': 0.9943851754090063, 'loss_val': 0.8474941869292013, 'psi': 0.9021554769772488}
[S17] START round=27 head_norm_before_train=1.353065 cos_to_last_merge=1.0000 (last merge round=26)
[S17] round=27 local utility u=0.295841 metrics={'f1_val': 0.625038528906787, 'auprc': 0.9057980011903544, 'loss_val': 0.5849620759183124, 'psi': 0.7373423178202139}-{'f1_val': 0.6436408723281837, 'auprc': 0.7262614803335747, 'loss_val': 0.7496479897130589, 'psi': 0.6766891155303401}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:33217
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:33205
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S10] → sending delta(kind=head bytes=1791) to S4@127.0.0.1:33204
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S3@127.0.0.1:33203
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:33214
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:33208
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:33215
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1804 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1804 to 1 peers)
[S10] sending update (kind=head size=1791 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1801) from S16
[S5] cosine check vs S16: cos=-0.0264
[S5] DROPPED delta from S16 (cos=-0.0264 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1804) from S9
[S3] cosine check vs S9: cos=0.9647
[S7] RECEIVED delta(kind=head bytes=1804) from S14
[S7] cosine check vs S14: cos=0.9772
[S15] RECEIVED delta(kind=head bytes=1802) from S11
[S15] cosine check vs S11: cos=0.4468
[S17] RECEIVED delta(kind=head bytes=1802) from S3
[S17] cosine check vs S3: cos=0.6401
[S14] RECEIVED delta(kind=head bytes=1802) from S15
[S14] cosine check vs S15: cos=0.9935
[S4] RECEIVED delta(kind=head bytes=1791) from S10
[S4] cosine check vs S10: cos=0.9099
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:33216
[S17] sending update (kind=head size=1801 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1801) from S17
[S16] cosine check vs S17: cos=0.3756
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=27 metric=0.7653 head_norm=1.294620
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.002700e-01
[S4] stored merged vector for next round verification (round=27)
[S4] DEBUG after merge:  round=27 metric=0.7661 head_norm=1.339479 delta_norm=0.300270
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=27 metric=0.6262 head_norm=1.377868
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.695530e-01
[S7] stored merged vector for next round verification (round=27)
[S7] DEBUG after merge:  round=27 metric=0.6296 head_norm=1.439697 delta_norm=0.169553
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=27 metric=0.7146 head_norm=1.570888
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.675632e-01
[S15] stored merged vector for next round verification (round=27)
[S15] DEBUG after merge:  round=27 metric=0.7324 head_norm=1.231068 delta_norm=0.767563
[S15] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=27 metric=0.8625 head_norm=1.275192
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.780309e-01
[S3] stored merged vector for next round verification (round=27)
[S3] DEBUG after merge:  round=27 metric=0.8700 head_norm=1.299948 delta_norm=0.178031
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=27 metric=0.8506 head_norm=1.785781
[S16] _apply_head_vector_avg (torch): Δ‖w‖=9.045203e-01
[S16] stored merged vector for next round verification (round=27)
[S16] DEBUG after merge:  round=27 metric=0.8530 head_norm=1.325819 delta_norm=0.904520
[S16] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=27 metric=0.9977 head_norm=1.518034
[S14] _apply_head_vector_avg (torch): Δ‖w‖=9.197415e-02
[S14] stored merged vector for next round verification (round=27)
[S14] DEBUG after merge:  round=27 metric=0.9977 head_norm=1.541946 delta_norm=0.091974
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=27 metric=0.6250 head_norm=1.401033
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.704672e-01
[S17] stored merged vector for next round verification (round=27)
[S17] DEBUG after merge:  round=27 metric=0.6188 head_norm=1.212052 delta_norm=0.570467
[S17] aggregate: ROLLBACK (f1_val pre=0.625 post=0.619 tol_abs=0.005 tol_rel=0.0)
[S2] START round=28 head_norm_before_train=1.713180 cos_to_last_merge=0.7937 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.794
[S2] round=28 local utility u=0.151294 metrics={'f1_val': 0.710683105316453, 'auprc': 0.7768965031415287, 'loss_val': 0.7075233061830787, 'psi': 0.7371684644464833}-{'f1_val': 0.6664689580247743, 'auprc': 0.7474711007541227, 'loss_val': 0.6565496350884724, 'psi': 0.6988698151165137}
[S3] START round=28 head_norm_before_train=1.299948 cos_to_last_merge=1.0000 (last merge round=27)
[S3] round=28 local utility u=0.211648 metrics={'f1_val': 0.9107367597785471, 'auprc': 0.9756684451014256, 'loss_val': 0.2149874535852957, 'psi': 0.9367094339076985}-{'f1_val': 0.8624879777105943, 'auprc': 0.9533717430447346, 'loss_val': 0.28189983921883827, 'psi': 0.8988414838442504}
[S4] START round=28 head_norm_before_train=1.339479 cos_to_last_merge=1.0000 (last merge round=27)
[S4] round=28 local utility u=0.000000 metrics={'f1_val': 0.6264963307892194, 'auprc': 0.9277137881963999, 'loss_val': 0.656864643860899, 'psi': 0.7469833137520916}-{'f1_val': 0.7653442976080951, 'auprc': 0.9375723957612246, 'loss_val': 0.5026363247937434, 'psi': 0.8342355368693469}
[S5] START round=28 head_norm_before_train=1.766039 (no previous merge yet)
[S5] round=28 local utility u=0.000000 metrics={'f1_val': 0.5888940296438216, 'auprc': 0.8544125081127875, 'loss_val': 0.5818158803231058, 'psi': 0.6951014210314079}-{'f1_val': 0.7068177015791657, 'auprc': 0.9920933362320841, 'loss_val': 0.15825831915085128, 'psi': 0.820927955440333}
[S6] START round=28 head_norm_before_train=1.943994 (no previous merge yet)
[S6] round=28 local utility u=0.000000 metrics={'f1_val': 0.616987302206949, 'auprc': 0.9255943456481779, 'loss_val': 0.9107014394263366, 'psi': 0.7404301195834406}-{'f1_val': 0.6391475524352124, 'auprc': 0.9408254177910921, 'loss_val': 0.723495553417247, 'psi': 0.7598186985775643}
[S7] START round=28 head_norm_before_train=1.439697 cos_to_last_merge=1.0000 (last merge round=27)
[S7] round=28 local utility u=0.260445 metrics={'f1_val': 0.6815281329503594, 'auprc': 0.8131498735542417, 'loss_val': 0.4285168613010537, 'psi': 0.7341768291919124}-{'f1_val': 0.6261565442578947, 'auprc': 0.8000384075984168, 'loss_val': 0.5778421107524224, 'psi': 0.6957092895941035}
[S8] START round=28 head_norm_before_train=2.073993 (no previous merge yet)
[S8] round=28 local utility u=0.000000 metrics={'f1_val': 0.9875097078386601, 'auprc': 0.999082033763691, 'loss_val': 0.046815192597075096, 'psi': 0.9921386382086724}-{'f1_val': 0.9900027071046373, 'auprc': 0.999082041012735, 'loss_val': 0.039374263141670925, 'psi': 0.9936344406678763}
[S9] START round=28 head_norm_before_train=1.347963 cos_to_last_merge=0.9962 (last merge round=24)
[S9] round=28 local utility u=0.060261 metrics={'f1_val': 0.986144618344318, 'auprc': 0.9983498407610298, 'loss_val': 0.17438565696268585, 'psi': 0.9910267073110026}-{'f1_val': 0.9795724336638646, 'auprc': 0.99568832289685, 'loss_val': 0.24749035473888167, 'psi': 0.9860187893570587}
[S10] START round=28 head_norm_before_train=1.446613 cos_to_last_merge=0.9939 (last merge round=25)
[S10] round=28 local utility u=0.006893 metrics={'f1_val': 0.9942851896505369, 'auprc': 0.9967129245813992, 'loss_val': 0.055139050945121844, 'psi': 0.9952562836228818}-{'f1_val': 0.9940903254969471, 'auprc': 0.9967159616137047, 'loss_val': 0.0677640696595007, 'psi': 0.9951405799436501}
[S11] START round=28 head_norm_before_train=1.319725 cos_to_last_merge=0.9989 (last merge round=26)
[S11] round=28 local utility u=0.012669 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9962608459509024, 'loss_val': 0.16410975191063346, 'psi': 0.9964325410885146}-{'f1_val': 0.9967189926998994, 'auprc': 0.9977973991795435, 'loss_val': 0.1950884272538927, 'psi': 0.997150355291757}
[S13] START round=28 head_norm_before_train=1.244682 cos_to_last_merge=0.9912 (last merge round=24)
[S13] round=28 local utility u=0.000000 metrics={'f1_val': 0.5585437584693896, 'auprc': 0.6784401489040395, 'loss_val': 0.8363063571672852, 'psi': 0.6065023146432496}-{'f1_val': 0.5976451844999402, 'auprc': 0.6731404114432367, 'loss_val': 0.9006419203064814, 'psi': 0.6278432752772588}
[S14] START round=28 head_norm_before_train=1.541946 cos_to_last_merge=1.0000 (last merge round=27)
[S14] round=28 local utility u=0.007008 metrics={'f1_val': 0.9972435617623723, 'auprc': 0.9983617428180807, 'loss_val': 0.0739585216547275, 'psi': 0.9976908341846557}-{'f1_val': 0.9976511180498535, 'auprc': 0.9986393042108377, 'loss_val': 0.09125182052727099, 'psi': 0.9980463925142472}
[S15] START round=28 head_norm_before_train=1.231068 cos_to_last_merge=1.0000 (last merge round=27)
[S15] round=28 local utility u=0.280806 metrics={'f1_val': 0.7805612842532181, 'auprc': 0.9886705126512858, 'loss_val': 0.28945442499608504, 'psi': 0.8638049756124452}-{'f1_val': 0.7145709719903273, 'auprc': 0.9806430499482763, 'loss_val': 0.43104214795647416, 'psi': 0.8209998031735068}
[S16] START round=28 head_norm_before_train=1.325819 cos_to_last_merge=1.0000 (last merge round=27)
[S16] round=28 local utility u=0.528624 metrics={'f1_val': 0.9385387005647127, 'auprc': 0.9965647282705145, 'loss_val': 0.2530570702080634, 'psi': 0.9617491116470334}-{'f1_val': 0.850553936240216, 'auprc': 0.9924801778088994, 'loss_val': 0.7701421780700013, 'psi': 0.9073244328676893}
[S17] START round=28 head_norm_before_train=1.212052 cos_to_last_merge=1.0000 (last merge round=27)
[S17] round=28 local utility u=0.000000 metrics={'f1_val': 0.5995102288251863, 'auprc': 0.7822087371026525, 'loss_val': 0.8955642584023644, 'psi': 0.6725896321361728}-{'f1_val': 0.625038528906787, 'auprc': 0.9057980011903544, 'loss_val': 0.5849620759183124, 'psi': 0.7373423178202139}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:33215
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:33204
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S7] sending update (kind=head size=1807 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:33217
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:33214
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:33203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] → sending delta(kind=head bytes=1805) to S7@127.0.0.1:33208
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S16] → sending delta(kind=head bytes=1808) to S5@127.0.0.1:33205
[S9] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1808 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1805 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1802) from S3
[S17] cosine check vs S3: cos=0.8624
[S14] RECEIVED delta(kind=head bytes=1801) from S15
[S14] cosine check vs S15: cos=0.8792
[S15] RECEIVED delta(kind=head bytes=1798) from S11
[S15] cosine check vs S11: cos=0.8041
[S4] RECEIVED delta(kind=head bytes=1799) from S10
[S4] cosine check vs S10: cos=0.9767
[S5] RECEIVED delta(kind=head bytes=1808) from S16
[S5] cosine check vs S16: cos=-0.0680
[S5] DROPPED delta from S16 (cos=-0.0680 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1805) from S14
[S7] cosine check vs S14: cos=0.9899
[S3] RECEIVED delta(kind=head bytes=1800) from S9
[S3] cosine check vs S9: cos=0.9896
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=28 metric=0.6265 head_norm=1.377955
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.685495e-01
[S4] stored merged vector for next round verification (round=28)
[S4] DEBUG after merge:  round=28 metric=0.6265 head_norm=1.434172 delta_norm=0.168549
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=28 metric=0.6815 head_norm=1.447328
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.252414e-01
[S7] stored merged vector for next round verification (round=28)
[S7] DEBUG after merge:  round=28 metric=0.6829 head_norm=1.508033 delta_norm=0.125241
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=28 metric=0.9972 head_norm=1.576369
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.781001e-01
[S14] stored merged vector for next round verification (round=28)
[S14] DEBUG after merge:  round=28 metric=0.9972 head_norm=1.392986 delta_norm=0.378100
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=28 metric=0.9107 head_norm=1.336041
[S3] _apply_head_vector_avg (torch): Δ‖w‖=9.986836e-02
[S3] stored merged vector for next round verification (round=28)
[S3] DEBUG after merge:  round=28 metric=0.9045 head_norm=1.352669 delta_norm=0.099868
[S3] aggregate: ROLLBACK (f1_val pre=0.911 post=0.904 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=28 metric=0.7806 head_norm=1.296842
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.154234e-01
[S15] stored merged vector for next round verification (round=28)
[S15] DEBUG after merge:  round=28 metric=0.7896 head_norm=1.258034 delta_norm=0.415423
[S15] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=28 metric=0.5995 head_norm=1.266414
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.430061e-01
[S17] stored merged vector for next round verification (round=28)
[S17] DEBUG after merge:  round=28 metric=0.5831 head_norm=1.255688 delta_norm=0.343006
[S17] aggregate: ROLLBACK (f1_val pre=0.600 post=0.583 tol_abs=0.005 tol_rel=0.0)
[S2] START round=29 head_norm_before_train=1.723954 cos_to_last_merge=0.7930 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.793
[S2] round=29 local utility u=0.000000 metrics={'f1_val': 0.7125276388541071, 'auprc': 0.7728652464270355, 'loss_val': 0.7804070348451893, 'psi': 0.7366626818832784}-{'f1_val': 0.710683105316453, 'auprc': 0.7768965031415287, 'loss_val': 0.7075233061830787, 'psi': 0.7371684644464833}
[S3] START round=29 head_norm_before_train=1.352669 cos_to_last_merge=1.0000 (last merge round=28)
[S3] round=29 local utility u=0.348459 metrics={'f1_val': 0.9990790987190017, 'auprc': 0.9994975081615324, 'loss_val': 0.11961146287499039, 'psi': 0.999246462496014}-{'f1_val': 0.9107367597785471, 'auprc': 0.9756684451014256, 'loss_val': 0.2149874535852957, 'psi': 0.9367094339076985}
[S4] START round=29 head_norm_before_train=1.434172 cos_to_last_merge=1.0000 (last merge round=28)
[S4] round=29 local utility u=1.000000 metrics={'f1_val': 0.948338166804029, 'auprc': 0.9600110249453144, 'loss_val': 0.27687052162371784, 'psi': 0.9530073100605432}-{'f1_val': 0.6264963307892194, 'auprc': 0.9277137881963999, 'loss_val': 0.656864643860899, 'psi': 0.7469833137520916}
[S5] START round=29 head_norm_before_train=1.772301 (no previous merge yet)
[S5] round=29 local utility u=0.219214 metrics={'f1_val': 0.6449613486395356, 'auprc': 0.8557787168892991, 'loss_val': 0.4838910557587022, 'psi': 0.729288295939441}-{'f1_val': 0.5888940296438216, 'auprc': 0.8544125081127875, 'loss_val': 0.5818158803231058, 'psi': 0.6951014210314079}
[S6] START round=29 head_norm_before_train=1.955826 (no previous merge yet)
[S6] round=29 local utility u=1.000000 metrics={'f1_val': 0.9630327807189332, 'auprc': 0.9610221598329659, 'loss_val': 0.1593599778577741, 'psi': 0.9622285323645463}-{'f1_val': 0.616987302206949, 'auprc': 0.9255943456481779, 'loss_val': 0.9107014394263366, 'psi': 0.7404301195834406}
[S7] START round=29 head_norm_before_train=1.508033 cos_to_last_merge=1.0000 (last merge round=28)
[S7] round=29 local utility u=0.000000 metrics={'f1_val': 0.5969654126084254, 'auprc': 0.793181656633081, 'loss_val': 0.6198319827105107, 'psi': 0.6754519102182877}-{'f1_val': 0.6815281329503594, 'auprc': 0.8131498735542417, 'loss_val': 0.4285168613010537, 'psi': 0.7341768291919124}
[S8] START round=29 head_norm_before_train=2.081331 (no previous merge yet)
[S8] round=29 local utility u=0.026191 metrics={'f1_val': 0.9938130760262815, 'auprc': 0.9989011674335054, 'loss_val': 0.031710599778992765, 'psi': 0.9958483125891711}-{'f1_val': 0.9875097078386601, 'auprc': 0.999082033763691, 'loss_val': 0.046815192597075096, 'psi': 0.9921386382086724}
[S9] START round=29 head_norm_before_train=1.376360 cos_to_last_merge=0.9942 (last merge round=24)
[S9] round=29 local utility u=0.000000 metrics={'f1_val': 0.9770228457531879, 'auprc': 0.9988471751522803, 'loss_val': 0.1489714326191651, 'psi': 0.9857525775128249}-{'f1_val': 0.986144618344318, 'auprc': 0.9983498407610298, 'loss_val': 0.17438565696268585, 'psi': 0.9910267073110026}
[S10] START round=29 head_norm_before_train=1.507236 cos_to_last_merge=0.9893 (last merge round=25)
[S10] round=29 local utility u=0.002812 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9946286297369372, 'loss_val': 0.046042213104868716, 'psi': 0.9947006174263984}-{'f1_val': 0.9942851896505369, 'auprc': 0.9967129245813992, 'loss_val': 0.055139050945121844, 'psi': 0.9952562836228818}
[S11] START round=29 head_norm_before_train=1.352277 cos_to_last_merge=0.9966 (last merge round=26)
[S11] round=29 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9963424240273319, 'loss_val': 0.1619032099648284, 'psi': 0.9962171745589183}-{'f1_val': 0.9965470045135896, 'auprc': 0.9962608459509024, 'loss_val': 0.16410975191063346, 'psi': 0.9964325410885146}
[S13] START round=29 head_norm_before_train=1.270167 cos_to_last_merge=0.9871 (last merge round=24)
[S13] round=29 local utility u=0.000000 metrics={'f1_val': 0.579972203210376, 'auprc': 0.5728363245502442, 'loss_val': 0.9179869933946204, 'psi': 0.5771178517463234}-{'f1_val': 0.5585437584693896, 'auprc': 0.6784401489040395, 'loss_val': 0.8363063571672852, 'psi': 0.6065023146432496}
[S14] START round=29 head_norm_before_train=1.392986 cos_to_last_merge=1.0000 (last merge round=28)
[S14] round=29 local utility u=0.000000 metrics={'f1_val': 0.9976763577590866, 'auprc': 0.9969372580958304, 'loss_val': 0.10111806827878297, 'psi': 0.9973807178937841}-{'f1_val': 0.9972435617623723, 'auprc': 0.9983617428180807, 'loss_val': 0.0739585216547275, 'psi': 0.9976908341846557}
[S15] START round=29 head_norm_before_train=1.258034 cos_to_last_merge=1.0000 (last merge round=28)
[S15] round=29 local utility u=0.000000 metrics={'f1_val': 0.6953849490131307, 'auprc': 0.9759096668395988, 'loss_val': 0.41611497408031634, 'psi': 0.807594836143718}-{'f1_val': 0.7805612842532181, 'auprc': 0.9886705126512858, 'loss_val': 0.28945442499608504, 'psi': 0.8638049756124452}
[S16] START round=29 head_norm_before_train=1.356479 cos_to_last_merge=0.9997 (last merge round=27)
[S16] round=29 local utility u=0.046189 metrics={'f1_val': 0.9420905009349064, 'auprc': 0.9981689279771784, 'loss_val': 0.18680266907050636, 'psi': 0.9645218717518151}-{'f1_val': 0.9385387005647127, 'auprc': 0.9965647282705145, 'loss_val': 0.2530570702080634, 'psi': 0.9617491116470334}
[S17] START round=29 head_norm_before_train=1.255688 cos_to_last_merge=1.0000 (last merge round=28)
[S17] round=29 local utility u=1.000000 metrics={'f1_val': 0.9059078458004469, 'auprc': 0.9916163579064964, 'loss_val': 0.30258286441325105, 'psi': 0.9401912506428667}-{'f1_val': 0.5995102288251863, 'auprc': 0.7822087371026525, 'loss_val': 0.8955642584023644, 'psi': 0.6725896321361728}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S8] sending update (kind=head size=1792 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:33213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:33205
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:33204
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:33217
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1798) from S4
[S13] cosine check vs S4: cos=0.8452
[S17] RECEIVED delta(kind=head bytes=1801) from S3
[S17] cosine check vs S3: cos=0.9500
[S4] RECEIVED delta(kind=head bytes=1802) from S10
[S4] cosine check vs S10: cos=0.9925
[S5] RECEIVED delta(kind=head bytes=1801) from S16
[S5] cosine check vs S16: cos=-0.0648
[S5] DROPPED delta from S16 (cos=-0.0648 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:33216
[S17] sending update (kind=head size=1800 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1800) from S17
[S16] cosine check vs S17: cos=0.8250
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=29 metric=0.5800 head_norm=1.294526
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.906174e-01
[S13] stored merged vector for next round verification (round=29)
[S13] DEBUG after merge:  round=29 metric=0.6019 head_norm=1.321608 delta_norm=0.390617
[S13] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=29 metric=0.9421 head_norm=1.396823
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.010389e-01
[S16] stored merged vector for next round verification (round=29)
[S16] DEBUG after merge:  round=29 metric=0.9425 head_norm=1.285824 delta_norm=0.401039
[S16] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=29 metric=0.9483 head_norm=1.456936
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.047142e-01
[S4] stored merged vector for next round verification (round=29)
[S4] DEBUG after merge:  round=29 metric=0.9483 head_norm=1.503662 delta_norm=0.104714
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=29 metric=0.9059 head_norm=1.295081
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.155237e-01
[S17] stored merged vector for next round verification (round=29)
[S17] DEBUG after merge:  round=29 metric=0.9191 head_norm=1.320810 delta_norm=0.215524
[S17] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=30 head_norm_before_train=1.733194 cos_to_last_merge=0.7924 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.792
[S2] round=30 local utility u=0.000000 metrics={'f1_val': 0.5729796000157876, 'auprc': 0.7177880144611226, 'loss_val': 1.41721765174744, 'psi': 0.6309029657939216}-{'f1_val': 0.7125276388541071, 'auprc': 0.7728652464270355, 'loss_val': 0.7804070348451893, 'psi': 0.7366626818832784}
[S3] START round=30 head_norm_before_train=1.380124 cos_to_last_merge=0.9998 (last merge round=28)
[S3] round=30 local utility u=0.000000 metrics={'f1_val': 0.9443079479019637, 'auprc': 0.9946634306806368, 'loss_val': 0.16188895915686635, 'psi': 0.964450141013433}-{'f1_val': 0.9990790987190017, 'auprc': 0.9994975081615324, 'loss_val': 0.11961146287499039, 'psi': 0.999246462496014}
[S4] START round=30 head_norm_before_train=1.503662 cos_to_last_merge=1.0000 (last merge round=29)
[S4] round=30 local utility u=0.000000 metrics={'f1_val': 0.9382036995149712, 'auprc': 0.9590653670422313, 'loss_val': 0.307860463361365, 'psi': 0.9465483665258753}-{'f1_val': 0.948338166804029, 'auprc': 0.9600110249453144, 'loss_val': 0.27687052162371784, 'psi': 0.9530073100605432}
[S5] START round=30 head_norm_before_train=1.776847 (no previous merge yet)
[S5] round=30 local utility u=0.469030 metrics={'f1_val': 0.7009017113514817, 'auprc': 0.9774817215533979, 'loss_val': 0.24658263561476834, 'psi': 0.8115337154322482}-{'f1_val': 0.6449613486395356, 'auprc': 0.8557787168892991, 'loss_val': 0.4838910557587022, 'psi': 0.729288295939441}
[S6] START round=30 head_norm_before_train=1.970449 (no previous merge yet)
[S6] round=30 local utility u=0.000000 metrics={'f1_val': 0.6366184057713334, 'auprc': 0.9212264587674037, 'loss_val': 0.8712602494385355, 'psi': 0.7504616269697615}-{'f1_val': 0.9630327807189332, 'auprc': 0.9610221598329659, 'loss_val': 0.1593599778577741, 'psi': 0.9622285323645463}
[S7] START round=30 head_norm_before_train=1.513600 cos_to_last_merge=1.0000 (last merge round=28)
[S7] round=30 local utility u=0.000000 metrics={'f1_val': 0.5458174597968241, 'auprc': 0.7830849175754251, 'loss_val': 0.7545269148955867, 'psi': 0.6407244429082645}-{'f1_val': 0.5969654126084254, 'auprc': 0.793181656633081, 'loss_val': 0.6198319827105107, 'psi': 0.6754519102182877}
[S8] START round=30 head_norm_before_train=2.087596 (no previous merge yet)
[S8] round=30 local utility u=0.000000 metrics={'f1_val': 0.9929024225986427, 'auprc': 0.9989759202348656, 'loss_val': 0.03293508820354089, 'psi': 0.9953318216531319}-{'f1_val': 0.9938130760262815, 'auprc': 0.9989011674335054, 'loss_val': 0.031710599778992765, 'psi': 0.9958483125891711}
[S9] START round=30 head_norm_before_train=1.408835 cos_to_last_merge=0.9917 (last merge round=24)
[S9] round=30 local utility u=0.075914 metrics={'f1_val': 0.9958601375429889, 'auprc': 0.9984591214236757, 'loss_val': 0.1090039193653974, 'psi': 0.9968997310952635}-{'f1_val': 0.9770228457531879, 'auprc': 0.9988471751522803, 'loss_val': 0.1489714326191651, 'psi': 0.9857525775128249}
[S10] START round=30 head_norm_before_train=1.556042 cos_to_last_merge=0.9853 (last merge round=25)
[S10] round=30 local utility u=0.001127 metrics={'f1_val': 0.993871046050545, 'auprc': 0.9960272947492972, 'loss_val': 0.04271788064572226, 'psi': 0.9947335455300459}-{'f1_val': 0.9947486092193725, 'auprc': 0.9946286297369372, 'loss_val': 0.046042213104868716, 'psi': 0.9947006174263984}
[S11] START round=30 head_norm_before_train=1.378460 cos_to_last_merge=0.9942 (last merge round=26)
[S11] round=30 local utility u=0.016842 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9963289374426263, 'loss_val': 0.12817815374875882, 'psi': 0.9962117799250361}-{'f1_val': 0.9961336749133093, 'auprc': 0.9963424240273319, 'loss_val': 0.1619032099648284, 'psi': 0.9962171745589183}
[S13] START round=30 head_norm_before_train=1.321608 cos_to_last_merge=1.0000 (last merge round=29)
[S13] round=30 local utility u=0.160883 metrics={'f1_val': 0.5691357491520193, 'auprc': 0.7026430056778021, 'loss_val': 0.9206214451934823, 'psi': 0.6225386517623324}-{'f1_val': 0.579972203210376, 'auprc': 0.5728363245502442, 'loss_val': 0.9179869933946204, 'psi': 0.5771178517463234}
[S14] START round=30 head_norm_before_train=1.421290 cos_to_last_merge=0.9997 (last merge round=28)
[S14] round=30 local utility u=0.007893 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9979237545184634, 'loss_val': 0.08813965834114933, 'psi': 0.9977601726372975}-{'f1_val': 0.9976763577590866, 'auprc': 0.9969372580958304, 'loss_val': 0.10111806827878297, 'psi': 0.9973807178937841}
[S15] START round=30 head_norm_before_train=1.315344 cos_to_last_merge=0.9969 (last merge round=28)
[S15] round=30 local utility u=1.000000 metrics={'f1_val': 0.9948198368775891, 'auprc': 0.991488724363064, 'loss_val': 0.10248163330117806, 'psi': 0.993487391871779}-{'f1_val': 0.6953849490131307, 'auprc': 0.9759096668395988, 'loss_val': 0.41611497408031634, 'psi': 0.807594836143718}
[S16] START round=30 head_norm_before_train=1.285824 cos_to_last_merge=1.0000 (last merge round=29)
[S16] round=30 local utility u=0.185452 metrics={'f1_val': 0.9919571966009016, 'auprc': 0.9968059073401698, 'loss_val': 0.1110094389204142, 'psi': 0.993896680896609}-{'f1_val': 0.9420905009349064, 'auprc': 0.9981689279771784, 'loss_val': 0.18680266907050636, 'psi': 0.9645218717518151}
[S17] START round=30 head_norm_before_train=1.320810 cos_to_last_merge=1.0000 (last merge round=29)
[S17] round=30 local utility u=0.000000 metrics={'f1_val': 0.6530113865533033, 'auprc': 0.9142939883170923, 'loss_val': 0.5707145852520559, 'psi': 0.7575244272588189}-{'f1_val': 0.9059078458004469, 'auprc': 0.9916163579064964, 'loss_val': 0.30258286441325105, 'psi': 0.9401912506428667}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] sending update (kind=head size=1805 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:33214
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:33204
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S14] → sending delta(kind=head bytes=1808) to S7@127.0.0.1:33208
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:33203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:33215
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:33212
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1808 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1808) from S14
[S7] cosine check vs S14: cos=0.9702
[S11] RECEIVED delta(kind=head bytes=1799) from S13
[S11] cosine check vs S13: cos=0.6196
[S3] RECEIVED delta(kind=head bytes=1795) from S9
[S3] cosine check vs S9: cos=0.9932
[S4] RECEIVED delta(kind=head bytes=1797) from S10
[S4] cosine check vs S10: cos=0.9971
[S15] RECEIVED delta(kind=head bytes=1800) from S11
[S15] cosine check vs S11: cos=0.9159
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:33205
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1804 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1804) from S16
[S5] cosine check vs S16: cos=-0.0887
[S5] DROPPED delta from S16 (cos=-0.0887 < 0.0)
[S15] sending update (kind=head size=1798 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] RECEIVED delta(kind=head bytes=1798) from S15
[S14] cosine check vs S15: cos=0.8518
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S5]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S6]  timeout peer S17
[S3]  timeout peer S2
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S16
[S8]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S16
[S11]  timeout peer S17
[S2]  timeout peer S3
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S16
[S14]  timeout peer S17
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S16
[S15]  timeout peer S17
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=30 metric=0.9443 head_norm=1.408211
[S3] _apply_head_vector_avg (torch): Δ‖w‖=8.517423e-02
[S3] stored merged vector for next round verification (round=30)
[S3] DEBUG after merge:  round=30 metric=0.9420 head_norm=1.423015 delta_norm=0.085174
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.255 → S17@127.0.0.1:33217
[S16] ⇄ pheromone p=0.155 → S5@127.0.0.1:33205
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=30 metric=0.9961 head_norm=1.400302
[S11] _apply_head_vector_avg (torch): Δ‖w‖=5.978044e-01
[S11] stored merged vector for next round verification (round=30)
[S11] DEBUG after merge:  round=30 metric=0.9961 head_norm=1.232303 delta_norm=0.597804
[S11] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.064 → S15@127.0.0.1:33215
[S17] ⇄ pheromone p=0.277 → S16@127.0.0.1:33216
[S13] ⇄ pheromone p=0.069 → S11@127.0.0.1:33212
[S9] ⇄ pheromone p=0.198 → S3@127.0.0.1:33203
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=30 metric=0.9977 head_norm=1.452170
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.873114e-01
[S14] stored merged vector for next round verification (round=30)
[S14] DEBUG after merge:  round=30 metric=0.9977 head_norm=1.364383 delta_norm=0.387311
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.023 → S7@127.0.0.1:33208
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=30 metric=0.9948 head_norm=1.383584
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.854658e-01
[S15] stored merged vector for next round verification (round=30)
[S15] DEBUG after merge:  round=30 metric=0.9957 head_norm=1.362382 delta_norm=0.285466
[S15] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.324 → S14@127.0.0.1:33214
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=30 metric=0.5458 head_norm=1.520383
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.845797e-01
[S7] stored merged vector for next round verification (round=30)
[S7] DEBUG after merge:  round=30 metric=0.5538 head_norm=1.475165 delta_norm=0.184580
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=30 metric=0.9382 head_norm=1.517900
[S4] _apply_head_vector_avg (torch): Δ‖w‖=7.097129e-02
[S4] stored merged vector for next round verification (round=30)
[S4] DEBUG after merge:  round=30 metric=0.9382 head_norm=1.555322 delta_norm=0.070971
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.176 → S13@127.0.0.1:33213
[S10] ⇄ pheromone p=0.013 → S4@127.0.0.1:33204
[S2] START round=31 head_norm_before_train=1.739815 cos_to_last_merge=0.7911 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.791
[S2] round=31 local utility u=0.716615 metrics={'f1_val': 0.6887624511159572, 'auprc': 0.7624696924810291, 'loss_val': 0.8127305576332636, 'psi': 0.7182453476619861}-{'f1_val': 0.5729796000157876, 'auprc': 0.7177880144611226, 'loss_val': 1.41721765174744, 'psi': 0.6309029657939216}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] START round=31 head_norm_before_train=1.423015 cos_to_last_merge=1.0000 (last merge round=30)
[S3] round=31 local utility u=0.190647 metrics={'f1_val': 0.9979732518176809, 'auprc': 0.999224418553719, 'loss_val': 0.11626944676416633, 'psi': 0.9984737185120962}-{'f1_val': 0.9443079479019637, 'auprc': 0.9946634306806368, 'loss_val': 0.16188895915686635, 'psi': 0.964450141013433}
[S4] START round=31 head_norm_before_train=1.555322 cos_to_last_merge=1.0000 (last merge round=30)
[S4] round=31 local utility u=0.042217 metrics={'f1_val': 0.9477697029013485, 'auprc': 0.9606573697302414, 'loss_val': 0.2855984157876665, 'psi': 0.9529247696329057}-{'f1_val': 0.9382036995149712, 'auprc': 0.9590653670422313, 'loss_val': 0.307860463361365, 'psi': 0.9465483665258753}
[S5] START round=31 head_norm_before_train=1.782608 (no previous merge yet)
[S5] round=31 local utility u=0.083815 metrics={'f1_val': 0.7126161300863134, 'auprc': 0.9902213899547581, 'loss_val': 0.18745866610223838, 'psi': 0.8236582340336913}-{'f1_val': 0.7009017113514817, 'auprc': 0.9774817215533979, 'loss_val': 0.24658263561476834, 'psi': 0.8115337154322482}
[S5] not sending this round → trigger blocked (psi=0.824)
[S6] START round=31 head_norm_before_train=1.988209 (no previous merge yet)
[S6] round=31 local utility u=0.113835 metrics={'f1_val': 0.658724742408175, 'auprc': 0.8992521437908841, 'loss_val': 0.7103052495946434, 'psi': 0.7549357029612587}-{'f1_val': 0.6366184057713334, 'auprc': 0.9212264587674037, 'loss_val': 0.8712602494385355, 'psi': 0.7504616269697615}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S6] sending update (kind=head size=1792 to 1 peers)
[S7] START round=31 head_norm_before_train=1.475165 cos_to_last_merge=1.0000 (last merge round=30)
[S7] round=31 local utility u=0.493642 metrics={'f1_val': 0.6564548823997176, 'auprc': 0.8023064200252575, 'loss_val': 0.4887322411595837, 'psi': 0.7147954974499335}-{'f1_val': 0.5458174597968241, 'auprc': 0.7830849175754251, 'loss_val': 0.7545269148955867, 'psi': 0.6407244429082645}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=31 head_norm_before_train=2.096366 (no previous merge yet)
[S8] round=31 local utility u=0.000000 metrics={'f1_val': 0.9929024225986427, 'auprc': 0.9990413982553804, 'loss_val': 0.03382655909963503, 'psi': 0.9953580128613377}-{'f1_val': 0.9929024225986427, 'auprc': 0.9989759202348656, 'loss_val': 0.03293508820354089, 'psi': 0.9953318216531319}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=31 head_norm_before_train=1.442703 cos_to_last_merge=0.9887 (last merge round=24)
[S9] round=31 local utility u=0.000000 metrics={'f1_val': 0.8938480416043524, 'auprc': 0.9989179644510289, 'loss_val': 0.17001501615351303, 'psi': 0.9358760107430231}-{'f1_val': 0.9958601375429889, 'auprc': 0.9984591214236757, 'loss_val': 0.1090039193653974, 'psi': 0.9968997310952635}
[S10] START round=31 head_norm_before_train=1.595026 cos_to_last_merge=0.9820 (last merge round=25)
[S10] round=31 local utility u=0.003811 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9960202460166195, 'loss_val': 0.0390229604225209, 'psi': 0.9951255624856844}-{'f1_val': 0.993871046050545, 'auprc': 0.9960272947492972, 'loss_val': 0.04271788064572226, 'psi': 0.9947335455300459}
[S11] START round=31 head_norm_before_train=1.232303 cos_to_last_merge=1.0000 (last merge round=30)
[S11] round=31 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9961542898103358, 'loss_val': 0.1618121342836, 'psi': 0.9963899186322881}-{'f1_val': 0.9961336749133093, 'auprc': 0.9963289374426263, 'loss_val': 0.12817815374875882, 'psi': 0.9962117799250361}
[S13] START round=31 head_norm_before_train=1.338296 cos_to_last_merge=0.9999 (last merge round=29)
[S13] round=31 local utility u=0.214497 metrics={'f1_val': 0.6107275608750284, 'auprc': 0.7066563373907071, 'loss_val': 0.7532187946605736, 'psi': 0.6490990714812999}-{'f1_val': 0.5691357491520193, 'auprc': 0.7026430056778021, 'loss_val': 0.9206214451934823, 'psi': 0.6225386517623324}
[S14] START round=31 head_norm_before_train=1.364383 cos_to_last_merge=1.0000 (last merge round=30)
[S14] round=31 local utility u=0.000000 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9986332333832674, 'loss_val': 0.11822718742042547, 'psi': 0.9980439641832191}-{'f1_val': 0.9976511180498535, 'auprc': 0.9979237545184634, 'loss_val': 0.08813965834114933, 'psi': 0.9977601726372975}
[S15] START round=31 head_norm_before_train=1.362382 cos_to_last_merge=1.0000 (last merge round=30)
[S15] round=31 local utility u=0.000000 metrics={'f1_val': 0.9424725125594223, 'auprc': 0.9900569946739546, 'loss_val': 0.18472471393290857, 'psi': 0.9615063054052352}-{'f1_val': 0.9948198368775891, 'auprc': 0.991488724363064, 'loss_val': 0.10248163330117806, 'psi': 0.993487391871779}
[S16] START round=31 head_norm_before_train=1.334194 cos_to_last_merge=0.9990 (last merge round=29)
[S16] round=31 local utility u=0.003238 metrics={'f1_val': 0.9906198124389656, 'auprc': 0.9964737306841303, 'loss_val': 0.09551287510592413, 'psi': 0.9929613797370315}-{'f1_val': 0.9919571966009016, 'auprc': 0.9968059073401698, 'loss_val': 0.1110094389204142, 'psi': 0.993896680896609}
[S17] START round=31 head_norm_before_train=1.351350 cos_to_last_merge=0.9993 (last merge round=29)
[S17] round=31 local utility u=0.000000 metrics={'f1_val': 0.60960705838146, 'auprc': 0.885271759654611, 'loss_val': 0.7515326089130118, 'psi': 0.7198729388907205}-{'f1_val': 0.6530113865533033, 'auprc': 0.9142939883170923, 'loss_val': 0.5707145852520559, 'psi': 0.7575244272588189}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:33204
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:33205
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S13@127.0.0.1:33213
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:33217
[S4] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:33212
[S5] RECEIVED delta(kind=head bytes=1802) from S16
[S5] cosine check vs S16: cos=-0.0838
[S5] DROPPED delta from S16 (cos=-0.0838 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1801) from S10
[S4] cosine check vs S10: cos=0.9986
[S13] RECEIVED delta(kind=head bytes=1804) from S4
[S13] cosine check vs S4: cos=0.9380
[S13] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1803 to 1 peers)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=31 metric=0.9478 head_norm=1.567902
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.162404e-02
[S4] stored merged vector for next round verification (round=31)
[S4] DEBUG after merge:  round=31 metric=0.9478 head_norm=1.597102 delta_norm=0.051624
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S11] RECEIVED delta(kind=head bytes=1797) from S13
[S11] cosine check vs S13: cos=0.8909
[S17] RECEIVED delta(kind=head bytes=1803) from S3
[S17] cosine check vs S3: cos=0.9746
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=31 metric=0.6107 head_norm=1.349067
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.784663e-01
[S13] stored merged vector for next round verification (round=31)
[S13] DEBUG after merge:  round=31 metric=0.6157 head_norm=1.435829 delta_norm=0.278466
[S13] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=31 metric=0.9965 head_norm=1.257613
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.076375e-01
[S11] stored merged vector for next round verification (round=31)
[S11] DEBUG after merge:  round=31 metric=0.9965 head_norm=1.267338 delta_norm=0.307638
[S11] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] RoundReady barrier timeout: have=1 need=2 — continuing
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S16
[S16]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S15
[S4]  timeout peer S13
[S9]  timeout peer S3
[S3]  timeout peer S10
[S3]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S11
[S15]  timeout peer S14
[S10]  timeout peer S4
[S14]  timeout peer S7
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=31 metric=0.6096 head_norm=1.381266
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.629753e-01
[S17] stored merged vector for next round verification (round=31)
[S17] DEBUG after merge:  round=31 metric=0.6127 head_norm=1.405943 delta_norm=0.162975
[S17] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=32 head_norm_before_train=1.750379 cos_to_last_merge=0.7899 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.790
[S2] round=32 local utility u=0.063667 metrics={'f1_val': 0.7211190198822318, 'auprc': 0.751258875513098, 'loss_val': 0.8459035430584095, 'psi': 0.7331749621345782}-{'f1_val': 0.6887624511159572, 'auprc': 0.7624696924810291, 'loss_val': 0.8127305576332636, 'psi': 0.7182453476619861}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=32 head_norm_before_train=1.448648 cos_to_last_merge=0.9998 (last merge round=30)
[S3] round=32 local utility u=0.000000 metrics={'f1_val': 0.9608474784905023, 'auprc': 0.9990491500266898, 'loss_val': 0.15869604750151522, 'psi': 0.9761281471049773}-{'f1_val': 0.9979732518176809, 'auprc': 0.999224418553719, 'loss_val': 0.11626944676416633, 'psi': 0.9984737185120962}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=32 head_norm_before_train=1.597102 cos_to_last_merge=1.0000 (last merge round=31)
[S4] round=32 local utility u=0.000000 metrics={'f1_val': 0.941409832876626, 'auprc': 0.9596962436939626, 'loss_val': 0.30705344367174153, 'psi': 0.9487243972035607}-{'f1_val': 0.9477697029013485, 'auprc': 0.9606573697302414, 'loss_val': 0.2855984157876665, 'psi': 0.9529247696329057}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=32 head_norm_before_train=1.788848 (no previous merge yet)
[S5] round=32 local utility u=0.000000 metrics={'f1_val': 0.7009017113514817, 'auprc': 0.9720677242680847, 'loss_val': 0.26764612554404404, 'psi': 0.8093681165181229}-{'f1_val': 0.7126161300863134, 'auprc': 0.9902213899547581, 'loss_val': 0.18745866610223838, 'psi': 0.8236582340336913}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=32 head_norm_before_train=1.998340 (no previous merge yet)
[S6] round=32 local utility u=0.000000 metrics={'f1_val': 0.6872206239525889, 'auprc': 0.7902446281757292, 'loss_val': 0.7604417367762035, 'psi': 0.7284302256418449}-{'f1_val': 0.658724742408175, 'auprc': 0.8992521437908841, 'loss_val': 0.7103052495946434, 'psi': 0.7549357029612587}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=32 head_norm_before_train=1.484363 cos_to_last_merge=0.9999 (last merge round=30)
[S7] round=32 local utility u=0.000000 metrics={'f1_val': 0.6391009864716136, 'auprc': 0.8026522913505222, 'loss_val': 0.538020276576317, 'psi': 0.7045215084231771}-{'f1_val': 0.6564548823997176, 'auprc': 0.8023064200252575, 'loss_val': 0.4887322411595837, 'psi': 0.7147954974499335}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=32 head_norm_before_train=2.104156 (no previous merge yet)
[S8] round=32 local utility u=0.000000 metrics={'f1_val': 0.9918109678295097, 'auprc': 0.9989973288360802, 'loss_val': 0.03610325362473619, 'psi': 0.9946855122321379}-{'f1_val': 0.9929024225986427, 'auprc': 0.9990413982553804, 'loss_val': 0.03382655909963503, 'psi': 0.9953580128613377}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=32 head_norm_before_train=1.474051 cos_to_last_merge=0.9856 (last merge round=24)
[S9] round=32 local utility u=0.346651 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9981230873341685, 'loss_val': 0.08874138172416324, 'psi': 0.996999291801234}-{'f1_val': 0.8938480416043524, 'auprc': 0.9989179644510289, 'loss_val': 0.17001501615351303, 'psi': 0.9358760107430231}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=32 head_norm_before_train=1.627417 cos_to_last_merge=0.9791 (last merge round=25)
[S10] round=32 local utility u=0.000000 metrics={'f1_val': 0.9940903254969471, 'auprc': 0.9960283207015346, 'loss_val': 0.03752909101545963, 'psi': 0.9948655235787821}-{'f1_val': 0.9945291067983943, 'auprc': 0.9960202460166195, 'loss_val': 0.0390229604225209, 'psi': 0.9951255624856844}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=32 head_norm_before_train=1.267338 cos_to_last_merge=1.0000 (last merge round=31)
[S11] round=32 local utility u=0.000000 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9945698757846917, 'loss_val': 0.1644250785952815, 'psi': 0.9956110507951932}-{'f1_val': 0.9965470045135896, 'auprc': 0.9961542898103358, 'loss_val': 0.1618121342836, 'psi': 0.9963899186322881}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=32 head_norm_before_train=1.435829 cos_to_last_merge=1.0000 (last merge round=31)
[S13] round=32 local utility u=0.000000 metrics={'f1_val': 0.5912268030098481, 'auprc': 0.7154425495970473, 'loss_val': 0.9398367128390787, 'psi': 0.6409131016447278}-{'f1_val': 0.6107275608750284, 'auprc': 0.7066563373907071, 'loss_val': 0.7532187946605736, 'psi': 0.6490990714812999}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=32 head_norm_before_train=1.395694 cos_to_last_merge=0.9995 (last merge round=30)
[S14] round=32 local utility u=0.012092 metrics={'f1_val': 0.9978938390605482, 'auprc': 0.9986333968407922, 'loss_val': 0.09550001137898143, 'psi': 0.9981896621726458}-{'f1_val': 0.9976511180498535, 'auprc': 0.9986332333832674, 'loss_val': 0.11822718742042547, 'psi': 0.9980439641832191}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] sending update (kind=head size=1805 to 1 peers)
[S15] START round=32 head_norm_before_train=1.422861 cos_to_last_merge=0.9975 (last merge round=30)
[S15] round=32 local utility u=0.000000 metrics={'f1_val': 0.6949913887199218, 'auprc': 0.9696036920442157, 'loss_val': 0.4614769592638242, 'psi': 0.8048363100496394}-{'f1_val': 0.9424725125594223, 'auprc': 0.9900569946739546, 'loss_val': 0.18472471393290857, 'psi': 0.9615063054052352}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=32 head_norm_before_train=1.391299 cos_to_last_merge=0.9962 (last merge round=29)
[S16] round=32 local utility u=0.000000 metrics={'f1_val': 0.9641333723559571, 'auprc': 0.9965727445146428, 'loss_val': 0.1385260174274932, 'psi': 0.9771091212194314}-{'f1_val': 0.9906198124389656, 'auprc': 0.9964737306841303, 'loss_val': 0.09551287510592413, 'psi': 0.9929613797370315}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=32 head_norm_before_train=1.405943 cos_to_last_merge=1.0000 (last merge round=31)
[S17] round=32 local utility u=0.000000 metrics={'f1_val': 0.608033583274701, 'auprc': 0.8884304405105092, 'loss_val': 0.7855633888769555, 'psi': 0.7201923261690243}-{'f1_val': 0.60960705838146, 'auprc': 0.885271759654611, 'loss_val': 0.7515326089130118, 'psi': 0.7198729388907205}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=33 head_norm_before_train=1.759934 cos_to_last_merge=0.7891 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.789
[S2] round=33 local utility u=0.000000 metrics={'f1_val': 0.6999392524623503, 'auprc': 0.7431700558508004, 'loss_val': 0.8619110209569733, 'psi': 0.7172315738177304}-{'f1_val': 0.7211190198822318, 'auprc': 0.751258875513098, 'loss_val': 0.8459035430584095, 'psi': 0.7331749621345782}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=33 head_norm_before_train=1.468593 cos_to_last_merge=0.9995 (last merge round=30)
[S3] round=33 local utility u=0.000000 metrics={'f1_val': 0.7558616012286966, 'auprc': 0.8490694752891881, 'loss_val': 0.3480446995966096, 'psi': 0.7931447508528932}-{'f1_val': 0.9608474784905023, 'auprc': 0.9990491500266898, 'loss_val': 0.15869604750151522, 'psi': 0.9761281471049773}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=33 head_norm_before_train=1.607626 cos_to_last_merge=0.9999 (last merge round=31)
[S4] round=33 local utility u=0.000000 metrics={'f1_val': 0.9183735218471774, 'auprc': 0.9564094155621541, 'loss_val': 0.37901910312649223, 'psi': 0.933587879333168}-{'f1_val': 0.941409832876626, 'auprc': 0.9596962436939626, 'loss_val': 0.30705344367174153, 'psi': 0.9487243972035607}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=33 head_norm_before_train=1.796099 (no previous merge yet)
[S5] round=33 local utility u=0.250093 metrics={'f1_val': 0.7610874841808658, 'auprc': 0.9899275645356881, 'loss_val': 0.18215525020249784, 'psi': 0.8526235163227947}-{'f1_val': 0.7009017113514817, 'auprc': 0.9720677242680847, 'loss_val': 0.26764612554404404, 'psi': 0.8093681165181229}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=33 head_norm_before_train=2.012176 (no previous merge yet)
[S6] round=33 local utility u=1.000000 metrics={'f1_val': 0.9654592807484337, 'auprc': 0.9570494092471614, 'loss_val': 0.12715657527881938, 'psi': 0.9620953321479248}-{'f1_val': 0.6872206239525889, 'auprc': 0.7902446281757292, 'loss_val': 0.7604417367762035, 'psi': 0.7284302256418449}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] START round=33 head_norm_before_train=1.496951 cos_to_last_merge=0.9995 (last merge round=30)
[S7] round=33 local utility u=0.000000 metrics={'f1_val': 0.6148092243269293, 'auprc': 0.799546676343408, 'loss_val': 0.5917991349672861, 'psi': 0.6887042051335208}-{'f1_val': 0.6391009864716136, 'auprc': 0.8026522913505222, 'loss_val': 0.538020276576317, 'psi': 0.7045215084231771}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=33 head_norm_before_train=2.114231 (no previous merge yet)
[S8] round=33 local utility u=0.008639 metrics={'f1_val': 0.9938130760262815, 'auprc': 0.9989102755208614, 'loss_val': 0.030577289628191878, 'psi': 0.9958519558241135}-{'f1_val': 0.9918109678295097, 'auprc': 0.9989973288360802, 'loss_val': 0.03610325362473619, 'psi': 0.9946855122321379}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] sending update (kind=head size=1795 to 1 peers)
[S9] START round=33 head_norm_before_train=1.501084 cos_to_last_merge=0.9829 (last merge round=24)
[S9] round=33 local utility u=0.000000 metrics={'f1_val': 0.9883433223640224, 'auprc': 0.9993711559152039, 'loss_val': 0.08489342802139675, 'psi': 0.992754455784495}-{'f1_val': 0.9962500947792776, 'auprc': 0.9981230873341685, 'loss_val': 0.08874138172416324, 'psi': 0.996999291801234}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=33 head_norm_before_train=1.650713 cos_to_last_merge=0.9771 (last merge round=25)
[S10] round=33 local utility u=0.002609 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9956800063499869, 'loss_val': 0.0352155234966676, 'psi': 0.9951211680716183}-{'f1_val': 0.9940903254969471, 'auprc': 0.9960283207015346, 'loss_val': 0.03752909101545963, 'psi': 0.9948655235787821}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=33 head_norm_before_train=1.299448 cos_to_last_merge=0.9994 (last merge round=31)
[S11] round=33 local utility u=0.017490 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9953343942423764, 'loss_val': 0.1331903733032653, 'psi': 0.9960619604051043}-{'f1_val': 0.996305167468861, 'auprc': 0.9945698757846917, 'loss_val': 0.1644250785952815, 'psi': 0.9956110507951932}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S11] sending update (kind=head size=1807 to 1 peers)
[S13] START round=33 head_norm_before_train=1.443375 cos_to_last_merge=1.0000 (last merge round=31)
[S13] round=33 local utility u=0.091892 metrics={'f1_val': 0.6022321485199289, 'auprc': 0.7149601728652175, 'loss_val': 0.8206371074075273, 'psi': 0.6473233582580444}-{'f1_val': 0.5912268030098481, 'auprc': 0.7154425495970473, 'loss_val': 0.9398367128390787, 'psi': 0.6409131016447278}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=33 head_norm_before_train=1.431680 cos_to_last_merge=0.9980 (last merge round=30)
[S14] round=33 local utility u=0.006414 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9986528485599947, 'loss_val': 0.07981732375317079, 'psi': 0.9979061011250332}-{'f1_val': 0.9978938390605482, 'auprc': 0.9986333968407922, 'loss_val': 0.09550001137898143, 'psi': 0.9981896621726458}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=33 head_norm_before_train=1.482140 cos_to_last_merge=0.9921 (last merge round=30)
[S15] round=33 local utility u=1.000000 metrics={'f1_val': 0.9934996994553114, 'auprc': 0.9937824939840041, 'loss_val': 0.0689899294236355, 'psi': 0.9936128172667884}-{'f1_val': 0.6949913887199218, 'auprc': 0.9696036920442157, 'loss_val': 0.4614769592638242, 'psi': 0.8048363100496394}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=33 head_norm_before_train=1.447678 cos_to_last_merge=0.9927 (last merge round=29)
[S16] round=33 local utility u=0.000000 metrics={'f1_val': 0.8932874278556758, 'auprc': 0.9912750808021829, 'loss_val': 0.45334393892776953, 'psi': 0.9324824890342787}-{'f1_val': 0.9641333723559571, 'auprc': 0.9965727445146428, 'loss_val': 0.1385260174274932, 'psi': 0.9771091212194314}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=33 head_norm_before_train=1.430309 cos_to_last_merge=0.9995 (last merge round=31)
[S17] round=33 local utility u=0.201976 metrics={'f1_val': 0.6438054649726423, 'auprc': 0.9013751452263588, 'loss_val': 0.6350777894989479, 'psi': 0.7468333370741289}-{'f1_val': 0.608033583274701, 'auprc': 0.8884304405105092, 'loss_val': 0.7855633888769555, 'psi': 0.7201923261690243}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=34 head_norm_before_train=1.769354 cos_to_last_merge=0.7880 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.788
[S2] round=34 local utility u=0.057990 metrics={'f1_val': 0.7142821354219382, 'auprc': 0.749422101403814, 'loss_val': 0.8507449192014761, 'psi': 0.7283381218146885}-{'f1_val': 0.6999392524623503, 'auprc': 0.7431700558508004, 'loss_val': 0.8619110209569733, 'psi': 0.7172315738177304}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=34 head_norm_before_train=1.484397 cos_to_last_merge=0.9992 (last merge round=30)
[S3] round=34 local utility u=1.000000 metrics={'f1_val': 0.9977181259706348, 'auprc': 0.9971307935374594, 'loss_val': 0.09479512059875932, 'psi': 0.9974831929973647}-{'f1_val': 0.7558616012286966, 'auprc': 0.8490694752891881, 'loss_val': 0.3480446995966096, 'psi': 0.7931447508528932}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] sending update (kind=head size=1805 to 1 peers)
[S4] START round=34 head_norm_before_train=1.615238 cos_to_last_merge=0.9999 (last merge round=31)
[S4] round=34 local utility u=0.110359 metrics={'f1_val': 0.9415222141310438, 'auprc': 0.9612704879268943, 'loss_val': 0.31177606506484085, 'psi': 0.9494215236493839}-{'f1_val': 0.9183735218471774, 'auprc': 0.9564094155621541, 'loss_val': 0.37901910312649223, 'psi': 0.933587879333168}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S5] START round=34 head_norm_before_train=1.802766 (no previous merge yet)
[S5] round=34 local utility u=0.286110 metrics={'f1_val': 0.8692303720140452, 'auprc': 0.9750899412785199, 'loss_val': 0.2142793210070886, 'psi': 0.9115741997198351}-{'f1_val': 0.7610874841808658, 'auprc': 0.9899275645356881, 'loss_val': 0.18215525020249784, 'psi': 0.8526235163227947}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] START round=34 head_norm_before_train=2.023468 (no previous merge yet)
[S6] round=34 local utility u=0.000000 metrics={'f1_val': 0.7238475519096752, 'auprc': 0.9143149322063635, 'loss_val': 0.8083168570399382, 'psi': 0.8000345040283505}-{'f1_val': 0.9654592807484337, 'auprc': 0.9570494092471614, 'loss_val': 0.12715657527881938, 'psi': 0.9620953321479248}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=34 head_norm_before_train=1.506160 cos_to_last_merge=0.9989 (last merge round=30)
[S7] round=34 local utility u=0.000000 metrics={'f1_val': 0.6104790567191665, 'auprc': 0.7964669827704884, 'loss_val': 0.6214056827368873, 'psi': 0.6848742271396953}-{'f1_val': 0.6148092243269293, 'auprc': 0.799546676343408, 'loss_val': 0.5917991349672861, 'psi': 0.6887042051335208}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=34 head_norm_before_train=2.126351 (no previous merge yet)
[S8] round=34 local utility u=0.000108 metrics={'f1_val': 0.9938130760262815, 'auprc': 0.9989237748386111, 'loss_val': 0.030401483707743284, 'psi': 0.9958573555512134}-{'f1_val': 0.9938130760262815, 'auprc': 0.9989102755208614, 'loss_val': 0.030577289628191878, 'psi': 0.9958519558241135}
[S8] not sending this round → trigger blocked (psi=0.996)
[S9] START round=34 head_norm_before_train=1.524068 cos_to_last_merge=0.9806 (last merge round=24)
[S9] round=34 local utility u=0.033716 metrics={'f1_val': 0.9964388212112862, 'auprc': 0.9987153487704861, 'loss_val': 0.06406729568499968, 'psi': 0.9973494322349662}-{'f1_val': 0.9883433223640224, 'auprc': 0.9993711559152039, 'loss_val': 0.08489342802139675, 'psi': 0.992754455784495}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=34 head_norm_before_train=1.672948 cos_to_last_merge=0.9750 (last merge round=25)
[S10] round=34 local utility u=0.000000 metrics={'f1_val': 0.9940903254969471, 'auprc': 0.9960518950217263, 'loss_val': 0.03469863276393418, 'psi': 0.9948749533068588}-{'f1_val': 0.9947486092193725, 'auprc': 0.9956800063499869, 'loss_val': 0.0352155234966676, 'psi': 0.9951211680716183}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=34 head_norm_before_train=1.334382 cos_to_last_merge=0.9975 (last merge round=31)
[S11] round=34 local utility u=0.013171 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9961478629131646, 'loss_val': 0.10783760156908488, 'psi': 0.9962422456465825}-{'f1_val': 0.9965470045135896, 'auprc': 0.9953343942423764, 'loss_val': 0.1331903733032653, 'psi': 0.9960619604051043}
[S11] not sending this round → trigger blocked (psi=0.996)
[S13] START round=34 head_norm_before_train=1.450644 cos_to_last_merge=0.9999 (last merge round=31)
[S13] round=34 local utility u=0.122432 metrics={'f1_val': 0.6160395141557131, 'auprc': 0.722389003834933, 'loss_val': 0.6809042413407536, 'psi': 0.6585793100274011}-{'f1_val': 0.6022321485199289, 'auprc': 0.7149601728652175, 'loss_val': 0.8206371074075273, 'psi': 0.6473233582580444}
[S13] not sending this round → trigger blocked (psi=0.659)
[S14] START round=34 head_norm_before_train=1.468904 cos_to_last_merge=0.9960 (last merge round=30)
[S14] round=34 local utility u=0.003364 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9990311455503804, 'loss_val': 0.07422478871278027, 'psi': 0.9980574199211876}-{'f1_val': 0.9974082695017256, 'auprc': 0.9986528485599947, 'loss_val': 0.07981732375317079, 'psi': 0.9979061011250332}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=34 head_norm_before_train=1.527932 cos_to_last_merge=0.9871 (last merge round=30)
[S15] round=34 local utility u=0.000000 metrics={'f1_val': 0.6982037320425909, 'auprc': 0.8629065387209754, 'loss_val': 0.4983531275947524, 'psi': 0.7640848547139447}-{'f1_val': 0.9934996994553114, 'auprc': 0.9937824939840041, 'loss_val': 0.0689899294236355, 'psi': 0.9936128172667884}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=34 head_norm_before_train=1.495504 cos_to_last_merge=0.9893 (last merge round=29)
[S16] round=34 local utility u=0.393588 metrics={'f1_val': 0.9662514313388904, 'auprc': 0.9967669992884521, 'loss_val': 0.12042741743342529, 'psi': 0.978457658518715}-{'f1_val': 0.8932874278556758, 'auprc': 0.9912750808021829, 'loss_val': 0.45334393892776953, 'psi': 0.9324824890342787}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S17] START round=34 head_norm_before_train=1.463565 cos_to_last_merge=0.9980 (last merge round=31)
[S17] round=34 local utility u=0.000000 metrics={'f1_val': 0.573045328272881, 'auprc': 0.7978451072429802, 'loss_val': 1.1368473665616787, 'psi': 0.6629652398609207}-{'f1_val': 0.6438054649726423, 'auprc': 0.9013751452263588, 'loss_val': 0.6350777894989479, 'psi': 0.7468333370741289}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=35 head_norm_before_train=1.779704 cos_to_last_merge=0.7866 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.787
[S2] round=35 local utility u=0.000000 metrics={'f1_val': 0.6703630290119035, 'auprc': 0.7521550176440622, 'loss_val': 0.9450784690463235, 'psi': 0.7030798244647669}-{'f1_val': 0.7142821354219382, 'auprc': 0.749422101403814, 'loss_val': 0.8507449192014761, 'psi': 0.7283381218146885}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=35 head_norm_before_train=1.497737 cos_to_last_merge=0.9987 (last merge round=30)
[S3] round=35 local utility u=0.000000 metrics={'f1_val': 0.5784264563433892, 'auprc': 0.8040791297033465, 'loss_val': 0.7163886900831403, 'psi': 0.6686875256873721}-{'f1_val': 0.9977181259706348, 'auprc': 0.9971307935374594, 'loss_val': 0.09479512059875932, 'psi': 0.9974831929973647}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=35 head_norm_before_train=1.616830 cos_to_last_merge=0.9996 (last merge round=31)
[S4] round=35 local utility u=0.000000 metrics={'f1_val': 0.9408396813683022, 'auprc': 0.9564761625933094, 'loss_val': 0.31631213927827645, 'psi': 0.947094273858305}-{'f1_val': 0.9415222141310438, 'auprc': 0.9612704879268943, 'loss_val': 0.31177606506484085, 'psi': 0.9494215236493839}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=35 head_norm_before_train=1.806105 (no previous merge yet)
[S5] round=35 local utility u=0.000000 metrics={'f1_val': 0.8480823984741015, 'auprc': 0.9899980831549986, 'loss_val': 0.1370650679899359, 'psi': 0.9048486723464604}-{'f1_val': 0.8692303720140452, 'auprc': 0.9750899412785199, 'loss_val': 0.2142793210070886, 'psi': 0.9115741997198351}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=35 head_norm_before_train=2.030317 (no previous merge yet)
[S6] round=35 local utility u=0.741848 metrics={'f1_val': 0.8642189391013521, 'auprc': 0.9553370000958337, 'loss_val': 0.2899150883390354, 'psi': 0.9006661634991446}-{'f1_val': 0.7238475519096752, 'auprc': 0.9143149322063635, 'loss_val': 0.8083168570399382, 'psi': 0.8000345040283505}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S6] sending update (kind=head size=1790 to 1 peers)
[S7] START round=35 head_norm_before_train=1.511940 cos_to_last_merge=0.9985 (last merge round=30)
[S7] round=35 local utility u=0.331929 metrics={'f1_val': 0.669237253892116, 'auprc': 0.8251481834213913, 'loss_val': 0.39614005156427134, 'psi': 0.7316016257038261}-{'f1_val': 0.6104790567191665, 'auprc': 0.7964669827704884, 'loss_val': 0.6214056827368873, 'psi': 0.6848742271396953}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=35 head_norm_before_train=2.131005 (no previous merge yet)
[S8] round=35 local utility u=0.000000 metrics={'f1_val': 0.992174240363445, 'auprc': 0.9990903655775619, 'loss_val': 0.03426336313238242, 'psi': 0.9949406904490918}-{'f1_val': 0.9938130760262815, 'auprc': 0.9989237748386111, 'loss_val': 0.030401483707743284, 'psi': 0.9958573555512134}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=35 head_norm_before_train=1.544648 cos_to_last_merge=0.9786 (last merge round=24)
[S9] round=35 local utility u=0.000000 metrics={'f1_val': 0.9947788075341253, 'auprc': 0.9984455180614038, 'loss_val': 0.05904426259071117, 'psi': 0.9962454917450366}-{'f1_val': 0.9964388212112862, 'auprc': 0.9987153487704861, 'loss_val': 0.06406729568499968, 'psi': 0.9973494322349662}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=35 head_norm_before_train=1.693801 cos_to_last_merge=0.9732 (last merge round=25)
[S10] round=35 local utility u=0.001286 metrics={'f1_val': 0.9943096789853013, 'auprc': 0.9961477188179755, 'loss_val': 0.03372983965185556, 'psi': 0.995044894918371}-{'f1_val': 0.9940903254969471, 'auprc': 0.9960518950217263, 'loss_val': 0.03469863276393418, 'psi': 0.9948749533068588}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=35 head_norm_before_train=1.370701 cos_to_last_merge=0.9949 (last merge round=31)
[S11] round=35 local utility u=0.009299 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9962284123203577, 'loss_val': 0.09093275626090411, 'psi': 0.9964195676362968}-{'f1_val': 0.996305167468861, 'auprc': 0.9961478629131646, 'loss_val': 0.10783760156908488, 'psi': 0.9962422456465825}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=35 head_norm_before_train=1.462436 cos_to_last_merge=0.9995 (last merge round=31)
[S13] round=35 local utility u=0.000000 metrics={'f1_val': 0.6088365298473241, 'auprc': 0.7296614827334532, 'loss_val': 0.8562053385267958, 'psi': 0.6571665110017757}-{'f1_val': 0.6160395141557131, 'auprc': 0.722389003834933, 'loss_val': 0.6809042413407536, 'psi': 0.6585793100274011}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=35 head_norm_before_train=1.502910 cos_to_last_merge=0.9942 (last merge round=30)
[S14] round=35 local utility u=0.000000 metrics={'f1_val': 0.9894679349758214, 'auprc': 0.998646586139532, 'loss_val': 0.0745884244394612, 'psi': 0.9931393954413057}-{'f1_val': 0.9974082695017256, 'auprc': 0.9990311455503804, 'loss_val': 0.07422478871278027, 'psi': 0.9980574199211876}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=35 head_norm_before_train=1.555788 cos_to_last_merge=0.9841 (last merge round=30)
[S15] round=35 local utility u=1.000000 metrics={'f1_val': 0.9934706406865853, 'auprc': 0.9927043759132385, 'loss_val': 0.061539160353946014, 'psi': 0.9931641347772466}-{'f1_val': 0.6982037320425909, 'auprc': 0.8629065387209754, 'loss_val': 0.4983531275947524, 'psi': 0.7640848547139447}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] sending update (kind=head size=1804 to 1 peers)
[S16] START round=35 head_norm_before_train=1.535047 cos_to_last_merge=0.9865 (last merge round=29)
[S16] round=35 local utility u=0.000000 metrics={'f1_val': 0.8488364914903047, 'auprc': 0.9947401780389395, 'loss_val': 0.8011218094435366, 'psi': 0.9071979661097587}-{'f1_val': 0.9662514313388904, 'auprc': 0.9967669992884521, 'loss_val': 0.12042741743342529, 'psi': 0.978457658518715}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=35 head_norm_before_train=1.499033 cos_to_last_merge=0.9957 (last merge round=31)
[S17] round=35 local utility u=0.431338 metrics={'f1_val': 0.6420567973780432, 'auprc': 0.8834700316925446, 'loss_val': 0.945114650801554, 'psi': 0.7386220911038438}-{'f1_val': 0.573045328272881, 'auprc': 0.7978451072429802, 'loss_val': 1.1368473665616787, 'psi': 0.6629652398609207}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] START round=36 head_norm_before_train=1.789994 cos_to_last_merge=0.7842 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.784
[S2] round=36 local utility u=0.158219 metrics={'f1_val': 0.7105256367250108, 'auprc': 0.7476935317350467, 'loss_val': 0.8562311849411973, 'psi': 0.7253927947290252}-{'f1_val': 0.6703630290119035, 'auprc': 0.7521550176440622, 'loss_val': 0.9450784690463235, 'psi': 0.7030798244647669}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=36 head_norm_before_train=1.505167 cos_to_last_merge=0.9981 (last merge round=30)
[S3] round=36 local utility u=1.000000 metrics={'f1_val': 0.9979732518176809, 'auprc': 0.9995739876222102, 'loss_val': 0.0795157899968565, 'psi': 0.9986135461394927}-{'f1_val': 0.5784264563433892, 'auprc': 0.8040791297033465, 'loss_val': 0.7163886900831403, 'psi': 0.6686875256873721}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] sending update (kind=head size=1803 to 1 peers)
[S4] START round=36 head_norm_before_train=1.624147 cos_to_last_merge=0.9994 (last merge round=31)
[S4] round=36 local utility u=0.011745 metrics={'f1_val': 0.9440881164946086, 'auprc': 0.9535370988583682, 'loss_val': 0.3034955555704624, 'psi': 0.9478677094401124}-{'f1_val': 0.9408396813683022, 'auprc': 0.9564761625933094, 'loss_val': 0.31631213927827645, 'psi': 0.947094273858305}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] sending update (kind=head size=1794 to 1 peers)
[S5] START round=36 head_norm_before_train=1.809673 (no previous merge yet)
[S5] round=36 local utility u=0.000000 metrics={'f1_val': 0.7006536512124258, 'auprc': 0.8585093575152617, 'loss_val': 0.45830707128560416, 'psi': 0.7637959337335603}-{'f1_val': 0.8480823984741015, 'auprc': 0.9899980831549986, 'loss_val': 0.1370650679899359, 'psi': 0.9048486723464604}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=36 head_norm_before_train=2.036468 (no previous merge yet)
[S6] round=36 local utility u=0.000000 metrics={'f1_val': 0.6915601726021113, 'auprc': 0.8854872547568916, 'loss_val': 0.9098837845912915, 'psi': 0.7691310054640235}-{'f1_val': 0.8642189391013521, 'auprc': 0.9553370000958337, 'loss_val': 0.2899150883390354, 'psi': 0.9006661634991446}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=36 head_norm_before_train=1.515949 cos_to_last_merge=0.9982 (last merge round=30)
[S7] round=36 local utility u=0.000000 metrics={'f1_val': 0.609184904332475, 'auprc': 0.7952251375711856, 'loss_val': 0.6424197994573346, 'psi': 0.6836009976279592}-{'f1_val': 0.669237253892116, 'auprc': 0.8251481834213913, 'loss_val': 0.39614005156427134, 'psi': 0.7316016257038261}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=36 head_norm_before_train=2.137850 (no previous merge yet)
[S8] round=36 local utility u=0.000000 metrics={'f1_val': 0.9867984609811391, 'auprc': 0.9990907427584006, 'loss_val': 0.04823429932048282, 'psi': 0.9917153736920437}-{'f1_val': 0.992174240363445, 'auprc': 0.9990903655775619, 'loss_val': 0.03426336313238242, 'psi': 0.9949406904490918}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=36 head_norm_before_train=1.565141 cos_to_last_merge=0.9768 (last merge round=24)
[S9] round=36 local utility u=0.000000 metrics={'f1_val': 0.9805286250677576, 'auprc': 0.9988320477899878, 'loss_val': 0.07998808547031334, 'psi': 0.9878499941566496}-{'f1_val': 0.9947788075341253, 'auprc': 0.9984455180614038, 'loss_val': 0.05904426259071117, 'psi': 0.9962454917450366}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=36 head_norm_before_train=1.712957 cos_to_last_merge=0.9715 (last merge round=25)
[S10] round=36 local utility u=0.000000 metrics={'f1_val': 0.993888323675122, 'auprc': 0.9959371740542178, 'loss_val': 0.03288944641382078, 'psi': 0.9947078638267604}-{'f1_val': 0.9943096789853013, 'auprc': 0.9961477188179755, 'loss_val': 0.03372983965185556, 'psi': 0.995044894918371}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=36 head_norm_before_train=1.404908 cos_to_last_merge=0.9921 (last merge round=31)
[S11] round=36 local utility u=0.006638 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9962215015473177, 'loss_val': 0.07763660206843198, 'psi': 0.9964168033270808}-{'f1_val': 0.9965470045135896, 'auprc': 0.9962284123203577, 'loss_val': 0.09093275626090411, 'psi': 0.9964195676362968}
[S11] not sending this round → trigger blocked (psi=0.996)
[S13] START round=36 head_norm_before_train=1.469132 cos_to_last_merge=0.9990 (last merge round=31)
[S13] round=36 local utility u=0.110543 metrics={'f1_val': 0.6335084089473217, 'auprc': 0.7418641894607483, 'loss_val': 0.8197585897575179, 'psi': 0.6768507211526924}-{'f1_val': 0.6088365298473241, 'auprc': 0.7296614827334532, 'loss_val': 0.8562053385267958, 'psi': 0.6571665110017757}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=36 head_norm_before_train=1.531000 cos_to_last_merge=0.9927 (last merge round=30)
[S14] round=36 local utility u=0.036105 metrics={'f1_val': 0.9980623665153463, 'auprc': 0.9986435043600703, 'loss_val': 0.05393557557840578, 'psi': 0.9982948216532359}-{'f1_val': 0.9894679349758214, 'auprc': 0.998646586139532, 'loss_val': 0.0745884244394612, 'psi': 0.9931393954413057}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] sending update (kind=head size=1804 to 1 peers)
[S15] START round=36 head_norm_before_train=1.572169 cos_to_last_merge=0.9824 (last merge round=30)
[S15] round=36 local utility u=0.000000 metrics={'f1_val': 0.8405434205725495, 'auprc': 0.9918155177043586, 'loss_val': 0.2048780920167274, 'psi': 0.9010522594252731}-{'f1_val': 0.9934706406865853, 'auprc': 0.9927043759132385, 'loss_val': 0.061539160353946014, 'psi': 0.9931641347772466}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=36 head_norm_before_train=1.568897 cos_to_last_merge=0.9840 (last merge round=29)
[S16] round=36 local utility u=0.101736 metrics={'f1_val': 0.8639376886424721, 'auprc': 0.9949957111169887, 'loss_val': 0.6890231973504221, 'psi': 0.9163608976322788}-{'f1_val': 0.8488364914903047, 'auprc': 0.9947401780389395, 'loss_val': 0.8011218094435366, 'psi': 0.9071979661097587}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S16] sending update (kind=head size=1806 to 1 peers)
[S17] START round=36 head_norm_before_train=1.529269 cos_to_last_merge=0.9933 (last merge round=31)
[S17] round=36 local utility u=0.413708 metrics={'f1_val': 0.6801755695813629, 'auprc': 0.9728608151492047, 'loss_val': 0.6145831941816494, 'psi': 0.7972496678084997}-{'f1_val': 0.6420567973780432, 'auprc': 0.8834700316925446, 'loss_val': 0.945114650801554, 'psi': 0.7386220911038438}
[S17] not sending this round → trigger blocked (psi=0.797)
[S2] START round=37 head_norm_before_train=1.806587 cos_to_last_merge=0.7825 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.783
[S2] round=37 local utility u=0.003512 metrics={'f1_val': 0.7125023721667683, 'auprc': 0.7522796266813909, 'loss_val': 0.8748261955948116, 'psi': 0.7284132739726173}-{'f1_val': 0.7105256367250108, 'auprc': 0.7476935317350467, 'loss_val': 0.8562311849411973, 'psi': 0.7253927947290252}
[S2] not sending this round → trigger blocked (psi=0.728)
[S3] START round=37 head_norm_before_train=1.513780 cos_to_last_merge=0.9975 (last merge round=30)
[S3] round=37 local utility u=0.000000 metrics={'f1_val': 0.9231347359065812, 'auprc': 0.9842346296329093, 'loss_val': 0.15652340325230535, 'psi': 0.9475746933971124}-{'f1_val': 0.9979732518176809, 'auprc': 0.9995739876222102, 'loss_val': 0.0795157899968565, 'psi': 0.9986135461394927}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=37 head_norm_before_train=1.635068 cos_to_last_merge=0.9993 (last merge round=31)
[S4] round=37 local utility u=0.007253 metrics={'f1_val': 0.9520943604575313, 'auprc': 0.94331087004597, 'loss_val': 0.3063484508475589, 'psi': 0.9485809642929068}-{'f1_val': 0.9440881164946086, 'auprc': 0.9535370988583682, 'loss_val': 0.3034955555704624, 'psi': 0.9478677094401124}
[S4] not sending this round → trigger blocked (psi=0.949)
[S5] START round=37 head_norm_before_train=1.812125 (no previous merge yet)
[S5] round=37 local utility u=0.328228 metrics={'f1_val': 0.706644103866078, 'auprc': 0.9861952042247206, 'loss_val': 0.22085041960285573, 'psi': 0.818464544009535}-{'f1_val': 0.7006536512124258, 'auprc': 0.8585093575152617, 'loss_val': 0.45830707128560416, 'psi': 0.7637959337335603}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=37 head_norm_before_train=2.050480 (no previous merge yet)
[S6] round=37 local utility u=0.000000 metrics={'f1_val': 0.6170215281696696, 'auprc': 0.8712004125755377, 'loss_val': 0.7853916290074732, 'psi': 0.7186930819320169}-{'f1_val': 0.6915601726021113, 'auprc': 0.8854872547568916, 'loss_val': 0.9098837845912915, 'psi': 0.7691310054640235}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=37 head_norm_before_train=1.518903 cos_to_last_merge=0.9979 (last merge round=30)
[S7] round=37 local utility u=0.031103 metrics={'f1_val': 0.6134329853309065, 'auprc': 0.7960592079400505, 'loss_val': 0.6082035140239834, 'psi': 0.686483474374564}-{'f1_val': 0.609184904332475, 'auprc': 0.7952251375711856, 'loss_val': 0.6424197994573346, 'psi': 0.6836009976279592}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] sending update (kind=head size=1797 to 1 peers)
[S8] START round=37 head_norm_before_train=2.145115 (no previous merge yet)
[S8] round=37 local utility u=0.000000 metrics={'f1_val': 0.8464463061740972, 'auprc': 0.9891551145483368, 'loss_val': 0.15750377771616816, 'psi': 0.903529829523793}-{'f1_val': 0.9867984609811391, 'auprc': 0.9990907427584006, 'loss_val': 0.04823429932048282, 'psi': 0.9917153736920437}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=37 head_norm_before_train=1.585487 cos_to_last_merge=0.9749 (last merge round=24)
[S9] round=37 local utility u=0.059150 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9984363856143483, 'loss_val': 0.054830904869541716, 'psi': 0.9971246111133059}-{'f1_val': 0.9805286250677576, 'auprc': 0.9988320477899878, 'loss_val': 0.07998808547031334, 'psi': 0.9878499941566496}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=37 head_norm_before_train=1.731234 cos_to_last_merge=0.9699 (last merge round=25)
[S10] round=37 local utility u=0.000000 metrics={'f1_val': 0.9936689701867679, 'auprc': 0.9960163818141416, 'loss_val': 0.03242310726660369, 'psi': 0.9946079348377175}-{'f1_val': 0.993888323675122, 'auprc': 0.9959371740542178, 'loss_val': 0.03288944641382078, 'psi': 0.9947078638267604}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=37 head_norm_before_train=1.438110 cos_to_last_merge=0.9893 (last merge round=31)
[S11] round=37 local utility u=0.005147 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9962701898087017, 'loss_val': 0.0674893805611332, 'psi': 0.9964362786316344}-{'f1_val': 0.9965470045135896, 'auprc': 0.9962215015473177, 'loss_val': 0.07763660206843198, 'psi': 0.9964168033270808}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=37 head_norm_before_train=1.475094 cos_to_last_merge=0.9987 (last merge round=31)
[S13] round=37 local utility u=0.000000 metrics={'f1_val': 0.5911593126977317, 'auprc': 0.7547158005481911, 'loss_val': 0.7614608429151932, 'psi': 0.6565819078379155}-{'f1_val': 0.6335084089473217, 'auprc': 0.7418641894607483, 'loss_val': 0.8197585897575179, 'psi': 0.6768507211526924}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=37 head_norm_before_train=1.553770 cos_to_last_merge=0.9915 (last merge round=30)
[S14] round=37 local utility u=0.000266 metrics={'f1_val': 0.9980623665153463, 'auprc': 0.9990130872661815, 'loss_val': 0.054511580486205045, 'psi': 0.9984426548156804}-{'f1_val': 0.9980623665153463, 'auprc': 0.9986435043600703, 'loss_val': 0.05393557557840578, 'psi': 0.9982948216532359}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=37 head_norm_before_train=1.585390 cos_to_last_merge=0.9806 (last merge round=30)
[S15] round=37 local utility u=0.000000 metrics={'f1_val': 0.7033095065017607, 'auprc': 0.967787476867519, 'loss_val': 0.46186519401434833, 'psi': 0.8091006946480641}-{'f1_val': 0.8405434205725495, 'auprc': 0.9918155177043586, 'loss_val': 0.2048780920167274, 'psi': 0.9010522594252731}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=37 head_norm_before_train=1.598710 cos_to_last_merge=0.9818 (last merge round=29)
[S16] round=37 local utility u=0.037637 metrics={'f1_val': 0.8730473691120055, 'auprc': 0.9918279127140835, 'loss_val': 0.6589036340396457, 'psi': 0.9205595865528368}-{'f1_val': 0.8639376886424721, 'auprc': 0.9949957111169887, 'loss_val': 0.6890231973504221, 'psi': 0.9163608976322788}
[S16] not sending this round → trigger blocked (psi=0.921)
[S17] START round=37 head_norm_before_train=1.553146 cos_to_last_merge=0.9912 (last merge round=31)
[S17] round=37 local utility u=0.000000 metrics={'f1_val': 0.6279328846135886, 'auprc': 0.8647259418466042, 'loss_val': 0.960496388024193, 'psi': 0.7226501075067948}-{'f1_val': 0.6801755695813629, 'auprc': 0.9728608151492047, 'loss_val': 0.6145831941816494, 'psi': 0.7972496678084997}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=38 head_norm_before_train=1.827612 cos_to_last_merge=0.7806 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.781
[S2] round=38 local utility u=0.000000 metrics={'f1_val': 0.6797842401743402, 'auprc': 0.7457717685623944, 'loss_val': 1.0545801241226787, 'psi': 0.706179251529562}-{'f1_val': 0.7125023721667683, 'auprc': 0.7522796266813909, 'loss_val': 0.8748261955948116, 'psi': 0.7284132739726173}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=38 head_norm_before_train=1.526224 cos_to_last_merge=0.9967 (last merge round=30)
[S3] round=38 local utility u=0.236473 metrics={'f1_val': 0.9810150216627614, 'auprc': 0.9995737853590305, 'loss_val': 0.0768762449350006, 'psi': 0.9884385271412691}-{'f1_val': 0.9231347359065812, 'auprc': 0.9842346296329093, 'loss_val': 0.15652340325230535, 'psi': 0.9475746933971124}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=38 head_norm_before_train=1.645086 cos_to_last_merge=0.9991 (last merge round=31)
[S4] round=38 local utility u=0.000000 metrics={'f1_val': 0.9448624342369771, 'auprc': 0.9559949817159921, 'loss_val': 0.30808784845584414, 'psi': 0.9493154532285831}-{'f1_val': 0.9520943604575313, 'auprc': 0.94331087004597, 'loss_val': 0.3063484508475589, 'psi': 0.9485809642929068}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=38 head_norm_before_train=1.814382 (no previous merge yet)
[S5] round=38 local utility u=0.554435 metrics={'f1_val': 0.9146036222138392, 'auprc': 0.9654780211946534, 'loss_val': 0.29758580160566434, 'psi': 0.9349533818061648}-{'f1_val': 0.706644103866078, 'auprc': 0.9861952042247206, 'loss_val': 0.22085041960285573, 'psi': 0.818464544009535}
[S5] not sending this round → trigger blocked (psi=0.935)
[S6] START round=38 head_norm_before_train=2.060324 (no previous merge yet)
[S6] round=38 local utility u=0.057136 metrics={'f1_val': 0.6430502193926826, 'auprc': 0.8865543768805892, 'loss_val': 0.8733533301465962, 'psi': 0.7404518823878452}-{'f1_val': 0.6170215281696696, 'auprc': 0.8712004125755377, 'loss_val': 0.7853916290074732, 'psi': 0.7186930819320169}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S6] sending update (kind=head size=1792 to 1 peers)
[S7] START round=38 head_norm_before_train=1.521097 cos_to_last_merge=0.9978 (last merge round=30)
[S7] round=38 local utility u=0.179197 metrics={'f1_val': 0.6520162560638681, 'auprc': 0.8030480282231174, 'loss_val': 0.5022749674827806, 'psi': 0.7124289649275679}-{'f1_val': 0.6134329853309065, 'auprc': 0.7960592079400505, 'loss_val': 0.6082035140239834, 'psi': 0.686483474374564}
[S7] not sending this round → trigger blocked (psi=0.712)
[S8] START round=38 head_norm_before_train=2.151755 (no previous merge yet)
[S8] round=38 local utility u=0.397211 metrics={'f1_val': 0.9651817379692634, 'auprc': 0.9982986473616529, 'loss_val': 0.10292570525604908, 'psi': 0.9784285017262192}-{'f1_val': 0.8464463061740972, 'auprc': 0.9891551145483368, 'loss_val': 0.15750377771616816, 'psi': 0.903529829523793}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=38 head_norm_before_train=1.605253 cos_to_last_merge=0.9731 (last merge round=24)
[S9] round=38 local utility u=0.000000 metrics={'f1_val': 0.9878532334303461, 'auprc': 0.9988335255924241, 'loss_val': 0.05990803994615969, 'psi': 0.9922453502951774}-{'f1_val': 0.9962500947792776, 'auprc': 0.9984363856143483, 'loss_val': 0.054830904869541716, 'psi': 0.9971246111133059}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=38 head_norm_before_train=1.746501 cos_to_last_merge=0.9685 (last merge round=25)
[S10] round=38 local utility u=0.003644 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.99593974448288, 'loss_val': 0.03138282489018184, 'psi': 0.9952250633247754}-{'f1_val': 0.9936689701867679, 'auprc': 0.9960163818141416, 'loss_val': 0.03242310726660369, 'psi': 0.9946079348377175}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=38 head_norm_before_train=1.469297 cos_to_last_merge=0.9865 (last merge round=31)
[S11] round=38 local utility u=0.003907 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.996333275956054, 'loss_val': 0.05986374303003172, 'psi': 0.9964615130905754}-{'f1_val': 0.9965470045135896, 'auprc': 0.9962701898087017, 'loss_val': 0.0674893805611332, 'psi': 0.9964362786316344}
[S11] not sending this round → trigger blocked (psi=0.996)
[S13] START round=38 head_norm_before_train=1.486472 cos_to_last_merge=0.9975 (last merge round=31)
[S13] round=38 local utility u=0.000000 metrics={'f1_val': 0.6098468458845571, 'auprc': 0.6046492666605654, 'loss_val': 1.0927001818941553, 'psi': 0.6077678141949604}-{'f1_val': 0.5911593126977317, 'auprc': 0.7547158005481911, 'loss_val': 0.7614608429151932, 'psi': 0.6565819078379155}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=38 head_norm_before_train=1.576361 cos_to_last_merge=0.9902 (last merge round=30)
[S14] round=38 local utility u=0.002585 metrics={'f1_val': 0.9974310505072961, 'auprc': 0.9986318667988546, 'loss_val': 0.04441072279408737, 'psi': 0.9979113770239195}-{'f1_val': 0.9980623665153463, 'auprc': 0.9990130872661815, 'loss_val': 0.054511580486205045, 'psi': 0.9984426548156804}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=38 head_norm_before_train=1.608044 cos_to_last_merge=0.9780 (last merge round=30)
[S15] round=38 local utility u=1.000000 metrics={'f1_val': 0.9646177840347826, 'auprc': 0.990317642423195, 'loss_val': 0.08271653464788083, 'psi': 0.9748977273901476}-{'f1_val': 0.7033095065017607, 'auprc': 0.967787476867519, 'loss_val': 0.46186519401434833, 'psi': 0.8091006946480641}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=38 head_norm_before_train=1.621581 cos_to_last_merge=0.9802 (last merge round=29)
[S16] round=38 local utility u=0.674608 metrics={'f1_val': 0.9928101126433023, 'auprc': 0.9974218974469696, 'loss_val': 0.045046964405377476, 'psi': 0.9946548265647692}-{'f1_val': 0.8730473691120055, 'auprc': 0.9918279127140835, 'loss_val': 0.6589036340396457, 'psi': 0.9205595865528368}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S17] START round=38 head_norm_before_train=1.579139 cos_to_last_merge=0.9890 (last merge round=31)
[S17] round=38 local utility u=0.042766 metrics={'f1_val': 0.6294814750832596, 'auprc': 0.9040794120680531, 'loss_val': 1.0023158058759507, 'psi': 0.7393206498771769}-{'f1_val': 0.6279328846135886, 'auprc': 0.8647259418466042, 'loss_val': 0.960496388024193, 'psi': 0.7226501075067948}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[S2] START round=39 head_norm_before_train=1.848061 cos_to_last_merge=0.7792 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.779
[S2] round=39 local utility u=0.076247 metrics={'f1_val': 0.6991449273630627, 'auprc': 0.7475304443146146, 'loss_val': 1.023525746585795, 'psi': 0.7184991341436834}-{'f1_val': 0.6797842401743402, 'auprc': 0.7457717685623944, 'loss_val': 1.0545801241226787, 'psi': 0.706179251529562}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S2] r=40 psi=0.718 u=0.0762 p_local=0.0836 f1=0.699 auprc=0.748 bytes=36006
[S3] START round=39 head_norm_before_train=1.538516 cos_to_last_merge=0.9960 (last merge round=30)
[S3] round=39 local utility u=0.000000 metrics={'f1_val': 0.9066964096629144, 'auprc': 0.970821930750928, 'loss_val': 0.17863443908456322, 'psi': 0.9323466180981198}-{'f1_val': 0.9810150216627614, 'auprc': 0.9995737853590305, 'loss_val': 0.0768762449350006, 'psi': 0.9884385271412691}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=40 psi=0.932 u=0.0000 p_local=0.2464 f1=0.907 auprc=0.971 bytes=39558
[S4] START round=39 head_norm_before_train=1.653183 cos_to_last_merge=0.9989 (last merge round=31)
[S4] round=39 local utility u=0.000000 metrics={'f1_val': 0.9406319116264494, 'auprc': 0.9492406442833841, 'loss_val': 0.3208101284246287, 'psi': 0.9440754046892232}-{'f1_val': 0.9448624342369771, 'auprc': 0.9559949817159921, 'loss_val': 0.30808784845584414, 'psi': 0.9493154532285831}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=40 psi=0.944 u=0.0000 p_local=0.0344 f1=0.941 auprc=0.949 bytes=32368
[S5] START round=39 head_norm_before_train=1.817172 (no previous merge yet)
[S5] round=39 local utility u=0.000000 metrics={'f1_val': 0.7438831362706053, 'auprc': 0.9883800526228437, 'loss_val': 0.17796688795242407, 'psi': 0.8416819028115006}-{'f1_val': 0.9146036222138392, 'auprc': 0.9654780211946534, 'loss_val': 0.29758580160566434, 'psi': 0.9349533818061648}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=40 psi=0.842 u=0.0000 p_local=0.1947 f1=0.744 auprc=0.988 bytes=43105
[S6] START round=39 head_norm_before_train=2.072518 (no previous merge yet)
[S6] round=39 local utility u=0.910881 metrics={'f1_val': 0.8326366506667824, 'auprc': 0.9540834532691226, 'loss_val': 0.39169767757061713, 'psi': 0.8812153717077185}-{'f1_val': 0.6430502193926826, 'auprc': 0.8865543768805892, 'loss_val': 0.8733533301465962, 'psi': 0.7404518823878452}
[S6] not sending this round → trigger blocked (psi=0.881)
[S6] r=40 psi=0.881 u=0.9109 p_local=0.3468 f1=0.833 auprc=0.954 bytes=28759
[S7] START round=39 head_norm_before_train=1.525167 cos_to_last_merge=0.9977 (last merge round=30)
[S7] round=39 local utility u=0.000000 metrics={'f1_val': 0.5272714478439257, 'auprc': 0.780369025736062, 'loss_val': 0.9640690364466491, 'psi': 0.6285104790007803}-{'f1_val': 0.6520162560638681, 'auprc': 0.8030480282231174, 'loss_val': 0.5022749674827806, 'psi': 0.7124289649275679}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] r=40 psi=0.629 u=0.0000 p_local=0.0933 f1=0.527 auprc=0.780 bytes=32387
[S8] START round=39 head_norm_before_train=2.157742 (no previous merge yet)
[S8] round=39 local utility u=0.122885 metrics={'f1_val': 0.9936676463518993, 'auprc': 0.9990708962827796, 'loss_val': 0.030387296724259924, 'psi': 0.9958289463242515}-{'f1_val': 0.9651817379692634, 'auprc': 0.9982986473616529, 'loss_val': 0.10292570525604908, 'psi': 0.9784285017262192}
[S8] not sending this round → trigger blocked (psi=0.996)
[S8] r=40 psi=0.996 u=0.1229 p_local=0.0919 f1=0.994 auprc=0.999 bytes=34126
[S9] START round=39 head_norm_before_train=1.622191 cos_to_last_merge=0.9716 (last merge round=24)
[S9] round=39 local utility u=0.033795 metrics={'f1_val': 0.9962748907591257, 'auprc': 0.9988305814559038, 'loss_val': 0.04283977346934185, 'psi': 0.997297167037837}-{'f1_val': 0.9878532334303461, 'auprc': 0.9988335255924241, 'loss_val': 0.05990803994615969, 'psi': 0.9922453502951774}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S9] r=40 psi=0.997 u=0.0338 p_local=0.0576 f1=0.996 auprc=0.999 bytes=39521
[S10] START round=39 head_norm_before_train=1.758413 cos_to_last_merge=0.9673 (last merge round=25)
[S10] round=39 local utility u=0.000312 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9959393180631682, 'loss_val': 0.030756945299207483, 'psi': 0.9952248927568907}-{'f1_val': 0.9947486092193725, 'auprc': 0.99593974448288, 'loss_val': 0.03138282489018184, 'psi': 0.9952250633247754}
[S10] not sending this round → trigger blocked (psi=0.995)
[S10] r=40 psi=0.995 u=0.0003 p_local=0.0027 f1=0.995 auprc=0.996 bytes=43129
[S11] START round=39 head_norm_before_train=1.497298 cos_to_last_merge=0.9840 (last merge round=31)
[S11] round=39 local utility u=0.002867 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9963594985879283, 'loss_val': 0.05420835771395216, 'psi': 0.9964720021433251}-{'f1_val': 0.9965470045135896, 'auprc': 0.996333275956054, 'loss_val': 0.05986374303003172, 'psi': 0.9964615130905754}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S11] r=40 psi=0.996 u=0.0029 p_local=0.0137 f1=0.997 auprc=0.996 bytes=39556
[S13] START round=39 head_norm_before_train=1.495500 cos_to_last_merge=0.9970 (last merge round=31)
[S13] round=39 local utility u=0.568548 metrics={'f1_val': 0.6935051023809137, 'auprc': 0.7904944204803168, 'loss_val': 1.0150898239778565, 'psi': 0.732300829620675}-{'f1_val': 0.6098468458845571, 'auprc': 0.6046492666605654, 'loss_val': 1.0927001818941553, 'psi': 0.6077678141949604}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S13] r=40 psi=0.732 u=0.5685 p_local=0.1544 f1=0.694 auprc=0.790 bytes=32390
[S14] START round=39 head_norm_before_train=1.596884 cos_to_last_merge=0.9889 (last merge round=30)
[S14] round=39 local utility u=0.002930 metrics={'f1_val': 0.9980623665153463, 'auprc': 0.9989750834722938, 'loss_val': 0.04336882563871995, 'psi': 0.9984274532981253}-{'f1_val': 0.9974310505072961, 'auprc': 0.9986318667988546, 'loss_val': 0.04441072279408737, 'psi': 0.9979113770239195}
[S14] not sending this round → trigger blocked (psi=0.998)
[S14] r=40 psi=0.998 u=0.0029 p_local=0.0089 f1=0.998 auprc=0.999 bytes=43214
[S15] START round=39 head_norm_before_train=1.636210 cos_to_last_merge=0.9748 (last merge round=30)
[S15] round=39 local utility u=0.000000 metrics={'f1_val': 0.9493219081177722, 'auprc': 0.99294366294742, 'loss_val': 0.10612790247668363, 'psi': 0.9667706100496313}-{'f1_val': 0.9646177840347826, 'auprc': 0.990317642423195, 'loss_val': 0.08271653464788083, 'psi': 0.9748977273901476}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] r=40 psi=0.967 u=0.0000 p_local=0.3378 f1=0.949 auprc=0.993 bytes=35999
[S16] START round=39 head_norm_before_train=1.641755 cos_to_last_merge=0.9787 (last merge round=29)
[S16] round=39 local utility u=0.003699 metrics={'f1_val': 0.9928155511239698, 'auprc': 0.9984302943940753, 'loss_val': 0.04070658668144671, 'psi': 0.995061448432012}-{'f1_val': 0.9928101126433023, 'auprc': 0.9974218974469696, 'loss_val': 0.045046964405377476, 'psi': 0.9946548265647692}
[S16] not sending this round → trigger blocked (psi=0.995)
[S16] r=40 psi=0.995 u=0.0037 p_local=0.1706 f1=0.993 auprc=0.998 bytes=45024
[S17] START round=39 head_norm_before_train=1.602571 cos_to_last_merge=0.9869 (last merge round=31)
[S17] round=39 local utility u=0.113079 metrics={'f1_val': 0.6464061243738733, 'auprc': 0.92188901492098, 'loss_val': 0.9311353033248139, 'psi': 0.756599280592716}-{'f1_val': 0.6294814750832596, 'auprc': 0.9040794120680531, 'loss_val': 1.0023158058759507, 'psi': 0.7393206498771769}
[S17] not sending this round → trigger blocked (psi=0.757)
[S17] r=40 psi=0.757 u=0.1131 p_local=0.1549 f1=0.646 auprc=0.922 bytes=30620
[S2] START round=40 head_norm_before_train=1.869257 cos_to_last_merge=0.7776 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.778
[S2] round=40 local utility u=0.133793 metrics={'f1_val': 0.7149087785260568, 'auprc': 0.7678096829494736, 'loss_val': 0.9113595721622152, 'psi': 0.7360691402954236}-{'f1_val': 0.6991449273630627, 'auprc': 0.7475304443146146, 'loss_val': 1.023525746585795, 'psi': 0.7184991341436834}
[S2] not sending this round → trigger blocked (psi=0.736)
[S3] START round=40 head_norm_before_train=1.550837 cos_to_last_merge=0.9954 (last merge round=30)
[S3] round=40 local utility u=0.000000 metrics={'f1_val': 0.897840725735455, 'auprc': 0.9766076791474849, 'loss_val': 0.1726191662648757, 'psi': 0.929347507100267}-{'f1_val': 0.9066964096629144, 'auprc': 0.970821930750928, 'loss_val': 0.17863443908456322, 'psi': 0.9323466180981198}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=40 head_norm_before_train=1.661540 cos_to_last_merge=0.9988 (last merge round=31)
[S4] round=40 local utility u=0.020154 metrics={'f1_val': 0.9449800086438676, 'auprc': 0.95013124641261, 'loss_val': 0.3092633851843387, 'psi': 0.9470405037513645}-{'f1_val': 0.9406319116264494, 'auprc': 0.9492406442833841, 'loss_val': 0.3208101284246287, 'psi': 0.9440754046892232}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=40 head_norm_before_train=1.820448 (no previous merge yet)
[S5] round=40 local utility u=0.808269 metrics={'f1_val': 0.997054106345554, 'auprc': 0.9932945242593024, 'loss_val': 0.09519800919569443, 'psi': 0.9955502735110534}-{'f1_val': 0.7438831362706053, 'auprc': 0.9883800526228437, 'loss_val': 0.17796688795242407, 'psi': 0.8416819028115006}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=40 head_norm_before_train=2.088589 (no previous merge yet)
[S6] round=40 local utility u=0.000000 metrics={'f1_val': 0.6239628210085114, 'auprc': 0.9121045487813809, 'loss_val': 1.016573495376185, 'psi': 0.7392195121176592}-{'f1_val': 0.8326366506667824, 'auprc': 0.9540834532691226, 'loss_val': 0.39169767757061713, 'psi': 0.8812153717077185}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=40 head_norm_before_train=1.529504 cos_to_last_merge=0.9977 (last merge round=30)
[S7] round=40 local utility u=0.643963 metrics={'f1_val': 0.6551962045843867, 'auprc': 0.8034092523793736, 'loss_val': 0.5128119361156236, 'psi': 0.7144814237023814}-{'f1_val': 0.5272714478439257, 'auprc': 0.780369025736062, 'loss_val': 0.9640690364466491, 'psi': 0.6285104790007803}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=40 head_norm_before_train=2.161459 (no previous merge yet)
[S8] round=40 local utility u=0.000000 metrics={'f1_val': 0.9926811669910671, 'auprc': 0.9992548760915385, 'loss_val': 0.03146709900392626, 'psi': 0.9953106506312557}-{'f1_val': 0.9936676463518993, 'auprc': 0.9990708962827796, 'loss_val': 0.030387296724259924, 'psi': 0.9958289463242515}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=40 head_norm_before_train=1.636338 cos_to_last_merge=0.9704 (last merge round=24)
[S9] round=40 local utility u=0.001531 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9988002728580576, 'loss_val': 0.042191616067758356, 'psi': 0.9975356039020804}-{'f1_val': 0.9962748907591257, 'auprc': 0.9988305814559038, 'loss_val': 0.04283977346934185, 'psi': 0.997297167037837}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=40 head_norm_before_train=1.772451 cos_to_last_merge=0.9660 (last merge round=25)
[S10] round=40 local utility u=0.000192 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9959954859387007, 'loss_val': 0.030541558605556598, 'psi': 0.9952473599071038}-{'f1_val': 0.9947486092193725, 'auprc': 0.9959393180631682, 'loss_val': 0.030756945299207483, 'psi': 0.9952248927568907}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=40 head_norm_before_train=1.521615 cos_to_last_merge=0.9818 (last merge round=31)
[S11] round=40 local utility u=0.002250 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.996372498697359, 'loss_val': 0.049746361001162316, 'psi': 0.9964772021870973}-{'f1_val': 0.9965470045135896, 'auprc': 0.9963594985879283, 'loss_val': 0.05420835771395216, 'psi': 0.9964720021433251}
[S11] not sending this round → trigger blocked (psi=0.996)
[S13] START round=40 head_norm_before_train=1.502531 cos_to_last_merge=0.9965 (last merge round=31)
[S13] round=40 local utility u=0.067554 metrics={'f1_val': 0.6776937352552339, 'auprc': 0.7900351262751046, 'loss_val': 0.7837359602260706, 'psi': 0.7226302916631822}-{'f1_val': 0.6935051023809137, 'auprc': 0.7904944204803168, 'loss_val': 1.0150898239778565, 'psi': 0.732300829620675}
[S13] not sending this round → trigger blocked (psi=0.723)
[S14] START round=40 head_norm_before_train=1.615489 cos_to_last_merge=0.9877 (last merge round=30)
[S14] round=40 local utility u=0.000000 metrics={'f1_val': 0.9928182792787577, 'auprc': 0.9990319110640576, 'loss_val': 0.05481039026183824, 'psi': 0.9953037319928777}-{'f1_val': 0.9980623665153463, 'auprc': 0.9989750834722938, 'loss_val': 0.04336882563871995, 'psi': 0.9984274532981253}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=40 head_norm_before_train=1.663183 cos_to_last_merge=0.9717 (last merge round=30)
[S15] round=40 local utility u=0.152403 metrics={'f1_val': 0.9921932130225829, 'auprc': 0.9905027364589681, 'loss_val': 0.051226621889917834, 'psi': 0.991517022397137}-{'f1_val': 0.9493219081177722, 'auprc': 0.99294366294742, 'loss_val': 0.10612790247668363, 'psi': 0.9667706100496313}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] sending update (kind=head size=1802 to 1 peers)
[S16] START round=40 head_norm_before_train=1.658267 cos_to_last_merge=0.9776 (last merge round=29)
[S16] round=40 local utility u=0.000000 metrics={'f1_val': 0.924050859799902, 'auprc': 0.9900757289167595, 'loss_val': 0.41792840067929027, 'psi': 0.950460807446645}-{'f1_val': 0.9928155511239698, 'auprc': 0.9984302943940753, 'loss_val': 0.04070658668144671, 'psi': 0.995061448432012}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=40 head_norm_before_train=1.625615 cos_to_last_merge=0.9848 (last merge round=31)
[S17] round=40 local utility u=0.000000 metrics={'f1_val': 0.6391389148172831, 'auprc': 0.9067975067644172, 'loss_val': 0.972274184335478, 'psi': 0.7462023515961368}-{'f1_val': 0.6464061243738733, 'auprc': 0.92188901492098, 'loss_val': 0.9311353033248139, 'psi': 0.756599280592716}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=41 head_norm_before_train=1.886280 cos_to_last_merge=0.7760 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.776
[S2] round=41 local utility u=0.000000 metrics={'f1_val': 0.7036770407595048, 'auprc': 0.7578798943897039, 'loss_val': 0.9994028766665427, 'psi': 0.7253581822115844}-{'f1_val': 0.7149087785260568, 'auprc': 0.7678096829494736, 'loss_val': 0.9113595721622152, 'psi': 0.7360691402954236}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=41 head_norm_before_train=1.562505 cos_to_last_merge=0.9948 (last merge round=30)
[S3] round=41 local utility u=0.242197 metrics={'f1_val': 0.9557547515303955, 'auprc': 0.9954338204707702, 'loss_val': 0.09218789013313856, 'psi': 0.9716263791065454}-{'f1_val': 0.897840725735455, 'auprc': 0.9766076791474849, 'loss_val': 0.1726191662648757, 'psi': 0.929347507100267}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] sending update (kind=head size=1804 to 1 peers)
[S4] START round=41 head_norm_before_train=1.669509 cos_to_last_merge=0.9986 (last merge round=31)
[S4] round=41 local utility u=0.000000 metrics={'f1_val': 0.9394783380970113, 'auprc': 0.9467488200659067, 'loss_val': 0.3320463180173306, 'psi': 0.9423865308845694}-{'f1_val': 0.9449800086438676, 'auprc': 0.95013124641261, 'loss_val': 0.3092633851843387, 'psi': 0.9470405037513645}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=41 head_norm_before_train=1.824576 (no previous merge yet)
[S5] round=41 local utility u=0.000000 metrics={'f1_val': 0.7007816778637295, 'auprc': 0.9877816016774543, 'loss_val': 0.436883627383989, 'psi': 0.8155816473892195}-{'f1_val': 0.997054106345554, 'auprc': 0.9932945242593024, 'loss_val': 0.09519800919569443, 'psi': 0.9955502735110534}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=41 head_norm_before_train=2.104890 (no previous merge yet)
[S6] round=41 local utility u=1.000000 metrics={'f1_val': 0.8334829175416998, 'auprc': 0.9488952439554643, 'loss_val': 0.3822505748297611, 'psi': 0.8796478481072055}-{'f1_val': 0.6239628210085114, 'auprc': 0.9121045487813809, 'loss_val': 1.016573495376185, 'psi': 0.7392195121176592}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] START round=41 head_norm_before_train=1.534186 cos_to_last_merge=0.9978 (last merge round=30)
[S7] round=41 local utility u=0.000000 metrics={'f1_val': 0.46381832717640886, 'auprc': 0.7776927545363415, 'loss_val': 1.1365235931604172, 'psi': 0.5893680981203819}-{'f1_val': 0.6551962045843867, 'auprc': 0.8034092523793736, 'loss_val': 0.5128119361156236, 'psi': 0.7144814237023814}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=41 head_norm_before_train=2.172858 (no previous merge yet)
[S8] round=41 local utility u=0.003098 metrics={'f1_val': 0.9934116751513793, 'auprc': 0.9991825564242048, 'loss_val': 0.029437222998097902, 'psi': 0.9957200276605095}-{'f1_val': 0.9926811669910671, 'auprc': 0.9992548760915385, 'loss_val': 0.03146709900392626, 'psi': 0.9953106506312557}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S8] sending update (kind=head size=1792 to 1 peers)
[S9] START round=41 head_norm_before_train=1.649408 cos_to_last_merge=0.9692 (last merge round=24)
[S9] round=41 local utility u=0.000000 metrics={'f1_val': 0.9904109382186765, 'auprc': 0.9988294152771383, 'loss_val': 0.04675347708529734, 'psi': 0.9937783290420612}-{'f1_val': 0.9966924912647621, 'auprc': 0.9988002728580576, 'loss_val': 0.042191616067758356, 'psi': 0.9975356039020804}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=41 head_norm_before_train=1.786310 cos_to_last_merge=0.9648 (last merge round=25)
[S10] round=41 local utility u=0.000000 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9960617182956686, 'loss_val': 0.03032496952708792, 'psi': 0.995142151397304}-{'f1_val': 0.9947486092193725, 'auprc': 0.9959954859387007, 'loss_val': 0.030541558605556598, 'psi': 0.9952473599071038}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=41 head_norm_before_train=1.543090 cos_to_last_merge=0.9799 (last merge round=31)
[S11] round=41 local utility u=0.001966 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9964268602247438, 'loss_val': 0.045978173326372086, 'psi': 0.9964989467980513}-{'f1_val': 0.9965470045135896, 'auprc': 0.996372498697359, 'loss_val': 0.049746361001162316, 'psi': 0.9964772021870973}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=41 head_norm_before_train=1.511003 cos_to_last_merge=0.9960 (last merge round=31)
[S13] round=41 local utility u=0.000000 metrics={'f1_val': 0.607837193567287, 'auprc': 0.773362516387372, 'loss_val': 1.158673723194511, 'psi': 0.674047322695321}-{'f1_val': 0.6776937352552339, 'auprc': 0.7900351262751046, 'loss_val': 0.7837359602260706, 'psi': 0.7226302916631822}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=41 head_norm_before_train=1.632215 cos_to_last_merge=0.9866 (last merge round=30)
[S14] round=41 local utility u=0.000000 metrics={'f1_val': 0.9585223567355339, 'auprc': 0.9968999161696895, 'loss_val': 0.07057707412259127, 'psi': 0.9738733805091961}-{'f1_val': 0.9928182792787577, 'auprc': 0.9990319110640576, 'loss_val': 0.05481039026183824, 'psi': 0.9953037319928777}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=41 head_norm_before_train=1.687222 cos_to_last_merge=0.9693 (last merge round=30)
[S15] round=41 local utility u=0.000000 metrics={'f1_val': 0.8164149302188225, 'auprc': 0.9889000969184807, 'loss_val': 0.3217451751630472, 'psi': 0.8854089968986858}-{'f1_val': 0.9921932130225829, 'auprc': 0.9905027364589681, 'loss_val': 0.051226621889917834, 'psi': 0.991517022397137}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=41 head_norm_before_train=1.672270 cos_to_last_merge=0.9766 (last merge round=29)
[S16] round=41 local utility u=0.000000 metrics={'f1_val': 0.8900919033146645, 'auprc': 0.9916702723218516, 'loss_val': 0.5551432091935342, 'psi': 0.9307232509175394}-{'f1_val': 0.924050859799902, 'auprc': 0.9900757289167595, 'loss_val': 0.41792840067929027, 'psi': 0.950460807446645}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=41 head_norm_before_train=1.643213 cos_to_last_merge=0.9829 (last merge round=31)
[S17] round=41 local utility u=0.000000 metrics={'f1_val': 0.6439124634784269, 'auprc': 0.9130185555959787, 'loss_val': 1.1819547080480974, 'psi': 0.7515549003254476}-{'f1_val': 0.6391389148172831, 'auprc': 0.9067975067644172, 'loss_val': 0.972274184335478, 'psi': 0.7462023515961368}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=42 head_norm_before_train=1.902179 cos_to_last_merge=0.7745 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.774
[S2] round=42 local utility u=0.000000 metrics={'f1_val': 0.6613621298519091, 'auprc': 0.7434615876645421, 'loss_val': 1.364190785602796, 'psi': 0.6942019129769623}-{'f1_val': 0.7036770407595048, 'auprc': 0.7578798943897039, 'loss_val': 0.9994028766665427, 'psi': 0.7253581822115844}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=42 head_norm_before_train=1.574154 cos_to_last_merge=0.9942 (last merge round=30)
[S3] round=42 local utility u=0.127662 metrics={'f1_val': 0.9916816449507647, 'auprc': 0.9995571253186678, 'loss_val': 0.06479589645025266, 'psi': 0.9948318370979259}-{'f1_val': 0.9557547515303955, 'auprc': 0.9954338204707702, 'loss_val': 0.09218789013313856, 'psi': 0.9716263791065454}
[S3] not sending this round → trigger blocked (psi=0.995)
[S4] START round=42 head_norm_before_train=1.674978 cos_to_last_merge=0.9986 (last merge round=31)
[S4] round=42 local utility u=0.000000 metrics={'f1_val': 0.9386380259518483, 'auprc': 0.9457764346032438, 'loss_val': 0.3492959403826069, 'psi': 0.9414933894124065}-{'f1_val': 0.9394783380970113, 'auprc': 0.9467488200659067, 'loss_val': 0.3320463180173306, 'psi': 0.9423865308845694}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=42 head_norm_before_train=1.827669 (no previous merge yet)
[S5] round=42 local utility u=1.000000 metrics={'f1_val': 0.9970988149896556, 'auprc': 0.9990142707372884, 'loss_val': 0.07985415192783217, 'psi': 0.9978649972887087}-{'f1_val': 0.7007816778637295, 'auprc': 0.9877816016774543, 'loss_val': 0.436883627383989, 'psi': 0.8155816473892195}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] START round=42 head_norm_before_train=2.114187 (no previous merge yet)
[S6] round=42 local utility u=0.000000 metrics={'f1_val': 0.7654190803646377, 'auprc': 0.9072677094221813, 'loss_val': 0.7204422578043649, 'psi': 0.8221585319876552}-{'f1_val': 0.8334829175416998, 'auprc': 0.9488952439554643, 'loss_val': 0.3822505748297611, 'psi': 0.8796478481072055}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=42 head_norm_before_train=1.538687 cos_to_last_merge=0.9977 (last merge round=30)
[S7] round=42 local utility u=1.000000 metrics={'f1_val': 0.6892893202988357, 'auprc': 0.8651429265922608, 'loss_val': 0.2908318619085341, 'psi': 0.7596307628162058}-{'f1_val': 0.46381832717640886, 'auprc': 0.7776927545363415, 'loss_val': 1.1365235931604172, 'psi': 0.5893680981203819}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] sending update (kind=head size=1796 to 1 peers)
[S8] START round=42 head_norm_before_train=2.183451 (no previous merge yet)
[S8] round=42 local utility u=0.000000 metrics={'f1_val': 0.9905027553548844, 'auprc': 0.9990919538612799, 'loss_val': 0.03782810448151596, 'psi': 0.9939384347574426}-{'f1_val': 0.9934116751513793, 'auprc': 0.9991825564242048, 'loss_val': 0.029437222998097902, 'psi': 0.9957200276605095}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=42 head_norm_before_train=1.661687 cos_to_last_merge=0.9681 (last merge round=24)
[S9] round=42 local utility u=0.000000 metrics={'f1_val': 0.8034252091586411, 'auprc': 0.9990036288294957, 'loss_val': 0.22770941626871757, 'psi': 0.8816565770269829}-{'f1_val': 0.9904109382186765, 'auprc': 0.9988294152771383, 'loss_val': 0.04675347708529734, 'psi': 0.9937783290420612}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=42 head_norm_before_train=1.799882 cos_to_last_merge=0.9637 (last merge round=25)
[S10] round=42 local utility u=0.000000 metrics={'f1_val': 0.993888323675122, 'auprc': 0.9960773225098467, 'loss_val': 0.03014608211567797, 'psi': 0.994763923209012}-{'f1_val': 0.9945291067983943, 'auprc': 0.9960617182956686, 'loss_val': 0.03032496952708792, 'psi': 0.995142151397304}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=42 head_norm_before_train=1.562935 cos_to_last_merge=0.9781 (last merge round=31)
[S11] round=42 local utility u=0.002298 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9969433820332139, 'loss_val': 0.042932123783472, 'psi': 0.9967055555214392}-{'f1_val': 0.9965470045135896, 'auprc': 0.9964268602247438, 'loss_val': 0.045978173326372086, 'psi': 0.9964989467980513}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=42 head_norm_before_train=1.520052 cos_to_last_merge=0.9954 (last merge round=31)
[S13] round=42 local utility u=0.055253 metrics={'f1_val': 0.6328783761678357, 'auprc': 0.6960611885969044, 'loss_val': 0.9665113588014704, 'psi': 0.6581515011394632}-{'f1_val': 0.607837193567287, 'auprc': 0.773362516387372, 'loss_val': 1.158673723194511, 'psi': 0.674047322695321}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=42 head_norm_before_train=1.648452 cos_to_last_merge=0.9854 (last merge round=30)
[S14] round=42 local utility u=0.139112 metrics={'f1_val': 0.9980623665153463, 'auprc': 0.9986190617137296, 'loss_val': 0.03474963521514819, 'psi': 0.9982850445946997}-{'f1_val': 0.9585223567355339, 'auprc': 0.9968999161696895, 'loss_val': 0.07057707412259127, 'psi': 0.9738733805091961}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=42 head_norm_before_train=1.708491 cos_to_last_merge=0.9671 (last merge round=30)
[S15] round=42 local utility u=0.000000 metrics={'f1_val': 0.7862226506209886, 'auprc': 0.9854966784374616, 'loss_val': 0.4216016957287996, 'psi': 0.8659322617475778}-{'f1_val': 0.8164149302188225, 'auprc': 0.9889000969184807, 'loss_val': 0.3217451751630472, 'psi': 0.8854089968986858}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=42 head_norm_before_train=1.684903 cos_to_last_merge=0.9758 (last merge round=29)
[S16] round=42 local utility u=0.245908 metrics={'f1_val': 0.9368185403259156, 'auprc': 0.9921901149444069, 'loss_val': 0.34524708220617706, 'psi': 0.958967170173312}-{'f1_val': 0.8900919033146645, 'auprc': 0.9916702723218516, 'loss_val': 0.5551432091935342, 'psi': 0.9307232509175394}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=42 head_norm_before_train=1.659372 cos_to_last_merge=0.9812 (last merge round=31)
[S17] round=42 local utility u=0.000000 metrics={'f1_val': 0.612338386087683, 'auprc': 0.6176014385655394, 'loss_val': 1.3829621053200318, 'psi': 0.6144436070788255}-{'f1_val': 0.6439124634784269, 'auprc': 0.9130185555959787, 'loss_val': 1.1819547080480974, 'psi': 0.7515549003254476}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=43 head_norm_before_train=1.916482 cos_to_last_merge=0.7735 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.774
[S2] round=43 local utility u=0.187069 metrics={'f1_val': 0.6911701678508151, 'auprc': 0.7336489762091154, 'loss_val': 1.1394626832466364, 'psi': 0.7081616911941352}-{'f1_val': 0.6613621298519091, 'auprc': 0.7434615876645421, 'loss_val': 1.364190785602796, 'psi': 0.6942019129769623}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=43 head_norm_before_train=1.582753 cos_to_last_merge=0.9933 (last merge round=30)
[S3] round=43 local utility u=0.000000 metrics={'f1_val': 0.8758137845385561, 'auprc': 0.9815136577631391, 'loss_val': 0.181831642515095, 'psi': 0.9180937338283893}-{'f1_val': 0.9916816449507647, 'auprc': 0.9995571253186678, 'loss_val': 0.06479589645025266, 'psi': 0.9948318370979259}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=43 head_norm_before_train=1.679537 cos_to_last_merge=0.9985 (last merge round=31)
[S4] round=43 local utility u=0.027687 metrics={'f1_val': 0.9402625410887429, 'auprc': 0.9523151829385973, 'loss_val': 0.3232859321210644, 'psi': 0.9450835978286846}-{'f1_val': 0.9386380259518483, 'auprc': 0.9457764346032438, 'loss_val': 0.3492959403826069, 'psi': 0.9414933894124065}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=43 head_norm_before_train=1.829691 (no previous merge yet)
[S5] round=43 local utility u=0.000000 metrics={'f1_val': 0.9577673888988667, 'auprc': 0.9921671436370082, 'loss_val': 0.10734034302325879, 'psi': 0.9715272907941234}-{'f1_val': 0.9970988149896556, 'auprc': 0.9990142707372884, 'loss_val': 0.07985415192783217, 'psi': 0.9978649972887087}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=43 head_norm_before_train=2.125880 (no previous merge yet)
[S6] round=43 local utility u=0.455619 metrics={'f1_val': 0.8416490012104334, 'auprc': 0.9523564230113516, 'loss_val': 0.40185040955583234, 'psi': 0.8859319699308006}-{'f1_val': 0.7654190803646377, 'auprc': 0.9072677094221813, 'loss_val': 0.7204422578043649, 'psi': 0.8221585319876552}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] sending update (kind=head size=1795 to 1 peers)
[S7] START round=43 head_norm_before_train=1.542290 cos_to_last_merge=0.9976 (last merge round=30)
[S7] round=43 local utility u=0.000000 metrics={'f1_val': 0.5309818348849465, 'auprc': 0.7821881071337345, 'loss_val': 0.8873839750775543, 'psi': 0.6314643437844618}-{'f1_val': 0.6892893202988357, 'auprc': 0.8651429265922608, 'loss_val': 0.2908318619085341, 'psi': 0.7596307628162058}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=43 head_norm_before_train=2.188353 (no previous merge yet)
[S8] round=43 local utility u=0.018149 metrics={'f1_val': 0.9948349509112366, 'auprc': 0.9989493953940403, 'loss_val': 0.027095416621553174, 'psi': 0.9964807287043581}-{'f1_val': 0.9905027553548844, 'auprc': 0.9990919538612799, 'loss_val': 0.03782810448151596, 'psi': 0.9939384347574426}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S8] sending update (kind=head size=1789 to 1 peers)
[S9] START round=43 head_norm_before_train=1.671931 cos_to_last_merge=0.9673 (last merge round=24)
[S9] round=43 local utility u=0.672077 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9980645982238197, 'loss_val': 0.03768746420086318, 'psi': 0.9969758961570945}-{'f1_val': 0.8034252091586411, 'auprc': 0.9990036288294957, 'loss_val': 0.22770941626871757, 'psi': 0.8816565770269829}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=43 head_norm_before_train=1.810503 cos_to_last_merge=0.9626 (last merge round=25)
[S10] round=43 local utility u=0.001283 metrics={'f1_val': 0.9943272539091932, 'auprc': 0.9959344893666146, 'loss_val': 0.029784918758560108, 'psi': 0.9949701480921618}-{'f1_val': 0.993888323675122, 'auprc': 0.9960773225098467, 'loss_val': 0.03014608211567797, 'psi': 0.994763923209012}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=43 head_norm_before_train=1.581650 cos_to_last_merge=0.9764 (last merge round=31)
[S11] round=43 local utility u=0.000000 metrics={'f1_val': 0.9946232161565767, 'auprc': 0.9976152557579954, 'loss_val': 0.04537307239837109, 'psi': 0.9958200319971441}-{'f1_val': 0.9965470045135896, 'auprc': 0.9969433820332139, 'loss_val': 0.042932123783472, 'psi': 0.9967055555214392}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=43 head_norm_before_train=1.527381 cos_to_last_merge=0.9949 (last merge round=31)
[S13] round=43 local utility u=0.039996 metrics={'f1_val': 0.6153981025303426, 'auprc': 0.8056828577814803, 'loss_val': 1.1105031634371045, 'psi': 0.6915120046307976}-{'f1_val': 0.6328783761678357, 'auprc': 0.6960611885969044, 'loss_val': 0.9665113588014704, 'psi': 0.6581515011394632}
[S13] not sending this round → trigger blocked (psi=0.692)
[S14] START round=43 head_norm_before_train=1.662651 cos_to_last_merge=0.9844 (last merge round=30)
[S14] round=43 local utility u=0.000000 metrics={'f1_val': 0.9971882020035234, 'auprc': 0.9986617917192411, 'loss_val': 0.032818846962354715, 'psi': 0.9977776378898104}-{'f1_val': 0.9980623665153463, 'auprc': 0.9986190617137296, 'loss_val': 0.03474963521514819, 'psi': 0.9982850445946997}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=43 head_norm_before_train=1.732088 cos_to_last_merge=0.9647 (last merge round=30)
[S15] round=43 local utility u=0.354874 metrics={'f1_val': 0.8633593191828359, 'auprc': 0.9893357183774899, 'loss_val': 0.18619078656791446, 'psi': 0.9137498788606975}-{'f1_val': 0.7862226506209886, 'auprc': 0.9854966784374616, 'loss_val': 0.4216016957287996, 'psi': 0.8659322617475778}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] sending update (kind=head size=1804 to 1 peers)
[S16] START round=43 head_norm_before_train=1.698453 cos_to_last_merge=0.9749 (last merge round=29)
[S16] round=43 local utility u=0.328439 metrics={'f1_val': 0.9928101126433023, 'auprc': 0.997513423647818, 'loss_val': 0.04028918059936115, 'psi': 0.9946914370451087}-{'f1_val': 0.9368185403259156, 'auprc': 0.9921901149444069, 'loss_val': 0.34524708220617706, 'psi': 0.958967170173312}
[S16] not sending this round → trigger blocked (psi=0.995)
[S17] START round=43 head_norm_before_train=1.673755 cos_to_last_merge=0.9797 (last merge round=31)
[S17] round=43 local utility u=0.720887 metrics={'f1_val': 0.6453394618400441, 'auprc': 0.9497501525999039, 'loss_val': 1.13564020026092, 'psi': 0.767103738143988}-{'f1_val': 0.612338386087683, 'auprc': 0.6176014385655394, 'loss_val': 1.3829621053200318, 'psi': 0.6144436070788255}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=44 head_norm_before_train=1.930329 cos_to_last_merge=0.7722 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.772
[S2] round=44 local utility u=0.017317 metrics={'f1_val': 0.6878778658359249, 'auprc': 0.7496942416250834, 'loss_val': 1.1332104415268849, 'psi': 0.7126044161515883}-{'f1_val': 0.6911701678508151, 'auprc': 0.7336489762091154, 'loss_val': 1.1394626832466364, 'psi': 0.7081616911941352}
[S2] not sending this round → trigger blocked (psi=0.713)
[S3] START round=44 head_norm_before_train=1.591396 cos_to_last_merge=0.9927 (last merge round=30)
[S3] round=44 local utility u=0.000000 metrics={'f1_val': 0.8592225335593853, 'auprc': 0.9647415332907363, 'loss_val': 0.22278085079794033, 'psi': 0.9014301334519257}-{'f1_val': 0.8758137845385561, 'auprc': 0.9815136577631391, 'loss_val': 0.181831642515095, 'psi': 0.9180937338283893}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=44 head_norm_before_train=1.681861 cos_to_last_merge=0.9982 (last merge round=31)
[S4] round=44 local utility u=0.000000 metrics={'f1_val': 0.939619256569532, 'auprc': 0.9473934247537237, 'loss_val': 0.3276667360010603, 'psi': 0.9427289238432086}-{'f1_val': 0.9402625410887429, 'auprc': 0.9523151829385973, 'loss_val': 0.3232859321210644, 'psi': 0.9450835978286846}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=44 head_norm_before_train=1.832019 (no previous merge yet)
[S5] round=44 local utility u=0.000000 metrics={'f1_val': 0.862351579299548, 'auprc': 0.9900891619512279, 'loss_val': 0.1456113430451082, 'psi': 0.9134466123602198}-{'f1_val': 0.9577673888988667, 'auprc': 0.9921671436370082, 'loss_val': 0.10734034302325879, 'psi': 0.9715272907941234}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=44 head_norm_before_train=2.136120 (no previous merge yet)
[S6] round=44 local utility u=0.000000 metrics={'f1_val': 0.82127335655013, 'auprc': 0.9297313925562721, 'loss_val': 0.44993997460110036, 'psi': 0.8646565709525869}-{'f1_val': 0.8416490012104334, 'auprc': 0.9523564230113516, 'loss_val': 0.40185040955583234, 'psi': 0.8859319699308006}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=44 head_norm_before_train=1.544210 cos_to_last_merge=0.9975 (last merge round=30)
[S7] round=44 local utility u=0.923103 metrics={'f1_val': 0.6906055869164162, 'auprc': 0.875232677609244, 'loss_val': 0.2780532527418396, 'psi': 0.7644564231935473}-{'f1_val': 0.5309818348849465, 'auprc': 0.7821881071337345, 'loss_val': 0.8873839750775543, 'psi': 0.6314643437844618}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=44 head_norm_before_train=2.195038 (no previous merge yet)
[S8] round=44 local utility u=0.000000 metrics={'f1_val': 0.9919528555747477, 'auprc': 0.9990861161032328, 'loss_val': 0.03308223612460788, 'psi': 0.9948061597861417}-{'f1_val': 0.9948349509112366, 'auprc': 0.9989493953940403, 'loss_val': 0.027095416621553174, 'psi': 0.9964807287043581}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=44 head_norm_before_train=1.681981 cos_to_last_merge=0.9664 (last merge round=24)
[S9] round=44 local utility u=0.000000 metrics={'f1_val': 0.9937719190709611, 'auprc': 0.9987279976088076, 'loss_val': 0.03818376817954786, 'psi': 0.9957543504860996}-{'f1_val': 0.9962500947792776, 'auprc': 0.9980645982238197, 'loss_val': 0.03768746420086318, 'psi': 0.9969758961570945}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=44 head_norm_before_train=1.821755 cos_to_last_merge=0.9616 (last merge round=25)
[S10] round=44 local utility u=0.000000 metrics={'f1_val': 0.9936689701867679, 'auprc': 0.9959560761638645, 'loss_val': 0.030231772787854678, 'psi': 0.9945838125776065}-{'f1_val': 0.9943272539091932, 'auprc': 0.9959344893666146, 'loss_val': 0.029784918758560108, 'psi': 0.9949701480921618}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=44 head_norm_before_train=1.598232 cos_to_last_merge=0.9748 (last merge round=31)
[S11] round=44 local utility u=0.006473 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9965707011581935, 'loss_val': 0.03938460965260832, 'psi': 0.996411380944594}-{'f1_val': 0.9946232161565767, 'auprc': 0.9976152557579954, 'loss_val': 0.04537307239837109, 'psi': 0.9958200319971441}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] sending update (kind=head size=1803 to 1 peers)
[S13] START round=44 head_norm_before_train=1.536291 cos_to_last_merge=0.9944 (last merge round=31)
[S13] round=44 local utility u=0.218485 metrics={'f1_val': 0.6706507820439, 'auprc': 0.7672718572444639, 'loss_val': 0.8898167273198332, 'psi': 0.7092992121241256}-{'f1_val': 0.6153981025303426, 'auprc': 0.8056828577814803, 'loss_val': 1.1105031634371045, 'psi': 0.6915120046307976}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=44 head_norm_before_train=1.677735 cos_to_last_merge=0.9833 (last merge round=30)
[S14] round=44 local utility u=0.000000 metrics={'f1_val': 0.9972086331282386, 'auprc': 0.9991176093867903, 'loss_val': 0.035151994324553563, 'psi': 0.9979722236316593}-{'f1_val': 0.9971882020035234, 'auprc': 0.9986617917192411, 'loss_val': 0.032818846962354715, 'psi': 0.9977776378898104}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=44 head_norm_before_train=1.747562 cos_to_last_merge=0.9622 (last merge round=30)
[S15] round=44 local utility u=0.000000 metrics={'f1_val': 0.770811086760267, 'auprc': 0.9280919755009424, 'loss_val': 0.47249790378668505, 'psi': 0.8337234422565372}-{'f1_val': 0.8633593191828359, 'auprc': 0.9893357183774899, 'loss_val': 0.18619078656791446, 'psi': 0.9137498788606975}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=44 head_norm_before_train=1.709730 cos_to_last_merge=0.9741 (last merge round=29)
[S16] round=44 local utility u=0.000000 metrics={'f1_val': 0.9452003472107476, 'auprc': 0.9962192575408144, 'loss_val': 0.17530729432617326, 'psi': 0.9656079113427745}-{'f1_val': 0.9928101126433023, 'auprc': 0.997513423647818, 'loss_val': 0.04028918059936115, 'psi': 0.9946914370451087}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=44 head_norm_before_train=1.684202 cos_to_last_merge=0.9786 (last merge round=31)
[S17] round=44 local utility u=0.000000 metrics={'f1_val': 0.6251282642635704, 'auprc': 0.8913908167425422, 'loss_val': 1.2483901021834372, 'psi': 0.731633285255159}-{'f1_val': 0.6453394618400441, 'auprc': 0.9497501525999039, 'loss_val': 1.13564020026092, 'psi': 0.767103738143988}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=45 head_norm_before_train=1.942150 cos_to_last_merge=0.7710 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.771
[S2] round=45 local utility u=0.000000 metrics={'f1_val': 0.6566380504007545, 'auprc': 0.7667099695319228, 'loss_val': 1.2670661952678968, 'psi': 0.7006668180532218}-{'f1_val': 0.6878778658359249, 'auprc': 0.7496942416250834, 'loss_val': 1.1332104415268849, 'psi': 0.7126044161515883}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=45 head_norm_before_train=1.602425 cos_to_last_merge=0.9919 (last merge round=30)
[S3] round=45 local utility u=0.416590 metrics={'f1_val': 0.9625676571422255, 'auprc': 0.9955878602184022, 'loss_val': 0.10220977288879024, 'psi': 0.9757757383726962}-{'f1_val': 0.8592225335593853, 'auprc': 0.9647415332907363, 'loss_val': 0.22278085079794033, 'psi': 0.9014301334519257}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=45 head_norm_before_train=1.683385 cos_to_last_merge=0.9979 (last merge round=31)
[S4] round=45 local utility u=0.008447 metrics={'f1_val': 0.9412284565492671, 'auprc': 0.948159931983563, 'loss_val': 0.32272725225969867, 'psi': 0.9440010467229856}-{'f1_val': 0.939619256569532, 'auprc': 0.9473934247537237, 'loss_val': 0.3276667360010603, 'psi': 0.9427289238432086}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] START round=45 head_norm_before_train=1.836174 (no previous merge yet)
[S5] round=45 local utility u=0.111650 metrics={'f1_val': 0.9222585103696899, 'auprc': 0.9809155081098214, 'loss_val': 0.254231252076, 'psi': 0.9457213094657425}-{'f1_val': 0.862351579299548, 'auprc': 0.9900891619512279, 'loss_val': 0.1456113430451082, 'psi': 0.9134466123602198}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] START round=45 head_norm_before_train=2.147841 (no previous merge yet)
[S6] round=45 local utility u=0.000000 metrics={'f1_val': 0.7150827978804092, 'auprc': 0.8723480433817927, 'loss_val': 0.9087132946224337, 'psi': 0.7779888960809627}-{'f1_val': 0.82127335655013, 'auprc': 0.9297313925562721, 'loss_val': 0.44993997460110036, 'psi': 0.8646565709525869}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=45 head_norm_before_train=1.548086 cos_to_last_merge=0.9974 (last merge round=30)
[S7] round=45 local utility u=0.000000 metrics={'f1_val': 0.527159695064394, 'auprc': 0.7795120284683303, 'loss_val': 0.9938968506252264, 'psi': 0.6281006284259685}-{'f1_val': 0.6906055869164162, 'auprc': 0.875232677609244, 'loss_val': 0.2780532527418396, 'psi': 0.7644564231935473}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=45 head_norm_before_train=2.202396 (no previous merge yet)
[S8] round=45 local utility u=0.008148 metrics={'f1_val': 0.9938554489473111, 'auprc': 0.9989401783312395, 'loss_val': 0.027763358319617862, 'psi': 0.9958893407008825}-{'f1_val': 0.9919528555747477, 'auprc': 0.9990861161032328, 'loss_val': 0.03308223612460788, 'psi': 0.9948061597861417}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=45 head_norm_before_train=1.693638 cos_to_last_merge=0.9653 (last merge round=24)
[S9] round=45 local utility u=0.000000 metrics={'f1_val': 0.9827002379539219, 'auprc': 0.998457245010877, 'loss_val': 0.061722220020521246, 'psi': 0.9890030407767039}-{'f1_val': 0.9937719190709611, 'auprc': 0.9987279976088076, 'loss_val': 0.03818376817954786, 'psi': 0.9957543504860996}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=45 head_norm_before_train=1.833336 cos_to_last_merge=0.9606 (last merge round=25)
[S10] round=45 local utility u=0.002364 metrics={'f1_val': 0.9943272539091932, 'auprc': 0.9959593666615953, 'loss_val': 0.029462739824663062, 'psi': 0.994980099010154}-{'f1_val': 0.9936689701867679, 'auprc': 0.9959560761638645, 'loss_val': 0.030231772787854678, 'psi': 0.9945838125776065}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=45 head_norm_before_train=1.612683 cos_to_last_merge=0.9733 (last merge round=31)
[S11] round=45 local utility u=0.003041 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9974516795919692, 'loss_val': 0.03739620092585386, 'psi': 0.9969088745449415}-{'f1_val': 0.996305167468861, 'auprc': 0.9965707011581935, 'loss_val': 0.03938460965260832, 'psi': 0.996411380944594}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=45 head_norm_before_train=1.546840 cos_to_last_merge=0.9937 (last merge round=31)
[S13] round=45 local utility u=0.175106 metrics={'f1_val': 0.7371535001889661, 'auprc': 0.777717427961837, 'loss_val': 0.969957605967475, 'psi': 0.7533790712981145}-{'f1_val': 0.6706507820439, 'auprc': 0.7672718572444639, 'loss_val': 0.8898167273198332, 'psi': 0.7092992121241256}
[S13] not sending this round → trigger blocked (psi=0.753)
[S14] START round=45 head_norm_before_train=1.690864 cos_to_last_merge=0.9823 (last merge round=30)
[S14] round=45 local utility u=0.000000 metrics={'f1_val': 0.9972135067804855, 'auprc': 0.9970553064922618, 'loss_val': 0.03029455840279904, 'psi': 0.997150226665196}-{'f1_val': 0.9972086331282386, 'auprc': 0.9991176093867903, 'loss_val': 0.035151994324553563, 'psi': 0.9979722236316593}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=45 head_norm_before_train=1.767431 cos_to_last_merge=0.9600 (last merge round=30)
[S15] round=45 local utility u=0.996353 metrics={'f1_val': 0.9963324108488076, 'auprc': 0.9927261042882112, 'loss_val': 0.02682230964296822, 'psi': 0.994889888224569}-{'f1_val': 0.770811086760267, 'auprc': 0.9280919755009424, 'loss_val': 0.47249790378668505, 'psi': 0.8337234422565372}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] sending update (kind=head size=1803 to 1 peers)
[S16] START round=45 head_norm_before_train=1.721428 cos_to_last_merge=0.9732 (last merge round=29)
[S16] round=45 local utility u=0.000000 metrics={'f1_val': 0.9401580754154143, 'auprc': 0.9943889900456738, 'loss_val': 0.31691113375060903, 'psi': 0.9618504412675182}-{'f1_val': 0.9452003472107476, 'auprc': 0.9962192575408144, 'loss_val': 0.17530729432617326, 'psi': 0.9656079113427745}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=45 head_norm_before_train=1.697404 cos_to_last_merge=0.9774 (last merge round=31)
[S17] round=45 local utility u=0.109235 metrics={'f1_val': 0.6364342792340582, 'auprc': 0.9273969804467397, 'loss_val': 1.2057738207246893, 'psi': 0.7528193597191308}-{'f1_val': 0.6251282642635704, 'auprc': 0.8913908167425422, 'loss_val': 1.2483901021834372, 'psi': 0.731633285255159}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=46 head_norm_before_train=1.952426 cos_to_last_merge=0.7697 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.770
[S2] round=46 local utility u=0.327093 metrics={'f1_val': 0.7193721259848863, 'auprc': 0.7565747563168636, 'loss_val': 0.9588799094759239, 'psi': 0.7342531781176772}-{'f1_val': 0.6566380504007545, 'auprc': 0.7667099695319228, 'loss_val': 1.2670661952678968, 'psi': 0.7006668180532218}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=46 head_norm_before_train=1.613006 cos_to_last_merge=0.9912 (last merge round=30)
[S3] round=46 local utility u=0.000000 metrics={'f1_val': 0.6413744867599651, 'auprc': 0.9443494734881479, 'loss_val': 0.5719480737602401, 'psi': 0.7625644814512382}-{'f1_val': 0.9625676571422255, 'auprc': 0.9955878602184022, 'loss_val': 0.10220977288879024, 'psi': 0.9757757383726962}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=46 head_norm_before_train=1.689208 cos_to_last_merge=0.9977 (last merge round=31)
[S4] round=46 local utility u=0.000000 metrics={'f1_val': 0.9393787773222496, 'auprc': 0.9523101846042888, 'loss_val': 0.34522626178434285, 'psi': 0.9445513402350653}-{'f1_val': 0.9412284565492671, 'auprc': 0.948159931983563, 'loss_val': 0.32272725225969867, 'psi': 0.9440010467229856}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=46 head_norm_before_train=1.842431 (no previous merge yet)
[S5] round=46 local utility u=0.336400 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9932337546013872, 'loss_val': 0.06725156132212472, 'psi': 0.9955352370071935}-{'f1_val': 0.9222585103696899, 'auprc': 0.9809155081098214, 'loss_val': 0.254231252076, 'psi': 0.9457213094657425}
[S5] not sending this round → trigger blocked (psi=0.996)
[S6] START round=46 head_norm_before_train=2.165084 (no previous merge yet)
[S6] round=46 local utility u=0.000000 metrics={'f1_val': 0.6955991261387452, 'auprc': 0.8593096007865277, 'loss_val': 0.9432581415345952, 'psi': 0.7610833159978583}-{'f1_val': 0.7150827978804092, 'auprc': 0.8723480433817927, 'loss_val': 0.9087132946224337, 'psi': 0.7779888960809627}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=46 head_norm_before_train=1.552868 cos_to_last_merge=0.9973 (last merge round=30)
[S7] round=46 local utility u=0.516811 metrics={'f1_val': 0.6213721160837226, 'auprc': 0.7975482635801869, 'loss_val': 0.5796582435901767, 'psi': 0.6918425750823083}-{'f1_val': 0.527159695064394, 'auprc': 0.7795120284683303, 'loss_val': 0.9938968506252264, 'psi': 0.6281006284259685}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=46 head_norm_before_train=2.207105 (no previous merge yet)
[S8] round=46 local utility u=0.000000 metrics={'f1_val': 0.9919528555747477, 'auprc': 0.9991731914339401, 'loss_val': 0.033974643760519674, 'psi': 0.9948409899184246}-{'f1_val': 0.9938554489473111, 'auprc': 0.9989401783312395, 'loss_val': 0.027763358319617862, 'psi': 0.9958893407008825}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=46 head_norm_before_train=1.703714 cos_to_last_merge=0.9646 (last merge round=24)
[S9] round=46 local utility u=0.012926 metrics={'f1_val': 0.986144618344318, 'auprc': 0.998459600650773, 'loss_val': 0.056543158059566945, 'psi': 0.9910706112668999}-{'f1_val': 0.9827002379539219, 'auprc': 0.998457245010877, 'loss_val': 0.061722220020521246, 'psi': 0.9890030407767039}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=46 head_norm_before_train=1.842287 cos_to_last_merge=0.9597 (last merge round=25)
[S10] round=46 local utility u=0.000000 metrics={'f1_val': 0.9941077514882151, 'auprc': 0.9957936724657772, 'loss_val': 0.029356095456442334, 'psi': 0.9947821198792399}-{'f1_val': 0.9943272539091932, 'auprc': 0.9959593666615953, 'loss_val': 0.029462739824663062, 'psi': 0.994980099010154}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=46 head_norm_before_train=1.625891 cos_to_last_merge=0.9719 (last merge round=31)
[S11] round=46 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9968135492550463, 'loss_val': 0.03585923563194897, 'psi': 0.9966536224101723}-{'f1_val': 0.9965470045135896, 'auprc': 0.9974516795919692, 'loss_val': 0.03739620092585386, 'psi': 0.9969088745449415}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=46 head_norm_before_train=1.553325 cos_to_last_merge=0.9932 (last merge round=31)
[S13] round=46 local utility u=0.000000 metrics={'f1_val': 0.6195323923775378, 'auprc': 0.8133379719798689, 'loss_val': 1.1238620561704518, 'psi': 0.6970546242184702}-{'f1_val': 0.7371535001889661, 'auprc': 0.777717427961837, 'loss_val': 0.969957605967475, 'psi': 0.7533790712981145}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=46 head_norm_before_train=1.705446 cos_to_last_merge=0.9813 (last merge round=30)
[S14] round=46 local utility u=0.006946 metrics={'f1_val': 0.9978938390605482, 'auprc': 0.9990294167841515, 'loss_val': 0.02640665288807976, 'psi': 0.9983480701499895}-{'f1_val': 0.9972135067804855, 'auprc': 0.9970553064922618, 'loss_val': 0.03029455840279904, 'psi': 0.997150226665196}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=46 head_norm_before_train=1.787198 cos_to_last_merge=0.9581 (last merge round=30)
[S15] round=46 local utility u=0.000000 metrics={'f1_val': 0.7113943817809238, 'auprc': 0.9463719116732336, 'loss_val': 0.528813512750775, 'psi': 0.8053853937378478}-{'f1_val': 0.9963324108488076, 'auprc': 0.9927261042882112, 'loss_val': 0.02682230964296822, 'psi': 0.994889888224569}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=46 head_norm_before_train=1.731995 cos_to_last_merge=0.9725 (last merge round=29)
[S16] round=46 local utility u=0.077981 metrics={'f1_val': 0.9476539364624557, 'auprc': 0.9913446281491685, 'loss_val': 0.19679184694743707, 'psi': 0.9651302131371409}-{'f1_val': 0.9401580754154143, 'auprc': 0.9943889900456738, 'loss_val': 0.31691113375060903, 'psi': 0.9618504412675182}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] sending update (kind=head size=1805 to 1 peers)
[S17] START round=46 head_norm_before_train=1.709073 cos_to_last_merge=0.9764 (last merge round=31)
[S17] round=46 local utility u=0.176702 metrics={'f1_val': 0.6553776418938788, 'auprc': 0.958976270433343, 'loss_val': 1.060767337915941, 'psi': 0.7768170933096645}-{'f1_val': 0.6364342792340582, 'auprc': 0.9273969804467397, 'loss_val': 1.2057738207246893, 'psi': 0.7528193597191308}
[S17] not sending this round → trigger blocked (psi=0.777)
[S2] START round=47 head_norm_before_train=1.965911 cos_to_last_merge=0.7685 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.769
[S2] round=47 local utility u=0.060296 metrics={'f1_val': 0.7138871539080959, 'auprc': 0.7988610999070885, 'loss_val': 0.9322376735106431, 'psi': 0.7478767323076929}-{'f1_val': 0.7193721259848863, 'auprc': 0.7565747563168636, 'loss_val': 0.9588799094759239, 'psi': 0.7342531781176772}
[S2] not sending this round → trigger blocked (psi=0.748)
[S3] START round=47 head_norm_before_train=1.624669 cos_to_last_merge=0.9904 (last merge round=30)
[S3] round=47 local utility u=0.989320 metrics={'f1_val': 0.8783558306425419, 'auprc': 0.9992360112974454, 'loss_val': 0.17985517889470806, 'psi': 0.9267079029045033}-{'f1_val': 0.6413744867599651, 'auprc': 0.9443494734881479, 'loss_val': 0.5719480737602401, 'psi': 0.7625644814512382}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] sending update (kind=head size=1804 to 1 peers)
[S4] START round=47 head_norm_before_train=1.697970 cos_to_last_merge=0.9976 (last merge round=31)
[S4] round=47 local utility u=0.000000 metrics={'f1_val': 0.9283890549917977, 'auprc': 0.9511638781039502, 'loss_val': 0.38461469418888256, 'psi': 0.9374989842366587}-{'f1_val': 0.9393787773222496, 'auprc': 0.9523101846042888, 'loss_val': 0.34522626178434285, 'psi': 0.9445513402350653}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=47 head_norm_before_train=1.846585 (no previous merge yet)
[S5] round=47 local utility u=0.000000 metrics={'f1_val': 0.7860161342937102, 'auprc': 0.9909514518931947, 'loss_val': 0.17191612506527454, 'psi': 0.867990261333504}-{'f1_val': 0.9970695586110643, 'auprc': 0.9932337546013872, 'loss_val': 0.06725156132212472, 'psi': 0.9955352370071935}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=47 head_norm_before_train=2.178192 (no previous merge yet)
[S6] round=47 local utility u=0.616025 metrics={'f1_val': 0.7999121666877794, 'auprc': 0.9422354300876521, 'loss_val': 0.5858639451533576, 'psi': 0.8568414720477284}-{'f1_val': 0.6955991261387452, 'auprc': 0.8593096007865277, 'loss_val': 0.9432581415345952, 'psi': 0.7610833159978583}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] sending update (kind=head size=1796 to 1 peers)
[S7] START round=47 head_norm_before_train=1.556904 cos_to_last_merge=0.9972 (last merge round=30)
[S7] round=47 local utility u=0.069383 metrics={'f1_val': 0.6328084908277163, 'auprc': 0.8024445338279709, 'loss_val': 0.5241986495125714, 'psi': 0.7006629080278182}-{'f1_val': 0.6213721160837226, 'auprc': 0.7975482635801869, 'loss_val': 0.5796582435901767, 'psi': 0.6918425750823083}
[S7] not sending this round → trigger blocked (psi=0.701)
[S8] START round=47 head_norm_before_train=2.210454 (no previous merge yet)
[S8] round=47 local utility u=0.009557 metrics={'f1_val': 0.994780125774015, 'auprc': 0.9985812039900918, 'loss_val': 0.03004915736972382, 'psi': 0.9963005570604457}-{'f1_val': 0.9919528555747477, 'auprc': 0.9991731914339401, 'loss_val': 0.033974643760519674, 'psi': 0.9948409899184246}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] sending update (kind=head size=1795 to 1 peers)
[S9] START round=47 head_norm_before_train=1.714234 cos_to_last_merge=0.9637 (last merge round=24)
[S9] round=47 local utility u=0.039701 metrics={'f1_val': 0.9954448862872828, 'auprc': 0.9984649356230528, 'loss_val': 0.03295778011221662, 'psi': 0.9966529060215908}-{'f1_val': 0.986144618344318, 'auprc': 0.998459600650773, 'loss_val': 0.056543158059566945, 'psi': 0.9910706112668999}
[S9] not sending this round → trigger blocked (psi=0.997)
[S10] START round=47 head_norm_before_train=1.852289 cos_to_last_merge=0.9588 (last merge round=25)
[S10] round=47 local utility u=0.000638 metrics={'f1_val': 0.9943272539091932, 'auprc': 0.9956788913130618, 'loss_val': 0.029053338090928364, 'psi': 0.9948679088707406}-{'f1_val': 0.9941077514882151, 'auprc': 0.9957936724657772, 'loss_val': 0.029356095456442334, 'psi': 0.9947821198792399}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=47 head_norm_before_train=1.637128 cos_to_last_merge=0.9708 (last merge round=31)
[S11] round=47 local utility u=0.000000 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9966040865148008, 'loss_val': 0.03568945372822119, 'psi': 0.9964247350872368}-{'f1_val': 0.9965470045135896, 'auprc': 0.9968135492550463, 'loss_val': 0.03585923563194897, 'psi': 0.9966536224101723}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=47 head_norm_before_train=1.560862 cos_to_last_merge=0.9925 (last merge round=31)
[S13] round=47 local utility u=0.346501 metrics={'f1_val': 0.7453424362511449, 'auprc': 0.7028041198065345, 'loss_val': 0.8541194643969698, 'psi': 0.7283271096733007}-{'f1_val': 0.6195323923775378, 'auprc': 0.8133379719798689, 'loss_val': 1.1238620561704518, 'psi': 0.6970546242184702}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=47 head_norm_before_train=1.719772 cos_to_last_merge=0.9803 (last merge round=30)
[S14] round=47 local utility u=0.000000 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9990210148878274, 'loss_val': 0.026298354030585835, 'psi': 0.998199076785043}-{'f1_val': 0.9978938390605482, 'auprc': 0.9990294167841515, 'loss_val': 0.02640665288807976, 'psi': 0.9983480701499895}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=47 head_norm_before_train=1.803560 cos_to_last_merge=0.9564 (last merge round=30)
[S15] round=47 local utility u=1.000000 metrics={'f1_val': 0.9959021853469847, 'auprc': 0.9928661246719052, 'loss_val': 0.03027840134438131, 'psi': 0.9946877610769529}-{'f1_val': 0.7113943817809238, 'auprc': 0.9463719116732336, 'loss_val': 0.528813512750775, 'psi': 0.8053853937378478}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=47 head_norm_before_train=1.742857 cos_to_last_merge=0.9717 (last merge round=29)
[S16] round=47 local utility u=0.223548 metrics={'f1_val': 0.9925325084246663, 'auprc': 0.9968062499358252, 'loss_val': 0.03535200455168759, 'psi': 0.9942420050291298}-{'f1_val': 0.9476539364624557, 'auprc': 0.9913446281491685, 'loss_val': 0.19679184694743707, 'psi': 0.9651302131371409}
[S16] not sending this round → trigger blocked (psi=0.994)
[S17] START round=47 head_norm_before_train=1.721937 cos_to_last_merge=0.9753 (last merge round=31)
[S17] round=47 local utility u=0.000000 metrics={'f1_val': 0.6445645310480755, 'auprc': 0.9433813696173597, 'loss_val': 1.2400275319797027, 'psi': 0.7640912664757893}-{'f1_val': 0.6553776418938788, 'auprc': 0.958976270433343, 'loss_val': 1.060767337915941, 'psi': 0.7768170933096645}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=48 head_norm_before_train=1.974065 cos_to_last_merge=0.7675 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.768
[S2] round=48 local utility u=0.000000 metrics={'f1_val': 0.6805793537445897, 'auprc': 0.7793908849623488, 'loss_val': 0.9285062274780732, 'psi': 0.7201039662316933}-{'f1_val': 0.7138871539080959, 'auprc': 0.7988610999070885, 'loss_val': 0.9322376735106431, 'psi': 0.7478767323076929}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=48 head_norm_before_train=1.635757 cos_to_last_merge=0.9897 (last merge round=30)
[S3] round=48 local utility u=0.000000 metrics={'f1_val': 0.7222172466432003, 'auprc': 0.947703167695602, 'loss_val': 0.4402451897620023, 'psi': 0.812411615064161}-{'f1_val': 0.8783558306425419, 'auprc': 0.9992360112974454, 'loss_val': 0.17985517889470806, 'psi': 0.9267079029045033}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=48 head_norm_before_train=1.706742 cos_to_last_merge=0.9974 (last merge round=31)
[S4] round=48 local utility u=0.014882 metrics={'f1_val': 0.934257390334607, 'auprc': 0.9472480431566708, 'loss_val': 0.3783125700151666, 'psi': 0.9394536514634324}-{'f1_val': 0.9283890549917977, 'auprc': 0.9511638781039502, 'loss_val': 0.38461469418888256, 'psi': 0.9374989842366587}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=48 head_norm_before_train=1.852729 (no previous merge yet)
[S5] round=48 local utility u=0.693548 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9951983039023391, 'loss_val': 0.06388150515759165, 'psi': 0.9963210567275742}-{'f1_val': 0.7860161342937102, 'auprc': 0.9909514518931947, 'loss_val': 0.17191612506527454, 'psi': 0.867990261333504}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] START round=48 head_norm_before_train=2.191639 (no previous merge yet)
[S6] round=48 local utility u=0.256721 metrics={'f1_val': 0.846527902001456, 'auprc': 0.9526456746545398, 'loss_val': 0.3833462298227808, 'psi': 0.8889750110626895}-{'f1_val': 0.7999121666877794, 'auprc': 0.9422354300876521, 'loss_val': 0.5858639451533576, 'psi': 0.8568414720477284}
[S6] not sending this round → trigger blocked (psi=0.889)
[S7] START round=48 head_norm_before_train=1.564215 cos_to_last_merge=0.9968 (last merge round=30)
[S7] round=48 local utility u=0.248677 metrics={'f1_val': 0.6720442262383612, 'auprc': 0.831505402744192, 'loss_val': 0.3494412367077235, 'psi': 0.7358286968406935}-{'f1_val': 0.6328084908277163, 'auprc': 0.8024445338279709, 'loss_val': 0.5241986495125714, 'psi': 0.7006629080278182}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=48 head_norm_before_train=2.220005 (no previous merge yet)
[S8] round=48 local utility u=0.000000 metrics={'f1_val': 0.9500954591886704, 'auprc': 0.9990115539339175, 'loss_val': 0.157398197809525, 'psi': 0.9696618970867693}-{'f1_val': 0.994780125774015, 'auprc': 0.9985812039900918, 'loss_val': 0.03004915736972382, 'psi': 0.9963005570604457}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=48 head_norm_before_train=1.724505 cos_to_last_merge=0.9628 (last merge round=24)
[S9] round=48 local utility u=0.004645 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.998465669766144, 'loss_val': 0.03115525370259184, 'psi': 0.9974017626653149}-{'f1_val': 0.9954448862872828, 'auprc': 0.9984649356230528, 'loss_val': 0.03295778011221662, 'psi': 0.9966529060215908}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S9] sending update (kind=head size=1805 to 1 peers)
[S10] START round=48 head_norm_before_train=1.860770 cos_to_last_merge=0.9580 (last merge round=25)
[S10] round=48 local utility u=0.000000 metrics={'f1_val': 0.9943272539091932, 'auprc': 0.9956406239556681, 'loss_val': 0.028948331771840596, 'psi': 0.9948526019277831}-{'f1_val': 0.9943272539091932, 'auprc': 0.9956788913130618, 'loss_val': 0.029053338090928364, 'psi': 0.9948679088707406}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=48 head_norm_before_train=1.648259 cos_to_last_merge=0.9697 (last merge round=31)
[S11] round=48 local utility u=0.002937 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9974327481251669, 'loss_val': 0.033752983813428526, 'psi': 0.9969013019582205}-{'f1_val': 0.996305167468861, 'auprc': 0.9966040865148008, 'loss_val': 0.03568945372822119, 'psi': 0.9964247350872368}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=48 head_norm_before_train=1.567021 cos_to_last_merge=0.9922 (last merge round=31)
[S13] round=48 local utility u=0.146886 metrics={'f1_val': 0.7466129887884541, 'auprc': 0.8332090573556549, 'loss_val': 0.9591863897014264, 'psi': 0.7812514162153343}-{'f1_val': 0.7453424362511449, 'auprc': 0.7028041198065345, 'loss_val': 0.8541194643969698, 'psi': 0.7283271096733007}
[S13] not sending this round → trigger blocked (psi=0.781)
[S14] START round=48 head_norm_before_train=1.732574 cos_to_last_merge=0.9794 (last merge round=30)
[S14] round=48 local utility u=0.000000 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9990400757731729, 'loss_val': 0.02774789612502542, 'psi': 0.9980609920103045}-{'f1_val': 0.9976511180498535, 'auprc': 0.9990210148878274, 'loss_val': 0.026298354030585835, 'psi': 0.998199076785043}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=48 head_norm_before_train=1.816702 cos_to_last_merge=0.9548 (last merge round=30)
[S15] round=48 local utility u=0.000000 metrics={'f1_val': 0.8273164294116657, 'auprc': 0.9909088167411872, 'loss_val': 0.3351648983663, 'psi': 0.8927533843434743}-{'f1_val': 0.9959021853469847, 'auprc': 0.9928661246719052, 'loss_val': 0.03027840134438131, 'psi': 0.9946877610769529}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=48 head_norm_before_train=1.752481 cos_to_last_merge=0.9710 (last merge round=29)
[S16] round=48 local utility u=0.000000 metrics={'f1_val': 0.9894297831235987, 'auprc': 0.9964277932408491, 'loss_val': 0.0528782501032567, 'psi': 0.9922289871704989}-{'f1_val': 0.9925325084246663, 'auprc': 0.9968062499358252, 'loss_val': 0.03535200455168759, 'psi': 0.9942420050291298}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=48 head_norm_before_train=1.735335 cos_to_last_merge=0.9738 (last merge round=31)
[S17] round=48 local utility u=0.643627 metrics={'f1_val': 0.7574807343207581, 'auprc': 0.9833545581266547, 'loss_val': 0.750191198908328, 'psi': 0.8478302638431168}-{'f1_val': 0.6445645310480755, 'auprc': 0.9433813696173597, 'loss_val': 1.2400275319797027, 'psi': 0.7640912664757893}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=49 head_norm_before_train=1.979790 cos_to_last_merge=0.7668 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.767
[S2] round=49 local utility u=0.120572 metrics={'f1_val': 0.7131006435823944, 'auprc': 0.7861393572573453, 'loss_val': 0.9027361941519896, 'psi': 0.7423161290523748}-{'f1_val': 0.6805793537445897, 'auprc': 0.7793908849623488, 'loss_val': 0.9285062274780732, 'psi': 0.7201039662316933}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=49 head_norm_before_train=1.646270 cos_to_last_merge=0.9890 (last merge round=30)
[S3] round=49 local utility u=0.532209 metrics={'f1_val': 0.8429261878295207, 'auprc': 0.9958451069457979, 'loss_val': 0.2445058918351327, 'psi': 0.9040937554760315}-{'f1_val': 0.7222172466432003, 'auprc': 0.947703167695602, 'loss_val': 0.4402451897620023, 'psi': 0.812411615064161}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=49 head_norm_before_train=1.707517 cos_to_last_merge=0.9972 (last merge round=31)
[S4] round=49 local utility u=0.048104 metrics={'f1_val': 0.9412290389166791, 'auprc': 0.9509774273252622, 'loss_val': 0.33512330528589634, 'psi': 0.9451283942801123}-{'f1_val': 0.934257390334607, 'auprc': 0.9472480431566708, 'loss_val': 0.3783125700151666, 'psi': 0.9394536514634324}
[S4] not sending this round → trigger blocked (psi=0.945)
[S5] START round=49 head_norm_before_train=1.857511 (no previous merge yet)
[S5] round=49 local utility u=0.000000 metrics={'f1_val': 0.6112169045211621, 'auprc': 0.7891700190088463, 'loss_val': 0.9695049572497026, 'psi': 0.6823981503162357}-{'f1_val': 0.9970695586110643, 'auprc': 0.9951983039023391, 'loss_val': 0.06388150515759165, 'psi': 0.9963210567275742}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=49 head_norm_before_train=2.203449 (no previous merge yet)
[S6] round=49 local utility u=0.000000 metrics={'f1_val': 0.6962902300969378, 'auprc': 0.8666198991319443, 'loss_val': 0.9576839448475998, 'psi': 0.7644220977109404}-{'f1_val': 0.846527902001456, 'auprc': 0.9526456746545398, 'loss_val': 0.3833462298227808, 'psi': 0.8889750110626895}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=49 head_norm_before_train=1.572120 cos_to_last_merge=0.9963 (last merge round=30)
[S7] round=49 local utility u=0.000000 metrics={'f1_val': 0.45107326853213253, 'auprc': 0.7807456575189762, 'loss_val': 1.1526579894754405, 'psi': 0.58294222412687}-{'f1_val': 0.6720442262383612, 'auprc': 0.831505402744192, 'loss_val': 0.3494412367077235, 'psi': 0.7358286968406935}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=49 head_norm_before_train=2.224280 (no previous merge yet)
[S8] round=49 local utility u=0.190446 metrics={'f1_val': 0.9929024225986427, 'auprc': 0.9993349926384083, 'loss_val': 0.034319022015857945, 'psi': 0.9954754506145489}-{'f1_val': 0.9500954591886704, 'auprc': 0.9990115539339175, 'loss_val': 0.157398197809525, 'psi': 0.9696618970867693}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] START round=49 head_norm_before_train=1.735212 cos_to_last_merge=0.9618 (last merge round=24)
[S9] round=49 local utility u=0.002047 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9984674984577383, 'loss_val': 0.029529763383369278, 'psi': 0.997648746890381}-{'f1_val': 0.9966924912647621, 'auprc': 0.998465669766144, 'loss_val': 0.03115525370259184, 'psi': 0.9974017626653149}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=49 head_norm_before_train=1.869557 cos_to_last_merge=0.9571 (last merge round=25)
[S10] round=49 local utility u=0.000000 metrics={'f1_val': 0.993888323675122, 'auprc': 0.9958213987618587, 'loss_val': 0.0291972655087448, 'psi': 0.9946615537098167}-{'f1_val': 0.9943272539091932, 'auprc': 0.9956406239556681, 'loss_val': 0.028948331771840596, 'psi': 0.9948526019277831}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=49 head_norm_before_train=1.658538 cos_to_last_merge=0.9686 (last merge round=31)
[S11] round=49 local utility u=0.000000 metrics={'f1_val': 0.9946232161565767, 'auprc': 0.9979612561493796, 'loss_val': 0.036017990597718284, 'psi': 0.9959584321536978}-{'f1_val': 0.9965470045135896, 'auprc': 0.9974327481251669, 'loss_val': 0.033752983813428526, 'psi': 0.9969013019582205}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=49 head_norm_before_train=1.576954 cos_to_last_merge=0.9915 (last merge round=31)
[S13] round=49 local utility u=0.000000 metrics={'f1_val': 0.6578250030624927, 'auprc': 0.6788982910320792, 'loss_val': 1.0264505034414655, 'psi': 0.6662543182503273}-{'f1_val': 0.7466129887884541, 'auprc': 0.8332090573556549, 'loss_val': 0.9591863897014264, 'psi': 0.7812514162153343}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=49 head_norm_before_train=1.741145 cos_to_last_merge=0.9786 (last merge round=30)
[S14] round=49 local utility u=0.000000 metrics={'f1_val': 0.9385956111065863, 'auprc': 0.9986599983313957, 'loss_val': 0.10729703311711734, 'psi': 0.9626213659965102}-{'f1_val': 0.9974082695017256, 'auprc': 0.9990400757731729, 'loss_val': 0.02774789612502542, 'psi': 0.9980609920103045}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=49 head_norm_before_train=1.832156 cos_to_last_merge=0.9532 (last merge round=30)
[S15] round=49 local utility u=0.333221 metrics={'f1_val': 0.9071594805417076, 'auprc': 0.9890914440975631, 'loss_val': 0.14232882142300124, 'psi': 0.9399322659640498}-{'f1_val': 0.8273164294116657, 'auprc': 0.9909088167411872, 'loss_val': 0.3351648983663, 'psi': 0.8927533843434743}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] sending update (kind=head size=1804 to 1 peers)
[S16] START round=49 head_norm_before_train=1.763050 cos_to_last_merge=0.9702 (last merge round=29)
[S16] round=49 local utility u=0.000000 metrics={'f1_val': 0.8566809042595678, 'auprc': 0.9940652552221041, 'loss_val': 0.8692945490803109, 'psi': 0.9116346446445823}-{'f1_val': 0.9894297831235987, 'auprc': 0.9964277932408491, 'loss_val': 0.0528782501032567, 'psi': 0.9922289871704989}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=49 head_norm_before_train=1.752644 cos_to_last_merge=0.9725 (last merge round=31)
[S17] round=49 local utility u=0.000000 metrics={'f1_val': 0.6361683365938561, 'auprc': 0.8158874823463914, 'loss_val': 1.3818809152229938, 'psi': 0.7080559948948701}-{'f1_val': 0.7574807343207581, 'auprc': 0.9833545581266547, 'loss_val': 0.750191198908328, 'psi': 0.8478302638431168}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[runner] rounds complete.
[runner] all agents stopped.
