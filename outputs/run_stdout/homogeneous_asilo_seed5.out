[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:31603
[S3] → join 127.0.0.1:31602
[S4] → join 127.0.0.1:31602
[S5] → join 127.0.0.1:31602
[S6] → join 127.0.0.1:31602
[S7] → join 127.0.0.1:31602
[S8] → join 127.0.0.1:31602
[S9] → join 127.0.0.1:31602
[S10] → join 127.0.0.1:31602
[S11] → join 127.0.0.1:31602
[S13] → join 127.0.0.1:31602
[S14] → join 127.0.0.1:31602
[S15] → join 127.0.0.1:31602
[S16] → join 127.0.0.1:31602
[S17] → join 127.0.0.1:31602
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.152963 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.239771 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.172880 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.150972 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.188414 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.193561 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.213259 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.111268 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.101415 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.122470 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.098955 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.128822 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.167138 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.065539 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.131557 (no previous merge yet)
[S2]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S3] + discovered S16
[S3] + discovered S14
[S3] + discovered S5
[S3] + discovered S13
[S3] + discovered S9
[S4] + discovered S3
[S3] + discovered S11
[S3] + discovered S4
[S3] + discovered S7
[S3] + discovered S8
[S3] + discovered S17
[S4] + discovered S2
[S3] + discovered S6
[S3] + discovered S15
[S3] + discovered S10
[S4] + discovered S17
[S4] + discovered S14
[S4] + discovered S13
[S4] + discovered S10
[S4] + discovered S7
[S4] + discovered S8
[S5] + discovered S4
[S5] + discovered S2
[S4] + discovered S15
[S4] + discovered S11
[S4] + discovered S16
[S4] + discovered S9
[S4] + discovered S6
[S4] + discovered S5
[S5] + discovered S3
[S6] + discovered S4
[S6] + discovered S3
[S5] + discovered S8
[S5] + discovered S17
[S5] + discovered S14
[S5] + discovered S6
[S5] + discovered S11
[S5] + discovered S7
[S5] + discovered S16
[S5] + discovered S10
[S6] + discovered S5
[S6] + discovered S2
[S5] + discovered S13
[S5] + discovered S15
[S5] + discovered S9
[S7] + discovered S5
[S7] + discovered S6
[S6] + discovered S16
[S7] + discovered S2
[S6] + discovered S17
[S6] + discovered S11
[S6] + discovered S10
[S6] + discovered S7
[S7] + discovered S4
[S6] + discovered S9
[S6] + discovered S14
[S6] + discovered S15
[S6] + discovered S8
[S6] + discovered S13
[S7] + discovered S3
[S7] + discovered S10
[S8] + discovered S4
[S8] + discovered S3
[S7] + discovered S13
[S7] + discovered S14
[S7] + discovered S17
[S7] + discovered S15
[S7] + discovered S16
[S7] + discovered S8
[S7] + discovered S11
[S7] + discovered S9
[S8] + discovered S6
[S8] + discovered S5
[S8] + discovered S2
[S8] + discovered S7
[S8] + discovered S16
[S9] + discovered S2
[S9] + discovered S8
[S8] + discovered S15
[S8] + discovered S10
[S9] + discovered S5
[S8] + discovered S14
[S8] + discovered S17
[S9] + discovered S6
[S9] + discovered S3
[S8] + discovered S11
[S9] + discovered S7
[S8] + discovered S9
[S8] + discovered S13
[S9] + discovered S4
[S10] + discovered S2
[S10] + discovered S9
[S9] + discovered S16
[S10] + discovered S7
[S9] + discovered S11
[S9] + discovered S13
[S10] + discovered S8
[S9] + discovered S14
[S9] + discovered S10
[S10] + discovered S3
[S10] + discovered S5
[S9] + discovered S17
[S9] + discovered S15
[S10] + discovered S6
[S10] + discovered S4
[S11] + discovered S9
[S11] + discovered S8
[S11] + discovered S3
[S11] + discovered S6
[S11] + discovered S10
[S11] + discovered S2
[S10] + discovered S16
[S10] + discovered S11
[S10] + discovered S14
[S11] + discovered S5
[S10] + discovered S13
[S11] + discovered S7
[S10] + discovered S15
[S10] + discovered S17
[S11] + discovered S4
[S13] + discovered S4
[S11] + discovered S13
[S13] + discovered S10
[S11] + discovered S17
[S13] + discovered S7
[S13] + discovered S11
[S13] + discovered S6
[S13] + discovered S3
[S11] + discovered S16
[S11] + discovered S15
[S11] + discovered S14
[S13] + discovered S9
[S13] + discovered S5
[S13] + discovered S8
[S13] + discovered S2
[S14] + discovered S6
[S14] + discovered S13
[S14] + discovered S4
[S13] + discovered S15
[S14] + discovered S3
[S13] + discovered S16
[S13] + discovered S14
[S14] + discovered S11
[S13] + discovered S17
[S14] + discovered S2
[S14] + discovered S10
[S14] + discovered S7
[S14] + discovered S5
[S14] + discovered S8
[S14] + discovered S9
[S15] + discovered S6
[S15] + discovered S14
[S15] + discovered S7
[S14] + discovered S17
[S14] + discovered S15
[S14] + discovered S16
[S15] + discovered S3
[S15] + discovered S13
[S15] + discovered S9
[S15] + discovered S11
[S15] + discovered S4
[S15] + discovered S5
[S15] + discovered S2
[S15] + discovered S8
[S15] + discovered S10
[S16] + discovered S9
[S16] + discovered S6
[S16] + discovered S8
[S16] + discovered S4
[S16] + discovered S11
[S16] + discovered S3
[S16] + discovered S10
[S15] + discovered S16
[S16] + discovered S5
[S16] + discovered S13
[S16] + discovered S7
[S16] + discovered S14
[S16] + discovered S2
[S16] + discovered S15
[S15] + discovered S17
[S17] + discovered S5
[S17] + discovered S3
[S17] + discovered S11
[S17] + discovered S6
[S17] + discovered S15
[S17] + discovered S4
[S17] + discovered S2
[S17] + discovered S9
[S17] + discovered S10
[S17] + discovered S13
[S17] + discovered S8
[S16] + discovered S17
[S17] + discovered S14
[S17] + discovered S7
[S17] + discovered S16
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] ⇄ pheromone p=1.000 → S13@127.0.0.1:31613
[S3] ⇄ pheromone p=1.000 → S8@127.0.0.1:31609
[S16] ⇄ pheromone p=1.000 → S2@127.0.0.1:31602
[S13] ⇄ pheromone p=1.000 → S5@127.0.0.1:31605
[S2] ⇄ pheromone p=1.000 → S11@127.0.0.1:31612
[S15] ⇄ pheromone p=1.000 → S10@127.0.0.1:31611
[S7] ⇄ pheromone p=1.000 → S17@127.0.0.1:31617
[S6] ⇄ pheromone p=1.000 → S4@127.0.0.1:31604
[S14] ⇄ pheromone p=1.000 → S5@127.0.0.1:31605
[S10] ⇄ pheromone p=1.000 → S16@127.0.0.1:31616
[S4] ⇄ pheromone p=1.000 → S5@127.0.0.1:31605
[S9] ⇄ pheromone p=1.000 → S4@127.0.0.1:31604
[S5] ⇄ pheromone p=1.000 → S14@127.0.0.1:31614
[S8] ⇄ pheromone p=1.000 → S17@127.0.0.1:31617
[S17] ⇄ pheromone p=1.000 → S5@127.0.0.1:31605
[S2] START round=1 head_norm_before_train=1.155986 (no previous merge yet)
[S2] round=1 local utility u=0.494230 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7850218808170075, 'loss_val': 1.3118498064350392, 'psi': 0.39907503235994307}-{'f1_val': 0.1417771333885667, 'auprc': 0.4693237586312085, 'loss_val': 1.3532161821606568, 'psi': 0.27279578348562344}
[S3] START round=1 head_norm_before_train=1.247623 (no previous merge yet)
[S3] round=1 local utility u=0.245641 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9831938823503951, 'loss_val': 1.3123791317764433, 'psi': 0.4771815923086222}-{'f1_val': 0.13984006561410703, 'auprc': 0.8295098783086705, 'loss_val': 1.3426087696375442, 'psi': 0.4157079906919324}
[S4] START round=1 head_norm_before_train=1.172643 (no previous merge yet)
[S4] round=1 local utility u=0.000000 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7531119627313856, 'loss_val': 1.329005225357039, 'psi': 0.38538076242966474}-{'f1_val': 0.37429595709480423, 'auprc': 0.6421735377521266, 'loss_val': 1.3619001793199588, 'psi': 0.4814469893577332}
[S5] START round=1 head_norm_before_train=1.157171 (no previous merge yet)
[S5] round=1 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7235961308563292, 'loss_val': 1.3299459421854551, 'psi': 0.37479559519967454}-{'f1_val': 0.2855736301369863, 'auprc': 0.7207151382837846, 'loss_val': 1.3631748329715387, 'psi': 0.45963023339570563}
[S6] START round=1 head_norm_before_train=1.203975 (no previous merge yet)
[S6] round=1 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6470322821672424, 'loss_val': 1.3092834329225185, 'psi': 0.34366868209766616}-{'f1_val': 0.26163783158285703, 'auprc': 0.6464947969379158, 'loss_val': 1.3434042135046942, 'psi': 0.41558061772488053}
[S7] START round=1 head_norm_before_train=1.203555 (no previous merge yet)
[S7] round=1 local utility u=0.218505 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7777721378671211, 'loss_val': 1.3075158428059976, 'psi': 0.39634294878430343}-{'f1_val': 0.14205682272909165, 'auprc': 0.6445313946800584, 'loss_val': 1.3448029393001835, 'psi': 0.34304665150947833}
[S8] START round=1 head_norm_before_train=1.223825 (no previous merge yet)
[S8] round=1 local utility u=0.019820 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7826936947714447, 'loss_val': 1.2911750473353967, 'psi': 0.3970510673443522}-{'f1_val': 0.13995598239295717, 'auprc': 0.7807805072516458, 'loss_val': 1.32507568083533, 'psi': 0.3962857923364327}
[S9] START round=1 head_norm_before_train=1.112560 (no previous merge yet)
[S9] round=1 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9966642205058641, 'loss_val': 1.3021737150896553, 'psi': 0.48350446248634327}-{'f1_val': 0.3932585739344648, 'auprc': 0.9289008832771474, 'loss_val': 1.3446457594131498, 'psi': 0.6075154976715378}
[S10] START round=1 head_norm_before_train=1.115693 (no previous merge yet)
[S10] round=1 local utility u=0.081127 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.8705228425080211, 'loss_val': 1.3048707681579796, 'psi': 0.43138211952824285}-{'f1_val': 0.13862163754172394, 'auprc': 0.8267006785149651, 'loss_val': 1.335658939184695, 'psi': 0.4138532539310204}
[S11] START round=1 head_norm_before_train=1.122952 (no previous merge yet)
[S11] round=1 local utility u=0.000653 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.8131871927919775, 'loss_val': 1.3293915478785705, 'psi': 0.4095230871406574}-{'f1_val': 0.14041368337311058, 'auprc': 0.8237849279650349, 'loss_val': 1.362490904192645, 'psi': 0.41376218120988034}
[S13] START round=1 head_norm_before_train=1.099590 (no previous merge yet)
[S13] round=1 local utility u=0.000000 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.6839642649931158, 'loss_val': 1.3185819886595727, 'psi': 0.3578171635434782}-{'f1_val': 0.1403857625770531, 'auprc': 0.7047537438357174, 'loss_val': 1.349001794502356, 'psi': 0.36613295508051885}
[S14] START round=1 head_norm_before_train=1.131345 (no previous merge yet)
[S14] round=1 local utility u=0.216811 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8639850741567089, 'loss_val': 1.3329260501144158, 'psi': 0.42980874139230585}-{'f1_val': 0.14035785288270378, 'auprc': 0.7282678632868976, 'loss_val': 1.3593962576172074, 'psi': 0.3755218570443813}
[S15] START round=1 head_norm_before_train=1.167771 (no previous merge yet)
[S15] round=1 local utility u=1.000000 metrics={'f1_val': 0.4162330869320884, 'auprc': 0.74092170820625, 'loss_val': 1.3430668201603744, 'psi': 0.5461085354417531}-{'f1_val': 0.09269662921348315, 'auprc': 0.5706953307318394, 'loss_val': 1.3790454895643258, 'psi': 0.2838961098208257}
[S16] START round=1 head_norm_before_train=1.073752 (no previous merge yet)
[S16] round=1 local utility u=0.000000 metrics={'f1_val': 0.19595269013047314, 'auprc': 0.7187397934076766, 'loss_val': 1.32334196298555, 'psi': 0.4050675314413545}-{'f1_val': 0.31030465949820785, 'auprc': 0.7053444857558782, 'loss_val': 1.3589276545211193, 'psi': 0.46832059000127596}
[S17] START round=1 head_norm_before_train=1.131860 (no previous merge yet)
[S17] round=1 local utility u=0.329120 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5505547543280598, 'loss_val': 1.3518590050356392, 'psi': 0.30479127972165454}-{'f1_val': 0.05508893280632411, 'auprc': 0.5136163665868669, 'loss_val': 1.3841245782077995, 'psi': 0.23849990631854126}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:31604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1784 reason=None
[S14] → sending delta(kind=head bytes=1784) to S5@127.0.0.1:31605
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:31616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:31615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1785 reason=None
[S10] → sending delta(kind=head bytes=1785) to S2@127.0.0.1:31602
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S7] → sending delta(kind=head bytes=1791) to S10@127.0.0.1:31611
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S3] → sending delta(kind=head bytes=1792) to S8@127.0.0.1:31609
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1783 reason=None
[S11] → sending delta(kind=head bytes=1783) to S15@127.0.0.1:31615
[S15] sending update (kind=head size=1795 to 1 peers)
[S11] sending update (kind=head size=1783 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S3] sending update (kind=head size=1792 to 1 peers)
[S14] sending update (kind=head size=1784 to 1 peers)
[S2] sending update (kind=head size=1793 to 1 peers)
[S10] sending update (kind=head size=1785 to 1 peers)
[S7] sending update (kind=head size=1791 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1791) from S7
[S10] cosine check vs S7: cos=-0.0685
[S10] DROPPED delta from S7 (cos=-0.0685 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1793) from S2
[S16] cosine check vs S2: cos=0.0517
[S15] RECEIVED delta(kind=head bytes=1783) from S11
[S15] cosine check vs S11: cos=-0.0323
[S15] DROPPED delta from S11 (cos=-0.0323 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1784) from S14
[S5] cosine check vs S14: cos=0.0512
[S8] RECEIVED delta(kind=head bytes=1792) from S3
[S8] cosine check vs S3: cos=-0.0700
[S8] DROPPED delta from S3 (cos=-0.0700 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1796) from S8
[S15] cosine check vs S8: cos=0.0732
[S4] RECEIVED delta(kind=head bytes=1795) from S15
[S4] cosine check vs S15: cos=-0.1125
[S4] DROPPED delta from S15 (cos=-0.1125 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1785) from S10
[S2] cosine check vs S10: cos=0.0187
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] → sending delta(kind=head bytes=1793) to S13@127.0.0.1:31613
[S17] sending update (kind=head size=1793 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1793) from S17
[S13] cosine check vs S17: cos=-0.0085
[S13] DROPPED delta from S17 (cos=-0.0085 < 0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=1 metric=0.1423 head_norm=1.170633
[S5] _apply_head_vector_avg (torch): Δ‖w‖=7.972391e-01
[S5] stored merged vector for next round verification (round=1)
[S5] DEBUG after merge:  round=1 metric=0.1423 head_norm=0.839155 delta_norm=0.797239
[S5] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=1 metric=0.4162 head_norm=1.181417
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.251116e-01
[S15] stored merged vector for next round verification (round=1)
[S15] DEBUG after merge:  round=1 metric=0.4158 head_norm=0.887845 delta_norm=0.825112
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=1 metric=0.1418 head_norm=1.169316
[S2] _apply_head_vector_avg (torch): Δ‖w‖=8.091069e-01
[S2] stored merged vector for next round verification (round=1)
[S2] DEBUG after merge:  round=1 metric=0.1418 head_norm=0.824365 delta_norm=0.809107
[S2] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=1 metric=0.1960 head_norm=1.094042
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.797257e-01
[S16] stored merged vector for next round verification (round=1)
[S16] DEBUG after merge:  round=1 metric=0.1406 head_norm=0.821061 delta_norm=0.779726
[S16] aggregate: ROLLBACK (f1_val pre=0.196 post=0.141 tol_abs=0.005 tol_rel=0.0)
[S2] START round=2 head_norm_before_train=0.824365 cos_to_last_merge=1.0000 (last merge round=1)
[S2] round=2 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7787262342060062, 'loss_val': 1.3001883931806124, 'psi': 0.39655677371554254}-{'f1_val': 0.1417771333885667, 'auprc': 0.7850218808170075, 'loss_val': 1.3118498064350392, 'psi': 0.39907503235994307}
[S3] START round=2 head_norm_before_train=1.262469 (no previous merge yet)
[S3] round=2 local utility u=0.044455 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9987241717619713, 'loss_val': 1.2700595801630794, 'psi': 0.48339370807325277}-{'f1_val': 0.13984006561410703, 'auprc': 0.9831938823503951, 'loss_val': 1.3123791317764433, 'psi': 0.4771815923086222}
[S4] START round=2 head_norm_before_train=1.181342 (no previous merge yet)
[S4] round=2 local utility u=0.020891 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7545919472275816, 'loss_val': 1.291662457507966, 'psi': 0.38597275622814314}-{'f1_val': 0.14022662889518414, 'auprc': 0.7531119627313856, 'loss_val': 1.329005225357039, 'psi': 0.38538076242966474}
[S5] START round=2 head_norm_before_train=0.839155 cos_to_last_merge=1.0000 (last merge round=1)
[S5] round=2 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.566694836638165, 'loss_val': 1.3233448185590109, 'psi': 0.3120350775124089}-{'f1_val': 0.14226190476190476, 'auprc': 0.7235961308563292, 'loss_val': 1.3299459421854551, 'psi': 0.37479559519967454}
[S6] START round=2 head_norm_before_train=1.227804 (no previous merge yet)
[S6] round=2 local utility u=0.339239 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8602775766920059, 'loss_val': 1.2705410293058115, 'psi': 0.4289667999075716}-{'f1_val': 0.14142628205128205, 'auprc': 0.6470322821672424, 'loss_val': 1.3092834329225185, 'psi': 0.34366868209766616}
[S7] START round=2 head_norm_before_train=1.223630 (no previous merge yet)
[S7] round=2 local utility u=0.015770 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7775952477517776, 'loss_val': 1.2754448051163323, 'psi': 0.39627219273816605}-{'f1_val': 0.14205682272909165, 'auprc': 0.7777721378671211, 'loss_val': 1.3075158428059976, 'psi': 0.39634294878430343}
[S8] START round=2 head_norm_before_train=1.241938 (no previous merge yet)
[S8] round=2 local utility u=0.003569 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7709832352048149, 'loss_val': 1.2489057965586696, 'psi': 0.3923668835177003}-{'f1_val': 0.13995598239295717, 'auprc': 0.7826936947714447, 'loss_val': 1.2911750473353967, 'psi': 0.3970510673443522}
[S9] START round=2 head_norm_before_train=1.125828 (no previous merge yet)
[S9] round=2 local utility u=0.013270 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9902934231289163, 'loss_val': 1.2565211261606135, 'psi': 0.48095614353556415}-{'f1_val': 0.141397957139996, 'auprc': 0.9966642205058641, 'loss_val': 1.3021737150896553, 'psi': 0.48350446248634327}
[S10] START round=2 head_norm_before_train=1.140685 (no previous merge yet)
[S10] round=2 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.8215468385406215, 'loss_val': 1.2635822573900986, 'psi': 0.411791717941283}-{'f1_val': 0.13862163754172394, 'auprc': 0.8705228425080211, 'loss_val': 1.3048707681579796, 'psi': 0.43138211952824285}
[S11] START round=2 head_norm_before_train=1.133717 (no previous merge yet)
[S11] round=2 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7926961445150651, 'loss_val': 1.2878491840116792, 'psi': 0.4013266678298924}-{'f1_val': 0.14041368337311058, 'auprc': 0.8131871927919775, 'loss_val': 1.3293915478785705, 'psi': 0.4095230871406574}
[S13] START round=2 head_norm_before_train=1.109740 (no previous merge yet)
[S13] round=2 local utility u=0.048107 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7053843582775872, 'loss_val': 1.2866292366476695, 'psi': 0.3663852008572667}-{'f1_val': 0.1403857625770531, 'auprc': 0.6839642649931158, 'loss_val': 1.3185819886595727, 'psi': 0.3578171635434782}
[S14] START round=2 head_norm_before_train=1.144186 (no previous merge yet)
[S14] round=2 local utility u=0.000978 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8543320236892994, 'loss_val': 1.302010290891374, 'psi': 0.425947521205342}-{'f1_val': 0.14035785288270378, 'auprc': 0.8639850741567089, 'loss_val': 1.3329260501144158, 'psi': 0.42980874139230585}
[S15] START round=2 head_norm_before_train=0.887845 cos_to_last_merge=1.0000 (last merge round=1)
[S15] round=2 local utility u=0.000000 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7632368887100827, 'loss_val': 1.329964688333476, 'psi': 0.38913494630096807}-{'f1_val': 0.4162330869320884, 'auprc': 0.74092170820625, 'loss_val': 1.3430668201603744, 'psi': 0.5461085354417531}
[S16] START round=2 head_norm_before_train=0.821061 cos_to_last_merge=1.0000 (last merge round=1)
[S16] round=2 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7575871162788055, 'loss_val': 1.3082386437093796, 'psi': 0.3874173166310442}-{'f1_val': 0.19595269013047314, 'auprc': 0.7187397934076766, 'loss_val': 1.32334196298555, 'psi': 0.4050675314413545}
[S17] START round=2 head_norm_before_train=1.144438 (no previous merge yet)
[S17] round=2 local utility u=0.022295 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5535226536878078, 'loss_val': 1.3161728958797567, 'psi': 0.3059784394655538}-{'f1_val': 0.14094896331738438, 'auprc': 0.5505547543280598, 'loss_val': 1.3518590050356392, 'psi': 0.30479127972165454}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] → sending delta(kind=head bytes=1793) to S3@127.0.0.1:31603
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:31609
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S13] → sending delta(kind=head bytes=1793) to S3@127.0.0.1:31603
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] → sending delta(kind=head bytes=1793) to S15@127.0.0.1:31615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1785 reason=None
[S14] → sending delta(kind=head bytes=1785) to S7@127.0.0.1:31608
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S3] → sending delta(kind=head bytes=1791) to S6@127.0.0.1:31607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:31617
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S6] → sending delta(kind=head bytes=1788) to S9@127.0.0.1:31610
[S13] sending update (kind=head size=1793 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1793 to 1 peers)
[S3] sending update (kind=head size=1791 to 1 peers)
[S6] sending update (kind=head size=1788 to 1 peers)
[S9] sending update (kind=head size=1793 to 1 peers)
[S14] sending update (kind=head size=1785 to 1 peers)
[S7] sending update (kind=head size=1794 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1793) from S4
[S3] cosine check vs S4: cos=-0.1015
[S3] DROPPED delta from S4 (cos=-0.1015 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1791) from S3
[S6] cosine check vs S3: cos=-0.0817
[S6] DROPPED delta from S3 (cos=-0.0817 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1794) from S7
[S8] cosine check vs S7: cos=-0.0190
[S8] DROPPED delta from S7 (cos=-0.0190 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1788) from S6
[S9] cosine check vs S6: cos=0.0042
[S7] RECEIVED delta(kind=head bytes=1785) from S14
[S7] cosine check vs S14: cos=0.0127
[S17] RECEIVED delta(kind=head bytes=1795) from S8
[S17] cosine check vs S8: cos=0.0803
[S15] RECEIVED delta(kind=head bytes=1793) from S9
[S15] cosine check vs S9: cos=0.0448
[S3] RECEIVED delta(kind=head bytes=1793) from S13
[S3] cosine check vs S13: cos=0.0857
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S17] → sending delta(kind=head bytes=1790) to S2@127.0.0.1:31602
[S17] sending update (kind=head size=1790 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1790) from S17
[S2] cosine check vs S17: cos=-0.0299
[S2] DROPPED delta from S17 (cos=-0.0299 < 0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=2 metric=0.1397 head_norm=0.903949
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.135444e-01
[S15] stored merged vector for next round verification (round=2)
[S15] DEBUG after merge:  round=2 metric=0.1397 head_norm=0.745314 delta_norm=0.713544
[S15] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=2 metric=0.1421 head_norm=1.246439
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.487002e-01
[S7] stored merged vector for next round verification (round=2)
[S7] DEBUG after merge:  round=2 metric=0.1421 head_norm=0.859508 delta_norm=0.848700
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=2 metric=0.1398 head_norm=1.286947
[S3] _apply_head_vector_avg (torch): Δ‖w‖=8.186520e-01
[S3] stored merged vector for next round verification (round=2)
[S3] DEBUG after merge:  round=2 metric=0.1398 head_norm=0.891420 delta_norm=0.818652
[S3] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=2 metric=0.1414 head_norm=1.145493
[S9] _apply_head_vector_avg (torch): Δ‖w‖=8.486547e-01
[S9] stored merged vector for next round verification (round=2)
[S9] DEBUG after merge:  round=2 metric=0.1414 head_norm=0.852240 delta_norm=0.848655
[S9] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=2 metric=0.1409 head_norm=1.167586
[S17] _apply_head_vector_avg (torch): Δ‖w‖=8.267037e-01
[S17] stored merged vector for next round verification (round=2)
[S17] DEBUG after merge:  round=2 metric=0.1409 head_norm=0.895752 delta_norm=0.826704
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=3 head_norm_before_train=0.845690 cos_to_last_merge=0.9966 (last merge round=1)
[S2] round=3 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6207490230196889, 'loss_val': 1.248918127710289, 'psi': 0.3333658892410156}-{'f1_val': 0.1417771333885667, 'auprc': 0.7787262342060062, 'loss_val': 1.3001883931806124, 'psi': 0.39655677371554254}
[S3] START round=3 head_norm_before_train=0.891420 cos_to_last_merge=1.0000 (last merge round=2)
[S3] round=3 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.996642093850976, 'loss_val': 1.269408473879753, 'psi': 0.48256087690885463}-{'f1_val': 0.13984006561410703, 'auprc': 0.9987241717619713, 'loss_val': 1.2700595801630794, 'psi': 0.48339370807325277}
[S4] START round=3 head_norm_before_train=1.199284 (no previous merge yet)
[S4] round=3 local utility u=0.059682 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7791970182701472, 'loss_val': 1.2461136538715254, 'psi': 0.3958147846451694}-{'f1_val': 0.14022662889518414, 'auprc': 0.7545919472275816, 'loss_val': 1.291662457507966, 'psi': 0.38597275622814314}
[S5] START round=3 head_norm_before_train=0.854843 cos_to_last_merge=0.9969 (last merge round=1)
[S5] round=3 local utility u=0.019883 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.5676415235535054, 'loss_val': 1.2864191969946999, 'psi': 0.312413752278545}-{'f1_val': 0.14226190476190476, 'auprc': 0.566694836638165, 'loss_val': 1.3233448185590109, 'psi': 0.3120350775124089}
[S6] START round=3 head_norm_before_train=1.257339 (no previous merge yet)
[S6] round=3 local utility u=0.028608 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8638518217781646, 'loss_val': 1.2240481000823185, 'psi': 0.43039649794203505}-{'f1_val': 0.14142628205128205, 'auprc': 0.8602775766920059, 'loss_val': 1.2705410293058115, 'psi': 0.4289667999075716}
[S7] START round=3 head_norm_before_train=0.859508 cos_to_last_merge=1.0000 (last merge round=2)
[S7] round=3 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7777126554465763, 'loss_val': 1.280848485484107, 'psi': 0.3963191558160855}-{'f1_val': 0.14205682272909165, 'auprc': 0.7775952477517776, 'loss_val': 1.2754448051163323, 'psi': 0.39627219273816605}
[S8] START round=3 head_norm_before_train=1.268213 (no previous merge yet)
[S8] round=3 local utility u=0.023001 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7666262929067649, 'loss_val': 1.189832045739119, 'psi': 0.3906241065984803}-{'f1_val': 0.13995598239295717, 'auprc': 0.7709832352048149, 'loss_val': 1.2489057965586696, 'psi': 0.3923668835177003}
[S9] START round=3 head_norm_before_train=0.852240 cos_to_last_merge=1.0000 (last merge round=2)
[S9] round=3 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9164592679044286, 'loss_val': 1.2639312837580927, 'psi': 0.4514224814457691}-{'f1_val': 0.141397957139996, 'auprc': 0.9902934231289163, 'loss_val': 1.2565211261606135, 'psi': 0.48095614353556415}
[S10] START round=3 head_norm_before_train=1.174951 (no previous merge yet)
[S10] round=3 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7909217542812965, 'loss_val': 1.2023118470646847, 'psi': 0.399541684237553}-{'f1_val': 0.13862163754172394, 'auprc': 0.8215468385406215, 'loss_val': 1.2635822573900986, 'psi': 0.411791717941283}
[S11] START round=3 head_norm_before_train=1.156111 (no previous merge yet)
[S11] round=3 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7668890669537178, 'loss_val': 1.2320066268564245, 'psi': 0.3910038368053535}-{'f1_val': 0.14041368337311058, 'auprc': 0.7926961445150651, 'loss_val': 1.2878491840116792, 'psi': 0.4013266678298924}
[S13] START round=3 head_norm_before_train=1.128455 (no previous merge yet)
[S13] round=3 local utility u=0.044482 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7207047415462287, 'loss_val': 1.2436258690627875, 'psi': 0.3725133541647233}-{'f1_val': 0.1403857625770531, 'auprc': 0.7053843582775872, 'loss_val': 1.2866292366476695, 'psi': 0.3663852008572667}
[S14] START round=3 head_norm_before_train=1.168111 (no previous merge yet)
[S14] round=3 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7622209744119557, 'loss_val': 1.2664059080361607, 'psi': 0.3891031014944045}-{'f1_val': 0.14035785288270378, 'auprc': 0.8543320236892994, 'loss_val': 1.302010290891374, 'psi': 0.425947521205342}
[S15] START round=3 head_norm_before_train=0.745314 cos_to_last_merge=1.0000 (last merge round=2)
[S15] round=3 local utility u=0.023910 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7734715370515256, 'loss_val': 1.3128494964178046, 'psi': 0.39322880563754525}-{'f1_val': 0.13973365136155833, 'auprc': 0.7632368887100827, 'loss_val': 1.329964688333476, 'psi': 0.38913494630096807}
[S16] START round=3 head_norm_before_train=0.845304 cos_to_last_merge=0.9967 (last merge round=1)
[S16] round=3 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.72085852722149, 'loss_val': 1.2499334777779003, 'psi': 0.3727258810081179}-{'f1_val': 0.14063745019920318, 'auprc': 0.7575871162788055, 'loss_val': 1.3082386437093796, 'psi': 0.3874173166310442}
[S17] START round=3 head_norm_before_train=0.895752 cos_to_last_merge=1.0000 (last merge round=2)
[S17] round=3 local utility u=0.005103 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5555984646948012, 'loss_val': 1.3121942296922569, 'psi': 0.3068087638683511}-{'f1_val': 0.14094896331738438, 'auprc': 0.5535226536878078, 'loss_val': 1.3161728958797567, 'psi': 0.3059784394655538}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] → sending delta(kind=head bytes=1794) to S10@127.0.0.1:31611
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:31611
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:31605
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:31617
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] → sending delta(kind=head bytes=1794) to S4@127.0.0.1:31604
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:31605
[S13] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1794 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1794 to 1 peers)
[S4] sending update (kind=head size=1794 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1799) from S8
[S17] cosine check vs S8: cos=0.7375
[S5] RECEIVED delta(kind=head bytes=1796) from S13
[S5] cosine check vs S13: cos=0.0315
[S5] RECEIVED delta(kind=head bytes=1794) from S4
[S5] cosine check vs S4: cos=0.0562
[S4] RECEIVED delta(kind=head bytes=1794) from S6
[S4] cosine check vs S6: cos=0.0038
[S10] RECEIVED delta(kind=head bytes=1794) from S15
[S10] cosine check vs S15: cos=-0.1275
[S10] DROPPED delta from S15 (cos=-0.1275 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1797) from S5
[S10] cosine check vs S5: cos=0.0062
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:31605
[S17] sending update (kind=head size=1793 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1793) from S17
[S5] cosine check vs S17: cos=-0.0142
[S5] DROPPED delta from S17 (cos=-0.0142 < 0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=3 metric=0.1386 head_norm=1.215132
[S10] _apply_head_vector_avg (torch): Δ‖w‖=7.478868e-01
[S10] stored merged vector for next round verification (round=3)
[S10] DEBUG after merge:  round=3 metric=0.1386 head_norm=0.752332 delta_norm=0.747887
[S10] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=3 metric=0.1402 head_norm=1.223349
[S4] _apply_head_vector_avg (torch): Δ‖w‖=8.886573e-01
[S4] stored merged vector for next round verification (round=3)
[S4] DEBUG after merge:  round=3 metric=0.3964 head_norm=0.892039 delta_norm=0.888657
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=3 metric=0.1423 head_norm=0.879846
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.975411e-01
[S5] stored merged vector for next round verification (round=3)
[S5] DEBUG after merge:  round=3 metric=0.1423 head_norm=0.635086 delta_norm=0.597541
[S5] aggregate: ACCEPT kept=['S13', 'S4'] (k=2/2) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=3 metric=0.1409 head_norm=0.916010
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.400099e-01
[S17] stored merged vector for next round verification (round=3)
[S17] DEBUG after merge:  round=3 metric=0.1409 head_norm=1.035814 delta_norm=0.440010
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=0.877581 cos_to_last_merge=0.9874 (last merge round=1)
[S2] round=4 local utility u=0.004661 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.613527609243079, 'loss_val': 1.2179316291728328, 'psi': 0.33047732373037164}-{'f1_val': 0.1417771333885667, 'auprc': 0.6207490230196889, 'loss_val': 1.248918127710289, 'psi': 0.3333658892410156}
[S3] START round=4 head_norm_before_train=0.919267 cos_to_last_merge=0.9967 (last merge round=2)
[S3] round=4 local utility u=0.016397 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9844966082023321, 'loss_val': 1.2001785357545498, 'psi': 0.4777026826493971}-{'f1_val': 0.13984006561410703, 'auprc': 0.996642093850976, 'loss_val': 1.269408473879753, 'psi': 0.48256087690885463}
[S4] START round=4 head_norm_before_train=0.892039 cos_to_last_merge=1.0000 (last merge round=3)
[S4] round=4 local utility u=0.000000 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7746908963162733, 'loss_val': 1.2519405099781291, 'psi': 0.39401233586361983}-{'f1_val': 0.14022662889518414, 'auprc': 0.7791970182701472, 'loss_val': 1.2461136538715254, 'psi': 0.3958147846451694}
[S5] START round=4 head_norm_before_train=0.635086 cos_to_last_merge=1.0000 (last merge round=3)
[S5] round=4 local utility u=0.001417 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.5653617137918573, 'loss_val': 1.2767461314130952, 'psi': 0.3115018283738858}-{'f1_val': 0.14226190476190476, 'auprc': 0.5676415235535054, 'loss_val': 1.2864191969946999, 'psi': 0.312413752278545}
[S6] START round=4 head_norm_before_train=1.293950 (no previous merge yet)
[S6] round=4 local utility u=0.030047 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8642288643724202, 'loss_val': 1.1650858977814167, 'psi': 0.4305473149797373}-{'f1_val': 0.14142628205128205, 'auprc': 0.8638518217781646, 'loss_val': 1.2240481000823185, 'psi': 0.43039649794203505}
[S7] START round=4 head_norm_before_train=0.880973 cos_to_last_merge=0.9983 (last merge round=2)
[S7] round=4 local utility u=0.008035 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7775220474391914, 'loss_val': 1.2642071535285075, 'psi': 0.39624291261313155}-{'f1_val': 0.14205682272909165, 'auprc': 0.7777126554465763, 'loss_val': 1.280848485484107, 'psi': 0.3963191558160855}
[S8] START round=4 head_norm_before_train=1.301524 (no previous merge yet)
[S8] round=4 local utility u=0.522999 metrics={'f1_val': 0.2974941637980728, 'auprc': 0.7697593731847577, 'loss_val': 1.098463013395712, 'psi': 0.4864002475527468}-{'f1_val': 0.13995598239295717, 'auprc': 0.7666262929067649, 'loss_val': 1.189832045739119, 'psi': 0.3906241065984803}
[S9] START round=4 head_norm_before_train=0.868962 cos_to_last_merge=0.9970 (last merge round=2)
[S9] round=4 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8012898326396812, 'loss_val': 1.2105710295707854, 'psi': 0.4053547073398701}-{'f1_val': 0.141397957139996, 'auprc': 0.9164592679044286, 'loss_val': 1.2639312837580927, 'psi': 0.4514224814457691}
[S10] START round=4 head_norm_before_train=0.752332 cos_to_last_merge=1.0000 (last merge round=3)
[S10] round=4 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7842212634858854, 'loss_val': 1.1931968607524648, 'psi': 0.3968614879193885}-{'f1_val': 0.13862163754172394, 'auprc': 0.7909217542812965, 'loss_val': 1.2023118470646847, 'psi': 0.399541684237553}
[S11] START round=4 head_norm_before_train=1.188975 (no previous merge yet)
[S11] round=4 local utility u=0.024297 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7630145733889329, 'loss_val': 1.1717898018984747, 'psi': 0.3894540393794395}-{'f1_val': 0.14041368337311058, 'auprc': 0.7668890669537178, 'loss_val': 1.2320066268564245, 'psi': 0.3910038368053535}
[S13] START round=4 head_norm_before_train=1.155827 (no previous merge yet)
[S13] round=4 local utility u=0.031671 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7235379238885246, 'loss_val': 1.1887835538929725, 'psi': 0.3736466271016417}-{'f1_val': 0.1403857625770531, 'auprc': 0.7207047415462287, 'loss_val': 1.2436258690627875, 'psi': 0.3725133541647233}
[S14] START round=4 head_norm_before_train=1.198785 (no previous merge yet)
[S14] round=4 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.6767556164189185, 'loss_val': 1.219379686827237, 'psi': 0.35491695829718967}-{'f1_val': 0.14035785288270378, 'auprc': 0.7622209744119557, 'loss_val': 1.2664059080361607, 'psi': 0.3891031014944045}
[S15] START round=4 head_norm_before_train=0.764993 cos_to_last_merge=0.9959 (last merge round=2)
[S15] round=4 local utility u=0.019791 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7741819256312263, 'loss_val': 1.2753995520501205, 'psi': 0.39351296106942557}-{'f1_val': 0.13973365136155833, 'auprc': 0.7734715370515256, 'loss_val': 1.3128494964178046, 'psi': 0.39322880563754525}
[S16] START round=4 head_norm_before_train=0.879506 cos_to_last_merge=0.9869 (last merge round=1)
[S16] round=4 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.46874561963983863, 'loss_val': 1.1851225483015129, 'psi': 0.2718807179754574}-{'f1_val': 0.14063745019920318, 'auprc': 0.72085852722149, 'loss_val': 1.2499334777779003, 'psi': 0.3727258810081179}
[S17] START round=4 head_norm_before_train=1.035814 cos_to_last_merge=1.0000 (last merge round=3)
[S17] round=4 local utility u=0.038884 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5755208560521446, 'loss_val': 1.2941926081979684, 'psi': 0.3147777204112885}-{'f1_val': 0.14094896331738438, 'auprc': 0.5555984646948012, 'loss_val': 1.3121942296922569, 'psi': 0.3068087638683511}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] → sending delta(kind=head bytes=1794) to S11@127.0.0.1:31612
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] → sending delta(kind=head bytes=1794) to S17@127.0.0.1:31617
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:31611
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:31605
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:31609
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:31617
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:31613
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:31604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:31611
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1794 to 1 peers)
[S2] sending update (kind=head size=1794 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1796) from S11
[S13] cosine check vs S11: cos=-0.0329
[S13] DROPPED delta from S11 (cos=-0.0329 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1794) from S7
[S17] cosine check vs S7: cos=-0.0333
[S17] DROPPED delta from S7 (cos=-0.0333 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1800) from S15
[S10] cosine check vs S15: cos=-0.0521
[S10] DROPPED delta from S15 (cos=-0.0521 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1802) from S5
[S10] cosine check vs S5: cos=0.4211
[S8] RECEIVED delta(kind=head bytes=1798) from S3
[S8] cosine check vs S3: cos=-0.0699
[S8] DROPPED delta from S3 (cos=-0.0699 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1800) from S6
[S4] cosine check vs S6: cos=0.7079
[S17] RECEIVED delta(kind=head bytes=1797) from S8
[S17] cosine check vs S8: cos=0.9373
[S5] RECEIVED delta(kind=head bytes=1799) from S13
[S5] cosine check vs S13: cos=0.4832
[S11] RECEIVED delta(kind=head bytes=1794) from S2
[S11] cosine check vs S2: cos=-0.0247
[S11] DROPPED delta from S2 (cos=-0.0247 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S17] → sending delta(kind=head bytes=1788) to S5@127.0.0.1:31605
[S17] sending update (kind=head size=1788 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1788) from S17
[S5] cosine check vs S17: cos=0.0392
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=4 metric=0.1386 head_norm=0.795155
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.954352e-01
[S10] stored merged vector for next round verification (round=4)
[S10] DEBUG after merge:  round=4 metric=0.1386 head_norm=0.614108 delta_norm=0.395435
[S10] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=4 metric=0.1402 head_norm=0.919896
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.705116e-01
[S4] stored merged vector for next round verification (round=4)
[S4] DEBUG after merge:  round=4 metric=0.3694 head_norm=1.043413 delta_norm=0.470512
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=4 metric=0.1423 head_norm=0.659335
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.060164e-01
[S5] stored merged vector for next round verification (round=4)
[S5] DEBUG after merge:  round=4 metric=0.1423 head_norm=0.606122 delta_norm=0.406016
[S5] aggregate: ACCEPT kept=['S13', 'S17'] (k=2/2) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=4 metric=0.1409 head_norm=1.050814
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.555250e-01
[S17] stored merged vector for next round verification (round=4)
[S17] DEBUG after merge:  round=4 metric=0.1409 head_norm=1.177461 delta_norm=0.255525
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=5 head_norm_before_train=0.914708 cos_to_last_merge=0.9758 (last merge round=1)
[S2] round=5 local utility u=0.232028 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7485180048914174, 'loss_val': 1.1588472933431633, 'psi': 0.384473481989707}-{'f1_val': 0.1417771333885667, 'auprc': 0.613527609243079, 'loss_val': 1.2179316291728328, 'psi': 0.33047732373037164}
[S3] START round=5 head_norm_before_train=0.955501 cos_to_last_merge=0.9875 (last merge round=2)
[S3] round=5 local utility u=0.056765 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9868511282832546, 'loss_val': 1.0937126237159003, 'psi': 0.47864449068176607}-{'f1_val': 0.13984006561410703, 'auprc': 0.9844966082023321, 'loss_val': 1.2001785357545498, 'psi': 0.4777026826493971}
[S4] START round=5 head_norm_before_train=1.043413 cos_to_last_merge=1.0000 (last merge round=4)
[S4] round=5 local utility u=0.000000 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.6337425089746453, 'loss_val': 1.2205574255512208, 'psi': 0.33763298092696864}-{'f1_val': 0.14022662889518414, 'auprc': 0.7746908963162733, 'loss_val': 1.2519405099781291, 'psi': 0.39401233586361983}
[S5] START round=5 head_norm_before_train=0.606122 cos_to_last_merge=1.0000 (last merge round=4)
[S5] round=5 local utility u=0.024223 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.5733134999070871, 'loss_val': 1.2521558715270154, 'psi': 0.3146825428199777}-{'f1_val': 0.14226190476190476, 'auprc': 0.5653617137918573, 'loss_val': 1.2767461314130952, 'psi': 0.3115018283738858}
[S6] START round=5 head_norm_before_train=1.331906 (no previous merge yet)
[S6] round=5 local utility u=0.892726 metrics={'f1_val': 0.41584976944180807, 'auprc': 0.8680895723568735, 'loss_val': 1.0377564741656, 'psi': 0.5967456906078342}-{'f1_val': 0.14142628205128205, 'auprc': 0.8642288643724202, 'loss_val': 1.1650858977814167, 'psi': 0.4305473149797373}
[S7] START round=5 head_norm_before_train=0.906955 cos_to_last_merge=0.9936 (last merge round=2)
[S7] round=5 local utility u=0.003455 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7777571861528116, 'loss_val': 1.2580028220985098, 'psi': 0.39633696809857966}-{'f1_val': 0.14205682272909165, 'auprc': 0.7775220474391914, 'loss_val': 1.2642071535285075, 'psi': 0.39624291261313155}
[S8] START round=5 head_norm_before_train=1.341344 (no previous merge yet)
[S8] round=5 local utility u=1.000000 metrics={'f1_val': 0.7153201919565738, 'auprc': 0.776943203003411, 'loss_val': 0.9924764073520851, 'psi': 0.7399693963753087}-{'f1_val': 0.2974941637980728, 'auprc': 0.7697593731847577, 'loss_val': 1.098463013395712, 'psi': 0.4864002475527468}
[S9] START round=5 head_norm_before_train=0.897387 cos_to_last_merge=0.9889 (last merge round=2)
[S9] round=5 local utility u=0.035916 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8028294764000554, 'loss_val': 1.143357150620754, 'psi': 0.4059705648440198}-{'f1_val': 0.141397957139996, 'auprc': 0.8012898326396812, 'loss_val': 1.2105710295707854, 'psi': 0.4053547073398701}
[S10] START round=5 head_norm_before_train=0.614108 cos_to_last_merge=1.0000 (last merge round=4)
[S10] round=5 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7763369006398141, 'loss_val': 1.1806109882115585, 'psi': 0.39370774278096}-{'f1_val': 0.13862163754172394, 'auprc': 0.7842212634858854, 'loss_val': 1.1931968607524648, 'psi': 0.3968614879193885}
[S11] START round=5 head_norm_before_train=1.223135 (no previous merge yet)
[S11] round=5 local utility u=0.057803 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7657219673584515, 'loss_val': 1.064306265310202, 'psi': 0.390536996967247}-{'f1_val': 0.14041368337311058, 'auprc': 0.7630145733889329, 'loss_val': 1.1717898018984747, 'psi': 0.3894540393794395}
[S13] START round=5 head_norm_before_train=1.186087 (no previous merge yet)
[S13] round=5 local utility u=0.814234 metrics={'f1_val': 0.41509166458608265, 'auprc': 0.689467027636691, 'loss_val': 1.1063378351935536, 'psi': 0.524841809806326}-{'f1_val': 0.1403857625770531, 'auprc': 0.7235379238885246, 'loss_val': 1.1887835538929725, 'psi': 0.3736466271016417}
[S14] START round=5 head_norm_before_train=1.232445 (no previous merge yet)
[S14] round=5 local utility u=0.138181 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7429411336252357, 'loss_val': 1.1415750401054428, 'psi': 0.38139116517971655}-{'f1_val': 0.14035785288270378, 'auprc': 0.6767556164189185, 'loss_val': 1.219379686827237, 'psi': 0.35491695829718967}
[S15] START round=5 head_norm_before_train=0.793095 cos_to_last_merge=0.9856 (last merge round=2)
[S15] round=5 local utility u=0.021685 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7758351344608234, 'loss_val': 1.2369892477766458, 'psi': 0.3941742446012644}-{'f1_val': 0.13973365136155833, 'auprc': 0.7741819256312263, 'loss_val': 1.2753995520501205, 'psi': 0.39351296106942557}
[S16] START round=5 head_norm_before_train=0.915429 cos_to_last_merge=0.9738 (last merge round=1)
[S16] round=5 local utility u=0.890680 metrics={'f1_val': 0.4148762816002004, 'auprc': 0.4825661576223825, 'loss_val': 1.0906566409924778, 'psi': 0.4419522320090732}-{'f1_val': 0.14063745019920318, 'auprc': 0.46874561963983863, 'loss_val': 1.1851225483015129, 'psi': 0.2718807179754574}
[S17] START round=5 head_norm_before_train=1.177461 cos_to_last_merge=1.0000 (last merge round=4)
[S17] round=5 local utility u=0.025253 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5777504755188324, 'loss_val': 1.2503763896819304, 'psi': 0.3156695681979636}-{'f1_val': 0.14094896331738438, 'auprc': 0.5755208560521446, 'loss_val': 1.2941926081979684, 'psi': 0.3147777204112885}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:31611
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:31611
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:31609
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:31604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:31617
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S14] → sending delta(kind=head bytes=1792) to S15@127.0.0.1:31615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] → sending delta(kind=head bytes=1794) to S17@127.0.0.1:31617
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:31612
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S16] → sending delta(kind=head bytes=1792) to S2@127.0.0.1:31602
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:31613
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] → sending delta(kind=head bytes=1794) to S4@127.0.0.1:31604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:31605
[S8] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1794 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1792 to 1 peers)
[S2] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1794 to 1 peers)
[S14] sending update (kind=head size=1792 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1795 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1796) from S11
[S13] cosine check vs S11: cos=-0.0316
[S13] DROPPED delta from S11 (cos=-0.0316 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1798) from S15
[S10] cosine check vs S15: cos=-0.0273
[S10] DROPPED delta from S15 (cos=-0.0273 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1797) from S5
[S10] cosine check vs S5: cos=0.5271
[S15] RECEIVED delta(kind=head bytes=1792) from S14
[S15] cosine check vs S14: cos=0.0543
[S5] RECEIVED delta(kind=head bytes=1800) from S13
[S5] cosine check vs S13: cos=0.7292
[S8] RECEIVED delta(kind=head bytes=1796) from S3
[S8] cosine check vs S3: cos=-0.0689
[S8] DROPPED delta from S3 (cos=-0.0689 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1794) from S9
[S4] cosine check vs S9: cos=0.6130
[S4] RECEIVED delta(kind=head bytes=1795) from S6
[S4] cosine check vs S6: cos=0.9342
[S11] RECEIVED delta(kind=head bytes=1796) from S2
[S11] cosine check vs S2: cos=-0.0192
[S11] DROPPED delta from S2 (cos=-0.0192 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1797) from S8
[S17] cosine check vs S8: cos=0.9767
[S17] RECEIVED delta(kind=head bytes=1794) from S7
[S17] cosine check vs S7: cos=-0.0267
[S17] DROPPED delta from S7 (cos=-0.0267 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1792) from S16
[S2] cosine check vs S16: cos=0.5403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:31605
[S17] sending update (kind=head size=1796 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1796) from S17
[S5] cosine check vs S17: cos=0.4501
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=5 metric=0.1402 head_norm=1.064255
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.643437e-01
[S4] stored merged vector for next round verification (round=5)
[S4] DEBUG after merge:  round=5 metric=0.1402 head_norm=1.027260 delta_norm=0.264344
[S4] aggregate: ACCEPT kept=['S9', 'S6'] (k=2/2) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.337 → S5@127.0.0.1:31605
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=5 metric=0.1386 head_norm=0.652215
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.117905e-01
[S10] stored merged vector for next round verification (round=5)
[S10] DEBUG after merge:  round=5 metric=0.1386 head_norm=0.559995 delta_norm=0.311791
[S10] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.334 → S16@127.0.0.1:31616
[S6] ⇄ pheromone p=0.549 → S4@127.0.0.1:31604
[S11] ⇄ pheromone p=0.343 → S13@127.0.0.1:31613
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=5 metric=0.1397 head_norm=0.829431
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.367935e-01
[S15] stored merged vector for next round verification (round=5)
[S15] DEBUG after merge:  round=5 metric=0.1397 head_norm=0.774446 delta_norm=0.736794
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.420 → S10@127.0.0.1:31611
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=5 metric=0.1418 head_norm=0.933505
[S2] _apply_head_vector_avg (torch): Δ‖w‖=4.527239e-01
[S2] stored merged vector for next round verification (round=5)
[S2] DEBUG after merge:  round=5 metric=0.1418 head_norm=0.828568 delta_norm=0.452724
[S2] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.415 → S11@127.0.0.1:31612
[S7] ⇄ pheromone p=0.349 → S17@127.0.0.1:31617
[S9] ⇄ pheromone p=0.336 → S4@127.0.0.1:31604
[S13] ⇄ pheromone p=0.506 → S5@127.0.0.1:31605
[S16] ⇄ pheromone p=0.506 → S2@127.0.0.1:31602
[S8] ⇄ pheromone p=0.616 → S17@127.0.0.1:31617
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=5 metric=0.1423 head_norm=0.629469
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.399957e-01
[S5] stored merged vector for next round verification (round=5)
[S5] DEBUG after merge:  round=5 metric=0.1423 head_norm=0.711556 delta_norm=0.239996
[S5] aggregate: ACCEPT kept=['S13', 'S17'] (k=2/2) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.335 → S10@127.0.0.1:31611
[S3] ⇄ pheromone p=0.366 → S8@127.0.0.1:31609
[S14] ⇄ pheromone p=0.373 → S15@127.0.0.1:31615
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=5 metric=0.1409 head_norm=1.191402
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.663394e-01
[S17] stored merged vector for next round verification (round=5)
[S17] DEBUG after merge:  round=5 metric=0.1409 head_norm=1.276580 delta_norm=0.166339
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.369 → S5@127.0.0.1:31605
[S2] START round=6 head_norm_before_train=0.828568 cos_to_last_merge=1.0000 (last merge round=5)
[S2] round=6 local utility u=0.895094 metrics={'f1_val': 0.4161346589918018, 'auprc': 0.7804328027277387, 'loss_val': 1.1105490837854752, 'psi': 0.5618539164861766}-{'f1_val': 0.1417771333885667, 'auprc': 0.7485180048914174, 'loss_val': 1.1588472933431633, 'psi': 0.384473481989707}
[S3] START round=6 head_norm_before_train=0.993915 cos_to_last_merge=0.9763 (last merge round=2)
[S3] round=6 local utility u=0.849805 metrics={'f1_val': 0.39635856801559805, 'auprc': 0.9868574505427081, 'loss_val': 0.9332318832087285, 'psi': 0.632558121026442}-{'f1_val': 0.13984006561410703, 'auprc': 0.9868511282832546, 'loss_val': 1.0937126237159003, 'psi': 0.47864449068176607}
[S4] START round=6 head_norm_before_train=1.027260 cos_to_last_merge=1.0000 (last merge round=5)
[S4] round=6 local utility u=0.000000 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.5928305423051018, 'loss_val': 1.1814376641048219, 'psi': 0.3212681942591512}-{'f1_val': 0.14022662889518414, 'auprc': 0.6337425089746453, 'loss_val': 1.2205574255512208, 'psi': 0.33763298092696864}
[S5] START round=6 head_norm_before_train=0.711556 cos_to_last_merge=1.0000 (last merge round=5)
[S5] round=6 local utility u=0.044428 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.5914241088846985, 'loss_val': 1.21763125759734, 'psi': 0.3219267864110223}-{'f1_val': 0.14226190476190476, 'auprc': 0.5733134999070871, 'loss_val': 1.2521558715270154, 'psi': 0.3146825428199777}
[S6] START round=6 head_norm_before_train=1.372823 (no previous merge yet)
[S6] round=6 local utility u=0.092721 metrics={'f1_val': 0.4168551858772006, 'auprc': 0.8622071681460743, 'loss_val': 0.8406990977104475, 'psi': 0.5949959787847501}-{'f1_val': 0.41584976944180807, 'auprc': 0.8680895723568735, 'loss_val': 1.0377564741656, 'psi': 0.5967456906078342}
[S7] START round=6 head_norm_before_train=0.926452 cos_to_last_merge=0.9885 (last merge round=2)
[S7] round=6 local utility u=0.014554 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7778821594114831, 'loss_val': 1.2292697077148158, 'psi': 0.39638695740204827}-{'f1_val': 0.14205682272909165, 'auprc': 0.7777571861528116, 'loss_val': 1.2580028220985098, 'psi': 0.39633696809857966}
[S8] START round=6 head_norm_before_train=1.376667 (no previous merge yet)
[S8] round=6 local utility u=0.000000 metrics={'f1_val': 0.37306606018310795, 'auprc': 0.7949507840940484, 'loss_val': 0.876851783459709, 'psi': 0.5418199497474842}-{'f1_val': 0.7153201919565738, 'auprc': 0.776943203003411, 'loss_val': 0.9924764073520851, 'psi': 0.7399693963753087}
[S9] START round=6 head_norm_before_train=0.928588 cos_to_last_merge=0.9785 (last merge round=2)
[S9] round=6 local utility u=0.097131 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8198480428515562, 'loss_val': 1.0001504919354023, 'psi': 0.4127779914246201}-{'f1_val': 0.141397957139996, 'auprc': 0.8028294764000554, 'loss_val': 1.143357150620754, 'psi': 0.4059705648440198}
[S10] START round=6 head_norm_before_train=0.559995 cos_to_last_merge=1.0000 (last merge round=5)
[S10] round=6 local utility u=0.844408 metrics={'f1_val': 0.41652587907229816, 'auprc': 0.7679232957265081, 'loss_val': 1.133979323518137, 'psi': 0.5570848457339821}-{'f1_val': 0.13862163754172394, 'auprc': 0.7763369006398141, 'loss_val': 1.1806109882115585, 'psi': 0.39370774278096}
[S11] START round=6 head_norm_before_train=1.261421 (no previous merge yet)
[S11] round=6 local utility u=1.000000 metrics={'f1_val': 0.40252587505625015, 'auprc': 0.9121193540885986, 'loss_val': 0.913144374645059, 'psi': 0.6063632666691895}-{'f1_val': 0.14041368337311058, 'auprc': 0.7657219673584515, 'loss_val': 1.064306265310202, 'psi': 0.390536996967247}
[S13] START round=6 head_norm_before_train=1.219707 (no previous merge yet)
[S13] round=6 local utility u=0.000000 metrics={'f1_val': 0.41655034241240063, 'auprc': 0.5764840941564527, 'loss_val': 1.0232970606451914, 'psi': 0.4805238431100215}-{'f1_val': 0.41509166458608265, 'auprc': 0.689467027636691, 'loss_val': 1.1063378351935536, 'psi': 0.524841809806326}
[S14] START round=6 head_norm_before_train=1.263846 (no previous merge yet)
[S14] round=6 local utility u=1.000000 metrics={'f1_val': 0.39649470961585787, 'auprc': 0.8731587591701885, 'loss_val': 1.05103345729854, 'psi': 0.5871603294375901}-{'f1_val': 0.14035785288270378, 'auprc': 0.7429411336252357, 'loss_val': 1.1415750401054428, 'psi': 0.38139116517971655}
[S15] START round=6 head_norm_before_train=0.774446 cos_to_last_merge=1.0000 (last merge round=5)
[S15] round=6 local utility u=0.007969 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7770531913495003, 'loss_val': 1.2247046923876492, 'psi': 0.3946614673567352}-{'f1_val': 0.13973365136155833, 'auprc': 0.7758351344608234, 'loss_val': 1.2369892477766458, 'psi': 0.3941742446012644}
[S16] START round=6 head_norm_before_train=0.954743 cos_to_last_merge=0.9595 (last merge round=1)
[S16] round=6 local utility u=0.084170 metrics={'f1_val': 0.4170395601558466, 'auprc': 0.5071306105138885, 'loss_val': 1.0089886804636077, 'psi': 0.4530759802990634}-{'f1_val': 0.4148762816002004, 'auprc': 0.4825661576223825, 'loss_val': 1.0906566409924778, 'psi': 0.4419522320090732}
[S17] START round=6 head_norm_before_train=1.276580 cos_to_last_merge=1.0000 (last merge round=5)
[S17] round=6 local utility u=0.043185 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.576127010201148, 'loss_val': 1.1591352368993033, 'psi': 0.31502018207088983}-{'f1_val': 0.14094896331738438, 'auprc': 0.5777504755188324, 'loss_val': 1.2503763896819304, 'psi': 0.3156695681979636}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S2] → sending delta(kind=head bytes=1792) to S11@127.0.0.1:31612
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S3] → sending delta(kind=head bytes=1789) to S8@127.0.0.1:31609
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:31617
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:31602
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:31616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:31611
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:31613
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:31615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:31611
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:31604
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:31604
[S14] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1795 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1789 to 1 peers)
[S2] sending update (kind=head size=1792 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1797) from S9
[S4] cosine check vs S9: cos=0.7371
[S13] RECEIVED delta(kind=head bytes=1797) from S11
[S13] cosine check vs S11: cos=-0.0318
[S13] DROPPED delta from S11 (cos=-0.0318 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1796) from S14
[S15] cosine check vs S14: cos=0.8208
[S8] RECEIVED delta(kind=head bytes=1789) from S3
[S8] cosine check vs S3: cos=-0.0686
[S8] DROPPED delta from S3 (cos=-0.0686 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1796) from S10
[S16] cosine check vs S10: cos=0.1225
[S2] RECEIVED delta(kind=head bytes=1801) from S16
[S2] cosine check vs S16: cos=0.8687
[S17] RECEIVED delta(kind=head bytes=1800) from S7
[S17] cosine check vs S7: cos=-0.0243
[S17] DROPPED delta from S7 (cos=-0.0243 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1792) from S2
[S11] cosine check vs S2: cos=0.0257
[S4] RECEIVED delta(kind=head bytes=1795) from S6
[S4] cosine check vs S6: cos=0.9578
[S10] RECEIVED delta(kind=head bytes=1796) from S15
[S10] cosine check vs S15: cos=0.3643
[S10] RECEIVED delta(kind=head bytes=1795) from S5
[S10] cosine check vs S5: cos=0.6925
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:31605
[S17] sending update (kind=head size=1801 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1801) from S17
[S5] cosine check vs S17: cos=0.6076
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=6 metric=0.1402 head_norm=1.049722
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.681958e-01
[S4] stored merged vector for next round verification (round=6)
[S4] DEBUG after merge:  round=6 metric=0.1402 head_norm=1.055664 delta_norm=0.168196
[S4] aggregate: ACCEPT kept=['S9', 'S6'] (k=2/2) mode=median trim_p=0.1
[S10] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=6 metric=0.4165 head_norm=0.589222
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.467944e-01
[S10] stored merged vector for next round verification (round=6)
[S10] DEBUG after merge:  round=6 metric=0.1386 head_norm=0.544810 delta_norm=0.246794
[S10] aggregate: ROLLBACK (f1_val pre=0.417 post=0.139 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=6 metric=0.4170 head_norm=0.998811
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.478678e-01
[S16] stored merged vector for next round verification (round=6)
[S16] DEBUG after merge:  round=6 metric=0.4173 head_norm=0.610118 delta_norm=0.547868
[S16] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=6 metric=0.4025 head_norm=1.305864
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.709480e-01
[S11] stored merged vector for next round verification (round=6)
[S11] DEBUG after merge:  round=6 metric=0.4103 head_norm=0.789301 delta_norm=0.770948
[S11] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=6 metric=0.1397 head_norm=0.803127
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.958160e-01
[S15] stored merged vector for next round verification (round=6)
[S15] DEBUG after merge:  round=6 metric=0.1397 head_norm=1.008224 delta_norm=0.395816
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=6 metric=0.1423 head_norm=0.733820
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.143695e-01
[S5] stored merged vector for next round verification (round=6)
[S5] DEBUG after merge:  round=6 metric=0.1423 head_norm=0.917270 delta_norm=0.514369
[S5] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=6 metric=0.4161 head_norm=0.854068
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.474640e-01
[S2] stored merged vector for next round verification (round=6)
[S2] DEBUG after merge:  round=6 metric=0.4165 head_norm=0.895706 delta_norm=0.247464
[S2] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=7 head_norm_before_train=0.895706 cos_to_last_merge=1.0000 (last merge round=6)
[S2] round=7 local utility u=0.000000 metrics={'f1_val': 0.4167275806938775, 'auprc': 0.6966946885070787, 'loss_val': 1.0157265252698053, 'psi': 0.528714423819158}-{'f1_val': 0.4161346589918018, 'auprc': 0.7804328027277387, 'loss_val': 1.1105490837854752, 'psi': 0.5618539164861766}
[S3] START round=7 head_norm_before_train=1.043154 cos_to_last_merge=0.9612 (last merge round=2)
[S3] round=7 local utility u=0.000000 metrics={'f1_val': 0.3941424508574739, 'auprc': 0.8843147956711035, 'loss_val': 0.7469871212147986, 'psi': 0.5902113887829257}-{'f1_val': 0.39635856801559805, 'auprc': 0.9868574505427081, 'loss_val': 0.9332318832087285, 'psi': 0.632558121026442}
[S4] START round=7 head_norm_before_train=1.055664 cos_to_last_merge=1.0000 (last merge round=6)
[S4] round=7 local utility u=1.000000 metrics={'f1_val': 0.4541667516432034, 'auprc': 0.6213131003066922, 'loss_val': 1.085345788079941, 'psi': 0.521025291108599}-{'f1_val': 0.14022662889518414, 'auprc': 0.5928305423051018, 'loss_val': 1.1814376641048219, 'psi': 0.3212681942591512}
[S5] START round=7 head_norm_before_train=0.917270 cos_to_last_merge=1.0000 (last merge round=6)
[S5] round=7 local utility u=0.335235 metrics={'f1_val': 0.15346746575342465, 'auprc': 0.7778196753128449, 'loss_val': 1.1735812567609176, 'psi': 0.40320834957719276}-{'f1_val': 0.14226190476190476, 'auprc': 0.5914241088846985, 'loss_val': 1.21763125759734, 'psi': 0.3219267864110223}
[S6] START round=7 head_norm_before_train=1.420030 (no previous merge yet)
[S6] round=7 local utility u=0.237729 metrics={'f1_val': 0.4167737228302586, 'auprc': 0.9650237880701991, 'loss_val': 0.6732027583862371, 'psi': 0.6360737489262348}-{'f1_val': 0.4168551858772006, 'auprc': 0.8622071681460743, 'loss_val': 0.8406990977104475, 'psi': 0.5949959787847501}
[S7] START round=7 head_norm_before_train=0.933646 cos_to_last_merge=0.9857 (last merge round=2)
[S7] round=7 local utility u=0.002696 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7778798212859045, 'loss_val': 1.2238697954457296, 'psi': 0.3963860221518168}-{'f1_val': 0.14205682272909165, 'auprc': 0.7778821594114831, 'loss_val': 1.2292697077148158, 'psi': 0.39638695740204827}
[S8] START round=7 head_norm_before_train=1.408504 (no previous merge yet)
[S8] round=7 local utility u=0.368019 metrics={'f1_val': 0.3728657005221765, 'auprc': 0.9956781130906999, 'loss_val': 0.741794468654565, 'psi': 0.6219906655495859}-{'f1_val': 0.37306606018310795, 'auprc': 0.7949507840940484, 'loss_val': 0.876851783459709, 'psi': 0.5418199497474842}
[S9] START round=7 head_norm_before_train=0.962323 cos_to_last_merge=0.9668 (last merge round=2)
[S9] round=7 local utility u=1.000000 metrics={'f1_val': 0.7130416339473294, 'auprc': 0.9999886505590783, 'loss_val': 0.7858532192069575, 'psi': 0.827820440592029}-{'f1_val': 0.141397957139996, 'auprc': 0.8198480428515562, 'loss_val': 1.0001504919354023, 'psi': 0.4127779914246201}
[S10] START round=7 head_norm_before_train=0.544810 cos_to_last_merge=1.0000 (last merge round=6)
[S10] round=7 local utility u=0.000000 metrics={'f1_val': 0.4168455130671376, 'auprc': 0.7147597888404769, 'loss_val': 1.0904442735371151, 'psi': 0.5360112233764733}-{'f1_val': 0.41652587907229816, 'auprc': 0.7679232957265081, 'loss_val': 1.133979323518137, 'psi': 0.5570848457339821}
[S11] START round=7 head_norm_before_train=0.789301 cos_to_last_merge=1.0000 (last merge round=6)
[S11] round=7 local utility u=0.013217 metrics={'f1_val': 0.39655223592620625, 'auprc': 0.9275571086017157, 'loss_val': 0.8971823712655145, 'psi': 0.6089541849964101}-{'f1_val': 0.40252587505625015, 'auprc': 0.9121193540885986, 'loss_val': 0.913144374645059, 'psi': 0.6063632666691895}
[S13] START round=7 head_norm_before_train=1.255244 (no previous merge yet)
[S13] round=7 local utility u=0.959194 metrics={'f1_val': 0.6435951495134054, 'auprc': 0.7176571707984611, 'loss_val': 0.8906979930998318, 'psi': 0.6732199580274276}-{'f1_val': 0.41655034241240063, 'auprc': 0.5764840941564527, 'loss_val': 1.0232970606451914, 'psi': 0.4805238431100215}
[S14] START round=7 head_norm_before_train=1.304362 (no previous merge yet)
[S14] round=7 local utility u=0.094963 metrics={'f1_val': 0.39652757107859105, 'auprc': 0.8773597594200964, 'loss_val': 0.8739070040187465, 'psi': 0.5888604464151932}-{'f1_val': 0.39649470961585787, 'auprc': 0.8731587591701885, 'loss_val': 1.05103345729854, 'psi': 0.5871603294375901}
[S15] START round=7 head_norm_before_train=1.008224 cos_to_last_merge=1.0000 (last merge round=6)
[S15] round=7 local utility u=0.688936 metrics={'f1_val': 0.3525361623657315, 'auprc': 0.7967079855912139, 'loss_val': 1.1826130460493613, 'psi': 0.5302048916559245}-{'f1_val': 0.13973365136155833, 'auprc': 0.7770531913495003, 'loss_val': 1.2247046923876492, 'psi': 0.3946614673567352}
[S16] START round=7 head_norm_before_train=0.610118 cos_to_last_merge=1.0000 (last merge round=6)
[S16] round=7 local utility u=0.063547 metrics={'f1_val': 0.41700358386742975, 'auprc': 0.5388684888265544, 'loss_val': 0.9768929954145045, 'psi': 0.4657495458510796}-{'f1_val': 0.4170395601558466, 'auprc': 0.5071306105138885, 'loss_val': 1.0089886804636077, 'psi': 0.4530759802990634}
[S17] START round=7 head_norm_before_train=1.293611 cos_to_last_merge=0.9977 (last merge round=5)
[S17] round=7 local utility u=0.791771 metrics={'f1_val': 0.3875557738975045, 'auprc': 0.5571068354018325, 'loss_val': 0.9981731384372049, 'psi': 0.4553761984992357}-{'f1_val': 0.14094896331738438, 'auprc': 0.576127010201148, 'loss_val': 1.1591352368993033, 'psi': 0.31502018207088983}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S15] → sending delta(kind=head bytes=1788) to S10@127.0.0.1:31611
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:31604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S5] → sending delta(kind=head bytes=1787) to S10@127.0.0.1:31611
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:31604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S7] → sending delta(kind=head bytes=1792) to S17@127.0.0.1:31617
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:31615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:31602
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S13@127.0.0.1:31613
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1785 reason=None
[S4] → sending delta(kind=head bytes=1785) to S5@127.0.0.1:31605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:31617
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:31605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:31605
[S8] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1785 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1794 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1804 to 1 peers)
[S5] sending update (kind=head size=1787 to 1 peers)
[S15] sending update (kind=head size=1788 to 1 peers)
[S6] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1792 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1800) from S14
[S15] cosine check vs S14: cos=0.9606
[S5] RECEIVED delta(kind=head bytes=1804) from S13
[S5] cosine check vs S13: cos=0.3051
[S5] RECEIVED delta(kind=head bytes=1785) from S4
[S5] cosine check vs S4: cos=0.1189
[S13] RECEIVED delta(kind=head bytes=1794) from S11
[S13] cosine check vs S11: cos=0.0263
[S4] RECEIVED delta(kind=head bytes=1800) from S9
[S4] cosine check vs S9: cos=0.7839
[S4] RECEIVED delta(kind=head bytes=1796) from S6
[S4] cosine check vs S6: cos=0.9532
[S10] RECEIVED delta(kind=head bytes=1787) from S5
[S10] cosine check vs S5: cos=0.5765
[S10] RECEIVED delta(kind=head bytes=1788) from S15
[S10] cosine check vs S15: cos=0.6042
[S17] RECEIVED delta(kind=head bytes=1792) from S7
[S17] cosine check vs S7: cos=-0.0264
[S17] DROPPED delta from S7 (cos=-0.0264 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1800) from S8
[S17] cosine check vs S8: cos=0.9711
[S2] RECEIVED delta(kind=head bytes=1797) from S16
[S2] cosine check vs S16: cos=0.8777
[S17] sending update (kind=head size=1796 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1796) from S17
[S5] cosine check vs S17: cos=0.9421
[S10] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=7 metric=0.4168 head_norm=0.568025
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.302454e-01
[S10] stored merged vector for next round verification (round=7)
[S10] DEBUG after merge:  round=7 metric=0.1386 head_norm=0.617345 delta_norm=0.230245
[S10] aggregate: ROLLBACK (f1_val pre=0.417 post=0.139 tol_abs=0.005 tol_rel=0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=7 metric=0.4167 head_norm=0.934178
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.374761e-01
[S2] stored merged vector for next round verification (round=7)
[S2] DEBUG after merge:  round=7 metric=0.4168 head_norm=0.773704 delta_norm=0.237476
[S2] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=7 metric=0.4542 head_norm=1.076818
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.258664e-01
[S4] stored merged vector for next round verification (round=7)
[S4] DEBUG after merge:  round=7 metric=0.6772 head_norm=1.092811 delta_norm=0.125866
[S4] aggregate: ACCEPT kept=['S9', 'S6'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=7 metric=0.1535 head_norm=0.928090
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.861297e-01
[S5] stored merged vector for next round verification (round=7)
[S5] DEBUG after merge:  round=7 metric=0.1423 head_norm=0.786805 delta_norm=0.286130
[S5] aggregate: ROLLBACK (f1_val pre=0.153 post=0.142 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=7 metric=0.3525 head_norm=1.026428
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.334295e-01
[S15] stored merged vector for next round verification (round=7)
[S15] DEBUG after merge:  round=7 metric=0.3141 head_norm=1.179476 delta_norm=0.233430
[S15] aggregate: ROLLBACK (f1_val pre=0.353 post=0.314 tol_abs=0.005 tol_rel=0.0)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=7 metric=0.6436 head_norm=1.293811
[S13] _apply_head_vector_avg (torch): Δ‖w‖=7.625741e-01
[S13] stored merged vector for next round verification (round=7)
[S13] DEBUG after merge:  round=7 metric=0.4162 head_norm=0.781141 delta_norm=0.762574
[S13] aggregate: ROLLBACK (f1_val pre=0.644 post=0.416 tol_abs=0.005 tol_rel=0.0)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=7 metric=0.3876 head_norm=1.321566
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.785480e-01
[S17] stored merged vector for next round verification (round=7)
[S17] DEBUG after merge:  round=7 metric=0.3874 head_norm=1.375914 delta_norm=0.178548
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=0.773704 cos_to_last_merge=1.0000 (last merge round=7)
[S2] round=8 local utility u=0.512745 metrics={'f1_val': 0.5317784624346037, 'auprc': 0.7779832463577918, 'loss_val': 0.9244082037352801, 'psi': 0.630260376003879}-{'f1_val': 0.4167275806938775, 'auprc': 0.6966946885070787, 'loss_val': 1.0157265252698053, 'psi': 0.528714423819158}
[S3] START round=8 head_norm_before_train=1.099888 cos_to_last_merge=0.9428 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.943
[S3] round=8 local utility u=0.000000 metrics={'f1_val': 0.401708470248874, 'auprc': 0.7086274662654906, 'loss_val': 0.8635346373117182, 'psi': 0.5244760686555205}-{'f1_val': 0.3941424508574739, 'auprc': 0.8843147956711035, 'loss_val': 0.7469871212147986, 'psi': 0.5902113887829257}
[S4] START round=8 head_norm_before_train=1.092811 cos_to_last_merge=1.0000 (last merge round=7)
[S4] round=8 local utility u=0.000000 metrics={'f1_val': 0.36876656608404657, 'auprc': 0.6522547495086651, 'loss_val': 0.9682818715818785, 'psi': 0.482161839453894}-{'f1_val': 0.4541667516432034, 'auprc': 0.6213131003066922, 'loss_val': 1.085345788079941, 'psi': 0.521025291108599}
[S5] START round=8 head_norm_before_train=0.786805 cos_to_last_merge=1.0000 (last merge round=7)
[S5] round=8 local utility u=0.810817 metrics={'f1_val': 0.4177447289106557, 'auprc': 0.7772153407738145, 'loss_val': 1.135797685557924, 'psi': 0.5615329736559193}-{'f1_val': 0.15346746575342465, 'auprc': 0.7778196753128449, 'loss_val': 1.1735812567609176, 'psi': 0.40320834957719276}
[S6] START round=8 head_norm_before_train=1.469467 (no previous merge yet)
[S6] round=8 local utility u=0.977425 metrics={'f1_val': 0.697198293113745, 'auprc': 0.9913455578244534, 'loss_val': 0.47986594306119035, 'psi': 0.8148571989980284}-{'f1_val': 0.4167737228302586, 'auprc': 0.9650237880701991, 'loss_val': 0.6732027583862371, 'psi': 0.6360737489262348}
[S7] START round=8 head_norm_before_train=0.938398 cos_to_last_merge=0.9818 (last merge round=2)
[S7] round=8 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.6208631602411231, 'loss_val': 1.1954288426045114, 'psi': 0.33357935773390424}-{'f1_val': 0.14205682272909165, 'auprc': 0.7778798212859045, 'loss_val': 1.2238697954457296, 'psi': 0.3963860221518168}
[S8] START round=8 head_norm_before_train=1.450346 (no previous merge yet)
[S8] round=8 local utility u=0.030444 metrics={'f1_val': 0.3729988868650071, 'auprc': 0.994676215178836, 'loss_val': 0.6786991358838953, 'psi': 0.6216698181905387}-{'f1_val': 0.3728657005221765, 'auprc': 0.9956781130906999, 'loss_val': 0.741794468654565, 'psi': 0.6219906655495859}
[S9] START round=8 head_norm_before_train=1.005124 cos_to_last_merge=0.9529 (last merge round=2)
[S9] round=8 local utility u=0.068137 metrics={'f1_val': 0.7006903481953873, 'auprc': 0.9992363736245115, 'loss_val': 0.5732145045126594, 'psi': 0.820108758367037}-{'f1_val': 0.7130416339473294, 'auprc': 0.9999886505590783, 'loss_val': 0.7858532192069575, 'psi': 0.827820440592029}
[S10] START round=8 head_norm_before_train=0.617345 cos_to_last_merge=1.0000 (last merge round=7)
[S10] round=8 local utility u=0.000000 metrics={'f1_val': 0.43185577395217745, 'auprc': 0.6445343478868072, 'loss_val': 1.0249687602293434, 'psi': 0.5169272035260293}-{'f1_val': 0.4168455130671376, 'auprc': 0.7147597888404769, 'loss_val': 1.0904442735371151, 'psi': 0.5360112233764733}
[S11] START round=8 head_norm_before_train=0.842292 cos_to_last_merge=0.9963 (last merge round=6)
[S11] round=8 local utility u=0.243673 metrics={'f1_val': 0.42282940561430826, 'auprc': 0.9912118151069839, 'loss_val': 0.7584641995654616, 'psi': 0.6501823694113785}-{'f1_val': 0.39655223592620625, 'auprc': 0.9275571086017157, 'loss_val': 0.8971823712655145, 'psi': 0.6089541849964101}
[S13] START round=8 head_norm_before_train=0.781141 cos_to_last_merge=1.0000 (last merge round=7)
[S13] round=8 local utility u=0.000000 metrics={'f1_val': 0.4160038662657951, 'auprc': 0.7071176198597061, 'loss_val': 0.902135890283148, 'psi': 0.5324493677033595}-{'f1_val': 0.6435951495134054, 'auprc': 0.7176571707984611, 'loss_val': 0.8906979930998318, 'psi': 0.6732199580274276}
[S14] START round=8 head_norm_before_train=1.355637 (no previous merge yet)
[S14] round=8 local utility u=1.000000 metrics={'f1_val': 0.7784984653920025, 'auprc': 0.9721158897423167, 'loss_val': 0.730342068959261, 'psi': 0.8559454351321282}-{'f1_val': 0.39652757107859105, 'auprc': 0.8773597594200964, 'loss_val': 0.8739070040187465, 'psi': 0.5888604464151932}
[S15] START round=8 head_norm_before_train=1.179476 cos_to_last_merge=1.0000 (last merge round=7)
[S15] round=8 local utility u=0.258773 metrics={'f1_val': 0.416567672447929, 'auprc': 0.8000456471164703, 'loss_val': 1.0592681541941311, 'psi': 0.5699588623153455}-{'f1_val': 0.3525361623657315, 'auprc': 0.7967079855912139, 'loss_val': 1.1826130460493613, 'psi': 0.5302048916559245}
[S16] START round=8 head_norm_before_train=0.661314 cos_to_last_merge=0.9955 (last merge round=6)
[S16] round=8 local utility u=0.136785 metrics={'f1_val': 0.38455925324324935, 'auprc': 0.69200554403033, 'loss_val': 0.9680690842720323, 'psi': 0.5075377695580816}-{'f1_val': 0.41700358386742975, 'auprc': 0.5388684888265544, 'loss_val': 0.9768929954145045, 'psi': 0.4657495458510796}
[S17] START round=8 head_norm_before_train=1.375914 cos_to_last_merge=1.0000 (last merge round=7)
[S17] round=8 local utility u=0.136430 metrics={'f1_val': 0.39095641073037735, 'auprc': 0.6130511644694474, 'loss_val': 0.9135491704737811, 'psi': 0.4797943122260054}-{'f1_val': 0.3875557738975045, 'auprc': 0.5571068354018325, 'loss_val': 0.9981731384372049, 'psi': 0.4553761984992357}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:31617
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:31615
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S9] → sending delta(kind=head bytes=1789) to S4@127.0.0.1:31604
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:31604
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] → sending delta(kind=head bytes=1794) to S2@127.0.0.1:31602
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] → sending delta(kind=head bytes=1793) to S10@127.0.0.1:31611
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] → sending delta(kind=head bytes=1794) to S11@127.0.0.1:31612
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1785 reason=None
[S11] → sending delta(kind=head bytes=1785) to S13@127.0.0.1:31613
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S5] → sending delta(kind=head bytes=1792) to S10@127.0.0.1:31611
[S2] sending update (kind=head size=1794 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1789 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1793 to 1 peers)
[S5] sending update (kind=head size=1792 to 1 peers)
[S16] sending update (kind=head size=1794 to 1 peers)
[S11] sending update (kind=head size=1785 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1793) from S15
[S10] cosine check vs S15: cos=0.6954
[S10] RECEIVED delta(kind=head bytes=1792) from S5
[S10] cosine check vs S5: cos=0.6555
[S15] RECEIVED delta(kind=head bytes=1799) from S14
[S15] cosine check vs S14: cos=0.9829
[S4] RECEIVED delta(kind=head bytes=1802) from S6
[S4] cosine check vs S6: cos=0.9450
[S17] RECEIVED delta(kind=head bytes=1797) from S8
[S17] cosine check vs S8: cos=0.9818
[S4] RECEIVED delta(kind=head bytes=1789) from S9
[S4] cosine check vs S9: cos=0.7988
[S2] RECEIVED delta(kind=head bytes=1794) from S16
[S2] cosine check vs S16: cos=0.9413
[S13] RECEIVED delta(kind=head bytes=1785) from S11
[S13] cosine check vs S11: cos=0.5272
[S11] RECEIVED delta(kind=head bytes=1794) from S2
[S11] cosine check vs S2: cos=0.4805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:31605
[S17] sending update (kind=head size=1798 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1798) from S17
[S5] cosine check vs S17: cos=0.8646
[S10] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=8 metric=0.4319 head_norm=0.637322
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.531924e-01
[S10] stored merged vector for next round verification (round=8)
[S10] DEBUG after merge:  round=8 metric=0.4165 head_norm=0.675816 delta_norm=0.153192
[S10] aggregate: ROLLBACK (f1_val pre=0.432 post=0.416 tol_abs=0.005 tol_rel=0.0)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=8 metric=0.4160 head_norm=0.823059
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.220826e-01
[S13] stored merged vector for next round verification (round=8)
[S13] DEBUG after merge:  round=8 metric=0.4160 head_norm=0.756028 delta_norm=0.422083
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=8 metric=0.3688 head_norm=1.119047
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.122663e-01
[S4] stored merged vector for next round verification (round=8)
[S4] DEBUG after merge:  round=8 metric=0.3776 head_norm=1.134116 delta_norm=0.112266
[S4] aggregate: ACCEPT kept=['S6', 'S9'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=8 metric=0.4228 head_norm=0.906664
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.410515e-01
[S11] stored merged vector for next round verification (round=8)
[S11] DEBUG after merge:  round=8 metric=0.4053 head_norm=0.742083 delta_norm=0.441052
[S11] aggregate: ROLLBACK (f1_val pre=0.423 post=0.405 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=8 metric=0.4177 head_norm=0.801782
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.094716e-01
[S5] stored merged vector for next round verification (round=8)
[S5] DEBUG after merge:  round=8 metric=0.1691 head_norm=1.068822 delta_norm=0.409472
[S5] aggregate: ROLLBACK (f1_val pre=0.418 post=0.169 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=8 metric=0.4166 head_norm=1.199406
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.605128e-01
[S15] stored merged vector for next round verification (round=8)
[S15] DEBUG after merge:  round=8 metric=0.4171 head_norm=1.299997 delta_norm=0.160513
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=8 metric=0.5318 head_norm=0.817550
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.397143e-01
[S2] stored merged vector for next round verification (round=8)
[S2] DEBUG after merge:  round=8 metric=0.5058 head_norm=0.760589 delta_norm=0.139714
[S2] aggregate: ROLLBACK (f1_val pre=0.532 post=0.506 tol_abs=0.005 tol_rel=0.0)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=8 metric=0.3910 head_norm=1.406144
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.446772e-01
[S17] stored merged vector for next round verification (round=8)
[S17] DEBUG after merge:  round=8 metric=0.3909 head_norm=1.442897 delta_norm=0.144677
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=0.760589 cos_to_last_merge=1.0000 (last merge round=8)
[S2] round=9 local utility u=0.161354 metrics={'f1_val': 0.5988342015028602, 'auprc': 0.7263710771528374, 'loss_val': 0.8491980275203385, 'psi': 0.6498489517628511}-{'f1_val': 0.5317784624346037, 'auprc': 0.7779832463577918, 'loss_val': 0.9244082037352801, 'psi': 0.630260376003879}
[S3] START round=9 head_norm_before_train=1.158858 cos_to_last_merge=0.9230 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.923
[S3] round=9 local utility u=0.972001 metrics={'f1_val': 0.5533986052326155, 'auprc': 0.9773149440963103, 'loss_val': 0.6357364595107112, 'psi': 0.7229651407780935}-{'f1_val': 0.401708470248874, 'auprc': 0.7086274662654906, 'loss_val': 0.8635346373117182, 'psi': 0.5244760686555205}
[S4] START round=9 head_norm_before_train=1.134116 cos_to_last_merge=1.0000 (last merge round=8)
[S4] round=9 local utility u=0.139032 metrics={'f1_val': 0.3900755531358374, 'auprc': 0.6645620628841139, 'loss_val': 0.8549934752036041, 'psi': 0.49987015703514803}-{'f1_val': 0.36876656608404657, 'auprc': 0.6522547495086651, 'loss_val': 0.9682818715818785, 'psi': 0.482161839453894}
[S5] START round=9 head_norm_before_train=1.068822 cos_to_last_merge=1.0000 (last merge round=8)
[S5] round=9 local utility u=0.066339 metrics={'f1_val': 0.41991991664853295, 'auprc': 0.7746894974262578, 'loss_val': 1.0085941347630432, 'psi': 0.5618277489596228}-{'f1_val': 0.4177447289106557, 'auprc': 0.7772153407738145, 'loss_val': 1.135797685557924, 'psi': 0.5615329736559193}
[S6] START round=9 head_norm_before_train=1.519105 (no previous merge yet)
[S6] round=9 local utility u=0.000000 metrics={'f1_val': 0.4369650040292425, 'auprc': 0.7791223677257338, 'loss_val': 0.5841858639139502, 'psi': 0.5738279495078391}-{'f1_val': 0.697198293113745, 'auprc': 0.9913455578244534, 'loss_val': 0.47986594306119035, 'psi': 0.8148571989980284}
[S7] START round=9 head_norm_before_train=0.954067 cos_to_last_merge=0.9753 (last merge round=2)
[S7] round=9 local utility u=0.278583 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7773712321697248, 'loss_val': 1.107786537111902, 'psi': 0.39618258650534494}-{'f1_val': 0.14205682272909165, 'auprc': 0.6208631602411231, 'loss_val': 1.1954288426045114, 'psi': 0.33357935773390424}
[S8] START round=9 head_norm_before_train=1.492825 (no previous merge yet)
[S8] round=9 local utility u=0.025954 metrics={'f1_val': 0.3729988868650071, 'auprc': 0.9925303381511639, 'loss_val': 0.6203542011923721, 'psi': 0.6208114673794698}-{'f1_val': 0.3729988868650071, 'auprc': 0.994676215178836, 'loss_val': 0.6786991358838953, 'psi': 0.6216698181905387}
[S9] START round=9 head_norm_before_train=1.052432 cos_to_last_merge=0.9367 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.937
[S9] round=9 local utility u=0.071116 metrics={'f1_val': 0.7018630368647369, 'auprc': 0.998848260143932, 'loss_val': 0.43685438723941944, 'psi': 0.820657126176415}-{'f1_val': 0.7006903481953873, 'auprc': 0.9992363736245115, 'loss_val': 0.5732145045126594, 'psi': 0.820108758367037}
[S10] START round=9 head_norm_before_train=0.675816 cos_to_last_merge=1.0000 (last merge round=8)
[S10] round=9 local utility u=0.666526 metrics={'f1_val': 0.5363897390100467, 'auprc': 0.8494074101841098, 'loss_val': 0.9337400819355668, 'psi': 0.6615968074796719}-{'f1_val': 0.43185577395217745, 'auprc': 0.6445343478868072, 'loss_val': 1.0249687602293434, 'psi': 0.5169272035260293}
[S11] START round=9 head_norm_before_train=0.742083 cos_to_last_merge=1.0000 (last merge round=8)
[S11] round=9 local utility u=0.417968 metrics={'f1_val': 0.5749734097007053, 'auprc': 0.9793296703410288, 'loss_val': 0.7997463155141048, 'psi': 0.7367159139568347}-{'f1_val': 0.42282940561430826, 'auprc': 0.9912118151069839, 'loss_val': 0.7584641995654616, 'psi': 0.6501823694113785}
[S13] START round=9 head_norm_before_train=0.756028 cos_to_last_merge=1.0000 (last merge round=8)
[S13] round=9 local utility u=0.000000 metrics={'f1_val': 0.41580726865236384, 'auprc': 0.6637221622361391, 'loss_val': 0.9259888849730123, 'psi': 0.5149732260858739}-{'f1_val': 0.4160038662657951, 'auprc': 0.7071176198597061, 'loss_val': 0.902135890283148, 'psi': 0.5324493677033595}
[S14] START round=9 head_norm_before_train=1.411714 (no previous merge yet)
[S14] round=9 local utility u=0.209785 metrics={'f1_val': 0.8149452411714226, 'auprc': 0.995193756261908, 'loss_val': 0.5986861080302923, 'psi': 0.8870446472076168}-{'f1_val': 0.7784984653920025, 'auprc': 0.9721158897423167, 'loss_val': 0.730342068959261, 'psi': 0.8559454351321282}
[S15] START round=9 head_norm_before_train=1.299997 cos_to_last_merge=1.0000 (last merge round=8)
[S15] round=9 local utility u=0.079344 metrics={'f1_val': 0.4099936081779312, 'auprc': 0.7998553504628438, 'loss_val': 0.8605651039130965, 'psi': 0.5659383050918962}-{'f1_val': 0.416567672447929, 'auprc': 0.8000456471164703, 'loss_val': 1.0592681541941311, 'psi': 0.5699588623153455}
[S16] START round=9 head_norm_before_train=0.726391 cos_to_last_merge=0.9831 (last merge round=6)
[S16] round=9 local utility u=0.067744 metrics={'f1_val': 0.3852889454065028, 'auprc': 0.7180842573900524, 'loss_val': 0.9151946077799601, 'psi': 0.5184070701999226}-{'f1_val': 0.38455925324324935, 'auprc': 0.69200554403033, 'loss_val': 0.9680690842720323, 'psi': 0.5075377695580816}
[S17] START round=9 head_norm_before_train=1.442897 cos_to_last_merge=1.0000 (last merge round=8)
[S17] round=9 local utility u=0.014985 metrics={'f1_val': 0.38807172766248843, 'auprc': 0.6071934412506036, 'loss_val': 0.848697503038009, 'psi': 0.4757204130977345}-{'f1_val': 0.39095641073037735, 'auprc': 0.6130511644694474, 'loss_val': 0.9135491704737811, 'psi': 0.4797943122260054}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S5] → sending delta(kind=head bytes=1791) to S10@127.0.0.1:31611
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:31617
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S2] → sending delta(kind=head bytes=1788) to S11@127.0.0.1:31612
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:31613
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S16] → sending delta(kind=head bytes=1791) to S2@127.0.0.1:31602
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] → sending delta(kind=head bytes=1792) to S10@127.0.0.1:31611
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S17@127.0.0.1:31617
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:31616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] → sending delta(kind=head bytes=1792) to S4@127.0.0.1:31604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:31609
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:31605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:31615
[S10] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1791 to 1 peers)
[S8] sending update (kind=head size=1793 to 1 peers)
[S4] sending update (kind=head size=1794 to 1 peers)
[S7] sending update (kind=head size=1795 to 1 peers)
[S9] sending update (kind=head size=1792 to 1 peers)
[S5] sending update (kind=head size=1791 to 1 peers)
[S2] sending update (kind=head size=1788 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1792 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1796) from S11
[S13] cosine check vs S11: cos=0.8235
[S10] RECEIVED delta(kind=head bytes=1792) from S15
[S10] cosine check vs S15: cos=0.7579
[S8] RECEIVED delta(kind=head bytes=1800) from S3
[S8] cosine check vs S3: cos=-0.0709
[S8] DROPPED delta from S3 (cos=-0.0709 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1792) from S9
[S4] cosine check vs S9: cos=0.8019
[S5] RECEIVED delta(kind=head bytes=1794) from S4
[S5] cosine check vs S4: cos=0.2036
[S2] RECEIVED delta(kind=head bytes=1791) from S16
[S2] cosine check vs S16: cos=0.9623
[S10] RECEIVED delta(kind=head bytes=1791) from S5
[S10] cosine check vs S5: cos=0.5751
[S17] RECEIVED delta(kind=head bytes=1795) from S7
[S17] cosine check vs S7: cos=-0.0195
[S17] DROPPED delta from S7 (cos=-0.0195 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1799) from S14
[S15] cosine check vs S14: cos=0.9874
[S11] RECEIVED delta(kind=head bytes=1788) from S2
[S11] cosine check vs S2: cos=0.7723
[S16] RECEIVED delta(kind=head bytes=1798) from S10
[S16] cosine check vs S10: cos=0.3964
[S17] RECEIVED delta(kind=head bytes=1793) from S8
[S17] cosine check vs S8: cos=0.9866
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:31605
[S17] sending update (kind=head size=1800 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1800) from S17
[S5] cosine check vs S17: cos=0.9713
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=9 metric=0.3901 head_norm=1.166748
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.587041e-01
[S4] stored merged vector for next round verification (round=9)
[S4] DEBUG after merge:  round=9 metric=0.3763 head_norm=1.078391 delta_norm=0.358704
[S4] aggregate: ROLLBACK (f1_val pre=0.390 post=0.376 tol_abs=0.005 tol_rel=0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=9 metric=0.5988 head_norm=0.811221
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.103624e-01
[S2] stored merged vector for next round verification (round=9)
[S2] DEBUG after merge:  round=9 metric=0.5885 head_norm=0.792036 delta_norm=0.110362
[S2] aggregate: ROLLBACK (f1_val pre=0.599 post=0.589 tol_abs=0.005 tol_rel=0.0)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=9 metric=0.4158 head_norm=0.797658
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.365192e-01
[S13] stored merged vector for next round verification (round=9)
[S13] DEBUG after merge:  round=9 metric=0.4158 head_norm=0.760183 delta_norm=0.236519
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=9 metric=0.3853 head_norm=0.787987
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.105992e-01
[S16] stored merged vector for next round verification (round=9)
[S16] DEBUG after merge:  round=9 metric=0.3855 head_norm=0.622568 delta_norm=0.410599
[S16] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=9 metric=0.4100 head_norm=1.325613
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.307882e-01
[S15] stored merged vector for next round verification (round=9)
[S15] DEBUG after merge:  round=9 metric=0.5909 head_norm=1.390991 delta_norm=0.130788
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=9 metric=0.4199 head_norm=1.086341
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.998065e-01
[S5] stored merged vector for next round verification (round=9)
[S5] DEBUG after merge:  round=9 metric=0.4191 head_norm=0.998010 delta_norm=0.299807
[S5] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=9 metric=0.5750 head_norm=0.794595
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.710088e-01
[S11] stored merged vector for next round verification (round=9)
[S11] DEBUG after merge:  round=9 metric=0.6005 head_norm=0.755834 delta_norm=0.271009
[S11] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=9 metric=0.5364 head_norm=0.701029
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.646750e-01
[S10] stored merged vector for next round verification (round=9)
[S10] DEBUG after merge:  round=9 metric=0.3561 head_norm=0.773491 delta_norm=0.164675
[S10] aggregate: ROLLBACK (f1_val pre=0.536 post=0.356 tol_abs=0.005 tol_rel=0.0)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=9 metric=0.3881 head_norm=1.472961
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.280312e-01
[S17] stored merged vector for next round verification (round=9)
[S17] DEBUG after merge:  round=9 metric=0.3866 head_norm=1.501734 delta_norm=0.128031
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=0.792036 cos_to_last_merge=1.0000 (last merge round=9)
[S2] round=10 local utility u=0.000000 metrics={'f1_val': 0.5317819370876925, 'auprc': 0.762574233271746, 'loss_val': 0.8058228871698379, 'psi': 0.624098855561314}-{'f1_val': 0.5988342015028602, 'auprc': 0.7263710771528374, 'loss_val': 0.8491980275203385, 'psi': 0.6498489517628511}
[S3] START round=10 head_norm_before_train=1.206953 cos_to_last_merge=0.9071 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.907
[S3] round=10 local utility u=0.178041 metrics={'f1_val': 0.5941798333554178, 'auprc': 0.9902934209143914, 'loss_val': 0.563276743622042, 'psi': 0.7526252683790073}-{'f1_val': 0.5533986052326155, 'auprc': 0.9773149440963103, 'loss_val': 0.6357364595107112, 'psi': 0.7229651407780935}
[S4] START round=10 head_norm_before_train=1.078391 cos_to_last_merge=1.0000 (last merge round=9)
[S4] round=10 local utility u=0.202599 metrics={'f1_val': 0.42436097724279304, 'auprc': 0.729681441890214, 'loss_val': 0.8508661969135131, 'psi': 0.5464891631017614}-{'f1_val': 0.3900755531358374, 'auprc': 0.6645620628841139, 'loss_val': 0.8549934752036041, 'psi': 0.49987015703514803}
[S5] START round=10 head_norm_before_train=0.998010 cos_to_last_merge=1.0000 (last merge round=9)
[S5] round=10 local utility u=0.780428 metrics={'f1_val': 0.7013925828644838, 'auprc': 0.700542292829192, 'loss_val': 0.9141334854573018, 'psi': 0.701052466850367}-{'f1_val': 0.41991991664853295, 'auprc': 0.7746894974262578, 'loss_val': 1.0085941347630432, 'psi': 0.5618277489596228}
[S6] START round=10 head_norm_before_train=1.558990 (no previous merge yet)
[S6] round=10 local utility u=1.000000 metrics={'f1_val': 0.707833422004247, 'auprc': 0.9616584605259613, 'loss_val': 0.3368043341294473, 'psi': 0.8093634374129328}-{'f1_val': 0.4369650040292425, 'auprc': 0.7791223677257338, 'loss_val': 0.5841858639139502, 'psi': 0.5738279495078391}
[S7] START round=10 head_norm_before_train=0.982638 cos_to_last_merge=0.9660 (last merge round=2)
[S7] round=10 local utility u=0.805435 metrics={'f1_val': 0.4170778520170104, 'auprc': 0.7334973114188446, 'loss_val': 1.0154209192664123, 'psi': 0.5436456357777442}-{'f1_val': 0.14205682272909165, 'auprc': 0.7773712321697248, 'loss_val': 1.107786537111902, 'psi': 0.39618258650534494}
[S8] START round=10 head_norm_before_train=1.540643 (no previous merge yet)
[S8] round=10 local utility u=1.000000 metrics={'f1_val': 0.713916700902738, 'auprc': 0.9948893357289247, 'loss_val': 0.4261168568448968, 'psi': 0.8263057548332127}-{'f1_val': 0.3729988868650071, 'auprc': 0.9925303381511639, 'loss_val': 0.6203542011923721, 'psi': 0.6208114673794698}
[S9] START round=10 head_norm_before_train=1.105391 cos_to_last_merge=0.9183 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.918
[S9] round=10 local utility u=0.038282 metrics={'f1_val': 0.7015406642019387, 'auprc': 0.9988179869671062, 'loss_val': 0.3582649901645834, 'psi': 0.8204515933080057}-{'f1_val': 0.7018630368647369, 'auprc': 0.998848260143932, 'loss_val': 0.43685438723941944, 'psi': 0.820657126176415}
[S10] START round=10 head_norm_before_train=0.773491 cos_to_last_merge=1.0000 (last merge round=9)
[S10] round=10 local utility u=0.346321 metrics={'f1_val': 0.6304622581254472, 'auprc': 0.8610328734202218, 'loss_val': 0.8404087242695909, 'psi': 0.7226905042433571}-{'f1_val': 0.5363897390100467, 'auprc': 0.8494074101841098, 'loss_val': 0.9337400819355668, 'psi': 0.6615968074796719}
[S11] START round=10 head_norm_before_train=0.755834 cos_to_last_merge=1.0000 (last merge round=9)
[S11] round=10 local utility u=0.000000 metrics={'f1_val': 0.4687708814288873, 'auprc': 0.9166963094525757, 'loss_val': 0.8438691850334862, 'psi': 0.6479410526383627}-{'f1_val': 0.5749734097007053, 'auprc': 0.9793296703410288, 'loss_val': 0.7997463155141048, 'psi': 0.7367159139568347}
[S13] START round=10 head_norm_before_train=0.760183 cos_to_last_merge=1.0000 (last merge round=9)
[S13] round=10 local utility u=0.000000 metrics={'f1_val': 0.41580726865236384, 'auprc': 0.6600458370520534, 'loss_val': 0.921754973910026, 'psi': 0.5135026960122396}-{'f1_val': 0.41580726865236384, 'auprc': 0.6637221622361391, 'loss_val': 0.9259888849730123, 'psi': 0.5149732260858739}
[S14] START round=10 head_norm_before_train=1.465153 (no previous merge yet)
[S14] round=10 local utility u=0.612627 metrics={'f1_val': 0.9968416569831653, 'auprc': 0.9968150194742884, 'loss_val': 0.4696750683049792, 'psi': 0.9968310019796145}-{'f1_val': 0.8149452411714226, 'auprc': 0.995193756261908, 'loss_val': 0.5986861080302923, 'psi': 0.8870446472076168}
[S15] START round=10 head_norm_before_train=1.390991 cos_to_last_merge=1.0000 (last merge round=9)
[S15] round=10 local utility u=0.073902 metrics={'f1_val': 0.41691903018686227, 'auprc': 0.7997815180355368, 'loss_val': 0.7540929359656013, 'psi': 0.570064025326332}-{'f1_val': 0.4099936081779312, 'auprc': 0.7998553504628438, 'loss_val': 0.8605651039130965, 'psi': 0.5659383050918962}
[S16] START round=10 head_norm_before_train=0.622568 cos_to_last_merge=1.0000 (last merge round=9)
[S16] round=10 local utility u=0.000000 metrics={'f1_val': 0.3870058425696853, 'auprc': 0.5468188858833094, 'loss_val': 0.9212720153169576, 'psi': 0.45093105989513493}-{'f1_val': 0.3852889454065028, 'auprc': 0.7180842573900524, 'loss_val': 0.9151946077799601, 'psi': 0.5184070701999226}
[S17] START round=10 head_norm_before_train=1.501734 cos_to_last_merge=1.0000 (last merge round=9)
[S17] round=10 local utility u=0.041692 metrics={'f1_val': 0.38913316153193367, 'auprc': 0.6170667652575894, 'loss_val': 0.801302216738009, 'psi': 0.48030660302219597}-{'f1_val': 0.38807172766248843, 'auprc': 0.6071934412506036, 'loss_val': 0.848697503038009, 'psi': 0.4757204130977345}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:31605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:31609
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:31604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S5] → sending delta(kind=head bytes=1790) to S10@127.0.0.1:31611
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:31604
[S6] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1790 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1790) from S5
[S10] cosine check vs S5: cos=0.5736
[S4] RECEIVED delta(kind=head bytes=1800) from S9
[S4] cosine check vs S9: cos=0.9210
[S8] RECEIVED delta(kind=head bytes=1796) from S3
[S8] cosine check vs S3: cos=-0.0712
[S8] DROPPED delta from S3 (cos=-0.0712 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1797) from S4
[S5] cosine check vs S4: cos=0.4123
[S4] RECEIVED delta(kind=head bytes=1796) from S6
[S4] cosine check vs S6: cos=0.8150
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:31617
[S7] sending update (kind=head size=1798 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1798) from S7
[S17] cosine check vs S7: cos=-0.0151
[S17] DROPPED delta from S7 (cos=-0.0151 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:31611
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:31617
[S10] RECEIVED delta(kind=head bytes=1798) from S15
[S10] cosine check vs S15: cos=0.7606
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:31615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:31616
[S8] sending update (kind=head size=1797 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1797) from S8
[S17] cosine check vs S8: cos=0.9893
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:31605
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1801) from S14
[S15] cosine check vs S14: cos=0.9898
[S17] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1795) from S10
[S16] cosine check vs S10: cos=0.7468
[S5] RECEIVED delta(kind=head bytes=1797) from S17
[S5] cosine check vs S17: cos=0.9248
[S2] ⇄ pheromone p=0.301 → S11@127.0.0.1:31612
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=10 metric=0.4244 head_norm=1.112738
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.689102e-01
[S4] stored merged vector for next round verification (round=10)
[S4] DEBUG after merge:  round=10 metric=0.4215 head_norm=1.160123 delta_norm=0.168910
[S4] aggregate: ACCEPT kept=['S9', 'S6'] (k=2/2) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.276 → S5@127.0.0.1:31605
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=10 metric=0.7014 head_norm=1.021664
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.713891e-01
[S5] stored merged vector for next round verification (round=10)
[S5] DEBUG after merge:  round=10 metric=0.7014 head_norm=0.992676 delta_norm=0.171389
[S5] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.418 → S10@127.0.0.1:31611
[S3] ⇄ pheromone p=0.381 → S8@127.0.0.1:31609
[S6] ⇄ pheromone p=0.537 → S4@127.0.0.1:31604
[S7] ⇄ pheromone p=0.322 → S17@127.0.0.1:31617
[S9] ⇄ pheromone p=0.248 → S4@127.0.0.1:31604
[S11] ⇄ pheromone p=0.294 → S13@127.0.0.1:31613
[S8] ⇄ pheromone p=0.448 → S17@127.0.0.1:31617
[S14] ⇄ pheromone p=0.498 → S15@127.0.0.1:31615
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=10 metric=0.4169 head_norm=1.417999
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.143176e-01
[S15] stored merged vector for next round verification (round=10)
[S15] DEBUG after merge:  round=10 metric=0.6386 head_norm=1.460391 delta_norm=0.114318
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.269 → S10@127.0.0.1:31611
[S13] ⇄ pheromone p=0.264 → S5@127.0.0.1:31605
[S10] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=10 metric=0.6305 head_norm=0.801049
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.358161e-01
[S10] stored merged vector for next round verification (round=10)
[S10] DEBUG after merge:  round=10 metric=0.3198 head_norm=0.827734 delta_norm=0.135816
[S10] aggregate: ROLLBACK (f1_val pre=0.630 post=0.320 tol_abs=0.005 tol_rel=0.0)
[S10] ⇄ pheromone p=0.355 → S16@127.0.0.1:31616
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=10 metric=0.3870 head_norm=0.681015
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.695650e-01
[S16] stored merged vector for next round verification (round=10)
[S16] DEBUG after merge:  round=10 metric=0.6577 head_norm=0.692868 delta_norm=0.269565
[S16] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.207 → S2@127.0.0.1:31602
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=10 metric=0.3891 head_norm=1.527662
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.170568e-01
[S17] stored merged vector for next round verification (round=10)
[S17] DEBUG after merge:  round=10 metric=0.3869 head_norm=1.550526 delta_norm=0.117057
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.234 → S5@127.0.0.1:31605
[S2] START round=11 head_norm_before_train=0.845864 cos_to_last_merge=0.9954 (last merge round=9)
[S2] round=11 local utility u=0.000000 metrics={'f1_val': 0.5532063155398316, 'auprc': 0.6855779591885032, 'loss_val': 0.7155181276378407, 'psi': 0.6061549729993002}-{'f1_val': 0.5317819370876925, 'auprc': 0.762574233271746, 'loss_val': 0.8058228871698379, 'psi': 0.624098855561314}
[S3] START round=11 head_norm_before_train=1.246593 cos_to_last_merge=0.8942 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.894
[S3] round=11 local utility u=0.196511 metrics={'f1_val': 0.6423099435964327, 'auprc': 0.9941695039560523, 'loss_val': 0.47066458791748234, 'psi': 0.7830537677402805}-{'f1_val': 0.5941798333554178, 'auprc': 0.9902934209143914, 'loss_val': 0.563276743622042, 'psi': 0.7526252683790073}
[S4] START round=11 head_norm_before_train=1.160123 cos_to_last_merge=1.0000 (last merge round=10)
[S4] round=11 local utility u=0.128030 metrics={'f1_val': 0.37514966985930454, 'auprc': 0.876132766793377, 'loss_val': 0.738891940372911, 'psi': 0.5755429086329336}-{'f1_val': 0.42436097724279304, 'auprc': 0.729681441890214, 'loss_val': 0.8508661969135131, 'psi': 0.5464891631017614}
[S5] START round=11 head_norm_before_train=0.992676 cos_to_last_merge=1.0000 (last merge round=10)
[S5] round=11 local utility u=0.002042 metrics={'f1_val': 0.7011046720655897, 'auprc': 0.6658674883779603, 'loss_val': 0.8042982921841089, 'psi': 0.6870097985905379}-{'f1_val': 0.7013925828644838, 'auprc': 0.700542292829192, 'loss_val': 0.9141334854573018, 'psi': 0.701052466850367}
[S6] START round=11 head_norm_before_train=1.594166 (no previous merge yet)
[S6] round=11 local utility u=0.000000 metrics={'f1_val': 0.6930212177158614, 'auprc': 0.8230902757538302, 'loss_val': 0.39308178588975046, 'psi': 0.745048840931049}-{'f1_val': 0.707833422004247, 'auprc': 0.9616584605259613, 'loss_val': 0.3368043341294473, 'psi': 0.8093634374129328}
[S7] START round=11 head_norm_before_train=1.011460 cos_to_last_merge=0.9553 (last merge round=2)
[S7] round=11 local utility u=0.419196 metrics={'f1_val': 0.6259406537111445, 'auprc': 0.5754084360982366, 'loss_val': 0.9559388830069486, 'psi': 0.6057277666659813}-{'f1_val': 0.4170778520170104, 'auprc': 0.7334973114188446, 'loss_val': 1.0154209192664123, 'psi': 0.5436456357777442}
[S8] START round=11 head_norm_before_train=1.581745 (no previous merge yet)
[S8] round=11 local utility u=0.074543 metrics={'f1_val': 0.7139807753193125, 'auprc': 0.9961377764147573, 'loss_val': 0.28116044729138095, 'psi': 0.8268435757574903}-{'f1_val': 0.713916700902738, 'auprc': 0.9948893357289247, 'loss_val': 0.4261168568448968, 'psi': 0.8263057548332127}
[S9] START round=11 head_norm_before_train=1.160216 cos_to_last_merge=0.8996 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.900
[S9] round=11 local utility u=0.011992 metrics={'f1_val': 0.6995537415701327, 'auprc': 0.9988182079443324, 'loss_val': 0.3223593889980983, 'psi': 0.8192595281198126}-{'f1_val': 0.7015406642019387, 'auprc': 0.9988179869671062, 'loss_val': 0.3582649901645834, 'psi': 0.8204515933080057}
[S10] START round=11 head_norm_before_train=0.827734 cos_to_last_merge=1.0000 (last merge round=10)
[S10] round=11 local utility u=0.012749 metrics={'f1_val': 0.6375695446890719, 'auprc': 0.8312291193526186, 'loss_val': 0.7681435601952589, 'psi': 0.7150333745544906}-{'f1_val': 0.6304622581254472, 'auprc': 0.8610328734202218, 'loss_val': 0.8404087242695909, 'psi': 0.7226905042433571}
[S11] START round=11 head_norm_before_train=0.799295 cos_to_last_merge=0.9904 (last merge round=9)
[S11] round=11 local utility u=0.918967 metrics={'f1_val': 0.7018246587012323, 'auprc': 0.9946410053816866, 'loss_val': 0.6380920773121942, 'psi': 0.818951197373414}-{'f1_val': 0.4687708814288873, 'auprc': 0.9166963094525757, 'loss_val': 0.8438691850334862, 'psi': 0.6479410526383627}
[S13] START round=11 head_norm_before_train=0.804668 cos_to_last_merge=0.9923 (last merge round=9)
[S13] round=11 local utility u=0.886547 metrics={'f1_val': 0.6874761564351299, 'auprc': 0.6720681778043751, 'loss_val': 0.814741873216394, 'psi': 0.681312964982828}-{'f1_val': 0.41580726865236384, 'auprc': 0.6600458370520534, 'loss_val': 0.921754973910026, 'psi': 0.5135026960122396}
[S14] START round=11 head_norm_before_train=1.510265 (no previous merge yet)
[S14] round=11 local utility u=0.000000 metrics={'f1_val': 0.9672869600255362, 'auprc': 0.9967934480399939, 'loss_val': 0.34312069820708324, 'psi': 0.9790895552313192}-{'f1_val': 0.9968416569831653, 'auprc': 0.9968150194742884, 'loss_val': 0.4696750683049792, 'psi': 0.9968310019796145}
[S15] START round=11 head_norm_before_train=1.460391 cos_to_last_merge=1.0000 (last merge round=10)
[S15] round=11 local utility u=0.960243 metrics={'f1_val': 0.6280374003143164, 'auprc': 0.9854478791020321, 'loss_val': 0.6573154610312044, 'psi': 0.7710015918294026}-{'f1_val': 0.41691903018686227, 'auprc': 0.7997815180355368, 'loss_val': 0.7540929359656013, 'psi': 0.570064025326332}
[S16] START round=11 head_norm_before_train=0.692868 cos_to_last_merge=1.0000 (last merge round=10)
[S16] round=11 local utility u=0.114022 metrics={'f1_val': 0.4244450259212008, 'auprc': 0.5507395060929309, 'loss_val': 0.9296252490929124, 'psi': 0.4749628179898928}-{'f1_val': 0.3870058425696853, 'auprc': 0.5468188858833094, 'loss_val': 0.9212720153169576, 'psi': 0.45093105989513493}
[S17] START round=11 head_norm_before_train=1.550526 cos_to_last_merge=1.0000 (last merge round=10)
[S17] round=11 local utility u=0.166272 metrics={'f1_val': 0.3951773136572043, 'auprc': 0.7030796642464221, 'loss_val': 0.7630623179535841, 'psi': 0.5183382538928915}-{'f1_val': 0.38913316153193367, 'auprc': 0.6170667652575894, 'loss_val': 0.801302216738009, 'psi': 0.48030660302219597}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:31611
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:31605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:31617
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:31613
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:31604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:31611
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:31605
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:31609
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] → sending delta(kind=head bytes=1794) to S17@127.0.0.1:31617
[S11] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1794 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1800) from S5
[S10] cosine check vs S5: cos=0.5556
[S5] RECEIVED delta(kind=head bytes=1800) from S13
[S5] cosine check vs S13: cos=0.0435
[S8] RECEIVED delta(kind=head bytes=1799) from S3
[S8] cosine check vs S3: cos=-0.0712
[S8] DROPPED delta from S3 (cos=-0.0712 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1795) from S9
[S4] cosine check vs S9: cos=0.8688
[S13] RECEIVED delta(kind=head bytes=1798) from S11
[S13] cosine check vs S11: cos=0.8584
[S17] RECEIVED delta(kind=head bytes=1794) from S7
[S17] cosine check vs S7: cos=-0.0108
[S17] DROPPED delta from S7 (cos=-0.0108 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1798) from S4
[S5] cosine check vs S4: cos=0.5180
[S17] RECEIVED delta(kind=head bytes=1798) from S8
[S17] cosine check vs S8: cos=0.9914
[S10] RECEIVED delta(kind=head bytes=1798) from S15
[S10] cosine check vs S15: cos=0.7795
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:31602
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:31605
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] sending update (kind=head size=1801 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1801) from S17
[S5] cosine check vs S17: cos=0.8842
[S2] RECEIVED delta(kind=head bytes=1798) from S16
[S2] cosine check vs S16: cos=0.6498
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S10] → sending delta(kind=head bytes=1789) to S16@127.0.0.1:31616
[S10] sending update (kind=head size=1789 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1789) from S10
[S16] cosine check vs S10: cos=0.8932
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=11 metric=0.3751 head_norm=1.201251
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.089154e-01
[S4] stored merged vector for next round verification (round=11)
[S4] DEBUG after merge:  round=11 metric=0.4007 head_norm=1.165917 delta_norm=0.308915
[S4] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=11 metric=0.6875 head_norm=0.860429
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.290041e-01
[S13] stored merged vector for next round verification (round=11)
[S13] DEBUG after merge:  round=11 metric=0.4158 head_norm=0.829637 delta_norm=0.229004
[S13] aggregate: ROLLBACK (f1_val pre=0.687 post=0.416 tol_abs=0.005 tol_rel=0.0)
[S10] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=11 metric=0.6376 head_norm=0.857566
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.266098e-01
[S10] stored merged vector for next round verification (round=11)
[S10] DEBUG after merge:  round=11 metric=0.4464 head_norm=0.870200 delta_norm=0.126610
[S10] aggregate: ROLLBACK (f1_val pre=0.638 post=0.446 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=11 metric=0.4244 head_norm=0.747256
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.930685e-01
[S16] stored merged vector for next round verification (round=11)
[S16] DEBUG after merge:  round=11 metric=0.1590 head_norm=0.780788 delta_norm=0.193069
[S16] aggregate: ROLLBACK (f1_val pre=0.424 post=0.159 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=11 metric=0.7011 head_norm=1.019160
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.848639e-01
[S5] stored merged vector for next round verification (round=11)
[S5] DEBUG after merge:  round=11 metric=0.7011 head_norm=0.824362 delta_norm=0.284864
[S5] aggregate: ACCEPT kept=['S13', 'S4', 'S17'] (k=3/3) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=11 metric=0.5532 head_norm=0.901598
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.520065e-01
[S2] stored merged vector for next round verification (round=11)
[S2] DEBUG after merge:  round=11 metric=0.5739 head_norm=0.749484 delta_norm=0.352007
[S2] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=11 metric=0.3952 head_norm=1.573781
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.067437e-01
[S17] stored merged vector for next round verification (round=11)
[S17] DEBUG after merge:  round=11 metric=0.3915 head_norm=1.590910 delta_norm=0.106744
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=0.749484 cos_to_last_merge=1.0000 (last merge round=11)
[S2] round=12 local utility u=0.562850 metrics={'f1_val': 0.7069532048410194, 'auprc': 0.7526947896360765, 'loss_val': 0.7136505740903005, 'psi': 0.7252498387590423}-{'f1_val': 0.5532063155398316, 'auprc': 0.6855779591885032, 'loss_val': 0.7155181276378407, 'psi': 0.6061549729993002}
[S3] START round=12 head_norm_before_train=1.281787 cos_to_last_merge=0.8836 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.884
[S3] round=12 local utility u=0.023635 metrics={'f1_val': 0.6458201896343078, 'auprc': 0.9940611635373903, 'loss_val': 0.4441306257960551, 'psi': 0.7851165791955408}-{'f1_val': 0.6423099435964327, 'auprc': 0.9941695039560523, 'loss_val': 0.47066458791748234, 'psi': 0.7830537677402805}
[S4] START round=12 head_norm_before_train=1.165917 cos_to_last_merge=1.0000 (last merge round=11)
[S4] round=12 local utility u=0.226174 metrics={'f1_val': 0.44788760515127324, 'auprc': 0.8702075818889626, 'loss_val': 0.7051956997071768, 'psi': 0.616815595846349}-{'f1_val': 0.37514966985930454, 'auprc': 0.876132766793377, 'loss_val': 0.738891940372911, 'psi': 0.5755429086329336}
[S5] START round=12 head_norm_before_train=0.824362 cos_to_last_merge=1.0000 (last merge round=11)
[S5] round=12 local utility u=0.186914 metrics={'f1_val': 0.7146935597656502, 'auprc': 0.7776562439697686, 'loss_val': 0.8473690156314626, 'psi': 0.7398786334472975}-{'f1_val': 0.7011046720655897, 'auprc': 0.6658674883779603, 'loss_val': 0.8042982921841089, 'psi': 0.6870097985905379}
[S6] START round=12 head_norm_before_train=1.625096 (no previous merge yet)
[S6] round=12 local utility u=1.000000 metrics={'f1_val': 0.9549951619067687, 'auprc': 0.9537373102876326, 'loss_val': 0.3011167312280879, 'psi': 0.9544920212591144}-{'f1_val': 0.6930212177158614, 'auprc': 0.8230902757538302, 'loss_val': 0.39308178588975046, 'psi': 0.745048840931049}
[S7] START round=12 head_norm_before_train=1.047977 cos_to_last_merge=0.9410 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.941
[S7] round=12 local utility u=0.664825 metrics={'f1_val': 0.7144974922643522, 'auprc': 0.7943965067284566, 'loss_val': 0.8145931736544014, 'psi': 0.746457098049994}-{'f1_val': 0.6259406537111445, 'auprc': 0.5754084360982366, 'loss_val': 0.9559388830069486, 'psi': 0.6057277666659813}
[S8] START round=12 head_norm_before_train=1.614928 (no previous merge yet)
[S8] round=12 local utility u=0.028117 metrics={'f1_val': 0.7153020232295868, 'auprc': 0.9977162610662063, 'loss_val': 0.23758872084592011, 'psi': 0.8282677183642346}-{'f1_val': 0.7139807753193125, 'auprc': 0.9961377764147573, 'loss_val': 0.28116044729138095, 'psi': 0.8268435757574903}
[S9] START round=12 head_norm_before_train=1.211025 cos_to_last_merge=0.8826 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.883
[S9] round=12 local utility u=0.019469 metrics={'f1_val': 0.7015406642019387, 'auprc': 0.9988052393656333, 'loss_val': 0.29530344474870784, 'psi': 0.8204464942674166}-{'f1_val': 0.6995537415701327, 'auprc': 0.9988182079443324, 'loss_val': 0.3223593889980983, 'psi': 0.8192595281198126}
[S10] START round=12 head_norm_before_train=0.870200 cos_to_last_merge=1.0000 (last merge round=11)
[S10] round=12 local utility u=0.423660 metrics={'f1_val': 0.7005778313860114, 'auprc': 0.949767361330437, 'loss_val': 0.6544871855804287, 'psi': 0.8002536433637817}-{'f1_val': 0.6375695446890719, 'auprc': 0.8312291193526186, 'loss_val': 0.7681435601952589, 'psi': 0.7150333745544906}
[S11] START round=12 head_norm_before_train=0.860896 cos_to_last_merge=0.9672 (last merge round=9)
[S11] round=12 local utility u=0.081170 metrics={'f1_val': 0.7017589383281313, 'auprc': 0.9960644708615083, 'loss_val': 0.4796289996545295, 'psi': 0.8194811513414821}-{'f1_val': 0.7018246587012323, 'auprc': 0.9946410053816866, 'loss_val': 0.6380920773121942, 'psi': 0.818951197373414}
[S13] START round=12 head_norm_before_train=0.829637 cos_to_last_merge=1.0000 (last merge round=11)
[S13] round=12 local utility u=0.000000 metrics={'f1_val': 0.6645694732264259, 'auprc': 0.6986857692084771, 'loss_val': 0.7783966265400953, 'psi': 0.6782159916192464}-{'f1_val': 0.6874761564351299, 'auprc': 0.6720681778043751, 'loss_val': 0.814741873216394, 'psi': 0.681312964982828}
[S14] START round=12 head_norm_before_train=1.548051 (no previous merge yet)
[S14] round=12 local utility u=0.123678 metrics={'f1_val': 0.9980847028057478, 'auprc': 0.9957252935512118, 'loss_val': 0.27734625794808676, 'psi': 0.9971409391039333}-{'f1_val': 0.9672869600255362, 'auprc': 0.9967934480399939, 'loss_val': 0.34312069820708324, 'psi': 0.9790895552313192}
[S15] START round=12 head_norm_before_train=1.491162 cos_to_last_merge=0.9987 (last merge round=10)
[S15] round=12 local utility u=0.014455 metrics={'f1_val': 0.7012610101523403, 'auprc': 0.8385296504935444, 'loss_val': 0.6269921483209993, 'psi': 0.756168466288822}-{'f1_val': 0.6280374003143164, 'auprc': 0.9854478791020321, 'loss_val': 0.6573154610312044, 'psi': 0.7710015918294026}
[S16] START round=12 head_norm_before_train=0.780788 cos_to_last_merge=1.0000 (last merge round=11)
[S16] round=12 local utility u=0.008698 metrics={'f1_val': 0.41937432571049194, 'auprc': 0.5595695819165125, 'loss_val': 0.9082960928646215, 'psi': 0.4754524281929002}-{'f1_val': 0.4244450259212008, 'auprc': 0.5507395060929309, 'loss_val': 0.9296252490929124, 'psi': 0.4749628179898928}
[S17] START round=12 head_norm_before_train=1.590910 cos_to_last_merge=1.0000 (last merge round=11)
[S17] round=12 local utility u=0.241976 metrics={'f1_val': 0.41729424900056306, 'auprc': 0.8024196838283006, 'loss_val': 0.7098311177977211, 'psi': 0.5713444229316581}-{'f1_val': 0.3951773136572043, 'auprc': 0.7030796642464221, 'loss_val': 0.7630623179535841, 'psi': 0.5183382538928915}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S7] → sending delta(kind=head bytes=1793) to S17@127.0.0.1:31617
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:31605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:31612
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:31609
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S5] → sending delta(kind=head bytes=1789) to S10@127.0.0.1:31611
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:31617
[S3] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1789 to 1 peers)
[S7] sending update (kind=head size=1793 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1789) from S5
[S10] cosine check vs S5: cos=0.5366
[S8] RECEIVED delta(kind=head bytes=1802) from S3
[S8] cosine check vs S3: cos=-0.0716
[S8] DROPPED delta from S3 (cos=-0.0716 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1799) from S2
[S11] cosine check vs S2: cos=0.6834
[S17] RECEIVED delta(kind=head bytes=1793) from S7
[S17] cosine check vs S7: cos=-0.0072
[S17] DROPPED delta from S7 (cos=-0.0072 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1802) from S4
[S5] cosine check vs S4: cos=0.5521
[S17] RECEIVED delta(kind=head bytes=1798) from S8
[S17] cosine check vs S8: cos=0.9935
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S10] → sending delta(kind=head bytes=1789) to S16@127.0.0.1:31616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:31604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:31604
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1789 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1797) from S9
[S4] cosine check vs S9: cos=0.9493
[S4] RECEIVED delta(kind=head bytes=1801) from S6
[S4] cosine check vs S6: cos=0.7507
[S16] RECEIVED delta(kind=head bytes=1789) from S10
[S16] cosine check vs S10: cos=0.9332
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:31613
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1798) from S11
[S13] cosine check vs S11: cos=0.9365
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] → sending delta(kind=head bytes=1794) to S2@127.0.0.1:31602
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] → sending delta(kind=head bytes=1805) to S5@127.0.0.1:31605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:31611
[S17] sending update (kind=head size=1805 to 1 peers)
[S16] sending update (kind=head size=1794 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1801) from S15
[S10] cosine check vs S15: cos=0.8034
[S5] RECEIVED delta(kind=head bytes=1805) from S17
[S5] cosine check vs S17: cos=0.8096
[S2] RECEIVED delta(kind=head bytes=1794) from S16
[S2] cosine check vs S16: cos=0.8027
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:31615
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1800) from S14
[S15] cosine check vs S14: cos=0.9860
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=12 metric=0.4479 head_norm=1.209996
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.104415e-01
[S4] stored merged vector for next round verification (round=12)
[S4] DEBUG after merge:  round=12 metric=0.4476 head_norm=1.230896 delta_norm=0.210442
[S4] aggregate: ACCEPT kept=['S9', 'S6'] (k=2/2) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=12 metric=0.7070 head_norm=0.803060
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.571258e-01
[S2] stored merged vector for next round verification (round=12)
[S2] DEBUG after merge:  round=12 metric=0.7076 head_norm=0.776153 delta_norm=0.257126
[S2] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=12 metric=0.7147 head_norm=0.852235
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.867043e-01
[S5] stored merged vector for next round verification (round=12)
[S5] DEBUG after merge:  round=12 metric=0.7147 head_norm=0.936439 delta_norm=0.186704
[S5] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S10] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=12 metric=0.7006 head_norm=0.902836
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.172592e-01
[S10] stored merged vector for next round verification (round=12)
[S10] DEBUG after merge:  round=12 metric=0.7006 head_norm=0.879224 delta_norm=0.117259
[S10] aggregate: ACCEPT kept=['S5', 'S15'] (k=2/2) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=12 metric=0.6646 head_norm=0.870594
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.634049e-01
[S13] stored merged vector for next round verification (round=12)
[S13] DEBUG after merge:  round=12 metric=0.7007 head_norm=0.886890 delta_norm=0.163405
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=12 metric=0.7018 head_norm=0.931997
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.501969e-01
[S11] stored merged vector for next round verification (round=12)
[S11] DEBUG after merge:  round=12 metric=0.6656 head_norm=0.796319 delta_norm=0.350197
[S11] aggregate: ROLLBACK (f1_val pre=0.702 post=0.666 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=12 metric=0.7013 head_norm=1.524458
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.326092e-01
[S15] stored merged vector for next round verification (round=12)
[S15] DEBUG after merge:  round=12 metric=0.6964 head_norm=1.546467 delta_norm=0.132609
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=12 metric=0.4173 head_norm=1.615739
[S17] _apply_head_vector_avg (torch): Δ‖w‖=9.390841e-02
[S17] stored merged vector for next round verification (round=12)
[S17] DEBUG after merge:  round=12 metric=0.4102 head_norm=1.627180 delta_norm=0.093908
[S17] aggregate: ROLLBACK (f1_val pre=0.417 post=0.410 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=12 metric=0.4194 head_norm=0.831954
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.623036e-01
[S16] stored merged vector for next round verification (round=12)
[S16] DEBUG after merge:  round=12 metric=0.1765 head_norm=0.852811 delta_norm=0.162304
[S16] aggregate: ROLLBACK (f1_val pre=0.419 post=0.177 tol_abs=0.005 tol_rel=0.0)
[S2] START round=13 head_norm_before_train=0.776153 cos_to_last_merge=1.0000 (last merge round=12)
[S2] round=13 local utility u=0.000000 metrics={'f1_val': 0.6996906525731519, 'auprc': 0.68396938340683, 'loss_val': 0.6587692208252873, 'psi': 0.6934021449066231}-{'f1_val': 0.7069532048410194, 'auprc': 0.7526947896360765, 'loss_val': 0.7136505740903005, 'psi': 0.7252498387590423}
[S3] START round=13 head_norm_before_train=1.311519 cos_to_last_merge=0.8748 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.875
[S3] round=13 local utility u=0.000000 metrics={'f1_val': 0.6000471501447486, 'auprc': 0.9806294259394395, 'loss_val': 0.4898186505715137, 'psi': 0.752280060462625}-{'f1_val': 0.6458201896343078, 'auprc': 0.9940611635373903, 'loss_val': 0.4441306257960551, 'psi': 0.7851165791955408}
[S4] START round=13 head_norm_before_train=1.230896 cos_to_last_merge=1.0000 (last merge round=12)
[S4] round=13 local utility u=0.235436 metrics={'f1_val': 0.5082972828486688, 'auprc': 0.8629066844824766, 'loss_val': 0.5748789407664802, 'psi': 0.6501410435021919}-{'f1_val': 0.44788760515127324, 'auprc': 0.8702075818889626, 'loss_val': 0.7051956997071768, 'psi': 0.616815595846349}
[S5] START round=13 head_norm_before_train=0.936439 cos_to_last_merge=1.0000 (last merge round=12)
[S5] round=13 local utility u=0.211174 metrics={'f1_val': 0.7005699347162762, 'auprc': 0.907239409140957, 'loss_val': 0.7290292423017589, 'psi': 0.7832377244861485}-{'f1_val': 0.7146935597656502, 'auprc': 0.7776562439697686, 'loss_val': 0.8473690156314626, 'psi': 0.7398786334472975}
[S6] START round=13 head_norm_before_train=1.648183 (no previous merge yet)
[S6] round=13 local utility u=0.027570 metrics={'f1_val': 0.9574248271370106, 'auprc': 0.9556832371811474, 'loss_val': 0.2663916868344601, 'psi': 0.9567281911546653}-{'f1_val': 0.9549951619067687, 'auprc': 0.9537373102876326, 'loss_val': 0.3011167312280879, 'psi': 0.9544920212591144}
[S7] START round=13 head_norm_before_train=1.087492 cos_to_last_merge=0.9248 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.925
[S7] round=13 local utility u=0.000000 metrics={'f1_val': 0.41727946905461333, 'auprc': 0.7944109832341242, 'loss_val': 0.7664044968147157, 'psi': 0.5681320747264177}-{'f1_val': 0.7144974922643522, 'auprc': 0.7943965067284566, 'loss_val': 0.8145931736544014, 'psi': 0.746457098049994}
[S8] START round=13 head_norm_before_train=1.643914 (no previous merge yet)
[S8] round=13 local utility u=0.009655 metrics={'f1_val': 0.7139540394217572, 'auprc': 0.9962034660036461, 'loss_val': 0.2056528452652301, 'psi': 0.8268538100545128}-{'f1_val': 0.7153020232295868, 'auprc': 0.9977162610662063, 'loss_val': 0.23758872084592011, 'psi': 0.8282677183642346}
[S9] START round=13 head_norm_before_train=1.257557 cos_to_last_merge=0.8685 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.868
[S9] round=13 local utility u=0.008241 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.998807702832023, 'loss_val': 0.2773271283686484, 'psi': 0.8202973712573473}-{'f1_val': 0.7015406642019387, 'auprc': 0.9988052393656333, 'loss_val': 0.29530344474870784, 'psi': 0.8204464942674166}
[S10] START round=13 head_norm_before_train=0.879224 cos_to_last_merge=1.0000 (last merge round=12)
[S10] round=13 local utility u=0.000341 metrics={'f1_val': 0.6798764783926816, 'auprc': 0.9705333190455481, 'loss_val': 0.5918955374265709, 'psi': 0.7961392146538282}-{'f1_val': 0.7005778313860114, 'auprc': 0.949767361330437, 'loss_val': 0.6544871855804287, 'psi': 0.8002536433637817}
[S11] START round=13 head_norm_before_train=0.796319 cos_to_last_merge=1.0000 (last merge round=12)
[S11] round=13 local utility u=0.000000 metrics={'f1_val': 0.7012129785687009, 'auprc': 0.9960555851830633, 'loss_val': 0.5686302664082237, 'psi': 0.8191500212144458}-{'f1_val': 0.7017589383281313, 'auprc': 0.9960644708615083, 'loss_val': 0.4796289996545295, 'psi': 0.8194811513414821}
[S13] START round=13 head_norm_before_train=0.886890 cos_to_last_merge=1.0000 (last merge round=12)
[S13] round=13 local utility u=0.000000 metrics={'f1_val': 0.627949810005527, 'auprc': 0.6997262915845028, 'loss_val': 0.7756136425094073, 'psi': 0.6566604026371173}-{'f1_val': 0.6645694732264259, 'auprc': 0.6986857692084771, 'loss_val': 0.7783966265400953, 'psi': 0.6782159916192464}
[S14] START round=13 head_norm_before_train=1.579340 (no previous merge yet)
[S14] round=13 local utility u=0.034372 metrics={'f1_val': 0.9980623665153463, 'auprc': 0.9967866771265265, 'loss_val': 0.21165203377182445, 'psi': 0.9975520907598184}-{'f1_val': 0.9980847028057478, 'auprc': 0.9957252935512118, 'loss_val': 0.27734625794808676, 'psi': 0.9971409391039333}
[S15] START round=13 head_norm_before_train=1.546467 cos_to_last_merge=1.0000 (last merge round=12)
[S15] round=13 local utility u=1.000000 metrics={'f1_val': 0.9968600560557072, 'auprc': 0.9963200809445509, 'loss_val': 0.4154228487920138, 'psi': 0.9966440660112447}-{'f1_val': 0.7012610101523403, 'auprc': 0.8385296504935444, 'loss_val': 0.6269921483209993, 'psi': 0.756168466288822}
[S16] START round=13 head_norm_before_train=0.852811 cos_to_last_merge=1.0000 (last merge round=12)
[S16] round=13 local utility u=1.000000 metrics={'f1_val': 0.6889472719116131, 'auprc': 0.770144866227385, 'loss_val': 0.8515048896498202, 'psi': 0.7214263096379219}-{'f1_val': 0.41937432571049194, 'auprc': 0.5595695819165125, 'loss_val': 0.9082960928646215, 'psi': 0.4754524281929002}
[S17] START round=13 head_norm_before_train=1.627180 cos_to_last_merge=1.0000 (last merge round=12)
[S17] round=13 local utility u=0.000000 metrics={'f1_val': 0.4015034993616856, 'auprc': 0.8013632408528889, 'loss_val': 0.7069762625723082, 'psi': 0.561447395958167}-{'f1_val': 0.41729424900056306, 'auprc': 0.8024196838283006, 'loss_val': 0.7098311177977211, 'psi': 0.5713444229316581}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:31604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:31604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:31617
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1801) from S6
[S4] cosine check vs S6: cos=0.8460
[S4] RECEIVED delta(kind=head bytes=1797) from S9
[S4] cosine check vs S9: cos=0.8936
[S17] RECEIVED delta(kind=head bytes=1802) from S8
[S17] cosine check vs S8: cos=0.9945
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:31611
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:31615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S5] → sending delta(kind=head bytes=1789) to S10@127.0.0.1:31611
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1785 reason=None
[S10] → sending delta(kind=head bytes=1785) to S16@127.0.0.1:31616
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:31605
[S15] sending update (kind=head size=1803 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1803) from S15
[S10] cosine check vs S15: cos=0.8300
[S10] sending update (kind=head size=1785 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S16] → sending delta(kind=head bytes=1791) to S2@127.0.0.1:31602
[S5] sending update (kind=head size=1789 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1797) from S4
[S5] cosine check vs S4: cos=0.5973
[S15] RECEIVED delta(kind=head bytes=1799) from S14
[S15] cosine check vs S14: cos=0.9929
[S16] RECEIVED delta(kind=head bytes=1785) from S10
[S16] cosine check vs S10: cos=0.9552
[S10] RECEIVED delta(kind=head bytes=1789) from S5
[S10] cosine check vs S5: cos=0.5023
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1791 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1791) from S16
[S2] cosine check vs S16: cos=0.9011
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=13 metric=0.6997 head_norm=0.827224
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.956749e-01
[S2] stored merged vector for next round verification (round=13)
[S2] DEBUG after merge:  round=13 metric=0.6998 head_norm=0.842943 delta_norm=0.195675
[S2] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=13 metric=0.7006 head_norm=0.963789
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.241215e-01
[S5] stored merged vector for next round verification (round=13)
[S5] DEBUG after merge:  round=13 metric=0.7007 head_norm=1.006845 delta_norm=0.524122
[S5] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=13 metric=0.5083 head_norm=1.283741
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.245781e-01
[S4] stored merged vector for next round verification (round=13)
[S4] DEBUG after merge:  round=13 metric=0.5124 head_norm=1.291846 delta_norm=0.124578
[S4] aggregate: ACCEPT kept=['S6', 'S9'] (k=2/2) mode=median trim_p=0.1
[S10] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=13 metric=0.6799 head_norm=0.913827
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.017326e-01
[S10] stored merged vector for next round verification (round=13)
[S10] DEBUG after merge:  round=13 metric=0.6785 head_norm=0.911165 delta_norm=0.101733
[S10] aggregate: ACCEPT kept=['S15', 'S5'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=13 metric=0.9969 head_norm=1.578595
[S15] _apply_head_vector_avg (torch): Δ‖w‖=9.642374e-02
[S15] stored merged vector for next round verification (round=13)
[S15] DEBUG after merge:  round=13 metric=0.9969 head_norm=1.591161 delta_norm=0.096424
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=13 metric=0.6889 head_norm=0.901878
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.360776e-01
[S16] stored merged vector for next round verification (round=13)
[S16] DEBUG after merge:  round=13 metric=0.7267 head_norm=0.897616 delta_norm=0.136078
[S16] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=13 metric=0.4015 head_norm=1.650301
[S17] _apply_head_vector_avg (torch): Δ‖w‖=8.806717e-02
[S17] stored merged vector for next round verification (round=13)
[S17] DEBUG after merge:  round=13 metric=0.4012 head_norm=1.659536 delta_norm=0.088067
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=0.842943 cos_to_last_merge=1.0000 (last merge round=13)
[S2] round=14 local utility u=0.109610 metrics={'f1_val': 0.7000513605313681, 'auprc': 0.7404187539355989, 'loss_val': 0.6110618312018549, 'psi': 0.7161983178930604}-{'f1_val': 0.6996906525731519, 'auprc': 0.68396938340683, 'loss_val': 0.6587692208252873, 'psi': 0.6934021449066231}
[S3] START round=14 head_norm_before_train=1.338918 cos_to_last_merge=0.8656 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.866
[S3] round=14 local utility u=0.415565 metrics={'f1_val': 0.7008317350254774, 'auprc': 0.9956971661170124, 'loss_val': 0.3086001637157045, 'psi': 0.8187779074620913}-{'f1_val': 0.6000471501447486, 'auprc': 0.9806294259394395, 'loss_val': 0.4898186505715137, 'psi': 0.752280060462625}
[S4] START round=14 head_norm_before_train=1.291846 cos_to_last_merge=1.0000 (last merge round=13)
[S4] round=14 local utility u=0.000000 metrics={'f1_val': 0.4959375682817053, 'auprc': 0.8238800167649355, 'loss_val': 0.5007170216571564, 'psi': 0.6271145476749974}-{'f1_val': 0.5082972828486688, 'auprc': 0.8629066844824766, 'loss_val': 0.5748789407664802, 'psi': 0.6501410435021919}
[S5] START round=14 head_norm_before_train=1.006845 cos_to_last_merge=1.0000 (last merge round=13)
[S5] round=14 local utility u=0.000000 metrics={'f1_val': 0.7076139623118027, 'auprc': 0.7773578394477303, 'loss_val': 0.8291963933205512, 'psi': 0.7355115131661738}-{'f1_val': 0.7005699347162762, 'auprc': 0.907239409140957, 'loss_val': 0.7290292423017589, 'psi': 0.7832377244861485}
[S6] START round=14 head_norm_before_train=1.672127 (no previous merge yet)
[S6] round=14 local utility u=0.000000 metrics={'f1_val': 0.9505369065423973, 'auprc': 0.9576419162165911, 'loss_val': 0.2827011357856232, 'psi': 0.9533789104120748}-{'f1_val': 0.9574248271370106, 'auprc': 0.9556832371811474, 'loss_val': 0.2663916868344601, 'psi': 0.9567281911546653}
[S7] START round=14 head_norm_before_train=1.121385 cos_to_last_merge=0.9120 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.912
[S7] round=14 local utility u=0.911639 metrics={'f1_val': 0.7130082723495244, 'auprc': 0.7937318837357659, 'loss_val': 0.715462980476985, 'psi': 0.7452977169040209}-{'f1_val': 0.41727946905461333, 'auprc': 0.7944109832341242, 'loss_val': 0.7664044968147157, 'psi': 0.5681320747264177}
[S8] START round=14 head_norm_before_train=1.673361 (no previous merge yet)
[S8] round=14 local utility u=0.881105 metrics={'f1_val': 0.9967904835007894, 'auprc': 0.9976166955647533, 'loss_val': 0.1447013537317277, 'psi': 0.997120968326375}-{'f1_val': 0.7139540394217572, 'auprc': 0.9962034660036461, 'loss_val': 0.2056528452652301, 'psi': 0.8268538100545128}
[S9] START round=14 head_norm_before_train=1.299347 cos_to_last_merge=0.8577 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.858
[S9] round=14 local utility u=0.008873 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9988185187209292, 'loss_val': 0.25961385114635993, 'psi': 0.8203016976129097}-{'f1_val': 0.7012904835408967, 'auprc': 0.998807702832023, 'loss_val': 0.2773271283686484, 'psi': 0.8202973712573473}
[S10] START round=14 head_norm_before_train=0.911165 cos_to_last_merge=1.0000 (last merge round=13)
[S10] round=14 local utility u=0.000000 metrics={'f1_val': 0.5602170221675556, 'auprc': 0.910677963015511, 'loss_val': 0.6890567677930451, 'psi': 0.7004013985067378}-{'f1_val': 0.6798764783926816, 'auprc': 0.9705333190455481, 'loss_val': 0.5918955374265709, 'psi': 0.7961392146538282}
[S11] START round=14 head_norm_before_train=0.851055 cos_to_last_merge=0.9944 (last merge round=12)
[S11] round=14 local utility u=0.227086 metrics={'f1_val': 0.7539291828781379, 'auprc': 0.9974826382116484, 'loss_val': 0.4350357117156582, 'psi': 0.851350565011542}-{'f1_val': 0.7012129785687009, 'auprc': 0.9960555851830633, 'loss_val': 0.5686302664082237, 'psi': 0.8191500212144458}
[S13] START round=14 head_norm_before_train=0.924046 cos_to_last_merge=0.9953 (last merge round=12)
[S13] round=14 local utility u=0.007174 metrics={'f1_val': 0.6287974219685626, 'auprc': 0.6773016993364898, 'loss_val': 0.6990779335866525, 'psi': 0.6481991329157335}-{'f1_val': 0.627949810005527, 'auprc': 0.6997262915845028, 'loss_val': 0.7756136425094073, 'psi': 0.6566604026371173}
[S14] START round=14 head_norm_before_train=1.609417 (no previous merge yet)
[S14] round=14 local utility u=0.011408 metrics={'f1_val': 0.9974359022548762, 'auprc': 0.9945973874701248, 'loss_val': 0.1785095148449138, 'psi': 0.9963004963409756}-{'f1_val': 0.9980623665153463, 'auprc': 0.9967866771265265, 'loss_val': 0.21165203377182445, 'psi': 0.9975520907598184}
[S15] START round=14 head_norm_before_train=1.591161 cos_to_last_merge=1.0000 (last merge round=13)
[S15] round=14 local utility u=0.000000 metrics={'f1_val': 0.7743096728735979, 'auprc': 0.9853874293178853, 'loss_val': 0.4094372608145578, 'psi': 0.8587407754513128}-{'f1_val': 0.9968600560557072, 'auprc': 0.9963200809445509, 'loss_val': 0.4154228487920138, 'psi': 0.9966440660112447}
[S16] START round=14 head_norm_before_train=0.897616 cos_to_last_merge=1.0000 (last merge round=13)
[S16] round=14 local utility u=0.595788 metrics={'f1_val': 0.8405153416320151, 'auprc': 0.8430223950306404, 'loss_val': 0.7879700257036891, 'psi': 0.8415181629914652}-{'f1_val': 0.6889472719116131, 'auprc': 0.770144866227385, 'loss_val': 0.8515048896498202, 'psi': 0.7214263096379219}
[S17] START round=14 head_norm_before_train=1.659536 cos_to_last_merge=1.0000 (last merge round=13)
[S17] round=14 local utility u=0.066821 metrics={'f1_val': 0.41888702231039154, 'auprc': 0.7977591993266293, 'loss_val': 0.6668226524767007, 'psi': 0.5704358931168867}-{'f1_val': 0.4015034993616856, 'auprc': 0.8013632408528889, 'loss_val': 0.7069762625723082, 'psi': 0.561447395958167}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S16] → sending delta(kind=head bytes=1786) to S10@127.0.0.1:31611
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:31616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] → sending delta(kind=head bytes=1805) to S5@127.0.0.1:31605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:31612
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:31603
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S7] sending update (kind=head size=1793 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:31602
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:31609
[S13] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1786 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1800) from S8
[S3] cosine check vs S8: cos=-0.0710
[S3] DROPPED delta from S8 (cos=-0.0710 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1799) from S2
[S16] cosine check vs S2: cos=0.9455
[S11] RECEIVED delta(kind=head bytes=1797) from S13
[S11] cosine check vs S13: cos=0.9174
[S2] RECEIVED delta(kind=head bytes=1797) from S11
[S2] cosine check vs S11: cos=0.6497
[S10] RECEIVED delta(kind=head bytes=1786) from S16
[S10] cosine check vs S16: cos=0.9607
[S17] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1801) from S17
[S8] cosine check vs S17: cos=0.9956
[S14] sending update (kind=head size=1805 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1805) from S14
[S5] cosine check vs S14: cos=-0.0299
[S5] DROPPED delta from S14 (cos=-0.0299 < 0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=14 metric=0.5602 head_norm=0.948213
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.327767e-01
[S10] stored merged vector for next round verification (round=14)
[S10] DEBUG after merge:  round=14 metric=0.5599 head_norm=0.937356 delta_norm=0.132777
[S10] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=14 metric=0.7001 head_norm=0.895018
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.787586e-01
[S2] stored merged vector for next round verification (round=14)
[S2] DEBUG after merge:  round=14 metric=0.6999 head_norm=0.821683 delta_norm=0.378759
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=14 metric=0.7539 head_norm=0.914432
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.937267e-01
[S11] stored merged vector for next round verification (round=14)
[S11] DEBUG after merge:  round=14 metric=0.7017 head_norm=0.923481 delta_norm=0.193727
[S11] aggregate: ROLLBACK (f1_val pre=0.754 post=0.702 tol_abs=0.005 tol_rel=0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=14 metric=0.9968 head_norm=1.702401
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.031864e-02
[S8] stored merged vector for next round verification (round=14)
[S8] DEBUG after merge:  round=14 metric=0.9968 head_norm=1.690651 delta_norm=0.080319
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=14 metric=0.8405 head_norm=0.945211
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.539208e-01
[S16] stored merged vector for next round verification (round=14)
[S16] DEBUG after merge:  round=14 metric=0.5549 head_norm=0.907496 delta_norm=0.153921
[S16] aggregate: ROLLBACK (f1_val pre=0.841 post=0.555 tol_abs=0.005 tol_rel=0.0)
[S2] START round=15 head_norm_before_train=0.821683 cos_to_last_merge=1.0000 (last merge round=14)
[S2] round=15 local utility u=0.095042 metrics={'f1_val': 0.700679819759172, 'auprc': 0.777169940096231, 'loss_val': 0.53500254693785, 'psi': 0.7312758678939957}-{'f1_val': 0.7000513605313681, 'auprc': 0.7404187539355989, 'loss_val': 0.6110618312018549, 'psi': 0.7161983178930604}
[S3] START round=15 head_norm_before_train=1.368041 cos_to_last_merge=0.8591 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.859
[S3] round=15 local utility u=0.012257 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9971478436292501, 'loss_val': 0.28798556021525534, 'psi': 0.8193128596928798}-{'f1_val': 0.7008317350254774, 'auprc': 0.9956971661170124, 'loss_val': 0.3086001637157045, 'psi': 0.8187779074620913}
[S4] START round=15 head_norm_before_train=1.345057 cos_to_last_merge=0.9984 (last merge round=13)
[S4] round=15 local utility u=0.425678 metrics={'f1_val': 0.6167929906639046, 'auprc': 0.8572776822026793, 'loss_val': 0.4746857460364826, 'psi': 0.7129868672794145}-{'f1_val': 0.4959375682817053, 'auprc': 0.8238800167649355, 'loss_val': 0.5007170216571564, 'psi': 0.6271145476749974}
[S5] START round=15 head_norm_before_train=1.027801 cos_to_last_merge=0.9981 (last merge round=13)
[S5] round=15 local utility u=0.034055 metrics={'f1_val': 0.7006090940057808, 'auprc': 0.7424736070453943, 'loss_val': 0.6144041224956642, 'psi': 0.7173548992216262}-{'f1_val': 0.7076139623118027, 'auprc': 0.7773578394477303, 'loss_val': 0.8291963933205512, 'psi': 0.7355115131661738}
[S6] START round=15 head_norm_before_train=1.693812 (no previous merge yet)
[S6] round=15 local utility u=0.000000 metrics={'f1_val': 0.6598135629591213, 'auprc': 0.8059166315153049, 'loss_val': 0.506066020952418, 'psi': 0.7182547903815948}-{'f1_val': 0.9505369065423973, 'auprc': 0.9576419162165911, 'loss_val': 0.2827011357856232, 'psi': 0.9533789104120748}
[S7] START round=15 head_norm_before_train=1.155763 cos_to_last_merge=0.8977 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.898
[S7] round=15 local utility u=0.308815 metrics={'f1_val': 0.7142685888878759, 'auprc': 0.9873287563991544, 'loss_val': 0.6861855005036247, 'psi': 0.8234926558923874}-{'f1_val': 0.7130082723495244, 'auprc': 0.7937318837357659, 'loss_val': 0.715462980476985, 'psi': 0.7452977169040209}
[S8] START round=15 head_norm_before_train=1.690651 cos_to_last_merge=1.0000 (last merge round=14)
[S8] round=15 local utility u=0.000000 metrics={'f1_val': 0.9102291869001498, 'auprc': 0.9983653131748466, 'loss_val': 0.14592053488407594, 'psi': 0.9454836374100285}-{'f1_val': 0.9967904835007894, 'auprc': 0.9976166955647533, 'loss_val': 0.1447013537317277, 'psi': 0.997120968326375}
[S9] START round=15 head_norm_before_train=1.336305 cos_to_last_merge=0.8494 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.849
[S9] round=15 local utility u=0.012619 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9985004945702565, 'loss_val': 0.23342212456175543, 'psi': 0.8201744879526407}-{'f1_val': 0.7012904835408967, 'auprc': 0.9988185187209292, 'loss_val': 0.25961385114635993, 'psi': 0.8203016976129097}
[S10] START round=15 head_norm_before_train=0.937356 cos_to_last_merge=1.0000 (last merge round=14)
[S10] round=15 local utility u=0.040704 metrics={'f1_val': 0.5599311485310668, 'auprc': 0.9129511476466432, 'loss_val': 0.6127528051271962, 'psi': 0.7011391481772974}-{'f1_val': 0.5602170221675556, 'auprc': 0.910677963015511, 'loss_val': 0.6890567677930451, 'psi': 0.7004013985067378}
[S11] START round=15 head_norm_before_train=0.923481 cos_to_last_merge=1.0000 (last merge round=14)
[S11] round=15 local utility u=0.646073 metrics={'f1_val': 0.9549664622503342, 'auprc': 0.9960708483143622, 'loss_val': 0.34487827142375155, 'psi': 0.9714082166759455}-{'f1_val': 0.7539291828781379, 'auprc': 0.9974826382116484, 'loss_val': 0.4350357117156582, 'psi': 0.851350565011542}
[S13] START round=15 head_norm_before_train=0.971857 cos_to_last_merge=0.9852 (last merge round=12)
[S13] round=15 local utility u=0.014952 metrics={'f1_val': 0.6290520406948403, 'auprc': 0.6710903719119179, 'loss_val': 0.6520676148845332, 'psi': 0.6458673731816713}-{'f1_val': 0.6287974219685626, 'auprc': 0.6773016993364898, 'loss_val': 0.6990779335866525, 'psi': 0.6481991329157335}
[S14] START round=15 head_norm_before_train=1.641617 (no previous merge yet)
[S14] round=15 local utility u=0.029922 metrics={'f1_val': 0.9980623665153463, 'auprc': 0.9973307609538213, 'loss_val': 0.13062372390656707, 'psi': 0.9977697242907364}-{'f1_val': 0.9974359022548762, 'auprc': 0.9945973874701248, 'loss_val': 0.1785095148449138, 'psi': 0.9963004963409756}
[S15] START round=15 head_norm_before_train=1.625819 cos_to_last_merge=0.9994 (last merge round=13)
[S15] round=15 local utility u=0.520595 metrics={'f1_val': 0.9168312279920938, 'auprc': 0.9951869860952867, 'loss_val': 0.2527753264635965, 'psi': 0.9481735312333709}-{'f1_val': 0.7743096728735979, 'auprc': 0.9853874293178853, 'loss_val': 0.4094372608145578, 'psi': 0.8587407754513128}
[S16] START round=15 head_norm_before_train=0.907496 cos_to_last_merge=1.0000 (last merge round=14)
[S16] round=15 local utility u=0.000000 metrics={'f1_val': 0.528549083001399, 'auprc': 0.8705990531472223, 'loss_val': 0.8205238422258783, 'psi': 0.6653690710597284}-{'f1_val': 0.8405153416320151, 'auprc': 0.8430223950306404, 'loss_val': 0.7879700257036891, 'psi': 0.8415181629914652}
[S17] START round=15 head_norm_before_train=1.682657 cos_to_last_merge=0.9994 (last merge round=13)
[S17] round=15 local utility u=0.012967 metrics={'f1_val': 0.4201746054601617, 'auprc': 0.8116709033902532, 'loss_val': 0.6903498166647526, 'psi': 0.5767731246321983}-{'f1_val': 0.41888702231039154, 'auprc': 0.7977591993266293, 'loss_val': 0.6668226524767007, 'psi': 0.5704358931168867}
[S2]  timeout peer S3
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S17
[S3]  timeout peer S2
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S15
[S5]  timeout peer S16
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S10] → sending delta(kind=head bytes=1790) to S5@127.0.0.1:31605
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:31607
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:31604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:31616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1790 to 1 peers)
[S2] sending update (kind=head size=1793 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1790) from S10
[S5] cosine check vs S10: cos=0.4008
[S16] RECEIVED delta(kind=head bytes=1793) from S2
[S16] cosine check vs S2: cos=0.8514
[S6] RECEIVED delta(kind=head bytes=1797) from S4
[S6] cosine check vs S4: cos=0.8767
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:31614
[S2] ⇄ pheromone p=0.193 → S16@127.0.0.1:31616
[S15] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:31612
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:31602
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] RECEIVED delta(kind=head bytes=1804) from S15
[S14] cosine check vs S15: cos=0.9910
[S5] sending update (kind=head size=1796 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1796) from S5
[S4] cosine check vs S5: cos=0.8840
[S13] sending update (kind=head size=1795 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1798) from S11
[S2] cosine check vs S11: cos=0.8306
[S11] RECEIVED delta(kind=head bytes=1795) from S13
[S11] cosine check vs S13: cos=0.9674
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:31609
[S17] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1800) from S17
[S8] cosine check vs S17: cos=0.9968
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=15 metric=0.7006 head_norm=1.061779
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.590119e-01
[S5] stored merged vector for next round verification (round=15)
[S5] DEBUG after merge:  round=15 metric=0.7006 head_norm=0.853314 delta_norm=0.559012
[S5] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.190 → S4@127.0.0.1:31604
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=15 metric=0.6168 head_norm=1.393438
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.366585e-01
[S4] stored merged vector for next round verification (round=15)
[S4] DEBUG after merge:  round=15 metric=0.6159 head_norm=1.192134 delta_norm=0.336658
[S4] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.239 → S6@127.0.0.1:31607
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=15 metric=0.6598 head_norm=1.709538
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.146020e-01
[S6] stored merged vector for next round verification (round=15)
[S6] DEBUG after merge:  round=15 metric=0.6301 head_norm=1.503396 delta_norm=0.414602
[S6] aggregate: ROLLBACK (f1_val pre=0.660 post=0.630 tol_abs=0.005 tol_rel=0.0)
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S16
[S8]  timeout peer S17
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S16
[S15]  timeout peer S17
[S5]  timeout peer S14
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S16
[S14]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S16
[S10]  timeout peer S17
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S6]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S10] ⇄ pheromone p=0.169 → S5@127.0.0.1:31605
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=15 metric=0.9102 head_norm=1.717677
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.846038e-02
[S8] stored merged vector for next round verification (round=15)
[S8] DEBUG after merge:  round=15 metric=0.7142 head_norm=1.711337 delta_norm=0.068460
[S8] aggregate: ROLLBACK (f1_val pre=0.910 post=0.714 tol_abs=0.005 tol_rel=0.0)
[S8] ⇄ pheromone p=0.298 → S3@127.0.0.1:31603
[S13] ⇄ pheromone p=0.163 → S11@127.0.0.1:31612
[S15] ⇄ pheromone p=0.401 → S14@127.0.0.1:31614
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=15 metric=0.5285 head_norm=0.965975
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.555490e-01
[S16] stored merged vector for next round verification (round=15)
[S16] DEBUG after merge:  round=15 metric=0.5257 head_norm=0.892971 delta_norm=0.255549
[S16] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.302 → S10@127.0.0.1:31611
[S17] ⇄ pheromone p=0.128 → S8@127.0.0.1:31609
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=15 metric=0.9550 head_norm=0.984743
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.287697e-01
[S11] stored merged vector for next round verification (round=15)
[S11] DEBUG after merge:  round=15 metric=0.7938 head_norm=0.992401 delta_norm=0.128770
[S11] aggregate: ROLLBACK (f1_val pre=0.955 post=0.794 tol_abs=0.005 tol_rel=0.0)
[S11] ⇄ pheromone p=0.345 → S2@127.0.0.1:31602
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=15 metric=0.9981 head_norm=1.673563
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.120655e-01
[S14] stored merged vector for next round verification (round=15)
[S14] DEBUG after merge:  round=15 metric=0.9976 head_norm=1.662475 delta_norm=0.112065
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=16 head_norm_before_train=0.890110 cos_to_last_merge=0.9967 (last merge round=14)
[S2] round=16 local utility u=0.000000 metrics={'f1_val': 0.6918597364984106, 'auprc': 0.6621813925005791, 'loss_val': 0.4574898919000573, 'psi': 0.679988398899278}-{'f1_val': 0.700679819759172, 'auprc': 0.777169940096231, 'loss_val': 0.53500254693785, 'psi': 0.7312758678939957}
[S3] START round=16 head_norm_before_train=1.395854 cos_to_last_merge=0.8545 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.854
[S3] round=16 local utility u=0.009499 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9988706757165952, 'loss_val': 0.27370462210159685, 'psi': 0.8199568460858389}-{'f1_val': 0.7007562037352997, 'auprc': 0.9971478436292501, 'loss_val': 0.28798556021525534, 'psi': 0.8193128596928798}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=16 head_norm_before_train=1.192134 cos_to_last_merge=1.0000 (last merge round=15)
[S4] round=16 local utility u=0.000000 metrics={'f1_val': 0.6120739396030361, 'auprc': 0.8579845005481364, 'loss_val': 0.49857131725776854, 'psi': 0.7104381639810762}-{'f1_val': 0.6167929906639046, 'auprc': 0.8572776822026793, 'loss_val': 0.4746857460364826, 'psi': 0.7129868672794145}
[S5] START round=16 head_norm_before_train=0.853314 cos_to_last_merge=1.0000 (last merge round=15)
[S5] round=16 local utility u=0.063413 metrics={'f1_val': 0.700320598491359, 'auprc': 0.7720065067914309, 'loss_val': 0.574446591007202, 'psi': 0.7289949618113878}-{'f1_val': 0.7006090940057808, 'auprc': 0.7424736070453943, 'loss_val': 0.6144041224956642, 'psi': 0.7173548992216262}
[S6] START round=16 head_norm_before_train=1.503396 cos_to_last_merge=1.0000 (last merge round=15)
[S6] round=16 local utility u=1.000000 metrics={'f1_val': 0.9583499412674471, 'auprc': 0.9625075075171401, 'loss_val': 0.2226695280445787, 'psi': 0.9600129677673244}-{'f1_val': 0.6598135629591213, 'auprc': 0.8059166315153049, 'loss_val': 0.506066020952418, 'psi': 0.7182547903815948}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=16 head_norm_before_train=1.189589 cos_to_last_merge=0.8861 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.886
[S7] round=16 local utility u=0.000000 metrics={'f1_val': 0.6990538362331501, 'auprc': 0.853311244658681, 'loss_val': 0.6196519430466302, 'psi': 0.7607567996033624}-{'f1_val': 0.7142685888878759, 'auprc': 0.9873287563991544, 'loss_val': 0.6861855005036247, 'psi': 0.8234926558923874}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=16 head_norm_before_train=1.711337 cos_to_last_merge=1.0000 (last merge round=15)
[S8] round=16 local utility u=0.279508 metrics={'f1_val': 0.9966423580139139, 'auprc': 0.9992432596015963, 'loss_val': 0.10801702595395642, 'psi': 0.9976827186489869}-{'f1_val': 0.9102291869001498, 'auprc': 0.9983653131748466, 'loss_val': 0.14592053488407594, 'psi': 0.9454836374100285}
[S9] START round=16 head_norm_before_train=1.369389 cos_to_last_merge=0.8425 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.842
[S9] round=16 local utility u=0.011095 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9981004110021761, 'loss_val': 0.20958916195888333, 'psi': 0.8199701128648815}-{'f1_val': 0.7012904835408967, 'auprc': 0.9985004945702565, 'loss_val': 0.23342212456175543, 'psi': 0.8201744879526407}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] sending update (kind=head size=1794 to 1 peers)
[S10] START round=16 head_norm_before_train=0.976680 cos_to_last_merge=0.9981 (last merge round=14)
[S10] round=16 local utility u=1.000000 metrics={'f1_val': 0.9888680173481453, 'auprc': 0.9882842168228866, 'loss_val': 0.3521410549668638, 'psi': 0.9886344971380419}-{'f1_val': 0.5599311485310668, 'auprc': 0.9129511476466432, 'loss_val': 0.6127528051271962, 'psi': 0.7011391481772974}
[S11] START round=16 head_norm_before_train=0.992401 cos_to_last_merge=1.0000 (last merge round=15)
[S11] round=16 local utility u=0.049829 metrics={'f1_val': 0.9575857740575427, 'auprc': 0.9976045865385061, 'loss_val': 0.26553665046257413, 'psi': 0.9735932990499281}-{'f1_val': 0.9549664622503342, 'auprc': 0.9960708483143622, 'loss_val': 0.34487827142375155, 'psi': 0.9714082166759455}
[S13] START round=16 head_norm_before_train=1.016446 cos_to_last_merge=0.9733 (last merge round=12)
[S13] round=16 local utility u=0.000000 metrics={'f1_val': 0.6260381998851847, 'auprc': 0.6608070363571293, 'loss_val': 0.6510229105419252, 'psi': 0.6399457344739625}-{'f1_val': 0.6290520406948403, 'auprc': 0.6710903719119179, 'loss_val': 0.6520676148845332, 'psi': 0.6458673731816713}
[S14] START round=16 head_norm_before_train=1.662475 cos_to_last_merge=1.0000 (last merge round=15)
[S14] round=16 local utility u=0.015277 metrics={'f1_val': 0.9975054147531532, 'auprc': 0.9985600200076914, 'loss_val': 0.10041502142767679, 'psi': 0.9979272568549684}-{'f1_val': 0.9980623665153463, 'auprc': 0.9973307609538213, 'loss_val': 0.13062372390656707, 'psi': 0.9977697242907364}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=16 head_norm_before_train=1.658901 cos_to_last_merge=0.9978 (last merge round=13)
[S15] round=16 local utility u=0.065578 metrics={'f1_val': 0.9292282131263295, 'auprc': 0.9971984455975663, 'loss_val': 0.20203507259314857, 'psi': 0.9564163061148242}-{'f1_val': 0.9168312279920938, 'auprc': 0.9951869860952867, 'loss_val': 0.2527753264635965, 'psi': 0.9481735312333709}
[S16] START round=16 head_norm_before_train=0.892971 cos_to_last_merge=1.0000 (last merge round=15)
[S16] round=16 local utility u=0.277099 metrics={'f1_val': 0.5637606139847109, 'auprc': 0.9289337081831596, 'loss_val': 0.6525995493003875, 'psi': 0.7098298516640904}-{'f1_val': 0.528549083001399, 'auprc': 0.8705990531472223, 'loss_val': 0.8205238422258783, 'psi': 0.6653690710597284}
[S17] START round=16 head_norm_before_train=1.707721 cos_to_last_merge=0.9983 (last merge round=13)
[S17] round=16 local utility u=0.000000 metrics={'f1_val': 0.4237348941361869, 'auprc': 0.7482974324859305, 'loss_val': 0.6793509147733041, 'psi': 0.5535599094760844}-{'f1_val': 0.4201746054601617, 'auprc': 0.8116709033902532, 'loss_val': 0.6903498166647526, 'psi': 0.5767731246321983}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S11] → sending delta(kind=head bytes=1788) to S2@127.0.0.1:31602
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:31603
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:31614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:31611
[S8] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1788 to 1 peers)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=16 metric=0.6919 head_norm=0.952503
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.852913e-01
[S2] stored merged vector for next round verification (round=16)
[S2] DEBUG after merge:  round=16 metric=0.6902 head_norm=0.925797 delta_norm=0.285291
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] RECEIVED delta(kind=head bytes=1802) from S15
[S14] cosine check vs S15: cos=0.9946
[S2] RECEIVED delta(kind=head bytes=1788) from S11
[S2] cosine check vs S11: cos=0.9288
[S3] RECEIVED delta(kind=head bytes=1796) from S8
[S3] cosine check vs S8: cos=-0.0761
[S3] DROPPED delta from S8 (cos=-0.0761 < 0.0)
[S16] sending update (kind=head size=1798 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1798) from S16
[S10] cosine check vs S16: cos=0.8503
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S10] → sending delta(kind=head bytes=1789) to S5@127.0.0.1:31605
[S10] sending update (kind=head size=1789 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1789) from S10
[S5] cosine check vs S10: cos=0.8065
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=16 metric=0.9889 head_norm=1.009500
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.695592e-01
[S10] stored merged vector for next round verification (round=16)
[S10] DEBUG after merge:  round=16 metric=0.8603 head_norm=0.942258 delta_norm=0.269559
[S10] aggregate: ROLLBACK (f1_val pre=0.989 post=0.860 tol_abs=0.005 tol_rel=0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15]  timeout peer S14
[S8]  timeout peer S3
[S16]  timeout peer S10
[S11]  timeout peer S2
[S5]  timeout peer S4
[S5]  timeout peer S13
[S5]  timeout peer S17
[S10]  timeout peer S5
[S10]  timeout peer S15
[S4]  timeout peer S6
[S4]  timeout peer S9
[S2]  timeout peer S16
[S17]  timeout peer S7
[S17]  timeout peer S8
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=16 metric=0.7003 head_norm=0.901114
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.015468e-01
[S5] stored merged vector for next round verification (round=16)
[S5] DEBUG after merge:  round=16 metric=0.7006 head_norm=0.908084 delta_norm=0.301547
[S5] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=0.925797 cos_to_last_merge=1.0000 (last merge round=16)
[S2] round=17 local utility u=0.041951 metrics={'f1_val': 0.6996105493161282, 'auprc': 0.6630377769579933, 'loss_val': 0.4226615279917082, 'psi': 0.6849814403728742}-{'f1_val': 0.6918597364984106, 'auprc': 0.6621813925005791, 'loss_val': 0.4574898919000573, 'psi': 0.679988398899278}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] sending update (kind=head size=1793 to 1 peers)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=17 metric=0.6996 head_norm=0.981582
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.084465e-01
[S2] stored merged vector for next round verification (round=17)
[S2] DEBUG after merge:  round=17 metric=0.6996 head_norm=0.995417 delta_norm=0.208447
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S3] START round=17 head_norm_before_train=1.421596 cos_to_last_merge=0.8505 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.850
[S3] round=17 local utility u=0.002659 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9988552715088869, 'loss_val': 0.2683408196749896, 'psi': 0.8199506844027555}-{'f1_val': 0.7006809596653347, 'auprc': 0.9988706757165952, 'loss_val': 0.27370462210159685, 'psi': 0.8199568460858389}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S3] sending update (kind=head size=1806 to 1 peers)
[S4] START round=17 head_norm_before_train=1.237102 cos_to_last_merge=0.9993 (last merge round=15)
[S4] round=17 local utility u=0.134225 metrics={'f1_val': 0.6133733409079134, 'auprc': 0.9465755997179104, 'loss_val': 0.5036916156886033, 'psi': 0.7466542444319122}-{'f1_val': 0.6120739396030361, 'auprc': 0.8579845005481364, 'loss_val': 0.49857131725776854, 'psi': 0.7104381639810762}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] START round=17 head_norm_before_train=0.908084 cos_to_last_merge=1.0000 (last merge round=16)
[S5] round=17 local utility u=0.046408 metrics={'f1_val': 0.700320598491359, 'auprc': 0.7879660659502881, 'loss_val': 0.5295091134926956, 'psi': 0.7353787854749306}-{'f1_val': 0.700320598491359, 'auprc': 0.7720065067914309, 'loss_val': 0.574446591007202, 'psi': 0.7289949618113878}
[S5] not sending this round → trigger blocked (psi=0.735)
[S6] START round=17 head_norm_before_train=1.515496 cos_to_last_merge=0.9999 (last merge round=15)
[S6] round=17 local utility u=0.000000 metrics={'f1_val': 0.6780986813049714, 'auprc': 0.8058047985457527, 'loss_val': 0.5815713772718535, 'psi': 0.7291811282012839}-{'f1_val': 0.9583499412674471, 'auprc': 0.9625075075171401, 'loss_val': 0.2226695280445787, 'psi': 0.9600129677673244}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=17 head_norm_before_train=1.224154 cos_to_last_merge=0.8771 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.877
[S7] round=17 local utility u=0.000000 metrics={'f1_val': 0.693823141362238, 'auprc': 0.8494527980428042, 'loss_val': 0.584970867189226, 'psi': 0.7560750040344645}-{'f1_val': 0.6990538362331501, 'auprc': 0.853311244658681, 'loss_val': 0.6196519430466302, 'psi': 0.7607567996033624}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=17 head_norm_before_train=1.735079 cos_to_last_merge=0.9998 (last merge round=15)
[S8] round=17 local utility u=0.002211 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9989558023351535, 'loss_val': 0.10099629028853813, 'psi': 0.9973941658954362}-{'f1_val': 0.9966423580139139, 'auprc': 0.9992432596015963, 'loss_val': 0.10801702595395642, 'psi': 0.9976827186489869}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] sending update (kind=head size=1804 to 1 peers)
[S9] START round=17 head_norm_before_train=1.400702 cos_to_last_merge=0.8377 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.838
[S9] round=17 local utility u=0.016759 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9981153800865765, 'loss_val': 0.17611684215476683, 'psi': 0.8199761004986418}-{'f1_val': 0.7012165807733519, 'auprc': 0.9981004110021761, 'loss_val': 0.20958916195888333, 'psi': 0.8199701128648815}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=17 head_norm_before_train=0.942258 cos_to_last_merge=1.0000 (last merge round=16)
[S10] round=17 local utility u=0.000000 metrics={'f1_val': 0.6570476410251505, 'auprc': 0.9474972208381495, 'loss_val': 0.4267726685394047, 'psi': 0.7732274729503501}-{'f1_val': 0.9888680173481453, 'auprc': 0.9882842168228866, 'loss_val': 0.3521410549668638, 'psi': 0.9886344971380419}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=17 head_norm_before_train=1.051241 cos_to_last_merge=0.9985 (last merge round=15)
[S11] round=17 local utility u=0.000000 metrics={'f1_val': 0.8704865388067649, 'auprc': 0.9967951806779166, 'loss_val': 0.4821662606693227, 'psi': 0.9210099955552256}-{'f1_val': 0.9575857740575427, 'auprc': 0.9976045865385061, 'loss_val': 0.26553665046257413, 'psi': 0.9735932990499281}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=17 head_norm_before_train=1.058343 cos_to_last_merge=0.9602 (last merge round=12)
[S13] round=17 local utility u=0.000000 metrics={'f1_val': 0.5910110462723974, 'auprc': 0.6810586638771868, 'loss_val': 0.7351640643814069, 'psi': 0.6270300933143131}-{'f1_val': 0.6260381998851847, 'auprc': 0.6608070363571293, 'loss_val': 0.6510229105419252, 'psi': 0.6399457344739625}
[S14] START round=17 head_norm_before_train=1.695981 cos_to_last_merge=0.9996 (last merge round=15)
[S14] round=17 local utility u=0.006074 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9974403578002948, 'loss_val': 0.08186009971725483, 'psi': 0.997174648014717}-{'f1_val': 0.9975054147531532, 'auprc': 0.9985600200076914, 'loss_val': 0.10041502142767679, 'psi': 0.9979272568549684}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S14] sending update (kind=head size=1792 to 1 peers)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=17 metric=0.9970 head_norm=1.731073
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.052999e-01
[S14] stored merged vector for next round verification (round=17)
[S14] DEBUG after merge:  round=17 metric=0.9970 head_norm=1.708483 delta_norm=0.105300
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S15] START round=17 head_norm_before_train=1.692156 cos_to_last_merge=0.9958 (last merge round=13)
[S15] round=17 local utility u=0.000000 metrics={'f1_val': 0.7513835921705982, 'auprc': 0.9860629763246768, 'loss_val': 0.2941282425166351, 'psi': 0.8452553458322296}-{'f1_val': 0.9292282131263295, 'auprc': 0.9971984455975663, 'loss_val': 0.20203507259314857, 'psi': 0.9564163061148242}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=17 head_norm_before_train=0.949703 cos_to_last_merge=0.9982 (last merge round=15)
[S16] round=17 local utility u=0.912197 metrics={'f1_val': 0.8064458707973541, 'auprc': 0.9772504816572158, 'loss_val': 0.42926738937855685, 'psi': 0.8747677151412987}-{'f1_val': 0.5637606139847109, 'auprc': 0.9289337081831596, 'loss_val': 0.6525995493003875, 'psi': 0.7098298516640904}
[S17] START round=17 head_norm_before_train=1.734955 cos_to_last_merge=0.9964 (last merge round=13)
[S17] round=17 local utility u=0.833278 metrics={'f1_val': 0.6522495996365321, 'auprc': 0.8376602573368204, 'loss_val': 0.6519722126546084, 'psi': 0.7264138627166474}-{'f1_val': 0.4237348941361869, 'auprc': 0.7482974324859305, 'loss_val': 0.6793509147733041, 'psi': 0.5535599094760844}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:31602
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1797 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1797) from S16
[S2] cosine check vs S16: cos=0.7376
[S2] START round=18 head_norm_before_train=0.995417 cos_to_last_merge=1.0000 (last merge round=17)
[S2] round=18 local utility u=0.172502 metrics={'f1_val': 0.7010840276709566, 'auprc': 0.7805235492748603, 'loss_val': 0.43895670017027644, 'psi': 0.732859836312518}-{'f1_val': 0.6996105493161282, 'auprc': 0.6630377769579933, 'loss_val': 0.4226615279917082, 'psi': 0.6849814403728742}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1785 reason=None
[S2] sending update (kind=head size=1785 to 1 peers)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=18 metric=0.7011 head_norm=1.044530
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.636300e-01
[S2] stored merged vector for next round verification (round=18)
[S2] DEBUG after merge:  round=18 metric=0.7011 head_norm=0.957815 delta_norm=0.363630
[S2] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S3] START round=18 head_norm_before_train=1.443088 cos_to_last_merge=0.8471 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.847
[S3] round=18 local utility u=0.006715 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9988635428043834, 'loss_val': 0.25493589319824755, 'psi': 0.8199539929209543}-{'f1_val': 0.7006809596653347, 'auprc': 0.9988552715088869, 'loss_val': 0.2683408196749896, 'psi': 0.8199506844027555}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=18 head_norm_before_train=1.276750 cos_to_last_merge=0.9979 (last merge round=15)
[S4] round=18 local utility u=0.005969 metrics={'f1_val': 0.6136990331734906, 'auprc': 0.9490746541007462, 'loss_val': 0.5012055718093413, 'psi': 0.7478492815443929}-{'f1_val': 0.6133733409079134, 'auprc': 0.9465755997179104, 'loss_val': 0.5036916156886033, 'psi': 0.7466542444319122}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=18 head_norm_before_train=0.947937 cos_to_last_merge=0.9973 (last merge round=16)
[S5] round=18 local utility u=0.335286 metrics={'f1_val': 0.7005691551769304, 'auprc': 0.9872661561447832, 'loss_val': 0.45832850923805596, 'psi': 0.8152479555640715}-{'f1_val': 0.700320598491359, 'auprc': 0.7879660659502881, 'loss_val': 0.5295091134926956, 'psi': 0.7353787854749306}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=18 head_norm_before_train=1.526464 cos_to_last_merge=0.9997 (last merge round=15)
[S6] round=18 local utility u=1.000000 metrics={'f1_val': 0.9566743853450015, 'auprc': 0.9631294466746343, 'loss_val': 0.24568195085134437, 'psi': 0.9592564098768546}-{'f1_val': 0.6780986813049714, 'auprc': 0.8058047985457527, 'loss_val': 0.5815713772718535, 'psi': 0.7291811282012839}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=18 head_norm_before_train=1.250365 cos_to_last_merge=0.8708 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.871
[S7] round=18 local utility u=0.000000 metrics={'f1_val': 0.6347071479986556, 'auprc': 0.8242700112056086, 'loss_val': 0.6548892676371459, 'psi': 0.7105322932814369}-{'f1_val': 0.693823141362238, 'auprc': 0.8494527980428042, 'loss_val': 0.584970867189226, 'psi': 0.7560750040344645}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=18 head_norm_before_train=1.755886 cos_to_last_merge=0.9993 (last merge round=15)
[S8] round=18 local utility u=0.002990 metrics={'f1_val': 0.9962657597515479, 'auprc': 0.999195946210519, 'loss_val': 0.09521372797942965, 'psi': 0.9974378343351363}-{'f1_val': 0.9963530749356245, 'auprc': 0.9989558023351535, 'loss_val': 0.10099629028853813, 'psi': 0.9973941658954362}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=18 head_norm_before_train=1.429759 cos_to_last_merge=0.8338 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.834
[S9] round=18 local utility u=0.888984 metrics={'f1_val': 0.9903686845626269, 'auprc': 0.9980932322029039, 'loss_val': 0.13299488953901503, 'psi': 0.9934585036187378}-{'f1_val': 0.7012165807733519, 'auprc': 0.9981153800865765, 'loss_val': 0.17611684215476683, 'psi': 0.8199761004986418}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] sending update (kind=head size=1803 to 1 peers)
[S10] START round=18 head_norm_before_train=0.971098 cos_to_last_merge=0.9993 (last merge round=16)
[S10] round=18 local utility u=0.965012 metrics={'f1_val': 0.9439653973315767, 'auprc': 0.9846933057695796, 'loss_val': 0.3298432348130802, 'psi': 0.9602565607067779}-{'f1_val': 0.6570476410251505, 'auprc': 0.9474972208381495, 'loss_val': 0.4267726685394047, 'psi': 0.7732274729503501}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1782 reason=None
[S10] sending update (kind=head size=1782 to 1 peers)
[S11] START round=18 head_norm_before_train=1.098230 cos_to_last_merge=0.9958 (last merge round=15)
[S11] round=18 local utility u=0.525523 metrics={'f1_val': 0.9967189926998994, 'auprc': 0.9966186133387203, 'loss_val': 0.18798613802544933, 'psi': 0.9966788409554277}-{'f1_val': 0.8704865388067649, 'auprc': 0.9967951806779166, 'loss_val': 0.4821662606693227, 'psi': 0.9210099955552256}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] sending update (kind=head size=1794 to 1 peers)
[S13] START round=18 head_norm_before_train=1.089645 cos_to_last_merge=0.9487 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.949
[S13] round=18 local utility u=0.138294 metrics={'f1_val': 0.6300276272367001, 'auprc': 0.642404183532165, 'loss_val': 0.5767118456366471, 'psi': 0.6349782497548861}-{'f1_val': 0.5910110462723974, 'auprc': 0.6810586638771868, 'loss_val': 0.7351640643814069, 'psi': 0.6270300933143131}
[S14] START round=18 head_norm_before_train=1.708483 cos_to_last_merge=1.0000 (last merge round=17)
[S14] round=18 local utility u=0.007598 metrics={'f1_val': 0.9974862827730671, 'auprc': 0.9991989027899837, 'loss_val': 0.07487304214969953, 'psi': 0.9981713307798337}-{'f1_val': 0.9969975081576651, 'auprc': 0.9974403578002948, 'loss_val': 0.08186009971725483, 'psi': 0.997174648014717}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] sending update (kind=head size=1793 to 1 peers)
[S15] START round=18 head_norm_before_train=1.721390 cos_to_last_merge=0.9936 (last merge round=13)
[S15] round=18 local utility u=0.726950 metrics={'f1_val': 0.9627773341797037, 'auprc': 0.9935842932935766, 'loss_val': 0.13115538615363276, 'psi': 0.9751001178252527}-{'f1_val': 0.7513835921705982, 'auprc': 0.9860629763246768, 'loss_val': 0.2941282425166351, 'psi': 0.8452553458322296}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=18 head_norm_before_train=1.004107 cos_to_last_merge=0.9942 (last merge round=15)
[S16] round=18 local utility u=0.434521 metrics={'f1_val': 0.9370985901784968, 'auprc': 0.9834492243492944, 'loss_val': 0.3627386028052519, 'psi': 0.9556388438468157}-{'f1_val': 0.8064458707973541, 'auprc': 0.9772504816572158, 'loss_val': 0.42926738937855685, 'psi': 0.8747677151412987}
[S17] START round=18 head_norm_before_train=1.765021 cos_to_last_merge=0.9941 (last merge round=13)
[S17] round=18 local utility u=0.000000 metrics={'f1_val': 0.47142727512404037, 'auprc': 0.6952843276547571, 'loss_val': 0.7051213940911805, 'psi': 0.5609700961363271}-{'f1_val': 0.6522495996365321, 'auprc': 0.8376602573368204, 'loss_val': 0.6519722126546084, 'psi': 0.7264138627166474}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:31602
[S16] sending update (kind=head size=1796 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1796) from S16
[S2] cosine check vs S16: cos=0.9303
[S2] START round=19 head_norm_before_train=0.957815 cos_to_last_merge=1.0000 (last merge round=18)
[S2] round=19 local utility u=0.000000 metrics={'f1_val': 0.7008628790567926, 'auprc': 0.677439816357625, 'loss_val': 0.39236935968467923, 'psi': 0.6914936539771255}-{'f1_val': 0.7010840276709566, 'auprc': 0.7805235492748603, 'loss_val': 0.43895670017027644, 'psi': 0.732859836312518}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=19 metric=0.7009 head_norm=1.009364
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.989574e-01
[S2] stored merged vector for next round verification (round=19)
[S2] DEBUG after merge:  round=19 metric=0.7009 head_norm=1.012869 delta_norm=0.198957
[S2] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] r=20 psi=0.691 u=0.0000 p_local=0.1119 f1=0.701 auprc=0.677 bytes=19726
[S3] START round=19 head_norm_before_train=1.461326 cos_to_last_merge=0.8435 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.844
[S3] round=19 local utility u=0.002907 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9987635741583863, 'loss_val': 0.2488226012486712, 'psi': 0.8199140054625553}-{'f1_val': 0.7006809596653347, 'auprc': 0.9988635428043834, 'loss_val': 0.25493589319824755, 'psi': 0.8199539929209543}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S3] r=20 psi=0.820 u=0.0029 p_local=0.0899 f1=0.701 auprc=0.999 bytes=26975
[S4] START round=19 head_norm_before_train=1.312837 cos_to_last_merge=0.9962 (last merge round=15)
[S4] round=19 local utility u=0.000000 metrics={'f1_val': 0.6138328483170146, 'auprc': 0.9441833225888956, 'loss_val': 0.49740553009770644, 'psi': 0.745973038025767}-{'f1_val': 0.6136990331734906, 'auprc': 0.9490746541007462, 'loss_val': 0.5012055718093413, 'psi': 0.7478492815443929}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=20 psi=0.746 u=0.0000 p_local=0.1161 f1=0.614 auprc=0.944 bytes=19758
[S5] START round=19 head_norm_before_train=0.980465 cos_to_last_merge=0.9922 (last merge round=16)
[S5] round=19 local utility u=0.000000 metrics={'f1_val': 0.6418505052176269, 'auprc': 0.7405050464930641, 'loss_val': 0.5774822678453823, 'psi': 0.6813123217278018}-{'f1_val': 0.7005691551769304, 'auprc': 0.9872661561447832, 'loss_val': 0.45832850923805596, 'psi': 0.8152479555640715}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=20 psi=0.681 u=0.0000 p_local=0.1440 f1=0.642 auprc=0.741 bytes=25124
[S6] START round=19 head_norm_before_train=1.541579 cos_to_last_merge=0.9994 (last merge round=15)
[S6] round=19 local utility u=0.000000 metrics={'f1_val': 0.8215481174691087, 'auprc': 0.9528116010506329, 'loss_val': 0.37878361386412174, 'psi': 0.8740535109017185}-{'f1_val': 0.9566743853450015, 'auprc': 0.9631294466746343, 'loss_val': 0.24568195085134437, 'psi': 0.9592564098768546}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=20 psi=0.874 u=0.0000 p_local=0.3779 f1=0.822 auprc=0.953 bytes=21566
[S7] START round=19 head_norm_before_train=1.271968 cos_to_last_merge=0.8657 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.866
[S7] round=19 local utility u=0.280645 metrics={'f1_val': 0.6792406870766001, 'auprc': 0.8754544378044234, 'loss_val': 0.5143537556427331, 'psi': 0.7577261873677295}-{'f1_val': 0.6347071479986556, 'auprc': 0.8242700112056086, 'loss_val': 0.6548892676371459, 'psi': 0.7105322932814369}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S7] r=20 psi=0.758 u=0.2806 p_local=0.2263 f1=0.679 auprc=0.875 bytes=23337
[S8] START round=19 head_norm_before_train=1.776999 cos_to_last_merge=0.9983 (last merge round=15)
[S8] round=19 local utility u=0.006793 metrics={'f1_val': 0.995160954146866, 'auprc': 0.9991907499538984, 'loss_val': 0.07498278006224522, 'psi': 0.9967728724696789}-{'f1_val': 0.9962657597515479, 'auprc': 0.999195946210519, 'loss_val': 0.09521372797942965, 'psi': 0.9974378343351363}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S8] r=20 psi=0.997 u=0.0068 p_local=0.1528 f1=0.995 auprc=0.999 bytes=30570
[S9] START round=19 head_norm_before_train=1.458717 cos_to_last_merge=0.8302 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.830
[S9] round=19 local utility u=0.022755 metrics={'f1_val': 0.9941601000394567, 'auprc': 0.9980872843243157, 'loss_val': 0.11021530948531427, 'psi': 0.9957309737534003}-{'f1_val': 0.9903686845626269, 'auprc': 0.9980932322029039, 'loss_val': 0.13299488953901503, 'psi': 0.9934585036187378}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] sending update (kind=head size=1803 to 1 peers)
[S9] r=20 psi=0.996 u=0.0228 p_local=0.1867 f1=0.994 auprc=0.998 bytes=28751
[S10] START round=19 head_norm_before_train=0.998705 cos_to_last_merge=0.9977 (last merge round=16)
[S10] round=19 local utility u=0.135530 metrics={'f1_val': 0.9804350054267811, 'auprc': 0.9902583465426826, 'loss_val': 0.2942965800622694, 'psi': 0.9843643418731418}-{'f1_val': 0.9439653973315767, 'auprc': 0.9846933057695796, 'loss_val': 0.3298432348130802, 'psi': 0.9602565607067779}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S10] sending update (kind=head size=1787 to 1 peers)
[S10] r=20 psi=0.984 u=0.1355 p_local=0.3531 f1=0.980 auprc=0.990 bytes=19685
[S11] START round=19 head_norm_before_train=1.132848 cos_to_last_merge=0.9931 (last merge round=15)
[S11] round=19 local utility u=0.000000 metrics={'f1_val': 0.8982443272315961, 'auprc': 0.9945145405046151, 'loss_val': 0.3946253492876694, 'psi': 0.9367524125408037}-{'f1_val': 0.9967189926998994, 'auprc': 0.9966186133387203, 'loss_val': 0.18798613802544933, 'psi': 0.9966788409554277}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] r=20 psi=0.937 u=0.0000 p_local=0.2307 f1=0.898 auprc=0.995 bytes=23320
[S13] START round=19 head_norm_before_train=1.116102 cos_to_last_merge=0.9393 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.939
[S13] round=19 local utility u=0.000000 metrics={'f1_val': 0.6136927044712097, 'auprc': 0.6772148102421576, 'loss_val': 0.6848777217639157, 'psi': 0.6391015467795889}-{'f1_val': 0.6300276272367001, 'auprc': 0.642404183532165, 'loss_val': 0.5767118456366471, 'psi': 0.6349782497548861}
[S14] START round=19 head_norm_before_train=1.740847 cos_to_last_merge=0.9997 (last merge round=17)
[S14] round=19 local utility u=0.005987 metrics={'f1_val': 0.997240356705793, 'auprc': 0.999228247326479, 'loss_val': 0.06151226600488105, 'psi': 0.9980355129540674}-{'f1_val': 0.9974862827730671, 'auprc': 0.9991989027899837, 'loss_val': 0.07487304214969953, 'psi': 0.9981713307798337}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S14] r=20 psi=0.998 u=0.0060 p_local=0.0818 f1=0.997 auprc=0.999 bytes=28743
[S15] START round=19 head_norm_before_train=1.748014 cos_to_last_merge=0.9915 (last merge round=13)
[S15] round=19 local utility u=0.074851 metrics={'f1_val': 0.983282731284665, 'auprc': 0.9972381912050879, 'loss_val': 0.1154481517156117, 'psi': 0.9888649152528342}-{'f1_val': 0.9627773341797037, 'auprc': 0.9935842932935766, 'loss_val': 0.13115538615363276, 'psi': 0.9751001178252527}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S15] r=20 psi=0.989 u=0.0749 p_local=0.3021 f1=0.983 auprc=0.997 bytes=28758
[S16] START round=19 head_norm_before_train=1.054590 cos_to_last_merge=0.9895 (last merge round=15)
[S16] round=19 local utility u=0.000000 metrics={'f1_val': 0.820943873278244, 'auprc': 0.8717008188881292, 'loss_val': 0.860832119421565, 'psi': 0.8412466515221981}-{'f1_val': 0.9370985901784968, 'auprc': 0.9834492243492944, 'loss_val': 0.3627386028052519, 'psi': 0.9556388438468157}
[S17] START round=19 head_norm_before_train=1.790046 cos_to_last_merge=0.9922 (last merge round=13)
[S17] round=19 local utility u=0.000000 metrics={'f1_val': 0.4720017943962307, 'auprc': 0.6894434961710114, 'loss_val': 0.7754828952893803, 'psi': 0.5589784751061431}-{'f1_val': 0.47142727512404037, 'auprc': 0.6952843276547571, 'loss_val': 0.7051213940911805, 'psi': 0.5609700961363271}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=20 psi=0.559 u=0.0000 p_local=0.1592 f1=0.472 auprc=0.689 bytes=26960
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=20 psi=0.639 u=0.0000 p_local=0.0890 f1=0.614 auprc=0.677 bytes=16184
[S16] r=20 psi=0.841 u=0.0000 p_local=0.3382 f1=0.821 auprc=0.872 bytes=21535
[S2] START round=20 head_norm_before_train=1.012869 cos_to_last_merge=1.0000 (last merge round=19)
[S2] round=20 local utility u=0.000000 metrics={'f1_val': 0.6996105493161282, 'auprc': 0.6587859207588576, 'loss_val': 0.37312505017160086, 'psi': 0.68328069789322}-{'f1_val': 0.7008628790567926, 'auprc': 0.677439816357625, 'loss_val': 0.39236935968467923, 'psi': 0.6914936539771255}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=20 head_norm_before_train=1.481706 cos_to_last_merge=0.8411 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.841
[S3] round=20 local utility u=0.008356 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9986921072515249, 'loss_val': 0.23234841251245905, 'psi': 0.8199305651417897}-{'f1_val': 0.7006809596653347, 'auprc': 0.9987635741583863, 'loss_val': 0.2488226012486712, 'psi': 0.8199140054625553}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=20 head_norm_before_train=1.342215 cos_to_last_merge=0.9945 (last merge round=15)
[S4] round=20 local utility u=0.005360 metrics={'f1_val': 0.6138025597392734, 'auprc': 0.934228342463063, 'loss_val': 0.4566391284434218, 'psi': 0.7419728728287893}-{'f1_val': 0.6138328483170146, 'auprc': 0.9441833225888956, 'loss_val': 0.49740553009770644, 'psi': 0.745973038025767}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S5] START round=20 head_norm_before_train=1.017359 cos_to_last_merge=0.9859 (last merge round=16)
[S5] round=20 local utility u=0.651455 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9898270173999715, 'loss_val': 0.3733633751885535, 'psi': 0.8161235974203369}-{'f1_val': 0.6418505052176269, 'auprc': 0.7405050464930641, 'loss_val': 0.5774822678453823, 'psi': 0.6813123217278018}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] sending update (kind=head size=1794 to 1 peers)
[S6] START round=20 head_norm_before_train=1.561735 cos_to_last_merge=0.9988 (last merge round=15)
[S6] round=20 local utility u=0.000000 metrics={'f1_val': 0.8203253445860137, 'auprc': 0.9512834125214547, 'loss_val': 0.42004899461817946, 'psi': 0.8727085717601901}-{'f1_val': 0.8215481174691087, 'auprc': 0.9528116010506329, 'loss_val': 0.37878361386412174, 'psi': 0.8740535109017185}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=20 head_norm_before_train=1.295319 cos_to_last_merge=0.8611 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.861
[S7] round=20 local utility u=0.000000 metrics={'f1_val': 0.39245220059605734, 'auprc': 0.7804090695428963, 'loss_val': 1.000103163510331, 'psi': 0.547634948174793}-{'f1_val': 0.6792406870766001, 'auprc': 0.8754544378044234, 'loss_val': 0.5143537556427331, 'psi': 0.7577261873677295}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=20 head_norm_before_train=1.797372 cos_to_last_merge=0.9971 (last merge round=15)
[S8] round=20 local utility u=0.000000 metrics={'f1_val': 0.9919528555747477, 'auprc': 0.9991926565850014, 'loss_val': 0.06957358359894253, 'psi': 0.9948487759788491}-{'f1_val': 0.995160954146866, 'auprc': 0.9991907499538984, 'loss_val': 0.07498278006224522, 'psi': 0.9967728724696789}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=20 head_norm_before_train=1.486660 cos_to_last_merge=0.8266 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.827
[S9] round=20 local utility u=0.000000 metrics={'f1_val': 0.9787460450212913, 'auprc': 0.99797408011834, 'loss_val': 0.12070757121695154, 'psi': 0.9864372590601108}-{'f1_val': 0.9941601000394567, 'auprc': 0.9980872843243157, 'loss_val': 0.11021530948531427, 'psi': 0.9957309737534003}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=20 head_norm_before_train=1.027605 cos_to_last_merge=0.9953 (last merge round=16)
[S10] round=20 local utility u=0.000000 metrics={'f1_val': 0.8224632263553114, 'auprc': 0.9335818161207785, 'loss_val': 0.5463475066842712, 'psi': 0.8669106622614983}-{'f1_val': 0.9804350054267811, 'auprc': 0.9902583465426826, 'loss_val': 0.2942965800622694, 'psi': 0.9843643418731418}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=20 head_norm_before_train=1.166296 cos_to_last_merge=0.9902 (last merge round=15)
[S11] round=20 local utility u=0.423818 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9960922194194535, 'loss_val': 0.14008811481971484, 'psi': 0.996219988249098}-{'f1_val': 0.8982443272315961, 'auprc': 0.9945145405046151, 'loss_val': 0.3946253492876694, 'psi': 0.9367524125408037}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=20 head_norm_before_train=1.137717 cos_to_last_merge=0.9328 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.933
[S13] round=20 local utility u=0.000000 metrics={'f1_val': 0.612464812362723, 'auprc': 0.6785037881298581, 'loss_val': 0.703137726790627, 'psi': 0.6388804026695771}-{'f1_val': 0.6136927044712097, 'auprc': 0.6772148102421576, 'loss_val': 0.6848777217639157, 'psi': 0.6391015467795889}
[S14] START round=20 head_norm_before_train=1.770347 cos_to_last_merge=0.9989 (last merge round=17)
[S14] round=20 local utility u=0.000945 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9974705626584367, 'loss_val': 0.05289250946725518, 'psi': 0.9971867299579737}-{'f1_val': 0.997240356705793, 'auprc': 0.999228247326479, 'loss_val': 0.06151226600488105, 'psi': 0.9980355129540674}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] sending update (kind=head size=1795 to 1 peers)
[S15] START round=20 head_norm_before_train=1.773292 cos_to_last_merge=0.9893 (last merge round=13)
[S15] round=20 local utility u=0.000000 metrics={'f1_val': 0.9004852072363687, 'auprc': 0.9928836647047903, 'loss_val': 0.16419162077124083, 'psi': 0.9374445902237374}-{'f1_val': 0.983282731284665, 'auprc': 0.9972381912050879, 'loss_val': 0.1154481517156117, 'psi': 0.9888649152528342}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=20 head_norm_before_train=1.098319 cos_to_last_merge=0.9845 (last merge round=15)
[S16] round=20 local utility u=0.691979 metrics={'f1_val': 0.9013455817944274, 'auprc': 0.9857733326863304, 'loss_val': 0.3015019422250761, 'psi': 0.9351166821511886}-{'f1_val': 0.820943873278244, 'auprc': 0.8717008188881292, 'loss_val': 0.860832119421565, 'psi': 0.8412466515221981}
[S17] START round=20 head_norm_before_train=1.810827 cos_to_last_merge=0.9906 (last merge round=13)
[S17] round=20 local utility u=0.668186 metrics={'f1_val': 0.6042019239242616, 'auprc': 0.842078934403721, 'loss_val': 0.6902181125878524, 'psi': 0.6993527281160454}-{'f1_val': 0.4720017943962307, 'auprc': 0.6894434961710114, 'loss_val': 0.7754828952893803, 'psi': 0.5589784751061431}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[S13]  timeout peer S11
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:31602
[S16] sending update (kind=head size=1798 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1798) from S16
[S2] cosine check vs S16: cos=0.9725
[S16] ⇄ pheromone p=0.409 → S2@127.0.0.1:31602
[S2] START round=21 head_norm_before_train=1.058042 cos_to_last_merge=0.9981 (last merge round=19)
[S2] round=21 local utility u=0.011273 metrics={'f1_val': 0.6996105493161282, 'auprc': 0.6593928675989175, 'loss_val': 0.35240080193424517, 'psi': 0.683523476629244}-{'f1_val': 0.6996105493161282, 'auprc': 0.6587859207588576, 'loss_val': 0.37312505017160086, 'psi': 0.68328069789322}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S2] sending update (kind=head size=1790 to 1 peers)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=21 metric=0.6996 head_norm=1.100069
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.446970e-01
[S2] stored merged vector for next round verification (round=21)
[S2] DEBUG after merge:  round=21 metric=0.6992 head_norm=1.107513 delta_norm=0.144697
[S2] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S3] START round=21 head_norm_before_train=1.501415 cos_to_last_merge=0.8386 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.839
[S3] round=21 local utility u=0.012249 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9986921257825352, 'loss_val': 0.20785020803294485, 'psi': 0.8199305725541939}-{'f1_val': 0.7007562037352997, 'auprc': 0.9986921072515249, 'loss_val': 0.23234841251245905, 'psi': 0.8199305651417897}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=21 head_norm_before_train=1.366048 cos_to_last_merge=0.9929 (last merge round=15)
[S4] round=21 local utility u=0.000000 metrics={'f1_val': 0.4930151115606107, 'auprc': 0.6602597510553313, 'loss_val': 0.4712157290145652, 'psi': 0.5599129673584989}-{'f1_val': 0.6138025597392734, 'auprc': 0.934228342463063, 'loss_val': 0.4566391284434218, 'psi': 0.7419728728287893}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=21 head_norm_before_train=1.049800 cos_to_last_merge=0.9785 (last merge round=16)
[S5] round=21 local utility u=0.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9634226329046888, 'loss_val': 0.3524817390122862, 'psi': 0.805561412256691}-{'f1_val': 0.7003213174339138, 'auprc': 0.9898270173999715, 'loss_val': 0.3733633751885535, 'psi': 0.8161235974203369}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=21 head_norm_before_train=1.577166 cos_to_last_merge=0.9981 (last merge round=15)
[S6] round=21 local utility u=0.000000 metrics={'f1_val': 0.6794210408694874, 'auprc': 0.8504664036957911, 'loss_val': 0.5138548911840488, 'psi': 0.7478391860000089}-{'f1_val': 0.8203253445860137, 'auprc': 0.9512834125214547, 'loss_val': 0.42004899461817946, 'psi': 0.8727085717601901}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=21 head_norm_before_train=1.315233 cos_to_last_merge=0.8571 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.857
[S7] round=21 local utility u=1.000000 metrics={'f1_val': 0.6950811487757682, 'auprc': 0.9133833479066011, 'loss_val': 0.3794174041809436, 'psi': 0.7824020284281014}-{'f1_val': 0.39245220059605734, 'auprc': 0.7804090695428963, 'loss_val': 1.000103163510331, 'psi': 0.547634948174793}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=21 head_norm_before_train=1.819507 cos_to_last_merge=0.9960 (last merge round=15)
[S8] round=21 local utility u=0.000000 metrics={'f1_val': 0.8881087256383217, 'auprc': 0.9971592473421349, 'loss_val': 0.12507027650623845, 'psi': 0.9317289343198469}-{'f1_val': 0.9919528555747477, 'auprc': 0.9991926565850014, 'loss_val': 0.06957358359894253, 'psi': 0.9948487759788491}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=21 head_norm_before_train=1.512697 cos_to_last_merge=0.8232 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.823
[S9] round=21 local utility u=0.069788 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9956114430083184, 'loss_val': 0.08152984813320097, 'psi': 0.9962408842916622}-{'f1_val': 0.9787460450212913, 'auprc': 0.99797408011834, 'loss_val': 0.12070757121695154, 'psi': 0.9864372590601108}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] sending update (kind=head size=1804 to 1 peers)
[S10] START round=21 head_norm_before_train=1.056924 cos_to_last_merge=0.9925 (last merge round=16)
[S10] round=21 local utility u=0.155017 metrics={'f1_val': 0.8510972973653018, 'auprc': 0.952797537482152, 'loss_val': 0.46576593118587595, 'psi': 0.8917773934120419}-{'f1_val': 0.8224632263553114, 'auprc': 0.9335818161207785, 'loss_val': 0.5463475066842712, 'psi': 0.8669106622614983}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S10] sending update (kind=head size=1791 to 1 peers)
[S11] START round=21 head_norm_before_train=1.193802 cos_to_last_merge=0.9873 (last merge round=15)
[S11] round=21 local utility u=0.000000 metrics={'f1_val': 0.9624999965055703, 'auprc': 0.9968588893688295, 'loss_val': 0.2066591842832962, 'psi': 0.976243553650874}-{'f1_val': 0.996305167468861, 'auprc': 0.9960922194194535, 'loss_val': 0.14008811481971484, 'psi': 0.996219988249098}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=21 head_norm_before_train=1.159065 cos_to_last_merge=0.9269 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.927
[S13] round=21 local utility u=0.108574 metrics={'f1_val': 0.634572841724458, 'auprc': 0.6680556754921003, 'loss_val': 0.5872943859423446, 'psi': 0.647965975231515}-{'f1_val': 0.612464812362723, 'auprc': 0.6785037881298581, 'loss_val': 0.703137726790627, 'psi': 0.6388804026695771}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=21 head_norm_before_train=1.803088 cos_to_last_merge=0.9978 (last merge round=17)
[S14] round=21 local utility u=0.003758 metrics={'f1_val': 0.9970007132142444, 'auprc': 0.9983341983578258, 'loss_val': 0.047985660909443555, 'psi': 0.997534107271677}-{'f1_val': 0.9969975081576651, 'auprc': 0.9974705626584367, 'loss_val': 0.05289250946725518, 'psi': 0.9971867299579737}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=21 head_norm_before_train=1.797777 cos_to_last_merge=0.9872 (last merge round=13)
[S15] round=21 local utility u=0.000000 metrics={'f1_val': 0.8877338953288895, 'auprc': 0.9925320304118288, 'loss_val': 0.20217650565557593, 'psi': 0.9296531493620652}-{'f1_val': 0.9004852072363687, 'auprc': 0.9928836647047903, 'loss_val': 0.16419162077124083, 'psi': 0.9374445902237374}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=21 head_norm_before_train=1.133531 cos_to_last_merge=0.9801 (last merge round=15)
[S16] round=21 local utility u=0.000000 metrics={'f1_val': 0.8332263823032383, 'auprc': 0.9324781903832489, 'loss_val': 0.5699009766488173, 'psi': 0.8729271055352426}-{'f1_val': 0.9013455817944274, 'auprc': 0.9857733326863304, 'loss_val': 0.3015019422250761, 'psi': 0.9351166821511886}
[S17] START round=21 head_norm_before_train=1.835263 cos_to_last_merge=0.9888 (last merge round=13)
[S17] round=21 local utility u=0.000000 metrics={'f1_val': 0.5770672859855056, 'auprc': 0.8107303378508997, 'loss_val': 0.7440836940838496, 'psi': 0.6705325067316632}-{'f1_val': 0.6042019239242616, 'auprc': 0.842078934403721, 'loss_val': 0.6902181125878524, 'psi': 0.6993527281160454}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=22 head_norm_before_train=1.107513 cos_to_last_merge=1.0000 (last merge round=21)
[S2] round=22 local utility u=0.000000 metrics={'f1_val': 0.6996105493161282, 'auprc': 0.6593288887996996, 'loss_val': 0.3623810750409082, 'psi': 0.6834978851095568}-{'f1_val': 0.6996105493161282, 'auprc': 0.6593928675989175, 'loss_val': 0.35240080193424517, 'psi': 0.683523476629244}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=22 head_norm_before_train=1.517866 cos_to_last_merge=0.8355 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.835
[S3] round=22 local utility u=0.000000 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.998510319504605, 'loss_val': 0.21648913864983468, 'psi': 0.8198127036010429}-{'f1_val': 0.7007562037352997, 'auprc': 0.9986921257825352, 'loss_val': 0.20785020803294485, 'psi': 0.8199305725541939}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=22 head_norm_before_train=1.385021 cos_to_last_merge=0.9916 (last merge round=15)
[S4] round=22 local utility u=0.790825 metrics={'f1_val': 0.6122651206131453, 'auprc': 0.9470197116046657, 'loss_val': 0.4653464298316573, 'psi': 0.7461669570097536}-{'f1_val': 0.4930151115606107, 'auprc': 0.6602597510553313, 'loss_val': 0.4712157290145652, 'psi': 0.5599129673584989}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=22 head_norm_before_train=1.082671 cos_to_last_merge=0.9716 (last merge round=16)
[S5] round=22 local utility u=0.000000 metrics={'f1_val': 0.6693660708197139, 'auprc': 0.7647370297882405, 'loss_val': 0.4010950239051786, 'psi': 0.7075144544071246}-{'f1_val': 0.700320598491359, 'auprc': 0.9634226329046888, 'loss_val': 0.3524817390122862, 'psi': 0.805561412256691}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=22 head_norm_before_train=1.591428 cos_to_last_merge=0.9973 (last merge round=15)
[S6] round=22 local utility u=0.678384 metrics={'f1_val': 0.8243440806690768, 'auprc': 0.957651237870973, 'loss_val': 0.34817927390423914, 'psi': 0.8776669435498352}-{'f1_val': 0.6794210408694874, 'auprc': 0.8504664036957911, 'loss_val': 0.5138548911840488, 'psi': 0.7478391860000089}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] sending update (kind=head size=1794 to 1 peers)
[S7] START round=22 head_norm_before_train=1.330339 cos_to_last_merge=0.8539 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.854
[S7] round=22 local utility u=0.000000 metrics={'f1_val': 0.4290231988927129, 'auprc': 0.7812510470185319, 'loss_val': 0.8979337611795968, 'psi': 0.5699143381430405}-{'f1_val': 0.6950811487757682, 'auprc': 0.9133833479066011, 'loss_val': 0.3794174041809436, 'psi': 0.7824020284281014}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=22 head_norm_before_train=1.842705 cos_to_last_merge=0.9949 (last merge round=15)
[S8] round=22 local utility u=0.347781 metrics={'f1_val': 0.9918210737370572, 'auprc': 0.9991757137365823, 'loss_val': 0.05783217163012088, 'psi': 0.9947629297368672}-{'f1_val': 0.8881087256383217, 'auprc': 0.9971592473421349, 'loss_val': 0.12507027650623845, 'psi': 0.9317289343198469}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] sending update (kind=head size=1804 to 1 peers)
[S9] START round=22 head_norm_before_train=1.535732 cos_to_last_merge=0.8204 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.820
[S9] round=22 local utility u=0.000000 metrics={'f1_val': 0.9903686845626269, 'auprc': 0.998320787181184, 'loss_val': 0.07344997064488903, 'psi': 0.9935495256100497}-{'f1_val': 0.9966605118138915, 'auprc': 0.9956114430083184, 'loss_val': 0.08152984813320097, 'psi': 0.9962408842916622}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=22 head_norm_before_train=1.081958 cos_to_last_merge=0.9896 (last merge round=16)
[S10] round=22 local utility u=0.620435 metrics={'f1_val': 0.994371642699025, 'auprc': 0.9970340052643072, 'loss_val': 0.2172518283957052, 'psi': 0.9954365877251379}-{'f1_val': 0.8510972973653018, 'auprc': 0.952797537482152, 'loss_val': 0.46576593118587595, 'psi': 0.8917773934120419}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S10] sending update (kind=head size=1791 to 1 peers)
[S11] START round=22 head_norm_before_train=1.219474 cos_to_last_merge=0.9845 (last merge round=15)
[S11] round=22 local utility u=0.140161 metrics={'f1_val': 0.9936043114724834, 'auprc': 0.9975181582486489, 'loss_val': 0.11494096891317261, 'psi': 0.9951698501829496}-{'f1_val': 0.9624999965055703, 'auprc': 0.9968588893688295, 'loss_val': 0.2066591842832962, 'psi': 0.976243553650874}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] sending update (kind=head size=1793 to 1 peers)
[S13] START round=22 head_norm_before_train=1.180032 cos_to_last_merge=0.9213 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.921
[S13] round=22 local utility u=0.000000 metrics={'f1_val': 0.6321499678448258, 'auprc': 0.664165739832248, 'loss_val': 0.6250720712717666, 'psi': 0.6449562766397947}-{'f1_val': 0.634572841724458, 'auprc': 0.6680556754921003, 'loss_val': 0.5872943859423446, 'psi': 0.647965975231515}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=22 head_norm_before_train=1.833295 cos_to_last_merge=0.9966 (last merge round=17)
[S14] round=22 local utility u=0.002729 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9975054166500201, 'loss_val': 0.0400214326803634, 'psi': 0.9972006715546071}-{'f1_val': 0.9970007132142444, 'auprc': 0.9983341983578258, 'loss_val': 0.047985660909443555, 'psi': 0.997534107271677}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] sending update (kind=head size=1804 to 1 peers)
[S15] START round=22 head_norm_before_train=1.816693 cos_to_last_merge=0.9855 (last merge round=13)
[S15] round=22 local utility u=0.405998 metrics={'f1_val': 0.9967385720225848, 'auprc': 0.9981075217744101, 'loss_val': 0.06093582885470538, 'psi': 0.9972861519233148}-{'f1_val': 0.8877338953288895, 'auprc': 0.9925320304118288, 'loss_val': 0.20217650565557593, 'psi': 0.9296531493620652}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=22 head_norm_before_train=1.171664 cos_to_last_merge=0.9745 (last merge round=15)
[S16] round=22 local utility u=0.758452 metrics={'f1_val': 0.9883375439418116, 'auprc': 0.9878496394160606, 'loss_val': 0.14977756738061124, 'psi': 0.9881423821315113}-{'f1_val': 0.8332263823032383, 'auprc': 0.9324781903832489, 'loss_val': 0.5699009766488173, 'psi': 0.8729271055352426}
[S17] START round=22 head_norm_before_train=1.863436 cos_to_last_merge=0.9868 (last merge round=13)
[S17] round=22 local utility u=0.121749 metrics={'f1_val': 0.5954037492359279, 'auprc': 0.8562019398152938, 'loss_val': 0.7470192769305802, 'psi': 0.6997230254676743}-{'f1_val': 0.5770672859855056, 'auprc': 0.8107303378508997, 'loss_val': 0.7440836940838496, 'psi': 0.6705325067316632}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] sending update (kind=head size=1793 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] → sending delta(kind=head bytes=1793) to S2@127.0.0.1:31602
[S16] sending update (kind=head size=1793 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1793) from S16
[S2] cosine check vs S16: cos=0.9844
[S2] START round=23 head_norm_before_train=1.142850 cos_to_last_merge=0.9994 (last merge round=21)
[S2] round=23 local utility u=0.000000 metrics={'f1_val': 0.6982447308139996, 'auprc': 0.6603246451616068, 'loss_val': 0.37109956802796745, 'psi': 0.6830766965530425}-{'f1_val': 0.6996105493161282, 'auprc': 0.6593288887996996, 'loss_val': 0.3623810750409082, 'psi': 0.6834978851095568}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=23 metric=0.6982 head_norm=1.174639
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.182379e-01
[S2] stored merged vector for next round verification (round=23)
[S2] DEBUG after merge:  round=23 metric=0.6964 head_norm=1.184586 delta_norm=0.118238
[S2] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S3] START round=23 head_norm_before_train=1.537982 cos_to_last_merge=0.8325 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.832
[S3] round=23 local utility u=0.236430 metrics={'f1_val': 0.7714972653119874, 'auprc': 0.9985152074224339, 'loss_val': 0.1685416472399719, 'psi': 0.8623044421561661}-{'f1_val': 0.7006809596653347, 'auprc': 0.998510319504605, 'loss_val': 0.21648913864983468, 'psi': 0.8198127036010429}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=23 head_norm_before_train=1.401534 cos_to_last_merge=0.9906 (last merge round=15)
[S4] round=23 local utility u=0.017710 metrics={'f1_val': 0.6175679620487586, 'auprc': 0.9492658602424495, 'loss_val': 0.46848093748721203, 'psi': 0.750247121326235}-{'f1_val': 0.6122651206131453, 'auprc': 0.9470197116046657, 'loss_val': 0.4653464298316573, 'psi': 0.7461669570097536}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=23 head_norm_before_train=1.117955 cos_to_last_merge=0.9659 (last merge round=16)
[S5] round=23 local utility u=0.192085 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.8044482620075581, 'loss_val': 0.32351242944973774, 'psi': 0.7421443404006278}-{'f1_val': 0.6693660708197139, 'auprc': 0.7647370297882405, 'loss_val': 0.4010950239051786, 'psi': 0.7075144544071246}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=23 head_norm_before_train=1.603702 cos_to_last_merge=0.9965 (last merge round=15)
[S6] round=23 local utility u=0.000000 metrics={'f1_val': 0.8216348460302321, 'auprc': 0.9573669029086405, 'loss_val': 0.3695457753500227, 'psi': 0.8759276687815954}-{'f1_val': 0.8243440806690768, 'auprc': 0.957651237870973, 'loss_val': 0.34817927390423914, 'psi': 0.8776669435498352}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=23 head_norm_before_train=1.342137 cos_to_last_merge=0.8506 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.851
[S7] round=23 local utility u=0.801005 metrics={'f1_val': 0.6333115300996126, 'auprc': 0.8056239507657527, 'loss_val': 0.5947734180097667, 'psi': 0.7022364983660686}-{'f1_val': 0.4290231988927129, 'auprc': 0.7812510470185319, 'loss_val': 0.8979337611795968, 'psi': 0.5699143381430405}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=23 head_norm_before_train=1.861867 cos_to_last_merge=0.9940 (last merge round=15)
[S8] round=23 local utility u=0.007849 metrics={'f1_val': 0.9933329447925694, 'auprc': 0.9993351558850124, 'loss_val': 0.0516830941218682, 'psi': 0.9957338292295466}-{'f1_val': 0.9918210737370572, 'auprc': 0.9991757137365823, 'loss_val': 0.05783217163012088, 'psi': 0.9947629297368672}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] sending update (kind=head size=1804 to 1 peers)
[S9] START round=23 head_norm_before_train=1.559933 cos_to_last_merge=0.8178 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.818
[S9] round=23 local utility u=0.027345 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9983459535298751, 'loss_val': 0.056585528270144556, 'psi': 0.997334688500285}-{'f1_val': 0.9903686845626269, 'auprc': 0.998320787181184, 'loss_val': 0.07344997064488903, 'psi': 0.9935495256100497}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S9] sending update (kind=head size=1806 to 1 peers)
[S10] START round=23 head_norm_before_train=1.102708 cos_to_last_merge=0.9869 (last merge round=16)
[S10] round=23 local utility u=0.015866 metrics={'f1_val': 0.9953063309450747, 'auprc': 0.9967710459506415, 'loss_val': 0.19033913697216936, 'psi': 0.9958922169473015}-{'f1_val': 0.994371642699025, 'auprc': 0.9970340052643072, 'loss_val': 0.2172518283957052, 'psi': 0.9954365877251379}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S10] sending update (kind=head size=1786 to 1 peers)
[S11] START round=23 head_norm_before_train=1.242721 cos_to_last_merge=0.9819 (last merge round=15)
[S11] round=23 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9941595761086683, 'loss_val': 0.13814340796043062, 'psi': 0.9953563152899145}-{'f1_val': 0.9936043114724834, 'auprc': 0.9975181582486489, 'loss_val': 0.11494096891317261, 'psi': 0.9951698501829496}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=23 head_norm_before_train=1.197093 cos_to_last_merge=0.9167 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.917
[S13] round=23 local utility u=0.000000 metrics={'f1_val': 0.588321549578799, 'auprc': 0.6735143932160486, 'loss_val': 0.8560666318162135, 'psi': 0.6223986870336988}-{'f1_val': 0.6321499678448258, 'auprc': 0.664165739832248, 'loss_val': 0.6250720712717666, 'psi': 0.6449562766397947}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=23 head_norm_before_train=1.861380 cos_to_last_merge=0.9954 (last merge round=17)
[S14] round=23 local utility u=0.005502 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9992282959714609, 'loss_val': 0.038107856201559924, 'psi': 0.9982819892184965}-{'f1_val': 0.9969975081576651, 'auprc': 0.9975054166500201, 'loss_val': 0.0400214326803634, 'psi': 0.9972006715546071}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=23 head_norm_before_train=1.832935 cos_to_last_merge=0.9840 (last merge round=13)
[S15] round=23 local utility u=0.000000 metrics={'f1_val': 0.7842304476740924, 'auprc': 0.9899686130563656, 'loss_val': 0.262206019466672, 'psi': 0.8665257138270017}-{'f1_val': 0.9967385720225848, 'auprc': 0.9981075217744101, 'loss_val': 0.06093582885470538, 'psi': 0.9972861519233148}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=23 head_norm_before_train=1.206097 cos_to_last_merge=0.9693 (last merge round=15)
[S16] round=23 local utility u=0.000000 metrics={'f1_val': 0.9347075989085812, 'auprc': 0.9861043668202847, 'loss_val': 0.324220076709137, 'psi': 0.9552663060732627}-{'f1_val': 0.9883375439418116, 'auprc': 0.9878496394160606, 'loss_val': 0.14977756738061124, 'psi': 0.9881423821315113}
[S17] START round=23 head_norm_before_train=1.890652 cos_to_last_merge=0.9847 (last merge round=13)
[S17] round=23 local utility u=0.000000 metrics={'f1_val': 0.5609055213701163, 'auprc': 0.8269124396541532, 'loss_val': 0.8174329503652784, 'psi': 0.6673082886837312}-{'f1_val': 0.5954037492359279, 'auprc': 0.8562019398152938, 'loss_val': 0.7470192769305802, 'psi': 0.6997230254676743}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=24 head_norm_before_train=1.184586 cos_to_last_merge=1.0000 (last merge round=23)
[S2] round=24 local utility u=0.110223 metrics={'f1_val': 0.7003200221687502, 'auprc': 0.7329895747722357, 'loss_val': 0.38110100360751376, 'psi': 0.7133878432101444}-{'f1_val': 0.6982447308139996, 'auprc': 0.6603246451616068, 'loss_val': 0.37109956802796745, 'psi': 0.6830766965530425}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=24 head_norm_before_train=1.559461 cos_to_last_merge=0.8300 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.830
[S3] round=24 local utility u=0.700526 metrics={'f1_val': 0.9973982357793907, 'auprc': 0.9986907702476618, 'loss_val': 0.1234227951715157, 'psi': 0.9979152495666992}-{'f1_val': 0.7714972653119874, 'auprc': 0.9985152074224339, 'loss_val': 0.1685416472399719, 'psi': 0.8623044421561661}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] sending update (kind=head size=1805 to 1 peers)
[S4] START round=24 head_norm_before_train=1.419820 cos_to_last_merge=0.9893 (last merge round=15)
[S4] round=24 local utility u=0.000000 metrics={'f1_val': 0.6158769552131451, 'auprc': 0.9485957984224996, 'loss_val': 0.47092585599322884, 'psi': 0.7489644924968869}-{'f1_val': 0.6175679620487586, 'auprc': 0.9492658602424495, 'loss_val': 0.46848093748721203, 'psi': 0.750247121326235}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=24 head_norm_before_train=1.154239 cos_to_last_merge=0.9600 (last merge round=16)
[S5] round=24 local utility u=0.291390 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9897011503691662, 'loss_val': 0.29476387225891765, 'psi': 0.8160728192424819}-{'f1_val': 0.7006083926626743, 'auprc': 0.8044482620075581, 'loss_val': 0.32351242944973774, 'psi': 0.7421443404006278}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=24 head_norm_before_train=1.622424 cos_to_last_merge=0.9953 (last merge round=15)
[S6] round=24 local utility u=0.350166 metrics={'f1_val': 0.9201336291510479, 'auprc': 0.9573086497568662, 'loss_val': 0.2600307360678328, 'psi': 0.9350036373933752}-{'f1_val': 0.8216348460302321, 'auprc': 0.9573669029086405, 'loss_val': 0.3695457753500227, 'psi': 0.8759276687815954}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=24 head_norm_before_train=1.353641 cos_to_last_merge=0.8475 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.848
[S7] round=24 local utility u=0.131600 metrics={'f1_val': 0.6509832281615475, 'auprc': 0.8265234611955328, 'loss_val': 0.500302564273122, 'psi': 0.7211993213751416}-{'f1_val': 0.6333115300996126, 'auprc': 0.8056239507657527, 'loss_val': 0.5947734180097667, 'psi': 0.7022364983660686}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=24 head_norm_before_train=1.881462 cos_to_last_merge=0.9931 (last merge round=15)
[S8] round=24 local utility u=0.000000 metrics={'f1_val': 0.9933434229799246, 'auprc': 0.9886491412047445, 'loss_val': 0.06484323446700441, 'psi': 0.9914657102698525}-{'f1_val': 0.9933329447925694, 'auprc': 0.9993351558850124, 'loss_val': 0.0516830941218682, 'psi': 0.9957338292295466}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=24 head_norm_before_train=1.582589 cos_to_last_merge=0.8154 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.815
[S9] round=24 local utility u=0.004260 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9984683665579722, 'loss_val': 0.048432322448328485, 'psi': 0.9973836537115237}-{'f1_val': 0.9966605118138915, 'auprc': 0.9983459535298751, 'loss_val': 0.056585528270144556, 'psi': 0.997334688500285}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=24 head_norm_before_train=1.124056 cos_to_last_merge=0.9839 (last merge round=16)
[S10] round=24 local utility u=0.000000 metrics={'f1_val': 0.828402720914977, 'auprc': 0.9443812067914212, 'loss_val': 0.48599758260102066, 'psi': 0.8747941152655547}-{'f1_val': 0.9953063309450747, 'auprc': 0.9967710459506415, 'loss_val': 0.19033913697216936, 'psi': 0.9958922169473015}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=24 head_norm_before_train=1.268867 cos_to_last_merge=0.9788 (last merge round=15)
[S11] round=24 local utility u=0.026128 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9955603182653161, 'loss_val': 0.09244667883950511, 'psi': 0.9961523300142802}-{'f1_val': 0.9961541414107454, 'auprc': 0.9941595761086683, 'loss_val': 0.13814340796043062, 'psi': 0.9953563152899145}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] sending update (kind=head size=1793 to 1 peers)
[S13] START round=24 head_norm_before_train=1.212098 cos_to_last_merge=0.9133 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.913
[S13] round=24 local utility u=0.201040 metrics={'f1_val': 0.6270879882855291, 'auprc': 0.6693291448196499, 'loss_val': 0.6740291864517226, 'psi': 0.6439844508991774}-{'f1_val': 0.588321549578799, 'auprc': 0.6735143932160486, 'loss_val': 0.8560666318162135, 'psi': 0.6223986870336988}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S13] sending update (kind=head size=1793 to 1 peers)
[S14] START round=24 head_norm_before_train=1.886664 cos_to_last_merge=0.9942 (last merge round=17)
[S14] round=24 local utility u=0.002033 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9992288039775561, 'loss_val': 0.03157947450962703, 'psi': 0.9980357356144982}-{'f1_val': 0.9976511180498535, 'auprc': 0.9992282959714609, 'loss_val': 0.038107856201559924, 'psi': 0.9982819892184965}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=24 head_norm_before_train=1.849581 cos_to_last_merge=0.9825 (last merge round=13)
[S15] round=24 local utility u=0.752287 metrics={'f1_val': 0.9970299290849798, 'auprc': 0.9972980684872066, 'loss_val': 0.05641644491077449, 'psi': 0.9971371848458706}-{'f1_val': 0.7842304476740924, 'auprc': 0.9899686130563656, 'loss_val': 0.262206019466672, 'psi': 0.8665257138270017}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=24 head_norm_before_train=1.240467 cos_to_last_merge=0.9642 (last merge round=15)
[S16] round=24 local utility u=0.000000 metrics={'f1_val': 0.84500536200864, 'auprc': 0.9827414397535401, 'loss_val': 0.7235822410096202, 'psi': 0.9000997931065999}-{'f1_val': 0.9347075989085812, 'auprc': 0.9861043668202847, 'loss_val': 0.324220076709137, 'psi': 0.9552663060732627}
[S17] START round=24 head_norm_before_train=1.914780 cos_to_last_merge=0.9829 (last merge round=13)
[S17] round=24 local utility u=0.000000 metrics={'f1_val': 0.5328232732318214, 'auprc': 0.7052487844199427, 'loss_val': 0.9892890588551415, 'psi': 0.6017934777070699}-{'f1_val': 0.5609055213701163, 'auprc': 0.8269124396541532, 'loss_val': 0.8174329503652784, 'psi': 0.6673082886837312}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=25 head_norm_before_train=1.212294 cos_to_last_merge=0.9996 (last merge round=23)
[S2] round=25 local utility u=0.000000 metrics={'f1_val': 0.7005009623318138, 'auprc': 0.6999395326188401, 'loss_val': 0.36265148818891596, 'psi': 0.7002763904466243}-{'f1_val': 0.7003200221687502, 'auprc': 0.7329895747722357, 'loss_val': 0.38110100360751376, 'psi': 0.7133878432101444}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=25 head_norm_before_train=1.581615 cos_to_last_merge=0.8261 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.826
[S3] round=25 local utility u=0.000000 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.998075097998111, 'loss_val': 0.2121277141042214, 'psi': 0.8196386149984453}-{'f1_val': 0.9973982357793907, 'auprc': 0.9986907702476618, 'loss_val': 0.1234227951715157, 'psi': 0.9979152495666992}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=25 head_norm_before_train=1.438487 cos_to_last_merge=0.9881 (last merge round=15)
[S4] round=25 local utility u=0.000000 metrics={'f1_val': 0.6146142493550543, 'auprc': 0.9452893995352395, 'loss_val': 0.4595722370569039, 'psi': 0.7468843094271285}-{'f1_val': 0.6158769552131451, 'auprc': 0.9485957984224996, 'loss_val': 0.47092585599322884, 'psi': 0.7489644924968869}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=25 head_norm_before_train=1.183222 cos_to_last_merge=0.9532 (last merge round=16)
[S5] round=25 local utility u=0.000000 metrics={'f1_val': 0.41734336430956875, 'auprc': 0.708544080848003, 'loss_val': 1.4335445716184965, 'psi': 0.5338236509249424}-{'f1_val': 0.700320598491359, 'auprc': 0.9897011503691662, 'loss_val': 0.29476387225891765, 'psi': 0.8160728192424819}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=25 head_norm_before_train=1.637022 cos_to_last_merge=0.9941 (last merge round=15)
[S6] round=25 local utility u=0.156569 metrics={'f1_val': 0.96065864167797, 'auprc': 0.9576085384685993, 'loss_val': 0.19094165562976317, 'psi': 0.9594386003942217}-{'f1_val': 0.9201336291510479, 'auprc': 0.9573086497568662, 'loss_val': 0.2600307360678328, 'psi': 0.9350036373933752}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] sending update (kind=head size=1796 to 1 peers)
[S7] START round=25 head_norm_before_train=1.364540 cos_to_last_merge=0.8452 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.845
[S7] round=25 local utility u=0.314778 metrics={'f1_val': 0.6942606935596871, 'auprc': 0.897992427199964, 'loss_val': 0.34481895215746244, 'psi': 0.7757533870157978}-{'f1_val': 0.6509832281615475, 'auprc': 0.8265234611955328, 'loss_val': 0.500302564273122, 'psi': 0.7211993213751416}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=25 head_norm_before_train=1.901378 cos_to_last_merge=0.9920 (last merge round=15)
[S8] round=25 local utility u=0.000000 metrics={'f1_val': 0.9839737891748364, 'auprc': 0.999095003537031, 'loss_val': 0.060424780846927685, 'psi': 0.9900222749197142}-{'f1_val': 0.9933434229799246, 'auprc': 0.9886491412047445, 'loss_val': 0.06484323446700441, 'psi': 0.9914657102698525}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=25 head_norm_before_train=1.607131 cos_to_last_merge=0.8132 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.813
[S9] round=25 local utility u=0.000000 metrics={'f1_val': 0.9937421749897083, 'auprc': 0.998482365419777, 'loss_val': 0.046333570576118754, 'psi': 0.9956382511617359}-{'f1_val': 0.9966605118138915, 'auprc': 0.9984683665579722, 'loss_val': 0.048432322448328485, 'psi': 0.9973836537115237}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=25 head_norm_before_train=1.148239 cos_to_last_merge=0.9802 (last merge round=16)
[S10] round=25 local utility u=0.359407 metrics={'f1_val': 0.8983640511975928, 'auprc': 0.985428662018857, 'loss_val': 0.3100948609951068, 'psi': 0.9331898955260984}-{'f1_val': 0.828402720914977, 'auprc': 0.9443812067914212, 'loss_val': 0.48599758260102066, 'psi': 0.8747941152655547}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S10] sending update (kind=head size=1792 to 1 peers)
[S11] START round=25 head_norm_before_train=1.295306 cos_to_last_merge=0.9758 (last merge round=15)
[S11] round=25 local utility u=0.000000 metrics={'f1_val': 0.9846296207675949, 'auprc': 0.9981106239575469, 'loss_val': 0.09653919233909083, 'psi': 0.9900220220435756}-{'f1_val': 0.9965470045135896, 'auprc': 0.9955603182653161, 'loss_val': 0.09244667883950511, 'psi': 0.9961523300142802}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=25 head_norm_before_train=1.224690 cos_to_last_merge=0.9098 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.910
[S13] round=25 local utility u=0.000000 metrics={'f1_val': 0.6112644941563288, 'auprc': 0.6729262762705669, 'loss_val': 0.7605302109374745, 'psi': 0.635929207002024}-{'f1_val': 0.6270879882855291, 'auprc': 0.6693291448196499, 'loss_val': 0.6740291864517226, 'psi': 0.6439844508991774}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=25 head_norm_before_train=1.906521 cos_to_last_merge=0.9932 (last merge round=17)
[S14] round=25 local utility u=0.000000 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9992080424405132, 'loss_val': 0.0300642568397843, 'psi': 0.9978817218708043}-{'f1_val': 0.997240356705793, 'auprc': 0.9992288039775561, 'loss_val': 0.03157947450962703, 'psi': 0.9980357356144982}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=25 head_norm_before_train=1.863788 cos_to_last_merge=0.9812 (last merge round=13)
[S15] round=25 local utility u=0.000000 metrics={'f1_val': 0.859864287636985, 'auprc': 0.9951493053189261, 'loss_val': 0.23108331396558343, 'psi': 0.9139782947097614}-{'f1_val': 0.9970299290849798, 'auprc': 0.9972980684872066, 'loss_val': 0.05641644491077449, 'psi': 0.9971371848458706}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=25 head_norm_before_train=1.274226 cos_to_last_merge=0.9585 (last merge round=15)
[S16] round=25 local utility u=0.208944 metrics={'f1_val': 0.8774783970572654, 'auprc': 0.9872160401304765, 'loss_val': 0.5139562679444373, 'psi': 0.9213734542865497}-{'f1_val': 0.84500536200864, 'auprc': 0.9827414397535401, 'loss_val': 0.7235822410096202, 'psi': 0.9000997931065999}
[S17] START round=25 head_norm_before_train=1.933700 cos_to_last_merge=0.9813 (last merge round=13)
[S17] round=25 local utility u=0.243203 metrics={'f1_val': 0.5851157892549874, 'auprc': 0.7630160999076411, 'loss_val': 0.989939282586498, 'psi': 0.656275913516049}-{'f1_val': 0.5328232732318214, 'auprc': 0.7052487844199427, 'loss_val': 0.9892890588551415, 'psi': 0.6017934777070699}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] sending update (kind=head size=1805 to 1 peers)
[S2] START round=26 head_norm_before_train=1.239010 cos_to_last_merge=0.9988 (last merge round=23)
[S2] round=26 local utility u=0.000000 metrics={'f1_val': 0.4649802405675234, 'auprc': 0.5991318394523525, 'loss_val': 1.3056979164750449, 'psi': 0.518640880121455}-{'f1_val': 0.7005009623318138, 'auprc': 0.6999395326188401, 'loss_val': 0.36265148818891596, 'psi': 0.7002763904466243}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=26 head_norm_before_train=1.602751 cos_to_last_merge=0.8236 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.824
[S3] round=26 local utility u=0.953721 metrics={'f1_val': 0.9977814963782642, 'auprc': 0.9988860926498131, 'loss_val': 0.08972106887155132, 'psi': 0.9982233348868839}-{'f1_val': 0.7006809596653347, 'auprc': 0.998075097998111, 'loss_val': 0.2121277141042214, 'psi': 0.8196386149984453}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=26 head_norm_before_train=1.457356 cos_to_last_merge=0.9867 (last merge round=15)
[S4] round=26 local utility u=0.995930 metrics={'f1_val': 0.9414409583144324, 'auprc': 0.947244418217276, 'loss_val': 0.4345373044917616, 'psi': 0.9437623422755699}-{'f1_val': 0.6146142493550543, 'auprc': 0.9452893995352395, 'loss_val': 0.4595722370569039, 'psi': 0.7468843094271285}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=26 head_norm_before_train=1.210561 cos_to_last_merge=0.9468 (last merge round=16)
[S5] ⚠️ Model drifted since last merge! cos=0.947
[S5] round=26 local utility u=1.000000 metrics={'f1_val': 0.6632222820181949, 'auprc': 0.9098623424621839, 'loss_val': 0.3540708878332788, 'psi': 0.7618783061957906}-{'f1_val': 0.41734336430956875, 'auprc': 0.708544080848003, 'loss_val': 1.4335445716184965, 'psi': 0.5338236509249424}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] sending update (kind=head size=1795 to 1 peers)
[S6] START round=26 head_norm_before_train=1.650576 cos_to_last_merge=0.9928 (last merge round=15)
[S6] round=26 local utility u=0.000000 metrics={'f1_val': 0.7862398572004745, 'auprc': 0.9301463787417787, 'loss_val': 0.5280435088814602, 'psi': 0.8438024658169962}-{'f1_val': 0.96065864167797, 'auprc': 0.9576085384685993, 'loss_val': 0.19094165562976317, 'psi': 0.9594386003942217}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=26 head_norm_before_train=1.376251 cos_to_last_merge=0.8436 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.844
[S7] round=26 local utility u=0.000000 metrics={'f1_val': 0.6227461752517662, 'auprc': 0.7870883947090188, 'loss_val': 0.6376496558590464, 'psi': 0.6884830630346672}-{'f1_val': 0.6942606935596871, 'auprc': 0.897992427199964, 'loss_val': 0.34481895215746244, 'psi': 0.7757533870157978}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=26 head_norm_before_train=1.920621 cos_to_last_merge=0.9909 (last merge round=15)
[S8] round=26 local utility u=0.000000 metrics={'f1_val': 0.7139758603458082, 'auprc': 0.9880340429423233, 'loss_val': 0.3083174921206478, 'psi': 0.8235991333844143}-{'f1_val': 0.9839737891748364, 'auprc': 0.999095003537031, 'loss_val': 0.060424780846927685, 'psi': 0.9900222749197142}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=26 head_norm_before_train=1.631477 cos_to_last_merge=0.8110 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.811
[S9] round=26 local utility u=0.012901 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9984654505808774, 'loss_val': 0.03799121605688556, 'psi': 0.9973824873206858}-{'f1_val': 0.9937421749897083, 'auprc': 0.998482365419777, 'loss_val': 0.046333570576118754, 'psi': 0.9956382511617359}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=26 head_norm_before_train=1.167391 cos_to_last_merge=0.9773 (last merge round=16)
[S10] round=26 local utility u=0.388261 metrics={'f1_val': 0.9957210358491089, 'auprc': 0.9968175900217153, 'loss_val': 0.15188097725299055, 'psi': 0.9961596575181515}-{'f1_val': 0.8983640511975928, 'auprc': 0.985428662018857, 'loss_val': 0.3100948609951068, 'psi': 0.9331898955260984}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=26 head_norm_before_train=1.322164 cos_to_last_merge=0.9724 (last merge round=15)
[S11] round=26 local utility u=0.000000 metrics={'f1_val': 0.9668027607210581, 'auprc': 0.9979748233704966, 'loss_val': 0.09164981758678602, 'psi': 0.9792715857808335}-{'f1_val': 0.9846296207675949, 'auprc': 0.9981106239575469, 'loss_val': 0.09653919233909083, 'psi': 0.9900220220435756}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=26 head_norm_before_train=1.235705 cos_to_last_merge=0.9073 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.907
[S13] round=26 local utility u=0.000000 metrics={'f1_val': 0.6088340698672052, 'auprc': 0.674030788653381, 'loss_val': 0.7830961106247529, 'psi': 0.6349127573816755}-{'f1_val': 0.6112644941563288, 'auprc': 0.6729262762705669, 'loss_val': 0.7605302109374745, 'psi': 0.635929207002024}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=26 head_norm_before_train=1.925937 cos_to_last_merge=0.9922 (last merge round=17)
[S14] round=26 local utility u=0.000000 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9984625356067642, 'loss_val': 0.036295013786551145, 'psi': 0.997829975943741}-{'f1_val': 0.9969975081576651, 'auprc': 0.9992080424405132, 'loss_val': 0.0300642568397843, 'psi': 0.9978817218708043}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=26 head_norm_before_train=1.878687 cos_to_last_merge=0.9799 (last merge round=13)
[S15] round=26 local utility u=0.482501 metrics={'f1_val': 0.992104680634552, 'auprc': 0.9985600401678913, 'loss_val': 0.06975616537212259, 'psi': 0.9946868244478877}-{'f1_val': 0.859864287636985, 'auprc': 0.9951493053189261, 'loss_val': 0.23108331396558343, 'psi': 0.9139782947097614}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=26 head_norm_before_train=1.307833 cos_to_last_merge=0.9529 (last merge round=15)
[S16] round=26 local utility u=0.526014 metrics={'f1_val': 0.9880774707943937, 'auprc': 0.9834083293822141, 'loss_val': 0.1140986128600521, 'psi': 0.9862098142295219}-{'f1_val': 0.8774783970572654, 'auprc': 0.9872160401304765, 'loss_val': 0.5139562679444373, 'psi': 0.9213734542865497}
[S17] START round=26 head_norm_before_train=1.946332 cos_to_last_merge=0.9800 (last merge round=13)
[S17] round=26 local utility u=0.000000 metrics={'f1_val': 0.5894015598483113, 'auprc': 0.7056084751492192, 'loss_val': 1.0552268053045712, 'psi': 0.6358843259686744}-{'f1_val': 0.5851157892549874, 'auprc': 0.7630160999076411, 'loss_val': 0.989939282586498, 'psi': 0.656275913516049}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S2] START round=27 head_norm_before_train=1.260968 cos_to_last_merge=0.9975 (last merge round=23)
[S2] round=27 local utility u=0.753176 metrics={'f1_val': 0.6226360988647085, 'auprc': 0.7393793435247485, 'loss_val': 1.166022947363136, 'psi': 0.6693333967287245}-{'f1_val': 0.4649802405675234, 'auprc': 0.5991318394523525, 'loss_val': 1.3056979164750449, 'psi': 0.518640880121455}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=27 head_norm_before_train=1.623807 cos_to_last_merge=0.8210 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.821
[S3] round=27 local utility u=0.000000 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.9988857836213071, 'loss_val': 0.10219935850068405, 'psi': 0.976175464111789}-{'f1_val': 0.9977814963782642, 'auprc': 0.9988860926498131, 'loss_val': 0.08972106887155132, 'psi': 0.9982233348868839}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=27 head_norm_before_train=1.474426 cos_to_last_merge=0.9856 (last merge round=15)
[S4] round=27 local utility u=0.000000 metrics={'f1_val': 0.6290228744150714, 'auprc': 0.9542223265497607, 'loss_val': 0.452704386325828, 'psi': 0.759102655268947}-{'f1_val': 0.9414409583144324, 'auprc': 0.947244418217276, 'loss_val': 0.4345373044917616, 'psi': 0.9437623422755699}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=27 head_norm_before_train=1.229266 cos_to_last_merge=0.9434 (last merge round=16)
[S5] ⚠️ Model drifted since last merge! cos=0.943
[S5] round=27 local utility u=0.000000 metrics={'f1_val': 0.5474039646237292, 'auprc': 0.8267727015035791, 'loss_val': 0.6942490916259216, 'psi': 0.6591514593756691}-{'f1_val': 0.6632222820181949, 'auprc': 0.9098623424621839, 'loss_val': 0.3540708878332788, 'psi': 0.7618783061957906}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=27 head_norm_before_train=1.663225 cos_to_last_merge=0.9915 (last merge round=15)
[S6] round=27 local utility u=0.649484 metrics={'f1_val': 0.9426980233206953, 'auprc': 0.9588268951233616, 'loss_val': 0.25386699738075225, 'psi': 0.9491495720417619}-{'f1_val': 0.7862398572004745, 'auprc': 0.9301463787417787, 'loss_val': 0.5280435088814602, 'psi': 0.8438024658169962}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=27 head_norm_before_train=1.386727 cos_to_last_merge=0.8422 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.842
[S7] round=27 local utility u=0.187637 metrics={'f1_val': 0.6627972987797015, 'auprc': 0.7987457959709099, 'loss_val': 0.537655013401562, 'psi': 0.7171766976561849}-{'f1_val': 0.6227461752517662, 'auprc': 0.7870883947090188, 'loss_val': 0.6376496558590464, 'psi': 0.6884830630346672}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S8] START round=27 head_norm_before_train=1.936554 cos_to_last_merge=0.9899 (last merge round=15)
[S8] round=27 local utility u=0.965333 metrics={'f1_val': 0.9869314642539011, 'auprc': 0.9992646769230069, 'loss_val': 0.049077050958563274, 'psi': 0.9918647493215433}-{'f1_val': 0.7139758603458082, 'auprc': 0.9880340429423233, 'loss_val': 0.3083174921206478, 'psi': 0.8235991333844143}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] sending update (kind=head size=1795 to 1 peers)
[S9] START round=27 head_norm_before_train=1.652700 cos_to_last_merge=0.8092 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.809
[S9] round=27 local utility u=0.000000 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9984778424846059, 'loss_val': 0.03501713271084311, 'psi': 0.9968871680123537}-{'f1_val': 0.9966605118138915, 'auprc': 0.9984654505808774, 'loss_val': 0.03799121605688556, 'psi': 0.9973824873206858}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=27 head_norm_before_train=1.182799 cos_to_last_merge=0.9749 (last merge round=16)
[S10] round=27 local utility u=0.000000 metrics={'f1_val': 0.9957455607450773, 'auprc': 0.9967762171164309, 'loss_val': 0.15661069651512127, 'psi': 0.9961578232936187}-{'f1_val': 0.9957210358491089, 'auprc': 0.9968175900217153, 'loss_val': 0.15188097725299055, 'psi': 0.9961596575181515}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=27 head_norm_before_train=1.344844 cos_to_last_merge=0.9697 (last merge round=15)
[S11] round=27 local utility u=0.096519 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9940187417737111, 'loss_val': 0.06375770924834076, 'psi': 0.995390597190801}-{'f1_val': 0.9668027607210581, 'auprc': 0.9979748233704966, 'loss_val': 0.09164981758678602, 'psi': 0.9792715857808335}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=27 head_norm_before_train=1.249800 cos_to_last_merge=0.9035 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.904
[S13] round=27 local utility u=0.088507 metrics={'f1_val': 0.6254607685343312, 'auprc': 0.6728359321531134, 'loss_val': 0.7022577123870847, 'psi': 0.6444108339818441}-{'f1_val': 0.6088340698672052, 'auprc': 0.674030788653381, 'loss_val': 0.7830961106247529, 'psi': 0.6349127573816755}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S13] sending update (kind=head size=1793 to 1 peers)
[S14] START round=27 head_norm_before_train=1.943642 cos_to_last_merge=0.9911 (last merge round=17)
[S14] round=27 local utility u=0.004811 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9992294138518769, 'loss_val': 0.026509413509506637, 'psi': 0.9978902704353498}-{'f1_val': 0.9974082695017256, 'auprc': 0.9984625356067642, 'loss_val': 0.036295013786551145, 'psi': 0.997829975943741}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=27 head_norm_before_train=1.894685 cos_to_last_merge=0.9785 (last merge round=13)
[S15] round=27 local utility u=0.000000 metrics={'f1_val': 0.9006698377957022, 'auprc': 0.9921241507436008, 'loss_val': 0.16237537528505044, 'psi': 0.9372515629748617}-{'f1_val': 0.992104680634552, 'auprc': 0.9985600401678913, 'loss_val': 0.06975616537212259, 'psi': 0.9946868244478877}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=27 head_norm_before_train=1.339476 cos_to_last_merge=0.9483 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.948
[S16] round=27 local utility u=0.009218 metrics={'f1_val': 0.9867095462986003, 'auprc': 0.9854060374955589, 'loss_val': 0.09344864830364472, 'psi': 0.9861881427773838}-{'f1_val': 0.9880774707943937, 'auprc': 0.9834083293822141, 'loss_val': 0.1140986128600521, 'psi': 0.9862098142295219}
[S17] START round=27 head_norm_before_train=1.955262 cos_to_last_merge=0.9789 (last merge round=13)
[S17] round=27 local utility u=0.425792 metrics={'f1_val': 0.5996658507405841, 'auprc': 0.8992213441779576, 'loss_val': 0.8460674139218032, 'psi': 0.7194880481155335}-{'f1_val': 0.5894015598483113, 'auprc': 0.7056084751492192, 'loss_val': 1.0552268053045712, 'psi': 0.6358843259686744}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S2] START round=28 head_norm_before_train=1.278297 cos_to_last_merge=0.9965 (last merge round=23)
[S2] round=28 local utility u=0.337740 metrics={'f1_val': 0.665870258806976, 'auprc': 0.774458356358546, 'loss_val': 0.8551859067897761, 'psi': 0.7093054978276041}-{'f1_val': 0.6226360988647085, 'auprc': 0.7393793435247485, 'loss_val': 1.166022947363136, 'psi': 0.6693333967287245}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=28 head_norm_before_train=1.646313 cos_to_last_merge=0.8185 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.818
[S3] round=28 local utility u=0.107114 metrics={'f1_val': 0.991512366291151, 'auprc': 0.998887682714206, 'loss_val': 0.07083920731590278, 'psi': 0.9944624928603731}-{'f1_val': 0.9610352511054436, 'auprc': 0.9988857836213071, 'loss_val': 0.10219935850068405, 'psi': 0.976175464111789}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=28 head_norm_before_train=1.493297 cos_to_last_merge=0.9846 (last merge round=15)
[S4] round=28 local utility u=1.000000 metrics={'f1_val': 0.9440435228309745, 'auprc': 0.9537438704170789, 'loss_val': 0.315813318777597, 'psi': 0.9479236618654162}-{'f1_val': 0.6290228744150714, 'auprc': 0.9542223265497607, 'loss_val': 0.452704386325828, 'psi': 0.759102655268947}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] START round=28 head_norm_before_train=1.243493 cos_to_last_merge=0.9413 (last merge round=16)
[S5] ⚠️ Model drifted since last merge! cos=0.941
[S5] round=28 local utility u=0.310092 metrics={'f1_val': 0.6046395529191901, 'auprc': 0.8522444847901142, 'loss_val': 0.49389386219324366, 'psi': 0.7036815256675597}-{'f1_val': 0.5474039646237292, 'auprc': 0.8267727015035791, 'loss_val': 0.6942490916259216, 'psi': 0.6591514593756691}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=28 head_norm_before_train=1.676791 cos_to_last_merge=0.9903 (last merge round=15)
[S6] round=28 local utility u=0.000000 metrics={'f1_val': 0.7975852515558659, 'auprc': 0.9528702055981348, 'loss_val': 0.5228449404203047, 'psi': 0.8596992331727735}-{'f1_val': 0.9426980233206953, 'auprc': 0.9588268951233616, 'loss_val': 0.25386699738075225, 'psi': 0.9491495720417619}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=28 head_norm_before_train=1.397001 cos_to_last_merge=0.8407 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.841
[S7] round=28 local utility u=0.000000 metrics={'f1_val': 0.574681987929928, 'auprc': 0.782569369169668, 'loss_val': 0.7046914095386324, 'psi': 0.657836940425824}-{'f1_val': 0.6627972987797015, 'auprc': 0.7987457959709099, 'loss_val': 0.537655013401562, 'psi': 0.7171766976561849}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=28 head_norm_before_train=1.947445 cos_to_last_merge=0.9891 (last merge round=15)
[S8] round=28 local utility u=0.006440 metrics={'f1_val': 0.9885804511658192, 'auprc': 0.9990948179227681, 'loss_val': 0.04558047610311549, 'psi': 0.9927861978685988}-{'f1_val': 0.9869314642539011, 'auprc': 0.9992646769230069, 'loss_val': 0.049077050958563274, 'psi': 0.9918647493215433}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] sending update (kind=head size=1795 to 1 peers)
[S9] START round=28 head_norm_before_train=1.673135 cos_to_last_merge=0.8077 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.808
[S9] round=28 local utility u=0.000000 metrics={'f1_val': 0.994356655862817, 'auprc': 0.9984285382752812, 'loss_val': 0.03801106539079387, 'psi': 0.9959854088278026}-{'f1_val': 0.9958267183641853, 'auprc': 0.9984778424846059, 'loss_val': 0.03501713271084311, 'psi': 0.9968871680123537}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=28 head_norm_before_train=1.199246 cos_to_last_merge=0.9722 (last merge round=16)
[S10] round=28 local utility u=0.000000 metrics={'f1_val': 0.863298695436616, 'auprc': 0.9788528552232207, 'loss_val': 0.3591730988298456, 'psi': 0.909520359351258}-{'f1_val': 0.9957455607450773, 'auprc': 0.9967762171164309, 'loss_val': 0.15661069651512127, 'psi': 0.9961578232936187}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=28 head_norm_before_train=1.367598 cos_to_last_merge=0.9666 (last merge round=15)
[S11] round=28 local utility u=0.000000 metrics={'f1_val': 0.8014846803535578, 'auprc': 0.9937043848376876, 'loss_val': 0.331822502367027, 'psi': 0.8783725621472097}-{'f1_val': 0.996305167468861, 'auprc': 0.9940187417737111, 'loss_val': 0.06375770924834076, 'psi': 0.995390597190801}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=28 head_norm_before_train=1.263216 cos_to_last_merge=0.9007 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.901
[S13] round=28 local utility u=0.000000 metrics={'f1_val': 0.6083241187857624, 'auprc': 0.6829658153813132, 'loss_val': 0.7700587586196617, 'psi': 0.6381807974239828}-{'f1_val': 0.6254607685343312, 'auprc': 0.6728359321531134, 'loss_val': 0.7022577123870847, 'psi': 0.6444108339818441}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=28 head_norm_before_train=1.955838 cos_to_last_merge=0.9903 (last merge round=17)
[S14] round=28 local utility u=0.002382 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9992303225318124, 'loss_val': 0.02566913399136975, 'psi': 0.9982827998426371}-{'f1_val': 0.9969975081576651, 'auprc': 0.9992294138518769, 'loss_val': 0.026509413509506637, 'psi': 0.9978902704353498}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=28 head_norm_before_train=1.905088 cos_to_last_merge=0.9776 (last merge round=13)
[S15] round=28 local utility u=0.000000 metrics={'f1_val': 0.8944601789325354, 'auprc': 0.9973393327934416, 'loss_val': 0.1812398036017562, 'psi': 0.9356118404768978}-{'f1_val': 0.9006698377957022, 'auprc': 0.9921241507436008, 'loss_val': 0.16237537528505044, 'psi': 0.9372515629748617}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=28 head_norm_before_train=1.368470 cos_to_last_merge=0.9443 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.944
[S16] round=28 local utility u=0.000000 metrics={'f1_val': 0.9086610706266239, 'auprc': 0.9875435504633413, 'loss_val': 0.2081778973509231, 'psi': 0.9402140625613109}-{'f1_val': 0.9867095462986003, 'auprc': 0.9854060374955589, 'loss_val': 0.09344864830364472, 'psi': 0.9861881427773838}
[S17] START round=28 head_norm_before_train=1.965106 cos_to_last_merge=0.9780 (last merge round=13)
[S17] round=28 local utility u=0.000000 metrics={'f1_val': 0.5948771690813379, 'auprc': 0.8043940014672699, 'loss_val': 0.9345115755591894, 'psi': 0.6786839020357107}-{'f1_val': 0.5996658507405841, 'auprc': 0.8992213441779576, 'loss_val': 0.8460674139218032, 'psi': 0.7194880481155335}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=29 head_norm_before_train=1.288759 cos_to_last_merge=0.9960 (last merge round=23)
[S2] round=29 local utility u=0.000000 metrics={'f1_val': 0.4471884254014683, 'auprc': 0.5979218080040292, 'loss_val': 1.477217920287724, 'psi': 0.5074817784424926}-{'f1_val': 0.665870258806976, 'auprc': 0.774458356358546, 'loss_val': 0.8551859067897761, 'psi': 0.7093054978276041}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=29 head_norm_before_train=1.666944 cos_to_last_merge=0.8160 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.816
[S3] round=29 local utility u=0.019905 metrics={'f1_val': 0.9965655661594752, 'auprc': 0.9990653362402047, 'loss_val': 0.06188065511633312, 'psi': 0.997565474191767}-{'f1_val': 0.991512366291151, 'auprc': 0.998887682714206, 'loss_val': 0.07083920731590278, 'psi': 0.9944624928603731}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=29 head_norm_before_train=1.512386 cos_to_last_merge=0.9830 (last merge round=15)
[S4] round=29 local utility u=0.027747 metrics={'f1_val': 0.9457929078065556, 'auprc': 0.958430830850248, 'loss_val': 0.2848762218515187, 'psi': 0.9508480770240326}-{'f1_val': 0.9440435228309745, 'auprc': 0.9537438704170789, 'loss_val': 0.315813318777597, 'psi': 0.9479236618654162}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=29 head_norm_before_train=1.257226 cos_to_last_merge=0.9406 (last merge round=16)
[S5] ⚠️ Model drifted since last merge! cos=0.941
[S5] round=29 local utility u=0.606624 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9878361452965285, 'loss_val': 0.26151155365206374, 'psi': 0.8153272485789597}-{'f1_val': 0.6046395529191901, 'auprc': 0.8522444847901142, 'loss_val': 0.49389386219324366, 'psi': 0.7036815256675597}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=29 head_norm_before_train=1.688809 cos_to_last_merge=0.9891 (last merge round=15)
[S6] round=29 local utility u=0.449069 metrics={'f1_val': 0.8989757643971958, 'auprc': 0.9657699139317992, 'loss_val': 0.27174964452158196, 'psi': 0.9256934242110372}-{'f1_val': 0.7975852515558659, 'auprc': 0.9528702055981348, 'loss_val': 0.5228449404203047, 'psi': 0.8596992331727735}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[S7] START round=29 head_norm_before_train=1.410871 cos_to_last_merge=0.8383 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.838
[S7] round=29 local utility u=0.465089 metrics={'f1_val': 0.6629356005975736, 'auprc': 0.8316470774219218, 'loss_val': 0.45126795681480725, 'psi': 0.730420191327313}-{'f1_val': 0.574681987929928, 'auprc': 0.782569369169668, 'loss_val': 0.7046914095386324, 'psi': 0.657836940425824}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=29 head_norm_before_train=1.958037 cos_to_last_merge=0.9884 (last merge round=15)
[S8] round=29 local utility u=0.000000 metrics={'f1_val': 0.7431147400774832, 'auprc': 0.9885337486266563, 'loss_val': 0.15435081886935287, 'psi': 0.8412823434971525}-{'f1_val': 0.9885804511658192, 'auprc': 0.9990948179227681, 'loss_val': 0.04558047610311549, 'psi': 0.9927861978685988}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=29 head_norm_before_train=1.692182 cos_to_last_merge=0.8063 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.806
[S9] round=29 local utility u=0.001243 metrics={'f1_val': 0.994356655862817, 'auprc': 0.9983712496431749, 'loss_val': 0.03535254262698251, 'psi': 0.9959624933749602}-{'f1_val': 0.994356655862817, 'auprc': 0.9984285382752812, 'loss_val': 0.03801106539079387, 'psi': 0.9959854088278026}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=29 head_norm_before_train=1.215341 cos_to_last_merge=0.9697 (last merge round=16)
[S10] round=29 local utility u=0.077555 metrics={'f1_val': 0.8732857334009247, 'auprc': 0.9915258196828785, 'loss_val': 0.3020051715226972, 'psi': 0.9205817679137063}-{'f1_val': 0.863298695436616, 'auprc': 0.9788528552232207, 'loss_val': 0.3591730988298456, 'psi': 0.909520359351258}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] sending update (kind=head size=1793 to 1 peers)
[S11] START round=29 head_norm_before_train=1.386106 cos_to_last_merge=0.9642 (last merge round=15)
[S11] round=29 local utility u=0.724224 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9954165967624649, 'loss_val': 0.0590076615437278, 'psi': 0.9961071210887142}-{'f1_val': 0.8014846803535578, 'auprc': 0.9937043848376876, 'loss_val': 0.331822502367027, 'psi': 0.8783725621472097}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] sending update (kind=head size=1794 to 1 peers)
[S13] START round=29 head_norm_before_train=1.274484 cos_to_last_merge=0.8974 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.897
[S13] round=29 local utility u=0.000000 metrics={'f1_val': 0.5885150677107703, 'auprc': 0.6771393410690578, 'loss_val': 0.8979052672932653, 'psi': 0.6239647770540853}-{'f1_val': 0.6083241187857624, 'auprc': 0.6829658153813132, 'loss_val': 0.7700587586196617, 'psi': 0.6381807974239828}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=29 head_norm_before_train=1.965875 cos_to_last_merge=0.9894 (last merge round=17)
[S14] round=29 local utility u=0.000000 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9991987151274331, 'loss_val': 0.02665307526131983, 'psi': 0.9981260826116701}-{'f1_val': 0.9976511180498535, 'auprc': 0.9992303225318124, 'loss_val': 0.02566913399136975, 'psi': 0.9982827998426371}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=29 head_norm_before_train=1.914919 cos_to_last_merge=0.9766 (last merge round=13)
[S15] round=29 local utility u=0.000000 metrics={'f1_val': 0.8010598345455304, 'auprc': 0.9923425789939503, 'loss_val': 0.27440709411992004, 'psi': 0.8775729323248984}-{'f1_val': 0.8944601789325354, 'auprc': 0.9973393327934416, 'loss_val': 0.1812398036017562, 'psi': 0.9356118404768978}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=29 head_norm_before_train=1.394746 cos_to_last_merge=0.9410 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.941
[S16] round=29 local utility u=0.000000 metrics={'f1_val': 0.8826981685831479, 'auprc': 0.9808464579831352, 'loss_val': 0.2778369860757092, 'psi': 0.9219574843431428}-{'f1_val': 0.9086610706266239, 'auprc': 0.9875435504633413, 'loss_val': 0.2081778973509231, 'psi': 0.9402140625613109}
[S17] START round=29 head_norm_before_train=1.972957 cos_to_last_merge=0.9774 (last merge round=13)
[S17] round=29 local utility u=0.000000 metrics={'f1_val': 0.5721539985411871, 'auprc': 0.6697212753814832, 'loss_val': 1.100254908236751, 'psi': 0.6111809092773055}-{'f1_val': 0.5948771690813379, 'auprc': 0.8043940014672699, 'loss_val': 0.9345115755591894, 'psi': 0.6786839020357107}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16]  timeout peer S2
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=30 head_norm_before_train=1.297828 cos_to_last_merge=0.9954 (last merge round=23)
[S2] round=30 local utility u=1.000000 metrics={'f1_val': 0.7003272262318709, 'auprc': 0.699711962589026, 'loss_val': 0.3572850936289593, 'psi': 0.7000811207747331}-{'f1_val': 0.4471884254014683, 'auprc': 0.5979218080040292, 'loss_val': 1.477217920287724, 'psi': 0.5074817784424926}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=30 head_norm_before_train=1.686277 cos_to_last_merge=0.8135 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.813
[S3] round=30 local utility u=0.003623 metrics={'f1_val': 0.9974247332315468, 'auprc': 0.9990640347986559, 'loss_val': 0.05978554951525535, 'psi': 0.9980804538583904}-{'f1_val': 0.9965655661594752, 'auprc': 0.9990653362402047, 'loss_val': 0.06188065511633312, 'psi': 0.997565474191767}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=30 head_norm_before_train=1.528169 cos_to_last_merge=0.9815 (last merge round=15)
[S4] round=30 local utility u=0.000000 metrics={'f1_val': 0.9373372378897347, 'auprc': 0.9565794225881004, 'loss_val': 0.3216177637476516, 'psi': 0.945034111769081}-{'f1_val': 0.9457929078065556, 'auprc': 0.958430830850248, 'loss_val': 0.2848762218515187, 'psi': 0.9508480770240326}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=30 head_norm_before_train=1.269676 cos_to_last_merge=0.9390 (last merge round=16)
[S5] ⚠️ Model drifted since last merge! cos=0.939
[S5] round=30 local utility u=0.000000 metrics={'f1_val': 0.4310594000518212, 'auprc': 0.8510826727288513, 'loss_val': 1.062517346284505, 'psi': 0.5990687091226332}-{'f1_val': 0.7003213174339138, 'auprc': 0.9878361452965285, 'loss_val': 0.26151155365206374, 'psi': 0.8153272485789597}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=30 head_norm_before_train=1.704899 cos_to_last_merge=0.9882 (last merge round=15)
[S6] round=30 local utility u=0.000000 metrics={'f1_val': 0.8228983218330205, 'auprc': 0.948192009518572, 'loss_val': 0.44306935988432716, 'psi': 0.8730157969072411}-{'f1_val': 0.8989757643971958, 'auprc': 0.9657699139317992, 'loss_val': 0.27174964452158196, 'psi': 0.9256934242110372}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=30 head_norm_before_train=1.425684 cos_to_last_merge=0.8365 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.837
[S7] round=30 local utility u=0.000000 metrics={'f1_val': 0.5881144948385504, 'auprc': 0.7940527173726033, 'loss_val': 0.7270925017464588, 'psi': 0.6704897838521715}-{'f1_val': 0.6629356005975736, 'auprc': 0.8316470774219218, 'loss_val': 0.45126795681480725, 'psi': 0.730420191327313}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=30 head_norm_before_train=1.969354 cos_to_last_merge=0.9877 (last merge round=15)
[S8] round=30 local utility u=0.819148 metrics={'f1_val': 0.9918109678295097, 'auprc': 0.9991231295242917, 'loss_val': 0.03999938963701938, 'psi': 0.9947358325074225}-{'f1_val': 0.7431147400774832, 'auprc': 0.9885337486266563, 'loss_val': 0.15435081886935287, 'psi': 0.8412823434971525}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=30 head_norm_before_train=1.710075 cos_to_last_merge=0.8050 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.805
[S9] round=30 local utility u=0.010595 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9984699958267558, 'loss_val': 0.02828267968296291, 'psi': 0.9973843054190372}-{'f1_val': 0.994356655862817, 'auprc': 0.9983712496431749, 'loss_val': 0.03535254262698251, 'psi': 0.9959624933749602}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=30 head_norm_before_train=1.237383 cos_to_last_merge=0.9660 (last merge round=16)
[S10] round=30 local utility u=0.435205 metrics={'f1_val': 0.9896564014416616, 'auprc': 0.9960062057456917, 'loss_val': 0.14325935973361767, 'psi': 0.9921963231632736}-{'f1_val': 0.8732857334009247, 'auprc': 0.9915258196828785, 'loss_val': 0.3020051715226972, 'psi': 0.9205817679137063}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] sending update (kind=head size=1794 to 1 peers)
[S11] START round=30 head_norm_before_train=1.404699 cos_to_last_merge=0.9622 (last merge round=15)
[S11] round=30 local utility u=0.000437 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9946723961217936, 'loss_val': 0.055900349669844474, 'psi': 0.9958094408324456}-{'f1_val': 0.996567470639547, 'auprc': 0.9954165967624649, 'loss_val': 0.0590076615437278, 'psi': 0.9961071210887142}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=30 head_norm_before_train=1.288741 cos_to_last_merge=0.8954 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.895
[S13] round=30 local utility u=0.269447 metrics={'f1_val': 0.6333757221311169, 'auprc': 0.6718385507797378, 'loss_val': 0.6122735682813478, 'psi': 0.6487608535905653}-{'f1_val': 0.5885150677107703, 'auprc': 0.6771393410690578, 'loss_val': 0.8979052672932653, 'psi': 0.6239647770540853}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=30 head_norm_before_train=1.978154 cos_to_last_merge=0.9887 (last merge round=17)
[S14] round=30 local utility u=0.000000 metrics={'f1_val': 0.9971652929977585, 'auprc': 0.9975241205619341, 'loss_val': 0.03049666431395735, 'psi': 0.9973088240234287}-{'f1_val': 0.9974109942678281, 'auprc': 0.9991987151274331, 'loss_val': 0.02665307526131983, 'psi': 0.9981260826116701}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=30 head_norm_before_train=1.922752 cos_to_last_merge=0.9759 (last merge round=13)
[S15] round=30 local utility u=0.572176 metrics={'f1_val': 0.959277181291259, 'auprc': 0.9927517263131982, 'loss_val': 0.08058736214927457, 'psi': 0.9726669993000348}-{'f1_val': 0.8010598345455304, 'auprc': 0.9923425789939503, 'loss_val': 0.27440709411992004, 'psi': 0.8775729323248984}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=30 head_norm_before_train=1.418557 cos_to_last_merge=0.9380 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.938
[S16] round=30 local utility u=0.000000 metrics={'f1_val': 0.8314209741301994, 'auprc': 0.8840664351428211, 'loss_val': 0.9720076964973574, 'psi': 0.8524791585352481}-{'f1_val': 0.8826981685831479, 'auprc': 0.9808464579831352, 'loss_val': 0.2778369860757092, 'psi': 0.9219574843431428}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=30 head_norm_before_train=1.976687 cos_to_last_merge=0.9768 (last merge round=13)
[S17] round=30 local utility u=0.105560 metrics={'f1_val': 0.5220586836466591, 'auprc': 0.7386240797523465, 'loss_val': 0.7952718803507994, 'psi': 0.608684842088934}-{'f1_val': 0.5721539985411871, 'auprc': 0.6697212753814832, 'loss_val': 1.100254908236751, 'psi': 0.6111809092773055}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=31 head_norm_before_train=1.306625 cos_to_last_merge=0.9948 (last merge round=23)
[S2] round=31 local utility u=0.005079 metrics={'f1_val': 0.7174022476351144, 'auprc': 0.7759511818854634, 'loss_val': 0.678294077988919, 'psi': 0.740821821335254}-{'f1_val': 0.7003272262318709, 'auprc': 0.699711962589026, 'loss_val': 0.3572850936289593, 'psi': 0.7000811207747331}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=31 head_norm_before_train=1.706197 cos_to_last_merge=0.8110 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.811
[S3] round=31 local utility u=0.000000 metrics={'f1_val': 0.9333688439197494, 'auprc': 0.9992323206996573, 'loss_val': 0.15466013391193212, 'psi': 0.9597142346317126}-{'f1_val': 0.9974247332315468, 'auprc': 0.9990640347986559, 'loss_val': 0.05978554951525535, 'psi': 0.9980804538583904}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=31 head_norm_before_train=1.544972 cos_to_last_merge=0.9797 (last merge round=15)
[S4] round=31 local utility u=0.105711 metrics={'f1_val': 0.9513273743726803, 'auprc': 0.9769411138623205, 'loss_val': 0.2552207755939147, 'psi': 0.9615728701685364}-{'f1_val': 0.9373372378897347, 'auprc': 0.9565794225881004, 'loss_val': 0.3216177637476516, 'psi': 0.945034111769081}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=31 head_norm_before_train=1.280578 cos_to_last_merge=0.9365 (last merge round=16)
[S5] ⚠️ Model drifted since last merge! cos=0.936
[S5] round=31 local utility u=0.537754 metrics={'f1_val': 0.5367532009351657, 'auprc': 0.8556252411395519, 'loss_val': 0.6348003967168337, 'psi': 0.6643020170169202}-{'f1_val': 0.4310594000518212, 'auprc': 0.8510826727288513, 'loss_val': 1.062517346284505, 'psi': 0.5990687091226332}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=31 head_norm_before_train=1.720307 cos_to_last_merge=0.9870 (last merge round=15)
[S6] round=31 local utility u=0.040008 metrics={'f1_val': 0.8229645554233702, 'auprc': 0.9601399850429309, 'loss_val': 0.39929475756825594, 'psi': 0.8778347272711945}-{'f1_val': 0.8228983218330205, 'auprc': 0.948192009518572, 'loss_val': 0.44306935988432716, 'psi': 0.8730157969072411}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] START round=31 head_norm_before_train=1.436693 cos_to_last_merge=0.8346 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.835
[S7] round=31 local utility u=0.650557 metrics={'f1_val': 0.6869847399191487, 'auprc': 0.8946561023604545, 'loss_val': 0.3210102490677092, 'psi': 0.7700532848956709}-{'f1_val': 0.5881144948385504, 'auprc': 0.7940527173726033, 'loss_val': 0.7270925017464588, 'psi': 0.6704897838521715}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=31 head_norm_before_train=1.975535 cos_to_last_merge=0.9874 (last merge round=15)
[S8] round=31 local utility u=0.003251 metrics={'f1_val': 0.9924611780272952, 'auprc': 0.9991105108415771, 'loss_val': 0.03735992896266098, 'psi': 0.9951209111530079}-{'f1_val': 0.9918109678295097, 'auprc': 0.9991231295242917, 'loss_val': 0.03999938963701938, 'psi': 0.9947358325074225}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] sending update (kind=head size=1804 to 1 peers)
[S9] START round=31 head_norm_before_train=1.727292 cos_to_last_merge=0.8037 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.804
[S9] round=31 local utility u=0.000000 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.992693088866384, 'loss_val': 0.02883922083189719, 'psi': 0.9948272924141202}-{'f1_val': 0.9966605118138915, 'auprc': 0.9984699958267558, 'loss_val': 0.02828267968296291, 'psi': 0.9973843054190372}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=31 head_norm_before_train=1.264937 cos_to_last_merge=0.9616 (last merge round=16)
[S10] round=31 local utility u=0.038109 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9963343628599001, 'loss_val': 0.10121459432144378, 'psi': 0.9956464485555849}-{'f1_val': 0.9896564014416616, 'auprc': 0.9960062057456917, 'loss_val': 0.14325935973361767, 'psi': 0.9921963231632736}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S10] sending update (kind=head size=1789 to 1 peers)
[S11] START round=31 head_norm_before_train=1.424753 cos_to_last_merge=0.9601 (last merge round=15)
[S11] round=31 local utility u=0.000000 metrics={'f1_val': 0.9804348644184568, 'auprc': 0.9947345122523601, 'loss_val': 0.09254658829101191, 'psi': 0.9861547235520182}-{'f1_val': 0.996567470639547, 'auprc': 0.9946723961217936, 'loss_val': 0.055900349669844474, 'psi': 0.9958094408324456}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=31 head_norm_before_train=1.299500 cos_to_last_merge=0.8942 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.894
[S13] round=31 local utility u=0.000000 metrics={'f1_val': 0.5869256965947354, 'auprc': 0.6869559899228053, 'loss_val': 0.8854928109629694, 'psi': 0.6269378139259634}-{'f1_val': 0.6333757221311169, 'auprc': 0.6718385507797378, 'loss_val': 0.6122735682813478, 'psi': 0.6487608535905653}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=31 head_norm_before_train=1.989052 cos_to_last_merge=0.9879 (last merge round=17)
[S14] round=31 local utility u=0.005580 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.9992255532056095, 'loss_val': 0.02836706606585038, 'psi': 0.9983819320625749}-{'f1_val': 0.9971652929977585, 'auprc': 0.9975241205619341, 'loss_val': 0.03049666431395735, 'psi': 0.9973088240234287}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=31 head_norm_before_train=1.930958 cos_to_last_merge=0.9751 (last merge round=13)
[S15] round=31 local utility u=0.000000 metrics={'f1_val': 0.915433612573497, 'auprc': 0.9971153149501598, 'loss_val': 0.09700763495358054, 'psi': 0.9481062935241621}-{'f1_val': 0.959277181291259, 'auprc': 0.9927517263131982, 'loss_val': 0.08058736214927457, 'psi': 0.9726669993000348}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=31 head_norm_before_train=1.439734 cos_to_last_merge=0.9351 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.935
[S16] round=31 local utility u=0.000000 metrics={'f1_val': 0.8291902125768069, 'auprc': 0.8849046997728668, 'loss_val': 1.0058389411036632, 'psi': 0.8514760074552309}-{'f1_val': 0.8314209741301994, 'auprc': 0.8840664351428211, 'loss_val': 0.9720076964973574, 'psi': 0.8524791585352481}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=31 head_norm_before_train=1.980547 cos_to_last_merge=0.9764 (last merge round=13)
[S17] round=31 local utility u=0.000000 metrics={'f1_val': 0.5346911843381307, 'auprc': 0.723595860568474, 'loss_val': 1.07490385525595, 'psi': 0.610253054830268}-{'f1_val': 0.5220586836466591, 'auprc': 0.7386240797523465, 'loss_val': 0.7952718803507994, 'psi': 0.608684842088934}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=32 head_norm_before_train=1.318674 cos_to_last_merge=0.9939 (last merge round=23)
[S2] round=32 local utility u=0.000000 metrics={'f1_val': 0.7137041599139898, 'auprc': 0.7581393929528186, 'loss_val': 0.6202434680918235, 'psi': 0.7314782531295214}-{'f1_val': 0.7174022476351144, 'auprc': 0.7759511818854634, 'loss_val': 0.678294077988919, 'psi': 0.740821821335254}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=32 head_norm_before_train=1.725766 cos_to_last_merge=0.8086 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.809
[S3] round=32 local utility u=0.240521 metrics={'f1_val': 0.9971279671228781, 'auprc': 0.999603064016724, 'loss_val': 0.05728602996627806, 'psi': 0.9981180058804165}-{'f1_val': 0.9333688439197494, 'auprc': 0.9992323206996573, 'loss_val': 0.15466013391193212, 'psi': 0.9597142346317126}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=32 head_norm_before_train=1.558766 cos_to_last_merge=0.9782 (last merge round=15)
[S4] round=32 local utility u=0.000000 metrics={'f1_val': 0.9363609029366902, 'auprc': 0.9561300016411007, 'loss_val': 0.3423392580188175, 'psi': 0.9442685424184545}-{'f1_val': 0.9513273743726803, 'auprc': 0.9769411138623205, 'loss_val': 0.2552207755939147, 'psi': 0.9615728701685364}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=32 head_norm_before_train=1.292161 cos_to_last_merge=0.9345 (last merge round=16)
[S5] ⚠️ Model drifted since last merge! cos=0.935
[S5] round=32 local utility u=0.262141 metrics={'f1_val': 0.595984545149659, 'auprc': 0.8605755152581757, 'loss_val': 0.48075742576579533, 'psi': 0.7018209331930656}-{'f1_val': 0.5367532009351657, 'auprc': 0.8556252411395519, 'loss_val': 0.6348003967168337, 'psi': 0.6643020170169202}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=32 head_norm_before_train=1.729007 cos_to_last_merge=0.9861 (last merge round=15)
[S6] round=32 local utility u=0.030563 metrics={'f1_val': 0.8242579999322431, 'auprc': 0.9634349328648606, 'loss_val': 0.3558136284220529, 'psi': 0.87992877310529}-{'f1_val': 0.8229645554233702, 'auprc': 0.9601399850429309, 'loss_val': 0.39929475756825594, 'psi': 0.8778347272711945}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=32 head_norm_before_train=1.443436 cos_to_last_merge=0.8327 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.833
[S7] round=32 local utility u=0.000000 metrics={'f1_val': 0.6269244373042804, 'auprc': 0.8017807322502193, 'loss_val': 0.5856202833186884, 'psi': 0.696866955282656}-{'f1_val': 0.6869847399191487, 'auprc': 0.8946561023604545, 'loss_val': 0.3210102490677092, 'psi': 0.7700532848956709}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=32 head_norm_before_train=1.982906 cos_to_last_merge=0.9875 (last merge round=15)
[S8] round=32 local utility u=0.002305 metrics={'f1_val': 0.9931893602624928, 'auprc': 0.9991517533347218, 'loss_val': 0.037241944223213426, 'psi': 0.9955743174913845}-{'f1_val': 0.9924611780272952, 'auprc': 0.9991105108415771, 'loss_val': 0.03735992896266098, 'psi': 0.9951209111530079}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] sending update (kind=head size=1795 to 1 peers)
[S9] START round=32 head_norm_before_train=1.742428 cos_to_last_merge=0.8022 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.802
[S9] round=32 local utility u=0.000000 metrics={'f1_val': 0.9876029063437939, 'auprc': 0.9985087385202672, 'loss_val': 0.05520883245227355, 'psi': 0.9919652392143833}-{'f1_val': 0.9962500947792776, 'auprc': 0.992693088866384, 'loss_val': 0.02883922083189719, 'psi': 0.9948272924141202}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=32 head_norm_before_train=1.295595 cos_to_last_merge=0.9568 (last merge round=16)
[S10] round=32 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9959049005389468, 'loss_val': 0.10075515567418004, 'psi': 0.9954746636272036}-{'f1_val': 0.9951878390193748, 'auprc': 0.9963343628599001, 'loss_val': 0.10121459432144378, 'psi': 0.9956464485555849}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=32 head_norm_before_train=1.446654 cos_to_last_merge=0.9577 (last merge round=15)
[S11] round=32 local utility u=0.074545 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9952052598329642, 'loss_val': 0.04154135401097609, 'psi': 0.9960103066413394}-{'f1_val': 0.9804348644184568, 'auprc': 0.9947345122523601, 'loss_val': 0.09254658829101191, 'psi': 0.9861547235520182}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] sending update (kind=head size=1805 to 1 peers)
[S13] START round=32 head_norm_before_train=1.308857 cos_to_last_merge=0.8935 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.893
[S13] round=32 local utility u=0.278023 metrics={'f1_val': 0.639741314768556, 'auprc': 0.6652871401631889, 'loss_val': 0.5813340670117957, 'psi': 0.6499596449264091}-{'f1_val': 0.5869256965947354, 'auprc': 0.6869559899228053, 'loss_val': 0.8854928109629694, 'psi': 0.6269378139259634}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=32 head_norm_before_train=2.001296 cos_to_last_merge=0.9870 (last merge round=17)
[S14] round=32 local utility u=0.001215 metrics={'f1_val': 0.9977975102598944, 'auprc': 0.9988524896851085, 'loss_val': 0.024685459219771173, 'psi': 0.9982195020299801}-{'f1_val': 0.9978195179672185, 'auprc': 0.9992255532056095, 'loss_val': 0.02836706606585038, 'psi': 0.9983819320625749}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=32 head_norm_before_train=1.940089 cos_to_last_merge=0.9743 (last merge round=13)
[S15] round=32 local utility u=0.000000 metrics={'f1_val': 0.9125852038189135, 'auprc': 0.9976541054694215, 'loss_val': 0.09822888744801175, 'psi': 0.9466127644791167}-{'f1_val': 0.915433612573497, 'auprc': 0.9971153149501598, 'loss_val': 0.09700763495358054, 'psi': 0.9481062935241621}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=32 head_norm_before_train=1.458065 cos_to_last_merge=0.9321 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.932
[S16] round=32 local utility u=1.000000 metrics={'f1_val': 0.9889662815640077, 'auprc': 0.984838957327896, 'loss_val': 0.06436404528167126, 'psi': 0.987315351869563}-{'f1_val': 0.8291902125768069, 'auprc': 0.8849046997728668, 'loss_val': 1.0058389411036632, 'psi': 0.8514760074552309}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=32 head_norm_before_train=1.985133 cos_to_last_merge=0.9759 (last merge round=13)
[S17] round=32 local utility u=0.526356 metrics={'f1_val': 0.5966958850342664, 'auprc': 0.8916048256239137, 'loss_val': 0.8982473981644449, 'psi': 0.7146594612701254}-{'f1_val': 0.5346911843381307, 'auprc': 0.723595860568474, 'loss_val': 1.07490385525595, 'psi': 0.610253054830268}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S17] sending update (kind=head size=1807 to 1 peers)
[S2] START round=33 head_norm_before_train=1.332625 cos_to_last_merge=0.9929 (last merge round=23)
[S2] round=33 local utility u=0.034303 metrics={'f1_val': 0.7119615035171536, 'auprc': 0.775579090889778, 'loss_val': 0.593501580546993, 'psi': 0.7374085384662034}-{'f1_val': 0.7137041599139898, 'auprc': 0.7581393929528186, 'loss_val': 0.6202434680918235, 'psi': 0.7314782531295214}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=33 head_norm_before_train=1.741514 cos_to_last_merge=0.8069 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.807
[S3] round=33 local utility u=0.000000 metrics={'f1_val': 0.9937979053077892, 'auprc': 0.9995933633148029, 'loss_val': 0.06450784958015697, 'psi': 0.9961160885105947}-{'f1_val': 0.9971279671228781, 'auprc': 0.999603064016724, 'loss_val': 0.05728602996627806, 'psi': 0.9981180058804165}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=33 head_norm_before_train=1.570280 cos_to_last_merge=0.9767 (last merge round=15)
[S4] round=33 local utility u=0.030859 metrics={'f1_val': 0.9374017713285883, 'auprc': 0.9621528153014833, 'loss_val': 0.30493426622598535, 'psi': 0.9473021889177462}-{'f1_val': 0.9363609029366902, 'auprc': 0.9561300016411007, 'loss_val': 0.3423392580188175, 'psi': 0.9442685424184545}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=33 head_norm_before_train=1.302409 cos_to_last_merge=0.9338 (last merge round=16)
[S5] ⚠️ Model drifted since last merge! cos=0.934
[S5] round=33 local utility u=0.000000 metrics={'f1_val': 0.4270083416429392, 'auprc': 0.834115486983956, 'loss_val': 1.0414386153525288, 'psi': 0.589851199779346}-{'f1_val': 0.595984545149659, 'auprc': 0.8605755152581757, 'loss_val': 0.48075742576579533, 'psi': 0.7018209331930656}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=33 head_norm_before_train=1.735539 cos_to_last_merge=0.9850 (last merge round=15)
[S6] round=33 local utility u=0.000000 metrics={'f1_val': 0.8183361527725654, 'auprc': 0.9583026986092434, 'loss_val': 0.46773925091408114, 'psi': 0.8743227711072367}-{'f1_val': 0.8242579999322431, 'auprc': 0.9634349328648606, 'loss_val': 0.3558136284220529, 'psi': 0.87992877310529}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=33 head_norm_before_train=1.448117 cos_to_last_merge=0.8313 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.831
[S7] round=33 local utility u=0.214884 metrics={'f1_val': 0.6626428934456896, 'auprc': 0.8276156416808339, 'loss_val': 0.4476678296184667, 'psi': 0.7286319927397473}-{'f1_val': 0.6269244373042804, 'auprc': 0.8017807322502193, 'loss_val': 0.5856202833186884, 'psi': 0.696866955282656}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=33 head_norm_before_train=1.992083 cos_to_last_merge=0.9875 (last merge round=15)
[S8] round=33 local utility u=0.000000 metrics={'f1_val': 0.9922396549535559, 'auprc': 0.9993191526405414, 'loss_val': 0.03758682705313299, 'psi': 0.9950714540283502}-{'f1_val': 0.9931893602624928, 'auprc': 0.9991517533347218, 'loss_val': 0.037241944223213426, 'psi': 0.9955743174913845}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=33 head_norm_before_train=1.756194 cos_to_last_merge=0.8010 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.801
[S9] round=33 local utility u=0.042082 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9983666827291546, 'loss_val': 0.02611617037998846, 'psi': 0.9974582243470163}-{'f1_val': 0.9876029063437939, 'auprc': 0.9985087385202672, 'loss_val': 0.05520883245227355, 'psi': 0.9919652392143833}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=33 head_norm_before_train=1.329442 cos_to_last_merge=0.9516 (last merge round=16)
[S10] round=33 local utility u=0.000000 metrics={'f1_val': 0.9566254138716745, 'auprc': 0.9937727651202446, 'loss_val': 0.14545544921134998, 'psi': 0.9714843543711026}-{'f1_val': 0.9951878390193748, 'auprc': 0.9959049005389468, 'loss_val': 0.10075515567418004, 'psi': 0.9954746636272036}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=33 head_norm_before_train=1.466709 cos_to_last_merge=0.9556 (last merge round=15)
[S11] round=33 local utility u=0.000000 metrics={'f1_val': 0.9946232161565767, 'auprc': 0.9951736779942999, 'loss_val': 0.04338701314865331, 'psi': 0.9948434008916659}-{'f1_val': 0.9965470045135896, 'auprc': 0.9952052598329642, 'loss_val': 0.04154135401097609, 'psi': 0.9960103066413394}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=33 head_norm_before_train=1.315182 cos_to_last_merge=0.8933 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.893
[S13] round=33 local utility u=0.000000 metrics={'f1_val': 0.6129326509819041, 'auprc': 0.6797631087058777, 'loss_val': 0.7540109736605979, 'psi': 0.6396648340714935}-{'f1_val': 0.639741314768556, 'auprc': 0.6652871401631889, 'loss_val': 0.5813340670117957, 'psi': 0.6499596449264091}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=33 head_norm_before_train=2.012709 cos_to_last_merge=0.9862 (last merge round=17)
[S14] round=33 local utility u=0.000000 metrics={'f1_val': 0.996754531653698, 'auprc': 0.9992190523333078, 'loss_val': 0.02363265390600918, 'psi': 0.9977403399255419}-{'f1_val': 0.9977975102598944, 'auprc': 0.9988524896851085, 'loss_val': 0.024685459219771173, 'psi': 0.9982195020299801}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=33 head_norm_before_train=1.949984 cos_to_last_merge=0.9734 (last merge round=13)
[S15] round=33 local utility u=0.000000 metrics={'f1_val': 0.7023932762864197, 'auprc': 0.9886569969229593, 'loss_val': 0.3410133604126341, 'psi': 0.8168987645410355}-{'f1_val': 0.9125852038189135, 'auprc': 0.9976541054694215, 'loss_val': 0.09822888744801175, 'psi': 0.9466127644791167}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=33 head_norm_before_train=1.474639 cos_to_last_merge=0.9296 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.930
[S16] round=33 local utility u=0.000000 metrics={'f1_val': 0.9267526752485901, 'auprc': 0.987631272471969, 'loss_val': 0.38387653739813216, 'psi': 0.9511041141379416}-{'f1_val': 0.9889662815640077, 'auprc': 0.984838957327896, 'loss_val': 0.06436404528167126, 'psi': 0.987315351869563}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=33 head_norm_before_train=1.995095 cos_to_last_merge=0.9753 (last merge round=13)
[S17] round=33 local utility u=0.121426 metrics={'f1_val': 0.6053586484541599, 'auprc': 0.9465439468582588, 'loss_val': 0.8721893739438108, 'psi': 0.7418327678157994}-{'f1_val': 0.5966958850342664, 'auprc': 0.8916048256239137, 'loss_val': 0.8982473981644449, 'psi': 0.7146594612701254}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=34 head_norm_before_train=1.345921 cos_to_last_merge=0.9921 (last merge round=23)
[S2] round=34 local utility u=0.006852 metrics={'f1_val': 0.7115696630980992, 'auprc': 0.7444658887358919, 'loss_val': 0.48410786472966033, 'psi': 0.7247281533532163}-{'f1_val': 0.7119615035171536, 'auprc': 0.775579090889778, 'loss_val': 0.593501580546993, 'psi': 0.7374085384662034}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=34 head_norm_before_train=1.755270 cos_to_last_merge=0.8054 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.805
[S3] round=34 local utility u=0.000000 metrics={'f1_val': 0.9836132272270699, 'auprc': 0.999199315070704, 'loss_val': 0.05320816482356059, 'psi': 0.9898476623645235}-{'f1_val': 0.9937979053077892, 'auprc': 0.9995933633148029, 'loss_val': 0.06450784958015697, 'psi': 0.9961160885105947}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=34 head_norm_before_train=1.583814 cos_to_last_merge=0.9749 (last merge round=15)
[S4] round=34 local utility u=0.062934 metrics={'f1_val': 0.9463321675320666, 'auprc': 0.9713381318284553, 'loss_val': 0.26020553717855666, 'psi': 0.9563345532506221}-{'f1_val': 0.9374017713285883, 'auprc': 0.9621528153014833, 'loss_val': 0.30493426622598535, 'psi': 0.9473021889177462}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=34 head_norm_before_train=1.312223 cos_to_last_merge=0.9332 (last merge round=16)
[S5] ⚠️ Model drifted since last merge! cos=0.933
[S5] round=34 local utility u=1.000000 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9878610394548042, 'loss_val': 0.2599851926569252, 'psi': 0.8153372062422699}-{'f1_val': 0.4270083416429392, 'auprc': 0.834115486983956, 'loss_val': 1.0414386153525288, 'psi': 0.589851199779346}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=34 head_norm_before_train=1.750351 cos_to_last_merge=0.9842 (last merge round=15)
[S6] round=34 local utility u=0.000000 metrics={'f1_val': 0.5961699071638893, 'auprc': 0.86475124921134, 'loss_val': 0.9205492988113921, 'psi': 0.7036024439828696}-{'f1_val': 0.8183361527725654, 'auprc': 0.9583026986092434, 'loss_val': 0.46773925091408114, 'psi': 0.8743227711072367}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=34 head_norm_before_train=1.454139 cos_to_last_merge=0.8297 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.830
[S7] round=34 local utility u=0.000000 metrics={'f1_val': 0.659317673893866, 'auprc': 0.8139422848428658, 'loss_val': 0.4885646907451809, 'psi': 0.7211675182734659}-{'f1_val': 0.6626428934456896, 'auprc': 0.8276156416808339, 'loss_val': 0.4476678296184667, 'psi': 0.7286319927397473}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=34 head_norm_before_train=2.001767 cos_to_last_merge=0.9872 (last merge round=15)
[S8] round=34 local utility u=0.000000 metrics={'f1_val': 0.9933434229799246, 'auprc': 0.9908872693643811, 'loss_val': 0.043327685376427984, 'psi': 0.9923609615337072}-{'f1_val': 0.9922396549535559, 'auprc': 0.9993191526405414, 'loss_val': 0.03758682705313299, 'psi': 0.9950714540283502}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=34 head_norm_before_train=1.766550 cos_to_last_merge=0.8002 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.800
[S9] round=34 local utility u=0.000695 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9984160140713462, 'loss_val': 0.0248749268777679, 'psi': 0.9974779568838927}-{'f1_val': 0.9968525854255906, 'auprc': 0.9983666827291546, 'loss_val': 0.02611617037998846, 'psi': 0.9974582243470163}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=34 head_norm_before_train=1.362424 cos_to_last_merge=0.9470 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.947
[S10] round=34 local utility u=0.136720 metrics={'f1_val': 0.9935584788187792, 'auprc': 0.9953914319517794, 'loss_val': 0.09846999633333796, 'psi': 0.9942916600719793}-{'f1_val': 0.9566254138716745, 'auprc': 0.9937727651202446, 'loss_val': 0.14545544921134998, 'psi': 0.9714843543711026}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] sending update (kind=head size=1794 to 1 peers)
[S11] START round=34 head_norm_before_train=1.485826 cos_to_last_merge=0.9536 (last merge round=15)
[S11] round=34 local utility u=0.000000 metrics={'f1_val': 0.9625786109096209, 'auprc': 0.9949657136230542, 'loss_val': 0.09805859964415183, 'psi': 0.9755334519949943}-{'f1_val': 0.9946232161565767, 'auprc': 0.9951736779942999, 'loss_val': 0.04338701314865331, 'psi': 0.9948434008916659}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=34 head_norm_before_train=1.318902 cos_to_last_merge=0.8929 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.893
[S13] round=34 local utility u=0.000000 metrics={'f1_val': 0.5968470907678031, 'auprc': 0.6839716311272053, 'loss_val': 0.8202635720537239, 'psi': 0.6316969069115639}-{'f1_val': 0.6129326509819041, 'auprc': 0.6797631087058777, 'loss_val': 0.7540109736605979, 'psi': 0.6396648340714935}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=34 head_norm_before_train=2.024240 cos_to_last_merge=0.9855 (last merge round=17)
[S14] round=34 local utility u=0.000211 metrics={'f1_val': 0.996754531653698, 'auprc': 0.999200023817185, 'loss_val': 0.023154546429657995, 'psi': 0.9977327285190928}-{'f1_val': 0.996754531653698, 'auprc': 0.9992190523333078, 'loss_val': 0.02363265390600918, 'psi': 0.9977403399255419}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] sending update (kind=head size=1795 to 1 peers)
[S15] START round=34 head_norm_before_train=1.960108 cos_to_last_merge=0.9725 (last merge round=13)
[S15] round=34 local utility u=1.000000 metrics={'f1_val': 0.9969902329512002, 'auprc': 0.9987911494547902, 'loss_val': 0.028741789876170255, 'psi': 0.9977105995526362}-{'f1_val': 0.7023932762864197, 'auprc': 0.9886569969229593, 'loss_val': 0.3410133604126341, 'psi': 0.8168987645410355}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=34 head_norm_before_train=1.488561 cos_to_last_merge=0.9272 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.927
[S16] round=34 local utility u=0.000000 metrics={'f1_val': 0.8496290555238138, 'auprc': 0.9835264927560642, 'loss_val': 0.864041121494905, 'psi': 0.9031880304167139}-{'f1_val': 0.9267526752485901, 'auprc': 0.987631272471969, 'loss_val': 0.38387653739813216, 'psi': 0.9511041141379416}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=34 head_norm_before_train=2.002801 cos_to_last_merge=0.9747 (last merge round=13)
[S17] round=34 local utility u=0.000000 metrics={'f1_val': 0.5939233709999856, 'auprc': 0.8104039266975208, 'loss_val': 1.0698005817376803, 'psi': 0.6805155932789997}-{'f1_val': 0.6053586484541599, 'auprc': 0.9465439468582588, 'loss_val': 0.8721893739438108, 'psi': 0.7418327678157994}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=35 head_norm_before_train=1.361614 cos_to_last_merge=0.9911 (last merge round=23)
[S2] round=35 local utility u=0.009642 metrics={'f1_val': 0.7119135641385711, 'auprc': 0.7739960270092924, 'loss_val': 0.5554782550160173, 'psi': 0.7367465492868597}-{'f1_val': 0.7115696630980992, 'auprc': 0.7444658887358919, 'loss_val': 0.48410786472966033, 'psi': 0.7247281533532163}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=35 head_norm_before_train=1.768642 cos_to_last_merge=0.8039 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.804
[S3] round=35 local utility u=0.000000 metrics={'f1_val': 0.9202842708254637, 'auprc': 0.9992397565721113, 'loss_val': 0.21638397122564595, 'psi': 0.9518664651241227}-{'f1_val': 0.9836132272270699, 'auprc': 0.999199315070704, 'loss_val': 0.05320816482356059, 'psi': 0.9898476623645235}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=35 head_norm_before_train=1.597733 cos_to_last_merge=0.9732 (last merge round=15)
[S4] round=35 local utility u=0.000000 metrics={'f1_val': 0.9414055056379602, 'auprc': 0.967175793060373, 'loss_val': 0.26855222290432684, 'psi': 0.9517136206069253}-{'f1_val': 0.9463321675320666, 'auprc': 0.9713381318284553, 'loss_val': 0.26020553717855666, 'psi': 0.9563345532506221}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=35 head_norm_before_train=1.319557 cos_to_last_merge=0.9330 (last merge round=16)
[S5] ⚠️ Model drifted since last merge! cos=0.933
[S5] round=35 local utility u=0.000000 metrics={'f1_val': 0.6462006400592504, 'auprc': 0.846780315365387, 'loss_val': 0.42872792023946277, 'psi': 0.7264325101817051}-{'f1_val': 0.7003213174339138, 'auprc': 0.9878610394548042, 'loss_val': 0.2599851926569252, 'psi': 0.8153372062422699}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=35 head_norm_before_train=1.765248 cos_to_last_merge=0.9831 (last merge round=15)
[S6] round=35 local utility u=1.000000 metrics={'f1_val': 0.8193686961762319, 'auprc': 0.9566959291750667, 'loss_val': 0.4953674089990327, 'psi': 0.8742995893757658}-{'f1_val': 0.5961699071638893, 'auprc': 0.86475124921134, 'loss_val': 0.9205492988113921, 'psi': 0.7036024439828696}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] START round=35 head_norm_before_train=1.460903 cos_to_last_merge=0.8284 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.828
[S7] round=35 local utility u=0.000000 metrics={'f1_val': 0.5983022120435746, 'auprc': 0.787201284135209, 'loss_val': 0.6883232365969585, 'psi': 0.6738618408802284}-{'f1_val': 0.659317673893866, 'auprc': 0.8139422848428658, 'loss_val': 0.4885646907451809, 'psi': 0.7211675182734659}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=35 head_norm_before_train=2.010453 cos_to_last_merge=0.9866 (last merge round=15)
[S8] round=35 local utility u=0.000000 metrics={'f1_val': 0.9878661038880452, 'auprc': 0.9990840130575571, 'loss_val': 0.04305331592085944, 'psi': 0.99235326755585}-{'f1_val': 0.9933434229799246, 'auprc': 0.9908872693643811, 'loss_val': 0.043327685376427984, 'psi': 0.9923609615337072}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=35 head_norm_before_train=1.774229 cos_to_last_merge=0.7993 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.799
[S9] round=35 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9984785097998896, 'loss_val': 0.02399929031840323, 'psi': 0.9973877110082907}-{'f1_val': 0.9968525854255906, 'auprc': 0.9984160140713462, 'loss_val': 0.0248749268777679, 'psi': 0.9974779568838927}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=35 head_norm_before_train=1.391926 cos_to_last_merge=0.9430 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.943
[S10] round=35 local utility u=0.016744 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9960501639874063, 'loss_val': 0.07673487224713697, 'psi': 0.9955327690065874}-{'f1_val': 0.9935584788187792, 'auprc': 0.9953914319517794, 'loss_val': 0.09846999633333796, 'psi': 0.9942916600719793}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=35 head_norm_before_train=1.503662 cos_to_last_merge=0.9516 (last merge round=15)
[S11] round=35 local utility u=0.000000 metrics={'f1_val': 0.8389855550711042, 'auprc': 0.9940420943799347, 'loss_val': 0.20423535105651575, 'psi': 0.9010081707946365}-{'f1_val': 0.9625786109096209, 'auprc': 0.9949657136230542, 'loss_val': 0.09805859964415183, 'psi': 0.9755334519949943}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=35 head_norm_before_train=1.324378 cos_to_last_merge=0.8913 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.891
[S13] round=35 local utility u=0.268174 metrics={'f1_val': 0.6427200950446174, 'auprc': 0.6725666594187211, 'loss_val': 0.5249389050664932, 'psi': 0.6546587207942589}-{'f1_val': 0.5968470907678031, 'auprc': 0.6839716311272053, 'loss_val': 0.8202635720537239, 'psi': 0.6316969069115639}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=35 head_norm_before_train=2.036772 cos_to_last_merge=0.9848 (last merge round=17)
[S14] round=35 local utility u=0.000000 metrics={'f1_val': 0.9971432857297993, 'auprc': 0.9986505919000008, 'loss_val': 0.025936424854215847, 'psi': 0.9977462081978798}-{'f1_val': 0.996754531653698, 'auprc': 0.999200023817185, 'loss_val': 0.023154546429657995, 'psi': 0.9977327285190928}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=35 head_norm_before_train=1.970405 cos_to_last_merge=0.9717 (last merge round=13)
[S15] round=35 local utility u=0.000000 metrics={'f1_val': 0.9024777935292774, 'auprc': 0.9980241221897594, 'loss_val': 0.12153197238864388, 'psi': 0.9406963249934702}-{'f1_val': 0.9969902329512002, 'auprc': 0.9987911494547902, 'loss_val': 0.028741789876170255, 'psi': 0.9977105995526362}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=35 head_norm_before_train=1.503268 cos_to_last_merge=0.9252 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.925
[S16] round=35 local utility u=0.000000 metrics={'f1_val': 0.8470421503789728, 'auprc': 0.9796949059317928, 'loss_val': 0.8888654577146058, 'psi': 0.9001032526001007}-{'f1_val': 0.8496290555238138, 'auprc': 0.9835264927560642, 'loss_val': 0.864041121494905, 'psi': 0.9031880304167139}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=35 head_norm_before_train=2.008852 cos_to_last_merge=0.9742 (last merge round=13)
[S17] round=35 local utility u=0.000000 metrics={'f1_val': 0.5834313673209122, 'auprc': 0.8112612593600571, 'loss_val': 1.0294199593588502, 'psi': 0.67456332413657}-{'f1_val': 0.5939233709999856, 'auprc': 0.8104039266975208, 'loss_val': 1.0698005817376803, 'psi': 0.6805155932789997}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=36 head_norm_before_train=1.378737 cos_to_last_merge=0.9900 (last merge round=23)
[S2] round=36 local utility u=0.000000 metrics={'f1_val': 0.6965468660329949, 'auprc': 0.7595549549130447, 'loss_val': 0.5990204910983117, 'psi': 0.7217501015850148}-{'f1_val': 0.7119135641385711, 'auprc': 0.7739960270092924, 'loss_val': 0.5554782550160173, 'psi': 0.7367465492868597}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=36 head_norm_before_train=1.779827 cos_to_last_merge=0.8024 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.802
[S3] round=36 local utility u=0.302311 metrics={'f1_val': 0.9966508675148381, 'auprc': 0.9996069390449529, 'loss_val': 0.0710632222095534, 'psi': 0.9978332961268841}-{'f1_val': 0.9202842708254637, 'auprc': 0.9992397565721113, 'loss_val': 0.21638397122564595, 'psi': 0.9518664651241227}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=36 head_norm_before_train=1.609793 cos_to_last_merge=0.9717 (last merge round=15)
[S4] round=36 local utility u=0.023937 metrics={'f1_val': 0.9463321675320666, 'auprc': 0.9710210450554226, 'loss_val': 0.26177470302406314, 'psi': 0.9562077185414091}-{'f1_val': 0.9414055056379602, 'auprc': 0.967175793060373, 'loss_val': 0.26855222290432684, 'psi': 0.9517136206069253}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] sending update (kind=head size=1805 to 1 peers)
[S5] START round=36 head_norm_before_train=1.325292 cos_to_last_merge=0.9330 (last merge round=16)
[S5] ⚠️ Model drifted since last merge! cos=0.933
[S5] round=36 local utility u=0.452415 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9892927911830052, 'loss_val': 0.2761592209095011, 'psi': 0.8159099069335503}-{'f1_val': 0.6462006400592504, 'auprc': 0.846780315365387, 'loss_val': 0.42872792023946277, 'psi': 0.7264325101817051}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] sending update (kind=head size=1805 to 1 peers)
[S6] START round=36 head_norm_before_train=1.773710 cos_to_last_merge=0.9819 (last merge round=15)
[S6] round=36 local utility u=0.000000 metrics={'f1_val': 0.6748993287404593, 'auprc': 0.922325167116186, 'loss_val': 0.7633181733220438, 'psi': 0.77386966409075}-{'f1_val': 0.8193686961762319, 'auprc': 0.9566959291750667, 'loss_val': 0.4953674089990327, 'psi': 0.8742995893757658}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=36 head_norm_before_train=1.469011 cos_to_last_merge=0.8264 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.826
[S7] round=36 local utility u=0.129902 metrics={'f1_val': 0.616100443035849, 'auprc': 0.7999182727362221, 'loss_val': 0.5734604878576753, 'psi': 0.6896275749159982}-{'f1_val': 0.5983022120435746, 'auprc': 0.787201284135209, 'loss_val': 0.6883232365969585, 'psi': 0.6738618408802284}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=36 head_norm_before_train=2.020641 cos_to_last_merge=0.9859 (last merge round=15)
[S8] round=36 local utility u=0.016008 metrics={'f1_val': 0.9920979054933599, 'auprc': 0.999076339824136, 'loss_val': 0.036405527557357875, 'psi': 0.9948892792256703}-{'f1_val': 0.9878661038880452, 'auprc': 0.9990840130575571, 'loss_val': 0.04305331592085944, 'psi': 0.99235326755585}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=36 head_norm_before_train=1.783151 cos_to_last_merge=0.7985 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.799
[S9] round=36 local utility u=0.000000 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9984949407459346, 'loss_val': 0.023655342066519376, 'psi': 0.996894007316885}-{'f1_val': 0.9966605118138915, 'auprc': 0.9984785097998896, 'loss_val': 0.02399929031840323, 'psi': 0.9973877110082907}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=36 head_norm_before_train=1.422176 cos_to_last_merge=0.9387 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.939
[S10] round=36 local utility u=0.004878 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.996153588335373, 'loss_val': 0.06728904762805972, 'psi': 0.995574138745774}-{'f1_val': 0.9951878390193748, 'auprc': 0.9960501639874063, 'loss_val': 0.07673487224713697, 'psi': 0.9955327690065874}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=36 head_norm_before_train=1.520896 cos_to_last_merge=0.9497 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.950
[S11] round=36 local utility u=0.512705 metrics={'f1_val': 0.9856635172453231, 'auprc': 0.9956779240191124, 'loss_val': 0.06380002470439877, 'psi': 0.9896692799548388}-{'f1_val': 0.8389855550711042, 'auprc': 0.9940420943799347, 'loss_val': 0.20423535105651575, 'psi': 0.9010081707946365}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] sending update (kind=head size=1803 to 1 peers)
[S13] START round=36 head_norm_before_train=1.330842 cos_to_last_merge=0.8882 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.888
[S13] round=36 local utility u=0.000000 metrics={'f1_val': 0.5971716847142248, 'auprc': 0.6842390562775319, 'loss_val': 0.8338219599783233, 'psi': 0.6319986333395475}-{'f1_val': 0.6427200950446174, 'auprc': 0.6725666594187211, 'loss_val': 0.5249389050664932, 'psi': 0.6546587207942589}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=36 head_norm_before_train=2.045356 cos_to_last_merge=0.9845 (last merge round=17)
[S14] round=36 local utility u=0.003985 metrics={'f1_val': 0.9970202894562089, 'auprc': 0.9992291359837482, 'loss_val': 0.018964215958894172, 'psi': 0.9979038280672247}-{'f1_val': 0.9971432857297993, 'auprc': 0.9986505919000008, 'loss_val': 0.025936424854215847, 'psi': 0.9977462081978798}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=36 head_norm_before_train=1.979541 cos_to_last_merge=0.9708 (last merge round=13)
[S15] round=36 local utility u=0.000000 metrics={'f1_val': 0.70291535201921, 'auprc': 0.9892420010981645, 'loss_val': 0.39439985981481546, 'psi': 0.8174460116507918}-{'f1_val': 0.9024777935292774, 'auprc': 0.9980241221897594, 'loss_val': 0.12153197238864388, 'psi': 0.9406963249934702}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=36 head_norm_before_train=1.516638 cos_to_last_merge=0.9233 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.923
[S16] round=36 local utility u=0.856549 metrics={'f1_val': 0.9899231233174718, 'auprc': 0.9883823117376412, 'loss_val': 0.059114760584328054, 'psi': 0.9893067986855395}-{'f1_val': 0.8470421503789728, 'auprc': 0.9796949059317928, 'loss_val': 0.8888654577146058, 'psi': 0.9001032526001007}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] sending update (kind=head size=1805 to 1 peers)
[S17] START round=36 head_norm_before_train=2.016651 cos_to_last_merge=0.9736 (last merge round=13)
[S17] round=36 local utility u=0.000000 metrics={'f1_val': 0.5413556136309221, 'auprc': 0.7248292322989109, 'loss_val': 1.2076656244917734, 'psi': 0.6147450610981177}-{'f1_val': 0.5834313673209122, 'auprc': 0.8112612593600571, 'loss_val': 1.0294199593588502, 'psi': 0.67456332413657}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=37 head_norm_before_train=1.393968 cos_to_last_merge=0.9889 (last merge round=23)
[S2] round=37 local utility u=0.000000 metrics={'f1_val': 0.6728646502559061, 'auprc': 0.7384225271120336, 'loss_val': 0.6998756179087502, 'psi': 0.6990878009983571}-{'f1_val': 0.6965468660329949, 'auprc': 0.7595549549130447, 'loss_val': 0.5990204910983117, 'psi': 0.7217501015850148}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=37 head_norm_before_train=1.790998 cos_to_last_merge=0.8012 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.801
[S3] round=37 local utility u=0.000000 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.9988104029114218, 'loss_val': 0.08096264400160733, 'psi': 0.9761453118278349}-{'f1_val': 0.9966508675148381, 'auprc': 0.9996069390449529, 'loss_val': 0.0710632222095534, 'psi': 0.9978332961268841}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=37 head_norm_before_train=1.619184 cos_to_last_merge=0.9708 (last merge round=15)
[S4] round=37 local utility u=0.024275 metrics={'f1_val': 0.9523521434696204, 'auprc': 0.9725892703199235, 'loss_val': 0.25404932319896845, 'psi': 0.9604469942097416}-{'f1_val': 0.9463321675320666, 'auprc': 0.9710210450554226, 'loss_val': 0.26177470302406314, 'psi': 0.9562077185414091}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=37 head_norm_before_train=1.329618 cos_to_last_merge=0.9326 (last merge round=16)
[S5] ⚠️ Model drifted since last merge! cos=0.933
[S5] round=37 local utility u=0.000000 metrics={'f1_val': 0.6942971329876401, 'auprc': 0.8531042936170488, 'loss_val': 0.3682557195990123, 'psi': 0.7578199972394035}-{'f1_val': 0.7003213174339138, 'auprc': 0.9892927911830052, 'loss_val': 0.2761592209095011, 'psi': 0.8159099069335503}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=37 head_norm_before_train=1.786569 cos_to_last_merge=0.9807 (last merge round=15)
[S6] round=37 local utility u=1.000000 metrics={'f1_val': 0.9596185109968016, 'auprc': 0.9663037951935378, 'loss_val': 0.18603277319180697, 'psi': 0.9622926246754961}-{'f1_val': 0.6748993287404593, 'auprc': 0.922325167116186, 'loss_val': 0.7633181733220438, 'psi': 0.77386966409075}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] sending update (kind=head size=1805 to 1 peers)
[S7] START round=37 head_norm_before_train=1.480972 cos_to_last_merge=0.8241 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.824
[S7] round=37 local utility u=0.033242 metrics={'f1_val': 0.6304960802471349, 'auprc': 0.8005570952161642, 'loss_val': 0.5952676248303387, 'psi': 0.6985204862347467}-{'f1_val': 0.616100443035849, 'auprc': 0.7999182727362221, 'loss_val': 0.5734604878576753, 'psi': 0.6896275749159982}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=37 head_norm_before_train=2.031095 cos_to_last_merge=0.9854 (last merge round=15)
[S8] round=37 local utility u=0.000268 metrics={'f1_val': 0.9920979054933599, 'auprc': 0.9992305983259796, 'loss_val': 0.03633140834582645, 'psi': 0.9949509826264078}-{'f1_val': 0.9920979054933599, 'auprc': 0.999076339824136, 'loss_val': 0.036405527557357875, 'psi': 0.9948892792256703}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=37 head_norm_before_train=1.793285 cos_to_last_merge=0.7979 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.798
[S9] round=37 local utility u=0.001391 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9985309144651198, 'loss_val': 0.023646182749585642, 'psi': 0.9971749832242915}-{'f1_val': 0.9958267183641853, 'auprc': 0.9984949407459346, 'loss_val': 0.023655342066519376, 'psi': 0.996894007316885}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=37 head_norm_before_train=1.450249 cos_to_last_merge=0.9351 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.935
[S10] round=37 local utility u=0.000000 metrics={'f1_val': 0.9342930783169008, 'auprc': 0.9929243201437132, 'loss_val': 0.171022452213207, 'psi': 0.9577455750476257}-{'f1_val': 0.9951878390193748, 'auprc': 0.996153588335373, 'loss_val': 0.06728904762805972, 'psi': 0.995574138745774}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=37 head_norm_before_train=1.537023 cos_to_last_merge=0.9480 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.948
[S11] round=37 local utility u=0.052623 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9980541693986317, 'loss_val': 0.030982763552893564, 'psi': 0.9971498704676064}-{'f1_val': 0.9856635172453231, 'auprc': 0.9956779240191124, 'loss_val': 0.06380002470439877, 'psi': 0.9896692799548388}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=37 head_norm_before_train=1.336691 cos_to_last_merge=0.8863 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.886
[S13] round=37 local utility u=0.000000 metrics={'f1_val': 0.5560559662029194, 'auprc': 0.69061511775716, 'loss_val': 1.029058940769257, 'psi': 0.6098796268246156}-{'f1_val': 0.5971716847142248, 'auprc': 0.6842390562775319, 'loss_val': 0.8338219599783233, 'psi': 0.6319986333395475}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=37 head_norm_before_train=2.052654 cos_to_last_merge=0.9841 (last merge round=17)
[S14] round=37 local utility u=0.002051 metrics={'f1_val': 0.9980403583402068, 'auprc': 0.9992319009116322, 'loss_val': 0.020990825645546454, 'psi': 0.998516975368777}-{'f1_val': 0.9970202894562089, 'auprc': 0.9992291359837482, 'loss_val': 0.018964215958894172, 'psi': 0.9979038280672247}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=37 head_norm_before_train=1.988459 cos_to_last_merge=0.9701 (last merge round=13)
[S15] round=37 local utility u=1.000000 metrics={'f1_val': 0.9966196520233872, 'auprc': 0.9976151467343471, 'loss_val': 0.02823980225280507, 'psi': 0.9970178499077712}-{'f1_val': 0.70291535201921, 'auprc': 0.9892420010981645, 'loss_val': 0.39439985981481546, 'psi': 0.8174460116507918}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=37 head_norm_before_train=1.529888 cos_to_last_merge=0.9212 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.921
[S16] round=37 local utility u=0.008398 metrics={'f1_val': 0.991361520093188, 'auprc': 0.9883897255689674, 'loss_val': 0.050971446206347776, 'psi': 0.9901728022834998}-{'f1_val': 0.9899231233174718, 'auprc': 0.9883823117376412, 'loss_val': 0.059114760584328054, 'psi': 0.9893067986855395}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S16] sending update (kind=head size=1807 to 1 peers)
[S17] START round=37 head_norm_before_train=2.025592 cos_to_last_merge=0.9730 (last merge round=13)
[S17] round=37 local utility u=0.223588 metrics={'f1_val': 0.5701315637023865, 'auprc': 0.7959409758322467, 'loss_val': 1.14648136698269, 'psi': 0.6604553285543305}-{'f1_val': 0.5413556136309221, 'auprc': 0.7248292322989109, 'loss_val': 1.2076656244917734, 'psi': 0.6147450610981177}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=38 head_norm_before_train=1.406914 cos_to_last_merge=0.9878 (last merge round=23)
[S2] round=38 local utility u=0.142340 metrics={'f1_val': 0.7180958370415149, 'auprc': 0.7526285700199992, 'loss_val': 0.7292005274472103, 'psi': 0.7319089302329086}-{'f1_val': 0.6728646502559061, 'auprc': 0.7384225271120336, 'loss_val': 0.6998756179087502, 'psi': 0.6990878009983571}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=38 head_norm_before_train=1.803593 cos_to_last_merge=0.8002 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.800
[S3] round=38 local utility u=0.000000 metrics={'f1_val': 0.960531351117436, 'auprc': 0.9986680411830662, 'loss_val': 0.1066649417531821, 'psi': 0.9757860271436881}-{'f1_val': 0.9610352511054436, 'auprc': 0.9988104029114218, 'loss_val': 0.08096264400160733, 'psi': 0.9761453118278349}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=38 head_norm_before_train=1.628569 cos_to_last_merge=0.9698 (last merge round=15)
[S4] round=38 local utility u=0.000000 metrics={'f1_val': 0.9526351935570936, 'auprc': 0.9665803393152588, 'loss_val': 0.25737082837020253, 'psi': 0.9582132518603597}-{'f1_val': 0.9523521434696204, 'auprc': 0.9725892703199235, 'loss_val': 0.25404932319896845, 'psi': 0.9604469942097416}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=38 head_norm_before_train=1.332502 cos_to_last_merge=0.9320 (last merge round=16)
[S5] ⚠️ Model drifted since last merge! cos=0.932
[S5] round=38 local utility u=0.299096 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9894317507766967, 'loss_val': 0.2151902991645893, 'psi': 0.815965490771027}-{'f1_val': 0.6942971329876401, 'auprc': 0.8531042936170488, 'loss_val': 0.3682557195990123, 'psi': 0.7578199972394035}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=38 head_norm_before_train=1.795842 cos_to_last_merge=0.9793 (last merge round=15)
[S6] round=38 local utility u=0.000000 metrics={'f1_val': 0.5962270882870159, 'auprc': 0.9437549002209263, 'loss_val': 0.8871765384131768, 'psi': 0.7352382130605801}-{'f1_val': 0.9596185109968016, 'auprc': 0.9663037951935378, 'loss_val': 0.18603277319180697, 'psi': 0.9622926246754961}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=38 head_norm_before_train=1.496191 cos_to_last_merge=0.8225 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.823
[S7] round=38 local utility u=0.187602 metrics={'f1_val': 0.6599141937715538, 'auprc': 0.8255671933479372, 'loss_val': 0.4716022745257741, 'psi': 0.7261753936021071}-{'f1_val': 0.6304960802471349, 'auprc': 0.8005570952161642, 'loss_val': 0.5952676248303387, 'psi': 0.6985204862347467}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=38 head_norm_before_train=2.039939 cos_to_last_merge=0.9848 (last merge round=15)
[S8] round=38 local utility u=0.000000 metrics={'f1_val': 0.9857995968093127, 'auprc': 0.9992587897653079, 'loss_val': 0.04478483704666609, 'psi': 0.9911832739917108}-{'f1_val': 0.9920979054933599, 'auprc': 0.9992305983259796, 'loss_val': 0.03633140834582645, 'psi': 0.9949509826264078}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=38 head_norm_before_train=1.803837 cos_to_last_merge=0.7972 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.797
[S9] round=38 local utility u=0.000000 metrics={'f1_val': 0.9920865114751727, 'auprc': 0.9988249475177653, 'loss_val': 0.030809847348173474, 'psi': 0.9947818858922097}-{'f1_val': 0.9962710290637395, 'auprc': 0.9985309144651198, 'loss_val': 0.023646182749585642, 'psi': 0.9971749832242915}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=38 head_norm_before_train=1.475969 cos_to_last_merge=0.9320 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.932
[S10] round=38 local utility u=0.244413 metrics={'f1_val': 0.9957455607450773, 'auprc': 0.9961798170145896, 'loss_val': 0.060677350725132986, 'psi': 0.9959192632528822}-{'f1_val': 0.9342930783169008, 'auprc': 0.9929243201437132, 'loss_val': 0.171022452213207, 'psi': 0.9577455750476257}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=38 head_norm_before_train=1.548128 cos_to_last_merge=0.9468 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.947
[S11] round=38 local utility u=0.000000 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9978257261159191, 'loss_val': 0.03270443599933979, 'psi': 0.9969133909276842}-{'f1_val': 0.9965470045135896, 'auprc': 0.9980541693986317, 'loss_val': 0.030982763552893564, 'psi': 0.9971498704676064}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=38 head_norm_before_train=1.345535 cos_to_last_merge=0.8852 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.885
[S13] round=38 local utility u=0.344147 metrics={'f1_val': 0.6249880556216231, 'auprc': 0.666124417633852, 'loss_val': 0.68088623155022, 'psi': 0.6414426004265146}-{'f1_val': 0.5560559662029194, 'auprc': 0.69061511775716, 'loss_val': 1.029058940769257, 'psi': 0.6098796268246156}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=38 head_norm_before_train=2.058264 cos_to_last_merge=0.9839 (last merge round=17)
[S14] round=38 local utility u=0.000000 metrics={'f1_val': 0.9973833833620065, 'auprc': 0.9992326401043433, 'loss_val': 0.02629515121797486, 'psi': 0.9981230860589412}-{'f1_val': 0.9980403583402068, 'auprc': 0.9992319009116322, 'loss_val': 0.020990825645546454, 'psi': 0.998516975368777}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=38 head_norm_before_train=1.997222 cos_to_last_merge=0.9693 (last merge round=13)
[S15] round=38 local utility u=0.000000 metrics={'f1_val': 0.9970299290849798, 'auprc': 0.9966171559187794, 'loss_val': 0.03389772678844228, 'psi': 0.9968648198184996}-{'f1_val': 0.9966196520233872, 'auprc': 0.9976151467343471, 'loss_val': 0.02823980225280507, 'psi': 0.9970178499077712}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=38 head_norm_before_train=1.542825 cos_to_last_merge=0.9191 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.919
[S16] round=38 local utility u=0.000000 metrics={'f1_val': 0.8877099598236925, 'auprc': 0.9859371829051896, 'loss_val': 0.5451336162483998, 'psi': 0.9270008490562913}-{'f1_val': 0.991361520093188, 'auprc': 0.9883897255689674, 'loss_val': 0.050971446206347776, 'psi': 0.9901728022834998}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=38 head_norm_before_train=2.037369 cos_to_last_merge=0.9722 (last merge round=13)
[S17] round=38 local utility u=0.000000 metrics={'f1_val': 0.5848932910104019, 'auprc': 0.7243964843292308, 'loss_val': 1.2485462888691439, 'psi': 0.6406945683379335}-{'f1_val': 0.5701315637023865, 'auprc': 0.7959409758322467, 'loss_val': 1.14648136698269, 'psi': 0.6604553285543305}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=39 head_norm_before_train=1.419329 cos_to_last_merge=0.9867 (last merge round=23)
[S2] round=39 local utility u=0.000000 metrics={'f1_val': 0.7182909591127976, 'auprc': 0.7529270027679447, 'loss_val': 0.7609278026907627, 'psi': 0.7321453765748565}-{'f1_val': 0.7180958370415149, 'auprc': 0.7526285700199992, 'loss_val': 0.7292005274472103, 'psi': 0.7319089302329086}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=40 psi=0.732 u=0.0000 p_local=0.0711 f1=0.718 auprc=0.753 bytes=37719
[S3] START round=39 head_norm_before_train=1.814864 cos_to_last_merge=0.7993 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.799
[S3] round=39 local utility u=0.151006 metrics={'f1_val': 0.9973415147416245, 'auprc': 0.998686610204867, 'loss_val': 0.025569991605003194, 'psi': 0.9978795529269215}-{'f1_val': 0.960531351117436, 'auprc': 0.9986680411830662, 'loss_val': 0.1066649417531821, 'psi': 0.9757860271436881}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] sending update (kind=head size=1795 to 1 peers)
[S3] r=40 psi=0.998 u=0.1510 p_local=0.0915 f1=0.997 auprc=0.999 bytes=46778
[S4] START round=39 head_norm_before_train=1.637079 cos_to_last_merge=0.9686 (last merge round=15)
[S4] round=39 local utility u=0.000000 metrics={'f1_val': 0.947923592895259, 'auprc': 0.9667103858409867, 'loss_val': 0.2647706591627309, 'psi': 0.9554383100735501}-{'f1_val': 0.9526351935570936, 'auprc': 0.9665803393152588, 'loss_val': 0.25737082837020253, 'psi': 0.9582132518603597}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=40 psi=0.955 u=0.0000 p_local=0.0486 f1=0.948 auprc=0.967 bytes=39566
[S5] START round=39 head_norm_before_train=1.337705 cos_to_last_merge=0.9307 (last merge round=16)
[S5] ⚠️ Model drifted since last merge! cos=0.931
[S5] round=39 local utility u=0.000000 metrics={'f1_val': 0.4272757364527509, 'auprc': 0.8550962015284244, 'loss_val': 1.2421053645637994, 'psi': 0.5984039224830203}-{'f1_val': 0.7003213174339138, 'auprc': 0.9894317507766967, 'loss_val': 0.2151902991645893, 'psi': 0.815965490771027}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=40 psi=0.598 u=0.0000 p_local=0.2248 f1=0.427 auprc=0.855 bytes=44931
[S6] START round=39 head_norm_before_train=1.802129 cos_to_last_merge=0.9774 (last merge round=15)
[S6] round=39 local utility u=1.000000 metrics={'f1_val': 0.9608951435574564, 'auprc': 0.9586366471309515, 'loss_val': 0.24714120990215427, 'psi': 0.9599917449868545}-{'f1_val': 0.5962270882870159, 'auprc': 0.9437549002209263, 'loss_val': 0.8871765384131768, 'psi': 0.7352382130605801}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S6] r=40 psi=0.960 u=1.0000 p_local=0.4424 f1=0.961 auprc=0.959 bytes=39568
[S7] START round=39 head_norm_before_train=1.507449 cos_to_last_merge=0.8214 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.821
[S7] round=39 local utility u=0.000000 metrics={'f1_val': 0.5674614494804028, 'auprc': 0.7896480566418878, 'loss_val': 0.8194393258000671, 'psi': 0.6563360923449968}-{'f1_val': 0.6599141937715538, 'auprc': 0.8255671933479372, 'loss_val': 0.4716022745257741, 'psi': 0.7261753936021071}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] r=40 psi=0.656 u=0.0000 p_local=0.1077 f1=0.567 auprc=0.790 bytes=43144
[S8] START round=39 head_norm_before_train=2.048484 cos_to_last_merge=0.9842 (last merge round=15)
[S8] round=39 local utility u=0.025331 metrics={'f1_val': 0.9926457841098181, 'auprc': 0.9992851010892868, 'loss_val': 0.03527838446518877, 'psi': 0.9953015109016055}-{'f1_val': 0.9857995968093127, 'auprc': 0.9992587897653079, 'loss_val': 0.04478483704666609, 'psi': 0.9911832739917108}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S8] r=40 psi=0.995 u=0.0253 p_local=0.0457 f1=0.993 auprc=0.999 bytes=48562
[S9] START round=39 head_norm_before_train=1.813040 cos_to_last_merge=0.7963 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.796
[S9] round=39 local utility u=0.017725 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9984833200755879, 'loss_val': 0.021779229182959044, 'psi': 0.99738963511857}-{'f1_val': 0.9920865114751727, 'auprc': 0.9988249475177653, 'loss_val': 0.030809847348173474, 'psi': 0.9947818858922097}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S9] r=40 psi=0.997 u=0.0177 p_local=0.0090 f1=0.997 auprc=0.998 bytes=46764
[S10] START round=39 head_norm_before_train=1.497335 cos_to_last_merge=0.9296 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.930
[S10] round=39 local utility u=0.007193 metrics={'f1_val': 0.9961605415649639, 'auprc': 0.9973620246171555, 'loss_val': 0.05232731076810597, 'psi': 0.9966411347858405}-{'f1_val': 0.9957455607450773, 'auprc': 0.9961798170145896, 'loss_val': 0.060677350725132986, 'psi': 0.9959192632528822}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S10] sending update (kind=head size=1807 to 1 peers)
[S10] r=40 psi=0.997 u=0.0072 p_local=0.0809 f1=0.996 auprc=0.997 bytes=43017
[S11] START round=39 head_norm_before_train=1.558813 cos_to_last_merge=0.9456 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.946
[S11] round=39 local utility u=0.000000 metrics={'f1_val': 0.9870084994330144, 'auprc': 0.9964910071701867, 'loss_val': 0.055366842658038935, 'psi': 0.9908015025278833}-{'f1_val': 0.996305167468861, 'auprc': 0.9978257261159191, 'loss_val': 0.03270443599933979, 'psi': 0.9969133909276842}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] r=40 psi=0.991 u=0.0000 p_local=0.0840 f1=0.987 auprc=0.996 bytes=39508
[S13] START round=39 head_norm_before_train=1.353860 cos_to_last_merge=0.8845 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.885
[S13] round=39 local utility u=0.000000 metrics={'f1_val': 0.6118064548888419, 'auprc': 0.6786704528967871, 'loss_val': 0.7360498822298325, 'psi': 0.63855205409202}-{'f1_val': 0.6249880556216231, 'auprc': 0.666124417633852, 'loss_val': 0.68088623155022, 'psi': 0.6414426004265146}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=40 psi=0.639 u=0.0000 p_local=0.1000 f1=0.612 auprc=0.679 bytes=28766
[S14] START round=39 head_norm_before_train=2.063045 cos_to_last_merge=0.9837 (last merge round=17)
[S14] round=39 local utility u=0.003611 metrics={'f1_val': 0.9976291097282272, 'auprc': 0.9988550277816004, 'loss_val': 0.019414044286675564, 'psi': 0.9981194769495765}-{'f1_val': 0.9973833833620065, 'auprc': 0.9992326401043433, 'loss_val': 0.02629515121797486, 'psi': 0.9981230860589412}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S14] r=40 psi=0.998 u=0.0036 p_local=0.0028 f1=0.998 auprc=0.999 bytes=52117
[S15] START round=39 head_norm_before_train=2.007425 cos_to_last_merge=0.9684 (last merge round=13)
[S15] round=39 local utility u=0.006637 metrics={'f1_val': 0.9966196520233872, 'auprc': 0.9984038375759939, 'loss_val': 0.0235228513733956, 'psi': 0.9973333262444299}-{'f1_val': 0.9970299290849798, 'auprc': 0.9966171559187794, 'loss_val': 0.03389772678844228, 'psi': 0.9968648198184996}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S15] r=40 psi=0.997 u=0.0066 p_local=0.2261 f1=0.997 auprc=0.998 bytes=41347
[S16] START round=39 head_norm_before_train=1.554283 cos_to_last_merge=0.9174 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.917
[S16] round=39 local utility u=0.000000 metrics={'f1_val': 0.8317459075599991, 'auprc': 0.8916030780159248, 'loss_val': 1.0762287493516205, 'psi': 0.8556887757423693}-{'f1_val': 0.8877099598236925, 'auprc': 0.9859371829051896, 'loss_val': 0.5451336162483998, 'psi': 0.9270008490562913}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] r=40 psi=0.856 u=0.0000 p_local=0.1478 f1=0.832 auprc=0.892 bytes=35944
[S17] START round=39 head_norm_before_train=2.050399 cos_to_last_merge=0.9713 (last merge round=13)
[S17] round=39 local utility u=0.116788 metrics={'f1_val': 0.568471061626116, 'auprc': 0.812249721396943, 'loss_val': 1.1799956495998116, 'psi': 0.6659825255344468}-{'f1_val': 0.5848932910104019, 'auprc': 0.7243964843292308, 'loss_val': 1.2485462888691439, 'psi': 0.6406945683379335}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] sending update (kind=head size=1795 to 1 peers)
[S17] r=40 psi=0.666 u=0.1168 p_local=0.0956 f1=0.568 auprc=0.812 bytes=43154
[S2] START round=40 head_norm_before_train=1.432304 cos_to_last_merge=0.9855 (last merge round=23)
[S2] round=40 local utility u=0.000000 metrics={'f1_val': 0.6694794881949895, 'auprc': 0.7480965410239633, 'loss_val': 0.8279080368877807, 'psi': 0.700926309326579}-{'f1_val': 0.7182909591127976, 'auprc': 0.7529270027679447, 'loss_val': 0.7609278026907627, 'psi': 0.7321453765748565}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=40 head_norm_before_train=1.824524 cos_to_last_merge=0.7984 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.798
[S3] round=40 local utility u=0.000000 metrics={'f1_val': 0.960995754132836, 'auprc': 0.9983434332036764, 'loss_val': 0.1021763957245286, 'psi': 0.9759348257611722}-{'f1_val': 0.9973415147416245, 'auprc': 0.998686610204867, 'loss_val': 0.025569991605003194, 'psi': 0.9978795529269215}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=40 head_norm_before_train=1.646826 cos_to_last_merge=0.9672 (last merge round=15)
[S4] round=40 local utility u=0.027174 metrics={'f1_val': 0.9529343482314829, 'auprc': 0.9717548679023598, 'loss_val': 0.255620954881034, 'psi': 0.9604625560998337}-{'f1_val': 0.947923592895259, 'auprc': 0.9667103858409867, 'loss_val': 0.2647706591627309, 'psi': 0.9554383100735501}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=40 head_norm_before_train=1.343434 cos_to_last_merge=0.9292 (last merge round=16)
[S5] ⚠️ Model drifted since last merge! cos=0.929
[S5] round=40 local utility u=0.781469 metrics={'f1_val': 0.5643060545945229, 'auprc': 0.86185733798372, 'loss_val': 0.5216328615527914, 'psi': 0.6833265679502017}-{'f1_val': 0.4272757364527509, 'auprc': 0.8550962015284244, 'loss_val': 1.2421053645637994, 'psi': 0.5984039224830203}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S5] sending update (kind=head size=1809 to 1 peers)
[S6] START round=40 head_norm_before_train=1.811173 cos_to_last_merge=0.9760 (last merge round=15)
[S6] round=40 local utility u=0.000000 metrics={'f1_val': 0.7965016907241503, 'auprc': 0.9584493934780819, 'loss_val': 0.4541061361395797, 'psi': 0.8612807718257229}-{'f1_val': 0.9608951435574564, 'auprc': 0.9586366471309515, 'loss_val': 0.24714120990215427, 'psi': 0.9599917449868545}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=40 head_norm_before_train=1.514948 cos_to_last_merge=0.8205 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.821
[S7] round=40 local utility u=0.012110 metrics={'f1_val': 0.5691113420572868, 'auprc': 0.789570143079936, 'loss_val': 0.8048840399109578, 'psi': 0.6572948624663465}-{'f1_val': 0.5674614494804028, 'auprc': 0.7896480566418878, 'loss_val': 0.8194393258000671, 'psi': 0.6563360923449968}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=40 head_norm_before_train=2.057847 cos_to_last_merge=0.9837 (last merge round=15)
[S8] round=40 local utility u=0.000551 metrics={'f1_val': 0.9926457841098181, 'auprc': 0.999234938498097, 'loss_val': 0.03402604067630269, 'psi': 0.9952814458651296}-{'f1_val': 0.9926457841098181, 'auprc': 0.9992851010892868, 'loss_val': 0.03527838446518877, 'psi': 0.9953015109016055}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=40 head_norm_before_train=1.822873 cos_to_last_merge=0.7957 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.796
[S9] round=40 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.995307825434653, 'loss_val': 0.022281116963107597, 'psi': 0.9961194372621961}-{'f1_val': 0.9966605118138915, 'auprc': 0.9984833200755879, 'loss_val': 0.021779229182959044, 'psi': 0.99738963511857}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=40 head_norm_before_train=1.516041 cos_to_last_merge=0.9274 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.927
[S10] round=40 local utility u=0.000000 metrics={'f1_val': 0.9317708825806346, 'auprc': 0.9937560353708081, 'loss_val': 0.17527329762468524, 'psi': 0.9565649436967041}-{'f1_val': 0.9961605415649639, 'auprc': 0.9973620246171555, 'loss_val': 0.05232731076810597, 'psi': 0.9966411347858405}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=40 head_norm_before_train=1.568810 cos_to_last_merge=0.9445 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.945
[S11] round=40 local utility u=0.040108 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9951058382938782, 'loss_val': 0.028227266744039744, 'psi': 0.995970538025705}-{'f1_val': 0.9870084994330144, 'auprc': 0.9964910071701867, 'loss_val': 0.055366842658038935, 'psi': 0.9908015025278833}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=40 head_norm_before_train=1.360870 cos_to_last_merge=0.8838 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.884
[S13] round=40 local utility u=0.000000 metrics={'f1_val': 0.5665551249069339, 'auprc': 0.6925180471637972, 'loss_val': 1.042870381675894, 'psi': 0.6169402938096793}-{'f1_val': 0.6118064548888419, 'auprc': 0.6786704528967871, 'loss_val': 0.7360498822298325, 'psi': 0.63855205409202}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=40 head_norm_before_train=2.071398 cos_to_last_merge=0.9832 (last merge round=17)
[S14] round=40 local utility u=0.000000 metrics={'f1_val': 0.9973862616479148, 'auprc': 0.9992279783206375, 'loss_val': 0.019934938867399186, 'psi': 0.9981229483170039}-{'f1_val': 0.9976291097282272, 'auprc': 0.9988550277816004, 'loss_val': 0.019414044286675564, 'psi': 0.9981194769495765}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=40 head_norm_before_train=2.016433 cos_to_last_merge=0.9677 (last merge round=13)
[S15] round=40 local utility u=0.000000 metrics={'f1_val': 0.7806492908818823, 'auprc': 0.9945026068844744, 'loss_val': 0.34752991190322263, 'psi': 0.8661906172829191}-{'f1_val': 0.9966196520233872, 'auprc': 0.9984038375759939, 'loss_val': 0.0235228513733956, 'psi': 0.9973333262444299}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=40 head_norm_before_train=1.566455 cos_to_last_merge=0.9159 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.916
[S16] round=40 local utility u=1.000000 metrics={'f1_val': 0.9909267900464239, 'auprc': 0.9887505684233313, 'loss_val': 0.04926424014194533, 'psi': 0.9900563013971869}-{'f1_val': 0.8317459075599991, 'auprc': 0.8916030780159248, 'loss_val': 1.0762287493516205, 'psi': 0.8556887757423693}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S17] START round=40 head_norm_before_train=2.062712 cos_to_last_merge=0.9706 (last merge round=13)
[S17] round=40 local utility u=0.000000 metrics={'f1_val': 0.5900094643991236, 'auprc': 0.7259206523430048, 'loss_val': 1.2719473796099303, 'psi': 0.6443739395766761}-{'f1_val': 0.568471061626116, 'auprc': 0.812249721396943, 'loss_val': 1.1799956495998116, 'psi': 0.6659825255344468}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=41 head_norm_before_train=1.444371 cos_to_last_merge=0.9842 (last merge round=23)
[S2] round=41 local utility u=0.122400 metrics={'f1_val': 0.7015718985407164, 'auprc': 0.7520516291759347, 'loss_val': 0.7875277219521398, 'psi': 0.7217637907948038}-{'f1_val': 0.6694794881949895, 'auprc': 0.7480965410239633, 'loss_val': 0.8279080368877807, 'psi': 0.700926309326579}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=41 head_norm_before_train=1.832943 cos_to_last_merge=0.7978 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.798
[S3] round=41 local utility u=0.011393 metrics={'f1_val': 0.960995754132836, 'auprc': 0.9986752370662855, 'loss_val': 0.08038561655970364, 'psi': 0.9760675473062158}-{'f1_val': 0.960995754132836, 'auprc': 0.9983434332036764, 'loss_val': 0.1021763957245286, 'psi': 0.9759348257611722}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=41 head_norm_before_train=1.655704 cos_to_last_merge=0.9661 (last merge round=15)
[S4] round=41 local utility u=0.000000 metrics={'f1_val': 0.9483432316938888, 'auprc': 0.9678970591460015, 'loss_val': 0.2647233410929857, 'psi': 0.9561647626747338}-{'f1_val': 0.9529343482314829, 'auprc': 0.9717548679023598, 'loss_val': 0.255620954881034, 'psi': 0.9604625560998337}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=41 head_norm_before_train=1.347661 cos_to_last_merge=0.9290 (last merge round=16)
[S5] ⚠️ Model drifted since last merge! cos=0.929
[S5] round=41 local utility u=0.505247 metrics={'f1_val': 0.6554989366314581, 'auprc': 0.9461611695270399, 'loss_val': 0.311208391516828, 'psi': 0.7717638297896908}-{'f1_val': 0.5643060545945229, 'auprc': 0.86185733798372, 'loss_val': 0.5216328615527914, 'psi': 0.6833265679502017}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=41 head_norm_before_train=1.824528 cos_to_last_merge=0.9757 (last merge round=15)
[S6] round=41 local utility u=0.000000 metrics={'f1_val': 0.5977521004327597, 'auprc': 0.9077992433006441, 'loss_val': 1.1031997646487781, 'psi': 0.7217709575799135}-{'f1_val': 0.7965016907241503, 'auprc': 0.9584493934780819, 'loss_val': 0.4541061361395797, 'psi': 0.8612807718257229}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=41 head_norm_before_train=1.521732 cos_to_last_merge=0.8195 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.820
[S7] round=41 local utility u=0.244685 metrics={'f1_val': 0.6150985269111154, 'auprc': 0.8011669046198351, 'loss_val': 0.6262270159380988, 'psi': 0.6895258779946033}-{'f1_val': 0.5691113420572868, 'auprc': 0.789570143079936, 'loss_val': 0.8048840399109578, 'psi': 0.6572948624663465}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] sending update (kind=head size=1796 to 1 peers)
[S8] START round=41 head_norm_before_train=2.068605 cos_to_last_merge=0.9830 (last merge round=15)
[S8] round=41 local utility u=0.000000 metrics={'f1_val': 0.9884946976640797, 'auprc': 0.999257388221211, 'loss_val': 0.036866155388295026, 'psi': 0.9927997738869322}-{'f1_val': 0.9926457841098181, 'auprc': 0.999234938498097, 'loss_val': 0.03402604067630269, 'psi': 0.9952814458651296}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=41 head_norm_before_train=1.831402 cos_to_last_merge=0.7952 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.795
[S9] round=41 local utility u=0.000000 metrics={'f1_val': 0.9875711251504857, 'auprc': 0.9988141902027978, 'loss_val': 0.04361621523099685, 'psi': 0.9920683511714106}-{'f1_val': 0.9966605118138915, 'auprc': 0.995307825434653, 'loss_val': 0.022281116963107597, 'psi': 0.9961194372621961}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=41 head_norm_before_train=1.534076 cos_to_last_merge=0.9251 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.925
[S10] round=41 local utility u=0.250031 metrics={'f1_val': 0.9951028111411864, 'auprc': 0.9962995159529275, 'loss_val': 0.06283376192267665, 'psi': 0.9955814930658828}-{'f1_val': 0.9317708825806346, 'auprc': 0.9937560353708081, 'loss_val': 0.17527329762468524, 'psi': 0.9565649436967041}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=41 head_norm_before_train=1.578354 cos_to_last_merge=0.9435 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.943
[S11] round=41 local utility u=0.000474 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9951635600078629, 'loss_val': 0.027451832054370674, 'psi': 0.9959936267112989}-{'f1_val': 0.9965470045135896, 'auprc': 0.9951058382938782, 'loss_val': 0.028227266744039744, 'psi': 0.995970538025705}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=41 head_norm_before_train=1.367932 cos_to_last_merge=0.8831 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.883
[S13] round=41 local utility u=0.000000 metrics={'f1_val': 0.5445014240250156, 'auprc': 0.6948922747205959, 'loss_val': 1.1192418690966803, 'psi': 0.6046577643032477}-{'f1_val': 0.5665551249069339, 'auprc': 0.6925180471637972, 'loss_val': 1.042870381675894, 'psi': 0.6169402938096793}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=41 head_norm_before_train=2.081314 cos_to_last_merge=0.9827 (last merge round=17)
[S14] round=41 local utility u=0.000000 metrics={'f1_val': 0.9556296486367702, 'auprc': 0.9975262438082748, 'loss_val': 0.06394863847728184, 'psi': 0.9723882867053721}-{'f1_val': 0.9973862616479148, 'auprc': 0.9992279783206375, 'loss_val': 0.019934938867399186, 'psi': 0.9981229483170039}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=41 head_norm_before_train=2.024633 cos_to_last_merge=0.9669 (last merge round=13)
[S15] round=41 local utility u=0.000000 metrics={'f1_val': 0.703596899395338, 'auprc': 0.9928031064338401, 'loss_val': 0.3719913062999908, 'psi': 0.8192793822107388}-{'f1_val': 0.7806492908818823, 'auprc': 0.9945026068844744, 'loss_val': 0.34752991190322263, 'psi': 0.8661906172829191}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=41 head_norm_before_train=1.576840 cos_to_last_merge=0.9147 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.915
[S16] round=41 local utility u=0.000000 metrics={'f1_val': 0.8330212649157082, 'auprc': 0.9495251406494674, 'loss_val': 0.640942654281864, 'psi': 0.8796228152092118}-{'f1_val': 0.9909267900464239, 'auprc': 0.9887505684233313, 'loss_val': 0.04926424014194533, 'psi': 0.9900563013971869}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=41 head_norm_before_train=2.075446 cos_to_last_merge=0.9698 (last merge round=13)
[S17] round=41 local utility u=0.260489 metrics={'f1_val': 0.6160994102299507, 'auprc': 0.8150829239057686, 'loss_val': 1.1749951912046053, 'psi': 0.695692815700278}-{'f1_val': 0.5900094643991236, 'auprc': 0.7259206523430048, 'loss_val': 1.2719473796099303, 'psi': 0.6443739395766761}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=42 head_norm_before_train=1.455224 cos_to_last_merge=0.9831 (last merge round=23)
[S2] round=42 local utility u=0.000000 metrics={'f1_val': 0.673273073760969, 'auprc': 0.745914413415703, 'loss_val': 0.9505401673479732, 'psi': 0.7023296096228626}-{'f1_val': 0.7015718985407164, 'auprc': 0.7520516291759347, 'loss_val': 0.7875277219521398, 'psi': 0.7217637907948038}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=42 head_norm_before_train=1.839688 cos_to_last_merge=0.7970 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.797
[S3] round=42 local utility u=0.138332 metrics={'f1_val': 0.9977814963782642, 'auprc': 0.9991155672252836, 'loss_val': 0.025757176110985533, 'psi': 0.9983151247170721}-{'f1_val': 0.960995754132836, 'auprc': 0.9986752370662855, 'loss_val': 0.08038561655970364, 'psi': 0.9760675473062158}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=42 head_norm_before_train=1.663146 cos_to_last_merge=0.9650 (last merge round=15)
[S4] round=42 local utility u=0.000000 metrics={'f1_val': 0.9441548193796598, 'auprc': 0.9667974844784388, 'loss_val': 0.2731009485698784, 'psi': 0.9532118854191715}-{'f1_val': 0.9483432316938888, 'auprc': 0.9678970591460015, 'loss_val': 0.2647233410929857, 'psi': 0.9561647626747338}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=42 head_norm_before_train=1.352396 cos_to_last_merge=0.9287 (last merge round=16)
[S5] ⚠️ Model drifted since last merge! cos=0.929
[S5] round=42 local utility u=0.188335 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9687773040040921, 'loss_val': 0.27131710414277665, 'psi': 0.8077032806964523}-{'f1_val': 0.6554989366314581, 'auprc': 0.9461611695270399, 'loss_val': 0.311208391516828, 'psi': 0.7717638297896908}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] sending update (kind=head size=1805 to 1 peers)
[S6] START round=42 head_norm_before_train=1.838094 cos_to_last_merge=0.9755 (last merge round=15)
[S6] round=42 local utility u=1.000000 metrics={'f1_val': 0.8701445211271748, 'auprc': 0.9666886204579523, 'loss_val': 0.2564433782270808, 'psi': 0.9087621608594858}-{'f1_val': 0.5977521004327597, 'auprc': 0.9077992433006441, 'loss_val': 1.1031997646487781, 'psi': 0.7217709575799135}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[S7] START round=42 head_norm_before_train=1.527151 cos_to_last_merge=0.8186 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.819
[S7] round=42 local utility u=0.287172 metrics={'f1_val': 0.6674413503202191, 'auprc': 0.8255574884394652, 'loss_val': 0.4391109659927253, 'psi': 0.7306878055679176}-{'f1_val': 0.6150985269111154, 'auprc': 0.8011669046198351, 'loss_val': 0.6262270159380988, 'psi': 0.6895258779946033}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=42 head_norm_before_train=2.081267 cos_to_last_merge=0.9821 (last merge round=15)
[S8] round=42 local utility u=0.013053 metrics={'f1_val': 0.9920979054933599, 'auprc': 0.9992438604421808, 'loss_val': 0.03233923681332785, 'psi': 0.9949562874728883}-{'f1_val': 0.9884946976640797, 'auprc': 0.999257388221211, 'loss_val': 0.036866155388295026, 'psi': 0.9927997738869322}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] sending update (kind=head size=1795 to 1 peers)
[S9] START round=42 head_norm_before_train=1.839668 cos_to_last_merge=0.7949 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.795
[S9] round=42 local utility u=0.037850 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9984230554339466, 'loss_val': 0.021279680559987517, 'psi': 0.9973655292619135}-{'f1_val': 0.9875711251504857, 'auprc': 0.9988141902027978, 'loss_val': 0.04361621523099685, 'psi': 0.9920683511714106}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=42 head_norm_before_train=1.550361 cos_to_last_merge=0.9230 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.923
[S10] round=42 local utility u=0.000000 metrics={'f1_val': 0.9678870018987962, 'auprc': 0.9947694603673884, 'loss_val': 0.09647090021647352, 'psi': 0.9786399852862331}-{'f1_val': 0.9951028111411864, 'auprc': 0.9962995159529275, 'loss_val': 0.06283376192267665, 'psi': 0.9955814930658828}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=42 head_norm_before_train=1.588557 cos_to_last_merge=0.9425 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.942
[S11] round=42 local utility u=0.000734 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9954012811079855, 'loss_val': 0.0266968209392087, 'psi': 0.996088715151348}-{'f1_val': 0.9965470045135896, 'auprc': 0.9951635600078629, 'loss_val': 0.027451832054370674, 'psi': 0.9959936267112989}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=42 head_norm_before_train=1.377102 cos_to_last_merge=0.8825 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.882
[S13] round=42 local utility u=0.257326 metrics={'f1_val': 0.590155483386945, 'auprc': 0.6708115011278347, 'loss_val': 0.8062713369731126, 'psi': 0.6224178904833009}-{'f1_val': 0.5445014240250156, 'auprc': 0.6948922747205959, 'loss_val': 1.1192418690966803, 'psi': 0.6046577643032477}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=42 head_norm_before_train=2.092375 cos_to_last_merge=0.9820 (last merge round=17)
[S14] round=42 local utility u=0.148211 metrics={'f1_val': 0.9971907882668205, 'auprc': 0.9985989323679647, 'loss_val': 0.020111216109300452, 'psi': 0.9977540459072782}-{'f1_val': 0.9556296486367702, 'auprc': 0.9975262438082748, 'loss_val': 0.06394863847728184, 'psi': 0.9723882867053721}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] sending update (kind=head size=1795 to 1 peers)
[S15] START round=42 head_norm_before_train=2.033010 cos_to_last_merge=0.9662 (last merge round=13)
[S15] round=42 local utility u=0.699400 metrics={'f1_val': 0.9011788291299299, 'auprc': 0.9958263315054305, 'loss_val': 0.16775338308237536, 'psi': 0.9390378300801301}-{'f1_val': 0.703596899395338, 'auprc': 0.9928031064338401, 'loss_val': 0.3719913062999908, 'psi': 0.8192793822107388}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=42 head_norm_before_train=1.587252 cos_to_last_merge=0.9134 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.913
[S16] round=42 local utility u=0.826245 metrics={'f1_val': 0.9907075760323867, 'auprc': 0.9884073280263311, 'loss_val': 0.05121782146174005, 'psi': 0.9897874768299645}-{'f1_val': 0.8330212649157082, 'auprc': 0.9495251406494674, 'loss_val': 0.640942654281864, 'psi': 0.8796228152092118}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S16] sending update (kind=head size=1807 to 1 peers)
[S17] START round=42 head_norm_before_train=2.086858 cos_to_last_merge=0.9688 (last merge round=13)
[S17] round=42 local utility u=0.061306 metrics={'f1_val': 0.6313435875031738, 'auprc': 0.8100732935879994, 'loss_val': 1.128820185862704, 'psi': 0.702835469937104}-{'f1_val': 0.6160994102299507, 'auprc': 0.8150829239057686, 'loss_val': 1.1749951912046053, 'psi': 0.695692815700278}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] START round=43 head_norm_before_train=1.466879 cos_to_last_merge=0.9817 (last merge round=23)
[S2] round=43 local utility u=0.021213 metrics={'f1_val': 0.6747503470346632, 'auprc': 0.74654907275741, 'loss_val': 0.91888084793561, 'psi': 0.703469837323762}-{'f1_val': 0.673273073760969, 'auprc': 0.745914413415703, 'loss_val': 0.9505401673479732, 'psi': 0.7023296096228626}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[S3] START round=43 head_norm_before_train=1.846662 cos_to_last_merge=0.7961 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.796
[S3] round=43 local utility u=0.000737 metrics={'f1_val': 0.9977814963782642, 'auprc': 0.9991770327209991, 'loss_val': 0.024468518940098275, 'psi': 0.9983397109153582}-{'f1_val': 0.9977814963782642, 'auprc': 0.9991155672252836, 'loss_val': 0.025757176110985533, 'psi': 0.9983151247170721}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=43 head_norm_before_train=1.670090 cos_to_last_merge=0.9644 (last merge round=15)
[S4] round=43 local utility u=0.058156 metrics={'f1_val': 0.9557437799533108, 'auprc': 0.9773095059885952, 'loss_val': 0.2578588094194645, 'psi': 0.9643700703674246}-{'f1_val': 0.9441548193796598, 'auprc': 0.9667974844784388, 'loss_val': 0.2731009485698784, 'psi': 0.9532118854191715}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] sending update (kind=head size=1805 to 1 peers)
[S5] START round=43 head_norm_before_train=1.358186 cos_to_last_merge=0.9286 (last merge round=16)
[S5] ⚠️ Model drifted since last merge! cos=0.929
[S5] round=43 local utility u=0.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.967243895685526, 'loss_val': 0.2946786042254345, 'psi': 0.8070899173690258}-{'f1_val': 0.700320598491359, 'auprc': 0.9687773040040921, 'loss_val': 0.27131710414277665, 'psi': 0.8077032806964523}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=43 head_norm_before_train=1.846695 cos_to_last_merge=0.9751 (last merge round=15)
[S6] round=43 local utility u=0.000000 metrics={'f1_val': 0.6181003846464187, 'auprc': 0.950214864764514, 'loss_val': 0.8215312771734353, 'psi': 0.7509461766936568}-{'f1_val': 0.8701445211271748, 'auprc': 0.9666886204579523, 'loss_val': 0.2564433782270808, 'psi': 0.9087621608594858}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=43 head_norm_before_train=1.532013 cos_to_last_merge=0.8179 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.818
[S7] round=43 local utility u=0.059207 metrics={'f1_val': 0.6731482947437749, 'auprc': 0.8326890230665349, 'loss_val': 0.37633374742024966, 'psi': 0.736964586072879}-{'f1_val': 0.6674413503202191, 'auprc': 0.8255574884394652, 'loss_val': 0.4391109659927253, 'psi': 0.7306878055679176}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] sending update (kind=head size=1797 to 1 peers)
[S8] START round=43 head_norm_before_train=2.093491 cos_to_last_merge=0.9812 (last merge round=15)
[S8] round=43 local utility u=0.000000 metrics={'f1_val': 0.9917351758735767, 'auprc': 0.9990682868368211, 'loss_val': 0.03316754005545547, 'psi': 0.9946684202588745}-{'f1_val': 0.9920979054933599, 'auprc': 0.9992438604421808, 'loss_val': 0.03233923681332785, 'psi': 0.9949562874728883}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=43 head_norm_before_train=1.847278 cos_to_last_merge=0.7945 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.794
[S9] round=43 local utility u=0.000267 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.998473187246211, 'loss_val': 0.020895947029302194, 'psi': 0.9973855819868193}-{'f1_val': 0.9966605118138915, 'auprc': 0.9984230554339466, 'loss_val': 0.021279680559987517, 'psi': 0.9973655292619135}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=43 head_norm_before_train=1.567052 cos_to_last_merge=0.9209 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.921
[S10] round=43 local utility u=0.094275 metrics={'f1_val': 0.9934231972744237, 'auprc': 0.9959723459289296, 'loss_val': 0.06474729586050652, 'psi': 0.9944428567362261}-{'f1_val': 0.9678870018987962, 'auprc': 0.9947694603673884, 'loss_val': 0.09647090021647352, 'psi': 0.9786399852862331}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=43 head_norm_before_train=1.598823 cos_to_last_merge=0.9415 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.941
[S11] round=43 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9957489411035538, 'loss_val': 0.026895847819724268, 'psi': 0.9959797813894071}-{'f1_val': 0.9965470045135896, 'auprc': 0.9954012811079855, 'loss_val': 0.0266968209392087, 'psi': 0.996088715151348}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=43 head_norm_before_train=1.385815 cos_to_last_merge=0.8809 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.881
[S13] round=43 local utility u=0.000000 metrics={'f1_val': 0.5582191809563686, 'auprc': 0.6851878289666261, 'loss_val': 0.762452377821518, 'psi': 0.6090066401604717}-{'f1_val': 0.590155483386945, 'auprc': 0.6708115011278347, 'loss_val': 0.8062713369731126, 'psi': 0.6224178904833009}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=43 head_norm_before_train=2.102252 cos_to_last_merge=0.9815 (last merge round=17)
[S14] round=43 local utility u=0.000000 metrics={'f1_val': 0.9973891252095638, 'auprc': 0.998034867133866, 'loss_val': 0.02118182251809712, 'psi': 0.9976474219792848}-{'f1_val': 0.9971907882668205, 'auprc': 0.9985989323679647, 'loss_val': 0.020111216109300452, 'psi': 0.9977540459072782}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=43 head_norm_before_train=2.040723 cos_to_last_merge=0.9656 (last merge round=13)
[S15] round=43 local utility u=0.363982 metrics={'f1_val': 0.9969902329512002, 'auprc': 0.9983344695427918, 'loss_val': 0.0221829305539497, 'psi': 0.9975279275878368}-{'f1_val': 0.9011788291299299, 'auprc': 0.9958263315054305, 'loss_val': 0.16775338308237536, 'psi': 0.9390378300801301}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=43 head_norm_before_train=1.595574 cos_to_last_merge=0.9119 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.912
[S16] round=43 local utility u=0.000000 metrics={'f1_val': 0.8461421392766207, 'auprc': 0.9801039175167054, 'loss_val': 0.9760181288363677, 'psi': 0.8997268505726546}-{'f1_val': 0.9907075760323867, 'auprc': 0.9884073280263311, 'loss_val': 0.05121782146174005, 'psi': 0.9897874768299645}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=43 head_norm_before_train=2.095372 cos_to_last_merge=0.9679 (last merge round=13)
[S17] round=43 local utility u=0.000000 metrics={'f1_val': 0.6168564648257334, 'auprc': 0.7324216207838545, 'loss_val': 1.272267865916941, 'psi': 0.6630825272089819}-{'f1_val': 0.6313435875031738, 'auprc': 0.8100732935879994, 'loss_val': 1.128820185862704, 'psi': 0.702835469937104}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=44 head_norm_before_train=1.479704 cos_to_last_merge=0.9802 (last merge round=23)
[S2] round=44 local utility u=0.000000 metrics={'f1_val': 0.6128819528460953, 'auprc': 0.7383254246839804, 'loss_val': 1.152152467481172, 'psi': 0.6630593415812494}-{'f1_val': 0.6747503470346632, 'auprc': 0.74654907275741, 'loss_val': 0.91888084793561, 'psi': 0.703469837323762}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=44 head_norm_before_train=1.857244 cos_to_last_merge=0.7951 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.795
[S3] round=44 local utility u=0.000000 metrics={'f1_val': 0.9872687231472141, 'auprc': 0.9992398571461196, 'loss_val': 0.03733477987304607, 'psi': 0.9920571767467764}-{'f1_val': 0.9977814963782642, 'auprc': 0.9991770327209991, 'loss_val': 0.024468518940098275, 'psi': 0.9983397109153582}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=44 head_norm_before_train=1.677829 cos_to_last_merge=0.9637 (last merge round=15)
[S4] round=44 local utility u=0.000000 metrics={'f1_val': 0.9411150012877814, 'auprc': 0.9610398678237546, 'loss_val': 0.3009843689166766, 'psi': 0.9490849479021707}-{'f1_val': 0.9557437799533108, 'auprc': 0.9773095059885952, 'loss_val': 0.2578588094194645, 'psi': 0.9643700703674246}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=44 head_norm_before_train=1.365672 cos_to_last_merge=0.9279 (last merge round=16)
[S5] ⚠️ Model drifted since last merge! cos=0.928
[S5] round=44 local utility u=0.000000 metrics={'f1_val': 0.6643495014770903, 'auprc': 0.8838016014864214, 'loss_val': 0.36792955607721456, 'psi': 0.7521303414808227}-{'f1_val': 0.700320598491359, 'auprc': 0.967243895685526, 'loss_val': 0.2946786042254345, 'psi': 0.8070899173690258}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=44 head_norm_before_train=1.854914 cos_to_last_merge=0.9743 (last merge round=15)
[S6] round=44 local utility u=1.000000 metrics={'f1_val': 0.960358888615682, 'auprc': 0.9680283574663904, 'loss_val': 0.19964202949739568, 'psi': 0.9634266761559653}-{'f1_val': 0.6181003846464187, 'auprc': 0.950214864764514, 'loss_val': 0.8215312771734353, 'psi': 0.7509461766936568}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=44 head_norm_before_train=1.534939 cos_to_last_merge=0.8174 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.817
[S7] round=44 local utility u=0.000000 metrics={'f1_val': 0.5807815464564563, 'auprc': 0.7876241301815026, 'loss_val': 0.7379382283090393, 'psi': 0.6635185799464749}-{'f1_val': 0.6731482947437749, 'auprc': 0.8326890230665349, 'loss_val': 0.37633374742024966, 'psi': 0.736964586072879}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=44 head_norm_before_train=2.103088 cos_to_last_merge=0.9807 (last merge round=15)
[S8] round=44 local utility u=0.000000 metrics={'f1_val': 0.9355167320627182, 'auprc': 0.9976172825183949, 'loss_val': 0.13300745193165023, 'psi': 0.9603569522449888}-{'f1_val': 0.9917351758735767, 'auprc': 0.9990682868368211, 'loss_val': 0.03316754005545547, 'psi': 0.9946684202588745}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=44 head_norm_before_train=1.853681 cos_to_last_merge=0.7938 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.794
[S9] round=44 local utility u=0.000086 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9984859191119673, 'loss_val': 0.020762214407911518, 'psi': 0.9973906747331218}-{'f1_val': 0.9966605118138915, 'auprc': 0.998473187246211, 'loss_val': 0.020895947029302194, 'psi': 0.9973855819868193}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=44 head_norm_before_train=1.583794 cos_to_last_merge=0.9190 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.919
[S10] round=44 local utility u=0.007602 metrics={'f1_val': 0.9949675295968309, 'auprc': 0.9958050140237573, 'loss_val': 0.05830710228875206, 'psi': 0.9953025233676014}-{'f1_val': 0.9934231972744237, 'auprc': 0.9959723459289296, 'loss_val': 0.06474729586050652, 'psi': 0.9944428567362261}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=44 head_norm_before_train=1.609871 cos_to_last_merge=0.9403 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.940
[S11] round=44 local utility u=0.000000 metrics={'f1_val': 0.9891806320557159, 'auprc': 0.9952516122463049, 'loss_val': 0.06262013891193156, 'psi': 0.9916090241319515}-{'f1_val': 0.9961336749133093, 'auprc': 0.9957489411035538, 'loss_val': 0.026895847819724268, 'psi': 0.9959797813894071}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=44 head_norm_before_train=1.393231 cos_to_last_merge=0.8795 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.879
[S13] round=44 local utility u=0.000000 metrics={'f1_val': 0.5523027446398522, 'auprc': 0.6904870421578477, 'loss_val': 0.9163948014699166, 'psi': 0.6075764636470504}-{'f1_val': 0.5582191809563686, 'auprc': 0.6851878289666261, 'loss_val': 0.762452377821518, 'psi': 0.6090066401604717}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=44 head_norm_before_train=2.106861 cos_to_last_merge=0.9813 (last merge round=17)
[S14] round=44 local utility u=0.000000 metrics={'f1_val': 0.9967358680170888, 'auprc': 0.9969543601332631, 'loss_val': 0.022483213603823073, 'psi': 0.9968232648635585}-{'f1_val': 0.9973891252095638, 'auprc': 0.998034867133866, 'loss_val': 0.02118182251809712, 'psi': 0.9976474219792848}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=44 head_norm_before_train=2.048630 cos_to_last_merge=0.9650 (last merge round=13)
[S15] round=44 local utility u=0.001267 metrics={'f1_val': 0.9969902329512002, 'auprc': 0.9989190396555524, 'loss_val': 0.021403380935629778, 'psi': 0.9977617556329411}-{'f1_val': 0.9969902329512002, 'auprc': 0.9983344695427918, 'loss_val': 0.0221829305539497, 'psi': 0.9975279275878368}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=44 head_norm_before_train=1.604079 cos_to_last_merge=0.9107 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.911
[S16] round=44 local utility u=0.240619 metrics={'f1_val': 0.8748781684339604, 'auprc': 0.9839507346786562, 'loss_val': 0.6787363669058875, 'psi': 0.9185071949318387}-{'f1_val': 0.8461421392766207, 'auprc': 0.9801039175167054, 'loss_val': 0.9760181288363677, 'psi': 0.8997268505726546}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S17] START round=44 head_norm_before_train=2.101950 cos_to_last_merge=0.9672 (last merge round=13)
[S17] round=44 local utility u=0.000000 metrics={'f1_val': 0.6098989666519505, 'auprc': 0.7086572482999374, 'loss_val': 1.3323613451956986, 'psi': 0.6494022793111454}-{'f1_val': 0.6168564648257334, 'auprc': 0.7324216207838545, 'loss_val': 1.272267865916941, 'psi': 0.6630825272089819}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=45 head_norm_before_train=1.491376 cos_to_last_merge=0.9789 (last merge round=23)
[S2] round=45 local utility u=0.359565 metrics={'f1_val': 0.6969439583499939, 'auprc': 0.735281673444542, 'loss_val': 0.9282628867577446, 'psi': 0.7122790443878131}-{'f1_val': 0.6128819528460953, 'auprc': 0.7383254246839804, 'loss_val': 1.152152467481172, 'psi': 0.6630593415812494}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=45 head_norm_before_train=1.866967 cos_to_last_merge=0.7940 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.794
[S3] round=45 local utility u=0.000000 metrics={'f1_val': 0.9821381472866884, 'auprc': 0.999203592898158, 'loss_val': 0.049529958584660055, 'psi': 0.9889643255312762}-{'f1_val': 0.9872687231472141, 'auprc': 0.9992398571461196, 'loss_val': 0.03733477987304607, 'psi': 0.9920571767467764}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=45 head_norm_before_train=1.685172 cos_to_last_merge=0.9630 (last merge round=15)
[S4] round=45 local utility u=0.083662 metrics={'f1_val': 0.953496257960023, 'auprc': 0.9783404136885783, 'loss_val': 0.25984919583592625, 'psi': 0.963433920251445}-{'f1_val': 0.9411150012877814, 'auprc': 0.9610398678237546, 'loss_val': 0.3009843689166766, 'psi': 0.9490849479021707}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=45 head_norm_before_train=1.372257 cos_to_last_merge=0.9267 (last merge round=16)
[S5] ⚠️ Model drifted since last merge! cos=0.927
[S5] round=45 local utility u=0.353670 metrics={'f1_val': 0.7004938661094564, 'auprc': 0.9894224921314682, 'loss_val': 0.19431936823385204, 'psi': 0.8160653165182611}-{'f1_val': 0.6643495014770903, 'auprc': 0.8838016014864214, 'loss_val': 0.36792955607721456, 'psi': 0.7521303414808227}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=45 head_norm_before_train=1.865383 cos_to_last_merge=0.9739 (last merge round=15)
[S6] round=45 local utility u=0.000000 metrics={'f1_val': 0.8237257784803018, 'auprc': 0.9599537528672776, 'loss_val': 0.40597450244497324, 'psi': 0.8782169682350921}-{'f1_val': 0.960358888615682, 'auprc': 0.9680283574663904, 'loss_val': 0.19964202949739568, 'psi': 0.9634266761559653}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=45 head_norm_before_train=1.537671 cos_to_last_merge=0.8170 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.817
[S7] round=45 local utility u=0.459539 metrics={'f1_val': 0.6646609541834575, 'auprc': 0.8174983169444806, 'loss_val': 0.4117585990129193, 'psi': 0.7257958992878668}-{'f1_val': 0.5807815464564563, 'auprc': 0.7876241301815026, 'loss_val': 0.7379382283090393, 'psi': 0.6635185799464749}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=45 head_norm_before_train=2.105802 cos_to_last_merge=0.9806 (last merge round=15)
[S8] round=45 local utility u=0.196960 metrics={'f1_val': 0.9927720833909908, 'auprc': 0.9876319799245432, 'loss_val': 0.05266374334421739, 'psi': 0.9907160420044117}-{'f1_val': 0.9355167320627182, 'auprc': 0.9976172825183949, 'loss_val': 0.13300745193165023, 'psi': 0.9603569522449888}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S8] sending update (kind=head size=1791 to 1 peers)
[S9] START round=45 head_norm_before_train=1.859906 cos_to_last_merge=0.7935 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.794
[S9] round=45 local utility u=0.000493 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9985363472065852, 'loss_val': 0.019927710411408787, 'psi': 0.997410845970969}-{'f1_val': 0.9966605118138915, 'auprc': 0.9984859191119673, 'loss_val': 0.020762214407911518, 'psi': 0.9973906747331218}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] sending update (kind=head size=1803 to 1 peers)
[S10] START round=45 head_norm_before_train=1.599523 cos_to_last_merge=0.9175 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.917
[S10] round=45 local utility u=0.000000 metrics={'f1_val': 0.9742387866007133, 'auprc': 0.9935258328272247, 'loss_val': 0.08651020919051926, 'psi': 0.9819536050913179}-{'f1_val': 0.9949675295968309, 'auprc': 0.9958050140237573, 'loss_val': 0.05830710228875206, 'psi': 0.9953025233676014}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=45 head_norm_before_train=1.621037 cos_to_last_merge=0.9392 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.939
[S11] round=45 local utility u=0.042937 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9966647906266287, 'loss_val': 0.025183116885899783, 'psi': 0.9965941189588052}-{'f1_val': 0.9891806320557159, 'auprc': 0.9952516122463049, 'loss_val': 0.06262013891193156, 'psi': 0.9916090241319515}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S11] sending update (kind=head size=1806 to 1 peers)
[S13] START round=45 head_norm_before_train=1.401033 cos_to_last_merge=0.8793 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.879
[S13] round=45 local utility u=0.000000 metrics={'f1_val': 0.5339168035476407, 'auprc': 0.6939047271014435, 'loss_val': 1.0745532628325438, 'psi': 0.5979119729691618}-{'f1_val': 0.5523027446398522, 'auprc': 0.6904870421578477, 'loss_val': 0.9163948014699166, 'psi': 0.6075764636470504}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=45 head_norm_before_train=2.110574 cos_to_last_merge=0.9812 (last merge round=17)
[S14] round=45 local utility u=0.000000 metrics={'f1_val': 0.9967577367102773, 'auprc': 0.9968098742418999, 'loss_val': 0.022201976912886365, 'psi': 0.9967785917229264}-{'f1_val': 0.9967358680170888, 'auprc': 0.9969543601332631, 'loss_val': 0.022483213603823073, 'psi': 0.9968232648635585}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=45 head_norm_before_train=2.056278 cos_to_last_merge=0.9643 (last merge round=13)
[S15] round=45 local utility u=0.000000 metrics={'f1_val': 0.8853150523628756, 'auprc': 0.995598666268724, 'loss_val': 0.25247433089845517, 'psi': 0.929428497925215}-{'f1_val': 0.9969902329512002, 'auprc': 0.9989190396555524, 'loss_val': 0.021403380935629778, 'psi': 0.9977617556329411}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=45 head_norm_before_train=1.613182 cos_to_last_merge=0.9096 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.910
[S16] round=45 local utility u=0.644859 metrics={'f1_val': 0.988338035676358, 'auprc': 0.9792218811312727, 'loss_val': 0.05559191233109761, 'psi': 0.984691573858324}-{'f1_val': 0.8748781684339604, 'auprc': 0.9839507346786562, 'loss_val': 0.6787363669058875, 'psi': 0.9185071949318387}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] sending update (kind=head size=1804 to 1 peers)
[S17] START round=45 head_norm_before_train=2.110055 cos_to_last_merge=0.9665 (last merge round=13)
[S17] round=45 local utility u=0.040280 metrics={'f1_val': 0.5916461750112528, 'auprc': 0.7231876499174478, 'loss_val': 1.18587561074414, 'psi': 0.6442627649737308}-{'f1_val': 0.6098989666519505, 'auprc': 0.7086572482999374, 'loss_val': 1.3323613451956986, 'psi': 0.6494022793111454}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] START round=46 head_norm_before_train=1.500543 cos_to_last_merge=0.9778 (last merge round=23)
[S2] round=46 local utility u=0.000000 metrics={'f1_val': 0.6691006006059017, 'auprc': 0.736743482263792, 'loss_val': 1.0105134426330566, 'psi': 0.6961577532690578}-{'f1_val': 0.6969439583499939, 'auprc': 0.735281673444542, 'loss_val': 0.9282628867577446, 'psi': 0.7122790443878131}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=46 head_norm_before_train=1.876989 cos_to_last_merge=0.7929 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.793
[S3] round=46 local utility u=0.057227 metrics={'f1_val': 0.9973982357793907, 'auprc': 0.9995701492063686, 'loss_val': 0.027736262255218753, 'psi': 0.9982670011501819}-{'f1_val': 0.9821381472866884, 'auprc': 0.999203592898158, 'loss_val': 0.049529958584660055, 'psi': 0.9889643255312762}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=46 head_norm_before_train=1.689565 cos_to_last_merge=0.9625 (last merge round=15)
[S4] round=46 local utility u=0.000000 metrics={'f1_val': 0.9419522978880135, 'auprc': 0.9636135019457286, 'loss_val': 0.29253793627233965, 'psi': 0.9506167795110996}-{'f1_val': 0.953496257960023, 'auprc': 0.9783404136885783, 'loss_val': 0.25984919583592625, 'psi': 0.963433920251445}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=46 head_norm_before_train=1.374525 cos_to_last_merge=0.9263 (last merge round=16)
[S5] ⚠️ Model drifted since last merge! cos=0.926
[S5] round=46 local utility u=0.000000 metrics={'f1_val': 0.5025752359857687, 'auprc': 0.8556289159200261, 'loss_val': 0.756972068490628, 'psi': 0.6437967079594717}-{'f1_val': 0.7004938661094564, 'auprc': 0.9894224921314682, 'loss_val': 0.19431936823385204, 'psi': 0.8160653165182611}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=46 head_norm_before_train=1.878253 cos_to_last_merge=0.9733 (last merge round=15)
[S6] round=46 local utility u=0.004992 metrics={'f1_val': 0.82298686871086, 'auprc': 0.9609608460475558, 'loss_val': 0.3945790638329759, 'psi': 0.8781764596455384}-{'f1_val': 0.8237257784803018, 'auprc': 0.9599537528672776, 'loss_val': 0.40597450244497324, 'psi': 0.8782169682350921}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] sending update (kind=head size=1795 to 1 peers)
[S7] START round=46 head_norm_before_train=1.540301 cos_to_last_merge=0.8170 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.817
[S7] round=46 local utility u=0.000000 metrics={'f1_val': 0.5919252289739578, 'auprc': 0.7906750212740686, 'loss_val': 0.6666747973782254, 'psi': 0.6714251458940022}-{'f1_val': 0.6646609541834575, 'auprc': 0.8174983169444806, 'loss_val': 0.4117585990129193, 'psi': 0.7257958992878668}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=46 head_norm_before_train=2.111388 cos_to_last_merge=0.9803 (last merge round=15)
[S8] round=46 local utility u=0.027119 metrics={'f1_val': 0.9924611780272952, 'auprc': 0.9993624497792917, 'loss_val': 0.0317509877573227, 'psi': 0.9952216867280939}-{'f1_val': 0.9927720833909908, 'auprc': 0.9876319799245432, 'loss_val': 0.05266374334421739, 'psi': 0.9907160420044117}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] sending update (kind=head size=1803 to 1 peers)
[S9] START round=46 head_norm_before_train=1.865904 cos_to_last_merge=0.7933 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.793
[S9] round=46 local utility u=0.000000 metrics={'f1_val': 0.9960207019771873, 'auprc': 0.9985830302781966, 'loss_val': 0.021279032057055794, 'psi': 0.997045633297591}-{'f1_val': 0.9966605118138915, 'auprc': 0.9985363472065852, 'loss_val': 0.019927710411408787, 'psi': 0.997410845970969}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=46 head_norm_before_train=1.614687 cos_to_last_merge=0.9161 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.916
[S10] round=46 local utility u=0.096057 metrics={'f1_val': 0.9959407510105199, 'auprc': 0.9974181155974735, 'loss_val': 0.036283919368008906, 'psi': 0.9965316968453013}-{'f1_val': 0.9742387866007133, 'auprc': 0.9935258328272247, 'loss_val': 0.08651020919051926, 'psi': 0.9819536050913179}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=46 head_norm_before_train=1.632178 cos_to_last_merge=0.9380 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.938
[S11] round=46 local utility u=0.000000 metrics={'f1_val': 0.9896246543687631, 'auprc': 0.9967339894134445, 'loss_val': 0.038081780842510245, 'psi': 0.9924683883866356}-{'f1_val': 0.9965470045135896, 'auprc': 0.9966647906266287, 'loss_val': 0.025183116885899783, 'psi': 0.9965941189588052}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=46 head_norm_before_train=1.407753 cos_to_last_merge=0.8788 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.879
[S13] round=46 local utility u=0.103544 metrics={'f1_val': 0.5419163014160521, 'auprc': 0.6909102387522792, 'loss_val': 0.9064790674340379, 'psi': 0.601513876350543}-{'f1_val': 0.5339168035476407, 'auprc': 0.6939047271014435, 'loss_val': 1.0745532628325438, 'psi': 0.5979119729691618}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=46 head_norm_before_train=2.116919 cos_to_last_merge=0.9809 (last merge round=17)
[S14] round=46 local utility u=0.000332 metrics={'f1_val': 0.9970007132142444, 'auprc': 0.9961868060371367, 'loss_val': 0.02112705954140047, 'psi': 0.9966751503434014}-{'f1_val': 0.9967577367102773, 'auprc': 0.9968098742418999, 'loss_val': 0.022201976912886365, 'psi': 0.9967785917229264}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[S15] START round=46 head_norm_before_train=2.065002 cos_to_last_merge=0.9635 (last merge round=13)
[S15] round=46 local utility u=0.062978 metrics={'f1_val': 0.9018821329741181, 'auprc': 0.997035436768354, 'loss_val': 0.2302309391538789, 'psi': 0.9399434544918126}-{'f1_val': 0.8853150523628756, 'auprc': 0.995598666268724, 'loss_val': 0.25247433089845517, 'psi': 0.929428497925215}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=46 head_norm_before_train=1.623633 cos_to_last_merge=0.9086 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.909
[S16] round=46 local utility u=0.000000 metrics={'f1_val': 0.9082747021918662, 'auprc': 0.9832567069155052, 'loss_val': 0.5117004939979698, 'psi': 0.9382675040813218}-{'f1_val': 0.988338035676358, 'auprc': 0.9792218811312727, 'loss_val': 0.05559191233109761, 'psi': 0.984691573858324}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=46 head_norm_before_train=2.119730 cos_to_last_merge=0.9658 (last merge round=13)
[S17] round=46 local utility u=0.000000 metrics={'f1_val': 0.5759887731668224, 'auprc': 0.675076383766516, 'loss_val': 1.422336124755996, 'psi': 0.6156238174066999}-{'f1_val': 0.5916461750112528, 'auprc': 0.7231876499174478, 'loss_val': 1.18587561074414, 'psi': 0.6442627649737308}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=47 head_norm_before_train=1.514444 cos_to_last_merge=0.9762 (last merge round=23)
[S2] round=47 local utility u=0.000000 metrics={'f1_val': 0.6188868275198817, 'auprc': 0.7335890145556432, 'loss_val': 1.1959819073545934, 'psi': 0.6647677023341863}-{'f1_val': 0.6691006006059017, 'auprc': 0.736743482263792, 'loss_val': 1.0105134426330566, 'psi': 0.6961577532690578}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=47 head_norm_before_train=1.888388 cos_to_last_merge=0.7918 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.792
[S3] round=47 local utility u=0.000000 metrics={'f1_val': 0.986478577043473, 'auprc': 0.9995779230827682, 'loss_val': 0.045593948584496245, 'psi': 0.9917183154591911}-{'f1_val': 0.9973982357793907, 'auprc': 0.9995701492063686, 'loss_val': 0.027736262255218753, 'psi': 0.9982670011501819}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=47 head_norm_before_train=1.694058 cos_to_last_merge=0.9619 (last merge round=15)
[S4] round=47 local utility u=0.029528 metrics={'f1_val': 0.9470921073076758, 'auprc': 0.9664012403422189, 'loss_val': 0.2726830404803421, 'psi': 0.9548157605214931}-{'f1_val': 0.9419522978880135, 'auprc': 0.9636135019457286, 'loss_val': 0.29253793627233965, 'psi': 0.9506167795110996}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=47 head_norm_before_train=1.378114 cos_to_last_merge=0.9263 (last merge round=16)
[S5] ⚠️ Model drifted since last merge! cos=0.926
[S5] round=47 local utility u=0.444268 metrics={'f1_val': 0.5986473576806036, 'auprc': 0.8708071334660147, 'loss_val': 0.4904038575206047, 'psi': 0.707511267994768}-{'f1_val': 0.5025752359857687, 'auprc': 0.8556289159200261, 'loss_val': 0.756972068490628, 'psi': 0.6437967079594717}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=47 head_norm_before_train=1.888607 cos_to_last_merge=0.9726 (last merge round=15)
[S6] round=47 local utility u=0.000000 metrics={'f1_val': 0.7650082654904448, 'auprc': 0.9495532936842822, 'loss_val': 0.6213703657404189, 'psi': 0.8388262767679797}-{'f1_val': 0.82298686871086, 'auprc': 0.9609608460475558, 'loss_val': 0.3945790638329759, 'psi': 0.8781764596455384}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=47 head_norm_before_train=1.546975 cos_to_last_merge=0.8165 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.817
[S7] round=47 local utility u=0.524221 metrics={'f1_val': 0.6849975219680864, 'auprc': 0.8468080522279903, 'loss_val': 0.3450654805232079, 'psi': 0.7497217340720479}-{'f1_val': 0.5919252289739578, 'auprc': 0.7906750212740686, 'loss_val': 0.6666747973782254, 'psi': 0.6714251458940022}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=47 head_norm_before_train=2.114708 cos_to_last_merge=0.9797 (last merge round=15)
[S8] round=47 local utility u=0.000000 metrics={'f1_val': 0.9889241575992487, 'auprc': 0.9993364452732465, 'loss_val': 0.03754052641734957, 'psi': 0.9930890726688477}-{'f1_val': 0.9924611780272952, 'auprc': 0.9993624497792917, 'loss_val': 0.0317509877573227, 'psi': 0.9952216867280939}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=47 head_norm_before_train=1.873704 cos_to_last_merge=0.7929 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.793
[S9] round=47 local utility u=0.001593 metrics={'f1_val': 0.9964354604519897, 'auprc': 0.9988832865478701, 'loss_val': 0.021482143880853323, 'psi': 0.9974145908903418}-{'f1_val': 0.9960207019771873, 'auprc': 0.9985830302781966, 'loss_val': 0.021279032057055794, 'psi': 0.997045633297591}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=47 head_norm_before_train=1.627988 cos_to_last_merge=0.9147 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.915
[S10] round=47 local utility u=0.000000 metrics={'f1_val': 0.9882336947854131, 'auprc': 0.9934766239078789, 'loss_val': 0.06772722631281411, 'psi': 0.9903308664343995}-{'f1_val': 0.9959407510105199, 'auprc': 0.9974181155974735, 'loss_val': 0.036283919368008906, 'psi': 0.9965316968453013}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=47 head_norm_before_train=1.641234 cos_to_last_merge=0.9371 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.937
[S11] round=47 local utility u=0.025198 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9960258598117577, 'loss_val': 0.025644565771621514, 'psi': 0.9961934444060196}-{'f1_val': 0.9896246543687631, 'auprc': 0.9967339894134445, 'loss_val': 0.038081780842510245, 'psi': 0.9924683883866356}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=47 head_norm_before_train=1.414522 cos_to_last_merge=0.8780 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.878
[S13] round=47 local utility u=0.147444 metrics={'f1_val': 0.5731683044747715, 'auprc': 0.7009412960512957, 'loss_val': 0.8291953329030844, 'psi': 0.6242775011053812}-{'f1_val': 0.5419163014160521, 'auprc': 0.6909102387522792, 'loss_val': 0.9064790674340379, 'psi': 0.601513876350543}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=47 head_norm_before_train=2.126058 cos_to_last_merge=0.9804 (last merge round=17)
[S14] round=47 local utility u=0.005981 metrics={'f1_val': 0.9973862616479148, 'auprc': 0.9988349199458231, 'loss_val': 0.019421949731633772, 'psi': 0.9979657249670781}-{'f1_val': 0.9970007132142444, 'auprc': 0.9961868060371367, 'loss_val': 0.02112705954140047, 'psi': 0.9966751503434014}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=47 head_norm_before_train=2.074555 cos_to_last_merge=0.9627 (last merge round=13)
[S15] round=47 local utility u=0.000000 metrics={'f1_val': 0.700957864484732, 'auprc': 0.9387762400399413, 'loss_val': 0.5207864494007969, 'psi': 0.7960852147068157}-{'f1_val': 0.9018821329741181, 'auprc': 0.997035436768354, 'loss_val': 0.2302309391538789, 'psi': 0.9399434544918126}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=47 head_norm_before_train=1.631531 cos_to_last_merge=0.9069 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.907
[S16] round=47 local utility u=0.096719 metrics={'f1_val': 0.9270904598724089, 'auprc': 0.9812757760754517, 'loss_val': 0.42521504094872814, 'psi': 0.948764586353626}-{'f1_val': 0.9082747021918662, 'auprc': 0.9832567069155052, 'loss_val': 0.5117004939979698, 'psi': 0.9382675040813218}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S16] sending update (kind=head size=1806 to 1 peers)
[S17] START round=47 head_norm_before_train=2.128557 cos_to_last_merge=0.9651 (last merge round=13)
[S17] round=47 local utility u=0.450594 metrics={'f1_val': 0.5985418741341081, 'auprc': 0.823218989429553, 'loss_val': 1.1008948351769752, 'psi': 0.6884127202522861}-{'f1_val': 0.5759887731668224, 'auprc': 0.675076383766516, 'loss_val': 1.422336124755996, 'psi': 0.6156238174066999}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] sending update (kind=head size=1795 to 1 peers)
[S2] START round=48 head_norm_before_train=1.528671 cos_to_last_merge=0.9746 (last merge round=23)
[S2] round=48 local utility u=0.247506 metrics={'f1_val': 0.6696625625499529, 'auprc': 0.7377602458030101, 'loss_val': 1.0181386813526176, 'psi': 0.6969016358511758}-{'f1_val': 0.6188868275198817, 'auprc': 0.7335890145556432, 'loss_val': 1.1959819073545934, 'psi': 0.6647677023341863}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[S3] START round=48 head_norm_before_train=1.895647 cos_to_last_merge=0.7911 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.791
[S3] round=48 local utility u=0.000000 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.9992406958700526, 'loss_val': 0.11182668752206855, 'psi': 0.9763174290112873}-{'f1_val': 0.986478577043473, 'auprc': 0.9995779230827682, 'loss_val': 0.045593948584496245, 'psi': 0.9917183154591911}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=48 head_norm_before_train=1.700743 cos_to_last_merge=0.9611 (last merge round=15)
[S4] round=48 local utility u=0.026673 metrics={'f1_val': 0.9519442144820074, 'auprc': 0.9715613610289272, 'loss_val': 0.2639300666540941, 'psi': 0.9597910731007753}-{'f1_val': 0.9470921073076758, 'auprc': 0.9664012403422189, 'loss_val': 0.2726830404803421, 'psi': 0.9548157605214931}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] START round=48 head_norm_before_train=1.382839 cos_to_last_merge=0.9260 (last merge round=16)
[S5] ⚠️ Model drifted since last merge! cos=0.926
[S5] round=48 local utility u=0.609842 metrics={'f1_val': 0.700407554886547, 'auprc': 0.9830333865584198, 'loss_val': 0.21795951663866114, 'psi': 0.8134578875552961}-{'f1_val': 0.5986473576806036, 'auprc': 0.8708071334660147, 'loss_val': 0.4904038575206047, 'psi': 0.707511267994768}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=48 head_norm_before_train=1.898079 cos_to_last_merge=0.9718 (last merge round=15)
[S6] round=48 local utility u=0.406599 metrics={'f1_val': 0.8463784831951249, 'auprc': 0.9632155743939937, 'loss_val': 0.3373807488346496, 'psi': 0.8931133196746724}-{'f1_val': 0.7650082654904448, 'auprc': 0.9495532936842822, 'loss_val': 0.6213703657404189, 'psi': 0.8388262767679797}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] START round=48 head_norm_before_train=1.554396 cos_to_last_merge=0.8158 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.816
[S7] round=48 local utility u=0.000000 metrics={'f1_val': 0.6513367722484811, 'auprc': 0.8097826185804176, 'loss_val': 0.4981845676353026, 'psi': 0.7147151107812557}-{'f1_val': 0.6849975219680864, 'auprc': 0.8468080522279903, 'loss_val': 0.3450654805232079, 'psi': 0.7497217340720479}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=48 head_norm_before_train=2.117167 cos_to_last_merge=0.9798 (last merge round=15)
[S8] round=48 local utility u=0.016536 metrics={'f1_val': 0.9933751911041674, 'auprc': 0.9993295950143581, 'loss_val': 0.031153610543915054, 'psi': 0.9957569526682437}-{'f1_val': 0.9889241575992487, 'auprc': 0.9993364452732465, 'loss_val': 0.03754052641734957, 'psi': 0.9930890726688477}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] sending update (kind=head size=1794 to 1 peers)
[S9] START round=48 head_norm_before_train=1.882495 cos_to_last_merge=0.7926 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.793
[S9] round=48 local utility u=0.002121 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9988607549669261, 'loss_val': 0.01967494514653158, 'psi': 0.9976558532421247}-{'f1_val': 0.9964354604519897, 'auprc': 0.9988832865478701, 'loss_val': 0.021482143880853323, 'psi': 0.9974145908903418}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=48 head_norm_before_train=1.639505 cos_to_last_merge=0.9134 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.913
[S10] round=48 local utility u=0.042623 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9969657098331413, 'loss_val': 0.03548556560618737, 'psi': 0.9959801562714947}-{'f1_val': 0.9882336947854131, 'auprc': 0.9934766239078789, 'loss_val': 0.06772722631281411, 'psi': 0.9903308664343995}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=48 head_norm_before_train=1.649915 cos_to_last_merge=0.9363 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.936
[S11] round=48 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9955924900530078, 'loss_val': 0.025247623153823295, 'psi': 0.9959172009691887}-{'f1_val': 0.996305167468861, 'auprc': 0.9960258598117577, 'loss_val': 0.025644565771621514, 'psi': 0.9961934444060196}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=48 head_norm_before_train=1.422341 cos_to_last_merge=0.8772 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.877
[S13] round=48 local utility u=0.063012 metrics={'f1_val': 0.6040350188996193, 'auprc': 0.6934127279535601, 'loss_val': 0.8657851627925095, 'psi': 0.6397861025211956}-{'f1_val': 0.5731683044747715, 'auprc': 0.7009412960512957, 'loss_val': 0.8291953329030844, 'psi': 0.6242775011053812}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=48 head_norm_before_train=2.132100 cos_to_last_merge=0.9802 (last merge round=17)
[S14] round=48 local utility u=0.000331 metrics={'f1_val': 0.9977975102598944, 'auprc': 0.9988324160575256, 'loss_val': 0.02122038406374159, 'psi': 0.9982114725789469}-{'f1_val': 0.9973862616479148, 'auprc': 0.9988349199458231, 'loss_val': 0.019421949731633772, 'psi': 0.9979657249670781}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=48 head_norm_before_train=2.083971 cos_to_last_merge=0.9620 (last merge round=13)
[S15] round=48 local utility u=1.000000 metrics={'f1_val': 0.9970299290849798, 'auprc': 0.9974381048118792, 'loss_val': 0.019884566063822176, 'psi': 0.9971931993757395}-{'f1_val': 0.700957864484732, 'auprc': 0.9387762400399413, 'loss_val': 0.5207864494007969, 'psi': 0.7960852147068157}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=48 head_norm_before_train=1.637761 cos_to_last_merge=0.9057 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.906
[S16] round=48 local utility u=0.384332 metrics={'f1_val': 0.9898123232560964, 'auprc': 0.9870263098508305, 'loss_val': 0.05013287267848589, 'psi': 0.98869791789399}-{'f1_val': 0.9270904598724089, 'auprc': 0.9812757760754517, 'loss_val': 0.42521504094872814, 'psi': 0.948764586353626}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=48 head_norm_before_train=2.139344 cos_to_last_merge=0.9645 (last merge round=13)
[S17] round=48 local utility u=0.000000 metrics={'f1_val': 0.6123554351204727, 'auprc': 0.7115813776939707, 'loss_val': 1.3929731116423556, 'psi': 0.6520458121498719}-{'f1_val': 0.5985418741341081, 'auprc': 0.823218989429553, 'loss_val': 1.1008948351769752, 'psi': 0.6884127202522861}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=49 head_norm_before_train=1.539915 cos_to_last_merge=0.9733 (last merge round=23)
[S2] round=49 local utility u=0.000000 metrics={'f1_val': 0.6530565319363875, 'auprc': 0.72975371641183, 'loss_val': 1.176537321298944, 'psi': 0.6837354057265644}-{'f1_val': 0.6696625625499529, 'auprc': 0.7377602458030101, 'loss_val': 1.0181386813526176, 'psi': 0.6969016358511758}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=49 head_norm_before_train=1.904130 cos_to_last_merge=0.7905 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.790
[S3] round=49 local utility u=0.150453 metrics={'f1_val': 0.9965365984006044, 'auprc': 0.9992410584442819, 'loss_val': 0.02392888295806762, 'psi': 0.9976183824180753}-{'f1_val': 0.9610352511054436, 'auprc': 0.9992406958700526, 'loss_val': 0.11182668752206855, 'psi': 0.9763174290112873}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] sending update (kind=head size=1795 to 1 peers)
[S4] START round=49 head_norm_before_train=1.706612 cos_to_last_merge=0.9601 (last merge round=15)
[S4] round=49 local utility u=0.000000 metrics={'f1_val': 0.9433500124168925, 'auprc': 0.9654838377103995, 'loss_val': 0.2862392454429883, 'psi': 0.9522035425342954}-{'f1_val': 0.9519442144820074, 'auprc': 0.9715613610289272, 'loss_val': 0.2639300666540941, 'psi': 0.9597910731007753}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=49 head_norm_before_train=1.387138 cos_to_last_merge=0.9260 (last merge round=16)
[S5] ⚠️ Model drifted since last merge! cos=0.926
[S5] round=49 local utility u=0.000000 metrics={'f1_val': 0.4280335685344707, 'auprc': 0.8499156151471992, 'loss_val': 1.3265111883250114, 'psi': 0.5967863871795621}-{'f1_val': 0.700407554886547, 'auprc': 0.9830333865584198, 'loss_val': 0.21795951663866114, 'psi': 0.8134578875552961}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=49 head_norm_before_train=1.910839 cos_to_last_merge=0.9713 (last merge round=15)
[S6] round=49 local utility u=0.044304 metrics={'f1_val': 0.8546500145429443, 'auprc': 0.9650615258304494, 'loss_val': 0.30393996297999054, 'psi': 0.8988146190579462}-{'f1_val': 0.8463784831951249, 'auprc': 0.9632155743939937, 'loss_val': 0.3373807488346496, 'psi': 0.8931133196746724}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] START round=49 head_norm_before_train=1.559622 cos_to_last_merge=0.8151 (last merge round=2)
[S7] ⚠️ Model drifted since last merge! cos=0.815
[S7] round=49 local utility u=0.000000 metrics={'f1_val': 0.5855172326949922, 'auprc': 0.7937611893135484, 'loss_val': 0.728579848541859, 'psi': 0.6688148153424147}-{'f1_val': 0.6513367722484811, 'auprc': 0.8097826185804176, 'loss_val': 0.4981845676353026, 'psi': 0.7147151107812557}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=49 head_norm_before_train=2.122303 cos_to_last_merge=0.9797 (last merge round=15)
[S8] round=49 local utility u=0.000371 metrics={'f1_val': 0.9933751911041674, 'auprc': 0.9994692778604191, 'loss_val': 0.03082966331826325, 'psi': 0.9958128258066681}-{'f1_val': 0.9933751911041674, 'auprc': 0.9993295950143581, 'loss_val': 0.031153610543915054, 'psi': 0.9957569526682437}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] START round=49 head_norm_before_train=1.890195 cos_to_last_merge=0.7919 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.792
[S9] round=49 local utility u=0.000000 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.995314612225582, 'loss_val': 0.020141356590131654, 'psi': 0.9958759017577994}-{'f1_val': 0.9968525854255906, 'auprc': 0.9988607549669261, 'loss_val': 0.01967494514653158, 'psi': 0.9976558532421247}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=49 head_norm_before_train=1.651784 cos_to_last_merge=0.9121 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.912
[S10] round=49 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9954508750608604, 'loss_val': 0.03932459305000456, 'psi': 0.9953742223625823}-{'f1_val': 0.9953231205637304, 'auprc': 0.9969657098331413, 'loss_val': 0.03548556560618737, 'psi': 0.9959801562714947}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=49 head_norm_before_train=1.658354 cos_to_last_merge=0.9355 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.935
[S11] round=49 local utility u=0.000332 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9954603168226305, 'loss_val': 0.024186994033781765, 'psi': 0.9958643316770378}-{'f1_val': 0.9961336749133093, 'auprc': 0.9955924900530078, 'loss_val': 0.025247623153823295, 'psi': 0.9959172009691887}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=49 head_norm_before_train=1.431774 cos_to_last_merge=0.8766 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.877
[S13] round=49 local utility u=0.000000 metrics={'f1_val': 0.5860229878979113, 'auprc': 0.7069569450439301, 'loss_val': 0.9492552656255894, 'psi': 0.6343965707563188}-{'f1_val': 0.6040350188996193, 'auprc': 0.6934127279535601, 'loss_val': 0.8657851627925095, 'psi': 0.6397861025211956}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=49 head_norm_before_train=2.134527 cos_to_last_merge=0.9802 (last merge round=17)
[S14] round=49 local utility u=0.000365 metrics={'f1_val': 0.9973891252095638, 'auprc': 0.9992169991915659, 'loss_val': 0.01919383181419872, 'psi': 0.9981202748023648}-{'f1_val': 0.9977975102598944, 'auprc': 0.9988324160575256, 'loss_val': 0.02122038406374159, 'psi': 0.9982114725789469}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=49 head_norm_before_train=2.091468 cos_to_last_merge=0.9613 (last merge round=13)
[S15] round=49 local utility u=0.002362 metrics={'f1_val': 0.9974005142255595, 'auprc': 0.9982131593864829, 'loss_val': 0.019709503607814486, 'psi': 0.9977255722899289}-{'f1_val': 0.9970299290849798, 'auprc': 0.9974381048118792, 'loss_val': 0.019884566063822176, 'psi': 0.9971931993757395}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=49 head_norm_before_train=1.644272 cos_to_last_merge=0.9049 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.905
[S16] round=49 local utility u=0.003851 metrics={'f1_val': 0.990864877883195, 'auprc': 0.9864258430851527, 'loss_val': 0.04694510646586092, 'psi': 0.9890892639639781}-{'f1_val': 0.9898123232560964, 'auprc': 0.9870263098508305, 'loss_val': 0.05013287267848589, 'psi': 0.98869791789399}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S17] START round=49 head_norm_before_train=2.149263 cos_to_last_merge=0.9640 (last merge round=13)
[S17] round=49 local utility u=0.049850 metrics={'f1_val': 0.6143291585613145, 'auprc': 0.732863087202922, 'loss_val': 1.3689599211444476, 'psi': 0.6617427300179575}-{'f1_val': 0.6123554351204727, 'auprc': 0.7115813776939707, 'loss_val': 1.3929731116423556, 'psi': 0.6520458121498719}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] sending update (kind=head size=1795 to 1 peers)
[runner] rounds complete.
[runner] all agents stopped.
