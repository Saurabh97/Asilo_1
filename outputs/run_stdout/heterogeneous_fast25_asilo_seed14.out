[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:62403
[S3] → join 127.0.0.1:62402
[S4] → join 127.0.0.1:62402
[S5] → join 127.0.0.1:62402
[S6] → join 127.0.0.1:62402
[S7] → join 127.0.0.1:62402
[S8] → join 127.0.0.1:62402
[S9] → join 127.0.0.1:62402
[S10] → join 127.0.0.1:62402
[S11] → join 127.0.0.1:62402
[S13] → join 127.0.0.1:62402
[S14] → join 127.0.0.1:62402
[S15] → join 127.0.0.1:62402
[S16] → join 127.0.0.1:62402
[S17] → join 127.0.0.1:62402
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.142901 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.168378 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.198987 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.172627 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.206220 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.187376 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.123996 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.175820 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.153179 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.214462 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.179534 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.200183 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.213352 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.153638 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.194551 (no previous merge yet)
[S17]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S3] + discovered S10
[S4] + discovered S2
[S4] + discovered S3
[S3] + discovered S9
[S3] + discovered S16
[S3] + discovered S4
[S3] + discovered S14
[S3] + discovered S15
[S3] + discovered S8
[S3] + discovered S7
[S3] + discovered S13
[S3] + discovered S6
[S3] + discovered S11
[S3] + discovered S5
[S3] + discovered S17
[S4] + discovered S16
[S4] + discovered S9
[S4] + discovered S14
[S4] + discovered S15
[S5] + discovered S4
[S4] + discovered S7
[S4] + discovered S13
[S4] + discovered S6
[S4] + discovered S11
[S4] + discovered S5
[S4] + discovered S10
[S4] + discovered S17
[S5] + discovered S2
[S4] + discovered S8
[S5] + discovered S3
[S6] + discovered S3
[S6] + discovered S4
[S6] + discovered S2
[S6] + discovered S5
[S5] + discovered S11
[S5] + discovered S17
[S5] + discovered S6
[S5] + discovered S7
[S5] + discovered S15
[S5] + discovered S10
[S5] + discovered S13
[S5] + discovered S8
[S5] + discovered S14
[S5] + discovered S16
[S5] + discovered S9
[S7] + discovered S6
[S7] + discovered S2
[S7] + discovered S3
[S7] + discovered S5
[S7] + discovered S4
[S6] + discovered S9
[S6] + discovered S14
[S6] + discovered S10
[S6] + discovered S15
[S6] + discovered S7
[S6] + discovered S17
[S6] + discovered S11
[S6] + discovered S16
[S6] + discovered S8
[S6] + discovered S13
[S7] + discovered S13
[S7] + discovered S10
[S7] + discovered S16
[S7] + discovered S8
[S7] + discovered S11
[S7] + discovered S17
[S7] + discovered S15
[S7] + discovered S14
[S7] + discovered S9
[S8] + discovered S4
[S8] + discovered S3
[S8] + discovered S2
[S8] + discovered S5
[S8] + discovered S7
[S8] + discovered S6
[S9] + discovered S5
[S9] + discovered S8
[S9] + discovered S2
[S9] + discovered S4
[S9] + discovered S6
[S9] + discovered S7
[S9] + discovered S3
[S8] + discovered S9
[S8] + discovered S15
[S8] + discovered S17
[S8] + discovered S16
[S8] + discovered S14
[S8] + discovered S11
[S8] + discovered S10
[S8] + discovered S13
[S9] + discovered S13
[S9] + discovered S10
[S9] + discovered S11
[S9] + discovered S14
[S10] + discovered S4
[S9] + discovered S17
[S9] + discovered S15
[S10] + discovered S3
[S10] + discovered S7
[S10] + discovered S6
[S10] + discovered S2
[S10] + discovered S8
[S10] + discovered S5
[S9] + discovered S16
[S10] + discovered S9
[S11] + discovered S4
[S11] + discovered S8
[S11] + discovered S6
[S11] + discovered S7
[S11] + discovered S3
[S11] + discovered S9
[S11] + discovered S5
[S11] + discovered S2
[S11] + discovered S10
[S10] + discovered S17
[S10] + discovered S15
[S10] + discovered S16
[S10] + discovered S14
[S10] + discovered S11
[S10] + discovered S13
[S13] + discovered S4
[S13] + discovered S6
[S13] + discovered S3
[S13] + discovered S9
[S13] + discovered S11
[S13] + discovered S8
[S11] + discovered S14
[S11] + discovered S17
[S11] + discovered S15
[S11] + discovered S16
[S11] + discovered S13
[S13] + discovered S7
[S13] + discovered S5
[S13] + discovered S2
[S13] + discovered S10
[S14] + discovered S7
[S14] + discovered S2
[S14] + discovered S13
[S14] + discovered S5
[S14] + discovered S10
[S14] + discovered S11
[S14] + discovered S8
[S14] + discovered S4
[S14] + discovered S9
[S14] + discovered S3
[S14] + discovered S6
[S13] + discovered S15
[S13] + discovered S14
[S13] + discovered S17
[S13] + discovered S16
[S15] + discovered S14
[S15] + discovered S9
[S15] + discovered S13
[S15] + discovered S6
[S14] + discovered S15
[S14] + discovered S16
[S14] + discovered S17
[S15] + discovered S2
[S15] + discovered S8
[S15] + discovered S11
[S15] + discovered S4
[S15] + discovered S3
[S15] + discovered S7
[S15] + discovered S10
[S15] + discovered S5
[S15] + discovered S16
[S16] + discovered S2
[S15] + discovered S17
[S16] + discovered S4
[S16] + discovered S8
[S16] + discovered S11
[S16] + discovered S3
[S16] + discovered S7
[S16] + discovered S10
[S16] + discovered S9
[S16] + discovered S6
[S16] + discovered S15
[S16] + discovered S5
[S16] + discovered S14
[S16] + discovered S13
[S17] + discovered S6
[S17] + discovered S15
[S17] + discovered S10
[S17] + discovered S3
[S16] + discovered S17
[S17] + discovered S2
[S17] + discovered S13
[S17] + discovered S14
[S17] + discovered S5
[S17] + discovered S9
[S17] + discovered S7
[S17] + discovered S16
[S17] + discovered S4
[S17] + discovered S11
[S17] + discovered S8
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] ⇄ pheromone p=1.000 → S14@127.0.0.1:62414
[S2] ⇄ pheromone p=1.000 → S6@127.0.0.1:62407
[S16] ⇄ pheromone p=1.000 → S4@127.0.0.1:62404
[S11] ⇄ pheromone p=1.000 → S9@127.0.0.1:62410
[S10] ⇄ pheromone p=1.000 → S4@127.0.0.1:62404
[S14] ⇄ pheromone p=1.000 → S11@127.0.0.1:62412
[S8] ⇄ pheromone p=1.000 → S6@127.0.0.1:62407
[S3] ⇄ pheromone p=1.000 → S2@127.0.0.1:62402
[S6] ⇄ pheromone p=1.000 → S15@127.0.0.1:62415
[S13] ⇄ pheromone p=1.000 → S9@127.0.0.1:62410
[S7] ⇄ pheromone p=1.000 → S6@127.0.0.1:62407
[S5] ⇄ pheromone p=1.000 → S9@127.0.0.1:62410
[S4] ⇄ pheromone p=1.000 → S5@127.0.0.1:62405
[S9] ⇄ pheromone p=1.000 → S14@127.0.0.1:62414
[S17] ⇄ pheromone p=1.000 → S5@127.0.0.1:62405
[S2] START round=1 head_norm_before_train=1.142236 (no previous merge yet)
[S2] round=1 local utility u=0.584395 metrics={'f1_val': 0.2584890273612997, 'auprc': 0.7261219543826316, 'loss_val': 1.3284578465796, 'psi': 0.4455421981698325}-{'f1_val': 0.10477605118829982, 'auprc': 0.655140282127201, 'loss_val': 1.362025140514365, 'psi': 0.32492174356386033}
[S3] START round=1 head_norm_before_train=1.184465 (no previous merge yet)
[S3] round=1 local utility u=0.253329 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9956825990853093, 'loss_val': 1.2779137526288553, 'psi': 0.482177079002588}-{'f1_val': 0.13984006561410703, 'auprc': 0.8458560714907654, 'loss_val': 1.3350925664330882, 'psi': 0.4222464679647704}
[S4] START round=1 head_norm_before_train=1.199373 (no previous merge yet)
[S4] round=1 local utility u=0.972353 metrics={'f1_val': 0.3749331812002737, 'auprc': 0.6165731013581117, 'loss_val': 1.3451952442944606, 'psi': 0.4715891492634089}-{'f1_val': 0.08833063209076175, 'auprc': 0.5532346228179563, 'loss_val': 1.3802711997657418, 'psi': 0.2742922283816396}
[S5] START round=1 head_norm_before_train=1.192092 (no previous merge yet)
[S5] round=1 local utility u=0.031202 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7290131936157225, 'loss_val': 1.2611412155883903, 'psi': 0.37696242030343186}-{'f1_val': 0.14226190476190476, 'auprc': 0.7366421012360286, 'loss_val': 1.3464325320672514, 'psi': 0.3800139833515543}
[S6] START round=1 head_norm_before_train=1.211509 (no previous merge yet)
[S6] round=1 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6962888620943011, 'loss_val': 1.3195015372219445, 'psi': 0.36337131406848966}-{'f1_val': 0.412600303621774, 'auprc': 0.6192042279857234, 'loss_val': 1.3565699142635006, 'psi': 0.4952418733673538}
[S7] START round=1 head_norm_before_train=1.211426 (no previous merge yet)
[S7] round=1 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7924988291407018, 'loss_val': 1.2601905231816626, 'psi': 0.40223362529373574}-{'f1_val': 0.14205682272909165, 'auprc': 0.8486019387259337, 'loss_val': 1.3112232709354004, 'psi': 0.4246748691278285}
[S8] START round=1 head_norm_before_train=1.128760 (no previous merge yet)
[S8] round=1 local utility u=0.005744 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.676365486791365, 'loss_val': 1.3179441759903774, 'psi': 0.3545197841523203}-{'f1_val': 0.17629857344232452, 'auprc': 0.6110359481818779, 'loss_val': 1.3514989464467209, 'psi': 0.3501935233381459}
[S9] START round=1 head_norm_before_train=1.192193 (no previous merge yet)
[S9] round=1 local utility u=0.158556 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9989954200665206, 'loss_val': 1.2334682949397882, 'psi': 0.4844369423106059}-{'f1_val': 0.141397957139996, 'auprc': 0.9205299393435333, 'loss_val': 1.315183851891861, 'psi': 0.453050750021411}
[S10] START round=1 head_norm_before_train=1.149019 (no previous merge yet)
[S10] round=1 local utility u=0.006214 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.5637069291955923, 'loss_val': 1.3364501938337012, 'psi': 0.3086557542032713}-{'f1_val': 0.13862163754172394, 'auprc': 0.569250019832759, 'loss_val': 1.3655081009842056, 'psi': 0.310872990458138}
[S11] START round=1 head_norm_before_train=1.213252 (no previous merge yet)
[S11] round=1 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.8348814240677254, 'loss_val': 1.3328135692673708, 'psi': 0.41820077965095653}-{'f1_val': 0.14041368337311058, 'auprc': 0.8640684820763341, 'loss_val': 1.3614896773233158, 'psi': 0.4298756028544}
[S13] START round=1 head_norm_before_train=1.176415 (no previous merge yet)
[S13] round=1 local utility u=0.325517 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5398835378356567, 'loss_val': 1.3448399476479567, 'psi': 0.30018487268049454}-{'f1_val': 0.1403857625770531, 'auprc': 0.3328381085912027, 'loss_val': 1.3747374487614326, 'psi': 0.21736670098271293}
[S14] START round=1 head_norm_before_train=1.206624 (no previous merge yet)
[S14] round=1 local utility u=0.041040 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7151942586887103, 'loss_val': 1.3181830561801606, 'psi': 0.3702924152051064}-{'f1_val': 0.14035785288270378, 'auprc': 0.6956627689838184, 'loss_val': 1.3416679977439017, 'psi': 0.3624798193231496}
[S15] START round=1 head_norm_before_train=1.209567 (no previous merge yet)
[S15] round=1 local utility u=0.240466 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7609194656084894, 'loss_val': 1.3450366685034216, 'psi': 0.3882079770603308}-{'f1_val': 0.13973365136155833, 'auprc': 0.6108265773388323, 'loss_val': 1.3756897624842757, 'psi': 0.3281708217524679}
[S16] START round=1 head_norm_before_train=1.161671 (no previous merge yet)
[S16] round=1 local utility u=0.321712 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7708679054821159, 'loss_val': 1.320472902008553, 'psi': 0.39272963231236835}-{'f1_val': 0.13176158399673402, 'auprc': 0.5840560078502864, 'loss_val': 1.3502055920898686, 'psi': 0.312679353538155}
[S17] START round=1 head_norm_before_train=1.196861 (no previous merge yet)
[S17] round=1 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5325338007895177, 'loss_val': 1.3336815635482624, 'psi': 0.29758289830623774}-{'f1_val': 0.37094808503529214, 'auprc': 0.4622187104967308, 'loss_val': 1.363749819814958, 'psi': 0.40745633521986757}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] → sending delta(kind=head bytes=1793) to S10@127.0.0.1:62411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S2] → sending delta(kind=head bytes=1790) to S9@127.0.0.1:62410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] → sending delta(kind=head bytes=1794) to S10@127.0.0.1:62411
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:62405
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1785 reason=None
[S14] → sending delta(kind=head bytes=1785) to S17@127.0.0.1:62417
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] → sending delta(kind=head bytes=1794) to S17@127.0.0.1:62417
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S3] → sending delta(kind=head bytes=1791) to S2@127.0.0.1:62402
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:62411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S8] → sending delta(kind=head bytes=1789) to S14@127.0.0.1:62414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S10] → sending delta(kind=head bytes=1791) to S14@127.0.0.1:62414
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] → sending delta(kind=head bytes=1793) to S7@127.0.0.1:62408
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1791 to 1 peers)
[S16] sending update (kind=head size=1794 to 1 peers)
[S9] sending update (kind=head size=1793 to 1 peers)
[S10] sending update (kind=head size=1791 to 1 peers)
[S8] sending update (kind=head size=1789 to 1 peers)
[S4] sending update (kind=head size=1794 to 1 peers)
[S14] sending update (kind=head size=1785 to 1 peers)
[S13] sending update (kind=head size=1794 to 1 peers)
[S2] sending update (kind=head size=1790 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1793 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1793) from S9
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.240276)
[S7] loaded HEAD from S9 (vec_in norm=1.240276)
[S7] cosine check vs S9: cos=-0.0449
[S7] DROPPED delta from S9 (cos=-0.0449 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1791) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.156068)
[S14] loaded HEAD from S10 (vec_in norm=1.156068)
[S14] cosine check vs S10: cos=0.0287
[S14] BUFFERED delta from S10 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1789) from S8
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.142059)
[S14] loaded HEAD from S8 (vec_in norm=1.142059)
[S14] cosine check vs S8: cos=-0.0131
[S14] DROPPED delta from S8 (cos=-0.0131 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1794) from S16
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.175249)
[S17] loaded HEAD from S16 (vec_in norm=1.175249)
[S17] cosine check vs S16: cos=0.0001
[S17] BUFFERED delta from S16 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1785) from S14
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.220985)
[S17] loaded HEAD from S14 (vec_in norm=1.220985)
[S17] cosine check vs S14: cos=-0.0866
[S17] DROPPED delta from S14 (cos=-0.0866 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1799) from S5
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.237278)
[S10] loaded HEAD from S5 (vec_in norm=1.237278)
[S10] cosine check vs S5: cos=-0.0055
[S10] DROPPED delta from S5 (cos=-0.0055 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1794) from S13
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.182341)
[S10] loaded HEAD from S13 (vec_in norm=1.182341)
[S10] cosine check vs S13: cos=0.0157
[S10] BUFFERED delta from S13 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1793) from S15
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.217958)
[S10] loaded HEAD from S15 (vec_in norm=1.217958)
[S10] cosine check vs S15: cos=0.0060
[S10] BUFFERED delta from S15 (total buffered=2)
[S5] RECEIVED delta(kind=head bytes=1794) from S4
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.211070)
[S5] loaded HEAD from S4 (vec_in norm=1.211070)
[S5] cosine check vs S4: cos=0.0898
[S5] BUFFERED delta from S4 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1791) from S3
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.223631)
[S2] loaded HEAD from S3 (vec_in norm=1.223631)
[S2] cosine check vs S3: cos=-0.0662
[S2] DROPPED delta from S3 (cos=-0.0662 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1790) from S2
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.153984)
[S9] loaded HEAD from S2 (vec_in norm=1.153984)
[S9] cosine check vs S2: cos=-0.1031
[S9] DROPPED delta from S2 (cos=-0.1031 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=1 metric=0.1386 head_norm=1.156068
[S10] _apply_head_vector_avg (torch): Δ‖w‖=7.165447e-01
[S10] stored merged vector for next round verification (round=1)
[S10] DEBUG after merge:  round=1 metric=0.1386 head_norm=0.726873 delta_norm=0.716545
[S10] aggregate: ACCEPT kept=['S13', 'S15'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=1 metric=0.1404 head_norm=1.220985
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.286059e-01
[S14] stored merged vector for next round verification (round=1)
[S14] DEBUG after merge:  round=1 metric=0.1404 head_norm=0.852679 delta_norm=0.828606
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=1 metric=0.1423 head_norm=1.237278
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.258830e-01
[S5] stored merged vector for next round verification (round=1)
[S5] DEBUG after merge:  round=1 metric=0.1423 head_norm=0.903710 delta_norm=0.825883
[S5] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=1 metric=0.1409 head_norm=1.209856
[S17] _apply_head_vector_avg (torch): Δ‖w‖=8.432894e-01
[S17] stored merged vector for next round verification (round=1)
[S17] DEBUG after merge:  round=1 metric=0.1409 head_norm=0.843412 delta_norm=0.843289
[S17] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=1.153984 (no previous merge yet)
[S2] round=2 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7255842663962566, 'loss_val': 1.287693062305144, 'psi': 0.3752999865916427}-{'f1_val': 0.2584890273612997, 'auprc': 0.7261219543826316, 'loss_val': 1.3284578465796, 'psi': 0.4455421981698325}
[S3] START round=2 head_norm_before_train=1.223631 (no previous merge yet)
[S3] round=2 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.6188020399630891, 'loss_val': 1.1863679759747612, 'psi': 0.3314248553536999}-{'f1_val': 0.13984006561410703, 'auprc': 0.9956825990853093, 'loss_val': 1.2779137526288553, 'psi': 0.482177079002588}
[S4] START round=2 head_norm_before_train=1.211070 (no previous merge yet)
[S4] round=2 local utility u=0.204057 metrics={'f1_val': 0.3688019458798064, 'auprc': 0.7496087635217107, 'loss_val': 1.299400279188495, 'psi': 0.5211246729365682}-{'f1_val': 0.3749331812002737, 'auprc': 0.6165731013581117, 'loss_val': 1.3451952442944606, 'psi': 0.4715891492634089}
[S5] START round=2 head_norm_before_train=0.903710 cos_to_last_merge=1.0000 (last merge round=1)
[S5] round=2 local utility u=0.018720 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7298325682262341, 'loss_val': 1.2261589027744495, 'psi': 0.3772901701476365}-{'f1_val': 0.14226190476190476, 'auprc': 0.7290131936157225, 'loss_val': 1.2611412155883903, 'psi': 0.37696242030343186}
[S6] START round=2 head_norm_before_train=1.225227 (no previous merge yet)
[S6] round=2 local utility u=0.172221 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.7968449444391683, 'loss_val': 1.276727681984809, 'psi': 0.4035937470064366}-{'f1_val': 0.14142628205128205, 'auprc': 0.6962888620943011, 'loss_val': 1.3195015372219445, 'psi': 0.36337131406848966}
[S7] START round=2 head_norm_before_train=1.251909 (no previous merge yet)
[S7] round=2 local utility u=0.032909 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7929643279043246, 'loss_val': 1.1957683179999001, 'psi': 0.40241982479918487}-{'f1_val': 0.14205682272909165, 'auprc': 0.7924988291407018, 'loss_val': 1.2601905231816626, 'psi': 0.40223362529373574}
[S8] START round=2 head_norm_before_train=1.142059 (no previous merge yet)
[S8] round=2 local utility u=0.070715 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7107820601846514, 'loss_val': 1.2797639712260416, 'psi': 0.36828641350963487}-{'f1_val': 0.13995598239295717, 'auprc': 0.676365486791365, 'loss_val': 1.3179441759903774, 'psi': 0.3545197841523203}
[S9] START round=2 head_norm_before_train=1.240276 (no previous merge yet)
[S9] round=2 local utility u=0.065286 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9987847838285128, 'loss_val': 1.102264262750051, 'psi': 0.48435268781540275}-{'f1_val': 0.141397957139996, 'auprc': 0.9989954200665206, 'loss_val': 1.2334682949397882, 'psi': 0.4844369423106059}
[S10] START round=2 head_norm_before_train=0.726873 cos_to_last_merge=1.0000 (last merge round=1)
[S10] round=2 local utility u=0.000329 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.566472090633531, 'loss_val': 1.3440875404956922, 'psi': 0.3097618187784468}-{'f1_val': 0.13862163754172394, 'auprc': 0.5637069291955923, 'loss_val': 1.3364501938337012, 'psi': 0.3086557542032713}
[S11] START round=2 head_norm_before_train=1.222842 (no previous merge yet)
[S11] round=2 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.8088681180489594, 'loss_val': 1.299425295091802, 'psi': 0.4077954572434501}-{'f1_val': 0.14041368337311058, 'auprc': 0.8348814240677254, 'loss_val': 1.3328135692673708, 'psi': 0.41820077965095653}
[S13] START round=2 head_norm_before_train=1.182341 (no previous merge yet)
[S13] round=2 local utility u=0.280383 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7152894300073075, 'loss_val': 1.3102912047949673, 'psi': 0.37034722954915483}-{'f1_val': 0.1403857625770531, 'auprc': 0.5398835378356567, 'loss_val': 1.3448399476479567, 'psi': 0.30018487268049454}
[S14] START round=2 head_norm_before_train=0.852679 cos_to_last_merge=1.0000 (last merge round=1)
[S14] round=2 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7111614845926968, 'loss_val': 1.3215755685749515, 'psi': 0.368679305566701}-{'f1_val': 0.14035785288270378, 'auprc': 0.7151942586887103, 'loss_val': 1.3181830561801606, 'psi': 0.3702924152051064}
[S15] START round=2 head_norm_before_train=1.217958 (no previous merge yet)
[S15] round=2 local utility u=0.034164 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7724779450784659, 'loss_val': 1.311383501685486, 'psi': 0.39283136884832137}-{'f1_val': 0.13973365136155833, 'auprc': 0.7609194656084894, 'loss_val': 1.3450366685034216, 'psi': 0.3882079770603308}
[S16] START round=2 head_norm_before_train=1.175249 (no previous merge yet)
[S16] round=2 local utility u=0.047391 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7913715326186004, 'loss_val': 1.287201456014362, 'psi': 0.40093108316696213}-{'f1_val': 0.14063745019920318, 'auprc': 0.7708679054821159, 'loss_val': 1.320472902008553, 'psi': 0.39272963231236835}
[S17] START round=2 head_norm_before_train=0.843412 cos_to_last_merge=1.0000 (last merge round=1)
[S17] round=2 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5252533406898522, 'loss_val': 1.3247736816595492, 'psi': 0.2946707142663715}-{'f1_val': 0.14094896331738438, 'auprc': 0.5325338007895177, 'loss_val': 1.3336815635482624, 'psi': 0.29758289830623774}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S7] → sending delta(kind=head bytes=1789) to S9@127.0.0.1:62410
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:62415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S2@127.0.0.1:62402
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S5] → sending delta(kind=head bytes=1791) to S14@127.0.0.1:62414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:62415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:62409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:62412
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S6] → sending delta(kind=head bytes=1791) to S3@127.0.0.1:62403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S13] → sending delta(kind=head bytes=1792) to S15@127.0.0.1:62415
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:62417
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1792 to 1 peers)
[S6] sending update (kind=head size=1791 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1791 to 1 peers)
[S8] sending update (kind=head size=1794 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1789 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1798) from S9
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.308015)
[S11] loaded HEAD from S9 (vec_in norm=1.308015)
[S11] cosine check vs S9: cos=0.0412
[S11] BUFFERED delta from S9 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1794) from S8
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.163442)
[S2] loaded HEAD from S8 (vec_in norm=1.163442)
[S2] cosine check vs S8: cos=-0.0575
[S2] DROPPED delta from S8 (cos=-0.0575 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1792) from S13
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.198673)
[S15] loaded HEAD from S13 (vec_in norm=1.198673)
[S15] cosine check vs S13: cos=0.0411
[S15] BUFFERED delta from S13 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1795) from S16
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.193952)
[S15] loaded HEAD from S16 (vec_in norm=1.193952)
[S15] cosine check vs S16: cos=0.0575
[S15] BUFFERED delta from S16 (total buffered=2)
[S15] RECEIVED delta(kind=head bytes=1797) from S10
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=0.739838)
[S15] loaded HEAD from S10 (vec_in norm=0.739838)
[S15] cosine check vs S10: cos=0.4194
[S15] BUFFERED delta from S10 (total buffered=3)
[S14] RECEIVED delta(kind=head bytes=1791) from S5
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.949176)
[S14] loaded HEAD from S5 (vec_in norm=0.949176)
[S14] cosine check vs S5: cos=-0.0517
[S14] DROPPED delta from S5 (cos=-0.0517 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1791) from S6
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.248665)
[S3] loaded HEAD from S6 (vec_in norm=1.248665)
[S3] cosine check vs S6: cos=-0.0294
[S3] DROPPED delta from S6 (cos=-0.0294 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1798) from S4
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.233039)
[S17] loaded HEAD from S4 (vec_in norm=1.233039)
[S17] cosine check vs S4: cos=0.0043
[S17] BUFFERED delta from S4 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1789) from S7
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.295488)
[S9] loaded HEAD from S7 (vec_in norm=1.295488)
[S9] cosine check vs S7: cos=-0.0493
[S9] DROPPED delta from S7 (cos=-0.0493 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1796) from S15
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.237708)
[S8] loaded HEAD from S15 (vec_in norm=1.237708)
[S8] cosine check vs S15: cos=-0.0814
[S8] DROPPED delta from S15 (cos=-0.0814 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=2 metric=0.1404 head_norm=1.243043
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.834589e-01
[S11] stored merged vector for next round verification (round=2)
[S11] DEBUG after merge:  round=2 metric=0.1404 head_norm=0.920614 delta_norm=0.883459
[S11] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=2 metric=0.1397 head_norm=1.237708
[S15] _apply_head_vector_avg (torch): Δ‖w‖=6.121846e-01
[S15] stored merged vector for next round verification (round=2)
[S15] DEBUG after merge:  round=2 metric=0.1397 head_norm=0.777083 delta_norm=0.612185
[S15] aggregate: ACCEPT kept=['S13', 'S16', 'S10'] (k=3/3) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=2 metric=0.1409 head_norm=0.864539
[S17] _apply_head_vector_avg (torch): Δ‖w‖=7.514509e-01
[S17] stored merged vector for next round verification (round=2)
[S17] DEBUG after merge:  round=2 metric=0.2545 head_norm=0.754472 delta_norm=0.751451
[S17] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=3 head_norm_before_train=1.178301 (no previous merge yet)
[S2] round=3 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6156612557999405, 'loss_val': 1.2354265673010243, 'psi': 0.33133078235311625}-{'f1_val': 0.1417771333885667, 'auprc': 0.7255842663962566, 'loss_val': 1.287693062305144, 'psi': 0.3752999865916427}
[S3] START round=3 head_norm_before_train=1.275320 (no previous merge yet)
[S3] round=3 local utility u=1.000000 metrics={'f1_val': 0.4224727193828194, 'auprc': 0.7959264753642084, 'loss_val': 0.9794118178392796, 'psi': 0.571854221775375}-{'f1_val': 0.13984006561410703, 'auprc': 0.6188020399630891, 'loss_val': 1.1863679759747612, 'psi': 0.3314248553536999}
[S4] START round=3 head_norm_before_train=1.233039 (no previous merge yet)
[S4] round=3 local utility u=0.198844 metrics={'f1_val': 0.41419477691946305, 'auprc': 0.7686816275747317, 'loss_val': 1.2312880852693673, 'psi': 0.5559895171815705}-{'f1_val': 0.3688019458798064, 'auprc': 0.7496087635217107, 'loss_val': 1.299400279188495, 'psi': 0.5211246729365682}
[S5] START round=3 head_norm_before_train=0.949176 cos_to_last_merge=0.9940 (last merge round=1)
[S5] round=3 local utility u=0.108883 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7709298535511363, 'loss_val': 1.131685448393296, 'psi': 0.3937290842775974}-{'f1_val': 0.14226190476190476, 'auprc': 0.7298325682262341, 'loss_val': 1.2261589027744495, 'psi': 0.3772901701476365}
[S6] START round=3 head_norm_before_train=1.248665 (no previous merge yet)
[S6] round=3 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.7782184297373842, 'loss_val': 1.2223260226822688, 'psi': 0.3961431411257229}-{'f1_val': 0.14142628205128205, 'auprc': 0.7968449444391683, 'loss_val': 1.276727681984809, 'psi': 0.4035937470064366}
[S7] START round=3 head_norm_before_train=1.295488 (no previous merge yet)
[S7] round=3 local utility u=0.901949 metrics={'f1_val': 0.4168747328879592, 'auprc': 0.7940514961523373, 'loss_val': 1.0440395692529836, 'psi': 0.5677454381937104}-{'f1_val': 0.14205682272909165, 'auprc': 0.7929643279043246, 'loss_val': 1.1957683179999001, 'psi': 0.40241982479918487}
[S8] START round=3 head_norm_before_train=1.163442 (no previous merge yet)
[S8] round=3 local utility u=0.176875 metrics={'f1_val': 0.17855299144104478, 'auprc': 0.7348755627884049, 'loss_val': 1.229877261421441, 'psi': 0.4010820199799889}-{'f1_val': 0.13995598239295717, 'auprc': 0.7107820601846514, 'loss_val': 1.2797639712260416, 'psi': 0.36828641350963487}
[S9] START round=3 head_norm_before_train=1.308015 (no previous merge yet)
[S9] round=3 local utility u=1.000000 metrics={'f1_val': 0.7010082482018731, 'auprc': 0.9988138774973376, 'loss_val': 0.7780975573311089, 'psi': 0.8201304999200589}-{'f1_val': 0.141397957139996, 'auprc': 0.9987847838285128, 'loss_val': 1.102264262750051, 'psi': 0.48435268781540275}
[S10] START round=3 head_norm_before_train=0.739838 cos_to_last_merge=0.9959 (last merge round=1)
[S10] round=3 local utility u=0.030797 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.5754400541321477, 'loss_val': 1.3093971254655028, 'psi': 0.31334900417789346}-{'f1_val': 0.13862163754172394, 'auprc': 0.566472090633531, 'loss_val': 1.3440875404956922, 'psi': 0.3097618187784468}
[S11] START round=3 head_norm_before_train=0.920614 cos_to_last_merge=1.0000 (last merge round=2)
[S11] round=3 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7724532517891214, 'loss_val': 1.2930122257535064, 'psi': 0.3932295107395149}-{'f1_val': 0.14041368337311058, 'auprc': 0.8088681180489594, 'loss_val': 1.299425295091802, 'psi': 0.4077954572434501}
[S13] START round=3 head_norm_before_train=1.198673 (no previous merge yet)
[S13] round=3 local utility u=0.018135 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7124855991993411, 'loss_val': 1.265609318431803, 'psi': 0.36922569722596826}-{'f1_val': 0.1403857625770531, 'auprc': 0.7152894300073075, 'loss_val': 1.3102912047949673, 'psi': 0.37034722954915483}
[S14] START round=3 head_norm_before_train=0.873152 cos_to_last_merge=0.9974 (last merge round=1)
[S14] round=3 local utility u=0.214275 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8469484262674117, 'loss_val': 1.3003863757025593, 'psi': 0.42299408223658697}-{'f1_val': 0.14035785288270378, 'auprc': 0.7111614845926968, 'loss_val': 1.3215755685749515, 'psi': 0.368679305566701}
[S15] START round=3 head_norm_before_train=0.777083 cos_to_last_merge=1.0000 (last merge round=2)
[S15] round=3 local utility u=0.000000 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.767862417804617, 'loss_val': 1.3080689486597774, 'psi': 0.3909851579387818}-{'f1_val': 0.13973365136155833, 'auprc': 0.7724779450784659, 'loss_val': 1.311383501685486, 'psi': 0.39283136884832137}
[S16] START round=3 head_norm_before_train=1.193952 (no previous merge yet)
[S16] round=3 local utility u=0.030762 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7974213713592765, 'loss_val': 1.2438263470952482, 'psi': 0.40335101866323253}-{'f1_val': 0.14063745019920318, 'auprc': 0.7913715326186004, 'loss_val': 1.287201456014362, 'psi': 0.40093108316696213}
[S17] START round=3 head_norm_before_train=0.754472 cos_to_last_merge=1.0000 (last merge round=2)
[S17] round=3 local utility u=0.201767 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.660681344828492, 'loss_val': 1.3275234552072823, 'psi': 0.3488419159218274}-{'f1_val': 0.14094896331738438, 'auprc': 0.5252533406898522, 'loss_val': 1.3247736816595492, 'psi': 0.2946707142663715}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:62405
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:62414
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:62404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:62404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:62410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S7] → sending delta(kind=head bytes=1792) to S6@127.0.0.1:62407
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:62412
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:62402
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:62410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S8] → sending delta(kind=head bytes=1791) to S6@127.0.0.1:62407
[S5] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1791 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1794 to 1 peers)
[S7] sending update (kind=head size=1792 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1794 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1792) from S7
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.341560)
[S6] loaded HEAD from S7 (vec_in norm=1.341560)
[S6] cosine check vs S7: cos=0.0403
[S6] BUFFERED delta from S7 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1794) from S4
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.267289)
[S5] loaded HEAD from S4 (vec_in norm=1.267289)
[S5] cosine check vs S4: cos=0.6657
[S5] BUFFERED delta from S4 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1797) from S3
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.328768)
[S2] loaded HEAD from S3 (vec_in norm=1.328768)
[S2] cosine check vs S3: cos=-0.0595
[S2] DROPPED delta from S3 (cos=-0.0595 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1800) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.376713)
[S14] loaded HEAD from S9 (vec_in norm=1.376713)
[S14] cosine check vs S9: cos=0.0615
[S14] BUFFERED delta from S9 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1798) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.988420)
[S9] loaded HEAD from S5 (vec_in norm=0.988420)
[S9] cosine check vs S5: cos=-0.0579
[S9] DROPPED delta from S5 (cos=-0.0579 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1794) from S13
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.222467)
[S9] loaded HEAD from S13 (vec_in norm=1.222467)
[S9] cosine check vs S13: cos=-0.0524
[S9] DROPPED delta from S13 (cos=-0.0524 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1796) from S14
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.898596)
[S11] loaded HEAD from S14 (vec_in norm=0.898596)
[S11] cosine check vs S14: cos=0.0660
[S11] BUFFERED delta from S14 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1797) from S16
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.220183)
[S4] loaded HEAD from S16 (vec_in norm=1.220183)
[S4] cosine check vs S16: cos=-0.0037
[S4] DROPPED delta from S16 (cos=-0.0037 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1800) from S10
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=0.763075)
[S4] loaded HEAD from S10 (vec_in norm=0.763075)
[S4] cosine check vs S10: cos=0.0273
[S4] BUFFERED delta from S10 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1791) from S8
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.192719)
[S6] loaded HEAD from S8 (vec_in norm=1.192719)
[S6] cosine check vs S8: cos=0.0638
[S6] BUFFERED delta from S8 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S17] → sending delta(kind=head bytes=1789) to S5@127.0.0.1:62405
[S17] sending update (kind=head size=1789 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1789) from S17
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=0.772582)
[S5] loaded HEAD from S17 (vec_in norm=0.772582)
[S5] cosine check vs S17: cos=0.5192
[S5] BUFFERED delta from S17 (total buffered=2)
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=3 metric=0.1414 head_norm=1.281069
[S6] _apply_head_vector_avg (torch): Δ‖w‖=7.490692e-01
[S6] stored merged vector for next round verification (round=3)
[S6] DEBUG after merge:  round=3 metric=0.1414 head_norm=0.802823 delta_norm=0.749069
[S6] aggregate: ACCEPT kept=['S7', 'S8'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=3 metric=0.1404 head_norm=0.946612
[S11] _apply_head_vector_avg (torch): Δ‖w‖=6.307125e-01
[S11] stored merged vector for next round verification (round=3)
[S11] DEBUG after merge:  round=3 metric=0.1404 head_norm=0.673777 delta_norm=0.630713
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=3 metric=0.4142 head_norm=1.267289
[S4] _apply_head_vector_avg (torch): Δ‖w‖=7.306793e-01
[S4] stored merged vector for next round verification (round=3)
[S4] DEBUG after merge:  round=3 metric=0.4150 head_norm=0.748505 delta_norm=0.730679
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=3 metric=0.1423 head_norm=0.988420
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.139968e-01
[S5] stored merged vector for next round verification (round=3)
[S5] DEBUG after merge:  round=3 metric=0.2257 head_norm=0.886863 delta_norm=0.413997
[S5] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=3 metric=0.1404 head_norm=0.898596
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.985394e-01
[S14] stored merged vector for next round verification (round=3)
[S14] DEBUG after merge:  round=3 metric=0.1404 head_norm=0.844833 delta_norm=0.798539
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=1.210588 (no previous merge yet)
[S2] round=4 local utility u=0.023504 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6119215718188796, 'loss_val': 1.17719886128023, 'psi': 0.3298349087606919}-{'f1_val': 0.1417771333885667, 'auprc': 0.6156612557999405, 'loss_val': 1.2354265673010243, 'psi': 0.33133078235311625}
[S3] START round=4 head_norm_before_train=1.328768 (no previous merge yet)
[S3] round=4 local utility u=0.369200 metrics={'f1_val': 0.401708470248874, 'auprc': 0.9989351355891818, 'loss_val': 0.7254520585459784, 'psi': 0.6405991363849971}-{'f1_val': 0.4224727193828194, 'auprc': 0.7959264753642084, 'loss_val': 0.9794118178392796, 'psi': 0.571854221775375}
[S4] START round=4 head_norm_before_train=0.748505 cos_to_last_merge=1.0000 (last merge round=3)
[S4] round=4 local utility u=0.000000 metrics={'f1_val': 0.1529161620931657, 'auprc': 0.7584405300255236, 'loss_val': 1.2328951886307815, 'psi': 0.3951259092661089}-{'f1_val': 0.41419477691946305, 'auprc': 0.7686816275747317, 'loss_val': 1.2312880852693673, 'psi': 0.5559895171815705}
[S5] START round=4 head_norm_before_train=0.886863 cos_to_last_merge=1.0000 (last merge round=3)
[S5] round=4 local utility u=0.871461 metrics={'f1_val': 0.4175889530834738, 'auprc': 0.7777570383891446, 'loss_val': 1.0612065780057214, 'psi': 0.5616561872057422}-{'f1_val': 0.14226190476190476, 'auprc': 0.7709298535511363, 'loss_val': 1.131685448393296, 'psi': 0.3937290842775974}
[S6] START round=4 head_norm_before_train=0.802823 cos_to_last_merge=1.0000 (last merge round=3)
[S6] round=4 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6374658253684112, 'loss_val': 1.2308361093617237, 'psi': 0.3398420993781337}-{'f1_val': 0.14142628205128205, 'auprc': 0.7782184297373842, 'loss_val': 1.2223260226822688, 'psi': 0.3961431411257229}
[S7] START round=4 head_norm_before_train=1.341560 (no previous merge yet)
[S7] round=4 local utility u=0.108160 metrics={'f1_val': 0.4172381946317165, 'auprc': 0.794543494718241, 'loss_val': 0.8313755512110395, 'psi': 0.5681603146663263}-{'f1_val': 0.4168747328879592, 'auprc': 0.7940514961523373, 'loss_val': 1.0440395692529836, 'psi': 0.5677454381937104}
[S8] START round=4 head_norm_before_train=1.192719 (no previous merge yet)
[S8] round=4 local utility u=0.590335 metrics={'f1_val': 0.4156929677121941, 'auprc': 0.6298149352003801, 'loss_val': 1.156865430824829, 'psi': 0.5013417547074686}-{'f1_val': 0.17855299144104478, 'auprc': 0.7348755627884049, 'loss_val': 1.229877261421441, 'psi': 0.4010820199799889}
[S9] START round=4 head_norm_before_train=1.376713 (no previous merge yet)
[S9] round=4 local utility u=0.178073 metrics={'f1_val': 0.7016857342464684, 'auprc': 0.9985490076594046, 'loss_val': 0.42522228475957297, 'psi': 0.8204310436116429}-{'f1_val': 0.7010082482018731, 'auprc': 0.9988138774973376, 'loss_val': 0.7780975573311089, 'psi': 0.8201304999200589}
[S10] START round=4 head_norm_before_train=0.763075 cos_to_last_merge=0.9849 (last merge round=1)
[S10] round=4 local utility u=0.109320 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6334833345608303, 'loss_val': 1.2648876844742543, 'psi': 0.33656631634936646}-{'f1_val': 0.13862163754172394, 'auprc': 0.5754400541321477, 'loss_val': 1.3093971254655028, 'psi': 0.31334900417789346}
[S11] START round=4 head_norm_before_train=0.673777 cos_to_last_merge=1.0000 (last merge round=3)
[S11] round=4 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7604448353012858, 'loss_val': 1.29208410569788, 'psi': 0.3884261441443807}-{'f1_val': 0.14041368337311058, 'auprc': 0.7724532517891214, 'loss_val': 1.2930122257535064, 'psi': 0.3932295107395149}
[S13] START round=4 head_norm_before_train=1.222467 (no previous merge yet)
[S13] round=4 local utility u=0.015149 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7082494032282434, 'loss_val': 1.2226022021761496, 'psi': 0.3675312188375292}-{'f1_val': 0.1403857625770531, 'auprc': 0.7124855991993411, 'loss_val': 1.265609318431803, 'psi': 0.36922569722596826}
[S14] START round=4 head_norm_before_train=0.844833 cos_to_last_merge=1.0000 (last merge round=3)
[S14] round=4 local utility u=0.024392 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8603493053116339, 'loss_val': 1.2918059202913397, 'psi': 0.42835443385427585}-{'f1_val': 0.14035785288270378, 'auprc': 0.8469484262674117, 'loss_val': 1.3003863757025593, 'psi': 0.42299408223658697}
[S15] START round=4 head_norm_before_train=0.803022 cos_to_last_merge=0.9963 (last merge round=2)
[S15] round=4 local utility u=0.029135 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7747113014120122, 'loss_val': 1.2703463363253726, 'psi': 0.39372471138173987}-{'f1_val': 0.13973365136155833, 'auprc': 0.767862417804617, 'loss_val': 1.3080689486597774, 'psi': 0.3909851579387818}
[S16] START round=4 head_norm_before_train=1.220183 (no previous merge yet)
[S16] round=4 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7545565988577092, 'loss_val': 1.189291713487903, 'psi': 0.3862051096626056}-{'f1_val': 0.14063745019920318, 'auprc': 0.7974213713592765, 'loss_val': 1.2438263470952482, 'psi': 0.40335101866323253}
[S17] START round=4 head_norm_before_train=0.772582 cos_to_last_merge=0.9945 (last merge round=2)
[S17] round=4 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5652911287120237, 'loss_val': 1.2564720664658673, 'psi': 0.31068582947524015}-{'f1_val': 0.14094896331738438, 'auprc': 0.660681344828492, 'loss_val': 1.3275234552072823, 'psi': 0.3488419159218274}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:62407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:62414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:62402
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:62410
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:62407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] → sending delta(kind=head bytes=1794) to S11@127.0.0.1:62412
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] → sending delta(kind=head bytes=1794) to S6@127.0.0.1:62407
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:62414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:62410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:62404
[S10] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1794 to 1 peers)
[S7] sending update (kind=head size=1794 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1794 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1798) from S8
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.227635)
[S6] loaded HEAD from S8 (vec_in norm=1.227635)
[S6] cosine check vs S8: cos=0.3944
[S6] BUFFERED delta from S8 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1798) from S3
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.407293)
[S2] loaded HEAD from S3 (vec_in norm=1.407293)
[S2] cosine check vs S3: cos=-0.0567
[S2] DROPPED delta from S3 (cos=-0.0567 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1795) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.834399)
[S14] loaded HEAD from S15 (vec_in norm=0.834399)
[S14] cosine check vs S15: cos=0.0290
[S14] BUFFERED delta from S15 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1801) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.475086)
[S14] loaded HEAD from S9 (vec_in norm=1.475086)
[S14] cosine check vs S9: cos=0.8298
[S14] BUFFERED delta from S9 (total buffered=2)
[S9] RECEIVED delta(kind=head bytes=1794) from S13
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.243840)
[S9] loaded HEAD from S13 (vec_in norm=1.243840)
[S9] cosine check vs S13: cos=-0.0510
[S9] DROPPED delta from S13 (cos=-0.0510 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1798) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.925867)
[S9] loaded HEAD from S5 (vec_in norm=0.925867)
[S9] cosine check vs S5: cos=-0.0364
[S9] DROPPED delta from S5 (cos=-0.0364 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1794) from S14
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.862960)
[S11] loaded HEAD from S14 (vec_in norm=0.862960)
[S11] cosine check vs S14: cos=0.8041
[S11] BUFFERED delta from S14 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1797) from S10
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=0.795799)
[S4] loaded HEAD from S10 (vec_in norm=0.795799)
[S4] cosine check vs S10: cos=0.4920
[S4] BUFFERED delta from S10 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1794) from S7
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.394015)
[S6] loaded HEAD from S7 (vec_in norm=1.394015)
[S6] cosine check vs S7: cos=0.4029
[S6] BUFFERED delta from S7 (total buffered=2)
[S6] RECEIVED delta(kind=head bytes=1799) from S2
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.241491)
[S6] loaded HEAD from S2 (vec_in norm=1.241491)
[S6] cosine check vs S2: cos=-0.0288
[S6] DROPPED delta from S2 (cos=-0.0288 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=4 metric=0.1414 head_norm=0.829399
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.001752e-01
[S6] stored merged vector for next round verification (round=4)
[S6] DEBUG after merge:  round=4 metric=0.1414 head_norm=0.770622 delta_norm=0.400175
[S6] aggregate: ACCEPT kept=['S8', 'S7'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=4 metric=0.1404 head_norm=0.697672
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.565397e-01
[S11] stored merged vector for next round verification (round=4)
[S11] DEBUG after merge:  round=4 metric=0.1404 head_norm=0.741559 delta_norm=0.256540
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=4 metric=0.1529 head_norm=0.782746
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.978267e-01
[S4] stored merged vector for next round verification (round=4)
[S4] DEBUG after merge:  round=4 metric=0.4148 head_norm=0.681710 delta_norm=0.397827
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=4 metric=0.1404 head_norm=0.862960
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.092286e-01
[S14] stored merged vector for next round verification (round=4)
[S14] DEBUG after merge:  round=4 metric=0.1404 head_norm=0.796390 delta_norm=0.309229
[S14] aggregate: ACCEPT kept=['S15', 'S9'] (k=2/2) mode=median trim_p=0.1
[S2] START round=5 head_norm_before_train=1.241491 (no previous merge yet)
[S2] round=5 local utility u=0.519249 metrics={'f1_val': 0.3001436163482222, 'auprc': 0.6134368223225268, 'loss_val': 1.0934453525108447, 'psi': 0.425460898737944}-{'f1_val': 0.1417771333885667, 'auprc': 0.6119215718188796, 'loss_val': 1.17719886128023, 'psi': 0.3298349087606919}
[S3] START round=5 head_norm_before_train=1.407293 (no previous merge yet)
[S3] round=5 local utility u=0.343512 metrics={'f1_val': 0.49800558185020005, 'auprc': 0.999346975954582, 'loss_val': 0.6174471526325727, 'psi': 0.6985421394919529}-{'f1_val': 0.401708470248874, 'auprc': 0.9989351355891818, 'loss_val': 0.7254520585459784, 'psi': 0.6405991363849971}
[S4] START round=5 head_norm_before_train=0.681710 cos_to_last_merge=1.0000 (last merge round=4)
[S4] round=5 local utility u=0.062838 metrics={'f1_val': 0.22381776125940017, 'auprc': 0.6517254854025984, 'loss_val': 1.2124827131219067, 'psi': 0.39498085091667945}-{'f1_val': 0.1529161620931657, 'auprc': 0.7584405300255236, 'loss_val': 1.2328951886307815, 'psi': 0.3951259092661089}
[S5] START round=5 head_norm_before_train=0.925867 cos_to_last_merge=0.9938 (last merge round=3)
[S5] round=5 local utility u=0.103749 metrics={'f1_val': 0.4183544144322735, 'auprc': 0.7777326684186419, 'loss_val': 0.8582272489698904, 'psi': 0.5621057160268208}-{'f1_val': 0.4175889530834738, 'auprc': 0.7777570383891446, 'loss_val': 1.0612065780057214, 'psi': 0.5616561872057422}
[S6] START round=5 head_norm_before_train=0.770622 cos_to_last_merge=1.0000 (last merge round=4)
[S6] round=5 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6131621859662115, 'loss_val': 1.2245070598931855, 'psi': 0.33012064361725385}-{'f1_val': 0.14142628205128205, 'auprc': 0.6374658253684112, 'loss_val': 1.2308361093617237, 'psi': 0.3398420993781337}
[S7] START round=5 head_norm_before_train=1.394015 (no previous merge yet)
[S7] round=5 local utility u=0.228245 metrics={'f1_val': 0.4831811338255666, 'auprc': 0.7852188889263871, 'loss_val': 0.7425698815053557, 'psi': 0.6039962358658948}-{'f1_val': 0.4172381946317165, 'auprc': 0.794543494718241, 'loss_val': 0.8313755512110395, 'psi': 0.5681603146663263}
[S8] START round=5 head_norm_before_train=1.227635 (no previous merge yet)
[S8] round=5 local utility u=0.042449 metrics={'f1_val': 0.41644030110281194, 'auprc': 0.6174816269512032, 'loss_val': 1.0394508837313712, 'psi': 0.4968568314421684}-{'f1_val': 0.4156929677121941, 'auprc': 0.6298149352003801, 'loss_val': 1.156865430824829, 'psi': 0.5013417547074686}
[S9] START round=5 head_norm_before_train=1.475086 (no previous merge yet)
[S9] round=5 local utility u=0.057028 metrics={'f1_val': 0.7016130641860581, 'auprc': 0.9988476330445516, 'loss_val': 0.31162615459909226, 'psi': 0.8205068917294556}-{'f1_val': 0.7016857342464684, 'auprc': 0.9985490076594046, 'loss_val': 0.42522228475957297, 'psi': 0.8204310436116429}
[S10] START round=5 head_norm_before_train=0.795799 cos_to_last_merge=0.9702 (last merge round=1)
[S10] round=5 local utility u=0.052564 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6516039539922477, 'loss_val': 1.2141215602809048, 'psi': 0.34381456412193345}-{'f1_val': 0.13862163754172394, 'auprc': 0.6334833345608303, 'loss_val': 1.2648876844742543, 'psi': 0.33656631634936646}
[S11] START round=5 head_norm_before_train=0.741559 cos_to_last_merge=1.0000 (last merge round=4)
[S11] round=5 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.6249345142457898, 'loss_val': 1.2587176348561764, 'psi': 0.3342220157221823}-{'f1_val': 0.14041368337311058, 'auprc': 0.7604448353012858, 'loss_val': 1.29208410569788, 'psi': 0.3884261441443807}
[S13] START round=5 head_norm_before_train=1.243840 (no previous merge yet)
[S13] round=5 local utility u=0.475528 metrics={'f1_val': 0.2837178133376655, 'auprc': 0.7136341055936947, 'loss_val': 1.147692921502159, 'psi': 0.45568433024007715}-{'f1_val': 0.1403857625770531, 'auprc': 0.7082494032282434, 'loss_val': 1.2226022021761496, 'psi': 0.3675312188375292}
[S14] START round=5 head_norm_before_train=0.796390 cos_to_last_merge=1.0000 (last merge round=4)
[S14] round=5 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7877904683537087, 'loss_val': 1.2823503857743221, 'psi': 0.39933089907110575}-{'f1_val': 0.14035785288270378, 'auprc': 0.8603493053116339, 'loss_val': 1.2918059202913397, 'psi': 0.42835443385427585}
[S15] START round=5 head_norm_before_train=0.834399 cos_to_last_merge=0.9879 (last merge round=2)
[S15] round=5 local utility u=0.060186 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.8000459141759075, 'loss_val': 1.2259774862549675, 'psi': 0.403858556487298}-{'f1_val': 0.13973365136155833, 'auprc': 0.7747113014120122, 'loss_val': 1.2703463363253726, 'psi': 0.39372471138173987}
[S16] START round=5 head_norm_before_train=1.254388 (no previous merge yet)
[S16] round=5 local utility u=0.740199 metrics={'f1_val': 0.41467924219943564, 'auprc': 0.6654260687315356, 'loss_val': 1.085752164512743, 'psi': 0.5149779728122756}-{'f1_val': 0.14063745019920318, 'auprc': 0.7545565988577092, 'loss_val': 1.189291713487903, 'psi': 0.3862051096626056}
[S17] START round=5 head_norm_before_train=0.801080 cos_to_last_merge=0.9790 (last merge round=2)
[S17] round=5 local utility u=0.041276 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5589988640647875, 'loss_val': 1.155043605380858, 'psi': 0.3081689236163456}-{'f1_val': 0.14094896331738438, 'auprc': 0.5652911287120237, 'loss_val': 1.2564720664658673, 'psi': 0.31068582947524015}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:62414
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:62414
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:62405
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:62410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:62407
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] → sending delta(kind=head bytes=1793) to S9@127.0.0.1:62410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:62404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:62402
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:62407
[S13] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1804 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1793 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1793) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.985318)
[S9] loaded HEAD from S5 (vec_in norm=0.985318)
[S9] cosine check vs S5: cos=-0.0304
[S9] DROPPED delta from S5 (cos=-0.0304 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1801) from S8
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.265875)
[S6] loaded HEAD from S8 (vec_in norm=1.265875)
[S6] cosine check vs S8: cos=0.5767
[S6] BUFFERED delta from S8 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1798) from S13
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.270167)
[S9] loaded HEAD from S13 (vec_in norm=1.270167)
[S9] cosine check vs S13: cos=-0.0508
[S9] DROPPED delta from S13 (cos=-0.0508 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1802) from S7
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.453128)
[S6] loaded HEAD from S7 (vec_in norm=1.453128)
[S6] cosine check vs S7: cos=0.6157
[S6] BUFFERED delta from S7 (total buffered=2)
[S2] RECEIVED delta(kind=head bytes=1802) from S3
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.467088)
[S2] loaded HEAD from S3 (vec_in norm=1.467088)
[S2] cosine check vs S3: cos=-0.0526
[S2] DROPPED delta from S3 (cos=-0.0526 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1800) from S4
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.707576)
[S5] loaded HEAD from S4 (vec_in norm=0.707576)
[S5] cosine check vs S4: cos=0.4429
[S5] BUFFERED delta from S4 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1804) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.567632)
[S14] loaded HEAD from S9 (vec_in norm=1.567632)
[S14] cosine check vs S9: cos=0.8918
[S14] BUFFERED delta from S9 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1800) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.868435)
[S14] loaded HEAD from S15 (vec_in norm=0.868435)
[S14] cosine check vs S15: cos=0.2604
[S14] BUFFERED delta from S15 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:62405
[S17] sending update (kind=head size=1799 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1799) from S17
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=0.836685)
[S5] loaded HEAD from S17 (vec_in norm=0.836685)
[S5] cosine check vs S17: cos=0.6774
[S5] BUFFERED delta from S17 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:62404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:62407
[S2] sending update (kind=head size=1795 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1795) from S2
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.272140)
[S6] loaded HEAD from S2 (vec_in norm=1.272140)
[S6] cosine check vs S2: cos=-0.0404
[S6] DROPPED delta from S2 (cos=-0.0404 < 0.0)
[S10] sending update (kind=head size=1798 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1798) from S10
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=0.838712)
[S4] loaded HEAD from S10 (vec_in norm=0.838712)
[S4] cosine check vs S10: cos=0.8181
[S4] BUFFERED delta from S10 (total buffered=1)
[S16] sending update (kind=head size=1803 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1803) from S16
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.290560)
[S4] loaded HEAD from S16 (vec_in norm=1.290560)
[S4] cosine check vs S16: cos=-0.0171
[S4] DROPPED delta from S16 (cos=-0.0171 < 0.0)
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=5 metric=0.4184 head_norm=0.985318
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.647820e-01
[S5] stored merged vector for next round verification (round=5)
[S5] DEBUG after merge:  round=5 metric=0.7153 head_norm=0.752768 delta_norm=0.364782
[S5] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.506 → S9@127.0.0.1:62410
[S2] ⇄ pheromone p=0.483 → S6@127.0.0.1:62407
[S8] ⇄ pheromone p=0.461 → S6@127.0.0.1:62407
[S9] ⇄ pheromone p=0.515 → S14@127.0.0.1:62414
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=5 metric=0.2238 head_norm=0.707576
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.414020e-01
[S4] stored merged vector for next round verification (round=5)
[S4] DEBUG after merge:  round=5 metric=0.4150 head_norm=0.737412 delta_norm=0.241402
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.466 → S5@127.0.0.1:62405
[S3] ⇄ pheromone p=0.604 → S2@127.0.0.1:62402
[S7] ⇄ pheromone p=0.509 → S6@127.0.0.1:62407
[S11] ⇄ pheromone p=0.328 → S9@127.0.0.1:62410
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=5 metric=0.1404 head_norm=0.813357
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.844242e-01
[S14] stored merged vector for next round verification (round=5)
[S14] DEBUG after merge:  round=5 metric=0.1404 head_norm=0.833381 delta_norm=0.184424
[S14] aggregate: ACCEPT kept=['S9', 'S15'] (k=2/2) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.362 → S11@127.0.0.1:62412
[S16] ⇄ pheromone p=0.511 → S4@127.0.0.1:62404
[S10] ⇄ pheromone p=0.360 → S4@127.0.0.1:62404
[S13] ⇄ pheromone p=0.483 → S9@127.0.0.1:62410
[S15] ⇄ pheromone p=0.368 → S14@127.0.0.1:62414
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=5 metric=0.1414 head_norm=0.790502
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.319062e-01
[S6] stored merged vector for next round verification (round=5)
[S6] DEBUG after merge:  round=5 metric=0.1414 head_norm=0.834236 delta_norm=0.231906
[S6] aggregate: ACCEPT kept=['S8', 'S7'] (k=2/2) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.345 → S15@127.0.0.1:62415
[S17] ⇄ pheromone p=0.362 → S5@127.0.0.1:62405
[S2] START round=6 head_norm_before_train=1.272140 (no previous merge yet)
[S2] round=6 local utility u=0.634431 metrics={'f1_val': 0.41659963704455116, 'auprc': 0.7680210073189334, 'loss_val': 0.9870718999341194, 'psi': 0.5571681851543041}-{'f1_val': 0.3001436163482222, 'auprc': 0.6134368223225268, 'loss_val': 1.0934453525108447, 'psi': 0.425460898737944}
[S3] START round=6 head_norm_before_train=1.467088 (no previous merge yet)
[S3] round=6 local utility u=0.625566 metrics={'f1_val': 0.6855579792933708, 'auprc': 0.9992285995472473, 'loss_val': 0.4912738111010463, 'psi': 0.8110262273949214}-{'f1_val': 0.49800558185020005, 'auprc': 0.999346975954582, 'loss_val': 0.6174471526325727, 'psi': 0.6985421394919529}
[S4] START round=6 head_norm_before_train=0.737412 cos_to_last_merge=1.0000 (last merge round=5)
[S4] round=6 local utility u=0.618861 metrics={'f1_val': 0.41550149173126444, 'auprc': 0.6538412672290799, 'loss_val': 1.1312098898354734, 'psi': 0.5108374019303906}-{'f1_val': 0.22381776125940017, 'auprc': 0.6517254854025984, 'loss_val': 1.2124827131219067, 'psi': 0.39498085091667945}
[S5] START round=6 head_norm_before_train=0.752768 cos_to_last_merge=1.0000 (last merge round=5)
[S5] round=6 local utility u=0.961755 metrics={'f1_val': 0.7116527740541855, 'auprc': 0.7962747541496038, 'loss_val': 0.7501336795902479, 'psi': 0.7455015660923529}-{'f1_val': 0.4183544144322735, 'auprc': 0.7777326684186419, 'loss_val': 0.8582272489698904, 'psi': 0.5621057160268208}
[S6] START round=6 head_norm_before_train=0.834236 cos_to_last_merge=1.0000 (last merge round=5)
[S6] round=6 local utility u=0.014782 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6132012496225201, 'loss_val': 1.1950595966196589, 'psi': 0.3301362690797773}-{'f1_val': 0.14142628205128205, 'auprc': 0.6131621859662115, 'loss_val': 1.2245070598931855, 'psi': 0.33012064361725385}
[S7] START round=6 head_norm_before_train=1.453128 (no previous merge yet)
[S7] round=6 local utility u=0.354874 metrics={'f1_val': 0.5939899842013021, 'auprc': 0.7833057375354417, 'loss_val': 0.6919350979395439, 'psi': 0.669716285534958}-{'f1_val': 0.4831811338255666, 'auprc': 0.7852188889263871, 'loss_val': 0.7425698815053557, 'psi': 0.6039962358658948}
[S8] START round=6 head_norm_before_train=1.265875 (no previous merge yet)
[S8] round=6 local utility u=0.000000 metrics={'f1_val': 0.3730222287692313, 'auprc': 0.5727091159230133, 'loss_val': 0.9281490698458777, 'psi': 0.4528969836307441}-{'f1_val': 0.41644030110281194, 'auprc': 0.6174816269512032, 'loss_val': 1.0394508837313712, 'psi': 0.4968568314421684}
[S9] START round=6 head_norm_before_train=1.567632 (no previous merge yet)
[S9] round=6 local utility u=0.017815 metrics={'f1_val': 0.7015406642019387, 'auprc': 0.9988483131002007, 'loss_val': 0.27556297834427745, 'psi': 0.8204637237612435}-{'f1_val': 0.7016130641860581, 'auprc': 0.9988476330445516, 'loss_val': 0.31162615459909226, 'psi': 0.8205068917294556}
[S10] START round=6 head_norm_before_train=0.838712 cos_to_last_merge=0.9531 (last merge round=1)
[S10] round=6 local utility u=0.042409 metrics={'f1_val': 0.1416084887731905, 'auprc': 0.6452921793882166, 'loss_val': 1.1282886163105226, 'psi': 0.3430819650192009}-{'f1_val': 0.13862163754172394, 'auprc': 0.6516039539922477, 'loss_val': 1.2141215602809048, 'psi': 0.34381456412193345}
[S11] START round=6 head_norm_before_train=0.763871 cos_to_last_merge=0.9940 (last merge round=4)
[S11] round=6 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.5874478702739582, 'loss_val': 1.2254023369920117, 'psi': 0.3192273581334496}-{'f1_val': 0.14041368337311058, 'auprc': 0.6249345142457898, 'loss_val': 1.2587176348561764, 'psi': 0.3342220157221823}
[S13] START round=6 head_norm_before_train=1.270167 (no previous merge yet)
[S13] round=6 local utility u=0.494433 metrics={'f1_val': 0.4162370592043806, 'auprc': 0.7320797185904014, 'loss_val': 1.0092784572336475, 'psi': 0.5425741229587889}-{'f1_val': 0.2837178133376655, 'auprc': 0.7136341055936947, 'loss_val': 1.147692921502159, 'psi': 0.45568433024007715}
[S14] START round=6 head_norm_before_train=0.833381 cos_to_last_merge=1.0000 (last merge round=5)
[S14] round=6 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7224862030365745, 'loss_val': 1.2486071187343695, 'psi': 0.3732091929442521}-{'f1_val': 0.14035785288270378, 'auprc': 0.7877904683537087, 'loss_val': 1.2823503857743221, 'psi': 0.39933089907110575}
[S15] START round=6 head_norm_before_train=0.868435 cos_to_last_merge=0.9767 (last merge round=2)
[S15] round=6 local utility u=0.034617 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.8001403047074321, 'loss_val': 1.157027367781087, 'psi': 0.4038963126999079}-{'f1_val': 0.13973365136155833, 'auprc': 0.8000459141759075, 'loss_val': 1.2259774862549675, 'psi': 0.403858556487298}
[S16] START round=6 head_norm_before_train=1.290560 (no previous merge yet)
[S16] round=6 local utility u=0.000000 metrics={'f1_val': 0.4169255670501281, 'auprc': 0.5208128128512388, 'loss_val': 0.9551561201396952, 'psi': 0.4584804653705724}-{'f1_val': 0.41467924219943564, 'auprc': 0.6654260687315356, 'loss_val': 1.085752164512743, 'psi': 0.5149779728122756}
[S17] START round=6 head_norm_before_train=0.836685 cos_to_last_merge=0.9589 (last merge round=2)
[S17] round=6 local utility u=0.520055 metrics={'f1_val': 0.27829313543599254, 'auprc': 0.5860825688707022, 'loss_val': 1.0202489492535267, 'psi': 0.4014089088098764}-{'f1_val': 0.14094896331738438, 'auprc': 0.5589988640647875, 'loss_val': 1.155043605380858, 'psi': 0.3081689236163456}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:62414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:62402
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:62407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] → sending delta(kind=head bytes=1793) to S4@127.0.0.1:62404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:62415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:62405
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:62407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] → sending delta(kind=head bytes=1793) to S9@127.0.0.1:62410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:62414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:62410
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1793 to 1 peers)
[S2] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1793 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1794 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1802) from S3
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.523165)
[S2] loaded HEAD from S3 (vec_in norm=1.523165)
[S2] cosine check vs S3: cos=-0.0514
[S2] DROPPED delta from S3 (cos=-0.0514 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1795) from S6
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.853481)
[S15] loaded HEAD from S6 (vec_in norm=0.853481)
[S15] cosine check vs S6: cos=-0.0588
[S15] DROPPED delta from S6 (cos=-0.0588 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1799) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.630046)
[S14] loaded HEAD from S9 (vec_in norm=1.630046)
[S14] cosine check vs S9: cos=0.8904
[S14] BUFFERED delta from S9 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1794) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.907558)
[S14] loaded HEAD from S15 (vec_in norm=0.907558)
[S14] cosine check vs S15: cos=0.3656
[S14] BUFFERED delta from S15 (total buffered=2)
[S9] RECEIVED delta(kind=head bytes=1793) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.824444)
[S9] loaded HEAD from S5 (vec_in norm=0.824444)
[S9] cosine check vs S5: cos=0.0029
[S9] BUFFERED delta from S5 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1793) from S10
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=0.876948)
[S4] loaded HEAD from S10 (vec_in norm=0.876948)
[S4] cosine check vs S10: cos=0.9237
[S4] BUFFERED delta from S10 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1799) from S4
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.760548)
[S5] loaded HEAD from S4 (vec_in norm=0.760548)
[S5] cosine check vs S4: cos=0.4437
[S5] BUFFERED delta from S4 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1796) from S2
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.302637)
[S6] loaded HEAD from S2 (vec_in norm=1.302637)
[S6] cosine check vs S2: cos=-0.0393
[S6] DROPPED delta from S2 (cos=-0.0393 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1803) from S7
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.504487)
[S6] loaded HEAD from S7 (vec_in norm=1.504487)
[S6] cosine check vs S7: cos=0.6763
[S6] BUFFERED delta from S7 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1799) from S13
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.304528)
[S9] loaded HEAD from S13 (vec_in norm=1.304528)
[S9] cosine check vs S13: cos=-0.0543
[S9] DROPPED delta from S13 (cos=-0.0543 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:62405
[S17] sending update (kind=head size=1797 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1797) from S17
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=0.884253)
[S5] loaded HEAD from S17 (vec_in norm=0.884253)
[S5] cosine check vs S17: cos=0.7458
[S5] BUFFERED delta from S17 (total buffered=2)
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=6 metric=0.1404 head_norm=0.850133
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.274957e-01
[S14] stored merged vector for next round verification (round=6)
[S14] DEBUG after merge:  round=6 metric=0.1404 head_norm=0.879914 delta_norm=0.127496
[S14] aggregate: ACCEPT kept=['S9', 'S15'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=6 metric=0.7117 head_norm=0.824444
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.676541e-01
[S5] stored merged vector for next round verification (round=6)
[S5] DEBUG after merge:  round=6 metric=0.7011 head_norm=0.694693 delta_norm=0.267654
[S5] aggregate: ROLLBACK (f1_val pre=0.712 post=0.701 tol_abs=0.005 tol_rel=0.0)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=6 metric=0.1414 head_norm=0.853481
[S6] _apply_head_vector_avg (torch): Δ‖w‖=5.601605e-01
[S6] stored merged vector for next round verification (round=6)
[S6] DEBUG after merge:  round=6 metric=0.1414 head_norm=1.087279 delta_norm=0.560160
[S6] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=6 metric=0.7015 head_norm=1.630046
[S9] _apply_head_vector_avg (torch): Δ‖w‖=9.122564e-01
[S9] stored merged vector for next round verification (round=6)
[S9] DEBUG after merge:  round=6 metric=0.7015 head_norm=0.914422 delta_norm=0.912256
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=6 metric=0.4155 head_norm=0.760548
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.698435e-01
[S4] stored merged vector for next round verification (round=6)
[S4] DEBUG after merge:  round=6 metric=0.4128 head_norm=0.803050 delta_norm=0.169843
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=7 head_norm_before_train=1.302637 (no previous merge yet)
[S2] round=7 local utility u=0.722928 metrics={'f1_val': 0.6279215215934941, 'auprc': 0.7749301342644821, 'loss_val': 0.8298747181259782, 'psi': 0.6867249666618893}-{'f1_val': 0.41659963704455116, 'auprc': 0.7680210073189334, 'loss_val': 0.9870718999341194, 'psi': 0.5571681851543041}
[S3] START round=7 head_norm_before_train=1.523165 (no previous merge yet)
[S3] round=7 local utility u=0.000000 metrics={'f1_val': 0.5406187659547123, 'auprc': 0.9999950862562341, 'loss_val': 0.568655786644556, 'psi': 0.724369294075321}-{'f1_val': 0.6855579792933708, 'auprc': 0.9992285995472473, 'loss_val': 0.4912738111010463, 'psi': 0.8110262273949214}
[S4] START round=7 head_norm_before_train=0.803050 cos_to_last_merge=1.0000 (last merge round=6)
[S4] round=7 local utility u=0.000000 metrics={'f1_val': 0.36881449807412864, 'auprc': 0.6592255478147758, 'loss_val': 1.031084511337528, 'psi': 0.4849789179703875}-{'f1_val': 0.41550149173126444, 'auprc': 0.6538412672290799, 'loss_val': 1.1312098898354734, 'psi': 0.5108374019303906}
[S5] START round=7 head_norm_before_train=0.694693 cos_to_last_merge=1.0000 (last merge round=6)
[S5] round=7 local utility u=0.033015 metrics={'f1_val': 0.7142032229273318, 'auprc': 0.7992438612902741, 'loss_val': 0.7083130869078177, 'psi': 0.7482194782725087}-{'f1_val': 0.7116527740541855, 'auprc': 0.7962747541496038, 'loss_val': 0.7501336795902479, 'psi': 0.7455015660923529}
[S6] START round=7 head_norm_before_train=1.087279 cos_to_last_merge=1.0000 (last merge round=6)
[S6] round=7 local utility u=0.872054 metrics={'f1_val': 0.41584976944180807, 'auprc': 0.6131494856275936, 'loss_val': 1.0973366748158373, 'psi': 0.4947696559161223}-{'f1_val': 0.14142628205128205, 'auprc': 0.6132012496225201, 'loss_val': 1.1950595966196589, 'psi': 0.3301362690797773}
[S7] START round=7 head_norm_before_train=1.504487 (no previous merge yet)
[S7] round=7 local utility u=0.000000 metrics={'f1_val': 0.38326696183573505, 'auprc': 0.7721098255443023, 'loss_val': 1.1007908857481798, 'psi': 0.538804107319162}-{'f1_val': 0.5939899842013021, 'auprc': 0.7833057375354417, 'loss_val': 0.6919350979395439, 'psi': 0.669716285534958}
[S8] START round=7 head_norm_before_train=1.305658 (no previous merge yet)
[S8] round=7 local utility u=0.513644 metrics={'f1_val': 0.4158203383005801, 'auprc': 0.7831758293894978, 'loss_val': 0.7890499609692135, 'psi': 0.5627625347361471}-{'f1_val': 0.3730222287692313, 'auprc': 0.5727091159230133, 'loss_val': 0.9281490698458777, 'psi': 0.4528969836307441}
[S9] START round=7 head_norm_before_train=0.914422 cos_to_last_merge=1.0000 (last merge round=6)
[S9] round=7 local utility u=0.000000 metrics={'f1_val': 0.7013629453504064, 'auprc': 0.9988099100543865, 'loss_val': 0.3595044500314895, 'psi': 0.8203417312319985}-{'f1_val': 0.7015406642019387, 'auprc': 0.9988483131002007, 'loss_val': 0.27556297834427745, 'psi': 0.8204637237612435}
[S10] START round=7 head_norm_before_train=0.876948 cos_to_last_merge=0.9420 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.942
[S10] round=7 local utility u=0.833961 metrics={'f1_val': 0.3903356536394169, 'auprc': 0.6628022632111268, 'loss_val': 1.005259322996855, 'psi': 0.49932229746810086}-{'f1_val': 0.1416084887731905, 'auprc': 0.6452921793882166, 'loss_val': 1.1282886163105226, 'psi': 0.3430819650192009}
[S11] START round=7 head_norm_before_train=0.797717 cos_to_last_merge=0.9794 (last merge round=4)
[S11] round=7 local utility u=0.067224 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.6063279573032755, 'loss_val': 1.1475950616490915, 'psi': 0.32677939294517655}-{'f1_val': 0.14041368337311058, 'auprc': 0.5874478702739582, 'loss_val': 1.2254023369920117, 'psi': 0.3192273581334496}
[S13] START round=7 head_norm_before_train=1.304528 (no previous merge yet)
[S13] round=7 local utility u=0.000000 metrics={'f1_val': 0.37189073220722907, 'auprc': 0.7485539486338522, 'loss_val': 0.9053639091312, 'psi': 0.5225560187778783}-{'f1_val': 0.4162370592043806, 'auprc': 0.7320797185904014, 'loss_val': 1.0092784572336475, 'psi': 0.5425741229587889}
[S14] START round=7 head_norm_before_train=0.879914 cos_to_last_merge=1.0000 (last merge round=6)
[S14] round=7 local utility u=0.035898 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7252810052747071, 'loss_val': 1.1851957451876447, 'psi': 0.37432711383950507}-{'f1_val': 0.14035785288270378, 'auprc': 0.7224862030365745, 'loss_val': 1.2486071187343695, 'psi': 0.3732091929442521}
[S15] START round=7 head_norm_before_train=0.907558 cos_to_last_merge=0.9640 (last merge round=2)
[S15] round=7 local utility u=0.839515 metrics={'f1_val': 0.416567672447929, 'auprc': 0.765501663837906, 'loss_val': 1.0350858678987838, 'psi': 0.5561412690039198}-{'f1_val': 0.13973365136155833, 'auprc': 0.8001403047074321, 'loss_val': 1.157027367781087, 'psi': 0.4038963126999079}
[S16] START round=7 head_norm_before_train=1.320381 (no previous merge yet)
[S16] round=7 local utility u=0.341778 metrics={'f1_val': 0.41598539315257577, 'auprc': 0.7096328758657442, 'loss_val': 0.8324189795261326, 'psi': 0.5334443862378432}-{'f1_val': 0.4169255670501281, 'auprc': 0.5208128128512388, 'loss_val': 0.9551561201396952, 'psi': 0.4584804653705724}
[S17] START round=7 head_norm_before_train=0.884253 cos_to_last_merge=0.9320 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.932
[S17] round=7 local utility u=0.402231 metrics={'f1_val': 0.3893958890971667, 'auprc': 0.6300415961531939, 'loss_val': 1.0142805602206943, 'psi': 0.4856541719195776}-{'f1_val': 0.27829313543599254, 'auprc': 0.5860825688707022, 'loss_val': 1.0202489492535267, 'psi': 0.4014089088098764}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S14] → sending delta(kind=head bytes=1789) to S11@127.0.0.1:62412
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S10] → sending delta(kind=head bytes=1792) to S4@127.0.0.1:62404
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:62407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] → sending delta(kind=head bytes=1805) to S6@127.0.0.1:62407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S5] → sending delta(kind=head bytes=1791) to S9@127.0.0.1:62410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] → sending delta(kind=head bytes=1804) to S4@127.0.0.1:62404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:62414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] → sending delta(kind=head bytes=1793) to S15@127.0.0.1:62415
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] → sending delta(kind=head bytes=1793) to S9@127.0.0.1:62410
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1793 to 1 peers)
[S6] sending update (kind=head size=1793 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1804 to 1 peers)
[S5] sending update (kind=head size=1791 to 1 peers)
[S8] sending update (kind=head size=1805 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1792 to 1 peers)
[S14] sending update (kind=head size=1789 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1792) from S10
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=0.920807)
[S4] loaded HEAD from S10 (vec_in norm=0.920807)
[S4] cosine check vs S10: cos=0.9535
[S4] BUFFERED delta from S10 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1793) from S11
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=0.826420)
[S9] loaded HEAD from S11 (vec_in norm=0.826420)
[S9] cosine check vs S11: cos=0.6090
[S9] BUFFERED delta from S11 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1793) from S6
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.100529)
[S15] loaded HEAD from S6 (vec_in norm=1.100529)
[S15] cosine check vs S6: cos=0.0016
[S15] BUFFERED delta from S6 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1798) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.950563)
[S14] loaded HEAD from S15 (vec_in norm=0.950563)
[S14] cosine check vs S15: cos=0.4135
[S14] BUFFERED delta from S15 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1791) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.765839)
[S9] loaded HEAD from S5 (vec_in norm=0.765839)
[S9] cosine check vs S5: cos=0.4278
[S9] BUFFERED delta from S5 (total buffered=2)
[S11] RECEIVED delta(kind=head bytes=1789) from S14
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.898361)
[S11] loaded HEAD from S14 (vec_in norm=0.898361)
[S11] cosine check vs S14: cos=0.6722
[S11] BUFFERED delta from S14 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1798) from S2
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.341025)
[S6] loaded HEAD from S2 (vec_in norm=1.341025)
[S6] cosine check vs S2: cos=-0.0060
[S6] DROPPED delta from S2 (cos=-0.0060 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1805) from S8
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.343000)
[S6] loaded HEAD from S8 (vec_in norm=1.343000)
[S6] cosine check vs S8: cos=0.1956
[S6] BUFFERED delta from S8 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1804) from S16
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.350252)
[S4] loaded HEAD from S16 (vec_in norm=1.350252)
[S4] cosine check vs S16: cos=-0.0155
[S4] DROPPED delta from S16 (cos=-0.0155 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S17] → sending delta(kind=head bytes=1789) to S5@127.0.0.1:62405
[S17] sending update (kind=head size=1789 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1789) from S17
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=0.938155)
[S5] loaded HEAD from S17 (vec_in norm=0.938155)
[S5] cosine check vs S17: cos=0.7628
[S5] BUFFERED delta from S17 (total buffered=1)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=7 metric=0.3688 head_norm=0.827746
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.409929e-01
[S4] stored merged vector for next round verification (round=7)
[S4] DEBUG after merge:  round=7 metric=0.3688 head_norm=0.864086 delta_norm=0.140993
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=7 metric=0.7014 head_norm=1.009781
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.596639e-01
[S9] stored merged vector for next round verification (round=7)
[S9] DEBUG after merge:  round=7 metric=0.7014 head_norm=0.740853 delta_norm=0.359664
[S9] aggregate: ACCEPT kept=['S11', 'S5'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=7 metric=0.1404 head_norm=0.898361
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.010983e-01
[S14] stored merged vector for next round verification (round=7)
[S14] DEBUG after merge:  round=7 metric=0.1404 head_norm=0.777311 delta_norm=0.501098
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=7 metric=0.4158 head_norm=1.100529
[S6] _apply_head_vector_avg (torch): Δ‖w‖=7.805063e-01
[S6] stored merged vector for next round verification (round=7)
[S6] DEBUG after merge:  round=7 metric=0.4152 head_norm=0.947743 delta_norm=0.780506
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=7 metric=0.4166 head_norm=0.950563
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.265227e-01
[S15] stored merged vector for next round verification (round=7)
[S15] DEBUG after merge:  round=7 metric=0.4179 head_norm=0.727689 delta_norm=0.726523
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=7 metric=0.1404 head_norm=0.826420
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.506667e-01
[S11] stored merged vector for next round verification (round=7)
[S11] DEBUG after merge:  round=7 metric=0.1404 head_norm=0.788698 delta_norm=0.350667
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=7 metric=0.7142 head_norm=0.765839
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.043813e-01
[S5] stored merged vector for next round verification (round=7)
[S5] DEBUG after merge:  round=7 metric=0.7006 head_norm=0.800421 delta_norm=0.304381
[S5] aggregate: ROLLBACK (f1_val pre=0.714 post=0.701 tol_abs=0.005 tol_rel=0.0)
[S2] START round=8 head_norm_before_train=1.341025 (no previous merge yet)
[S2] round=8 local utility u=0.224926 metrics={'f1_val': 0.7010299569678582, 'auprc': 0.7268564482206121, 'loss_val': 0.6744527839595015, 'psi': 0.7113605534689598}-{'f1_val': 0.6279215215934941, 'auprc': 0.7749301342644821, 'loss_val': 0.8298747181259782, 'psi': 0.6867249666618893}
[S3] START round=8 head_norm_before_train=1.581656 (no previous merge yet)
[S3] round=8 local utility u=0.383612 metrics={'f1_val': 0.6426039769369589, 'auprc': 0.9999934473654202, 'loss_val': 0.41333773615240926, 'psi': 0.7855597651083435}-{'f1_val': 0.5406187659547123, 'auprc': 0.9999950862562341, 'loss_val': 0.568655786644556, 'psi': 0.724369294075321}
[S4] START round=8 head_norm_before_train=0.864086 cos_to_last_merge=1.0000 (last merge round=7)
[S4] round=8 local utility u=0.043616 metrics={'f1_val': 0.36881449807412864, 'auprc': 0.6595764121113024, 'loss_val': 0.9449048871151411, 'psi': 0.48511926368899816}-{'f1_val': 0.36881449807412864, 'auprc': 0.6592255478147758, 'loss_val': 1.031084511337528, 'psi': 0.4849789179703875}
[S5] START round=8 head_norm_before_train=0.800421 cos_to_last_merge=1.0000 (last merge round=7)
[S5] round=8 local utility u=0.290971 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9976281642086344, 'loss_val': 0.6382290142673294, 'psi': 0.8192436247782692}-{'f1_val': 0.7142032229273318, 'auprc': 0.7992438612902741, 'loss_val': 0.7083130869078177, 'psi': 0.7482194782725087}
[S6] START round=8 head_norm_before_train=0.947743 cos_to_last_merge=1.0000 (last merge round=7)
[S6] round=8 local utility u=0.287002 metrics={'f1_val': 0.4168551858772006, 'auprc': 0.7759859726949483, 'loss_val': 1.0178746760153443, 'psi': 0.5605075006042997}-{'f1_val': 0.41584976944180807, 'auprc': 0.6131494856275936, 'loss_val': 1.0973366748158373, 'psi': 0.4947696559161223}
[S7] START round=8 head_norm_before_train=1.544310 (no previous merge yet)
[S7] round=8 local utility u=0.851409 metrics={'f1_val': 0.5901226132251938, 'auprc': 0.7844668248415414, 'loss_val': 0.6761775628533351, 'psi': 0.6678602978717328}-{'f1_val': 0.38326696183573505, 'auprc': 0.7721098255443023, 'loss_val': 1.1007908857481798, 'psi': 0.538804107319162}
[S8] START round=8 head_norm_before_train=1.343000 (no previous merge yet)
[S8] round=8 local utility u=0.555439 metrics={'f1_val': 0.5920309385138216, 'auprc': 0.7969931249789711, 'loss_val': 0.7768867039251955, 'psi': 0.6740158130998815}-{'f1_val': 0.4158203383005801, 'auprc': 0.7831758293894978, 'loss_val': 0.7890499609692135, 'psi': 0.5627625347361471}
[S9] START round=8 head_norm_before_train=0.740853 cos_to_last_merge=1.0000 (last merge round=7)
[S9] round=8 local utility u=0.000000 metrics={'f1_val': 0.7013613595118124, 'auprc': 0.9982679092292445, 'loss_val': 0.3787567271046188, 'psi': 0.8201239793987853}-{'f1_val': 0.7013629453504064, 'auprc': 0.9988099100543865, 'loss_val': 0.3595044500314895, 'psi': 0.8203417312319985}
[S10] START round=8 head_norm_before_train=0.920807 cos_to_last_merge=0.9302 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.930
[S10] round=8 local utility u=0.481846 metrics={'f1_val': 0.43190299859471837, 'auprc': 0.8394727931682521, 'loss_val': 0.8209823309693878, 'psi': 0.5949309164241319}-{'f1_val': 0.3903356536394169, 'auprc': 0.6628022632111268, 'loss_val': 1.005259322996855, 'psi': 0.49932229746810086}
[S11] START round=8 head_norm_before_train=0.788698 cos_to_last_merge=1.0000 (last merge round=7)
[S11] round=8 local utility u=0.368376 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.8516210386312225, 'loss_val': 1.1467215739154106, 'psi': 0.42489662547635537}-{'f1_val': 0.14041368337311058, 'auprc': 0.6063279573032755, 'loss_val': 1.1475950616490915, 'psi': 0.32677939294517655}
[S13] START round=8 head_norm_before_train=1.349330 (no previous merge yet)
[S13] round=8 local utility u=0.094023 metrics={'f1_val': 0.37616343030229826, 'auprc': 0.7637714971011836, 'loss_val': 0.788607454392023, 'psi': 0.5312066570218524}-{'f1_val': 0.37189073220722907, 'auprc': 0.7485539486338522, 'loss_val': 0.9053639091312, 'psi': 0.5225560187778783}
[S14] START round=8 head_norm_before_train=0.777311 cos_to_last_merge=1.0000 (last merge round=7)
[S14] round=8 local utility u=0.198192 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8480576072749504, 'loss_val': 1.157141060333527, 'psi': 0.4234377546396024}-{'f1_val': 0.14035785288270378, 'auprc': 0.7252810052747071, 'loss_val': 1.1851957451876447, 'psi': 0.37432711383950507}
[S15] START round=8 head_norm_before_train=0.727689 cos_to_last_merge=1.0000 (last merge round=7)
[S15] round=8 local utility u=0.066881 metrics={'f1_val': 0.4169508412658852, 'auprc': 0.8000246658252778, 'loss_val': 1.0071928556095038, 'psi': 0.5701803710896423}-{'f1_val': 0.416567672447929, 'auprc': 0.765501663837906, 'loss_val': 1.0350858678987838, 'psi': 0.5561412690039198}
[S16] START round=8 head_norm_before_train=1.350252 (no previous merge yet)
[S16] round=8 local utility u=0.000000 metrics={'f1_val': 0.38322437856707603, 'auprc': 0.7416026895792964, 'loss_val': 0.7966158378474266, 'psi': 0.5265757029719642}-{'f1_val': 0.41598539315257577, 'auprc': 0.7096328758657442, 'loss_val': 0.8324189795261326, 'psi': 0.5334443862378432}
[S17] START round=8 head_norm_before_train=0.938155 cos_to_last_merge=0.9033 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.903
[S17] round=8 local utility u=0.287122 metrics={'f1_val': 0.3759161708158133, 'auprc': 0.8091568170188733, 'loss_val': 0.8965042296557608, 'psi': 0.5492124292970373}-{'f1_val': 0.3893958890971667, 'auprc': 0.6300415961531939, 'loss_val': 1.0142805602206943, 'psi': 0.4856541719195776}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:62410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:62410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:62412
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:62407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S2@127.0.0.1:62402
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:62410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:62414
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:62407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:62415
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:62405
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:62407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S10] → sending delta(kind=head bytes=1790) to S4@127.0.0.1:62404
[S8] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1790 to 1 peers)
[S4] sending update (kind=head size=1794 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1799) from S14
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.800539)
[S11] loaded HEAD from S14 (vec_in norm=0.800539)
[S11] cosine check vs S14: cos=0.6636
[S11] BUFFERED delta from S14 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1802) from S8
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.377244)
[S6] loaded HEAD from S8 (vec_in norm=1.377244)
[S6] cosine check vs S8: cos=0.8088
[S6] BUFFERED delta from S8 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1797) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.866680)
[S9] loaded HEAD from S5 (vec_in norm=0.866680)
[S9] cosine check vs S5: cos=0.4550
[S9] BUFFERED delta from S5 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1794) from S4
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.891739)
[S5] loaded HEAD from S4 (vec_in norm=0.891739)
[S5] cosine check vs S4: cos=0.2923
[S5] BUFFERED delta from S4 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1799) from S2
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.379623)
[S6] loaded HEAD from S2 (vec_in norm=1.379623)
[S6] cosine check vs S2: cos=-0.0477
[S6] DROPPED delta from S2 (cos=-0.0477 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1802) from S13
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.386663)
[S9] loaded HEAD from S13 (vec_in norm=1.386663)
[S9] cosine check vs S13: cos=0.0237
[S9] BUFFERED delta from S13 (total buffered=2)
[S6] RECEIVED delta(kind=head bytes=1803) from S7
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.572195)
[S6] loaded HEAD from S7 (vec_in norm=1.572195)
[S6] cosine check vs S7: cos=0.4831
[S6] BUFFERED delta from S7 (total buffered=2)
[S9] RECEIVED delta(kind=head bytes=1800) from S11
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=0.819693)
[S9] loaded HEAD from S11 (vec_in norm=0.819693)
[S9] cosine check vs S11: cos=0.7972
[S9] BUFFERED delta from S11 (total buffered=3)
[S2] RECEIVED delta(kind=head bytes=1803) from S3
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.630745)
[S2] loaded HEAD from S3 (vec_in norm=1.630745)
[S2] cosine check vs S3: cos=-0.0531
[S2] DROPPED delta from S3 (cos=-0.0531 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1800) from S6
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.969135)
[S15] loaded HEAD from S6 (vec_in norm=0.969135)
[S15] cosine check vs S6: cos=0.4800
[S15] BUFFERED delta from S6 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1796) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.774718)
[S14] loaded HEAD from S15 (vec_in norm=0.774718)
[S14] cosine check vs S15: cos=0.5359
[S14] BUFFERED delta from S15 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1790) from S10
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=0.970200)
[S4] loaded HEAD from S10 (vec_in norm=0.970200)
[S4] cosine check vs S10: cos=0.9655
[S4] BUFFERED delta from S10 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:62405
[S17] sending update (kind=head size=1798 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1798) from S17
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=0.997190)
[S5] loaded HEAD from S17 (vec_in norm=0.997190)
[S5] cosine check vs S17: cos=0.8926
[S5] BUFFERED delta from S17 (total buffered=2)
[S9] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=8 metric=0.7014 head_norm=0.868186
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.118160e-01
[S9] stored merged vector for next round verification (round=8)
[S9] DEBUG after merge:  round=8 metric=0.7014 head_norm=0.673101 delta_norm=0.311816
[S9] aggregate: ACCEPT kept=['S5', 'S13', 'S11'] (k=3/3) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=8 metric=0.4169 head_norm=0.969135
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.762412e-01
[S6] stored merged vector for next round verification (round=8)
[S6] DEBUG after merge:  round=8 metric=0.4171 head_norm=0.968969 delta_norm=0.176241
[S6] aggregate: ACCEPT kept=['S8', 'S7'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=8 metric=0.4170 head_norm=0.774718
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.524039e-01
[S15] stored merged vector for next round verification (round=8)
[S15] DEBUG after merge:  round=8 metric=0.4186 head_norm=0.751689 delta_norm=0.452404
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=8 metric=0.3688 head_norm=0.891739
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.283459e-01
[S4] stored merged vector for next round verification (round=8)
[S4] DEBUG after merge:  round=8 metric=0.3688 head_norm=0.922914 delta_norm=0.128346
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=8 metric=0.1404 head_norm=0.819693
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.323728e-01
[S11] stored merged vector for next round verification (round=8)
[S11] DEBUG after merge:  round=8 metric=0.1404 head_norm=0.738856 delta_norm=0.332373
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=8 metric=0.7003 head_norm=0.866680
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.570404e-01
[S5] stored merged vector for next round verification (round=8)
[S5] DEBUG after merge:  round=8 metric=0.7003 head_norm=0.751497 delta_norm=0.257040
[S5] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=8 metric=0.1404 head_norm=0.800539
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.795764e-01
[S14] stored merged vector for next round verification (round=8)
[S14] DEBUG after merge:  round=8 metric=0.1404 head_norm=0.690252 delta_norm=0.379576
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=1.379623 (no previous merge yet)
[S2] round=9 local utility u=0.084349 metrics={'f1_val': 0.7001269353238722, 'auprc': 0.7414808778969187, 'loss_val': 0.5442091769494142, 'psi': 0.7166685123530908}-{'f1_val': 0.7010299569678582, 'auprc': 0.7268564482206121, 'loss_val': 0.6744527839595015, 'psi': 0.7113605534689598}
[S3] START round=9 head_norm_before_train=1.630745 (no previous merge yet)
[S3] round=9 local utility u=0.232981 metrics={'f1_val': 0.7000803035935849, 'auprc': 0.9991302392759386, 'loss_val': 0.28964310100875573, 'psi': 0.8197002778665263}-{'f1_val': 0.6426039769369589, 'auprc': 0.9999934473654202, 'loss_val': 0.41333773615240926, 'psi': 0.7855597651083435}
[S4] START round=9 head_norm_before_train=0.922914 cos_to_last_merge=1.0000 (last merge round=8)
[S4] round=9 local utility u=0.321618 metrics={'f1_val': 0.4015247200563971, 'auprc': 0.7886900355853571, 'loss_val': 0.8852709364633857, 'psi': 0.5563908462679811}-{'f1_val': 0.36881449807412864, 'auprc': 0.6595764121113024, 'loss_val': 0.9449048871151411, 'psi': 0.48511926368899816}
[S5] START round=9 head_norm_before_train=0.751497 cos_to_last_merge=1.0000 (last merge round=8)
[S5] round=9 local utility u=0.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9599683654284816, 'loss_val': 0.5921357116944507, 'psi': 0.8041797052662081}-{'f1_val': 0.700320598491359, 'auprc': 0.9976281642086344, 'loss_val': 0.6382290142673294, 'psi': 0.8192436247782692}
[S6] START round=9 head_norm_before_train=0.968969 cos_to_last_merge=1.0000 (last merge round=8)
[S6] round=9 local utility u=0.084795 metrics={'f1_val': 0.4171358730402079, 'auprc': 0.7923521542591926, 'loss_val': 0.8990669379573423, 'psi': 0.5672223855278018}-{'f1_val': 0.4168551858772006, 'auprc': 0.7759859726949483, 'loss_val': 1.0178746760153443, 'psi': 0.5605075006042997}
[S7] START round=9 head_norm_before_train=1.572195 (no previous merge yet)
[S7] round=9 local utility u=0.004495 metrics={'f1_val': 0.5847682339038414, 'auprc': 0.7970245452395556, 'loss_val': 0.672734580333579, 'psi': 0.6696707584381271}-{'f1_val': 0.5901226132251938, 'auprc': 0.7844668248415414, 'loss_val': 0.6761775628533351, 'psi': 0.6678602978717328}
[S8] START round=9 head_norm_before_train=1.377244 (no previous merge yet)
[S8] round=9 local utility u=0.633511 metrics={'f1_val': 0.6940059317668663, 'auprc': 0.9838564889453469, 'loss_val': 0.6823057261682892, 'psi': 0.8099461546382586}-{'f1_val': 0.5920309385138216, 'auprc': 0.7969931249789711, 'loss_val': 0.7768867039251955, 'psi': 0.6740158130998815}
[S9] START round=9 head_norm_before_train=0.673101 cos_to_last_merge=1.0000 (last merge round=8)
[S9] round=9 local utility u=0.000000 metrics={'f1_val': 0.7013613595118124, 'auprc': 0.9981081304905821, 'loss_val': 0.3833944402581018, 'psi': 0.8200600679033203}-{'f1_val': 0.7013613595118124, 'auprc': 0.9982679092292445, 'loss_val': 0.3787567271046188, 'psi': 0.8201239793987853}
[S10] START round=9 head_norm_before_train=0.970200 cos_to_last_merge=0.9152 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.915
[S10] round=9 local utility u=0.126716 metrics={'f1_val': 0.3867945712412313, 'auprc': 0.9684066823518112, 'loss_val': 0.6837012594665663, 'psi': 0.6194394156854632}-{'f1_val': 0.43190299859471837, 'auprc': 0.8394727931682521, 'loss_val': 0.8209823309693878, 'psi': 0.5949309164241319}
[S11] START round=9 head_norm_before_train=0.738856 cos_to_last_merge=1.0000 (last merge round=8)
[S11] round=9 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7870934456468652, 'loss_val': 1.095063038945725, 'psi': 0.3990855882826125}-{'f1_val': 0.14041368337311058, 'auprc': 0.8516210386312225, 'loss_val': 1.1467215739154106, 'psi': 0.42489662547635537}
[S13] START round=9 head_norm_before_train=1.386663 (no previous merge yet)
[S13] round=9 local utility u=0.922904 metrics={'f1_val': 0.656812764338903, 'auprc': 0.7804674996642393, 'loss_val': 0.6767844291899249, 'psi': 0.7062746584690376}-{'f1_val': 0.37616343030229826, 'auprc': 0.7637714971011836, 'loss_val': 0.788607454392023, 'psi': 0.5312066570218524}
[S14] START round=9 head_norm_before_train=0.690252 cos_to_last_merge=1.0000 (last merge round=8)
[S14] round=9 local utility u=0.030663 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8508403216672371, 'loss_val': 1.1041627095641884, 'psi': 0.42455084039651714}-{'f1_val': 0.14035785288270378, 'auprc': 0.8480576072749504, 'loss_val': 1.157141060333527, 'psi': 0.4234377546396024}
[S15] START round=9 head_norm_before_train=0.751689 cos_to_last_merge=1.0000 (last merge round=8)
[S15] round=9 local utility u=0.023681 metrics={'f1_val': 0.41764281001304976, 'auprc': 0.7997849467011628, 'loss_val': 0.963262537916577, 'psi': 0.5704996646882949}-{'f1_val': 0.4169508412658852, 'auprc': 0.8000246658252778, 'loss_val': 1.0071928556095038, 'psi': 0.5701803710896423}
[S16] START round=9 head_norm_before_train=1.381859 (no previous merge yet)
[S16] round=9 local utility u=0.008297 metrics={'f1_val': 0.37928551667116006, 'auprc': 0.7451102080790136, 'loss_val': 0.7669106605768463, 'psi': 0.5256153932343015}-{'f1_val': 0.38322437856707603, 'auprc': 0.7416026895792964, 'loss_val': 0.7966158378474266, 'psi': 0.5265757029719642}
[S17] START round=9 head_norm_before_train=0.997190 cos_to_last_merge=0.8737 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.874
[S17] round=9 local utility u=0.009608 metrics={'f1_val': 0.3568336587303115, 'auprc': 0.8452169446493392, 'loss_val': 0.8709726854428771, 'psi': 0.5521869730979225}-{'f1_val': 0.3759161708158133, 'auprc': 0.8091568170188733, 'loss_val': 0.8965042296557608, 'psi': 0.5492124292970373}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:62407
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] → sending delta(kind=head bytes=1805) to S6@127.0.0.1:62407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:62410
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] → sending delta(kind=head bytes=1793) to S14@127.0.0.1:62414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:62404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S10] → sending delta(kind=head bytes=1791) to S4@127.0.0.1:62404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:62412
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:62402
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:62415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:62405
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:62407
[S2] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1791 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1793 to 1 peers)
[S13] sending update (kind=head size=1794 to 1 peers)
[S7] sending update (kind=head size=1805 to 1 peers)
[S8] sending update (kind=head size=1804 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1804) from S8
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.410437)
[S6] loaded HEAD from S8 (vec_in norm=1.410437)
[S6] cosine check vs S8: cos=0.7134
[S6] BUFFERED delta from S8 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1805) from S7
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.601146)
[S6] loaded HEAD from S7 (vec_in norm=1.601146)
[S6] cosine check vs S7: cos=0.6136
[S6] BUFFERED delta from S7 (total buffered=2)
[S2] RECEIVED delta(kind=head bytes=1802) from S3
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.673186)
[S2] loaded HEAD from S3 (vec_in norm=1.673186)
[S2] cosine check vs S3: cos=-0.0552
[S2] DROPPED delta from S3 (cos=-0.0552 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1801) from S14
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.715605)
[S11] loaded HEAD from S14 (vec_in norm=0.715605)
[S11] cosine check vs S14: cos=0.7223
[S11] BUFFERED delta from S14 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1795) from S4
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.955145)
[S5] loaded HEAD from S4 (vec_in norm=0.955145)
[S5] cosine check vs S4: cos=0.4563
[S5] BUFFERED delta from S4 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1801) from S2
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.428126)
[S6] loaded HEAD from S2 (vec_in norm=1.428126)
[S6] cosine check vs S2: cos=-0.0400
[S6] DROPPED delta from S2 (cos=-0.0400 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1791) from S10
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.026007)
[S4] loaded HEAD from S10 (vec_in norm=1.026007)
[S4] cosine check vs S10: cos=0.9729
[S4] BUFFERED delta from S10 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1801) from S16
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.414950)
[S4] loaded HEAD from S16 (vec_in norm=1.414950)
[S4] cosine check vs S16: cos=-0.0136
[S4] DROPPED delta from S16 (cos=-0.0136 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1794) from S13
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.416111)
[S9] loaded HEAD from S13 (vec_in norm=1.416111)
[S9] cosine check vs S13: cos=0.2392
[S9] BUFFERED delta from S13 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1793) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.791226)
[S14] loaded HEAD from S15 (vec_in norm=0.791226)
[S14] cosine check vs S15: cos=0.6116
[S14] BUFFERED delta from S15 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1800) from S6
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.996304)
[S15] loaded HEAD from S6 (vec_in norm=0.996304)
[S15] cosine check vs S6: cos=0.8814
[S15] BUFFERED delta from S6 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:62405
[S17] sending update (kind=head size=1793 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1793) from S17
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.051704)
[S5] loaded HEAD from S17 (vec_in norm=1.051704)
[S5] cosine check vs S17: cos=0.8336
[S5] BUFFERED delta from S17 (total buffered=2)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=9 metric=0.7014 head_norm=0.812933
[S9] _apply_head_vector_avg (torch): Δ‖w‖=7.272231e-01
[S9] stored merged vector for next round verification (round=9)
[S9] DEBUG after merge:  round=9 metric=0.7011 head_norm=0.896807 delta_norm=0.727223
[S9] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=9 metric=0.1404 head_norm=0.772452
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.784795e-01
[S11] stored merged vector for next round verification (round=9)
[S11] DEBUG after merge:  round=9 metric=0.1404 head_norm=0.690533 delta_norm=0.278480
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=9 metric=0.7003 head_norm=0.826957
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.015705e-01
[S5] stored merged vector for next round verification (round=9)
[S5] DEBUG after merge:  round=9 metric=0.7003 head_norm=0.763770 delta_norm=0.201570
[S5] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=9 metric=0.4015 head_norm=0.955145
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.205409e-01
[S4] stored merged vector for next round verification (round=9)
[S4] DEBUG after merge:  round=9 metric=0.3992 head_norm=0.983853 delta_norm=0.120541
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=9 metric=0.4171 head_norm=0.996304
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.119730e-01
[S6] stored merged vector for next round verification (round=9)
[S6] DEBUG after merge:  round=9 metric=0.4171 head_norm=1.001607 delta_norm=0.111973
[S6] aggregate: ACCEPT kept=['S8', 'S7'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=9 metric=0.1404 head_norm=0.715605
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.337553e-01
[S14] stored merged vector for next round verification (round=9)
[S14] DEBUG after merge:  round=9 metric=0.1629 head_norm=0.676515 delta_norm=0.333755
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=9 metric=0.4176 head_norm=0.791226
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.392968e-01
[S15] stored merged vector for next round verification (round=9)
[S15] DEBUG after merge:  round=9 metric=0.4374 head_norm=0.867218 delta_norm=0.239297
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=1.428126 (no previous merge yet)
[S2] round=10 local utility u=0.101488 metrics={'f1_val': 0.6995880223688264, 'auprc': 0.7769519419074329, 'loss_val': 0.44441282140496924, 'psi': 0.730533590184269}-{'f1_val': 0.7001269353238722, 'auprc': 0.7414808778969187, 'loss_val': 0.5442091769494142, 'psi': 0.7166685123530908}
[S3] START round=10 head_norm_before_train=1.673186 (no previous merge yet)
[S3] round=10 local utility u=0.000000 metrics={'f1_val': 0.6428977324631927, 'auprc': 0.9997176833214367, 'loss_val': 0.38439676010715923, 'psi': 0.7856257128064903}-{'f1_val': 0.7000803035935849, 'auprc': 0.9991302392759386, 'loss_val': 0.28964310100875573, 'psi': 0.8197002778665263}
[S4] START round=10 head_norm_before_train=0.983853 cos_to_last_merge=1.0000 (last merge round=9)
[S4] round=10 local utility u=0.454853 metrics={'f1_val': 0.4983161815193773, 'auprc': 0.8501664967881647, 'loss_val': 0.7407430389033312, 'psi': 0.6390563076268923}-{'f1_val': 0.4015247200563971, 'auprc': 0.7886900355853571, 'loss_val': 0.8852709364633857, 'psi': 0.5563908462679811}
[S5] START round=10 head_norm_before_train=0.763770 cos_to_last_merge=1.0000 (last merge round=9)
[S5] round=10 local utility u=0.000000 metrics={'f1_val': 0.7145330545296904, 'auprc': 0.7942815378435872, 'loss_val': 0.619428120834223, 'psi': 0.7464324478552491}-{'f1_val': 0.700320598491359, 'auprc': 0.9599683654284816, 'loss_val': 0.5921357116944507, 'psi': 0.8041797052662081}
[S6] START round=10 head_norm_before_train=1.001607 cos_to_last_merge=1.0000 (last merge round=9)
[S6] round=10 local utility u=0.030489 metrics={'f1_val': 0.41693552313656757, 'auprc': 0.7893965028498959, 'loss_val': 0.8280208199745513, 'psi': 0.565919915021899}-{'f1_val': 0.4171358730402079, 'auprc': 0.7923521542591926, 'loss_val': 0.8990669379573423, 'psi': 0.5672223855278018}
[S7] START round=10 head_norm_before_train=1.601146 (no previous merge yet)
[S7] round=10 local utility u=0.000000 metrics={'f1_val': 0.545724007516965, 'auprc': 0.785124024382872, 'loss_val': 0.8767187276254468, 'psi': 0.6414840142633278}-{'f1_val': 0.5847682339038414, 'auprc': 0.7970245452395556, 'loss_val': 0.672734580333579, 'psi': 0.6696707584381271}
[S8] START round=10 head_norm_before_train=1.410437 (no previous merge yet)
[S8] round=10 local utility u=0.000000 metrics={'f1_val': 0.5390076067371646, 'auprc': 0.9485947973128559, 'loss_val': 0.7286904513115866, 'psi': 0.7028424829674411}-{'f1_val': 0.6940059317668663, 'auprc': 0.9838564889453469, 'loss_val': 0.6823057261682892, 'psi': 0.8099461546382586}
[S9] START round=10 head_norm_before_train=0.896807 cos_to_last_merge=1.0000 (last merge round=9)
[S9] round=10 local utility u=0.000000 metrics={'f1_val': 0.7013613595118124, 'auprc': 0.9972423255979491, 'loss_val': 0.42619603020905317, 'psi': 0.8197137459462671}-{'f1_val': 0.7013613595118124, 'auprc': 0.9981081304905821, 'loss_val': 0.3833944402581018, 'psi': 0.8200600679033203}
[S10] START round=10 head_norm_before_train=1.026007 cos_to_last_merge=0.8983 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.898
[S10] round=10 local utility u=0.427103 metrics={'f1_val': 0.5056773533521832, 'auprc': 0.9806934488965369, 'loss_val': 0.5796516256383829, 'psi': 0.6956837915699247}-{'f1_val': 0.3867945712412313, 'auprc': 0.9684066823518112, 'loss_val': 0.6837012594665663, 'psi': 0.6194394156854632}
[S11] START round=10 head_norm_before_train=0.690533 cos_to_last_merge=1.0000 (last merge round=9)
[S11] round=10 local utility u=0.163780 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8804656211735095, 'loss_val': 1.0536949852129838, 'psi': 0.43704201770017304}-{'f1_val': 0.14041368337311058, 'auprc': 0.7870934456468652, 'loss_val': 1.095063038945725, 'psi': 0.3990855882826125}
[S13] START round=10 head_norm_before_train=1.416111 (no previous merge yet)
[S13] round=10 local utility u=0.000000 metrics={'f1_val': 0.5296857424335959, 'auprc': 0.7267989633434472, 'loss_val': 0.707164141926051, 'psi': 0.6085310307975365}-{'f1_val': 0.656812764338903, 'auprc': 0.7804674996642393, 'loss_val': 0.6767844291899249, 'psi': 0.7062746584690376}
[S14] START round=10 head_norm_before_train=0.676515 cos_to_last_merge=1.0000 (last merge round=9)
[S14] round=10 local utility u=0.899646 metrics={'f1_val': 0.40278963754430575, 'auprc': 0.917118207026738, 'loss_val': 1.0782952863494466, 'psi': 0.6085210653372787}-{'f1_val': 0.14035785288270378, 'auprc': 0.8508403216672371, 'loss_val': 1.1041627095641884, 'psi': 0.42455084039651714}
[S15] START round=10 head_norm_before_train=0.867218 cos_to_last_merge=1.0000 (last merge round=9)
[S15] round=10 local utility u=0.880997 metrics={'f1_val': 0.7018271412102619, 'auprc': 0.7995983832014875, 'loss_val': 0.9058147605987771, 'psi': 0.7409356380067521}-{'f1_val': 0.41764281001304976, 'auprc': 0.7997849467011628, 'loss_val': 0.963262537916577, 'psi': 0.5704996646882949}
[S16] START round=10 head_norm_before_train=1.414950 (no previous merge yet)
[S16] round=10 local utility u=0.019693 metrics={'f1_val': 0.3811342127042175, 'auprc': 0.7437924797590508, 'loss_val': 0.7346634576523907, 'psi': 0.5261975195261508}-{'f1_val': 0.37928551667116006, 'auprc': 0.7451102080790136, 'loss_val': 0.7669106605768463, 'psi': 0.5256153932343015}
[S17] START round=10 head_norm_before_train=1.051704 cos_to_last_merge=0.8480 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.848
[S17] round=10 local utility u=0.000000 metrics={'f1_val': 0.3396840340908467, 'auprc': 0.7957614261898941, 'loss_val': 0.9701744269140639, 'psi': 0.5221149909304657}-{'f1_val': 0.3568336587303115, 'auprc': 0.8452169446493392, 'loss_val': 0.8709726854428771, 'psi': 0.5521869730979225}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:62404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:62415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:62405
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:62414
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:62407
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S10] → sending delta(kind=head bytes=1792) to S4@127.0.0.1:62404
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:62410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:62412
[S10] sending update (kind=head size=1792 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1793 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1798) from S6
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.037637)
[S15] loaded HEAD from S6 (vec_in norm=1.037637)
[S15] cosine check vs S6: cos=0.9464
[S15] BUFFERED delta from S6 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1797) from S16
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.450136)
[S4] loaded HEAD from S16 (vec_in norm=1.450136)
[S4] cosine check vs S16: cos=-0.0086
[S4] DROPPED delta from S16 (cos=-0.0086 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1792) from S10
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.083739)
[S4] loaded HEAD from S10 (vec_in norm=1.083739)
[S4] cosine check vs S10: cos=0.9788
[S4] BUFFERED delta from S10 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1800) from S2
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.475459)
[S6] loaded HEAD from S2 (vec_in norm=1.475459)
[S6] cosine check vs S2: cos=-0.0383
[S6] DROPPED delta from S2 (cos=-0.0383 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1793) from S4
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.020698)
[S5] loaded HEAD from S4 (vec_in norm=1.020698)
[S5] cosine check vs S4: cos=0.5367
[S5] BUFFERED delta from S4 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1796) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.903469)
[S14] loaded HEAD from S15 (vec_in norm=0.903469)
[S14] cosine check vs S15: cos=0.7919
[S14] BUFFERED delta from S15 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1800) from S11
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=0.728532)
[S9] loaded HEAD from S11 (vec_in norm=0.728532)
[S9] cosine check vs S11: cos=0.4841
[S9] BUFFERED delta from S11 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1801) from S14
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.701981)
[S11] loaded HEAD from S14 (vec_in norm=0.701981)
[S11] cosine check vs S14: cos=0.7198
[S11] BUFFERED delta from S14 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] ⇄ pheromone p=0.336 → S2@127.0.0.1:62402
[S13] ⇄ pheromone p=0.358 → S9@127.0.0.1:62410
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=10 metric=0.7014 head_norm=0.986459
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.494602e-01
[S9] stored merged vector for next round verification (round=10)
[S9] DEBUG after merge:  round=10 metric=0.7014 head_norm=0.741563 delta_norm=0.449460
[S9] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.170 → S14@127.0.0.1:62414
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=10 metric=0.7145 head_norm=0.840152
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.547314e-01
[S5] stored merged vector for next round verification (round=10)
[S5] DEBUG after merge:  round=10 metric=0.7146 head_norm=0.816737 delta_norm=0.454731
[S5] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.285 → S9@127.0.0.1:62410
[S7] ⇄ pheromone p=0.306 → S6@127.0.0.1:62407
[S8] ⇄ pheromone p=0.376 → S6@127.0.0.1:62407
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=10 metric=0.1414 head_norm=0.728532
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.679821e-01
[S11] stored merged vector for next round verification (round=10)
[S11] DEBUG after merge:  round=10 metric=0.3074 head_norm=0.663290 delta_norm=0.267982
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.194 → S9@127.0.0.1:62410
[S2] ⇄ pheromone p=0.347 → S6@127.0.0.1:62407
[S6] ⇄ pheromone p=0.260 → S15@127.0.0.1:62415
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=10 metric=0.7018 head_norm=0.903469
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.721589e-01
[S15] stored merged vector for next round verification (round=10)
[S15] DEBUG after merge:  round=10 metric=0.7018 head_norm=0.957515 delta_norm=0.172159
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.398 → S14@127.0.0.1:62414
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=10 metric=0.4983 head_norm=1.020698
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.126880e-01
[S4] stored merged vector for next round verification (round=10)
[S4] DEBUG after merge:  round=10 metric=0.6368 head_norm=1.046642 delta_norm=0.112688
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.351 → S5@127.0.0.1:62405
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=10 metric=0.4028 head_norm=0.701981
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.759492e-01
[S14] stored merged vector for next round verification (round=10)
[S14] DEBUG after merge:  round=10 metric=0.2411 head_norm=0.760505 delta_norm=0.275949
[S14] aggregate: ROLLBACK (f1_val pre=0.403 post=0.241 tol_abs=0.005 tol_rel=0.0)
[S14] ⇄ pheromone p=0.333 → S11@127.0.0.1:62412
[S10] ⇄ pheromone p=0.374 → S4@127.0.0.1:62404
[S16] ⇄ pheromone p=0.208 → S4@127.0.0.1:62404
[S17] ⇄ pheromone p=0.241 → S5@127.0.0.1:62405
[S2] START round=11 head_norm_before_train=1.475459 (no previous merge yet)
[S2] round=11 local utility u=0.000000 metrics={'f1_val': 0.6988664978654815, 'auprc': 0.7533805935569151, 'loss_val': 0.38055777119162354, 'psi': 0.7206721361420549}-{'f1_val': 0.6995880223688264, 'auprc': 0.7769519419074329, 'loss_val': 0.44441282140496924, 'psi': 0.730533590184269}
[S3] START round=11 head_norm_before_train=1.718063 (no previous merge yet)
[S3] round=11 local utility u=0.230604 metrics={'f1_val': 0.7000803035935849, 'auprc': 0.9997563583045254, 'loss_val': 0.266400050374158, 'psi': 0.8199507254779611}-{'f1_val': 0.6428977324631927, 'auprc': 0.9997176833214367, 'loss_val': 0.38439676010715923, 'psi': 0.7856257128064903}
[S4] START round=11 head_norm_before_train=1.046642 cos_to_last_merge=1.0000 (last merge round=10)
[S4] round=11 local utility u=0.427540 metrics={'f1_val': 0.6188607395637203, 'auprc': 0.8575542567072877, 'loss_val': 0.631092818712511, 'psi': 0.7143381464211473}-{'f1_val': 0.4983161815193773, 'auprc': 0.8501664967881647, 'loss_val': 0.7407430389033312, 'psi': 0.6390563076268923}
[S5] START round=11 head_norm_before_train=0.816737 cos_to_last_merge=1.0000 (last merge round=10)
[S5] round=11 local utility u=0.000000 metrics={'f1_val': 0.7141740326016373, 'auprc': 0.7938314357142303, 'loss_val': 0.6626368104982853, 'psi': 0.7460369938466744}-{'f1_val': 0.7145330545296904, 'auprc': 0.7942815378435872, 'loss_val': 0.619428120834223, 'psi': 0.7464324478552491}
[S6] START round=11 head_norm_before_train=1.037637 cos_to_last_merge=0.9974 (last merge round=9)
[S6] round=11 local utility u=1.000000 metrics={'f1_val': 0.7101639028673369, 'auprc': 0.8515071875762888, 'loss_val': 0.6346186261990586, 'psi': 0.7667012167509177}-{'f1_val': 0.41693552313656757, 'auprc': 0.7893965028498959, 'loss_val': 0.8280208199745513, 'psi': 0.565919915021899}
[S7] START round=11 head_norm_before_train=1.626740 (no previous merge yet)
[S7] round=11 local utility u=0.741284 metrics={'f1_val': 0.6829350717222133, 'auprc': 0.842324130333011, 'loss_val': 0.3890166441604928, 'psi': 0.7466906951665324}-{'f1_val': 0.545724007516965, 'auprc': 0.785124024382872, 'loss_val': 0.8767187276254468, 'psi': 0.6414840142633278}
[S8] START round=11 head_norm_before_train=1.441258 (no previous merge yet)
[S8] round=11 local utility u=0.713187 metrics={'f1_val': 0.7140170479737811, 'auprc': 0.9987720572992608, 'loss_val': 0.5029057705846487, 'psi': 0.827919051703973}-{'f1_val': 0.5390076067371646, 'auprc': 0.9485947973128559, 'loss_val': 0.7286904513115866, 'psi': 0.7028424829674411}
[S9] START round=11 head_norm_before_train=0.741563 cos_to_last_merge=1.0000 (last merge round=10)
[S9] round=11 local utility u=0.034075 metrics={'f1_val': 0.7012888352718426, 'auprc': 0.9976688823956467, 'loss_val': 0.3588910294402807, 'psi': 0.8198408541213642}-{'f1_val': 0.7013613595118124, 'auprc': 0.9972423255979491, 'loss_val': 0.42619603020905317, 'psi': 0.8197137459462671}
[S10] START round=11 head_norm_before_train=1.083739 cos_to_last_merge=0.8821 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.882
[S10] round=11 local utility u=0.667454 metrics={'f1_val': 0.7016401924031649, 'auprc': 0.9968342292311905, 'loss_val': 0.46894288817754193, 'psi': 0.8197178071343751}-{'f1_val': 0.5056773533521832, 'auprc': 0.9806934488965369, 'loss_val': 0.5796516256383829, 'psi': 0.6956837915699247}
[S11] START round=11 head_norm_before_train=0.663290 cos_to_last_merge=1.0000 (last merge round=10)
[S11] round=11 local utility u=1.000000 metrics={'f1_val': 0.4248888617561582, 'auprc': 0.9611686076182071, 'loss_val': 0.9826980669199379, 'psi': 0.6394007601009778}-{'f1_val': 0.14142628205128205, 'auprc': 0.8804656211735095, 'loss_val': 1.0536949852129838, 'psi': 0.43704201770017304}
[S13] START round=11 head_norm_before_train=1.447053 (no previous merge yet)
[S13] round=11 local utility u=0.681289 metrics={'f1_val': 0.7123535075845525, 'auprc': 0.7687972315870185, 'loss_val': 0.5665883769402377, 'psi': 0.7349309971855389}-{'f1_val': 0.5296857424335959, 'auprc': 0.7267989633434472, 'loss_val': 0.707164141926051, 'psi': 0.6085310307975365}
[S14] START round=11 head_norm_before_train=0.760505 cos_to_last_merge=1.0000 (last merge round=10)
[S14] round=11 local utility u=0.114245 metrics={'f1_val': 0.40261418556975037, 'auprc': 0.9768045868784515, 'loss_val': 1.0278122723059357, 'psi': 0.6322903460932308}-{'f1_val': 0.40278963754430575, 'auprc': 0.917118207026738, 'loss_val': 1.0782952863494466, 'psi': 0.6085210653372787}
[S15] START round=11 head_norm_before_train=0.957515 cos_to_last_merge=1.0000 (last merge round=10)
[S15] round=11 local utility u=0.036378 metrics={'f1_val': 0.700194102416466, 'auprc': 0.7993644680768126, 'loss_val': 0.8225578437901012, 'psi': 0.7398622486806046}-{'f1_val': 0.7018271412102619, 'auprc': 0.7995983832014875, 'loss_val': 0.9058147605987771, 'psi': 0.7409356380067521}
[S16] START round=11 head_norm_before_train=1.450136 (no previous merge yet)
[S16] round=11 local utility u=0.507990 metrics={'f1_val': 0.5416882741964382, 'auprc': 0.7647187624237745, 'loss_val': 0.7447867440270133, 'psi': 0.6309004694873727}-{'f1_val': 0.3811342127042175, 'auprc': 0.7437924797590508, 'loss_val': 0.7346634576523907, 'psi': 0.5261975195261508}
[S17] START round=11 head_norm_before_train=1.096114 cos_to_last_merge=0.8280 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.828
[S17] round=11 local utility u=0.000000 metrics={'f1_val': 0.3418847115208665, 'auprc': 0.6830156692899044, 'loss_val': 0.9378506232569827, 'psi': 0.47833709462848173}-{'f1_val': 0.3396840340908467, 'auprc': 0.7957614261898941, 'loss_val': 0.9701744269140639, 'psi': 0.5221149909304657}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:62414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S4] → sending delta(kind=head bytes=1792) to S5@127.0.0.1:62405
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:62404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:62410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S7] → sending delta(kind=head bytes=1809) to S6@127.0.0.1:62407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:62402
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:62412
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:62407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:62414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:62404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:62415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:62410
[S11] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1794 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1809 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1792 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1800) from S3
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.748705)
[S2] loaded HEAD from S3 (vec_in norm=1.748705)
[S2] cosine check vs S3: cos=-0.0479
[S2] DROPPED delta from S3 (cos=-0.0479 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1794) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.993096)
[S14] loaded HEAD from S15 (vec_in norm=0.993096)
[S14] cosine check vs S15: cos=0.9089
[S14] BUFFERED delta from S15 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1809) from S7
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.640200)
[S6] loaded HEAD from S7 (vec_in norm=1.640200)
[S6] cosine check vs S7: cos=0.6627
[S6] BUFFERED delta from S7 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1792) from S4
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.086262)
[S5] loaded HEAD from S4 (vec_in norm=1.086262)
[S5] cosine check vs S4: cos=0.8491
[S5] BUFFERED delta from S4 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1803) from S8
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.467520)
[S6] loaded HEAD from S8 (vec_in norm=1.467520)
[S6] cosine check vs S8: cos=0.6565
[S6] BUFFERED delta from S8 (total buffered=2)
[S9] RECEIVED delta(kind=head bytes=1802) from S11
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=0.702942)
[S9] loaded HEAD from S11 (vec_in norm=0.702942)
[S9] cosine check vs S11: cos=0.6961
[S9] BUFFERED delta from S11 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1798) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.872014)
[S14] loaded HEAD from S9 (vec_in norm=0.872014)
[S14] cosine check vs S9: cos=0.2859
[S14] BUFFERED delta from S9 (total buffered=2)
[S9] RECEIVED delta(kind=head bytes=1798) from S13
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.481948)
[S9] loaded HEAD from S13 (vec_in norm=1.481948)
[S9] cosine check vs S13: cos=0.5472
[S9] BUFFERED delta from S13 (total buffered=2)
[S15] RECEIVED delta(kind=head bytes=1798) from S6
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.077942)
[S15] loaded HEAD from S6 (vec_in norm=1.077942)
[S15] cosine check vs S6: cos=0.9645
[S15] BUFFERED delta from S6 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1800) from S16
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.486690)
[S4] loaded HEAD from S16 (vec_in norm=1.486690)
[S4] cosine check vs S16: cos=-0.0003
[S4] DROPPED delta from S16 (cos=-0.0003 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1796) from S14
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.785229)
[S11] loaded HEAD from S14 (vec_in norm=0.785229)
[S11] cosine check vs S14: cos=0.7513
[S11] BUFFERED delta from S14 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1797) from S10
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.144589)
[S4] loaded HEAD from S10 (vec_in norm=1.144589)
[S4] cosine check vs S10: cos=0.9838
[S4] BUFFERED delta from S10 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=11 metric=0.7142 head_norm=0.866580
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.882175e-01
[S5] stored merged vector for next round verification (round=11)
[S5] DEBUG after merge:  round=11 metric=0.4651 head_norm=0.939358 delta_norm=0.288217
[S5] aggregate: ROLLBACK (f1_val pre=0.714 post=0.465 tol_abs=0.005 tol_rel=0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=11 metric=0.6189 head_norm=1.086262
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.046062e-01
[S4] stored merged vector for next round verification (round=11)
[S4] DEBUG after merge:  round=11 metric=0.6133 head_norm=1.110893 delta_norm=0.104606
[S4] aggregate: ROLLBACK (f1_val pre=0.619 post=0.613 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=11 metric=0.4026 head_norm=0.785229
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.062503e-01
[S14] stored merged vector for next round verification (round=11)
[S14] DEBUG after merge:  round=11 metric=0.6334 head_norm=0.703421 delta_norm=0.206250
[S14] aggregate: ACCEPT kept=['S15', 'S9'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=11 metric=0.7002 head_norm=0.993096
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.442814e-01
[S15] stored merged vector for next round verification (round=11)
[S15] DEBUG after merge:  round=11 metric=0.6990 head_norm=1.026295 delta_norm=0.144281
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=11 metric=0.7102 head_norm=1.077942
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.155354e-01
[S6] stored merged vector for next round verification (round=11)
[S6] DEBUG after merge:  round=11 metric=0.7102 head_norm=1.057570 delta_norm=0.115535
[S6] aggregate: ACCEPT kept=['S7', 'S8'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=11 metric=0.7013 head_norm=0.872014
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.106175e-01
[S9] stored merged vector for next round verification (round=11)
[S9] DEBUG after merge:  round=11 metric=0.7013 head_norm=0.814489 delta_norm=0.310618
[S9] aggregate: ACCEPT kept=['S11', 'S13'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=11 metric=0.4249 head_norm=0.702942
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.651756e-01
[S11] stored merged vector for next round verification (round=11)
[S11] DEBUG after merge:  round=11 metric=0.1150 head_norm=0.696447 delta_norm=0.265176
[S11] aggregate: ROLLBACK (f1_val pre=0.425 post=0.115 tol_abs=0.005 tol_rel=0.0)
[S2] START round=12 head_norm_before_train=1.515503 (no previous merge yet)
[S2] round=12 local utility u=0.000000 metrics={'f1_val': 0.6995880223688264, 'auprc': 0.6840344208579221, 'loss_val': 0.32071273319122473, 'psi': 0.6933665817644648}-{'f1_val': 0.6988664978654815, 'auprc': 0.7533805935569151, 'loss_val': 0.38055777119162354, 'psi': 0.7206721361420549}
[S3] START round=12 head_norm_before_train=1.748705 (no previous merge yet)
[S3] round=12 local utility u=0.000000 metrics={'f1_val': 0.5814140538312574, 'auprc': 0.9996893415069132, 'loss_val': 0.5426869746333466, 'psi': 0.7487241689015198}-{'f1_val': 0.7000803035935849, 'auprc': 0.9997563583045254, 'loss_val': 0.266400050374158, 'psi': 0.8199507254779611}
[S4] START round=12 head_norm_before_train=1.110893 cos_to_last_merge=1.0000 (last merge round=11)
[S4] round=12 local utility u=0.163874 metrics={'f1_val': 0.6637080871327594, 'auprc': 0.8559881315934178, 'loss_val': 0.5677301706898367, 'psi': 0.7406201049170228}-{'f1_val': 0.6188607395637203, 'auprc': 0.8575542567072877, 'loss_val': 0.631092818712511, 'psi': 0.7143381464211473}
[S5] START round=12 head_norm_before_train=0.939358 cos_to_last_merge=1.0000 (last merge round=11)
[S5] round=12 local utility u=0.000000 metrics={'f1_val': 0.7026452098583048, 'auprc': 0.7942319633668083, 'loss_val': 0.6159735405226983, 'psi': 0.7392799112617062}-{'f1_val': 0.7141740326016373, 'auprc': 0.7938314357142303, 'loss_val': 0.6626368104982853, 'psi': 0.7460369938466744}
[S6] START round=12 head_norm_before_train=1.057570 cos_to_last_merge=1.0000 (last merge round=11)
[S6] round=12 local utility u=0.000000 metrics={'f1_val': 0.5855980912055765, 'auprc': 0.7791819397775258, 'loss_val': 0.6810572759946475, 'psi': 0.6630316306343562}-{'f1_val': 0.7101639028673369, 'auprc': 0.8515071875762888, 'loss_val': 0.6346186261990586, 'psi': 0.7667012167509177}
[S7] START round=12 head_norm_before_train=1.640200 (no previous merge yet)
[S7] round=12 local utility u=0.143492 metrics={'f1_val': 0.6970948536789058, 'auprc': 0.8826831558331503, 'loss_val': 0.30806869727180347, 'psi': 0.7713301745406036}-{'f1_val': 0.6829350717222133, 'auprc': 0.842324130333011, 'loss_val': 0.3890166441604928, 'psi': 0.7466906951665324}
[S8] START round=12 head_norm_before_train=1.467520 (no previous merge yet)
[S8] round=12 local utility u=0.016388 metrics={'f1_val': 0.7071133335623867, 'auprc': 0.998695048640775, 'loss_val': 0.4284767669289971, 'psi': 0.823746019593742}-{'f1_val': 0.7140170479737811, 'auprc': 0.9987720572992608, 'loss_val': 0.5029057705846487, 'psi': 0.827919051703973}
[S9] START round=12 head_norm_before_train=0.814489 cos_to_last_merge=1.0000 (last merge round=11)
[S9] round=12 local utility u=0.000000 metrics={'f1_val': 0.7012888352718426, 'auprc': 0.9978669117177547, 'loss_val': 0.36826827410910384, 'psi': 0.8199200658502075}-{'f1_val': 0.7012888352718426, 'auprc': 0.9976688823956467, 'loss_val': 0.3588910294402807, 'psi': 0.8198408541213642}
[S10] START round=12 head_norm_before_train=1.144589 cos_to_last_merge=0.8681 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.868
[S10] round=12 local utility u=0.049593 metrics={'f1_val': 0.6998526945103416, 'auprc': 0.9978064719935424, 'loss_val': 0.36194926143986045, 'psi': 0.8190342055036219}-{'f1_val': 0.7016401924031649, 'auprc': 0.9968342292311905, 'loss_val': 0.46894288817754193, 'psi': 0.8197178071343751}
[S11] START round=12 head_norm_before_train=0.696447 cos_to_last_merge=1.0000 (last merge round=11)
[S11] round=12 local utility u=0.531460 metrics={'f1_val': 0.5842326525428532, 'auprc': 0.9826627803866271, 'loss_val': 0.9403236006716126, 'psi': 0.7436047036803628}-{'f1_val': 0.4248888617561582, 'auprc': 0.9611686076182071, 'loss_val': 0.9826980669199379, 'psi': 0.6394007601009778}
[S13] START round=12 head_norm_before_train=1.481948 (no previous merge yet)
[S13] round=12 local utility u=0.007586 metrics={'f1_val': 0.7106612265847874, 'auprc': 0.7597677431325074, 'loss_val': 0.5141751054838464, 'psi': 0.7303038332038754}-{'f1_val': 0.7123535075845525, 'auprc': 0.7687972315870185, 'loss_val': 0.5665883769402377, 'psi': 0.7349309971855389}
[S14] START round=12 head_norm_before_train=0.703421 cos_to_last_merge=1.0000 (last merge round=11)
[S14] round=12 local utility u=0.949078 metrics={'f1_val': 0.6927289989942433, 'auprc': 0.9918205686058414, 'loss_val': 0.9153929470960265, 'psi': 0.8123656268388826}-{'f1_val': 0.40261418556975037, 'auprc': 0.9768045868784515, 'loss_val': 1.0278122723059357, 'psi': 0.6322903460932308}
[S15] START round=12 head_norm_before_train=1.026295 cos_to_last_merge=1.0000 (last merge round=11)
[S15] round=12 local utility u=0.000000 metrics={'f1_val': 0.701588966402071, 'auprc': 0.7128396853008614, 'loss_val': 0.7844930432701461, 'psi': 0.7060892539615872}-{'f1_val': 0.700194102416466, 'auprc': 0.7993644680768126, 'loss_val': 0.8225578437901012, 'psi': 0.7398622486806046}
[S16] START round=12 head_norm_before_train=1.486690 (no previous merge yet)
[S16] round=12 local utility u=0.065375 metrics={'f1_val': 0.5473185025461326, 'auprc': 0.7775309066889005, 'loss_val': 0.6862555297103967, 'psi': 0.6394034642032398}-{'f1_val': 0.5416882741964382, 'auprc': 0.7647187624237745, 'loss_val': 0.7447867440270133, 'psi': 0.6309004694873727}
[S17] START round=12 head_norm_before_train=1.134879 cos_to_last_merge=0.8113 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.811
[S17] round=12 local utility u=0.083122 metrics={'f1_val': 0.35861577090586755, 'auprc': 0.6775973084476494, 'loss_val': 0.8557384972442491, 'psi': 0.4862083859225803}-{'f1_val': 0.3418847115208665, 'auprc': 0.6830156692899044, 'loss_val': 0.9378506232569827, 'psi': 0.47833709462848173}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S4] → sending delta(kind=head bytes=1791) to S5@127.0.0.1:62405
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:62410
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:62404
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:62412
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:62407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:62410
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:62404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:62407
[S8] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1794 to 1 peers)
[S4] sending update (kind=head size=1791 to 1 peers)
[S11] sending update (kind=head size=1804 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1800) from S8
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.492519)
[S6] loaded HEAD from S8 (vec_in norm=1.492519)
[S6] cosine check vs S8: cos=0.6427
[S6] BUFFERED delta from S8 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1802) from S7
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.645437)
[S6] loaded HEAD from S7 (vec_in norm=1.645437)
[S6] cosine check vs S7: cos=0.6898
[S6] BUFFERED delta from S7 (total buffered=2)
[S5] RECEIVED delta(kind=head bytes=1791) from S4
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.152448)
[S5] loaded HEAD from S4 (vec_in norm=1.152448)
[S5] cosine check vs S4: cos=0.9349
[S5] BUFFERED delta from S4 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1804) from S11
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=0.728139)
[S9] loaded HEAD from S11 (vec_in norm=0.728139)
[S9] cosine check vs S11: cos=0.5345
[S9] BUFFERED delta from S11 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1794) from S13
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.518445)
[S9] loaded HEAD from S13 (vec_in norm=1.518445)
[S9] cosine check vs S13: cos=0.7074
[S9] BUFFERED delta from S13 (total buffered=2)
[S11] RECEIVED delta(kind=head bytes=1799) from S14
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.743197)
[S11] loaded HEAD from S14 (vec_in norm=0.743197)
[S11] cosine check vs S14: cos=0.9366
[S11] BUFFERED delta from S14 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1795) from S10
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.199670)
[S4] loaded HEAD from S10 (vec_in norm=1.199670)
[S4] cosine check vs S10: cos=0.9869
[S4] BUFFERED delta from S10 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1800) from S16
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.525971)
[S4] loaded HEAD from S16 (vec_in norm=1.525971)
[S4] cosine check vs S16: cos=0.0088
[S4] BUFFERED delta from S16 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:62405
[S17] sending update (kind=head size=1800 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1800) from S17
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.168506)
[S5] loaded HEAD from S17 (vec_in norm=1.168506)
[S5] cosine check vs S17: cos=0.3078
[S5] BUFFERED delta from S17 (total buffered=2)
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=12 metric=0.7026 head_norm=0.974428
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.712075e-01
[S5] stored merged vector for next round verification (round=12)
[S5] DEBUG after merge:  round=12 metric=0.7007 head_norm=0.879625 delta_norm=0.271208
[S5] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=12 metric=0.7013 head_norm=0.923201
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.580916e-01
[S9] stored merged vector for next round verification (round=12)
[S9] DEBUG after merge:  round=12 metric=0.7013 head_norm=0.861430 delta_norm=0.258092
[S9] aggregate: ACCEPT kept=['S11', 'S13'] (k=2/2) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=12 metric=0.5856 head_norm=1.090923
[S6] _apply_head_vector_avg (torch): Δ‖w‖=8.176396e-02
[S6] stored merged vector for next round verification (round=12)
[S6] DEBUG after merge:  round=12 metric=0.6173 head_norm=1.071931 delta_norm=0.081764
[S6] aggregate: ACCEPT kept=['S8', 'S7'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=12 metric=0.5842 head_norm=0.728139
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.312129e-01
[S11] stored merged vector for next round verification (round=12)
[S11] DEBUG after merge:  round=12 metric=0.6689 head_norm=0.723911 delta_norm=0.131213
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=12 metric=0.6637 head_norm=1.152448
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.781214e-01
[S4] stored merged vector for next round verification (round=12)
[S4] DEBUG after merge:  round=12 metric=0.6637 head_norm=0.958407 delta_norm=0.478121
[S4] aggregate: ACCEPT kept=['S10', 'S16'] (k=2/2) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.550832 (no previous merge yet)
[S2] round=13 local utility u=0.000000 metrics={'f1_val': 0.6847266820193613, 'auprc': 0.6943466250851373, 'loss_val': 0.3487078684468558, 'psi': 0.6885746592456716}-{'f1_val': 0.6995880223688264, 'auprc': 0.6840344208579221, 'loss_val': 0.32071273319122473, 'psi': 0.6933665817644648}
[S3] START round=13 head_norm_before_train=1.771151 (no previous merge yet)
[S3] round=13 local utility u=0.000000 metrics={'f1_val': 0.5656573992345865, 'auprc': 0.9995071806968643, 'loss_val': 0.577810787286777, 'psi': 0.7391973118194977}-{'f1_val': 0.5814140538312574, 'auprc': 0.9996893415069132, 'loss_val': 0.5426869746333466, 'psi': 0.7487241689015198}
[S4] START round=13 head_norm_before_train=0.958407 cos_to_last_merge=1.0000 (last merge round=12)
[S4] round=13 local utility u=0.000000 metrics={'f1_val': 0.6674616434398501, 'auprc': 0.6538177739820394, 'loss_val': 0.5834588510491527, 'psi': 0.6620040956567259}-{'f1_val': 0.6637080871327594, 'auprc': 0.8559881315934178, 'loss_val': 0.5677301706898367, 'psi': 0.7406201049170228}
[S5] START round=13 head_norm_before_train=0.879625 cos_to_last_merge=1.0000 (last merge round=12)
[S5] round=13 local utility u=0.161664 metrics={'f1_val': 0.7007274985363465, 'auprc': 0.869684278419992, 'loss_val': 0.5074966294493447, 'psi': 0.7683102104898047}-{'f1_val': 0.7026452098583048, 'auprc': 0.7942319633668083, 'loss_val': 0.6159735405226983, 'psi': 0.7392799112617062}
[S6] START round=13 head_norm_before_train=1.071931 cos_to_last_merge=1.0000 (last merge round=12)
[S6] round=13 local utility u=0.466234 metrics={'f1_val': 0.7101911874063502, 'auprc': 0.8037246331146555, 'loss_val': 0.5697763232349378, 'psi': 0.7476045656896724}-{'f1_val': 0.5855980912055765, 'auprc': 0.7791819397775258, 'loss_val': 0.6810572759946475, 'psi': 0.6630316306343562}
[S7] START round=13 head_norm_before_train=1.645437 (no previous merge yet)
[S7] round=13 local utility u=0.012834 metrics={'f1_val': 0.6956416676285265, 'auprc': 0.891347175533227, 'loss_val': 0.2996745810313377, 'psi': 0.7739238707904067}-{'f1_val': 0.6970948536789058, 'auprc': 0.8826831558331503, 'loss_val': 0.30806869727180347, 'psi': 0.7713301745406036}
[S8] START round=13 head_norm_before_train=1.492519 (no previous merge yet)
[S8] round=13 local utility u=0.048582 metrics={'f1_val': 0.7136006124744415, 'auprc': 0.9987526169939128, 'loss_val': 0.3704091171609364, 'psi': 0.8276614142822301}-{'f1_val': 0.7071133335623867, 'auprc': 0.998695048640775, 'loss_val': 0.4284767669289971, 'psi': 0.823746019593742}
[S9] START round=13 head_norm_before_train=0.861430 cos_to_last_merge=1.0000 (last merge round=12)
[S9] round=13 local utility u=0.003109 metrics={'f1_val': 0.7012888352718426, 'auprc': 0.9976458802598692, 'loss_val': 0.3613874467088944, 'psi': 0.8198316532670533}-{'f1_val': 0.7012888352718426, 'auprc': 0.9978669117177547, 'loss_val': 0.36826827410910384, 'psi': 0.8199200658502075}
[S10] START round=13 head_norm_before_train=1.199670 cos_to_last_merge=0.8573 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.857
[S10] round=13 local utility u=0.001028 metrics={'f1_val': 0.6928136612166707, 'auprc': 0.9919547360494109, 'loss_val': 0.3001037797270029, 'psi': 0.8124700911497668}-{'f1_val': 0.6998526945103416, 'auprc': 0.9978064719935424, 'loss_val': 0.36194926143986045, 'psi': 0.8190342055036219}
[S11] START round=13 head_norm_before_train=0.723911 cos_to_last_merge=1.0000 (last merge round=12)
[S11] round=13 local utility u=0.000000 metrics={'f1_val': 0.5393515840952465, 'auprc': 0.9939130003625124, 'loss_val': 0.8858090073797633, 'psi': 0.7211761506021528}-{'f1_val': 0.5842326525428532, 'auprc': 0.9826627803866271, 'loss_val': 0.9403236006716126, 'psi': 0.7436047036803628}
[S13] START round=13 head_norm_before_train=1.518445 (no previous merge yet)
[S13] round=13 local utility u=0.000000 metrics={'f1_val': 0.6592960607812268, 'auprc': 0.7554415342762604, 'loss_val': 0.47526226966430635, 'psi': 0.6977542501792402}-{'f1_val': 0.7106612265847874, 'auprc': 0.7597677431325074, 'loss_val': 0.5141751054838464, 'psi': 0.7303038332038754}
[S14] START round=13 head_norm_before_train=0.743197 cos_to_last_merge=0.9905 (last merge round=11)
[S14] round=13 local utility u=0.069763 metrics={'f1_val': 0.6921021147308503, 'auprc': 0.9938695699437224, 'loss_val': 0.7782531531345006, 'psi': 0.8128090968159991}-{'f1_val': 0.6927289989942433, 'auprc': 0.9918205686058414, 'loss_val': 0.9153929470960265, 'psi': 0.8123656268388826}
[S15] START round=13 head_norm_before_train=1.060590 cos_to_last_merge=0.9945 (last merge round=11)
[S15] round=13 local utility u=0.171125 metrics={'f1_val': 0.6985085565078436, 'auprc': 0.7998154383093448, 'loss_val': 0.6846879188871939, 'psi': 0.7390313092284441}-{'f1_val': 0.701588966402071, 'auprc': 0.7128396853008614, 'loss_val': 0.7844930432701461, 'psi': 0.7060892539615872}
[S16] START round=13 head_norm_before_train=1.525971 (no previous merge yet)
[S16] round=13 local utility u=0.677920 metrics={'f1_val': 0.7651937050737756, 'auprc': 0.795324839449145, 'loss_val': 0.6910493867047082, 'psi': 0.7772461588239234}-{'f1_val': 0.5473185025461326, 'auprc': 0.7775309066889005, 'loss_val': 0.6862555297103967, 'psi': 0.6394034642032398}
[S17] START round=13 head_norm_before_train=1.168506 cos_to_last_merge=0.7976 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.798
[S17] round=13 local utility u=0.204812 metrics={'f1_val': 0.38354778001373135, 'auprc': 0.7260217230325545, 'loss_val': 0.7409801828840207, 'psi': 0.5205373572212606}-{'f1_val': 0.35861577090586755, 'auprc': 0.6775973084476494, 'loss_val': 0.8557384972442491, 'psi': 0.4862083859225803}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:62414
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] → sending delta(kind=head bytes=1805) to S15@127.0.0.1:62415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:62404
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:62412
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:62404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:62407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:62407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:62414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:62410
[S5] sending update (kind=head size=1795 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1805 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1802) from S14
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.792907)
[S11] loaded HEAD from S14 (vec_in norm=0.792907)
[S11] cosine check vs S14: cos=0.9536
[S11] BUFFERED delta from S14 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1801) from S10
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.248055)
[S4] loaded HEAD from S10 (vec_in norm=1.248055)
[S4] cosine check vs S10: cos=0.9139
[S4] BUFFERED delta from S10 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1799) from S16
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.566746)
[S4] loaded HEAD from S16 (vec_in norm=1.566746)
[S4] cosine check vs S16: cos=0.3910
[S4] BUFFERED delta from S16 (total buffered=2)
[S14] RECEIVED delta(kind=head bytes=1798) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.956623)
[S14] loaded HEAD from S9 (vec_in norm=0.956623)
[S14] cosine check vs S9: cos=0.5359
[S14] BUFFERED delta from S9 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1799) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.101669)
[S14] loaded HEAD from S15 (vec_in norm=1.101669)
[S14] cosine check vs S15: cos=0.7909
[S14] BUFFERED delta from S15 (total buffered=2)
[S9] RECEIVED delta(kind=head bytes=1795) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.944579)
[S9] loaded HEAD from S5 (vec_in norm=0.944579)
[S9] cosine check vs S5: cos=0.4158
[S9] BUFFERED delta from S5 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1802) from S8
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.515486)
[S6] loaded HEAD from S8 (vec_in norm=1.515486)
[S6] cosine check vs S8: cos=0.6378
[S6] BUFFERED delta from S8 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1805) from S6
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.101685)
[S15] loaded HEAD from S6 (vec_in norm=1.101685)
[S15] cosine check vs S6: cos=0.9470
[S15] BUFFERED delta from S6 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1803) from S7
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.651347)
[S6] loaded HEAD from S7 (vec_in norm=1.651347)
[S6] cosine check vs S7: cos=0.6995
[S6] BUFFERED delta from S7 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:62405
[S17] sending update (kind=head size=1798 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1798) from S17
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.195055)
[S5] loaded HEAD from S17 (vec_in norm=1.195055)
[S5] cosine check vs S17: cos=0.5420
[S5] BUFFERED delta from S17 (total buffered=1)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=13 metric=0.5394 head_norm=0.761377
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.194170e-01
[S11] stored merged vector for next round verification (round=13)
[S11] DEBUG after merge:  round=13 metric=0.6290 head_norm=0.768074 delta_norm=0.119417
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=13 metric=0.6675 head_norm=1.002569
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.634521e-01
[S4] stored merged vector for next round verification (round=13)
[S4] DEBUG after merge:  round=13 metric=0.6669 head_norm=0.973785 delta_norm=0.263452
[S4] aggregate: ACCEPT kept=['S10', 'S16'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=13 metric=0.6985 head_norm=1.101669
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.793934e-01
[S15] stored merged vector for next round verification (round=13)
[S15] DEBUG after merge:  round=13 metric=0.6926 head_norm=1.086973 delta_norm=0.179393
[S15] aggregate: ROLLBACK (f1_val pre=0.699 post=0.693 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=13 metric=0.7013 head_norm=0.956623
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.138087e-01
[S9] stored merged vector for next round verification (round=13)
[S9] DEBUG after merge:  round=13 metric=0.7013 head_norm=0.799799 delta_norm=0.513809
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=13 metric=0.7102 head_norm=1.101685
[S6] _apply_head_vector_avg (torch): Δ‖w‖=6.372479e-02
[S6] stored merged vector for next round verification (round=13)
[S6] DEBUG after merge:  round=13 metric=0.7106 head_norm=1.082951 delta_norm=0.063725
[S6] aggregate: ACCEPT kept=['S8', 'S7'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=13 metric=0.7007 head_norm=0.944579
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.236031e-01
[S5] stored merged vector for next round verification (round=13)
[S5] DEBUG after merge:  round=13 metric=0.7006 head_norm=0.941293 delta_norm=0.523603
[S5] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=13 metric=0.6921 head_norm=0.792907
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.824835e-01
[S14] stored merged vector for next round verification (round=13)
[S14] DEBUG after merge:  round=13 metric=0.9940 head_norm=0.762858 delta_norm=0.182483
[S14] aggregate: ACCEPT kept=['S9', 'S15'] (k=2/2) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.583552 (no previous merge yet)
[S2] round=14 local utility u=0.037856 metrics={'f1_val': 0.6769705605454673, 'auprc': 0.7476422110379195, 'loss_val': 0.3863449714498852, 'psi': 0.7052392207424483}-{'f1_val': 0.6847266820193613, 'auprc': 0.6943466250851373, 'loss_val': 0.3487078684468558, 'psi': 0.6885746592456716}
[S3] START round=14 head_norm_before_train=1.796360 (no previous merge yet)
[S3] round=14 local utility u=0.177995 metrics={'f1_val': 0.6030648280490232, 'auprc': 0.9995682889571207, 'loss_val': 0.44644923370607453, 'psi': 0.7616662124122622}-{'f1_val': 0.5656573992345865, 'auprc': 0.9995071806968643, 'loss_val': 0.577810787286777, 'psi': 0.7391973118194977}
[S4] START round=14 head_norm_before_train=0.973785 cos_to_last_merge=1.0000 (last merge round=13)
[S4] round=14 local utility u=0.259888 metrics={'f1_val': 0.6649458915592834, 'auprc': 0.8341905180499847, 'loss_val': 0.5897072663150992, 'psi': 0.7326437421555639}-{'f1_val': 0.6674616434398501, 'auprc': 0.6538177739820394, 'loss_val': 0.5834588510491527, 'psi': 0.6620040956567259}
[S5] START round=14 head_norm_before_train=0.941293 cos_to_last_merge=1.0000 (last merge round=13)
[S5] round=14 local utility u=0.000000 metrics={'f1_val': 0.7143346225523001, 'auprc': 0.7942869723509234, 'loss_val': 0.5199293029278308, 'psi': 0.7463155624717495}-{'f1_val': 0.7007274985363465, 'auprc': 0.869684278419992, 'loss_val': 0.5074966294493447, 'psi': 0.7683102104898047}
[S6] START round=14 head_norm_before_train=1.082951 cos_to_last_merge=1.0000 (last merge round=13)
[S6] round=14 local utility u=0.007380 metrics={'f1_val': 0.7095899298305519, 'auprc': 0.8046967039297506, 'loss_val': 0.5543242762397776, 'psi': 0.7476326394702314}-{'f1_val': 0.7101911874063502, 'auprc': 0.8037246331146555, 'loss_val': 0.5697763232349378, 'psi': 0.7476045656896724}
[S7] START round=14 head_norm_before_train=1.651347 (no previous merge yet)
[S7] round=14 local utility u=0.000000 metrics={'f1_val': 0.4797079096613141, 'auprc': 0.7803433147030162, 'loss_val': 0.9152118209111156, 'psi': 0.599962071677995}-{'f1_val': 0.6956416676285265, 'auprc': 0.891347175533227, 'loss_val': 0.2996745810313377, 'psi': 0.7739238707904067}
[S8] START round=14 head_norm_before_train=1.515486 (no previous merge yet)
[S8] round=14 local utility u=0.000000 metrics={'f1_val': 0.7112611832103828, 'auprc': 0.996626698346463, 'loss_val': 0.4747815882223393, 'psi': 0.8254073892648148}-{'f1_val': 0.7136006124744415, 'auprc': 0.9987526169939128, 'loss_val': 0.3704091171609364, 'psi': 0.8276614142822301}
[S9] START round=14 head_norm_before_train=0.799799 cos_to_last_merge=1.0000 (last merge round=13)
[S9] round=14 local utility u=0.004001 metrics={'f1_val': 0.7012888352718426, 'auprc': 0.9978155262977672, 'loss_val': 0.35389348594426967, 'psi': 0.8198995116822125}-{'f1_val': 0.7012888352718426, 'auprc': 0.9976458802598692, 'loss_val': 0.3613874467088944, 'psi': 0.8198316532670533}
[S10] START round=14 head_norm_before_train=1.248055 cos_to_last_merge=0.8476 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.848
[S10] round=14 local utility u=0.000000 metrics={'f1_val': 0.5007321781163684, 'auprc': 0.8648892855314994, 'loss_val': 0.4386923075288091, 'psi': 0.6463950210824208}-{'f1_val': 0.6928136612166707, 'auprc': 0.9919547360494109, 'loss_val': 0.3001037797270029, 'psi': 0.8124700911497668}
[S11] START round=14 head_norm_before_train=0.768074 cos_to_last_merge=1.0000 (last merge round=13)
[S11] round=14 local utility u=0.395550 metrics={'f1_val': 0.6591122605145665, 'auprc': 0.981683847499505, 'loss_val': 0.7765853201048823, 'psi': 0.7881408953085419}-{'f1_val': 0.5393515840952465, 'auprc': 0.9939130003625124, 'loss_val': 0.8858090073797633, 'psi': 0.7211761506021528}
[S13] START round=14 head_norm_before_train=1.550815 (no previous merge yet)
[S13] round=14 local utility u=0.000000 metrics={'f1_val': 0.6527713117051104, 'auprc': 0.7537230298015657, 'loss_val': 0.4855075596788274, 'psi': 0.6931519989436925}-{'f1_val': 0.6592960607812268, 'auprc': 0.7554415342762604, 'loss_val': 0.47526226966430635, 'psi': 0.6977542501792402}
[S14] START round=14 head_norm_before_train=0.762858 cos_to_last_merge=1.0000 (last merge round=13)
[S14] round=14 local utility u=0.962056 metrics={'f1_val': 0.9954909174203047, 'auprc': 0.9960976378476522, 'loss_val': 0.6811586190161956, 'psi': 0.9957336055912437}-{'f1_val': 0.6921021147308503, 'auprc': 0.9938695699437224, 'loss_val': 0.7782531531345006, 'psi': 0.8128090968159991}
[S15] START round=14 head_norm_before_train=1.086973 cos_to_last_merge=1.0000 (last merge round=13)
[S15] round=14 local utility u=0.639783 metrics={'f1_val': 0.792491326949247, 'auprc': 0.9959059589748244, 'loss_val': 0.5572893037990662, 'psi': 0.8738571797594779}-{'f1_val': 0.6985085565078436, 'auprc': 0.7998154383093448, 'loss_val': 0.6846879188871939, 'psi': 0.7390313092284441}
[S16] START round=14 head_norm_before_train=1.566746 (no previous merge yet)
[S16] round=14 local utility u=0.414860 metrics={'f1_val': 0.8556626029538758, 'auprc': 0.8512928188388725, 'loss_val': 0.5720457400465024, 'psi': 0.8539146893078744}-{'f1_val': 0.7651937050737756, 'auprc': 0.795324839449145, 'loss_val': 0.6910493867047082, 'psi': 0.7772461588239234}
[S17] START round=14 head_norm_before_train=1.195055 cos_to_last_merge=0.7863 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.786
[S17] round=14 local utility u=0.065417 metrics={'f1_val': 0.39140265680938724, 'auprc': 0.7367244388595086, 'loss_val': 0.6893839822870081, 'psi': 0.5295313696294357}-{'f1_val': 0.38354778001373135, 'auprc': 0.7260217230325545, 'loss_val': 0.7409801828840207, 'psi': 0.5205373572212606}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:62405
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:62407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:62414
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:62404
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:62414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:62402
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:62412
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:62410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:62415
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1800) from S2
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.615309)
[S6] loaded HEAD from S2 (vec_in norm=1.615309)
[S6] cosine check vs S2: cos=-0.0491
[S6] DROPPED delta from S2 (cos=-0.0491 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1801) from S4
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.018929)
[S5] loaded HEAD from S4 (vec_in norm=1.018929)
[S5] cosine check vs S4: cos=0.5432
[S5] BUFFERED delta from S4 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1798) from S3
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.819687)
[S2] loaded HEAD from S3 (vec_in norm=1.819687)
[S2] cosine check vs S3: cos=-0.0458
[S2] DROPPED delta from S3 (cos=-0.0458 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1799) from S6
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.113611)
[S15] loaded HEAD from S6 (vec_in norm=1.113611)
[S15] cosine check vs S6: cos=0.9705
[S15] BUFFERED delta from S6 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1801) from S14
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.811263)
[S11] loaded HEAD from S14 (vec_in norm=0.811263)
[S11] cosine check vs S14: cos=0.9523
[S11] BUFFERED delta from S14 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1797) from S16
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.601706)
[S4] loaded HEAD from S16 (vec_in norm=1.601706)
[S4] cosine check vs S16: cos=0.5837
[S4] BUFFERED delta from S16 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1800) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.123883)
[S14] loaded HEAD from S15 (vec_in norm=1.123883)
[S14] cosine check vs S15: cos=0.7788
[S14] BUFFERED delta from S15 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1799) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.901949)
[S14] loaded HEAD from S9 (vec_in norm=0.901949)
[S14] cosine check vs S9: cos=0.5498
[S14] BUFFERED delta from S9 (total buffered=2)
[S9] RECEIVED delta(kind=head bytes=1799) from S11
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=0.814430)
[S9] loaded HEAD from S11 (vec_in norm=0.814430)
[S9] cosine check vs S11: cos=0.5267
[S9] BUFFERED delta from S11 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S17] → sending delta(kind=head bytes=1792) to S5@127.0.0.1:62405
[S17] sending update (kind=head size=1792 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1792) from S17
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.216448)
[S5] loaded HEAD from S17 (vec_in norm=1.216448)
[S5] cosine check vs S17: cos=0.8773
[S5] BUFFERED delta from S17 (total buffered=2)
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=14 metric=0.7143 head_norm=1.015523
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.148384e-01
[S5] stored merged vector for next round verification (round=14)
[S5] DEBUG after merge:  round=14 metric=0.7142 head_norm=0.932244 delta_norm=0.214838
[S5] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=14 metric=0.6591 head_norm=0.814430
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.255870e-01
[S11] stored merged vector for next round verification (round=14)
[S11] DEBUG after merge:  round=14 metric=0.5841 head_norm=0.803088 delta_norm=0.125587
[S11] aggregate: ROLLBACK (f1_val pre=0.659 post=0.584 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=14 metric=0.9955 head_norm=0.811263
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.691195e-01
[S14] stored merged vector for next round verification (round=14)
[S14] DEBUG after merge:  round=14 metric=0.9962 head_norm=0.764716 delta_norm=0.169120
[S14] aggregate: ACCEPT kept=['S15', 'S9'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=14 metric=0.7013 head_norm=0.901949
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.192063e-01
[S9] stored merged vector for next round verification (round=14)
[S9] DEBUG after merge:  round=14 metric=0.7013 head_norm=0.750114 delta_norm=0.419206
[S9] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=14 metric=0.7925 head_norm=1.123883
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.358528e-01
[S15] stored merged vector for next round verification (round=14)
[S15] DEBUG after merge:  round=14 metric=0.7688 head_norm=1.110480 delta_norm=0.135853
[S15] aggregate: ROLLBACK (f1_val pre=0.792 post=0.769 tol_abs=0.005 tol_rel=0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=14 metric=0.6649 head_norm=1.018929
[S4] _apply_head_vector_avg (torch): Δ‖w‖=6.516113e-01
[S4] stored merged vector for next round verification (round=14)
[S4] DEBUG after merge:  round=14 metric=0.6652 head_norm=1.173559 delta_norm=0.651611
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.615309 (no previous merge yet)
[S2] round=15 local utility u=0.123372 metrics={'f1_val': 0.6867090332556005, 'auprc': 0.7893535280514976, 'loss_val': 0.32316510913525764, 'psi': 0.7277668311739593}-{'f1_val': 0.6769705605454673, 'auprc': 0.7476422110379195, 'loss_val': 0.3863449714498852, 'psi': 0.7052392207424483}
[S3] START round=15 head_norm_before_train=1.819687 (no previous merge yet)
[S3] round=15 local utility u=0.106057 metrics={'f1_val': 0.6247730443666678, 'auprc': 0.9993894906644293, 'loss_val': 0.36404824766342303, 'psi': 0.7746196228857725}-{'f1_val': 0.6030648280490232, 'auprc': 0.9995682889571207, 'loss_val': 0.44644923370607453, 'psi': 0.7616662124122622}
[S4] START round=15 head_norm_before_train=1.173559 cos_to_last_merge=1.0000 (last merge round=14)
[S4] round=15 local utility u=0.000000 metrics={'f1_val': 0.664990067132381, 'auprc': 0.6502132050131092, 'loss_val': 0.7087621419721082, 'psi': 0.6590793222846723}-{'f1_val': 0.6649458915592834, 'auprc': 0.8341905180499847, 'loss_val': 0.5897072663150992, 'psi': 0.7326437421555639}
[S5] START round=15 head_norm_before_train=0.932244 cos_to_last_merge=1.0000 (last merge round=14)
[S5] round=15 local utility u=0.085974 metrics={'f1_val': 0.7077514338154652, 'auprc': 0.8419852010398612, 'loss_val': 0.45157763361087017, 'psi': 0.7614449407052236}-{'f1_val': 0.7143346225523001, 'auprc': 0.7942869723509234, 'loss_val': 0.5199293029278308, 'psi': 0.7463155624717495}
[S6] START round=15 head_norm_before_train=1.113611 cos_to_last_merge=0.9991 (last merge round=13)
[S6] round=15 local utility u=0.278364 metrics={'f1_val': 0.7101942583316938, 'auprc': 0.955918619619313, 'loss_val': 0.4548877292569962, 'psi': 0.8084840028467415}-{'f1_val': 0.7095899298305519, 'auprc': 0.8046967039297506, 'loss_val': 0.5543242762397776, 'psi': 0.7476326394702314}
[S7] START round=15 head_norm_before_train=1.654648 (no previous merge yet)
[S7] round=15 local utility u=0.367610 metrics={'f1_val': 0.5713798516558528, 'auprc': 0.7833191093944133, 'loss_val': 0.7389502312632614, 'psi': 0.656155554751277}-{'f1_val': 0.4797079096613141, 'auprc': 0.7803433147030162, 'loss_val': 0.9152118209111156, 'psi': 0.599962071677995}
[S8] START round=15 head_norm_before_train=1.537850 (no previous merge yet)
[S8] round=15 local utility u=0.108151 metrics={'f1_val': 0.7137586021136586, 'auprc': 0.9987338212916135, 'loss_val': 0.2797850331995221, 'psi': 0.8277486897848405}-{'f1_val': 0.7112611832103828, 'auprc': 0.996626698346463, 'loss_val': 0.4747815882223393, 'psi': 0.8254073892648148}
[S9] START round=15 head_norm_before_train=0.750114 cos_to_last_merge=1.0000 (last merge round=14)
[S9] round=15 local utility u=0.014664 metrics={'f1_val': 0.7012888352718426, 'auprc': 0.9979774897967072, 'loss_val': 0.32505140453267384, 'psi': 0.8199642970817884}-{'f1_val': 0.7012888352718426, 'auprc': 0.9978155262977672, 'loss_val': 0.35389348594426967, 'psi': 0.8198995116822125}
[S10] START round=15 head_norm_before_train=1.288388 cos_to_last_merge=0.8383 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.838
[S10] round=15 local utility u=0.454796 metrics={'f1_val': 0.5860969156102881, 'auprc': 0.957487508679403, 'loss_val': 0.3190841551027276, 'psi': 0.7346531528379341}-{'f1_val': 0.5007321781163684, 'auprc': 0.8648892855314994, 'loss_val': 0.4386923075288091, 'psi': 0.6463950210824208}
[S11] START round=15 head_norm_before_train=0.803088 cos_to_last_merge=1.0000 (last merge round=14)
[S11] round=15 local utility u=0.550212 metrics={'f1_val': 0.8266538964145211, 'auprc': 0.9951076463375264, 'loss_val': 0.7216823730761698, 'psi': 0.8940353963837232}-{'f1_val': 0.6591122605145665, 'auprc': 0.981683847499505, 'loss_val': 0.7765853201048823, 'psi': 0.7881408953085419}
[S13] START round=15 head_norm_before_train=1.569768 (no previous merge yet)
[S13] round=15 local utility u=0.255323 metrics={'f1_val': 0.7117076967360673, 'auprc': 0.7821276512885159, 'loss_val': 0.4136945242903227, 'psi': 0.7398756785570467}-{'f1_val': 0.6527713117051104, 'auprc': 0.7537230298015657, 'loss_val': 0.4855075596788274, 'psi': 0.6931519989436925}
[S14] START round=15 head_norm_before_train=0.764716 cos_to_last_merge=1.0000 (last merge round=14)
[S14] round=15 local utility u=0.041933 metrics={'f1_val': 0.9955061906234612, 'auprc': 0.996582366281838, 'loss_val': 0.598838213727272, 'psi': 0.9959366608868119}-{'f1_val': 0.9954909174203047, 'auprc': 0.9960976378476522, 'loss_val': 0.6811586190161956, 'psi': 0.9957336055912437}
[S15] START round=15 head_norm_before_train=1.110480 cos_to_last_merge=1.0000 (last merge round=14)
[S15] round=15 local utility u=0.000000 metrics={'f1_val': 0.6965329175243767, 'auprc': 0.8013995864350816, 'loss_val': 0.6376958636215708, 'psi': 0.7384795850886587}-{'f1_val': 0.792491326949247, 'auprc': 0.9959059589748244, 'loss_val': 0.5572893037990662, 'psi': 0.8738571797594779}
[S16] START round=15 head_norm_before_train=1.601706 (no previous merge yet)
[S16] round=15 local utility u=0.055024 metrics={'f1_val': 0.8229552614191984, 'auprc': 0.9029040854602699, 'loss_val': 0.42058688904540625, 'psi': 0.854934791035627}-{'f1_val': 0.8556626029538758, 'auprc': 0.8512928188388725, 'loss_val': 0.5720457400465024, 'psi': 0.8539146893078744}
[S17] START round=15 head_norm_before_train=1.216448 cos_to_last_merge=0.7772 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.777
[S17] round=15 local utility u=0.032621 metrics={'f1_val': 0.39132692561017035, 'auprc': 0.7541756566730531, 'loss_val': 0.6760420364806518, 'psi': 0.5364664180353235}-{'f1_val': 0.39140265680938724, 'auprc': 0.7367244388595086, 'loss_val': 0.6893839822870081, 'psi': 0.5295313696294357}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:62407
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:62404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:62407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:62412
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:62410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:62414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S16] → sending delta(kind=head bytes=1792) to S4@127.0.0.1:62404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S13] → sending delta(kind=head bytes=1790) to S9@127.0.0.1:62410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:62407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:62410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:62415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:62402
[S14] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1804 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1804 to 1 peers)
[S13] sending update (kind=head size=1790 to 1 peers)
[S16] sending update (kind=head size=1792 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1798) from S3
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.848963)
[S2] loaded HEAD from S3 (vec_in norm=1.848963)
[S2] cosine check vs S3: cos=-0.0458
[S2] DROPPED delta from S3 (cos=-0.0458 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1790) from S13
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.580412)
[S9] loaded HEAD from S13 (vec_in norm=1.580412)
[S9] cosine check vs S13: cos=0.4072
[S9] BUFFERED delta from S13 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1796) from S6
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.152123)
[S15] loaded HEAD from S6 (vec_in norm=1.152123)
[S15] cosine check vs S6: cos=0.9817
[S15] BUFFERED delta from S6 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1798) from S11
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=0.846609)
[S9] loaded HEAD from S11 (vec_in norm=0.846609)
[S9] cosine check vs S11: cos=0.8370
[S9] BUFFERED delta from S11 (total buffered=2)
[S14] RECEIVED delta(kind=head bytes=1801) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.862427)
[S14] loaded HEAD from S9 (vec_in norm=0.862427)
[S14] cosine check vs S9: cos=0.8401
[S14] BUFFERED delta from S9 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1799) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.012033)
[S9] loaded HEAD from S5 (vec_in norm=1.012033)
[S9] cosine check vs S5: cos=0.4752
[S9] BUFFERED delta from S5 (total buffered=3)
[S4] RECEIVED delta(kind=head bytes=1792) from S16
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.634480)
[S4] loaded HEAD from S16 (vec_in norm=1.634480)
[S4] cosine check vs S16: cos=0.9145
[S4] BUFFERED delta from S16 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1800) from S10
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.322886)
[S4] loaded HEAD from S10 (vec_in norm=1.322886)
[S4] cosine check vs S10: cos=0.4064
[S4] BUFFERED delta from S10 (total buffered=2)
[S6] RECEIVED delta(kind=head bytes=1804) from S8
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.556459)
[S6] loaded HEAD from S8 (vec_in norm=1.556459)
[S6] cosine check vs S8: cos=0.6343
[S6] BUFFERED delta from S8 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1804) from S7
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.661506)
[S6] loaded HEAD from S7 (vec_in norm=1.661506)
[S6] cosine check vs S7: cos=0.6972
[S6] BUFFERED delta from S7 (total buffered=2)
[S6] RECEIVED delta(kind=head bytes=1799) from S2
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.643353)
[S6] loaded HEAD from S2 (vec_in norm=1.643353)
[S6] cosine check vs S2: cos=-0.0519
[S6] DROPPED delta from S2 (cos=-0.0519 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1797) from S14
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.815855)
[S11] loaded HEAD from S14 (vec_in norm=0.815855)
[S11] cosine check vs S14: cos=0.9534
[S11] BUFFERED delta from S14 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:62405
[S17] sending update (kind=head size=1800 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1800) from S17
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.231572)
[S5] loaded HEAD from S17 (vec_in norm=1.231572)
[S5] cosine check vs S17: cos=0.8522
[S5] BUFFERED delta from S17 (total buffered=1)
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=15 metric=0.6650 head_norm=1.199596
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.849544e-01
[S4] stored merged vector for next round verification (round=15)
[S4] DEBUG after merge:  round=15 metric=0.6643 head_norm=1.119469 delta_norm=0.184954
[S4] aggregate: ACCEPT kept=['S16', 'S10'] (k=2/2) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.209 → S5@127.0.0.1:62405
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=15 metric=0.8267 head_norm=0.846609
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.277428e-01
[S11] stored merged vector for next round verification (round=15)
[S11] DEBUG after merge:  round=15 metric=0.6747 head_norm=0.821502 delta_norm=0.127743
[S11] aggregate: ROLLBACK (f1_val pre=0.827 post=0.675 tol_abs=0.005 tol_rel=0.0)
[S11] ⇄ pheromone p=0.373 → S9@127.0.0.1:62410
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=15 metric=0.7078 head_norm=1.012033
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.227206e-01
[S5] stored merged vector for next round verification (round=15)
[S5] DEBUG after merge:  round=15 metric=0.7073 head_norm=1.079973 delta_norm=0.322721
[S5] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.131 → S9@127.0.0.1:62410
[S2] ⇄ pheromone p=0.144 → S6@127.0.0.1:62407
[S9] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=15 metric=0.7013 head_norm=0.862427
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.311625e-01
[S9] stored merged vector for next round verification (round=15)
[S9] DEBUG after merge:  round=15 metric=0.7013 head_norm=0.762948 delta_norm=0.231163
[S9] aggregate: ACCEPT kept=['S13', 'S11', 'S5'] (k=3/3) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.063 → S14@127.0.0.1:62414
[S16] ⇄ pheromone p=0.281 → S4@127.0.0.1:62404
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=15 metric=0.7102 head_norm=1.152123
[S6] _apply_head_vector_avg (torch): Δ‖w‖=8.433561e-02
[S6] stored merged vector for next round verification (round=15)
[S6] DEBUG after merge:  round=15 metric=0.7103 head_norm=1.114962 delta_norm=0.084336
[S6] aggregate: ACCEPT kept=['S8', 'S7'] (k=2/2) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.284 → S15@127.0.0.1:62415
[S3] ⇄ pheromone p=0.179 → S2@127.0.0.1:62402
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=15 metric=0.9955 head_norm=0.815855
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.383488e-01
[S14] stored merged vector for next round verification (round=15)
[S14] DEBUG after merge:  round=15 metric=0.9726 head_norm=0.804916 delta_norm=0.238349
[S14] aggregate: ROLLBACK (f1_val pre=0.996 post=0.973 tol_abs=0.005 tol_rel=0.0)
[S14] ⇄ pheromone p=0.387 → S11@127.0.0.1:62412
[S8] ⇄ pheromone p=0.211 → S6@127.0.0.1:62407
[S7] ⇄ pheromone p=0.251 → S6@127.0.0.1:62407
[S10] ⇄ pheromone p=0.273 → S4@127.0.0.1:62404
[S13] ⇄ pheromone p=0.225 → S9@127.0.0.1:62410
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=15 metric=0.6965 head_norm=1.145455
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.097924e-01
[S15] stored merged vector for next round verification (round=15)
[S15] DEBUG after merge:  round=15 metric=0.6953 head_norm=1.143535 delta_norm=0.109792
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.258 → S14@127.0.0.1:62414
[S17] ⇄ pheromone p=0.131 → S5@127.0.0.1:62405
[S2] START round=16 head_norm_before_train=1.643353 (no previous merge yet)
[S2] round=16 local utility u=0.041450 metrics={'f1_val': 0.6995078406626564, 'auprc': 0.7772215356932981, 'loss_val': 0.28066244739227014, 'psi': 0.7305933186749132}-{'f1_val': 0.6867090332556005, 'auprc': 0.7893535280514976, 'loss_val': 0.32316510913525764, 'psi': 0.7277668311739593}
[S3] START round=16 head_norm_before_train=1.848963 (no previous merge yet)
[S3] round=16 local utility u=0.000000 metrics={'f1_val': 0.6253959032581979, 'auprc': 0.9991129446134805, 'loss_val': 0.3776234130112401, 'psi': 0.774882719800311}-{'f1_val': 0.6247730443666678, 'auprc': 0.9993894906644293, 'loss_val': 0.36404824766342303, 'psi': 0.7746196228857725}
[S4] START round=16 head_norm_before_train=1.119469 cos_to_last_merge=1.0000 (last merge round=15)
[S4] round=16 local utility u=0.051397 metrics={'f1_val': 0.663740781006426, 'auprc': 0.6492092126244513, 'loss_val': 0.5954594713929562, 'psi': 0.6579281536536361}-{'f1_val': 0.664990067132381, 'auprc': 0.6502132050131092, 'loss_val': 0.7087621419721082, 'psi': 0.6590793222846723}
[S5] START round=16 head_norm_before_train=1.079973 cos_to_last_merge=1.0000 (last merge round=15)
[S5] round=16 local utility u=0.000000 metrics={'f1_val': 0.7135214672258634, 'auprc': 0.8011544516149857, 'loss_val': 0.45758429791614225, 'psi': 0.7485746609815123}-{'f1_val': 0.7077514338154652, 'auprc': 0.8419852010398612, 'loss_val': 0.45157763361087017, 'psi': 0.7614449407052236}
[S6] START round=16 head_norm_before_train=1.114962 cos_to_last_merge=1.0000 (last merge round=15)
[S6] round=16 local utility u=0.000000 metrics={'f1_val': 0.6562235202821147, 'auprc': 0.7885015212975632, 'loss_val': 0.5571541355721009, 'psi': 0.7091347206882941}-{'f1_val': 0.7101942583316938, 'auprc': 0.955918619619313, 'loss_val': 0.4548877292569962, 'psi': 0.8084840028467415}
[S7] START round=16 head_norm_before_train=1.661506 (no previous merge yet)
[S7] round=16 local utility u=0.000000 metrics={'f1_val': 0.5302710851053622, 'auprc': 0.781642984964842, 'loss_val': 0.8712657877412889, 'psi': 0.6308198450491542}-{'f1_val': 0.5713798516558528, 'auprc': 0.7833191093944133, 'loss_val': 0.7389502312632614, 'psi': 0.656155554751277}
[S8] START round=16 head_norm_before_train=1.556459 (no previous merge yet)
[S8] round=16 local utility u=0.000000 metrics={'f1_val': 0.7008853887744474, 'auprc': 0.9961775494731233, 'loss_val': 0.3294933283360586, 'psi': 0.8190022530539178}-{'f1_val': 0.7137586021136586, 'auprc': 0.9987338212916135, 'loss_val': 0.2797850331995221, 'psi': 0.8277486897848405}
[S9] START round=16 head_norm_before_train=0.762948 cos_to_last_merge=1.0000 (last merge round=15)
[S9] round=16 local utility u=0.013445 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9982273465126966, 'loss_val': 0.2989207703220378, 'psi': 0.8200652287296167}-{'f1_val': 0.7012888352718426, 'auprc': 0.9979774897967072, 'loss_val': 0.32505140453267384, 'psi': 0.8199642970817884}
[S10] START round=16 head_norm_before_train=1.322886 cos_to_last_merge=0.8309 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.831
[S10] round=16 local utility u=1.000000 metrics={'f1_val': 0.9933012426452782, 'auprc': 0.9977203233742806, 'loss_val': 0.16414774258190779, 'psi': 0.9950688749368791}-{'f1_val': 0.5860969156102881, 'auprc': 0.957487508679403, 'loss_val': 0.3190841551027276, 'psi': 0.7346531528379341}
[S11] START round=16 head_norm_before_train=0.821502 cos_to_last_merge=1.0000 (last merge round=15)
[S11] round=16 local utility u=0.294350 metrics={'f1_val': 0.9066072073072222, 'auprc': 0.9983250528054035, 'loss_val': 0.6223554362429536, 'psi': 0.9432943455064947}-{'f1_val': 0.8266538964145211, 'auprc': 0.9951076463375264, 'loss_val': 0.7216823730761698, 'psi': 0.8940353963837232}
[S13] START round=16 head_norm_before_train=1.580412 (no previous merge yet)
[S13] round=16 local utility u=0.000000 metrics={'f1_val': 0.6513250438932552, 'auprc': 0.7570112860231937, 'loss_val': 0.5000227789953885, 'psi': 0.6935995407452306}-{'f1_val': 0.7117076967360673, 'auprc': 0.7821276512885159, 'loss_val': 0.4136945242903227, 'psi': 0.7398756785570467}
[S14] START round=16 head_norm_before_train=0.804916 cos_to_last_merge=1.0000 (last merge round=15)
[S14] round=16 local utility u=0.042270 metrics={'f1_val': 0.9960521644678674, 'auprc': 0.9925670237557338, 'loss_val': 0.5055281696034739, 'psi': 0.9946581081830139}-{'f1_val': 0.9955061906234612, 'auprc': 0.996582366281838, 'loss_val': 0.598838213727272, 'psi': 0.9959366608868119}
[S15] START round=16 head_norm_before_train=1.143535 cos_to_last_merge=1.0000 (last merge round=15)
[S15] round=16 local utility u=0.229889 metrics={'f1_val': 0.7013069258635699, 'auprc': 0.9066664049248677, 'loss_val': 0.5223615283685403, 'psi': 0.783450717488089}-{'f1_val': 0.6965329175243767, 'auprc': 0.8013995864350816, 'loss_val': 0.6376958636215708, 'psi': 0.7384795850886587}
[S16] START round=16 head_norm_before_train=1.634480 (no previous merge yet)
[S16] round=16 local utility u=0.262205 metrics={'f1_val': 0.9016757274543024, 'auprc': 0.9234688378508488, 'loss_val': 0.4301937647434145, 'psi': 0.9103929716129209}-{'f1_val': 0.8229552614191984, 'auprc': 0.9029040854602699, 'loss_val': 0.42058688904540625, 'psi': 0.854934791035627}
[S17] START round=16 head_norm_before_train=1.231572 cos_to_last_merge=0.7707 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.771
[S17] round=16 local utility u=0.212370 metrics={'f1_val': 0.3912802631867732, 'auprc': 0.8955490391013325, 'loss_val': 0.6751413554323611, 'psi': 0.592987773552597}-{'f1_val': 0.39132692561017035, 'auprc': 0.7541756566730531, 'loss_val': 0.6760420364806518, 'psi': 0.5364664180353235}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:62405
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:62404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:62414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:62407
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:62412
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:62404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:62414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:62410
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1804 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1799) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.176864)
[S14] loaded HEAD from S15 (vec_in norm=1.176864)
[S14] cosine check vs S15: cos=0.5865
[S14] BUFFERED delta from S15 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1797) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.865928)
[S14] loaded HEAD from S9 (vec_in norm=0.865928)
[S14] cosine check vs S9: cos=0.9207
[S14] BUFFERED delta from S9 (total buffered=2)
[S4] RECEIVED delta(kind=head bytes=1799) from S16
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.669468)
[S4] loaded HEAD from S16 (vec_in norm=1.669468)
[S4] cosine check vs S16: cos=0.8371
[S4] BUFFERED delta from S16 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1802) from S14
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.859206)
[S11] loaded HEAD from S14 (vec_in norm=0.859206)
[S11] cosine check vs S14: cos=0.9578
[S11] BUFFERED delta from S14 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1804) from S11
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=0.867526)
[S9] loaded HEAD from S11 (vec_in norm=0.867526)
[S9] cosine check vs S11: cos=0.8155
[S9] BUFFERED delta from S11 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1798) from S10
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.351841)
[S4] loaded HEAD from S10 (vec_in norm=1.351841)
[S4] cosine check vs S10: cos=0.5520
[S4] BUFFERED delta from S10 (total buffered=2)
[S5] RECEIVED delta(kind=head bytes=1802) from S4
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.155813)
[S5] loaded HEAD from S4 (vec_in norm=1.155813)
[S5] cosine check vs S4: cos=0.4582
[S5] BUFFERED delta from S4 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1802) from S2
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.664999)
[S6] loaded HEAD from S2 (vec_in norm=1.664999)
[S6] cosine check vs S2: cos=-0.0562
[S6] DROPPED delta from S2 (cos=-0.0562 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:62405
[S17] sending update (kind=head size=1799 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1799) from S17
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.241777)
[S5] loaded HEAD from S17 (vec_in norm=1.241777)
[S5] cosine check vs S17: cos=0.9469
[S5] BUFFERED delta from S17 (total buffered=2)
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=16 metric=0.6637 head_norm=1.155813
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.036867e-01
[S4] stored merged vector for next round verification (round=16)
[S4] DEBUG after merge:  round=16 metric=0.6634 head_norm=1.117863 delta_norm=0.103687
[S4] aggregate: ACCEPT kept=['S16', 'S10'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=16 metric=0.9066 head_norm=0.867526
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.255167e-01
[S11] stored merged vector for next round verification (round=16)
[S11] DEBUG after merge:  round=16 metric=0.9537 head_norm=0.854204 delta_norm=0.125517
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=16 metric=0.7013 head_norm=0.865928
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.632663e-01
[S9] stored merged vector for next round verification (round=16)
[S9] DEBUG after merge:  round=16 metric=0.9900 head_norm=0.825777 delta_norm=0.263266
[S9] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=16 metric=0.9961 head_norm=0.859206
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.006175e-01
[S14] stored merged vector for next round verification (round=16)
[S14] DEBUG after merge:  round=16 metric=0.9956 head_norm=0.824177 delta_norm=0.200617
[S14] aggregate: ACCEPT kept=['S15', 'S9'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=16 metric=0.7135 head_norm=1.156102
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.811472e-01
[S5] stored merged vector for next round verification (round=16)
[S5] DEBUG after merge:  round=16 metric=0.7126 head_norm=1.031904 delta_norm=0.281147
[S5] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.664999 (no previous merge yet)
[S2] round=17 local utility u=0.000000 metrics={'f1_val': 0.6796779087191402, 'auprc': 0.7491327147806295, 'loss_val': 0.35311182717890105, 'psi': 0.7074598311437359}-{'f1_val': 0.6995078406626564, 'auprc': 0.7772215356932981, 'loss_val': 0.28066244739227014, 'psi': 0.7305933186749132}
[S3] START round=17 head_norm_before_train=1.882770 (no previous merge yet)
[S3] round=17 local utility u=0.720590 metrics={'f1_val': 0.8686183684255262, 'auprc': 0.9958052614453803, 'loss_val': 0.38585515888874644, 'psi': 0.9194931256334677}-{'f1_val': 0.6253959032581979, 'auprc': 0.9991129446134805, 'loss_val': 0.3776234130112401, 'psi': 0.774882719800311}
[S4] START round=17 head_norm_before_train=1.117863 cos_to_last_merge=1.0000 (last merge round=16)
[S4] round=17 local utility u=0.032816 metrics={'f1_val': 0.6660360053914248, 'auprc': 0.6500150832773235, 'loss_val': 0.5460171561979597, 'psi': 0.6596276365457843}-{'f1_val': 0.663740781006426, 'auprc': 0.6492092126244513, 'loss_val': 0.5954594713929562, 'psi': 0.6579281536536361}
[S5] START round=17 head_norm_before_train=1.031904 cos_to_last_merge=1.0000 (last merge round=16)
[S5] round=17 local utility u=0.307559 metrics={'f1_val': 0.7003603281361598, 'auprc': 0.9970240549528854, 'loss_val': 0.3511079432567938, 'psi': 0.8190258188628501}-{'f1_val': 0.7135214672258634, 'auprc': 0.8011544516149857, 'loss_val': 0.45758429791614225, 'psi': 0.7485746609815123}
[S6] START round=17 head_norm_before_train=1.153139 cos_to_last_merge=0.9989 (last merge round=15)
[S6] round=17 local utility u=0.479387 metrics={'f1_val': 0.709692427219619, 'auprc': 0.9500709525646318, 'loss_val': 0.4039010787544884, 'psi': 0.8058438373576241}-{'f1_val': 0.6562235202821147, 'auprc': 0.7885015212975632, 'loss_val': 0.5571541355721009, 'psi': 0.7091347206882941}
[S7] START round=17 head_norm_before_train=1.671155 (no previous merge yet)
[S7] round=17 local utility u=0.705322 metrics={'f1_val': 0.6713376568015027, 'auprc': 0.8180040612531876, 'loss_val': 0.41610357152803273, 'psi': 0.7300042185821767}-{'f1_val': 0.5302710851053622, 'auprc': 0.781642984964842, 'loss_val': 0.8712657877412889, 'psi': 0.6308198450491542}
[S8] START round=17 head_norm_before_train=1.581718 (no previous merge yet)
[S8] round=17 local utility u=0.956732 metrics={'f1_val': 0.9957130441636828, 'auprc': 0.9986066429721024, 'loss_val': 0.19228305120486472, 'psi': 0.9968704836870507}-{'f1_val': 0.7008853887744474, 'auprc': 0.9961775494731233, 'loss_val': 0.3294933283360586, 'psi': 0.8190022530539178}
[S9] START round=17 head_norm_before_train=0.825777 cos_to_last_merge=1.0000 (last merge round=16)
[S9] round=17 local utility u=0.886881 metrics={'f1_val': 0.9912441468948172, 'auprc': 0.9982566443770808, 'loss_val': 0.2649688278475219, 'psi': 0.9940491458877228}-{'f1_val': 0.7012904835408967, 'auprc': 0.9982273465126966, 'loss_val': 0.2989207703220378, 'psi': 0.8200652287296167}
[S10] START round=17 head_norm_before_train=1.351841 cos_to_last_merge=0.8252 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.825
[S10] round=17 local utility u=0.000000 metrics={'f1_val': 0.9197020462944911, 'auprc': 0.9933468096863952, 'loss_val': 0.2525242728392787, 'psi': 0.9491599516512528}-{'f1_val': 0.9933012426452782, 'auprc': 0.9977203233742806, 'loss_val': 0.16414774258190779, 'psi': 0.9950688749368791}
[S11] START round=17 head_norm_before_train=0.854204 cos_to_last_merge=1.0000 (last merge round=16)
[S11] round=17 local utility u=0.089561 metrics={'f1_val': 0.9162235958528605, 'auprc': 0.9971147402839744, 'loss_val': 0.4973011932742713, 'psi': 0.9485800536253061}-{'f1_val': 0.9066072073072222, 'auprc': 0.9983250528054035, 'loss_val': 0.6223554362429536, 'psi': 0.9432943455064947}
[S13] START round=17 head_norm_before_train=1.588486 (no previous merge yet)
[S13] round=17 local utility u=0.000000 metrics={'f1_val': 0.6043158575897002, 'auprc': 0.7609960522075564, 'loss_val': 0.5380419386743848, 'psi': 0.6669879354368426}-{'f1_val': 0.6513250438932552, 'auprc': 0.7570112860231937, 'loss_val': 0.5000227789953885, 'psi': 0.6935995407452306}
[S14] START round=17 head_norm_before_train=0.824177 cos_to_last_merge=1.0000 (last merge round=16)
[S14] round=17 local utility u=0.035379 metrics={'f1_val': 0.9941868848738158, 'auprc': 0.9975638417790944, 'loss_val': 0.4385683702291389, 'psi': 0.9955376676359272}-{'f1_val': 0.9960521644678674, 'auprc': 0.9925670237557338, 'loss_val': 0.5055281696034739, 'psi': 0.9946581081830139}
[S15] START round=17 head_norm_before_train=1.176864 cos_to_last_merge=0.9976 (last merge round=15)
[S15] round=17 local utility u=0.431448 metrics={'f1_val': 0.7829209369579875, 'auprc': 0.9887634739860429, 'loss_val': 0.39544128954009283, 'psi': 0.8652579517692096}-{'f1_val': 0.7013069258635699, 'auprc': 0.9066664049248677, 'loss_val': 0.5223615283685403, 'psi': 0.783450717488089}
[S16] START round=17 head_norm_before_train=1.669468 (no previous merge yet)
[S16] round=17 local utility u=0.000000 metrics={'f1_val': 0.844520715705422, 'auprc': 0.9286903831140378, 'loss_val': 0.662585142381528, 'psi': 0.8781885826688682}-{'f1_val': 0.9016757274543024, 'auprc': 0.9234688378508488, 'loss_val': 0.4301937647434145, 'psi': 0.9103929716129209}
[S17] START round=17 head_norm_before_train=1.241777 cos_to_last_merge=0.7647 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.765
[S17] round=17 local utility u=0.000000 metrics={'f1_val': 0.391853316404468, 'auprc': 0.7563405184325281, 'loss_val': 0.6673912086008703, 'psi': 0.5376481972156921}-{'f1_val': 0.3912802631867732, 'auprc': 0.8955490391013325, 'loss_val': 0.6751413554323611, 'psi': 0.592987773552597}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:62402
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:62410
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:62414
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:62412
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:62407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:62414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:62415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:62410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] → sending delta(kind=head bytes=1805) to S5@127.0.0.1:62405
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:62407
[S8] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1805 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1797) from S8
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.604442)
[S6] loaded HEAD from S8 (vec_in norm=1.604442)
[S6] cosine check vs S8: cos=0.6369
[S6] BUFFERED delta from S8 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1801) from S3
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.915729)
[S2] loaded HEAD from S3 (vec_in norm=1.915729)
[S2] cosine check vs S3: cos=-0.0465
[S2] DROPPED delta from S3 (cos=-0.0465 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1797) from S6
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.185747)
[S15] loaded HEAD from S6 (vec_in norm=1.185747)
[S15] cosine check vs S6: cos=0.9757
[S15] BUFFERED delta from S6 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1800) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.922402)
[S14] loaded HEAD from S9 (vec_in norm=0.922402)
[S14] cosine check vs S9: cos=0.9360
[S14] BUFFERED delta from S9 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1805) from S4
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.160347)
[S5] loaded HEAD from S4 (vec_in norm=1.160347)
[S5] cosine check vs S4: cos=0.6140
[S5] BUFFERED delta from S4 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1802) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.217313)
[S14] loaded HEAD from S15 (vec_in norm=1.217313)
[S14] cosine check vs S15: cos=0.7405
[S14] BUFFERED delta from S15 (total buffered=2)
[S6] RECEIVED delta(kind=head bytes=1796) from S7
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.679586)
[S6] loaded HEAD from S7 (vec_in norm=1.679586)
[S6] cosine check vs S7: cos=0.6902
[S6] BUFFERED delta from S7 (total buffered=2)
[S9] RECEIVED delta(kind=head bytes=1800) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.110646)
[S9] loaded HEAD from S5 (vec_in norm=1.110646)
[S9] cosine check vs S5: cos=0.3626
[S9] BUFFERED delta from S5 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1798) from S11
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=0.905773)
[S9] loaded HEAD from S11 (vec_in norm=0.905773)
[S9] cosine check vs S11: cos=0.9582
[S9] BUFFERED delta from S11 (total buffered=2)
[S11] RECEIVED delta(kind=head bytes=1798) from S14
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.869418)
[S11] loaded HEAD from S14 (vec_in norm=0.869418)
[S11] cosine check vs S14: cos=0.9699
[S11] BUFFERED delta from S14 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=17 metric=0.9162 head_norm=0.905773
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.103348e-01
[S11] stored merged vector for next round verification (round=17)
[S11] DEBUG after merge:  round=17 metric=0.9153 head_norm=0.880899 delta_norm=0.110335
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=17 metric=0.7829 head_norm=1.217313
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.334962e-01
[S15] stored merged vector for next round verification (round=17)
[S15] DEBUG after merge:  round=17 metric=0.7770 head_norm=1.194195 delta_norm=0.133496
[S15] aggregate: ROLLBACK (f1_val pre=0.783 post=0.777 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=17 metric=0.9912 head_norm=0.922402
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.896077e-01
[S9] stored merged vector for next round verification (round=17)
[S9] DEBUG after merge:  round=17 metric=0.9917 head_norm=0.818475 delta_norm=0.289608
[S9] aggregate: ACCEPT kept=['S5', 'S11'] (k=2/2) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=17 metric=0.7097 head_norm=1.185747
[S6] _apply_head_vector_avg (torch): Δ‖w‖=9.589313e-02
[S6] stored merged vector for next round verification (round=17)
[S6] DEBUG after merge:  round=17 metric=0.8988 head_norm=1.141174 delta_norm=0.095893
[S6] aggregate: ACCEPT kept=['S8', 'S7'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=17 metric=0.9942 head_norm=0.869418
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.402182e-01
[S14] stored merged vector for next round verification (round=17)
[S14] DEBUG after merge:  round=17 metric=0.9971 head_norm=0.887038 delta_norm=0.140218
[S14] aggregate: ACCEPT kept=['S9', 'S15'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=17 metric=0.7004 head_norm=1.110646
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.993407e-01
[S5] stored merged vector for next round verification (round=17)
[S5] DEBUG after merge:  round=17 metric=0.7004 head_norm=1.020112 delta_norm=0.499341
[S5] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.680691 (no previous merge yet)
[S2] round=18 local utility u=0.000000 metrics={'f1_val': 0.678414765785322, 'auprc': 0.6870457725316998, 'loss_val': 0.36817683726570377, 'psi': 0.6818671684838731}-{'f1_val': 0.6796779087191402, 'auprc': 0.7491327147806295, 'loss_val': 0.35311182717890105, 'psi': 0.7074598311437359}
[S3] START round=18 head_norm_before_train=1.915729 (no previous merge yet)
[S3] round=18 local utility u=0.108170 metrics={'f1_val': 0.8822756197471382, 'auprc': 0.9988320257300982, 'loss_val': 0.26053873793377386, 'psi': 0.9288981821403222}-{'f1_val': 0.8686183684255262, 'auprc': 0.9958052614453803, 'loss_val': 0.38585515888874644, 'psi': 0.9194931256334677}
[S4] START round=18 head_norm_before_train=1.160347 cos_to_last_merge=0.9977 (last merge round=16)
[S4] round=18 local utility u=0.033667 metrics={'f1_val': 0.6679594727118736, 'auprc': 0.653663482751932, 'loss_val': 0.5011701268400124, 'psi': 0.662241076727897}-{'f1_val': 0.6660360053914248, 'auprc': 0.6500150832773235, 'loss_val': 0.5460171561979597, 'psi': 0.6596276365457843}
[S5] START round=18 head_norm_before_train=1.020112 cos_to_last_merge=1.0000 (last merge round=17)
[S5] round=18 local utility u=0.000000 metrics={'f1_val': 0.7003584972748184, 'auprc': 0.991955381046252, 'loss_val': 0.38014915614573824, 'psi': 0.8169972507833918}-{'f1_val': 0.7003603281361598, 'auprc': 0.9970240549528854, 'loss_val': 0.3511079432567938, 'psi': 0.8190258188628501}
[S6] START round=18 head_norm_before_train=1.141174 cos_to_last_merge=1.0000 (last merge round=17)
[S6] round=18 local utility u=0.000000 metrics={'f1_val': 0.6967955737290581, 'auprc': 0.8431148726520002, 'loss_val': 0.42292126472023506, 'psi': 0.755323293298235}-{'f1_val': 0.709692427219619, 'auprc': 0.9500709525646318, 'loss_val': 0.4039010787544884, 'psi': 0.8058438373576241}
[S7] START round=18 head_norm_before_train=1.679586 (no previous merge yet)
[S7] round=18 local utility u=0.104045 metrics={'f1_val': 0.6862066186122333, 'auprc': 0.8364375880311542, 'loss_val': 0.3525282051141925, 'psi': 0.7462990063798016}-{'f1_val': 0.6713376568015027, 'auprc': 0.8180040612531876, 'loss_val': 0.41610357152803273, 'psi': 0.7300042185821767}
[S8] START round=18 head_norm_before_train=1.604442 (no previous merge yet)
[S8] round=18 local utility u=0.002181 metrics={'f1_val': 0.9949341807769929, 'auprc': 0.9970686439393603, 'loss_val': 0.17863388731035476, 'psi': 0.99578796604194}-{'f1_val': 0.9957130441636828, 'auprc': 0.9986066429721024, 'loss_val': 0.19228305120486472, 'psi': 0.9968704836870507}
[S9] START round=18 head_norm_before_train=0.818475 cos_to_last_merge=1.0000 (last merge round=17)
[S9] round=18 local utility u=0.000000 metrics={'f1_val': 0.988279001546821, 'auprc': 0.9981864927865002, 'loss_val': 0.25604085175559965, 'psi': 0.9922419980426928}-{'f1_val': 0.9912441468948172, 'auprc': 0.9982566443770808, 'loss_val': 0.2649688278475219, 'psi': 0.9940491458877228}
[S10] START round=18 head_norm_before_train=1.379609 cos_to_last_merge=0.8194 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.819
[S10] round=18 local utility u=0.065641 metrics={'f1_val': 0.9357196526012422, 'auprc': 0.9943657852465343, 'loss_val': 0.2204050568687627, 'psi': 0.959178105659359}-{'f1_val': 0.9197020462944911, 'auprc': 0.9933468096863952, 'loss_val': 0.2525242728392787, 'psi': 0.9491599516512528}
[S11] START round=18 head_norm_before_train=0.880899 cos_to_last_merge=1.0000 (last merge round=17)
[S11] round=18 local utility u=0.163713 metrics={'f1_val': 0.957198176167599, 'auprc': 0.9981034331550088, 'loss_val': 0.4186896301836928, 'psi': 0.9735602789625628}-{'f1_val': 0.9162235958528605, 'auprc': 0.9971147402839744, 'loss_val': 0.4973011932742713, 'psi': 0.9485800536253061}
[S13] START round=18 head_norm_before_train=1.600709 (no previous merge yet)
[S13] round=18 local utility u=0.086214 metrics={'f1_val': 0.6299544776577809, 'auprc': 0.7563080190994748, 'loss_val': 0.505381835571563, 'psi': 0.6804958942344584}-{'f1_val': 0.6043158575897002, 'auprc': 0.7609960522075564, 'loss_val': 0.5380419386743848, 'psi': 0.6669879354368426}
[S14] START round=18 head_norm_before_train=0.887038 cos_to_last_merge=1.0000 (last merge round=17)
[S14] round=18 local utility u=0.030185 metrics={'f1_val': 0.9958761740350409, 'auprc': 0.9972183816465033, 'loss_val': 0.38729766857072506, 'psi': 0.9964130570796259}-{'f1_val': 0.9941868848738158, 'auprc': 0.9975638417790944, 'loss_val': 0.4385683702291389, 'psi': 0.9955376676359272}
[S15] START round=18 head_norm_before_train=1.194195 cos_to_last_merge=1.0000 (last merge round=17)
[S15] round=18 local utility u=0.173544 metrics={'f1_val': 0.8335268340862707, 'auprc': 0.9910809772633078, 'loss_val': 0.3589411689515777, 'psi': 0.8965484913570855}-{'f1_val': 0.7829209369579875, 'auprc': 0.9887634739860429, 'loss_val': 0.39544128954009283, 'psi': 0.8652579517692096}
[S16] START round=18 head_norm_before_train=1.701586 (no previous merge yet)
[S16] round=18 local utility u=0.000000 metrics={'f1_val': 0.8281723053983646, 'auprc': 0.91035383675703, 'loss_val': 0.8220038667024087, 'psi': 0.8610449179418307}-{'f1_val': 0.844520715705422, 'auprc': 0.9286903831140378, 'loss_val': 0.662585142381528, 'psi': 0.8781885826688682}
[S17] START round=18 head_norm_before_train=1.249985 cos_to_last_merge=0.7609 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.761
[S17] round=18 local utility u=0.388307 metrics={'f1_val': 0.5275117627451428, 'auprc': 0.7416830538337273, 'loss_val': 0.6607556127903933, 'psi': 0.6131802791805766}-{'f1_val': 0.391853316404468, 'auprc': 0.7563405184325281, 'loss_val': 0.6673912086008703, 'psi': 0.5376481972156921}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S14] → sending delta(kind=head bytes=1790) to S11@127.0.0.1:62412
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S7] → sending delta(kind=head bytes=1808) to S6@127.0.0.1:62407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:62405
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] → sending delta(kind=head bytes=1805) to S6@127.0.0.1:62407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:62410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:62402
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:62414
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:62404
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:62410
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1795 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1804 to 1 peers)
[S8] sending update (kind=head size=1805 to 1 peers)
[S7] sending update (kind=head size=1808 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1790 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1805) from S8
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.626033)
[S6] loaded HEAD from S8 (vec_in norm=1.626033)
[S6] cosine check vs S8: cos=0.6451
[S6] BUFFERED delta from S8 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1798) from S3
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.942916)
[S2] loaded HEAD from S3 (vec_in norm=1.942916)
[S2] cosine check vs S3: cos=-0.0466
[S2] DROPPED delta from S3 (cos=-0.0466 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1795) from S4
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.202496)
[S5] loaded HEAD from S4 (vec_in norm=1.202496)
[S5] cosine check vs S4: cos=0.8766
[S5] BUFFERED delta from S4 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1800) from S13
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.618634)
[S9] loaded HEAD from S13 (vec_in norm=1.618634)
[S9] cosine check vs S13: cos=0.3437
[S9] BUFFERED delta from S13 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1804) from S11
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=0.935797)
[S9] loaded HEAD from S11 (vec_in norm=0.935797)
[S9] cosine check vs S11: cos=0.9012
[S9] BUFFERED delta from S11 (total buffered=2)
[S11] RECEIVED delta(kind=head bytes=1790) from S14
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.927779)
[S11] loaded HEAD from S14 (vec_in norm=0.927779)
[S11] cosine check vs S14: cos=0.9598
[S11] BUFFERED delta from S14 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1796) from S10
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.402651)
[S4] loaded HEAD from S10 (vec_in norm=1.402651)
[S4] cosine check vs S10: cos=0.6334
[S4] BUFFERED delta from S10 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1796) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.230008)
[S14] loaded HEAD from S15 (vec_in norm=1.230008)
[S14] cosine check vs S15: cos=0.8168
[S14] BUFFERED delta from S15 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1808) from S7
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.681946)
[S6] loaded HEAD from S7 (vec_in norm=1.681946)
[S6] cosine check vs S7: cos=0.6877
[S6] BUFFERED delta from S7 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:62405
[S17] sending update (kind=head size=1797 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1797) from S17
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.259642)
[S5] loaded HEAD from S17 (vec_in norm=1.259642)
[S5] cosine check vs S17: cos=0.6773
[S5] BUFFERED delta from S17 (total buffered=2)
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=18 metric=0.7004 head_norm=1.088342
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.590283e-01
[S5] stored merged vector for next round verification (round=18)
[S5] DEBUG after merge:  round=18 metric=0.7459 head_norm=1.031109 delta_norm=0.159028
[S5] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=18 metric=0.6968 head_norm=1.173391
[S6] _apply_head_vector_avg (torch): Δ‖w‖=7.515121e-02
[S6] stored merged vector for next round verification (round=18)
[S6] DEBUG after merge:  round=18 metric=0.6958 head_norm=1.140039 delta_norm=0.075151
[S6] aggregate: ACCEPT kept=['S8', 'S7'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=18 metric=0.9883 head_norm=0.918249
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.968449e-01
[S9] stored merged vector for next round verification (round=18)
[S9] DEBUG after merge:  round=18 metric=0.9770 head_norm=0.894460 delta_norm=0.396845
[S9] aggregate: ROLLBACK (f1_val pre=0.988 post=0.977 tol_abs=0.005 tol_rel=0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=18 metric=0.6680 head_norm=1.202496
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.649492e-01
[S4] stored merged vector for next round verification (round=18)
[S4] DEBUG after merge:  round=18 metric=0.6671 head_norm=1.177941 delta_norm=0.564949
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=18 metric=0.9959 head_norm=0.927779
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.569169e-01
[S14] stored merged vector for next round verification (round=18)
[S14] DEBUG after merge:  round=18 metric=0.9973 head_norm=1.029300 delta_norm=0.356917
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=18 metric=0.9572 head_norm=0.935797
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.322236e-01
[S11] stored merged vector for next round verification (round=18)
[S11] DEBUG after merge:  round=18 metric=0.9565 head_norm=0.922368 delta_norm=0.132224
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.693937 (no previous merge yet)
[S2] round=19 local utility u=0.097088 metrics={'f1_val': 0.7011337461190337, 'auprc': 0.6728211795493556, 'loss_val': 0.2676405056450408, 'psi': 0.6898087194911624}-{'f1_val': 0.678414765785322, 'auprc': 0.6870457725316998, 'loss_val': 0.36817683726570377, 'psi': 0.6818671684838731}
[S3] START round=19 head_norm_before_train=1.942916 (no previous merge yet)
[S3] round=19 local utility u=0.000000 metrics={'f1_val': 0.7088709936721296, 'auprc': 0.9447810214616016, 'loss_val': 0.7617359940216312, 'psi': 0.8032350047879184}-{'f1_val': 0.8822756197471382, 'auprc': 0.9988320257300982, 'loss_val': 0.26053873793377386, 'psi': 0.9288981821403222}
[S4] START round=19 head_norm_before_train=1.177941 cos_to_last_merge=1.0000 (last merge round=18)
[S4] round=19 local utility u=0.151370 metrics={'f1_val': 0.6127402630498354, 'auprc': 0.8616175863571366, 'loss_val': 0.49097700507715325, 'psi': 0.712291192372756}-{'f1_val': 0.6679594727118736, 'auprc': 0.653663482751932, 'loss_val': 0.5011701268400124, 'psi': 0.662241076727897}
[S5] START round=19 head_norm_before_train=1.031109 cos_to_last_merge=1.0000 (last merge round=18)
[S5] round=19 local utility u=0.000000 metrics={'f1_val': 0.714306097623075, 'auprc': 0.7932495690305437, 'loss_val': 0.5405577427543209, 'psi': 0.7458834861860624}-{'f1_val': 0.7003584972748184, 'auprc': 0.991955381046252, 'loss_val': 0.38014915614573824, 'psi': 0.8169972507833918}
[S6] START round=19 head_norm_before_train=1.140039 cos_to_last_merge=1.0000 (last merge round=18)
[S6] round=19 local utility u=0.094668 metrics={'f1_val': 0.703293347599295, 'auprc': 0.8877877001376294, 'loss_val': 0.40658985429421257, 'psi': 0.7770910886146287}-{'f1_val': 0.6967955737290581, 'auprc': 0.8431148726520002, 'loss_val': 0.42292126472023506, 'psi': 0.755323293298235}
[S7] START round=19 head_norm_before_train=1.681946 (no previous merge yet)
[S7] round=19 local utility u=0.000000 metrics={'f1_val': 0.5824909869751707, 'auprc': 0.7847046945644607, 'loss_val': 0.7105275638975057, 'psi': 0.6633764700108866}-{'f1_val': 0.6862066186122333, 'auprc': 0.8364375880311542, 'loss_val': 0.3525282051141925, 'psi': 0.7462990063798016}
[S8] START round=19 head_norm_before_train=1.626033 (no previous merge yet)
[S8] round=19 local utility u=0.000000 metrics={'f1_val': 0.7139521677339791, 'auprc': 0.9988939340421451, 'loss_val': 0.2411388002145858, 'psi': 0.8279288742572455}-{'f1_val': 0.9949341807769929, 'auprc': 0.9970686439393603, 'loss_val': 0.17863388731035476, 'psi': 0.99578796604194}
[S9] START round=19 head_norm_before_train=0.894460 cos_to_last_merge=1.0000 (last merge round=18)
[S9] round=19 local utility u=0.027594 metrics={'f1_val': 0.9912441468948172, 'auprc': 0.9981833159959147, 'loss_val': 0.21863373967502342, 'psi': 0.9940198145352562}-{'f1_val': 0.988279001546821, 'auprc': 0.9981864927865002, 'loss_val': 0.25604085175559965, 'psi': 0.9922419980426928}
[S10] START round=19 head_norm_before_train=1.402651 cos_to_last_merge=0.8148 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.815
[S10] round=19 local utility u=0.237671 metrics={'f1_val': 0.9946892565352771, 'auprc': 0.9973217686693872, 'loss_val': 0.10774959924905247, 'psi': 0.9957422613889211}-{'f1_val': 0.9357196526012422, 'auprc': 0.9943657852465343, 'loss_val': 0.2204050568687627, 'psi': 0.959178105659359}
[S11] START round=19 head_norm_before_train=0.922368 cos_to_last_merge=1.0000 (last merge round=18)
[S11] round=19 local utility u=0.000000 metrics={'f1_val': 0.9436396997098567, 'auprc': 0.9971995983496408, 'loss_val': 0.36991225255508636, 'psi': 0.9650636591657704}-{'f1_val': 0.957198176167599, 'auprc': 0.9981034331550088, 'loss_val': 0.4186896301836928, 'psi': 0.9735602789625628}
[S13] START round=19 head_norm_before_train=1.618634 (no previous merge yet)
[S13] round=19 local utility u=0.059001 metrics={'f1_val': 0.6609376885942594, 'auprc': 0.7138395947654966, 'loss_val': 0.44587448504777105, 'psi': 0.6820984510627544}-{'f1_val': 0.6299544776577809, 'auprc': 0.7563080190994748, 'loss_val': 0.505381835571563, 'psi': 0.6804958942344584}
[S14] START round=19 head_norm_before_train=1.029300 cos_to_last_merge=1.0000 (last merge round=18)
[S14] round=19 local utility u=0.000000 metrics={'f1_val': 0.99705655548382, 'auprc': 0.9966643870262013, 'loss_val': 0.39376989761935893, 'psi': 0.9968996881007726}-{'f1_val': 0.9958761740350409, 'auprc': 0.9972183816465033, 'loss_val': 0.38729766857072506, 'psi': 0.9964130570796259}
[S15] START round=19 head_norm_before_train=1.230008 cos_to_last_merge=0.9986 (last merge round=17)
[S15] round=19 local utility u=0.000000 metrics={'f1_val': 0.6996619087951585, 'auprc': 0.9074058168246154, 'loss_val': 0.4232243512567002, 'psi': 0.7827594720069413}-{'f1_val': 0.8335268340862707, 'auprc': 0.9910809772633078, 'loss_val': 0.3589411689515777, 'psi': 0.8965484913570855}
[S16] START round=19 head_norm_before_train=1.731454 (no previous merge yet)
[S16] round=19 local utility u=0.386579 metrics={'f1_val': 0.8584050296386775, 'auprc': 0.9564926465387081, 'loss_val': 0.3686588572559299, 'psi': 0.8976400763986898}-{'f1_val': 0.8281723053983646, 'auprc': 0.91035383675703, 'loss_val': 0.8220038667024087, 'psi': 0.8610449179418307}
[S17] START round=19 head_norm_before_train=1.259642 cos_to_last_merge=0.7571 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.757
[S17] round=19 local utility u=0.083764 metrics={'f1_val': 0.5419837627900745, 'auprc': 0.7668711497462695, 'loss_val': 0.6556246085300786, 'psi': 0.6319387175725525}-{'f1_val': 0.5275117627451428, 'auprc': 0.7416830538337273, 'loss_val': 0.6607556127903933, 'psi': 0.6131802791805766}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:62410
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:62414
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:62404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:62404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:62405
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:62407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:62415
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1794 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1800) from S2
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.707318)
[S6] loaded HEAD from S2 (vec_in norm=1.707318)
[S6] cosine check vs S2: cos=-0.0639
[S6] DROPPED delta from S2 (cos=-0.0639 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1800) from S6
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.175782)
[S15] loaded HEAD from S6 (vec_in norm=1.175782)
[S15] cosine check vs S6: cos=0.9766
[S15] BUFFERED delta from S6 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1800) from S10
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.430368)
[S4] loaded HEAD from S10 (vec_in norm=1.430368)
[S4] cosine check vs S10: cos=0.9163
[S4] BUFFERED delta from S10 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1800) from S16
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.755231)
[S4] loaded HEAD from S16 (vec_in norm=1.755231)
[S4] cosine check vs S16: cos=0.3971
[S4] BUFFERED delta from S16 (total buffered=2)
[S5] RECEIVED delta(kind=head bytes=1800) from S4
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.216571)
[S5] loaded HEAD from S4 (vec_in norm=1.216571)
[S5] cosine check vs S4: cos=0.7082
[S5] BUFFERED delta from S4 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1799) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.992427)
[S14] loaded HEAD from S9 (vec_in norm=0.992427)
[S14] cosine check vs S9: cos=0.5462
[S14] BUFFERED delta from S9 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1794) from S13
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.637158)
[S9] loaded HEAD from S13 (vec_in norm=1.637158)
[S9] cosine check vs S13: cos=0.6637
[S9] BUFFERED delta from S13 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:62405
[S17] sending update (kind=head size=1803 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1803) from S17
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.272002)
[S5] loaded HEAD from S17 (vec_in norm=1.272002)
[S5] cosine check vs S17: cos=0.7577
[S5] BUFFERED delta from S17 (total buffered=2)
[S11] r=20 psi=0.965 u=0.0000 p_local=0.2207 f1=0.944 auprc=0.997 bytes=18002
[S7] r=20 psi=0.663 u=0.0000 p_local=0.2096 f1=0.582 auprc=0.785 bytes=23410
[S8] r=20 psi=0.828 u=0.0000 p_local=0.2093 f1=0.714 auprc=0.999 bytes=25195
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=19 metric=0.7143 head_norm=1.095023
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.805915e-01
[S5] stored merged vector for next round verification (round=19)
[S5] DEBUG after merge:  round=19 metric=0.7143 head_norm=1.015882 delta_norm=0.180592
[S5] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S5] r=20 psi=0.746 u=0.0000 p_local=0.0932 f1=0.714 auprc=0.793 bytes=19754
[S3] r=20 psi=0.803 u=0.0000 p_local=0.1827 f1=0.709 auprc=0.945 bytes=21590
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=19 metric=0.9971 head_norm=1.060400
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.898161e-01
[S14] stored merged vector for next round verification (round=19)
[S14] DEBUG after merge:  round=19 metric=0.9971 head_norm=0.902640 delta_norm=0.489816
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S14] r=20 psi=0.997 u=0.0000 p_local=0.1721 f1=0.997 auprc=0.997 bytes=26950
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=19 metric=0.6997 head_norm=1.273926
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.412566e-01
[S15] stored merged vector for next round verification (round=19)
[S15] DEBUG after merge:  round=19 metric=0.6991 head_norm=1.217671 delta_norm=0.141257
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S15] r=20 psi=0.783 u=0.0000 p_local=0.2120 f1=0.700 auprc=0.907 bytes=26951
[S16] r=20 psi=0.898 u=0.3866 p_local=0.2191 f1=0.858 auprc=0.956 bytes=25178
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=19 metric=0.6127 head_norm=1.216571
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.954834e-01
[S4] stored merged vector for next round verification (round=19)
[S4] DEBUG after merge:  round=19 metric=0.6665 head_norm=1.143924 delta_norm=0.295483
[S4] aggregate: ACCEPT kept=['S10', 'S16'] (k=2/2) mode=median trim_p=0.1
[S4] r=20 psi=0.712 u=0.1514 p_local=0.1306 f1=0.613 auprc=0.862 bytes=26953
[S13] r=20 psi=0.682 u=0.0590 p_local=0.1178 f1=0.661 auprc=0.714 bytes=23343
[S10] r=20 psi=0.996 u=0.2377 p_local=0.2725 f1=0.995 auprc=0.997 bytes=30528
[S2] r=20 psi=0.690 u=0.0971 p_local=0.0828 f1=0.701 auprc=0.673 bytes=21579
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=19 metric=0.9912 head_norm=0.992427
[S9] _apply_head_vector_avg (torch): Δ‖w‖=6.140899e-01
[S9] stored merged vector for next round verification (round=19)
[S9] DEBUG after merge:  round=19 metric=0.9866 head_norm=1.206438 delta_norm=0.614090
[S9] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S9] r=20 psi=0.994 u=0.0276 p_local=0.1460 f1=0.991 auprc=0.998 bytes=23387
[S6] r=20 psi=0.777 u=0.0947 p_local=0.1965 f1=0.703 auprc=0.888 bytes=21572
[S17] r=20 psi=0.632 u=0.0838 p_local=0.1541 f1=0.542 auprc=0.767 bytes=23354
[S2] START round=20 head_norm_before_train=1.707318 (no previous merge yet)
[S2] round=20 local utility u=0.084856 metrics={'f1_val': 0.7013141837391442, 'auprc': 0.7297503370661402, 'loss_val': 0.2697995380656886, 'psi': 0.7126886450699426}-{'f1_val': 0.7011337461190337, 'auprc': 0.6728211795493556, 'loss_val': 0.2676405056450408, 'psi': 0.6898087194911624}
[S3] START round=20 head_norm_before_train=1.967452 (no previous merge yet)
[S3] round=20 local utility u=1.000000 metrics={'f1_val': 0.9811550973763747, 'auprc': 0.9999817878031156, 'loss_val': 0.05561775005337868, 'psi': 0.9886857735470711}-{'f1_val': 0.7088709936721296, 'auprc': 0.9447810214616016, 'loss_val': 0.7617359940216312, 'psi': 0.8032350047879184}
[S4] START round=20 head_norm_before_train=1.143924 cos_to_last_merge=1.0000 (last merge round=19)
[S4] round=20 local utility u=0.174619 metrics={'f1_val': 0.6662899525923892, 'auprc': 0.8690880153259181, 'loss_val': 0.485449336221557, 'psi': 0.7474091776858007}-{'f1_val': 0.6127402630498354, 'auprc': 0.8616175863571366, 'loss_val': 0.49097700507715325, 'psi': 0.712291192372756}
[S5] START round=20 head_norm_before_train=1.015882 cos_to_last_merge=1.0000 (last merge round=19)
[S5] round=20 local utility u=0.007461 metrics={'f1_val': 0.7142397364216113, 'auprc': 0.7932007843138528, 'loss_val': 0.5250921279159086, 'psi': 0.7458241555785079}-{'f1_val': 0.714306097623075, 'auprc': 0.7932495690305437, 'loss_val': 0.5405577427543209, 'psi': 0.7458834861860624}
[S6] START round=20 head_norm_before_train=1.175782 cos_to_last_merge=0.9990 (last merge round=18)
[S6] round=20 local utility u=0.388055 metrics={'f1_val': 0.8075219850757258, 'auprc': 0.9460308852927188, 'loss_val': 0.43058201504348526, 'psi': 0.8629255451625231}-{'f1_val': 0.703293347599295, 'auprc': 0.8877877001376294, 'loss_val': 0.40658985429421257, 'psi': 0.7770910886146287}
[S7] START round=20 head_norm_before_train=1.686643 (no previous merge yet)
[S7] round=20 local utility u=0.381357 metrics={'f1_val': 0.6605741915892802, 'auprc': 0.8021743035538605, 'loss_val': 0.4687210673328811, 'psi': 0.7172142363751124}-{'f1_val': 0.5824909869751707, 'auprc': 0.7847046945644607, 'loss_val': 0.7105275638975057, 'psi': 0.6633764700108866}
[S8] START round=20 head_norm_before_train=1.642657 (no previous merge yet)
[S8] round=20 local utility u=0.895311 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9986960447707016, 'loss_val': 0.14432848141625654, 'psi': 0.9972902628696554}-{'f1_val': 0.7139521677339791, 'auprc': 0.9988939340421451, 'loss_val': 0.2411388002145858, 'psi': 0.8279288742572455}
[S9] START round=20 head_norm_before_train=1.206438 cos_to_last_merge=1.0000 (last merge round=19)
[S9] round=20 local utility u=0.004858 metrics={'f1_val': 0.9937719190709611, 'auprc': 0.9979995034112511, 'loss_val': 0.2235322803566033, 'psi': 0.9954629528070771}-{'f1_val': 0.9912441468948172, 'auprc': 0.9981833159959147, 'loss_val': 0.21863373967502342, 'psi': 0.9940198145352562}
[S10] START round=20 head_norm_before_train=1.430368 cos_to_last_merge=0.8106 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.811
[S10] round=20 local utility u=0.011422 metrics={'f1_val': 0.9938128314971357, 'auprc': 0.9975885030478426, 'loss_val': 0.08044627320745129, 'psi': 0.9953231001174184}-{'f1_val': 0.9946892565352771, 'auprc': 0.9973217686693872, 'loss_val': 0.10774959924905247, 'psi': 0.9957422613889211}
[S11] START round=20 head_norm_before_train=0.976868 cos_to_last_merge=0.9958 (last merge round=18)
[S11] round=20 local utility u=0.226611 metrics={'f1_val': 0.9971333159512151, 'auprc': 0.9985143081531554, 'loss_val': 0.24159687383124806, 'psi': 0.9976857128319913}-{'f1_val': 0.9436396997098567, 'auprc': 0.9971995983496408, 'loss_val': 0.36991225255508636, 'psi': 0.9650636591657704}
[S13] START round=20 head_norm_before_train=1.637158 (no previous merge yet)
[S13] round=20 local utility u=0.000000 metrics={'f1_val': 0.61604310672372, 'auprc': 0.6970399034381709, 'loss_val': 0.5320780126251546, 'psi': 0.6484418254095003}-{'f1_val': 0.6609376885942594, 'auprc': 0.7138395947654966, 'loss_val': 0.44587448504777105, 'psi': 0.6820984510627544}
[S14] START round=20 head_norm_before_train=0.902640 cos_to_last_merge=1.0000 (last merge round=19)
[S14] round=20 local utility u=0.023431 metrics={'f1_val': 0.9975396023865201, 'auprc': 0.9985445390262647, 'loss_val': 0.3554475530734678, 'psi': 0.9979415770424179}-{'f1_val': 0.99705655548382, 'auprc': 0.9966643870262013, 'loss_val': 0.39376989761935893, 'psi': 0.9968996881007726}
[S15] START round=20 head_norm_before_train=1.217671 cos_to_last_merge=1.0000 (last merge round=19)
[S15] round=20 local utility u=1.000000 metrics={'f1_val': 0.9882783233902609, 'auprc': 0.990972566334922, 'loss_val': 0.25850024591260085, 'psi': 0.9893560205681253}-{'f1_val': 0.6996619087951585, 'auprc': 0.9074058168246154, 'loss_val': 0.4232243512567002, 'psi': 0.7827594720069413}
[S16] START round=20 head_norm_before_train=1.755231 (no previous merge yet)
[S16] round=20 local utility u=0.000000 metrics={'f1_val': 0.8682024418850283, 'auprc': 0.9584685472579455, 'loss_val': 0.5403528671746508, 'psi': 0.9043088840341951}-{'f1_val': 0.8584050296386775, 'auprc': 0.9564926465387081, 'loss_val': 0.3686588572559299, 'psi': 0.8976400763986898}
[S17] START round=20 head_norm_before_train=1.272002 cos_to_last_merge=0.7531 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.753
[S17] round=20 local utility u=0.000000 metrics={'f1_val': 0.38550500069397986, 'auprc': 0.7422690930636877, 'loss_val': 0.6456049601519251, 'psi': 0.5282106376418629}-{'f1_val': 0.5419837627900745, 'auprc': 0.7668711497462695, 'loss_val': 0.6556246085300786, 'psi': 0.6319387175725525}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:62410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:62404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:62412
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:62414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:62414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:62402
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S2] → sending delta(kind=head bytes=1807) to S6@127.0.0.1:62407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] → sending delta(kind=head bytes=1806) to S6@127.0.0.1:62407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:62405
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] → sending delta(kind=head bytes=1793) to S9@127.0.0.1:62410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:62415
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:62407
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1806 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1794 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1793 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S2] sending update (kind=head size=1807 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1794) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.260321)
[S14] loaded HEAD from S15 (vec_in norm=1.260321)
[S14] cosine check vs S15: cos=0.7338
[S14] BUFFERED delta from S15 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1793) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.061191)
[S9] loaded HEAD from S5 (vec_in norm=1.061191)
[S9] cosine check vs S5: cos=0.3231
[S9] BUFFERED delta from S5 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1801) from S14
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.940708)
[S11] loaded HEAD from S14 (vec_in norm=0.940708)
[S11] cosine check vs S14: cos=0.9539
[S11] BUFFERED delta from S14 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1796) from S10
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.461899)
[S4] loaded HEAD from S10 (vec_in norm=1.461899)
[S4] cosine check vs S10: cos=0.8112
[S4] BUFFERED delta from S10 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1797) from S6
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.209165)
[S15] loaded HEAD from S6 (vec_in norm=1.209165)
[S15] cosine check vs S6: cos=0.9870
[S15] BUFFERED delta from S6 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1807) from S2
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.720358)
[S6] loaded HEAD from S2 (vec_in norm=1.720358)
[S6] cosine check vs S2: cos=-0.0654
[S6] DROPPED delta from S2 (cos=-0.0654 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1800) from S4
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.178118)
[S5] loaded HEAD from S4 (vec_in norm=1.178118)
[S5] cosine check vs S4: cos=0.7742
[S5] BUFFERED delta from S4 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1799) from S3
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.994666)
[S2] loaded HEAD from S3 (vec_in norm=1.994666)
[S2] cosine check vs S3: cos=-0.0477
[S2] DROPPED delta from S3 (cos=-0.0477 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1801) from S8
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.658601)
[S6] loaded HEAD from S8 (vec_in norm=1.658601)
[S6] cosine check vs S8: cos=0.6499
[S6] BUFFERED delta from S8 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1806) from S7
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.694687)
[S6] loaded HEAD from S7 (vec_in norm=1.694687)
[S6] cosine check vs S7: cos=0.6788
[S6] BUFFERED delta from S7 (total buffered=2)
[S14] RECEIVED delta(kind=head bytes=1799) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.273255)
[S14] loaded HEAD from S9 (vec_in norm=1.273255)
[S14] cosine check vs S9: cos=0.6392
[S14] BUFFERED delta from S9 (total buffered=2)
[S9] RECEIVED delta(kind=head bytes=1801) from S11
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.029543)
[S9] loaded HEAD from S11 (vec_in norm=1.029543)
[S9] cosine check vs S11: cos=0.5140
[S9] BUFFERED delta from S11 (total buffered=2)
[S13] ⇄ pheromone p=0.094 → S9@127.0.0.1:62410
[S2] ⇄ pheromone p=0.083 → S6@127.0.0.1:62407
[S3] ⇄ pheromone p=0.346 → S2@127.0.0.1:62402
[S10] ⇄ pheromone p=0.220 → S4@127.0.0.1:62404
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=20 metric=0.9883 head_norm=1.260321
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.027304e-01
[S15] stored merged vector for next round verification (round=20)
[S15] DEBUG after merge:  round=20 metric=0.9866 head_norm=1.230728 delta_norm=0.102730
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.370 → S14@127.0.0.1:62414
[S7] ⇄ pheromone p=0.244 → S6@127.0.0.1:62407
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=20 metric=0.7142 head_norm=1.061191
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.802181e-01
[S5] stored merged vector for next round verification (round=20)
[S5] DEBUG after merge:  round=20 metric=0.7144 head_norm=1.054741 delta_norm=0.380218
[S5] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.076 → S9@127.0.0.1:62410
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=20 metric=0.8075 head_norm=1.209165
[S6] _apply_head_vector_avg (torch): Δ‖w‖=9.283128e-02
[S6] stored merged vector for next round verification (round=20)
[S6] DEBUG after merge:  round=20 metric=0.8118 head_norm=1.164407 delta_norm=0.092831
[S6] aggregate: ACCEPT kept=['S8', 'S7'] (k=2/2) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.235 → S15@127.0.0.1:62415
[S8] ⇄ pheromone p=0.347 → S6@127.0.0.1:62407
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=20 metric=0.9971 head_norm=1.029543
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.558580e-01
[S11] stored merged vector for next round verification (round=20)
[S11] DEBUG after merge:  round=20 metric=0.9815 head_norm=0.973731 delta_norm=0.155858
[S11] aggregate: ROLLBACK (f1_val pre=0.997 post=0.981 tol_abs=0.005 tol_rel=0.0)
[S11] ⇄ pheromone p=0.222 → S9@127.0.0.1:62410
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=20 metric=0.9975 head_norm=0.940708
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.702952e-01
[S14] stored merged vector for next round verification (round=20)
[S14] DEBUG after merge:  round=20 metric=0.9975 head_norm=0.920227 delta_norm=0.170295
[S14] aggregate: ACCEPT kept=['S15', 'S9'] (k=2/2) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.142 → S11@127.0.0.1:62412
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=20 metric=0.6663 head_norm=1.178118
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.274525e-01
[S4] stored merged vector for next round verification (round=20)
[S4] DEBUG after merge:  round=20 metric=0.6142 head_norm=1.256917 delta_norm=0.427452
[S4] aggregate: ROLLBACK (f1_val pre=0.666 post=0.614 tol_abs=0.005 tol_rel=0.0)
[S4] ⇄ pheromone p=0.139 → S5@127.0.0.1:62405
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=20 metric=0.9938 head_norm=1.273255
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.566633e-01
[S9] stored merged vector for next round verification (round=20)
[S9] DEBUG after merge:  round=20 metric=0.9954 head_norm=0.930088 delta_norm=0.556663
[S9] aggregate: ACCEPT kept=['S5', 'S11'] (k=2/2) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.118 → S14@127.0.0.1:62414
[S16] ⇄ pheromone p=0.175 → S4@127.0.0.1:62404
[S17] ⇄ pheromone p=0.123 → S5@127.0.0.1:62405
[S2] START round=21 head_norm_before_train=1.720358 (no previous merge yet)
[S2] round=21 local utility u=0.000000 metrics={'f1_val': 0.7012347841865968, 'auprc': 0.6669620414137836, 'loss_val': 0.2741420633829583, 'psi': 0.6875256870774715}-{'f1_val': 0.7013141837391442, 'auprc': 0.7297503370661402, 'loss_val': 0.2697995380656886, 'psi': 0.7126886450699426}
[S3] START round=21 head_norm_before_train=1.994666 (no previous merge yet)
[S3] round=21 local utility u=0.000000 metrics={'f1_val': 0.9731699409964683, 'auprc': 0.9997770015775033, 'loss_val': 0.08774633250921465, 'psi': 0.9838127652288822}-{'f1_val': 0.9811550973763747, 'auprc': 0.9999817878031156, 'loss_val': 0.05561775005337868, 'psi': 0.9886857735470711}
[S4] START round=21 head_norm_before_train=1.256917 cos_to_last_merge=1.0000 (last merge round=20)
[S4] round=21 local utility u=0.000000 metrics={'f1_val': 0.6212532383256578, 'auprc': 0.9394538103645814, 'loss_val': 0.4696298859866399, 'psi': 0.7485334671412273}-{'f1_val': 0.6662899525923892, 'auprc': 0.8690880153259181, 'loss_val': 0.485449336221557, 'psi': 0.7474091776858007}
[S5] START round=21 head_norm_before_train=1.054741 cos_to_last_merge=1.0000 (last merge round=20)
[S5] round=21 local utility u=0.326784 metrics={'f1_val': 0.7003603281361598, 'auprc': 0.9966320454064287, 'loss_val': 0.39854207427127986, 'psi': 0.8188690150442673}-{'f1_val': 0.7142397364216113, 'auprc': 0.7932007843138528, 'loss_val': 0.5250921279159086, 'psi': 0.7458241555785079}
[S6] START round=21 head_norm_before_train=1.164407 cos_to_last_merge=1.0000 (last merge round=20)
[S6] round=21 local utility u=0.000000 metrics={'f1_val': 0.7706190997609144, 'auprc': 0.9325219725914726, 'loss_val': 0.4728842756935781, 'psi': 0.8353802488931377}-{'f1_val': 0.8075219850757258, 'auprc': 0.9460308852927188, 'loss_val': 0.43058201504348526, 'psi': 0.8629255451625231}
[S7] START round=21 head_norm_before_train=1.694687 (no previous merge yet)
[S7] round=21 local utility u=0.161118 metrics={'f1_val': 0.6842153448087391, 'auprc': 0.8289473352746451, 'loss_val': 0.3686518992270569, 'psi': 0.7421081409951016}-{'f1_val': 0.6605741915892802, 'auprc': 0.8021743035538605, 'loss_val': 0.4687210673328811, 'psi': 0.7172142363751124}
[S8] START round=21 head_norm_before_train=1.658601 (no previous merge yet)
[S8] round=21 local utility u=0.000000 metrics={'f1_val': 0.9943353269796242, 'auprc': 0.9989452842319745, 'loss_val': 0.14783687035166815, 'psi': 0.9961793098805644}-{'f1_val': 0.9963530749356245, 'auprc': 0.9986960447707016, 'loss_val': 0.14432848141625654, 'psi': 0.9972902628696554}
[S9] START round=21 head_norm_before_train=0.930088 cos_to_last_merge=1.0000 (last merge round=20)
[S9] round=21 local utility u=0.011023 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9950506492513074, 'loss_val': 0.21016236386894144, 'psi': 0.9960357544593803}-{'f1_val': 0.9937719190709611, 'auprc': 0.9979995034112511, 'loss_val': 0.2235322803566033, 'psi': 0.9954629528070771}
[S10] START round=21 head_norm_before_train=1.461899 cos_to_last_merge=0.8065 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.806
[S10] round=21 local utility u=0.004576 metrics={'f1_val': 0.9940903254969471, 'auprc': 0.9965611278398994, 'loss_val': 0.06987736874143219, 'psi': 0.995078646434128}-{'f1_val': 0.9938128314971357, 'auprc': 0.9975885030478426, 'loss_val': 0.08044627320745129, 'psi': 0.9953231001174184}
[S11] START round=21 head_norm_before_train=0.973731 cos_to_last_merge=1.0000 (last merge round=20)
[S11] round=21 local utility u=0.004139 metrics={'f1_val': 0.9967189926998994, 'auprc': 0.9982859074470007, 'loss_val': 0.23014730202561254, 'psi': 0.9973457585987399}-{'f1_val': 0.9971333159512151, 'auprc': 0.9985143081531554, 'loss_val': 0.24159687383124806, 'psi': 0.9976857128319913}
[S13] START round=21 head_norm_before_train=1.654184 (no previous merge yet)
[S13] round=21 local utility u=0.098422 metrics={'f1_val': 0.6600066965800148, 'auprc': 0.6510337298610593, 'loss_val': 0.46099653574666727, 'psi': 0.6564175098924325}-{'f1_val': 0.61604310672372, 'auprc': 0.6970399034381709, 'loss_val': 0.5320780126251546, 'psi': 0.6484418254095003}
[S14] START round=21 head_norm_before_train=0.920227 cos_to_last_merge=1.0000 (last merge round=20)
[S14] round=21 local utility u=0.000000 metrics={'f1_val': 0.9960584617682066, 'auprc': 0.9936227771409982, 'loss_val': 0.3874962893472196, 'psi': 0.9950841879173232}-{'f1_val': 0.9975396023865201, 'auprc': 0.9985445390262647, 'loss_val': 0.3554475530734678, 'psi': 0.9979415770424179}
[S15] START round=21 head_norm_before_train=1.230728 cos_to_last_merge=1.0000 (last merge round=20)
[S15] round=21 local utility u=0.000000 metrics={'f1_val': 0.7010443585704017, 'auprc': 0.9085087099689864, 'loss_val': 0.4687882312465812, 'psi': 0.7840300991298357}-{'f1_val': 0.9882783233902609, 'auprc': 0.990972566334922, 'loss_val': 0.25850024591260085, 'psi': 0.9893560205681253}
[S16] START round=21 head_norm_before_train=1.778272 (no previous merge yet)
[S16] round=21 local utility u=0.000000 metrics={'f1_val': 0.8284953133860088, 'auprc': 0.8796978041016362, 'loss_val': 0.9204969371426894, 'psi': 0.8489763096722598}-{'f1_val': 0.8682024418850283, 'auprc': 0.9584685472579455, 'loss_val': 0.5403528671746508, 'psi': 0.9043088840341951}
[S17] START round=21 head_norm_before_train=1.287136 cos_to_last_merge=0.7493 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.749
[S17] round=21 local utility u=0.086734 metrics={'f1_val': 0.41326887418656866, 'auprc': 0.7416980165021484, 'loss_val': 0.6370072278859057, 'psi': 0.5446405311128006}-{'f1_val': 0.38550500069397986, 'auprc': 0.7422690930636877, 'loss_val': 0.6456049601519251, 'psi': 0.5282106376418629}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:62410
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] → sending delta(kind=head bytes=1805) to S6@127.0.0.1:62407
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:62404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:62410
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:62410
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:62414
[S13] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1805 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1801) from S9
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.017739)
[S14] loaded HEAD from S9 (vec_in norm=1.017739)
[S14] cosine check vs S9: cos=0.8169
[S14] BUFFERED delta from S9 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1799) from S13
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.671794)
[S9] loaded HEAD from S13 (vec_in norm=1.671794)
[S9] cosine check vs S13: cos=0.7155
[S9] BUFFERED delta from S13 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1801) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.092016)
[S9] loaded HEAD from S5 (vec_in norm=1.092016)
[S9] cosine check vs S5: cos=0.5887
[S9] BUFFERED delta from S5 (total buffered=2)
[S9] RECEIVED delta(kind=head bytes=1799) from S11
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.021231)
[S9] loaded HEAD from S11 (vec_in norm=1.021231)
[S9] cosine check vs S11: cos=0.7794
[S9] BUFFERED delta from S11 (total buffered=3)
[S4] RECEIVED delta(kind=head bytes=1797) from S10
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.492293)
[S4] loaded HEAD from S10 (vec_in norm=1.492293)
[S4] cosine check vs S10: cos=0.9585
[S4] BUFFERED delta from S10 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1805) from S7
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.708597)
[S6] loaded HEAD from S7 (vec_in norm=1.708597)
[S6] cosine check vs S7: cos=0.6767
[S6] BUFFERED delta from S7 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:62405
[S17] sending update (kind=head size=1799 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1799) from S17
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.300877)
[S5] loaded HEAD from S17 (vec_in norm=1.300877)
[S5] cosine check vs S17: cos=0.5501
[S5] BUFFERED delta from S17 (total buffered=1)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=21 metric=0.6213 head_norm=1.288796
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.241500e-01
[S4] stored merged vector for next round verification (round=21)
[S4] DEBUG after merge:  round=21 metric=0.6156 head_norm=1.376126 delta_norm=0.224150
[S4] aggregate: ROLLBACK (f1_val pre=0.621 post=0.616 tol_abs=0.005 tol_rel=0.0)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=21 metric=0.7706 head_norm=1.198022
[S6] _apply_head_vector_avg (torch): Δ‖w‖=6.293178e-01
[S6] stored merged vector for next round verification (round=21)
[S6] DEBUG after merge:  round=21 metric=0.7817 head_norm=1.334631 delta_norm=0.629318
[S6] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=21 metric=0.9961 head_norm=0.951960
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.995939e-01
[S14] stored merged vector for next round verification (round=21)
[S14] DEBUG after merge:  round=21 metric=0.9958 head_norm=0.938751 delta_norm=0.299594
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=21 metric=0.7004 head_norm=1.092016
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.748832e-01
[S5] stored merged vector for next round verification (round=21)
[S5] DEBUG after merge:  round=21 metric=0.7004 head_norm=1.054466 delta_norm=0.574883
[S5] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=21 metric=0.9967 head_norm=1.017739
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.705847e-01
[S9] stored merged vector for next round verification (round=21)
[S9] DEBUG after merge:  round=21 metric=0.9967 head_norm=0.931984 delta_norm=0.170585
[S9] aggregate: ACCEPT kept=['S13', 'S5', 'S11'] (k=3/3) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=1.732171 (no previous merge yet)
[S2] round=22 local utility u=0.000000 metrics={'f1_val': 0.7012347841865968, 'auprc': 0.6656829863997598, 'loss_val': 0.27791051157335944, 'psi': 0.6870140650718619}-{'f1_val': 0.7012347841865968, 'auprc': 0.6669620414137836, 'loss_val': 0.2741420633829583, 'psi': 0.6875256870774715}
[S3] START round=22 head_norm_before_train=2.021850 (no previous merge yet)
[S3] round=22 local utility u=0.045939 metrics={'f1_val': 0.9841834694278214, 'auprc': 0.9998859035217622, 'loss_val': 0.06227675109404156, 'psi': 0.9904644430653977}-{'f1_val': 0.9731699409964683, 'auprc': 0.9997770015775033, 'loss_val': 0.08774633250921465, 'psi': 0.9838127652288822}
[S4] START round=22 head_norm_before_train=1.376126 cos_to_last_merge=1.0000 (last merge round=21)
[S4] round=22 local utility u=0.144658 metrics={'f1_val': 0.6761215524764977, 'auprc': 0.918460639281615, 'loss_val': 0.44654396954405445, 'psi': 0.7730571871985447}-{'f1_val': 0.6212532383256578, 'auprc': 0.9394538103645814, 'loss_val': 0.4696298859866399, 'psi': 0.7485334671412273}
[S5] START round=22 head_norm_before_train=1.054466 cos_to_last_merge=1.0000 (last merge round=21)
[S5] round=22 local utility u=0.020049 metrics={'f1_val': 0.7003603281361598, 'auprc': 0.9968800072191462, 'loss_val': 0.35918881316455986, 'psi': 0.8189681997693543}-{'f1_val': 0.7003603281361598, 'auprc': 0.9966320454064287, 'loss_val': 0.39854207427127986, 'psi': 0.8188690150442673}
[S6] START round=22 head_norm_before_train=1.334631 cos_to_last_merge=1.0000 (last merge round=21)
[S6] round=22 local utility u=0.784269 metrics={'f1_val': 0.9841034425045867, 'auprc': 0.9602344876556475, 'loss_val': 0.26838936323677015, 'psi': 0.9745558605650111}-{'f1_val': 0.7706190997609144, 'auprc': 0.9325219725914726, 'loss_val': 0.4728842756935781, 'psi': 0.8353802488931377}
[S7] START round=22 head_norm_before_train=1.708597 (no previous merge yet)
[S7] round=22 local utility u=0.000000 metrics={'f1_val': 0.654535742680604, 'auprc': 0.8007292145357332, 'loss_val': 0.5083003115652053, 'psi': 0.7130131314226557}-{'f1_val': 0.6842153448087391, 'auprc': 0.8289473352746451, 'loss_val': 0.3686518992270569, 'psi': 0.7421081409951016}
[S8] START round=22 head_norm_before_train=1.675058 (no previous merge yet)
[S8] round=22 local utility u=0.019496 metrics={'f1_val': 0.9960878102233311, 'auprc': 0.9987942031584992, 'loss_val': 0.1189067137733136, 'psi': 0.9971703673973984}-{'f1_val': 0.9943353269796242, 'auprc': 0.9989452842319745, 'loss_val': 0.14783687035166815, 'psi': 0.9961793098805644}
[S9] START round=22 head_norm_before_train=0.931984 cos_to_last_merge=1.0000 (last merge round=21)
[S9] round=22 local utility u=0.010095 metrics={'f1_val': 0.9966891482978385, 'auprc': 0.9982151074010545, 'loss_val': 0.1994458425150913, 'psi': 0.9972995319391249}-{'f1_val': 0.9966924912647621, 'auprc': 0.9950506492513074, 'loss_val': 0.21016236386894144, 'psi': 0.9960357544593803}
[S10] START round=22 head_norm_before_train=1.492293 cos_to_last_merge=0.8024 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.802
[S10] round=22 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9934861435439796, 'loss_val': 0.0882711272167446, 'psi': 0.9945071608292166}-{'f1_val': 0.9940903254969471, 'auprc': 0.9965611278398994, 'loss_val': 0.06987736874143219, 'psi': 0.995078646434128}
[S11] START round=22 head_norm_before_train=1.021231 cos_to_last_merge=0.9981 (last merge round=20)
[S11] round=22 local utility u=0.024706 metrics={'f1_val': 0.9967189926998994, 'auprc': 0.9980530149505212, 'loss_val': 0.18003575475180222, 'psi': 0.9972526016001481}-{'f1_val': 0.9967189926998994, 'auprc': 0.9982859074470007, 'loss_val': 0.23014730202561254, 'psi': 0.9973457585987399}
[S13] START round=22 head_norm_before_train=1.671794 (no previous merge yet)
[S13] round=22 local utility u=0.000000 metrics={'f1_val': 0.5969295131327597, 'auprc': 0.6900570292699497, 'loss_val': 0.6700491083218413, 'psi': 0.6341805195876357}-{'f1_val': 0.6600066965800148, 'auprc': 0.6510337298610593, 'loss_val': 0.46099653574666727, 'psi': 0.6564175098924325}
[S14] START round=22 head_norm_before_train=0.938751 cos_to_last_merge=1.0000 (last merge round=21)
[S14] round=22 local utility u=0.026308 metrics={'f1_val': 0.99727647169645, 'auprc': 0.9984903139401703, 'loss_val': 0.356790537890354, 'psi': 0.997762008593938}-{'f1_val': 0.9960584617682066, 'auprc': 0.9936227771409982, 'loss_val': 0.3874962893472196, 'psi': 0.9950841879173232}
[S15] START round=22 head_norm_before_train=1.268844 cos_to_last_merge=0.9988 (last merge round=20)
[S15] round=22 local utility u=0.320380 metrics={'f1_val': 0.766137178976653, 'auprc': 0.963301678571044, 'loss_val': 0.3829645035979234, 'psi': 0.8450029788144094}-{'f1_val': 0.7010443585704017, 'auprc': 0.9085087099689864, 'loss_val': 0.4687882312465812, 'psi': 0.7840300991298357}
[S16] START round=22 head_norm_before_train=1.798272 (no previous merge yet)
[S16] round=22 local utility u=0.560956 metrics={'f1_val': 0.8698019352680493, 'auprc': 0.977848090003648, 'loss_val': 0.34087485167367937, 'psi': 0.9130203971622888}-{'f1_val': 0.8284953133860088, 'auprc': 0.8796978041016362, 'loss_val': 0.9204969371426894, 'psi': 0.8489763096722598}
[S17] START round=22 head_norm_before_train=1.300877 cos_to_last_merge=0.7464 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.746
[S17] round=22 local utility u=0.442666 metrics={'f1_val': 0.53869542088426, 'auprc': 0.7851771680361483, 'loss_val': 0.6346727236147163, 'psi': 0.6372881197450153}-{'f1_val': 0.41326887418656866, 'auprc': 0.7416980165021484, 'loss_val': 0.6370072278859057, 'psi': 0.5446405311128006}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:62411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:62407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:62404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:62412
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:62415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:62409
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:62414
[S11] sending update (kind=head size=1804 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1799) from S5
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.084476)
[S4] loaded HEAD from S5 (vec_in norm=1.084476)
[S4] cosine check vs S5: cos=0.4809
[S4] BUFFERED delta from S5 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1799) from S4
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.402666)
[S10] loaded HEAD from S4 (vec_in norm=1.402666)
[S10] cosine check vs S4: cos=0.9887
[S10] BUFFERED delta from S4 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1799) from S6
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.359501)
[S8] loaded HEAD from S6 (vec_in norm=1.359501)
[S8] cosine check vs S6: cos=0.2424
[S8] BUFFERED delta from S6 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1802) from S15
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.307702)
[S6] loaded HEAD from S15 (vec_in norm=1.307702)
[S6] cosine check vs S15: cos=0.8847
[S6] BUFFERED delta from S15 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1797) from S9
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.019695)
[S11] loaded HEAD from S9 (vec_in norm=1.019695)
[S11] cosine check vs S9: cos=0.7946
[S11] BUFFERED delta from S9 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1803) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.979061)
[S15] loaded HEAD from S14 (vec_in norm=0.979061)
[S15] cosine check vs S14: cos=0.5278
[S15] BUFFERED delta from S14 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1804) from S11
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.066810)
[S14] loaded HEAD from S11 (vec_in norm=1.066810)
[S14] cosine check vs S11: cos=0.9094
[S14] BUFFERED delta from S11 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=22 metric=0.9961 head_norm=1.691327
[S8] _apply_head_vector_avg (torch): Δ‖w‖=9.479151e-01
[S8] stored merged vector for next round verification (round=22)
[S8] DEBUG after merge:  round=22 metric=0.9957 head_norm=1.206595 delta_norm=0.947915
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=22 metric=0.9952 head_norm=1.520418
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.246609e-01
[S10] stored merged vector for next round verification (round=22)
[S10] DEBUG after merge:  round=22 metric=0.9952 head_norm=1.457406 delta_norm=0.124661
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=22 metric=0.6761 head_norm=1.402666
[S4] _apply_head_vector_avg (torch): Δ‖w‖=6.481599e-01
[S4] stored merged vector for next round verification (round=22)
[S4] DEBUG after merge:  round=22 metric=0.6677 head_norm=1.073159 delta_norm=0.648160
[S4] aggregate: ROLLBACK (f1_val pre=0.676 post=0.668 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=22 metric=0.9973 head_norm=0.979061
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.218710e-01
[S14] stored merged vector for next round verification (round=22)
[S14] DEBUG after merge:  round=22 metric=0.9973 head_norm=0.999548 delta_norm=0.221871
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=22 metric=0.9841 head_norm=1.359501
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.211730e-01
[S6] stored merged vector for next round verification (round=22)
[S6] DEBUG after merge:  round=22 metric=0.9834 head_norm=1.294608 delta_norm=0.321173
[S6] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=22 metric=0.9967 head_norm=1.066810
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.350605e-01
[S11] stored merged vector for next round verification (round=22)
[S11] DEBUG after merge:  round=22 metric=0.9967 head_norm=0.988264 delta_norm=0.335060
[S11] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=22 metric=0.7661 head_norm=1.307702
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.738397e-01
[S15] stored merged vector for next round verification (round=22)
[S15] DEBUG after merge:  round=22 metric=0.7163 head_norm=1.002512 delta_norm=0.573840
[S15] aggregate: ROLLBACK (f1_val pre=0.766 post=0.716 tol_abs=0.005 tol_rel=0.0)
[S2] START round=23 head_norm_before_train=1.743249 (no previous merge yet)
[S2] round=23 local utility u=0.000000 metrics={'f1_val': 0.7012347841865968, 'auprc': 0.6676653128999678, 'loss_val': 0.2975078743142247, 'psi': 0.6878069956719453}-{'f1_val': 0.7012347841865968, 'auprc': 0.6656829863997598, 'loss_val': 0.27791051157335944, 'psi': 0.6870140650718619}
[S3] START round=23 head_norm_before_train=2.049113 (no previous merge yet)
[S3] round=23 local utility u=0.000000 metrics={'f1_val': 0.9428787322827681, 'auprc': 0.9999664264990299, 'loss_val': 0.12380839811469069, 'psi': 0.9657138099692728}-{'f1_val': 0.9841834694278214, 'auprc': 0.9998859035217622, 'loss_val': 0.06227675109404156, 'psi': 0.9904644430653977}
[S4] START round=23 head_norm_before_train=1.073159 cos_to_last_merge=1.0000 (last merge round=22)
[S4] round=23 local utility u=0.000000 metrics={'f1_val': 0.6661166345527585, 'auprc': 0.9323507090227081, 'loss_val': 0.4488119552160575, 'psi': 0.7726102643407384}-{'f1_val': 0.6761215524764977, 'auprc': 0.918460639281615, 'loss_val': 0.44654396954405445, 'psi': 0.7730571871985447}
[S5] START round=23 head_norm_before_train=1.084476 cos_to_last_merge=0.9992 (last merge round=21)
[S5] round=23 local utility u=0.028454 metrics={'f1_val': 0.7003603281361598, 'auprc': 0.9968578586416966, 'loss_val': 0.3022149667053324, 'psi': 0.8189593403383746}-{'f1_val': 0.7003603281361598, 'auprc': 0.9968800072191462, 'loss_val': 0.35918881316455986, 'psi': 0.8189681997693543}
[S6] START round=23 head_norm_before_train=1.294608 cos_to_last_merge=1.0000 (last merge round=22)
[S6] round=23 local utility u=0.000000 metrics={'f1_val': 0.7881874167383303, 'auprc': 0.9117031455929043, 'loss_val': 0.44876114760894975, 'psi': 0.8375937082801599}-{'f1_val': 0.9841034425045867, 'auprc': 0.9602344876556475, 'loss_val': 0.26838936323677015, 'psi': 0.9745558605650111}
[S7] START round=23 head_norm_before_train=1.724053 (no previous merge yet)
[S7] round=23 local utility u=0.138047 metrics={'f1_val': 0.6740608170244489, 'auprc': 0.8143815912811169, 'loss_val': 0.39031412368083174, 'psi': 0.7301891267271161}-{'f1_val': 0.654535742680604, 'auprc': 0.8007292145357332, 'loss_val': 0.5083003115652053, 'psi': 0.7130131314226557}
[S8] START round=23 head_norm_before_train=1.206595 cos_to_last_merge=1.0000 (last merge round=22)
[S8] round=23 local utility u=0.000000 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9990014368778238, 'loss_val': 0.22914294894352105, 'psi': 0.9974124197125043}-{'f1_val': 0.9960878102233311, 'auprc': 0.9987942031584992, 'loss_val': 0.1189067137733136, 'psi': 0.9971703673973984}
[S9] START round=23 head_norm_before_train=1.019695 cos_to_last_merge=0.9932 (last merge round=21)
[S9] round=23 local utility u=0.033501 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9982519961560399, 'loss_val': 0.13503679168424607, 'psi': 0.9975625459697016}-{'f1_val': 0.9966891482978385, 'auprc': 0.9982151074010545, 'loss_val': 0.1994458425150913, 'psi': 0.9972995319391249}
[S10] START round=23 head_norm_before_train=1.457406 cos_to_last_merge=1.0000 (last merge round=22)
[S10] round=23 local utility u=0.009190 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9958867537144773, 'loss_val': 0.07577563323238626, 'psi': 0.9953356134048366}-{'f1_val': 0.9951878390193748, 'auprc': 0.9934861435439796, 'loss_val': 0.0882711272167446, 'psi': 0.9945071608292166}
[S11] START round=23 head_norm_before_train=0.988264 cos_to_last_merge=1.0000 (last merge round=22)
[S11] round=23 local utility u=0.000000 metrics={'f1_val': 0.9967189926998994, 'auprc': 0.9978651532385523, 'loss_val': 0.19588268707016424, 'psi': 0.9971774569153605}-{'f1_val': 0.9967189926998994, 'auprc': 0.9980530149505212, 'loss_val': 0.18003575475180222, 'psi': 0.9972526016001481}
[S13] START round=23 head_norm_before_train=1.683534 (no previous merge yet)
[S13] round=23 local utility u=0.174854 metrics={'f1_val': 0.6317619715071013, 'auprc': 0.6826179769862968, 'loss_val': 0.5070177247579142, 'psi': 0.6521043736987795}-{'f1_val': 0.5969295131327597, 'auprc': 0.6900570292699497, 'loss_val': 0.6700491083218413, 'psi': 0.6341805195876357}
[S14] START round=23 head_norm_before_train=0.999548 cos_to_last_merge=1.0000 (last merge round=22)
[S14] round=23 local utility u=0.053355 metrics={'f1_val': 0.9939023386010389, 'auprc': 0.9983428597022757, 'loss_val': 0.22939425348189973, 'psi': 0.9956785470415337}-{'f1_val': 0.99727647169645, 'auprc': 0.9984903139401703, 'loss_val': 0.356790537890354, 'psi': 0.997762008593938}
[S15] START round=23 head_norm_before_train=1.002512 cos_to_last_merge=1.0000 (last merge round=22)
[S15] round=23 local utility u=0.792834 metrics={'f1_val': 0.9958188988109067, 'auprc': 0.9924659864836818, 'loss_val': 0.2628792972941171, 'psi': 0.9944777338800167}-{'f1_val': 0.766137178976653, 'auprc': 0.963301678571044, 'loss_val': 0.3829645035979234, 'psi': 0.8450029788144094}
[S16] START round=23 head_norm_before_train=1.816575 (no previous merge yet)
[S16] round=23 local utility u=0.217265 metrics={'f1_val': 0.9355388934187903, 'auprc': 0.9782324297758767, 'loss_val': 0.30191952478097783, 'psi': 0.9526163079616248}-{'f1_val': 0.8698019352680493, 'auprc': 0.977848090003648, 'loss_val': 0.34087485167367937, 'psi': 0.9130203971622888}
[S17] START round=23 head_norm_before_train=1.311733 cos_to_last_merge=0.7442 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.744
[S17] round=23 local utility u=0.134367 metrics={'f1_val': 0.5350887934133144, 'auprc': 0.8738198981944172, 'loss_val': 0.6102272722793205, 'psi': 0.6705812353257555}-{'f1_val': 0.53869542088426, 'auprc': 0.7851771680361483, 'loss_val': 0.6346727236147163, 'psi': 0.6372881197450153}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S11@127.0.0.1:62412
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:62415
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:62407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:62404
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1804 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1804) from S9
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.110689)
[S11] loaded HEAD from S9 (vec_in norm=1.110689)
[S11] cosine check vs S9: cos=0.9345
[S11] BUFFERED delta from S9 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1799) from S5
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.108127)
[S4] loaded HEAD from S5 (vec_in norm=1.108127)
[S4] cosine check vs S5: cos=0.8149
[S4] BUFFERED delta from S5 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1797) from S15
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.045222)
[S6] loaded HEAD from S15 (vec_in norm=1.045222)
[S6] cosine check vs S15: cos=0.8942
[S6] BUFFERED delta from S15 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1803) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.057606)
[S15] loaded HEAD from S14 (vec_in norm=1.057606)
[S15] cosine check vs S14: cos=0.8772
[S15] BUFFERED delta from S14 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=23 metric=0.9967 head_norm=1.029635
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.976781e-01
[S11] stored merged vector for next round verification (round=23)
[S11] DEBUG after merge:  round=23 metric=0.9967 head_norm=1.052527 delta_norm=0.197678
[S11] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=23 metric=0.6661 head_norm=1.099523
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.358703e-01
[S4] stored merged vector for next round verification (round=23)
[S4] DEBUG after merge:  round=23 metric=0.6663 head_norm=1.051494 delta_norm=0.335870
[S4] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=23 metric=0.7882 head_norm=1.322682
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.039739e-01
[S6] stored merged vector for next round verification (round=23)
[S6] DEBUG after merge:  round=23 metric=0.7988 head_norm=1.152644 delta_norm=0.303974
[S6] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=23 metric=0.9958 head_norm=1.045222
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.606412e-01
[S15] stored merged vector for next round verification (round=23)
[S15] DEBUG after merge:  round=23 metric=0.9958 head_norm=1.018615 delta_norm=0.260641
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=1.751328 (no previous merge yet)
[S2] round=24 local utility u=0.135774 metrics={'f1_val': 0.701132579636681, 'auprc': 0.7545693657386763, 'loss_val': 0.2860578133949182, 'psi': 0.722507294077479}-{'f1_val': 0.7012347841865968, 'auprc': 0.6676653128999678, 'loss_val': 0.2975078743142247, 'psi': 0.6878069956719453}
[S3] START round=24 head_norm_before_train=2.072346 (no previous merge yet)
[S3] round=24 local utility u=0.000000 metrics={'f1_val': 0.6718196270323455, 'auprc': 0.9166593026188096, 'loss_val': 0.9479804347829618, 'psi': 0.7697554972669312}-{'f1_val': 0.9428787322827681, 'auprc': 0.9999664264990299, 'loss_val': 0.12380839811469069, 'psi': 0.9657138099692728}
[S4] START round=24 head_norm_before_train=1.051494 cos_to_last_merge=1.0000 (last merge round=23)
[S4] round=24 local utility u=0.000000 metrics={'f1_val': 0.6671529936833411, 'auprc': 0.9311171342794833, 'loss_val': 0.46916291278913047, 'psi': 0.772738649921798}-{'f1_val': 0.6661166345527585, 'auprc': 0.9323507090227081, 'loss_val': 0.4488119552160575, 'psi': 0.7726102643407384}
[S5] START round=24 head_norm_before_train=1.108127 cos_to_last_merge=0.9980 (last merge round=21)
[S5] round=24 local utility u=0.018250 metrics={'f1_val': 0.7015601689343438, 'auprc': 0.9966301217196847, 'loss_val': 0.2722310854561416, 'psi': 0.8195881500484802}-{'f1_val': 0.7003603281361598, 'auprc': 0.9968578586416966, 'loss_val': 0.3022149667053324, 'psi': 0.8189593403383746}
[S6] START round=24 head_norm_before_train=1.152644 cos_to_last_merge=1.0000 (last merge round=23)
[S6] round=24 local utility u=0.128278 metrics={'f1_val': 0.8139779595517154, 'auprc': 0.9404030339379814, 'loss_val': 0.43304826235950417, 'psi': 0.8645479893062218}-{'f1_val': 0.7881874167383303, 'auprc': 0.9117031455929043, 'loss_val': 0.44876114760894975, 'psi': 0.8375937082801599}
[S7] START round=24 head_norm_before_train=1.742258 (no previous merge yet)
[S7] round=24 local utility u=0.029528 metrics={'f1_val': 0.6727610502568034, 'auprc': 0.8259944424342446, 'loss_val': 0.3582990492010275, 'psi': 0.7340544071277799}-{'f1_val': 0.6740608170244489, 'auprc': 0.8143815912811169, 'loss_val': 0.39031412368083174, 'psi': 0.7301891267271161}
[S8] START round=24 head_norm_before_train=1.237482 cos_to_last_merge=0.9995 (last merge round=22)
[S8] round=24 local utility u=0.014524 metrics={'f1_val': 0.9950461195740685, 'auprc': 0.9991459043376322, 'loss_val': 0.19268617710881433, 'psi': 0.9966860334794939}-{'f1_val': 0.9963530749356245, 'auprc': 0.9990014368778238, 'loss_val': 0.22914294894352105, 'psi': 0.9974124197125043}
[S9] START round=24 head_norm_before_train=1.110689 cos_to_last_merge=0.9804 (last merge round=21)
[S9] round=24 local utility u=0.016122 metrics={'f1_val': 0.9966891482978385, 'auprc': 0.9983253067778186, 'loss_val': 0.10053059842975419, 'psi': 0.9973436116898305}-{'f1_val': 0.9971029125121428, 'auprc': 0.9982519961560399, 'loss_val': 0.13503679168424607, 'psi': 0.9975625459697016}
[S10] START round=24 head_norm_before_train=1.485155 cos_to_last_merge=0.9998 (last merge round=22)
[S10] round=24 local utility u=0.007203 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9964610080037358, 'loss_val': 0.06045790620088423, 'psi': 0.9953018672805309}-{'f1_val': 0.9949681865317428, 'auprc': 0.9958867537144773, 'loss_val': 0.07577563323238626, 'psi': 0.9953356134048366}
[S11] START round=24 head_norm_before_train=1.052527 cos_to_last_merge=1.0000 (last merge round=23)
[S11] round=24 local utility u=0.001315 metrics={'f1_val': 0.9967189926998994, 'auprc': 0.998263819920199, 'loss_val': 0.19444841693337145, 'psi': 0.9973369235880192}-{'f1_val': 0.9967189926998994, 'auprc': 0.9978651532385523, 'loss_val': 0.19588268707016424, 'psi': 0.9971774569153605}
[S13] START round=24 head_norm_before_train=1.692654 (no previous merge yet)
[S13] round=24 local utility u=0.000000 metrics={'f1_val': 0.601049320976576, 'auprc': 0.6900107054537471, 'loss_val': 0.6935266343862129, 'psi': 0.6366338747674445}-{'f1_val': 0.6317619715071013, 'auprc': 0.6826179769862968, 'loss_val': 0.5070177247579142, 'psi': 0.6521043736987795}
[S14] START round=24 head_norm_before_train=1.057606 cos_to_last_merge=0.9980 (last merge round=22)
[S14] round=24 local utility u=0.033383 metrics={'f1_val': 0.9968657110110009, 'auprc': 0.9967638090246043, 'loss_val': 0.17567064818198622, 'psi': 0.9968249502164421}-{'f1_val': 0.9939023386010389, 'auprc': 0.9983428597022757, 'loss_val': 0.22939425348189973, 'psi': 0.9956785470415337}
[S15] START round=24 head_norm_before_train=1.018615 cos_to_last_merge=1.0000 (last merge round=23)
[S15] round=24 local utility u=0.000000 metrics={'f1_val': 0.7021146389164286, 'auprc': 0.8666493759651961, 'loss_val': 0.48034899882456833, 'psi': 0.7679285337359356}-{'f1_val': 0.9958188988109067, 'auprc': 0.9924659864836818, 'loss_val': 0.2628792972941171, 'psi': 0.9944777338800167}
[S16] START round=24 head_norm_before_train=1.831093 (no previous merge yet)
[S16] round=24 local utility u=0.000000 metrics={'f1_val': 0.8399096224092817, 'auprc': 0.8788637521155735, 'loss_val': 0.9060261274164411, 'psi': 0.8554912742917984}-{'f1_val': 0.9355388934187903, 'auprc': 0.9782324297758767, 'loss_val': 0.30191952478097783, 'psi': 0.9526163079616248}
[S17] START round=24 head_norm_before_train=1.325325 cos_to_last_merge=0.7424 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.742
[S17] round=24 local utility u=0.203456 metrics={'f1_val': 0.5719131172544668, 'auprc': 0.920789197386369, 'loss_val': 0.5651689807258484, 'psi': 0.7114635493072277}-{'f1_val': 0.5350887934133144, 'auprc': 0.8738198981944172, 'loss_val': 0.6102272722793205, 'psi': 0.6705812353257555}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:62409
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:62403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:62415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S4@127.0.0.1:62404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] → sending delta(kind=head bytes=1805) to S14@127.0.0.1:62414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:62412
[S9] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1805 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1804 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1798) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.110954)
[S15] loaded HEAD from S14 (vec_in norm=1.110954)
[S15] cosine check vs S14: cos=0.9576
[S15] BUFFERED delta from S14 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1805) from S11
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.092895)
[S14] loaded HEAD from S11 (vec_in norm=1.092895)
[S14] cosine check vs S11: cos=0.9359
[S14] BUFFERED delta from S11 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1802) from S6
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.179931)
[S8] loaded HEAD from S6 (vec_in norm=1.179931)
[S8] cosine check vs S6: cos=0.8580
[S8] BUFFERED delta from S6 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1802) from S2
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.758695)
[S3] loaded HEAD from S2 (vec_in norm=1.758695)
[S3] cosine check vs S2: cos=-0.0493
[S3] DROPPED delta from S2 (cos=-0.0493 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1797) from S9
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.184314)
[S11] loaded HEAD from S9 (vec_in norm=1.184314)
[S11] cosine check vs S9: cos=0.9757
[S11] BUFFERED delta from S9 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1804) from S5
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.135213)
[S4] loaded HEAD from S5 (vec_in norm=1.135213)
[S4] cosine check vs S5: cos=0.9463
[S4] BUFFERED delta from S5 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=24 metric=0.6672 head_norm=1.078718
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.835617e-01
[S4] stored merged vector for next round verification (round=24)
[S4] DEBUG after merge:  round=24 metric=0.6672 head_norm=1.092005 delta_norm=0.183562
[S4] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=24 metric=0.9950 head_norm=1.287156
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.327781e-01
[S8] stored merged vector for next round verification (round=24)
[S8] DEBUG after merge:  round=24 metric=0.9913 head_norm=1.189017 delta_norm=0.332778
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=24 metric=0.7021 head_norm=1.066506
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.600676e-01
[S15] stored merged vector for next round verification (round=24)
[S15] DEBUG after merge:  round=24 metric=0.7010 head_norm=1.077128 delta_norm=0.160068
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=24 metric=0.9967 head_norm=1.092895
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.334779e-01
[S11] stored merged vector for next round verification (round=24)
[S11] DEBUG after merge:  round=24 metric=0.9967 head_norm=1.131677 delta_norm=0.133478
[S11] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=24 metric=0.9969 head_norm=1.110954
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.974497e-01
[S14] stored merged vector for next round verification (round=24)
[S14] DEBUG after merge:  round=24 metric=0.9966 head_norm=1.084128 delta_norm=0.197450
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=25 head_norm_before_train=1.758695 (no previous merge yet)
[S2] round=25 local utility u=0.000000 metrics={'f1_val': 0.6977035355485244, 'auprc': 0.675769247142624, 'loss_val': 0.2998187876885782, 'psi': 0.6889298201861642}-{'f1_val': 0.701132579636681, 'auprc': 0.7545693657386763, 'loss_val': 0.2860578133949182, 'psi': 0.722507294077479}
[S3] START round=25 head_norm_before_train=2.091218 (no previous merge yet)
[S3] round=25 local utility u=1.000000 metrics={'f1_val': 0.9333688439197494, 'auprc': 0.9995720256363633, 'loss_val': 0.14765399861559178, 'psi': 0.959850116606395}-{'f1_val': 0.6718196270323455, 'auprc': 0.9166593026188096, 'loss_val': 0.9479804347829618, 'psi': 0.7697554972669312}
[S4] START round=25 head_norm_before_train=1.092005 cos_to_last_merge=1.0000 (last merge round=24)
[S4] round=25 local utility u=0.000000 metrics={'f1_val': 0.6654117525779748, 'auprc': 0.902823035772234, 'loss_val': 0.4889088156940055, 'psi': 0.7603762658556785}-{'f1_val': 0.6671529936833411, 'auprc': 0.9311171342794833, 'loss_val': 0.46916291278913047, 'psi': 0.772738649921798}
[S5] START round=25 head_norm_before_train=1.135213 cos_to_last_merge=0.9964 (last merge round=21)
[S5] round=25 local utility u=0.871442 metrics={'f1_val': 0.9861693455180395, 'auprc': 0.9955744158602121, 'loss_val': 0.23383486325323102, 'psi': 0.9899313736549085}-{'f1_val': 0.7015601689343438, 'auprc': 0.9966301217196847, 'loss_val': 0.2722310854561416, 'psi': 0.8195881500484802}
[S6] START round=25 head_norm_before_train=1.179931 cos_to_last_merge=0.9994 (last merge round=23)
[S6] round=25 local utility u=0.000000 metrics={'f1_val': 0.5894547336605456, 'auprc': 0.7965112747980228, 'loss_val': 0.6748499285871238, 'psi': 0.6722773501155365}-{'f1_val': 0.8139779595517154, 'auprc': 0.9404030339379814, 'loss_val': 0.43304826235950417, 'psi': 0.8645479893062218}
[S7] START round=25 head_norm_before_train=1.756986 (no previous merge yet)
[S7] round=25 local utility u=0.000000 metrics={'f1_val': 0.6695693061337566, 'auprc': 0.8284611326250688, 'loss_val': 0.35601295059966453, 'psi': 0.7331260367302815}-{'f1_val': 0.6727610502568034, 'auprc': 0.8259944424342446, 'loss_val': 0.3582990492010275, 'psi': 0.7340544071277799}
[S8] START round=25 head_norm_before_train=1.189017 cos_to_last_merge=1.0000 (last merge round=24)
[S8] round=25 local utility u=0.000000 metrics={'f1_val': 0.9956124759962259, 'auprc': 0.9990003408687147, 'loss_val': 0.21418227744235466, 'psi': 0.9969676219452215}-{'f1_val': 0.9950461195740685, 'auprc': 0.9991459043376322, 'loss_val': 0.19268617710881433, 'psi': 0.9966860334794939}
[S9] START round=25 head_norm_before_train=1.184314 cos_to_last_merge=0.9696 (last merge round=21)
[S9] round=25 local utility u=0.010063 metrics={'f1_val': 0.9966891482978385, 'auprc': 0.9983356192372621, 'loss_val': 0.08043568912578328, 'psi': 0.997347736673608}-{'f1_val': 0.9966891482978385, 'auprc': 0.9983253067778186, 'loss_val': 0.10053059842975419, 'psi': 0.9973436116898305}
[S10] START round=25 head_norm_before_train=1.515478 cos_to_last_merge=0.9990 (last merge round=22)
[S10] round=25 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9942343917528377, 'loss_val': 0.055298882162303026, 'psi': 0.9945429222327586}-{'f1_val': 0.9945291067983943, 'auprc': 0.9964610080037358, 'loss_val': 0.06045790620088423, 'psi': 0.9953018672805309}
[S11] START round=25 head_norm_before_train=1.131677 cos_to_last_merge=1.0000 (last merge round=24)
[S11] round=25 local utility u=0.015420 metrics={'f1_val': 0.9967189926998994, 'auprc': 0.9982360038888591, 'loss_val': 0.16352439995341012, 'psi': 0.9973257971754832}-{'f1_val': 0.9967189926998994, 'auprc': 0.998263819920199, 'loss_val': 0.19444841693337145, 'psi': 0.9973369235880192}
[S13] START round=25 head_norm_before_train=1.704930 (no previous merge yet)
[S13] round=25 local utility u=0.123116 metrics={'f1_val': 0.6261286022330572, 'auprc': 0.6864093181698181, 'loss_val': 0.586966845457822, 'psi': 0.6502408886077615}-{'f1_val': 0.601049320976576, 'auprc': 0.6900107054537471, 'loss_val': 0.6935266343862129, 'psi': 0.6366338747674445}
[S14] START round=25 head_norm_before_train=1.084128 cos_to_last_merge=1.0000 (last merge round=24)
[S14] round=25 local utility u=0.000000 metrics={'f1_val': 0.9969087112076659, 'auprc': 0.9965151454714758, 'loss_val': 0.17834029711903823, 'psi': 0.9967512849131899}-{'f1_val': 0.9968657110110009, 'auprc': 0.9967638090246043, 'loss_val': 0.17567064818198622, 'psi': 0.9968249502164421}
[S15] START round=25 head_norm_before_train=1.077128 cos_to_last_merge=1.0000 (last merge round=24)
[S15] round=25 local utility u=1.000000 metrics={'f1_val': 0.9735625816367444, 'auprc': 0.9969905818747988, 'loss_val': 0.24978297567389343, 'psi': 0.9829337817319661}-{'f1_val': 0.7021146389164286, 'auprc': 0.8666493759651961, 'loss_val': 0.48034899882456833, 'psi': 0.7679285337359356}
[S16] START round=25 head_norm_before_train=1.846941 (no previous merge yet)
[S16] round=25 local utility u=0.000000 metrics={'f1_val': 0.837856031720835, 'auprc': 0.8796341110366287, 'loss_val': 0.9524461496534096, 'psi': 0.8545672634471525}-{'f1_val': 0.8399096224092817, 'auprc': 0.8788637521155735, 'loss_val': 0.9060261274164411, 'psi': 0.8554912742917984}
[S17] START round=25 head_norm_before_train=1.338682 cos_to_last_merge=0.7422 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.742
[S17] round=25 local utility u=0.217424 metrics={'f1_val': 0.6344460330005178, 'auprc': 0.9303006640578618, 'loss_val': 0.5340522085659875, 'psi': 0.7527878854234554}-{'f1_val': 0.5719131172544668, 'auprc': 0.920789197386369, 'loss_val': 0.5651689807258484, 'psi': 0.7114635493072277}
[S3]  timeout peer S2
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:62412
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:62414
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:62407
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] → sending delta(kind=head bytes=1793) to S4@127.0.0.1:62404
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1793 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1799) from S11
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.168438)
[S14] loaded HEAD from S11 (vec_in norm=1.168438)
[S14] cosine check vs S11: cos=0.9587
[S14] BUFFERED delta from S11 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1797) from S9
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.241203)
[S11] loaded HEAD from S9 (vec_in norm=1.241203)
[S11] cosine check vs S9: cos=0.9885
[S11] BUFFERED delta from S9 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1793) from S5
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.168273)
[S4] loaded HEAD from S5 (vec_in norm=1.168273)
[S4] cosine check vs S5: cos=0.9807
[S4] BUFFERED delta from S5 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1799) from S15
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.121641)
[S6] loaded HEAD from S15 (vec_in norm=1.121641)
[S6] cosine check vs S15: cos=0.8415
[S6] BUFFERED delta from S15 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S17] sending update (kind=head size=1807 to 1 peers)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=25 metric=0.9969 head_norm=1.130366
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.662621e-01
[S14] stored merged vector for next round verification (round=25)
[S14] DEBUG after merge:  round=25 metric=0.9969 head_norm=1.137473 delta_norm=0.166262
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.062 → S15@127.0.0.1:62415
[S2] ⇄ pheromone p=0.049 → S3@127.0.0.1:62403
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=25 metric=0.5895 head_norm=1.210391
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.309939e-01
[S6] stored merged vector for next round verification (round=25)
[S6] DEBUG after merge:  round=25 metric=0.6004 head_norm=1.118931 delta_norm=0.330994
[S6] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.178 → S8@127.0.0.1:62409
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=25 metric=0.6654 head_norm=1.118682
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.150395e-01
[S4] stored merged vector for next round verification (round=25)
[S4] DEBUG after merge:  round=25 metric=0.6658 head_norm=1.137946 delta_norm=0.115039
[S4] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.060 → S10@127.0.0.1:62411
[S15] ⇄ pheromone p=0.455 → S6@127.0.0.1:62407
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=25 metric=0.9967 head_norm=1.168438
[S11] _apply_head_vector_avg (torch): Δ‖w‖=9.845841e-02
[S11] stored merged vector for next round verification (round=25)
[S11] DEBUG after merge:  round=25 metric=0.9967 head_norm=1.201342 delta_norm=0.098458
[S11] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.079 → S14@127.0.0.1:62414
[S5] ⇄ pheromone p=0.235 → S4@127.0.0.1:62404
[S9] ⇄ pheromone p=0.049 → S11@127.0.0.1:62412
[S2] START round=26 head_norm_before_train=1.765774 (no previous merge yet)
[S2] round=26 local utility u=0.062361 metrics={'f1_val': 0.675164254837674, 'auprc': 0.7978548958455558, 'loss_val': 0.40611836941436374, 'psi': 0.7242405112408268}-{'f1_val': 0.6977035355485244, 'auprc': 0.675769247142624, 'loss_val': 0.2998187876885782, 'psi': 0.6889298201861642}
[S3] START round=26 head_norm_before_train=2.110085 (no previous merge yet)
[S3] round=26 local utility u=0.258941 metrics={'f1_val': 0.998064654318121, 'auprc': 0.9996113462154298, 'loss_val': 0.018065733671535755, 'psi': 0.9986833310770445}-{'f1_val': 0.9333688439197494, 'auprc': 0.9995720256363633, 'loss_val': 0.14765399861559178, 'psi': 0.959850116606395}
[S4] START round=26 head_norm_before_train=1.137946 cos_to_last_merge=1.0000 (last merge round=25)
[S4] round=26 local utility u=0.062333 metrics={'f1_val': 0.6661166345527585, 'auprc': 0.9372279620512752, 'loss_val': 0.47168619166011894, 'psi': 0.7745611655521651}-{'f1_val': 0.6654117525779748, 'auprc': 0.902823035772234, 'loss_val': 0.4889088156940055, 'psi': 0.7603762658556785}
[S5] START round=26 head_norm_before_train=1.168273 cos_to_last_merge=0.9938 (last merge round=21)
[S5] round=26 local utility u=0.000000 metrics={'f1_val': 0.7143712450552575, 'auprc': 0.8262969727203859, 'loss_val': 0.3907646207821769, 'psi': 0.759141536121309}-{'f1_val': 0.9861693455180395, 'auprc': 0.9955744158602121, 'loss_val': 0.23383486325323102, 'psi': 0.9899313736549085}
[S6] START round=26 head_norm_before_train=1.118931 cos_to_last_merge=1.0000 (last merge round=25)
[S6] round=26 local utility u=1.000000 metrics={'f1_val': 0.8491341684446426, 'auprc': 0.9588445116307183, 'loss_val': 0.35967150075137405, 'psi': 0.8930183057190728}-{'f1_val': 0.5894547336605456, 'auprc': 0.7965112747980228, 'loss_val': 0.6748499285871238, 'psi': 0.6722773501155365}
[S7] START round=26 head_norm_before_train=1.766840 (no previous merge yet)
[S7] round=26 local utility u=0.237002 metrics={'f1_val': 0.6957107367827038, 'auprc': 0.8942336276057132, 'loss_val': 0.23617408211230081, 'psi': 0.7751198931119077}-{'f1_val': 0.6695693061337566, 'auprc': 0.8284611326250688, 'loss_val': 0.35601295059966453, 'psi': 0.7331260367302815}
[S8] START round=26 head_norm_before_train=1.247854 cos_to_last_merge=0.9982 (last merge round=24)
[S8] round=26 local utility u=0.005556 metrics={'f1_val': 0.9929803441450545, 'auprc': 0.9984004041765435, 'loss_val': 0.18547739991359352, 'psi': 0.9951483681576501}-{'f1_val': 0.9956124759962259, 'auprc': 0.9990003408687147, 'loss_val': 0.21418227744235466, 'psi': 0.9969676219452215}
[S9] START round=26 head_norm_before_train=1.241203 cos_to_last_merge=0.9614 (last merge round=21)
[S9] round=26 local utility u=0.000000 metrics={'f1_val': 0.9897262816474692, 'auprc': 0.9982748776345576, 'loss_val': 0.07968418140742513, 'psi': 0.9931457200423046}-{'f1_val': 0.9966891482978385, 'auprc': 0.9983356192372621, 'loss_val': 0.08043568912578328, 'psi': 0.997347736673608}
[S10] START round=26 head_norm_before_train=1.541783 cos_to_last_merge=0.9980 (last merge round=22)
[S10] round=26 local utility u=0.002744 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.9962073832006015, 'loss_val': 0.04783522128697061, 'psi': 0.9945425781727841}-{'f1_val': 0.9947486092193725, 'auprc': 0.9942343917528377, 'loss_val': 0.055298882162303026, 'psi': 0.9945429222327586}
[S11] START round=26 head_norm_before_train=1.201342 cos_to_last_merge=1.0000 (last merge round=25)
[S11] round=26 local utility u=0.000000 metrics={'f1_val': 0.9904946458514197, 'auprc': 0.9987307661520227, 'loss_val': 0.17229105797182975, 'psi': 0.9937890939716609}-{'f1_val': 0.9967189926998994, 'auprc': 0.9982360038888591, 'loss_val': 0.16352439995341012, 'psi': 0.9973257971754832}
[S13] START round=26 head_norm_before_train=1.713721 (no previous merge yet)
[S13] round=26 local utility u=0.000000 metrics={'f1_val': 0.6059916897516406, 'auprc': 0.6897516231482419, 'loss_val': 0.6620673422305204, 'psi': 0.639495663110281}-{'f1_val': 0.6261286022330572, 'auprc': 0.6864093181698181, 'loss_val': 0.586966845457822, 'psi': 0.6502408886077615}
[S14] START round=26 head_norm_before_train=1.137473 cos_to_last_merge=1.0000 (last merge round=25)
[S14] round=26 local utility u=0.000000 metrics={'f1_val': 0.98095638300656, 'auprc': 0.9985983485098042, 'loss_val': 0.17925533629213494, 'psi': 0.9880131692078576}-{'f1_val': 0.9969087112076659, 'auprc': 0.9965151454714758, 'loss_val': 0.17834029711903823, 'psi': 0.9967512849131899}
[S15] START round=26 head_norm_before_train=1.121641 cos_to_last_merge=0.9979 (last merge round=24)
[S15] round=26 local utility u=0.000000 metrics={'f1_val': 0.9547260778626561, 'auprc': 0.9963927658560493, 'loss_val': 0.21528382821557052, 'psi': 0.9713927530600133}-{'f1_val': 0.9735625816367444, 'auprc': 0.9969905818747988, 'loss_val': 0.24978297567389343, 'psi': 0.9829337817319661}
[S16] START round=26 head_norm_before_train=1.863052 (no previous merge yet)
[S16] round=26 local utility u=0.915233 metrics={'f1_val': 0.9552103519254336, 'auprc': 0.9866226142605008, 'loss_val': 0.14707132425620068, 'psi': 0.9677752568594604}-{'f1_val': 0.837856031720835, 'auprc': 0.8796341110366287, 'loss_val': 0.9524461496534096, 'psi': 0.8545672634471525}
[S17] START round=26 head_norm_before_train=1.360810 cos_to_last_merge=0.7408 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.741
[S17] round=26 local utility u=0.000000 metrics={'f1_val': 0.5474767282454871, 'auprc': 0.9299932939194157, 'loss_val': 0.5417693708014473, 'psi': 0.7004833545150585}-{'f1_val': 0.6344460330005178, 'auprc': 0.9303006640578618, 'loss_val': 0.5340522085659875, 'psi': 0.7527878854234554}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:62407
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:62404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:62405
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:62415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:62403
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1802) from S4
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.164117)
[S5] loaded HEAD from S4 (vec_in norm=1.164117)
[S5] cosine check vs S4: cos=0.9902
[S5] BUFFERED delta from S4 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1796) from S6
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.145055)
[S15] loaded HEAD from S6 (vec_in norm=1.145055)
[S15] cosine check vs S6: cos=0.9559
[S15] BUFFERED delta from S6 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1800) from S2
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.775183)
[S3] loaded HEAD from S2 (vec_in norm=1.775183)
[S3] cosine check vs S2: cos=-0.0496
[S3] DROPPED delta from S2 (cos=-0.0496 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1797) from S10
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.566690)
[S4] loaded HEAD from S10 (vec_in norm=1.566690)
[S4] cosine check vs S10: cos=0.5388
[S4] BUFFERED delta from S10 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1803) from S8
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.312668)
[S6] loaded HEAD from S8 (vec_in norm=1.312668)
[S6] cosine check vs S8: cos=0.8836
[S6] BUFFERED delta from S8 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=26 metric=0.7144 head_norm=1.194883
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.406717e-02
[S5] stored merged vector for next round verification (round=26)
[S5] DEBUG after merge:  round=26 metric=0.7144 head_norm=1.176601 delta_norm=0.084067
[S5] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=26 metric=0.9547 head_norm=1.160728
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.714068e-01
[S15] stored merged vector for next round verification (round=26)
[S15] DEBUG after merge:  round=26 metric=0.9547 head_norm=1.140105 delta_norm=0.171407
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=26 metric=0.6661 head_norm=1.164117
[S4] _apply_head_vector_avg (torch): Δ‖w‖=6.790194e-01
[S4] stored merged vector for next round verification (round=26)
[S4] DEBUG after merge:  round=26 metric=0.9414 head_norm=1.201572 delta_norm=0.679019
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=26 metric=0.8491 head_norm=1.145055
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.073798e-01
[S6] stored merged vector for next round verification (round=26)
[S6] DEBUG after merge:  round=26 metric=0.8491 head_norm=1.192745 delta_norm=0.307380
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=27 head_norm_before_train=1.775183 (no previous merge yet)
[S2] round=27 local utility u=0.024829 metrics={'f1_val': 0.6931207665942232, 'auprc': 0.7445603975615618, 'loss_val': 0.304316693789945, 'psi': 0.7136966189811587}-{'f1_val': 0.675164254837674, 'auprc': 0.7978548958455558, 'loss_val': 0.40611836941436374, 'psi': 0.7242405112408268}
[S3] START round=27 head_norm_before_train=2.126812 (no previous merge yet)
[S3] round=27 local utility u=0.000000 metrics={'f1_val': 0.9764163028254761, 'auprc': 0.9995834100414611, 'loss_val': 0.04205657410708201, 'psi': 0.9856831457118702}-{'f1_val': 0.998064654318121, 'auprc': 0.9996113462154298, 'loss_val': 0.018065733671535755, 'psi': 0.9986833310770445}
[S4] START round=27 head_norm_before_train=1.201572 cos_to_last_merge=1.0000 (last merge round=26)
[S4] round=27 local utility u=0.941936 metrics={'f1_val': 0.9601229470341228, 'auprc': 0.9449632148984239, 'loss_val': 0.3750576677218137, 'psi': 0.9540590541798433}-{'f1_val': 0.6661166345527585, 'auprc': 0.9372279620512752, 'loss_val': 0.47168619166011894, 'psi': 0.7745611655521651}
[S5] START round=27 head_norm_before_train=1.176601 cos_to_last_merge=1.0000 (last merge round=26)
[S5] round=27 local utility u=1.000000 metrics={'f1_val': 0.9963325909888239, 'auprc': 0.9955608823969209, 'loss_val': 0.19477019066972065, 'psi': 0.9960239075520626}-{'f1_val': 0.7143712450552575, 'auprc': 0.8262969727203859, 'loss_val': 0.3907646207821769, 'psi': 0.759141536121309}
[S6] START round=27 head_norm_before_train=1.192745 cos_to_last_merge=1.0000 (last merge round=26)
[S6] round=27 local utility u=0.000000 metrics={'f1_val': 0.8277609030363953, 'auprc': 0.9443405562266631, 'loss_val': 0.3962757122687666, 'psi': 0.8743927643125025}-{'f1_val': 0.8491341684446426, 'auprc': 0.9588445116307183, 'loss_val': 0.35967150075137405, 'psi': 0.8930183057190728}
[S7] START round=27 head_norm_before_train=1.777125 (no previous merge yet)
[S7] round=27 local utility u=0.000000 metrics={'f1_val': 0.5301568046003489, 'auprc': 0.781605168804633, 'loss_val': 0.9972465044509381, 'psi': 0.6307361502820625}-{'f1_val': 0.6957107367827038, 'auprc': 0.8942336276057132, 'loss_val': 0.23617408211230081, 'psi': 0.7751198931119077}
[S8] START round=27 head_norm_before_train=1.312668 cos_to_last_merge=0.9936 (last merge round=24)
[S8] round=27 local utility u=0.000000 metrics={'f1_val': 0.7163972611030105, 'auprc': 0.9988369689905953, 'loss_val': 0.20509268152652357, 'psi': 0.8293731442580444}-{'f1_val': 0.9929803441450545, 'auprc': 0.9984004041765435, 'loss_val': 0.18547739991359352, 'psi': 0.9951483681576501}
[S9] START round=27 head_norm_before_train=1.288326 cos_to_last_merge=0.9549 (last merge round=21)
[S9] round=27 local utility u=0.026610 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9952012666374339, 'loss_val': 0.06000111901827561, 'psi': 0.9961920579103278}-{'f1_val': 0.9897262816474692, 'auprc': 0.9982748776345576, 'loss_val': 0.07968418140742513, 'psi': 0.9931457200423046}
[S10] START round=27 head_norm_before_train=1.566690 cos_to_last_merge=0.9971 (last merge round=22)
[S10] round=27 local utility u=0.002089 metrics={'f1_val': 0.9936518403636662, 'auprc': 0.996456325834991, 'loss_val': 0.04571881684093272, 'psi': 0.994773634552196}-{'f1_val': 0.9934327081542391, 'auprc': 0.9962073832006015, 'loss_val': 0.04783522128697061, 'psi': 0.9945425781727841}
[S11] START round=27 head_norm_before_train=1.239198 cos_to_last_merge=0.9992 (last merge round=25)
[S11] round=27 local utility u=0.046299 metrics={'f1_val': 0.9967189926998994, 'auprc': 0.9966036754338675, 'loss_val': 0.11065792789016393, 'psi': 0.9966728657934866}-{'f1_val': 0.9904946458514197, 'auprc': 0.9987307661520227, 'loss_val': 0.17229105797182975, 'psi': 0.9937890939716609}
[S13] START round=27 head_norm_before_train=1.723122 (no previous merge yet)
[S13] round=27 local utility u=0.093916 metrics={'f1_val': 0.6267479071430041, 'auprc': 0.6897069505396359, 'loss_val': 0.5986389441376693, 'psi': 0.6519315245016568}-{'f1_val': 0.6059916897516406, 'auprc': 0.6897516231482419, 'loss_val': 0.6620673422305204, 'psi': 0.639495663110281}
[S14] START round=27 head_norm_before_train=1.183820 cos_to_last_merge=0.9983 (last merge round=25)
[S14] round=27 local utility u=0.071517 metrics={'f1_val': 0.9969056262802267, 'auprc': 0.9985631189867132, 'loss_val': 0.13181182693678092, 'psi': 0.9975686233628214}-{'f1_val': 0.98095638300656, 'auprc': 0.9985983485098042, 'loss_val': 0.17925533629213494, 'psi': 0.9880131692078576}
[S15] START round=27 head_norm_before_train=1.140105 cos_to_last_merge=1.0000 (last merge round=26)
[S15] round=27 local utility u=0.000000 metrics={'f1_val': 0.7195150380724201, 'auprc': 0.9160834079977057, 'loss_val': 0.4117647261286777, 'psi': 0.7981423860425344}-{'f1_val': 0.9547260778626561, 'auprc': 0.9963927658560493, 'loss_val': 0.21528382821557052, 'psi': 0.9713927530600133}
[S16] START round=27 head_norm_before_train=1.878941 (no previous merge yet)
[S16] round=27 local utility u=0.071045 metrics={'f1_val': 0.9736636490919673, 'auprc': 0.9858652870502318, 'loss_val': 0.11342814179476397, 'psi': 0.9785443042752732}-{'f1_val': 0.9552103519254336, 'auprc': 0.9866226142605008, 'loss_val': 0.14707132425620068, 'psi': 0.9677752568594604}
[S17] START round=27 head_norm_before_train=1.390670 cos_to_last_merge=0.7384 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.738
[S17] round=27 local utility u=0.668777 metrics={'f1_val': 0.7565047648970091, 'auprc': 0.9301977808630617, 'loss_val': 0.45899627080526517, 'psi': 0.8259819712834302}-{'f1_val': 0.5474767282454871, 'auprc': 0.9299932939194157, 'loss_val': 0.5417693708014473, 'psi': 0.7004833545150585}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:62412
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:62405
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:62403
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S4@127.0.0.1:62404
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:62414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:62415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:62404
[S5] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1804 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1800) from S9
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.323507)
[S11] loaded HEAD from S9 (vec_in norm=1.323507)
[S11] cosine check vs S9: cos=0.9885
[S11] BUFFERED delta from S9 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1799) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.234075)
[S15] loaded HEAD from S14 (vec_in norm=1.234075)
[S15] cosine check vs S14: cos=0.8437
[S15] BUFFERED delta from S14 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1795) from S11
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.272698)
[S14] loaded HEAD from S11 (vec_in norm=1.272698)
[S14] cosine check vs S11: cos=0.9680
[S14] BUFFERED delta from S11 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1799) from S2
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.783678)
[S3] loaded HEAD from S2 (vec_in norm=1.783678)
[S3] cosine check vs S2: cos=-0.0497
[S3] DROPPED delta from S2 (cos=-0.0497 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1799) from S4
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.234179)
[S5] loaded HEAD from S4 (vec_in norm=1.234179)
[S5] cosine check vs S4: cos=0.8012
[S5] BUFFERED delta from S4 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1802) from S5
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.197509)
[S4] loaded HEAD from S5 (vec_in norm=1.197509)
[S4] cosine check vs S5: cos=0.8012
[S4] BUFFERED delta from S5 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1804) from S10
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.587802)
[S4] loaded HEAD from S10 (vec_in norm=1.587802)
[S4] cosine check vs S10: cos=0.9128
[S4] BUFFERED delta from S10 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=27 metric=0.7195 head_norm=1.182820
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.387373e-01
[S15] stored merged vector for next round verification (round=27)
[S15] DEBUG after merge:  round=27 metric=0.7033 head_norm=1.160284 delta_norm=0.338737
[S15] aggregate: ROLLBACK (f1_val pre=0.720 post=0.703 tol_abs=0.005 tol_rel=0.0)
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=27 metric=0.9601 head_norm=1.234179
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.068221e-02
[S4] stored merged vector for next round verification (round=27)
[S4] DEBUG after merge:  round=27 metric=0.9127 head_norm=1.219875 delta_norm=0.040682
[S4] aggregate: ROLLBACK (f1_val pre=0.960 post=0.913 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=27 metric=0.9969 head_norm=1.234075
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.596026e-01
[S14] stored merged vector for next round verification (round=27)
[S14] DEBUG after merge:  round=27 metric=0.9973 head_norm=1.243334 delta_norm=0.159603
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=27 metric=0.9967 head_norm=1.272698
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.016623e-01
[S11] stored merged vector for next round verification (round=27)
[S11] DEBUG after merge:  round=27 metric=0.9967 head_norm=1.294365 delta_norm=0.101662
[S11] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=27 metric=0.9963 head_norm=1.197509
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.837224e-01
[S5] stored merged vector for next round verification (round=27)
[S5] DEBUG after merge:  round=27 metric=0.9962 head_norm=1.153850 delta_norm=0.383722
[S5] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=28 head_norm_before_train=1.783678 (no previous merge yet)
[S2] round=28 local utility u=0.000000 metrics={'f1_val': 0.7045210233104157, 'auprc': 0.7010955770972234, 'loss_val': 0.2965854852310594, 'psi': 0.7031508448251387}-{'f1_val': 0.6931207665942232, 'auprc': 0.7445603975615618, 'loss_val': 0.304316693789945, 'psi': 0.7136966189811587}
[S3] START round=28 head_norm_before_train=2.144318 (no previous merge yet)
[S3] round=28 local utility u=0.000000 metrics={'f1_val': 0.9613297054499484, 'auprc': 0.9999760509023101, 'loss_val': 0.0978727993810934, 'psi': 0.9767882436308932}-{'f1_val': 0.9764163028254761, 'auprc': 0.9995834100414611, 'loss_val': 0.04205657410708201, 'psi': 0.9856831457118702}
[S4] START round=28 head_norm_before_train=1.219875 cos_to_last_merge=1.0000 (last merge round=27)
[S4] round=28 local utility u=0.000000 metrics={'f1_val': 0.9391784819795275, 'auprc': 0.9529054160751423, 'loss_val': 0.422838068738721, 'psi': 0.9446692556177734}-{'f1_val': 0.9601229470341228, 'auprc': 0.9449632148984239, 'loss_val': 0.3750576677218137, 'psi': 0.9540590541798433}
[S5] START round=28 head_norm_before_train=1.153850 cos_to_last_merge=1.0000 (last merge round=27)
[S5] round=28 local utility u=0.000000 metrics={'f1_val': 0.9335372718474043, 'auprc': 0.9902637463734496, 'loss_val': 0.2647559642331352, 'psi': 0.9562278616578224}-{'f1_val': 0.9963325909888239, 'auprc': 0.9955608823969209, 'loss_val': 0.19477019066972065, 'psi': 0.9960239075520626}
[S6] START round=28 head_norm_before_train=1.230521 cos_to_last_merge=0.9994 (last merge round=26)
[S6] round=28 local utility u=0.000000 metrics={'f1_val': 0.7240823205845939, 'auprc': 0.8267631920607517, 'loss_val': 0.5531104288695796, 'psi': 0.765154669175057}-{'f1_val': 0.8277609030363953, 'auprc': 0.9443405562266631, 'loss_val': 0.3962757122687666, 'psi': 0.8743927643125025}
[S7] START round=28 head_norm_before_train=1.786137 (no previous merge yet)
[S7] round=28 local utility u=0.371941 metrics={'f1_val': 0.6045635413006143, 'auprc': 0.7877505414288082, 'loss_val': 0.7182406524457122, 'psi': 0.6778383413518918}-{'f1_val': 0.5301568046003489, 'auprc': 0.781605168804633, 'loss_val': 0.9972465044509381, 'psi': 0.6307361502820625}
[S8] START round=28 head_norm_before_train=1.369061 cos_to_last_merge=0.9882 (last merge round=24)
[S8] round=28 local utility u=0.839087 metrics={'f1_val': 0.9880714959555419, 'auprc': 0.9971432076618404, 'loss_val': 0.15188209977904626, 'psi': 0.9917001806380612}-{'f1_val': 0.7163972611030105, 'auprc': 0.9988369689905953, 'loss_val': 0.20509268152652357, 'psi': 0.8293731442580444}
[S9] START round=28 head_norm_before_train=1.323507 cos_to_last_merge=0.9504 (last merge round=21)
[S9] round=28 local utility u=0.002292 metrics={'f1_val': 0.99518968612894, 'auprc': 0.9985787901563399, 'loss_val': 0.055571743110939036, 'psi': 0.9965453277398999}-{'f1_val': 0.9968525854255906, 'auprc': 0.9952012666374339, 'loss_val': 0.06000111901827561, 'psi': 0.9961920579103278}
[S10] START round=28 head_norm_before_train=1.587802 cos_to_last_merge=0.9962 (last merge round=22)
[S10] round=28 local utility u=0.000000 metrics={'f1_val': 0.9940903254969471, 'auprc': 0.9940523312446787, 'loss_val': 0.0460808875301614, 'psi': 0.9940751277960398}-{'f1_val': 0.9936518403636662, 'auprc': 0.996456325834991, 'loss_val': 0.04571881684093272, 'psi': 0.994773634552196}
[S11] START round=28 head_norm_before_train=1.294365 cos_to_last_merge=1.0000 (last merge round=27)
[S11] round=28 local utility u=0.003316 metrics={'f1_val': 0.9967189926998994, 'auprc': 0.9981212733972359, 'loss_val': 0.10857796072797908, 'psi': 0.9972799049788339}-{'f1_val': 0.9967189926998994, 'auprc': 0.9966036754338675, 'loss_val': 0.11065792789016393, 'psi': 0.9966728657934866}
[S13] START round=28 head_norm_before_train=1.733745 (no previous merge yet)
[S13] round=28 local utility u=0.000000 metrics={'f1_val': 0.6255772810043767, 'auprc': 0.6940017685829708, 'loss_val': 0.627803332705705, 'psi': 0.6529470760358143}-{'f1_val': 0.6267479071430041, 'auprc': 0.6897069505396359, 'loss_val': 0.5986389441376693, 'psi': 0.6519315245016568}
[S14] START round=28 head_norm_before_train=1.243334 cos_to_last_merge=1.0000 (last merge round=27)
[S14] round=28 local utility u=0.000000 metrics={'f1_val': 0.9970336855150863, 'auprc': 0.9969176608753101, 'loss_val': 0.1314183079615481, 'psi': 0.9969872756591758}-{'f1_val': 0.9969056262802267, 'auprc': 0.9985631189867132, 'loss_val': 0.13181182693678092, 'psi': 0.9975686233628214}
[S15] START round=28 head_norm_before_train=1.160284 cos_to_last_merge=1.0000 (last merge round=27)
[S15] round=28 local utility u=1.000000 metrics={'f1_val': 0.9963755136436562, 'auprc': 0.9973791996308807, 'loss_val': 0.19244636551617553, 'psi': 0.996776988038546}-{'f1_val': 0.7195150380724201, 'auprc': 0.9160834079977057, 'loss_val': 0.4117647261286777, 'psi': 0.7981423860425344}
[S16] START round=28 head_norm_before_train=1.893358 (no previous merge yet)
[S16] round=28 local utility u=0.000000 metrics={'f1_val': 0.8307970269673035, 'auprc': 0.8531979814212486, 'loss_val': 1.079502202970719, 'psi': 0.8397574087488815}-{'f1_val': 0.9736636490919673, 'auprc': 0.9858652870502318, 'loss_val': 0.11342814179476397, 'psi': 0.9785443042752732}
[S17] START round=28 head_norm_before_train=1.426039 cos_to_last_merge=0.7364 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.736
[S17] round=28 local utility u=0.018677 metrics={'f1_val': 0.7451731187956325, 'auprc': 0.9558550222390465, 'loss_val': 0.4306233990141962, 'psi': 0.8294458801729981}-{'f1_val': 0.7565047648970091, 'auprc': 0.9301977808630617, 'loss_val': 0.45899627080526517, 'psi': 0.8259819712834302}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:62407
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:62414
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:62412
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S6@127.0.0.1:62407
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1793 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1793) from S8
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.414533)
[S6] loaded HEAD from S8 (vec_in norm=1.414533)
[S6] cosine check vs S8: cos=0.9612
[S6] BUFFERED delta from S8 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1799) from S9
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.354964)
[S11] loaded HEAD from S9 (vec_in norm=1.354964)
[S11] cosine check vs S9: cos=0.9945
[S11] BUFFERED delta from S9 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1803) from S15
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.198974)
[S6] loaded HEAD from S15 (vec_in norm=1.198974)
[S6] cosine check vs S15: cos=0.8241
[S6] BUFFERED delta from S15 (total buffered=2)
[S14] RECEIVED delta(kind=head bytes=1797) from S11
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.324568)
[S14] loaded HEAD from S11 (vec_in norm=1.324568)
[S14] cosine check vs S11: cos=0.9806
[S14] BUFFERED delta from S11 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=28 metric=0.9970 head_norm=1.285651
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.301276e-01
[S14] stored merged vector for next round verification (round=28)
[S14] DEBUG after merge:  round=28 metric=0.9970 head_norm=1.298752 delta_norm=0.130128
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=28 metric=0.7241 head_norm=1.261926
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.336362e-01
[S6] stored merged vector for next round verification (round=28)
[S6] DEBUG after merge:  round=28 metric=0.7299 head_norm=1.224434 delta_norm=0.133636
[S6] aggregate: ACCEPT kept=['S8', 'S15'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=28 metric=0.9967 head_norm=1.324568
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.205141e-02
[S11] stored merged vector for next round verification (round=28)
[S11] DEBUG after merge:  round=28 metric=0.9967 head_norm=1.337914 delta_norm=0.072051
[S11] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=29 head_norm_before_train=1.792127 (no previous merge yet)
[S2] round=29 local utility u=0.071841 metrics={'f1_val': 0.7005127895862524, 'auprc': 0.7525641854995524, 'loss_val': 0.28325926802904433, 'psi': 0.7213333479515724}-{'f1_val': 0.7045210233104157, 'auprc': 0.7010955770972234, 'loss_val': 0.2965854852310594, 'psi': 0.7031508448251387}
[S3] START round=29 head_norm_before_train=2.160044 (no previous merge yet)
[S3] round=29 local utility u=0.000000 metrics={'f1_val': 0.9611152572344858, 'auprc': 0.9999766960874624, 'loss_val': 0.09717778675318704, 'psi': 0.9766598327756764}-{'f1_val': 0.9613297054499484, 'auprc': 0.9999760509023101, 'loss_val': 0.0978727993810934, 'psi': 0.9767882436308932}
[S4] START round=29 head_norm_before_train=1.244315 cos_to_last_merge=0.9997 (last merge round=27)
[S4] round=29 local utility u=0.127765 metrics={'f1_val': 0.9541341389693101, 'auprc': 0.9748241900184603, 'loss_val': 0.3227976427873623, 'psi': 0.9624101593889702}-{'f1_val': 0.9391784819795275, 'auprc': 0.9529054160751423, 'loss_val': 0.422838068738721, 'psi': 0.9446692556177734}
[S5] START round=29 head_norm_before_train=1.171554 cos_to_last_merge=0.9998 (last merge round=27)
[S5] round=29 local utility u=0.174187 metrics={'f1_val': 0.9795466265736614, 'auprc': 0.9959995023352495, 'loss_val': 0.2096460267725632, 'psi': 0.9861277768782966}-{'f1_val': 0.9335372718474043, 'auprc': 0.9902637463734496, 'loss_val': 0.2647559642331352, 'psi': 0.9562278616578224}
[S6] START round=29 head_norm_before_train=1.224434 cos_to_last_merge=1.0000 (last merge round=28)
[S6] round=29 local utility u=0.000000 metrics={'f1_val': 0.45385409414435235, 'auprc': 0.7918378161111943, 'loss_val': 0.84586277050885, 'psi': 0.5890475829310892}-{'f1_val': 0.7240823205845939, 'auprc': 0.8267631920607517, 'loss_val': 0.5531104288695796, 'psi': 0.765154669175057}
[S7] START round=29 head_norm_before_train=1.794537 (no previous merge yet)
[S7] round=29 local utility u=1.000000 metrics={'f1_val': 0.7719426891164018, 'auprc': 0.9886438157637177, 'loss_val': 0.16920977773532803, 'psi': 0.8586231397753282}-{'f1_val': 0.6045635413006143, 'auprc': 0.7877505414288082, 'loss_val': 0.7182406524457122, 'psi': 0.6778383413518918}
[S8] START round=29 head_norm_before_train=1.414533 cos_to_last_merge=0.9835 (last merge round=24)
[S8] round=29 local utility u=0.040883 metrics={'f1_val': 0.9951312942941762, 'auprc': 0.9990374628562129, 'loss_val': 0.11815793738850354, 'psi': 0.9966937617189909}-{'f1_val': 0.9880714959555419, 'auprc': 0.9971432076618404, 'loss_val': 0.15188209977904626, 'psi': 0.9917001806380612}
[S9] START round=29 head_norm_before_train=1.354964 cos_to_last_merge=0.9464 (last merge round=21)
[S9] ⚠️ Model drifted since last merge! cos=0.946
[S9] round=29 local utility u=0.009371 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9982745510445741, 'loss_val': 0.047396561752081914, 'psi': 0.9975715679251154}-{'f1_val': 0.99518968612894, 'auprc': 0.9985787901563399, 'loss_val': 0.055571743110939036, 'psi': 0.9965453277398999}
[S10] START round=29 head_norm_before_train=1.608489 cos_to_last_merge=0.9952 (last merge round=22)
[S10] round=29 local utility u=0.001036 metrics={'f1_val': 0.9931720938432163, 'auprc': 0.9960198630762733, 'loss_val': 0.04440306422649206, 'psi': 0.9943112015364391}-{'f1_val': 0.9940903254969471, 'auprc': 0.9940523312446787, 'loss_val': 0.0460808875301614, 'psi': 0.9940751277960398}
[S11] START round=29 head_norm_before_train=1.337914 cos_to_last_merge=1.0000 (last merge round=28)
[S11] round=29 local utility u=0.005888 metrics={'f1_val': 0.996960829744628, 'auprc': 0.9987486038673373, 'loss_val': 0.10013588422001829, 'psi': 0.9976759393937117}-{'f1_val': 0.9967189926998994, 'auprc': 0.9981212733972359, 'loss_val': 0.10857796072797908, 'psi': 0.9972799049788339}
[S13] START round=29 head_norm_before_train=1.744546 (no previous merge yet)
[S13] round=29 local utility u=0.000000 metrics={'f1_val': 0.5811008720760321, 'auprc': 0.698109970450999, 'loss_val': 0.9141302626549401, 'psi': 0.6279045114260189}-{'f1_val': 0.6255772810043767, 'auprc': 0.6940017685829708, 'loss_val': 0.627803332705705, 'psi': 0.6529470760358143}
[S14] START round=29 head_norm_before_train=1.298752 cos_to_last_merge=1.0000 (last merge round=28)
[S14] round=29 local utility u=0.000000 metrics={'f1_val': 0.9964030091660864, 'auprc': 0.9953200567335968, 'loss_val': 0.12650862832129817, 'psi': 0.9959698281930905}-{'f1_val': 0.9970336855150863, 'auprc': 0.9969176608753101, 'loss_val': 0.1314183079615481, 'psi': 0.9969872756591758}
[S15] START round=29 head_norm_before_train=1.198974 cos_to_last_merge=0.9986 (last merge round=27)
[S15] round=29 local utility u=0.000000 metrics={'f1_val': 0.7008305005721126, 'auprc': 0.7996037721176911, 'loss_val': 0.5075995465557829, 'psi': 0.740339809190344}-{'f1_val': 0.9963755136436562, 'auprc': 0.9973791996308807, 'loss_val': 0.19244636551617553, 'psi': 0.996776988038546}
[S16] START round=29 head_norm_before_train=1.902748 (no previous merge yet)
[S16] round=29 local utility u=0.870781 metrics={'f1_val': 0.9338408880748129, 'auprc': 0.9873212739512904, 'loss_val': 0.35857256625777006, 'psi': 0.9552330424254039}-{'f1_val': 0.8307970269673035, 'auprc': 0.8531979814212486, 'loss_val': 1.079502202970719, 'psi': 0.8397574087488815}
[S17] START round=29 head_norm_before_train=1.463242 cos_to_last_merge=0.7347 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.735
[S17] round=29 local utility u=0.000000 metrics={'f1_val': 0.6951353533438307, 'auprc': 0.9603725142390587, 'loss_val': 0.4445110539536332, 'psi': 0.8012302177019219}-{'f1_val': 0.7451731187956325, 'auprc': 0.9558550222390465, 'loss_val': 0.4306233990141962, 'psi': 0.8294458801729981}
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S10
[S14]  timeout peer S13
[S14]  timeout peer S16
[S14]  timeout peer S17
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S16
[S15]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S16
[S6]  timeout peer S17
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S16
[S8]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:62404
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:62412
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:62404
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:62405
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:62407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:62403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:62414
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1799) from S10
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.629041)
[S4] loaded HEAD from S10 (vec_in norm=1.629041)
[S4] cosine check vs S10: cos=0.9066
[S4] BUFFERED delta from S10 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1796) from S4
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.264712)
[S5] loaded HEAD from S4 (vec_in norm=1.264712)
[S5] cosine check vs S4: cos=0.9474
[S5] BUFFERED delta from S4 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1800) from S11
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.370337)
[S14] loaded HEAD from S11 (vec_in norm=1.370337)
[S14] cosine check vs S11: cos=0.9885
[S14] BUFFERED delta from S11 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1798) from S2
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.802327)
[S3] loaded HEAD from S2 (vec_in norm=1.802327)
[S3] cosine check vs S2: cos=-0.0497
[S3] DROPPED delta from S2 (cos=-0.0497 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1802) from S9
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.383223)
[S11] loaded HEAD from S9 (vec_in norm=1.383223)
[S11] cosine check vs S9: cos=0.9966
[S11] BUFFERED delta from S9 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1796) from S5
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.196338)
[S4] loaded HEAD from S5 (vec_in norm=1.196338)
[S4] cosine check vs S5: cos=0.9474
[S4] BUFFERED delta from S5 (total buffered=2)
[S6] RECEIVED delta(kind=head bytes=1801) from S8
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.446219)
[S6] loaded HEAD from S8 (vec_in norm=1.446219)
[S6] cosine check vs S8: cos=0.9486
[S6] BUFFERED delta from S8 (total buffered=1)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=29 metric=0.9970 head_norm=1.370337
[S11] _apply_head_vector_avg (torch): Δ‖w‖=5.735707e-02
[S11] stored merged vector for next round verification (round=29)
[S11] DEBUG after merge:  round=29 metric=0.9970 head_norm=1.375600 delta_norm=0.057357
[S11] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=29 metric=0.9795 head_norm=1.196338
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.024598e-01
[S5] stored merged vector for next round verification (round=29)
[S5] DEBUG after merge:  round=29 metric=0.9890 head_norm=1.214237 delta_norm=0.202460
[S5] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=29 metric=0.9541 head_norm=1.264712
[S4] _apply_head_vector_avg (torch): Δ‖w‖=8.958381e-02
[S4] stored merged vector for next round verification (round=29)
[S4] DEBUG after merge:  round=29 metric=0.9541 head_norm=1.287860 delta_norm=0.089584
[S4] aggregate: ACCEPT kept=['S10', 'S5'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=29 metric=0.9964 head_norm=1.336572
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.040799e-01
[S14] stored merged vector for next round verification (round=29)
[S14] DEBUG after merge:  round=29 metric=0.9964 head_norm=1.349553 delta_norm=0.104080
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S6] CommDone barrier timeout: have=2 need=3 — continuing
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=29 metric=0.4539 head_norm=1.255503
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.360780e-01
[S6] stored merged vector for next round verification (round=29)
[S6] DEBUG after merge:  round=29 metric=0.4562 head_norm=1.333486 delta_norm=0.236078
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=30 head_norm_before_train=1.802327 (no previous merge yet)
[S2] round=30 local utility u=0.118139 metrics={'f1_val': 0.7056838017685825, 'auprc': 0.8164754453267459, 'loss_val': 0.26974120892203496, 'psi': 0.7500004591918479}-{'f1_val': 0.7005127895862524, 'auprc': 0.7525641854995524, 'loss_val': 0.28325926802904433, 'psi': 0.7213333479515724}
[S3] START round=30 head_norm_before_train=2.171344 (no previous merge yet)
[S3] round=30 local utility u=0.096274 metrics={'f1_val': 0.9841775166372686, 'auprc': 0.9999507477009957, 'loss_val': 0.04292475408982508, 'psi': 0.9904868090627594}-{'f1_val': 0.9611152572344858, 'auprc': 0.9999766960874624, 'loss_val': 0.09717778675318704, 'psi': 0.9766598327756764}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=30 head_norm_before_train=1.287860 cos_to_last_merge=1.0000 (last merge round=29)
[S4] round=30 local utility u=0.000000 metrics={'f1_val': 0.9384342148203133, 'auprc': 0.9562774614600882, 'loss_val': 0.41044522442809966, 'psi': 0.9455715134762233}-{'f1_val': 0.9541341389693101, 'auprc': 0.9748241900184603, 'loss_val': 0.3227976427873623, 'psi': 0.9624101593889702}
[S5] START round=30 head_norm_before_train=1.214237 cos_to_last_merge=1.0000 (last merge round=29)
[S5] round=30 local utility u=0.049001 metrics={'f1_val': 0.9957987212170865, 'auprc': 0.9961997169144053, 'loss_val': 0.20975727558882368, 'psi': 0.995959119496014}-{'f1_val': 0.9795466265736614, 'auprc': 0.9959995023352495, 'loss_val': 0.2096460267725632, 'psi': 0.9861277768782966}
[S6] START round=30 head_norm_before_train=1.333486 cos_to_last_merge=1.0000 (last merge round=29)
[S6] round=30 local utility u=1.000000 metrics={'f1_val': 0.9296305769375335, 'auprc': 0.9606859875838897, 'loss_val': 0.21524160665266492, 'psi': 0.942052741196076}-{'f1_val': 0.45385409414435235, 'auprc': 0.7918378161111943, 'loss_val': 0.84586277050885, 'psi': 0.5890475829310892}
[S7] START round=30 head_norm_before_train=1.801066 (no previous merge yet)
[S7] round=30 local utility u=0.000000 metrics={'f1_val': 0.5925037502606785, 'auprc': 0.7845225897032084, 'loss_val': 0.6947195854046682, 'psi': 0.6693112860376904}-{'f1_val': 0.7719426891164018, 'auprc': 0.9886438157637177, 'loss_val': 0.16920977773532803, 'psi': 0.8586231397753282}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=30 head_norm_before_train=1.446219 cos_to_last_merge=0.9801 (last merge round=24)
[S8] round=30 local utility u=0.000000 metrics={'f1_val': 0.9892968853633592, 'auprc': 0.9972118415742294, 'loss_val': 0.13403865169705984, 'psi': 0.9924628678477072}-{'f1_val': 0.9951312942941762, 'auprc': 0.9990374628562129, 'loss_val': 0.11815793738850354, 'psi': 0.9966937617189909}
[S9] START round=30 head_norm_before_train=1.383223 cos_to_last_merge=0.9430 (last merge round=21)
[S9] ⚠️ Model drifted since last merge! cos=0.943
[S9] round=30 local utility u=0.000000 metrics={'f1_val': 0.9958601375429889, 'auprc': 0.9979349840417889, 'loss_val': 0.04487973948161908, 'psi': 0.9966900761425088}-{'f1_val': 0.9971029125121428, 'auprc': 0.9982745510445741, 'loss_val': 0.047396561752081914, 'psi': 0.9975715679251154}
[S10] START round=30 head_norm_before_train=1.629041 cos_to_last_merge=0.9942 (last merge round=22)
[S10] round=30 local utility u=0.000004 metrics={'f1_val': 0.9943096789853013, 'auprc': 0.9943317425539198, 'loss_val': 0.04615610115675942, 'psi': 0.9943185044127487}-{'f1_val': 0.9931720938432163, 'auprc': 0.9960198630762733, 'loss_val': 0.04440306422649206, 'psi': 0.9943112015364391}
[S11] START round=30 head_norm_before_train=1.375600 cos_to_last_merge=1.0000 (last merge round=29)
[S11] round=30 local utility u=0.006112 metrics={'f1_val': 0.9967189926998994, 'auprc': 0.9982994629314446, 'loss_val': 0.08511250674293659, 'psi': 0.9973511807925174}-{'f1_val': 0.996960829744628, 'auprc': 0.9987486038673373, 'loss_val': 0.10013588422001829, 'psi': 0.9976759393937117}
[S13] START round=30 head_norm_before_train=1.752940 (no previous merge yet)
[S13] round=30 local utility u=0.363769 metrics={'f1_val': 0.6279469562702606, 'auprc': 0.7463466495476395, 'loss_val': 0.6123787123508013, 'psi': 0.6753068335812122}-{'f1_val': 0.5811008720760321, 'auprc': 0.698109970450999, 'loss_val': 0.9141302626549401, 'psi': 0.6279045114260189}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] sending update (kind=head size=1796 to 1 peers)
[S14] START round=30 head_norm_before_train=1.349553 cos_to_last_merge=1.0000 (last merge round=29)
[S14] round=30 local utility u=0.007673 metrics={'f1_val': 0.9974966549531046, 'auprc': 0.9984979609880771, 'loss_val': 0.1272581798467864, 'psi': 0.9978971773670935}-{'f1_val': 0.9964030091660864, 'auprc': 0.9953200567335968, 'loss_val': 0.12650862832129817, 'psi': 0.9959698281930905}
[S15] START round=30 head_norm_before_train=1.237764 cos_to_last_merge=0.9955 (last merge round=27)
[S15] round=30 local utility u=1.000000 metrics={'f1_val': 0.9961900430063055, 'auprc': 0.9925743374231283, 'loss_val': 0.12752592270030155, 'psi': 0.9947437607730346}-{'f1_val': 0.7008305005721126, 'auprc': 0.7996037721176911, 'loss_val': 0.5075995465557829, 'psi': 0.740339809190344}
[S16] START round=30 head_norm_before_train=1.913450 (no previous merge yet)
[S16] round=30 local utility u=0.283157 metrics={'f1_val': 0.9819570932504088, 'auprc': 0.9889877649172732, 'loss_val': 0.08595502616431001, 'psi': 0.9847693619171547}-{'f1_val': 0.9338408880748129, 'auprc': 0.9873212739512904, 'loss_val': 0.35857256625777006, 'psi': 0.9552330424254039}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] sending update (kind=head size=1795 to 1 peers)
[S17] START round=30 head_norm_before_train=1.503132 cos_to_last_merge=0.7339 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.734
[S17] round=30 local utility u=0.000000 metrics={'f1_val': 0.6166471262403725, 'auprc': 0.9246819816717236, 'loss_val': 0.577240987769056, 'psi': 0.739861068412913}-{'f1_val': 0.6951353533438307, 'auprc': 0.9603725142390587, 'loss_val': 0.4445110539536332, 'psi': 0.8012302177019219}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:62404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:62403
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] ⇄ pheromone p=0.153 → S6@127.0.0.1:62407
[S10] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:62404
[S3] RECEIVED delta(kind=head bytes=1800) from S2
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.812803)
[S3] loaded HEAD from S2 (vec_in norm=1.812803)
[S3] cosine check vs S2: cos=-0.0500
[S3] DROPPED delta from S2 (cos=-0.0500 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1802) from S10
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.646850)
[S4] loaded HEAD from S10 (vec_in norm=1.646850)
[S4] cosine check vs S10: cos=0.9305
[S4] BUFFERED delta from S10 (total buffered=1)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1798 to 1 peers)
[S10] ⇄ pheromone p=0.025 → S4@127.0.0.1:62404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:62415
[S2] ⇄ pheromone p=0.059 → S3@127.0.0.1:62403
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] RECEIVED delta(kind=head bytes=1798) from S5
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.231738)
[S4] loaded HEAD from S5 (vec_in norm=1.231738)
[S4] cosine check vs S5: cos=0.9744
[S4] BUFFERED delta from S5 (total buffered=2)
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1799) from S14
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.377173)
[S15] loaded HEAD from S14 (vec_in norm=1.377173)
[S15] cosine check vs S14: cos=0.8611
[S15] BUFFERED delta from S14 (total buffered=1)
[S5] ⇄ pheromone p=0.217 → S4@127.0.0.1:62404
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=30 metric=0.9384 head_norm=1.303099
[S4] _apply_head_vector_avg (torch): Δ‖w‖=9.047587e-02
[S4] stored merged vector for next round verification (round=30)
[S4] DEBUG after merge:  round=30 metric=0.9384 head_norm=1.337386 delta_norm=0.090476
[S4] aggregate: ACCEPT kept=['S10', 'S5'] (k=2/2) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.142 → S5@127.0.0.1:62405
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:62407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:62414
[S15] sending update (kind=head size=1804 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1804) from S15
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.269688)
[S6] loaded HEAD from S15 (vec_in norm=1.269688)
[S6] cosine check vs S15: cos=0.7885
[S6] BUFFERED delta from S15 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1797) from S11
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.405027)
[S14] loaded HEAD from S11 (vec_in norm=1.405027)
[S14] cosine check vs S11: cos=0.9934
[S14] BUFFERED delta from S11 (total buffered=1)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=30 metric=0.9962 head_norm=1.269688
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.526425e-01
[S15] stored merged vector for next round verification (round=30)
[S15] DEBUG after merge:  round=30 metric=0.9967 head_norm=1.276714 delta_norm=0.352643
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.477 → S6@127.0.0.1:62407
[S11] ⇄ pheromone p=0.033 → S14@127.0.0.1:62414
[S9] ⇄ pheromone p=0.021 → S11@127.0.0.1:62412
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=30 metric=0.9975 head_norm=1.377173
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.091141e-02
[S14] stored merged vector for next round verification (round=30)
[S14] DEBUG after merge:  round=30 metric=0.9975 head_norm=1.388815 delta_norm=0.080911
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.029 → S15@127.0.0.1:62415
[S2]  timeout peer S3
[S9]  timeout peer S5
[S9]  timeout peer S11
[S9]  timeout peer S13
[S11]  timeout peer S14
[S4]  timeout peer S16
[S5]  timeout peer S17
[S15]  timeout peer S6
[S6]  timeout peer S2
[S6]  timeout peer S7
[S14]  timeout peer S9
[S14]  timeout peer S15
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:62415
[S6] sending update (kind=head size=1796 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1796) from S6
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.354763)
[S15] loaded HEAD from S6 (vec_in norm=1.354763)
[S15] cosine check vs S6: cos=0.6458
[S15] BUFFERED delta from S6 (total buffered=1)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=30 metric=0.9296 head_norm=1.354763
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.286006e-01
[S6] stored merged vector for next round verification (round=30)
[S6] DEBUG after merge:  round=30 metric=0.9458 head_norm=1.240986 delta_norm=0.428601
[S6] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.340 → S15@127.0.0.1:62415
[S2] START round=31 head_norm_before_train=1.812803 (no previous merge yet)
[S2] round=31 local utility u=0.000000 metrics={'f1_val': 0.7085742138177114, 'auprc': 0.7733010475983262, 'loss_val': 0.2671089534991518, 'psi': 0.7344649473299574}-{'f1_val': 0.7056838017685825, 'auprc': 0.8164754453267459, 'loss_val': 0.26974120892203496, 'psi': 0.7500004591918479}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=31 head_norm_before_train=2.181371 (no previous merge yet)
[S3] round=31 local utility u=0.000000 metrics={'f1_val': 0.9522165639571257, 'auprc': 0.9999134929364473, 'loss_val': 0.12788609102745396, 'psi': 0.9712953355488543}-{'f1_val': 0.9841775166372686, 'auprc': 0.9999507477009957, 'loss_val': 0.04292475408982508, 'psi': 0.9904868090627594}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=31 head_norm_before_train=1.337386 cos_to_last_merge=1.0000 (last merge round=30)
[S4] round=31 local utility u=0.129535 metrics={'f1_val': 0.9589972201195975, 'auprc': 0.9616839600002585, 'loss_val': 0.2909735187154511, 'psi': 0.9600719160718619}-{'f1_val': 0.9384342148203133, 'auprc': 0.9562774614600882, 'loss_val': 0.41044522442809966, 'psi': 0.9455715134762233}
[S5] START round=31 head_norm_before_train=1.231738 cos_to_last_merge=0.9998 (last merge round=29)
[S5] round=31 local utility u=0.012003 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9960786528273954, 'loss_val': 0.1877111798928192, 'psi': 0.9961430751165448}-{'f1_val': 0.9957987212170865, 'auprc': 0.9961997169144053, 'loss_val': 0.20975727558882368, 'psi': 0.995959119496014}
[S6] START round=31 head_norm_before_train=1.240986 cos_to_last_merge=1.0000 (last merge round=30)
[S6] round=31 local utility u=0.000000 metrics={'f1_val': 0.6195592426476094, 'auprc': 0.9443603564612865, 'loss_val': 0.6612150980612912, 'psi': 0.7494796881730803}-{'f1_val': 0.9296305769375335, 'auprc': 0.9606859875838897, 'loss_val': 0.21524160665266492, 'psi': 0.942052741196076}
[S7] START round=31 head_norm_before_train=1.803605 (no previous merge yet)
[S7] round=31 local utility u=0.114499 metrics={'f1_val': 0.6108877484475476, 'auprc': 0.79568764818333, 'loss_val': 0.6095212303529342, 'psi': 0.6848077083418606}-{'f1_val': 0.5925037502606785, 'auprc': 0.7845225897032084, 'loss_val': 0.6947195854046682, 'psi': 0.6693112860376904}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] sending update (kind=head size=1797 to 1 peers)
[S8] START round=31 head_norm_before_train=1.473208 cos_to_last_merge=0.9773 (last merge round=24)
[S8] round=31 local utility u=0.037745 metrics={'f1_val': 0.9941443971419754, 'auprc': 0.9971464586465758, 'loss_val': 0.08743844858267479, 'psi': 0.9953452217438156}-{'f1_val': 0.9892968853633592, 'auprc': 0.9972118415742294, 'loss_val': 0.13403865169705984, 'psi': 0.9924628678477072}
[S9] START round=31 head_norm_before_train=1.408932 cos_to_last_merge=0.9397 (last merge round=21)
[S9] ⚠️ Model drifted since last merge! cos=0.940
[S9] round=31 local utility u=0.000000 metrics={'f1_val': 0.9904109382186765, 'auprc': 0.9983422184908433, 'loss_val': 0.05207038519614307, 'psi': 0.9935834503275432}-{'f1_val': 0.9958601375429889, 'auprc': 0.9979349840417889, 'loss_val': 0.04487973948161908, 'psi': 0.9966900761425088}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=31 head_norm_before_train=1.646850 cos_to_last_merge=0.9933 (last merge round=22)
[S10] round=31 local utility u=0.003688 metrics={'f1_val': 0.9936518403636662, 'auprc': 0.9964129684447098, 'loss_val': 0.04107754495334932, 'psi': 0.9947562915960836}-{'f1_val': 0.9943096789853013, 'auprc': 0.9943317425539198, 'loss_val': 0.04615610115675942, 'psi': 0.9943185044127487}
[S11] START round=31 head_norm_before_train=1.405027 cos_to_last_merge=0.9997 (last merge round=29)
[S11] round=31 local utility u=0.001457 metrics={'f1_val': 0.996960829744628, 'auprc': 0.998805925464295, 'loss_val': 0.08516869172929102, 'psi': 0.9976988680324947}-{'f1_val': 0.9967189926998994, 'auprc': 0.9982994629314446, 'loss_val': 0.08511250674293659, 'psi': 0.9973511807925174}
[S13] START round=31 head_norm_before_train=1.762071 (no previous merge yet)
[S13] round=31 local utility u=0.000000 metrics={'f1_val': 0.5786034107214048, 'auprc': 0.7104636086077518, 'loss_val': 0.9782324640770392, 'psi': 0.6313474898759436}-{'f1_val': 0.6279469562702606, 'auprc': 0.7463466495476395, 'loss_val': 0.6123787123508013, 'psi': 0.6753068335812122}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=31 head_norm_before_train=1.388815 cos_to_last_merge=1.0000 (last merge round=30)
[S14] round=31 local utility u=0.000000 metrics={'f1_val': 0.9969911424264181, 'auprc': 0.9958773584558466, 'loss_val': 0.11642122884464075, 'psi': 0.9965456288381895}-{'f1_val': 0.9974966549531046, 'auprc': 0.9984979609880771, 'loss_val': 0.1272581798467864, 'psi': 0.9978971773670935}
[S15] START round=31 head_norm_before_train=1.276714 cos_to_last_merge=1.0000 (last merge round=30)
[S15] round=31 local utility u=0.000000 metrics={'f1_val': 0.8905805819429318, 'auprc': 0.9944867577009814, 'loss_val': 0.31012853642925886, 'psi': 0.9321430522461516}-{'f1_val': 0.9961900430063055, 'auprc': 0.9925743374231283, 'loss_val': 0.12752592270030155, 'psi': 0.9947437607730346}
[S16] START round=31 head_norm_before_train=1.925317 (no previous merge yet)
[S16] round=31 local utility u=0.000000 metrics={'f1_val': 0.9321808327586742, 'auprc': 0.9867148086917868, 'loss_val': 0.37435532528144017, 'psi': 0.9539944231319193}-{'f1_val': 0.9819570932504088, 'auprc': 0.9889877649172732, 'loss_val': 0.08595502616431001, 'psi': 0.9847693619171547}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=31 head_norm_before_train=1.535985 cos_to_last_merge=0.7330 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.733
[S17] round=31 local utility u=0.000000 metrics={'f1_val': 0.6036979341148263, 'auprc': 0.9071260064650813, 'loss_val': 0.7278647640802776, 'psi': 0.7250691630549284}-{'f1_val': 0.6166471262403725, 'auprc': 0.9246819816717236, 'loss_val': 0.577240987769056, 'psi': 0.739861068412913}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:62410
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:62404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:62405
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=31 metric=0.8906 head_norm=1.296280
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.509859e-01
[S15] stored merged vector for next round verification (round=31)
[S15] DEBUG after merge:  round=31 metric=0.8980 head_norm=1.205934 delta_norm=0.550986
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S4] RECEIVED delta(kind=head bytes=1798) from S5
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.248940)
[S4] loaded HEAD from S5 (vec_in norm=1.248940)
[S4] cosine check vs S5: cos=0.9563
[S4] BUFFERED delta from S5 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1801) from S11
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.430182)
[S9] loaded HEAD from S11 (vec_in norm=1.430182)
[S9] cosine check vs S11: cos=0.9958
[S9] BUFFERED delta from S11 (total buffered=1)
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1798) from S4
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.353220)
[S5] loaded HEAD from S4 (vec_in norm=1.353220)
[S5] cosine check vs S4: cos=0.9563
[S5] BUFFERED delta from S4 (total buffered=1)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=31 metric=0.9590 head_norm=1.353220
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.992160e-01
[S4] stored merged vector for next round verification (round=31)
[S4] DEBUG after merge:  round=31 metric=0.9592 head_norm=1.286795 delta_norm=0.199216
[S4] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=32 head_norm_before_train=1.822488 (no previous merge yet)
[S2] round=32 local utility u=0.058274 metrics={'f1_val': 0.7215682025325887, 'auprc': 0.7869701834049693, 'loss_val': 0.26953222752007233, 'psi': 0.7477289948815409}-{'f1_val': 0.7085742138177114, 'auprc': 0.7733010475983262, 'loss_val': 0.2671089534991518, 'psi': 0.7344649473299574}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] START round=32 head_norm_before_train=2.192503 (no previous merge yet)
[S3] round=32 local utility u=0.041878 metrics={'f1_val': 0.9605133082589568, 'auprc': 0.9999550953053571, 'loss_val': 0.0940345373753357, 'psi': 0.9762900230775169}-{'f1_val': 0.9522165639571257, 'auprc': 0.9999134929364473, 'loss_val': 0.12788609102745396, 'psi': 0.9712953355488543}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=32 head_norm_before_train=1.286795 cos_to_last_merge=1.0000 (last merge round=31)
[S4] round=32 local utility u=0.000000 metrics={'f1_val': 0.9409440670811723, 'auprc': 0.9612929227490696, 'loss_val': 0.3321726778146299, 'psi': 0.9490836093483312}-{'f1_val': 0.9589972201195975, 'auprc': 0.9616839600002585, 'loss_val': 0.2909735187154511, 'psi': 0.9600719160718619}
[S5] START round=32 head_norm_before_train=1.248940 cos_to_last_merge=0.9990 (last merge round=29)
[S5] round=32 local utility u=0.000000 metrics={'f1_val': 0.7215245781973809, 'auprc': 0.90828229828431, 'loss_val': 0.35509366374662127, 'psi': 0.7962276662321526}-{'f1_val': 0.996186023309311, 'auprc': 0.9960786528273954, 'loss_val': 0.1877111798928192, 'psi': 0.9961430751165448}
[S6] START round=32 head_norm_before_train=1.256559 cos_to_last_merge=0.9996 (last merge round=30)
[S6] round=32 local utility u=1.000000 metrics={'f1_val': 0.9875108208872226, 'auprc': 0.9608821724233524, 'loss_val': 0.16874337985579457, 'psi': 0.9768593615016745}-{'f1_val': 0.6195592426476094, 'auprc': 0.9443603564612865, 'loss_val': 0.6612150980612912, 'psi': 0.7494796881730803}
[S7] START round=32 head_norm_before_train=1.817822 (no previous merge yet)
[S7] round=32 local utility u=0.000000 metrics={'f1_val': 0.5350716223260387, 'auprc': 0.7826982279111383, 'loss_val': 0.991615343455045, 'psi': 0.6341222645600786}-{'f1_val': 0.6108877484475476, 'auprc': 0.79568764818333, 'loss_val': 0.6095212303529342, 'psi': 0.6848077083418606}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=32 head_norm_before_train=1.497702 cos_to_last_merge=0.9747 (last merge round=24)
[S8] round=32 local utility u=0.007922 metrics={'f1_val': 0.9938130760262815, 'auprc': 0.9990953997182934, 'loss_val': 0.07545370221558047, 'psi': 0.9959260055030863}-{'f1_val': 0.9941443971419754, 'auprc': 0.9971464586465758, 'loss_val': 0.08743844858267479, 'psi': 0.9953452217438156}
[S9] START round=32 head_norm_before_train=1.433869 cos_to_last_merge=0.9368 (last merge round=21)
[S9] ⚠️ Model drifted since last merge! cos=0.937
[S9] round=32 local utility u=0.021518 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9946323038248207, 'loss_val': 0.038056570040742754, 'psi': 0.996114669037214}-{'f1_val': 0.9904109382186765, 'auprc': 0.9983422184908433, 'loss_val': 0.05207038519614307, 'psi': 0.9935834503275432}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] sending update (kind=head size=1793 to 1 peers)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=32 metric=0.9971 head_norm=1.455058
[S9] _apply_head_vector_avg (torch): Δ‖w‖=7.005640e-02
[S9] stored merged vector for next round verification (round=32)
[S9] DEBUG after merge:  round=32 metric=0.9971 head_norm=1.440972 delta_norm=0.070056
[S9] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S10] START round=32 head_norm_before_train=1.662114 cos_to_last_merge=0.9924 (last merge round=22)
[S10] round=32 local utility u=0.000000 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9947685833906842, 'loss_val': 0.04141811505489821, 'psi': 0.9946248974353102}-{'f1_val': 0.9936518403636662, 'auprc': 0.9964129684447098, 'loss_val': 0.04107754495334932, 'psi': 0.9947562915960836}
[S11] START round=32 head_norm_before_train=1.430182 cos_to_last_merge=0.9990 (last merge round=29)
[S11] round=32 local utility u=0.010583 metrics={'f1_val': 0.9967189926998994, 'auprc': 0.9988413076206857, 'loss_val': 0.06265684929587861, 'psi': 0.9975679186682138}-{'f1_val': 0.996960829744628, 'auprc': 0.998805925464295, 'loss_val': 0.08516869172929102, 'psi': 0.9976988680324947}
[S13] START round=32 head_norm_before_train=1.769975 (no previous merge yet)
[S13] round=32 local utility u=0.372475 metrics={'f1_val': 0.6271793976812108, 'auprc': 0.747991254832673, 'loss_val': 0.6373204122632199, 'psi': 0.6755041405417956}-{'f1_val': 0.5786034107214048, 'auprc': 0.7104636086077518, 'loss_val': 0.9782324640770392, 'psi': 0.6313474898759436}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=32 head_norm_before_train=1.412569 cos_to_last_merge=0.9995 (last merge round=30)
[S14] round=32 local utility u=0.010074 metrics={'f1_val': 0.9972539966829336, 'auprc': 0.9955210703676101, 'loss_val': 0.09678106292533234, 'psi': 0.9965608261568042}-{'f1_val': 0.9969911424264181, 'auprc': 0.9958773584558466, 'loss_val': 0.11642122884464075, 'psi': 0.9965456288381895}
[S15] START round=32 head_norm_before_train=1.205934 cos_to_last_merge=1.0000 (last merge round=31)
[S15] round=32 local utility u=0.074942 metrics={'f1_val': 0.9020078310137246, 'auprc': 0.9969646708166984, 'loss_val': 0.2362411486795747, 'psi': 0.9399905669349141}-{'f1_val': 0.8905805819429318, 'auprc': 0.9944867577009814, 'loss_val': 0.31012853642925886, 'psi': 0.9321430522461516}
[S16] START round=32 head_norm_before_train=1.934252 (no previous merge yet)
[S16] round=32 local utility u=0.000000 metrics={'f1_val': 0.8539494062933575, 'auprc': 0.8903811222868556, 'loss_val': 0.8815250552392762, 'psi': 0.8685220926907568}-{'f1_val': 0.9321808327586742, 'auprc': 0.9867148086917868, 'loss_val': 0.37435532528144017, 'psi': 0.9539944231319193}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=32 head_norm_before_train=1.564998 cos_to_last_merge=0.7321 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.732
[S17] round=32 local utility u=0.133018 metrics={'f1_val': 0.6287042777056785, 'auprc': 0.9044370529207743, 'loss_val': 0.6037999298632097, 'psi': 0.7389973877917169}-{'f1_val': 0.6036979341148263, 'auprc': 0.9071260064650813, 'loss_val': 0.7278647640802776, 'psi': 0.7250691630549284}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:62414
[S11] not sending this round → trigger blocked (psi=0.998)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:62412
[S8] not sending this round → trigger blocked (psi=0.996)
[S14] sending update (kind=head size=1796 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=32 metric=0.7215 head_norm=1.274986
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.072582e-01
[S5] stored merged vector for next round verification (round=32)
[S5] DEBUG after merge:  round=32 metric=0.7272 head_norm=1.298245 delta_norm=0.207258
[S5] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S15] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:62415
[S14] RECEIVED delta(kind=head bytes=1797) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.234494)
[S14] loaded HEAD from S15 (vec_in norm=1.234494)
[S14] cosine check vs S15: cos=0.7660
[S14] BUFFERED delta from S15 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1796) from S14
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.440964)
[S11] loaded HEAD from S14 (vec_in norm=1.440964)
[S11] cosine check vs S14: cos=0.9943
[S11] BUFFERED delta from S14 (total buffered=1)
[S6] sending update (kind=head size=1798 to 1 peers)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=32 metric=0.9973 head_norm=1.440964
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.677587e-01
[S14] stored merged vector for next round verification (round=32)
[S14] DEBUG after merge:  round=32 metric=0.9973 head_norm=1.257529 delta_norm=0.467759
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S15] RECEIVED delta(kind=head bytes=1798) from S6
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.277115)
[S15] loaded HEAD from S6 (vec_in norm=1.277115)
[S15] cosine check vs S6: cos=0.9901
[S15] BUFFERED delta from S6 (total buffered=1)
[S2] START round=33 head_norm_before_train=1.835257 (no previous merge yet)
[S2] round=33 local utility u=0.336276 metrics={'f1_val': 0.832462452830113, 'auprc': 0.7873952981428396, 'loss_val': 0.26362100968546853, 'psi': 0.8144355909552037}-{'f1_val': 0.7215682025325887, 'auprc': 0.7869701834049693, 'loss_val': 0.26953222752007233, 'psi': 0.7477289948815409}
[S2] not sending this round → trigger blocked (psi=0.814)
[S3] START round=33 head_norm_before_train=2.203674 (no previous merge yet)
[S3] round=33 local utility u=0.000000 metrics={'f1_val': 0.8595539299404882, 'auprc': 0.9992178799014519, 'loss_val': 0.2882462782383539, 'psi': 0.9154195099248736}-{'f1_val': 0.9605133082589568, 'auprc': 0.9999550953053571, 'loss_val': 0.0940345373753357, 'psi': 0.9762900230775169}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=33 head_norm_before_train=1.301924 cos_to_last_merge=0.9999 (last merge round=31)
[S4] round=33 local utility u=0.019480 metrics={'f1_val': 0.9417443360659011, 'auprc': 0.9640449766336785, 'loss_val': 0.30626990060555725, 'psi': 0.9506645922930121}-{'f1_val': 0.9409440670811723, 'auprc': 0.9612929227490696, 'loss_val': 0.3321726778146299, 'psi': 0.9490836093483312}
[S5] START round=33 head_norm_before_train=1.298245 cos_to_last_merge=1.0000 (last merge round=32)
[S5] round=33 local utility u=1.000000 metrics={'f1_val': 0.995817293346464, 'auprc': 0.9919045075706587, 'loss_val': 0.18621589719726467, 'psi': 0.9942521790361418}-{'f1_val': 0.7215245781973809, 'auprc': 0.90828229828431, 'loss_val': 0.35509366374662127, 'psi': 0.7962276662321526}
[S6] START round=33 head_norm_before_train=1.277115 cos_to_last_merge=0.9985 (last merge round=30)
[S6] round=33 local utility u=0.000000 metrics={'f1_val': 0.8636962467728768, 'auprc': 0.9553896791836037, 'loss_val': 0.3242956966478769, 'psi': 0.9003736197371677}-{'f1_val': 0.9875108208872226, 'auprc': 0.9608821724233524, 'loss_val': 0.16874337985579457, 'psi': 0.9768593615016745}
[S7] START round=33 head_norm_before_train=1.827672 (no previous merge yet)
[S7] round=33 local utility u=1.000000 metrics={'f1_val': 0.8809110513408921, 'auprc': 0.9909098385402405, 'loss_val': 0.15016768419050874, 'psi': 0.9249105662206314}-{'f1_val': 0.5350716223260387, 'auprc': 0.7826982279111383, 'loss_val': 0.991615343455045, 'psi': 0.6341222645600786}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=33 head_norm_before_train=1.521827 cos_to_last_merge=0.9722 (last merge round=24)
[S8] round=33 local utility u=0.000000 metrics={'f1_val': 0.992174240363445, 'auprc': 0.9988916018555771, 'loss_val': 0.06870326018876172, 'psi': 0.9948611849602979}-{'f1_val': 0.9938130760262815, 'auprc': 0.9990953997182934, 'loss_val': 0.07545370221558047, 'psi': 0.9959260055030863}
[S9] START round=33 head_norm_before_train=1.440972 cos_to_last_merge=1.0000 (last merge round=32)
[S9] round=33 local utility u=0.000000 metrics={'f1_val': 0.9893026945281196, 'auprc': 0.9979742301232502, 'loss_val': 0.05720819747143426, 'psi': 0.9927713087661718}-{'f1_val': 0.9971029125121428, 'auprc': 0.9946323038248207, 'loss_val': 0.038056570040742754, 'psi': 0.996114669037214}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=33 head_norm_before_train=1.676973 cos_to_last_merge=0.9915 (last merge round=22)
[S10] round=33 local utility u=0.001992 metrics={'f1_val': 0.9936518403636662, 'auprc': 0.9965462073620815, 'loss_val': 0.03750375791653203, 'psi': 0.9948095871630322}-{'f1_val': 0.9945291067983943, 'auprc': 0.9947685833906842, 'loss_val': 0.04141811505489821, 'psi': 0.9946248974353102}
[S11] START round=33 head_norm_before_train=1.454293 cos_to_last_merge=0.9980 (last merge round=29)
[S11] round=33 local utility u=0.003894 metrics={'f1_val': 0.9967189926998994, 'auprc': 0.9988512195955259, 'loss_val': 0.05489887389445455, 'psi': 0.99757188345815}-{'f1_val': 0.9967189926998994, 'auprc': 0.9988413076206857, 'loss_val': 0.06265684929587861, 'psi': 0.9975679186682138}
[S13] START round=33 head_norm_before_train=1.773570 (no previous merge yet)
[S13] round=33 local utility u=0.000000 metrics={'f1_val': 0.5806809596017385, 'auprc': 0.7190651211601213, 'loss_val': 0.9506977560481542, 'psi': 0.6360346242250916}-{'f1_val': 0.6271793976812108, 'auprc': 0.747991254832673, 'loss_val': 0.6373204122632199, 'psi': 0.6755041405417956}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=33 head_norm_before_train=1.257529 cos_to_last_merge=1.0000 (last merge round=32)
[S14] round=33 local utility u=0.000000 metrics={'f1_val': 0.9974966549531046, 'auprc': 0.9953315864313214, 'loss_val': 0.10534981426832853, 'psi': 0.9966306275443912}-{'f1_val': 0.9972539966829336, 'auprc': 0.9955210703676101, 'loss_val': 0.09678106292533234, 'psi': 0.9965608261568042}
[S15] START round=33 head_norm_before_train=1.234494 cos_to_last_merge=0.9996 (last merge round=31)
[S15] round=33 local utility u=0.000000 metrics={'f1_val': 0.7828582869574673, 'auprc': 0.9921253205239211, 'loss_val': 0.3202839432992342, 'psi': 0.8665651003840488}-{'f1_val': 0.9020078310137246, 'auprc': 0.9969646708166984, 'loss_val': 0.2362411486795747, 'psi': 0.9399905669349141}
[S16] START round=33 head_norm_before_train=1.944151 (no previous merge yet)
[S16] round=33 local utility u=0.442946 metrics={'f1_val': 0.8955408557465594, 'auprc': 0.9864120018476059, 'loss_val': 0.5332751086092584, 'psi': 0.931889314186978}-{'f1_val': 0.8539494062933575, 'auprc': 0.8903811222868556, 'loss_val': 0.8815250552392762, 'psi': 0.8685220926907568}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S17] START round=33 head_norm_before_train=1.595346 cos_to_last_merge=0.7312 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.731
[S17] round=33 local utility u=0.722409 metrics={'f1_val': 0.8287531936901869, 'auprc': 0.9280228228581869, 'loss_val': 0.43003266417321484, 'psi': 0.8684610453573869}-{'f1_val': 0.6287042777056785, 'auprc': 0.9044370529207743, 'loss_val': 0.6037999298632097, 'psi': 0.7389973877917169}
[S17] not sending this round → trigger blocked (psi=0.868)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:62410
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:62404
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:62405
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=33 metric=0.7829 head_norm=1.260436
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.617357e-02
[S15] stored merged vector for next round verification (round=33)
[S15] DEBUG after merge:  round=33 metric=0.7828 head_norm=1.265873 delta_norm=0.086174
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S11] sending update (kind=head size=1799 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] RECEIVED delta(kind=head bytes=1799) from S11
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.478895)
[S9] loaded HEAD from S11 (vec_in norm=1.478895)
[S9] cosine check vs S11: cos=0.9966
[S9] BUFFERED delta from S11 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1801) from S5
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.320627)
[S4] loaded HEAD from S5 (vec_in norm=1.320627)
[S4] cosine check vs S5: cos=0.9982
[S4] BUFFERED delta from S5 (total buffered=1)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=33 metric=0.9967 head_norm=1.478895
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.146834e-02
[S11] stored merged vector for next round verification (round=33)
[S11] DEBUG after merge:  round=33 metric=0.9967 head_norm=1.457778 delta_norm=0.081468
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1801) from S4
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.322268)
[S5] loaded HEAD from S4 (vec_in norm=1.322268)
[S5] cosine check vs S4: cos=0.9982
[S5] BUFFERED delta from S4 (total buffered=1)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=33 metric=0.9417 head_norm=1.322268
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.012002e-02
[S4] stored merged vector for next round verification (round=33)
[S4] DEBUG after merge:  round=33 metric=0.9423 head_norm=1.320838 delta_norm=0.040120
[S4] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=34 head_norm_before_train=1.846077 (no previous merge yet)
[S2] round=34 local utility u=0.000000 metrics={'f1_val': 0.7054248283949375, 'auprc': 0.8968487324285089, 'loss_val': 0.3513116597142989, 'psi': 0.7819943900083661}-{'f1_val': 0.832462452830113, 'auprc': 0.7873952981428396, 'loss_val': 0.26362100968546853, 'psi': 0.8144355909552037}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=34 head_norm_before_train=2.215239 (no previous merge yet)
[S3] round=34 local utility u=0.105887 metrics={'f1_val': 0.8853417725527972, 'auprc': 0.9991950129458795, 'loss_val': 0.2311300662706383, 'psi': 0.9308830687100301}-{'f1_val': 0.8595539299404882, 'auprc': 0.9992178799014519, 'loss_val': 0.2882462782383539, 'psi': 0.9154195099248736}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=34 head_norm_before_train=1.320838 cos_to_last_merge=1.0000 (last merge round=33)
[S4] round=34 local utility u=0.000000 metrics={'f1_val': 0.9400888549612614, 'auprc': 0.9626779291553731, 'loss_val': 0.3269579508252059, 'psi': 0.949124484638906}-{'f1_val': 0.9417443360659011, 'auprc': 0.9640449766336785, 'loss_val': 0.30626990060555725, 'psi': 0.9506645922930121}
[S5] START round=34 head_norm_before_train=1.320627 cos_to_last_merge=0.9996 (last merge round=32)
[S5] round=34 local utility u=0.026506 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9948238835123357, 'loss_val': 0.14417475884313347, 'psi': 0.9956411673905209}-{'f1_val': 0.995817293346464, 'auprc': 0.9919045075706587, 'loss_val': 0.18621589719726467, 'psi': 0.9942521790361418}
[S6] START round=34 head_norm_before_train=1.298168 cos_to_last_merge=0.9971 (last merge round=30)
[S6] round=34 local utility u=0.000000 metrics={'f1_val': 0.8076830346315286, 'auprc': 0.9530421290339292, 'loss_val': 0.4429851191602053, 'psi': 0.8658266723924888}-{'f1_val': 0.8636962467728768, 'auprc': 0.9553896791836037, 'loss_val': 0.3242956966478769, 'psi': 0.9003736197371677}
[S7] START round=34 head_norm_before_train=1.832190 (no previous merge yet)
[S7] round=34 local utility u=0.000000 metrics={'f1_val': 0.6746793335789922, 'auprc': 0.8315875374943973, 'loss_val': 0.3431599245784741, 'psi': 0.7374426151451543}-{'f1_val': 0.8809110513408921, 'auprc': 0.9909098385402405, 'loss_val': 0.15016768419050874, 'psi': 0.9249105662206314}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=34 head_norm_before_train=1.546739 cos_to_last_merge=0.9697 (last merge round=24)
[S8] round=34 local utility u=0.000000 metrics={'f1_val': 0.9914482382097267, 'auprc': 0.9989553858798853, 'loss_val': 0.06536510716089361, 'psi': 0.9944510972777902}-{'f1_val': 0.992174240363445, 'auprc': 0.9988916018555771, 'loss_val': 0.06870326018876172, 'psi': 0.9948611849602979}
[S9] START round=34 head_norm_before_train=1.461909 cos_to_last_merge=1.0000 (last merge round=32)
[S9] round=34 local utility u=0.027692 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9947227672863427, 'loss_val': 0.03640823039710179, 'psi': 0.9959046016733943}-{'f1_val': 0.9893026945281196, 'auprc': 0.9979742301232502, 'loss_val': 0.05720819747143426, 'psi': 0.9927713087661718}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=34 metric=0.9967 head_norm=1.482294
[S9] _apply_head_vector_avg (torch): Δ‖w‖=6.421076e-02
[S9] stored merged vector for next round verification (round=34)
[S9] DEBUG after merge:  round=34 metric=0.9967 head_norm=1.479203 delta_norm=0.064211
[S9] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S10] START round=34 head_norm_before_train=1.689102 cos_to_last_merge=0.9905 (last merge round=22)
[S10] round=34 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9930825400626642, 'loss_val': 0.042472583754679244, 'psi': 0.9940821815566891}-{'f1_val': 0.9936518403636662, 'auprc': 0.9965462073620815, 'loss_val': 0.03750375791653203, 'psi': 0.9948095871630322}
[S11] START round=34 head_norm_before_train=1.457778 cos_to_last_merge=1.0000 (last merge round=33)
[S11] round=34 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9988737961698323, 'loss_val': 0.05703717259575812, 'psi': 0.9974777211760867}-{'f1_val': 0.9967189926998994, 'auprc': 0.9988512195955259, 'loss_val': 0.05489887389445455, 'psi': 0.99757188345815}
[S13] START round=34 head_norm_before_train=1.776601 (no previous merge yet)
[S13] round=34 local utility u=0.106208 metrics={'f1_val': 0.590661113665173, 'auprc': 0.7364844713736609, 'loss_val': 0.8504203395280492, 'psi': 0.6489904567485683}-{'f1_val': 0.5806809596017385, 'auprc': 0.7190651211601213, 'loss_val': 0.9506977560481542, 'psi': 0.6360346242250916}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=34 head_norm_before_train=1.286069 cos_to_last_merge=0.9997 (last merge round=32)
[S14] round=34 local utility u=0.000000 metrics={'f1_val': 0.996675617721899, 'auprc': 0.9953028089726809, 'loss_val': 0.10096564063141134, 'psi': 0.9961264942222118}-{'f1_val': 0.9974966549531046, 'auprc': 0.9953315864313214, 'loss_val': 0.10534981426832853, 'psi': 0.9966306275443912}
[S15] START round=34 head_norm_before_train=1.265873 cos_to_last_merge=1.0000 (last merge round=33)
[S15] round=34 local utility u=0.399862 metrics={'f1_val': 0.8978986109298379, 'auprc': 0.9969246440524395, 'loss_val': 0.2251992629765689, 'psi': 0.9375090241788786}-{'f1_val': 0.7828582869574673, 'auprc': 0.9921253205239211, 'loss_val': 0.3202839432992342, 'psi': 0.8665651003840488}
[S16] START round=34 head_norm_before_train=1.954990 (no previous merge yet)
[S16] round=34 local utility u=0.207428 metrics={'f1_val': 0.9346755720987985, 'auprc': 0.9899667117402277, 'loss_val': 0.3638908725413485, 'psi': 0.9567920279553702}-{'f1_val': 0.8955408557465594, 'auprc': 0.9864120018476059, 'loss_val': 0.5332751086092584, 'psi': 0.931889314186978}
[S16] not sending this round → trigger blocked (psi=0.957)
[S17] START round=34 head_norm_before_train=1.620170 cos_to_last_merge=0.7306 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.731
[S17] round=34 local utility u=0.000000 metrics={'f1_val': 0.6617355011846262, 'auprc': 0.974105158897526, 'loss_val': 0.5519935910961937, 'psi': 0.7866833642697861}-{'f1_val': 0.8287531936901869, 'auprc': 0.9280228228581869, 'loss_val': 0.43003266417321484, 'psi': 0.8684610453573869}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.996)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:62414
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1801 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=34 metric=0.9962 head_norm=1.353003
[S5] _apply_head_vector_avg (torch): Δ‖w‖=6.389052e-02
[S5] stored merged vector for next round verification (round=34)
[S5] DEBUG after merge:  round=34 metric=0.9962 head_norm=1.336197 delta_norm=0.063891
[S5] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S14] RECEIVED delta(kind=head bytes=1801) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.291393)
[S14] loaded HEAD from S15 (vec_in norm=1.291393)
[S14] cosine check vs S15: cos=0.8994
[S14] BUFFERED delta from S15 (total buffered=1)
[S2] START round=35 head_norm_before_train=1.856024 (no previous merge yet)
[S2] round=35 local utility u=0.222211 metrics={'f1_val': 0.8293630546981738, 'auprc': 0.7718872119184077, 'loss_val': 0.27563358704034774, 'psi': 0.8063727175862674}-{'f1_val': 0.7054248283949375, 'auprc': 0.8968487324285089, 'loss_val': 0.3513116597142989, 'psi': 0.7819943900083661}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=35 head_norm_before_train=2.227917 (no previous merge yet)
[S3] round=35 local utility u=0.011663 metrics={'f1_val': 0.8901092828552465, 'auprc': 0.9990008321605996, 'loss_val': 0.2358264328065927, 'psi': 0.9336659025773878}-{'f1_val': 0.8853417725527972, 'auprc': 0.9991950129458795, 'loss_val': 0.2311300662706383, 'psi': 0.9308830687100301}
[S3] not sending this round → trigger blocked (psi=0.934)
[S4] START round=35 head_norm_before_train=1.344244 cos_to_last_merge=0.9996 (last merge round=33)
[S4] round=35 local utility u=0.022971 metrics={'f1_val': 0.9411316405571648, 'auprc': 0.9653350709364054, 'loss_val': 0.29524435396247695, 'psi': 0.950813012708861}-{'f1_val': 0.9400888549612614, 'auprc': 0.9626779291553731, 'loss_val': 0.3269579508252059, 'psi': 0.949124484638906}
[S5] START round=35 head_norm_before_train=1.336197 cos_to_last_merge=1.0000 (last merge round=34)
[S5] round=35 local utility u=0.009255 metrics={'f1_val': 0.996186023309311, 'auprc': 0.994837198389236, 'loss_val': 0.12570486729411937, 'psi': 0.995646493341281}-{'f1_val': 0.996186023309311, 'auprc': 0.9948238835123357, 'loss_val': 0.14417475884313347, 'psi': 0.9956411673905209}
[S6] START round=35 head_norm_before_train=1.317522 cos_to_last_merge=0.9962 (last merge round=30)
[S6] round=35 local utility u=0.078224 metrics={'f1_val': 0.8324099645206878, 'auprc': 0.9480005479739881, 'loss_val': 0.4197742710130647, 'psi': 0.8786461979020079}-{'f1_val': 0.8076830346315286, 'auprc': 0.9530421290339292, 'loss_val': 0.4429851191602053, 'psi': 0.8658266723924888}
[S7] START round=35 head_norm_before_train=1.834944 (no previous merge yet)
[S7] round=35 local utility u=0.000000 metrics={'f1_val': 0.6319203880924587, 'auprc': 0.7991196541794974, 'loss_val': 0.5588041181636109, 'psi': 0.6988000945272741}-{'f1_val': 0.6746793335789922, 'auprc': 0.8315875374943973, 'loss_val': 0.3431599245784741, 'psi': 0.7374426151451543}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=35 head_norm_before_train=1.569401 cos_to_last_merge=0.9675 (last merge round=24)
[S8] round=35 local utility u=0.000000 metrics={'f1_val': 0.9938130760262815, 'auprc': 0.9885992170905035, 'loss_val': 0.06166232862183404, 'psi': 0.9917275324519703}-{'f1_val': 0.9914482382097267, 'auprc': 0.9989553858798853, 'loss_val': 0.06536510716089361, 'psi': 0.9944510972777902}
[S9] START round=35 head_norm_before_train=1.479203 cos_to_last_merge=1.0000 (last merge round=34)
[S9] round=35 local utility u=0.004091 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9965255216852058, 'loss_val': 0.03459468693651251, 'psi': 0.9967217599294367}-{'f1_val': 0.9966924912647621, 'auprc': 0.9947227672863427, 'loss_val': 0.03640823039710179, 'psi': 0.9959046016733943}
[S9] not sending this round → trigger blocked (psi=0.997)
[S10] START round=35 head_norm_before_train=1.702754 cos_to_last_merge=0.9896 (last merge round=22)
[S10] round=35 local utility u=0.005288 metrics={'f1_val': 0.9940903254969471, 'auprc': 0.9957793110157814, 'loss_val': 0.036038182558868086, 'psi': 0.9947659197044808}-{'f1_val': 0.9947486092193725, 'auprc': 0.9930825400626642, 'loss_val': 0.042472583754679244, 'psi': 0.9940821815566891}
[S11] START round=35 head_norm_before_train=1.480349 cos_to_last_merge=0.9999 (last merge round=33)
[S11] round=35 local utility u=0.005150 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9990598029708865, 'loss_val': 0.04584370345315762, 'psi': 0.9974070216696711}-{'f1_val': 0.9965470045135896, 'auprc': 0.9988737961698323, 'loss_val': 0.05703717259575812, 'psi': 0.9974777211760867}
[S13] START round=35 head_norm_before_train=1.782936 (no previous merge yet)
[S13] round=35 local utility u=0.000000 metrics={'f1_val': 0.5765212375887987, 'auprc': 0.7207008585065873, 'loss_val': 1.0285206919657048, 'psi': 0.6341930859559142}-{'f1_val': 0.590661113665173, 'auprc': 0.7364844713736609, 'loss_val': 0.8504203395280492, 'psi': 0.6489904567485683}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=35 head_norm_before_train=1.306654 cos_to_last_merge=0.9991 (last merge round=32)
[S14] round=35 local utility u=0.009120 metrics={'f1_val': 0.9966659875671569, 'auprc': 0.995449983049024, 'loss_val': 0.08310973269614373, 'psi': 0.9961795857599037}-{'f1_val': 0.996675617721899, 'auprc': 0.9953028089726809, 'loss_val': 0.10096564063141134, 'psi': 0.9961264942222118}
[S15] START round=35 head_norm_before_train=1.291393 cos_to_last_merge=0.9998 (last merge round=33)
[S15] round=35 local utility u=0.091054 metrics={'f1_val': 0.918659402056106, 'auprc': 0.996524864823523, 'loss_val': 0.16645696311269842, 'psi': 0.9498055871630728}-{'f1_val': 0.8978986109298379, 'auprc': 0.9969246440524395, 'loss_val': 0.2251992629765689, 'psi': 0.9375090241788786}
[S16] START round=35 head_norm_before_train=1.964036 (no previous merge yet)
[S16] round=35 local utility u=0.043689 metrics={'f1_val': 0.9390543314642911, 'auprc': 0.9911692044789684, 'loss_val': 0.30639359888058093, 'psi': 0.959900280670162}-{'f1_val': 0.9346755720987985, 'auprc': 0.9899667117402277, 'loss_val': 0.3638908725413485, 'psi': 0.9567920279553702}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=35 head_norm_before_train=1.637306 cos_to_last_merge=0.7299 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.730
[S17] round=35 local utility u=0.138773 metrics={'f1_val': 0.6887424447391557, 'auprc': 0.9967575653125276, 'loss_val': 0.504446166691906, 'psi': 0.8119484929685045}-{'f1_val': 0.6617355011846262, 'auprc': 0.974105158897526, 'loss_val': 0.5519935910961937, 'psi': 0.7866833642697861}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S4@127.0.0.1:62404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:62412
[S15] not sending this round → trigger blocked (psi=0.950)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:62410
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:62405
[S11] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:62415
[S5] sending update (kind=head size=1804 to 1 peers)
[S15] ⇄ pheromone p=0.246 → S14@127.0.0.1:62414
[S4] RECEIVED delta(kind=head bytes=1804) from S5
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.380680)
[S4] loaded HEAD from S5 (vec_in norm=1.380680)
[S4] cosine check vs S5: cos=0.9964
[S4] BUFFERED delta from S5 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1800) from S14
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.332076)
[S11] loaded HEAD from S14 (vec_in norm=1.332076)
[S11] cosine check vs S14: cos=0.9377
[S11] BUFFERED delta from S14 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1795) from S11
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.502808)
[S9] loaded HEAD from S11 (vec_in norm=1.502808)
[S9] cosine check vs S11: cos=0.9962
[S9] BUFFERED delta from S11 (total buffered=1)
[S6] sending update (kind=head size=1803 to 1 peers)
[S5] ⇄ pheromone p=0.206 → S4@127.0.0.1:62404
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=35 metric=0.9967 head_norm=1.332076
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.953902e-01
[S14] stored merged vector for next round verification (round=35)
[S14] DEBUG after merge:  round=35 metric=0.9967 head_norm=1.278204 delta_norm=0.295390
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.012 → S11@127.0.0.1:62412
[S4] sending update (kind=head size=1799 to 1 peers)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=35 metric=0.9963 head_norm=1.502808
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.639534e-01
[S11] stored merged vector for next round verification (round=35)
[S11] DEBUG after merge:  round=35 metric=0.9963 head_norm=1.395262 delta_norm=0.263953
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.014 → S9@127.0.0.1:62410
[S15] RECEIVED delta(kind=head bytes=1803) from S6
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.340106)
[S15] loaded HEAD from S6 (vec_in norm=1.340106)
[S15] cosine check vs S6: cos=0.9941
[S15] BUFFERED delta from S6 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1799) from S4
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.364778)
[S5] loaded HEAD from S4 (vec_in norm=1.364778)
[S5] cosine check vs S4: cos=0.9964
[S5] BUFFERED delta from S4 (total buffered=1)
[S6] ⇄ pheromone p=0.230 → S15@127.0.0.1:62415
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=35 metric=0.9411 head_norm=1.364778
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.860932e-02
[S4] stored merged vector for next round verification (round=35)
[S4] DEBUG after merge:  round=35 metric=0.9411 head_norm=1.371501 delta_norm=0.058609
[S4] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.064 → S5@127.0.0.1:62405
[S2] START round=36 head_norm_before_train=1.864422 (no previous merge yet)
[S2] round=36 local utility u=0.147806 metrics={'f1_val': 0.828979507696128, 'auprc': 0.8685570537330788, 'loss_val': 0.2677301008186068, 'psi': 0.8448105261109083}-{'f1_val': 0.8293630546981738, 'auprc': 0.7718872119184077, 'loss_val': 0.27563358704034774, 'psi': 0.8063727175862674}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[S3] START round=36 head_norm_before_train=2.240000 (no previous merge yet)
[S3] round=36 local utility u=0.000000 metrics={'f1_val': 0.7419867152730155, 'auprc': 0.9845313979368286, 'loss_val': 0.8113054928742106, 'psi': 0.8390045883385407}-{'f1_val': 0.8901092828552465, 'auprc': 0.9990008321605996, 'loss_val': 0.2358264328065927, 'psi': 0.9336659025773878}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=36 head_norm_before_train=1.371501 cos_to_last_merge=1.0000 (last merge round=35)
[S4] round=36 local utility u=0.000000 metrics={'f1_val': 0.9395354313769497, 'auprc': 0.9607950507117291, 'loss_val': 0.30217499965616496, 'psi': 0.9480392791108615}-{'f1_val': 0.9411316405571648, 'auprc': 0.9653350709364054, 'loss_val': 0.29524435396247695, 'psi': 0.950813012708861}
[S5] START round=36 head_norm_before_train=1.380680 cos_to_last_merge=0.9989 (last merge round=34)
[S5] round=36 local utility u=0.015538 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9952390474297689, 'loss_val': 0.09583369769217263, 'psi': 0.9958072329574942}-{'f1_val': 0.996186023309311, 'auprc': 0.994837198389236, 'loss_val': 0.12570486729411937, 'psi': 0.995646493341281}
[S6] START round=36 head_norm_before_train=1.340106 cos_to_last_merge=0.9952 (last merge round=30)
[S6] round=36 local utility u=0.000000 metrics={'f1_val': 0.6452748424748386, 'auprc': 0.8943515806756374, 'loss_val': 0.40140529260894037, 'psi': 0.7449055377551581}-{'f1_val': 0.8324099645206878, 'auprc': 0.9480005479739881, 'loss_val': 0.4197742710130647, 'psi': 0.8786461979020079}
[S7] START round=36 head_norm_before_train=1.843428 (no previous merge yet)
[S7] round=36 local utility u=0.125573 metrics={'f1_val': 0.6620930125418936, 'auprc': 0.8089410964289256, 'loss_val': 0.5181590302653629, 'psi': 0.7208322460967064}-{'f1_val': 0.6319203880924587, 'auprc': 0.7991196541794974, 'loss_val': 0.5588041181636109, 'psi': 0.6988000945272741}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=36 head_norm_before_train=1.592064 cos_to_last_merge=0.9651 (last merge round=24)
[S8] round=36 local utility u=0.000000 metrics={'f1_val': 0.9832726227447797, 'auprc': 0.9989896622272197, 'loss_val': 0.07264657107013273, 'psi': 0.9895594385377557}-{'f1_val': 0.9938130760262815, 'auprc': 0.9885992170905035, 'loss_val': 0.06166232862183404, 'psi': 0.9917275324519703}
[S9] START round=36 head_norm_before_train=1.500065 cos_to_last_merge=1.0000 (last merge round=34)
[S9] round=36 local utility u=0.000000 metrics={'f1_val': 0.9916752349893785, 'auprc': 0.997568411343037, 'loss_val': 0.0432511934287227, 'psi': 0.9940325055308419}-{'f1_val': 0.9968525854255906, 'auprc': 0.9965255216852058, 'loss_val': 0.03459468693651251, 'psi': 0.9967217599294367}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=36 metric=0.9917 head_norm=1.519587
[S9] _apply_head_vector_avg (torch): Δ‖w‖=7.016637e-02
[S9] stored merged vector for next round verification (round=36)
[S9] DEBUG after merge:  round=36 metric=0.9917 head_norm=1.509591 delta_norm=0.070166
[S9] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S10] START round=36 head_norm_before_train=1.716749 cos_to_last_merge=0.9886 (last merge round=22)
[S10] round=36 local utility u=0.000000 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9942728229810535, 'loss_val': 0.03579359383508208, 'psi': 0.994426593271458}-{'f1_val': 0.9940903254969471, 'auprc': 0.9957793110157814, 'loss_val': 0.036038182558868086, 'psi': 0.9947659197044808}
[S11] START round=36 head_norm_before_train=1.395262 cos_to_last_merge=1.0000 (last merge round=35)
[S11] round=36 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9990134725563448, 'loss_val': 0.0632856429960315, 'psi': 0.9975335917306917}-{'f1_val': 0.996305167468861, 'auprc': 0.9990598029708865, 'loss_val': 0.04584370345315762, 'psi': 0.9974070216696711}
[S13] START round=36 head_norm_before_train=1.793053 (no previous merge yet)
[S13] round=36 local utility u=0.092128 metrics={'f1_val': 0.5869445677625731, 'auprc': 0.7250514041651089, 'loss_val': 0.9198568999307408, 'psi': 0.6421873023235873}-{'f1_val': 0.5765212375887987, 'auprc': 0.7207008585065873, 'loss_val': 1.0285206919657048, 'psi': 0.6341930859559142}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] sending update (kind=head size=1794 to 1 peers)
[S14] START round=36 head_norm_before_train=1.278204 cos_to_last_merge=1.0000 (last merge round=35)
[S14] round=36 local utility u=0.000000 metrics={'f1_val': 0.942528269821404, 'auprc': 0.9986489260014281, 'loss_val': 0.13650041731890836, 'psi': 0.9649765322934136}-{'f1_val': 0.9966659875671569, 'auprc': 0.995449983049024, 'loss_val': 0.08310973269614373, 'psi': 0.9961795857599037}
[S15] START round=36 head_norm_before_train=1.315851 cos_to_last_merge=0.9992 (last merge round=33)
[S15] round=36 local utility u=0.279050 metrics={'f1_val': 0.9960847273356198, 'auprc': 0.9983441721282538, 'loss_val': 0.07836701586669781, 'psi': 0.9969885052526734}-{'f1_val': 0.918659402056106, 'auprc': 0.996524864823523, 'loss_val': 0.16645696311269842, 'psi': 0.9498055871630728}
[S16] START round=36 head_norm_before_train=1.970620 (no previous merge yet)
[S16] round=36 local utility u=0.000000 metrics={'f1_val': 0.8568981819149009, 'auprc': 0.9139965068287945, 'loss_val': 0.8537260875464479, 'psi': 0.8797375118804582}-{'f1_val': 0.9390543314642911, 'auprc': 0.9911692044789684, 'loss_val': 0.30639359888058093, 'psi': 0.959900280670162}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=36 head_norm_before_train=1.652446 cos_to_last_merge=0.7291 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.729
[S17] round=36 local utility u=1.000000 metrics={'f1_val': 0.9862170540196655, 'auprc': 0.9972942015673671, 'loss_val': 0.167425236767372, 'psi': 0.9906479130387462}-{'f1_val': 0.6887424447391557, 'auprc': 0.9967575653125276, 'loss_val': 0.504446166691906, 'psi': 0.8119484929685045}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:62404
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:62414
[S5] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] RECEIVED delta(kind=head bytes=1802) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.341516)
[S14] loaded HEAD from S15 (vec_in norm=1.341516)
[S14] cosine check vs S15: cos=0.9686
[S14] BUFFERED delta from S15 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1799) from S5
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.430833)
[S4] loaded HEAD from S5 (vec_in norm=1.430833)
[S4] cosine check vs S5: cos=0.9961
[S4] BUFFERED delta from S5 (total buffered=1)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=36 metric=0.9961 head_norm=1.341516
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.685991e-02
[S15] stored merged vector for next round verification (round=36)
[S15] DEBUG after merge:  round=36 metric=0.9961 head_norm=1.338607 delta_norm=0.076860
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=36 metric=0.9962 head_norm=1.430833
[S5] _apply_head_vector_avg (torch): Δ‖w‖=9.222742e-02
[S5] stored merged vector for next round verification (round=36)
[S5] DEBUG after merge:  round=36 metric=0.9962 head_norm=1.395151 delta_norm=0.092227
[S5] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=36 metric=0.9395 head_norm=1.385785
[S4] _apply_head_vector_avg (torch): Δ‖w‖=6.633093e-02
[S4] stored merged vector for next round verification (round=36)
[S4] DEBUG after merge:  round=36 metric=0.9399 head_norm=1.406927 delta_norm=0.066331
[S4] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=37 head_norm_before_train=1.872050 (no previous merge yet)
[S2] round=37 local utility u=0.069469 metrics={'f1_val': 0.827033340281961, 'auprc': 0.9286900078695397, 'loss_val': 0.2975132985620024, 'psi': 0.8676960073169925}-{'f1_val': 0.828979507696128, 'auprc': 0.8685570537330788, 'loss_val': 0.2677301008186068, 'psi': 0.8448105261109083}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] START round=37 head_norm_before_train=2.252975 (no previous merge yet)
[S3] round=37 local utility u=0.573033 metrics={'f1_val': 0.8551058168468213, 'auprc': 0.9989298008039948, 'loss_val': 0.3871489878873397, 'psi': 0.9126354104296907}-{'f1_val': 0.7419867152730155, 'auprc': 0.9845313979368286, 'loss_val': 0.8113054928742106, 'psi': 0.8390045883385407}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=37 head_norm_before_train=1.406927 cos_to_last_merge=1.0000 (last merge round=36)
[S4] round=37 local utility u=0.074355 metrics={'f1_val': 0.9579681020619514, 'auprc': 0.9644080127019665, 'loss_val': 0.2749006890257367, 'psi': 0.9605440663179574}-{'f1_val': 0.9395354313769497, 'auprc': 0.9607950507117291, 'loss_val': 0.30217499965616496, 'psi': 0.9480392791108615}
[S5] START round=37 head_norm_before_train=1.395151 cos_to_last_merge=1.0000 (last merge round=36)
[S5] round=37 local utility u=0.001816 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9961969274700189, 'loss_val': 0.0950744626850272, 'psi': 0.9961903849735941}-{'f1_val': 0.996186023309311, 'auprc': 0.9952390474297689, 'loss_val': 0.09583369769217263, 'psi': 0.9958072329574942}
[S6] START round=37 head_norm_before_train=1.363935 cos_to_last_merge=0.9938 (last merge round=30)
[S6] round=37 local utility u=0.481390 metrics={'f1_val': 0.7907532350877219, 'auprc': 0.9534813705105873, 'loss_val': 0.4888852317048111, 'psi': 0.8558444892568681}-{'f1_val': 0.6452748424748386, 'auprc': 0.8943515806756374, 'loss_val': 0.40140529260894037, 'psi': 0.7449055377551581}
[S7] START round=37 head_norm_before_train=1.856765 (no previous merge yet)
[S7] round=37 local utility u=0.245819 metrics={'f1_val': 0.6870089183600812, 'auprc': 0.8496285493481737, 'loss_val': 0.2980792767202053, 'psi': 0.7520567707553181}-{'f1_val': 0.6620930125418936, 'auprc': 0.8089410964289256, 'loss_val': 0.5181590302653629, 'psi': 0.7208322460967064}
[S7] not sending this round → trigger blocked (psi=0.752)
[S8] START round=37 head_norm_before_train=1.617862 cos_to_last_merge=0.9623 (last merge round=24)
[S8] round=37 local utility u=0.000000 metrics={'f1_val': 0.713665972483988, 'auprc': 0.9866085596482679, 'loss_val': 0.29289591985533536, 'psi': 0.8228430073497}-{'f1_val': 0.9832726227447797, 'auprc': 0.9989896622272197, 'loss_val': 0.07264657107013273, 'psi': 0.9895594385377557}
[S9] START round=37 head_norm_before_train=1.509591 cos_to_last_merge=1.0000 (last merge round=36)
[S9] round=37 local utility u=0.018144 metrics={'f1_val': 0.9973530931731848, 'auprc': 0.9943686039905536, 'loss_val': 0.03143170208100896, 'psi': 0.9961592975001323}-{'f1_val': 0.9916752349893785, 'auprc': 0.997568411343037, 'loss_val': 0.0432511934287227, 'psi': 0.9940325055308419}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=37 head_norm_before_train=1.730373 cos_to_last_merge=0.9878 (last merge round=22)
[S10] round=37 local utility u=0.001747 metrics={'f1_val': 0.9940903254969471, 'auprc': 0.9957040410035669, 'loss_val': 0.033959673609533295, 'psi': 0.994735811699595}-{'f1_val': 0.9945291067983943, 'auprc': 0.9942728229810535, 'loss_val': 0.03579359383508208, 'psi': 0.994426593271458}
[S11] START round=37 head_norm_before_train=1.417831 cos_to_last_merge=0.9999 (last merge round=35)
[S11] round=37 local utility u=0.004544 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9976521599267064, 'loss_val': 0.048661919227831654, 'psi': 0.9968439644519991}-{'f1_val': 0.9965470045135896, 'auprc': 0.9990134725563448, 'loss_val': 0.0632856429960315, 'psi': 0.9975335917306917}
[S13] START round=37 head_norm_before_train=1.803910 (no previous merge yet)
[S13] round=37 local utility u=0.546266 metrics={'f1_val': 0.6598340550518647, 'auprc': 0.7926925106248034, 'loss_val': 0.4675850687546719, 'psi': 0.7129774372810401}-{'f1_val': 0.5869445677625731, 'auprc': 0.7250514041651089, 'loss_val': 0.9198568999307408, 'psi': 0.6421873023235873}
[S13] not sending this round → trigger blocked (psi=0.713)
[S14] START round=37 head_norm_before_train=1.306740 cos_to_last_merge=0.9998 (last merge round=35)
[S14] round=37 local utility u=0.187773 metrics={'f1_val': 0.9969911424264181, 'auprc': 0.995352907027566, 'loss_val': 0.0778429834940181, 'psi': 0.9963358482668773}-{'f1_val': 0.942528269821404, 'auprc': 0.9986489260014281, 'loss_val': 0.13650041731890836, 'psi': 0.9649765322934136}
[S15] START round=37 head_norm_before_train=1.338607 cos_to_last_merge=1.0000 (last merge round=36)
[S15] round=37 local utility u=0.000000 metrics={'f1_val': 0.7307807676288272, 'auprc': 0.9890046494036285, 'loss_val': 0.3518148074497846, 'psi': 0.8340703203387477}-{'f1_val': 0.9960847273356198, 'auprc': 0.9983441721282538, 'loss_val': 0.07836701586669781, 'psi': 0.9969885052526734}
[S16] START round=37 head_norm_before_train=1.976778 (no previous merge yet)
[S16] round=37 local utility u=0.000000 metrics={'f1_val': 0.8415875945249854, 'auprc': 0.8449684155922697, 'loss_val': 1.0703481310480403, 'psi': 0.8429399229518992}-{'f1_val': 0.8568981819149009, 'auprc': 0.9139965068287945, 'loss_val': 0.8537260875464479, 'psi': 0.8797375118804582}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=37 head_norm_before_train=1.666606 cos_to_last_merge=0.7286 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.729
[S17] round=37 local utility u=0.000000 metrics={'f1_val': 0.6267619084527694, 'auprc': 0.9975490505045955, 'loss_val': 0.5935804659984548, 'psi': 0.7750767652734998}-{'f1_val': 0.9862170540196655, 'auprc': 0.9972942015673671, 'loss_val': 0.167425236767372, 'psi': 0.9906479130387462}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.996)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S11] → sending delta(kind=head bytes=1791) to S9@127.0.0.1:62410
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:62412
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1791 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:62415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:62405
[S11] RECEIVED delta(kind=head bytes=1800) from S14
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.337899)
[S11] loaded HEAD from S14 (vec_in norm=1.337899)
[S11] cosine check vs S14: cos=0.9208
[S11] BUFFERED delta from S14 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1791) from S11
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.440104)
[S9] loaded HEAD from S11 (vec_in norm=1.440104)
[S9] cosine check vs S11: cos=0.9803
[S9] BUFFERED delta from S11 (total buffered=1)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=37 metric=0.9963 head_norm=1.440104
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.809917e-01
[S11] stored merged vector for next round verification (round=37)
[S11] DEBUG after merge:  round=37 metric=0.9963 head_norm=1.361242 delta_norm=0.280992
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S6] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=37 metric=0.9970 head_norm=1.337899
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.731781e-01
[S14] stored merged vector for next round verification (round=37)
[S14] DEBUG after merge:  round=37 metric=0.9966 head_norm=1.328469 delta_norm=0.173178
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S5] RECEIVED delta(kind=head bytes=1801) from S4
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.420777)
[S5] loaded HEAD from S4 (vec_in norm=1.420777)
[S5] cosine check vs S4: cos=0.9998
[S5] BUFFERED delta from S4 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1802) from S6
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.382080)
[S15] loaded HEAD from S6 (vec_in norm=1.382080)
[S15] cosine check vs S6: cos=0.9963
[S15] BUFFERED delta from S6 (total buffered=1)
[S2] START round=38 head_norm_before_train=1.882730 (no previous merge yet)
[S2] round=38 local utility u=0.046078 metrics={'f1_val': 0.886854473565212, 'auprc': 0.8302304524945106, 'loss_val': 0.2689061002516337, 'psi': 0.8642048651369314}-{'f1_val': 0.827033340281961, 'auprc': 0.9286900078695397, 'loss_val': 0.2975132985620024, 'psi': 0.8676960073169925}
[S2] not sending this round → trigger blocked (psi=0.864)
[S3] START round=38 head_norm_before_train=2.263624 (no previous merge yet)
[S3] round=38 local utility u=0.000000 metrics={'f1_val': 0.8446456051950377, 'auprc': 0.9976930764054096, 'loss_val': 0.4430289968159677, 'psi': 0.9058645936791865}-{'f1_val': 0.8551058168468213, 'auprc': 0.9989298008039948, 'loss_val': 0.3871489878873397, 'psi': 0.9126354104296907}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=38 head_norm_before_train=1.420777 cos_to_last_merge=0.9999 (last merge round=36)
[S4] round=38 local utility u=0.000000 metrics={'f1_val': 0.9411507496864278, 'auprc': 0.9632901174296291, 'loss_val': 0.2856736681896333, 'psi': 0.9500064967837083}-{'f1_val': 0.9579681020619514, 'auprc': 0.9644080127019665, 'loss_val': 0.2749006890257367, 'psi': 0.9605440663179574}
[S5] START round=38 head_norm_before_train=1.431793 cos_to_last_merge=0.9995 (last merge round=36)
[S5] round=38 local utility u=0.006530 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9964568790562807, 'loss_val': 0.08279492899180387, 'psi': 0.9962943656080989}-{'f1_val': 0.996186023309311, 'auprc': 0.9961969274700189, 'loss_val': 0.0950744626850272, 'psi': 0.9961903849735941}
[S6] START round=38 head_norm_before_train=1.382080 cos_to_last_merge=0.9927 (last merge round=30)
[S6] round=38 local utility u=0.291796 metrics={'f1_val': 0.8499320656940016, 'auprc': 0.9589483342376285, 'loss_val': 0.27676655105890186, 'psi': 0.8935385731114525}-{'f1_val': 0.7907532350877219, 'auprc': 0.9534813705105873, 'loss_val': 0.4888852317048111, 'psi': 0.8558444892568681}
[S7] START round=38 head_norm_before_train=1.864602 (no previous merge yet)
[S7] round=38 local utility u=0.000000 metrics={'f1_val': 0.43052730768159514, 'auprc': 0.7773433349076704, 'loss_val': 1.4437042105612994, 'psi': 0.5692537185720252}-{'f1_val': 0.6870089183600812, 'auprc': 0.8496285493481737, 'loss_val': 0.2980792767202053, 'psi': 0.7520567707553181}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=38 head_norm_before_train=1.642914 cos_to_last_merge=0.9598 (last merge round=24)
[S8] round=38 local utility u=0.965777 metrics={'f1_val': 0.9894339852550165, 'auprc': 0.999022197845492, 'loss_val': 0.05319058680885732, 'psi': 0.9932692702912067}-{'f1_val': 0.713665972483988, 'auprc': 0.9866085596482679, 'loss_val': 0.29289591985533536, 'psi': 0.8228430073497}
[S9] START round=38 head_norm_before_train=1.527028 cos_to_last_merge=1.0000 (last merge round=36)
[S9] round=38 local utility u=0.000440 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9949048214898006, 'loss_val': 0.03065936045003669, 'psi': 0.996223676103206}-{'f1_val': 0.9973530931731848, 'auprc': 0.9943686039905536, 'loss_val': 0.03143170208100896, 'psi': 0.9961592975001323}
[S9] not sending this round → trigger blocked (psi=0.996)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=38 metric=0.9971 head_norm=1.544815
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.590032e-01
[S9] stored merged vector for next round verification (round=38)
[S9] DEBUG after merge:  round=38 metric=0.9971 head_norm=1.484889 delta_norm=0.159003
[S9] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S10] START round=38 head_norm_before_train=1.743718 cos_to_last_merge=0.9870 (last merge round=22)
[S10] round=38 local utility u=0.000707 metrics={'f1_val': 0.9940903254969471, 'auprc': 0.9959043171236908, 'loss_val': 0.03314723854268752, 'psi': 0.9948159221476446}-{'f1_val': 0.9940903254969471, 'auprc': 0.9957040410035669, 'loss_val': 0.033959673609533295, 'psi': 0.994735811699595}
[S11] START round=38 head_norm_before_train=1.361242 cos_to_last_merge=1.0000 (last merge round=37)
[S11] round=38 local utility u=0.000000 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9968410983478146, 'loss_val': 0.06318891249046775, 'psi': 0.9965195398204425}-{'f1_val': 0.996305167468861, 'auprc': 0.9976521599267064, 'loss_val': 0.048661919227831654, 'psi': 0.9968439644519991}
[S13] START round=38 head_norm_before_train=1.813317 (no previous merge yet)
[S13] round=38 local utility u=0.000000 metrics={'f1_val': 0.5832048936847534, 'auprc': 0.7435671009342761, 'loss_val': 0.9892570270633788, 'psi': 0.6473497765845625}-{'f1_val': 0.6598340550518647, 'auprc': 0.7926925106248034, 'loss_val': 0.4675850687546719, 'psi': 0.7129774372810401}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=38 head_norm_before_train=1.328469 cos_to_last_merge=1.0000 (last merge round=37)
[S14] round=38 local utility u=0.000000 metrics={'f1_val': 0.9932233499741817, 'auprc': 0.9953573258110704, 'loss_val': 0.09024377180512022, 'psi': 0.9940769403089371}-{'f1_val': 0.9969911424264181, 'auprc': 0.995352907027566, 'loss_val': 0.0778429834940181, 'psi': 0.9963358482668773}
[S15] START round=38 head_norm_before_train=1.364995 cos_to_last_merge=0.9999 (last merge round=36)
[S15] round=38 local utility u=0.948482 metrics={'f1_val': 0.9963755136436562, 'auprc': 0.9972301235489609, 'loss_val': 0.07309546400514735, 'psi': 0.9967173576057782}-{'f1_val': 0.7307807676288272, 'auprc': 0.9890046494036285, 'loss_val': 0.3518148074497846, 'psi': 0.8340703203387477}
[S16] START round=38 head_norm_before_train=1.983249 (no previous merge yet)
[S16] round=38 local utility u=1.000000 metrics={'f1_val': 0.9906533609102842, 'auprc': 0.9895907668115728, 'loss_val': 0.044565271978564545, 'psi': 0.9902283232707996}-{'f1_val': 0.8415875945249854, 'auprc': 0.8449684155922697, 'loss_val': 1.0703481310480403, 'psi': 0.8429399229518992}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] sending update (kind=head size=1795 to 1 peers)
[S17] START round=38 head_norm_before_train=1.676954 cos_to_last_merge=0.7279 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.728
[S17] round=38 local utility u=0.000000 metrics={'f1_val': 0.6023416984270252, 'auprc': 0.9662069788270713, 'loss_val': 0.6632829841198585, 'psi': 0.7478878105870437}-{'f1_val': 0.6267619084527694, 'auprc': 0.9975490505045955, 'loss_val': 0.5935804659984548, 'psi': 0.7750767652734998}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:62404
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:62414
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.995)
[S15] sending update (kind=head size=1804 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] not sending this round → trigger blocked (psi=0.894)
[S14] RECEIVED delta(kind=head bytes=1804) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.388139)
[S14] loaded HEAD from S15 (vec_in norm=1.388139)
[S14] cosine check vs S15: cos=0.9841
[S14] BUFFERED delta from S15 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1800) from S5
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.458123)
[S4] loaded HEAD from S5 (vec_in norm=1.458123)
[S4] cosine check vs S5: cos=0.9988
[S4] BUFFERED delta from S5 (total buffered=1)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=38 metric=0.9962 head_norm=1.458123
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.495388e-02
[S5] stored merged vector for next round verification (round=38)
[S5] DEBUG after merge:  round=38 metric=0.9962 head_norm=1.439147 delta_norm=0.034954
[S5] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=38 metric=0.9964 head_norm=1.388139
[S15] _apply_head_vector_avg (torch): Δ‖w‖=6.456774e-02
[S15] stored merged vector for next round verification (round=38)
[S15] DEBUG after merge:  round=38 metric=0.9964 head_norm=1.383607 delta_norm=0.064568
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=38 metric=0.9412 head_norm=1.437622
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.726551e-02
[S4] stored merged vector for next round verification (round=38)
[S4] DEBUG after merge:  round=38 metric=0.9412 head_norm=1.447429 delta_norm=0.037266
[S4] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=39 head_norm_before_train=1.895866 (no previous merge yet)
[S2] round=39 local utility u=0.000000 metrics={'f1_val': 0.8285960686466418, 'auprc': 0.9259864152688438, 'loss_val': 0.3323156920903534, 'psi': 0.8675522072955226}-{'f1_val': 0.886854473565212, 'auprc': 0.8302304524945106, 'loss_val': 0.2689061002516337, 'psi': 0.8642048651369314}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=40 psi=0.868 u=0.0000 p_local=0.0776 f1=0.829 auprc=0.926 bytes=39589
[S3] START round=39 head_norm_before_train=2.270264 (no previous merge yet)
[S3] round=39 local utility u=0.000000 metrics={'f1_val': 0.7984464162547308, 'auprc': 0.9913951251915398, 'loss_val': 0.6040794127460173, 'psi': 0.8756258998294544}-{'f1_val': 0.8446456051950377, 'auprc': 0.9976930764054096, 'loss_val': 0.4430289968159677, 'psi': 0.9058645936791865}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=40 psi=0.876 u=0.0000 p_local=0.1024 f1=0.798 auprc=0.991 bytes=35980
[S4] START round=39 head_norm_before_train=1.447429 cos_to_last_merge=1.0000 (last merge round=38)
[S4] round=39 local utility u=0.000000 metrics={'f1_val': 0.9167537395058949, 'auprc': 0.928978567729039, 'loss_val': 0.39562434902842836, 'psi': 0.9216436707951525}-{'f1_val': 0.9411507496864278, 'auprc': 0.9632901174296291, 'loss_val': 0.2856736681896333, 'psi': 0.9500064967837083}
[S5] START round=39 head_norm_before_train=1.439147 cos_to_last_merge=1.0000 (last merge round=38)
[S5] round=39 local utility u=0.000000 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9931760815794298, 'loss_val': 0.08491842795480926, 'psi': 0.9948945621706043}-{'f1_val': 0.996186023309311, 'auprc': 0.9964568790562807, 'loss_val': 0.08279492899180387, 'psi': 0.9962943656080989}
[S6] START round=39 head_norm_before_train=1.399878 cos_to_last_merge=0.9914 (last merge round=30)
[S6] round=39 local utility u=0.000000 metrics={'f1_val': 0.6109264769011635, 'auprc': 0.7932126122986015, 'loss_val': 0.8432700929657267, 'psi': 0.6838409310601388}-{'f1_val': 0.8499320656940016, 'auprc': 0.9589483342376285, 'loss_val': 0.27676655105890186, 'psi': 0.8935385731114525}
[S7] START round=39 head_norm_before_train=1.869972 (no previous merge yet)
[S7] round=39 local utility u=0.985835 metrics={'f1_val': 0.6143811238246633, 'auprc': 0.7943925279042803, 'loss_val': 0.6263041578155739, 'psi': 0.68638568545651}-{'f1_val': 0.43052730768159514, 'auprc': 0.7773433349076704, 'loss_val': 1.4437042105612994, 'psi': 0.5692537185720252}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S7] r=40 psi=0.686 u=0.9858 p_local=0.3333 f1=0.614 auprc=0.794 bytes=43236
[S8] START round=39 head_norm_before_train=1.661776 cos_to_last_merge=0.9580 (last merge round=24)
[S8] round=39 local utility u=0.000698 metrics={'f1_val': 0.9892968853633592, 'auprc': 0.9990000662650302, 'loss_val': 0.05090600192970384, 'psi': 0.9931781577240276}-{'f1_val': 0.9894339852550165, 'auprc': 0.999022197845492, 'loss_val': 0.05319058680885732, 'psi': 0.9932692702912067}
[S9] START round=39 head_norm_before_train=1.484889 cos_to_last_merge=1.0000 (last merge round=38)
[S9] round=39 local utility u=0.000000 metrics={'f1_val': 0.9897381162675762, 'auprc': 0.9985627964514753, 'loss_val': 0.05174377617331673, 'psi': 0.9932679883411358}-{'f1_val': 0.9971029125121428, 'auprc': 0.9949048214898006, 'loss_val': 0.03065936045003669, 'psi': 0.996223676103206}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=40 psi=0.993 u=0.0000 p_local=0.0082 f1=0.990 auprc=0.999 bytes=44973
[S10] START round=39 head_norm_before_train=1.753461 cos_to_last_merge=0.9862 (last merge round=22)
[S10] round=39 local utility u=0.000000 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9941012142387691, 'loss_val': 0.03368814750300093, 'psi': 0.9943579497745443}-{'f1_val': 0.9940903254969471, 'auprc': 0.9959043171236908, 'loss_val': 0.03314723854268752, 'psi': 0.9948159221476446}
[S11] START round=39 head_norm_before_train=1.383213 cos_to_last_merge=0.9998 (last merge round=37)
[S11] round=39 local utility u=0.005098 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9968909081214485, 'loss_val': 0.05314251120822608, 'psi': 0.996539463729896}-{'f1_val': 0.996305167468861, 'auprc': 0.9968410983478146, 'loss_val': 0.06318891249046775, 'psi': 0.9965195398204425}
[S13] START round=39 head_norm_before_train=1.817339 (no previous merge yet)
[S13] round=39 local utility u=0.092110 metrics={'f1_val': 0.5838501798041567, 'auprc': 0.7912356671373936, 'loss_val': 0.951913556338493, 'psi': 0.6668043747374515}-{'f1_val': 0.5832048936847534, 'auprc': 0.7435671009342761, 'loss_val': 0.9892570270633788, 'psi': 0.6473497765845625}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] sending update (kind=head size=1795 to 1 peers)
[S13] r=40 psi=0.667 u=0.0921 p_local=0.1352 f1=0.584 auprc=0.791 bytes=39518
[S14] START round=39 head_norm_before_train=1.356897 cos_to_last_merge=0.9998 (last merge round=37)
[S14] round=39 local utility u=0.017174 metrics={'f1_val': 0.9961701069502772, 'auprc': 0.9952604282286102, 'loss_val': 0.0732863807013344, 'psi': 0.9958062354616104}-{'f1_val': 0.9932233499741817, 'auprc': 0.9953573258110704, 'loss_val': 0.09024377180512022, 'psi': 0.9940769403089371}
[S15] START round=39 head_norm_before_train=1.383607 cos_to_last_merge=1.0000 (last merge round=38)
[S15] round=39 local utility u=0.000000 metrics={'f1_val': 0.9760863250787544, 'auprc': 0.9977395773426224, 'loss_val': 0.09228442761646478, 'psi': 0.9847476259843015}-{'f1_val': 0.9963755136436562, 'auprc': 0.9972301235489609, 'loss_val': 0.07309546400514735, 'psi': 0.9967173576057782}
[S16] START round=39 head_norm_before_train=1.990819 (no previous merge yet)
[S16] round=39 local utility u=0.000000 metrics={'f1_val': 0.8896378949055632, 'auprc': 0.9870711118841844, 'loss_val': 0.557978652684068, 'psi': 0.9286111816970117}-{'f1_val': 0.9906533609102842, 'auprc': 0.9895907668115728, 'loss_val': 0.044565271978564545, 'psi': 0.9902283232707996}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] r=40 psi=0.929 u=0.0000 p_local=0.2440 f1=0.890 auprc=0.987 bytes=41357
[S17] START round=39 head_norm_before_train=1.689759 cos_to_last_merge=0.7273 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.727
[S17] round=39 local utility u=0.485006 metrics={'f1_val': 0.707727376406994, 'auprc': 0.997644381137665, 'loss_val': 0.4198963221518854, 'psi': 0.8236941782992624}-{'f1_val': 0.6023416984270252, 'auprc': 0.9662069788270713, 'loss_val': 0.6632829841198585, 'psi': 0.7478878105870437}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[S17] r=40 psi=0.824 u=0.4850 p_local=0.2719 f1=0.708 auprc=0.998 bytes=43177
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:62412
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.993)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:62410
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] r=40 psi=0.985 u=0.0000 p_local=0.2812 f1=0.976 auprc=0.998 bytes=44954
[S10] r=40 psi=0.994 u=0.0000 p_local=0.0044 f1=0.995 auprc=0.994 bytes=52112
[S8] r=40 psi=0.993 u=0.0007 p_local=0.1768 f1=0.989 auprc=0.999 bytes=39597
[S11] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1795 to 1 peers)
[S5] r=40 psi=0.995 u=0.0000 p_local=0.0873 f1=0.996 auprc=0.993 bytes=44941
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] RECEIVED delta(kind=head bytes=1797) from S11
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.401583)
[S9] loaded HEAD from S11 (vec_in norm=1.401583)
[S9] cosine check vs S11: cos=0.9586
[S9] BUFFERED delta from S11 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1795) from S14
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.382847)
[S11] loaded HEAD from S14 (vec_in norm=1.382847)
[S11] cosine check vs S14: cos=0.9460
[S11] BUFFERED delta from S14 (total buffered=1)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=39 metric=0.9962 head_norm=1.382847
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.306000e-01
[S14] stored merged vector for next round verification (round=39)
[S14] DEBUG after merge:  round=39 metric=0.9962 head_norm=1.379326 delta_norm=0.130600
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S14] r=40 psi=0.996 u=0.0172 p_local=0.0325 f1=0.996 auprc=0.995 bytes=44944
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=39 metric=0.9963 head_norm=1.401583
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.289797e-01
[S11] stored merged vector for next round verification (round=39)
[S11] DEBUG after merge:  round=39 metric=0.9963 head_norm=1.373287 delta_norm=0.228980
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S11] r=40 psi=0.997 u=0.0051 p_local=0.0072 f1=0.996 auprc=0.997 bytes=43182
[S4] r=40 psi=0.922 u=0.0000 p_local=0.0358 f1=0.917 auprc=0.929 bytes=43148
[S6] r=40 psi=0.684 u=0.0000 p_local=0.2023 f1=0.611 auprc=0.793 bytes=35965
[S2] START round=40 head_norm_before_train=1.903615 (no previous merge yet)
[S2] round=40 local utility u=0.000000 metrics={'f1_val': 0.8285861637246955, 'auprc': 0.9100186584968155, 'loss_val': 0.31779872789254254, 'psi': 0.8611591616335436}-{'f1_val': 0.8285960686466418, 'auprc': 0.9259864152688438, 'loss_val': 0.3323156920903534, 'psi': 0.8675522072955226}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=40 head_norm_before_train=2.279951 (no previous merge yet)
[S3] round=40 local utility u=0.632820 metrics={'f1_val': 0.9315897644022645, 'auprc': 0.9989444097506128, 'loss_val': 0.1599480980477427, 'psi': 0.9585316225416038}-{'f1_val': 0.7984464162547308, 'auprc': 0.9913951251915398, 'loss_val': 0.6040794127460173, 'psi': 0.8756258998294544}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=40 head_norm_before_train=1.462393 cos_to_last_merge=0.9999 (last merge round=38)
[S4] round=40 local utility u=0.155469 metrics={'f1_val': 0.9398384159334877, 'auprc': 0.9554665503902975, 'loss_val': 0.3026588079453601, 'psi': 0.9460896697162117}-{'f1_val': 0.9167537395058949, 'auprc': 0.928978567729039, 'loss_val': 0.39562434902842836, 'psi': 0.9216436707951525}
[S5] START round=40 head_norm_before_train=1.459905 cos_to_last_merge=0.9999 (last merge round=38)
[S5] round=40 local utility u=0.009247 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9954194530118357, 'loss_val': 0.07402953924525867, 'psi': 0.9958793951903209}-{'f1_val': 0.9960402158980539, 'auprc': 0.9931760815794298, 'loss_val': 0.08491842795480926, 'psi': 0.9948945621706043}
[S6] START round=40 head_norm_before_train=1.416404 cos_to_last_merge=0.9901 (last merge round=30)
[S6] round=40 local utility u=1.000000 metrics={'f1_val': 0.848889199597183, 'auprc': 0.9673566405269922, 'loss_val': 0.323667632483622, 'psi': 0.8962761759691067}-{'f1_val': 0.6109264769011635, 'auprc': 0.7932126122986015, 'loss_val': 0.8432700929657267, 'psi': 0.6838409310601388}
[S7] START round=40 head_norm_before_train=1.873548 (no previous merge yet)
[S7] round=40 local utility u=0.000000 metrics={'f1_val': 0.6144411810289836, 'auprc': 0.7933440697757415, 'loss_val': 0.6685055001669228, 'psi': 0.6860023365276868}-{'f1_val': 0.6143811238246633, 'auprc': 0.7943925279042803, 'loss_val': 0.6263041578155739, 'psi': 0.68638568545651}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=40 head_norm_before_train=1.678885 cos_to_last_merge=0.9561 (last merge round=24)
[S8] round=40 local utility u=0.000000 metrics={'f1_val': 0.7137538225988359, 'auprc': 0.986881642310373, 'loss_val': 0.4181193874318576, 'psi': 0.8230049504834508}-{'f1_val': 0.9892968853633592, 'auprc': 0.9990000662650302, 'loss_val': 0.05090600192970384, 'psi': 0.9931781577240276}
[S9] START round=40 head_norm_before_train=1.503703 cos_to_last_merge=1.0000 (last merge round=38)
[S9] round=40 local utility u=0.026444 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9961571167102009, 'loss_val': 0.033365476318272726, 'psi': 0.9964783414429377}-{'f1_val': 0.9897381162675762, 'auprc': 0.9985627964514753, 'loss_val': 0.05174377617331673, 'psi': 0.9932679883411358}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=40 metric=0.9967 head_norm=1.519754
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.203427e-01
[S9] stored merged vector for next round verification (round=40)
[S9] DEBUG after merge:  round=40 metric=0.9967 head_norm=1.445161 delta_norm=0.220343
[S9] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S10] START round=40 head_norm_before_train=1.763246 cos_to_last_merge=0.9854 (last merge round=22)
[S10] round=40 local utility u=0.002440 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9953313009873793, 'loss_val': 0.032498375199616875, 'psi': 0.9948499844739883}-{'f1_val': 0.9945291067983943, 'auprc': 0.9941012142387691, 'loss_val': 0.03368814750300093, 'psi': 0.9943579497745443}
[S11] START round=40 head_norm_before_train=1.373287 cos_to_last_merge=1.0000 (last merge round=39)
[S11] round=40 local utility u=0.000000 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9983448044287453, 'loss_val': 0.0646249524786096, 'psi': 0.9971210222528146}-{'f1_val': 0.996305167468861, 'auprc': 0.9968909081214485, 'loss_val': 0.05314251120822608, 'psi': 0.996539463729896}
[S13] START round=40 head_norm_before_train=1.817679 (no previous merge yet)
[S13] round=40 local utility u=0.082731 metrics={'f1_val': 0.592531642008271, 'auprc': 0.804686104781008, 'loss_val': 0.8788912665181654, 'psi': 0.6773934271173658}-{'f1_val': 0.5838501798041567, 'auprc': 0.7912356671373936, 'loss_val': 0.951913556338493, 'psi': 0.6668043747374515}
[S13] not sending this round → trigger blocked (psi=0.677)
[S14] START round=40 head_norm_before_train=1.379326 cos_to_last_merge=1.0000 (last merge round=39)
[S14] round=40 local utility u=0.004437 metrics={'f1_val': 0.9961901736218755, 'auprc': 0.9986687370911513, 'loss_val': 0.07475767992733202, 'psi': 0.9971815990095858}-{'f1_val': 0.9961701069502772, 'auprc': 0.9952604282286102, 'loss_val': 0.0732863807013344, 'psi': 0.9958062354616104}
[S15] START round=40 head_norm_before_train=1.407256 cos_to_last_merge=0.9999 (last merge round=38)
[S15] round=40 local utility u=0.000000 metrics={'f1_val': 0.9081327252052047, 'auprc': 0.9968100501276433, 'loss_val': 0.18722264384729578, 'psi': 0.9436036551741801}-{'f1_val': 0.9760863250787544, 'auprc': 0.9977395773426224, 'loss_val': 0.09228442761646478, 'psi': 0.9847476259843015}
[S16] START round=40 head_norm_before_train=1.995401 (no previous merge yet)
[S16] round=40 local utility u=0.000000 metrics={'f1_val': 0.8227035462966463, 'auprc': 0.8397186910211923, 'loss_val': 1.2872668490004728, 'psi': 0.8295096041864647}-{'f1_val': 0.8896378949055632, 'auprc': 0.9870711118841844, 'loss_val': 0.557978652684068, 'psi': 0.9286111816970117}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=40 head_norm_before_train=1.702040 cos_to_last_merge=0.7267 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.727
[S17] round=40 local utility u=0.000000 metrics={'f1_val': 0.599451066083469, 'auprc': 0.8260079814690444, 'loss_val': 0.7684200103859984, 'psi': 0.6900738322376991}-{'f1_val': 0.707727376406994, 'auprc': 0.997644381137665, 'loss_val': 0.4198963221518854, 'psi': 0.8236941782992624}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] sending update (kind=head size=1804 to 1 peers)
[S14] not sending this round → trigger blocked (psi=0.997)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S4@127.0.0.1:62404
[S5] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:62415
[S11] ⇄ pheromone p=0.006 → S9@127.0.0.1:62410
[S15] ⇄ pheromone p=0.225 → S14@127.0.0.1:62414
[S14] ⇄ pheromone p=0.027 → S11@127.0.0.1:62412
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:62405
[S4] RECEIVED delta(kind=head bytes=1804) from S5
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.485732)
[S4] loaded HEAD from S5 (vec_in norm=1.485732)
[S4] cosine check vs S5: cos=0.9987
[S4] BUFFERED delta from S5 (total buffered=1)
[S4] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S5] ⇄ pheromone p=0.072 → S4@127.0.0.1:62404
[S15] RECEIVED delta(kind=head bytes=1801) from S6
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.427569)
[S15] loaded HEAD from S6 (vec_in norm=1.427569)
[S15] cosine check vs S6: cos=0.9964
[S15] BUFFERED delta from S6 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1797) from S4
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.474496)
[S5] loaded HEAD from S4 (vec_in norm=1.474496)
[S5] cosine check vs S4: cos=0.9987
[S5] BUFFERED delta from S4 (total buffered=1)
[S6] ⇄ pheromone p=0.362 → S15@127.0.0.1:62415
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=40 metric=0.9398 head_norm=1.474496
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.821598e-02
[S4] stored merged vector for next round verification (round=40)
[S4] DEBUG after merge:  round=40 metric=0.9402 head_norm=1.479632 delta_norm=0.038216
[S4] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.060 → S5@127.0.0.1:62405
[S2] START round=41 head_norm_before_train=1.912158 (no previous merge yet)
[S2] round=41 local utility u=0.000000 metrics={'f1_val': 0.831491787609682, 'auprc': 0.8663392745449998, 'loss_val': 0.3073099295824066, 'psi': 0.8454307823838092}-{'f1_val': 0.8285861637246955, 'auprc': 0.9100186584968155, 'loss_val': 0.31779872789254254, 'psi': 0.8611591616335436}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=41 head_norm_before_train=2.290119 (no previous merge yet)
[S3] round=41 local utility u=0.000000 metrics={'f1_val': 0.8580329917065854, 'auprc': 0.9949641843838182, 'loss_val': 0.3540651388554743, 'psi': 0.9128054687774785}-{'f1_val': 0.9315897644022645, 'auprc': 0.9989444097506128, 'loss_val': 0.1599480980477427, 'psi': 0.9585316225416038}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=41 head_norm_before_train=1.479632 cos_to_last_merge=1.0000 (last merge round=40)
[S4] round=41 local utility u=0.021302 metrics={'f1_val': 0.9409188573713586, 'auprc': 0.9634315668960691, 'loss_val': 0.2904330902568939, 'psi': 0.9499239411812428}-{'f1_val': 0.9398384159334877, 'auprc': 0.9554665503902975, 'loss_val': 0.3026588079453601, 'psi': 0.9460896697162117}
[S5] START round=41 head_norm_before_train=1.485732 cos_to_last_merge=0.9994 (last merge round=38)
[S5] round=41 local utility u=0.004819 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9955561762124385, 'loss_val': 0.06480254564492353, 'psi': 0.995934084470562}-{'f1_val': 0.996186023309311, 'auprc': 0.9954194530118357, 'loss_val': 0.07402953924525867, 'psi': 0.9958793951903209}
[S6] START round=41 head_norm_before_train=1.427569 cos_to_last_merge=0.9893 (last merge round=30)
[S6] round=41 local utility u=0.000000 metrics={'f1_val': 0.8458248095178342, 'auprc': 0.9554576184479124, 'loss_val': 0.37523297693713775, 'psi': 0.8896779330898655}-{'f1_val': 0.848889199597183, 'auprc': 0.9673566405269922, 'loss_val': 0.323667632483622, 'psi': 0.8962761759691067}
[S7] START round=41 head_norm_before_train=1.882416 (no previous merge yet)
[S7] round=41 local utility u=0.103676 metrics={'f1_val': 0.6206991014602679, 'auprc': 0.7995889166150066, 'loss_val': 0.5174364115600475, 'psi': 0.6922550275221633}-{'f1_val': 0.6144411810289836, 'auprc': 0.7933440697757415, 'loss_val': 0.6685055001669228, 'psi': 0.6860023365276868}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=41 head_norm_before_train=1.695174 cos_to_last_merge=0.9545 (last merge round=24)
[S8] round=41 local utility u=1.000000 metrics={'f1_val': 0.9857354242324556, 'auprc': 0.9990156284213163, 'loss_val': 0.05504443899127594, 'psi': 0.991047505908}-{'f1_val': 0.7137538225988359, 'auprc': 0.986881642310373, 'loss_val': 0.4181193874318576, 'psi': 0.8230049504834508}
[S9] START round=41 head_norm_before_train=1.445161 cos_to_last_merge=1.0000 (last merge round=40)
[S9] round=41 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9986237418586382, 'loss_val': 0.0410062771801981, 'psi': 0.9974458038317902}-{'f1_val': 0.9966924912647621, 'auprc': 0.9961571167102009, 'loss_val': 0.033365476318272726, 'psi': 0.9964783414429377}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=41 head_norm_before_train=1.773838 cos_to_last_merge=0.9846 (last merge round=22)
[S10] round=41 local utility u=0.000001 metrics={'f1_val': 0.9940903254969471, 'auprc': 0.9959057427280349, 'loss_val': 0.03158729721187727, 'psi': 0.9948164923893822}-{'f1_val': 0.9945291067983943, 'auprc': 0.9953313009873793, 'loss_val': 0.032498375199616875, 'psi': 0.9948499844739883}
[S11] START round=41 head_norm_before_train=1.390485 cos_to_last_merge=0.9999 (last merge round=39)
[S11] round=41 local utility u=0.003992 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9984042881443232, 'loss_val': 0.05681931671558274, 'psi': 0.9971448157390459}-{'f1_val': 0.996305167468861, 'auprc': 0.9983448044287453, 'loss_val': 0.0646249524786096, 'psi': 0.9971210222528146}
[S13] START round=41 head_norm_before_train=1.822247 (no previous merge yet)
[S13] round=41 local utility u=0.000000 metrics={'f1_val': 0.5759130272036581, 'auprc': 0.7704752550952317, 'loss_val': 1.0676607171836376, 'psi': 0.6537379183602876}-{'f1_val': 0.592531642008271, 'auprc': 0.804686104781008, 'loss_val': 0.8788912665181654, 'psi': 0.6773934271173658}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=41 head_norm_before_train=1.403460 cos_to_last_merge=0.9998 (last merge round=39)
[S14] round=41 local utility u=0.000000 metrics={'f1_val': 0.9961471738646706, 'auprc': 0.9952660868353539, 'loss_val': 0.06909119080335689, 'psi': 0.9957947390529438}-{'f1_val': 0.9961901736218755, 'auprc': 0.9986687370911513, 'loss_val': 0.07475767992733202, 'psi': 0.9971815990095858}
[S15] START round=41 head_norm_before_train=1.429011 cos_to_last_merge=0.9996 (last merge round=38)
[S15] round=41 local utility u=0.278451 metrics={'f1_val': 0.9832725838442736, 'auprc': 0.9952239583528723, 'loss_val': 0.07640155373019632, 'psi': 0.988053133647713}-{'f1_val': 0.9081327252052047, 'auprc': 0.9968100501276433, 'loss_val': 0.18722264384729578, 'psi': 0.9436036551741801}
[S16] START round=41 head_norm_before_train=2.001558 (no previous merge yet)
[S16] round=41 local utility u=0.426456 metrics={'f1_val': 0.8489275103502976, 'auprc': 0.967851476271507, 'loss_val': 0.976096464829748, 'psi': 0.8964970967187813}-{'f1_val': 0.8227035462966463, 'auprc': 0.8397186910211923, 'loss_val': 1.2872668490004728, 'psi': 0.8295096041864647}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S17] START round=41 head_norm_before_train=1.715995 cos_to_last_merge=0.7258 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.726
[S17] round=41 local utility u=0.000000 metrics={'f1_val': 0.5792985512631632, 'auprc': 0.7765478325592928, 'loss_val': 1.0275039891026803, 'psi': 0.6581982637816151}-{'f1_val': 0.599451066083469, 'auprc': 0.8260079814690444, 'loss_val': 0.7684200103859984, 'psi': 0.6900738322376991}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:62410
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.996)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:62414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.950)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=41 metric=0.9962 head_norm=1.516547
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.413659e-02
[S5] stored merged vector for next round verification (round=41)
[S5] DEBUG after merge:  round=41 metric=0.9962 head_norm=1.494689 delta_norm=0.054137
[S5] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] sending update (kind=head size=1802 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1802) from S11
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.409729)
[S9] loaded HEAD from S11 (vec_in norm=1.409729)
[S9] cosine check vs S11: cos=0.9531
[S9] BUFFERED delta from S11 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1802) from S15
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.448925)
[S14] loaded HEAD from S15 (vec_in norm=1.448925)
[S14] cosine check vs S15: cos=0.9897
[S14] BUFFERED delta from S15 (total buffered=1)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=41 metric=0.9833 head_norm=1.448925
[S15] _apply_head_vector_avg (torch): Δ‖w‖=6.806024e-02
[S15] stored merged vector for next round verification (round=41)
[S15] DEBUG after merge:  round=41 metric=0.9824 head_norm=1.436676 delta_norm=0.068060
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=42 head_norm_before_train=1.924452 (no previous merge yet)
[S2] round=42 local utility u=0.111981 metrics={'f1_val': 0.8858368848726401, 'auprc': 0.8265790730516185, 'loss_val': 0.2901375235396356, 'psi': 0.8621337601442314}-{'f1_val': 0.831491787609682, 'auprc': 0.8663392745449998, 'loss_val': 0.3073099295824066, 'psi': 0.8454307823838092}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] START round=42 head_norm_before_train=2.300554 (no previous merge yet)
[S3] round=42 local utility u=0.000000 metrics={'f1_val': 0.7018645480898784, 'auprc': 0.9571590975658071, 'loss_val': 1.089401722303258, 'psi': 0.8039823678802499}-{'f1_val': 0.8580329917065854, 'auprc': 0.9949641843838182, 'loss_val': 0.3540651388554743, 'psi': 0.9128054687774785}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=42 head_norm_before_train=1.492515 cos_to_last_merge=0.9999 (last merge round=40)
[S4] round=42 local utility u=0.000000 metrics={'f1_val': 0.9407969325493996, 'auprc': 0.9598869289682204, 'loss_val': 0.29120581429820724, 'psi': 0.948432931116928}-{'f1_val': 0.9409188573713586, 'auprc': 0.9634315668960691, 'loss_val': 0.2904330902568939, 'psi': 0.9499239411812428}
[S5] START round=42 head_norm_before_train=1.494689 cos_to_last_merge=1.0000 (last merge round=41)
[S5] round=42 local utility u=0.001016 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9964950344284716, 'loss_val': 0.06558665276262256, 'psi': 0.9963096277569753}-{'f1_val': 0.996186023309311, 'auprc': 0.9955561762124385, 'loss_val': 0.06480254564492353, 'psi': 0.995934084470562}
[S6] START round=42 head_norm_before_train=1.436556 cos_to_last_merge=0.9883 (last merge round=30)
[S6] round=42 local utility u=0.009155 metrics={'f1_val': 0.847158344763717, 'auprc': 0.9571568812013009, 'loss_val': 0.37002144928532466, 'psi': 0.8911577593387505}-{'f1_val': 0.8458248095178342, 'auprc': 0.9554576184479124, 'loss_val': 0.37523297693713775, 'psi': 0.8896779330898655}
[S7] START round=42 head_norm_before_train=1.890149 (no previous merge yet)
[S7] round=42 local utility u=0.000000 metrics={'f1_val': 0.5738493583172468, 'auprc': 0.7867735236371103, 'loss_val': 0.8827690487031852, 'psi': 0.6590190244451922}-{'f1_val': 0.6206991014602679, 'auprc': 0.7995889166150066, 'loss_val': 0.5174364115600475, 'psi': 0.6922550275221633}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=42 head_norm_before_train=1.706698 cos_to_last_merge=0.9534 (last merge round=24)
[S8] round=42 local utility u=0.000000 metrics={'f1_val': 0.9784469650889858, 'auprc': 0.9988387373733403, 'loss_val': 0.07075935818434156, 'psi': 0.9866036740027276}-{'f1_val': 0.9857354242324556, 'auprc': 0.9990156284213163, 'loss_val': 0.05504443899127594, 'psi': 0.991047505908}
[S9] START round=42 head_norm_before_train=1.466509 cos_to_last_merge=0.9999 (last merge round=40)
[S9] round=42 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9957697098417704, 'loss_val': 0.038234591056252334, 'psi': 0.9965696314439938}-{'f1_val': 0.9966605118138915, 'auprc': 0.9986237418586382, 'loss_val': 0.0410062771801981, 'psi': 0.9974458038317902}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=42 metric=0.9971 head_norm=1.490350
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.304452e-01
[S9] stored merged vector for next round verification (round=42)
[S9] DEBUG after merge:  round=42 metric=0.9971 head_norm=1.432178 delta_norm=0.230445
[S9] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S10] START round=42 head_norm_before_train=1.781115 cos_to_last_merge=0.9837 (last merge round=22)
[S10] round=42 local utility u=0.000000 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9941228610359789, 'loss_val': 0.03228000577329725, 'psi': 0.9943666084934282}-{'f1_val': 0.9940903254969471, 'auprc': 0.9959057427280349, 'loss_val': 0.03158729721187727, 'psi': 0.9948164923893822}
[S11] START round=42 head_norm_before_train=1.409729 cos_to_last_merge=0.9995 (last merge round=39)
[S11] round=42 local utility u=0.003077 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9984029513980398, 'loss_val': 0.05066103687660515, 'psi': 0.9971442810405324}-{'f1_val': 0.996305167468861, 'auprc': 0.9984042881443232, 'loss_val': 0.05681931671558274, 'psi': 0.9971448157390459}
[S13] START round=42 head_norm_before_train=1.830707 (no previous merge yet)
[S13] round=42 local utility u=0.168216 metrics={'f1_val': 0.5960110168341635, 'auprc': 0.7753814217191288, 'loss_val': 0.8665346457936731, 'psi': 0.6677591787881496}-{'f1_val': 0.5759130272036581, 'auprc': 0.7704752550952317, 'loss_val': 1.0676607171836376, 'psi': 0.6537379183602876}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=42 head_norm_before_train=1.424096 cos_to_last_merge=0.9995 (last merge round=39)
[S14] round=42 local utility u=0.011484 metrics={'f1_val': 0.9968432356318464, 'auprc': 0.9985721020158761, 'loss_val': 0.06021816432062557, 'psi': 0.9975347821854582}-{'f1_val': 0.9961471738646706, 'auprc': 0.9952660868353539, 'loss_val': 0.06909119080335689, 'psi': 0.9957947390529438}
[S15] START round=42 head_norm_before_train=1.436676 cos_to_last_merge=1.0000 (last merge round=41)
[S15] round=42 local utility u=0.009187 metrics={'f1_val': 0.9858482851293655, 'auprc': 0.9957185076247601, 'loss_val': 0.07496575493903716, 'psi': 0.9897963741275233}-{'f1_val': 0.9832725838442736, 'auprc': 0.9952239583528723, 'loss_val': 0.07640155373019632, 'psi': 0.988053133647713}
[S16] START round=42 head_norm_before_train=2.007870 (no previous merge yet)
[S16] round=42 local utility u=0.056552 metrics={'f1_val': 0.8605700279962812, 'auprc': 0.9275695739757784, 'loss_val': 0.8120020951303989, 'psi': 0.8873698463880801}-{'f1_val': 0.8489275103502976, 'auprc': 0.967851476271507, 'loss_val': 0.976096464829748, 'psi': 0.8964970967187813}
[S16] not sending this round → trigger blocked (psi=0.887)
[S17] START round=42 head_norm_before_train=1.729967 cos_to_last_merge=0.7248 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.725
[S17] round=42 local utility u=0.685791 metrics={'f1_val': 0.6547867962650042, 'auprc': 0.9280146769580427, 'loss_val': 0.5632524005661284, 'psi': 0.7640779485422196}-{'f1_val': 0.5792985512631632, 'auprc': 0.7765478325592928, 'loss_val': 1.0275039891026803, 'psi': 0.6581982637816151}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S8]  timeout peer S6
[S10]  timeout peer S4
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:62404
[S15] not sending this round → trigger blocked (psi=0.990)
[S11] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:62412
[S14] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:62415
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] RECEIVED delta(kind=head bytes=1801) from S14
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.445979)
[S11] loaded HEAD from S14 (vec_in norm=1.445979)
[S11] cosine check vs S14: cos=0.9664
[S11] BUFFERED delta from S14 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1795) from S5
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.514180)
[S4] loaded HEAD from S5 (vec_in norm=1.514180)
[S4] cosine check vs S5: cos=0.9994
[S4] BUFFERED delta from S5 (total buffered=1)
[S6] sending update (kind=head size=1800 to 1 peers)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=42 metric=0.9968 head_norm=1.445979
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.109045e-01
[S14] stored merged vector for next round verification (round=42)
[S14] DEBUG after merge:  round=42 metric=0.9968 head_norm=1.443198 delta_norm=0.110904
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S15] RECEIVED delta(kind=head bytes=1800) from S6
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.448515)
[S15] loaded HEAD from S6 (vec_in norm=1.448515)
[S15] cosine check vs S6: cos=0.9976
[S15] BUFFERED delta from S6 (total buffered=1)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=42 metric=0.9408 head_norm=1.508027
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.665257e-02
[S4] stored merged vector for next round verification (round=42)
[S4] DEBUG after merge:  round=42 metric=0.9409 head_norm=1.510872 delta_norm=0.026653
[S4] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S6] CommDone barrier timeout: have=0 need=1 — continuing
[S2] START round=43 head_norm_before_train=1.938128 (no previous merge yet)
[S2] round=43 local utility u=0.000000 metrics={'f1_val': 0.8291723570884095, 'auprc': 0.9291172778181103, 'loss_val': 0.35367125894850293, 'psi': 0.8691503253802898}-{'f1_val': 0.8858368848726401, 'auprc': 0.8265790730516185, 'loss_val': 0.2901375235396356, 'psi': 0.8621337601442314}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=43 head_norm_before_train=2.309720 (no previous merge yet)
[S3] round=43 local utility u=0.743202 metrics={'f1_val': 0.8332347798530106, 'auprc': 0.9973307311161894, 'loss_val': 0.5117341939426265, 'psi': 0.8988731603582821}-{'f1_val': 0.7018645480898784, 'auprc': 0.9571590975658071, 'loss_val': 1.089401722303258, 'psi': 0.8039823678802499}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=43 head_norm_before_train=1.510872 cos_to_last_merge=1.0000 (last merge round=42)
[S4] round=43 local utility u=0.000000 metrics={'f1_val': 0.9401667793097361, 'auprc': 0.9581759349778078, 'loss_val': 0.29115610926170743, 'psi': 0.9473704415769648}-{'f1_val': 0.9407969325493996, 'auprc': 0.9598869289682204, 'loss_val': 0.29120581429820724, 'psi': 0.948432931116928}
[S5] START round=43 head_norm_before_train=1.514180 cos_to_last_merge=0.9999 (last merge round=41)
[S5] round=43 local utility u=0.005248 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9968207976521732, 'loss_val': 0.05606824364895152, 'psi': 0.996439933046456}-{'f1_val': 0.996186023309311, 'auprc': 0.9964950344284716, 'loss_val': 0.06558665276262256, 'psi': 0.9963096277569753}
[S6] START round=43 head_norm_before_train=1.448515 cos_to_last_merge=0.9869 (last merge round=30)
[S6] round=43 local utility u=0.095900 metrics={'f1_val': 0.8537560044518377, 'auprc': 0.9679499966406149, 'loss_val': 0.2501870499313624, 'psi': 0.8994336013273486}-{'f1_val': 0.847158344763717, 'auprc': 0.9571568812013009, 'loss_val': 0.37002144928532466, 'psi': 0.8911577593387505}
[S7] START round=43 head_norm_before_train=1.901030 (no previous merge yet)
[S7] round=43 local utility u=0.165873 metrics={'f1_val': 0.600835393879712, 'auprc': 0.7923901840212704, 'loss_val': 0.7297899042354233, 'psi': 0.6774573099363354}-{'f1_val': 0.5738493583172468, 'auprc': 0.7867735236371103, 'loss_val': 0.8827690487031852, 'psi': 0.6590190244451922}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=43 head_norm_before_train=1.719165 cos_to_last_merge=0.9521 (last merge round=24)
[S8] round=43 local utility u=0.044934 metrics={'f1_val': 0.9941802643052118, 'auprc': 0.9881779290746378, 'loss_val': 0.04330864472263354, 'psi': 0.9917793302129821}-{'f1_val': 0.9784469650889858, 'auprc': 0.9988387373733403, 'loss_val': 0.07075935818434156, 'psi': 0.9866036740027276}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=43 head_norm_before_train=1.432178 cos_to_last_merge=1.0000 (last merge round=42)
[S9] round=43 local utility u=0.000000 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9963966144387687, 'loss_val': 0.04937087596006807, 'psi': 0.9966701970308618}-{'f1_val': 0.9971029125121428, 'auprc': 0.9957697098417704, 'loss_val': 0.038234591056252334, 'psi': 0.9965696314439938}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=43 head_norm_before_train=1.789460 cos_to_last_merge=0.9829 (last merge round=22)
[S10] round=43 local utility u=0.001735 metrics={'f1_val': 0.9940903254969471, 'auprc': 0.9957517698229774, 'loss_val': 0.031064317730922903, 'psi': 0.9947549032273593}-{'f1_val': 0.9945291067983943, 'auprc': 0.9941228610359789, 'loss_val': 0.03228000577329725, 'psi': 0.9943666084934282}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=43 head_norm_before_train=1.430626 cos_to_last_merge=0.9989 (last merge round=39)
[S11] round=43 local utility u=0.000000 metrics={'f1_val': 0.9955172569667421, 'auprc': 0.9984837089319415, 'loss_val': 0.06041317093239068, 'psi': 0.9967038377528218}-{'f1_val': 0.996305167468861, 'auprc': 0.9984029513980398, 'loss_val': 0.05066103687660515, 'psi': 0.9971442810405324}
[S13] START round=43 head_norm_before_train=1.837308 (no previous merge yet)
[S13] round=43 local utility u=0.000000 metrics={'f1_val': 0.58489771349451, 'auprc': 0.7522922810150879, 'loss_val': 0.9505937321892761, 'psi': 0.6518555405027412}-{'f1_val': 0.5960110168341635, 'auprc': 0.7753814217191288, 'loss_val': 0.8665346457936731, 'psi': 0.6677591787881496}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=43 head_norm_before_train=1.443198 cos_to_last_merge=1.0000 (last merge round=42)
[S14] round=43 local utility u=0.000000 metrics={'f1_val': 0.9965574496053289, 'auprc': 0.9980311841338082, 'loss_val': 0.06332468067702754, 'psi': 0.9971469434167206}-{'f1_val': 0.9968432356318464, 'auprc': 0.9985721020158761, 'loss_val': 0.06021816432062557, 'psi': 0.9975347821854582}
[S15] START round=43 head_norm_before_train=1.457612 cos_to_last_merge=0.9999 (last merge round=41)
[S15] round=43 local utility u=0.000000 metrics={'f1_val': 0.7025555710083098, 'auprc': 0.8571085413604956, 'loss_val': 0.5240532611114637, 'psi': 0.7643767591491841}-{'f1_val': 0.9858482851293655, 'auprc': 0.9957185076247601, 'loss_val': 0.07496575493903716, 'psi': 0.9897963741275233}
[S16] START round=43 head_norm_before_train=2.012946 (no previous merge yet)
[S16] round=43 local utility u=0.868431 metrics={'f1_val': 0.991069678885818, 'auprc': 0.988763153626829, 'loss_val': 0.04171875015018507, 'psi': 0.9901470687822224}-{'f1_val': 0.8605700279962812, 'auprc': 0.9275695739757784, 'loss_val': 0.8120020951303989, 'psi': 0.8873698463880801}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S16] sending update (kind=head size=1791 to 1 peers)
[S17] START round=43 head_norm_before_train=1.743583 cos_to_last_merge=0.7238 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.724
[S17] round=43 local utility u=0.178260 metrics={'f1_val': 0.692095750415703, 'auprc': 0.9935206031272414, 'loss_val': 0.6271047338253626, 'psi': 0.8126656915003183}-{'f1_val': 0.6547867962650042, 'auprc': 0.9280146769580427, 'loss_val': 0.5632524005661284, 'psi': 0.7640779485422196}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:62404
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1803 to 1 peers)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=43 metric=0.9955 head_norm=1.449801
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.928395e-01
[S11] stored merged vector for next round verification (round=43)
[S11] DEBUG after merge:  round=43 metric=0.9926 head_norm=1.434992 delta_norm=0.192839
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=43 metric=0.7026 head_norm=1.477308
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.915528e-02
[S15] stored merged vector for next round verification (round=43)
[S15] DEBUG after merge:  round=43 metric=0.7026 head_norm=1.461786 delta_norm=0.059155
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] RECEIVED delta(kind=head bytes=1803) from S5
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.547601)
[S4] loaded HEAD from S5 (vec_in norm=1.547601)
[S4] cosine check vs S5: cos=0.9991
[S4] BUFFERED delta from S5 (total buffered=1)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=43 metric=0.9402 head_norm=1.525009
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.366114e-02
[S4] stored merged vector for next round verification (round=43)
[S4] DEBUG after merge:  round=43 metric=0.9404 head_norm=1.535978 delta_norm=0.033661
[S4] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S6]  timeout peer S8
[S6]  timeout peer S15
[S4]  timeout peer S10
[S11]  timeout peer S9
[S15]  timeout peer S14
[S14]  timeout peer S11
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S2] START round=44 head_norm_before_train=1.948237 (no previous merge yet)
[S2] round=44 local utility u=0.000000 metrics={'f1_val': 0.830724479318076, 'auprc': 0.923134225304998, 'loss_val': 0.3481218440059038, 'psi': 0.8676883777128448}-{'f1_val': 0.8291723570884095, 'auprc': 0.9291172778181103, 'loss_val': 0.35367125894850293, 'psi': 0.8691503253802898}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=44 head_norm_before_train=2.318940 (no previous merge yet)
[S3] round=44 local utility u=0.000000 metrics={'f1_val': 0.7412310796896295, 'auprc': 0.956254940768775, 'loss_val': 0.8948400515949828, 'psi': 0.8272406241212877}-{'f1_val': 0.8332347798530106, 'auprc': 0.9973307311161894, 'loss_val': 0.5117341939426265, 'psi': 0.8988731603582821}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=44 head_norm_before_train=1.535978 cos_to_last_merge=1.0000 (last merge round=43)
[S4] round=44 local utility u=0.000000 metrics={'f1_val': 0.9395804782010314, 'auprc': 0.9554379384031162, 'loss_val': 0.2914314062319436, 'psi': 0.9459234622818653}-{'f1_val': 0.9401667793097361, 'auprc': 0.9581759349778078, 'loss_val': 0.29115610926170743, 'psi': 0.9473704415769648}
[S5] START round=44 head_norm_before_train=1.547601 cos_to_last_merge=0.9994 (last merge round=41)
[S5] round=44 local utility u=0.000000 metrics={'f1_val': 0.995671490833627, 'auprc': 0.9913255851104359, 'loss_val': 0.061540878733918114, 'psi': 0.9939331285443507}-{'f1_val': 0.996186023309311, 'auprc': 0.9968207976521732, 'loss_val': 0.05606824364895152, 'psi': 0.996439933046456}
[S6] START round=44 head_norm_before_train=1.463582 cos_to_last_merge=0.9859 (last merge round=30)
[S6] round=44 local utility u=0.000000 metrics={'f1_val': 0.544459076461511, 'auprc': 0.7472608283094724, 'loss_val': 1.0500643119012154, 'psi': 0.6255797772006956}-{'f1_val': 0.8537560044518377, 'auprc': 0.9679499966406149, 'loss_val': 0.2501870499313624, 'psi': 0.8994336013273486}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=44 head_norm_before_train=1.906947 (no previous merge yet)
[S7] round=44 local utility u=0.000000 metrics={'f1_val': 0.5974615356968582, 'auprc': 0.7903862572990685, 'loss_val': 0.7746218794944856, 'psi': 0.6746314243377424}-{'f1_val': 0.600835393879712, 'auprc': 0.7923901840212704, 'loss_val': 0.7297899042354233, 'psi': 0.6774573099363354}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=44 head_norm_before_train=1.728968 cos_to_last_merge=0.9513 (last merge round=24)
[S8] round=44 local utility u=0.010877 metrics={'f1_val': 0.992174240363445, 'auprc': 0.9990248288057482, 'loss_val': 0.04206002573027882, 'psi': 0.9949144757403663}-{'f1_val': 0.9941802643052118, 'auprc': 0.9881779290746378, 'loss_val': 0.04330864472263354, 'psi': 0.9917793302129821}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] sending update (kind=head size=1805 to 1 peers)
[S9] START round=44 head_norm_before_train=1.461718 cos_to_last_merge=0.9998 (last merge round=42)
[S9] round=44 local utility u=0.000313 metrics={'f1_val': 0.9951945592007305, 'auprc': 0.998299342748958, 'loss_val': 0.044505221883076214, 'psi': 0.9964364726200216}-{'f1_val': 0.9968525854255906, 'auprc': 0.9963966144387687, 'loss_val': 0.04937087596006807, 'psi': 0.9966701970308618}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=44 head_norm_before_train=1.798806 cos_to_last_merge=0.9822 (last merge round=22)
[S10] round=44 local utility u=0.000793 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9953332500585199, 'loss_val': 0.030854910892497683, 'psi': 0.9948507641024446}-{'f1_val': 0.9940903254969471, 'auprc': 0.9957517698229774, 'loss_val': 0.031064317730922903, 'psi': 0.9947549032273593}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=44 head_norm_before_train=1.434992 cos_to_last_merge=1.0000 (last merge round=43)
[S11] round=44 local utility u=0.004752 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9983086594835194, 'loss_val': 0.05511087208426923, 'psi': 0.9971065642747243}-{'f1_val': 0.9955172569667421, 'auprc': 0.9984837089319415, 'loss_val': 0.06041317093239068, 'psi': 0.9967038377528218}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] sending update (kind=head size=1805 to 1 peers)
[S13] START round=44 head_norm_before_train=1.844746 (no previous merge yet)
[S13] round=44 local utility u=0.000000 metrics={'f1_val': 0.5817910941960707, 'auprc': 0.7606998491311221, 'loss_val': 0.9776845302900499, 'psi': 0.6533545961700913}-{'f1_val': 0.58489771349451, 'auprc': 0.7522922810150879, 'loss_val': 0.9505937321892761, 'psi': 0.6518555405027412}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=44 head_norm_before_train=1.467149 cos_to_last_merge=0.9999 (last merge round=42)
[S14] round=44 local utility u=0.005541 metrics={'f1_val': 0.9968002980424979, 'auprc': 0.998878058372399, 'loss_val': 0.056241167622316485, 'psi': 0.9976314021744583}-{'f1_val': 0.9965574496053289, 'auprc': 0.9980311841338082, 'loss_val': 0.06332468067702754, 'psi': 0.9971469434167206}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=44 head_norm_before_train=1.461786 cos_to_last_merge=1.0000 (last merge round=43)
[S15] round=44 local utility u=1.000000 metrics={'f1_val': 0.9945798120219704, 'auprc': 0.9979350592239844, 'loss_val': 0.06670964009030213, 'psi': 0.995921910902776}-{'f1_val': 0.7025555710083098, 'auprc': 0.8571085413604956, 'loss_val': 0.5240532611114637, 'psi': 0.7643767591491841}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=44 head_norm_before_train=2.016193 (no previous merge yet)
[S16] round=44 local utility u=0.000000 metrics={'f1_val': 0.9344930942544051, 'auprc': 0.9904560129396254, 'loss_val': 0.14507824740104724, 'psi': 0.9568782617284932}-{'f1_val': 0.991069678885818, 'auprc': 0.988763153626829, 'loss_val': 0.04171875015018507, 'psi': 0.9901470687822224}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=44 head_norm_before_train=1.755371 cos_to_last_merge=0.7226 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.723
[S17] round=44 local utility u=0.055114 metrics={'f1_val': 0.7184822793333432, 'auprc': 0.9766279815748113, 'loss_val': 0.6245189207506071, 'psi': 0.8217405602299304}-{'f1_val': 0.692095750415703, 'auprc': 0.9935206031272414, 'loss_val': 0.6271047338253626, 'psi': 0.8126656915003183}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] sending update (kind=head size=1805 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=45 head_norm_before_train=1.958594 (no previous merge yet)
[S2] round=45 local utility u=0.003432 metrics={'f1_val': 0.8337909219178977, 'auprc': 0.9026625680632229, 'loss_val': 0.29824053790020505, 'psi': 0.8613395803760278}-{'f1_val': 0.830724479318076, 'auprc': 0.923134225304998, 'loss_val': 0.3481218440059038, 'psi': 0.8676883777128448}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] sending update (kind=head size=1795 to 1 peers)
[S3] START round=45 head_norm_before_train=2.327814 (no previous merge yet)
[S3] round=45 local utility u=0.826572 metrics={'f1_val': 0.8950019398676201, 'auprc': 0.9986140280966083, 'loss_val': 0.29139879482384656, 'psi': 0.9364467751592154}-{'f1_val': 0.7412310796896295, 'auprc': 0.956254940768775, 'loss_val': 0.8948400515949828, 'psi': 0.8272406241212877}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=45 head_norm_before_train=1.549237 cos_to_last_merge=0.9999 (last merge round=43)
[S4] round=45 local utility u=0.044736 metrics={'f1_val': 0.9470958429425925, 'auprc': 0.9623977220062332, 'loss_val': 0.2679303852862136, 'psi': 0.9532165945680487}-{'f1_val': 0.9395804782010314, 'auprc': 0.9554379384031162, 'loss_val': 0.2914314062319436, 'psi': 0.9459234622818653}
[S5] START round=45 head_norm_before_train=1.582280 cos_to_last_merge=0.9984 (last merge round=41)
[S5] round=45 local utility u=0.002056 metrics={'f1_val': 0.995671490833627, 'auprc': 0.9916151759253187, 'loss_val': 0.05829823601274291, 'psi': 0.9940489648703037}-{'f1_val': 0.995671490833627, 'auprc': 0.9913255851104359, 'loss_val': 0.061540878733918114, 'psi': 0.9939331285443507}
[S6] START round=45 head_norm_before_train=1.476519 cos_to_last_merge=0.9851 (last merge round=30)
[S6] round=45 local utility u=1.000000 metrics={'f1_val': 0.9316510931238339, 'auprc': 0.9613435717926165, 'loss_val': 0.20001979549220478, 'psi': 0.943528084591347}-{'f1_val': 0.544459076461511, 'auprc': 0.7472608283094724, 'loss_val': 1.0500643119012154, 'psi': 0.6255797772006956}
[S6] not sending this round → trigger blocked (psi=0.944)
[S7] START round=45 head_norm_before_train=1.913378 (no previous merge yet)
[S7] round=45 local utility u=0.714006 metrics={'f1_val': 0.7091133274593733, 'auprc': 0.864669878876318, 'loss_val': 0.23937210640949583, 'psi': 0.7713359480261511}-{'f1_val': 0.5974615356968582, 'auprc': 0.7903862572990685, 'loss_val': 0.7746218794944856, 'psi': 0.6746314243377424}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=45 head_norm_before_train=1.740371 cos_to_last_merge=0.9502 (last merge round=24)
[S8] round=45 local utility u=0.000262 metrics={'f1_val': 0.992174240363445, 'auprc': 0.9990147643031454, 'loss_val': 0.041506488953101675, 'psi': 0.9949104499393252}-{'f1_val': 0.992174240363445, 'auprc': 0.9990248288057482, 'loss_val': 0.04206002573027882, 'psi': 0.9949144757403663}
[S8] not sending this round → trigger blocked (psi=0.995)
[S9] START round=45 head_norm_before_train=1.492258 cos_to_last_merge=0.9992 (last merge round=42)
[S9] round=45 local utility u=0.004539 metrics={'f1_val': 0.9966891482978385, 'auprc': 0.9959693043132527, 'loss_val': 0.03740509158252271, 'psi': 0.9964012107040042}-{'f1_val': 0.9951945592007305, 'auprc': 0.998299342748958, 'loss_val': 0.044505221883076214, 'psi': 0.9964364726200216}
[S9] not sending this round → trigger blocked (psi=0.996)
[S10] START round=45 head_norm_before_train=1.808522 cos_to_last_merge=0.9815 (last merge round=22)
[S10] round=45 local utility u=0.000000 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.994024785658286, 'loss_val': 0.031073678962265806, 'psi': 0.994327378342351}-{'f1_val': 0.9945291067983943, 'auprc': 0.9953332500585199, 'loss_val': 0.030854910892497683, 'psi': 0.9948507641024446}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=45 head_norm_before_train=1.455332 cos_to_last_merge=0.9998 (last merge round=43)
[S11] round=45 local utility u=0.000000 metrics={'f1_val': 0.9592787274805736, 'auprc': 0.9986761346570266, 'loss_val': 0.14741001182784697, 'psi': 0.9750376903511548}-{'f1_val': 0.996305167468861, 'auprc': 0.9983086594835194, 'loss_val': 0.05511087208426923, 'psi': 0.9971065642747243}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=45 head_norm_before_train=1.848032 (no previous merge yet)
[S13] round=45 local utility u=0.152326 metrics={'f1_val': 0.6005116067526852, 'auprc': 0.7744281088203134, 'loss_val': 0.8265408775252283, 'psi': 0.6700782075797365}-{'f1_val': 0.5817910941960707, 'auprc': 0.7606998491311221, 'loss_val': 0.9776845302900499, 'psi': 0.6533545961700913}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] sending update (kind=head size=1796 to 1 peers)
[S14] START round=45 head_norm_before_train=1.490581 cos_to_last_merge=0.9995 (last merge round=42)
[S14] round=45 local utility u=0.003317 metrics={'f1_val': 0.9972539966829336, 'auprc': 0.9989635975617881, 'loss_val': 0.05258592746404477, 'psi': 0.9979378370344754}-{'f1_val': 0.9968002980424979, 'auprc': 0.998878058372399, 'loss_val': 0.056241167622316485, 'psi': 0.9976314021744583}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=45 head_norm_before_train=1.478965 cos_to_last_merge=0.9999 (last merge round=43)
[S15] round=45 local utility u=0.000000 metrics={'f1_val': 0.9723229009930809, 'auprc': 0.9964861172194937, 'loss_val': 0.0825821800533231, 'psi': 0.981988187483646}-{'f1_val': 0.9945798120219704, 'auprc': 0.9979350592239844, 'loss_val': 0.06670964009030213, 'psi': 0.995921910902776}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=45 head_norm_before_train=2.020693 (no previous merge yet)
[S16] round=45 local utility u=0.223908 metrics={'f1_val': 0.9913128954493902, 'auprc': 0.9915331307171533, 'loss_val': 0.041412986566272215, 'psi': 0.9914009895564955}-{'f1_val': 0.9344930942544051, 'auprc': 0.9904560129396254, 'loss_val': 0.14507824740104724, 'psi': 0.9568782617284932}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=45 head_norm_before_train=1.769267 cos_to_last_merge=0.7213 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.721
[S17] round=45 local utility u=0.000000 metrics={'f1_val': 0.6608587997626156, 'auprc': 0.9122028122785161, 'loss_val': 0.7757386876997382, 'psi': 0.7613964047689759}-{'f1_val': 0.7184822793333432, 'auprc': 0.9766279815748113, 'loss_val': 0.6245189207506071, 'psi': 0.8217405602299304}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:62404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:62405
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1798) from S4
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.561110)
[S5] loaded HEAD from S4 (vec_in norm=1.561110)
[S5] cosine check vs S4: cos=0.9981
[S5] BUFFERED delta from S4 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1801) from S5
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.606205)
[S4] loaded HEAD from S5 (vec_in norm=1.606205)
[S4] cosine check vs S5: cos=0.9981
[S4] BUFFERED delta from S5 (total buffered=1)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=45 metric=0.9957 head_norm=1.606205
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.387910e-02
[S5] stored merged vector for next round verification (round=45)
[S5] DEBUG after merge:  round=45 metric=0.9957 head_norm=1.582901 delta_norm=0.053879
[S5] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.025 → S4@127.0.0.1:62404
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=45 metric=0.9471 head_norm=1.561110
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.387910e-02
[S4] stored merged vector for next round verification (round=45)
[S4] DEBUG after merge:  round=45 metric=0.9476 head_norm=1.582901 delta_norm=0.053879
[S4] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.030 → S5@127.0.0.1:62405
[S2] START round=46 head_norm_before_train=1.969570 (no previous merge yet)
[S2] round=46 local utility u=0.005107 metrics={'f1_val': 0.8313008665761313, 'auprc': 0.9191096105740935, 'loss_val': 0.32242678492552573, 'psi': 0.8664243641753162}-{'f1_val': 0.8337909219178977, 'auprc': 0.9026625680632229, 'loss_val': 0.29824053790020505, 'psi': 0.8613395803760278}
[S2] not sending this round → trigger blocked (psi=0.866)
[S3] START round=46 head_norm_before_train=2.337389 (no previous merge yet)
[S3] round=46 local utility u=0.000000 metrics={'f1_val': 0.7245897742284824, 'auprc': 0.9560369037040959, 'loss_val': 0.9173385884701486, 'psi': 0.8171686260187279}-{'f1_val': 0.8950019398676201, 'auprc': 0.9986140280966083, 'loss_val': 0.29139879482384656, 'psi': 0.9364467751592154}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=46 head_norm_before_train=1.582901 cos_to_last_merge=1.0000 (last merge round=45)
[S4] round=46 local utility u=0.000000 metrics={'f1_val': 0.9409438825182601, 'auprc': 0.9614229450782477, 'loss_val': 0.28451372805534153, 'psi': 0.9491355075422552}-{'f1_val': 0.9470958429425925, 'auprc': 0.9623977220062332, 'loss_val': 0.2679303852862136, 'psi': 0.9532165945680487}
[S5] START round=46 head_norm_before_train=1.582901 cos_to_last_merge=1.0000 (last merge round=45)
[S5] round=46 local utility u=0.014022 metrics={'f1_val': 0.9958213694443535, 'auprc': 0.997093828628358, 'loss_val': 0.04758848003765392, 'psi': 0.9963303531179554}-{'f1_val': 0.995671490833627, 'auprc': 0.9916151759253187, 'loss_val': 0.05829823601274291, 'psi': 0.9940489648703037}
[S6] START round=46 head_norm_before_train=1.488108 cos_to_last_merge=0.9845 (last merge round=30)
[S6] round=46 local utility u=0.000000 metrics={'f1_val': 0.8629195559451449, 'auprc': 0.9601619769482221, 'loss_val': 0.25172893095243376, 'psi': 0.9018165243463758}-{'f1_val': 0.9316510931238339, 'auprc': 0.9613435717926165, 'loss_val': 0.20001979549220478, 'psi': 0.943528084591347}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=46 head_norm_before_train=1.921680 (no previous merge yet)
[S7] round=46 local utility u=0.000000 metrics={'f1_val': 0.6764506069128295, 'auprc': 0.8347867272883872, 'loss_val': 0.32663687484364473, 'psi': 0.7397850550630527}-{'f1_val': 0.7091133274593733, 'auprc': 0.864669878876318, 'loss_val': 0.23937210640949583, 'psi': 0.7713359480261511}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=46 head_norm_before_train=1.752017 cos_to_last_merge=0.9493 (last merge round=24)
[S8] ⚠️ Model drifted since last merge! cos=0.949
[S8] round=46 local utility u=0.000891 metrics={'f1_val': 0.992174240363445, 'auprc': 0.9990141175267528, 'loss_val': 0.03972293182994282, 'psi': 0.9949101912287681}-{'f1_val': 0.992174240363445, 'auprc': 0.9990147643031454, 'loss_val': 0.041506488953101675, 'psi': 0.9949104499393252}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] sending update (kind=head size=1804 to 1 peers)
[S9] START round=46 head_norm_before_train=1.521764 cos_to_last_merge=0.9984 (last merge round=42)
[S9] round=46 local utility u=0.005151 metrics={'f1_val': 0.9966891482978385, 'auprc': 0.9983125441059368, 'loss_val': 0.03413378398275673, 'psi': 0.9973385066210778}-{'f1_val': 0.9966891482978385, 'auprc': 0.9959693043132527, 'loss_val': 0.03740509158252271, 'psi': 0.9964012107040042}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S9] sending update (kind=head size=1790 to 1 peers)
[S10] START round=46 head_norm_before_train=1.818296 cos_to_last_merge=0.9809 (last merge round=22)
[S10] round=46 local utility u=0.002493 metrics={'f1_val': 0.9943096789853013, 'auprc': 0.9957569697830988, 'loss_val': 0.029968573106332004, 'psi': 0.9948885953044202}-{'f1_val': 0.9945291067983943, 'auprc': 0.994024785658286, 'loss_val': 0.031073678962265806, 'psi': 0.994327378342351}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=46 head_norm_before_train=1.477028 cos_to_last_merge=0.9994 (last merge round=43)
[S11] round=46 local utility u=0.161616 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9976702004825204, 'loss_val': 0.04331878124122581, 'psi': 0.9968511806743248}-{'f1_val': 0.9592787274805736, 'auprc': 0.9986761346570266, 'loss_val': 0.14741001182784697, 'psi': 0.9750376903511548}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=46 head_norm_before_train=1.843716 (no previous merge yet)
[S13] round=46 local utility u=0.000000 metrics={'f1_val': 0.5673000351908221, 'auprc': 0.7336402627999918, 'loss_val': 1.2062091808383846, 'psi': 0.63383612623449}-{'f1_val': 0.6005116067526852, 'auprc': 0.7744281088203134, 'loss_val': 0.8265408775252283, 'psi': 0.6700782075797365}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=46 head_norm_before_train=1.511524 cos_to_last_merge=0.9989 (last merge round=42)
[S14] round=46 local utility u=0.000404 metrics={'f1_val': 0.9968002980424979, 'auprc': 0.9985100786397685, 'loss_val': 0.04769558741553987, 'psi': 0.9974842102814061}-{'f1_val': 0.9972539966829336, 'auprc': 0.9989635975617881, 'loss_val': 0.05258592746404477, 'psi': 0.9979378370344754}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] sending update (kind=head size=1804 to 1 peers)
[S15] START round=46 head_norm_before_train=1.494628 cos_to_last_merge=0.9998 (last merge round=43)
[S15] round=46 local utility u=0.000000 metrics={'f1_val': 0.812557731953605, 'auprc': 0.9951673633873219, 'loss_val': 0.3328619184540627, 'psi': 0.8856015845270918}-{'f1_val': 0.9723229009930809, 'auprc': 0.9964861172194937, 'loss_val': 0.0825821800533231, 'psi': 0.981988187483646}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=46 head_norm_before_train=2.027642 (no previous merge yet)
[S16] round=46 local utility u=0.000000 metrics={'f1_val': 0.8432358876838029, 'auprc': 0.9598317152224293, 'loss_val': 1.0842981720872968, 'psi': 0.8898742186992534}-{'f1_val': 0.9913128954493902, 'auprc': 0.9915331307171533, 'loss_val': 0.041412986566272215, 'psi': 0.9914009895564955}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=46 head_norm_before_train=1.784847 cos_to_last_merge=0.7198 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.720
[S17] round=46 local utility u=0.291739 metrics={'f1_val': 0.7242336968123098, 'auprc': 0.9534802568424459, 'loss_val': 0.6963430838481803, 'psi': 0.8159323208243643}-{'f1_val': 0.6608587997626156, 'auprc': 0.9122028122785161, 'loss_val': 0.7757386876997382, 'psi': 0.7613964047689759}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.996)
[S2] START round=47 head_norm_before_train=1.980431 (no previous merge yet)
[S2] round=47 local utility u=0.000000 metrics={'f1_val': 0.8299664208543317, 'auprc': 0.9272123371631746, 'loss_val': 0.38775225638788674, 'psi': 0.8688647873778689}-{'f1_val': 0.8313008665761313, 'auprc': 0.9191096105740935, 'loss_val': 0.32242678492552573, 'psi': 0.8664243641753162}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=47 head_norm_before_train=2.346272 (no previous merge yet)
[S3] round=47 local utility u=0.342458 metrics={'f1_val': 0.7866633397079201, 'auprc': 0.9947614388148388, 'loss_val': 0.7210378042466469, 'psi': 0.8699025793506876}-{'f1_val': 0.7245897742284824, 'auprc': 0.9560369037040959, 'loss_val': 0.9173385884701486, 'psi': 0.8171686260187279}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] sending update (kind=head size=1795 to 1 peers)
[S4] START round=47 head_norm_before_train=1.592617 cos_to_last_merge=1.0000 (last merge round=45)
[S4] round=47 local utility u=0.001076 metrics={'f1_val': 0.941042702520307, 'auprc': 0.9616033598501083, 'loss_val': 0.2834967103424581, 'psi': 0.9492669654522276}-{'f1_val': 0.9409438825182601, 'auprc': 0.9614229450782477, 'loss_val': 0.28451372805534153, 'psi': 0.9491355075422552}
[S5] START round=47 head_norm_before_train=1.599812 cos_to_last_merge=0.9999 (last merge round=45)
[S5] round=47 local utility u=0.001991 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9964189274364657, 'loss_val': 0.04376878438855158, 'psi': 0.9962791849601729}-{'f1_val': 0.9958213694443535, 'auprc': 0.997093828628358, 'loss_val': 0.04758848003765392, 'psi': 0.9963303531179554}
[S6] START round=47 head_norm_before_train=1.498801 cos_to_last_merge=0.9836 (last merge round=30)
[S6] round=47 local utility u=0.359706 metrics={'f1_val': 0.9629226803102394, 'auprc': 0.9627592382220308, 'loss_val': 0.14012714791577335, 'psi': 0.9628573034749559}-{'f1_val': 0.8629195559451449, 'auprc': 0.9601619769482221, 'loss_val': 0.25172893095243376, 'psi': 0.9018165243463758}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=47 head_norm_before_train=1.929071 (no previous merge yet)
[S7] round=47 local utility u=0.000000 metrics={'f1_val': 0.6485159717090656, 'auprc': 0.802732060329447, 'loss_val': 0.5778790071845045, 'psi': 0.7102024071572182}-{'f1_val': 0.6764506069128295, 'auprc': 0.8347867272883872, 'loss_val': 0.32663687484364473, 'psi': 0.7397850550630527}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=47 head_norm_before_train=1.767007 cos_to_last_merge=0.9479 (last merge round=24)
[S8] ⚠️ Model drifted since last merge! cos=0.948
[S8] round=47 local utility u=0.000037 metrics={'f1_val': 0.992174240363445, 'auprc': 0.998816860980491, 'loss_val': 0.039057828318804604, 'psi': 0.9948312886102635}-{'f1_val': 0.992174240363445, 'auprc': 0.9990141175267528, 'loss_val': 0.03972293182994282, 'psi': 0.9949101912287681}
[S8] not sending this round → trigger blocked (psi=0.995)
[S9] START round=47 head_norm_before_train=1.548554 cos_to_last_merge=0.9975 (last merge round=42)
[S9] round=47 local utility u=0.000000 metrics={'f1_val': 0.9951945592007305, 'auprc': 0.9983186822215684, 'loss_val': 0.03366313674371347, 'psi': 0.9964442084090657}-{'f1_val': 0.9966891482978385, 'auprc': 0.9983125441059368, 'loss_val': 0.03413378398275673, 'psi': 0.9973385066210778}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=47 head_norm_before_train=1.824795 cos_to_last_merge=0.9802 (last merge round=22)
[S10] round=47 local utility u=0.000000 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.995255436901183, 'loss_val': 0.02993632329158191, 'psi': 0.9948196388395099}-{'f1_val': 0.9943096789853013, 'auprc': 0.9957569697830988, 'loss_val': 0.029968573106332004, 'psi': 0.9948885953044202}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=47 head_norm_before_train=1.497104 cos_to_last_merge=0.9987 (last merge round=43)
[S11] round=47 local utility u=0.003685 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9987678808094967, 'loss_val': 0.039242681558603866, 'psi': 0.9972902528051153}-{'f1_val': 0.996305167468861, 'auprc': 0.9976702004825204, 'loss_val': 0.04331878124122581, 'psi': 0.9968511806743248}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=47 head_norm_before_train=1.842333 (no previous merge yet)
[S13] round=47 local utility u=0.554806 metrics={'f1_val': 0.6446385655167204, 'auprc': 0.8291810879149741, 'loss_val': 0.8472515554746248, 'psi': 0.7184555744760219}-{'f1_val': 0.5673000351908221, 'auprc': 0.7336402627999918, 'loss_val': 1.2062091808383846, 'psi': 0.63383612623449}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S13] sending update (kind=head size=1793 to 1 peers)
[S14] START round=47 head_norm_before_train=1.533311 cos_to_last_merge=0.9982 (last merge round=42)
[S14] round=47 local utility u=0.002194 metrics={'f1_val': 0.9968432356318464, 'auprc': 0.9986680726405432, 'loss_val': 0.04403902108715708, 'psi': 0.9975731704353251}-{'f1_val': 0.9968002980424979, 'auprc': 0.9985100786397685, 'loss_val': 0.04769558741553987, 'psi': 0.9974842102814061}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=47 head_norm_before_train=1.511544 cos_to_last_merge=0.9995 (last merge round=43)
[S15] round=47 local utility u=0.696651 metrics={'f1_val': 0.9963324108488076, 'auprc': 0.9976135725238194, 'loss_val': 0.04954663862024913, 'psi': 0.9968448755188123}-{'f1_val': 0.812557731953605, 'auprc': 0.9951673633873219, 'loss_val': 0.3328619184540627, 'psi': 0.8856015845270918}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S15] sending update (kind=head size=1807 to 1 peers)
[S16] START round=47 head_norm_before_train=2.035567 (no previous merge yet)
[S16] round=47 local utility u=0.000000 metrics={'f1_val': 0.8254075790281047, 'auprc': 0.8361976540238817, 'loss_val': 1.306523475377853, 'psi': 0.8297236090264155}-{'f1_val': 0.8432358876838029, 'auprc': 0.9598317152224293, 'loss_val': 1.0842981720872968, 'psi': 0.8898742186992534}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=47 head_norm_before_train=1.798266 cos_to_last_merge=0.7185 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.718
[S17] round=47 local utility u=0.118796 metrics={'f1_val': 0.737016344489824, 'auprc': 0.9672590039724434, 'loss_val': 0.5767826512778701, 'psi': 0.8291134082828717}-{'f1_val': 0.7242336968123098, 'auprc': 0.9534802568424459, 'loss_val': 0.6963430838481803, 'psi': 0.8159323208243643}
[S17] not sending this round → trigger blocked (psi=0.829)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:62405
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:62404
[S5] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1799) from S4
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.602783)
[S5] loaded HEAD from S4 (vec_in norm=1.602783)
[S5] cosine check vs S4: cos=0.9996
[S5] BUFFERED delta from S4 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1800) from S5
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.620158)
[S4] loaded HEAD from S5 (vec_in norm=1.620158)
[S4] cosine check vs S5: cos=0.9996
[S4] BUFFERED delta from S5 (total buffered=1)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=47 metric=0.9410 head_norm=1.602783
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.339255e-02
[S4] stored merged vector for next round verification (round=47)
[S4] DEBUG after merge:  round=47 metric=0.9410 head_norm=1.611324 delta_norm=0.023393
[S4] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=47 metric=0.9962 head_norm=1.620158
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.339255e-02
[S5] stored merged vector for next round verification (round=47)
[S5] DEBUG after merge:  round=47 metric=0.9962 head_norm=1.611324 delta_norm=0.023393
[S5] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=48 head_norm_before_train=1.989729 (no previous merge yet)
[S2] round=48 local utility u=0.005460 metrics={'f1_val': 0.832446441409886, 'auprc': 0.9050124736109306, 'loss_val': 0.3251135575363756, 'psi': 0.8614728542903038}-{'f1_val': 0.8299664208543317, 'auprc': 0.9272123371631746, 'loss_val': 0.38775225638788674, 'psi': 0.8688647873778689}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=48 head_norm_before_train=2.353448 (no previous merge yet)
[S3] round=48 local utility u=0.810958 metrics={'f1_val': 0.9585412103933568, 'auprc': 0.9994307901881454, 'loss_val': 0.14439623556858067, 'psi': 0.9748970423112723}-{'f1_val': 0.7866633397079201, 'auprc': 0.9947614388148388, 'loss_val': 0.7210378042466469, 'psi': 0.8699025793506876}
[S3] not sending this round → trigger blocked (psi=0.975)
[S4] START round=48 head_norm_before_train=1.611324 cos_to_last_merge=1.0000 (last merge round=47)
[S4] round=48 local utility u=0.000000 metrics={'f1_val': 0.9412941625832068, 'auprc': 0.9605316904212607, 'loss_val': 0.282832937966224, 'psi': 0.9489891737184283}-{'f1_val': 0.941042702520307, 'auprc': 0.9616033598501083, 'loss_val': 0.2834967103424581, 'psi': 0.9492669654522276}
[S5] START round=48 head_norm_before_train=1.611324 cos_to_last_merge=1.0000 (last merge round=47)
[S5] round=48 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9953036401179957, 'loss_val': 0.04300548463132798, 'psi': 0.9958330700327849}-{'f1_val': 0.996186023309311, 'auprc': 0.9964189274364657, 'loss_val': 0.04376878438855158, 'psi': 0.9962791849601729}
[S6] START round=48 head_norm_before_train=1.508608 cos_to_last_merge=0.9825 (last merge round=30)
[S6] round=48 local utility u=0.000000 metrics={'f1_val': 0.7899970153832011, 'auprc': 0.881344814024719, 'loss_val': 0.5891243911472336, 'psi': 0.8265361348398083}-{'f1_val': 0.9629226803102394, 'auprc': 0.9627592382220308, 'loss_val': 0.14012714791577335, 'psi': 0.9628573034749559}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=48 head_norm_before_train=1.936157 (no previous merge yet)
[S7] round=48 local utility u=0.000000 metrics={'f1_val': 0.583313618410236, 'auprc': 0.7872194543067276, 'loss_val': 0.8538514497761807, 'psi': 0.6648759527688326}-{'f1_val': 0.6485159717090656, 'auprc': 0.802732060329447, 'loss_val': 0.5778790071845045, 'psi': 0.7102024071572182}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=48 head_norm_before_train=1.781225 cos_to_last_merge=0.9464 (last merge round=24)
[S8] ⚠️ Model drifted since last merge! cos=0.946
[S8] round=48 local utility u=0.000000 metrics={'f1_val': 0.990363285929422, 'auprc': 0.9986848152035264, 'loss_val': 0.0418082875494797, 'psi': 0.9936918976390638}-{'f1_val': 0.992174240363445, 'auprc': 0.998816860980491, 'loss_val': 0.039057828318804604, 'psi': 0.9948312886102635}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=48 head_norm_before_train=1.573948 cos_to_last_merge=0.9965 (last merge round=42)
[S9] round=48 local utility u=0.000000 metrics={'f1_val': 0.99644216417821, 'auprc': 0.9934041133154046, 'loss_val': 0.031014158170592023, 'psi': 0.9952269438330879}-{'f1_val': 0.9951945592007305, 'auprc': 0.9983186822215684, 'loss_val': 0.03366313674371347, 'psi': 0.9964442084090657}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=48 head_norm_before_train=1.831515 cos_to_last_merge=0.9794 (last merge round=22)
[S10] round=48 local utility u=0.000367 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9953859335682411, 'loss_val': 0.02959393045519132, 'psi': 0.994871837506333}-{'f1_val': 0.9945291067983943, 'auprc': 0.995255436901183, 'loss_val': 0.02993632329158191, 'psi': 0.9948196388395099}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=48 head_norm_before_train=1.517358 cos_to_last_merge=0.9978 (last merge round=43)
[S11] round=48 local utility u=0.000000 metrics={'f1_val': 0.970473909592545, 'auprc': 0.9988377385172966, 'loss_val': 0.10197414689788824, 'psi': 0.9818194411624457}-{'f1_val': 0.996305167468861, 'auprc': 0.9987678808094967, 'loss_val': 0.039242681558603866, 'psi': 0.9972902528051153}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=48 head_norm_before_train=1.842953 (no previous merge yet)
[S13] round=48 local utility u=0.077469 metrics={'f1_val': 0.6787324467988578, 'auprc': 0.8583511790992953, 'loss_val': 0.9843877149053614, 'psi': 0.7505799397190328}-{'f1_val': 0.6446385655167204, 'auprc': 0.8291810879149741, 'loss_val': 0.8472515554746248, 'psi': 0.7184555744760219}
[S13] not sending this round → trigger blocked (psi=0.751)
[S14] START round=48 head_norm_before_train=1.552366 cos_to_last_merge=0.9975 (last merge round=42)
[S14] round=48 local utility u=0.000353 metrics={'f1_val': 0.9965574496053289, 'auprc': 0.9990479560160126, 'loss_val': 0.04275747333020504, 'psi': 0.9975536521696023}-{'f1_val': 0.9968432356318464, 'auprc': 0.9986680726405432, 'loss_val': 0.04403902108715708, 'psi': 0.9975731704353251}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S14] sending update (kind=head size=1809 to 1 peers)
[S15] START round=48 head_norm_before_train=1.528911 cos_to_last_merge=0.9992 (last merge round=43)
[S15] round=48 local utility u=0.000000 metrics={'f1_val': 0.9082780262733721, 'auprc': 0.9965892612062772, 'loss_val': 0.18545342852844784, 'psi': 0.9436025202465341}-{'f1_val': 0.9963324108488076, 'auprc': 0.9976135725238194, 'loss_val': 0.04954663862024913, 'psi': 0.9968448755188123}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=48 head_norm_before_train=2.040157 (no previous merge yet)
[S16] round=48 local utility u=0.949278 metrics={'f1_val': 0.9235482421784942, 'auprc': 0.985844491302209, 'loss_val': 0.4457529600339801, 'psi': 0.9484667418279801}-{'f1_val': 0.8254075790281047, 'auprc': 0.8361976540238817, 'loss_val': 1.306523475377853, 'psi': 0.8297236090264155}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=48 head_norm_before_train=1.810481 cos_to_last_merge=0.7173 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.717
[S17] round=48 local utility u=0.000000 metrics={'f1_val': 0.6459749621602583, 'auprc': 0.9032707337104164, 'loss_val': 0.8783738148453368, 'psi': 0.7488932707803215}-{'f1_val': 0.737016344489824, 'auprc': 0.9672590039724434, 'loss_val': 0.5767826512778701, 'psi': 0.8291134082828717}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=49 head_norm_before_train=1.999655 (no previous merge yet)
[S2] round=49 local utility u=0.058769 metrics={'f1_val': 0.8224704212267009, 'auprc': 0.9910105047103961, 'loss_val': 0.4057127997808989, 'psi': 0.889886454620179}-{'f1_val': 0.832446441409886, 'auprc': 0.9050124736109306, 'loss_val': 0.3251135575363756, 'psi': 0.8614728542903038}
[S2] not sending this round → trigger blocked (psi=0.890)
[S3] START round=49 head_norm_before_train=2.359913 (no previous merge yet)
[S3] round=49 local utility u=0.000000 metrics={'f1_val': 0.9456299569865829, 'auprc': 0.9991528640988327, 'loss_val': 0.1280641883220459, 'psi': 0.9670391198314828}-{'f1_val': 0.9585412103933568, 'auprc': 0.9994307901881454, 'loss_val': 0.14439623556858067, 'psi': 0.9748970423112723}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=49 head_norm_before_train=1.622161 cos_to_last_merge=1.0000 (last merge round=47)
[S4] round=49 local utility u=0.000000 metrics={'f1_val': 0.9413967494857662, 'auprc': 0.9582876576763986, 'loss_val': 0.27844869932612076, 'psi': 0.9481531127620191}-{'f1_val': 0.9412941625832068, 'auprc': 0.9605316904212607, 'loss_val': 0.282832937966224, 'psi': 0.9489891737184283}
[S5] START round=49 head_norm_before_train=1.630361 cos_to_last_merge=0.9999 (last merge round=47)
[S5] round=49 local utility u=0.000189 metrics={'f1_val': 0.996186023309311, 'auprc': 0.994831329218204, 'loss_val': 0.04121011698934159, 'psi': 0.9956441456728682}-{'f1_val': 0.996186023309311, 'auprc': 0.9953036401179957, 'loss_val': 0.04300548463132798, 'psi': 0.9958330700327849}
[S6] START round=49 head_norm_before_train=1.519143 cos_to_last_merge=0.9817 (last merge round=30)
[S6] round=49 local utility u=0.000000 metrics={'f1_val': 0.6612817264710892, 'auprc': 0.9350686274383587, 'loss_val': 0.7590237877217872, 'psi': 0.7707964868579971}-{'f1_val': 0.7899970153832011, 'auprc': 0.881344814024719, 'loss_val': 0.5891243911472336, 'psi': 0.8265361348398083}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=49 head_norm_before_train=1.940419 (no previous merge yet)
[S7] round=49 local utility u=0.059047 metrics={'f1_val': 0.5860730422060876, 'auprc': 0.7875579427495644, 'loss_val': 0.7533301330570055, 'psi': 0.6666670024234782}-{'f1_val': 0.583313618410236, 'auprc': 0.7872194543067276, 'loss_val': 0.8538514497761807, 'psi': 0.6648759527688326}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=49 head_norm_before_train=1.791969 cos_to_last_merge=0.9455 (last merge round=24)
[S8] ⚠️ Model drifted since last merge! cos=0.945
[S8] round=49 local utility u=0.000000 metrics={'f1_val': 0.9896558900940475, 'auprc': 0.9987430047088651, 'loss_val': 0.04313970680060731, 'psi': 0.9932907359399746}-{'f1_val': 0.990363285929422, 'auprc': 0.9986848152035264, 'loss_val': 0.0418082875494797, 'psi': 0.9936918976390638}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=49 head_norm_before_train=1.593518 cos_to_last_merge=0.9956 (last merge round=42)
[S9] round=49 local utility u=0.004937 metrics={'f1_val': 0.9956098104564366, 'auprc': 0.9982834868173556, 'loss_val': 0.03078467577502826, 'psi': 0.9966792810008042}-{'f1_val': 0.99644216417821, 'auprc': 0.9934041133154046, 'loss_val': 0.031014158170592023, 'psi': 0.9952269438330879}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S9] sending update (kind=head size=1805 to 1 peers)
[S10] START round=49 head_norm_before_train=1.839477 cos_to_last_merge=0.9788 (last merge round=22)
[S10] round=49 local utility u=0.000667 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9957021518303332, 'loss_val': 0.029208849817516487, 'psi': 0.9949983248111699}-{'f1_val': 0.9945291067983943, 'auprc': 0.9953859335682411, 'loss_val': 0.02959393045519132, 'psi': 0.994871837506333}
[S10] not sending this round → trigger blocked (psi=0.995)
[S11] START round=49 head_norm_before_train=1.535864 cos_to_last_merge=0.9970 (last merge round=43)
[S11] round=49 local utility u=0.111444 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9988867926321449, 'loss_val': 0.03422059553128647, 'psi': 0.9973378175341745}-{'f1_val': 0.970473909592545, 'auprc': 0.9988377385172966, 'loss_val': 0.10197414689788824, 'psi': 0.9818194411624457}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] sending update (kind=head size=1804 to 1 peers)
[S13] START round=49 head_norm_before_train=1.846318 (no previous merge yet)
[S13] round=49 local utility u=0.000000 metrics={'f1_val': 0.5983011904510059, 'auprc': 0.8012398703892916, 'loss_val': 1.2480970263539228, 'psi': 0.6794766624263202}-{'f1_val': 0.6787324467988578, 'auprc': 0.8583511790992953, 'loss_val': 0.9843877149053614, 'psi': 0.7505799397190328}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=49 head_norm_before_train=1.570387 cos_to_last_merge=0.9969 (last merge round=42)
[S14] round=49 local utility u=0.002573 metrics={'f1_val': 0.997011210853081, 'auprc': 0.9990625615904878, 'loss_val': 0.04037806971751698, 'psi': 0.9978317511480437}-{'f1_val': 0.9965574496053289, 'auprc': 0.9990479560160126, 'loss_val': 0.04275747333020504, 'psi': 0.9975536521696023}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=49 head_norm_before_train=1.545106 cos_to_last_merge=0.9989 (last merge round=43)
[S15] round=49 local utility u=0.000000 metrics={'f1_val': 0.8846188903490796, 'auprc': 0.9957463699738905, 'loss_val': 0.2756010560716242, 'psi': 0.929069882199004}-{'f1_val': 0.9082780262733721, 'auprc': 0.9965892612062772, 'loss_val': 0.18545342852844784, 'psi': 0.9436025202465341}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=49 head_norm_before_train=2.044499 (no previous merge yet)
[S16] round=49 local utility u=0.413381 metrics={'f1_val': 0.9910941750229679, 'auprc': 0.9915806033887054, 'loss_val': 0.041474594112117395, 'psi': 0.9912887463692629}-{'f1_val': 0.9235482421784942, 'auprc': 0.985844491302209, 'loss_val': 0.4457529600339801, 'psi': 0.9484667418279801}
[S16] not sending this round → trigger blocked (psi=0.991)
[S17] START round=49 head_norm_before_train=1.821030 cos_to_last_merge=0.7162 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.716
[S17] round=49 local utility u=0.000000 metrics={'f1_val': 0.6447601303628644, 'auprc': 0.8995576718276744, 'loss_val': 0.8862741139890085, 'psi': 0.7466791469487883}-{'f1_val': 0.6459749621602583, 'auprc': 0.9032707337104164, 'loss_val': 0.8783738148453368, 'psi': 0.7488932707803215}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:62404
[S5] sending update (kind=head size=1795 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1795) from S5
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.641813)
[S4] loaded HEAD from S5 (vec_in norm=1.641813)
[S4] cosine check vs S5: cos=0.9997
[S4] BUFFERED delta from S5 (total buffered=1)
[runner] rounds complete.
[runner] all agents stopped.
