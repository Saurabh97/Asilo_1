[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:62403
[S3] → join 127.0.0.1:62402
[S4] → join 127.0.0.1:62402
[S5] → join 127.0.0.1:62402
[S6] → join 127.0.0.1:62402
[S7] → join 127.0.0.1:62402
[S8] → join 127.0.0.1:62402
[S9] → join 127.0.0.1:62402
[S10] → join 127.0.0.1:62402
[S11] → join 127.0.0.1:62402
[S13] → join 127.0.0.1:62402
[S14] → join 127.0.0.1:62402
[S15] → join 127.0.0.1:62402
[S16] → join 127.0.0.1:62402
[S17] → join 127.0.0.1:62402
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.184868 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.139061 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.171359 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.115345 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.145045 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.205775 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.125261 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.179522 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.157023 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.109074 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.099079 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.132675 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.115876 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.163143 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.186936 (no previous merge yet)
[S2]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S3] + discovered S4
[S3] + discovered S8
[S3] + discovered S15
[S3] + discovered S14
[S3] + discovered S9
[S3] + discovered S11
[S3] + discovered S17
[S3] + discovered S13
[S3] + discovered S5
[S3] + discovered S7
[S4] + discovered S2
[S4] + discovered S3
[S3] + discovered S10
[S3] + discovered S6
[S3] + discovered S16
[S5] + discovered S2
[S5] + discovered S4
[S5] + discovered S3
[S4] + discovered S10
[S4] + discovered S14
[S4] + discovered S6
[S4] + discovered S16
[S4] + discovered S8
[S4] + discovered S9
[S4] + discovered S15
[S4] + discovered S11
[S4] + discovered S17
[S4] + discovered S13
[S4] + discovered S5
[S4] + discovered S7
[S6] + discovered S3
[S6] + discovered S4
[S6] + discovered S5
[S6] + discovered S2
[S5] + discovered S17
[S5] + discovered S8
[S5] + discovered S11
[S5] + discovered S6
[S5] + discovered S14
[S5] + discovered S7
[S5] + discovered S13
[S5] + discovered S9
[S5] + discovered S15
[S5] + discovered S16
[S5] + discovered S10
[S7] + discovered S2
[S6] + discovered S10
[S6] + discovered S14
[S6] + discovered S16
[S6] + discovered S9
[S6] + discovered S15
[S6] + discovered S13
[S6] + discovered S7
[S6] + discovered S11
[S7] + discovered S4
[S6] + discovered S17
[S6] + discovered S8
[S7] + discovered S5
[S7] + discovered S6
[S7] + discovered S3
[S7] + discovered S13
[S7] + discovered S11
[S7] + discovered S15
[S8] + discovered S6
[S8] + discovered S2
[S7] + discovered S9
[S7] + discovered S17
[S7] + discovered S16
[S8] + discovered S4
[S8] + discovered S7
[S8] + discovered S5
[S8] + discovered S3
[S7] + discovered S10
[S7] + discovered S8
[S7] + discovered S14
[S8] + discovered S11
[S8] + discovered S13
[S8] + discovered S15
[S8] + discovered S17
[S8] + discovered S9
[S8] + discovered S16
[S8] + discovered S10
[S8] + discovered S14
[S9] + discovered S8
[S9] + discovered S7
[S9] + discovered S4
[S9] + discovered S2
[S9] + discovered S6
[S9] + discovered S5
[S9] + discovered S3
[S9] + discovered S14
[S10] + discovered S4
[S10] + discovered S7
[S10] + discovered S8
[S10] + discovered S3
[S9] + discovered S16
[S10] + discovered S2
[S10] + discovered S6
[S10] + discovered S5
[S9] + discovered S11
[S10] + discovered S9
[S9] + discovered S15
[S9] + discovered S17
[S9] + discovered S13
[S9] + discovered S10
[S11] + discovered S7
[S11] + discovered S2
[S11] + discovered S5
[S11] + discovered S3
[S11] + discovered S8
[S11] + discovered S9
[S10] + discovered S17
[S11] + discovered S6
[S10] + discovered S15
[S11] + discovered S4
[S10] + discovered S13
[S11] + discovered S10
[S10] + discovered S14
[S10] + discovered S11
[S10] + discovered S16
[S13] + discovered S5
[S13] + discovered S3
[S13] + discovered S9
[S13] + discovered S7
[S13] + discovered S8
[S13] + discovered S4
[S13] + discovered S11
[S13] + discovered S6
[S11] + discovered S15
[S13] + discovered S2
[S11] + discovered S17
[S11] + discovered S16
[S11] + discovered S14
[S11] + discovered S13
[S13] + discovered S10
[S13] + discovered S14
[S13] + discovered S15
[S13] + discovered S17
[S13] + discovered S16
[S14] + discovered S6
[S14] + discovered S8
[S14] + discovered S9
[S14] + discovered S11
[S14] + discovered S2
[S14] + discovered S4
[S14] + discovered S3
[S14] + discovered S13
[S14] + discovered S7
[S14] + discovered S10
[S14] + discovered S5
[S15] + discovered S5
[S15] + discovered S10
[S15] + discovered S7
[S15] + discovered S13
[S15] + discovered S4
[S15] + discovered S2
[S15] + discovered S11
[S15] + discovered S14
[S15] + discovered S3
[S15] + discovered S9
[S15] + discovered S6
[S14] + discovered S16
[S14] + discovered S17
[S15] + discovered S8
[S14] + discovered S15
[S16] + discovered S3
[S16] + discovered S15
[S16] + discovered S8
[S15] + discovered S16
[S16] + discovered S4
[S16] + discovered S11
[S16] + discovered S6
[S16] + discovered S10
[S16] + discovered S7
[S16] + discovered S14
[S16] + discovered S5
[S16] + discovered S9
[S16] + discovered S2
[S16] + discovered S13
[S15] + discovered S17
[S16] + discovered S17
[S17] + discovered S2
[S17] + discovered S16
[S17] + discovered S3
[S17] + discovered S10
[S17] + discovered S9
[S17] + discovered S15
[S17] + discovered S7
[S17] + discovered S8
[S17] + discovered S4
[S17] + discovered S11
[S17] + discovered S6
[S17] + discovered S13
[S17] + discovered S14
[S17] + discovered S5
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] ⇄ pheromone p=1.000 → S9@127.0.0.1:62410
[S13] ⇄ pheromone p=1.000 → S9@127.0.0.1:62410
[S14] ⇄ pheromone p=1.000 → S11@127.0.0.1:62412
[S11] ⇄ pheromone p=1.000 → S9@127.0.0.1:62410
[S6] ⇄ pheromone p=1.000 → S15@127.0.0.1:62415
[S7] ⇄ pheromone p=1.000 → S6@127.0.0.1:62407
[S4] ⇄ pheromone p=1.000 → S5@127.0.0.1:62405
[S15] ⇄ pheromone p=1.000 → S14@127.0.0.1:62414
[S10] ⇄ pheromone p=1.000 → S4@127.0.0.1:62404
[S2] ⇄ pheromone p=1.000 → S6@127.0.0.1:62407
[S3] ⇄ pheromone p=1.000 → S2@127.0.0.1:62402
[S9] ⇄ pheromone p=1.000 → S14@127.0.0.1:62414
[S16] ⇄ pheromone p=1.000 → S4@127.0.0.1:62404
[S8] ⇄ pheromone p=1.000 → S6@127.0.0.1:62407
[S17] ⇄ pheromone p=1.000 → S5@127.0.0.1:62405
[S2] START round=1 head_norm_before_train=1.186386 (no previous merge yet)
[S2] round=1 local utility u=0.078282 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6405979538624601, 'loss_val': 1.3035181473171817, 'psi': 0.3413054615781241}-{'f1_val': 0.14180650507561632, 'auprc': 0.59892268836013, 'loss_val': 1.3352317538045573, 'psi': 0.3246529783894218}
[S3] START round=1 head_norm_before_train=1.152059 (no previous merge yet)
[S3] round=1 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9732748794311338, 'loss_val': 1.2707404348226086, 'psi': 0.4732139911409178}-{'f1_val': 0.13984006561410703, 'auprc': 0.997489583647445, 'loss_val': 1.3389468955135575, 'psi': 0.4828998728274423}
[S4] START round=1 head_norm_before_train=1.166090 (no previous merge yet)
[S4] round=1 local utility u=0.058840 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.5641284734921407, 'loss_val': 1.3333044971158379, 'psi': 0.3097873667339668}-{'f1_val': 0.14022662889518414, 'auprc': 0.5341850919907909, 'loss_val': 1.3611550068359533, 'psi': 0.29781001413342684}
[S5] START round=1 head_norm_before_train=1.131018 (no previous merge yet)
[S5] round=1 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7765033658138745, 'loss_val': 1.2456633312319552, 'psi': 0.39595848918269266}-{'f1_val': 0.42513098490624535, 'auprc': 0.7778101673463456, 'loss_val': 1.3180134666397012, 'psi': 0.5662026578822854}
[S6] START round=1 head_norm_before_train=1.144702 (no previous merge yet)
[S6] round=1 local utility u=0.185143 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8506805121537684, 'loss_val': 1.3270944941708407, 'psi': 0.4251279740922766}-{'f1_val': 0.14142628205128205, 'auprc': 0.735675879177049, 'loss_val': 1.3523658708621646, 'psi': 0.3791261209015888}
[S7] START round=1 head_norm_before_train=1.214463 (no previous merge yet)
[S7] round=1 local utility u=0.029504 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7950366112941707, 'loss_val': 1.2788849224275436, 'psi': 0.4032487381551233}-{'f1_val': 0.14205682272909165, 'auprc': 0.7894215598576843, 'loss_val': 1.3210479241047344, 'psi': 0.4010027175805287}
[S8] START round=1 head_norm_before_train=1.131448 (no previous merge yet)
[S8] round=1 local utility u=1.000000 metrics={'f1_val': 0.4224904288344162, 'auprc': 0.762154225555409, 'loss_val': 1.3274674533224293, 'psi': 0.5583559475228133}-{'f1_val': 0.10450549450549451, 'auprc': 0.46473241571246054, 'loss_val': 1.3612261426587409, 'psi': 0.2485962629882809}
[S9] START round=1 head_norm_before_train=1.184772 (no previous merge yet)
[S9] round=1 local utility u=0.156679 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9802887323864127, 'loss_val': 1.2677787948084083, 'psi': 0.4769542672385627}-{'f1_val': 0.10457155477031801, 'auprc': 0.9780675147497706, 'loss_val': 1.3535156693625385, 'psi': 0.45396993876209907}
[S10] START round=1 head_norm_before_train=1.167325 (no previous merge yet)
[S10] round=1 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7859805987350998, 'loss_val': 1.2864031471461888, 'psi': 0.3975652220190743}-{'f1_val': 0.13862163754172394, 'auprc': 0.9720195175798082, 'loss_val': 1.3193244775022328, 'psi': 0.47198078955695766}
[S11] START round=1 head_norm_before_train=1.119973 (no previous merge yet)
[S11] round=1 local utility u=0.047453 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.5767126315464592, 'loss_val': 1.3075571573652367, 'psi': 0.31493326264245003}-{'f1_val': 0.14041368337311058, 'auprc': 0.5551993279891199, 'loss_val': 1.3379222638100696, 'psi': 0.3063279412195143}
[S13] START round=1 head_norm_before_train=1.099104 (no previous merge yet)
[S13] round=1 local utility u=1.000000 metrics={'f1_val': 0.5188099132045434, 'auprc': 0.8055770603208636, 'loss_val': 1.3319871861213701, 'psi': 0.6335167720510715}-{'f1_val': 0.10392028033289531, 'auprc': 0.8726094219326008, 'loss_val': 1.37763266188417, 'psi': 0.41139593697277754}
[S14] START round=1 head_norm_before_train=1.135197 (no previous merge yet)
[S14] round=1 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8838318880509586, 'loss_val': 1.345101056842632, 'psi': 0.4377474669500057}-{'f1_val': 0.18715738535405088, 'auprc': 0.9369212732869314, 'loss_val': 1.3721908895772255, 'psi': 0.4870629405272031}
[S15] START round=1 head_norm_before_train=1.112668 (no previous merge yet)
[S15] round=1 local utility u=0.000000 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7229295401935356, 'loss_val': 1.3294293200870846, 'psi': 0.37301200689434927}-{'f1_val': 0.4218198474858389, 'auprc': 0.6508164715407789, 'loss_val': 1.3616924636781047, 'psi': 0.5134184971078148}
[S16] START round=1 head_norm_before_train=1.173431 (no previous merge yet)
[S16] round=1 local utility u=0.456895 metrics={'f1_val': 0.2532598908999093, 'auprc': 0.7837588849455775, 'loss_val': 1.31691341288012, 'psi': 0.46545948851817665}-{'f1_val': 0.20165801456829902, 'auprc': 0.5917594026823937, 'loss_val': 1.3450937751886698, 'psi': 0.3576985698139369}
[S17] START round=1 head_norm_before_train=1.184955 (no previous merge yet)
[S17] round=1 local utility u=0.950052 metrics={'f1_val': 0.3683577275393918, 'auprc': 0.7004355283288941, 'loss_val': 1.3501121126902176, 'psi': 0.5011888478551927}-{'f1_val': 0.09754189944134078, 'auprc': 0.6193040158495668, 'loss_val': 1.381927307773118, 'psi': 0.3062467460046312}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] → sending delta(kind=head bytes=1794) to S11@127.0.0.1:62412
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S6] → sending delta(kind=head bytes=1792) to S9@127.0.0.1:62410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:62411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:62404
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S17@127.0.0.1:62417
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S2] → sending delta(kind=head bytes=1791) to S17@127.0.0.1:62417
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1784 reason=None
[S4] → sending delta(kind=head bytes=1784) to S2@127.0.0.1:62402
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S8] → sending delta(kind=head bytes=1788) to S10@127.0.0.1:62411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S7] → sending delta(kind=head bytes=1791) to S14@127.0.0.1:62414
[S6] sending update (kind=head size=1792 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1794 to 1 peers)
[S7] sending update (kind=head size=1791 to 1 peers)
[S8] sending update (kind=head size=1788 to 1 peers)
[S4] sending update (kind=head size=1784 to 1 peers)
[S11] sending update (kind=head size=1794 to 1 peers)
[S2] sending update (kind=head size=1791 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1784) from S4
[S2] cosine check vs S4: cos=0.0460
[S11] RECEIVED delta(kind=head bytes=1794) from S9
[S11] cosine check vs S9: cos=-0.0528
[S11] DROPPED delta from S9 (cos=-0.0528 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1788) from S8
[S10] cosine check vs S8: cos=-0.0137
[S10] DROPPED delta from S8 (cos=-0.0137 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1791) from S2
[S17] cosine check vs S2: cos=-0.0869
[S17] DROPPED delta from S2 (cos=-0.0869 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1792) from S6
[S9] cosine check vs S6: cos=0.0063
[S4] RECEIVED delta(kind=head bytes=1798) from S13
[S4] cosine check vs S13: cos=-0.0803
[S4] DROPPED delta from S13 (cos=-0.0803 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1791) from S7
[S14] cosine check vs S7: cos=0.0783
[S17] RECEIVED delta(kind=head bytes=1794) from S11
[S17] cosine check vs S11: cos=0.0753
[S10] RECEIVED delta(kind=head bytes=1796) from S16
[S10] cosine check vs S16: cos=0.0222
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S17] → sending delta(kind=head bytes=1791) to S16@127.0.0.1:62416
[S17] sending update (kind=head size=1791 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1791) from S17
[S16] cosine check vs S17: cos=0.0398
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=1 metric=0.1386 head_norm=1.190161
[S10] _apply_head_vector_avg (torch): Δ‖w‖=8.333694e-01
[S10] stored merged vector for next round verification (round=1)
[S10] DEBUG after merge:  round=1 metric=0.1386 head_norm=0.852076 delta_norm=0.833369
[S10] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=1 metric=0.1404 head_norm=1.147948
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.129516e-01
[S14] stored merged vector for next round verification (round=1)
[S14] DEBUG after merge:  round=1 metric=0.1404 head_norm=0.879110 delta_norm=0.812952
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=1 metric=0.2533 head_norm=1.193562
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.269850e-01
[S16] stored merged vector for next round verification (round=1)
[S16] DEBUG after merge:  round=1 metric=0.1822 head_norm=0.860613 delta_norm=0.826985
[S16] aggregate: ROLLBACK (f1_val pre=0.253 post=0.182 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=1 metric=0.1414 head_norm=1.213716
[S9] _apply_head_vector_avg (torch): Δ‖w‖=8.347403e-01
[S9] stored merged vector for next round verification (round=1)
[S9] DEBUG after merge:  round=1 metric=0.1214 head_norm=0.840018 delta_norm=0.834740
[S9] aggregate: ROLLBACK (f1_val pre=0.141 post=0.121 tol_abs=0.005 tol_rel=0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=1 metric=0.1418 head_norm=1.198712
[S2] _apply_head_vector_avg (torch): Δ‖w‖=8.188407e-01
[S2] stored merged vector for next round verification (round=1)
[S2] DEBUG after merge:  round=1 metric=0.1418 head_norm=0.857428 delta_norm=0.818841
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=1 metric=0.3684 head_norm=1.193536
[S17] _apply_head_vector_avg (torch): Δ‖w‖=7.938675e-01
[S17] stored merged vector for next round verification (round=1)
[S17] DEBUG after merge:  round=1 metric=0.1409 head_norm=0.856048 delta_norm=0.793868
[S17] aggregate: ROLLBACK (f1_val pre=0.368 post=0.141 tol_abs=0.005 tol_rel=0.0)
[S2] START round=2 head_norm_before_train=0.857428 cos_to_last_merge=1.0000 (last merge round=1)
[S2] round=2 local utility u=0.040050 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6707767172245198, 'loss_val': 1.3139542244745197, 'psi': 0.35337696692294795}-{'f1_val': 0.1417771333885667, 'auprc': 0.6405979538624601, 'loss_val': 1.3035181473171817, 'psi': 0.3413054615781241}
[S3] START round=2 head_norm_before_train=1.191242 (no previous merge yet)
[S3] round=2 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9270858249508882, 'loss_val': 1.1849861687330598, 'psi': 0.4547383693488195}-{'f1_val': 0.13984006561410703, 'auprc': 0.9732748794311338, 'loss_val': 1.2707404348226086, 'psi': 0.4732139911409178}
[S4] START round=2 head_norm_before_train=1.172371 (no previous merge yet)
[S4] round=2 local utility u=0.103156 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.6216562872594595, 'loss_val': 1.2995758017232046, 'psi': 0.3327984922408943}-{'f1_val': 0.14022662889518414, 'auprc': 0.5641284734921407, 'loss_val': 1.3333044971158379, 'psi': 0.3097873667339668}
[S5] START round=2 head_norm_before_train=1.172530 (no previous merge yet)
[S5] round=2 local utility u=0.058926 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7778082257654728, 'loss_val': 1.1317251571938531, 'psi': 0.396480433163332}-{'f1_val': 0.14226190476190476, 'auprc': 0.7765033658138745, 'loss_val': 1.2456633312319552, 'psi': 0.39595848918269266}
[S6] START round=2 head_norm_before_train=1.154009 (no previous merge yet)
[S6] round=2 local utility u=0.030977 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8608472771103846, 'loss_val': 1.295639967265232, 'psi': 0.42919468007492306}-{'f1_val': 0.14142628205128205, 'auprc': 0.8506805121537684, 'loss_val': 1.3270944941708407, 'psi': 0.4251279740922766}
[S7] START round=2 head_norm_before_train=1.244855 (no previous merge yet)
[S7] round=2 local utility u=0.025928 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7951244639169668, 'loss_val': 1.2272933598488214, 'psi': 0.40328387920424175}-{'f1_val': 0.14205682272909165, 'auprc': 0.7950366112941707, 'loss_val': 1.2788849224275436, 'psi': 0.4032487381551233}
[S8] START round=2 head_norm_before_train=1.145414 (no previous merge yet)
[S8] round=2 local utility u=0.000000 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7151492440789822, 'loss_val': 1.2901079631869128, 'psi': 0.3700332870673672}-{'f1_val': 0.4224904288344162, 'auprc': 0.762154225555409, 'loss_val': 1.3274674533224293, 'psi': 0.5583559475228133}
[S9] START round=2 head_norm_before_train=0.840018 cos_to_last_merge=1.0000 (last merge round=1)
[S9] round=2 local utility u=0.047353 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9989700380304509, 'loss_val': 1.22911590432099, 'psi': 0.484426789496178}-{'f1_val': 0.141397957139996, 'auprc': 0.9802887323864127, 'loss_val': 1.2677787948084083, 'psi': 0.4769542672385627}
[S10] START round=2 head_norm_before_train=0.852076 cos_to_last_merge=1.0000 (last merge round=1)
[S10] round=2 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7764898338382153, 'loss_val': 1.2974804837263956, 'psi': 0.3937689160603205}-{'f1_val': 0.13862163754172394, 'auprc': 0.7859805987350998, 'loss_val': 1.2864031471461888, 'psi': 0.3975652220190743}
[S11] START round=2 head_norm_before_train=1.140860 (no previous merge yet)
[S11] round=2 local utility u=0.236596 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7231742126594554, 'loss_val': 1.2737494386578876, 'psi': 0.3735178950876485}-{'f1_val': 0.14041368337311058, 'auprc': 0.5767126315464592, 'loss_val': 1.3075571573652367, 'psi': 0.31493326264245003}
[S13] START round=2 head_norm_before_train=1.110299 (no previous merge yet)
[S13] round=2 local utility u=0.000000 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.717021869744637, 'loss_val': 1.284275571030989, 'psi': 0.37104020544408667}-{'f1_val': 0.5188099132045434, 'auprc': 0.8055770603208636, 'loss_val': 1.3319871861213701, 'psi': 0.6335167720510715}
[S14] START round=2 head_norm_before_train=0.879110 cos_to_last_merge=1.0000 (last merge round=1)
[S14] round=2 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.804002675453443, 'loss_val': 1.333227305080622, 'psi': 0.40581578191099943}-{'f1_val': 0.14035785288270378, 'auprc': 0.8838318880509586, 'loss_val': 1.345101056842632, 'psi': 0.4377474669500057}
[S15] START round=2 head_norm_before_train=1.120987 (no previous merge yet)
[S15] round=2 local utility u=0.044341 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7409631271332086, 'loss_val': 1.294848930329648, 'psi': 0.38022544167021843}-{'f1_val': 0.13973365136155833, 'auprc': 0.7229295401935356, 'loss_val': 1.3294293200870846, 'psi': 0.37301200689434927}
[S16] START round=2 head_norm_before_train=0.860613 cos_to_last_merge=1.0000 (last merge round=1)
[S16] round=2 local utility u=0.282289 metrics={'f1_val': 0.4164885504472826, 'auprc': 0.648782310613726, 'loss_val': 1.3267772048183128, 'psi': 0.50940605451386}-{'f1_val': 0.2532598908999093, 'auprc': 0.7837588849455775, 'loss_val': 1.31691341288012, 'psi': 0.46545948851817665}
[S17] START round=2 head_norm_before_train=0.856048 cos_to_last_merge=1.0000 (last merge round=1)
[S17] round=2 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.7058214690115451, 'loss_val': 1.3343738077996936, 'psi': 0.36689796559504867}-{'f1_val': 0.3683577275393918, 'auprc': 0.7004355283288941, 'loss_val': 1.3501121126902176, 'psi': 0.5011888478551927}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.353)
[S9] not sending this round → trigger blocked (psi=0.484)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] → sending delta(kind=head bytes=1793) to S6@127.0.0.1:62407
[S7] not sending this round → trigger blocked (psi=0.403)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.374)
[S16] not sending this round → trigger blocked (psi=0.509)
[S4] not sending this round → trigger blocked (psi=0.333)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.429)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S15] → sending delta(kind=head bytes=1788) to S17@127.0.0.1:62417
[S5] sending update (kind=head size=1793 to 1 peers)
[S15] sending update (kind=head size=1788 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1793) from S5
[S6] cosine check vs S5: cos=-0.0663
[S6] DROPPED delta from S5 (cos=-0.0663 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1788) from S15
[S17] cosine check vs S15: cos=0.0052
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=2 metric=0.1409 head_norm=0.870009
[S17] _apply_head_vector_avg (torch): Δ‖w‖=7.164375e-01
[S17] stored merged vector for next round verification (round=2)
[S17] DEBUG after merge:  round=2 metric=0.1409 head_norm=0.720057 delta_norm=0.716438
[S17] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=3 head_norm_before_train=0.873581 cos_to_last_merge=0.9967 (last merge round=1)
[S2] round=3 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6231925873898946, 'loss_val': 1.2733456534193108, 'psi': 0.33434331498909786}-{'f1_val': 0.1417771333885667, 'auprc': 0.6707767172245198, 'loss_val': 1.3139542244745197, 'psi': 0.35337696692294795}
[S3] START round=3 head_norm_before_train=1.250650 (no previous merge yet)
[S3] round=3 local utility u=0.999212 metrics={'f1_val': 0.4082419709001655, 'auprc': 0.9980688134315538, 'loss_val': 1.0099225295702392, 'psi': 0.6441727079127209}-{'f1_val': 0.13984006561410703, 'auprc': 0.9270858249508882, 'loss_val': 1.1849861687330598, 'psi': 0.4547383693488195}
[S4] START round=3 head_norm_before_train=1.190111 (no previous merge yet)
[S4] round=3 local utility u=0.115532 metrics={'f1_val': 0.15999857260804023, 'auprc': 0.6432416261827211, 'loss_val': 1.2518988984090973, 'psi': 0.35329579403791256}-{'f1_val': 0.14022662889518414, 'auprc': 0.6216562872594595, 'loss_val': 1.2995758017232046, 'psi': 0.3327984922408943}
[S5] START round=3 head_norm_before_train=1.230215 (no previous merge yet)
[S5] round=3 local utility u=0.908149 metrics={'f1_val': 0.41795135763108626, 'auprc': 0.7776492829722074, 'loss_val': 0.9690868575667899, 'psi': 0.5618305277675347}-{'f1_val': 0.14226190476190476, 'auprc': 0.7778082257654728, 'loss_val': 1.1317251571938531, 'psi': 0.396480433163332}
[S6] START round=3 head_norm_before_train=1.173881 (no previous merge yet)
[S6] round=3 local utility u=0.011475 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8568429573142053, 'loss_val': 1.2606763032511021, 'psi': 0.4275929521564514}-{'f1_val': 0.14142628205128205, 'auprc': 0.8608472771103846, 'loss_val': 1.295639967265232, 'psi': 0.42919468007492306}
[S7] START round=3 head_norm_before_train=1.281471 (no previous merge yet)
[S7] round=3 local utility u=0.050556 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7951033514647856, 'loss_val': 1.1261178346163845, 'psi': 0.40327543422336926}-{'f1_val': 0.14205682272909165, 'auprc': 0.7951244639169668, 'loss_val': 1.2272933598488214, 'psi': 0.40328387920424175}
[S8] START round=3 head_norm_before_train=1.167740 (no previous merge yet)
[S8] round=3 local utility u=0.048022 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7322967290179565, 'loss_val': 1.2455058335766624, 'psi': 0.3768922810429569}-{'f1_val': 0.13995598239295717, 'auprc': 0.7151492440789822, 'loss_val': 1.2901079631869128, 'psi': 0.3700332870673672}
[S9] START round=3 head_norm_before_train=0.875194 cos_to_last_merge=0.9918 (last merge round=1)
[S9] round=3 local utility u=0.000000 metrics={'f1_val': 0.14739308644806237, 'auprc': 0.8613514735022572, 'loss_val': 1.0854380260650387, 'psi': 0.4329764412697403}-{'f1_val': 0.141397957139996, 'auprc': 0.9989700380304509, 'loss_val': 1.22911590432099, 'psi': 0.484426789496178}
[S10] START round=3 head_norm_before_train=0.871179 cos_to_last_merge=0.9969 (last merge round=1)
[S10] round=3 local utility u=0.023196 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7764121894621857, 'loss_val': 1.2508555062864732, 'psi': 0.39373785830990865}-{'f1_val': 0.13862163754172394, 'auprc': 0.7764898338382153, 'loss_val': 1.2974804837263956, 'psi': 0.3937689160603205}
[S11] START round=3 head_norm_before_train=1.168099 (no previous merge yet)
[S11] round=3 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.673455741714499, 'loss_val': 1.225931819015521, 'psi': 0.35363050670966595}-{'f1_val': 0.14041368337311058, 'auprc': 0.7231742126594554, 'loss_val': 1.2737494386578876, 'psi': 0.3735178950876485}
[S13] START round=3 head_norm_before_train=1.128793 (no previous merge yet)
[S13] round=3 local utility u=0.029943 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7197792458936503, 'loss_val': 1.2326619714147298, 'psi': 0.37214315590369196}-{'f1_val': 0.1403857625770531, 'auprc': 0.717021869744637, 'loss_val': 1.284275571030989, 'psi': 0.37104020544408667}
[S14] START round=3 head_norm_before_train=0.895371 cos_to_last_merge=0.9972 (last merge round=1)
[S14] round=3 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7940834642113692, 'loss_val': 1.3063598767090472, 'psi': 0.40184809741416994}-{'f1_val': 0.14035785288270378, 'auprc': 0.804002675453443, 'loss_val': 1.333227305080622, 'psi': 0.40581578191099943}
[S15] START round=3 head_norm_before_train=1.143072 (no previous merge yet)
[S15] round=3 local utility u=0.055959 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.768559572220914, 'loss_val': 1.2657208309233001, 'psi': 0.3912640197053006}-{'f1_val': 0.13973365136155833, 'auprc': 0.7409631271332086, 'loss_val': 1.294848930329648, 'psi': 0.38022544167021843}
[S16] START round=3 head_norm_before_train=0.886149 cos_to_last_merge=0.9973 (last merge round=1)
[S16] round=3 local utility u=0.080524 metrics={'f1_val': 0.4156253684185707, 'auprc': 0.6902744196372543, 'loss_val': 1.2850270819828258, 'psi': 0.5254849889060442}-{'f1_val': 0.4164885504472826, 'auprc': 0.648782310613726, 'loss_val': 1.3267772048183128, 'psi': 0.50940605451386}
[S17] START round=3 head_norm_before_train=0.720057 cos_to_last_merge=1.0000 (last merge round=2)
[S17] round=3 local utility u=0.061376 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.7479656566119322, 'loss_val': 1.3380548573834439, 'psi': 0.3837556406352035}-{'f1_val': 0.14094896331738438, 'auprc': 0.7058214690115451, 'loss_val': 1.3343738077996936, 'psi': 0.36689796559504867}
[S5] not sending this round → trigger blocked (psi=0.562)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] → sending delta(kind=head bytes=1794) to S2@127.0.0.1:62402
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:62407
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.391)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:62410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] → sending delta(kind=head bytes=1793) to S4@127.0.0.1:62404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:62415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:62405
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S8] → sending delta(kind=head bytes=1792) to S6@127.0.0.1:62407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:62404
[S6] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1792 to 1 peers)
[S16] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1793 to 1 peers)
[S10] sending update (kind=head size=1793 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1794 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1792) from S8
[S6] cosine check vs S8: cos=0.0236
[S6] RECEIVED delta(kind=head bytes=1800) from S7
[S6] cosine check vs S7: cos=0.0120
[S4] RECEIVED delta(kind=head bytes=1802) from S16
[S4] cosine check vs S16: cos=0.0037
[S4] RECEIVED delta(kind=head bytes=1793) from S10
[S4] cosine check vs S10: cos=0.0693
[S9] RECEIVED delta(kind=head bytes=1799) from S13
[S9] cosine check vs S13: cos=-0.1533
[S9] DROPPED delta from S13 (cos=-0.1533 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1794) from S3
[S2] cosine check vs S3: cos=0.0680
[S5] RECEIVED delta(kind=head bytes=1793) from S4
[S5] cosine check vs S4: cos=-0.0411
[S5] DROPPED delta from S4 (cos=-0.0411 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1796) from S6
[S15] cosine check vs S6: cos=0.0299
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:62405
[S17] sending update (kind=head size=1793 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1793) from S17
[S5] cosine check vs S17: cos=0.0058
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=3 metric=0.1418 head_norm=0.898169
[S2] _apply_head_vector_avg (torch): Δ‖w‖=7.649788e-01
[S2] stored merged vector for next round verification (round=3)
[S2] DEBUG after merge:  round=3 metric=0.1418 head_norm=0.815265 delta_norm=0.764979
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=3 metric=0.4180 head_norm=1.277107
[S5] _apply_head_vector_avg (torch): Δ‖w‖=7.354268e-01
[S5] stored merged vector for next round verification (round=3)
[S5] DEBUG after merge:  round=3 metric=0.4191 head_norm=0.739141 delta_norm=0.735427
[S5] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=3 metric=0.1414 head_norm=1.199871
[S6] _apply_head_vector_avg (torch): Δ‖w‖=7.372704e-01
[S6] stored merged vector for next round verification (round=3)
[S6] DEBUG after merge:  round=3 metric=0.1414 head_norm=0.755031 delta_norm=0.737270
[S6] aggregate: ACCEPT kept=['S8', 'S7'] (k=2/2) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=3 metric=0.1600 head_norm=1.219450
[S4] _apply_head_vector_avg (torch): Δ‖w‖=7.088911e-01
[S4] stored merged vector for next round verification (round=3)
[S4] DEBUG after merge:  round=3 metric=0.3790 head_norm=0.736644 delta_norm=0.708891
[S4] aggregate: ACCEPT kept=['S16', 'S10'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=3 metric=0.1397 head_norm=1.168481
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.248200e-01
[S15] stored merged vector for next round verification (round=3)
[S15] DEBUG after merge:  round=3 metric=0.1397 head_norm=0.849819 delta_norm=0.824820
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=0.815265 cos_to_last_merge=1.0000 (last merge round=3)
[S2] round=4 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6091996419977072, 'loss_val': 1.2664172563437883, 'psi': 0.3287461368322229}-{'f1_val': 0.1417771333885667, 'auprc': 0.6231925873898946, 'loss_val': 1.2733456534193108, 'psi': 0.33434331498909786}
[S3] START round=4 head_norm_before_train=1.301150 (no previous merge yet)
[S3] round=4 local utility u=0.983636 metrics={'f1_val': 0.6927431640931401, 'auprc': 0.9981086006624973, 'loss_val': 0.7497769564474452, 'psi': 0.8148893387208829}-{'f1_val': 0.4082419709001655, 'auprc': 0.9980688134315538, 'loss_val': 1.0099225295702392, 'psi': 0.6441727079127209}
[S4] START round=4 head_norm_before_train=0.736644 cos_to_last_merge=1.0000 (last merge round=3)
[S4] round=4 local utility u=0.675823 metrics={'f1_val': 0.3210441413780901, 'auprc': 0.7690818988735975, 'loss_val': 1.2440470998772368, 'psi': 0.5002592443762931}-{'f1_val': 0.15999857260804023, 'auprc': 0.6432416261827211, 'loss_val': 1.2518988984090973, 'psi': 0.35329579403791256}
[S5] START round=4 head_norm_before_train=0.739141 cos_to_last_merge=1.0000 (last merge round=3)
[S5] round=4 local utility u=0.008948 metrics={'f1_val': 0.4180739549898101, 'auprc': 0.7773723508517836, 'loss_val': 0.9510966409542757, 'psi': 0.5617933133345996}-{'f1_val': 0.41795135763108626, 'auprc': 0.7776492829722074, 'loss_val': 0.9690868575667899, 'psi': 0.5618305277675347}
[S6] START round=4 head_norm_before_train=0.755031 cos_to_last_merge=1.0000 (last merge round=3)
[S6] round=4 local utility u=0.004566 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8654288574473736, 'loss_val': 1.2773018061015078, 'psi': 0.4310273122097187}-{'f1_val': 0.14142628205128205, 'auprc': 0.8568429573142053, 'loss_val': 1.2606763032511021, 'psi': 0.4275929521564514}
[S7] START round=4 head_norm_before_train=1.318655 (no previous merge yet)
[S7] round=4 local utility u=1.000000 metrics={'f1_val': 0.5752082153445836, 'auprc': 0.7947010929330129, 'loss_val': 0.8674515356571071, 'psi': 0.6630053663799553}-{'f1_val': 0.14205682272909165, 'auprc': 0.7951033514647856, 'loss_val': 1.1261178346163845, 'psi': 0.40327543422336926}
[S8] START round=4 head_norm_before_train=1.197967 (no previous merge yet)
[S8] round=4 local utility u=0.249835 metrics={'f1_val': 0.1985206162042823, 'auprc': 0.7661094967702089, 'loss_val': 1.198661655658147, 'psi': 0.42555616843065297}-{'f1_val': 0.13995598239295717, 'auprc': 0.7322967290179565, 'loss_val': 1.2455058335766624, 'psi': 0.3768922810429569}
[S9] START round=4 head_norm_before_train=0.934376 cos_to_last_merge=0.9731 (last merge round=1)
[S9] round=4 local utility u=0.955029 metrics={'f1_val': 0.41685270450404177, 'auprc': 0.8662527614143126, 'loss_val': 0.8068409957740583, 'psi': 0.5966127272681501}-{'f1_val': 0.14739308644806237, 'auprc': 0.8613514735022572, 'loss_val': 1.0854380260650387, 'psi': 0.4329764412697403}
[S10] START round=4 head_norm_before_train=0.899876 cos_to_last_merge=0.9886 (last merge round=1)
[S10] round=4 local utility u=0.019036 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7763777595765504, 'loss_val': 1.2126798450966019, 'psi': 0.39372408635565453}-{'f1_val': 0.13862163754172394, 'auprc': 0.7764121894621857, 'loss_val': 1.2508555062864732, 'psi': 0.39373785830990865}
[S11] START round=4 head_norm_before_train=1.204927 (no previous merge yet)
[S11] round=4 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.5977453556011112, 'loss_val': 1.159656628771881, 'psi': 0.32334635226431085}-{'f1_val': 0.14041368337311058, 'auprc': 0.673455741714499, 'loss_val': 1.225931819015521, 'psi': 0.35363050670966595}
[S13] START round=4 head_norm_before_train=1.151933 (no previous merge yet)
[S13] round=4 local utility u=0.029533 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7224249701335211, 'loss_val': 1.1815322419173848, 'psi': 0.3732014455996403}-{'f1_val': 0.1403857625770531, 'auprc': 0.7197792458936503, 'loss_val': 1.2326619714147298, 'psi': 0.37214315590369196}
[S14] START round=4 head_norm_before_train=0.921862 cos_to_last_merge=0.9893 (last merge round=1)
[S14] round=4 local utility u=0.006701 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7841314507170722, 'loss_val': 1.2631027972206832, 'psi': 0.39786729201645116}-{'f1_val': 0.14035785288270378, 'auprc': 0.7940834642113692, 'loss_val': 1.3063598767090472, 'psi': 0.40184809741416994}
[S15] START round=4 head_norm_before_train=0.849819 cos_to_last_merge=1.0000 (last merge round=3)
[S15] round=4 local utility u=0.005873 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7744317477878502, 'loss_val': 1.271592004510859, 'psi': 0.3936128899320751}-{'f1_val': 0.13973365136155833, 'auprc': 0.768559572220914, 'loss_val': 1.2657208309233001, 'psi': 0.3912640197053006}
[S16] START round=4 head_norm_before_train=0.918442 cos_to_last_merge=0.9899 (last merge round=1)
[S16] round=4 local utility u=0.077416 metrics={'f1_val': 0.4138892987575528, 'auprc': 0.722777891684991, 'loss_val': 1.2172882818083868, 'psi': 0.537444735928528}-{'f1_val': 0.4156253684185707, 'auprc': 0.6902744196372543, 'loss_val': 1.2850270819828258, 'psi': 0.5254849889060442}
[S17] START round=4 head_norm_before_train=0.737131 cos_to_last_merge=0.9962 (last merge round=2)
[S17] round=4 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5610161525022664, 'loss_val': 1.2969695297173256, 'psi': 0.3089758389913372}-{'f1_val': 0.14094896331738438, 'auprc': 0.7479656566119322, 'loss_val': 1.3380548573834439, 'psi': 0.3837556406352035}
[S13] not sending this round → trigger blocked (psi=0.373)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:62412
[S16] not sending this round → trigger blocked (psi=0.537)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.394)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:62410
[S8] not sending this round → trigger blocked (psi=0.426)
[S7] not sending this round → trigger blocked (psi=0.663)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:62414
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:62414
[S3] not sending this round → trigger blocked (psi=0.815)
[S4] not sending this round → trigger blocked (psi=0.500)
[S6] not sending this round → trigger blocked (psi=0.431)
[S15] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1800) from S14
[S11] cosine check vs S14: cos=0.0777
[S9] RECEIVED delta(kind=head bytes=1796) from S5
[S9] cosine check vs S5: cos=-0.1207
[S9] DROPPED delta from S5 (cos=-0.1207 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1795) from S9
[S14] cosine check vs S9: cos=0.0437
[S14] RECEIVED delta(kind=head bytes=1802) from S15
[S14] cosine check vs S15: cos=-0.0876
[S14] DROPPED delta from S15 (cos=-0.0876 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=4 metric=0.1404 head_norm=1.242209
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.541245e-01
[S11] stored merged vector for next round verification (round=4)
[S11] DEBUG after merge:  round=4 metric=0.1404 head_norm=0.813122 delta_norm=0.754124
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=4 metric=0.1404 head_norm=0.957422
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.754324e-01
[S14] stored merged vector for next round verification (round=4)
[S14] DEBUG after merge:  round=4 metric=0.1404 head_norm=0.705620 delta_norm=0.675432
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=5 head_norm_before_train=0.837259 cos_to_last_merge=0.9963 (last merge round=3)
[S2] round=5 local utility u=0.022294 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6091164873920201, 'loss_val': 1.221580788115289, 'psi': 0.32871287498994806}-{'f1_val': 0.1417771333885667, 'auprc': 0.6091996419977072, 'loss_val': 1.2664172563437883, 'psi': 0.3287461368322229}
[S3] START round=5 head_norm_before_train=1.375557 (no previous merge yet)
[S3] round=5 local utility u=0.000000 metrics={'f1_val': 0.640558995196826, 'auprc': 0.9930440511395737, 'loss_val': 0.5656269631296337, 'psi': 0.7815530175739251}-{'f1_val': 0.6927431640931401, 'auprc': 0.9981086006624973, 'loss_val': 0.7497769564474452, 'psi': 0.8148893387208829}
[S4] START round=5 head_norm_before_train=0.773550 cos_to_last_merge=0.9960 (last merge round=3)
[S4] round=5 local utility u=0.332980 metrics={'f1_val': 0.41419477691946305, 'auprc': 0.7675936222189033, 'loss_val': 1.1325260521154223, 'psi': 0.5555543150392391}-{'f1_val': 0.3210441413780901, 'auprc': 0.7690818988735975, 'loss_val': 1.2440470998772368, 'psi': 0.5002592443762931}
[S5] START round=5 head_norm_before_train=0.812813 cos_to_last_merge=0.9896 (last merge round=3)
[S5] round=5 local utility u=0.119612 metrics={'f1_val': 0.41770670426636225, 'auprc': 0.8045599853349135, 'loss_val': 0.7912317919102259, 'psi': 0.5724480166937828}-{'f1_val': 0.4180739549898101, 'auprc': 0.7773723508517836, 'loss_val': 0.9510966409542757, 'psi': 0.5617933133345996}
[S6] START round=5 head_norm_before_train=0.776051 cos_to_last_merge=0.9972 (last merge round=3)
[S6] round=5 local utility u=0.003698 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8541675922428791, 'loss_val': 1.2361211779677859, 'psi': 0.4265228061279209}-{'f1_val': 0.14142628205128205, 'auprc': 0.8654288574473736, 'loss_val': 1.2773018061015078, 'psi': 0.4310273122097187}
[S7] START round=5 head_norm_before_train=1.378601 (no previous merge yet)
[S7] round=5 local utility u=0.385712 metrics={'f1_val': 0.6862168427450158, 'auprc': 0.7917792095094452, 'loss_val': 0.7533136203167052, 'psi': 0.7284417894507875}-{'f1_val': 0.5752082153445836, 'auprc': 0.7947010929330129, 'loss_val': 0.8674515356571071, 'psi': 0.6630053663799553}
[S8] START round=5 head_norm_before_train=1.227726 (no previous merge yet)
[S8] round=5 local utility u=0.638044 metrics={'f1_val': 0.39751339716757456, 'auprc': 0.7663728636193048, 'loss_val': 1.1173200276378203, 'psi': 0.5450571837482667}-{'f1_val': 0.1985206162042823, 'auprc': 0.7661094967702089, 'loss_val': 1.198661655658147, 'psi': 0.42555616843065297}
[S9] START round=5 head_norm_before_train=0.995770 cos_to_last_merge=0.9537 (last merge round=1)
[S9] round=5 local utility u=1.000000 metrics={'f1_val': 0.6637344480180936, 'auprc': 0.9991712254201841, 'loss_val': 0.5635986451323648, 'psi': 0.7979091589789298}-{'f1_val': 0.41685270450404177, 'auprc': 0.8662527614143126, 'loss_val': 0.8068409957740583, 'psi': 0.5966127272681501}
[S10] START round=5 head_norm_before_train=0.933351 cos_to_last_merge=0.9780 (last merge round=1)
[S10] round=5 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.650418089808367, 'loss_val': 1.1406147646246831, 'psi': 0.3433402184483812}-{'f1_val': 0.13862163754172394, 'auprc': 0.7763777595765504, 'loss_val': 1.2126798450966019, 'psi': 0.39372408635565453}
[S11] START round=5 head_norm_before_train=0.813122 cos_to_last_merge=1.0000 (last merge round=4)
[S11] round=5 local utility u=0.010303 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.5962053468033572, 'loss_val': 1.1344302252459952, 'psi': 0.32273034874520923}-{'f1_val': 0.14041368337311058, 'auprc': 0.5977453556011112, 'loss_val': 1.159656628771881, 'psi': 0.32334635226431085}
[S13] START round=5 head_norm_before_train=1.171805 (no previous merge yet)
[S13] round=5 local utility u=0.871501 metrics={'f1_val': 0.4158809972763461, 'auprc': 0.7275533891717514, 'loss_val': 1.106886561239742, 'psi': 0.5405499540345082}-{'f1_val': 0.1403857625770531, 'auprc': 0.7224249701335211, 'loss_val': 1.1815322419173848, 'psi': 0.3732014455996403}
[S14] START round=5 head_norm_before_train=0.705620 cos_to_last_merge=1.0000 (last merge round=4)
[S14] round=5 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.720430269242339, 'loss_val': 1.247156593814527, 'psi': 0.3723868194265579}-{'f1_val': 0.14035785288270378, 'auprc': 0.7841314507170722, 'loss_val': 1.2631027972206832, 'psi': 0.39786729201645116}
[S15] START round=5 head_norm_before_train=0.875344 cos_to_last_merge=0.9982 (last merge round=3)
[S15] round=5 local utility u=0.022164 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.776736177921658, 'loss_val': 1.2341781623116732, 'psi': 0.3945346619855982}-{'f1_val': 0.13973365136155833, 'auprc': 0.7744317477878502, 'loss_val': 1.271592004510859, 'psi': 0.3936128899320751}
[S16] START round=5 head_norm_before_train=0.956003 cos_to_last_merge=0.9797 (last merge round=1)
[S16] round=5 local utility u=0.048922 metrics={'f1_val': 0.41722699281147574, 'auprc': 0.7120046294254601, 'loss_val': 1.107151554118845, 'psi': 0.5351380474570695}-{'f1_val': 0.4138892987575528, 'auprc': 0.722777891684991, 'loss_val': 1.2172882818083868, 'psi': 0.537444735928528}
[S17] START round=5 head_norm_before_train=0.766212 cos_to_last_merge=0.9840 (last merge round=2)
[S17] round=5 local utility u=0.019196 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5572587158175011, 'loss_val': 1.2473043544876639, 'psi': 0.30747286431743104}-{'f1_val': 0.14094896331738438, 'auprc': 0.5610161525022664, 'loss_val': 1.2969695297173256, 'psi': 0.3089758389913372}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S2] → sending delta(kind=head bytes=1788) to S6@127.0.0.1:62407
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:62405
[S5] not sending this round → trigger blocked (psi=0.572)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:62415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:62407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:62407
[S9] not sending this round → trigger blocked (psi=0.798)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:62410
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:62410
[S15] not sending this round → trigger blocked (psi=0.395)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:62404
[S13] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1803 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1788 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1800) from S8
[S6] cosine check vs S8: cos=0.3924
[S6] RECEIVED delta(kind=head bytes=1798) from S7
[S6] cosine check vs S7: cos=0.3987
[S5] RECEIVED delta(kind=head bytes=1797) from S4
[S5] cosine check vs S4: cos=0.0613
[S15] RECEIVED delta(kind=head bytes=1800) from S6
[S15] cosine check vs S6: cos=0.5688
[S6] RECEIVED delta(kind=head bytes=1788) from S2
[S6] cosine check vs S2: cos=0.0758
[S4] RECEIVED delta(kind=head bytes=1803) from S16
[S4] cosine check vs S16: cos=0.4176
[S9] RECEIVED delta(kind=head bytes=1800) from S13
[S9] cosine check vs S13: cos=-0.1457
[S9] DROPPED delta from S13 (cos=-0.1457 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1799) from S11
[S9] cosine check vs S11: cos=-0.0231
[S9] DROPPED delta from S11 (cos=-0.0231 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:62405
[S17] sending update (kind=head size=1795 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1795) from S17
[S5] cosine check vs S17: cos=0.4266
[S10] ⇄ pheromone p=0.334 → S4@127.0.0.1:62404
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=5 metric=0.4177 head_norm=0.883135
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.511950e-01
[S5] stored merged vector for next round verification (round=5)
[S5] DEBUG after merge:  round=5 metric=0.4177 head_norm=0.614214 delta_norm=0.451195
[S5] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.475 → S9@127.0.0.1:62410
[S3] ⇄ pheromone p=0.613 → S2@127.0.0.1:62402
[S9] ⇄ pheromone p=0.698 → S14@127.0.0.1:62414
[S14] ⇄ pheromone p=0.329 → S11@127.0.0.1:62412
[S11] ⇄ pheromone p=0.358 → S9@127.0.0.1:62410
[S13] ⇄ pheromone p=0.592 → S9@127.0.0.1:62410
[S2] ⇄ pheromone p=0.343 → S6@127.0.0.1:62407
[S8] ⇄ pheromone p=0.583 → S6@127.0.0.1:62407
[S16] ⇄ pheromone p=0.426 → S4@127.0.0.1:62404
[S6] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=5 metric=0.1414 head_norm=0.802871
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.869840e-01
[S6] stored merged vector for next round verification (round=5)
[S6] DEBUG after merge:  round=5 metric=0.1414 head_norm=0.636275 delta_norm=0.386984
[S6] aggregate: ACCEPT kept=['S8', 'S7', 'S2'] (k=3/3) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.349 → S15@127.0.0.1:62415
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=5 metric=0.4142 head_norm=0.820782
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.970794e-01
[S4] stored merged vector for next round verification (round=5)
[S4] DEBUG after merge:  round=5 metric=0.4130 head_norm=0.768011 delta_norm=0.497079
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.533 → S5@127.0.0.1:62405
[S7] ⇄ pheromone p=0.576 → S6@127.0.0.1:62407
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=5 metric=0.1397 head_norm=0.905291
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.991488e-01
[S15] stored merged vector for next round verification (round=5)
[S15] DEBUG after merge:  round=5 metric=0.1397 head_norm=0.756807 delta_norm=0.399149
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.345 → S14@127.0.0.1:62414
[S17] ⇄ pheromone p=0.417 → S5@127.0.0.1:62405
[S2] START round=6 head_norm_before_train=0.866787 cos_to_last_merge=0.9860 (last merge round=3)
[S2] round=6 local utility u=0.188804 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7101363761399195, 'loss_val': 1.1470324329821442, 'psi': 0.3691208304891079}-{'f1_val': 0.1417771333885667, 'auprc': 0.6091164873920201, 'loss_val': 1.221580788115289, 'psi': 0.32871287498994806}
[S3] START round=6 head_norm_before_train=1.458022 (no previous merge yet)
[S3] round=6 local utility u=0.291040 metrics={'f1_val': 0.7004261945879899, 'auprc': 0.9962883626837863, 'loss_val': 0.35248297252605815, 'psi': 0.8187710618263084}-{'f1_val': 0.640558995196826, 'auprc': 0.9930440511395737, 'loss_val': 0.5656269631296337, 'psi': 0.7815530175739251}
[S4] START round=6 head_norm_before_train=0.768011 cos_to_last_merge=1.0000 (last merge round=5)
[S4] round=6 local utility u=0.000000 metrics={'f1_val': 0.36924155613472665, 'auprc': 0.7629410431672587, 'loss_val': 1.0608699007530495, 'psi': 0.5267213509477395}-{'f1_val': 0.41419477691946305, 'auprc': 0.7675936222189033, 'loss_val': 1.1325260521154223, 'psi': 0.5555543150392391}
[S5] START round=6 head_norm_before_train=0.614214 cos_to_last_merge=1.0000 (last merge round=5)
[S5] round=6 local utility u=0.315772 metrics={'f1_val': 0.42623421108970244, 'auprc': 0.9978582201691542, 'loss_val': 0.7907484449561537, 'psi': 0.6548838147214832}-{'f1_val': 0.41770670426636225, 'auprc': 0.8045599853349135, 'loss_val': 0.7912317919102259, 'psi': 0.5724480166937828}
[S6] START round=6 head_norm_before_train=0.636275 cos_to_last_merge=1.0000 (last merge round=5)
[S6] round=6 local utility u=0.005358 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8522219461377475, 'loss_val': 1.2195677539736076, 'psi': 0.4257445476858682}-{'f1_val': 0.14142628205128205, 'auprc': 0.8541675922428791, 'loss_val': 1.2361211779677859, 'psi': 0.4265228061279209}
[S7] START round=6 head_norm_before_train=1.435500 (no previous merge yet)
[S7] round=6 local utility u=0.000000 metrics={'f1_val': 0.5616017379006499, 'auprc': 0.7872452682008027, 'loss_val': 0.7345335109425621, 'psi': 0.651859150020711}-{'f1_val': 0.6862168427450158, 'auprc': 0.7917792095094452, 'loss_val': 0.7533136203167052, 'psi': 0.7284417894507875}
[S8] START round=6 head_norm_before_train=1.254446 (no previous merge yet)
[S8] round=6 local utility u=0.016294 metrics={'f1_val': 0.3728657005221765, 'auprc': 0.7792129296511475, 'loss_val': 0.975366450783119, 'psi': 0.5354045921737649}-{'f1_val': 0.39751339716757456, 'auprc': 0.7663728636193048, 'loss_val': 1.1173200276378203, 'psi': 0.5450571837482667}
[S9] START round=6 head_norm_before_train=1.080013 cos_to_last_merge=0.9253 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.925
[S9] round=6 local utility u=0.202105 metrics={'f1_val': 0.7012182915391405, 'auprc': 0.9986143481048914, 'loss_val': 0.38262070828687816, 'psi': 0.8201767141654408}-{'f1_val': 0.6637344480180936, 'auprc': 0.9991712254201841, 'loss_val': 0.5635986451323648, 'psi': 0.7979091589789298}
[S10] START round=6 head_norm_before_train=0.962496 cos_to_last_merge=0.9688 (last merge round=1)
[S10] round=6 local utility u=0.907183 metrics={'f1_val': 0.41634224672860876, 'auprc': 0.6573994488999696, 'loss_val': 1.0135165357322662, 'psi': 0.5127651275971531}-{'f1_val': 0.13862163754172394, 'auprc': 0.650418089808367, 'loss_val': 1.1406147646246831, 'psi': 0.3433402184483812}
[S11] START round=6 head_norm_before_train=0.849123 cos_to_last_merge=0.9972 (last merge round=4)
[S11] round=6 local utility u=1.000000 metrics={'f1_val': 0.4152176962830677, 'auprc': 0.6664195732522193, 'loss_val': 0.9715052753364208, 'psi': 0.5156984470707283}-{'f1_val': 0.14041368337311058, 'auprc': 0.5962053468033572, 'loss_val': 1.1344302252459952, 'psi': 0.32273034874520923}
[S13] START round=6 head_norm_before_train=1.194250 (no previous merge yet)
[S13] round=6 local utility u=0.052079 metrics={'f1_val': 0.4162370592043806, 'auprc': 0.7287641591364055, 'loss_val': 1.0084974118059222, 'psi': 0.5412478991771905}-{'f1_val': 0.4158809972763461, 'auprc': 0.7275533891717514, 'loss_val': 1.106886561239742, 'psi': 0.5405499540345082}
[S14] START round=6 head_norm_before_train=0.742580 cos_to_last_merge=0.9961 (last merge round=4)
[S14] round=6 local utility u=0.089516 metrics={'f1_val': 0.15024473292189827, 'auprc': 0.7211149456493605, 'loss_val': 1.1294995219579744, 'psi': 0.3785928180128832}-{'f1_val': 0.14035785288270378, 'auprc': 0.720430269242339, 'loss_val': 1.247156593814527, 'psi': 0.3723868194265579}
[S15] START round=6 head_norm_before_train=0.756807 cos_to_last_merge=1.0000 (last merge round=5)
[S15] round=6 local utility u=0.004769 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7769243852894573, 'loss_val': 1.2252050561171985, 'psi': 0.39460994493271795}-{'f1_val': 0.13973365136155833, 'auprc': 0.776736177921658, 'loss_val': 1.2341781623116732, 'psi': 0.3945346619855982}
[S16] START round=6 head_norm_before_train=1.000087 cos_to_last_merge=0.9667 (last merge round=1)
[S16] round=6 local utility u=0.095880 metrics={'f1_val': 0.4171583814486223, 'auprc': 0.7359682264183115, 'loss_val': 0.9868712624384918, 'psi': 0.544682319436498}-{'f1_val': 0.41722699281147574, 'auprc': 0.7120046294254601, 'loss_val': 1.107151554118845, 'psi': 0.5351380474570695}
[S17] START round=6 head_norm_before_train=0.804217 cos_to_last_merge=0.9656 (last merge round=2)
[S17] round=6 local utility u=0.044879 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5595601133833006, 'loss_val': 1.1644499865954714, 'psi': 0.30839342334375086}-{'f1_val': 0.14094896331738438, 'auprc': 0.5572587158175011, 'loss_val': 1.2473043544876639, 'psi': 0.30747286431743104}
[S6] not sending this round → trigger blocked (psi=0.426)
[S13] not sending this round → trigger blocked (psi=0.541)
[S2] not sending this round → trigger blocked (psi=0.369)
[S11] not sending this round → trigger blocked (psi=0.516)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] → sending delta(kind=head bytes=1794) to S11@127.0.0.1:62412
[S8] not sending this round → trigger blocked (psi=0.535)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:62402
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:62410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:62414
[S16] not sending this round → trigger blocked (psi=0.545)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:62404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:62414
[S10] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1794 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1794) from S14
[S11] cosine check vs S14: cos=0.4093
[S9] RECEIVED delta(kind=head bytes=1798) from S5
[S9] cosine check vs S5: cos=-0.1023
[S9] DROPPED delta from S5 (cos=-0.1023 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1798) from S10
[S4] cosine check vs S10: cos=0.4895
[S14] RECEIVED delta(kind=head bytes=1799) from S15
[S14] cosine check vs S15: cos=0.3378
[S14] RECEIVED delta(kind=head bytes=1800) from S9
[S14] cosine check vs S9: cos=0.6744
[S2] RECEIVED delta(kind=head bytes=1799) from S3
[S2] cosine check vs S3: cos=0.7573
[S17] not sending this round → trigger blocked (psi=0.308)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=6 metric=0.1418 head_norm=0.892112
[S2] _apply_head_vector_avg (torch): Δ‖w‖=5.219696e-01
[S2] stored merged vector for next round verification (round=6)
[S2] DEBUG after merge:  round=6 metric=0.1418 head_norm=1.146387 delta_norm=0.521970
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=6 metric=0.3692 head_norm=0.807516
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.643208e-01
[S4] stored merged vector for next round verification (round=6)
[S4] DEBUG after merge:  round=6 metric=0.4111 head_norm=0.781740 delta_norm=0.464321
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=6 metric=0.4152 head_norm=0.895787
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.610369e-01
[S11] stored merged vector for next round verification (round=6)
[S11] DEBUG after merge:  round=6 metric=0.4156 head_norm=0.709540 delta_norm=0.461037
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=6 metric=0.1502 head_norm=0.793454
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.531635e-01
[S14] stored merged vector for next round verification (round=6)
[S14] DEBUG after merge:  round=6 metric=0.1404 head_norm=0.738419 delta_norm=0.353163
[S14] aggregate: ROLLBACK (f1_val pre=0.150 post=0.140 tol_abs=0.005 tol_rel=0.0)
[S2] START round=7 head_norm_before_train=1.146387 cos_to_last_merge=1.0000 (last merge round=6)
[S2] round=7 local utility u=0.133591 metrics={'f1_val': 0.15724787502871582, 'auprc': 0.7520912787875499, 'loss_val': 1.0985401866426243, 'psi': 0.39518523653224946}-{'f1_val': 0.1417771333885667, 'auprc': 0.7101363761399195, 'loss_val': 1.1470324329821442, 'psi': 0.3691208304891079}
[S3] START round=7 head_norm_before_train=1.541897 (no previous merge yet)
[S3] round=7 local utility u=0.019412 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9967095811486598, 'loss_val': 0.31690224887335877, 'psi': 0.8191375547006436}-{'f1_val': 0.7004261945879899, 'auprc': 0.9962883626837863, 'loss_val': 0.35248297252605815, 'psi': 0.8187710618263084}
[S4] START round=7 head_norm_before_train=0.781740 cos_to_last_merge=1.0000 (last merge round=6)
[S4] round=7 local utility u=0.000000 metrics={'f1_val': 0.3751777804493503, 'auprc': 0.6471180436908345, 'loss_val': 1.0028362972582285, 'psi': 0.483953885745944}-{'f1_val': 0.36924155613472665, 'auprc': 0.7629410431672587, 'loss_val': 1.0608699007530495, 'psi': 0.5267213509477395}
[S5] START round=7 head_norm_before_train=0.686930 cos_to_last_merge=0.9886 (last merge round=5)
[S5] round=7 local utility u=0.000000 metrics={'f1_val': 0.41750600063402926, 'auprc': 0.7755091798598623, 'loss_val': 0.8061680810911908, 'psi': 0.5607072723243625}-{'f1_val': 0.42623421108970244, 'auprc': 0.9978582201691542, 'loss_val': 0.7907484449561537, 'psi': 0.6548838147214832}
[S6] START round=7 head_norm_before_train=0.663834 cos_to_last_merge=0.9944 (last merge round=5)
[S6] round=7 local utility u=0.887405 metrics={'f1_val': 0.4132133576322095, 'auprc': 0.8613468883695123, 'loss_val': 1.102854524551707, 'psi': 0.5924667699271307}-{'f1_val': 0.14142628205128205, 'auprc': 0.8522219461377475, 'loss_val': 1.2195677539736076, 'psi': 0.4257445476858682}
[S7] START round=7 head_norm_before_train=1.489549 (no previous merge yet)
[S7] round=7 local utility u=0.000000 metrics={'f1_val': 0.38401381554421155, 'auprc': 0.5805394136388613, 'loss_val': 1.2090164082889188, 'psi': 0.46262405478207147}-{'f1_val': 0.5616017379006499, 'auprc': 0.7872452682008027, 'loss_val': 0.7345335109425621, 'psi': 0.651859150020711}
[S8] START round=7 head_norm_before_train=1.285327 (no previous merge yet)
[S8] round=7 local utility u=0.373511 metrics={'f1_val': 0.37306606018310795, 'auprc': 0.9947506419766088, 'loss_val': 0.8761596721917575, 'psi': 0.6217398929005084}-{'f1_val': 0.3728657005221765, 'auprc': 0.7792129296511475, 'loss_val': 0.975366450783119, 'psi': 0.5354045921737649}
[S9] START round=7 head_norm_before_train=1.177293 cos_to_last_merge=0.8947 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.895
[S9] round=7 local utility u=0.053972 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9971322757432015, 'loss_val': 0.2702204706421101, 'psi': 0.8195828587612918}-{'f1_val': 0.7012182915391405, 'auprc': 0.9986143481048914, 'loss_val': 0.38262070828687816, 'psi': 0.8201767141654408}
[S10] START round=7 head_norm_before_train=1.000670 cos_to_last_merge=0.9563 (last merge round=1)
[S10] round=7 local utility u=0.225370 metrics={'f1_val': 0.4170518629654155, 'auprc': 0.7509856456711834, 'loss_val': 0.8477932743276045, 'psi': 0.5506253760477227}-{'f1_val': 0.41634224672860876, 'auprc': 0.6573994488999696, 'loss_val': 1.0135165357322662, 'psi': 0.5127651275971531}
[S11] START round=7 head_norm_before_train=0.709540 cos_to_last_merge=1.0000 (last merge round=6)
[S11] round=7 local utility u=0.135913 metrics={'f1_val': 0.396484976660716, 'auprc': 0.787935369455736, 'loss_val': 0.9518302432878677, 'psi': 0.553065133778724}-{'f1_val': 0.4152176962830677, 'auprc': 0.6664195732522193, 'loss_val': 0.9715052753364208, 'psi': 0.5156984470707283}
[S13] START round=7 head_norm_before_train=1.223250 (no previous merge yet)
[S13] round=7 local utility u=0.072996 metrics={'f1_val': 0.4322093783680517, 'auprc': 0.7212797013330507, 'loss_val': 0.9358850247157287, 'psi': 0.5478375075540514}-{'f1_val': 0.4162370592043806, 'auprc': 0.7287641591364055, 'loss_val': 1.0084974118059222, 'psi': 0.5412478991771905}
[S14] START round=7 head_norm_before_train=0.738419 cos_to_last_merge=1.0000 (last merge round=6)
[S14] round=7 local utility u=0.981296 metrics={'f1_val': 0.39659360338126215, 'auprc': 0.8573178459711754, 'loss_val': 1.0536095277434772, 'psi': 0.5808833004172275}-{'f1_val': 0.15024473292189827, 'auprc': 0.7211149456493605, 'loss_val': 1.1294995219579744, 'psi': 0.3785928180128832}
[S15] START round=7 head_norm_before_train=0.787685 cos_to_last_merge=0.9967 (last merge round=5)
[S15] round=7 local utility u=0.793094 metrics={'f1_val': 0.3757684766955647, 'auprc': 0.8001032710485338, 'loss_val': 1.1247631935990157, 'psi': 0.5455023944367524}-{'f1_val': 0.13973365136155833, 'auprc': 0.7769243852894573, 'loss_val': 1.2252050561171985, 'psi': 0.39460994493271795}
[S16] START round=7 head_norm_before_train=1.045621 cos_to_last_merge=0.9515 (last merge round=1)
[S16] round=7 local utility u=0.000000 metrics={'f1_val': 0.3847117476665302, 'auprc': 0.7388582023656475, 'loss_val': 0.9473974370105729, 'psi': 0.5263703295461771}-{'f1_val': 0.4171583814486223, 'auprc': 0.7359682264183115, 'loss_val': 0.9868712624384918, 'psi': 0.544682319436498}
[S17] START round=7 head_norm_before_train=0.844049 cos_to_last_merge=0.9457 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.946
[S17] round=7 local utility u=0.868823 metrics={'f1_val': 0.3844905430875118, 'auprc': 0.6189552901145983, 'loss_val': 1.0662391541147245, 'psi': 0.4782764418983464}-{'f1_val': 0.14094896331738438, 'auprc': 0.5595601133833006, 'loss_val': 1.1644499865954714, 'psi': 0.30839342334375086}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:62410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S2] → sending delta(kind=head bytes=1788) to S6@127.0.0.1:62407
[S3] not sending this round → trigger blocked (psi=0.819)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.820)
[S10] not sending this round → trigger blocked (psi=0.551)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:62410
[S14] not sending this round → trigger blocked (psi=0.581)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:62415
[S15] not sending this round → trigger blocked (psi=0.546)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:62407
[S11] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1788 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1801) from S6
[S15] cosine check vs S6: cos=0.6850
[S6] RECEIVED delta(kind=head bytes=1788) from S2
[S6] cosine check vs S2: cos=0.3719
[S6] RECEIVED delta(kind=head bytes=1798) from S8
[S6] cosine check vs S8: cos=0.4898
[S9] RECEIVED delta(kind=head bytes=1801) from S13
[S9] cosine check vs S13: cos=-0.1404
[S9] DROPPED delta from S13 (cos=-0.1404 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1799) from S11
[S9] cosine check vs S11: cos=0.3512
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:62405
[S17] sending update (kind=head size=1795 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1795) from S17
[S5] cosine check vs S17: cos=0.5653
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=7 metric=0.3758 head_norm=0.826805
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.083919e-01
[S15] stored merged vector for next round verification (round=7)
[S15] DEBUG after merge:  round=7 metric=0.3211 head_norm=0.700798 delta_norm=0.308392
[S15] aggregate: ROLLBACK (f1_val pre=0.376 post=0.321 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=7 metric=0.7012 head_norm=1.268822
[S9] _apply_head_vector_avg (torch): Δ‖w‖=6.139000e-01
[S9] stored merged vector for next round verification (round=7)
[S9] DEBUG after merge:  round=7 metric=0.7012 head_norm=0.844712 delta_norm=0.613900
[S9] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=7 metric=0.4175 head_norm=0.764291
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.892455e-01
[S5] stored merged vector for next round verification (round=7)
[S5] DEBUG after merge:  round=7 metric=0.4175 head_norm=0.731812 delta_norm=0.389245
[S5] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=7 metric=0.4132 head_norm=0.699171
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.647679e-01
[S6] stored merged vector for next round verification (round=7)
[S6] DEBUG after merge:  round=7 metric=0.3830 head_norm=0.715483 delta_norm=0.364768
[S6] aggregate: ROLLBACK (f1_val pre=0.413 post=0.383 tol_abs=0.005 tol_rel=0.0)
[S2] START round=8 head_norm_before_train=1.167760 cos_to_last_merge=0.9981 (last merge round=6)
[S2] round=8 local utility u=0.913344 metrics={'f1_val': 0.4335582302841423, 'auprc': 0.7612753403587031, 'loss_val': 0.9572660168196786, 'psi': 0.5646450743139666}-{'f1_val': 0.15724787502871582, 'auprc': 0.7520912787875499, 'loss_val': 1.0985401866426243, 'psi': 0.39518523653224946}
[S3] START round=8 head_norm_before_train=1.596704 (no previous merge yet)
[S3] round=8 local utility u=0.000000 metrics={'f1_val': 0.7008362290767893, 'auprc': 0.9956164790239143, 'loss_val': 0.33495615236711934, 'psi': 0.8187483290556393}-{'f1_val': 0.7007562037352997, 'auprc': 0.9967095811486598, 'loss_val': 0.31690224887335877, 'psi': 0.8191375547006436}
[S4] START round=8 head_norm_before_train=0.818007 cos_to_last_merge=0.9931 (last merge round=6)
[S4] round=8 local utility u=0.221659 metrics={'f1_val': 0.3763330357562605, 'auprc': 0.7543058611994323, 'loss_val': 0.8880130858804955, 'psi': 0.5275221659335292}-{'f1_val': 0.3751777804493503, 'auprc': 0.6471180436908345, 'loss_val': 1.0028362972582285, 'psi': 0.483953885745944}
[S5] START round=8 head_norm_before_train=0.731812 cos_to_last_merge=1.0000 (last merge round=7)
[S5] round=8 local utility u=0.865215 metrics={'f1_val': 0.6923571059137821, 'auprc': 0.7743526267419601, 'loss_val': 0.721375396714372, 'psi': 0.7251553142450533}-{'f1_val': 0.41750600063402926, 'auprc': 0.7755091798598623, 'loss_val': 0.8061680810911908, 'psi': 0.5607072723243625}
[S6] START round=8 head_norm_before_train=0.715483 cos_to_last_merge=1.0000 (last merge round=7)
[S6] round=8 local utility u=0.000000 metrics={'f1_val': 0.41544627768762743, 'auprc': 0.8215563004523568, 'loss_val': 1.0163660507720282, 'psi': 0.5778902867935192}-{'f1_val': 0.4132133576322095, 'auprc': 0.8613468883695123, 'loss_val': 1.102854524551707, 'psi': 0.5924667699271307}
[S7] START round=8 head_norm_before_train=1.541310 (no previous merge yet)
[S7] round=8 local utility u=0.859055 metrics={'f1_val': 0.5659677844780439, 'auprc': 0.6380988077735428, 'loss_val': 0.7553090687943977, 'psi': 0.5948201937962434}-{'f1_val': 0.38401381554421155, 'auprc': 0.5805394136388613, 'loss_val': 1.2090164082889188, 'psi': 0.46262405478207147}
[S8] START round=8 head_norm_before_train=1.325793 (no previous merge yet)
[S8] round=8 local utility u=0.039674 metrics={'f1_val': 0.3728657005221765, 'auprc': 0.9948017364670654, 'loss_val': 0.7957624750037245, 'psi': 0.621640114900132}-{'f1_val': 0.37306606018310795, 'auprc': 0.9947506419766088, 'loss_val': 0.8761596721917575, 'psi': 0.6217398929005084}
[S9] START round=8 head_norm_before_train=0.844712 cos_to_last_merge=1.0000 (last merge round=7)
[S9] round=8 local utility u=0.000000 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9978873932479739, 'loss_val': 0.29809546057764036, 'psi': 0.8198849057632007}-{'f1_val': 0.7012165807733519, 'auprc': 0.9971322757432015, 'loss_val': 0.2702204706421101, 'psi': 0.8195828587612918}
[S10] START round=8 head_norm_before_train=1.040106 cos_to_last_merge=0.9418 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.942
[S10] round=8 local utility u=0.534252 metrics={'f1_val': 0.4439840406892084, 'auprc': 0.9943227015670781, 'loss_val': 0.6708941396121265, 'psi': 0.6641195050403563}-{'f1_val': 0.4170518629654155, 'auprc': 0.7509856456711834, 'loss_val': 0.8477932743276045, 'psi': 0.5506253760477227}
[S11] START round=8 head_norm_before_train=0.755587 cos_to_last_merge=0.9926 (last merge round=6)
[S11] round=8 local utility u=0.285169 metrics={'f1_val': 0.39651855440916606, 'auprc': 0.9143723538143974, 'loss_val': 0.7610044140958598, 'psi': 0.6036600741712586}-{'f1_val': 0.396484976660716, 'auprc': 0.787935369455736, 'loss_val': 0.9518302432878677, 'psi': 0.553065133778724}
[S13] START round=8 head_norm_before_train=1.249753 (no previous merge yet)
[S13] round=8 local utility u=0.000000 metrics={'f1_val': 0.3768641666810957, 'auprc': 0.6240315680995809, 'loss_val': 0.8689564009810219, 'psi': 0.47573112724848976}-{'f1_val': 0.4322093783680517, 'auprc': 0.7212797013330507, 'loss_val': 0.9358850247157287, 'psi': 0.5478375075540514}
[S14] START round=8 head_norm_before_train=0.781232 cos_to_last_merge=0.9938 (last merge round=6)
[S14] round=8 local utility u=0.257892 metrics={'f1_val': 0.39656053564365834, 'auprc': 0.9677824616263708, 'loss_val': 0.8690202581410613, 'psi': 0.6250493060367434}-{'f1_val': 0.39659360338126215, 'auprc': 0.8573178459711754, 'loss_val': 1.0536095277434772, 'psi': 0.5808833004172275}
[S15] START round=8 head_norm_before_train=0.700798 cos_to_last_merge=1.0000 (last merge round=7)
[S15] round=8 local utility u=0.160477 metrics={'f1_val': 0.4169508412658852, 'auprc': 0.8001161025956731, 'loss_val': 1.0509410729763196, 'psi': 0.5702169457978004}-{'f1_val': 0.3757684766955647, 'auprc': 0.8001032710485338, 'loss_val': 1.1247631935990157, 'psi': 0.5455023944367524}
[S16] START round=8 head_norm_before_train=1.093064 cos_to_last_merge=0.9350 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.935
[S16] round=8 local utility u=0.103229 metrics={'f1_val': 0.4112627426637485, 'auprc': 0.740328580322934, 'loss_val': 0.9046557333422397, 'psi': 0.5428890777274227}-{'f1_val': 0.3847117476665302, 'auprc': 0.7388582023656475, 'loss_val': 0.9473974370105729, 'psi': 0.5263703295461771}
[S17] START round=8 head_norm_before_train=0.888809 cos_to_last_merge=0.9237 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.924
[S17] round=8 local utility u=0.139490 metrics={'f1_val': 0.3913215020897012, 'auprc': 0.6603420114549556, 'loss_val': 0.9524054865741873, 'psi': 0.49892970583580293}-{'f1_val': 0.3844905430875118, 'auprc': 0.6189552901145983, 'loss_val': 1.0662391541147245, 'psi': 0.4782764418983464}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:62407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:62410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:62405
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:62404
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:62414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S2] → sending delta(kind=head bytes=1791) to S6@127.0.0.1:62407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:62410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:62404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:62407
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:62412
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1791 to 1 peers)
[S4] sending update (kind=head size=1793 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1802 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1797) from S14
[S11] cosine check vs S14: cos=0.6166
[S6] RECEIVED delta(kind=head bytes=1798) from S8
[S6] cosine check vs S8: cos=0.6881
[S6] RECEIVED delta(kind=head bytes=1800) from S7
[S6] cosine check vs S7: cos=0.2879
[S9] RECEIVED delta(kind=head bytes=1802) from S11
[S9] cosine check vs S11: cos=0.6524
[S9] RECEIVED delta(kind=head bytes=1795) from S5
[S9] cosine check vs S5: cos=-0.0113
[S9] DROPPED delta from S5 (cos=-0.0113 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1793) from S4
[S5] cosine check vs S4: cos=0.2661
[S4] RECEIVED delta(kind=head bytes=1799) from S10
[S4] cosine check vs S10: cos=0.8104
[S4] RECEIVED delta(kind=head bytes=1802) from S16
[S4] cosine check vs S16: cos=0.6366
[S14] RECEIVED delta(kind=head bytes=1798) from S15
[S14] cosine check vs S15: cos=0.5555
[S6] RECEIVED delta(kind=head bytes=1791) from S2
[S6] cosine check vs S2: cos=0.5830
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S17] → sending delta(kind=head bytes=1791) to S5@127.0.0.1:62405
[S17] sending update (kind=head size=1791 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1791) from S17
[S5] cosine check vs S17: cos=0.8331
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=8 metric=0.7012 head_norm=0.952375
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.737250e-01
[S9] stored merged vector for next round verification (round=8)
[S9] DEBUG after merge:  round=8 metric=0.7012 head_norm=0.803966 delta_norm=0.373725
[S9] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=8 metric=0.4154 head_norm=0.745577
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.167221e-01
[S6] stored merged vector for next round verification (round=8)
[S6] DEBUG after merge:  round=8 metric=0.4156 head_norm=0.754680 delta_norm=0.216722
[S6] aggregate: ACCEPT kept=['S8', 'S7', 'S2'] (k=3/3) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=8 metric=0.6924 head_norm=0.807249
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.826059e-01
[S5] stored merged vector for next round verification (round=8)
[S5] DEBUG after merge:  round=8 metric=0.7111 head_norm=0.700158 delta_norm=0.282606
[S5] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=8 metric=0.3763 head_norm=0.870160
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.266699e-01
[S4] stored merged vector for next round verification (round=8)
[S4] DEBUG after merge:  round=8 metric=0.3762 head_norm=0.866369 delta_norm=0.226670
[S4] aggregate: ACCEPT kept=['S10', 'S16'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=8 metric=0.3965 head_norm=0.815503
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.616012e-01
[S11] stored merged vector for next round verification (round=8)
[S11] DEBUG after merge:  round=8 metric=0.4127 head_norm=0.742349 delta_norm=0.361601
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=8 metric=0.3966 head_norm=0.835840
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.738139e-01
[S14] stored merged vector for next round verification (round=8)
[S14] DEBUG after merge:  round=8 metric=0.3966 head_norm=0.695157 delta_norm=0.373814
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=1.200188 cos_to_last_merge=0.9923 (last merge round=6)
[S2] round=9 local utility u=0.738871 metrics={'f1_val': 0.6997192205205487, 'auprc': 0.6814905175617307, 'loss_val': 0.8371355108869383, 'psi': 0.6924277393370215}-{'f1_val': 0.4335582302841423, 'auprc': 0.7612753403587031, 'loss_val': 0.9572660168196786, 'psi': 0.5646450743139666}
[S3] START round=9 head_norm_before_train=1.629185 (no previous merge yet)
[S3] round=9 local utility u=0.038936 metrics={'f1_val': 0.7004261945879899, 'auprc': 0.9967306258145339, 'loss_val': 0.25796657777312093, 'psi': 0.8189479670786075}-{'f1_val': 0.7008362290767893, 'auprc': 0.9956164790239143, 'loss_val': 0.33495615236711934, 'psi': 0.8187483290556393}
[S4] START round=9 head_norm_before_train=0.866369 cos_to_last_merge=1.0000 (last merge round=8)
[S4] round=9 local utility u=0.000000 metrics={'f1_val': 0.37650515970225207, 'auprc': 0.7319868694112803, 'loss_val': 0.8274374435494322, 'psi': 0.5186978435858633}-{'f1_val': 0.3763330357562605, 'auprc': 0.7543058611994323, 'loss_val': 0.8880130858804955, 'psi': 0.5275221659335292}
[S5] START round=9 head_norm_before_train=0.700158 cos_to_last_merge=1.0000 (last merge round=8)
[S5] round=9 local utility u=0.078840 metrics={'f1_val': 0.700596146314849, 'auprc': 0.7835173998545747, 'loss_val': 0.6406239401135069, 'psi': 0.7337646477307393}-{'f1_val': 0.6923571059137821, 'auprc': 0.7743526267419601, 'loss_val': 0.721375396714372, 'psi': 0.7251553142450533}
[S6] START round=9 head_norm_before_train=0.754680 cos_to_last_merge=1.0000 (last merge round=8)
[S6] round=9 local utility u=0.062550 metrics={'f1_val': 0.41524424617876, 'auprc': 0.8440318479998624, 'loss_val': 0.9574813013005145, 'psi': 0.5867592869072009}-{'f1_val': 0.41544627768762743, 'auprc': 0.8215563004523568, 'loss_val': 1.0163660507720282, 'psi': 0.5778902867935192}
[S7] START round=9 head_norm_before_train=1.569899 (no previous merge yet)
[S7] round=9 local utility u=0.042423 metrics={'f1_val': 0.5464514402188607, 'auprc': 0.7376419515100766, 'loss_val': 0.8519954157453373, 'psi': 0.6229276447353471}-{'f1_val': 0.5659677844780439, 'auprc': 0.6380988077735428, 'loss_val': 0.7553090687943977, 'psi': 0.5948201937962434}
[S8] START round=9 head_norm_before_train=1.368599 (no previous merge yet)
[S8] round=9 local utility u=0.000000 metrics={'f1_val': 0.3772800920550886, 'auprc': 0.8664480417888114, 'loss_val': 0.657675834516342, 'psi': 0.5729472719485778}-{'f1_val': 0.3728657005221765, 'auprc': 0.9948017364670654, 'loss_val': 0.7957624750037245, 'psi': 0.621640114900132}
[S9] START round=9 head_norm_before_train=0.803966 cos_to_last_merge=1.0000 (last merge round=8)
[S9] round=9 local utility u=0.838669 metrics={'f1_val': 0.9813652688497929, 'auprc': 0.9987641054812832, 'loss_val': 0.3042801666026322, 'psi': 0.988324803502389}-{'f1_val': 0.7012165807733519, 'auprc': 0.9978873932479739, 'loss_val': 0.29809546057764036, 'psi': 0.8198849057632007}
[S10] START round=9 head_norm_before_train=1.089789 cos_to_last_merge=0.9244 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.924
[S10] round=9 local utility u=0.850607 metrics={'f1_val': 0.7012901772600362, 'auprc': 0.9954432597530944, 'loss_val': 0.5168789734610544, 'psi': 0.8189514102572595}-{'f1_val': 0.4439840406892084, 'auprc': 0.9943227015670781, 'loss_val': 0.6708941396121265, 'psi': 0.6641195050403563}
[S11] START round=9 head_norm_before_train=0.742349 cos_to_last_merge=1.0000 (last merge round=8)
[S11] round=9 local utility u=0.814146 metrics={'f1_val': 0.6561432984127903, 'auprc': 0.9375871937995763, 'loss_val': 0.7601051528777356, 'psi': 0.7687208565675048}-{'f1_val': 0.39651855440916606, 'auprc': 0.9143723538143974, 'loss_val': 0.7610044140958598, 'psi': 0.6036600741712586}
[S13] START round=9 head_norm_before_train=1.282473 (no previous merge yet)
[S13] round=9 local utility u=0.348250 metrics={'f1_val': 0.4363450761391686, 'auprc': 0.7091567307617025, 'loss_val': 0.7847168098132261, 'psi': 0.5454697379881821}-{'f1_val': 0.3768641666810957, 'auprc': 0.6240315680995809, 'loss_val': 0.8689564009810219, 'psi': 0.47573112724848976}
[S14] START round=9 head_norm_before_train=0.695157 cos_to_last_merge=1.0000 (last merge round=8)
[S14] round=9 local utility u=0.175494 metrics={'f1_val': 0.44608330783567496, 'auprc': 0.9937352242242244, 'loss_val': 0.8930276048042317, 'psi': 0.6651440743910948}-{'f1_val': 0.39656053564365834, 'auprc': 0.9677824616263708, 'loss_val': 0.8690202581410613, 'psi': 0.6250493060367434}
[S15] START round=9 head_norm_before_train=0.739818 cos_to_last_merge=0.9946 (last merge round=7)
[S15] round=9 local utility u=0.044412 metrics={'f1_val': 0.39792642021571634, 'auprc': 0.799847940570847, 'loss_val': 0.8471656415245291, 'psi': 0.5586950283577685}-{'f1_val': 0.4169508412658852, 'auprc': 0.8001161025956731, 'loss_val': 1.0509410729763196, 'psi': 0.5702169457978004}
[S16] START round=9 head_norm_before_train=1.137139 cos_to_last_merge=0.9179 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.918
[S16] round=9 local utility u=0.007487 metrics={'f1_val': 0.4020778326673979, 'auprc': 0.7410865151027131, 'loss_val': 0.8368462165875766, 'psi': 0.5376813056415239}-{'f1_val': 0.4112627426637485, 'auprc': 0.740328580322934, 'loss_val': 0.9046557333422397, 'psi': 0.5428890777274227}
[S17] START round=9 head_norm_before_train=0.942459 cos_to_last_merge=0.8975 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.897
[S17] round=9 local utility u=0.174641 metrics={'f1_val': 0.3546539262393762, 'auprc': 0.8285746477750732, 'loss_val': 0.8878160198890401, 'psi': 0.5442222148536551}-{'f1_val': 0.3913215020897012, 'auprc': 0.6603420114549556, 'loss_val': 0.9524054865741873, 'psi': 0.49892970583580293}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:62414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:62407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:62410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:62410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:62415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:62412
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] → sending delta(kind=head bytes=1794) to S6@127.0.0.1:62407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:62414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:62402
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:62404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:62404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:62410
[S11] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1794 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1798) from S15
[S14] cosine check vs S15: cos=0.8017
[S2] RECEIVED delta(kind=head bytes=1799) from S3
[S2] cosine check vs S3: cos=0.9197
[S11] RECEIVED delta(kind=head bytes=1802) from S14
[S11] cosine check vs S14: cos=0.7829
[S6] RECEIVED delta(kind=head bytes=1794) from S2
[S6] cosine check vs S2: cos=0.6373
[S6] RECEIVED delta(kind=head bytes=1800) from S7
[S6] cosine check vs S7: cos=0.4657
[S9] RECEIVED delta(kind=head bytes=1800) from S11
[S9] cosine check vs S11: cos=0.9334
[S9] RECEIVED delta(kind=head bytes=1801) from S13
[S9] cosine check vs S13: cos=-0.1396
[S9] DROPPED delta from S13 (cos=-0.1396 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1796) from S5
[S9] cosine check vs S5: cos=0.0332
[S15] RECEIVED delta(kind=head bytes=1802) from S6
[S15] cosine check vs S6: cos=0.6373
[S4] RECEIVED delta(kind=head bytes=1795) from S10
[S4] cosine check vs S10: cos=0.8121
[S4] RECEIVED delta(kind=head bytes=1797) from S16
[S4] cosine check vs S16: cos=0.7374
[S14] RECEIVED delta(kind=head bytes=1800) from S9
[S14] cosine check vs S9: cos=0.7280
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:62405
[S17] sending update (kind=head size=1794 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1794) from S17
[S5] cosine check vs S17: cos=0.8021
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=9 metric=0.3765 head_norm=0.914960
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.572845e-01
[S4] stored merged vector for next round verification (round=9)
[S4] DEBUG after merge:  round=9 metric=0.3766 head_norm=0.921602 delta_norm=0.157284
[S4] aggregate: ACCEPT kept=['S10', 'S16'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=9 metric=0.9814 head_norm=0.906394
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.430538e-01
[S9] stored merged vector for next round verification (round=9)
[S9] DEBUG after merge:  round=9 metric=0.8371 head_norm=0.680440 delta_norm=0.343054
[S9] aggregate: ROLLBACK (f1_val pre=0.981 post=0.837 tol_abs=0.005 tol_rel=0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=9 metric=0.6561 head_norm=0.787965
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.529343e-01
[S11] stored merged vector for next round verification (round=9)
[S11] DEBUG after merge:  round=9 metric=0.7016 head_norm=0.722199 delta_norm=0.252934
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=9 metric=0.6997 head_norm=1.239016
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.554730e-01
[S2] stored merged vector for next round verification (round=9)
[S2] DEBUG after merge:  round=9 metric=0.5007 head_norm=1.419827 delta_norm=0.355473
[S2] aggregate: ROLLBACK (f1_val pre=0.700 post=0.501 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=9 metric=0.4461 head_norm=0.741758
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.413429e-01
[S14] stored merged vector for next round verification (round=9)
[S14] DEBUG after merge:  round=9 metric=0.6218 head_norm=0.706955 delta_norm=0.141343
[S14] aggregate: ACCEPT kept=['S15', 'S9'] (k=2/2) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=9 metric=0.4152 head_norm=0.787124
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.748380e-01
[S6] stored merged vector for next round verification (round=9)
[S6] DEBUG after merge:  round=9 metric=0.3739 head_norm=0.861999 delta_norm=0.374838
[S6] aggregate: ROLLBACK (f1_val pre=0.415 post=0.374 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=9 metric=0.7006 head_norm=0.795932
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.977534e-01
[S5] stored merged vector for next round verification (round=9)
[S5] DEBUG after merge:  round=9 metric=0.7007 head_norm=0.851582 delta_norm=0.297753
[S5] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=9 metric=0.3979 head_norm=0.790593
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.359457e-01
[S15] stored merged vector for next round verification (round=9)
[S15] DEBUG after merge:  round=9 metric=0.4119 head_norm=0.713751 delta_norm=0.335946
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=1.419827 cos_to_last_merge=1.0000 (last merge round=9)
[S2] round=10 local utility u=0.108278 metrics={'f1_val': 0.7000788130181788, 'auprc': 0.7085707575196454, 'loss_val': 0.7039774914495825, 'psi': 0.7034755908187653}-{'f1_val': 0.6997192205205487, 'auprc': 0.6814905175617307, 'loss_val': 0.8371355108869383, 'psi': 0.6924277393370215}
[S3] START round=10 head_norm_before_train=1.658125 (no previous merge yet)
[S3] round=10 local utility u=0.028390 metrics={'f1_val': 0.7009355793019081, 'auprc': 0.9986610002130596, 'loss_val': 0.2100337170960966, 'psi': 0.8200257476663687}-{'f1_val': 0.7004261945879899, 'auprc': 0.9967306258145339, 'loss_val': 0.25796657777312093, 'psi': 0.8189479670786075}
[S4] START round=10 head_norm_before_train=0.921602 cos_to_last_merge=1.0000 (last merge round=9)
[S4] round=10 local utility u=0.122442 metrics={'f1_val': 0.43642680100197623, 'auprc': 0.6806198204317337, 'loss_val': 0.7879812115949004, 'psi': 0.5341040087738792}-{'f1_val': 0.37650515970225207, 'auprc': 0.7319868694112803, 'loss_val': 0.8274374435494322, 'psi': 0.5186978435858633}
[S5] START round=10 head_norm_before_train=0.851582 cos_to_last_merge=1.0000 (last merge round=9)
[S5] round=10 local utility u=0.011502 metrics={'f1_val': 0.702254196980061, 'auprc': 0.7751093048049225, 'loss_val': 0.6023444187259653, 'psi': 0.7313962401100056}-{'f1_val': 0.700596146314849, 'auprc': 0.7835173998545747, 'loss_val': 0.6406239401135069, 'psi': 0.7337646477307393}
[S6] START round=10 head_norm_before_train=0.861999 cos_to_last_merge=1.0000 (last merge round=9)
[S6] round=10 local utility u=0.019533 metrics={'f1_val': 0.4150420236907487, 'auprc': 0.8432411935347391, 'loss_val': 0.9148305097233544, 'psi': 0.5863216916283449}-{'f1_val': 0.41524424617876, 'auprc': 0.8440318479998624, 'loss_val': 0.9574813013005145, 'psi': 0.5867592869072009}
[S7] START round=10 head_norm_before_train=1.591940 (no previous merge yet)
[S7] round=10 local utility u=0.811924 metrics={'f1_val': 0.687784497887834, 'auprc': 0.842673198821276, 'loss_val': 0.39123928304012956, 'psi': 0.7497399782612109}-{'f1_val': 0.5464514402188607, 'auprc': 0.7376419515100766, 'loss_val': 0.8519954157453373, 'psi': 0.6229276447353471}
[S8] START round=10 head_norm_before_train=1.409952 (no previous merge yet)
[S8] round=10 local utility u=1.000000 metrics={'f1_val': 0.7141096062959231, 'auprc': 0.9968427953859011, 'loss_val': 0.538268772527538, 'psi': 0.8272028819319144}-{'f1_val': 0.3772800920550886, 'auprc': 0.8664480417888114, 'loss_val': 0.657675834516342, 'psi': 0.5729472719485778}
[S9] START round=10 head_norm_before_train=0.680440 cos_to_last_merge=1.0000 (last merge round=9)
[S9] round=10 local utility u=0.030528 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9972382953004117, 'loss_val': 0.3254157131176693, 'psi': 0.996391349138676}-{'f1_val': 0.9813652688497929, 'auprc': 0.9987641054812832, 'loss_val': 0.3042801666026322, 'psi': 0.988324803502389}
[S10] START round=10 head_norm_before_train=1.147467 cos_to_last_merge=0.9062 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.906
[S10] round=10 local utility u=0.000000 metrics={'f1_val': 0.6888514011826712, 'auprc': 0.9661225080118928, 'loss_val': 0.4116313223917015, 'psi': 0.7997598439143598}-{'f1_val': 0.7012901772600362, 'auprc': 0.9954432597530944, 'loss_val': 0.5168789734610544, 'psi': 0.8189514102572595}
[S11] START round=10 head_norm_before_train=0.722199 cos_to_last_merge=1.0000 (last merge round=9)
[S11] round=10 local utility u=0.152239 metrics={'f1_val': 0.7018246587012323, 'auprc': 0.9419402119835725, 'loss_val': 0.742773764297716, 'psi': 0.7978708800141684}-{'f1_val': 0.6561432984127903, 'auprc': 0.9375871937995763, 'loss_val': 0.7601051528777356, 'psi': 0.7687208565675048}
[S13] START round=10 head_norm_before_train=1.320204 (no previous merge yet)
[S13] round=10 local utility u=0.000000 metrics={'f1_val': 0.45445360393203005, 'auprc': 0.6450886663570233, 'loss_val': 0.7599860594796705, 'psi': 0.5307076289020274}-{'f1_val': 0.4363450761391686, 'auprc': 0.7091567307617025, 'loss_val': 0.7847168098132261, 'psi': 0.5454697379881821}
[S14] START round=10 head_norm_before_train=0.706955 cos_to_last_merge=1.0000 (last merge round=9)
[S14] round=10 local utility u=0.000000 metrics={'f1_val': 0.39659360338126215, 'auprc': 0.9945683311993321, 'loss_val': 0.8062167957474637, 'psi': 0.6357834945084901}-{'f1_val': 0.44608330783567496, 'auprc': 0.9937352242242244, 'loss_val': 0.8930276048042317, 'psi': 0.6651440743910948}
[S15] START round=10 head_norm_before_train=0.713751 cos_to_last_merge=1.0000 (last merge round=9)
[S15] round=10 local utility u=0.054831 metrics={'f1_val': 0.4167276561389307, 'auprc': 0.7997213010620237, 'loss_val': 0.8499304564526352, 'psi': 0.5699251141081678}-{'f1_val': 0.39792642021571634, 'auprc': 0.799847940570847, 'loss_val': 0.8471656415245291, 'psi': 0.5586950283577685}
[S16] START round=10 head_norm_before_train=1.180622 cos_to_last_merge=0.9017 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.902
[S16] round=10 local utility u=0.436889 metrics={'f1_val': 0.532832667894486, 'auprc': 0.760873118379453, 'loss_val': 0.8069569089473746, 'psi': 0.6240488480884729}-{'f1_val': 0.4020778326673979, 'auprc': 0.7410865151027131, 'loss_val': 0.8368462165875766, 'psi': 0.5376813056415239}
[S17] START round=10 head_norm_before_train=0.997091 cos_to_last_merge=0.8715 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.871
[S17] round=10 local utility u=0.000000 metrics={'f1_val': 0.35243618488830136, 'auprc': 0.7955645240025364, 'loss_val': 0.8843128029789933, 'psi': 0.5296875205339954}-{'f1_val': 0.3546539262393762, 'auprc': 0.8285746477750732, 'loss_val': 0.8878160198890401, 'psi': 0.5442222148536551}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:62410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:62407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:62407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:62407
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:62405
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:62404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:62402
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] → sending delta(kind=head bytes=1794) to S15@127.0.0.1:62415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:62414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:62414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:62410
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1794 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1800) from S8
[S6] cosine check vs S8: cos=0.2724
[S6] RECEIVED delta(kind=head bytes=1800) from S2
[S6] cosine check vs S2: cos=0.6897
[S6] RECEIVED delta(kind=head bytes=1800) from S7
[S6] cosine check vs S7: cos=0.7021
[S9] RECEIVED delta(kind=head bytes=1797) from S5
[S9] cosine check vs S5: cos=0.3085
[S9] RECEIVED delta(kind=head bytes=1797) from S11
[S9] cosine check vs S11: cos=0.8789
[S5] RECEIVED delta(kind=head bytes=1800) from S4
[S5] cosine check vs S4: cos=0.3434
[S15] RECEIVED delta(kind=head bytes=1794) from S6
[S15] cosine check vs S6: cos=0.7729
[S4] RECEIVED delta(kind=head bytes=1796) from S16
[S4] cosine check vs S16: cos=0.7737
[S14] RECEIVED delta(kind=head bytes=1801) from S9
[S14] cosine check vs S9: cos=0.8142
[S14] RECEIVED delta(kind=head bytes=1801) from S15
[S14] cosine check vs S15: cos=0.6874
[S2] RECEIVED delta(kind=head bytes=1801) from S3
[S2] cosine check vs S3: cos=0.9759
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] ⇄ pheromone p=0.411 → S4@127.0.0.1:62404
[S13] ⇄ pheromone p=0.262 → S9@127.0.0.1:62410
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=10 metric=0.3966 head_norm=0.757838
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.544057e-01
[S14] stored merged vector for next round verification (round=10)
[S14] DEBUG after merge:  round=10 metric=0.3966 head_norm=0.684239 delta_norm=0.154406
[S14] aggregate: ACCEPT kept=['S9', 'S15'] (k=2/2) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.277 → S11@127.0.0.1:62412
[S6] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=10 metric=0.4150 head_norm=0.890741
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.542308e-01
[S6] stored merged vector for next round verification (round=10)
[S6] DEBUG after merge:  round=10 metric=0.4150 head_norm=0.885152 delta_norm=0.154231
[S6] aggregate: ACCEPT kept=['S8', 'S2', 'S7'] (k=3/3) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.220 → S15@127.0.0.1:62415
[S16] ⇄ pheromone p=0.249 → S4@127.0.0.1:62404
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=10 metric=0.4364 head_norm=0.967859
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.889716e-01
[S4] stored merged vector for next round verification (round=10)
[S4] DEBUG after merge:  round=10 metric=0.4136 head_norm=1.034698 delta_norm=0.388972
[S4] aggregate: ROLLBACK (f1_val pre=0.436 post=0.414 tol_abs=0.005 tol_rel=0.0)
[S4] ⇄ pheromone p=0.227 → S5@127.0.0.1:62405
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=10 metric=0.7001 head_norm=1.456128
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.101959e-01
[S2] stored merged vector for next round verification (round=10)
[S2] DEBUG after merge:  round=10 metric=0.6999 head_norm=1.566836 delta_norm=0.210196
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.398 → S6@127.0.0.1:62407
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=10 metric=0.7023 head_norm=0.938003
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.461271e-01
[S5] stored merged vector for next round verification (round=10)
[S5] DEBUG after merge:  round=10 metric=0.7005 head_norm=0.781054 delta_norm=0.546127
[S5] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.307 → S9@127.0.0.1:62410
[S11] ⇄ pheromone p=0.410 → S9@127.0.0.1:62410
[S7] ⇄ pheromone p=0.468 → S6@127.0.0.1:62407
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=10 metric=0.9958 head_norm=0.798592
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.686341e-01
[S9] stored merged vector for next round verification (round=10)
[S9] DEBUG after merge:  round=10 metric=0.9937 head_norm=0.675669 delta_norm=0.268634
[S9] aggregate: ACCEPT kept=['S5', 'S11'] (k=2/2) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.391 → S14@127.0.0.1:62414
[S3] ⇄ pheromone p=0.239 → S2@127.0.0.1:62402
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=10 metric=0.4167 head_norm=0.759973
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.848321e-01
[S15] stored merged vector for next round verification (round=10)
[S15] DEBUG after merge:  round=10 metric=0.4167 head_norm=0.777406 delta_norm=0.284832
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.233 → S14@127.0.0.1:62414
[S8] ⇄ pheromone p=0.436 → S6@127.0.0.1:62407
[S17] ⇄ pheromone p=0.275 → S5@127.0.0.1:62405
[S2] START round=11 head_norm_before_train=1.566836 cos_to_last_merge=1.0000 (last merge round=10)
[S2] round=11 local utility u=0.048207 metrics={'f1_val': 0.7005973585876605, 'auprc': 0.7049229924329841, 'loss_val': 0.5997315468211963, 'psi': 0.7023276121257899}-{'f1_val': 0.7000788130181788, 'auprc': 0.7085707575196454, 'loss_val': 0.7039774914495825, 'psi': 0.7034755908187653}
[S3] START round=11 head_norm_before_train=1.696468 (no previous merge yet)
[S3] round=11 local utility u=0.815898 metrics={'f1_val': 0.960531351117436, 'auprc': 0.9984517140684179, 'loss_val': 0.13518435037733623, 'psi': 0.9756994962978288}-{'f1_val': 0.7009355793019081, 'auprc': 0.9986610002130596, 'loss_val': 0.2100337170960966, 'psi': 0.8200257476663687}
[S4] START round=11 head_norm_before_train=1.034698 cos_to_last_merge=1.0000 (last merge round=10)
[S4] round=11 local utility u=0.018552 metrics={'f1_val': 0.4361746511612805, 'auprc': 0.6806106623232578, 'loss_val': 0.7493369916747109, 'psi': 0.5339490556260714}-{'f1_val': 0.43642680100197623, 'auprc': 0.6806198204317337, 'loss_val': 0.7879812115949004, 'psi': 0.5341040087738792}
[S5] START round=11 head_norm_before_train=0.781054 cos_to_last_merge=1.0000 (last merge round=10)
[S5] round=11 local utility u=0.000000 metrics={'f1_val': 0.7017260301266377, 'auprc': 0.7380706595792921, 'loss_val': 0.6382141328309454, 'psi': 0.7162638819076994}-{'f1_val': 0.702254196980061, 'auprc': 0.7751093048049225, 'loss_val': 0.6023444187259653, 'psi': 0.7313962401100056}
[S6] START round=11 head_norm_before_train=0.885152 cos_to_last_merge=1.0000 (last merge round=10)
[S6] round=11 local utility u=0.053962 metrics={'f1_val': 0.41524424617876, 'auprc': 0.8638100972467528, 'loss_val': 0.8698263582723791, 'psi': 0.5946705866059572}-{'f1_val': 0.4150420236907487, 'auprc': 0.8432411935347391, 'loss_val': 0.9148305097233544, 'psi': 0.5863216916283449}
[S7] START round=11 head_norm_before_train=1.606235 (no previous merge yet)
[S7] round=11 local utility u=0.000000 metrics={'f1_val': 0.6688510260824905, 'auprc': 0.8013582234030507, 'loss_val': 0.49396980850698946, 'psi': 0.7218539050107147}-{'f1_val': 0.687784497887834, 'auprc': 0.842673198821276, 'loss_val': 0.39123928304012956, 'psi': 0.7497399782612109}
[S8] START round=11 head_norm_before_train=1.453843 (no previous merge yet)
[S8] round=11 local utility u=0.088842 metrics={'f1_val': 0.714267162445818, 'auprc': 0.9990503729578287, 'loss_val': 0.3681529773075005, 'psi': 0.8281804466506223}-{'f1_val': 0.7141096062959231, 'auprc': 0.9968427953859011, 'loss_val': 0.538268772527538, 'psi': 0.8272028819319144}
[S9] START round=11 head_norm_before_train=0.675669 cos_to_last_merge=1.0000 (last merge round=10)
[S9] round=11 local utility u=0.000000 metrics={'f1_val': 0.992904783397339, 'auprc': 0.9976926186082538, 'loss_val': 0.3205742028225444, 'psi': 0.994819917481705}-{'f1_val': 0.9958267183641853, 'auprc': 0.9972382953004117, 'loss_val': 0.3254157131176693, 'psi': 0.996391349138676}
[S10] START round=11 head_norm_before_train=1.207826 cos_to_last_merge=0.8906 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.891
[S10] round=11 local utility u=0.051328 metrics={'f1_val': 0.6879796234627138, 'auprc': 0.977877044273548, 'loss_val': 0.33900753410989315, 'psi': 0.8039385917870475}-{'f1_val': 0.6888514011826712, 'auprc': 0.9661225080118928, 'loss_val': 0.4116313223917015, 'psi': 0.7997598439143598}
[S11] START round=11 head_norm_before_train=0.765985 cos_to_last_merge=0.9903 (last merge round=9)
[S11] round=11 local utility u=0.070639 metrics={'f1_val': 0.7017589383281313, 'auprc': 0.9413317028398336, 'loss_val': 0.5992757276515432, 'psi': 0.7975880441328123}-{'f1_val': 0.7018246587012323, 'auprc': 0.9419402119835725, 'loss_val': 0.742773764297716, 'psi': 0.7978708800141684}
[S13] START round=11 head_norm_before_train=1.359584 (no previous merge yet)
[S13] round=11 local utility u=0.735243 metrics={'f1_val': 0.6279229430474705, 'auprc': 0.7427658418247173, 'loss_val': 0.6233476914718741, 'psi': 0.6738601025583693}-{'f1_val': 0.45445360393203005, 'auprc': 0.6450886663570233, 'loss_val': 0.7599860594796705, 'psi': 0.5307076289020274}
[S14] START round=11 head_norm_before_train=0.684239 cos_to_last_merge=1.0000 (last merge round=10)
[S14] round=11 local utility u=0.017818 metrics={'f1_val': 0.3959114419644141, 'auprc': 0.9919079832213311, 'loss_val': 0.7585075750642817, 'psi': 0.6343100584671809}-{'f1_val': 0.39659360338126215, 'auprc': 0.9945683311993321, 'loss_val': 0.8062167957474637, 'psi': 0.6357834945084901}
[S15] START round=11 head_norm_before_train=0.777406 cos_to_last_merge=1.0000 (last merge round=10)
[S15] round=11 local utility u=0.073712 metrics={'f1_val': 0.4167276561389307, 'auprc': 0.8308758481904576, 'loss_val': 0.7959697323319704, 'psi': 0.5823869329595415}-{'f1_val': 0.4167276561389307, 'auprc': 0.7997213010620237, 'loss_val': 0.8499304564526352, 'psi': 0.5699251141081678}
[S16] START round=11 head_norm_before_train=1.227618 cos_to_last_merge=0.8878 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.888
[S16] round=11 local utility u=0.000000 metrics={'f1_val': 0.44448880872907914, 'auprc': 0.7571503031434539, 'loss_val': 0.7835056549930502, 'psi': 0.5695534064948291}-{'f1_val': 0.532832667894486, 'auprc': 0.760873118379453, 'loss_val': 0.8069569089473746, 'psi': 0.6240488480884729}
[S17] START round=11 head_norm_before_train=1.048679 cos_to_last_merge=0.8483 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.848
[S17] round=11 local utility u=0.000000 metrics={'f1_val': 0.3518424223898232, 'auprc': 0.8035122343214803, 'loss_val': 0.9277108054891388, 'psi': 0.5325103471624861}-{'f1_val': 0.35243618488830136, 'auprc': 0.7955645240025364, 'loss_val': 0.8843128029789933, 'psi': 0.5296875205339954}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S6] → sending delta(kind=head bytes=1792) to S15@127.0.0.1:62415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:62402
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:62405
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:62410
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:62404
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:62407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:62410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:62414
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:62407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:62412
[S15] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1792 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1800) from S14
[S11] cosine check vs S14: cos=0.9170
[S6] RECEIVED delta(kind=head bytes=1798) from S8
[S6] cosine check vs S8: cos=0.3915
[S6] RECEIVED delta(kind=head bytes=1797) from S2
[S6] cosine check vs S2: cos=0.6759
[S9] RECEIVED delta(kind=head bytes=1798) from S11
[S9] cosine check vs S11: cos=0.8410
[S9] RECEIVED delta(kind=head bytes=1798) from S13
[S9] cosine check vs S13: cos=-0.1660
[S9] DROPPED delta from S13 (cos=-0.1660 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1801) from S4
[S5] cosine check vs S4: cos=0.7656
[S15] RECEIVED delta(kind=head bytes=1792) from S6
[S15] cosine check vs S6: cos=0.9166
[S4] RECEIVED delta(kind=head bytes=1798) from S10
[S4] cosine check vs S10: cos=0.5734
[S14] RECEIVED delta(kind=head bytes=1799) from S15
[S14] cosine check vs S15: cos=0.6649
[S2] RECEIVED delta(kind=head bytes=1798) from S3
[S2] cosine check vs S3: cos=0.9878
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=11 metric=0.7017 head_norm=0.856976
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.473248e-01
[S5] stored merged vector for next round verification (round=11)
[S5] DEBUG after merge:  round=11 metric=0.7010 head_norm=0.910210 delta_norm=0.347325
[S5] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=11 metric=0.9929 head_norm=0.794331
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.288097e-01
[S9] stored merged vector for next round verification (round=11)
[S9] DEBUG after merge:  round=11 metric=0.9925 head_norm=0.776968 delta_norm=0.228810
[S9] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=11 metric=0.3959 head_norm=0.737232
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.209943e-01
[S14] stored merged vector for next round verification (round=11)
[S14] DEBUG after merge:  round=11 metric=0.6906 head_norm=0.710736 delta_norm=0.320994
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=11 metric=0.4362 head_norm=1.078807
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.473803e-01
[S4] stored merged vector for next round verification (round=11)
[S4] DEBUG after merge:  round=11 metric=0.4371 head_norm=1.040134 delta_norm=0.547380
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=11 metric=0.7018 head_norm=0.825291
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.649318e-01
[S11] stored merged vector for next round verification (round=11)
[S11] DEBUG after merge:  round=11 metric=0.7018 head_norm=0.764922 delta_norm=0.164932
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=11 metric=0.4152 head_norm=0.916481
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.641224e-01
[S6] stored merged vector for next round verification (round=11)
[S6] DEBUG after merge:  round=11 metric=0.4152 head_norm=0.947849 delta_norm=0.364122
[S6] aggregate: ACCEPT kept=['S8', 'S2'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=11 metric=0.4167 head_norm=0.820279
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.834901e-01
[S15] stored merged vector for next round verification (round=11)
[S15] DEBUG after merge:  round=11 metric=0.4167 head_norm=0.850134 delta_norm=0.183490
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=11 metric=0.7006 head_norm=1.606400
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.469077e-01
[S2] stored merged vector for next round verification (round=11)
[S2] DEBUG after merge:  round=11 metric=0.7003 head_norm=1.668508 delta_norm=0.146908
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.668508 cos_to_last_merge=1.0000 (last merge round=11)
[S2] round=12 local utility u=0.080644 metrics={'f1_val': 0.7015542259878702, 'auprc': 0.7272015508068082, 'loss_val': 0.5110196882179131, 'psi': 0.7118131559154454}-{'f1_val': 0.7005973585876605, 'auprc': 0.7049229924329841, 'loss_val': 0.5997315468211963, 'psi': 0.7023276121257899}
[S3] START round=12 head_norm_before_train=1.740827 (no previous merge yet)
[S3] round=12 local utility u=0.126314 metrics={'f1_val': 0.9960919014420927, 'auprc': 0.9970732291264962, 'loss_val': 0.09178442917180869, 'psi': 0.9964844325158542}-{'f1_val': 0.960531351117436, 'auprc': 0.9984517140684179, 'loss_val': 0.13518435037733623, 'psi': 0.9756994962978288}
[S4] START round=12 head_norm_before_train=1.040134 cos_to_last_merge=1.0000 (last merge round=11)
[S4] round=12 local utility u=0.034974 metrics={'f1_val': 0.4422947619997381, 'auprc': 0.677008222185404, 'loss_val': 0.7053015464020495, 'psi': 0.5361801460740044}-{'f1_val': 0.4361746511612805, 'auprc': 0.6806106623232578, 'loss_val': 0.7493369916747109, 'psi': 0.5339490556260714}
[S5] START round=12 head_norm_before_train=0.910210 cos_to_last_merge=1.0000 (last merge round=11)
[S5] round=12 local utility u=0.000000 metrics={'f1_val': 0.5936041396188907, 'auprc': 0.853929107357118, 'loss_val': 0.620021814015625, 'psi': 0.6977341267141817}-{'f1_val': 0.7017260301266377, 'auprc': 0.7380706595792921, 'loss_val': 0.6382141328309454, 'psi': 0.7162638819076994}
[S6] START round=12 head_norm_before_train=0.947849 cos_to_last_merge=1.0000 (last merge round=11)
[S6] round=12 local utility u=0.023214 metrics={'f1_val': 0.41524424617876, 'auprc': 0.8646023747940619, 'loss_val': 0.825774829525788, 'psi': 0.5949874976248808}-{'f1_val': 0.41524424617876, 'auprc': 0.8638100972467528, 'loss_val': 0.8698263582723791, 'psi': 0.5946705866059572}
[S7] START round=12 head_norm_before_train=1.621930 (no previous merge yet)
[S7] round=12 local utility u=0.000000 metrics={'f1_val': 0.5872503819352122, 'auprc': 0.7845508300497561, 'loss_val': 0.7126872866503339, 'psi': 0.6661705611810298}-{'f1_val': 0.6688510260824905, 'auprc': 0.8013582234030507, 'loss_val': 0.49396980850698946, 'psi': 0.7218539050107147}
[S8] START round=12 head_norm_before_train=1.495624 (no previous merge yet)
[S8] round=12 local utility u=0.031686 metrics={'f1_val': 0.714460606093301, 'auprc': 0.9989406086882138, 'loss_val': 0.30561209034442655, 'psi': 0.8282526071312661}-{'f1_val': 0.714267162445818, 'auprc': 0.9990503729578287, 'loss_val': 0.3681529773075005, 'psi': 0.8281804466506223}
[S9] START round=12 head_norm_before_train=0.776968 cos_to_last_merge=1.0000 (last merge round=11)
[S9] round=12 local utility u=0.044911 metrics={'f1_val': 0.9924853119792197, 'auprc': 0.9988011882292241, 'loss_val': 0.2315615531750558, 'psi': 0.9950116624792215}-{'f1_val': 0.992904783397339, 'auprc': 0.9976926186082538, 'loss_val': 0.3205742028225444, 'psi': 0.994819917481705}
[S10] START round=12 head_norm_before_train=1.264589 cos_to_last_merge=0.8778 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.878
[S10] round=12 local utility u=0.037222 metrics={'f1_val': 0.6889680379787774, 'auprc': 0.9854794712247938, 'loss_val': 0.2933019455525422, 'psi': 0.8075726112771839}-{'f1_val': 0.6879796234627138, 'auprc': 0.977877044273548, 'loss_val': 0.33900753410989315, 'psi': 0.8039385917870475}
[S11] START round=12 head_norm_before_train=0.764922 cos_to_last_merge=1.0000 (last merge round=11)
[S11] round=12 local utility u=0.014993 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.941066671871889, 'loss_val': 0.5681020836003023, 'psi': 0.7974427565009106}-{'f1_val': 0.7017589383281313, 'auprc': 0.9413317028398336, 'loss_val': 0.5992757276515432, 'psi': 0.7975880441328123}
[S13] START round=12 head_norm_before_train=1.391687 (no previous merge yet)
[S13] round=12 local utility u=0.027300 metrics={'f1_val': 0.6357582726739944, 'auprc': 0.735112952700502, 'loss_val': 0.5928014420439698, 'psi': 0.6755001446845974}-{'f1_val': 0.6279229430474705, 'auprc': 0.7427658418247173, 'loss_val': 0.6233476914718741, 'psi': 0.6738601025583693}
[S14] START round=12 head_norm_before_train=0.710736 cos_to_last_merge=1.0000 (last merge round=11)
[S14] round=12 local utility u=0.880150 metrics={'f1_val': 0.6904391101408959, 'auprc': 0.9965522275894754, 'loss_val': 0.7793071162485563, 'psi': 0.8128843571203277}-{'f1_val': 0.3959114419644141, 'auprc': 0.9919079832213311, 'loss_val': 0.7585075750642817, 'psi': 0.6343100584671809}
[S15] START round=12 head_norm_before_train=0.850134 cos_to_last_merge=1.0000 (last merge round=11)
[S15] round=12 local utility u=1.000000 metrics={'f1_val': 0.8245999791734046, 'auprc': 0.9166010438160859, 'loss_val': 0.7454900412379671, 'psi': 0.8614004050304771}-{'f1_val': 0.4167276561389307, 'auprc': 0.8308758481904576, 'loss_val': 0.7959697323319704, 'psi': 0.5823869329595415}
[S16] START round=12 head_norm_before_train=1.276385 cos_to_last_merge=0.8761 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.876
[S16] round=12 local utility u=0.456863 metrics={'f1_val': 0.5649410495065914, 'auprc': 0.7959910385042329, 'loss_val': 0.7090154599247988, 'psi': 0.657361045105648}-{'f1_val': 0.44448880872907914, 'auprc': 0.7571503031434539, 'loss_val': 0.7835056549930502, 'psi': 0.5695534064948291}
[S17] START round=12 head_norm_before_train=1.093756 cos_to_last_merge=0.8293 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.829
[S17] round=12 local utility u=0.000000 metrics={'f1_val': 0.3521394294854705, 'auprc': 0.7931817978427897, 'loss_val': 0.9146351459621777, 'psi': 0.5285563768283982}-{'f1_val': 0.3518424223898232, 'auprc': 0.8035122343214803, 'loss_val': 0.9277108054891388, 'psi': 0.5325103471624861}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:62405
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:62414
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:62414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S6] → sending delta(kind=head bytes=1789) to S15@127.0.0.1:62415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:62402
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:62410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:62407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:62412
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] → sending delta(kind=head bytes=1793) to S4@127.0.0.1:62404
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] → sending delta(kind=head bytes=1805) to S6@127.0.0.1:62407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S10] → sending delta(kind=head bytes=1792) to S4@127.0.0.1:62404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:62410
[S8] sending update (kind=head size=1805 to 1 peers)
[S16] sending update (kind=head size=1793 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1792 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1804 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1789 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1803 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1800) from S14
[S11] cosine check vs S14: cos=0.8517
[S6] RECEIVED delta(kind=head bytes=1805) from S8
[S6] cosine check vs S8: cos=0.5812
[S6] RECEIVED delta(kind=head bytes=1804) from S2
[S6] cosine check vs S2: cos=0.7439
[S9] RECEIVED delta(kind=head bytes=1797) from S11
[S9] cosine check vs S11: cos=0.9363
[S9] RECEIVED delta(kind=head bytes=1803) from S13
[S9] cosine check vs S13: cos=-0.1679
[S9] DROPPED delta from S13 (cos=-0.1679 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1797) from S4
[S5] cosine check vs S4: cos=0.8275
[S15] RECEIVED delta(kind=head bytes=1789) from S6
[S15] cosine check vs S6: cos=0.8947
[S4] RECEIVED delta(kind=head bytes=1792) from S10
[S4] cosine check vs S10: cos=0.8926
[S4] RECEIVED delta(kind=head bytes=1793) from S16
[S4] cosine check vs S16: cos=0.6747
[S14] RECEIVED delta(kind=head bytes=1798) from S9
[S14] cosine check vs S9: cos=0.7344
[S14] RECEIVED delta(kind=head bytes=1799) from S15
[S14] cosine check vs S15: cos=0.8514
[S2] RECEIVED delta(kind=head bytes=1802) from S3
[S2] cosine check vs S3: cos=0.9906
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=12 metric=0.5936 head_norm=0.977539
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.080399e-01
[S5] stored merged vector for next round verification (round=12)
[S5] DEBUG after merge:  round=12 metric=0.6896 head_norm=0.987772 delta_norm=0.308040
[S5] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=12 metric=0.6904 head_norm=0.753264
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.112453e-01
[S14] stored merged vector for next round verification (round=12)
[S14] DEBUG after merge:  round=12 metric=0.6925 head_norm=0.739898 delta_norm=0.111245
[S14] aggregate: ACCEPT kept=['S9', 'S15'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=12 metric=0.9925 head_norm=0.901312
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.588229e-01
[S9] stored merged vector for next round verification (round=12)
[S9] DEBUG after merge:  round=12 metric=0.9925 head_norm=0.846265 delta_norm=0.158823
[S9] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=12 metric=0.7017 head_norm=0.818789
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.163519e-01
[S11] stored merged vector for next round verification (round=12)
[S11] DEBUG after merge:  round=12 metric=0.7017 head_norm=0.756375 delta_norm=0.216352
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=12 metric=0.4423 head_norm=1.088844
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.437165e-01
[S4] stored merged vector for next round verification (round=12)
[S4] DEBUG after merge:  round=12 metric=0.4361 head_norm=1.070762 delta_norm=0.143716
[S4] aggregate: ROLLBACK (f1_val pre=0.442 post=0.436 tol_abs=0.005 tol_rel=0.0)
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=12 metric=0.4152 head_norm=0.979354
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.108120e-01
[S6] stored merged vector for next round verification (round=12)
[S6] DEBUG after merge:  round=12 metric=0.4152 head_norm=1.050189 delta_norm=0.210812
[S6] aggregate: ACCEPT kept=['S8', 'S2'] (k=2/2) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=12 metric=0.7016 head_norm=1.708313
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.278909e-01
[S2] stored merged vector for next round verification (round=12)
[S2] DEBUG after merge:  round=12 metric=0.7016 head_norm=1.747533 delta_norm=0.127891
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=12 metric=0.8246 head_norm=0.891203
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.188425e-01
[S15] stored merged vector for next round verification (round=12)
[S15] DEBUG after merge:  round=12 metric=0.5389 head_norm=0.910382 delta_norm=0.218842
[S15] aggregate: ROLLBACK (f1_val pre=0.825 post=0.539 tol_abs=0.005 tol_rel=0.0)
[S2] START round=13 head_norm_before_train=1.747533 cos_to_last_merge=1.0000 (last merge round=12)
[S2] round=13 local utility u=0.000000 metrics={'f1_val': 0.7015730791798309, 'auprc': 0.6710634865499394, 'loss_val': 0.4291155238949994, 'psi': 0.6893692421278743}-{'f1_val': 0.7015542259878702, 'auprc': 0.7272015508068082, 'loss_val': 0.5110196882179131, 'psi': 0.7118131559154454}
[S3] START round=13 head_norm_before_train=1.795028 (no previous merge yet)
[S3] round=13 local utility u=0.000000 metrics={'f1_val': 0.9876639186070146, 'auprc': 0.99700931845161, 'loss_val': 0.07225337687144358, 'psi': 0.9914020785448527}-{'f1_val': 0.9960919014420927, 'auprc': 0.9970732291264962, 'loss_val': 0.09178442917180869, 'psi': 0.9964844325158542}
[S4] START round=13 head_norm_before_train=1.070762 cos_to_last_merge=1.0000 (last merge round=12)
[S4] round=13 local utility u=0.000000 metrics={'f1_val': 0.4286358310233086, 'auprc': 0.6688126576098217, 'loss_val': 0.6657459136923941, 'psi': 0.5247065616579139}-{'f1_val': 0.4422947619997381, 'auprc': 0.677008222185404, 'loss_val': 0.7053015464020495, 'psi': 0.5361801460740044}
[S5] START round=13 head_norm_before_train=0.987772 cos_to_last_merge=1.0000 (last merge round=12)
[S5] round=13 local utility u=0.608016 metrics={'f1_val': 0.700407554886547, 'auprc': 0.99038735993439, 'loss_val': 0.4541843110951088, 'psi': 0.8163994769056842}-{'f1_val': 0.5936041396188907, 'auprc': 0.853929107357118, 'loss_val': 0.620021814015625, 'psi': 0.6977341267141817}
[S6] START round=13 head_norm_before_train=1.050189 cos_to_last_merge=1.0000 (last merge round=12)
[S6] round=13 local utility u=0.000000 metrics={'f1_val': 0.41584976944180807, 'auprc': 0.8611878891219471, 'loss_val': 0.8443375724062263, 'psi': 0.5939850173138637}-{'f1_val': 0.41524424617876, 'auprc': 0.8646023747940619, 'loss_val': 0.825774829525788, 'psi': 0.5949874976248808}
[S7] START round=13 head_norm_before_train=1.639378 (no previous merge yet)
[S7] round=13 local utility u=0.434537 metrics={'f1_val': 0.6682453660470137, 'auprc': 0.818477095941436, 'loss_val': 0.4313629506447435, 'psi': 0.7283380580047827}-{'f1_val': 0.5872503819352122, 'auprc': 0.7845508300497561, 'loss_val': 0.7126872866503339, 'psi': 0.6661705611810298}
[S8] START round=13 head_norm_before_train=1.532377 (no previous merge yet)
[S8] round=13 local utility u=0.038247 metrics={'f1_val': 0.7164256674598257, 'auprc': 0.9993310413280834, 'loss_val': 0.24208008784142987, 'psi': 0.8295878170071288}-{'f1_val': 0.714460606093301, 'auprc': 0.9989406086882138, 'loss_val': 0.30561209034442655, 'psi': 0.8282526071312661}
[S9] START round=13 head_norm_before_train=0.846265 cos_to_last_merge=1.0000 (last merge round=12)
[S9] round=13 local utility u=0.011823 metrics={'f1_val': 0.9905518720143266, 'auprc': 0.9983882923420693, 'loss_val': 0.19507656090177636, 'psi': 0.9936864401454237}-{'f1_val': 0.9924853119792197, 'auprc': 0.9988011882292241, 'loss_val': 0.2315615531750558, 'psi': 0.9950116624792215}
[S10] START round=13 head_norm_before_train=1.315269 cos_to_last_merge=0.8679 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.868
[S10] round=13 local utility u=0.013033 metrics={'f1_val': 0.6877475656278401, 'auprc': 0.9873025781948513, 'loss_val': 0.26538323686901594, 'psi': 0.8075695706546446}-{'f1_val': 0.6889680379787774, 'auprc': 0.9854794712247938, 'loss_val': 0.2933019455525422, 'psi': 0.8075726112771839}
[S11] START round=13 head_norm_before_train=0.756375 cos_to_last_merge=1.0000 (last merge round=12)
[S11] round=13 local utility u=0.076115 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.997995070429677, 'loss_val': 0.5881087280473386, 'psi': 0.8203592181508628}-{'f1_val': 0.7016934795869249, 'auprc': 0.941066671871889, 'loss_val': 0.5681020836003023, 'psi': 0.7974427565009106}
[S13] START round=13 head_norm_before_train=1.418235 (no previous merge yet)
[S13] round=13 local utility u=0.000000 metrics={'f1_val': 0.6353845243837039, 'auprc': 0.7132661075226014, 'loss_val': 0.5303166318437977, 'psi': 0.6665371576392629}-{'f1_val': 0.6357582726739944, 'auprc': 0.735112952700502, 'loss_val': 0.5928014420439698, 'psi': 0.6755001446845974}
[S14] START round=13 head_norm_before_train=0.739898 cos_to_last_merge=1.0000 (last merge round=12)
[S14] round=13 local utility u=0.067540 metrics={'f1_val': 0.6921021147308503, 'auprc': 0.9966559207820667, 'loss_val': 0.6545171572283216, 'psi': 0.8139236371513369}-{'f1_val': 0.6904391101408959, 'auprc': 0.9965522275894754, 'loss_val': 0.7793071162485563, 'psi': 0.8128843571203277}
[S15] START round=13 head_norm_before_train=0.910382 cos_to_last_merge=1.0000 (last merge round=12)
[S15] round=13 local utility u=0.129820 metrics={'f1_val': 0.860193047413021, 'auprc': 0.9091256698574304, 'loss_val': 0.6769833205707558, 'psi': 0.8797660963907847}-{'f1_val': 0.8245999791734046, 'auprc': 0.9166010438160859, 'loss_val': 0.7454900412379671, 'psi': 0.8614004050304771}
[S16] START round=13 head_norm_before_train=1.324947 cos_to_last_merge=0.8663 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.866
[S16] round=13 local utility u=1.000000 metrics={'f1_val': 0.8548185123949076, 'auprc': 0.859452674741712, 'loss_val': 0.5972997056492091, 'psi': 0.8566721773336294}-{'f1_val': 0.5649410495065914, 'auprc': 0.7959910385042329, 'loss_val': 0.7090154599247988, 'psi': 0.657361045105648}
[S17] START round=13 head_norm_before_train=1.124640 cos_to_last_merge=0.8164 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.816
[S17] round=13 local utility u=0.000000 metrics={'f1_val': 0.3534728608424502, 'auprc': 0.7425901089535247, 'loss_val': 0.9001063096934137, 'psi': 0.50911976008688}-{'f1_val': 0.3521394294854705, 'auprc': 0.7931817978427897, 'loss_val': 0.9146351459621777, 'psi': 0.5285563768283982}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:62414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:62407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:62410
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:62414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:62412
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:62407
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] → sending delta(kind=head bytes=1793) to S4@127.0.0.1:62404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:62404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:62410
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S16] sending update (kind=head size=1793 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1798) from S14
[S11] cosine check vs S14: cos=0.9618
[S6] RECEIVED delta(kind=head bytes=1802) from S8
[S6] cosine check vs S8: cos=0.6327
[S6] RECEIVED delta(kind=head bytes=1801) from S7
[S6] cosine check vs S7: cos=0.2182
[S9] RECEIVED delta(kind=head bytes=1798) from S11
[S9] cosine check vs S11: cos=0.9118
[S9] RECEIVED delta(kind=head bytes=1797) from S5
[S9] cosine check vs S5: cos=0.0482
[S4] RECEIVED delta(kind=head bytes=1802) from S10
[S4] cosine check vs S10: cos=0.8501
[S4] RECEIVED delta(kind=head bytes=1793) from S16
[S4] cosine check vs S16: cos=0.7432
[S14] RECEIVED delta(kind=head bytes=1799) from S9
[S14] cosine check vs S9: cos=0.8384
[S14] RECEIVED delta(kind=head bytes=1800) from S15
[S14] cosine check vs S15: cos=0.7558
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=13 metric=0.4158 head_norm=1.074645
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.900752e-01
[S6] stored merged vector for next round verification (round=13)
[S6] DEBUG after merge:  round=13 metric=0.4158 head_norm=0.983643 delta_norm=0.490075
[S6] aggregate: ACCEPT kept=['S8', 'S7'] (k=2/2) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=13 metric=0.4286 head_norm=1.119433
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.058111e-01
[S4] stored merged vector for next round verification (round=13)
[S4] DEBUG after merge:  round=13 metric=0.4286 head_norm=1.107114 delta_norm=0.105811
[S4] aggregate: ACCEPT kept=['S10', 'S16'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=13 metric=0.6921 head_norm=0.788306
[S14] _apply_head_vector_avg (torch): Δ‖w‖=9.696718e-02
[S14] stored merged vector for next round verification (round=13)
[S14] DEBUG after merge:  round=13 metric=0.6917 head_norm=0.780109 delta_norm=0.096967
[S14] aggregate: ACCEPT kept=['S9', 'S15'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=13 metric=0.9906 head_norm=0.955546
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.951343e-01
[S9] stored merged vector for next round verification (round=13)
[S9] DEBUG after merge:  round=13 metric=0.9906 head_norm=0.727572 delta_norm=0.395134
[S9] aggregate: ACCEPT kept=['S11', 'S5'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=13 metric=0.7019 head_norm=0.801221
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.100354e-01
[S11] stored merged vector for next round verification (round=13)
[S11] DEBUG after merge:  round=13 metric=0.6969 head_norm=0.787136 delta_norm=0.110035
[S11] aggregate: ROLLBACK (f1_val pre=0.702 post=0.697 tol_abs=0.005 tol_rel=0.0)
[S2] START round=14 head_norm_before_train=1.784936 cos_to_last_merge=0.9989 (last merge round=12)
[S2] round=14 local utility u=0.025718 metrics={'f1_val': 0.7015710590385817, 'auprc': 0.6621811374942052, 'loss_val': 0.35101939251722897, 'psi': 0.6858150904208311}-{'f1_val': 0.7015730791798309, 'auprc': 0.6710634865499394, 'loss_val': 0.4291155238949994, 'psi': 0.6893692421278743}
[S3] START round=14 head_norm_before_train=1.848360 (no previous merge yet)
[S3] round=14 local utility u=0.000000 metrics={'f1_val': 0.960995754132836, 'auprc': 0.9970748659396631, 'loss_val': 0.10050245905105878, 'psi': 0.9754273988555668}-{'f1_val': 0.9876639186070146, 'auprc': 0.99700931845161, 'loss_val': 0.07225337687144358, 'psi': 0.9914020785448527}
[S4] START round=14 head_norm_before_train=1.107114 cos_to_last_merge=1.0000 (last merge round=13)
[S4] round=14 local utility u=0.309822 metrics={'f1_val': 0.42781940350539, 'auprc': 0.8687502147496998, 'loss_val': 0.6410164605934021, 'psi': 0.6041917280031139}-{'f1_val': 0.4286358310233086, 'auprc': 0.6688126576098217, 'loss_val': 0.6657459136923941, 'psi': 0.5247065616579139}
[S5] START round=14 head_norm_before_train=1.048831 cos_to_last_merge=0.9922 (last merge round=12)
[S5] round=14 local utility u=0.000000 metrics={'f1_val': 0.6753692437926444, 'auprc': 0.8539202943156332, 'loss_val': 0.5025151625489378, 'psi': 0.7467896640018399}-{'f1_val': 0.700407554886547, 'auprc': 0.99038735993439, 'loss_val': 0.4541843110951088, 'psi': 0.8163994769056842}
[S6] START round=14 head_norm_before_train=0.983643 cos_to_last_merge=1.0000 (last merge round=13)
[S6] round=14 local utility u=0.029152 metrics={'f1_val': 0.4150420236907487, 'auprc': 0.8643042697763028, 'loss_val': 0.7905369524759721, 'psi': 0.5947469221249704}-{'f1_val': 0.41584976944180807, 'auprc': 0.8611878891219471, 'loss_val': 0.8443375724062263, 'psi': 0.5939850173138637}
[S7] START round=14 head_norm_before_train=1.655334 (no previous merge yet)
[S7] round=14 local utility u=0.000000 metrics={'f1_val': 0.6140152241985598, 'auprc': 0.7957157095219658, 'loss_val': 0.5909012812822121, 'psi': 0.6866954183279221}-{'f1_val': 0.6682453660470137, 'auprc': 0.818477095941436, 'loss_val': 0.4313629506447435, 'psi': 0.7283380580047827}
[S8] START round=14 head_norm_before_train=1.568617 (no previous merge yet)
[S8] round=14 local utility u=0.004344 metrics={'f1_val': 0.7141742661762565, 'auprc': 0.9993144114322728, 'loss_val': 0.21983399123930397, 'psi': 0.828230324278663}-{'f1_val': 0.7164256674598257, 'auprc': 0.9993310413280834, 'loss_val': 0.24208008784142987, 'psi': 0.8295878170071288}
[S9] START round=14 head_norm_before_train=0.727572 cos_to_last_merge=1.0000 (last merge round=13)
[S9] round=14 local utility u=0.000000 metrics={'f1_val': 0.9955763922175147, 'auprc': 0.9945629356637079, 'loss_val': 0.26921022499885044, 'psi': 0.995171009595992}-{'f1_val': 0.9905518720143266, 'auprc': 0.9983882923420693, 'loss_val': 0.19507656090177636, 'psi': 0.9936864401454237}
[S10] START round=14 head_norm_before_train=1.358086 cos_to_last_merge=0.8614 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.861
[S10] round=14 local utility u=0.062919 metrics={'f1_val': 0.6994347117202335, 'auprc': 0.99502942147319, 'loss_val': 0.23284859520199153, 'psi': 0.8176725956214161}-{'f1_val': 0.6877475656278401, 'auprc': 0.9873025781948513, 'loss_val': 0.26538323686901594, 'psi': 0.8075695706546446}
[S11] START round=14 head_norm_before_train=0.787136 cos_to_last_merge=1.0000 (last merge round=13)
[S11] round=14 local utility u=0.022885 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9974391560200458, 'loss_val': 0.5392190871046538, 'psi': 0.8199917501601732}-{'f1_val': 0.7019353166316534, 'auprc': 0.997995070429677, 'loss_val': 0.5881087280473386, 'psi': 0.8203592181508628}
[S13] START round=14 head_norm_before_train=1.442408 (no previous merge yet)
[S13] round=14 local utility u=0.188997 metrics={'f1_val': 0.7061821304012261, 'auprc': 0.6729988709304843, 'loss_val': 0.45630589937578336, 'psi': 0.6929088266129294}-{'f1_val': 0.6353845243837039, 'auprc': 0.7132661075226014, 'loss_val': 0.5303166318437977, 'psi': 0.6665371576392629}
[S14] START round=14 head_norm_before_train=0.780109 cos_to_last_merge=1.0000 (last merge round=13)
[S14] round=14 local utility u=0.044839 metrics={'f1_val': 0.6920995131601254, 'auprc': 0.9967070901938055, 'loss_val': 0.5649767208699784, 'psi': 0.8139425439735974}-{'f1_val': 0.6921021147308503, 'auprc': 0.9966559207820667, 'loss_val': 0.6545171572283216, 'psi': 0.8139236371513369}
[S15] START round=14 head_norm_before_train=0.951247 cos_to_last_merge=0.9956 (last merge round=12)
[S15] round=14 local utility u=0.314935 metrics={'f1_val': 0.9037110035274143, 'auprc': 0.9832294620685229, 'loss_val': 0.5305319497809521, 'psi': 0.9355183869438577}-{'f1_val': 0.860193047413021, 'auprc': 0.9091256698574304, 'loss_val': 0.6769833205707558, 'psi': 0.8797660963907847}
[S16] START round=14 head_norm_before_train=1.366228 cos_to_last_merge=0.8589 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.859
[S16] round=14 local utility u=0.149806 metrics={'f1_val': 0.8426631636240449, 'auprc': 0.9210459196646379, 'loss_val': 0.40953466371697456, 'psi': 0.8740162660402822}-{'f1_val': 0.8548185123949076, 'auprc': 0.859452674741712, 'loss_val': 0.5972997056492091, 'psi': 0.8566721773336294}
[S17] START round=14 head_norm_before_train=1.146892 cos_to_last_merge=0.8076 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.808
[S17] round=14 local utility u=0.000000 metrics={'f1_val': 0.35671145533799914, 'auprc': 0.7202807559499661, 'loss_val': 0.8692679528523269, 'psi': 0.502139175582786}-{'f1_val': 0.3534728608424502, 'auprc': 0.7425901089535247, 'loss_val': 0.9001063096934137, 'psi': 0.50911976008688}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:62404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:62407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S16] → sending delta(kind=head bytes=1789) to S4@127.0.0.1:62404
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] → sending delta(kind=head bytes=1794) to S15@127.0.0.1:62415
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:62407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:62405
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:62414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:62410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:62412
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:62410
[S11] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[S4] sending update (kind=head size=1794 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1794 to 1 peers)
[S16] sending update (kind=head size=1789 to 1 peers)
[S2] sending update (kind=head size=1803 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1799) from S14
[S11] cosine check vs S14: cos=0.9795
[S6] RECEIVED delta(kind=head bytes=1801) from S8
[S6] cosine check vs S8: cos=0.7182
[S6] RECEIVED delta(kind=head bytes=1803) from S2
[S6] cosine check vs S2: cos=0.4642
[S9] RECEIVED delta(kind=head bytes=1803) from S11
[S9] cosine check vs S11: cos=0.8642
[S5] RECEIVED delta(kind=head bytes=1794) from S4
[S5] cosine check vs S4: cos=0.9130
[S15] RECEIVED delta(kind=head bytes=1794) from S6
[S15] cosine check vs S6: cos=0.8824
[S4] RECEIVED delta(kind=head bytes=1789) from S16
[S4] cosine check vs S16: cos=0.7749
[S4] RECEIVED delta(kind=head bytes=1798) from S10
[S4] cosine check vs S10: cos=0.8285
[S14] RECEIVED delta(kind=head bytes=1803) from S15
[S14] cosine check vs S15: cos=0.7714
[S9] RECEIVED delta(kind=head bytes=1799) from S13
[S9] cosine check vs S13: cos=-0.1783
[S9] DROPPED delta from S13 (cos=-0.1783 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=14 metric=0.6754 head_norm=1.113475
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.368514e-01
[S5] stored merged vector for next round verification (round=14)
[S5] DEBUG after merge:  round=14 metric=0.7006 head_norm=1.107094 delta_norm=0.236851
[S5] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=14 metric=0.9956 head_norm=0.829363
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.154126e-01
[S9] stored merged vector for next round verification (round=14)
[S9] DEBUG after merge:  round=14 metric=0.9947 head_norm=0.798137 delta_norm=0.215413
[S9] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=14 metric=0.4150 head_norm=1.013072
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.503941e-01
[S6] stored merged vector for next round verification (round=14)
[S6] DEBUG after merge:  round=14 metric=0.4150 head_norm=1.064902 delta_norm=0.350394
[S6] aggregate: ACCEPT kept=['S8', 'S2'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=14 metric=0.7017 head_norm=0.824019
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.357894e-02
[S11] stored merged vector for next round verification (round=14)
[S11] DEBUG after merge:  round=14 metric=0.7017 head_norm=0.821341 delta_norm=0.083579
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=14 metric=0.6921 head_norm=0.827143
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.195055e-01
[S14] stored merged vector for next round verification (round=14)
[S14] DEBUG after merge:  round=14 metric=0.6917 head_norm=0.860488 delta_norm=0.319506
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=14 metric=0.4278 head_norm=1.150516
[S4] _apply_head_vector_avg (torch): Δ‖w‖=8.728250e-02
[S4] stored merged vector for next round verification (round=14)
[S4] DEBUG after merge:  round=14 metric=0.6806 head_norm=1.139773 delta_norm=0.087283
[S4] aggregate: ACCEPT kept=['S16', 'S10'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=14 metric=0.9037 head_norm=1.000440
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.441937e-01
[S15] stored merged vector for next round verification (round=14)
[S15] DEBUG after merge:  round=14 metric=0.9443 head_norm=0.976712 delta_norm=0.244194
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.822724 cos_to_last_merge=0.9963 (last merge round=12)
[S2] round=15 local utility u=0.018650 metrics={'f1_val': 0.7015710590385817, 'auprc': 0.6613132409425408, 'loss_val': 0.31111477338042415, 'psi': 0.6854679318001653}-{'f1_val': 0.7015710590385817, 'auprc': 0.6621811374942052, 'loss_val': 0.35101939251722897, 'psi': 0.6858150904208311}
[S3] START round=15 head_norm_before_train=1.894629 (no previous merge yet)
[S3] round=15 local utility u=0.000000 metrics={'f1_val': 0.960531351117436, 'auprc': 0.9983344523652593, 'loss_val': 0.11054421376481237, 'psi': 0.9756525916165654}-{'f1_val': 0.960995754132836, 'auprc': 0.9970748659396631, 'loss_val': 0.10050245905105878, 'psi': 0.9754273988555668}
[S4] START round=15 head_norm_before_train=1.139773 cos_to_last_merge=1.0000 (last merge round=14)
[S4] round=15 local utility u=0.163613 metrics={'f1_val': 0.4900434329764179, 'auprc': 0.8514078924595644, 'loss_val': 0.6351070130815857, 'psi': 0.6345892167696765}-{'f1_val': 0.42781940350539, 'auprc': 0.8687502147496998, 'loss_val': 0.6410164605934021, 'psi': 0.6041917280031139}
[S5] START round=15 head_norm_before_train=1.107094 cos_to_last_merge=1.0000 (last merge round=14)
[S5] round=15 local utility u=0.108711 metrics={'f1_val': 0.7004809549016324, 'auprc': 0.8593130467365733, 'loss_val': 0.4519420853867072, 'psi': 0.7640137916356088}-{'f1_val': 0.6753692437926444, 'auprc': 0.8539202943156332, 'loss_val': 0.5025151625489378, 'psi': 0.7467896640018399}
[S6] START round=15 head_norm_before_train=1.064902 cos_to_last_merge=1.0000 (last merge round=14)
[S6] round=15 local utility u=0.000000 metrics={'f1_val': 0.3769815962776316, 'auprc': 0.86225787677291, 'loss_val': 0.7974101067203676, 'psi': 0.571092108475743}-{'f1_val': 0.4150420236907487, 'auprc': 0.8643042697763028, 'loss_val': 0.7905369524759721, 'psi': 0.5947469221249704}
[S7] START round=15 head_norm_before_train=1.667345 (no previous merge yet)
[S7] round=15 local utility u=0.000000 metrics={'f1_val': 0.5814235873378322, 'auprc': 0.7895128136198453, 'loss_val': 0.7293326952549962, 'psi': 0.6646592778506375}-{'f1_val': 0.6140152241985598, 'auprc': 0.7957157095219658, 'loss_val': 0.5909012812822121, 'psi': 0.6866954183279221}
[S8] START round=15 head_norm_before_train=1.601598 (no previous merge yet)
[S8] round=15 local utility u=0.885152 metrics={'f1_val': 0.9963743336862869, 'auprc': 0.9993039752198309, 'loss_val': 0.14269891960139997, 'psi': 0.9975461902997045}-{'f1_val': 0.7141742661762565, 'auprc': 0.9993144114322728, 'loss_val': 0.21983399123930397, 'psi': 0.828230324278663}
[S9] START round=15 head_norm_before_train=0.798137 cos_to_last_merge=1.0000 (last merge round=14)
[S9] round=15 local utility u=0.036706 metrics={'f1_val': 0.9964101856672208, 'auprc': 0.9928421877465619, 'loss_val': 0.19563774978932055, 'psi': 0.9949829864989572}-{'f1_val': 0.9955763922175147, 'auprc': 0.9945629356637079, 'loss_val': 0.26921022499885044, 'psi': 0.995171009595992}
[S10] START round=15 head_norm_before_train=1.392644 cos_to_last_merge=0.8570 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.857
[S10] round=15 local utility u=0.905414 metrics={'f1_val': 0.9944887801351068, 'auprc': 0.9977520321454101, 'loss_val': 0.20051325699843509, 'psi': 0.995794080939228}-{'f1_val': 0.6994347117202335, 'auprc': 0.99502942147319, 'loss_val': 0.23284859520199153, 'psi': 0.8176725956214161}
[S11] START round=15 head_norm_before_train=0.821341 cos_to_last_merge=1.0000 (last merge round=14)
[S11] round=15 local utility u=0.000000 metrics={'f1_val': 0.6962479738174547, 'auprc': 0.9983822975896524, 'loss_val': 0.5428228663538481, 'psi': 0.8171017033263338}-{'f1_val': 0.7016934795869249, 'auprc': 0.9974391560200458, 'loss_val': 0.5392190871046538, 'psi': 0.8199917501601732}
[S13] START round=15 head_norm_before_train=1.469715 (no previous merge yet)
[S13] round=15 local utility u=0.000000 metrics={'f1_val': 0.609377809086638, 'auprc': 0.6278826228508835, 'loss_val': 0.6492646270580698, 'psi': 0.6167797345923363}-{'f1_val': 0.7061821304012261, 'auprc': 0.6729988709304843, 'loss_val': 0.45630589937578336, 'psi': 0.6929088266129294}
[S14] START round=15 head_norm_before_train=0.860488 cos_to_last_merge=1.0000 (last merge round=14)
[S14] round=15 local utility u=0.883019 metrics={'f1_val': 0.9943400494696847, 'auprc': 0.9966290611126424, 'loss_val': 0.6121470524614911, 'psi': 0.9952556541268678}-{'f1_val': 0.6920995131601254, 'auprc': 0.9967070901938055, 'loss_val': 0.5649767208699784, 'psi': 0.8139425439735974}
[S15] START round=15 head_norm_before_train=0.976712 cos_to_last_merge=1.0000 (last merge round=14)
[S15] round=15 local utility u=0.000000 metrics={'f1_val': 0.8245987229023363, 'auprc': 0.9335357117546902, 'loss_val': 0.536132574047652, 'psi': 0.8681735184432778}-{'f1_val': 0.9037110035274143, 'auprc': 0.9832294620685229, 'loss_val': 0.5305319497809521, 'psi': 0.9355183869438577}
[S16] START round=15 head_norm_before_train=1.408184 cos_to_last_merge=0.8524 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.852
[S16] round=15 local utility u=0.261427 metrics={'f1_val': 0.9102116472224417, 'auprc': 0.9529693994857061, 'loss_val': 0.38774251553311867, 'psi': 0.9273147481277475}-{'f1_val': 0.8426631636240449, 'auprc': 0.9210459196646379, 'loss_val': 0.40953466371697456, 'psi': 0.8740162660402822}
[S17] START round=15 head_norm_before_train=1.168386 cos_to_last_merge=0.7996 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.800
[S17] round=15 local utility u=0.116088 metrics={'f1_val': 0.36545585449033724, 'auprc': 0.7491028017340798, 'loss_val': 0.7760252674576145, 'psi': 0.5189146333878343}-{'f1_val': 0.35671145533799914, 'auprc': 0.7202807559499661, 'loss_val': 0.8692679528523269, 'psi': 0.502139175582786}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] → sending delta(kind=head bytes=1793) to S4@127.0.0.1:62404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:62405
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:62404
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:62407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:62410
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:62412
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:62414
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:62407
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1795 to 1 peers)
[S16] sending update (kind=head size=1793 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1801) from S14
[S11] cosine check vs S14: cos=0.9082
[S6] RECEIVED delta(kind=head bytes=1802) from S2
[S6] cosine check vs S2: cos=0.6480
[S6] RECEIVED delta(kind=head bytes=1799) from S8
[S6] cosine check vs S8: cos=0.7131
[S9] RECEIVED delta(kind=head bytes=1799) from S5
[S9] cosine check vs S5: cos=0.1453
[S5] RECEIVED delta(kind=head bytes=1795) from S4
[S5] cosine check vs S4: cos=0.9610
[S4] RECEIVED delta(kind=head bytes=1801) from S10
[S4] cosine check vs S10: cos=0.8176
[S4] RECEIVED delta(kind=head bytes=1793) from S16
[S4] cosine check vs S16: cos=0.7910
[S14] RECEIVED delta(kind=head bytes=1800) from S9
[S14] cosine check vs S9: cos=0.7605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:62405
[S17] sending update (kind=head size=1798 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1798) from S17
[S5] cosine check vs S17: cos=0.3039
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=15 metric=0.6962 head_norm=0.863997
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.887186e-01
[S11] stored merged vector for next round verification (round=15)
[S11] DEBUG after merge:  round=15 metric=0.6634 head_norm=0.858172 delta_norm=0.188719
[S11] aggregate: ROLLBACK (f1_val pre=0.696 post=0.663 tol_abs=0.005 tol_rel=0.0)
[S11] ⇄ pheromone p=0.155 → S9@127.0.0.1:62410
[S7] ⇄ pheromone p=0.209 → S6@127.0.0.1:62407
[S3] ⇄ pheromone p=0.158 → S2@127.0.0.1:62402
[S13] ⇄ pheromone p=0.179 → S9@127.0.0.1:62410
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=15 metric=0.3770 head_norm=1.092990
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.912108e-01
[S6] stored merged vector for next round verification (round=15)
[S6] DEBUG after merge:  round=15 metric=0.3614 head_norm=1.154096 delta_norm=0.191211
[S6] aggregate: ROLLBACK (f1_val pre=0.377 post=0.361 tol_abs=0.005 tol_rel=0.0)
[S6] ⇄ pheromone p=0.083 → S15@127.0.0.1:62415
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=15 metric=0.9964 head_norm=0.922022
[S9] _apply_head_vector_avg (torch): Δ‖w‖=6.843804e-01
[S9] stored merged vector for next round verification (round=15)
[S9] DEBUG after merge:  round=15 metric=0.9964 head_norm=0.789296 delta_norm=0.684380
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.142 → S14@127.0.0.1:62414
[S2] ⇄ pheromone p=0.151 → S6@127.0.0.1:62407
[S8] ⇄ pheromone p=0.336 → S6@127.0.0.1:62407
[S16] ⇄ pheromone p=0.333 → S4@127.0.0.1:62404
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=15 metric=0.4900 head_norm=1.183853
[S4] _apply_head_vector_avg (torch): Δ‖w‖=7.812224e-02
[S4] stored merged vector for next round verification (round=15)
[S4] DEBUG after merge:  round=15 metric=0.6157 head_norm=1.171284 delta_norm=0.078122
[S4] aggregate: ACCEPT kept=['S10', 'S16'] (k=2/2) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.162 → S5@127.0.0.1:62405
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=15 metric=0.7005 head_norm=1.154384
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.352477e-01
[S5] stored merged vector for next round verification (round=15)
[S5] DEBUG after merge:  round=15 metric=0.7007 head_norm=0.988111 delta_norm=0.335248
[S5] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.200 → S9@127.0.0.1:62410
[S10] ⇄ pheromone p=0.336 → S4@127.0.0.1:62404
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=15 metric=0.9943 head_norm=0.893117
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.143702e-01
[S14] stored merged vector for next round verification (round=15)
[S14] DEBUG after merge:  round=15 metric=0.9794 head_norm=0.851506 delta_norm=0.314370
[S14] aggregate: ROLLBACK (f1_val pre=0.994 post=0.979 tol_abs=0.005 tol_rel=0.0)
[S14] ⇄ pheromone p=0.375 → S11@127.0.0.1:62412
[S15] ⇄ pheromone p=0.252 → S14@127.0.0.1:62414
[S17] ⇄ pheromone p=0.113 → S5@127.0.0.1:62405
[S2] START round=16 head_norm_before_train=1.857576 cos_to_last_merge=0.9934 (last merge round=12)
[S2] round=16 local utility u=0.014040 metrics={'f1_val': 0.7013101313728686, 'auprc': 0.6683962431361838, 'loss_val': 0.30271884616095873, 'psi': 0.6881445760781947}-{'f1_val': 0.7015710590385817, 'auprc': 0.6613132409425408, 'loss_val': 0.31111477338042415, 'psi': 0.6854679318001653}
[S3] START round=16 head_norm_before_train=1.942062 (no previous merge yet)
[S3] round=16 local utility u=0.149251 metrics={'f1_val': 0.9973696976584205, 'auprc': 0.9986900496774619, 'loss_val': 0.03413997334171146, 'psi': 0.9978978384660371}-{'f1_val': 0.960531351117436, 'auprc': 0.9983344523652593, 'loss_val': 0.11054421376481237, 'psi': 0.9756525916165654}
[S4] START round=16 head_norm_before_train=1.171284 cos_to_last_merge=1.0000 (last merge round=15)
[S4] round=16 local utility u=0.393244 metrics={'f1_val': 0.6163744872931695, 'auprc': 0.8509235132874465, 'loss_val': 0.6051517215104314, 'psi': 0.7101940976908803}-{'f1_val': 0.4900434329764179, 'auprc': 0.8514078924595644, 'loss_val': 0.6351070130815857, 'psi': 0.6345892167696765}
[S5] START round=16 head_norm_before_train=0.988111 cos_to_last_merge=1.0000 (last merge round=15)
[S5] round=16 local utility u=0.000000 metrics={'f1_val': 0.7004809549016324, 'auprc': 0.8553360422564663, 'loss_val': 0.4794328721478012, 'psi': 0.7624229898435659}-{'f1_val': 0.7004809549016324, 'auprc': 0.8593130467365733, 'loss_val': 0.4519420853867072, 'psi': 0.7640137916356088}
[S6] START round=16 head_norm_before_train=1.154096 cos_to_last_merge=1.0000 (last merge round=15)
[S6] round=16 local utility u=0.198158 metrics={'f1_val': 0.4285831517763639, 'auprc': 0.8566118062538993, 'loss_val': 0.6937657961272423, 'psi': 0.5997946135673781}-{'f1_val': 0.3769815962776316, 'auprc': 0.86225787677291, 'loss_val': 0.7974101067203676, 'psi': 0.571092108475743}
[S7] START round=16 head_norm_before_train=1.684702 (no previous merge yet)
[S7] round=16 local utility u=0.031255 metrics={'f1_val': 0.5875953865498, 'auprc': 0.788567543961506, 'loss_val': 0.7010181269783342, 'psi': 0.6679842495144824}-{'f1_val': 0.5814235873378322, 'auprc': 0.7895128136198453, 'loss_val': 0.7293326952549962, 'psi': 0.6646592778506375}
[S8] START round=16 head_norm_before_train=1.635922 (no previous merge yet)
[S8] round=16 local utility u=0.008843 metrics={'f1_val': 0.9952430317747349, 'auprc': 0.9992181921052394, 'loss_val': 0.11796738266943352, 'psi': 0.9968330959069368}-{'f1_val': 0.9963743336862869, 'auprc': 0.9993039752198309, 'loss_val': 0.14269891960139997, 'psi': 0.9975461902997045}
[S9] START round=16 head_norm_before_train=0.789296 cos_to_last_merge=1.0000 (last merge round=15)
[S9] round=16 local utility u=0.000000 metrics={'f1_val': 0.9905518720143266, 'auprc': 0.994932218943179, 'loss_val': 0.3727480027314738, 'psi': 0.9923040107858676}-{'f1_val': 0.9964101856672208, 'auprc': 0.9928421877465619, 'loss_val': 0.19563774978932055, 'psi': 0.9949829864989572}
[S10] START round=16 head_norm_before_train=1.419963 cos_to_last_merge=0.8540 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.854
[S10] round=16 local utility u=0.000000 metrics={'f1_val': 0.9928754659835478, 'auprc': 0.9973745797575198, 'loss_val': 0.20385853123130943, 'psi': 0.9946751114931366}-{'f1_val': 0.9944887801351068, 'auprc': 0.9977520321454101, 'loss_val': 0.20051325699843509, 'psi': 0.995794080939228}
[S11] START round=16 head_norm_before_train=0.858172 cos_to_last_merge=1.0000 (last merge round=15)
[S11] round=16 local utility u=0.048689 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9978477299918531, 'loss_val': 0.4765136800273284, 'psi': 0.8201551797488962}-{'f1_val': 0.6962479738174547, 'auprc': 0.9983822975896524, 'loss_val': 0.5428228663538481, 'psi': 0.8171017033263338}
[S13] START round=16 head_norm_before_train=1.490293 (no previous merge yet)
[S13] round=16 local utility u=0.152350 metrics={'f1_val': 0.625455380126803, 'auprc': 0.6717410257692792, 'loss_val': 0.5726055394464074, 'psi': 0.6439696383837935}-{'f1_val': 0.609377809086638, 'auprc': 0.6278826228508835, 'loss_val': 0.6492646270580698, 'psi': 0.6167797345923363}
[S14] START round=16 head_norm_before_train=0.851506 cos_to_last_merge=1.0000 (last merge round=15)
[S14] round=16 local utility u=0.101036 metrics={'f1_val': 0.9970336855150863, 'auprc': 0.9965439310752876, 'loss_val': 0.42598179892511306, 'psi': 0.9968377837391669}-{'f1_val': 0.9943400494696847, 'auprc': 0.9966290611126424, 'loss_val': 0.6121470524614911, 'psi': 0.9952556541268678}
[S15] START round=16 head_norm_before_train=1.020109 cos_to_last_merge=0.9975 (last merge round=14)
[S15] round=16 local utility u=0.000000 metrics={'f1_val': 0.6985460078543178, 'auprc': 0.7996378979819532, 'loss_val': 0.5375586966605741, 'psi': 0.7389827639053719}-{'f1_val': 0.8245987229023363, 'auprc': 0.9335357117546902, 'loss_val': 0.536132574047652, 'psi': 0.8681735184432778}
[S16] START round=16 head_norm_before_train=1.449388 cos_to_last_merge=0.8469 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.847
[S16] round=16 local utility u=0.000000 metrics={'f1_val': 0.8516473148077313, 'auprc': 0.9725776765912619, 'loss_val': 0.6022194483126962, 'psi': 0.9000194595211435}-{'f1_val': 0.9102116472224417, 'auprc': 0.9529693994857061, 'loss_val': 0.38774251553311867, 'psi': 0.9273147481277475}
[S17] START round=16 head_norm_before_train=1.181996 cos_to_last_merge=0.7941 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.794
[S17] round=16 local utility u=0.150659 metrics={'f1_val': 0.38115149454003605, 'auprc': 0.8002381272663481, 'loss_val': 0.7222862988320381, 'psi': 0.5487861476305609}-{'f1_val': 0.36545585449033724, 'auprc': 0.7491028017340798, 'loss_val': 0.7760252674576145, 'psi': 0.5189146333878343}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:62415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:62402
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:62407
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:62405
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:62410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:62407
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:62410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:62412
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:62407
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1801) from S14
[S11] cosine check vs S14: cos=0.9749
[S6] RECEIVED delta(kind=head bytes=1803) from S2
[S6] cosine check vs S2: cos=0.7080
[S6] RECEIVED delta(kind=head bytes=1802) from S8
[S6] cosine check vs S8: cos=0.6888
[S6] RECEIVED delta(kind=head bytes=1801) from S7
[S6] cosine check vs S7: cos=0.1880
[S9] RECEIVED delta(kind=head bytes=1798) from S11
[S9] cosine check vs S11: cos=0.5815
[S9] RECEIVED delta(kind=head bytes=1800) from S13
[S9] cosine check vs S13: cos=-0.1561
[S9] DROPPED delta from S13 (cos=-0.1561 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1798) from S4
[S5] cosine check vs S4: cos=0.9077
[S15] RECEIVED delta(kind=head bytes=1800) from S6
[S15] cosine check vs S6: cos=0.8873
[S2] RECEIVED delta(kind=head bytes=1796) from S3
[S2] cosine check vs S3: cos=0.9716
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:62405
[S17] sending update (kind=head size=1797 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1797) from S17
[S5] cosine check vs S17: cos=0.5407
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=16 metric=0.9906 head_norm=0.869282
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.040764e-01
[S9] stored merged vector for next round verification (round=16)
[S9] DEBUG after merge:  round=16 metric=0.9905 head_norm=0.785127 delta_norm=0.404076
[S9] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=16 metric=0.6985 head_norm=1.065588
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.716772e-01
[S15] stored merged vector for next round verification (round=16)
[S15] DEBUG after merge:  round=16 metric=0.6996 head_norm=1.089500 delta_norm=0.271677
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=16 metric=0.7005 head_norm=1.031998
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.871348e-01
[S5] stored merged vector for next round verification (round=16)
[S5] DEBUG after merge:  round=16 metric=0.7007 head_norm=0.966183 delta_norm=0.187135
[S5] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=16 metric=0.7013 head_norm=1.887759
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.347068e-01
[S2] stored merged vector for next round verification (round=16)
[S2] DEBUG after merge:  round=16 metric=0.7013 head_norm=1.919164 delta_norm=0.234707
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=16 metric=0.7017 head_norm=0.896523
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.010064e-01
[S11] stored merged vector for next round verification (round=16)
[S11] DEBUG after merge:  round=16 metric=0.7017 head_norm=0.894986 delta_norm=0.101006
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=16 metric=0.4286 head_norm=1.177352
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.844505e-01
[S6] stored merged vector for next round verification (round=16)
[S6] DEBUG after merge:  round=16 metric=0.4320 head_norm=1.077075 delta_norm=0.284451
[S6] aggregate: ACCEPT kept=['S2', 'S8', 'S7'] (k=3/3) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.919164 cos_to_last_merge=1.0000 (last merge round=16)
[S2] round=17 local utility u=0.000000 metrics={'f1_val': 0.7013101313728686, 'auprc': 0.6685755626294084, 'loss_val': 0.3059883139251919, 'psi': 0.6882163038754845}-{'f1_val': 0.7013101313728686, 'auprc': 0.6683962431361838, 'loss_val': 0.30271884616095873, 'psi': 0.6881445760781947}
[S3] START round=17 head_norm_before_train=1.978111 (no previous merge yet)
[S3] round=17 local utility u=0.000000 metrics={'f1_val': 0.960995754132836, 'auprc': 0.9985054197420973, 'loss_val': 0.0891010214607011, 'psi': 0.9759996203765405}-{'f1_val': 0.9973696976584205, 'auprc': 0.9986900496774619, 'loss_val': 0.03413997334171146, 'psi': 0.9978978384660371}
[S4] START round=17 head_norm_before_train=1.208706 cos_to_last_merge=0.9991 (last merge round=15)
[S4] round=17 local utility u=0.072233 metrics={'f1_val': 0.6304698707894699, 'auprc': 0.852093196279954, 'loss_val': 0.5487663400415081, 'psi': 0.7191192009856635}-{'f1_val': 0.6163744872931695, 'auprc': 0.8509235132874465, 'loss_val': 0.6051517215104314, 'psi': 0.7101940976908803}
[S5] START round=17 head_norm_before_train=0.966183 cos_to_last_merge=1.0000 (last merge round=16)
[S5] round=17 local utility u=0.000000 metrics={'f1_val': 0.6736345738455748, 'auprc': 0.7874671225432933, 'loss_val': 0.5982818329857607, 'psi': 0.7191675933246622}-{'f1_val': 0.7004809549016324, 'auprc': 0.8553360422564663, 'loss_val': 0.4794328721478012, 'psi': 0.7624229898435659}
[S6] START round=17 head_norm_before_train=1.077075 cos_to_last_merge=1.0000 (last merge round=16)
[S6] round=17 local utility u=0.196908 metrics={'f1_val': 0.4861747468257993, 'auprc': 0.8475467395552694, 'loss_val': 0.6183050434164168, 'psi': 0.6307235439175873}-{'f1_val': 0.4285831517763639, 'auprc': 0.8566118062538993, 'loss_val': 0.6937657961272423, 'psi': 0.5997946135673781}
[S7] START round=17 head_norm_before_train=1.699717 (no previous merge yet)
[S7] round=17 local utility u=0.000000 metrics={'f1_val': 0.5699251291170232, 'auprc': 0.7844251519702161, 'loss_val': 0.7371142760189499, 'psi': 0.6557251382583004}-{'f1_val': 0.5875953865498, 'auprc': 0.788567543961506, 'loss_val': 0.7010181269783342, 'psi': 0.6679842495144824}
[S8] START round=17 head_norm_before_train=1.667513 (no previous merge yet)
[S8] round=17 local utility u=0.017429 metrics={'f1_val': 0.9967029720206022, 'auprc': 0.9993215283090024, 'loss_val': 0.09217894630588297, 'psi': 0.9977503945359623}-{'f1_val': 0.9952430317747349, 'auprc': 0.9992181921052394, 'loss_val': 0.11796738266943352, 'psi': 0.9968330959069368}
[S9] START round=17 head_norm_before_train=0.785127 cos_to_last_merge=1.0000 (last merge round=16)
[S9] round=17 local utility u=0.069506 metrics={'f1_val': 0.9897071435092063, 'auprc': 0.995775204881062, 'loss_val': 0.23119703363175226, 'psi': 0.9921343680579485}-{'f1_val': 0.9905518720143266, 'auprc': 0.994932218943179, 'loss_val': 0.3727480027314738, 'psi': 0.9923040107858676}
[S10] START round=17 head_norm_before_train=1.441558 cos_to_last_merge=0.8524 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.852
[S10] round=17 local utility u=0.028414 metrics={'f1_val': 0.9957455607450773, 'auprc': 0.9970325847017765, 'loss_val': 0.16322476900519856, 'psi': 0.9962603703277568}-{'f1_val': 0.9928754659835478, 'auprc': 0.9973745797575198, 'loss_val': 0.20385853123130943, 'psi': 0.9946751114931366}
[S11] START round=17 head_norm_before_train=0.894986 cos_to_last_merge=1.0000 (last merge round=16)
[S11] round=17 local utility u=0.000000 metrics={'f1_val': 0.6869837041288211, 'auprc': 0.9980787454730474, 'loss_val': 0.4522384212411326, 'psi': 0.8114217206665117}-{'f1_val': 0.7016934795869249, 'auprc': 0.9978477299918531, 'loss_val': 0.4765136800273284, 'psi': 0.8201551797488962}
[S13] START round=17 head_norm_before_train=1.506014 (no previous merge yet)
[S13] round=17 local utility u=0.030384 metrics={'f1_val': 0.6381089421300548, 'auprc': 0.6603759252284305, 'loss_val': 0.5536633361559633, 'psi': 0.647015735369405}-{'f1_val': 0.625455380126803, 'auprc': 0.6717410257692792, 'loss_val': 0.5726055394464074, 'psi': 0.6439696383837935}
[S14] START round=17 head_norm_before_train=0.904793 cos_to_last_merge=0.9968 (last merge round=15)
[S14] round=17 local utility u=0.040053 metrics={'f1_val': 0.997043018986542, 'auprc': 0.9950103036475135, 'loss_val': 0.3413314833568808, 'psi': 0.9962299328509306}-{'f1_val': 0.9970336855150863, 'auprc': 0.9965439310752876, 'loss_val': 0.42598179892511306, 'psi': 0.9968377837391669}
[S15] START round=17 head_norm_before_train=1.089500 cos_to_last_merge=1.0000 (last merge round=16)
[S15] round=17 local utility u=1.000000 metrics={'f1_val': 0.9925616676483126, 'auprc': 0.9984002238175282, 'loss_val': 0.35433955937726225, 'psi': 0.9948970901159988}-{'f1_val': 0.6985460078543178, 'auprc': 0.7996378979819532, 'loss_val': 0.5375586966605741, 'psi': 0.7389827639053719}
[S16] START round=17 head_norm_before_train=1.488528 cos_to_last_merge=0.8419 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.842
[S16] round=17 local utility u=0.010406 metrics={'f1_val': 0.8555358413516493, 'auprc': 0.976058089412237, 'loss_val': 0.6151792770671519, 'psi': 0.9037447405758845}-{'f1_val': 0.8516473148077313, 'auprc': 0.9725776765912619, 'loss_val': 0.6022194483126962, 'psi': 0.9000194595211435}
[S17] START round=17 head_norm_before_train=1.191206 cos_to_last_merge=0.7903 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.790
[S17] round=17 local utility u=0.636405 metrics={'f1_val': 0.5461812098977236, 'auprc': 0.8741069698906444, 'loss_val': 0.6612612211611256, 'psi': 0.677351513894892}-{'f1_val': 0.38115149454003605, 'auprc': 0.8002381272663481, 'loss_val': 0.7222862988320381, 'psi': 0.5487861476305609}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:62412
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:62414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:62414
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:62415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:62407
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:62404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:62405
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:62410
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:62404
[S16] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1803) from S9
[S14] cosine check vs S9: cos=0.9264
[S14] RECEIVED delta(kind=head bytes=1796) from S15
[S14] cosine check vs S15: cos=0.6323
[S11] RECEIVED delta(kind=head bytes=1796) from S14
[S11] cosine check vs S14: cos=0.9845
[S6] RECEIVED delta(kind=head bytes=1800) from S8
[S6] cosine check vs S8: cos=0.6099
[S9] RECEIVED delta(kind=head bytes=1800) from S13
[S9] cosine check vs S13: cos=-0.1741
[S9] DROPPED delta from S13 (cos=-0.1741 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1798) from S6
[S15] cosine check vs S6: cos=0.9756
[S5] RECEIVED delta(kind=head bytes=1801) from S4
[S5] cosine check vs S4: cos=0.8528
[S4] RECEIVED delta(kind=head bytes=1799) from S10
[S4] cosine check vs S10: cos=0.8091
[S4] RECEIVED delta(kind=head bytes=1795) from S16
[S4] cosine check vs S16: cos=0.7928
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:62405
[S17] sending update (kind=head size=1799 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1799) from S17
[S5] cosine check vs S17: cos=0.6593
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=17 metric=0.6736 head_norm=1.012039
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.170467e-01
[S5] stored merged vector for next round verification (round=17)
[S5] DEBUG after merge:  round=17 metric=0.6822 head_norm=0.977599 delta_norm=0.117047
[S5] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=17 metric=0.6870 head_norm=0.937644
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.427075e-02
[S11] stored merged vector for next round verification (round=17)
[S11] DEBUG after merge:  round=17 metric=0.6647 head_norm=0.945169 delta_norm=0.084271
[S11] aggregate: ROLLBACK (f1_val pre=0.687 post=0.665 tol_abs=0.005 tol_rel=0.0)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=17 metric=0.4862 head_norm=1.105060
[S6] _apply_head_vector_avg (torch): Δ‖w‖=6.746156e-01
[S6] stored merged vector for next round verification (round=17)
[S6] DEBUG after merge:  round=17 metric=0.4186 head_norm=1.265398 delta_norm=0.674616
[S6] aggregate: ROLLBACK (f1_val pre=0.486 post=0.419 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=17 metric=0.9926 head_norm=1.127036
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.238255e-01
[S15] stored merged vector for next round verification (round=17)
[S15] DEBUG after merge:  round=17 metric=0.9922 head_norm=1.109212 delta_norm=0.123825
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=17 metric=0.6305 head_norm=1.252093
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.036914e-01
[S4] stored merged vector for next round verification (round=17)
[S4] DEBUG after merge:  round=17 metric=0.6180 head_norm=1.228221 delta_norm=0.103691
[S4] aggregate: ROLLBACK (f1_val pre=0.630 post=0.618 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=17 metric=0.9970 head_norm=0.960059
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.385594e-01
[S14] stored merged vector for next round verification (round=17)
[S14] DEBUG after merge:  round=17 metric=0.9970 head_norm=0.891872 delta_norm=0.238559
[S14] aggregate: ACCEPT kept=['S9', 'S15'] (k=2/2) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.939805 cos_to_last_merge=0.9999 (last merge round=16)
[S2] round=18 local utility u=0.003085 metrics={'f1_val': 0.7013101313728686, 'auprc': 0.6726819524517949, 'loss_val': 0.31213688834737985, 'psi': 0.6898588598044391}-{'f1_val': 0.7013101313728686, 'auprc': 0.6685755626294084, 'loss_val': 0.3059883139251919, 'psi': 0.6882163038754845}
[S3] START round=18 head_norm_before_train=2.012164 (no previous merge yet)
[S3] round=18 local utility u=0.000000 metrics={'f1_val': 0.960995754132836, 'auprc': 0.9986828606181468, 'loss_val': 0.10465231548091618, 'psi': 0.9760705967269604}-{'f1_val': 0.960995754132836, 'auprc': 0.9985054197420973, 'loss_val': 0.0891010214607011, 'psi': 0.9759996203765405}
[S4] START round=18 head_norm_before_train=1.228221 cos_to_last_merge=1.0000 (last merge round=17)
[S4] round=18 local utility u=0.067972 metrics={'f1_val': 0.6138113973465683, 'auprc': 0.9394546695688191, 'loss_val': 0.574956332799508, 'psi': 0.7440687062354686}-{'f1_val': 0.6304698707894699, 'auprc': 0.852093196279954, 'loss_val': 0.5487663400415081, 'psi': 0.7191192009856635}
[S5] START round=18 head_norm_before_train=0.977599 cos_to_last_merge=1.0000 (last merge round=17)
[S5] round=18 local utility u=0.237406 metrics={'f1_val': 0.7004809549016324, 'auprc': 0.8533196690075029, 'loss_val': 0.482105142106157, 'psi': 0.7616164405439806}-{'f1_val': 0.6736345738455748, 'auprc': 0.7874671225432933, 'loss_val': 0.5982818329857607, 'psi': 0.7191675933246622}
[S6] START round=18 head_norm_before_train=1.265398 cos_to_last_merge=1.0000 (last merge round=17)
[S6] round=18 local utility u=0.633951 metrics={'f1_val': 0.6831432929709236, 'auprc': 0.8487313667587147, 'loss_val': 0.5357680378223545, 'psi': 0.7493785224860401}-{'f1_val': 0.4861747468257993, 'auprc': 0.8475467395552694, 'loss_val': 0.6183050434164168, 'psi': 0.6307235439175873}
[S7] START round=18 head_norm_before_train=1.707882 (no previous merge yet)
[S7] round=18 local utility u=0.034118 metrics={'f1_val': 0.5777454763281715, 'auprc': 0.7841411513899055, 'loss_val': 0.7149476424803668, 'psi': 0.6603037463528652}-{'f1_val': 0.5699251291170232, 'auprc': 0.7844251519702161, 'loss_val': 0.7371142760189499, 'psi': 0.6557251382583004}
[S8] START round=18 head_norm_before_train=1.700446 (no previous merge yet)
[S8] round=18 local utility u=0.000000 metrics={'f1_val': 0.9929679663698754, 'auprc': 0.999128138042297, 'loss_val': 0.09064906113842255, 'psi': 0.9954320350388441}-{'f1_val': 0.9967029720206022, 'auprc': 0.9993215283090024, 'loss_val': 0.09217894630588297, 'psi': 0.9977503945359623}
[S9] START round=18 head_norm_before_train=0.891410 cos_to_last_merge=0.9883 (last merge round=16)
[S9] round=18 local utility u=0.065452 metrics={'f1_val': 0.9964101856672208, 'auprc': 0.9942775378221693, 'loss_val': 0.13601881960242596, 'psi': 0.9955571265292003}-{'f1_val': 0.9897071435092063, 'auprc': 0.995775204881062, 'loss_val': 0.23119703363175226, 'psi': 0.9921343680579485}
[S10] START round=18 head_norm_before_train=1.461316 cos_to_last_merge=0.8517 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.852
[S10] round=18 local utility u=0.000000 metrics={'f1_val': 0.995109769286467, 'auprc': 0.9961336682705826, 'loss_val': 0.1677496772627551, 'psi': 0.9955193288801132}-{'f1_val': 0.9957455607450773, 'auprc': 0.9970325847017765, 'loss_val': 0.16322476900519856, 'psi': 0.9962603703277568}
[S11] START round=18 head_norm_before_train=0.945169 cos_to_last_merge=1.0000 (last merge round=17)
[S11] round=18 local utility u=0.470170 metrics={'f1_val': 0.8588156863630813, 'auprc': 0.9496123159726441, 'loss_val': 0.3974916581222113, 'psi': 0.8951343382069064}-{'f1_val': 0.6869837041288211, 'auprc': 0.9980787454730474, 'loss_val': 0.4522384212411326, 'psi': 0.8114217206665117}
[S13] START round=18 head_norm_before_train=1.518218 (no previous merge yet)
[S13] round=18 local utility u=0.000000 metrics={'f1_val': 0.6149146210825578, 'auprc': 0.6741815588389988, 'loss_val': 0.6285085684996541, 'psi': 0.6386213961851341}-{'f1_val': 0.6381089421300548, 'auprc': 0.6603759252284305, 'loss_val': 0.5536633361559633, 'psi': 0.647015735369405}
[S14] START round=18 head_norm_before_train=0.891872 cos_to_last_merge=1.0000 (last merge round=17)
[S14] round=18 local utility u=0.000000 metrics={'f1_val': 0.9965574496053289, 'auprc': 0.9958230428027265, 'loss_val': 0.3619200397295269, 'psi': 0.9962636868842879}-{'f1_val': 0.997043018986542, 'auprc': 0.9950103036475135, 'loss_val': 0.3413314833568808, 'psi': 0.9962299328509306}
[S15] START round=18 head_norm_before_train=1.109212 cos_to_last_merge=1.0000 (last merge round=17)
[S15] round=18 local utility u=0.000000 metrics={'f1_val': 0.8634437511581429, 'auprc': 0.9910703883475783, 'loss_val': 0.4178446448160895, 'psi': 0.9144944060339171}-{'f1_val': 0.9925616676483126, 'auprc': 0.9984002238175282, 'loss_val': 0.35433955937726225, 'psi': 0.9948970901159988}
[S16] START round=18 head_norm_before_train=1.526311 cos_to_last_merge=0.8379 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.838
[S16] round=18 local utility u=0.650494 metrics={'f1_val': 0.9823738450436614, 'auprc': 0.9897983570353536, 'loss_val': 0.1164403790966096, 'psi': 0.9853436498403383}-{'f1_val': 0.8555358413516493, 'auprc': 0.976058089412237, 'loss_val': 0.6151792770671519, 'psi': 0.9037447405758845}
[S17] START round=18 head_norm_before_train=1.203861 cos_to_last_merge=0.7864 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.786
[S17] round=18 local utility u=0.000000 metrics={'f1_val': 0.38995327707989036, 'auprc': 0.9218243683982186, 'loss_val': 0.6165630114742164, 'psi': 0.6027017136072217}-{'f1_val': 0.5461812098977236, 'auprc': 0.8741069698906444, 'loss_val': 0.6612612211611256, 'psi': 0.677351513894892}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:62407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:62407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:62415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:62405
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:62414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:62404
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:62410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S5] → sending delta(kind=head bytes=1790) to S9@127.0.0.1:62410
[S11] sending update (kind=head size=1804 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1790 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1804) from S11
[S9] cosine check vs S11: cos=0.9086
[S6] RECEIVED delta(kind=head bytes=1798) from S2
[S6] cosine check vs S2: cos=0.3265
[S15] RECEIVED delta(kind=head bytes=1800) from S6
[S15] cosine check vs S6: cos=0.8634
[S4] RECEIVED delta(kind=head bytes=1797) from S16
[S4] cosine check vs S16: cos=0.8043
[S5] RECEIVED delta(kind=head bytes=1797) from S4
[S5] cosine check vs S4: cos=0.8185
[S14] RECEIVED delta(kind=head bytes=1802) from S9
[S14] cosine check vs S9: cos=0.8993
[S6] RECEIVED delta(kind=head bytes=1798) from S7
[S6] cosine check vs S7: cos=0.1669
[S9] RECEIVED delta(kind=head bytes=1790) from S5
[S9] cosine check vs S5: cos=0.3744
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=18 metric=0.9966 head_norm=0.937265
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.207245e-01
[S14] stored merged vector for next round verification (round=18)
[S14] DEBUG after merge:  round=18 metric=0.9970 head_norm=0.947416 delta_norm=0.220725
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=18 metric=0.9964 head_norm=1.007059
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.769726e-01
[S9] stored merged vector for next round verification (round=18)
[S9] DEBUG after merge:  round=18 metric=0.9964 head_norm=0.848280 delta_norm=0.276973
[S9] aggregate: ACCEPT kept=['S11', 'S5'] (k=2/2) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=18 metric=0.6831 head_norm=1.290957
[S6] _apply_head_vector_avg (torch): Δ‖w‖=7.707465e-01
[S6] stored merged vector for next round verification (round=18)
[S6] DEBUG after merge:  round=18 metric=0.6922 head_norm=1.092086 delta_norm=0.770746
[S6] aggregate: ACCEPT kept=['S2', 'S7'] (k=2/2) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=18 metric=0.6138 head_norm=1.271346
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.643493e-01
[S4] stored merged vector for next round verification (round=18)
[S4] DEBUG after merge:  round=18 metric=0.6124 head_norm=1.346699 delta_norm=0.464349
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=18 metric=0.7005 head_norm=1.024119
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.652996e-01
[S5] stored merged vector for next round verification (round=18)
[S5] DEBUG after merge:  round=18 metric=0.7006 head_norm=1.095046 delta_norm=0.365300
[S5] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=18 metric=0.8634 head_norm=1.138960
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.259147e-01
[S15] stored merged vector for next round verification (round=18)
[S15] DEBUG after merge:  round=18 metric=0.8882 head_norm=1.172894 delta_norm=0.325915
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.957216 cos_to_last_merge=0.9995 (last merge round=16)
[S2] round=19 local utility u=0.000000 metrics={'f1_val': 0.42291235406776423, 'auprc': 0.6526638907082482, 'loss_val': 1.4400445560237074, 'psi': 0.5148129687239578}-{'f1_val': 0.7013101313728686, 'auprc': 0.6726819524517949, 'loss_val': 0.31213688834737985, 'psi': 0.6898588598044391}
[S3] START round=19 head_norm_before_train=2.044052 (no previous merge yet)
[S3] round=19 local utility u=0.150738 metrics={'f1_val': 0.9977814963782642, 'auprc': 0.9986756506492719, 'loss_val': 0.02386829578483745, 'psi': 0.9981391580866673}-{'f1_val': 0.960995754132836, 'auprc': 0.9986828606181468, 'loss_val': 0.10465231548091618, 'psi': 0.9760705967269604}
[S4] START round=19 head_norm_before_train=1.346699 cos_to_last_merge=1.0000 (last merge round=18)
[S4] round=19 local utility u=0.030181 metrics={'f1_val': 0.616953056098859, 'auprc': 0.9442830746193367, 'loss_val': 0.5479301321578451, 'psi': 0.7478850635070501}-{'f1_val': 0.6138113973465683, 'auprc': 0.9394546695688191, 'loss_val': 0.574956332799508, 'psi': 0.7440687062354686}
[S5] START round=19 head_norm_before_train=1.095046 cos_to_last_merge=1.0000 (last merge round=18)
[S5] round=19 local utility u=0.214272 metrics={'f1_val': 0.7005685100046517, 'auprc': 0.9566372972608223, 'loss_val': 0.3640394631193353, 'psi': 0.80299602490712}-{'f1_val': 0.7004809549016324, 'auprc': 0.8533196690075029, 'loss_val': 0.482105142106157, 'psi': 0.7616164405439806}
[S6] START round=19 head_norm_before_train=1.092086 cos_to_last_merge=1.0000 (last merge round=18)
[S6] round=19 local utility u=0.000000 metrics={'f1_val': 0.674841648144936, 'auprc': 0.8050429433690629, 'loss_val': 0.5063542494297175, 'psi': 0.7269221662345868}-{'f1_val': 0.6831432929709236, 'auprc': 0.8487313667587147, 'loss_val': 0.5357680378223545, 'psi': 0.7493785224860401}
[S7] START round=19 head_norm_before_train=1.726883 (no previous merge yet)
[S7] round=19 local utility u=0.074317 metrics={'f1_val': 0.5999021081940901, 'auprc': 0.7866030952032035, 'loss_val': 0.7066394812034883, 'psi': 0.6745825029977355}-{'f1_val': 0.5777454763281715, 'auprc': 0.7841411513899055, 'loss_val': 0.7149476424803668, 'psi': 0.6603037463528652}
[S8] START round=19 head_norm_before_train=1.727301 (no previous merge yet)
[S8] round=19 local utility u=0.000000 metrics={'f1_val': 0.7153415317234517, 'auprc': 0.991927352151429, 'loss_val': 0.16091225117262187, 'psi': 0.8259758598946427}-{'f1_val': 0.9929679663698754, 'auprc': 0.999128138042297, 'loss_val': 0.09064906113842255, 'psi': 0.9954320350388441}
[S9] START round=19 head_norm_before_train=0.848280 cos_to_last_merge=1.0000 (last merge round=18)
[S9] round=19 local utility u=0.000000 metrics={'f1_val': 0.9951655063899485, 'auprc': 0.9936253605139405, 'loss_val': 0.16132210838365627, 'psi': 0.9945494480395453}-{'f1_val': 0.9964101856672208, 'auprc': 0.9942775378221693, 'loss_val': 0.13601881960242596, 'psi': 0.9955571265292003}
[S10] START round=19 head_norm_before_train=1.483879 cos_to_last_merge=0.8512 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.851
[S10] round=19 local utility u=0.034425 metrics={'f1_val': 0.9961605415649639, 'auprc': 0.9967225433827509, 'loss_val': 0.10697107091827637, 'psi': 0.9963853422920786}-{'f1_val': 0.995109769286467, 'auprc': 0.9961336682705826, 'loss_val': 0.1677496772627551, 'psi': 0.9955193288801132}
[S11] START round=19 head_norm_before_train=0.983182 cos_to_last_merge=0.9983 (last merge round=17)
[S11] round=19 local utility u=0.000000 metrics={'f1_val': 0.7029746780752882, 'auprc': 0.9986093835563419, 'loss_val': 0.3468235630123347, 'psi': 0.8212285602677097}-{'f1_val': 0.8588156863630813, 'auprc': 0.9496123159726441, 'loss_val': 0.3974916581222113, 'psi': 0.8951343382069064}
[S13] START round=19 head_norm_before_train=1.533178 (no previous merge yet)
[S13] round=19 local utility u=0.214076 metrics={'f1_val': 0.6622075167866457, 'auprc': 0.6750483237691232, 'loss_val': 0.48671398895967455, 'psi': 0.6673438395796367}-{'f1_val': 0.6149146210825578, 'auprc': 0.6741815588389988, 'loss_val': 0.6285085684996541, 'psi': 0.6386213961851341}
[S14] START round=19 head_norm_before_train=0.947416 cos_to_last_merge=1.0000 (last merge round=18)
[S14] round=19 local utility u=0.037641 metrics={'f1_val': 0.997211058727947, 'auprc': 0.9964583909535306, 'loss_val': 0.2924651265815995, 'psi': 0.9969099916181805}-{'f1_val': 0.9965574496053289, 'auprc': 0.9958230428027265, 'loss_val': 0.3619200397295269, 'psi': 0.9962636868842879}
[S15] START round=19 head_norm_before_train=1.172894 cos_to_last_merge=1.0000 (last merge round=18)
[S15] round=19 local utility u=0.000000 metrics={'f1_val': 0.8194022557541488, 'auprc': 0.9563410385074916, 'loss_val': 0.4219603947214638, 'psi': 0.8741777688554859}-{'f1_val': 0.8634437511581429, 'auprc': 0.9910703883475783, 'loss_val': 0.4178446448160895, 'psi': 0.9144944060339171}
[S16] START round=19 head_norm_before_train=1.562728 cos_to_last_merge=0.8349 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.835
[S16] round=19 local utility u=0.000000 metrics={'f1_val': 0.8862223200426371, 'auprc': 0.9940284134697697, 'loss_val': 0.44293405279897113, 'psi': 0.9293447574134901}-{'f1_val': 0.9823738450436614, 'auprc': 0.9897983570353536, 'loss_val': 0.1164403790966096, 'psi': 0.9853436498403383}
[S17] START round=19 head_norm_before_train=1.221321 cos_to_last_merge=0.7821 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.782
[S17] round=19 local utility u=0.202285 metrics={'f1_val': 0.4446157401290376, 'auprc': 0.9420226930531911, 'loss_val': 0.6005631685841155, 'psi': 0.643578521298699}-{'f1_val': 0.38995327707989036, 'auprc': 0.9218243683982186, 'loss_val': 0.6165630114742164, 'psi': 0.6027017136072217}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:62410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] → sending delta(kind=head bytes=1794) to S2@127.0.0.1:62402
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:62410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:62407
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:62404
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:62412
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:62405
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1794 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1802) from S14
[S11] cosine check vs S14: cos=0.9637
[S2] RECEIVED delta(kind=head bytes=1794) from S3
[S2] cosine check vs S3: cos=0.9857
[S6] RECEIVED delta(kind=head bytes=1799) from S7
[S6] cosine check vs S7: cos=0.5443
[S9] RECEIVED delta(kind=head bytes=1797) from S5
[S9] cosine check vs S5: cos=0.4505
[S9] RECEIVED delta(kind=head bytes=1797) from S13
[S9] cosine check vs S13: cos=-0.1581
[S9] DROPPED delta from S13 (cos=-0.1581 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1803) from S4
[S5] cosine check vs S4: cos=0.9058
[S4] RECEIVED delta(kind=head bytes=1802) from S10
[S4] cosine check vs S10: cos=0.5741
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] → sending delta(kind=head bytes=1805) to S5@127.0.0.1:62405
[S17] sending update (kind=head size=1805 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1805) from S17
[S5] cosine check vs S17: cos=0.4647
[S15] r=20 psi=0.874 u=0.0000 p_local=0.2312 f1=0.819 auprc=0.956 bytes=19783
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=19 metric=0.9952 head_norm=0.960741
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.628896e-01
[S9] stored merged vector for next round verification (round=19)
[S9] DEBUG after merge:  round=19 metric=0.9956 head_norm=0.905421 delta_norm=0.562890
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S9] r=20 psi=0.995 u=0.0000 p_local=0.0774 f1=0.995 auprc=0.994 bytes=17992
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=19 metric=0.4229 head_norm=1.969006
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.784193e-01
[S2] stored merged vector for next round verification (round=19)
[S2] DEBUG after merge:  round=19 metric=0.4219 head_norm=2.012797 delta_norm=0.178419
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] r=20 psi=0.515 u=0.0000 p_local=0.0636 f1=0.423 auprc=0.653 bytes=21559
[S8] r=20 psi=0.826 u=0.0000 p_local=0.1407 f1=0.715 auprc=0.992 bytes=23383
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=19 metric=0.6748 head_norm=1.125801
[S6] _apply_head_vector_avg (torch): Δ‖w‖=7.367906e-01
[S6] stored merged vector for next round verification (round=19)
[S6] DEBUG after merge:  round=19 metric=0.6814 head_norm=1.269444 delta_norm=0.736791
[S6] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S6] r=20 psi=0.727 u=0.0000 p_local=0.1811 f1=0.675 auprc=0.805 bytes=21558
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=19 metric=0.7030 head_norm=1.017557
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.360702e-01
[S11] stored merged vector for next round verification (round=19)
[S11] DEBUG after merge:  round=19 metric=0.7030 head_norm=0.998232 delta_norm=0.136070
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S11] r=20 psi=0.821 u=0.0000 p_local=0.1438 f1=0.703 auprc=0.999 bytes=21589
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=19 metric=0.7006 head_norm=1.161999
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.743891e-01
[S5] stored merged vector for next round verification (round=19)
[S5] DEBUG after merge:  round=19 metric=0.7005 head_norm=1.066880 delta_norm=0.274389
[S5] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S5] r=20 psi=0.803 u=0.2143 p_local=0.1629 f1=0.701 auprc=0.957 bytes=17958
[S3] r=20 psi=0.998 u=0.1507 p_local=0.1101 f1=0.998 auprc=0.999 bytes=14383
[S13] r=20 psi=0.667 u=0.2141 p_local=0.1356 f1=0.662 auprc=0.675 bytes=19796
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=19 metric=0.6170 head_norm=1.383654
[S4] _apply_head_vector_avg (torch): Δ‖w‖=6.699786e-01
[S4] stored merged vector for next round verification (round=19)
[S4] DEBUG after merge:  round=19 metric=0.6176 head_norm=1.283835 delta_norm=0.669979
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S4] r=20 psi=0.748 u=0.0302 p_local=0.1327 f1=0.617 auprc=0.944 bytes=23353
[S14] r=20 psi=0.997 u=0.0376 p_local=0.1765 f1=0.997 auprc=0.996 bytes=21590
[S10] r=20 psi=0.996 u=0.0344 p_local=0.1480 f1=0.996 auprc=0.997 bytes=19777
[S7] r=20 psi=0.675 u=0.0743 p_local=0.1091 f1=0.600 auprc=0.787 bytes=17988
[S16] r=20 psi=0.929 u=0.0000 p_local=0.2417 f1=0.886 auprc=0.994 bytes=21556
[S17] r=20 psi=0.644 u=0.2023 p_local=0.1838 f1=0.445 auprc=0.942 bytes=17958
[S2] START round=20 head_norm_before_train=2.012797 cos_to_last_merge=1.0000 (last merge round=19)
[S2] round=20 local utility u=1.000000 metrics={'f1_val': 0.7010971656324371, 'auprc': 0.7196810746214501, 'loss_val': 0.3396395086739722, 'psi': 0.7085307292280423}-{'f1_val': 0.42291235406776423, 'auprc': 0.6526638907082482, 'loss_val': 1.4400445560237074, 'psi': 0.5148129687239578}
[S3] START round=20 head_norm_before_train=2.071083 (no previous merge yet)
[S3] round=20 local utility u=0.000000 metrics={'f1_val': 0.9977814963782642, 'auprc': 0.9986790714341635, 'loss_val': 0.024040277203784505, 'psi': 0.998140526400624}-{'f1_val': 0.9977814963782642, 'auprc': 0.9986756506492719, 'loss_val': 0.02386829578483745, 'psi': 0.9981391580866673}
[S4] START round=20 head_norm_before_train=1.283835 cos_to_last_merge=1.0000 (last merge round=19)
[S4] round=20 local utility u=1.000000 metrics={'f1_val': 0.9460581558396581, 'auprc': 0.9277535716641641, 'loss_val': 0.4614889989769797, 'psi': 0.9387363221694605}-{'f1_val': 0.616953056098859, 'auprc': 0.9442830746193367, 'loss_val': 0.5479301321578451, 'psi': 0.7478850635070501}
[S5] START round=20 head_norm_before_train=1.066880 cos_to_last_merge=1.0000 (last merge round=19)
[S5] round=20 local utility u=0.000000 metrics={'f1_val': 0.6615785135877267, 'auprc': 0.8535909512096204, 'loss_val': 0.485109235573414, 'psi': 0.7383834886364842}-{'f1_val': 0.7005685100046517, 'auprc': 0.9566372972608223, 'loss_val': 0.3640394631193353, 'psi': 0.80299602490712}
[S6] START round=20 head_norm_before_train=1.269444 cos_to_last_merge=1.0000 (last merge round=19)
[S6] round=20 local utility u=0.000000 metrics={'f1_val': 0.6974957881813026, 'auprc': 0.6707650301631902, 'loss_val': 0.5501479501096008, 'psi': 0.6868034849740576}-{'f1_val': 0.674841648144936, 'auprc': 0.8050429433690629, 'loss_val': 0.5063542494297175, 'psi': 0.7269221662345868}
[S7] START round=20 head_norm_before_train=1.743924 (no previous merge yet)
[S7] round=20 local utility u=0.000000 metrics={'f1_val': 0.5788023417496563, 'auprc': 0.7854042945743771, 'loss_val': 0.7305290038413061, 'psi': 0.6614431228795447}-{'f1_val': 0.5999021081940901, 'auprc': 0.7866030952032035, 'loss_val': 0.7066394812034883, 'psi': 0.6745825029977355}
[S8] START round=20 head_norm_before_train=1.750399 (no previous merge yet)
[S8] round=20 local utility u=0.888609 metrics={'f1_val': 0.9922396549535559, 'auprc': 0.9992492938315727, 'loss_val': 0.067049036756734, 'psi': 0.9950435105047627}-{'f1_val': 0.7153415317234517, 'auprc': 0.991927352151429, 'loss_val': 0.16091225117262187, 'psi': 0.8259758598946427}
[S9] START round=20 head_norm_before_train=0.905421 cos_to_last_merge=1.0000 (last merge round=19)
[S9] round=20 local utility u=0.000000 metrics={'f1_val': 0.9964101856672208, 'auprc': 0.990915317371121, 'loss_val': 0.2832399686120557, 'psi': 0.9942122383487809}-{'f1_val': 0.9951655063899485, 'auprc': 0.9936253605139405, 'loss_val': 0.16132210838365627, 'psi': 0.9945494480395453}
[S10] START round=20 head_norm_before_train=1.509870 cos_to_last_merge=0.8506 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.851
[S10] round=20 local utility u=0.007956 metrics={'f1_val': 0.9961605415649639, 'auprc': 0.9962004491015092, 'loss_val': 0.08949248068783364, 'psi': 0.996176504579582}-{'f1_val': 0.9961605415649639, 'auprc': 0.9967225433827509, 'loss_val': 0.10697107091827637, 'psi': 0.9963853422920786}
[S11] START round=20 head_norm_before_train=0.998232 cos_to_last_merge=1.0000 (last merge round=19)
[S11] round=20 local utility u=0.000000 metrics={'f1_val': 0.6631945462157492, 'auprc': 0.9985635756973736, 'loss_val': 0.4109695152614197, 'psi': 0.797342158008399}-{'f1_val': 0.7029746780752882, 'auprc': 0.9986093835563419, 'loss_val': 0.3468235630123347, 'psi': 0.8212285602677097}
[S13] START round=20 head_norm_before_train=1.547902 (no previous merge yet)
[S13] round=20 local utility u=0.000000 metrics={'f1_val': 0.6023489362165051, 'auprc': 0.6844801357405457, 'loss_val': 0.7547082945772029, 'psi': 0.6352014160261213}-{'f1_val': 0.6622075167866457, 'auprc': 0.6750483237691232, 'loss_val': 0.48671398895967455, 'psi': 0.6673438395796367}
[S14] START round=20 head_norm_before_train=0.997266 cos_to_last_merge=0.9982 (last merge round=18)
[S14] round=20 local utility u=0.030381 metrics={'f1_val': 0.9966530890084357, 'auprc': 0.9971723060987399, 'loss_val': 0.23049693830247914, 'psi': 0.9968607758445573}-{'f1_val': 0.997211058727947, 'auprc': 0.9964583909535306, 'loss_val': 0.2924651265815995, 'psi': 0.9969099916181805}
[S15] START round=20 head_norm_before_train=1.202883 cos_to_last_merge=0.9989 (last merge round=18)
[S15] round=20 local utility u=0.346276 metrics={'f1_val': 0.8993725818896314, 'auprc': 0.9920133114348266, 'loss_val': 0.3162463395486561, 'psi': 0.9364288737077096}-{'f1_val': 0.8194022557541488, 'auprc': 0.9563410385074916, 'loss_val': 0.4219603947214638, 'psi': 0.8741777688554859}
[S16] START round=20 head_norm_before_train=1.593850 cos_to_last_merge=0.8326 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.833
[S16] round=20 local utility u=0.080274 metrics={'f1_val': 0.9075033457290674, 'auprc': 0.9928801557551394, 'loss_val': 0.40662754223549064, 'psi': 0.9416540697394963}-{'f1_val': 0.8862223200426371, 'auprc': 0.9940284134697697, 'loss_val': 0.44293405279897113, 'psi': 0.9293447574134901}
[S17] START round=20 head_norm_before_train=1.239955 cos_to_last_merge=0.7784 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.778
[S17] round=20 local utility u=0.266064 metrics={'f1_val': 0.5218911662614889, 'auprc': 0.94831859135424, 'loss_val': 0.5509749705375089, 'psi': 0.6924621362985894}-{'f1_val': 0.4446157401290376, 'auprc': 0.9420226930531911, 'loss_val': 0.6005631685841155, 'psi': 0.643578521298699}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:62407
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:62404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:62404
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S14] → sending delta(kind=head bytes=1806) to S11@127.0.0.1:62412
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:62407
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:62414
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:62405
[S4] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1806 to 1 peers)
[S16] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1796 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1806) from S14
[S11] cosine check vs S14: cos=0.9869
[S6] RECEIVED delta(kind=head bytes=1798) from S8
[S6] cosine check vs S8: cos=0.2281
[S6] RECEIVED delta(kind=head bytes=1796) from S2
[S6] cosine check vs S2: cos=0.3937
[S5] RECEIVED delta(kind=head bytes=1803) from S4
[S5] cosine check vs S4: cos=0.8334
[S4] RECEIVED delta(kind=head bytes=1795) from S16
[S4] cosine check vs S16: cos=0.7025
[S14] RECEIVED delta(kind=head bytes=1800) from S15
[S14] cosine check vs S15: cos=0.5575
[S4] RECEIVED delta(kind=head bytes=1797) from S10
[S4] cosine check vs S10: cos=0.8941
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:62405
[S17] sending update (kind=head size=1802 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1802) from S17
[S5] cosine check vs S17: cos=0.6211
[S3] ⇄ pheromone p=0.088 → S2@127.0.0.1:62402
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=20 metric=0.6975 head_norm=1.292618
[S6] _apply_head_vector_avg (torch): Δ‖w‖=7.015475e-01
[S6] stored merged vector for next round verification (round=20)
[S6] DEBUG after merge:  round=20 metric=0.6964 head_norm=1.125919 delta_norm=0.701548
[S6] aggregate: ACCEPT kept=['S8', 'S2'] (k=2/2) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.145 → S15@127.0.0.1:62415
[S9] ⇄ pheromone p=0.062 → S14@127.0.0.1:62414
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=20 metric=0.6616 head_norm=1.123120
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.805070e-01
[S5] stored merged vector for next round verification (round=20)
[S5] DEBUG after merge:  round=20 metric=0.6660 head_norm=1.043851 delta_norm=0.180507
[S5] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.130 → S9@127.0.0.1:62410
[S13] ⇄ pheromone p=0.108 → S9@127.0.0.1:62410
[S7] ⇄ pheromone p=0.087 → S6@127.0.0.1:62407
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=20 metric=0.6632 head_norm=1.029088
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.470999e-02
[S11] stored merged vector for next round verification (round=20)
[S11] DEBUG after merge:  round=20 metric=0.7797 head_norm=1.036013 delta_norm=0.084710
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.115 → S9@127.0.0.1:62410
[S15] ⇄ pheromone p=0.254 → S14@127.0.0.1:62414
[S10] ⇄ pheromone p=0.120 → S4@127.0.0.1:62404
[S2] ⇄ pheromone p=0.251 → S6@127.0.0.1:62407
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=20 metric=0.9461 head_norm=1.320791
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.385207e-01
[S4] stored merged vector for next round verification (round=20)
[S4] DEBUG after merge:  round=20 metric=0.7822 head_norm=1.295655 delta_norm=0.138521
[S4] aggregate: ROLLBACK (f1_val pre=0.946 post=0.782 tol_abs=0.005 tol_rel=0.0)
[S4] ⇄ pheromone p=0.306 → S5@127.0.0.1:62405
[S8] ⇄ pheromone p=0.290 → S6@127.0.0.1:62407
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=20 metric=0.9967 head_norm=1.049750
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.445746e-01
[S14] stored merged vector for next round verification (round=20)
[S14] DEBUG after merge:  round=20 metric=0.9967 head_norm=1.010656 delta_norm=0.544575
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.147 → S11@127.0.0.1:62412
[S16] ⇄ pheromone p=0.209 → S4@127.0.0.1:62404
[S17] ⇄ pheromone p=0.200 → S5@127.0.0.1:62405
[S2] START round=21 head_norm_before_train=2.022363 cos_to_last_merge=1.0000 (last merge round=19)
[S2] round=21 local utility u=0.000000 metrics={'f1_val': 0.7013101313728686, 'auprc': 0.6646229301341571, 'loss_val': 0.30918341688523077, 'psi': 0.686635250877384}-{'f1_val': 0.7010971656324371, 'auprc': 0.7196810746214501, 'loss_val': 0.3396395086739722, 'psi': 0.7085307292280423}
[S3] START round=21 head_norm_before_train=2.096016 (no previous merge yet)
[S3] round=21 local utility u=0.000000 metrics={'f1_val': 0.9628852465428241, 'auprc': 0.9986742343176953, 'loss_val': 0.07381871443150578, 'psi': 0.9772008416527727}-{'f1_val': 0.9977814963782642, 'auprc': 0.9986790714341635, 'loss_val': 0.024040277203784505, 'psi': 0.998140526400624}
[S4] START round=21 head_norm_before_train=1.295655 cos_to_last_merge=1.0000 (last merge round=20)
[S4] round=21 local utility u=0.024212 metrics={'f1_val': 0.9417508287063857, 'auprc': 0.9456501655905907, 'loss_val': 0.4409114802597657, 'psi': 0.9433105634600677}-{'f1_val': 0.9460581558396581, 'auprc': 0.9277535716641641, 'loss_val': 0.4614889989769797, 'psi': 0.9387363221694605}
[S5] START round=21 head_norm_before_train=1.043851 cos_to_last_merge=1.0000 (last merge round=20)
[S5] round=21 local utility u=0.047771 metrics={'f1_val': 0.6750978631678406, 'auprc': 0.8584693206812828, 'loss_val': 0.48531931153230273, 'psi': 0.7484464461732174}-{'f1_val': 0.6615785135877267, 'auprc': 0.8535909512096204, 'loss_val': 0.485109235573414, 'psi': 0.7383834886364842}
[S6] START round=21 head_norm_before_train=1.125919 cos_to_last_merge=1.0000 (last merge round=20)
[S6] round=21 local utility u=0.234347 metrics={'f1_val': 0.6962588633730848, 'auprc': 0.7933492754717624, 'loss_val': 0.4417860125533045, 'psi': 0.7350950282125559}-{'f1_val': 0.6974957881813026, 'auprc': 0.6707650301631902, 'loss_val': 0.5501479501096008, 'psi': 0.6868034849740576}
[S7] START round=21 head_norm_before_train=1.755016 (no previous merge yet)
[S7] round=21 local utility u=0.520183 metrics={'f1_val': 0.6702067347346536, 'auprc': 0.8278694879598598, 'loss_val': 0.3659856664844799, 'psi': 0.7332718360247361}-{'f1_val': 0.5788023417496563, 'auprc': 0.7854042945743771, 'loss_val': 0.7305290038413061, 'psi': 0.6614431228795447}
[S8] START round=21 head_norm_before_train=1.769884 (no previous merge yet)
[S8] round=21 local utility u=0.000000 metrics={'f1_val': 0.9927720833909908, 'auprc': 0.9902960207108057, 'loss_val': 0.08193240926343398, 'psi': 0.9917816583189167}-{'f1_val': 0.9922396549535559, 'auprc': 0.9992492938315727, 'loss_val': 0.067049036756734, 'psi': 0.9950435105047627}
[S9] START round=21 head_norm_before_train=0.990768 cos_to_last_merge=0.9870 (last merge round=19)
[S9] round=21 local utility u=0.073009 metrics={'f1_val': 0.9964101856672208, 'auprc': 0.994803045177512, 'loss_val': 0.14888523388338998, 'psi': 0.9957673294713373}-{'f1_val': 0.9964101856672208, 'auprc': 0.990915317371121, 'loss_val': 0.2832399686120557, 'psi': 0.9942122383487809}
[S10] START round=21 head_norm_before_train=1.535157 cos_to_last_merge=0.8496 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.850
[S10] round=21 local utility u=0.000000 metrics={'f1_val': 0.9957455607450773, 'auprc': 0.9941571526712285, 'loss_val': 0.08318109091946868, 'psi': 0.9951101975155376}-{'f1_val': 0.9961605415649639, 'auprc': 0.9962004491015092, 'loss_val': 0.08949248068783364, 'psi': 0.996176504579582}
[S11] START round=21 head_norm_before_train=1.036013 cos_to_last_merge=1.0000 (last merge round=20)
[S11] round=21 local utility u=0.938472 metrics={'f1_val': 0.9576492863673274, 'auprc': 0.9980445236148499, 'loss_val': 0.2991973900467494, 'psi': 0.9738073812663364}-{'f1_val': 0.6631945462157492, 'auprc': 0.9985635756973736, 'loss_val': 0.4109695152614197, 'psi': 0.797342158008399}
[S13] START round=21 head_norm_before_train=1.563350 (no previous merge yet)
[S13] round=21 local utility u=0.131675 metrics={'f1_val': 0.6253650328613195, 'auprc': 0.6790137972431669, 'loss_val': 0.6130564478246183, 'psi': 0.6468245386140584}-{'f1_val': 0.6023489362165051, 'auprc': 0.6844801357405457, 'loss_val': 0.7547082945772029, 'psi': 0.6352014160261213}
[S14] START round=21 head_norm_before_train=1.010656 cos_to_last_merge=1.0000 (last merge round=20)
[S14] round=21 local utility u=0.000000 metrics={'f1_val': 0.9961471738646706, 'auprc': 0.994608809273909, 'loss_val': 0.33056585509863146, 'psi': 0.9955318280283659}-{'f1_val': 0.9966530890084357, 'auprc': 0.9971723060987399, 'loss_val': 0.23049693830247914, 'psi': 0.9968607758445573}
[S15] START round=21 head_norm_before_train=1.238546 cos_to_last_merge=0.9958 (last merge round=18)
[S15] round=21 local utility u=0.000000 metrics={'f1_val': 0.8847739933073918, 'auprc': 0.9904746239485145, 'loss_val': 0.3053600554716668, 'psi': 0.9270542455638409}-{'f1_val': 0.8993725818896314, 'auprc': 0.9920133114348266, 'loss_val': 0.3162463395486561, 'psi': 0.9364288737077096}
[S16] START round=21 head_norm_before_train=1.623218 cos_to_last_merge=0.8312 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.831
[S16] round=21 local utility u=0.000000 metrics={'f1_val': 0.832397819854953, 'auprc': 0.9736774527547485, 'loss_val': 0.8869913998981809, 'psi': 0.8889096730148711}-{'f1_val': 0.9075033457290674, 'auprc': 0.9928801557551394, 'loss_val': 0.40662754223549064, 'psi': 0.9416540697394963}
[S17] START round=21 head_norm_before_train=1.258454 cos_to_last_merge=0.7758 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.776
[S17] round=21 local utility u=0.000000 metrics={'f1_val': 0.5563881585038917, 'auprc': 0.8319337350184881, 'loss_val': 0.5285022855440605, 'psi': 0.6666063891097302}-{'f1_val': 0.5218911662614889, 'auprc': 0.94831859135424, 'loss_val': 0.5509749705375089, 'psi': 0.6924621362985894}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:62414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:62410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:62415
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:62407
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:62410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S5] → sending delta(kind=head bytes=1792) to S9@127.0.0.1:62410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S4] → sending delta(kind=head bytes=1792) to S5@127.0.0.1:62405
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1792 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1792 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1802) from S7
[S6] cosine check vs S7: cos=0.5586
[S9] RECEIVED delta(kind=head bytes=1792) from S5
[S9] cosine check vs S5: cos=0.7568
[S15] RECEIVED delta(kind=head bytes=1798) from S6
[S15] cosine check vs S6: cos=0.8996
[S9] RECEIVED delta(kind=head bytes=1802) from S11
[S9] cosine check vs S11: cos=0.7167
[S9] RECEIVED delta(kind=head bytes=1798) from S13
[S9] cosine check vs S13: cos=-0.1409
[S9] DROPPED delta from S13 (cos=-0.1409 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1792) from S4
[S5] cosine check vs S4: cos=0.8294
[S14] RECEIVED delta(kind=head bytes=1798) from S9
[S14] cosine check vs S9: cos=0.5561
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=21 metric=0.9961 head_norm=1.049600
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.052860e-01
[S14] stored merged vector for next round verification (round=21)
[S14] DEBUG after merge:  round=21 metric=0.9966 head_norm=0.945386 delta_norm=0.505286
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=21 metric=0.8848 head_norm=1.277843
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.791056e-01
[S15] stored merged vector for next round verification (round=21)
[S15] DEBUG after merge:  round=21 metric=0.8983 head_norm=1.186755 delta_norm=0.279106
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=21 metric=0.6751 head_norm=1.084754
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.711843e-01
[S5] stored merged vector for next round verification (round=21)
[S5] DEBUG after merge:  round=21 metric=0.6955 head_norm=1.154473 delta_norm=0.371184
[S5] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=21 metric=0.9964 head_norm=1.093836
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.049439e-01
[S9] stored merged vector for next round verification (round=21)
[S9] DEBUG after merge:  round=21 metric=0.9964 head_norm=0.953411 delta_norm=0.204944
[S9] aggregate: ACCEPT kept=['S5', 'S11'] (k=2/2) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=21 metric=0.6963 head_norm=1.157452
[S6] _apply_head_vector_avg (torch): Δ‖w‖=7.384773e-01
[S6] stored merged vector for next round verification (round=21)
[S6] DEBUG after merge:  round=21 metric=0.6977 head_norm=1.299682 delta_norm=0.738477
[S6] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=2.028994 cos_to_last_merge=0.9999 (last merge round=19)
[S2] round=22 local utility u=0.004712 metrics={'f1_val': 0.7013101313728686, 'auprc': 0.6655011673119992, 'loss_val': 0.3023948504739835, 'psi': 0.6869865457485208}-{'f1_val': 0.7013101313728686, 'auprc': 0.6646229301341571, 'loss_val': 0.30918341688523077, 'psi': 0.686635250877384}
[S3] START round=22 head_norm_before_train=2.120784 (no previous merge yet)
[S3] round=22 local utility u=0.099986 metrics={'f1_val': 0.988972553129342, 'auprc': 0.9986754284226338, 'loss_val': 0.03037414335116711, 'psi': 0.9928537032466587}-{'f1_val': 0.9628852465428241, 'auprc': 0.9986742343176953, 'loss_val': 0.07381871443150578, 'psi': 0.9772008416527727}
[S4] START round=22 head_norm_before_train=1.328337 cos_to_last_merge=0.9993 (last merge round=20)
[S4] round=22 local utility u=0.052963 metrics={'f1_val': 0.9430072082129942, 'auprc': 0.9502235221345205, 'loss_val': 0.35624383145197686, 'psi': 0.9458937337816048}-{'f1_val': 0.9417508287063857, 'auprc': 0.9456501655905907, 'loss_val': 0.4409114802597657, 'psi': 0.9433105634600677}
[S5] START round=22 head_norm_before_train=1.154473 cos_to_last_merge=1.0000 (last merge round=21)
[S5] round=22 local utility u=0.025133 metrics={'f1_val': 0.6738435242620645, 'auprc': 0.8639872903636038, 'loss_val': 0.4440803221231659, 'psi': 0.7499010307026802}-{'f1_val': 0.6750978631678406, 'auprc': 0.8584693206812828, 'loss_val': 0.48531931153230273, 'psi': 0.7484464461732174}
[S6] START round=22 head_norm_before_train=1.299682 cos_to_last_merge=1.0000 (last merge round=21)
[S6] round=22 local utility u=0.000000 metrics={'f1_val': 0.698904112414095, 'auprc': 0.6748396899632796, 'loss_val': 0.4885531985289111, 'psi': 0.6892783434337688}-{'f1_val': 0.6962588633730848, 'auprc': 0.7933492754717624, 'loss_val': 0.4417860125533045, 'psi': 0.7350950282125559}
[S7] START round=22 head_norm_before_train=1.768996 (no previous merge yet)
[S7] round=22 local utility u=0.000000 metrics={'f1_val': 0.5817831200072769, 'auprc': 0.7891532913954595, 'loss_val': 0.8198709572337018, 'psi': 0.66473118856255}-{'f1_val': 0.6702067347346536, 'auprc': 0.8278694879598598, 'loss_val': 0.3659856664844799, 'psi': 0.7332718360247361}
[S8] START round=22 head_norm_before_train=1.791888 (no previous merge yet)
[S8] round=22 local utility u=0.016839 metrics={'f1_val': 0.9893480400613308, 'auprc': 0.9991770109796636, 'loss_val': 0.05435282844214664, 'psi': 0.993279628428664}-{'f1_val': 0.9927720833909908, 'auprc': 0.9902960207108057, 'loss_val': 0.08193240926343398, 'psi': 0.9917816583189167}
[S9] START round=22 head_norm_before_train=0.953411 cos_to_last_merge=1.0000 (last merge round=21)
[S9] round=22 local utility u=0.001677 metrics={'f1_val': 0.9955808965143278, 'auprc': 0.9948363938081175, 'loss_val': 0.14065626629974054, 'psi': 0.9952830954318437}-{'f1_val': 0.9964101856672208, 'auprc': 0.994803045177512, 'loss_val': 0.14888523388338998, 'psi': 0.9957673294713373}
[S10] START round=22 head_norm_before_train=1.557023 cos_to_last_merge=0.8484 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.848
[S10] round=22 local utility u=0.007157 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.995190361455017, 'loss_val': 0.07115050081812559, 'psi': 0.9954419366910188}-{'f1_val': 0.9957455607450773, 'auprc': 0.9941571526712285, 'loss_val': 0.08318109091946868, 'psi': 0.9951101975155376}
[S11] START round=22 head_norm_before_train=1.066337 cos_to_last_merge=0.9992 (last merge round=20)
[S11] round=22 local utility u=0.019378 metrics={'f1_val': 0.9571752623742852, 'auprc': 0.9980795029212364, 'loss_val': 0.2577031010235494, 'psi': 0.9735369585930657}-{'f1_val': 0.9576492863673274, 'auprc': 0.9980445236148499, 'loss_val': 0.2991973900467494, 'psi': 0.9738073812663364}
[S13] START round=22 head_norm_before_train=1.576766 (no previous merge yet)
[S13] round=22 local utility u=0.000000 metrics={'f1_val': 0.6030943942564199, 'auprc': 0.6860414184493107, 'loss_val': 0.7441230515292715, 'psi': 0.6362732039335761}-{'f1_val': 0.6253650328613195, 'auprc': 0.6790137972431669, 'loss_val': 0.6130564478246183, 'psi': 0.6468245386140584}
[S14] START round=22 head_norm_before_train=0.945386 cos_to_last_merge=1.0000 (last merge round=21)
[S14] round=22 local utility u=0.000000 metrics={'f1_val': 0.9802346418603992, 'auprc': 0.9960279606940015, 'loss_val': 0.32992473675850853, 'psi': 0.98655196939384}-{'f1_val': 0.9961471738646706, 'auprc': 0.994608809273909, 'loss_val': 0.33056585509863146, 'psi': 0.9955318280283659}
[S15] START round=22 head_norm_before_train=1.186755 cos_to_last_merge=1.0000 (last merge round=21)
[S15] round=22 local utility u=0.391507 metrics={'f1_val': 0.9970299290849798, 'auprc': 0.9980164178447566, 'loss_val': 0.21850608974976282, 'psi': 0.9974245245888904}-{'f1_val': 0.8847739933073918, 'auprc': 0.9904746239485145, 'loss_val': 0.3053600554716668, 'psi': 0.9270542455638409}
[S16] START round=22 head_norm_before_train=1.646276 cos_to_last_merge=0.8306 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.831
[S16] round=22 local utility u=0.262165 metrics={'f1_val': 0.8663676271898888, 'auprc': 0.993537212545996, 'loss_val': 0.6260596839428306, 'psi': 0.9172354613323317}-{'f1_val': 0.832397819854953, 'auprc': 0.9736774527547485, 'loss_val': 0.8869913998981809, 'psi': 0.8889096730148711}
[S17] START round=22 head_norm_before_train=1.284572 cos_to_last_merge=0.7723 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.772
[S17] round=22 local utility u=0.234851 metrics={'f1_val': 0.6309841856635297, 'auprc': 0.8319173530917429, 'loss_val': 0.5063275185140761, 'psi': 0.711357452634815}-{'f1_val': 0.5563881585038917, 'auprc': 0.8319337350184881, 'loss_val': 0.5285022855440605, 'psi': 0.6666063891097302}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:62404
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:62410
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] → sending delta(kind=head bytes=1794) to S4@127.0.0.1:62404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:62407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:62414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:62402
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:62414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:62405
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:62410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:62407
[S4] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S2] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1794 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1799) from S8
[S6] cosine check vs S8: cos=0.2264
[S6] RECEIVED delta(kind=head bytes=1796) from S2
[S6] cosine check vs S2: cos=0.3944
[S9] RECEIVED delta(kind=head bytes=1798) from S5
[S9] cosine check vs S5: cos=0.6723
[S5] RECEIVED delta(kind=head bytes=1803) from S4
[S5] cosine check vs S4: cos=0.9596
[S4] RECEIVED delta(kind=head bytes=1794) from S16
[S4] cosine check vs S16: cos=0.7643
[S4] RECEIVED delta(kind=head bytes=1798) from S10
[S4] cosine check vs S10: cos=0.8485
[S14] RECEIVED delta(kind=head bytes=1796) from S9
[S14] cosine check vs S9: cos=0.9117
[S14] RECEIVED delta(kind=head bytes=1798) from S15
[S14] cosine check vs S15: cos=0.6521
[S2] RECEIVED delta(kind=head bytes=1795) from S3
[S2] cosine check vs S3: cos=0.9934
[S9] RECEIVED delta(kind=head bytes=1801) from S11
[S9] cosine check vs S11: cos=0.7734
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:62405
[S17] sending update (kind=head size=1802 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1802) from S17
[S5] cosine check vs S17: cos=0.4370
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=22 metric=0.9802 head_norm=0.988402
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.672755e-01
[S14] stored merged vector for next round verification (round=22)
[S14] DEBUG after merge:  round=22 metric=0.9918 head_norm=0.946066 delta_norm=0.167275
[S14] aggregate: ACCEPT kept=['S9', 'S15'] (k=2/2) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=22 metric=0.6989 head_norm=1.321828
[S6] _apply_head_vector_avg (torch): Δ‖w‖=7.152869e-01
[S6] stored merged vector for next round verification (round=22)
[S6] DEBUG after merge:  round=22 metric=0.6975 head_norm=1.146235 delta_norm=0.715287
[S6] aggregate: ACCEPT kept=['S8', 'S2'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=22 metric=0.6738 head_norm=1.184732
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.457504e-01
[S5] stored merged vector for next round verification (round=22)
[S5] DEBUG after merge:  round=22 metric=0.6710 head_norm=1.083547 delta_norm=0.245750
[S5] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=22 metric=0.9430 head_norm=1.361418
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.072340e-01
[S4] stored merged vector for next round verification (round=22)
[S4] DEBUG after merge:  round=22 metric=0.9417 head_norm=1.338417 delta_norm=0.107234
[S4] aggregate: ACCEPT kept=['S16', 'S10'] (k=2/2) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=22 metric=0.7013 head_norm=2.035826
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.313664e-01
[S2] stored merged vector for next round verification (round=22)
[S2] DEBUG after merge:  round=22 metric=0.7013 head_norm=2.085896 delta_norm=0.131366
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=22 metric=0.9956 head_norm=1.050999
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.794306e-01
[S9] stored merged vector for next round verification (round=22)
[S9] DEBUG after merge:  round=22 metric=0.9956 head_norm=0.948111 delta_norm=0.179431
[S9] aggregate: ACCEPT kept=['S5', 'S11'] (k=2/2) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=2.085896 cos_to_last_merge=1.0000 (last merge round=22)
[S2] round=23 local utility u=0.000000 metrics={'f1_val': 0.7013101313728686, 'auprc': 0.6689332471962258, 'loss_val': 0.3431151366118999, 'psi': 0.6883593777022115}-{'f1_val': 0.7013101313728686, 'auprc': 0.6655011673119992, 'loss_val': 0.3023948504739835, 'psi': 0.6869865457485208}
[S3] START round=23 head_norm_before_train=2.142860 (no previous merge yet)
[S3] round=23 local utility u=0.000000 metrics={'f1_val': 0.9714863663074268, 'auprc': 0.9984915748232359, 'loss_val': 0.06234225651742327, 'psi': 0.9822884497137504}-{'f1_val': 0.988972553129342, 'auprc': 0.9986754284226338, 'loss_val': 0.03037414335116711, 'psi': 0.9928537032466587}
[S4] START round=23 head_norm_before_train=1.338417 cos_to_last_merge=1.0000 (last merge round=22)
[S4] round=23 local utility u=0.033353 metrics={'f1_val': 0.9438611163815438, 'auprc': 0.9650949353122045, 'loss_val': 0.339276376160368, 'psi': 0.9523546439538081}-{'f1_val': 0.9430072082129942, 'auprc': 0.9502235221345205, 'loss_val': 0.35624383145197686, 'psi': 0.9458937337816048}
[S5] START round=23 head_norm_before_train=1.083547 cos_to_last_merge=1.0000 (last merge round=22)
[S5] round=23 local utility u=0.394436 metrics={'f1_val': 0.7192269096510344, 'auprc': 0.9886903394389421, 'loss_val': 0.3016184306050163, 'psi': 0.8270122815661975}-{'f1_val': 0.6738435242620645, 'auprc': 0.8639872903636038, 'loss_val': 0.4440803221231659, 'psi': 0.7499010307026802}
[S6] START round=23 head_norm_before_train=1.146235 cos_to_last_merge=1.0000 (last merge round=22)
[S6] round=23 local utility u=0.218709 metrics={'f1_val': 0.6986329605274054, 'auprc': 0.7966584092338528, 'loss_val': 0.41496492928670836, 'psi': 0.7378431400099844}-{'f1_val': 0.698904112414095, 'auprc': 0.6748396899632796, 'loss_val': 0.4885531985289111, 'psi': 0.6892783434337688}
[S7] START round=23 head_norm_before_train=1.782860 (no previous merge yet)
[S7] round=23 local utility u=0.000000 metrics={'f1_val': 0.49134163330444325, 'auprc': 0.7798122920238854, 'loss_val': 1.0665991780341564, 'psi': 0.6067298967922201}-{'f1_val': 0.5817831200072769, 'auprc': 0.7891532913954595, 'loss_val': 0.8198709572337018, 'psi': 0.66473118856255}
[S8] START round=23 head_norm_before_train=1.814221 (no previous merge yet)
[S8] round=23 local utility u=0.000000 metrics={'f1_val': 0.9677849067133906, 'auprc': 0.9859482389960252, 'loss_val': 0.10552877624771757, 'psi': 0.9750502396264444}-{'f1_val': 0.9893480400613308, 'auprc': 0.9991770109796636, 'loss_val': 0.05435282844214664, 'psi': 0.993279628428664}
[S9] START round=23 head_norm_before_train=0.948111 cos_to_last_merge=1.0000 (last merge round=22)
[S9] round=23 local utility u=0.000000 metrics={'f1_val': 0.9964101856672208, 'auprc': 0.9917511271898282, 'loss_val': 0.13778130804681357, 'psi': 0.9945465622762638}-{'f1_val': 0.9955808965143278, 'auprc': 0.9948363938081175, 'loss_val': 0.14065626629974054, 'psi': 0.9952830954318437}
[S10] START round=23 head_norm_before_train=1.578237 cos_to_last_merge=0.8473 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.847
[S10] round=23 local utility u=0.005745 metrics={'f1_val': 0.9957455607450773, 'auprc': 0.995932002111426, 'loss_val': 0.06270031877866027, 'psi': 0.9958201372916167}-{'f1_val': 0.9956096535150197, 'auprc': 0.995190361455017, 'loss_val': 0.07115050081812559, 'psi': 0.9954419366910188}
[S11] START round=23 head_norm_before_train=1.102719 cos_to_last_merge=0.9969 (last merge round=20)
[S11] round=23 local utility u=0.142005 metrics={'f1_val': 0.9971362493929642, 'auprc': 0.9979158029742112, 'loss_val': 0.21296786837585274, 'psi': 0.997448070825463}-{'f1_val': 0.9571752623742852, 'auprc': 0.9980795029212364, 'loss_val': 0.2577031010235494, 'psi': 0.9735369585930657}
[S13] START round=23 head_norm_before_train=1.591681 (no previous merge yet)
[S13] round=23 local utility u=0.168836 metrics={'f1_val': 0.6319072967765758, 'auprc': 0.6772968877969935, 'loss_val': 0.5530946069129488, 'psi': 0.6500631331847428}-{'f1_val': 0.6030943942564199, 'auprc': 0.6860414184493107, 'loss_val': 0.7441230515292715, 'psi': 0.6362732039335761}
[S14] START round=23 head_norm_before_train=0.946066 cos_to_last_merge=1.0000 (last merge round=22)
[S14] round=23 local utility u=0.051371 metrics={'f1_val': 0.9935040503931286, 'auprc': 0.9952850691331919, 'loss_val': 0.3045702647188883, 'psi': 0.9942164578891539}-{'f1_val': 0.9802346418603992, 'auprc': 0.9960279606940015, 'loss_val': 0.32992473675850853, 'psi': 0.98655196939384}
[S15] START round=23 head_norm_before_train=1.221197 cos_to_last_merge=0.9993 (last merge round=21)
[S15] round=23 local utility u=0.000000 metrics={'f1_val': 0.7012386042308403, 'auprc': 0.7094449048439915, 'loss_val': 0.4701010709919385, 'psi': 0.7045211244761007}-{'f1_val': 0.9970299290849798, 'auprc': 0.9980164178447566, 'loss_val': 0.21850608974976282, 'psi': 0.9974245245888904}
[S16] START round=23 head_norm_before_train=1.668938 cos_to_last_merge=0.8302 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.830
[S16] round=23 local utility u=0.426830 metrics={'f1_val': 0.9400714457245819, 'auprc': 0.9925988020835832, 'loss_val': 0.21180703835258746, 'psi': 0.9610823882681824}-{'f1_val': 0.8663676271898888, 'auprc': 0.993537212545996, 'loss_val': 0.6260596839428306, 'psi': 0.9172354613323317}
[S17] START round=23 head_norm_before_train=1.312679 cos_to_last_merge=0.7687 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.769
[S17] round=23 local utility u=0.250338 metrics={'f1_val': 0.7493375089759546, 'auprc': 0.7651030629950111, 'loss_val': 0.5153275902682775, 'psi': 0.7556437305835773}-{'f1_val': 0.6309841856635297, 'auprc': 0.8319173530917429, 'loss_val': 0.5063275185140761, 'psi': 0.711357452634815}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:62415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:62405
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:62410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:62410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] → sending delta(kind=head bytes=1793) to S9@127.0.0.1:62410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:62412
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:62404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:62404
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1802 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1793 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1797) from S14
[S11] cosine check vs S14: cos=0.8959
[S9] RECEIVED delta(kind=head bytes=1793) from S5
[S9] cosine check vs S5: cos=0.7097
[S9] RECEIVED delta(kind=head bytes=1802) from S13
[S9] cosine check vs S13: cos=-0.1532
[S9] DROPPED delta from S13 (cos=-0.1532 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1802) from S11
[S9] cosine check vs S11: cos=0.7860
[S5] RECEIVED delta(kind=head bytes=1800) from S4
[S5] cosine check vs S4: cos=0.8901
[S15] RECEIVED delta(kind=head bytes=1797) from S6
[S15] cosine check vs S6: cos=0.9613
[S4] RECEIVED delta(kind=head bytes=1802) from S10
[S4] cosine check vs S10: cos=0.8280
[S4] RECEIVED delta(kind=head bytes=1799) from S16
[S4] cosine check vs S16: cos=0.7962
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:62405
[S17] sending update (kind=head size=1803 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1803) from S17
[S5] cosine check vs S17: cos=0.6033
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=23 metric=0.9964 head_norm=1.049107
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.479061e-01
[S9] stored merged vector for next round verification (round=23)
[S9] DEBUG after merge:  round=23 metric=0.9964 head_norm=0.955751 delta_norm=0.147906
[S9] aggregate: ACCEPT kept=['S5', 'S11'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=23 metric=0.7192 head_norm=1.135063
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.476352e-01
[S5] stored merged vector for next round verification (round=23)
[S5] DEBUG after merge:  round=23 metric=0.7722 head_norm=1.082173 delta_norm=0.147635
[S5] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=23 metric=0.9971 head_norm=1.137598
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.529891e-01
[S11] stored merged vector for next round verification (round=23)
[S11] DEBUG after merge:  round=23 metric=0.9971 head_norm=1.039142 delta_norm=0.252989
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=23 metric=0.9439 head_norm=1.365536
[S4] _apply_head_vector_avg (torch): Δ‖w‖=7.055778e-02
[S4] stored merged vector for next round verification (round=23)
[S4] DEBUG after merge:  round=23 metric=0.9432 head_norm=1.352584 delta_norm=0.070558
[S4] aggregate: ACCEPT kept=['S10', 'S16'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=23 metric=0.7012 head_norm=1.259784
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.743502e-01
[S15] stored merged vector for next round verification (round=23)
[S15] DEBUG after merge:  round=23 metric=0.7012 head_norm=1.206616 delta_norm=0.174350
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=2.095168 cos_to_last_merge=0.9999 (last merge round=22)
[S2] round=24 local utility u=0.028773 metrics={'f1_val': 0.7015710590385817, 'auprc': 0.6705411713758953, 'loss_val': 0.29195945614698504, 'psi': 0.6891591039735072}-{'f1_val': 0.7013101313728686, 'auprc': 0.6689332471962258, 'loss_val': 0.3431151366118999, 'psi': 0.6883593777022115}
[S3] START round=24 head_norm_before_train=2.162612 (no previous merge yet)
[S3] round=24 local utility u=0.099872 metrics={'f1_val': 0.9973696976584205, 'auprc': 0.9986701857625258, 'loss_val': 0.01843401192921183, 'psi': 0.9978898929000626}-{'f1_val': 0.9714863663074268, 'auprc': 0.9984915748232359, 'loss_val': 0.06234225651742327, 'psi': 0.9822884497137504}
[S4] START round=24 head_norm_before_train=1.352584 cos_to_last_merge=1.0000 (last merge round=23)
[S4] round=24 local utility u=0.000000 metrics={'f1_val': 0.9425796154249948, 'auprc': 0.9550716854937173, 'loss_val': 0.3280683769842265, 'psi': 0.9475764434524838}-{'f1_val': 0.9438611163815438, 'auprc': 0.9650949353122045, 'loss_val': 0.339276376160368, 'psi': 0.9523546439538081}
[S5] START round=24 head_norm_before_train=1.082173 cos_to_last_merge=1.0000 (last merge round=23)
[S5] round=24 local utility u=0.000000 metrics={'f1_val': 0.7006536512124258, 'auprc': 0.8742062176900673, 'loss_val': 0.41951633538053895, 'psi': 0.7700746778034824}-{'f1_val': 0.7192269096510344, 'auprc': 0.9886903394389421, 'loss_val': 0.3016184306050163, 'psi': 0.8270122815661975}
[S6] START round=24 head_norm_before_train=1.177109 cos_to_last_merge=0.9987 (last merge round=22)
[S6] round=24 local utility u=0.032064 metrics={'f1_val': 0.6989815326553506, 'auprc': 0.8051973954689431, 'loss_val': 0.37854561413871324, 'psi': 0.7414678777807876}-{'f1_val': 0.6986329605274054, 'auprc': 0.7966584092338528, 'loss_val': 0.41496492928670836, 'psi': 0.7378431400099844}
[S7] START round=24 head_norm_before_train=1.788478 (no previous merge yet)
[S7] round=24 local utility u=0.664031 metrics={'f1_val': 0.6206548265621001, 'auprc': 0.7954761256502475, 'loss_val': 0.561408503356642, 'psi': 0.6905833461973591}-{'f1_val': 0.49134163330444325, 'auprc': 0.7798122920238854, 'loss_val': 1.0665991780341564, 'psi': 0.6067298967922201}
[S8] START round=24 head_norm_before_train=1.835588 (no previous merge yet)
[S8] round=24 local utility u=0.108789 metrics={'f1_val': 0.9883147120629279, 'auprc': 0.9990725442878566, 'loss_val': 0.050502993588251735, 'psi': 0.9926178449528994}-{'f1_val': 0.9677849067133906, 'auprc': 0.9859482389960252, 'loss_val': 0.10552877624771757, 'psi': 0.9750502396264444}
[S9] START round=24 head_norm_before_train=0.955751 cos_to_last_merge=1.0000 (last merge round=23)
[S9] round=24 local utility u=0.000779 metrics={'f1_val': 0.9930734107733121, 'auprc': 0.9954359509299338, 'loss_val': 0.12725701164325906, 'psi': 0.9940184268359608}-{'f1_val': 0.9964101856672208, 'auprc': 0.9917511271898282, 'loss_val': 0.13778130804681357, 'psi': 0.9945465622762638}
[S10] START round=24 head_norm_before_train=1.602698 cos_to_last_merge=0.8457 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.846
[S10] round=24 local utility u=0.003286 metrics={'f1_val': 0.9957455607450773, 'auprc': 0.995837750080081, 'loss_val': 0.05584511105206254, 'psi': 0.9957824364790787}-{'f1_val': 0.9957455607450773, 'auprc': 0.995932002111426, 'loss_val': 0.06270031877866027, 'psi': 0.9958201372916167}
[S11] START round=24 head_norm_before_train=1.039142 cos_to_last_merge=1.0000 (last merge round=23)
[S11] round=24 local utility u=0.000000 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9957817259281561, 'loss_val': 0.2641079897343179, 'psi': 0.9963461421201716}-{'f1_val': 0.9971362493929642, 'auprc': 0.9979158029742112, 'loss_val': 0.21296786837585274, 'psi': 0.997448070825463}
[S13] START round=24 head_norm_before_train=1.605821 (no previous merge yet)
[S13] round=24 local utility u=0.000000 metrics={'f1_val': 0.6325620506999347, 'auprc': 0.6765742449516546, 'loss_val': 0.5978866156012053, 'psi': 0.6501669284006226}-{'f1_val': 0.6319072967765758, 'auprc': 0.6772968877969935, 'loss_val': 0.5530946069129488, 'psi': 0.6500631331847428}
[S14] START round=24 head_norm_before_train=0.996750 cos_to_last_merge=0.9966 (last merge round=22)
[S14] round=24 local utility u=0.051891 metrics={'f1_val': 0.9965942614647598, 'auprc': 0.995538798242745, 'loss_val': 0.22008983624428574, 'psi': 0.9961720761759538}-{'f1_val': 0.9935040503931286, 'auprc': 0.9952850691331919, 'loss_val': 0.3045702647188883, 'psi': 0.9942164578891539}
[S15] START round=24 head_norm_before_train=1.206616 cos_to_last_merge=1.0000 (last merge round=23)
[S15] round=24 local utility u=1.000000 metrics={'f1_val': 0.9945464447365507, 'auprc': 0.9980437840324929, 'loss_val': 0.20287026325245364, 'psi': 0.9959453804549276}-{'f1_val': 0.7012386042308403, 'auprc': 0.7094449048439915, 'loss_val': 0.4701010709919385, 'psi': 0.7045211244761007}
[S16] START round=24 head_norm_before_train=1.689371 cos_to_last_merge=0.8301 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.830
[S16] round=24 local utility u=0.000000 metrics={'f1_val': 0.9379674311426227, 'auprc': 0.993551677464962, 'loss_val': 0.243044663861056, 'psi': 0.9602011296715585}-{'f1_val': 0.9400714457245819, 'auprc': 0.9925988020835832, 'loss_val': 0.21180703835258746, 'psi': 0.9610823882681824}
[S17] START round=24 head_norm_before_train=1.341915 cos_to_last_merge=0.7649 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.765
[S17] round=24 local utility u=0.000000 metrics={'f1_val': 0.6357648831437573, 'auprc': 0.9162660232291092, 'loss_val': 0.4648811865450787, 'psi': 0.7479653391778981}-{'f1_val': 0.7493375089759546, 'auprc': 0.7651030629950111, 'loss_val': 0.5153275902682775, 'psi': 0.7556437305835773}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:62407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:62414
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:62414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] → sending delta(kind=head bytes=1794) to S15@127.0.0.1:62415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:62407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] → sending delta(kind=head bytes=1805) to S11@127.0.0.1:62412
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:62404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:62402
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] → sending delta(kind=head bytes=1805) to S6@127.0.0.1:62407
[S2] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1805 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1805 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1794 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1801) from S10
[S4] cosine check vs S10: cos=0.8175
[S2] RECEIVED delta(kind=head bytes=1795) from S3
[S2] cosine check vs S3: cos=0.9969
[S6] RECEIVED delta(kind=head bytes=1795) from S2
[S6] cosine check vs S2: cos=0.6775
[S6] RECEIVED delta(kind=head bytes=1795) from S8
[S6] cosine check vs S8: cos=0.5384
[S14] RECEIVED delta(kind=head bytes=1797) from S9
[S14] cosine check vs S9: cos=0.8758
[S6] RECEIVED delta(kind=head bytes=1805) from S7
[S6] cosine check vs S7: cos=0.5549
[S11] RECEIVED delta(kind=head bytes=1805) from S14
[S11] cosine check vs S14: cos=0.9691
[S14] RECEIVED delta(kind=head bytes=1800) from S15
[S14] cosine check vs S15: cos=0.7270
[S15] RECEIVED delta(kind=head bytes=1794) from S6
[S15] cosine check vs S6: cos=0.9855
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=24 metric=0.9426 head_norm=1.377903
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.695036e-01
[S4] stored merged vector for next round verification (round=24)
[S4] DEBUG after merge:  round=24 metric=0.9422 head_norm=1.433326 delta_norm=0.469504
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=24 metric=0.9967 head_norm=1.073506
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.327114e-01
[S11] stored merged vector for next round verification (round=24)
[S11] DEBUG after merge:  round=24 metric=0.9967 head_norm=1.056764 delta_norm=0.132711
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=24 metric=0.9966 head_norm=1.056555
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.605098e-01
[S14] stored merged vector for next round verification (round=24)
[S14] DEBUG after merge:  round=24 metric=0.9966 head_norm=0.996507 delta_norm=0.160510
[S14] aggregate: ACCEPT kept=['S9', 'S15'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=24 metric=0.9945 head_norm=1.247489
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.064417e-01
[S15] stored merged vector for next round verification (round=24)
[S15] DEBUG after merge:  round=24 metric=0.9945 head_norm=1.221489 delta_norm=0.106442
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=24 metric=0.6990 head_norm=1.204369
[S6] _apply_head_vector_avg (torch): Δ‖w‖=9.911413e-02
[S6] stored merged vector for next round verification (round=24)
[S6] DEBUG after merge:  round=24 metric=0.6990 head_norm=1.173466 delta_norm=0.099114
[S6] aggregate: ACCEPT kept=['S2', 'S8', 'S7'] (k=3/3) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=24 metric=0.7016 head_norm=2.104674
[S2] _apply_head_vector_avg (torch): Δ‖w‖=9.259601e-02
[S2] stored merged vector for next round verification (round=24)
[S2] DEBUG after merge:  round=24 metric=0.7016 head_norm=2.141433 delta_norm=0.092596
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=25 head_norm_before_train=2.141433 cos_to_last_merge=1.0000 (last merge round=24)
[S2] round=25 local utility u=0.000000 metrics={'f1_val': 0.7015710590385817, 'auprc': 0.6721128207263827, 'loss_val': 0.3242597259354628, 'psi': 0.6897877637137021}-{'f1_val': 0.7015710590385817, 'auprc': 0.6705411713758953, 'loss_val': 0.29195945614698504, 'psi': 0.6891591039735072}
[S3] START round=25 head_norm_before_train=2.181504 (no previous merge yet)
[S3] round=25 local utility u=0.000000 metrics={'f1_val': 0.9619616648309319, 'auprc': 0.9986572708172549, 'loss_val': 0.08484997616831035, 'psi': 0.976639907225461}-{'f1_val': 0.9973696976584205, 'auprc': 0.9986701857625258, 'loss_val': 0.01843401192921183, 'psi': 0.9978898929000626}
[S4] START round=25 head_norm_before_train=1.433326 cos_to_last_merge=1.0000 (last merge round=24)
[S4] round=25 local utility u=0.024963 metrics={'f1_val': 0.9420917357190448, 'auprc': 0.96405670580213, 'loss_val': 0.3021705368541253, 'psi': 0.950877723752279}-{'f1_val': 0.9425796154249948, 'auprc': 0.9550716854937173, 'loss_val': 0.3280683769842265, 'psi': 0.9475764434524838}
[S5] START round=25 head_norm_before_train=1.131419 cos_to_last_merge=0.9984 (last merge round=23)
[S5] round=25 local utility u=0.179068 metrics={'f1_val': 0.7501114875982829, 'auprc': 0.8856554961704592, 'loss_val': 0.3924758412457471, 'psi': 0.8043290910271534}-{'f1_val': 0.7006536512124258, 'auprc': 0.8742062176900673, 'loss_val': 0.41951633538053895, 'psi': 0.7700746778034824}
[S6] START round=25 head_norm_before_train=1.173466 cos_to_last_merge=1.0000 (last merge round=24)
[S6] round=25 local utility u=0.000000 metrics={'f1_val': 0.6970757036887518, 'auprc': 0.7770309876107813, 'loss_val': 0.4186490135253013, 'psi': 0.7290578172575636}-{'f1_val': 0.6989815326553506, 'auprc': 0.8051973954689431, 'loss_val': 0.37854561413871324, 'psi': 0.7414678777807876}
[S7] START round=25 head_norm_before_train=1.792539 (no previous merge yet)
[S7] round=25 local utility u=0.000000 metrics={'f1_val': 0.6267670071436922, 'auprc': 0.7954154829950275, 'loss_val': 0.6030076087752121, 'psi': 0.6942263974842263}-{'f1_val': 0.6206548265621001, 'auprc': 0.7954761256502475, 'loss_val': 0.561408503356642, 'psi': 0.6905833461973591}
[S8] START round=25 head_norm_before_train=1.853777 (no previous merge yet)
[S8] round=25 local utility u=0.015191 metrics={'f1_val': 0.9919185654646655, 'auprc': 0.9990426992472764, 'loss_val': 0.041654073738270875, 'psi': 0.9947682189777098}-{'f1_val': 0.9883147120629279, 'auprc': 0.9990725442878566, 'loss_val': 0.050502993588251735, 'psi': 0.9926178449528994}
[S9] START round=25 head_norm_before_train=1.055118 cos_to_last_merge=0.9944 (last merge round=23)
[S9] round=25 local utility u=0.027682 metrics={'f1_val': 0.9964101856672208, 'auprc': 0.9926915651930385, 'loss_val': 0.08368134577849741, 'psi': 0.9949227374775479}-{'f1_val': 0.9930734107733121, 'auprc': 0.9954359509299338, 'loss_val': 0.12725701164325906, 'psi': 0.9940184268359608}
[S10] START round=25 head_norm_before_train=1.628218 cos_to_last_merge=0.8440 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.844
[S10] round=25 local utility u=0.001222 metrics={'f1_val': 0.9957455607450773, 'auprc': 0.9952300935987044, 'loss_val': 0.05157829741306796, 'psi': 0.9955393738865281}-{'f1_val': 0.9957455607450773, 'auprc': 0.995837750080081, 'loss_val': 0.05584511105206254, 'psi': 0.9957824364790787}
[S11] START round=25 head_norm_before_train=1.056764 cos_to_last_merge=1.0000 (last merge round=24)
[S11] round=25 local utility u=0.000000 metrics={'f1_val': 0.9747648787362632, 'auprc': 0.9989156355405724, 'loss_val': 0.28794292196394905, 'psi': 0.984425181457987}-{'f1_val': 0.9967224195815153, 'auprc': 0.9957817259281561, 'loss_val': 0.2641079897343179, 'psi': 0.9963461421201716}
[S13] START round=25 head_norm_before_train=1.616815 (no previous merge yet)
[S13] round=25 local utility u=0.000000 metrics={'f1_val': 0.6052632828604533, 'auprc': 0.6864680125419744, 'loss_val': 0.8189770971447417, 'psi': 0.6377451747330618}-{'f1_val': 0.6325620506999347, 'auprc': 0.6765742449516546, 'loss_val': 0.5978866156012053, 'psi': 0.6501669284006226}
[S14] START round=25 head_norm_before_train=0.996507 cos_to_last_merge=1.0000 (last merge round=24)
[S14] round=25 local utility u=0.000000 metrics={'f1_val': 0.9965942614647598, 'auprc': 0.9955493640513333, 'loss_val': 0.225825053806074, 'psi': 0.9961763024993893}-{'f1_val': 0.9965942614647598, 'auprc': 0.995538798242745, 'loss_val': 0.22008983624428574, 'psi': 0.9961720761759538}
[S15] START round=25 head_norm_before_train=1.221489 cos_to_last_merge=1.0000 (last merge round=24)
[S15] round=25 local utility u=0.000000 metrics={'f1_val': 0.9703486574953063, 'auprc': 0.9953484763298877, 'loss_val': 0.21716396162048476, 'psi': 0.9803485850291389}-{'f1_val': 0.9945464447365507, 'auprc': 0.9980437840324929, 'loss_val': 0.20287026325245364, 'psi': 0.9959453804549276}
[S16] START round=25 head_norm_before_train=1.706743 cos_to_last_merge=0.8301 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.830
[S16] round=25 local utility u=0.000000 metrics={'f1_val': 0.90581334823078, 'auprc': 0.993665273229627, 'loss_val': 0.46247624050073954, 'psi': 0.9409541182303187}-{'f1_val': 0.9379674311426227, 'auprc': 0.993551677464962, 'loss_val': 0.243044663861056, 'psi': 0.9602011296715585}
[S17] START round=25 head_norm_before_train=1.378263 cos_to_last_merge=0.7605 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.760
[S17] round=25 local utility u=0.000000 metrics={'f1_val': 0.6151576929950581, 'auprc': 0.9353257848299039, 'loss_val': 0.524456976552565, 'psi': 0.7432249297289965}-{'f1_val': 0.6357648831437573, 'auprc': 0.9162660232291092, 'loss_val': 0.4648811865450787, 'psi': 0.7479653391778981}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:62414
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:62410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:62407
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:62404
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:62405
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1794 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1801) from S8
[S6] cosine check vs S8: cos=0.5256
[S9] RECEIVED delta(kind=head bytes=1794) from S5
[S9] cosine check vs S5: cos=0.6812
[S5] RECEIVED delta(kind=head bytes=1796) from S4
[S5] cosine check vs S4: cos=0.7701
[S4] RECEIVED delta(kind=head bytes=1803) from S10
[S4] cosine check vs S10: cos=0.9582
[S14] RECEIVED delta(kind=head bytes=1798) from S9
[S14] cosine check vs S9: cos=0.8443
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=25 metric=0.6971 head_norm=1.193300
[S6] _apply_head_vector_avg (torch): Δ‖w‖=8.021095e-01
[S6] stored merged vector for next round verification (round=25)
[S6] DEBUG after merge:  round=25 metric=0.6969 head_norm=1.347520 delta_norm=0.802110
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.100 → S15@127.0.0.1:62415
[S13] ⇄ pheromone p=0.068 → S9@127.0.0.1:62410
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=25 metric=0.9966 head_norm=1.052440
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.092768e-01
[S14] stored merged vector for next round verification (round=25)
[S14] DEBUG after merge:  round=25 metric=0.9953 head_norm=1.053985 delta_norm=0.309277
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.063 → S11@127.0.0.1:62412
[S2] ⇄ pheromone p=0.087 → S6@127.0.0.1:62407
[S15] ⇄ pheromone p=0.283 → S14@127.0.0.1:62414
[S11] ⇄ pheromone p=0.135 → S9@127.0.0.1:62410
[S7] ⇄ pheromone p=0.177 → S6@127.0.0.1:62407
[S3] ⇄ pheromone p=0.055 → S2@127.0.0.1:62402
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=25 metric=0.9964 head_norm=1.142560
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.617668e-01
[S9] stored merged vector for next round verification (round=25)
[S9] DEBUG after merge:  round=25 metric=0.9964 head_norm=1.059978 delta_norm=0.461767
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.032 → S14@127.0.0.1:62414
[S10] ⇄ pheromone p=0.042 → S4@127.0.0.1:62404
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=25 metric=0.9421 head_norm=1.460637
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.443806e-01
[S4] stored merged vector for next round verification (round=25)
[S4] DEBUG after merge:  round=25 metric=0.9421 head_norm=1.540462 delta_norm=0.244381
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.117 → S5@127.0.0.1:62405
[S8] ⇄ pheromone p=0.117 → S6@127.0.0.1:62407
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=25 metric=0.7501 head_norm=1.169666
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.664643e-01
[S5] stored merged vector for next round verification (round=25)
[S5] DEBUG after merge:  round=25 metric=0.7819 head_norm=1.238225 delta_norm=0.466464
[S5] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.135 → S9@127.0.0.1:62410
[S16] ⇄ pheromone p=0.150 → S4@127.0.0.1:62404
[S17] ⇄ pheromone p=0.122 → S5@127.0.0.1:62405
[S2] START round=26 head_norm_before_train=2.151361 cos_to_last_merge=0.9999 (last merge round=24)
[S2] round=26 local utility u=0.033286 metrics={'f1_val': 0.7013053875004437, 'auprc': 0.7307399015068607, 'loss_val': 0.43197551272692897, 'psi': 0.7130791931030105}-{'f1_val': 0.7015710590385817, 'auprc': 0.6721128207263827, 'loss_val': 0.3242597259354628, 'psi': 0.6897877637137021}
[S3] START round=26 head_norm_before_train=2.196559 (no previous merge yet)
[S3] round=26 local utility u=0.136163 metrics={'f1_val': 0.9978100342676263, 'auprc': 0.9984998397637328, 'loss_val': 0.027142211750429395, 'psi': 0.9980859564660689}-{'f1_val': 0.9619616648309319, 'auprc': 0.9986572708172549, 'loss_val': 0.08484997616831035, 'psi': 0.976639907225461}
[S4] START round=26 head_norm_before_train=1.540462 cos_to_last_merge=1.0000 (last merge round=25)
[S4] round=26 local utility u=0.010563 metrics={'f1_val': 0.9449350601870169, 'auprc': 0.9616630494928325, 'loss_val': 0.29092391776349275, 'psi': 0.9516262559093431}-{'f1_val': 0.9420917357190448, 'auprc': 0.96405670580213, 'loss_val': 0.3021705368541253, 'psi': 0.950877723752279}
[S5] START round=26 head_norm_before_train=1.238225 cos_to_last_merge=1.0000 (last merge round=25)
[S5] round=26 local utility u=0.000000 metrics={'f1_val': 0.7007816778637295, 'auprc': 0.8899451300542031, 'loss_val': 0.3841354816790708, 'psi': 0.7764470587399189}-{'f1_val': 0.7501114875982829, 'auprc': 0.8856554961704592, 'loss_val': 0.3924758412457471, 'psi': 0.8043290910271534}
[S6] START round=26 head_norm_before_train=1.347520 cos_to_last_merge=1.0000 (last merge round=25)
[S6] round=26 local utility u=0.258724 metrics={'f1_val': 0.6992486519707186, 'auprc': 0.9367522581886562, 'loss_val': 0.3934034479824637, 'psi': 0.7942500944578936}-{'f1_val': 0.6970757036887518, 'auprc': 0.7770309876107813, 'loss_val': 0.4186490135253013, 'psi': 0.7290578172575636}
[S7] START round=26 head_norm_before_train=1.801675 (no previous merge yet)
[S7] round=26 local utility u=0.545996 metrics={'f1_val': 0.6978764230884728, 'auprc': 0.8924999365542732, 'loss_val': 0.2289257068827277, 'psi': 0.775725828474793}-{'f1_val': 0.6267670071436922, 'auprc': 0.7954154829950275, 'loss_val': 0.6030076087752121, 'psi': 0.6942263974842263}
[S8] START round=26 head_norm_before_train=1.869336 (no previous merge yet)
[S8] round=26 local utility u=0.000000 metrics={'f1_val': 0.7140219655827275, 'auprc': 0.9852729041760966, 'loss_val': 0.38135948831167543, 'psi': 0.822522341020075}-{'f1_val': 0.9919185654646655, 'auprc': 0.9990426992472764, 'loss_val': 0.041654073738270875, 'psi': 0.9947682189777098}
[S9] START round=26 head_norm_before_train=1.059978 cos_to_last_merge=1.0000 (last merge round=25)
[S9] round=26 local utility u=0.000000 metrics={'f1_val': 0.9875711251504857, 'auprc': 0.9944711111242337, 'loss_val': 0.16335807325355467, 'psi': 0.990331119539985}-{'f1_val': 0.9964101856672208, 'auprc': 0.9926915651930385, 'loss_val': 0.08368134577849741, 'psi': 0.9949227374775479}
[S10] START round=26 head_norm_before_train=1.652885 cos_to_last_merge=0.8423 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.842
[S10] round=26 local utility u=0.003069 metrics={'f1_val': 0.9957455607450773, 'auprc': 0.9959338812643598, 'loss_val': 0.04755164977306048, 'psi': 0.9958208889527902}-{'f1_val': 0.9957455607450773, 'auprc': 0.9952300935987044, 'loss_val': 0.05157829741306796, 'psi': 0.9955393738865281}
[S11] START round=26 head_norm_before_train=1.093692 cos_to_last_merge=0.9989 (last merge round=24)
[S11] round=26 local utility u=0.094373 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9942428252661547, 'loss_val': 0.2169236014478211, 'psi': 0.9957305818553711}-{'f1_val': 0.9747648787362632, 'auprc': 0.9989156355405724, 'loss_val': 0.28794292196394905, 'psi': 0.984425181457987}
[S13] START round=26 head_norm_before_train=1.624507 (no previous merge yet)
[S13] round=26 local utility u=0.003092 metrics={'f1_val': 0.5972867904688697, 'auprc': 0.6778536201108732, 'loss_val': 0.7390917884945235, 'psi': 0.6295135223256711}-{'f1_val': 0.6052632828604533, 'auprc': 0.6864680125419744, 'loss_val': 0.8189770971447417, 'psi': 0.6377451747330618}
[S14] START round=26 head_norm_before_train=1.053985 cos_to_last_merge=1.0000 (last merge round=25)
[S14] round=26 local utility u=0.023303 metrics={'f1_val': 0.997011210853081, 'auprc': 0.996528194226307, 'loss_val': 0.18465780200284965, 'psi': 0.9968180042023714}-{'f1_val': 0.9965942614647598, 'auprc': 0.9955493640513333, 'loss_val': 0.225825053806074, 'psi': 0.9961763024993893}
[S15] START round=26 head_norm_before_train=1.265076 cos_to_last_merge=0.9988 (last merge round=24)
[S15] round=26 local utility u=0.000000 metrics={'f1_val': 0.700957864484732, 'auprc': 0.9150912304652541, 'loss_val': 0.43129291540638914, 'psi': 0.7866112108769409}-{'f1_val': 0.9703486574953063, 'auprc': 0.9953484763298877, 'loss_val': 0.21716396162048476, 'psi': 0.9803485850291389}
[S16] START round=26 head_norm_before_train=1.722482 cos_to_last_merge=0.8296 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.830
[S16] round=26 local utility u=0.000000 metrics={'f1_val': 0.8420524742002011, 'auprc': 0.9242823419914854, 'loss_val': 0.9184410229321476, 'psi': 0.8749444213167148}-{'f1_val': 0.90581334823078, 'auprc': 0.993665273229627, 'loss_val': 0.46247624050073954, 'psi': 0.9409541182303187}
[S17] START round=26 head_norm_before_train=1.415769 cos_to_last_merge=0.7563 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.756
[S17] round=26 local utility u=0.000000 metrics={'f1_val': 0.5964589440290368, 'auprc': 0.8124463613297295, 'loss_val': 0.6801943224063706, 'psi': 0.6828539109493139}-{'f1_val': 0.6151576929950581, 'auprc': 0.9353257848299039, 'loss_val': 0.524456976552565, 'psi': 0.7432249297289965}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:62404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:62405
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:62407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:62407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:62410
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:62410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:62402
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:62415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:62412
[S14] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1793 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1800) from S14
[S11] cosine check vs S14: cos=0.9624
[S6] RECEIVED delta(kind=head bytes=1800) from S7
[S6] cosine check vs S7: cos=0.2367
[S6] RECEIVED delta(kind=head bytes=1799) from S2
[S6] cosine check vs S2: cos=0.3286
[S9] RECEIVED delta(kind=head bytes=1799) from S13
[S9] cosine check vs S13: cos=-0.1193
[S9] DROPPED delta from S13 (cos=-0.1193 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1796) from S11
[S9] cosine check vs S11: cos=0.6964
[S5] RECEIVED delta(kind=head bytes=1793) from S4
[S5] cosine check vs S4: cos=0.9174
[S15] RECEIVED delta(kind=head bytes=1798) from S6
[S15] cosine check vs S6: cos=0.8376
[S4] RECEIVED delta(kind=head bytes=1803) from S10
[S4] cosine check vs S10: cos=0.9881
[S2] RECEIVED delta(kind=head bytes=1795) from S3
[S2] cosine check vs S3: cos=0.9982
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=26 metric=0.9876 head_norm=1.140738
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.439151e-01
[S9] stored merged vector for next round verification (round=26)
[S9] DEBUG after merge:  round=26 metric=0.9867 head_norm=1.049251 delta_norm=0.443915
[S9] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=26 metric=0.7010 head_norm=1.310020
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.821630e-01
[S15] stored merged vector for next round verification (round=26)
[S15] DEBUG after merge:  round=26 metric=0.7010 head_norm=1.282504 delta_norm=0.382163
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=26 metric=0.7008 head_norm=1.261266
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.250581e-01
[S5] stored merged vector for next round verification (round=26)
[S5] DEBUG after merge:  round=26 metric=0.7007 head_norm=1.386674 delta_norm=0.325058
[S5] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=26 metric=0.6992 head_norm=1.365861
[S6] _apply_head_vector_avg (torch): Δ‖w‖=7.939245e-01
[S6] stored merged vector for next round verification (round=26)
[S6] DEBUG after merge:  round=26 metric=0.6995 head_norm=1.186382 delta_norm=0.793925
[S6] aggregate: ACCEPT kept=['S7', 'S2'] (k=2/2) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=26 metric=0.7013 head_norm=2.161211
[S2] _apply_head_vector_avg (torch): Δ‖w‖=6.968665e-02
[S2] stored merged vector for next round verification (round=26)
[S2] DEBUG after merge:  round=26 metric=0.7013 head_norm=2.182698 delta_norm=0.069687
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=26 metric=0.9967 head_norm=1.137845
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.547797e-01
[S11] stored merged vector for next round verification (round=26)
[S11] DEBUG after merge:  round=26 metric=0.9967 head_norm=1.113451 delta_norm=0.154780
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=26 metric=0.9449 head_norm=1.570433
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.349937e-01
[S4] stored merged vector for next round verification (round=26)
[S4] DEBUG after merge:  round=26 metric=0.9449 head_norm=1.617026 delta_norm=0.134994
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=27 head_norm_before_train=2.182698 cos_to_last_merge=1.0000 (last merge round=26)
[S2] round=27 local utility u=0.419092 metrics={'f1_val': 0.8138287156160956, 'auprc': 0.7482209661476414, 'loss_val': 0.3213746658212676, 'psi': 0.787585615828714}-{'f1_val': 0.7013053875004437, 'auprc': 0.7307399015068607, 'loss_val': 0.43197551272692897, 'psi': 0.7130791931030105}
[S3] START round=27 head_norm_before_train=2.206178 (no previous merge yet)
[S3] round=27 local utility u=0.000000 metrics={'f1_val': 0.9781772032841529, 'auprc': 0.99853516634557, 'loss_val': 0.055839135120770565, 'psi': 0.9863203885087197}-{'f1_val': 0.9978100342676263, 'auprc': 0.9984998397637328, 'loss_val': 0.027142211750429395, 'psi': 0.9980859564660689}
[S4] START round=27 head_norm_before_train=1.617026 cos_to_last_merge=1.0000 (last merge round=26)
[S4] round=27 local utility u=0.041679 metrics={'f1_val': 0.95368195626584, 'auprc': 0.9636390485081412, 'loss_val': 0.26597624318343877, 'psi': 0.9576647931627604}-{'f1_val': 0.9449350601870169, 'auprc': 0.9616630494928325, 'loss_val': 0.29092391776349275, 'psi': 0.9516262559093431}
[S5] START round=27 head_norm_before_train=1.386674 cos_to_last_merge=1.0000 (last merge round=26)
[S5] round=27 local utility u=0.763983 metrics={'f1_val': 0.8978653189768798, 'auprc': 0.9835859024520264, 'loss_val': 0.31959287613239457, 'psi': 0.9321535523669384}-{'f1_val': 0.7007816778637295, 'auprc': 0.8899451300542031, 'loss_val': 0.3841354816790708, 'psi': 0.7764470587399189}
[S6] START round=27 head_norm_before_train=1.186382 cos_to_last_merge=1.0000 (last merge round=26)
[S6] round=27 local utility u=0.000000 metrics={'f1_val': 0.6975432307099426, 'auprc': 0.6731620541960271, 'loss_val': 0.4176458653448826, 'psi': 0.6877907601043765}-{'f1_val': 0.6992486519707186, 'auprc': 0.9367522581886562, 'loss_val': 0.3934034479824637, 'psi': 0.7942500944578936}
[S7] START round=27 head_norm_before_train=1.808088 (no previous merge yet)
[S7] round=27 local utility u=0.000000 metrics={'f1_val': 0.5199563887772332, 'auprc': 0.7812451140505965, 'loss_val': 0.9046712385426929, 'psi': 0.6244718788865785}-{'f1_val': 0.6978764230884728, 'auprc': 0.8924999365542732, 'loss_val': 0.2289257068827277, 'psi': 0.775725828474793}
[S8] START round=27 head_norm_before_train=1.883485 (no previous merge yet)
[S8] round=27 local utility u=1.000000 metrics={'f1_val': 0.9868628313097598, 'auprc': 0.9990946474822828, 'loss_val': 0.04921994625770144, 'psi': 0.991755557778769}-{'f1_val': 0.7140219655827275, 'auprc': 0.9852729041760966, 'loss_val': 0.38135948831167543, 'psi': 0.822522341020075}
[S9] START round=27 head_norm_before_train=1.049251 cos_to_last_merge=1.0000 (last merge round=26)
[S9] round=27 local utility u=0.059702 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9922837514415264, 'loss_val': 0.08946515420780154, 'psi': 0.9946635574441771}-{'f1_val': 0.9875711251504857, 'auprc': 0.9944711111242337, 'loss_val': 0.16335807325355467, 'psi': 0.990331119539985}
[S10] START round=27 head_norm_before_train=1.673240 cos_to_last_merge=0.8408 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.841
[S10] round=27 local utility u=0.000758 metrics={'f1_val': 0.9957455607450773, 'auprc': 0.9955811472671638, 'loss_val': 0.044978058193610504, 'psi': 0.9956797953539118}-{'f1_val': 0.9957455607450773, 'auprc': 0.9959338812643598, 'loss_val': 0.04755164977306048, 'psi': 0.9958208889527902}
[S11] START round=27 head_norm_before_train=1.113451 cos_to_last_merge=1.0000 (last merge round=26)
[S11] round=27 local utility u=0.003560 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9936819213753857, 'loss_val': 0.20957258480399546, 'psi': 0.9956513225259005}-{'f1_val': 0.9967224195815153, 'auprc': 0.9942428252661547, 'loss_val': 0.2169236014478211, 'psi': 0.9957305818553711}
[S13] START round=27 head_norm_before_train=1.631676 (no previous merge yet)
[S13] round=27 local utility u=0.165351 metrics={'f1_val': 0.6316043231103666, 'auprc': 0.6756845307328072, 'loss_val': 0.6077881359557842, 'psi': 0.6492364061593429}-{'f1_val': 0.5972867904688697, 'auprc': 0.6778536201108732, 'loss_val': 0.7390917884945235, 'psi': 0.6295135223256711}
[S14] START round=27 head_norm_before_train=1.110301 cos_to_last_merge=0.9982 (last merge round=25)
[S14] round=27 local utility u=0.020604 metrics={'f1_val': 0.9966004498019938, 'auprc': 0.9963138251795003, 'loss_val': 0.1403427751368582, 'psi': 0.9964857999529964}-{'f1_val': 0.997011210853081, 'auprc': 0.996528194226307, 'loss_val': 0.18465780200284965, 'psi': 0.9968180042023714}
[S15] START round=27 head_norm_before_train=1.282504 cos_to_last_merge=1.0000 (last merge round=26)
[S15] round=27 local utility u=1.000000 metrics={'f1_val': 0.9956670276427012, 'auprc': 0.9982745153952868, 'loss_val': 0.16112507667956422, 'psi': 0.9967100227437354}-{'f1_val': 0.700957864484732, 'auprc': 0.9150912304652541, 'loss_val': 0.43129291540638914, 'psi': 0.7866112108769409}
[S16] START round=27 head_norm_before_train=1.738365 cos_to_last_merge=0.8292 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.829
[S16] round=27 local utility u=0.619990 metrics={'f1_val': 0.9217127663998401, 'auprc': 0.9950172474108501, 'loss_val': 0.3686266294598405, 'psi': 0.9510345588042441}-{'f1_val': 0.8420524742002011, 'auprc': 0.9242823419914854, 'loss_val': 0.9184410229321476, 'psi': 0.8749444213167148}
[S17] START round=27 head_norm_before_train=1.450431 cos_to_last_merge=0.7529 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.753
[S17] round=27 local utility u=0.320187 metrics={'f1_val': 0.6216422280037677, 'auprc': 0.9408553567988669, 'loss_val': 0.5761472299713329, 'psi': 0.7493274795218074}-{'f1_val': 0.5964589440290368, 'auprc': 0.8124463613297295, 'loss_val': 0.6801943224063706, 'psi': 0.6828539109493139}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:62405
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:62412
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:62414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:62404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] → sending delta(kind=head bytes=1794) to S6@127.0.0.1:62407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:62410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:62410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:62414
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:62407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S4@127.0.0.1:62404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:62410
[S10] sending update (kind=head size=1804 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1794 to 1 peers)
[S2] sending update (kind=head size=1794 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1802) from S14
[S11] cosine check vs S14: cos=0.9859
[S6] RECEIVED delta(kind=head bytes=1794) from S2
[S6] cosine check vs S2: cos=0.6872
[S6] RECEIVED delta(kind=head bytes=1800) from S8
[S6] cosine check vs S8: cos=0.5316
[S9] RECEIVED delta(kind=head bytes=1796) from S11
[S9] cosine check vs S11: cos=0.9561
[S9] RECEIVED delta(kind=head bytes=1794) from S5
[S9] cosine check vs S5: cos=0.5087
[S5] RECEIVED delta(kind=head bytes=1797) from S4
[S5] cosine check vs S4: cos=0.9693
[S4] RECEIVED delta(kind=head bytes=1804) from S10
[S4] cosine check vs S10: cos=0.9951
[S4] RECEIVED delta(kind=head bytes=1798) from S16
[S4] cosine check vs S16: cos=0.4075
[S14] RECEIVED delta(kind=head bytes=1798) from S15
[S14] cosine check vs S15: cos=0.5493
[S14] RECEIVED delta(kind=head bytes=1796) from S9
[S14] cosine check vs S9: cos=0.9760
[S9] RECEIVED delta(kind=head bytes=1798) from S13
[S9] cosine check vs S13: cos=-0.1583
[S9] DROPPED delta from S13 (cos=-0.1583 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:62405
[S17] sending update (kind=head size=1799 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1799) from S17
[S5] cosine check vs S17: cos=0.2520
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=27 metric=0.6975 head_norm=1.211464
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.861720e-01
[S6] stored merged vector for next round verification (round=27)
[S6] DEBUG after merge:  round=27 metric=0.6969 head_norm=1.292664 delta_norm=0.386172
[S6] aggregate: ACCEPT kept=['S2', 'S8'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=27 metric=0.9966 head_norm=1.164386
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.827981e-01
[S14] stored merged vector for next round verification (round=27)
[S14] DEBUG after merge:  round=27 metric=0.9966 head_norm=1.068975 delta_norm=0.282798
[S14] aggregate: ACCEPT kept=['S15', 'S9'] (k=2/2) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=27 metric=0.9537 head_norm=1.644735
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.309882e-01
[S4] stored merged vector for next round verification (round=27)
[S4] DEBUG after merge:  round=27 metric=0.9530 head_norm=1.469471 delta_norm=0.430988
[S4] aggregate: ACCEPT kept=['S10', 'S16'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=27 metric=0.9963 head_norm=1.127574
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.831028e-01
[S9] stored merged vector for next round verification (round=27)
[S9] DEBUG after merge:  round=27 metric=0.9963 head_norm=1.051967 delta_norm=0.283103
[S9] aggregate: ACCEPT kept=['S11', 'S5'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=27 metric=0.9970 head_norm=1.156371
[S11] _apply_head_vector_avg (torch): Δ‖w‖=9.737829e-02
[S11] stored merged vector for next round verification (round=27)
[S11] DEBUG after merge:  round=27 metric=0.9970 head_norm=1.156292 delta_norm=0.097378
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=27 metric=0.8979 head_norm=1.405761
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.690146e-01
[S5] stored merged vector for next round verification (round=27)
[S5] DEBUG after merge:  round=27 metric=0.9200 head_norm=1.232859 delta_norm=0.369015
[S5] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S2] START round=28 head_norm_before_train=2.191113 cos_to_last_merge=1.0000 (last merge round=26)
[S2] round=28 local utility u=0.000000 metrics={'f1_val': 0.7052639519990935, 'auprc': 0.6983309791255577, 'loss_val': 0.37085948207610975, 'psi': 0.7024907628496793}-{'f1_val': 0.8138287156160956, 'auprc': 0.7482209661476414, 'loss_val': 0.3213746658212676, 'psi': 0.787585615828714}
[S3] START round=28 head_norm_before_train=2.220576 (no previous merge yet)
[S3] round=28 local utility u=0.000000 metrics={'f1_val': 0.960995754132836, 'auprc': 0.9986584177637994, 'loss_val': 0.11068838780846842, 'psi': 0.9760608195852214}-{'f1_val': 0.9781772032841529, 'auprc': 0.99853516634557, 'loss_val': 0.055839135120770565, 'psi': 0.9863203885087197}
[S4] START round=28 head_norm_before_train=1.469471 cos_to_last_merge=1.0000 (last merge round=27)
[S4] round=28 local utility u=0.000000 metrics={'f1_val': 0.89608931637804, 'auprc': 0.9218134332156088, 'loss_val': 0.3921969619052158, 'psi': 0.9063789631130675}-{'f1_val': 0.95368195626584, 'auprc': 0.9636390485081412, 'loss_val': 0.26597624318343877, 'psi': 0.9576647931627604}
[S5] START round=28 head_norm_before_train=1.232859 cos_to_last_merge=1.0000 (last merge round=27)
[S5] round=28 local utility u=0.000000 metrics={'f1_val': 0.700781124122831, 'auprc': 0.9653278490899925, 'loss_val': 0.38613580393412383, 'psi': 0.8065998141096955}-{'f1_val': 0.8978653189768798, 'auprc': 0.9835859024520264, 'loss_val': 0.31959287613239457, 'psi': 0.9321535523669384}
[S6] START round=28 head_norm_before_train=1.292664 cos_to_last_merge=1.0000 (last merge round=27)
[S6] round=28 local utility u=0.107260 metrics={'f1_val': 0.6975034410887344, 'auprc': 0.7421497349656486, 'loss_val': 0.4098508293850827, 'psi': 0.7153619586395001}-{'f1_val': 0.6975432307099426, 'auprc': 0.6731620541960271, 'loss_val': 0.4176458653448826, 'psi': 0.6877907601043765}
[S7] START round=28 head_norm_before_train=1.813424 (no previous merge yet)
[S7] round=28 local utility u=0.467802 metrics={'f1_val': 0.6218103447513761, 'auprc': 0.7879175160660727, 'loss_val': 0.6002089326006879, 'psi': 0.6882532132772547}-{'f1_val': 0.5199563887772332, 'auprc': 0.7812451140505965, 'loss_val': 0.9046712385426929, 'psi': 0.6244718788865785}
[S8] START round=28 head_norm_before_train=1.893866 (no previous merge yet)
[S8] round=28 local utility u=0.005707 metrics={'f1_val': 0.9881372834100528, 'auprc': 0.9988999976897719, 'loss_val': 0.04486852616961658, 'psi': 0.9924423691219404}-{'f1_val': 0.9868628313097598, 'auprc': 0.9990946474822828, 'loss_val': 0.04921994625770144, 'psi': 0.991755557778769}
[S9] START round=28 head_norm_before_train=1.051967 cos_to_last_merge=1.0000 (last merge round=27)
[S9] round=28 local utility u=0.000000 metrics={'f1_val': 0.9943332231862974, 'auprc': 0.9962142943995795, 'loss_val': 0.1224697079502361, 'psi': 0.9950856516716102}-{'f1_val': 0.9962500947792776, 'auprc': 0.9922837514415264, 'loss_val': 0.08946515420780154, 'psi': 0.9946635574441771}
[S10] START round=28 head_norm_before_train=1.693287 cos_to_last_merge=0.8394 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.839
[S10] round=28 local utility u=0.002060 metrics={'f1_val': 0.9957455607450773, 'auprc': 0.9959395760155039, 'loss_val': 0.04193362274520182, 'psi': 0.9958231668532478}-{'f1_val': 0.9957455607450773, 'auprc': 0.9955811472671638, 'loss_val': 0.044978058193610504, 'psi': 0.9956797953539118}
[S11] START round=28 head_norm_before_train=1.156292 cos_to_last_merge=1.0000 (last merge round=27)
[S11] round=28 local utility u=0.018182 metrics={'f1_val': 0.9971593530989756, 'auprc': 0.9985455313266671, 'loss_val': 0.18896934400135149, 'psi': 0.9977138243900523}-{'f1_val': 0.9969642566262439, 'auprc': 0.9936819213753857, 'loss_val': 0.20957258480399546, 'psi': 0.9956513225259005}
[S13] START round=28 head_norm_before_train=1.641144 (no previous merge yet)
[S13] round=28 local utility u=0.000000 metrics={'f1_val': 0.5975246867238589, 'auprc': 0.6886612970630914, 'loss_val': 0.8701738051904337, 'psi': 0.6339793308595519}-{'f1_val': 0.6316043231103666, 'auprc': 0.6756845307328072, 'loss_val': 0.6077881359557842, 'psi': 0.6492364061593429}
[S14] START round=28 head_norm_before_train=1.068975 cos_to_last_merge=1.0000 (last merge round=27)
[S14] round=28 local utility u=0.000000 metrics={'f1_val': 0.9964103030898727, 'auprc': 0.9970373804611303, 'loss_val': 0.16956640672963474, 'psi': 0.9966611340383758}-{'f1_val': 0.9966004498019938, 'auprc': 0.9963138251795003, 'loss_val': 0.1403427751368582, 'psi': 0.9964857999529964}
[S15] START round=28 head_norm_before_train=1.319463 cos_to_last_merge=0.9993 (last merge round=26)
[S15] round=28 local utility u=0.014469 metrics={'f1_val': 0.9954267983809711, 'auprc': 0.9979238630160183, 'loss_val': 0.12969356233638304, 'psi': 0.99642562423499}-{'f1_val': 0.9956670276427012, 'auprc': 0.9982745153952868, 'loss_val': 0.16112507667956422, 'psi': 0.9967100227437354}
[S16] START round=28 head_norm_before_train=1.754040 cos_to_last_merge=0.8290 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.829
[S16] round=28 local utility u=0.000000 metrics={'f1_val': 0.9145843123673014, 'auprc': 0.9947381241339044, 'loss_val': 0.42799373501765936, 'psi': 0.9466458370739426}-{'f1_val': 0.9217127663998401, 'auprc': 0.9950172474108501, 'loss_val': 0.3686266294598405, 'psi': 0.9510345588042441}
[S17] START round=28 head_norm_before_train=1.485854 cos_to_last_merge=0.7502 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.750
[S17] round=28 local utility u=0.217263 metrics={'f1_val': 0.6935727454241455, 'auprc': 0.9327469961161494, 'loss_val': 0.54887840993061, 'psi': 0.789242445700947}-{'f1_val': 0.6216422280037677, 'auprc': 0.9408553567988669, 'loss_val': 0.5761472299713329, 'psi': 0.7493274795218074}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:62414
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:62404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:62415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:62407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:62407
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:62410
[S8] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1804 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1796) from S8
[S6] cosine check vs S8: cos=0.6301
[S6] RECEIVED delta(kind=head bytes=1802) from S7
[S6] cosine check vs S7: cos=0.3027
[S15] RECEIVED delta(kind=head bytes=1804) from S6
[S15] cosine check vs S6: cos=0.9405
[S4] RECEIVED delta(kind=head bytes=1798) from S10
[S4] cosine check vs S10: cos=0.9420
[S14] RECEIVED delta(kind=head bytes=1803) from S15
[S14] cosine check vs S15: cos=0.7241
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:62405
[S17] sending update (kind=head size=1799 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1799) from S17
[S5] cosine check vs S17: cos=0.4785
[S11] sending update (kind=head size=1797 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1797) from S11
[S9] cosine check vs S11: cos=0.9209
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=28 metric=0.9943 head_norm=1.110127
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.347962e-01
[S9] stored merged vector for next round verification (round=28)
[S9] DEBUG after merge:  round=28 metric=0.9943 head_norm=1.134473 delta_norm=0.234796
[S9] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=28 metric=0.8961 head_norm=1.502666
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.928083e-01
[S4] stored merged vector for next round verification (round=28)
[S4] DEBUG after merge:  round=28 metric=0.8994 head_norm=1.584414 delta_norm=0.292808
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=28 metric=0.7008 head_norm=1.254108
[S5] _apply_head_vector_avg (torch): Δ‖w‖=7.162696e-01
[S5] stored merged vector for next round verification (round=28)
[S5] DEBUG after merge:  round=28 metric=0.7008 head_norm=1.192932 delta_norm=0.716270
[S5] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=28 metric=0.6975 head_norm=1.319725
[S6] _apply_head_vector_avg (torch): Δ‖w‖=5.237345e-01
[S6] stored merged vector for next round verification (round=28)
[S6] DEBUG after merge:  round=28 metric=0.6975 head_norm=1.195495 delta_norm=0.523734
[S6] aggregate: ACCEPT kept=['S8', 'S7'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=28 metric=0.9964 head_norm=1.114337
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.735142e-01
[S14] stored merged vector for next round verification (round=28)
[S14] DEBUG after merge:  round=28 metric=0.9964 head_norm=1.149616 delta_norm=0.473514
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=28 metric=0.9954 head_norm=1.360117
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.319765e-01
[S15] stored merged vector for next round verification (round=28)
[S15] DEBUG after merge:  round=28 metric=0.9954 head_norm=1.319842 delta_norm=0.231976
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=29 head_norm_before_train=2.200136 cos_to_last_merge=0.9999 (last merge round=26)
[S2] round=29 local utility u=0.092812 metrics={'f1_val': 0.7125130396805464, 'auprc': 0.7456167014291957, 'loss_val': 0.37058684225064475, 'psi': 0.7257545043800061}-{'f1_val': 0.7052639519990935, 'auprc': 0.6983309791255577, 'loss_val': 0.37085948207610975, 'psi': 0.7024907628496793}
[S3] START round=29 head_norm_before_train=2.236720 (no previous merge yet)
[S3] round=29 local utility u=0.156118 metrics={'f1_val': 0.9977814963782642, 'auprc': 0.9986233159865014, 'loss_val': 0.019060935711294226, 'psi': 0.9981182242215592}-{'f1_val': 0.960995754132836, 'auprc': 0.9986584177637994, 'loss_val': 0.11068838780846842, 'psi': 0.9760608195852214}
[S4] START round=29 head_norm_before_train=1.584414 cos_to_last_merge=1.0000 (last merge round=28)
[S4] round=29 local utility u=0.231130 metrics={'f1_val': 0.9416564117574289, 'auprc': 0.9468844465262727, 'loss_val': 0.2785533086934698, 'psi': 0.9437476256649664}-{'f1_val': 0.89608931637804, 'auprc': 0.9218134332156088, 'loss_val': 0.3921969619052158, 'psi': 0.9063789631130675}
[S5] START round=29 head_norm_before_train=1.192932 cos_to_last_merge=1.0000 (last merge round=28)
[S5] round=29 local utility u=0.393251 metrics={'f1_val': 0.8088933684263209, 'auprc': 0.9880296616493439, 'loss_val': 0.31641279945216705, 'psi': 0.88054788571553}-{'f1_val': 0.700781124122831, 'auprc': 0.9653278490899925, 'loss_val': 0.38613580393412383, 'psi': 0.8065998141096955}
[S6] START round=29 head_norm_before_train=1.195495 cos_to_last_merge=1.0000 (last merge round=28)
[S6] round=29 local utility u=0.000000 metrics={'f1_val': 0.697930947547604, 'auprc': 0.6696215188276939, 'loss_val': 0.40792510640169083, 'psi': 0.68660717605964}-{'f1_val': 0.6975034410887344, 'auprc': 0.7421497349656486, 'loss_val': 0.4098508293850827, 'psi': 0.7153619586395001}
[S7] START round=29 head_norm_before_train=1.817824 (no previous merge yet)
[S7] round=29 local utility u=0.032690 metrics={'f1_val': 0.6212638309619642, 'auprc': 0.7930669343493648, 'loss_val': 0.5469976303902474, 'psi': 0.6899850723169245}-{'f1_val': 0.6218103447513761, 'auprc': 0.7879175160660727, 'loss_val': 0.6002089326006879, 'psi': 0.6882532132772547}
[S8] START round=29 head_norm_before_train=1.904263 (no previous merge yet)
[S8] round=29 local utility u=0.020262 metrics={'f1_val': 0.9937333839017813, 'auprc': 0.998366762274665, 'loss_val': 0.03632084727549242, 'psi': 0.9955867352509348}-{'f1_val': 0.9881372834100528, 'auprc': 0.9988999976897719, 'loss_val': 0.04486852616961658, 'psi': 0.9924423691219404}
[S9] START round=29 head_norm_before_train=1.134473 cos_to_last_merge=1.0000 (last merge round=28)
[S9] round=29 local utility u=0.028285 metrics={'f1_val': 0.9959957888192151, 'auprc': 0.9963349941640377, 'loss_val': 0.0762381397861099, 'psi': 0.996131470957144}-{'f1_val': 0.9943332231862974, 'auprc': 0.9962142943995795, 'loss_val': 0.1224697079502361, 'psi': 0.9950856516716102}
[S10] START round=29 head_norm_before_train=1.712951 cos_to_last_merge=0.8379 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.838
[S10] round=29 local utility u=0.000000 metrics={'f1_val': 0.9957455607450773, 'auprc': 0.9952486959952209, 'loss_val': 0.039996138595901586, 'psi': 0.9955468148451347}-{'f1_val': 0.9957455607450773, 'auprc': 0.9959395760155039, 'loss_val': 0.04193362274520182, 'psi': 0.9958231668532478}
[S11] START round=29 head_norm_before_train=1.204962 cos_to_last_merge=0.9985 (last merge round=27)
[S11] round=29 local utility u=0.023024 metrics={'f1_val': 0.9978150241471516, 'auprc': 0.9989416174530595, 'loss_val': 0.1480444460476552, 'psi': 0.9982656614695148}-{'f1_val': 0.9971593530989756, 'auprc': 0.9985455313266671, 'loss_val': 0.18896934400135149, 'psi': 0.9977138243900523}
[S13] START round=29 head_norm_before_train=1.647550 (no previous merge yet)
[S13] round=29 local utility u=0.000000 metrics={'f1_val': 0.5737050540412533, 'auprc': 0.6883930848345596, 'loss_val': 0.9589063218392245, 'psi': 0.6195802663585759}-{'f1_val': 0.5975246867238589, 'auprc': 0.6886612970630914, 'loss_val': 0.8701738051904337, 'psi': 0.6339793308595519}
[S14] START round=29 head_norm_before_train=1.149616 cos_to_last_merge=1.0000 (last merge round=28)
[S14] round=29 local utility u=0.000000 metrics={'f1_val': 0.9964103030898727, 'auprc': 0.9954646394463688, 'loss_val': 0.21472502514861763, 'psi': 0.9960320376324712}-{'f1_val': 0.9964103030898727, 'auprc': 0.9970373804611303, 'loss_val': 0.16956640672963474, 'psi': 0.9966611340383758}
[S15] START round=29 head_norm_before_train=1.319842 cos_to_last_merge=1.0000 (last merge round=28)
[S15] round=29 local utility u=0.001223 metrics={'f1_val': 0.9970299290849798, 'auprc': 0.9973247287254361, 'loss_val': 0.13506875459202639, 'psi': 0.9971478489411623}-{'f1_val': 0.9954267983809711, 'auprc': 0.9979238630160183, 'loss_val': 0.12969356233638304, 'psi': 0.99642562423499}
[S16] START round=29 head_norm_before_train=1.764081 cos_to_last_merge=0.8290 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.829
[S16] round=29 local utility u=0.000000 metrics={'f1_val': 0.871782088761974, 'auprc': 0.9549244039929523, 'loss_val': 0.6949829274107439, 'psi': 0.9050390148543654}-{'f1_val': 0.9145843123673014, 'auprc': 0.9947381241339044, 'loss_val': 0.42799373501765936, 'psi': 0.9466458370739426}
[S17] START round=29 head_norm_before_train=1.516400 cos_to_last_merge=0.7485 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.748
[S17] round=29 local utility u=0.000000 metrics={'f1_val': 0.5806839351480656, 'auprc': 0.8748063208065446, 'loss_val': 0.7995047725766304, 'psi': 0.6983328894114572}-{'f1_val': 0.6935727454241455, 'auprc': 0.9327469961161494, 'loss_val': 0.54887840993061, 'psi': 0.789242445700947}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] sending update (kind=head size=1794 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] → sending delta(kind=head bytes=1805) to S6@127.0.0.1:62407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:62405
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:62403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:62416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:62414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] → sending delta(kind=head bytes=1793) to S17@127.0.0.1:62417
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1793 to 1 peers)
[S4] sending update (kind=head size=1795 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1805 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1805) from S15
[S6] cosine check vs S15: cos=0.9580
[S17] RECEIVED delta(kind=head bytes=1793) from S5
[S17] cosine check vs S5: cos=0.8802
[S16] RECEIVED delta(kind=head bytes=1795) from S4
[S16] cosine check vs S4: cos=0.4852
[S3] RECEIVED delta(kind=head bytes=1796) from S2
[S3] cosine check vs S2: cos=0.9985
[S5] RECEIVED delta(kind=head bytes=1802) from S9
[S5] cosine check vs S9: cos=0.5843
[S14] RECEIVED delta(kind=head bytes=1801) from S11
[S14] cosine check vs S11: cos=0.8202
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=29 metric=0.9964 head_norm=1.184065
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.672259e-01
[S14] stored merged vector for next round verification (round=29)
[S14] DEBUG after merge:  round=29 metric=0.9964 head_norm=1.163410 delta_norm=0.367226
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=29 metric=0.6979 head_norm=1.224165
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.979095e-01
[S6] stored merged vector for next round verification (round=29)
[S6] DEBUG after merge:  round=29 metric=0.6975 head_norm=1.276506 delta_norm=0.197910
[S6] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=29 metric=0.9978 head_norm=2.248320
[S3] _apply_head_vector_avg (torch): Δ‖w‖=6.406131e-02
[S3] stored merged vector for next round verification (round=29)
[S3] DEBUG after merge:  round=29 metric=0.9978 head_norm=2.228174 delta_norm=0.064061
[S3] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=29 metric=0.8089 head_norm=1.219898
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.487955e-01
[S5] stored merged vector for next round verification (round=29)
[S5] DEBUG after merge:  round=29 metric=0.8040 head_norm=1.071090 delta_norm=0.548796
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=29 metric=0.5807 head_norm=1.544374
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.731018e-01
[S17] stored merged vector for next round verification (round=29)
[S17] DEBUG after merge:  round=29 metric=0.5981 head_norm=1.340677 delta_norm=0.373102
[S17] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=29 metric=0.8718 head_norm=1.774354
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.617280e-01
[S16] stored merged vector for next round verification (round=29)
[S16] DEBUG after merge:  round=29 metric=0.8746 head_norm=1.459369 delta_norm=0.861728
[S16] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=30 head_norm_before_train=2.209703 cos_to_last_merge=0.9997 (last merge round=26)
[S2] round=30 local utility u=0.349848 metrics={'f1_val': 0.8253821004526262, 'auprc': 0.7517588616397641, 'loss_val': 0.36653266499645737, 'psi': 0.7959328049274813}-{'f1_val': 0.7125130396805464, 'auprc': 0.7456167014291957, 'loss_val': 0.37058684225064475, 'psi': 0.7257545043800061}
[S3] START round=30 head_norm_before_train=2.228174 cos_to_last_merge=1.0000 (last merge round=29)
[S3] round=30 local utility u=0.000000 metrics={'f1_val': 0.960995754132836, 'auprc': 0.9984888291486185, 'loss_val': 0.12846331668294866, 'psi': 0.975992984139149}-{'f1_val': 0.9977814963782642, 'auprc': 0.9986233159865014, 'loss_val': 0.019060935711294226, 'psi': 0.9981182242215592}
[S4] START round=30 head_norm_before_train=1.611314 cos_to_last_merge=0.9996 (last merge round=28)
[S4] round=30 local utility u=0.000000 metrics={'f1_val': 0.940040402278374, 'auprc': 0.9318712841230027, 'loss_val': 0.28921045796464623, 'psi': 0.9367727550162255}-{'f1_val': 0.9416564117574289, 'auprc': 0.9468844465262727, 'loss_val': 0.2785533086934698, 'psi': 0.9437476256649664}
[S5] START round=30 head_norm_before_train=1.071090 cos_to_last_merge=1.0000 (last merge round=29)
[S5] round=30 local utility u=0.596807 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.99303574298535, 'loss_val': 0.2646677231204501, 'psi': 0.9952354782812146}-{'f1_val': 0.8088933684263209, 'auprc': 0.9880296616493439, 'loss_val': 0.31641279945216705, 'psi': 0.88054788571553}
[S6] START round=30 head_norm_before_train=1.276506 cos_to_last_merge=1.0000 (last merge round=29)
[S6] round=30 local utility u=0.012476 metrics={'f1_val': 0.6981846282984305, 'auprc': 0.6708857926061471, 'loss_val': 0.38828706422283854, 'psi': 0.6872650940215173}-{'f1_val': 0.697930947547604, 'auprc': 0.6696215188276939, 'loss_val': 0.40792510640169083, 'psi': 0.68660717605964}
[S7] START round=30 head_norm_before_train=1.825147 (no previous merge yet)
[S7] round=30 local utility u=0.000000 metrics={'f1_val': 0.6248710751301577, 'auprc': 0.7965897329946144, 'loss_val': 0.593659778888562, 'psi': 0.6935585382759404}-{'f1_val': 0.6212638309619642, 'auprc': 0.7930669343493648, 'loss_val': 0.5469976303902474, 'psi': 0.6899850723169245}
[S8] START round=30 head_norm_before_train=1.914588 (no previous merge yet)
[S8] round=30 local utility u=0.000000 metrics={'f1_val': 0.9926035371309061, 'auprc': 0.9990992486176368, 'loss_val': 0.03638931972444488, 'psi': 0.9952018217255985}-{'f1_val': 0.9937333839017813, 'auprc': 0.998366762274665, 'loss_val': 0.03632084727549242, 'psi': 0.9955867352509348}
[S9] START round=30 head_norm_before_train=1.186874 cos_to_last_merge=0.9991 (last merge round=28)
[S9] round=30 local utility u=0.000801 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9909170025556785, 'loss_val': 0.06237137008452489, 'psi': 0.9943631081106062}-{'f1_val': 0.9959957888192151, 'auprc': 0.9963349941640377, 'loss_val': 0.0762381397861099, 'psi': 0.996131470957144}
[S10] START round=30 head_norm_before_train=1.731848 cos_to_last_merge=0.8364 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.836
[S10] round=30 local utility u=0.000027 metrics={'f1_val': 0.9957455607450773, 'auprc': 0.9947341914061028, 'loss_val': 0.038398678330802856, 'psi': 0.9953410130094874}-{'f1_val': 0.9957455607450773, 'auprc': 0.9952486959952209, 'loss_val': 0.039996138595901586, 'psi': 0.9955468148451347}
[S11] START round=30 head_norm_before_train=1.254887 cos_to_last_merge=0.9950 (last merge round=27)
[S11] round=30 local utility u=0.014363 metrics={'f1_val': 0.9974011907167429, 'auprc': 0.9983950745526197, 'loss_val': 0.11519518004813223, 'psi': 0.9977987442510936}-{'f1_val': 0.9978150241471516, 'auprc': 0.9989416174530595, 'loss_val': 0.1480444460476552, 'psi': 0.9982656614695148}
[S13] START round=30 head_norm_before_train=1.654442 (no previous merge yet)
[S13] round=30 local utility u=0.164999 metrics={'f1_val': 0.582559646595191, 'auprc': 0.6813062291396873, 'loss_val': 0.6607760190879608, 'psi': 0.6220582796129895}-{'f1_val': 0.5737050540412533, 'auprc': 0.6883930848345596, 'loss_val': 0.9589063218392245, 'psi': 0.6195802663585759}
[S14] START round=30 head_norm_before_train=1.163410 cos_to_last_merge=1.0000 (last merge round=29)
[S14] round=30 local utility u=0.044418 metrics={'f1_val': 0.9961701069502772, 'auprc': 0.9951562806981482, 'loss_val': 0.12352327617007802, 'psi': 0.9957645764494256}-{'f1_val': 0.9964103030898727, 'auprc': 0.9954646394463688, 'loss_val': 0.21472502514861763, 'psi': 0.9960320376324712}
[S15] START round=30 head_norm_before_train=1.355983 cos_to_last_merge=0.9994 (last merge round=28)
[S15] round=30 local utility u=0.000000 metrics={'f1_val': 0.7012363580370753, 'auprc': 0.904845502807607, 'loss_val': 0.4487974976671568, 'psi': 0.782680015945288}-{'f1_val': 0.9970299290849798, 'auprc': 0.9973247287254361, 'loss_val': 0.13506875459202639, 'psi': 0.9971478489411623}
[S16] START round=30 head_norm_before_train=1.459369 cos_to_last_merge=1.0000 (last merge round=29)
[S16] round=30 local utility u=0.725946 metrics={'f1_val': 0.9919455454822041, 'auprc': 0.9930088385733209, 'loss_val': 0.07832546052427956, 'psi': 0.9923708627186508}-{'f1_val': 0.871782088761974, 'auprc': 0.9549244039929523, 'loss_val': 0.6949829274107439, 'psi': 0.9050390148543654}
[S17] START round=30 head_norm_before_train=1.340677 cos_to_last_merge=1.0000 (last merge round=29)
[S17] round=30 local utility u=0.046735 metrics={'f1_val': 0.588425997219695, 'auprc': 0.8675241803539342, 'loss_val': 0.7306413437469015, 'psi': 0.7000652704733907}-{'f1_val': 0.5806839351480656, 'auprc': 0.8748063208065446, 'loss_val': 0.7995047725766304, 'psi': 0.6983328894114572}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S5] → sending delta(kind=head bytes=1789) to S17@127.0.0.1:62417
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:62414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:62405
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:62408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:62403
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1789 to 1 peers)
[S2] sending update (kind=head size=1796 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1789) from S5
[S17] cosine check vs S5: cos=0.8322
[S3] RECEIVED delta(kind=head bytes=1796) from S2
[S3] cosine check vs S2: cos=0.9993
[S7] RECEIVED delta(kind=head bytes=1799) from S6
[S7] cosine check vs S6: cos=0.4400
[S5] RECEIVED delta(kind=head bytes=1795) from S9
[S5] cosine check vs S9: cos=0.8782
[S14] RECEIVED delta(kind=head bytes=1803) from S11
[S14] cosine check vs S11: cos=0.9558
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S16] sending update (kind=head size=1806 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:62415
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1797) from S14
[S15] cosine check vs S14: cos=0.7692
[S9] ⇄ pheromone p=0.021 → S5@127.0.0.1:62405
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=30 metric=0.9962 head_norm=1.197591
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.923257e-01
[S14] stored merged vector for next round verification (round=30)
[S14] DEBUG after merge:  round=30 metric=0.9966 head_norm=1.234548 delta_norm=0.192326
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.034 → S15@127.0.0.1:62415
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=30 metric=0.6249 head_norm=1.836676
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.607110e-01
[S7] stored merged vector for next round verification (round=30)
[S7] DEBUG after merge:  round=30 metric=0.6224 head_norm=1.338709 delta_norm=0.860711
[S7] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.061 → S14@127.0.0.1:62414
[S4] ⇄ pheromone p=0.080 → S16@127.0.0.1:62416
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=30 metric=0.7012 head_norm=1.393189
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.495767e-01
[S15] stored merged vector for next round verification (round=30)
[S15] DEBUG after merge:  round=30 metric=0.7012 head_norm=1.218803 delta_norm=0.449577
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.197 → S6@127.0.0.1:62407
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=30 metric=0.9610 head_norm=2.241105
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.238304e-02
[S3] stored merged vector for next round verification (round=30)
[S3] DEBUG after merge:  round=30 metric=0.9610 head_norm=2.230014 delta_norm=0.042383
[S3] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=30 metric=0.9967 head_norm=1.105645
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.951201e-01
[S5] stored merged vector for next round verification (round=30)
[S5] DEBUG after merge:  round=30 metric=0.9967 head_norm=1.133279 delta_norm=0.295120
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.305 → S17@127.0.0.1:62417
[S6] ⇄ pheromone p=0.070 → S7@127.0.0.1:62408
[S2] ⇄ pheromone p=0.159 → S3@127.0.0.1:62403
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=30 metric=0.5884 head_norm=1.367751
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.795767e-01
[S17] stored merged vector for next round verification (round=30)
[S17] DEBUG after merge:  round=30 metric=0.5942 head_norm=1.184279 delta_norm=0.379577
[S17] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.110 → S5@127.0.0.1:62405
[S2] START round=31 head_norm_before_train=2.219676 cos_to_last_merge=0.9994 (last merge round=26)
[S2] round=31 local utility u=0.020474 metrics={'f1_val': 0.8256757088349882, 'auprc': 0.7720320613650347, 'loss_val': 0.38816668738352117, 'psi': 0.8042182498470067}-{'f1_val': 0.8253821004526262, 'auprc': 0.7517588616397641, 'loss_val': 0.36653266499645737, 'psi': 0.7959328049274813}
[S3] START round=31 head_norm_before_train=2.230014 cos_to_last_merge=1.0000 (last merge round=30)
[S3] round=31 local utility u=0.164287 metrics={'f1_val': 0.9973696976584205, 'auprc': 0.9985655839599821, 'loss_val': 0.018362982248981266, 'psi': 0.9978480521790452}-{'f1_val': 0.960995754132836, 'auprc': 0.9984888291486185, 'loss_val': 0.12846331668294866, 'psi': 0.975992984139149}
[S4] START round=31 head_norm_before_train=1.634187 cos_to_last_merge=0.9987 (last merge round=28)
[S4] round=31 local utility u=0.041255 metrics={'f1_val': 0.9418773291585314, 'auprc': 0.9485661112676107, 'loss_val': 0.26780607407273305, 'psi': 0.9445528420021632}-{'f1_val': 0.940040402278374, 'auprc': 0.9318712841230027, 'loss_val': 0.28921045796464623, 'psi': 0.9367727550162255}
[S5] START round=31 head_norm_before_train=1.133279 cos_to_last_merge=1.0000 (last merge round=30)
[S5] round=31 local utility u=0.000000 metrics={'f1_val': 0.9971410286679584, 'auprc': 0.994334960899269, 'loss_val': 0.27204273061501505, 'psi': 0.9960186015604826}-{'f1_val': 0.9967019684784577, 'auprc': 0.99303574298535, 'loss_val': 0.2646677231204501, 'psi': 0.9952354782812146}
[S6] START round=31 head_norm_before_train=1.300980 cos_to_last_merge=0.9996 (last merge round=29)
[S6] round=31 local utility u=0.144074 metrics={'f1_val': 0.6995678877828861, 'auprc': 0.7518898463230574, 'loss_val': 0.3514501892794696, 'psi': 0.7204966711989547}-{'f1_val': 0.6981846282984305, 'auprc': 0.6708857926061471, 'loss_val': 0.38828706422283854, 'psi': 0.6872650940215173}
[S7] START round=31 head_norm_before_train=1.338709 cos_to_last_merge=1.0000 (last merge round=30)
[S7] round=31 local utility u=0.000000 metrics={'f1_val': 0.6010257858570661, 'auprc': 0.7941775131902012, 'loss_val': 0.7034169127657822, 'psi': 0.6782864767903202}-{'f1_val': 0.6248710751301577, 'auprc': 0.7965897329946144, 'loss_val': 0.593659778888562, 'psi': 0.6935585382759404}
[S8] START round=31 head_norm_before_train=1.925306 (no previous merge yet)
[S8] round=31 local utility u=0.000000 metrics={'f1_val': 0.9934974612186753, 'auprc': 0.9942914691254785, 'loss_val': 0.03601825590432479, 'psi': 0.9938150643813966}-{'f1_val': 0.9926035371309061, 'auprc': 0.9990992486176368, 'loss_val': 0.03638931972444488, 'psi': 0.9952018217255985}
[S9] START round=31 head_norm_before_train=1.233038 cos_to_last_merge=0.9975 (last merge round=28)
[S9] round=31 local utility u=0.000000 metrics={'f1_val': 0.9914249079028262, 'auprc': 0.9963792819924746, 'loss_val': 0.06129185465442126, 'psi': 0.9934066575386856}-{'f1_val': 0.9966605118138915, 'auprc': 0.9909170025556785, 'loss_val': 0.06237137008452489, 'psi': 0.9943631081106062}
[S10] START round=31 head_norm_before_train=1.747281 cos_to_last_merge=0.8351 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.835
[S10] round=31 local utility u=0.001679 metrics={'f1_val': 0.9957455607450773, 'auprc': 0.9952654937629436, 'loss_val': 0.03663411746018662, 'psi': 0.9955535339522237}-{'f1_val': 0.9957455607450773, 'auprc': 0.9947341914061028, 'loss_val': 0.038398678330802856, 'psi': 0.9953410130094874}
[S11] START round=31 head_norm_before_train=1.299221 cos_to_last_merge=0.9912 (last merge round=27)
[S11] round=31 local utility u=0.008105 metrics={'f1_val': 0.9974011907167429, 'auprc': 0.9985363626426179, 'loss_val': 0.099409034112434, 'psi': 0.997855259487093}-{'f1_val': 0.9974011907167429, 'auprc': 0.9983950745526197, 'loss_val': 0.11519518004813223, 'psi': 0.9977987442510936}
[S13] START round=31 head_norm_before_train=1.660825 (no previous merge yet)
[S13] round=31 local utility u=0.000000 metrics={'f1_val': 0.5713361845366358, 'auprc': 0.6351575315023605, 'loss_val': 0.9283998961577439, 'psi': 0.5968647233229256}-{'f1_val': 0.582559646595191, 'auprc': 0.6813062291396873, 'loss_val': 0.6607760190879608, 'psi': 0.6220582796129895}
[S14] START round=31 head_norm_before_train=1.234548 cos_to_last_merge=1.0000 (last merge round=30)
[S14] round=31 local utility u=0.017009 metrics={'f1_val': 0.997011210853081, 'auprc': 0.9951547828912902, 'loss_val': 0.09454754188383492, 'psi': 0.9962686396683647}-{'f1_val': 0.9961701069502772, 'auprc': 0.9951562806981482, 'loss_val': 0.12352327617007802, 'psi': 0.9957645764494256}
[S15] START round=31 head_norm_before_train=1.218803 cos_to_last_merge=1.0000 (last merge round=30)
[S15] round=31 local utility u=1.000000 metrics={'f1_val': 0.9970299290849798, 'auprc': 0.9971104839307761, 'loss_val': 0.12203913262437208, 'psi': 0.9970621510232982}-{'f1_val': 0.7012363580370753, 'auprc': 0.904845502807607, 'loss_val': 0.4487974976671568, 'psi': 0.782680015945288}
[S16] START round=31 head_norm_before_train=1.480073 cos_to_last_merge=0.9999 (last merge round=29)
[S16] round=31 local utility u=0.000000 metrics={'f1_val': 0.8331178508332167, 'auprc': 0.9933066027339772, 'loss_val': 0.7343443638234834, 'psi': 0.8971933515935209}-{'f1_val': 0.9919455454822041, 'auprc': 0.9930088385733209, 'loss_val': 0.07832546052427956, 'psi': 0.9923708627186508}
[S17] START round=31 head_norm_before_train=1.184279 cos_to_last_merge=1.0000 (last merge round=30)
[S17] round=31 local utility u=0.470024 metrics={'f1_val': 0.6363225709710986, 'auprc': 0.998432581197606, 'loss_val': 0.47069719986640274, 'psi': 0.7811665750617016}-{'f1_val': 0.588425997219695, 'auprc': 0.8675241803539342, 'loss_val': 0.7306413437469015, 'psi': 0.7000652704733907}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S2] → sending delta(kind=head bytes=1792) to S3@127.0.0.1:62403
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] → sending delta(kind=head bytes=1805) to S6@127.0.0.1:62407
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:62416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:62414
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:62415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:62402
[S3] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1804 to 1 peers)
[S2] sending update (kind=head size=1792 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1800) from S11
[S14] cosine check vs S11: cos=0.9881
[S16] RECEIVED delta(kind=head bytes=1804) from S4
[S16] cosine check vs S4: cos=0.8412
[S3] RECEIVED delta(kind=head bytes=1792) from S2
[S3] cosine check vs S2: cos=0.9996
[S15] RECEIVED delta(kind=head bytes=1801) from S14
[S15] cosine check vs S14: cos=0.8648
[S2] RECEIVED delta(kind=head bytes=1801) from S3
[S2] cosine check vs S3: cos=0.9996
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:62405
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] sending update (kind=head size=1795 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1795) from S17
[S5] cosine check vs S17: cos=0.8465
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:62415
[S6] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1805 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1802) from S6
[S15] cosine check vs S6: cos=0.9428
[S6] RECEIVED delta(kind=head bytes=1805) from S15
[S6] cosine check vs S15: cos=0.9428
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=31 metric=0.9971 head_norm=1.173557
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.324938e-01
[S5] stored merged vector for next round verification (round=31)
[S5] DEBUG after merge:  round=31 metric=0.9967 head_norm=1.150406 delta_norm=0.332494
[S5] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=31 metric=0.8257 head_norm=2.231610
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.403467e-02
[S2] stored merged vector for next round verification (round=31)
[S2] DEBUG after merge:  round=31 metric=0.8260 head_norm=2.237107 delta_norm=0.034035
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=31 metric=0.9974 head_norm=2.243107
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.403467e-02
[S3] stored merged vector for next round verification (round=31)
[S3] DEBUG after merge:  round=31 metric=0.9974 head_norm=2.237107 delta_norm=0.034035
[S3] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=31 metric=0.9970 head_norm=1.263787
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.068513e-01
[S14] stored merged vector for next round verification (round=31)
[S14] DEBUG after merge:  round=31 metric=0.9970 head_norm=1.296473 delta_norm=0.106851
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=31 metric=0.9970 head_norm=1.250519
[S15] _apply_head_vector_avg (torch): Δ‖w‖=9.099387e-02
[S15] stored merged vector for next round verification (round=31)
[S15] DEBUG after merge:  round=31 metric=0.9970 head_norm=1.212499 delta_norm=0.090994
[S15] aggregate: ACCEPT kept=['S14', 'S6'] (k=2/2) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=31 metric=0.6996 head_norm=1.320646
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.200544e-01
[S6] stored merged vector for next round verification (round=31)
[S6] DEBUG after merge:  round=31 metric=0.6996 head_norm=1.267094 delta_norm=0.220054
[S6] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=31 metric=0.8331 head_norm=1.507369
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.509777e-01
[S16] stored merged vector for next round verification (round=31)
[S16] DEBUG after merge:  round=31 metric=0.8340 head_norm=1.516840 delta_norm=0.450978
[S16] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=32 head_norm_before_train=2.237107 cos_to_last_merge=1.0000 (last merge round=31)
[S2] round=32 local utility u=0.000000 metrics={'f1_val': 0.8089900875247158, 'auprc': 0.7811487713729706, 'loss_val': 0.4293363654671409, 'psi': 0.7978535610640177}-{'f1_val': 0.8256757088349882, 'auprc': 0.7720320613650347, 'loss_val': 0.38816668738352117, 'psi': 0.8042182498470067}
[S3] START round=32 head_norm_before_train=2.237107 cos_to_last_merge=1.0000 (last merge round=31)
[S3] round=32 local utility u=0.000000 metrics={'f1_val': 0.9876639186070146, 'auprc': 0.9984889740584695, 'loss_val': 0.030942801165434186, 'psi': 0.9919939407875966}-{'f1_val': 0.9973696976584205, 'auprc': 0.9985655839599821, 'loss_val': 0.018362982248981266, 'psi': 0.9978480521790452}
[S4] START round=32 head_norm_before_train=1.654149 cos_to_last_merge=0.9974 (last merge round=28)
[S4] round=32 local utility u=0.000000 metrics={'f1_val': 0.9389746971334901, 'auprc': 0.9250701084917257, 'loss_val': 0.3026256975704323, 'psi': 0.9334128616767843}-{'f1_val': 0.9418773291585314, 'auprc': 0.9485661112676107, 'loss_val': 0.26780607407273305, 'psi': 0.9445528420021632}
[S5] START round=32 head_norm_before_train=1.150406 cos_to_last_merge=1.0000 (last merge round=31)
[S5] round=32 local utility u=0.037113 metrics={'f1_val': 0.9959201961697324, 'auprc': 0.9963014730678537, 'loss_val': 0.1963911787264181, 'psi': 0.9960727069289809}-{'f1_val': 0.9971410286679584, 'auprc': 0.994334960899269, 'loss_val': 0.27204273061501505, 'psi': 0.9960186015604826}
[S6] START round=32 head_norm_before_train=1.267094 cos_to_last_merge=1.0000 (last merge round=31)
[S6] round=32 local utility u=0.000000 metrics={'f1_val': 0.6996505994567656, 'auprc': 0.7444398803465946, 'loss_val': 0.3649980457319758, 'psi': 0.7175663118126971}-{'f1_val': 0.6995678877828861, 'auprc': 0.7518898463230574, 'loss_val': 0.3514501892794696, 'psi': 0.7204966711989547}
[S7] START round=32 head_norm_before_train=1.375372 cos_to_last_merge=0.9992 (last merge round=30)
[S7] round=32 local utility u=0.311511 metrics={'f1_val': 0.6575459970380574, 'auprc': 0.8089455949706357, 'loss_val': 0.4638210351569453, 'psi': 0.7181058362110887}-{'f1_val': 0.6010257858570661, 'auprc': 0.7941775131902012, 'loss_val': 0.7034169127657822, 'psi': 0.6782864767903202}
[S8] START round=32 head_norm_before_train=1.936540 (no previous merge yet)
[S8] round=32 local utility u=0.000000 metrics={'f1_val': 0.9927720833909908, 'auprc': 0.9862605948490488, 'loss_val': 0.054384084407427806, 'psi': 0.990167487974214}-{'f1_val': 0.9934974612186753, 'auprc': 0.9942914691254785, 'loss_val': 0.03601825590432479, 'psi': 0.9938150643813966}
[S9] START round=32 head_norm_before_train=1.273495 cos_to_last_merge=0.9956 (last merge round=28)
[S9] round=32 local utility u=0.015047 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9922483875235177, 'loss_val': 0.047756103674940875, 'psi': 0.9946494118769736}-{'f1_val': 0.9914249079028262, 'auprc': 0.9963792819924746, 'loss_val': 0.06129185465442126, 'psi': 0.9934066575386856}
[S10] START round=32 head_norm_before_train=1.761355 cos_to_last_merge=0.8340 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.834
[S10] round=32 local utility u=0.000088 metrics={'f1_val': 0.9957455607450773, 'auprc': 0.9949305844746953, 'loss_val': 0.03545279206392157, 'psi': 0.9954195702369244}-{'f1_val': 0.9957455607450773, 'auprc': 0.9952654937629436, 'loss_val': 0.03663411746018662, 'psi': 0.9955535339522237}
[S11] START round=32 head_norm_before_train=1.336922 cos_to_last_merge=0.9877 (last merge round=27)
[S11] round=32 local utility u=0.004755 metrics={'f1_val': 0.9974011907167429, 'auprc': 0.9967985641592084, 'loss_val': 0.0846860680249091, 'psi': 0.9971601400937291}-{'f1_val': 0.9974011907167429, 'auprc': 0.9985363626426179, 'loss_val': 0.099409034112434, 'psi': 0.997855259487093}
[S13] START round=32 head_norm_before_train=1.668161 (no previous merge yet)
[S13] round=32 local utility u=0.189127 metrics={'f1_val': 0.5856798565044985, 'auprc': 0.6906451606843756, 'loss_val': 0.8026705470102373, 'psi': 0.6276659781764493}-{'f1_val': 0.5713361845366358, 'auprc': 0.6351575315023605, 'loss_val': 0.9283998961577439, 'psi': 0.5968647233229256}
[S14] START round=32 head_norm_before_train=1.296473 cos_to_last_merge=1.0000 (last merge round=31)
[S14] round=32 local utility u=0.000875 metrics={'f1_val': 0.9957640623388514, 'auprc': 0.9958527535695174, 'loss_val': 0.08740779704369958, 'psi': 0.9957995388311178}-{'f1_val': 0.997011210853081, 'auprc': 0.9951547828912902, 'loss_val': 0.09454754188383492, 'psi': 0.9962686396683647}
[S15] START round=32 head_norm_before_train=1.212499 cos_to_last_merge=1.0000 (last merge round=31)
[S15] round=32 local utility u=0.000000 metrics={'f1_val': 0.9938778762120418, 'auprc': 0.9928017017903116, 'loss_val': 0.15465198125571106, 'psi': 0.9934474064433498}-{'f1_val': 0.9970299290849798, 'auprc': 0.9971104839307761, 'loss_val': 0.12203913262437208, 'psi': 0.9970621510232982}
[S16] START round=32 head_norm_before_train=1.516840 cos_to_last_merge=1.0000 (last merge round=31)
[S16] round=32 local utility u=0.120809 metrics={'f1_val': 0.8441850488937135, 'auprc': 0.9957736032576676, 'loss_val': 0.5665306386045488, 'psi': 0.904820470639295}-{'f1_val': 0.8331178508332167, 'auprc': 0.9933066027339772, 'loss_val': 0.7343443638234834, 'psi': 0.8971933515935209}
[S17] START round=32 head_norm_before_train=1.220956 cos_to_last_merge=0.9993 (last merge round=30)
[S17] round=32 local utility u=0.000000 metrics={'f1_val': 0.627250644418069, 'auprc': 0.9547378970328576, 'loss_val': 0.5644041910706412, 'psi': 0.7582455454639845}-{'f1_val': 0.6363225709710986, 'auprc': 0.998432581197606, 'loss_val': 0.47069719986640274, 'psi': 0.7811665750617016}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:62404
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:62407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:62414
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:62405
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:62404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:62415
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1802 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1797) from S7
[S6] cosine check vs S7: cos=0.7448
[S5] RECEIVED delta(kind=head bytes=1795) from S9
[S5] cosine check vs S9: cos=0.8512
[S15] RECEIVED delta(kind=head bytes=1799) from S14
[S15] cosine check vs S14: cos=0.8513
[S4] RECEIVED delta(kind=head bytes=1797) from S5
[S4] cosine check vs S5: cos=0.5088
[S4] RECEIVED delta(kind=head bytes=1802) from S16
[S4] cosine check vs S16: cos=0.9577
[S14] RECEIVED delta(kind=head bytes=1801) from S11
[S14] cosine check vs S11: cos=0.9956
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=32 metric=0.9390 head_norm=1.672145
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.381322e-01
[S4] stored merged vector for next round verification (round=32)
[S4] DEBUG after merge:  round=32 metric=0.9390 head_norm=1.393089 delta_norm=0.438132
[S4] aggregate: ACCEPT kept=['S5', 'S16'] (k=2/2) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=32 metric=0.6997 head_norm=1.287884
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.897989e-01
[S6] stored merged vector for next round verification (round=32)
[S6] DEBUG after merge:  round=32 metric=0.6996 head_norm=1.269323 delta_norm=0.489799
[S6] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=32 metric=0.9958 head_norm=1.318055
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.876323e-02
[S14] stored merged vector for next round verification (round=32)
[S14] DEBUG after merge:  round=32 metric=0.9953 head_norm=1.344305 delta_norm=0.068763
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=32 metric=0.9959 head_norm=1.198207
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.456122e-01
[S5] stored merged vector for next round verification (round=32)
[S5] DEBUG after merge:  round=32 metric=0.9955 head_norm=1.205075 delta_norm=0.345612
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=32 metric=0.9939 head_norm=1.242608
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.509544e-01
[S15] stored merged vector for next round verification (round=32)
[S15] DEBUG after merge:  round=32 metric=0.9927 head_norm=1.231870 delta_norm=0.350954
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=33 head_norm_before_train=2.248457 cos_to_last_merge=0.9999 (last merge round=31)
[S2] round=33 local utility u=0.000000 metrics={'f1_val': 0.8026330766706822, 'auprc': 0.7646659605196546, 'loss_val': 0.5162388600497184, 'psi': 0.7874462302102712}-{'f1_val': 0.8089900875247158, 'auprc': 0.7811487713729706, 'loss_val': 0.4293363654671409, 'psi': 0.7978535610640177}
[S3] START round=33 head_norm_before_train=2.245697 cos_to_last_merge=1.0000 (last merge round=31)
[S3] round=33 local utility u=0.034735 metrics={'f1_val': 0.9973696976584205, 'auprc': 0.9986280444142717, 'loss_val': 0.020124466309223446, 'psi': 0.997873036360761}-{'f1_val': 0.9876639186070146, 'auprc': 0.9984889740584695, 'loss_val': 0.030942801165434186, 'psi': 0.9919939407875966}
[S4] START round=33 head_norm_before_train=1.393089 cos_to_last_merge=1.0000 (last merge round=32)
[S4] round=33 local utility u=0.000000 metrics={'f1_val': 0.9394864448404624, 'auprc': 0.9219339790025165, 'loss_val': 0.2998272673842092, 'psi': 0.9324654585052841}-{'f1_val': 0.9389746971334901, 'auprc': 0.9250701084917257, 'loss_val': 0.3026256975704323, 'psi': 0.9334128616767843}
[S5] START round=33 head_norm_before_train=1.205075 cos_to_last_merge=1.0000 (last merge round=32)
[S5] round=33 local utility u=0.007832 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9986901076156056, 'loss_val': 0.19258289753303126, 'psi': 0.9974972241333169}-{'f1_val': 0.9959201961697324, 'auprc': 0.9963014730678537, 'loss_val': 0.1963911787264181, 'psi': 0.9960727069289809}
[S6] START round=33 head_norm_before_train=1.269323 cos_to_last_merge=1.0000 (last merge round=32)
[S6] round=33 local utility u=0.000000 metrics={'f1_val': 0.6993360729181318, 'auprc': 0.6992009255474219, 'loss_val': 0.3698419285461567, 'psi': 0.6992820139698479}-{'f1_val': 0.6996505994567656, 'auprc': 0.7444398803465946, 'loss_val': 0.3649980457319758, 'psi': 0.7175663118126971}
[S7] START round=33 head_norm_before_train=1.429518 cos_to_last_merge=0.9974 (last merge round=30)
[S7] round=33 local utility u=0.000000 metrics={'f1_val': 0.6287896158305568, 'auprc': 0.8033341597840622, 'loss_val': 0.4736883250637114, 'psi': 0.698607433411959}-{'f1_val': 0.6575459970380574, 'auprc': 0.8089455949706357, 'loss_val': 0.4638210351569453, 'psi': 0.7181058362110887}
[S8] START round=33 head_norm_before_train=1.946870 (no previous merge yet)
[S8] round=33 local utility u=0.000000 metrics={'f1_val': 0.9830495320131151, 'auprc': 0.9990504520897028, 'loss_val': 0.055705611888504196, 'psi': 0.9894499000437501}-{'f1_val': 0.9927720833909908, 'auprc': 0.9862605948490488, 'loss_val': 0.054384084407427806, 'psi': 0.990167487974214}
[S9] START round=33 head_norm_before_train=1.306754 cos_to_last_merge=0.9937 (last merge round=28)
[S9] round=33 local utility u=0.000000 metrics={'f1_val': 0.9879970276931102, 'auprc': 0.996485666499169, 'loss_val': 0.06019342367503188, 'psi': 0.9913924832155336}-{'f1_val': 0.9962500947792776, 'auprc': 0.9922483875235177, 'loss_val': 0.047756103674940875, 'psi': 0.9946494118769736}
[S10] START round=33 head_norm_before_train=1.775962 cos_to_last_merge=0.8328 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.833
[S10] round=33 local utility u=0.001059 metrics={'f1_val': 0.9957455607450773, 'auprc': 0.995265449740156, 'loss_val': 0.0343389262744405, 'psi': 0.9955535163431086}-{'f1_val': 0.9957455607450773, 'auprc': 0.9949305844746953, 'loss_val': 0.03545279206392157, 'psi': 0.9954195702369244}
[S11] START round=33 head_norm_before_train=1.373499 cos_to_last_merge=0.9842 (last merge round=27)
[S11] round=33 local utility u=0.000000 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.995752170941605, 'loss_val': 0.07568082228753731, 'psi': 0.9960863191468632}-{'f1_val': 0.9974011907167429, 'auprc': 0.9967985641592084, 'loss_val': 0.0846860680249091, 'psi': 0.9971601400937291}
[S13] START round=33 head_norm_before_train=1.675163 (no previous merge yet)
[S13] round=33 local utility u=0.112653 metrics={'f1_val': 0.6050532983989039, 'auprc': 0.6859337424714389, 'loss_val': 0.6794705024416005, 'psi': 0.6374054760279179}-{'f1_val': 0.5856798565044985, 'auprc': 0.6906451606843756, 'loss_val': 0.8026705470102373, 'psi': 0.6276659781764493}
[S14] START round=33 head_norm_before_train=1.344305 cos_to_last_merge=1.0000 (last merge round=32)
[S14] round=33 local utility u=0.009448 metrics={'f1_val': 0.996140297480882, 'auprc': 0.9970180959317335, 'loss_val': 0.07426612033695976, 'psi': 0.9964914168612227}-{'f1_val': 0.9957640623388514, 'auprc': 0.9958527535695174, 'loss_val': 0.08740779704369958, 'psi': 0.9957995388311178}
[S15] START round=33 head_norm_before_train=1.231870 cos_to_last_merge=1.0000 (last merge round=32)
[S15] round=33 local utility u=0.000000 metrics={'f1_val': 0.8189002831667404, 'auprc': 0.8254851417751943, 'loss_val': 0.36878221273281714, 'psi': 0.821534226610122}-{'f1_val': 0.9938778762120418, 'auprc': 0.9928017017903116, 'loss_val': 0.15465198125571106, 'psi': 0.9934474064433498}
[S16] START round=33 head_norm_before_train=1.547496 cos_to_last_merge=0.9995 (last merge round=31)
[S16] round=33 local utility u=0.006800 metrics={'f1_val': 0.854138495916484, 'auprc': 0.994010068427895, 'loss_val': 0.607360617464301, 'psi': 0.9100871249210485}-{'f1_val': 0.8441850488937135, 'auprc': 0.9957736032576676, 'loss_val': 0.5665306386045488, 'psi': 0.904820470639295}
[S17] START round=33 head_norm_before_train=1.259831 cos_to_last_merge=0.9972 (last merge round=30)
[S17] round=33 local utility u=0.000000 metrics={'f1_val': 0.7336115054571759, 'auprc': 0.812164394751534, 'loss_val': 0.8120086156502292, 'psi': 0.7650326611749192}-{'f1_val': 0.627250644418069, 'auprc': 0.9547378970328576, 'loss_val': 0.5644041910706412, 'psi': 0.7582455454639845}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:62402
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:62404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:62415
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:62404
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1796) from S3
[S2] cosine check vs S3: cos=0.9997
[S15] RECEIVED delta(kind=head bytes=1799) from S14
[S15] cosine check vs S14: cos=0.9489
[S4] RECEIVED delta(kind=head bytes=1798) from S5
[S4] cosine check vs S5: cos=0.6523
[S4] RECEIVED delta(kind=head bytes=1799) from S16
[S4] cosine check vs S16: cos=0.9660
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S16
[S8]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S10
[S14]  timeout peer S13
[S14]  timeout peer S16
[S14]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S16
[S6]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S17
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S16
[S15]  timeout peer S17
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=33 metric=0.9395 head_norm=1.414961
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.388375e-01
[S4] stored merged vector for next round verification (round=33)
[S4] DEBUG after merge:  round=33 metric=0.9395 head_norm=1.311426 delta_norm=0.238837
[S4] aggregate: ACCEPT kept=['S5', 'S16'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=33 metric=0.8189 head_norm=1.266804
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.153823e-01
[S15] stored merged vector for next round verification (round=33)
[S15] DEBUG after merge:  round=33 metric=0.8070 head_norm=1.297965 delta_norm=0.215382
[S15] aggregate: ROLLBACK (f1_val pre=0.819 post=0.807 tol_abs=0.005 tol_rel=0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=33 metric=0.8026 head_norm=2.260981
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.769792e-02
[S2] stored merged vector for next round verification (round=33)
[S2] DEBUG after merge:  round=33 metric=0.8015 head_norm=2.257669 delta_norm=0.027698
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=34 head_norm_before_train=2.257669 cos_to_last_merge=1.0000 (last merge round=33)
[S2] round=34 local utility u=0.049417 metrics={'f1_val': 0.8111611649367215, 'auprc': 0.7622853930648343, 'loss_val': 0.46143164074305737, 'psi': 0.7916108561879667}-{'f1_val': 0.8026330766706822, 'auprc': 0.7646659605196546, 'loss_val': 0.5162388600497184, 'psi': 0.7874462302102712}
[S3] START round=34 head_norm_before_train=2.254693 cos_to_last_merge=1.0000 (last merge round=31)
[S3] round=34 local utility u=0.000000 metrics={'f1_val': 0.987695488604234, 'auprc': 0.9985515534747605, 'loss_val': 0.034724313174825897, 'psi': 0.9920379145524445}-{'f1_val': 0.9973696976584205, 'auprc': 0.9986280444142717, 'loss_val': 0.020124466309223446, 'psi': 0.997873036360761}
[S4] START round=34 head_norm_before_train=1.311426 cos_to_last_merge=1.0000 (last merge round=33)
[S4] round=34 local utility u=0.089691 metrics={'f1_val': 0.9457749160264025, 'auprc': 0.9624951134579748, 'loss_val': 0.27985923891186454, 'psi': 0.9524629949990314}-{'f1_val': 0.9394864448404624, 'auprc': 0.9219339790025165, 'loss_val': 0.2998272673842092, 'psi': 0.9324654585052841}
[S5] START round=34 head_norm_before_train=1.250383 cos_to_last_merge=0.9983 (last merge round=32)
[S5] round=34 local utility u=0.000000 metrics={'f1_val': 0.9871169117187695, 'auprc': 0.9959893998109712, 'loss_val': 0.18546641503931804, 'psi': 0.9906659069556503}-{'f1_val': 0.9967019684784577, 'auprc': 0.9986901076156056, 'loss_val': 0.19258289753303126, 'psi': 0.9974972241333169}
[S6] START round=34 head_norm_before_train=1.282473 cos_to_last_merge=0.9997 (last merge round=32)
[S6] round=34 local utility u=0.006924 metrics={'f1_val': 0.6993107364221842, 'auprc': 0.7037296987034748, 'loss_val': 0.3694285744778204, 'psi': 0.7010783213347005}-{'f1_val': 0.6993360729181318, 'auprc': 0.6992009255474219, 'loss_val': 0.3698419285461567, 'psi': 0.6992820139698479}
[S7] START round=34 head_norm_before_train=1.468175 cos_to_last_merge=0.9953 (last merge round=30)
[S7] round=34 local utility u=0.000000 metrics={'f1_val': 0.6191483329699212, 'auprc': 0.7960806033212684, 'loss_val': 0.5896858385925574, 'psi': 0.68992124111046}-{'f1_val': 0.6287896158305568, 'auprc': 0.8033341597840622, 'loss_val': 0.4736883250637114, 'psi': 0.698607433411959}
[S8] START round=34 head_norm_before_train=1.954555 (no previous merge yet)
[S8] round=34 local utility u=0.018686 metrics={'f1_val': 0.9931489740885844, 'auprc': 0.9885192625003647, 'loss_val': 0.04733748759206847, 'psi': 0.9912970894532965}-{'f1_val': 0.9830495320131151, 'auprc': 0.9990504520897028, 'loss_val': 0.055705611888504196, 'psi': 0.9894499000437501}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=34 head_norm_before_train=1.332231 cos_to_last_merge=0.9921 (last merge round=28)
[S9] round=34 local utility u=0.026767 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9912872511424828, 'loss_val': 0.04058290737873704, 'psi': 0.9942649573245597}-{'f1_val': 0.9879970276931102, 'auprc': 0.996485666499169, 'loss_val': 0.06019342367503188, 'psi': 0.9913924832155336}
[S10] START round=34 head_norm_before_train=1.790381 cos_to_last_merge=0.8316 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.832
[S10] round=34 local utility u=0.000000 metrics={'f1_val': 0.9957455607450773, 'auprc': 0.9947366452057004, 'loss_val': 0.03370921138909129, 'psi': 0.9953419945293265}-{'f1_val': 0.9957455607450773, 'auprc': 0.995265449740156, 'loss_val': 0.0343389262744405, 'psi': 0.9955535163431086}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=34 head_norm_before_train=1.407292 cos_to_last_merge=0.9809 (last merge round=27)
[S11] round=34 local utility u=0.008739 metrics={'f1_val': 0.9966782942738902, 'auprc': 0.9988926889449881, 'loss_val': 0.06984059955411494, 'psi': 0.9975640521423293}-{'f1_val': 0.9963090846170353, 'auprc': 0.995752170941605, 'loss_val': 0.07568082228753731, 'psi': 0.9960863191468632}
[S13] START round=34 head_norm_before_train=1.683362 (no previous merge yet)
[S13] round=34 local utility u=0.000000 metrics={'f1_val': 0.5242808013394941, 'auprc': 0.69301773502807, 'loss_val': 0.8713135941058017, 'psi': 0.5917755748149245}-{'f1_val': 0.6050532983989039, 'auprc': 0.6859337424714389, 'loss_val': 0.6794705024416005, 'psi': 0.6374054760279179}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=34 head_norm_before_train=1.362869 cos_to_last_merge=0.9999 (last merge round=32)
[S14] round=34 local utility u=0.003867 metrics={'f1_val': 0.9966004498019938, 'auprc': 0.9967745035482187, 'loss_val': 0.06856316677642271, 'psi': 0.9966700713004837}-{'f1_val': 0.996140297480882, 'auprc': 0.9970180959317335, 'loss_val': 0.07426612033695976, 'psi': 0.9964914168612227}
[S15] START round=34 head_norm_before_train=1.297965 cos_to_last_merge=1.0000 (last merge round=33)
[S15] round=34 local utility u=0.907576 metrics={'f1_val': 0.9968965306828483, 'auprc': 0.9984427289038774, 'loss_val': 0.14048086479712937, 'psi': 0.99751500997126}-{'f1_val': 0.8189002831667404, 'auprc': 0.8254851417751943, 'loss_val': 0.36878221273281714, 'psi': 0.821534226610122}
[S16] START round=34 head_norm_before_train=1.588688 cos_to_last_merge=0.9978 (last merge round=31)
[S16] round=34 local utility u=0.678561 metrics={'f1_val': 0.9918818399552181, 'auprc': 0.9936125383768124, 'loss_val': 0.07550636799641028, 'psi': 0.9925741193238558}-{'f1_val': 0.854138495916484, 'auprc': 0.994010068427895, 'loss_val': 0.607360617464301, 'psi': 0.9100871249210485}
[S17] START round=34 head_norm_before_train=1.299109 cos_to_last_merge=0.9937 (last merge round=30)
[S17] round=34 local utility u=0.000000 metrics={'f1_val': 0.6631910987860277, 'auprc': 0.8384834328670032, 'loss_val': 0.8356809664080648, 'psi': 0.7333080324184178}-{'f1_val': 0.7336115054571759, 'auprc': 0.812164394751534, 'loss_val': 0.8120086156502292, 'psi': 0.7650326611749192}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.993)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S11] → sending delta(kind=head bytes=1806) to S14@127.0.0.1:62414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:62403
[S11] sending update (kind=head size=1806 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:62416
[S2] sending update (kind=head size=1796 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1796) from S2
[S3] cosine check vs S2: cos=0.9998
[S14] RECEIVED delta(kind=head bytes=1806) from S11
[S14] cosine check vs S11: cos=0.9962
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:62405
[S14] not sending this round → trigger blocked (psi=0.997)
[S16] RECEIVED delta(kind=head bytes=1798) from S4
[S16] cosine check vs S4: cos=0.9490
[S9] sending update (kind=head size=1802 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1802) from S9
[S5] cosine check vs S9: cos=0.9460
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=34 metric=0.9871 head_norm=1.288625
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.201003e-01
[S5] stored merged vector for next round verification (round=34)
[S5] DEBUG after merge:  round=34 metric=0.9833 head_norm=1.305503 delta_norm=0.220100
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:62407
[S15] sending update (kind=head size=1797 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1797) from S15
[S6] cosine check vs S15: cos=0.7510
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=34 metric=0.9966 head_norm=1.381201
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.721432e-02
[S14] stored merged vector for next round verification (round=34)
[S14] DEBUG after merge:  round=34 metric=0.9966 head_norm=1.407330 delta_norm=0.067214
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S6] RoundReady barrier timeout: have=2 need=3 — continuing
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:62415
[S6] sending update (kind=head size=1801 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1801) from S6
[S15] cosine check vs S6: cos=0.7510
[S9]  timeout peer S5
[S9]  timeout peer S11
[S9]  timeout peer S13
[S11]  timeout peer S14
[S4]  timeout peer S10
[S4]  timeout peer S16
[S14]  timeout peer S9
[S14]  timeout peer S15
[S2]  timeout peer S3
[S6]  timeout peer S2
[S6]  timeout peer S7
[S6]  timeout peer S8
[S5]  timeout peer S4
[S15]  timeout peer S6
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=34 metric=0.6993 head_norm=1.295953
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.644145e-01
[S6] stored merged vector for next round verification (round=34)
[S6] DEBUG after merge:  round=34 metric=0.6993 head_norm=1.230605 delta_norm=0.464415
[S6] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=35 head_norm_before_train=2.268111 cos_to_last_merge=1.0000 (last merge round=33)
[S2] round=35 local utility u=0.000000 metrics={'f1_val': 0.7975813616642462, 'auprc': 0.748902523225384, 'loss_val': 0.5645701387379924, 'psi': 0.7781098262887013}-{'f1_val': 0.8111611649367215, 'auprc': 0.7622853930648343, 'loss_val': 0.46143164074305737, 'psi': 0.7916108561879667}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=35 head_norm_before_train=2.265583 cos_to_last_merge=0.9999 (last merge round=31)
[S3] round=35 local utility u=0.000000 metrics={'f1_val': 0.9781772032841529, 'auprc': 0.9984832506475732, 'loss_val': 0.06150739333491522, 'psi': 0.9862996222295211}-{'f1_val': 0.987695488604234, 'auprc': 0.9985515534747605, 'loss_val': 0.034724313174825897, 'psi': 0.9920379145524445}
[S4] START round=35 head_norm_before_train=1.339966 cos_to_last_merge=0.9997 (last merge round=33)
[S4] round=35 local utility u=0.000000 metrics={'f1_val': 0.9374750872860678, 'auprc': 0.923285889218521, 'loss_val': 0.3094469434070379, 'psi': 0.931799408059049}-{'f1_val': 0.9457749160264025, 'auprc': 0.9624951134579748, 'loss_val': 0.27985923891186454, 'psi': 0.9524629949990314}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=35 head_norm_before_train=1.305503 cos_to_last_merge=1.0000 (last merge round=34)
[S5] round=35 local utility u=0.000000 metrics={'f1_val': 0.9511642431969545, 'auprc': 0.9940244137880743, 'loss_val': 0.21111142911636102, 'psi': 0.9683083114334025}-{'f1_val': 0.9871169117187695, 'auprc': 0.9959893998109712, 'loss_val': 0.18546641503931804, 'psi': 0.9906659069556503}
[S6] START round=35 head_norm_before_train=1.230605 cos_to_last_merge=1.0000 (last merge round=34)
[S6] round=35 local utility u=0.084777 metrics={'f1_val': 0.6995254027307093, 'auprc': 0.7579044181033716, 'loss_val': 0.3636859873751056, 'psi': 0.7228770088797742}-{'f1_val': 0.6993107364221842, 'auprc': 0.7037296987034748, 'loss_val': 0.3694285744778204, 'psi': 0.7010783213347005}
[S7] START round=35 head_norm_before_train=1.503894 cos_to_last_merge=0.9931 (last merge round=30)
[S7] round=35 local utility u=0.065688 metrics={'f1_val': 0.6255088742285234, 'auprc': 0.8026956748457242, 'loss_val': 0.5163177363738546, 'psi': 0.6963835944754038}-{'f1_val': 0.6191483329699212, 'auprc': 0.7960806033212684, 'loss_val': 0.5896858385925574, 'psi': 0.68992124111046}
[S8] START round=35 head_norm_before_train=1.963756 (no previous merge yet)
[S8] round=35 local utility u=0.017795 metrics={'f1_val': 0.9918763177247631, 'auprc': 0.9991027998861899, 'loss_val': 0.03586261299673662, 'psi': 0.9947669105893338}-{'f1_val': 0.9931489740885844, 'auprc': 0.9885192625003647, 'loss_val': 0.04733748759206847, 'psi': 0.9912970894532965}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] sending update (kind=head size=1794 to 1 peers)
[S9] START round=35 head_norm_before_train=1.358312 cos_to_last_merge=0.9904 (last merge round=28)
[S9] round=35 local utility u=0.001237 metrics={'f1_val': 0.9939163253356635, 'auprc': 0.9969781695585482, 'loss_val': 0.04117975492903039, 'psi': 0.9951410630248174}-{'f1_val': 0.9962500947792776, 'auprc': 0.9912872511424828, 'loss_val': 0.04058290737873704, 'psi': 0.9942649573245597}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=35 head_norm_before_train=1.801541 cos_to_last_merge=0.8307 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.831
[S10] round=35 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9947752082197362, 'loss_val': 0.03307752958634369, 'psi': 0.9951039556261327}-{'f1_val': 0.9957455607450773, 'auprc': 0.9947366452057004, 'loss_val': 0.03370921138909129, 'psi': 0.9953419945293265}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=35 head_norm_before_train=1.436132 cos_to_last_merge=0.9781 (last merge round=27)
[S11] round=35 local utility u=0.002201 metrics={'f1_val': 0.9971565747497426, 'auprc': 0.998541767892299, 'loss_val': 0.06725629099127663, 'psi': 0.9977106520067651}-{'f1_val': 0.9966782942738902, 'auprc': 0.9988926889449881, 'loss_val': 0.06984059955411494, 'psi': 0.9975640521423293}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=35 head_norm_before_train=1.692138 (no previous merge yet)
[S13] round=35 local utility u=0.205675 metrics={'f1_val': 0.5945974720510898, 'auprc': 0.6521598455430859, 'loss_val': 0.759289173516709, 'psi': 0.6176224214478883}-{'f1_val': 0.5242808013394941, 'auprc': 0.69301773502807, 'loss_val': 0.8713135941058017, 'psi': 0.5917755748149245}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=35 head_norm_before_train=1.407330 cos_to_last_merge=1.0000 (last merge round=34)
[S14] round=35 local utility u=0.002631 metrics={'f1_val': 0.9961901736218755, 'auprc': 0.9974581631414167, 'loss_val': 0.06289089217989907, 'psi': 0.9966973694296919}-{'f1_val': 0.9966004498019938, 'auprc': 0.9967745035482187, 'loss_val': 0.06856316677642271, 'psi': 0.9966700713004837}
[S15] START round=35 head_norm_before_train=1.334407 cos_to_last_merge=0.9991 (last merge round=33)
[S15] round=35 local utility u=0.000000 metrics={'f1_val': 0.9013470868748241, 'auprc': 0.9921204287012373, 'loss_val': 0.2079600662782226, 'psi': 0.9376564236053895}-{'f1_val': 0.9968965306828483, 'auprc': 0.9984427289038774, 'loss_val': 0.14048086479712937, 'psi': 0.99751500997126}
[S16] START round=35 head_norm_before_train=1.631276 cos_to_last_merge=0.9954 (last merge round=31)
[S16] round=35 local utility u=0.000000 metrics={'f1_val': 0.9893090287164036, 'auprc': 0.993862969529849, 'loss_val': 0.06954950455305685, 'psi': 0.9911306050417817}-{'f1_val': 0.9918818399552181, 'auprc': 0.9936125383768124, 'loss_val': 0.07550636799641028, 'psi': 0.9925741193238558}
[S17] START round=35 head_norm_before_train=1.328567 cos_to_last_merge=0.9905 (last merge round=30)
[S17] round=35 local utility u=0.148492 metrics={'f1_val': 0.6374028640806678, 'auprc': 0.911704691697872, 'loss_val': 0.603631183347295, 'psi': 0.7471235951275496}-{'f1_val': 0.6631910987860277, 'auprc': 0.8384834328670032, 'loss_val': 0.8356809664080648, 'psi': 0.7333080324184178}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=35 metric=0.9893 head_norm=1.668520
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.947195e-01
[S16] stored merged vector for next round verification (round=35)
[S16] DEBUG after merge:  round=35 metric=0.9904 head_norm=1.484208 delta_norm=0.294720
[S16] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=35 metric=0.9013 head_norm=1.368986
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.652815e-01
[S15] stored merged vector for next round verification (round=35)
[S15] DEBUG after merge:  round=35 metric=0.9119 head_norm=1.249128 delta_norm=0.465282
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=35 metric=0.9782 head_norm=2.276202
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.705648e-02
[S3] stored merged vector for next round verification (round=35)
[S3] DEBUG after merge:  round=35 metric=0.9782 head_norm=2.271999 delta_norm=0.027056
[S3] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=36 head_norm_before_train=2.276802 cos_to_last_merge=0.9999 (last merge round=33)
[S2] round=36 local utility u=0.000000 metrics={'f1_val': 0.7086510465831779, 'auprc': 0.8656767388258009, 'loss_val': 0.5067616287396386, 'psi': 0.7714613234802271}-{'f1_val': 0.7975813616642462, 'auprc': 0.748902523225384, 'loss_val': 0.5645701387379924, 'psi': 0.7781098262887013}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=36 head_norm_before_train=2.271999 cos_to_last_merge=1.0000 (last merge round=35)
[S3] round=36 local utility u=0.000000 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.9984836998719625, 'loss_val': 0.11566469076528177, 'psi': 0.9760146306120512}-{'f1_val': 0.9781772032841529, 'auprc': 0.9984832506475732, 'loss_val': 0.06150739333491522, 'psi': 0.9862996222295211}
[S4] START round=36 head_norm_before_train=1.373824 cos_to_last_merge=0.9988 (last merge round=33)
[S4] round=36 local utility u=0.001116 metrics={'f1_val': 0.9374939739447695, 'auprc': 0.9217804575441124, 'loss_val': 0.30281256395088363, 'psi': 0.9312085673845066}-{'f1_val': 0.9374750872860678, 'auprc': 0.923285889218521, 'loss_val': 0.3094469434070379, 'psi': 0.931799408059049}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=36 head_norm_before_train=1.338172 cos_to_last_merge=0.9993 (last merge round=34)
[S5] round=36 local utility u=0.172463 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9972948991182009, 'loss_val': 0.1492234448388596, 'psi': 0.996939140734355}-{'f1_val': 0.9511642431969545, 'auprc': 0.9940244137880743, 'loss_val': 0.21111142911636102, 'psi': 0.9683083114334025}
[S6] START round=36 head_norm_before_train=1.246040 cos_to_last_merge=0.9997 (last merge round=34)
[S6] round=36 local utility u=0.019790 metrics={'f1_val': 0.6989817909022711, 'auprc': 0.765432421674287, 'loss_val': 0.34342846172213876, 'psi': 0.7255620432110774}-{'f1_val': 0.6995254027307093, 'auprc': 0.7579044181033716, 'loss_val': 0.3636859873751056, 'psi': 0.7228770088797742}
[S7] START round=36 head_norm_before_train=1.527140 cos_to_last_merge=0.9916 (last merge round=30)
[S7] round=36 local utility u=0.000000 metrics={'f1_val': 0.55953638430736, 'auprc': 0.7858097961750875, 'loss_val': 0.9247943301122493, 'psi': 0.650045749054451}-{'f1_val': 0.6255088742285234, 'auprc': 0.8026956748457242, 'loss_val': 0.5163177363738546, 'psi': 0.6963835944754038}
[S8] START round=36 head_norm_before_train=1.973649 (no previous merge yet)
[S8] round=36 local utility u=0.001341 metrics={'f1_val': 0.9922396549535559, 'auprc': 0.9990612444556782, 'loss_val': 0.03523586422311096, 'psi': 0.9949682907544048}-{'f1_val': 0.9918763177247631, 'auprc': 0.9991027998861899, 'loss_val': 0.03586261299673662, 'psi': 0.9947669105893338}
[S8] not sending this round → trigger blocked (psi=0.995)
[S9] START round=36 head_norm_before_train=1.383765 cos_to_last_merge=0.9888 (last merge round=28)
[S9] round=36 local utility u=0.012382 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9974243459492624, 'loss_val': 0.03421895959383705, 'psi': 0.9969660454680398}-{'f1_val': 0.9939163253356635, 'auprc': 0.9969781695585482, 'loss_val': 0.04117975492903039, 'psi': 0.9951410630248174}
[S9] not sending this round → trigger blocked (psi=0.997)
[S10] START round=36 head_norm_before_train=1.811939 cos_to_last_merge=0.8299 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.830
[S10] round=36 local utility u=0.000287 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.994740130223629, 'loss_val': 0.032397315295207584, 'psi': 0.9950899244276898}-{'f1_val': 0.9953231205637304, 'auprc': 0.9947752082197362, 'loss_val': 0.03307752958634369, 'psi': 0.9951039556261327}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=36 head_norm_before_train=1.463364 cos_to_last_merge=0.9752 (last merge round=27)
[S11] round=36 local utility u=0.000000 metrics={'f1_val': 0.9589186571181944, 'auprc': 0.9989117829416919, 'loss_val': 0.08121512936808009, 'psi': 0.9749159074475935}-{'f1_val': 0.9971565747497426, 'auprc': 0.998541767892299, 'loss_val': 0.06725629099127663, 'psi': 0.9977106520067651}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=36 head_norm_before_train=1.699268 (no previous merge yet)
[S13] round=36 local utility u=0.000000 metrics={'f1_val': 0.5935039275691107, 'auprc': 0.5709330218007379, 'loss_val': 0.9650936299141315, 'psi': 0.5844755652617616}-{'f1_val': 0.5945974720510898, 'auprc': 0.6521598455430859, 'loss_val': 0.759289173516709, 'psi': 0.6176224214478883}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=36 head_norm_before_train=1.426008 cos_to_last_merge=0.9999 (last merge round=34)
[S14] round=36 local utility u=0.003360 metrics={'f1_val': 0.9957803799976211, 'auprc': 0.9989580092153911, 'loss_val': 0.05821145870347335, 'psi': 0.9970514316847292}-{'f1_val': 0.9961901736218755, 'auprc': 0.9974581631414167, 'loss_val': 0.06289089217989907, 'psi': 0.9966973694296919}
[S15] START round=36 head_norm_before_train=1.249128 cos_to_last_merge=1.0000 (last merge round=35)
[S15] round=36 local utility u=0.000000 metrics={'f1_val': 0.8981477228767293, 'auprc': 0.9383301416635199, 'loss_val': 0.27838267893298113, 'psi': 0.9142206903914456}-{'f1_val': 0.9013470868748241, 'auprc': 0.9921204287012373, 'loss_val': 0.2079600662782226, 'psi': 0.9376564236053895}
[S16] START round=36 head_norm_before_train=1.484208 cos_to_last_merge=1.0000 (last merge round=35)
[S16] round=36 local utility u=0.000000 metrics={'f1_val': 0.9187129445842563, 'auprc': 0.9947371265228054, 'loss_val': 0.35545393236034284, 'psi': 0.949122617359676}-{'f1_val': 0.9893090287164036, 'auprc': 0.993862969529849, 'loss_val': 0.06954950455305685, 'psi': 0.9911306050417817}
[S17] START round=36 head_norm_before_train=1.361318 cos_to_last_merge=0.9877 (last merge round=30)
[S17] round=36 local utility u=0.287929 metrics={'f1_val': 0.6868126268153961, 'auprc': 0.9847088509769447, 'loss_val': 0.5432439583563842, 'psi': 0.8059711164800156}-{'f1_val': 0.6374028640806678, 'auprc': 0.911704691697872, 'loss_val': 0.603631183347295, 'psi': 0.7471235951275496}
[S14] not sending this round → trigger blocked (psi=0.997)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.726)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → trigger blocked (psi=0.806)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S2] START round=37 head_norm_before_train=2.283791 cos_to_last_merge=0.9998 (last merge round=33)
[S2] round=37 local utility u=0.112610 metrics={'f1_val': 0.7989708131587653, 'auprc': 0.754125112901984, 'loss_val': 0.4888052855548862, 'psi': 0.7810325330560528}-{'f1_val': 0.7086510465831779, 'auprc': 0.8656767388258009, 'loss_val': 0.5067616287396386, 'psi': 0.7714613234802271}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[S3] START round=37 head_norm_before_train=2.284316 cos_to_last_merge=1.0000 (last merge round=35)
[S3] round=37 local utility u=0.118331 metrics={'f1_val': 0.9873007809781595, 'auprc': 0.9985554165527322, 'loss_val': 0.03681054546962392, 'psi': 0.9918026352079886}-{'f1_val': 0.9610352511054436, 'auprc': 0.9984836998719625, 'loss_val': 0.11566469076528177, 'psi': 0.9760146306120512}
[S4] START round=37 head_norm_before_train=1.404796 cos_to_last_merge=0.9975 (last merge round=33)
[S4] round=37 local utility u=0.116948 metrics={'f1_val': 0.9504160471739709, 'auprc': 0.9606449893174687, 'loss_val': 0.2630416566520278, 'psi': 0.95450762403137}-{'f1_val': 0.9374939739447695, 'auprc': 0.9217804575441124, 'loss_val': 0.30281256395088363, 'psi': 0.9312085673845066}
[S4] not sending this round → trigger blocked (psi=0.955)
[S5] START round=37 head_norm_before_train=1.368674 cos_to_last_merge=0.9975 (last merge round=34)
[S5] round=37 local utility u=0.002640 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9945258160303541, 'loss_val': 0.1356353646936014, 'psi': 0.9958315074992162}-{'f1_val': 0.9967019684784577, 'auprc': 0.9972948991182009, 'loss_val': 0.1492234448388596, 'psi': 0.996939140734355}
[S6] START round=37 head_norm_before_train=1.264060 cos_to_last_merge=0.9989 (last merge round=34)
[S6] round=37 local utility u=0.000000 metrics={'f1_val': 0.6992671403996168, 'auprc': 0.75715993302664, 'loss_val': 0.35396583447714547, 'psi': 0.722424257450426}-{'f1_val': 0.6989817909022711, 'auprc': 0.765432421674287, 'loss_val': 0.34342846172213876, 'psi': 0.7255620432110774}
[S7] START round=37 head_norm_before_train=1.555318 cos_to_last_merge=0.9897 (last merge round=30)
[S7] round=37 local utility u=0.214007 metrics={'f1_val': 0.5931726108677841, 'auprc': 0.7929359179333207, 'loss_val': 0.7199757438883667, 'psi': 0.6730779336939987}-{'f1_val': 0.55953638430736, 'auprc': 0.7858097961750875, 'loss_val': 0.9247943301122493, 'psi': 0.650045749054451}
[S8] START round=37 head_norm_before_train=1.983027 (no previous merge yet)
[S8] round=37 local utility u=0.006575 metrics={'f1_val': 0.9942884390087473, 'auprc': 0.9980077925416571, 'loss_val': 0.03121755374005366, 'psi': 0.9957761804219112}-{'f1_val': 0.9922396549535559, 'auprc': 0.9990612444556782, 'loss_val': 0.03523586422311096, 'psi': 0.9949682907544048}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] sending update (kind=head size=1793 to 1 peers)
[S9] START round=37 head_norm_before_train=1.407668 cos_to_last_merge=0.9872 (last merge round=28)
[S9] round=37 local utility u=0.000000 metrics={'f1_val': 0.9892839776110306, 'auprc': 0.9937849094439033, 'loss_val': 0.04883955923074201, 'psi': 0.9910843503441796}-{'f1_val': 0.9966605118138915, 'auprc': 0.9974243459492624, 'loss_val': 0.03421895959383705, 'psi': 0.9969660454680398}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=37 head_norm_before_train=1.823186 cos_to_last_merge=0.8289 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.829
[S10] round=37 local utility u=0.000384 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9947669849251544, 'loss_val': 0.031710658459957825, 'psi': 0.9951006663083}-{'f1_val': 0.9953231205637304, 'auprc': 0.994740130223629, 'loss_val': 0.032397315295207584, 'psi': 0.9950899244276898}
[S10] not sending this round → trigger blocked (psi=0.995)
[S11] START round=37 head_norm_before_train=1.487110 cos_to_last_merge=0.9727 (last merge round=27)
[S11] round=37 local utility u=0.125583 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.995729549347932, 'loss_val': 0.04877568566554614, 'psi': 0.9964703737149191}-{'f1_val': 0.9589186571181944, 'auprc': 0.9989117829416919, 'loss_val': 0.08121512936808009, 'psi': 0.9749159074475935}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=37 head_norm_before_train=1.706587 (no previous merge yet)
[S13] round=37 local utility u=0.233292 metrics={'f1_val': 0.5748154290274657, 'auprc': 0.713611844075864, 'loss_val': 0.8144153779530301, 'psi': 0.630333995046825}-{'f1_val': 0.5935039275691107, 'auprc': 0.5709330218007379, 'loss_val': 0.9650936299141315, 'psi': 0.5844755652617616}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=37 head_norm_before_train=1.444830 cos_to_last_merge=0.9995 (last merge round=34)
[S14] round=37 local utility u=0.000694 metrics={'f1_val': 0.9965776657180772, 'auprc': 0.9965279487573439, 'loss_val': 0.05431607702700909, 'psi': 0.9965577789337838}-{'f1_val': 0.9957803799976211, 'auprc': 0.9989580092153911, 'loss_val': 0.05821145870347335, 'psi': 0.9970514316847292}
[S15] START round=37 head_norm_before_train=1.285938 cos_to_last_merge=0.9994 (last merge round=35)
[S15] round=37 local utility u=0.000000 metrics={'f1_val': 0.8732021713165481, 'auprc': 0.9301392228395953, 'loss_val': 0.30311977593432815, 'psi': 0.895976991925767}-{'f1_val': 0.8981477228767293, 'auprc': 0.9383301416635199, 'loss_val': 0.27838267893298113, 'psi': 0.9142206903914456}
[S16] START round=37 head_norm_before_train=1.522809 cos_to_last_merge=0.9997 (last merge round=35)
[S16] round=37 local utility u=0.171464 metrics={'f1_val': 0.9441700425794944, 'auprc': 0.9933099185221739, 'loss_val': 0.16098631160689175, 'psi': 0.9638259929565662}-{'f1_val': 0.9187129445842563, 'auprc': 0.9947371265228054, 'loss_val': 0.35545393236034284, 'psi': 0.949122617359676}
[S17] START round=37 head_norm_before_train=1.385180 cos_to_last_merge=0.9858 (last merge round=30)
[S17] round=37 local utility u=0.006288 metrics={'f1_val': 0.6850264428612747, 'auprc': 0.9984343260840685, 'loss_val': 0.5611280090916477, 'psi': 0.8103895961503922}-{'f1_val': 0.6868126268153961, 'auprc': 0.9847088509769447, 'loss_val': 0.5432439583563842, 'psi': 0.8059711164800156}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] sending update (kind=head size=1804 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S5] not sending this round → trigger blocked (psi=0.996)
[S2] START round=38 head_norm_before_train=2.289997 cos_to_last_merge=0.9997 (last merge round=33)
[S2] round=38 local utility u=0.000000 metrics={'f1_val': 0.7171217645482846, 'auprc': 0.8607508232726117, 'loss_val': 0.4373090207502962, 'psi': 0.7745733880380155}-{'f1_val': 0.7989708131587653, 'auprc': 0.754125112901984, 'loss_val': 0.4888052855548862, 'psi': 0.7810325330560528}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=38 head_norm_before_train=2.295579 cos_to_last_merge=1.0000 (last merge round=35)
[S3] round=38 local utility u=0.034926 metrics={'f1_val': 0.9969520501205896, 'auprc': 0.9984970571470609, 'loss_val': 0.02469039797511923, 'psi': 0.9975700529311782}-{'f1_val': 0.9873007809781595, 'auprc': 0.9985554165527322, 'loss_val': 0.03681054546962392, 'psi': 0.9918026352079886}
[S4] START round=38 head_norm_before_train=1.427894 cos_to_last_merge=0.9962 (last merge round=33)
[S4] round=38 local utility u=0.000000 metrics={'f1_val': 0.9399453022841902, 'auprc': 0.9268462814269023, 'loss_val': 0.2824886965974726, 'psi': 0.934705693941275}-{'f1_val': 0.9504160471739709, 'auprc': 0.9606449893174687, 'loss_val': 0.2630416566520278, 'psi': 0.95450762403137}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=38 head_norm_before_train=1.394495 cos_to_last_merge=0.9954 (last merge round=34)
[S5] round=38 local utility u=0.000000 metrics={'f1_val': 0.7171733084216634, 'auprc': 0.9884636907949758, 'loss_val': 0.3510910516664776, 'psi': 0.8256894613709883}-{'f1_val': 0.9967019684784577, 'auprc': 0.9945258160303541, 'loss_val': 0.1356353646936014, 'psi': 0.9958315074992162}
[S6] START round=38 head_norm_before_train=1.280794 cos_to_last_merge=0.9983 (last merge round=34)
[S6] round=38 local utility u=0.277498 metrics={'f1_val': 0.6992443804119748, 'auprc': 0.9243907837085058, 'loss_val': 0.30052552036134833, 'psi': 0.7893029417305872}-{'f1_val': 0.6992671403996168, 'auprc': 0.75715993302664, 'loss_val': 0.35396583447714547, 'psi': 0.722424257450426}
[S7] START round=38 head_norm_before_train=1.572977 cos_to_last_merge=0.9884 (last merge round=30)
[S7] round=38 local utility u=1.000000 metrics={'f1_val': 0.9428489180055473, 'auprc': 0.9836339968388724, 'loss_val': 0.16192977398454467, 'psi': 0.9591629495388773}-{'f1_val': 0.5931726108677841, 'auprc': 0.7929359179333207, 'loss_val': 0.7199757438883667, 'psi': 0.6730779336939987}
[S8] START round=38 head_norm_before_train=1.993665 (no previous merge yet)
[S8] round=38 local utility u=0.000000 metrics={'f1_val': 0.972758216132941, 'auprc': 0.9990693438078925, 'loss_val': 0.0699991537406087, 'psi': 0.9832826672029216}-{'f1_val': 0.9942884390087473, 'auprc': 0.9980077925416571, 'loss_val': 0.03121755374005366, 'psi': 0.9957761804219112}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=38 head_norm_before_train=1.426732 cos_to_last_merge=0.9858 (last merge round=28)
[S9] round=38 local utility u=0.029514 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9927021667860256, 'loss_val': 0.0308223595317476, 'psi': 0.9950771738027451}-{'f1_val': 0.9892839776110306, 'auprc': 0.9937849094439033, 'loss_val': 0.04883955923074201, 'psi': 0.9910843503441796}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=38 head_norm_before_train=1.834345 cos_to_last_merge=0.8280 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.828
[S10] round=38 local utility u=0.000330 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9948093732236977, 'loss_val': 0.03117869132531971, 'psi': 0.9951176216277173}-{'f1_val': 0.9953231205637304, 'auprc': 0.9947669849251544, 'loss_val': 0.031710658459957825, 'psi': 0.9951006663083}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=38 head_norm_before_train=1.506075 cos_to_last_merge=0.9707 (last merge round=27)
[S11] round=38 local utility u=0.000832 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9952800315311281, 'loss_val': 0.04576288226983796, 'psi': 0.9962905665881976}-{'f1_val': 0.9969642566262439, 'auprc': 0.995729549347932, 'loss_val': 0.04877568566554614, 'psi': 0.9964703737149191}
[S11] not sending this round → trigger blocked (psi=0.996)
[S13] START round=38 head_norm_before_train=1.709201 (no previous merge yet)
[S13] round=38 local utility u=0.000000 metrics={'f1_val': 0.5646483698123131, 'auprc': 0.6974917082368153, 'loss_val': 0.7438628474977761, 'psi': 0.617785705182114}-{'f1_val': 0.5748154290274657, 'auprc': 0.713611844075864, 'loss_val': 0.8144153779530301, 'psi': 0.630333995046825}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=38 head_norm_before_train=1.461213 cos_to_last_merge=0.9991 (last merge round=34)
[S14] round=38 local utility u=0.002432 metrics={'f1_val': 0.9965574496053289, 'auprc': 0.9970036415286045, 'loss_val': 0.05075845587967586, 'psi': 0.9967359263746391}-{'f1_val': 0.9965776657180772, 'auprc': 0.9965279487573439, 'loss_val': 0.05431607702700909, 'psi': 0.9965577789337838}
[S15] START round=38 head_norm_before_train=1.322335 cos_to_last_merge=0.9979 (last merge round=35)
[S15] round=38 local utility u=0.577858 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.996301036905488, 'loss_val': 0.08715670813944633, 'psi': 0.9965684157947076}-{'f1_val': 0.8732021713165481, 'auprc': 0.9301392228395953, 'loss_val': 0.30311977593432815, 'psi': 0.895976991925767}
[S16] START round=38 head_norm_before_train=1.564206 cos_to_last_merge=0.9987 (last merge round=35)
[S16] round=38 local utility u=0.000000 metrics={'f1_val': 0.8730154932329546, 'auprc': 0.9951903876876932, 'loss_val': 0.5122278208214304, 'psi': 0.9218854510148501}-{'f1_val': 0.9441700425794944, 'auprc': 0.9933099185221739, 'loss_val': 0.16098631160689175, 'psi': 0.9638259929565662}
[S17] START round=38 head_norm_before_train=1.404659 cos_to_last_merge=0.9842 (last merge round=30)
[S17] round=38 local utility u=0.000000 metrics={'f1_val': 0.6790866907191064, 'auprc': 0.8913346199719456, 'loss_val': 0.6309208545272507, 'psi': 0.7639858624202421}-{'f1_val': 0.6850264428612747, 'auprc': 0.9984343260840685, 'loss_val': 0.5611280090916477, 'psi': 0.8103895961503922}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.997)
[S3] not sending this round → trigger blocked (psi=0.998)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] not sending this round → trigger blocked (psi=0.959)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=39 head_norm_before_train=2.296017 cos_to_last_merge=0.9995 (last merge round=33)
[S2] round=39 local utility u=0.000000 metrics={'f1_val': 0.7088042314774843, 'auprc': 0.862067459168838, 'loss_val': 0.4796880200494964, 'psi': 0.7701095225540258}-{'f1_val': 0.7171217645482846, 'auprc': 0.8607508232726117, 'loss_val': 0.4373090207502962, 'psi': 0.7745733880380155}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=40 psi=0.770 u=0.0000 p_local=0.0397 f1=0.709 auprc=0.862 bytes=39515
[S3] START round=39 head_norm_before_train=2.305412 cos_to_last_merge=0.9999 (last merge round=35)
[S3] round=39 local utility u=0.000000 metrics={'f1_val': 0.982537901173439, 'auprc': 0.9986214308803134, 'loss_val': 0.048651109959111434, 'psi': 0.9889713130561888}-{'f1_val': 0.9969520501205896, 'auprc': 0.9984970571470609, 'loss_val': 0.02469039797511923, 'psi': 0.9975700529311782}
[S4] START round=39 head_norm_before_train=1.447945 cos_to_last_merge=0.9949 (last merge round=33)
[S4] round=39 local utility u=0.041751 metrics={'f1_val': 0.9421389738850885, 'auprc': 0.9462880153961029, 'loss_val': 0.2704739180902021, 'psi': 0.9437985904894942}-{'f1_val': 0.9399453022841902, 'auprc': 0.9268462814269023, 'loss_val': 0.2824886965974726, 'psi': 0.934705693941275}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S4] r=40 psi=0.944 u=0.0418 p_local=0.0415 f1=0.942 auprc=0.946 bytes=44937
[S5] START round=39 head_norm_before_train=1.419333 cos_to_last_merge=0.9933 (last merge round=34)
[S5] round=39 local utility u=0.981596 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9990904158274307, 'loss_val': 0.0991565884365219, 'psi': 0.9978779014976109}-{'f1_val': 0.7171733084216634, 'auprc': 0.9884636907949758, 'loss_val': 0.3510910516664776, 'psi': 0.8256894613709883}
[S6] START round=39 head_norm_before_train=1.296111 cos_to_last_merge=0.9976 (last merge round=34)
[S6] round=39 local utility u=0.000000 metrics={'f1_val': 0.6992306430022336, 'auprc': 0.8902500567637428, 'loss_val': 0.3317965163370702, 'psi': 0.7756384085068373}-{'f1_val': 0.6992443804119748, 'auprc': 0.9243907837085058, 'loss_val': 0.30052552036134833, 'psi': 0.7893029417305872}
[S7] START round=39 head_norm_before_train=1.581832 cos_to_last_merge=0.9875 (last merge round=30)
[S7] round=39 local utility u=0.000000 metrics={'f1_val': 0.6623479310014683, 'auprc': 0.8092053589918458, 'loss_val': 0.40580741621404265, 'psi': 0.7210909021976193}-{'f1_val': 0.9428489180055473, 'auprc': 0.9836339968388724, 'loss_val': 0.16192977398454467, 'psi': 0.9591629495388773}
[S8] START round=39 head_norm_before_train=2.003117 (no previous merge yet)
[S8] round=39 local utility u=0.062150 metrics={'f1_val': 0.9885656966123193, 'auprc': 0.9988194801772365, 'loss_val': 0.03979430633462784, 'psi': 0.9926672100382862}-{'f1_val': 0.972758216132941, 'auprc': 0.9990693438078925, 'loss_val': 0.0699991537406087, 'psi': 0.9832826672029216}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S8] r=40 psi=0.993 u=0.0622 p_local=0.0355 f1=0.989 auprc=0.999 bytes=43152
[S9] START round=39 head_norm_before_train=1.446856 cos_to_last_merge=0.9845 (last merge round=28)
[S9] round=39 local utility u=0.000000 metrics={'f1_val': 0.9955808965143278, 'auprc': 0.9936226088447293, 'loss_val': 0.030832854148443736, 'psi': 0.9947975814464884}-{'f1_val': 0.9966605118138915, 'auprc': 0.9927021667860256, 'loss_val': 0.0308223595317476, 'psi': 0.9950771738027451}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=40 psi=0.995 u=0.0000 p_local=0.0113 f1=0.996 auprc=0.994 bytes=37772
[S10] START round=39 head_norm_before_train=1.845592 cos_to_last_merge=0.8270 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.827
[S10] round=39 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9945830467705593, 'loss_val': 0.03090102005840695, 'psi': 0.9950270910464619}-{'f1_val': 0.9953231205637304, 'auprc': 0.9948093732236977, 'loss_val': 0.03117869132531971, 'psi': 0.9951176216277173}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] r=40 psi=0.995 u=0.0000 p_local=0.0022 f1=0.995 auprc=0.995 bytes=44986
[S11] START round=39 head_norm_before_train=1.525076 cos_to_last_merge=0.9688 (last merge round=27)
[S11] round=39 local utility u=0.007490 metrics={'f1_val': 0.9974011907167429, 'auprc': 0.9983684721071155, 'loss_val': 0.0426698957492171, 'psi': 0.997788103272892}-{'f1_val': 0.9969642566262439, 'auprc': 0.9952800315311281, 'loss_val': 0.04576288226983796, 'psi': 0.9962905665881976}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S11] r=40 psi=0.998 u=0.0075 p_local=0.0271 f1=0.997 auprc=0.998 bytes=46790
[S13] START round=39 head_norm_before_train=1.712721 (no previous merge yet)
[S13] round=39 local utility u=0.000000 metrics={'f1_val': 0.6020766936950501, 'auprc': 0.6255001380395471, 'loss_val': 0.81353031086176, 'psi': 0.6114460714328489}-{'f1_val': 0.5646483698123131, 'auprc': 0.6974917082368153, 'loss_val': 0.7438628474977761, 'psi': 0.617785705182114}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=40 psi=0.611 u=0.0000 p_local=0.0703 f1=0.602 auprc=0.626 bytes=35996
[S14] START round=39 head_norm_before_train=1.476418 cos_to_last_merge=0.9985 (last merge round=34)
[S14] round=39 local utility u=0.002489 metrics={'f1_val': 0.99661045654233, 'auprc': 0.9970655252599143, 'loss_val': 0.04628507794786422, 'psi': 0.9967924840293638}-{'f1_val': 0.9965574496053289, 'auprc': 0.9970036415286045, 'loss_val': 0.05075845587967586, 'psi': 0.9967359263746391}
[S15] START round=39 head_norm_before_train=1.354856 cos_to_last_merge=0.9961 (last merge round=35)
[S15] round=39 local utility u=0.000000 metrics={'f1_val': 0.9211074708708832, 'auprc': 0.9928862507058993, 'loss_val': 0.14410984217737338, 'psi': 0.9498189828048896}-{'f1_val': 0.9967466683875206, 'auprc': 0.996301036905488, 'loss_val': 0.08715670813944633, 'psi': 0.9965684157947076}
[S16] START round=39 head_norm_before_train=1.602152 cos_to_last_merge=0.9976 (last merge round=35)
[S16] round=39 local utility u=0.000000 metrics={'f1_val': 0.8476544410950149, 'auprc': 0.9941594811107578, 'loss_val': 0.738894951647118, 'psi': 0.9062564571013121}-{'f1_val': 0.8730154932329546, 'auprc': 0.9951903876876932, 'loss_val': 0.5122278208214304, 'psi': 0.9218854510148501}
[S17] START round=39 head_norm_before_train=1.425394 cos_to_last_merge=0.9822 (last merge round=30)
[S17] round=39 local utility u=0.000000 metrics={'f1_val': 0.6472957189060403, 'auprc': 0.8826421874095526, 'loss_val': 0.7464256845809093, 'psi': 0.7414343063074452}-{'f1_val': 0.6790866907191064, 'auprc': 0.8913346199719456, 'loss_val': 0.6309208545272507, 'psi': 0.7639858624202421}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S17] r=40 psi=0.741 u=0.0000 p_local=0.0730 f1=0.647 auprc=0.883 bytes=34150
[S6] r=40 psi=0.776 u=0.0000 p_local=0.0681 f1=0.699 auprc=0.890 bytes=39551
[S14] r=40 psi=0.997 u=0.0025 p_local=0.0074 f1=0.997 auprc=0.997 bytes=43198
[S15] r=40 psi=0.950 u=0.0000 p_local=0.2120 f1=0.921 auprc=0.993 bytes=35990
[S16] r=40 psi=0.906 u=0.0000 p_local=0.1065 f1=0.848 auprc=0.994 bytes=35953
[S7] r=40 psi=0.721 u=0.0000 p_local=0.2284 f1=0.662 auprc=0.809 bytes=32394
[S3] r=40 psi=0.989 u=0.0000 p_local=0.0353 f1=0.983 auprc=0.999 bytes=26964
[S5] r=40 psi=0.998 u=0.9816 p_local=0.2572 f1=0.997 auprc=0.999 bytes=37703
[S2] START round=40 head_norm_before_train=2.302267 cos_to_last_merge=0.9994 (last merge round=33)
[S2] round=40 local utility u=0.094524 metrics={'f1_val': 0.7927033413610282, 'auprc': 0.7863837285439815, 'loss_val': 0.5669825175329398, 'psi': 0.7901754962342096}-{'f1_val': 0.7088042314774843, 'auprc': 0.862067459168838, 'loss_val': 0.4796880200494964, 'psi': 0.7701095225540258}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=40 head_norm_before_train=2.316148 cos_to_last_merge=0.9999 (last merge round=35)
[S3] round=40 local utility u=0.042661 metrics={'f1_val': 0.9971302205031132, 'auprc': 0.9983441243381961, 'loss_val': 0.050051419480666895, 'psi': 0.9976157820371463}-{'f1_val': 0.982537901173439, 'auprc': 0.9986214308803134, 'loss_val': 0.048651109959111434, 'psi': 0.9889713130561888}
[S4] START round=40 head_norm_before_train=1.465777 cos_to_last_merge=0.9936 (last merge round=33)
[S4] round=40 local utility u=0.000000 metrics={'f1_val': 0.9406010107149202, 'auprc': 0.9281206490980497, 'loss_val': 0.2782723339391406, 'psi': 0.9356088660681721}-{'f1_val': 0.9421389738850885, 'auprc': 0.9462880153961029, 'loss_val': 0.2704739180902021, 'psi': 0.9437985904894942}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=40 head_norm_before_train=1.438207 cos_to_last_merge=0.9916 (last merge round=34)
[S5] round=40 local utility u=0.001740 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9985936965628237, 'loss_val': 0.09198048734249446, 'psi': 0.9974586597122042}-{'f1_val': 0.9970695586110643, 'auprc': 0.9990904158274307, 'loss_val': 0.0991565884365219, 'psi': 0.9978779014976109}
[S6] START round=40 head_norm_before_train=1.309188 cos_to_last_merge=0.9966 (last merge round=34)
[S6] round=40 local utility u=0.052347 metrics={'f1_val': 0.7487986108239089, 'auprc': 0.8358572267653251, 'loss_val': 0.36133161351182547, 'psi': 0.7836220572004754}-{'f1_val': 0.6992306430022336, 'auprc': 0.8902500567637428, 'loss_val': 0.3317965163370702, 'psi': 0.7756384085068373}
[S7] START round=40 head_norm_before_train=1.595443 cos_to_last_merge=0.9869 (last merge round=30)
[S7] round=40 local utility u=0.002904 metrics={'f1_val': 0.6614566158752155, 'auprc': 0.8094710951105684, 'loss_val': 0.3954493012535837, 'psi': 0.7206624075693566}-{'f1_val': 0.6623479310014683, 'auprc': 0.8092053589918458, 'loss_val': 0.40580741621404265, 'psi': 0.7210909021976193}
[S8] START round=40 head_norm_before_train=2.008653 (no previous merge yet)
[S8] round=40 local utility u=0.016848 metrics={'f1_val': 0.9931648515513533, 'auprc': 0.9984560657989154, 'loss_val': 0.03260321615480209, 'psi': 0.9952813372503782}-{'f1_val': 0.9885656966123193, 'auprc': 0.9988194801772365, 'loss_val': 0.03979430633462784, 'psi': 0.9926672100382862}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] sending update (kind=head size=1793 to 1 peers)
[S9] START round=40 head_norm_before_train=1.462059 cos_to_last_merge=0.9833 (last merge round=28)
[S9] round=40 local utility u=0.000116 metrics={'f1_val': 0.9964101856672208, 'auprc': 0.9914153667503383, 'loss_val': 0.028955418647332063, 'psi': 0.9944122581004678}-{'f1_val': 0.9955808965143278, 'auprc': 0.9936226088447293, 'loss_val': 0.030832854148443736, 'psi': 0.9947975814464884}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=40 head_norm_before_train=1.856694 cos_to_last_merge=0.8261 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.826
[S10] round=40 local utility u=0.000000 metrics={'f1_val': 0.9948838907637279, 'auprc': 0.9949370710811679, 'loss_val': 0.030476602440687606, 'psi': 0.994905162890704}-{'f1_val': 0.9953231205637304, 'auprc': 0.9945830467705593, 'loss_val': 0.03090102005840695, 'psi': 0.9950270910464619}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=40 head_norm_before_train=1.543977 cos_to_last_merge=0.9667 (last merge round=27)
[S11] round=40 local utility u=0.000310 metrics={'f1_val': 0.9974011907167429, 'auprc': 0.9988900375044696, 'loss_val': 0.04361363426752404, 'psi': 0.9979967294318336}-{'f1_val': 0.9974011907167429, 'auprc': 0.9983684721071155, 'loss_val': 0.0426698957492171, 'psi': 0.997788103272892}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=40 head_norm_before_train=1.717467 (no previous merge yet)
[S13] round=40 local utility u=0.223721 metrics={'f1_val': 0.6118365457246977, 'auprc': 0.7179128266258819, 'loss_val': 0.7018847841060823, 'psi': 0.6542670580851714}-{'f1_val': 0.6020766936950501, 'auprc': 0.6255001380395471, 'loss_val': 0.81353031086176, 'psi': 0.6114460714328489}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=40 head_norm_before_train=1.491199 cos_to_last_merge=0.9980 (last merge round=34)
[S14] round=40 local utility u=0.002071 metrics={'f1_val': 0.9961471738646706, 'auprc': 0.9990882330143034, 'loss_val': 0.045431664264175664, 'psi': 0.9973235975245236}-{'f1_val': 0.99661045654233, 'auprc': 0.9970655252599143, 'loss_val': 0.04628507794786422, 'psi': 0.9967924840293638}
[S15] START round=40 head_norm_before_train=1.386943 cos_to_last_merge=0.9943 (last merge round=35)
[S15] round=40 local utility u=0.273393 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.996723380767159, 'loss_val': 0.06266952271007803, 'psi': 0.996737353339376}-{'f1_val': 0.9211074708708832, 'auprc': 0.9928862507058993, 'loss_val': 0.14410984217737338, 'psi': 0.9498189828048896}
[S16] START round=40 head_norm_before_train=1.637863 cos_to_last_merge=0.9962 (last merge round=35)
[S16] round=40 local utility u=0.070807 metrics={'f1_val': 0.8571325517758038, 'auprc': 0.9969661033460002, 'loss_val': 0.662570024391246, 'psi': 0.9130659724038824}-{'f1_val': 0.8476544410950149, 'auprc': 0.9941594811107578, 'loss_val': 0.738894951647118, 'psi': 0.9062564571013121}
[S17] START round=40 head_norm_before_train=1.445967 cos_to_last_merge=0.9801 (last merge round=30)
[S17] round=40 local utility u=0.149294 metrics={'f1_val': 0.6298303374544437, 'auprc': 0.9890448203175524, 'loss_val': 0.6622529826548713, 'psi': 0.7735161305996872}-{'f1_val': 0.6472957189060403, 'auprc': 0.8826421874095526, 'loss_val': 0.7464256845809093, 'psi': 0.7414343063074452}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S7] sending update (kind=head size=1791 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S2] START round=41 head_norm_before_train=2.309282 cos_to_last_merge=0.9992 (last merge round=33)
[S2] round=41 local utility u=0.113856 metrics={'f1_val': 0.7999601532811894, 'auprc': 0.8180683893435652, 'loss_val': 0.47786542195489323, 'psi': 0.8072034477061397}-{'f1_val': 0.7927033413610282, 'auprc': 0.7863837285439815, 'loss_val': 0.5669825175329398, 'psi': 0.7901754962342096}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S2] sending update (kind=head size=1792 to 1 peers)
[S3] START round=41 head_norm_before_train=2.324729 cos_to_last_merge=0.9998 (last merge round=35)
[S3] round=41 local utility u=0.000000 metrics={'f1_val': 0.9526760704340969, 'auprc': 0.9984607817047604, 'loss_val': 0.17836427492564857, 'psi': 0.9709899549423622}-{'f1_val': 0.9971302205031132, 'auprc': 0.9983441243381961, 'loss_val': 0.050051419480666895, 'psi': 0.9976157820371463}
[S4] START round=41 head_norm_before_train=1.484647 cos_to_last_merge=0.9921 (last merge round=33)
[S4] round=41 local utility u=0.074786 metrics={'f1_val': 0.9469558038359482, 'auprc': 0.9603161956584251, 'loss_val': 0.263416195055699, 'psi': 0.9522999605649389}-{'f1_val': 0.9406010107149202, 'auprc': 0.9281206490980497, 'loss_val': 0.2782723339391406, 'psi': 0.9356088660681721}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=41 head_norm_before_train=1.453737 cos_to_last_merge=0.9900 (last merge round=34)
[S5] round=41 local utility u=0.003261 metrics={'f1_val': 0.9971410286679584, 'auprc': 0.9985747348445282, 'loss_val': 0.08803506600757442, 'psi': 0.9977145111385863}-{'f1_val': 0.9967019684784577, 'auprc': 0.9985936965628237, 'loss_val': 0.09198048734249446, 'psi': 0.9974586597122042}
[S6] START round=41 head_norm_before_train=1.319455 cos_to_last_merge=0.9954 (last merge round=34)
[S6] round=41 local utility u=0.000000 metrics={'f1_val': 0.6981037015033194, 'auprc': 0.9161416843049266, 'loss_val': 0.3201868662839421, 'psi': 0.7853188946239622}-{'f1_val': 0.7487986108239089, 'auprc': 0.8358572267653251, 'loss_val': 0.36133161351182547, 'psi': 0.7836220572004754}
[S7] START round=41 head_norm_before_train=1.618099 cos_to_last_merge=0.9861 (last merge round=30)
[S7] round=41 local utility u=0.000000 metrics={'f1_val': 0.6644475627492792, 'auprc': 0.8102472585798957, 'loss_val': 0.45389719464092293, 'psi': 0.7227674410815258}-{'f1_val': 0.6614566158752155, 'auprc': 0.8094710951105684, 'loss_val': 0.3954493012535837, 'psi': 0.7206624075693566}
[S8] START round=41 head_norm_before_train=2.012755 (no previous merge yet)
[S8] round=41 local utility u=0.004785 metrics={'f1_val': 0.994057704452729, 'auprc': 0.9987181744359965, 'loss_val': 0.029177222374402838, 'psi': 0.995921892446036}-{'f1_val': 0.9931648515513533, 'auprc': 0.9984560657989154, 'loss_val': 0.03260321615480209, 'psi': 0.9952813372503782}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] START round=41 head_norm_before_train=1.476469 cos_to_last_merge=0.9822 (last merge round=28)
[S9] round=41 local utility u=0.000000 metrics={'f1_val': 0.995999768632607, 'auprc': 0.9918931225011516, 'loss_val': 0.028431678529882116, 'psi': 0.9943571101800248}-{'f1_val': 0.9964101856672208, 'auprc': 0.9914153667503383, 'loss_val': 0.028955418647332063, 'psi': 0.9944122581004678}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=41 head_norm_before_train=1.863327 cos_to_last_merge=0.8255 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.826
[S10] round=41 local utility u=0.000456 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9943026155292753, 'loss_val': 0.030297231771243615, 'psi': 0.9949149185499484}-{'f1_val': 0.9948838907637279, 'auprc': 0.9949370710811679, 'loss_val': 0.030476602440687606, 'psi': 0.994905162890704}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=41 head_norm_before_train=1.562544 cos_to_last_merge=0.9647 (last merge round=27)
[S11] round=41 local utility u=0.000000 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9969891638798, 'loss_val': 0.038626844924571836, 'psi': 0.9965811163221412}-{'f1_val': 0.9974011907167429, 'auprc': 0.9988900375044696, 'loss_val': 0.04361363426752404, 'psi': 0.9979967294318336}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=41 head_norm_before_train=1.719718 (no previous merge yet)
[S13] round=41 local utility u=0.000000 metrics={'f1_val': 0.6254646673014067, 'auprc': 0.6693577692561702, 'loss_val': 0.8159083980625268, 'psi': 0.643021908083312}-{'f1_val': 0.6118365457246977, 'auprc': 0.7179128266258819, 'loss_val': 0.7018847841060823, 'psi': 0.6542670580851714}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=41 head_norm_before_train=1.506166 cos_to_last_merge=0.9975 (last merge round=34)
[S14] round=41 local utility u=0.000000 metrics={'f1_val': 0.9961901736218755, 'auprc': 0.9969095457091655, 'loss_val': 0.044059959829067984, 'psi': 0.9964779224567915}-{'f1_val': 0.9961471738646706, 'auprc': 0.9990882330143034, 'loss_val': 0.045431664264175664, 'psi': 0.9973235975245236}
[S15] START round=41 head_norm_before_train=1.417337 cos_to_last_merge=0.9928 (last merge round=35)
[S15] round=41 local utility u=0.000000 metrics={'f1_val': 0.9331017946763998, 'auprc': 0.9944452307025329, 'loss_val': 0.1166948880901772, 'psi': 0.9576391690868531}-{'f1_val': 0.9967466683875206, 'auprc': 0.996723380767159, 'loss_val': 0.06266952271007803, 'psi': 0.996737353339376}
[S16] START round=41 head_norm_before_train=1.671147 cos_to_last_merge=0.9947 (last merge round=35)
[S16] round=41 local utility u=0.000000 metrics={'f1_val': 0.8476544410950149, 'auprc': 0.994126806073692, 'loss_val': 0.7775234882348934, 'psi': 0.9062433870864857}-{'f1_val': 0.8571325517758038, 'auprc': 0.9969661033460002, 'loss_val': 0.662570024391246, 'psi': 0.9130659724038824}
[S17] START round=41 head_norm_before_train=1.467780 cos_to_last_merge=0.9777 (last merge round=30)
[S17] round=41 local utility u=0.000000 metrics={'f1_val': 0.6101691334195247, 'auprc': 0.904914741402134, 'loss_val': 0.800273389526506, 'psi': 0.7280673766125685}-{'f1_val': 0.6298303374544437, 'auprc': 0.9890448203175524, 'loss_val': 0.6622529826548713, 'psi': 0.7735161305996872}
[S3]  timeout peer S2
[S17]  timeout peer S5
[S15]  timeout peer S14
[S7]  timeout peer S6
[S16]  timeout peer S4
[S6]  timeout peer S15
[S14]  timeout peer S11
[S5]  timeout peer S9
[S5]  timeout peer S17
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S2] START round=42 head_norm_before_train=2.316287 cos_to_last_merge=0.9991 (last merge round=33)
[S2] round=42 local utility u=0.000000 metrics={'f1_val': 0.7146257834861136, 'auprc': 0.87885644198089, 'loss_val': 0.4365853817662445, 'psi': 0.7803180468840242}-{'f1_val': 0.7999601532811894, 'auprc': 0.8180683893435652, 'loss_val': 0.47786542195489323, 'psi': 0.8072034477061397}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=42 head_norm_before_train=2.333624 cos_to_last_merge=0.9998 (last merge round=35)
[S3] round=42 local utility u=0.212402 metrics={'f1_val': 0.9978100342676263, 'auprc': 0.9984754872888029, 'loss_val': 0.024407341720591343, 'psi': 0.9980762154760969}-{'f1_val': 0.9526760704340969, 'auprc': 0.9984607817047604, 'loss_val': 0.17836427492564857, 'psi': 0.9709899549423622}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=42 head_norm_before_train=1.502069 cos_to_last_merge=0.9906 (last merge round=33)
[S4] round=42 local utility u=0.000000 metrics={'f1_val': 0.9477926172238212, 'auprc': 0.9546323199117149, 'loss_val': 0.26393328900627905, 'psi': 0.9505284982989788}-{'f1_val': 0.9469558038359482, 'auprc': 0.9603161956584251, 'loss_val': 0.263416195055699, 'psi': 0.9522999605649389}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=42 head_norm_before_train=1.482878 cos_to_last_merge=0.9869 (last merge round=34)
[S5] round=42 local utility u=0.008134 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9990272578979257, 'loss_val': 0.07269491448407409, 'psi': 0.9978526383258088}-{'f1_val': 0.9971410286679584, 'auprc': 0.9985747348445282, 'loss_val': 0.08803506600757442, 'psi': 0.9977145111385863}
[S5] not sending this round → trigger blocked (psi=0.998)
[S6] START round=42 head_norm_before_train=1.326444 cos_to_last_merge=0.9946 (last merge round=34)
[S6] round=42 local utility u=0.111907 metrics={'f1_val': 0.700237729478914, 'auprc': 0.9621493579355087, 'loss_val': 0.24719975166694516, 'psi': 0.805002380861552}-{'f1_val': 0.6981037015033194, 'auprc': 0.9161416843049266, 'loss_val': 0.3201868662839421, 'psi': 0.7853188946239622}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[S7] START round=42 head_norm_before_train=1.640674 cos_to_last_merge=0.9847 (last merge round=30)
[S7] round=42 local utility u=0.090576 metrics={'f1_val': 0.6771677927979616, 'auprc': 0.8256447836931855, 'loss_val': 0.39525920573851603, 'psi': 0.7365585891560511}-{'f1_val': 0.6644475627492792, 'auprc': 0.8102472585798957, 'loss_val': 0.45389719464092293, 'psi': 0.7227674410815258}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S7] sending update (kind=head size=1792 to 1 peers)
[S8] START round=42 head_norm_before_train=2.019069 (no previous merge yet)
[S8] round=42 local utility u=0.000000 metrics={'f1_val': 0.9926368238932805, 'auprc': 0.9990170789739464, 'loss_val': 0.032060979912823105, 'psi': 0.9951889259255469}-{'f1_val': 0.994057704452729, 'auprc': 0.9987181744359965, 'loss_val': 0.029177222374402838, 'psi': 0.995921892446036}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=42 head_norm_before_train=1.491199 cos_to_last_merge=0.9809 (last merge round=28)
[S9] round=42 local utility u=0.008473 metrics={'f1_val': 0.9958312226609984, 'auprc': 0.9977484623894864, 'loss_val': 0.028040877712887293, 'psi': 0.9965981185523936}-{'f1_val': 0.995999768632607, 'auprc': 0.9918931225011516, 'loss_val': 0.028431678529882116, 'psi': 0.9943571101800248}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] sending update (kind=head size=1794 to 1 peers)
[S10] START round=42 head_norm_before_train=1.871465 cos_to_last_merge=0.8248 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.825
[S10] round=42 local utility u=0.000000 metrics={'f1_val': 0.9948838907637279, 'auprc': 0.9949038063284958, 'loss_val': 0.029791242715378634, 'psi': 0.9948918569896351}-{'f1_val': 0.9953231205637304, 'auprc': 0.9943026155292753, 'loss_val': 0.030297231771243615, 'psi': 0.9949149185499484}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=42 head_norm_before_train=1.579944 cos_to_last_merge=0.9629 (last merge round=27)
[S11] round=42 local utility u=0.001516 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9970170068804898, 'loss_val': 0.0371299318893616, 'psi': 0.9967373557492543}-{'f1_val': 0.9963090846170353, 'auprc': 0.9969891638798, 'loss_val': 0.038626844924571836, 'psi': 0.9965811163221412}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=42 head_norm_before_train=1.721031 (no previous merge yet)
[S13] round=42 local utility u=0.090529 metrics={'f1_val': 0.6320319289776049, 'auprc': 0.6832801856470978, 'loss_val': 0.7160206138632672, 'psi': 0.652531231645402}-{'f1_val': 0.6254646673014067, 'auprc': 0.6693577692561702, 'loss_val': 0.8159083980625268, 'psi': 0.643021908083312}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=42 head_norm_before_train=1.520149 cos_to_last_merge=0.9969 (last merge round=34)
[S14] round=42 local utility u=0.004197 metrics={'f1_val': 0.9967552940827689, 'auprc': 0.997393737455696, 'loss_val': 0.040509732648021636, 'psi': 0.9970106714319398}-{'f1_val': 0.9961901736218755, 'auprc': 0.9969095457091655, 'loss_val': 0.044059959829067984, 'psi': 0.9964779224567915}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=42 head_norm_before_train=1.444700 cos_to_last_merge=0.9913 (last merge round=35)
[S15] round=42 local utility u=0.187193 metrics={'f1_val': 0.985808594582198, 'auprc': 0.9966661450628639, 'loss_val': 0.0652119936344099, 'psi': 0.9901516147744643}-{'f1_val': 0.9331017946763998, 'auprc': 0.9944452307025329, 'loss_val': 0.1166948880901772, 'psi': 0.9576391690868531}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=42 head_norm_before_train=1.699843 cos_to_last_merge=0.9934 (last merge round=35)
[S16] round=42 local utility u=0.751968 metrics={'f1_val': 0.9812739660487819, 'auprc': 0.9918320840174661, 'loss_val': 0.06842027333324868, 'psi': 0.9854972132362556}-{'f1_val': 0.8476544410950149, 'auprc': 0.994126806073692, 'loss_val': 0.7775234882348934, 'psi': 0.9062433870864857}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=42 head_norm_before_train=1.486454 cos_to_last_merge=0.9755 (last merge round=30)
[S17] round=42 local utility u=0.000000 metrics={'f1_val': 0.5895756748758396, 'auprc': 0.9452847784905567, 'loss_val': 0.9739708001834798, 'psi': 0.7318593163217264}-{'f1_val': 0.6101691334195247, 'auprc': 0.904914741402134, 'loss_val': 0.800273389526506, 'psi': 0.7280673766125685}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=43 head_norm_before_train=2.324976 cos_to_last_merge=0.9988 (last merge round=33)
[S2] round=43 local utility u=0.000000 metrics={'f1_val': 0.7263483507793593, 'auprc': 0.8539010153736956, 'loss_val': 0.48751893108717115, 'psi': 0.7773694166170939}-{'f1_val': 0.7146257834861136, 'auprc': 0.87885644198089, 'loss_val': 0.4365853817662445, 'psi': 0.7803180468840242}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=43 head_norm_before_train=2.342495 cos_to_last_merge=0.9997 (last merge round=35)
[S3] round=43 local utility u=0.000000 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.9984389978968893, 'loss_val': 0.13898220825924706, 'psi': 0.9759967498220219}-{'f1_val': 0.9978100342676263, 'auprc': 0.9984754872888029, 'loss_val': 0.024407341720591343, 'psi': 0.9980762154760969}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=43 head_norm_before_train=1.513248 cos_to_last_merge=0.9896 (last merge round=33)
[S4] round=43 local utility u=0.000000 metrics={'f1_val': 0.93863591782787, 'auprc': 0.9210784977568812, 'loss_val': 0.28845601633109147, 'psi': 0.9316129497994745}-{'f1_val': 0.9477926172238212, 'auprc': 0.9546323199117149, 'loss_val': 0.26393328900627905, 'psi': 0.9505284982989788}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=43 head_norm_before_train=1.514036 cos_to_last_merge=0.9835 (last merge round=34)
[S5] round=43 local utility u=0.006539 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9990665799946713, 'loss_val': 0.05973489535897418, 'psi': 0.9978683671645071}-{'f1_val': 0.9970695586110643, 'auprc': 0.9990272578979257, 'loss_val': 0.07269491448407409, 'psi': 0.9978526383258088}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] START round=43 head_norm_before_train=1.332704 cos_to_last_merge=0.9940 (last merge round=34)
[S6] round=43 local utility u=0.241361 metrics={'f1_val': 0.8123042562465399, 'auprc': 0.9222326680841175, 'loss_val': 0.3171273155844394, 'psi': 0.856275620981571}-{'f1_val': 0.700237729478914, 'auprc': 0.9621493579355087, 'loss_val': 0.24719975166694516, 'psi': 0.805002380861552}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=43 head_norm_before_train=1.657058 cos_to_last_merge=0.9833 (last merge round=30)
[S7] round=43 local utility u=0.000000 metrics={'f1_val': 0.5956084015557609, 'auprc': 0.7930046449182868, 'loss_val': 0.7840910758421761, 'psi': 0.6745668989007713}-{'f1_val': 0.6771677927979616, 'auprc': 0.8256447836931855, 'loss_val': 0.39525920573851603, 'psi': 0.7365585891560511}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=43 head_norm_before_train=2.023692 (no previous merge yet)
[S8] round=43 local utility u=0.000000 metrics={'f1_val': 0.9910113370052481, 'auprc': 0.9989370478786554, 'loss_val': 0.035524464444898, 'psi': 0.9941816213546111}-{'f1_val': 0.9926368238932805, 'auprc': 0.9990170789739464, 'loss_val': 0.032060979912823105, 'psi': 0.9951889259255469}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=43 head_norm_before_train=1.504104 cos_to_last_merge=0.9799 (last merge round=28)
[S9] round=43 local utility u=0.000000 metrics={'f1_val': 0.9949999422209534, 'auprc': 0.99785478320459, 'loss_val': 0.030101630438391896, 'psi': 0.9961418786144081}-{'f1_val': 0.9958312226609984, 'auprc': 0.9977484623894864, 'loss_val': 0.028040877712887293, 'psi': 0.9965981185523936}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=43 head_norm_before_train=1.880282 cos_to_last_merge=0.8241 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.824
[S10] round=43 local utility u=0.001052 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9946129697407998, 'loss_val': 0.029449177103701145, 'psi': 0.9950390602345581}-{'f1_val': 0.9948838907637279, 'auprc': 0.9949038063284958, 'loss_val': 0.029791242715378634, 'psi': 0.9948918569896351}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=43 head_norm_before_train=1.594497 cos_to_last_merge=0.9614 (last merge round=27)
[S11] round=43 local utility u=0.000944 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9969233106206745, 'loss_val': 0.03598991404637417, 'psi': 0.996802775997179}-{'f1_val': 0.9965509216617638, 'auprc': 0.9970170068804898, 'loss_val': 0.0371299318893616, 'psi': 0.9967373557492543}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=43 head_norm_before_train=1.724512 (no previous merge yet)
[S13] round=43 local utility u=0.000000 metrics={'f1_val': 0.5895824185814594, 'auprc': 0.6680085993667094, 'loss_val': 0.7595005012669935, 'psi': 0.6209528908955594}-{'f1_val': 0.6320319289776049, 'auprc': 0.6832801856470978, 'loss_val': 0.7160206138632672, 'psi': 0.652531231645402}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=43 head_norm_before_train=1.531336 cos_to_last_merge=0.9965 (last merge round=34)
[S14] round=43 local utility u=0.001171 metrics={'f1_val': 0.9963677359485, 'auprc': 0.9987078238148119, 'loss_val': 0.039784571190026125, 'psi': 0.9973037710950248}-{'f1_val': 0.9967552940827689, 'auprc': 0.997393737455696, 'loss_val': 0.040509732648021636, 'psi': 0.9970106714319398}
[S14] not sending this round → trigger blocked (psi=0.997)
[S15] START round=43 head_norm_before_train=1.470048 cos_to_last_merge=0.9899 (last merge round=35)
[S15] round=43 local utility u=0.000000 metrics={'f1_val': 0.9048767495122143, 'auprc': 0.995987636961142, 'loss_val': 0.18631520544018618, 'psi': 0.9413211044917854}-{'f1_val': 0.985808594582198, 'auprc': 0.9966661450628639, 'loss_val': 0.0652119936344099, 'psi': 0.9901516147744643}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=43 head_norm_before_train=1.722387 cos_to_last_merge=0.9924 (last merge round=35)
[S16] round=43 local utility u=0.048237 metrics={'f1_val': 0.9914299927416418, 'auprc': 0.9954447219489759, 'loss_val': 0.043721261683802796, 'psi': 0.9930358844245755}-{'f1_val': 0.9812739660487819, 'auprc': 0.9918320840174661, 'loss_val': 0.06842027333324868, 'psi': 0.9854972132362556}
[S16] not sending this round → trigger blocked (psi=0.993)
[S17] START round=43 head_norm_before_train=1.502828 cos_to_last_merge=0.9740 (last merge round=30)
[S17] round=43 local utility u=0.229572 metrics={'f1_val': 0.6437222678485852, 'auprc': 0.9025749717282722, 'loss_val': 0.7115773952778172, 'psi': 0.7472633494004599}-{'f1_val': 0.5895756748758396, 'auprc': 0.9452847784905567, 'loss_val': 0.9739708001834798, 'psi': 0.7318593163217264}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] sending update (kind=head size=1794 to 1 peers)
[S2] START round=44 head_norm_before_train=2.334975 cos_to_last_merge=0.9985 (last merge round=33)
[S2] round=44 local utility u=0.000000 metrics={'f1_val': 0.7087269299747847, 'auprc': 0.8465580880431864, 'loss_val': 0.5897583404883991, 'psi': 0.7638593932021454}-{'f1_val': 0.7263483507793593, 'auprc': 0.8539010153736956, 'loss_val': 0.48751893108717115, 'psi': 0.7773694166170939}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=44 head_norm_before_train=2.349563 cos_to_last_merge=0.9996 (last merge round=35)
[S3] round=44 local utility u=0.128302 metrics={'f1_val': 0.9859851590918147, 'auprc': 0.9984468527778403, 'loss_val': 0.03210208230795545, 'psi': 0.990969836566225}-{'f1_val': 0.9610352511054436, 'auprc': 0.9984389978968893, 'loss_val': 0.13898220825924706, 'psi': 0.9759967498220219}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=44 head_norm_before_train=1.525272 cos_to_last_merge=0.9886 (last merge round=33)
[S4] round=44 local utility u=0.000000 metrics={'f1_val': 0.9377831148862046, 'auprc': 0.9121849075214876, 'loss_val': 0.2925837198366241, 'psi': 0.9275438319403179}-{'f1_val': 0.93863591782787, 'auprc': 0.9210784977568812, 'loss_val': 0.28845601633109147, 'psi': 0.9316129497994745}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=44 head_norm_before_train=1.545233 cos_to_last_merge=0.9802 (last merge round=34)
[S5] round=44 local utility u=0.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9979608568174835, 'loss_val': 0.05465663519396051, 'psi': 0.997205523814068}-{'f1_val': 0.9970695586110643, 'auprc': 0.9990665799946713, 'loss_val': 0.05973489535897418, 'psi': 0.9978683671645071}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=44 head_norm_before_train=1.340855 cos_to_last_merge=0.9936 (last merge round=34)
[S6] round=44 local utility u=0.000000 metrics={'f1_val': 0.6707432157466701, 'auprc': 0.7686021816092308, 'loss_val': 0.38339598904000444, 'psi': 0.7098868020916944}-{'f1_val': 0.8123042562465399, 'auprc': 0.9222326680841175, 'loss_val': 0.3171273155844394, 'psi': 0.856275620981571}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=44 head_norm_before_train=1.673079 cos_to_last_merge=0.9822 (last merge round=30)
[S7] round=44 local utility u=0.403001 metrics={'f1_val': 0.6556588521277935, 'auprc': 0.8111221023628874, 'loss_val': 0.3927440377100773, 'psi': 0.7178441522218311}-{'f1_val': 0.5956084015557609, 'auprc': 0.7930046449182868, 'loss_val': 0.7840910758421761, 'psi': 0.6745668989007713}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=44 head_norm_before_train=2.029228 (no previous merge yet)
[S8] round=44 local utility u=0.008027 metrics={'f1_val': 0.9930017911527874, 'auprc': 0.9988323124532108, 'loss_val': 0.031099518638915108, 'psi': 0.9953339996729568}-{'f1_val': 0.9910113370052481, 'auprc': 0.9989370478786554, 'loss_val': 0.035524464444898, 'psi': 0.9941816213546111}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S8] sending update (kind=head size=1790 to 1 peers)
[S9] START round=44 head_norm_before_train=1.518083 cos_to_last_merge=0.9789 (last merge round=28)
[S9] round=44 local utility u=0.006234 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9971319910131915, 'loss_val': 0.025428822878412975, 'psi': 0.9968491034936114}-{'f1_val': 0.9949999422209534, 'auprc': 0.99785478320459, 'loss_val': 0.030101630438391896, 'psi': 0.9961418786144081}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=44 head_norm_before_train=1.886042 cos_to_last_merge=0.8236 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.824
[S10] round=44 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9943580263988084, 'loss_val': 0.029274403267515545, 'psi': 0.9949370828977615}-{'f1_val': 0.9953231205637304, 'auprc': 0.9946129697407998, 'loss_val': 0.029449177103701145, 'psi': 0.9950390602345581}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=44 head_norm_before_train=1.607715 cos_to_last_merge=0.9600 (last merge round=27)
[S11] round=44 local utility u=0.002065 metrics={'f1_val': 0.9971565747497426, 'auprc': 0.9988610567457379, 'loss_val': 0.040278406117794444, 'psi': 0.9978383675481407}-{'f1_val': 0.9967224195815153, 'auprc': 0.9969233106206745, 'loss_val': 0.03598991404637417, 'psi': 0.996802775997179}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=44 head_norm_before_train=1.732500 (no previous merge yet)
[S13] round=44 local utility u=0.000000 metrics={'f1_val': 0.6205061071471117, 'auprc': 0.6218299512602208, 'loss_val': 0.9646309440858314, 'psi': 0.6210356447923554}-{'f1_val': 0.5895824185814594, 'auprc': 0.6680085993667094, 'loss_val': 0.7595005012669935, 'psi': 0.6209528908955594}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=44 head_norm_before_train=1.539638 cos_to_last_merge=0.9963 (last merge round=34)
[S14] round=44 local utility u=0.000000 metrics={'f1_val': 0.9959579423242457, 'auprc': 0.9988466497415013, 'loss_val': 0.03892497083298111, 'psi': 0.997113425291148}-{'f1_val': 0.9963677359485, 'auprc': 0.9987078238148119, 'loss_val': 0.039784571190026125, 'psi': 0.9973037710950248}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=44 head_norm_before_train=1.494139 cos_to_last_merge=0.9884 (last merge round=35)
[S15] round=44 local utility u=0.000000 metrics={'f1_val': 0.9024018209454697, 'auprc': 0.9884351260607801, 'loss_val': 0.21617231837486947, 'psi': 0.9368151429915939}-{'f1_val': 0.9048767495122143, 'auprc': 0.995987636961142, 'loss_val': 0.18631520544018618, 'psi': 0.9413211044917854}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=44 head_norm_before_train=1.740349 cos_to_last_merge=0.9915 (last merge round=35)
[S16] round=44 local utility u=0.000000 metrics={'f1_val': 0.9380735704945669, 'auprc': 0.9961444338223326, 'loss_val': 0.28399782492806674, 'psi': 0.9613019158256731}-{'f1_val': 0.9914299927416418, 'auprc': 0.9954447219489759, 'loss_val': 0.043721261683802796, 'psi': 0.9930358844245755}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=44 head_norm_before_train=1.517060 cos_to_last_merge=0.9731 (last merge round=30)
[S17] round=44 local utility u=0.021240 metrics={'f1_val': 0.6401487259414322, 'auprc': 0.9606575268850492, 'loss_val': 0.8219046599822315, 'psi': 0.768352246318879}-{'f1_val': 0.6437222678485852, 'auprc': 0.9025749717282722, 'loss_val': 0.7115773952778172, 'psi': 0.7472633494004599}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=45 head_norm_before_train=2.343127 cos_to_last_merge=0.9983 (last merge round=33)
[S2] round=45 local utility u=0.074066 metrics={'f1_val': 0.7088286737375644, 'auprc': 0.8802609609213945, 'loss_val': 0.5433447972157577, 'psi': 0.7774015886110965}-{'f1_val': 0.7087269299747847, 'auprc': 0.8465580880431864, 'loss_val': 0.5897583404883991, 'psi': 0.7638593932021454}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=45 head_norm_before_train=2.356961 cos_to_last_merge=0.9996 (last merge round=35)
[S3] round=45 local utility u=0.038809 metrics={'f1_val': 0.9973982357793907, 'auprc': 0.9984332688175075, 'loss_val': 0.022921615948457003, 'psi': 0.9978122489946375}-{'f1_val': 0.9859851590918147, 'auprc': 0.9984468527778403, 'loss_val': 0.03210208230795545, 'psi': 0.990969836566225}
[S3] not sending this round → trigger blocked (psi=0.998)
[S4] START round=45 head_norm_before_train=1.535716 cos_to_last_merge=0.9877 (last merge round=33)
[S4] round=45 local utility u=0.105014 metrics={'f1_val': 0.9488655075203585, 'auprc': 0.9521890354988432, 'loss_val': 0.2690631414694047, 'psi': 0.9501949187117523}-{'f1_val': 0.9377831148862046, 'auprc': 0.9121849075214876, 'loss_val': 0.2925837198366241, 'psi': 0.9275438319403179}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=45 head_norm_before_train=1.570081 cos_to_last_merge=0.9774 (last merge round=34)
[S5] round=45 local utility u=0.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9964922976391496, 'loss_val': 0.050922917405132814, 'psi': 0.9966181001427344}-{'f1_val': 0.9967019684784577, 'auprc': 0.9979608568174835, 'loss_val': 0.05465663519396051, 'psi': 0.997205523814068}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=45 head_norm_before_train=1.349278 cos_to_last_merge=0.9929 (last merge round=34)
[S6] round=45 local utility u=0.760661 metrics={'f1_val': 0.8360292732105081, 'auprc': 0.9268307194465609, 'loss_val': 0.3284751559160832, 'psi': 0.8723498517049293}-{'f1_val': 0.6707432157466701, 'auprc': 0.7686021816092308, 'loss_val': 0.38339598904000444, 'psi': 0.7098868020916944}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] sending update (kind=head size=1804 to 1 peers)
[S7] START round=45 head_norm_before_train=1.683504 cos_to_last_merge=0.9813 (last merge round=30)
[S7] round=45 local utility u=0.101333 metrics={'f1_val': 0.6720442262383612, 'auprc': 0.8306441714371087, 'loss_val': 0.3469558824260657, 'psi': 0.7354842043178602}-{'f1_val': 0.6556588521277935, 'auprc': 0.8111221023628874, 'loss_val': 0.3927440377100773, 'psi': 0.7178441522218311}
[S7] not sending this round → trigger blocked (psi=0.735)
[S8] START round=45 head_norm_before_train=2.036725 (no previous merge yet)
[S8] round=45 local utility u=0.000000 metrics={'f1_val': 0.9926368238932805, 'auprc': 0.9989956085717228, 'loss_val': 0.03090097058419148, 'psi': 0.9951803377646573}-{'f1_val': 0.9930017911527874, 'auprc': 0.9988323124532108, 'loss_val': 0.031099518638915108, 'psi': 0.9953339996729568}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=45 head_norm_before_train=1.532537 cos_to_last_merge=0.9779 (last merge round=28)
[S9] round=45 local utility u=0.000000 metrics={'f1_val': 0.9937492462693716, 'auprc': 0.9972836436576744, 'loss_val': 0.03054631043919974, 'psi': 0.9951630052246927}-{'f1_val': 0.9966605118138915, 'auprc': 0.9971319910131915, 'loss_val': 0.025428822878412975, 'psi': 0.9968491034936114}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=45 head_norm_before_train=1.892938 cos_to_last_merge=0.8230 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.823
[S10] round=45 local utility u=0.000474 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9946011302470998, 'loss_val': 0.02905573572666647, 'psi': 0.9950343244370781}-{'f1_val': 0.9953231205637304, 'auprc': 0.9943580263988084, 'loss_val': 0.029274403267515545, 'psi': 0.9949370828977615}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=45 head_norm_before_train=1.621785 cos_to_last_merge=0.9585 (last merge round=27)
[S11] round=45 local utility u=0.000000 metrics={'f1_val': 0.9885291118702789, 'auprc': 0.9988348624278716, 'loss_val': 0.043928244855233785, 'psi': 0.9926514120933159}-{'f1_val': 0.9971565747497426, 'auprc': 0.9988610567457379, 'loss_val': 0.040278406117794444, 'psi': 0.9978383675481407}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=45 head_norm_before_train=1.743109 (no previous merge yet)
[S13] round=45 local utility u=0.410700 metrics={'f1_val': 0.6662672750386194, 'auprc': 0.7062128600267208, 'loss_val': 0.6709461689857961, 'psi': 0.6822455090338599}-{'f1_val': 0.6205061071471117, 'auprc': 0.6218299512602208, 'loss_val': 0.9646309440858314, 'psi': 0.6210356447923554}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=45 head_norm_before_train=1.547330 cos_to_last_merge=0.9961 (last merge round=34)
[S14] round=45 local utility u=0.001164 metrics={'f1_val': 0.9961248879791463, 'auprc': 0.9990052705662402, 'loss_val': 0.03807369748914911, 'psi': 0.9972770410139838}-{'f1_val': 0.9959579423242457, 'auprc': 0.9988466497415013, 'loss_val': 0.03892497083298111, 'psi': 0.997113425291148}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=45 head_norm_before_train=1.515926 cos_to_last_merge=0.9870 (last merge round=35)
[S15] round=45 local utility u=0.235985 metrics={'f1_val': 0.9551378217365307, 'auprc': 0.9974644804906687, 'loss_val': 0.08770720732990848, 'psi': 0.9720684852381859}-{'f1_val': 0.9024018209454697, 'auprc': 0.9884351260607801, 'loss_val': 0.21617231837486947, 'psi': 0.9368151429915939}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=45 head_norm_before_train=1.757551 cos_to_last_merge=0.9906 (last merge round=35)
[S16] round=45 local utility u=0.000000 metrics={'f1_val': 0.8439793979044744, 'auprc': 0.9876717701594522, 'loss_val': 0.9039913953097073, 'psi': 0.9014563468064656}-{'f1_val': 0.9380735704945669, 'auprc': 0.9961444338223326, 'loss_val': 0.28399782492806674, 'psi': 0.9613019158256731}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=45 head_norm_before_train=1.527046 cos_to_last_merge=0.9722 (last merge round=30)
[S17] round=45 local utility u=0.023503 metrics={'f1_val': 0.6374271555251393, 'auprc': 0.984145823022621, 'loss_val': 0.8290335722204535, 'psi': 0.776114622524132}-{'f1_val': 0.6401487259414322, 'auprc': 0.9606575268850492, 'loss_val': 0.8219046599822315, 'psi': 0.768352246318879}
[S17] not sending this round → trigger blocked (psi=0.776)
[S2] START round=46 head_norm_before_train=2.350798 cos_to_last_merge=0.9981 (last merge round=33)
[S2] round=46 local utility u=0.187539 metrics={'f1_val': 0.8229287037271096, 'auprc': 0.7601464392675825, 'loss_val': 0.4925232231805667, 'psi': 0.7978157979432987}-{'f1_val': 0.7088286737375644, 'auprc': 0.8802609609213945, 'loss_val': 0.5433447972157577, 'psi': 0.7774015886110965}
[S2] not sending this round → trigger blocked (psi=0.798)
[S3] START round=46 head_norm_before_train=2.360124 cos_to_last_merge=0.9996 (last merge round=35)
[S3] round=46 local utility u=0.000000 metrics={'f1_val': 0.9842990376761878, 'auprc': 0.9983905248654521, 'loss_val': 0.04383812781281991, 'psi': 0.9899356325518935}-{'f1_val': 0.9973982357793907, 'auprc': 0.9984332688175075, 'loss_val': 0.022921615948457003, 'psi': 0.9978122489946375}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=46 head_norm_before_train=1.543497 cos_to_last_merge=0.9867 (last merge round=33)
[S4] round=46 local utility u=0.000000 metrics={'f1_val': 0.9435517819852418, 'auprc': 0.9397100817730779, 'loss_val': 0.27372610379860207, 'psi': 0.9420151019003763}-{'f1_val': 0.9488655075203585, 'auprc': 0.9521890354988432, 'loss_val': 0.2690631414694047, 'psi': 0.9501949187117523}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=46 head_norm_before_train=1.598158 cos_to_last_merge=0.9737 (last merge round=34)
[S5] round=46 local utility u=0.007767 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.998463586076206, 'loss_val': 0.04130256464298688, 'psi': 0.9974066155175569}-{'f1_val': 0.9967019684784577, 'auprc': 0.9964922976391496, 'loss_val': 0.050922917405132814, 'psi': 0.9966181001427344}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=46 head_norm_before_train=1.354286 cos_to_last_merge=0.9925 (last merge round=34)
[S6] round=46 local utility u=0.000000 metrics={'f1_val': 0.6987987307909224, 'auprc': 0.9627674644337565, 'loss_val': 0.2774759595547543, 'psi': 0.804386224248056}-{'f1_val': 0.8360292732105081, 'auprc': 0.9268307194465609, 'loss_val': 0.3284751559160832, 'psi': 0.8723498517049293}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=46 head_norm_before_train=1.697283 cos_to_last_merge=0.9805 (last merge round=30)
[S7] round=46 local utility u=0.000000 metrics={'f1_val': 0.6538054682481227, 'auprc': 0.8063708775015079, 'loss_val': 0.5128115791697085, 'psi': 0.7148316319494767}-{'f1_val': 0.6720442262383612, 'auprc': 0.8306441714371087, 'loss_val': 0.3469558824260657, 'psi': 0.7354842043178602}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=46 head_norm_before_train=2.043827 (no previous merge yet)
[S8] round=46 local utility u=0.000000 metrics={'f1_val': 0.9848065069595293, 'auprc': 0.9973967558233875, 'loss_val': 0.045703192558499396, 'psi': 0.9898426065050726}-{'f1_val': 0.9926368238932805, 'auprc': 0.9989956085717228, 'loss_val': 0.03090097058419148, 'psi': 0.9951803377646573}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=46 head_norm_before_train=1.545100 cos_to_last_merge=0.9769 (last merge round=28)
[S9] round=46 local utility u=0.008870 metrics={'f1_val': 0.9958312226609984, 'auprc': 0.9973943032757376, 'loss_val': 0.025630828698707423, 'psi': 0.996456454906894}-{'f1_val': 0.9937492462693716, 'auprc': 0.9972836436576744, 'loss_val': 0.03054631043919974, 'psi': 0.9951630052246927}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=46 head_norm_before_train=1.900597 cos_to_last_merge=0.8223 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.822
[S10] round=46 local utility u=0.000040 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9945612759532347, 'loss_val': 0.02885617341376142, 'psi': 0.995018382719532}-{'f1_val': 0.9953231205637304, 'auprc': 0.9946011302470998, 'loss_val': 0.02905573572666647, 'psi': 0.9950343244370781}
[S10] not sending this round → trigger blocked (psi=0.995)
[S11] START round=46 head_norm_before_train=1.633678 cos_to_last_merge=0.9573 (last merge round=27)
[S11] round=46 local utility u=0.032728 metrics={'f1_val': 0.9974011907167429, 'auprc': 0.9982770385539056, 'loss_val': 0.030030647974875518, 'psi': 0.997751529851608}-{'f1_val': 0.9885291118702789, 'auprc': 0.9988348624278716, 'loss_val': 0.043928244855233785, 'psi': 0.9926514120933159}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S11] sending update (kind=head size=1807 to 1 peers)
[S13] START round=46 head_norm_before_train=1.756814 (no previous merge yet)
[S13] round=46 local utility u=0.000000 metrics={'f1_val': 0.6728541645666741, 'auprc': 0.6819872682462217, 'loss_val': 0.824459581028213, 'psi': 0.6765074060384932}-{'f1_val': 0.6662672750386194, 'auprc': 0.7062128600267208, 'loss_val': 0.6709461689857961, 'psi': 0.6822455090338599}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=46 head_norm_before_train=1.556675 cos_to_last_merge=0.9959 (last merge round=34)
[S14] round=46 local utility u=0.000949 metrics={'f1_val': 0.9961248879791463, 'auprc': 0.9989969894396831, 'loss_val': 0.036149971208658246, 'psi': 0.997273728563361}-{'f1_val': 0.9961248879791463, 'auprc': 0.9990052705662402, 'loss_val': 0.03807369748914911, 'psi': 0.9972770410139838}
[S14] not sending this round → trigger blocked (psi=0.997)
[S15] START round=46 head_norm_before_train=1.534333 cos_to_last_merge=0.9858 (last merge round=35)
[S15] round=46 local utility u=0.000000 metrics={'f1_val': 0.8598886976320218, 'auprc': 0.9257206717239406, 'loss_val': 0.30213399744697095, 'psi': 0.8862214872687892}-{'f1_val': 0.9551378217365307, 'auprc': 0.9974644804906687, 'loss_val': 0.08770720732990848, 'psi': 0.9720684852381859}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=46 head_norm_before_train=1.774301 cos_to_last_merge=0.9897 (last merge round=35)
[S16] round=46 local utility u=0.782123 metrics={'f1_val': 0.967277049469794, 'auprc': 0.996624101530087, 'loss_val': 0.10638796934713994, 'psi': 0.9790158702939111}-{'f1_val': 0.8439793979044744, 'auprc': 0.9876717701594522, 'loss_val': 0.9039913953097073, 'psi': 0.9014563468064656}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S17] START round=46 head_norm_before_train=1.539028 cos_to_last_merge=0.9711 (last merge round=30)
[S17] round=46 local utility u=0.164717 metrics={'f1_val': 0.6628065380191911, 'auprc': 0.9866755375060641, 'loss_val': 0.6594650041081752, 'psi': 0.7923541378139403}-{'f1_val': 0.6374271555251393, 'auprc': 0.984145823022621, 'loss_val': 0.8290335722204535, 'psi': 0.776114622524132}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=47 head_norm_before_train=2.358048 cos_to_last_merge=0.9978 (last merge round=33)
[S2] round=47 local utility u=0.000000 metrics={'f1_val': 0.7100320888065763, 'auprc': 0.9604467032459351, 'loss_val': 0.5109079555716304, 'psi': 0.8101979345823198}-{'f1_val': 0.8229287037271096, 'auprc': 0.7601464392675825, 'loss_val': 0.4925232231805667, 'psi': 0.7978157979432987}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=47 head_norm_before_train=2.367718 cos_to_last_merge=0.9995 (last merge round=35)
[S3] round=47 local utility u=0.000000 metrics={'f1_val': 0.9871725261700923, 'auprc': 0.9976160346635782, 'loss_val': 0.061462381772628985, 'psi': 0.9913499295674867}-{'f1_val': 0.9842990376761878, 'auprc': 0.9983905248654521, 'loss_val': 0.04383812781281991, 'psi': 0.9899356325518935}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=47 head_norm_before_train=1.550598 cos_to_last_merge=0.9859 (last merge round=33)
[S4] round=47 local utility u=0.000000 metrics={'f1_val': 0.9417760604409906, 'auprc': 0.9368752611706529, 'loss_val': 0.2778124602893363, 'psi': 0.9398157407328556}-{'f1_val': 0.9435517819852418, 'auprc': 0.9397100817730779, 'loss_val': 0.27372610379860207, 'psi': 0.9420151019003763}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=47 head_norm_before_train=1.631721 cos_to_last_merge=0.9699 (last merge round=34)
[S5] round=47 local utility u=0.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9975037179568673, 'loss_val': 0.04130564520234867, 'psi': 0.9970226682698216}-{'f1_val': 0.9967019684784577, 'auprc': 0.998463586076206, 'loss_val': 0.04130256464298688, 'psi': 0.9974066155175569}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=47 head_norm_before_train=1.358307 cos_to_last_merge=0.9921 (last merge round=34)
[S6] round=47 local utility u=0.695155 metrics={'f1_val': 0.9279177605225577, 'auprc': 0.970121830212418, 'loss_val': 0.28394344032802865, 'psi': 0.9447993883985019}-{'f1_val': 0.6987987307909224, 'auprc': 0.9627674644337565, 'loss_val': 0.2774759595547543, 'psi': 0.804386224248056}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S6] sending update (kind=head size=1808 to 1 peers)
[S7] START round=47 head_norm_before_train=1.708603 cos_to_last_merge=0.9795 (last merge round=30)
[S7] round=47 local utility u=0.000000 metrics={'f1_val': 0.5981813724859073, 'auprc': 0.7950480854690487, 'loss_val': 0.7385899901913886, 'psi': 0.6769280576791639}-{'f1_val': 0.6538054682481227, 'auprc': 0.8063708775015079, 'loss_val': 0.5128115791697085, 'psi': 0.7148316319494767}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=47 head_norm_before_train=2.048418 (no previous merge yet)
[S8] round=47 local utility u=0.032442 metrics={'f1_val': 0.9939009886418481, 'auprc': 0.9967648463723029, 'loss_val': 0.03349065763243122, 'psi': 0.99504653173403}-{'f1_val': 0.9848065069595293, 'auprc': 0.9973967558233875, 'loss_val': 0.045703192558499396, 'psi': 0.9898426065050726}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=47 head_norm_before_train=1.554762 cos_to_last_merge=0.9761 (last merge round=28)
[S9] round=47 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9945707876261551, 'loss_val': 0.02414943689402485, 'psi': 0.995824622138797}-{'f1_val': 0.9958312226609984, 'auprc': 0.9973943032757376, 'loss_val': 0.025630828698707423, 'psi': 0.996456454906894}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=47 head_norm_before_train=1.905668 cos_to_last_merge=0.8218 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.822
[S10] round=47 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9942740415145074, 'loss_val': 0.028691987339329688, 'psi': 0.9949034889440411}-{'f1_val': 0.9953231205637304, 'auprc': 0.9945612759532347, 'loss_val': 0.02885617341376142, 'psi': 0.995018382719532}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=47 head_norm_before_train=1.644926 cos_to_last_merge=0.9561 (last merge round=27)
[S11] round=47 local utility u=0.000000 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9974162815726253, 'loss_val': 0.03069190995853488, 'psi': 0.9968970656261085}-{'f1_val': 0.9974011907167429, 'auprc': 0.9982770385539056, 'loss_val': 0.030030647974875518, 'psi': 0.997751529851608}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=47 head_norm_before_train=1.766868 (no previous merge yet)
[S13] round=47 local utility u=0.000000 metrics={'f1_val': 0.6006193923806455, 'auprc': 0.6178622647143297, 'loss_val': 1.1925293156125811, 'psi': 0.6075165413141193}-{'f1_val': 0.6728541645666741, 'auprc': 0.6819872682462217, 'loss_val': 0.824459581028213, 'psi': 0.6765074060384932}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=47 head_norm_before_train=1.566680 cos_to_last_merge=0.9955 (last merge round=34)
[S14] round=47 local utility u=0.000000 metrics={'f1_val': 0.996345017535854, 'auprc': 0.9978835132066552, 'loss_val': 0.03538899128833112, 'psi': 0.9969604158041745}-{'f1_val': 0.9961248879791463, 'auprc': 0.9989969894396831, 'loss_val': 0.036149971208658246, 'psi': 0.997273728563361}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=47 head_norm_before_train=1.550093 cos_to_last_merge=0.9847 (last merge round=35)
[S15] round=47 local utility u=0.290498 metrics={'f1_val': 0.9028851005076263, 'auprc': 0.9952389679222026, 'loss_val': 0.18767030494799034, 'psi': 0.9398266474734568}-{'f1_val': 0.8598886976320218, 'auprc': 0.9257206717239406, 'loss_val': 0.30213399744697095, 'psi': 0.8862214872687892}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] sending update (kind=head size=1802 to 1 peers)
[S16] START round=47 head_norm_before_train=1.791326 cos_to_last_merge=0.9888 (last merge round=35)
[S16] round=47 local utility u=0.099536 metrics={'f1_val': 0.991177437547192, 'auprc': 0.9939732544607802, 'loss_val': 0.04276599203782828, 'psi': 0.9922957643126273}-{'f1_val': 0.967277049469794, 'auprc': 0.996624101530087, 'loss_val': 0.10638796934713994, 'psi': 0.9790158702939111}
[S16] not sending this round → trigger blocked (psi=0.992)
[S17] START round=47 head_norm_before_train=1.551150 cos_to_last_merge=0.9702 (last merge round=30)
[S17] round=47 local utility u=0.000000 metrics={'f1_val': 0.5967362757192152, 'auprc': 0.984180032104003, 'loss_val': 1.0380692068315578, 'psi': 0.7517137782731302}-{'f1_val': 0.6628065380191911, 'auprc': 0.9866755375060641, 'loss_val': 0.6594650041081752, 'psi': 0.7923541378139403}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=48 head_norm_before_train=2.363279 cos_to_last_merge=0.9976 (last merge round=33)
[S2] round=48 local utility u=0.000000 metrics={'f1_val': 0.7087254637380869, 'auprc': 0.867115581539546, 'loss_val': 0.5994633465939451, 'psi': 0.7720815108586705}-{'f1_val': 0.7100320888065763, 'auprc': 0.9604467032459351, 'loss_val': 0.5109079555716304, 'psi': 0.8101979345823198}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=48 head_norm_before_train=2.374124 cos_to_last_merge=0.9994 (last merge round=35)
[S3] round=48 local utility u=0.042789 metrics={'f1_val': 0.9953166962312615, 'auprc': 0.998101624753199, 'loss_val': 0.026205824731035356, 'psi': 0.9964306676400365}-{'f1_val': 0.9871725261700923, 'auprc': 0.9976160346635782, 'loss_val': 0.061462381772628985, 'psi': 0.9913499295674867}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=48 head_norm_before_train=1.559714 cos_to_last_merge=0.9853 (last merge round=33)
[S4] round=48 local utility u=0.000000 metrics={'f1_val': 0.9406210117911215, 'auprc': 0.92049841926352, 'loss_val': 0.2846700868000031, 'psi': 0.9325719747800809}-{'f1_val': 0.9417760604409906, 'auprc': 0.9368752611706529, 'loss_val': 0.2778124602893363, 'psi': 0.9398157407328556}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=48 head_norm_before_train=1.656330 cos_to_last_merge=0.9672 (last merge round=34)
[S5] round=48 local utility u=0.002741 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.998269476261068, 'loss_val': 0.038120073218583836, 'psi': 0.9973289715915018}-{'f1_val': 0.9967019684784577, 'auprc': 0.9975037179568673, 'loss_val': 0.04130564520234867, 'psi': 0.9970226682698216}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=48 head_norm_before_train=1.361845 cos_to_last_merge=0.9918 (last merge round=34)
[S6] round=48 local utility u=0.000000 metrics={'f1_val': 0.6969282157500823, 'auprc': 0.9509219762093716, 'loss_val': 0.29494737787292535, 'psi': 0.7985257199337981}-{'f1_val': 0.9279177605225577, 'auprc': 0.970121830212418, 'loss_val': 0.28394344032802865, 'psi': 0.9447993883985019}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=48 head_norm_before_train=1.717372 cos_to_last_merge=0.9791 (last merge round=30)
[S7] round=48 local utility u=0.115634 metrics={'f1_val': 0.6216387032766327, 'auprc': 0.7997640470471641, 'loss_val': 0.6622140832293586, 'psi': 0.6928888407848453}-{'f1_val': 0.5981813724859073, 'auprc': 0.7950480854690487, 'loss_val': 0.7385899901913886, 'psi': 0.6769280576791639}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S7] sending update (kind=head size=1789 to 1 peers)
[S8] START round=48 head_norm_before_train=2.053230 (no previous merge yet)
[S8] round=48 local utility u=0.000000 metrics={'f1_val': 0.9918763177247631, 'auprc': 0.9989157215165623, 'loss_val': 0.03232204030472979, 'psi': 0.9946920792414827}-{'f1_val': 0.9939009886418481, 'auprc': 0.9967648463723029, 'loss_val': 0.03349065763243122, 'psi': 0.99504653173403}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=48 head_norm_before_train=1.564651 cos_to_last_merge=0.9753 (last merge round=28)
[S9] round=48 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9944421810877999, 'loss_val': 0.02394805835146228, 'psi': 0.9957731795234548}-{'f1_val': 0.9966605118138915, 'auprc': 0.9945707876261551, 'loss_val': 0.02414943689402485, 'psi': 0.995824622138797}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=48 head_norm_before_train=1.911236 cos_to_last_merge=0.8213 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.821
[S10] round=48 local utility u=0.000000 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.9948386154747751, 'loss_val': 0.028803411815056062, 'psi': 0.9947340791955599}-{'f1_val': 0.9953231205637304, 'auprc': 0.9942740415145074, 'loss_val': 0.028691987339329688, 'psi': 0.9949034889440411}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=48 head_norm_before_train=1.656749 cos_to_last_merge=0.9549 (last merge round=27)
[S11] round=48 local utility u=0.003523 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9982252723555628, 'loss_val': 0.0285531695448643, 'psi': 0.9974686629179714}-{'f1_val': 0.9965509216617638, 'auprc': 0.9974162815726253, 'loss_val': 0.03069190995853488, 'psi': 0.9968970656261085}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=48 head_norm_before_train=1.774538 (no previous merge yet)
[S13] round=48 local utility u=0.300198 metrics={'f1_val': 0.6402139885143403, 'auprc': 0.6453316687631934, 'loss_val': 0.9121092596425964, 'psi': 0.6422610606138816}-{'f1_val': 0.6006193923806455, 'auprc': 0.6178622647143297, 'loss_val': 1.1925293156125811, 'psi': 0.6075165413141193}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=48 head_norm_before_train=1.576367 cos_to_last_merge=0.9950 (last merge round=34)
[S14] round=48 local utility u=0.000899 metrics={'f1_val': 0.9968205796367875, 'auprc': 0.9972363551128678, 'loss_val': 0.03450231107523552, 'psi': 0.9969868898272196}-{'f1_val': 0.996345017535854, 'auprc': 0.9978835132066552, 'loss_val': 0.03538899128833112, 'psi': 0.9969604158041745}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=48 head_norm_before_train=1.565110 cos_to_last_merge=0.9837 (last merge round=35)
[S15] round=48 local utility u=0.359286 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9970462531686317, 'loss_val': 0.03768973457961695, 'psi': 0.996866502299965}-{'f1_val': 0.9028851005076263, 'auprc': 0.9952389679222026, 'loss_val': 0.18767030494799034, 'psi': 0.9398266474734568}
[S15] not sending this round → trigger blocked (psi=0.997)
[S16] START round=48 head_norm_before_train=1.806449 cos_to_last_merge=0.9880 (last merge round=35)
[S16] round=48 local utility u=0.000000 metrics={'f1_val': 0.9805862102538447, 'auprc': 0.996464210242247, 'loss_val': 0.06850871946212178, 'psi': 0.9869374102492057}-{'f1_val': 0.991177437547192, 'auprc': 0.9939732544607802, 'loss_val': 0.04276599203782828, 'psi': 0.9922957643126273}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=48 head_norm_before_train=1.560254 cos_to_last_merge=0.9692 (last merge round=30)
[S17] round=48 local utility u=0.176918 metrics={'f1_val': 0.6425793200190408, 'auprc': 0.9642822243282135, 'loss_val': 0.899597741464841, 'psi': 0.7712604817427099}-{'f1_val': 0.5967362757192152, 'auprc': 0.984180032104003, 'loss_val': 1.0380692068315578, 'psi': 0.7517137782731302}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=49 head_norm_before_train=2.369424 cos_to_last_merge=0.9974 (last merge round=33)
[S2] round=49 local utility u=0.168248 metrics={'f1_val': 0.7804448999203454, 'auprc': 0.8114616578342548, 'loss_val': 0.5263221797984384, 'psi': 0.7928516030859092}-{'f1_val': 0.7087254637380869, 'auprc': 0.867115581539546, 'loss_val': 0.5994633465939451, 'psi': 0.7720815108586705}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=49 head_norm_before_train=2.380823 cos_to_last_merge=0.9993 (last merge round=35)
[S3] round=49 local utility u=0.000000 metrics={'f1_val': 0.9843983621976989, 'auprc': 0.9973766760179337, 'loss_val': 0.07959739449579262, 'psi': 0.9895896877257928}-{'f1_val': 0.9953166962312615, 'auprc': 0.998101624753199, 'loss_val': 0.026205824731035356, 'psi': 0.9964306676400365}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=49 head_norm_before_train=1.566875 cos_to_last_merge=0.9842 (last merge round=33)
[S4] round=49 local utility u=0.000000 metrics={'f1_val': 0.9399062820717073, 'auprc': 0.9180195139547636, 'loss_val': 0.29042601847261873, 'psi': 0.9311515748249298}-{'f1_val': 0.9406210117911215, 'auprc': 0.92049841926352, 'loss_val': 0.2846700868000031, 'psi': 0.9325719747800809}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=49 head_norm_before_train=1.677497 cos_to_last_merge=0.9641 (last merge round=34)
[S5] round=49 local utility u=0.001948 metrics={'f1_val': 0.9974365845193254, 'auprc': 0.999080477136037, 'loss_val': 0.04106491199321239, 'psi': 0.9980941415660101}-{'f1_val': 0.9967019684784577, 'auprc': 0.998269476261068, 'loss_val': 0.038120073218583836, 'psi': 0.9973289715915018}
[S5] not sending this round → trigger blocked (psi=0.998)
[S6] START round=49 head_norm_before_train=1.365368 cos_to_last_merge=0.9912 (last merge round=34)
[S6] round=49 local utility u=0.733444 metrics={'f1_val': 0.9363970529933763, 'auprc': 0.9518749114785542, 'loss_val': 0.2677311229868216, 'psi': 0.9425881963874474}-{'f1_val': 0.6969282157500823, 'auprc': 0.9509219762093716, 'loss_val': 0.29494737787292535, 'psi': 0.7985257199337981}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=49 head_norm_before_train=1.726882 cos_to_last_merge=0.9784 (last merge round=30)
[S7] round=49 local utility u=0.000000 metrics={'f1_val': 0.5749845037200163, 'auprc': 0.7912296648736099, 'loss_val': 0.9502068881129716, 'psi': 0.6614825681814538}-{'f1_val': 0.6216387032766327, 'auprc': 0.7997640470471641, 'loss_val': 0.6622140832293586, 'psi': 0.6928888407848453}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=49 head_norm_before_train=2.056262 (no previous merge yet)
[S8] round=49 local utility u=0.000000 metrics={'f1_val': 0.9717395296379672, 'auprc': 0.9990854651875707, 'loss_val': 0.07187502262342005, 'psi': 0.9826779038578086}-{'f1_val': 0.9918763177247631, 'auprc': 0.9989157215165623, 'loss_val': 0.03232204030472979, 'psi': 0.9946920792414827}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=49 head_norm_before_train=1.572918 cos_to_last_merge=0.9747 (last merge round=28)
[S9] round=49 local utility u=0.000215 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9945258795034242, 'loss_val': 0.023770087754009253, 'psi': 0.9958066588897045}-{'f1_val': 0.9966605118138915, 'auprc': 0.9944421810877999, 'loss_val': 0.02394805835146228, 'psi': 0.9957731795234548}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=49 head_norm_before_train=1.918219 cos_to_last_merge=0.8206 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.821
[S10] round=49 local utility u=0.001880 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9945795675536987, 'loss_val': 0.028218994207921563, 'psi': 0.9950256993597177}-{'f1_val': 0.9946643883427498, 'auprc': 0.9948386154747751, 'loss_val': 0.028803411815056062, 'psi': 0.9947340791955599}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=49 head_norm_before_train=1.669045 cos_to_last_merge=0.9536 (last merge round=27)
[S11] round=49 local utility u=0.002207 metrics={'f1_val': 0.9974011907167429, 'auprc': 0.9982996648138942, 'loss_val': 0.02698424576353636, 'psi': 0.9977605803556034}-{'f1_val': 0.9969642566262439, 'auprc': 0.9982252723555628, 'loss_val': 0.0285531695448643, 'psi': 0.9974686629179714}
[S11] not sending this round → trigger blocked (psi=0.998)
[S13] START round=49 head_norm_before_train=1.781555 (no previous merge yet)
[S13] round=49 local utility u=0.348157 metrics={'f1_val': 0.6761766466962417, 'auprc': 0.7241680679488707, 'loss_val': 0.6680813582229347, 'psi': 0.6953732151972933}-{'f1_val': 0.6402139885143403, 'auprc': 0.6453316687631934, 'loss_val': 0.9121092596425964, 'psi': 0.6422610606138816}
[S13] not sending this round → trigger blocked (psi=0.695)
[S14] START round=49 head_norm_before_train=1.585527 cos_to_last_merge=0.9946 (last merge round=34)
[S14] round=49 local utility u=0.000000 metrics={'f1_val': 0.9965351641592647, 'auprc': 0.9972624599716697, 'loss_val': 0.03357438857114666, 'psi': 0.9968260824842267}-{'f1_val': 0.9968205796367875, 'auprc': 0.9972363551128678, 'loss_val': 0.03450231107523552, 'psi': 0.9969868898272196}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=49 head_norm_before_train=1.579836 cos_to_last_merge=0.9827 (last merge round=35)
[S15] round=49 local utility u=0.000000 metrics={'f1_val': 0.9854184311509191, 'auprc': 0.9928605433686425, 'loss_val': 0.0538434892836458, 'psi': 0.9883952760380084}-{'f1_val': 0.9967466683875206, 'auprc': 0.9970462531686317, 'loss_val': 0.03768973457961695, 'psi': 0.996866502299965}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=49 head_norm_before_train=1.817999 cos_to_last_merge=0.9874 (last merge round=35)
[S16] round=49 local utility u=0.000000 metrics={'f1_val': 0.9395480633015059, 'auprc': 0.9943586766783585, 'loss_val': 0.2765391944198502, 'psi': 0.9614723086522469}-{'f1_val': 0.9805862102538447, 'auprc': 0.996464210242247, 'loss_val': 0.06850871946212178, 'psi': 0.9869374102492057}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=49 head_norm_before_train=1.567693 cos_to_last_merge=0.9687 (last merge round=30)
[S17] round=49 local utility u=0.000000 metrics={'f1_val': 0.639701375338191, 'auprc': 0.958179768863982, 'loss_val': 0.916332118487086, 'psi': 0.7670927327485074}-{'f1_val': 0.6425793200190408, 'auprc': 0.9642822243282135, 'loss_val': 0.899597741464841, 'psi': 0.7712604817427099}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[runner] rounds complete.
[runner] all agents stopped.
