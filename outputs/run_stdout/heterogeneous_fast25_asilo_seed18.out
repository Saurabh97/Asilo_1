[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:41903
[S3] → join 127.0.0.1:41902
[S4] → join 127.0.0.1:41902
[S5] → join 127.0.0.1:41902
[S6] → join 127.0.0.1:41902
[S7] → join 127.0.0.1:41902
[S8] → join 127.0.0.1:41902
[S9] → join 127.0.0.1:41902
[S10] → join 127.0.0.1:41902
[S11] → join 127.0.0.1:41902
[S13] → join 127.0.0.1:41902
[S14] → join 127.0.0.1:41902
[S15] → join 127.0.0.1:41902
[S16] → join 127.0.0.1:41902
[S17] → join 127.0.0.1:41902
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.138613 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.133540 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.138494 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.142269 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.138295 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.160756 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.178188 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.097206 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.183565 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.148930 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.146060 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.143767 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.116617 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.190652 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.132554 (no previous merge yet)
[S3]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S3] + discovered S8
[S3] + discovered S4
[S3] + discovered S10
[S3] + discovered S5
[S4] + discovered S2
[S4] + discovered S3
[S3] + discovered S7
[S3] + discovered S14
[S3] + discovered S16
[S3] + discovered S11
[S3] + discovered S15
[S3] + discovered S9
[S3] + discovered S13
[S3] + discovered S17
[S3] + discovered S6
[S5] + discovered S2
[S5] + discovered S3
[S5] + discovered S4
[S4] + discovered S7
[S4] + discovered S10
[S4] + discovered S11
[S4] + discovered S16
[S4] + discovered S13
[S4] + discovered S15
[S4] + discovered S9
[S4] + discovered S6
[S4] + discovered S17
[S4] + discovered S8
[S4] + discovered S14
[S4] + discovered S5
[S5] + discovered S13
[S5] + discovered S6
[S5] + discovered S17
[S5] + discovered S15
[S5] + discovered S16
[S5] + discovered S14
[S5] + discovered S10
[S5] + discovered S8
[S5] + discovered S9
[S5] + discovered S11
[S5] + discovered S7
[S6] + discovered S5
[S6] + discovered S4
[S6] + discovered S3
[S6] + discovered S2
[S7] + discovered S2
[S7] + discovered S6
[S7] + discovered S4
[S7] + discovered S3
[S7] + discovered S5
[S6] + discovered S7
[S6] + discovered S9
[S6] + discovered S8
[S6] + discovered S14
[S6] + discovered S15
[S6] + discovered S11
[S6] + discovered S10
[S6] + discovered S13
[S6] + discovered S16
[S6] + discovered S17
[S7] + discovered S15
[S7] + discovered S9
[S7] + discovered S13
[S7] + discovered S17
[S7] + discovered S16
[S7] + discovered S10
[S7] + discovered S11
[S7] + discovered S14
[S7] + discovered S8
[S8] + discovered S2
[S8] + discovered S5
[S8] + discovered S3
[S8] + discovered S4
[S8] + discovered S6
[S8] + discovered S7
[S8] + discovered S15
[S8] + discovered S16
[S8] + discovered S11
[S8] + discovered S14
[S9] + discovered S4
[S9] + discovered S6
[S9] + discovered S8
[S9] + discovered S2
[S9] + discovered S5
[S9] + discovered S3
[S9] + discovered S7
[S8] + discovered S9
[S8] + discovered S13
[S8] + discovered S17
[S8] + discovered S10
[S10] + discovered S5
[S10] + discovered S2
[S10] + discovered S8
[S10] + discovered S6
[S10] + discovered S4
[S10] + discovered S9
[S10] + discovered S7
[S10] + discovered S3
[S9] + discovered S15
[S9] + discovered S10
[S9] + discovered S17
[S9] + discovered S13
[S9] + discovered S14
[S9] + discovered S11
[S9] + discovered S16
[S10] + discovered S16
[S10] + discovered S11
[S10] + discovered S13
[S10] + discovered S17
[S10] + discovered S15
[S10] + discovered S14
[S11] + discovered S8
[S11] + discovered S7
[S11] + discovered S10
[S11] + discovered S6
[S11] + discovered S3
[S11] + discovered S9
[S11] + discovered S4
[S11] + discovered S2
[S11] + discovered S5
[S11] + discovered S17
[S11] + discovered S14
[S11] + discovered S15
[S11] + discovered S13
[S11] + discovered S16
[S13] + discovered S5
[S13] + discovered S4
[S13] + discovered S9
[S13] + discovered S3
[S13] + discovered S6
[S13] + discovered S7
[S13] + discovered S2
[S13] + discovered S8
[S13] + discovered S11
[S13] + discovered S10
[S14] + discovered S13
[S14] + discovered S9
[S14] + discovered S10
[S14] + discovered S8
[S14] + discovered S11
[S14] + discovered S2
[S14] + discovered S6
[S14] + discovered S7
[S14] + discovered S4
[S14] + discovered S3
[S14] + discovered S5
[S13] + discovered S16
[S13] + discovered S15
[S13] + discovered S14
[S13] + discovered S17
[S15] + discovered S3
[S15] + discovered S4
[S15] + discovered S7
[S15] + discovered S6
[S15] + discovered S2
[S15] + discovered S14
[S14] + discovered S17
[S15] + discovered S10
[S15] + discovered S13
[S15] + discovered S5
[S15] + discovered S8
[S15] + discovered S9
[S14] + discovered S16
[S15] + discovered S11
[S14] + discovered S15
[S16] + discovered S2
[S16] + discovered S7
[S16] + discovered S3
[S16] + discovered S15
[S16] + discovered S9
[S16] + discovered S8
[S16] + discovered S11
[S16] + discovered S5
[S16] + discovered S13
[S16] + discovered S10
[S16] + discovered S14
[S16] + discovered S6
[S16] + discovered S4
[S15] + discovered S16
[S15] + discovered S17
[S16] + discovered S17
[S17] + discovered S4
[S17] + discovered S16
[S17] + discovered S14
[S17] + discovered S13
[S17] + discovered S11
[S17] + discovered S8
[S17] + discovered S15
[S17] + discovered S3
[S17] + discovered S6
[S17] + discovered S10
[S17] + discovered S5
[S17] + discovered S9
[S17] + discovered S7
[S17] + discovered S2
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] ⇄ pheromone p=1.000 → S11@127.0.0.1:41912
[S8] ⇄ pheromone p=1.000 → S3@127.0.0.1:41903
[S11] ⇄ pheromone p=1.000 → S16@127.0.0.1:41916
[S4] ⇄ pheromone p=1.000 → S14@127.0.0.1:41914
[S5] ⇄ pheromone p=1.000 → S16@127.0.0.1:41916
[S13] ⇄ pheromone p=1.000 → S2@127.0.0.1:41902
[S2] ⇄ pheromone p=1.000 → S17@127.0.0.1:41917
[S7] ⇄ pheromone p=1.000 → S4@127.0.0.1:41904
[S9] ⇄ pheromone p=1.000 → S16@127.0.0.1:41916
[S3] ⇄ pheromone p=1.000 → S17@127.0.0.1:41917
[S10] ⇄ pheromone p=1.000 → S8@127.0.0.1:41909
[S15] ⇄ pheromone p=1.000 → S13@127.0.0.1:41913
[S6] ⇄ pheromone p=1.000 → S17@127.0.0.1:41917
[S16] ⇄ pheromone p=1.000 → S15@127.0.0.1:41915
[S17] ⇄ pheromone p=1.000 → S14@127.0.0.1:41914
[S2] START round=1 head_norm_before_train=1.151065 (no previous merge yet)
[S2] round=1 local utility u=0.071899 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.5982608071980854, 'loss_val': 1.3127345018931427, 'psi': 0.3243706029123742}-{'f1_val': 0.1417771333885667, 'auprc': 0.5635792053059956, 'loss_val': 1.352487441184628, 'psi': 0.31049796215553827}
[S3] START round=1 head_norm_before_train=1.135864 (no previous merge yet)
[S3] round=1 local utility u=0.363004 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9989248122066152, 'loss_val': 1.307664038753694, 'psi': 0.48347396425111033}-{'f1_val': 0.08969866853538892, 'auprc': 0.8762037506237442, 'loss_val': 1.3646598997867379, 'psi': 0.40430070137073104}
[S4] START round=1 head_norm_before_train=1.129208 (no previous merge yet)
[S4] round=1 local utility u=0.866450 metrics={'f1_val': 0.36066251735404664, 'auprc': 0.7918904973593621, 'loss_val': 1.3464274326533607, 'psi': 0.5331537093561728}-{'f1_val': 0.08833063209076175, 'auprc': 0.7698209683307736, 'loss_val': 1.379128298089317, 'psi': 0.36092676658676653}
[S5] START round=1 head_norm_before_train=1.149155 (no previous merge yet)
[S5] round=1 local utility u=0.233616 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7693571652427562, 'loss_val': 1.2813965809573014, 'psi': 0.39310000895424535}-{'f1_val': 0.14226190476190476, 'auprc': 0.6331751855743757, 'loss_val': 1.3400836354421064, 'psi': 0.33862721708689314}
[S6] START round=1 head_norm_before_train=1.144391 (no previous merge yet)
[S6] round=1 local utility u=0.183160 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.7600143960655791, 'loss_val': 1.317529300917603, 'psi': 0.3888615276570009}-{'f1_val': 0.14142628205128205, 'auprc': 0.6480135473330184, 'loss_val': 1.3478471818273174, 'psi': 0.3440611881639766}
[S7] START round=1 head_norm_before_train=1.179988 (no previous merge yet)
[S7] round=1 local utility u=0.040534 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7867113726067274, 'loss_val': 1.2655637539230706, 'psi': 0.399918642680146}-{'f1_val': 0.14205682272909165, 'auprc': 0.7816089421321396, 'loss_val': 1.3313241007405927, 'psi': 0.39787767049031086}
[S8] START round=1 head_norm_before_train=1.182780 (no previous merge yet)
[S8] round=1 local utility u=0.379927 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7380066344090098, 'loss_val': 1.327909973252702, 'psi': 0.37917624319937826}-{'f1_val': 0.13995598239295717, 'auprc': 0.4950269576297747, 'loss_val': 1.3588250856856063, 'psi': 0.2819843724876842}
[S9] START round=1 head_norm_before_train=1.102850 (no previous merge yet)
[S9] round=1 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9931349855264868, 'loss_val': 1.2580642460805898, 'psi': 0.48209276849459237}-{'f1_val': 0.4163324725221126, 'auprc': 0.992807779428792, 'loss_val': 1.3423958644917384, 'psi': 0.6469225952847844}
[S10] START round=1 head_norm_before_train=1.186037 (no previous merge yet)
[S10] round=1 local utility u=0.035955 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.8167037007771667, 'loss_val': 1.3317699203310598, 'psi': 0.40985446283590105}-{'f1_val': 0.13862163754172394, 'auprc': 0.8022273060411099, 'loss_val': 1.3602504722549316, 'psi': 0.40406390494147837}
[S11] START round=1 head_norm_before_train=1.155505 (no previous merge yet)
[S11] round=1 local utility u=0.909450 metrics={'f1_val': 0.40010509033869807, 'auprc': 0.8194188531121659, 'loss_val': 1.3235748788379358, 'psi': 0.5678305954480852}-{'f1_val': 0.10359570269677702, 'auprc': 0.8178691557143463, 'loss_val': 1.3587698560945192, 'psi': 0.38930508390380475}
[S13] START round=1 head_norm_before_train=1.152452 (no previous merge yet)
[S13] round=1 local utility u=0.235663 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7109106526425238, 'loss_val': 1.307184672418169, 'psi': 0.3685957186032414}-{'f1_val': 0.1403857625770531, 'auprc': 0.56454597096368, 'loss_val': 1.3394157447698092, 'psi': 0.31004984593170387}
[S14] START round=1 head_norm_before_train=1.145835 (no previous merge yet)
[S14] round=1 local utility u=1.000000 metrics={'f1_val': 0.39705221647723304, 'auprc': 0.6167057109643136, 'loss_val': 1.3575587895280998, 'psi': 0.48491361427206525}-{'f1_val': 0.1038107752956636, 'auprc': 0.47121537487779647, 'loss_val': 1.3822044589625178, 'psi': 0.25077261512851673}
[S15] START round=1 head_norm_before_train=1.119664 (no previous merge yet)
[S15] round=1 local utility u=0.142849 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7439874507638438, 'loss_val': 1.3173160783249172, 'psi': 0.3814351711224725}-{'f1_val': 0.13973365136155833, 'auprc': 0.6571122923283794, 'loss_val': 1.3423895826683612, 'psi': 0.34668510774828676}
[S16] START round=1 head_norm_before_train=1.198519 (no previous merge yet)
[S16] round=1 local utility u=0.207607 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7971588343797097, 'loss_val': 1.3268443357473807, 'psi': 0.40324600387140586}-{'f1_val': 0.14063745019920318, 'auprc': 0.6694107524069063, 'loss_val': 1.3588144635965662, 'psi': 0.3521467710822844}
[S17] START round=1 head_norm_before_train=1.136934 (no previous merge yet)
[S17] round=1 local utility u=0.103683 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.7111162496616378, 'loss_val': 1.3330233162501708, 'psi': 0.36901587785508577}-{'f1_val': 0.14094896331738438, 'auprc': 0.6511073754263093, 'loss_val': 1.3603627030900616, 'psi': 0.34501232816095434}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S4] → sending delta(kind=head bytes=1789) to S8@127.0.0.1:41909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S2] → sending delta(kind=head bytes=1791) to S4@127.0.0.1:41904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S3] → sending delta(kind=head bytes=1787) to S2@127.0.0.1:41902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S6] → sending delta(kind=head bytes=1792) to S7@127.0.0.1:41908
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] → sending delta(kind=head bytes=1794) to S6@127.0.0.1:41907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:41911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S13] → sending delta(kind=head bytes=1788) to S16@127.0.0.1:41916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] → sending delta(kind=head bytes=1794) to S10@127.0.0.1:41911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] → sending delta(kind=head bytes=1793) to S2@127.0.0.1:41902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S16] → sending delta(kind=head bytes=1789) to S3@127.0.0.1:41903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S6@127.0.0.1:41907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S7] → sending delta(kind=head bytes=1791) to S2@127.0.0.1:41902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S2@127.0.0.1:41902
[S7] sending update (kind=head size=1791 to 1 peers)
[S16] sending update (kind=head size=1789 to 1 peers)
[S15] sending update (kind=head size=1793 to 1 peers)
[S14] sending update (kind=head size=1794 to 1 peers)
[S13] sending update (kind=head size=1788 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1794 to 1 peers)
[S6] sending update (kind=head size=1792 to 1 peers)
[S8] sending update (kind=head size=1793 to 1 peers)
[S5] sending update (kind=head size=1794 to 1 peers)
[S4] sending update (kind=head size=1789 to 1 peers)
[S3] sending update (kind=head size=1787 to 1 peers)
[S2] sending update (kind=head size=1791 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1793) from S8
[S2] cosine check vs S8: cos=0.0126
[S7] RECEIVED delta(kind=head bytes=1792) from S6
[S7] cosine check vs S6: cos=-0.0063
[S7] DROPPED delta from S6 (cos=-0.0063 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1791) from S7
[S2] cosine check vs S7: cos=0.0055
[S2] RECEIVED delta(kind=head bytes=1793) from S15
[S2] cosine check vs S15: cos=-0.0245
[S2] DROPPED delta from S15 (cos=-0.0245 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1789) from S4
[S8] cosine check vs S4: cos=-0.0084
[S8] DROPPED delta from S4 (cos=-0.0084 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1791) from S2
[S4] cosine check vs S2: cos=0.0667
[S16] RECEIVED delta(kind=head bytes=1788) from S13
[S16] cosine check vs S13: cos=-0.0475
[S16] DROPPED delta from S13 (cos=-0.0475 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1794) from S10
[S6] cosine check vs S10: cos=0.0876
[S2] RECEIVED delta(kind=head bytes=1787) from S3
[S2] cosine check vs S3: cos=-0.0802
[S2] DROPPED delta from S3 (cos=-0.0802 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1789) from S16
[S3] cosine check vs S16: cos=-0.1292
[S3] DROPPED delta from S16 (cos=-0.1292 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1794) from S14
[S10] cosine check vs S14: cos=0.0752
[S6] RECEIVED delta(kind=head bytes=1794) from S5
[S6] cosine check vs S5: cos=0.0152
[S10] RECEIVED delta(kind=head bytes=1796) from S11
[S10] cosine check vs S11: cos=-0.0785
[S10] DROPPED delta from S11 (cos=-0.0785 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S17] → sending delta(kind=head bytes=1792) to S16@127.0.0.1:41916
[S17] sending update (kind=head size=1792 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1792) from S17
[S16] cosine check vs S17: cos=0.0822
[S2] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=1 metric=0.1418 head_norm=1.170122
[S2] _apply_head_vector_avg (torch): Δ‖w‖=7.185237e-01
[S2] stored merged vector for next round verification (round=1)
[S2] DEBUG after merge:  round=1 metric=0.1418 head_norm=0.727314 delta_norm=0.718524
[S2] aggregate: ACCEPT kept=['S8', 'S7'] (k=2/2) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=1 metric=0.1414 head_norm=1.159821
[S6] _apply_head_vector_avg (torch): Δ‖w‖=6.985692e-01
[S6] stored merged vector for next round verification (round=1)
[S6] DEBUG after merge:  round=1 metric=0.1414 head_norm=0.747827 delta_norm=0.698569
[S6] aggregate: ACCEPT kept=['S10', 'S5'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=1 metric=0.1406 head_norm=1.211592
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.000988e-01
[S16] stored merged vector for next round verification (round=1)
[S16] DEBUG after merge:  round=1 metric=0.1406 head_norm=0.868672 delta_norm=0.800099
[S16] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=1 metric=0.1386 head_norm=1.197785
[S10] _apply_head_vector_avg (torch): Δ‖w‖=8.006092e-01
[S10] stored merged vector for next round verification (round=1)
[S10] DEBUG after merge:  round=1 metric=0.3882 head_norm=0.863178 delta_norm=0.800609
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=1 metric=0.3607 head_norm=1.132640
[S4] _apply_head_vector_avg (torch): Δ‖w‖=7.866597e-01
[S4] stored merged vector for next round verification (round=1)
[S4] DEBUG after merge:  round=1 metric=0.3607 head_norm=0.840949 delta_norm=0.786660
[S4] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=0.727314 cos_to_last_merge=1.0000 (last merge round=1)
[S2] round=2 local utility u=0.046597 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6291393627916629, 'loss_val': 1.3121762857651296, 'psi': 0.3367220251498052}-{'f1_val': 0.1417771333885667, 'auprc': 0.5982608071980854, 'loss_val': 1.3127345018931427, 'psi': 0.3243706029123742}
[S3] START round=2 head_norm_before_train=1.168730 (no previous merge yet)
[S3] round=2 local utility u=0.038451 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.994518398307025, 'loss_val': 1.2175431371914582, 'psi': 0.4817113986912742}-{'f1_val': 0.13984006561410703, 'auprc': 0.9989248122066152, 'loss_val': 1.307664038753694, 'psi': 0.48347396425111033}
[S4] START round=2 head_norm_before_train=0.840949 cos_to_last_merge=1.0000 (last merge round=1)
[S4] round=2 local utility u=0.136426 metrics={'f1_val': 0.40857479227553195, 'auprc': 0.7854047019827343, 'loss_val': 1.3415917544585076, 'psi': 0.5593067561584129}-{'f1_val': 0.36066251735404664, 'auprc': 0.7918904973593621, 'loss_val': 1.3464274326533607, 'psi': 0.5331537093561728}
[S5] START round=2 head_norm_before_train=1.177716 (no previous merge yet)
[S5] round=2 local utility u=0.019893 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7599177336297334, 'loss_val': 1.2132924334156763, 'psi': 0.38932423630903623}-{'f1_val': 0.14226190476190476, 'auprc': 0.7693571652427562, 'loss_val': 1.2813965809573014, 'psi': 0.39310000895424535}
[S6] START round=2 head_norm_before_train=0.747827 cos_to_last_merge=1.0000 (last merge round=1)
[S6] round=2 local utility u=0.086766 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8179994781776208, 'loss_val': 1.3179515735179497, 'psi': 0.4120555605018175}-{'f1_val': 0.14142628205128205, 'auprc': 0.7600143960655791, 'loss_val': 1.317529300917603, 'psi': 0.3888615276570009}
[S7] START round=2 head_norm_before_train=1.213346 (no previous merge yet)
[S7] round=2 local utility u=0.015442 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7778246754081151, 'loss_val': 1.208019033334865, 'psi': 0.39636396380070105}-{'f1_val': 0.14205682272909165, 'auprc': 0.7867113726067274, 'loss_val': 1.2655637539230706, 'psi': 0.399918642680146}
[S8] START round=2 head_norm_before_train=1.193761 (no previous merge yet)
[S8] round=2 local utility u=0.027409 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7456629195924561, 'loss_val': 1.296060379807065, 'psi': 0.3822387572727568}-{'f1_val': 0.13995598239295717, 'auprc': 0.7380066344090098, 'loss_val': 1.327909973252702, 'psi': 0.37917624319937826}
[S9] START round=2 head_norm_before_train=1.141071 (no previous merge yet)
[S9] round=2 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.806805650293994, 'loss_val': 1.1572708715745734, 'psi': 0.40756103440159525}-{'f1_val': 0.141397957139996, 'auprc': 0.9931349855264868, 'loss_val': 1.2580642460805898, 'psi': 0.48209276849459237}
[S10] START round=2 head_norm_before_train=0.863178 cos_to_last_merge=1.0000 (last merge round=1)
[S10] round=2 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.8019684182100908, 'loss_val': 1.329049061886429, 'psi': 0.4039603498090707}-{'f1_val': 0.13862163754172394, 'auprc': 0.8167037007771667, 'loss_val': 1.3317699203310598, 'psi': 0.40985446283590105}
[S11] START round=2 head_norm_before_train=1.170065 (no previous merge yet)
[S11] round=2 local utility u=0.000000 metrics={'f1_val': 0.3361149581353247, 'auprc': 0.8174082088902526, 'loss_val': 1.2732890958407797, 'psi': 0.5286322584372959}-{'f1_val': 0.40010509033869807, 'auprc': 0.8194188531121659, 'loss_val': 1.3235748788379358, 'psi': 0.5678305954480852}
[S13] START round=2 head_norm_before_train=1.168617 (no previous merge yet)
[S13] round=2 local utility u=0.023102 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7148182831233354, 'loss_val': 1.272702592006878, 'psi': 0.37015877079556603}-{'f1_val': 0.1403857625770531, 'auprc': 0.7109106526425238, 'loss_val': 1.307184672418169, 'psi': 0.3685957186032414}
[S14] START round=2 head_norm_before_train=1.156467 (no previous merge yet)
[S14] round=2 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8003513486236521, 'loss_val': 1.3300595450108825, 'psi': 0.4043552511790831}-{'f1_val': 0.39705221647723304, 'auprc': 0.6167057109643136, 'loss_val': 1.3575587895280998, 'psi': 0.48491361427206525}
[S15] START round=2 head_norm_before_train=1.132869 (no previous merge yet)
[S15] round=2 local utility u=0.064329 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7762481315544224, 'loss_val': 1.2854409544934515, 'psi': 0.394339443438704}-{'f1_val': 0.13973365136155833, 'auprc': 0.7439874507638438, 'loss_val': 1.3173160783249172, 'psi': 0.3814351711224725}
[S16] START round=2 head_norm_before_train=0.868672 cos_to_last_merge=1.0000 (last merge round=1)
[S16] round=2 local utility u=0.003063 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7961963768275184, 'loss_val': 1.3178312091410398, 'psi': 0.4028610208505293}-{'f1_val': 0.14063745019920318, 'auprc': 0.7971588343797097, 'loss_val': 1.3268443357473807, 'psi': 0.40324600387140586}
[S17] START round=2 head_norm_before_train=1.149583 (no previous merge yet)
[S17] round=2 local utility u=0.155767 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.802013988855461, 'loss_val': 1.2941826676670487, 'psi': 0.4053749735326151}-{'f1_val': 0.14094896331738438, 'auprc': 0.7111162496616378, 'loss_val': 1.3330233162501708, 'psi': 0.36901587785508577}
[S3] not sending this round → trigger blocked (psi=0.482)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.394)
[S2] not sending this round → trigger blocked (psi=0.337)
[S16] not sending this round → trigger blocked (psi=0.403)
[S4] not sending this round → trigger blocked (psi=0.559)
[S6] not sending this round → trigger blocked (psi=0.412)
[S8] not sending this round → trigger blocked (psi=0.382)
[S7] not sending this round → trigger blocked (psi=0.396)
[S5] not sending this round → trigger blocked (psi=0.389)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.370)
[S17] not sending this round → trigger blocked (psi=0.405)
[S2] START round=3 head_norm_before_train=0.749637 cos_to_last_merge=0.9959 (last merge round=1)
[S2] round=3 local utility u=0.267271 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7871717215009015, 'loss_val': 1.2517318580659298, 'psi': 0.3999349686335007}-{'f1_val': 0.1417771333885667, 'auprc': 0.6291393627916629, 'loss_val': 1.3121762857651296, 'psi': 0.3367220251498052}
[S3] START round=3 head_norm_before_train=1.221916 (no previous merge yet)
[S3] round=3 local utility u=0.071849 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9974814169108792, 'loss_val': 1.0827335865884513, 'psi': 0.48289660613281593}-{'f1_val': 0.13984006561410703, 'auprc': 0.994518398307025, 'loss_val': 1.2175431371914582, 'psi': 0.4817113986912742}
[S4] START round=3 head_norm_before_train=0.853421 cos_to_last_merge=0.9963 (last merge round=1)
[S4] round=3 local utility u=0.000000 metrics={'f1_val': 0.14077475962721864, 'auprc': 0.7888981288782664, 'loss_val': 1.3018313342456704, 'psi': 0.40002410732763777}-{'f1_val': 0.40857479227553195, 'auprc': 0.7854047019827343, 'loss_val': 1.3415917544585076, 'psi': 0.5593067561584129}
[S5] START round=3 head_norm_before_train=1.217239 (no previous merge yet)
[S5] round=3 local utility u=0.898873 metrics={'f1_val': 0.4171863612433655, 'auprc': 0.7738342567637702, 'loss_val': 1.106843322092015, 'psi': 0.5598455194515273}-{'f1_val': 0.14226190476190476, 'auprc': 0.7599177336297334, 'loss_val': 1.2132924334156763, 'psi': 0.38932423630903623}
[S6] START round=3 head_norm_before_train=0.770665 cos_to_last_merge=0.9965 (last merge round=1)
[S6] round=3 local utility u=0.084693 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8618307468274748, 'loss_val': 1.280060148885389, 'psi': 0.4295880679617592}-{'f1_val': 0.14142628205128205, 'auprc': 0.8179994781776208, 'loss_val': 1.3179515735179497, 'psi': 0.4120555605018175}
[S7] START round=3 head_norm_before_train=1.242838 (no previous merge yet)
[S7] round=3 local utility u=0.049740 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7773862517241041, 'loss_val': 1.107223098947199, 'psi': 0.3961885943270967}-{'f1_val': 0.14205682272909165, 'auprc': 0.7778246754081151, 'loss_val': 1.208019033334865, 'psi': 0.39636396380070105}
[S8] START round=3 head_norm_before_train=1.212858 (no previous merge yet)
[S8] round=3 local utility u=0.022207 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7470928593232535, 'loss_val': 1.2559358399685663, 'psi': 0.38281073316507574}-{'f1_val': 0.13995598239295717, 'auprc': 0.7456629195924561, 'loss_val': 1.296060379807065, 'psi': 0.3822387572727568}
[S9] START round=3 head_norm_before_train=1.192707 (no previous merge yet)
[S9] round=3 local utility u=0.870090 metrics={'f1_val': 0.4124990808386212, 'auprc': 0.7779243831658482, 'loss_val': 0.9570544917556858, 'psi': 0.5586692017695121}-{'f1_val': 0.141397957139996, 'auprc': 0.806805650293994, 'loss_val': 1.1572708715745734, 'psi': 0.40756103440159525}
[S10] START round=3 head_norm_before_train=0.884430 cos_to_last_merge=0.9972 (last merge round=1)
[S10] round=3 local utility u=0.008477 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7939291523458984, 'loss_val': 1.2879777741608054, 'psi': 0.4007446434633938}-{'f1_val': 0.13862163754172394, 'auprc': 0.8019684182100908, 'loss_val': 1.329049061886429, 'psi': 0.4039603498090707}
[S11] START round=3 head_norm_before_train=1.194597 (no previous merge yet)
[S11] round=3 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.6100499469153395, 'loss_val': 1.1973510566214245, 'psi': 0.3282681887900022}-{'f1_val': 0.3361149581353247, 'auprc': 0.8174082088902526, 'loss_val': 1.2732890958407797, 'psi': 0.5286322584372959}
[S13] START round=3 head_norm_before_train=1.191381 (no previous merge yet)
[S13] round=3 local utility u=0.032188 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7215306256903574, 'loss_val': 1.2284639082326785, 'psi': 0.3728437078223748}-{'f1_val': 0.1403857625770531, 'auprc': 0.7148182831233354, 'loss_val': 1.272702592006878, 'psi': 0.37015877079556603}
[S14] START round=3 head_norm_before_train=1.174817 (no previous merge yet)
[S14] round=3 local utility u=0.027461 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8055079025380967, 'loss_val': 1.2906080891218026, 'psi': 0.40641787274486096}-{'f1_val': 0.14035785288270378, 'auprc': 0.8003513486236521, 'loss_val': 1.3300595450108825, 'psi': 0.4043552511790831}
[S15] START round=3 head_norm_before_train=1.155576 (no previous merge yet)
[S15] round=3 local utility u=0.020396 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7769373462573984, 'loss_val': 1.246716362233363, 'psi': 0.3946151293198944}-{'f1_val': 0.13973365136155833, 'auprc': 0.7762481315544224, 'loss_val': 1.2854409544934515, 'psi': 0.394339443438704}
[S16] START round=3 head_norm_before_train=0.889568 cos_to_last_merge=0.9969 (last merge round=1)
[S16] round=3 local utility u=0.004081 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.785427838576734, 'loss_val': 1.277364156450209, 'psi': 0.3985536055502156}-{'f1_val': 0.14063745019920318, 'auprc': 0.7961963768275184, 'loss_val': 1.3178312091410398, 'psi': 0.4028610208505293}
[S17] START round=3 head_norm_before_train=1.172935 (no previous merge yet)
[S17] round=3 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.6037679712816426, 'loss_val': 1.2371347021505834, 'psi': 0.3260765665030877}-{'f1_val': 0.14094896331738438, 'auprc': 0.802013988855461, 'loss_val': 1.2941826676670487, 'psi': 0.4053749735326151}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:41912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S6] → sending delta(kind=head bytes=1792) to S17@127.0.0.1:41917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S16] → sending delta(kind=head bytes=1791) to S15@127.0.0.1:41915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:41916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S8] → sending delta(kind=head bytes=1792) to S3@127.0.0.1:41903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:41909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:41917
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S9] → sending delta(kind=head bytes=1790) to S16@127.0.0.1:41916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:41917
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S7] → sending delta(kind=head bytes=1791) to S4@127.0.0.1:41904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:41913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:41902
[S15] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1791 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1790 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1792 to 1 peers)
[S16] sending update (kind=head size=1791 to 1 peers)
[S6] sending update (kind=head size=1792 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1798) from S15
[S13] cosine check vs S15: cos=-0.0148
[S13] DROPPED delta from S15 (cos=-0.0148 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1796) from S10
[S8] cosine check vs S10: cos=-0.0017
[S8] DROPPED delta from S10 (cos=-0.0017 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1790) from S9
[S16] cosine check vs S9: cos=0.0144
[S16] RECEIVED delta(kind=head bytes=1796) from S5
[S16] cosine check vs S5: cos=0.0870
[S4] RECEIVED delta(kind=head bytes=1791) from S7
[S4] cosine check vs S7: cos=0.0008
[S17] RECEIVED delta(kind=head bytes=1802) from S3
[S17] cosine check vs S3: cos=0.0628
[S17] RECEIVED delta(kind=head bytes=1800) from S2
[S17] cosine check vs S2: cos=-0.0399
[S17] DROPPED delta from S2 (cos=-0.0399 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1792) from S6
[S17] cosine check vs S6: cos=0.0129
[S3] RECEIVED delta(kind=head bytes=1792) from S8
[S3] cosine check vs S8: cos=-0.1124
[S3] DROPPED delta from S8 (cos=-0.1124 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1791) from S16
[S15] cosine check vs S16: cos=0.0609
[S2] RECEIVED delta(kind=head bytes=1798) from S13
[S2] cosine check vs S13: cos=-0.0128
[S2] DROPPED delta from S13 (cos=-0.0128 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1801) from S14
[S11] cosine check vs S14: cos=-0.0169
[S11] DROPPED delta from S14 (cos=-0.0169 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=3 metric=0.1408 head_norm=0.877761
[S4] _apply_head_vector_avg (torch): Δ‖w‖=7.739661e-01
[S4] stored merged vector for next round verification (round=3)
[S4] DEBUG after merge:  round=3 metric=0.3797 head_norm=0.774510 delta_norm=0.773966
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=3 metric=0.1397 head_norm=1.184323
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.268948e-01
[S15] stored merged vector for next round verification (round=3)
[S15] DEBUG after merge:  round=3 metric=0.1397 head_norm=0.771124 delta_norm=0.726895
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=3 metric=0.1409 head_norm=1.207583
[S17] _apply_head_vector_avg (torch): Δ‖w‖=6.980516e-01
[S17] stored merged vector for next round verification (round=3)
[S17] DEBUG after merge:  round=3 metric=0.1409 head_norm=0.736190 delta_norm=0.698052
[S17] aggregate: ACCEPT kept=['S3', 'S6'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=3 metric=0.1406 head_norm=0.918365
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.060828e-01
[S16] stored merged vector for next round verification (round=3)
[S16] DEBUG after merge:  round=3 metric=0.1406 head_norm=0.652561 delta_norm=0.606083
[S16] aggregate: ACCEPT kept=['S9', 'S5'] (k=2/2) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=0.784693 cos_to_last_merge=0.9833 (last merge round=1)
[S2] round=4 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7307177999158206, 'loss_val': 1.2178973531789552, 'psi': 0.3773533999994683}-{'f1_val': 0.1417771333885667, 'auprc': 0.7871717215009015, 'loss_val': 1.2517318580659298, 'psi': 0.3999349686335007}
[S3] START round=4 head_norm_before_train=1.276603 (no previous merge yet)
[S3] round=4 local utility u=1.000000 metrics={'f1_val': 0.6244555199027217, 'auprc': 0.9929073068349388, 'loss_val': 0.8458435985890839, 'psi': 0.7718362346756086}-{'f1_val': 0.13984006561410703, 'auprc': 0.9974814169108792, 'loss_val': 1.0827335865884513, 'psi': 0.48289660613281593}
[S4] START round=4 head_norm_before_train=0.774510 cos_to_last_merge=1.0000 (last merge round=3)
[S4] round=4 local utility u=0.000000 metrics={'f1_val': 0.14577300514800515, 'auprc': 0.768313653611572, 'loss_val': 1.3055222848044767, 'psi': 0.3947892645334319}-{'f1_val': 0.14077475962721864, 'auprc': 0.7888981288782664, 'loss_val': 1.3018313342456704, 'psi': 0.40002410732763777}
[S5] START round=4 head_norm_before_train=1.257133 (no previous merge yet)
[S5] round=4 local utility u=0.119090 metrics={'f1_val': 0.4189613441527838, 'auprc': 0.77736921666589, 'loss_val': 0.8899179948442123, 'psi': 0.5623244931580262}-{'f1_val': 0.4171863612433655, 'auprc': 0.7738342567637702, 'loss_val': 1.106843322092015, 'psi': 0.5598455194515273}
[S6] START round=4 head_norm_before_train=0.803523 cos_to_last_merge=0.9876 (last merge round=1)
[S6] round=4 local utility u=0.031220 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8641602724040404, 'loss_val': 1.2246084490482583, 'psi': 0.43051987819238535}-{'f1_val': 0.14142628205128205, 'auprc': 0.8618307468274748, 'loss_val': 1.280060148885389, 'psi': 0.4295880679617592}
[S7] START round=4 head_norm_before_train=1.275662 (no previous merge yet)
[S7] round=4 local utility u=0.693218 metrics={'f1_val': 0.4169937999072137, 'auprc': 0.6363116324177562, 'loss_val': 0.9471855861371267, 'psi': 0.5047209329114307}-{'f1_val': 0.14205682272909165, 'auprc': 0.7773862517241041, 'loss_val': 1.107223098947199, 'psi': 0.3961885943270967}
[S8] START round=4 head_norm_before_train=1.240311 (no previous merge yet)
[S8] round=4 local utility u=0.057128 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7683414084421455, 'loss_val': 1.2054264558411352, 'psi': 0.39131015281263254}-{'f1_val': 0.13995598239295717, 'auprc': 0.7470928593232535, 'loss_val': 1.2559358399685663, 'psi': 0.38281073316507574}
[S9] START round=4 head_norm_before_train=1.250461 (no previous merge yet)
[S9] round=4 local utility u=0.674299 metrics={'f1_val': 0.48550428975400306, 'auprc': 0.9773877034482358, 'loss_val': 0.644877491985777, 'psi': 0.6822576552316961}-{'f1_val': 0.4124990808386212, 'auprc': 0.7779243831658482, 'loss_val': 0.9570544917556858, 'psi': 0.5586692017695121}
[S10] START round=4 head_norm_before_train=0.916627 cos_to_last_merge=0.9899 (last merge round=1)
[S10] round=4 local utility u=0.004748 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7771898044089018, 'loss_val': 1.2282629350888015, 'psi': 0.3940489042885951}-{'f1_val': 0.13862163754172394, 'auprc': 0.7939291523458984, 'loss_val': 1.2879777741608054, 'psi': 0.4007446434633938}
[S11] START round=4 head_norm_before_train=1.227664 (no previous merge yet)
[S11] round=4 local utility u=0.019436 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.5984954801380993, 'loss_val': 1.123815434773363, 'psi': 0.32364640207910605}-{'f1_val': 0.14041368337311058, 'auprc': 0.6100499469153395, 'loss_val': 1.1973510566214245, 'psi': 0.3282681887900022}
[S13] START round=4 head_norm_before_train=1.219489 (no previous merge yet)
[S13] round=4 local utility u=0.034573 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7213740739084767, 'loss_val': 1.1588479616994616, 'psi': 0.37278108710962254}-{'f1_val': 0.1403857625770531, 'auprc': 0.7215306256903574, 'loss_val': 1.2284639082326785, 'psi': 0.3728437078223748}
[S14] START round=4 head_norm_before_train=1.203520 (no previous merge yet)
[S14] round=4 local utility u=0.005714 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7946806552927036, 'loss_val': 1.2466982262799402, 'psi': 0.4020869738467037}-{'f1_val': 0.14035785288270378, 'auprc': 0.8055079025380967, 'loss_val': 1.2906080891218026, 'psi': 0.40641787274486096}
[S15] START round=4 head_norm_before_train=0.771124 cos_to_last_merge=1.0000 (last merge round=3)
[S15] round=4 local utility u=0.000000 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7768194659642178, 'loss_val': 1.2542932329726628, 'psi': 0.39456797720262216}-{'f1_val': 0.13973365136155833, 'auprc': 0.7769373462573984, 'loss_val': 1.246716362233363, 'psi': 0.3946151293198944}
[S16] START round=4 head_norm_before_train=0.652561 cos_to_last_merge=1.0000 (last merge round=3)
[S16] round=4 local utility u=0.046414 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8142763165576484, 'loss_val': 1.2710818701956372, 'psi': 0.41009299674258126}-{'f1_val': 0.14063745019920318, 'auprc': 0.785427838576734, 'loss_val': 1.277364156450209, 'psi': 0.3985536055502156}
[S17] START round=4 head_norm_before_train=0.736190 cos_to_last_merge=1.0000 (last merge round=3)
[S17] round=4 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5527509438923349, 'loss_val': 1.215816974214346, 'psi': 0.30566975554736464}-{'f1_val': 0.14094896331738438, 'auprc': 0.6037679712816426, 'loss_val': 1.2371347021505834, 'psi': 0.3260765665030877}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:41916
[S5] sending update (kind=head size=1799 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1799) from S5
[S16] cosine check vs S5: cos=0.5052
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S7] → sending delta(kind=head bytes=1793) to S4@127.0.0.1:41904
[S7] sending update (kind=head size=1793 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1793) from S7
[S4] cosine check vs S7: cos=0.7990
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:41903
[S8] sending update (kind=head size=1797 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1797) from S8
[S3] cosine check vs S8: cos=-0.1067
[S3] DROPPED delta from S8 (cos=-0.1067 < 0.0)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:41917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:41916
[S3] sending update (kind=head size=1800 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1800) from S3
[S17] cosine check vs S3: cos=0.4830
[S9] sending update (kind=head size=1799 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1799) from S9
[S16] cosine check vs S9: cos=0.4222
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:41902
[S13] sending update (kind=head size=1800 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1800) from S13
[S2] cosine check vs S13: cos=-0.0206
[S2] DROPPED delta from S13 (cos=-0.0206 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S6] → sending delta(kind=head bytes=1792) to S17@127.0.0.1:41917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] → sending delta(kind=head bytes=1805) to S8@127.0.0.1:41909
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:41912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:41916
[S6] sending update (kind=head size=1792 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] RECEIVED delta(kind=head bytes=1792) from S6
[S17] cosine check vs S6: cos=0.2903
[S11] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1805 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1805) from S10
[S8] cosine check vs S10: cos=-0.0063
[S8] DROPPED delta from S10 (cos=-0.0063 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1802) from S11
[S16] cosine check vs S11: cos=-0.0851
[S16] DROPPED delta from S11 (cos=-0.0851 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1796) from S14
[S11] cosine check vs S14: cos=-0.0201
[S11] DROPPED delta from S14 (cos=-0.0201 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:41915
[S16] sending update (kind=head size=1795 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1795) from S16
[S15] cosine check vs S16: cos=0.4997
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=4 metric=0.1397 head_norm=0.802520
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.748825e-01
[S15] stored merged vector for next round verification (round=4)
[S15] DEBUG after merge:  round=4 metric=0.1397 head_norm=0.643430 delta_norm=0.374882
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=4 metric=0.1458 head_norm=0.793162
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.182255e-01
[S4] stored merged vector for next round verification (round=4)
[S4] DEBUG after merge:  round=4 metric=0.3775 head_norm=1.005994 delta_norm=0.418226
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=4 metric=0.1409 head_norm=0.773589
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.778424e-01
[S17] stored merged vector for next round verification (round=4)
[S17] DEBUG after merge:  round=4 metric=0.1409 head_norm=0.699561 delta_norm=0.377842
[S17] aggregate: ACCEPT kept=['S3', 'S6'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=4 metric=0.1406 head_norm=0.681939
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.364136e-01
[S16] stored merged vector for next round verification (round=4)
[S16] DEBUG after merge:  round=4 metric=0.1406 head_norm=0.727493 delta_norm=0.336414
[S16] aggregate: ACCEPT kept=['S5', 'S9'] (k=2/2) mode=median trim_p=0.1
[S2] START round=5 head_norm_before_train=0.824985 cos_to_last_merge=0.9668 (last merge round=1)
[S2] round=5 local utility u=0.058429 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7540324548215809, 'loss_val': 1.1709833523082158, 'psi': 0.38667926196177244}-{'f1_val': 0.1417771333885667, 'auprc': 0.7307177999158206, 'loss_val': 1.2178973531789552, 'psi': 0.3773533999994683}
[S3] START round=5 head_norm_before_train=1.348604 (no previous merge yet)
[S3] round=5 local utility u=0.058709 metrics={'f1_val': 0.6087499643160967, 'auprc': 0.9924482883795345, 'loss_val': 0.6328153390029554, 'psi': 0.7622292939414719}-{'f1_val': 0.6244555199027217, 'auprc': 0.9929073068349388, 'loss_val': 0.8458435985890839, 'psi': 0.7718362346756086}
[S4] START round=5 head_norm_before_train=1.005994 cos_to_last_merge=1.0000 (last merge round=4)
[S4] round=5 local utility u=0.140889 metrics={'f1_val': 0.18959508272485373, 'auprc': 0.7645039891559482, 'loss_val': 1.2752471235744727, 'psi': 0.41955864529729153}-{'f1_val': 0.14577300514800515, 'auprc': 0.768313653611572, 'loss_val': 1.3055222848044767, 'psi': 0.3947892645334319}
[S5] START round=5 head_norm_before_train=1.299762 (no previous merge yet)
[S5] round=5 local utility u=1.000000 metrics={'f1_val': 0.714986591715879, 'auprc': 0.7949961940245445, 'loss_val': 0.6786759108405988, 'psi': 0.7469904326393452}-{'f1_val': 0.4189613441527838, 'auprc': 0.77736921666589, 'loss_val': 0.8899179948442123, 'psi': 0.5623244931580262}
[S6] START round=5 head_norm_before_train=0.843211 cos_to_last_merge=0.9751 (last merge round=1)
[S6] round=5 local utility u=0.012887 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.847356541185347, 'loss_val': 1.1484227857136702, 'psi': 0.423798385704908}-{'f1_val': 0.14142628205128205, 'auprc': 0.8641602724040404, 'loss_val': 1.2246084490482583, 'psi': 0.43051987819238535}
[S7] START round=5 head_norm_before_train=1.320897 (no previous merge yet)
[S7] round=5 local utility u=0.300153 metrics={'f1_val': 0.41679099637737954, 'auprc': 0.7940767889131408, 'loss_val': 0.8189583737538342, 'psi': 0.5677053133916841}-{'f1_val': 0.4169937999072137, 'auprc': 0.6363116324177562, 'loss_val': 0.9471855861371267, 'psi': 0.5047209329114307}
[S8] START round=5 head_norm_before_train=1.272950 (no previous merge yet)
[S8] round=5 local utility u=0.057379 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7821229276991253, 'loss_val': 1.1320134322369169, 'psi': 0.3968227605154245}-{'f1_val': 0.13995598239295717, 'auprc': 0.7683414084421455, 'loss_val': 1.2054264558411352, 'psi': 0.39131015281263254}
[S9] START round=5 head_norm_before_train=1.335072 (no previous merge yet)
[S9] round=5 local utility u=0.827008 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9995790065541486, 'loss_val': 0.3521523358503686, 'psi': 0.8206058927461974}-{'f1_val': 0.48550428975400306, 'auprc': 0.9773877034482358, 'loss_val': 0.644877491985777, 'psi': 0.6822576552316961}
[S10] START round=5 head_norm_before_train=0.959263 cos_to_last_merge=0.9792 (last merge round=1)
[S10] round=5 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7335922907494494, 'loss_val': 1.1713055067926585, 'psi': 0.37660989882481416}-{'f1_val': 0.13862163754172394, 'auprc': 0.7771898044089018, 'loss_val': 1.2282629350888015, 'psi': 0.3940489042885951}
[S11] START round=5 head_norm_before_train=1.263405 (no previous merge yet)
[S11] round=5 local utility u=1.000000 metrics={'f1_val': 0.4225625868721864, 'auprc': 0.7428788810550321, 'loss_val': 1.0004754593940794, 'psi': 0.5506891045453246}-{'f1_val': 0.14041368337311058, 'auprc': 0.5984954801380993, 'loss_val': 1.123815434773363, 'psi': 0.32364640207910605}
[S13] START round=5 head_norm_before_train=1.255843 (no previous merge yet)
[S13] round=5 local utility u=0.898407 metrics={'f1_val': 0.41655034241240063, 'auprc': 0.7311433879739093, 'loss_val': 1.0483301306940798, 'psi': 0.5423875606370041}-{'f1_val': 0.1403857625770531, 'auprc': 0.7213740739084767, 'loss_val': 1.1588479616994616, 'psi': 0.37278108710962254}
[S14] START round=5 head_norm_before_train=1.239217 (no previous merge yet)
[S14] round=5 local utility u=0.077292 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8291160178036867, 'loss_val': 1.195420344953719, 'psi': 0.41586111885109694}-{'f1_val': 0.14035785288270378, 'auprc': 0.7946806552927036, 'loss_val': 1.2466982262799402, 'psi': 0.4020869738467037}
[S15] START round=5 head_norm_before_train=0.643430 cos_to_last_merge=1.0000 (last merge round=4)
[S15] round=5 local utility u=0.000000 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7706834992311887, 'loss_val': 1.2404702557833411, 'psi': 0.3921135905094105}-{'f1_val': 0.13973365136155833, 'auprc': 0.7768194659642178, 'loss_val': 1.2542932329726628, 'psi': 0.39456797720262216}
[S16] START round=5 head_norm_before_train=0.727493 cos_to_last_merge=1.0000 (last merge round=4)
[S16] round=5 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7880390869049804, 'loss_val': 1.2436147341317207, 'psi': 0.39959810488151404}-{'f1_val': 0.14063745019920318, 'auprc': 0.8142763165576484, 'loss_val': 1.2710818701956372, 'psi': 0.41009299674258126}
[S17] START round=5 head_norm_before_train=0.699561 cos_to_last_merge=1.0000 (last merge round=4)
[S17] round=5 local utility u=0.017742 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.549786877393478, 'loss_val': 1.1714398383260411, 'psi': 0.30448412894782184}-{'f1_val': 0.14094896331738438, 'auprc': 0.5527509438923349, 'loss_val': 1.215816974214346, 'psi': 0.30566975554736464}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:41917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:41916
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S13] → sending delta(kind=head bytes=1792) to S2@127.0.0.1:41902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:41916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:41903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:41904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S4] → sending delta(kind=head bytes=1792) to S14@127.0.0.1:41914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:41917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:41912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:41916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:41917
[S2] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1803 to 1 peers)
[S4] sending update (kind=head size=1792 to 1 peers)
[S7] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S13] sending update (kind=head size=1792 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1803) from S11
[S16] cosine check vs S11: cos=-0.0807
[S16] DROPPED delta from S11 (cos=-0.0807 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1795) from S7
[S4] cosine check vs S7: cos=0.9534
[S14] RECEIVED delta(kind=head bytes=1792) from S4
[S14] cosine check vs S4: cos=-0.0474
[S14] DROPPED delta from S4 (cos=-0.0474 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1800) from S2
[S17] cosine check vs S2: cos=-0.1477
[S17] DROPPED delta from S2 (cos=-0.1477 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1803) from S3
[S17] cosine check vs S3: cos=0.7370
[S11] RECEIVED delta(kind=head bytes=1800) from S14
[S11] cosine check vs S14: cos=-0.0224
[S11] DROPPED delta from S14 (cos=-0.0224 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1798) from S6
[S17] cosine check vs S6: cos=0.4575
[S3] RECEIVED delta(kind=head bytes=1795) from S8
[S3] cosine check vs S8: cos=-0.1011
[S3] DROPPED delta from S8 (cos=-0.1011 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1792) from S13
[S2] cosine check vs S13: cos=-0.0284
[S2] DROPPED delta from S13 (cos=-0.0284 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] → sending delta(kind=head bytes=1793) to S14@127.0.0.1:41914
[S17] sending update (kind=head size=1793 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1793) from S17
[S14] cosine check vs S17: cos=0.0860
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1802) from S9
[S16] cosine check vs S9: cos=0.5948
[S16] RECEIVED delta(kind=head bytes=1799) from S5
[S16] cosine check vs S5: cos=0.6479
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=5 metric=0.1896 head_norm=1.019003
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.498451e-01
[S4] stored merged vector for next round verification (round=5)
[S4] DEBUG after merge:  round=5 metric=0.3688 head_norm=1.178494 delta_norm=0.249845
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.441 → S14@127.0.0.1:41914
[S3] ⇄ pheromone p=0.542 → S17@127.0.0.1:41917
[S6] ⇄ pheromone p=0.370 → S17@127.0.0.1:41917
[S2] ⇄ pheromone p=0.384 → S17@127.0.0.1:41917
[S7] ⇄ pheromone p=0.510 → S4@127.0.0.1:41904
[S11] ⇄ pheromone p=0.605 → S16@127.0.0.1:41916
[S8] ⇄ pheromone p=0.385 → S3@127.0.0.1:41903
[S15] ⇄ pheromone p=0.349 → S13@127.0.0.1:41913
[S10] ⇄ pheromone p=0.332 → S8@127.0.0.1:41909
[S13] ⇄ pheromone p=0.539 → S2@127.0.0.1:41902
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=5 metric=0.1404 head_norm=1.267822
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.041199e-01
[S14] stored merged vector for next round verification (round=5)
[S14] DEBUG after merge:  round=5 metric=0.1404 head_norm=0.758646 delta_norm=0.704120
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.429 → S11@127.0.0.1:41912
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=5 metric=0.1406 head_norm=0.750641
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.164385e-01
[S16] stored merged vector for next round verification (round=5)
[S16] DEBUG after merge:  round=5 metric=0.1039 head_norm=0.836176 delta_norm=0.216439
[S16] aggregate: ROLLBACK (f1_val pre=0.141 post=0.104 tol_abs=0.005 tol_rel=0.0)
[S16] ⇄ pheromone p=0.353 → S15@127.0.0.1:41915
[S9] ⇄ pheromone p=0.712 → S16@127.0.0.1:41916
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=5 metric=0.1409 head_norm=0.731632
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.274103e-01
[S17] stored merged vector for next round verification (round=5)
[S17] DEBUG after merge:  round=5 metric=0.2611 head_norm=0.765833 delta_norm=0.227410
[S17] aggregate: ACCEPT kept=['S3', 'S6'] (k=2/2) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.356 → S14@127.0.0.1:41914
[S5] ⇄ pheromone p=0.683 → S16@127.0.0.1:41916
[S2] START round=6 head_norm_before_train=0.850248 cos_to_last_merge=0.9561 (last merge round=1)
[S2] round=6 local utility u=0.882198 metrics={'f1_val': 0.4158821818019893, 'auprc': 0.7765603735166859, 'loss_val': 1.1188022271534492, 'psi': 0.560153458487868}-{'f1_val': 0.1417771333885667, 'auprc': 0.7540324548215809, 'loss_val': 1.1709833523082158, 'psi': 0.38667926196177244}
[S3] START round=6 head_norm_before_train=1.433952 (no previous merge yet)
[S3] round=6 local utility u=0.392224 metrics={'f1_val': 0.7003264167718803, 'auprc': 0.9882622680472796, 'loss_val': 0.3852687353647049, 'psi': 0.8155007572820401}-{'f1_val': 0.6087499643160967, 'auprc': 0.9924482883795345, 'loss_val': 0.6328153390029554, 'psi': 0.7622292939414719}
[S4] START round=6 head_norm_before_train=1.178494 cos_to_last_merge=1.0000 (last merge round=5)
[S4] round=6 local utility u=0.000000 metrics={'f1_val': 0.1483098868023294, 'auprc': 0.7630510421088985, 'loss_val': 1.2038801260519114, 'psi': 0.3942063489249571}-{'f1_val': 0.18959508272485373, 'auprc': 0.7645039891559482, 'loss_val': 1.2752471235744727, 'psi': 0.41955864529729153}
[S5] START round=6 head_norm_before_train=1.361566 (no previous merge yet)
[S5] round=6 local utility u=0.059352 metrics={'f1_val': 0.7146275168069246, 'auprc': 0.793286549667531, 'loss_val': 0.5526885739783644, 'psi': 0.7460911299511672}-{'f1_val': 0.714986591715879, 'auprc': 0.7949961940245445, 'loss_val': 0.6786759108405988, 'psi': 0.7469904326393452}
[S6] START round=6 head_norm_before_train=0.885365 cos_to_last_merge=0.9618 (last merge round=1)
[S6] round=6 local utility u=1.000000 metrics={'f1_val': 0.41705570454086727, 'auprc': 0.9643439654464092, 'loss_val': 0.9927548621167177, 'psi': 0.6359710089030841}-{'f1_val': 0.14142628205128205, 'auprc': 0.847356541185347, 'loss_val': 1.1484227857136702, 'psi': 0.423798385704908}
[S7] START round=6 head_norm_before_train=1.365348 (no previous merge yet)
[S7] round=6 local utility u=0.157587 metrics={'f1_val': 0.41679099637737954, 'auprc': 0.8785019803584366, 'loss_val': 0.7570590294021782, 'psi': 0.6014753899698024}-{'f1_val': 0.41679099637737954, 'auprc': 0.7940767889131408, 'loss_val': 0.8189583737538342, 'psi': 0.5677053133916841}
[S8] START round=6 head_norm_before_train=1.305729 (no previous merge yet)
[S8] round=6 local utility u=1.000000 metrics={'f1_val': 0.7143464652376063, 'auprc': 0.7946325485091332, 'loss_val': 1.0028692103751873, 'psi': 0.7464608985462171}-{'f1_val': 0.13995598239295717, 'auprc': 0.7821229276991253, 'loss_val': 1.1320134322369169, 'psi': 0.3968227605154245}
[S9] START round=6 head_norm_before_train=1.439073 (no previous merge yet)
[S9] round=6 local utility u=0.065408 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9994459133461817, 'loss_val': 0.22049354218671405, 'psi': 0.8205083138024838}-{'f1_val': 0.7012904835408967, 'auprc': 0.9995790065541486, 'loss_val': 0.3521523358503686, 'psi': 0.8206058927461974}
[S10] START round=6 head_norm_before_train=0.996682 cos_to_last_merge=0.9700 (last merge round=1)
[S10] round=6 local utility u=0.566057 metrics={'f1_val': 0.3393470275723992, 'auprc': 0.6785167025266335, 'loss_val': 1.0783172393316744, 'psi': 0.47501489755409293}-{'f1_val': 0.13862163754172394, 'auprc': 0.7335922907494494, 'loss_val': 1.1713055067926585, 'psi': 0.37660989882481416}
[S11] START round=6 head_norm_before_train=1.293183 (no previous merge yet)
[S11] round=6 local utility u=0.412204 metrics={'f1_val': 0.4148404227119303, 'auprc': 0.9852693963244794, 'loss_val': 0.8569052633054824, 'psi': 0.6430120121569499}-{'f1_val': 0.4225625868721864, 'auprc': 0.7428788810550321, 'loss_val': 1.0004754593940794, 'psi': 0.5506891045453246}
[S13] START round=6 head_norm_before_train=1.295417 (no previous merge yet)
[S13] round=6 local utility u=0.000000 metrics={'f1_val': 0.37189073220722907, 'auprc': 0.742951873626743, 'loss_val': 0.9283486170391053, 'psi': 0.5203151887750347}-{'f1_val': 0.41655034241240063, 'auprc': 0.7311433879739093, 'loss_val': 1.0483301306940798, 'psi': 0.5423875606370041}
[S14] START round=6 head_norm_before_train=0.758646 cos_to_last_merge=1.0000 (last merge round=5)
[S14] round=6 local utility u=0.015339 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8353238913220209, 'loss_val': 1.183365266825588, 'psi': 0.41834426825843063}-{'f1_val': 0.14035785288270378, 'auprc': 0.8291160178036867, 'loss_val': 1.195420344953719, 'psi': 0.41586111885109694}
[S15] START round=6 head_norm_before_train=0.672663 cos_to_last_merge=0.9936 (last merge round=4)
[S15] round=6 local utility u=0.053138 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.77680619494028, 'loss_val': 1.1525618462985254, 'psi': 0.394562668793047}-{'f1_val': 0.13973365136155833, 'auprc': 0.7706834992311887, 'loss_val': 1.2404702557833411, 'psi': 0.3921135905094105}
[S16] START round=6 head_norm_before_train=0.836176 cos_to_last_merge=1.0000 (last merge round=5)
[S16] round=6 local utility u=0.000000 metrics={'f1_val': 0.17176658261430416, 'auprc': 0.6040745481851032, 'loss_val': 1.1716084552739163, 'psi': 0.3446897688426238}-{'f1_val': 0.14063745019920318, 'auprc': 0.7880390869049804, 'loss_val': 1.2436147341317207, 'psi': 0.39959810488151404}
[S17] START round=6 head_norm_before_train=0.765833 cos_to_last_merge=1.0000 (last merge round=5)
[S17] round=6 local utility u=0.826718 metrics={'f1_val': 0.38822706624119907, 'auprc': 0.5832509778292999, 'loss_val': 1.102065198601913, 'psi': 0.4662366308764394}-{'f1_val': 0.14094896331738438, 'auprc': 0.549786877393478, 'loss_val': 1.1714398383260411, 'psi': 0.30448412894782184}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:41917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:41916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:41917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:41903
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:41917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:41904
[S3] sending update (kind=head size=1803 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1795 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1797) from S2
[S17] cosine check vs S2: cos=-0.1535
[S17] DROPPED delta from S2 (cos=-0.1535 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1802) from S9
[S16] cosine check vs S9: cos=0.6487
[S4] RECEIVED delta(kind=head bytes=1797) from S7
[S4] cosine check vs S7: cos=0.9768
[S17] RECEIVED delta(kind=head bytes=1803) from S3
[S17] cosine check vs S3: cos=0.8084
[S17] RECEIVED delta(kind=head bytes=1795) from S6
[S17] cosine check vs S6: cos=0.4952
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:41916
[S11] sending update (kind=head size=1798 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1798) from S11
[S16] cosine check vs S11: cos=-0.0782
[S16] DROPPED delta from S11 (cos=-0.0782 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:41909
[S10] sending update (kind=head size=1802 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1802) from S10
[S8] cosine check vs S10: cos=-0.0120
[S8] DROPPED delta from S10 (cos=-0.0120 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:41913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:41912
[S15] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1802) from S15
[S13] cosine check vs S15: cos=-0.0254
[S13] DROPPED delta from S15 (cos=-0.0254 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1798) from S14
[S11] cosine check vs S14: cos=-0.0705
[S11] DROPPED delta from S14 (cos=-0.0705 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1800) from S8
[S3] cosine check vs S8: cos=-0.0987
[S3] DROPPED delta from S8 (cos=-0.0987 < 0.0)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:41916
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1796 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1796) from S5
[S16] cosine check vs S5: cos=0.6705
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:41914
[S17] sending update (kind=head size=1796 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1796) from S17
[S14] cosine check vs S17: cos=0.5443
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=6 metric=0.1483 head_norm=1.193988
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.797198e-01
[S4] stored merged vector for next round verification (round=6)
[S4] DEBUG after merge:  round=6 metric=0.3785 head_norm=1.298821 delta_norm=0.179720
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=6 metric=0.1718 head_norm=0.855858
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.635657e-01
[S16] stored merged vector for next round verification (round=6)
[S16] DEBUG after merge:  round=6 metric=0.2598 head_norm=0.925221 delta_norm=0.163566
[S16] aggregate: ACCEPT kept=['S9', 'S5'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=6 metric=0.1404 head_norm=0.794175
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.791869e-01
[S14] stored merged vector for next round verification (round=6)
[S14] DEBUG after merge:  round=6 metric=0.1404 head_norm=0.698006 delta_norm=0.379187
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=6 metric=0.3882 head_norm=0.794530
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.640481e-01
[S17] stored merged vector for next round verification (round=6)
[S17] DEBUG after merge:  round=6 metric=0.3893 head_norm=0.834638 delta_norm=0.164048
[S17] aggregate: ACCEPT kept=['S3', 'S6'] (k=2/2) mode=median trim_p=0.1
[S2] START round=7 head_norm_before_train=0.872152 cos_to_last_merge=0.9471 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.947
[S2] round=7 local utility u=0.044326 metrics={'f1_val': 0.41668780995073934, 'auprc': 0.7774722831528424, 'loss_val': 1.0377190115342976, 'psi': 0.5610015992315805}-{'f1_val': 0.4158821818019893, 'auprc': 0.7765603735166859, 'loss_val': 1.1188022271534492, 'psi': 0.560153458487868}
[S3] START round=7 head_norm_before_train=1.518071 (no previous merge yet)
[S3] round=7 local utility u=0.000000 metrics={'f1_val': 0.6829457812837256, 'auprc': 0.9977591254938094, 'loss_val': 0.3984062891657678, 'psi': 0.8088711189677591}-{'f1_val': 0.7003264167718803, 'auprc': 0.9882622680472796, 'loss_val': 0.3852687353647049, 'psi': 0.8155007572820401}
[S4] START round=7 head_norm_before_train=1.298821 cos_to_last_merge=1.0000 (last merge round=6)
[S4] round=7 local utility u=0.840162 metrics={'f1_val': 0.4101018609079016, 'auprc': 0.7637532783306191, 'loss_val': 1.0964138789314057, 'psi': 0.5515624278769886}-{'f1_val': 0.1483098868023294, 'auprc': 0.7630510421088985, 'loss_val': 1.2038801260519114, 'psi': 0.3942063489249571}
[S5] START round=7 head_norm_before_train=1.412409 (no previous merge yet)
[S5] round=7 local utility u=0.000000 metrics={'f1_val': 0.7005685100046517, 'auprc': 0.7247222525048136, 'loss_val': 0.45541404625336895, 'psi': 0.7102300070047165}-{'f1_val': 0.7146275168069246, 'auprc': 0.793286549667531, 'loss_val': 0.5526885739783644, 'psi': 0.7460911299511672}
[S6] START round=7 head_norm_before_train=0.926198 cos_to_last_merge=0.9512 (last merge round=1)
[S6] round=7 local utility u=0.013657 metrics={'f1_val': 0.41705570454086727, 'auprc': 0.9339345584194356, 'loss_val': 0.8742135390610534, 'psi': 0.6238072460922947}-{'f1_val': 0.41705570454086727, 'auprc': 0.9643439654464092, 'loss_val': 0.9927548621167177, 'psi': 0.6359710089030841}
[S7] START round=7 head_norm_before_train=1.418755 (no previous merge yet)
[S7] round=7 local utility u=0.757526 metrics={'f1_val': 0.7138409291285264, 'auprc': 0.7883612558066332, 'loss_val': 0.7538850331712966, 'psi': 0.7436490597997691}-{'f1_val': 0.41679099637737954, 'auprc': 0.8785019803584366, 'loss_val': 0.7570590294021782, 'psi': 0.6014753899698024}
[S8] START round=7 head_norm_before_train=1.336634 (no previous merge yet)
[S8] round=7 local utility u=0.118255 metrics={'f1_val': 0.7147473519913303, 'auprc': 0.7944910175833504, 'loss_val': 0.7683406052488176, 'psi': 0.7466448182281383}-{'f1_val': 0.7143464652376063, 'auprc': 0.7946325485091332, 'loss_val': 1.0028692103751873, 'psi': 0.7464608985462171}
[S9] START round=7 head_norm_before_train=1.527586 (no previous merge yet)
[S9] round=7 local utility u=0.901967 metrics={'f1_val': 0.9907913321404518, 'auprc': 0.9996197240537362, 'loss_val': 0.15453014200469822, 'psi': 0.9943226889057656}-{'f1_val': 0.7012165807733519, 'auprc': 0.9994459133461817, 'loss_val': 0.22049354218671405, 'psi': 0.8205083138024838}
[S10] START round=7 head_norm_before_train=1.032409 cos_to_last_merge=0.9615 (last merge round=1)
[S10] round=7 local utility u=0.293487 metrics={'f1_val': 0.41678903473405027, 'auprc': 0.6664337213279872, 'loss_val': 0.9197455474214238, 'psi': 0.516646909371625}-{'f1_val': 0.3393470275723992, 'auprc': 0.6785167025266335, 'loss_val': 1.0783172393316744, 'psi': 0.47501489755409293}
[S11] START round=7 head_norm_before_train=1.331551 (no previous merge yet)
[S11] round=7 local utility u=0.028006 metrics={'f1_val': 0.39681973109600455, 'auprc': 0.9981524125263443, 'loss_val': 0.7314187885438281, 'psi': 0.6373528036681405}-{'f1_val': 0.4148404227119303, 'auprc': 0.9852693963244794, 'loss_val': 0.8569052633054824, 'psi': 0.6430120121569499}
[S13] START round=7 head_norm_before_train=1.332907 (no previous merge yet)
[S13] round=7 local utility u=0.067382 metrics={'f1_val': 0.37520197054665977, 'auprc': 0.7442963037758965, 'loss_val': 0.817484927179683, 'psi': 0.5228397038383544}-{'f1_val': 0.37189073220722907, 'auprc': 0.742951873626743, 'loss_val': 0.9283486170391053, 'psi': 0.5203151887750347}
[S14] START round=7 head_norm_before_train=0.698006 cos_to_last_merge=1.0000 (last merge round=6)
[S14] round=7 local utility u=0.003531 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8213606254483645, 'loss_val': 1.1344127551326308, 'psi': 0.4127589619089681}-{'f1_val': 0.14035785288270378, 'auprc': 0.8353238913220209, 'loss_val': 1.183365266825588, 'psi': 0.41834426825843063}
[S15] START round=7 head_norm_before_train=0.710846 cos_to_last_merge=0.9768 (last merge round=4)
[S15] round=7 local utility u=0.915102 metrics={'f1_val': 0.4163758395072774, 'auprc': 0.7997156006888331, 'loss_val': 1.050939808125174, 'psi': 0.5697117439798997}-{'f1_val': 0.13973365136155833, 'auprc': 0.77680619494028, 'loss_val': 1.1525618462985254, 'psi': 0.394562668793047}
[S16] START round=7 head_norm_before_train=0.925221 cos_to_last_merge=1.0000 (last merge round=6)
[S16] round=7 local utility u=0.696277 metrics={'f1_val': 0.41719231679200464, 'auprc': 0.5427915002595777, 'loss_val': 1.067759063895231, 'psi': 0.4674319901790338}-{'f1_val': 0.17176658261430416, 'auprc': 0.6040745481851032, 'loss_val': 1.1716084552739163, 'psi': 0.3446897688426238}
[S17] START round=7 head_norm_before_train=0.834638 cos_to_last_merge=1.0000 (last merge round=6)
[S17] round=7 local utility u=0.000000 metrics={'f1_val': 0.35282122642617253, 'auprc': 0.5949505833181219, 'loss_val': 1.0890155052220956, 'psi': 0.4496729691829523}-{'f1_val': 0.38822706624119907, 'auprc': 0.5832509778292999, 'loss_val': 1.102065198601913, 'psi': 0.4662366308764394}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] → sending delta(kind=head bytes=1805) to S11@127.0.0.1:41912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:41916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:41903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:41917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:41909
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1805 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1805) from S14
[S11] cosine check vs S14: cos=-0.1038
[S11] DROPPED delta from S14 (cos=-0.1038 < 0.0)
[S11] sending update (kind=head size=1796 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1796) from S11
[S16] cosine check vs S11: cos=-0.0807
[S16] DROPPED delta from S11 (cos=-0.0807 < 0.0)
[S8] sending update (kind=head size=1799 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1799) from S8
[S3] cosine check vs S8: cos=-0.0973
[S3] DROPPED delta from S8 (cos=-0.0973 < 0.0)
[S10] sending update (kind=head size=1794 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:41902
[S2] sending update (kind=head size=1797 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] RECEIVED delta(kind=head bytes=1797) from S2
[S17] cosine check vs S2: cos=-0.1552
[S17] DROPPED delta from S2 (cos=-0.1552 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1794) from S10
[S8] cosine check vs S10: cos=-0.0156
[S8] DROPPED delta from S10 (cos=-0.0156 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:41916
[S13] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S7] → sending delta(kind=head bytes=1793) to S4@127.0.0.1:41904
[S2] RECEIVED delta(kind=head bytes=1795) from S13
[S2] cosine check vs S13: cos=-0.0480
[S2] DROPPED delta from S13 (cos=-0.0480 < 0.0)
[S9] sending update (kind=head size=1803 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1803) from S9
[S16] cosine check vs S9: cos=0.6755
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:41917
[S6] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] → sending delta(kind=head bytes=1793) to S14@127.0.0.1:41914
[S17] RECEIVED delta(kind=head bytes=1798) from S6
[S17] cosine check vs S6: cos=0.4955
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S16] → sending delta(kind=head bytes=1792) to S15@127.0.0.1:41915
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:41913
[S4] sending update (kind=head size=1793 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1793) from S4
[S14] cosine check vs S4: cos=-0.0772
[S14] DROPPED delta from S4 (cos=-0.0772 < 0.0)
[S16] sending update (kind=head size=1792 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1799) from S15
[S13] cosine check vs S15: cos=-0.0205
[S13] DROPPED delta from S15 (cos=-0.0205 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1792) from S16
[S15] cosine check vs S16: cos=0.4256
[S7] sending update (kind=head size=1793 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1793) from S7
[S4] cosine check vs S7: cos=0.9854
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=7 metric=0.4101 head_norm=1.320226
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.374669e-01
[S4] stored merged vector for next round verification (round=7)
[S4] DEBUG after merge:  round=7 metric=0.3681 head_norm=1.384435 delta_norm=0.137467
[S4] aggregate: ROLLBACK (f1_val pre=0.410 post=0.368 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=7 metric=0.4164 head_norm=0.760243
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.647939e-01
[S15] stored merged vector for next round verification (round=7)
[S15] DEBUG after merge:  round=7 metric=0.4164 head_norm=0.723208 delta_norm=0.464794
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=7 metric=0.4172 head_norm=0.948766
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.932037e-01
[S16] stored merged vector for next round verification (round=7)
[S16] DEBUG after merge:  round=7 metric=0.4171 head_norm=1.173293 delta_norm=0.593204
[S16] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=7 metric=0.3528 head_norm=0.865998
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.634401e-01
[S17] stored merged vector for next round verification (round=7)
[S17] DEBUG after merge:  round=7 metric=0.3517 head_norm=0.794576 delta_norm=0.463440
[S17] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=0.903965 cos_to_last_merge=0.9350 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.935
[S2] round=8 local utility u=0.038871 metrics={'f1_val': 0.4165213867478249, 'auprc': 0.7751700072764771, 'loss_val': 0.9520722039742203, 'psi': 0.5599808349592859}-{'f1_val': 0.41668780995073934, 'auprc': 0.7774722831528424, 'loss_val': 1.0377190115342976, 'psi': 0.5610015992315805}
[S3] START round=8 head_norm_before_train=1.583255 (no previous merge yet)
[S3] round=8 local utility u=0.000378 metrics={'f1_val': 0.6795454558830814, 'auprc': 0.9960705253068914, 'loss_val': 0.37218312894196565, 'psi': 0.8061554836526054}-{'f1_val': 0.6829457812837256, 'auprc': 0.9977591254938094, 'loss_val': 0.3984062891657678, 'psi': 0.8088711189677591}
[S4] START round=8 head_norm_before_train=1.384435 cos_to_last_merge=1.0000 (last merge round=7)
[S4] round=8 local utility u=0.000000 metrics={'f1_val': 0.38342961958246785, 'auprc': 0.6614611190780214, 'loss_val': 0.9465322262404756, 'psi': 0.4946422193806893}-{'f1_val': 0.4101018609079016, 'auprc': 0.7637532783306191, 'loss_val': 1.0964138789314057, 'psi': 0.5515624278769886}
[S5] START round=8 head_norm_before_train=1.447614 (no previous merge yet)
[S5] round=8 local utility u=0.150665 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.8049907787530177, 'loss_val': 0.3951293697019865, 'psi': 0.7423613470988117}-{'f1_val': 0.7005685100046517, 'auprc': 0.7247222525048136, 'loss_val': 0.45541404625336895, 'psi': 0.7102300070047165}
[S6] START round=8 head_norm_before_train=0.970722 cos_to_last_merge=0.9389 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.939
[S6] round=8 local utility u=0.603314 metrics={'f1_val': 0.5702326081458391, 'auprc': 0.9799550261026708, 'loss_val': 0.7247075584764947, 'psi': 0.7341215753285718}-{'f1_val': 0.41705570454086727, 'auprc': 0.9339345584194356, 'loss_val': 0.8742135390610534, 'psi': 0.6238072460922947}
[S7] START round=8 head_norm_before_train=1.458807 (no previous merge yet)
[S7] round=8 local utility u=0.000000 metrics={'f1_val': 0.6537630318148154, 'auprc': 0.7885213347237101, 'loss_val': 0.7243811130156275, 'psi': 0.7076663529783733}-{'f1_val': 0.7138409291285264, 'auprc': 0.7883612558066332, 'loss_val': 0.7538850331712966, 'psi': 0.7436490597997691}
[S8] START round=8 head_norm_before_train=1.377966 (no previous merge yet)
[S8] round=8 local utility u=0.129740 metrics={'f1_val': 0.7145254456069222, 'auprc': 0.7944137311337306, 'loss_val': 0.5072970517575733, 'psi': 0.7464807598176456}-{'f1_val': 0.7147473519913303, 'auprc': 0.7944910175833504, 'loss_val': 0.7683406052488176, 'psi': 0.7466448182281383}
[S9] START round=8 head_norm_before_train=1.599018 (no previous merge yet)
[S9] round=8 local utility u=0.039798 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9988211456176298, 'loss_val': 0.1077540268017602, 'psi': 0.9975247653353868}-{'f1_val': 0.9907913321404518, 'auprc': 0.9996197240537362, 'loss_val': 0.15453014200469822, 'psi': 0.9943226889057656}
[S10] START round=8 head_norm_before_train=1.080184 cos_to_last_merge=0.9494 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.949
[S10] round=8 local utility u=1.000000 metrics={'f1_val': 0.6996183457392582, 'auprc': 0.9833294073025347, 'loss_val': 0.7967838976777964, 'psi': 0.8131027703645688}-{'f1_val': 0.41678903473405027, 'auprc': 0.6664337213279872, 'loss_val': 0.9197455474214238, 'psi': 0.516646909371625}
[S11] START round=8 head_norm_before_train=1.377773 (no previous merge yet)
[S11] round=8 local utility u=0.233403 metrics={'f1_val': 0.46364303339199786, 'auprc': 0.99901459126273, 'loss_val': 0.6681387977459963, 'psi': 0.6777916565402907}-{'f1_val': 0.39681973109600455, 'auprc': 0.9981524125263443, 'loss_val': 0.7314187885438281, 'psi': 0.6373528036681405}
[S13] START round=8 head_norm_before_train=1.362950 (no previous merge yet)
[S13] round=8 local utility u=1.000000 metrics={'f1_val': 0.7113104823159138, 'auprc': 0.7488895256701306, 'loss_val': 0.6704927074521182, 'psi': 0.7263420996576004}-{'f1_val': 0.37520197054665977, 'auprc': 0.7442963037758965, 'loss_val': 0.817484927179683, 'psi': 0.5228397038383544}
[S14] START round=8 head_norm_before_train=0.739050 cos_to_last_merge=0.9947 (last merge round=6)
[S14] round=8 local utility u=0.925450 metrics={'f1_val': 0.3949210590951025, 'auprc': 0.8991480480949141, 'loss_val': 1.0442550519509917, 'psi': 0.5966118546950272}-{'f1_val': 0.14035785288270378, 'auprc': 0.8213606254483645, 'loss_val': 1.1344127551326308, 'psi': 0.4127589619089681}
[S15] START round=8 head_norm_before_train=0.723208 cos_to_last_merge=1.0000 (last merge round=7)
[S15] round=8 local utility u=0.000000 metrics={'f1_val': 0.41660736423639244, 'auprc': 0.787059746579877, 'loss_val': 1.015494601188762, 'psi': 0.5647883171737863}-{'f1_val': 0.4163758395072774, 'auprc': 0.7997156006888331, 'loss_val': 1.050939808125174, 'psi': 0.5697117439798997}
[S16] START round=8 head_norm_before_train=1.173293 cos_to_last_merge=1.0000 (last merge round=7)
[S16] round=8 local utility u=0.056375 metrics={'f1_val': 0.436000405240677, 'auprc': 0.5283872191599597, 'loss_val': 1.024645527122387, 'psi': 0.47295513080839013}-{'f1_val': 0.41719231679200464, 'auprc': 0.5427915002595777, 'loss_val': 1.067759063895231, 'psi': 0.4674319901790338}
[S17] START round=8 head_norm_before_train=0.794576 cos_to_last_merge=1.0000 (last merge round=7)
[S17] round=8 local utility u=0.000000 metrics={'f1_val': 0.3522323654220885, 'auprc': 0.5009985826758916, 'loss_val': 1.0491858867253594, 'psi': 0.41173885232360974}-{'f1_val': 0.35282122642617253, 'auprc': 0.5949505833181219, 'loss_val': 1.0890155052220956, 'psi': 0.4496729691829523}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:41916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:41917
[S9] sending update (kind=head size=1803 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1797) from S2
[S17] cosine check vs S2: cos=-0.1008
[S17] DROPPED delta from S2 (cos=-0.1008 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1803) from S9
[S16] cosine check vs S9: cos=0.9392
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:41917
[S6] sending update (kind=head size=1799 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1799) from S6
[S17] cosine check vs S6: cos=0.8355
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:41912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:41902
[S14] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1797) from S14
[S11] cosine check vs S14: cos=-0.0970
[S11] DROPPED delta from S14 (cos=-0.0970 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1801) from S13
[S2] cosine check vs S13: cos=-0.0561
[S2] DROPPED delta from S13 (cos=-0.0561 < 0.0)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:41903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S16] → sending delta(kind=head bytes=1791) to S15@127.0.0.1:41915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:41916
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] → sending delta(kind=head bytes=1805) to S17@127.0.0.1:41917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:41909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:41916
[S5] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1791 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1801) from S5
[S16] cosine check vs S5: cos=0.2590
[S3] RECEIVED delta(kind=head bytes=1802) from S8
[S3] cosine check vs S8: cos=-0.0959
[S3] DROPPED delta from S8 (cos=-0.0959 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1791) from S16
[S15] cosine check vs S16: cos=0.6952
[S10] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1805 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1800) from S11
[S16] cosine check vs S11: cos=-0.1306
[S16] DROPPED delta from S11 (cos=-0.1306 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1805) from S3
[S17] cosine check vs S3: cos=0.4671
[S8] RECEIVED delta(kind=head bytes=1800) from S10
[S8] cosine check vs S10: cos=-0.0182
[S8] DROPPED delta from S10 (cos=-0.0182 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=8 metric=0.4360 head_norm=1.194700
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.807542e-01
[S16] stored merged vector for next round verification (round=8)
[S16] DEBUG after merge:  round=8 metric=0.4364 head_norm=1.113150 delta_norm=0.280754
[S16] aggregate: ACCEPT kept=['S9', 'S5'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=8 metric=0.4166 head_norm=0.766199
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.305668e-01
[S15] stored merged vector for next round verification (round=8)
[S15] DEBUG after merge:  round=8 metric=0.4190 head_norm=0.906530 delta_norm=0.430567
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=8 metric=0.3522 head_norm=0.823401
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.671142e-01
[S17] stored merged vector for next round verification (round=8)
[S17] DEBUG after merge:  round=8 metric=0.3520 head_norm=0.856247 delta_norm=0.267114
[S17] aggregate: ACCEPT kept=['S6', 'S3'] (k=2/2) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=0.934396 cos_to_last_merge=0.9234 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.923
[S2] round=9 local utility u=0.024996 metrics={'f1_val': 0.4162668157988936, 'auprc': 0.775309103763068, 'loss_val': 0.9009706572706924, 'psi': 0.5598837309845635}-{'f1_val': 0.4165213867478249, 'auprc': 0.7751700072764771, 'loss_val': 0.9520722039742203, 'psi': 0.5599808349592859}
[S3] START round=9 head_norm_before_train=1.627444 (no previous merge yet)
[S3] round=9 local utility u=0.098736 metrics={'f1_val': 0.7000850230591003, 'auprc': 0.994747459645165, 'loss_val': 0.2939791982978412, 'psi': 0.817949997693526}-{'f1_val': 0.6795454558830814, 'auprc': 0.9960705253068914, 'loss_val': 0.37218312894196565, 'psi': 0.8061554836526054}
[S4] START round=9 head_norm_before_train=1.413379 cos_to_last_merge=0.9979 (last merge round=7)
[S4] round=9 local utility u=0.085596 metrics={'f1_val': 0.3785460726016677, 'auprc': 0.6726545200485554, 'loss_val': 0.7796198825752148, 'psi': 0.4961894515804228}-{'f1_val': 0.38342961958246785, 'auprc': 0.6614611190780214, 'loss_val': 0.9465322262404756, 'psi': 0.4946422193806893}
[S5] START round=9 head_norm_before_train=1.488129 (no previous merge yet)
[S5] round=9 local utility u=0.124763 metrics={'f1_val': 0.7072987500036175, 'auprc': 0.8563777428465849, 'loss_val': 0.33990638619630004, 'psi': 0.7669303471408044}-{'f1_val': 0.7006083926626743, 'auprc': 0.8049907787530177, 'loss_val': 0.3951293697019865, 'psi': 0.7423613470988117}
[S6] START round=9 head_norm_before_train=1.014281 cos_to_last_merge=0.9258 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.926
[S6] round=9 local utility u=0.000000 metrics={'f1_val': 0.4171750610705429, 'auprc': 0.7883502529524585, 'loss_val': 0.724230500940463, 'psi': 0.5656451378233092}-{'f1_val': 0.5702326081458391, 'auprc': 0.9799550261026708, 'loss_val': 0.7247075584764947, 'psi': 0.7341215753285718}
[S7] START round=9 head_norm_before_train=1.490866 (no previous merge yet)
[S7] round=9 local utility u=0.146693 metrics={'f1_val': 0.6804026733715633, 'auprc': 0.7901270607158987, 'loss_val': 0.5956504372427254, 'psi': 0.7242924283092975}-{'f1_val': 0.6537630318148154, 'auprc': 0.7885213347237101, 'loss_val': 0.7243811130156275, 'psi': 0.7076663529783733}
[S8] START round=9 head_norm_before_train=1.431014 (no previous merge yet)
[S8] round=9 local utility u=0.355938 metrics={'f1_val': 0.7108213973115239, 'auprc': 0.9948820137589095, 'loss_val': 0.3746012810503128, 'psi': 0.8244456438904781}-{'f1_val': 0.7145254456069222, 'auprc': 0.7944137311337306, 'loss_val': 0.5072970517575733, 'psi': 0.7464807598176456}
[S9] START round=9 head_norm_before_train=1.657682 (no previous merge yet)
[S9] round=9 local utility u=0.018202 metrics={'f1_val': 0.9968210870560296, 'auprc': 0.9987852996949723, 'loss_val': 0.07220587350698096, 'psi': 0.9976067721116066}-{'f1_val': 0.9966605118138915, 'auprc': 0.9988211456176298, 'loss_val': 0.1077540268017602, 'psi': 0.9975247653353868}
[S10] START round=9 head_norm_before_train=1.129898 cos_to_last_merge=0.9356 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.936
[S10] round=9 local utility u=0.113443 metrics={'f1_val': 0.7018537763416527, 'auprc': 0.9966378478819656, 'loss_val': 0.6232357594125058, 'psi': 0.8197674049577779}-{'f1_val': 0.6996183457392582, 'auprc': 0.9833294073025347, 'loss_val': 0.7967838976777964, 'psi': 0.8131027703645688}
[S11] START round=9 head_norm_before_train=1.425859 (no previous merge yet)
[S11] round=9 local utility u=0.747465 metrics={'f1_val': 0.6936507331356029, 'auprc': 0.998721872315439, 'loss_val': 0.552376941849622, 'psi': 0.8156791888075373}-{'f1_val': 0.46364303339199786, 'auprc': 0.99901459126273, 'loss_val': 0.6681387977459963, 'psi': 0.6777916565402907}
[S13] START round=9 head_norm_before_train=1.398536 (no previous merge yet)
[S13] round=9 local utility u=0.000000 metrics={'f1_val': 0.5355981966723853, 'auprc': 0.7541392581757543, 'loss_val': 0.6819864175953958, 'psi': 0.6230146212737329}-{'f1_val': 0.7113104823159138, 'auprc': 0.7488895256701306, 'loss_val': 0.6704927074521182, 'psi': 0.7263420996576004}
[S14] START round=9 head_norm_before_train=0.782370 cos_to_last_merge=0.9833 (last merge round=6)
[S14] round=9 local utility u=0.600524 metrics={'f1_val': 0.5219414044829223, 'auprc': 0.9846568512138556, 'loss_val': 0.8618553849074265, 'psi': 0.7070275831752957}-{'f1_val': 0.3949210590951025, 'auprc': 0.8991480480949141, 'loss_val': 1.0442550519509917, 'psi': 0.5966118546950272}
[S15] START round=9 head_norm_before_train=0.906530 cos_to_last_merge=1.0000 (last merge round=8)
[S15] round=9 local utility u=0.010229 metrics={'f1_val': 0.4330159630861734, 'auprc': 0.7371648849161334, 'loss_val': 0.9438036736082615, 'psi': 0.5546755318181574}-{'f1_val': 0.41660736423639244, 'auprc': 0.787059746579877, 'loss_val': 1.015494601188762, 'psi': 0.5647883171737863}
[S16] START round=9 head_norm_before_train=1.113150 cos_to_last_merge=1.0000 (last merge round=8)
[S16] round=9 local utility u=0.000000 metrics={'f1_val': 0.37837711245076233, 'auprc': 0.540604338264554, 'loss_val': 0.965064107976525, 'psi': 0.443268002776279}-{'f1_val': 0.436000405240677, 'auprc': 0.5283872191599597, 'loss_val': 1.024645527122387, 'psi': 0.47295513080839013}
[S17] START round=9 head_norm_before_train=0.856247 cos_to_last_merge=1.0000 (last merge round=8)
[S17] round=9 local utility u=0.054685 metrics={'f1_val': 0.3532105568956107, 'auprc': 0.5071694702869869, 'loss_val': 0.9641977359353848, 'psi': 0.41479412225216117}-{'f1_val': 0.3522323654220885, 'auprc': 0.5009985826758916, 'loss_val': 1.0491858867253594, 'psi': 0.41173885232360974}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S8] → sending delta(kind=head bytes=1807) to S3@127.0.0.1:41903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:41917
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:41917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:41914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:41916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] → sending delta(kind=head bytes=1794) to S11@127.0.0.1:41912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:41916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S7] → sending delta(kind=head bytes=1792) to S4@127.0.0.1:41904
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:41909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] → sending delta(kind=head bytes=1792) to S13@127.0.0.1:41913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:41916
[S10] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1792 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1794 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1792 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1807 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1792) from S7
[S4] cosine check vs S7: cos=0.9787
[S14] RECEIVED delta(kind=head bytes=1799) from S4
[S14] cosine check vs S4: cos=-0.0529
[S14] DROPPED delta from S4 (cos=-0.0529 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1794) from S14
[S11] cosine check vs S14: cos=-0.0942
[S11] DROPPED delta from S14 (cos=-0.0942 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1792) from S15
[S13] cosine check vs S15: cos=-0.0148
[S13] DROPPED delta from S15 (cos=-0.0148 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1802) from S3
[S17] cosine check vs S3: cos=0.6950
[S8] RECEIVED delta(kind=head bytes=1801) from S10
[S8] cosine check vs S10: cos=-0.0185
[S8] DROPPED delta from S10 (cos=-0.0185 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1801) from S11
[S16] cosine check vs S11: cos=-0.1076
[S16] DROPPED delta from S11 (cos=-0.1076 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1801) from S5
[S16] cosine check vs S5: cos=0.4675
[S17] RECEIVED delta(kind=head bytes=1798) from S2
[S17] cosine check vs S2: cos=-0.1406
[S17] DROPPED delta from S2 (cos=-0.1406 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1799) from S9
[S16] cosine check vs S9: cos=0.8525
[S3] RECEIVED delta(kind=head bytes=1807) from S8
[S3] cosine check vs S8: cos=-0.0954
[S3] DROPPED delta from S8 (cos=-0.0954 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S17] → sending delta(kind=head bytes=1786) to S14@127.0.0.1:41914
[S17] sending update (kind=head size=1786 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1786) from S17
[S14] cosine check vs S17: cos=0.7383
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=9 metric=0.5219 head_norm=0.837686
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.141155e-01
[S14] stored merged vector for next round verification (round=9)
[S14] DEBUG after merge:  round=9 metric=0.4009 head_norm=0.806878 delta_norm=0.314115
[S14] aggregate: ROLLBACK (f1_val pre=0.522 post=0.401 tol_abs=0.005 tol_rel=0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=9 metric=0.3785 head_norm=1.456679
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.567660e-01
[S4] stored merged vector for next round verification (round=9)
[S4] DEBUG after merge:  round=9 metric=0.3855 head_norm=1.480391 delta_norm=0.156766
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=9 metric=0.3784 head_norm=1.145011
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.714782e-01
[S16] stored merged vector for next round verification (round=9)
[S16] DEBUG after merge:  round=9 metric=0.3604 head_norm=1.129119 delta_norm=0.171478
[S16] aggregate: ROLLBACK (f1_val pre=0.378 post=0.360 tol_abs=0.005 tol_rel=0.0)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=9 metric=0.3532 head_norm=0.893154
[S17] _apply_head_vector_avg (torch): Δ‖w‖=6.149124e-01
[S17] stored merged vector for next round verification (round=9)
[S17] DEBUG after merge:  round=9 metric=0.3529 head_norm=1.189305 delta_norm=0.614912
[S17] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=0.970906 cos_to_last_merge=0.9085 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.909
[S2] round=10 local utility u=0.793480 metrics={'f1_val': 0.6592006302725231, 'auprc': 0.7772340864127009, 'loss_val': 0.7773891587399702, 'psi': 0.7064140127285942}-{'f1_val': 0.4162668157988936, 'auprc': 0.775309103763068, 'loss_val': 0.9009706572706924, 'psi': 0.5598837309845635}
[S3] START round=10 head_norm_before_train=1.669552 (no previous merge yet)
[S3] round=10 local utility u=0.030916 metrics={'f1_val': 0.7008317350254774, 'auprc': 0.9952686798566333, 'loss_val': 0.2381918371773909, 'psi': 0.8186065129579397}-{'f1_val': 0.7000850230591003, 'auprc': 0.994747459645165, 'loss_val': 0.2939791982978412, 'psi': 0.817949997693526}
[S4] START round=10 head_norm_before_train=1.480391 cos_to_last_merge=1.0000 (last merge round=9)
[S4] round=10 local utility u=0.128768 metrics={'f1_val': 0.40523098141064384, 'auprc': 0.6675638378581605, 'loss_val': 0.6669202983535419, 'psi': 0.5101641239896505}-{'f1_val': 0.3785460726016677, 'auprc': 0.6726545200485554, 'loss_val': 0.7796198825752148, 'psi': 0.4961894515804228}
[S5] START round=10 head_norm_before_train=1.535557 (no previous merge yet)
[S5] round=10 local utility u=0.000000 metrics={'f1_val': 0.7145982412546548, 'auprc': 0.7915637820648692, 'loss_val': 0.5105963205145124, 'psi': 0.7453844575787405}-{'f1_val': 0.7072987500036175, 'auprc': 0.8563777428465849, 'loss_val': 0.33990638619630004, 'psi': 0.7669303471408044}
[S6] START round=10 head_norm_before_train=1.058186 cos_to_last_merge=0.9127 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.913
[S6] round=10 local utility u=0.581982 metrics={'f1_val': 0.5870509137919101, 'auprc': 0.8005539200673668, 'loss_val': 0.6161317038385298, 'psi': 0.6724521163020928}-{'f1_val': 0.4171750610705429, 'auprc': 0.7883502529524585, 'loss_val': 0.724230500940463, 'psi': 0.5656451378233092}
[S7] START round=10 head_norm_before_train=1.519985 (no previous merge yet)
[S7] round=10 local utility u=0.000000 metrics={'f1_val': 0.6353831504461, 'auprc': 0.7880674084295612, 'loss_val': 0.6039524969059673, 'psi': 0.6964568536394846}-{'f1_val': 0.6804026733715633, 'auprc': 0.7901270607158987, 'loss_val': 0.5956504372427254, 'psi': 0.7242924283092975}
[S8] START round=10 head_norm_before_train=1.482973 (no previous merge yet)
[S8] round=10 local utility u=0.000000 metrics={'f1_val': 0.7001352933012621, 'auprc': 0.9817601796500208, 'loss_val': 0.31524637813719564, 'psi': 0.8127852478407656}-{'f1_val': 0.7108213973115239, 'auprc': 0.9948820137589095, 'loss_val': 0.3746012810503128, 'psi': 0.8244456438904781}
[S9] START round=10 head_norm_before_train=1.709903 (no previous merge yet)
[S9] round=10 local utility u=0.008080 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9976993490213151, 'loss_val': 0.05182447141771366, 'psi': 0.9970760466968609}-{'f1_val': 0.9968210870560296, 'auprc': 0.9987852996949723, 'loss_val': 0.07220587350698096, 'psi': 0.9976067721116066}
[S10] START round=10 head_norm_before_train=1.191004 cos_to_last_merge=0.9194 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.919
[S10] round=10 local utility u=0.044470 metrics={'f1_val': 0.6978914871296467, 'auprc': 0.9883544586017563, 'loss_val': 0.4856722924999456, 'psi': 0.8140766757184905}-{'f1_val': 0.7018537763416527, 'auprc': 0.9966378478819656, 'loss_val': 0.6232357594125058, 'psi': 0.8197674049577779}
[S11] START round=10 head_norm_before_train=1.472150 (no previous merge yet)
[S11] round=10 local utility u=0.100583 metrics={'f1_val': 0.7020007759458987, 'auprc': 0.9981954838702299, 'loss_val': 0.3997320528065365, 'psi': 0.8204786591156312}-{'f1_val': 0.6936507331356029, 'auprc': 0.998721872315439, 'loss_val': 0.552376941849622, 'psi': 0.8156791888075373}
[S13] START round=10 head_norm_before_train=1.431548 (no previous merge yet)
[S13] round=10 local utility u=0.537762 metrics={'f1_val': 0.70288874010099, 'auprc': 0.7619918119627238, 'loss_val': 0.6337634248021231, 'psi': 0.7265299688456835}-{'f1_val': 0.5355981966723853, 'auprc': 0.7541392581757543, 'loss_val': 0.6819864175953958, 'psi': 0.6230146212737329}
[S14] START round=10 head_norm_before_train=0.806878 cos_to_last_merge=1.0000 (last merge round=9)
[S14] round=10 local utility u=0.077452 metrics={'f1_val': 0.5295031029719839, 'auprc': 0.9958454789053185, 'loss_val': 0.7858881761377053, 'psi': 0.7160400533453177}-{'f1_val': 0.5219414044829223, 'auprc': 0.9846568512138556, 'loss_val': 0.8618553849074265, 'psi': 0.7070275831752957}
[S15] START round=10 head_norm_before_train=0.936760 cos_to_last_merge=0.9929 (last merge round=8)
[S15] round=10 local utility u=0.945092 metrics={'f1_val': 0.690094640280736, 'auprc': 0.7981516224301717, 'loss_val': 0.7790526796725102, 'psi': 0.7333174331405102}-{'f1_val': 0.4330159630861734, 'auprc': 0.7371648849161334, 'loss_val': 0.9438036736082615, 'psi': 0.5546755318181574}
[S16] START round=10 head_norm_before_train=1.129119 cos_to_last_merge=1.0000 (last merge round=9)
[S16] round=10 local utility u=0.000000 metrics={'f1_val': 0.35614948074122194, 'auprc': 0.5426834297671643, 'loss_val': 0.9601880133501246, 'psi': 0.4307630603515989}-{'f1_val': 0.37837711245076233, 'auprc': 0.540604338264554, 'loss_val': 0.965064107976525, 'psi': 0.443268002776279}
[S17] START round=10 head_norm_before_train=1.189305 cos_to_last_merge=1.0000 (last merge round=9)
[S17] round=10 local utility u=0.000000 metrics={'f1_val': 0.35306370471723497, 'auprc': 0.47449644034951843, 'loss_val': 0.8963682878820821, 'psi': 0.40163679897014837}-{'f1_val': 0.3532105568956107, 'auprc': 0.5071694702869869, 'loss_val': 0.9641977359353848, 'psi': 0.41479412225216117}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:41914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:41917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:41902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:41917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:41916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:41916
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:41912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:41913
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:41917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:41909
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1803) from S15
[S13] cosine check vs S15: cos=-0.0168
[S13] DROPPED delta from S15 (cos=-0.0168 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1801) from S10
[S8] cosine check vs S10: cos=-0.0179
[S8] DROPPED delta from S10 (cos=-0.0179 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1801) from S9
[S16] cosine check vs S9: cos=0.7949
[S16] RECEIVED delta(kind=head bytes=1795) from S11
[S16] cosine check vs S11: cos=-0.0927
[S16] DROPPED delta from S11 (cos=-0.0927 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1803) from S3
[S17] cosine check vs S3: cos=0.9506
[S17] RECEIVED delta(kind=head bytes=1799) from S2
[S17] cosine check vs S2: cos=-0.1799
[S17] DROPPED delta from S2 (cos=-0.1799 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1797) from S6
[S17] cosine check vs S6: cos=0.2462
[S14] RECEIVED delta(kind=head bytes=1796) from S4
[S14] cosine check vs S4: cos=-0.0627
[S14] DROPPED delta from S4 (cos=-0.0627 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1795) from S13
[S2] cosine check vs S13: cos=-0.0650
[S2] DROPPED delta from S13 (cos=-0.0650 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1799) from S14
[S11] cosine check vs S14: cos=-0.1198
[S11] DROPPED delta from S14 (cos=-0.1198 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] ⇄ pheromone p=0.294 → S3@127.0.0.1:41903
[S7] ⇄ pheromone p=0.281 → S4@127.0.0.1:41904
[S5] ⇄ pheromone p=0.268 → S16@127.0.0.1:41916
[S14] ⇄ pheromone p=0.372 → S11@127.0.0.1:41912
[S11] ⇄ pheromone p=0.405 → S16@127.0.0.1:41916
[S6] ⇄ pheromone p=0.398 → S17@127.0.0.1:41917
[S4] ⇄ pheromone p=0.270 → S14@127.0.0.1:41914
[S3] ⇄ pheromone p=0.232 → S17@127.0.0.1:41917
[S13] ⇄ pheromone p=0.419 → S2@127.0.0.1:41902
[S10] ⇄ pheromone p=0.340 → S8@127.0.0.1:41909
[S2] ⇄ pheromone p=0.370 → S17@127.0.0.1:41917
[S9] ⇄ pheromone p=0.341 → S16@127.0.0.1:41916
[S15] ⇄ pheromone p=0.403 → S13@127.0.0.1:41913
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=10 metric=0.3531 head_norm=1.226270
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.316162e-01
[S17] stored merged vector for next round verification (round=10)
[S17] DEBUG after merge:  round=10 metric=0.3523 head_norm=1.105127 delta_norm=0.231616
[S17] aggregate: ACCEPT kept=['S3', 'S6'] (k=2/2) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.193 → S14@127.0.0.1:41914
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=10 metric=0.3561 head_norm=1.168055
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.430980e-01
[S16] stored merged vector for next round verification (round=10)
[S16] DEBUG after merge:  round=10 metric=0.3879 head_norm=1.386041 delta_norm=0.543098
[S16] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.194 → S15@127.0.0.1:41915
[S2] START round=11 head_norm_before_train=1.013795 cos_to_last_merge=0.8929 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.893
[S2] round=11 local utility u=0.000000 metrics={'f1_val': 0.6373510598638227, 'auprc': 0.776749731822445, 'loss_val': 0.7276646050111779, 'psi': 0.6931105286472716}-{'f1_val': 0.6592006302725231, 'auprc': 0.7772340864127009, 'loss_val': 0.7773891587399702, 'psi': 0.7064140127285942}
[S3] START round=11 head_norm_before_train=1.717235 (no previous merge yet)
[S3] round=11 local utility u=0.022089 metrics={'f1_val': 0.7010108237857944, 'auprc': 0.9969418764203285, 'loss_val': 0.20010846614842248, 'psi': 0.8193832448396081}-{'f1_val': 0.7008317350254774, 'auprc': 0.9952686798566333, 'loss_val': 0.2381918371773909, 'psi': 0.8186065129579397}
[S4] START round=11 head_norm_before_train=1.527001 cos_to_last_merge=0.9983 (last merge round=9)
[S4] round=11 local utility u=0.838737 metrics={'f1_val': 0.6671787164187286, 'auprc': 0.6608694549529344, 'loss_val': 0.5410494122820183, 'psi': 0.6646550118324109}-{'f1_val': 0.40523098141064384, 'auprc': 0.6675638378581605, 'loss_val': 0.6669202983535419, 'psi': 0.5101641239896505}
[S5] START round=11 head_norm_before_train=1.585967 (no previous merge yet)
[S5] round=11 local utility u=0.000000 metrics={'f1_val': 0.7143049231465757, 'auprc': 0.7929525354482183, 'loss_val': 0.5163927181036642, 'psi': 0.7457639680672328}-{'f1_val': 0.7145982412546548, 'auprc': 0.7915637820648692, 'loss_val': 0.5105963205145124, 'psi': 0.7453844575787405}
[S6] START round=11 head_norm_before_train=1.105231 cos_to_last_merge=0.9007 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.901
[S6] round=11 local utility u=0.176559 metrics={'f1_val': 0.6320844295090634, 'auprc': 0.8072325579890756, 'loss_val': 0.5532501416495655, 'psi': 0.7021436809010683}-{'f1_val': 0.5870509137919101, 'auprc': 0.8005539200673668, 'loss_val': 0.6161317038385298, 'psi': 0.6724521163020928}
[S7] START round=11 head_norm_before_train=1.553746 (no previous merge yet)
[S7] round=11 local utility u=0.133721 metrics={'f1_val': 0.6514965102523799, 'auprc': 0.8244752006591707, 'loss_val': 0.5424143407876566, 'psi': 0.7206879864150961}-{'f1_val': 0.6353831504461, 'auprc': 0.7880674084295612, 'loss_val': 0.6039524969059673, 'psi': 0.6964568536394846}
[S8] START round=11 head_norm_before_train=1.532097 (no previous merge yet)
[S8] round=11 local utility u=0.000000 metrics={'f1_val': 0.7140170479737811, 'auprc': 0.7933191470029778, 'loss_val': 0.37970752498668886, 'psi': 0.7457378875854598}-{'f1_val': 0.7001352933012621, 'auprc': 0.9817601796500208, 'loss_val': 0.31524637813719564, 'psi': 0.8127852478407656}
[S9] START round=11 head_norm_before_train=1.751508 (no previous merge yet)
[S9] round=11 local utility u=0.007915 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9978308371959772, 'loss_val': 0.0390426949945743, 'psi': 0.9973940823856766}-{'f1_val': 0.9966605118138915, 'auprc': 0.9976993490213151, 'loss_val': 0.05182447141771366, 'psi': 0.9970760466968609}
[S10] START round=11 head_norm_before_train=1.251847 cos_to_last_merge=0.9042 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.904
[S10] round=11 local utility u=0.039717 metrics={'f1_val': 0.6895054389966394, 'auprc': 0.9971942952761521, 'loss_val': 0.382441154665797, 'psi': 0.8125809815084445}-{'f1_val': 0.6978914871296467, 'auprc': 0.9883544586017563, 'loss_val': 0.4856722924999456, 'psi': 0.8140766757184905}
[S11] START round=11 head_norm_before_train=1.522127 (no previous merge yet)
[S11] round=11 local utility u=0.032523 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9981828148114469, 'loss_val': 0.3342547385282715, 'psi': 0.8204343159035707}-{'f1_val': 0.7020007759458987, 'auprc': 0.9981954838702299, 'loss_val': 0.3997320528065365, 'psi': 0.8204786591156312}
[S13] START round=11 head_norm_before_train=1.465671 (no previous merge yet)
[S13] round=11 local utility u=0.063947 metrics={'f1_val': 0.7029836017902409, 'auprc': 0.7749063264038953, 'loss_val': 0.545182898762651, 'psi': 0.7317526916357027}-{'f1_val': 0.70288874010099, 'auprc': 0.7619918119627238, 'loss_val': 0.6337634248021231, 'psi': 0.7265299688456835}
[S14] START round=11 head_norm_before_train=0.855886 cos_to_last_merge=0.9945 (last merge round=9)
[S14] round=11 local utility u=0.588006 metrics={'f1_val': 0.7000211799134475, 'auprc': 0.9947808599127821, 'loss_val': 0.62979012371781, 'psi': 0.8179250519131813}-{'f1_val': 0.5295031029719839, 'auprc': 0.9958454789053185, 'loss_val': 0.7858881761377053, 'psi': 0.7160400533453177}
[S15] START round=11 head_norm_before_train=0.979985 cos_to_last_merge=0.9751 (last merge round=8)
[S15] round=11 local utility u=0.004983 metrics={'f1_val': 0.6976780473690661, 'auprc': 0.7560234616473973, 'loss_val': 0.6882020856513986, 'psi': 0.7210162130803985}-{'f1_val': 0.690094640280736, 'auprc': 0.7981516224301717, 'loss_val': 0.7790526796725102, 'psi': 0.7333174331405102}
[S16] START round=11 head_norm_before_train=1.386041 cos_to_last_merge=1.0000 (last merge round=10)
[S16] round=11 local utility u=0.777176 metrics={'f1_val': 0.5141017505460761, 'auprc': 0.7595327873231844, 'loss_val': 1.0040967308624595, 'psi': 0.6122741652569195}-{'f1_val': 0.35614948074122194, 'auprc': 0.5426834297671643, 'loss_val': 0.9601880133501246, 'psi': 0.4307630603515989}
[S17] START round=11 head_norm_before_train=1.105127 cos_to_last_merge=1.0000 (last merge round=10)
[S17] round=11 local utility u=0.067194 metrics={'f1_val': 0.3520340455881617, 'auprc': 0.524774130904955, 'loss_val': 0.9066347541949603, 'psi': 0.42113007971487904}-{'f1_val': 0.35306370471723497, 'auprc': 0.47449644034951843, 'loss_val': 0.8963682878820821, 'psi': 0.40163679897014837}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:41913
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:41917
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:41902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:41912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:41915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:41916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:41904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:41917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:41916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:41909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:41914
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1799) from S9
[S16] cosine check vs S9: cos=0.9586
[S8] RECEIVED delta(kind=head bytes=1801) from S10
[S8] cosine check vs S10: cos=-0.0169
[S8] DROPPED delta from S10 (cos=-0.0169 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1798) from S11
[S16] cosine check vs S11: cos=-0.1261
[S16] DROPPED delta from S11 (cos=-0.1261 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1801) from S15
[S13] cosine check vs S15: cos=-0.0209
[S13] DROPPED delta from S15 (cos=-0.0209 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1803) from S7
[S4] cosine check vs S7: cos=0.9760
[S17] RECEIVED delta(kind=head bytes=1796) from S6
[S17] cosine check vs S6: cos=0.3774
[S17] RECEIVED delta(kind=head bytes=1803) from S3
[S17] cosine check vs S3: cos=0.9053
[S15] RECEIVED delta(kind=head bytes=1799) from S16
[S15] cosine check vs S16: cos=0.8276
[S2] RECEIVED delta(kind=head bytes=1797) from S13
[S2] cosine check vs S13: cos=-0.0697
[S2] DROPPED delta from S13 (cos=-0.0697 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1800) from S14
[S11] cosine check vs S14: cos=-0.1152
[S11] DROPPED delta from S14 (cos=-0.1152 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1796) from S4
[S14] cosine check vs S4: cos=-0.0541
[S14] DROPPED delta from S4 (cos=-0.0541 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:41914
[S17] sending update (kind=head size=1803 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1803) from S17
[S14] cosine check vs S17: cos=0.8405
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=11 metric=0.6977 head_norm=1.032322
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.044483e-01
[S15] stored merged vector for next round verification (round=11)
[S15] DEBUG after merge:  round=11 metric=0.6847 head_norm=1.172904 delta_norm=0.404448
[S15] aggregate: ROLLBACK (f1_val pre=0.698 post=0.685 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=11 metric=0.7000 head_norm=0.914309
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.099895e-01
[S14] stored merged vector for next round verification (round=11)
[S14] DEBUG after merge:  round=11 metric=0.6991 head_norm=0.986428 delta_norm=0.309990
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=11 metric=0.6672 head_norm=1.578343
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.730623e-01
[S4] stored merged vector for next round verification (round=11)
[S4] DEBUG after merge:  round=11 metric=0.6710 head_norm=1.571592 delta_norm=0.173062
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=11 metric=0.5141 head_norm=1.418759
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.962666e-01
[S16] stored merged vector for next round verification (round=11)
[S16] DEBUG after merge:  round=11 metric=0.5152 head_norm=1.589724 delta_norm=0.296267
[S16] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=11 metric=0.3520 head_norm=1.141187
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.545427e-01
[S17] stored merged vector for next round verification (round=11)
[S17] DEBUG after merge:  round=11 metric=0.3519 head_norm=1.087017 delta_norm=0.154543
[S17] aggregate: ACCEPT kept=['S6', 'S3'] (k=2/2) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.064953 cos_to_last_merge=0.8768 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.877
[S2] round=12 local utility u=0.333025 metrics={'f1_val': 0.7094193366516226, 'auprc': 0.791631522991386, 'loss_val': 0.5386686760491367, 'psi': 0.742304211187528}-{'f1_val': 0.6373510598638227, 'auprc': 0.776749731822445, 'loss_val': 0.7276646050111779, 'psi': 0.6931105286472716}
[S3] START round=12 head_norm_before_train=1.761285 (no previous merge yet)
[S3] round=12 local utility u=0.820089 metrics={'f1_val': 0.960531351117436, 'auprc': 0.9984833957270814, 'loss_val': 0.12167905970050859, 'psi': 0.9757121689612942}-{'f1_val': 0.7010108237857944, 'auprc': 0.9969418764203285, 'loss_val': 0.20010846614842248, 'psi': 0.8193832448396081}
[S4] START round=12 head_norm_before_train=1.571592 cos_to_last_merge=1.0000 (last merge round=11)
[S4] round=12 local utility u=0.398868 metrics={'f1_val': 0.6871212607327957, 'auprc': 0.8620164649764455, 'loss_val': 0.46640992649398927, 'psi': 0.7570793424302555}-{'f1_val': 0.6671787164187286, 'auprc': 0.6608694549529344, 'loss_val': 0.5410494122820183, 'psi': 0.6646550118324109}
[S5] START round=12 head_norm_before_train=1.620450 (no previous merge yet)
[S5] round=12 local utility u=0.201615 metrics={'f1_val': 0.7154812603109921, 'auprc': 0.861175724953843, 'loss_val': 0.32489048579425234, 'psi': 0.7737590461681325}-{'f1_val': 0.7143049231465757, 'auprc': 0.7929525354482183, 'loss_val': 0.5163927181036642, 'psi': 0.7457639680672328}
[S6] START round=12 head_norm_before_train=1.151370 cos_to_last_merge=0.8906 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.891
[S6] round=12 local utility u=0.505754 metrics={'f1_val': 0.7094313864445069, 'auprc': 0.9621536996500535, 'loss_val': 0.4705868615540642, 'psi': 0.8105203117267255}-{'f1_val': 0.6320844295090634, 'auprc': 0.8072325579890756, 'loss_val': 0.5532501416495655, 'psi': 0.7021436809010683}
[S7] START round=12 head_norm_before_train=1.583837 (no previous merge yet)
[S7] round=12 local utility u=0.457136 metrics={'f1_val': 0.6983513274181774, 'auprc': 0.9686207019570053, 'loss_val': 0.3417083940954929, 'psi': 0.8064590772337086}-{'f1_val': 0.6514965102523799, 'auprc': 0.8244752006591707, 'loss_val': 0.5424143407876566, 'psi': 0.7206879864150961}
[S8] START round=12 head_norm_before_train=1.569007 (no previous merge yet)
[S8] round=12 local utility u=0.292600 metrics={'f1_val': 0.7008668384773251, 'auprc': 0.9751631567035413, 'loss_val': 0.2611376659874873, 'psi': 0.8105853657678115}-{'f1_val': 0.7140170479737811, 'auprc': 0.7933191470029778, 'loss_val': 0.37970752498668886, 'psi': 0.7457378875854598}
[S9] START round=12 head_norm_before_train=1.793632 (no previous merge yet)
[S9] round=12 local utility u=0.000181 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9971828944155139, 'loss_val': 0.034082213307216086, 'psi': 0.9968694648545404}-{'f1_val': 0.9971029125121428, 'auprc': 0.9978308371959772, 'loss_val': 0.0390426949945743, 'psi': 0.9973940823856766}
[S10] START round=12 head_norm_before_train=1.310036 cos_to_last_merge=0.8908 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.891
[S10] round=12 local utility u=0.026881 metrics={'f1_val': 0.6889385471580445, 'auprc': 0.9895936613738614, 'loss_val': 0.30247671244336777, 'psi': 0.8092005928443713}-{'f1_val': 0.6895054389966394, 'auprc': 0.9971942952761521, 'loss_val': 0.382441154665797, 'psi': 0.8125809815084445}
[S11] START round=12 head_norm_before_train=1.572835 (no previous merge yet)
[S11] round=12 local utility u=0.029151 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9978023983867041, 'loss_val': 0.2733606325081661, 'psi': 0.8201370471068365}-{'f1_val': 0.7019353166316534, 'auprc': 0.9981828148114469, 'loss_val': 0.3342547385282715, 'psi': 0.8204343159035707}
[S13] START round=12 head_norm_before_train=1.501177 (no previous merge yet)
[S13] round=12 local utility u=0.000000 metrics={'f1_val': 0.5676406110842988, 'auprc': 0.738097961063763, 'loss_val': 0.5898770106981773, 'psi': 0.6358235510760845}-{'f1_val': 0.7029836017902409, 'auprc': 0.7749063264038953, 'loss_val': 0.545182898762651, 'psi': 0.7317526916357027}
[S14] START round=12 head_norm_before_train=0.986428 cos_to_last_merge=1.0000 (last merge round=11)
[S14] round=12 local utility u=0.056667 metrics={'f1_val': 0.701819167019819, 'auprc': 0.9961044061460878, 'loss_val': 0.5312144068609872, 'psi': 0.8195332626703264}-{'f1_val': 0.7000211799134475, 'auprc': 0.9947808599127821, 'loss_val': 0.62979012371781, 'psi': 0.8179250519131813}
[S15] START round=12 head_norm_before_train=1.172904 cos_to_last_merge=1.0000 (last merge round=11)
[S15] round=12 local utility u=0.000000 metrics={'f1_val': 0.6954452623912982, 'auprc': 0.6489317872736776, 'loss_val': 0.6339031497787152, 'psi': 0.6768398723442499}-{'f1_val': 0.6976780473690661, 'auprc': 0.7560234616473973, 'loss_val': 0.6882020856513986, 'psi': 0.7210162130803985}
[S16] START round=12 head_norm_before_train=1.589724 cos_to_last_merge=1.0000 (last merge round=11)
[S16] round=12 local utility u=0.000000 metrics={'f1_val': 0.42690115275086865, 'auprc': 0.736163548369777, 'loss_val': 0.9135455445819135, 'psi': 0.5506061109984319}-{'f1_val': 0.5141017505460761, 'auprc': 0.7595327873231844, 'loss_val': 1.0040967308624595, 'psi': 0.6122741652569195}
[S17] START round=12 head_norm_before_train=1.087017 cos_to_last_merge=1.0000 (last merge round=11)
[S17] round=12 local utility u=0.154951 metrics={'f1_val': 0.3517738579689747, 'auprc': 0.6366105615030277, 'loss_val': 0.9306818932887955, 'psi': 0.46570853938259593}-{'f1_val': 0.3520340455881617, 'auprc': 0.524774130904955, 'loss_val': 0.9066347541949603, 'psi': 0.42113007971487904}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:41917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:41917
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:41909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:41916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:41903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:41916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:41914
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:41917
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:41904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:41916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S14] → sending delta(kind=head bytes=1790) to S11@127.0.0.1:41912
[S14] sending update (kind=head size=1790 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1799) from S10
[S8] cosine check vs S10: cos=-0.0181
[S8] DROPPED delta from S10 (cos=-0.0181 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1800) from S5
[S16] cosine check vs S5: cos=0.1147
[S11] RECEIVED delta(kind=head bytes=1790) from S14
[S11] cosine check vs S14: cos=-0.1071
[S11] DROPPED delta from S14 (cos=-0.1071 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1797) from S11
[S16] cosine check vs S11: cos=-0.1326
[S16] DROPPED delta from S11 (cos=-0.1326 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1803) from S9
[S16] cosine check vs S9: cos=0.9873
[S4] RECEIVED delta(kind=head bytes=1796) from S7
[S4] cosine check vs S7: cos=0.9885
[S17] RECEIVED delta(kind=head bytes=1801) from S6
[S17] cosine check vs S6: cos=0.4520
[S17] RECEIVED delta(kind=head bytes=1801) from S3
[S17] cosine check vs S3: cos=0.8712
[S17] RECEIVED delta(kind=head bytes=1800) from S2
[S17] cosine check vs S2: cos=-0.1798
[S17] DROPPED delta from S2 (cos=-0.1798 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1802) from S8
[S3] cosine check vs S8: cos=-0.1031
[S3] DROPPED delta from S8 (cos=-0.1031 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1796) from S4
[S14] cosine check vs S4: cos=-0.0505
[S14] DROPPED delta from S4 (cos=-0.0505 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:41914
[S17] sending update (kind=head size=1794 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1794) from S17
[S14] cosine check vs S17: cos=0.9496
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=12 metric=0.6871 head_norm=1.617689
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.225954e-01
[S4] stored merged vector for next round verification (round=12)
[S4] DEBUG after merge:  round=12 metric=0.6845 head_norm=1.605804 delta_norm=0.122595
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=12 metric=0.7018 head_norm=1.033185
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.762066e-01
[S14] stored merged vector for next round verification (round=12)
[S14] DEBUG after merge:  round=12 metric=0.7021 head_norm=1.062874 delta_norm=0.176207
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=12 metric=0.4269 head_norm=1.616868
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.751125e-01
[S16] stored merged vector for next round verification (round=12)
[S16] DEBUG after merge:  round=12 metric=0.4222 head_norm=1.355546 delta_norm=0.475112
[S16] aggregate: ACCEPT kept=['S5', 'S9'] (k=2/2) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=12 metric=0.3518 head_norm=1.119834
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.215269e-01
[S17] stored merged vector for next round verification (round=12)
[S17] DEBUG after merge:  round=12 metric=0.3517 head_norm=1.094427 delta_norm=0.121527
[S17] aggregate: ACCEPT kept=['S6', 'S3'] (k=2/2) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.123193 cos_to_last_merge=0.8612 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.861
[S2] round=13 local utility u=0.014545 metrics={'f1_val': 0.7124310448904925, 'auprc': 0.7835568797330985, 'loss_val': 0.5034254044083878, 'psi': 0.7408813788275349}-{'f1_val': 0.7094193366516226, 'auprc': 0.791631522991386, 'loss_val': 0.5386686760491367, 'psi': 0.742304211187528}
[S3] START round=13 head_norm_before_train=1.807681 (no previous merge yet)
[S3] round=13 local utility u=0.135059 metrics={'f1_val': 0.9973386888198309, 'auprc': 0.9986911313964504, 'loss_val': 0.0730292899074756, 'psi': 0.9978796658504787}-{'f1_val': 0.960531351117436, 'auprc': 0.9984833957270814, 'loss_val': 0.12167905970050859, 'psi': 0.9757121689612942}
[S4] START round=13 head_norm_before_train=1.605804 cos_to_last_merge=1.0000 (last merge round=12)
[S4] round=13 local utility u=0.000000 metrics={'f1_val': 0.6655370115691059, 'auprc': 0.8563028448062997, 'loss_val': 0.44943477290474565, 'psi': 0.7418433448639834}-{'f1_val': 0.6871212607327957, 'auprc': 0.8620164649764455, 'loss_val': 0.46640992649398927, 'psi': 0.7570793424302555}
[S5] START round=13 head_norm_before_train=1.648495 (no previous merge yet)
[S5] round=13 local utility u=0.253659 metrics={'f1_val': 0.722437772008086, 'auprc': 0.9924075343345682, 'loss_val': 0.25300638435740214, 'psi': 0.8304256769386789}-{'f1_val': 0.7154812603109921, 'auprc': 0.861175724953843, 'loss_val': 0.32489048579425234, 'psi': 0.7737590461681325}
[S6] START round=13 head_norm_before_train=1.190447 cos_to_last_merge=0.8823 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.882
[S6] round=13 local utility u=0.098256 metrics={'f1_val': 0.710795000545887, 'auprc': 0.9920364679002789, 'loss_val': 0.37190459293383393, 'psi': 0.8232915874876438}-{'f1_val': 0.7094313864445069, 'auprc': 0.9621536996500535, 'loss_val': 0.4705868615540642, 'psi': 0.8105203117267255}
[S7] START round=13 head_norm_before_train=1.603232 (no previous merge yet)
[S7] round=13 local utility u=0.054240 metrics={'f1_val': 0.6992322064854766, 'auprc': 0.9896771580125587, 'loss_val': 0.3016831352767111, 'psi': 0.8154101870963095}-{'f1_val': 0.6983513274181774, 'auprc': 0.9686207019570053, 'loss_val': 0.3417083940954929, 'psi': 0.8064590772337086}
[S8] START round=13 head_norm_before_train=1.598717 (no previous merge yet)
[S8] round=13 local utility u=0.929226 metrics={'f1_val': 0.9928968500159877, 'auprc': 0.991080225445014, 'loss_val': 0.2026164229947866, 'psi': 0.9921702001875983}-{'f1_val': 0.7008668384773251, 'auprc': 0.9751631567035413, 'loss_val': 0.2611376659874873, 'psi': 0.8105853657678115}
[S9] START round=13 head_norm_before_train=1.827767 (no previous merge yet)
[S9] round=13 local utility u=0.000000 metrics={'f1_val': 0.9939393793306803, 'auprc': 0.9992648482250366, 'loss_val': 0.032040284883300754, 'psi': 0.9960695668884229}-{'f1_val': 0.9966605118138915, 'auprc': 0.9971828944155139, 'loss_val': 0.034082213307216086, 'psi': 0.9968694648545404}
[S10] START round=13 head_norm_before_train=1.360958 cos_to_last_merge=0.8785 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.879
[S10] round=13 local utility u=0.069249 metrics={'f1_val': 0.7010620067420683, 'auprc': 0.9975797512152019, 'loss_val': 0.2606780506995683, 'psi': 0.8196691045313218}-{'f1_val': 0.6889385471580445, 'auprc': 0.9895936613738614, 'loss_val': 0.30247671244336777, 'psi': 0.8092005928443713}
[S11] START round=13 head_norm_before_train=1.618668 (no previous merge yet)
[S11] round=13 local utility u=0.012896 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9979659226103093, 'loss_val': 0.24950977693745632, 'psi': 0.8203475590231157}-{'f1_val': 0.7016934795869249, 'auprc': 0.9978023983867041, 'loss_val': 0.2733606325081661, 'psi': 0.8201370471068365}
[S13] START round=13 head_norm_before_train=1.530831 (no previous merge yet)
[S13] round=13 local utility u=0.378490 metrics={'f1_val': 0.6643642759351567, 'auprc': 0.7572819597453472, 'loss_val': 0.4707913795702351, 'psi': 0.7015313494592329}-{'f1_val': 0.5676406110842988, 'auprc': 0.738097961063763, 'loss_val': 0.5898770106981773, 'psi': 0.6358235510760845}
[S14] START round=13 head_norm_before_train=1.062874 cos_to_last_merge=1.0000 (last merge round=12)
[S14] round=13 local utility u=0.077896 metrics={'f1_val': 0.7206651797322694, 'auprc': 0.995917065548248, 'loss_val': 0.4879370308349005, 'psi': 0.8307659340586608}-{'f1_val': 0.701819167019819, 'auprc': 0.9961044061460878, 'loss_val': 0.5312144068609872, 'psi': 0.8195332626703264}
[S15] START round=13 head_norm_before_train=1.211354 cos_to_last_merge=0.9974 (last merge round=11)
[S15] round=13 local utility u=0.308999 metrics={'f1_val': 0.6415380968938068, 'auprc': 0.951259031672439, 'loss_val': 0.5994429733755999, 'psi': 0.7654264708052596}-{'f1_val': 0.6954452623912982, 'auprc': 0.6489317872736776, 'loss_val': 0.6339031497787152, 'psi': 0.6768398723442499}
[S16] START round=13 head_norm_before_train=1.355546 cos_to_last_merge=1.0000 (last merge round=12)
[S16] round=13 local utility u=0.774642 metrics={'f1_val': 0.65095562961947, 'auprc': 0.778234680744641, 'loss_val': 0.8348023324125758, 'psi': 0.7018672500695384}-{'f1_val': 0.42690115275086865, 'auprc': 0.736163548369777, 'loss_val': 0.9135455445819135, 'psi': 0.5506061109984319}
[S17] START round=13 head_norm_before_train=1.094427 cos_to_last_merge=1.0000 (last merge round=12)
[S17] round=13 local utility u=0.000000 metrics={'f1_val': 0.35213450160472937, 'auprc': 0.6346139285898508, 'loss_val': 0.9679340754976309, 'psi': 0.4651262723987779}-{'f1_val': 0.3517738579689747, 'auprc': 0.6366105615030277, 'loss_val': 0.9306818932887955, 'psi': 0.46570853938259593}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:41902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:41916
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:41913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:41903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:41912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:41909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:41916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:41904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:41915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:41917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S3] → sending delta(kind=head bytes=1807) to S17@127.0.0.1:41917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] → sending delta(kind=head bytes=1793) to S17@127.0.0.1:41917
[S3] sending update (kind=head size=1807 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1804 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1793 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1804) from S10
[S8] cosine check vs S10: cos=-0.0192
[S8] DROPPED delta from S10 (cos=-0.0192 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1801) from S11
[S16] cosine check vs S11: cos=-0.1126
[S16] DROPPED delta from S11 (cos=-0.1126 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1799) from S5
[S16] cosine check vs S5: cos=0.3738
[S17] RECEIVED delta(kind=head bytes=1793) from S6
[S17] cosine check vs S6: cos=0.4935
[S4] RECEIVED delta(kind=head bytes=1799) from S7
[S4] cosine check vs S7: cos=0.9935
[S17] RECEIVED delta(kind=head bytes=1807) from S3
[S17] cosine check vs S3: cos=0.8504
[S17] RECEIVED delta(kind=head bytes=1801) from S2
[S17] cosine check vs S2: cos=-0.1779
[S17] DROPPED delta from S2 (cos=-0.1779 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1802) from S8
[S3] cosine check vs S8: cos=-0.1062
[S3] DROPPED delta from S8 (cos=-0.1062 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1798) from S14
[S11] cosine check vs S14: cos=-0.1062
[S11] DROPPED delta from S14 (cos=-0.1062 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1800) from S16
[S15] cosine check vs S16: cos=0.9327
[S13] RECEIVED delta(kind=head bytes=1795) from S15
[S13] cosine check vs S15: cos=-0.0190
[S13] DROPPED delta from S15 (cos=-0.0190 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1800) from S13
[S2] cosine check vs S13: cos=-0.0777
[S2] DROPPED delta from S13 (cos=-0.0777 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=13 metric=0.6655 head_norm=1.646693
[S4] _apply_head_vector_avg (torch): Δ‖w‖=9.423181e-02
[S4] stored merged vector for next round verification (round=13)
[S4] DEBUG after merge:  round=13 metric=0.6656 head_norm=1.628656 delta_norm=0.094232
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=13 metric=0.6415 head_norm=1.251055
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.506931e-01
[S15] stored merged vector for next round verification (round=13)
[S15] DEBUG after merge:  round=13 metric=0.6255 head_norm=1.295794 delta_norm=0.250693
[S15] aggregate: ROLLBACK (f1_val pre=0.642 post=0.626 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=13 metric=0.6510 head_norm=1.385179
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.637893e-01
[S16] stored merged vector for next round verification (round=13)
[S16] DEBUG after merge:  round=13 metric=0.5306 head_norm=1.269740 delta_norm=0.863789
[S16] aggregate: ROLLBACK (f1_val pre=0.651 post=0.531 tol_abs=0.005 tol_rel=0.0)
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=13 metric=0.3521 head_norm=1.125260
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.057612e-01
[S17] stored merged vector for next round verification (round=13)
[S17] DEBUG after merge:  round=13 metric=0.3538 head_norm=1.112150 delta_norm=0.105761
[S17] aggregate: ACCEPT kept=['S6', 'S3'] (k=2/2) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.179829 cos_to_last_merge=0.8468 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.847
[S2] round=14 local utility u=0.127968 metrics={'f1_val': 0.6993242179817263, 'auprc': 0.8530561458361057, 'loss_val': 0.37734721832912743, 'psi': 0.7608169891234781}-{'f1_val': 0.7124310448904925, 'auprc': 0.7835568797330985, 'loss_val': 0.5034254044083878, 'psi': 0.7408813788275349}
[S3] START round=14 head_norm_before_train=1.848562 (no previous merge yet)
[S3] round=14 local utility u=0.000000 metrics={'f1_val': 0.8902380736371369, 'auprc': 0.9986173555160525, 'loss_val': 0.17848876064717795, 'psi': 0.933589786388703}-{'f1_val': 0.9973386888198309, 'auprc': 0.9986911313964504, 'loss_val': 0.0730292899074756, 'psi': 0.9978796658504787}
[S4] START round=14 head_norm_before_train=1.628656 cos_to_last_merge=1.0000 (last merge round=13)
[S4] round=14 local utility u=0.000000 metrics={'f1_val': 0.6189538174787734, 'auprc': 0.9435697182552875, 'loss_val': 0.45508360111319524, 'psi': 0.7488001777893791}-{'f1_val': 0.6655370115691059, 'auprc': 0.8563028448062997, 'loss_val': 0.44943477290474565, 'psi': 0.7418433448639834}
[S5] START round=14 head_norm_before_train=1.672729 (no previous merge yet)
[S5] round=14 local utility u=0.401743 metrics={'f1_val': 0.8426817247948937, 'auprc': 0.9942973265409827, 'loss_val': 0.17665339796202556, 'psi': 0.9033279654933293}-{'f1_val': 0.722437772008086, 'auprc': 0.9924075343345682, 'loss_val': 0.25300638435740214, 'psi': 0.8304256769386789}
[S6] START round=14 head_norm_before_train=1.228707 cos_to_last_merge=0.8748 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.875
[S6] round=14 local utility u=0.000000 metrics={'f1_val': 0.4352269588422223, 'auprc': 0.786801240126545, 'loss_val': 0.6915332872721816, 'psi': 0.5758566713559514}-{'f1_val': 0.710795000545887, 'auprc': 0.9920364679002789, 'loss_val': 0.37190459293383393, 'psi': 0.8232915874876438}
[S7] START round=14 head_norm_before_train=1.615921 (no previous merge yet)
[S7] round=14 local utility u=0.000000 metrics={'f1_val': 0.45360380026223746, 'auprc': 0.7788123408427032, 'loss_val': 0.8907097681788411, 'psi': 0.5836872164944238}-{'f1_val': 0.6992322064854766, 'auprc': 0.9896771580125587, 'loss_val': 0.3016831352767111, 'psi': 0.8154101870963095}
[S8] START round=14 head_norm_before_train=1.622271 (no previous merge yet)
[S8] round=14 local utility u=0.025207 metrics={'f1_val': 0.9942164279160668, 'auprc': 0.9937461809305139, 'loss_val': 0.16811688795127816, 'psi': 0.9940283291218457}-{'f1_val': 0.9928968500159877, 'auprc': 0.991080225445014, 'loss_val': 0.2026164229947866, 'psi': 0.9921702001875983}
[S9] START round=14 head_norm_before_train=1.852121 (no previous merge yet)
[S9] round=14 local utility u=0.007906 metrics={'f1_val': 0.9960207019771873, 'auprc': 0.9993385851171142, 'loss_val': 0.02893795038189115, 'psi': 0.997347855233158}-{'f1_val': 0.9939393793306803, 'auprc': 0.9992648482250366, 'loss_val': 0.032040284883300754, 'psi': 0.9960695668884229}
[S10] START round=14 head_norm_before_train=1.403392 cos_to_last_merge=0.8691 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.869
[S10] round=14 local utility u=0.000000 metrics={'f1_val': 0.6989245947104225, 'auprc': 0.9857303735342255, 'loss_val': 0.2223756838683465, 'psi': 0.8136469062399436}-{'f1_val': 0.7010620067420683, 'auprc': 0.9975797512152019, 'loss_val': 0.2606780506995683, 'psi': 0.8196691045313218}
[S11] START round=14 head_norm_before_train=1.654737 (no previous merge yet)
[S11] round=14 local utility u=0.787668 metrics={'f1_val': 0.9558909595383985, 'auprc': 0.9978941604927583, 'loss_val': 0.19769218761472226, 'psi': 0.9726922399201424}-{'f1_val': 0.7019353166316534, 'auprc': 0.9979659226103093, 'loss_val': 0.24950977693745632, 'psi': 0.8203475590231157}
[S13] START round=14 head_norm_before_train=1.550124 (no previous merge yet)
[S13] round=14 local utility u=0.075422 metrics={'f1_val': 0.6954736433198238, 'auprc': 0.7304438185016991, 'loss_val': 0.42608906464198737, 'psi': 0.7094617133925739}-{'f1_val': 0.6643642759351567, 'auprc': 0.7572819597453472, 'loss_val': 0.4707913795702351, 'psi': 0.7015313494592329}
[S14] START round=14 head_norm_before_train=1.106362 cos_to_last_merge=0.9976 (last merge round=12)
[S14] round=14 local utility u=0.882667 metrics={'f1_val': 0.9972568221074685, 'auprc': 0.997069929484483, 'loss_val': 0.3856114954153858, 'psi': 0.9971820650582743}-{'f1_val': 0.7206651797322694, 'auprc': 0.995917065548248, 'loss_val': 0.4879370308349005, 'psi': 0.8307659340586608}
[S15] START round=14 head_norm_before_train=1.295794 cos_to_last_merge=1.0000 (last merge round=13)
[S15] round=14 local utility u=0.000000 metrics={'f1_val': 0.7011100234866573, 'auprc': 0.7990658856966717, 'loss_val': 0.5178117504480543, 'psi': 0.740292368370663}-{'f1_val': 0.6415380968938068, 'auprc': 0.951259031672439, 'loss_val': 0.5994429733755999, 'psi': 0.7654264708052596}
[S16] START round=14 head_norm_before_train=1.269740 cos_to_last_merge=1.0000 (last merge round=13)
[S16] round=14 local utility u=0.000000 metrics={'f1_val': 0.5614874624198223, 'auprc': 0.8023712504046457, 'loss_val': 0.7834043958289014, 'psi': 0.6578409776137517}-{'f1_val': 0.65095562961947, 'auprc': 0.778234680744641, 'loss_val': 0.8348023324125758, 'psi': 0.7018672500695384}
[S17] START round=14 head_norm_before_train=1.112150 cos_to_last_merge=1.0000 (last merge round=13)
[S17] round=14 local utility u=0.053092 metrics={'f1_val': 0.3497893137688599, 'auprc': 0.6796130853109449, 'loss_val': 0.9826757029338421, 'psi': 0.48171882238569386}-{'f1_val': 0.35213450160472937, 'auprc': 0.6346139285898508, 'loss_val': 0.9679340754976309, 'psi': 0.4651262723987779}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:41917
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S8] → sending delta(kind=head bytes=1806) to S3@127.0.0.1:41903
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:41916
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:41916
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] → sending delta(kind=head bytes=1794) to S11@127.0.0.1:41912
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:41902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:41916
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1806 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1794 to 1 peers)
[S5] sending update (kind=head size=1804 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1804) from S5
[S16] cosine check vs S5: cos=0.8524
[S16] RECEIVED delta(kind=head bytes=1796) from S11
[S16] cosine check vs S11: cos=-0.0390
[S16] DROPPED delta from S11 (cos=-0.0390 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1800) from S9
[S16] cosine check vs S9: cos=0.5130
[S2] RECEIVED delta(kind=head bytes=1800) from S13
[S2] cosine check vs S13: cos=-0.0783
[S2] DROPPED delta from S13 (cos=-0.0783 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1800) from S2
[S17] cosine check vs S2: cos=-0.1754
[S17] DROPPED delta from S2 (cos=-0.1754 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1794) from S14
[S11] cosine check vs S14: cos=-0.1092
[S11] DROPPED delta from S14 (cos=-0.1092 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1806) from S8
[S3] cosine check vs S8: cos=-0.1107
[S3] DROPPED delta from S8 (cos=-0.1107 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:41914
[S17] sending update (kind=head size=1794 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1794) from S17
[S14] cosine check vs S17: cos=0.9538
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=14 metric=0.9973 head_norm=1.155413
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.747162e-01
[S14] stored merged vector for next round verification (round=14)
[S14] DEBUG after merge:  round=14 metric=0.9981 head_norm=1.135432 delta_norm=0.174716
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=14 metric=0.5615 head_norm=1.296191
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.012140e-01
[S16] stored merged vector for next round verification (round=14)
[S16] DEBUG after merge:  round=14 metric=0.5674 head_norm=1.265086 delta_norm=0.201214
[S16] aggregate: ACCEPT kept=['S5', 'S9'] (k=2/2) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.228772 cos_to_last_merge=0.8339 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.834
[S2] round=15 local utility u=0.000000 metrics={'f1_val': 0.6993069284354385, 'auprc': 0.7833753075047354, 'loss_val': 0.3503860784943308, 'psi': 0.7329342800631573}-{'f1_val': 0.6993242179817263, 'auprc': 0.8530561458361057, 'loss_val': 0.37734721832912743, 'psi': 0.7608169891234781}
[S3] START round=15 head_norm_before_train=1.888183 (no previous merge yet)
[S3] round=15 local utility u=0.390610 metrics={'f1_val': 0.9973696976584205, 'auprc': 0.9986813630694098, 'loss_val': 0.04024990892289438, 'psi': 0.9978943638228162}-{'f1_val': 0.8902380736371369, 'auprc': 0.9986173555160525, 'loss_val': 0.17848876064717795, 'psi': 0.933589786388703}
[S4] START round=15 head_norm_before_train=1.664410 cos_to_last_merge=0.9994 (last merge round=13)
[S4] round=15 local utility u=0.035567 metrics={'f1_val': 0.6255466788476216, 'auprc': 0.9500094877258438, 'loss_val': 0.4428251563422658, 'psi': 0.7553318023989105}-{'f1_val': 0.6189538174787734, 'auprc': 0.9435697182552875, 'loss_val': 0.45508360111319524, 'psi': 0.7488001777893791}
[S5] START round=15 head_norm_before_train=1.693126 (no previous merge yet)
[S5] round=15 local utility u=0.498508 metrics={'f1_val': 0.9963325909888239, 'auprc': 0.9972908397162781, 'loss_val': 0.11052248268756822, 'psi': 0.9967158904798055}-{'f1_val': 0.8426817247948937, 'auprc': 0.9942973265409827, 'loss_val': 0.17665339796202556, 'psi': 0.9033279654933293}
[S6] START round=15 head_norm_before_train=1.253521 cos_to_last_merge=0.8697 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.870
[S6] round=15 local utility u=1.000000 metrics={'f1_val': 0.7094983302739498, 'auprc': 0.9682215316899284, 'loss_val': 0.3502891988332942, 'psi': 0.8129876108403413}-{'f1_val': 0.4352269588422223, 'auprc': 0.786801240126545, 'loss_val': 0.6915332872721816, 'psi': 0.5758566713559514}
[S7] START round=15 head_norm_before_train=1.623380 (no previous merge yet)
[S7] round=15 local utility u=0.598643 metrics={'f1_val': 0.6089714961404507, 'auprc': 0.7903369162159637, 'loss_val': 0.6602045377681744, 'psi': 0.681517664170656}-{'f1_val': 0.45360380026223746, 'auprc': 0.7788123408427032, 'loss_val': 0.8907097681788411, 'psi': 0.5836872164944238}
[S8] START round=15 head_norm_before_train=1.645982 (no previous merge yet)
[S8] round=15 local utility u=0.000000 metrics={'f1_val': 0.7137538225988359, 'auprc': 0.9845886375793037, 'loss_val': 0.2382016737104151, 'psi': 0.8220877485910231}-{'f1_val': 0.9942164279160668, 'auprc': 0.9937461809305139, 'loss_val': 0.16811688795127816, 'psi': 0.9940283291218457}
[S9] START round=15 head_norm_before_train=1.878713 (no previous merge yet)
[S9] round=15 local utility u=0.001653 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9975517189329322, 'loss_val': 0.02526212436424412, 'psi': 0.9971322388285272}-{'f1_val': 0.9960207019771873, 'auprc': 0.9993385851171142, 'loss_val': 0.02893795038189115, 'psi': 0.997347855233158}
[S10] START round=15 head_norm_before_train=1.435256 cos_to_last_merge=0.8618 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.862
[S10] round=15 local utility u=0.049437 metrics={'f1_val': 0.7012497425290563, 'auprc': 0.9975504435329281, 'loss_val': 0.17291375236896386, 'psi': 0.819770022930605}-{'f1_val': 0.6989245947104225, 'auprc': 0.9857303735342255, 'loss_val': 0.2223756838683465, 'psi': 0.8136469062399436}
[S11] START round=15 head_norm_before_train=1.687898 (no previous merge yet)
[S11] round=15 local utility u=0.022349 metrics={'f1_val': 0.9585016148608851, 'auprc': 0.9978576450255848, 'loss_val': 0.16854860908993596, 'psi': 0.974244026926765}-{'f1_val': 0.9558909595383985, 'auprc': 0.9978941604927583, 'loss_val': 0.19769218761472226, 'psi': 0.9726922399201424}
[S13] START round=15 head_norm_before_train=1.566745 (no previous merge yet)
[S13] round=15 local utility u=0.000000 metrics={'f1_val': 0.6426422213679054, 'auprc': 0.6992861793605566, 'loss_val': 0.4642018850443771, 'psi': 0.6652998045649658}-{'f1_val': 0.6954736433198238, 'auprc': 0.7304438185016991, 'loss_val': 0.42608906464198737, 'psi': 0.7094617133925739}
[S14] START round=15 head_norm_before_train=1.135432 cos_to_last_merge=1.0000 (last merge round=14)
[S14] round=15 local utility u=0.000000 metrics={'f1_val': 0.9974331919232962, 'auprc': 0.9956344558279698, 'loss_val': 0.3939676795619841, 'psi': 0.9967136974851656}-{'f1_val': 0.9972568221074685, 'auprc': 0.997069929484483, 'loss_val': 0.3856114954153858, 'psi': 0.9971820650582743}
[S15] START round=15 head_norm_before_train=1.323161 cos_to_last_merge=0.9987 (last merge round=13)
[S15] round=15 local utility u=0.007683 metrics={'f1_val': 0.6943599007737464, 'auprc': 0.803843181029271, 'loss_val': 0.4762775056413607, 'psi': 0.7381532128759563}-{'f1_val': 0.7011100234866573, 'auprc': 0.7990658856966717, 'loss_val': 0.5178117504480543, 'psi': 0.740292368370663}
[S16] START round=15 head_norm_before_train=1.265086 cos_to_last_merge=1.0000 (last merge round=14)
[S16] round=15 local utility u=0.094062 metrics={'f1_val': 0.5612997115817648, 'auprc': 0.8529764396485842, 'loss_val': 0.7459688359226317, 'psi': 0.6779704028084925}-{'f1_val': 0.5614874624198223, 'auprc': 0.8023712504046457, 'loss_val': 0.7834043958289014, 'psi': 0.6578409776137517}
[S17] START round=15 head_norm_before_train=1.142141 cos_to_last_merge=0.9976 (last merge round=13)
[S17] round=15 local utility u=0.111558 metrics={'f1_val': 0.36170701480655115, 'auprc': 0.7221770616127591, 'loss_val': 0.9587579662390258, 'psi': 0.5058950335290343}-{'f1_val': 0.3497893137688599, 'auprc': 0.6796130853109449, 'loss_val': 0.9826757029338421, 'psi': 0.48171882238569386}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:41916
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:41917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] → sending delta(kind=head bytes=1794) to S17@127.0.0.1:41917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:41916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:41904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:41915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:41909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:41914
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:41916
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:41913
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1794 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1802) from S10
[S8] cosine check vs S10: cos=-0.0240
[S8] DROPPED delta from S10 (cos=-0.0240 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1795) from S9
[S16] cosine check vs S9: cos=0.6419
[S16] RECEIVED delta(kind=head bytes=1797) from S5
[S16] cosine check vs S5: cos=0.7611
[S16] RECEIVED delta(kind=head bytes=1802) from S11
[S16] cosine check vs S11: cos=-0.0563
[S16] DROPPED delta from S11 (cos=-0.0563 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1800) from S7
[S4] cosine check vs S7: cos=0.9934
[S17] RECEIVED delta(kind=head bytes=1794) from S6
[S17] cosine check vs S6: cos=0.5082
[S17] RECEIVED delta(kind=head bytes=1798) from S3
[S17] cosine check vs S3: cos=0.8300
[S14] RECEIVED delta(kind=head bytes=1801) from S4
[S14] cosine check vs S4: cos=-0.0527
[S14] DROPPED delta from S4 (cos=-0.0527 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1795) from S15
[S13] cosine check vs S15: cos=-0.0164
[S13] DROPPED delta from S15 (cos=-0.0164 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1802) from S16
[S15] cosine check vs S16: cos=0.8495
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:41914
[S17] sending update (kind=head size=1795 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1795) from S17
[S14] cosine check vs S17: cos=0.9788
[S8] ⇄ pheromone p=0.249 → S3@127.0.0.1:41903
[S2] ⇄ pheromone p=0.178 → S17@127.0.0.1:41917
[S13] ⇄ pheromone p=0.203 → S2@127.0.0.1:41902
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=15 metric=0.9974 head_norm=1.178627
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.210398e-01
[S14] stored merged vector for next round verification (round=15)
[S14] DEBUG after merge:  round=15 metric=0.9974 head_norm=1.169172 delta_norm=0.121040
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.327 → S11@127.0.0.1:41912
[S7] ⇄ pheromone p=0.277 → S4@127.0.0.1:41904
[S6] ⇄ pheromone p=0.409 → S17@127.0.0.1:41917
[S5] ⇄ pheromone p=0.305 → S16@127.0.0.1:41916
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=15 metric=0.6944 head_norm=1.352089
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.642359e-01
[S15] stored merged vector for next round verification (round=15)
[S15] DEBUG after merge:  round=15 metric=0.6923 head_norm=1.273329 delta_norm=0.364236
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.174 → S13@127.0.0.1:41913
[S3] ⇄ pheromone p=0.257 → S17@127.0.0.1:41917
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=15 metric=0.6255 head_norm=1.698643
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.007085e-01
[S4] stored merged vector for next round verification (round=15)
[S4] DEBUG after merge:  round=15 metric=0.6739 head_norm=1.664210 delta_norm=0.100708
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.205 → S14@127.0.0.1:41914
[S9] ⇄ pheromone p=0.114 → S16@127.0.0.1:41916
[S10] ⇄ pheromone p=0.136 → S8@127.0.0.1:41909
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=15 metric=0.5613 head_norm=1.296118
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.127845e-01
[S16] stored merged vector for next round verification (round=15)
[S16] DEBUG after merge:  round=15 metric=0.5594 head_norm=1.284825 delta_norm=0.112784
[S16] aggregate: ACCEPT kept=['S9', 'S5'] (k=2/2) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.245 → S15@127.0.0.1:41915
[S11] ⇄ pheromone p=0.270 → S16@127.0.0.1:41916
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=15 metric=0.3617 head_norm=1.172207
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.322152e-01
[S17] stored merged vector for next round verification (round=15)
[S17] DEBUG after merge:  round=15 metric=0.3598 head_norm=1.151969 delta_norm=0.132215
[S17] aggregate: ACCEPT kept=['S6', 'S3'] (k=2/2) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.115 → S14@127.0.0.1:41914
[S2] START round=16 head_norm_before_train=1.271723 cos_to_last_merge=0.8221 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.822
[S2] round=16 local utility u=0.289067 metrics={'f1_val': 0.696265786032945, 'auprc': 0.9784352911565218, 'loss_val': 0.3391847605113271, 'psi': 0.8091335880823758}-{'f1_val': 0.6993069284354385, 'auprc': 0.7833753075047354, 'loss_val': 0.3503860784943308, 'psi': 0.7329342800631573}
[S3] START round=16 head_norm_before_train=1.911418 (no previous merge yet)
[S3] round=16 local utility u=0.000000 metrics={'f1_val': 0.960995754132836, 'auprc': 0.9985887723221536, 'loss_val': 0.07952393020734971, 'psi': 0.9760329614085631}-{'f1_val': 0.9973696976584205, 'auprc': 0.9986813630694098, 'loss_val': 0.04024990892289438, 'psi': 0.9978943638228162}
[S4] START round=16 head_norm_before_train=1.664210 cos_to_last_merge=1.0000 (last merge round=15)
[S4] round=16 local utility u=0.046270 metrics={'f1_val': 0.6382248050518039, 'auprc': 0.953043754926399, 'loss_val': 0.43545722850579466, 'psi': 0.764152385001642}-{'f1_val': 0.6255466788476216, 'auprc': 0.9500094877258438, 'loss_val': 0.4428251563422658, 'psi': 0.7553318023989105}
[S5] START round=16 head_norm_before_train=1.714169 (no previous merge yet)
[S5] round=16 local utility u=0.000000 metrics={'f1_val': 0.9944831764737069, 'auprc': 0.9943319063971996, 'loss_val': 0.11585250122610632, 'psi': 0.9944226684431039}-{'f1_val': 0.9963325909888239, 'auprc': 0.9972908397162781, 'loss_val': 0.11052248268756822, 'psi': 0.9967158904798055}
[S6] START round=16 head_norm_before_train=1.274937 cos_to_last_merge=0.8656 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.866
[S6] round=16 local utility u=0.000000 metrics={'f1_val': 0.6202896476629958, 'auprc': 0.8866187720579739, 'loss_val': 0.4684869241824714, 'psi': 0.726821297420987}-{'f1_val': 0.7094983302739498, 'auprc': 0.9682215316899284, 'loss_val': 0.3502891988332942, 'psi': 0.8129876108403413}
[S7] START round=16 head_norm_before_train=1.635263 (no previous merge yet)
[S7] round=16 local utility u=0.505265 metrics={'f1_val': 0.6882471057881431, 'auprc': 0.8720993087998592, 'loss_val': 0.37061503164628945, 'psi': 0.7617879869928295}-{'f1_val': 0.6089714961404507, 'auprc': 0.7903369162159637, 'loss_val': 0.6602045377681744, 'psi': 0.681517664170656}
[S8] START round=16 head_norm_before_train=1.674461 (no previous merge yet)
[S8] round=16 local utility u=0.903759 metrics={'f1_val': 0.9931148882341876, 'auprc': 0.9912303435232467, 'loss_val': 0.12677468122429592, 'psi': 0.9923610703498112}-{'f1_val': 0.7137538225988359, 'auprc': 0.9845886375793037, 'loss_val': 0.2382016737104151, 'psi': 0.8220877485910231}
[S9] START round=16 head_norm_before_train=1.905385 (no previous merge yet)
[S9] round=16 local utility u=0.000000 metrics={'f1_val': 0.9893026945281196, 'auprc': 0.9996303042031037, 'loss_val': 0.03834390038586191, 'psi': 0.9934337383981132}-{'f1_val': 0.9968525854255906, 'auprc': 0.9975517189329322, 'loss_val': 0.02526212436424412, 'psi': 0.9971322388285272}
[S10] START round=16 head_norm_before_train=1.462024 cos_to_last_merge=0.8556 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.856
[S10] round=16 local utility u=0.876677 metrics={'f1_val': 0.9949268185006215, 'auprc': 0.9943246360724914, 'loss_val': 0.17194485798505932, 'psi': 0.9946859455293695}-{'f1_val': 0.7012497425290563, 'auprc': 0.9975504435329281, 'loss_val': 0.17291375236896386, 'psi': 0.819770022930605}
[S11] START round=16 head_norm_before_train=1.719682 (no previous merge yet)
[S11] round=16 local utility u=0.002919 metrics={'f1_val': 0.9594785939218595, 'auprc': 0.9980082139117441, 'loss_val': 0.16902482521434437, 'psi': 0.9748904419178134}-{'f1_val': 0.9585016148608851, 'auprc': 0.9978576450255848, 'loss_val': 0.16854860908993596, 'psi': 0.974244026926765}
[S13] START round=16 head_norm_before_train=1.580884 (no previous merge yet)
[S13] round=16 local utility u=0.000000 metrics={'f1_val': 0.6254024109995405, 'auprc': 0.6903512880434826, 'loss_val': 0.5281801784823068, 'psi': 0.6513819618171173}-{'f1_val': 0.6426422213679054, 'auprc': 0.6992861793605566, 'loss_val': 0.4642018850443771, 'psi': 0.6652998045649658}
[S14] START round=16 head_norm_before_train=1.169172 cos_to_last_merge=1.0000 (last merge round=15)
[S14] round=16 local utility u=0.034349 metrics={'f1_val': 0.9983050875260411, 'auprc': 0.9969625039862521, 'loss_val': 0.33448548809507367, 'psi': 0.9977680541101255}-{'f1_val': 0.9974331919232962, 'auprc': 0.9956344558279698, 'loss_val': 0.3939676795619841, 'psi': 0.9967136974851656}
[S15] START round=16 head_norm_before_train=1.273329 cos_to_last_merge=1.0000 (last merge round=15)
[S15] round=16 local utility u=0.105268 metrics={'f1_val': 0.6974853252969397, 'auprc': 0.8685040664190586, 'loss_val': 0.47847633410788454, 'psi': 0.7658928217457873}-{'f1_val': 0.6943599007737464, 'auprc': 0.803843181029271, 'loss_val': 0.4762775056413607, 'psi': 0.7381532128759563}
[S16] START round=16 head_norm_before_train=1.284825 cos_to_last_merge=1.0000 (last merge round=15)
[S16] round=16 local utility u=1.000000 metrics={'f1_val': 0.8642981860139491, 'auprc': 0.9204988909104252, 'loss_val': 0.5729548587720061, 'psi': 0.8867784679725396}-{'f1_val': 0.5612997115817648, 'auprc': 0.8529764396485842, 'loss_val': 0.7459688359226317, 'psi': 0.6779704028084925}
[S17] START round=16 head_norm_before_train=1.151969 cos_to_last_merge=1.0000 (last merge round=15)
[S17] round=16 local utility u=0.176747 metrics={'f1_val': 0.36995396019687626, 'auprc': 0.8206340195494923, 'loss_val': 0.9501157443052389, 'psi': 0.5502259839379227}-{'f1_val': 0.36170701480655115, 'auprc': 0.7221770616127591, 'loss_val': 0.9587579662390258, 'psi': 0.5058950335290343}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:41917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:41915
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:41912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:41904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:41909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S4] → sending delta(kind=head bytes=1792) to S14@127.0.0.1:41914
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:41903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:41916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:41913
[S14] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1792 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1802 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1800) from S10
[S8] cosine check vs S10: cos=-0.0272
[S8] DROPPED delta from S10 (cos=-0.0272 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1801) from S11
[S16] cosine check vs S11: cos=-0.0629
[S16] DROPPED delta from S11 (cos=-0.0629 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1796) from S7
[S4] cosine check vs S7: cos=0.9965
[S17] RECEIVED delta(kind=head bytes=1801) from S2
[S17] cosine check vs S2: cos=-0.1721
[S17] DROPPED delta from S2 (cos=-0.1721 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1803) from S15
[S13] cosine check vs S15: cos=-0.0258
[S13] DROPPED delta from S15 (cos=-0.0258 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1801) from S8
[S3] cosine check vs S8: cos=-0.1174
[S3] DROPPED delta from S8 (cos=-0.1174 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1792) from S4
[S14] cosine check vs S4: cos=-0.0570
[S14] DROPPED delta from S4 (cos=-0.0570 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1802) from S16
[S15] cosine check vs S16: cos=0.9671
[S11] RECEIVED delta(kind=head bytes=1802) from S14
[S11] cosine check vs S14: cos=-0.1133
[S11] DROPPED delta from S14 (cos=-0.1133 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:41914
[S17] sending update (kind=head size=1796 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1796) from S17
[S14] cosine check vs S17: cos=0.9837
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=16 metric=0.9983 head_norm=1.214083
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.094175e-01
[S14] stored merged vector for next round verification (round=16)
[S14] DEBUG after merge:  round=16 metric=0.9979 head_norm=1.189899 delta_norm=0.109418
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=16 metric=0.6975 head_norm=1.302078
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.684886e-01
[S15] stored merged vector for next round verification (round=16)
[S15] DEBUG after merge:  round=16 metric=0.6971 head_norm=1.300424 delta_norm=0.168489
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=16 metric=0.6382 head_norm=1.695565
[S4] _apply_head_vector_avg (torch): Δ‖w‖=7.347945e-02
[S4] stored merged vector for next round verification (round=16)
[S4] DEBUG after merge:  round=16 metric=0.6702 head_norm=1.672610 delta_norm=0.073479
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.310240 cos_to_last_merge=0.8120 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.812
[S2] round=17 local utility u=0.013790 metrics={'f1_val': 0.6969865609021697, 'auprc': 0.9793485374398304, 'loss_val': 0.31866881450334605, 'psi': 0.8099313515172339}-{'f1_val': 0.696265786032945, 'auprc': 0.9784352911565218, 'loss_val': 0.3391847605113271, 'psi': 0.8091335880823758}
[S3] START round=17 head_norm_before_train=1.931895 (no previous merge yet)
[S3] round=17 local utility u=0.000000 metrics={'f1_val': 0.9612503732185909, 'auprc': 0.9987585649149687, 'loss_val': 0.09242794945130524, 'psi': 0.976253649897142}-{'f1_val': 0.960995754132836, 'auprc': 0.9985887723221536, 'loss_val': 0.07952393020734971, 'psi': 0.9760329614085631}
[S4] START round=17 head_norm_before_train=1.672610 cos_to_last_merge=1.0000 (last merge round=16)
[S4] round=17 local utility u=0.939232 metrics={'f1_val': 0.9447195425021023, 'auprc': 0.9471872230216306, 'loss_val': 0.3783923045224634, 'psi': 0.9457066147099136}-{'f1_val': 0.6382248050518039, 'auprc': 0.953043754926399, 'loss_val': 0.43545722850579466, 'psi': 0.764152385001642}
[S5] START round=17 head_norm_before_train=1.732468 (no previous merge yet)
[S5] round=17 local utility u=0.000000 metrics={'f1_val': 0.7725387157696946, 'auprc': 0.9916589252041906, 'loss_val': 0.18615367784819015, 'psi': 0.8601867995434931}-{'f1_val': 0.9944831764737069, 'auprc': 0.9943319063971996, 'loss_val': 0.11585250122610632, 'psi': 0.9944226684431039}
[S6] START round=17 head_norm_before_train=1.298662 cos_to_last_merge=0.8621 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.862
[S6] round=17 local utility u=0.523702 metrics={'f1_val': 0.7100299290829509, 'auprc': 0.9910335494765268, 'loss_val': 0.27276858328127584, 'psi': 0.8224313772403813}-{'f1_val': 0.6202896476629958, 'auprc': 0.8866187720579739, 'loss_val': 0.4684869241824714, 'psi': 0.726821297420987}
[S7] START round=17 head_norm_before_train=1.652605 (no previous merge yet)
[S7] round=17 local utility u=0.000000 metrics={'f1_val': 0.6695948391042679, 'auprc': 0.8277373562123902, 'loss_val': 0.43511683619837965, 'psi': 0.7328518459475168}-{'f1_val': 0.6882471057881431, 'auprc': 0.8720993087998592, 'loss_val': 0.37061503164628945, 'psi': 0.7617879869928295}
[S8] START round=17 head_norm_before_train=1.702557 (no previous merge yet)
[S8] round=17 local utility u=0.000000 metrics={'f1_val': 0.9920372758728229, 'auprc': 0.9861143559845698, 'loss_val': 0.12071960221699796, 'psi': 0.9896681079175216}-{'f1_val': 0.9931148882341876, 'auprc': 0.9912303435232467, 'loss_val': 0.12677468122429592, 'psi': 0.9923610703498112}
[S9] START round=17 head_norm_before_train=1.921783 (no previous merge yet)
[S9] round=17 local utility u=0.030445 metrics={'f1_val': 0.9968497224526777, 'auprc': 0.9996152043160548, 'loss_val': 0.022691501257880105, 'psi': 0.9979559151980286}-{'f1_val': 0.9893026945281196, 'auprc': 0.9996303042031037, 'loss_val': 0.03834390038586191, 'psi': 0.9934337383981132}
[S10] START round=17 head_norm_before_train=1.482489 cos_to_last_merge=0.8507 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.851
[S10] round=17 local utility u=0.027052 metrics={'f1_val': 0.9957529764387818, 'auprc': 0.9975190933809451, 'loss_val': 0.13238093603487575, 'psi': 0.9964594232156472}-{'f1_val': 0.9949268185006215, 'auprc': 0.9943246360724914, 'loss_val': 0.17194485798505932, 'psi': 0.9946859455293695}
[S11] START round=17 head_norm_before_train=1.741614 (no previous merge yet)
[S11] round=17 local utility u=0.021832 metrics={'f1_val': 0.9606881915366148, 'auprc': 0.9979721470915455, 'loss_val': 0.1325095379550954, 'psi': 0.9756017737585871}-{'f1_val': 0.9594785939218595, 'auprc': 0.9980082139117441, 'loss_val': 0.16902482521434437, 'psi': 0.9748904419178134}
[S13] START round=17 head_norm_before_train=1.600865 (no previous merge yet)
[S13] round=17 local utility u=0.000000 metrics={'f1_val': 0.6229456774499074, 'auprc': 0.6863541274243123, 'loss_val': 0.5401262147679946, 'psi': 0.6483090574396693}-{'f1_val': 0.6254024109995405, 'auprc': 0.6903512880434826, 'loss_val': 0.5281801784823068, 'psi': 0.6513819618171173}
[S14] START round=17 head_norm_before_train=1.189899 cos_to_last_merge=1.0000 (last merge round=16)
[S14] round=17 local utility u=0.007515 metrics={'f1_val': 0.9970198446089119, 'auprc': 0.996973030370617, 'loss_val': 0.31177537920852305, 'psi': 0.9970011189135939}-{'f1_val': 0.9983050875260411, 'auprc': 0.9969625039862521, 'loss_val': 0.33448548809507367, 'psi': 0.9977680541101255}
[S15] START round=17 head_norm_before_train=1.300424 cos_to_last_merge=1.0000 (last merge round=16)
[S15] round=17 local utility u=0.194055 metrics={'f1_val': 0.6994936623734509, 'auprc': 0.9803618862982147, 'loss_val': 0.43798907539491344, 'psi': 0.8118409519433565}-{'f1_val': 0.6974853252969397, 'auprc': 0.8685040664190586, 'loss_val': 0.47847633410788454, 'psi': 0.7658928217457873}
[S16] START round=17 head_norm_before_train=1.320444 cos_to_last_merge=0.9989 (last merge round=15)
[S16] round=17 local utility u=0.210469 metrics={'f1_val': 0.9087501357806251, 'auprc': 0.9374770000592173, 'loss_val': 0.469662630776483, 'psi': 0.920240881492062}-{'f1_val': 0.8642981860139491, 'auprc': 0.9204988909104252, 'loss_val': 0.5729548587720061, 'psi': 0.8867784679725396}
[S17] START round=17 head_norm_before_train=1.175442 cos_to_last_merge=0.9987 (last merge round=15)
[S17] round=17 local utility u=0.446573 metrics={'f1_val': 0.5163149475044126, 'auprc': 0.7743916355233942, 'loss_val': 0.7964089175174556, 'psi': 0.6195456227120053}-{'f1_val': 0.36995396019687626, 'auprc': 0.8206340195494923, 'loss_val': 0.9501157443052389, 'psi': 0.5502259839379227}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:41917
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] → sending delta(kind=head bytes=1805) to S17@127.0.0.1:41917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:41916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S16] → sending delta(kind=head bytes=1807) to S15@127.0.0.1:41915
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:41916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] → sending delta(kind=head bytes=1805) to S8@127.0.0.1:41909
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:41913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:41914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:41912
[S4] sending update (kind=head size=1795 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1805 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1807 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1805 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1800) from S14
[S11] cosine check vs S14: cos=-0.1128
[S11] DROPPED delta from S14 (cos=-0.1128 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1799) from S15
[S13] cosine check vs S15: cos=-0.0303
[S13] DROPPED delta from S15 (cos=-0.0303 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1805) from S10
[S8] cosine check vs S10: cos=-0.0295
[S8] DROPPED delta from S10 (cos=-0.0295 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1800) from S9
[S16] cosine check vs S9: cos=0.7055
[S16] RECEIVED delta(kind=head bytes=1798) from S11
[S16] cosine check vs S11: cos=-0.0637
[S16] DROPPED delta from S11 (cos=-0.0637 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1807) from S16
[S15] cosine check vs S16: cos=0.9844
[S17] RECEIVED delta(kind=head bytes=1805) from S2
[S17] cosine check vs S2: cos=-0.1724
[S17] DROPPED delta from S2 (cos=-0.1724 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1801) from S6
[S17] cosine check vs S6: cos=0.5214
[S14] RECEIVED delta(kind=head bytes=1795) from S4
[S14] cosine check vs S4: cos=-0.0569
[S14] DROPPED delta from S4 (cos=-0.0569 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:41914
[S17] sending update (kind=head size=1798 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1798) from S17
[S14] cosine check vs S17: cos=0.9895
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=17 metric=0.9088 head_norm=1.357639
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.868632e-01
[S16] stored merged vector for next round verification (round=17)
[S16] DEBUG after merge:  round=17 metric=0.8757 head_norm=1.525834 delta_norm=0.686863
[S16] aggregate: ROLLBACK (f1_val pre=0.909 post=0.876 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=17 metric=0.6995 head_norm=1.332968
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.194996e-01
[S15] stored merged vector for next round verification (round=17)
[S15] DEBUG after merge:  round=17 metric=0.6990 head_norm=1.340042 delta_norm=0.119500
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=17 metric=0.9970 head_norm=1.232485
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.954172e-02
[S14] stored merged vector for next round verification (round=17)
[S14] DEBUG after merge:  round=17 metric=0.9970 head_norm=1.213147 delta_norm=0.089542
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=17 metric=0.5163 head_norm=1.200194
[S17] _apply_head_vector_avg (torch): Δ‖w‖=6.187847e-01
[S17] stored merged vector for next round verification (round=17)
[S17] DEBUG after merge:  round=17 metric=0.3690 head_norm=1.099716 delta_norm=0.618785
[S17] aggregate: ROLLBACK (f1_val pre=0.516 post=0.369 tol_abs=0.005 tol_rel=0.0)
[S2] START round=18 head_norm_before_train=1.344762 cos_to_last_merge=0.8050 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.805
[S2] round=18 local utility u=0.000000 metrics={'f1_val': 0.6995047009396205, 'auprc': 0.851947076587448, 'loss_val': 0.29630573856667536, 'psi': 0.7604816511987516}-{'f1_val': 0.6969865609021697, 'auprc': 0.9793485374398304, 'loss_val': 0.31866881450334605, 'psi': 0.8099313515172339}
[S3] START round=18 head_norm_before_train=1.951681 (no previous merge yet)
[S3] round=18 local utility u=0.139254 metrics={'f1_val': 0.9977814963782642, 'auprc': 0.998658969337683, 'loss_val': 0.03280831748798571, 'psi': 0.9981324855620317}-{'f1_val': 0.9612503732185909, 'auprc': 0.9987585649149687, 'loss_val': 0.09242794945130524, 'psi': 0.976253649897142}
[S4] START round=18 head_norm_before_train=1.697703 cos_to_last_merge=0.9997 (last merge round=16)
[S4] round=18 local utility u=0.000000 metrics={'f1_val': 0.9460697749543885, 'auprc': 0.9184464983718623, 'loss_val': 0.37298460776898656, 'psi': 0.935020464321378}-{'f1_val': 0.9447195425021023, 'auprc': 0.9471872230216306, 'loss_val': 0.3783923045224634, 'psi': 0.9457066147099136}
[S5] START round=18 head_norm_before_train=1.748277 (no previous merge yet)
[S5] round=18 local utility u=0.739489 metrics={'f1_val': 0.9963325909888239, 'auprc': 0.9975136354348345, 'loss_val': 0.06750401429944038, 'psi': 0.9968050087672281}-{'f1_val': 0.7725387157696946, 'auprc': 0.9916589252041906, 'loss_val': 0.18615367784819015, 'psi': 0.8601867995434931}
[S6] START round=18 head_norm_before_train=1.320634 cos_to_last_merge=0.8586 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.859
[S6] round=18 local utility u=0.000000 metrics={'f1_val': 0.5700830612171512, 'auprc': 0.8067953807779529, 'loss_val': 0.5887416704637609, 'psi': 0.6647679890414719}-{'f1_val': 0.7100299290829509, 'auprc': 0.9910335494765268, 'loss_val': 0.27276858328127584, 'psi': 0.8224313772403813}
[S7] START round=18 head_norm_before_train=1.662125 (no previous merge yet)
[S7] round=18 local utility u=0.082634 metrics={'f1_val': 0.6810721016552522, 'auprc': 0.8444716054129535, 'loss_val': 0.3889156315156363, 'psi': 0.7464319031583329}-{'f1_val': 0.6695948391042679, 'auprc': 0.8277373562123902, 'loss_val': 0.43511683619837965, 'psi': 0.7328518459475168}
[S8] START round=18 head_norm_before_train=1.729467 (no previous merge yet)
[S8] round=18 local utility u=0.000000 metrics={'f1_val': 0.9233711334553873, 'auprc': 0.9844584050255045, 'loss_val': 0.14894651283846647, 'psi': 0.9478060420834342}-{'f1_val': 0.9920372758728229, 'auprc': 0.9861143559845698, 'loss_val': 0.12071960221699796, 'psi': 0.9896681079175216}
[S9] START round=18 head_norm_before_train=1.938225 (no previous merge yet)
[S9] round=18 local utility u=0.000062 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.998665220287234, 'loss_val': 0.021236065913118468, 'psi': 0.9977278356221793}-{'f1_val': 0.9968497224526777, 'auprc': 0.9996152043160548, 'loss_val': 0.022691501257880105, 'psi': 0.9979559151980286}
[S10] START round=18 head_norm_before_train=1.497837 cos_to_last_merge=0.8473 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.847
[S10] round=18 local utility u=0.006933 metrics={'f1_val': 0.99659183488934, 'auprc': 0.9975134804735393, 'loss_val': 0.1235315494410532, 'psi': 0.9969604931230196}-{'f1_val': 0.9957529764387818, 'auprc': 0.9975190933809451, 'loss_val': 0.13238093603487575, 'psi': 0.9964594232156472}
[S11] START round=18 head_norm_before_train=1.762477 (no previous merge yet)
[S11] round=18 local utility u=0.014611 metrics={'f1_val': 0.9625590607840917, 'auprc': 0.9978659362871009, 'loss_val': 0.1141950730872613, 'psi': 0.9766818109852954}-{'f1_val': 0.9606881915366148, 'auprc': 0.9979721470915455, 'loss_val': 0.1325095379550954, 'psi': 0.9756017737585871}
[S13] START round=18 head_norm_before_train=1.617871 (no previous merge yet)
[S13] round=18 local utility u=0.000000 metrics={'f1_val': 0.6144639389655284, 'auprc': 0.6864822020913661, 'loss_val': 0.621111370843936, 'psi': 0.6432712442158635}-{'f1_val': 0.6229456774499074, 'auprc': 0.6863541274243123, 'loss_val': 0.5401262147679946, 'psi': 0.6483090574396693}
[S14] START round=18 head_norm_before_train=1.213147 cos_to_last_merge=1.0000 (last merge round=17)
[S14] round=18 local utility u=0.018576 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9969566388290829, 'loss_val': 0.2769040518316794, 'psi': 0.9972276172326685}-{'f1_val': 0.9970198446089119, 'auprc': 0.996973030370617, 'loss_val': 0.31177537920852305, 'psi': 0.9970011189135939}
[S15] START round=18 head_norm_before_train=1.340042 cos_to_last_merge=1.0000 (last merge round=17)
[S15] round=18 local utility u=0.016073 metrics={'f1_val': 0.6987927201817774, 'auprc': 0.9815300050369972, 'loss_val': 0.4051423808264054, 'psi': 0.8118876341238653}-{'f1_val': 0.6994936623734509, 'auprc': 0.9803618862982147, 'loss_val': 0.43798907539491344, 'psi': 0.8118409519433565}
[S16] START round=18 head_norm_before_train=1.525834 cos_to_last_merge=1.0000 (last merge round=17)
[S16] round=18 local utility u=0.000000 metrics={'f1_val': 0.8563254323123559, 'auprc': 0.9640472100009877, 'loss_val': 0.5454464347240703, 'psi': 0.8994141433878087}-{'f1_val': 0.9087501357806251, 'auprc': 0.9374770000592173, 'loss_val': 0.469662630776483, 'psi': 0.920240881492062}
[S17] START round=18 head_norm_before_train=1.099716 cos_to_last_merge=1.0000 (last merge round=17)
[S17] round=18 local utility u=0.000000 metrics={'f1_val': 0.38791867359973975, 'auprc': 0.8320548905895415, 'loss_val': 0.7656652171502702, 'psi': 0.5655731603956604}-{'f1_val': 0.5163149475044126, 'auprc': 0.7743916355233942, 'loss_val': 0.7964089175174556, 'psi': 0.6195456227120053}
[S15] not sending this round → trigger blocked (psi=0.812)
[S9] not sending this round → trigger blocked (psi=0.998)
[S14] not sending this round → trigger blocked (psi=0.997)
[S11] not sending this round → trigger blocked (psi=0.977)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:41917
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S5] → sending delta(kind=head bytes=1806) to S16@127.0.0.1:41916
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:41904
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.997)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1806 to 1 peers)
[S3] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1806) from S5
[S16] cosine check vs S5: cos=0.3117
[S17] RECEIVED delta(kind=head bytes=1803) from S3
[S17] cosine check vs S3: cos=0.4541
[S4] RECEIVED delta(kind=head bytes=1802) from S7
[S4] cosine check vs S7: cos=0.9958
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=18 metric=0.9461 head_norm=1.717689
[S4] _apply_head_vector_avg (torch): Δ‖w‖=8.039282e-02
[S4] stored merged vector for next round verification (round=18)
[S4] DEBUG after merge:  round=18 metric=0.9458 head_norm=1.693850 delta_norm=0.080393
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=18 metric=0.3879 head_norm=1.121166
[S17] _apply_head_vector_avg (torch): Δ‖w‖=8.857503e-01
[S17] stored merged vector for next round verification (round=18)
[S17] DEBUG after merge:  round=18 metric=0.3923 head_norm=1.337359 delta_norm=0.885750
[S17] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=18 metric=0.8563 head_norm=1.564699
[S16] _apply_head_vector_avg (torch): Δ‖w‖=9.798046e-01
[S16] stored merged vector for next round verification (round=18)
[S16] DEBUG after merge:  round=18 metric=0.8573 head_norm=1.349192 delta_norm=0.979805
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.375615 cos_to_last_merge=0.7993 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.799
[S2] round=19 local utility u=0.000000 metrics={'f1_val': 0.7088967680251086, 'auprc': 0.7852205383891115, 'loss_val': 0.4473415900331545, 'psi': 0.7394262761707098}-{'f1_val': 0.6995047009396205, 'auprc': 0.851947076587448, 'loss_val': 0.29630573856667536, 'psi': 0.7604816511987516}
[S3] START round=19 head_norm_before_train=1.972093 (no previous merge yet)
[S3] round=19 local utility u=0.000000 metrics={'f1_val': 0.9965365984006044, 'auprc': 0.9986473454434528, 'loss_val': 0.03544953531677397, 'psi': 0.9973808972177438}-{'f1_val': 0.9977814963782642, 'auprc': 0.998658969337683, 'loss_val': 0.03280831748798571, 'psi': 0.9981324855620317}
[S4] START round=19 head_norm_before_train=1.693850 cos_to_last_merge=1.0000 (last merge round=18)
[S4] round=19 local utility u=0.082346 metrics={'f1_val': 0.9449142626994429, 'auprc': 0.952236142109661, 'loss_val': 0.30272789393415706, 'psi': 0.9478430144635301}-{'f1_val': 0.9460697749543885, 'auprc': 0.9184464983718623, 'loss_val': 0.37298460776898656, 'psi': 0.935020464321378}
[S5] START round=19 head_norm_before_train=1.764197 (no previous merge yet)
[S5] round=19 local utility u=0.000000 metrics={'f1_val': 0.995817293346464, 'auprc': 0.9935620352312664, 'loss_val': 0.07467031643838465, 'psi': 0.994915190100385}-{'f1_val': 0.9963325909888239, 'auprc': 0.9975136354348345, 'loss_val': 0.06750401429944038, 'psi': 0.9968050087672281}
[S6] START round=19 head_norm_before_train=1.337209 cos_to_last_merge=0.8560 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.856
[S6] round=19 local utility u=1.000000 metrics={'f1_val': 0.9612752765452476, 'auprc': 0.9701911555147494, 'loss_val': 0.2658882582056459, 'psi': 0.9648416281330483}-{'f1_val': 0.5700830612171512, 'auprc': 0.8067953807779529, 'loss_val': 0.5887416704637609, 'psi': 0.6647679890414719}
[S7] START round=19 head_norm_before_train=1.673537 (no previous merge yet)
[S7] round=19 local utility u=0.000000 metrics={'f1_val': 0.5862040342911012, 'auprc': 0.7879868818007838, 'loss_val': 0.6959084918274231, 'psi': 0.6669171732949744}-{'f1_val': 0.6810721016552522, 'auprc': 0.8444716054129535, 'loss_val': 0.3889156315156363, 'psi': 0.7464319031583329}
[S8] START round=19 head_norm_before_train=1.756405 (no previous merge yet)
[S8] round=19 local utility u=0.234078 metrics={'f1_val': 0.9916838531202755, 'auprc': 0.9859011917349332, 'loss_val': 0.09499518712406417, 'psi': 0.9893707885661385}-{'f1_val': 0.9233711334553873, 'auprc': 0.9844584050255045, 'loss_val': 0.14894651283846647, 'psi': 0.9478060420834342}
[S9] START round=19 head_norm_before_train=1.956932 (no previous merge yet)
[S9] round=19 local utility u=0.000000 metrics={'f1_val': 0.9950237510807955, 'auprc': 0.9996184535318977, 'loss_val': 0.022757956714905152, 'psi': 0.9968616320612365}-{'f1_val': 0.9971029125121428, 'auprc': 0.998665220287234, 'loss_val': 0.021236065913118468, 'psi': 0.9977278356221793}
[S10] START round=19 head_norm_before_train=1.513754 cos_to_last_merge=0.8446 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.845
[S10] round=19 local utility u=0.003937 metrics={'f1_val': 0.9961684647169089, 'auprc': 0.99745154266273, 'loss_val': 0.11293181671494551, 'psi': 0.9966816958952374}-{'f1_val': 0.99659183488934, 'auprc': 0.9975134804735393, 'loss_val': 0.1235315494410532, 'psi': 0.9969604931230196}
[S11] START round=19 head_norm_before_train=1.781268 (no previous merge yet)
[S11] round=19 local utility u=0.111398 metrics={'f1_val': 0.9966988539245482, 'auprc': 0.9979377150749669, 'loss_val': 0.09645389657555237, 'psi': 0.9971943983847156}-{'f1_val': 0.9625590607840917, 'auprc': 0.9978659362871009, 'loss_val': 0.1141950730872613, 'psi': 0.9766818109852954}
[S13] START round=19 head_norm_before_train=1.636127 (no previous merge yet)
[S13] round=19 local utility u=0.009193 metrics={'f1_val': 0.6172915539934183, 'auprc': 0.6839277748618579, 'loss_val': 0.6120277112346771, 'psi': 0.6439460423407941}-{'f1_val': 0.6144639389655284, 'auprc': 0.6864822020913661, 'loss_val': 0.621111370843936, 'psi': 0.6432712442158635}
[S14] START round=19 head_norm_before_train=1.257801 cos_to_last_merge=0.9981 (last merge round=17)
[S14] round=19 local utility u=0.035674 metrics={'f1_val': 0.9974830777164877, 'auprc': 0.9968689333109133, 'loss_val': 0.20574233334620878, 'psi': 0.997237419954258}-{'f1_val': 0.9974082695017256, 'auprc': 0.9969566388290829, 'loss_val': 0.2769040518316794, 'psi': 0.9972276172326685}
[S15] START round=19 head_norm_before_train=1.375643 cos_to_last_merge=0.9979 (last merge round=17)
[S15] round=19 local utility u=0.028228 metrics={'f1_val': 0.6962540752524984, 'auprc': 0.9784189555181787, 'loss_val': 0.32412230726736097, 'psi': 0.8091200273587705}-{'f1_val': 0.6987927201817774, 'auprc': 0.9815300050369972, 'loss_val': 0.4051423808264054, 'psi': 0.8118876341238653}
[S16] START round=19 head_norm_before_train=1.349192 cos_to_last_merge=1.0000 (last merge round=18)
[S16] round=19 local utility u=0.459284 metrics={'f1_val': 0.9666369872431801, 'auprc': 0.9850214847016867, 'loss_val': 0.35167055703128497, 'psi': 0.9739907862265829}-{'f1_val': 0.8563254323123559, 'auprc': 0.9640472100009877, 'loss_val': 0.5454464347240703, 'psi': 0.8994141433878087}
[S17] START round=19 head_norm_before_train=1.337359 cos_to_last_merge=1.0000 (last merge round=18)
[S17] round=19 local utility u=0.265756 metrics={'f1_val': 0.48660505784749053, 'auprc': 0.7797159266431548, 'loss_val': 0.6692553322904053, 'psi': 0.6038494053657563}-{'f1_val': 0.38791867359973975, 'auprc': 0.8320548905895415, 'loss_val': 0.7656652171502702, 'psi': 0.5655731603956604}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:41913
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:41915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] → sending delta(kind=head bytes=1794) to S2@127.0.0.1:41902
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:41914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:41909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:41903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S14] → sending delta(kind=head bytes=1792) to S11@127.0.0.1:41912
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:41916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] → sending delta(kind=head bytes=1805) to S17@127.0.0.1:41917
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1804 to 1 peers)
[S4] sending update (kind=head size=1794 to 1 peers)
[S6] sending update (kind=head size=1805 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1792 to 1 peers)
[S13] sending update (kind=head size=1794 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1805) from S6
[S17] cosine check vs S6: cos=0.3603
[S3] RECEIVED delta(kind=head bytes=1800) from S8
[S3] cosine check vs S8: cos=-0.1263
[S3] DROPPED delta from S8 (cos=-0.1263 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1801) from S16
[S15] cosine check vs S16: cos=0.9525
[S2] RECEIVED delta(kind=head bytes=1794) from S13
[S2] cosine check vs S13: cos=-0.0821
[S2] DROPPED delta from S13 (cos=-0.0821 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1794) from S4
[S14] cosine check vs S4: cos=-0.0546
[S14] DROPPED delta from S4 (cos=-0.0546 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1792) from S14
[S11] cosine check vs S14: cos=-0.1187
[S11] DROPPED delta from S14 (cos=-0.1187 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1802) from S15
[S13] cosine check vs S15: cos=-0.0362
[S13] DROPPED delta from S15 (cos=-0.0362 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1797) from S11
[S16] cosine check vs S11: cos=-0.0377
[S16] DROPPED delta from S11 (cos=-0.0377 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1804) from S10
[S8] cosine check vs S10: cos=-0.0323
[S8] DROPPED delta from S10 (cos=-0.0323 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S17] → sending delta(kind=head bytes=1788) to S14@127.0.0.1:41914
[S17] sending update (kind=head size=1788 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1788) from S17
[S14] cosine check vs S17: cos=0.9622
[S5] r=20 psi=0.995 u=0.0000 p_local=0.2432 f1=0.996 auprc=0.994 bytes=21592
[S3] r=20 psi=0.997 u=0.0000 p_local=0.1276 f1=0.997 auprc=0.999 bytes=23417
[S2] r=20 psi=0.739 u=0.0000 p_local=0.1042 f1=0.709 auprc=0.785 bytes=23386
[S9] r=20 psi=0.997 u=0.0000 p_local=0.0506 f1=0.995 auprc=1.000 bytes=23396
[S7] r=20 psi=0.667 u=0.0000 p_local=0.1782 f1=0.586 auprc=0.788 bytes=23348
[S8] r=20 psi=0.989 u=0.2341 p_local=0.2414 f1=0.992 auprc=0.986 bytes=23396
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=19 metric=0.9975 head_norm=1.307929
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.852091e-01
[S14] stored merged vector for next round verification (round=19)
[S14] DEBUG after merge:  round=19 metric=0.9975 head_norm=1.321200 delta_norm=0.185209
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S14] r=20 psi=0.997 u=0.0357 p_local=0.1486 f1=0.997 auprc=0.997 bytes=28760
[S4] r=20 psi=0.948 u=0.0823 p_local=0.2254 f1=0.945 auprc=0.952 bytes=19743
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=19 metric=0.6963 head_norm=1.413832
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.160861e-01
[S15] stored merged vector for next round verification (round=19)
[S15] DEBUG after merge:  round=19 metric=0.6950 head_norm=1.381731 delta_norm=0.216086
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S15] r=20 psi=0.809 u=0.0282 p_local=0.1149 f1=0.696 auprc=0.978 bytes=21582
[S13] r=20 psi=0.644 u=0.0092 p_local=0.0850 f1=0.617 auprc=0.684 bytes=19760
[S16] r=20 psi=0.974 u=0.4593 p_local=0.3217 f1=0.967 auprc=0.985 bytes=19769
[S11] r=20 psi=0.997 u=0.1114 p_local=0.1385 f1=0.997 auprc=0.998 bytes=28781
[S10] r=20 psi=0.997 u=0.0039 p_local=0.1510 f1=0.996 auprc=0.997 bytes=27008
[S6] r=20 psi=0.965 u=1.0000 p_local=0.4347 f1=0.961 auprc=0.970 bytes=25153
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=19 metric=0.4866 head_norm=1.359803
[S17] _apply_head_vector_avg (torch): Δ‖w‖=7.671599e-01
[S17] stored merged vector for next round verification (round=19)
[S17] DEBUG after merge:  round=19 metric=0.3892 head_norm=1.118694 delta_norm=0.767160
[S17] aggregate: ROLLBACK (f1_val pre=0.487 post=0.389 tol_abs=0.005 tol_rel=0.0)
[S17] r=20 psi=0.604 u=0.2658 p_local=0.1757 f1=0.487 auprc=0.780 bytes=19735
[S2] START round=20 head_norm_before_train=1.403050 cos_to_last_merge=0.7950 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.795
[S2] round=20 local utility u=0.035270 metrics={'f1_val': 0.6997574016661954, 'auprc': 0.784275580072228, 'loss_val': 0.319130265641714, 'psi': 0.7335646730286084}-{'f1_val': 0.7088967680251086, 'auprc': 0.7852205383891115, 'loss_val': 0.4473415900331545, 'psi': 0.7394262761707098}
[S3] START round=20 head_norm_before_train=1.991207 (no previous merge yet)
[S3] round=20 local utility u=0.000000 metrics={'f1_val': 0.9706249678389679, 'auprc': 0.998824330797166, 'loss_val': 0.059001100512358455, 'psi': 0.9819047130222471}-{'f1_val': 0.9965365984006044, 'auprc': 0.9986473454434528, 'loss_val': 0.03544953531677397, 'psi': 0.9973808972177438}
[S4] START round=20 head_norm_before_train=1.712696 cos_to_last_merge=0.9998 (last merge round=18)
[S4] round=20 local utility u=0.000000 metrics={'f1_val': 0.9408728403086091, 'auprc': 0.9419428776250015, 'loss_val': 0.3103804305151533, 'psi': 0.941300855235166}-{'f1_val': 0.9449142626994429, 'auprc': 0.952236142109661, 'loss_val': 0.30272789393415706, 'psi': 0.9478430144635301}
[S5] START round=20 head_norm_before_train=1.782597 (no previous merge yet)
[S5] round=20 local utility u=0.016005 metrics={'f1_val': 0.9963325909888239, 'auprc': 0.9974297335753317, 'loss_val': 0.057355377211525393, 'psi': 0.996771448023427}-{'f1_val': 0.995817293346464, 'auprc': 0.9935620352312664, 'loss_val': 0.07467031643838465, 'psi': 0.994915190100385}
[S6] START round=20 head_norm_before_train=1.353129 cos_to_last_merge=0.8539 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.854
[S6] round=20 local utility u=0.000000 metrics={'f1_val': 0.6002958202334774, 'auprc': 0.8111478135178054, 'loss_val': 0.5844948655240673, 'psi': 0.6846366175472086}-{'f1_val': 0.9612752765452476, 'auprc': 0.9701911555147494, 'loss_val': 0.2658882582056459, 'psi': 0.9648416281330483}
[S7] START round=20 head_norm_before_train=1.692464 (no previous merge yet)
[S7] round=20 local utility u=0.451490 metrics={'f1_val': 0.6686051546076779, 'auprc': 0.8313970183037783, 'loss_val': 0.41756550616389987, 'psi': 0.733721900086118}-{'f1_val': 0.5862040342911012, 'auprc': 0.7879868818007838, 'loss_val': 0.6959084918274231, 'psi': 0.6669171732949744}
[S8] START round=20 head_norm_before_train=1.785668 (no previous merge yet)
[S8] round=20 local utility u=0.000000 metrics={'f1_val': 0.7135780681239317, 'auprc': 0.9832930864189975, 'loss_val': 0.2573757551062333, 'psi': 0.821464075441958}-{'f1_val': 0.9916838531202755, 'auprc': 0.9859011917349332, 'loss_val': 0.09499518712406417, 'psi': 0.9893707885661385}
[S9] START round=20 head_norm_before_train=1.974966 (no previous merge yet)
[S9] round=20 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9947228450290238, 'loss_val': 0.021500151873178427, 'psi': 0.9961508855188952}-{'f1_val': 0.9950237510807955, 'auprc': 0.9996184535318977, 'loss_val': 0.022757956714905152, 'psi': 0.9968616320612365}
[S10] START round=20 head_norm_before_train=1.532642 cos_to_last_merge=0.8420 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.842
[S10] round=20 local utility u=0.009602 metrics={'f1_val': 0.9961684647169089, 'auprc': 0.9973493722282194, 'loss_val': 0.09342157454277097, 'psi': 0.9966408277214331}-{'f1_val': 0.9961684647169089, 'auprc': 0.99745154266273, 'loss_val': 0.11293181671494551, 'psi': 0.9966816958952374}
[S11] START round=20 head_norm_before_train=1.803323 (no previous merge yet)
[S11] round=20 local utility u=0.000000 metrics={'f1_val': 0.9921492829154647, 'auprc': 0.9978974390474158, 'loss_val': 0.09677226411738708, 'psi': 0.9944485453682452}-{'f1_val': 0.9966988539245482, 'auprc': 0.9979377150749669, 'loss_val': 0.09645389657555237, 'psi': 0.9971943983847156}
[S13] START round=20 head_norm_before_train=1.651837 (no previous merge yet)
[S13] round=20 local utility u=0.046161 metrics={'f1_val': 0.630729151471497, 'auprc': 0.6806603870579846, 'loss_val': 0.5905291273821152, 'psi': 0.650701645706092}-{'f1_val': 0.6172915539934183, 'auprc': 0.6839277748618579, 'loss_val': 0.6120277112346771, 'psi': 0.6439460423407941}
[S14] START round=20 head_norm_before_train=1.321200 cos_to_last_merge=1.0000 (last merge round=19)
[S14] round=20 local utility u=0.008511 metrics={'f1_val': 0.997240356705793, 'auprc': 0.996967070896129, 'loss_val': 0.1875582701773791, 'psi': 0.9971310423819275}-{'f1_val': 0.9974830777164877, 'auprc': 0.9968689333109133, 'loss_val': 0.20574233334620878, 'psi': 0.997237419954258}
[S15] START round=20 head_norm_before_train=1.381731 cos_to_last_merge=1.0000 (last merge round=19)
[S15] round=20 local utility u=0.000000 metrics={'f1_val': 0.6981184568635184, 'auprc': 0.9814467583645032, 'loss_val': 0.39275293239547215, 'psi': 0.8114497774639123}-{'f1_val': 0.6962540752524984, 'auprc': 0.9784189555181787, 'loss_val': 0.32412230726736097, 'psi': 0.8091200273587705}
[S16] START round=20 head_norm_before_train=1.383049 cos_to_last_merge=0.9987 (last merge round=18)
[S16] round=20 local utility u=0.014162 metrics={'f1_val': 0.9579012194108723, 'auprc': 0.9852569798181525, 'loss_val': 0.27163938295867424, 'psi': 0.9688435235737843}-{'f1_val': 0.9666369872431801, 'auprc': 0.9850214847016867, 'loss_val': 0.35167055703128497, 'psi': 0.9739907862265829}
[S17] START round=20 head_norm_before_train=1.118694 cos_to_last_merge=1.0000 (last merge round=19)
[S17] round=20 local utility u=0.000000 metrics={'f1_val': 0.38758279379387306, 'auprc': 0.905126339125459, 'loss_val': 0.7483350391506015, 'psi': 0.5946002119265075}-{'f1_val': 0.48660505784749053, 'auprc': 0.7797159266431548, 'loss_val': 0.6692553322904053, 'psi': 0.6038494053657563}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:41916
[S14] not sending this round → trigger blocked (psi=0.997)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:41904
[S16] not sending this round → trigger blocked (psi=0.969)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.997)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.651)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S2] → sending delta(kind=head bytes=1806) to S17@127.0.0.1:41917
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1806 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1803) from S5
[S16] cosine check vs S5: cos=0.8070
[S4] RECEIVED delta(kind=head bytes=1797) from S7
[S4] cosine check vs S7: cos=0.9959
[S17] RECEIVED delta(kind=head bytes=1806) from S2
[S17] cosine check vs S2: cos=-0.1237
[S17] DROPPED delta from S2 (cos=-0.1237 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] ⇄ pheromone p=0.121 → S11@127.0.0.1:41912
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=20 metric=0.9409 head_norm=1.735383
[S4] _apply_head_vector_avg (torch): Δ‖w‖=7.887810e-02
[S4] stored merged vector for next round verification (round=20)
[S4] DEBUG after merge:  round=20 metric=0.9409 head_norm=1.720439 delta_norm=0.078878
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.180 → S14@127.0.0.1:41914
[S3] ⇄ pheromone p=0.102 → S17@127.0.0.1:41917
[S6] ⇄ pheromone p=0.348 → S17@127.0.0.1:41917
[S10] ⇄ pheromone p=0.123 → S8@127.0.0.1:41909
[S11] ⇄ pheromone p=0.111 → S16@127.0.0.1:41916
[S13] ⇄ pheromone p=0.077 → S2@127.0.0.1:41902
[S9] ⇄ pheromone p=0.040 → S16@127.0.0.1:41916
[S8] ⇄ pheromone p=0.193 → S3@127.0.0.1:41903
[S15] ⇄ pheromone p=0.092 → S13@127.0.0.1:41913
[S7] ⇄ pheromone p=0.233 → S4@127.0.0.1:41904
[S5] ⇄ pheromone p=0.198 → S16@127.0.0.1:41916
[S2] ⇄ pheromone p=0.090 → S17@127.0.0.1:41917
[S17] ⇄ pheromone p=0.141 → S14@127.0.0.1:41914
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=20 metric=0.9579 head_norm=1.424699
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.301708e-01
[S16] stored merged vector for next round verification (round=20)
[S16] DEBUG after merge:  round=20 metric=0.9533 head_norm=1.531272 delta_norm=0.530171
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.260 → S15@127.0.0.1:41915
[S2] START round=21 head_norm_before_train=1.422034 cos_to_last_merge=0.7907 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.791
[S2] round=21 local utility u=0.000000 metrics={'f1_val': 0.7057323404312518, 'auprc': 0.7823432777509893, 'loss_val': 0.4093606183647688, 'psi': 0.7363767153591467}-{'f1_val': 0.6997574016661954, 'auprc': 0.784275580072228, 'loss_val': 0.319130265641714, 'psi': 0.7335646730286084}
[S3] START round=21 head_norm_before_train=2.010914 (no previous merge yet)
[S3] round=21 local utility u=0.060808 metrics={'f1_val': 0.9872687231472141, 'auprc': 0.9991920500308729, 'loss_val': 0.03835096556365546, 'psi': 0.9920380539006777}-{'f1_val': 0.9706249678389679, 'auprc': 0.998824330797166, 'loss_val': 0.059001100512358455, 'psi': 0.9819047130222471}
[S4] START round=21 head_norm_before_train=1.720439 cos_to_last_merge=1.0000 (last merge round=20)
[S4] round=21 local utility u=0.084379 metrics={'f1_val': 0.9466437294652941, 'auprc': 0.9704192773830884, 'loss_val': 0.2616761661936005, 'psi': 0.9561539486324118}-{'f1_val': 0.9408728403086091, 'auprc': 0.9419428776250015, 'loss_val': 0.3103804305151533, 'psi': 0.941300855235166}
[S5] START round=21 head_norm_before_train=1.794989 (no previous merge yet)
[S5] round=21 local utility u=0.001548 metrics={'f1_val': 0.9958213694443535, 'auprc': 0.9978376179580668, 'loss_val': 0.0524151601636239, 'psi': 0.9966278688498389}-{'f1_val': 0.9963325909888239, 'auprc': 0.9974297335753317, 'loss_val': 0.057355377211525393, 'psi': 0.996771448023427}
[S6] START round=21 head_norm_before_train=1.369615 cos_to_last_merge=0.8520 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.852
[S6] round=21 local utility u=1.000000 metrics={'f1_val': 0.8256128984105732, 'auprc': 0.9677786980963521, 'loss_val': 0.3584241609291785, 'psi': 0.8824792182848847}-{'f1_val': 0.6002958202334774, 'auprc': 0.8111478135178054, 'loss_val': 0.5844948655240673, 'psi': 0.6846366175472086}
[S7] START round=21 head_norm_before_train=1.709009 (no previous merge yet)
[S7] round=21 local utility u=0.000000 metrics={'f1_val': 0.6039680138103559, 'auprc': 0.7937365919370243, 'loss_val': 0.6499785020746878, 'psi': 0.6798754450610233}-{'f1_val': 0.6686051546076779, 'auprc': 0.8313970183037783, 'loss_val': 0.41756550616389987, 'psi': 0.733721900086118}
[S8] START round=21 head_norm_before_train=1.811814 (no previous merge yet)
[S8] round=21 local utility u=0.834051 metrics={'f1_val': 0.968797032450666, 'auprc': 0.9850816097847149, 'loss_val': 0.12595372178853287, 'psi': 0.9753108633842855}-{'f1_val': 0.7135780681239317, 'auprc': 0.9832930864189975, 'loss_val': 0.2573757551062333, 'psi': 0.821464075441958}
[S9] START round=21 head_norm_before_train=1.993472 (no previous merge yet)
[S9] round=21 local utility u=0.000000 metrics={'f1_val': 0.985286948729855, 'auprc': 0.9940481741817282, 'loss_val': 0.05682741476208243, 'psi': 0.9887914389106043}-{'f1_val': 0.9971029125121428, 'auprc': 0.9947228450290238, 'loss_val': 0.021500151873178427, 'psi': 0.9961508855188952}
[S10] START round=21 head_norm_before_train=1.558035 cos_to_last_merge=0.8388 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.839
[S10] round=21 local utility u=0.007589 metrics={'f1_val': 0.9961684647169089, 'auprc': 0.9973150265473452, 'loss_val': 0.07814008090995203, 'psi': 0.9966270894490834}-{'f1_val': 0.9961684647169089, 'auprc': 0.9973493722282194, 'loss_val': 0.09342157454277097, 'psi': 0.9966408277214331}
[S11] START round=21 head_norm_before_train=1.831685 (no previous merge yet)
[S11] round=21 local utility u=0.028455 metrics={'f1_val': 0.9965268648289654, 'auprc': 0.9978270012470367, 'loss_val': 0.06591600247214974, 'psi': 0.9970469193961939}-{'f1_val': 0.9921492829154647, 'auprc': 0.9978974390474158, 'loss_val': 0.09677226411738708, 'psi': 0.9944485453682452}
[S13] START round=21 head_norm_before_train=1.666449 (no previous merge yet)
[S13] round=21 local utility u=0.015385 metrics={'f1_val': 0.6341653568796455, 'auprc': 0.6811868086833631, 'loss_val': 0.5819560952911712, 'psi': 0.6529739376011325}-{'f1_val': 0.630729151471497, 'auprc': 0.6806603870579846, 'loss_val': 0.5905291273821152, 'psi': 0.650701645706092}
[S14] START round=21 head_norm_before_train=1.369892 cos_to_last_merge=0.9986 (last merge round=19)
[S14] round=21 local utility u=0.024119 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9968594666130743, 'loss_val': 0.13899665794468813, 'psi': 0.9970880006687055}-{'f1_val': 0.997240356705793, 'auprc': 0.996967070896129, 'loss_val': 0.1875582701773791, 'psi': 0.9971310423819275}
[S15] START round=21 head_norm_before_train=1.413576 cos_to_last_merge=0.9990 (last merge round=19)
[S15] round=21 local utility u=0.059674 metrics={'f1_val': 0.6981806593793383, 'auprc': 0.9873960039783525, 'loss_val': 0.2916265372244319, 'psi': 0.813866797218944}-{'f1_val': 0.6981184568635184, 'auprc': 0.9814467583645032, 'loss_val': 0.39275293239547215, 'psi': 0.8114497774639123}
[S16] START round=21 head_norm_before_train=1.531272 cos_to_last_merge=1.0000 (last merge round=20)
[S16] round=21 local utility u=0.000000 metrics={'f1_val': 0.8616725682982365, 'auprc': 0.9869913511665175, 'loss_val': 0.5203732589793983, 'psi': 0.9118000814455489}-{'f1_val': 0.9579012194108723, 'auprc': 0.9852569798181525, 'loss_val': 0.27163938295867424, 'psi': 0.9688435235737843}
[S17] START round=21 head_norm_before_train=1.136579 cos_to_last_merge=0.9988 (last merge round=19)
[S17] round=21 local utility u=0.000000 metrics={'f1_val': 0.3719160856634986, 'auprc': 0.7004068654881324, 'loss_val': 0.9606293857751579, 'psi': 0.5033123975933521}-{'f1_val': 0.38758279379387306, 'auprc': 0.905126339125459, 'loss_val': 0.7483350391506015, 'psi': 0.5946002119265075}
[S5] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:41909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:41908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S13] → sending delta(kind=head bytes=1793) to S15@127.0.0.1:41915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:41916
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:41911
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:41914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:41904
[S11] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1793 to 1 peers)
[S4] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1800) from S8
[S10] cosine check vs S8: cos=-0.0357
[S10] DROPPED delta from S8 (cos=-0.0357 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1803) from S4
[S7] cosine check vs S4: cos=0.9976
[S8] RECEIVED delta(kind=head bytes=1799) from S3
[S8] cosine check vs S3: cos=-0.1307
[S8] DROPPED delta from S3 (cos=-0.1307 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1797) from S15
[S16] cosine check vs S15: cos=0.8932
[S15] RECEIVED delta(kind=head bytes=1793) from S13
[S15] cosine check vs S13: cos=-0.0451
[S15] DROPPED delta from S13 (cos=-0.0451 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1800) from S11
[S14] cosine check vs S11: cos=-0.1056
[S14] DROPPED delta from S11 (cos=-0.1056 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1800) from S14
[S4] cosine check vs S14: cos=-0.0439
[S4] DROPPED delta from S14 (cos=-0.0439 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=21 metric=0.6040 head_norm=1.722543
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.163009e-02
[S7] stored merged vector for next round verification (round=21)
[S7] DEBUG after merge:  round=21 metric=0.6038 head_norm=1.733397 delta_norm=0.061630
[S7] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=21 metric=0.8617 head_norm=1.563877
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.523482e-01
[S16] stored merged vector for next round verification (round=21)
[S16] DEBUG after merge:  round=21 metric=0.8604 head_norm=1.463594 delta_norm=0.352348
[S16] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=1.440422 cos_to_last_merge=0.7865 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.786
[S2] round=22 local utility u=0.000000 metrics={'f1_val': 0.7118584659596339, 'auprc': 0.785419010408614, 'loss_val': 0.6366830868343399, 'psi': 0.7412826837392259}-{'f1_val': 0.7057323404312518, 'auprc': 0.7823432777509893, 'loss_val': 0.4093606183647688, 'psi': 0.7363767153591467}
[S3] START round=22 head_norm_before_train=2.034811 (no previous merge yet)
[S3] round=22 local utility u=0.038518 metrics={'f1_val': 0.9977814963782642, 'auprc': 0.9990227904954458, 'loss_val': 0.023883311798936296, 'psi': 0.9982780140251368}-{'f1_val': 0.9872687231472141, 'auprc': 0.9991920500308729, 'loss_val': 0.03835096556365546, 'psi': 0.9920380539006777}
[S4] START round=22 head_norm_before_train=1.746360 cos_to_last_merge=0.9997 (last merge round=20)
[S4] round=22 local utility u=0.000000 metrics={'f1_val': 0.9399551666854643, 'auprc': 0.9566539193868584, 'loss_val': 0.28189410908912454, 'psi': 0.9466346677660219}-{'f1_val': 0.9466437294652941, 'auprc': 0.9704192773830884, 'loss_val': 0.2616761661936005, 'psi': 0.9561539486324118}
[S5] START round=22 head_norm_before_train=1.810133 (no previous merge yet)
[S5] round=22 local utility u=0.000000 metrics={'f1_val': 0.995817293346464, 'auprc': 0.9922370694623208, 'loss_val': 0.05903268160062149, 'psi': 0.9943852037928067}-{'f1_val': 0.9958213694443535, 'auprc': 0.9978376179580668, 'loss_val': 0.0524151601636239, 'psi': 0.9966278688498389}
[S6] START round=22 head_norm_before_train=1.383175 cos_to_last_merge=0.8505 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.851
[S6] round=22 local utility u=0.000000 metrics={'f1_val': 0.8243749762375999, 'auprc': 0.9669555738703597, 'loss_val': 0.35148232687209424, 'psi': 0.8814072152907038}-{'f1_val': 0.8256128984105732, 'auprc': 0.9677786980963521, 'loss_val': 0.3584241609291785, 'psi': 0.8824792182848847}
[S7] START round=22 head_norm_before_train=1.733397 cos_to_last_merge=1.0000 (last merge round=21)
[S7] round=22 local utility u=0.457197 metrics={'f1_val': 0.675845713801593, 'auprc': 0.8489353389356384, 'loss_val': 0.33244621265654756, 'psi': 0.7450815638552112}-{'f1_val': 0.6039680138103559, 'auprc': 0.7937365919370243, 'loss_val': 0.6499785020746878, 'psi': 0.6798754450610233}
[S8] START round=22 head_norm_before_train=1.829559 (no previous merge yet)
[S8] round=22 local utility u=0.000000 metrics={'f1_val': 0.9693899219846087, 'auprc': 0.9879109809236285, 'loss_val': 0.13961627412579994, 'psi': 0.9767983455602166}-{'f1_val': 0.968797032450666, 'auprc': 0.9850816097847149, 'loss_val': 0.12595372178853287, 'psi': 0.9753108633842855}
[S9] START round=22 head_norm_before_train=2.009516 (no previous merge yet)
[S9] round=22 local utility u=0.059654 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9977504433898232, 'loss_val': 0.019521902087196213, 'psi': 0.997361924863215}-{'f1_val': 0.985286948729855, 'auprc': 0.9940481741817282, 'loss_val': 0.05682741476208243, 'psi': 0.9887914389106043}
[S10] START round=22 head_norm_before_train=1.588446 cos_to_last_merge=0.8353 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.835
[S10] round=22 local utility u=0.005038 metrics={'f1_val': 0.9957529764387818, 'auprc': 0.997329043951392, 'loss_val': 0.0656135923056512, 'psi': 0.9963834034438259}-{'f1_val': 0.9961684647169089, 'auprc': 0.9973150265473452, 'loss_val': 0.07814008090995203, 'psi': 0.9966270894490834}
[S11] START round=22 head_norm_before_train=1.859587 (no previous merge yet)
[S11] round=22 local utility u=0.002534 metrics={'f1_val': 0.9955647356052171, 'auprc': 0.9979350462183344, 'loss_val': 0.0553989249738375, 'psi': 0.996512859850464}-{'f1_val': 0.9965268648289654, 'auprc': 0.9978270012470367, 'loss_val': 0.06591600247214974, 'psi': 0.9970469193961939}
[S13] START round=22 head_norm_before_train=1.679368 (no previous merge yet)
[S13] round=22 local utility u=0.000000 metrics={'f1_val': 0.6009739817683319, 'auprc': 0.6865291439018653, 'loss_val': 0.7915900551987581, 'psi': 0.6351960466217452}-{'f1_val': 0.6341653568796455, 'auprc': 0.6811868086833631, 'loss_val': 0.5819560952911712, 'psi': 0.6529739376011325}
[S14] START round=22 head_norm_before_train=1.420750 cos_to_last_merge=0.9950 (last merge round=19)
[S14] round=22 local utility u=0.015841 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9968796401706452, 'loss_val': 0.1083822290927563, 'psi': 0.9971968177692935}-{'f1_val': 0.997240356705793, 'auprc': 0.9968594666130743, 'loss_val': 0.13899665794468813, 'psi': 0.9970880006687055}
[S15] START round=22 head_norm_before_train=1.444576 cos_to_last_merge=0.9969 (last merge round=19)
[S15] round=22 local utility u=0.000000 metrics={'f1_val': 0.6910387937843294, 'auprc': 0.9833108199503052, 'loss_val': 0.3723361868673991, 'psi': 0.8079476042507198}-{'f1_val': 0.6981806593793383, 'auprc': 0.9873960039783525, 'loss_val': 0.2916265372244319, 'psi': 0.813866797218944}
[S16] START round=22 head_norm_before_train=1.463594 cos_to_last_merge=1.0000 (last merge round=21)
[S16] round=22 local utility u=0.000000 metrics={'f1_val': 0.8415979511540737, 'auprc': 0.9849364487234055, 'loss_val': 0.6886798633481541, 'psi': 0.8989333501818064}-{'f1_val': 0.8616725682982365, 'auprc': 0.9869913511665175, 'loss_val': 0.5203732589793983, 'psi': 0.9118000814455489}
[S17] START round=22 head_norm_before_train=1.158539 cos_to_last_merge=0.9953 (last merge round=19)
[S17] round=22 local utility u=0.604607 metrics={'f1_val': 0.4448870133373439, 'auprc': 0.8667926435550248, 'loss_val': 0.6883972889911503, 'psi': 0.6136492654244163}-{'f1_val': 0.3719160856634986, 'auprc': 0.7004068654881324, 'loss_val': 0.9606293857751579, 'psi': 0.5033123975933521}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.996)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.998)
[S11] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S14] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:41907
[S17] sending update (kind=head size=1799 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1799) from S17
[S6] cosine check vs S17: cos=0.7893
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=22 metric=0.8244 head_norm=1.402787
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.323840e-01
[S6] stored merged vector for next round verification (round=22)
[S6] DEBUG after merge:  round=22 metric=0.8245 head_norm=1.223701 delta_norm=0.432384
[S6] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=1.455920 cos_to_last_merge=0.7848 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.785
[S2] round=23 local utility u=0.065838 metrics={'f1_val': 0.704896070910819, 'auprc': 0.7777661102032116, 'loss_val': 0.4402743809788221, 'psi': 0.734044086627776}-{'f1_val': 0.7118584659596339, 'auprc': 0.785419010408614, 'loss_val': 0.6366830868343399, 'psi': 0.7412826837392259}
[S3] START round=23 head_norm_before_train=2.055385 (no previous merge yet)
[S3] round=23 local utility u=0.000000 metrics={'f1_val': 0.9942881589284599, 'auprc': 0.9991945302240983, 'loss_val': 0.03488729778040837, 'psi': 0.9962507074467153}-{'f1_val': 0.9977814963782642, 'auprc': 0.9990227904954458, 'loss_val': 0.023883311798936296, 'psi': 0.9982780140251368}
[S4] START round=23 head_norm_before_train=1.775885 cos_to_last_merge=0.9989 (last merge round=20)
[S4] round=23 local utility u=0.014410 metrics={'f1_val': 0.9417835833270765, 'auprc': 0.957863524401497, 'loss_val': 0.2676740488675689, 'psi': 0.9482155597568447}-{'f1_val': 0.9399551666854643, 'auprc': 0.9566539193868584, 'loss_val': 0.28189410908912454, 'psi': 0.9466346677660219}
[S5] START round=23 head_norm_before_train=1.831158 (no previous merge yet)
[S5] round=23 local utility u=0.012051 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9949339573765271, 'loss_val': 0.045232797807916274, 'psi': 0.9956851969361975}-{'f1_val': 0.995817293346464, 'auprc': 0.9922370694623208, 'loss_val': 0.05903268160062149, 'psi': 0.9943852037928067}
[S6] START round=23 head_norm_before_train=1.223701 cos_to_last_merge=1.0000 (last merge round=22)
[S6] round=23 local utility u=0.465518 metrics={'f1_val': 0.9620842833186698, 'auprc': 0.9716778278521057, 'loss_val': 0.260869721349031, 'psi': 0.9659217011320441}-{'f1_val': 0.8243749762375999, 'auprc': 0.9669555738703597, 'loss_val': 0.35148232687209424, 'psi': 0.8814072152907038}
[S7] START round=23 head_norm_before_train=1.748673 cos_to_last_merge=0.9999 (last merge round=21)
[S7] round=23 local utility u=0.000000 metrics={'f1_val': 0.65354126222148, 'auprc': 0.8093475598859012, 'loss_val': 0.4719085306652732, 'psi': 0.7158637812872485}-{'f1_val': 0.675845713801593, 'auprc': 0.8489353389356384, 'loss_val': 0.33244621265654756, 'psi': 0.7450815638552112}
[S8] START round=23 head_norm_before_train=1.845595 (no previous merge yet)
[S8] round=23 local utility u=0.000000 metrics={'f1_val': 0.7137538225988359, 'auprc': 0.9853329230152813, 'loss_val': 0.31021075177218427, 'psi': 0.8223854627654141}-{'f1_val': 0.9693899219846087, 'auprc': 0.9879109809236285, 'loss_val': 0.13961627412579994, 'psi': 0.9767983455602166}
[S9] START round=23 head_norm_before_train=2.020456 (no previous merge yet)
[S9] round=23 local utility u=0.000000 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9996192903195857, 'loss_val': 0.020145516993364296, 'psi': 0.997610333566078}-{'f1_val': 0.9971029125121428, 'auprc': 0.9977504433898232, 'loss_val': 0.019521902087196213, 'psi': 0.997361924863215}
[S10] START round=23 head_norm_before_train=1.622500 cos_to_last_merge=0.8317 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.832
[S10] round=23 local utility u=0.005117 metrics={'f1_val': 0.9961684647169089, 'auprc': 0.9973155238880744, 'loss_val': 0.057831734448296486, 'psi': 0.9966272883853751}-{'f1_val': 0.9957529764387818, 'auprc': 0.997329043951392, 'loss_val': 0.0656135923056512, 'psi': 0.9963834034438259}
[S11] START round=23 head_norm_before_train=1.886456 (no previous merge yet)
[S11] round=23 local utility u=0.000000 metrics={'f1_val': 0.991735457461539, 'auprc': 0.9980211525831955, 'loss_val': 0.0539509144297358, 'psi': 0.9942497355102016}-{'f1_val': 0.9955647356052171, 'auprc': 0.9979350462183344, 'loss_val': 0.0553989249738375, 'psi': 0.996512859850464}
[S13] START round=23 head_norm_before_train=1.691286 (no previous merge yet)
[S13] round=23 local utility u=0.109538 metrics={'f1_val': 0.6181767700655618, 'auprc': 0.6835561135843871, 'loss_val': 0.6668113942424506, 'psi': 0.6443285074730919}-{'f1_val': 0.6009739817683319, 'auprc': 0.6865291439018653, 'loss_val': 0.7915900551987581, 'psi': 0.6351960466217452}
[S14] START round=23 head_norm_before_train=1.467812 cos_to_last_merge=0.9910 (last merge round=19)
[S14] round=23 local utility u=0.007724 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9960656015600409, 'loss_val': 0.0904911579095468, 'psi': 0.9968712023250517}-{'f1_val': 0.9974082695017256, 'auprc': 0.9968796401706452, 'loss_val': 0.1083822290927563, 'psi': 0.9971968177692935}
[S15] START round=23 head_norm_before_train=1.467532 cos_to_last_merge=0.9950 (last merge round=19)
[S15] round=23 local utility u=0.000000 metrics={'f1_val': 0.6905834658431146, 'auprc': 0.9802904782774231, 'loss_val': 0.41254770212231956, 'psi': 0.806466270816838}-{'f1_val': 0.6910387937843294, 'auprc': 0.9833108199503052, 'loss_val': 0.3723361868673991, 'psi': 0.8079476042507198}
[S16] START round=23 head_norm_before_train=1.506967 cos_to_last_merge=0.9990 (last merge round=21)
[S16] round=23 local utility u=0.701820 metrics={'f1_val': 0.9878578804281657, 'auprc': 0.9843827117592762, 'loss_val': 0.1609391457952476, 'psi': 0.9864678129606099}-{'f1_val': 0.8415979511540737, 'auprc': 0.9849364487234055, 'loss_val': 0.6886798633481541, 'psi': 0.8989333501818064}
[S17] START round=23 head_norm_before_train=1.183632 cos_to_last_merge=0.9898 (last merge round=19)
[S17] round=23 local utility u=0.000000 metrics={'f1_val': 0.3953710137763719, 'auprc': 0.8538765221415684, 'loss_val': 0.6767630823956053, 'psi': 0.5787732171224504}-{'f1_val': 0.4448870133373439, 'auprc': 0.8667926435550248, 'loss_val': 0.6883972889911503, 'psi': 0.6136492654244163}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:41908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:41905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:41904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:41915
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:41913
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1804 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1799) from S4
[S7] cosine check vs S4: cos=0.9964
[S5] RECEIVED delta(kind=head bytes=1804) from S16
[S5] cosine check vs S16: cos=0.8407
[S4] RECEIVED delta(kind=head bytes=1801) from S14
[S4] cosine check vs S14: cos=-0.0438
[S4] DROPPED delta from S14 (cos=-0.0438 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1802) from S2
[S13] cosine check vs S2: cos=-0.0879
[S13] DROPPED delta from S2 (cos=-0.0879 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1799) from S13
[S15] cosine check vs S13: cos=-0.0465
[S15] DROPPED delta from S13 (cos=-0.0465 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=23 metric=0.6535 head_norm=1.757682
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.869003e-02
[S7] stored merged vector for next round verification (round=23)
[S7] DEBUG after merge:  round=23 metric=0.6428 head_norm=1.777864 delta_norm=0.078690
[S7] aggregate: ROLLBACK (f1_val pre=0.654 post=0.643 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=23 metric=0.9962 head_norm=1.855744
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.024415e-01
[S5] stored merged vector for next round verification (round=23)
[S5] DEBUG after merge:  round=23 metric=0.9962 head_norm=1.633406 delta_norm=0.502442
[S5] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=1.471298 cos_to_last_merge=0.7825 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.783
[S2] round=24 local utility u=0.000000 metrics={'f1_val': 0.7119231717293193, 'auprc': 0.7796672500206165, 'loss_val': 0.7267855989282035, 'psi': 0.7390208030458382}-{'f1_val': 0.704896070910819, 'auprc': 0.7777661102032116, 'loss_val': 0.4402743809788221, 'psi': 0.734044086627776}
[S3] START round=24 head_norm_before_train=2.068669 (no previous merge yet)
[S3] round=24 local utility u=0.010578 metrics={'f1_val': 0.9965365984006044, 'auprc': 0.9991751324892719, 'loss_val': 0.027164472876253915, 'psi': 0.9975920120360714}-{'f1_val': 0.9942881589284599, 'auprc': 0.9991945302240983, 'loss_val': 0.03488729778040837, 'psi': 0.9962507074467153}
[S4] START round=24 head_norm_before_train=1.801260 cos_to_last_merge=0.9978 (last merge round=20)
[S4] round=24 local utility u=0.002495 metrics={'f1_val': 0.9409657052562942, 'auprc': 0.9650516355858636, 'loss_val': 0.2793402013360284, 'psi': 0.950600077388122}-{'f1_val': 0.9417835833270765, 'auprc': 0.957863524401497, 'loss_val': 0.2676740488675689, 'psi': 0.9482155597568447}
[S5] START round=24 head_norm_before_train=1.633406 cos_to_last_merge=1.0000 (last merge round=23)
[S5] round=24 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9946345627047971, 'loss_val': 0.05742271761973243, 'psi': 0.9955654390675055}-{'f1_val': 0.996186023309311, 'auprc': 0.9949339573765271, 'loss_val': 0.045232797807916274, 'psi': 0.9956851969361975}
[S6] START round=24 head_norm_before_train=1.248665 cos_to_last_merge=0.9997 (last merge round=22)
[S6] round=24 local utility u=0.000000 metrics={'f1_val': 0.5234276524382028, 'auprc': 0.8096317762476897, 'loss_val': 0.6270088640615001, 'psi': 0.6379093019619975}-{'f1_val': 0.9620842833186698, 'auprc': 0.9716778278521057, 'loss_val': 0.260869721349031, 'psi': 0.9659217011320441}
[S7] START round=24 head_norm_before_train=1.777864 cos_to_last_merge=1.0000 (last merge round=23)
[S7] round=24 local utility u=0.121188 metrics={'f1_val': 0.6726268064369948, 'auprc': 0.8242545577502168, 'loss_val': 0.38876733380216943, 'psi': 0.7332779069622837}-{'f1_val': 0.65354126222148, 'auprc': 0.8093475598859012, 'loss_val': 0.4719085306652732, 'psi': 0.7158637812872485}
[S8] START round=24 head_norm_before_train=1.861622 (no previous merge yet)
[S8] round=24 local utility u=0.964717 metrics={'f1_val': 0.9918210737370572, 'auprc': 0.9882760468557791, 'loss_val': 0.05800883566976489, 'psi': 0.990403062984546}-{'f1_val': 0.7137538225988359, 'auprc': 0.9853329230152813, 'loss_val': 0.31021075177218427, 'psi': 0.8223854627654141}
[S9] START round=24 head_norm_before_train=2.034672 (no previous merge yet)
[S9] round=24 local utility u=0.000000 metrics={'f1_val': 0.9950237510807955, 'auprc': 0.9996184061205287, 'loss_val': 0.021867425733037918, 'psi': 0.9968616130966889}-{'f1_val': 0.9962710290637395, 'auprc': 0.9996192903195857, 'loss_val': 0.020145516993364296, 'psi': 0.997610333566078}
[S10] START round=24 head_norm_before_train=1.654625 cos_to_last_merge=0.8284 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.828
[S10] round=24 local utility u=0.002957 metrics={'f1_val': 0.9961684647169089, 'auprc': 0.9972790743523448, 'loss_val': 0.05180843200897405, 'psi': 0.9966127085710832}-{'f1_val': 0.9961684647169089, 'auprc': 0.9973155238880744, 'loss_val': 0.057831734448296486, 'psi': 0.9966272883853751}
[S11] START round=24 head_norm_before_train=1.911919 (no previous merge yet)
[S11] round=24 local utility u=0.018796 metrics={'f1_val': 0.9958050841232382, 'auprc': 0.9979937256498915, 'loss_val': 0.04069476456255434, 'psi': 0.9966805407338996}-{'f1_val': 0.991735457461539, 'auprc': 0.9980211525831955, 'loss_val': 0.0539509144297358, 'psi': 0.9942497355102016}
[S13] START round=24 head_norm_before_train=1.702188 (no previous merge yet)
[S13] round=24 local utility u=0.000000 metrics={'f1_val': 0.6116331171525753, 'auprc': 0.6871782007707713, 'loss_val': 0.6550631522268531, 'psi': 0.6418511505998536}-{'f1_val': 0.6181767700655618, 'auprc': 0.6835561135843871, 'loss_val': 0.6668113942424506, 'psi': 0.6443285074730919}
[S14] START round=24 head_norm_before_train=1.508874 cos_to_last_merge=0.9873 (last merge round=19)
[S14] round=24 local utility u=0.009545 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9970574881579217, 'loss_val': 0.07336937413120548, 'psi': 0.9971672092866446}-{'f1_val': 0.9974082695017256, 'auprc': 0.9960656015600409, 'loss_val': 0.0904911579095468, 'psi': 0.9968712023250517}
[S15] START round=24 head_norm_before_train=1.489987 cos_to_last_merge=0.9930 (last merge round=19)
[S15] round=24 local utility u=1.000000 metrics={'f1_val': 0.9800478195064435, 'auprc': 0.9891910503753194, 'loss_val': 0.14264571385857963, 'psi': 0.9837051118539939}-{'f1_val': 0.6905834658431146, 'auprc': 0.9802904782774231, 'loss_val': 0.41254770212231956, 'psi': 0.806466270816838}
[S16] START round=24 head_norm_before_train=1.548269 cos_to_last_merge=0.9966 (last merge round=21)
[S16] round=24 local utility u=0.024441 metrics={'f1_val': 0.9893506395937117, 'auprc': 0.9878459654893877, 'loss_val': 0.1314034721632143, 'psi': 0.9887487699519821}-{'f1_val': 0.9878578804281657, 'auprc': 0.9843827117592762, 'loss_val': 0.1609391457952476, 'psi': 0.9864678129606099}
[S17] START round=24 head_norm_before_train=1.210532 cos_to_last_merge=0.9842 (last merge round=19)
[S17] round=24 local utility u=0.043583 metrics={'f1_val': 0.4076193320397859, 'auprc': 0.8567197386311051, 'loss_val': 0.6716172531989979, 'psi': 0.5872594946763136}-{'f1_val': 0.3953710137763719, 'auprc': 0.8538765221415684, 'loss_val': 0.6767630823956053, 'psi': 0.5787732171224504}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] sending update (kind=head size=1794 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:41914
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.989)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.951)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S15] → sending delta(kind=head bytes=1806) to S16@127.0.0.1:41916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:41911
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:41909
[S10] not sending this round → trigger blocked (psi=0.997)
[S14] not sending this round → trigger blocked (psi=0.997)
[S3] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1806 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1798) from S11
[S14] cosine check vs S11: cos=-0.1130
[S14] DROPPED delta from S11 (cos=-0.1130 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1796) from S3
[S8] cosine check vs S3: cos=-0.1358
[S8] DROPPED delta from S3 (cos=-0.1358 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1806) from S15
[S16] cosine check vs S15: cos=0.9663
[S10] RECEIVED delta(kind=head bytes=1799) from S8
[S10] cosine check vs S8: cos=-0.0396
[S10] DROPPED delta from S8 (cos=-0.0396 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:41907
[S17] sending update (kind=head size=1798 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1798) from S17
[S6] cosine check vs S17: cos=0.9178
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=24 metric=0.5234 head_norm=1.271862
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.548100e-01
[S6] stored merged vector for next round verification (round=24)
[S6] DEBUG after merge:  round=24 metric=0.4858 head_norm=1.227367 delta_norm=0.254810
[S6] aggregate: ROLLBACK (f1_val pre=0.523 post=0.486 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=24 metric=0.9894 head_norm=1.583954
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.039821e-01
[S16] stored merged vector for next round verification (round=24)
[S16] DEBUG after merge:  round=24 metric=0.9896 head_norm=1.535687 delta_norm=0.203982
[S16] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=25 head_norm_before_train=1.487097 cos_to_last_merge=0.7807 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.781
[S2] round=25 local utility u=0.000000 metrics={'f1_val': 0.7120067671452607, 'auprc': 0.7775794358819776, 'loss_val': 0.7643851147474033, 'psi': 0.7382358346399475}-{'f1_val': 0.7119231717293193, 'auprc': 0.7796672500206165, 'loss_val': 0.7267855989282035, 'psi': 0.7390208030458382}
[S3] START round=25 head_norm_before_train=2.086871 (no previous merge yet)
[S3] round=25 local utility u=0.000000 metrics={'f1_val': 0.960995754132836, 'auprc': 0.99851300816428, 'loss_val': 0.07754836145598606, 'psi': 0.9760026557454137}-{'f1_val': 0.9965365984006044, 'auprc': 0.9991751324892719, 'loss_val': 0.027164472876253915, 'psi': 0.9975920120360714}
[S4] START round=25 head_norm_before_train=1.818338 cos_to_last_merge=0.9968 (last merge round=20)
[S4] round=25 local utility u=0.007128 metrics={'f1_val': 0.9417631777939217, 'auprc': 0.962400234684452, 'loss_val': 0.26191569205139187, 'psi': 0.9500180005501339}-{'f1_val': 0.9409657052562942, 'auprc': 0.9650516355858636, 'loss_val': 0.2793402013360284, 'psi': 0.950600077388122}
[S5] START round=25 head_norm_before_train=1.675205 cos_to_last_merge=0.9996 (last merge round=23)
[S5] round=25 local utility u=0.008916 metrics={'f1_val': 0.9959673157242839, 'auprc': 0.9971935134559945, 'loss_val': 0.045955109246489066, 'psi': 0.9964577948169681}-{'f1_val': 0.996186023309311, 'auprc': 0.9946345627047971, 'loss_val': 0.05742271761973243, 'psi': 0.9955654390675055}
[S6] START round=25 head_norm_before_train=1.227367 cos_to_last_merge=1.0000 (last merge round=24)
[S6] round=25 local utility u=1.000000 metrics={'f1_val': 0.9628030347617168, 'auprc': 0.9730535600963621, 'loss_val': 0.24274240316393547, 'psi': 0.9669032448955749}-{'f1_val': 0.5234276524382028, 'auprc': 0.8096317762476897, 'loss_val': 0.6270088640615001, 'psi': 0.6379093019619975}
[S7] START round=25 head_norm_before_train=1.784919 cos_to_last_merge=1.0000 (last merge round=23)
[S7] round=25 local utility u=0.000000 metrics={'f1_val': 0.6702457310437442, 'auprc': 0.818705010384869, 'loss_val': 0.4069871281782398, 'psi': 0.7296294427801941}-{'f1_val': 0.6726268064369948, 'auprc': 0.8242545577502168, 'loss_val': 0.38876733380216943, 'psi': 0.7332779069622837}
[S8] START round=25 head_norm_before_train=1.876424 (no previous merge yet)
[S8] round=25 local utility u=0.005951 metrics={'f1_val': 0.992765585815685, 'auprc': 0.9883219233262901, 'loss_val': 0.05191222733611356, 'psi': 0.990988120819927}-{'f1_val': 0.9918210737370572, 'auprc': 0.9882760468557791, 'loss_val': 0.05800883566976489, 'psi': 0.990403062984546}
[S9] START round=25 head_norm_before_train=2.051101 (no previous merge yet)
[S9] round=25 local utility u=0.003604 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9977486102257392, 'loss_val': 0.018870055569267075, 'psi': 0.9970957511786306}-{'f1_val': 0.9950237510807955, 'auprc': 0.9996184061205287, 'loss_val': 0.021867425733037918, 'psi': 0.9968616130966889}
[S10] START round=25 head_norm_before_train=1.684218 cos_to_last_merge=0.8256 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.826
[S10] round=25 local utility u=0.000000 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9964441675653183, 'loss_val': 0.04852319239336138, 'psi': 0.9959434591351393}-{'f1_val': 0.9961684647169089, 'auprc': 0.9972790743523448, 'loss_val': 0.05180843200897405, 'psi': 0.9966127085710832}
[S11] START round=25 head_norm_before_train=1.935456 (no previous merge yet)
[S11] round=25 local utility u=0.000000 metrics={'f1_val': 0.9946045559842651, 'auprc': 0.9980429867993804, 'loss_val': 0.03850534910182975, 'psi': 0.9959799283103112}-{'f1_val': 0.9958050841232382, 'auprc': 0.9979937256498915, 'loss_val': 0.04069476456255434, 'psi': 0.9966805407338996}
[S13] START round=25 head_norm_before_train=1.711998 (no previous merge yet)
[S13] round=25 local utility u=0.000000 metrics={'f1_val': 0.6136485352251061, 'auprc': 0.6874231051194718, 'loss_val': 0.7083113310092598, 'psi': 0.6431583631828524}-{'f1_val': 0.6116331171525753, 'auprc': 0.6871782007707713, 'loss_val': 0.6550631522268531, 'psi': 0.6418511505998536}
[S14] START round=25 head_norm_before_train=1.544156 cos_to_last_merge=0.9842 (last merge round=19)
[S14] round=25 local utility u=0.004495 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9969612590956589, 'loss_val': 0.06409155563383354, 'psi': 0.9971287176617394}-{'f1_val': 0.997240356705793, 'auprc': 0.9970574881579217, 'loss_val': 0.07336937413120548, 'psi': 0.9971672092866446}
[S15] START round=25 head_norm_before_train=1.513596 cos_to_last_merge=0.9911 (last merge round=19)
[S15] round=25 local utility u=0.000000 metrics={'f1_val': 0.7821641218678543, 'auprc': 0.9867931413128542, 'loss_val': 0.24719257918304513, 'psi': 0.8640157296458544}-{'f1_val': 0.9800478195064435, 'auprc': 0.9891910503753194, 'loss_val': 0.14264571385857963, 'psi': 0.9837051118539939}
[S16] START round=25 head_norm_before_train=1.535687 cos_to_last_merge=1.0000 (last merge round=24)
[S16] round=25 local utility u=0.000000 metrics={'f1_val': 0.9827229615688695, 'auprc': 0.983372485641524, 'loss_val': 0.14850397614272476, 'psi': 0.9829827711979313}-{'f1_val': 0.9893506395937117, 'auprc': 0.9878459654893877, 'loss_val': 0.1314034721632143, 'psi': 0.9887487699519821}
[S17] START round=25 head_norm_before_train=1.234943 cos_to_last_merge=0.9803 (last merge round=19)
[S17] round=25 local utility u=0.000000 metrics={'f1_val': 0.4135750358523232, 'auprc': 0.8384437582299424, 'loss_val': 0.6644325843563186, 'psi': 0.5835225248033709}-{'f1_val': 0.4076193320397859, 'auprc': 0.8567197386311051, 'loss_val': 0.6716172531989979, 'psi': 0.5872594946763136}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S8] not sending this round → trigger blocked (psi=0.991)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] sending update (kind=head size=1805 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:41908
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:41904
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1797) from S4
[S7] cosine check vs S4: cos=0.9979
[S4] RECEIVED delta(kind=head bytes=1795) from S14
[S4] cosine check vs S14: cos=-0.0442
[S4] DROPPED delta from S14 (cos=-0.0442 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] ⇄ pheromone p=0.041 → S15@127.0.0.1:41915
[S11] ⇄ pheromone p=0.042 → S14@127.0.0.1:41914
[S2] ⇄ pheromone p=0.038 → S13@127.0.0.1:41913
[S4] ⇄ pheromone p=0.070 → S7@127.0.0.1:41908
[S14] ⇄ pheromone p=0.047 → S4@127.0.0.1:41904
[S3] ⇄ pheromone p=0.044 → S8@127.0.0.1:41909
[S15] ⇄ pheromone p=0.195 → S16@127.0.0.1:41916
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=25 metric=0.6702 head_norm=1.792521
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.194824e-02
[S7] stored merged vector for next round verification (round=25)
[S7] DEBUG after merge:  round=25 metric=0.6667 head_norm=1.811329 delta_norm=0.061948
[S7] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.287 → S10@127.0.0.1:41911
[S16] ⇄ pheromone p=0.179 → S5@127.0.0.1:41905
[S17] ⇄ pheromone p=0.115 → S6@127.0.0.1:41907
[S2] START round=26 head_norm_before_train=1.502656 cos_to_last_merge=0.7787 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.779
[S2] round=26 local utility u=0.000000 metrics={'f1_val': 0.6971624159316198, 'auprc': 0.6702380380504599, 'loss_val': 0.35762575274700187, 'psi': 0.6863926647791558}-{'f1_val': 0.7120067671452607, 'auprc': 0.7775794358819776, 'loss_val': 0.7643851147474033, 'psi': 0.7382358346399475}
[S3] START round=26 head_norm_before_train=2.100967 (no previous merge yet)
[S3] round=26 local utility u=0.137365 metrics={'f1_val': 0.9977814963782642, 'auprc': 0.9992073885462651, 'loss_val': 0.025616772974206708, 'psi': 0.9983518532454646}-{'f1_val': 0.960995754132836, 'auprc': 0.99851300816428, 'loss_val': 0.07754836145598606, 'psi': 0.9760026557454137}
[S4] START round=26 head_norm_before_train=1.832040 cos_to_last_merge=0.9961 (last merge round=20)
[S4] round=26 local utility u=0.000000 metrics={'f1_val': 0.9458734146779707, 'auprc': 0.9524969915935326, 'loss_val': 0.266200868217731, 'psi': 0.9485228454441955}-{'f1_val': 0.9417631777939217, 'auprc': 0.962400234684452, 'loss_val': 0.26191569205139187, 'psi': 0.9500180005501339}
[S5] START round=26 head_norm_before_train=1.728153 cos_to_last_merge=0.9984 (last merge round=23)
[S5] round=26 local utility u=0.002112 metrics={'f1_val': 0.9958213694443535, 'auprc': 0.9969815665828574, 'loss_val': 0.04022052133546427, 'psi': 0.9962854482997551}-{'f1_val': 0.9959673157242839, 'auprc': 0.9971935134559945, 'loss_val': 0.045955109246489066, 'psi': 0.9964577948169681}
[S6] START round=26 head_norm_before_train=1.246252 cos_to_last_merge=0.9998 (last merge round=24)
[S6] round=26 local utility u=0.000000 metrics={'f1_val': 0.6783576251625352, 'auprc': 0.938088362231312, 'loss_val': 0.611591077134285, 'psi': 0.7822499199900459}-{'f1_val': 0.9628030347617168, 'auprc': 0.9730535600963621, 'loss_val': 0.24274240316393547, 'psi': 0.9669032448955749}
[S7] START round=26 head_norm_before_train=1.811329 cos_to_last_merge=1.0000 (last merge round=25)
[S7] round=26 local utility u=0.000000 metrics={'f1_val': 0.6102078026478605, 'auprc': 0.7869882247625054, 'loss_val': 0.6877499497268574, 'psi': 0.6809199714937184}-{'f1_val': 0.6702457310437442, 'auprc': 0.818705010384869, 'loss_val': 0.4069871281782398, 'psi': 0.7296294427801941}
[S8] START round=26 head_norm_before_train=1.894878 (no previous merge yet)
[S8] round=26 local utility u=0.000000 metrics={'f1_val': 0.9936566772467331, 'auprc': 0.9868868238754135, 'loss_val': 0.05937133993125518, 'psi': 0.9909487358982053}-{'f1_val': 0.992765585815685, 'auprc': 0.9883219233262901, 'loss_val': 0.05191222733611356, 'psi': 0.990988120819927}
[S9] START round=26 head_norm_before_train=2.065714 (no previous merge yet)
[S9] round=26 local utility u=0.003190 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9996144418478132, 'loss_val': 0.018088278830870018, 'psi': 0.9978420838274602}-{'f1_val': 0.9966605118138915, 'auprc': 0.9977486102257392, 'loss_val': 0.018870055569267075, 'psi': 0.9970957511786306}
[S10] START round=26 head_norm_before_train=1.712219 cos_to_last_merge=0.8232 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.823
[S10] round=26 local utility u=0.001846 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9964566737461387, 'loss_val': 0.04486900091317609, 'psi': 0.9959484616074674}-{'f1_val': 0.9956096535150197, 'auprc': 0.9964441675653183, 'loss_val': 0.04852319239336138, 'psi': 0.9959434591351393}
[S11] START round=26 head_norm_before_train=1.958387 (no previous merge yet)
[S11] round=26 local utility u=0.010191 metrics={'f1_val': 0.9965268648289654, 'auprc': 0.9980288851380041, 'loss_val': 0.02961516936710894, 'psi': 0.9971276729525809}-{'f1_val': 0.9946045559842651, 'auprc': 0.9980429867993804, 'loss_val': 0.03850534910182975, 'psi': 0.9959799283103112}
[S13] START round=26 head_norm_before_train=1.722722 (no previous merge yet)
[S13] round=26 local utility u=0.000000 metrics={'f1_val': 0.6096318910851595, 'auprc': 0.6877621848005308, 'loss_val': 0.7609683540663826, 'psi': 0.640884008571308}-{'f1_val': 0.6136485352251061, 'auprc': 0.6874231051194718, 'loss_val': 0.7083113310092598, 'psi': 0.6431583631828524}
[S14] START round=26 head_norm_before_train=1.575945 cos_to_last_merge=0.9816 (last merge round=19)
[S14] round=26 local utility u=0.000000 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.995868515332879, 'loss_val': 0.06107642134231577, 'psi': 0.9962997450996018}-{'f1_val': 0.997240356705793, 'auprc': 0.9969612590956589, 'loss_val': 0.06409155563383354, 'psi': 0.9971287176617394}
[S15] START round=26 head_norm_before_train=1.532752 cos_to_last_merge=0.9895 (last merge round=19)
[S15] round=26 local utility u=0.000000 metrics={'f1_val': 0.7579006344857915, 'auprc': 0.9873051155323217, 'loss_val': 0.289196588912472, 'psi': 0.8496624269044035}-{'f1_val': 0.7821641218678543, 'auprc': 0.9867931413128542, 'loss_val': 0.24719257918304513, 'psi': 0.8640157296458544}
[S16] START round=26 head_norm_before_train=1.567942 cos_to_last_merge=0.9997 (last merge round=24)
[S16] round=26 local utility u=0.000000 metrics={'f1_val': 0.8759109948419093, 'auprc': 0.987793996252432, 'loss_val': 0.472393123986186, 'psi': 0.9206641954061183}-{'f1_val': 0.9827229615688695, 'auprc': 0.983372485641524, 'loss_val': 0.14850397614272476, 'psi': 0.9829827711979313}
[S17] START round=26 head_norm_before_train=1.255092 cos_to_last_merge=0.9767 (last merge round=19)
[S17] round=26 local utility u=0.975127 metrics={'f1_val': 0.7213429551262934, 'auprc': 0.8506987391388215, 'loss_val': 0.5975517841210163, 'psi': 0.7730852687313047}-{'f1_val': 0.4135750358523232, 'auprc': 0.8384437582299424, 'loss_val': 0.6644325843563186, 'psi': 0.5835225248033709}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:41914
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S10] → sending delta(kind=head bytes=1807) to S8@127.0.0.1:41909
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:41916
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:41909
[S3] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1807 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1797) from S11
[S14] cosine check vs S11: cos=-0.1139
[S14] DROPPED delta from S11 (cos=-0.1139 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1796) from S3
[S8] cosine check vs S3: cos=-0.1385
[S8] DROPPED delta from S3 (cos=-0.1385 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1807) from S10
[S8] cosine check vs S10: cos=-0.0396
[S8] DROPPED delta from S10 (cos=-0.0396 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1800) from S5
[S16] cosine check vs S5: cos=0.8927
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:41907
[S17] sending update (kind=head size=1800 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1800) from S17
[S6] cosine check vs S17: cos=0.9672
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=26 metric=0.6784 head_norm=1.271442
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.632518e-01
[S6] stored merged vector for next round verification (round=26)
[S6] DEBUG after merge:  round=26 metric=0.6675 head_norm=1.263240 delta_norm=0.163252
[S6] aggregate: ROLLBACK (f1_val pre=0.678 post=0.668 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=26 metric=0.8759 head_norm=1.596529
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.975240e-01
[S16] stored merged vector for next round verification (round=26)
[S16] DEBUG after merge:  round=26 metric=0.8746 head_norm=1.634406 delta_norm=0.397524
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=27 head_norm_before_train=1.516200 cos_to_last_merge=0.7772 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.777
[S2] round=27 local utility u=0.147663 metrics={'f1_val': 0.7109546951174711, 'auprc': 0.7944283965395896, 'loss_val': 0.5176246417612714, 'psi': 0.7443441756863185}-{'f1_val': 0.6971624159316198, 'auprc': 0.6702380380504599, 'loss_val': 0.35762575274700187, 'psi': 0.6863926647791558}
[S3] START round=27 head_norm_before_train=2.112000 (no previous merge yet)
[S3] round=27 local utility u=0.001791 metrics={'f1_val': 0.9977814963782642, 'auprc': 0.999205401702606, 'loss_val': 0.022028221973040163, 'psi': 0.9983510585080009}-{'f1_val': 0.9977814963782642, 'auprc': 0.9992073885462651, 'loss_val': 0.025616772974206708, 'psi': 0.9983518532454646}
[S4] START round=27 head_norm_before_train=1.846989 cos_to_last_merge=0.9954 (last merge round=20)
[S4] round=27 local utility u=0.033677 metrics={'f1_val': 0.9515385428056174, 'auprc': 0.9592912116087584, 'loss_val': 0.25322075641093994, 'psi': 0.9546396103268738}-{'f1_val': 0.9458734146779707, 'auprc': 0.9524969915935326, 'loss_val': 0.266200868217731, 'psi': 0.9485228454441955}
[S5] START round=27 head_norm_before_train=1.763438 cos_to_last_merge=0.9971 (last merge round=23)
[S5] round=27 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9933736435325938, 'loss_val': 0.037174876196323786, 'psi': 0.9950610713986241}-{'f1_val': 0.9958213694443535, 'auprc': 0.9969815665828574, 'loss_val': 0.04022052133546427, 'psi': 0.9962854482997551}
[S6] START round=27 head_norm_before_train=1.263240 cos_to_last_merge=1.0000 (last merge round=26)
[S6] round=27 local utility u=0.624185 metrics={'f1_val': 0.8271576521388151, 'auprc': 0.9686669791046526, 'loss_val': 0.347757212665263, 'psi': 0.88376138292515}-{'f1_val': 0.6783576251625352, 'auprc': 0.938088362231312, 'loss_val': 0.611591077134285, 'psi': 0.7822499199900459}
[S7] START round=27 head_norm_before_train=1.820113 cos_to_last_merge=1.0000 (last merge round=25)
[S7] round=27 local utility u=0.206445 metrics={'f1_val': 0.6508185696445489, 'auprc': 0.7951155877746867, 'loss_val': 0.542906557572369, 'psi': 0.7085373768966041}-{'f1_val': 0.6102078026478605, 'auprc': 0.7869882247625054, 'loss_val': 0.6877499497268574, 'psi': 0.6809199714937184}
[S8] START round=27 head_norm_before_train=1.912105 (no previous merge yet)
[S8] round=27 local utility u=0.004623 metrics={'f1_val': 0.9936566772467331, 'auprc': 0.9876414777794004, 'loss_val': 0.05239006949650269, 'psi': 0.9912505974598}-{'f1_val': 0.9936566772467331, 'auprc': 0.9868868238754135, 'loss_val': 0.05937133993125518, 'psi': 0.9909487358982053}
[S9] START round=27 head_norm_before_train=2.078224 (no previous merge yet)
[S9] round=27 local utility u=0.000000 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9996268766952752, 'loss_val': 0.018698564217928194, 'psi': 0.9973467816966213}-{'f1_val': 0.9966605118138915, 'auprc': 0.9996144418478132, 'loss_val': 0.018088278830870018, 'psi': 0.9978420838274602}
[S10] START round=27 head_norm_before_train=1.736875 cos_to_last_merge=0.8214 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.821
[S10] round=27 local utility u=0.001821 metrics={'f1_val': 0.9961684647169089, 'auprc': 0.9955202368804179, 'loss_val': 0.041769622502453974, 'psi': 0.9959091735823125}-{'f1_val': 0.9956096535150197, 'auprc': 0.9964566737461387, 'loss_val': 0.04486900091317609, 'psi': 0.9959484616074674}
[S11] START round=27 head_norm_before_train=1.980090 (no previous merge yet)
[S11] round=27 local utility u=0.000149 metrics={'f1_val': 0.9962850284706224, 'auprc': 0.9979391778865581, 'loss_val': 0.027596872534543657, 'psi': 0.9969466882369967}-{'f1_val': 0.9965268648289654, 'auprc': 0.9980288851380041, 'loss_val': 0.02961516936710894, 'psi': 0.9971276729525809}
[S13] START round=27 head_norm_before_train=1.731449 (no previous merge yet)
[S13] round=27 local utility u=0.160230 metrics={'f1_val': 0.6361042388537989, 'auprc': 0.6815713690347506, 'loss_val': 0.5807693946953778, 'psi': 0.6542910909261795}-{'f1_val': 0.6096318910851595, 'auprc': 0.6877621848005308, 'loss_val': 0.7609683540663826, 'psi': 0.640884008571308}
[S14] START round=27 head_norm_before_train=1.604521 cos_to_last_merge=0.9792 (last merge round=19)
[S14] round=27 local utility u=0.003669 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.996692679696219, 'loss_val': 0.05621019359080057, 'psi': 0.9966294108449378}-{'f1_val': 0.9965872316107504, 'auprc': 0.995868515332879, 'loss_val': 0.06107642134231577, 'psi': 0.9962997450996018}
[S15] START round=27 head_norm_before_train=1.552938 cos_to_last_merge=0.9877 (last merge round=19)
[S15] round=27 local utility u=0.000000 metrics={'f1_val': 0.7010056609658452, 'auprc': 0.9816858053458355, 'loss_val': 0.3627188658110721, 'psi': 0.8132777187178413}-{'f1_val': 0.7579006344857915, 'auprc': 0.9873051155323217, 'loss_val': 0.289196588912472, 'psi': 0.8496624269044035}
[S16] START round=27 head_norm_before_train=1.634406 cos_to_last_merge=1.0000 (last merge round=26)
[S16] round=27 local utility u=0.000000 metrics={'f1_val': 0.8603313334235025, 'auprc': 0.9818545413462698, 'loss_val': 0.5252684589922167, 'psi': 0.9089406165926094}-{'f1_val': 0.8759109948419093, 'auprc': 0.987793996252432, 'loss_val': 0.472393123986186, 'psi': 0.9206641954061183}
[S17] START round=27 head_norm_before_train=1.276045 cos_to_last_merge=0.9730 (last merge round=19)
[S17] round=27 local utility u=0.000000 metrics={'f1_val': 0.4202455353232353, 'auprc': 0.7808968887341539, 'loss_val': 0.9400936576434159, 'psi': 0.5645060766876027}-{'f1_val': 0.7213429551262934, 'auprc': 0.8506987391388215, 'loss_val': 0.5975517841210163, 'psi': 0.7730852687313047}
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S3]  timeout peer S2
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S10
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S17
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S14
[S15]  timeout peer S17
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S7
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S10
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S16
[S2]  timeout peer S3
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S16
[S8]  timeout peer S17
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S16
[S13]  timeout peer S17
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.996)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] → sending delta(kind=head bytes=1804) to S13@127.0.0.1:41913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S7] → sending delta(kind=head bytes=1793) to S4@127.0.0.1:41904
[S11] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:41908
[S3] not sending this round → trigger blocked (psi=0.998)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:41904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:41915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:41911
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:41917
[S6] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1793 to 1 peers)
[S2] sending update (kind=head size=1804 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1795) from S13
[S15] cosine check vs S13: cos=-0.0459
[S15] DROPPED delta from S13 (cos=-0.0459 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1799) from S4
[S7] cosine check vs S4: cos=0.9988
[S4] RECEIVED delta(kind=head bytes=1801) from S14
[S4] cosine check vs S14: cos=-0.0439
[S4] DROPPED delta from S14 (cos=-0.0439 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1793) from S7
[S4] cosine check vs S7: cos=0.9988
[S17] RECEIVED delta(kind=head bytes=1802) from S6
[S17] cosine check vs S6: cos=0.9876
[S13] RECEIVED delta(kind=head bytes=1804) from S2
[S13] cosine check vs S2: cos=-0.0950
[S13] DROPPED delta from S2 (cos=-0.0950 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1801) from S8
[S10] cosine check vs S8: cos=-0.0387
[S10] DROPPED delta from S8 (cos=-0.0387 < 0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=27 metric=0.6508 head_norm=1.826719
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.806394e-02
[S7] stored merged vector for next round verification (round=27)
[S7] DEBUG after merge:  round=27 metric=0.6460 head_norm=1.842919 delta_norm=0.048064
[S7] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=27 metric=0.9515 head_norm=1.860220
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.806394e-02
[S4] stored merged vector for next round verification (round=27)
[S4] DEBUG after merge:  round=27 metric=0.9515 head_norm=1.842919 delta_norm=0.048064
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=27 metric=0.4202 head_norm=1.293762
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.017488e-01
[S17] stored merged vector for next round verification (round=27)
[S17] DEBUG after merge:  round=27 metric=0.4143 head_norm=1.288025 delta_norm=0.101749
[S17] aggregate: ROLLBACK (f1_val pre=0.420 post=0.414 tol_abs=0.005 tol_rel=0.0)
[S16] CommDone barrier timeout: have=2 need=3 — continuing
[S2] START round=28 head_norm_before_train=1.529741 cos_to_last_merge=0.7761 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.776
[S2] round=28 local utility u=0.000000 metrics={'f1_val': 0.7156476131760653, 'auprc': 0.7942635387372152, 'loss_val': 0.6402824497327448, 'psi': 0.7470939834005252}-{'f1_val': 0.7109546951174711, 'auprc': 0.7944283965395896, 'loss_val': 0.5176246417612714, 'psi': 0.7443441756863185}
[S3] START round=28 head_norm_before_train=2.128344 (no previous merge yet)
[S3] round=28 local utility u=0.000000 metrics={'f1_val': 0.9143056500150413, 'auprc': 0.9978951458745375, 'loss_val': 0.25289051557610215, 'psi': 0.9477414483588398}-{'f1_val': 0.9977814963782642, 'auprc': 0.999205401702606, 'loss_val': 0.022028221973040163, 'psi': 0.9983510585080009}
[S4] START round=28 head_norm_before_train=1.842919 cos_to_last_merge=1.0000 (last merge round=27)
[S4] round=28 local utility u=0.000000 metrics={'f1_val': 0.9408492193281554, 'auprc': 0.9531213938578962, 'loss_val': 0.27937469153360217, 'psi': 0.9457580891400517}-{'f1_val': 0.9515385428056174, 'auprc': 0.9592912116087584, 'loss_val': 0.25322075641093994, 'psi': 0.9546396103268738}
[S5] START round=28 head_norm_before_train=1.791351 cos_to_last_merge=0.9960 (last merge round=23)
[S5] round=28 local utility u=0.000944 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9933269451132324, 'loss_val': 0.0351459895281093, 'psi': 0.9950423920308795}-{'f1_val': 0.996186023309311, 'auprc': 0.9933736435325938, 'loss_val': 0.037174876196323786, 'psi': 0.9950610713986241}
[S6] START round=28 head_norm_before_train=1.290312 cos_to_last_merge=0.9996 (last merge round=26)
[S6] round=28 local utility u=0.000000 metrics={'f1_val': 0.8216211145074124, 'auprc': 0.9640605429153251, 'loss_val': 0.4400702067532761, 'psi': 0.8785968858705775}-{'f1_val': 0.8271576521388151, 'auprc': 0.9686669791046526, 'loss_val': 0.347757212665263, 'psi': 0.88376138292515}
[S7] START round=28 head_norm_before_train=1.842919 cos_to_last_merge=1.0000 (last merge round=27)
[S7] round=28 local utility u=0.204880 metrics={'f1_val': 0.6860223354299062, 'auprc': 0.8089475096004103, 'loss_val': 0.38586454067177567, 'psi': 0.7351924050981078}-{'f1_val': 0.6508185696445489, 'auprc': 0.7951155877746867, 'loss_val': 0.542906557572369, 'psi': 0.7085373768966041}
[S8] START round=28 head_norm_before_train=1.928493 (no previous merge yet)
[S8] round=28 local utility u=0.000000 metrics={'f1_val': 0.9829451617404097, 'auprc': 0.998893830595103, 'loss_val': 0.06957069174446268, 'psi': 0.989324629282287}-{'f1_val': 0.9936566772467331, 'auprc': 0.9876414777794004, 'loss_val': 0.05239006949650269, 'psi': 0.9912505974598}
[S9] START round=28 head_norm_before_train=2.084603 (no previous merge yet)
[S9] round=28 local utility u=0.001428 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9976816172057692, 'loss_val': 0.01766472900613394, 'psi': 0.9973343943895934}-{'f1_val': 0.9958267183641853, 'auprc': 0.9996268766952752, 'loss_val': 0.018698564217928194, 'psi': 0.9973467816966213}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=28 head_norm_before_train=1.756627 cos_to_last_merge=0.8204 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.820
[S10] round=28 local utility u=0.001951 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9972974396788934, 'loss_val': 0.03984646316655325, 'psi': 0.9962847679805693}-{'f1_val': 0.9961684647169089, 'auprc': 0.9955202368804179, 'loss_val': 0.041769622502453974, 'psi': 0.9959091735823125}
[S11] START round=28 head_norm_before_train=1.998939 (no previous merge yet)
[S11] round=28 local utility u=0.000000 metrics={'f1_val': 0.9910208074589459, 'auprc': 0.9978712405620465, 'loss_val': 0.04392460050084606, 'psi': 0.9937609807001861}-{'f1_val': 0.9962850284706224, 'auprc': 0.9979391778865581, 'loss_val': 0.027596872534543657, 'psi': 0.9969466882369967}
[S13] START round=28 head_norm_before_train=1.738423 (no previous merge yet)
[S13] round=28 local utility u=0.000000 metrics={'f1_val': 0.5908006186151942, 'auprc': 0.6915766177341391, 'loss_val': 0.7882084367723798, 'psi': 0.6311110182627722}-{'f1_val': 0.6361042388537989, 'auprc': 0.6815713690347506, 'loss_val': 0.5807693946953778, 'psi': 0.6542910909261795}
[S14] START round=28 head_norm_before_train=1.629463 cos_to_last_merge=0.9772 (last merge round=19)
[S14] round=28 local utility u=0.003644 metrics={'f1_val': 0.9968300801588782, 'auprc': 0.9969563771710652, 'loss_val': 0.051169823554910766, 'psi': 0.996880598963753}-{'f1_val': 0.9965872316107504, 'auprc': 0.996692679696219, 'loss_val': 0.05621019359080057, 'psi': 0.9966294108449378}
[S15] START round=28 head_norm_before_train=1.572592 cos_to_last_merge=0.9858 (last merge round=19)
[S15] round=28 local utility u=0.000000 metrics={'f1_val': 0.6978293850702851, 'auprc': 0.9726027591268089, 'loss_val': 0.3810063136562232, 'psi': 0.8077387346928946}-{'f1_val': 0.7010056609658452, 'auprc': 0.9816858053458355, 'loss_val': 0.3627188658110721, 'psi': 0.8132777187178413}
[S16] START round=28 head_norm_before_train=1.660188 cos_to_last_merge=0.9998 (last merge round=26)
[S16] round=28 local utility u=0.164115 metrics={'f1_val': 0.8783578237585277, 'auprc': 0.9788855049504941, 'loss_val': 0.296290060623837, 'psi': 0.9185688962353142}-{'f1_val': 0.8603313334235025, 'auprc': 0.9818545413462698, 'loss_val': 0.5252684589922167, 'psi': 0.9089406165926094}
[S17] START round=28 head_norm_before_train=1.288025 cos_to_last_merge=1.0000 (last merge round=27)
[S17] round=28 local utility u=0.832523 metrics={'f1_val': 0.638038976832942, 'auprc': 0.8351709580334632, 'loss_val': 0.7446312105333134, 'psi': 0.7168917693131505}-{'f1_val': 0.4202455353232353, 'auprc': 0.7808968887341539, 'loss_val': 0.9400936576434159, 'psi': 0.5645060766876027}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:41916
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:41904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S10] → sending delta(kind=head bytes=1807) to S8@127.0.0.1:41909
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1807 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1804 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1807) from S10
[S8] cosine check vs S10: cos=-0.0382
[S8] DROPPED delta from S10 (cos=-0.0382 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1804) from S5
[S16] cosine check vs S5: cos=0.9668
[S4] RECEIVED delta(kind=head bytes=1801) from S7
[S4] cosine check vs S7: cos=0.9999
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:41904
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=28 metric=0.9408 head_norm=1.852983
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.209730e-02
[S4] stored merged vector for next round verification (round=28)
[S4] DEBUG after merge:  round=28 metric=0.9408 head_norm=1.852470 delta_norm=0.012097
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] sending update (kind=head size=1799 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1799) from S14
[S4] cosine check vs S14: cos=-0.0418
[S4] DROPPED delta from S14 (cos=-0.0418 < 0.0)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:41907
[S17] sending update (kind=head size=1798 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1798) from S17
[S6] cosine check vs S17: cos=0.9938
[S3]  timeout peer S8
[S15]  timeout peer S16
[S11]  timeout peer S14
[S14]  timeout peer S4
[S14]  timeout peer S17
[S4]  timeout peer S7
[S2]  timeout peer S13
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S6
[S16]  timeout peer S5
[S16]  timeout peer S9
[S16]  timeout peer S11
[S8]  timeout peer S10
[S13]  timeout peer S15
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=28 metric=0.8784 head_norm=1.686799
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.340038e-01
[S16] stored merged vector for next round verification (round=28)
[S16] DEBUG after merge:  round=28 metric=0.8789 head_norm=1.735336 delta_norm=0.234004
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=29 head_norm_before_train=1.544905 cos_to_last_merge=0.7748 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.775
[S2] round=29 local utility u=0.000000 metrics={'f1_val': 0.7125590217320807, 'auprc': 0.7945133710193587, 'loss_val': 0.6476333055762457, 'psi': 0.7453407614469919}-{'f1_val': 0.7156476131760653, 'auprc': 0.7942635387372152, 'loss_val': 0.6402824497327448, 'psi': 0.7470939834005252}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=29 head_norm_before_train=2.142518 (no previous merge yet)
[S3] round=29 local utility u=0.365701 metrics={'f1_val': 0.9978100342676263, 'auprc': 0.9994806652534916, 'loss_val': 0.027271414612887162, 'psi': 0.9984782866619724}-{'f1_val': 0.9143056500150413, 'auprc': 0.9978951458745375, 'loss_val': 0.25289051557610215, 'psi': 0.9477414483588398}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=29 head_norm_before_train=1.852470 cos_to_last_merge=1.0000 (last merge round=28)
[S4] round=29 local utility u=0.006677 metrics={'f1_val': 0.9419174489249282, 'auprc': 0.956045077421429, 'loss_val': 0.2812013725909985, 'psi': 0.9475685003235286}-{'f1_val': 0.9408492193281554, 'auprc': 0.9531213938578962, 'loss_val': 0.27937469153360217, 'psi': 0.9457580891400517}
[S5] START round=29 head_norm_before_train=1.813011 cos_to_last_merge=0.9947 (last merge round=23)
[S5] round=29 local utility u=0.001699 metrics={'f1_val': 0.996186023309311, 'auprc': 0.99383029011513, 'loss_val': 0.033258621358436054, 'psi': 0.9952437300316386}-{'f1_val': 0.996186023309311, 'auprc': 0.9933269451132324, 'loss_val': 0.0351459895281093, 'psi': 0.9950423920308795}
[S6] START round=29 head_norm_before_train=1.322594 cos_to_last_merge=0.9985 (last merge round=26)
[S6] round=29 local utility u=0.000000 metrics={'f1_val': 0.7492672850730225, 'auprc': 0.8555574948118939, 'loss_val': 0.5201751551878706, 'psi': 0.7917833689685712}-{'f1_val': 0.8216211145074124, 'auprc': 0.9640605429153251, 'loss_val': 0.4400702067532761, 'psi': 0.8785968858705775}
[S7] START round=29 head_norm_before_train=1.852037 cos_to_last_merge=0.9999 (last merge round=27)
[S7] round=29 local utility u=0.000000 metrics={'f1_val': 0.6320204893180015, 'auprc': 0.7936919439173118, 'loss_val': 0.5871884883305426, 'psi': 0.6966890711577256}-{'f1_val': 0.6860223354299062, 'auprc': 0.8089475096004103, 'loss_val': 0.38586454067177567, 'psi': 0.7351924050981078}
[S8] START round=29 head_norm_before_train=1.946243 (no previous merge yet)
[S8] round=29 local utility u=0.029682 metrics={'f1_val': 0.9931305635718065, 'auprc': 0.9886871698049042, 'loss_val': 0.04069972917119115, 'psi': 0.9913532060650456}-{'f1_val': 0.9829451617404097, 'auprc': 0.998893830595103, 'loss_val': 0.06957069174446268, 'psi': 0.989324629282287}
[S9] START round=29 head_norm_before_train=2.095235 (no previous merge yet)
[S9] round=29 local utility u=0.000000 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9996301098624527, 'loss_val': 0.018533578792026852, 'psi': 0.9976146613832247}-{'f1_val': 0.9971029125121428, 'auprc': 0.9976816172057692, 'loss_val': 0.01766472900613394, 'psi': 0.9973343943895934}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=29 head_norm_before_train=1.776859 cos_to_last_merge=0.8192 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.819
[S10] round=29 local utility u=0.000000 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9964468357305337, 'loss_val': 0.03904524810923408, 'psi': 0.9959445264012254}-{'f1_val': 0.9956096535150197, 'auprc': 0.9972974396788934, 'loss_val': 0.03984646316655325, 'psi': 0.9962847679805693}
[S11] START round=29 head_norm_before_train=2.015510 (no previous merge yet)
[S11] round=29 local utility u=0.024713 metrics={'f1_val': 0.9962850284706224, 'auprc': 0.9978739569952522, 'loss_val': 0.02609134956786229, 'psi': 0.9969205998804743}-{'f1_val': 0.9910208074589459, 'auprc': 0.9978712405620465, 'loss_val': 0.04392460050084606, 'psi': 0.9937609807001861}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=29 head_norm_before_train=1.745699 (no previous merge yet)
[S13] round=29 local utility u=0.128352 metrics={'f1_val': 0.6123492037464107, 'auprc': 0.6860113607340008, 'loss_val': 0.6441008050599789, 'psi': 0.6418140665414467}-{'f1_val': 0.5908006186151942, 'auprc': 0.6915766177341391, 'loss_val': 0.7882084367723798, 'psi': 0.6311110182627722}
[S14] START round=29 head_norm_before_train=1.652443 cos_to_last_merge=0.9753 (last merge round=19)
[S14] round=29 local utility u=0.005230 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9968935046473784, 'loss_val': 0.04298270663736108, 'psi': 0.9971016158824272}-{'f1_val': 0.9968300801588782, 'auprc': 0.9969563771710652, 'loss_val': 0.051169823554910766, 'psi': 0.996880598963753}
[S15] START round=29 head_norm_before_train=1.587922 cos_to_last_merge=0.9843 (last merge round=19)
[S15] round=29 local utility u=0.092959 metrics={'f1_val': 0.7161538018492382, 'auprc': 0.9829225632169549, 'loss_val': 0.3359935996463068, 'psi': 0.8228613063963248}-{'f1_val': 0.6978293850702851, 'auprc': 0.9726027591268089, 'loss_val': 0.3810063136562232, 'psi': 0.8077387346928946}
[S16] START round=29 head_norm_before_train=1.735336 cos_to_last_merge=1.0000 (last merge round=28)
[S16] round=29 local utility u=0.190288 metrics={'f1_val': 0.9332015567705262, 'auprc': 0.9902821391179599, 'loss_val': 0.27896566047264054, 'psi': 0.9560337897094997}-{'f1_val': 0.8783578237585277, 'auprc': 0.9788855049504941, 'loss_val': 0.296290060623837, 'psi': 0.9185688962353142}
[S17] START round=29 head_norm_before_train=1.305082 cos_to_last_merge=0.9999 (last merge round=27)
[S17] round=29 local utility u=0.000000 metrics={'f1_val': 0.6519151835966711, 'auprc': 0.8264115212505126, 'loss_val': 0.8155965528087842, 'psi': 0.7217137186582077}-{'f1_val': 0.638038976832942, 'auprc': 0.8351709580334632, 'loss_val': 0.7446312105333134, 'psi': 0.7168917693131505}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] sending update (kind=head size=1795 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S16] not sending this round → trigger blocked (psi=0.956)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] sending update (kind=head size=1804 to 1 peers)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=29 metric=0.7493 head_norm=1.357090
[S6] _apply_head_vector_avg (torch): Δ‖w‖=9.213576e-02
[S6] stored merged vector for next round verification (round=29)
[S6] DEBUG after merge:  round=29 metric=0.6582 head_norm=1.328148 delta_norm=0.092136
[S6] aggregate: ROLLBACK (f1_val pre=0.749 post=0.658 tol_abs=0.005 tol_rel=0.0)
[S2] START round=30 head_norm_before_train=1.559313 cos_to_last_merge=0.7733 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.773
[S2] round=30 local utility u=0.067128 metrics={'f1_val': 0.7130254863694112, 'auprc': 0.797881147919914, 'loss_val': 0.5262788401666826, 'psi': 0.7469677509896124}-{'f1_val': 0.7125590217320807, 'auprc': 0.7945133710193587, 'loss_val': 0.6476333055762457, 'psi': 0.7453407614469919}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] START round=30 head_norm_before_train=2.156074 (no previous merge yet)
[S3] round=30 local utility u=0.002604 metrics={'f1_val': 0.9977814963782642, 'auprc': 0.999539099641084, 'loss_val': 0.022066739055253543, 'psi': 0.9984845376833922}-{'f1_val': 0.9978100342676263, 'auprc': 0.9994806652534916, 'loss_val': 0.027271414612887162, 'psi': 0.9984782866619724}
[S3] not sending this round → trigger blocked (psi=0.998)
[S4] START round=30 head_norm_before_train=1.862902 cos_to_last_merge=1.0000 (last merge round=28)
[S4] round=30 local utility u=0.002432 metrics={'f1_val': 0.9429275102696866, 'auprc': 0.9533538990378162, 'loss_val': 0.2743239200898807, 'psi': 0.9470980657769384}-{'f1_val': 0.9419174489249282, 'auprc': 0.956045077421429, 'loss_val': 0.2812013725909985, 'psi': 0.9475685003235286}
[S5] START round=30 head_norm_before_train=1.835055 cos_to_last_merge=0.9927 (last merge round=23)
[S5] round=30 local utility u=0.004381 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9962141587234932, 'loss_val': 0.03164802541931979, 'psi': 0.9961972774749839}-{'f1_val': 0.996186023309311, 'auprc': 0.99383029011513, 'loss_val': 0.033258621358436054, 'psi': 0.9952437300316386}
[S6] START round=30 head_norm_before_train=1.328148 cos_to_last_merge=1.0000 (last merge round=29)
[S6] round=30 local utility u=0.442233 metrics={'f1_val': 0.8223082690941621, 'auprc': 0.9632544109399276, 'loss_val': 0.39704603875453426, 'psi': 0.8786867258324683}-{'f1_val': 0.7492672850730225, 'auprc': 0.8555574948118939, 'loss_val': 0.5201751551878706, 'psi': 0.7917833689685712}
[S7] START round=30 head_norm_before_train=1.862097 cos_to_last_merge=0.9998 (last merge round=27)
[S7] round=30 local utility u=0.000000 metrics={'f1_val': 0.6226839327337795, 'auprc': 0.7961289136731918, 'loss_val': 0.5659760367588345, 'psi': 0.6920619251095446}-{'f1_val': 0.6320204893180015, 'auprc': 0.7936919439173118, 'loss_val': 0.5871884883305426, 'psi': 0.6966890711577256}
[S8] START round=30 head_norm_before_train=1.963102 (no previous merge yet)
[S8] round=30 local utility u=0.000000 metrics={'f1_val': 0.9934960926894906, 'auprc': 0.9872622921091544, 'loss_val': 0.03928852202165689, 'psi': 0.9910025724573561}-{'f1_val': 0.9931305635718065, 'auprc': 0.9886871698049042, 'loss_val': 0.04069972917119115, 'psi': 0.9913532060650456}
[S9] START round=30 head_norm_before_train=2.107579 (no previous merge yet)
[S9] round=30 local utility u=0.000584 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9996285403165337, 'loss_val': 0.01736104803035797, 'psi': 0.9976140335648571}-{'f1_val': 0.9962710290637395, 'auprc': 0.9996301098624527, 'loss_val': 0.018533578792026852, 'psi': 0.9976146613832247}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=30 head_norm_before_train=1.791290 cos_to_last_merge=0.8188 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.819
[S10] round=30 local utility u=0.000995 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.996472152986319, 'loss_val': 0.03713116628999467, 'psi': 0.9959546533035395}-{'f1_val': 0.9956096535150197, 'auprc': 0.9964468357305337, 'loss_val': 0.03904524810923408, 'psi': 0.9959445264012254}
[S11] START round=30 head_norm_before_train=2.028002 (no previous merge yet)
[S11] round=30 local utility u=0.000000 metrics={'f1_val': 0.9501163995666159, 'auprc': 0.997717916697688, 'loss_val': 0.1799433353919557, 'psi': 0.9691570064190447}-{'f1_val': 0.9962850284706224, 'auprc': 0.9978739569952522, 'loss_val': 0.02609134956786229, 'psi': 0.9969205998804743}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=30 head_norm_before_train=1.754170 (no previous merge yet)
[S13] round=30 local utility u=0.000000 metrics={'f1_val': 0.5975644179914722, 'auprc': 0.6916152457063268, 'loss_val': 0.861767323128351, 'psi': 0.6351847490774141}-{'f1_val': 0.6123492037464107, 'auprc': 0.6860113607340008, 'loss_val': 0.6441008050599789, 'psi': 0.6418140665414467}
[S14] START round=30 head_norm_before_train=1.671933 cos_to_last_merge=0.9737 (last merge round=19)
[S14] round=30 local utility u=0.000604 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9969177029020688, 'loss_val': 0.04039095917404133, 'psi': 0.9969655860554265}-{'f1_val': 0.997240356705793, 'auprc': 0.9968935046473784, 'loss_val': 0.04298270663736108, 'psi': 0.9971016158824272}
[S15] START round=30 head_norm_before_train=1.602908 cos_to_last_merge=0.9829 (last merge round=19)
[S15] round=30 local utility u=0.967681 metrics={'f1_val': 0.9888878260555988, 'auprc': 0.9989105417143156, 'loss_val': 0.08500030583444719, 'psi': 0.9928969123190855}-{'f1_val': 0.7161538018492382, 'auprc': 0.9829225632169549, 'loss_val': 0.3359935996463068, 'psi': 0.8228613063963248}
[S16] START round=30 head_norm_before_train=1.758024 cos_to_last_merge=0.9998 (last merge round=28)
[S16] round=30 local utility u=0.000000 metrics={'f1_val': 0.8587135146959137, 'auprc': 0.9797309460349216, 'loss_val': 0.5427719072443306, 'psi': 0.9071204872315168}-{'f1_val': 0.9332015567705262, 'auprc': 0.9902821391179599, 'loss_val': 0.27896566047264054, 'psi': 0.9560337897094997}
[S17] START round=30 head_norm_before_train=1.323491 cos_to_last_merge=0.9994 (last merge round=27)
[S17] round=30 local utility u=0.389288 metrics={'f1_val': 0.7413670520743041, 'auprc': 0.8613930155337493, 'loss_val': 0.6786765571395318, 'psi': 0.7893774374580822}-{'f1_val': 0.6519151835966711, 'auprc': 0.8264115212505126, 'loss_val': 0.8155965528087842, 'psi': 0.7217137186582077}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.996)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.993)
[S14] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S4] not sending this round → trigger blocked (psi=0.947)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S2] START round=31 head_norm_before_train=1.572042 cos_to_last_merge=0.7717 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.772
[S2] round=31 local utility u=0.234847 metrics={'f1_val': 0.7644932700487461, 'auprc': 0.8093038205844652, 'loss_val': 0.39965951679738354, 'psi': 0.7824174902630338}-{'f1_val': 0.7130254863694112, 'auprc': 0.797881147919914, 'loss_val': 0.5262788401666826, 'psi': 0.7469677509896124}
[S2] not sending this round → trigger blocked (psi=0.782)
[S3] START round=31 head_norm_before_train=2.170256 (no previous merge yet)
[S3] round=31 local utility u=0.000000 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.999717625091983, 'loss_val': 0.13928885593059942, 'psi': 0.9765321012764655}-{'f1_val': 0.9977814963782642, 'auprc': 0.999539099641084, 'loss_val': 0.022066739055253543, 'psi': 0.9984845376833922}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=31 head_norm_before_train=1.873587 cos_to_last_merge=0.9998 (last merge round=28)
[S4] round=31 local utility u=0.000000 metrics={'f1_val': 0.9408424826094459, 'auprc': 0.9277666039593373, 'loss_val': 0.29392244798881284, 'psi': 0.9356121311494024}-{'f1_val': 0.9429275102696866, 'auprc': 0.9533538990378162, 'loss_val': 0.2743239200898807, 'psi': 0.9470980657769384}
[S5] START round=31 head_norm_before_train=1.858532 cos_to_last_merge=0.9906 (last merge round=23)
[S5] round=31 local utility u=0.001043 metrics={'f1_val': 0.9959673157242839, 'auprc': 0.9968742124549836, 'loss_val': 0.030229691382997668, 'psi': 0.9963300744165637}-{'f1_val': 0.996186023309311, 'auprc': 0.9962141587234932, 'loss_val': 0.03164802541931979, 'psi': 0.9961972774749839}
[S6] START round=31 head_norm_before_train=1.353092 cos_to_last_merge=0.9998 (last merge round=29)
[S6] round=31 local utility u=0.002189 metrics={'f1_val': 0.8239037796069149, 'auprc': 0.9652453495671935, 'loss_val': 0.408213501981343, 'psi': 0.8804404075910264}-{'f1_val': 0.8223082690941621, 'auprc': 0.9632544109399276, 'loss_val': 0.39704603875453426, 'psi': 0.8786867258324683}
[S7] START round=31 head_norm_before_train=1.871979 cos_to_last_merge=0.9997 (last merge round=27)
[S7] round=31 local utility u=0.060656 metrics={'f1_val': 0.6440913642836528, 'auprc': 0.8023348946365725, 'loss_val': 0.5917269568097026, 'psi': 0.7073887764248207}-{'f1_val': 0.6226839327337795, 'auprc': 0.7961289136731918, 'loss_val': 0.5659760367588345, 'psi': 0.6920619251095446}
[S8] START round=31 head_norm_before_train=1.979546 (no previous merge yet)
[S8] round=31 local utility u=0.000000 metrics={'f1_val': 0.9914482382097267, 'auprc': 0.9868083217667294, 'loss_val': 0.04043435779459376, 'psi': 0.9895922716325278}-{'f1_val': 0.9934960926894906, 'auprc': 0.9872622921091544, 'loss_val': 0.03928852202165689, 'psi': 0.9910025724573561}
[S9] START round=31 head_norm_before_train=2.119138 (no previous merge yet)
[S9] round=31 local utility u=0.000000 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9945763920636544, 'loss_val': 0.01865801495905685, 'psi': 0.9955806136930283}-{'f1_val': 0.9962710290637395, 'auprc': 0.9996285403165337, 'loss_val': 0.01736104803035797, 'psi': 0.9976140335648571}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=31 head_norm_before_train=1.807005 cos_to_last_merge=0.8181 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.818
[S10] round=31 local utility u=0.000402 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9962299379113091, 'loss_val': 0.03559958425310471, 'psi': 0.9958577672735356}-{'f1_val': 0.9956096535150197, 'auprc': 0.996472152986319, 'loss_val': 0.03713116628999467, 'psi': 0.9959546533035395}
[S11] START round=31 head_norm_before_train=2.036247 (no previous merge yet)
[S11] round=31 local utility u=0.216797 metrics={'f1_val': 0.9962850284706224, 'auprc': 0.9980344593726911, 'loss_val': 0.024310731942840075, 'psi': 0.9969848008314499}-{'f1_val': 0.9501163995666159, 'auprc': 0.997717916697688, 'loss_val': 0.1799433353919557, 'psi': 0.9691570064190447}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=31 head_norm_before_train=1.768158 (no previous merge yet)
[S13] round=31 local utility u=0.225773 metrics={'f1_val': 0.6141049120932462, 'auprc': 0.6868369408712056, 'loss_val': 0.4951298599519143, 'psi': 0.64319772360443}-{'f1_val': 0.5975644179914722, 'auprc': 0.6916152457063268, 'loss_val': 0.861767323128351, 'psi': 0.6351847490774141}
[S14] START round=31 head_norm_before_train=1.689675 cos_to_last_merge=0.9723 (last merge round=19)
[S14] round=31 local utility u=0.004967 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9986298261603896, 'loss_val': 0.03705132629216986, 'psi': 0.9977961444876318}-{'f1_val': 0.9969975081576651, 'auprc': 0.9969177029020688, 'loss_val': 0.04039095917404133, 'psi': 0.9969655860554265}
[S15] START round=31 head_norm_before_train=1.615687 cos_to_last_merge=0.9817 (last merge round=19)
[S15] round=31 local utility u=0.000000 metrics={'f1_val': 0.7010704228661029, 'auprc': 0.8542217701053167, 'loss_val': 0.457239961738411, 'psi': 0.7623309617617884}-{'f1_val': 0.9888878260555988, 'auprc': 0.9989105417143156, 'loss_val': 0.08500030583444719, 'psi': 0.9928969123190855}
[S16] START round=31 head_norm_before_train=1.781772 cos_to_last_merge=0.9993 (last merge round=28)
[S16] round=31 local utility u=0.000000 metrics={'f1_val': 0.8500349289915208, 'auprc': 0.9755916653106695, 'loss_val': 0.6786518045663414, 'psi': 0.9002576235191804}-{'f1_val': 0.8587135146959137, 'auprc': 0.9797309460349216, 'loss_val': 0.5427719072443306, 'psi': 0.9071204872315168}
[S17] START round=31 head_norm_before_train=1.345865 cos_to_last_merge=0.9984 (last merge round=27)
[S17] round=31 local utility u=0.000000 metrics={'f1_val': 0.6486495227746473, 'auprc': 0.8270626006529913, 'loss_val': 0.900899037108104, 'psi': 0.7200147539259849}-{'f1_val': 0.7413670520743041, 'auprc': 0.8613930155337493, 'loss_val': 0.6786765571395318, 'psi': 0.7893774374580822}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S10] not sending this round → trigger blocked (psi=0.996)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] sending update (kind=head size=1804 to 1 peers)
[S6] not sending this round → trigger blocked (psi=0.880)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=32 head_norm_before_train=1.583291 cos_to_last_merge=0.7701 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.770
[S2] round=32 local utility u=0.000000 metrics={'f1_val': 0.7111284990774546, 'auprc': 0.8476066963706262, 'loss_val': 0.42315897689468174, 'psi': 0.7657197779947233}-{'f1_val': 0.7644932700487461, 'auprc': 0.8093038205844652, 'loss_val': 0.39965951679738354, 'psi': 0.7824174902630338}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=32 head_norm_before_train=2.182487 (no previous merge yet)
[S3] round=32 local utility u=0.122733 metrics={'f1_val': 0.9873331884983466, 'auprc': 0.9998878687305194, 'loss_val': 0.051881410519534675, 'psi': 0.9923550605912157}-{'f1_val': 0.9610750853994537, 'auprc': 0.999717625091983, 'loss_val': 0.13928885593059942, 'psi': 0.9765321012764655}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=32 head_norm_before_train=1.882172 cos_to_last_merge=0.9997 (last merge round=28)
[S4] round=32 local utility u=0.047897 metrics={'f1_val': 0.9504123454638549, 'auprc': 0.9362332354606435, 'loss_val': 0.2809479056829434, 'psi': 0.9447407014625704}-{'f1_val': 0.9408424826094459, 'auprc': 0.9277666039593373, 'loss_val': 0.29392244798881284, 'psi': 0.9356121311494024}
[S5] START round=32 head_norm_before_train=1.877781 cos_to_last_merge=0.9896 (last merge round=23)
[S5] round=32 local utility u=0.001014 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9968528585676865, 'loss_val': 0.029448999673628, 'psi': 0.9964527574126611}-{'f1_val': 0.9959673157242839, 'auprc': 0.9968742124549836, 'loss_val': 0.030229691382997668, 'psi': 0.9963300744165637}
[S6] START round=32 head_norm_before_train=1.375334 cos_to_last_merge=0.9992 (last merge round=29)
[S6] round=32 local utility u=0.150061 metrics={'f1_val': 0.8623328800508288, 'auprc': 0.9677260386492621, 'loss_val': 0.34610717826899734, 'psi': 0.9044901434902022}-{'f1_val': 0.8239037796069149, 'auprc': 0.9652453495671935, 'loss_val': 0.408213501981343, 'psi': 0.8804404075910264}
[S7] START round=32 head_norm_before_train=1.881569 cos_to_last_merge=0.9996 (last merge round=27)
[S7] round=32 local utility u=0.000000 metrics={'f1_val': 0.6028650821233899, 'auprc': 0.7918133224805395, 'loss_val': 0.7512939983609652, 'psi': 0.6784443782662497}-{'f1_val': 0.6440913642836528, 'auprc': 0.8023348946365725, 'loss_val': 0.5917269568097026, 'psi': 0.7073887764248207}
[S8] START round=32 head_norm_before_train=1.991727 (no previous merge yet)
[S8] round=32 local utility u=0.001260 metrics={'f1_val': 0.9878817827888313, 'auprc': 0.9980598788182478, 'loss_val': 0.05027070524208567, 'psi': 0.9919530212005978}-{'f1_val': 0.9914482382097267, 'auprc': 0.9868083217667294, 'loss_val': 0.04043435779459376, 'psi': 0.9895922716325278}
[S9] START round=32 head_norm_before_train=2.127152 (no previous merge yet)
[S9] round=32 local utility u=0.010675 metrics={'f1_val': 0.9970714132027002, 'auprc': 0.9996576356559664, 'loss_val': 0.017478844000644502, 'psi': 0.9981059021840066}-{'f1_val': 0.9962500947792776, 'auprc': 0.9945763920636544, 'loss_val': 0.01865801495905685, 'psi': 0.9955806136930283}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=32 head_norm_before_train=1.823707 cos_to_last_merge=0.8172 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.817
[S10] round=32 local utility u=0.000654 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9963244594385126, 'loss_val': 0.03457520297483974, 'psi': 0.9958955758844169}-{'f1_val': 0.9956096535150197, 'auprc': 0.9962299379113091, 'loss_val': 0.03559958425310471, 'psi': 0.9958577672735356}
[S11] START round=32 head_norm_before_train=2.045141 (no previous merge yet)
[S11] round=32 local utility u=0.000993 metrics={'f1_val': 0.9965268648289654, 'auprc': 0.9979614229034736, 'loss_val': 0.023556934848762364, 'psi': 0.9971006880587686}-{'f1_val': 0.9962850284706224, 'auprc': 0.9980344593726911, 'loss_val': 0.024310731942840075, 'psi': 0.9969848008314499}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=32 head_norm_before_train=1.777596 (no previous merge yet)
[S13] round=32 local utility u=0.000000 metrics={'f1_val': 0.5951861545267823, 'auprc': 0.6994254874653482, 'loss_val': 0.7397023041814628, 'psi': 0.6368818877022087}-{'f1_val': 0.6141049120932462, 'auprc': 0.6868369408712056, 'loss_val': 0.4951298599519143, 'psi': 0.64319772360443}
[S14] START round=32 head_norm_before_train=1.705495 cos_to_last_merge=0.9711 (last merge round=19)
[S14] round=32 local utility u=0.000000 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.9969608427050236, 'loss_val': 0.037053603440436955, 'psi': 0.9967366760484596}-{'f1_val': 0.997240356705793, 'auprc': 0.9986298261603896, 'loss_val': 0.03705132629216986, 'psi': 0.9977961444876318}
[S15] START round=32 head_norm_before_train=1.625740 cos_to_last_merge=0.9808 (last merge round=19)
[S15] round=32 local utility u=1.000000 metrics={'f1_val': 0.9883326374361545, 'auprc': 0.9990154851599897, 'loss_val': 0.07554335474948047, 'psi': 0.9926057765256886}-{'f1_val': 0.7010704228661029, 'auprc': 0.8542217701053167, 'loss_val': 0.457239961738411, 'psi': 0.7623309617617884}
[S16] START round=32 head_norm_before_train=1.801254 cos_to_last_merge=0.9985 (last merge round=28)
[S16] round=32 local utility u=0.743383 metrics={'f1_val': 0.9904867295632591, 'auprc': 0.9907092354776954, 'loss_val': 0.07994955658698749, 'psi': 0.9905757319290336}-{'f1_val': 0.8500349289915208, 'auprc': 0.9755916653106695, 'loss_val': 0.6786518045663414, 'psi': 0.9002576235191804}
[S17] START round=32 head_norm_before_train=1.366689 cos_to_last_merge=0.9971 (last merge round=27)
[S17] round=32 local utility u=0.368784 metrics={'f1_val': 0.6820777639144742, 'auprc': 0.8988236178301602, 'loss_val': 0.5791833875713728, 'psi': 0.7687761054807486}-{'f1_val': 0.6486495227746473, 'auprc': 0.8270626006529913, 'loss_val': 0.900899037108104, 'psi': 0.7200147539259849}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S10] sending update (kind=head size=1809 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] sending update (kind=head size=1802 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] sending update (kind=head size=1805 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] not sending this round → trigger blocked (psi=0.996)
[S2] START round=33 head_norm_before_train=1.595062 cos_to_last_merge=0.7686 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.769
[S2] round=33 local utility u=0.000000 metrics={'f1_val': 0.7141285661267246, 'auprc': 0.8334983656609647, 'loss_val': 0.5632808905795844, 'psi': 0.7618764859404206}-{'f1_val': 0.7111284990774546, 'auprc': 0.8476066963706262, 'loss_val': 0.42315897689468174, 'psi': 0.7657197779947233}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=33 head_norm_before_train=2.196113 (no previous merge yet)
[S3] round=33 local utility u=0.000000 metrics={'f1_val': 0.9647628391264124, 'auprc': 0.9998879805898698, 'loss_val': 0.07773480688696482, 'psi': 0.9788128957117954}-{'f1_val': 0.9873331884983466, 'auprc': 0.9998878687305194, 'loss_val': 0.051881410519534675, 'psi': 0.9923550605912157}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=33 head_norm_before_train=1.893570 cos_to_last_merge=0.9995 (last merge round=28)
[S4] round=33 local utility u=0.015167 metrics={'f1_val': 0.9498793520840784, 'auprc': 0.9460416619259704, 'loss_val': 0.2768413826030925, 'psi': 0.9483442760208352}-{'f1_val': 0.9504123454638549, 'auprc': 0.9362332354606435, 'loss_val': 0.2809479056829434, 'psi': 0.9447407014625704}
[S5] START round=33 head_norm_before_train=1.891551 cos_to_last_merge=0.9888 (last merge round=23)
[S5] round=33 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9937943605734993, 'loss_val': 0.030004209327275794, 'psi': 0.9952293582149864}-{'f1_val': 0.996186023309311, 'auprc': 0.9968528585676865, 'loss_val': 0.029448999673628, 'psi': 0.9964527574126611}
[S6] START round=33 head_norm_before_train=1.399317 cos_to_last_merge=0.9984 (last merge round=29)
[S6] round=33 local utility u=0.000000 metrics={'f1_val': 0.8087621452458648, 'auprc': 0.9621776645891846, 'loss_val': 0.44813711919726634, 'psi': 0.8701283529831927}-{'f1_val': 0.8623328800508288, 'auprc': 0.9677260386492621, 'loss_val': 0.34610717826899734, 'psi': 0.9044901434902022}
[S7] START round=33 head_norm_before_train=1.888487 cos_to_last_merge=0.9994 (last merge round=27)
[S7] round=33 local utility u=0.142327 metrics={'f1_val': 0.6275593453009076, 'auprc': 0.7945307042302576, 'loss_val': 0.6229576567930004, 'psi': 0.6943478888726476}-{'f1_val': 0.6028650821233899, 'auprc': 0.7918133224805395, 'loss_val': 0.7512939983609652, 'psi': 0.6784443782662497}
[S8] START round=33 head_norm_before_train=2.004575 (no previous merge yet)
[S8] round=33 local utility u=0.000000 metrics={'f1_val': 0.9227052115115575, 'auprc': 0.9857732011938849, 'loss_val': 0.11517668194977641, 'psi': 0.9479324073844885}-{'f1_val': 0.9878817827888313, 'auprc': 0.9980598788182478, 'loss_val': 0.05027070524208567, 'psi': 0.9919530212005978}
[S9] START round=33 head_norm_before_train=2.134184 (no previous merge yet)
[S9] round=33 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9961590685414363, 'loss_val': 0.018107987540424333, 'psi': 0.9964599345049094}-{'f1_val': 0.9970714132027002, 'auprc': 0.9996576356559664, 'loss_val': 0.017478844000644502, 'psi': 0.9981059021840066}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=33 head_norm_before_train=1.840458 cos_to_last_merge=0.8162 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.816
[S10] round=33 local utility u=0.000349 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9963376179588823, 'loss_val': 0.03391638960915299, 'psi': 0.9959008392925648}-{'f1_val': 0.9956096535150197, 'auprc': 0.9963244594385126, 'loss_val': 0.03457520297483974, 'psi': 0.9958955758844169}
[S11] START round=33 head_norm_before_train=2.055450 (no previous merge yet)
[S11] round=33 local utility u=0.000000 metrics={'f1_val': 0.9688684889517291, 'auprc': 0.9982245842011281, 'loss_val': 0.0943525159533084, 'psi': 0.9806109270514887}-{'f1_val': 0.9965268648289654, 'auprc': 0.9979614229034736, 'loss_val': 0.023556934848762364, 'psi': 0.9971006880587686}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=33 head_norm_before_train=1.785726 (no previous merge yet)
[S13] round=33 local utility u=0.000000 metrics={'f1_val': 0.5872916295330228, 'auprc': 0.5836359571715389, 'loss_val': 0.8689422409757575, 'psi': 0.5858293605884293}-{'f1_val': 0.5951861545267823, 'auprc': 0.6994254874653482, 'loss_val': 0.7397023041814628, 'psi': 0.6368818877022087}
[S14] START round=33 head_norm_before_train=1.720435 cos_to_last_merge=0.9699 (last merge round=19)
[S14] round=33 local utility u=0.000000 metrics={'f1_val': 0.9963442551067831, 'auprc': 0.9964601339517367, 'loss_val': 0.0392789332313632, 'psi': 0.9963906066447645}-{'f1_val': 0.9965872316107504, 'auprc': 0.9969608427050236, 'loss_val': 0.037053603440436955, 'psi': 0.9967366760484596}
[S15] START round=33 head_norm_before_train=1.637724 cos_to_last_merge=0.9797 (last merge round=19)
[S15] round=33 local utility u=0.000000 metrics={'f1_val': 0.8368548575940586, 'auprc': 0.9914660395345031, 'loss_val': 0.1928364581170103, 'psi': 0.8986993303702364}-{'f1_val': 0.9883326374361545, 'auprc': 0.9990154851599897, 'loss_val': 0.07554335474948047, 'psi': 0.9926057765256886}
[S16] START round=33 head_norm_before_train=1.818625 cos_to_last_merge=0.9976 (last merge round=28)
[S16] round=33 local utility u=0.000000 metrics={'f1_val': 0.9858827664680532, 'auprc': 0.99198276598941, 'loss_val': 0.09034430105044346, 'psi': 0.9883227662765959}-{'f1_val': 0.9904867295632591, 'auprc': 0.9907092354776954, 'loss_val': 0.07994955658698749, 'psi': 0.9905757319290336}
[S17] START round=33 head_norm_before_train=1.383859 cos_to_last_merge=0.9959 (last merge round=27)
[S17] round=33 local utility u=0.000000 metrics={'f1_val': 0.6643467057736341, 'auprc': 0.8787730628302958, 'loss_val': 0.6110368829095117, 'psi': 0.7501172485962988}-{'f1_val': 0.6820777639144742, 'auprc': 0.8988236178301602, 'loss_val': 0.5791833875713728, 'psi': 0.7687761054807486}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.948)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.996)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=34 head_norm_before_train=1.609222 cos_to_last_merge=0.7668 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.767
[S2] round=34 local utility u=0.024460 metrics={'f1_val': 0.7556314950213405, 'auprc': 0.7830368250380966, 'loss_val': 0.6119934547022056, 'psi': 0.7665936270280429}-{'f1_val': 0.7141285661267246, 'auprc': 0.8334983656609647, 'loss_val': 0.5632808905795844, 'psi': 0.7618764859404206}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S2] sending update (kind=head size=1806 to 1 peers)
[S3] START round=34 head_norm_before_train=2.210618 (no previous merge yet)
[S3] round=34 local utility u=0.057347 metrics={'f1_val': 0.982745947660243, 'auprc': 0.9996707773369194, 'loss_val': 0.07028798972503031, 'psi': 0.9895158795309136}-{'f1_val': 0.9647628391264124, 'auprc': 0.9998879805898698, 'loss_val': 0.07773480688696482, 'psi': 0.9788128957117954}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=34 head_norm_before_train=1.901920 cos_to_last_merge=0.9993 (last merge round=28)
[S4] round=34 local utility u=0.000000 metrics={'f1_val': 0.9432338746692952, 'auprc': 0.9255958164039435, 'loss_val': 0.28426418640597984, 'psi': 0.9361786513631545}-{'f1_val': 0.9498793520840784, 'auprc': 0.9460416619259704, 'loss_val': 0.2768413826030925, 'psi': 0.9483442760208352}
[S5] START round=34 head_norm_before_train=1.896996 cos_to_last_merge=0.9876 (last merge round=23)
[S5] round=34 local utility u=0.002641 metrics={'f1_val': 0.9958213694443535, 'auprc': 0.9964126799129747, 'loss_val': 0.030389969872853778, 'psi': 0.996057893631802}-{'f1_val': 0.996186023309311, 'auprc': 0.9937943605734993, 'loss_val': 0.030004209327275794, 'psi': 0.9952293582149864}
[S6] START round=34 head_norm_before_train=1.417048 cos_to_last_merge=0.9976 (last merge round=29)
[S6] round=34 local utility u=0.157452 metrics={'f1_val': 0.8329767624173087, 'auprc': 0.9673421619641956, 'loss_val': 0.2940135483334169, 'psi': 0.8867229222360635}-{'f1_val': 0.8087621452458648, 'auprc': 0.9621776645891846, 'loss_val': 0.44813711919726634, 'psi': 0.8701283529831927}
[S7] START round=34 head_norm_before_train=1.897310 cos_to_last_merge=0.9989 (last merge round=27)
[S7] round=34 local utility u=0.687799 metrics={'f1_val': 0.720636337529942, 'auprc': 0.9280090003746682, 'loss_val': 0.20625556567436396, 'psi': 0.8035854026678325}-{'f1_val': 0.6275593453009076, 'auprc': 0.7945307042302576, 'loss_val': 0.6229576567930004, 'psi': 0.6943478888726476}
[S8] START round=34 head_norm_before_train=2.016449 (no previous merge yet)
[S8] round=34 local utility u=0.249213 metrics={'f1_val': 0.9915010556655176, 'auprc': 0.9896706655541558, 'loss_val': 0.04121836911502984, 'psi': 0.9907688996209729}-{'f1_val': 0.9227052115115575, 'auprc': 0.9857732011938849, 'loss_val': 0.11517668194977641, 'psi': 0.9479324073844885}
[S9] START round=34 head_norm_before_train=2.144840 (no previous merge yet)
[S9] round=34 local utility u=0.000000 metrics={'f1_val': 0.9880286744602689, 'auprc': 0.9999730081176758, 'loss_val': 0.045465481723578664, 'psi': 0.9928064079232316}-{'f1_val': 0.9966605118138915, 'auprc': 0.9961590685414363, 'loss_val': 0.018107987540424333, 'psi': 0.9964599345049094}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=34 head_norm_before_train=1.850296 cos_to_last_merge=0.8162 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.816
[S10] round=34 local utility u=0.000061 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9960701818873816, 'loss_val': 0.032991973637595054, 'psi': 0.9957938648639646}-{'f1_val': 0.9956096535150197, 'auprc': 0.9963376179588823, 'loss_val': 0.03391638960915299, 'psi': 0.9959008392925648}
[S11] START round=34 head_norm_before_train=2.066342 (no previous merge yet)
[S11] round=34 local utility u=0.119001 metrics={'f1_val': 0.9965268648289654, 'auprc': 0.9983177182541263, 'loss_val': 0.022579384200360757, 'psi': 0.9972432061990297}-{'f1_val': 0.9688684889517291, 'auprc': 0.9982245842011281, 'loss_val': 0.0943525159533084, 'psi': 0.9806109270514887}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=34 head_norm_before_train=1.797407 (no previous merge yet)
[S13] round=34 local utility u=0.276386 metrics={'f1_val': 0.5914905396995178, 'auprc': 0.7060641240275078, 'loss_val': 0.7086489130495018, 'psi': 0.6373199734307138}-{'f1_val': 0.5872916295330228, 'auprc': 0.5836359571715389, 'loss_val': 0.8689422409757575, 'psi': 0.5858293605884293}
[S14] START round=34 head_norm_before_train=1.733372 cos_to_last_merge=0.9686 (last merge round=19)
[S14] round=34 local utility u=0.007883 metrics={'f1_val': 0.9968300801588782, 'auprc': 0.9985547397813271, 'loss_val': 0.032711152092409025, 'psi': 0.9975199440078577}-{'f1_val': 0.9963442551067831, 'auprc': 0.9964601339517367, 'loss_val': 0.0392789332313632, 'psi': 0.9963906066447645}
[S15] START round=34 head_norm_before_train=1.648787 cos_to_last_merge=0.9788 (last merge round=19)
[S15] round=34 local utility u=0.000000 metrics={'f1_val': 0.7010713433702593, 'auprc': 0.7991500958339477, 'loss_val': 0.5054657180906884, 'psi': 0.7403028443557347}-{'f1_val': 0.8368548575940586, 'auprc': 0.9914660395345031, 'loss_val': 0.1928364581170103, 'psi': 0.8986993303702364}
[S16] START round=34 head_norm_before_train=1.836415 cos_to_last_merge=0.9967 (last merge round=28)
[S16] round=34 local utility u=0.000000 metrics={'f1_val': 0.8468637182996698, 'auprc': 0.9578300140222229, 'loss_val': 0.8338142780539074, 'psi': 0.891250236588691}-{'f1_val': 0.9858827664680532, 'auprc': 0.99198276598941, 'loss_val': 0.09034430105044346, 'psi': 0.9883227662765959}
[S17] START round=34 head_norm_before_train=1.397921 cos_to_last_merge=0.9950 (last merge round=27)
[S17] round=34 local utility u=0.000000 metrics={'f1_val': 0.6536232536951849, 'auprc': 0.8640812444808375, 'loss_val': 0.8272447369275782, 'psi': 0.7378064500094459}-{'f1_val': 0.6643467057736341, 'auprc': 0.8787730628302958, 'loss_val': 0.6110368829095117, 'psi': 0.7501172485962988}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] not sending this round → trigger blocked (psi=0.804)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=35 head_norm_before_train=1.624798 cos_to_last_merge=0.7645 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.765
[S2] round=35 local utility u=0.000000 metrics={'f1_val': 0.7168047568405057, 'auprc': 0.7583521222642982, 'loss_val': 0.7832523141440406, 'psi': 0.7334237030100227}-{'f1_val': 0.7556314950213405, 'auprc': 0.7830368250380966, 'loss_val': 0.6119934547022056, 'psi': 0.7665936270280429}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=35 head_norm_before_train=2.224590 (no previous merge yet)
[S3] round=35 local utility u=0.000000 metrics={'f1_val': 0.9625030579278266, 'auprc': 0.9998521585331434, 'loss_val': 0.09168315389682001, 'psi': 0.9774426981699533}-{'f1_val': 0.982745947660243, 'auprc': 0.9996707773369194, 'loss_val': 0.07028798972503031, 'psi': 0.9895158795309136}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=35 head_norm_before_train=1.909019 cos_to_last_merge=0.9991 (last merge round=28)
[S4] round=35 local utility u=0.020890 metrics={'f1_val': 0.9421533921694851, 'auprc': 0.9450724411023795, 'loss_val': 0.29443066390376943, 'psi': 0.9433210117426429}-{'f1_val': 0.9432338746692952, 'auprc': 0.9255958164039435, 'loss_val': 0.28426418640597984, 'psi': 0.9361786513631545}
[S5] START round=35 head_norm_before_train=1.904588 cos_to_last_merge=0.9868 (last merge round=23)
[S5] round=35 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9928737329568071, 'loss_val': 0.029910380952636918, 'psi': 0.9948611071683094}-{'f1_val': 0.9958213694443535, 'auprc': 0.9964126799129747, 'loss_val': 0.030389969872853778, 'psi': 0.996057893631802}
[S6] START round=35 head_norm_before_train=1.437055 cos_to_last_merge=0.9966 (last merge round=29)
[S6] round=35 local utility u=0.048878 metrics={'f1_val': 0.8679559186740389, 'auprc': 0.9657978128823315, 'loss_val': 0.40149969060263657, 'psi': 0.9070926763573559}-{'f1_val': 0.8329767624173087, 'auprc': 0.9673421619641956, 'loss_val': 0.2940135483334169, 'psi': 0.8867229222360635}
[S7] START round=35 head_norm_before_train=1.903285 cos_to_last_merge=0.9989 (last merge round=27)
[S7] round=35 local utility u=0.000000 metrics={'f1_val': 0.6580601609767271, 'auprc': 0.808805256465025, 'loss_val': 0.43403605063177486, 'psi': 0.7183581991720462}-{'f1_val': 0.720636337529942, 'auprc': 0.9280090003746682, 'loss_val': 0.20625556567436396, 'psi': 0.8035854026678325}
[S8] START round=35 head_norm_before_train=2.027562 (no previous merge yet)
[S8] round=35 local utility u=0.000989 metrics={'f1_val': 0.9932955872009759, 'auprc': 0.986670274727863, 'loss_val': 0.04100562063028949, 'psi': 0.9906454622117307}-{'f1_val': 0.9915010556655176, 'auprc': 0.9896706655541558, 'loss_val': 0.04121836911502984, 'psi': 0.9907688996209729}
[S9] START round=35 head_norm_before_train=2.150822 (no previous merge yet)
[S9] round=35 local utility u=0.041232 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.999632349082524, 'loss_val': 0.01642435528375187, 'psi': 0.9981146871402953}-{'f1_val': 0.9880286744602689, 'auprc': 0.9999730081176758, 'loss_val': 0.045465481723578664, 'psi': 0.9928064079232316}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=35 head_norm_before_train=1.862152 cos_to_last_merge=0.8157 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.816
[S10] round=35 local utility u=0.000459 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9961566674495183, 'loss_val': 0.03233290865635312, 'psi': 0.9958284590888191}-{'f1_val': 0.9956096535150197, 'auprc': 0.9960701818873816, 'loss_val': 0.032991973637595054, 'psi': 0.9957938648639646}
[S11] START round=35 head_norm_before_train=2.075071 (no previous merge yet)
[S11] round=35 local utility u=0.000000 metrics={'f1_val': 0.9941251891990488, 'auprc': 0.9982914581306228, 'loss_val': 0.028712289360506956, 'psi': 0.9957916967716784}-{'f1_val': 0.9965268648289654, 'auprc': 0.9983177182541263, 'loss_val': 0.022579384200360757, 'psi': 0.9972432061990297}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=35 head_norm_before_train=1.805574 (no previous merge yet)
[S13] round=35 local utility u=0.019704 metrics={'f1_val': 0.611545570868094, 'auprc': 0.7196247504776414, 'loss_val': 0.8302533239046983, 'psi': 0.654777242711913}-{'f1_val': 0.5914905396995178, 'auprc': 0.7060641240275078, 'loss_val': 0.7086489130495018, 'psi': 0.6373199734307138}
[S14] START round=35 head_norm_before_train=1.746363 cos_to_last_merge=0.9674 (last merge round=19)
[S14] round=35 local utility u=0.000000 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.996907345397587, 'loss_val': 0.0325524861962941, 'psi': 0.996715277125485}-{'f1_val': 0.9968300801588782, 'auprc': 0.9985547397813271, 'loss_val': 0.032711152092409025, 'psi': 0.9975199440078577}
[S15] START round=35 head_norm_before_train=1.660307 cos_to_last_merge=0.9779 (last merge round=19)
[S15] round=35 local utility u=0.032036 metrics={'f1_val': 0.7009191843683342, 'auprc': 0.8158214144950289, 'loss_val': 0.49049429332390704, 'psi': 0.7468800764190121}-{'f1_val': 0.7010713433702593, 'auprc': 0.7991500958339477, 'loss_val': 0.5054657180906884, 'psi': 0.7403028443557347}
[S16] START round=35 head_norm_before_train=1.852120 cos_to_last_merge=0.9959 (last merge round=28)
[S16] round=35 local utility u=0.280377 metrics={'f1_val': 0.8656106090278518, 'auprc': 0.9648496213029102, 'loss_val': 0.40660044350434194, 'psi': 0.9053062139378751}-{'f1_val': 0.8468637182996698, 'auprc': 0.9578300140222229, 'loss_val': 0.8338142780539074, 'psi': 0.891250236588691}
[S17] START round=35 head_norm_before_train=1.411322 cos_to_last_merge=0.9940 (last merge round=27)
[S17] round=35 local utility u=0.196921 metrics={'f1_val': 0.6702427832026749, 'auprc': 0.8920291962643361, 'loss_val': 0.6169632263398891, 'psi': 0.7589573484273394}-{'f1_val': 0.6536232536951849, 'auprc': 0.8640812444808375, 'loss_val': 0.8272447369275782, 'psi': 0.7378064500094459}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S13]  timeout peer S2
[S5]  timeout peer S16
[S8]  timeout peer S3
[S15]  timeout peer S13
[S4]  timeout peer S14
[S10]  timeout peer S8
[S7]  timeout peer S4
[S14]  timeout peer S11
[S16]  timeout peer S15
[S6]  timeout peer S17
[S10] not sending this round → trigger blocked (psi=0.996)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S13] not sending this round → trigger blocked (psi=0.655)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S8] not sending this round → trigger blocked (psi=0.991)
[S6] not sending this round → trigger blocked (psi=0.907)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S2] START round=36 head_norm_before_train=1.640040 cos_to_last_merge=0.7625 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.762
[S2] round=36 local utility u=0.243979 metrics={'f1_val': 0.7181370344824083, 'auprc': 0.8461811252014932, 'loss_val': 0.5667745296452984, 'psi': 0.7693546707700423}-{'f1_val': 0.7168047568405057, 'auprc': 0.7583521222642982, 'loss_val': 0.7832523141440406, 'psi': 0.7334237030100227}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] sending update (kind=head size=1804 to 1 peers)
[S3] START round=36 head_norm_before_train=2.239121 (no previous merge yet)
[S3] round=36 local utility u=0.000000 metrics={'f1_val': 0.8833288250993662, 'auprc': 0.9986356774795069, 'loss_val': 0.1686969167002498, 'psi': 0.9294515660514224}-{'f1_val': 0.9625030579278266, 'auprc': 0.9998521585331434, 'loss_val': 0.09168315389682001, 'psi': 0.9774426981699533}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=36 head_norm_before_train=1.916874 cos_to_last_merge=0.9990 (last merge round=28)
[S4] round=36 local utility u=0.023457 metrics={'f1_val': 0.9421248865567184, 'auprc': 0.9591048772662394, 'loss_val': 0.28944373947585433, 'psi': 0.9489168828405268}-{'f1_val': 0.9421533921694851, 'auprc': 0.9450724411023795, 'loss_val': 0.29443066390376943, 'psi': 0.9433210117426429}
[S4] not sending this round → trigger blocked (psi=0.949)
[S5] START round=36 head_norm_before_train=1.912884 cos_to_last_merge=0.9865 (last merge round=23)
[S5] round=36 local utility u=0.001681 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9935142338961443, 'loss_val': 0.028470171887876435, 'psi': 0.9951173075440444}-{'f1_val': 0.996186023309311, 'auprc': 0.9928737329568071, 'loss_val': 0.029910380952636918, 'psi': 0.9948611071683094}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S5] sending update (kind=head size=1809 to 1 peers)
[S6] START round=36 head_norm_before_train=1.457243 cos_to_last_merge=0.9957 (last merge round=29)
[S6] round=36 local utility u=0.000000 metrics={'f1_val': 0.8253244168354817, 'auprc': 0.9699704801925457, 'loss_val': 0.3755352974969437, 'psi': 0.8831828421783073}-{'f1_val': 0.8679559186740389, 'auprc': 0.9657978128823315, 'loss_val': 0.40149969060263657, 'psi': 0.9070926763573559}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=36 head_norm_before_train=1.908660 cos_to_last_merge=0.9989 (last merge round=27)
[S7] round=36 local utility u=0.000000 metrics={'f1_val': 0.49279845675806677, 'auprc': 0.7807612072881298, 'loss_val': 1.1043794520186485, 'psi': 0.607983556970092}-{'f1_val': 0.6580601609767271, 'auprc': 0.808805256465025, 'loss_val': 0.43403605063177486, 'psi': 0.7183581991720462}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=36 head_norm_before_train=2.036795 (no previous merge yet)
[S8] round=36 local utility u=0.000000 metrics={'f1_val': 0.9677418263091169, 'auprc': 0.9990252724147177, 'loss_val': 0.10009231867342715, 'psi': 0.9802552047513572}-{'f1_val': 0.9932955872009759, 'auprc': 0.986670274727863, 'loss_val': 0.04100562063028949, 'psi': 0.9906454622117307}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=36 head_norm_before_train=2.153378 (no previous merge yet)
[S9] round=36 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9978574739795519, 'loss_val': 0.016952518648780918, 'psi': 0.9974047370991065}-{'f1_val': 0.9971029125121428, 'auprc': 0.999632349082524, 'loss_val': 0.01642435528375187, 'psi': 0.9981146871402953}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=36 head_norm_before_train=1.874848 cos_to_last_merge=0.8151 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.815
[S10] round=36 local utility u=0.000227 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.996168400568212, 'loss_val': 0.03191424824934735, 'psi': 0.9958331523362967}-{'f1_val': 0.9956096535150197, 'auprc': 0.9961566674495183, 'loss_val': 0.03233290865635312, 'psi': 0.9958284590888191}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=36 head_norm_before_train=2.082748 (no previous merge yet)
[S11] round=36 local utility u=0.009934 metrics={'f1_val': 0.9965268648289654, 'auprc': 0.9981120997677926, 'loss_val': 0.022715900015559558, 'psi': 0.9971609588044963}-{'f1_val': 0.9941251891990488, 'auprc': 0.9982914581306228, 'loss_val': 0.028712289360506956, 'psi': 0.9957916967716784}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] sending update (kind=head size=1794 to 1 peers)
[S13] START round=36 head_norm_before_train=1.812588 (no previous merge yet)
[S13] round=36 local utility u=0.036728 metrics={'f1_val': 0.6196913228903439, 'auprc': 0.700578180377897, 'loss_val': 0.7485330408054618, 'psi': 0.6520460658853651}-{'f1_val': 0.611545570868094, 'auprc': 0.7196247504776414, 'loss_val': 0.8302533239046983, 'psi': 0.654777242711913}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=36 head_norm_before_train=1.759091 cos_to_last_merge=0.9663 (last merge round=19)
[S14] round=36 local utility u=0.000000 metrics={'f1_val': 0.996754531653698, 'auprc': 0.9954227986548968, 'loss_val': 0.03272363223566908, 'psi': 0.9962218384541776}-{'f1_val': 0.9965872316107504, 'auprc': 0.996907345397587, 'loss_val': 0.0325524861962941, 'psi': 0.996715277125485}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=36 head_norm_before_train=1.668739 cos_to_last_merge=0.9769 (last merge round=19)
[S15] round=36 local utility u=1.000000 metrics={'f1_val': 0.9589822842717, 'auprc': 0.9987936209739166, 'loss_val': 0.1542465258307013, 'psi': 0.9749068189525867}-{'f1_val': 0.7009191843683342, 'auprc': 0.8158214144950289, 'loss_val': 0.49049429332390704, 'psi': 0.7468800764190121}
[S15] not sending this round → trigger blocked (psi=0.975)
[S16] START round=36 head_norm_before_train=1.865924 cos_to_last_merge=0.9951 (last merge round=28)
[S16] round=36 local utility u=0.335620 metrics={'f1_val': 0.938988101666799, 'auprc': 0.9871092475581866, 'loss_val': 0.24240486296602318, 'psi': 0.958236560023354}-{'f1_val': 0.8656106090278518, 'auprc': 0.9648496213029102, 'loss_val': 0.40660044350434194, 'psi': 0.9053062139378751}
[S16] not sending this round → trigger blocked (psi=0.958)
[S17] START round=36 head_norm_before_train=1.426398 cos_to_last_merge=0.9928 (last merge round=27)
[S17] round=36 local utility u=0.000000 metrics={'f1_val': 0.66174376001786, 'auprc': 0.8889248955621419, 'loss_val': 0.7258247158775324, 'psi': 0.7526162142355728}-{'f1_val': 0.6702427832026749, 'auprc': 0.8920291962643361, 'loss_val': 0.6169632263398891, 'psi': 0.7589573484273394}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=37 head_norm_before_train=1.658080 cos_to_last_merge=0.7601 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.760
[S2] round=37 local utility u=0.000000 metrics={'f1_val': 0.7526843048742162, 'auprc': 0.714151122887982, 'loss_val': 0.6227635188967171, 'psi': 0.7372710320797224}-{'f1_val': 0.7181370344824083, 'auprc': 0.8461811252014932, 'loss_val': 0.5667745296452984, 'psi': 0.7693546707700423}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=37 head_norm_before_train=2.252107 (no previous merge yet)
[S3] round=37 local utility u=0.256091 metrics={'f1_val': 0.9611152572344858, 'auprc': 0.9995061241288165, 'loss_val': 0.1258450002392245, 'psi': 0.9764716039922181}-{'f1_val': 0.8833288250993662, 'auprc': 0.9986356774795069, 'loss_val': 0.1686969167002498, 'psi': 0.9294515660514224}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=37 head_norm_before_train=1.924275 cos_to_last_merge=0.9988 (last merge round=28)
[S4] round=37 local utility u=0.000000 metrics={'f1_val': 0.9413475282907544, 'auprc': 0.9513940876271132, 'loss_val': 0.29350767388108484, 'psi': 0.945366152025298}-{'f1_val': 0.9421248865567184, 'auprc': 0.9591048772662394, 'loss_val': 0.28944373947585433, 'psi': 0.9489168828405268}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=37 head_norm_before_train=1.926717 cos_to_last_merge=0.9860 (last merge round=23)
[S5] round=37 local utility u=0.000000 metrics={'f1_val': 0.9958213694443535, 'auprc': 0.9937142054351673, 'loss_val': 0.028123705440330254, 'psi': 0.9949785038406791}-{'f1_val': 0.996186023309311, 'auprc': 0.9935142338961443, 'loss_val': 0.028470171887876435, 'psi': 0.9951173075440444}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=37 head_norm_before_train=1.474087 cos_to_last_merge=0.9948 (last merge round=29)
[S6] round=37 local utility u=0.000000 metrics={'f1_val': 0.8228089110491755, 'auprc': 0.965974647936059, 'loss_val': 0.37275610892453226, 'psi': 0.880075205803929}-{'f1_val': 0.8253244168354817, 'auprc': 0.9699704801925457, 'loss_val': 0.3755352974969437, 'psi': 0.8831828421783073}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=37 head_norm_before_train=1.917350 cos_to_last_merge=0.9988 (last merge round=27)
[S7] round=37 local utility u=0.615118 metrics={'f1_val': 0.6193257846296403, 'auprc': 0.794296142729109, 'loss_val': 0.6739131191560775, 'psi': 0.6893139278694278}-{'f1_val': 0.49279845675806677, 'auprc': 0.7807612072881298, 'loss_val': 1.1043794520186485, 'psi': 0.607983556970092}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=37 head_norm_before_train=2.044771 (no previous merge yet)
[S8] round=37 local utility u=0.092194 metrics={'f1_val': 0.9934888194563342, 'auprc': 0.9873726627260015, 'loss_val': 0.03522871838695219, 'psi': 0.991042356764201}-{'f1_val': 0.9677418263091169, 'auprc': 0.9990252724147177, 'loss_val': 0.10009231867342715, 'psi': 0.9802552047513572}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=37 head_norm_before_train=2.161795 (no previous merge yet)
[S9] round=37 local utility u=0.003749 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9999664188382751, 'loss_val': 0.0157806970254922, 'psi': 0.9982483150425957}-{'f1_val': 0.9971029125121428, 'auprc': 0.9978574739795519, 'loss_val': 0.016952518648780918, 'psi': 0.9974047370991065}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] sending update (kind=head size=1804 to 1 peers)
[S10] START round=37 head_norm_before_train=1.887586 cos_to_last_merge=0.8144 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.814
[S10] round=37 local utility u=0.000191 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9961675937821513, 'loss_val': 0.031529675924262646, 'psi': 0.9958328296218724}-{'f1_val': 0.9956096535150197, 'auprc': 0.996168400568212, 'loss_val': 0.03191424824934735, 'psi': 0.9958331523362967}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=37 head_norm_before_train=2.091043 (no previous merge yet)
[S11] round=37 local utility u=0.000260 metrics={'f1_val': 0.9965268648289654, 'auprc': 0.9980840821751462, 'loss_val': 0.022112407936097776, 'psi': 0.9971497517674377}-{'f1_val': 0.9965268648289654, 'auprc': 0.9981120997677926, 'loss_val': 0.022715900015559558, 'psi': 0.9971609588044963}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=37 head_norm_before_train=1.812967 (no previous merge yet)
[S13] round=37 local utility u=0.057473 metrics={'f1_val': 0.6298910015205196, 'auprc': 0.7383021871238405, 'loss_val': 0.807957676871364, 'psi': 0.673255475761848}-{'f1_val': 0.6196913228903439, 'auprc': 0.700578180377897, 'loss_val': 0.7485330408054618, 'psi': 0.6520460658853651}
[S13] not sending this round → trigger blocked (psi=0.673)
[S14] START round=37 head_norm_before_train=1.770147 cos_to_last_merge=0.9654 (last merge round=19)
[S14] round=37 local utility u=0.001291 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.9968843866474457, 'loss_val': 0.03352310857636757, 'psi': 0.9967060936254285}-{'f1_val': 0.996754531653698, 'auprc': 0.9954227986548968, 'loss_val': 0.03272363223566908, 'psi': 0.9962218384541776}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S14] sending update (kind=head size=1807 to 1 peers)
[S15] START round=37 head_norm_before_train=1.677577 cos_to_last_merge=0.9760 (last merge round=19)
[S15] round=37 local utility u=0.000000 metrics={'f1_val': 0.7010704228661029, 'auprc': 0.9166537241872592, 'loss_val': 0.473013090498667, 'psi': 0.7873037433945654}-{'f1_val': 0.9589822842717, 'auprc': 0.9987936209739166, 'loss_val': 0.1542465258307013, 'psi': 0.9749068189525867}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=37 head_norm_before_train=1.878373 cos_to_last_merge=0.9945 (last merge round=28)
[S16] round=37 local utility u=0.000000 metrics={'f1_val': 0.846988708975141, 'auprc': 0.9596354751842059, 'loss_val': 0.8416320531147922, 'psi': 0.892047415458767}-{'f1_val': 0.938988101666799, 'auprc': 0.9871092475581866, 'loss_val': 0.24240486296602318, 'psi': 0.958236560023354}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=37 head_norm_before_train=1.444530 cos_to_last_merge=0.9914 (last merge round=27)
[S17] round=37 local utility u=0.084420 metrics={'f1_val': 0.66872053477406, 'auprc': 0.8895380196182662, 'loss_val': 0.6006844111957438, 'psi': 0.7570475287117424}-{'f1_val': 0.66174376001786, 'auprc': 0.8889248955621419, 'loss_val': 0.7258247158775324, 'psi': 0.7526162142355728}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=38 head_norm_before_train=1.674367 cos_to_last_merge=0.7581 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.758
[S2] round=38 local utility u=0.435024 metrics={'f1_val': 0.8023767044683275, 'auprc': 0.8411685705809795, 'loss_val': 0.43192255517036404, 'psi': 0.8178934509133884}-{'f1_val': 0.7526843048742162, 'auprc': 0.714151122887982, 'loss_val': 0.6227635188967171, 'psi': 0.7372710320797224}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=38 head_norm_before_train=2.263219 (no previous merge yet)
[S3] round=38 local utility u=0.000000 metrics={'f1_val': 0.9608655541319502, 'auprc': 0.999493385773593, 'loss_val': 0.1580355451173091, 'psi': 0.9763166867886073}-{'f1_val': 0.9611152572344858, 'auprc': 0.9995061241288165, 'loss_val': 0.1258450002392245, 'psi': 0.9764716039922181}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=38 head_norm_before_train=1.929019 cos_to_last_merge=0.9986 (last merge round=28)
[S4] round=38 local utility u=0.000000 metrics={'f1_val': 0.9378227962355055, 'auprc': 0.9291198979840033, 'loss_val': 0.3448154422613953, 'psi': 0.9343416369349047}-{'f1_val': 0.9413475282907544, 'auprc': 0.9513940876271132, 'loss_val': 0.29350767388108484, 'psi': 0.945366152025298}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=38 head_norm_before_train=1.940429 cos_to_last_merge=0.9845 (last merge round=23)
[S5] round=38 local utility u=0.000860 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9934260421971691, 'loss_val': 0.027727811616844834, 'psi': 0.9950820308644542}-{'f1_val': 0.9958213694443535, 'auprc': 0.9937142054351673, 'loss_val': 0.028123705440330254, 'psi': 0.9949785038406791}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=38 head_norm_before_train=1.485672 cos_to_last_merge=0.9939 (last merge round=29)
[S6] round=38 local utility u=0.000000 metrics={'f1_val': 0.6268318495854054, 'auprc': 0.9536757574602659, 'loss_val': 0.6368342700131848, 'psi': 0.7575694127353496}-{'f1_val': 0.8228089110491755, 'auprc': 0.965974647936059, 'loss_val': 0.37275610892453226, 'psi': 0.880075205803929}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=38 head_norm_before_train=1.922914 cos_to_last_merge=0.9988 (last merge round=27)
[S7] round=38 local utility u=0.058089 metrics={'f1_val': 0.6215018229760985, 'auprc': 0.7957960491777638, 'loss_val': 0.5752913313266729, 'psi': 0.6912195134567646}-{'f1_val': 0.6193257846296403, 'auprc': 0.794296142729109, 'loss_val': 0.6739131191560775, 'psi': 0.6893139278694278}
[S7] not sending this round → trigger blocked (psi=0.691)
[S8] START round=38 head_norm_before_train=2.051190 (no previous merge yet)
[S8] round=38 local utility u=0.001391 metrics={'f1_val': 0.9924011572900254, 'auprc': 0.9905663920229771, 'loss_val': 0.035501815034054675, 'psi': 0.9916672511832061}-{'f1_val': 0.9934888194563342, 'auprc': 0.9873726627260015, 'loss_val': 0.03522871838695219, 'psi': 0.991042356764201}
[S8] not sending this round → trigger blocked (psi=0.992)
[S9] START round=38 head_norm_before_train=2.168619 (no previous merge yet)
[S9] round=38 local utility u=0.000000 metrics={'f1_val': 0.9947734239942433, 'auprc': 0.9999660047507158, 'loss_val': 0.02084420868820596, 'psi': 0.9968504562968323}-{'f1_val': 0.9971029125121428, 'auprc': 0.9999664188382751, 'loss_val': 0.0157806970254922, 'psi': 0.9982483150425957}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=38 head_norm_before_train=1.899998 cos_to_last_merge=0.8137 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.814
[S10] round=38 local utility u=0.000000 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9959467793460485, 'loss_val': 0.031036374704089233, 'psi': 0.9957445038474313}-{'f1_val': 0.9956096535150197, 'auprc': 0.9961675937821513, 'loss_val': 0.031529675924262646, 'psi': 0.9958328296218724}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=38 head_norm_before_train=2.100208 (no previous merge yet)
[S11] round=38 local utility u=0.000378 metrics={'f1_val': 0.9965268648289654, 'auprc': 0.9982174900209525, 'loss_val': 0.02175721474374889, 'psi': 0.9972031149057602}-{'f1_val': 0.9965268648289654, 'auprc': 0.9980840821751462, 'loss_val': 0.022112407936097776, 'psi': 0.9971497517674377}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=38 head_norm_before_train=1.815920 (no previous merge yet)
[S13] round=38 local utility u=0.000000 metrics={'f1_val': 0.6197600411776087, 'auprc': 0.6444810079408678, 'loss_val': 0.8652139839900967, 'psi': 0.6296484278829124}-{'f1_val': 0.6298910015205196, 'auprc': 0.7383021871238405, 'loss_val': 0.807957676871364, 'psi': 0.673255475761848}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=38 head_norm_before_train=1.779000 cos_to_last_merge=0.9647 (last merge round=19)
[S14] round=38 local utility u=0.004952 metrics={'f1_val': 0.9968300801588782, 'auprc': 0.9984586706503896, 'loss_val': 0.02979991716413478, 'psi': 0.9974815163554827}-{'f1_val': 0.9965872316107504, 'auprc': 0.9968843866474457, 'loss_val': 0.03352310857636757, 'psi': 0.9967060936254285}
[S14] not sending this round → trigger blocked (psi=0.997)
[S15] START round=38 head_norm_before_train=1.684838 cos_to_last_merge=0.9753 (last merge round=19)
[S15] round=38 local utility u=0.963979 metrics={'f1_val': 0.9226757708156031, 'auprc': 0.9953501569888296, 'loss_val': 0.11077586969870426, 'psi': 0.9517455252848936}-{'f1_val': 0.7010704228661029, 'auprc': 0.9166537241872592, 'loss_val': 0.473013090498667, 'psi': 0.7873037433945654}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=38 head_norm_before_train=1.890145 cos_to_last_merge=0.9938 (last merge round=28)
[S16] round=38 local utility u=0.570963 metrics={'f1_val': 0.9341963101967553, 'auprc': 0.985081829361828, 'loss_val': 0.29929109068760057, 'psi': 0.9545505178627843}-{'f1_val': 0.846988708975141, 'auprc': 0.9596354751842059, 'loss_val': 0.8416320531147922, 'psi': 0.892047415458767}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S17] START round=38 head_norm_before_train=1.464390 cos_to_last_merge=0.9899 (last merge round=27)
[S17] round=38 local utility u=0.000000 metrics={'f1_val': 0.6658287298770786, 'auprc': 0.8840762404277175, 'loss_val': 0.8290142967078803, 'psi': 0.7531277340973341}-{'f1_val': 0.66872053477406, 'auprc': 0.8895380196182662, 'loss_val': 0.6006844111957438, 'psi': 0.7570475287117424}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=39 head_norm_before_train=1.687945 cos_to_last_merge=0.7564 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.756
[S2] round=39 local utility u=0.000000 metrics={'f1_val': 0.7177415283972155, 'auprc': 0.8480420132296127, 'loss_val': 0.502930372441027, 'psi': 0.7698617223301745}-{'f1_val': 0.8023767044683275, 'auprc': 0.8411685705809795, 'loss_val': 0.43192255517036404, 'psi': 0.8178934509133884}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=40 psi=0.770 u=0.0000 p_local=0.1096 f1=0.718 auprc=0.848 bytes=36012
[S3] START round=39 head_norm_before_train=2.274860 (no previous merge yet)
[S3] round=39 local utility u=0.178988 metrics={'f1_val': 0.9974271292865575, 'auprc': 0.9996731519637186, 'loss_val': 0.019968940470514326, 'psi': 0.998325538357422}-{'f1_val': 0.9608655541319502, 'auprc': 0.999493385773593, 'loss_val': 0.1580355451173091, 'psi': 0.9763166867886073}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S3] r=40 psi=0.998 u=0.1790 p_local=0.0889 f1=0.997 auprc=1.000 bytes=37804
[S4] START round=39 head_norm_before_train=1.936153 cos_to_last_merge=0.9983 (last merge round=28)
[S4] round=39 local utility u=0.095746 metrics={'f1_val': 0.9418702852557197, 'auprc': 0.9667462925272874, 'loss_val': 0.2904881694128928, 'psi': 0.9518206881643467}-{'f1_val': 0.9378227962355055, 'auprc': 0.9291198979840033, 'loss_val': 0.3448154422613953, 'psi': 0.9343416369349047}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S4] r=40 psi=0.952 u=0.0957 p_local=0.0298 f1=0.942 auprc=0.967 bytes=34139
[S5] START round=39 head_norm_before_train=1.951622 cos_to_last_merge=0.9833 (last merge round=23)
[S5] round=39 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9933820494255523, 'loss_val': 0.028259228165716875, 'psi': 0.9950644337558076}-{'f1_val': 0.996186023309311, 'auprc': 0.9934260421971691, 'loss_val': 0.027727811616844834, 'psi': 0.9950820308644542}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=40 psi=0.995 u=0.0000 p_local=0.0038 f1=0.996 auprc=0.993 bytes=39617
[S6] START round=39 head_norm_before_train=1.495373 cos_to_last_merge=0.9932 (last merge round=29)
[S6] round=39 local utility u=0.935054 metrics={'f1_val': 0.8695778190858622, 'auprc': 0.9715379330131988, 'loss_val': 0.2767887468562774, 'psi': 0.9103618646567968}-{'f1_val': 0.6268318495854054, 'auprc': 0.9536757574602659, 'loss_val': 0.6368342700131848, 'psi': 0.7575694127353496}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S6] r=40 psi=0.910 u=0.9351 p_local=0.2482 f1=0.870 auprc=0.972 bytes=39561
[S7] START round=39 head_norm_before_train=1.927306 cos_to_last_merge=0.9986 (last merge round=27)
[S7] round=39 local utility u=0.031808 metrics={'f1_val': 0.636085770723966, 'auprc': 0.798254567838882, 'loss_val': 0.6065550348708547, 'psi': 0.7009532895699324}-{'f1_val': 0.6215018229760985, 'auprc': 0.7957960491777638, 'loss_val': 0.5752913313266729, 'psi': 0.6912195134567646}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S7] r=40 psi=0.701 u=0.0318 p_local=0.1616 f1=0.636 auprc=0.798 bytes=39529
[S8] START round=39 head_norm_before_train=2.057789 (no previous merge yet)
[S8] round=39 local utility u=0.000000 metrics={'f1_val': 0.9929047892228047, 'auprc': 0.9860004628550747, 'loss_val': 0.04918299440559814, 'psi': 0.9901430586757127}-{'f1_val': 0.9924011572900254, 'auprc': 0.9905663920229771, 'loss_val': 0.035501815034054675, 'psi': 0.9916672511832061}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] r=40 psi=0.990 u=0.0000 p_local=0.0418 f1=0.993 auprc=0.986 bytes=36008
[S9] START round=39 head_norm_before_train=2.176611 (no previous merge yet)
[S9] round=39 local utility u=0.007205 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9999114331492449, 'loss_val': 0.017592686778876983, 'psi': 0.9979608803480329}-{'f1_val': 0.9947734239942433, 'auprc': 0.9999660047507158, 'loss_val': 0.02084420868820596, 'psi': 0.9968504562968323}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S9] r=40 psi=0.998 u=0.0072 p_local=0.0067 f1=0.997 auprc=1.000 bytes=39585
[S10] START round=39 head_norm_before_train=1.908452 cos_to_last_merge=0.8135 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.814
[S10] round=39 local utility u=0.000528 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9961551574547003, 'loss_val': 0.030605736355637923, 'psi': 0.995827855090892}-{'f1_val': 0.9956096535150197, 'auprc': 0.9959467793460485, 'loss_val': 0.031036374704089233, 'psi': 0.9957445038474313}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] sending update (kind=head size=1804 to 1 peers)
[S10] r=40 psi=0.996 u=0.0005 p_local=0.0022 f1=0.996 auprc=0.996 bytes=43242
[S11] START round=39 head_norm_before_train=2.109599 (no previous merge yet)
[S11] round=39 local utility u=0.000000 metrics={'f1_val': 0.9961135349310292, 'auprc': 0.9982889294119871, 'loss_val': 0.024059203990520365, 'psi': 0.9969836927234124}-{'f1_val': 0.9965268648289654, 'auprc': 0.9982174900209525, 'loss_val': 0.02175721474374889, 'psi': 0.9972031149057602}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] r=40 psi=0.997 u=0.0000 p_local=0.0187 f1=0.996 auprc=0.998 bytes=43155
[S13] START round=39 head_norm_before_train=1.819740 (no previous merge yet)
[S13] round=39 local utility u=0.361115 metrics={'f1_val': 0.648007180926206, 'auprc': 0.7367946698182113, 'loss_val': 0.5894073866081861, 'psi': 0.6835221764830082}-{'f1_val': 0.6197600411776087, 'auprc': 0.6444810079408678, 'loss_val': 0.8652139839900967, 'psi': 0.6296484278829124}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S13] r=40 psi=0.684 u=0.3611 p_local=0.1174 f1=0.648 auprc=0.737 bytes=34139
[S14] START round=39 head_norm_before_train=1.789115 cos_to_last_merge=0.9638 (last merge round=19)
[S14] round=39 local utility u=0.002541 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9985544679677301, 'loss_val': 0.027467538835673596, 'psi': 0.9977660012105678}-{'f1_val': 0.9968300801588782, 'auprc': 0.9984586706503896, 'loss_val': 0.02979991716413478, 'psi': 0.9974815163554827}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S14] sending update (kind=head size=1806 to 1 peers)
[S14] r=40 psi=0.998 u=0.0025 p_local=0.0044 f1=0.997 auprc=0.999 bytes=46772
[S15] START round=39 head_norm_before_train=1.692629 cos_to_last_merge=0.9747 (last merge round=19)
[S15] round=39 local utility u=0.000000 metrics={'f1_val': 0.7730167875909257, 'auprc': 0.9901959362966444, 'loss_val': 0.3250887036120515, 'psi': 0.8598884470732132}-{'f1_val': 0.9226757708156031, 'auprc': 0.9953501569888296, 'loss_val': 0.11077586969870426, 'psi': 0.9517455252848936}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] r=40 psi=0.860 u=0.0000 p_local=0.3378 f1=0.773 auprc=0.990 bytes=32383
[S16] START round=39 head_norm_before_train=1.902736 cos_to_last_merge=0.9931 (last merge round=28)
[S16] round=39 local utility u=0.245201 metrics={'f1_val': 0.9794053287075958, 'auprc': 0.9869677849296534, 'loss_val': 0.08580072628129332, 'psi': 0.9824303111964189}-{'f1_val': 0.9341963101967553, 'auprc': 0.985081829361828, 'loss_val': 0.29929109068760057, 'psi': 0.9545505178627843}
[S16] not sending this round → trigger blocked (psi=0.982)
[S16] r=40 psi=0.982 u=0.2452 p_local=0.2437 f1=0.979 auprc=0.987 bytes=28776
[S17] START round=39 head_norm_before_train=1.486444 cos_to_last_merge=0.9883 (last merge round=27)
[S17] round=39 local utility u=0.052000 metrics={'f1_val': 0.6698653883280234, 'auprc': 0.8739404464502385, 'loss_val': 0.7188277220055532, 'psi': 0.7514954115769095}-{'f1_val': 0.6658287298770786, 'auprc': 0.8840762404277175, 'loss_val': 0.8290142967078803, 'psi': 0.7531277340973341}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S17] r=40 psi=0.751 u=0.0520 p_local=0.0933 f1=0.670 auprc=0.874 bytes=35934
[S2] START round=40 head_norm_before_train=1.702652 cos_to_last_merge=0.7547 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.755
[S2] round=40 local utility u=0.258708 metrics={'f1_val': 0.8001037348918795, 'auprc': 0.83303253227521, 'loss_val': 0.43465993349315846, 'psi': 0.8132752538452117}-{'f1_val': 0.7177415283972155, 'auprc': 0.8480420132296127, 'loss_val': 0.502930372441027, 'psi': 0.7698617223301745}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] sending update (kind=head size=1804 to 1 peers)
[S3] START round=40 head_norm_before_train=2.286831 (no previous merge yet)
[S3] round=40 local utility u=0.000000 metrics={'f1_val': 0.9602580484078469, 'auprc': 0.9988040522249082, 'loss_val': 0.17931915902898876, 'psi': 0.9756764499346715}-{'f1_val': 0.9974271292865575, 'auprc': 0.9996731519637186, 'loss_val': 0.019968940470514326, 'psi': 0.998325538357422}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=40 head_norm_before_train=1.939543 cos_to_last_merge=0.9980 (last merge round=28)
[S4] round=40 local utility u=0.000000 metrics={'f1_val': 0.9436059022324063, 'auprc': 0.9556375198007729, 'loss_val': 0.2884508013740963, 'psi': 0.9484185492597529}-{'f1_val': 0.9418702852557197, 'auprc': 0.9667462925272874, 'loss_val': 0.2904881694128928, 'psi': 0.9518206881643467}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=40 head_norm_before_train=1.952299 cos_to_last_merge=0.9829 (last merge round=23)
[S5] round=40 local utility u=0.004235 metrics={'f1_val': 0.9958213694443535, 'auprc': 0.9967627817530722, 'loss_val': 0.027744169567511256, 'psi': 0.996197934367841}-{'f1_val': 0.996186023309311, 'auprc': 0.9933820494255523, 'loss_val': 0.028259228165716875, 'psi': 0.9950644337558076}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=40 head_norm_before_train=1.504482 cos_to_last_merge=0.9925 (last merge round=29)
[S6] round=40 local utility u=0.000000 metrics={'f1_val': 0.7226908839945259, 'auprc': 0.9468749501504221, 'loss_val': 0.60017993027019, 'psi': 0.8123645104568844}-{'f1_val': 0.8695778190858622, 'auprc': 0.9715379330131988, 'loss_val': 0.2767887468562774, 'psi': 0.9103618646567968}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=40 head_norm_before_train=1.932831 cos_to_last_merge=0.9986 (last merge round=27)
[S7] round=40 local utility u=0.000000 metrics={'f1_val': 0.6249331798742791, 'auprc': 0.7990216496510956, 'loss_val': 0.6128737856752774, 'psi': 0.6945685677850058}-{'f1_val': 0.636085770723966, 'auprc': 0.798254567838882, 'loss_val': 0.6065550348708547, 'psi': 0.7009532895699324}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=40 head_norm_before_train=2.065269 (no previous merge yet)
[S8] round=40 local utility u=0.020828 metrics={'f1_val': 0.9914588715117574, 'auprc': 0.9988188509763518, 'loss_val': 0.03730693615196252, 'psi': 0.9944028632975951}-{'f1_val': 0.9929047892228047, 'auprc': 0.9860004628550747, 'loss_val': 0.04918299440559814, 'psi': 0.9901430586757127}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=40 head_norm_before_train=2.183466 (no previous merge yet)
[S9] round=40 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9980233416467946, 'loss_val': 0.017431457554385847, 'psi': 0.9972056437470527}-{'f1_val': 0.9966605118138915, 'auprc': 0.9999114331492449, 'loss_val': 0.017592686778876983, 'psi': 0.9979608803480329}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=40 head_norm_before_train=1.916114 cos_to_last_merge=0.8134 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.813
[S10] round=40 local utility u=0.000000 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9941059458914967, 'loss_val': 0.030391301239200755, 'psi': 0.9950081704656106}-{'f1_val': 0.9956096535150197, 'auprc': 0.9961551574547003, 'loss_val': 0.030605736355637923, 'psi': 0.995827855090892}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=40 head_norm_before_train=2.113019 (no previous merge yet)
[S11] round=40 local utility u=0.000000 metrics={'f1_val': 0.9932329702487555, 'auprc': 0.9982692582241436, 'loss_val': 0.03399848633392868, 'psi': 0.9952474854389107}-{'f1_val': 0.9961135349310292, 'auprc': 0.9982889294119871, 'loss_val': 0.024059203990520365, 'psi': 0.9969836927234124}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=40 head_norm_before_train=1.821513 (no previous merge yet)
[S13] round=40 local utility u=0.000000 metrics={'f1_val': 0.6061903570502791, 'auprc': 0.7706993391939088, 'loss_val': 0.9470527155280671, 'psi': 0.671993949907731}-{'f1_val': 0.648007180926206, 'auprc': 0.7367946698182113, 'loss_val': 0.5894073866081861, 'psi': 0.6835221764830082}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=40 head_norm_before_train=1.800112 cos_to_last_merge=0.9629 (last merge round=19)
[S14] round=40 local utility u=0.000000 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9968556085825302, 'loss_val': 0.027862544945349375, 'psi': 0.9969407483276111}-{'f1_val': 0.997240356705793, 'auprc': 0.9985544679677301, 'loss_val': 0.027467538835673596, 'psi': 0.9977660012105678}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=40 head_norm_before_train=1.706004 cos_to_last_merge=0.9735 (last merge round=19)
[S15] round=40 local utility u=0.000000 metrics={'f1_val': 0.7010704228661029, 'auprc': 0.8687596963175439, 'loss_val': 0.5077529753933885, 'psi': 0.7681461322466794}-{'f1_val': 0.7730167875909257, 'auprc': 0.9901959362966444, 'loss_val': 0.3250887036120515, 'psi': 0.8598884470732132}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=40 head_norm_before_train=1.915449 cos_to_last_merge=0.9924 (last merge round=28)
[S16] round=40 local utility u=0.057427 metrics={'f1_val': 0.9906363064805982, 'auprc': 0.9914110481402846, 'loss_val': 0.05166191772980306, 'psi': 0.9909462031444728}-{'f1_val': 0.9794053287075958, 'auprc': 0.9869677849296534, 'loss_val': 0.08580072628129332, 'psi': 0.9824303111964189}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S17] START round=40 head_norm_before_train=1.504585 cos_to_last_merge=0.9870 (last merge round=27)
[S17] round=40 local utility u=0.367985 metrics={'f1_val': 0.7534354418665579, 'auprc': 0.9056747385143619, 'loss_val': 0.5794813314381559, 'psi': 0.8143311605256796}-{'f1_val': 0.6698653883280234, 'auprc': 0.8739404464502385, 'loss_val': 0.7188277220055532, 'psi': 0.7514954115769095}
[S17] not sending this round → trigger blocked (psi=0.814)
[S2] START round=41 head_norm_before_train=1.715120 cos_to_last_merge=0.7529 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.753
[S2] round=41 local utility u=0.000000 metrics={'f1_val': 0.7468305215196379, 'auprc': 0.8426812795243974, 'loss_val': 0.4532249352985497, 'psi': 0.7851708247215418}-{'f1_val': 0.8001037348918795, 'auprc': 0.83303253227521, 'loss_val': 0.43465993349315846, 'psi': 0.8132752538452117}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=41 head_norm_before_train=2.294913 (no previous merge yet)
[S3] round=41 local utility u=0.115486 metrics={'f1_val': 0.9810126070450085, 'auprc': 0.9995147577067279, 'loss_val': 0.07500674867622592, 'psi': 0.9884134673096963}-{'f1_val': 0.9602580484078469, 'auprc': 0.9988040522249082, 'loss_val': 0.17931915902898876, 'psi': 0.9756764499346715}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=41 head_norm_before_train=1.945422 cos_to_last_merge=0.9977 (last merge round=28)
[S4] round=41 local utility u=0.008905 metrics={'f1_val': 0.9503165595175866, 'auprc': 0.9472231268019196, 'loss_val': 0.2856624708944895, 'psi': 0.9490791864313198}-{'f1_val': 0.9436059022324063, 'auprc': 0.9556375198007729, 'loss_val': 0.2884508013740963, 'psi': 0.9484185492597529}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=41 head_norm_before_train=1.961777 cos_to_last_merge=0.9824 (last merge round=23)
[S5] round=41 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9907531901991742, 'loss_val': 0.028228162707979225, 'psi': 0.9940128900652563}-{'f1_val': 0.9958213694443535, 'auprc': 0.9967627817530722, 'loss_val': 0.027744169567511256, 'psi': 0.996197934367841}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=41 head_norm_before_train=1.516496 cos_to_last_merge=0.9916 (last merge round=29)
[S6] round=41 local utility u=0.401591 metrics={'f1_val': 0.8241329625091943, 'auprc': 0.9633978694363317, 'loss_val': 0.4552183539238387, 'psi': 0.8798389252800493}-{'f1_val': 0.7226908839945259, 'auprc': 0.9468749501504221, 'loss_val': 0.60017993027019, 'psi': 0.8123645104568844}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] sending update (kind=head size=1805 to 1 peers)
[S7] START round=41 head_norm_before_train=1.940054 cos_to_last_merge=0.9985 (last merge round=27)
[S7] round=41 local utility u=0.384927 metrics={'f1_val': 0.6752904598344166, 'auprc': 0.850200262660106, 'loss_val': 0.2986987410241773, 'psi': 0.7452543809646923}-{'f1_val': 0.6249331798742791, 'auprc': 0.7990216496510956, 'loss_val': 0.6128737856752774, 'psi': 0.6945685677850058}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] sending update (kind=head size=1796 to 1 peers)
[S8] START round=41 head_norm_before_train=2.072751 (no previous merge yet)
[S8] round=41 local utility u=0.000000 metrics={'f1_val': 0.9843456332837681, 'auprc': 0.9991195836491273, 'loss_val': 0.05397297826909344, 'psi': 0.9902552134299117}-{'f1_val': 0.9914588715117574, 'auprc': 0.9988188509763518, 'loss_val': 0.03730693615196252, 'psi': 0.9944028632975951}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=41 head_norm_before_train=2.189468 (no previous merge yet)
[S9] round=41 local utility u=0.005118 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9999652331091797, 'loss_val': 0.01567608527159884, 'psi': 0.9982478407509576}-{'f1_val': 0.9966605118138915, 'auprc': 0.9980233416467946, 'loss_val': 0.017431457554385847, 'psi': 0.9972056437470527}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=41 head_norm_before_train=1.925590 cos_to_last_merge=0.8130 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.813
[S10] round=41 local utility u=0.003559 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9962839491882032, 'loss_val': 0.02980733583888058, 'psi': 0.9958793717842931}-{'f1_val': 0.9956096535150197, 'auprc': 0.9941059458914967, 'loss_val': 0.030391301239200755, 'psi': 0.9950081704656106}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=41 head_norm_before_train=2.118042 (no previous merge yet)
[S11] round=41 local utility u=0.012593 metrics={'f1_val': 0.9958716985726862, 'auprc': 0.9982932140329782, 'loss_val': 0.024717455613698713, 'psi': 0.9968403047568031}-{'f1_val': 0.9932329702487555, 'auprc': 0.9982692582241436, 'loss_val': 0.03399848633392868, 'psi': 0.9952474854389107}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] sending update (kind=head size=1793 to 1 peers)
[S13] START round=41 head_norm_before_train=1.825562 (no previous merge yet)
[S13] round=41 local utility u=0.251408 metrics={'f1_val': 0.6434225878201731, 'auprc': 0.7446725960758358, 'loss_val': 0.5895489262370458, 'psi': 0.6839225911224383}-{'f1_val': 0.6061903570502791, 'auprc': 0.7706993391939088, 'loss_val': 0.9470527155280671, 'psi': 0.671993949907731}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=41 head_norm_before_train=1.811290 cos_to_last_merge=0.9619 (last merge round=19)
[S14] round=41 local utility u=0.000000 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.9968665887897739, 'loss_val': 0.02775469310284347, 'psi': 0.9966989744823598}-{'f1_val': 0.9969975081576651, 'auprc': 0.9968556085825302, 'loss_val': 0.027862544945349375, 'psi': 0.9969407483276111}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=41 head_norm_before_train=1.722026 cos_to_last_merge=0.9720 (last merge round=19)
[S15] round=41 local utility u=0.991061 metrics={'f1_val': 0.919936282270027, 'auprc': 0.9985557300760872, 'loss_val': 0.22821393129165352, 'psi': 0.951384061392451}-{'f1_val': 0.7010704228661029, 'auprc': 0.8687596963175439, 'loss_val': 0.5077529753933885, 'psi': 0.7681461322466794}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] sending update (kind=head size=1792 to 1 peers)
[S16] START round=41 head_norm_before_train=1.927015 cos_to_last_merge=0.9918 (last merge round=28)
[S16] round=41 local utility u=0.000984 metrics={'f1_val': 0.9908553097366877, 'auprc': 0.9907411197099696, 'loss_val': 0.04899764616932334, 'psi': 0.9908096337260005}-{'f1_val': 0.9906363064805982, 'auprc': 0.9914110481402846, 'loss_val': 0.05166191772980306, 'psi': 0.9909462031444728}
[S16] not sending this round → trigger blocked (psi=0.991)
[S17] START round=41 head_norm_before_train=1.520979 cos_to_last_merge=0.9859 (last merge round=27)
[S17] round=41 local utility u=0.000000 metrics={'f1_val': 0.6859566455143288, 'auprc': 0.795049457408963, 'loss_val': 0.8553646659969526, 'psi': 0.7295937702721824}-{'f1_val': 0.7534354418665579, 'auprc': 0.9056747385143619, 'loss_val': 0.5794813314381559, 'psi': 0.8143311605256796}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=42 head_norm_before_train=1.730017 cos_to_last_merge=0.7512 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.751
[S2] round=42 local utility u=0.000000 metrics={'f1_val': 0.7058062814809254, 'auprc': 0.8608156123233008, 'loss_val': 0.5064098050886315, 'psi': 0.7678100138178756}-{'f1_val': 0.7468305215196379, 'auprc': 0.8426812795243974, 'loss_val': 0.4532249352985497, 'psi': 0.7851708247215418}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=42 head_norm_before_train=2.304390 (no previous merge yet)
[S3] round=42 local utility u=0.000000 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.9995605038380281, 'loss_val': 0.10453047063428197, 'psi': 0.9764692527748835}-{'f1_val': 0.9810126070450085, 'auprc': 0.9995147577067279, 'loss_val': 0.07500674867622592, 'psi': 0.9884134673096963}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=42 head_norm_before_train=1.953411 cos_to_last_merge=0.9973 (last merge round=28)
[S4] round=42 local utility u=0.011350 metrics={'f1_val': 0.944896185696297, 'auprc': 0.9638859368096429, 'loss_val': 0.2804281276699316, 'psi': 0.9524920861416353}-{'f1_val': 0.9503165595175866, 'auprc': 0.9472231268019196, 'loss_val': 0.2856624708944895, 'psi': 0.9490791864313198}
[S4] not sending this round → trigger blocked (psi=0.952)
[S5] START round=42 head_norm_before_train=1.963931 cos_to_last_merge=0.9817 (last merge round=23)
[S5] round=42 local utility u=0.000000 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9906838979596889, 'loss_val': 0.028973323763970292, 'psi': 0.993897688722708}-{'f1_val': 0.996186023309311, 'auprc': 0.9907531901991742, 'loss_val': 0.028228162707979225, 'psi': 0.9940128900652563}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=42 head_norm_before_train=1.526004 cos_to_last_merge=0.9908 (last merge round=29)
[S6] round=42 local utility u=0.000000 metrics={'f1_val': 0.6514410981192723, 'auprc': 0.9613285339798857, 'loss_val': 0.6492047583340487, 'psi': 0.7753960724635176}-{'f1_val': 0.8241329625091943, 'auprc': 0.9633978694363317, 'loss_val': 0.4552183539238387, 'psi': 0.8798389252800493}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=42 head_norm_before_train=1.945588 cos_to_last_merge=0.9984 (last merge round=27)
[S7] round=42 local utility u=0.000000 metrics={'f1_val': 0.5736780762740236, 'auprc': 0.7932157861889095, 'loss_val': 0.8232328706417832, 'psi': 0.661493160239978}-{'f1_val': 0.6752904598344166, 'auprc': 0.850200262660106, 'loss_val': 0.2986987410241773, 'psi': 0.7452543809646923}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=42 head_norm_before_train=2.079004 (no previous merge yet)
[S8] round=42 local utility u=0.021737 metrics={'f1_val': 0.992765585815685, 'auprc': 0.9899563646239007, 'loss_val': 0.03352986317783996, 'psi': 0.9916418973389712}-{'f1_val': 0.9843456332837681, 'auprc': 0.9991195836491273, 'loss_val': 0.05397297826909344, 'psi': 0.9902552134299117}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=42 head_norm_before_train=2.194510 (no previous merge yet)
[S9] round=42 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9980635413182074, 'loss_val': 0.017007760555498422, 'psi': 0.9972217236156178}-{'f1_val': 0.9971029125121428, 'auprc': 0.9999652331091797, 'loss_val': 0.01567608527159884, 'psi': 0.9982478407509576}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=42 head_norm_before_train=1.935935 cos_to_last_merge=0.8124 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.812
[S10] round=42 local utility u=0.000000 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.994631203206064, 'loss_val': 0.029412384985869074, 'psi': 0.9952182733914374}-{'f1_val': 0.9956096535150197, 'auprc': 0.9962839491882032, 'loss_val': 0.02980733583888058, 'psi': 0.9958793717842931}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=42 head_norm_before_train=2.125345 (no previous merge yet)
[S11] round=42 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9979349069855608, 'loss_val': 0.09909812001268668, 'psi': 0.9968541677422099}-{'f1_val': 0.9958716985726862, 'auprc': 0.9982932140329782, 'loss_val': 0.024717455613698713, 'psi': 0.9968403047568031}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=42 head_norm_before_train=1.830407 (no previous merge yet)
[S13] round=42 local utility u=0.010723 metrics={'f1_val': 0.6555951189794536, 'auprc': 0.7650585056432232, 'loss_val': 0.7022959876887781, 'psi': 0.6993804736449614}-{'f1_val': 0.6434225878201731, 'auprc': 0.7446725960758358, 'loss_val': 0.5895489262370458, 'psi': 0.6839225911224383}
[S13] not sending this round → trigger blocked (psi=0.699)
[S14] START round=42 head_norm_before_train=1.822146 cos_to_last_merge=0.9610 (last merge round=19)
[S14] round=42 local utility u=0.004027 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9984309297290268, 'loss_val': 0.026854617703711864, 'psi': 0.9975708767862097}-{'f1_val': 0.9965872316107504, 'auprc': 0.9968665887897739, 'loss_val': 0.02775469310284347, 'psi': 0.9966989744823598}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=42 head_norm_before_train=1.734939 cos_to_last_merge=0.9709 (last merge round=19)
[S15] round=42 local utility u=0.000000 metrics={'f1_val': 0.7070232314886075, 'auprc': 0.9885640838442897, 'loss_val': 0.42662381094919033, 'psi': 0.8196395724308804}-{'f1_val': 0.919936282270027, 'auprc': 0.9985557300760872, 'loss_val': 0.22821393129165352, 'psi': 0.951384061392451}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=42 head_norm_before_train=1.937839 cos_to_last_merge=0.9911 (last merge round=28)
[S16] round=42 local utility u=0.000000 metrics={'f1_val': 0.93816647590648, 'auprc': 0.9845525303491093, 'loss_val': 0.2506466009778985, 'psi': 0.9567208976835316}-{'f1_val': 0.9908553097366877, 'auprc': 0.9907411197099696, 'loss_val': 0.04899764616932334, 'psi': 0.9908096337260005}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=42 head_norm_before_train=1.533196 cos_to_last_merge=0.9850 (last merge round=27)
[S17] round=42 local utility u=0.000000 metrics={'f1_val': 0.6559896299018766, 'auprc': 0.840161056562585, 'loss_val': 0.8857215624818978, 'psi': 0.7296582005661599}-{'f1_val': 0.6859566455143288, 'auprc': 0.795049457408963, 'loss_val': 0.8553646659969526, 'psi': 0.7295937702721824}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=43 head_norm_before_train=1.745996 cos_to_last_merge=0.7495 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.750
[S2] round=43 local utility u=0.000000 metrics={'f1_val': 0.7074377699363655, 'auprc': 0.8535788269709313, 'loss_val': 0.520723549888404, 'psi': 0.7658941927501919}-{'f1_val': 0.7058062814809254, 'auprc': 0.8608156123233008, 'loss_val': 0.5064098050886315, 'psi': 0.7678100138178756}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=43 head_norm_before_train=2.315914 (no previous merge yet)
[S3] round=43 local utility u=0.154170 metrics={'f1_val': 0.9978100342676263, 'auprc': 0.9997057738299165, 'loss_val': 0.01703636895752697, 'psi': 0.9985683300925423}-{'f1_val': 0.9610750853994537, 'auprc': 0.9995605038380281, 'loss_val': 0.10453047063428197, 'psi': 0.9764692527748835}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=43 head_norm_before_train=1.959109 cos_to_last_merge=0.9971 (last merge round=28)
[S4] round=43 local utility u=0.000000 metrics={'f1_val': 0.9389379351892005, 'auprc': 0.9329879375064052, 'loss_val': 0.31447537508297374, 'psi': 0.9365579361160825}-{'f1_val': 0.944896185696297, 'auprc': 0.9638859368096429, 'loss_val': 0.2804281276699316, 'psi': 0.9524920861416353}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=43 head_norm_before_train=1.967885 cos_to_last_merge=0.9807 (last merge round=23)
[S5] round=43 local utility u=0.005190 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9934615547688859, 'loss_val': 0.027800922164481726, 'psi': 0.995096235893141}-{'f1_val': 0.9960402158980539, 'auprc': 0.9906838979596889, 'loss_val': 0.028973323763970292, 'psi': 0.993897688722708}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=43 head_norm_before_train=1.539423 cos_to_last_merge=0.9898 (last merge round=29)
[S6] round=43 local utility u=0.836121 metrics={'f1_val': 0.8689254386303686, 'auprc': 0.9722440485964697, 'loss_val': 0.31461484864347355, 'psi': 0.910252882616809}-{'f1_val': 0.6514410981192723, 'auprc': 0.9613285339798857, 'loss_val': 0.6492047583340487, 'psi': 0.7753960724635176}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[S7] START round=43 head_norm_before_train=1.951523 cos_to_last_merge=0.9982 (last merge round=27)
[S7] round=43 local utility u=0.207197 metrics={'f1_val': 0.6095337002624348, 'auprc': 0.7956928327463315, 'loss_val': 0.631404316416583, 'psi': 0.6839973532559935}-{'f1_val': 0.5736780762740236, 'auprc': 0.7932157861889095, 'loss_val': 0.8232328706417832, 'psi': 0.661493160239978}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=43 head_norm_before_train=2.084615 (no previous merge yet)
[S8] round=43 local utility u=0.001571 metrics={'f1_val': 0.9938621753089841, 'auprc': 0.9884951016343242, 'loss_val': 0.032583258039273845, 'psi': 0.9917153458391201}-{'f1_val': 0.992765585815685, 'auprc': 0.9899563646239007, 'loss_val': 0.03352986317783996, 'psi': 0.9916418973389712}
[S8] not sending this round → trigger blocked (psi=0.992)
[S9] START round=43 head_norm_before_train=2.198200 (no previous merge yet)
[S9] round=43 local utility u=0.000000 metrics={'f1_val': 0.9901183584159563, 'auprc': 0.9960245604583001, 'loss_val': 0.03503805075697554, 'psi': 0.9924808392328938}-{'f1_val': 0.9966605118138915, 'auprc': 0.9980635413182074, 'loss_val': 0.017007760555498422, 'psi': 0.9972217236156178}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=43 head_norm_before_train=1.946739 cos_to_last_merge=0.8118 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.812
[S10] round=43 local utility u=0.000950 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9953702485090901, 'loss_val': 0.029728945637406107, 'psi': 0.9955138915126479}-{'f1_val': 0.9956096535150197, 'auprc': 0.994631203206064, 'loss_val': 0.029412384985869074, 'psi': 0.9952182733914374}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S10] sending update (kind=head size=1806 to 1 peers)
[S11] START round=43 head_norm_before_train=2.131900 (no previous merge yet)
[S11] round=43 local utility u=0.034379 metrics={'f1_val': 0.9949303917896273, 'auprc': 0.9985297149682755, 'loss_val': 0.024904746525383777, 'psi': 0.9963701210610865}-{'f1_val': 0.9961336749133093, 'auprc': 0.9979349069855608, 'loss_val': 0.09909812001268668, 'psi': 0.9968541677422099}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=43 head_norm_before_train=1.836814 (no previous merge yet)
[S13] round=43 local utility u=0.000000 metrics={'f1_val': 0.6474276004540573, 'auprc': 0.7196071746225868, 'loss_val': 0.7753830077965058, 'psi': 0.6762994301214691}-{'f1_val': 0.6555951189794536, 'auprc': 0.7650585056432232, 'loss_val': 0.7022959876887781, 'psi': 0.6993804736449614}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=43 head_norm_before_train=1.830022 cos_to_last_merge=0.9604 (last merge round=19)
[S14] round=43 local utility u=0.000131 metrics={'f1_val': 0.9966100132760906, 'auprc': 0.9986247774516879, 'loss_val': 0.024849072717358978, 'psi': 0.9974159189463295}-{'f1_val': 0.9969975081576651, 'auprc': 0.9984309297290268, 'loss_val': 0.026854617703711864, 'psi': 0.9975708767862097}
[S14] not sending this round → trigger blocked (psi=0.997)
[S15] START round=43 head_norm_before_train=1.744531 cos_to_last_merge=0.9700 (last merge round=19)
[S15] round=43 local utility u=0.006877 metrics={'f1_val': 0.7105371643824028, 'auprc': 0.9887566708916271, 'loss_val': 0.43453062322397673, 'psi': 0.8218249669860925}-{'f1_val': 0.7070232314886075, 'auprc': 0.9885640838442897, 'loss_val': 0.42662381094919033, 'psi': 0.8196395724308804}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=43 head_norm_before_train=1.947920 cos_to_last_merge=0.9905 (last merge round=28)
[S16] round=43 local utility u=0.271320 metrics={'f1_val': 0.9922260082678341, 'auprc': 0.9881961674841194, 'loss_val': 0.04329545272820111, 'psi': 0.9906140719543483}-{'f1_val': 0.93816647590648, 'auprc': 0.9845525303491093, 'loss_val': 0.2506466009778985, 'psi': 0.9567208976835316}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] sending update (kind=head size=1805 to 1 peers)
[S17] START round=43 head_norm_before_train=1.540979 cos_to_last_merge=0.9844 (last merge round=27)
[S17] round=43 local utility u=0.000000 metrics={'f1_val': 0.6693340532151455, 'auprc': 0.7886240215522125, 'loss_val': 0.8857732673368373, 'psi': 0.7170500405499722}-{'f1_val': 0.6559896299018766, 'auprc': 0.840161056562585, 'loss_val': 0.8857215624818978, 'psi': 0.7296582005661599}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=44 head_norm_before_train=1.759670 cos_to_last_merge=0.7481 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.748
[S2] round=44 local utility u=0.010360 metrics={'f1_val': 0.7077807660522002, 'auprc': 0.8512502853193877, 'loss_val': 0.4950752757206407, 'psi': 0.7651685737590752}-{'f1_val': 0.7074377699363655, 'auprc': 0.8535788269709313, 'loss_val': 0.520723549888404, 'psi': 0.7658941927501919}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S2] sending update (kind=head size=1806 to 1 peers)
[S3] START round=44 head_norm_before_train=2.326401 (no previous merge yet)
[S3] round=44 local utility u=0.000000 metrics={'f1_val': 0.9605438728991138, 'auprc': 0.9990898763638425, 'loss_val': 0.16508899040663602, 'psi': 0.9759622742850053}-{'f1_val': 0.9978100342676263, 'auprc': 0.9997057738299165, 'loss_val': 0.01703636895752697, 'psi': 0.9985683300925423}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=44 head_norm_before_train=1.963837 cos_to_last_merge=0.9968 (last merge round=28)
[S4] round=44 local utility u=0.070607 metrics={'f1_val': 0.9424879429949323, 'auprc': 0.9660638450333611, 'loss_val': 0.29378977629673403, 'psi': 0.9519183038103038}-{'f1_val': 0.9389379351892005, 'auprc': 0.9329879375064052, 'loss_val': 0.31447537508297374, 'psi': 0.9365579361160825}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S4] sending update (kind=head size=1791 to 1 peers)
[S5] START round=44 head_norm_before_train=1.972562 cos_to_last_merge=0.9804 (last merge round=23)
[S5] round=44 local utility u=0.000000 metrics={'f1_val': 0.9958213694443535, 'auprc': 0.9928555400837031, 'loss_val': 0.02847673851465797, 'psi': 0.9946350377000934}-{'f1_val': 0.996186023309311, 'auprc': 0.9934615547688859, 'loss_val': 0.027800922164481726, 'psi': 0.995096235893141}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=44 head_norm_before_train=1.558430 cos_to_last_merge=0.9887 (last merge round=29)
[S6] round=44 local utility u=0.000000 metrics={'f1_val': 0.6869828970211069, 'auprc': 0.9575953923638105, 'loss_val': 0.6845541124786566, 'psi': 0.7952278951581884}-{'f1_val': 0.8689254386303686, 'auprc': 0.9722440485964697, 'loss_val': 0.31461484864347355, 'psi': 0.910252882616809}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=44 head_norm_before_train=1.955846 cos_to_last_merge=0.9980 (last merge round=27)
[S7] round=44 local utility u=0.242669 metrics={'f1_val': 0.6543398601544983, 'auprc': 0.8080464885706429, 'loss_val': 0.45196464590873403, 'psi': 0.7158225115209561}-{'f1_val': 0.6095337002624348, 'auprc': 0.7956928327463315, 'loss_val': 0.631404316416583, 'psi': 0.6839973532559935}
[S7] not sending this round → trigger blocked (psi=0.716)
[S8] START round=44 head_norm_before_train=2.092025 (no previous merge yet)
[S8] round=44 local utility u=0.001741 metrics={'f1_val': 0.9938621753089841, 'auprc': 0.989466216805194, 'loss_val': 0.03201556923419332, 'psi': 0.9921037919074681}-{'f1_val': 0.9938621753089841, 'auprc': 0.9884951016343242, 'loss_val': 0.032583258039273845, 'psi': 0.9917153458391201}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] sending update (kind=head size=1803 to 1 peers)
[S9] START round=44 head_norm_before_train=2.204163 (no previous merge yet)
[S9] round=44 local utility u=0.031577 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9980993339895803, 'loss_val': 0.01736091750194172, 'psi': 0.9972360406841669}-{'f1_val': 0.9901183584159563, 'auprc': 0.9960245604583001, 'loss_val': 0.03503805075697554, 'psi': 0.9924808392328938}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] sending update (kind=head size=1804 to 1 peers)
[S10] START round=44 head_norm_before_train=1.953644 cos_to_last_merge=0.8117 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.812
[S10] round=44 local utility u=0.001816 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9962448609354271, 'loss_val': 0.028720323958605087, 'psi': 0.9958637364831827}-{'f1_val': 0.9956096535150197, 'auprc': 0.9953702485090901, 'loss_val': 0.029728945637406107, 'psi': 0.9955138915126479}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=44 head_norm_before_train=2.139233 (no previous merge yet)
[S11] round=44 local utility u=0.004133 metrics={'f1_val': 0.9958716985726862, 'auprc': 0.9982692838053903, 'loss_val': 0.021506153030962673, 'psi': 0.9968307326657678}-{'f1_val': 0.9949303917896273, 'auprc': 0.9985297149682755, 'loss_val': 0.024904746525383777, 'psi': 0.9963701210610865}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=44 head_norm_before_train=1.845753 (no previous merge yet)
[S13] round=44 local utility u=0.165503 metrics={'f1_val': 0.6644784987650845, 'auprc': 0.7758705325131335, 'loss_val': 0.7154731746715429, 'psi': 0.709035312264304}-{'f1_val': 0.6474276004540573, 'auprc': 0.7196071746225868, 'loss_val': 0.7753830077965058, 'psi': 0.6762994301214691}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=44 head_norm_before_train=1.838675 cos_to_last_merge=0.9597 (last merge round=19)
[S14] round=44 local utility u=0.000000 metrics={'f1_val': 0.9966100132760906, 'auprc': 0.9986574233000777, 'loss_val': 0.025313384833691437, 'psi': 0.9974289772856855}-{'f1_val': 0.9966100132760906, 'auprc': 0.9986247774516879, 'loss_val': 0.024849072717358978, 'psi': 0.9974159189463295}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=44 head_norm_before_train=1.756452 cos_to_last_merge=0.9688 (last merge round=19)
[S15] round=44 local utility u=1.000000 metrics={'f1_val': 0.9961624987404362, 'auprc': 0.9980154735530815, 'loss_val': 0.04319449947755957, 'psi': 0.9969036886654943}-{'f1_val': 0.7105371643824028, 'auprc': 0.9887566708916271, 'loss_val': 0.43453062322397673, 'psi': 0.8218249669860925}
[S15] not sending this round → trigger blocked (psi=0.997)
[S16] START round=44 head_norm_before_train=1.957675 cos_to_last_merge=0.9900 (last merge round=28)
[S16] round=44 local utility u=0.000000 metrics={'f1_val': 0.8968597114678345, 'auprc': 0.9875006318223221, 'loss_val': 0.26537961713773456, 'psi': 0.9331160796096296}-{'f1_val': 0.9922260082678341, 'auprc': 0.9881961674841194, 'loss_val': 0.04329545272820111, 'psi': 0.9906140719543483}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=44 head_norm_before_train=1.548369 cos_to_last_merge=0.9837 (last merge round=27)
[S17] round=44 local utility u=1.000000 metrics={'f1_val': 0.8885918027893308, 'auprc': 0.99626444779486, 'loss_val': 0.20767463916336104, 'psi': 0.9316608607915425}-{'f1_val': 0.6693340532151455, 'auprc': 0.7886240215522125, 'loss_val': 0.8857732673368373, 'psi': 0.7170500405499722}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=45 head_norm_before_train=1.769179 cos_to_last_merge=0.7472 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.747
[S2] round=45 local utility u=0.058052 metrics={'f1_val': 0.7337697765722165, 'auprc': 0.8356671123283063, 'loss_val': 0.48815565651651976, 'psi': 0.7745287108746524}-{'f1_val': 0.7077807660522002, 'auprc': 0.8512502853193877, 'loss_val': 0.4950752757206407, 'psi': 0.7651685737590752}
[S2] not sending this round → trigger blocked (psi=0.775)
[S3] START round=45 head_norm_before_train=2.333524 (no previous merge yet)
[S3] round=45 local utility u=0.000000 metrics={'f1_val': 0.9600800976779673, 'auprc': 0.9983676828699938, 'loss_val': 0.21054095053377678, 'psi': 0.9753951317547779}-{'f1_val': 0.9605438728991138, 'auprc': 0.9990898763638425, 'loss_val': 0.16508899040663602, 'psi': 0.9759622742850053}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=45 head_norm_before_train=1.968526 cos_to_last_merge=0.9965 (last merge round=28)
[S4] round=45 local utility u=0.021209 metrics={'f1_val': 0.9520543806629114, 'auprc': 0.9589693967760475, 'loss_val': 0.28748702656594893, 'psi': 0.9548203871081659}-{'f1_val': 0.9424879429949323, 'auprc': 0.9660638450333611, 'loss_val': 0.29378977629673403, 'psi': 0.9519183038103038}
[S4] not sending this round → trigger blocked (psi=0.955)
[S5] START round=45 head_norm_before_train=1.972430 cos_to_last_merge=0.9798 (last merge round=23)
[S5] round=45 local utility u=0.000953 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9931030033055531, 'loss_val': 0.029502026581083356, 'psi': 0.9949528153078079}-{'f1_val': 0.9958213694443535, 'auprc': 0.9928555400837031, 'loss_val': 0.02847673851465797, 'psi': 0.9946350377000934}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=45 head_norm_before_train=1.576891 cos_to_last_merge=0.9876 (last merge round=29)
[S6] round=45 local utility u=0.323126 metrics={'f1_val': 0.7697951424122981, 'auprc': 0.958164226346008, 'loss_val': 0.5368818504258304, 'psi': 0.845142775985782}-{'f1_val': 0.6869828970211069, 'auprc': 0.9575953923638105, 'loss_val': 0.6845541124786566, 'psi': 0.7952278951581884}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] START round=45 head_norm_before_train=1.960608 cos_to_last_merge=0.9979 (last merge round=27)
[S7] round=45 local utility u=0.166628 metrics={'f1_val': 0.6780810303583836, 'auprc': 0.8342398989757139, 'loss_val': 0.3397361512062218, 'psi': 0.7405445778053157}-{'f1_val': 0.6543398601544983, 'auprc': 0.8080464885706429, 'loss_val': 0.45196464590873403, 'psi': 0.7158225115209561}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=45 head_norm_before_train=2.101480 (no previous merge yet)
[S8] round=45 local utility u=0.002308 metrics={'f1_val': 0.990736079195671, 'auprc': 0.9990937544801555, 'loss_val': 0.037525408992136314, 'psi': 0.9940791493094647}-{'f1_val': 0.9938621753089841, 'auprc': 0.989466216805194, 'loss_val': 0.03201556923419332, 'psi': 0.9921037919074681}
[S8] not sending this round → trigger blocked (psi=0.994)
[S9] START round=45 head_norm_before_train=2.205724 (no previous merge yet)
[S9] round=45 local utility u=0.004598 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9999651680896755, 'loss_val': 0.016416794965202857, 'psi': 0.9982478147431559}-{'f1_val': 0.9966605118138915, 'auprc': 0.9980993339895803, 'loss_val': 0.01736091750194172, 'psi': 0.9972360406841669}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=45 head_norm_before_train=1.959103 cos_to_last_merge=0.8117 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.812
[S10] round=45 local utility u=0.000000 metrics={'f1_val': 0.9947781979029806, 'auprc': 0.993441664098223, 'loss_val': 0.029572709652444507, 'psi': 0.9942435843810775}-{'f1_val': 0.9956096535150197, 'auprc': 0.9962448609354271, 'loss_val': 0.028720323958605087, 'psi': 0.9958637364831827}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=45 head_norm_before_train=2.146907 (no previous merge yet)
[S11] round=45 local utility u=0.002392 metrics={'f1_val': 0.9965268648289654, 'auprc': 0.9982576793065809, 'loss_val': 0.02061850060502725, 'psi': 0.9972191906200116}-{'f1_val': 0.9958716985726862, 'auprc': 0.9982692838053903, 'loss_val': 0.021506153030962673, 'psi': 0.9968307326657678}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S11] sending update (kind=head size=1792 to 1 peers)
[S13] START round=45 head_norm_before_train=1.854979 (no previous merge yet)
[S13] round=45 local utility u=0.000000 metrics={'f1_val': 0.6504055127198843, 'auprc': 0.7266044713048113, 'loss_val': 0.7975225372210434, 'psi': 0.6808850961538551}-{'f1_val': 0.6644784987650845, 'auprc': 0.7758705325131335, 'loss_val': 0.7154731746715429, 'psi': 0.709035312264304}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=45 head_norm_before_train=1.845475 cos_to_last_merge=0.9591 (last merge round=19)
[S14] round=45 local utility u=0.000000 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9964682177603844, 'loss_val': 0.030288603780980826, 'psi': 0.9970322488051891}-{'f1_val': 0.9966100132760906, 'auprc': 0.9986574233000777, 'loss_val': 0.025313384833691437, 'psi': 0.9974289772856855}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=45 head_norm_before_train=1.768481 cos_to_last_merge=0.9677 (last merge round=19)
[S15] round=45 local utility u=0.000000 metrics={'f1_val': 0.8151631803774855, 'auprc': 0.9947666753747468, 'loss_val': 0.2543161452324361, 'psi': 0.88700457837639}-{'f1_val': 0.9961624987404362, 'auprc': 0.9980154735530815, 'loss_val': 0.04319449947755957, 'psi': 0.9969036886654943}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=45 head_norm_before_train=1.966148 cos_to_last_merge=0.9894 (last merge round=28)
[S16] round=45 local utility u=0.395029 metrics={'f1_val': 0.9918377118650926, 'auprc': 0.9865926069313324, 'loss_val': 0.042464879079247966, 'psi': 0.9897396698915886}-{'f1_val': 0.8968597114678345, 'auprc': 0.9875006318223221, 'loss_val': 0.26537961713773456, 'psi': 0.9331160796096296}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=45 head_norm_before_train=1.556997 cos_to_last_merge=0.9831 (last merge round=27)
[S17] round=45 local utility u=0.000000 metrics={'f1_val': 0.682113438728672, 'auprc': 0.8849484701516966, 'loss_val': 0.7847433094111682, 'psi': 0.763247451297882}-{'f1_val': 0.8885918027893308, 'auprc': 0.99626444779486, 'loss_val': 0.20767463916336104, 'psi': 0.9316608607915425}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=46 head_norm_before_train=1.779961 cos_to_last_merge=0.7462 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.746
[S2] round=46 local utility u=0.026798 metrics={'f1_val': 0.749244819612774, 'auprc': 0.8274764563810452, 'loss_val': 0.5028388638676212, 'psi': 0.7805374743200825}-{'f1_val': 0.7337697765722165, 'auprc': 0.8356671123283063, 'loss_val': 0.48815565651651976, 'psi': 0.7745287108746524}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S2] sending update (kind=head size=1807 to 1 peers)
[S3] START round=46 head_norm_before_train=2.341354 (no previous merge yet)
[S3] round=46 local utility u=0.191746 metrics={'f1_val': 0.9954668904155206, 'auprc': 0.9995359589862667, 'loss_val': 0.042873584136981675, 'psi': 0.9970945178438191}-{'f1_val': 0.9600800976779673, 'auprc': 0.9983676828699938, 'loss_val': 0.21054095053377678, 'psi': 0.9753951317547779}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=46 head_norm_before_train=1.973416 cos_to_last_merge=0.9964 (last merge round=28)
[S4] round=46 local utility u=0.000000 metrics={'f1_val': 0.9503000874960363, 'auprc': 0.9533757329036423, 'loss_val': 0.29347875040886123, 'psi': 0.9515303456590788}-{'f1_val': 0.9520543806629114, 'auprc': 0.9589693967760475, 'loss_val': 0.28748702656594893, 'psi': 0.9548203871081659}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=46 head_norm_before_train=1.974073 cos_to_last_merge=0.9787 (last merge round=23)
[S5] round=46 local utility u=0.000000 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9904730873026657, 'loss_val': 0.028702357721755948, 'psi': 0.9938133644598987}-{'f1_val': 0.996186023309311, 'auprc': 0.9931030033055531, 'loss_val': 0.029502026581083356, 'psi': 0.9949528153078079}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=46 head_norm_before_train=1.592919 cos_to_last_merge=0.9866 (last merge round=29)
[S6] round=46 local utility u=0.000000 metrics={'f1_val': 0.7220742693473612, 'auprc': 0.9486022313702065, 'loss_val': 0.7062441945247875, 'psi': 0.8126854541564993}-{'f1_val': 0.7697951424122981, 'auprc': 0.958164226346008, 'loss_val': 0.5368818504258304, 'psi': 0.845142775985782}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=46 head_norm_before_train=1.965001 cos_to_last_merge=0.9978 (last merge round=27)
[S7] round=46 local utility u=0.373174 metrics={'f1_val': 0.7267259222805967, 'auprc': 0.9363895718661919, 'loss_val': 0.1917069518468415, 'psi': 0.8105913821148347}-{'f1_val': 0.6780810303583836, 'auprc': 0.8342398989757139, 'loss_val': 0.3397361512062218, 'psi': 0.7405445778053157}
[S7] not sending this round → trigger blocked (psi=0.811)
[S8] START round=46 head_norm_before_train=2.113100 (no previous merge yet)
[S8] round=46 local utility u=0.000000 metrics={'f1_val': 0.9934888194563342, 'auprc': 0.9896693472521838, 'loss_val': 0.031003706071568028, 'psi': 0.991961030574674}-{'f1_val': 0.990736079195671, 'auprc': 0.9990937544801555, 'loss_val': 0.037525408992136314, 'psi': 0.9940791493094647}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=46 head_norm_before_train=2.210971 (no previous merge yet)
[S9] round=46 local utility u=0.000000 metrics={'f1_val': 0.9946069829493691, 'auprc': 0.9999673863709972, 'loss_val': 0.021211484656773118, 'psi': 0.9967511443180204}-{'f1_val': 0.9971029125121428, 'auprc': 0.9999651680896755, 'loss_val': 0.016416794965202857, 'psi': 0.9982478147431559}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=46 head_norm_before_train=1.966811 cos_to_last_merge=0.8114 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.811
[S10] round=46 local utility u=0.006772 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9960829650126015, 'loss_val': 0.028940750686846307, 'psi': 0.9957989781140525}-{'f1_val': 0.9947781979029806, 'auprc': 0.993441664098223, 'loss_val': 0.029572709652444507, 'psi': 0.9942435843810775}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] sending update (kind=head size=1805 to 1 peers)
[S11] START round=46 head_norm_before_train=2.151715 (no previous merge yet)
[S11] round=46 local utility u=0.000000 metrics={'f1_val': 0.990782819884614, 'auprc': 0.9982286465000718, 'loss_val': 0.038849236359087845, 'psi': 0.993761150530797}-{'f1_val': 0.9965268648289654, 'auprc': 0.9982576793065809, 'loss_val': 0.02061850060502725, 'psi': 0.9972191906200116}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=46 head_norm_before_train=1.863777 (no previous merge yet)
[S13] round=46 local utility u=0.104202 metrics={'f1_val': 0.6459773775458806, 'auprc': 0.7601391919347682, 'loss_val': 0.6631530413255137, 'psi': 0.6916421033014357}-{'f1_val': 0.6504055127198843, 'auprc': 0.7266044713048113, 'loss_val': 0.7975225372210434, 'psi': 0.6808850961538551}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=46 head_norm_before_train=1.851179 cos_to_last_merge=0.9585 (last merge round=19)
[S14] round=46 local utility u=0.004726 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9985637947037258, 'loss_val': 0.024658107609435945, 'psi': 0.9976240227760893}-{'f1_val': 0.9974082695017256, 'auprc': 0.9964682177603844, 'loss_val': 0.030288603780980826, 'psi': 0.9970322488051891}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[S15] START round=46 head_norm_before_train=1.780503 cos_to_last_merge=0.9665 (last merge round=19)
[S15] round=46 local utility u=0.000000 metrics={'f1_val': 0.7670897925018723, 'auprc': 0.9892074563963654, 'loss_val': 0.41030265333492927, 'psi': 0.8559368580596696}-{'f1_val': 0.8151631803774855, 'auprc': 0.9947666753747468, 'loss_val': 0.2543161452324361, 'psi': 0.88700457837639}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=46 head_norm_before_train=1.973141 cos_to_last_merge=0.9889 (last merge round=28)
[S16] round=46 local utility u=0.004953 metrics={'f1_val': 0.9913654411896028, 'auprc': 0.9911164461804765, 'loss_val': 0.04329773731346287, 'psi': 0.9912658431859522}-{'f1_val': 0.9918377118650926, 'auprc': 0.9865926069313324, 'loss_val': 0.042464879079247966, 'psi': 0.9897396698915886}
[S16] not sending this round → trigger blocked (psi=0.991)
[S17] START round=46 head_norm_before_train=1.565831 cos_to_last_merge=0.9825 (last merge round=27)
[S17] round=46 local utility u=0.000000 metrics={'f1_val': 0.6605260170433556, 'auprc': 0.8067293658024064, 'loss_val': 0.9980935350316245, 'psi': 0.7190073565469759}-{'f1_val': 0.682113438728672, 'auprc': 0.8849484701516966, 'loss_val': 0.7847433094111682, 'psi': 0.763247451297882}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=47 head_norm_before_train=1.790129 cos_to_last_merge=0.7449 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.745
[S2] round=47 local utility u=0.000000 metrics={'f1_val': 0.7109529177942504, 'auprc': 0.8404350817311015, 'loss_val': 0.574854109639217, 'psi': 0.7627457833689908}-{'f1_val': 0.749244819612774, 'auprc': 0.8274764563810452, 'loss_val': 0.5028388638676212, 'psi': 0.7805374743200825}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=47 head_norm_before_train=2.349791 (no previous merge yet)
[S3] round=47 local utility u=0.000000 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.9997471015087647, 'loss_val': 0.12325776410695329, 'psi': 0.976519991266772}-{'f1_val': 0.9954668904155206, 'auprc': 0.9995359589862667, 'loss_val': 0.042873584136981675, 'psi': 0.9970945178438191}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=47 head_norm_before_train=1.980239 cos_to_last_merge=0.9962 (last merge round=28)
[S4] round=47 local utility u=0.000000 metrics={'f1_val': 0.9419014857256754, 'auprc': 0.968904738700523, 'loss_val': 0.2999787228857208, 'psi': 0.9527027869156144}-{'f1_val': 0.9503000874960363, 'auprc': 0.9533757329036423, 'loss_val': 0.29347875040886123, 'psi': 0.9515303456590788}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=47 head_norm_before_train=1.984701 cos_to_last_merge=0.9782 (last merge round=23)
[S5] round=47 local utility u=0.000212 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9905111001493627, 'loss_val': 0.028392858366056328, 'psi': 0.9938285695985775}-{'f1_val': 0.9960402158980539, 'auprc': 0.9904730873026657, 'loss_val': 0.028702357721755948, 'psi': 0.9938133644598987}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=47 head_norm_before_train=1.609546 cos_to_last_merge=0.9854 (last merge round=29)
[S6] round=47 local utility u=0.000000 metrics={'f1_val': 0.651582318040127, 'auprc': 0.958036480543022, 'loss_val': 0.6705179187644469, 'psi': 0.774163983041285}-{'f1_val': 0.7220742693473612, 'auprc': 0.9486022313702065, 'loss_val': 0.7062441945247875, 'psi': 0.8126854541564993}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=47 head_norm_before_train=1.971680 cos_to_last_merge=0.9975 (last merge round=27)
[S7] round=47 local utility u=0.000000 metrics={'f1_val': 0.6614738641295884, 'auprc': 0.812185947348522, 'loss_val': 0.4213579713970138, 'psi': 0.7217586974171619}-{'f1_val': 0.7267259222805967, 'auprc': 0.9363895718661919, 'loss_val': 0.1917069518468415, 'psi': 0.8105913821148347}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=47 head_norm_before_train=2.121780 (no previous merge yet)
[S8] round=47 local utility u=0.003817 metrics={'f1_val': 0.991097207355627, 'auprc': 0.9991257590140645, 'loss_val': 0.037388928174225865, 'psi': 0.994308628019002}-{'f1_val': 0.9934888194563342, 'auprc': 0.9896693472521838, 'loss_val': 0.031003706071568028, 'psi': 0.991961030574674}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=47 head_norm_before_train=2.211644 (no previous merge yet)
[S9] round=47 local utility u=0.010144 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9999652293757739, 'loss_val': 0.015892243643870804, 'psi': 0.9982478392575953}-{'f1_val': 0.9946069829493691, 'auprc': 0.9999673863709972, 'loss_val': 0.021211484656773118, 'psi': 0.9967511443180204}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=47 head_norm_before_train=1.975677 cos_to_last_merge=0.8110 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.811
[S10] round=47 local utility u=0.000000 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.993027027114661, 'loss_val': 0.02863860837266462, 'psi': 0.9945766029548763}-{'f1_val': 0.9956096535150197, 'auprc': 0.9960829650126015, 'loss_val': 0.028940750686846307, 'psi': 0.9957989781140525}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=47 head_norm_before_train=2.156149 (no previous merge yet)
[S11] round=47 local utility u=0.026455 metrics={'f1_val': 0.9965268648289654, 'auprc': 0.9982036121410481, 'loss_val': 0.02032751728337857, 'psi': 0.9971975637537984}-{'f1_val': 0.990782819884614, 'auprc': 0.9982286465000718, 'loss_val': 0.038849236359087845, 'psi': 0.993761150530797}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S11] sending update (kind=head size=1788 to 1 peers)
[S13] START round=47 head_norm_before_train=1.869265 (no previous merge yet)
[S13] round=47 local utility u=0.004307 metrics={'f1_val': 0.7195075938370284, 'auprc': 0.717589456390331, 'loss_val': 0.9680713756327664, 'psi': 0.7187403388583495}-{'f1_val': 0.6459773775458806, 'auprc': 0.7601391919347682, 'loss_val': 0.6631530413255137, 'psi': 0.6916421033014357}
[S13] not sending this round → trigger blocked (psi=0.719)
[S14] START round=47 head_norm_before_train=1.858136 cos_to_last_merge=0.9579 (last merge round=19)
[S14] round=47 local utility u=0.000000 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.9985650362470961, 'loss_val': 0.02362975681616626, 'psi': 0.9973783534652887}-{'f1_val': 0.9969975081576651, 'auprc': 0.9985637947037258, 'loss_val': 0.024658107609435945, 'psi': 0.9976240227760893}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=47 head_norm_before_train=1.793506 cos_to_last_merge=0.9653 (last merge round=19)
[S15] round=47 local utility u=0.650727 metrics={'f1_val': 0.9286190164989317, 'auprc': 0.9962548114726077, 'loss_val': 0.09916544150362513, 'psi': 0.9556733344884021}-{'f1_val': 0.7670897925018723, 'auprc': 0.9892074563963654, 'loss_val': 0.41030265333492927, 'psi': 0.8559368580596696}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=47 head_norm_before_train=1.980007 cos_to_last_merge=0.9884 (last merge round=28)
[S16] round=47 local utility u=0.000000 metrics={'f1_val': 0.9908553097366877, 'auprc': 0.9919451689653885, 'loss_val': 0.04595912784650674, 'psi': 0.991291253428168}-{'f1_val': 0.9913654411896028, 'auprc': 0.9911164461804765, 'loss_val': 0.04329773731346287, 'psi': 0.9912658431859522}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=47 head_norm_before_train=1.577979 cos_to_last_merge=0.9818 (last merge round=27)
[S17] round=47 local utility u=0.000000 metrics={'f1_val': 0.6486226758445959, 'auprc': 0.8183558777025559, 'loss_val': 1.0007420887752918, 'psi': 0.7165159565877799}-{'f1_val': 0.6605260170433556, 'auprc': 0.8067293658024064, 'loss_val': 0.9980935350316245, 'psi': 0.7190073565469759}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=48 head_norm_before_train=1.800152 cos_to_last_merge=0.7438 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.744
[S2] round=48 local utility u=0.078910 metrics={'f1_val': 0.7846665341219865, 'auprc': 0.7835194493071098, 'loss_val': 0.6885694734706918, 'psi': 0.7842077001960358}-{'f1_val': 0.7109529177942504, 'auprc': 0.8404350817311015, 'loss_val': 0.574854109639217, 'psi': 0.7627457833689908}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] START round=48 head_norm_before_train=2.358413 (no previous merge yet)
[S3] round=48 local utility u=0.106715 metrics={'f1_val': 0.983004208656469, 'auprc': 0.9997377410798545, 'loss_val': 0.041614413807581914, 'psi': 0.9896976216258231}-{'f1_val': 0.9610352511054436, 'auprc': 0.9997471015087647, 'loss_val': 0.12325776410695329, 'psi': 0.976519991266772}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=48 head_norm_before_train=1.987882 cos_to_last_merge=0.9958 (last merge round=28)
[S4] round=48 local utility u=0.017360 metrics={'f1_val': 0.9446805006956892, 'auprc': 0.9720853808687702, 'loss_val': 0.2914753402556794, 'psi': 0.9556424527649215}-{'f1_val': 0.9419014857256754, 'auprc': 0.968904738700523, 'loss_val': 0.2999787228857208, 'psi': 0.9527027869156144}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=48 head_norm_before_train=1.994368 cos_to_last_merge=0.9783 (last merge round=23)
[S5] round=48 local utility u=0.000873 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9907488583161101, 'loss_val': 0.027360925298358832, 'psi': 0.9939236728652765}-{'f1_val': 0.9960402158980539, 'auprc': 0.9905111001493627, 'loss_val': 0.028392858366056328, 'psi': 0.9938285695985775}
[S5] not sending this round → trigger blocked (psi=0.994)
[S6] START round=48 head_norm_before_train=1.623855 cos_to_last_merge=0.9845 (last merge round=29)
[S6] round=48 local utility u=0.821952 metrics={'f1_val': 0.8682059904193488, 'auprc': 0.9673278575295118, 'loss_val': 0.35423045779499895, 'psi': 0.907854737263414}-{'f1_val': 0.651582318040127, 'auprc': 0.958036480543022, 'loss_val': 0.6705179187644469, 'psi': 0.774163983041285}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[S7] START round=48 head_norm_before_train=1.979771 cos_to_last_merge=0.9971 (last merge round=27)
[S7] round=48 local utility u=0.156501 metrics={'f1_val': 0.6795312541239731, 'auprc': 0.8410515959229996, 'loss_val': 0.3032966456218583, 'psi': 0.7441393908435837}-{'f1_val': 0.6614738641295884, 'auprc': 0.812185947348522, 'loss_val': 0.4213579713970138, 'psi': 0.7217586974171619}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=48 head_norm_before_train=2.126311 (no previous merge yet)
[S8] round=48 local utility u=0.000000 metrics={'f1_val': 0.8945995307425294, 'auprc': 0.9991554087242395, 'loss_val': 0.2086734820847507, 'psi': 0.9364218819352135}-{'f1_val': 0.991097207355627, 'auprc': 0.9991257590140645, 'loss_val': 0.037388928174225865, 'psi': 0.994308628019002}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=48 head_norm_before_train=2.216194 (no previous merge yet)
[S9] round=48 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9999665305964603, 'loss_val': 0.016116775301155965, 'psi': 0.9982483597458698}-{'f1_val': 0.9971029125121428, 'auprc': 0.9999652293757739, 'loss_val': 0.015892243643870804, 'psi': 0.9982478392575953}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=48 head_norm_before_train=1.978395 cos_to_last_merge=0.8113 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.811
[S10] round=48 local utility u=0.003237 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9952055283476953, 'loss_val': 0.028699746424207164, 'psi': 0.9954480034480899}-{'f1_val': 0.9956096535150197, 'auprc': 0.993027027114661, 'loss_val': 0.02863860837266462, 'psi': 0.9945766029548763}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=48 head_norm_before_train=2.162133 (no previous merge yet)
[S11] round=48 local utility u=0.000000 metrics={'f1_val': 0.9965268648289654, 'auprc': 0.9982206478183238, 'loss_val': 0.020532135414501586, 'psi': 0.9972043780247086}-{'f1_val': 0.9965268648289654, 'auprc': 0.9982036121410481, 'loss_val': 0.02032751728337857, 'psi': 0.9971975637537984}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=48 head_norm_before_train=1.874713 (no previous merge yet)
[S13] round=48 local utility u=0.277208 metrics={'f1_val': 0.7269157219898646, 'auprc': 0.7824532253589941, 'loss_val': 0.652695458888628, 'psi': 0.7491307233375164}-{'f1_val': 0.7195075938370284, 'auprc': 0.717589456390331, 'loss_val': 0.9680713756327664, 'psi': 0.7187403388583495}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=48 head_norm_before_train=1.865912 cos_to_last_merge=0.9573 (last merge round=19)
[S14] round=48 local utility u=0.000000 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.9985525151596271, 'loss_val': 0.02488261347556645, 'psi': 0.9973733450303011}-{'f1_val': 0.9965872316107504, 'auprc': 0.9985650362470961, 'loss_val': 0.02362975681616626, 'psi': 0.9973783534652887}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=48 head_norm_before_train=1.806711 cos_to_last_merge=0.9640 (last merge round=19)
[S15] round=48 local utility u=0.000000 metrics={'f1_val': 0.890808592560149, 'auprc': 0.9959719631569682, 'loss_val': 0.152020053414445, 'psi': 0.9328739407988766}-{'f1_val': 0.9286190164989317, 'auprc': 0.9962548114726077, 'loss_val': 0.09916544150362513, 'psi': 0.9556733344884021}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=48 head_norm_before_train=1.988170 cos_to_last_merge=0.9879 (last merge round=28)
[S16] round=48 local utility u=0.000000 metrics={'f1_val': 0.9895618889012239, 'auprc': 0.9926177889263488, 'loss_val': 0.05079136173817821, 'psi': 0.9907842489112738}-{'f1_val': 0.9908553097366877, 'auprc': 0.9919451689653885, 'loss_val': 0.04595912784650674, 'psi': 0.991291253428168}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=48 head_norm_before_train=1.588180 cos_to_last_merge=0.9812 (last merge round=27)
[S17] round=48 local utility u=0.526255 metrics={'f1_val': 0.7005220176472233, 'auprc': 0.9151105997920423, 'loss_val': 0.5498917551046391, 'psi': 0.7863574505051509}-{'f1_val': 0.6486226758445959, 'auprc': 0.8183558777025559, 'loss_val': 1.0007420887752918, 'psi': 0.7165159565877799}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=49 head_norm_before_train=1.809607 cos_to_last_merge=0.7428 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.743
[S2] round=49 local utility u=0.000000 metrics={'f1_val': 0.7149115512418341, 'auprc': 0.8403473558233797, 'loss_val': 0.6754217193832437, 'psi': 0.7650858730744524}-{'f1_val': 0.7846665341219865, 'auprc': 0.7835194493071098, 'loss_val': 0.6885694734706918, 'psi': 0.7842077001960358}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=49 head_norm_before_train=2.367287 (no previous merge yet)
[S3] round=49 local utility u=0.030491 metrics={'f1_val': 0.9906988060823055, 'auprc': 0.9997669413223675, 'loss_val': 0.026887695243647865, 'psi': 0.9943260601783304}-{'f1_val': 0.983004208656469, 'auprc': 0.9997377410798545, 'loss_val': 0.041614413807581914, 'psi': 0.9896976216258231}
[S3] not sending this round → trigger blocked (psi=0.994)
[S4] START round=49 head_norm_before_train=1.994035 cos_to_last_merge=0.9956 (last merge round=28)
[S4] round=49 local utility u=0.000000 metrics={'f1_val': 0.9399043862129473, 'auprc': 0.9360615254618379, 'loss_val': 0.32041976236412634, 'psi': 0.9383672419125035}-{'f1_val': 0.9446805006956892, 'auprc': 0.9720853808687702, 'loss_val': 0.2914753402556794, 'psi': 0.9556424527649215}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=49 head_norm_before_train=2.000337 cos_to_last_merge=0.9787 (last merge round=23)
[S5] round=49 local utility u=0.006939 metrics={'f1_val': 0.9958213694443535, 'auprc': 0.9958764505567145, 'loss_val': 0.027553449386651434, 'psi': 0.9958434018892979}-{'f1_val': 0.9960402158980539, 'auprc': 0.9907488583161101, 'loss_val': 0.027360925298358832, 'psi': 0.9939236728652765}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=49 head_norm_before_train=1.632362 cos_to_last_merge=0.9838 (last merge round=29)
[S6] round=49 local utility u=0.000000 metrics={'f1_val': 0.6027459229294544, 'auprc': 0.9550947951148445, 'loss_val': 0.743974811129353, 'psi': 0.7436854718036104}-{'f1_val': 0.8682059904193488, 'auprc': 0.9673278575295118, 'loss_val': 0.35423045779499895, 'psi': 0.907854737263414}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=49 head_norm_before_train=1.985712 cos_to_last_merge=0.9968 (last merge round=27)
[S7] round=49 local utility u=0.200966 metrics={'f1_val': 0.7127448091130022, 'auprc': 0.8822024809172179, 'loss_val': 0.22409899418659915, 'psi': 0.7805278778346885}-{'f1_val': 0.6795312541239731, 'auprc': 0.8410515959229996, 'loss_val': 0.3032966456218583, 'psi': 0.7441393908435837}
[S7] not sending this round → trigger blocked (psi=0.781)
[S8] START round=49 head_norm_before_train=2.129751 (no previous merge yet)
[S8] round=49 local utility u=0.000000 metrics={'f1_val': 0.7139293602936292, 'auprc': 0.9698047972492888, 'loss_val': 0.7188038681094375, 'psi': 0.8162795350758931}-{'f1_val': 0.8945995307425294, 'auprc': 0.9991554087242395, 'loss_val': 0.2086734820847507, 'psi': 0.9364218819352135}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=49 head_norm_before_train=2.222797 (no previous merge yet)
[S9] round=49 local utility u=0.000000 metrics={'f1_val': 0.9971000495392299, 'auprc': 0.9999463262196094, 'loss_val': 0.01607491085898293, 'psi': 0.9982385602113818}-{'f1_val': 0.9971029125121428, 'auprc': 0.9999665305964603, 'loss_val': 0.016116775301155965, 'psi': 0.9982483597458698}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=49 head_norm_before_train=1.984313 cos_to_last_merge=0.8112 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.811
[S10] round=49 local utility u=0.000000 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9940767777642279, 'loss_val': 0.028109842400873383, 'psi': 0.994996503214703}-{'f1_val': 0.9956096535150197, 'auprc': 0.9952055283476953, 'loss_val': 0.028699746424207164, 'psi': 0.9954480034480899}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=49 head_norm_before_train=2.167496 (no previous merge yet)
[S11] round=49 local utility u=0.000082 metrics={'f1_val': 0.9965268648289654, 'auprc': 0.9982813607008504, 'loss_val': 0.020550725196131932, 'psi': 0.9972286631777194}-{'f1_val': 0.9965268648289654, 'auprc': 0.9982206478183238, 'loss_val': 0.020532135414501586, 'psi': 0.9972043780247086}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S11] sending update (kind=head size=1792 to 1 peers)
[S13] START round=49 head_norm_before_train=1.879708 (no previous merge yet)
[S13] round=49 local utility u=0.000000 metrics={'f1_val': 0.6617798672054394, 'auprc': 0.7071544068816251, 'loss_val': 0.7508362487286458, 'psi': 0.6799296830759136}-{'f1_val': 0.7269157219898646, 'auprc': 0.7824532253589941, 'loss_val': 0.652695458888628, 'psi': 0.7491307233375164}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=49 head_norm_before_train=1.872306 cos_to_last_merge=0.9564 (last merge round=19)
[S14] round=49 local utility u=0.000000 metrics={'f1_val': 0.9963442551067831, 'auprc': 0.9984885310330042, 'loss_val': 0.026536719341785416, 'psi': 0.9972019654772715}-{'f1_val': 0.9965872316107504, 'auprc': 0.9985525151596271, 'loss_val': 0.02488261347556645, 'psi': 0.9973733450303011}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=49 head_norm_before_train=1.818304 cos_to_last_merge=0.9627 (last merge round=19)
[S15] round=49 local utility u=0.176786 metrics={'f1_val': 0.9387714626268884, 'auprc': 0.9970071770346666, 'loss_val': 0.08933004412894782, 'psi': 0.9620657483899997}-{'f1_val': 0.890808592560149, 'auprc': 0.9959719631569682, 'loss_val': 0.152020053414445, 'psi': 0.9328739407988766}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=49 head_norm_before_train=1.995830 cos_to_last_merge=0.9874 (last merge round=28)
[S16] round=49 local utility u=0.000000 metrics={'f1_val': 0.9882515140476476, 'auprc': 0.9919163581762647, 'loss_val': 0.06132737095448516, 'psi': 0.9897174516990944}-{'f1_val': 0.9895618889012239, 'auprc': 0.9926177889263488, 'loss_val': 0.05079136173817821, 'psi': 0.9907842489112738}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=49 head_norm_before_train=1.597577 cos_to_last_merge=0.9807 (last merge round=27)
[S17] round=49 local utility u=0.016533 metrics={'f1_val': 0.7291747873477742, 'auprc': 0.9262667649660041, 'loss_val': 0.7222115281792336, 'psi': 0.8080115783950661}-{'f1_val': 0.7005220176472233, 'auprc': 0.9151105997920423, 'loss_val': 0.5498917551046391, 'psi': 0.7863574505051509}
[S17] not sending this round → trigger blocked (psi=0.808)
[runner] rounds complete.
[runner] all agents stopped.
