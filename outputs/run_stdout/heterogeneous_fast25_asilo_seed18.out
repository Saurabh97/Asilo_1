[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:41903
[S3] → join 127.0.0.1:41902
[S4] → join 127.0.0.1:41902
[S5] → join 127.0.0.1:41902
[S6] → join 127.0.0.1:41902
[S7] → join 127.0.0.1:41902
[S8] → join 127.0.0.1:41902
[S9] → join 127.0.0.1:41902
[S10] → join 127.0.0.1:41902
[S11] → join 127.0.0.1:41902
[S13] → join 127.0.0.1:41902
[S14] → join 127.0.0.1:41902
[S15] → join 127.0.0.1:41902
[S16] → join 127.0.0.1:41902
[S17] → join 127.0.0.1:41902
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.146761 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.169825 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.111796 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.218452 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.169417 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.122548 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.159039 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.157739 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.168717 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.197303 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.121047 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.163583 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.127734 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.163412 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.174517 (no previous merge yet)
[S13]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S3] + discovered S15
[S3] + discovered S4
[S3] + discovered S9
[S3] + discovered S6
[S4] + discovered S3
[S4] + discovered S2
[S3] + discovered S14
[S3] + discovered S7
[S3] + discovered S10
[S3] + discovered S17
[S3] + discovered S5
[S3] + discovered S11
[S3] + discovered S13
[S3] + discovered S16
[S3] + discovered S8
[S4] + discovered S9
[S4] + discovered S17
[S5] + discovered S2
[S5] + discovered S3
[S5] + discovered S4
[S4] + discovered S11
[S4] + discovered S13
[S4] + discovered S8
[S4] + discovered S15
[S4] + discovered S16
[S4] + discovered S5
[S4] + discovered S10
[S4] + discovered S7
[S4] + discovered S14
[S4] + discovered S6
[S6] + discovered S3
[S6] + discovered S2
[S6] + discovered S5
[S6] + discovered S4
[S5] + discovered S15
[S5] + discovered S13
[S5] + discovered S16
[S5] + discovered S10
[S5] + discovered S14
[S5] + discovered S6
[S5] + discovered S11
[S5] + discovered S8
[S5] + discovered S7
[S5] + discovered S17
[S5] + discovered S9
[S6] + discovered S13
[S6] + discovered S14
[S6] + discovered S8
[S6] + discovered S7
[S6] + discovered S10
[S7] + discovered S3
[S7] + discovered S6
[S7] + discovered S5
[S7] + discovered S2
[S7] + discovered S4
[S6] + discovered S16
[S6] + discovered S11
[S6] + discovered S17
[S6] + discovered S9
[S6] + discovered S15
[S8] + discovered S7
[S8] + discovered S2
[S7] + discovered S9
[S7] + discovered S10
[S7] + discovered S8
[S7] + discovered S15
[S7] + discovered S16
[S7] + discovered S11
[S8] + discovered S4
[S7] + discovered S17
[S8] + discovered S3
[S8] + discovered S6
[S7] + discovered S13
[S7] + discovered S14
[S8] + discovered S5
[S9] + discovered S3
[S8] + discovered S17
[S9] + discovered S6
[S9] + discovered S8
[S9] + discovered S4
[S9] + discovered S7
[S9] + discovered S2
[S8] + discovered S10
[S9] + discovered S5
[S8] + discovered S9
[S8] + discovered S16
[S8] + discovered S15
[S8] + discovered S13
[S8] + discovered S14
[S8] + discovered S11
[S10] + discovered S3
[S9] + discovered S17
[S9] + discovered S13
[S10] + discovered S6
[S9] + discovered S15
[S10] + discovered S7
[S9] + discovered S14
[S10] + discovered S4
[S9] + discovered S10
[S10] + discovered S8
[S10] + discovered S2
[S10] + discovered S9
[S9] + discovered S11
[S10] + discovered S5
[S9] + discovered S16
[S10] + discovered S13
[S10] + discovered S17
[S10] + discovered S15
[S10] + discovered S16
[S10] + discovered S11
[S10] + discovered S14
[S11] + discovered S5
[S11] + discovered S8
[S11] + discovered S6
[S11] + discovered S2
[S11] + discovered S7
[S11] + discovered S3
[S11] + discovered S10
[S11] + discovered S4
[S11] + discovered S9
[S13] + discovered S5
[S13] + discovered S9
[S13] + discovered S11
[S13] + discovered S4
[S13] + discovered S8
[S13] + discovered S10
[S13] + discovered S2
[S13] + discovered S3
[S11] + discovered S15
[S11] + discovered S14
[S11] + discovered S16
[S11] + discovered S17
[S11] + discovered S13
[S13] + discovered S6
[S13] + discovered S7
[S14] + discovered S4
[S14] + discovered S3
[S14] + discovered S10
[S14] + discovered S8
[S13] + discovered S15
[S13] + discovered S16
[S13] + discovered S17
[S13] + discovered S14
[S14] + discovered S6
[S14] + discovered S7
[S14] + discovered S11
[S14] + discovered S5
[S14] + discovered S13
[S14] + discovered S2
[S14] + discovered S9
[S15] + discovered S9
[S15] + discovered S5
[S15] + discovered S7
[S15] + discovered S2
[S15] + discovered S8
[S15] + discovered S10
[S14] + discovered S15
[S15] + discovered S13
[S15] + discovered S3
[S15] + discovered S11
[S14] + discovered S16
[S15] + discovered S6
[S15] + discovered S4
[S14] + discovered S17
[S15] + discovered S14
[S16] + discovered S15
[S16] + discovered S11
[S16] + discovered S4
[S16] + discovered S3
[S16] + discovered S13
[S16] + discovered S9
[S16] + discovered S10
[S16] + discovered S8
[S16] + discovered S2
[S16] + discovered S5
[S16] + discovered S6
[S16] + discovered S14
[S15] + discovered S16
[S15] + discovered S17
[S16] + discovered S7
[S17] + discovered S3
[S17] + discovered S4
[S17] + discovered S2
[S17] + discovered S9
[S17] + discovered S6
[S17] + discovered S10
[S17] + discovered S13
[S17] + discovered S14
[S17] + discovered S8
[S17] + discovered S11
[S17] + discovered S7
[S17] + discovered S16
[S17] + discovered S5
[S17] + discovered S15
[S16] + discovered S17
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] ⇄ pheromone p=1.000 → S4@127.0.0.1:41904
[S11] ⇄ pheromone p=1.000 → S16@127.0.0.1:41916
[S5] ⇄ pheromone p=1.000 → S16@127.0.0.1:41916
[S4] ⇄ pheromone p=1.000 → S14@127.0.0.1:41914
[S16] ⇄ pheromone p=1.000 → S15@127.0.0.1:41915
[S8] ⇄ pheromone p=1.000 → S3@127.0.0.1:41903
[S3] ⇄ pheromone p=1.000 → S17@127.0.0.1:41917
[S15] ⇄ pheromone p=1.000 → S13@127.0.0.1:41913
[S14] ⇄ pheromone p=1.000 → S11@127.0.0.1:41912
[S2] ⇄ pheromone p=1.000 → S17@127.0.0.1:41917
[S13] ⇄ pheromone p=1.000 → S2@127.0.0.1:41902
[S10] ⇄ pheromone p=1.000 → S8@127.0.0.1:41909
[S6] ⇄ pheromone p=1.000 → S17@127.0.0.1:41917
[S9] ⇄ pheromone p=1.000 → S16@127.0.0.1:41916
[S17] ⇄ pheromone p=1.000 → S14@127.0.0.1:41914
[S2] START round=1 head_norm_before_train=1.147725 (no previous merge yet)
[S2] round=1 local utility u=0.382329 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6416402472656434, 'loss_val': 1.3331307734210318, 'psi': 0.3417223789393974}-{'f1_val': 0.05585516178736518, 'auprc': 0.5756284761752087, 'loss_val': 1.384220769984259, 'psi': 0.2637644875425026}
[S3] START round=1 head_norm_before_train=1.183091 (no previous merge yet)
[S3] round=1 local utility u=0.156602 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9641529631125769, 'loss_val': 1.2784234751520973, 'psi': 0.46956522461349504}-{'f1_val': 0.13984006561410703, 'auprc': 0.8775956495702597, 'loss_val': 1.3319549498010783, 'psi': 0.4349422991965681}
[S4] START round=1 head_norm_before_train=1.124787 (no previous merge yet)
[S4] round=1 local utility u=0.018872 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7986287951208106, 'loss_val': 1.30425764443898, 'psi': 0.40358749538543476}-{'f1_val': 0.14022662889518414, 'auprc': 0.7973607099905136, 'loss_val': 1.3381972974511458, 'psi': 0.4030802613333159}
[S5] START round=1 head_norm_before_train=1.229710 (no previous merge yet)
[S5] round=1 local utility u=0.286074 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.703926263132534, 'loss_val': 1.2624371755863, 'psi': 0.3669276481101565}-{'f1_val': 0.14226190476190476, 'auprc': 0.5343309070092748, 'loss_val': 1.3257989256891434, 'psi': 0.2990895056608528}
[S6] START round=1 head_norm_before_train=1.171762 (no previous merge yet)
[S6] round=1 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8440737514927482, 'loss_val': 1.3128302330270145, 'psi': 0.4224852698278685}-{'f1_val': 0.14142628205128205, 'auprc': 0.874105344392728, 'loss_val': 1.337856028102494, 'psi': 0.43449790698786045}
[S7] START round=1 head_norm_before_train=1.146699 (no previous merge yet)
[S7] round=1 local utility u=0.028703 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7752100688994215, 'loss_val': 1.2729673323677393, 'psi': 0.3953181211972236}-{'f1_val': 0.14205682272909165, 'auprc': 0.7744770429268268, 'loss_val': 1.3281746619985202, 'psi': 0.39502491080818575}
[S8] START round=1 head_norm_before_train=1.157989 (no previous merge yet)
[S8] round=1 local utility u=0.262175 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.770945326932231, 'loss_val': 1.3274216157870764, 'psi': 0.3923517202086667}-{'f1_val': 0.13995598239295717, 'auprc': 0.6050490185046002, 'loss_val': 1.3540833826835739, 'psi': 0.3259931968376144}
[S9] START round=1 head_norm_before_train=1.153565 (no previous merge yet)
[S9] round=1 local utility u=0.165780 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9876462256410217, 'loss_val': 1.272932591856526, 'psi': 0.4798972645404063}-{'f1_val': 0.141397957139996, 'auprc': 0.8968921558740368, 'loss_val': 1.3322297278370328, 'psi': 0.44359563663361234}
[S10] START round=1 head_norm_before_train=1.176324 (no previous merge yet)
[S10] round=1 local utility u=0.003446 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.5820614370569814, 'loss_val': 1.328949596937783, 'psi': 0.315997557347827}-{'f1_val': 0.13862163754172394, 'auprc': 0.5870908325271657, 'loss_val': 1.350929056734367, 'psi': 0.3180093155359006}
[S11] START round=1 head_norm_before_train=1.206715 (no previous merge yet)
[S11] round=1 local utility u=0.780822 metrics={'f1_val': 0.34345890745386604, 'auprc': 0.5935757980111936, 'loss_val': 1.3316116576302972, 'psi': 0.4435056636767971}-{'f1_val': 0.0921497856981728, 'auprc': 0.589644046794908, 'loss_val': 1.3736048641407768, 'psi': 0.29114749013686686}
[S13] START round=1 head_norm_before_train=1.125040 (no previous merge yet)
[S13] round=1 local utility u=0.000000 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.6210420457824264, 'loss_val': 1.3026857726128593, 'psi': 0.3326482758592024}-{'f1_val': 0.1403857625770531, 'auprc': 0.6374000034749716, 'loss_val': 1.3361524427503926, 'psi': 0.3391914589362205}
[S14] START round=1 head_norm_before_train=1.171543 (no previous merge yet)
[S14] round=1 local utility u=0.203528 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8564973507076619, 'loss_val': 1.3092170636841933, 'psi': 0.426813652012687}-{'f1_val': 0.14035785288270378, 'auprc': 0.7281847244604613, 'loss_val': 1.3313344028804022, 'psi': 0.3754886015138068}
[S15] START round=1 head_norm_before_train=1.130382 (no previous merge yet)
[S15] round=1 local utility u=0.361653 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7740070249251779, 'loss_val': 1.3315327468729163, 'psi': 0.39344300078700617}-{'f1_val': 0.13973365136155833, 'auprc': 0.5430538087969526, 'loss_val': 1.3619791248516835, 'psi': 0.30106171433571605}
[S16] START round=1 head_norm_before_train=1.166384 (no previous merge yet)
[S16] round=1 local utility u=0.530320 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.5162591986242013, 'loss_val': 1.3303430954130577, 'psi': 0.29088614956920245}-{'f1_val': 0.016416643079535807, 'auprc': 0.4204229251451135, 'loss_val': 1.3581491384138527, 'psi': 0.1780191559057669}
[S17] START round=1 head_norm_before_train=1.185828 (no previous merge yet)
[S17] round=1 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.7654885760683745, 'loss_val': 1.3324200094594243, 'psi': 0.39076480841778044}-{'f1_val': 0.3733684234014053, 'auprc': 0.7170643891424009, 'loss_val': 1.3639134546031837, 'psi': 0.5108468096978036}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:41908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:41903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S11] → sending delta(kind=head bytes=1792) to S2@127.0.0.1:41902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1785 reason=None
[S7] → sending delta(kind=head bytes=1785) to S6@127.0.0.1:41907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S2] → sending delta(kind=head bytes=1788) to S7@127.0.0.1:41908
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S15] → sending delta(kind=head bytes=1788) to S10@127.0.0.1:41911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] → sending delta(kind=head bytes=1794) to S16@127.0.0.1:41916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:41912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:41902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S16] → sending delta(kind=head bytes=1787) to S3@127.0.0.1:41903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:41907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S4] → sending delta(kind=head bytes=1791) to S2@127.0.0.1:41902
[S3] sending update (kind=head size=1795 to 1 peers)
[S16] sending update (kind=head size=1787 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1791 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S9] sending update (kind=head size=1794 to 1 peers)
[S15] sending update (kind=head size=1788 to 1 peers)
[S2] sending update (kind=head size=1788 to 1 peers)
[S7] sending update (kind=head size=1785 to 1 peers)
[S11] sending update (kind=head size=1792 to 1 peers)
[S5] sending update (kind=head size=1794 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1795) from S3
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.214718)
[S6] loaded HEAD from S3 (vec_in norm=1.214718)
[S6] cosine check vs S3: cos=0.0755
[S6] BUFFERED delta from S3 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1788) from S2
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.161192)
[S7] loaded HEAD from S2 (vec_in norm=1.161192)
[S7] cosine check vs S2: cos=0.0381
[S7] BUFFERED delta from S2 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1785) from S7
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.184378)
[S6] loaded HEAD from S7 (vec_in norm=1.184378)
[S6] cosine check vs S7: cos=-0.0012
[S6] DROPPED delta from S7 (cos=-0.0012 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1796) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.187897)
[S7] loaded HEAD from S14 (vec_in norm=1.187897)
[S7] cosine check vs S14: cos=-0.0257
[S7] DROPPED delta from S14 (cos=-0.0257 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1794) from S9
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.182627)
[S16] loaded HEAD from S9 (vec_in norm=1.182627)
[S16] cosine check vs S9: cos=0.0281
[S16] BUFFERED delta from S9 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1788) from S15
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.143661)
[S10] loaded HEAD from S15 (vec_in norm=1.143661)
[S10] cosine check vs S15: cos=0.0107
[S10] BUFFERED delta from S15 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1794) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.265970)
[S3] loaded HEAD from S5 (vec_in norm=1.265970)
[S3] cosine check vs S5: cos=-0.0189
[S3] DROPPED delta from S5 (cos=-0.0189 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1787) from S16
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.176404)
[S3] loaded HEAD from S16 (vec_in norm=1.176404)
[S3] cosine check vs S16: cos=-0.0415
[S3] DROPPED delta from S16 (cos=-0.0415 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1791) from S4
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.144781)
[S2] loaded HEAD from S4 (vec_in norm=1.144781)
[S2] cosine check vs S4: cos=-0.0924
[S2] DROPPED delta from S4 (cos=-0.0924 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1797) from S10
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.192898)
[S2] loaded HEAD from S10 (vec_in norm=1.192898)
[S2] cosine check vs S10: cos=-0.0344
[S2] DROPPED delta from S10 (cos=-0.0344 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1792) from S11
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.225611)
[S2] loaded HEAD from S11 (vec_in norm=1.225611)
[S2] cosine check vs S11: cos=0.0066
[S2] BUFFERED delta from S11 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1795) from S8
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.165822)
[S11] loaded HEAD from S8 (vec_in norm=1.165822)
[S11] cosine check vs S8: cos=0.0012
[S11] BUFFERED delta from S8 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=1 metric=0.1414 head_norm=1.180392
[S6] _apply_head_vector_avg (torch): Δ‖w‖=8.142871e-01
[S6] stored merged vector for next round verification (round=1)
[S6] DEBUG after merge:  round=1 metric=0.1414 head_norm=0.878276 delta_norm=0.814287
[S6] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=1 metric=0.1386 head_norm=1.192898
[S10] _apply_head_vector_avg (torch): Δ‖w‖=8.218555e-01
[S10] stored merged vector for next round verification (round=1)
[S10] DEBUG after merge:  round=1 metric=0.1386 head_norm=0.830684 delta_norm=0.821856
[S10] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=1 metric=0.3435 head_norm=1.225611
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.452690e-01
[S11] stored merged vector for next round verification (round=1)
[S11] DEBUG after merge:  round=1 metric=0.1404 head_norm=0.846257 delta_norm=0.845269
[S11] aggregate: ROLLBACK (f1_val pre=0.343 post=0.140 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=1 metric=0.1406 head_norm=1.176404
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.222449e-01
[S16] stored merged vector for next round verification (round=1)
[S16] DEBUG after merge:  round=1 metric=0.1406 head_norm=0.845684 delta_norm=0.822245
[S16] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=1 metric=0.1421 head_norm=1.184378
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.133679e-01
[S7] stored merged vector for next round verification (round=1)
[S7] DEBUG after merge:  round=1 metric=0.1421 head_norm=0.844980 delta_norm=0.813368
[S7] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=1 metric=0.1418 head_norm=1.161192
[S2] _apply_head_vector_avg (torch): Δ‖w‖=8.413848e-01
[S2] stored merged vector for next round verification (round=1)
[S2] DEBUG after merge:  round=1 metric=0.3562 head_norm=0.846945 delta_norm=0.841385
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=0.846945 cos_to_last_merge=1.0000 (last merge round=1)
[S2] round=2 local utility u=0.182771 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7617494709384609, 'loss_val': 1.3279165449143495, 'psi': 0.3897660684085244}-{'f1_val': 0.1417771333885667, 'auprc': 0.6416402472656434, 'loss_val': 1.3331307734210318, 'psi': 0.3417223789393974}
[S3] START round=2 head_norm_before_train=1.214718 (no previous merge yet)
[S3] round=2 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.6735240592297956, 'loss_val': 1.204025540617531, 'psi': 0.3533136630603825}-{'f1_val': 0.13984006561410703, 'auprc': 0.9641529631125769, 'loss_val': 1.2784234751520973, 'psi': 0.46956522461349504}
[S4] START round=2 head_norm_before_train=1.144781 (no previous merge yet)
[S4] round=2 local utility u=0.014510 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7956453782794808, 'loss_val': 1.2662878992688595, 'psi': 0.40239412864890284}-{'f1_val': 0.14022662889518414, 'auprc': 0.7986287951208106, 'loss_val': 1.30425764443898, 'psi': 0.40358749538543476}
[S5] START round=2 head_norm_before_train=1.265970 (no previous merge yet)
[S5] round=2 local utility u=0.141175 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7701166650777269, 'loss_val': 1.1786582693316014, 'psi': 0.3934038088882336}-{'f1_val': 0.14226190476190476, 'auprc': 0.703926263132534, 'loss_val': 1.2624371755863, 'psi': 0.3669276481101565}
[S6] START round=2 head_norm_before_train=0.878276 cos_to_last_merge=1.0000 (last merge round=1)
[S6] round=2 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8336009830313296, 'loss_val': 1.3169943867331557, 'psi': 0.41829616244330103}-{'f1_val': 0.14142628205128205, 'auprc': 0.8440737514927482, 'loss_val': 1.3128302330270145, 'psi': 0.4224852698278685}
[S7] START round=2 head_norm_before_train=0.844980 cos_to_last_merge=1.0000 (last merge round=1)
[S7] round=2 local utility u=0.010862 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7774971154776809, 'loss_val': 1.2581043933355611, 'psi': 0.39623293982852736}-{'f1_val': 0.14205682272909165, 'auprc': 0.7752100688994215, 'loss_val': 1.2729673323677393, 'psi': 0.3953181211972236}
[S8] START round=2 head_norm_before_train=1.165822 (no previous merge yet)
[S8] round=2 local utility u=0.014657 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7709799245862079, 'loss_val': 1.2982123737142284, 'psi': 0.3923655592702575}-{'f1_val': 0.13995598239295717, 'auprc': 0.770945326932231, 'loss_val': 1.3274216157870764, 'psi': 0.3923517202086667}
[S9] START round=2 head_norm_before_train=1.182627 (no previous merge yet)
[S9] round=2 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.6709671626025332, 'loss_val': 1.1949249815066618, 'psi': 0.3532256393250109}-{'f1_val': 0.141397957139996, 'auprc': 0.9876462256410217, 'loss_val': 1.272932591856526, 'psi': 0.4798972645404063}
[S10] START round=2 head_norm_before_train=0.830684 cos_to_last_merge=1.0000 (last merge round=1)
[S10] round=2 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.5808729084616323, 'loss_val': 1.332138452846088, 'psi': 0.3155221459096873}-{'f1_val': 0.13862163754172394, 'auprc': 0.5820614370569814, 'loss_val': 1.328949596937783, 'psi': 0.315997557347827}
[S11] START round=2 head_norm_before_train=0.846257 cos_to_last_merge=1.0000 (last merge round=1)
[S11] round=2 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7450938960353635, 'loss_val': 1.3109038784526688, 'psi': 0.38228576843801176}-{'f1_val': 0.34345890745386604, 'auprc': 0.5935757980111936, 'loss_val': 1.3316116576302972, 'psi': 0.4435056636767971}
[S13] START round=2 head_norm_before_train=1.138899 (no previous merge yet)
[S13] round=2 local utility u=0.086160 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.6660498952137326, 'loss_val': 1.2653886866274633, 'psi': 0.3506514156317249}-{'f1_val': 0.1403857625770531, 'auprc': 0.6210420457824264, 'loss_val': 1.3026857726128593, 'psi': 0.3326482758592024}
[S14] START round=2 head_norm_before_train=1.187897 (no previous merge yet)
[S14] round=2 local utility u=0.183596 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.9705237780180135, 'loss_val': 1.2841037770039343, 'psi': 0.4724242229368277}-{'f1_val': 0.14035785288270378, 'auprc': 0.8564973507076619, 'loss_val': 1.3092170636841933, 'psi': 0.426813652012687}
[S15] START round=2 head_norm_before_train=1.143661 (no previous merge yet)
[S15] round=2 local utility u=0.019162 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7757962288577965, 'loss_val': 1.2985755415517644, 'psi': 0.39415868236005364}-{'f1_val': 0.13973365136155833, 'auprc': 0.7740070249251779, 'loss_val': 1.3315327468729163, 'psi': 0.39344300078700617}
[S16] START round=2 head_norm_before_train=0.845684 cos_to_last_merge=1.0000 (last merge round=1)
[S16] round=2 local utility u=0.245567 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.6758643782845071, 'loss_val': 1.318025326935183, 'psi': 0.3547282214333247}-{'f1_val': 0.14063745019920318, 'auprc': 0.5162591986242013, 'loss_val': 1.3303430954130577, 'psi': 0.29088614956920245}
[S17] START round=2 head_norm_before_train=1.205836 (no previous merge yet)
[S17] round=2 local utility u=0.126979 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.8372397534000011, 'loss_val': 1.2937151913851683, 'psi': 0.4194652793504311}-{'f1_val': 0.14094896331738438, 'auprc': 0.7654885760683745, 'loss_val': 1.3324200094594243, 'psi': 0.39076480841778044}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.355)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.390)
[S14] not sending this round → trigger blocked (psi=0.472)
[S5] not sending this round → trigger blocked (psi=0.393)
[S7] not sending this round → trigger blocked (psi=0.396)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S13] → sending delta(kind=head bytes=1787) to S2@127.0.0.1:41902
[S8] not sending this round → trigger blocked (psi=0.392)
[S15] not sending this round → trigger blocked (psi=0.394)
[S4] not sending this round → trigger blocked (psi=0.402)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1787 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1787) from S13
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.162561)
[S2] loaded HEAD from S13 (vec_in norm=1.162561)
[S2] cosine check vs S13: cos=0.1017
[S2] BUFFERED delta from S13 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S17] → sending delta(kind=head bytes=1790) to S9@127.0.0.1:41910
[S17] sending update (kind=head size=1790 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1790) from S17
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.233023)
[S9] loaded HEAD from S17 (vec_in norm=1.233023)
[S9] cosine check vs S17: cos=-0.0894
[S9] DROPPED delta from S17 (cos=-0.0894 < 0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=2 metric=0.1418 head_norm=0.862538
[S2] _apply_head_vector_avg (torch): Δ‖w‖=6.876562e-01
[S2] stored merged vector for next round verification (round=2)
[S2] DEBUG after merge:  round=2 metric=0.5661 head_norm=0.758214 delta_norm=0.687656
[S2] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=3 head_norm_before_train=0.758214 cos_to_last_merge=1.0000 (last merge round=2)
[S2] round=3 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6884061460946316, 'loss_val': 1.310460313530489, 'psi': 0.36042873847099266}-{'f1_val': 0.1417771333885667, 'auprc': 0.7617494709384609, 'loss_val': 1.3279165449143495, 'psi': 0.3897660684085244}
[S3] START round=3 head_norm_before_train=1.258463 (no previous merge yet)
[S3] round=3 local utility u=0.957148 metrics={'f1_val': 0.3689207081957827, 'auprc': 0.7952431840132596, 'loss_val': 1.0293716193898483, 'psi': 0.5394496985227735}-{'f1_val': 0.13984006561410703, 'auprc': 0.6735240592297956, 'loss_val': 1.204025540617531, 'psi': 0.3533136630603825}
[S4] START round=3 head_norm_before_train=1.169415 (no previous merge yet)
[S4] round=3 local utility u=0.009240 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7834607511363401, 'loss_val': 1.2112544994776764, 'psi': 0.3975202777916465}-{'f1_val': 0.14022662889518414, 'auprc': 0.7956453782794808, 'loss_val': 1.2662878992688595, 'psi': 0.40239412864890284}
[S5] START round=3 head_norm_before_train=1.310826 (no previous merge yet)
[S5] round=3 local utility u=0.926006 metrics={'f1_val': 0.41795135763108626, 'auprc': 0.7775725112991944, 'loss_val': 1.003150328067579, 'psi': 0.5617998190983295}-{'f1_val': 0.14226190476190476, 'auprc': 0.7701166650777269, 'loss_val': 1.1786582693316014, 'psi': 0.3934038088882336}
[S6] START round=3 head_norm_before_train=0.894744 cos_to_last_merge=0.9975 (last merge round=1)
[S6] round=3 local utility u=0.016360 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.834478007050378, 'loss_val': 1.2869046218222762, 'psi': 0.41864697205092044}-{'f1_val': 0.14142628205128205, 'auprc': 0.8336009830313296, 'loss_val': 1.3169943867331557, 'psi': 0.41829616244330103}
[S7] START round=3 head_norm_before_train=0.886679 cos_to_last_merge=0.9947 (last merge round=1)
[S7] round=3 local utility u=0.019840 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7778394188902102, 'loss_val': 1.219451758734322, 'psi': 0.3963698611935391}-{'f1_val': 0.14205682272909165, 'auprc': 0.7774971154776809, 'loss_val': 1.2581043933355611, 'psi': 0.39623293982852736}
[S8] START round=3 head_norm_before_train=1.183374 (no previous merge yet)
[S8] round=3 local utility u=0.019347 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7709866145254299, 'loss_val': 1.2595382535852402, 'psi': 0.39236823524594633}-{'f1_val': 0.13995598239295717, 'auprc': 0.7709799245862079, 'loss_val': 1.2982123737142284, 'psi': 0.3923655592702575}
[S9] START round=3 head_norm_before_train=1.239014 (no previous merge yet)
[S9] round=3 local utility u=0.934445 metrics={'f1_val': 0.41556143742054374, 'auprc': 0.6878570179797832, 'loss_val': 1.0216862602842611, 'psi': 0.5244796696442395}-{'f1_val': 0.141397957139996, 'auprc': 0.6709671626025332, 'loss_val': 1.1949249815066618, 'psi': 0.3532256393250109}
[S10] START round=3 head_norm_before_train=0.844271 cos_to_last_merge=0.9971 (last merge round=1)
[S10] round=3 local utility u=0.039072 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.5965167326390438, 'loss_val': 1.3009249699037337, 'psi': 0.3217796755806519}-{'f1_val': 0.13862163754172394, 'auprc': 0.5808729084616323, 'loss_val': 1.332138452846088, 'psi': 0.3155221459096873}
[S11] START round=3 head_norm_before_train=0.871768 cos_to_last_merge=0.9968 (last merge round=1)
[S11] round=3 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.5996904084962229, 'loss_val': 1.258295537725989, 'psi': 0.3241243734223555}-{'f1_val': 0.14041368337311058, 'auprc': 0.7450938960353635, 'loss_val': 1.3109038784526688, 'psi': 0.38228576843801176}
[S13] START round=3 head_norm_before_train=1.162561 (no previous merge yet)
[S13] round=3 local utility u=0.083132 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7071439333306256, 'loss_val': 1.2224062493170682, 'psi': 0.3670890308784821}-{'f1_val': 0.1403857625770531, 'auprc': 0.6660498952137326, 'loss_val': 1.2653886866274633, 'psi': 0.3506514156317249}
[S14] START round=3 head_norm_before_train=1.212619 (no previous merge yet)
[S14] round=3 local utility u=0.055543 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.9976969005889266, 'loss_val': 1.2545377657997023, 'psi': 0.4832934719651929}-{'f1_val': 0.14035785288270378, 'auprc': 0.9705237780180135, 'loss_val': 1.2841037770039343, 'psi': 0.4724242229368277}
[S15] START round=3 head_norm_before_train=1.165164 (no previous merge yet)
[S15] round=3 local utility u=0.019309 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7763093479735294, 'loss_val': 1.2614965009209158, 'psi': 0.3943639300063468}-{'f1_val': 0.13973365136155833, 'auprc': 0.7757962288577965, 'loss_val': 1.2985755415517644, 'psi': 0.39415868236005364}
[S16] START round=3 head_norm_before_train=0.862311 cos_to_last_merge=0.9971 (last merge round=1)
[S16] round=3 local utility u=0.004101 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.6678394910754691, 'loss_val': 1.2857496341608745, 'psi': 0.3515182665497095}-{'f1_val': 0.14063745019920318, 'auprc': 0.6758643782845071, 'loss_val': 1.318025326935183, 'psi': 0.3547282214333247}
[S17] START round=3 head_norm_before_train=1.233023 (no previous merge yet)
[S17] round=3 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.7348350874016715, 'loss_val': 1.2425816979360174, 'psi': 0.37850341295109924}-{'f1_val': 0.14094896331738438, 'auprc': 0.8372397534000011, 'loss_val': 1.2937151913851683, 'psi': 0.4194652793504311}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:41916
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:41917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:41904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:41909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S5] → sending delta(kind=head bytes=1791) to S16@127.0.0.1:41916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S14] → sending delta(kind=head bytes=1792) to S11@127.0.0.1:41912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] → sending delta(kind=head bytes=1792) to S13@127.0.0.1:41913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:41903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:41915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:41917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:41914
[S13] not sending this round → trigger blocked (psi=0.367)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1792 to 1 peers)
[S14] sending update (kind=head size=1792 to 1 peers)
[S5] sending update (kind=head size=1791 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1795) from S7
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.925593)
[S4] loaded HEAD from S7 (vec_in norm=0.925593)
[S4] cosine check vs S7: cos=-0.1256
[S4] DROPPED delta from S7 (cos=-0.1256 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1792) from S14
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.242707)
[S11] loaded HEAD from S14 (vec_in norm=1.242707)
[S11] cosine check vs S14: cos=0.0515
[S11] BUFFERED delta from S14 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1799) from S10
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=0.866376)
[S8] loaded HEAD from S10 (vec_in norm=0.866376)
[S8] cosine check vs S10: cos=0.0226
[S8] BUFFERED delta from S10 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1801) from S16
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.890407)
[S15] loaded HEAD from S16 (vec_in norm=0.890407)
[S15] cosine check vs S16: cos=0.0443
[S15] BUFFERED delta from S16 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1798) from S3
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.312170)
[S17] loaded HEAD from S3 (vec_in norm=1.312170)
[S17] cosine check vs S3: cos=-0.0754
[S17] DROPPED delta from S3 (cos=-0.0754 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1791) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.366345)
[S16] loaded HEAD from S5 (vec_in norm=1.366345)
[S16] cosine check vs S5: cos=-0.0388
[S16] DROPPED delta from S5 (cos=-0.0388 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1799) from S6
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.921334)
[S17] loaded HEAD from S6 (vec_in norm=0.921334)
[S17] cosine check vs S6: cos=-0.0377
[S17] DROPPED delta from S6 (cos=-0.0377 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1798) from S9
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.297441)
[S16] loaded HEAD from S9 (vec_in norm=1.297441)
[S16] cosine check vs S9: cos=0.7043
[S16] BUFFERED delta from S9 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1792) from S15
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.193153)
[S13] loaded HEAD from S15 (vec_in norm=1.193153)
[S13] cosine check vs S15: cos=-0.0607
[S13] DROPPED delta from S15 (cos=-0.0607 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1799) from S4
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.202300)
[S14] loaded HEAD from S4 (vec_in norm=1.202300)
[S14] cosine check vs S4: cos=-0.0760
[S14] DROPPED delta from S4 (cos=-0.0760 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1796) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.210920)
[S3] loaded HEAD from S8 (vec_in norm=1.210920)
[S3] cosine check vs S8: cos=0.0628
[S3] BUFFERED delta from S8 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=3 metric=0.1404 head_norm=0.907854
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.503688e-01
[S11] stored merged vector for next round verification (round=3)
[S11] DEBUG after merge:  round=3 metric=0.1404 head_norm=0.788166 delta_norm=0.750369
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=3 metric=0.3689 head_norm=1.312170
[S3] _apply_head_vector_avg (torch): Δ‖w‖=8.643752e-01
[S3] stored merged vector for next round verification (round=3)
[S3] DEBUG after merge:  round=3 metric=0.1398 head_norm=0.920279 delta_norm=0.864375
[S3] aggregate: ROLLBACK (f1_val pre=0.369 post=0.140 tol_abs=0.005 tol_rel=0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=3 metric=0.1400 head_norm=1.210920
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.364803e-01
[S8] stored merged vector for next round verification (round=3)
[S8] DEBUG after merge:  round=3 metric=0.1400 head_norm=0.752372 delta_norm=0.736480
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=3 metric=0.1397 head_norm=1.193153
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.283925e-01
[S15] stored merged vector for next round verification (round=3)
[S15] DEBUG after merge:  round=3 metric=0.1397 head_norm=0.760042 delta_norm=0.728393
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=3 metric=0.1406 head_norm=0.890407
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.607061e-01
[S16] stored merged vector for next round verification (round=3)
[S16] DEBUG after merge:  round=3 metric=0.1406 head_norm=1.012837 delta_norm=0.460706
[S16] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=0.773736 cos_to_last_merge=0.9952 (last merge round=2)
[S2] round=4 local utility u=0.128697 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7559923223351692, 'loss_val': 1.2558251641635947, 'psi': 0.38746320896720776}-{'f1_val': 0.1417771333885667, 'auprc': 0.6884061460946316, 'loss_val': 1.310460313530489, 'psi': 0.36042873847099266}
[S3] START round=4 head_norm_before_train=0.920279 cos_to_last_merge=1.0000 (last merge round=3)
[S3] round=4 local utility u=1.000000 metrics={'f1_val': 0.6975277859387625, 'auprc': 0.7961204172751887, 'loss_val': 0.8724071047561204, 'psi': 0.7369648384733329}-{'f1_val': 0.3689207081957827, 'auprc': 0.7952431840132596, 'loss_val': 1.0293716193898483, 'psi': 0.5394496985227735}
[S4] START round=4 head_norm_before_train=1.202300 (no previous merge yet)
[S4] round=4 local utility u=0.871167 metrics={'f1_val': 0.4137842011147427, 'auprc': 0.7858021653401959, 'loss_val': 1.1172895525249884, 'psi': 0.5625913868049239}-{'f1_val': 0.14022662889518414, 'auprc': 0.7834607511363401, 'loss_val': 1.2112544994776764, 'psi': 0.3975202777916465}
[S5] START round=4 head_norm_before_train=1.366345 (no previous merge yet)
[S5] round=4 local utility u=0.804033 metrics={'f1_val': 0.6362832949129886, 'auprc': 0.7945755542089658, 'loss_val': 0.756085975717106, 'psi': 0.6996001986313796}-{'f1_val': 0.41795135763108626, 'auprc': 0.7775725112991944, 'loss_val': 1.003150328067579, 'psi': 0.5617998190983295}
[S6] START round=4 head_norm_before_train=0.921334 cos_to_last_merge=0.9909 (last merge round=1)
[S6] round=4 local utility u=0.010871 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8326688737061763, 'loss_val': 1.2597349089696968, 'psi': 0.41792331871323973}-{'f1_val': 0.14142628205128205, 'auprc': 0.834478007050378, 'loss_val': 1.2869046218222762, 'psi': 0.41864697205092044}
[S7] START round=4 head_norm_before_train=0.925593 cos_to_last_merge=0.9854 (last merge round=1)
[S7] round=4 local utility u=1.000000 metrics={'f1_val': 0.6828282340643391, 'auprc': 0.6183924867481857, 'loss_val': 1.2040033774969412, 'psi': 0.6570539351378777}-{'f1_val': 0.14205682272909165, 'auprc': 0.7778394188902102, 'loss_val': 1.219451758734322, 'psi': 0.3963698611935391}
[S8] START round=4 head_norm_before_train=0.752372 cos_to_last_merge=1.0000 (last merge round=3)
[S8] round=4 local utility u=0.000000 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7762604300508561, 'loss_val': 1.2790799532134485, 'psi': 0.3944777614561168}-{'f1_val': 0.13995598239295717, 'auprc': 0.7709866145254299, 'loss_val': 1.2595382535852402, 'psi': 0.39236823524594633}
[S9] START round=4 head_norm_before_train=1.297441 (no previous merge yet)
[S9] round=4 local utility u=0.602323 metrics={'f1_val': 0.4362634907065445, 'auprc': 0.9452717844578696, 'loss_val': 0.7134971604076961, 'psi': 0.6398668082070746}-{'f1_val': 0.41556143742054374, 'auprc': 0.6878570179797832, 'loss_val': 1.0216862602842611, 'psi': 0.5244796696442395}
[S10] START round=4 head_norm_before_train=0.866376 cos_to_last_merge=0.9890 (last merge round=1)
[S10] round=4 local utility u=0.093508 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6434715116824858, 'loss_val': 1.2547736150294087, 'psi': 0.3405615871980287}-{'f1_val': 0.13862163754172394, 'auprc': 0.5965167326390438, 'loss_val': 1.3009249699037337, 'psi': 0.3217796755806519}
[S11] START round=4 head_norm_before_train=0.788166 cos_to_last_merge=1.0000 (last merge round=3)
[S11] round=4 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.5951831544179625, 'loss_val': 1.2497258057397105, 'psi': 0.32232147179105136}-{'f1_val': 0.14041368337311058, 'auprc': 0.5996904084962229, 'loss_val': 1.258295537725989, 'psi': 0.3241243734223555}
[S13] START round=4 head_norm_before_train=1.191725 (no previous merge yet)
[S13] round=4 local utility u=0.038418 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7151649051391857, 'loss_val': 1.1696334143770688, 'psi': 0.37029741960190615}-{'f1_val': 0.1403857625770531, 'auprc': 0.7071439333306256, 'loss_val': 1.2224062493170682, 'psi': 0.3670890308784821}
[S14] START round=4 head_norm_before_train=1.242707 (no previous merge yet)
[S14] round=4 local utility u=0.023716 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.9979356063747196, 'loss_val': 1.2078227247387872, 'psi': 0.4833889542795101}-{'f1_val': 0.14035785288270378, 'auprc': 0.9976969005889266, 'loss_val': 1.2545377657997023, 'psi': 0.4832934719651929}
[S15] START round=4 head_norm_before_train=0.760042 cos_to_last_merge=1.0000 (last merge round=3)
[S15] round=4 local utility u=0.000000 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7765468815322001, 'loss_val': 1.2676862462078575, 'psi': 0.3944589434298151}-{'f1_val': 0.13973365136155833, 'auprc': 0.7763093479735294, 'loss_val': 1.2614965009209158, 'psi': 0.3943639300063468}
[S16] START round=4 head_norm_before_train=1.012837 cos_to_last_merge=1.0000 (last merge round=3)
[S16] round=4 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.5833552974187655, 'loss_val': 1.2520314089573132, 'psi': 0.3177245890870281}-{'f1_val': 0.14063745019920318, 'auprc': 0.6678394910754691, 'loss_val': 1.2857496341608745, 'psi': 0.3515182665497095}
[S17] START round=4 head_norm_before_train=1.265177 (no previous merge yet)
[S17] round=4 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.6005627695410315, 'loss_val': 1.1833445659469912, 'psi': 0.3247944858068432}-{'f1_val': 0.14094896331738438, 'auprc': 0.7348350874016715, 'loss_val': 1.2425816979360174, 'psi': 0.37850341295109924}
[S4] not sending this round → trigger blocked (psi=0.563)
[S7] not sending this round → trigger blocked (psi=0.657)
[S6] not sending this round → trigger blocked (psi=0.418)
[S10] not sending this round → trigger blocked (psi=0.341)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.483)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S13] → sending delta(kind=head bytes=1791) to S2@127.0.0.1:41902
[S9] not sending this round → trigger blocked (psi=0.640)
[S5] not sending this round → trigger blocked (psi=0.700)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.737)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] → sending delta(kind=head bytes=1794) to S17@127.0.0.1:41917
[S13] sending update (kind=head size=1791 to 1 peers)
[S2] sending update (kind=head size=1794 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1791) from S13
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.217160)
[S2] loaded HEAD from S13 (vec_in norm=1.217160)
[S2] cosine check vs S13: cos=0.7788
[S2] BUFFERED delta from S13 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1794) from S2
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=0.794976)
[S17] loaded HEAD from S2 (vec_in norm=0.794976)
[S17] cosine check vs S2: cos=-0.0691
[S17] DROPPED delta from S2 (cos=-0.0691 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=4 metric=0.1418 head_norm=0.794976
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.893265e-01
[S2] stored merged vector for next round verification (round=4)
[S2] DEBUG after merge:  round=4 metric=0.1418 head_norm=0.951398 delta_norm=0.389327
[S2] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=5 head_norm_before_train=0.951398 cos_to_last_merge=1.0000 (last merge round=4)
[S2] round=5 local utility u=0.009504 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7558691312145996, 'loss_val': 1.2364484208605404, 'psi': 0.38741393251897993}-{'f1_val': 0.1417771333885667, 'auprc': 0.7559923223351692, 'loss_val': 1.2558251641635947, 'psi': 0.38746320896720776}
[S3] START round=5 head_norm_before_train=0.987556 cos_to_last_merge=0.9912 (last merge round=3)
[S3] round=5 local utility u=0.029261 metrics={'f1_val': 0.5739805262665885, 'auprc': 0.9966982077509724, 'loss_val': 0.6743350306463791, 'psi': 0.743067598860342}-{'f1_val': 0.6975277859387625, 'auprc': 0.7961204172751887, 'loss_val': 0.8724071047561204, 'psi': 0.7369648384733329}
[S4] START round=5 head_norm_before_train=1.243218 (no previous merge yet)
[S4] round=5 local utility u=0.086928 metrics={'f1_val': 0.4152113312575093, 'auprc': 0.7863482083540967, 'loss_val': 0.9536350319089082, 'psi': 0.5636660820961443}-{'f1_val': 0.4137842011147427, 'auprc': 0.7858021653401959, 'loss_val': 1.1172895525249884, 'psi': 0.5625913868049239}
[S5] START round=5 head_norm_before_train=1.427782 (no previous merge yet)
[S5] round=5 local utility u=0.036335 metrics={'f1_val': 0.6501201090173904, 'auprc': 0.7282630467727086, 'loss_val': 0.5674990821415209, 'psi': 0.6813772841195176}-{'f1_val': 0.6362832949129886, 'auprc': 0.7945755542089658, 'loss_val': 0.756085975717106, 'psi': 0.6996001986313796}
[S6] START round=5 head_norm_before_train=0.952858 cos_to_last_merge=0.9813 (last merge round=1)
[S6] round=5 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.821912495906908, 'loss_val': 1.2288917885517696, 'psi': 0.4136207675935324}-{'f1_val': 0.14142628205128205, 'auprc': 0.8326688737061763, 'loss_val': 1.2597349089696968, 'psi': 0.41792331871323973}
[S7] START round=5 head_norm_before_train=0.935694 cos_to_last_merge=0.9788 (last merge round=1)
[S7] round=5 local utility u=0.000000 metrics={'f1_val': 0.4170778520170104, 'auprc': 0.7563265781984171, 'loss_val': 1.0225665326084454, 'psi': 0.5527773424895731}-{'f1_val': 0.6828282340643391, 'auprc': 0.6183924867481857, 'loss_val': 1.2040033774969412, 'psi': 0.6570539351378777}
[S8] START round=5 head_norm_before_train=0.777089 cos_to_last_merge=0.9971 (last merge round=3)
[S8] round=5 local utility u=0.017235 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7684693871384538, 'loss_val': 1.2212369158005245, 'psi': 0.3913613442911559}-{'f1_val': 0.13995598239295717, 'auprc': 0.7762604300508561, 'loss_val': 1.2790799532134485, 'psi': 0.3944777614561168}
[S9] START round=5 head_norm_before_train=1.371802 (no previous merge yet)
[S9] round=5 local utility u=0.855701 metrics={'f1_val': 0.6591670046222114, 'auprc': 0.9843809286502487, 'loss_val': 0.4568427580700305, 'psi': 0.7892525742334264}-{'f1_val': 0.4362634907065445, 'auprc': 0.9452717844578696, 'loss_val': 0.7134971604076961, 'psi': 0.6398668082070746}
[S10] START round=5 head_norm_before_train=0.892844 cos_to_last_merge=0.9764 (last merge round=1)
[S10] round=5 local utility u=0.041482 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6540620336712065, 'loss_val': 1.203582008471655, 'psi': 0.34479779599351695}-{'f1_val': 0.13862163754172394, 'auprc': 0.6434715116824858, 'loss_val': 1.2547736150294087, 'psi': 0.3405615871980287}
[S11] START round=5 head_norm_before_train=0.817583 cos_to_last_merge=0.9960 (last merge round=3)
[S11] round=5 local utility u=0.037540 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.5965639617094354, 'loss_val': 1.178788458481953, 'psi': 0.3228737947076405}-{'f1_val': 0.14041368337311058, 'auprc': 0.5951831544179625, 'loss_val': 1.2497258057397105, 'psi': 0.32232147179105136}
[S13] START round=5 head_norm_before_train=1.217160 (no previous merge yet)
[S13] round=5 local utility u=0.829519 metrics={'f1_val': 0.41607788054795825, 'auprc': 0.689020468390001, 'loss_val': 1.086314066430726, 'psi': 0.5252549156847753}-{'f1_val': 0.1403857625770531, 'auprc': 0.7151649051391857, 'loss_val': 1.1696334143770688, 'psi': 0.37029741960190615}
[S14] START round=5 head_norm_before_train=1.278829 (no previous merge yet)
[S14] round=5 local utility u=0.046149 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.9984490508342793, 'loss_val': 1.1170652858456207, 'psi': 0.48359433206333396}-{'f1_val': 0.14035785288270378, 'auprc': 0.9979356063747196, 'loss_val': 1.2078227247387872, 'psi': 0.4833889542795101}
[S15] START round=5 head_norm_before_train=0.790945 cos_to_last_merge=0.9967 (last merge round=3)
[S15] round=5 local utility u=0.024072 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7769519527548194, 'loss_val': 1.220757639815064, 'psi': 0.3946209719188628}-{'f1_val': 0.13973365136155833, 'auprc': 0.7765468815322001, 'loss_val': 1.2676862462078575, 'psi': 0.3944589434298151}
[S16] START round=5 head_norm_before_train=1.040037 cos_to_last_merge=0.9981 (last merge round=3)
[S16] round=5 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.4655327492612108, 'loss_val': 1.1868185273941674, 'psi': 0.27059556982400623}-{'f1_val': 0.14063745019920318, 'auprc': 0.5833552974187655, 'loss_val': 1.2520314089573132, 'psi': 0.3177245890870281}
[S17] START round=5 head_norm_before_train=1.303791 (no previous merge yet)
[S17] round=5 local utility u=0.865941 metrics={'f1_val': 0.3906640963097018, 'auprc': 0.6379592529085641, 'loss_val': 1.061943294489761, 'psi': 0.4895821589492467}-{'f1_val': 0.14094896331738438, 'auprc': 0.6005627695410315, 'loss_val': 1.1833445659469912, 'psi': 0.3247944858068432}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:41916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] → sending delta(kind=head bytes=1794) to S17@127.0.0.1:41917
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:41914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:41909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:41916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S15] → sending delta(kind=head bytes=1790) to S13@127.0.0.1:41913
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:41916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:41903
[S13] not sending this round → trigger blocked (psi=0.525)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:41912
[S2] not sending this round → trigger blocked (psi=0.387)
[S11] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1790 to 1 peers)
[S10] sending update (kind=head size=1794 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1794 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1797) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=0.811258)
[S3] loaded HEAD from S8 (vec_in norm=0.811258)
[S3] cosine check vs S8: cos=0.4693
[S3] BUFFERED delta from S8 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1794) from S3
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.083260)
[S17] loaded HEAD from S3 (vec_in norm=1.083260)
[S17] cosine check vs S3: cos=-0.1612
[S17] DROPPED delta from S3 (cos=-0.1612 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1801) from S9
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.466126)
[S16] loaded HEAD from S9 (vec_in norm=1.466126)
[S16] cosine check vs S9: cos=0.9184
[S16] BUFFERED delta from S9 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1795) from S11
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=0.851801)
[S16] loaded HEAD from S11 (vec_in norm=0.851801)
[S16] cosine check vs S11: cos=0.0942
[S16] BUFFERED delta from S11 (total buffered=2)
[S8] RECEIVED delta(kind=head bytes=1794) from S10
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=0.920614)
[S8] loaded HEAD from S10 (vec_in norm=0.920614)
[S8] cosine check vs S10: cos=0.5324
[S8] BUFFERED delta from S10 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1802) from S4
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.293164)
[S14] loaded HEAD from S4 (vec_in norm=1.293164)
[S14] cosine check vs S4: cos=-0.0787
[S14] DROPPED delta from S4 (cos=-0.0787 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1790) from S15
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.833683)
[S13] loaded HEAD from S15 (vec_in norm=0.833683)
[S13] cosine check vs S15: cos=-0.0551
[S13] DROPPED delta from S15 (cos=-0.0551 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1796) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.487171)
[S16] loaded HEAD from S5 (vec_in norm=1.487171)
[S16] cosine check vs S5: cos=-0.0472
[S16] DROPPED delta from S5 (cos=-0.0472 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1798) from S14
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.323778)
[S11] loaded HEAD from S14 (vec_in norm=1.323778)
[S11] cosine check vs S14: cos=0.7658
[S11] BUFFERED delta from S14 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:41914
[S17] sending update (kind=head size=1801 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1801) from S17
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.333409)
[S14] loaded HEAD from S17 (vec_in norm=1.333409)
[S14] cosine check vs S17: cos=0.1010
[S14] BUFFERED delta from S17 (total buffered=1)
[S6] ⇄ pheromone p=0.332 → S17@127.0.0.1:41917
[S2] ⇄ pheromone p=0.400 → S17@127.0.0.1:41917
[S7] ⇄ pheromone p=0.494 → S4@127.0.0.1:41904
[S13] ⇄ pheromone p=0.519 → S2@127.0.0.1:41902
[S15] ⇄ pheromone p=0.367 → S13@127.0.0.1:41913
[S4] ⇄ pheromone p=0.489 → S14@127.0.0.1:41914
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=5 metric=0.1404 head_norm=0.851801
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.333026e-01
[S11] stored merged vector for next round verification (round=5)
[S11] DEBUG after merge:  round=5 metric=0.1404 head_norm=1.025293 delta_norm=0.433303
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.399 → S16@127.0.0.1:41916
[S5] ⇄ pheromone p=0.620 → S16@127.0.0.1:41916
[S9] ⇄ pheromone p=0.728 → S16@127.0.0.1:41916
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=5 metric=0.1400 head_norm=0.811258
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.214123e-01
[S8] stored merged vector for next round verification (round=5)
[S8] DEBUG after merge:  round=5 metric=0.1400 head_norm=0.758450 delta_norm=0.421412
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.357 → S3@127.0.0.1:41903
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=5 metric=0.5740 head_norm=1.083260
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.017000e-01
[S3] stored merged vector for next round verification (round=5)
[S3] DEBUG after merge:  round=5 metric=0.5350 head_norm=0.814919 delta_norm=0.501700
[S3] aggregate: ROLLBACK (f1_val pre=0.574 post=0.535 tol_abs=0.005 tol_rel=0.0)
[S3] ⇄ pheromone p=0.629 → S17@127.0.0.1:41917
[S10] ⇄ pheromone p=0.356 → S8@127.0.0.1:41909
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=5 metric=0.1404 head_norm=1.323778
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.907446e-01
[S14] stored merged vector for next round verification (round=5)
[S14] DEBUG after merge:  round=5 metric=0.2346 head_norm=0.985778 delta_norm=0.890745
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.383 → S11@127.0.0.1:41912
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=5 metric=0.1406 head_norm=1.076738
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.082518e-01
[S16] stored merged vector for next round verification (round=5)
[S16] DEBUG after merge:  round=5 metric=0.1406 head_norm=0.929045 delta_norm=0.308252
[S16] aggregate: ACCEPT kept=['S9', 'S11'] (k=2/2) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.397 → S15@127.0.0.1:41915
[S17] ⇄ pheromone p=0.514 → S14@127.0.0.1:41914
[S2] START round=6 head_norm_before_train=0.967437 cos_to_last_merge=0.9977 (last merge round=4)
[S2] round=6 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7140044726412209, 'loss_val': 1.1892620424232248, 'psi': 0.3706680690896284}-{'f1_val': 0.1417771333885667, 'auprc': 0.7558691312145996, 'loss_val': 1.2364484208605404, 'psi': 0.38741393251897993}
[S3] START round=6 head_norm_before_train=0.814919 cos_to_last_merge=1.0000 (last merge round=5)
[S3] round=6 local utility u=0.373436 metrics={'f1_val': 0.6932594429814481, 'auprc': 0.9971231204798933, 'loss_val': 0.6444105832811351, 'psi': 0.8148049139808262}-{'f1_val': 0.5739805262665885, 'auprc': 0.9966982077509724, 'loss_val': 0.6743350306463791, 'psi': 0.743067598860342}
[S4] START round=6 head_norm_before_train=1.293164 (no previous merge yet)
[S4] round=6 local utility u=0.037949 metrics={'f1_val': 0.4141138273491215, 'auprc': 0.7531876309252444, 'loss_val': 0.7716702763947421, 'psi': 0.5497433487795707}-{'f1_val': 0.4152113312575093, 'auprc': 0.7863482083540967, 'loss_val': 0.9536350319089082, 'psi': 0.5636660820961443}
[S5] START round=6 head_norm_before_train=1.487171 (no previous merge yet)
[S5] round=6 local utility u=0.364978 metrics={'f1_val': 0.7005691551769304, 'auprc': 0.8203505625628935, 'loss_val': 0.41650011046385294, 'psi': 0.7484817181313157}-{'f1_val': 0.6501201090173904, 'auprc': 0.7282630467727086, 'loss_val': 0.5674990821415209, 'psi': 0.6813772841195176}
[S6] START round=6 head_norm_before_train=0.983828 cos_to_last_merge=0.9717 (last merge round=1)
[S6] round=6 local utility u=0.047188 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.829897033222159, 'loss_val': 1.1584701797820152, 'psi': 0.4168145825196328}-{'f1_val': 0.14142628205128205, 'auprc': 0.821912495906908, 'loss_val': 1.2288917885517696, 'psi': 0.4136207675935324}
[S7] START round=6 head_norm_before_train=0.978403 cos_to_last_merge=0.9655 (last merge round=1)
[S7] round=6 local utility u=0.132678 metrics={'f1_val': 0.41703542715461484, 'auprc': 0.7894983606134152, 'loss_val': 0.8564704833527462, 'psi': 0.566020600538135}-{'f1_val': 0.4170778520170104, 'auprc': 0.7563265781984171, 'loss_val': 1.0225665326084454, 'psi': 0.5527773424895731}
[S8] START round=6 head_norm_before_train=0.758450 cos_to_last_merge=1.0000 (last merge round=5)
[S8] round=6 local utility u=0.007207 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7661084898421529, 'loss_val': 1.199739613570039, 'psi': 0.39041698537263547}-{'f1_val': 0.13995598239295717, 'auprc': 0.7684693871384538, 'loss_val': 1.2212369158005245, 'psi': 0.3913613442911559}
[S9] START round=6 head_norm_before_train=1.466126 (no previous merge yet)
[S9] round=6 local utility u=0.257048 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9989384678360047, 'loss_val': 0.23871627609203613, 'psi': 0.820305335598413}-{'f1_val': 0.6591670046222114, 'auprc': 0.9843809286502487, 'loss_val': 0.4568427580700305, 'psi': 0.7892525742334264}
[S10] START round=6 head_norm_before_train=0.920614 cos_to_last_merge=0.9640 (last merge round=1)
[S10] round=6 local utility u=0.055692 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6633738994541187, 'loss_val': 1.1201340549156118, 'psi': 0.34852254230668184}-{'f1_val': 0.13862163754172394, 'auprc': 0.6540620336712065, 'loss_val': 1.203582008471655, 'psi': 0.34479779599351695}
[S11] START round=6 head_norm_before_train=1.025293 cos_to_last_merge=1.0000 (last merge round=5)
[S11] round=6 local utility u=0.898814 metrics={'f1_val': 0.42273739039721175, 'auprc': 0.6117956600746844, 'loss_val': 1.1207985497156787, 'psi': 0.49836069826820084}-{'f1_val': 0.14041368337311058, 'auprc': 0.5965639617094354, 'loss_val': 1.178788458481953, 'psi': 0.3228737947076405}
[S13] START round=6 head_norm_before_train=1.245378 (no previous merge yet)
[S13] round=6 local utility u=0.119749 metrics={'f1_val': 0.4160038662657951, 'auprc': 0.7292728894731704, 'loss_val': 0.9671291430115794, 'psi': 0.5413114755487451}-{'f1_val': 0.41607788054795825, 'auprc': 0.689020468390001, 'loss_val': 1.086314066430726, 'psi': 0.5252549156847753}
[S14] START round=6 head_norm_before_train=0.985778 cos_to_last_merge=1.0000 (last merge round=5)
[S14] round=6 local utility u=0.388817 metrics={'f1_val': 0.25876535622120145, 'auprc': 0.9982943876484536, 'loss_val': 1.0494120760146044, 'psi': 0.5545769687921023}-{'f1_val': 0.14035785288270378, 'auprc': 0.9984490508342793, 'loss_val': 1.1170652858456207, 'psi': 0.48359433206333396}
[S15] START round=6 head_norm_before_train=0.833683 cos_to_last_merge=0.9880 (last merge round=3)
[S15] round=6 local utility u=0.744376 metrics={'f1_val': 0.3626296555163404, 'auprc': 0.7964225376678779, 'loss_val': 1.1277931271934092, 'psi': 0.5361468083769554}-{'f1_val': 0.13973365136155833, 'auprc': 0.7769519527548194, 'loss_val': 1.220757639815064, 'psi': 0.3946209719188628}
[S16] START round=6 head_norm_before_train=0.929045 cos_to_last_merge=1.0000 (last merge round=5)
[S16] round=6 local utility u=0.837648 metrics={'f1_val': 0.41467924219943564, 'auprc': 0.4465278612219767, 'loss_val': 1.0987585774735065, 'psi': 0.42741868980845205}-{'f1_val': 0.14063745019920318, 'auprc': 0.4655327492612108, 'loss_val': 1.1868185273941674, 'psi': 0.27059556982400623}
[S17] START round=6 head_norm_before_train=1.333409 (no previous merge yet)
[S17] round=6 local utility u=0.149867 metrics={'f1_val': 0.39077941957993484, 'auprc': 0.7213531303735163, 'loss_val': 1.0130827041447685, 'psi': 0.5230089038973674}-{'f1_val': 0.3906640963097018, 'auprc': 0.6379592529085641, 'loss_val': 1.061943294489761, 'psi': 0.4895821589492467}
[S4] not sending this round → trigger blocked (psi=0.550)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] → sending delta(kind=head bytes=1794) to S2@127.0.0.1:41902
[S5] not sending this round → trigger blocked (psi=0.748)
[S14] not sending this round → trigger blocked (psi=0.555)
[S11] not sending this round → trigger blocked (psi=0.498)
[S15] not sending this round → trigger blocked (psi=0.536)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:41915
[S3] not sending this round → trigger blocked (psi=0.815)
[S10] not sending this round → trigger blocked (psi=0.349)
[S8] not sending this round → trigger blocked (psi=0.390)
[S9] not sending this round → trigger blocked (psi=0.820)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:41904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:41917
[S6] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1794 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1801) from S7
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.043283)
[S4] loaded HEAD from S7 (vec_in norm=1.043283)
[S4] cosine check vs S7: cos=-0.1511
[S4] DROPPED delta from S7 (cos=-0.1511 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1800) from S16
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.970414)
[S15] loaded HEAD from S16 (vec_in norm=0.970414)
[S15] cosine check vs S16: cos=0.4547
[S15] BUFFERED delta from S16 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1794) from S13
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.280744)
[S2] loaded HEAD from S13 (vec_in norm=1.280744)
[S2] cosine check vs S13: cos=0.9326
[S2] BUFFERED delta from S13 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1799) from S6
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.008647)
[S17] loaded HEAD from S6 (vec_in norm=1.008647)
[S17] cosine check vs S6: cos=-0.0298
[S17] DROPPED delta from S6 (cos=-0.0298 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.523)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=6 metric=0.1418 head_norm=0.989171
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.528182e-01
[S2] stored merged vector for next round verification (round=6)
[S2] DEBUG after merge:  round=6 metric=0.1418 head_norm=1.116004 delta_norm=0.252818
[S2] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=6 metric=0.3626 head_norm=0.873928
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.832607e-01
[S15] stored merged vector for next round verification (round=6)
[S15] DEBUG after merge:  round=6 metric=0.4160 head_norm=0.786884 delta_norm=0.483261
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=7 head_norm_before_train=1.116004 cos_to_last_merge=1.0000 (last merge round=6)
[S2] round=7 local utility u=0.119715 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7747550188727677, 'loss_val': 1.1320832179699827, 'psi': 0.3949682875822471}-{'f1_val': 0.1417771333885667, 'auprc': 0.7140044726412209, 'loss_val': 1.1892620424232248, 'psi': 0.3706680690896284}
[S3] START round=7 head_norm_before_train=0.910895 cos_to_last_merge=0.9849 (last merge round=5)
[S3] round=7 local utility u=0.126083 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9970316830624575, 'loss_val': 0.43695005331179115, 'psi': 0.8192663954661628}-{'f1_val': 0.6932594429814481, 'auprc': 0.9971231204798933, 'loss_val': 0.6444105832811351, 'psi': 0.8148049139808262}
[S4] START round=7 head_norm_before_train=1.341699 (no previous merge yet)
[S4] round=7 local utility u=0.711652 metrics={'f1_val': 0.6709511879372803, 'auprc': 0.6636996595489482, 'loss_val': 0.6209261231383068, 'psi': 0.6680505765819474}-{'f1_val': 0.4141138273491215, 'auprc': 0.7531876309252444, 'loss_val': 0.7716702763947421, 'psi': 0.5497433487795707}
[S5] START round=7 head_norm_before_train=1.546090 (no previous merge yet)
[S5] round=7 local utility u=0.133987 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.8944673253190872, 'loss_val': 0.37111176870532286, 'psi': 0.7781519657252395}-{'f1_val': 0.7005691551769304, 'auprc': 0.8203505625628935, 'loss_val': 0.41650011046385294, 'psi': 0.7484817181313157}
[S6] START round=7 head_norm_before_train=1.008647 cos_to_last_merge=0.9633 (last merge round=1)
[S6] round=7 local utility u=0.869626 metrics={'f1_val': 0.4021130714128137, 'auprc': 0.8371569088367379, 'loss_val': 1.0051179770689136, 'psi': 0.5761306063823834}-{'f1_val': 0.14142628205128205, 'auprc': 0.829897033222159, 'loss_val': 1.1584701797820152, 'psi': 0.4168145825196328}
[S7] START round=7 head_norm_before_train=1.043283 cos_to_last_merge=0.9437 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.944
[S7] round=7 local utility u=0.981795 metrics={'f1_val': 0.714165268727642, 'auprc': 0.7808755282785689, 'loss_val': 0.6497919870164898, 'psi': 0.7408493725480128}-{'f1_val': 0.41703542715461484, 'auprc': 0.7894983606134152, 'loss_val': 0.8564704833527462, 'psi': 0.566020600538135}
[S8] START round=7 head_norm_before_train=0.781386 cos_to_last_merge=0.9960 (last merge round=5)
[S8] round=7 local utility u=1.000000 metrics={'f1_val': 0.7153201919565738, 'auprc': 0.7661074528577666, 'loss_val': 1.0680664286574466, 'psi': 0.7356350963170509}-{'f1_val': 0.13995598239295717, 'auprc': 0.7661084898421529, 'loss_val': 1.199739613570039, 'psi': 0.39041698537263547}
[S9] START round=7 head_norm_before_train=1.562410 (no previous merge yet)
[S9] round=7 local utility u=0.582471 metrics={'f1_val': 0.9100691615987747, 'auprc': 0.9803177850399272, 'loss_val': 0.27102857279983084, 'psi': 0.9381686109752357}-{'f1_val': 0.7012165807733519, 'auprc': 0.9989384678360047, 'loss_val': 0.23871627609203613, 'psi': 0.820305335598413}
[S10] START round=7 head_norm_before_train=0.949900 cos_to_last_merge=0.9530 (last merge round=1)
[S10] round=7 local utility u=0.907998 metrics={'f1_val': 0.41597454042981274, 'auprc': 0.6638358592571354, 'loss_val': 0.969642292128115, 'psi': 0.5151190679607418}-{'f1_val': 0.13862163754172394, 'auprc': 0.6633738994541187, 'loss_val': 1.1201340549156118, 'psi': 0.34852254230668184}
[S11] START round=7 head_norm_before_train=1.045810 cos_to_last_merge=0.9977 (last merge round=5)
[S11] round=7 local utility u=0.335839 metrics={'f1_val': 0.41409654937956825, 'auprc': 0.7945608564602101, 'loss_val': 0.9455704435893898, 'psi': 0.566282272211825}-{'f1_val': 0.42273739039721175, 'auprc': 0.6117956600746844, 'loss_val': 1.1207985497156787, 'psi': 0.49836069826820084}
[S13] START round=7 head_norm_before_train=1.280744 (no previous merge yet)
[S13] round=7 local utility u=0.000000 metrics={'f1_val': 0.3717921896029681, 'auprc': 0.6705486089399939, 'loss_val': 0.8913414746703248, 'psi': 0.49129475733777844}-{'f1_val': 0.4160038662657951, 'auprc': 0.7292728894731704, 'loss_val': 0.9671291430115794, 'psi': 0.5413114755487451}
[S14] START round=7 head_norm_before_train=1.033967 cos_to_last_merge=0.9977 (last merge round=5)
[S14] round=7 local utility u=1.000000 metrics={'f1_val': 0.6406754484514565, 'auprc': 0.9821630535091423, 'loss_val': 0.8072303914928237, 'psi': 0.7772704904745309}-{'f1_val': 0.25876535622120145, 'auprc': 0.9982943876484536, 'loss_val': 1.0494120760146044, 'psi': 0.5545769687921023}
[S15] START round=7 head_norm_before_train=0.786884 cos_to_last_merge=1.0000 (last merge round=6)
[S15] round=7 local utility u=0.112022 metrics={'f1_val': 0.4163758395072774, 'auprc': 0.7471902803098236, 'loss_val': 1.0785297747027647, 'psi': 0.5487016158282959}-{'f1_val': 0.3626296555163404, 'auprc': 0.7964225376678779, 'loss_val': 1.1277931271934092, 'psi': 0.5361468083769554}
[S16] START round=7 head_norm_before_train=0.970414 cos_to_last_merge=0.9974 (last merge round=5)
[S16] round=7 local utility u=0.059963 metrics={'f1_val': 0.4169255670501281, 'auprc': 0.4478718691355583, 'loss_val': 0.9963433231949752, 'psi': 0.4293040878843002}-{'f1_val': 0.41467924219943564, 'auprc': 0.4465278612219767, 'loss_val': 1.0987585774735065, 'psi': 0.42741868980845205}
[S17] START round=7 head_norm_before_train=1.361717 (no previous merge yet)
[S17] round=7 local utility u=0.323151 metrics={'f1_val': 0.3905496937403424, 'auprc': 0.8784837323812749, 'loss_val': 0.8367945516087574, 'psi': 0.5857233091967153}-{'f1_val': 0.39077941957993484, 'auprc': 0.7213531303735163, 'loss_val': 1.0130827041447685, 'psi': 0.5230089038973674}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:41916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:41917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:41913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:41909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:41917
[S16] not sending this round → trigger blocked (psi=0.429)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:41903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:41914
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.576)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] → sending delta(kind=head bytes=1793) to S11@127.0.0.1:41912
[S7] not sending this round → trigger blocked (psi=0.741)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:41916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:41916
[S5] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1793 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S2] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1793) from S14
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.092099)
[S11] loaded HEAD from S14 (vec_in norm=1.092099)
[S11] cosine check vs S14: cos=0.7023
[S11] BUFFERED delta from S14 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1796) from S10
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=0.992549)
[S8] loaded HEAD from S10 (vec_in norm=0.992549)
[S8] cosine check vs S10: cos=0.8167
[S8] BUFFERED delta from S10 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1795) from S2
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.134534)
[S17] loaded HEAD from S2 (vec_in norm=1.134534)
[S17] cosine check vs S2: cos=-0.0959
[S17] DROPPED delta from S2 (cos=-0.0959 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1799) from S3
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.016021)
[S17] loaded HEAD from S3 (vec_in norm=1.016021)
[S17] cosine check vs S3: cos=-0.1775
[S17] DROPPED delta from S3 (cos=-0.1775 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1795) from S11
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.078990)
[S16] loaded HEAD from S11 (vec_in norm=1.078990)
[S16] cosine check vs S11: cos=0.2439
[S16] BUFFERED delta from S11 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1803) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=0.806645)
[S3] loaded HEAD from S8 (vec_in norm=0.806645)
[S3] cosine check vs S8: cos=0.4814
[S3] BUFFERED delta from S8 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1799) from S9
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.640629)
[S16] loaded HEAD from S9 (vec_in norm=1.640629)
[S16] cosine check vs S9: cos=0.9062
[S16] BUFFERED delta from S9 (total buffered=2)
[S13] RECEIVED delta(kind=head bytes=1797) from S15
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.827353)
[S13] loaded HEAD from S15 (vec_in norm=0.827353)
[S13] cosine check vs S15: cos=-0.0306
[S13] DROPPED delta from S15 (cos=-0.0306 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1801) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.596598)
[S16] loaded HEAD from S5 (vec_in norm=1.596598)
[S16] cosine check vs S5: cos=-0.0583
[S16] DROPPED delta from S5 (cos=-0.0583 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1799) from S4
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.394111)
[S14] loaded HEAD from S4 (vec_in norm=1.394111)
[S14] cosine check vs S4: cos=-0.0773
[S14] DROPPED delta from S4 (cos=-0.0773 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:41914
[S17] sending update (kind=head size=1803 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1803) from S17
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.396176)
[S14] loaded HEAD from S17 (vec_in norm=1.396176)
[S14] cosine check vs S17: cos=0.6976
[S14] BUFFERED delta from S17 (total buffered=1)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=7 metric=0.4141 head_norm=1.078990
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.188593e-01
[S11] stored merged vector for next round verification (round=7)
[S11] DEBUG after merge:  round=7 metric=0.3976 head_norm=1.001502 delta_norm=0.418859
[S11] aggregate: ROLLBACK (f1_val pre=0.414 post=0.398 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=7 metric=0.6407 head_norm=1.092099
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.036218e-01
[S14] stored merged vector for next round verification (round=7)
[S14] DEBUG after merge:  round=7 metric=0.8145 head_norm=1.147763 delta_norm=0.503622
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=7 metric=0.7008 head_norm=1.016021
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.727364e-01
[S3] stored merged vector for next round verification (round=7)
[S3] DEBUG after merge:  round=7 metric=0.7008 head_norm=0.786134 delta_norm=0.472736
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=7 metric=0.7153 head_norm=0.806645
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.863638e-01
[S8] stored merged vector for next round verification (round=7)
[S8] DEBUG after merge:  round=7 metric=0.3995 head_norm=0.857853 delta_norm=0.286364
[S8] aggregate: ROLLBACK (f1_val pre=0.715 post=0.400 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=7 metric=0.4169 head_norm=1.017295
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.411787e-01
[S16] stored merged vector for next round verification (round=7)
[S16] DEBUG after merge:  round=7 metric=0.4169 head_norm=0.973804 delta_norm=0.241179
[S16] aggregate: ACCEPT kept=['S11', 'S9'] (k=2/2) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=1.134534 cos_to_last_merge=0.9987 (last merge round=6)
[S2] round=8 local utility u=0.845517 metrics={'f1_val': 0.4158821818019893, 'auprc': 0.7550538720683492, 'loss_val': 1.0265758159789782, 'psi': 0.5515508579085333}-{'f1_val': 0.1417771333885667, 'auprc': 0.7747550188727677, 'loss_val': 1.1320832179699827, 'psi': 0.3949682875822471}
[S3] START round=8 head_norm_before_train=0.786134 cos_to_last_merge=1.0000 (last merge round=7)
[S3] round=8 local utility u=0.000000 metrics={'f1_val': 0.7005813959920884, 'auprc': 0.99444707839368, 'loss_val': 0.5410546692074173, 'psi': 0.818127668952725}-{'f1_val': 0.7007562037352997, 'auprc': 0.9970316830624575, 'loss_val': 0.43695005331179115, 'psi': 0.8192663954661628}
[S4] START round=8 head_norm_before_train=1.394111 (no previous merge yet)
[S4] round=8 local utility u=0.444638 metrics={'f1_val': 0.6655437977213365, 'auprc': 0.9390458216841315, 'loss_val': 0.5252443485204508, 'psi': 0.7749446073064545}-{'f1_val': 0.6709511879372803, 'auprc': 0.6636996595489482, 'loss_val': 0.6209261231383068, 'psi': 0.6680505765819474}
[S5] START round=8 head_norm_before_train=1.596598 (no previous merge yet)
[S5] round=8 local utility u=0.110383 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9455336282722493, 'loss_val': 0.3035438360856429, 'psi': 0.7985784869065042}-{'f1_val': 0.7006083926626743, 'auprc': 0.8944673253190872, 'loss_val': 0.37111176870532286, 'psi': 0.7781519657252395}
[S6] START round=8 head_norm_before_train=1.049002 cos_to_last_merge=0.9511 (last merge round=1)
[S6] round=8 local utility u=0.146519 metrics={'f1_val': 0.4156481186360783, 'auprc': 0.8413661419070907, 'loss_val': 0.8059177108666802, 'psi': 0.5859353279444832}-{'f1_val': 0.4021130714128137, 'auprc': 0.8371569088367379, 'loss_val': 1.0051179770689136, 'psi': 0.5761306063823834}
[S7] START round=8 head_norm_before_train=1.098268 cos_to_last_merge=0.9183 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.918
[S7] round=8 local utility u=0.000000 metrics={'f1_val': 0.6625733301189523, 'auprc': 0.8521054387533495, 'loss_val': 0.6899569713364986, 'psi': 0.7383861735727112}-{'f1_val': 0.714165268727642, 'auprc': 0.7808755282785689, 'loss_val': 0.6497919870164898, 'psi': 0.7408493725480128}
[S8] START round=8 head_norm_before_train=0.857853 cos_to_last_merge=1.0000 (last merge round=7)
[S8] round=8 local utility u=0.062241 metrics={'f1_val': 0.7150334448596258, 'auprc': 0.7743548540314598, 'loss_val': 0.9666053328084235, 'psi': 0.7387620085283595}-{'f1_val': 0.7153201919565738, 'auprc': 0.7661074528577666, 'loss_val': 1.0680664286574466, 'psi': 0.7356350963170509}
[S9] START round=8 head_norm_before_train=1.640629 (no previous merge yet)
[S9] round=8 local utility u=0.346680 metrics={'f1_val': 0.9892714523047061, 'auprc': 0.998808543524761, 'loss_val': 0.10835393352167597, 'psi': 0.9930862887927281}-{'f1_val': 0.9100691615987747, 'auprc': 0.9803177850399272, 'loss_val': 0.27102857279983084, 'psi': 0.9381686109752357}
[S10] START round=8 head_norm_before_train=0.992549 cos_to_last_merge=0.9372 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.937
[S10] round=8 local utility u=0.131889 metrics={'f1_val': 0.38995556959679245, 'auprc': 0.7468833997997966, 'loss_val': 0.7988933233302051, 'psi': 0.5327267016779941}-{'f1_val': 0.41597454042981274, 'auprc': 0.6638358592571354, 'loss_val': 0.969642292128115, 'psi': 0.5151190679607418}
[S11] START round=8 head_norm_before_train=1.001502 cos_to_last_merge=1.0000 (last merge round=7)
[S11] round=8 local utility u=0.596268 metrics={'f1_val': 0.6239527267652627, 'auprc': 0.7399436826583865, 'loss_val': 0.8483193294519273, 'psi': 0.6703491091225122}-{'f1_val': 0.41409654937956825, 'auprc': 0.7945608564602101, 'loss_val': 0.9455704435893898, 'psi': 0.566282272211825}
[S13] START round=8 head_norm_before_train=1.315694 (no previous merge yet)
[S13] round=8 local utility u=0.027141 metrics={'f1_val': 0.4310042155764994, 'auprc': 0.5637192051920168, 'loss_val': 0.8718436979066514, 'psi': 0.48409021142270636}-{'f1_val': 0.3717921896029681, 'auprc': 0.6705486089399939, 'loss_val': 0.8913414746703248, 'psi': 0.49129475733777844}
[S14] START round=8 head_norm_before_train=1.147763 cos_to_last_merge=1.0000 (last merge round=7)
[S14] round=8 local utility u=1.000000 metrics={'f1_val': 0.9960236346064988, 'auprc': 0.9919034454029073, 'loss_val': 0.6775275491014408, 'psi': 0.9943755589250622}-{'f1_val': 0.6406754484514565, 'auprc': 0.9821630535091423, 'loss_val': 0.8072303914928237, 'psi': 0.7772704904745309}
[S15] START round=8 head_norm_before_train=0.827353 cos_to_last_merge=0.9960 (last merge round=6)
[S15] round=8 local utility u=0.000000 metrics={'f1_val': 0.38386009088014816, 'auprc': 0.7108928700276581, 'loss_val': 0.9186183680082709, 'psi': 0.5146732025391522}-{'f1_val': 0.4163758395072774, 'auprc': 0.7471902803098236, 'loss_val': 1.0785297747027647, 'psi': 0.5487016158282959}
[S16] START round=8 head_norm_before_train=0.973804 cos_to_last_merge=1.0000 (last merge round=7)
[S16] round=8 local utility u=0.326740 metrics={'f1_val': 0.41700358386742975, 'auprc': 0.6407995731407975, 'loss_val': 0.9221144939645903, 'psi': 0.5065219795767768}-{'f1_val': 0.4169255670501281, 'auprc': 0.4478718691355583, 'loss_val': 0.9963433231949752, 'psi': 0.4293040878843002}
[S17] START round=8 head_norm_before_train=1.396176 (no previous merge yet)
[S17] round=8 local utility u=0.000000 metrics={'f1_val': 0.35406388426773305, 'auprc': 0.8259326395054043, 'loss_val': 0.8408313586865119, 'psi': 0.5428113863628016}-{'f1_val': 0.3905496937403424, 'auprc': 0.8784837323812749, 'loss_val': 0.8367945516087574, 'psi': 0.5857233091967153}
[S4] not sending this round → trigger blocked (psi=0.775)
[S10] not sending this round → trigger blocked (psi=0.533)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.993)
[S11] not sending this round → trigger blocked (psi=0.670)
[S5] not sending this round → trigger blocked (psi=0.799)
[S14] not sending this round → trigger blocked (psi=0.994)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:41902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] → sending delta(kind=head bytes=1805) to S17@127.0.0.1:41917
[S2] not sending this round → trigger blocked (psi=0.552)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:41915
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.739)
[S16] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1805 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1795) from S16
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.020602)
[S15] loaded HEAD from S16 (vec_in norm=1.020602)
[S15] cosine check vs S16: cos=0.7807
[S15] BUFFERED delta from S16 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1805) from S6
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.101340)
[S17] loaded HEAD from S6 (vec_in norm=1.101340)
[S17] cosine check vs S6: cos=-0.0347
[S17] DROPPED delta from S6 (cos=-0.0347 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1800) from S13
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.347392)
[S2] loaded HEAD from S13 (vec_in norm=1.347392)
[S2] cosine check vs S13: cos=0.9608
[S2] BUFFERED delta from S13 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=8 metric=0.4159 head_norm=1.162704
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.981205e-01
[S2] stored merged vector for next round verification (round=8)
[S2] DEBUG after merge:  round=8 metric=0.4165 head_norm=1.242747 delta_norm=0.198120
[S2] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=8 metric=0.3839 head_norm=0.877043
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.214372e-01
[S15] stored merged vector for next round verification (round=8)
[S15] DEBUG after merge:  round=8 metric=0.3839 head_norm=0.895597 delta_norm=0.321437
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=1.242747 cos_to_last_merge=1.0000 (last merge round=8)
[S2] round=9 local utility u=0.839488 metrics={'f1_val': 0.6628353936535791, 'auprc': 0.7772658601306875, 'loss_val': 0.8959547291856141, 'psi': 0.7086075802444225}-{'f1_val': 0.4158821818019893, 'auprc': 0.7550538720683492, 'loss_val': 1.0265758159789782, 'psi': 0.5515508579085333}
[S3] START round=9 head_norm_before_train=0.875939 cos_to_last_merge=0.9867 (last merge round=7)
[S3] round=9 local utility u=0.043237 metrics={'f1_val': 0.6995786553134029, 'auprc': 0.9951176802675549, 'loss_val': 0.4505763149369704, 'psi': 0.8177942652950636}-{'f1_val': 0.7005813959920884, 'auprc': 0.99444707839368, 'loss_val': 0.5410546692074173, 'psi': 0.818127668952725}
[S4] START round=9 head_norm_before_train=1.448966 (no previous merge yet)
[S4] round=9 local utility u=0.026697 metrics={'f1_val': 0.6772537448932053, 'auprc': 0.9051778328355722, 'loss_val': 0.4405055091660704, 'psi': 0.7684233800701521}-{'f1_val': 0.6655437977213365, 'auprc': 0.9390458216841315, 'loss_val': 0.5252443485204508, 'psi': 0.7749446073064545}
[S5] START round=9 head_norm_before_train=1.638151 (no previous merge yet)
[S5] round=9 local utility u=0.097627 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9970585075937584, 'loss_val': 0.26286507678845084, 'psi': 0.8191884386351079}-{'f1_val': 0.7006083926626743, 'auprc': 0.9455336282722493, 'loss_val': 0.3035438360856429, 'psi': 0.7985784869065042}
[S6] START round=9 head_norm_before_train=1.101340 cos_to_last_merge=0.9359 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.936
[S6] round=9 local utility u=1.000000 metrics={'f1_val': 0.6992486519707186, 'auprc': 0.967100725269004, 'loss_val': 0.6391190520306015, 'psi': 0.8063894812900327}-{'f1_val': 0.4156481186360783, 'auprc': 0.8413661419070907, 'loss_val': 0.8059177108666802, 'psi': 0.5859353279444832}
[S7] START round=9 head_norm_before_train=1.139809 cos_to_last_merge=0.9005 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.901
[S7] round=9 local utility u=0.000000 metrics={'f1_val': 0.6146313772180978, 'auprc': 0.7944164295075256, 'loss_val': 0.6858997741530578, 'psi': 0.686545398133869}-{'f1_val': 0.6625733301189523, 'auprc': 0.8521054387533495, 'loss_val': 0.6899569713364986, 'psi': 0.7383861735727112}
[S8] START round=9 head_norm_before_train=0.883355 cos_to_last_merge=0.9953 (last merge round=7)
[S8] round=9 local utility u=0.000000 metrics={'f1_val': 0.3729322731464855, 'auprc': 0.9957120743330908, 'loss_val': 0.8230551273190903, 'psi': 0.6220441936211276}-{'f1_val': 0.7150334448596258, 'auprc': 0.7743548540314598, 'loss_val': 0.9666053328084235, 'psi': 0.7387620085283595}
[S9] START round=9 head_norm_before_train=1.699723 (no previous merge yet)
[S9] round=9 local utility u=0.025297 metrics={'f1_val': 0.9909938198082651, 'auprc': 0.9992407436249555, 'loss_val': 0.06939080045135292, 'psi': 0.9942925893349412}-{'f1_val': 0.9892714523047061, 'auprc': 0.998808543524761, 'loss_val': 0.10835393352167597, 'psi': 0.9930862887927281}
[S10] START round=9 head_norm_before_train=1.045503 cos_to_last_merge=0.9180 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.918
[S10] round=9 local utility u=0.306794 metrics={'f1_val': 0.4373569608575892, 'auprc': 0.8317729759027888, 'loss_val': 0.7243831164744884, 'psi': 0.595123366875669}-{'f1_val': 0.38995556959679245, 'auprc': 0.7468833997997966, 'loss_val': 0.7988933233302051, 'psi': 0.5327267016779941}
[S11] START round=9 head_norm_before_train=1.035786 cos_to_last_merge=0.9961 (last merge round=7)
[S11] round=9 local utility u=0.000000 metrics={'f1_val': 0.4070949165231458, 'auprc': 0.9075727177188769, 'loss_val': 0.7436249174820305, 'psi': 0.6072860370014382}-{'f1_val': 0.6239527267652627, 'auprc': 0.7399436826583865, 'loss_val': 0.8483193294519273, 'psi': 0.6703491091225122}
[S13] START round=9 head_norm_before_train=1.347392 (no previous merge yet)
[S13] round=9 local utility u=1.000000 metrics={'f1_val': 0.7111117215716545, 'auprc': 0.7316001322980883, 'loss_val': 0.7031580771593798, 'psi': 0.719307085862228}-{'f1_val': 0.4310042155764994, 'auprc': 0.5637192051920168, 'loss_val': 0.8718436979066514, 'psi': 0.48409021142270636}
[S14] START round=9 head_norm_before_train=1.195128 cos_to_last_merge=0.9970 (last merge round=7)
[S14] round=9 local utility u=0.000000 metrics={'f1_val': 0.6203210244220432, 'auprc': 0.9932062858557786, 'loss_val': 0.5652202227090943, 'psi': 0.7694751289955374}-{'f1_val': 0.9960236346064988, 'auprc': 0.9919034454029073, 'loss_val': 0.6775275491014408, 'psi': 0.9943755589250622}
[S15] START round=9 head_norm_before_train=0.895597 cos_to_last_merge=1.0000 (last merge round=8)
[S15] round=9 local utility u=0.055723 metrics={'f1_val': 0.41618427607796626, 'auprc': 0.6700846226909376, 'loss_val': 0.8786931584007522, 'psi': 0.5177444147231548}-{'f1_val': 0.38386009088014816, 'auprc': 0.7108928700276581, 'loss_val': 0.9186183680082709, 'psi': 0.5146732025391522}
[S16] START round=9 head_norm_before_train=1.020602 cos_to_last_merge=0.9971 (last merge round=7)
[S16] round=9 local utility u=0.000000 metrics={'f1_val': 0.3594840486547103, 'auprc': 0.6724191583367939, 'loss_val': 0.9724850671263577, 'psi': 0.4846580925275437}-{'f1_val': 0.41700358386742975, 'auprc': 0.6407995731407975, 'loss_val': 0.9221144939645903, 'psi': 0.5065219795767768}
[S17] START round=9 head_norm_before_train=1.430368 (no previous merge yet)
[S17] round=9 local utility u=0.000000 metrics={'f1_val': 0.3435601642150551, 'auprc': 0.6873423886601543, 'loss_val': 0.9479817313587863, 'psi': 0.48107305399309475}-{'f1_val': 0.35406388426773305, 'auprc': 0.8259326395054043, 'loss_val': 0.8408313586865119, 'psi': 0.5428113863628016}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:41916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:41914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:41916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:41913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:41917
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:41917
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.719)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:41909
[S6] not sending this round → trigger blocked (psi=0.806)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1799) from S15
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.938499)
[S13] loaded HEAD from S15 (vec_in norm=0.938499)
[S13] cosine check vs S15: cos=-0.0176
[S13] DROPPED delta from S15 (cos=-0.0176 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1801) from S4
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.504783)
[S14] loaded HEAD from S4 (vec_in norm=1.504783)
[S14] cosine check vs S4: cos=-0.0571
[S14] DROPPED delta from S4 (cos=-0.0571 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1800) from S2
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.274096)
[S17] loaded HEAD from S2 (vec_in norm=1.274096)
[S17] cosine check vs S2: cos=-0.0984
[S17] DROPPED delta from S2 (cos=-0.0984 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1797) from S3
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=0.981700)
[S17] loaded HEAD from S3 (vec_in norm=0.981700)
[S17] cosine check vs S3: cos=-0.1578
[S17] DROPPED delta from S3 (cos=-0.1578 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1799) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.669031)
[S16] loaded HEAD from S5 (vec_in norm=1.669031)
[S16] cosine check vs S5: cos=-0.0625
[S16] DROPPED delta from S5 (cos=-0.0625 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1799) from S9
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.754887)
[S16] loaded HEAD from S9 (vec_in norm=1.754887)
[S16] cosine check vs S9: cos=0.8738
[S16] BUFFERED delta from S9 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1799) from S10
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.105814)
[S8] loaded HEAD from S10 (vec_in norm=1.105814)
[S8] cosine check vs S10: cos=0.8915
[S8] BUFFERED delta from S10 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=9 metric=0.3729 head_norm=0.919917
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.526876e-01
[S8] stored merged vector for next round verification (round=9)
[S8] DEBUG after merge:  round=9 metric=0.7144 head_norm=0.985233 delta_norm=0.252688
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=9 metric=0.3595 head_norm=1.068123
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.860076e-01
[S16] stored merged vector for next round verification (round=9)
[S16] DEBUG after merge:  round=9 metric=0.3217 head_norm=1.368961 delta_norm=0.486008
[S16] aggregate: ROLLBACK (f1_val pre=0.359 post=0.322 tol_abs=0.005 tol_rel=0.0)
[S2] START round=10 head_norm_before_train=1.274096 cos_to_last_merge=0.9983 (last merge round=8)
[S2] round=10 local utility u=0.100530 metrics={'f1_val': 0.7015503535599839, 'auprc': 0.7147437697912047, 'loss_val': 0.7396175523789137, 'psi': 0.7068277200524722}-{'f1_val': 0.6628353936535791, 'auprc': 0.7772658601306875, 'loss_val': 0.8959547291856141, 'psi': 0.7086075802444225}
[S3] START round=10 head_norm_before_train=0.981700 cos_to_last_merge=0.9599 (last merge round=7)
[S3] round=10 local utility u=0.000000 metrics={'f1_val': 0.6484273947278432, 'auprc': 0.995047476032278, 'loss_val': 0.45812639177073194, 'psi': 0.7870754272496171}-{'f1_val': 0.6995786553134029, 'auprc': 0.9951176802675549, 'loss_val': 0.4505763149369704, 'psi': 0.8177942652950636}
[S4] START round=10 head_norm_before_train=1.504783 (no previous merge yet)
[S4] round=10 local utility u=0.000000 metrics={'f1_val': 0.6654259229894355, 'auprc': 0.820189069913441, 'loss_val': 0.42931588437460155, 'psi': 0.7273311817590378}-{'f1_val': 0.6772537448932053, 'auprc': 0.9051778328355722, 'loss_val': 0.4405055091660704, 'psi': 0.7684233800701521}
[S5] START round=10 head_norm_before_train=1.669031 (no previous merge yet)
[S5] round=10 local utility u=0.000000 metrics={'f1_val': 0.7006090940057808, 'auprc': 0.9911004404715001, 'loss_val': 0.2673678549941594, 'psi': 0.8168056325920685}-{'f1_val': 0.7006083926626743, 'auprc': 0.9970585075937584, 'loss_val': 0.26286507678845084, 'psi': 0.8191884386351079}
[S6] START round=10 head_norm_before_train=1.146158 cos_to_last_merge=0.9207 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.921
[S6] round=10 local utility u=0.000000 metrics={'f1_val': 0.41745618053540323, 'auprc': 0.869159912022514, 'loss_val': 0.6676746398949692, 'psi': 0.5981376731302476}-{'f1_val': 0.6992486519707186, 'auprc': 0.967100725269004, 'loss_val': 0.6391190520306015, 'psi': 0.8063894812900327}
[S7] START round=10 head_norm_before_train=1.184109 cos_to_last_merge=0.8863 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.886
[S7] round=10 local utility u=0.000000 metrics={'f1_val': 0.4290282110517035, 'auprc': 0.7809908327698981, 'loss_val': 0.9335919246278973, 'psi': 0.5698132597389813}-{'f1_val': 0.6146313772180978, 'auprc': 0.7944164295075256, 'loss_val': 0.6858997741530578, 'psi': 0.686545398133869}
[S8] START round=10 head_norm_before_train=0.985233 cos_to_last_merge=1.0000 (last merge round=9)
[S8] round=10 local utility u=1.000000 metrics={'f1_val': 0.7137586021136586, 'auprc': 0.9937208746299623, 'loss_val': 0.7211313690750915, 'psi': 0.8257435111201801}-{'f1_val': 0.3729322731464855, 'auprc': 0.9957120743330908, 'loss_val': 0.8230551273190903, 'psi': 0.6220441936211276}
[S9] START round=10 head_norm_before_train=1.754887 (no previous merge yet)
[S9] round=10 local utility u=0.012518 metrics={'f1_val': 0.9918452858557183, 'auprc': 0.9995768065873475, 'loss_val': 0.05047223094507013, 'psi': 0.99493789414837}-{'f1_val': 0.9909938198082651, 'auprc': 0.9992407436249555, 'loss_val': 0.06939080045135292, 'psi': 0.9942925893349412}
[S10] START round=10 head_norm_before_train=1.105814 cos_to_last_merge=0.8965 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.897
[S10] round=10 local utility u=1.000000 metrics={'f1_val': 0.6998932897468348, 'auprc': 0.9753990337551977, 'loss_val': 0.5183087757771662, 'psi': 0.81009558735018}-{'f1_val': 0.4373569608575892, 'auprc': 0.8317729759027888, 'loss_val': 0.7243831164744884, 'psi': 0.595123366875669}
[S11] START round=10 head_norm_before_train=1.079147 cos_to_last_merge=0.9862 (last merge round=7)
[S11] round=10 local utility u=0.973413 metrics={'f1_val': 0.701890640953942, 'auprc': 0.9078398740905366, 'loss_val': 0.5663738864466703, 'psi': 0.78427033420858}-{'f1_val': 0.4070949165231458, 'auprc': 0.9075727177188769, 'loss_val': 0.7436249174820305, 'psi': 0.6072860370014382}
[S13] START round=10 head_norm_before_train=1.382684 (no previous merge yet)
[S13] round=10 local utility u=0.036324 metrics={'f1_val': 0.7115091406168195, 'auprc': 0.7318247644946299, 'loss_val': 0.6335693926077564, 'psi': 0.7196353901679436}-{'f1_val': 0.7111117215716545, 'auprc': 0.7316001322980883, 'loss_val': 0.7031580771593798, 'psi': 0.719307085862228}
[S14] START round=10 head_norm_before_train=1.247659 cos_to_last_merge=0.9896 (last merge round=7)
[S14] round=10 local utility u=0.031174 metrics={'f1_val': 0.6203213413581947, 'auprc': 0.9944261499759838, 'loss_val': 0.5065330404977887, 'psi': 0.7699632648053103}-{'f1_val': 0.6203210244220432, 'auprc': 0.9932062858557786, 'loss_val': 0.5652202227090943, 'psi': 0.7694751289955374}
[S15] START round=10 head_norm_before_train=0.938499 cos_to_last_merge=0.9949 (last merge round=8)
[S15] round=10 local utility u=0.202975 metrics={'f1_val': 0.38348172164647687, 'auprc': 0.8285941191470743, 'loss_val': 0.7520555622551098, 'psi': 0.5615266806467158}-{'f1_val': 0.41618427607796626, 'auprc': 0.6700846226909376, 'loss_val': 0.8786931584007522, 'psi': 0.5177444147231548}
[S16] START round=10 head_norm_before_train=1.368961 cos_to_last_merge=1.0000 (last merge round=9)
[S16] round=10 local utility u=0.363563 metrics={'f1_val': 0.4357245048017875, 'auprc': 0.7069580655214541, 'loss_val': 0.806417875028227, 'psi': 0.544217929089654}-{'f1_val': 0.3594840486547103, 'auprc': 0.6724191583367939, 'loss_val': 0.9724850671263577, 'psi': 0.4846580925275437}
[S17] START round=10 head_norm_before_train=1.460610 (no previous merge yet)
[S17] round=10 local utility u=0.008130 metrics={'f1_val': 0.34795026465118495, 'auprc': 0.6804130701764499, 'loss_val': 0.9372747128747471, 'psi': 0.4809353868612909}-{'f1_val': 0.3435601642150551, 'auprc': 0.6873423886601543, 'loss_val': 0.9479817313587863, 'psi': 0.48107305399309475}
[S9] not sending this round → trigger blocked (psi=0.995)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:41915
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.562)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:41912
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.707)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:41903
[S10] not sending this round → trigger blocked (psi=0.810)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:41916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:41902
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1804 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1799) from S14
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.300912)
[S11] loaded HEAD from S14 (vec_in norm=1.300912)
[S11] cosine check vs S14: cos=0.7104
[S11] BUFFERED delta from S14 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1797) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.019550)
[S3] loaded HEAD from S8 (vec_in norm=1.019550)
[S3] cosine check vs S8: cos=0.4244
[S3] BUFFERED delta from S8 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1801) from S13
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.414888)
[S2] loaded HEAD from S13 (vec_in norm=1.414888)
[S2] cosine check vs S13: cos=0.9693
[S2] BUFFERED delta from S13 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1804) from S16
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.402452)
[S15] loaded HEAD from S16 (vec_in norm=1.402452)
[S15] cosine check vs S16: cos=0.8716
[S15] BUFFERED delta from S16 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1796) from S11
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.125558)
[S16] loaded HEAD from S11 (vec_in norm=1.125558)
[S16] cosine check vs S11: cos=0.1169
[S16] BUFFERED delta from S11 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:41914
[S17] sending update (kind=head size=1796 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1796) from S17
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.482583)
[S14] loaded HEAD from S17 (vec_in norm=1.482583)
[S14] cosine check vs S17: cos=0.8766
[S14] BUFFERED delta from S17 (total buffered=1)
[S9] ⇄ pheromone p=0.370 → S16@127.0.0.1:41916
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=10 metric=0.6484 head_norm=1.073554
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.618829e-01
[S3] stored merged vector for next round verification (round=10)
[S3] DEBUG after merge:  round=10 metric=0.5181 head_norm=0.883339 delta_norm=0.561883
[S3] aggregate: ROLLBACK (f1_val pre=0.648 post=0.518 tol_abs=0.005 tol_rel=0.0)
[S3] ⇄ pheromone p=0.256 → S17@127.0.0.1:41917
[S5] ⇄ pheromone p=0.277 → S16@127.0.0.1:41916
[S6] ⇄ pheromone p=0.380 → S17@127.0.0.1:41917
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=10 metric=0.7016 head_norm=1.312056
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.764343e-01
[S2] stored merged vector for next round verification (round=10)
[S2] DEBUG after merge:  round=10 metric=0.7015 head_norm=1.352986 delta_norm=0.176434
[S2] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.406 → S17@127.0.0.1:41917
[S7] ⇄ pheromone p=0.273 → S4@127.0.0.1:41904
[S4] ⇄ pheromone p=0.297 → S14@127.0.0.1:41914
[S10] ⇄ pheromone p=0.480 → S8@127.0.0.1:41909
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=10 metric=0.3835 head_norm=0.989695
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.629071e-01
[S15] stored merged vector for next round verification (round=10)
[S15] DEBUG after merge:  round=10 metric=0.3835 head_norm=1.158224 delta_norm=0.362907
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.242 → S13@127.0.0.1:41913
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=10 metric=0.6203 head_norm=1.300912
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.567736e-01
[S14] stored merged vector for next round verification (round=10)
[S14] DEBUG after merge:  round=10 metric=0.6205 head_norm=1.348304 delta_norm=0.356774
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.394 → S11@127.0.0.1:41912
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=10 metric=0.7019 head_norm=1.125558
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.687172e-01
[S11] stored merged vector for next round verification (round=10)
[S11] DEBUG after merge:  round=10 metric=0.7018 head_norm=1.122466 delta_norm=0.468717
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.510 → S16@127.0.0.1:41916
[S13] ⇄ pheromone p=0.351 → S2@127.0.0.1:41902
[S8] ⇄ pheromone p=0.428 → S3@127.0.0.1:41903
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=10 metric=0.4357 head_norm=1.402452
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.462746e-01
[S16] stored merged vector for next round verification (round=10)
[S16] DEBUG after merge:  round=10 metric=0.4361 head_norm=0.949050 delta_norm=0.846275
[S16] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.319 → S15@127.0.0.1:41915
[S17] ⇄ pheromone p=0.215 → S14@127.0.0.1:41914
[S2] START round=11 head_norm_before_train=1.352986 cos_to_last_merge=1.0000 (last merge round=10)
[S2] round=11 local utility u=0.169164 metrics={'f1_val': 0.7096282027784722, 'auprc': 0.7775201178913912, 'loss_val': 0.6380859240847956, 'psi': 0.7367849688236399}-{'f1_val': 0.7015503535599839, 'auprc': 0.7147437697912047, 'loss_val': 0.7396175523789137, 'psi': 0.7068277200524722}
[S3] START round=11 head_norm_before_train=0.883339 cos_to_last_merge=1.0000 (last merge round=10)
[S3] round=11 local utility u=0.162533 metrics={'f1_val': 0.7003512381127298, 'auprc': 0.9967220497338962, 'loss_val': 0.44962781947626873, 'psi': 0.8188995627611964}-{'f1_val': 0.6484273947278432, 'auprc': 0.995047476032278, 'loss_val': 0.45812639177073194, 'psi': 0.7870754272496171}
[S4] START round=11 head_norm_before_train=1.554970 (no previous merge yet)
[S4] round=11 local utility u=1.000000 metrics={'f1_val': 0.9486127589577851, 'auprc': 0.9470900135777396, 'loss_val': 0.4489897666809084, 'psi': 0.9480036608057669}-{'f1_val': 0.6654259229894355, 'auprc': 0.820189069913441, 'loss_val': 0.42931588437460155, 'psi': 0.7273311817590378}
[S5] START round=11 head_norm_before_train=1.698449 (no previous merge yet)
[S5] round=11 local utility u=0.000000 metrics={'f1_val': 0.6824974445738554, 'auprc': 0.8209243308990881, 'loss_val': 0.37972187524082585, 'psi': 0.7378681991039485}-{'f1_val': 0.7006090940057808, 'auprc': 0.9911004404715001, 'loss_val': 0.2673678549941594, 'psi': 0.8168056325920685}
[S6] START round=11 head_norm_before_train=1.187229 cos_to_last_merge=0.9056 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.906
[S6] round=11 local utility u=0.000000 metrics={'f1_val': 0.41588308903900795, 'auprc': 0.7892390278759563, 'loss_val': 0.5696395590976079, 'psi': 0.5652254645737873}-{'f1_val': 0.41745618053540323, 'auprc': 0.869159912022514, 'loss_val': 0.6676746398949692, 'psi': 0.5981376731302476}
[S7] START round=11 head_norm_before_train=1.225280 cos_to_last_merge=0.8758 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.876
[S7] round=11 local utility u=0.000000 metrics={'f1_val': 0.42317798885137947, 'auprc': 0.7802048829633964, 'loss_val': 0.9808541050892414, 'psi': 0.5659887464961862}-{'f1_val': 0.4290282110517035, 'auprc': 0.7809908327698981, 'loss_val': 0.9335919246278973, 'psi': 0.5698132597389813}
[S8] START round=11 head_norm_before_train=1.019550 cos_to_last_merge=0.9957 (last merge round=9)
[S8] round=11 local utility u=0.093214 metrics={'f1_val': 0.7140449400060004, 'auprc': 0.9950849068325605, 'loss_val': 0.540514097498981, 'psi': 0.8264609267366244}-{'f1_val': 0.7137586021136586, 'auprc': 0.9937208746299623, 'loss_val': 0.7211313690750915, 'psi': 0.8257435111201801}
[S9] START round=11 head_norm_before_train=1.796491 (no previous merge yet)
[S9] round=11 local utility u=0.012260 metrics={'f1_val': 0.9939393793306803, 'auprc': 0.9995742566827183, 'loss_val': 0.038510054265213534, 'psi': 0.9961933302714956}-{'f1_val': 0.9918452858557183, 'auprc': 0.9995768065873475, 'loss_val': 0.05047223094507013, 'psi': 0.99493789414837}
[S10] START round=11 head_norm_before_train=1.163981 cos_to_last_merge=0.8786 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.879
[S10] round=11 local utility u=0.000000 metrics={'f1_val': 0.6799193252195818, 'auprc': 0.9448213314383074, 'loss_val': 0.44370918805677056, 'psi': 0.785880127707072}-{'f1_val': 0.6998932897468348, 'auprc': 0.9753990337551977, 'loss_val': 0.5183087757771662, 'psi': 0.81009558735018}
[S11] START round=11 head_norm_before_train=1.122466 cos_to_last_merge=1.0000 (last merge round=10)
[S11] round=11 local utility u=0.023435 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9158091534019169, 'loss_val': 0.5436803873695599, 'psi': 0.7874848513397588}-{'f1_val': 0.701890640953942, 'auprc': 0.9078398740905366, 'loss_val': 0.5663738864466703, 'psi': 0.78427033420858}
[S13] START round=11 head_norm_before_train=1.414888 (no previous merge yet)
[S13] round=11 local utility u=0.028682 metrics={'f1_val': 0.7108624751737117, 'auprc': 0.7414641076588424, 'loss_val': 0.6012424582463575, 'psi': 0.723103128167764}-{'f1_val': 0.7115091406168195, 'auprc': 0.7318247644946299, 'loss_val': 0.6335693926077564, 'psi': 0.7196353901679436}
[S14] START round=11 head_norm_before_train=1.348304 cos_to_last_merge=1.0000 (last merge round=10)
[S14] round=11 local utility u=0.020890 metrics={'f1_val': 0.6205637456666455, 'auprc': 0.9956937431734161, 'loss_val': 0.47001052290561796, 'psi': 0.7706157446693538}-{'f1_val': 0.6203213413581947, 'auprc': 0.9944261499759838, 'loss_val': 0.5065330404977887, 'psi': 0.7699632648053103}
[S15] START round=11 head_norm_before_train=1.158224 cos_to_last_merge=1.0000 (last merge round=10)
[S15] round=11 local utility u=0.732998 metrics={'f1_val': 0.5747722828588389, 'auprc': 0.9132598314155911, 'loss_val': 0.6878001780339446, 'psi': 0.7101673022815398}-{'f1_val': 0.38348172164647687, 'auprc': 0.8285941191470743, 'loss_val': 0.7520555622551098, 'psi': 0.5615266806467158}
[S16] START round=11 head_norm_before_train=0.949050 cos_to_last_merge=1.0000 (last merge round=10)
[S16] round=11 local utility u=0.000000 metrics={'f1_val': 0.41822274483194644, 'auprc': 0.7324953762015964, 'loss_val': 0.8709560817184836, 'psi': 0.5439317973798065}-{'f1_val': 0.4357245048017875, 'auprc': 0.7069580655214541, 'loss_val': 0.806417875028227, 'psi': 0.544217929089654}
[S17] START round=11 head_norm_before_train=1.482583 (no previous merge yet)
[S17] round=11 local utility u=0.161115 metrics={'f1_val': 0.38235797437844965, 'auprc': 0.7057668937788175, 'loss_val': 0.8975523333414392, 'psi': 0.5117215421385968}-{'f1_val': 0.34795026465118495, 'auprc': 0.6804130701764499, 'loss_val': 0.9372747128747471, 'psi': 0.4809353868612909}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:41903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:41912
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:41916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:41914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:41902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S9] → sending delta(kind=head bytes=1805) to S16@127.0.0.1:41916
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:41917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:41913
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:41917
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1804 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1805 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1800) from S14
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.391180)
[S11] loaded HEAD from S14 (vec_in norm=1.391180)
[S11] cosine check vs S14: cos=0.8363
[S11] BUFFERED delta from S14 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1800) from S2
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.393889)
[S17] loaded HEAD from S2 (vec_in norm=1.393889)
[S17] cosine check vs S2: cos=-0.1044
[S17] DROPPED delta from S2 (cos=-0.1044 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1804) from S3
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=0.963427)
[S17] loaded HEAD from S3 (vec_in norm=0.963427)
[S17] cosine check vs S3: cos=-0.0918
[S17] DROPPED delta from S3 (cos=-0.0918 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1805) from S9
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.833073)
[S16] loaded HEAD from S9 (vec_in norm=1.833073)
[S16] cosine check vs S9: cos=0.7255
[S16] BUFFERED delta from S9 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1802) from S15
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.201493)
[S13] loaded HEAD from S15 (vec_in norm=1.201493)
[S13] cosine check vs S15: cos=-0.0229
[S13] DROPPED delta from S15 (cos=-0.0229 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1801) from S13
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.444089)
[S2] loaded HEAD from S13 (vec_in norm=1.444089)
[S2] cosine check vs S13: cos=0.9849
[S2] BUFFERED delta from S13 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1796) from S11
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.161475)
[S16] loaded HEAD from S11 (vec_in norm=1.161475)
[S16] cosine check vs S11: cos=0.5782
[S16] BUFFERED delta from S11 (total buffered=2)
[S14] RECEIVED delta(kind=head bytes=1801) from S4
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.597552)
[S14] loaded HEAD from S4 (vec_in norm=1.597552)
[S14] cosine check vs S4: cos=-0.0361
[S14] DROPPED delta from S4 (cos=-0.0361 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1800) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.062268)
[S3] loaded HEAD from S8 (vec_in norm=1.062268)
[S3] cosine check vs S8: cos=0.7717
[S3] BUFFERED delta from S8 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:41914
[S17] sending update (kind=head size=1796 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1796) from S17
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.496769)
[S14] loaded HEAD from S17 (vec_in norm=1.496769)
[S14] cosine check vs S17: cos=0.9606
[S14] BUFFERED delta from S17 (total buffered=1)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=11 metric=0.7019 head_norm=1.161475
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.813842e-01
[S11] stored merged vector for next round verification (round=11)
[S11] DEBUG after merge:  round=11 metric=0.7019 head_norm=1.223417 delta_norm=0.381384
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=11 metric=0.6206 head_norm=1.391180
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.093685e-01
[S14] stored merged vector for next round verification (round=11)
[S14] DEBUG after merge:  round=11 metric=0.6206 head_norm=1.429690 delta_norm=0.209369
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=11 metric=0.7096 head_norm=1.393889
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.258877e-01
[S2] stored merged vector for next round verification (round=11)
[S2] DEBUG after merge:  round=11 metric=0.7064 head_norm=1.413617 delta_norm=0.125888
[S2] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=11 metric=0.7004 head_norm=0.963427
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.453349e-01
[S3] stored merged vector for next round verification (round=11)
[S3] DEBUG after merge:  round=11 metric=0.7005 head_norm=0.953439 delta_norm=0.345335
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=11 metric=0.4182 head_norm=0.982421
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.844348e-01
[S16] stored merged vector for next round verification (round=11)
[S16] DEBUG after merge:  round=11 metric=0.3658 head_norm=1.008552 delta_norm=0.184435
[S16] aggregate: ROLLBACK (f1_val pre=0.418 post=0.366 tol_abs=0.005 tol_rel=0.0)
[S2] START round=12 head_norm_before_train=1.413617 cos_to_last_merge=1.0000 (last merge round=11)
[S2] round=12 local utility u=0.084449 metrics={'f1_val': 0.7017304662519669, 'auprc': 0.7937139173105455, 'loss_val': 0.4703829166665089, 'psi': 0.7385238466753984}-{'f1_val': 0.7096282027784722, 'auprc': 0.7775201178913912, 'loss_val': 0.6380859240847956, 'psi': 0.7367849688236399}
[S3] START round=12 head_norm_before_train=0.953439 cos_to_last_merge=1.0000 (last merge round=11)
[S3] round=12 local utility u=0.000000 metrics={'f1_val': 0.7003512381127298, 'auprc': 0.9969260619698886, 'loss_val': 0.4988515550272663, 'psi': 0.8189811676555934}-{'f1_val': 0.7003512381127298, 'auprc': 0.9967220497338962, 'loss_val': 0.44962781947626873, 'psi': 0.8188995627611964}
[S4] START round=12 head_norm_before_train=1.597552 (no previous merge yet)
[S4] round=12 local utility u=0.023890 metrics={'f1_val': 0.953868274531886, 'auprc': 0.9524191259563832, 'loss_val': 0.44873106865139606, 'psi': 0.9532886151016849}-{'f1_val': 0.9486127589577851, 'auprc': 0.9470900135777396, 'loss_val': 0.4489897666809084, 'psi': 0.9480036608057669}
[S5] START round=12 head_norm_before_train=1.712393 (no previous merge yet)
[S5] round=12 local utility u=0.000000 metrics={'f1_val': 0.591007352192943, 'auprc': 0.8390611068735508, 'loss_val': 0.4976627904249778, 'psi': 0.6902288540651862}-{'f1_val': 0.6824974445738554, 'auprc': 0.8209243308990881, 'loss_val': 0.37972187524082585, 'psi': 0.7378681991039485}
[S6] START round=12 head_norm_before_train=1.219254 cos_to_last_merge=0.8943 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.894
[S6] round=12 local utility u=0.712710 metrics={'f1_val': 0.6181048978536503, 'auprc': 0.8719631400512414, 'loss_val': 0.6057233239375405, 'psi': 0.7196481947326867}-{'f1_val': 0.41588308903900795, 'auprc': 0.7892390278759563, 'loss_val': 0.5696395590976079, 'psi': 0.5652254645737873}
[S7] START round=12 head_norm_before_train=1.259559 cos_to_last_merge=0.8687 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.869
[S7] round=12 local utility u=0.551921 metrics={'f1_val': 0.56773414190478, 'auprc': 0.7812919782654728, 'loss_val': 0.747611128792939, 'psi': 0.6531572764490572}-{'f1_val': 0.42317798885137947, 'auprc': 0.7802048829633964, 'loss_val': 0.9808541050892414, 'psi': 0.5659887464961862}
[S8] START round=12 head_norm_before_train=1.062268 cos_to_last_merge=0.9857 (last merge round=9)
[S8] round=12 local utility u=0.031468 metrics={'f1_val': 0.7138229449839267, 'auprc': 0.9946427484947398, 'loss_val': 0.47491916525887273, 'psi': 0.826150866388252}-{'f1_val': 0.7140449400060004, 'auprc': 0.9950849068325605, 'loss_val': 0.540514097498981, 'psi': 0.8264609267366244}
[S9] START round=12 head_norm_before_train=1.833073 (no previous merge yet)
[S9] round=12 local utility u=0.000000 metrics={'f1_val': 0.9897262816474692, 'auprc': 0.9978955417233624, 'loss_val': 0.0467094190132785, 'psi': 0.9929939856778265}-{'f1_val': 0.9939393793306803, 'auprc': 0.9995742566827183, 'loss_val': 0.038510054265213534, 'psi': 0.9961933302714956}
[S10] START round=12 head_norm_before_train=1.219983 cos_to_last_merge=0.8623 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.862
[S10] round=12 local utility u=0.190666 metrics={'f1_val': 0.6977017444183163, 'auprc': 0.9953476721041615, 'loss_val': 0.3206510565303691, 'psi': 0.8167601154926545}-{'f1_val': 0.6799193252195818, 'auprc': 0.9448213314383074, 'loss_val': 0.44370918805677056, 'psi': 0.785880127707072}
[S11] START round=12 head_norm_before_train=1.223417 cos_to_last_merge=1.0000 (last merge round=11)
[S11] round=12 local utility u=0.130595 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9943136108102573, 'loss_val': 0.5180027887278458, 'psi': 0.8188866343030949}-{'f1_val': 0.7019353166316534, 'auprc': 0.9158091534019169, 'loss_val': 0.5436803873695599, 'psi': 0.7874848513397588}
[S13] START round=12 head_norm_before_train=1.444089 (no previous merge yet)
[S13] round=12 local utility u=0.000000 metrics={'f1_val': 0.666182085538831, 'auprc': 0.7242062268717198, 'loss_val': 0.5735285135613002, 'psi': 0.6893917420719864}-{'f1_val': 0.7108624751737117, 'auprc': 0.7414641076588424, 'loss_val': 0.6012424582463575, 'psi': 0.723103128167764}
[S14] START round=12 head_norm_before_train=1.429690 cos_to_last_merge=1.0000 (last merge round=11)
[S14] round=12 local utility u=1.000000 metrics={'f1_val': 0.9919529155419744, 'auprc': 0.9971513755563131, 'loss_val': 0.3907418915598063, 'psi': 0.9940322995477098}-{'f1_val': 0.6205637456666455, 'auprc': 0.9956937431734161, 'loss_val': 0.47001052290561796, 'psi': 0.7706157446693538}
[S15] START round=12 head_norm_before_train=1.201493 cos_to_last_merge=0.9976 (last merge round=10)
[S15] round=12 local utility u=0.000000 metrics={'f1_val': 0.49377517461734277, 'auprc': 0.7451713891617436, 'loss_val': 0.6395729525959014, 'psi': 0.594333660435103}-{'f1_val': 0.5747722828588389, 'auprc': 0.9132598314155911, 'loss_val': 0.6878001780339446, 'psi': 0.7101673022815398}
[S16] START round=12 head_norm_before_train=1.008552 cos_to_last_merge=1.0000 (last merge round=11)
[S16] round=12 local utility u=0.000000 metrics={'f1_val': 0.37223546002834246, 'auprc': 0.7381214963498791, 'loss_val': 0.8184048552720057, 'psi': 0.5185898745569572}-{'f1_val': 0.41822274483194644, 'auprc': 0.7324953762015964, 'loss_val': 0.8709560817184836, 'psi': 0.5439317973798065}
[S17] START round=12 head_norm_before_train=1.496769 (no previous merge yet)
[S17] round=12 local utility u=0.017582 metrics={'f1_val': 0.38830121224503844, 'auprc': 0.7097294301560908, 'loss_val': 0.9099357383210531, 'psi': 0.5168724994094593}-{'f1_val': 0.38235797437844965, 'auprc': 0.7057668937788175, 'loss_val': 0.8975523333414392, 'psi': 0.5117215421385968}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:41916
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] → sending delta(kind=head bytes=1804) to S11@127.0.0.1:41912
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:41917
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:41909
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:41903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:41917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] → sending delta(kind=head bytes=1805) to S4@127.0.0.1:41904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S4] → sending delta(kind=head bytes=1806) to S14@127.0.0.1:41914
[S4] sending update (kind=head size=1806 to 1 peers)
[S7] sending update (kind=head size=1805 to 1 peers)
[S6] sending update (kind=head size=1804 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1804 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1804 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1804) from S10
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.268051)
[S8] loaded HEAD from S10 (vec_in norm=1.268051)
[S8] cosine check vs S10: cos=0.9014
[S8] BUFFERED delta from S10 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1805) from S7
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.283623)
[S4] loaded HEAD from S7 (vec_in norm=1.283623)
[S4] cosine check vs S7: cos=-0.1468
[S4] DROPPED delta from S7 (cos=-0.1468 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1804) from S14
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.468217)
[S11] loaded HEAD from S14 (vec_in norm=1.468217)
[S11] cosine check vs S14: cos=0.9218
[S11] BUFFERED delta from S14 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1804) from S6
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.244888)
[S17] loaded HEAD from S6 (vec_in norm=1.244888)
[S17] cosine check vs S6: cos=-0.0488
[S17] DROPPED delta from S6 (cos=-0.0488 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1802) from S2
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.459314)
[S17] loaded HEAD from S2 (vec_in norm=1.459314)
[S17] cosine check vs S2: cos=-0.1087
[S17] DROPPED delta from S2 (cos=-0.1087 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1806) from S4
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.633904)
[S14] loaded HEAD from S4 (vec_in norm=1.633904)
[S14] cosine check vs S4: cos=-0.0246
[S14] DROPPED delta from S4 (cos=-0.0246 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1797) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.107295)
[S3] loaded HEAD from S8 (vec_in norm=1.107295)
[S3] cosine check vs S8: cos=0.8883
[S3] BUFFERED delta from S8 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1799) from S11
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.259234)
[S16] loaded HEAD from S11 (vec_in norm=1.259234)
[S16] cosine check vs S11: cos=0.4589
[S16] BUFFERED delta from S11 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:41914
[S17] sending update (kind=head size=1800 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1800) from S17
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.510198)
[S14] loaded HEAD from S17 (vec_in norm=1.510198)
[S14] cosine check vs S17: cos=0.9831
[S14] BUFFERED delta from S17 (total buffered=1)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=12 metric=0.7004 head_norm=1.023413
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.550272e-01
[S3] stored merged vector for next round verification (round=12)
[S3] DEBUG after merge:  round=12 metric=0.7004 head_norm=1.035229 delta_norm=0.255027
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=12 metric=0.9920 head_norm=1.468217
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.386242e-01
[S14] stored merged vector for next round verification (round=12)
[S14] DEBUG after merge:  round=12 metric=0.6202 head_norm=1.482890 delta_norm=0.138624
[S14] aggregate: ROLLBACK (f1_val pre=0.992 post=0.620 tol_abs=0.005 tol_rel=0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=12 metric=0.7019 head_norm=1.259234
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.884115e-01
[S11] stored merged vector for next round verification (round=12)
[S11] DEBUG after merge:  round=12 metric=0.7019 head_norm=1.336968 delta_norm=0.288411
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=12 metric=0.7138 head_norm=1.107295
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.751131e-01
[S8] stored merged vector for next round verification (round=12)
[S8] DEBUG after merge:  round=12 metric=0.7150 head_norm=1.158162 delta_norm=0.275113
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=12 metric=0.3722 head_norm=1.057682
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.086729e-01
[S16] stored merged vector for next round verification (round=12)
[S16] DEBUG after merge:  round=12 metric=0.3800 head_norm=0.990807 delta_norm=0.608673
[S16] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.459314 cos_to_last_merge=0.9986 (last merge round=11)
[S2] round=13 local utility u=0.058255 metrics={'f1_val': 0.7013101313728686, 'auprc': 0.7947202586990532, 'loss_val': 0.3543698122400668, 'psi': 0.7386741823033425}-{'f1_val': 0.7017304662519669, 'auprc': 0.7937139173105455, 'loss_val': 0.4703829166665089, 'psi': 0.7385238466753984}
[S3] START round=13 head_norm_before_train=1.035229 cos_to_last_merge=1.0000 (last merge round=12)
[S3] round=13 local utility u=0.000406 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9972555133506309, 'loss_val': 0.5010066733663575, 'psi': 0.8193107811394532}-{'f1_val': 0.7003512381127298, 'auprc': 0.9969260619698886, 'loss_val': 0.4988515550272663, 'psi': 0.8189811676555934}
[S4] START round=13 head_norm_before_train=1.633904 (no previous merge yet)
[S4] round=13 local utility u=0.000000 metrics={'f1_val': 0.6738662580745528, 'auprc': 0.9440210939518654, 'loss_val': 0.42477452784131675, 'psi': 0.7819281924254778}-{'f1_val': 0.953868274531886, 'auprc': 0.9524191259563832, 'loss_val': 0.44873106865139606, 'psi': 0.9532886151016849}
[S5] START round=13 head_norm_before_train=1.721545 (no previous merge yet)
[S5] round=13 local utility u=0.000000 metrics={'f1_val': 0.43592345592473125, 'auprc': 0.8550958375772594, 'loss_val': 0.6956798298319528, 'psi': 0.6035924085857425}-{'f1_val': 0.591007352192943, 'auprc': 0.8390611068735508, 'loss_val': 0.4976627904249778, 'psi': 0.6902288540651862}
[S6] START round=13 head_norm_before_train=1.244888 cos_to_last_merge=0.8862 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.886
[S6] round=13 local utility u=0.000000 metrics={'f1_val': 0.6221124468974465, 'auprc': 0.7822149148045155, 'loss_val': 0.5514062759036424, 'psi': 0.6861534340602742}-{'f1_val': 0.6181048978536503, 'auprc': 0.8719631400512414, 'loss_val': 0.6057233239375405, 'psi': 0.7196481947326867}
[S7] START round=13 head_norm_before_train=1.283623 cos_to_last_merge=0.8641 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.864
[S7] round=13 local utility u=0.000000 metrics={'f1_val': 0.49586211546817094, 'auprc': 0.7806986722556346, 'loss_val': 0.8288339564565596, 'psi': 0.6097967381831564}-{'f1_val': 0.56773414190478, 'auprc': 0.7812919782654728, 'loss_val': 0.747611128792939, 'psi': 0.6531572764490572}
[S8] START round=13 head_norm_before_train=1.158162 cos_to_last_merge=1.0000 (last merge round=12)
[S8] round=13 local utility u=0.674190 metrics={'f1_val': 0.9210944154537203, 'auprc': 0.9932459911270883, 'loss_val': 0.3659767792419436, 'psi': 0.9499550457230674}-{'f1_val': 0.7138229449839267, 'auprc': 0.9946427484947398, 'loss_val': 0.47491916525887273, 'psi': 0.826150866388252}
[S9] START round=13 head_norm_before_train=1.866750 (no previous merge yet)
[S9] round=13 local utility u=0.027019 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9955669927482078, 'loss_val': 0.028444183931211994, 'psi': 0.9963383483546375}-{'f1_val': 0.9897262816474692, 'auprc': 0.9978955417233624, 'loss_val': 0.0467094190132785, 'psi': 0.9929939856778265}
[S10] START round=13 head_norm_before_train=1.268051 cos_to_last_merge=0.8473 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.847
[S10] round=13 local utility u=0.000000 metrics={'f1_val': 0.692599218489457, 'auprc': 0.9872041289381934, 'loss_val': 0.3275258655615552, 'psi': 0.8104411826689516}-{'f1_val': 0.6977017444183163, 'auprc': 0.9953476721041615, 'loss_val': 0.3206510565303691, 'psi': 0.8167601154926545}
[S11] START round=13 head_norm_before_train=1.336968 cos_to_last_merge=1.0000 (last merge round=12)
[S11] round=13 local utility u=0.021154 metrics={'f1_val': 0.7020007759458987, 'auprc': 0.9987441379747601, 'loss_val': 0.48937926953031574, 'psi': 0.8206981207574433}-{'f1_val': 0.7019353166316534, 'auprc': 0.9943136108102573, 'loss_val': 0.5180027887278458, 'psi': 0.8188866343030949}
[S13] START round=13 head_norm_before_train=1.474198 (no previous merge yet)
[S13] round=13 local utility u=0.000000 metrics={'f1_val': 0.625011588920155, 'auprc': 0.6857848171346208, 'loss_val': 0.587965970145813, 'psi': 0.6493208802059413}-{'f1_val': 0.666182085538831, 'auprc': 0.7242062268717198, 'loss_val': 0.5735285135613002, 'psi': 0.6893917420719864}
[S14] START round=13 head_norm_before_train=1.482890 cos_to_last_merge=1.0000 (last merge round=12)
[S14] round=13 local utility u=0.000000 metrics={'f1_val': 0.7019269709023651, 'auprc': 0.996905713406999, 'loss_val': 0.3279204848938717, 'psi': 0.8199184679042186}-{'f1_val': 0.9919529155419744, 'auprc': 0.9971513755563131, 'loss_val': 0.3907418915598063, 'psi': 0.9940322995477098}
[S15] START round=13 head_norm_before_train=1.249822 cos_to_last_merge=0.9924 (last merge round=10)
[S15] round=13 local utility u=1.000000 metrics={'f1_val': 0.7382855726294741, 'auprc': 0.9481141637006265, 'loss_val': 0.5196399098833898, 'psi': 0.822217009057935}-{'f1_val': 0.49377517461734277, 'auprc': 0.7451713891617436, 'loss_val': 0.6395729525959014, 'psi': 0.594333660435103}
[S16] START round=13 head_norm_before_train=0.990807 cos_to_last_merge=1.0000 (last merge round=12)
[S16] round=13 local utility u=0.000000 metrics={'f1_val': 0.37106619535311774, 'auprc': 0.7409505556784806, 'loss_val': 0.8835612335518943, 'psi': 0.5190199394832629}-{'f1_val': 0.37223546002834246, 'auprc': 0.7381214963498791, 'loss_val': 0.8184048552720057, 'psi': 0.5185898745569572}
[S17] START round=13 head_norm_before_train=1.510198 (no previous merge yet)
[S17] round=13 local utility u=0.000000 metrics={'f1_val': 0.3921082197911151, 'auprc': 0.6982306555481455, 'loss_val': 0.9318554307933038, 'psi': 0.5145571940939272}-{'f1_val': 0.38830121224503844, 'auprc': 0.7097294301560908, 'loss_val': 0.9099357383210531, 'psi': 0.5168724994094593}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:41917
[S2] sending update (kind=head size=1803 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1803) from S2
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.508762)
[S17] loaded HEAD from S2 (vec_in norm=1.508762)
[S17] cosine check vs S2: cos=-0.1045
[S17] DROPPED delta from S2 (cos=-0.1045 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:41917
[S3] sending update (kind=head size=1802 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1802) from S3
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.100035)
[S17] loaded HEAD from S3 (vec_in norm=1.100035)
[S17] cosine check vs S3: cos=-0.0274
[S17] DROPPED delta from S3 (cos=-0.0274 < 0.0)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:41903
[S8] sending update (kind=head size=1798 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1798) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.196089)
[S3] loaded HEAD from S8 (vec_in norm=1.196089)
[S3] cosine check vs S8: cos=0.8933
[S3] BUFFERED delta from S8 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S9] → sending delta(kind=head bytes=1805) to S16@127.0.0.1:41916
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1805 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1805) from S9
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.888382)
[S16] loaded HEAD from S9 (vec_in norm=1.888382)
[S16] cosine check vs S9: cos=0.4300
[S16] BUFFERED delta from S9 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:41916
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1798 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1798) from S11
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.370282)
[S16] loaded HEAD from S11 (vec_in norm=1.370282)
[S16] cosine check vs S11: cos=0.8078
[S16] BUFFERED delta from S11 (total buffered=2)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:41913
[S15] sending update (kind=head size=1800 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1800) from S15
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.297354)
[S13] loaded HEAD from S15 (vec_in norm=1.297354)
[S13] cosine check vs S15: cos=-0.0231
[S13] DROPPED delta from S15 (cos=-0.0231 < 0.0)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=13 metric=0.7007 head_norm=1.100035
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.692156e-01
[S3] stored merged vector for next round verification (round=13)
[S3] DEBUG after merge:  round=13 metric=0.6988 head_norm=1.117083 delta_norm=0.269216
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=13 metric=0.3711 head_norm=1.029459
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.015011e-01
[S16] stored merged vector for next round verification (round=13)
[S16] DEBUG after merge:  round=13 metric=0.4294 head_norm=1.038594 delta_norm=0.301501
[S16] aggregate: ACCEPT kept=['S9', 'S11'] (k=2/2) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.508762 cos_to_last_merge=0.9952 (last merge round=11)
[S2] round=14 local utility u=0.000000 metrics={'f1_val': 0.7015710590385817, 'auprc': 0.7463957913494104, 'loss_val': 0.310690963755498, 'psi': 0.7195009519629132}-{'f1_val': 0.7013101313728686, 'auprc': 0.7947202586990532, 'loss_val': 0.3543698122400668, 'psi': 0.7386741823033425}
[S3] START round=14 head_norm_before_train=1.117083 cos_to_last_merge=1.0000 (last merge round=13)
[S3] round=14 local utility u=0.004634 metrics={'f1_val': 0.7006767589460632, 'auprc': 0.9963274500407884, 'loss_val': 0.4889293620415073, 'psi': 0.8189370353839533}-{'f1_val': 0.7006809596653347, 'auprc': 0.9972555133506309, 'loss_val': 0.5010066733663575, 'psi': 0.8193107811394532}
[S4] START round=14 head_norm_before_train=1.664771 (no previous merge yet)
[S4] round=14 local utility u=0.817346 metrics={'f1_val': 0.943096504500917, 'auprc': 0.958622452496414, 'loss_val': 0.4492678016794494, 'psi': 0.9493068836991158}-{'f1_val': 0.6738662580745528, 'auprc': 0.9440210939518654, 'loss_val': 0.42477452784131675, 'psi': 0.7819281924254778}
[S5] START round=14 head_norm_before_train=1.731204 (no previous merge yet)
[S5] round=14 local utility u=1.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9894180096897305, 'loss_val': 0.24886089921577534, 'psi': 0.8159595629707076}-{'f1_val': 0.43592345592473125, 'auprc': 0.8550958375772594, 'loss_val': 0.6956798298319528, 'psi': 0.6035924085857425}
[S6] START round=14 head_norm_before_train=1.270449 cos_to_last_merge=0.8791 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.879
[S6] round=14 local utility u=0.589974 metrics={'f1_val': 0.6973293157685511, 'auprc': 0.9661604050313854, 'loss_val': 0.37459514640337366, 'psi': 0.8048617514736849}-{'f1_val': 0.6221124468974465, 'auprc': 0.7822149148045155, 'loss_val': 0.5514062759036424, 'psi': 0.6861534340602742}
[S7] START round=14 head_norm_before_train=1.301917 cos_to_last_merge=0.8601 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.860
[S7] round=14 local utility u=0.000000 metrics={'f1_val': 0.4860943201939888, 'auprc': 0.7799084273958965, 'loss_val': 0.8359642193783856, 'psi': 0.6036199630747519}-{'f1_val': 0.49586211546817094, 'auprc': 0.7806986722556346, 'loss_val': 0.8288339564565596, 'psi': 0.6097967381831564}
[S8] START round=14 head_norm_before_train=1.196089 cos_to_last_merge=0.9985 (last merge round=12)
[S8] round=14 local utility u=0.000000 metrics={'f1_val': 0.882489835270285, 'auprc': 0.9972682169480437, 'loss_val': 0.3584246278648852, 'psi': 0.9284011879413885}-{'f1_val': 0.9210944154537203, 'auprc': 0.9932459911270883, 'loss_val': 0.3659767792419436, 'psi': 0.9499550457230674}
[S9] START round=14 head_norm_before_train=1.888382 (no previous merge yet)
[S9] round=14 local utility u=0.000000 metrics={'f1_val': 0.9910040044536889, 'auprc': 0.9995104315863796, 'loss_val': 0.03682584070662263, 'psi': 0.9944065753067652}-{'f1_val': 0.9968525854255906, 'auprc': 0.9955669927482078, 'loss_val': 0.028444183931211994, 'psi': 0.9963383483546375}
[S10] START round=14 head_norm_before_train=1.309254 cos_to_last_merge=0.8344 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.834
[S10] round=14 local utility u=0.041466 metrics={'f1_val': 0.6919195890093373, 'auprc': 0.9919053115906404, 'loss_val': 0.25461945085309134, 'psi': 0.8119138780418585}-{'f1_val': 0.692599218489457, 'auprc': 0.9872041289381934, 'loss_val': 0.3275258655615552, 'psi': 0.8104411826689516}
[S11] START round=14 head_norm_before_train=1.370282 cos_to_last_merge=0.9978 (last merge round=12)
[S11] round=14 local utility u=0.050985 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9979963356583568, 'loss_val': 0.3833227704751508, 'psi': 0.8202146220154976}-{'f1_val': 0.7020007759458987, 'auprc': 0.9987441379747601, 'loss_val': 0.48937926953031574, 'psi': 0.8206981207574433}
[S13] START round=14 head_norm_before_train=1.496343 (no previous merge yet)
[S13] round=14 local utility u=0.000000 metrics={'f1_val': 0.6397697741436352, 'auprc': 0.6464179377889595, 'loss_val': 0.5908369478681883, 'psi': 0.6424290396017649}-{'f1_val': 0.625011588920155, 'auprc': 0.6857848171346208, 'loss_val': 0.587965970145813, 'psi': 0.6493208802059413}
[S14] START round=14 head_norm_before_train=1.520797 cos_to_last_merge=0.9985 (last merge round=12)
[S14] round=14 local utility u=0.911843 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9971519145699983, 'loss_val': 0.2768533259460728, 'psi': 0.9972049798514752}-{'f1_val': 0.7019269709023651, 'auprc': 0.996905713406999, 'loss_val': 0.3279204848938717, 'psi': 0.8199184679042186}
[S15] START round=14 head_norm_before_train=1.297354 cos_to_last_merge=0.9862 (last merge round=10)
[S15] round=14 local utility u=0.073794 metrics={'f1_val': 0.7263535998894183, 'auprc': 0.979300681118538, 'loss_val': 0.3940187323798858, 'psi': 0.8275324323810662}-{'f1_val': 0.7382855726294741, 'auprc': 0.9481141637006265, 'loss_val': 0.5196399098833898, 'psi': 0.822217009057935}
[S16] START round=14 head_norm_before_train=1.038594 cos_to_last_merge=1.0000 (last merge round=13)
[S16] round=14 local utility u=0.218285 metrics={'f1_val': 0.43270240696227324, 'auprc': 0.7466087827789836, 'loss_val': 0.8337838420600249, 'psi': 0.5582649572889573}-{'f1_val': 0.37106619535311774, 'auprc': 0.7409505556784806, 'loss_val': 0.8835612335518943, 'psi': 0.5190199394832629}
[S17] START round=14 head_norm_before_train=1.524525 (no previous merge yet)
[S17] round=14 local utility u=0.000000 metrics={'f1_val': 0.3513601245335272, 'auprc': 0.6821110902393781, 'loss_val': 0.9391899127278356, 'psi': 0.4836605108158676}-{'f1_val': 0.3921082197911151, 'auprc': 0.6982306555481455, 'loss_val': 0.9318554307933038, 'psi': 0.5145571940939272}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:41909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:41916
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:41917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:41914
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1795) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.742625)
[S16] loaded HEAD from S5 (vec_in norm=1.742625)
[S16] cosine check vs S5: cos=0.0006
[S16] BUFFERED delta from S5 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1797) from S4
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.689222)
[S14] loaded HEAD from S4 (vec_in norm=1.689222)
[S14] cosine check vs S4: cos=-0.0197
[S14] DROPPED delta from S4 (cos=-0.0197 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1796) from S10
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.340754)
[S8] loaded HEAD from S10 (vec_in norm=1.340754)
[S8] cosine check vs S10: cos=0.9492
[S8] BUFFERED delta from S10 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1802) from S6
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.292637)
[S17] loaded HEAD from S6 (vec_in norm=1.292637)
[S17] cosine check vs S6: cos=-0.0478
[S17] DROPPED delta from S6 (cos=-0.0478 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:41916
[S11] sending update (kind=head size=1799 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1799) from S11
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.408516)
[S16] loaded HEAD from S11 (vec_in norm=1.408516)
[S16] cosine check vs S11: cos=0.6789
[S16] BUFFERED delta from S11 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:41913
[S15] sending update (kind=head size=1803 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1803) from S15
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.343843)
[S13] loaded HEAD from S15 (vec_in norm=1.343843)
[S13] cosine check vs S15: cos=-0.0214
[S13] DROPPED delta from S15 (cos=-0.0214 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:41915
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S14] → sending delta(kind=head bytes=1806) to S11@127.0.0.1:41912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:41917
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1806 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1804 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1804) from S3
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.182646)
[S17] loaded HEAD from S3 (vec_in norm=1.182646)
[S17] cosine check vs S3: cos=-0.0057
[S17] DROPPED delta from S3 (cos=-0.0057 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1806) from S14
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.558865)
[S11] loaded HEAD from S14 (vec_in norm=1.558865)
[S11] cosine check vs S14: cos=0.9544
[S11] BUFFERED delta from S14 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1797) from S16
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.089940)
[S15] loaded HEAD from S16 (vec_in norm=1.089940)
[S15] cosine check vs S16: cos=0.6778
[S15] BUFFERED delta from S16 (total buffered=1)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=14 metric=0.7017 head_norm=1.408516
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.361251e-01
[S11] stored merged vector for next round verification (round=14)
[S11] DEBUG after merge:  round=14 metric=0.7017 head_norm=1.466708 delta_norm=0.236125
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=14 metric=0.8825 head_norm=1.241292
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.114581e-01
[S8] stored merged vector for next round verification (round=14)
[S8] DEBUG after merge:  round=14 metric=0.8782 head_norm=1.274558 delta_norm=0.211458
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=14 metric=0.7264 head_norm=1.343843
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.021036e-01
[S15] stored merged vector for next round verification (round=14)
[S15] DEBUG after merge:  round=14 metric=0.6952 head_norm=1.115721 delta_norm=0.502104
[S15] aggregate: ROLLBACK (f1_val pre=0.726 post=0.695 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=14 metric=0.4327 head_norm=1.089940
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.040480e-01
[S16] stored merged vector for next round verification (round=14)
[S16] DEBUG after merge:  round=14 metric=0.5458 head_norm=0.941546 delta_norm=0.604048
[S16] aggregate: ACCEPT kept=['S5', 'S11'] (k=2/2) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.554531 cos_to_last_merge=0.9912 (last merge round=11)
[S2] round=15 local utility u=0.242906 metrics={'f1_val': 0.6785723437757796, 'auprc': 0.9743783053845723, 'loss_val': 0.3708336606939343, 'psi': 0.7968947284192966}-{'f1_val': 0.7015710590385817, 'auprc': 0.7463957913494104, 'loss_val': 0.310690963755498, 'psi': 0.7195009519629132}
[S3] START round=15 head_norm_before_train=1.182646 cos_to_last_merge=0.9877 (last merge round=13)
[S3] round=15 local utility u=0.096143 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9984721192900863, 'loss_val': 0.30355476871591563, 'psi': 0.8198425699572143}-{'f1_val': 0.7006767589460632, 'auprc': 0.9963274500407884, 'loss_val': 0.4889293620415073, 'psi': 0.8189370353839533}
[S4] START round=15 head_norm_before_train=1.689222 (no previous merge yet)
[S4] round=15 local utility u=0.018312 metrics={'f1_val': 0.9432842462199569, 'auprc': 0.9613168693923577, 'loss_val': 0.42185390467049233, 'psi': 0.9504972954889173}-{'f1_val': 0.943096504500917, 'auprc': 0.958622452496414, 'loss_val': 0.4492678016794494, 'psi': 0.9493068836991158}
[S5] START round=15 head_norm_before_train=1.742625 (no previous merge yet)
[S5] round=15 local utility u=0.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9125697958858825, 'loss_val': 0.326901459449291, 'psi': 0.7852202774491683}-{'f1_val': 0.700320598491359, 'auprc': 0.9894180096897305, 'loss_val': 0.24886089921577534, 'psi': 0.8159595629707076}
[S6] START round=15 head_norm_before_train=1.292637 cos_to_last_merge=0.8729 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.873
[S6] round=15 local utility u=0.000000 metrics={'f1_val': 0.6867240008486695, 'auprc': 0.7626824571198264, 'loss_val': 0.4951870781632535, 'psi': 0.7171073833571322}-{'f1_val': 0.6973293157685511, 'auprc': 0.9661604050313854, 'loss_val': 0.37459514640337366, 'psi': 0.8048617514736849}
[S7] START round=15 head_norm_before_train=1.320899 cos_to_last_merge=0.8564 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.856
[S7] round=15 local utility u=0.097455 metrics={'f1_val': 0.5058622467578917, 'auprc': 0.7811755079309913, 'loss_val': 0.7634631649291814, 'psi': 0.6159875512271316}-{'f1_val': 0.4860943201939888, 'auprc': 0.7799084273958965, 'loss_val': 0.8359642193783856, 'psi': 0.6036199630747519}
[S8] START round=15 head_norm_before_train=1.274558 cos_to_last_merge=1.0000 (last merge round=14)
[S8] round=15 local utility u=0.386628 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9958728238034732, 'loss_val': 0.26416209506831, 'psi': 0.996160974482764}-{'f1_val': 0.882489835270285, 'auprc': 0.9972682169480437, 'loss_val': 0.3584246278648852, 'psi': 0.9284011879413885}
[S9] START round=15 head_norm_before_train=1.909893 (no previous merge yet)
[S9] round=15 local utility u=0.018864 metrics={'f1_val': 0.9956098104564366, 'auprc': 0.9993114781725851, 'loss_val': 0.026136580551228587, 'psi': 0.9970904775428959}-{'f1_val': 0.9910040044536889, 'auprc': 0.9995104315863796, 'loss_val': 0.03682584070662263, 'psi': 0.9944065753067652}
[S10] START round=15 head_norm_before_train=1.340754 cos_to_last_merge=0.8243 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.824
[S10] round=15 local utility u=0.352750 metrics={'f1_val': 0.8096009102333425, 'auprc': 0.9955431107448798, 'loss_val': 0.26612147560039495, 'psi': 0.8839777904379573}-{'f1_val': 0.6919195890093373, 'auprc': 0.9919053115906404, 'loss_val': 0.25461945085309134, 'psi': 0.8119138780418585}
[S11] START round=15 head_norm_before_train=1.466708 cos_to_last_merge=1.0000 (last merge round=14)
[S11] round=15 local utility u=0.006363 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9987546232809046, 'loss_val': 0.3743231823465984, 'psi': 0.8206630392913539}-{'f1_val': 0.7016934795869249, 'auprc': 0.9979963356583568, 'loss_val': 0.3833227704751508, 'psi': 0.8202146220154976}
[S13] START round=15 head_norm_before_train=1.512226 (no previous merge yet)
[S13] round=15 local utility u=0.000000 metrics={'f1_val': 0.5795694450213814, 'auprc': 0.5881326874800508, 'loss_val': 0.6904049062400026, 'psi': 0.5829947420048491}-{'f1_val': 0.6397697741436352, 'auprc': 0.6464179377889595, 'loss_val': 0.5908369478681883, 'psi': 0.6424290396017649}
[S14] START round=15 head_norm_before_train=1.558865 cos_to_last_merge=0.9956 (last merge round=12)
[S14] round=15 local utility u=0.040658 metrics={'f1_val': 0.9975788209428895, 'auprc': 0.9969001767761765, 'loss_val': 0.19681289628333434, 'psi': 0.9973073632762043}-{'f1_val': 0.997240356705793, 'auprc': 0.9971519145699983, 'loss_val': 0.2768533259460728, 'psi': 0.9972049798514752}
[S15] START round=15 head_norm_before_train=1.115721 cos_to_last_merge=1.0000 (last merge round=14)
[S15] round=15 local utility u=0.000000 metrics={'f1_val': 0.6998608526124928, 'auprc': 0.8461364310611693, 'loss_val': 0.4566517502714256, 'psi': 0.7583710839919634}-{'f1_val': 0.7263535998894183, 'auprc': 0.979300681118538, 'loss_val': 0.3940187323798858, 'psi': 0.8275324323810662}
[S16] START round=15 head_norm_before_train=0.941546 cos_to_last_merge=1.0000 (last merge round=14)
[S16] round=15 local utility u=0.047936 metrics={'f1_val': 0.45986511044643175, 'auprc': 0.7470069907840675, 'loss_val': 0.9020827797635451, 'psi': 0.574721862581486}-{'f1_val': 0.43270240696227324, 'auprc': 0.7466087827789836, 'loss_val': 0.8337838420600249, 'psi': 0.5582649572889573}
[S17] START round=15 head_norm_before_train=1.539593 (no previous merge yet)
[S17] round=15 local utility u=0.118737 metrics={'f1_val': 0.3877592934496993, 'auprc': 0.6843661910975388, 'loss_val': 0.9268754618384463, 'psi': 0.5064020525088351}-{'f1_val': 0.3513601245335272, 'auprc': 0.6821110902393781, 'loss_val': 0.9391899127278356, 'psi': 0.4836605108158676}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] → sending delta(kind=head bytes=1806) to S4@127.0.0.1:41904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:41909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:41917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:41917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:41903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:41916
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:41914
[S9] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1806 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1800) from S2
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.591085)
[S17] loaded HEAD from S2 (vec_in norm=1.591085)
[S17] cosine check vs S2: cos=-0.0989
[S17] DROPPED delta from S2 (cos=-0.0989 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1800) from S9
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.927966)
[S16] loaded HEAD from S9 (vec_in norm=1.927966)
[S16] cosine check vs S9: cos=0.3865
[S16] BUFFERED delta from S9 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1797) from S4
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.713591)
[S14] loaded HEAD from S4 (vec_in norm=1.713591)
[S14] cosine check vs S4: cos=-0.0205
[S14] DROPPED delta from S4 (cos=-0.0205 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1803) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.310533)
[S3] loaded HEAD from S8 (vec_in norm=1.310533)
[S3] cosine check vs S8: cos=0.8625
[S3] BUFFERED delta from S8 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1806) from S7
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.334810)
[S4] loaded HEAD from S7 (vec_in norm=1.334810)
[S4] cosine check vs S7: cos=-0.1414
[S4] DROPPED delta from S7 (cos=-0.1414 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1803) from S3
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.277088)
[S17] loaded HEAD from S3 (vec_in norm=1.277088)
[S17] cosine check vs S3: cos=-0.0222
[S17] DROPPED delta from S3 (cos=-0.0222 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1801) from S10
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.375057)
[S8] loaded HEAD from S10 (vec_in norm=1.375057)
[S8] cosine check vs S10: cos=0.9793
[S8] BUFFERED delta from S10 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] → sending delta(kind=head bytes=1805) to S16@127.0.0.1:41916
[S11] sending update (kind=head size=1805 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1805) from S11
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.500150)
[S16] loaded HEAD from S11 (vec_in norm=1.500150)
[S16] cosine check vs S11: cos=0.7535
[S16] BUFFERED delta from S11 (total buffered=2)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:41912
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:41914
[S14] sending update (kind=head size=1802 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1802) from S14
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.596632)
[S11] loaded HEAD from S14 (vec_in norm=1.596632)
[S11] cosine check vs S14: cos=0.9841
[S11] BUFFERED delta from S14 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:41915
[S17] sending update (kind=head size=1800 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1800) from S17
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.552542)
[S14] loaded HEAD from S17 (vec_in norm=1.552542)
[S14] cosine check vs S17: cos=0.9774
[S14] BUFFERED delta from S17 (total buffered=1)
[S16] sending update (kind=head size=1802 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1802) from S16
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.979921)
[S15] loaded HEAD from S16 (vec_in norm=0.979921)
[S15] cosine check vs S16: cos=0.6636
[S15] BUFFERED delta from S16 (total buffered=1)
[S6] ⇄ pheromone p=0.292 → S17@127.0.0.1:41917
[S5] ⇄ pheromone p=0.251 → S16@127.0.0.1:41916
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=15 metric=0.9964 head_norm=1.310533
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.403646e-01
[S8] stored merged vector for next round verification (round=15)
[S8] DEBUG after merge:  round=15 metric=0.9964 head_norm=1.335828 delta_norm=0.140365
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.315 → S3@127.0.0.1:41903
[S4] ⇄ pheromone p=0.316 → S14@127.0.0.1:41914
[S7] ⇄ pheromone p=0.166 → S4@127.0.0.1:41904
[S9] ⇄ pheromone p=0.130 → S16@127.0.0.1:41916
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=15 metric=0.7008 head_norm=1.277088
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.395889e-01
[S3] stored merged vector for next round verification (round=15)
[S3] DEBUG after merge:  round=15 metric=0.6942 head_norm=1.248561 delta_norm=0.339589
[S3] aggregate: ROLLBACK (f1_val pre=0.701 post=0.694 tol_abs=0.005 tol_rel=0.0)
[S3] ⇄ pheromone p=0.117 → S17@127.0.0.1:41917
[S2] ⇄ pheromone p=0.212 → S17@127.0.0.1:41917
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=15 metric=0.7019 head_norm=1.500150
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.463639e-01
[S11] stored merged vector for next round verification (round=15)
[S11] DEBUG after merge:  round=15 metric=0.7019 head_norm=1.542213 delta_norm=0.146364
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.194 → S16@127.0.0.1:41916
[S10] ⇄ pheromone p=0.254 → S8@127.0.0.1:41909
[S13] ⇄ pheromone p=0.117 → S2@127.0.0.1:41902
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=15 metric=0.9976 head_norm=1.596632
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.688690e-01
[S14] stored merged vector for next round verification (round=15)
[S14] DEBUG after merge:  round=15 metric=0.9972 head_norm=1.565661 delta_norm=0.168869
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.387 → S11@127.0.0.1:41912
[S17] ⇄ pheromone p=0.109 → S14@127.0.0.1:41914
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=15 metric=0.4599 head_norm=0.979921
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.617499e-01
[S16] stored merged vector for next round verification (round=15)
[S16] DEBUG after merge:  round=15 metric=0.5480 head_norm=1.024619 delta_norm=0.361750
[S16] aggregate: ACCEPT kept=['S9', 'S11'] (k=2/2) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.149 → S15@127.0.0.1:41915
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=15 metric=0.6999 head_norm=1.161119
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.467557e-01
[S15] stored merged vector for next round verification (round=15)
[S15] DEBUG after merge:  round=15 metric=0.7001 head_norm=0.977052 delta_norm=0.446756
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.279 → S13@127.0.0.1:41913
[S2] START round=16 head_norm_before_train=1.591085 cos_to_last_merge=0.9873 (last merge round=11)
[S2] round=16 local utility u=0.126833 metrics={'f1_val': 0.7015719066528542, 'auprc': 0.9886459521267916, 'loss_val': 0.2979684780423807, 'psi': 0.8164015248424292}-{'f1_val': 0.6785723437757796, 'auprc': 0.9743783053845723, 'loss_val': 0.3708336606939343, 'psi': 0.7968947284192966}
[S3] START round=16 head_norm_before_train=1.248561 cos_to_last_merge=1.0000 (last merge round=15)
[S3] round=16 local utility u=0.586134 metrics={'f1_val': 0.8991180112785024, 'auprc': 0.9980587715097738, 'loss_val': 0.32021820282856245, 'psi': 0.938694315371011}-{'f1_val': 0.7007562037352997, 'auprc': 0.9984721192900863, 'loss_val': 0.30355476871591563, 'psi': 0.8198425699572143}
[S4] START round=16 head_norm_before_train=1.713591 (no previous merge yet)
[S4] round=16 local utility u=0.033950 metrics={'f1_val': 0.9440343992893986, 'auprc': 0.9597602512893224, 'loss_val': 0.35378449629367964, 'psi': 0.9503247400893681}-{'f1_val': 0.9432842462199569, 'auprc': 0.9613168693923577, 'loss_val': 0.42185390467049233, 'psi': 0.9504972954889173}
[S5] START round=16 head_norm_before_train=1.756925 (no previous merge yet)
[S5] round=16 local utility u=0.202567 metrics={'f1_val': 0.7003221706489986, 'auprc': 0.9980279382140684, 'loss_val': 0.17815129200571686, 'psi': 0.8194044776750266}-{'f1_val': 0.700320598491359, 'auprc': 0.9125697958858825, 'loss_val': 0.326901459449291, 'psi': 0.7852202774491683}
[S6] START round=16 head_norm_before_train=1.312945 cos_to_last_merge=0.8667 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.867
[S6] round=16 local utility u=0.200069 metrics={'f1_val': 0.6699327666633278, 'auprc': 0.9110379686458614, 'loss_val': 0.439367401456085, 'psi': 0.7663748474563412}-{'f1_val': 0.6867240008486695, 'auprc': 0.7626824571198264, 'loss_val': 0.4951870781632535, 'psi': 0.7171073833571322}
[S7] START round=16 head_norm_before_train=1.334810 cos_to_last_merge=0.8537 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.854
[S7] round=16 local utility u=0.042217 metrics={'f1_val': 0.5238019980344565, 'auprc': 0.7815313588317884, 'loss_val': 0.7877344296861806, 'psi': 0.6268937423533893}-{'f1_val': 0.5058622467578917, 'auprc': 0.7811755079309913, 'loss_val': 0.7634631649291814, 'psi': 0.6159875512271316}
[S8] START round=16 head_norm_before_train=1.335828 cos_to_last_merge=1.0000 (last merge round=15)
[S8] round=16 local utility u=0.009863 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9953434425999572, 'loss_val': 0.24284885779490492, 'psi': 0.9959492220013577}-{'f1_val': 0.9963530749356245, 'auprc': 0.9958728238034732, 'loss_val': 0.26416209506831, 'psi': 0.996160974482764}
[S9] START round=16 head_norm_before_train=1.927966 (no previous merge yet)
[S9] round=16 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9954314311845438, 'loss_val': 0.023492024484899735, 'psi': 0.9964343199811032}-{'f1_val': 0.9956098104564366, 'auprc': 0.9993114781725851, 'loss_val': 0.026136580551228587, 'psi': 0.9970904775428959}
[S10] START round=16 head_norm_before_train=1.375057 cos_to_last_merge=0.8151 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.815
[S10] round=16 local utility u=0.247768 metrics={'f1_val': 0.8780371316057691, 'auprc': 0.9968159016090105, 'loss_val': 0.18502172421058058, 'psi': 0.9255486396070657}-{'f1_val': 0.8096009102333425, 'auprc': 0.9955431107448798, 'loss_val': 0.26612147560039495, 'psi': 0.8839777904379573}
[S11] START round=16 head_norm_before_train=1.542213 cos_to_last_merge=1.0000 (last merge round=15)
[S11] round=16 local utility u=0.020426 metrics={'f1_val': 0.7016282822309048, 'auprc': 0.9967824025026195, 'loss_val': 0.3257116336070914, 'psi': 0.8196899303395906}-{'f1_val': 0.7019353166316534, 'auprc': 0.9987546232809046, 'loss_val': 0.3743231823465984, 'psi': 0.8206630392913539}
[S13] START round=16 head_norm_before_train=1.524670 (no previous merge yet)
[S13] round=16 local utility u=0.091685 metrics={'f1_val': 0.5982545891031128, 'auprc': 0.5953268110586786, 'loss_val': 0.640728125220473, 'psi': 0.5970834778853391}-{'f1_val': 0.5795694450213814, 'auprc': 0.5881326874800508, 'loss_val': 0.6904049062400026, 'psi': 0.5829947420048491}
[S14] START round=16 head_norm_before_train=1.565661 cos_to_last_merge=1.0000 (last merge round=15)
[S14] round=16 local utility u=0.002173 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9971345372481005, 'loss_val': 0.19113819610857258, 'psi': 0.997198028922716}-{'f1_val': 0.9975788209428895, 'auprc': 0.9969001767761765, 'loss_val': 0.19681289628333434, 'psi': 0.9973073632762043}
[S15] START round=16 head_norm_before_train=0.977052 cos_to_last_merge=1.0000 (last merge round=15)
[S15] round=16 local utility u=0.991727 metrics={'f1_val': 0.9544130231019787, 'auprc': 0.98985878397437, 'loss_val': 0.4316777890865384, 'psi': 0.9685913274509352}-{'f1_val': 0.6998608526124928, 'auprc': 0.8461364310611693, 'loss_val': 0.4566517502714256, 'psi': 0.7583710839919634}
[S16] START round=16 head_norm_before_train=1.024619 cos_to_last_merge=1.0000 (last merge round=15)
[S16] round=16 local utility u=0.369782 metrics={'f1_val': 0.5550384711187911, 'auprc': 0.7677945792330159, 'loss_val': 0.7959226529575385, 'psi': 0.6401409143644811}-{'f1_val': 0.45986511044643175, 'auprc': 0.7470069907840675, 'loss_val': 0.9020827797635451, 'psi': 0.574721862581486}
[S17] START round=16 head_norm_before_train=1.552542 (no previous merge yet)
[S17] round=16 local utility u=0.050753 metrics={'f1_val': 0.39452463252067804, 'auprc': 0.687513744588213, 'loss_val': 0.8754038941530579, 'psi': 0.5117202773476921}-{'f1_val': 0.3877592934496993, 'auprc': 0.6843661910975388, 'loss_val': 0.9268754618384463, 'psi': 0.5064020525088351}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S7] → sending delta(kind=head bytes=1808) to S4@127.0.0.1:41904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:41902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:41912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:41915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:41909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:41914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:41917
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:41903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:41913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:41916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:41916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:41917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:41917
[S10] sending update (kind=head size=1804 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1804 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1808 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1799) from S2
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.620037)
[S17] loaded HEAD from S2 (vec_in norm=1.620037)
[S17] cosine check vs S2: cos=-0.0956
[S17] DROPPED delta from S2 (cos=-0.0956 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1803) from S3
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.327926)
[S17] loaded HEAD from S3 (vec_in norm=1.327926)
[S17] cosine check vs S3: cos=0.0032
[S17] BUFFERED delta from S3 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1802) from S6
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.335698)
[S17] loaded HEAD from S6 (vec_in norm=1.335698)
[S17] cosine check vs S6: cos=-0.0473
[S17] DROPPED delta from S6 (cos=-0.0473 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1797) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.766635)
[S16] loaded HEAD from S5 (vec_in norm=1.766635)
[S16] cosine check vs S5: cos=0.2108
[S16] BUFFERED delta from S5 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1804) from S10
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.412583)
[S8] loaded HEAD from S10 (vec_in norm=1.412583)
[S8] cosine check vs S10: cos=0.9885
[S8] BUFFERED delta from S10 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1804) from S16
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.074999)
[S15] loaded HEAD from S16 (vec_in norm=1.074999)
[S15] cosine check vs S16: cos=0.9549
[S15] BUFFERED delta from S16 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1801) from S11
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.569588)
[S16] loaded HEAD from S11 (vec_in norm=1.569588)
[S16] cosine check vs S11: cos=0.6642
[S16] BUFFERED delta from S11 (total buffered=2)
[S13] RECEIVED delta(kind=head bytes=1800) from S15
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.021945)
[S13] loaded HEAD from S15 (vec_in norm=1.021945)
[S13] cosine check vs S15: cos=-0.0710
[S13] DROPPED delta from S15 (cos=-0.0710 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1800) from S4
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.733979)
[S14] loaded HEAD from S4 (vec_in norm=1.733979)
[S14] cosine check vs S4: cos=-0.0162
[S14] DROPPED delta from S4 (cos=-0.0162 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1801) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.371322)
[S3] loaded HEAD from S8 (vec_in norm=1.371322)
[S3] cosine check vs S8: cos=0.9200
[S3] BUFFERED delta from S8 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1802) from S13
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.538019)
[S2] loaded HEAD from S13 (vec_in norm=1.538019)
[S2] cosine check vs S13: cos=0.9636
[S2] BUFFERED delta from S13 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1808) from S7
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.345321)
[S4] loaded HEAD from S7 (vec_in norm=1.345321)
[S4] cosine check vs S7: cos=-0.1399
[S4] DROPPED delta from S7 (cos=-0.1399 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1802) from S14
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.600111)
[S11] loaded HEAD from S14 (vec_in norm=1.600111)
[S11] cosine check vs S14: cos=0.9860
[S11] BUFFERED delta from S14 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:41914
[S17] sending update (kind=head size=1799 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1799) from S17
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.567274)
[S14] loaded HEAD from S17 (vec_in norm=1.567274)
[S14] cosine check vs S17: cos=0.9901
[S14] BUFFERED delta from S17 (total buffered=1)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=16 metric=0.8991 head_norm=1.327926
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.708426e-01
[S3] stored merged vector for next round verification (round=16)
[S3] DEBUG after merge:  round=16 metric=0.8459 head_norm=1.322346 delta_norm=0.270843
[S3] aggregate: ROLLBACK (f1_val pre=0.899 post=0.846 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=16 metric=0.9544 head_norm=1.021945
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.596110e-01
[S15] stored merged vector for next round verification (round=16)
[S15] DEBUG after merge:  round=16 metric=0.7756 head_norm=1.036591 delta_norm=0.159611
[S15] aggregate: ROLLBACK (f1_val pre=0.954 post=0.776 tol_abs=0.005 tol_rel=0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=16 metric=0.7016 head_norm=1.569588
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.333301e-01
[S11] stored merged vector for next round verification (round=16)
[S11] DEBUG after merge:  round=16 metric=0.8920 head_norm=1.579305 delta_norm=0.133330
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=16 metric=0.9964 head_norm=1.371322
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.077395e-01
[S8] stored merged vector for next round verification (round=16)
[S8] DEBUG after merge:  round=16 metric=0.9964 head_norm=1.387930 delta_norm=0.107739
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=16 metric=0.7016 head_norm=1.620037
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.167637e-01
[S2] stored merged vector for next round verification (round=16)
[S2] DEBUG after merge:  round=16 metric=0.7012 head_norm=1.564616 delta_norm=0.216764
[S2] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=16 metric=0.5550 head_norm=1.074999
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.280848e-01
[S16] stored merged vector for next round verification (round=16)
[S16] DEBUG after merge:  round=16 metric=0.7392 head_norm=1.019507 delta_norm=0.528085
[S16] aggregate: ACCEPT kept=['S5', 'S11'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=16 metric=0.9972 head_norm=1.600111
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.123438e-01
[S14] stored merged vector for next round verification (round=16)
[S14] DEBUG after merge:  round=16 metric=0.9972 head_norm=1.579788 delta_norm=0.112344
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=16 metric=0.3945 head_norm=1.567274
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.025459e+00
[S17] stored merged vector for next round verification (round=16)
[S17] DEBUG after merge:  round=16 metric=0.3543 head_norm=1.028738 delta_norm=1.025459
[S17] aggregate: ROLLBACK (f1_val pre=0.395 post=0.354 tol_abs=0.005 tol_rel=0.0)
[S2] START round=17 head_norm_before_train=1.564616 cos_to_last_merge=1.0000 (last merge round=16)
[S2] round=17 local utility u=0.004831 metrics={'f1_val': 0.7014928908785604, 'auprc': 0.9881099078306748, 'loss_val': 0.2862238323387639, 'psi': 0.8161396976594062}-{'f1_val': 0.7015719066528542, 'auprc': 0.9886459521267916, 'loss_val': 0.2979684780423807, 'psi': 0.8164015248424292}
[S3] START round=17 head_norm_before_train=1.322346 cos_to_last_merge=1.0000 (last merge round=16)
[S3] round=17 local utility u=0.075979 metrics={'f1_val': 0.9213745625496931, 'auprc': 0.9983592386069997, 'loss_val': 0.30270172454767036, 'psi': 0.9521684329726158}-{'f1_val': 0.8991180112785024, 'auprc': 0.9980587715097738, 'loss_val': 0.32021820282856245, 'psi': 0.938694315371011}
[S4] START round=17 head_norm_before_train=1.733979 (no previous merge yet)
[S4] round=17 local utility u=0.021855 metrics={'f1_val': 0.9444682478522735, 'auprc': 0.9575040103810906, 'loss_val': 0.305909639674227, 'psi': 0.9496825528638003}-{'f1_val': 0.9440343992893986, 'auprc': 0.9597602512893224, 'loss_val': 0.35378449629367964, 'psi': 0.9503247400893681}
[S5] START round=17 head_norm_before_train=1.766635 (no previous merge yet)
[S5] round=17 local utility u=0.000000 metrics={'f1_val': 0.6315362278273388, 'auprc': 0.8019436741121388, 'loss_val': 0.5141479026018161, 'psi': 0.6996992063412588}-{'f1_val': 0.7003221706489986, 'auprc': 0.9980279382140684, 'loss_val': 0.17815129200571686, 'psi': 0.8194044776750266}
[S6] START round=17 head_norm_before_train=1.335698 cos_to_last_merge=0.8613 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.861
[S6] round=17 local utility u=0.184949 metrics={'f1_val': 0.704081232577865, 'auprc': 0.9510997381852271, 'loss_val': 0.3945457215673552, 'psi': 0.8028886348208099}-{'f1_val': 0.6699327666633278, 'auprc': 0.9110379686458614, 'loss_val': 0.439367401456085, 'psi': 0.7663748474563412}
[S7] START round=17 head_norm_before_train=1.345321 cos_to_last_merge=0.8518 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.852
[S7] round=17 local utility u=0.091162 metrics={'f1_val': 0.5506844277194146, 'auprc': 0.7818572165060651, 'loss_val': 0.7676822714031348, 'psi': 0.6431535432340748}-{'f1_val': 0.5238019980344565, 'auprc': 0.7815313588317884, 'loss_val': 0.7877344296861806, 'psi': 0.6268937423533893}
[S8] START round=17 head_norm_before_train=1.387930 cos_to_last_merge=1.0000 (last merge round=16)
[S8] round=17 local utility u=0.000000 metrics={'f1_val': 0.715559899541955, 'auprc': 0.987065917436956, 'loss_val': 0.3155449613023223, 'psi': 0.8241623066999555}-{'f1_val': 0.9963530749356245, 'auprc': 0.9953434425999572, 'loss_val': 0.24284885779490492, 'psi': 0.9959492220013577}
[S9] START round=17 head_norm_before_train=1.947053 (no previous merge yet)
[S9] round=17 local utility u=0.000000 metrics={'f1_val': 0.9884538934865174, 'auprc': 0.9874070792812522, 'loss_val': 0.0460194748990529, 'psi': 0.9880351678044113}-{'f1_val': 0.9971029125121428, 'auprc': 0.9954314311845438, 'loss_val': 0.023492024484899735, 'psi': 0.9964343199811032}
[S10] START round=17 head_norm_before_train=1.412583 cos_to_last_merge=0.8064 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.806
[S10] round=17 local utility u=0.364288 metrics={'f1_val': 0.9953300781987324, 'auprc': 0.9942953540420986, 'loss_val': 0.15264183779873175, 'psi': 0.9949161885360789}-{'f1_val': 0.8780371316057691, 'auprc': 0.9968159016090105, 'loss_val': 0.18502172421058058, 'psi': 0.9255486396070657}
[S11] START round=17 head_norm_before_train=1.579305 cos_to_last_merge=1.0000 (last merge round=16)
[S11] round=17 local utility u=0.771605 metrics={'f1_val': 0.9554128031267195, 'auprc': 0.998012931635528, 'loss_val': 0.3089003196004048, 'psi': 0.9724528545302429}-{'f1_val': 0.7016282822309048, 'auprc': 0.9967824025026195, 'loss_val': 0.3257116336070914, 'psi': 0.8196899303395906}
[S13] START round=17 head_norm_before_train=1.538019 (no previous merge yet)
[S13] round=17 local utility u=0.030992 metrics={'f1_val': 0.57562104621564, 'auprc': 0.677276855524727, 'loss_val': 0.6887929380944291, 'psi': 0.6162833699392748}-{'f1_val': 0.5982545891031128, 'auprc': 0.5953268110586786, 'loss_val': 0.640728125220473, 'psi': 0.5970834778853391}
[S14] START round=17 head_norm_before_train=1.579788 cos_to_last_merge=1.0000 (last merge round=16)
[S14] round=17 local utility u=0.013305 metrics={'f1_val': 0.9978938390605482, 'auprc': 0.9970102071780322, 'loss_val': 0.16807684191104466, 'psi': 0.9975403863075418}-{'f1_val': 0.997240356705793, 'auprc': 0.9971345372481005, 'loss_val': 0.19113819610857258, 'psi': 0.997198028922716}
[S15] START round=17 head_norm_before_train=1.036591 cos_to_last_merge=1.0000 (last merge round=16)
[S15] round=17 local utility u=0.000000 metrics={'f1_val': 0.7010713433702593, 'auprc': 0.8628596952303026, 'loss_val': 0.48941114982097844, 'psi': 0.7657866841142766}-{'f1_val': 0.9544130231019787, 'auprc': 0.98985878397437, 'loss_val': 0.4316777890865384, 'psi': 0.9685913274509352}
[S16] START round=17 head_norm_before_train=1.019507 cos_to_last_merge=1.0000 (last merge round=16)
[S16] round=17 local utility u=0.630603 metrics={'f1_val': 0.7517141186942429, 'auprc': 0.785662056057891, 'loss_val': 0.7683722354612411, 'psi': 0.7652932936397021}-{'f1_val': 0.5550384711187911, 'auprc': 0.7677945792330159, 'loss_val': 0.7959226529575385, 'psi': 0.6401409143644811}
[S17] START round=17 head_norm_before_train=1.028738 cos_to_last_merge=1.0000 (last merge round=16)
[S17] round=17 local utility u=0.000000 metrics={'f1_val': 0.3541619719243362, 'auprc': 0.6931606468752227, 'loss_val': 0.8812060792344262, 'psi': 0.4897614419046908}-{'f1_val': 0.39452463252067804, 'auprc': 0.687513744588213, 'loss_val': 0.8754038941530579, 'psi': 0.5117202773476921}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] → sending delta(kind=head bytes=1804) to S2@127.0.0.1:41902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S3] → sending delta(kind=head bytes=1807) to S17@127.0.0.1:41917
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:41904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:41916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:41914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:41912
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:41917
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:41915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:41917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:41909
[S6] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1804 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1807 to 1 peers)
[S13] sending update (kind=head size=1804 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1797) from S6
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.359957)
[S17] loaded HEAD from S6 (vec_in norm=1.359957)
[S17] cosine check vs S6: cos=0.0296
[S17] BUFFERED delta from S6 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1801) from S16
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.053148)
[S15] loaded HEAD from S16 (vec_in norm=1.053148)
[S15] cosine check vs S16: cos=0.8517
[S15] BUFFERED delta from S16 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1802) from S2
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.588235)
[S17] loaded HEAD from S2 (vec_in norm=1.588235)
[S17] cosine check vs S2: cos=-0.1472
[S17] DROPPED delta from S2 (cos=-0.1472 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1807) from S3
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.399342)
[S17] loaded HEAD from S3 (vec_in norm=1.399342)
[S17] cosine check vs S3: cos=0.6351
[S17] BUFFERED delta from S3 (total buffered=2)
[S16] RECEIVED delta(kind=head bytes=1804) from S11
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.602516)
[S16] loaded HEAD from S11 (vec_in norm=1.602516)
[S16] cosine check vs S11: cos=0.7386
[S16] BUFFERED delta from S11 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1801) from S4
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.753272)
[S14] loaded HEAD from S4 (vec_in norm=1.753272)
[S14] cosine check vs S4: cos=-0.0126
[S14] DROPPED delta from S4 (cos=-0.0126 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1799) from S10
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.450038)
[S8] loaded HEAD from S10 (vec_in norm=1.450038)
[S8] cosine check vs S10: cos=0.9913
[S8] BUFFERED delta from S10 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1804) from S13
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.551831)
[S2] loaded HEAD from S13 (vec_in norm=1.551831)
[S2] cosine check vs S13: cos=0.9872
[S2] BUFFERED delta from S13 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1802) from S7
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.357496)
[S4] loaded HEAD from S7 (vec_in norm=1.357496)
[S4] cosine check vs S7: cos=-0.1387
[S4] DROPPED delta from S7 (cos=-0.1387 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1797) from S14
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.612870)
[S11] loaded HEAD from S14 (vec_in norm=1.612870)
[S11] cosine check vs S14: cos=0.9899
[S11] BUFFERED delta from S14 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=17 metric=0.7156 head_norm=1.424041
[S8] _apply_head_vector_avg (torch): Δ‖w‖=9.584675e-02
[S8] stored merged vector for next round verification (round=17)
[S8] DEBUG after merge:  round=17 metric=0.7144 head_norm=1.433898 delta_norm=0.095847
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=17 metric=0.7517 head_norm=1.053148
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.440587e-01
[S16] stored merged vector for next round verification (round=17)
[S16] DEBUG after merge:  round=17 metric=0.8405 head_norm=1.242010 delta_norm=0.544059
[S16] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=17 metric=0.9554 head_norm=1.602516
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.144854e-01
[S11] stored merged vector for next round verification (round=17)
[S11] DEBUG after merge:  round=17 metric=0.9568 head_norm=1.603620 delta_norm=0.114485
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=17 metric=0.7015 head_norm=1.588235
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.269757e-01
[S2] stored merged vector for next round verification (round=17)
[S2] DEBUG after merge:  round=17 metric=0.7015 head_norm=1.564996 delta_norm=0.126976
[S2] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=17 metric=0.3542 head_norm=1.056985
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.400617e-01
[S17] stored merged vector for next round verification (round=17)
[S17] DEBUG after merge:  round=17 metric=0.3535 head_norm=0.884663 delta_norm=0.540062
[S17] aggregate: ACCEPT kept=['S6', 'S3'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=17 metric=0.7011 head_norm=1.085371
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.915716e-01
[S15] stored merged vector for next round verification (round=17)
[S15] DEBUG after merge:  round=17 metric=0.7011 head_norm=1.028865 delta_norm=0.291572
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.564996 cos_to_last_merge=1.0000 (last merge round=17)
[S2] round=18 local utility u=0.000000 metrics={'f1_val': 0.7014918162305126, 'auprc': 0.9650628700082817, 'loss_val': 0.2930996417736049, 'psi': 0.8069202377416202}-{'f1_val': 0.7014928908785604, 'auprc': 0.9881099078306748, 'loss_val': 0.2862238323387639, 'psi': 0.8161396976594062}
[S3] START round=18 head_norm_before_train=1.399342 cos_to_last_merge=0.9932 (last merge round=16)
[S3] round=18 local utility u=0.070702 metrics={'f1_val': 0.9312725926001848, 'auprc': 0.9979873420905883, 'loss_val': 0.21957077845948078, 'psi': 0.9579584923963461}-{'f1_val': 0.9213745625496931, 'auprc': 0.9983592386069997, 'loss_val': 0.30270172454767036, 'psi': 0.9521684329726158}
[S4] START round=18 head_norm_before_train=1.753272 (no previous merge yet)
[S4] round=18 local utility u=0.015144 metrics={'f1_val': 0.9459552162166779, 'auprc': 0.9580230426075869, 'loss_val': 0.28610051272872244, 'psi': 0.9507823467730415}-{'f1_val': 0.9444682478522735, 'auprc': 0.9575040103810906, 'loss_val': 0.305909639674227, 'psi': 0.9496825528638003}
[S5] START round=18 head_norm_before_train=1.770819 (no previous merge yet)
[S5] round=18 local utility u=0.132660 metrics={'f1_val': 0.6441748057921102, 'auprc': 0.8491046586754996, 'loss_val': 0.4661431369200851, 'psi': 0.7261467469454659}-{'f1_val': 0.6315362278273388, 'auprc': 0.8019436741121388, 'loss_val': 0.5141479026018161, 'psi': 0.6996992063412588}
[S6] START round=18 head_norm_before_train=1.359957 cos_to_last_merge=0.8555 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.855
[S6] round=18 local utility u=0.000000 metrics={'f1_val': 0.6777094100212386, 'auprc': 0.9124718468617987, 'loss_val': 0.40541166150342256, 'psi': 0.7716143847574626}-{'f1_val': 0.704081232577865, 'auprc': 0.9510997381852271, 'loss_val': 0.3945457215673552, 'psi': 0.8028886348208099}
[S7] START round=18 head_norm_before_train=1.357496 cos_to_last_merge=0.8496 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.850
[S7] round=18 local utility u=0.816750 metrics={'f1_val': 0.6904391229271586, 'auprc': 0.8909796994783452, 'loss_val': 0.30007700360949463, 'psi': 0.7706553535476333}-{'f1_val': 0.5506844277194146, 'auprc': 0.7818572165060651, 'loss_val': 0.7676822714031348, 'psi': 0.6431535432340748}
[S8] START round=18 head_norm_before_train=1.433898 cos_to_last_merge=1.0000 (last merge round=17)
[S8] round=18 local utility u=0.915957 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9952644437289546, 'loss_val': 0.19298513536228268, 'psi': 0.9959176224529567}-{'f1_val': 0.715559899541955, 'auprc': 0.987065917436956, 'loss_val': 0.3155449613023223, 'psi': 0.8241623066999555}
[S9] START round=18 head_norm_before_train=1.967741 (no previous merge yet)
[S9] round=18 local utility u=0.047029 metrics={'f1_val': 0.9956098104564366, 'auprc': 0.9966922931546087, 'loss_val': 0.02275184066907684, 'psi': 0.9960428035357054}-{'f1_val': 0.9884538934865174, 'auprc': 0.9874070792812522, 'loss_val': 0.0460194748990529, 'psi': 0.9880351678044113}
[S10] START round=18 head_norm_before_train=1.450038 cos_to_last_merge=0.7982 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.798
[S10] round=18 local utility u=0.018270 metrics={'f1_val': 0.9957455607450773, 'auprc': 0.9955412154879779, 'loss_val': 0.12233139042213768, 'psi': 0.9956638226422374}-{'f1_val': 0.9953300781987324, 'auprc': 0.9942953540420986, 'loss_val': 0.15264183779873175, 'psi': 0.9949161885360789}
[S11] START round=18 head_norm_before_train=1.603620 cos_to_last_merge=1.0000 (last merge round=17)
[S11] round=18 local utility u=0.020138 metrics={'f1_val': 0.9566030719536167, 'auprc': 0.997818479668738, 'loss_val': 0.27518349633884126, 'psi': 0.9730892350396653}-{'f1_val': 0.9554128031267195, 'auprc': 0.998012931635528, 'loss_val': 0.3089003196004048, 'psi': 0.9724528545302429}
[S13] START round=18 head_norm_before_train=1.551831 (no previous merge yet)
[S13] round=18 local utility u=0.128451 metrics={'f1_val': 0.6134034162191239, 'auprc': 0.6618265830300999, 'loss_val': 0.6122344430655743, 'psi': 0.6327726829435143}-{'f1_val': 0.57562104621564, 'auprc': 0.677276855524727, 'loss_val': 0.6887929380944291, 'psi': 0.6162833699392748}
[S14] START round=18 head_norm_before_train=1.612870 cos_to_last_merge=0.9994 (last merge round=16)
[S14] round=18 local utility u=0.013619 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9969382235449296, 'loss_val': 0.13670246871020425, 'psi': 0.9971195034414477}-{'f1_val': 0.9978938390605482, 'auprc': 0.9970102071780322, 'loss_val': 0.16807684191104466, 'psi': 0.9975403863075418}
[S15] START round=18 head_norm_before_train=1.028865 cos_to_last_merge=1.0000 (last merge round=17)
[S15] round=18 local utility u=0.000000 metrics={'f1_val': 0.6974180377932794, 'auprc': 0.8458987418141033, 'loss_val': 0.507629656541102, 'psi': 0.7568103194016089}-{'f1_val': 0.7010713433702593, 'auprc': 0.8628596952303026, 'loss_val': 0.48941114982097844, 'psi': 0.7657866841142766}
[S16] START round=18 head_norm_before_train=1.242010 cos_to_last_merge=1.0000 (last merge round=17)
[S16] round=18 local utility u=0.163941 metrics={'f1_val': 0.7696918422924689, 'auprc': 0.8428346003785424, 'loss_val': 0.719874361825178, 'psi': 0.7989489455268983}-{'f1_val': 0.7517141186942429, 'auprc': 0.785662056057891, 'loss_val': 0.7683722354612411, 'psi': 0.7652932936397021}
[S17] START round=18 head_norm_before_train=0.884663 cos_to_last_merge=1.0000 (last merge round=17)
[S17] round=18 local utility u=0.179321 metrics={'f1_val': 0.35340325427492914, 'auprc': 0.8330422610291196, 'loss_val': 0.9376570163157383, 'psi': 0.5452588569766054}-{'f1_val': 0.3541619719243362, 'auprc': 0.6931606468752227, 'loss_val': 0.8812060792344262, 'psi': 0.4897614419046908}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:41916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:41903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:41916
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:41917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:41914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S11@127.0.0.1:41912
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:41915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:41904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:41902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:41909
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:41916
[S11] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S4] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1798) from S3
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.480853)
[S17] loaded HEAD from S3 (vec_in norm=1.480853)
[S17] cosine check vs S3: cos=0.7723
[S17] BUFFERED delta from S3 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1802) from S10
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.485493)
[S8] loaded HEAD from S10 (vec_in norm=1.485493)
[S8] cosine check vs S10: cos=0.9932
[S8] BUFFERED delta from S10 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1802) from S11
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.629273)
[S16] loaded HEAD from S11 (vec_in norm=1.629273)
[S16] cosine check vs S11: cos=0.9400
[S16] BUFFERED delta from S11 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1803) from S9
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.978380)
[S16] loaded HEAD from S9 (vec_in norm=1.978380)
[S16] cosine check vs S9: cos=0.1356
[S16] BUFFERED delta from S9 (total buffered=2)
[S16] RECEIVED delta(kind=head bytes=1800) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.777019)
[S16] loaded HEAD from S5 (vec_in norm=1.777019)
[S16] cosine check vs S5: cos=0.2636
[S16] BUFFERED delta from S5 (total buffered=3)
[S14] RECEIVED delta(kind=head bytes=1803) from S4
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.775845)
[S14] loaded HEAD from S4 (vec_in norm=1.775845)
[S14] cosine check vs S4: cos=-0.0131
[S14] DROPPED delta from S4 (cos=-0.0131 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1797) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.468066)
[S3] loaded HEAD from S8 (vec_in norm=1.468066)
[S3] cosine check vs S8: cos=0.9156
[S3] BUFFERED delta from S8 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1800) from S16
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.268474)
[S15] loaded HEAD from S16 (vec_in norm=1.268474)
[S15] cosine check vs S16: cos=0.8394
[S15] BUFFERED delta from S16 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1798) from S13
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.564229)
[S2] loaded HEAD from S13 (vec_in norm=1.564229)
[S2] cosine check vs S13: cos=0.9941
[S2] BUFFERED delta from S13 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1800) from S7
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.372008)
[S4] loaded HEAD from S7 (vec_in norm=1.372008)
[S4] cosine check vs S7: cos=-0.1362
[S4] DROPPED delta from S7 (cos=-0.1362 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1803) from S14
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.643610)
[S11] loaded HEAD from S14 (vec_in norm=1.643610)
[S11] cosine check vs S14: cos=0.9957
[S11] BUFFERED delta from S14 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:41914
[S17] sending update (kind=head size=1801 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1801) from S17
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=0.924977)
[S14] loaded HEAD from S17 (vec_in norm=0.924977)
[S14] cosine check vs S17: cos=0.5085
[S14] BUFFERED delta from S17 (total buffered=1)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=18 metric=0.7015 head_norm=1.588560
[S2] _apply_head_vector_avg (torch): Δ‖w‖=8.642267e-02
[S2] stored merged vector for next round verification (round=18)
[S2] DEBUG after merge:  round=18 metric=0.7015 head_norm=1.574071 delta_norm=0.086423
[S2] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=18 metric=0.9313 head_norm=1.480853
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.028846e-01
[S3] stored merged vector for next round verification (round=18)
[S3] DEBUG after merge:  round=18 metric=0.9302 head_norm=1.443029 delta_norm=0.302885
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=18 metric=0.9972 head_norm=1.643610
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.090389e-01
[S14] stored merged vector for next round verification (round=18)
[S14] DEBUG after merge:  round=18 metric=0.9970 head_norm=1.129506 delta_norm=0.709039
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=18 metric=0.9566 head_norm=1.629273
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.651989e-02
[S11] stored merged vector for next round verification (round=18)
[S11] DEBUG after merge:  round=18 metric=0.9576 head_norm=1.634668 delta_norm=0.076520
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=18 metric=0.7697 head_norm=1.268474
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.894053e-01
[S16] stored merged vector for next round verification (round=18)
[S16] DEBUG after merge:  round=18 metric=0.8018 head_norm=1.082437 delta_norm=0.389405
[S16] aggregate: ACCEPT kept=['S11', 'S9', 'S5'] (k=3/3) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=18 metric=0.9964 head_norm=1.468066
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.682525e-02
[S8] stored merged vector for next round verification (round=18)
[S8] DEBUG after merge:  round=18 metric=0.9964 head_norm=1.474251 delta_norm=0.086825
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=18 metric=0.6974 head_norm=1.080227
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.448381e-01
[S15] stored merged vector for next round verification (round=18)
[S15] DEBUG after merge:  round=18 metric=0.6957 head_norm=1.126519 delta_norm=0.344838
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=18 metric=0.3534 head_norm=0.924977
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.828916e-01
[S17] stored merged vector for next round verification (round=18)
[S17] DEBUG after merge:  round=18 metric=0.3535 head_norm=1.136253 delta_norm=0.482892
[S17] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.574071 cos_to_last_merge=1.0000 (last merge round=18)
[S2] round=19 local utility u=0.000000 metrics={'f1_val': 0.7014918162305126, 'auprc': 0.791044334969544, 'loss_val': 0.29851656862914355, 'psi': 0.737312823726125}-{'f1_val': 0.7014918162305126, 'auprc': 0.9650628700082817, 'loss_val': 0.2930996417736049, 'psi': 0.8069202377416202}
[S3] START round=19 head_norm_before_train=1.443029 cos_to_last_merge=1.0000 (last merge round=18)
[S3] round=19 local utility u=0.183961 metrics={'f1_val': 0.9870139580698694, 'auprc': 0.9971276513060774, 'loss_val': 0.18351771725798244, 'psi': 0.9910594353643525}-{'f1_val': 0.9312725926001848, 'auprc': 0.9979873420905883, 'loss_val': 0.21957077845948078, 'psi': 0.9579584923963461}
[S4] START round=19 head_norm_before_train=1.775845 (no previous merge yet)
[S4] round=19 local utility u=0.058027 metrics={'f1_val': 0.9548863895027271, 'auprc': 0.9761801722924299, 'loss_val': 0.27810476818806124, 'psi': 0.9634039026186083}-{'f1_val': 0.9459552162166779, 'auprc': 0.9580230426075869, 'loss_val': 0.28610051272872244, 'psi': 0.9507823467730415}
[S5] START round=19 head_norm_before_train=1.777019 (no previous merge yet)
[S5] round=19 local utility u=0.000000 metrics={'f1_val': 0.6207519795913412, 'auprc': 0.8372754917542697, 'loss_val': 0.5395121638113181, 'psi': 0.7073613844565126}-{'f1_val': 0.6441748057921102, 'auprc': 0.8491046586754996, 'loss_val': 0.4661431369200851, 'psi': 0.7261467469454659}
[S6] START round=19 head_norm_before_train=1.381503 cos_to_last_merge=0.8502 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.850
[S6] round=19 local utility u=0.000000 metrics={'f1_val': 0.6712296501718665, 'auprc': 0.7636288814203632, 'loss_val': 0.4746653208727337, 'psi': 0.7081893426712652}-{'f1_val': 0.6777094100212386, 'auprc': 0.9124718468617987, 'loss_val': 0.40541166150342256, 'psi': 0.7716143847574626}
[S7] START round=19 head_norm_before_train=1.372008 cos_to_last_merge=0.8470 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.847
[S7] round=19 local utility u=0.000000 metrics={'f1_val': 0.4168024298025348, 'auprc': 0.7809162997671895, 'loss_val': 1.1386320210292924, 'psi': 0.5624479777883966}-{'f1_val': 0.6904391229271586, 'auprc': 0.8909796994783452, 'loss_val': 0.30007700360949463, 'psi': 0.7706553535476333}
[S8] START round=19 head_norm_before_train=1.474251 cos_to_last_merge=1.0000 (last merge round=18)
[S8] round=19 local utility u=0.010634 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9947865971007819, 'loss_val': 0.16938358788199662, 'psi': 0.9956365008804045}-{'f1_val': 0.9963530749356245, 'auprc': 0.9952644437289546, 'loss_val': 0.19298513536228268, 'psi': 0.9959176224529567}
[S9] START round=19 head_norm_before_train=1.978380 (no previous merge yet)
[S9] round=19 local utility u=0.004345 metrics={'f1_val': 0.9956098104564366, 'auprc': 0.9995503114843948, 'loss_val': 0.02263608658425487, 'psi': 0.9971860108676198}-{'f1_val': 0.9956098104564366, 'auprc': 0.9966922931546087, 'loss_val': 0.02275184066907684, 'psi': 0.9960428035357054}
[S10] START round=19 head_norm_before_train=1.485493 cos_to_last_merge=0.7910 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.791
[S10] round=19 local utility u=0.010090 metrics={'f1_val': 0.9950444545353663, 'auprc': 0.9957871868657031, 'loss_val': 0.09868311074319513, 'psi': 0.995341547467501}-{'f1_val': 0.9957455607450773, 'auprc': 0.9955412154879779, 'loss_val': 0.12233139042213768, 'psi': 0.9956638226422374}
[S11] START round=19 head_norm_before_train=1.634668 cos_to_last_merge=1.0000 (last merge round=18)
[S11] round=19 local utility u=0.027997 metrics={'f1_val': 0.9582699758185035, 'auprc': 0.9982615170844747, 'loss_val': 0.23052024939045898, 'psi': 0.9742665923248921}-{'f1_val': 0.9566030719536167, 'auprc': 0.997818479668738, 'loss_val': 0.27518349633884126, 'psi': 0.9730892350396653}
[S13] START round=19 head_norm_before_train=1.564229 (no previous merge yet)
[S13] round=19 local utility u=0.000000 metrics={'f1_val': 0.5954343589157918, 'auprc': 0.671433943180626, 'loss_val': 0.6701087368109935, 'psi': 0.6258341926217255}-{'f1_val': 0.6134034162191239, 'auprc': 0.6618265830300999, 'loss_val': 0.6122344430655743, 'psi': 0.6327726829435143}
[S14] START round=19 head_norm_before_train=1.129506 cos_to_last_merge=1.0000 (last merge round=18)
[S14] round=19 local utility u=0.000000 metrics={'f1_val': 0.9968419739193168, 'auprc': 0.9970769554636522, 'loss_val': 0.22500029499108365, 'psi': 0.996935966537051}-{'f1_val': 0.997240356705793, 'auprc': 0.9969382235449296, 'loss_val': 0.13670246871020425, 'psi': 0.9971195034414477}
[S15] START round=19 head_norm_before_train=1.126519 cos_to_last_merge=1.0000 (last merge round=18)
[S15] round=19 local utility u=0.260461 metrics={'f1_val': 0.7008096757232372, 'auprc': 0.9871854537719176, 'loss_val': 0.4309172740576532, 'psi': 0.8153599869427093}-{'f1_val': 0.6974180377932794, 'auprc': 0.8458987418141033, 'loss_val': 0.507629656541102, 'psi': 0.7568103194016089}
[S16] START round=19 head_norm_before_train=1.082437 cos_to_last_merge=1.0000 (last merge round=18)
[S16] round=19 local utility u=0.112444 metrics={'f1_val': 0.8239473146847489, 'auprc': 0.8206663285424708, 'loss_val': 0.7540148230327215, 'psi': 0.8226349202278377}-{'f1_val': 0.7696918422924689, 'auprc': 0.8428346003785424, 'loss_val': 0.719874361825178, 'psi': 0.7989489455268983}
[S17] START round=19 head_norm_before_train=1.136253 cos_to_last_merge=1.0000 (last merge round=18)
[S17] round=19 local utility u=0.003953 metrics={'f1_val': 0.3534424412471507, 'auprc': 0.8355610395814065, 'loss_val': 0.9375428753928066, 'psi': 0.546289880580853}-{'f1_val': 0.35340325427492914, 'auprc': 0.8330422610291196, 'loss_val': 0.9376570163157383, 'psi': 0.5452588569766054}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:41914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:41916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:41903
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:41909
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:41915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S15] → sending delta(kind=head bytes=1806) to S13@127.0.0.1:41913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:41917
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S11] → sending delta(kind=head bytes=1806) to S16@127.0.0.1:41916
[S11] sending update (kind=head size=1806 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1806 to 1 peers)
[S16] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1794 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1802) from S16
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.123343)
[S15] loaded HEAD from S16 (vec_in norm=1.123343)
[S15] cosine check vs S16: cos=0.9778
[S15] BUFFERED delta from S16 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1802) from S3
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.504968)
[S17] loaded HEAD from S3 (vec_in norm=1.504968)
[S17] cosine check vs S3: cos=0.9301
[S17] BUFFERED delta from S3 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1806) from S11
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.664298)
[S16] loaded HEAD from S11 (vec_in norm=1.664298)
[S16] cosine check vs S11: cos=0.8065
[S16] BUFFERED delta from S11 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1799) from S9
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.987782)
[S16] loaded HEAD from S9 (vec_in norm=1.987782)
[S16] cosine check vs S9: cos=0.3391
[S16] BUFFERED delta from S9 (total buffered=2)
[S13] RECEIVED delta(kind=head bytes=1806) from S15
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.166684)
[S13] loaded HEAD from S15 (vec_in norm=1.166684)
[S13] cosine check vs S15: cos=-0.0964
[S13] DROPPED delta from S15 (cos=-0.0964 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1794) from S4
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.795242)
[S14] loaded HEAD from S4 (vec_in norm=1.795242)
[S14] cosine check vs S4: cos=-0.0163
[S14] DROPPED delta from S4 (cos=-0.0163 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1797) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.513273)
[S3] loaded HEAD from S8 (vec_in norm=1.513273)
[S3] cosine check vs S8: cos=0.9592
[S3] BUFFERED delta from S8 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1796) from S10
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.517132)
[S8] loaded HEAD from S10 (vec_in norm=1.517132)
[S8] cosine check vs S10: cos=0.9938
[S8] BUFFERED delta from S10 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:41914
[S17] sending update (kind=head size=1802 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1802) from S17
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.171056)
[S14] loaded HEAD from S17 (vec_in norm=1.171056)
[S14] cosine check vs S17: cos=0.5786
[S14] BUFFERED delta from S17 (total buffered=1)
[S13] r=20 psi=0.626 u=0.0000 p_local=0.0819 f1=0.595 auprc=0.671 bytes=16178
[S6] r=20 psi=0.708 u=0.0000 p_local=0.1638 f1=0.671 auprc=0.764 bytes=12608
[S5] r=20 psi=0.707 u=0.0000 p_local=0.1446 f1=0.621 auprc=0.837 bytes=14373
[S2] r=20 psi=0.737 u=0.0000 p_local=0.1003 f1=0.701 auprc=0.791 bytes=17983
[S7] r=20 psi=0.562 u=0.0000 p_local=0.2145 f1=0.417 auprc=0.781 bytes=14402
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=19 metric=0.9968 head_norm=1.175809
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.386223e-01
[S14] stored merged vector for next round verification (round=19)
[S14] DEBUG after merge:  round=19 metric=0.9935 head_norm=1.042514 delta_norm=0.538622
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S14] r=20 psi=0.997 u=0.0000 p_local=0.1627 f1=0.997 auprc=0.997 bytes=21592
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=19 metric=0.9870 head_norm=1.504968
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.154724e-01
[S3] stored merged vector for next round verification (round=19)
[S3] DEBUG after merge:  round=19 metric=0.9836 head_norm=1.493665 delta_norm=0.215472
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S3] r=20 psi=0.991 u=0.1840 p_local=0.1659 f1=0.987 auprc=0.997 bytes=23406
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=19 metric=0.8239 head_norm=1.123343
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.712837e-01
[S16] stored merged vector for next round verification (round=19)
[S16] DEBUG after merge:  round=19 metric=0.8200 head_norm=1.127106 delta_norm=0.371284
[S16] aggregate: ACCEPT kept=['S11', 'S9'] (k=2/2) mode=median trim_p=0.1
[S16] r=20 psi=0.823 u=0.1124 p_local=0.2284 f1=0.824 auprc=0.821 bytes=19793
[S10] r=20 psi=0.995 u=0.0101 p_local=0.1810 f1=0.995 auprc=0.996 bytes=21587
[S4] r=20 psi=0.963 u=0.0580 p_local=0.1498 f1=0.955 auprc=0.976 bytes=23391
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=19 metric=0.9962 head_norm=1.513273
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.404659e-02
[S8] stored merged vector for next round verification (round=19)
[S8] DEBUG after merge:  round=19 metric=0.9962 head_norm=1.512871 delta_norm=0.084047
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S8] r=20 psi=0.996 u=0.0106 p_local=0.2786 f1=0.996 auprc=0.995 bytes=21581
[S9] r=20 psi=0.997 u=0.0043 p_local=0.0615 f1=0.996 auprc=1.000 bytes=18003
[S11] r=20 psi=0.974 u=0.0280 p_local=0.1893 f1=0.958 auprc=0.998 bytes=23388
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=19 metric=0.7008 head_norm=1.166684
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.224606e-01
[S15] stored merged vector for next round verification (round=19)
[S15] DEBUG after merge:  round=19 metric=0.6994 head_norm=1.138652 delta_norm=0.122461
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S15] r=20 psi=0.815 u=0.2605 p_local=0.2680 f1=0.701 auprc=0.987 bytes=17977
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=19 metric=0.3534 head_norm=1.171056
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.991447e-01
[S17] stored merged vector for next round verification (round=19)
[S17] DEBUG after merge:  round=19 metric=0.3533 head_norm=1.314786 delta_norm=0.299145
[S17] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S17] r=20 psi=0.546 u=0.0040 p_local=0.0795 f1=0.353 auprc=0.836 bytes=17988
[S2] START round=20 head_norm_before_train=1.597966 cos_to_last_merge=0.9996 (last merge round=18)
[S2] round=20 local utility u=0.255585 metrics={'f1_val': 0.701230889339113, 'auprc': 0.9564534542678776, 'loss_val': 0.2820088711771433, 'psi': 0.8033199153106189}-{'f1_val': 0.7014918162305126, 'auprc': 0.791044334969544, 'loss_val': 0.29851656862914355, 'psi': 0.737312823726125}
[S3] START round=20 head_norm_before_train=1.493665 cos_to_last_merge=1.0000 (last merge round=19)
[S3] round=20 local utility u=0.000000 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.9962425403735058, 'loss_val': 0.2214938754772049, 'psi': 0.9751181668126685}-{'f1_val': 0.9870139580698694, 'auprc': 0.9971276513060774, 'loss_val': 0.18351771725798244, 'psi': 0.9910594353643525}
[S4] START round=20 head_norm_before_train=1.795242 (no previous merge yet)
[S4] round=20 local utility u=0.000000 metrics={'f1_val': 0.9399295050435776, 'auprc': 0.9272333887720814, 'loss_val': 0.2766198284552742, 'psi': 0.9348510585349792}-{'f1_val': 0.9548863895027271, 'auprc': 0.9761801722924299, 'loss_val': 0.27810476818806124, 'psi': 0.9634039026186083}
[S5] START round=20 head_norm_before_train=1.784808 (no previous merge yet)
[S5] round=20 local utility u=0.355015 metrics={'f1_val': 0.6847440025350487, 'auprc': 0.8803884439321603, 'loss_val': 0.34277263168366673, 'psi': 0.7630017790938934}-{'f1_val': 0.6207519795913412, 'auprc': 0.8372754917542697, 'loss_val': 0.5395121638113181, 'psi': 0.7073613844565126}
[S6] START round=20 head_norm_before_train=1.399014 cos_to_last_merge=0.8446 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.845
[S6] round=20 local utility u=1.000000 metrics={'f1_val': 0.9439386690300023, 'auprc': 0.9528478092983478, 'loss_val': 0.3200016421268943, 'psi': 0.9475023251373405}-{'f1_val': 0.6712296501718665, 'auprc': 0.7636288814203632, 'loss_val': 0.4746653208727337, 'psi': 0.7081893426712652}
[S7] START round=20 head_norm_before_train=1.381503 cos_to_last_merge=0.8449 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.845
[S7] round=20 local utility u=0.970616 metrics={'f1_val': 0.6315631933505748, 'auprc': 0.801211535241295, 'loss_val': 0.5468503431611007, 'psi': 0.6994225301068628}-{'f1_val': 0.4168024298025348, 'auprc': 0.7809162997671895, 'loss_val': 1.1386320210292924, 'psi': 0.5624479777883966}
[S8] START round=20 head_norm_before_train=1.512871 cos_to_last_merge=1.0000 (last merge round=19)
[S8] round=20 local utility u=0.010526 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9959752803209025, 'loss_val': 0.1527969984387952, 'psi': 0.9962019570897358}-{'f1_val': 0.9962031034001528, 'auprc': 0.9947865971007819, 'loss_val': 0.16938358788199662, 'psi': 0.9956365008804045}
[S9] START round=20 head_norm_before_train=1.987782 (no previous merge yet)
[S9] round=20 local utility u=0.003458 metrics={'f1_val': 0.9964388212112862, 'auprc': 0.9995514431661984, 'loss_val': 0.02069669307723361, 'psi': 0.9976838699932511}-{'f1_val': 0.9956098104564366, 'auprc': 0.9995503114843948, 'loss_val': 0.02263608658425487, 'psi': 0.9971860108676198}
[S10] START round=20 head_norm_before_train=1.517132 cos_to_last_merge=0.7851 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.785
[S10] round=20 local utility u=0.002119 metrics={'f1_val': 0.9935262985458464, 'auprc': 0.9960449490929575, 'loss_val': 0.08610922430379868, 'psi': 0.9945337587646907}-{'f1_val': 0.9950444545353663, 'auprc': 0.9957871868657031, 'loss_val': 0.09868311074319513, 'psi': 0.995341547467501}
[S11] START round=20 head_norm_before_train=1.664298 cos_to_last_merge=0.9993 (last merge round=18)
[S11] round=20 local utility u=0.151400 metrics={'f1_val': 0.9973780864376928, 'auprc': 0.9982550180755938, 'loss_val': 0.16234898135785988, 'psi': 0.9977288590928532}-{'f1_val': 0.9582699758185035, 'auprc': 0.9982615170844747, 'loss_val': 0.23052024939045898, 'psi': 0.9742665923248921}
[S13] START round=20 head_norm_before_train=1.575592 (no previous merge yet)
[S13] round=20 local utility u=0.000000 metrics={'f1_val': 0.5763803885697563, 'auprc': 0.6798336011617584, 'loss_val': 0.7438279271457774, 'psi': 0.6177616736065571}-{'f1_val': 0.5954343589157918, 'auprc': 0.671433943180626, 'loss_val': 0.6701087368109935, 'psi': 0.6258341926217255}
[S14] START round=20 head_norm_before_train=1.042514 cos_to_last_merge=1.0000 (last merge round=19)
[S14] round=20 local utility u=0.000000 metrics={'f1_val': 0.9964034173396682, 'auprc': 0.9987658132123681, 'loss_val': 0.3071995580564071, 'psi': 0.9973483756887482}-{'f1_val': 0.9968419739193168, 'auprc': 0.9970769554636522, 'loss_val': 0.22500029499108365, 'psi': 0.996935966537051}
[S15] START round=20 head_norm_before_train=1.138652 cos_to_last_merge=1.0000 (last merge round=19)
[S15] round=20 local utility u=0.000000 metrics={'f1_val': 0.6985070700199395, 'auprc': 0.8049135016739865, 'loss_val': 0.4994396711445673, 'psi': 0.7410696426815583}-{'f1_val': 0.7008096757232372, 'auprc': 0.9871854537719176, 'loss_val': 0.4309172740576532, 'psi': 0.8153599869427093}
[S16] START round=20 head_norm_before_train=1.127106 cos_to_last_merge=1.0000 (last merge round=19)
[S16] round=20 local utility u=0.333294 metrics={'f1_val': 0.8345633776238186, 'auprc': 0.9216700590828657, 'loss_val': 0.45413439362696323, 'psi': 0.8694060502074374}-{'f1_val': 0.8239473146847489, 'auprc': 0.8206663285424708, 'loss_val': 0.7540148230327215, 'psi': 0.8226349202278377}
[S17] START round=20 head_norm_before_train=1.314786 cos_to_last_merge=1.0000 (last merge round=19)
[S17] round=20 local utility u=0.000000 metrics={'f1_val': 0.3529757526896929, 'auprc': 0.834845747782059, 'loss_val': 0.9359847439083137, 'psi': 0.5457237507266394}-{'f1_val': 0.3534424412471507, 'auprc': 0.8355610395814065, 'loss_val': 0.9375428753928066, 'psi': 0.546289880580853}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:41903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] → sending delta(kind=head bytes=1805) to S4@127.0.0.1:41904
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:41916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:41917
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:41916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:41917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:41909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:41916
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:41915
[S11] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1805 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1798) from S2
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.619337)
[S17] loaded HEAD from S2 (vec_in norm=1.619337)
[S17] cosine check vs S2: cos=-0.1427
[S17] DROPPED delta from S2 (cos=-0.1427 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1796) from S6
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.419044)
[S17] loaded HEAD from S6 (vec_in norm=1.419044)
[S17] cosine check vs S6: cos=0.1431
[S17] BUFFERED delta from S6 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1802) from S11
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.700206)
[S16] loaded HEAD from S11 (vec_in norm=1.700206)
[S16] cosine check vs S11: cos=0.7203
[S16] BUFFERED delta from S11 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1796) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.790786)
[S16] loaded HEAD from S5 (vec_in norm=1.790786)
[S16] cosine check vs S5: cos=0.2163
[S16] BUFFERED delta from S5 (total buffered=2)
[S16] RECEIVED delta(kind=head bytes=1798) from S9
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.998536)
[S16] loaded HEAD from S9 (vec_in norm=1.998536)
[S16] cosine check vs S9: cos=0.5944
[S16] BUFFERED delta from S9 (total buffered=3)
[S3] RECEIVED delta(kind=head bytes=1798) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.548675)
[S3] loaded HEAD from S8 (vec_in norm=1.548675)
[S3] cosine check vs S8: cos=0.9746
[S3] BUFFERED delta from S8 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1805) from S7
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.389453)
[S4] loaded HEAD from S7 (vec_in norm=1.389453)
[S4] cosine check vs S7: cos=-0.1341
[S4] DROPPED delta from S7 (cos=-0.1341 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1799) from S16
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.178600)
[S15] loaded HEAD from S16 (vec_in norm=1.178600)
[S15] cosine check vs S16: cos=0.9553
[S15] BUFFERED delta from S16 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1798) from S10
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.546363)
[S8] loaded HEAD from S10 (vec_in norm=1.546363)
[S8] cosine check vs S10: cos=0.9948
[S8] BUFFERED delta from S10 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] ⇄ pheromone p=0.130 → S11@127.0.0.1:41912
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=20 metric=0.9610 head_norm=1.556359
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.749293e-01
[S3] stored merged vector for next round verification (round=20)
[S3] DEBUG after merge:  round=20 metric=0.9611 head_norm=1.542635 delta_norm=0.174929
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.133 → S17@127.0.0.1:41917
[S4] ⇄ pheromone p=0.120 → S14@127.0.0.1:41914
[S13] ⇄ pheromone p=0.066 → S2@127.0.0.1:41902
[S10] ⇄ pheromone p=0.145 → S8@127.0.0.1:41909
[S11] ⇄ pheromone p=0.182 → S16@127.0.0.1:41916
[S5] ⇄ pheromone p=0.187 → S16@127.0.0.1:41916
[S7] ⇄ pheromone p=0.366 → S4@127.0.0.1:41904
[S2] ⇄ pheromone p=0.131 → S17@127.0.0.1:41917
[S16] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=20 metric=0.8346 head_norm=1.178600
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.794654e-01
[S16] stored merged vector for next round verification (round=20)
[S16] DEBUG after merge:  round=20 metric=0.9081 head_norm=1.075531 delta_norm=0.279465
[S16] aggregate: ACCEPT kept=['S11', 'S5', 'S9'] (k=3/3) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.249 → S15@127.0.0.1:41915
[S6] ⇄ pheromone p=0.331 → S17@127.0.0.1:41917
[S9] ⇄ pheromone p=0.050 → S16@127.0.0.1:41916
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=20 metric=0.9964 head_norm=1.548675
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.920040e-02
[S8] stored merged vector for next round verification (round=20)
[S8] DEBUG after merge:  round=20 metric=0.9964 head_norm=1.545492 delta_norm=0.079200
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.225 → S3@127.0.0.1:41903
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=20 metric=0.3530 head_norm=1.349157
[S17] _apply_head_vector_avg (torch): Δ‖w‖=9.063725e-01
[S17] stored merged vector for next round verification (round=20)
[S17] DEBUG after merge:  round=20 metric=0.3529 head_norm=1.046635 delta_norm=0.906373
[S17] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.064 → S14@127.0.0.1:41914
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=20 metric=0.6985 head_norm=1.179194
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.762124e-01
[S15] stored merged vector for next round verification (round=20)
[S15] DEBUG after merge:  round=20 metric=0.6971 head_norm=1.165653 delta_norm=0.176212
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.214 → S13@127.0.0.1:41913
[S2] START round=21 head_norm_before_train=1.619337 cos_to_last_merge=0.9981 (last merge round=18)
[S2] round=21 local utility u=0.056160 metrics={'f1_val': 0.7014918162305126, 'auprc': 0.9797755393997476, 'loss_val': 0.2412201420633676, 'psi': 0.8128053054982065}-{'f1_val': 0.701230889339113, 'auprc': 0.9564534542678776, 'loss_val': 0.2820088711771433, 'psi': 0.8033199153106189}
[S3] START round=21 head_norm_before_train=1.542635 cos_to_last_merge=1.0000 (last merge round=20)
[S3] round=21 local utility u=0.112464 metrics={'f1_val': 0.9908779553280832, 'auprc': 0.9977905246258139, 'loss_val': 0.1802656255146639, 'psi': 0.9936429830471755}-{'f1_val': 0.9610352511054436, 'auprc': 0.9962425403735058, 'loss_val': 0.2214938754772049, 'psi': 0.9751181668126685}
[S4] START round=21 head_norm_before_train=1.805702 (no previous merge yet)
[S4] round=21 local utility u=0.047687 metrics={'f1_val': 0.936841913761164, 'auprc': 0.9452307046755438, 'loss_val': 0.21671209245133036, 'psi': 0.9401974301269158}-{'f1_val': 0.9399295050435776, 'auprc': 0.9272333887720814, 'loss_val': 0.2766198284552742, 'psi': 0.9348510585349792}
[S5] START round=21 head_norm_before_train=1.790786 (no previous merge yet)
[S5] round=21 local utility u=0.315624 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9968382598138726, 'loss_val': 0.15433780990317836, 'psi': 0.8189280943858973}-{'f1_val': 0.6847440025350487, 'auprc': 0.8803884439321603, 'loss_val': 0.34277263168366673, 'psi': 0.7630017790938934}
[S6] START round=21 head_norm_before_train=1.419044 cos_to_last_merge=0.8390 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.839
[S6] round=21 local utility u=0.000000 metrics={'f1_val': 0.7866126158064644, 'auprc': 0.8074307929438356, 'loss_val': 0.46540176399370387, 'psi': 0.7949398866614128}-{'f1_val': 0.9439386690300023, 'auprc': 0.9528478092983478, 'loss_val': 0.3200016421268943, 'psi': 0.9475023251373405}
[S7] START round=21 head_norm_before_train=1.389453 cos_to_last_merge=0.8438 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.844
[S7] round=21 local utility u=0.643884 metrics={'f1_val': 0.7643212144388272, 'auprc': 0.8807989205806783, 'loss_val': 0.2943936081834036, 'psi': 0.8109122968955675}-{'f1_val': 0.6315631933505748, 'auprc': 0.801211535241295, 'loss_val': 0.5468503431611007, 'psi': 0.6994225301068628}
[S8] START round=21 head_norm_before_train=1.545492 cos_to_last_merge=1.0000 (last merge round=20)
[S8] round=21 local utility u=0.000000 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9927314571406899, 'loss_val': 0.15324702657155279, 'psi': 0.9948144448963676}-{'f1_val': 0.9963530749356245, 'auprc': 0.9959752803209025, 'loss_val': 0.1527969984387952, 'psi': 0.9962019570897358}
[S9] START round=21 head_norm_before_train=1.998536 (no previous merge yet)
[S9] round=21 local utility u=0.000000 metrics={'f1_val': 0.9959812240560731, 'auprc': 0.9993805047713133, 'loss_val': 0.01993509792770788, 'psi': 0.9973409363421692}-{'f1_val': 0.9964388212112862, 'auprc': 0.9995514431661984, 'loss_val': 0.02069669307723361, 'psi': 0.9976838699932511}
[S10] START round=21 head_norm_before_train=1.546363 cos_to_last_merge=0.7797 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.780
[S10] round=21 local utility u=0.006735 metrics={'f1_val': 0.9939643640207476, 'auprc': 0.9954637772927268, 'loss_val': 0.07352410864893624, 'psi': 0.9945641293295393}-{'f1_val': 0.9935262985458464, 'auprc': 0.9960449490929575, 'loss_val': 0.08610922430379868, 'psi': 0.9945337587646907}
[S11] START round=21 head_norm_before_train=1.700206 cos_to_last_merge=0.9972 (last merge round=18)
[S11] round=21 local utility u=0.021976 metrics={'f1_val': 0.9971362493929642, 'auprc': 0.9981519779821078, 'loss_val': 0.11663611156937818, 'psi': 0.9975425408286216}-{'f1_val': 0.9973780864376928, 'auprc': 0.9982550180755938, 'loss_val': 0.16234898135785988, 'psi': 0.9977288590928532}
[S13] START round=21 head_norm_before_train=1.588376 (no previous merge yet)
[S13] round=21 local utility u=0.087798 metrics={'f1_val': 0.6028237458130841, 'auprc': 0.6671768121953061, 'loss_val': 0.6889218097283656, 'psi': 0.628564972365973}-{'f1_val': 0.5763803885697563, 'auprc': 0.6798336011617584, 'loss_val': 0.7438279271457774, 'psi': 0.6177616736065571}
[S14] START round=21 head_norm_before_train=1.092935 cos_to_last_merge=0.9959 (last merge round=19)
[S14] round=21 local utility u=0.049727 metrics={'f1_val': 0.9976737714957896, 'auprc': 0.9971282843304119, 'loss_val': 0.2104547950451265, 'psi': 0.9974555766296385}-{'f1_val': 0.9964034173396682, 'auprc': 0.9987658132123681, 'loss_val': 0.3071995580564071, 'psi': 0.9973483756887482}
[S15] START round=21 head_norm_before_train=1.165653 cos_to_last_merge=1.0000 (last merge round=20)
[S15] round=21 local utility u=0.568680 metrics={'f1_val': 0.7661405191140752, 'auprc': 0.9897817800847934, 'loss_val': 0.32248523495823395, 'psi': 0.8555970235023626}-{'f1_val': 0.6985070700199395, 'auprc': 0.8049135016739865, 'loss_val': 0.4994396711445673, 'psi': 0.7410696426815583}
[S16] START round=21 head_norm_before_train=1.075531 cos_to_last_merge=1.0000 (last merge round=20)
[S16] round=21 local utility u=0.098484 metrics={'f1_val': 0.877780277153812, 'auprc': 0.9172527650493437, 'loss_val': 0.5032161026346826, 'psi': 0.8935692723120248}-{'f1_val': 0.8345633776238186, 'auprc': 0.9216700590828657, 'loss_val': 0.45413439362696323, 'psi': 0.8694060502074374}
[S17] START round=21 head_norm_before_train=1.046635 cos_to_last_merge=1.0000 (last merge round=20)
[S17] round=21 local utility u=0.000000 metrics={'f1_val': 0.38407047086320223, 'auprc': 0.6073389983468209, 'loss_val': 0.9469479168902929, 'psi': 0.4733778818566497}-{'f1_val': 0.3529757526896929, 'auprc': 0.834845747782059, 'loss_val': 0.9359847439083137, 'psi': 0.5457237507266394}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:41916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:41909
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:41902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:41915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:41916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:41913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:41917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:41904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:41917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:41914
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S11@127.0.0.1:41912
[S4] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1799) from S7
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.402511)
[S4] loaded HEAD from S7 (vec_in norm=1.402511)
[S4] cosine check vs S7: cos=-0.1330
[S4] DROPPED delta from S7 (cos=-0.1330 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1802) from S13
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.603873)
[S2] loaded HEAD from S13 (vec_in norm=1.603873)
[S2] cosine check vs S13: cos=0.9896
[S2] BUFFERED delta from S13 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1798) from S3
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.606065)
[S17] loaded HEAD from S3 (vec_in norm=1.606065)
[S17] cosine check vs S3: cos=0.6380
[S17] BUFFERED delta from S3 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1797) from S2
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.641223)
[S17] loaded HEAD from S2 (vec_in norm=1.641223)
[S17] cosine check vs S2: cos=-0.1728
[S17] DROPPED delta from S2 (cos=-0.1728 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1800) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.798020)
[S16] loaded HEAD from S5 (vec_in norm=1.798020)
[S16] cosine check vs S5: cos=0.4065
[S16] BUFFERED delta from S5 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1803) from S15
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.213788)
[S13] loaded HEAD from S15 (vec_in norm=1.213788)
[S13] cosine check vs S15: cos=-0.0906
[S13] DROPPED delta from S15 (cos=-0.0906 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1801) from S4
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.812776)
[S14] loaded HEAD from S4 (vec_in norm=1.812776)
[S14] cosine check vs S4: cos=-0.0048
[S14] DROPPED delta from S4 (cos=-0.0048 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1801) from S10
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.578761)
[S8] loaded HEAD from S10 (vec_in norm=1.578761)
[S8] cosine check vs S10: cos=0.9955
[S8] BUFFERED delta from S10 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1799) from S11
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.737011)
[S16] loaded HEAD from S11 (vec_in norm=1.737011)
[S16] cosine check vs S11: cos=0.6674
[S16] BUFFERED delta from S11 (total buffered=2)
[S15] RECEIVED delta(kind=head bytes=1800) from S16
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.127353)
[S15] loaded HEAD from S16 (vec_in norm=1.127353)
[S15] cosine check vs S16: cos=0.9774
[S15] BUFFERED delta from S16 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1803) from S14
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.153731)
[S11] loaded HEAD from S14 (vec_in norm=1.153731)
[S11] cosine check vs S14: cos=0.7295
[S11] BUFFERED delta from S14 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=21 metric=0.9962 head_norm=1.574082
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.444470e-02
[S8] stored merged vector for next round verification (round=21)
[S8] DEBUG after merge:  round=21 metric=0.9962 head_norm=1.574664 delta_norm=0.074445
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=21 metric=0.7661 head_norm=1.213788
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.316791e-01
[S15] stored merged vector for next round verification (round=21)
[S15] DEBUG after merge:  round=21 metric=0.7289 head_norm=1.163943 delta_norm=0.131679
[S15] aggregate: ROLLBACK (f1_val pre=0.766 post=0.729 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=21 metric=0.8778 head_norm=1.127353
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.470818e-01
[S16] stored merged vector for next round verification (round=21)
[S16] DEBUG after merge:  round=21 metric=0.8676 head_norm=1.124877 delta_norm=0.447082
[S16] aggregate: ROLLBACK (f1_val pre=0.878 post=0.868 tol_abs=0.005 tol_rel=0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=21 metric=0.9971 head_norm=1.737011
[S11] _apply_head_vector_avg (torch): Δ‖w‖=5.967360e-01
[S11] stored merged vector for next round verification (round=21)
[S11] DEBUG after merge:  round=21 metric=0.9971 head_norm=1.348354 delta_norm=0.596736
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=21 metric=0.7015 head_norm=1.641223
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.182744e-01
[S2] stored merged vector for next round verification (round=21)
[S2] DEBUG after merge:  round=21 metric=0.7015 head_norm=1.618340 delta_norm=0.118274
[S2] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=21 metric=0.3841 head_norm=1.086221
[S17] _apply_head_vector_avg (torch): Δ‖w‖=6.191036e-01
[S17] stored merged vector for next round verification (round=21)
[S17] DEBUG after merge:  round=21 metric=0.3860 head_norm=1.223262 delta_norm=0.619104
[S17] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=1.618340 cos_to_last_merge=1.0000 (last merge round=21)
[S2] round=22 local utility u=0.000000 metrics={'f1_val': 0.5965441107722517, 'auprc': 0.977947517468226, 'loss_val': 0.667104107127151, 'psi': 0.7491054734506414}-{'f1_val': 0.7014918162305126, 'auprc': 0.9797755393997476, 'loss_val': 0.2412201420633676, 'psi': 0.8128053054982065}
[S3] START round=22 head_norm_before_train=1.606065 cos_to_last_merge=0.9968 (last merge round=20)
[S3] round=22 local utility u=0.000000 metrics={'f1_val': 0.9612440485292413, 'auprc': 0.9982044856691412, 'loss_val': 0.13255455930107152, 'psi': 0.9760282233852012}-{'f1_val': 0.9908779553280832, 'auprc': 0.9977905246258139, 'loss_val': 0.1802656255146639, 'psi': 0.9936429830471755}
[S4] START round=22 head_norm_before_train=1.812776 (no previous merge yet)
[S4] round=22 local utility u=0.049402 metrics={'f1_val': 0.9456580569634845, 'auprc': 0.9620034698163451, 'loss_val': 0.22112304008839453, 'psi': 0.9521962221046287}-{'f1_val': 0.936841913761164, 'auprc': 0.9452307046755438, 'loss_val': 0.21671209245133036, 'psi': 0.9401974301269158}
[S5] START round=22 head_norm_before_train=1.798020 (no previous merge yet)
[S5] round=22 local utility u=0.000000 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9903151716918468, 'loss_val': 0.25453708147364495, 'psi': 0.8163188591370869}-{'f1_val': 0.7003213174339138, 'auprc': 0.9968382598138726, 'loss_val': 0.15433780990317836, 'psi': 0.8189280943858973}
[S6] START round=22 head_norm_before_train=1.437095 cos_to_last_merge=0.8335 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.833
[S6] round=22 local utility u=0.656158 metrics={'f1_val': 0.9072030070603156, 'auprc': 0.9484042790203623, 'loss_val': 0.29954919220549936, 'psi': 0.9236835158443343}-{'f1_val': 0.7866126158064644, 'auprc': 0.8074307929438356, 'loss_val': 0.46540176399370387, 'psi': 0.7949398866614128}
[S7] START round=22 head_norm_before_train=1.402511 cos_to_last_merge=0.8416 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.842
[S7] round=22 local utility u=0.000000 metrics={'f1_val': 0.648138887751563, 'auprc': 0.8055813928760555, 'loss_val': 0.48600620831296193, 'psi': 0.7111158898013601}-{'f1_val': 0.7643212144388272, 'auprc': 0.8807989205806783, 'loss_val': 0.2943936081834036, 'psi': 0.8109122968955675}
[S8] START round=22 head_norm_before_train=1.574664 cos_to_last_merge=1.0000 (last merge round=21)
[S8] round=22 local utility u=0.004776 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9943743445928301, 'loss_val': 0.14862443899534816, 'psi': 0.9954715998772238}-{'f1_val': 0.9962031034001528, 'auprc': 0.9927314571406899, 'loss_val': 0.15324702657155279, 'psi': 0.9948144448963676}
[S9] START round=22 head_norm_before_train=2.012700 (no previous merge yet)
[S9] round=22 local utility u=0.000000 metrics={'f1_val': 0.9955666097086097, 'auprc': 0.9994534768539746, 'loss_val': 0.01996091549484965, 'psi': 0.9971213565667556}-{'f1_val': 0.9959812240560731, 'auprc': 0.9993805047713133, 'loss_val': 0.01993509792770788, 'psi': 0.9973409363421692}
[S10] START round=22 head_norm_before_train=1.578761 cos_to_last_merge=0.7735 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.774
[S10] round=22 local utility u=0.003166 metrics={'f1_val': 0.993391017001491, 'auprc': 0.99538474883508, 'loss_val': 0.06351562996211614, 'psi': 0.9941885097349266}-{'f1_val': 0.9939643640207476, 'auprc': 0.9954637772927268, 'loss_val': 0.07352410864893624, 'psi': 0.9945641293295393}
[S11] START round=22 head_norm_before_train=1.348354 cos_to_last_merge=1.0000 (last merge round=21)
[S11] round=22 local utility u=0.000000 metrics={'f1_val': 0.996960829744628, 'auprc': 0.9982300398981421, 'loss_val': 0.1904206388775224, 'psi': 0.9974685138060335}-{'f1_val': 0.9971362493929642, 'auprc': 0.9981519779821078, 'loss_val': 0.11663611156937818, 'psi': 0.9975425408286216}
[S13] START round=22 head_norm_before_train=1.603873 (no previous merge yet)
[S13] round=22 local utility u=0.000000 metrics={'f1_val': 0.5803784026686484, 'auprc': 0.6855285327976728, 'loss_val': 0.7488052628966223, 'psi': 0.6224384547202582}-{'f1_val': 0.6028237458130841, 'auprc': 0.6671768121953061, 'loss_val': 0.6889218097283656, 'psi': 0.628564972365973}
[S14] START round=22 head_norm_before_train=1.153731 cos_to_last_merge=0.9848 (last merge round=19)
[S14] round=22 local utility u=0.028578 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9987829713107614, 'loss_val': 0.15566212673728186, 'psi': 0.9978574025477804}-{'f1_val': 0.9976737714957896, 'auprc': 0.9971282843304119, 'loss_val': 0.2104547950451265, 'psi': 0.9974555766296385}
[S15] START round=22 head_norm_before_train=1.163943 cos_to_last_merge=1.0000 (last merge round=21)
[S15] round=22 local utility u=0.570704 metrics={'f1_val': 0.9480616747990538, 'auprc': 0.9906814648567861, 'loss_val': 0.27530386331959955, 'psi': 0.9651095908221468}-{'f1_val': 0.7661405191140752, 'auprc': 0.9897817800847934, 'loss_val': 0.32248523495823395, 'psi': 0.8555970235023626}
[S16] START round=22 head_norm_before_train=1.124877 cos_to_last_merge=1.0000 (last merge round=21)
[S16] round=22 local utility u=0.276743 metrics={'f1_val': 0.9310127907384886, 'auprc': 0.9788188442158527, 'loss_val': 0.45382389270928447, 'psi': 0.9501352121294342}-{'f1_val': 0.877780277153812, 'auprc': 0.9172527650493437, 'loss_val': 0.5032161026346826, 'psi': 0.8935692723120248}
[S17] START round=22 head_norm_before_train=1.223262 cos_to_last_merge=1.0000 (last merge round=21)
[S17] round=22 local utility u=0.055211 metrics={'f1_val': 0.39314560772002805, 'auprc': 0.6109538973774516, 'loss_val': 0.9018218381428408, 'psi': 0.4802689235829975}-{'f1_val': 0.38407047086320223, 'auprc': 0.6073389983468209, 'loss_val': 0.9469479168902929, 'psi': 0.4733778818566497}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:41915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:41903
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:41909
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:41917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:41914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:41913
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:41912
[S15] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1803 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1801) from S16
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.162708)
[S15] loaded HEAD from S16 (vec_in norm=1.162708)
[S15] cosine check vs S16: cos=0.9141
[S15] BUFFERED delta from S16 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1802) from S6
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.452929)
[S17] loaded HEAD from S6 (vec_in norm=1.452929)
[S17] cosine check vs S6: cos=0.3598
[S17] BUFFERED delta from S6 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1799) from S15
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.207548)
[S13] loaded HEAD from S15 (vec_in norm=1.207548)
[S13] cosine check vs S15: cos=-0.0847
[S13] DROPPED delta from S15 (cos=-0.0847 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1803) from S4
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.823089)
[S14] loaded HEAD from S4 (vec_in norm=1.823089)
[S14] cosine check vs S4: cos=-0.0081
[S14] DROPPED delta from S4 (cos=-0.0081 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1801) from S10
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.608960)
[S8] loaded HEAD from S10 (vec_in norm=1.608960)
[S8] cosine check vs S10: cos=0.9961
[S8] BUFFERED delta from S10 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1797) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.599670)
[S3] loaded HEAD from S8 (vec_in norm=1.599670)
[S3] cosine check vs S8: cos=0.9660
[S3] BUFFERED delta from S8 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1800) from S14
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.212070)
[S11] loaded HEAD from S14 (vec_in norm=1.212070)
[S11] cosine check vs S14: cos=0.8992
[S11] BUFFERED delta from S14 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:41914
[S17] sending update (kind=head size=1798 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1798) from S17
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.261529)
[S14] loaded HEAD from S17 (vec_in norm=1.261529)
[S14] cosine check vs S17: cos=0.7265
[S14] BUFFERED delta from S17 (total buffered=1)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=22 metric=0.9970 head_norm=1.386023
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.036806e-01
[S11] stored merged vector for next round verification (round=22)
[S11] DEBUG after merge:  round=22 metric=0.9970 head_norm=1.266043 delta_norm=0.303681
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=22 metric=0.9612 head_norm=1.670484
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.159865e-01
[S3] stored merged vector for next round verification (round=22)
[S3] DEBUG after merge:  round=22 metric=0.9608 head_norm=1.621135 delta_norm=0.215986
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=22 metric=0.9481 head_norm=1.207548
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.465747e-01
[S15] stored merged vector for next round verification (round=22)
[S15] DEBUG after merge:  round=22 metric=0.7759 head_norm=1.159410 delta_norm=0.246575
[S15] aggregate: ROLLBACK (f1_val pre=0.948 post=0.776 tol_abs=0.005 tol_rel=0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=22 metric=0.9962 head_norm=1.599670
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.067129e-02
[S8] stored merged vector for next round verification (round=22)
[S8] DEBUG after merge:  round=22 metric=0.9962 head_norm=1.602764 delta_norm=0.070671
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=22 metric=0.9972 head_norm=1.212070
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.579183e-01
[S14] stored merged vector for next round verification (round=22)
[S14] DEBUG after merge:  round=22 metric=0.9970 head_norm=1.149172 delta_norm=0.457918
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=22 metric=0.3931 head_norm=1.261529
[S17] _apply_head_vector_avg (torch): Δ‖w‖=7.719169e-01
[S17] stored merged vector for next round verification (round=22)
[S17] DEBUG after merge:  round=22 metric=0.3543 head_norm=1.120434 delta_norm=0.771917
[S17] aggregate: ROLLBACK (f1_val pre=0.393 post=0.354 tol_abs=0.005 tol_rel=0.0)
[S2] START round=23 head_norm_before_train=1.637155 cos_to_last_merge=0.9997 (last merge round=21)
[S2] round=23 local utility u=0.547236 metrics={'f1_val': 0.7013101313728686, 'auprc': 0.9918405620083524, 'loss_val': 0.24290812183027408, 'psi': 0.8175223036270621}-{'f1_val': 0.5965441107722517, 'auprc': 0.977947517468226, 'loss_val': 0.667104107127151, 'psi': 0.7491054734506414}
[S3] START round=23 head_norm_before_train=1.621135 cos_to_last_merge=1.0000 (last merge round=22)
[S3] round=23 local utility u=0.104217 metrics={'f1_val': 0.9962807853497399, 'auprc': 0.9975982364756986, 'loss_val': 0.13252279804928577, 'psi': 0.9968077658001233}-{'f1_val': 0.9612440485292413, 'auprc': 0.9982044856691412, 'loss_val': 0.13255455930107152, 'psi': 0.9760282233852012}
[S4] START round=23 head_norm_before_train=1.823089 (no previous merge yet)
[S4] round=23 local utility u=0.000000 metrics={'f1_val': 0.9431373926157011, 'auprc': 0.9590754454174983, 'loss_val': 0.2764682278299646, 'psi': 0.94951261373642}-{'f1_val': 0.9456580569634845, 'auprc': 0.9620034698163451, 'loss_val': 0.22112304008839453, 'psi': 0.9521962221046287}
[S5] START round=23 head_norm_before_train=1.802643 (no previous merge yet)
[S5] round=23 local utility u=0.000000 metrics={'f1_val': 0.6703442493201334, 'auprc': 0.8864458256570735, 'loss_val': 0.3401070258883456, 'psi': 0.7567848798549095}-{'f1_val': 0.7003213174339138, 'auprc': 0.9903151716918468, 'loss_val': 0.25453708147364495, 'psi': 0.8163188591370869}
[S6] START round=23 head_norm_before_train=1.452929 cos_to_last_merge=0.8283 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.828
[S6] round=23 local utility u=0.000000 metrics={'f1_val': 0.7811345995307823, 'auprc': 0.8247939304686711, 'loss_val': 0.4681880815248698, 'psi': 0.7985983319059379}-{'f1_val': 0.9072030070603156, 'auprc': 0.9484042790203623, 'loss_val': 0.29954919220549936, 'psi': 0.9236835158443343}
[S7] START round=23 head_norm_before_train=1.412142 cos_to_last_merge=0.8397 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.840
[S7] round=23 local utility u=0.033800 metrics={'f1_val': 0.6538335074222965, 'auprc': 0.8141994949976965, 'loss_val': 0.4784291857829377, 'psi': 0.7179799024524565}-{'f1_val': 0.648138887751563, 'auprc': 0.8055813928760555, 'loss_val': 0.48600620831296193, 'psi': 0.7111158898013601}
[S8] START round=23 head_norm_before_train=1.602764 cos_to_last_merge=1.0000 (last merge round=22)
[S8] round=23 local utility u=0.011732 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9969453277130543, 'loss_val': 0.13377321946509355, 'psi': 0.9965899760465965}-{'f1_val': 0.9962031034001528, 'auprc': 0.9943743445928301, 'loss_val': 0.14862443899534816, 'psi': 0.9954715998772238}
[S9] START round=23 head_norm_before_train=2.026960 (no previous merge yet)
[S9] round=23 local utility u=0.000000 metrics={'f1_val': 0.9955623821232735, 'auprc': 0.9994728834288353, 'loss_val': 0.021104910526576495, 'psi': 0.9971265826454982}-{'f1_val': 0.9955666097086097, 'auprc': 0.9994534768539746, 'loss_val': 0.01996091549484965, 'psi': 0.9971213565667556}
[S10] START round=23 head_norm_before_train=1.608960 cos_to_last_merge=0.7681 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.768
[S10] round=23 local utility u=0.003330 metrics={'f1_val': 0.993391017001491, 'auprc': 0.9955180198383006, 'loss_val': 0.05725460046812117, 'psi': 0.9942418181362148}-{'f1_val': 0.993391017001491, 'auprc': 0.99538474883508, 'loss_val': 0.06351562996211614, 'psi': 0.9941885097349266}
[S11] START round=23 head_norm_before_train=1.266043 cos_to_last_merge=1.0000 (last merge round=22)
[S11] round=23 local utility u=0.000000 metrics={'f1_val': 0.9971362493929642, 'auprc': 0.9982281155450995, 'loss_val': 0.21057041150479644, 'psi': 0.9975729958538183}-{'f1_val': 0.996960829744628, 'auprc': 0.9982300398981421, 'loss_val': 0.1904206388775224, 'psi': 0.9974685138060335}
[S13] START round=23 head_norm_before_train=1.618264 (no previous merge yet)
[S13] round=23 local utility u=0.171369 metrics={'f1_val': 0.6194725613559053, 'auprc': 0.6733316533302112, 'loss_val': 0.6040416685913395, 'psi': 0.6410161981456277}-{'f1_val': 0.5803784026686484, 'auprc': 0.6855285327976728, 'loss_val': 0.7488052628966223, 'psi': 0.6224384547202582}
[S14] START round=23 head_norm_before_train=1.149172 cos_to_last_merge=1.0000 (last merge round=22)
[S14] round=23 local utility u=0.000000 metrics={'f1_val': 0.9966028613455465, 'auprc': 0.9933659082185753, 'loss_val': 0.26084537213824893, 'psi': 0.995308080094758}-{'f1_val': 0.997240356705793, 'auprc': 0.9987829713107614, 'loss_val': 0.15566212673728186, 'psi': 0.9978574025477804}
[S15] START round=23 head_norm_before_train=1.159410 cos_to_last_merge=1.0000 (last merge round=22)
[S15] round=23 local utility u=0.000000 metrics={'f1_val': 0.6956674878580127, 'auprc': 0.6758282845241345, 'loss_val': 0.5074322332529586, 'psi': 0.6877318065244614}-{'f1_val': 0.9480616747990538, 'auprc': 0.9906814648567861, 'loss_val': 0.27530386331959955, 'psi': 0.9651095908221468}
[S16] START round=23 head_norm_before_train=1.162708 cos_to_last_merge=0.9974 (last merge round=21)
[S16] round=23 local utility u=0.000000 metrics={'f1_val': 0.8437667090831561, 'auprc': 0.9338703380168013, 'loss_val': 0.6501116505147426, 'psi': 0.8798081606566142}-{'f1_val': 0.9310127907384886, 'auprc': 0.9788188442158527, 'loss_val': 0.45382389270928447, 'psi': 0.9501352121294342}
[S17] START round=23 head_norm_before_train=1.120434 cos_to_last_merge=1.0000 (last merge round=22)
[S17] round=23 local utility u=0.000000 metrics={'f1_val': 0.3547326536225005, 'auprc': 0.6009354556166362, 'loss_val': 0.9310748113153304, 'psi': 0.45321377442015476}-{'f1_val': 0.39314560772002805, 'auprc': 0.6109538973774516, 'loss_val': 0.9018218381428408, 'psi': 0.4802689235829975}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:41909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:41903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:41902
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S7] → sending delta(kind=head bytes=1808) to S4@127.0.0.1:41904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:41917
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:41917
[S2] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1808 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1808) from S7
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.421788)
[S4] loaded HEAD from S7 (vec_in norm=1.421788)
[S4] cosine check vs S7: cos=-0.1277
[S4] DROPPED delta from S7 (cos=-0.1277 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1800) from S3
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.677433)
[S17] loaded HEAD from S3 (vec_in norm=1.677433)
[S17] cosine check vs S3: cos=0.5484
[S17] BUFFERED delta from S3 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1798) from S2
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.657238)
[S17] loaded HEAD from S2 (vec_in norm=1.657238)
[S17] cosine check vs S2: cos=-0.1705
[S17] DROPPED delta from S2 (cos=-0.1705 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1800) from S10
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.638574)
[S8] loaded HEAD from S10 (vec_in norm=1.638574)
[S8] cosine check vs S10: cos=0.9965
[S8] BUFFERED delta from S10 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1803) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.627900)
[S3] loaded HEAD from S8 (vec_in norm=1.627900)
[S3] cosine check vs S8: cos=0.9810
[S3] BUFFERED delta from S8 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1802) from S13
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.630515)
[S2] loaded HEAD from S13 (vec_in norm=1.630515)
[S2] cosine check vs S13: cos=0.9931
[S2] BUFFERED delta from S13 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=23 metric=0.9964 head_norm=1.627900
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.805459e-02
[S8] stored merged vector for next round verification (round=23)
[S8] DEBUG after merge:  round=23 metric=0.9964 head_norm=1.631828 delta_norm=0.068055
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=23 metric=0.7013 head_norm=1.657238
[S2] _apply_head_vector_avg (torch): Δ‖w‖=9.766603e-02
[S2] stored merged vector for next round verification (round=23)
[S2] DEBUG after merge:  round=23 metric=0.7013 head_norm=1.641027 delta_norm=0.097666
[S2] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=23 metric=0.9963 head_norm=1.677433
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.628885e-01
[S3] stored merged vector for next round verification (round=23)
[S3] DEBUG after merge:  round=23 metric=0.9941 head_norm=1.644806 delta_norm=0.162888
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=23 metric=0.3547 head_norm=1.159349
[S17] _apply_head_vector_avg (torch): Δ‖w‖=7.115011e-01
[S17] stored merged vector for next round verification (round=23)
[S17] DEBUG after merge:  round=23 metric=0.3660 head_norm=1.254074 delta_norm=0.711501
[S17] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=1.641027 cos_to_last_merge=1.0000 (last merge round=23)
[S2] round=24 local utility u=0.000000 metrics={'f1_val': 0.701498336225999, 'auprc': 0.8048273397750161, 'loss_val': 0.32734080946716426, 'psi': 0.7428299376456058}-{'f1_val': 0.7013101313728686, 'auprc': 0.9918405620083524, 'loss_val': 0.24290812183027408, 'psi': 0.8175223036270621}
[S3] START round=24 head_norm_before_train=1.644806 cos_to_last_merge=1.0000 (last merge round=23)
[S3] round=24 local utility u=0.000000 metrics={'f1_val': 0.9731210138892048, 'auprc': 0.997344403895573, 'loss_val': 0.19873579141599101, 'psi': 0.9828103698917521}-{'f1_val': 0.9962807853497399, 'auprc': 0.9975982364756986, 'loss_val': 0.13252279804928577, 'psi': 0.9968077658001233}
[S4] START round=24 head_norm_before_train=1.826077 (no previous merge yet)
[S4] round=24 local utility u=0.000000 metrics={'f1_val': 0.9398705081608805, 'auprc': 0.9351711193145593, 'loss_val': 0.3017195165105192, 'psi': 0.9379907526223521}-{'f1_val': 0.9431373926157011, 'auprc': 0.9590754454174983, 'loss_val': 0.2764682278299646, 'psi': 0.94951261373642}
[S5] START round=24 head_norm_before_train=1.808629 (no previous merge yet)
[S5] round=24 local utility u=0.311637 metrics={'f1_val': 0.700407554886547, 'auprc': 0.9912145378375077, 'loss_val': 0.2115182052382132, 'psi': 0.8167303480669312}-{'f1_val': 0.6703442493201334, 'auprc': 0.8864458256570735, 'loss_val': 0.3401070258883456, 'psi': 0.7567848798549095}
[S6] START round=24 head_norm_before_train=1.467224 cos_to_last_merge=0.8240 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.824
[S6] round=24 local utility u=0.215551 metrics={'f1_val': 0.8185563111914317, 'auprc': 0.8929228026760454, 'loss_val': 0.4660034218686723, 'psi': 0.8483029077852772}-{'f1_val': 0.7811345995307823, 'auprc': 0.8247939304686711, 'loss_val': 0.4681880815248698, 'psi': 0.7985983319059379}
[S7] START round=24 head_norm_before_train=1.421788 cos_to_last_merge=0.8382 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.838
[S7] round=24 local utility u=0.000000 metrics={'f1_val': 0.570202441897317, 'auprc': 0.7861250767504605, 'loss_val': 0.739477150012704, 'psi': 0.6565714958385744}-{'f1_val': 0.6538335074222965, 'auprc': 0.8141994949976965, 'loss_val': 0.4784291857829377, 'psi': 0.7179799024524565}
[S8] START round=24 head_norm_before_train=1.631828 cos_to_last_merge=1.0000 (last merge round=23)
[S8] round=24 local utility u=0.005376 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.996268698527866, 'loss_val': 0.12009162881033161, 'psi': 0.9962293414512382}-{'f1_val': 0.9963530749356245, 'auprc': 0.9969453277130543, 'loss_val': 0.13377321946509355, 'psi': 0.9965899760465965}
[S9] START round=24 head_norm_before_train=2.033467 (no previous merge yet)
[S9] round=24 local utility u=0.000000 metrics={'f1_val': 0.9922651407836713, 'auprc': 0.9994811828352127, 'loss_val': 0.027411529336757456, 'psi': 0.995151557604288}-{'f1_val': 0.9955623821232735, 'auprc': 0.9994728834288353, 'loss_val': 0.021104910526576495, 'psi': 0.9971265826454982}
[S10] START round=24 head_norm_before_train=1.638574 cos_to_last_merge=0.7631 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.763
[S10] round=24 local utility u=0.000000 metrics={'f1_val': 0.9923831262681421, 'auprc': 0.9956412304983437, 'loss_val': 0.0597804382856568, 'psi': 0.9936863679602228}-{'f1_val': 0.993391017001491, 'auprc': 0.9955180198383006, 'loss_val': 0.05725460046812117, 'psi': 0.9942418181362148}
[S11] START round=24 head_norm_before_train=1.310251 cos_to_last_merge=0.9980 (last merge round=22)
[S11] round=24 local utility u=0.032889 metrics={'f1_val': 0.9971362493929642, 'auprc': 0.9982941386666151, 'loss_val': 0.14499129028205943, 'psi': 0.9975994051024246}-{'f1_val': 0.9971362493929642, 'auprc': 0.9982281155450995, 'loss_val': 0.21057041150479644, 'psi': 0.9975729958538183}
[S13] START round=24 head_norm_before_train=1.630515 (no previous merge yet)
[S13] round=24 local utility u=0.000000 metrics={'f1_val': 0.5763119186219843, 'auprc': 0.6891614503396054, 'loss_val': 0.8594263622749467, 'psi': 0.6214517313090326}-{'f1_val': 0.6194725613559053, 'auprc': 0.6733316533302112, 'loss_val': 0.6040416685913395, 'psi': 0.6410161981456277}
[S14] START round=24 head_norm_before_train=1.195445 cos_to_last_merge=0.9971 (last merge round=22)
[S14] round=24 local utility u=0.039773 metrics={'f1_val': 0.9961605687915402, 'auprc': 0.9969648544576057, 'loss_val': 0.189441535686058, 'psi': 0.9964822830579665}-{'f1_val': 0.9966028613455465, 'auprc': 0.9933659082185753, 'loss_val': 0.26084537213824893, 'psi': 0.995308080094758}
[S15] START round=24 head_norm_before_train=1.194141 cos_to_last_merge=0.9987 (last merge round=22)
[S15] round=24 local utility u=1.000000 metrics={'f1_val': 0.9893624882870682, 'auprc': 0.9902742676853497, 'loss_val': 0.24144348806442523, 'psi': 0.9897272000463808}-{'f1_val': 0.6956674878580127, 'auprc': 0.6758282845241345, 'loss_val': 0.5074322332529586, 'psi': 0.6877318065244614}
[S16] START round=24 head_norm_before_train=1.210345 cos_to_last_merge=0.9901 (last merge round=21)
[S16] round=24 local utility u=0.706861 metrics={'f1_val': 0.9813242201129025, 'auprc': 0.9899904008180292, 'loss_val': 0.23009496524925047, 'psi': 0.9847906923949532}-{'f1_val': 0.8437667090831561, 'auprc': 0.9338703380168013, 'loss_val': 0.6501116505147426, 'psi': 0.8798081606566142}
[S17] START round=24 head_norm_before_train=1.254074 cos_to_last_merge=1.0000 (last merge round=23)
[S17] round=24 local utility u=0.000000 metrics={'f1_val': 0.35351202434239126, 'auprc': 0.5942629792292243, 'loss_val': 0.9332302923752868, 'psi': 0.4498124062971245}-{'f1_val': 0.3547326536225005, 'auprc': 0.6009354556166362, 'loss_val': 0.9310748113153304, 'psi': 0.45321377442015476}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:41912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:41916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:41903
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:41916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:41915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] → sending delta(kind=head bytes=1805) to S17@127.0.0.1:41917
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:41913
[S8] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1805 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1805) from S6
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.487065)
[S17] loaded HEAD from S6 (vec_in norm=1.487065)
[S17] cosine check vs S6: cos=0.4124
[S17] BUFFERED delta from S6 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1802) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.816325)
[S16] loaded HEAD from S5 (vec_in norm=1.816325)
[S16] cosine check vs S5: cos=0.5580
[S16] BUFFERED delta from S5 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1797) from S11
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.364265)
[S16] loaded HEAD from S11 (vec_in norm=1.364265)
[S16] cosine check vs S11: cos=0.6696
[S16] BUFFERED delta from S11 (total buffered=2)
[S13] RECEIVED delta(kind=head bytes=1798) from S15
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.233959)
[S13] loaded HEAD from S15 (vec_in norm=1.233959)
[S13] cosine check vs S15: cos=-0.0843
[S13] DROPPED delta from S15 (cos=-0.0843 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1800) from S14
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.247508)
[S11] loaded HEAD from S14 (vec_in norm=1.247508)
[S11] cosine check vs S14: cos=0.8400
[S11] BUFFERED delta from S14 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1803) from S16
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.261989)
[S15] loaded HEAD from S16 (vec_in norm=1.261989)
[S15] cosine check vs S16: cos=0.9681
[S15] BUFFERED delta from S16 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1803) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.658750)
[S3] loaded HEAD from S8 (vec_in norm=1.658750)
[S3] cosine check vs S8: cos=0.9884
[S3] BUFFERED delta from S8 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=24 metric=0.9731 head_norm=1.690349
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.282549e-01
[S3] stored merged vector for next round verification (round=24)
[S3] DEBUG after merge:  round=24 metric=0.9675 head_norm=1.669705 delta_norm=0.128255
[S3] aggregate: ROLLBACK (f1_val pre=0.973 post=0.967 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=24 metric=0.9813 head_norm=1.261989
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.666587e-01
[S16] stored merged vector for next round verification (round=24)
[S16] DEBUG after merge:  round=24 metric=0.9732 head_norm=1.162042 delta_norm=0.366659
[S16] aggregate: ROLLBACK (f1_val pre=0.981 post=0.973 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=24 metric=0.9894 head_norm=1.233959
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.582562e-01
[S15] stored merged vector for next round verification (round=24)
[S15] DEBUG after merge:  round=24 metric=0.9884 head_norm=1.237978 delta_norm=0.158256
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=24 metric=0.9971 head_norm=1.364265
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.735733e-01
[S11] stored merged vector for next round verification (round=24)
[S11] DEBUG after merge:  round=24 metric=0.9971 head_norm=1.252673 delta_norm=0.373573
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=24 metric=0.3535 head_norm=1.293486
[S17] _apply_head_vector_avg (torch): Δ‖w‖=7.579681e-01
[S17] stored merged vector for next round verification (round=24)
[S17] DEBUG after merge:  round=24 metric=0.3538 head_norm=1.169495 delta_norm=0.757968
[S17] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=25 head_norm_before_train=1.661093 cos_to_last_merge=0.9998 (last merge round=23)
[S2] round=25 local utility u=0.300727 metrics={'f1_val': 0.7013101313728686, 'auprc': 0.9753129329690531, 'loss_val': 0.23621377790222833, 'psi': 0.8109112520113424}-{'f1_val': 0.701498336225999, 'auprc': 0.8048273397750161, 'loss_val': 0.32734080946716426, 'psi': 0.7428299376456058}
[S3] START round=25 head_norm_before_train=1.669705 cos_to_last_merge=1.0000 (last merge round=24)
[S3] round=25 local utility u=0.000000 metrics={'f1_val': 0.9601460646946383, 'auprc': 0.9664879629858081, 'loss_val': 0.20549130164796608, 'psi': 0.9626828240111062}-{'f1_val': 0.9731210138892048, 'auprc': 0.997344403895573, 'loss_val': 0.19873579141599101, 'psi': 0.9828103698917521}
[S4] START round=25 head_norm_before_train=1.831467 (no previous merge yet)
[S4] round=25 local utility u=0.000000 metrics={'f1_val': 0.9370329347669316, 'auprc': 0.9273268054409267, 'loss_val': 0.2840684388965106, 'psi': 0.9331504830365296}-{'f1_val': 0.9398705081608805, 'auprc': 0.9351711193145593, 'loss_val': 0.3017195165105192, 'psi': 0.9379907526223521}
[S5] START round=25 head_norm_before_train=1.816325 (no previous merge yet)
[S5] round=25 local utility u=0.123586 metrics={'f1_val': 0.7396465299940082, 'auprc': 0.9919503071222893, 'loss_val': 0.20198719893223133, 'psi': 0.8405680408453207}-{'f1_val': 0.700407554886547, 'auprc': 0.9912145378375077, 'loss_val': 0.2115182052382132, 'psi': 0.8167303480669312}
[S6] START round=25 head_norm_before_train=1.487065 cos_to_last_merge=0.8200 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.820
[S6] round=25 local utility u=0.671048 metrics={'f1_val': 0.962305332937172, 'auprc': 0.9627430340125132, 'loss_val': 0.19586152454768208, 'psi': 0.9624804133673085}-{'f1_val': 0.8185563111914317, 'auprc': 0.8929228026760454, 'loss_val': 0.4660034218686723, 'psi': 0.8483029077852772}
[S7] START round=25 head_norm_before_train=1.434031 cos_to_last_merge=0.8367 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.837
[S7] round=25 local utility u=0.000000 metrics={'f1_val': 0.4677178851380075, 'auprc': 0.7815162090849785, 'loss_val': 0.9905760383380009, 'psi': 0.5932372147167959}-{'f1_val': 0.570202441897317, 'auprc': 0.7861250767504605, 'loss_val': 0.739477150012704, 'psi': 0.6565714958385744}
[S8] START round=25 head_norm_before_train=1.658750 cos_to_last_merge=0.9995 (last merge round=23)
[S8] round=25 local utility u=0.007961 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9974089045741295, 'loss_val': 0.1075895077301155, 'psi': 0.9966854238697436}-{'f1_val': 0.9962031034001528, 'auprc': 0.996268698527866, 'loss_val': 0.12009162881033161, 'psi': 0.9962293414512382}
[S9] START round=25 head_norm_before_train=2.040571 (no previous merge yet)
[S9] round=25 local utility u=0.010491 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9947034897935274, 'loss_val': 0.018660275764418727, 'psi': 0.9958968906762683}-{'f1_val': 0.9922651407836713, 'auprc': 0.9994811828352127, 'loss_val': 0.027411529336757456, 'psi': 0.995151557604288}
[S10] START round=25 head_norm_before_train=1.663132 cos_to_last_merge=0.7593 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.759
[S10] round=25 local utility u=0.000000 metrics={'f1_val': 0.9931054437782314, 'auprc': 0.989389163546758, 'loss_val': 0.05351145668479534, 'psi': 0.9916189316856421}-{'f1_val': 0.9923831262681421, 'auprc': 0.9956412304983437, 'loss_val': 0.0597804382856568, 'psi': 0.9936863679602228}
[S11] START round=25 head_norm_before_train=1.252673 cos_to_last_merge=1.0000 (last merge round=24)
[S11] round=25 local utility u=0.000000 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9983502725331426, 'loss_val': 0.20702644943912962, 'psi': 0.9973735607621663}-{'f1_val': 0.9971362493929642, 'auprc': 0.9982941386666151, 'loss_val': 0.14499129028205943, 'psi': 0.9975994051024246}
[S13] START round=25 head_norm_before_train=1.640971 (no previous merge yet)
[S13] round=25 local utility u=0.094388 metrics={'f1_val': 0.5938699658425599, 'auprc': 0.6799252675337054, 'loss_val': 0.7482908697697152, 'psi': 0.6282920865190181}-{'f1_val': 0.5763119186219843, 'auprc': 0.6891614503396054, 'loss_val': 0.8594263622749467, 'psi': 0.6214517313090326}
[S14] START round=25 head_norm_before_train=1.247508 cos_to_last_merge=0.9899 (last merge round=22)
[S14] round=25 local utility u=0.023982 metrics={'f1_val': 0.9968419739193168, 'auprc': 0.9954293268132128, 'loss_val': 0.1409590496496486, 'psi': 0.9962769150768753}-{'f1_val': 0.9961605687915402, 'auprc': 0.9969648544576057, 'loss_val': 0.189441535686058, 'psi': 0.9964822830579665}
[S15] START round=25 head_norm_before_train=1.237978 cos_to_last_merge=1.0000 (last merge round=24)
[S15] round=25 local utility u=0.000000 metrics={'f1_val': 0.7009169771696235, 'auprc': 0.9853788476881171, 'loss_val': 0.4193052861142317, 'psi': 0.814701725377021}-{'f1_val': 0.9893624882870682, 'auprc': 0.9902742676853497, 'loss_val': 0.24144348806442523, 'psi': 0.9897272000463808}
[S16] START round=25 head_norm_before_train=1.162042 cos_to_last_merge=1.0000 (last merge round=24)
[S16] round=25 local utility u=0.000000 metrics={'f1_val': 0.9924322689120962, 'auprc': 0.9860897891948858, 'loss_val': 0.3293900543303375, 'psi': 0.9898952770252121}-{'f1_val': 0.9813242201129025, 'auprc': 0.9899904008180292, 'loss_val': 0.23009496524925047, 'psi': 0.9847906923949532}
[S17] START round=25 head_norm_before_train=1.169495 cos_to_last_merge=1.0000 (last merge round=24)
[S17] round=25 local utility u=0.000000 metrics={'f1_val': 0.35262349161927115, 'auprc': 0.5831679918528399, 'loss_val': 0.9584401451409017, 'psi': 0.4448412917126986}-{'f1_val': 0.35351202434239126, 'auprc': 0.5942629792292243, 'loss_val': 0.9332302923752868, 'psi': 0.4498124062971245}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:41902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:41912
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:41916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:41903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:41916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:41917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:41917
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1795) from S5
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.823888)
[S16] loaded HEAD from S5 (vec_in norm=1.823888)
[S16] cosine check vs S5: cos=0.6902
[S16] BUFFERED delta from S5 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1801) from S6
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.506235)
[S17] loaded HEAD from S6 (vec_in norm=1.506235)
[S17] cosine check vs S6: cos=0.8451
[S17] BUFFERED delta from S6 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1802) from S2
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.678784)
[S17] loaded HEAD from S2 (vec_in norm=1.678784)
[S17] cosine check vs S2: cos=-0.1683
[S17] DROPPED delta from S2 (cos=-0.1683 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1797) from S9
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=2.047451)
[S16] loaded HEAD from S9 (vec_in norm=2.047451)
[S16] cosine check vs S9: cos=0.1803
[S16] BUFFERED delta from S9 (total buffered=2)
[S11] RECEIVED delta(kind=head bytes=1799) from S14
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.298540)
[S11] loaded HEAD from S14 (vec_in norm=1.298540)
[S11] cosine check vs S14: cos=0.9483
[S11] BUFFERED delta from S14 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1799) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.686854)
[S3] loaded HEAD from S8 (vec_in norm=1.686854)
[S3] cosine check vs S8: cos=0.9922
[S3] BUFFERED delta from S8 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1798) from S13
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.648506)
[S2] loaded HEAD from S13 (vec_in norm=1.648506)
[S2] cosine check vs S13: cos=0.9949
[S2] BUFFERED delta from S13 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=25 metric=0.9601 head_norm=1.718887
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.076125e-01
[S3] stored merged vector for next round verification (round=25)
[S3] DEBUG after merge:  round=25 metric=0.9602 head_norm=1.699543 delta_norm=0.107612
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.066 → S17@127.0.0.1:41917
[S4] ⇄ pheromone p=0.048 → S14@127.0.0.1:41914
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=25 metric=0.9967 head_norm=1.300235
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.088376e-01
[S11] stored merged vector for next round verification (round=25)
[S11] DEBUG after merge:  round=25 metric=0.9967 head_norm=1.282496 delta_norm=0.208838
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.067 → S16@127.0.0.1:41916
[S15] ⇄ pheromone p=0.335 → S13@127.0.0.1:41913
[S7] ⇄ pheromone p=0.177 → S4@127.0.0.1:41904
[S10] ⇄ pheromone p=0.049 → S8@127.0.0.1:41909
[S13] ⇄ pheromone p=0.069 → S2@127.0.0.1:41902
[S9] ⇄ pheromone p=0.018 → S16@127.0.0.1:41916
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=25 metric=0.7013 head_norm=1.678784
[S2] _apply_head_vector_avg (torch): Δ‖w‖=8.509678e-02
[S2] stored merged vector for next round verification (round=25)
[S2] DEBUG after merge:  round=25 metric=0.7013 head_norm=1.661536 delta_norm=0.085097
[S2] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.178 → S17@127.0.0.1:41917
[S6] ⇄ pheromone p=0.344 → S17@127.0.0.1:41917
[S8] ⇄ pheromone p=0.078 → S3@127.0.0.1:41903
[S5] ⇄ pheromone p=0.162 → S16@127.0.0.1:41916
[S14] ⇄ pheromone p=0.061 → S11@127.0.0.1:41912
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=25 metric=0.3526 head_norm=1.202384
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.041195e-01
[S17] stored merged vector for next round verification (round=25)
[S17] DEBUG after merge:  round=25 metric=0.3526 head_norm=1.301508 delta_norm=0.404120
[S17] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.026 → S14@127.0.0.1:41914
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=25 metric=0.9924 head_norm=1.201785
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.702882e-01
[S16] stored merged vector for next round verification (round=25)
[S16] DEBUG after merge:  round=25 metric=0.9920 head_norm=1.141706 delta_norm=0.570288
[S16] aggregate: ACCEPT kept=['S5', 'S9'] (k=2/2) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.231 → S15@127.0.0.1:41915
[S2] START round=26 head_norm_before_train=1.661536 cos_to_last_merge=1.0000 (last merge round=25)
[S2] round=26 local utility u=0.000000 metrics={'f1_val': 0.7013101313728686, 'auprc': 0.9106610230547201, 'loss_val': 0.24241966063566556, 'psi': 0.7850504880456093}-{'f1_val': 0.7013101313728686, 'auprc': 0.9753129329690531, 'loss_val': 0.23621377790222833, 'psi': 0.8109112520113424}
[S3] START round=26 head_norm_before_train=1.699543 cos_to_last_merge=1.0000 (last merge round=25)
[S3] round=26 local utility u=0.033659 metrics={'f1_val': 0.9567604349973909, 'auprc': 0.995931184165548, 'loss_val': 0.20619006258859168, 'psi': 0.9724287346646538}-{'f1_val': 0.9601460646946383, 'auprc': 0.9664879629858081, 'loss_val': 0.20549130164796608, 'psi': 0.9626828240111062}
[S4] START round=26 head_norm_before_train=1.840137 (no previous merge yet)
[S4] round=26 local utility u=0.113805 metrics={'f1_val': 0.9501393266621317, 'auprc': 0.9713498705704834, 'loss_val': 0.2671666816301835, 'psi': 0.9586235442254724}-{'f1_val': 0.9370329347669316, 'auprc': 0.9273268054409267, 'loss_val': 0.2840684388965106, 'psi': 0.9331504830365296}
[S5] START round=26 head_norm_before_train=1.823888 (no previous merge yet)
[S5] round=26 local utility u=0.000000 metrics={'f1_val': 0.6785499447383654, 'auprc': 0.9390831965573471, 'loss_val': 0.3443359757115921, 'psi': 0.7827632454659581}-{'f1_val': 0.7396465299940082, 'auprc': 0.9919503071222893, 'loss_val': 0.20198719893223133, 'psi': 0.8405680408453207}
[S6] START round=26 head_norm_before_train=1.506235 cos_to_last_merge=0.8162 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.816
[S6] round=26 local utility u=0.000000 metrics={'f1_val': 0.43485631526492535, 'auprc': 0.8141427104584653, 'loss_val': 0.8619694846650798, 'psi': 0.5865708733423414}-{'f1_val': 0.962305332937172, 'auprc': 0.9627430340125132, 'loss_val': 0.19586152454768208, 'psi': 0.9624804133673085}
[S7] START round=26 head_norm_before_train=1.455554 cos_to_last_merge=0.8335 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.834
[S7] round=26 local utility u=0.123581 metrics={'f1_val': 0.49870433544204695, 'auprc': 0.7816123176015014, 'loss_val': 0.9296215480563559, 'psi': 0.6118675283058288}-{'f1_val': 0.4677178851380075, 'auprc': 0.7815162090849785, 'loss_val': 0.9905760383380009, 'psi': 0.5932372147167959}
[S8] START round=26 head_norm_before_train=1.686854 cos_to_last_merge=0.9981 (last merge round=23)
[S8] round=26 local utility u=0.011706 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9975535498493421, 'loss_val': 0.08461097235471143, 'psi': 0.9967432819798285}-{'f1_val': 0.9962031034001528, 'auprc': 0.9974089045741295, 'loss_val': 0.1075895077301155, 'psi': 0.9966854238697436}
[S9] START round=26 head_norm_before_train=2.047451 (no previous merge yet)
[S9] round=26 local utility u=0.007736 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9994581919613319, 'loss_val': 0.01841362531612229, 'psi': 0.9978948280398872}-{'f1_val': 0.9966924912647621, 'auprc': 0.9947034897935274, 'loss_val': 0.018660275764418727, 'psi': 0.9958968906762683}
[S10] START round=26 head_norm_before_train=1.683020 cos_to_last_merge=0.7563 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.756
[S10] round=26 local utility u=0.016323 metrics={'f1_val': 0.9939643640207476, 'auprc': 0.9956505136996276, 'loss_val': 0.04480399905450985, 'psi': 0.9946388238922996}-{'f1_val': 0.9931054437782314, 'auprc': 0.989389163546758, 'loss_val': 0.05351145668479534, 'psi': 0.9916189316856421}
[S11] START round=26 head_norm_before_train=1.282496 cos_to_last_merge=1.0000 (last merge round=25)
[S11] round=26 local utility u=0.000000 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9981213416308277, 'loss_val': 0.21551484454965072, 'psi': 0.9972819884012403}-{'f1_val': 0.9967224195815153, 'auprc': 0.9983502725331426, 'loss_val': 0.20702644943912962, 'psi': 0.9973735607621663}
[S13] START round=26 head_norm_before_train=1.648506 (no previous merge yet)
[S13] round=26 local utility u=0.000000 metrics={'f1_val': 0.5715439690378189, 'auprc': 0.686134488863037, 'loss_val': 0.8726494674428547, 'psi': 0.6173801769679061}-{'f1_val': 0.5938699658425599, 'auprc': 0.6799252675337054, 'loss_val': 0.7482908697697152, 'psi': 0.6282920865190181}
[S14] START round=26 head_norm_before_train=1.298540 cos_to_last_merge=0.9811 (last merge round=22)
[S14] round=26 local utility u=0.024423 metrics={'f1_val': 0.9974830777164877, 'auprc': 0.998842709917001, 'loss_val': 0.10620056157894535, 'psi': 0.998026930596693}-{'f1_val': 0.9968419739193168, 'auprc': 0.9954293268132128, 'loss_val': 0.1409590496496486, 'psi': 0.9962769150768753}
[S15] START round=26 head_norm_before_train=1.274133 cos_to_last_merge=0.9988 (last merge round=24)
[S15] round=26 local utility u=0.827190 metrics={'f1_val': 0.9566993865907141, 'auprc': 0.9662906762608412, 'loss_val': 0.24235517772336587, 'psi': 0.960535902458765}-{'f1_val': 0.7009169771696235, 'auprc': 0.9853788476881171, 'loss_val': 0.4193052861142317, 'psi': 0.814701725377021}
[S16] START round=26 head_norm_before_train=1.141706 cos_to_last_merge=1.0000 (last merge round=25)
[S16] round=26 local utility u=0.000000 metrics={'f1_val': 0.9329550080656277, 'auprc': 0.9879917725339695, 'loss_val': 0.32755192943075745, 'psi': 0.9549697138529645}-{'f1_val': 0.9924322689120962, 'auprc': 0.9860897891948858, 'loss_val': 0.3293900543303375, 'psi': 0.9898952770252121}
[S17] START round=26 head_norm_before_train=1.301508 cos_to_last_merge=1.0000 (last merge round=25)
[S17] round=26 local utility u=0.039449 metrics={'f1_val': 0.40205100239831076, 'auprc': 0.5106178474182651, 'loss_val': 0.9584562646146242, 'psi': 0.4454777404062925}-{'f1_val': 0.35262349161927115, 'auprc': 0.5831679918528399, 'loss_val': 0.9584401451409017, 'psi': 0.4448412917126986}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S7] → sending delta(kind=head bytes=1807) to S4@127.0.0.1:41904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:41914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:41913
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:41909
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:41912
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:41903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:41917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:41916
[S9] sending update (kind=head size=1795 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1804 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1807 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1804) from S10
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.698248)
[S8] loaded HEAD from S10 (vec_in norm=1.698248)
[S8] cosine check vs S10: cos=0.9904
[S8] BUFFERED delta from S10 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1800) from S3
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.747260)
[S17] loaded HEAD from S3 (vec_in norm=1.747260)
[S17] cosine check vs S3: cos=0.2768
[S17] BUFFERED delta from S3 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1795) from S9
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=2.056865)
[S16] loaded HEAD from S9 (vec_in norm=2.056865)
[S16] cosine check vs S9: cos=0.5466
[S16] BUFFERED delta from S9 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1802) from S15
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.314530)
[S13] loaded HEAD from S15 (vec_in norm=1.314530)
[S13] cosine check vs S15: cos=-0.0766
[S13] DROPPED delta from S15 (cos=-0.0766 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1802) from S4
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.851097)
[S14] loaded HEAD from S4 (vec_in norm=1.851097)
[S14] cosine check vs S4: cos=-0.0213
[S14] DROPPED delta from S4 (cos=-0.0213 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1802) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.716019)
[S3] loaded HEAD from S8 (vec_in norm=1.716019)
[S3] cosine check vs S8: cos=0.9938
[S3] BUFFERED delta from S8 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1807) from S7
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.475055)
[S4] loaded HEAD from S7 (vec_in norm=1.475055)
[S4] cosine check vs S7: cos=-0.1239
[S4] DROPPED delta from S7 (cos=-0.1239 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1801) from S14
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.346013)
[S11] loaded HEAD from S14 (vec_in norm=1.346013)
[S11] cosine check vs S14: cos=0.9779
[S11] BUFFERED delta from S14 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:41914
[S17] sending update (kind=head size=1798 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1798) from S17
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.331478)
[S14] loaded HEAD from S17 (vec_in norm=1.331478)
[S14] cosine check vs S17: cos=0.4517
[S14] BUFFERED delta from S17 (total buffered=1)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=26 metric=0.9967 head_norm=1.332101
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.409573e-01
[S11] stored merged vector for next round verification (round=26)
[S11] DEBUG after merge:  round=26 metric=0.9967 head_norm=1.331635 delta_norm=0.140957
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=26 metric=0.9975 head_norm=1.346013
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.009829e-01
[S14] stored merged vector for next round verification (round=26)
[S14] DEBUG after merge:  round=26 metric=0.9975 head_norm=1.140576 delta_norm=0.700983
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=26 metric=0.9568 head_norm=1.747260
[S3] _apply_head_vector_avg (torch): Δ‖w‖=9.791131e-02
[S3] stored merged vector for next round verification (round=26)
[S3] DEBUG after merge:  round=26 metric=0.9546 head_norm=1.728940 delta_norm=0.097911
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=26 metric=0.9962 head_norm=1.716019
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.183592e-01
[S8] stored merged vector for next round verification (round=26)
[S8] DEBUG after merge:  round=26 metric=0.9964 head_norm=1.703049 delta_norm=0.118359
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=26 metric=0.9330 head_norm=1.191228
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.618570e-01
[S16] stored merged vector for next round verification (round=26)
[S16] DEBUG after merge:  round=26 metric=0.9305 head_norm=1.442935 delta_norm=0.861857
[S16] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=26 metric=0.4021 head_norm=1.331478
[S17] _apply_head_vector_avg (torch): Δ‖w‖=9.404820e-01
[S17] stored merged vector for next round verification (round=26)
[S17] DEBUG after merge:  round=26 metric=0.4807 head_norm=1.236272 delta_norm=0.940482
[S17] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=27 head_norm_before_train=1.680530 cos_to_last_merge=0.9997 (last merge round=25)
[S2] round=27 local utility u=0.000000 metrics={'f1_val': 0.6870445768744802, 'auprc': 0.7881565669481765, 'loss_val': 0.2773063851330735, 'psi': 0.7274893729039587}-{'f1_val': 0.7013101313728686, 'auprc': 0.9106610230547201, 'loss_val': 0.24241966063566556, 'psi': 0.7850504880456093}
[S3] START round=27 head_norm_before_train=1.728940 cos_to_last_merge=1.0000 (last merge round=26)
[S3] round=27 local utility u=0.000000 metrics={'f1_val': 0.8276586536379853, 'auprc': 0.9777723962942059, 'loss_val': 0.47739920194280777, 'psi': 0.8877041507004735}-{'f1_val': 0.9567604349973909, 'auprc': 0.995931184165548, 'loss_val': 0.20619006258859168, 'psi': 0.9724287346646538}
[S4] START round=27 head_norm_before_train=1.851097 (no previous merge yet)
[S4] round=27 local utility u=0.000000 metrics={'f1_val': 0.9433097671173813, 'auprc': 0.9682100818965834, 'loss_val': 0.27637561374952857, 'psi': 0.9532698930290622}-{'f1_val': 0.9501393266621317, 'auprc': 0.9713498705704834, 'loss_val': 0.2671666816301835, 'psi': 0.9586235442254724}
[S5] START round=27 head_norm_before_train=1.834442 (no previous merge yet)
[S5] round=27 local utility u=0.484530 metrics={'f1_val': 0.7993753550686686, 'auprc': 0.9789573722546959, 'loss_val': 0.21985106585136177, 'psi': 0.8712081619430796}-{'f1_val': 0.6785499447383654, 'auprc': 0.9390831965573471, 'loss_val': 0.3443359757115921, 'psi': 0.7827632454659581}
[S6] START round=27 head_norm_before_train=1.521115 cos_to_last_merge=0.8126 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.813
[S6] round=27 local utility u=1.000000 metrics={'f1_val': 0.7960654791991911, 'auprc': 0.9152369553401103, 'loss_val': 0.45536946902829745, 'psi': 0.8437340696555589}-{'f1_val': 0.43485631526492535, 'auprc': 0.8141427104584653, 'loss_val': 0.8619694846650798, 'psi': 0.5865708733423414}
[S7] START round=27 head_norm_before_train=1.475055 cos_to_last_merge=0.8317 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.832
[S7] round=27 local utility u=0.567432 metrics={'f1_val': 0.6136009152929649, 'auprc': 0.7965838685449622, 'loss_val': 0.5290518842121866, 'psi': 0.6867940965937638}-{'f1_val': 0.49870433544204695, 'auprc': 0.7816123176015014, 'loss_val': 0.9296215480563559, 'psi': 0.6118675283058288}
[S8] START round=27 head_norm_before_train=1.703049 cos_to_last_merge=1.0000 (last merge round=26)
[S8] round=27 local utility u=0.000000 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9971607844209536, 'loss_val': 0.09906305062401015, 'psi': 0.9965861758084731}-{'f1_val': 0.9962031034001528, 'auprc': 0.9975535498493421, 'loss_val': 0.08461097235471143, 'psi': 0.9967432819798285}
[S9] START round=27 head_norm_before_train=2.056865 (no previous merge yet)
[S9] round=27 local utility u=0.000000 metrics={'f1_val': 0.9939393793306803, 'auprc': 0.9994267322715895, 'loss_val': 0.022916111519804605, 'psi': 0.9961343205070441}-{'f1_val': 0.9968525854255906, 'auprc': 0.9994581919613319, 'loss_val': 0.01841362531612229, 'psi': 0.9978948280398872}
[S10] START round=27 head_norm_before_train=1.698248 cos_to_last_merge=0.7542 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.754
[S10] round=27 local utility u=0.000000 metrics={'f1_val': 0.9935019932013915, 'auprc': 0.9955853174758884, 'loss_val': 0.046295096914358215, 'psi': 0.9943353229111902}-{'f1_val': 0.9939643640207476, 'auprc': 0.9956505136996276, 'loss_val': 0.04480399905450985, 'psi': 0.9946388238922996}
[S11] START round=27 head_norm_before_train=1.331635 cos_to_last_merge=1.0000 (last merge round=26)
[S11] round=27 local utility u=0.012461 metrics={'f1_val': 0.9971362493929642, 'auprc': 0.9980447145531662, 'loss_val': 0.19284579432005766, 'psi': 0.997499635457045}-{'f1_val': 0.9967224195815153, 'auprc': 0.9981213416308277, 'loss_val': 0.21551484454965072, 'psi': 0.9972819884012403}
[S13] START round=27 head_norm_before_train=1.656876 (no previous merge yet)
[S13] round=27 local utility u=0.000000 metrics={'f1_val': 0.5636806147929184, 'auprc': 0.6921851473508132, 'loss_val': 1.0092568340438983, 'psi': 0.6150824278160764}-{'f1_val': 0.5715439690378189, 'auprc': 0.686134488863037, 'loss_val': 0.8726494674428547, 'psi': 0.6173801769679061}
[S14] START round=27 head_norm_before_train=1.140576 cos_to_last_merge=1.0000 (last merge round=26)
[S14] round=27 local utility u=0.000000 metrics={'f1_val': 0.956788311399204, 'auprc': 0.9950421085824706, 'loss_val': 0.3120957365688727, 'psi': 0.9720898302725106}-{'f1_val': 0.9974830777164877, 'auprc': 0.998842709917001, 'loss_val': 0.10620056157894535, 'psi': 0.998026930596693}
[S15] START round=27 head_norm_before_train=1.314530 cos_to_last_merge=0.9956 (last merge round=24)
[S15] round=27 local utility u=0.000000 metrics={'f1_val': 0.693718821434136, 'auprc': 0.7779112124482446, 'loss_val': 0.44362187723445257, 'psi': 0.7273957778397795}-{'f1_val': 0.9566993865907141, 'auprc': 0.9662906762608412, 'loss_val': 0.24235517772336587, 'psi': 0.960535902458765}
[S16] START round=27 head_norm_before_train=1.442935 cos_to_last_merge=1.0000 (last merge round=26)
[S16] round=27 local utility u=0.000000 metrics={'f1_val': 0.9033146388975941, 'auprc': 0.9860454820879025, 'loss_val': 0.41901715474788004, 'psi': 0.9364069761737175}-{'f1_val': 0.9329550080656277, 'auprc': 0.9879917725339695, 'loss_val': 0.32755192943075745, 'psi': 0.9549697138529645}
[S17] START round=27 head_norm_before_train=1.236272 cos_to_last_merge=1.0000 (last merge round=26)
[S17] round=27 local utility u=0.000000 metrics={'f1_val': 0.3525844685111543, 'auprc': 0.5129079420075022, 'loss_val': 0.969390927569777, 'psi': 0.4167138579096935}-{'f1_val': 0.40205100239831076, 'auprc': 0.5106178474182651, 'loss_val': 0.9584562646146242, 'psi': 0.4454777404062925}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:41914
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1802 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1802) from S11
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.382122)
[S14] loaded HEAD from S11 (vec_in norm=1.382122)
[S14] cosine check vs S11: cos=0.8449
[S14] BUFFERED delta from S11 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=27 metric=0.9568 head_norm=1.179956
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.697565e-01
[S14] stored merged vector for next round verification (round=27)
[S14] DEBUG after merge:  round=27 metric=0.9336 head_norm=1.230674 delta_norm=0.369757
[S14] aggregate: ROLLBACK (f1_val pre=0.957 post=0.934 tol_abs=0.005 tol_rel=0.0)
[S2] START round=28 head_norm_before_train=1.701983 cos_to_last_merge=0.9988 (last merge round=25)
[S2] round=28 local utility u=0.000000 metrics={'f1_val': 0.6846032626717619, 'auprc': 0.7915961005630227, 'loss_val': 0.3150015660795814, 'psi': 0.7274003978282662}-{'f1_val': 0.6870445768744802, 'auprc': 0.7881565669481765, 'loss_val': 0.2773063851330735, 'psi': 0.7274893729039587}
[S3] START round=28 head_norm_before_train=1.775965 cos_to_last_merge=0.9988 (last merge round=26)
[S3] round=28 local utility u=0.722534 metrics={'f1_val': 0.9915430329930095, 'auprc': 0.9980258143504858, 'loss_val': 0.07639832634403897, 'psi': 0.994136145536}-{'f1_val': 0.8276586536379853, 'auprc': 0.9777723962942059, 'loss_val': 0.47739920194280777, 'psi': 0.8877041507004735}
[S4] START round=28 head_norm_before_train=1.857782 (no previous merge yet)
[S4] round=28 local utility u=0.000000 metrics={'f1_val': 0.9406751490519851, 'auprc': 0.9481090061010372, 'loss_val': 0.28596759441113206, 'psi': 0.9436486918716059}-{'f1_val': 0.9433097671173813, 'auprc': 0.9682100818965834, 'loss_val': 0.27637561374952857, 'psi': 0.9532698930290622}
[S5] START round=28 head_norm_before_train=1.841689 (no previous merge yet)
[S5] round=28 local utility u=0.000000 metrics={'f1_val': 0.7004932948021524, 'auprc': 0.8779367623492825, 'loss_val': 0.4010977299737616, 'psi': 0.7714706818210044}-{'f1_val': 0.7993753550686686, 'auprc': 0.9789573722546959, 'loss_val': 0.21985106585136177, 'psi': 0.8712081619430796}
[S6] START round=28 head_norm_before_train=1.532956 cos_to_last_merge=0.8096 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.810
[S6] round=28 local utility u=0.000000 metrics={'f1_val': 0.6963410215671939, 'auprc': 0.9058942265166197, 'loss_val': 0.7006678486349095, 'psi': 0.7801623035469643}-{'f1_val': 0.7960654791991911, 'auprc': 0.9152369553401103, 'loss_val': 0.45536946902829745, 'psi': 0.8437340696555589}
[S7] START round=28 head_norm_before_train=1.490705 cos_to_last_merge=0.8303 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.830
[S7] round=28 local utility u=0.000000 metrics={'f1_val': 0.6133184472888328, 'auprc': 0.7920924265538202, 'loss_val': 0.6947487616963943, 'psi': 0.6848280389948278}-{'f1_val': 0.6136009152929649, 'auprc': 0.7965838685449622, 'loss_val': 0.5290518842121866, 'psi': 0.6867940965937638}
[S8] START round=28 head_norm_before_train=1.731550 cos_to_last_merge=0.9996 (last merge round=26)
[S8] round=28 local utility u=0.002222 metrics={'f1_val': 0.9939919029218467, 'auprc': 0.9979483830051641, 'loss_val': 0.08371372450386726, 'psi': 0.9955744949551737}-{'f1_val': 0.9962031034001528, 'auprc': 0.9971607844209536, 'loss_val': 0.09906305062401015, 'psi': 0.9965861758084731}
[S9] START round=28 head_norm_before_train=2.069223 (no previous merge yet)
[S9] round=28 local utility u=0.008209 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9967834011292719, 'loss_val': 0.017548815341980266, 'psi': 0.9969751079589945}-{'f1_val': 0.9939393793306803, 'auprc': 0.9994267322715895, 'loss_val': 0.022916111519804605, 'psi': 0.9961343205070441}
[S10] START round=28 head_norm_before_train=1.713207 cos_to_last_merge=0.7523 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.752
[S10] round=28 local utility u=0.004538 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9937350499576524, 'loss_val': 0.04127655061476275, 'psi': 0.9945561008287199}-{'f1_val': 0.9935019932013915, 'auprc': 0.9955853174758884, 'loss_val': 0.046295096914358215, 'psi': 0.9943353229111902}
[S11] START round=28 head_norm_before_train=1.382122 cos_to_last_merge=0.9972 (last merge round=26)
[S11] round=28 local utility u=0.029815 metrics={'f1_val': 0.9966988539245482, 'auprc': 0.9980525586953419, 'loss_val': 0.1306149663060585, 'psi': 0.9972403358328656}-{'f1_val': 0.9971362493929642, 'auprc': 0.9980447145531662, 'loss_val': 0.19284579432005766, 'psi': 0.997499635457045}
[S13] START round=28 head_norm_before_train=1.662754 (no previous merge yet)
[S13] round=28 local utility u=0.152785 metrics={'f1_val': 0.5877308989739152, 'auprc': 0.6765531120375116, 'loss_val': 0.8010925415698794, 'psi': 0.6232597841993537}-{'f1_val': 0.5636806147929184, 'auprc': 0.6921851473508132, 'loss_val': 1.0092568340438983, 'psi': 0.6150824278160764}
[S14] START round=28 head_norm_before_train=1.230674 cos_to_last_merge=1.0000 (last merge round=27)
[S14] round=28 local utility u=0.221152 metrics={'f1_val': 0.9970407855713329, 'auprc': 0.9987526394846655, 'loss_val': 0.12243814778133785, 'psi': 0.9977255271366661}-{'f1_val': 0.956788311399204, 'auprc': 0.9950421085824706, 'loss_val': 0.3120957365688727, 'psi': 0.9720898302725106}
[S15] START round=28 head_norm_before_train=1.356411 cos_to_last_merge=0.9913 (last merge round=24)
[S15] round=28 local utility u=1.000000 metrics={'f1_val': 0.9957757960160583, 'auprc': 0.9893391781789985, 'loss_val': 0.11927980379250211, 'psi': 0.9932011488812345}-{'f1_val': 0.693718821434136, 'auprc': 0.7779112124482446, 'loss_val': 0.44362187723445257, 'psi': 0.7273957778397795}
[S16] START round=28 head_norm_before_train=1.491305 cos_to_last_merge=0.9988 (last merge round=26)
[S16] round=28 local utility u=0.414972 metrics={'f1_val': 0.9913522554794518, 'auprc': 0.9824243285917859, 'loss_val': 0.10643523522369293, 'psi': 0.9877810847243855}-{'f1_val': 0.9033146388975941, 'auprc': 0.9860454820879025, 'loss_val': 0.41901715474788004, 'psi': 0.9364069761737175}
[S17] START round=28 head_norm_before_train=1.273142 cos_to_last_merge=0.9976 (last merge round=26)
[S17] round=28 local utility u=0.198457 metrics={'f1_val': 0.40049568939449104, 'auprc': 0.5185268546806836, 'loss_val': 0.8768003034569005, 'psi': 0.44770815550896803}-{'f1_val': 0.3525844685111543, 'auprc': 0.5129079420075022, 'loss_val': 0.969390927569777, 'psi': 0.4167138579096935}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S14] → sending delta(kind=head bytes=1807) to S4@127.0.0.1:41904
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:41911
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:41915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S11] → sending delta(kind=head bytes=1806) to S14@127.0.0.1:41914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1810 reason=None
[S15] → sending delta(kind=head bytes=1810) to S16@127.0.0.1:41916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:41909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:41905
[S3] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1810 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1806 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1807 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1810) from S15
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.390570)
[S16] loaded HEAD from S15 (vec_in norm=1.390570)
[S16] cosine check vs S15: cos=0.7187
[S16] BUFFERED delta from S15 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1796) from S8
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.758634)
[S10] loaded HEAD from S8 (vec_in norm=1.758634)
[S10] cosine check vs S8: cos=0.9927
[S10] BUFFERED delta from S8 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1806) from S11
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.434846)
[S14] loaded HEAD from S11 (vec_in norm=1.434846)
[S14] cosine check vs S11: cos=0.9636
[S14] BUFFERED delta from S11 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1807) from S14
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.281358)
[S4] loaded HEAD from S14 (vec_in norm=1.281358)
[S4] cosine check vs S14: cos=-0.0504
[S4] DROPPED delta from S14 (cos=-0.0504 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1799) from S13
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.669075)
[S15] loaded HEAD from S13 (vec_in norm=1.669075)
[S15] cosine check vs S13: cos=-0.0744
[S15] DROPPED delta from S13 (cos=-0.0744 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1799) from S16
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.529346)
[S5] loaded HEAD from S16 (vec_in norm=1.529346)
[S5] cosine check vs S16: cos=0.2584
[S5] BUFFERED delta from S16 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1799) from S3
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.823816)
[S8] loaded HEAD from S3 (vec_in norm=1.823816)
[S8] cosine check vs S3: cos=0.9894
[S8] BUFFERED delta from S3 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:41907
[S17] sending update (kind=head size=1802 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1802) from S17
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.309152)
[S6] loaded HEAD from S17 (vec_in norm=1.309152)
[S6] cosine check vs S17: cos=0.5305
[S6] BUFFERED delta from S17 (total buffered=1)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=28 metric=0.7005 head_norm=1.849047
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.036372e+00
[S5] stored merged vector for next round verification (round=28)
[S5] DEBUG after merge:  round=28 metric=0.6974 head_norm=1.343454 delta_norm=1.036372
[S5] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=28 metric=0.9951 head_norm=1.729932
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.060449e-01
[S10] stored merged vector for next round verification (round=28)
[S10] DEBUG after merge:  round=28 metric=0.9951 head_norm=1.741116 delta_norm=0.106045
[S10] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=28 metric=0.6963 head_norm=1.544184
[S6] _apply_head_vector_avg (torch): Δ‖w‖=6.988680e-01
[S6] stored merged vector for next round verification (round=28)
[S6] DEBUG after merge:  round=28 metric=0.7204 head_norm=1.249310 delta_norm=0.698868
[S6] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=28 metric=0.9940 head_norm=1.758634
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.345249e-01
[S8] stored merged vector for next round verification (round=28)
[S8] DEBUG after merge:  round=28 metric=0.9944 head_norm=1.786463 delta_norm=0.134525
[S8] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=28 metric=0.9914 head_norm=1.529346
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.513021e-01
[S16] stored merged vector for next round verification (round=28)
[S16] DEBUG after merge:  round=28 metric=0.9916 head_norm=1.353646 delta_norm=0.551302
[S16] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=28 metric=0.9970 head_norm=1.281358
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.984310e-01
[S14] stored merged vector for next round verification (round=28)
[S14] DEBUG after merge:  round=28 metric=0.9970 head_norm=1.345717 delta_norm=0.198431
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=29 head_norm_before_train=1.721593 cos_to_last_merge=0.9977 (last merge round=25)
[S2] round=29 local utility u=0.627547 metrics={'f1_val': 0.8202879485000931, 'auprc': 0.9069980405802015, 'loss_val': 0.22022126379518808, 'psi': 0.8549719853321365}-{'f1_val': 0.6846032626717619, 'auprc': 0.7915961005630227, 'loss_val': 0.3150015660795814, 'psi': 0.7274003978282662}
[S3] START round=29 head_norm_before_train=1.823816 cos_to_last_merge=0.9960 (last merge round=26)
[S3] round=29 local utility u=0.000000 metrics={'f1_val': 0.9665517705990319, 'auprc': 0.9991001285619161, 'loss_val': 0.08911795423050133, 'psi': 0.9795711137841855}-{'f1_val': 0.9915430329930095, 'auprc': 0.9980258143504858, 'loss_val': 0.07639832634403897, 'psi': 0.994136145536}
[S4] START round=29 head_norm_before_train=1.866516 (no previous merge yet)
[S4] round=29 local utility u=0.000000 metrics={'f1_val': 0.9404016289114886, 'auprc': 0.9411109218697005, 'loss_val': 0.291100508430638, 'psi': 0.9406853460947734}-{'f1_val': 0.9406751490519851, 'auprc': 0.9481090061010372, 'loss_val': 0.28596759441113206, 'psi': 0.9436486918716059}
[S5] START round=29 head_norm_before_train=1.343454 cos_to_last_merge=1.0000 (last merge round=28)
[S5] round=29 local utility u=0.060198 metrics={'f1_val': 0.7004069097142683, 'auprc': 0.899560345789769, 'loss_val': 0.34505430794824954, 'psi': 0.7800682841444686}-{'f1_val': 0.7004932948021524, 'auprc': 0.8779367623492825, 'loss_val': 0.4010977299737616, 'psi': 0.7714706818210044}
[S6] START round=29 head_norm_before_train=1.249310 cos_to_last_merge=1.0000 (last merge round=28)
[S6] round=29 local utility u=1.000000 metrics={'f1_val': 0.9317255585448326, 'auprc': 0.9686829984716605, 'loss_val': 0.2743891302115588, 'psi': 0.9465085345155637}-{'f1_val': 0.6963410215671939, 'auprc': 0.9058942265166197, 'loss_val': 0.7006678486349095, 'psi': 0.7801623035469643}
[S7] START round=29 head_norm_before_train=1.508178 cos_to_last_merge=0.8283 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.828
[S7] round=29 local utility u=0.460203 metrics={'f1_val': 0.6861087351378002, 'auprc': 0.8451107186808596, 'loss_val': 0.3701392479291252, 'psi': 0.749709528555024}-{'f1_val': 0.6133184472888328, 'auprc': 0.7920924265538202, 'loss_val': 0.6947487616963943, 'psi': 0.6848280389948278}
[S8] START round=29 head_norm_before_train=1.786463 cos_to_last_merge=1.0000 (last merge round=28)
[S8] round=29 local utility u=0.010658 metrics={'f1_val': 0.9961159308586409, 'auprc': 0.9976846831978146, 'loss_val': 0.07435092370733642, 'psi': 0.9967434317943105}-{'f1_val': 0.9939919029218467, 'auprc': 0.9979483830051641, 'loss_val': 0.08371372450386726, 'psi': 0.9955744949551737}
[S9] START round=29 head_norm_before_train=2.077661 (no previous merge yet)
[S9] round=29 local utility u=0.000000 metrics={'f1_val': 0.9920956129422706, 'auprc': 0.9993474236436033, 'loss_val': 0.02953725720886078, 'psi': 0.9949963372228037}-{'f1_val': 0.9971029125121428, 'auprc': 0.9967834011292719, 'loss_val': 0.017548815341980266, 'psi': 0.9969751079589945}
[S10] START round=29 head_norm_before_train=1.741116 cos_to_last_merge=1.0000 (last merge round=28)
[S10] round=29 local utility u=0.002802 metrics={'f1_val': 0.9947757294679969, 'auprc': 0.9964885227702207, 'loss_val': 0.04196715545960731, 'psi': 0.9954608467888865}-{'f1_val': 0.9951034680760983, 'auprc': 0.9937350499576524, 'loss_val': 0.04127655061476275, 'psi': 0.9945561008287199}
[S11] START round=29 head_norm_before_train=1.434846 cos_to_last_merge=0.9906 (last merge round=26)
[S11] round=29 local utility u=0.019518 metrics={'f1_val': 0.9973780864376928, 'auprc': 0.9981452197045074, 'loss_val': 0.09593327101690584, 'psi': 0.9976849397444187}-{'f1_val': 0.9966988539245482, 'auprc': 0.9980525586953419, 'loss_val': 0.1306149663060585, 'psi': 0.9972403358328656}
[S13] START round=29 head_norm_before_train=1.669075 (no previous merge yet)
[S13] round=29 local utility u=0.007835 metrics={'f1_val': 0.5876468731515977, 'auprc': 0.6750462301914107, 'loss_val': 0.7803981226869674, 'psi': 0.622606615967523}-{'f1_val': 0.5877308989739152, 'auprc': 0.6765531120375116, 'loss_val': 0.8010925415698794, 'psi': 0.6232597841993537}
[S14] START round=29 head_norm_before_train=1.345717 cos_to_last_merge=1.0000 (last merge round=28)
[S14] round=29 local utility u=0.017374 metrics={'f1_val': 0.9963671647723179, 'auprc': 0.9969340164064793, 'loss_val': 0.07819198181747743, 'psi': 0.9965939054259825}-{'f1_val': 0.9970407855713329, 'auprc': 0.9987526394846655, 'loss_val': 0.12243814778133785, 'psi': 0.9977255271366661}
[S15] START round=29 head_norm_before_train=1.390570 cos_to_last_merge=0.9872 (last merge round=24)
[S15] round=29 local utility u=0.000000 metrics={'f1_val': 0.7745595954409668, 'auprc': 0.9865416454738295, 'loss_val': 0.2950119528415145, 'psi': 0.8593524154541119}-{'f1_val': 0.9957757960160583, 'auprc': 0.9893391781789985, 'loss_val': 0.11927980379250211, 'psi': 0.9932011488812345}
[S16] START round=29 head_norm_before_train=1.353646 cos_to_last_merge=1.0000 (last merge round=28)
[S16] round=29 local utility u=0.024978 metrics={'f1_val': 0.9915714808080252, 'auprc': 0.9939985728993268, 'loss_val': 0.09251711252652145, 'psi': 0.9925423176445458}-{'f1_val': 0.9913522554794518, 'auprc': 0.9824243285917859, 'loss_val': 0.10643523522369293, 'psi': 0.9877810847243855}
[S17] START round=29 head_norm_before_train=1.309152 cos_to_last_merge=0.9926 (last merge round=26)
[S17] round=29 local utility u=0.058743 metrics={'f1_val': 0.3884200217905368, 'auprc': 0.5871654404049548, 'loss_val': 0.8927756514127564, 'psi': 0.467918189236304}-{'f1_val': 0.40049568939449104, 'auprc': 0.5185268546806836, 'loss_val': 0.8768003034569005, 'psi': 0.44770815550896803}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] → sending delta(kind=head bytes=1793) to S13@127.0.0.1:41913
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] → sending delta(kind=head bytes=1805) to S5@127.0.0.1:41905
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:41911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:41904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:41915
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S7] sending update (kind=head size=1808 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S11] → sending delta(kind=head bytes=1806) to S14@127.0.0.1:41914
[S11] sending update (kind=head size=1806 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1804 to 1 peers)
[S16] sending update (kind=head size=1805 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1793 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1793) from S2
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.738259)
[S13] loaded HEAD from S2 (vec_in norm=1.738259)
[S13] cosine check vs S2: cos=0.9922
[S13] BUFFERED delta from S2 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1802) from S14
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.389746)
[S4] loaded HEAD from S14 (vec_in norm=1.389746)
[S4] cosine check vs S14: cos=-0.0276
[S4] DROPPED delta from S14 (cos=-0.0276 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1804) from S13
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.673982)
[S15] loaded HEAD from S13 (vec_in norm=1.673982)
[S15] cosine check vs S13: cos=-0.0733
[S15] DROPPED delta from S13 (cos=-0.0733 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1806) from S11
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.480317)
[S14] loaded HEAD from S11 (vec_in norm=1.480317)
[S14] cosine check vs S11: cos=0.9885
[S14] BUFFERED delta from S11 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1797) from S8
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.806434)
[S10] loaded HEAD from S8 (vec_in norm=1.806434)
[S10] cosine check vs S8: cos=0.9932
[S10] BUFFERED delta from S8 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1805) from S16
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.390579)
[S5] loaded HEAD from S16 (vec_in norm=1.390579)
[S5] cosine check vs S16: cos=0.7809
[S5] BUFFERED delta from S16 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:41907
[S17] sending update (kind=head size=1803 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1803) from S17
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.336199)
[S6] loaded HEAD from S17 (vec_in norm=1.336199)
[S6] cosine check vs S17: cos=0.8455
[S6] BUFFERED delta from S17 (total buffered=1)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=29 metric=0.9948 head_norm=1.758214
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.069786e-01
[S10] stored merged vector for next round verification (round=29)
[S10] DEBUG after merge:  round=29 metric=0.9948 head_norm=1.779274 delta_norm=0.106979
[S10] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=29 metric=0.9317 head_norm=1.264233
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.630145e-01
[S6] stored merged vector for next round verification (round=29)
[S6] DEBUG after merge:  round=29 metric=0.9399 head_norm=1.249030 delta_norm=0.363015
[S6] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=29 metric=0.7004 head_norm=1.373860
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.575309e-01
[S5] stored merged vector for next round verification (round=29)
[S5] DEBUG after merge:  round=29 metric=0.7005 head_norm=1.304326 delta_norm=0.457531
[S5] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=29 metric=0.9964 head_norm=1.389746
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.178235e-01
[S14] stored merged vector for next round verification (round=29)
[S14] DEBUG after merge:  round=29 metric=0.9964 head_norm=1.430903 delta_norm=0.117823
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=29 metric=0.5876 head_norm=1.673982
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.111886e-01
[S13] stored merged vector for next round verification (round=29)
[S13] DEBUG after merge:  round=29 metric=0.5888 head_norm=1.702797 delta_norm=0.111189
[S13] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=30 head_norm_before_train=1.738259 cos_to_last_merge=0.9967 (last merge round=25)
[S2] round=30 local utility u=0.000000 metrics={'f1_val': 0.8342908958791058, 'auprc': 0.8751110332020506, 'loss_val': 0.23312755739488622, 'psi': 0.8506189508082836}-{'f1_val': 0.8202879485000931, 'auprc': 0.9069980405802015, 'loss_val': 0.22022126379518808, 'psi': 0.8549719853321365}
[S3] START round=30 head_norm_before_train=1.864110 cos_to_last_merge=0.9934 (last merge round=26)
[S3] round=30 local utility u=0.068219 metrics={'f1_val': 0.9840112540433026, 'auprc': 0.9993671630083721, 'loss_val': 0.05823823600764256, 'psi': 0.9901536176293304}-{'f1_val': 0.9665517705990319, 'auprc': 0.9991001285619161, 'loss_val': 0.08911795423050133, 'psi': 0.9795711137841855}
[S4] START round=30 head_norm_before_train=1.877167 (no previous merge yet)
[S4] round=30 local utility u=0.060580 metrics={'f1_val': 0.9458119296251617, 'auprc': 0.9664910900425396, 'loss_val': 0.27854223084654317, 'psi': 0.9540835937921128}-{'f1_val': 0.9404016289114886, 'auprc': 0.9411109218697005, 'loss_val': 0.291100508430638, 'psi': 0.9406853460947734}
[S5] START round=30 head_norm_before_train=1.304326 cos_to_last_merge=1.0000 (last merge round=29)
[S5] round=30 local utility u=0.050379 metrics={'f1_val': 0.6708467258243431, 'auprc': 0.9802401745966105, 'loss_val': 0.30897404440105386, 'psi': 0.79460410533325}-{'f1_val': 0.7004069097142683, 'auprc': 0.899560345789769, 'loss_val': 0.34505430794824954, 'psi': 0.7800682841444686}
[S6] START round=30 head_norm_before_train=1.249030 cos_to_last_merge=1.0000 (last merge round=29)
[S6] round=30 local utility u=0.000000 metrics={'f1_val': 0.8307386220434035, 'auprc': 0.9501127559588046, 'loss_val': 0.4256229711875722, 'psi': 0.878488275609564}-{'f1_val': 0.9317255585448326, 'auprc': 0.9686829984716605, 'loss_val': 0.2743891302115588, 'psi': 0.9465085345155637}
[S7] START round=30 head_norm_before_train=1.516439 cos_to_last_merge=0.8274 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.827
[S7] round=30 local utility u=0.000000 metrics={'f1_val': 0.6734241717631528, 'auprc': 0.8314949631372708, 'loss_val': 0.3381082780580066, 'psi': 0.7366524883128001}-{'f1_val': 0.6861087351378002, 'auprc': 0.8451107186808596, 'loss_val': 0.3701392479291252, 'psi': 0.749709528555024}
[S8] START round=30 head_norm_before_train=1.806434 cos_to_last_merge=0.9999 (last merge round=28)
[S8] round=30 local utility u=0.003376 metrics={'f1_val': 0.994057704452729, 'auprc': 0.9987792686803159, 'loss_val': 0.05853384604626737, 'psi': 0.9959463301437638}-{'f1_val': 0.9961159308586409, 'auprc': 0.9976846831978146, 'loss_val': 0.07435092370733642, 'psi': 0.9967434317943105}
[S9] START round=30 head_norm_before_train=2.082671 (no previous merge yet)
[S9] round=30 local utility u=0.014753 metrics={'f1_val': 0.9954448862872828, 'auprc': 0.9994764887073806, 'loss_val': 0.0205132337313957, 'psi': 0.9970575272553219}-{'f1_val': 0.9920956129422706, 'auprc': 0.9993474236436033, 'loss_val': 0.02953725720886078, 'psi': 0.9949963372228037}
[S10] START round=30 head_norm_before_train=1.779274 cos_to_last_merge=1.0000 (last merge round=29)
[S10] round=30 local utility u=0.000000 metrics={'f1_val': 0.9946220143540194, 'auprc': 0.9954062419727817, 'loss_val': 0.03873434320292104, 'psi': 0.9949357054015244}-{'f1_val': 0.9947757294679969, 'auprc': 0.9964885227702207, 'loss_val': 0.04196715545960731, 'psi': 0.9954608467888865}
[S11] START round=30 head_norm_before_train=1.480317 cos_to_last_merge=0.9838 (last merge round=26)
[S11] round=30 local utility u=0.007175 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9984433972896096, 'loss_val': 0.0760639920755896, 'psi': 0.997162809686065}-{'f1_val': 0.9973780864376928, 'auprc': 0.9981452197045074, 'loss_val': 0.09593327101690584, 'psi': 0.9976849397444187}
[S13] START round=30 head_norm_before_train=1.702797 cos_to_last_merge=1.0000 (last merge round=29)
[S13] round=30 local utility u=0.000000 metrics={'f1_val': 0.5679146192101058, 'auprc': 0.6883006998283696, 'loss_val': 0.8834100636036581, 'psi': 0.6160690514574113}-{'f1_val': 0.5876468731515977, 'auprc': 0.6750462301914107, 'loss_val': 0.7803981226869674, 'psi': 0.622606615967523}
[S14] START round=30 head_norm_before_train=1.430903 cos_to_last_merge=1.0000 (last merge round=29)
[S14] round=30 local utility u=0.008360 metrics={'f1_val': 0.9965584639862586, 'auprc': 0.9969968800391154, 'loss_val': 0.06280801761826964, 'psi': 0.9967338304074013}-{'f1_val': 0.9963671647723179, 'auprc': 0.9969340164064793, 'loss_val': 0.07819198181747743, 'psi': 0.9965939054259825}
[S15] START round=30 head_norm_before_train=1.417529 cos_to_last_merge=0.9841 (last merge round=24)
[S15] round=30 local utility u=0.000000 metrics={'f1_val': 0.7966399149928305, 'auprc': 0.9465588766932386, 'loss_val': 0.3520521188170998, 'psi': 0.8566074996729938}-{'f1_val': 0.7745595954409668, 'auprc': 0.9865416454738295, 'loss_val': 0.2950119528415145, 'psi': 0.8593524154541119}
[S16] START round=30 head_norm_before_train=1.390579 cos_to_last_merge=0.9996 (last merge round=28)
[S16] round=30 local utility u=0.000000 metrics={'f1_val': 0.921859923903899, 'auprc': 0.9864130949781568, 'loss_val': 0.32031024725280044, 'psi': 0.9476811923336022}-{'f1_val': 0.9915714808080252, 'auprc': 0.9939985728993268, 'loss_val': 0.09251711252652145, 'psi': 0.9925423176445458}
[S17] START round=30 head_norm_before_train=1.336199 cos_to_last_merge=0.9881 (last merge round=26)
[S17] round=30 local utility u=0.265931 metrics={'f1_val': 0.39391692807729023, 'auprc': 0.750493114102353, 'loss_val': 0.8838786593299376, 'psi': 0.5365474024873154}-{'f1_val': 0.3884200217905368, 'auprc': 0.5871654404049548, 'loss_val': 0.8927756514127564, 'psi': 0.467918189236304}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.996)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.997)
[S5] not sending this round → trigger blocked (psi=0.795)
[S14] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:41908
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:41909
[S4] sending update (kind=head size=1796 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1800) from S3
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.894623)
[S8] loaded HEAD from S3 (vec_in norm=1.894623)
[S8] cosine check vs S3: cos=0.9935
[S8] BUFFERED delta from S3 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1796) from S4
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.882450)
[S7] loaded HEAD from S4 (vec_in norm=1.882450)
[S7] cosine check vs S4: cos=-0.1201
[S7] DROPPED delta from S4 (cos=-0.1201 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.537)
[S15] ⇄ pheromone p=0.306 → S16@127.0.0.1:41916
[S2] ⇄ pheromone p=0.159 → S13@127.0.0.1:41913
[S14] ⇄ pheromone p=0.055 → S4@127.0.0.1:41904
[S13] ⇄ pheromone p=0.044 → S15@127.0.0.1:41915
[S11] ⇄ pheromone p=0.031 → S14@127.0.0.1:41914
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=30 metric=0.9941 head_norm=1.824862
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.113609e-01
[S8] stored merged vector for next round verification (round=30)
[S8] DEBUG after merge:  round=30 metric=0.9941 head_norm=1.856733 delta_norm=0.111361
[S8] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.029 → S10@127.0.0.1:41911
[S3] ⇄ pheromone p=0.131 → S8@127.0.0.1:41909
[S4] ⇄ pheromone p=0.037 → S7@127.0.0.1:41908
[S17] ⇄ pheromone p=0.100 → S6@127.0.0.1:41907
[S16] ⇄ pheromone p=0.133 → S15@127.0.0.1:41915
[S2] START round=31 head_norm_before_train=1.752461 cos_to_last_merge=0.9958 (last merge round=25)
[S2] round=31 local utility u=0.000000 metrics={'f1_val': 0.7880414010582262, 'auprc': 0.8347153338585693, 'loss_val': 0.2642344719628961, 'psi': 0.8067109741783635}-{'f1_val': 0.8342908958791058, 'auprc': 0.8751110332020506, 'loss_val': 0.23312755739488622, 'psi': 0.8506189508082836}
[S3] START round=31 head_norm_before_train=1.894623 cos_to_last_merge=0.9913 (last merge round=26)
[S3] round=31 local utility u=0.029578 metrics={'f1_val': 0.9941571734936763, 'auprc': 0.998579703202946, 'loss_val': 0.05759507632380481, 'psi': 0.9959261853773842}-{'f1_val': 0.9840112540433026, 'auprc': 0.9993671630083721, 'loss_val': 0.05823823600764256, 'psi': 0.9901536176293304}
[S4] START round=31 head_norm_before_train=1.882450 (no previous merge yet)
[S4] round=31 local utility u=0.003906 metrics={'f1_val': 0.9474673896060122, 'auprc': 0.9640484611570869, 'loss_val': 0.27333504409916937, 'psi': 0.954099818226442}-{'f1_val': 0.9458119296251617, 'auprc': 0.9664910900425396, 'loss_val': 0.27854223084654317, 'psi': 0.9540835937921128}
[S5] START round=31 head_norm_before_train=1.377475 cos_to_last_merge=0.9926 (last merge round=29)
[S5] round=31 local utility u=0.083581 metrics={'f1_val': 0.7004069097142683, 'auprc': 0.974748574222675, 'loss_val': 0.30269757865535574, 'psi': 0.810143575517631}-{'f1_val': 0.6708467258243431, 'auprc': 0.9802401745966105, 'loss_val': 0.30897404440105386, 'psi': 0.79460410533325}
[S6] START round=31 head_norm_before_train=1.279481 cos_to_last_merge=0.9992 (last merge round=29)
[S6] round=31 local utility u=0.000000 metrics={'f1_val': 0.7902404789193064, 'auprc': 0.9227526326580049, 'loss_val': 0.4161763126225182, 'psi': 0.8432453404147857}-{'f1_val': 0.8307386220434035, 'auprc': 0.9501127559588046, 'loss_val': 0.4256229711875722, 'psi': 0.878488275609564}
[S7] START round=31 head_norm_before_train=1.518410 cos_to_last_merge=0.8267 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.827
[S7] round=31 local utility u=0.000000 metrics={'f1_val': 0.617447690417979, 'auprc': 0.7928589736640789, 'loss_val': 0.5922070797397572, 'psi': 0.687612203716419}-{'f1_val': 0.6734241717631528, 'auprc': 0.8314949631372708, 'loss_val': 0.3381082780580066, 'psi': 0.7366524883128001}
[S8] START round=31 head_norm_before_train=1.856733 cos_to_last_merge=1.0000 (last merge round=30)
[S8] round=31 local utility u=0.000000 metrics={'f1_val': 0.9645301779646707, 'auprc': 0.9987504865328628, 'loss_val': 0.18299744326374712, 'psi': 0.9782183013919475}-{'f1_val': 0.994057704452729, 'auprc': 0.9987792686803159, 'loss_val': 0.05853384604626737, 'psi': 0.9959463301437638}
[S9] START round=31 head_norm_before_train=2.090683 (no previous merge yet)
[S9] round=31 local utility u=0.000000 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9941888512646633, 'loss_val': 0.018266819074983228, 'psi': 0.9956910352647226}-{'f1_val': 0.9954448862872828, 'auprc': 0.9994764887073806, 'loss_val': 0.0205132337313957, 'psi': 0.9970575272553219}
[S10] START round=31 head_norm_before_train=1.793650 cos_to_last_merge=1.0000 (last merge round=29)
[S10] round=31 local utility u=0.000000 metrics={'f1_val': 0.9935262985458464, 'auprc': 0.9956602865103729, 'loss_val': 0.03992986253110553, 'psi': 0.994379893731657}-{'f1_val': 0.9946220143540194, 'auprc': 0.9954062419727817, 'loss_val': 0.03873434320292104, 'psi': 0.9949357054015244}
[S11] START round=31 head_norm_before_train=1.516500 cos_to_last_merge=0.9781 (last merge round=26)
[S11] round=31 local utility u=0.006467 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9984303421392112, 'loss_val': 0.06454207510742957, 'psi': 0.9973026898527428}-{'f1_val': 0.9963090846170353, 'auprc': 0.9984433972896096, 'loss_val': 0.0760639920755896, 'psi': 0.997162809686065}
[S13] START round=31 head_norm_before_train=1.707515 cos_to_last_merge=1.0000 (last merge round=29)
[S13] round=31 local utility u=0.121740 metrics={'f1_val': 0.5910848670294451, 'auprc': 0.6740297430836072, 'loss_val': 0.7361380959017976, 'psi': 0.6242628174511099}-{'f1_val': 0.5679146192101058, 'auprc': 0.6883006998283696, 'loss_val': 0.8834100636036581, 'psi': 0.6160690514574113}
[S14] START round=31 head_norm_before_train=1.467042 cos_to_last_merge=0.9998 (last merge round=29)
[S14] round=31 local utility u=0.010598 metrics={'f1_val': 0.9972190428647041, 'auprc': 0.9988470805970999, 'loss_val': 0.051125775890076865, 'psi': 0.9978702579576625}-{'f1_val': 0.9965584639862586, 'auprc': 0.9969968800391154, 'loss_val': 0.06280801761826964, 'psi': 0.9967338304074013}
[S15] START round=31 head_norm_before_train=1.442982 cos_to_last_merge=0.9812 (last merge round=24)
[S15] round=31 local utility u=0.000000 metrics={'f1_val': 0.684663765268861, 'auprc': 0.7240784630546221, 'loss_val': 0.5356205146072833, 'psi': 0.7004296443831655}-{'f1_val': 0.7966399149928305, 'auprc': 0.9465588766932386, 'loss_val': 0.3520521188170998, 'psi': 0.8566074996729938}
[S16] START round=31 head_norm_before_train=1.421877 cos_to_last_merge=0.9987 (last merge round=28)
[S16] round=31 local utility u=0.344411 metrics={'f1_val': 0.9913593826744562, 'auprc': 0.995412474140196, 'loss_val': 0.07548295417697913, 'psi': 0.9929806192607521}-{'f1_val': 0.921859923903899, 'auprc': 0.9864130949781568, 'loss_val': 0.32031024725280044, 'psi': 0.9476811923336022}
[S17] START round=31 head_norm_before_train=1.361723 cos_to_last_merge=0.9847 (last merge round=26)
[S17] round=31 local utility u=0.025653 metrics={'f1_val': 0.39102828798208605, 'auprc': 0.7855833706171382, 'loss_val': 0.9205115889512497, 'psi': 0.548850321036107}-{'f1_val': 0.39391692807729023, 'auprc': 0.750493114102353, 'loss_val': 0.8838786593299376, 'psi': 0.5365474024873154}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:41914
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.996)
[S4] not sending this round → trigger blocked (psi=0.954)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:41915
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] → sending delta(kind=head bytes=1804) to S4@127.0.0.1:41904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:41915
[S14] sending update (kind=head size=1804 to 1 peers)
[S13] sending update (kind=head size=1803 to 1 peers)
[S16] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1803) from S16
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.445370)
[S15] loaded HEAD from S16 (vec_in norm=1.445370)
[S15] cosine check vs S16: cos=0.9238
[S15] BUFFERED delta from S16 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1803) from S11
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.548382)
[S14] loaded HEAD from S11 (vec_in norm=1.548382)
[S14] cosine check vs S11: cos=0.9929
[S14] BUFFERED delta from S11 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1803) from S13
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.712479)
[S15] loaded HEAD from S13 (vec_in norm=1.712479)
[S15] cosine check vs S13: cos=-0.0708
[S15] DROPPED delta from S13 (cos=-0.0708 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1804) from S14
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.493779)
[S4] loaded HEAD from S14 (vec_in norm=1.493779)
[S4] cosine check vs S14: cos=-0.0166
[S4] DROPPED delta from S14 (cos=-0.0166 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:41907
[S17] sending update (kind=head size=1800 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1800) from S17
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.385993)
[S6] loaded HEAD from S17 (vec_in norm=1.385993)
[S6] cosine check vs S17: cos=0.9447
[S6] BUFFERED delta from S17 (total buffered=1)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=31 metric=0.7902 head_norm=1.319595
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.272346e-01
[S6] stored merged vector for next round verification (round=31)
[S6] DEBUG after merge:  round=31 metric=0.8002 head_norm=1.333986 delta_norm=0.227235
[S6] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=31 metric=0.9972 head_norm=1.493779
[S14] _apply_head_vector_avg (torch): Δ‖w‖=9.493490e-02
[S14] stored merged vector for next round verification (round=31)
[S14] DEBUG after merge:  round=31 metric=0.9970 head_norm=1.518361 delta_norm=0.094935
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=31 metric=0.6847 head_norm=1.467842
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.845023e-01
[S15] stored merged vector for next round verification (round=31)
[S15] DEBUG after merge:  round=31 metric=0.6836 head_norm=1.428596 delta_norm=0.284502
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=32 head_norm_before_train=1.767228 cos_to_last_merge=0.9947 (last merge round=25)
[S2] round=32 local utility u=0.333567 metrics={'f1_val': 0.8580133637987375, 'auprc': 0.9039379806925577, 'loss_val': 0.22460107064495483, 'psi': 0.8763832105562657}-{'f1_val': 0.7880414010582262, 'auprc': 0.8347153338585693, 'loss_val': 0.2642344719628961, 'psi': 0.8067109741783635}
[S3] START round=32 head_norm_before_train=1.920973 cos_to_last_merge=0.9894 (last merge round=26)
[S3] round=32 local utility u=0.000000 metrics={'f1_val': 0.9615385219550141, 'auprc': 0.9971612607835889, 'loss_val': 0.10113721161147417, 'psi': 0.975787617486444}-{'f1_val': 0.9941571734936763, 'auprc': 0.998579703202946, 'loss_val': 0.05759507632380481, 'psi': 0.9959261853773842}
[S4] START round=32 head_norm_before_train=1.886102 (no previous merge yet)
[S4] round=32 local utility u=0.006883 metrics={'f1_val': 0.950626320554421, 'auprc': 0.9615552346626914, 'loss_val': 0.27104244568652613, 'psi': 0.9549978861977292}-{'f1_val': 0.9474673896060122, 'auprc': 0.9640484611570869, 'loss_val': 0.27333504409916937, 'psi': 0.954099818226442}
[S5] START round=32 head_norm_before_train=1.457258 cos_to_last_merge=0.9801 (last merge round=29)
[S5] round=32 local utility u=0.303137 metrics={'f1_val': 0.7783208247766138, 'auprc': 0.9896801024992765, 'loss_val': 0.20870145030971055, 'psi': 0.8628645358656789}-{'f1_val': 0.7004069097142683, 'auprc': 0.974748574222675, 'loss_val': 0.30269757865535574, 'psi': 0.810143575517631}
[S6] START round=32 head_norm_before_train=1.333986 cos_to_last_merge=1.0000 (last merge round=31)
[S6] round=32 local utility u=0.000000 metrics={'f1_val': 0.4162380722994735, 'auprc': 0.759637712210037, 'loss_val': 0.835247033034076, 'psi': 0.5535979282636989}-{'f1_val': 0.7902404789193064, 'auprc': 0.9227526326580049, 'loss_val': 0.4161763126225182, 'psi': 0.8432453404147857}
[S7] START round=32 head_norm_before_train=1.527081 cos_to_last_merge=0.8254 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.825
[S7] round=32 local utility u=0.659530 metrics={'f1_val': 0.7274548575186188, 'auprc': 0.8928318154611905, 'loss_val': 0.23310923499437936, 'psi': 0.7936056406956475}-{'f1_val': 0.617447690417979, 'auprc': 0.7928589736640789, 'loss_val': 0.5922070797397572, 'psi': 0.687612203716419}
[S8] START round=32 head_norm_before_train=1.874795 cos_to_last_merge=0.9999 (last merge round=30)
[S8] round=32 local utility u=0.152563 metrics={'f1_val': 0.9939122747783468, 'auprc': 0.9978166193631729, 'loss_val': 0.05136250308538398, 'psi': 0.9954740126122772}-{'f1_val': 0.9645301779646707, 'auprc': 0.9987504865328628, 'loss_val': 0.18299744326374712, 'psi': 0.9782183013919475}
[S9] START round=32 head_norm_before_train=2.100086 (no previous merge yet)
[S9] round=32 local utility u=0.004632 metrics={'f1_val': 0.9958601375429889, 'auprc': 0.9994631875871114, 'loss_val': 0.019831469157979044, 'psi': 0.9973013575606378}-{'f1_val': 0.9966924912647621, 'auprc': 0.9941888512646633, 'loss_val': 0.018266819074983228, 'psi': 0.9956910352647226}
[S10] START round=32 head_norm_before_train=1.806340 cos_to_last_merge=0.9998 (last merge round=29)
[S10] round=32 local utility u=0.002935 metrics={'f1_val': 0.9939643640207476, 'auprc': 0.9956913537657126, 'loss_val': 0.03678207438145451, 'psi': 0.9946551599187337}-{'f1_val': 0.9935262985458464, 'auprc': 0.9956602865103729, 'loss_val': 0.03992986253110553, 'psi': 0.994379893731657}
[S11] START round=32 head_norm_before_train=1.548382 cos_to_last_merge=0.9733 (last merge round=26)
[S11] round=32 local utility u=0.004712 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9983976378060173, 'loss_val': 0.056049877284141486, 'psi': 0.9973925068713161}-{'f1_val': 0.9965509216617638, 'auprc': 0.9984303421392112, 'loss_val': 0.06454207510742957, 'psi': 0.9973026898527428}
[S13] START round=32 head_norm_before_train=1.712479 cos_to_last_merge=1.0000 (last merge round=29)
[S13] round=32 local utility u=0.000000 metrics={'f1_val': 0.5458600231770933, 'auprc': 0.6930606308980943, 'loss_val': 0.8622301129928576, 'psi': 0.6047402662654937}-{'f1_val': 0.5910848670294451, 'auprc': 0.6740297430836072, 'loss_val': 0.7361380959017976, 'psi': 0.6242628174511099}
[S14] START round=32 head_norm_before_train=1.518361 cos_to_last_merge=1.0000 (last merge round=31)
[S14] round=32 local utility u=0.000794 metrics={'f1_val': 0.9970202894562089, 'auprc': 0.9985097779181128, 'loss_val': 0.04733270629098316, 'psi': 0.9976160848409705}-{'f1_val': 0.9972190428647041, 'auprc': 0.9988470805970999, 'loss_val': 0.051125775890076865, 'psi': 0.9978702579576625}
[S15] START round=32 head_norm_before_train=1.428596 cos_to_last_merge=1.0000 (last merge round=31)
[S15] round=32 local utility u=0.291500 metrics={'f1_val': 0.71407521661543, 'auprc': 0.8568844849867103, 'loss_val': 0.5275071882034897, 'psi': 0.7711989239639422}-{'f1_val': 0.684663765268861, 'auprc': 0.7240784630546221, 'loss_val': 0.5356205146072833, 'psi': 0.7004296443831655}
[S16] START round=32 head_norm_before_train=1.445370 cos_to_last_merge=0.9978 (last merge round=28)
[S16] round=32 local utility u=0.000000 metrics={'f1_val': 0.9913080206785505, 'auprc': 0.9904007095485916, 'loss_val': 0.07316738058582051, 'psi': 0.990945096226567}-{'f1_val': 0.9913593826744562, 'auprc': 0.995412474140196, 'loss_val': 0.07548295417697913, 'psi': 0.9929806192607521}
[S17] START round=32 head_norm_before_train=1.385993 cos_to_last_merge=0.9817 (last merge round=26)
[S17] round=32 local utility u=0.000000 metrics={'f1_val': 0.3597793290765149, 'auprc': 0.8314120737421902, 'loss_val': 1.0562311916635643, 'psi': 0.548432426942785}-{'f1_val': 0.39102828798208605, 'auprc': 0.7855833706171382, 'loss_val': 0.9205115889512497, 'psi': 0.548850321036107}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:41904
[S11] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S5] not sending this round → trigger blocked (psi=0.863)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:41916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:41908
[S14] not sending this round → trigger blocked (psi=0.998)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:41909
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:41903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:41913
[S2] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1804 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1803) from S10
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.818660)
[S8] loaded HEAD from S10 (vec_in norm=1.818660)
[S8] cosine check vs S10: cos=0.9923
[S8] BUFFERED delta from S10 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1799) from S4
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.888810)
[S7] loaded HEAD from S4 (vec_in norm=1.888810)
[S7] cosine check vs S4: cos=-0.1173
[S7] DROPPED delta from S4 (cos=-0.1173 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1800) from S8
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.888752)
[S3] loaded HEAD from S8 (vec_in norm=1.888752)
[S3] cosine check vs S8: cos=0.9965
[S3] BUFFERED delta from S8 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1804) from S15
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.447422)
[S16] loaded HEAD from S15 (vec_in norm=1.447422)
[S16] cosine check vs S15: cos=0.9798
[S16] BUFFERED delta from S15 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1803) from S2
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.780833)
[S13] loaded HEAD from S2 (vec_in norm=1.780833)
[S13] cosine check vs S2: cos=0.9959
[S13] BUFFERED delta from S2 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1800) from S7
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.536721)
[S4] loaded HEAD from S7 (vec_in norm=1.536721)
[S4] cosine check vs S7: cos=-0.1173
[S4] DROPPED delta from S7 (cos=-0.1173 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=32 metric=0.5459 head_norm=1.718398
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.529795e-02
[S13] stored merged vector for next round verification (round=32)
[S13] DEBUG after merge:  round=32 metric=0.5508 head_norm=1.747814 delta_norm=0.085298
[S13] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=32 metric=0.9615 head_norm=1.942689
[S3] _apply_head_vector_avg (torch): Δ‖w‖=8.489592e-02
[S3] stored merged vector for next round verification (round=32)
[S3] DEBUG after merge:  round=32 metric=0.9615 head_norm=1.914028 delta_norm=0.084896
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=32 metric=0.9913 head_norm=1.465417
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.466791e-01
[S16] stored merged vector for next round verification (round=32)
[S16] DEBUG after merge:  round=32 metric=0.9913 head_norm=1.449042 delta_norm=0.146679
[S16] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=32 metric=0.9939 head_norm=1.888752
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.204967e-01
[S8] stored merged vector for next round verification (round=32)
[S8] DEBUG after merge:  round=32 metric=0.9939 head_norm=1.850118 delta_norm=0.120497
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=33 head_norm_before_train=1.780833 cos_to_last_merge=0.9936 (last merge round=25)
[S2] round=33 local utility u=0.010280 metrics={'f1_val': 0.8385444943226208, 'auprc': 0.9455196855976195, 'loss_val': 0.21197311971835572, 'psi': 0.8813345708326202}-{'f1_val': 0.8580133637987375, 'auprc': 0.9039379806925577, 'loss_val': 0.22460107064495483, 'psi': 0.8763832105562657}
[S3] START round=33 head_norm_before_train=1.914028 cos_to_last_merge=1.0000 (last merge round=32)
[S3] round=33 local utility u=0.000000 metrics={'f1_val': 0.9445812586962943, 'auprc': 0.9964978891954199, 'loss_val': 0.1518045249839308, 'psi': 0.9653479108959446}-{'f1_val': 0.9615385219550141, 'auprc': 0.9971612607835889, 'loss_val': 0.10113721161147417, 'psi': 0.975787617486444}
[S4] START round=33 head_norm_before_train=1.888810 (no previous merge yet)
[S4] round=33 local utility u=0.000000 metrics={'f1_val': 0.9415549611589321, 'auprc': 0.9468734526100594, 'loss_val': 0.2873429504190288, 'psi': 0.943682357739383}-{'f1_val': 0.950626320554421, 'auprc': 0.9615552346626914, 'loss_val': 0.27104244568652613, 'psi': 0.9549978861977292}
[S5] START round=33 head_norm_before_train=1.516305 cos_to_last_merge=0.9704 (last merge round=29)
[S5] round=33 local utility u=0.232417 metrics={'f1_val': 0.8765503147696316, 'auprc': 0.966526591278746, 'loss_val': 0.26378421290613274, 'psi': 0.9125408253732774}-{'f1_val': 0.7783208247766138, 'auprc': 0.9896801024992765, 'loss_val': 0.20870145030971055, 'psi': 0.8628645358656789}
[S6] START round=33 head_norm_before_train=1.368406 cos_to_last_merge=0.9991 (last merge round=31)
[S6] round=33 local utility u=1.000000 metrics={'f1_val': 0.80897924924773, 'auprc': 0.9447374601478387, 'loss_val': 0.3623274218261074, 'psi': 0.8632825336077734}-{'f1_val': 0.4162380722994735, 'auprc': 0.759637712210037, 'loss_val': 0.835247033034076, 'psi': 0.5535979282636989}
[S7] START round=33 head_norm_before_train=1.536721 cos_to_last_merge=0.8238 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.824
[S7] round=33 local utility u=0.000000 metrics={'f1_val': 0.465306121090184, 'auprc': 0.7788962694819814, 'loss_val': 1.0076998107712671, 'psi': 0.590742180446903}-{'f1_val': 0.7274548575186188, 'auprc': 0.8928318154611905, 'loss_val': 0.23310923499437936, 'psi': 0.7936056406956475}
[S8] START round=33 head_norm_before_train=1.850118 cos_to_last_merge=1.0000 (last merge round=32)
[S8] round=33 local utility u=0.000000 metrics={'f1_val': 0.9931808101287989, 'auprc': 0.9985791778887078, 'loss_val': 0.05102171010140167, 'psi': 0.9953401572327625}-{'f1_val': 0.9939122747783468, 'auprc': 0.9978166193631729, 'loss_val': 0.05136250308538398, 'psi': 0.9954740126122772}
[S9] START round=33 head_norm_before_train=2.110298 (no previous merge yet)
[S9] round=33 local utility u=0.002241 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9988584709073947, 'loss_val': 0.018337766676089353, 'psi': 0.9975396954512927}-{'f1_val': 0.9958601375429889, 'auprc': 0.9994631875871114, 'loss_val': 0.019831469157979044, 'psi': 0.9973013575606378}
[S10] START round=33 head_norm_before_train=1.818660 cos_to_last_merge=0.9997 (last merge round=29)
[S10] round=33 local utility u=0.000654 metrics={'f1_val': 0.9939643640207476, 'auprc': 0.9957470604994237, 'loss_val': 0.035641967031701, 'psi': 0.994677442612218}-{'f1_val': 0.9939643640207476, 'auprc': 0.9956913537657126, 'loss_val': 0.03678207438145451, 'psi': 0.9946551599187337}
[S11] START round=33 head_norm_before_train=1.576658 cos_to_last_merge=0.9693 (last merge round=26)
[S11] round=33 local utility u=0.003778 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9987435702617684, 'loss_val': 0.049531429962003, 'psi': 0.9975308798536167}-{'f1_val': 0.9967224195815153, 'auprc': 0.9983976378060173, 'loss_val': 0.056049877284141486, 'psi': 0.9973925068713161}
[S13] START round=33 head_norm_before_train=1.747814 cos_to_last_merge=1.0000 (last merge round=32)
[S13] round=33 local utility u=0.087691 metrics={'f1_val': 0.5708653138855885, 'auprc': 0.6875751311008378, 'loss_val': 0.8204234373905123, 'psi': 0.6175492407716883}-{'f1_val': 0.5458600231770933, 'auprc': 0.6930606308980943, 'loss_val': 0.8622301129928576, 'psi': 0.6047402662654937}
[S14] START round=33 head_norm_before_train=1.538230 cos_to_last_merge=0.9999 (last merge round=31)
[S14] round=33 local utility u=0.000000 metrics={'f1_val': 0.9947363892425176, 'auprc': 0.9992023593397609, 'loss_val': 0.05381469399388989, 'psi': 0.9965227772814149}-{'f1_val': 0.9970202894562089, 'auprc': 0.9985097779181128, 'loss_val': 0.04733270629098316, 'psi': 0.9976160848409705}
[S15] START round=33 head_norm_before_train=1.447422 cos_to_last_merge=0.9999 (last merge round=31)
[S15] round=33 local utility u=1.000000 metrics={'f1_val': 0.9838942115257729, 'auprc': 0.9928134502871306, 'loss_val': 0.11558312650042786, 'psi': 0.9874619070303161}-{'f1_val': 0.71407521661543, 'auprc': 0.8568844849867103, 'loss_val': 0.5275071882034897, 'psi': 0.7711989239639422}
[S16] START round=33 head_norm_before_train=1.449042 cos_to_last_merge=1.0000 (last merge round=32)
[S16] round=33 local utility u=0.000000 metrics={'f1_val': 0.8496964471700323, 'auprc': 0.912033013570256, 'loss_val': 0.7284966258634665, 'psi': 0.8746310737301217}-{'f1_val': 0.9913080206785505, 'auprc': 0.9904007095485916, 'loss_val': 0.07316738058582051, 'psi': 0.990945096226567}
[S17] START round=33 head_norm_before_train=1.409370 cos_to_last_merge=0.9789 (last merge round=26)
[S17] round=33 local utility u=0.068557 metrics={'f1_val': 0.4411668102653021, 'auprc': 0.6649620420563297, 'loss_val': 0.9080928966653008, 'psi': 0.5306849029817131}-{'f1_val': 0.3597793290765149, 'auprc': 0.8314120737421902, 'loss_val': 1.0562311916635643, 'psi': 0.548432426942785}
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S3]  timeout peer S2
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S16
[S13]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S10
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S16
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S14
[S15]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S10
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S16
[S8]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S5]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S7
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S2]  timeout peer S3
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:41917
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] sending update (kind=head size=1794 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] → sending delta(kind=head bytes=1805) to S14@127.0.0.1:41914
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:41909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:41913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:41915
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:41916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1805 to 1 peers)
[S6] sending update (kind=head size=1803 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1801) from S15
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.460291)
[S16] loaded HEAD from S15 (vec_in norm=1.460291)
[S16] cosine check vs S15: cos=0.9943
[S16] BUFFERED delta from S15 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1803) from S6
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.398608)
[S17] loaded HEAD from S6 (vec_in norm=1.398608)
[S17] cosine check vs S6: cos=0.9736
[S17] BUFFERED delta from S6 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1805) from S11
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.601944)
[S14] loaded HEAD from S11 (vec_in norm=1.601944)
[S14] cosine check vs S11: cos=0.9958
[S14] BUFFERED delta from S11 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1801) from S13
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.758059)
[S15] loaded HEAD from S13 (vec_in norm=1.758059)
[S15] cosine check vs S13: cos=-0.0626
[S15] DROPPED delta from S13 (cos=-0.0626 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1801) from S10
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.832525)
[S8] loaded HEAD from S10 (vec_in norm=1.832525)
[S8] cosine check vs S10: cos=0.9974
[S8] BUFFERED delta from S10 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1801) from S2
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.792082)
[S13] loaded HEAD from S2 (vec_in norm=1.792082)
[S13] cosine check vs S2: cos=0.9985
[S13] BUFFERED delta from S2 (total buffered=1)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=33 metric=0.9932 head_norm=1.865357
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.868481e-02
[S8] stored merged vector for next round verification (round=33)
[S8] DEBUG after merge:  round=33 metric=0.9932 head_norm=1.847738 delta_norm=0.068685
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:41907
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=33 metric=0.5709 head_norm=1.758059
[S13] _apply_head_vector_avg (torch): Δ‖w‖=5.117659e-02
[S13] stored merged vector for next round verification (round=33)
[S13] DEBUG after merge:  round=33 metric=0.5722 head_norm=1.774415 delta_norm=0.051177
[S13] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=33 metric=0.9947 head_norm=1.557131
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.574189e-02
[S14] stored merged vector for next round verification (round=33)
[S14] DEBUG after merge:  round=33 metric=0.9935 head_norm=1.577880 delta_norm=0.075742
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S17] sending update (kind=head size=1800 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1800) from S17
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.432127)
[S6] loaded HEAD from S17 (vec_in norm=1.432127)
[S6] cosine check vs S17: cos=0.9736
[S6] BUFFERED delta from S17 (total buffered=1)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=33 metric=0.4412 head_norm=1.432127
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.633501e-01
[S17] stored merged vector for next round verification (round=33)
[S17] DEBUG after merge:  round=33 metric=0.4387 head_norm=1.406010 delta_norm=0.163350
[S17] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S16] CommDone barrier timeout: have=1 need=3 — continuing
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=33 metric=0.8497 head_norm=1.467229
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.791958e-02
[S16] stored merged vector for next round verification (round=33)
[S16] DEBUG after merge:  round=33 metric=0.8497 head_norm=1.461688 delta_norm=0.077920
[S16] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=34 head_norm_before_train=1.792082 cos_to_last_merge=0.9927 (last merge round=25)
[S2] round=34 local utility u=0.008113 metrics={'f1_val': 0.8552928182370434, 'auprc': 0.921941013184148, 'loss_val': 0.22550163536199783, 'psi': 0.8819520962158853}-{'f1_val': 0.8385444943226208, 'auprc': 0.9455196855976195, 'loss_val': 0.21197311971835572, 'psi': 0.8813345708326202}
[S3] START round=34 head_norm_before_train=1.933432 cos_to_last_merge=0.9999 (last merge round=32)
[S3] round=34 local utility u=0.049248 metrics={'f1_val': 0.9607804860280988, 'auprc': 0.9914642189744476, 'loss_val': 0.13540238096921756, 'psi': 0.9730539792066384}-{'f1_val': 0.9445812586962943, 'auprc': 0.9964978891954199, 'loss_val': 0.1518045249839308, 'psi': 0.9653479108959446}
[S4] START round=34 head_norm_before_train=1.891866 (no previous merge yet)
[S4] round=34 local utility u=0.000000 metrics={'f1_val': 0.9416582735354956, 'auprc': 0.9338677458719485, 'loss_val': 0.296112473710289, 'psi': 0.9385420624700768}-{'f1_val': 0.9415549611589321, 'auprc': 0.9468734526100594, 'loss_val': 0.2873429504190288, 'psi': 0.943682357739383}
[S5] START round=34 head_norm_before_train=1.566370 cos_to_last_merge=0.9619 (last merge round=29)
[S5] round=34 local utility u=0.466687 metrics={'f1_val': 0.9958503366986691, 'auprc': 0.9901187835743392, 'loss_val': 0.11698741485380146, 'psi': 0.9935577154489372}-{'f1_val': 0.8765503147696316, 'auprc': 0.966526591278746, 'loss_val': 0.26378421290613274, 'psi': 0.9125408253732774}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] sending update (kind=head size=1805 to 1 peers)
[S6] START round=34 head_norm_before_train=1.398608 cos_to_last_merge=0.9973 (last merge round=31)
[S6] round=34 local utility u=0.000000 metrics={'f1_val': 0.7529070792577292, 'auprc': 0.9475445376691163, 'loss_val': 0.4637032776770063, 'psi': 0.830762062622284}-{'f1_val': 0.80897924924773, 'auprc': 0.9447374601478387, 'loss_val': 0.3623274218261074, 'psi': 0.8632825336077734}
[S7] START round=34 head_norm_before_train=1.541195 cos_to_last_merge=0.8231 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.823
[S7] round=34 local utility u=0.792019 metrics={'f1_val': 0.6403979071481094, 'auprc': 0.7967058907244942, 'loss_val': 0.5276412750771948, 'psi': 0.7029211005786633}-{'f1_val': 0.465306121090184, 'auprc': 0.7788962694819814, 'loss_val': 1.0076998107712671, 'psi': 0.590742180446903}
[S8] START round=34 head_norm_before_train=1.847738 cos_to_last_merge=1.0000 (last merge round=33)
[S8] round=34 local utility u=0.000000 metrics={'f1_val': 0.9888526342761694, 'auprc': 0.9987006208868172, 'loss_val': 0.06409526172368371, 'psi': 0.9927918289204285}-{'f1_val': 0.9931808101287989, 'auprc': 0.9985791778887078, 'loss_val': 0.05102171010140167, 'psi': 0.9953401572327625}
[S9] START round=34 head_norm_before_train=2.115743 (no previous merge yet)
[S9] round=34 local utility u=0.000000 metrics={'f1_val': 0.9931032914010764, 'auprc': 0.9997482329333354, 'loss_val': 0.024185536297407637, 'psi': 0.99576126801398}-{'f1_val': 0.9966605118138915, 'auprc': 0.9988584709073947, 'loss_val': 0.018337766676089353, 'psi': 0.9975396954512927}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=34 head_norm_before_train=1.832525 cos_to_last_merge=0.9994 (last merge round=29)
[S10] round=34 local utility u=0.000000 metrics={'f1_val': 0.9939400388726987, 'auprc': 0.9957632662806553, 'loss_val': 0.03597443542826709, 'psi': 0.9946693298358813}-{'f1_val': 0.9939643640207476, 'auprc': 0.9957470604994237, 'loss_val': 0.035641967031701, 'psi': 0.994677442612218}
[S11] START round=34 head_norm_before_train=1.601944 cos_to_last_merge=0.9659 (last merge round=26)
[S11] round=34 local utility u=0.002149 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.998637104050422, 'loss_val': 0.04491310304231603, 'psi': 0.9974882933690781}-{'f1_val': 0.9967224195815153, 'auprc': 0.9987435702617684, 'loss_val': 0.049531429962003, 'psi': 0.9975308798536167}
[S13] START round=34 head_norm_before_train=1.774415 cos_to_last_merge=1.0000 (last merge round=33)
[S13] round=34 local utility u=0.000000 metrics={'f1_val': 0.5496049737865883, 'auprc': 0.6968421254186361, 'loss_val': 0.862212973380437, 'psi': 0.6084998344394075}-{'f1_val': 0.5708653138855885, 'auprc': 0.6875751311008378, 'loss_val': 0.8204234373905123, 'psi': 0.6175492407716883}
[S14] START round=34 head_norm_before_train=1.577880 cos_to_last_merge=1.0000 (last merge round=33)
[S14] round=34 local utility u=0.014567 metrics={'f1_val': 0.9972183481640888, 'auprc': 0.9987960220959491, 'loss_val': 0.038352881691833804, 'psi': 0.9978494177368329}-{'f1_val': 0.9947363892425176, 'auprc': 0.9992023593397609, 'loss_val': 0.05381469399388989, 'psi': 0.9965227772814149}
[S15] START round=34 head_norm_before_train=1.460291 cos_to_last_merge=0.9998 (last merge round=31)
[S15] round=34 local utility u=0.000000 metrics={'f1_val': 0.6912996762193591, 'auprc': 0.9636613835823317, 'loss_val': 0.4778723501879974, 'psi': 0.8002443591645481}-{'f1_val': 0.9838942115257729, 'auprc': 0.9928134502871306, 'loss_val': 0.11558312650042786, 'psi': 0.9874619070303161}
[S16] START round=34 head_norm_before_train=1.461688 cos_to_last_merge=1.0000 (last merge round=33)
[S16] round=34 local utility u=0.859617 metrics={'f1_val': 0.9895872661163049, 'auprc': 0.9882782492740545, 'loss_val': 0.07734295616364137, 'psi': 0.9890636593794047}-{'f1_val': 0.8496964471700323, 'auprc': 0.912033013570256, 'loss_val': 0.7284966258634665, 'psi': 0.8746310737301217}
[S17] START round=34 head_norm_before_train=1.406010 cos_to_last_merge=1.0000 (last merge round=33)
[S17] round=34 local utility u=0.450668 metrics={'f1_val': 0.5749279377381427, 'auprc': 0.7385465750019472, 'loss_val': 1.030076596357596, 'psi': 0.6403753926436645}-{'f1_val': 0.4411668102653021, 'auprc': 0.6649620420563297, 'loss_val': 0.9080928966653008, 'psi': 0.5306849029817131}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] → sending delta(kind=head bytes=1805) to S8@127.0.0.1:41909
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:41913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:41904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:41914
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1805 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=34 metric=0.7529 head_norm=1.431233
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.823146e-01
[S6] stored merged vector for next round verification (round=34)
[S6] DEBUG after merge:  round=34 metric=0.7542 head_norm=1.420024 delta_norm=0.182315
[S6] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] RECEIVED delta(kind=head bytes=1797) from S2
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.801983)
[S13] loaded HEAD from S2 (vec_in norm=1.801983)
[S13] cosine check vs S2: cos=0.9993
[S13] BUFFERED delta from S2 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1805) from S3
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.955310)
[S8] loaded HEAD from S3 (vec_in norm=1.955310)
[S8] cosine check vs S3: cos=0.9904
[S8] BUFFERED delta from S3 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1803) from S11
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.623203)
[S14] loaded HEAD from S11 (vec_in norm=1.623203)
[S14] cosine check vs S11: cos=0.9982
[S14] BUFFERED delta from S11 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1800) from S7
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.546723)
[S4] loaded HEAD from S7 (vec_in norm=1.546723)
[S4] cosine check vs S7: cos=-0.1169
[S4] DROPPED delta from S7 (cos=-0.1169 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:41904
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=34 metric=0.5496 head_norm=1.781245
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.441624e-02
[S13] stored merged vector for next round verification (round=34)
[S13] DEBUG after merge:  round=34 metric=0.5472 head_norm=1.791313 delta_norm=0.034416
[S13] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=34 metric=0.9889 head_norm=1.864784
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.397554e-01
[S8] stored merged vector for next round verification (round=34)
[S8] DEBUG after merge:  round=34 metric=0.9889 head_norm=1.905465 delta_norm=0.139755
[S8] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S14] sending update (kind=head size=1798 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1798) from S14
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.596915)
[S4] loaded HEAD from S14 (vec_in norm=1.596915)
[S4] cosine check vs S14: cos=-0.0019
[S4] DROPPED delta from S14 (cos=-0.0019 < 0.0)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=34 metric=0.9972 head_norm=1.596915
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.007398e-02
[S14] stored merged vector for next round verification (round=34)
[S14] DEBUG after merge:  round=34 metric=0.9972 head_norm=1.609334 delta_norm=0.050074
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] → sending delta(kind=head bytes=1805) to S6@127.0.0.1:41907
[S17] sending update (kind=head size=1805 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1805) from S17
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.424445)
[S6] loaded HEAD from S17 (vec_in norm=1.424445)
[S6] cosine check vs S17: cos=0.9997
[S6] BUFFERED delta from S17 (total buffered=1)
[S2]  timeout peer S13
[S3]  timeout peer S8
[S11]  timeout peer S14
[S8]  timeout peer S10
[S4]  timeout peer S7
[S16]  timeout peer S5
[S16]  timeout peer S9
[S16]  timeout peer S11
[S13]  timeout peer S15
[S14]  timeout peer S4
[S14]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S6
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S2] START round=35 head_norm_before_train=1.801983 cos_to_last_merge=0.9919 (last merge round=25)
[S2] round=35 local utility u=0.000000 metrics={'f1_val': 0.7802436108058692, 'auprc': 0.8841990349855213, 'loss_val': 0.26295216911082697, 'psi': 0.82182578047773}-{'f1_val': 0.8552928182370434, 'auprc': 0.921941013184148, 'loss_val': 0.22550163536199783, 'psi': 0.8819520962158853}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=35 head_norm_before_train=1.955310 cos_to_last_merge=0.9997 (last merge round=32)
[S3] round=35 local utility u=0.000000 metrics={'f1_val': 0.833986085085597, 'auprc': 0.9770793055972374, 'loss_val': 0.4791939396504341, 'psi': 0.8912233732902533}-{'f1_val': 0.9607804860280988, 'auprc': 0.9914642189744476, 'loss_val': 0.13540238096921756, 'psi': 0.9730539792066384}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=35 head_norm_before_train=1.900597 (no previous merge yet)
[S4] round=35 local utility u=0.007116 metrics={'f1_val': 0.9412324073369782, 'auprc': 0.9403257006002695, 'loss_val': 0.2986981966245148, 'psi': 0.9408697246422948}-{'f1_val': 0.9416582735354956, 'auprc': 0.9338677458719485, 'loss_val': 0.296112473710289, 'psi': 0.9385420624700768}
[S5] START round=35 head_norm_before_train=1.598513 cos_to_last_merge=0.9566 (last merge round=29)
[S5] round=35 local utility u=0.000000 metrics={'f1_val': 0.9714256627136244, 'auprc': 0.9892716492054489, 'loss_val': 0.1130885956180053, 'psi': 0.9785640573103542}-{'f1_val': 0.9958503366986691, 'auprc': 0.9901187835743392, 'loss_val': 0.11698741485380146, 'psi': 0.9935577154489372}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=35 head_norm_before_train=1.420024 cos_to_last_merge=1.0000 (last merge round=34)
[S6] round=35 local utility u=0.055040 metrics={'f1_val': 0.7876199906884676, 'auprc': 0.9405746076376427, 'loss_val': 0.5409913211790628, 'psi': 0.8488018374681376}-{'f1_val': 0.7529070792577292, 'auprc': 0.9475445376691163, 'loss_val': 0.4637032776770063, 'psi': 0.830762062622284}
[S7] START round=35 head_norm_before_train=1.546723 cos_to_last_merge=0.8224 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.822
[S7] round=35 local utility u=0.393599 metrics={'f1_val': 0.6928070311064807, 'auprc': 0.8681330297693908, 'loss_val': 0.2691798710823289, 'psi': 0.7629374305716448}-{'f1_val': 0.6403979071481094, 'auprc': 0.7967058907244942, 'loss_val': 0.5276412750771948, 'psi': 0.7029211005786633}
[S8] START round=35 head_norm_before_train=1.905465 cos_to_last_merge=1.0000 (last merge round=34)
[S8] round=35 local utility u=0.021363 metrics={'f1_val': 0.9931808101287989, 'auprc': 0.9979856152104615, 'loss_val': 0.04519363347015869, 'psi': 0.9951027321614639}-{'f1_val': 0.9888526342761694, 'auprc': 0.9987006208868172, 'loss_val': 0.06409526172368371, 'psi': 0.9927918289204285}
[S9] START round=35 head_norm_before_train=2.121696 (no previous merge yet)
[S9] round=35 local utility u=0.013835 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9983431011330272, 'loss_val': 0.016297546650523884, 'psi': 0.9975989879604965}-{'f1_val': 0.9931032914010764, 'auprc': 0.9997482329333354, 'loss_val': 0.024185536297407637, 'psi': 0.99576126801398}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=35 head_norm_before_train=1.846755 cos_to_last_merge=0.9991 (last merge round=29)
[S10] round=35 local utility u=0.000000 metrics={'f1_val': 0.9935262985458464, 'auprc': 0.9957283074786164, 'loss_val': 0.0348228495649232, 'psi': 0.9944071021189544}-{'f1_val': 0.9939400388726987, 'auprc': 0.9957632662806553, 'loss_val': 0.03597443542826709, 'psi': 0.9946693298358813}
[S11] START round=35 head_norm_before_train=1.623203 cos_to_last_merge=0.9630 (last merge round=26)
[S11] round=35 local utility u=0.001852 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9987551697844039, 'loss_val': 0.04156301476156608, 'psi': 0.9975355196626707}-{'f1_val': 0.9967224195815153, 'auprc': 0.998637104050422, 'loss_val': 0.04491310304231603, 'psi': 0.9974882933690781}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] sending update (kind=head size=1803 to 1 peers)
[S13] START round=35 head_norm_before_train=1.791313 cos_to_last_merge=1.0000 (last merge round=34)
[S13] round=35 local utility u=0.340781 metrics={'f1_val': 0.6175186241253925, 'auprc': 0.6840236199442394, 'loss_val': 0.5496773434623033, 'psi': 0.6441206224529312}-{'f1_val': 0.5496049737865883, 'auprc': 0.6968421254186361, 'loss_val': 0.862212973380437, 'psi': 0.6084998344394075}
[S14] START round=35 head_norm_before_train=1.609334 cos_to_last_merge=1.0000 (last merge round=34)
[S14] round=35 local utility u=0.000000 metrics={'f1_val': 0.9966305087305161, 'auprc': 0.9985715897182648, 'loss_val': 0.042733380214171786, 'psi': 0.9974069411256156}-{'f1_val': 0.9972183481640888, 'auprc': 0.9987960220959491, 'loss_val': 0.038352881691833804, 'psi': 0.9978494177368329}
[S15] START round=35 head_norm_before_train=1.471364 cos_to_last_merge=0.9997 (last merge round=31)
[S15] round=35 local utility u=1.000000 metrics={'f1_val': 0.9963755136436562, 'auprc': 0.9907439669315337, 'loss_val': 0.08290429208153419, 'psi': 0.9941228949588072}-{'f1_val': 0.6912996762193591, 'auprc': 0.9636613835823317, 'loss_val': 0.4778723501879974, 'psi': 0.8002443591645481}
[S16] START round=35 head_norm_before_train=1.478482 cos_to_last_merge=0.9999 (last merge round=33)
[S16] round=35 local utility u=0.000782 metrics={'f1_val': 0.9893221238222667, 'auprc': 0.9877363724102799, 'loss_val': 0.07256260338874618, 'psi': 0.988687823257472}-{'f1_val': 0.9895872661163049, 'auprc': 0.9882782492740545, 'loss_val': 0.07734295616364137, 'psi': 0.9890636593794047}
[S17] START round=35 head_norm_before_train=1.424445 cos_to_last_merge=0.9999 (last merge round=33)
[S17] round=35 local utility u=0.424841 metrics={'f1_val': 0.6569078581418444, 'auprc': 0.849394864950921, 'loss_val': 1.0048179964651613, 'psi': 0.7339026608654751}-{'f1_val': 0.5749279377381427, 'auprc': 0.7385465750019472, 'loss_val': 1.030076596357596, 'psi': 0.6403753926436645}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] sending update (kind=head size=1795 to 1 peers)
[S16] not sending this round → trigger blocked (psi=0.989)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S7] sending update (kind=head size=1807 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=35 metric=0.7876 head_norm=1.448470
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.817670e-02
[S6] stored merged vector for next round verification (round=35)
[S6] DEBUG after merge:  round=35 metric=0.7889 head_norm=1.436000 delta_norm=0.038177
[S6] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S2] START round=36 head_norm_before_train=1.811869 cos_to_last_merge=0.9911 (last merge round=25)
[S2] round=36 local utility u=0.253455 metrics={'f1_val': 0.8407880419786293, 'auprc': 0.9208568825863847, 'loss_val': 0.22928237638568666, 'psi': 0.8728155782217315}-{'f1_val': 0.7802436108058692, 'auprc': 0.8841990349855213, 'loss_val': 0.26295216911082697, 'psi': 0.82182578047773}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] sending update (kind=head size=1795 to 1 peers)
[S3] START round=36 head_norm_before_train=1.974715 cos_to_last_merge=0.9994 (last merge round=32)
[S3] round=36 local utility u=0.709676 metrics={'f1_val': 0.9888241780088588, 'auprc': 0.9984516153712152, 'loss_val': 0.052988269847340126, 'psi': 0.9926751529538014}-{'f1_val': 0.833986085085597, 'auprc': 0.9770793055972374, 'loss_val': 0.4791939396504341, 'psi': 0.8912233732902533}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=36 head_norm_before_train=1.913700 (no previous merge yet)
[S4] round=36 local utility u=0.000000 metrics={'f1_val': 0.9411378777379223, 'auprc': 0.9362355416124488, 'loss_val': 0.304258608901223, 'psi': 0.939176943287733}-{'f1_val': 0.9412324073369782, 'auprc': 0.9403257006002695, 'loss_val': 0.2986981966245148, 'psi': 0.9408697246422948}
[S5] START round=36 head_norm_before_train=1.625983 cos_to_last_merge=0.9512 (last merge round=29)
[S5] round=36 local utility u=0.107004 metrics={'f1_val': 0.9962633185437604, 'auprc': 0.9971636526647538, 'loss_val': 0.07178341704291126, 'psi': 0.9966234521921578}-{'f1_val': 0.9714256627136244, 'auprc': 0.9892716492054489, 'loss_val': 0.1130885956180053, 'psi': 0.9785640573103542}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] sending update (kind=head size=1805 to 1 peers)
[S6] START round=36 head_norm_before_train=1.436000 cos_to_last_merge=1.0000 (last merge round=35)
[S6] round=36 local utility u=0.268095 metrics={'f1_val': 0.8255856622634394, 'auprc': 0.9674429884349416, 'loss_val': 0.3132013280582755, 'psi': 0.8823285927320403}-{'f1_val': 0.7876199906884676, 'auprc': 0.9405746076376427, 'loss_val': 0.5409913211790628, 'psi': 0.8488018374681376}
[S7] START round=36 head_norm_before_train=1.552719 cos_to_last_merge=0.8212 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.821
[S7] round=36 local utility u=0.319204 metrics={'f1_val': 0.8357509844989781, 'auprc': 0.8295143778875348, 'loss_val': 0.37258047194365645, 'psi': 0.8332563418544008}-{'f1_val': 0.6928070311064807, 'auprc': 0.8681330297693908, 'loss_val': 0.2691798710823289, 'psi': 0.7629374305716448}
[S8] START round=36 head_norm_before_train=1.920619 cos_to_last_merge=1.0000 (last merge round=34)
[S8] round=36 local utility u=0.000000 metrics={'f1_val': 0.9875580199363212, 'auprc': 0.9985649800099183, 'loss_val': 0.06763403677077799, 'psi': 0.99196080396576}-{'f1_val': 0.9931808101287989, 'auprc': 0.9979856152104615, 'loss_val': 0.04519363347015869, 'psi': 0.9951027321614639}
[S9] START round=36 head_norm_before_train=2.132394 (no previous merge yet)
[S9] round=36 local utility u=0.000000 metrics={'f1_val': 0.9939393793306803, 'auprc': 0.9995865463184167, 'loss_val': 0.021791194756359843, 'psi': 0.9961982461257749}-{'f1_val': 0.9971029125121428, 'auprc': 0.9983431011330272, 'loss_val': 0.016297546650523884, 'psi': 0.9975989879604965}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=36 head_norm_before_train=1.860619 cos_to_last_merge=0.9988 (last merge round=29)
[S10] round=36 local utility u=0.000000 metrics={'f1_val': 0.9935262985458464, 'auprc': 0.995715093885962, 'loss_val': 0.035106228887429564, 'psi': 0.9944018166818926}-{'f1_val': 0.9935262985458464, 'auprc': 0.9957283074786164, 'loss_val': 0.0348228495649232, 'psi': 0.9944071021189544}
[S11] START round=36 head_norm_before_train=1.641735 cos_to_last_merge=0.9607 (last merge round=26)
[S11] round=36 local utility u=0.001255 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9987547705189389, 'loss_val': 0.039052657858148154, 'psi': 0.9975353599564848}-{'f1_val': 0.9967224195815153, 'auprc': 0.9987551697844039, 'loss_val': 0.04156301476156608, 'psi': 0.9975355196626707}
[S11] not sending this round → trigger blocked (psi=0.998)
[S13] START round=36 head_norm_before_train=1.798417 cos_to_last_merge=1.0000 (last merge round=34)
[S13] round=36 local utility u=0.000000 metrics={'f1_val': 0.5332467142294068, 'auprc': 0.7004378848426202, 'loss_val': 0.9868769135338336, 'psi': 0.6001231824746922}-{'f1_val': 0.6175186241253925, 'auprc': 0.6840236199442394, 'loss_val': 0.5496773434623033, 'psi': 0.6441206224529312}
[S14] START round=36 head_norm_before_train=1.624848 cos_to_last_merge=0.9999 (last merge round=34)
[S14] round=36 local utility u=0.005189 metrics={'f1_val': 0.9970202894562089, 'auprc': 0.9991444428731026, 'loss_val': 0.036412078481564546, 'psi': 0.9978699508229665}-{'f1_val': 0.9966305087305161, 'auprc': 0.9985715897182648, 'loss_val': 0.042733380214171786, 'psi': 0.9974069411256156}
[S15] START round=36 head_norm_before_train=1.481549 cos_to_last_merge=0.9995 (last merge round=31)
[S15] round=36 local utility u=0.000000 metrics={'f1_val': 0.8321599038100892, 'auprc': 0.9884544959106791, 'loss_val': 0.21792015564722494, 'psi': 0.8946777406503252}-{'f1_val': 0.9963755136436562, 'auprc': 0.9907439669315337, 'loss_val': 0.08290429208153419, 'psi': 0.9941228949588072}
[S16] START round=36 head_norm_before_train=1.495531 cos_to_last_merge=0.9998 (last merge round=33)
[S16] round=36 local utility u=0.001028 metrics={'f1_val': 0.9896077289455275, 'auprc': 0.9889323670771377, 'loss_val': 0.07580813021674607, 'psi': 0.9893375841981715}-{'f1_val': 0.9893221238222667, 'auprc': 0.9877363724102799, 'loss_val': 0.07256260338874618, 'psi': 0.988687823257472}
[S17] START round=36 head_norm_before_train=1.440896 cos_to_last_merge=0.9996 (last merge round=33)
[S17] round=36 local utility u=0.000000 metrics={'f1_val': 0.5554427839625332, 'auprc': 0.8233861398928136, 'loss_val': 0.7791941338223003, 'psi': 0.6626201263346454}-{'f1_val': 0.6569078581418444, 'auprc': 0.849394864950921, 'loss_val': 1.0048179964651613, 'psi': 0.7339026608654751}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.882)
[S7] not sending this round → trigger blocked (psi=0.833)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=37 head_norm_before_train=1.823123 cos_to_last_merge=0.9902 (last merge round=25)
[S2] round=37 local utility u=0.214329 metrics={'f1_val': 0.8961787737845834, 'auprc': 0.9391515086986243, 'loss_val': 0.1878536047141326, 'psi': 0.9133678677501997}-{'f1_val': 0.8407880419786293, 'auprc': 0.9208568825863847, 'loss_val': 0.22928237638568666, 'psi': 0.8728155782217315}
[S2] not sending this round → trigger blocked (psi=0.913)
[S3] START round=37 head_norm_before_train=1.994209 cos_to_last_merge=0.9991 (last merge round=32)
[S3] round=37 local utility u=0.000000 metrics={'f1_val': 0.7896844478978098, 'auprc': 0.9326581463272262, 'loss_val': 0.5956258833602959, 'psi': 0.8468739272695763}-{'f1_val': 0.9888241780088588, 'auprc': 0.9984516153712152, 'loss_val': 0.052988269847340126, 'psi': 0.9926751529538014}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=37 head_norm_before_train=1.926752 (no previous merge yet)
[S4] round=37 local utility u=0.010321 metrics={'f1_val': 0.9411378777379223, 'auprc': 0.942971980044811, 'loss_val': 0.3038253146493018, 'psi': 0.9418715186606779}-{'f1_val': 0.9411378777379223, 'auprc': 0.9362355416124488, 'loss_val': 0.304258608901223, 'psi': 0.939176943287733}
[S5] START round=37 head_norm_before_train=1.650343 cos_to_last_merge=0.9468 (last merge round=29)
[S5] ⚠️ Model drifted since last merge! cos=0.947
[S5] round=37 local utility u=0.006028 metrics={'f1_val': 0.9966309045197074, 'auprc': 0.9986975461449905, 'loss_val': 0.06653372262024349, 'psi': 0.9974575611698207}-{'f1_val': 0.9962633185437604, 'auprc': 0.9971636526647538, 'loss_val': 0.07178341704291126, 'psi': 0.9966234521921578}
[S5] not sending this round → trigger blocked (psi=0.997)
[S6] START round=37 head_norm_before_train=1.464447 cos_to_last_merge=0.9996 (last merge round=35)
[S6] round=37 local utility u=0.000000 metrics={'f1_val': 0.7824945680670434, 'auprc': 0.9493127784051256, 'loss_val': 0.38291390078886334, 'psi': 0.8492218522022763}-{'f1_val': 0.8255856622634394, 'auprc': 0.9674429884349416, 'loss_val': 0.3132013280582755, 'psi': 0.8823285927320403}
[S7] START round=37 head_norm_before_train=1.557852 cos_to_last_merge=0.8203 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.820
[S7] round=37 local utility u=0.000000 metrics={'f1_val': 0.5626707523611417, 'auprc': 0.7847779953235474, 'loss_val': 0.800911483931079, 'psi': 0.651513649546104}-{'f1_val': 0.8357509844989781, 'auprc': 0.8295143778875348, 'loss_val': 0.37258047194365645, 'psi': 0.8332563418544008}
[S8] START round=37 head_norm_before_train=1.934851 cos_to_last_merge=0.9998 (last merge round=34)
[S8] round=37 local utility u=0.026195 metrics={'f1_val': 0.9931548986711313, 'auprc': 0.9978761023222138, 'loss_val': 0.04675768081648244, 'psi': 0.9950433801315642}-{'f1_val': 0.9875580199363212, 'auprc': 0.9985649800099183, 'loss_val': 0.06763403677077799, 'psi': 0.99196080396576}
[S9] START round=37 head_norm_before_train=2.137404 (no previous merge yet)
[S9] round=37 local utility u=0.012024 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9995502855114091, 'loss_val': 0.01661552235088351, 'psi': 0.9980818617118493}-{'f1_val': 0.9939393793306803, 'auprc': 0.9995865463184167, 'loss_val': 0.021791194756359843, 'psi': 0.9961982461257749}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=37 head_norm_before_train=1.873982 cos_to_last_merge=0.9985 (last merge round=29)
[S10] round=37 local utility u=0.000000 metrics={'f1_val': 0.9935262985458464, 'auprc': 0.995719929740926, 'loss_val': 0.03520531614197623, 'psi': 0.9944037510238782}-{'f1_val': 0.9935262985458464, 'auprc': 0.995715093885962, 'loss_val': 0.035106228887429564, 'psi': 0.9944018166818926}
[S11] START round=37 head_norm_before_train=1.659039 cos_to_last_merge=0.9585 (last merge round=26)
[S11] round=37 local utility u=0.001108 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9987539334456885, 'loss_val': 0.03683448541727202, 'psi': 0.9975350251271846}-{'f1_val': 0.9967224195815153, 'auprc': 0.9987547705189389, 'loss_val': 0.039052657858148154, 'psi': 0.9975353599564848}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] sending update (kind=head size=1803 to 1 peers)
[S13] START round=37 head_norm_before_train=1.806024 cos_to_last_merge=0.9999 (last merge round=34)
[S13] round=37 local utility u=0.231257 metrics={'f1_val': 0.5836046170980587, 'auprc': 0.7046612014611918, 'loss_val': 0.8391804969939921, 'psi': 0.6320272508433119}-{'f1_val': 0.5332467142294068, 'auprc': 0.7004378848426202, 'loss_val': 0.9868769135338336, 'psi': 0.6001231824746922}
[S14] START round=37 head_norm_before_train=1.638179 cos_to_last_merge=0.9998 (last merge round=34)
[S14] round=37 local utility u=0.002748 metrics={'f1_val': 0.9976516241010662, 'auprc': 0.9987593163019963, 'loss_val': 0.033548252394128, 'psi': 0.9980947009814383}-{'f1_val': 0.9970202894562089, 'auprc': 0.9991444428731026, 'loss_val': 0.036412078481564546, 'psi': 0.9978699508229665}
[S15] START round=37 head_norm_before_train=1.488341 cos_to_last_merge=0.9993 (last merge round=31)
[S15] round=37 local utility u=0.000000 metrics={'f1_val': 0.76352335716934, 'auprc': 0.9739889143092398, 'loss_val': 0.38138785945485837, 'psi': 0.8477095800252998}-{'f1_val': 0.8321599038100892, 'auprc': 0.9884544959106791, 'loss_val': 0.21792015564722494, 'psi': 0.8946777406503252}
[S16] START round=37 head_norm_before_train=1.512524 cos_to_last_merge=0.9995 (last merge round=33)
[S16] round=37 local utility u=0.000000 metrics={'f1_val': 0.937690833682753, 'auprc': 0.982782295448061, 'loss_val': 0.3026445602033762, 'psi': 0.9557274183888762}-{'f1_val': 0.9896077289455275, 'auprc': 0.9889323670771377, 'loss_val': 0.07580813021674607, 'psi': 0.9893375841981715}
[S17] START round=37 head_norm_before_train=1.455248 cos_to_last_merge=0.9992 (last merge round=33)
[S17] round=37 local utility u=0.000000 metrics={'f1_val': 0.420198072318292, 'auprc': 0.702434095014504, 'loss_val': 1.1342212608267765, 'psi': 0.5330924813967768}-{'f1_val': 0.5554427839625332, 'auprc': 0.8233861398928136, 'loss_val': 0.7791941338223003, 'psi': 0.6626201263346454}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.998)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=38 head_norm_before_train=1.833494 cos_to_last_merge=0.9892 (last merge round=25)
[S2] round=38 local utility u=0.171007 metrics={'f1_val': 0.9234785096166638, 'auprc': 0.9813222131861536, 'loss_val': 0.13615085370970031, 'psi': 0.9466159910444597}-{'f1_val': 0.8961787737845834, 'auprc': 0.9391515086986243, 'loss_val': 0.1878536047141326, 'psi': 0.9133678677501997}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=38 head_norm_before_train=2.008516 cos_to_last_merge=0.9987 (last merge round=32)
[S3] round=38 local utility u=0.000000 metrics={'f1_val': 0.7697157089505372, 'auprc': 0.9440662789398996, 'loss_val': 0.6849116241614228, 'psi': 0.8394559369462822}-{'f1_val': 0.7896844478978098, 'auprc': 0.9326581463272262, 'loss_val': 0.5956258833602959, 'psi': 0.8468739272695763}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=38 head_norm_before_train=1.930927 (no previous merge yet)
[S4] round=38 local utility u=0.000000 metrics={'f1_val': 0.9403122383318729, 'auprc': 0.9351610572762269, 'loss_val': 0.311020213335793, 'psi': 0.9382517659096146}-{'f1_val': 0.9411378777379223, 'auprc': 0.942971980044811, 'loss_val': 0.3038253146493018, 'psi': 0.9418715186606779}
[S5] START round=38 head_norm_before_train=1.665987 cos_to_last_merge=0.9435 (last merge round=29)
[S5] ⚠️ Model drifted since last merge! cos=0.944
[S5] round=38 local utility u=0.000000 metrics={'f1_val': 0.9962633185437604, 'auprc': 0.9980503085509843, 'loss_val': 0.0624492460919578, 'psi': 0.9969781145466499}-{'f1_val': 0.9966309045197074, 'auprc': 0.9986975461449905, 'loss_val': 0.06653372262024349, 'psi': 0.9974575611698207}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=38 head_norm_before_train=1.494937 cos_to_last_merge=0.9983 (last merge round=35)
[S6] round=38 local utility u=0.000000 metrics={'f1_val': 0.7102457183742191, 'auprc': 0.9118737604895311, 'loss_val': 0.559115636406605, 'psi': 0.7908969352203439}-{'f1_val': 0.7824945680670434, 'auprc': 0.9493127784051256, 'loss_val': 0.38291390078886334, 'psi': 0.8492218522022763}
[S7] START round=38 head_norm_before_train=1.566129 cos_to_last_merge=0.8184 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.818
[S7] round=38 local utility u=0.000000 metrics={'f1_val': 0.5365564111385235, 'auprc': 0.7828296839026609, 'loss_val': 1.0104209190104032, 'psi': 0.6350657202441785}-{'f1_val': 0.5626707523611417, 'auprc': 0.7847779953235474, 'loss_val': 0.800911483931079, 'psi': 0.651513649546104}
[S8] START round=38 head_norm_before_train=1.945171 cos_to_last_merge=0.9997 (last merge round=34)
[S8] round=38 local utility u=0.000000 metrics={'f1_val': 0.9674341293169927, 'auprc': 0.9986390347781219, 'loss_val': 0.12959444031003242, 'psi': 0.9799160915014444}-{'f1_val': 0.9931548986711313, 'auprc': 0.9978761023222138, 'loss_val': 0.04675768081648244, 'psi': 0.9950433801315642}
[S9] START round=38 head_norm_before_train=2.140118 (no previous merge yet)
[S9] round=38 local utility u=0.000000 metrics={'f1_val': 0.9933536184876286, 'auprc': 0.9985217647624667, 'loss_val': 0.025293599188415755, 'psi': 0.9954208769975638}-{'f1_val': 0.9971029125121428, 'auprc': 0.9995502855114091, 'loss_val': 0.01661552235088351, 'psi': 0.9980818617118493}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=38 head_norm_before_train=1.887223 cos_to_last_merge=0.9982 (last merge round=29)
[S10] round=38 local utility u=0.002465 metrics={'f1_val': 0.9939643640207476, 'auprc': 0.9957197951411013, 'loss_val': 0.03290276006278127, 'psi': 0.9946665364688891}-{'f1_val': 0.9935262985458464, 'auprc': 0.995719929740926, 'loss_val': 0.03520531614197623, 'psi': 0.9944037510238782}
[S11] START round=38 head_norm_before_train=1.675416 cos_to_last_merge=0.9565 (last merge round=26)
[S11] round=38 local utility u=0.000000 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9981838650541506, 'loss_val': 0.037217650874784874, 'psi': 0.9970589967918815}-{'f1_val': 0.9967224195815153, 'auprc': 0.9987539334456885, 'loss_val': 0.03683448541727202, 'psi': 0.9975350251271846}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=38 head_norm_before_train=1.814107 cos_to_last_merge=0.9999 (last merge round=34)
[S13] round=38 local utility u=0.018524 metrics={'f1_val': 0.5747625924012432, 'auprc': 0.7039683279831708, 'loss_val': 0.7470015748849453, 'psi': 0.6264448866340142}-{'f1_val': 0.5836046170980587, 'auprc': 0.7046612014611918, 'loss_val': 0.8391804969939921, 'psi': 0.6320272508433119}
[S14] START round=38 head_norm_before_train=1.652736 cos_to_last_merge=0.9996 (last merge round=34)
[S14] round=38 local utility u=0.000000 metrics={'f1_val': 0.9373841697690408, 'auprc': 0.9990864263124128, 'loss_val': 0.09624887090896578, 'psi': 0.9620650723863897}-{'f1_val': 0.9976516241010662, 'auprc': 0.9987593163019963, 'loss_val': 0.033548252394128, 'psi': 0.9980947009814383}
[S15] START round=38 head_norm_before_train=1.499820 cos_to_last_merge=0.9991 (last merge round=31)
[S15] round=38 local utility u=0.883965 metrics={'f1_val': 0.9958188988109067, 'auprc': 0.990929688882005, 'loss_val': 0.05805252326205675, 'psi': 0.993863214839346}-{'f1_val': 0.76352335716934, 'auprc': 0.9739889143092398, 'loss_val': 0.38138785945485837, 'psi': 0.8477095800252998}
[S16] START round=38 head_norm_before_train=1.529382 cos_to_last_merge=0.9992 (last merge round=33)
[S16] round=38 local utility u=0.213129 metrics={'f1_val': 0.9752678583591126, 'auprc': 0.9841077848503087, 'loss_val': 0.10582481989320373, 'psi': 0.978803828955591}-{'f1_val': 0.937690833682753, 'auprc': 0.982782295448061, 'loss_val': 0.3026445602033762, 'psi': 0.9557274183888762}
[S17] START round=38 head_norm_before_train=1.470261 cos_to_last_merge=0.9986 (last merge round=33)
[S17] round=38 local utility u=0.811183 metrics={'f1_val': 0.6131106839782974, 'auprc': 0.8251132423121827, 'loss_val': 1.0373686967192208, 'psi': 0.6979117073118515}-{'f1_val': 0.420198072318292, 'auprc': 0.702434095014504, 'loss_val': 1.1342212608267765, 'psi': 0.5330924813967768}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.626)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S2] START round=39 head_norm_before_train=1.842252 cos_to_last_merge=0.9885 (last merge round=25)
[S2] round=39 local utility u=0.000000 metrics={'f1_val': 0.8990594580221388, 'auprc': 0.9765650518399499, 'loss_val': 0.1944359029964036, 'psi': 0.9300616955492632}-{'f1_val': 0.9234785096166638, 'auprc': 0.9813222131861536, 'loss_val': 0.13615085370970031, 'psi': 0.9466159910444597}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=40 psi=0.930 u=0.0000 p_local=0.1171 f1=0.899 auprc=0.977 bytes=35966
[S3] START round=39 head_norm_before_train=2.020431 cos_to_last_merge=0.9984 (last merge round=32)
[S3] round=39 local utility u=0.690233 metrics={'f1_val': 0.9117691852874505, 'auprc': 0.9696757960064919, 'loss_val': 0.2335951560229301, 'psi': 0.934931829575067}-{'f1_val': 0.7697157089505372, 'auprc': 0.9440662789398996, 'loss_val': 0.6849116241614228, 'psi': 0.8394559369462822}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S3] r=40 psi=0.935 u=0.6902 p_local=0.2325 f1=0.912 auprc=0.970 bytes=37809
[S4] START round=39 head_norm_before_train=1.932959 (no previous merge yet)
[S4] round=39 local utility u=0.000000 metrics={'f1_val': 0.9393623911965152, 'auprc': 0.929227753350838, 'loss_val': 0.33564181732025106, 'psi': 0.9353085360582444}-{'f1_val': 0.9403122383318729, 'auprc': 0.9351610572762269, 'loss_val': 0.311020213335793, 'psi': 0.9382517659096146}
[S5] START round=39 head_norm_before_train=1.667550 cos_to_last_merge=0.9418 (last merge round=29)
[S5] ⚠️ Model drifted since last merge! cos=0.942
[S5] round=39 local utility u=0.000000 metrics={'f1_val': 0.9962633185437604, 'auprc': 0.9930600979896859, 'loss_val': 0.062250641611913196, 'psi': 0.9949820303221305}-{'f1_val': 0.9962633185437604, 'auprc': 0.9980503085509843, 'loss_val': 0.0624492460919578, 'psi': 0.9969781145466499}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=40 psi=0.995 u=0.0000 p_local=0.0864 f1=0.996 auprc=0.993 bytes=32385
[S6] START round=39 head_norm_before_train=1.521469 cos_to_last_merge=0.9967 (last merge round=35)
[S6] round=39 local utility u=0.462650 metrics={'f1_val': 0.8195996025606958, 'auprc': 0.9447234809857322, 'loss_val': 0.3884890728402216, 'psi': 0.8696491539307103}-{'f1_val': 0.7102457183742191, 'auprc': 0.9118737604895311, 'loss_val': 0.559115636406605, 'psi': 0.7908969352203439}
[S7] START round=39 head_norm_before_train=1.578064 cos_to_last_merge=0.8171 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.817
[S7] round=39 local utility u=0.338886 metrics={'f1_val': 0.593902506661761, 'auprc': 0.7921370271938298, 'loss_val': 0.7046478324444088, 'psi': 0.6731963148745885}-{'f1_val': 0.5365564111385235, 'auprc': 0.7828296839026609, 'loss_val': 1.0104209190104032, 'psi': 0.6350657202441785}
[S8] START round=39 head_norm_before_train=1.954784 cos_to_last_merge=0.9995 (last merge round=34)
[S8] round=39 local utility u=0.124835 metrics={'f1_val': 0.9942788405856967, 'auprc': 0.9980770394407648, 'loss_val': 0.03930703999843873, 'psi': 0.995798120127724}-{'f1_val': 0.9674341293169927, 'auprc': 0.9986390347781219, 'loss_val': 0.12959444031003242, 'psi': 0.9799160915014444}
[S9] START round=39 head_norm_before_train=2.143111 (no previous merge yet)
[S9] round=39 local utility u=0.012186 metrics={'f1_val': 0.9958601375429889, 'auprc': 0.9990593037285191, 'loss_val': 0.01757315210667993, 'psi': 0.9971398040172009}-{'f1_val': 0.9933536184876286, 'auprc': 0.9985217647624667, 'loss_val': 0.025293599188415755, 'psi': 0.9954208769975638}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S9] r=40 psi=0.997 u=0.0122 p_local=0.0069 f1=0.996 auprc=0.999 bytes=35975
[S10] START round=39 head_norm_before_train=1.899854 cos_to_last_merge=0.9978 (last merge round=29)
[S10] round=39 local utility u=0.000000 metrics={'f1_val': 0.9935262985458464, 'auprc': 0.9957687965367894, 'loss_val': 0.03296422843960564, 'psi': 0.9944232977422236}-{'f1_val': 0.9939643640207476, 'auprc': 0.9957197951411013, 'loss_val': 0.03290276006278127, 'psi': 0.9946665364688891}
[S11] START round=39 head_norm_before_train=1.690031 cos_to_last_merge=0.9548 (last merge round=26)
[S11] round=39 local utility u=0.005160 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9985119305974913, 'loss_val': 0.03181221055067657, 'psi': 0.9975833262147429}-{'f1_val': 0.9963090846170353, 'auprc': 0.9981838650541506, 'loss_val': 0.037217650874784874, 'psi': 0.9970589967918815}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S11] r=40 psi=0.998 u=0.0052 p_local=0.0064 f1=0.997 auprc=0.999 bytes=45017
[S13] START round=39 head_norm_before_train=1.819396 cos_to_last_merge=0.9997 (last merge round=34)
[S13] round=39 local utility u=0.000000 metrics={'f1_val': 0.5442916215165643, 'auprc': 0.7132717821839745, 'loss_val': 0.9676836758442243, 'psi': 0.6118836857835284}-{'f1_val': 0.5747625924012432, 'auprc': 0.7039683279831708, 'loss_val': 0.7470015748849453, 'psi': 0.6264448866340142}
[S14] START round=39 head_norm_before_train=1.666202 cos_to_last_merge=0.9994 (last merge round=34)
[S14] round=39 local utility u=0.198560 metrics={'f1_val': 0.9941175410717178, 'auprc': 0.9987353414627311, 'loss_val': 0.038476790733803945, 'psi': 0.9959646612281231}-{'f1_val': 0.9373841697690408, 'auprc': 0.9990864263124128, 'loss_val': 0.09624887090896578, 'psi': 0.9620650723863897}
[S15] START round=39 head_norm_before_train=1.511712 cos_to_last_merge=0.9988 (last merge round=31)
[S15] round=39 local utility u=0.000000 metrics={'f1_val': 0.7115239372255693, 'auprc': 0.9880353499376616, 'loss_val': 0.38001061695906413, 'psi': 0.8221285023104062}-{'f1_val': 0.9958188988109067, 'auprc': 0.990929688882005, 'loss_val': 0.05805252326205675, 'psi': 0.993863214839346}
[S16] START round=39 head_norm_before_train=1.546116 cos_to_last_merge=0.9988 (last merge round=33)
[S16] round=39 local utility u=0.080776 metrics={'f1_val': 0.9917951252582332, 'auprc': 0.9885257613094034, 'loss_val': 0.05668954662712195, 'psi': 0.9904873796787013}-{'f1_val': 0.9752678583591126, 'auprc': 0.9841077848503087, 'loss_val': 0.10582481989320373, 'psi': 0.978803828955591}
[S17] START round=39 head_norm_before_train=1.486598 cos_to_last_merge=0.9978 (last merge round=33)
[S17] round=39 local utility u=0.620437 metrics={'f1_val': 0.7114721070972525, 'auprc': 0.9002630425278342, 'loss_val': 0.6121118656385856, 'psi': 0.7869884812694852}-{'f1_val': 0.6131106839782974, 'auprc': 0.8251132423121827, 'loss_val': 1.0373686967192208, 'psi': 0.6979117073118515}
[S17] not sending this round → trigger blocked (psi=0.787)
[S17] r=40 psi=0.787 u=0.6204 p_local=0.3361 f1=0.711 auprc=0.900 bytes=34195
[S16] not sending this round → trigger blocked (psi=0.990)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S7] r=40 psi=0.673 u=0.3389 p_local=0.2391 f1=0.594 auprc=0.792 bytes=32443
[S8] r=40 psi=0.996 u=0.1248 p_local=0.0404 f1=0.994 auprc=0.998 bytes=43170
[S6] r=40 psi=0.870 u=0.4626 p_local=0.2273 f1=0.820 auprc=0.945 bytes=28810
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=40 psi=0.612 u=0.0000 p_local=0.0750 f1=0.544 auprc=0.713 bytes=32382
[S10] r=40 psi=0.994 u=0.0000 p_local=0.0030 f1=0.994 auprc=0.996 bytes=39588
[S14] r=40 psi=0.996 u=0.1986 p_local=0.0493 f1=0.994 auprc=0.999 bytes=41408
[S4] r=40 psi=0.935 u=0.0000 p_local=0.0073 f1=0.939 auprc=0.929 bytes=35994
[S16] r=40 psi=0.990 u=0.0808 p_local=0.1362 f1=0.992 auprc=0.989 bytes=37798
[S15] r=40 psi=0.822 u=0.0000 p_local=0.3290 f1=0.712 auprc=0.988 bytes=34194
[S2] START round=40 head_norm_before_train=1.849891 cos_to_last_merge=0.9878 (last merge round=25)
[S2] round=40 local utility u=0.139777 metrics={'f1_val': 0.9409611351473718, 'auprc': 0.9665160928378458, 'loss_val': 0.13614580256880396, 'psi': 0.9511831182235614}-{'f1_val': 0.8990594580221388, 'auprc': 0.9765650518399499, 'loss_val': 0.1944359029964036, 'psi': 0.9300616955492632}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S2] sending update (kind=head size=1790 to 1 peers)
[S3] START round=40 head_norm_before_train=2.032620 cos_to_last_merge=0.9980 (last merge round=32)
[S3] round=40 local utility u=0.247851 metrics={'f1_val': 0.9604258829325841, 'auprc': 0.9976745845661814, 'loss_val': 0.11383013879424835, 'psi': 0.9753253635860231}-{'f1_val': 0.9117691852874505, 'auprc': 0.9696757960064919, 'loss_val': 0.2335951560229301, 'psi': 0.934931829575067}
[S3] not sending this round → trigger blocked (psi=0.975)
[S4] START round=40 head_norm_before_train=1.934035 (no previous merge yet)
[S4] round=40 local utility u=0.031148 metrics={'f1_val': 0.9411378777379223, 'auprc': 0.9353149867788298, 'loss_val': 0.30226014919516303, 'psi': 0.9388087213542854}-{'f1_val': 0.9393623911965152, 'auprc': 0.929227753350838, 'loss_val': 0.33564181732025106, 'psi': 0.9353085360582444}
[S5] START round=40 head_norm_before_train=1.678612 cos_to_last_merge=0.9393 (last merge round=29)
[S5] ⚠️ Model drifted since last merge! cos=0.939
[S5] round=40 local utility u=0.009391 metrics={'f1_val': 0.9962633185437604, 'auprc': 0.9963425702720081, 'loss_val': 0.05331689639202425, 'psi': 0.9962950192350595}-{'f1_val': 0.9962633185437604, 'auprc': 0.9930600979896859, 'loss_val': 0.062250641611913196, 'psi': 0.9949820303221305}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S5] sending update (kind=head size=1808 to 1 peers)
[S6] START round=40 head_norm_before_train=1.549469 cos_to_last_merge=0.9947 (last merge round=35)
[S6] round=40 local utility u=0.000000 metrics={'f1_val': 0.7233029735958251, 'auprc': 0.9282178010704746, 'loss_val': 0.5531677859802242, 'psi': 0.8052689045856849}-{'f1_val': 0.8195996025606958, 'auprc': 0.9447234809857322, 'loss_val': 0.3884890728402216, 'psi': 0.8696491539307103}
[S7] START round=40 head_norm_before_train=1.588476 cos_to_last_merge=0.8163 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.816
[S7] round=40 local utility u=0.000000 metrics={'f1_val': 0.6016315192174962, 'auprc': 0.7916670671564124, 'loss_val': 0.7882933312865452, 'psi': 0.6776457383930627}-{'f1_val': 0.593902506661761, 'auprc': 0.7921370271938298, 'loss_val': 0.7046478324444088, 'psi': 0.6731963148745885}
[S8] START round=40 head_norm_before_train=1.963253 cos_to_last_merge=0.9994 (last merge round=34)
[S8] round=40 local utility u=0.000000 metrics={'f1_val': 0.9921646161217188, 'auprc': 0.9981746594764787, 'loss_val': 0.0370087505803773, 'psi': 0.9945686334636228}-{'f1_val': 0.9942788405856967, 'auprc': 0.9980770394407648, 'loss_val': 0.03930703999843873, 'psi': 0.995798120127724}
[S9] START round=40 head_norm_before_train=2.151471 (no previous merge yet)
[S9] round=40 local utility u=0.000000 metrics={'f1_val': 0.9920956129422706, 'auprc': 0.9985024227678828, 'loss_val': 0.029164555655664906, 'psi': 0.9946583368725155}-{'f1_val': 0.9958601375429889, 'auprc': 0.9990593037285191, 'loss_val': 0.01757315210667993, 'psi': 0.9971398040172009}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=40 head_norm_before_train=1.907746 cos_to_last_merge=0.9975 (last merge round=29)
[S10] round=40 local utility u=0.000054 metrics={'f1_val': 0.9937209795911728, 'auprc': 0.9957866658513141, 'loss_val': 0.034077490460340996, 'psi': 0.9945472540952294}-{'f1_val': 0.9935262985458464, 'auprc': 0.9957687965367894, 'loss_val': 0.03296422843960564, 'psi': 0.9944232977422236}
[S11] START round=40 head_norm_before_train=1.703776 cos_to_last_merge=0.9531 (last merge round=26)
[S11] round=40 local utility u=0.000000 metrics={'f1_val': 0.9588982503386194, 'auprc': 0.9984784001531807, 'loss_val': 0.06266714711302189, 'psi': 0.9747303102644439}-{'f1_val': 0.9969642566262439, 'auprc': 0.9985119305974913, 'loss_val': 0.03181221055067657, 'psi': 0.9975833262147429}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=40 head_norm_before_train=1.825947 cos_to_last_merge=0.9996 (last merge round=34)
[S13] round=40 local utility u=0.133010 metrics={'f1_val': 0.5640944768478421, 'auprc': 0.7130368385767233, 'loss_val': 0.8197753632015407, 'psi': 0.6236714215393946}-{'f1_val': 0.5442916215165643, 'auprc': 0.7132717821839745, 'loss_val': 0.9676836758442243, 'psi': 0.6118836857835284}
[S14] START round=40 head_norm_before_train=1.675873 cos_to_last_merge=0.9991 (last merge round=34)
[S14] round=40 local utility u=0.009173 metrics={'f1_val': 0.9959836402706627, 'auprc': 0.9991282810091255, 'loss_val': 0.03250644325789458, 'psi': 0.9972414965660479}-{'f1_val': 0.9941175410717178, 'auprc': 0.9987353414627311, 'loss_val': 0.038476790733803945, 'psi': 0.9959646612281231}
[S15] START round=40 head_norm_before_train=1.521348 cos_to_last_merge=0.9986 (last merge round=31)
[S15] round=40 local utility u=0.032220 metrics={'f1_val': 0.7355711477560306, 'auprc': 0.9720946915681732, 'loss_val': 0.412032631384335, 'psi': 0.8301805652808877}-{'f1_val': 0.7115239372255693, 'auprc': 0.9880353499376616, 'loss_val': 0.38001061695906413, 'psi': 0.8221285023104062}
[S16] START round=40 head_norm_before_train=1.561968 cos_to_last_merge=0.9983 (last merge round=33)
[S16] round=40 local utility u=0.000000 metrics={'f1_val': 0.9904805123242135, 'auprc': 0.9884107575235501, 'loss_val': 0.06387601971845756, 'psi': 0.9896526104039481}-{'f1_val': 0.9917951252582332, 'auprc': 0.9885257613094034, 'loss_val': 0.05668954662712195, 'psi': 0.9904873796787013}
[S17] START round=40 head_norm_before_train=1.500188 cos_to_last_merge=0.9970 (last merge round=33)
[S17] round=40 local utility u=0.000000 metrics={'f1_val': 0.6842430382700239, 'auprc': 0.8701719034233968, 'loss_val': 0.8430355841213188, 'psi': 0.758614584331373}-{'f1_val': 0.7114721070972525, 'auprc': 0.9002630425278342, 'loss_val': 0.6121118656385856, 'psi': 0.7869884812694852}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.997)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S2] START round=41 head_norm_before_train=1.857622 cos_to_last_merge=0.9871 (last merge round=25)
[S2] round=41 local utility u=0.000000 metrics={'f1_val': 0.9085173534028486, 'auprc': 0.9829596196973805, 'loss_val': 0.1783573970358309, 'psi': 0.9382942599206613}-{'f1_val': 0.9409611351473718, 'auprc': 0.9665160928378458, 'loss_val': 0.13614580256880396, 'psi': 0.9511831182235614}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=41 head_norm_before_train=2.045258 cos_to_last_merge=0.9977 (last merge round=32)
[S3] round=41 local utility u=0.114090 metrics={'f1_val': 0.9870394097969635, 'auprc': 0.9984785316352414, 'loss_val': 0.04774234599336794, 'psi': 0.9916150585322747}-{'f1_val': 0.9604258829325841, 'auprc': 0.9976745845661814, 'loss_val': 0.11383013879424835, 'psi': 0.9753253635860231}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] sending update (kind=head size=1793 to 1 peers)
[S4] START round=41 head_norm_before_train=1.932027 (no previous merge yet)
[S4] round=41 local utility u=0.026799 metrics={'f1_val': 0.9421457943704593, 'auprc': 0.9489348185992335, 'loss_val': 0.29556832323282195, 'psi': 0.944861404061969}-{'f1_val': 0.9411378777379223, 'auprc': 0.9353149867788298, 'loss_val': 0.30226014919516303, 'psi': 0.9388087213542854}
[S5] START round=41 head_norm_before_train=1.696732 cos_to_last_merge=0.9361 (last merge round=29)
[S5] ⚠️ Model drifted since last merge! cos=0.936
[S5] round=41 local utility u=0.000000 metrics={'f1_val': 0.9962633185437604, 'auprc': 0.9949054571415253, 'loss_val': 0.05122695008883459, 'psi': 0.9957201739828663}-{'f1_val': 0.9962633185437604, 'auprc': 0.9963425702720081, 'loss_val': 0.05331689639202425, 'psi': 0.9962950192350595}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=41 head_norm_before_train=1.579349 cos_to_last_merge=0.9924 (last merge round=35)
[S6] round=41 local utility u=0.000000 metrics={'f1_val': 0.598685077775192, 'auprc': 0.7321875587780995, 'loss_val': 0.920227262061011, 'psi': 0.6520860701763549}-{'f1_val': 0.7233029735958251, 'auprc': 0.9282178010704746, 'loss_val': 0.5531677859802242, 'psi': 0.8052689045856849}
[S7] START round=41 head_norm_before_train=1.599533 cos_to_last_merge=0.8151 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.815
[S7] round=41 local utility u=0.371995 metrics={'f1_val': 0.6531982681907347, 'auprc': 0.8106653339873667, 'loss_val': 0.41069772932031773, 'psi': 0.7161850945093875}-{'f1_val': 0.6016315192174962, 'auprc': 0.7916670671564124, 'loss_val': 0.7882933312865452, 'psi': 0.6776457383930627}
[S8] START round=41 head_norm_before_train=1.971747 cos_to_last_merge=0.9993 (last merge round=34)
[S8] round=41 local utility u=0.000000 metrics={'f1_val': 0.9918109678295097, 'auprc': 0.9985644578117779, 'loss_val': 0.03951483387469205, 'psi': 0.994512363822417}-{'f1_val': 0.9921646161217188, 'auprc': 0.9981746594764787, 'loss_val': 0.0370087505803773, 'psi': 0.9945686334636228}
[S9] START round=41 head_norm_before_train=2.159994 (no previous merge yet)
[S9] round=41 local utility u=0.017845 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9972871459264783, 'loss_val': 0.017410259360562345, 'psi': 0.9969303531294487}-{'f1_val': 0.9920956129422706, 'auprc': 0.9985024227678828, 'loss_val': 0.029164555655664906, 'psi': 0.9946583368725155}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=41 head_norm_before_train=1.915434 cos_to_last_merge=0.9971 (last merge round=29)
[S10] round=41 local utility u=0.002270 metrics={'f1_val': 0.9939643640207476, 'auprc': 0.9961008533111354, 'loss_val': 0.03194105796901807, 'psi': 0.9948189597369027}-{'f1_val': 0.9937209795911728, 'auprc': 0.9957866658513141, 'loss_val': 0.034077490460340996, 'psi': 0.9945472540952294}
[S11] START round=41 head_norm_before_train=1.715165 cos_to_last_merge=0.9517 (last merge round=26)
[S11] round=41 local utility u=0.016015 metrics={'f1_val': 0.9628673709453279, 'auprc': 0.998351192206122, 'loss_val': 0.05406978592892702, 'psi': 0.9770608994496455}-{'f1_val': 0.9588982503386194, 'auprc': 0.9984784001531807, 'loss_val': 0.06266714711302189, 'psi': 0.9747303102644439}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=41 head_norm_before_train=1.831839 cos_to_last_merge=0.9995 (last merge round=34)
[S13] round=41 local utility u=0.026212 metrics={'f1_val': 0.5734982037038574, 'auprc': 0.7152175964320099, 'loss_val': 0.8303168517744022, 'psi': 0.6301859607951183}-{'f1_val': 0.5640944768478421, 'auprc': 0.7130368385767233, 'loss_val': 0.8197753632015407, 'psi': 0.6236714215393946}
[S14] START round=41 head_norm_before_train=1.686740 cos_to_last_merge=0.9989 (last merge round=34)
[S14] round=41 local utility u=0.000000 metrics={'f1_val': 0.9373453670581636, 'auprc': 0.9987917134746942, 'loss_val': 0.09996359878755284, 'psi': 0.9619239056247759}-{'f1_val': 0.9959836402706627, 'auprc': 0.9991282810091255, 'loss_val': 0.03250644325789458, 'psi': 0.9972414965660479}
[S15] START round=41 head_norm_before_train=1.535267 cos_to_last_merge=0.9982 (last merge round=31)
[S15] round=41 local utility u=0.869632 metrics={'f1_val': 0.961402574170755, 'auprc': 0.9925432457579053, 'loss_val': 0.08910271217088027, 'psi': 0.9738588428056151}-{'f1_val': 0.7355711477560306, 'auprc': 0.9720946915681732, 'loss_val': 0.412032631384335, 'psi': 0.8301805652808877}
[S16] START round=41 head_norm_before_train=1.575768 cos_to_last_merge=0.9979 (last merge round=33)
[S16] round=41 local utility u=0.000000 metrics={'f1_val': 0.9809132350114796, 'auprc': 0.9880139069581138, 'loss_val': 0.08666667835599605, 'psi': 0.9837535037901333}-{'f1_val': 0.9904805123242135, 'auprc': 0.9884107575235501, 'loss_val': 0.06387601971845756, 'psi': 0.9896526104039481}
[S17] START round=41 head_norm_before_train=1.510607 cos_to_last_merge=0.9964 (last merge round=33)
[S17] round=41 local utility u=0.000000 metrics={'f1_val': 0.6072263671973395, 'auprc': 0.8371646850542799, 'loss_val': 1.0425183688111164, 'psi': 0.6992016943401156}-{'f1_val': 0.6842430382700239, 'auprc': 0.8701719034233968, 'loss_val': 0.8430355841213188, 'psi': 0.758614584331373}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.995)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.630)
[S4] not sending this round → trigger blocked (psi=0.945)
[S15] not sending this round → trigger blocked (psi=0.974)
[S2] START round=42 head_norm_before_train=1.865812 cos_to_last_merge=0.9864 (last merge round=25)
[S2] round=42 local utility u=0.000000 metrics={'f1_val': 0.8461158229258712, 'auprc': 0.9415854712104395, 'loss_val': 0.2778699363634908, 'psi': 0.8843036822396986}-{'f1_val': 0.9085173534028486, 'auprc': 0.9829596196973805, 'loss_val': 0.1783573970358309, 'psi': 0.9382942599206613}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=42 head_norm_before_train=2.059790 cos_to_last_merge=0.9972 (last merge round=32)
[S3] round=42 local utility u=0.000000 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.9900648493283732, 'loss_val': 0.14096983741895452, 'psi': 0.9726470903946154}-{'f1_val': 0.9870394097969635, 'auprc': 0.9984785316352414, 'loss_val': 0.04774234599336794, 'psi': 0.9916150585322747}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=42 head_norm_before_train=1.933623 (no previous merge yet)
[S4] round=42 local utility u=0.030956 metrics={'f1_val': 0.9454031504373129, 'auprc': 0.9618353281713701, 'loss_val': 0.2919018075512767, 'psi': 0.9519760215309357}-{'f1_val': 0.9421457943704593, 'auprc': 0.9489348185992335, 'loss_val': 0.29556832323282195, 'psi': 0.944861404061969}
[S5] START round=42 head_norm_before_train=1.712749 cos_to_last_merge=0.9332 (last merge round=29)
[S5] ⚠️ Model drifted since last merge! cos=0.933
[S5] round=42 local utility u=0.001453 metrics={'f1_val': 0.9962633185437604, 'auprc': 0.9946212773552656, 'loss_val': 0.04746827700433487, 'psi': 0.9956065020683624}-{'f1_val': 0.9962633185437604, 'auprc': 0.9949054571415253, 'loss_val': 0.05122695008883459, 'psi': 0.9957201739828663}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S5] sending update (kind=head size=1806 to 1 peers)
[S6] START round=42 head_norm_before_train=1.609246 cos_to_last_merge=0.9899 (last merge round=35)
[S6] round=42 local utility u=1.000000 metrics={'f1_val': 0.8246160645473313, 'auprc': 0.9535204528854675, 'loss_val': 0.4049878557946056, 'psi': 0.8761778198825858}-{'f1_val': 0.598685077775192, 'auprc': 0.7321875587780995, 'loss_val': 0.920227262061011, 'psi': 0.6520860701763549}
[S7] START round=42 head_norm_before_train=1.610396 cos_to_last_merge=0.8142 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.814
[S7] round=42 local utility u=0.103722 metrics={'f1_val': 0.6684573999524126, 'auprc': 0.8285151542634595, 'loss_val': 0.34835788092302383, 'psi': 0.7324805016768313}-{'f1_val': 0.6531982681907347, 'auprc': 0.8106653339873667, 'loss_val': 0.41069772932031773, 'psi': 0.7161850945093875}
[S8] START round=42 head_norm_before_train=1.977932 cos_to_last_merge=0.9992 (last merge round=34)
[S8] round=42 local utility u=0.008922 metrics={'f1_val': 0.9942788405856967, 'auprc': 0.9980996438758178, 'loss_val': 0.035083892806929945, 'psi': 0.9958071619017452}-{'f1_val': 0.9918109678295097, 'auprc': 0.9985644578117779, 'loss_val': 0.03951483387469205, 'psi': 0.994512363822417}
[S9] START round=42 head_norm_before_train=2.167498 (no previous merge yet)
[S9] round=42 local utility u=0.000000 metrics={'f1_val': 0.9922651407836713, 'auprc': 0.9953190055292651, 'loss_val': 0.030830344425050196, 'psi': 0.9934866866819089}-{'f1_val': 0.9966924912647621, 'auprc': 0.9972871459264783, 'loss_val': 0.017410259360562345, 'psi': 0.9969303531294487}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=42 head_norm_before_train=1.924358 cos_to_last_merge=0.9968 (last merge round=29)
[S10] round=42 local utility u=0.000000 metrics={'f1_val': 0.9935262985458464, 'auprc': 0.9961038596042844, 'loss_val': 0.03238685614196083, 'psi': 0.9945573229692215}-{'f1_val': 0.9939643640207476, 'auprc': 0.9961008533111354, 'loss_val': 0.03194105796901807, 'psi': 0.9948189597369027}
[S11] START round=42 head_norm_before_train=1.726148 cos_to_last_merge=0.9504 (last merge round=26)
[S11] round=42 local utility u=0.113723 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9986552568778799, 'loss_val': 0.030667132933811098, 'psi': 0.9974955545000612}-{'f1_val': 0.9628673709453279, 'auprc': 0.998351192206122, 'loss_val': 0.05406978592892702, 'psi': 0.9770608994496455}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=42 head_norm_before_train=1.839524 cos_to_last_merge=0.9993 (last merge round=34)
[S13] round=42 local utility u=0.000000 metrics={'f1_val': 0.5561038742453076, 'auprc': 0.7113612793568175, 'loss_val': 1.283244323216752, 'psi': 0.6182068362899116}-{'f1_val': 0.5734982037038574, 'auprc': 0.7152175964320099, 'loss_val': 0.8303168517744022, 'psi': 0.6301859607951183}
[S14] START round=42 head_norm_before_train=1.696086 cos_to_last_merge=0.9986 (last merge round=34)
[S14] round=42 local utility u=0.215171 metrics={'f1_val': 0.9970407855713329, 'auprc': 0.9987740517367214, 'loss_val': 0.027741245610978973, 'psi': 0.9977340920374884}-{'f1_val': 0.9373453670581636, 'auprc': 0.9987917134746942, 'loss_val': 0.09996359878755284, 'psi': 0.9619239056247759}
[S15] START round=42 head_norm_before_train=1.548772 cos_to_last_merge=0.9977 (last merge round=31)
[S15] round=42 local utility u=0.000000 metrics={'f1_val': 0.7161172092701913, 'auprc': 0.9868613694707624, 'loss_val': 0.36659333462698207, 'psi': 0.8244148733504197}-{'f1_val': 0.961402574170755, 'auprc': 0.9925432457579053, 'loss_val': 0.08910271217088027, 'psi': 0.9738588428056151}
[S16] START round=42 head_norm_before_train=1.589935 cos_to_last_merge=0.9974 (last merge round=33)
[S16] round=42 local utility u=0.000000 metrics={'f1_val': 0.9160033058872142, 'auprc': 0.9840847263109687, 'loss_val': 0.446758761444636, 'psi': 0.9432358740567159}-{'f1_val': 0.9809132350114796, 'auprc': 0.9880139069581138, 'loss_val': 0.08666667835599605, 'psi': 0.9837535037901333}
[S17] START round=42 head_norm_before_train=1.525318 cos_to_last_merge=0.9953 (last merge round=33)
[S17] round=42 local utility u=0.353977 metrics={'f1_val': 0.667138009900378, 'auprc': 0.8584562102269587, 'loss_val': 0.757909093610471, 'psi': 0.7436652900310103}-{'f1_val': 0.6072263671973395, 'auprc': 0.8371646850542799, 'loss_val': 1.0425183688111164, 'psi': 0.6992016943401156}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S16]  timeout peer S15
[S6]  timeout peer S17
[S4]  timeout peer S14
[S14]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S16
[S10]  timeout peer S8
[S7]  timeout peer S4
[S13]  timeout peer S2
[S8]  timeout peer S3
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] sending update (kind=head size=1804 to 1 peers)
[S7] not sending this round → trigger blocked (psi=0.732)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=43 head_norm_before_train=1.873505 cos_to_last_merge=0.9857 (last merge round=25)
[S2] round=43 local utility u=0.537897 metrics={'f1_val': 0.9762840187292777, 'auprc': 0.9765627207010522, 'loss_val': 0.08801671768300762, 'psi': 0.9763954995179875}-{'f1_val': 0.8461158229258712, 'auprc': 0.9415854712104395, 'loss_val': 0.2778699363634908, 'psi': 0.8843036822396986}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S2] sending update (kind=head size=1787 to 1 peers)
[S3] START round=43 head_norm_before_train=2.072592 cos_to_last_merge=0.9968 (last merge round=32)
[S3] round=43 local utility u=0.111398 metrics={'f1_val': 0.9803648687939185, 'auprc': 0.9989717566332996, 'loss_val': 0.06087220146615039, 'psi': 0.9878076239296709}-{'f1_val': 0.9610352511054436, 'auprc': 0.9900648493283732, 'loss_val': 0.14096983741895452, 'psi': 0.9726470903946154}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=43 head_norm_before_train=1.936517 (no previous merge yet)
[S4] round=43 local utility u=0.000000 metrics={'f1_val': 0.9419937957901853, 'auprc': 0.9516699846370795, 'loss_val': 0.2950481467836761, 'psi': 0.945864271328943}-{'f1_val': 0.9454031504373129, 'auprc': 0.9618353281713701, 'loss_val': 0.2919018075512767, 'psi': 0.9519760215309357}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=43 head_norm_before_train=1.735352 cos_to_last_merge=0.9292 (last merge round=29)
[S5] ⚠️ Model drifted since last merge! cos=0.929
[S5] round=43 local utility u=0.000143 metrics={'f1_val': 0.9962633185437604, 'auprc': 0.9924859461706284, 'loss_val': 0.04077696093420289, 'psi': 0.9947523695945075}-{'f1_val': 0.9962633185437604, 'auprc': 0.9946212773552656, 'loss_val': 0.04746827700433487, 'psi': 0.9956065020683624}
[S5] not sending this round → trigger blocked (psi=0.995)
[S6] START round=43 head_norm_before_train=1.626717 cos_to_last_merge=0.9883 (last merge round=35)
[S6] round=43 local utility u=0.159429 metrics={'f1_val': 0.8490016246416711, 'auprc': 0.9658312582337647, 'loss_val': 0.2693766196819962, 'psi': 0.8957334780785084}-{'f1_val': 0.8246160645473313, 'auprc': 0.9535204528854675, 'loss_val': 0.4049878557946056, 'psi': 0.8761778198825858}
[S6] not sending this round → trigger blocked (psi=0.896)
[S7] START round=43 head_norm_before_train=1.618695 cos_to_last_merge=0.8126 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.813
[S7] round=43 local utility u=0.000000 metrics={'f1_val': 0.6634402379419007, 'auprc': 0.817856089973896, 'loss_val': 0.38668880066398387, 'psi': 0.7252065787546988}-{'f1_val': 0.6684573999524126, 'auprc': 0.8285151542634595, 'loss_val': 0.34835788092302383, 'psi': 0.7324805016768313}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=43 head_norm_before_train=1.985172 cos_to_last_merge=0.9990 (last merge round=34)
[S8] round=43 local utility u=0.000000 metrics={'f1_val': 0.9473660688643193, 'auprc': 0.9987095583939768, 'loss_val': 0.13487915563053557, 'psi': 0.9679034646761824}-{'f1_val': 0.9942788405856967, 'auprc': 0.9980996438758178, 'loss_val': 0.035083892806929945, 'psi': 0.9958071619017452}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=43 head_norm_before_train=2.172106 (no previous merge yet)
[S9] round=43 local utility u=0.026969 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.999484731453786, 'loss_val': 0.016913272789114916, 'psi': 0.9979054438368687}-{'f1_val': 0.9922651407836713, 'auprc': 0.9953190055292651, 'loss_val': 0.030830344425050196, 'psi': 0.9934866866819089}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] sending update (kind=head size=1794 to 1 peers)
[S10] START round=43 head_norm_before_train=1.933971 cos_to_last_merge=0.9964 (last merge round=29)
[S10] round=43 local utility u=0.000036 metrics={'f1_val': 0.9935262985458464, 'auprc': 0.9960965500599218, 'loss_val': 0.03229197431420967, 'psi': 0.9945543991514765}-{'f1_val': 0.9935262985458464, 'auprc': 0.9961038596042844, 'loss_val': 0.03238685614196083, 'psi': 0.9945573229692215}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=43 head_norm_before_train=1.735506 cos_to_last_merge=0.9491 (last merge round=26)
[S11] ⚠️ Model drifted since last merge! cos=0.949
[S11] round=43 local utility u=0.000000 metrics={'f1_val': 0.9955431649470738, 'auprc': 0.9987853658324602, 'loss_val': 0.03506423451044747, 'psi': 0.9968400453012284}-{'f1_val': 0.9967224195815153, 'auprc': 0.9986552568778799, 'loss_val': 0.030667132933811098, 'psi': 0.9974955545000612}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=43 head_norm_before_train=1.845175 cos_to_last_merge=0.9992 (last merge round=34)
[S13] round=43 local utility u=0.488978 metrics={'f1_val': 0.6204292919038341, 'auprc': 0.7276182317213838, 'loss_val': 0.7400114286088609, 'psi': 0.663304867830854}-{'f1_val': 0.5561038742453076, 'auprc': 0.7113612793568175, 'loss_val': 1.283244323216752, 'psi': 0.6182068362899116}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=43 head_norm_before_train=1.705195 cos_to_last_merge=0.9984 (last merge round=34)
[S14] round=43 local utility u=0.000000 metrics={'f1_val': 0.9967805075071389, 'auprc': 0.9987138301813722, 'loss_val': 0.030174248165708097, 'psi': 0.9975538365768322}-{'f1_val': 0.9970407855713329, 'auprc': 0.9987740517367214, 'loss_val': 0.027741245610978973, 'psi': 0.9977340920374884}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=43 head_norm_before_train=1.560553 cos_to_last_merge=0.9972 (last merge round=31)
[S15] round=43 local utility u=1.000000 metrics={'f1_val': 0.9963362515743834, 'auprc': 0.9959923965093411, 'loss_val': 0.04439120369240524, 'psi': 0.9961987095483665}-{'f1_val': 0.7161172092701913, 'auprc': 0.9868613694707624, 'loss_val': 0.36659333462698207, 'psi': 0.8244148733504197}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] sending update (kind=head size=1803 to 1 peers)
[S16] START round=43 head_norm_before_train=1.602927 cos_to_last_merge=0.9969 (last merge round=33)
[S16] round=43 local utility u=0.436496 metrics={'f1_val': 0.9913599595172675, 'auprc': 0.9925995703721187, 'loss_val': 0.0514512694788745, 'psi': 0.991855803859208}-{'f1_val': 0.9160033058872142, 'auprc': 0.9840847263109687, 'loss_val': 0.446758761444636, 'psi': 0.9432358740567159}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=43 head_norm_before_train=1.542257 cos_to_last_merge=0.9939 (last merge round=33)
[S17] round=43 local utility u=0.000000 metrics={'f1_val': 0.6340183197357627, 'auprc': 0.8462510777498276, 'loss_val': 0.7058843559965837, 'psi': 0.7189114229413887}-{'f1_val': 0.667138009900378, 'auprc': 0.8584562102269587, 'loss_val': 0.757909093610471, 'psi': 0.7436652900310103}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=44 head_norm_before_train=1.883137 cos_to_last_merge=0.9848 (last merge round=25)
[S2] round=44 local utility u=0.000000 metrics={'f1_val': 0.9647334824121316, 'auprc': 0.985215115294011, 'loss_val': 0.09426893214780205, 'psi': 0.9729261355648833}-{'f1_val': 0.9762840187292777, 'auprc': 0.9765627207010522, 'loss_val': 0.08801671768300762, 'psi': 0.9763954995179875}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=44 head_norm_before_train=2.082843 cos_to_last_merge=0.9965 (last merge round=32)
[S3] round=44 local utility u=0.067067 metrics={'f1_val': 0.9971441177008393, 'auprc': 0.99890559032522, 'loss_val': 0.027214972705557155, 'psi': 0.9978487067505916}-{'f1_val': 0.9803648687939185, 'auprc': 0.9989717566332996, 'loss_val': 0.06087220146615039, 'psi': 0.9878076239296709}
[S3] not sending this round → trigger blocked (psi=0.998)
[S4] START round=44 head_norm_before_train=1.939070 (no previous merge yet)
[S4] round=44 local utility u=0.028113 metrics={'f1_val': 0.9470602529211968, 'auprc': 0.959133071804553, 'loss_val': 0.291609983973149, 'psi': 0.9518893804745392}-{'f1_val': 0.9419937957901853, 'auprc': 0.9516699846370795, 'loss_val': 0.2950481467836761, 'psi': 0.945864271328943}
[S4] not sending this round → trigger blocked (psi=0.952)
[S5] START round=44 head_norm_before_train=1.768962 cos_to_last_merge=0.9241 (last merge round=29)
[S5] ⚠️ Model drifted since last merge! cos=0.924
[S5] round=44 local utility u=0.006229 metrics={'f1_val': 0.9962633185437604, 'auprc': 0.9949478950999703, 'loss_val': 0.03570534763796437, 'psi': 0.9957371491662443}-{'f1_val': 0.9962633185437604, 'auprc': 0.9924859461706284, 'loss_val': 0.04077696093420289, 'psi': 0.9947523695945075}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S5] sending update (kind=head size=1807 to 1 peers)
[S6] START round=44 head_norm_before_train=1.640258 cos_to_last_merge=0.9870 (last merge round=35)
[S6] round=44 local utility u=0.000000 metrics={'f1_val': 0.7289333701061085, 'auprc': 0.91391309951993, 'loss_val': 0.6258180159320668, 'psi': 0.8029252618716372}-{'f1_val': 0.8490016246416711, 'auprc': 0.9658312582337647, 'loss_val': 0.2693766196819962, 'psi': 0.8957334780785084}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=44 head_norm_before_train=1.625801 cos_to_last_merge=0.8116 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.812
[S7] round=44 local utility u=0.000000 metrics={'f1_val': 0.5462525848249193, 'auprc': 0.7799042399199245, 'loss_val': 0.8469268794486521, 'psi': 0.6397132468629214}-{'f1_val': 0.6634402379419007, 'auprc': 0.817856089973896, 'loss_val': 0.38668880066398387, 'psi': 0.7252065787546988}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=44 head_norm_before_train=1.993377 cos_to_last_merge=0.9989 (last merge round=34)
[S8] round=44 local utility u=0.175176 metrics={'f1_val': 0.992402694124645, 'auprc': 0.9962697477914747, 'loss_val': 0.04742745359162812, 'psi': 0.9939495155913769}-{'f1_val': 0.9473660688643193, 'auprc': 0.9987095583939768, 'loss_val': 0.13487915563053557, 'psi': 0.9679034646761824}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=44 head_norm_before_train=2.181953 (no previous merge yet)
[S9] round=44 local utility u=0.000000 metrics={'f1_val': 0.9939393793306803, 'auprc': 0.9998679223902919, 'loss_val': 0.022986328040452624, 'psi': 0.996310796554525}-{'f1_val': 0.9968525854255906, 'auprc': 0.999484731453786, 'loss_val': 0.016913272789114916, 'psi': 0.9979054438368687}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=44 head_norm_before_train=1.942586 cos_to_last_merge=0.9960 (last merge round=29)
[S10] round=44 local utility u=0.002968 metrics={'f1_val': 0.9941835069003575, 'auprc': 0.9960970029689232, 'loss_val': 0.030300512325659397, 'psi': 0.9949489053277838}-{'f1_val': 0.9935262985458464, 'auprc': 0.9960965500599218, 'loss_val': 0.03229197431420967, 'psi': 0.9945543991514765}
[S10] not sending this round → trigger blocked (psi=0.995)
[S11] START round=44 head_norm_before_train=1.744187 cos_to_last_merge=0.9480 (last merge round=26)
[S11] ⚠️ Model drifted since last merge! cos=0.948
[S11] round=44 local utility u=0.004482 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9986271514717581, 'loss_val': 0.03022125011849521, 'psi': 0.9972363113589244}-{'f1_val': 0.9955431649470738, 'auprc': 0.9987853658324602, 'loss_val': 0.03506423451044747, 'psi': 0.9968400453012284}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=44 head_norm_before_train=1.845588 cos_to_last_merge=0.9991 (last merge round=34)
[S13] round=44 local utility u=0.000000 metrics={'f1_val': 0.6176414432664412, 'auprc': 0.7314659530716379, 'loss_val': 0.7383752439422062, 'psi': 0.6631712471885198}-{'f1_val': 0.6204292919038341, 'auprc': 0.7276182317213838, 'loss_val': 0.7400114286088609, 'psi': 0.663304867830854}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=44 head_norm_before_train=1.715081 cos_to_last_merge=0.9981 (last merge round=34)
[S14] round=44 local utility u=0.000000 metrics={'f1_val': 0.996673987435767, 'auprc': 0.9957687723332275, 'loss_val': 0.028376407500415802, 'psi': 0.9963119013947512}-{'f1_val': 0.9967805075071389, 'auprc': 0.9987138301813722, 'loss_val': 0.030174248165708097, 'psi': 0.9975538365768322}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=44 head_norm_before_train=1.572473 cos_to_last_merge=0.9968 (last merge round=31)
[S15] round=44 local utility u=0.000000 metrics={'f1_val': 0.7009169771696235, 'auprc': 0.9879573702576252, 'loss_val': 0.4695497641331933, 'psi': 0.8157331344048242}-{'f1_val': 0.9963362515743834, 'auprc': 0.9959923965093411, 'loss_val': 0.04439120369240524, 'psi': 0.9961987095483665}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=44 head_norm_before_train=1.613344 cos_to_last_merge=0.9965 (last merge round=33)
[S16] round=44 local utility u=0.000000 metrics={'f1_val': 0.9924008266522892, 'auprc': 0.9901630459308925, 'loss_val': 0.05249038641114109, 'psi': 0.9915057143637305}-{'f1_val': 0.9913599595172675, 'auprc': 0.9925995703721187, 'loss_val': 0.0514512694788745, 'psi': 0.991855803859208}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=44 head_norm_before_train=1.559251 cos_to_last_merge=0.9924 (last merge round=33)
[S17] round=44 local utility u=0.000000 metrics={'f1_val': 0.6030933476183408, 'auprc': 0.8463081370321429, 'loss_val': 0.9956546757495426, 'psi': 0.7003792633838617}-{'f1_val': 0.6340183197357627, 'auprc': 0.8462510777498276, 'loss_val': 0.7058843559965837, 'psi': 0.7189114229413887}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=45 head_norm_before_train=1.895006 cos_to_last_merge=0.9837 (last merge round=25)
[S2] round=45 local utility u=0.020880 metrics={'f1_val': 0.9735508659697301, 'auprc': 0.9785115341039068, 'loss_val': 0.08530170606635601, 'psi': 0.9755351332234008}-{'f1_val': 0.9647334824121316, 'auprc': 0.985215115294011, 'loss_val': 0.09426893214780205, 'psi': 0.9729261355648833}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[S3] START round=45 head_norm_before_train=2.092498 cos_to_last_merge=0.9961 (last merge round=32)
[S3] round=45 local utility u=0.000000 metrics={'f1_val': 0.9330083000139127, 'auprc': 0.9789192669618404, 'loss_val': 0.19836347533602183, 'psi': 0.9513726867930837}-{'f1_val': 0.9971441177008393, 'auprc': 0.99890559032522, 'loss_val': 0.027214972705557155, 'psi': 0.9978487067505916}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=45 head_norm_before_train=1.940026 (no previous merge yet)
[S4] round=45 local utility u=0.000000 metrics={'f1_val': 0.9522003336036592, 'auprc': 0.9468206719101115, 'loss_val': 0.2923938029800275, 'psi': 0.9500484689262402}-{'f1_val': 0.9470602529211968, 'auprc': 0.959133071804553, 'loss_val': 0.291609983973149, 'psi': 0.9518893804745392}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=45 head_norm_before_train=1.795589 cos_to_last_merge=0.9194 (last merge round=29)
[S5] ⚠️ Model drifted since last merge! cos=0.919
[S5] round=45 local utility u=0.000000 metrics={'f1_val': 0.9962633185437604, 'auprc': 0.994274488469709, 'loss_val': 0.034740972696647554, 'psi': 0.9954677865141398}-{'f1_val': 0.9962633185437604, 'auprc': 0.9949478950999703, 'loss_val': 0.03570534763796437, 'psi': 0.9957371491662443}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=45 head_norm_before_train=1.654369 cos_to_last_merge=0.9856 (last merge round=35)
[S6] round=45 local utility u=0.493961 metrics={'f1_val': 0.8209991518941724, 'auprc': 0.9597469738152035, 'loss_val': 0.32779145587767405, 'psi': 0.8764982806625848}-{'f1_val': 0.7289333701061085, 'auprc': 0.91391309951993, 'loss_val': 0.6258180159320668, 'psi': 0.8029252618716372}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=45 head_norm_before_train=1.632716 cos_to_last_merge=0.8111 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.811
[S7] round=45 local utility u=1.000000 metrics={'f1_val': 0.8031064936325072, 'auprc': 0.8743043529974627, 'loss_val': 0.23145271662904676, 'psi': 0.8315856373784893}-{'f1_val': 0.5462525848249193, 'auprc': 0.7799042399199245, 'loss_val': 0.8469268794486521, 'psi': 0.6397132468629214}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S7] sending update (kind=head size=1808 to 1 peers)
[S8] START round=45 head_norm_before_train=2.000824 cos_to_last_merge=0.9987 (last merge round=34)
[S8] round=45 local utility u=0.000000 metrics={'f1_val': 0.9882077600002297, 'auprc': 0.9986730635624714, 'loss_val': 0.04896697784281644, 'psi': 0.9923938814251263}-{'f1_val': 0.992402694124645, 'auprc': 0.9962697477914747, 'loss_val': 0.04742745359162812, 'psi': 0.9939495155913769}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=45 head_norm_before_train=2.191288 (no previous merge yet)
[S9] round=45 local utility u=0.007265 metrics={'f1_val': 0.9956098104564366, 'auprc': 0.9998275104591513, 'loss_val': 0.018358370789539245, 'psi': 0.9972968904575225}-{'f1_val': 0.9939393793306803, 'auprc': 0.9998679223902919, 'loss_val': 0.022986328040452624, 'psi': 0.996310796554525}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S9] sending update (kind=head size=1789 to 1 peers)
[S10] START round=45 head_norm_before_train=1.947244 cos_to_last_merge=0.9956 (last merge round=29)
[S10] round=45 local utility u=0.000000 metrics={'f1_val': 0.9939400388726987, 'auprc': 0.9961813544372645, 'loss_val': 0.03085639000044149, 'psi': 0.9948365650985249}-{'f1_val': 0.9941835069003575, 'auprc': 0.9960970029689232, 'loss_val': 0.030300512325659397, 'psi': 0.9949489053277838}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=45 head_norm_before_train=1.753440 cos_to_last_merge=0.9469 (last merge round=26)
[S11] ⚠️ Model drifted since last merge! cos=0.947
[S11] round=45 local utility u=0.001055 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9987442523775338, 'loss_val': 0.028462215139398776, 'psi': 0.9972831517212347}-{'f1_val': 0.9963090846170353, 'auprc': 0.9986271514717581, 'loss_val': 0.03022125011849521, 'psi': 0.9972363113589244}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=45 head_norm_before_train=1.848176 cos_to_last_merge=0.9991 (last merge round=34)
[S13] round=45 local utility u=0.000000 metrics={'f1_val': 0.5950398822608403, 'auprc': 0.733788093334397, 'loss_val': 0.9100505529313512, 'psi': 0.6505391666902629}-{'f1_val': 0.6176414432664412, 'auprc': 0.7314659530716379, 'loss_val': 0.7383752439422062, 'psi': 0.6631712471885198}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=45 head_norm_before_train=1.723570 cos_to_last_merge=0.9978 (last merge round=34)
[S14] round=45 local utility u=0.005594 metrics={'f1_val': 0.9966963661946637, 'auprc': 0.9987587381549952, 'loss_val': 0.0262932581781263, 'psi': 0.9975213149787963}-{'f1_val': 0.996673987435767, 'auprc': 0.9957687723332275, 'loss_val': 0.028376407500415802, 'psi': 0.9963119013947512}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=45 head_norm_before_train=1.581612 cos_to_last_merge=0.9965 (last merge round=31)
[S15] round=45 local utility u=0.233532 metrics={'f1_val': 0.7706544774661025, 'auprc': 0.9810253064929766, 'loss_val': 0.40011439661321657, 'psi': 0.8548028090768521}-{'f1_val': 0.7009169771696235, 'auprc': 0.9879573702576252, 'loss_val': 0.4695497641331933, 'psi': 0.8157331344048242}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=45 head_norm_before_train=1.623674 cos_to_last_merge=0.9960 (last merge round=33)
[S16] round=45 local utility u=0.001170 metrics={'f1_val': 0.9911406723783132, 'auprc': 0.9932722677021351, 'loss_val': 0.051917822634630496, 'psi': 0.991993310507842}-{'f1_val': 0.9924008266522892, 'auprc': 0.9901630459308925, 'loss_val': 0.05249038641114109, 'psi': 0.9915057143637305}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] sending update (kind=head size=1795 to 1 peers)
[S17] START round=45 head_norm_before_train=1.574586 cos_to_last_merge=0.9910 (last merge round=33)
[S17] round=45 local utility u=0.391446 metrics={'f1_val': 0.660231482506251, 'auprc': 0.8914964698886235, 'loss_val': 0.6911555584277227, 'psi': 0.7527374774591999}-{'f1_val': 0.6030933476183408, 'auprc': 0.8463081370321429, 'loss_val': 0.9956546757495426, 'psi': 0.7003792633838617}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] START round=46 head_norm_before_train=1.906416 cos_to_last_merge=0.9827 (last merge round=25)
[S2] round=46 local utility u=0.000000 metrics={'f1_val': 0.8509528413145688, 'auprc': 0.9582057014670263, 'loss_val': 0.3078778688596518, 'psi': 0.8938539853755518}-{'f1_val': 0.9735508659697301, 'auprc': 0.9785115341039068, 'loss_val': 0.08530170606635601, 'psi': 0.9755351332234008}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=46 head_norm_before_train=2.101587 cos_to_last_merge=0.9957 (last merge round=32)
[S3] round=46 local utility u=0.000000 metrics={'f1_val': 0.8407033585053318, 'auprc': 0.9805331140227783, 'loss_val': 0.4608815934454842, 'psi': 0.8966352607123105}-{'f1_val': 0.9330083000139127, 'auprc': 0.9789192669618404, 'loss_val': 0.19836347533602183, 'psi': 0.9513726867930837}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=46 head_norm_before_train=1.940691 (no previous merge yet)
[S4] round=46 local utility u=0.000000 metrics={'f1_val': 0.9407484783619611, 'auprc': 0.9540707953336205, 'loss_val': 0.29919950032922354, 'psi': 0.9460774051506249}-{'f1_val': 0.9522003336036592, 'auprc': 0.9468206719101115, 'loss_val': 0.2923938029800275, 'psi': 0.9500484689262402}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=46 head_norm_before_train=1.813210 cos_to_last_merge=0.9160 (last merge round=29)
[S5] ⚠️ Model drifted since last merge! cos=0.916
[S5] round=46 local utility u=0.000000 metrics={'f1_val': 0.995895166894551, 'auprc': 0.9932155258941165, 'loss_val': 0.036997773874460606, 'psi': 0.9948233104943772}-{'f1_val': 0.9962633185437604, 'auprc': 0.994274488469709, 'loss_val': 0.034740972696647554, 'psi': 0.9954677865141398}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=46 head_norm_before_train=1.668348 cos_to_last_merge=0.9839 (last merge round=35)
[S6] round=46 local utility u=0.000000 metrics={'f1_val': 0.5885351172618278, 'auprc': 0.9360035024296951, 'loss_val': 0.8165734088627643, 'psi': 0.7275224713289747}-{'f1_val': 0.8209991518941724, 'auprc': 0.9597469738152035, 'loss_val': 0.32779145587767405, 'psi': 0.8764982806625848}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=46 head_norm_before_train=1.640764 cos_to_last_merge=0.8108 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.811
[S7] round=46 local utility u=0.000000 metrics={'f1_val': 0.6364278714383244, 'auprc': 0.8033868435462459, 'loss_val': 0.4736096762877462, 'psi': 0.703211460281493}-{'f1_val': 0.8031064936325072, 'auprc': 0.8743043529974627, 'loss_val': 0.23145271662904676, 'psi': 0.8315856373784893}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=46 head_norm_before_train=2.008677 cos_to_last_merge=0.9985 (last merge round=34)
[S8] round=46 local utility u=0.020208 metrics={'f1_val': 0.9928159069878363, 'auprc': 0.9981449433535163, 'loss_val': 0.03461580809594025, 'psi': 0.9949475215341083}-{'f1_val': 0.9882077600002297, 'auprc': 0.9986730635624714, 'loss_val': 0.04896697784281644, 'psi': 0.9923938814251263}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=46 head_norm_before_train=2.198783 (no previous merge yet)
[S9] round=46 local utility u=0.000000 metrics={'f1_val': 0.992684475148198, 'auprc': 0.9997291599924567, 'loss_val': 0.025803539869113323, 'psi': 0.9955023490859015}-{'f1_val': 0.9956098104564366, 'auprc': 0.9998275104591513, 'loss_val': 0.018358370789539245, 'psi': 0.9972968904575225}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=46 head_norm_before_train=1.953967 cos_to_last_merge=0.9952 (last merge round=29)
[S10] round=46 local utility u=0.000144 metrics={'f1_val': 0.9939400388726987, 'auprc': 0.9961827060099174, 'loss_val': 0.030572603986655598, 'psi': 0.9948371057275862}-{'f1_val': 0.9939400388726987, 'auprc': 0.9961813544372645, 'loss_val': 0.03085639000044149, 'psi': 0.9948365650985249}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=46 head_norm_before_train=1.763032 cos_to_last_merge=0.9457 (last merge round=26)
[S11] ⚠️ Model drifted since last merge! cos=0.946
[S11] round=46 local utility u=0.002213 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9987757292304575, 'loss_val': 0.026609708868992606, 'psi': 0.9975437434410923}-{'f1_val': 0.9963090846170353, 'auprc': 0.9987442523775338, 'loss_val': 0.028462215139398776, 'psi': 0.9972831517212347}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] sending update (kind=head size=1804 to 1 peers)
[S13] START round=46 head_norm_before_train=1.852724 cos_to_last_merge=0.9990 (last merge round=34)
[S13] round=46 local utility u=0.000000 metrics={'f1_val': 0.5929062395905011, 'auprc': 0.7411863016098665, 'loss_val': 0.9898559922915681, 'psi': 0.6522182643982473}-{'f1_val': 0.5950398822608403, 'auprc': 0.733788093334397, 'loss_val': 0.9100505529313512, 'psi': 0.6505391666902629}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=46 head_norm_before_train=1.730511 cos_to_last_merge=0.9976 (last merge round=34)
[S14] round=46 local utility u=0.001974 metrics={'f1_val': 0.997043018986542, 'auprc': 0.9991378398822288, 'loss_val': 0.02556307973521794, 'psi': 0.9978809473448167}-{'f1_val': 0.9966963661946637, 'auprc': 0.9987587381549952, 'loss_val': 0.0262932581781263, 'psi': 0.9975213149787963}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=46 head_norm_before_train=1.592973 cos_to_last_merge=0.9960 (last merge round=31)
[S15] round=46 local utility u=0.781808 metrics={'f1_val': 0.9714302515850525, 'auprc': 0.991385405519611, 'loss_val': 0.07223251252817907, 'psi': 0.9794123131588759}-{'f1_val': 0.7706544774661025, 'auprc': 0.9810253064929766, 'loss_val': 0.40011439661321657, 'psi': 0.8548028090768521}
[S15] not sending this round → trigger blocked (psi=0.979)
[S16] START round=46 head_norm_before_train=1.634065 cos_to_last_merge=0.9956 (last merge round=33)
[S16] round=46 local utility u=0.000000 metrics={'f1_val': 0.96805061061885, 'auprc': 0.990553964751222, 'loss_val': 0.11467107019098727, 'psi': 0.9770519522717989}-{'f1_val': 0.9911406723783132, 'auprc': 0.9932722677021351, 'loss_val': 0.051917822634630496, 'psi': 0.991993310507842}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=46 head_norm_before_train=1.590377 cos_to_last_merge=0.9896 (last merge round=33)
[S17] round=46 local utility u=0.424051 metrics={'f1_val': 0.7642237083794543, 'auprc': 0.8966624506428983, 'loss_val': 0.48250509589969054, 'psi': 0.8171992052848318}-{'f1_val': 0.660231482506251, 'auprc': 0.8914964698886235, 'loss_val': 0.6911555584277227, 'psi': 0.7527374774591999}
[S17] not sending this round → trigger blocked (psi=0.817)
[S2] START round=47 head_norm_before_train=1.915388 cos_to_last_merge=0.9818 (last merge round=25)
[S2] round=47 local utility u=0.314769 metrics={'f1_val': 0.9166995809730943, 'auprc': 0.9867953310606988, 'loss_val': 0.15858977468260146, 'psi': 0.9447378810081362}-{'f1_val': 0.8509528413145688, 'auprc': 0.9582057014670263, 'loss_val': 0.3078778688596518, 'psi': 0.8938539853755518}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S2] sending update (kind=head size=1792 to 1 peers)
[S3] START round=47 head_norm_before_train=2.112654 cos_to_last_merge=0.9953 (last merge round=32)
[S3] round=47 local utility u=0.698198 metrics={'f1_val': 0.9929404216039119, 'auprc': 0.9987816071471596, 'loss_val': 0.03265336968473711, 'psi': 0.995276895821211}-{'f1_val': 0.8407033585053318, 'auprc': 0.9805331140227783, 'loss_val': 0.4608815934454842, 'psi': 0.8966352607123105}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=47 head_norm_before_train=1.941802 (no previous merge yet)
[S4] round=47 local utility u=0.000000 metrics={'f1_val': 0.9299324539805256, 'auprc': 0.9231764445995532, 'loss_val': 0.35925928759234166, 'psi': 0.9272300502281366}-{'f1_val': 0.9407484783619611, 'auprc': 0.9540707953336205, 'loss_val': 0.29919950032922354, 'psi': 0.9460774051506249}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=47 head_norm_before_train=1.835598 cos_to_last_merge=0.9128 (last merge round=29)
[S5] ⚠️ Model drifted since last merge! cos=0.913
[S5] round=47 local utility u=0.007672 metrics={'f1_val': 0.9962633185437604, 'auprc': 0.9954993051808418, 'loss_val': 0.030714577858347636, 'psi': 0.9959577131985929}-{'f1_val': 0.995895166894551, 'auprc': 0.9932155258941165, 'loss_val': 0.036997773874460606, 'psi': 0.9948233104943772}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=47 head_norm_before_train=1.679794 cos_to_last_merge=0.9822 (last merge round=35)
[S6] round=47 local utility u=0.942505 metrics={'f1_val': 0.8306067300708129, 'auprc': 0.95258199119632, 'loss_val': 0.4337279800364945, 'psi': 0.8793968345210157}-{'f1_val': 0.5885351172618278, 'auprc': 0.9360035024296951, 'loss_val': 0.8165734088627643, 'psi': 0.7275224713289747}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[S7] START round=47 head_norm_before_train=1.646631 cos_to_last_merge=0.8105 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.810
[S7] round=47 local utility u=0.000000 metrics={'f1_val': 0.5464963117170369, 'auprc': 0.7794910572642414, 'loss_val': 1.0903591343841512, 'psi': 0.6396942099359187}-{'f1_val': 0.6364278714383244, 'auprc': 0.8033868435462459, 'loss_val': 0.4736096762877462, 'psi': 0.703211460281493}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=47 head_norm_before_train=2.014585 cos_to_last_merge=0.9983 (last merge round=34)
[S8] round=47 local utility u=0.000000 metrics={'f1_val': 0.9876281799992727, 'auprc': 0.9987077838878801, 'loss_val': 0.04967288463885053, 'psi': 0.9920600215547155}-{'f1_val': 0.9928159069878363, 'auprc': 0.9981449433535163, 'loss_val': 0.03461580809594025, 'psi': 0.9949475215341083}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=47 head_norm_before_train=2.201742 (no previous merge yet)
[S9] round=47 local utility u=0.017249 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9998439283737002, 'loss_val': 0.016659445215908127, 'psi': 0.9980491226048345}-{'f1_val': 0.992684475148198, 'auprc': 0.9997291599924567, 'loss_val': 0.025803539869113323, 'psi': 0.9955023490859015}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=47 head_norm_before_train=1.959761 cos_to_last_merge=0.9948 (last merge round=29)
[S10] round=47 local utility u=0.000153 metrics={'f1_val': 0.9939643640207476, 'auprc': 0.9961064195067886, 'loss_val': 0.030183499254042706, 'psi': 0.994821186215164}-{'f1_val': 0.9939400388726987, 'auprc': 0.9961827060099174, 'loss_val': 0.030572603986655598, 'psi': 0.9948371057275862}
[S10] not sending this round → trigger blocked (psi=0.995)
[S11] START round=47 head_norm_before_train=1.772329 cos_to_last_merge=0.9446 (last merge round=26)
[S11] ⚠️ Model drifted since last merge! cos=0.945
[S11] round=47 local utility u=0.000000 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9964423664342297, 'loss_val': 0.028613613234230405, 'psi': 0.9963623973439131}-{'f1_val': 0.9967224195815153, 'auprc': 0.9987757292304575, 'loss_val': 0.026609708868992606, 'psi': 0.9975437434410923}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=47 head_norm_before_train=1.859405 cos_to_last_merge=0.9988 (last merge round=34)
[S13] round=47 local utility u=0.066504 metrics={'f1_val': 0.6227432589813777, 'auprc': 0.7556166408612012, 'loss_val': 1.0791606428962974, 'psi': 0.6758926117333071}-{'f1_val': 0.5929062395905011, 'auprc': 0.7411863016098665, 'loss_val': 0.9898559922915681, 'psi': 0.6522182643982473}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] sending update (kind=head size=1796 to 1 peers)
[S14] START round=47 head_norm_before_train=1.738017 cos_to_last_merge=0.9973 (last merge round=34)
[S14] round=47 local utility u=0.000158 metrics={'f1_val': 0.9969981421187261, 'auprc': 0.9988357195397763, 'loss_val': 0.02407201973249214, 'psi': 0.9977331730871462}-{'f1_val': 0.997043018986542, 'auprc': 0.9991378398822288, 'loss_val': 0.02556307973521794, 'psi': 0.9978809473448167}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] sending update (kind=head size=1804 to 1 peers)
[S15] START round=47 head_norm_before_train=1.604398 cos_to_last_merge=0.9956 (last merge round=31)
[S15] round=47 local utility u=0.000000 metrics={'f1_val': 0.9622343687092334, 'auprc': 0.9919647947337086, 'loss_val': 0.08018958158416123, 'psi': 0.9741265391190235}-{'f1_val': 0.9714302515850525, 'auprc': 0.991385405519611, 'loss_val': 0.07223251252817907, 'psi': 0.9794123131588759}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=47 head_norm_before_train=1.644008 cos_to_last_merge=0.9952 (last merge round=33)
[S16] round=47 local utility u=0.000000 metrics={'f1_val': 0.9390067681670593, 'auprc': 0.9902309449890114, 'loss_val': 0.29825627090612356, 'psi': 0.9594964388958401}-{'f1_val': 0.96805061061885, 'auprc': 0.990553964751222, 'loss_val': 0.11467107019098727, 'psi': 0.9770519522717989}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=47 head_norm_before_train=1.608189 cos_to_last_merge=0.9879 (last merge round=33)
[S17] round=47 local utility u=0.000000 metrics={'f1_val': 0.6436717491548813, 'auprc': 0.8584694407852628, 'loss_val': 0.91995515721097, 'psi': 0.7295908258070338}-{'f1_val': 0.7642237083794543, 'auprc': 0.8966624506428983, 'loss_val': 0.48250509589969054, 'psi': 0.8171992052848318}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=48 head_norm_before_train=1.924716 cos_to_last_merge=0.9809 (last merge round=25)
[S2] round=48 local utility u=0.000000 metrics={'f1_val': 0.8801180894906752, 'auprc': 0.9688047056592011, 'loss_val': 0.22773727575165761, 'psi': 0.9155927359580855}-{'f1_val': 0.9166995809730943, 'auprc': 0.9867953310606988, 'loss_val': 0.15858977468260146, 'psi': 0.9447378810081362}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=48 head_norm_before_train=2.123674 cos_to_last_merge=0.9948 (last merge round=32)
[S3] round=48 local utility u=0.000000 metrics={'f1_val': 0.9863815766111872, 'auprc': 0.9990910205326561, 'loss_val': 0.03738399488233483, 'psi': 0.9914653541797748}-{'f1_val': 0.9929404216039119, 'auprc': 0.9987816071471596, 'loss_val': 0.03265336968473711, 'psi': 0.995276895821211}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=48 head_norm_before_train=1.943858 (no previous merge yet)
[S4] round=48 local utility u=0.000000 metrics={'f1_val': 0.6218622155151674, 'auprc': 0.7757719390640685, 'loss_val': 0.7834501133479566, 'psi': 0.6834261049347279}-{'f1_val': 0.9299324539805256, 'auprc': 0.9231764445995532, 'loss_val': 0.35925928759234166, 'psi': 0.9272300502281366}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=48 head_norm_before_train=1.855173 cos_to_last_merge=0.9102 (last merge round=29)
[S5] ⚠️ Model drifted since last merge! cos=0.910
[S5] round=48 local utility u=0.000000 metrics={'f1_val': 0.9962633185437604, 'auprc': 0.9936611909630175, 'loss_val': 0.02920716464110327, 'psi': 0.9952224675114631}-{'f1_val': 0.9962633185437604, 'auprc': 0.9954993051808418, 'loss_val': 0.030714577858347636, 'psi': 0.9959577131985929}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=48 head_norm_before_train=1.688600 cos_to_last_merge=0.9809 (last merge round=35)
[S6] round=48 local utility u=0.000000 metrics={'f1_val': 0.8065696277262172, 'auprc': 0.888495768167959, 'loss_val': 0.5221954354553924, 'psi': 0.8393400839029139}-{'f1_val': 0.8306067300708129, 'auprc': 0.95258199119632, 'loss_val': 0.4337279800364945, 'psi': 0.8793968345210157}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=48 head_norm_before_train=1.653219 cos_to_last_merge=0.8098 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.810
[S7] round=48 local utility u=1.000000 metrics={'f1_val': 0.7679625929357724, 'auprc': 0.8370297407137143, 'loss_val': 0.2989953014141185, 'psi': 0.7955894520469491}-{'f1_val': 0.5464963117170369, 'auprc': 0.7794910572642414, 'loss_val': 1.0903591343841512, 'psi': 0.6396942099359187}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1810 reason=None
[S7] sending update (kind=head size=1810 to 1 peers)
[S8] START round=48 head_norm_before_train=2.019988 cos_to_last_merge=0.9982 (last merge round=34)
[S8] round=48 local utility u=0.015667 metrics={'f1_val': 0.9917244887003366, 'auprc': 0.9986089058455265, 'loss_val': 0.04262027334341205, 'psi': 0.9944782555584126}-{'f1_val': 0.9876281799992727, 'auprc': 0.9987077838878801, 'loss_val': 0.04967288463885053, 'psi': 0.9920600215547155}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=48 head_norm_before_train=2.209225 (no previous merge yet)
[S9] round=48 local utility u=0.000000 metrics={'f1_val': 0.9958601375429889, 'auprc': 0.9985329927952836, 'loss_val': 0.017241124957698473, 'psi': 0.9969292796439067}-{'f1_val': 0.9968525854255906, 'auprc': 0.9998439283737002, 'loss_val': 0.016659445215908127, 'psi': 0.9980491226048345}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=48 head_norm_before_train=1.963712 cos_to_last_merge=0.9943 (last merge round=29)
[S10] round=48 local utility u=0.000000 metrics={'f1_val': 0.9935262985458464, 'auprc': 0.9961067108173169, 'loss_val': 0.03086145571220659, 'psi': 0.9945584634544347}-{'f1_val': 0.9939643640207476, 'auprc': 0.9961064195067886, 'loss_val': 0.030183499254042706, 'psi': 0.994821186215164}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=48 head_norm_before_train=1.779086 cos_to_last_merge=0.9437 (last merge round=26)
[S11] ⚠️ Model drifted since last merge! cos=0.944
[S11] round=48 local utility u=0.000000 metrics={'f1_val': 0.9948671806073948, 'auprc': 0.9988934195913894, 'loss_val': 0.03068446229015573, 'psi': 0.9964776762009927}-{'f1_val': 0.9963090846170353, 'auprc': 0.9964423664342297, 'loss_val': 0.028613613234230405, 'psi': 0.9963623973439131}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=48 head_norm_before_train=1.866498 cos_to_last_merge=0.9986 (last merge round=34)
[S13] round=48 local utility u=0.186228 metrics={'f1_val': 0.6407185970050304, 'auprc': 0.7176277870828501, 'loss_val': 0.70059062448438, 'psi': 0.6714822730361583}-{'f1_val': 0.6227432589813777, 'auprc': 0.7556166408612012, 'loss_val': 1.0791606428962974, 'psi': 0.6758926117333071}
[S13] not sending this round → trigger blocked (psi=0.671)
[S14] START round=48 head_norm_before_train=1.746090 cos_to_last_merge=0.9971 (last merge round=34)
[S14] round=48 local utility u=0.000792 metrics={'f1_val': 0.9970842644973595, 'auprc': 0.9991700343098228, 'loss_val': 0.02400705354140496, 'psi': 0.9979185724223448}-{'f1_val': 0.9969981421187261, 'auprc': 0.9988357195397763, 'loss_val': 0.02407201973249214, 'psi': 0.9977331730871462}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=48 head_norm_before_train=1.617390 cos_to_last_merge=0.9950 (last merge round=31)
[S15] round=48 local utility u=0.102712 metrics={'f1_val': 0.9911859378077299, 'auprc': 0.992896496189704, 'loss_val': 0.05126951814160379, 'psi': 0.9918701611605195}-{'f1_val': 0.9622343687092334, 'auprc': 0.9919647947337086, 'loss_val': 0.08018958158416123, 'psi': 0.9741265391190235}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] sending update (kind=head size=1802 to 1 peers)
[S16] START round=48 head_norm_before_train=1.653158 cos_to_last_merge=0.9947 (last merge round=33)
[S16] round=48 local utility u=0.000000 metrics={'f1_val': 0.887784756205063, 'auprc': 0.985071187123046, 'loss_val': 0.5960707994910739, 'psi': 0.9266993285722562}-{'f1_val': 0.9390067681670593, 'auprc': 0.9902309449890114, 'loss_val': 0.29825627090612356, 'psi': 0.9594964388958401}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=48 head_norm_before_train=1.624843 cos_to_last_merge=0.9863 (last merge round=33)
[S17] round=48 local utility u=0.000000 metrics={'f1_val': 0.6057518746128601, 'auprc': 0.8471789753763457, 'loss_val': 1.0063397458091266, 'psi': 0.7023227149182543}-{'f1_val': 0.6436717491548813, 'auprc': 0.8584694407852628, 'loss_val': 0.91995515721097, 'psi': 0.7295908258070338}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=49 head_norm_before_train=1.933036 cos_to_last_merge=0.9802 (last merge round=25)
[S2] round=49 local utility u=0.000000 metrics={'f1_val': 0.788835293800261, 'auprc': 0.9692114734615904, 'loss_val': 0.4242989539306971, 'psi': 0.8609857656647928}-{'f1_val': 0.8801180894906752, 'auprc': 0.9688047056592011, 'loss_val': 0.22773727575165761, 'psi': 0.9155927359580855}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=49 head_norm_before_train=2.134893 cos_to_last_merge=0.9944 (last merge round=32)
[S3] round=49 local utility u=0.041260 metrics={'f1_val': 0.9973415147416245, 'auprc': 0.9990328258448615, 'loss_val': 0.020449412288244935, 'psi': 0.9980180391829193}-{'f1_val': 0.9863815766111872, 'auprc': 0.9990910205326561, 'loss_val': 0.03738399488233483, 'psi': 0.9914653541797748}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=49 head_norm_before_train=1.943132 (no previous merge yet)
[S4] round=49 local utility u=1.000000 metrics={'f1_val': 0.9414984413504447, 'auprc': 0.9287262548760793, 'loss_val': 0.3145734711464626, 'psi': 0.9363895667606985}-{'f1_val': 0.6218622155151674, 'auprc': 0.7757719390640685, 'loss_val': 0.7834501133479566, 'psi': 0.6834261049347279}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=49 head_norm_before_train=1.872232 cos_to_last_merge=0.9072 (last merge round=29)
[S5] ⚠️ Model drifted since last merge! cos=0.907
[S5] round=49 local utility u=0.002405 metrics={'f1_val': 0.9962633185437604, 'auprc': 0.9948434320747496, 'loss_val': 0.027944348783267133, 'psi': 0.995695363956156}-{'f1_val': 0.9962633185437604, 'auprc': 0.9936611909630175, 'loss_val': 0.02920716464110327, 'psi': 0.9952224675114631}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=49 head_norm_before_train=1.702210 cos_to_last_merge=0.9793 (last merge round=35)
[S6] round=49 local utility u=0.000000 metrics={'f1_val': 0.7273840640378425, 'auprc': 0.9004080333993962, 'loss_val': 0.6744906251561495, 'psi': 0.7965936517824641}-{'f1_val': 0.8065696277262172, 'auprc': 0.888495768167959, 'loss_val': 0.5221954354553924, 'psi': 0.8393400839029139}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=49 head_norm_before_train=1.658519 cos_to_last_merge=0.8102 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.810
[S7] round=49 local utility u=0.000000 metrics={'f1_val': 0.6281460668797791, 'auprc': 0.7913299409068004, 'loss_val': 0.6898876318419253, 'psi': 0.6934196164905877}-{'f1_val': 0.7679625929357724, 'auprc': 0.8370297407137143, 'loss_val': 0.2989953014141185, 'psi': 0.7955894520469491}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=49 head_norm_before_train=2.025561 cos_to_last_merge=0.9980 (last merge round=34)
[S8] round=49 local utility u=0.000000 metrics={'f1_val': 0.9569569692088502, 'auprc': 0.9985367706993937, 'loss_val': 0.10529334237497645, 'psi': 0.9735888898050675}-{'f1_val': 0.9917244887003366, 'auprc': 0.9986089058455265, 'loss_val': 0.04262027334341205, 'psi': 0.9944782555584126}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=49 head_norm_before_train=2.216312 (no previous merge yet)
[S9] round=49 local utility u=0.004299 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9985275558030633, 'loss_val': 0.01608270625986883, 'psi': 0.997672769828511}-{'f1_val': 0.9958601375429889, 'auprc': 0.9985329927952836, 'loss_val': 0.017241124957698473, 'psi': 0.9969292796439067}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=49 head_norm_before_train=1.969898 cos_to_last_merge=0.9939 (last merge round=29)
[S10] round=49 local utility u=0.002049 metrics={'f1_val': 0.9939643640207476, 'auprc': 0.9961104842138415, 'loss_val': 0.02940251960502456, 'psi': 0.9948228120979852}-{'f1_val': 0.9935262985458464, 'auprc': 0.9961067108173169, 'loss_val': 0.03086145571220659, 'psi': 0.9945584634544347}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=49 head_norm_before_train=1.786426 cos_to_last_merge=0.9428 (last merge round=26)
[S11] ⚠️ Model drifted since last merge! cos=0.943
[S11] round=49 local utility u=0.006527 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9987808961551181, 'loss_val': 0.025944653825455966, 'psi': 0.9972978092322684}-{'f1_val': 0.9948671806073948, 'auprc': 0.9988934195913894, 'loss_val': 0.03068446229015573, 'psi': 0.9964776762009927}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=49 head_norm_before_train=1.870990 cos_to_last_merge=0.9984 (last merge round=34)
[S13] round=49 local utility u=0.000000 metrics={'f1_val': 0.6318127178191334, 'auprc': 0.7711437662486018, 'loss_val': 1.0154606363689302, 'psi': 0.6875451371909208}-{'f1_val': 0.6407185970050304, 'auprc': 0.7176277870828501, 'loss_val': 0.70059062448438, 'psi': 0.6714822730361583}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=49 head_norm_before_train=1.753669 cos_to_last_merge=0.9968 (last merge round=34)
[S14] round=49 local utility u=0.000000 metrics={'f1_val': 0.9965803821790421, 'auprc': 0.9970410799169087, 'loss_val': 0.025930359970509874, 'psi': 0.9967646612741887}-{'f1_val': 0.9970842644973595, 'auprc': 0.9991700343098228, 'loss_val': 0.02400705354140496, 'psi': 0.9979185724223448}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=49 head_norm_before_train=1.632441 cos_to_last_merge=0.9943 (last merge round=31)
[S15] round=49 local utility u=0.010386 metrics={'f1_val': 0.9938234507180074, 'auprc': 0.9931203791686956, 'loss_val': 0.04699373012421683, 'psi': 0.9935422220982826}-{'f1_val': 0.9911859378077299, 'auprc': 0.992896496189704, 'loss_val': 0.05126951814160379, 'psi': 0.9918701611605195}
[S15] not sending this round → trigger blocked (psi=0.994)
[S16] START round=49 head_norm_before_train=1.662072 cos_to_last_merge=0.9943 (last merge round=33)
[S16] round=49 local utility u=0.354375 metrics={'f1_val': 0.9404689430647275, 'auprc': 0.9893220512393696, 'loss_val': 0.21617918942800854, 'psi': 0.9600101863345843}-{'f1_val': 0.887784756205063, 'auprc': 0.985071187123046, 'loss_val': 0.5960707994910739, 'psi': 0.9266993285722562}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S17] START round=49 head_norm_before_train=1.638481 cos_to_last_merge=0.9848 (last merge round=33)
[S17] round=49 local utility u=0.356837 metrics={'f1_val': 0.6750889872006361, 'auprc': 0.8567709619218974, 'loss_val': 0.7374635544645821, 'psi': 0.7477617770891407}-{'f1_val': 0.6057518746128601, 'auprc': 0.8471789753763457, 'loss_val': 1.0063397458091266, 'psi': 0.7023227149182543}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[runner] rounds complete.
[runner] all agents stopped.
