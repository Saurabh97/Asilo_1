[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:37103
[S3] → join 127.0.0.1:37102
[S4] → join 127.0.0.1:37102
[S5] → join 127.0.0.1:37102
[S6] → join 127.0.0.1:37102
[S7] → join 127.0.0.1:37102
[S8] → join 127.0.0.1:37102
[S9] → join 127.0.0.1:37102
[S10] → join 127.0.0.1:37102
[S11] → join 127.0.0.1:37102
[S13] → join 127.0.0.1:37102
[S14] → join 127.0.0.1:37102
[S15] → join 127.0.0.1:37102
[S16] → join 127.0.0.1:37102
[S17] → join 127.0.0.1:37102
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.173907 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.150698 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.149525 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.150710 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.164105 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.115807 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.171187 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.172490 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.197298 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.155459 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.106502 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.118806 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.159926 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.211213 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.203154 (no previous merge yet)
[S13]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S4] + discovered S2
[S3] + discovered S14
[S3] + discovered S16
[S3] + discovered S13
[S3] + discovered S5
[S3] + discovered S8
[S3] + discovered S6
[S3] + discovered S11
[S3] + discovered S15
[S3] + discovered S7
[S3] + discovered S10
[S3] + discovered S17
[S3] + discovered S4
[S3] + discovered S9
[S4] + discovered S3
[S5] + discovered S4
[S5] + discovered S3
[S5] + discovered S2
[S4] + discovered S5
[S4] + discovered S14
[S4] + discovered S16
[S4] + discovered S13
[S4] + discovered S8
[S4] + discovered S6
[S4] + discovered S11
[S4] + discovered S7
[S4] + discovered S15
[S4] + discovered S10
[S4] + discovered S17
[S4] + discovered S9
[S6] + discovered S4
[S6] + discovered S2
[S6] + discovered S3
[S6] + discovered S5
[S5] + discovered S11
[S5] + discovered S10
[S5] + discovered S15
[S5] + discovered S6
[S5] + discovered S13
[S5] + discovered S14
[S5] + discovered S9
[S5] + discovered S17
[S5] + discovered S7
[S5] + discovered S8
[S5] + discovered S16
[S6] + discovered S14
[S6] + discovered S7
[S6] + discovered S17
[S6] + discovered S13
[S6] + discovered S9
[S6] + discovered S8
[S6] + discovered S10
[S6] + discovered S16
[S6] + discovered S15
[S6] + discovered S11
[S7] + discovered S5
[S7] + discovered S2
[S7] + discovered S6
[S7] + discovered S4
[S7] + discovered S3
[S8] + discovered S3
[S8] + discovered S5
[S8] + discovered S4
[S8] + discovered S6
[S8] + discovered S2
[S8] + discovered S7
[S7] + discovered S11
[S7] + discovered S15
[S7] + discovered S10
[S7] + discovered S8
[S7] + discovered S13
[S7] + discovered S9
[S7] + discovered S14
[S7] + discovered S16
[S7] + discovered S17
[S8] + discovered S16
[S8] + discovered S17
[S9] + discovered S3
[S9] + discovered S5
[S9] + discovered S4
[S9] + discovered S2
[S9] + discovered S7
[S9] + discovered S8
[S9] + discovered S6
[S8] + discovered S11
[S8] + discovered S10
[S8] + discovered S13
[S8] + discovered S15
[S8] + discovered S9
[S8] + discovered S14
[S10] + discovered S9
[S10] + discovered S4
[S10] + discovered S7
[S10] + discovered S2
[S10] + discovered S8
[S10] + discovered S5
[S10] + discovered S3
[S10] + discovered S6
[S9] + discovered S14
[S9] + discovered S15
[S9] + discovered S11
[S9] + discovered S10
[S9] + discovered S13
[S9] + discovered S17
[S9] + discovered S16
[S11] + discovered S5
[S11] + discovered S2
[S11] + discovered S8
[S11] + discovered S7
[S11] + discovered S9
[S11] + discovered S6
[S11] + discovered S3
[S11] + discovered S10
[S11] + discovered S4
[S10] + discovered S11
[S10] + discovered S17
[S10] + discovered S16
[S10] + discovered S13
[S10] + discovered S15
[S10] + discovered S14
[S11] + discovered S14
[S11] + discovered S13
[S11] + discovered S16
[S11] + discovered S17
[S11] + discovered S15
[S13] + discovered S10
[S13] + discovered S6
[S13] + discovered S9
[S13] + discovered S7
[S13] + discovered S8
[S13] + discovered S11
[S13] + discovered S4
[S13] + discovered S2
[S13] + discovered S3
[S13] + discovered S5
[S14] + discovered S7
[S14] + discovered S6
[S13] + discovered S17
[S13] + discovered S14
[S14] + discovered S2
[S14] + discovered S3
[S14] + discovered S10
[S13] + discovered S15
[S14] + discovered S9
[S13] + discovered S16
[S14] + discovered S13
[S14] + discovered S4
[S14] + discovered S5
[S14] + discovered S11
[S14] + discovered S8
[S15] + discovered S11
[S15] + discovered S7
[S15] + discovered S9
[S15] + discovered S5
[S15] + discovered S14
[S15] + discovered S10
[S15] + discovered S4
[S15] + discovered S2
[S15] + discovered S8
[S15] + discovered S3
[S15] + discovered S13
[S15] + discovered S6
[S14] + discovered S16
[S14] + discovered S17
[S14] + discovered S15
[S16] + discovered S5
[S16] + discovered S11
[S15] + discovered S16
[S16] + discovered S9
[S16] + discovered S14
[S16] + discovered S10
[S16] + discovered S4
[S16] + discovered S2
[S16] + discovered S8
[S16] + discovered S3
[S16] + discovered S15
[S16] + discovered S13
[S15] + discovered S17
[S16] + discovered S6
[S16] + discovered S7
[S17] + discovered S11
[S17] + discovered S14
[S17] + discovered S10
[S17] + discovered S2
[S17] + discovered S8
[S17] + discovered S3
[S17] + discovered S13
[S16] + discovered S17
[S17] + discovered S5
[S17] + discovered S4
[S17] + discovered S15
[S17] + discovered S6
[S17] + discovered S9
[S17] + discovered S7
[S17] + discovered S16
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] ⇄ pheromone p=1.000 → S4@127.0.0.1:37104
[S6] ⇄ pheromone p=1.000 → S11@127.0.0.1:37112
[S15] ⇄ pheromone p=1.000 → S16@127.0.0.1:37116
[S4] ⇄ pheromone p=1.000 → S9@127.0.0.1:37110
[S3] ⇄ pheromone p=1.000 → S4@127.0.0.1:37104
[S13] ⇄ pheromone p=1.000 → S16@127.0.0.1:37116
[S16] ⇄ pheromone p=1.000 → S2@127.0.0.1:37102
[S10] ⇄ pheromone p=1.000 → S14@127.0.0.1:37114
[S2] ⇄ pheromone p=1.000 → S16@127.0.0.1:37116
[S7] ⇄ pheromone p=1.000 → S10@127.0.0.1:37111
[S5] ⇄ pheromone p=1.000 → S9@127.0.0.1:37110
[S9] ⇄ pheromone p=1.000 → S13@127.0.0.1:37113
[S11] ⇄ pheromone p=1.000 → S14@127.0.0.1:37114
[S8] ⇄ pheromone p=1.000 → S17@127.0.0.1:37117
[S17] ⇄ pheromone p=1.000 → S9@127.0.0.1:37110
[S2] START round=1 head_norm_before_train=1.178353 (no previous merge yet)
[S2] round=1 local utility u=0.093949 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.756069699279001, 'loss_val': 1.3405535173346312, 'psi': 0.3874941597447405}-{'f1_val': 0.1264130135097877, 'auprc': 0.7359521948289965, 'loss_val': 1.3759145248046218, 'psi': 0.3702286860374712}
[S3] START round=1 head_norm_before_train=1.166343 (no previous merge yet)
[S3] round=1 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.619643116064609, 'loss_val': 1.2787181410516346, 'psi': 0.33176128579430786}-{'f1_val': 0.13984006561410703, 'auprc': 0.6813778019571726, 'loss_val': 1.336632170034069, 'psi': 0.3564551601513333}
[S4] START round=1 head_norm_before_train=1.147561 (no previous merge yet)
[S4] round=1 local utility u=0.382771 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.5958425033671111, 'loss_val': 1.3102909678539318, 'psi': 0.3224729786839549}-{'f1_val': 0.14022662889518414, 'auprc': 0.3502322858389967, 'loss_val': 1.3390013309477364, 'psi': 0.22422889167270915}
[S5] START round=1 head_norm_before_train=1.155355 (no previous merge yet)
[S5] round=1 local utility u=0.030257 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.769856930058823, 'loss_val': 1.2534467499151252, 'psi': 0.3932999148806721}-{'f1_val': 0.14226190476190476, 'auprc': 0.7699948336654842, 'loss_val': 1.3143743221173814, 'psi': 0.39335507632333655}
[S6] START round=1 head_norm_before_train=1.164002 (no previous merge yet)
[S6] round=1 local utility u=0.188396 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6335147017807317, 'loss_val': 1.316732392461481, 'psi': 0.3382616499430619}-{'f1_val': 0.14142628205128205, 'auprc': 0.5166471065629012, 'loss_val': 1.3429218993819179, 'psi': 0.29151461185592975}
[S7] START round=1 head_norm_before_train=1.136518 (no previous merge yet)
[S7] round=1 local utility u=0.042283 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7948685019463718, 'loss_val': 1.2643767079294452, 'psi': 0.40318149441600376}-{'f1_val': 0.14205682272909165, 'auprc': 0.7797348579388707, 'loss_val': 1.3035415971536972, 'psi': 0.3971280368130033}
[S8] START round=1 head_norm_before_train=1.170765 (no previous merge yet)
[S8] round=1 local utility u=0.224233 metrics={'f1_val': 0.416084496488008, 'auprc': 0.7807072950821856, 'loss_val': 1.3419268915173865, 'psi': 0.561933615925679}-{'f1_val': 0.2532223221691974, 'auprc': 0.9689517696541097, 'loss_val': 1.377953049291786, 'psi': 0.5395141011631623}
[S9] START round=1 head_norm_before_train=1.189357 (no previous merge yet)
[S9] round=1 local utility u=0.059478 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9918795206791313, 'loss_val': 1.2168143523146215, 'psi': 0.4815905825556502}-{'f1_val': 0.141397957139996, 'auprc': 0.985644653761739, 'loss_val': 1.3170656177861904, 'psi': 0.47909663578869327}
[S10] START round=1 head_norm_before_train=1.199946 (no previous merge yet)
[S10] round=1 local utility u=0.383382 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.5733237012709267, 'loss_val': 1.3359557127081592, 'psi': 0.312502463033405}-{'f1_val': 0.13862163754172394, 'auprc': 0.32652072072288607, 'loss_val': 1.3623113650598209, 'psi': 0.2137812708141888}
[S11] START round=1 head_norm_before_train=1.164494 (no previous merge yet)
[S11] round=1 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.9045599645187263, 'loss_val': 1.327138052557373, 'psi': 0.4460721958313569}-{'f1_val': 0.15615662111001477, 'auprc': 0.9464707587625765, 'loss_val': 1.361401361221608, 'psi': 0.47228227617103946}
[S13] START round=1 head_norm_before_train=1.104813 (no previous merge yet)
[S13] round=1 local utility u=0.225759 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5265023829983672, 'loss_val': 1.3505778544679874, 'psi': 0.29483241074557875}-{'f1_val': 0.1403857625770531, 'auprc': 0.38554296948349376, 'loss_val': 1.3792185753357764, 'psi': 0.2384486453396294}
[S14] START round=1 head_norm_before_train=1.122042 (no previous merge yet)
[S14] round=1 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.5353944548801555, 'loss_val': 1.343873472438618, 'psi': 0.29837249368168445}-{'f1_val': 0.255725362232068, 'auprc': 0.5365163879663727, 'loss_val': 1.3648966157826372, 'psi': 0.36804177252578985}
[S15] START round=1 head_norm_before_train=1.166070 (no previous merge yet)
[S15] round=1 local utility u=0.000000 metrics={'f1_val': 0.3174107285764589, 'auprc': 0.770813558578334, 'loss_val': 1.3217325652396996, 'psi': 0.49877186057720896}-{'f1_val': 0.3770882037652477, 'auprc': 0.7817602682351225, 'loss_val': 1.3516412117585017, 'psi': 0.5389570295531976}
[S16] START round=1 head_norm_before_train=1.220066 (no previous merge yet)
[S16] round=1 local utility u=0.021008 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7904927673320977, 'loss_val': 1.3054787331557407, 'psi': 0.400579577052361}-{'f1_val': 0.14063745019920318, 'auprc': 0.7850783030022467, 'loss_val': 1.3312503711924768, 'psi': 0.39841379132042065}
[S17] START round=1 head_norm_before_train=1.203059 (no previous merge yet)
[S17] round=1 local utility u=0.258089 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.4536702062788597, 'loss_val': 1.3502979806353608, 'psi': 0.2660374605019745}-{'f1_val': 0.14094896331738438, 'auprc': 0.2893339823938434, 'loss_val': 1.3734667155018272, 'psi': 0.200302970947968}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:37116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1783 reason=None
[S7] → sending delta(kind=head bytes=1783) to S14@127.0.0.1:37114
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] → sending delta(kind=head bytes=1794) to S15@127.0.0.1:37115
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:37105
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S2] → sending delta(kind=head bytes=1789) to S6@127.0.0.1:37107
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S10] → sending delta(kind=head bytes=1792) to S11@127.0.0.1:37112
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S13] → sending delta(kind=head bytes=1789) to S17@127.0.0.1:37117
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S16] → sending delta(kind=head bytes=1790) to S14@127.0.0.1:37114
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1785 reason=None
[S4] → sending delta(kind=head bytes=1785) to S14@127.0.0.1:37114
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S8] → sending delta(kind=head bytes=1791) to S10@127.0.0.1:37111
[S4] sending update (kind=head size=1785 to 1 peers)
[S16] sending update (kind=head size=1790 to 1 peers)
[S8] sending update (kind=head size=1791 to 1 peers)
[S13] sending update (kind=head size=1789 to 1 peers)
[S10] sending update (kind=head size=1792 to 1 peers)
[S2] sending update (kind=head size=1789 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1794 to 1 peers)
[S7] sending update (kind=head size=1783 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1798) from S5
[S16] cosine check vs S5: cos=-0.0079
[S16] DROPPED delta from S5 (cos=-0.0079 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1792) from S10
[S11] cosine check vs S10: cos=-0.0399
[S11] DROPPED delta from S10 (cos=-0.0399 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1789) from S2
[S6] cosine check vs S2: cos=-0.0483
[S6] DROPPED delta from S2 (cos=-0.0483 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1794) from S6
[S15] cosine check vs S6: cos=0.0931
[S14] RECEIVED delta(kind=head bytes=1790) from S16
[S14] cosine check vs S16: cos=-0.0163
[S14] DROPPED delta from S16 (cos=-0.0163 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1783) from S7
[S14] cosine check vs S7: cos=0.0116
[S5] RECEIVED delta(kind=head bytes=1801) from S9
[S5] cosine check vs S9: cos=-0.0320
[S5] DROPPED delta from S9 (cos=-0.0320 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1789) from S13
[S17] cosine check vs S13: cos=-0.0040
[S17] DROPPED delta from S13 (cos=-0.0040 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1785) from S4
[S14] cosine check vs S4: cos=-0.0464
[S14] DROPPED delta from S4 (cos=-0.0464 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1791) from S8
[S10] cosine check vs S8: cos=-0.0612
[S10] DROPPED delta from S8 (cos=-0.0612 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S17] → sending delta(kind=head bytes=1791) to S10@127.0.0.1:37111
[S17] sending update (kind=head size=1791 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1791) from S17
[S10] cosine check vs S17: cos=0.0083
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=1 metric=0.1404 head_norm=1.135613
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.098958e-01
[S14] stored merged vector for next round verification (round=1)
[S14] DEBUG after merge:  round=1 metric=0.1404 head_norm=0.819318 delta_norm=0.809896
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=1 metric=0.1386 head_norm=1.212573
[S10] _apply_head_vector_avg (torch): Δ‖w‖=8.534267e-01
[S10] stored merged vector for next round verification (round=1)
[S10] DEBUG after merge:  round=1 metric=0.1386 head_norm=0.860575 delta_norm=0.853427
[S10] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=1 metric=0.3174 head_norm=1.181537
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.931832e-01
[S15] stored merged vector for next round verification (round=1)
[S15] DEBUG after merge:  round=1 metric=0.1397 head_norm=0.870813 delta_norm=0.793183
[S15] aggregate: ROLLBACK (f1_val pre=0.317 post=0.140 tol_abs=0.005 tol_rel=0.0)
[S2] START round=2 head_norm_before_train=1.190915 (no previous merge yet)
[S2] round=2 local utility u=0.031607 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7632776519706094, 'loss_val': 1.2989631408014048, 'psi': 0.3903773408213838}-{'f1_val': 0.1417771333885667, 'auprc': 0.756069699279001, 'loss_val': 1.3405535173346312, 'psi': 0.3874941597447405}
[S3] START round=2 head_norm_before_train=1.204044 (no previous merge yet)
[S3] round=2 local utility u=0.028322 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.6139169048866572, 'loss_val': 1.2048956397814943, 'psi': 0.3294708013231271}-{'f1_val': 0.13984006561410703, 'auprc': 0.619643116064609, 'loss_val': 1.2787181410516346, 'psi': 0.33176128579430786}
[S4] START round=2 head_norm_before_train=1.155119 (no previous merge yet)
[S4] round=2 local utility u=0.293880 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7810171371831857, 'loss_val': 1.2780541223354185, 'psi': 0.3965428322103848}-{'f1_val': 0.14022662889518414, 'auprc': 0.5958425033671111, 'loss_val': 1.3102909678539318, 'psi': 0.3224729786839549}
[S5] START round=2 head_norm_before_train=1.188687 (no previous merge yet)
[S5] round=2 local utility u=0.033915 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7709631993700836, 'loss_val': 1.1889345597284646, 'psi': 0.39374242260517633}-{'f1_val': 0.14226190476190476, 'auprc': 0.769856930058823, 'loss_val': 1.2534467499151252, 'psi': 0.3932999148806721}
[S6] START round=2 head_norm_before_train=1.174258 (no previous merge yet)
[S6] round=2 local utility u=0.017610 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6353792232971518, 'loss_val': 1.2871050249631617, 'psi': 0.33900745854962994}-{'f1_val': 0.14142628205128205, 'auprc': 0.6335147017807317, 'loss_val': 1.316732392461481, 'psi': 0.3382616499430619}
[S7] START round=2 head_norm_before_train=1.168251 (no previous merge yet)
[S7] round=2 local utility u=0.015709 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7951252356846903, 'loss_val': 1.2337292639850979, 'psi': 0.40328418791133114}-{'f1_val': 0.14205682272909165, 'auprc': 0.7948685019463718, 'loss_val': 1.2643767079294452, 'psi': 0.40318149441600376}
[S8] START round=2 head_norm_before_train=1.182601 (no previous merge yet)
[S8] round=2 local utility u=0.000000 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7744331530302246, 'loss_val': 1.3031729950341633, 'psi': 0.3937468506478642}-{'f1_val': 0.416084496488008, 'auprc': 0.7807072950821856, 'loss_val': 1.3419268915173865, 'psi': 0.561933615925679}
[S9] START round=2 head_norm_before_train=1.228715 (no previous merge yet)
[S9] round=2 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8075897098108435, 'loss_val': 1.101213407089937, 'psi': 0.4078746582083351}-{'f1_val': 0.141397957139996, 'auprc': 0.9918795206791313, 'loss_val': 1.2168143523146215, 'psi': 0.4815905825556502}
[S10] START round=2 head_norm_before_train=0.860575 cos_to_last_merge=1.0000 (last merge round=1)
[S10] round=2 local utility u=0.031641 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.5928715287726521, 'loss_val': 1.3313171208269043, 'psi': 0.3203215940340952}-{'f1_val': 0.13862163754172394, 'auprc': 0.5733237012709267, 'loss_val': 1.3359557127081592, 'psi': 0.312502463033405}
[S11] START round=2 head_norm_before_train=1.181557 (no previous merge yet)
[S11] round=2 local utility u=0.039876 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.916833724104772, 'loss_val': 1.2842068407638751, 'psi': 0.45098169966577517}-{'f1_val': 0.14041368337311058, 'auprc': 0.9045599645187263, 'loss_val': 1.327138052557373, 'psi': 0.4460721958313569}
[S13] START round=2 head_norm_before_train=1.112365 (no previous merge yet)
[S13] round=2 local utility u=0.036508 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5403793391518481, 'loss_val': 1.3191928279409013, 'psi': 0.3003831932069711}-{'f1_val': 0.1403857625770531, 'auprc': 0.5265023829983672, 'loss_val': 1.3505778544679874, 'psi': 0.29483241074557875}
[S14] START round=2 head_norm_before_train=0.819318 cos_to_last_merge=1.0000 (last merge round=1)
[S14] round=2 local utility u=0.410970 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8055885718397893, 'loss_val': 1.3325158061614997, 'psi': 0.40645014046553796}-{'f1_val': 0.14035785288270378, 'auprc': 0.5353944548801555, 'loss_val': 1.343873472438618, 'psi': 0.29837249368168445}
[S15] START round=2 head_norm_before_train=0.870813 cos_to_last_merge=1.0000 (last merge round=1)
[S15] round=2 local utility u=0.000000 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7708930026933812, 'loss_val': 1.3060786230477854, 'psi': 0.39219739189428754}-{'f1_val': 0.3174107285764589, 'auprc': 0.770813558578334, 'loss_val': 1.3217325652396996, 'psi': 0.49877186057720896}
[S16] START round=2 head_norm_before_train=1.236220 (no previous merge yet)
[S16] round=2 local utility u=0.007619 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7854811239046937, 'loss_val': 1.2752063249836136, 'psi': 0.39857491968139946}-{'f1_val': 0.14063745019920318, 'auprc': 0.7904927673320977, 'loss_val': 1.3054787331557407, 'psi': 0.400579577052361}
[S17] START round=2 head_norm_before_train=1.211413 (no previous merge yet)
[S17] round=2 local utility u=0.075066 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.4946394415992472, 'loss_val': 1.3230732155665192, 'psi': 0.2824251546301295}-{'f1_val': 0.14094896331738438, 'auprc': 0.4536702062788597, 'loss_val': 1.3502979806353608, 'psi': 0.2660374605019745}
[S6] not sending this round → trigger blocked (psi=0.339)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S3] → sending delta(kind=head bytes=1792) to S11@127.0.0.1:37112
[S5] not sending this round → trigger blocked (psi=0.394)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] → sending delta(kind=head bytes=1793) to S4@127.0.0.1:37104
[S16] not sending this round → trigger blocked (psi=0.399)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:37110
[S7] not sending this round → trigger blocked (psi=0.403)
[S10] not sending this round → trigger blocked (psi=0.320)
[S4] not sending this round → trigger blocked (psi=0.397)
[S13] not sending this round → trigger blocked (psi=0.300)
[S2] not sending this round → trigger blocked (psi=0.390)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1793 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1792 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1800) from S14
[S9] cosine check vs S14: cos=0.0085
[S4] RECEIVED delta(kind=head bytes=1793) from S11
[S4] cosine check vs S11: cos=-0.0082
[S4] DROPPED delta from S11 (cos=-0.0082 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1792) from S3
[S11] cosine check vs S3: cos=-0.0208
[S11] DROPPED delta from S3 (cos=-0.0208 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.282)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=2 metric=0.1414 head_norm=1.273369
[S9] _apply_head_vector_avg (torch): Δ‖w‖=7.592016e-01
[S9] stored merged vector for next round verification (round=2)
[S9] DEBUG after merge:  round=2 metric=0.1414 head_norm=0.765161 delta_norm=0.759202
[S9] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=3 head_norm_before_train=1.211930 (no previous merge yet)
[S2] round=3 local utility u=0.034708 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.767185427436907, 'loss_val': 1.241271176060133, 'psi': 0.39194045100790287}-{'f1_val': 0.1417771333885667, 'auprc': 0.7632776519706094, 'loss_val': 1.2989631408014048, 'psi': 0.3903773408213838}
[S3] START round=3 head_norm_before_train=1.247561 (no previous merge yet)
[S3] round=3 local utility u=1.000000 metrics={'f1_val': 0.4224727193828194, 'auprc': 0.7950797313071123, 'loss_val': 1.0351181166555041, 'psi': 0.5715155241525365}-{'f1_val': 0.13984006561410703, 'auprc': 0.6139169048866572, 'loss_val': 1.2048956397814943, 'psi': 0.3294708013231271}
[S4] START round=3 head_norm_before_train=1.169302 (no previous merge yet)
[S4] round=3 local utility u=0.026284 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7845314590509163, 'loss_val': 1.23602889159303, 'psi': 0.397948560957477}-{'f1_val': 0.14022662889518414, 'auprc': 0.7810171371831857, 'loss_val': 1.2780541223354185, 'psi': 0.3965428322103848}
[S5] START round=3 head_norm_before_train=1.222102 (no previous merge yet)
[S5] round=3 local utility u=0.902175 metrics={'f1_val': 0.41694544507090897, 'auprc': 0.7778107938220189, 'loss_val': 1.05322948734277, 'psi': 0.561291584571353}-{'f1_val': 0.14226190476190476, 'auprc': 0.7709631993700836, 'loss_val': 1.1889345597284646, 'psi': 0.39374242260517633}
[S6] START round=3 head_norm_before_train=1.194328 (no previous merge yet)
[S6] round=3 local utility u=0.293234 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8189596514185131, 'loss_val': 1.251378946468638, 'psi': 0.4124396297981745}-{'f1_val': 0.14142628205128205, 'auprc': 0.6353792232971518, 'loss_val': 1.2871050249631617, 'psi': 0.33900745854962994}
[S7] START round=3 head_norm_before_train=1.187606 (no previous merge yet)
[S7] round=3 local utility u=0.029654 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7919873103757264, 'loss_val': 1.1650080636904177, 'psi': 0.4020290177877456}-{'f1_val': 0.14205682272909165, 'auprc': 0.7951252356846903, 'loss_val': 1.2337292639850979, 'psi': 0.40328418791133114}
[S8] START round=3 head_norm_before_train=1.204279 (no previous merge yet)
[S8] round=3 local utility u=0.008605 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7632345922327339, 'loss_val': 1.2523675330749011, 'psi': 0.3892674263288679}-{'f1_val': 0.13995598239295717, 'auprc': 0.7744331530302246, 'loss_val': 1.3031729950341633, 'psi': 0.3937468506478642}
[S9] START round=3 head_norm_before_train=0.765161 cos_to_last_merge=1.0000 (last merge round=2)
[S9] round=3 local utility u=0.000000 metrics={'f1_val': 0.18368240090081953, 'auprc': 0.6687098223375545, 'loss_val': 1.0206345369124143, 'psi': 0.3776933694755135}-{'f1_val': 0.141397957139996, 'auprc': 0.8075897098108435, 'loss_val': 1.101213407089937, 'psi': 0.4078746582083351}
[S10] START round=3 head_norm_before_train=0.881108 cos_to_last_merge=0.9974 (last merge round=1)
[S10] round=3 local utility u=0.033552 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6045553490368579, 'loss_val': 1.2992653392964495, 'psi': 0.32499512213977755}-{'f1_val': 0.13862163754172394, 'auprc': 0.5928715287726521, 'loss_val': 1.3313171208269043, 'psi': 0.3203215940340952}
[S11] START round=3 head_norm_before_train=1.205217 (no previous merge yet)
[S11] round=3 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.815758207543929, 'loss_val': 1.22172369255149, 'psi': 0.41055149304143795}-{'f1_val': 0.14041368337311058, 'auprc': 0.916833724104772, 'loss_val': 1.2842068407638751, 'psi': 0.45098169966577517}
[S13] START round=3 head_norm_before_train=1.130674 (no previous merge yet)
[S13] round=3 local utility u=0.061855 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.569386828842258, 'loss_val': 1.2825056193809785, 'psi': 0.3119861890831351}-{'f1_val': 0.1403857625770531, 'auprc': 0.5403793391518481, 'loss_val': 1.3191928279409013, 'psi': 0.3003831932069711}
[S14] START round=3 head_norm_before_train=0.838002 cos_to_last_merge=0.9971 (last merge round=1)
[S14] round=3 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7381236126677923, 'loss_val': 1.3132905567249566, 'psi': 0.37946415679673917}-{'f1_val': 0.14035785288270378, 'auprc': 0.8055885718397893, 'loss_val': 1.3325158061614997, 'psi': 0.40645014046553796}
[S15] START round=3 head_norm_before_train=0.894084 cos_to_last_merge=0.9970 (last merge round=1)
[S15] round=3 local utility u=0.022883 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7739589040931406, 'loss_val': 1.2695094852199496, 'psi': 0.39342375245419126}-{'f1_val': 0.13973365136155833, 'auprc': 0.7708930026933812, 'loss_val': 1.3060786230477854, 'psi': 0.39219739189428754}
[S16] START round=3 head_norm_before_train=1.259155 (no previous merge yet)
[S16] round=3 local utility u=0.013166 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7808673016081477, 'loss_val': 1.235033280123422, 'psi': 0.396729390762781}-{'f1_val': 0.14063745019920318, 'auprc': 0.7854811239046937, 'loss_val': 1.2752063249836136, 'psi': 0.39857491968139946}
[S17] START round=3 head_norm_before_train=1.228357 (no previous merge yet)
[S17] round=3 local utility u=0.129101 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5673441095393057, 'loss_val': 1.2829844926267746, 'psi': 0.3115070218061529}-{'f1_val': 0.14094896331738438, 'auprc': 0.4946394415992472, 'loss_val': 1.3230732155665192, 'psi': 0.2824251546301295}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:37117
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S4] → sending delta(kind=head bytes=1788) to S9@127.0.0.1:37110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S7] → sending delta(kind=head bytes=1791) to S10@127.0.0.1:37111
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:37110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S2] → sending delta(kind=head bytes=1789) to S8@127.0.0.1:37109
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S15] → sending delta(kind=head bytes=1790) to S16@127.0.0.1:37116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:37112
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S16] → sending delta(kind=head bytes=1788) to S8@127.0.0.1:37109
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S13] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:37116
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S10] → sending delta(kind=head bytes=1788) to S14@127.0.0.1:37114
[S3] not sending this round → trigger blocked (psi=0.572)
[S10] sending update (kind=head size=1788 to 1 peers)
[S13] sending update (kind=head size=1793 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1788 to 1 peers)
[S15] sending update (kind=head size=1790 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1789 to 1 peers)
[S7] sending update (kind=head size=1791 to 1 peers)
[S4] sending update (kind=head size=1788 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1793) from S13
[S16] cosine check vs S13: cos=-0.0154
[S16] DROPPED delta from S13 (cos=-0.0154 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1790) from S15
[S16] cosine check vs S15: cos=0.0699
[S11] RECEIVED delta(kind=head bytes=1800) from S6
[S11] cosine check vs S6: cos=-0.0194
[S11] DROPPED delta from S6 (cos=-0.0194 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1788) from S10
[S14] cosine check vs S10: cos=-0.0394
[S14] DROPPED delta from S10 (cos=-0.0394 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1791) from S7
[S10] cosine check vs S7: cos=-0.0781
[S10] DROPPED delta from S7 (cos=-0.0781 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1788) from S16
[S8] cosine check vs S16: cos=-0.0111
[S8] DROPPED delta from S16 (cos=-0.0111 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1799) from S8
[S17] cosine check vs S8: cos=-0.0005
[S17] DROPPED delta from S8 (cos=-0.0005 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1789) from S2
[S8] cosine check vs S2: cos=-0.0126
[S8] DROPPED delta from S2 (cos=-0.0126 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1801) from S5
[S9] cosine check vs S5: cos=0.0044
[S9] RECEIVED delta(kind=head bytes=1788) from S4
[S9] cosine check vs S4: cos=0.0387
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:37110
[S17] sending update (kind=head size=1794 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1794) from S17
[S9] cosine check vs S17: cos=-0.0909
[S9] DROPPED delta from S17 (cos=-0.0909 < 0.0)
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=3 metric=0.1837 head_norm=0.830445
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.989273e-01
[S9] stored merged vector for next round verification (round=3)
[S9] DEBUG after merge:  round=3 metric=0.4158 head_norm=0.616583 delta_norm=0.598927
[S9] aggregate: ACCEPT kept=['S5', 'S4'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=3 metric=0.1406 head_norm=1.287545
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.657148e-01
[S16] stored merged vector for next round verification (round=3)
[S16] DEBUG after merge:  round=3 metric=0.1406 head_norm=0.818241 delta_norm=0.765715
[S16] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=1.241136 (no previous merge yet)
[S2] round=4 local utility u=0.006035 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7508290886757609, 'loss_val': 1.180132793979959, 'psi': 0.38539791550344443}-{'f1_val': 0.1417771333885667, 'auprc': 0.767185427436907, 'loss_val': 1.241271176060133, 'psi': 0.39194045100790287}
[S3] START round=4 head_norm_before_train=1.298301 (no previous merge yet)
[S3] round=4 local utility u=0.242359 metrics={'f1_val': 0.4562881870319486, 'auprc': 0.7961487064240086, 'loss_val': 0.7565000243037505, 'psi': 0.5922323947887727}-{'f1_val': 0.4224727193828194, 'auprc': 0.7950797313071123, 'loss_val': 1.0351181166555041, 'psi': 0.5715155241525365}
[S4] START round=4 head_norm_before_train=1.192816 (no previous merge yet)
[S4] round=4 local utility u=0.028494 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.784809054901842, 'loss_val': 1.1798730806196682, 'psi': 0.39805959929784734}-{'f1_val': 0.14022662889518414, 'auprc': 0.7845314590509163, 'loss_val': 1.23602889159303, 'psi': 0.397948560957477}
[S5] START round=4 head_norm_before_train=1.262294 (no previous merge yet)
[S5] round=4 local utility u=0.094278 metrics={'f1_val': 0.4176671856330787, 'auprc': 0.7776196225008646, 'loss_val': 0.8684294804338804, 'psi': 0.561648160380193}-{'f1_val': 0.41694544507090897, 'auprc': 0.7778107938220189, 'loss_val': 1.05322948734277, 'psi': 0.561291584571353}
[S6] START round=4 head_norm_before_train=1.219447 (no previous merge yet)
[S6] round=4 local utility u=0.047883 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8329431518397264, 'loss_val': 1.1975626510482087, 'psi': 0.4180330299666598}-{'f1_val': 0.14142628205128205, 'auprc': 0.8189596514185131, 'loss_val': 1.251378946468638, 'psi': 0.4124396297981745}
[S7] START round=4 head_norm_before_train=1.216975 (no previous merge yet)
[S7] round=4 local utility u=0.921945 metrics={'f1_val': 0.4170778520170104, 'auprc': 0.7866546680756006, 'loss_val': 0.9552454790967856, 'psi': 0.5649085784404465}-{'f1_val': 0.14205682272909165, 'auprc': 0.7919873103757264, 'loss_val': 1.1650080636904177, 'psi': 0.4020290177877456}
[S8] START round=4 head_norm_before_train=1.234201 (no previous merge yet)
[S8] round=4 local utility u=0.041099 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7697602597281334, 'loss_val': 1.1897460936427322, 'psi': 0.3918776933270277}-{'f1_val': 0.13995598239295717, 'auprc': 0.7632345922327339, 'loss_val': 1.2523675330749011, 'psi': 0.3892674263288679}
[S9] START round=4 head_norm_before_train=0.616583 cos_to_last_merge=1.0000 (last merge round=3)
[S9] round=4 local utility u=0.865201 metrics={'f1_val': 0.3827334590044307, 'auprc': 0.8030576944530103, 'loss_val': 0.8875828522401263, 'psi': 0.5508631531838626}-{'f1_val': 0.18368240090081953, 'auprc': 0.6687098223375545, 'loss_val': 1.0206345369124143, 'psi': 0.3776933694755135}
[S10] START round=4 head_norm_before_train=0.910609 cos_to_last_merge=0.9905 (last merge round=1)
[S10] round=4 local utility u=0.076017 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.639855060844415, 'loss_val': 1.2531312867704418, 'psi': 0.3391150068628004}-{'f1_val': 0.13862163754172394, 'auprc': 0.6045553490368579, 'loss_val': 1.2992653392964495, 'psi': 0.32499512213977755}
[S11] START round=4 head_norm_before_train=1.236940 (no previous merge yet)
[S11] round=4 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7672805597096167, 'loss_val': 1.1653738889405467, 'psi': 0.39116043390771305}-{'f1_val': 0.14041368337311058, 'auprc': 0.815758207543929, 'loss_val': 1.22172369255149, 'psi': 0.41055149304143795}
[S13] START round=4 head_norm_before_train=1.157296 (no previous merge yet)
[S13] round=4 local utility u=0.046612 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5863953207463442, 'loss_val': 1.2403070464048482, 'psi': 0.3187895858447695}-{'f1_val': 0.1403857625770531, 'auprc': 0.569386828842258, 'loss_val': 1.2825056193809785, 'psi': 0.3119861890831351}
[S14] START round=4 head_norm_before_train=0.864066 cos_to_last_merge=0.9896 (last merge round=1)
[S14] round=4 local utility u=0.054730 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7667871247434187, 'loss_val': 1.2898220138097172, 'psi': 0.3909295616269898}-{'f1_val': 0.14035785288270378, 'auprc': 0.7381236126677923, 'loss_val': 1.3132905567249566, 'psi': 0.37946415679673917}
[S15] START round=4 head_norm_before_train=0.924068 cos_to_last_merge=0.9898 (last merge round=1)
[S15] round=4 local utility u=0.029710 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7763552586115138, 'loss_val': 1.2172786684795043, 'psi': 0.39438229426154053}-{'f1_val': 0.13973365136155833, 'auprc': 0.7739589040931406, 'loss_val': 1.2695094852199496, 'psi': 0.39342375245419126}
[S16] START round=4 head_norm_before_train=0.818241 cos_to_last_merge=1.0000 (last merge round=3)
[S16] round=4 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.5911086458453292, 'loss_val': 1.2292168652130058, 'psi': 0.32082592845765356}-{'f1_val': 0.14063745019920318, 'auprc': 0.7808673016081477, 'loss_val': 1.235033280123422, 'psi': 0.396729390762781}
[S17] START round=4 head_norm_before_train=1.254405 (no previous merge yet)
[S17] round=4 local utility u=0.046160 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5787376819687535, 'loss_val': 1.224844484086536, 'psi': 0.31606445077793205}-{'f1_val': 0.14094896331738438, 'auprc': 0.5673441095393057, 'loss_val': 1.2829844926267746, 'psi': 0.3115070218061529}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.562)
[S4] not sending this round → trigger blocked (psi=0.398)
[S8] not sending this round → trigger blocked (psi=0.392)
[S7] not sending this round → trigger blocked (psi=0.565)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S14] → sending delta(kind=head bytes=1791) to S4@127.0.0.1:37104
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:37104
[S2] not sending this round → trigger blocked (psi=0.385)
[S13] not sending this round → trigger blocked (psi=0.319)
[S6] not sending this round → trigger blocked (psi=0.418)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:37113
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.339)
[S15] not sending this round → trigger blocked (psi=0.394)
[S9] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1791 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1791) from S14
[S4] cosine check vs S14: cos=0.0331
[S13] RECEIVED delta(kind=head bytes=1798) from S9
[S13] cosine check vs S9: cos=-0.0584
[S13] DROPPED delta from S9 (cos=-0.0584 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1801) from S3
[S4] cosine check vs S3: cos=-0.0973
[S4] DROPPED delta from S3 (cos=-0.0973 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.316)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=4 metric=0.1402 head_norm=1.225680
[S4] _apply_head_vector_avg (torch): Δ‖w‖=7.470286e-01
[S4] stored merged vector for next round verification (round=4)
[S4] DEBUG after merge:  round=4 metric=0.1402 head_norm=0.770999 delta_norm=0.747029
[S4] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=5 head_norm_before_train=1.272254 (no previous merge yet)
[S2] round=5 local utility u=0.663050 metrics={'f1_val': 0.355326097098249, 'auprc': 0.7409703305285795, 'loss_val': 1.1057508553508988, 'psi': 0.5095837904703813}-{'f1_val': 0.1417771333885667, 'auprc': 0.7508290886757609, 'loss_val': 1.180132793979959, 'psi': 0.38539791550344443}
[S3] START round=5 head_norm_before_train=1.358838 (no previous merge yet)
[S3] round=5 local utility u=0.056537 metrics={'f1_val': 0.40660015348722156, 'auprc': 0.8933892806498928, 'loss_val': 0.6370195411513706, 'psi': 0.60131580435229}-{'f1_val': 0.4562881870319486, 'auprc': 0.7961487064240086, 'loss_val': 0.7565000243037505, 'psi': 0.5922323947887727}
[S4] START round=5 head_norm_before_train=0.770999 cos_to_last_merge=1.0000 (last merge round=4)
[S4] round=5 local utility u=0.000000 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7863262221171656, 'loss_val': 1.184873496474095, 'psi': 0.3986664661839768}-{'f1_val': 0.14022662889518414, 'auprc': 0.784809054901842, 'loss_val': 1.1798730806196682, 'psi': 0.39805959929784734}
[S5] START round=5 head_norm_before_train=1.313095 (no previous merge yet)
[S5] round=5 local utility u=0.080566 metrics={'f1_val': 0.4175465518408786, 'auprc': 0.778532232954351, 'loss_val': 0.7093117082681957, 'psi': 0.5619408242862676}-{'f1_val': 0.4176671856330787, 'auprc': 0.7776196225008646, 'loss_val': 0.8684294804338804, 'psi': 0.561648160380193}
[S6] START round=5 head_norm_before_train=1.246155 (no previous merge yet)
[S6] round=5 local utility u=0.563049 metrics={'f1_val': 0.31191672614321386, 'auprc': 0.8338148082379753, 'loss_val': 1.0970232032357166, 'psi': 0.5206759589811185}-{'f1_val': 0.14142628205128205, 'auprc': 0.8329431518397264, 'loss_val': 1.1975626510482087, 'psi': 0.4180330299666598}
[S7] START round=5 head_norm_before_train=1.271948 (no previous merge yet)
[S7] round=5 local utility u=0.839862 metrics={'f1_val': 0.670688695016859, 'auprc': 0.7839465943705142, 'loss_val': 0.7890619892602293, 'psi': 0.7159918547583211}-{'f1_val': 0.4170778520170104, 'auprc': 0.7866546680756006, 'loss_val': 0.9552454790967856, 'psi': 0.5649085784404465}
[S8] START round=5 head_norm_before_train=1.267494 (no previous merge yet)
[S8] round=5 local utility u=0.273289 metrics={'f1_val': 0.20869263051210812, 'auprc': 0.784985821071839, 'loss_val': 1.1012646546688851, 'psi': 0.4392099067360005}-{'f1_val': 0.13995598239295717, 'auprc': 0.7697602597281334, 'loss_val': 1.1897460936427322, 'psi': 0.3918776933270277}
[S9] START round=5 head_norm_before_train=0.692969 cos_to_last_merge=0.9742 (last merge round=3)
[S9] round=5 local utility u=1.000000 metrics={'f1_val': 0.6933556213753069, 'auprc': 0.8982372061895725, 'loss_val': 0.661172401814925, 'psi': 0.7753082553010131}-{'f1_val': 0.3827334590044307, 'auprc': 0.8030576944530103, 'loss_val': 0.8875828522401263, 'psi': 0.5508631531838626}
[S10] START round=5 head_norm_before_train=0.946740 cos_to_last_merge=0.9811 (last merge round=1)
[S10] round=5 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6168588191261813, 'loss_val': 1.185598138777635, 'psi': 0.32991651017550694}-{'f1_val': 0.13862163754172394, 'auprc': 0.639855060844415, 'loss_val': 1.2531312867704418, 'psi': 0.3391150068628004}
[S11] START round=5 head_norm_before_train=1.274520 (no previous merge yet)
[S11] round=5 local utility u=0.907296 metrics={'f1_val': 0.4225625868721864, 'auprc': 0.7685705299002847, 'loss_val': 1.0475445882802183, 'psi': 0.5609657640834258}-{'f1_val': 0.14041368337311058, 'auprc': 0.7672805597096167, 'loss_val': 1.1653738889405467, 'psi': 0.39116043390771305}
[S13] START round=5 head_norm_before_train=1.193196 (no previous merge yet)
[S13] round=5 local utility u=0.033416 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5957915037921901, 'loss_val': 1.201663165467143, 'psi': 0.3225480590631079}-{'f1_val': 0.1403857625770531, 'auprc': 0.5863953207463442, 'loss_val': 1.2403070464048482, 'psi': 0.3187895858447695}
[S14] START round=5 head_norm_before_train=0.895931 cos_to_last_merge=0.9800 (last merge round=1)
[S14] round=5 local utility u=0.120768 metrics={'f1_val': 0.14473144731447316, 'auprc': 0.8261332184284098, 'loss_val': 1.2525663007126415, 'psi': 0.4172921557600478}-{'f1_val': 0.14035785288270378, 'auprc': 0.7667871247434187, 'loss_val': 1.2898220138097172, 'psi': 0.3909295616269898}
[S15] START round=5 head_norm_before_train=0.957363 cos_to_last_merge=0.9805 (last merge round=1)
[S15] round=5 local utility u=0.589712 metrics={'f1_val': 0.3235165864796528, 'auprc': 0.7766275283185463, 'loss_val': 1.1413687231194019, 'psi': 0.5047609632152102}-{'f1_val': 0.13973365136155833, 'auprc': 0.7763552586115138, 'loss_val': 1.2172786684795043, 'psi': 0.39438229426154053}
[S16] START round=5 head_norm_before_train=0.849828 cos_to_last_merge=0.9971 (last merge round=3)
[S16] round=5 local utility u=0.227571 metrics={'f1_val': 0.2315725811901126, 'auprc': 0.534179088203897, 'loss_val': 1.1488967463320774, 'psi': 0.3526151839956264}-{'f1_val': 0.14063745019920318, 'auprc': 0.5911086458453292, 'loss_val': 1.2292168652130058, 'psi': 0.32082592845765356}
[S17] START round=5 head_norm_before_train=1.284603 (no previous merge yet)
[S17] round=5 local utility u=0.801934 metrics={'f1_val': 0.3898887704248223, 'auprc': 0.5764921691394369, 'loss_val': 1.1078791029663864, 'psi': 0.4645301299106681}-{'f1_val': 0.14094896331738438, 'auprc': 0.5787376819687535, 'loss_val': 1.224844484086536, 'psi': 0.31606445077793205}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:37117
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:37114
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S7] → sending delta(kind=head bytes=1791) to S10@127.0.0.1:37111
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:37116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:37116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:37112
[S14] not sending this round → trigger blocked (psi=0.417)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] → sending delta(kind=head bytes=1793) to S8@127.0.0.1:37109
[S9] not sending this round → trigger blocked (psi=0.775)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S2] → sending delta(kind=head bytes=1790) to S8@127.0.0.1:37109
[S3] not sending this round → trigger blocked (psi=0.601)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:37110
[S2] sending update (kind=head size=1790 to 1 peers)
[S16] sending update (kind=head size=1793 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1791 to 1 peers)
[S5] sending update (kind=head size=1804 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1797) from S13
[S16] cosine check vs S13: cos=0.0800
[S16] RECEIVED delta(kind=head bytes=1797) from S15
[S16] cosine check vs S15: cos=0.5699
[S9] RECEIVED delta(kind=head bytes=1804) from S5
[S9] cosine check vs S5: cos=0.3870
[S11] RECEIVED delta(kind=head bytes=1798) from S6
[S11] cosine check vs S6: cos=-0.0035
[S11] DROPPED delta from S6 (cos=-0.0035 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1798) from S8
[S17] cosine check vs S8: cos=-0.0033
[S17] DROPPED delta from S8 (cos=-0.0033 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1791) from S7
[S10] cosine check vs S7: cos=-0.0641
[S10] DROPPED delta from S7 (cos=-0.0641 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1802) from S11
[S14] cosine check vs S11: cos=-0.0013
[S14] DROPPED delta from S11 (cos=-0.0013 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1790) from S2
[S8] cosine check vs S2: cos=-0.0107
[S8] DROPPED delta from S2 (cos=-0.0107 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1793) from S16
[S8] cosine check vs S16: cos=-0.0110
[S8] DROPPED delta from S16 (cos=-0.0110 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:37110
[S17] sending update (kind=head size=1797 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1797) from S17
[S9] cosine check vs S17: cos=-0.0070
[S9] DROPPED delta from S17 (cos=-0.0070 < 0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=5 metric=0.6934 head_norm=0.796409
[S9] _apply_head_vector_avg (torch): Δ‖w‖=6.488846e-01
[S9] stored merged vector for next round verification (round=5)
[S9] DEBUG after merge:  round=5 metric=0.7014 head_norm=0.919711 delta_norm=0.648885
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.671 → S13@127.0.0.1:37113
[S10] ⇄ pheromone p=0.379 → S14@127.0.0.1:37114
[S14] ⇄ pheromone p=0.403 → S4@127.0.0.1:37104
[S3] ⇄ pheromone p=0.509 → S4@127.0.0.1:37104
[S4] ⇄ pheromone p=0.397 → S9@127.0.0.1:37110
[S15] ⇄ pheromone p=0.453 → S16@127.0.0.1:37116
[S8] ⇄ pheromone p=0.408 → S17@127.0.0.1:37117
[S2] ⇄ pheromone p=0.477 → S8@127.0.0.1:37109
[S11] ⇄ pheromone p=0.513 → S14@127.0.0.1:37114
[S5] ⇄ pheromone p=0.480 → S9@127.0.0.1:37110
[S7] ⇄ pheromone p=0.652 → S10@127.0.0.1:37111
[S6] ⇄ pheromone p=0.503 → S11@127.0.0.1:37112
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=5 metric=0.2316 head_norm=0.885698
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.783431e-01
[S16] stored merged vector for next round verification (round=5)
[S16] DEBUG after merge:  round=5 metric=0.1406 head_norm=0.723150 delta_norm=0.478343
[S16] aggregate: ROLLBACK (f1_val pre=0.232 post=0.141 tol_abs=0.005 tol_rel=0.0)
[S16] ⇄ pheromone p=0.377 → S8@127.0.0.1:37109
[S13] ⇄ pheromone p=0.372 → S16@127.0.0.1:37116
[S17] ⇄ pheromone p=0.541 → S9@127.0.0.1:37110
[S2] START round=6 head_norm_before_train=1.297160 (no previous merge yet)
[S2] round=6 local utility u=0.249931 metrics={'f1_val': 0.4169384018324798, 'auprc': 0.7479886560290898, 'loss_val': 0.9966177363594185, 'psi': 0.5493585035111238}-{'f1_val': 0.355326097098249, 'auprc': 0.7409703305285795, 'loss_val': 1.1057508553508988, 'psi': 0.5095837904703813}
[S3] START round=6 head_norm_before_train=1.433497 (no previous merge yet)
[S3] round=6 local utility u=1.000000 metrics={'f1_val': 0.7008317350254774, 'auprc': 0.9955278633875316, 'loss_val': 0.4047105385832985, 'psi': 0.818710186370299}-{'f1_val': 0.40660015348722156, 'auprc': 0.8933892806498928, 'loss_val': 0.6370195411513706, 'psi': 0.60131580435229}
[S4] START round=6 head_norm_before_train=0.803962 cos_to_last_merge=0.9972 (last merge round=4)
[S4] round=6 local utility u=0.052626 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7869361341692954, 'loss_val': 1.0814511153067006, 'psi': 0.39891043100482865}-{'f1_val': 0.14022662889518414, 'auprc': 0.7863262221171656, 'loss_val': 1.184873496474095, 'psi': 0.3986664661839768}
[S5] START round=6 head_norm_before_train=1.378250 (no previous merge yet)
[S5] round=6 local utility u=0.034627 metrics={'f1_val': 0.41770670426636225, 'auprc': 0.7919411889846258, 'loss_val': 0.6812453937897148, 'psi': 0.5674004981536678}-{'f1_val': 0.4175465518408786, 'auprc': 0.778532232954351, 'loss_val': 0.7093117082681957, 'psi': 0.5619408242862676}
[S6] START round=6 head_norm_before_train=1.276310 (no previous merge yet)
[S6] round=6 local utility u=0.747599 metrics={'f1_val': 0.5022621226712357, 'auprc': 0.8832861565825036, 'loss_val': 0.8923120680669551, 'psi': 0.6546717362357428}-{'f1_val': 0.31191672614321386, 'auprc': 0.8338148082379753, 'loss_val': 1.0970232032357166, 'psi': 0.5206759589811185}
[S7] START round=6 head_norm_before_train=1.327713 (no previous merge yet)
[S7] round=6 local utility u=0.087823 metrics={'f1_val': 0.6704445976843084, 'auprc': 0.7861598383389878, 'loss_val': 0.6185915789971751, 'psi': 0.7167306939461802}-{'f1_val': 0.670688695016859, 'auprc': 0.7839465943705142, 'loss_val': 0.7890619892602293, 'psi': 0.7159918547583211}
[S8] START round=6 head_norm_before_train=1.296198 (no previous merge yet)
[S8] round=6 local utility u=1.000000 metrics={'f1_val': 0.7147473519913303, 'auprc': 0.7947496011300665, 'loss_val': 0.9599284585705008, 'psi': 0.7467482516468248}-{'f1_val': 0.20869263051210812, 'auprc': 0.784985821071839, 'loss_val': 1.1012646546688851, 'psi': 0.4392099067360005}
[S9] START round=6 head_norm_before_train=0.919711 cos_to_last_merge=1.0000 (last merge round=5)
[S9] round=6 local utility u=0.243274 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9992410747240538, 'loss_val': 0.5248024250952257, 'psi': 0.8204263783536326}-{'f1_val': 0.6933556213753069, 'auprc': 0.8982372061895725, 'loss_val': 0.661172401814925, 'psi': 0.7753082553010131}
[S10] START round=6 head_norm_before_train=0.988933 cos_to_last_merge=0.9705 (last merge round=1)
[S10] round=6 local utility u=0.953725 metrics={'f1_val': 0.4170518629654155, 'auprc': 0.6566788896098367, 'loss_val': 1.0681896638829702, 'psi': 0.512902673623184}-{'f1_val': 0.13862163754172394, 'auprc': 0.6168588191261813, 'loss_val': 1.185598138777635, 'psi': 0.32991651017550694}
[S11] START round=6 head_norm_before_train=1.307371 (no previous merge yet)
[S11] round=6 local utility u=0.327326 metrics={'f1_val': 0.39651855440916606, 'auprc': 0.9984443458953899, 'loss_val': 0.9262496683378721, 'psi': 0.6372888710036556}-{'f1_val': 0.4225625868721864, 'auprc': 0.7685705299002847, 'loss_val': 1.0475445882802183, 'psi': 0.5609657640834258}
[S13] START round=6 head_norm_before_train=1.224242 (no previous merge yet)
[S13] round=6 local utility u=0.815317 metrics={'f1_val': 0.41627458463323097, 'auprc': 0.5657868303886654, 'loss_val': 1.1363476107386874, 'psi': 0.4760794829354047}-{'f1_val': 0.1403857625770531, 'auprc': 0.5957915037921901, 'loss_val': 1.201663165467143, 'psi': 0.3225480590631079}
[S14] START round=6 head_norm_before_train=0.933532 cos_to_last_merge=0.9697 (last merge round=1)
[S14] round=6 local utility u=0.105794 metrics={'f1_val': 0.16733823180848542, 'auprc': 0.82892785318878, 'loss_val': 1.185003527514571, 'psi': 0.43197408036060325}-{'f1_val': 0.14473144731447316, 'auprc': 0.8261332184284098, 'loss_val': 1.2525663007126415, 'psi': 0.4172921557600478}
[S15] START round=6 head_norm_before_train=0.993486 cos_to_last_merge=0.9703 (last merge round=1)
[S15] round=6 local utility u=0.353812 metrics={'f1_val': 0.4170305028984703, 'auprc': 0.7766250712085032, 'loss_val': 0.9948207085742992, 'psi': 0.5608683302224835}-{'f1_val': 0.3235165864796528, 'auprc': 0.7766275283185463, 'loss_val': 1.1413687231194019, 'psi': 0.5047609632152102}
[S16] START round=6 head_norm_before_train=0.723150 cos_to_last_merge=1.0000 (last merge round=5)
[S16] round=6 local utility u=0.567458 metrics={'f1_val': 0.4158588189228392, 'auprc': 0.5272579549231314, 'loss_val': 1.098935157681796, 'psi': 0.4604184733229561}-{'f1_val': 0.2315725811901126, 'auprc': 0.534179088203897, 'loss_val': 1.1488967463320774, 'psi': 0.3526151839956264}
[S17] START round=6 head_norm_before_train=1.322578 (no previous merge yet)
[S17] round=6 local utility u=0.130527 metrics={'f1_val': 0.39210535432998117, 'auprc': 0.6097400435220196, 'loss_val': 0.9598687650979707, 'psi': 0.4791592300067965}-{'f1_val': 0.3898887704248223, 'auprc': 0.5764921691394369, 'loss_val': 1.1078791029663864, 'psi': 0.4645301299106681}
[S6] not sending this round → trigger blocked (psi=0.655)
[S7] not sending this round → trigger blocked (psi=0.717)
[S8] not sending this round → trigger blocked (psi=0.747)
[S16] not sending this round → trigger blocked (psi=0.460)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] → sending delta(kind=head bytes=1793) to S14@127.0.0.1:37114
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S9] → sending delta(kind=head bytes=1788) to S13@127.0.0.1:37113
[S5] not sending this round → trigger blocked (psi=0.567)
[S2] not sending this round → trigger blocked (psi=0.549)
[S13] not sending this round → trigger blocked (psi=0.476)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:37110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:37104
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S14] → sending delta(kind=head bytes=1788) to S4@127.0.0.1:37104
[S11] not sending this round → trigger blocked (psi=0.637)
[S15] not sending this round → trigger blocked (psi=0.561)
[S14] sending update (kind=head size=1788 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1788 to 1 peers)
[S10] sending update (kind=head size=1793 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1798) from S3
[S4] cosine check vs S3: cos=-0.1262
[S4] DROPPED delta from S3 (cos=-0.1262 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1793) from S10
[S14] cosine check vs S10: cos=-0.0351
[S14] DROPPED delta from S10 (cos=-0.0351 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1788) from S9
[S13] cosine check vs S9: cos=-0.0287
[S13] DROPPED delta from S9 (cos=-0.0287 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1797) from S4
[S9] cosine check vs S4: cos=0.2770
[S4] RECEIVED delta(kind=head bytes=1788) from S14
[S4] cosine check vs S14: cos=0.5416
[S17] not sending this round → trigger blocked (psi=0.479)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=6 metric=0.7012 head_norm=0.989432
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.528578e-01
[S9] stored merged vector for next round verification (round=6)
[S9] DEBUG after merge:  round=6 metric=0.7012 head_norm=0.731772 delta_norm=0.552858
[S9] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=6 metric=0.1402 head_norm=0.838635
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.389912e-01
[S4] stored merged vector for next round verification (round=6)
[S4] DEBUG after merge:  round=6 metric=0.1402 head_norm=0.797933 delta_norm=0.438991
[S4] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=7 head_norm_before_train=1.331825 (no previous merge yet)
[S2] round=7 local utility u=0.088540 metrics={'f1_val': 0.41698068739424143, 'auprc': 0.7672361719963774, 'loss_val': 0.87753366701923, 'psi': 0.5570828812350959}-{'f1_val': 0.4169384018324798, 'auprc': 0.7479886560290898, 'loss_val': 0.9966177363594185, 'psi': 0.5493585035111238}
[S3] START round=7 head_norm_before_train=1.503011 (no previous merge yet)
[S3] round=7 local utility u=0.000000 metrics={'f1_val': 0.6060757330096522, 'auprc': 0.9965720004240541, 'loss_val': 0.4793307637613931, 'psi': 0.762274239975413}-{'f1_val': 0.7008317350254774, 'auprc': 0.9955278633875316, 'loss_val': 0.4047105385832985, 'psi': 0.818710186370299}
[S4] START round=7 head_norm_before_train=0.797933 cos_to_last_merge=1.0000 (last merge round=6)
[S4] round=7 local utility u=0.629924 metrics={'f1_val': 0.41521773740003826, 'auprc': 0.6468537530631071, 'loss_val': 1.0513034956939784, 'psi': 0.5078721436652658}-{'f1_val': 0.14022662889518414, 'auprc': 0.7869361341692954, 'loss_val': 1.0814511153067006, 'psi': 0.39891043100482865}
[S5] START round=7 head_norm_before_train=1.433559 (no previous merge yet)
[S5] round=7 local utility u=0.767135 metrics={'f1_val': 0.7010644289311239, 'auprc': 0.6802614109145885, 'loss_val': 0.5120832082264498, 'psi': 0.6927432217245098}-{'f1_val': 0.41770670426636225, 'auprc': 0.7919411889846258, 'loss_val': 0.6812453937897148, 'psi': 0.5674004981536678}
[S6] START round=7 head_norm_before_train=1.316252 (no previous merge yet)
[S6] round=7 local utility u=0.000000 metrics={'f1_val': 0.4171750610705429, 'auprc': 0.7171456803237852, 'loss_val': 0.9007966551123997, 'psi': 0.5371633087718398}-{'f1_val': 0.5022621226712357, 'auprc': 0.8832861565825036, 'loss_val': 0.8923120680669551, 'psi': 0.6546717362357428}
[S7] START round=7 head_norm_before_train=1.377330 (no previous merge yet)
[S7] round=7 local utility u=0.156246 metrics={'f1_val': 0.6674321564712236, 'auprc': 0.8712387566916562, 'loss_val': 0.5432616756472338, 'psi': 0.7489547965593966}-{'f1_val': 0.6704445976843084, 'auprc': 0.7861598383389878, 'loss_val': 0.6185915789971751, 'psi': 0.7167306939461802}
[S8] START round=7 head_norm_before_train=1.333058 (no previous merge yet)
[S8] round=7 local utility u=0.000000 metrics={'f1_val': 0.3728657005221765, 'auprc': 0.7947474124329355, 'loss_val': 0.8085886530881599, 'psi': 0.5416183852864801}-{'f1_val': 0.7147473519913303, 'auprc': 0.7947496011300665, 'loss_val': 0.9599284585705008, 'psi': 0.7467482516468248}
[S9] START round=7 head_norm_before_train=0.731772 cos_to_last_merge=1.0000 (last merge round=6)
[S9] round=7 local utility u=0.043848 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9993596551712342, 'loss_val': 0.4374622399997632, 'psi': 0.8204738105325048}-{'f1_val': 0.7012165807733519, 'auprc': 0.9992410747240538, 'loss_val': 0.5248024250952257, 'psi': 0.8204263783536326}
[S10] START round=7 head_norm_before_train=1.032360 cos_to_last_merge=0.9602 (last merge round=1)
[S10] round=7 local utility u=0.025014 metrics={'f1_val': 0.3887209937328455, 'auprc': 0.6636206643120797, 'loss_val': 0.8690023395095768, 'psi': 0.4986808619645392}-{'f1_val': 0.4170518629654155, 'auprc': 0.6566788896098367, 'loss_val': 1.0681896638829702, 'psi': 0.512902673623184}
[S11] START round=7 head_norm_before_train=1.337221 (no previous merge yet)
[S11] round=7 local utility u=0.165060 metrics={'f1_val': 0.41469051256786066, 'auprc': 0.9988419433698117, 'loss_val': 0.7063539492433423, 'psi': 0.6483510848886411}-{'f1_val': 0.39651855440916606, 'auprc': 0.9984443458953899, 'loss_val': 0.9262496683378721, 'psi': 0.6372888710036556}
[S13] START round=7 head_norm_before_train=1.246716 (no previous merge yet)
[S13] round=7 local utility u=0.043120 metrics={'f1_val': 0.41662964849357986, 'auprc': 0.5570402876322323, 'loss_val': 1.0259980408625327, 'psi': 0.4727939041490409}-{'f1_val': 0.41627458463323097, 'auprc': 0.5657868303886654, 'loss_val': 1.1363476107386874, 'psi': 0.4760794829354047}
[S14] START round=7 head_norm_before_train=0.977502 cos_to_last_merge=0.9582 (last merge round=1)
[S14] round=7 local utility u=0.723669 metrics={'f1_val': 0.38613405706792664, 'auprc': 0.8290093107802119, 'loss_val': 1.0506840903113408, 'psi': 0.5632841585528408}-{'f1_val': 0.16733823180848542, 'auprc': 0.82892785318878, 'loss_val': 1.185003527514571, 'psi': 0.43197408036060325}
[S15] START round=7 head_norm_before_train=1.034010 cos_to_last_merge=0.9590 (last merge round=1)
[S15] round=7 local utility u=0.995640 metrics={'f1_val': 0.7146734288121154, 'auprc': 0.7771971107822658, 'loss_val': 0.7911152668601742, 'psi': 0.7396829016001756}-{'f1_val': 0.4170305028984703, 'auprc': 0.7766250712085032, 'loss_val': 0.9948207085742992, 'psi': 0.5608683302224835}
[S16] START round=7 head_norm_before_train=0.762101 cos_to_last_merge=0.9940 (last merge round=5)
[S16] round=7 local utility u=0.000000 metrics={'f1_val': 0.3841793844163214, 'auprc': 0.533135640882034, 'loss_val': 1.0404627167007026, 'psi': 0.44376188700260644}-{'f1_val': 0.4158588189228392, 'auprc': 0.5272579549231314, 'loss_val': 1.098935157681796, 'psi': 0.4604184733229561}
[S17] START round=7 head_norm_before_train=1.366297 (no previous merge yet)
[S17] round=7 local utility u=0.127253 metrics={'f1_val': 0.3530289445322021, 'auprc': 0.7784953043208926, 'loss_val': 0.9771694975856197, 'psi': 0.5232154884476783}-{'f1_val': 0.39210535432998117, 'auprc': 0.6097400435220196, 'loss_val': 0.9598687650979707, 'psi': 0.4791592300067965}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:37114
[S14] not sending this round → trigger blocked (psi=0.563)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S7] → sending delta(kind=head bytes=1793) to S10@127.0.0.1:37111
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] → sending delta(kind=head bytes=1794) to S16@127.0.0.1:37116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:37110
[S10] not sending this round → trigger blocked (psi=0.499)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:37109
[S4] not sending this round → trigger blocked (psi=0.508)
[S9] not sending this round → trigger blocked (psi=0.820)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] → sending delta(kind=head bytes=1794) to S16@127.0.0.1:37116
[S2] sending update (kind=head size=1794 to 1 peers)
[S13] sending update (kind=head size=1794 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1794 to 1 peers)
[S7] sending update (kind=head size=1793 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1794) from S15
[S16] cosine check vs S15: cos=0.6827
[S8] RECEIVED delta(kind=head bytes=1794) from S2
[S8] cosine check vs S2: cos=-0.0044
[S8] DROPPED delta from S2 (cos=-0.0044 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1802) from S5
[S9] cosine check vs S5: cos=0.5695
[S10] RECEIVED delta(kind=head bytes=1793) from S7
[S10] cosine check vs S7: cos=-0.0567
[S10] DROPPED delta from S7 (cos=-0.0567 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1794) from S13
[S16] cosine check vs S13: cos=0.4750
[S14] RECEIVED delta(kind=head bytes=1803) from S11
[S14] cosine check vs S11: cos=0.0066
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:37110
[S17] sending update (kind=head size=1804 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1804) from S17
[S9] cosine check vs S17: cos=0.0339
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=7 metric=0.3861 head_norm=1.029191
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.561769e-01
[S14] stored merged vector for next round verification (round=7)
[S14] DEBUG after merge:  round=7 metric=0.4167 head_norm=0.861610 delta_norm=0.856177
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=7 metric=0.7012 head_norm=0.832627
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.305629e-01
[S9] stored merged vector for next round verification (round=7)
[S9] DEBUG after merge:  round=7 metric=0.7012 head_norm=0.807406 delta_norm=0.530563
[S9] aggregate: ACCEPT kept=['S5', 'S17'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=7 metric=0.3842 head_norm=0.810254
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.012718e-01
[S16] stored merged vector for next round verification (round=7)
[S16] DEBUG after merge:  round=7 metric=0.4172 head_norm=0.796733 delta_norm=0.301272
[S16] aggregate: ACCEPT kept=['S15', 'S13'] (k=2/2) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=1.368970 (no previous merge yet)
[S2] round=8 local utility u=0.678424 metrics={'f1_val': 0.6090818747196174, 'auprc': 0.792149862551208, 'loss_val': 0.7480348408510294, 'psi': 0.6823090698522536}-{'f1_val': 0.41698068739424143, 'auprc': 0.7672361719963774, 'loss_val': 0.87753366701923, 'psi': 0.5570828812350959}
[S3] START round=8 head_norm_before_train=1.566816 (no previous merge yet)
[S3] round=8 local utility u=0.376931 metrics={'f1_val': 0.7005813959920884, 'auprc': 0.99978996573674, 'loss_val': 0.3021566500159208, 'psi': 0.820264823889949}-{'f1_val': 0.6060757330096522, 'auprc': 0.9965720004240541, 'loss_val': 0.4793307637613931, 'psi': 0.762274239975413}
[S4] START round=8 head_norm_before_train=0.828814 cos_to_last_merge=0.9950 (last merge round=6)
[S4] round=8 local utility u=0.056618 metrics={'f1_val': 0.4006731250876755, 'auprc': 0.6605044760751377, 'loss_val': 0.8917516815416193, 'psi': 0.5046056654826604}-{'f1_val': 0.41521773740003826, 'auprc': 0.6468537530631071, 'loss_val': 1.0513034956939784, 'psi': 0.5078721436652658}
[S5] START round=8 head_norm_before_train=1.478410 (no previous merge yet)
[S5] round=8 local utility u=0.152527 metrics={'f1_val': 0.7011046720655897, 'auprc': 0.7520009911286647, 'loss_val': 0.42248978766180345, 'psi': 0.7214631996908196}-{'f1_val': 0.7010644289311239, 'auprc': 0.6802614109145885, 'loss_val': 0.5120832082264498, 'psi': 0.6927432217245098}
[S6] START round=8 head_norm_before_train=1.352413 (no previous merge yet)
[S6] round=8 local utility u=0.961557 metrics={'f1_val': 0.575662123992616, 'auprc': 0.972085531070589, 'loss_val': 0.6934250488589557, 'psi': 0.7342314868238051}-{'f1_val': 0.4171750610705429, 'auprc': 0.7171456803237852, 'loss_val': 0.9007966551123997, 'psi': 0.5371633087718398}
[S7] START round=8 head_norm_before_train=1.416282 (no previous merge yet)
[S7] round=8 local utility u=0.000000 metrics={'f1_val': 0.5863348164564253, 'auprc': 0.7946593662350601, 'loss_val': 0.6814443803440089, 'psi': 0.6696646363678792}-{'f1_val': 0.6674321564712236, 'auprc': 0.8712387566916562, 'loss_val': 0.5432616756472338, 'psi': 0.7489547965593966}
[S8] START round=8 head_norm_before_train=1.380354 (no previous merge yet)
[S8] round=8 local utility u=0.172442 metrics={'f1_val': 0.3731322377369826, 'auprc': 0.8664529253346389, 'loss_val': 0.6804203850861891, 'psi': 0.5704605127760451}-{'f1_val': 0.3728657005221765, 'auprc': 0.7947474124329355, 'loss_val': 0.8085886530881599, 'psi': 0.5416183852864801}
[S9] START round=8 head_norm_before_train=0.807406 cos_to_last_merge=1.0000 (last merge round=7)
[S9] round=8 local utility u=0.001166 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9985301046922016, 'loss_val': 0.43264206149736373, 'psi': 0.8201419903408917}-{'f1_val': 0.7012165807733519, 'auprc': 0.9993596551712342, 'loss_val': 0.4374622399997632, 'psi': 0.8204738105325048}
[S10] START round=8 head_norm_before_train=1.074621 cos_to_last_merge=0.9497 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.950
[S10] round=8 local utility u=1.000000 metrics={'f1_val': 0.6963288360826954, 'auprc': 0.945436821192291, 'loss_val': 0.7077166902240805, 'psi': 0.7959720301265336}-{'f1_val': 0.3887209937328455, 'auprc': 0.6636206643120797, 'loss_val': 0.8690023395095768, 'psi': 0.4986808619645392}
[S11] START round=8 head_norm_before_train=1.375350 (no previous merge yet)
[S11] round=8 local utility u=0.000000 metrics={'f1_val': 0.40062503679542427, 'auprc': 0.9988100892111292, 'loss_val': 0.6334549889401879, 'psi': 0.6398990577617063}-{'f1_val': 0.41469051256786066, 'auprc': 0.9988419433698117, 'loss_val': 0.7063539492433423, 'psi': 0.6483510848886411}
[S13] START round=8 head_norm_before_train=1.276366 (no previous merge yet)
[S13] round=8 local utility u=0.221228 metrics={'f1_val': 0.416200286011302, 'auprc': 0.6552015978341286, 'loss_val': 0.875449554603216, 'psi': 0.5118008107404326}-{'f1_val': 0.41662964849357986, 'auprc': 0.5570402876322323, 'loss_val': 1.0259980408625327, 'psi': 0.4727939041490409}
[S14] START round=8 head_norm_before_train=0.861610 cos_to_last_merge=1.0000 (last merge round=7)
[S14] round=8 local utility u=0.142227 metrics={'f1_val': 0.41741759544700024, 'auprc': 0.83169983758758, 'loss_val': 0.9620023186656084, 'psi': 0.5831304923032321}-{'f1_val': 0.38613405706792664, 'auprc': 0.8290093107802119, 'loss_val': 1.0506840903113408, 'psi': 0.5632841585528408}
[S15] START round=8 head_norm_before_train=1.078944 cos_to_last_merge=0.9460 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.946
[S15] round=8 local utility u=0.031878 metrics={'f1_val': 0.696343153771286, 'auprc': 0.7878778758548537, 'loss_val': 0.649419315016568, 'psi': 0.7329570426047132}-{'f1_val': 0.7146734288121154, 'auprc': 0.7771971107822658, 'loss_val': 0.7911152668601742, 'psi': 0.7396829016001756}
[S16] START round=8 head_norm_before_train=0.796733 cos_to_last_merge=1.0000 (last merge round=7)
[S16] round=8 local utility u=0.119968 metrics={'f1_val': 0.42567341485572296, 'auprc': 0.5246104832796832, 'loss_val': 1.0239144915644152, 'psi': 0.46524824222530703}-{'f1_val': 0.3841793844163214, 'auprc': 0.533135640882034, 'loss_val': 1.0404627167007026, 'psi': 0.44376188700260644}
[S17] START round=8 head_norm_before_train=1.410485 (no previous merge yet)
[S17] round=8 local utility u=0.068627 metrics={'f1_val': 0.35554067573386017, 'auprc': 0.7746716699712186, 'loss_val': 0.8435147464749999, 'psi': 0.5231930734288035}-{'f1_val': 0.3530289445322021, 'auprc': 0.7784953043208926, 'loss_val': 0.9771694975856197, 'psi': 0.5232154884476783}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] → sending delta(kind=head bytes=1793) to S13@127.0.0.1:37113
[S13] not sending this round → trigger blocked (psi=0.512)
[S2] not sending this round → trigger blocked (psi=0.682)
[S15] not sending this round → trigger blocked (psi=0.733)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:37117
[S5] not sending this round → trigger blocked (psi=0.721)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:37112
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:37114
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:37104
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S4] → sending delta(kind=head bytes=1789) to S9@127.0.0.1:37110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:37104
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:37109
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1789 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1793 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1798) from S8
[S17] cosine check vs S8: cos=0.0002
[S4] RECEIVED delta(kind=head bytes=1797) from S14
[S4] cosine check vs S14: cos=0.5185
[S11] RECEIVED delta(kind=head bytes=1798) from S6
[S11] cosine check vs S6: cos=0.0136
[S14] RECEIVED delta(kind=head bytes=1798) from S10
[S14] cosine check vs S10: cos=-0.0221
[S14] DROPPED delta from S10 (cos=-0.0221 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1793) from S9
[S13] cosine check vs S9: cos=-0.0439
[S13] DROPPED delta from S9 (cos=-0.0439 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1800) from S16
[S8] cosine check vs S16: cos=0.0497
[S9] RECEIVED delta(kind=head bytes=1789) from S4
[S9] cosine check vs S4: cos=0.3734
[S4] RECEIVED delta(kind=head bytes=1797) from S3
[S4] cosine check vs S3: cos=-0.1255
[S4] DROPPED delta from S3 (cos=-0.1255 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.523)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=8 metric=0.4006 head_norm=1.416868
[S11] _apply_head_vector_avg (torch): Δ‖w‖=9.838859e-01
[S11] stored merged vector for next round verification (round=8)
[S11] DEBUG after merge:  round=8 metric=0.4084 head_norm=0.997362 delta_norm=0.983886
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=8 metric=0.4007 head_norm=0.876990
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.384384e-01
[S4] stored merged vector for next round verification (round=8)
[S4] DEBUG after merge:  round=8 metric=0.6580 head_norm=0.778223 delta_norm=0.438438
[S4] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=8 metric=0.7012 head_norm=0.890218
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.946210e-01
[S9] stored merged vector for next round verification (round=8)
[S9] DEBUG after merge:  round=8 metric=0.7012 head_norm=0.732222 delta_norm=0.494621
[S9] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=8 metric=0.3731 head_norm=1.428109
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.093977e-01
[S8] stored merged vector for next round verification (round=8)
[S8] DEBUG after merge:  round=8 metric=0.3731 head_norm=0.845272 delta_norm=0.809398
[S8] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=8 metric=0.3555 head_norm=1.445484
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.015871e+00
[S17] stored merged vector for next round verification (round=8)
[S17] DEBUG after merge:  round=8 metric=0.3568 head_norm=1.016103 delta_norm=1.015871
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=1.408629 (no previous merge yet)
[S2] round=9 local utility u=0.354132 metrics={'f1_val': 0.7009655639506255, 'auprc': 0.79306938633684, 'loss_val': 0.5938310133480788, 'psi': 0.7378070929051113}-{'f1_val': 0.6090818747196174, 'auprc': 0.792149862551208, 'loss_val': 0.7480348408510294, 'psi': 0.6823090698522536}
[S3] START round=9 head_norm_before_train=1.616311 (no previous merge yet)
[S3] round=9 local utility u=0.013347 metrics={'f1_val': 0.7006060025002057, 'auprc': 0.998544784786207, 'loss_val': 0.27187490072449416, 'psi': 0.8197815154146062}-{'f1_val': 0.7005813959920884, 'auprc': 0.99978996573674, 'loss_val': 0.3021566500159208, 'psi': 0.820264823889949}
[S4] START round=9 head_norm_before_train=0.778223 cos_to_last_merge=1.0000 (last merge round=8)
[S4] round=9 local utility u=0.793575 metrics={'f1_val': 0.6604806404938454, 'auprc': 0.6621911576107244, 'loss_val': 0.868507604636227, 'psi': 0.661164847340597}-{'f1_val': 0.4006731250876755, 'auprc': 0.6605044760751377, 'loss_val': 0.8917516815416193, 'psi': 0.5046056654826604}
[S5] START round=9 head_norm_before_train=1.526684 (no previous merge yet)
[S5] round=9 local utility u=0.000000 metrics={'f1_val': 0.7008168588441903, 'auprc': 0.7215693277897258, 'loss_val': 0.35862356280519936, 'psi': 0.7091178464224046}-{'f1_val': 0.7011046720655897, 'auprc': 0.7520009911286647, 'loss_val': 0.42248978766180345, 'psi': 0.7214631996908196}
[S6] START round=9 head_norm_before_train=1.384922 (no previous merge yet)
[S6] round=9 local utility u=0.000000 metrics={'f1_val': 0.46282604332595423, 'auprc': 0.7370578787578124, 'loss_val': 0.7614541335834687, 'psi': 0.5725187774986975}-{'f1_val': 0.575662123992616, 'auprc': 0.972085531070589, 'loss_val': 0.6934250488589557, 'psi': 0.7342314868238051}
[S7] START round=9 head_norm_before_train=1.450488 (no previous merge yet)
[S7] round=9 local utility u=0.000000 metrics={'f1_val': 0.5542631938248762, 'auprc': 0.7834373648105071, 'loss_val': 0.7536613976073068, 'psi': 0.6459328622191285}-{'f1_val': 0.5863348164564253, 'auprc': 0.7946593662350601, 'loss_val': 0.6814443803440089, 'psi': 0.6696646363678792}
[S8] START round=9 head_norm_before_train=0.845272 cos_to_last_merge=1.0000 (last merge round=8)
[S8] round=9 local utility u=0.179942 metrics={'f1_val': 0.3727983816295533, 'auprc': 0.9962719602728194, 'loss_val': 0.7079910678239087, 'psi': 0.6221878130868598}-{'f1_val': 0.3731322377369826, 'auprc': 0.8664529253346389, 'loss_val': 0.6804203850861891, 'psi': 0.5704605127760451}
[S9] START round=9 head_norm_before_train=0.732222 cos_to_last_merge=1.0000 (last merge round=8)
[S9] round=9 local utility u=0.650220 metrics={'f1_val': 0.9093388479347582, 'auprc': 0.9996147761590948, 'loss_val': 0.38418894874020426, 'psi': 0.9454492192244928}-{'f1_val': 0.7012165807733519, 'auprc': 0.9985301046922016, 'loss_val': 0.43264206149736373, 'psi': 0.8201419903408917}
[S10] START round=9 head_norm_before_train=1.120008 cos_to_last_merge=0.9371 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.937
[S10] round=9 local utility u=0.123919 metrics={'f1_val': 0.701696512414446, 'auprc': 0.9641752138479811, 'loss_val': 0.5483002258221509, 'psi': 0.8066879929878601}-{'f1_val': 0.6963288360826954, 'auprc': 0.945436821192291, 'loss_val': 0.7077166902240805, 'psi': 0.7959720301265336}
[S11] START round=9 head_norm_before_train=0.997362 cos_to_last_merge=1.0000 (last merge round=8)
[S11] round=9 local utility u=0.898761 metrics={'f1_val': 0.7018246587012323, 'auprc': 0.998581195721115, 'loss_val': 0.6424446261695648, 'psi': 0.8205272735091854}-{'f1_val': 0.40062503679542427, 'auprc': 0.9988100892111292, 'loss_val': 0.6334549889401879, 'psi': 0.6398990577617063}
[S13] START round=9 head_norm_before_train=1.308920 (no previous merge yet)
[S13] round=9 local utility u=0.132645 metrics={'f1_val': 0.4160038662657951, 'auprc': 0.722532898852608, 'loss_val': 0.8109744959293625, 'psi': 0.5386154793005202}-{'f1_val': 0.416200286011302, 'auprc': 0.6552015978341286, 'loss_val': 0.875449554603216, 'psi': 0.5118008107404326}
[S14] START round=9 head_norm_before_train=0.909180 cos_to_last_merge=0.9961 (last merge round=7)
[S14] round=9 local utility u=0.492756 metrics={'f1_val': 0.5516115819382839, 'auprc': 0.8299924811741298, 'loss_val': 0.7765316918660925, 'psi': 0.6629639416326223}-{'f1_val': 0.41741759544700024, 'auprc': 0.83169983758758, 'loss_val': 0.9620023186656084, 'psi': 0.5831304923032321}
[S15] START round=9 head_norm_before_train=1.133944 cos_to_last_merge=0.9292 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.929
[S15] round=9 local utility u=0.000000 metrics={'f1_val': 0.7015486852681293, 'auprc': 0.6450646123252577, 'loss_val': 0.5803569455998832, 'psi': 0.6789550560909807}-{'f1_val': 0.696343153771286, 'auprc': 0.7878778758548537, 'loss_val': 0.649419315016568, 'psi': 0.7329570426047132}
[S16] START round=9 head_norm_before_train=0.836496 cos_to_last_merge=0.9936 (last merge round=7)
[S16] round=9 local utility u=0.175094 metrics={'f1_val': 0.3851638894320231, 'auprc': 0.7112795866784687, 'loss_val': 0.9906760249575423, 'psi': 0.5156101683306014}-{'f1_val': 0.42567341485572296, 'auprc': 0.5246104832796832, 'loss_val': 1.0239144915644152, 'psi': 0.46524824222530703}
[S17] START round=9 head_norm_before_train=1.016103 cos_to_last_merge=1.0000 (last merge round=8)
[S17] round=9 local utility u=0.084466 metrics={'f1_val': 0.3650769230769231, 'auprc': 0.8200340171015266, 'loss_val': 0.8678873011396547, 'psi': 0.5470597606867644}-{'f1_val': 0.35554067573386017, 'auprc': 0.7746716699712186, 'loss_val': 0.8435147464749999, 'psi': 0.5231930734288035}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.663)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:37114
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S2] → sending delta(kind=head bytes=1791) to S8@127.0.0.1:37109
[S4] not sending this round → trigger blocked (psi=0.661)
[S9] not sending this round → trigger blocked (psi=0.945)
[S16] not sending this round → trigger blocked (psi=0.516)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.622)
[S3] not sending this round → trigger blocked (psi=0.820)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:37116
[S10] not sending this round → trigger blocked (psi=0.807)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1791 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1797) from S13
[S16] cosine check vs S13: cos=0.6262
[S8] RECEIVED delta(kind=head bytes=1791) from S2
[S8] cosine check vs S2: cos=-0.0138
[S8] DROPPED delta from S2 (cos=-0.0138 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1796) from S11
[S14] cosine check vs S11: cos=0.4955
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:37110
[S17] sending update (kind=head size=1800 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1800) from S17
[S9] cosine check vs S17: cos=0.1055
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=9 metric=0.5516 head_norm=0.968980
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.040504e-01
[S14] stored merged vector for next round verification (round=9)
[S14] DEBUG after merge:  round=9 metric=0.4147 head_norm=0.866648 delta_norm=0.504050
[S14] aggregate: ROLLBACK (f1_val pre=0.552 post=0.415 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=9 metric=0.9093 head_norm=0.826922
[S9] _apply_head_vector_avg (torch): Δ‖w‖=6.322966e-01
[S9] stored merged vector for next round verification (round=9)
[S9] DEBUG after merge:  round=9 metric=0.9875 head_norm=0.700873 delta_norm=0.632297
[S9] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=9 metric=0.3852 head_norm=0.885274
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.250520e-01
[S16] stored merged vector for next round verification (round=9)
[S16] DEBUG after merge:  round=9 metric=0.4136 head_norm=1.010826 delta_norm=0.525052
[S16] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=1.456151 (no previous merge yet)
[S2] round=10 local utility u=0.074379 metrics={'f1_val': 0.6994983163497444, 'auprc': 0.7984495490053387, 'loss_val': 0.45241054521972185, 'psi': 0.7390788094119821}-{'f1_val': 0.7009655639506255, 'auprc': 0.79306938633684, 'loss_val': 0.5938310133480788, 'psi': 0.7378070929051113}
[S3] START round=10 head_norm_before_train=1.661179 (no previous merge yet)
[S3] round=10 local utility u=0.004682 metrics={'f1_val': 0.7006060025002057, 'auprc': 0.9985723759566685, 'loss_val': 0.2625946318835895, 'psi': 0.8197925518827908}-{'f1_val': 0.7006060025002057, 'auprc': 0.998544784786207, 'loss_val': 0.27187490072449416, 'psi': 0.8197815154146062}
[S4] START round=10 head_norm_before_train=0.825254 cos_to_last_merge=0.9912 (last merge round=8)
[S4] round=10 local utility u=0.076520 metrics={'f1_val': 0.6639847316152407, 'auprc': 0.6608008105637799, 'loss_val': 0.7323218570000358, 'psi': 0.6627111631946565}-{'f1_val': 0.6604806404938454, 'auprc': 0.6621911576107244, 'loss_val': 0.868507604636227, 'psi': 0.661164847340597}
[S5] START round=10 head_norm_before_train=1.577593 (no previous merge yet)
[S5] round=10 local utility u=0.440121 metrics={'f1_val': 0.7011046720655897, 'auprc': 0.9950771111912584, 'loss_val': 0.300632454880797, 'psi': 0.8186936477158572}-{'f1_val': 0.7008168588441903, 'auprc': 0.7215693277897258, 'loss_val': 0.35862356280519936, 'psi': 0.7091178464224046}
[S6] START round=10 head_norm_before_train=1.413771 (no previous merge yet)
[S6] round=10 local utility u=1.000000 metrics={'f1_val': 0.710795000545887, 'auprc': 0.9750136835421997, 'loss_val': 0.4669875432946743, 'psi': 0.8164824737444121}-{'f1_val': 0.46282604332595423, 'auprc': 0.7370578787578124, 'loss_val': 0.7614541335834687, 'psi': 0.5725187774986975}
[S7] START round=10 head_norm_before_train=1.475781 (no previous merge yet)
[S7] round=10 local utility u=0.442207 metrics={'f1_val': 0.6651546416598052, 'auprc': 0.7978741678911013, 'loss_val': 0.5779065020543868, 'psi': 0.7182424521523236}-{'f1_val': 0.5542631938248762, 'auprc': 0.7834373648105071, 'loss_val': 0.7536613976073068, 'psi': 0.6459328622191285}
[S8] START round=10 head_norm_before_train=0.900630 cos_to_last_merge=0.9967 (last merge round=8)
[S8] round=10 local utility u=0.054247 metrics={'f1_val': 0.3729988868650071, 'auprc': 0.9942004308983439, 'loss_val': 0.5944850905730166, 'psi': 0.6214795044783418}-{'f1_val': 0.3727983816295533, 'auprc': 0.9962719602728194, 'loss_val': 0.7079910678239087, 'psi': 0.6221878130868598}
[S9] START round=10 head_norm_before_train=0.700873 cos_to_last_merge=1.0000 (last merge round=9)
[S9] round=10 local utility u=0.183417 metrics={'f1_val': 0.9888471887074294, 'auprc': 0.9930643038299669, 'loss_val': 0.47475372418513506, 'psi': 0.9905340347564444}-{'f1_val': 0.9093388479347582, 'auprc': 0.9996147761590948, 'loss_val': 0.38418894874020426, 'psi': 0.9454492192244928}
[S10] START round=10 head_norm_before_train=1.171712 cos_to_last_merge=0.9234 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.923
[S10] round=10 local utility u=0.079516 metrics={'f1_val': 0.7007673032853614, 'auprc': 0.9875191133650796, 'loss_val': 0.4537251723169169, 'psi': 0.8154680273172487}-{'f1_val': 0.701696512414446, 'auprc': 0.9641752138479811, 'loss_val': 0.5483002258221509, 'psi': 0.8066879929878601}
[S11] START round=10 head_norm_before_train=1.035070 cos_to_last_merge=0.9977 (last merge round=8)
[S11] round=10 local utility u=0.068286 metrics={'f1_val': 0.7021472986191651, 'auprc': 0.9976305624039692, 'loss_val': 0.5049559200955228, 'psi': 0.8203406041330867}-{'f1_val': 0.7018246587012323, 'auprc': 0.998581195721115, 'loss_val': 0.6424446261695648, 'psi': 0.8205272735091854}
[S13] START round=10 head_norm_before_train=1.345804 (no previous merge yet)
[S13] round=10 local utility u=0.898123 metrics={'f1_val': 0.6892013853472179, 'auprc': 0.7414773735916601, 'loss_val': 0.7107470504568357, 'psi': 0.7101117806449948}-{'f1_val': 0.4160038662657951, 'auprc': 0.722532898852608, 'loss_val': 0.8109744959293625, 'psi': 0.5386154793005202}
[S14] START round=10 head_norm_before_train=0.866648 cos_to_last_merge=1.0000 (last merge round=9)
[S14] round=10 local utility u=0.197278 metrics={'f1_val': 0.6073082203636111, 'auprc': 0.8450111143412985, 'loss_val': 0.7612107975893825, 'psi': 0.7023893779546861}-{'f1_val': 0.5516115819382839, 'auprc': 0.8299924811741298, 'loss_val': 0.7765316918660925, 'psi': 0.6629639416326223}
[S15] START round=10 head_norm_before_train=1.188607 cos_to_last_merge=0.9108 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.911
[S15] round=10 local utility u=0.022362 metrics={'f1_val': 0.7009621312698922, 'auprc': 0.6472731284759143, 'loss_val': 0.5387384036221319, 'psi': 0.679486530152301}-{'f1_val': 0.7015486852681293, 'auprc': 0.6450646123252577, 'loss_val': 0.5803569455998832, 'psi': 0.6789550560909807}
[S16] START round=10 head_norm_before_train=1.010826 cos_to_last_merge=1.0000 (last merge round=9)
[S16] round=10 local utility u=0.323767 metrics={'f1_val': 0.4684867408799825, 'auprc': 0.7573360577931257, 'loss_val': 0.981248991041773, 'psi': 0.5840264676452398}-{'f1_val': 0.3851638894320231, 'auprc': 0.7112795866784687, 'loss_val': 0.9906760249575423, 'psi': 0.5156101683306014}
[S17] START round=10 head_norm_before_train=1.047972 cos_to_last_merge=0.9966 (last merge round=8)
[S17] round=10 local utility u=0.050844 metrics={'f1_val': 0.3699605496648921, 'auprc': 0.8277461354909739, 'loss_val': 0.8186370458705204, 'psi': 0.5530747839953248}-{'f1_val': 0.3650769230769231, 'auprc': 0.8200340171015266, 'loss_val': 0.8678873011396547, 'psi': 0.5470597606867644}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:37116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:37110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:37114
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] → sending delta(kind=head bytes=1794) to S4@127.0.0.1:37104
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:37109
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:37104
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:37110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:37111
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:37113
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S16] → sending delta(kind=head bytes=1786) to S8@127.0.0.1:37109
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:37114
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S17@127.0.0.1:37117
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:37116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:37112
[S9] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1793 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S16] sending update (kind=head size=1786 to 1 peers)
[S2] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1794 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1795) from S2
[S8] cosine check vs S2: cos=-0.0108
[S8] DROPPED delta from S2 (cos=-0.0108 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1801) from S3
[S4] cosine check vs S3: cos=-0.1415
[S4] DROPPED delta from S3 (cos=-0.1415 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1793) from S8
[S17] cosine check vs S8: cos=0.5936
[S9] RECEIVED delta(kind=head bytes=1803) from S5
[S9] cosine check vs S5: cos=0.4486
[S9] RECEIVED delta(kind=head bytes=1799) from S4
[S9] cosine check vs S4: cos=0.3497
[S14] RECEIVED delta(kind=head bytes=1802) from S10
[S14] cosine check vs S10: cos=0.0610
[S16] RECEIVED delta(kind=head bytes=1799) from S13
[S16] cosine check vs S13: cos=0.9152
[S16] RECEIVED delta(kind=head bytes=1797) from S15
[S16] cosine check vs S15: cos=0.3602
[S11] RECEIVED delta(kind=head bytes=1798) from S6
[S11] cosine check vs S6: cos=0.6505
[S14] RECEIVED delta(kind=head bytes=1796) from S11
[S14] cosine check vs S11: cos=0.8407
[S13] RECEIVED delta(kind=head bytes=1796) from S9
[S13] cosine check vs S9: cos=-0.0487
[S13] DROPPED delta from S9 (cos=-0.0487 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1794) from S14
[S4] cosine check vs S14: cos=0.6441
[S10] RECEIVED delta(kind=head bytes=1798) from S7
[S10] cosine check vs S7: cos=-0.0512
[S10] DROPPED delta from S7 (cos=-0.0512 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1786) from S16
[S8] cosine check vs S16: cos=0.4488
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:37110
[S17] sending update (kind=head size=1801 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1801) from S17
[S9] cosine check vs S17: cos=0.7135
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=10 metric=0.6073 head_norm=0.909585
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.082696e-01
[S14] stored merged vector for next round verification (round=10)
[S14] DEBUG after merge:  round=10 metric=0.3834 head_norm=0.783759 delta_norm=0.408270
[S14] aggregate: ROLLBACK (f1_val pre=0.607 post=0.383 tol_abs=0.005 tol_rel=0.0)
[S14] ⇄ pheromone p=0.351 → S4@127.0.0.1:37104
[S3] ⇄ pheromone p=0.300 → S4@127.0.0.1:37104
[S2] ⇄ pheromone p=0.344 → S8@127.0.0.1:37109
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=10 metric=0.7021 head_norm=1.082514
[S11] _apply_head_vector_avg (torch): Δ‖w‖=5.518792e-01
[S11] stored merged vector for next round verification (round=10)
[S11] DEBUG after merge:  round=10 metric=0.7024 head_norm=1.148423 delta_norm=0.551879
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.369 → S14@127.0.0.1:37114
[S10] ⇄ pheromone p=0.369 → S14@127.0.0.1:37114
[S15] ⇄ pheromone p=0.288 → S16@127.0.0.1:37116
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=10 metric=0.6640 head_norm=0.890156
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.797178e-01
[S4] stored merged vector for next round verification (round=10)
[S4] DEBUG after merge:  round=10 metric=0.6707 head_norm=0.815889 delta_norm=0.379718
[S4] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.348 → S9@127.0.0.1:37110
[S7] ⇄ pheromone p=0.325 → S10@127.0.0.1:37111
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=10 metric=0.4685 head_norm=1.049214
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.499149e-01
[S16] stored merged vector for next round verification (round=10)
[S16] DEBUG after merge:  round=10 metric=0.5360 head_norm=0.978812 delta_norm=0.249915
[S16] aggregate: ACCEPT kept=['S13', 'S15'] (k=2/2) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.278 → S8@127.0.0.1:37109
[S13] ⇄ pheromone p=0.422 → S16@127.0.0.1:37116
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=10 metric=0.3730 head_norm=0.969998
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.310885e-01
[S8] stored merged vector for next round verification (round=10)
[S8] DEBUG after merge:  round=10 metric=0.3729 head_norm=0.859545 delta_norm=0.531088
[S8] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.277 → S17@127.0.0.1:37117
[S6] ⇄ pheromone p=0.549 → S11@127.0.0.1:37112
[S5] ⇄ pheromone p=0.346 → S9@127.0.0.1:37110
[S9] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=10 metric=0.9888 head_norm=0.782807
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.259712e-01
[S9] stored merged vector for next round verification (round=10)
[S9] DEBUG after merge:  round=10 metric=0.9888 head_norm=0.715767 delta_norm=0.225971
[S9] aggregate: ACCEPT kept=['S5', 'S4', 'S17'] (k=3/3) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.385 → S13@127.0.0.1:37113
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=10 metric=0.3700 head_norm=1.091648
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.678312e-01
[S17] stored merged vector for next round verification (round=10)
[S17] DEBUG after merge:  round=10 metric=0.3773 head_norm=0.920559 delta_norm=0.467831
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.233 → S9@127.0.0.1:37110
[S2] START round=11 head_norm_before_train=1.507493 (no previous merge yet)
[S2] round=11 local utility u=0.000000 metrics={'f1_val': 0.7018318238212289, 'auprc': 0.6996939019842554, 'loss_val': 0.3526180759615499, 'psi': 0.7009766550864396}-{'f1_val': 0.6994983163497444, 'auprc': 0.7984495490053387, 'loss_val': 0.45241054521972185, 'psi': 0.7390788094119821}
[S3] START round=11 head_norm_before_train=1.697271 (no previous merge yet)
[S3] round=11 local utility u=0.014384 metrics={'f1_val': 0.7006060025002057, 'auprc': 0.998446841944149, 'loss_val': 0.23345064290983608, 'psi': 0.819742338277783}-{'f1_val': 0.7006060025002057, 'auprc': 0.9985723759566685, 'loss_val': 0.2625946318835895, 'psi': 0.8197925518827908}
[S4] START round=11 head_norm_before_train=0.815889 cos_to_last_merge=1.0000 (last merge round=10)
[S4] round=11 local utility u=0.312449 metrics={'f1_val': 0.6710742834813297, 'auprc': 0.8587362549817797, 'loss_val': 0.7437665306152337, 'psi': 0.7461390720815098}-{'f1_val': 0.6639847316152407, 'auprc': 0.6608008105637799, 'loss_val': 0.7323218570000358, 'psi': 0.6627111631946565}
[S5] START round=11 head_norm_before_train=1.606283 (no previous merge yet)
[S5] round=11 local utility u=0.007060 metrics={'f1_val': 0.7008569501491988, 'auprc': 0.990046855437172, 'loss_val': 0.2699358565441467, 'psi': 0.8165329122643881}-{'f1_val': 0.7011046720655897, 'auprc': 0.9950771111912584, 'loss_val': 0.300632454880797, 'psi': 0.8186936477158572}
[S6] START round=11 head_norm_before_train=1.440504 (no previous merge yet)
[S6] round=11 local utility u=0.000000 metrics={'f1_val': 0.41572065481343023, 'auprc': 0.6319465392802495, 'loss_val': 0.8515216749293099, 'psi': 0.5022110086001579}-{'f1_val': 0.710795000545887, 'auprc': 0.9750136835421997, 'loss_val': 0.4669875432946743, 'psi': 0.8164824737444121}
[S7] START round=11 head_norm_before_train=1.499603 (no previous merge yet)
[S7] round=11 local utility u=0.000000 metrics={'f1_val': 0.5805242623272869, 'auprc': 0.7847497243193824, 'loss_val': 0.6868663107224187, 'psi': 0.6622144471241251}-{'f1_val': 0.6651546416598052, 'auprc': 0.7978741678911013, 'loss_val': 0.5779065020543868, 'psi': 0.7182424521523236}
[S8] START round=11 head_norm_before_train=0.859545 cos_to_last_merge=1.0000 (last merge round=10)
[S8] round=11 local utility u=1.000000 metrics={'f1_val': 0.7139521677339791, 'auprc': 0.9934896301069499, 'loss_val': 0.6225645473943033, 'psi': 0.8257671526831674}-{'f1_val': 0.3729988868650071, 'auprc': 0.9942004308983439, 'loss_val': 0.5944850905730166, 'psi': 0.6214795044783418}
[S9] START round=11 head_norm_before_train=0.715767 cos_to_last_merge=1.0000 (last merge round=10)
[S9] round=11 local utility u=0.000000 metrics={'f1_val': 0.9705041990198973, 'auprc': 0.9958106827965574, 'loss_val': 0.3980179065040949, 'psi': 0.9806267925305613}-{'f1_val': 0.9888471887074294, 'auprc': 0.9930643038299669, 'loss_val': 0.47475372418513506, 'psi': 0.9905340347564444}
[S10] START round=11 head_norm_before_train=1.214812 cos_to_last_merge=0.9124 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.912
[S10] round=11 local utility u=0.043001 metrics={'f1_val': 0.6937691541252426, 'auprc': 0.9960881626591783, 'loss_val': 0.35144206145138185, 'psi': 0.8146967575388169}-{'f1_val': 0.7007673032853614, 'auprc': 0.9875191133650796, 'loss_val': 0.4537251723169169, 'psi': 0.8154680273172487}
[S11] START round=11 head_norm_before_train=1.148423 cos_to_last_merge=1.0000 (last merge round=10)
[S11] round=11 local utility u=0.000000 metrics={'f1_val': 0.7019322376706589, 'auprc': 0.9978567145897782, 'loss_val': 0.5833556713424634, 'psi': 0.8203020284383067}-{'f1_val': 0.7021472986191651, 'auprc': 0.9976305624039692, 'loss_val': 0.5049559200955228, 'psi': 0.8203406041330867}
[S13] START round=11 head_norm_before_train=1.378516 (no previous merge yet)
[S13] round=11 local utility u=0.000000 metrics={'f1_val': 0.5919782920823647, 'auprc': 0.7591779698483164, 'loss_val': 0.6839151402305826, 'psi': 0.6588581631887453}-{'f1_val': 0.6892013853472179, 'auprc': 0.7414773735916601, 'loss_val': 0.7107470504568357, 'psi': 0.7101117806449948}
[S14] START round=11 head_norm_before_train=0.783759 cos_to_last_merge=1.0000 (last merge round=10)
[S14] round=11 local utility u=0.226918 metrics={'f1_val': 0.6098760574473228, 'auprc': 0.9917360593105867, 'loss_val': 0.7629560189306445, 'psi': 0.7626200581926283}-{'f1_val': 0.6073082203636111, 'auprc': 0.8450111143412985, 'loss_val': 0.7612107975893825, 'psi': 0.7023893779546861}
[S15] START round=11 head_norm_before_train=1.237048 cos_to_last_merge=0.8942 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.894
[S15] round=11 local utility u=0.274329 metrics={'f1_val': 0.7009621312698922, 'auprc': 0.793736080811193, 'loss_val': 0.4294694685909227, 'psi': 0.7380717110864126}-{'f1_val': 0.7009621312698922, 'auprc': 0.6472731284759143, 'loss_val': 0.5387384036221319, 'psi': 0.679486530152301}
[S16] START round=11 head_norm_before_train=0.978812 cos_to_last_merge=1.0000 (last merge round=10)
[S16] round=11 local utility u=0.000000 metrics={'f1_val': 0.5442217437843624, 'auprc': 0.5520474048375991, 'loss_val': 0.963338327672709, 'psi': 0.5473520082056571}-{'f1_val': 0.4684867408799825, 'auprc': 0.7573360577931257, 'loss_val': 0.981248991041773, 'psi': 0.5840264676452398}
[S17] START round=11 head_norm_before_train=0.920559 cos_to_last_merge=1.0000 (last merge round=10)
[S17] round=11 local utility u=0.000000 metrics={'f1_val': 0.36531747584155594, 'auprc': 0.8517087423446461, 'loss_val': 0.8751181879247294, 'psi': 0.5598739824427921}-{'f1_val': 0.3699605496648921, 'auprc': 0.8277461354909739, 'loss_val': 0.8186370458705204, 'psi': 0.5530747839953248}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:37110
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:37110
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:37104
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:37116
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:37104
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:37114
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S17@127.0.0.1:37117
[S3] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1794 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1804 to 1 peers)
[S8] sending update (kind=head size=1793 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1802) from S3
[S4] cosine check vs S3: cos=-0.1269
[S4] DROPPED delta from S3 (cos=-0.1269 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1794) from S4
[S9] cosine check vs S4: cos=0.3966
[S16] RECEIVED delta(kind=head bytes=1801) from S15
[S16] cosine check vs S15: cos=0.5345
[S9] RECEIVED delta(kind=head bytes=1804) from S5
[S9] cosine check vs S5: cos=0.6047
[S4] RECEIVED delta(kind=head bytes=1799) from S14
[S4] cosine check vs S14: cos=0.7503
[S17] RECEIVED delta(kind=head bytes=1793) from S8
[S17] cosine check vs S8: cos=0.6585
[S14] RECEIVED delta(kind=head bytes=1800) from S10
[S14] cosine check vs S10: cos=0.4394
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=11 metric=0.9705 head_norm=0.804382
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.534166e-01
[S9] stored merged vector for next round verification (round=11)
[S9] DEBUG after merge:  round=11 metric=0.9632 head_norm=0.812057 delta_norm=0.353417
[S9] aggregate: ROLLBACK (f1_val pre=0.971 post=0.963 tol_abs=0.005 tol_rel=0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=11 metric=0.6711 head_norm=0.866370
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.989579e-01
[S4] stored merged vector for next round verification (round=11)
[S4] DEBUG after merge:  round=11 metric=0.6781 head_norm=0.789670 delta_norm=0.298958
[S4] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=11 metric=0.6099 head_norm=0.821773
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.808506e-01
[S14] stored merged vector for next round verification (round=11)
[S14] DEBUG after merge:  round=11 metric=0.3855 head_norm=0.889727 delta_norm=0.580851
[S14] aggregate: ROLLBACK (f1_val pre=0.610 post=0.386 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=11 metric=0.5442 head_norm=1.019940
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.658329e-01
[S16] stored merged vector for next round verification (round=11)
[S16] DEBUG after merge:  round=11 metric=0.5444 head_norm=1.008486 delta_norm=0.565833
[S16] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=11 metric=0.3653 head_norm=0.960153
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.879589e-01
[S17] stored merged vector for next round verification (round=11)
[S17] DEBUG after merge:  round=11 metric=0.3669 head_norm=0.853752 delta_norm=0.387959
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.555347 (no previous merge yet)
[S2] round=12 local utility u=0.000000 metrics={'f1_val': 0.701391712864433, 'auprc': 0.6796098833018112, 'loss_val': 0.3174368629000646, 'psi': 0.6926789810393843}-{'f1_val': 0.7018318238212289, 'auprc': 0.6996939019842554, 'loss_val': 0.3526180759615499, 'psi': 0.7009766550864396}
[S3] START round=12 head_norm_before_train=1.726027 (no previous merge yet)
[S3] round=12 local utility u=0.013507 metrics={'f1_val': 0.7018768808926283, 'auprc': 0.9990687062292528, 'loss_val': 0.21592677250730247, 'psi': 0.8207536110272782}-{'f1_val': 0.7006060025002057, 'auprc': 0.998446841944149, 'loss_val': 0.23345064290983608, 'psi': 0.819742338277783}
[S4] START round=12 head_norm_before_train=0.789670 cos_to_last_merge=1.0000 (last merge round=11)
[S4] round=12 local utility u=0.000000 metrics={'f1_val': 0.6646706834426133, 'auprc': 0.8395381075053476, 'loss_val': 0.7859675220358329, 'psi': 0.734617653067707}-{'f1_val': 0.6710742834813297, 'auprc': 0.8587362549817797, 'loss_val': 0.7437665306152337, 'psi': 0.7461390720815098}
[S5] START round=12 head_norm_before_train=1.629759 (no previous merge yet)
[S5] round=12 local utility u=0.000000 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9369608850429918, 'loss_val': 0.3130026912486598, 'psi': 0.7951493896148013}-{'f1_val': 0.7008569501491988, 'auprc': 0.990046855437172, 'loss_val': 0.2699358565441467, 'psi': 0.8165329122643881}
[S6] START round=12 head_norm_before_train=1.462980 (no previous merge yet)
[S6] round=12 local utility u=1.000000 metrics={'f1_val': 0.710432720071638, 'auprc': 0.9849046524600481, 'loss_val': 0.41524955937247715, 'psi': 0.8202214930270021}-{'f1_val': 0.41572065481343023, 'auprc': 0.6319465392802495, 'loss_val': 0.8515216749293099, 'psi': 0.5022110086001579}
[S7] START round=12 head_norm_before_train=1.520046 (no previous merge yet)
[S7] round=12 local utility u=0.636131 metrics={'f1_val': 0.6840664654762287, 'auprc': 0.8906727088028019, 'loss_val': 0.3536266517961973, 'psi': 0.766708962806858}-{'f1_val': 0.5805242623272869, 'auprc': 0.7847497243193824, 'loss_val': 0.6868663107224187, 'psi': 0.6622144471241251}
[S8] START round=12 head_norm_before_train=0.914831 cos_to_last_merge=0.9948 (last merge round=10)
[S8] round=12 local utility u=0.096207 metrics={'f1_val': 0.7140449400060004, 'auprc': 0.9960641865236153, 'loss_val': 0.43843181231501444, 'psi': 0.8268526386130464}-{'f1_val': 0.7139521677339791, 'auprc': 0.9934896301069499, 'loss_val': 0.6225645473943033, 'psi': 0.8257671526831674}
[S9] START round=12 head_norm_before_train=0.812057 cos_to_last_merge=1.0000 (last merge round=11)
[S9] round=12 local utility u=0.115574 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9920132153678427, 'loss_val': 0.31241608876795696, 'psi': 0.9948015932354719}-{'f1_val': 0.9705041990198973, 'auprc': 0.9958106827965574, 'loss_val': 0.3980179065040949, 'psi': 0.9806267925305613}
[S10] START round=12 head_norm_before_train=1.258050 cos_to_last_merge=0.9020 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.902
[S10] round=12 local utility u=0.035779 metrics={'f1_val': 0.6959287419553315, 'auprc': 0.9977450302346097, 'loss_val': 0.2978113767867916, 'psi': 0.8166552572670427}-{'f1_val': 0.6937691541252426, 'auprc': 0.9960881626591783, 'loss_val': 0.35144206145138185, 'psi': 0.8146967575388169}
[S11] START round=12 head_norm_before_train=1.182258 cos_to_last_merge=0.9968 (last merge round=10)
[S11] round=12 local utility u=0.093331 metrics={'f1_val': 0.7065628046983898, 'auprc': 0.99760726074217, 'loss_val': 0.4237284979071297, 'psi': 0.8229805871159019}-{'f1_val': 0.7019322376706589, 'auprc': 0.9978567145897782, 'loss_val': 0.5833556713424634, 'psi': 0.8203020284383067}
[S13] START round=12 head_norm_before_train=1.410024 (no previous merge yet)
[S13] round=12 local utility u=0.346483 metrics={'f1_val': 0.6993735815316217, 'auprc': 0.7353357977345678, 'loss_val': 0.5637943746742651, 'psi': 0.7137584680128002}-{'f1_val': 0.5919782920823647, 'auprc': 0.7591779698483164, 'loss_val': 0.6839151402305826, 'psi': 0.6588581631887453}
[S14] START round=12 head_norm_before_train=0.889727 cos_to_last_merge=1.0000 (last merge round=11)
[S14] round=12 local utility u=0.000000 metrics={'f1_val': 0.41784371423724276, 'auprc': 0.9890933155009083, 'loss_val': 0.807699257711256, 'psi': 0.646343554742709}-{'f1_val': 0.6098760574473228, 'auprc': 0.9917360593105867, 'loss_val': 0.7629560189306445, 'psi': 0.7626200581926283}
[S15] START round=12 head_norm_before_train=1.278337 cos_to_last_merge=0.8804 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.880
[S15] round=12 local utility u=0.022923 metrics={'f1_val': 0.7013105282640891, 'auprc': 0.8001058357783226, 'loss_val': 0.4048230037566653, 'psi': 0.7408286512697826}-{'f1_val': 0.7009621312698922, 'auprc': 0.793736080811193, 'loss_val': 0.4294694685909227, 'psi': 0.7380717110864126}
[S16] START round=12 head_norm_before_train=1.008486 cos_to_last_merge=1.0000 (last merge round=11)
[S16] round=12 local utility u=0.002852 metrics={'f1_val': 0.43612354050432794, 'auprc': 0.7576421051839257, 'loss_val': 0.9258290671342563, 'psi': 0.564730966376167}-{'f1_val': 0.5442217437843624, 'auprc': 0.5520474048375991, 'loss_val': 0.963338327672709, 'psi': 0.5473520082056571}
[S17] START round=12 head_norm_before_train=0.853752 cos_to_last_merge=1.0000 (last merge round=11)
[S17] round=12 local utility u=0.108889 metrics={'f1_val': 0.3583793813902282, 'auprc': 0.9536635646915266, 'loss_val': 0.9215757926232473, 'psi': 0.5964930547107475}-{'f1_val': 0.36531747584155594, 'auprc': 0.8517087423446461, 'loss_val': 0.8751181879247294, 'psi': 0.5598739824427921}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:37116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] → sending delta(kind=head bytes=1794) to S11@127.0.0.1:37112
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S16] → sending delta(kind=head bytes=1789) to S8@127.0.0.1:37109
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:37114
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:37114
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:37104
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:37116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:37113
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:37111
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S17@127.0.0.1:37117
[S10] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1793 to 1 peers)
[S16] sending update (kind=head size=1789 to 1 peers)
[S6] sending update (kind=head size=1794 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1797) from S7
[S10] cosine check vs S7: cos=-0.0406
[S10] DROPPED delta from S7 (cos=-0.0406 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1789) from S16
[S8] cosine check vs S16: cos=0.6503
[S4] RECEIVED delta(kind=head bytes=1800) from S3
[S4] cosine check vs S3: cos=-0.1036
[S4] DROPPED delta from S3 (cos=-0.1036 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1803) from S11
[S14] cosine check vs S11: cos=0.4369
[S13] RECEIVED delta(kind=head bytes=1796) from S9
[S13] cosine check vs S9: cos=-0.0517
[S13] DROPPED delta from S9 (cos=-0.0517 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1802) from S13
[S16] cosine check vs S13: cos=0.4917
[S11] RECEIVED delta(kind=head bytes=1794) from S6
[S11] cosine check vs S6: cos=0.8830
[S16] RECEIVED delta(kind=head bytes=1802) from S15
[S16] cosine check vs S15: cos=0.8861
[S17] RECEIVED delta(kind=head bytes=1793) from S8
[S17] cosine check vs S8: cos=0.8840
[S14] RECEIVED delta(kind=head bytes=1801) from S10
[S14] cosine check vs S10: cos=0.8808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:37110
[S17] sending update (kind=head size=1800 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1800) from S17
[S9] cosine check vs S17: cos=0.2146
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=12 metric=0.4178 head_norm=0.917390
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.372550e-01
[S14] stored merged vector for next round verification (round=12)
[S14] DEBUG after merge:  round=12 metric=0.3786 head_norm=0.909939 delta_norm=0.237255
[S14] aggregate: ROLLBACK (f1_val pre=0.418 post=0.379 tol_abs=0.005 tol_rel=0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=12 metric=0.7140 head_norm=0.978464
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.241182e-01
[S8] stored merged vector for next round verification (round=12)
[S8] DEBUG after merge:  round=12 metric=0.7138 head_norm=0.919089 delta_norm=0.424118
[S8] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=12 metric=0.4361 head_norm=1.044897
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.047616e-01
[S16] stored merged vector for next round verification (round=12)
[S16] DEBUG after merge:  round=12 metric=0.4447 head_norm=1.011064 delta_norm=0.204762
[S16] aggregate: ACCEPT kept=['S13', 'S15'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=12 metric=0.7066 head_norm=1.228485
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.510396e-01
[S11] stored merged vector for next round verification (round=12)
[S11] DEBUG after merge:  round=12 metric=0.7095 head_norm=1.317035 delta_norm=0.351040
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=12 metric=0.9967 head_norm=0.891217
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.587358e-01
[S9] stored merged vector for next round verification (round=12)
[S9] DEBUG after merge:  round=12 metric=0.9964 head_norm=0.694851 delta_norm=0.558736
[S9] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=12 metric=0.3584 head_norm=0.892042
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.291186e-01
[S17] stored merged vector for next round verification (round=12)
[S17] DEBUG after merge:  round=12 metric=0.3585 head_norm=0.907783 delta_norm=0.229119
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.600769 (no previous merge yet)
[S2] round=13 local utility u=0.000000 metrics={'f1_val': 0.7013101313728686, 'auprc': 0.6740014351571246, 'loss_val': 0.30106854794086163, 'psi': 0.690386652886571}-{'f1_val': 0.701391712864433, 'auprc': 0.6796098833018112, 'loss_val': 0.3174368629000646, 'psi': 0.6926789810393843}
[S3] START round=13 head_norm_before_train=1.758131 (no previous merge yet)
[S3] round=13 local utility u=0.023202 metrics={'f1_val': 0.7044045881461305, 'auprc': 0.9997630759740883, 'loss_val': 0.18677177026220346, 'psi': 0.8225479832773136}-{'f1_val': 0.7018768808926283, 'auprc': 0.9990687062292528, 'loss_val': 0.21592677250730247, 'psi': 0.8207536110272782}
[S4] START round=13 head_norm_before_train=0.836362 cos_to_last_merge=0.9917 (last merge round=11)
[S4] round=13 local utility u=0.078043 metrics={'f1_val': 0.6647178929875865, 'auprc': 0.8525631806713374, 'loss_val': 0.6692407690263003, 'psi': 0.7398560080610869}-{'f1_val': 0.6646706834426133, 'auprc': 0.8395381075053476, 'loss_val': 0.7859675220358329, 'psi': 0.734617653067707}
[S5] START round=13 head_norm_before_train=1.661999 (no previous merge yet)
[S5] round=13 local utility u=0.128947 metrics={'f1_val': 0.7007831886498938, 'auprc': 0.9906442153894628, 'loss_val': 0.21720814293717589, 'psi': 0.8167275993457215}-{'f1_val': 0.7006083926626743, 'auprc': 0.9369608850429918, 'loss_val': 0.3130026912486598, 'psi': 0.7951493896148013}
[S6] START round=13 head_norm_before_train=1.485410 (no previous merge yet)
[S6] round=13 local utility u=0.000000 metrics={'f1_val': 0.45870947868265577, 'auprc': 0.7879577977503346, 'loss_val': 0.7687153169640979, 'psi': 0.5904088063097273}-{'f1_val': 0.710432720071638, 'auprc': 0.9849046524600481, 'loss_val': 0.41524955937247715, 'psi': 0.8202214930270021}
[S7] START round=13 head_norm_before_train=1.542052 (no previous merge yet)
[S7] round=13 local utility u=0.000000 metrics={'f1_val': 0.5580010020734538, 'auprc': 0.7853227811994857, 'loss_val': 0.7832976010988899, 'psi': 0.6489297137238665}-{'f1_val': 0.6840664654762287, 'auprc': 0.8906727088028019, 'loss_val': 0.3536266517961973, 'psi': 0.766708962806858}
[S8] START round=13 head_norm_before_train=0.919089 cos_to_last_merge=1.0000 (last merge round=12)
[S8] round=13 local utility u=0.000000 metrics={'f1_val': 0.7139540394217572, 'auprc': 0.9975256001962381, 'loss_val': 0.48102758146438074, 'psi': 0.8273826637315496}-{'f1_val': 0.7140449400060004, 'auprc': 0.9960641865236153, 'loss_val': 0.43843181231501444, 'psi': 0.8268526386130464}
[S9] START round=13 head_norm_before_train=0.694851 cos_to_last_merge=1.0000 (last merge round=12)
[S9] round=13 local utility u=0.000000 metrics={'f1_val': 0.9955808965143278, 'auprc': 0.9964838786573951, 'loss_val': 0.4409834741718776, 'psi': 0.9959420893715547}-{'f1_val': 0.9966605118138915, 'auprc': 0.9920132153678427, 'loss_val': 0.31241608876795696, 'psi': 0.9948015932354719}
[S10] START round=13 head_norm_before_train=1.300701 cos_to_last_merge=0.8920 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.892
[S10] round=13 local utility u=0.270014 metrics={'f1_val': 0.7800302266167044, 'auprc': 0.99771113789871, 'loss_val': 0.2622904999308793, 'psi': 0.8671025911295067}-{'f1_val': 0.6959287419553315, 'auprc': 0.9977450302346097, 'loss_val': 0.2978113767867916, 'psi': 0.8166552572670427}
[S11] START round=13 head_norm_before_train=1.317035 cos_to_last_merge=1.0000 (last merge round=12)
[S11] round=13 local utility u=0.000000 metrics={'f1_val': 0.70975997129146, 'auprc': 0.9976099875542548, 'loss_val': 0.4491141712472795, 'psi': 0.824899977796578}-{'f1_val': 0.7065628046983898, 'auprc': 0.99760726074217, 'loss_val': 0.4237284979071297, 'psi': 0.8229805871159019}
[S13] START round=13 head_norm_before_train=1.438797 (no previous merge yet)
[S13] round=13 local utility u=0.000000 metrics={'f1_val': 0.6557515597593971, 'auprc': 0.6953387775230961, 'loss_val': 0.5482635363587086, 'psi': 0.6715864468648767}-{'f1_val': 0.6993735815316217, 'auprc': 0.7353357977345678, 'loss_val': 0.5637943746742651, 'psi': 0.7137584680128002}
[S14] START round=13 head_norm_before_train=0.909939 cos_to_last_merge=1.0000 (last merge round=12)
[S14] round=13 local utility u=1.000000 metrics={'f1_val': 0.9229696195905364, 'auprc': 0.9940714935675903, 'loss_val': 0.7464377471326074, 'psi': 0.9514103691813579}-{'f1_val': 0.41784371423724276, 'auprc': 0.9890933155009083, 'loss_val': 0.807699257711256, 'psi': 0.646343554742709}
[S15] START round=13 head_norm_before_train=1.319174 cos_to_last_merge=0.8683 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.868
[S15] round=13 local utility u=0.300221 metrics={'f1_val': 0.6929710623090345, 'auprc': 0.9901915168946316, 'loss_val': 0.32460221190298083, 'psi': 0.8118592441432734}-{'f1_val': 0.7013105282640891, 'auprc': 0.8001058357783226, 'loss_val': 0.4048230037566653, 'psi': 0.7408286512697826}
[S16] START round=13 head_norm_before_train=1.011064 cos_to_last_merge=1.0000 (last merge round=12)
[S16] round=13 local utility u=0.335296 metrics={'f1_val': 0.5266721782507714, 'auprc': 0.7778404595627145, 'loss_val': 0.8591235427370317, 'psi': 0.6271394907755486}-{'f1_val': 0.43612354050432794, 'auprc': 0.7576421051839257, 'loss_val': 0.9258290671342563, 'psi': 0.564730966376167}
[S17] START round=13 head_norm_before_train=0.907783 cos_to_last_merge=1.0000 (last merge round=12)
[S17] round=13 local utility u=0.000000 metrics={'f1_val': 0.35740394199746695, 'auprc': 0.6283143863261864, 'loss_val': 0.9353009058889108, 'psi': 0.4657681197289547}-{'f1_val': 0.3583793813902282, 'auprc': 0.9536635646915266, 'loss_val': 0.9215757926232473, 'psi': 0.5964930547107475}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:37116
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:37114
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:37110
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:37109
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] → sending delta(kind=head bytes=1805) to S9@127.0.0.1:37110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:37104
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:37104
[S16] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1795 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1805 to 1 peers)
[S4] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1802) from S15
[S16] cosine check vs S15: cos=0.8002
[S14] RECEIVED delta(kind=head bytes=1799) from S10
[S14] cosine check vs S10: cos=0.8308
[S8] RECEIVED delta(kind=head bytes=1797) from S16
[S8] cosine check vs S16: cos=0.9045
[S9] RECEIVED delta(kind=head bytes=1805) from S5
[S9] cosine check vs S5: cos=0.5944
[S9] RECEIVED delta(kind=head bytes=1795) from S4
[S9] cosine check vs S4: cos=0.3782
[S4] RECEIVED delta(kind=head bytes=1795) from S14
[S4] cosine check vs S14: cos=0.5959
[S4] RECEIVED delta(kind=head bytes=1798) from S3
[S4] cosine check vs S3: cos=-0.1114
[S4] DROPPED delta from S3 (cos=-0.1114 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=13 metric=0.7140 head_norm=0.970149
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.243933e-01
[S8] stored merged vector for next round verification (round=13)
[S8] DEBUG after merge:  round=13 metric=0.7140 head_norm=0.986329 delta_norm=0.224393
[S8] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=13 metric=0.9956 head_norm=0.765244
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.772388e-01
[S9] stored merged vector for next round verification (round=13)
[S9] DEBUG after merge:  round=13 metric=0.9958 head_norm=0.809520 delta_norm=0.377239
[S9] aggregate: ACCEPT kept=['S5', 'S4'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=13 metric=0.5267 head_norm=1.051288
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.071655e-01
[S16] stored merged vector for next round verification (round=13)
[S16] DEBUG after merge:  round=13 metric=0.5244 head_norm=1.143326 delta_norm=0.407166
[S16] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=13 metric=0.6647 head_norm=0.893191
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.121265e-01
[S4] stored merged vector for next round verification (round=13)
[S4] DEBUG after merge:  round=13 metric=0.6653 head_norm=0.818139 delta_norm=0.412127
[S4] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=13 metric=0.9230 head_norm=0.938408
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.819849e-01
[S14] stored merged vector for next round verification (round=13)
[S14] DEBUG after merge:  round=13 metric=0.3852 head_norm=1.090123 delta_norm=0.381985
[S14] aggregate: ROLLBACK (f1_val pre=0.923 post=0.385 tol_abs=0.005 tol_rel=0.0)
[S2] START round=14 head_norm_before_train=1.638863 (no previous merge yet)
[S2] round=14 local utility u=0.000000 metrics={'f1_val': 0.7013101313728686, 'auprc': 0.6726275081716857, 'loss_val': 0.3094985886173931, 'psi': 0.6898370820923955}-{'f1_val': 0.7013101313728686, 'auprc': 0.6740014351571246, 'loss_val': 0.30106854794086163, 'psi': 0.690386652886571}
[S3] START round=14 head_norm_before_train=1.794731 (no previous merge yet)
[S3] round=14 local utility u=0.921799 metrics={'f1_val': 0.9986383585344689, 'auprc': 0.9996503070691377, 'loss_val': 0.10823787124148752, 'psi': 0.9990431379483364}-{'f1_val': 0.7044045881461305, 'auprc': 0.9997630759740883, 'loss_val': 0.18677177026220346, 'psi': 0.8225479832773136}
[S4] START round=14 head_norm_before_train=0.818139 cos_to_last_merge=1.0000 (last merge round=13)
[S4] round=14 local utility u=0.000000 metrics={'f1_val': 0.6594468907504443, 'auprc': 0.850150544717071, 'loss_val': 0.7405280186537002, 'psi': 0.735728352337095}-{'f1_val': 0.6647178929875865, 'auprc': 0.8525631806713374, 'loss_val': 0.6692407690263003, 'psi': 0.7398560080610869}
[S5] START round=14 head_norm_before_train=1.687476 (no previous merge yet)
[S5] round=14 local utility u=0.000000 metrics={'f1_val': 0.41734336430956875, 'auprc': 0.759659592120951, 'loss_val': 1.4736588885112885, 'psi': 0.5542698554341217}-{'f1_val': 0.7007831886498938, 'auprc': 0.9906442153894628, 'loss_val': 0.21720814293717589, 'psi': 0.8167275993457215}
[S6] START round=14 head_norm_before_train=1.511593 (no previous merge yet)
[S6] round=14 local utility u=1.000000 metrics={'f1_val': 0.6514023966657837, 'auprc': 0.9633452052150614, 'loss_val': 0.43824160838729764, 'psi': 0.7761795200854948}-{'f1_val': 0.45870947868265577, 'auprc': 0.7879577977503346, 'loss_val': 0.7687153169640979, 'psi': 0.5904088063097273}
[S7] START round=14 head_norm_before_train=1.554598 (no previous merge yet)
[S7] round=14 local utility u=0.297891 metrics={'f1_val': 0.6166282977423475, 'auprc': 0.798301116411688, 'loss_val': 0.5782138250184888, 'psi': 0.6892974252100837}-{'f1_val': 0.5580010020734538, 'auprc': 0.7853227811994857, 'loss_val': 0.7832976010988899, 'psi': 0.6489297137238665}
[S8] START round=14 head_norm_before_train=0.986329 cos_to_last_merge=1.0000 (last merge round=13)
[S8] round=14 local utility u=0.845740 metrics={'f1_val': 0.9952289782211529, 'auprc': 0.9971939921613742, 'loss_val': 0.4762022415555891, 'psi': 0.9960149837972414}-{'f1_val': 0.7139540394217572, 'auprc': 0.9975256001962381, 'loss_val': 0.48102758146438074, 'psi': 0.8273826637315496}
[S9] START round=14 head_norm_before_train=0.809520 cos_to_last_merge=1.0000 (last merge round=13)
[S9] round=14 local utility u=0.072488 metrics={'f1_val': 0.992684475148198, 'auprc': 0.9959336128225069, 'loss_val': 0.2769789676661925, 'psi': 0.9939841302179215}-{'f1_val': 0.9955808965143278, 'auprc': 0.9964838786573951, 'loss_val': 0.4409834741718776, 'psi': 0.9959420893715547}
[S10] START round=14 head_norm_before_train=1.337143 cos_to_last_merge=0.8838 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.884
[S10] round=14 local utility u=0.528287 metrics={'f1_val': 0.9580976723093733, 'auprc': 0.9923716161937746, 'loss_val': 0.25810297287087286, 'psi': 0.9718072498631337}-{'f1_val': 0.7800302266167044, 'auprc': 0.99771113789871, 'loss_val': 0.2622904999308793, 'psi': 0.8671025911295067}
[S11] START round=14 head_norm_before_train=1.353205 cos_to_last_merge=0.9969 (last merge round=12)
[S11] round=14 local utility u=0.000000 metrics={'f1_val': 0.6769643266300306, 'auprc': 0.9970014485481065, 'loss_val': 0.37949697858494424, 'psi': 0.804979175397261}-{'f1_val': 0.70975997129146, 'auprc': 0.9976099875542548, 'loss_val': 0.4491141712472795, 'psi': 0.824899977796578}
[S13] START round=14 head_norm_before_train=1.467644 (no previous merge yet)
[S13] round=14 local utility u=0.000000 metrics={'f1_val': 0.6527237647459971, 'auprc': 0.6612552249839124, 'loss_val': 0.5480138997506765, 'psi': 0.6561363488411633}-{'f1_val': 0.6557515597593971, 'auprc': 0.6953387775230961, 'loss_val': 0.5482635363587086, 'psi': 0.6715864468648767}
[S14] START round=14 head_norm_before_train=1.090123 cos_to_last_merge=1.0000 (last merge round=13)
[S14] round=14 local utility u=0.000000 metrics={'f1_val': 0.8632236194438792, 'auprc': 0.9948155565898675, 'loss_val': 0.693651663900968, 'psi': 0.9158603943022745}-{'f1_val': 0.9229696195905364, 'auprc': 0.9940714935675903, 'loss_val': 0.7464377471326074, 'psi': 0.9514103691813579}
[S15] START round=14 head_norm_before_train=1.356743 cos_to_last_merge=0.8593 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.859
[S15] round=14 local utility u=0.000000 metrics={'f1_val': 0.7013907637913239, 'auprc': 0.7971751984279658, 'loss_val': 0.49410017108637194, 'psi': 0.7397045376459807}-{'f1_val': 0.6929710623090345, 'auprc': 0.9901915168946316, 'loss_val': 0.32460221190298083, 'psi': 0.8118592441432734}
[S16] START round=14 head_norm_before_train=1.143326 cos_to_last_merge=1.0000 (last merge round=13)
[S16] round=14 local utility u=0.000000 metrics={'f1_val': 0.5016973026867897, 'auprc': 0.8040369306837543, 'loss_val': 0.8101017409785207, 'psi': 0.6226331538855755}-{'f1_val': 0.5266721782507714, 'auprc': 0.7778404595627145, 'loss_val': 0.8591235427370317, 'psi': 0.6271394907755486}
[S17] START round=14 head_norm_before_train=0.943755 cos_to_last_merge=0.9911 (last merge round=12)
[S17] round=14 local utility u=0.054481 metrics={'f1_val': 0.3537721729919471, 'auprc': 0.6639423414061117, 'loss_val': 0.911432370716336, 'psi': 0.47784024035761297}-{'f1_val': 0.35740394199746695, 'auprc': 0.6283143863261864, 'loss_val': 0.9353009058889108, 'psi': 0.4657681197289547}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:37117
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:37112
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:37111
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] → sending delta(kind=head bytes=1794) to S4@127.0.0.1:37104
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:37113
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:37114
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1804 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1794 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1797) from S6
[S11] cosine check vs S6: cos=0.9399
[S13] RECEIVED delta(kind=head bytes=1799) from S9
[S13] cosine check vs S9: cos=0.0758
[S17] RECEIVED delta(kind=head bytes=1799) from S8
[S17] cosine check vs S8: cos=0.7689
[S4] RECEIVED delta(kind=head bytes=1794) from S3
[S4] cosine check vs S3: cos=-0.0736
[S4] DROPPED delta from S3 (cos=-0.0736 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1798) from S7
[S10] cosine check vs S7: cos=-0.0336
[S10] DROPPED delta from S7 (cos=-0.0336 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1804) from S10
[S14] cosine check vs S10: cos=0.9541
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S17] → sending delta(kind=head bytes=1791) to S9@127.0.0.1:37110
[S17] sending update (kind=head size=1791 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1791) from S17
[S9] cosine check vs S17: cos=0.3354
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=14 metric=0.8632 head_norm=1.116465
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.255171e-01
[S14] stored merged vector for next round verification (round=14)
[S14] DEBUG after merge:  round=14 metric=0.6048 head_norm=1.228084 delta_norm=0.225517
[S14] aggregate: ROLLBACK (f1_val pre=0.863 post=0.605 tol_abs=0.005 tol_rel=0.0)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=14 metric=0.6527 head_norm=1.494953
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.429334e-01
[S13] stored merged vector for next round verification (round=14)
[S13] DEBUG after merge:  round=14 metric=0.6426 head_norm=0.901408 delta_norm=0.842933
[S13] aggregate: ROLLBACK (f1_val pre=0.653 post=0.643 tol_abs=0.005 tol_rel=0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=14 metric=0.6770 head_norm=1.394459
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.636048e-01
[S11] stored merged vector for next round verification (round=14)
[S11] DEBUG after merge:  round=14 metric=0.6705 head_norm=1.443499 delta_norm=0.263605
[S11] aggregate: ROLLBACK (f1_val pre=0.677 post=0.670 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=14 metric=0.9927 head_norm=0.900700
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.467522e-01
[S9] stored merged vector for next round verification (round=14)
[S9] DEBUG after merge:  round=14 metric=0.9922 head_norm=0.773690 delta_norm=0.546752
[S9] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=14 metric=0.3538 head_norm=0.991871
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.437298e-01
[S17] stored merged vector for next round verification (round=14)
[S17] DEBUG after merge:  round=14 metric=0.3536 head_norm=0.949826 delta_norm=0.343730
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.671579 (no previous merge yet)
[S2] round=15 local utility u=0.013007 metrics={'f1_val': 0.7015710590385817, 'auprc': 0.674586681505728, 'loss_val': 0.2909286240878605, 'psi': 0.6907773080254402}-{'f1_val': 0.7013101313728686, 'auprc': 0.6726275081716857, 'loss_val': 0.3094985886173931, 'psi': 0.6898370820923955}
[S3] START round=15 head_norm_before_train=1.832558 (no previous merge yet)
[S3] round=15 local utility u=0.000000 metrics={'f1_val': 0.9836617467424165, 'auprc': 0.9990920004352087, 'loss_val': 0.12087424242832476, 'psi': 0.9898338482195334}-{'f1_val': 0.9986383585344689, 'auprc': 0.9996503070691377, 'loss_val': 0.10823787124148752, 'psi': 0.9990431379483364}
[S4] START round=15 head_norm_before_train=0.861151 cos_to_last_merge=0.9940 (last merge round=13)
[S4] round=15 local utility u=0.059586 metrics={'f1_val': 0.6636468806467233, 'auprc': 0.8463333285983042, 'loss_val': 0.635103856131689, 'psi': 0.7367214598273557}-{'f1_val': 0.6594468907504443, 'auprc': 0.850150544717071, 'loss_val': 0.7405280186537002, 'psi': 0.735728352337095}
[S5] START round=15 head_norm_before_train=1.703276 (no previous merge yet)
[S5] round=15 local utility u=1.000000 metrics={'f1_val': 0.6616617686640502, 'auprc': 0.8578905408701986, 'loss_val': 0.4137871884773481, 'psi': 0.7401532775465096}-{'f1_val': 0.41734336430956875, 'auprc': 0.759659592120951, 'loss_val': 1.4736588885112885, 'psi': 0.5542698554341217}
[S6] START round=15 head_norm_before_train=1.536827 (no previous merge yet)
[S6] round=15 local utility u=0.000000 metrics={'f1_val': 0.6205975498021004, 'auprc': 0.9055199440739627, 'loss_val': 0.48666626099024896, 'psi': 0.7345665075108454}-{'f1_val': 0.6514023966657837, 'auprc': 0.9633452052150614, 'loss_val': 0.43824160838729764, 'psi': 0.7761795200854948}
[S7] START round=15 head_norm_before_train=1.568206 (no previous merge yet)
[S7] round=15 local utility u=0.000000 metrics={'f1_val': 0.5349964933070167, 'auprc': 0.7840428477081891, 'loss_val': 0.8571304694938416, 'psi': 0.6346150350674857}-{'f1_val': 0.6166282977423475, 'auprc': 0.798301116411688, 'loss_val': 0.5782138250184888, 'psi': 0.6892974252100837}
[S8] START round=15 head_norm_before_train=1.028023 cos_to_last_merge=0.9959 (last merge round=13)
[S8] round=15 local utility u=0.000000 metrics={'f1_val': 0.7139521677339791, 'auprc': 0.9954813846655788, 'loss_val': 0.4006325206856157, 'psi': 0.826563854506619}-{'f1_val': 0.9952289782211529, 'auprc': 0.9971939921613742, 'loss_val': 0.4762022415555891, 'psi': 0.9960149837972414}
[S9] START round=15 head_norm_before_train=0.773690 cos_to_last_merge=1.0000 (last merge round=14)
[S9] round=15 local utility u=0.000000 metrics={'f1_val': 0.9939393793306803, 'auprc': 0.9965544153430983, 'loss_val': 0.379068169426179, 'psi': 0.9949853937356475}-{'f1_val': 0.992684475148198, 'auprc': 0.9959336128225069, 'loss_val': 0.2769789676661925, 'psi': 0.9939841302179215}
[S10] START round=15 head_norm_before_train=1.368066 cos_to_last_merge=0.8776 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.878
[S10] round=15 local utility u=0.149026 metrics={'f1_val': 0.9923566821450288, 'auprc': 0.9970218892695403, 'loss_val': 0.1795567114107471, 'psi': 0.9942227649948334}-{'f1_val': 0.9580976723093733, 'auprc': 0.9923716161937746, 'loss_val': 0.25810297287087286, 'psi': 0.9718072498631337}
[S11] START round=15 head_norm_before_train=1.443499 cos_to_last_merge=1.0000 (last merge round=14)
[S11] round=15 local utility u=0.111158 metrics={'f1_val': 0.7111774844580416, 'auprc': 0.9972534770765006, 'loss_val': 0.36321541012335556, 'psi': 0.8256078815054253}-{'f1_val': 0.6769643266300306, 'auprc': 0.9970014485481065, 'loss_val': 0.37949697858494424, 'psi': 0.804979175397261}
[S13] START round=15 head_norm_before_train=0.901408 cos_to_last_merge=1.0000 (last merge round=14)
[S13] round=15 local utility u=0.000000 metrics={'f1_val': 0.6248403420263193, 'auprc': 0.6300782333366712, 'loss_val': 0.6747214144763015, 'psi': 0.62693549855046}-{'f1_val': 0.6527237647459971, 'auprc': 0.6612552249839124, 'loss_val': 0.5480138997506765, 'psi': 0.6561363488411633}
[S14] START round=15 head_norm_before_train=1.228084 cos_to_last_merge=1.0000 (last merge round=14)
[S14] round=15 local utility u=0.433058 metrics={'f1_val': 0.9914306030725374, 'auprc': 0.9961212444233467, 'loss_val': 0.6006947542293227, 'psi': 0.9933068596128611}-{'f1_val': 0.8632236194438792, 'auprc': 0.9948155565898675, 'loss_val': 0.693651663900968, 'psi': 0.9158603943022745}
[S15] START round=15 head_norm_before_train=1.389044 cos_to_last_merge=0.8518 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.852
[S15] round=15 local utility u=0.349067 metrics={'f1_val': 0.6932122266276629, 'auprc': 0.9842588644942984, 'loss_val': 0.3081459391275688, 'psi': 0.8096308817743172}-{'f1_val': 0.7013907637913239, 'auprc': 0.7971751984279658, 'loss_val': 0.49410017108637194, 'psi': 0.7397045376459807}
[S16] START round=15 head_norm_before_train=1.176475 cos_to_last_merge=0.9979 (last merge round=13)
[S16] round=15 local utility u=0.344821 metrics={'f1_val': 0.5707157712166313, 'auprc': 0.8646310472412617, 'loss_val': 0.7163532411770079, 'psi': 0.6882818816264835}-{'f1_val': 0.5016973026867897, 'auprc': 0.8040369306837543, 'loss_val': 0.8101017409785207, 'psi': 0.6226331538855755}
[S17] START round=15 head_norm_before_train=0.949826 cos_to_last_merge=1.0000 (last merge round=14)
[S17] round=15 local utility u=0.000000 metrics={'f1_val': 0.3536207091334382, 'auprc': 0.6669902532538049, 'loss_val': 0.9292279792238975, 'psi': 0.47896852678158486}-{'f1_val': 0.3537721729919471, 'auprc': 0.6639423414061117, 'loss_val': 0.911432370716336, 'psi': 0.47784024035761297}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:37109
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:37104
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:37110
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:37110
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:37109
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:37116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:37114
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:37114
[S15] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1794 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S2] sending update (kind=head size=1795 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1795) from S2
[S8] cosine check vs S2: cos=-0.0404
[S8] DROPPED delta from S2 (cos=-0.0404 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1799) from S16
[S8] cosine check vs S16: cos=0.8756
[S9] RECEIVED delta(kind=head bytes=1799) from S5
[S9] cosine check vs S5: cos=0.5537
[S16] RECEIVED delta(kind=head bytes=1801) from S15
[S16] cosine check vs S15: cos=0.9358
[S14] RECEIVED delta(kind=head bytes=1799) from S11
[S14] cosine check vs S11: cos=0.2630
[S9] RECEIVED delta(kind=head bytes=1794) from S4
[S9] cosine check vs S4: cos=0.4296
[S14] RECEIVED delta(kind=head bytes=1802) from S10
[S14] cosine check vs S10: cos=0.9783
[S4] RECEIVED delta(kind=head bytes=1796) from S14
[S4] cosine check vs S14: cos=0.6472
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=15 metric=0.9939 head_norm=0.852597
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.067669e-01
[S9] stored merged vector for next round verification (round=15)
[S9] DEBUG after merge:  round=15 metric=0.9942 head_norm=0.858631 delta_norm=0.406767
[S9] aggregate: ACCEPT kept=['S5', 'S4'] (k=2/2) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.150 → S13@127.0.0.1:37113
[S7] ⇄ pheromone p=0.219 → S10@127.0.0.1:37111
[S6] ⇄ pheromone p=0.442 → S11@127.0.0.1:37112
[S3] ⇄ pheromone p=0.251 → S4@127.0.0.1:37104
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=15 metric=0.7140 head_norm=1.073936
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.935318e-01
[S8] stored merged vector for next round verification (round=15)
[S8] DEBUG after merge:  round=15 metric=0.7140 head_norm=1.108568 delta_norm=0.293532
[S8] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.318 → S17@127.0.0.1:37117
[S13] ⇄ pheromone p=0.174 → S16@127.0.0.1:37116
[S10] ⇄ pheromone p=0.277 → S14@127.0.0.1:37114
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=15 metric=0.5707 head_norm=1.215248
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.546131e-01
[S16] stored merged vector for next round verification (round=15)
[S16] DEBUG after merge:  round=15 metric=0.5671 head_norm=1.292641 delta_norm=0.254613
[S16] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.203 → S8@127.0.0.1:37109
[S5] ⇄ pheromone p=0.331 → S9@127.0.0.1:37110
[S15] ⇄ pheromone p=0.227 → S16@127.0.0.1:37116
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=15 metric=0.9914 head_norm=1.253404
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.867038e-01
[S14] stored merged vector for next round verification (round=15)
[S14] DEBUG after merge:  round=15 metric=0.9522 head_norm=1.118074 delta_norm=0.386704
[S14] aggregate: ROLLBACK (f1_val pre=0.991 post=0.952 tol_abs=0.005 tol_rel=0.0)
[S14] ⇄ pheromone p=0.348 → S4@127.0.0.1:37104
[S11] ⇄ pheromone p=0.153 → S14@127.0.0.1:37114
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=15 metric=0.6636 head_norm=0.916623
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.806582e-01
[S4] stored merged vector for next round verification (round=15)
[S4] DEBUG after merge:  round=15 metric=0.6629 head_norm=0.987207 delta_norm=0.480658
[S4] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.162 → S9@127.0.0.1:37110
[S2] ⇄ pheromone p=0.115 → S8@127.0.0.1:37109
[S17] ⇄ pheromone p=0.096 → S9@127.0.0.1:37110
[S2] START round=16 head_norm_before_train=1.697176 (no previous merge yet)
[S2] round=16 local utility u=0.000000 metrics={'f1_val': 0.7013101313728686, 'auprc': 0.676308353111783, 'loss_val': 0.32553771886058447, 'psi': 0.6913094200684343}-{'f1_val': 0.7015710590385817, 'auprc': 0.674586681505728, 'loss_val': 0.2909286240878605, 'psi': 0.6907773080254402}
[S3] START round=16 head_norm_before_train=1.863274 (no previous merge yet)
[S3] round=16 local utility u=0.000000 metrics={'f1_val': 0.4381508472302612, 'auprc': 0.7469678521728016, 'loss_val': 0.8680815742891973, 'psi': 0.5616776492072774}-{'f1_val': 0.9836617467424165, 'auprc': 0.9990920004352087, 'loss_val': 0.12087424242832476, 'psi': 0.9898338482195334}
[S4] START round=16 head_norm_before_train=0.987207 cos_to_last_merge=1.0000 (last merge round=15)
[S4] round=16 local utility u=0.000000 metrics={'f1_val': 0.6664333389063791, 'auprc': 0.806153273100857, 'loss_val': 0.694922319828176, 'psi': 0.7223213125841703}-{'f1_val': 0.6636468806467233, 'auprc': 0.8463333285983042, 'loss_val': 0.635103856131689, 'psi': 0.7367214598273557}
[S5] START round=16 head_norm_before_train=1.711300 (no previous merge yet)
[S5] round=16 local utility u=0.320681 metrics={'f1_val': 0.700781124122831, 'auprc': 0.9587873464098332, 'loss_val': 0.3098323764217283, 'psi': 0.8039836130376319}-{'f1_val': 0.6616617686640502, 'auprc': 0.8578905408701986, 'loss_val': 0.4137871884773481, 'psi': 0.7401532775465096}
[S6] START round=16 head_norm_before_train=1.559636 (no previous merge yet)
[S6] round=16 local utility u=0.000000 metrics={'f1_val': 0.6205594242244391, 'auprc': 0.8650037010575452, 'loss_val': 0.46176012954813006, 'psi': 0.7183371349576815}-{'f1_val': 0.6205975498021004, 'auprc': 0.9055199440739627, 'loss_val': 0.48666626099024896, 'psi': 0.7345665075108454}
[S7] START round=16 head_norm_before_train=1.582337 (no previous merge yet)
[S7] round=16 local utility u=0.000000 metrics={'f1_val': 0.5257680907259603, 'auprc': 0.782670970262211, 'loss_val': 0.8881996452002525, 'psi': 0.6285292425404606}-{'f1_val': 0.5349964933070167, 'auprc': 0.7840428477081891, 'loss_val': 0.8571304694938416, 'psi': 0.6346150350674857}
[S8] START round=16 head_norm_before_train=1.108568 cos_to_last_merge=1.0000 (last merge round=15)
[S8] round=16 local utility u=0.853685 metrics={'f1_val': 0.9950790219939822, 'auprc': 0.9960595333070238, 'loss_val': 0.38175785521596584, 'psi': 0.9954712265191988}-{'f1_val': 0.7139521677339791, 'auprc': 0.9954813846655788, 'loss_val': 0.4006325206856157, 'psi': 0.826563854506619}
[S9] START round=16 head_norm_before_train=0.858631 cos_to_last_merge=1.0000 (last merge round=15)
[S9] round=16 local utility u=0.084150 metrics={'f1_val': 0.9958601375429889, 'auprc': 0.9948855382807251, 'loss_val': 0.21728657302000245, 'psi': 0.9954702978380834}-{'f1_val': 0.9939393793306803, 'auprc': 0.9965544153430983, 'loss_val': 0.379068169426179, 'psi': 0.9949853937356475}
[S10] START round=16 head_norm_before_train=1.398236 cos_to_last_merge=0.8724 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.872
[S10] round=16 local utility u=0.011011 metrics={'f1_val': 0.9931053942141469, 'auprc': 0.9968823658946409, 'loss_val': 0.16160927718193743, 'psi': 0.9946161828863445}-{'f1_val': 0.9923566821450288, 'auprc': 0.9970218892695403, 'loss_val': 0.1795567114107471, 'psi': 0.9942227649948334}
[S11] START round=16 head_norm_before_train=1.476550 cos_to_last_merge=0.9983 (last merge round=14)
[S11] round=16 local utility u=0.000000 metrics={'f1_val': 0.6636592433191282, 'auprc': 0.8974411868046732, 'loss_val': 0.4332886546691575, 'psi': 0.7571720207133462}-{'f1_val': 0.7111774844580416, 'auprc': 0.9972534770765006, 'loss_val': 0.36321541012335556, 'psi': 0.8256078815054253}
[S13] START round=16 head_norm_before_train=0.937826 cos_to_last_merge=0.9985 (last merge round=14)
[S13] round=16 local utility u=0.037495 metrics={'f1_val': 0.6271833109247867, 'auprc': 0.6309280291555643, 'loss_val': 0.6163391252524654, 'psi': 0.6286811982170978}-{'f1_val': 0.6248403420263193, 'auprc': 0.6300782333366712, 'loss_val': 0.6747214144763015, 'psi': 0.62693549855046}
[S14] START round=16 head_norm_before_train=1.118074 cos_to_last_merge=1.0000 (last merge round=15)
[S14] round=16 local utility u=0.006769 metrics={'f1_val': 0.9900205905311107, 'auprc': 0.9966208886026428, 'loss_val': 0.5801963332417589, 'psi': 0.9926607097597235}-{'f1_val': 0.9914306030725374, 'auprc': 0.9961212444233467, 'loss_val': 0.6006947542293227, 'psi': 0.9933068596128611}
[S15] START round=16 head_norm_before_train=1.412327 cos_to_last_merge=0.8464 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.846
[S15] round=16 local utility u=0.000000 metrics={'f1_val': 0.7013506818496502, 'auprc': 0.9301043127172818, 'loss_val': 0.31959721369042343, 'psi': 0.7928521341967029}-{'f1_val': 0.6932122266276629, 'auprc': 0.9842588644942984, 'loss_val': 0.3081459391275688, 'psi': 0.8096308817743172}
[S16] START round=16 head_norm_before_train=1.292641 cos_to_last_merge=1.0000 (last merge round=15)
[S16] round=16 local utility u=1.000000 metrics={'f1_val': 0.8693282350246929, 'auprc': 0.9329026616737882, 'loss_val': 0.5971348960531504, 'psi': 0.894758005684331}-{'f1_val': 0.5707157712166313, 'auprc': 0.8646310472412617, 'loss_val': 0.7163532411770079, 'psi': 0.6882818816264835}
[S17] START round=16 head_norm_before_train=0.987757 cos_to_last_merge=0.9943 (last merge round=14)
[S17] round=16 local utility u=0.008557 metrics={'f1_val': 0.35332495072624465, 'auprc': 0.6700419557850308, 'loss_val': 0.919494405638896, 'psi': 0.4800117527497591}-{'f1_val': 0.3536207091334382, 'auprc': 0.6669902532538049, 'loss_val': 0.9292279792238975, 'psi': 0.47896852678158486}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:37109
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:37117
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:37114
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:37113
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:37110
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:37116
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:37104
[S13] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1796) from S9
[S13] cosine check vs S9: cos=0.5693
[S8] RECEIVED delta(kind=head bytes=1796) from S16
[S8] cosine check vs S16: cos=0.9190
[S4] RECEIVED delta(kind=head bytes=1797) from S14
[S4] cosine check vs S14: cos=0.9174
[S17] RECEIVED delta(kind=head bytes=1802) from S8
[S17] cosine check vs S8: cos=0.8520
[S9] RECEIVED delta(kind=head bytes=1801) from S5
[S9] cosine check vs S5: cos=0.7941
[S16] RECEIVED delta(kind=head bytes=1797) from S13
[S16] cosine check vs S13: cos=0.2403
[S14] RECEIVED delta(kind=head bytes=1797) from S10
[S14] cosine check vs S10: cos=0.9113
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:37110
[S17] sending update (kind=head size=1801 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1801) from S17
[S9] cosine check vs S17: cos=0.3890
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=16 metric=0.6664 head_norm=1.029597
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.281580e-01
[S4] stored merged vector for next round verification (round=16)
[S4] DEBUG after merge:  round=16 metric=0.6672 head_norm=1.064894 delta_norm=0.228158
[S4] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=16 metric=0.6272 head_norm=0.983750
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.509706e-01
[S13] stored merged vector for next round verification (round=16)
[S13] DEBUG after merge:  round=16 metric=0.6278 head_norm=0.860573 delta_norm=0.450971
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=16 metric=0.9959 head_norm=0.959247
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.738982e-01
[S9] stored merged vector for next round verification (round=16)
[S9] DEBUG after merge:  round=16 metric=0.9959 head_norm=0.959807 delta_norm=0.273898
[S9] aggregate: ACCEPT kept=['S5', 'S17'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=16 metric=0.9951 head_norm=1.151021
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.646080e-01
[S8] stored merged vector for next round verification (round=16)
[S8] DEBUG after merge:  round=16 metric=0.9951 head_norm=1.215146 delta_norm=0.264608
[S8] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=16 metric=0.8693 head_norm=1.329791
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.258276e-01
[S16] stored merged vector for next round verification (round=16)
[S16] DEBUG after merge:  round=16 metric=0.8544 head_norm=0.917186 delta_norm=0.725828
[S16] aggregate: ROLLBACK (f1_val pre=0.869 post=0.854 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=16 metric=0.9900 head_norm=1.145444
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.025343e-01
[S14] stored merged vector for next round verification (round=16)
[S14] DEBUG after merge:  round=16 metric=0.9902 head_norm=1.255771 delta_norm=0.302534
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=16 metric=0.3533 head_norm=1.030680
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.022920e-01
[S17] stored merged vector for next round verification (round=16)
[S17] DEBUG after merge:  round=16 metric=0.3533 head_norm=1.049855 delta_norm=0.302292
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.721087 (no previous merge yet)
[S2] round=17 local utility u=0.014613 metrics={'f1_val': 0.7015710590385817, 'auprc': 0.6761594641404969, 'loss_val': 0.29743035786846034, 'psi': 0.6914064210793478}-{'f1_val': 0.7013101313728686, 'auprc': 0.676308353111783, 'loss_val': 0.32553771886058447, 'psi': 0.6913094200684343}
[S3] START round=17 head_norm_before_train=1.878444 (no previous merge yet)
[S3] round=17 local utility u=1.000000 metrics={'f1_val': 0.9971202529699166, 'auprc': 0.9992427030184992, 'loss_val': 0.06674444332318762, 'psi': 0.9979692329893496}-{'f1_val': 0.4381508472302612, 'auprc': 0.7469678521728016, 'loss_val': 0.8680815742891973, 'psi': 0.5616776492072774}
[S4] START round=17 head_norm_before_train=1.064894 cos_to_last_merge=1.0000 (last merge round=16)
[S4] round=17 local utility u=0.024199 metrics={'f1_val': 0.666048287591563, 'auprc': 0.8293978374474467, 'loss_val': 0.7139476796878866, 'psi': 0.7313881075339165}-{'f1_val': 0.6664333389063791, 'auprc': 0.806153273100857, 'loss_val': 0.694922319828176, 'psi': 0.7223213125841703}
[S5] START round=17 head_norm_before_train=1.717028 (no previous merge yet)
[S5] round=17 local utility u=0.701976 metrics={'f1_val': 0.89241026939069, 'auprc': 0.9923650980579197, 'loss_val': 0.15638777546000013, 'psi': 0.9323922008575818}-{'f1_val': 0.700781124122831, 'auprc': 0.9587873464098332, 'loss_val': 0.3098323764217283, 'psi': 0.8039836130376319}
[S6] START round=17 head_norm_before_train=1.580960 (no previous merge yet)
[S6] round=17 local utility u=0.299525 metrics={'f1_val': 0.6594681748177416, 'auprc': 0.9609684479463858, 'loss_val': 0.38405667472976274, 'psi': 0.7800682840691993}-{'f1_val': 0.6205594242244391, 'auprc': 0.8650037010575452, 'loss_val': 0.46176012954813006, 'psi': 0.7183371349576815}
[S7] START round=17 head_norm_before_train=1.595196 (no previous merge yet)
[S7] round=17 local utility u=0.228132 metrics={'f1_val': 0.5748711215097889, 'auprc': 0.788590346264914, 'loss_val': 0.7443118718205936, 'psi': 0.660358811411839}-{'f1_val': 0.5257680907259603, 'auprc': 0.782670970262211, 'loss_val': 0.8881996452002525, 'psi': 0.6285292425404606}
[S8] START round=17 head_norm_before_train=1.215146 cos_to_last_merge=1.0000 (last merge round=16)
[S8] round=17 local utility u=0.000000 metrics={'f1_val': 0.7139521677339791, 'auprc': 0.9925797861832379, 'loss_val': 0.4145122829265004, 'psi': 0.8254032151136826}-{'f1_val': 0.9950790219939822, 'auprc': 0.9960595333070238, 'loss_val': 0.38175785521596584, 'psi': 0.9954712265191988}
[S9] START round=17 head_norm_before_train=0.959807 cos_to_last_merge=1.0000 (last merge round=16)
[S9] round=17 local utility u=0.000000 metrics={'f1_val': 0.992684475148198, 'auprc': 0.9964120656525217, 'loss_val': 0.2050312734240895, 'psi': 0.9941755113499275}-{'f1_val': 0.9958601375429889, 'auprc': 0.9948855382807251, 'loss_val': 0.21728657302000245, 'psi': 0.9954702978380834}
[S10] START round=17 head_norm_before_train=1.423002 cos_to_last_merge=0.8680 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.868
[S10] round=17 local utility u=0.000000 metrics={'f1_val': 0.8984260633223331, 'auprc': 0.9972672521383023, 'loss_val': 0.15740767042878387, 'psi': 0.9379625388487207}-{'f1_val': 0.9931053942141469, 'auprc': 0.9968823658946409, 'loss_val': 0.16160927718193743, 'psi': 0.9946161828863445}
[S11] START round=17 head_norm_before_train=1.517835 cos_to_last_merge=0.9938 (last merge round=14)
[S11] round=17 local utility u=0.401765 metrics={'f1_val': 0.7158787812062187, 'auprc': 0.9971181015223414, 'loss_val': 0.24210653841801458, 'psi': 0.8283745093326678}-{'f1_val': 0.6636592433191282, 'auprc': 0.8974411868046732, 'loss_val': 0.4332886546691575, 'psi': 0.7571720207133462}
[S13] START round=17 head_norm_before_train=0.860573 cos_to_last_merge=1.0000 (last merge round=16)
[S13] round=17 local utility u=0.000000 metrics={'f1_val': 0.6244369469260357, 'auprc': 0.6441742639541408, 'loss_val': 0.7190007004571463, 'psi': 0.6323318737372777}-{'f1_val': 0.6271833109247867, 'auprc': 0.6309280291555643, 'loss_val': 0.6163391252524654, 'psi': 0.6286811982170978}
[S14] START round=17 head_norm_before_train=1.255771 cos_to_last_merge=1.0000 (last merge round=16)
[S14] round=17 local utility u=0.054422 metrics={'f1_val': 0.9945306928331021, 'auprc': 0.995870286838282, 'loss_val': 0.4961605664043084, 'psi': 0.9950665304351741}-{'f1_val': 0.9900205905311107, 'auprc': 0.9966208886026428, 'loss_val': 0.5801963332417589, 'psi': 0.9926607097597235}
[S15] START round=17 head_norm_before_train=1.435860 cos_to_last_merge=0.8413 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.841
[S15] round=17 local utility u=0.000000 metrics={'f1_val': 0.6573242242277776, 'auprc': 0.9640159513573592, 'loss_val': 0.3575576898099823, 'psi': 0.7800009150796103}-{'f1_val': 0.7013506818496502, 'auprc': 0.9301043127172818, 'loss_val': 0.31959721369042343, 'psi': 0.7928521341967029}
[S16] START round=17 head_norm_before_train=0.917186 cos_to_last_merge=1.0000 (last merge round=16)
[S16] round=17 local utility u=0.105718 metrics={'f1_val': 0.8832241712313356, 'auprc': 0.9756856657513098, 'loss_val': 0.5974236576501334, 'psi': 0.9202087690393252}-{'f1_val': 0.8693282350246929, 'auprc': 0.9329026616737882, 'loss_val': 0.5971348960531504, 'psi': 0.894758005684331}
[S17] START round=17 head_norm_before_train=1.049855 cos_to_last_merge=1.0000 (last merge round=16)
[S17] round=17 local utility u=0.015086 metrics={'f1_val': 0.3574058706060497, 'auprc': 0.6736155483620763, 'loss_val': 0.9245277372535173, 'psi': 0.48388974170846033}-{'f1_val': 0.35332495072624465, 'auprc': 0.6700419557850308, 'loss_val': 0.919494405638896, 'psi': 0.4800117527497591}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:37109
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:37114
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:37111
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:37104
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:37110
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:37104
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:37112
[S6] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1794 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1795) from S6
[S11] cosine check vs S6: cos=0.9517
[S4] RECEIVED delta(kind=head bytes=1799) from S14
[S4] cosine check vs S14: cos=0.9451
[S4] RECEIVED delta(kind=head bytes=1795) from S3
[S4] cosine check vs S3: cos=-0.0211
[S4] DROPPED delta from S3 (cos=-0.0211 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1800) from S11
[S14] cosine check vs S11: cos=0.3389
[S10] RECEIVED delta(kind=head bytes=1798) from S7
[S10] cosine check vs S7: cos=-0.0297
[S10] DROPPED delta from S7 (cos=-0.0297 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1799) from S2
[S8] cosine check vs S2: cos=-0.0408
[S8] DROPPED delta from S2 (cos=-0.0408 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1794) from S4
[S9] cosine check vs S4: cos=0.4199
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:37110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:37109
[S17] sending update (kind=head size=1801 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1801) from S17
[S9] cosine check vs S17: cos=0.4110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:37110
[S5] sending update (kind=head size=1802 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1802) from S5
[S9] cosine check vs S5: cos=0.8461
[S16] sending update (kind=head size=1798 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1798) from S16
[S8] cosine check vs S16: cos=0.9108
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=17 metric=0.7159 head_norm=1.551844
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.466400e-01
[S11] stored merged vector for next round verification (round=17)
[S11] DEBUG after merge:  round=17 metric=0.7158 head_norm=1.558764 delta_norm=0.246640
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=17 metric=0.7140 head_norm=1.255480
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.731322e-01
[S8] stored merged vector for next round verification (round=17)
[S8] DEBUG after merge:  round=17 metric=0.7140 head_norm=1.088511 delta_norm=0.273132
[S8] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=17 metric=0.9945 head_norm=1.282609
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.221973e-01
[S14] stored merged vector for next round verification (round=17)
[S14] DEBUG after merge:  round=17 metric=0.9334 head_norm=1.162172 delta_norm=0.822197
[S14] aggregate: ROLLBACK (f1_val pre=0.995 post=0.933 tol_abs=0.005 tol_rel=0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=17 metric=0.6660 head_norm=1.098336
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.171613e-01
[S4] stored merged vector for next round verification (round=17)
[S4] DEBUG after merge:  round=17 metric=0.6662 head_norm=1.174119 delta_norm=0.217161
[S4] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=17 metric=0.9927 head_norm=1.044915
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.101740e-01
[S9] stored merged vector for next round verification (round=17)
[S9] DEBUG after merge:  round=17 metric=0.9927 head_norm=0.890047 delta_norm=0.310174
[S9] aggregate: ACCEPT kept=['S4', 'S17', 'S5'] (k=3/3) mode=median trim_p=0.1
[S2]  timeout peer S3
[S3]  timeout peer S2
[S17] CommDone barrier timeout: have=11 need=13 — continuing
[S2] START round=18 head_norm_before_train=1.739672 (no previous merge yet)
[S2] round=18 local utility u=0.000000 metrics={'f1_val': 0.7015710590385817, 'auprc': 0.6771791884090395, 'loss_val': 0.3037441520998699, 'psi': 0.6918143107867648}-{'f1_val': 0.7015710590385817, 'auprc': 0.6761594641404969, 'loss_val': 0.29743035786846034, 'psi': 0.6914064210793478}
[S3] START round=18 head_norm_before_train=1.884036 (no previous merge yet)
[S3] round=18 local utility u=0.000000 metrics={'f1_val': 0.5811063005860508, 'auprc': 0.8210444929659819, 'loss_val': 0.7471735071828514, 'psi': 0.6770815775380232}-{'f1_val': 0.9971202529699166, 'auprc': 0.9992427030184992, 'loss_val': 0.06674444332318762, 'psi': 0.9979692329893496}
[S4] START round=18 head_norm_before_train=1.174119 cos_to_last_merge=1.0000 (last merge round=17)
[S4] round=18 local utility u=0.007531 metrics={'f1_val': 0.6637759473996631, 'auprc': 0.8291126038203115, 'loss_val': 0.6843960870839001, 'psi': 0.7299106099679225}-{'f1_val': 0.666048287591563, 'auprc': 0.8293978374474467, 'loss_val': 0.7139476796878866, 'psi': 0.7313881075339165}
[S5] START round=18 head_norm_before_train=1.730477 (no previous merge yet)
[S5] round=18 local utility u=0.000000 metrics={'f1_val': 0.7007401102601454, 'auprc': 0.9751612234921208, 'loss_val': 0.2548121440543994, 'psi': 0.8105085555529356}-{'f1_val': 0.89241026939069, 'auprc': 0.9923650980579197, 'loss_val': 0.15638777546000013, 'psi': 0.9323922008575818}
[S6] START round=18 head_norm_before_train=1.604036 (no previous merge yet)
[S6] round=18 local utility u=0.000000 metrics={'f1_val': 0.6428482571415038, 'auprc': 0.8225338824586187, 'loss_val': 0.4794484870812802, 'psi': 0.7147225072683498}-{'f1_val': 0.6594681748177416, 'auprc': 0.9609684479463858, 'loss_val': 0.38405667472976274, 'psi': 0.7800682840691993}
[S7] START round=18 head_norm_before_train=1.611816 (no previous merge yet)
[S7] round=18 local utility u=0.000000 metrics={'f1_val': 0.5187069137018512, 'auprc': 0.7817324367752905, 'loss_val': 0.9305532648583319, 'psi': 0.6239171229312269}-{'f1_val': 0.5748711215097889, 'auprc': 0.788590346264914, 'loss_val': 0.7443118718205936, 'psi': 0.660358811411839}
[S8] START round=18 head_norm_before_train=1.088511 cos_to_last_merge=1.0000 (last merge round=17)
[S8] round=18 local utility u=0.895481 metrics={'f1_val': 0.9954543001490541, 'auprc': 0.9963173484726946, 'loss_val': 0.3237748274637143, 'psi': 0.9957995194785103}-{'f1_val': 0.7139521677339791, 'auprc': 0.9925797861832379, 'loss_val': 0.4145122829265004, 'psi': 0.8254032151136826}
[S9] START round=18 head_norm_before_train=0.890047 cos_to_last_merge=1.0000 (last merge round=17)
[S9] round=18 local utility u=0.003396 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9930753697224239, 'loss_val': 0.21474017240844662, 'psi': 0.9954918953962553}-{'f1_val': 0.992684475148198, 'auprc': 0.9964120656525217, 'loss_val': 0.2050312734240895, 'psi': 0.9941755113499275}
[S10] START round=18 head_norm_before_train=1.446950 cos_to_last_merge=0.8635 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.863
[S10] round=18 local utility u=0.296289 metrics={'f1_val': 0.9957455607450773, 'auprc': 0.9963803349271984, 'loss_val': 0.1460864930536018, 'psi': 0.9959994704179256}-{'f1_val': 0.8984260633223331, 'auprc': 0.9972672521383023, 'loss_val': 0.15740767042878387, 'psi': 0.9379625388487207}
[S11] START round=18 head_norm_before_train=1.558764 cos_to_last_merge=1.0000 (last merge round=17)
[S11] round=18 local utility u=0.710764 metrics={'f1_val': 0.9586289662770681, 'auprc': 0.996857468910961, 'loss_val': 0.27629701978690285, 'psi': 0.9739203673306253}-{'f1_val': 0.7158787812062187, 'auprc': 0.9971181015223414, 'loss_val': 0.24210653841801458, 'psi': 0.8283745093326678}
[S13] START round=18 head_norm_before_train=0.902375 cos_to_last_merge=0.9963 (last merge round=16)
[S13] round=18 local utility u=0.008007 metrics={'f1_val': 0.6240335401121683, 'auprc': 0.6313759568620966, 'loss_val': 0.662170839938405, 'psi': 0.6269705068121396}-{'f1_val': 0.6244369469260357, 'auprc': 0.6441742639541408, 'loss_val': 0.7190007004571463, 'psi': 0.6323318737372777}
[S14] START round=18 head_norm_before_train=1.162172 cos_to_last_merge=1.0000 (last merge round=17)
[S14] round=18 local utility u=0.000000 metrics={'f1_val': 0.9426505205321358, 'auprc': 0.9946692209464774, 'loss_val': 0.5755946334074641, 'psi': 0.9634580006978725}-{'f1_val': 0.9945306928331021, 'auprc': 0.995870286838282, 'loss_val': 0.4961605664043084, 'psi': 0.9950665304351741}
[S15] START round=18 head_norm_before_train=1.463554 cos_to_last_merge=0.8357 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.836
[S15] round=18 local utility u=0.000000 metrics={'f1_val': 0.6941725628942234, 'auprc': 0.8289013695965379, 'loss_val': 0.35327766555385165, 'psi': 0.7480640855751493}-{'f1_val': 0.6573242242277776, 'auprc': 0.9640159513573592, 'loss_val': 0.3575576898099823, 'psi': 0.7800009150796103}
[S16] START round=18 head_norm_before_train=0.970920 cos_to_last_merge=0.9967 (last merge round=16)
[S16] round=18 local utility u=0.000000 metrics={'f1_val': 0.8592638143131919, 'auprc': 0.9861999201410028, 'loss_val': 0.5683922413008607, 'psi': 0.9100382566443161}-{'f1_val': 0.8832241712313356, 'auprc': 0.9756856657513098, 'loss_val': 0.5974236576501334, 'psi': 0.9202087690393252}
[S17] START round=18 head_norm_before_train=1.081837 cos_to_last_merge=0.9969 (last merge round=16)
[S17] round=18 local utility u=0.000000 metrics={'f1_val': 0.35332541874877144, 'auprc': 0.6812928153441078, 'loss_val': 0.9267037869816516, 'psi': 0.484512377386906}-{'f1_val': 0.3574058706060497, 'auprc': 0.6736155483620763, 'loss_val': 0.9245277372535173, 'psi': 0.48388974170846033}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:37110
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:37107
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:37105
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] → sending delta(kind=head bytes=1805) to S7@127.0.0.1:37108
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:37114
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:37116
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1805 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1805) from S10
[S7] cosine check vs S10: cos=-0.0296
[S7] DROPPED delta from S10 (cos=-0.0296 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1799) from S13
[S9] cosine check vs S13: cos=0.8178
[S16] RECEIVED delta(kind=head bytes=1803) from S8
[S16] cosine check vs S8: cos=0.9621
[S5] RECEIVED delta(kind=head bytes=1801) from S9
[S5] cosine check vs S9: cos=0.7555
[S6] RECEIVED delta(kind=head bytes=1800) from S11
[S6] cosine check vs S11: cos=0.9814
[S14] RECEIVED delta(kind=head bytes=1802) from S4
[S14] cosine check vs S4: cos=0.8221
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=18 metric=0.7007 head_norm=1.736694
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.934101e-01
[S5] stored merged vector for next round verification (round=18)
[S5] DEBUG after merge:  round=18 metric=0.7007 head_norm=1.277038 delta_norm=0.593410
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=18 metric=0.9427 head_norm=1.186109
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.566467e-01
[S14] stored merged vector for next round verification (round=18)
[S14] DEBUG after merge:  round=18 metric=0.9919 head_norm=1.141134 delta_norm=0.356647
[S14] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=18 metric=0.6428 head_norm=1.624994
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.560087e-01
[S6] stored merged vector for next round verification (round=18)
[S6] DEBUG after merge:  round=18 metric=0.6200 head_norm=1.598210 delta_norm=0.156009
[S6] aggregate: ROLLBACK (f1_val pre=0.643 post=0.620 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=18 metric=0.9971 head_norm=0.974586
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.918785e-01
[S9] stored merged vector for next round verification (round=18)
[S9] DEBUG after merge:  round=18 metric=0.9967 head_norm=0.921575 delta_norm=0.291878
[S9] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=18 metric=0.8593 head_norm=1.034478
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.570670e-01
[S16] stored merged vector for next round verification (round=18)
[S16] DEBUG after merge:  round=18 metric=0.8577 head_norm=1.073832 delta_norm=0.157067
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.756416 (no previous merge yet)
[S2] round=19 local utility u=0.000000 metrics={'f1_val': 0.7015710590385817, 'auprc': 0.6815888217760229, 'loss_val': 0.3571078386726812, 'psi': 0.6935781641335581}-{'f1_val': 0.7015710590385817, 'auprc': 0.6771791884090395, 'loss_val': 0.3037441520998699, 'psi': 0.6918143107867648}
[S3] START round=19 head_norm_before_train=1.885829 (no previous merge yet)
[S3] round=19 local utility u=1.000000 metrics={'f1_val': 0.997942446405337, 'auprc': 0.9993798904968482, 'loss_val': 0.06628179206724813, 'psi': 0.9985174240419414}-{'f1_val': 0.5811063005860508, 'auprc': 0.8210444929659819, 'loss_val': 0.7471735071828514, 'psi': 0.6770815775380232}
[S4] START round=19 head_norm_before_train=1.204952 cos_to_last_merge=0.9967 (last merge round=17)
[S4] round=19 local utility u=0.000000 metrics={'f1_val': 0.622160498303932, 'auprc': 0.8096839879164637, 'loss_val': 0.5880562504417304, 'psi': 0.6971698941489447}-{'f1_val': 0.6637759473996631, 'auprc': 0.8291126038203115, 'loss_val': 0.6843960870839001, 'psi': 0.7299106099679225}
[S5] START round=19 head_norm_before_train=1.277038 cos_to_last_merge=1.0000 (last merge round=18)
[S5] round=19 local utility u=0.049224 metrics={'f1_val': 0.7020948624369353, 'auprc': 0.9909333837028111, 'loss_val': 0.21180962630454078, 'psi': 0.8176302709432857}-{'f1_val': 0.7007401102601454, 'auprc': 0.9751612234921208, 'loss_val': 0.2548121440543994, 'psi': 0.8105085555529356}
[S6] START round=19 head_norm_before_train=1.598210 cos_to_last_merge=1.0000 (last merge round=18)
[S6] round=19 local utility u=0.000000 metrics={'f1_val': 0.6025054410956723, 'auprc': 0.8196237595904514, 'loss_val': 0.5349152651920629, 'psi': 0.689352768493584}-{'f1_val': 0.6428482571415038, 'auprc': 0.8225338824586187, 'loss_val': 0.4794484870812802, 'psi': 0.7147225072683498}
[S7] START round=19 head_norm_before_train=1.632797 (no previous merge yet)
[S7] round=19 local utility u=0.508475 metrics={'f1_val': 0.6268303895063654, 'auprc': 0.7947378412621782, 'loss_val': 0.6013594582146525, 'psi': 0.6939933702086905}-{'f1_val': 0.5187069137018512, 'auprc': 0.7817324367752905, 'loss_val': 0.9305532648583319, 'psi': 0.6239171229312269}
[S8] START round=19 head_norm_before_train=1.133765 cos_to_last_merge=0.9970 (last merge round=17)
[S8] round=19 local utility u=0.049575 metrics={'f1_val': 0.9958331535970073, 'auprc': 0.9968046432738679, 'loss_val': 0.22835895015714086, 'psi': 0.9962217494677514}-{'f1_val': 0.9954543001490541, 'auprc': 0.9963173484726946, 'loss_val': 0.3237748274637143, 'psi': 0.9957995194785103}
[S9] START round=19 head_norm_before_train=0.921575 cos_to_last_merge=1.0000 (last merge round=18)
[S9] round=19 local utility u=0.028088 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.991537418245969, 'loss_val': 0.1514879314060944, 'psi': 0.9946304620572449}-{'f1_val': 0.9971029125121428, 'auprc': 0.9930753697224239, 'loss_val': 0.21474017240844662, 'psi': 0.9954918953962553}
[S10] START round=19 head_norm_before_train=1.465706 cos_to_last_merge=0.8598 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.860
[S10] round=19 local utility u=0.002159 metrics={'f1_val': 0.9943563983784213, 'auprc': 0.9931844150545887, 'loss_val': 0.12384654506114037, 'psi': 0.9938876050488883}-{'f1_val': 0.9957455607450773, 'auprc': 0.9963803349271984, 'loss_val': 0.1460864930536018, 'psi': 0.9959994704179256}
[S11] START round=19 head_norm_before_train=1.586387 cos_to_last_merge=0.9992 (last merge round=17)
[S11] round=19 local utility u=0.000000 metrics={'f1_val': 0.9526161316981104, 'auprc': 0.993290492333506, 'loss_val': 0.25957154746419786, 'psi': 0.9688858759522687}-{'f1_val': 0.9586289662770681, 'auprc': 0.996857468910961, 'loss_val': 0.27629701978690285, 'psi': 0.9739203673306253}
[S13] START round=19 head_norm_before_train=0.958733 cos_to_last_merge=0.9854 (last merge round=16)
[S13] round=19 local utility u=0.034387 metrics={'f1_val': 0.6287130644438084, 'auprc': 0.6274210974111332, 'loss_val': 0.6096093403817806, 'psi': 0.6281962776307383}-{'f1_val': 0.6240335401121683, 'auprc': 0.6313759568620966, 'loss_val': 0.662170839938405, 'psi': 0.6269705068121396}
[S14] START round=19 head_norm_before_train=1.141134 cos_to_last_merge=1.0000 (last merge round=18)
[S14] round=19 local utility u=0.000000 metrics={'f1_val': 0.9016602241093103, 'auprc': 0.9945569669037496, 'loss_val': 0.47382535481820715, 'psi': 0.938818921227086}-{'f1_val': 0.9426505205321358, 'auprc': 0.9946692209464774, 'loss_val': 0.5755946334074641, 'psi': 0.9634580006978725}
[S15] START round=19 head_norm_before_train=1.491983 cos_to_last_merge=0.8308 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.831
[S15] round=19 local utility u=0.294602 metrics={'f1_val': 0.6984178662921909, 'auprc': 0.984764039753412, 'loss_val': 0.25713404553981534, 'psi': 0.8129563356766794}-{'f1_val': 0.6941725628942234, 'auprc': 0.8289013695965379, 'loss_val': 0.35327766555385165, 'psi': 0.7480640855751493}
[S16] START round=19 head_norm_before_train=1.073832 cos_to_last_merge=1.0000 (last merge round=18)
[S16] round=19 local utility u=0.516443 metrics={'f1_val': 0.9856720946251727, 'auprc': 0.9857707263692013, 'loss_val': 0.29266932043684607, 'psi': 0.9857115473227842}-{'f1_val': 0.8592638143131919, 'auprc': 0.9861999201410028, 'loss_val': 0.5683922413008607, 'psi': 0.9100382566443161}
[S17] START round=19 head_norm_before_train=1.115721 cos_to_last_merge=0.9898 (last merge round=16)
[S17] round=19 local utility u=0.000000 metrics={'f1_val': 0.3531271498023416, 'auprc': 0.6748718851032716, 'loss_val': 0.9366029983615343, 'psi': 0.48182504392271364}-{'f1_val': 0.35332541874877144, 'auprc': 0.6812928153441078, 'loss_val': 0.9267037869816516, 'psi': 0.484512377386906}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:37108
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S7] sending update (kind=head size=1793 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:37116
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:37110
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:37115
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:37105
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1801) from S8
[S16] cosine check vs S8: cos=0.9797
[S7] RECEIVED delta(kind=head bytes=1796) from S10
[S7] cosine check vs S10: cos=-0.0299
[S7] DROPPED delta from S10 (cos=-0.0299 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1796) from S13
[S9] cosine check vs S13: cos=0.9205
[S15] RECEIVED delta(kind=head bytes=1799) from S16
[S15] cosine check vs S16: cos=0.7933
[S5] RECEIVED delta(kind=head bytes=1799) from S9
[S5] cosine check vs S9: cos=0.8263
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=20 psi=0.694 u=0.0000 p_local=0.0491 f1=0.702 auprc=0.682 bytes=14342
[S3] r=20 psi=0.999 u=1.0000 p_local=0.4309 f1=0.998 auprc=0.999 bytes=19775
[S14] r=20 psi=0.939 u=0.0000 p_local=0.1503 f1=0.902 auprc=0.995 bytes=17956
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=19 metric=0.7021 head_norm=1.303694
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.682255e-01
[S5] stored merged vector for next round verification (round=19)
[S5] DEBUG after merge:  round=19 metric=0.7021 head_norm=1.111874 delta_norm=0.368226
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S5] r=20 psi=0.818 u=0.0492 p_local=0.2679 f1=0.702 auprc=0.991 bytes=19817
[S4] r=20 psi=0.697 u=0.0000 p_local=0.0705 f1=0.622 auprc=0.810 bytes=17937
[S11] r=20 psi=0.969 u=0.0000 p_local=0.2277 f1=0.953 auprc=0.993 bytes=16192
[S6] r=20 psi=0.689 u=0.0000 p_local=0.2195 f1=0.603 auprc=0.820 bytes=14374
[S7] r=20 psi=0.694 u=0.5085 p_local=0.2208 f1=0.627 auprc=0.795 bytes=16142
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=19 metric=0.9967 head_norm=1.021808
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.033358e-01
[S9] stored merged vector for next round verification (round=19)
[S9] DEBUG after merge:  round=19 metric=0.9967 head_norm=0.999513 delta_norm=0.203336
[S9] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S9] r=20 psi=0.995 u=0.0281 p_local=0.0761 f1=0.997 auprc=0.992 bytes=17967
[S10] r=20 psi=0.994 u=0.0022 p_local=0.1624 f1=0.994 auprc=0.993 bytes=23377
[S13] r=20 psi=0.628 u=0.0344 p_local=0.0832 f1=0.629 auprc=0.627 bytes=17963
[S8] r=20 psi=0.996 u=0.0496 p_local=0.3709 f1=0.996 auprc=0.997 bytes=19770
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=19 metric=0.9857 head_norm=1.138242
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.199451e-01
[S16] stored merged vector for next round verification (round=19)
[S16] DEBUG after merge:  round=19 metric=0.9837 head_norm=1.157682 delta_norm=0.119945
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S16] r=20 psi=0.986 u=0.5164 p_local=0.3025 f1=0.986 auprc=0.986 bytes=19735
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=19 metric=0.6984 head_norm=1.519371
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.637521e-01
[S15] stored merged vector for next round verification (round=19)
[S15] DEBUG after merge:  round=19 metric=0.6989 head_norm=1.259752 delta_norm=0.463752
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S15] r=20 psi=0.813 u=0.2946 p_local=0.1521 f1=0.698 auprc=0.985 bytes=16185
[S17] r=20 psi=0.482 u=0.0000 p_local=0.0423 f1=0.353 auprc=0.675 bytes=17980
[S2] START round=20 head_norm_before_train=1.772171 (no previous merge yet)
[S2] round=20 local utility u=0.000000 metrics={'f1_val': 0.6714576409126924, 'auprc': 0.6704705889887486, 'loss_val': 0.4466611638547682, 'psi': 0.6710628201431148}-{'f1_val': 0.7015710590385817, 'auprc': 0.6815888217760229, 'loss_val': 0.3571078386726812, 'psi': 0.6935781641335581}
[S3] START round=20 head_norm_before_train=1.887693 (no previous merge yet)
[S3] round=20 local utility u=0.000000 metrics={'f1_val': 0.9246169970991421, 'auprc': 0.9997832158053059, 'loss_val': 0.1472587525907607, 'psi': 0.9546834845816077}-{'f1_val': 0.997942446405337, 'auprc': 0.9993798904968482, 'loss_val': 0.06628179206724813, 'psi': 0.9985174240419414}
[S4] START round=20 head_norm_before_train=1.241290 cos_to_last_merge=0.9887 (last merge round=17)
[S4] round=20 local utility u=0.156204 metrics={'f1_val': 0.620354854581962, 'auprc': 0.9010217252905077, 'loss_val': 0.5388284592695668, 'psi': 0.7326216028653804}-{'f1_val': 0.622160498303932, 'auprc': 0.8096839879164637, 'loss_val': 0.5880562504417304, 'psi': 0.6971698941489447}
[S5] START round=20 head_norm_before_train=1.111874 cos_to_last_merge=1.0000 (last merge round=19)
[S5] round=20 local utility u=0.649859 metrics={'f1_val': 0.9188435207903302, 'auprc': 0.993882383883727, 'loss_val': 0.2214298610851334, 'psi': 0.9488590660276888}-{'f1_val': 0.7020948624369353, 'auprc': 0.9909333837028111, 'loss_val': 0.21180962630454078, 'psi': 0.8176302709432857}
[S6] START round=20 head_norm_before_train=1.621608 cos_to_last_merge=0.9998 (last merge round=18)
[S6] round=20 local utility u=0.947989 metrics={'f1_val': 0.8198238476835547, 'auprc': 0.9612599655892642, 'loss_val': 0.36775694507623213, 'psi': 0.8763982948458384}-{'f1_val': 0.6025054410956723, 'auprc': 0.8196237595904514, 'loss_val': 0.5349152651920629, 'psi': 0.689352768493584}
[S7] START round=20 head_norm_before_train=1.648743 (no previous merge yet)
[S7] round=20 local utility u=0.078252 metrics={'f1_val': 0.6393197095353584, 'auprc': 0.7989882878110345, 'loss_val': 0.5325420048206672, 'psi': 0.7031871408456288}-{'f1_val': 0.6268303895063654, 'auprc': 0.7947378412621782, 'loss_val': 0.6013594582146525, 'psi': 0.6939933702086905}
[S8] START round=20 head_norm_before_train=1.188962 cos_to_last_merge=0.9895 (last merge round=17)
[S8] round=20 local utility u=0.019260 metrics={'f1_val': 0.9950790219939822, 'auprc': 0.9966618239721001, 'loss_val': 0.18488619018142305, 'psi': 0.9957121427852293}-{'f1_val': 0.9958331535970073, 'auprc': 0.9968046432738679, 'loss_val': 0.22835895015714086, 'psi': 0.9962217494677514}
[S9] START round=20 head_norm_before_train=0.999513 cos_to_last_merge=1.0000 (last merge round=19)
[S9] round=20 local utility u=0.016466 metrics={'f1_val': 0.9966891482978385, 'auprc': 0.9956874630386606, 'loss_val': 0.1309857330306979, 'psi': 0.9962884741941673}-{'f1_val': 0.9966924912647621, 'auprc': 0.991537418245969, 'loss_val': 0.1514879314060944, 'psi': 0.9946304620572449}
[S10] START round=20 head_norm_before_train=1.482915 cos_to_last_merge=0.8562 (last merge round=1)
[S10] ⚠️ Model drifted since last merge! cos=0.856
[S10] round=20 local utility u=0.020066 metrics={'f1_val': 0.9949085473053089, 'auprc': 0.9966324138294924, 'loss_val': 0.09737160720592984, 'psi': 0.9955980939149822}-{'f1_val': 0.9943563983784213, 'auprc': 0.9931844150545887, 'loss_val': 0.12384654506114037, 'psi': 0.9938876050488883}
[S11] START round=20 head_norm_before_train=1.618903 cos_to_last_merge=0.9971 (last merge round=17)
[S11] round=20 local utility u=0.129903 metrics={'f1_val': 0.9832825108341007, 'auprc': 0.9973631767593439, 'loss_val': 0.195982572730586, 'psi': 0.988914777204198}-{'f1_val': 0.9526161316981104, 'auprc': 0.993290492333506, 'loss_val': 0.25957154746419786, 'psi': 0.9688858759522687}
[S13] START round=20 head_norm_before_train=1.018161 cos_to_last_merge=0.9714 (last merge round=16)
[S13] round=20 local utility u=0.037184 metrics={'f1_val': 0.6349674706593584, 'auprc': 0.6285859157928692, 'loss_val': 0.5762614260008857, 'psi': 0.6324148487127628}-{'f1_val': 0.6287130644438084, 'auprc': 0.6274210974111332, 'loss_val': 0.6096093403817806, 'psi': 0.6281962776307383}
[S14] START round=20 head_norm_before_train=1.175077 cos_to_last_merge=0.9982 (last merge round=18)
[S14] round=20 local utility u=0.367506 metrics={'f1_val': 0.9952912607493203, 'auprc': 0.9952686264299868, 'loss_val': 0.3027341687885414, 'psi': 0.995282207021587}-{'f1_val': 0.9016602241093103, 'auprc': 0.9945569669037496, 'loss_val': 0.47382535481820715, 'psi': 0.938818921227086}
[S15] START round=20 head_norm_before_train=1.259752 cos_to_last_merge=1.0000 (last merge round=19)
[S15] round=20 local utility u=0.000000 metrics={'f1_val': 0.6940459477794668, 'auprc': 0.8002478853364583, 'loss_val': 0.42452932684780875, 'psi': 0.7365267228022634}-{'f1_val': 0.6984178662921909, 'auprc': 0.984764039753412, 'loss_val': 0.25713404553981534, 'psi': 0.8129563356766794}
[S16] START round=20 head_norm_before_train=1.157682 cos_to_last_merge=1.0000 (last merge round=19)
[S16] round=20 local utility u=0.000000 metrics={'f1_val': 0.9253841651181732, 'auprc': 0.9914851560928695, 'loss_val': 0.353562353065793, 'psi': 0.9518245615080517}-{'f1_val': 0.9856720946251727, 'auprc': 0.9857707263692013, 'loss_val': 0.29266932043684607, 'psi': 0.9857115473227842}
[S17] START round=20 head_norm_before_train=1.146206 cos_to_last_merge=0.9832 (last merge round=16)
[S17] round=20 local utility u=0.108101 metrics={'f1_val': 0.39497893560262576, 'auprc': 0.670546601873295, 'loss_val': 0.9585359906391878, 'psi': 0.5052060021108935}-{'f1_val': 0.3531271498023416, 'auprc': 0.6748718851032716, 'loss_val': 0.9366029983615343, 'psi': 0.48182504392271364}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:37105
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:37111
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:37108
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:37107
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:37114
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:37116
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:37110
[S13] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1795 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1801) from S10
[S7] cosine check vs S10: cos=-0.0302
[S7] DROPPED delta from S10 (cos=-0.0302 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1799) from S11
[S6] cosine check vs S11: cos=0.9857
[S16] RECEIVED delta(kind=head bytes=1798) from S8
[S16] cosine check vs S8: cos=0.9862
[S14] RECEIVED delta(kind=head bytes=1796) from S4
[S14] cosine check vs S4: cos=0.9430
[S9] RECEIVED delta(kind=head bytes=1800) from S13
[S9] cosine check vs S13: cos=0.9547
[S10] RECEIVED delta(kind=head bytes=1795) from S14
[S10] cosine check vs S14: cos=0.8082
[S5] RECEIVED delta(kind=head bytes=1798) from S9
[S5] cosine check vs S9: cos=0.8913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] → sending delta(kind=head bytes=1805) to S8@127.0.0.1:37109
[S17] sending update (kind=head size=1805 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1805) from S17
[S8] cosine check vs S17: cos=0.9091
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=20 metric=0.8198 head_norm=1.641241
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.390478e-01
[S6] stored merged vector for next round verification (round=20)
[S6] DEBUG after merge:  round=20 metric=0.7776 head_norm=1.639784 delta_norm=0.139048
[S6] aggregate: ROLLBACK (f1_val pre=0.820 post=0.778 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=20 metric=0.9188 head_norm=1.156502
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.634276e-01
[S5] stored merged vector for next round verification (round=20)
[S5] DEBUG after merge:  round=20 metric=0.9535 head_norm=1.088550 delta_norm=0.263428
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=20 metric=0.9254 head_norm=1.214475
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.027112e-01
[S16] stored merged vector for next round verification (round=20)
[S16] DEBUG after merge:  round=20 metric=0.9227 head_norm=1.222702 delta_norm=0.102711
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.242 → S15@127.0.0.1:37115
[S13] ⇄ pheromone p=0.074 → S9@127.0.0.1:37110
[S4] ⇄ pheromone p=0.088 → S14@127.0.0.1:37114
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=20 metric=0.9951 head_norm=1.239415
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.590661e-01
[S8] stored merged vector for next round verification (round=20)
[S8] DEBUG after merge:  round=20 metric=0.9951 head_norm=1.176757 delta_norm=0.259066
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.301 → S16@127.0.0.1:37116
[S11] ⇄ pheromone p=0.208 → S6@127.0.0.1:37107
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=20 metric=0.9949 head_norm=1.503351
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.426635e-01
[S10] stored merged vector for next round verification (round=20)
[S10] DEBUG after merge:  round=20 metric=0.9949 head_norm=1.292624 delta_norm=0.442663
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.134 → S7@127.0.0.1:37108
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=20 metric=0.9967 head_norm=1.082209
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.624198e-01
[S9] stored merged vector for next round verification (round=20)
[S9] DEBUG after merge:  round=20 metric=0.9967 head_norm=1.066491 delta_norm=0.162420
[S9] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.064 → S5@127.0.0.1:37105
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=20 metric=0.9953 head_norm=1.213916
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.130040e-01
[S14] stored merged vector for next round verification (round=20)
[S14] DEBUG after merge:  round=20 metric=0.9950 head_norm=1.229270 delta_norm=0.213004
[S14] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.194 → S10@127.0.0.1:37111
[S17] ⇄ pheromone p=0.055 → S8@127.0.0.1:37109
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S14
[S16]  timeout peer S17
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S6]  timeout peer S17
[S8]  timeout peer S3
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S4]  timeout peer S2
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S5]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S16
[S14]  timeout peer S17
[S2] START round=21 head_norm_before_train=1.786814 (no previous merge yet)
[S2] round=21 local utility u=0.143062 metrics={'f1_val': 0.7015710590385817, 'auprc': 0.6839538276463828, 'loss_val': 0.38166679114143603, 'psi': 0.6945241664817021}-{'f1_val': 0.6714576409126924, 'auprc': 0.6704705889887486, 'loss_val': 0.4466611638547682, 'psi': 0.6710628201431148}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=21 head_norm_before_train=1.898657 (no previous merge yet)
[S3] round=21 local utility u=0.146741 metrics={'f1_val': 0.9620012470396173, 'auprc': 0.9998173410064188, 'loss_val': 0.07818381776965817, 'psi': 0.9771276846263379}-{'f1_val': 0.9246169970991421, 'auprc': 0.9997832158053059, 'loss_val': 0.1472587525907607, 'psi': 0.9546834845816077}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=21 head_norm_before_train=1.280374 cos_to_last_merge=0.9794 (last merge round=17)
[S4] round=21 local utility u=1.000000 metrics={'f1_val': 0.9443938990852412, 'auprc': 0.9246921979111864, 'loss_val': 0.5004580653670077, 'psi': 0.9365132186156193}-{'f1_val': 0.620354854581962, 'auprc': 0.9010217252905077, 'loss_val': 0.5388284592695668, 'psi': 0.7326216028653804}
[S5] START round=21 head_norm_before_train=1.088550 cos_to_last_merge=1.0000 (last merge round=20)
[S5] round=21 local utility u=0.000000 metrics={'f1_val': 0.7009022086989503, 'auprc': 0.9895101106927728, 'loss_val': 0.28797890334515186, 'psi': 0.8163453694964793}-{'f1_val': 0.9188435207903302, 'auprc': 0.993882383883727, 'loss_val': 0.2214298610851334, 'psi': 0.9488590660276888}
[S6] START round=21 head_norm_before_train=1.639784 cos_to_last_merge=1.0000 (last merge round=20)
[S6] round=21 local utility u=0.509573 metrics={'f1_val': 0.9625923386854474, 'auprc': 0.9772453937246768, 'loss_val': 0.2531778347552633, 'psi': 0.9684535607011391}-{'f1_val': 0.8198238476835547, 'auprc': 0.9612599655892642, 'loss_val': 0.36775694507623213, 'psi': 0.8763982948458384}
[S7] START round=21 head_norm_before_train=1.663709 (no previous merge yet)
[S7] round=21 local utility u=0.000000 metrics={'f1_val': 0.5521301668242024, 'auprc': 0.7875991529378006, 'loss_val': 0.8255863003511946, 'psi': 0.6463177612696417}-{'f1_val': 0.6393197095353584, 'auprc': 0.7989882878110345, 'loss_val': 0.5325420048206672, 'psi': 0.7031871408456288}
[S8] START round=21 head_norm_before_train=1.176757 cos_to_last_merge=1.0000 (last merge round=20)
[S8] round=21 local utility u=0.014163 metrics={'f1_val': 0.9947267123181514, 'auprc': 0.9977608981482503, 'loss_val': 0.15774372670571526, 'psi': 0.995940386650191}-{'f1_val': 0.9950790219939822, 'auprc': 0.9966618239721001, 'loss_val': 0.18488619018142305, 'psi': 0.9957121427852293}
[S9] START round=21 head_norm_before_train=1.066491 cos_to_last_merge=1.0000 (last merge round=20)
[S9] round=21 local utility u=0.003612 metrics={'f1_val': 0.9956054446615002, 'auprc': 0.9982427868272032, 'loss_val': 0.12492627778391205, 'psi': 0.9966603815277815}-{'f1_val': 0.9966891482978385, 'auprc': 0.9956874630386606, 'loss_val': 0.1309857330306979, 'psi': 0.9962884741941673}
[S10] START round=21 head_norm_before_train=1.292624 cos_to_last_merge=1.0000 (last merge round=20)
[S10] round=21 local utility u=0.000000 metrics={'f1_val': 0.9949255377402499, 'auprc': 0.9964780727594466, 'loss_val': 0.1298537999815216, 'psi': 0.9955465517479286}-{'f1_val': 0.9949085473053089, 'auprc': 0.9966324138294924, 'loss_val': 0.09737160720592984, 'psi': 0.9955980939149822}
[S11] START round=21 head_norm_before_train=1.650084 cos_to_last_merge=0.9945 (last merge round=17)
[S11] round=21 local utility u=0.060000 metrics={'f1_val': 0.9941837409618036, 'auprc': 0.9975258365280737, 'loss_val': 0.1418786845661139, 'psi': 0.9955205791883116}-{'f1_val': 0.9832825108341007, 'auprc': 0.9973631767593439, 'loss_val': 0.195982572730586, 'psi': 0.988914777204198}
[S13] START round=21 head_norm_before_train=1.075357 cos_to_last_merge=0.9572 (last merge round=16)
[S13] round=21 local utility u=0.059060 metrics={'f1_val': 0.6538315243107005, 'auprc': 0.6237499719293755, 'loss_val': 0.5568174407006675, 'psi': 0.6417989033581705}-{'f1_val': 0.6349674706593584, 'auprc': 0.6285859157928692, 'loss_val': 0.5762614260008857, 'psi': 0.6324148487127628}
[S14] START round=21 head_norm_before_train=1.229270 cos_to_last_merge=1.0000 (last merge round=20)
[S14] round=21 local utility u=0.000000 metrics={'f1_val': 0.9004273879816828, 'auprc': 0.9873301264586469, 'loss_val': 0.3863822756766235, 'psi': 0.9351884833724684}-{'f1_val': 0.9952912607493203, 'auprc': 0.9952686264299868, 'loss_val': 0.3027341687885414, 'psi': 0.995282207021587}
[S15] START round=21 head_norm_before_train=1.294823 cos_to_last_merge=0.9997 (last merge round=19)
[S15] round=21 local utility u=0.334490 metrics={'f1_val': 0.6960551136380773, 'auprc': 0.9758246653224102, 'loss_val': 0.2943345219455488, 'psi': 0.8079629343118104}-{'f1_val': 0.6940459477794668, 'auprc': 0.8002478853364583, 'loss_val': 0.42452932684780875, 'psi': 0.7365267228022634}
[S16] START round=21 head_norm_before_train=1.222702 cos_to_last_merge=1.0000 (last merge round=20)
[S16] round=21 local utility u=0.262362 metrics={'f1_val': 0.9880619355929956, 'auprc': 0.988924334360868, 'loss_val': 0.19722248983749274, 'psi': 0.9884068951001446}-{'f1_val': 0.9253841651181732, 'auprc': 0.9914851560928695, 'loss_val': 0.353562353065793, 'psi': 0.9518245615080517}
[S17] START round=21 head_norm_before_train=1.169443 cos_to_last_merge=0.9776 (last merge round=16)
[S17] round=21 local utility u=0.000000 metrics={'f1_val': 0.3585435707493499, 'auprc': 0.6622099323000993, 'loss_val': 0.9534420613047209, 'psi': 0.48001011536964966}-{'f1_val': 0.39497893560262576, 'auprc': 0.670546601873295, 'loss_val': 0.9585359906391878, 'psi': 0.5052060021108935}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:37107
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:37110
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:37116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:37112
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1799 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1793 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:37114
[S13] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1793) from S15
[S16] cosine check vs S15: cos=0.9262
[S9] RECEIVED delta(kind=head bytes=1800) from S13
[S9] cosine check vs S13: cos=0.9716
[S6] RECEIVED delta(kind=head bytes=1796) from S11
[S6] cosine check vs S11: cos=0.9936
[S11] RECEIVED delta(kind=head bytes=1799) from S6
[S11] cosine check vs S6: cos=0.9936
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=21 metric=0.9942 head_norm=1.681662
[S11] _apply_head_vector_avg (torch): Δ‖w‖=9.540842e-02
[S11] stored merged vector for next round verification (round=21)
[S11] DEBUG after merge:  round=21 metric=0.9950 head_norm=1.667030 delta_norm=0.095408
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S4] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:37116
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=21 metric=0.9626 head_norm=1.657768
[S6] _apply_head_vector_avg (torch): Δ‖w‖=9.540842e-02
[S6] stored merged vector for next round verification (round=21)
[S6] DEBUG after merge:  round=21 metric=0.9626 head_norm=1.667030 delta_norm=0.095408
[S6] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:37109
[S14] RECEIVED delta(kind=head bytes=1798) from S4
[S14] cosine check vs S4: cos=0.9801
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1798) from S16
[S8] cosine check vs S16: cos=0.9679
[S16] RECEIVED delta(kind=head bytes=1801) from S8
[S16] cosine check vs S8: cos=0.9679
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=21 metric=0.9004 head_norm=1.268016
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.309191e-01
[S14] stored merged vector for next round verification (round=21)
[S14] DEBUG after merge:  round=21 metric=0.9083 head_norm=1.284955 delta_norm=0.130919
[S14] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=21 metric=0.9947 head_norm=1.217940
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.598293e-01
[S8] stored merged vector for next round verification (round=21)
[S8] DEBUG after merge:  round=21 metric=0.9947 head_norm=1.234718 delta_norm=0.159829
[S8] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=21 metric=0.9881 head_norm=1.271523
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.376244e-01
[S16] stored merged vector for next round verification (round=21)
[S16] DEBUG after merge:  round=21 metric=0.9870 head_norm=1.245333 delta_norm=0.137624
[S16] aggregate: ACCEPT kept=['S15', 'S8'] (k=2/2) mode=median trim_p=0.1
[S4]  timeout peer S3
[S4]  timeout peer S14
[S16]  timeout peer S13
[S16]  timeout peer S15
[S11]  timeout peer S6
[S8]  timeout peer S2
[S8]  timeout peer S16
[S13]  timeout peer S9
[S14]  timeout peer S10
[S14]  timeout peer S11
[S17]  timeout peer S8
[S10]  timeout peer S7
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S17
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:37113
[S9] sending update (kind=head size=1799 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1799) from S9
[S13] cosine check vs S9: cos=0.9716
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=21 metric=0.9956 head_norm=1.134174
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.348203e-01
[S9] stored merged vector for next round verification (round=21)
[S9] DEBUG after merge:  round=21 metric=0.9956 head_norm=1.121973 delta_norm=0.134820
[S9] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=1.800454 (no previous merge yet)
[S2] round=22 local utility u=0.001528 metrics={'f1_val': 0.7070783140923017, 'auprc': 0.681952809953085, 'loss_val': 0.40565047130431686, 'psi': 0.6970281124366151}-{'f1_val': 0.7015710590385817, 'auprc': 0.6839538276463828, 'loss_val': 0.38166679114143603, 'psi': 0.6945241664817021}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=22 head_norm_before_train=1.916149 (no previous merge yet)
[S3] round=22 local utility u=0.000000 metrics={'f1_val': 0.9541572279539058, 'auprc': 0.9863847054850248, 'loss_val': 0.1327497996029432, 'psi': 0.9670482189663534}-{'f1_val': 0.9620012470396173, 'auprc': 0.9998173410064188, 'loss_val': 0.07818381776965817, 'psi': 0.9771276846263379}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=22 head_norm_before_train=1.314775 cos_to_last_merge=0.9714 (last merge round=17)
[S4] round=22 local utility u=0.000000 metrics={'f1_val': 0.6673829144845199, 'auprc': 0.942558957277946, 'loss_val': 0.4868224883871765, 'psi': 0.7774533316018903}-{'f1_val': 0.9443938990852412, 'auprc': 0.9246921979111864, 'loss_val': 0.5004580653670077, 'psi': 0.9365132186156193}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=22 head_norm_before_train=1.141768 cos_to_last_merge=0.9986 (last merge round=20)
[S5] round=22 local utility u=0.844449 metrics={'f1_val': 0.9665380192358193, 'auprc': 0.9942096745807281, 'loss_val': 0.20699496462898007, 'psi': 0.9776066813737827}-{'f1_val': 0.7009022086989503, 'auprc': 0.9895101106927728, 'loss_val': 0.28797890334515186, 'psi': 0.8163453694964793}
[S6] START round=22 head_norm_before_train=1.667030 cos_to_last_merge=1.0000 (last merge round=21)
[S6] round=22 local utility u=0.000000 metrics={'f1_val': 0.4629070782984856, 'auprc': 0.7868656025113597, 'loss_val': 0.852231066745061, 'psi': 0.5924904879836352}-{'f1_val': 0.9625923386854474, 'auprc': 0.9772453937246768, 'loss_val': 0.2531778347552633, 'psi': 0.9684535607011391}
[S7] START round=22 head_norm_before_train=1.680777 (no previous merge yet)
[S7] round=22 local utility u=0.144990 metrics={'f1_val': 0.5835911547404825, 'auprc': 0.794477931120172, 'loss_val': 0.7450085745654412, 'psi': 0.6679458652923583}-{'f1_val': 0.5521301668242024, 'auprc': 0.7875991529378006, 'loss_val': 0.8255863003511946, 'psi': 0.6463177612696417}
[S8] START round=22 head_norm_before_train=1.234718 cos_to_last_merge=1.0000 (last merge round=21)
[S8] round=22 local utility u=0.006670 metrics={'f1_val': 0.9949476560968612, 'auprc': 0.9965433163147459, 'loss_val': 0.14207744562397617, 'psi': 0.9955859201840151}-{'f1_val': 0.9947267123181514, 'auprc': 0.9977608981482503, 'loss_val': 0.15774372670571526, 'psi': 0.995940386650191}
[S9] START round=22 head_norm_before_train=1.121973 cos_to_last_merge=1.0000 (last merge round=21)
[S9] round=22 local utility u=0.000000 metrics={'f1_val': 0.9950237510807955, 'auprc': 0.9980362481692845, 'loss_val': 0.12372114090015708, 'psi': 0.9962287499161911}-{'f1_val': 0.9956054446615002, 'auprc': 0.9982427868272032, 'loss_val': 0.12492627778391205, 'psi': 0.9966603815277815}
[S10] START round=22 head_norm_before_train=1.322612 cos_to_last_merge=0.9996 (last merge round=20)
[S10] round=22 local utility u=0.010350 metrics={'f1_val': 0.9942674420396322, 'auprc': 0.9961823431812121, 'loss_val': 0.1043180077500278, 'psi': 0.9950334024962643}-{'f1_val': 0.9949255377402499, 'auprc': 0.9964780727594466, 'loss_val': 0.1298537999815216, 'psi': 0.9955465517479286}
[S11] START round=22 head_norm_before_train=1.667030 cos_to_last_merge=1.0000 (last merge round=21)
[S11] round=22 local utility u=0.000000 metrics={'f1_val': 0.9189138351902684, 'auprc': 0.9945293949974933, 'loss_val': 0.21372543064663488, 'psi': 0.9491600591131584}-{'f1_val': 0.9941837409618036, 'auprc': 0.9975258365280737, 'loss_val': 0.1418786845661139, 'psi': 0.9955205791883116}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=22 head_norm_before_train=1.125899 cos_to_last_merge=0.9458 (last merge round=16)
[S13] ⚠️ Model drifted since last merge! cos=0.946
[S13] round=22 local utility u=0.000000 metrics={'f1_val': 0.6493265603655469, 'auprc': 0.6289439435466587, 'loss_val': 0.5484952472109925, 'psi': 0.6411735136379917}-{'f1_val': 0.6538315243107005, 'auprc': 0.6237499719293755, 'loss_val': 0.5568174407006675, 'psi': 0.6417989033581705}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=22 metric=0.6493 head_norm=1.163769
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.494046e-01
[S13] stored merged vector for next round verification (round=22)
[S13] DEBUG after merge:  round=22 metric=0.6491 head_norm=1.139313 delta_norm=0.149405
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S14] START round=22 head_norm_before_train=1.284955 cos_to_last_merge=1.0000 (last merge round=21)
[S14] round=22 local utility u=0.395567 metrics={'f1_val': 0.995413453560897, 'auprc': 0.999032298294033, 'loss_val': 0.20027050694662862, 'psi': 0.9968609914541514}-{'f1_val': 0.9004273879816828, 'auprc': 0.9873301264586469, 'loss_val': 0.3863822756766235, 'psi': 0.9351884833724684}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[S15] START round=22 head_norm_before_train=1.328812 cos_to_last_merge=0.9989 (last merge round=19)
[S15] round=22 local utility u=0.292615 metrics={'f1_val': 0.776661839478563, 'auprc': 0.9831906248453066, 'loss_val': 0.2148434614571373, 'psi': 0.8592733536252605}-{'f1_val': 0.6960551136380773, 'auprc': 0.9758246653224102, 'loss_val': 0.2943345219455488, 'psi': 0.8079629343118104}
[S16] START round=22 head_norm_before_train=1.245333 cos_to_last_merge=1.0000 (last merge round=21)
[S16] round=22 local utility u=0.000000 metrics={'f1_val': 0.8303243228891475, 'auprc': 0.9938425936746864, 'loss_val': 0.7106262224108147, 'psi': 0.895731631203363}-{'f1_val': 0.9880619355929956, 'auprc': 0.988924334360868, 'loss_val': 0.19722248983749274, 'psi': 0.9884068951001446}
[S17] START round=22 head_norm_before_train=1.187788 cos_to_last_merge=0.9730 (last merge round=16)
[S17] round=22 local utility u=0.058961 metrics={'f1_val': 0.36726631290454254, 'auprc': 0.6560962624249309, 'loss_val': 0.8695150104714474, 'psi': 0.4827982927126979}-{'f1_val': 0.3585435707493499, 'auprc': 0.6622099323000993, 'loss_val': 0.9534420613047209, 'psi': 0.48001011536964966}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:37116
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:37111
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S8] → sending delta(kind=head bytes=1806) to S17@127.0.0.1:37117
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:37114
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:37110
[S8] sending update (kind=head size=1806 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1804 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1801) from S7
[S10] cosine check vs S7: cos=-0.0049
[S10] DROPPED delta from S7 (cos=-0.0049 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1797) from S5
[S9] cosine check vs S5: cos=0.8954
[S16] RECEIVED delta(kind=head bytes=1800) from S15
[S16] cosine check vs S15: cos=0.9482
[S17] RECEIVED delta(kind=head bytes=1806) from S8
[S17] cosine check vs S8: cos=0.9326
[S14] RECEIVED delta(kind=head bytes=1804) from S10
[S14] cosine check vs S10: cos=0.9449
[S2] START round=23 head_norm_before_train=1.813281 (no previous merge yet)
[S2] round=23 local utility u=0.128386 metrics={'f1_val': 0.7064007062910991, 'auprc': 0.7701439362024853, 'loss_val': 0.4093855142531635, 'psi': 0.7318979982556535}-{'f1_val': 0.7070783140923017, 'auprc': 0.681952809953085, 'loss_val': 0.40565047130431686, 'psi': 0.6970281124366151}
[S2] not sending this round → trigger blocked (psi=0.732)
[S3] START round=23 head_norm_before_train=1.937958 (no previous merge yet)
[S3] round=23 local utility u=0.201992 metrics={'f1_val': 0.9986372654320868, 'auprc': 0.999689802746019, 'loss_val': 0.03556116319076312, 'psi': 0.9990582803576596}-{'f1_val': 0.9541572279539058, 'auprc': 0.9863847054850248, 'loss_val': 0.1327497996029432, 'psi': 0.9670482189663534}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] sending update (kind=head size=1794 to 1 peers)
[S4] START round=23 head_norm_before_train=1.348242 cos_to_last_merge=0.9640 (last merge round=17)
[S4] round=23 local utility u=0.026539 metrics={'f1_val': 0.6653959728045021, 'auprc': 0.9269184267079267, 'loss_val': 0.37490042920847705, 'psi': 0.770004954365872}-{'f1_val': 0.6673829144845199, 'auprc': 0.942558957277946, 'loss_val': 0.4868224883871765, 'psi': 0.7774533316018903}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=23 head_norm_before_train=1.221510 cos_to_last_merge=0.9933 (last merge round=20)
[S5] round=23 local utility u=0.124877 metrics={'f1_val': 0.996731224857049, 'auprc': 0.9945998242778724, 'loss_val': 0.13957105504409767, 'psi': 0.9958786646253784}-{'f1_val': 0.9665380192358193, 'auprc': 0.9942096745807281, 'loss_val': 0.20699496462898007, 'psi': 0.9776066813737827}
[S6] START round=23 head_norm_before_train=1.678841 cos_to_last_merge=0.9999 (last merge round=21)
[S6] round=23 local utility u=1.000000 metrics={'f1_val': 0.9616384452441613, 'auprc': 0.9852162733699171, 'loss_val': 0.2089536780681089, 'psi': 0.9710695764944636}-{'f1_val': 0.4629070782984856, 'auprc': 0.7868656025113597, 'loss_val': 0.852231066745061, 'psi': 0.5924904879836352}
[S7] START round=23 head_norm_before_train=1.693602 (no previous merge yet)
[S7] round=23 local utility u=0.113803 metrics={'f1_val': 0.5996529863444932, 'auprc': 0.7946096089899939, 'loss_val': 0.614168267395661, 'psi': 0.6776356354026936}-{'f1_val': 0.5835911547404825, 'auprc': 0.794477931120172, 'loss_val': 0.7450085745654412, 'psi': 0.6679458652923583}
[S8] START round=23 head_norm_before_train=1.274086 cos_to_last_merge=0.9994 (last merge round=21)
[S8] round=23 local utility u=0.012121 metrics={'f1_val': 0.9947267123181514, 'auprc': 0.9976925583223905, 'loss_val': 0.11995799622053825, 'psi': 0.995913050719847}-{'f1_val': 0.9949476560968612, 'auprc': 0.9965433163147459, 'loss_val': 0.14207744562397617, 'psi': 0.9955859201840151}
[S9] START round=23 head_norm_before_train=1.175492 cos_to_last_merge=0.9985 (last merge round=21)
[S9] round=23 local utility u=0.017574 metrics={'f1_val': 0.9966891482978385, 'auprc': 0.9949684409467033, 'loss_val': 0.08936138050233074, 'psi': 0.9960008653573844}-{'f1_val': 0.9950237510807955, 'auprc': 0.9980362481692845, 'loss_val': 0.12372114090015708, 'psi': 0.9962287499161911}
[S10] START round=23 head_norm_before_train=1.363374 cos_to_last_merge=0.9980 (last merge round=20)
[S10] round=23 local utility u=0.003732 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9939335041935073, 'loss_val': 0.0956306648357086, 'psi': 0.9946861050890278}-{'f1_val': 0.9942674420396322, 'auprc': 0.9961823431812121, 'loss_val': 0.1043180077500278, 'psi': 0.9950334024962643}
[S11] START round=23 head_norm_before_train=1.694050 cos_to_last_merge=0.9998 (last merge round=21)
[S11] round=23 local utility u=0.273656 metrics={'f1_val': 0.9929191747053671, 'auprc': 0.9971387397038372, 'loss_val': 0.11827430069519075, 'psi': 0.9946070007047552}-{'f1_val': 0.9189138351902684, 'auprc': 0.9945293949974933, 'loss_val': 0.21372543064663488, 'psi': 0.9491600591131584}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] sending update (kind=head size=1804 to 1 peers)
[S13] START round=23 head_norm_before_train=1.139313 cos_to_last_merge=1.0000 (last merge round=22)
[S13] round=23 local utility u=0.000000 metrics={'f1_val': 0.6276805659089968, 'auprc': 0.6693325638956441, 'loss_val': 0.6038116632087293, 'psi': 0.6443413651036558}-{'f1_val': 0.6493265603655469, 'auprc': 0.6289439435466587, 'loss_val': 0.5484952472109925, 'psi': 0.6411735136379917}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=23 head_norm_before_train=1.317113 cos_to_last_merge=0.9992 (last merge round=21)
[S14] round=23 local utility u=0.000000 metrics={'f1_val': 0.9869788411249696, 'auprc': 0.9983957452367673, 'loss_val': 0.19243801735421803, 'psi': 0.9915456027696887}-{'f1_val': 0.995413453560897, 'auprc': 0.999032298294033, 'loss_val': 0.20027050694662862, 'psi': 0.9968609914541514}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=23 metric=0.9870 head_norm=1.345400
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.316265e-01
[S14] stored merged vector for next round verification (round=23)
[S14] DEBUG after merge:  round=23 metric=0.9865 head_norm=1.334464 delta_norm=0.231627
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S15] START round=23 head_norm_before_train=1.366381 cos_to_last_merge=0.9975 (last merge round=19)
[S15] round=23 local utility u=0.554016 metrics={'f1_val': 0.9571486462977716, 'auprc': 0.9844757027015144, 'loss_val': 0.19358770139092363, 'psi': 0.9680794688592688}-{'f1_val': 0.776661839478563, 'auprc': 0.9831906248453066, 'loss_val': 0.2148434614571373, 'psi': 0.8592733536252605}
[S16] START round=23 head_norm_before_train=1.292607 cos_to_last_merge=0.9993 (last merge round=21)
[S16] round=23 local utility u=0.413414 metrics={'f1_val': 0.9112694194297284, 'auprc': 0.9956952045991843, 'loss_val': 0.3750273535174819, 'psi': 0.9450397334975107}-{'f1_val': 0.8303243228891475, 'auprc': 0.9938425936746864, 'loss_val': 0.7106262224108147, 'psi': 0.895731631203363}
[S17] START round=23 head_norm_before_train=1.201824 cos_to_last_merge=0.9695 (last merge round=16)
[S17] round=23 local utility u=0.387512 metrics={'f1_val': 0.39345963926240135, 'auprc': 0.7947306310155269, 'loss_val': 0.6675541362745894, 'psi': 0.5539680359636516}-{'f1_val': 0.36726631290454254, 'auprc': 0.6560962624249309, 'loss_val': 0.8695150104714474, 'psi': 0.4827982927126979}
[S17] not sending this round → trigger blocked (psi=0.554)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=23 metric=0.3935 head_norm=1.214527
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.365374e-01
[S17] stored merged vector for next round verification (round=23)
[S17] DEBUG after merge:  round=23 metric=0.3921 head_norm=1.221981 delta_norm=0.236537
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:37112
[S7] not sending this round → trigger blocked (psi=0.678)
[S5] not sending this round → trigger blocked (psi=0.996)
[S8] not sending this round → trigger blocked (psi=0.996)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] → sending delta(kind=head bytes=1805) to S8@127.0.0.1:37109
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:37113
[S10] not sending this round → trigger blocked (psi=0.995)
[S15] not sending this round → trigger blocked (psi=0.968)
[S9] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1805 to 1 peers)
[S6] sending update (kind=head size=1795 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1805) from S16
[S8] cosine check vs S16: cos=0.9826
[S13] RECEIVED delta(kind=head bytes=1796) from S9
[S13] cosine check vs S9: cos=0.9922
[S11] RECEIVED delta(kind=head bytes=1795) from S6
[S11] cosine check vs S6: cos=0.9987
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=23 metric=0.9113 head_norm=1.337496
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.253071e-01
[S16] stored merged vector for next round verification (round=23)
[S16] DEBUG after merge:  round=23 metric=0.9050 head_norm=1.333110 delta_norm=0.225307
[S16] aggregate: ROLLBACK (f1_val pre=0.911 post=0.905 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=23 metric=0.9967 head_norm=1.230651
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.728469e-01
[S9] stored merged vector for next round verification (round=23)
[S9] DEBUG after merge:  round=23 metric=0.9967 head_norm=1.195344 delta_norm=0.272847
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=1.827382 (no previous merge yet)
[S2] round=24 local utility u=0.000000 metrics={'f1_val': 0.5469743501092542, 'auprc': 0.6065082113769439, 'loss_val': 1.2643847177715266, 'psi': 0.5707878946163301}-{'f1_val': 0.7064007062910991, 'auprc': 0.7701439362024853, 'loss_val': 0.4093855142531635, 'psi': 0.7318979982556535}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=24 head_norm_before_train=1.964333 (no previous merge yet)
[S3] round=24 local utility u=0.000000 metrics={'f1_val': 0.9439073766042323, 'auprc': 0.9948051965979285, 'loss_val': 0.11633637947895029, 'psi': 0.9642665046017107}-{'f1_val': 0.9986372654320868, 'auprc': 0.999689802746019, 'loss_val': 0.03556116319076312, 'psi': 0.9990582803576596}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=24 head_norm_before_train=1.383592 cos_to_last_merge=0.9568 (last merge round=17)
[S4] round=24 local utility u=0.871712 metrics={'f1_val': 0.9421114783638616, 'auprc': 0.9562513642079643, 'loss_val': 0.3797677712066716, 'psi': 0.9477674327015027}-{'f1_val': 0.6653959728045021, 'auprc': 0.9269184267079267, 'loss_val': 0.37490042920847705, 'psi': 0.770004954365872}
[S4] not sending this round → trigger blocked (psi=0.948)
[S5] START round=24 head_norm_before_train=1.278943 cos_to_last_merge=0.9881 (last merge round=20)
[S5] round=24 local utility u=0.027760 metrics={'f1_val': 0.9974658408979167, 'auprc': 0.9996272285737702, 'loss_val': 0.10354075458738847, 'psi': 0.9983303959682581}-{'f1_val': 0.996731224857049, 'auprc': 0.9945998242778724, 'loss_val': 0.13957105504409767, 'psi': 0.9958786646253784}
[S6] START round=24 head_norm_before_train=1.690383 cos_to_last_merge=0.9996 (last merge round=21)
[S6] round=24 local utility u=0.000000 metrics={'f1_val': 0.8239582755479169, 'auprc': 0.9592075166024993, 'loss_val': 0.4049050364068534, 'psi': 0.8780579719697499}-{'f1_val': 0.9616384452441613, 'auprc': 0.9852162733699171, 'loss_val': 0.2089536780681089, 'psi': 0.9710695764944636}
[S7] START round=24 head_norm_before_train=1.698885 (no previous merge yet)
[S7] round=24 local utility u=0.429499 metrics={'f1_val': 0.6768906075046153, 'auprc': 0.8330703770581408, 'loss_val': 0.3339783860716068, 'psi': 0.7393625153260255}-{'f1_val': 0.5996529863444932, 'auprc': 0.7946096089899939, 'loss_val': 0.614168267395661, 'psi': 0.6776356354026936}
[S8] START round=24 head_norm_before_train=1.311186 cos_to_last_merge=0.9980 (last merge round=21)
[S8] round=24 local utility u=0.007835 metrics={'f1_val': 0.9947267123181514, 'auprc': 0.9977384584535581, 'loss_val': 0.10442478971766901, 'psi': 0.9959314107723141}-{'f1_val': 0.9947267123181514, 'auprc': 0.9976925583223905, 'loss_val': 0.11995799622053825, 'psi': 0.995913050719847}
[S9] START round=24 head_norm_before_train=1.195344 cos_to_last_merge=1.0000 (last merge round=23)
[S9] round=24 local utility u=0.012547 metrics={'f1_val': 0.9966891482978385, 'auprc': 0.9982480365029077, 'loss_val': 0.07410600162089201, 'psi': 0.9973127035798662}-{'f1_val': 0.9966891482978385, 'auprc': 0.9949684409467033, 'loss_val': 0.08936138050233074, 'psi': 0.9960008653573844}
[S10] START round=24 head_norm_before_train=1.398119 cos_to_last_merge=0.9959 (last merge round=20)
[S10] round=24 local utility u=0.000377 metrics={'f1_val': 0.9947723700160056, 'auprc': 0.9924590172640162, 'loss_val': 0.08795999811321778, 'psi': 0.9938470289152098}-{'f1_val': 0.9951878390193748, 'auprc': 0.9939335041935073, 'loss_val': 0.0956306648357086, 'psi': 0.9946861050890278}
[S11] START round=24 head_norm_before_train=1.720341 cos_to_last_merge=0.9992 (last merge round=21)
[S11] round=24 local utility u=0.016560 metrics={'f1_val': 0.9966988539245482, 'auprc': 0.9977138952674501, 'loss_val': 0.10955704367352483, 'psi': 0.9971048704617089}-{'f1_val': 0.9929191747053671, 'auprc': 0.9971387397038372, 'loss_val': 0.11827430069519075, 'psi': 0.9946070007047552}
[S11] not sending this round → trigger blocked (psi=0.997)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=24 metric=0.9967 head_norm=1.743889
[S11] _apply_head_vector_avg (torch): Δ‖w‖=6.160159e-02
[S11] stored merged vector for next round verification (round=24)
[S11] DEBUG after merge:  round=24 metric=0.9967 head_norm=1.716239 delta_norm=0.061602
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S13] START round=24 head_norm_before_train=1.166771 cos_to_last_merge=0.9997 (last merge round=22)
[S13] round=24 local utility u=0.089228 metrics={'f1_val': 0.665630935895607, 'auprc': 0.6198744431374698, 'loss_val': 0.5046831597518435, 'psi': 0.6473283387923521}-{'f1_val': 0.6276805659089968, 'auprc': 0.6693325638956441, 'loss_val': 0.6038116632087293, 'psi': 0.6443413651036558}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=24 metric=0.6656 head_norm=1.189655
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.640832e-02
[S13] stored merged vector for next round verification (round=24)
[S13] DEBUG after merge:  round=24 metric=0.6656 head_norm=1.207238 delta_norm=0.086408
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S14] START round=24 head_norm_before_train=1.334464 cos_to_last_merge=1.0000 (last merge round=23)
[S14] round=24 local utility u=0.023111 metrics={'f1_val': 0.9971159530966711, 'auprc': 0.9967219359844113, 'loss_val': 0.20201764314079104, 'psi': 0.9969583462517673}-{'f1_val': 0.9869788411249696, 'auprc': 0.9983957452367673, 'loss_val': 0.19243801735421803, 'psi': 0.9915456027696887}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=24 head_norm_before_train=1.400951 cos_to_last_merge=0.9960 (last merge round=19)
[S15] round=24 local utility u=0.000000 metrics={'f1_val': 0.699730715937497, 'auprc': 0.8215982935823183, 'loss_val': 0.43109295587396745, 'psi': 0.7484777469954256}-{'f1_val': 0.9571486462977716, 'auprc': 0.9844757027015144, 'loss_val': 0.19358770139092363, 'psi': 0.9680794688592688}
[S16] START round=24 head_norm_before_train=1.333110 cos_to_last_merge=1.0000 (last merge round=23)
[S16] round=24 local utility u=0.223898 metrics={'f1_val': 0.9559889378708132, 'auprc': 0.9947633552976882, 'loss_val': 0.19275219833406512, 'psi': 0.9714987048415631}-{'f1_val': 0.9112694194297284, 'auprc': 0.9956952045991843, 'loss_val': 0.3750273535174819, 'psi': 0.9450397334975107}
[S17] START round=24 head_norm_before_train=1.221981 cos_to_last_merge=1.0000 (last merge round=23)
[S17] round=24 local utility u=0.031377 metrics={'f1_val': 0.3933544325433376, 'auprc': 0.8188454952959354, 'loss_val': 0.6765139288048623, 'psi': 0.5635508576443767}-{'f1_val': 0.39345963926240135, 'auprc': 0.7947306310155269, 'loss_val': 0.6675541362745894, 'psi': 0.5539680359636516}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:37110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:37114
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.971)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:37117
[S9] not sending this round → trigger blocked (psi=0.997)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:37111
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1803) from S8
[S17] cosine check vs S8: cos=0.9782
[S9] RECEIVED delta(kind=head bytes=1800) from S5
[S9] cosine check vs S5: cos=0.9622
[S10] RECEIVED delta(kind=head bytes=1801) from S7
[S10] cosine check vs S7: cos=-0.0052
[S10] DROPPED delta from S7 (cos=-0.0052 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1801) from S10
[S14] cosine check vs S10: cos=0.9783
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=24 metric=0.9947 head_norm=1.344195
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.364234e-01
[S8] stored merged vector for next round verification (round=24)
[S8] DEBUG after merge:  round=24 metric=0.9947 head_norm=1.333892 delta_norm=0.136423
[S8] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=25 head_norm_before_train=1.840562 (no previous merge yet)
[S2] round=25 local utility u=1.000000 metrics={'f1_val': 0.7134471597257768, 'auprc': 0.7908238501097252, 'loss_val': 0.5307038092416178, 'psi': 0.7443978358793562}-{'f1_val': 0.5469743501092542, 'auprc': 0.6065082113769439, 'loss_val': 1.2643847177715266, 'psi': 0.5707878946163301}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=25 head_norm_before_train=1.987384 (no previous merge yet)
[S3] round=25 local utility u=0.052579 metrics={'f1_val': 0.9587738025674638, 'auprc': 0.9996716459029407, 'loss_val': 0.11497599457392169, 'psi': 0.9751329399016546}-{'f1_val': 0.9439073766042323, 'auprc': 0.9948051965979285, 'loss_val': 0.11633637947895029, 'psi': 0.9642665046017107}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=25 head_norm_before_train=1.411228 cos_to_last_merge=0.9513 (last merge round=17)
[S4] round=25 local utility u=0.012192 metrics={'f1_val': 0.9387613859536814, 'auprc': 0.9610949242974358, 'loss_val': 0.34981350859465, 'psi': 0.9476948012911832}-{'f1_val': 0.9421114783638616, 'auprc': 0.9562513642079643, 'loss_val': 0.3797677712066716, 'psi': 0.9477674327015027}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=25 head_norm_before_train=1.324153 cos_to_last_merge=0.9840 (last merge round=20)
[S5] round=25 local utility u=0.000000 metrics={'f1_val': 0.7028506931369296, 'auprc': 0.8236384145861017, 'loss_val': 0.45903497020354933, 'psi': 0.7511657817165984}-{'f1_val': 0.9974658408979167, 'auprc': 0.9996272285737702, 'loss_val': 0.10354075458738847, 'psi': 0.9983303959682581}
[S6] START round=25 head_norm_before_train=1.703970 cos_to_last_merge=0.9991 (last merge round=21)
[S6] round=25 local utility u=0.000000 metrics={'f1_val': 0.6368090486932104, 'auprc': 0.9358140399525338, 'loss_val': 0.4034926393494705, 'psi': 0.7564110451969398}-{'f1_val': 0.8239582755479169, 'auprc': 0.9592075166024993, 'loss_val': 0.4049050364068534, 'psi': 0.8780579719697499}
[S7] START round=25 head_norm_before_train=1.708522 (no previous merge yet)
[S7] round=25 local utility u=0.000000 metrics={'f1_val': 0.6646589094340465, 'auprc': 0.8178661821171367, 'loss_val': 0.4189945900999576, 'psi': 0.7259418185072826}-{'f1_val': 0.6768906075046153, 'auprc': 0.8330703770581408, 'loss_val': 0.3339783860716068, 'psi': 0.7393625153260255}
[S8] START round=25 head_norm_before_train=1.333892 cos_to_last_merge=1.0000 (last merge round=24)
[S8] round=25 local utility u=0.000000 metrics={'f1_val': 0.9939919029218467, 'auprc': 0.9973267915943202, 'loss_val': 0.10823847700189622, 'psi': 0.9953258583908362}-{'f1_val': 0.9947267123181514, 'auprc': 0.9977384584535581, 'loss_val': 0.10442478971766901, 'psi': 0.9959314107723141}
[S9] START round=25 head_norm_before_train=1.242475 cos_to_last_merge=0.9994 (last merge round=23)
[S9] round=25 local utility u=0.000000 metrics={'f1_val': 0.9946069829493691, 'auprc': 0.9984246994955008, 'loss_val': 0.06477776598367535, 'psi': 0.9961340695678218}-{'f1_val': 0.9966891482978385, 'auprc': 0.9982480365029077, 'loss_val': 0.07410600162089201, 'psi': 0.9973127035798662}
[S10] START round=25 head_norm_before_train=1.434782 cos_to_last_merge=0.9938 (last merge round=20)
[S10] round=25 local utility u=0.009196 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9934892106580994, 'loss_val': 0.0751523729889851, 'psi': 0.9945083876748646}-{'f1_val': 0.9947723700160056, 'auprc': 0.9924590172640162, 'loss_val': 0.08795999811321778, 'psi': 0.9938470289152098}
[S11] START round=25 head_norm_before_train=1.716239 cos_to_last_merge=1.0000 (last merge round=24)
[S11] round=25 local utility u=0.000000 metrics={'f1_val': 0.9831630619891293, 'auprc': 0.9976425549945401, 'loss_val': 0.12318202813516024, 'psi': 0.9889548591912936}-{'f1_val': 0.9966988539245482, 'auprc': 0.9977138952674501, 'loss_val': 0.10955704367352483, 'psi': 0.9971048704617089}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=25 head_norm_before_train=1.207238 cos_to_last_merge=1.0000 (last merge round=24)
[S13] round=25 local utility u=0.000000 metrics={'f1_val': 0.5962404722668916, 'auprc': 0.6765816691442468, 'loss_val': 0.753499243837175, 'psi': 0.6283769510178336}-{'f1_val': 0.665630935895607, 'auprc': 0.6198744431374698, 'loss_val': 0.5046831597518435, 'psi': 0.6473283387923521}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=25 head_norm_before_train=1.359192 cos_to_last_merge=0.9996 (last merge round=23)
[S14] round=25 local utility u=0.023105 metrics={'f1_val': 0.9967999159800798, 'auprc': 0.9985957855877886, 'loss_val': 0.1595329124785156, 'psi': 0.9975182638231633}-{'f1_val': 0.9971159530966711, 'auprc': 0.9967219359844113, 'loss_val': 0.20201764314079104, 'psi': 0.9969583462517673}
[S14] not sending this round → trigger blocked (psi=0.998)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=25 metric=0.9968 head_norm=1.381528
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.579515e-01
[S14] stored merged vector for next round verification (round=25)
[S14] DEBUG after merge:  round=25 metric=0.9968 head_norm=1.399521 delta_norm=0.157951
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S15] START round=25 head_norm_before_train=1.433334 cos_to_last_merge=0.9944 (last merge round=19)
[S15] round=25 local utility u=1.000000 metrics={'f1_val': 0.9730188561160142, 'auprc': 0.9949193449251846, 'loss_val': 0.1080457741413368, 'psi': 0.9817790516396824}-{'f1_val': 0.699730715937497, 'auprc': 0.8215982935823183, 'loss_val': 0.43109295587396745, 'psi': 0.7484777469954256}
[S16] START round=25 head_norm_before_train=1.375099 cos_to_last_merge=0.9995 (last merge round=23)
[S16] round=25 local utility u=0.145583 metrics={'f1_val': 0.991069678885818, 'auprc': 0.994071782270306, 'loss_val': 0.10999540909973979, 'psi': 0.9922705202396132}-{'f1_val': 0.9559889378708132, 'auprc': 0.9947633552976882, 'loss_val': 0.19275219833406512, 'psi': 0.9714987048415631}
[S17] START round=25 head_norm_before_train=1.233614 cos_to_last_merge=0.9997 (last merge round=23)
[S17] round=25 local utility u=0.439115 metrics={'f1_val': 0.5180031022537084, 'auprc': 0.8529069803064047, 'loss_val': 0.6483599805180097, 'psi': 0.6519646534747869}-{'f1_val': 0.3933544325433376, 'auprc': 0.8188454952959354, 'loss_val': 0.6765139288048623, 'psi': 0.5635508576443767}
[S17] not sending this round → trigger blocked (psi=0.652)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=25 metric=0.5180 head_norm=1.247549
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.515578e-01
[S17] stored merged vector for next round verification (round=25)
[S17] DEBUG after merge:  round=25 metric=0.4424 head_norm=1.287886 delta_norm=0.151558
[S17] aggregate: ROLLBACK (f1_val pre=0.518 post=0.442 tol_abs=0.005 tol_rel=0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:37109
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:37116
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.995)
[S10] ⇄ pheromone p=0.047 → S14@127.0.0.1:37114
[S5] ⇄ pheromone p=0.220 → S9@127.0.0.1:37110
[S7] ⇄ pheromone p=0.161 → S10@127.0.0.1:37111
[S15] sending update (kind=head size=1797 to 1 peers)
[S6] ⇄ pheromone p=0.289 → S11@127.0.0.1:37112
[S16] sending update (kind=head size=1800 to 1 peers)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=25 metric=0.9946 head_norm=1.284544
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.855076e-01
[S9] stored merged vector for next round verification (round=25)
[S9] DEBUG after merge:  round=25 metric=0.9946 head_norm=1.291242 delta_norm=0.185508
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.026 → S13@127.0.0.1:37113
[S8] ⇄ pheromone p=0.103 → S17@127.0.0.1:37117
[S16] RECEIVED delta(kind=head bytes=1797) from S15
[S16] cosine check vs S15: cos=0.9751
[S8] RECEIVED delta(kind=head bytes=1800) from S16
[S8] cosine check vs S16: cos=0.9682
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=25 metric=0.9911 head_norm=1.414669
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.622070e-01
[S16] stored merged vector for next round verification (round=25)
[S16] DEBUG after merge:  round=25 metric=0.9906 head_norm=1.429547 delta_norm=0.162207
[S16] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.219 → S8@127.0.0.1:37109
[S15] ⇄ pheromone p=0.368 → S16@127.0.0.1:37116
[S2] START round=26 head_norm_before_train=1.850766 (no previous merge yet)
[S2] round=26 local utility u=0.000000 metrics={'f1_val': 0.5605209460289914, 'auprc': 0.6085367376552777, 'loss_val': 1.2097022051512614, 'psi': 0.5797272626795059}-{'f1_val': 0.7134471597257768, 'auprc': 0.7908238501097252, 'loss_val': 0.5307038092416178, 'psi': 0.7443978358793562}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=26 head_norm_before_train=2.009818 (no previous merge yet)
[S3] round=26 local utility u=0.000000 metrics={'f1_val': 0.956819398488849, 'auprc': 0.9996831179475545, 'loss_val': 0.10444020506685076, 'psi': 0.9739648862723312}-{'f1_val': 0.9587738025674638, 'auprc': 0.9996716459029407, 'loss_val': 0.11497599457392169, 'psi': 0.9751329399016546}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=26 head_norm_before_train=1.436975 cos_to_last_merge=0.9460 (last merge round=17)
[S4] ⚠️ Model drifted since last merge! cos=0.946
[S4] round=26 local utility u=0.049988 metrics={'f1_val': 0.94345811784252, 'auprc': 0.9633168587554497, 'loss_val': 0.28468346329166044, 'psi': 0.9514016142076919}-{'f1_val': 0.9387613859536814, 'auprc': 0.9610949242974358, 'loss_val': 0.34981350859465, 'psi': 0.9476948012911832}
[S4] not sending this round → trigger blocked (psi=0.951)
[S5] START round=26 head_norm_before_train=1.349008 cos_to_last_merge=0.9817 (last merge round=20)
[S5] round=26 local utility u=0.000000 metrics={'f1_val': 0.6244799157692672, 'auprc': 0.9917622940957133, 'loss_val': 1.1474498747133346, 'psi': 0.7713928670998456}-{'f1_val': 0.7028506931369296, 'auprc': 0.8236384145861017, 'loss_val': 0.45903497020354933, 'psi': 0.7511657817165984}
[S6] START round=26 head_norm_before_train=1.719240 cos_to_last_merge=0.9985 (last merge round=21)
[S6] round=26 local utility u=1.000000 metrics={'f1_val': 0.9460990091754367, 'auprc': 0.9675233318564355, 'loss_val': 0.2709230875912266, 'psi': 0.9546687382478362}-{'f1_val': 0.6368090486932104, 'auprc': 0.9358140399525338, 'loss_val': 0.4034926393494705, 'psi': 0.7564110451969398}
[S7] START round=26 head_norm_before_train=1.717075 (no previous merge yet)
[S7] round=26 local utility u=0.000000 metrics={'f1_val': 0.6536488652187701, 'auprc': 0.8100959081287537, 'loss_val': 0.4804863062931116, 'psi': 0.7162276823827636}-{'f1_val': 0.6646589094340465, 'auprc': 0.8178661821171367, 'loss_val': 0.4189945900999576, 'psi': 0.7259418185072826}
[S8] START round=26 head_norm_before_train=1.365603 cos_to_last_merge=0.9997 (last merge round=24)
[S8] round=26 local utility u=0.000000 metrics={'f1_val': 0.9936431579474577, 'auprc': 0.9943644840986519, 'loss_val': 0.12493821461237714, 'psi': 0.9939316884079354}-{'f1_val': 0.9939919029218467, 'auprc': 0.9973267915943202, 'loss_val': 0.10823847700189622, 'psi': 0.9953258583908362}
[S9] START round=26 head_norm_before_train=1.291242 cos_to_last_merge=1.0000 (last merge round=25)
[S9] round=26 local utility u=0.000000 metrics={'f1_val': 0.9893150859224193, 'auprc': 0.9984507077345658, 'loss_val': 0.07531793092287688, 'psi': 0.9929693346472779}-{'f1_val': 0.9946069829493691, 'auprc': 0.9984246994955008, 'loss_val': 0.06477776598367535, 'psi': 0.9961340695678218}
[S10] START round=26 head_norm_before_train=1.472106 cos_to_last_merge=0.9914 (last merge round=20)
[S10] round=26 local utility u=0.007960 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9949953020005173, 'loss_val': 0.06375105668350647, 'psi': 0.9951108242118318}-{'f1_val': 0.9951878390193748, 'auprc': 0.9934892106580994, 'loss_val': 0.0751523729889851, 'psi': 0.9945083876748646}
[S11] START round=26 head_norm_before_train=1.739440 cos_to_last_merge=0.9999 (last merge round=24)
[S11] round=26 local utility u=0.060314 metrics={'f1_val': 0.9962850284706224, 'auprc': 0.9974000844851194, 'loss_val': 0.08055825793420368, 'psi': 0.9967310508764212}-{'f1_val': 0.9831630619891293, 'auprc': 0.9976425549945401, 'loss_val': 0.12318202813516024, 'psi': 0.9889548591912936}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] sending update (kind=head size=1805 to 1 peers)
[S13] START round=26 head_norm_before_train=1.224888 cos_to_last_merge=0.9999 (last merge round=24)
[S13] round=26 local utility u=0.030370 metrics={'f1_val': 0.6250238849784303, 'auprc': 0.5998153259080332, 'loss_val': 0.6351607912343452, 'psi': 0.6149404613502715}-{'f1_val': 0.5962404722668916, 'auprc': 0.6765816691442468, 'loss_val': 0.753499243837175, 'psi': 0.6283769510178336}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S14] START round=26 head_norm_before_train=1.399521 cos_to_last_merge=1.0000 (last merge round=25)
[S14] round=26 local utility u=0.000000 metrics={'f1_val': 0.9966461383503629, 'auprc': 0.9992157290057948, 'loss_val': 0.16995883078368426, 'psi': 0.9976739746125356}-{'f1_val': 0.9967999159800798, 'auprc': 0.9985957855877886, 'loss_val': 0.1595329124785156, 'psi': 0.9975182638231633}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=26 head_norm_before_train=1.462375 cos_to_last_merge=0.9928 (last merge round=19)
[S15] round=26 local utility u=0.000000 metrics={'f1_val': 0.7012218451287537, 'auprc': 0.7994601719808972, 'loss_val': 0.5315885151362183, 'psi': 0.7405171758696112}-{'f1_val': 0.9730188561160142, 'auprc': 0.9949193449251846, 'loss_val': 0.1080457741413368, 'psi': 0.9817790516396824}
[S16] START round=26 head_norm_before_train=1.429547 cos_to_last_merge=1.0000 (last merge round=25)
[S16] round=26 local utility u=0.000000 metrics={'f1_val': 0.9388019471782931, 'auprc': 0.9966557185996896, 'loss_val': 0.24667276683514494, 'psi': 0.9619434557468517}-{'f1_val': 0.991069678885818, 'auprc': 0.994071782270306, 'loss_val': 0.10999540909973979, 'psi': 0.9922705202396132}
[S17] START round=26 head_norm_before_train=1.287886 cos_to_last_merge=1.0000 (last merge round=25)
[S17] round=26 local utility u=0.000000 metrics={'f1_val': 0.40196702853456145, 'auprc': 0.8056187502404524, 'loss_val': 0.686840684735564, 'psi': 0.5634277172169179}-{'f1_val': 0.5180031022537084, 'auprc': 0.8529069803064047, 'loss_val': 0.6483599805180097, 'psi': 0.6519646534747869}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:37114
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:37112
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=26 metric=0.9936 head_norm=1.395765
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.875871e-01
[S8] stored merged vector for next round verification (round=26)
[S8] DEBUG after merge:  round=26 metric=0.9936 head_norm=1.392672 delta_norm=0.187587
[S8] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S11] RECEIVED delta(kind=head bytes=1799) from S6
[S11] cosine check vs S6: cos=0.9965
[S14] RECEIVED delta(kind=head bytes=1801) from S10
[S14] cosine check vs S10: cos=0.9894
[S2] START round=27 head_norm_before_train=1.858178 (no previous merge yet)
[S2] round=27 local utility u=1.000000 metrics={'f1_val': 0.7088257210781544, 'auprc': 0.7972279529827819, 'loss_val': 0.4324427419010372, 'psi': 0.7441866138400055}-{'f1_val': 0.5605209460289914, 'auprc': 0.6085367376552777, 'loss_val': 1.2097022051512614, 'psi': 0.5797272626795059}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[S3] START round=27 head_norm_before_train=2.031680 (no previous merge yet)
[S3] round=27 local utility u=0.000000 metrics={'f1_val': 0.7788666195516735, 'auprc': 0.9754992346810768, 'loss_val': 0.4282922638299941, 'psi': 0.8575196656034347}-{'f1_val': 0.956819398488849, 'auprc': 0.9996831179475545, 'loss_val': 0.10444020506685076, 'psi': 0.9739648862723312}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=27 head_norm_before_train=1.455810 cos_to_last_merge=0.9420 (last merge round=17)
[S4] ⚠️ Model drifted since last merge! cos=0.942
[S4] round=27 local utility u=0.000000 metrics={'f1_val': 0.9408589552565794, 'auprc': 0.9541127118252, 'loss_val': 0.2840548840225757, 'psi': 0.9461604578840277}-{'f1_val': 0.94345811784252, 'auprc': 0.9633168587554497, 'loss_val': 0.28468346329166044, 'psi': 0.9514016142076919}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=27 head_norm_before_train=1.356342 cos_to_last_merge=0.9805 (last merge round=20)
[S5] round=27 local utility u=0.503709 metrics={'f1_val': 0.703639547715672, 'auprc': 0.9111280755266857, 'loss_val': 0.3730878352785963, 'psi': 0.7866349588400776}-{'f1_val': 0.6244799157692672, 'auprc': 0.9917622940957133, 'loss_val': 1.1474498747133346, 'psi': 0.7713928670998456}
[S6] START round=27 head_norm_before_train=1.734608 cos_to_last_merge=0.9976 (last merge round=21)
[S6] round=27 local utility u=0.000000 metrics={'f1_val': 0.7015098762420359, 'auprc': 0.8227904491934944, 'loss_val': 0.5039586959901167, 'psi': 0.7500221054226193}-{'f1_val': 0.9460990091754367, 'auprc': 0.9675233318564355, 'loss_val': 0.2709230875912266, 'psi': 0.9546687382478362}
[S7] START round=27 head_norm_before_train=1.725389 (no previous merge yet)
[S7] round=27 local utility u=0.000000 metrics={'f1_val': 0.6362889691540595, 'auprc': 0.8035110631677879, 'loss_val': 0.5412071622052963, 'psi': 0.7031778067595509}-{'f1_val': 0.6536488652187701, 'auprc': 0.8100959081287537, 'loss_val': 0.4804863062931116, 'psi': 0.7162276823827636}
[S8] START round=27 head_norm_before_train=1.392672 cos_to_last_merge=1.0000 (last merge round=26)
[S8] round=27 local utility u=0.007591 metrics={'f1_val': 0.9928938724649488, 'auprc': 0.99613749229448, 'loss_val': 0.11057893907553966, 'psi': 0.9941913203967612}-{'f1_val': 0.9936431579474577, 'auprc': 0.9943644840986519, 'loss_val': 0.12493821461237714, 'psi': 0.9939316884079354}
[S9] START round=27 head_norm_before_train=1.325241 cos_to_last_merge=0.9997 (last merge round=25)
[S9] round=27 local utility u=0.030886 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9960922703492286, 'loss_val': 0.05319792260929512, 'psi': 0.9966986556469771}-{'f1_val': 0.9893150859224193, 'auprc': 0.9984507077345658, 'loss_val': 0.07531793092287688, 'psi': 0.9929693346472779}
[S10] START round=27 head_norm_before_train=1.511612 cos_to_last_merge=0.9886 (last merge round=20)
[S10] round=27 local utility u=0.000212 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9937383838495798, 'loss_val': 0.05955677787751352, 'psi': 0.9946080569514568}-{'f1_val': 0.9951878390193748, 'auprc': 0.9949953020005173, 'loss_val': 0.06375105668350647, 'psi': 0.9951108242118318}
[S11] START round=27 head_norm_before_train=1.765585 cos_to_last_merge=0.9994 (last merge round=24)
[S11] round=27 local utility u=0.000196 metrics={'f1_val': 0.9962850284706224, 'auprc': 0.9968512146786132, 'loss_val': 0.07851952720205836, 'psi': 0.9965115029538187}-{'f1_val': 0.9962850284706224, 'auprc': 0.9974000844851194, 'loss_val': 0.08055825793420368, 'psi': 0.9967310508764212}
[S11] not sending this round → trigger blocked (psi=0.997)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=27 metric=0.9963 head_norm=1.791358
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.893570e-02
[S11] stored merged vector for next round verification (round=27)
[S11] DEBUG after merge:  round=27 metric=0.9963 head_norm=1.760967 delta_norm=0.088936
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S13] START round=27 head_norm_before_train=1.244521 cos_to_last_merge=0.9996 (last merge round=24)
[S13] round=27 local utility u=0.000000 metrics={'f1_val': 0.625675237236323, 'auprc': 0.5794140726798787, 'loss_val': 0.6679679625823572, 'psi': 0.6071707714137453}-{'f1_val': 0.6250238849784303, 'auprc': 0.5998153259080332, 'loss_val': 0.6351607912343452, 'psi': 0.6149404613502715}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=27 head_norm_before_train=1.418940 cos_to_last_merge=0.9998 (last merge round=25)
[S14] round=27 local utility u=0.012892 metrics={'f1_val': 0.9966100132760906, 'auprc': 0.9991706183359438, 'loss_val': 0.14382334276550132, 'psi': 0.9976342553000319}-{'f1_val': 0.9966461383503629, 'auprc': 0.9992157290057948, 'loss_val': 0.16995883078368426, 'psi': 0.9976739746125356}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=27 metric=0.9966 head_norm=1.438665
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.216422e-01
[S14] stored merged vector for next round verification (round=27)
[S14] DEBUG after merge:  round=27 metric=0.9966 head_norm=1.470567 delta_norm=0.121642
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S15] START round=27 head_norm_before_train=1.488698 cos_to_last_merge=0.9911 (last merge round=19)
[S15] round=27 local utility u=1.000000 metrics={'f1_val': 0.9538944601893218, 'auprc': 0.9918905264582596, 'loss_val': 0.128791924930064, 'psi': 0.9690928866968969}-{'f1_val': 0.7012218451287537, 'auprc': 0.7994601719808972, 'loss_val': 0.5315885151362183, 'psi': 0.7405171758696112}
[S16] START round=27 head_norm_before_train=1.463555 cos_to_last_merge=0.9997 (last merge round=25)
[S16] round=27 local utility u=0.000000 metrics={'f1_val': 0.9129212428977468, 'auprc': 0.9965232128365638, 'loss_val': 0.3694407870738943, 'psi': 0.9463620308732736}-{'f1_val': 0.9388019471782931, 'auprc': 0.9966557185996896, 'loss_val': 0.24667276683514494, 'psi': 0.9619434557468517}
[S17] START round=27 head_norm_before_train=1.297730 cos_to_last_merge=0.9998 (last merge round=25)
[S17] round=27 local utility u=0.000000 metrics={'f1_val': 0.38444093110562727, 'auprc': 0.6805171154586902, 'loss_val': 0.8719640943400401, 'psi': 0.5028714048468524}-{'f1_val': 0.40196702853456145, 'auprc': 0.8056187502404524, 'loss_val': 0.686840684735564, 'psi': 0.5634277172169179}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:37116
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.995)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:37113
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] → sending delta(kind=head bytes=1805) to S17@127.0.0.1:37117
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:37110
[S8] sending update (kind=head size=1805 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1805) from S8
[S17] cosine check vs S8: cos=0.9672
[S13] RECEIVED delta(kind=head bytes=1799) from S9
[S13] cosine check vs S9: cos=0.9109
[S16] RECEIVED delta(kind=head bytes=1797) from S15
[S16] cosine check vs S15: cos=0.9879
[S9] RECEIVED delta(kind=head bytes=1801) from S5
[S9] cosine check vs S5: cos=0.9821
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=27 metric=0.9971 head_norm=1.349861
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.286523e-01
[S9] stored merged vector for next round verification (round=27)
[S9] DEBUG after merge:  round=27 metric=0.9971 head_norm=1.351736 delta_norm=0.128652
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=28 head_norm_before_train=1.864703 (no previous merge yet)
[S2] round=28 local utility u=0.000000 metrics={'f1_val': 0.6272118939956068, 'auprc': 0.6406388854762992, 'loss_val': 0.7046975913222712, 'psi': 0.6325826905878837}-{'f1_val': 0.7088257210781544, 'auprc': 0.7972279529827819, 'loss_val': 0.4324427419010372, 'psi': 0.7441866138400055}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=28 head_norm_before_train=2.049186 (no previous merge yet)
[S3] round=28 local utility u=0.721192 metrics={'f1_val': 0.9577919690973176, 'auprc': 0.9944344324040374, 'loss_val': 0.11626596288777055, 'psi': 0.9724489544200055}-{'f1_val': 0.7788666195516735, 'auprc': 0.9754992346810768, 'loss_val': 0.4282922638299941, 'psi': 0.8575196656034347}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=28 head_norm_before_train=1.475382 cos_to_last_merge=0.9384 (last merge round=17)
[S4] ⚠️ Model drifted since last merge! cos=0.938
[S4] round=28 local utility u=0.057423 metrics={'f1_val': 0.9510693818663526, 'auprc': 0.9646506870168821, 'loss_val': 0.26208595909172233, 'psi': 0.9565019039265643}-{'f1_val': 0.9408589552565794, 'auprc': 0.9541127118252, 'loss_val': 0.2840548840225757, 'psi': 0.9461604578840277}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=28 head_norm_before_train=1.365781 cos_to_last_merge=0.9789 (last merge round=20)
[S5] round=28 local utility u=1.000000 metrics={'f1_val': 0.9933679080398908, 'auprc': 0.990749569105215, 'loss_val': 0.13619882417778276, 'psi': 0.9923205724660206}-{'f1_val': 0.703639547715672, 'auprc': 0.9111280755266857, 'loss_val': 0.3730878352785963, 'psi': 0.7866349588400776}
[S6] START round=28 head_norm_before_train=1.748924 cos_to_last_merge=0.9967 (last merge round=21)
[S6] round=28 local utility u=0.385390 metrics={'f1_val': 0.8237665941669852, 'auprc': 0.823499140089738, 'loss_val': 0.4688448340052739, 'psi': 0.8236596125360862}-{'f1_val': 0.7015098762420359, 'auprc': 0.8227904491934944, 'loss_val': 0.5039586959901167, 'psi': 0.7500221054226193}
[S7] START round=28 head_norm_before_train=1.732044 (no previous merge yet)
[S7] round=28 local utility u=0.000000 metrics={'f1_val': 0.6049957898497293, 'auprc': 0.7938396590507626, 'loss_val': 0.6629856023598973, 'psi': 0.6805333375301427}-{'f1_val': 0.6362889691540595, 'auprc': 0.8035110631677879, 'loss_val': 0.5412071622052963, 'psi': 0.7031778067595509}
[S8] START round=28 head_norm_before_train=1.417246 cos_to_last_merge=0.9998 (last merge round=26)
[S8] round=28 local utility u=0.007195 metrics={'f1_val': 0.9940273225800647, 'auprc': 0.9953332721886733, 'loss_val': 0.10057700363245269, 'psi': 0.9945497024235082}-{'f1_val': 0.9928938724649488, 'auprc': 0.99613749229448, 'loss_val': 0.11057893907553966, 'psi': 0.9941913203967612}
[S9] START round=28 head_norm_before_train=1.351736 cos_to_last_merge=1.0000 (last merge round=27)
[S9] round=28 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9952590507170073, 'loss_val': 0.056072810768130116, 'psi': 0.9963653677940886}-{'f1_val': 0.9971029125121428, 'auprc': 0.9960922703492286, 'loss_val': 0.05319792260929512, 'psi': 0.9966986556469771}
[S10] START round=28 head_norm_before_train=1.549755 cos_to_last_merge=0.9859 (last merge round=20)
[S10] round=28 local utility u=0.008393 metrics={'f1_val': 0.9947060979488367, 'auprc': 0.995598699540545, 'loss_val': 0.04546159749537956, 'psi': 0.99506313858552}-{'f1_val': 0.9951878390193748, 'auprc': 0.9937383838495798, 'loss_val': 0.05955677787751352, 'psi': 0.9946080569514568}
[S11] START round=28 head_norm_before_train=1.760967 cos_to_last_merge=1.0000 (last merge round=27)
[S11] round=28 local utility u=0.004183 metrics={'f1_val': 0.9962850284706224, 'auprc': 0.9958607995176164, 'loss_val': 0.06718221264402917, 'psi': 0.99611533688942}-{'f1_val': 0.9962850284706224, 'auprc': 0.9968512146786132, 'loss_val': 0.07851952720205836, 'psi': 0.9965115029538187}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=28 head_norm_before_train=1.262631 cos_to_last_merge=0.9991 (last merge round=24)
[S13] round=28 local utility u=0.132626 metrics={'f1_val': 0.6340420723446276, 'auprc': 0.6236291282703559, 'loss_val': 0.5855626340421553, 'psi': 0.6298768947149189}-{'f1_val': 0.625675237236323, 'auprc': 0.5794140726798787, 'loss_val': 0.6679679625823572, 'psi': 0.6071707714137453}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=28 metric=0.6340 head_norm=1.277311
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.839506e-01
[S13] stored merged vector for next round verification (round=28)
[S13] DEBUG after merge:  round=28 metric=0.6351 head_norm=1.283042 delta_norm=0.283951
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S14] START round=28 head_norm_before_train=1.470567 cos_to_last_merge=1.0000 (last merge round=27)
[S14] round=28 local utility u=0.005900 metrics={'f1_val': 0.9970207327224484, 'auprc': 0.9992484859528444, 'loss_val': 0.1347208673256011, 'psi': 0.9979118340146068}-{'f1_val': 0.9966100132760906, 'auprc': 0.9991706183359438, 'loss_val': 0.14382334276550132, 'psi': 0.9976342553000319}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=28 head_norm_before_train=1.512908 cos_to_last_merge=0.9896 (last merge round=19)
[S15] round=28 local utility u=0.000000 metrics={'f1_val': 0.6983283881970873, 'auprc': 0.8264153175250442, 'loss_val': 0.48294557224534546, 'psi': 0.74956315992827}-{'f1_val': 0.9538944601893218, 'auprc': 0.9918905264582596, 'loss_val': 0.128791924930064, 'psi': 0.9690928866968969}
[S16] START round=28 head_norm_before_train=1.497027 cos_to_last_merge=0.9989 (last merge round=25)
[S16] round=28 local utility u=0.000000 metrics={'f1_val': 0.8303348620503395, 'auprc': 0.9872882937342753, 'loss_val': 0.8129689710915694, 'psi': 0.8931162347239138}-{'f1_val': 0.9129212428977468, 'auprc': 0.9965232128365638, 'loss_val': 0.3694407870738943, 'psi': 0.9463620308732736}
[S17] START round=28 head_norm_before_train=1.315367 cos_to_last_merge=0.9991 (last merge round=25)
[S17] round=28 local utility u=0.698086 metrics={'f1_val': 0.5705422464684234, 'auprc': 0.7252194080320633, 'loss_val': 0.7265072746374684, 'psi': 0.6324131110938793}-{'f1_val': 0.38444093110562727, 'auprc': 0.6805171154586902, 'loss_val': 0.8719640943400401, 'psi': 0.5028714048468524}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=28 metric=0.5705 head_norm=1.335060
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.898633e-01
[S17] stored merged vector for next round verification (round=28)
[S17] DEBUG after merge:  round=28 metric=0.5187 head_norm=1.363612 delta_norm=0.189863
[S17] aggregate: ROLLBACK (f1_val pre=0.571 post=0.519 tol_abs=0.005 tol_rel=0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:37114
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.995)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:37112
[S5] not sending this round → trigger blocked (psi=0.992)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1797 to 1 peers)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=28 metric=0.8303 head_norm=1.526984
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.296586e-01
[S16] stored merged vector for next round verification (round=28)
[S16] DEBUG after merge:  round=28 metric=0.8299 head_norm=1.514422 delta_norm=0.129659
[S16] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S10] sending update (kind=head size=1801 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1801) from S10
[S14] cosine check vs S10: cos=0.9937
[S11] RECEIVED delta(kind=head bytes=1797) from S6
[S11] cosine check vs S6: cos=0.9973
[S2] START round=29 head_norm_before_train=1.870906 (no previous merge yet)
[S2] round=29 local utility u=0.568939 metrics={'f1_val': 0.712346364371831, 'auprc': 0.7778164937010913, 'loss_val': 0.4891587825833586, 'psi': 0.7385344161035351}-{'f1_val': 0.6272118939956068, 'auprc': 0.6406388854762992, 'loss_val': 0.7046975913222712, 'psi': 0.6325826905878837}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=29 head_norm_before_train=2.064194 (no previous merge yet)
[S3] round=29 local utility u=0.099313 metrics={'f1_val': 0.9803504866116529, 'auprc': 0.9981543377426116, 'loss_val': 0.06415022862459323, 'psi': 0.9874720270640364}-{'f1_val': 0.9577919690973176, 'auprc': 0.9944344324040374, 'loss_val': 0.11626596288777055, 'psi': 0.9724489544200055}
[S3] not sending this round → trigger blocked (psi=0.987)
[S4] START round=29 head_norm_before_train=1.494204 cos_to_last_merge=0.9350 (last merge round=17)
[S4] ⚠️ Model drifted since last merge! cos=0.935
[S4] round=29 local utility u=0.000000 metrics={'f1_val': 0.9419286451355056, 'auprc': 0.9586922291307798, 'loss_val': 0.26723503751971334, 'psi': 0.9486340787336153}-{'f1_val': 0.9510693818663526, 'auprc': 0.9646506870168821, 'loss_val': 0.26208595909172233, 'psi': 0.9565019039265643}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=29 head_norm_before_train=1.380752 cos_to_last_merge=0.9771 (last merge round=20)
[S5] round=29 local utility u=0.000000 metrics={'f1_val': 0.9235921432003903, 'auprc': 0.99028697031766, 'loss_val': 0.1461605158891678, 'psi': 0.9502700740472981}-{'f1_val': 0.9933679080398908, 'auprc': 0.990749569105215, 'loss_val': 0.13619882417778276, 'psi': 0.9923205724660206}
[S6] START round=29 head_norm_before_train=1.762143 cos_to_last_merge=0.9960 (last merge round=21)
[S6] round=29 local utility u=0.000000 metrics={'f1_val': 0.8122368026211351, 'auprc': 0.8203959096268654, 'loss_val': 0.49386579592455415, 'psi': 0.8155004454234271}-{'f1_val': 0.8237665941669852, 'auprc': 0.823499140089738, 'loss_val': 0.4688448340052739, 'psi': 0.8236596125360862}
[S7] START round=29 head_norm_before_train=1.744484 (no previous merge yet)
[S7] round=29 local utility u=0.095087 metrics={'f1_val': 0.6275590156962287, 'auprc': 0.8024262992604091, 'loss_val': 0.6339514057653971, 'psi': 0.6975059291219009}-{'f1_val': 0.6049957898497293, 'auprc': 0.7938396590507626, 'loss_val': 0.6629856023598973, 'psi': 0.6805333375301427}
[S8] START round=29 head_norm_before_train=1.444567 cos_to_last_merge=0.9992 (last merge round=26)
[S8] round=29 local utility u=0.000000 metrics={'f1_val': 0.9885656966123193, 'auprc': 0.9967889601414531, 'loss_val': 0.09130346582546707, 'psi': 0.9918550020239728}-{'f1_val': 0.9940273225800647, 'auprc': 0.9953332721886733, 'loss_val': 0.10057700363245269, 'psi': 0.9945497024235082}
[S9] START round=29 head_norm_before_train=1.374821 cos_to_last_merge=0.9999 (last merge round=27)
[S9] round=29 local utility u=0.005889 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9971327141536669, 'loss_val': 0.049914863997842195, 'psi': 0.9971148331687525}-{'f1_val': 0.9971029125121428, 'auprc': 0.9952590507170073, 'loss_val': 0.056072810768130116, 'psi': 0.9963653677940886}
[S10] START round=29 head_norm_before_train=1.584584 cos_to_last_merge=0.9835 (last merge round=20)
[S10] round=29 local utility u=0.000396 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9947468077384416, 'loss_val': 0.04500405726700216, 'psi': 0.9950114265070015}-{'f1_val': 0.9947060979488367, 'auprc': 0.995598699540545, 'loss_val': 0.04546159749537956, 'psi': 0.99506313858552}
[S11] START round=29 head_norm_before_train=1.787301 cos_to_last_merge=0.9999 (last merge round=27)
[S11] round=29 local utility u=0.000000 metrics={'f1_val': 0.9563924746028316, 'auprc': 0.9956167108326608, 'loss_val': 0.15288683100628472, 'psi': 0.9720821690947633}-{'f1_val': 0.9962850284706224, 'auprc': 0.9958607995176164, 'loss_val': 0.06718221264402917, 'psi': 0.99611533688942}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=29 metric=0.9564 head_norm=1.813163
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.022086e-02
[S11] stored merged vector for next round verification (round=29)
[S11] DEBUG after merge:  round=29 metric=0.9564 head_norm=1.786034 delta_norm=0.080221
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S13] START round=29 head_norm_before_train=1.283042 cos_to_last_merge=1.0000 (last merge round=28)
[S13] round=29 local utility u=0.000000 metrics={'f1_val': 0.6272770208927888, 'auprc': 0.6163258776859214, 'loss_val': 0.6216874622009548, 'psi': 0.6228965636100419}-{'f1_val': 0.6340420723446276, 'auprc': 0.6236291282703559, 'loss_val': 0.5855626340421553, 'psi': 0.6298768947149189}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=29 head_norm_before_train=1.493487 cos_to_last_merge=0.9998 (last merge round=27)
[S14] round=29 local utility u=0.010844 metrics={'f1_val': 0.9972408627570057, 'auprc': 0.999217062510536, 'loss_val': 0.11426004853244086, 'psi': 0.9980313426584178}-{'f1_val': 0.9970207327224484, 'auprc': 0.9992484859528444, 'loss_val': 0.1347208673256011, 'psi': 0.9979118340146068}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S14] sending update (kind=head size=1806 to 1 peers)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=29 metric=0.9972 head_norm=1.515867
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.043438e-01
[S14] stored merged vector for next round verification (round=29)
[S14] DEBUG after merge:  round=29 metric=0.9972 head_norm=1.547091 delta_norm=0.104344
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S15] START round=29 head_norm_before_train=1.542197 cos_to_last_merge=0.9879 (last merge round=19)
[S15] round=29 local utility u=1.000000 metrics={'f1_val': 0.892857542038914, 'auprc': 0.9926082866418624, 'loss_val': 0.13779942853252722, 'psi': 0.9327578398800933}-{'f1_val': 0.6983283881970873, 'auprc': 0.8264153175250442, 'loss_val': 0.48294557224534546, 'psi': 0.74956315992827}
[S16] START round=29 head_norm_before_train=1.514422 cos_to_last_merge=1.0000 (last merge round=28)
[S16] round=29 local utility u=0.686706 metrics={'f1_val': 0.9479613948156587, 'auprc': 0.9960775157215057, 'loss_val': 0.17168447316149135, 'psi': 0.9672078431779975}-{'f1_val': 0.8303348620503395, 'auprc': 0.9872882937342753, 'loss_val': 0.8129689710915694, 'psi': 0.8931162347239138}
[S17] START round=29 head_norm_before_train=1.363612 cos_to_last_merge=1.0000 (last merge round=28)
[S17] round=29 local utility u=0.000000 metrics={'f1_val': 0.44468526961800997, 'auprc': 0.90767447123495, 'loss_val': 0.5936408974171542, 'psi': 0.629880950264786}-{'f1_val': 0.5705422464684234, 'auprc': 0.7252194080320633, 'loss_val': 0.7265072746374684, 'psi': 0.6324131110938793}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:37116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:37111
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:37113
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:37109
[S10] not sending this round → trigger blocked (psi=0.995)
[S16] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1797) from S9
[S13] cosine check vs S9: cos=0.9597
[S8] RECEIVED delta(kind=head bytes=1801) from S16
[S8] cosine check vs S16: cos=0.9542
[S10] RECEIVED delta(kind=head bytes=1800) from S7
[S10] cosine check vs S7: cos=-0.0059
[S10] DROPPED delta from S7 (cos=-0.0059 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1798) from S15
[S16] cosine check vs S15: cos=0.9938
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=29 metric=0.9480 head_norm=1.540445
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.814051e-02
[S16] stored merged vector for next round verification (round=29)
[S16] DEBUG after merge:  round=29 metric=0.9432 head_norm=1.553282 delta_norm=0.088141
[S16] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=30 head_norm_before_train=1.876712 (no previous merge yet)
[S2] round=30 local utility u=0.000000 metrics={'f1_val': 0.6919715522484278, 'auprc': 0.7367005162143176, 'loss_val': 0.49206960100496483, 'psi': 0.7098631378347837}-{'f1_val': 0.712346364371831, 'auprc': 0.7778164937010913, 'loss_val': 0.4891587825833586, 'psi': 0.7385344161035351}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=30 head_norm_before_train=2.078123 (no previous merge yet)
[S3] round=30 local utility u=0.000000 metrics={'f1_val': 0.8889640118936392, 'auprc': 0.9906185976370517, 'loss_val': 0.20153991615281847, 'psi': 0.9296258461910042}-{'f1_val': 0.9803504866116529, 'auprc': 0.9981543377426116, 'loss_val': 0.06415022862459323, 'psi': 0.9874720270640364}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=30 head_norm_before_train=1.513286 cos_to_last_merge=0.9316 (last merge round=17)
[S4] ⚠️ Model drifted since last merge! cos=0.932
[S4] round=30 local utility u=0.000000 metrics={'f1_val': 0.940493838435596, 'auprc': 0.9509164370595544, 'loss_val': 0.27236360998267917, 'psi': 0.9446628778851793}-{'f1_val': 0.9419286451355056, 'auprc': 0.9586922291307798, 'loss_val': 0.26723503751971334, 'psi': 0.9486340787336153}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=30 head_norm_before_train=1.392775 cos_to_last_merge=0.9763 (last merge round=20)
[S5] round=30 local utility u=0.256513 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9931595278847086, 'loss_val': 0.08041016566379995, 'psi': 0.9952849922409581}-{'f1_val': 0.9235921432003903, 'auprc': 0.99028697031766, 'loss_val': 0.1461605158891678, 'psi': 0.9502700740472981}
[S6] START round=30 head_norm_before_train=1.772253 cos_to_last_merge=0.9952 (last merge round=21)
[S6] round=30 local utility u=0.848381 metrics={'f1_val': 0.961911793157048, 'auprc': 0.9683894328717584, 'loss_val': 0.13913366353286738, 'psi': 0.9645028490429322}-{'f1_val': 0.8122368026211351, 'auprc': 0.8203959096268654, 'loss_val': 0.49386579592455415, 'psi': 0.8155004454234271}
[S7] START round=30 head_norm_before_train=1.760632 (no previous merge yet)
[S7] round=30 local utility u=0.000000 metrics={'f1_val': 0.5766316205857919, 'auprc': 0.7926769704371928, 'loss_val': 0.8355676521171386, 'psi': 0.6630497605263522}-{'f1_val': 0.6275590156962287, 'auprc': 0.8024262992604091, 'loss_val': 0.6339514057653971, 'psi': 0.6975059291219009}
[S8] START round=30 head_norm_before_train=1.474025 cos_to_last_merge=0.9982 (last merge round=26)
[S8] round=30 local utility u=0.000000 metrics={'f1_val': 0.9925279616884268, 'auprc': 0.9831998043918659, 'loss_val': 0.1092914007226985, 'psi': 0.9887966987698025}-{'f1_val': 0.9885656966123193, 'auprc': 0.9967889601414531, 'loss_val': 0.09130346582546707, 'psi': 0.9918550020239728}
[S9] START round=30 head_norm_before_train=1.401284 cos_to_last_merge=0.9994 (last merge round=27)
[S9] round=30 local utility u=0.000000 metrics={'f1_val': 0.9888915175754751, 'auprc': 0.9984553490866741, 'loss_val': 0.06385121419830601, 'psi': 0.9927170501799547}-{'f1_val': 0.9971029125121428, 'auprc': 0.9971327141536669, 'loss_val': 0.049914863997842195, 'psi': 0.9971148331687525}
[S10] START round=30 head_norm_before_train=1.614181 cos_to_last_merge=0.9815 (last merge round=20)
[S10] round=30 local utility u=0.002978 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9950808616304595, 'loss_val': 0.04005031542650361, 'psi': 0.9951450480638087}-{'f1_val': 0.9951878390193748, 'auprc': 0.9947468077384416, 'loss_val': 0.04500405726700216, 'psi': 0.9950114265070015}
[S11] START round=30 head_norm_before_train=1.786034 cos_to_last_merge=1.0000 (last merge round=29)
[S11] round=30 local utility u=0.164599 metrics={'f1_val': 0.9962850284706224, 'auprc': 0.9936380103225605, 'loss_val': 0.05710759502648746, 'psi': 0.9952262212113977}-{'f1_val': 0.9563924746028316, 'auprc': 0.9956167108326608, 'loss_val': 0.15288683100628472, 'psi': 0.9720821690947633}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=30 head_norm_before_train=1.298394 cos_to_last_merge=0.9998 (last merge round=28)
[S13] round=30 local utility u=0.024524 metrics={'f1_val': 0.6320012168735066, 'auprc': 0.61585017269478, 'loss_val': 0.5995572127570744, 'psi': 0.625540799202016}-{'f1_val': 0.6272770208927888, 'auprc': 0.6163258776859214, 'loss_val': 0.6216874622009548, 'psi': 0.6228965636100419}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=30 metric=0.6320 head_norm=1.320167
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.073459e-01
[S13] stored merged vector for next round verification (round=30)
[S13] DEBUG after merge:  round=30 metric=0.6328 head_norm=1.345447 delta_norm=0.207346
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S14] START round=30 head_norm_before_train=1.547091 cos_to_last_merge=1.0000 (last merge round=29)
[S14] round=30 local utility u=0.002581 metrics={'f1_val': 0.9966100132760906, 'auprc': 0.9992230191170925, 'loss_val': 0.10533087028612678, 'psi': 0.9976552156124914}-{'f1_val': 0.9972408627570057, 'auprc': 0.999217062510536, 'loss_val': 0.11426004853244086, 'psi': 0.9980313426584178}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=30 head_norm_before_train=1.570967 cos_to_last_merge=0.9861 (last merge round=19)
[S15] round=30 local utility u=0.000000 metrics={'f1_val': 0.7011578199677704, 'auprc': 0.8382996534312093, 'loss_val': 0.4716228765109357, 'psi': 0.7560145533531459}-{'f1_val': 0.892857542038914, 'auprc': 0.9926082866418624, 'loss_val': 0.13779942853252722, 'psi': 0.9327578398800933}
[S16] START round=30 head_norm_before_train=1.553282 cos_to_last_merge=1.0000 (last merge round=29)
[S16] round=30 local utility u=0.167959 metrics={'f1_val': 0.9905956100447677, 'auprc': 0.9941641574683834, 'loss_val': 0.08583089286434373, 'psi': 0.992023029014214}-{'f1_val': 0.9479613948156587, 'auprc': 0.9960775157215057, 'loss_val': 0.17168447316149135, 'psi': 0.9672078431779975}
[S17] START round=30 head_norm_before_train=1.388041 cos_to_last_merge=0.9996 (last merge round=28)
[S17] round=30 local utility u=0.277786 metrics={'f1_val': 0.5636740624210699, 'auprc': 0.853384392049476, 'loss_val': 0.5891308656023433, 'psi': 0.6795581942724322}-{'f1_val': 0.44468526961800997, 'auprc': 0.90767447123495, 'loss_val': 0.5936408974171542, 'psi': 0.629880950264786}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S16] not sending this round → trigger blocked (psi=0.992)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:37114
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S5] → sending delta(kind=head bytes=1807) to S9@127.0.0.1:37110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] → sending delta(kind=head bytes=1804) to S11@127.0.0.1:37112
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1804 to 1 peers)
[S5] sending update (kind=head size=1807 to 1 peers)
[S15] ⇄ pheromone p=0.383 → S16@127.0.0.1:37116
[S7] ⇄ pheromone p=0.068 → S10@127.0.0.1:37111
[S10] sending update (kind=head size=1798 to 1 peers)
[S9] ⇄ pheromone p=0.012 → S13@127.0.0.1:37113
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=30 metric=0.9925 head_norm=1.499548
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.397246e-01
[S8] stored merged vector for next round verification (round=30)
[S8] DEBUG after merge:  round=30 metric=0.9918 head_norm=1.501113 delta_norm=0.239725
[S8] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.035 → S17@127.0.0.1:37117
[S16] ⇄ pheromone p=0.215 → S8@127.0.0.1:37109
[S14] RECEIVED delta(kind=head bytes=1798) from S10
[S14] cosine check vs S10: cos=0.9956
[S9] RECEIVED delta(kind=head bytes=1807) from S5
[S9] cosine check vs S5: cos=0.9889
[S11] RECEIVED delta(kind=head bytes=1804) from S6
[S11] cosine check vs S6: cos=0.9981
[S10] ⇄ pheromone p=0.018 → S14@127.0.0.1:37114
[S5] ⇄ pheromone p=0.303 → S9@127.0.0.1:37110
[S6] ⇄ pheromone p=0.396 → S11@127.0.0.1:37112
[S2] START round=31 head_norm_before_train=1.884670 (no previous merge yet)
[S2] round=31 local utility u=0.064502 metrics={'f1_val': 0.686793961939081, 'auprc': 0.8101624895523556, 'loss_val': 0.5523857251860588, 'psi': 0.7361413729843909}-{'f1_val': 0.6919715522484278, 'auprc': 0.7367005162143176, 'loss_val': 0.49206960100496483, 'psi': 0.7098631378347837}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=31 head_norm_before_train=2.093572 (no previous merge yet)
[S3] round=31 local utility u=0.000000 metrics={'f1_val': 0.7976988306273467, 'auprc': 0.9918243877276184, 'loss_val': 0.39816828262416526, 'psi': 0.8753490534674553}-{'f1_val': 0.8889640118936392, 'auprc': 0.9906185976370517, 'loss_val': 0.20153991615281847, 'psi': 0.9296258461910042}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=31 head_norm_before_train=1.527797 cos_to_last_merge=0.9290 (last merge round=17)
[S4] ⚠️ Model drifted since last merge! cos=0.929
[S4] round=31 local utility u=0.062402 metrics={'f1_val': 0.9454148251097676, 'auprc': 0.9788693786685446, 'loss_val': 0.2609447495370621, 'psi': 0.9587966465332785}-{'f1_val': 0.940493838435596, 'auprc': 0.9509164370595544, 'loss_val': 0.27236360998267917, 'psi': 0.9446628778851793}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=31 head_norm_before_train=1.423968 cos_to_last_merge=0.9739 (last merge round=20)
[S5] round=31 local utility u=0.001004 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9922053821840825, 'loss_val': 0.07554003753548905, 'psi': 0.9949033339607076}-{'f1_val': 0.9967019684784577, 'auprc': 0.9931595278847086, 'loss_val': 0.08041016566379995, 'psi': 0.9952849922409581}
[S6] START round=31 head_norm_before_train=1.782676 cos_to_last_merge=0.9943 (last merge round=21)
[S6] round=31 local utility u=0.000000 metrics={'f1_val': 0.8243749762375999, 'auprc': 0.9586207016737248, 'loss_val': 0.42684023197325416, 'psi': 0.8780732664120499}-{'f1_val': 0.961911793157048, 'auprc': 0.9683894328717584, 'loss_val': 0.13913366353286738, 'psi': 0.9645028490429322}
[S7] START round=31 head_norm_before_train=1.771672 (no previous merge yet)
[S7] round=31 local utility u=0.000000 metrics={'f1_val': 0.5612752161049527, 'auprc': 0.7878720954790277, 'loss_val': 0.8230378494722306, 'psi': 0.6519139678545827}-{'f1_val': 0.5766316205857919, 'auprc': 0.7926769704371928, 'loss_val': 0.8355676521171386, 'psi': 0.6630497605263522}
[S8] START round=31 head_norm_before_train=1.501113 cos_to_last_merge=1.0000 (last merge round=30)
[S8] round=31 local utility u=0.009467 metrics={'f1_val': 0.9880725843114774, 'auprc': 0.9955220637160596, 'loss_val': 0.10059112027413326, 'psi': 0.9910523760733103}-{'f1_val': 0.9925279616884268, 'auprc': 0.9831998043918659, 'loss_val': 0.1092914007226985, 'psi': 0.9887966987698025}
[S9] START round=31 head_norm_before_train=1.428435 cos_to_last_merge=0.9987 (last merge round=27)
[S9] round=31 local utility u=0.028587 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9932426893046346, 'loss_val': 0.040308543978395596, 'psi': 0.9955588232291395}-{'f1_val': 0.9888915175754751, 'auprc': 0.9984553490866741, 'loss_val': 0.06385121419830601, 'psi': 0.9927170501799547}
[S10] START round=31 head_norm_before_train=1.637584 cos_to_last_merge=0.9797 (last merge round=20)
[S10] round=31 local utility u=0.002102 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9955900816172859, 'loss_val': 0.03737360398156612, 'psi': 0.9953487360585391}-{'f1_val': 0.9951878390193748, 'auprc': 0.9950808616304595, 'loss_val': 0.04005031542650361, 'psi': 0.9951450480638087}
[S11] START round=31 head_norm_before_train=1.806746 cos_to_last_merge=0.9999 (last merge round=29)
[S11] round=31 local utility u=0.000000 metrics={'f1_val': 0.9458680019864427, 'auprc': 0.9886532797816229, 'loss_val': 0.28617952679988057, 'psi': 0.9629821131045149}-{'f1_val': 0.9962850284706224, 'auprc': 0.9936380103225605, 'loss_val': 0.05710759502648746, 'psi': 0.9952262212113977}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=31 metric=0.9459 head_norm=1.825134
[S11] _apply_head_vector_avg (torch): Δ‖w‖=6.679618e-02
[S11] stored merged vector for next round verification (round=31)
[S11] DEBUG after merge:  round=31 metric=0.9456 head_norm=1.802793 delta_norm=0.066796
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S13] START round=31 head_norm_before_train=1.345447 cos_to_last_merge=1.0000 (last merge round=30)
[S13] round=31 local utility u=0.031589 metrics={'f1_val': 0.6330106581723749, 'auprc': 0.6312712190450649, 'loss_val': 0.5886997233579973, 'psi': 0.6323148825214508}-{'f1_val': 0.6320012168735066, 'auprc': 0.61585017269478, 'loss_val': 0.5995572127570744, 'psi': 0.625540799202016}
[S13] not sending this round → trigger blocked (psi=0.632)
[S14] START round=31 head_norm_before_train=1.573652 cos_to_last_merge=0.9997 (last merge round=29)
[S14] round=31 local utility u=0.012093 metrics={'f1_val': 0.9972630104447024, 'auprc': 0.9992172368732365, 'loss_val': 0.085046250174114, 'psi': 0.9980447010161161}-{'f1_val': 0.9966100132760906, 'auprc': 0.9992230191170925, 'loss_val': 0.10533087028612678, 'psi': 0.9976552156124914}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] sending update (kind=head size=1804 to 1 peers)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=31 metric=0.9973 head_norm=1.601693
[S14] _apply_head_vector_avg (torch): Δ‖w‖=9.303671e-02
[S14] stored merged vector for next round verification (round=31)
[S14] DEBUG after merge:  round=31 metric=0.9973 head_norm=1.617064 delta_norm=0.093037
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S15] START round=31 head_norm_before_train=1.594559 cos_to_last_merge=0.9846 (last merge round=19)
[S15] round=31 local utility u=0.773702 metrics={'f1_val': 0.8386822700631573, 'auprc': 0.988001190549742, 'loss_val': 0.19847033224039623, 'psi': 0.8984098382577912}-{'f1_val': 0.7011578199677704, 'auprc': 0.8382996534312093, 'loss_val': 0.4716228765109357, 'psi': 0.7560145533531459}
[S16] START round=31 head_norm_before_train=1.579447 cos_to_last_merge=0.9998 (last merge round=29)
[S16] round=31 local utility u=0.000000 metrics={'f1_val': 0.9283145792989327, 'auprc': 0.9873246206892122, 'loss_val': 0.3226519548256268, 'psi': 0.9519185958550445}-{'f1_val': 0.9905956100447677, 'auprc': 0.9941641574683834, 'loss_val': 0.08583089286434373, 'psi': 0.992023029014214}
[S17] START round=31 head_norm_before_train=1.420011 cos_to_last_merge=0.9978 (last merge round=28)
[S17] round=31 local utility u=0.445680 metrics={'f1_val': 0.6683503670366502, 'auprc': 0.9226949990589213, 'loss_val': 0.5337600686671957, 'psi': 0.7700882198455586}-{'f1_val': 0.5636740624210699, 'auprc': 0.853384392049476, 'loss_val': 0.5891308656023433, 'psi': 0.6795581942724322}
[S17] not sending this round → trigger blocked (psi=0.770)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:37113
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.995)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:37117
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:37116
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.995)
[S15] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1799) from S9
[S13] cosine check vs S9: cos=0.9870
[S16] RECEIVED delta(kind=head bytes=1799) from S15
[S16] cosine check vs S15: cos=0.9955
[S17] RECEIVED delta(kind=head bytes=1799) from S8
[S17] cosine check vs S8: cos=0.9617
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=31 metric=0.9971 head_norm=1.453767
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.168878e-01
[S9] stored merged vector for next round verification (round=31)
[S9] DEBUG after merge:  round=31 metric=0.9971 head_norm=1.434189 delta_norm=0.116888
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=32 head_norm_before_train=1.896145 (no previous merge yet)
[S2] round=32 local utility u=0.000000 metrics={'f1_val': 0.5605603156190013, 'auprc': 0.6392181661349259, 'loss_val': 1.061584041150308, 'psi': 0.5920234558253712}-{'f1_val': 0.686793961939081, 'auprc': 0.8101624895523556, 'loss_val': 0.5523857251860588, 'psi': 0.7361413729843909}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=32 head_norm_before_train=2.107561 (no previous merge yet)
[S3] round=32 local utility u=0.610241 metrics={'f1_val': 0.9572190140804552, 'auprc': 0.9912481206793937, 'loss_val': 0.13307864725507332, 'psi': 0.9708306567200307}-{'f1_val': 0.7976988306273467, 'auprc': 0.9918243877276184, 'loss_val': 0.39816828262416526, 'psi': 0.8753490534674553}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] sending update (kind=head size=1794 to 1 peers)
[S4] START round=32 head_norm_before_train=1.541665 cos_to_last_merge=0.9268 (last merge round=17)
[S4] ⚠️ Model drifted since last merge! cos=0.927
[S4] round=32 local utility u=0.000000 metrics={'f1_val': 0.9432597481885634, 'auprc': 0.955584651427412, 'loss_val': 0.2668900421863663, 'psi': 0.9481897094841027}-{'f1_val': 0.9454148251097676, 'auprc': 0.9788693786685446, 'loss_val': 0.2609447495370621, 'psi': 0.9587966465332785}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=32 head_norm_before_train=1.468443 cos_to_last_merge=0.9700 (last merge round=20)
[S5] round=32 local utility u=0.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9899034935436741, 'loss_val': 0.07256422782964095, 'psi': 0.9939825785045442}-{'f1_val': 0.9967019684784577, 'auprc': 0.9922053821840825, 'loss_val': 0.07554003753548905, 'psi': 0.9949033339607076}
[S6] START round=32 head_norm_before_train=1.792992 cos_to_last_merge=0.9933 (last merge round=21)
[S6] round=32 local utility u=0.062913 metrics={'f1_val': 0.8262292198896499, 'auprc': 0.9599266783047344, 'loss_val': 0.3160577153340279, 'psi': 0.8797082032556838}-{'f1_val': 0.8243749762375999, 'auprc': 0.9586207016737248, 'loss_val': 0.42684023197325416, 'psi': 0.8780732664120499}
[S7] START round=32 head_norm_before_train=1.776056 (no previous merge yet)
[S7] round=32 local utility u=0.232177 metrics={'f1_val': 0.6127840792673054, 'auprc': 0.7971705751408649, 'loss_val': 0.6956332983436154, 'psi': 0.6865386776167292}-{'f1_val': 0.5612752161049527, 'auprc': 0.7878720954790277, 'loss_val': 0.8230378494722306, 'psi': 0.6519139678545827}
[S8] START round=32 head_norm_before_train=1.521372 cos_to_last_merge=0.9999 (last merge round=30)
[S8] round=32 local utility u=0.007047 metrics={'f1_val': 0.9930990485370332, 'auprc': 0.9859907329204758, 'loss_val': 0.0880621740204302, 'psi': 0.9902557222904103}-{'f1_val': 0.9880725843114774, 'auprc': 0.9955220637160596, 'loss_val': 0.10059112027413326, 'psi': 0.9910523760733103}
[S9] START round=32 head_norm_before_train=1.434189 cos_to_last_merge=1.0000 (last merge round=31)
[S9] round=32 local utility u=0.000000 metrics={'f1_val': 0.9956098104564366, 'auprc': 0.9984511658228444, 'loss_val': 0.049097497053184024, 'psi': 0.9967463526029997}-{'f1_val': 0.9971029125121428, 'auprc': 0.9932426893046346, 'loss_val': 0.040308543978395596, 'psi': 0.9955588232291395}
[S10] START round=32 head_norm_before_train=1.658912 cos_to_last_merge=0.9779 (last merge round=20)
[S10] round=32 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9944993605702253, 'loss_val': 0.03788657459770159, 'psi': 0.9949124476397149}-{'f1_val': 0.9951878390193748, 'auprc': 0.9955900816172859, 'loss_val': 0.03737360398156612, 'psi': 0.9953487360585391}
[S11] START round=32 head_norm_before_train=1.802793 cos_to_last_merge=1.0000 (last merge round=31)
[S11] round=32 local utility u=0.273800 metrics={'f1_val': 0.9962850284706224, 'auprc': 0.9931920635216221, 'loss_val': 0.054697824517961166, 'psi': 0.9950478424910223}-{'f1_val': 0.9458680019864427, 'auprc': 0.9886532797816229, 'loss_val': 0.28617952679988057, 'psi': 0.9629821131045149}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=32 head_norm_before_train=1.364151 cos_to_last_merge=0.9998 (last merge round=30)
[S13] round=32 local utility u=0.000000 metrics={'f1_val': 0.6127056552440123, 'auprc': 0.5744612743080899, 'loss_val': 0.7005757464473381, 'psi': 0.5974079028696434}-{'f1_val': 0.6330106581723749, 'auprc': 0.6312712190450649, 'loss_val': 0.5886997233579973, 'psi': 0.6323148825214508}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=32 metric=0.6127 head_norm=1.387975
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.332852e-01
[S13] stored merged vector for next round verification (round=32)
[S13] DEBUG after merge:  round=32 metric=0.6137 head_norm=1.414988 delta_norm=0.133285
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S14] START round=32 head_norm_before_train=1.617064 cos_to_last_merge=1.0000 (last merge round=31)
[S14] round=32 local utility u=0.000000 metrics={'f1_val': 0.9967353681956432, 'auprc': 0.9991195363027243, 'loss_val': 0.08681764781975601, 'psi': 0.9976890354384756}-{'f1_val': 0.9972630104447024, 'auprc': 0.9992172368732365, 'loss_val': 0.085046250174114, 'psi': 0.9980447010161161}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=32 head_norm_before_train=1.618373 cos_to_last_merge=0.9828 (last merge round=19)
[S15] round=32 local utility u=0.000000 metrics={'f1_val': 0.7748381461467244, 'auprc': 0.9622988019820162, 'loss_val': 0.3577730368815869, 'psi': 0.8498224084808411}-{'f1_val': 0.8386822700631573, 'auprc': 0.988001190549742, 'loss_val': 0.19847033224039623, 'psi': 0.8984098382577912}
[S16] START round=32 head_norm_before_train=1.604949 cos_to_last_merge=0.9993 (last merge round=29)
[S16] round=32 local utility u=0.280059 metrics={'f1_val': 0.9821561652796311, 'auprc': 0.9916361574438255, 'loss_val': 0.09851806112006778, 'psi': 0.9859481621453088}-{'f1_val': 0.9283145792989327, 'auprc': 0.9873246206892122, 'loss_val': 0.3226519548256268, 'psi': 0.9519185958550445}
[S17] START round=32 head_norm_before_train=1.452439 cos_to_last_merge=0.9948 (last merge round=28)
[S17] round=32 local utility u=0.631285 metrics={'f1_val': 0.8393010549851596, 'auprc': 0.9695781885382213, 'loss_val': 0.4375432149954047, 'psi': 0.8914119084063843}-{'f1_val': 0.6683503670366502, 'auprc': 0.9226949990589213, 'loss_val': 0.5337600686671957, 'psi': 0.7700882198455586}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S17] sending update (kind=head size=1806 to 1 peers)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=32 metric=0.8393 head_norm=1.481043
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.202227e-01
[S17] stored merged vector for next round verification (round=32)
[S17] DEBUG after merge:  round=32 metric=0.8537 head_norm=1.485104 delta_norm=0.220223
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:37112
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:37111
[S8] not sending this round → trigger blocked (psi=0.990)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:37109
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1801) from S16
[S8] cosine check vs S16: cos=0.9792
[S11] RECEIVED delta(kind=head bytes=1801) from S6
[S11] cosine check vs S6: cos=0.9986
[S10] RECEIVED delta(kind=head bytes=1800) from S7
[S10] cosine check vs S7: cos=-0.0058
[S10] DROPPED delta from S7 (cos=-0.0058 < 0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=32 metric=0.9822 head_norm=1.629233
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.834112e-02
[S16] stored merged vector for next round verification (round=32)
[S16] DEBUG after merge:  round=32 metric=0.9785 head_norm=1.621407 delta_norm=0.088341
[S16] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=33 head_norm_before_train=1.908300 (no previous merge yet)
[S2] round=33 local utility u=0.932398 metrics={'f1_val': 0.7162096659910111, 'auprc': 0.7867310570358432, 'loss_val': 0.5732218798527707, 'psi': 0.744418222408944}-{'f1_val': 0.5605603156190013, 'auprc': 0.6392181661349259, 'loss_val': 1.061584041150308, 'psi': 0.5920234558253712}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=33 head_norm_before_train=2.123314 (no previous merge yet)
[S3] round=33 local utility u=0.118719 metrics={'f1_val': 0.9782543508892907, 'auprc': 0.9996678816811961, 'loss_val': 0.0471114366724333, 'psi': 0.9868197632060529}-{'f1_val': 0.9572190140804552, 'auprc': 0.9912481206793937, 'loss_val': 0.13307864725507332, 'psi': 0.9708306567200307}
[S3] not sending this round → trigger blocked (psi=0.987)
[S4] START round=33 head_norm_before_train=1.559925 cos_to_last_merge=0.9241 (last merge round=17)
[S4] ⚠️ Model drifted since last merge! cos=0.924
[S4] round=33 local utility u=0.042696 metrics={'f1_val': 0.9531229487964952, 'auprc': 0.9587538640757072, 'loss_val': 0.25018562995964894, 'psi': 0.9553753149081801}-{'f1_val': 0.9432597481885634, 'auprc': 0.955584651427412, 'loss_val': 0.2668900421863663, 'psi': 0.9481897094841027}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=33 head_norm_before_train=1.506079 cos_to_last_merge=0.9660 (last merge round=20)
[S5] round=33 local utility u=0.024108 metrics={'f1_val': 0.9974365845193254, 'auprc': 0.9995390256997008, 'loss_val': 0.0576617781214743, 'psi': 0.9982775609914756}-{'f1_val': 0.9967019684784577, 'auprc': 0.9899034935436741, 'loss_val': 0.07256422782964095, 'psi': 0.9939825785045442}
[S6] START round=33 head_norm_before_train=1.803810 cos_to_last_merge=0.9922 (last merge round=21)
[S6] round=33 local utility u=0.000000 metrics={'f1_val': 0.7897335558888632, 'auprc': 0.9496414147203704, 'loss_val': 0.5183817054514513, 'psi': 0.8536966994214661}-{'f1_val': 0.8262292198896499, 'auprc': 0.9599266783047344, 'loss_val': 0.3160577153340279, 'psi': 0.8797082032556838}
[S7] START round=33 head_norm_before_train=1.784080 (no previous merge yet)
[S7] round=33 local utility u=0.087933 metrics={'f1_val': 0.6189264955668144, 'auprc': 0.8007687685779561, 'loss_val': 0.5674163809330355, 'psi': 0.6916634047712711}-{'f1_val': 0.6127840792673054, 'auprc': 0.7971705751408649, 'loss_val': 0.6956332983436154, 'psi': 0.6865386776167292}
[S8] START round=33 head_norm_before_train=1.541883 cos_to_last_merge=0.9995 (last merge round=30)
[S8] round=33 local utility u=0.016906 metrics={'f1_val': 0.9922069265978078, 'auprc': 0.9947619536848071, 'loss_val': 0.07521185116929172, 'psi': 0.9932289374326075}-{'f1_val': 0.9930990485370332, 'auprc': 0.9859907329204758, 'loss_val': 0.0880621740204302, 'psi': 0.9902557222904103}
[S9] START round=33 head_norm_before_train=1.456276 cos_to_last_merge=0.9999 (last merge round=31)
[S9] round=33 local utility u=0.002094 metrics={'f1_val': 0.9956098104564366, 'auprc': 0.9984414151498835, 'loss_val': 0.044880519764015255, 'psi': 0.9967424523338153}-{'f1_val': 0.9956098104564366, 'auprc': 0.9984511658228444, 'loss_val': 0.049097497053184024, 'psi': 0.9967463526029997}
[S10] START round=33 head_norm_before_train=1.678304 cos_to_last_merge=0.9762 (last merge round=20)
[S10] round=33 local utility u=0.002495 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9954103459973893, 'loss_val': 0.03562883780855125, 'psi': 0.9952768418105806}-{'f1_val': 0.9951878390193748, 'auprc': 0.9944993605702253, 'loss_val': 0.03788657459770159, 'psi': 0.9949124476397149}
[S11] START round=33 head_norm_before_train=1.817379 cos_to_last_merge=1.0000 (last merge round=31)
[S11] round=33 local utility u=0.000000 metrics={'f1_val': 0.9509994117707721, 'auprc': 0.9894363309045896, 'loss_val': 0.22329067501573088, 'psi': 0.966374179424299}-{'f1_val': 0.9962850284706224, 'auprc': 0.9931920635216221, 'loss_val': 0.054697824517961166, 'psi': 0.9950478424910223}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=33 metric=0.9510 head_norm=1.831132
[S11] _apply_head_vector_avg (torch): Δ‖w‖=5.563321e-02
[S11] stored merged vector for next round verification (round=33)
[S11] DEBUG after merge:  round=33 metric=0.9510 head_norm=1.816671 delta_norm=0.055633
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S13] START round=33 head_norm_before_train=1.414988 cos_to_last_merge=1.0000 (last merge round=32)
[S13] round=33 local utility u=0.290305 metrics={'f1_val': 0.6284876560925527, 'auprc': 0.7048834830494479, 'loss_val': 0.6059249176866912, 'psi': 0.6590459868753109}-{'f1_val': 0.6127056552440123, 'auprc': 0.5744612743080899, 'loss_val': 0.7005757464473381, 'psi': 0.5974079028696434}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=33 head_norm_before_train=1.640335 cos_to_last_merge=0.9998 (last merge round=31)
[S14] round=33 local utility u=0.007363 metrics={'f1_val': 0.9972630104447024, 'auprc': 0.9991997235852779, 'loss_val': 0.07549763032532664, 'psi': 0.9980376957009326}-{'f1_val': 0.9967353681956432, 'auprc': 0.9991195363027243, 'loss_val': 0.08681764781975601, 'psi': 0.9976890354384756}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] sending update (kind=head size=1805 to 1 peers)
[S15] START round=33 head_norm_before_train=1.643024 cos_to_last_merge=0.9809 (last merge round=19)
[S15] round=33 local utility u=0.877799 metrics={'f1_val': 0.9967630768980411, 'auprc': 0.9976644687255047, 'loss_val': 0.03982124173395484, 'psi': 0.9971236336290266}-{'f1_val': 0.7748381461467244, 'auprc': 0.9622988019820162, 'loss_val': 0.3577730368815869, 'psi': 0.8498224084808411}
[S16] START round=33 head_norm_before_train=1.621407 cos_to_last_merge=1.0000 (last merge round=32)
[S16] round=33 local utility u=0.027095 metrics={'f1_val': 0.9895938432138617, 'auprc': 0.9882143398995634, 'loss_val': 0.07868902703739077, 'psi': 0.9890420418881424}-{'f1_val': 0.9821561652796311, 'auprc': 0.9916361574438255, 'loss_val': 0.09851806112006778, 'psi': 0.9859481621453088}
[S17] START round=33 head_norm_before_train=1.485104 cos_to_last_merge=1.0000 (last merge round=32)
[S17] round=33 local utility u=0.000000 metrics={'f1_val': 0.5624246415300203, 'auprc': 0.6989050131202026, 'loss_val': 0.8274919892320188, 'psi': 0.6170167901660932}-{'f1_val': 0.8393010549851596, 'auprc': 0.9695781885382213, 'loss_val': 0.4375432149954047, 'psi': 0.8914119084063843}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.692)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:37113
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:37114
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:37110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:37116
[S16] not sending this round → trigger blocked (psi=0.989)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:37117
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1803) from S5
[S9] cosine check vs S5: cos=0.9895
[S14] RECEIVED delta(kind=head bytes=1795) from S10
[S14] cosine check vs S10: cos=0.9952
[S17] RECEIVED delta(kind=head bytes=1802) from S8
[S17] cosine check vs S8: cos=0.9887
[S13] RECEIVED delta(kind=head bytes=1801) from S9
[S13] cosine check vs S9: cos=0.9888
[S16] RECEIVED delta(kind=head bytes=1797) from S15
[S16] cosine check vs S15: cos=0.9969
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=33 metric=0.9956 head_norm=1.479299
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.129592e-01
[S9] stored merged vector for next round verification (round=33)
[S9] DEBUG after merge:  round=33 metric=0.9956 head_norm=1.503562 delta_norm=0.112959
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=33 metric=0.9922 head_norm=1.563380
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.761876e-01
[S8] stored merged vector for next round verification (round=33)
[S8] DEBUG after merge:  round=33 metric=0.9922 head_norm=1.586895 delta_norm=0.176188
[S8] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=34 head_norm_before_train=1.918923 (no previous merge yet)
[S2] round=34 local utility u=0.000000 metrics={'f1_val': 0.6894966807553613, 'auprc': 0.7646697719510434, 'loss_val': 0.5685260202129689, 'psi': 0.7195659172336342}-{'f1_val': 0.7162096659910111, 'auprc': 0.7867310570358432, 'loss_val': 0.5732218798527707, 'psi': 0.744418222408944}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=34 head_norm_before_train=2.136909 (no previous merge yet)
[S3] round=34 local utility u=0.000000 metrics={'f1_val': 0.9592227308692924, 'auprc': 0.996773830337236, 'loss_val': 0.12977802313331413, 'psi': 0.9742431706564698}-{'f1_val': 0.9782543508892907, 'auprc': 0.9996678816811961, 'loss_val': 0.0471114366724333, 'psi': 0.9868197632060529}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=34 head_norm_before_train=1.577156 cos_to_last_merge=0.9213 (last merge round=17)
[S4] ⚠️ Model drifted since last merge! cos=0.921
[S4] round=34 local utility u=0.000214 metrics={'f1_val': 0.953217923549927, 'auprc': 0.9586806723690657, 'loss_val': 0.2501084306474478, 'psi': 0.9554030230775825}-{'f1_val': 0.9531229487964952, 'auprc': 0.9587538640757072, 'loss_val': 0.25018562995964894, 'psi': 0.9553753149081801}
[S4] not sending this round → trigger blocked (psi=0.955)
[S5] START round=34 head_norm_before_train=1.535770 cos_to_last_merge=0.9630 (last merge round=20)
[S5] round=34 local utility u=0.002595 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9973999508389695, 'loss_val': 0.04385169575318191, 'psi': 0.9972017155022264}-{'f1_val': 0.9974365845193254, 'auprc': 0.9995390256997008, 'loss_val': 0.0576617781214743, 'psi': 0.9982775609914756}
[S6] START round=34 head_norm_before_train=1.813609 cos_to_last_merge=0.9912 (last merge round=21)
[S6] round=34 local utility u=0.000000 metrics={'f1_val': 0.6345599821826892, 'auprc': 0.833165166718631, 'loss_val': 0.5097825745123766, 'psi': 0.7140020559970659}-{'f1_val': 0.7897335558888632, 'auprc': 0.9496414147203704, 'loss_val': 0.5183817054514513, 'psi': 0.8536966994214661}
[S7] START round=34 head_norm_before_train=1.791245 (no previous merge yet)
[S7] round=34 local utility u=0.000000 metrics={'f1_val': 0.5995993051076587, 'auprc': 0.7953366278809437, 'loss_val': 0.6969749859110898, 'psi': 0.6778942342169727}-{'f1_val': 0.6189264955668144, 'auprc': 0.8007687685779561, 'loss_val': 0.5674163809330355, 'psi': 0.6916634047712711}
[S8] START round=34 head_norm_before_train=1.586895 cos_to_last_merge=1.0000 (last merge round=33)
[S8] round=34 local utility u=0.000000 metrics={'f1_val': 0.9931148882341876, 'auprc': 0.9812749111766794, 'loss_val': 0.08664718774917245, 'psi': 0.9883788974111843}-{'f1_val': 0.9922069265978078, 'auprc': 0.9947619536848071, 'loss_val': 0.07521185116929172, 'psi': 0.9932289374326075}
[S9] START round=34 head_norm_before_train=1.503562 cos_to_last_merge=1.0000 (last merge round=33)
[S9] round=34 local utility u=0.004457 metrics={'f1_val': 0.9964388212112862, 'auprc': 0.9991313169621112, 'loss_val': 0.04300962102789114, 'psi': 0.9975158195116163}-{'f1_val': 0.9956098104564366, 'auprc': 0.9984414151498835, 'loss_val': 0.044880519764015255, 'psi': 0.9967424523338153}
[S10] START round=34 head_norm_before_train=1.694934 cos_to_last_merge=0.9747 (last merge round=20)
[S10] round=34 local utility u=0.001170 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9958274838954764, 'loss_val': 0.03454094472006976, 'psi': 0.9954436969698154}-{'f1_val': 0.9951878390193748, 'auprc': 0.9954103459973893, 'loss_val': 0.03562883780855125, 'psi': 0.9952768418105806}
[S11] START round=34 head_norm_before_train=1.816671 cos_to_last_merge=1.0000 (last merge round=33)
[S11] round=34 local utility u=0.226656 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.993751048346319, 'loss_val': 0.057260630613196584, 'psi': 0.9955338710874369}-{'f1_val': 0.9509994117707721, 'auprc': 0.9894363309045896, 'loss_val': 0.22329067501573088, 'psi': 0.966374179424299}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=34 head_norm_before_train=1.435602 cos_to_last_merge=0.9997 (last merge round=32)
[S13] round=34 local utility u=0.229256 metrics={'f1_val': 0.6680086723824992, 'auprc': 0.7454897174285289, 'loss_val': 0.5063581758964091, 'psi': 0.6990010904009111}-{'f1_val': 0.6284876560925527, 'auprc': 0.7048834830494479, 'loss_val': 0.6059249176866912, 'psi': 0.6590459868753109}
[S13] not sending this round → trigger blocked (psi=0.699)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=34 metric=0.6680 head_norm=1.452856
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.224792e-01
[S13] stored merged vector for next round verification (round=34)
[S13] DEBUG after merge:  round=34 metric=0.6697 head_norm=1.461012 delta_norm=0.122479
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S14] START round=34 head_norm_before_train=1.658781 cos_to_last_merge=0.9994 (last merge round=31)
[S14] round=34 local utility u=0.005207 metrics={'f1_val': 0.9970441294227608, 'auprc': 0.9991454561262243, 'loss_val': 0.06360734946460683, 'psi': 0.9978846601041462}-{'f1_val': 0.9972630104447024, 'auprc': 0.9991997235852779, 'loss_val': 0.07549763032532664, 'psi': 0.9980376957009326}
[S14] not sending this round → trigger blocked (psi=0.998)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=34 metric=0.9970 head_norm=1.678896
[S14] _apply_head_vector_avg (torch): Δ‖w‖=9.346940e-02
[S14] stored merged vector for next round verification (round=34)
[S14] DEBUG after merge:  round=34 metric=0.9970 head_norm=1.684342 delta_norm=0.093469
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S15] START round=34 head_norm_before_train=1.664610 cos_to_last_merge=0.9792 (last merge round=19)
[S15] round=34 local utility u=0.000000 metrics={'f1_val': 0.7010713433702593, 'auprc': 0.7993711993597928, 'loss_val': 0.6030500677312898, 'psi': 0.7403912857660728}-{'f1_val': 0.9967630768980411, 'auprc': 0.9976644687255047, 'loss_val': 0.03982124173395484, 'psi': 0.9971236336290266}
[S16] START round=34 head_norm_before_train=1.644717 cos_to_last_merge=0.9999 (last merge round=32)
[S16] round=34 local utility u=0.000000 metrics={'f1_val': 0.9726791200144764, 'auprc': 0.9899157664189515, 'loss_val': 0.11269599586578323, 'psi': 0.9795737785762664}-{'f1_val': 0.9895938432138617, 'auprc': 0.9882143398995634, 'loss_val': 0.07868902703739077, 'psi': 0.9890420418881424}
[S17] START round=34 head_norm_before_train=1.508718 cos_to_last_merge=0.9997 (last merge round=32)
[S17] round=34 local utility u=0.421115 metrics={'f1_val': 0.5908528548651857, 'auprc': 0.8767971589010595, 'loss_val': 0.6895084045454213, 'psi': 0.7052305764795352}-{'f1_val': 0.5624246415300203, 'auprc': 0.6989050131202026, 'loss_val': 0.8274919892320188, 'psi': 0.6170167901660932}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=34 metric=0.5909 head_norm=1.533024
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.300135e-01
[S17] stored merged vector for next round verification (round=34)
[S17] DEBUG after merge:  round=34 metric=0.5909 head_norm=1.542808 delta_norm=0.130014
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.998)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.997)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.995)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=34 metric=0.9727 head_norm=1.667270
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.497822e-02
[S16] stored merged vector for next round verification (round=34)
[S16] DEBUG after merge:  round=34 metric=0.9705 head_norm=1.664252 delta_norm=0.074978
[S16] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=35 head_norm_before_train=1.928970 (no previous merge yet)
[S2] round=35 local utility u=0.000000 metrics={'f1_val': 0.6716303956300066, 'auprc': 0.756180676801439, 'loss_val': 0.6634260456498494, 'psi': 0.7054505080985796}-{'f1_val': 0.6894966807553613, 'auprc': 0.7646697719510434, 'loss_val': 0.5685260202129689, 'psi': 0.7195659172336342}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=35 head_norm_before_train=2.148534 (no previous merge yet)
[S3] round=35 local utility u=0.015973 metrics={'f1_val': 0.9574810266848766, 'auprc': 0.9970739197456706, 'loss_val': 0.0882815353341963, 'psi': 0.9733181839091942}-{'f1_val': 0.9592227308692924, 'auprc': 0.996773830337236, 'loss_val': 0.12977802313331413, 'psi': 0.9742431706564698}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=35 head_norm_before_train=1.587011 cos_to_last_merge=0.9201 (last merge round=17)
[S4] ⚠️ Model drifted since last merge! cos=0.920
[S4] round=35 local utility u=0.000000 metrics={'f1_val': 0.9362309142584487, 'auprc': 0.9434918290090253, 'loss_val': 0.33199556841203137, 'psi': 0.9391352801586794}-{'f1_val': 0.953217923549927, 'auprc': 0.9586806723690657, 'loss_val': 0.2501084306474478, 'psi': 0.9554030230775825}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=35 head_norm_before_train=1.556950 cos_to_last_merge=0.9606 (last merge round=20)
[S5] round=35 local utility u=0.000205 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9982481169375707, 'loss_val': 0.045986661857228536, 'psi': 0.9975409819416668}-{'f1_val': 0.9970695586110643, 'auprc': 0.9973999508389695, 'loss_val': 0.04385169575318191, 'psi': 0.9972017155022264}
[S6] START round=35 head_norm_before_train=1.825155 cos_to_last_merge=0.9903 (last merge round=21)
[S6] round=35 local utility u=0.823519 metrics={'f1_val': 0.8311412869284365, 'auprc': 0.9535959811344279, 'loss_val': 0.403524431412692, 'psi': 0.8801231646108331}-{'f1_val': 0.6345599821826892, 'auprc': 0.833165166718631, 'loss_val': 0.5097825745123766, 'psi': 0.7140020559970659}
[S7] START round=35 head_norm_before_train=1.802909 (no previous merge yet)
[S7] round=35 local utility u=0.293662 metrics={'f1_val': 0.6494339949494102, 'auprc': 0.8106314457879358, 'loss_val': 0.4545426033108307, 'psi': 0.7139129752848205}-{'f1_val': 0.5995993051076587, 'auprc': 0.7953366278809437, 'loss_val': 0.6969749859110898, 'psi': 0.6778942342169727}
[S8] START round=35 head_norm_before_train=1.608251 cos_to_last_merge=0.9998 (last merge round=33)
[S8] round=35 local utility u=0.004534 metrics={'f1_val': 0.9922069265978078, 'auprc': 0.9821781100843933, 'loss_val': 0.07484089853634557, 'psi': 0.988195399992442}-{'f1_val': 0.9931148882341876, 'auprc': 0.9812749111766794, 'loss_val': 0.08664718774917245, 'psi': 0.9883788974111843}
[S9] START round=35 head_norm_before_train=1.523988 cos_to_last_merge=0.9999 (last merge round=33)
[S9] round=35 local utility u=0.000000 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9962397665494276, 'loss_val': 0.038739567131636315, 'psi': 0.9966074578751254}-{'f1_val': 0.9964388212112862, 'auprc': 0.9991313169621112, 'loss_val': 0.04300962102789114, 'psi': 0.9975158195116163}
[S10] START round=35 head_norm_before_train=1.712520 cos_to_last_merge=0.9733 (last merge round=20)
[S10] round=35 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9946897825747263, 'loss_val': 0.03536520606657312, 'psi': 0.9949886164415154}-{'f1_val': 0.9951878390193748, 'auprc': 0.9958274838954764, 'loss_val': 0.03454094472006976, 'psi': 0.9954436969698154}
[S11] START round=35 head_norm_before_train=1.830397 cos_to_last_merge=1.0000 (last merge round=33)
[S11] round=35 local utility u=0.000000 metrics={'f1_val': 0.9550437457721495, 'auprc': 0.9930821544512165, 'loss_val': 0.2048639867587565, 'psi': 0.9702591092437762}-{'f1_val': 0.9967224195815153, 'auprc': 0.993751048346319, 'loss_val': 0.057260630613196584, 'psi': 0.9955338710874369}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=35 head_norm_before_train=1.461012 cos_to_last_merge=1.0000 (last merge round=34)
[S13] round=35 local utility u=0.000000 metrics={'f1_val': 0.6035368129008358, 'auprc': 0.6820501521957464, 'loss_val': 0.7041384620271377, 'psi': 0.6349421486188}-{'f1_val': 0.6680086723824992, 'auprc': 0.7454897174285289, 'loss_val': 0.5063581758964091, 'psi': 0.6990010904009111}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=35 head_norm_before_train=1.684342 cos_to_last_merge=1.0000 (last merge round=34)
[S14] round=35 local utility u=0.000000 metrics={'f1_val': 0.99684558233404, 'auprc': 0.9992003368274566, 'loss_val': 0.06663047924198837, 'psi': 0.9977874841314066}-{'f1_val': 0.9970441294227608, 'auprc': 0.9991454561262243, 'loss_val': 0.06360734946460683, 'psi': 0.9978846601041462}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=35 head_norm_before_train=1.678884 cos_to_last_merge=0.9780 (last merge round=19)
[S15] round=35 local utility u=1.000000 metrics={'f1_val': 0.8832762594047141, 'auprc': 0.9876015331274234, 'loss_val': 0.17359168117153506, 'psi': 0.9250063688937978}-{'f1_val': 0.7010713433702593, 'auprc': 0.7993711993597928, 'loss_val': 0.6030500677312898, 'psi': 0.7403912857660728}
[S16] START round=35 head_norm_before_train=1.664252 cos_to_last_merge=1.0000 (last merge round=34)
[S16] round=35 local utility u=0.000000 metrics={'f1_val': 0.9718245736754285, 'auprc': 0.9883303475695647, 'loss_val': 0.11666767437701712, 'psi': 0.978426883233083}-{'f1_val': 0.9726791200144764, 'auprc': 0.9899157664189515, 'loss_val': 0.11269599586578323, 'psi': 0.9795737785762664}
[S17] START round=35 head_norm_before_train=1.542808 cos_to_last_merge=1.0000 (last merge round=34)
[S17] round=35 local utility u=0.203129 metrics={'f1_val': 0.6273563491830592, 'auprc': 0.8985253692470407, 'loss_val': 0.5674551994598667, 'psi': 0.7358239572086518}-{'f1_val': 0.5908528548651857, 'auprc': 0.8767971589010595, 'loss_val': 0.6895084045454213, 'psi': 0.7052305764795352}
[S17] not sending this round → trigger blocked (psi=0.736)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:37116
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:37117
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:37110
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S7] → sending delta(kind=head bytes=1793) to S10@127.0.0.1:37111
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] → sending delta(kind=head bytes=1805) to S11@127.0.0.1:37112
[S5] sending update (kind=head size=1804 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S16] ⇄ pheromone p=0.103 → S8@127.0.0.1:37109
[S6] sending update (kind=head size=1805 to 1 peers)
[S7] sending update (kind=head size=1793 to 1 peers)
[S9] ⇄ pheromone p=0.007 → S13@127.0.0.1:37113
[S10] ⇄ pheromone p=0.007 → S14@127.0.0.1:37114
[S15] sending update (kind=head size=1800 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1804) from S5
[S9] cosine check vs S5: cos=0.9939
[S17] RECEIVED delta(kind=head bytes=1800) from S8
[S17] cosine check vs S8: cos=0.9877
[S16] RECEIVED delta(kind=head bytes=1800) from S15
[S16] cosine check vs S15: cos=0.9980
[S10] RECEIVED delta(kind=head bytes=1793) from S7
[S10] cosine check vs S7: cos=-0.0069
[S10] DROPPED delta from S7 (cos=-0.0069 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1805) from S6
[S11] cosine check vs S6: cos=0.9983
[S15] ⇄ pheromone p=0.501 → S16@127.0.0.1:37116
[S7] ⇄ pheromone p=0.116 → S10@127.0.0.1:37111
[S6] ⇄ pheromone p=0.301 → S11@127.0.0.1:37112
[S8] ⇄ pheromone p=0.016 → S17@127.0.0.1:37117
[S5] ⇄ pheromone p=0.103 → S9@127.0.0.1:37110
[S2] START round=36 head_norm_before_train=1.936798 (no previous merge yet)
[S2] round=36 local utility u=0.216549 metrics={'f1_val': 0.69786024477706, 'auprc': 0.8109692826131815, 'loss_val': 0.552072221544236, 'psi': 0.7431038599115085}-{'f1_val': 0.6716303956300066, 'auprc': 0.756180676801439, 'loss_val': 0.6634260456498494, 'psi': 0.7054505080985796}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=36 head_norm_before_train=2.159136 (no previous merge yet)
[S3] round=36 local utility u=0.000000 metrics={'f1_val': 0.8950019398676201, 'auprc': 0.9892509921501682, 'loss_val': 0.20725124881891976, 'psi': 0.9327015607806394}-{'f1_val': 0.9574810266848766, 'auprc': 0.9970739197456706, 'loss_val': 0.0882815353341963, 'psi': 0.9733181839091942}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=36 head_norm_before_train=1.596807 cos_to_last_merge=0.9187 (last merge round=17)
[S4] ⚠️ Model drifted since last merge! cos=0.919
[S4] round=36 local utility u=0.015358 metrics={'f1_val': 0.9376330672873565, 'auprc': 0.9405529161250559, 'loss_val': 0.3008753323878308, 'psi': 0.9388010068224363}-{'f1_val': 0.9362309142584487, 'auprc': 0.9434918290090253, 'loss_val': 0.33199556841203137, 'psi': 0.9391352801586794}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] sending update (kind=head size=1805 to 1 peers)
[S5] START round=36 head_norm_before_train=1.582325 cos_to_last_merge=0.9581 (last merge round=20)
[S5] round=36 local utility u=0.000000 metrics={'f1_val': 0.9923994891858905, 'auprc': 0.9991841453473918, 'loss_val': 0.10191441377024757, 'psi': 0.995113351650491}-{'f1_val': 0.9970695586110643, 'auprc': 0.9982481169375707, 'loss_val': 0.045986661857228536, 'psi': 0.9975409819416668}
[S6] START round=36 head_norm_before_train=1.835620 cos_to_last_merge=0.9892 (last merge round=21)
[S6] round=36 local utility u=0.000000 metrics={'f1_val': 0.8263599928626583, 'auprc': 0.9579659038782465, 'loss_val': 0.4243456321308685, 'psi': 0.8790023572688936}-{'f1_val': 0.8311412869284365, 'auprc': 0.9535959811344279, 'loss_val': 0.403524431412692, 'psi': 0.8801231646108331}
[S7] START round=36 head_norm_before_train=1.817085 (no previous merge yet)
[S7] round=36 local utility u=0.000000 metrics={'f1_val': 0.6234858011672577, 'auprc': 0.8004889204326501, 'loss_val': 0.700142936916359, 'psi': 0.6942870488734147}-{'f1_val': 0.6494339949494102, 'auprc': 0.8106314457879358, 'loss_val': 0.4545426033108307, 'psi': 0.7139129752848205}
[S8] START round=36 head_norm_before_train=1.633996 cos_to_last_merge=0.9993 (last merge round=33)
[S8] round=36 local utility u=0.004537 metrics={'f1_val': 0.9925712794554754, 'auprc': 0.9816512665861565, 'loss_val': 0.06637160442073374, 'psi': 0.9882032743077478}-{'f1_val': 0.9922069265978078, 'auprc': 0.9821781100843933, 'loss_val': 0.07484089853634557, 'psi': 0.988195399992442}
[S9] START round=36 head_norm_before_train=1.543969 cos_to_last_merge=0.9996 (last merge round=33)
[S9] round=36 local utility u=0.000000 metrics={'f1_val': 0.9956098104564366, 'auprc': 0.9987384008524475, 'loss_val': 0.03980559060956893, 'psi': 0.9968612466148409}-{'f1_val': 0.9968525854255906, 'auprc': 0.9962397665494276, 'loss_val': 0.038739567131636315, 'psi': 0.9966074578751254}
[S10] START round=36 head_norm_before_train=1.729767 cos_to_last_merge=0.9720 (last merge round=20)
[S10] round=36 local utility u=0.003449 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.996140802324641, 'loss_val': 0.032820460732626545, 'psi': 0.9955690243414812}-{'f1_val': 0.9951878390193748, 'auprc': 0.9946897825747263, 'loss_val': 0.03536520606657312, 'psi': 0.9949886164415154}
[S11] START round=36 head_norm_before_train=1.845472 cos_to_last_merge=0.9998 (last merge round=33)
[S11] round=36 local utility u=0.207532 metrics={'f1_val': 0.9962850284706224, 'auprc': 0.9958574806889946, 'loss_val': 0.04557383004309312, 'psi': 0.9961140093579713}-{'f1_val': 0.9550437457721495, 'auprc': 0.9930821544512165, 'loss_val': 0.2048639867587565, 'psi': 0.9702591092437762}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=36 metric=0.9963 head_norm=1.859453
[S11] _apply_head_vector_avg (torch): Δ‖w‖=6.121999e-02
[S11] stored merged vector for next round verification (round=36)
[S11] DEBUG after merge:  round=36 metric=0.9963 head_norm=1.846560 delta_norm=0.061220
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S13] START round=36 head_norm_before_train=1.476450 cos_to_last_merge=0.9998 (last merge round=34)
[S13] round=36 local utility u=0.000000 metrics={'f1_val': 0.6249886007061947, 'auprc': 0.5914302035594088, 'loss_val': 0.6710761305203284, 'psi': 0.6115652418474803}-{'f1_val': 0.6035368129008358, 'auprc': 0.6820501521957464, 'loss_val': 0.7041384620271377, 'psi': 0.6349421486188}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=36 head_norm_before_train=1.704156 cos_to_last_merge=0.9999 (last merge round=34)
[S14] round=36 local utility u=0.000000 metrics={'f1_val': 0.9936811042174911, 'auprc': 0.9991914140957993, 'loss_val': 0.06855422591463355, 'psi': 0.9958852281688144}-{'f1_val': 0.99684558233404, 'auprc': 0.9992003368274566, 'loss_val': 0.06663047924198837, 'psi': 0.9977874841314066}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=36 head_norm_before_train=1.692097 cos_to_last_merge=0.9769 (last merge round=19)
[S15] round=36 local utility u=0.000000 metrics={'f1_val': 0.8053585652606882, 'auprc': 0.9884431460863107, 'loss_val': 0.23835702295630565, 'psi': 0.8785923975909372}-{'f1_val': 0.8832762594047141, 'auprc': 0.9876015331274234, 'loss_val': 0.17359168117153506, 'psi': 0.9250063688937978}
[S16] START round=36 head_norm_before_train=1.685631 cos_to_last_merge=0.9999 (last merge round=34)
[S16] round=36 local utility u=0.093088 metrics={'f1_val': 0.9913147287828071, 'auprc': 0.9926944452768761, 'loss_val': 0.060525093878447976, 'psi': 0.9918666153804347}-{'f1_val': 0.9718245736754285, 'auprc': 0.9883303475695647, 'loss_val': 0.11666767437701712, 'psi': 0.978426883233083}
[S17] START round=36 head_norm_before_train=1.567456 cos_to_last_merge=0.9998 (last merge round=34)
[S17] round=36 local utility u=0.369645 metrics={'f1_val': 0.7123477960833059, 'auprc': 0.943546292625513, 'loss_val': 0.47317761433803796, 'psi': 0.8048271947001888}-{'f1_val': 0.6273563491830592, 'auprc': 0.8985253692470407, 'loss_val': 0.5674551994598667, 'psi': 0.7358239572086518}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S17] sending update (kind=head size=1808 to 1 peers)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=36 metric=0.7123 head_norm=1.595487
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.401067e-01
[S17] stored merged vector for next round verification (round=36)
[S17] DEBUG after merge:  round=36 metric=0.7163 head_norm=1.608767 delta_norm=0.140107
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:37114
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:37109
[S8] not sending this round → trigger blocked (psi=0.988)
[S10] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=36 metric=0.9956 head_norm=1.558966
[S9] _apply_head_vector_avg (torch): Δ‖w‖=9.317461e-02
[S9] stored merged vector for next round verification (round=36)
[S9] DEBUG after merge:  round=36 metric=0.9956 head_norm=1.567923 delta_norm=0.093175
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S8] RECEIVED delta(kind=head bytes=1801) from S16
[S8] cosine check vs S16: cos=0.9823
[S14] RECEIVED delta(kind=head bytes=1798) from S10
[S14] cosine check vs S10: cos=0.9959
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=36 metric=0.9913 head_norm=1.706333
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.381353e-02
[S16] stored merged vector for next round verification (round=36)
[S16] DEBUG after merge:  round=36 metric=0.9913 head_norm=1.698031 delta_norm=0.063814
[S16] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=37 head_norm_before_train=1.946497 (no previous merge yet)
[S2] round=37 local utility u=0.000000 metrics={'f1_val': 0.698798191087434, 'auprc': 0.7868517661780512, 'loss_val': 0.5802535898742309, 'psi': 0.7340196211236809}-{'f1_val': 0.69786024477706, 'auprc': 0.8109692826131815, 'loss_val': 0.552072221544236, 'psi': 0.7431038599115085}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=37 head_norm_before_train=2.170682 (no previous merge yet)
[S3] round=37 local utility u=0.271328 metrics={'f1_val': 0.9602392389949276, 'auprc': 0.999017661320853, 'loss_val': 0.08531942936485361, 'psi': 0.9757506079252978}-{'f1_val': 0.8950019398676201, 'auprc': 0.9892509921501682, 'loss_val': 0.20725124881891976, 'psi': 0.9327015607806394}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] sending update (kind=head size=1795 to 1 peers)
[S4] START round=37 head_norm_before_train=1.603515 cos_to_last_merge=0.9173 (last merge round=17)
[S4] ⚠️ Model drifted since last merge! cos=0.917
[S4] round=37 local utility u=0.031739 metrics={'f1_val': 0.9404331980202274, 'auprc': 0.9473867786351003, 'loss_val': 0.27470007024837007, 'psi': 0.9432146302661766}-{'f1_val': 0.9376330672873565, 'auprc': 0.9405529161250559, 'loss_val': 0.3008753323878308, 'psi': 0.9388010068224363}
[S4] not sending this round → trigger blocked (psi=0.943)
[S5] START round=37 head_norm_before_train=1.611374 cos_to_last_merge=0.9551 (last merge round=20)
[S5] round=37 local utility u=0.042653 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.999000445928838, 'loss_val': 0.041873040706770025, 'psi': 0.9976213594586099}-{'f1_val': 0.9923994891858905, 'auprc': 0.9991841453473918, 'loss_val': 0.10191441377024757, 'psi': 0.995113351650491}
[S6] START round=37 head_norm_before_train=1.847222 cos_to_last_merge=0.9878 (last merge round=21)
[S6] round=37 local utility u=0.574692 metrics={'f1_val': 0.9617672851825588, 'auprc': 0.9708898384211642, 'loss_val': 0.12617814700423113, 'psi': 0.9654163064780009}-{'f1_val': 0.8263599928626583, 'auprc': 0.9579659038782465, 'loss_val': 0.4243456321308685, 'psi': 0.8790023572688936}
[S7] START round=37 head_norm_before_train=1.823110 (no previous merge yet)
[S7] round=37 local utility u=0.084076 metrics={'f1_val': 0.6278614567855383, 'auprc': 0.8049879350962766, 'loss_val': 0.5717427225643033, 'psi': 0.6987120481098337}-{'f1_val': 0.6234858011672577, 'auprc': 0.8004889204326501, 'loss_val': 0.700142936916359, 'psi': 0.6942870488734147}
[S8] START round=37 head_norm_before_train=1.658633 cos_to_last_merge=0.9984 (last merge round=33)
[S8] round=37 local utility u=0.004347 metrics={'f1_val': 0.9925712794554754, 'auprc': 0.9823553318190118, 'loss_val': 0.05978893342487312, 'psi': 0.98848490040089}-{'f1_val': 0.9925712794554754, 'auprc': 0.9816512665861565, 'loss_val': 0.06637160442073374, 'psi': 0.9882032743077478}
[S9] START round=37 head_norm_before_train=1.567923 cos_to_last_merge=1.0000 (last merge round=36)
[S9] round=37 local utility u=0.000000 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9937380241394046, 'loss_val': 0.03912231989741724, 'psi': 0.9955107044146192}-{'f1_val': 0.9956098104564366, 'auprc': 0.9987384008524475, 'loss_val': 0.03980559060956893, 'psi': 0.9968612466148409}
[S10] START round=37 head_norm_before_train=1.746228 cos_to_last_merge=0.9709 (last merge round=20)
[S10] round=37 local utility u=0.000873 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9962133652945437, 'loss_val': 0.03210457640054689, 'psi': 0.9956792184560557}-{'f1_val': 0.9951878390193748, 'auprc': 0.996140802324641, 'loss_val': 0.032820460732626545, 'psi': 0.9955690243414812}
[S11] START round=37 head_norm_before_train=1.846560 cos_to_last_merge=1.0000 (last merge round=36)
[S11] round=37 local utility u=0.000000 metrics={'f1_val': 0.9962850284706224, 'auprc': 0.9958178792146968, 'loss_val': 0.04684944646299542, 'psi': 0.9960981687682522}-{'f1_val': 0.9962850284706224, 'auprc': 0.9958574806889946, 'loss_val': 0.04557383004309312, 'psi': 0.9961140093579713}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=37 head_norm_before_train=1.495484 cos_to_last_merge=0.9993 (last merge round=34)
[S13] round=37 local utility u=0.000000 metrics={'f1_val': 0.6107833069709457, 'auprc': 0.628049845549325, 'loss_val': 0.7026379348116255, 'psi': 0.6176899224022974}-{'f1_val': 0.6249886007061947, 'auprc': 0.5914302035594088, 'loss_val': 0.6710761305203284, 'psi': 0.6115652418474803}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=37 head_norm_before_train=1.724995 cos_to_last_merge=0.9996 (last merge round=34)
[S14] round=37 local utility u=0.020342 metrics={'f1_val': 0.9973269879856502, 'auprc': 0.9989678175463982, 'loss_val': 0.04907527417211343, 'psi': 0.9979833198099495}-{'f1_val': 0.9936811042174911, 'auprc': 0.9991914140957993, 'loss_val': 0.06855422591463355, 'psi': 0.9958852281688144}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=37 metric=0.9973 head_norm=1.744521
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.837904e-02
[S14] stored merged vector for next round verification (round=37)
[S14] DEBUG after merge:  round=37 metric=0.9973 head_norm=1.743136 delta_norm=0.088379
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S15] START round=37 head_norm_before_train=1.704978 cos_to_last_merge=0.9760 (last merge round=19)
[S15] round=37 local utility u=0.000000 metrics={'f1_val': 0.7729810742842392, 'auprc': 0.9352389076880481, 'loss_val': 0.42117180316182273, 'psi': 0.8378842076457628}-{'f1_val': 0.8053585652606882, 'auprc': 0.9884431460863107, 'loss_val': 0.23835702295630565, 'psi': 0.8785923975909372}
[S16] START round=37 head_norm_before_train=1.698031 cos_to_last_merge=1.0000 (last merge round=36)
[S16] round=37 local utility u=0.000000 metrics={'f1_val': 0.9707642408076445, 'auprc': 0.9879163320867365, 'loss_val': 0.11646864419708415, 'psi': 0.9776250773192813}-{'f1_val': 0.9913147287828071, 'auprc': 0.9926944452768761, 'loss_val': 0.060525093878447976, 'psi': 0.9918666153804347}
[S17] START round=37 head_norm_before_train=1.608767 cos_to_last_merge=1.0000 (last merge round=36)
[S17] round=37 local utility u=0.000000 metrics={'f1_val': 0.6102510222586193, 'auprc': 0.8253574208643359, 'loss_val': 0.8047692447903135, 'psi': 0.6962935817009059}-{'f1_val': 0.7123477960833059, 'auprc': 0.943546292625513, 'loss_val': 0.47317761433803796, 'psi': 0.8048271947001888}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:37111
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:37117
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S11@127.0.0.1:37112
[S10] not sending this round → trigger blocked (psi=0.996)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:37110
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1804 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1804) from S8
[S17] cosine check vs S8: cos=0.9960
[S10] RECEIVED delta(kind=head bytes=1801) from S7
[S10] cosine check vs S7: cos=-0.0070
[S10] DROPPED delta from S7 (cos=-0.0070 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1800) from S5
[S9] cosine check vs S5: cos=0.9962
[S11] RECEIVED delta(kind=head bytes=1803) from S6
[S11] cosine check vs S6: cos=0.9987
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=37 metric=0.9926 head_norm=1.681944
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.711439e-01
[S8] stored merged vector for next round verification (round=37)
[S8] DEBUG after merge:  round=37 metric=0.9926 head_norm=1.685516 delta_norm=0.171144
[S8] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=38 head_norm_before_train=1.958264 (no previous merge yet)
[S2] round=38 local utility u=0.000000 metrics={'f1_val': 0.6650515722860245, 'auprc': 0.7500459588129603, 'loss_val': 0.7677401754758042, 'psi': 0.6990493268967989}-{'f1_val': 0.698798191087434, 'auprc': 0.7868517661780512, 'loss_val': 0.5802535898742309, 'psi': 0.7340196211236809}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=38 head_norm_before_train=2.183445 (no previous merge yet)
[S3] round=38 local utility u=0.000000 metrics={'f1_val': 0.8684289984002721, 'auprc': 0.9717316431041432, 'loss_val': 0.31206827181858415, 'psi': 0.9097500562818206}-{'f1_val': 0.9602392389949276, 'auprc': 0.999017661320853, 'loss_val': 0.08531942936485361, 'psi': 0.9757506079252978}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=38 head_norm_before_train=1.612396 cos_to_last_merge=0.9158 (last merge round=17)
[S4] ⚠️ Model drifted since last merge! cos=0.916
[S4] round=38 local utility u=0.000000 metrics={'f1_val': 0.9379583433618568, 'auprc': 0.9502133660646495, 'loss_val': 0.30014781611635033, 'psi': 0.9428603524429738}-{'f1_val': 0.9404331980202274, 'auprc': 0.9473867786351003, 'loss_val': 0.27470007024837007, 'psi': 0.9432146302661766}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=38 head_norm_before_train=1.636959 cos_to_last_merge=0.9521 (last merge round=20)
[S5] round=38 local utility u=0.006585 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9990803833369645, 'loss_val': 0.03114914621597872, 'psi': 0.9978738885014244}-{'f1_val': 0.9967019684784577, 'auprc': 0.999000445928838, 'loss_val': 0.041873040706770025, 'psi': 0.9976213594586099}
[S6] START round=38 head_norm_before_train=1.859226 cos_to_last_merge=0.9869 (last merge round=21)
[S6] round=38 local utility u=0.000000 metrics={'f1_val': 0.8217578052847521, 'auprc': 0.9124481831242918, 'loss_val': 0.4706012788012144, 'psi': 0.8580339564205679}-{'f1_val': 0.9617672851825588, 'auprc': 0.9708898384211642, 'loss_val': 0.12617814700423113, 'psi': 0.9654163064780009}
[S7] START round=38 head_norm_before_train=1.825685 (no previous merge yet)
[S7] round=38 local utility u=0.259722 metrics={'f1_val': 0.6663909539652297, 'auprc': 0.8278802856352712, 'loss_val': 0.35215236018770807, 'psi': 0.7309866866332464}-{'f1_val': 0.6278614567855383, 'auprc': 0.8049879350962766, 'loss_val': 0.5717427225643033, 'psi': 0.6987120481098337}
[S8] START round=38 head_norm_before_train=1.685516 cos_to_last_merge=1.0000 (last merge round=37)
[S8] round=38 local utility u=0.005066 metrics={'f1_val': 0.9900449566491589, 'auprc': 0.9950826625326875, 'loss_val': 0.0726801477571444, 'psi': 0.9920600390025703}-{'f1_val': 0.9925712794554754, 'auprc': 0.9823553318190118, 'loss_val': 0.05978893342487312, 'psi': 0.98848490040089}
[S9] START round=38 head_norm_before_train=1.583582 cos_to_last_merge=0.9999 (last merge round=36)
[S9] round=38 local utility u=0.000000 metrics={'f1_val': 0.9893150859224193, 'auprc': 0.9987595113803321, 'loss_val': 0.055503682469249985, 'psi': 0.9930928561055844}-{'f1_val': 0.9966924912647621, 'auprc': 0.9937380241394046, 'loss_val': 0.03912231989741724, 'psi': 0.9955107044146192}
[S10] START round=38 head_norm_before_train=1.757770 cos_to_last_merge=0.9698 (last merge round=20)
[S10] round=38 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9948601367860921, 'loss_val': 0.03316594607422369, 'psi': 0.9950567581260616}-{'f1_val': 0.9953231205637304, 'auprc': 0.9962133652945437, 'loss_val': 0.03210457640054689, 'psi': 0.9956792184560557}
[S11] START round=38 head_norm_before_train=1.861664 cos_to_last_merge=1.0000 (last merge round=36)
[S11] round=38 local utility u=0.000000 metrics={'f1_val': 0.9960443128362051, 'auprc': 0.9958432576166103, 'loss_val': 0.04935801362830674, 'psi': 0.9959638907483672}-{'f1_val': 0.9962850284706224, 'auprc': 0.9958178792146968, 'loss_val': 0.04684944646299542, 'psi': 0.9960981687682522}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=38 metric=0.9960 head_norm=1.878436
[S11] _apply_head_vector_avg (torch): Δ‖w‖=5.618618e-02
[S11] stored merged vector for next round verification (round=38)
[S11] DEBUG after merge:  round=38 metric=0.9960 head_norm=1.868011 delta_norm=0.056186
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S13] START round=38 head_norm_before_train=1.515324 cos_to_last_merge=0.9984 (last merge round=34)
[S13] round=38 local utility u=0.096347 metrics={'f1_val': 0.6365693242684172, 'auprc': 0.6405080168578261, 'loss_val': 0.7020341473942472, 'psi': 0.6381448013041808}-{'f1_val': 0.6107833069709457, 'auprc': 0.628049845549325, 'loss_val': 0.7026379348116255, 'psi': 0.6176899224022974}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=38 head_norm_before_train=1.743136 cos_to_last_merge=1.0000 (last merge round=37)
[S14] round=38 local utility u=0.000000 metrics={'f1_val': 0.932017452157626, 'auprc': 0.9990079606837987, 'loss_val': 0.13567111916627475, 'psi': 0.9588136555680951}-{'f1_val': 0.9973269879856502, 'auprc': 0.9989678175463982, 'loss_val': 0.04907527417211343, 'psi': 0.9979833198099495}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=38 head_norm_before_train=1.718380 cos_to_last_merge=0.9750 (last merge round=19)
[S15] round=38 local utility u=0.000000 metrics={'f1_val': 0.7644651895396448, 'auprc': 0.8976800238727233, 'loss_val': 0.4512772280308404, 'psi': 0.8177511232728762}-{'f1_val': 0.7729810742842392, 'auprc': 0.9352389076880481, 'loss_val': 0.42117180316182273, 'psi': 0.8378842076457628}
[S16] START round=38 head_norm_before_train=1.716514 cos_to_last_merge=0.9999 (last merge round=36)
[S16] round=38 local utility u=0.099606 metrics={'f1_val': 0.9917148021162032, 'auprc': 0.9927279040495808, 'loss_val': 0.057394496956276526, 'psi': 0.9921200428895542}-{'f1_val': 0.9707642408076445, 'auprc': 0.9879163320867365, 'loss_val': 0.11646864419708415, 'psi': 0.9776250773192813}
[S17] START round=38 head_norm_before_train=1.630662 cos_to_last_merge=0.9998 (last merge round=36)
[S17] round=38 local utility u=0.258398 metrics={'f1_val': 0.6386340918515373, 'auprc': 0.8895605311948509, 'loss_val': 0.6508816463708538, 'psi': 0.7390046675888627}-{'f1_val': 0.6102510222586193, 'auprc': 0.8253574208643359, 'loss_val': 0.8047692447903135, 'psi': 0.6962935817009059}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=38 metric=0.6386 head_norm=1.651029
[S17] _apply_head_vector_avg (torch): Δ‖w‖=8.816421e-02
[S17] stored merged vector for next round verification (round=38)
[S17] DEBUG after merge:  round=38 metric=0.6513 head_norm=1.664224 delta_norm=0.088164
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:37109
[S8] not sending this round → trigger blocked (psi=0.992)
[S5] not sending this round → trigger blocked (psi=0.998)
[S7] not sending this round → trigger blocked (psi=0.731)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=38 metric=0.9893 head_norm=1.599587
[S9] _apply_head_vector_avg (torch): Δ‖w‖=7.957939e-02
[S9] stored merged vector for next round verification (round=38)
[S9] DEBUG after merge:  round=38 metric=0.9893 head_norm=1.616423 delta_norm=0.079579
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S16] sending update (kind=head size=1796 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1796) from S16
[S8] cosine check vs S16: cos=0.9920
[S2] START round=39 head_norm_before_train=1.971818 (no previous merge yet)
[S2] round=39 local utility u=0.266574 metrics={'f1_val': 0.7071520222059258, 'auprc': 0.8061393816276266, 'loss_val': 0.6554743578692708, 'psi': 0.7467469659746061}-{'f1_val': 0.6650515722860245, 'auprc': 0.7500459588129603, 'loss_val': 0.7677401754758042, 'psi': 0.6990493268967989}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S2] r=40 psi=0.747 u=0.2666 p_local=0.1631 f1=0.707 auprc=0.806 bytes=30525
[S3] START round=39 head_norm_before_train=2.195916 (no previous merge yet)
[S3] round=39 local utility u=0.000000 metrics={'f1_val': 0.8331618163905042, 'auprc': 0.998688188014959, 'loss_val': 0.3266191092453901, 'psi': 0.8993723650402861}-{'f1_val': 0.8684289984002721, 'auprc': 0.9717316431041432, 'loss_val': 0.31206827181858415, 'psi': 0.9097500562818206}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=40 psi=0.899 u=0.0000 p_local=0.0895 f1=0.833 auprc=0.999 bytes=32355
[S4] START round=39 head_norm_before_train=1.622711 cos_to_last_merge=0.9144 (last merge round=17)
[S4] ⚠️ Model drifted since last merge! cos=0.914
[S4] round=39 local utility u=0.033650 metrics={'f1_val': 0.9380650996168707, 'auprc': 0.9649265791284158, 'loss_val': 0.277627359132904, 'psi': 0.9488096914214887}-{'f1_val': 0.9379583433618568, 'auprc': 0.9502133660646495, 'loss_val': 0.30014781611635033, 'psi': 0.9428603524429738}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] sending update (kind=head size=1794 to 1 peers)
[S4] r=40 psi=0.949 u=0.0337 p_local=0.0295 f1=0.938 auprc=0.965 bytes=34131
[S5] START round=39 head_norm_before_train=1.654680 cos_to_last_merge=0.9505 (last merge round=20)
[S5] round=39 local utility u=0.000000 metrics={'f1_val': 0.9974365845193254, 'auprc': 0.9986677195771118, 'loss_val': 0.032516335129076084, 'psi': 0.99792903854244}-{'f1_val': 0.9970695586110643, 'auprc': 0.9990803833369645, 'loss_val': 0.03114914621597872, 'psi': 0.9978738885014244}
[S6] START round=39 head_norm_before_train=1.867743 cos_to_last_merge=0.9859 (last merge round=21)
[S6] round=39 local utility u=0.115976 metrics={'f1_val': 0.8441738770900548, 'auprc': 0.9449765823563118, 'loss_val': 0.47073089788697703, 'psi': 0.8844949591965576}-{'f1_val': 0.8217578052847521, 'auprc': 0.9124481831242918, 'loss_val': 0.4706012788012144, 'psi': 0.8580339564205679}
[S7] START round=39 head_norm_before_train=1.830943 (no previous merge yet)
[S7] round=39 local utility u=0.000000 metrics={'f1_val': 0.6543347854433887, 'auprc': 0.8057725469562351, 'loss_val': 0.5528417189313323, 'psi': 0.7149098900485273}-{'f1_val': 0.6663909539652297, 'auprc': 0.8278802856352712, 'loss_val': 0.35215236018770807, 'psi': 0.7309866866332464}
[S8] START round=39 head_norm_before_train=1.706087 cos_to_last_merge=0.9999 (last merge round=37)
[S8] round=39 local utility u=0.000000 metrics={'f1_val': 0.9929205408612032, 'auprc': 0.979001154230157, 'loss_val': 0.06680680885757848, 'psi': 0.9873527862087847}-{'f1_val': 0.9900449566491589, 'auprc': 0.9950826625326875, 'loss_val': 0.0726801477571444, 'psi': 0.9920600390025703}
[S9] START round=39 head_norm_before_train=1.616423 cos_to_last_merge=1.0000 (last merge round=38)
[S9] round=39 local utility u=0.025683 metrics={'f1_val': 0.99644216417821, 'auprc': 0.9956137628348636, 'loss_val': 0.03746219583868244, 'psi': 0.9961108036408715}-{'f1_val': 0.9893150859224193, 'auprc': 0.9987595113803321, 'loss_val': 0.055503682469249985, 'psi': 0.9930928561055844}
[S10] START round=39 head_norm_before_train=1.770089 cos_to_last_merge=0.9687 (last merge round=20)
[S10] round=39 local utility u=0.002185 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9957270124428638, 'loss_val': 0.03139570241019872, 'psi': 0.9954035083887703}-{'f1_val': 0.9951878390193748, 'auprc': 0.9948601367860921, 'loss_val': 0.03316594607422369, 'psi': 0.9950567581260616}
[S11] START round=39 head_norm_before_train=1.868011 cos_to_last_merge=1.0000 (last merge round=38)
[S11] round=39 local utility u=0.000000 metrics={'f1_val': 0.9962850284706224, 'auprc': 0.9925518994146488, 'loss_val': 0.042164674018060955, 'psi': 0.9947917768482331}-{'f1_val': 0.9960443128362051, 'auprc': 0.9958432576166103, 'loss_val': 0.04935801362830674, 'psi': 0.9959638907483672}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] r=40 psi=0.995 u=0.0000 p_local=0.0576 f1=0.996 auprc=0.993 bytes=32391
[S13] START round=39 head_norm_before_train=1.538224 cos_to_last_merge=0.9971 (last merge round=34)
[S13] round=39 local utility u=0.102675 metrics={'f1_val': 0.6429176800447389, 'auprc': 0.6663424180861398, 'loss_val': 0.6122768474172169, 'psi': 0.6522875752612993}-{'f1_val': 0.6365693242684172, 'auprc': 0.6405080168578261, 'loss_val': 0.7020341473942472, 'psi': 0.6381448013041808}
[S13] not sending this round → trigger blocked (psi=0.652)
[S13] r=40 psi=0.652 u=0.1027 p_local=0.0724 f1=0.643 auprc=0.666 bytes=32373
[S14] START round=39 head_norm_before_train=1.761147 cos_to_last_merge=0.9999 (last merge round=37)
[S14] round=39 local utility u=0.242789 metrics={'f1_val': 0.9977377496967396, 'auprc': 0.999477053301864, 'loss_val': 0.045821304413511794, 'psi': 0.9984334711387893}-{'f1_val': 0.932017452157626, 'auprc': 0.9990079606837987, 'loss_val': 0.13567111916627475, 'psi': 0.9588136555680951}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[S14] r=40 psi=0.998 u=0.2428 p_local=0.0578 f1=0.998 auprc=0.999 bytes=34171
[S15] START round=39 head_norm_before_train=1.731756 cos_to_last_merge=0.9741 (last merge round=19)
[S15] round=39 local utility u=0.550203 metrics={'f1_val': 0.8569825382205097, 'auprc': 0.991890696256557, 'loss_val': 0.18860675097069524, 'psi': 0.9109458014349286}-{'f1_val': 0.7644651895396448, 'auprc': 0.8976800238727233, 'loss_val': 0.4512772280308404, 'psi': 0.8177511232728762}
[S16] START round=39 head_norm_before_train=1.733977 cos_to_last_merge=0.9997 (last merge round=36)
[S16] round=39 local utility u=0.007427 metrics={'f1_val': 0.992139017697923, 'auprc': 0.9956638959369007, 'loss_val': 0.053893406959273124, 'psi': 0.9935489689935141}-{'f1_val': 0.9917148021162032, 'auprc': 0.9927279040495808, 'loss_val': 0.057394496956276526, 'psi': 0.9921200428895542}
[S17] START round=39 head_norm_before_train=1.664224 cos_to_last_merge=1.0000 (last merge round=38)
[S17] round=39 local utility u=0.000000 metrics={'f1_val': 0.6360833841974038, 'auprc': 0.8451871924858332, 'loss_val': 0.78096765930655, 'psi': 0.7197249075127756}-{'f1_val': 0.6386340918515373, 'auprc': 0.8895605311948509, 'loss_val': 0.6508816463708538, 'psi': 0.7390046675888627}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=40 psi=0.720 u=0.0000 p_local=0.1916 f1=0.636 auprc=0.845 bytes=34199
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:37113
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:37114
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:37112
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:37116
[S16] not sending this round → trigger blocked (psi=0.994)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1803 to 1 peers)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=39 metric=0.9929 head_norm=1.727389
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.206980e-01
[S8] stored merged vector for next round verification (round=39)
[S8] DEBUG after merge:  round=39 metric=0.9929 head_norm=1.726472 delta_norm=0.120698
[S8] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S8] r=40 psi=0.987 u=0.0000 p_local=0.0085 f1=0.993 auprc=0.979 bytes=35988
[S6] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S7] r=40 psi=0.715 u=0.0000 p_local=0.0999 f1=0.654 auprc=0.806 bytes=28741
[S5] r=40 psi=0.998 u=0.0000 p_local=0.0486 f1=0.997 auprc=0.999 bytes=34228
[S16] r=40 psi=0.994 u=0.0074 p_local=0.0690 f1=0.992 auprc=0.996 bytes=32337
[S16] RECEIVED delta(kind=head bytes=1795) from S15
[S16] cosine check vs S15: cos=0.9971
[S11] RECEIVED delta(kind=head bytes=1802) from S6
[S11] cosine check vs S6: cos=0.9989
[S14] RECEIVED delta(kind=head bytes=1800) from S10
[S14] cosine check vs S10: cos=0.9968
[S13] RECEIVED delta(kind=head bytes=1803) from S9
[S13] cosine check vs S9: cos=0.9685
[S10] r=40 psi=0.995 u=0.0022 p_local=0.0036 f1=0.995 auprc=0.996 bytes=39576
[S15] r=40 psi=0.911 u=0.5502 p_local=0.3154 f1=0.857 auprc=0.992 bytes=32361
[S6] r=40 psi=0.884 u=0.1160 p_local=0.2200 f1=0.844 auprc=0.945 bytes=32375
[S9] r=40 psi=0.996 u=0.0257 p_local=0.0082 f1=0.996 auprc=0.996 bytes=32359
[S2] START round=40 head_norm_before_train=1.983626 (no previous merge yet)
[S2] round=40 local utility u=0.000000 metrics={'f1_val': 0.6695561118701682, 'auprc': 0.7644127291967888, 'loss_val': 0.8129818661436128, 'psi': 0.7074987588008165}-{'f1_val': 0.7071520222059258, 'auprc': 0.8061393816276266, 'loss_val': 0.6554743578692708, 'psi': 0.7467469659746061}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=40 head_norm_before_train=2.207385 (no previous merge yet)
[S3] round=40 local utility u=0.100157 metrics={'f1_val': 0.8604112524305914, 'auprc': 0.9935833799833375, 'loss_val': 0.27448654376570114, 'psi': 0.9136801034516897}-{'f1_val': 0.8331618163905042, 'auprc': 0.998688188014959, 'loss_val': 0.3266191092453901, 'psi': 0.8993723650402861}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=40 head_norm_before_train=1.632941 cos_to_last_merge=0.9136 (last merge round=17)
[S4] ⚠️ Model drifted since last merge! cos=0.914
[S4] round=40 local utility u=0.039663 metrics={'f1_val': 0.942770800599801, 'auprc': 0.9777624366227395, 'loss_val': 0.26504237239075745, 'psi': 0.9567674550089764}-{'f1_val': 0.9380650996168707, 'auprc': 0.9649265791284158, 'loss_val': 0.277627359132904, 'psi': 0.9488096914214887}
[S4] not sending this round → trigger blocked (psi=0.957)
[S5] START round=40 head_norm_before_train=1.665631 cos_to_last_merge=0.9492 (last merge round=20)
[S5] ⚠️ Model drifted since last merge! cos=0.949
[S5] round=40 local utility u=0.000000 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9982932346260301, 'loss_val': 0.03214363697072127, 'psi': 0.9975590290170506}-{'f1_val': 0.9974365845193254, 'auprc': 0.9986677195771118, 'loss_val': 0.032516335129076084, 'psi': 0.99792903854244}
[S6] START round=40 head_norm_before_train=1.874421 cos_to_last_merge=0.9850 (last merge round=21)
[S6] round=40 local utility u=0.391097 metrics={'f1_val': 0.9195851950255578, 'auprc': 0.9650377264864529, 'loss_val': 0.20118827489425825, 'psi': 0.9377662076099158}-{'f1_val': 0.8441738770900548, 'auprc': 0.9449765823563118, 'loss_val': 0.47073089788697703, 'psi': 0.8844949591965576}
[S7] START round=40 head_norm_before_train=1.837969 (no previous merge yet)
[S7] round=40 local utility u=0.366471 metrics={'f1_val': 0.728151026372433, 'auprc': 0.8317863292488674, 'loss_val': 0.34083929659434475, 'psi': 0.7696051475230068}-{'f1_val': 0.6543347854433887, 'auprc': 0.8057725469562351, 'loss_val': 0.5528417189313323, 'psi': 0.7149098900485273}
[S8] START round=40 head_norm_before_train=1.726472 cos_to_last_merge=1.0000 (last merge round=39)
[S8] round=40 local utility u=0.000000 metrics={'f1_val': 0.9763668728725028, 'auprc': 0.9959084179241736, 'loss_val': 0.09633237885346851, 'psi': 0.9841834908931711}-{'f1_val': 0.9929205408612032, 'auprc': 0.979001154230157, 'loss_val': 0.06680680885757848, 'psi': 0.9873527862087847}
[S9] START round=40 head_norm_before_train=1.632649 cos_to_last_merge=0.9999 (last merge round=38)
[S9] round=40 local utility u=0.007955 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9991346360739151, 'loss_val': 0.03457767387630835, 'psi': 0.9977654056849203}-{'f1_val': 0.99644216417821, 'auprc': 0.9956137628348636, 'loss_val': 0.03746219583868244, 'psi': 0.9961108036408715}
[S10] START round=40 head_norm_before_train=1.783177 cos_to_last_merge=0.9676 (last merge round=20)
[S10] round=40 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9953344290004847, 'loss_val': 0.03139233299544226, 'psi': 0.9952464750118187}-{'f1_val': 0.9951878390193748, 'auprc': 0.9957270124428638, 'loss_val': 0.03139570241019872, 'psi': 0.9954035083887703}
[S11] START round=40 head_norm_before_train=1.884598 cos_to_last_merge=0.9999 (last merge round=38)
[S11] round=40 local utility u=0.000000 metrics={'f1_val': 0.9631709389874293, 'auprc': 0.9937904049144721, 'loss_val': 0.10642393863504675, 'psi': 0.9754187253582465}-{'f1_val': 0.9962850284706224, 'auprc': 0.9925518994146488, 'loss_val': 0.042164674018060955, 'psi': 0.9947917768482331}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=40 metric=0.9632 head_norm=1.900418
[S11] _apply_head_vector_avg (torch): Δ‖w‖=5.393163e-02
[S11] stored merged vector for next round verification (round=40)
[S11] DEBUG after merge:  round=40 metric=0.9625 head_norm=1.886693 delta_norm=0.053932
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S13] START round=40 head_norm_before_train=1.557160 cos_to_last_merge=0.9959 (last merge round=34)
[S13] round=40 local utility u=0.000000 metrics={'f1_val': 0.6138485353059853, 'auprc': 0.585187419240296, 'loss_val': 0.8227703999145027, 'psi': 0.6023840888797096}-{'f1_val': 0.6429176800447389, 'auprc': 0.6663424180861398, 'loss_val': 0.6122768474172169, 'psi': 0.6522875752612993}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=40 metric=0.6138 head_norm=1.571568
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.097083e-01
[S13] stored merged vector for next round verification (round=40)
[S13] DEBUG after merge:  round=40 metric=0.6100 head_norm=1.588618 delta_norm=0.209708
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S14] START round=40 head_norm_before_train=1.778834 cos_to_last_merge=0.9997 (last merge round=37)
[S14] round=40 local utility u=0.000000 metrics={'f1_val': 0.9970441294227608, 'auprc': 0.9994369658350711, 'loss_val': 0.042850688384368445, 'psi': 0.998001263987685}-{'f1_val': 0.9977377496967396, 'auprc': 0.999477053301864, 'loss_val': 0.045821304413511794, 'psi': 0.9984334711387893}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=40 metric=0.9970 head_norm=1.795821
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.076677e-02
[S14] stored merged vector for next round verification (round=40)
[S14] DEBUG after merge:  round=40 metric=0.9970 head_norm=1.787687 delta_norm=0.080767
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S15] START round=40 head_norm_before_train=1.746139 cos_to_last_merge=0.9731 (last merge round=19)
[S15] round=40 local utility u=0.000000 metrics={'f1_val': 0.7010691361715489, 'auprc': 0.7993267187372327, 'loss_val': 0.6264158479000875, 'psi': 0.7403721691978224}-{'f1_val': 0.8569825382205097, 'auprc': 0.991890696256557, 'loss_val': 0.18860675097069524, 'psi': 0.9109458014349286}
[S16] START round=40 head_norm_before_train=1.751014 cos_to_last_merge=0.9994 (last merge round=36)
[S16] round=40 local utility u=0.000000 metrics={'f1_val': 0.991703024727855, 'auprc': 0.994169664470086, 'loss_val': 0.05277416551432087, 'psi': 0.9926896806247474}-{'f1_val': 0.992139017697923, 'auprc': 0.9956638959369007, 'loss_val': 0.053893406959273124, 'psi': 0.9935489689935141}
[S17] START round=40 head_norm_before_train=1.683072 cos_to_last_merge=0.9999 (last merge round=38)
[S17] round=40 local utility u=0.000000 metrics={'f1_val': 0.6260393024272939, 'auprc': 0.8391633056145701, 'loss_val': 0.8945676636767996, 'psi': 0.7112889037022043}-{'f1_val': 0.6360833841974038, 'auprc': 0.8451871924858332, 'loss_val': 0.78096765930655, 'psi': 0.7197249075127756}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.938)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.998)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:37111
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=40 metric=0.9917 head_norm=1.767895
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.473861e-02
[S16] stored merged vector for next round verification (round=40)
[S16] DEBUG after merge:  round=40 metric=0.9917 head_norm=1.755460 delta_norm=0.074739
[S16] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.055 → S8@127.0.0.1:37109
[S7] sending update (kind=head size=1796 to 1 peers)
[S10] ⇄ pheromone p=0.003 → S14@127.0.0.1:37114
[S5] ⇄ pheromone p=0.039 → S9@127.0.0.1:37110
[S9] ⇄ pheromone p=0.008 → S13@127.0.0.1:37113
[S8] ⇄ pheromone p=0.007 → S17@127.0.0.1:37117
[S6] ⇄ pheromone p=0.254 → S11@127.0.0.1:37112
[S15] ⇄ pheromone p=0.252 → S16@127.0.0.1:37116
[S10] RECEIVED delta(kind=head bytes=1796) from S7
[S10] cosine check vs S7: cos=-0.0060
[S10] DROPPED delta from S7 (cos=-0.0060 < 0.0)
[S7] ⇄ pheromone p=0.153 → S10@127.0.0.1:37111
[S2] START round=41 head_norm_before_train=1.994755 (no previous merge yet)
[S2] round=41 local utility u=0.000000 metrics={'f1_val': 0.6601788222624135, 'auprc': 0.763948170108349, 'loss_val': 0.8929809204040665, 'psi': 0.7016865614007877}-{'f1_val': 0.6695561118701682, 'auprc': 0.7644127291967888, 'loss_val': 0.8129818661436128, 'psi': 0.7074987588008165}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=41 head_norm_before_train=2.217978 (no previous merge yet)
[S3] round=41 local utility u=0.003337 metrics={'f1_val': 0.8694599068502097, 'auprc': 0.9810325048333512, 'loss_val': 0.28445132372924326, 'psi': 0.9140889460434662}-{'f1_val': 0.8604112524305914, 'auprc': 0.9935833799833375, 'loss_val': 0.27448654376570114, 'psi': 0.9136801034516897}
[S3] not sending this round → trigger blocked (psi=0.914)
[S4] START round=41 head_norm_before_train=1.643154 cos_to_last_merge=0.9125 (last merge round=17)
[S4] ⚠️ Model drifted since last merge! cos=0.912
[S4] round=41 local utility u=0.000000 metrics={'f1_val': 0.9364116537030931, 'auprc': 0.9560936858407331, 'loss_val': 0.3001397814594012, 'psi': 0.9442844665581491}-{'f1_val': 0.942770800599801, 'auprc': 0.9777624366227395, 'loss_val': 0.26504237239075745, 'psi': 0.9567674550089764}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=41 head_norm_before_train=1.676814 cos_to_last_merge=0.9478 (last merge round=20)
[S5] ⚠️ Model drifted since last merge! cos=0.948
[S5] round=41 local utility u=0.000934 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9989110948880087, 'loss_val': 0.03212873880995073, 'psi': 0.997806173121842}-{'f1_val': 0.9970695586110643, 'auprc': 0.9982932346260301, 'loss_val': 0.03214363697072127, 'psi': 0.9975590290170506}
[S6] START round=41 head_norm_before_train=1.883358 cos_to_last_merge=0.9842 (last merge round=21)
[S6] round=41 local utility u=0.000000 metrics={'f1_val': 0.8263618208318382, 'auprc': 0.9144654428381351, 'loss_val': 0.42450026206467656, 'psi': 0.861603269634357}-{'f1_val': 0.9195851950255578, 'auprc': 0.9650377264864529, 'loss_val': 0.20118827489425825, 'psi': 0.9377662076099158}
[S7] START round=41 head_norm_before_train=1.843009 (no previous merge yet)
[S7] round=41 local utility u=0.000000 metrics={'f1_val': 0.5393102593226875, 'auprc': 0.7831091450474451, 'loss_val': 1.116596426046071, 'psi': 0.6368298136125905}-{'f1_val': 0.728151026372433, 'auprc': 0.8317863292488674, 'loss_val': 0.34083929659434475, 'psi': 0.7696051475230068}
[S8] START round=41 head_norm_before_train=1.745072 cos_to_last_merge=0.9999 (last merge round=39)
[S8] round=41 local utility u=0.000000 metrics={'f1_val': 0.9844741926825348, 'auprc': 0.9804209563524433, 'loss_val': 0.10405106398242218, 'psi': 0.9828528981504983}-{'f1_val': 0.9763668728725028, 'auprc': 0.9959084179241736, 'loss_val': 0.09633237885346851, 'psi': 0.9841834908931711}
[S9] START round=41 head_norm_before_train=1.648586 cos_to_last_merge=0.9997 (last merge round=38)
[S9] round=41 local utility u=0.000000 metrics={'f1_val': 0.99644216417821, 'auprc': 0.995694753415274, 'loss_val': 0.03253598987617383, 'psi': 0.9961431998730356}-{'f1_val': 0.9968525854255906, 'auprc': 0.9991346360739151, 'loss_val': 0.03457767387630835, 'psi': 0.9977654056849203}
[S10] START round=41 head_norm_before_train=1.796437 cos_to_last_merge=0.9666 (last merge round=20)
[S10] round=41 local utility u=0.001028 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9956765172590879, 'loss_val': 0.03036334704484398, 'psi': 0.9953833103152601}-{'f1_val': 0.9951878390193748, 'auprc': 0.9953344290004847, 'loss_val': 0.03139233299544226, 'psi': 0.9952464750118187}
[S11] START round=41 head_norm_before_train=1.886693 cos_to_last_merge=1.0000 (last merge round=40)
[S11] round=41 local utility u=0.131085 metrics={'f1_val': 0.9962850284706224, 'auprc': 0.992899033021889, 'loss_val': 0.04026510540979578, 'psi': 0.994930630291129}-{'f1_val': 0.9631709389874293, 'auprc': 0.9937904049144721, 'loss_val': 0.10642393863504675, 'psi': 0.9754187253582465}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=41 head_norm_before_train=1.588618 cos_to_last_merge=1.0000 (last merge round=40)
[S13] round=41 local utility u=0.503494 metrics={'f1_val': 0.6725796536643422, 'auprc': 0.7537092589560723, 'loss_val': 0.6737336338205971, 'psi': 0.7050314957810342}-{'f1_val': 0.6138485353059853, 'auprc': 0.585187419240296, 'loss_val': 0.8227703999145027, 'psi': 0.6023840888797096}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=41 head_norm_before_train=1.787687 cos_to_last_merge=1.0000 (last merge round=40)
[S14] round=41 local utility u=0.000466 metrics={'f1_val': 0.9974336367705932, 'auprc': 0.9995324042298722, 'loss_val': 0.04454135774365748, 'psi': 0.9982731437543048}-{'f1_val': 0.9970441294227608, 'auprc': 0.9994369658350711, 'loss_val': 0.042850688384368445, 'psi': 0.998001263987685}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=41 head_norm_before_train=1.758564 cos_to_last_merge=0.9722 (last merge round=19)
[S15] round=41 local utility u=1.000000 metrics={'f1_val': 0.9937094069128902, 'auprc': 0.9919754407014898, 'loss_val': 0.04304747261877068, 'psi': 0.9930158204283301}-{'f1_val': 0.7010691361715489, 'auprc': 0.7993267187372327, 'loss_val': 0.6264158479000875, 'psi': 0.7403721691978224}
[S16] START round=41 head_norm_before_train=1.755460 cos_to_last_merge=1.0000 (last merge round=40)
[S16] round=41 local utility u=0.002588 metrics={'f1_val': 0.992139017697923, 'auprc': 0.9954843123403441, 'loss_val': 0.05415812491992029, 'psi': 0.9934771355548915}-{'f1_val': 0.991703024727855, 'auprc': 0.994169664470086, 'loss_val': 0.05277416551432087, 'psi': 0.9926896806247474}
[S17] START round=41 head_norm_before_train=1.703686 cos_to_last_merge=0.9995 (last merge round=38)
[S17] round=41 local utility u=0.469849 metrics={'f1_val': 0.6962825195429524, 'auprc': 0.9304169333327272, 'loss_val': 0.6500888948559622, 'psi': 0.7899362850588623}-{'f1_val': 0.6260393024272939, 'auprc': 0.8391633056145701, 'loss_val': 0.8945676636767996, 'psi': 0.7112889037022043}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] → sending delta(kind=head bytes=1794) to S16@127.0.0.1:37116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:37109
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:37114
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:37110
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1802 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1794 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1794) from S15
[S16] cosine check vs S15: cos=0.9986
[S8] RECEIVED delta(kind=head bytes=1796) from S16
[S8] cosine check vs S16: cos=0.9944
[S9] RECEIVED delta(kind=head bytes=1802) from S5
[S9] cosine check vs S5: cos=0.9953
[S14] RECEIVED delta(kind=head bytes=1802) from S10
[S14] cosine check vs S10: cos=0.9982
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=41 metric=0.9921 head_norm=1.770413
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.706740e-02
[S16] stored merged vector for next round verification (round=41)
[S16] DEBUG after merge:  round=41 metric=0.9921 head_norm=1.768382 delta_norm=0.047067
[S16] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=42 head_norm_before_train=2.007676 (no previous merge yet)
[S2] round=42 local utility u=0.379694 metrics={'f1_val': 0.7151465608660945, 'auprc': 0.828069276073399, 'loss_val': 0.6557636064286435, 'psi': 0.7603156469490163}-{'f1_val': 0.6601788222624135, 'auprc': 0.763948170108349, 'loss_val': 0.8929809204040665, 'psi': 0.7016865614007877}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[S3] START round=42 head_norm_before_train=2.228430 (no previous merge yet)
[S3] round=42 local utility u=0.000000 metrics={'f1_val': 0.8214445875149263, 'auprc': 0.9760775450508808, 'loss_val': 0.38139780627325104, 'psi': 0.8832977705293081}-{'f1_val': 0.8694599068502097, 'auprc': 0.9810325048333512, 'loss_val': 0.28445132372924326, 'psi': 0.9140889460434662}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=42 head_norm_before_train=1.651486 cos_to_last_merge=0.9115 (last merge round=17)
[S4] ⚠️ Model drifted since last merge! cos=0.912
[S4] round=42 local utility u=0.022685 metrics={'f1_val': 0.9368296458485459, 'auprc': 0.9658229694253018, 'loss_val': 0.2864654563933898, 'psi': 0.9484269752792482}-{'f1_val': 0.9364116537030931, 'auprc': 0.9560936858407331, 'loss_val': 0.3001397814594012, 'psi': 0.9442844665581491}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=42 head_norm_before_train=1.690826 cos_to_last_merge=0.9460 (last merge round=20)
[S5] ⚠️ Model drifted since last merge! cos=0.946
[S5] round=42 local utility u=0.000000 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9981745971135875, 'loss_val': 0.03326903940724765, 'psi': 0.9975115740120736}-{'f1_val': 0.9970695586110643, 'auprc': 0.9989110948880087, 'loss_val': 0.03212873880995073, 'psi': 0.997806173121842}
[S6] START round=42 head_norm_before_train=1.892372 cos_to_last_merge=0.9836 (last merge round=21)
[S6] round=42 local utility u=0.000000 metrics={'f1_val': 0.8130039012356982, 'auprc': 0.9422671303722002, 'loss_val': 0.544441930771554, 'psi': 0.864709192890299}-{'f1_val': 0.8263618208318382, 'auprc': 0.9144654428381351, 'loss_val': 0.42450026206467656, 'psi': 0.861603269634357}
[S7] START round=42 head_norm_before_train=1.853317 (no previous merge yet)
[S7] round=42 local utility u=0.402862 metrics={'f1_val': 0.6114418459393017, 'auprc': 0.7970578328683289, 'loss_val': 0.7855077398383978, 'psi': 0.6856882407109126}-{'f1_val': 0.5393102593226875, 'auprc': 0.7831091450474451, 'loss_val': 1.116596426046071, 'psi': 0.6368298136125905}
[S8] START round=42 head_norm_before_train=1.760424 cos_to_last_merge=0.9996 (last merge round=39)
[S8] round=42 local utility u=0.050125 metrics={'f1_val': 0.9924611780272952, 'auprc': 0.9827944967737655, 'loss_val': 0.058843108376683516, 'psi': 0.9885945055258833}-{'f1_val': 0.9844741926825348, 'auprc': 0.9804209563524433, 'loss_val': 0.10405106398242218, 'psi': 0.9828528981504983}
[S9] START round=42 head_norm_before_train=1.664098 cos_to_last_merge=0.9994 (last merge round=38)
[S9] round=42 local utility u=0.002176 metrics={'f1_val': 0.9956098104564366, 'auprc': 0.9991086702780959, 'loss_val': 0.033431798121246685, 'psi': 0.9970093543851003}-{'f1_val': 0.99644216417821, 'auprc': 0.995694753415274, 'loss_val': 0.03253598987617383, 'psi': 0.9961431998730356}
[S10] START round=42 head_norm_before_train=1.809422 cos_to_last_merge=0.9656 (last merge round=20)
[S10] round=42 local utility u=0.000845 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9958968936084595, 'loss_val': 0.02933425322158137, 'psi': 0.9954714608550086}-{'f1_val': 0.9951878390193748, 'auprc': 0.9956765172590879, 'loss_val': 0.03036334704484398, 'psi': 0.9953833103152601}
[S11] START round=42 head_norm_before_train=1.902352 cos_to_last_merge=0.9999 (last merge round=40)
[S11] round=42 local utility u=0.002368 metrics={'f1_val': 0.9962850284706224, 'auprc': 0.9935920678896779, 'loss_val': 0.03760741905627468, 'psi': 0.9952078442382446}-{'f1_val': 0.9962850284706224, 'auprc': 0.992899033021889, 'loss_val': 0.04026510540979578, 'psi': 0.994930630291129}
[S11] not sending this round → trigger blocked (psi=0.995)
[S13] START round=42 head_norm_before_train=1.597264 cos_to_last_merge=0.9999 (last merge round=40)
[S13] round=42 local utility u=0.000000 metrics={'f1_val': 0.6220280505861514, 'auprc': 0.7778488587450991, 'loss_val': 0.6812599010150955, 'psi': 0.6843563738497305}-{'f1_val': 0.6725796536643422, 'auprc': 0.7537092589560723, 'loss_val': 0.6737336338205971, 'psi': 0.7050314957810342}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=42 head_norm_before_train=1.804181 cos_to_last_merge=0.9999 (last merge round=40)
[S14] round=42 local utility u=0.000000 metrics={'f1_val': 0.9922208667565442, 'auprc': 0.9994695547286611, 'loss_val': 0.05975843506149301, 'psi': 0.9951203419453909}-{'f1_val': 0.9974336367705932, 'auprc': 0.9995324042298722, 'loss_val': 0.04454135774365748, 'psi': 0.9982731437543048}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=42 metric=0.9922 head_norm=1.818245
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.158432e-02
[S14] stored merged vector for next round verification (round=42)
[S14] DEBUG after merge:  round=42 metric=0.9935 head_norm=1.812793 delta_norm=0.061584
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S15] START round=42 head_norm_before_train=1.767603 cos_to_last_merge=0.9716 (last merge round=19)
[S15] round=42 local utility u=0.000000 metrics={'f1_val': 0.7023554817145753, 'auprc': 0.8357527879085966, 'loss_val': 0.568330981438841, 'psi': 0.7557144041921838}-{'f1_val': 0.9937094069128902, 'auprc': 0.9919754407014898, 'loss_val': 0.04304747261877068, 'psi': 0.9930158204283301}
[S16] START round=42 head_norm_before_train=1.768382 cos_to_last_merge=1.0000 (last merge round=41)
[S16] round=42 local utility u=0.000000 metrics={'f1_val': 0.8373976823704499, 'auprc': 0.9742034753190364, 'loss_val': 0.8663210397882987, 'psi': 0.8921199995498845}-{'f1_val': 0.992139017697923, 'auprc': 0.9954843123403441, 'loss_val': 0.05415812491992029, 'psi': 0.9934771355548915}
[S17] START round=42 head_norm_before_train=1.723927 cos_to_last_merge=0.9988 (last merge round=38)
[S17] round=42 local utility u=0.000000 metrics={'f1_val': 0.6094956151249089, 'auprc': 0.8660711356383386, 'loss_val': 0.9695018406157413, 'psi': 0.7121258233302807}-{'f1_val': 0.6962825195429524, 'auprc': 0.9304169333327272, 'loss_val': 0.6500888948559622, 'psi': 0.7899362850588623}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:37117
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:37113
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:37111
[S10] not sending this round → trigger blocked (psi=0.995)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1803) from S8
[S17] cosine check vs S8: cos=0.9843
[S13] RECEIVED delta(kind=head bytes=1802) from S9
[S13] cosine check vs S9: cos=0.9913
[S10] RECEIVED delta(kind=head bytes=1801) from S7
[S10] cosine check vs S7: cos=-0.0039
[S10] DROPPED delta from S7 (cos=-0.0039 < 0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=42 metric=0.9925 head_norm=1.775339
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.023279e-01
[S8] stored merged vector for next round verification (round=42)
[S8] DEBUG after merge:  round=42 metric=0.9925 head_norm=1.769922 delta_norm=0.102328
[S8] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=42 metric=0.9956 head_norm=1.677052
[S9] _apply_head_vector_avg (torch): Δ‖w‖=8.743034e-02
[S9] stored merged vector for next round verification (round=42)
[S9] DEBUG after merge:  round=42 metric=0.9956 head_norm=1.681682 delta_norm=0.087430
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=43 head_norm_before_train=2.018182 (no previous merge yet)
[S2] round=43 local utility u=0.024564 metrics={'f1_val': 0.7148866992417889, 'auprc': 0.8509135628890809, 'loss_val': 0.6736098129620756, 'psi': 0.7692974447007057}-{'f1_val': 0.7151465608660945, 'auprc': 0.828069276073399, 'loss_val': 0.6557636064286435, 'psi': 0.7603156469490163}
[S2] not sending this round → trigger blocked (psi=0.769)
[S3] START round=43 head_norm_before_train=2.236779 (no previous merge yet)
[S3] round=43 local utility u=0.000000 metrics={'f1_val': 0.7099984164060335, 'auprc': 0.9598497368623118, 'loss_val': 0.7216373609534316, 'psi': 0.8099389445885448}-{'f1_val': 0.8214445875149263, 'auprc': 0.9760775450508808, 'loss_val': 0.38139780627325104, 'psi': 0.8832977705293081}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=43 head_norm_before_train=1.658698 cos_to_last_merge=0.9105 (last merge round=17)
[S4] ⚠️ Model drifted since last merge! cos=0.910
[S4] round=43 local utility u=0.027620 metrics={'f1_val': 0.9434910975098211, 'auprc': 0.9643584809122836, 'loss_val': 0.2668003100278501, 'psi': 0.951838050870806}-{'f1_val': 0.9368296458485459, 'auprc': 0.9658229694253018, 'loss_val': 0.2864654563933898, 'psi': 0.9484269752792482}
[S4] not sending this round → trigger blocked (psi=0.952)
[S5] START round=43 head_norm_before_train=1.702993 cos_to_last_merge=0.9447 (last merge round=20)
[S5] ⚠️ Model drifted since last merge! cos=0.945
[S5] round=43 local utility u=0.000000 metrics={'f1_val': 0.9974365845193254, 'auprc': 0.999141041322507, 'loss_val': 0.07404521164877616, 'psi': 0.9981183672405981}-{'f1_val': 0.9970695586110643, 'auprc': 0.9981745971135875, 'loss_val': 0.03326903940724765, 'psi': 0.9975115740120736}
[S6] START round=43 head_norm_before_train=1.899593 cos_to_last_merge=0.9829 (last merge round=21)
[S6] round=43 local utility u=0.000000 metrics={'f1_val': 0.7784441108248996, 'auprc': 0.9431487510060886, 'loss_val': 0.5711758927265786, 'psi': 0.8443259668973753}-{'f1_val': 0.8130039012356982, 'auprc': 0.9422671303722002, 'loss_val': 0.544441930771554, 'psi': 0.864709192890299}
[S7] START round=43 head_norm_before_train=1.861942 (no previous merge yet)
[S7] round=43 local utility u=0.000000 metrics={'f1_val': 0.5617926527840409, 'auprc': 0.7924008508230591, 'loss_val': 0.9519590699344966, 'psi': 0.6540359319996482}-{'f1_val': 0.6114418459393017, 'auprc': 0.7970578328683289, 'loss_val': 0.7855077398383978, 'psi': 0.6856882407109126}
[S8] START round=43 head_norm_before_train=1.769922 cos_to_last_merge=1.0000 (last merge round=42)
[S8] round=43 local utility u=0.000000 metrics={'f1_val': 0.9856415503172776, 'auprc': 0.9809543807551941, 'loss_val': 0.10169899784993511, 'psi': 0.9837666824924443}-{'f1_val': 0.9924611780272952, 'auprc': 0.9827944967737655, 'loss_val': 0.058843108376683516, 'psi': 0.9885945055258833}
[S9] START round=43 head_norm_before_train=1.681682 cos_to_last_merge=1.0000 (last merge round=42)
[S9] round=43 local utility u=0.003616 metrics={'f1_val': 0.9966891482978385, 'auprc': 0.9990930690132217, 'loss_val': 0.03262945735190076, 'psi': 0.9976507165839918}-{'f1_val': 0.9956098104564366, 'auprc': 0.9991086702780959, 'loss_val': 0.033431798121246685, 'psi': 0.9970093543851003}
[S10] START round=43 head_norm_before_train=1.821876 cos_to_last_merge=0.9647 (last merge round=20)
[S10] round=43 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.995397865473432, 'loss_val': 0.03003676646559893, 'psi': 0.9952718496009976}-{'f1_val': 0.9951878390193748, 'auprc': 0.9958968936084595, 'loss_val': 0.02933425322158137, 'psi': 0.9954714608550086}
[S11] START round=43 head_norm_before_train=1.918681 cos_to_last_merge=0.9998 (last merge round=40)
[S11] round=43 local utility u=0.001556 metrics={'f1_val': 0.9962850284706224, 'auprc': 0.9938086931479241, 'loss_val': 0.03514459983086837, 'psi': 0.9952944943415432}-{'f1_val': 0.9962850284706224, 'auprc': 0.9935920678896779, 'loss_val': 0.03760741905627468, 'psi': 0.9952078442382446}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=43 head_norm_before_train=1.604771 cos_to_last_merge=0.9998 (last merge round=40)
[S13] round=43 local utility u=0.000000 metrics={'f1_val': 0.5965385410916975, 'auprc': 0.7232338540003452, 'loss_val': 0.8891925848914274, 'psi': 0.6472166662551566}-{'f1_val': 0.6220280505861514, 'auprc': 0.7778488587450991, 'loss_val': 0.6812599010150955, 'psi': 0.6843563738497305}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=43 metric=0.5965 head_norm=1.613120
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.176801e-01
[S13] stored merged vector for next round verification (round=43)
[S13] DEBUG after merge:  round=43 metric=0.5935 head_norm=1.641183 delta_norm=0.117680
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S14] START round=43 head_norm_before_train=1.812793 cos_to_last_merge=1.0000 (last merge round=42)
[S14] round=43 local utility u=0.019936 metrics={'f1_val': 0.9966233754006463, 'auprc': 0.999479590689676, 'loss_val': 0.046331952683486645, 'psi': 0.9977658615162581}-{'f1_val': 0.9922208667565442, 'auprc': 0.9994695547286611, 'loss_val': 0.05975843506149301, 'psi': 0.9951203419453909}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=43 head_norm_before_train=1.775620 cos_to_last_merge=0.9711 (last merge round=19)
[S15] round=43 local utility u=0.175045 metrics={'f1_val': 0.7339455057414348, 'auprc': 0.8732681571352434, 'loss_val': 0.5203265187328405, 'psi': 0.7896745662989583}-{'f1_val': 0.7023554817145753, 'auprc': 0.8357527879085966, 'loss_val': 0.568330981438841, 'psi': 0.7557144041921838}
[S16] START round=43 head_norm_before_train=1.782122 cos_to_last_merge=1.0000 (last merge round=41)
[S16] round=43 local utility u=0.893256 metrics={'f1_val': 0.9901667578619386, 'auprc': 0.9949338192398673, 'loss_val': 0.05861476344870143, 'psi': 0.9920735824131102}-{'f1_val': 0.8373976823704499, 'auprc': 0.9742034753190364, 'loss_val': 0.8663210397882987, 'psi': 0.8921199995498845}
[S17] START round=43 head_norm_before_train=1.741578 cos_to_last_merge=0.9980 (last merge round=38)
[S17] round=43 local utility u=0.127455 metrics={'f1_val': 0.6090442322544436, 'auprc': 0.9089905950799047, 'loss_val': 0.8406420177628517, 'psi': 0.7290227773846281}-{'f1_val': 0.6094956151249089, 'auprc': 0.8660711356383386, 'loss_val': 0.9695018406157413, 'psi': 0.7121258233302807}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=43 metric=0.6090 head_norm=1.756145
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.633433e-01
[S17] stored merged vector for next round verification (round=43)
[S17] DEBUG after merge:  round=43 metric=0.6094 head_norm=1.758196 delta_norm=0.163343
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.998)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:37116
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:37109
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1799) from S16
[S8] cosine check vs S16: cos=0.9972
[S16] RECEIVED delta(kind=head bytes=1797) from S15
[S16] cosine check vs S15: cos=0.9990
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=43 metric=0.9902 head_norm=1.795404
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.023446e-02
[S16] stored merged vector for next round verification (round=43)
[S16] DEBUG after merge:  round=43 metric=0.9906 head_norm=1.790877 delta_norm=0.040234
[S16] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=44 head_norm_before_train=2.026771 (no previous merge yet)
[S2] round=44 local utility u=0.000000 metrics={'f1_val': 0.7150360967477628, 'auprc': 0.8061455558069164, 'loss_val': 0.6536779318533632, 'psi': 0.7514798803714242}-{'f1_val': 0.7148866992417889, 'auprc': 0.8509135628890809, 'loss_val': 0.6736098129620756, 'psi': 0.7692974447007057}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=44 head_norm_before_train=2.245873 (no previous merge yet)
[S3] round=44 local utility u=0.000000 metrics={'f1_val': 0.7037218814426973, 'auprc': 0.9225187579696563, 'loss_val': 0.7680783992618162, 'psi': 0.7912406320534809}-{'f1_val': 0.7099984164060335, 'auprc': 0.9598497368623118, 'loss_val': 0.7216373609534316, 'psi': 0.8099389445885448}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=44 head_norm_before_train=1.664337 cos_to_last_merge=0.9091 (last merge round=17)
[S4] ⚠️ Model drifted since last merge! cos=0.909
[S4] round=44 local utility u=0.022540 metrics={'f1_val': 0.9429819676751419, 'auprc': 0.9822210844500902, 'loss_val': 0.27225416465130026, 'psi': 0.9586776143851212}-{'f1_val': 0.9434910975098211, 'auprc': 0.9643584809122836, 'loss_val': 0.2668003100278501, 'psi': 0.951838050870806}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S4] sending update (kind=head size=1806 to 1 peers)
[S5] START round=44 head_norm_before_train=1.725639 cos_to_last_merge=0.9428 (last merge round=20)
[S5] ⚠️ Model drifted since last merge! cos=0.943
[S5] round=44 local utility u=0.014151 metrics={'f1_val': 0.9974365845193254, 'auprc': 0.9969915669885949, 'loss_val': 0.03929470632249511, 'psi': 0.9972585775070333}-{'f1_val': 0.9974365845193254, 'auprc': 0.999141041322507, 'loss_val': 0.07404521164877616, 'psi': 0.9981183672405981}
[S6] START round=44 head_norm_before_train=1.906218 cos_to_last_merge=0.9821 (last merge round=21)
[S6] round=44 local utility u=0.473909 metrics={'f1_val': 0.889042239515559, 'auprc': 0.9581627041283284, 'loss_val': 0.3319892781098238, 'psi': 0.9166904253606667}-{'f1_val': 0.7784441108248996, 'auprc': 0.9431487510060886, 'loss_val': 0.5711758927265786, 'psi': 0.8443259668973753}
[S7] START round=44 head_norm_before_train=1.868088 (no previous merge yet)
[S7] round=44 local utility u=0.016009 metrics={'f1_val': 0.5621559559918254, 'auprc': 0.7856876039935138, 'loss_val': 0.9019804224784922, 'psi': 0.6515686151925009}-{'f1_val': 0.5617926527840409, 'auprc': 0.7924008508230591, 'loss_val': 0.9519590699344966, 'psi': 0.6540359319996482}
[S8] START round=44 head_norm_before_train=1.782557 cos_to_last_merge=0.9999 (last merge round=42)
[S8] round=44 local utility u=0.057946 metrics={'f1_val': 0.9910860494090681, 'auprc': 0.9957117017633171, 'loss_val': 0.06274633704476544, 'psi': 0.9929363103507677}-{'f1_val': 0.9856415503172776, 'auprc': 0.9809543807551941, 'loss_val': 0.10169899784993511, 'psi': 0.9837666824924443}
[S9] START round=44 head_norm_before_train=1.695406 cos_to_last_merge=1.0000 (last merge round=42)
[S9] round=44 local utility u=0.000000 metrics={'f1_val': 0.9888602739236441, 'auprc': 0.9986866296281715, 'loss_val': 0.0568008943334893, 'psi': 0.9927908162054551}-{'f1_val': 0.9966891482978385, 'auprc': 0.9990930690132217, 'loss_val': 0.03262945735190076, 'psi': 0.9976507165839918}
[S10] START round=44 head_norm_before_train=1.831014 cos_to_last_merge=0.9638 (last merge round=20)
[S10] round=44 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9952974669606949, 'loss_val': 0.029787042294984533, 'psi': 0.9952316901959029}-{'f1_val': 0.9951878390193748, 'auprc': 0.995397865473432, 'loss_val': 0.03003676646559893, 'psi': 0.9952718496009976}
[S11] START round=44 head_norm_before_train=1.935400 cos_to_last_merge=0.9995 (last merge round=40)
[S11] round=44 local utility u=0.000000 metrics={'f1_val': 0.9485457911793833, 'auprc': 0.9933740966713468, 'loss_val': 0.24761677300738952, 'psi': 0.9664771133761687}-{'f1_val': 0.9962850284706224, 'auprc': 0.9938086931479241, 'loss_val': 0.03514459983086837, 'psi': 0.9952944943415432}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=44 head_norm_before_train=1.641183 cos_to_last_merge=1.0000 (last merge round=43)
[S13] round=44 local utility u=0.370145 metrics={'f1_val': 0.6692712081918651, 'auprc': 0.7162951545774665, 'loss_val': 0.5644818927170221, 'psi': 0.6880807867461056}-{'f1_val': 0.5965385410916975, 'auprc': 0.7232338540003452, 'loss_val': 0.8891925848914274, 'psi': 0.6472166662551566}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=44 head_norm_before_train=1.827796 cos_to_last_merge=1.0000 (last merge round=42)
[S14] round=44 local utility u=0.000000 metrics={'f1_val': 0.9963600128417739, 'auprc': 0.9995021805043494, 'loss_val': 0.046234595216501966, 'psi': 0.997616879906804}-{'f1_val': 0.9966233754006463, 'auprc': 0.999479590689676, 'loss_val': 0.046331952683486645, 'psi': 0.9977658615162581}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=44 head_norm_before_train=1.787245 cos_to_last_merge=0.9702 (last merge round=19)
[S15] round=44 local utility u=0.000000 metrics={'f1_val': 0.7011578199677704, 'auprc': 0.8307913321556638, 'loss_val': 0.6065122104492712, 'psi': 0.7530112248429277}-{'f1_val': 0.7339455057414348, 'auprc': 0.8732681571352434, 'loss_val': 0.5203265187328405, 'psi': 0.7896745662989583}
[S16] START round=44 head_norm_before_train=1.790877 cos_to_last_merge=1.0000 (last merge round=43)
[S16] round=44 local utility u=0.000000 metrics={'f1_val': 0.9904362031872476, 'auprc': 0.9914271026785195, 'loss_val': 0.05691120617032426, 'psi': 0.9908325629837563}-{'f1_val': 0.9901667578619386, 'auprc': 0.9949338192398673, 'loss_val': 0.05861476344870143, 'psi': 0.9920735824131102}
[S17] START round=44 head_norm_before_train=1.758196 cos_to_last_merge=1.0000 (last merge round=43)
[S17] round=44 local utility u=0.000000 metrics={'f1_val': 0.5999765850145149, 'auprc': 0.8587919831590738, 'loss_val': 0.9027046658215025, 'psi': 0.7035027442723385}-{'f1_val': 0.6090442322544436, 'auprc': 0.9089905950799047, 'loss_val': 0.8406420177628517, 'psi': 0.7290227773846281}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S5] → sending delta(kind=head bytes=1806) to S9@127.0.0.1:37110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:37117
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:37112
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:37111
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1806 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1798) from S6
[S11] cosine check vs S6: cos=0.9972
[S10] RECEIVED delta(kind=head bytes=1802) from S7
[S10] cosine check vs S7: cos=-0.0048
[S10] DROPPED delta from S7 (cos=-0.0048 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1806) from S5
[S9] cosine check vs S5: cos=0.9969
[S17] RECEIVED delta(kind=head bytes=1799) from S8
[S17] cosine check vs S8: cos=0.9913
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=44 metric=0.9911 head_norm=1.793382
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.379285e-02
[S8] stored merged vector for next round verification (round=44)
[S8] DEBUG after merge:  round=44 metric=0.9911 head_norm=1.792875 delta_norm=0.073793
[S8] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=45 head_norm_before_train=2.033353 (no previous merge yet)
[S2] round=45 local utility u=0.000000 metrics={'f1_val': 0.6990854842987962, 'auprc': 0.7731843940363172, 'loss_val': 0.6492612656934134, 'psi': 0.7287250481938046}-{'f1_val': 0.7150360967477628, 'auprc': 0.8061455558069164, 'loss_val': 0.6536779318533632, 'psi': 0.7514798803714242}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=45 head_norm_before_train=2.255708 (no previous merge yet)
[S3] round=45 local utility u=0.284819 metrics={'f1_val': 0.7487078174122125, 'auprc': 0.9762522984590548, 'loss_val': 0.6295557001477131, 'psi': 0.8397256098309495}-{'f1_val': 0.7037218814426973, 'auprc': 0.9225187579696563, 'loss_val': 0.7680783992618162, 'psi': 0.7912406320534809}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=45 head_norm_before_train=1.670033 cos_to_last_merge=0.9079 (last merge round=17)
[S4] ⚠️ Model drifted since last merge! cos=0.908
[S4] round=45 local utility u=0.000000 metrics={'f1_val': 0.9438157348173113, 'auprc': 0.9779587476460115, 'loss_val': 0.2747923511329835, 'psi': 0.9574729399487915}-{'f1_val': 0.9429819676751419, 'auprc': 0.9822210844500902, 'loss_val': 0.27225416465130026, 'psi': 0.9586776143851212}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=45 head_norm_before_train=1.751635 cos_to_last_merge=0.9408 (last merge round=20)
[S5] ⚠️ Model drifted since last merge! cos=0.941
[S5] round=45 local utility u=0.000030 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9936791256402095, 'loss_val': 0.024890679275429692, 'psi': 0.9954928313431584}-{'f1_val': 0.9974365845193254, 'auprc': 0.9969915669885949, 'loss_val': 0.03929470632249511, 'psi': 0.9972585775070333}
[S6] START round=45 head_norm_before_train=1.912043 cos_to_last_merge=0.9807 (last merge round=21)
[S6] round=45 local utility u=0.000000 metrics={'f1_val': 0.6178889229724787, 'auprc': 0.7987664131872989, 'loss_val': 0.8180776943894859, 'psi': 0.6902399190584068}-{'f1_val': 0.889042239515559, 'auprc': 0.9581627041283284, 'loss_val': 0.3319892781098238, 'psi': 0.9166904253606667}
[S7] START round=45 head_norm_before_train=1.872293 (no previous merge yet)
[S7] round=45 local utility u=0.462160 metrics={'f1_val': 0.6326691942969864, 'auprc': 0.8043084978788296, 'loss_val': 0.4566016205147111, 'psi': 0.7013249157297237}-{'f1_val': 0.5621559559918254, 'auprc': 0.7856876039935138, 'loss_val': 0.9019804224784922, 'psi': 0.6515686151925009}
[S8] START round=45 head_norm_before_train=1.792875 cos_to_last_merge=1.0000 (last merge round=44)
[S8] round=45 local utility u=0.005735 metrics={'f1_val': 0.9933016371923923, 'auprc': 0.994828844659952, 'loss_val': 0.061920539014627414, 'psi': 0.9939125201794162}-{'f1_val': 0.9910860494090681, 'auprc': 0.9957117017633171, 'loss_val': 0.06274633704476544, 'psi': 0.9929363103507677}
[S9] START round=45 head_norm_before_train=1.706842 cos_to_last_merge=0.9998 (last merge round=42)
[S9] round=45 local utility u=0.029756 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9938001297373839, 'loss_val': 0.029622991792047346, 'psi': 0.9955355466538108}-{'f1_val': 0.9888602739236441, 'auprc': 0.9986866296281715, 'loss_val': 0.0568008943334893, 'psi': 0.9927908162054551}
[S10] START round=45 head_norm_before_train=1.839060 cos_to_last_merge=0.9628 (last merge round=20)
[S10] round=45 local utility u=0.002163 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9962409882673315, 'loss_val': 0.028291334587094766, 'psi': 0.9956090987185575}-{'f1_val': 0.9951878390193748, 'auprc': 0.9952974669606949, 'loss_val': 0.029787042294984533, 'psi': 0.9952316901959029}
[S11] START round=45 head_norm_before_train=1.948525 cos_to_last_merge=0.9992 (last merge round=40)
[S11] round=45 local utility u=0.249458 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9931815323145463, 'loss_val': 0.03470229741469579, 'psi': 0.9950580636960398}-{'f1_val': 0.9485457911793833, 'auprc': 0.9933740966713468, 'loss_val': 0.24761677300738952, 'psi': 0.9664771133761687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=45 metric=0.9963 head_norm=1.959500
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.176991e-02
[S11] stored merged vector for next round verification (round=45)
[S11] DEBUG after merge:  round=45 metric=0.9963 head_norm=1.934189 delta_norm=0.081770
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S13] START round=45 head_norm_before_train=1.651771 cos_to_last_merge=0.9999 (last merge round=43)
[S13] round=45 local utility u=0.000000 metrics={'f1_val': 0.6370906022575769, 'auprc': 0.6773015416117126, 'loss_val': 0.7159139671351052, 'psi': 0.6531749779992312}-{'f1_val': 0.6692712081918651, 'auprc': 0.7162951545774665, 'loss_val': 0.5644818927170221, 'psi': 0.6880807867461056}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=45 head_norm_before_train=1.842680 cos_to_last_merge=0.9998 (last merge round=42)
[S14] round=45 local utility u=0.000000 metrics={'f1_val': 0.9374422048088731, 'auprc': 0.9996803260772209, 'loss_val': 0.08394037639496939, 'psi': 0.9623374533162121}-{'f1_val': 0.9963600128417739, 'auprc': 0.9995021805043494, 'loss_val': 0.046234595216501966, 'psi': 0.997616879906804}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=45 head_norm_before_train=1.799535 cos_to_last_merge=0.9692 (last merge round=19)
[S15] round=45 local utility u=1.000000 metrics={'f1_val': 0.9871819350536057, 'auprc': 0.9971669790955677, 'loss_val': 0.05813025735923197, 'psi': 0.9911759526703906}-{'f1_val': 0.7011578199677704, 'auprc': 0.8307913321556638, 'loss_val': 0.6065122104492712, 'psi': 0.7530112248429277}
[S16] START round=45 head_norm_before_train=1.805409 cos_to_last_merge=1.0000 (last merge round=43)
[S16] round=45 local utility u=0.000000 metrics={'f1_val': 0.9879476192111851, 'auprc': 0.9937040685602844, 'loss_val': 0.075128752162017, 'psi': 0.9902501989508248}-{'f1_val': 0.9904362031872476, 'auprc': 0.9914271026785195, 'loss_val': 0.05691120617032426, 'psi': 0.9908325629837563}
[S17] START round=45 head_norm_before_train=1.769673 cos_to_last_merge=1.0000 (last merge round=43)
[S17] round=45 local utility u=0.417323 metrics={'f1_val': 0.6695143386404694, 'auprc': 0.9028954953299816, 'loss_val': 0.6175957091199861, 'psi': 0.7628668013162743}-{'f1_val': 0.5999765850145149, 'auprc': 0.8587919831590738, 'loss_val': 0.9027046658215025, 'psi': 0.7035027442723385}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=45 metric=0.6695 head_norm=1.781004
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.228285e-01
[S17] stored merged vector for next round verification (round=45)
[S17] DEBUG after merge:  round=45 metric=0.6785 head_norm=1.782978 delta_norm=0.122829
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] not sending this round → trigger blocked (psi=0.994)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.701)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:37116
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:37113
[S5] not sending this round → trigger blocked (psi=0.995)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:37114
[S9] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S5] ⇄ pheromone p=0.015 → S9@127.0.0.1:37110
[S16] ⇄ pheromone p=0.133 → S8@127.0.0.1:37109
[S10] sending update (kind=head size=1799 to 1 peers)
[S7] ⇄ pheromone p=0.186 → S10@127.0.0.1:37111
[S6] ⇄ pheromone p=0.159 → S11@127.0.0.1:37112
[S8] ⇄ pheromone p=0.018 → S17@127.0.0.1:37117
[S13] RECEIVED delta(kind=head bytes=1800) from S9
[S13] cosine check vs S9: cos=0.9946
[S16] RECEIVED delta(kind=head bytes=1802) from S15
[S16] cosine check vs S15: cos=0.9992
[S14] RECEIVED delta(kind=head bytes=1799) from S10
[S14] cosine check vs S10: cos=0.9978
[S10] ⇄ pheromone p=0.002 → S14@127.0.0.1:37114
[S15] ⇄ pheromone p=0.387 → S16@127.0.0.1:37116
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=45 metric=0.9967 head_norm=1.719133
[S9] _apply_head_vector_avg (torch): Δ‖w‖=7.779430e-02
[S9] stored merged vector for next round verification (round=45)
[S9] DEBUG after merge:  round=45 metric=0.9967 head_norm=1.733715 delta_norm=0.077794
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.009 → S13@127.0.0.1:37113
[S2] START round=46 head_norm_before_train=2.041111 (no previous merge yet)
[S2] round=46 local utility u=0.152096 metrics={'f1_val': 0.714975029883709, 'auprc': 0.8603792305515334, 'loss_val': 0.7019913722366193, 'psi': 0.7731367101508387}-{'f1_val': 0.6990854842987962, 'auprc': 0.7731843940363172, 'loss_val': 0.6492612656934134, 'psi': 0.7287250481938046}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=46 head_norm_before_train=2.265322 (no previous merge yet)
[S3] round=46 local utility u=0.012187 metrics={'f1_val': 0.7433561911947686, 'auprc': 0.9876403913502961, 'loss_val': 0.6072357437971405, 'psi': 0.8410698712569796}-{'f1_val': 0.7487078174122125, 'auprc': 0.9762522984590548, 'loss_val': 0.6295557001477131, 'psi': 0.8397256098309495}
[S3] not sending this round → trigger blocked (psi=0.841)
[S4] START round=46 head_norm_before_train=1.676412 cos_to_last_merge=0.9069 (last merge round=17)
[S4] ⚠️ Model drifted since last merge! cos=0.907
[S4] round=46 local utility u=0.000000 metrics={'f1_val': 0.9463458244867716, 'auprc': 0.9660332765238867, 'loss_val': 0.2684605056440537, 'psi': 0.9542208053016177}-{'f1_val': 0.9438157348173113, 'auprc': 0.9779587476460115, 'loss_val': 0.2747923511329835, 'psi': 0.9574729399487915}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=46 head_norm_before_train=1.770731 cos_to_last_merge=0.9389 (last merge round=20)
[S5] ⚠️ Model drifted since last merge! cos=0.939
[S5] round=46 local utility u=0.006399 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9969806113415344, 'loss_val': 0.021997864978592546, 'psi': 0.9968134256236884}-{'f1_val': 0.9967019684784577, 'auprc': 0.9936791256402095, 'loss_val': 0.024890679275429692, 'psi': 0.9954928313431584}
[S6] START round=46 head_norm_before_train=1.918441 cos_to_last_merge=0.9795 (last merge round=21)
[S6] round=46 local utility u=1.000000 metrics={'f1_val': 0.8441213092667967, 'auprc': 0.9462183215165221, 'loss_val': 0.4516668673252059, 'psi': 0.8849601141666869}-{'f1_val': 0.6178889229724787, 'auprc': 0.7987664131872989, 'loss_val': 0.8180776943894859, 'psi': 0.6902399190584068}
[S7] START round=46 head_norm_before_train=1.875897 (no previous merge yet)
[S7] round=46 local utility u=0.000000 metrics={'f1_val': 0.6113298059221504, 'auprc': 0.7922949003984413, 'loss_val': 0.7961003234025205, 'psi': 0.6837158437126667}-{'f1_val': 0.6326691942969864, 'auprc': 0.8043084978788296, 'loss_val': 0.4566016205147111, 'psi': 0.7013249157297237}
[S8] START round=46 head_norm_before_train=1.802832 cos_to_last_merge=1.0000 (last merge round=44)
[S8] round=46 local utility u=0.000000 metrics={'f1_val': 0.9913077019421868, 'auprc': 0.996103179648833, 'loss_val': 0.06172544635678273, 'psi': 0.9932258930248452}-{'f1_val': 0.9933016371923923, 'auprc': 0.994828844659952, 'loss_val': 0.061920539014627414, 'psi': 0.9939125201794162}
[S9] START round=46 head_norm_before_train=1.733715 cos_to_last_merge=1.0000 (last merge round=45)
[S9] round=46 local utility u=0.000000 metrics={'f1_val': 0.9863222816204869, 'auprc': 0.9980045231385865, 'loss_val': 0.06868474067811942, 'psi': 0.9909951782277266}-{'f1_val': 0.9966924912647621, 'auprc': 0.9938001297373839, 'loss_val': 0.029622991792047346, 'psi': 0.9955355466538108}
[S10] START round=46 head_norm_before_train=1.848513 cos_to_last_merge=0.9620 (last merge round=20)
[S10] round=46 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9959688044480361, 'loss_val': 0.028333025919041632, 'psi': 0.9955002251908394}-{'f1_val': 0.9951878390193748, 'auprc': 0.9962409882673315, 'loss_val': 0.028291334587094766, 'psi': 0.9956090987185575}
[S11] START round=46 head_norm_before_train=1.934189 cos_to_last_merge=1.0000 (last merge round=45)
[S11] round=46 local utility u=0.000492 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9930348742492083, 'loss_val': 0.0357591858139313, 'psi': 0.9952474014485926}-{'f1_val': 0.9963090846170353, 'auprc': 0.9931815323145463, 'loss_val': 0.03470229741469579, 'psi': 0.9950580636960398}
[S11] not sending this round → trigger blocked (psi=0.995)
[S13] START round=46 head_norm_before_train=1.662323 cos_to_last_merge=0.9997 (last merge round=43)
[S13] round=46 local utility u=0.168784 metrics={'f1_val': 0.6424727405450374, 'auprc': 0.7755333708983811, 'loss_val': 0.7053347710646567, 'psi': 0.695696992686375}-{'f1_val': 0.6370906022575769, 'auprc': 0.6773015416117126, 'loss_val': 0.7159139671351052, 'psi': 0.6531749779992312}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=46 metric=0.6425 head_norm=1.669443
[S13] _apply_head_vector_avg (torch): Δ‖w‖=9.633491e-02
[S13] stored merged vector for next round verification (round=46)
[S13] DEBUG after merge:  round=46 metric=0.6365 head_norm=1.691729 delta_norm=0.096335
[S13] aggregate: ROLLBACK (f1_val pre=0.642 post=0.637 tol_abs=0.005 tol_rel=0.0)
[S14] START round=46 head_norm_before_train=1.855519 cos_to_last_merge=0.9996 (last merge round=42)
[S14] round=46 local utility u=0.199730 metrics={'f1_val': 0.996673987435767, 'auprc': 0.9984899173016396, 'loss_val': 0.03629995836974635, 'psi': 0.9974003593821161}-{'f1_val': 0.9374422048088731, 'auprc': 0.9996803260772209, 'loss_val': 0.08394037639496939, 'psi': 0.9623374533162121}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=46 metric=0.9967 head_norm=1.866289
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.706785e-02
[S14] stored merged vector for next round verification (round=46)
[S14] DEBUG after merge:  round=46 metric=0.9967 head_norm=1.856211 delta_norm=0.067068
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S15] START round=46 head_norm_before_train=1.811690 cos_to_last_merge=0.9682 (last merge round=19)
[S15] round=46 local utility u=0.000000 metrics={'f1_val': 0.7010067642315115, 'auprc': 0.8334370023496314, 'loss_val': 0.6156386525900008, 'psi': 0.7539788594787595}-{'f1_val': 0.9871819350536057, 'auprc': 0.9971669790955677, 'loss_val': 0.05813025735923197, 'psi': 0.9911759526703906}
[S16] START round=46 head_norm_before_train=1.817186 cos_to_last_merge=0.9999 (last merge round=43)
[S16] round=46 local utility u=0.000000 metrics={'f1_val': 0.9456216650230752, 'auprc': 0.9878041925866379, 'loss_val': 0.15117548450837484, 'psi': 0.9624946760485003}-{'f1_val': 0.9879476192111851, 'auprc': 0.9937040685602844, 'loss_val': 0.075128752162017, 'psi': 0.9902501989508248}
[S17] START round=46 head_norm_before_train=1.782978 cos_to_last_merge=1.0000 (last merge round=45)
[S17] round=46 local utility u=0.000000 metrics={'f1_val': 0.6025558861314675, 'auprc': 0.8511542216524193, 'loss_val': 0.9215860951027263, 'psi': 0.7019952203398482}-{'f1_val': 0.6695143386404694, 'auprc': 0.9028954953299816, 'loss_val': 0.6175957091199861, 'psi': 0.7628668013162743}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:37110
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:37112
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=46 metric=0.9456 head_norm=1.830109
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.363983e-02
[S16] stored merged vector for next round verification (round=46)
[S16] DEBUG after merge:  round=46 metric=0.9439 head_norm=1.820400 delta_norm=0.043640
[S16] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S11] RECEIVED delta(kind=head bytes=1800) from S6
[S11] cosine check vs S6: cos=0.9985
[S9] RECEIVED delta(kind=head bytes=1802) from S5
[S9] cosine check vs S5: cos=0.9980
[S2] START round=47 head_norm_before_train=2.049041 (no previous merge yet)
[S2] round=47 local utility u=0.000000 metrics={'f1_val': 0.5712771871624818, 'auprc': 0.6386862605909953, 'loss_val': 1.5317768412081978, 'psi': 0.5982408165338872}-{'f1_val': 0.714975029883709, 'auprc': 0.8603792305515334, 'loss_val': 0.7019913722366193, 'psi': 0.7731367101508387}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=47 head_norm_before_train=2.275425 (no previous merge yet)
[S3] round=47 local utility u=0.485651 metrics={'f1_val': 0.86785252727877, 'auprc': 0.9685595969364265, 'loss_val': 0.3256687788285793, 'psi': 0.9081353551418325}-{'f1_val': 0.7433561911947686, 'auprc': 0.9876403913502961, 'loss_val': 0.6072357437971405, 'psi': 0.8410698712569796}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=47 head_norm_before_train=1.684138 cos_to_last_merge=0.9059 (last merge round=17)
[S4] ⚠️ Model drifted since last merge! cos=0.906
[S4] round=47 local utility u=0.002175 metrics={'f1_val': 0.9510210112720194, 'auprc': 0.9578563889567845, 'loss_val': 0.2676305502630386, 'psi': 0.9537551623459255}-{'f1_val': 0.9463458244867716, 'auprc': 0.9660332765238867, 'loss_val': 0.2684605056440537, 'psi': 0.9542208053016177}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=47 head_norm_before_train=1.795142 cos_to_last_merge=0.9368 (last merge round=20)
[S5] ⚠️ Model drifted since last merge! cos=0.937
[S5] round=47 local utility u=0.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9958948646846646, 'loss_val': 0.02128481962355489, 'psi': 0.9963791269609404}-{'f1_val': 0.9967019684784577, 'auprc': 0.9969806113415344, 'loss_val': 0.021997864978592546, 'psi': 0.9968134256236884}
[S6] START round=47 head_norm_before_train=1.925126 cos_to_last_merge=0.9785 (last merge round=21)
[S6] round=47 local utility u=0.000000 metrics={'f1_val': 0.7905124697904563, 'auprc': 0.9286151566285885, 'loss_val': 0.5859200822547974, 'psi': 0.8457535445257092}-{'f1_val': 0.8441213092667967, 'auprc': 0.9462183215165221, 'loss_val': 0.4516668673252059, 'psi': 0.8849601141666869}
[S7] START round=47 head_norm_before_train=1.887090 (no previous merge yet)
[S7] round=47 local utility u=0.202457 metrics={'f1_val': 0.6273237892335942, 'auprc': 0.8023225180708197, 'loss_val': 0.5172331487059971, 'psi': 0.6973232807684844}-{'f1_val': 0.6113298059221504, 'auprc': 0.7922949003984413, 'loss_val': 0.7961003234025205, 'psi': 0.6837158437126667}
[S8] START round=47 head_norm_before_train=1.815789 cos_to_last_merge=0.9998 (last merge round=44)
[S8] round=47 local utility u=0.000000 metrics={'f1_val': 0.9934888194563342, 'auprc': 0.9822675802144113, 'loss_val': 0.05572120000585882, 'psi': 0.989000323759565}-{'f1_val': 0.9913077019421868, 'auprc': 0.996103179648833, 'loss_val': 0.06172544635678273, 'psi': 0.9932258930248452}
[S9] START round=47 head_norm_before_train=1.743173 cos_to_last_merge=0.9999 (last merge round=45)
[S9] round=47 local utility u=0.051599 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9987299049574233, 'loss_val': 0.029883462994943478, 'psi': 0.9975074567418266}-{'f1_val': 0.9863222816204869, 'auprc': 0.9980045231385865, 'loss_val': 0.06868474067811942, 'psi': 0.9909951782277266}
[S10] START round=47 head_norm_before_train=1.858507 cos_to_last_merge=0.9612 (last merge round=20)
[S10] round=47 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9935409650149818, 'loss_val': 0.030892090273073363, 'psi': 0.9945290894176175}-{'f1_val': 0.9951878390193748, 'auprc': 0.9959688044480361, 'loss_val': 0.028333025919041632, 'psi': 0.9955002251908394}
[S11] START round=47 head_norm_before_train=1.946574 cos_to_last_merge=1.0000 (last merge round=45)
[S11] round=47 local utility u=0.000000 metrics={'f1_val': 0.982480735024454, 'auprc': 0.9962287098934122, 'loss_val': 0.06715640743275289, 'psi': 0.9879799249720372}-{'f1_val': 0.9967224195815153, 'auprc': 0.9930348742492083, 'loss_val': 0.0357591858139313, 'psi': 0.9952474014485926}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=47 metric=0.9825 head_norm=1.958593
[S11] _apply_head_vector_avg (torch): Δ‖w‖=6.220911e-02
[S11] stored merged vector for next round verification (round=47)
[S11] DEBUG after merge:  round=47 metric=0.9813 head_norm=1.940935 delta_norm=0.062209
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S13] START round=47 head_norm_before_train=1.691729 cos_to_last_merge=1.0000 (last merge round=46)
[S13] round=47 local utility u=0.000000 metrics={'f1_val': 0.6394586332741878, 'auprc': 0.7607108941349242, 'loss_val': 0.6796552082002418, 'psi': 0.6879595376184824}-{'f1_val': 0.6424727405450374, 'auprc': 0.7755333708983811, 'loss_val': 0.7053347710646567, 'psi': 0.695696992686375}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=47 head_norm_before_train=1.856211 cos_to_last_merge=1.0000 (last merge round=46)
[S14] round=47 local utility u=0.000111 metrics={'f1_val': 0.996625866862095, 'auprc': 0.9995000608520648, 'loss_val': 0.03881893977334225, 'psi': 0.9977755444580829}-{'f1_val': 0.996673987435767, 'auprc': 0.9984899173016396, 'loss_val': 0.03629995836974635, 'psi': 0.9974003593821161}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=47 head_norm_before_train=1.821058 cos_to_last_merge=0.9678 (last merge round=19)
[S15] round=47 local utility u=0.000000 metrics={'f1_val': 0.7010713433702593, 'auprc': 0.8226486204903133, 'loss_val': 0.6512418578574382, 'psi': 0.749702254218281}-{'f1_val': 0.7010067642315115, 'auprc': 0.8334370023496314, 'loss_val': 0.6156386525900008, 'psi': 0.7539788594787595}
[S16] START round=47 head_norm_before_train=1.820400 cos_to_last_merge=1.0000 (last merge round=46)
[S16] round=47 local utility u=0.175077 metrics={'f1_val': 0.9893009802119113, 'auprc': 0.9888932596856239, 'loss_val': 0.06636477118076499, 'psi': 0.9891378920013963}-{'f1_val': 0.9456216650230752, 'auprc': 0.9878041925866379, 'loss_val': 0.15117548450837484, 'psi': 0.9624946760485003}
[S17] START round=47 head_norm_before_train=1.793185 cos_to_last_merge=1.0000 (last merge round=45)
[S17] round=47 local utility u=0.911092 metrics={'f1_val': 0.7999907337517917, 'auprc': 0.9143244936158977, 'loss_val': 0.47352208002453977, 'psi': 0.8457242376974341}-{'f1_val': 0.6025558861314675, 'auprc': 0.8511542216524193, 'loss_val': 0.9215860951027263, 'psi': 0.7019952203398482}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:37113
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:37111
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S16] → sending delta(kind=head bytes=1789) to S8@127.0.0.1:37109
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1789 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1800) from S7
[S10] cosine check vs S7: cos=-0.0051
[S10] DROPPED delta from S7 (cos=-0.0051 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1803) from S9
[S13] cosine check vs S9: cos=0.9965
[S8] RECEIVED delta(kind=head bytes=1789) from S16
[S8] cosine check vs S16: cos=0.9971
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=47 metric=0.9967 head_norm=1.752116
[S9] _apply_head_vector_avg (torch): Δ‖w‖=6.590603e-02
[S9] stored merged vector for next round verification (round=47)
[S9] DEBUG after merge:  round=47 metric=0.9967 head_norm=1.772535 delta_norm=0.065906
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=48 head_norm_before_train=2.056242 (no previous merge yet)
[S2] round=48 local utility u=1.000000 metrics={'f1_val': 0.7157727802377625, 'auprc': 0.8776624191510651, 'loss_val': 0.6797343919784977, 'psi': 0.7805286358030835}-{'f1_val': 0.5712771871624818, 'auprc': 0.6386862605909953, 'loss_val': 1.5317768412081978, 'psi': 0.5982408165338872}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] sending update (kind=head size=1793 to 1 peers)
[S3] START round=48 head_norm_before_train=2.284830 (no previous merge yet)
[S3] round=48 local utility u=0.441880 metrics={'f1_val': 0.9605438728991138, 'auprc': 0.9993374075874248, 'loss_val': 0.09039103198353882, 'psi': 0.9760612867744383}-{'f1_val': 0.86785252727877, 'auprc': 0.9685595969364265, 'loss_val': 0.3256687788285793, 'psi': 0.9081353551418325}
[S3] not sending this round → trigger blocked (psi=0.976)
[S4] START round=48 head_norm_before_train=1.691087 cos_to_last_merge=0.9050 (last merge round=17)
[S4] ⚠️ Model drifted since last merge! cos=0.905
[S4] round=48 local utility u=0.033083 metrics={'f1_val': 0.9524148976789399, 'auprc': 0.9762578755979415, 'loss_val': 0.2650321423843463, 'psi': 0.9619520888465405}-{'f1_val': 0.9510210112720194, 'auprc': 0.9578563889567845, 'loss_val': 0.2676305502630386, 'psi': 0.9537551623459255}
[S4] not sending this round → trigger blocked (psi=0.962)
[S5] START round=48 head_norm_before_train=1.820059 cos_to_last_merge=0.9348 (last merge round=20)
[S5] ⚠️ Model drifted since last merge! cos=0.935
[S5] round=48 local utility u=0.002400 metrics={'f1_val': 0.9966309045197074, 'auprc': 0.9978973836056653, 'loss_val': 0.02206617965784354, 'psi': 0.9971374961540905}-{'f1_val': 0.9967019684784577, 'auprc': 0.9958948646846646, 'loss_val': 0.02128481962355489, 'psi': 0.9963791269609404}
[S6] START round=48 head_norm_before_train=1.933587 cos_to_last_merge=0.9774 (last merge round=21)
[S6] round=48 local utility u=0.281685 metrics={'f1_val': 0.8408099152673197, 'auprc': 0.9576920870335426, 'loss_val': 0.41156631822016904, 'psi': 0.8875627839738088}-{'f1_val': 0.7905124697904563, 'auprc': 0.9286151566285885, 'loss_val': 0.5859200822547974, 'psi': 0.8457535445257092}
[S7] START round=48 head_norm_before_train=1.896620 (no previous merge yet)
[S7] round=48 local utility u=0.000000 metrics={'f1_val': 0.561442687657018, 'auprc': 0.7878044788963898, 'loss_val': 0.9332418912182396, 'psi': 0.6519874041527667}-{'f1_val': 0.6273237892335942, 'auprc': 0.8023225180708197, 'loss_val': 0.5172331487059971, 'psi': 0.6973232807684844}
[S8] START round=48 head_norm_before_train=1.828335 cos_to_last_merge=0.9996 (last merge round=44)
[S8] round=48 local utility u=0.003516 metrics={'f1_val': 0.9933016371923923, 'auprc': 0.983637660096259, 'loss_val': 0.051675996779411724, 'psi': 0.989436046353939}-{'f1_val': 0.9934888194563342, 'auprc': 0.9822675802144113, 'loss_val': 0.05572120000585882, 'psi': 0.989000323759565}
[S9] START round=48 head_norm_before_train=1.772535 cos_to_last_merge=1.0000 (last merge round=47)
[S9] round=48 local utility u=0.001274 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9987405753515991, 'loss_val': 0.02982954572694207, 'psi': 0.9977579776479253}-{'f1_val': 0.9966924912647621, 'auprc': 0.9987299049574233, 'loss_val': 0.029883462994943478, 'psi': 0.9975074567418266}
[S10] START round=48 head_norm_before_train=1.866656 cos_to_last_merge=0.9603 (last merge round=20)
[S10] round=48 local utility u=0.005945 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.996388091014143, 'loss_val': 0.027543612153874165, 'psi': 0.9956679398172821}-{'f1_val': 0.9951878390193748, 'auprc': 0.9935409650149818, 'loss_val': 0.030892090273073363, 'psi': 0.9945290894176175}
[S11] START round=48 head_norm_before_train=1.940935 cos_to_last_merge=1.0000 (last merge round=47)
[S11] round=48 local utility u=0.057543 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9956387688406322, 'loss_val': 0.03574999945710388, 'psi': 0.996288959285162}-{'f1_val': 0.982480735024454, 'auprc': 0.9962287098934122, 'loss_val': 0.06715640743275289, 'psi': 0.9879799249720372}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=48 head_norm_before_train=1.701706 cos_to_last_merge=1.0000 (last merge round=46)
[S13] round=48 local utility u=0.163041 metrics={'f1_val': 0.6876133568810806, 'auprc': 0.7764868113046655, 'loss_val': 0.6898300008678278, 'psi': 0.7231627386505146}-{'f1_val': 0.6394586332741878, 'auprc': 0.7607108941349242, 'loss_val': 0.6796552082002418, 'psi': 0.6879595376184824}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=48 metric=0.6876 head_norm=1.713900
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.202207e-02
[S13] stored merged vector for next round verification (round=48)
[S13] DEBUG after merge:  round=48 metric=0.7298 head_norm=1.731171 delta_norm=0.082022
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S14] START round=48 head_norm_before_train=1.865796 cos_to_last_merge=1.0000 (last merge round=46)
[S14] round=48 local utility u=0.000000 metrics={'f1_val': 0.9922634811590824, 'auprc': 0.9993330211237734, 'loss_val': 0.05126638857723775, 'psi': 0.9950912971449588}-{'f1_val': 0.996625866862095, 'auprc': 0.9995000608520648, 'loss_val': 0.03881893977334225, 'psi': 0.9977755444580829}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=48 head_norm_before_train=1.828887 cos_to_last_merge=0.9673 (last merge round=19)
[S15] round=48 local utility u=1.000000 metrics={'f1_val': 0.995764307674151, 'auprc': 0.996270920532702, 'loss_val': 0.02643377289728547, 'psi': 0.9959669528175714}-{'f1_val': 0.7010713433702593, 'auprc': 0.8226486204903133, 'loss_val': 0.6512418578574382, 'psi': 0.749702254218281}
[S16] START round=48 head_norm_before_train=1.834054 cos_to_last_merge=1.0000 (last merge round=46)
[S16] round=48 local utility u=0.022183 metrics={'f1_val': 0.9919179974956791, 'auprc': 0.9929023332009013, 'loss_val': 0.04972840146158745, 'psi': 0.992311731777768}-{'f1_val': 0.9893009802119113, 'auprc': 0.9888932596856239, 'loss_val': 0.06636477118076499, 'psi': 0.9891378920013963}
[S17] START round=48 head_norm_before_train=1.802080 cos_to_last_merge=0.9999 (last merge round=45)
[S17] round=48 local utility u=0.000000 metrics={'f1_val': 0.5886660624831852, 'auprc': 0.8016450433210013, 'loss_val': 1.0504451987457735, 'psi': 0.6738576548183117}-{'f1_val': 0.7999907337517917, 'auprc': 0.9143244936158977, 'loss_val': 0.47352208002453977, 'psi': 0.8457242376974341}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.998)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S16] not sending this round → trigger blocked (psi=0.992)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=48 metric=0.9933 head_norm=1.842712
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.814154e-02
[S8] stored merged vector for next round verification (round=48)
[S8] DEBUG after merge:  round=48 metric=0.9933 head_norm=1.836727 delta_norm=0.078142
[S8] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=49 head_norm_before_train=2.060801 (no previous merge yet)
[S2] round=49 local utility u=0.000000 metrics={'f1_val': 0.698022134475808, 'auprc': 0.7994044819780924, 'loss_val': 0.6784113666273318, 'psi': 0.7385750734767218}-{'f1_val': 0.7157727802377625, 'auprc': 0.8776624191510651, 'loss_val': 0.6797343919784977, 'psi': 0.7805286358030835}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=49 head_norm_before_train=2.294136 (no previous merge yet)
[S3] round=49 local utility u=0.005894 metrics={'f1_val': 0.9612927942165166, 'auprc': 0.9994875301776411, 'loss_val': 0.08354719179713894, 'psi': 0.9765706886009664}-{'f1_val': 0.9605438728991138, 'auprc': 0.9993374075874248, 'loss_val': 0.09039103198353882, 'psi': 0.9760612867744383}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=49 head_norm_before_train=1.697549 cos_to_last_merge=0.9040 (last merge round=17)
[S4] ⚠️ Model drifted since last merge! cos=0.904
[S4] round=49 local utility u=0.000000 metrics={'f1_val': 0.9447525023676485, 'auprc': 0.9712791598359793, 'loss_val': 0.2765845606586654, 'psi': 0.9553631653549808}-{'f1_val': 0.9524148976789399, 'auprc': 0.9762578755979415, 'loss_val': 0.2650321423843463, 'psi': 0.9619520888465405}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=49 head_norm_before_train=1.831206 cos_to_last_merge=0.9334 (last merge round=20)
[S5] ⚠️ Model drifted since last merge! cos=0.933
[S5] round=49 local utility u=0.000000 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9962229209828093, 'loss_val': 0.027716873027048474, 'psi': 0.9967309035597623}-{'f1_val': 0.9966309045197074, 'auprc': 0.9978973836056653, 'loss_val': 0.02206617965784354, 'psi': 0.9971374961540905}
[S6] START round=49 head_norm_before_train=1.941133 cos_to_last_merge=0.9765 (last merge round=21)
[S6] round=49 local utility u=0.199682 metrics={'f1_val': 0.8897519562097029, 'auprc': 0.9574154066390398, 'loss_val': 0.305024578705941, 'psi': 0.9168173363814376}-{'f1_val': 0.8408099152673197, 'auprc': 0.9576920870335426, 'loss_val': 0.41156631822016904, 'psi': 0.8875627839738088}
[S7] START round=49 head_norm_before_train=1.903548 (no previous merge yet)
[S7] round=49 local utility u=0.776445 metrics={'f1_val': 0.679863143310416, 'auprc': 0.8487984789525788, 'loss_val': 0.2738564171611085, 'psi': 0.7474372775672811}-{'f1_val': 0.561442687657018, 'auprc': 0.7878044788963898, 'loss_val': 0.9332418912182396, 'psi': 0.6519874041527667}
[S8] START round=49 head_norm_before_train=1.836727 cos_to_last_merge=1.0000 (last merge round=48)
[S8] round=49 local utility u=0.000000 metrics={'f1_val': 0.9922069265978078, 'auprc': 0.984101851978928, 'loss_val': 0.05369276078072265, 'psi': 0.9889648967502559}-{'f1_val': 0.9933016371923923, 'auprc': 0.983637660096259, 'loss_val': 0.051675996779411724, 'psi': 0.989436046353939}
[S9] START round=49 head_norm_before_train=1.783403 cos_to_last_merge=0.9999 (last merge round=47)
[S9] round=49 local utility u=0.000000 metrics={'f1_val': 0.9939393793306803, 'auprc': 0.9987425892136546, 'loss_val': 0.037786413863796595, 'psi': 0.99586066328387}-{'f1_val': 0.9971029125121428, 'auprc': 0.9987405753515991, 'loss_val': 0.02982954572694207, 'psi': 0.9977579776479253}
[S10] START round=49 head_norm_before_train=1.872649 cos_to_last_merge=0.9594 (last merge round=20)
[S10] round=49 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9949447088200917, 'loss_val': 0.028754745497739174, 'psi': 0.9950905869396616}-{'f1_val': 0.9951878390193748, 'auprc': 0.996388091014143, 'loss_val': 0.027543612153874165, 'psi': 0.9956679398172821}
[S11] START round=49 head_norm_before_train=1.953356 cos_to_last_merge=1.0000 (last merge round=47)
[S11] round=49 local utility u=0.000000 metrics={'f1_val': 0.9962850284706224, 'auprc': 0.9954473869901751, 'loss_val': 0.033422259989683116, 'psi': 0.9959499718784435}-{'f1_val': 0.9967224195815153, 'auprc': 0.9956387688406322, 'loss_val': 0.03574999945710388, 'psi': 0.996288959285162}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=49 head_norm_before_train=1.731171 cos_to_last_merge=1.0000 (last merge round=48)
[S13] round=49 local utility u=0.000000 metrics={'f1_val': 0.6343595713733192, 'auprc': 0.7843621547678343, 'loss_val': 0.6580171273946742, 'psi': 0.6943606047311253}-{'f1_val': 0.6876133568810806, 'auprc': 0.7764868113046655, 'loss_val': 0.6898300008678278, 'psi': 0.7231627386505146}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=49 head_norm_before_train=1.876232 cos_to_last_merge=0.9999 (last merge round=46)
[S14] round=49 local utility u=0.021772 metrics={'f1_val': 0.9969167109240578, 'auprc': 0.9981695621940732, 'loss_val': 0.03215086451661048, 'psi': 0.997417851432064}-{'f1_val': 0.9922634811590824, 'auprc': 0.9993330211237734, 'loss_val': 0.05126638857723775, 'psi': 0.9950912971449588}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] sending update (kind=head size=1804 to 1 peers)
[S15] START round=49 head_norm_before_train=1.836224 cos_to_last_merge=0.9666 (last merge round=19)
[S15] round=49 local utility u=0.000000 metrics={'f1_val': 0.7748381461467244, 'auprc': 0.9881079516272119, 'loss_val': 0.41841549410413914, 'psi': 0.8601460683389194}-{'f1_val': 0.995764307674151, 'auprc': 0.996270920532702, 'loss_val': 0.02643377289728547, 'psi': 0.9959669528175714}
[S16] START round=49 head_norm_before_train=1.848246 cos_to_last_merge=0.9998 (last merge round=46)
[S16] round=49 local utility u=0.002355 metrics={'f1_val': 0.9925754506651738, 'auprc': 0.9926059921156748, 'loss_val': 0.048074447293777245, 'psi': 0.9925876672453743}-{'f1_val': 0.9919179974956791, 'auprc': 0.9929023332009013, 'loss_val': 0.04972840146158745, 'psi': 0.992311731777768}
[S17] START round=49 head_norm_before_train=1.809267 cos_to_last_merge=0.9997 (last merge round=45)
[S17] round=49 local utility u=0.399399 metrics={'f1_val': 0.6157703351220589, 'auprc': 0.9294124429782664, 'loss_val': 0.7975745130750552, 'psi': 0.7412271782645419}-{'f1_val': 0.5886660624831852, 'auprc': 0.8016450433210013, 'loss_val': 1.0504451987457735, 'psi': 0.6738576548183117}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S17] sending update (kind=head size=1807 to 1 peers)
[S6] not sending this round → trigger blocked (psi=0.917)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] sending update (kind=head size=1795 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[runner] rounds complete.
[runner] all agents stopped.
