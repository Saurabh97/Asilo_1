[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:37103
[S3] → join 127.0.0.1:37102
[S4] → join 127.0.0.1:37102
[S5] → join 127.0.0.1:37102
[S6] → join 127.0.0.1:37102
[S7] → join 127.0.0.1:37102
[S8] → join 127.0.0.1:37102
[S9] → join 127.0.0.1:37102
[S10] → join 127.0.0.1:37102
[S11] → join 127.0.0.1:37102
[S13] → join 127.0.0.1:37102
[S14] → join 127.0.0.1:37102
[S15] → join 127.0.0.1:37102
[S16] → join 127.0.0.1:37102
[S17] → join 127.0.0.1:37102
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.170901 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.200819 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.133455 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.147519 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.097671 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.193998 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.175637 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.151883 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.157044 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.187572 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.186173 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.162894 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.168480 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.212553 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.127424 (no previous merge yet)
[S16]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S3] + discovered S8
[S3] + discovered S14
[S3] + discovered S7
[S3] + discovered S15
[S3] + discovered S9
[S4] + discovered S2
[S4] + discovered S3
[S3] + discovered S5
[S3] + discovered S13
[S3] + discovered S6
[S3] + discovered S16
[S3] + discovered S11
[S3] + discovered S4
[S3] + discovered S10
[S3] + discovered S17
[S5] + discovered S2
[S5] + discovered S3
[S4] + discovered S17
[S4] + discovered S5
[S4] + discovered S10
[S5] + discovered S4
[S4] + discovered S11
[S4] + discovered S16
[S4] + discovered S6
[S4] + discovered S9
[S4] + discovered S15
[S4] + discovered S7
[S4] + discovered S8
[S4] + discovered S13
[S4] + discovered S14
[S5] + discovered S15
[S5] + discovered S9
[S5] + discovered S16
[S5] + discovered S13
[S5] + discovered S17
[S5] + discovered S8
[S5] + discovered S14
[S5] + discovered S7
[S5] + discovered S11
[S5] + discovered S6
[S5] + discovered S10
[S6] + discovered S4
[S6] + discovered S3
[S6] + discovered S5
[S6] + discovered S2
[S7] + discovered S2
[S7] + discovered S4
[S7] + discovered S6
[S7] + discovered S5
[S7] + discovered S3
[S6] + discovered S11
[S6] + discovered S7
[S6] + discovered S8
[S6] + discovered S13
[S6] + discovered S9
[S6] + discovered S10
[S6] + discovered S16
[S6] + discovered S14
[S6] + discovered S17
[S6] + discovered S15
[S8] + discovered S7
[S8] + discovered S4
[S8] + discovered S3
[S8] + discovered S5
[S8] + discovered S6
[S8] + discovered S2
[S7] + discovered S9
[S7] + discovered S15
[S7] + discovered S11
[S7] + discovered S17
[S7] + discovered S13
[S7] + discovered S14
[S7] + discovered S16
[S7] + discovered S10
[S7] + discovered S8
[S9] + discovered S5
[S9] + discovered S7
[S9] + discovered S2
[S9] + discovered S8
[S8] + discovered S17
[S9] + discovered S3
[S8] + discovered S10
[S8] + discovered S15
[S8] + discovered S11
[S8] + discovered S16
[S8] + discovered S14
[S8] + discovered S13
[S8] + discovered S9
[S9] + discovered S4
[S9] + discovered S6
[S9] + discovered S13
[S9] + discovered S14
[S9] + discovered S15
[S9] + discovered S10
[S9] + discovered S17
[S9] + discovered S16
[S9] + discovered S11
[S10] + discovered S3
[S10] + discovered S8
[S10] + discovered S2
[S10] + discovered S7
[S10] + discovered S5
[S10] + discovered S9
[S10] + discovered S6
[S10] + discovered S4
[S10] + discovered S14
[S11] + discovered S8
[S11] + discovered S5
[S11] + discovered S7
[S11] + discovered S2
[S11] + discovered S4
[S11] + discovered S6
[S11] + discovered S9
[S11] + discovered S10
[S11] + discovered S3
[S10] + discovered S17
[S10] + discovered S11
[S10] + discovered S16
[S10] + discovered S13
[S10] + discovered S15
[S11] + discovered S17
[S11] + discovered S13
[S13] + discovered S11
[S13] + discovered S2
[S13] + discovered S9
[S13] + discovered S10
[S13] + discovered S3
[S13] + discovered S5
[S13] + discovered S7
[S13] + discovered S6
[S13] + discovered S4
[S13] + discovered S8
[S11] + discovered S15
[S11] + discovered S14
[S11] + discovered S16
[S14] + discovered S3
[S14] + discovered S5
[S14] + discovered S7
[S14] + discovered S6
[S14] + discovered S8
[S14] + discovered S13
[S14] + discovered S4
[S13] + discovered S14
[S13] + discovered S16
[S13] + discovered S15
[S13] + discovered S17
[S14] + discovered S2
[S14] + discovered S10
[S14] + discovered S11
[S14] + discovered S9
[S15] + discovered S14
[S15] + discovered S10
[S15] + discovered S9
[S14] + discovered S15
[S14] + discovered S17
[S14] + discovered S16
[S15] + discovered S13
[S15] + discovered S11
[S15] + discovered S3
[S15] + discovered S5
[S15] + discovered S2
[S15] + discovered S7
[S15] + discovered S6
[S15] + discovered S8
[S15] + discovered S4
[S16] + discovered S11
[S16] + discovered S7
[S16] + discovered S8
[S16] + discovered S14
[S16] + discovered S15
[S16] + discovered S3
[S16] + discovered S5
[S16] + discovered S4
[S16] + discovered S10
[S15] + discovered S17
[S16] + discovered S6
[S16] + discovered S13
[S16] + discovered S2
[S15] + discovered S16
[S16] + discovered S9
[S17] + discovered S15
[S17] + discovered S14
[S17] + discovered S7
[S17] + discovered S10
[S17] + discovered S11
[S17] + discovered S13
[S17] + discovered S9
[S17] + discovered S8
[S17] + discovered S2
[S17] + discovered S5
[S16] + discovered S17
[S17] + discovered S4
[S17] + discovered S6
[S17] + discovered S16
[S17] + discovered S3
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] ⇄ pheromone p=1.000 → S13@127.0.0.1:37113
[S3] ⇄ pheromone p=1.000 → S4@127.0.0.1:37104
[S10] ⇄ pheromone p=1.000 → S14@127.0.0.1:37114
[S2] ⇄ pheromone p=1.000 → S16@127.0.0.1:37116
[S7] ⇄ pheromone p=1.000 → S10@127.0.0.1:37111
[S14] ⇄ pheromone p=1.000 → S4@127.0.0.1:37104
[S15] ⇄ pheromone p=1.000 → S16@127.0.0.1:37116
[S6] ⇄ pheromone p=1.000 → S11@127.0.0.1:37112
[S11] ⇄ pheromone p=1.000 → S14@127.0.0.1:37114
[S4] ⇄ pheromone p=1.000 → S9@127.0.0.1:37110
[S13] ⇄ pheromone p=1.000 → S16@127.0.0.1:37116
[S16] ⇄ pheromone p=1.000 → S2@127.0.0.1:37102
[S8] ⇄ pheromone p=1.000 → S17@127.0.0.1:37117
[S5] ⇄ pheromone p=1.000 → S9@127.0.0.1:37110
[S17] ⇄ pheromone p=1.000 → S9@127.0.0.1:37110
[S2] START round=1 head_norm_before_train=1.177652 (no previous merge yet)
[S2] round=1 local utility u=0.077044 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.8491841502950578, 'loss_val': 1.2980488884020487, 'psi': 0.4247399401511632}-{'f1_val': 0.1417771333885667, 'auprc': 0.8085891420563462, 'loss_val': 1.3303516924158065, 'psi': 0.40850193685567854}
[S3] START round=1 head_norm_before_train=1.214224 (no previous merge yet)
[S3] round=1 local utility u=0.241674 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8033270190440542, 'loss_val': 1.2916968646403444, 'psi': 0.4052348469860859}-{'f1_val': 0.13984006561410703, 'auprc': 0.6592762088754157, 'loss_val': 1.3428925140799632, 'psi': 0.3476145229186305}
[S4] START round=1 head_norm_before_train=1.146394 (no previous merge yet)
[S4] round=1 local utility u=0.083596 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7959047201073424, 'loss_val': 1.300366131957295, 'psi': 0.40249786538004745}-{'f1_val': 0.14022662889518414, 'auprc': 0.7522095355848628, 'loss_val': 1.3364727909744964, 'psi': 0.38501979157105565}
[S5] START round=1 head_norm_before_train=1.162237 (no previous merge yet)
[S5] round=1 local utility u=0.075579 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7290664880851125, 'loss_val': 1.2690662750415578, 'psi': 0.3769837380911879}-{'f1_val': 0.14226190476190476, 'auprc': 0.6979437079796162, 'loss_val': 1.3268561797153209, 'psi': 0.36453462604898934}
[S6] START round=1 head_norm_before_train=1.106374 (no previous merge yet)
[S6] round=1 local utility u=0.038981 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6204781061788782, 'loss_val': 1.314849073031172, 'psi': 0.33304701170232054}-{'f1_val': 0.14142628205128205, 'auprc': 0.6046459335724583, 'loss_val': 1.3453141214201538, 'psi': 0.32671414265975257}
[S7] START round=1 head_norm_before_train=1.208220 (no previous merge yet)
[S7] round=1 local utility u=0.035214 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.5754258149835595, 'loss_val': 1.2922719598377905, 'psi': 0.3154044196308788}-{'f1_val': 0.14205682272909165, 'auprc': 0.5744969275718212, 'loss_val': 1.359912932090134, 'psi': 0.3150328646661835}
[S8] START round=1 head_norm_before_train=1.176437 (no previous merge yet)
[S8] round=1 local utility u=1.000000 metrics={'f1_val': 0.4565163842827732, 'auprc': 0.5361932643135244, 'loss_val': 1.3329638510883375, 'psi': 0.4883871362950737}-{'f1_val': 0.10450549450549451, 'auprc': 0.4980196893597611, 'loss_val': 1.366363065245106, 'psi': 0.26191117244720113}
[S9] START round=1 head_norm_before_train=1.171377 (no previous merge yet)
[S9] round=1 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.894946367280567, 'loss_val': 1.212395036827563, 'psi': 0.4428173211962244}-{'f1_val': 0.141397957139996, 'auprc': 0.9715035846072206, 'loss_val': 1.2992261498592235, 'psi': 0.47344020812688586}
[S10] START round=1 head_norm_before_train=1.159219 (no previous merge yet)
[S10] round=1 local utility u=0.793663 metrics={'f1_val': 0.22083050619712802, 'auprc': 0.6074360729726063, 'loss_val': 1.3373292505453, 'psi': 0.3754727329073193}-{'f1_val': 0.10265544041450778, 'auprc': 0.32388073877286083, 'loss_val': 1.3649386506511387, 'psi': 0.19114555975784903}
[S11] START round=1 head_norm_before_train=1.195232 (no previous merge yet)
[S11] round=1 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.8342675711052406, 'loss_val': 1.3303843691819248, 'psi': 0.4179552384659626}-{'f1_val': 0.21314217156250426, 'auprc': 0.7715379972795449, 'loss_val': 1.3630853210246332, 'psi': 0.43650050184932054}
[S13] START round=1 head_norm_before_train=1.190482 (no previous merge yet)
[S13] round=1 local utility u=0.000000 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5253421629906533, 'loss_val': 1.335787936284492, 'psi': 0.2943683227424932}-{'f1_val': 0.3353867594089764, 'auprc': 0.4676678980849424, 'loss_val': 1.364941699279373, 'psi': 0.3882992148793628}
[S14] START round=1 head_norm_before_train=1.166370 (no previous merge yet)
[S14] round=1 local utility u=0.222483 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.556686621729848, 'loss_val': 1.3368529601124874, 'psi': 0.30688936042156145}-{'f1_val': 0.14035785288270378, 'auprc': 0.4157150161830545, 'loss_val': 1.3589038600464212, 'psi': 0.2505007182028441}
[S15] START round=1 head_norm_before_train=1.172846 (no previous merge yet)
[S15] round=1 local utility u=0.013154 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7694568234387898, 'loss_val': 1.3136996233857998, 'psi': 0.391622920192451}-{'f1_val': 0.13973365136155833, 'auprc': 0.767127117933084, 'loss_val': 1.3330188726898686, 'psi': 0.39069103799016863}
[S16] START round=1 head_norm_before_train=1.217898 (no previous merge yet)
[S16] round=1 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8036806094794188, 'loss_val': 1.3286174719170543, 'psi': 0.40585471391128947}-{'f1_val': 0.6186881685188852, 'auprc': 0.8028373437167371, 'loss_val': 1.3702473513487725, 'psi': 0.692347838598026}
[S17] START round=1 head_norm_before_train=1.134704 (no previous merge yet)
[S17] round=1 local utility u=0.207922 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.6847884562202253, 'loss_val': 1.3164348781202246, 'psi': 0.3584847604785208}-{'f1_val': 0.14094896331738438, 'auprc': 0.5544122663032072, 'loss_val': 1.3411502332834702, 'psi': 0.3063342845117135}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S15] → sending delta(kind=head bytes=1791) to S16@127.0.0.1:37116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S4] → sending delta(kind=head bytes=1787) to S14@127.0.0.1:37114
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S7] → sending delta(kind=head bytes=1788) to S15@127.0.0.1:37115
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:37105
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S8] → sending delta(kind=head bytes=1790) to S5@127.0.0.1:37105
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S14] → sending delta(kind=head bytes=1786) to S10@127.0.0.1:37111
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:37117
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] → sending delta(kind=head bytes=1793) to S15@127.0.0.1:37115
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] → sending delta(kind=head bytes=1793) to S14@127.0.0.1:37114
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S2] → sending delta(kind=head bytes=1790) to S10@127.0.0.1:37111
[S6] sending update (kind=head size=1793 to 1 peers)
[S2] sending update (kind=head size=1790 to 1 peers)
[S5] sending update (kind=head size=1793 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1786 to 1 peers)
[S8] sending update (kind=head size=1790 to 1 peers)
[S10] sending update (kind=head size=1793 to 1 peers)
[S7] sending update (kind=head size=1788 to 1 peers)
[S4] sending update (kind=head size=1787 to 1 peers)
[S15] sending update (kind=head size=1791 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1786) from S14
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.175013)
[S10] loaded HEAD from S14 (vec_in norm=1.175013)
[S10] cosine check vs S14: cos=-0.0574
[S10] DROPPED delta from S14 (cos=-0.0574 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1790) from S2
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.195643)
[S10] loaded HEAD from S2 (vec_in norm=1.195643)
[S10] cosine check vs S2: cos=-0.0305
[S10] DROPPED delta from S2 (cos=-0.0305 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1790) from S8
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.188348)
[S5] loaded HEAD from S8 (vec_in norm=1.188348)
[S5] cosine check vs S8: cos=-0.0176
[S5] DROPPED delta from S8 (cos=-0.0176 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1793) from S10
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.170492)
[S5] loaded HEAD from S10 (vec_in norm=1.170492)
[S5] cosine check vs S10: cos=0.2469
[S5] BUFFERED delta from S10 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1796) from S3
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.253953)
[S17] loaded HEAD from S3 (vec_in norm=1.253953)
[S17] cosine check vs S3: cos=-0.0237
[S17] DROPPED delta from S3 (cos=-0.0237 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1791) from S15
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.186713)
[S16] loaded HEAD from S15 (vec_in norm=1.186713)
[S16] cosine check vs S15: cos=-0.0069
[S16] DROPPED delta from S15 (cos=-0.0069 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1793) from S5
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.205587)
[S15] loaded HEAD from S5 (vec_in norm=1.205587)
[S15] cosine check vs S5: cos=0.0180
[S15] BUFFERED delta from S5 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1788) from S7
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.246607)
[S15] loaded HEAD from S7 (vec_in norm=1.246607)
[S15] cosine check vs S7: cos=-0.0102
[S15] DROPPED delta from S7 (cos=-0.0102 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1793) from S6
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.125120)
[S14] loaded HEAD from S6 (vec_in norm=1.125120)
[S14] cosine check vs S6: cos=-0.0132
[S14] DROPPED delta from S6 (cos=-0.0132 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1787) from S4
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.168142)
[S14] loaded HEAD from S4 (vec_in norm=1.168142)
[S14] cosine check vs S4: cos=0.1467
[S14] BUFFERED delta from S4 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:37111
[S17] sending update (kind=head size=1795 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1795) from S17
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.147898)
[S10] loaded HEAD from S17 (vec_in norm=1.147898)
[S10] cosine check vs S17: cos=-0.0008
[S10] DROPPED delta from S17 (cos=-0.0008 < 0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=1 metric=0.1397 head_norm=1.186713
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.381734e-01
[S15] stored merged vector for next round verification (round=1)
[S15] DEBUG after merge:  round=1 metric=0.1397 head_norm=0.853422 delta_norm=0.838173
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=1 metric=0.1423 head_norm=1.205587
[S5] _apply_head_vector_avg (torch): Δ‖w‖=7.291526e-01
[S5] stored merged vector for next round verification (round=1)
[S5] DEBUG after merge:  round=1 metric=0.1423 head_norm=0.938127 delta_norm=0.729153
[S5] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=1 metric=0.1404 head_norm=1.175013
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.652634e-01
[S14] stored merged vector for next round verification (round=1)
[S14] DEBUG after merge:  round=1 metric=0.1404 head_norm=0.887117 delta_norm=0.765263
[S14] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=1.195643 (no previous merge yet)
[S2] round=2 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7285726118930519, 'loss_val': 1.2550341644133736, 'psi': 0.3764953247903608}-{'f1_val': 0.1417771333885667, 'auprc': 0.8491841502950578, 'loss_val': 1.2980488884020487, 'psi': 0.4247399401511632}
[S3] START round=2 head_norm_before_train=1.253953 (no previous merge yet)
[S3] round=2 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.6143611993506102, 'loss_val': 1.2158605087987022, 'psi': 0.3296485191087083}-{'f1_val': 0.13984006561410703, 'auprc': 0.8033270190440542, 'loss_val': 1.2916968646403444, 'psi': 0.4052348469860859}
[S4] START round=2 head_norm_before_train=1.168142 (no previous merge yet)
[S4] round=2 local utility u=0.028950 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7976884621218727, 'loss_val': 1.2478167624546976, 'psi': 0.40321136218585957}-{'f1_val': 0.14022662889518414, 'auprc': 0.7959047201073424, 'loss_val': 1.300366131957295, 'psi': 0.40249786538004745}
[S5] START round=2 head_norm_before_train=0.938127 cos_to_last_merge=1.0000 (last merge round=1)
[S5] round=2 local utility u=0.030758 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7363138265390234, 'loss_val': 1.2292928673283376, 'psi': 0.37988267347275223}-{'f1_val': 0.14226190476190476, 'auprc': 0.7290664880851125, 'loss_val': 1.2690662750415578, 'psi': 0.3769837380911879}
[S6] START round=2 head_norm_before_train=1.125120 (no previous merge yet)
[S6] round=2 local utility u=0.295415 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8044730815802826, 'loss_val': 1.2760048420607937, 'psi': 0.40664500186288227}-{'f1_val': 0.14142628205128205, 'auprc': 0.6204781061788782, 'loss_val': 1.314849073031172, 'psi': 0.33304701170232054}
[S7] START round=2 head_norm_before_train=1.246607 (no previous merge yet)
[S7] round=2 local utility u=0.325008 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7776420883944376, 'loss_val': 1.2489041868165731, 'psi': 0.39629092899523005}-{'f1_val': 0.14205682272909165, 'auprc': 0.5754258149835595, 'loss_val': 1.2922719598377905, 'psi': 0.3154044196308788}
[S8] START round=2 head_norm_before_train=1.188348 (no previous merge yet)
[S8] round=2 local utility u=0.237772 metrics={'f1_val': 0.4158888197469405, 'auprc': 0.7630581050927824, 'loss_val': 1.2942492133763486, 'psi': 0.5547565338852772}-{'f1_val': 0.4565163842827732, 'auprc': 0.5361932643135244, 'loss_val': 1.3329638510883375, 'psi': 0.4883871362950737}
[S9] START round=2 head_norm_before_train=1.213838 (no previous merge yet)
[S9] round=2 local utility u=0.026377 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8659368104251146, 'loss_val': 1.0726126430621021, 'psi': 0.4312134984540435}-{'f1_val': 0.141397957139996, 'auprc': 0.894946367280567, 'loss_val': 1.212395036827563, 'psi': 0.4428173211962244}
[S10] START round=2 head_norm_before_train=1.170492 (no previous merge yet)
[S10] round=2 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6691411117313302, 'loss_val': 1.305239971982668, 'psi': 0.35082942721756644}-{'f1_val': 0.22083050619712802, 'auprc': 0.6074360729726063, 'loss_val': 1.3373292505453, 'psi': 0.3754727329073193}
[S11] START round=2 head_norm_before_train=1.210785 (no previous merge yet)
[S11] round=2 local utility u=0.028333 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.8405398362436871, 'loss_val': 1.2925353041776937, 'psi': 0.42046414452134123}-{'f1_val': 0.14041368337311058, 'auprc': 0.8342675711052406, 'loss_val': 1.3303843691819248, 'psi': 0.4179552384659626}
[S13] START round=2 head_norm_before_train=1.201604 (no previous merge yet)
[S13] round=2 local utility u=0.000000 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5065359090379233, 'loss_val': 1.3017352220096166, 'psi': 0.2868458211614012}-{'f1_val': 0.1403857625770531, 'auprc': 0.5253421629906533, 'loss_val': 1.335787936284492, 'psi': 0.2943683227424932}
[S14] START round=2 head_norm_before_train=0.887117 cos_to_last_merge=1.0000 (last merge round=1)
[S14] round=2 local utility u=0.170072 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.6692088465059511, 'loss_val': 1.3342760970758203, 'psi': 0.3518982503320027}-{'f1_val': 0.14035785288270378, 'auprc': 0.556686621729848, 'loss_val': 1.3368529601124874, 'psi': 0.30688936042156145}
[S15] START round=2 head_norm_before_train=0.853422 cos_to_last_merge=1.0000 (last merge round=1)
[S15] round=2 local utility u=0.000000 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7693585085954173, 'loss_val': 1.3190680942365811, 'psi': 0.391583594255102}-{'f1_val': 0.13973365136155833, 'auprc': 0.7694568234387898, 'loss_val': 1.3136996233857998, 'psi': 0.391622920192451}
[S16] START round=2 head_norm_before_train=1.232518 (no previous merge yet)
[S16] round=2 local utility u=0.072830 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8352469467007606, 'loss_val': 1.2776564865196245, 'psi': 0.4184812487998262}-{'f1_val': 0.14063745019920318, 'auprc': 0.8036806094794188, 'loss_val': 1.3286174719170543, 'psi': 0.40585471391128947}
[S17] START round=2 head_norm_before_train=1.147898 (no previous merge yet)
[S17] round=2 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.6414074464920305, 'loss_val': 1.2851829299190674, 'psi': 0.34113235658724284}-{'f1_val': 0.14094896331738438, 'auprc': 0.6847884562202253, 'loss_val': 1.3164348781202246, 'psi': 0.3584847604785208}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:37111
[S8] not sending this round → trigger blocked (psi=0.555)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.352)
[S7] not sending this round → trigger blocked (psi=0.396)
[S6] not sending this round → trigger blocked (psi=0.407)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S11] → sending delta(kind=head bytes=1791) to S13@127.0.0.1:37113
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:37105
[S4] not sending this round → trigger blocked (psi=0.403)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.380)
[S9] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1791 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1798) from S16
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.258716)
[S10] loaded HEAD from S16 (vec_in norm=1.258716)
[S10] cosine check vs S16: cos=-0.0137
[S10] DROPPED delta from S16 (cos=-0.0137 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1799) from S9
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.275944)
[S5] loaded HEAD from S9 (vec_in norm=1.275944)
[S5] cosine check vs S9: cos=-0.0834
[S5] DROPPED delta from S9 (cos=-0.0834 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1791) from S11
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.233406)
[S13] loaded HEAD from S11 (vec_in norm=1.233406)
[S13] cosine check vs S11: cos=-0.0110
[S13] DROPPED delta from S11 (cos=-0.0110 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=3 head_norm_before_train=1.224511 (no previous merge yet)
[S2] round=3 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6120775527201037, 'loss_val': 1.2003686852321191, 'psi': 0.3298973011211815}-{'f1_val': 0.1417771333885667, 'auprc': 0.7285726118930519, 'loss_val': 1.2550341644133736, 'psi': 0.3764953247903608}
[S3] START round=3 head_norm_before_train=1.305408 (no previous merge yet)
[S3] round=3 local utility u=0.334857 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.7942436192486256, 'loss_val': 1.085793991647752, 'psi': 0.40160148706791454}-{'f1_val': 0.13984006561410703, 'auprc': 0.6143611993506102, 'loss_val': 1.2158605087987022, 'psi': 0.3296485191087083}
[S4] START round=3 head_norm_before_train=1.201424 (no previous merge yet)
[S4] round=3 local utility u=0.060242 metrics={'f1_val': 0.14497098646034817, 'auprc': 0.7981000616200441, 'loss_val': 1.1570346635240796, 'psi': 0.40622261652422653}-{'f1_val': 0.14022662889518414, 'auprc': 0.7976884621218727, 'loss_val': 1.2478167624546976, 'psi': 0.40321136218585957}
[S5] START round=3 head_norm_before_train=0.974925 cos_to_last_merge=0.9955 (last merge round=1)
[S5] round=3 local utility u=0.940783 metrics={'f1_val': 0.41654174186412063, 'auprc': 0.7775931913919938, 'loss_val': 1.1172449181227964, 'psi': 0.5609623216752699}-{'f1_val': 0.14226190476190476, 'auprc': 0.7363138265390234, 'loss_val': 1.2292928673283376, 'psi': 0.37988267347275223}
[S6] START round=3 head_norm_before_train=1.153803 (no previous merge yet)
[S6] round=3 local utility u=0.030748 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8104230636143162, 'loss_val': 1.2323595680150472, 'psi': 0.40902499467649567}-{'f1_val': 0.14142628205128205, 'auprc': 0.8044730815802826, 'loss_val': 1.2760048420607937, 'psi': 0.40664500186288227}
[S7] START round=3 head_norm_before_train=1.297092 (no previous merge yet)
[S7] round=3 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.5886066812173849, 'loss_val': 1.1781016312266657, 'psi': 0.320676766124409}-{'f1_val': 0.14205682272909165, 'auprc': 0.7776420883944376, 'loss_val': 1.2489041868165731, 'psi': 0.39629092899523005}
[S8] START round=3 head_norm_before_train=1.211588 (no previous merge yet)
[S8] round=3 local utility u=0.000000 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7708894841901998, 'loss_val': 1.2438408784337784, 'psi': 0.3923293831118542}-{'f1_val': 0.4158888197469405, 'auprc': 0.7630581050927824, 'loss_val': 1.2942492133763486, 'psi': 0.5547565338852772}
[S9] START round=3 head_norm_before_train=1.275944 (no previous merge yet)
[S9] round=3 local utility u=1.000000 metrics={'f1_val': 0.7002642836972446, 'auprc': 0.9376562897321579, 'loss_val': 0.7716432378839614, 'psi': 0.7952210861112099}-{'f1_val': 0.141397957139996, 'auprc': 0.8659368104251146, 'loss_val': 1.0726126430621021, 'psi': 0.4312134984540435}
[S10] START round=3 head_norm_before_train=1.190333 (no previous merge yet)
[S10] round=3 local utility u=0.044618 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6851779559097897, 'loss_val': 1.2641139376123163, 'psi': 0.3572441648889502}-{'f1_val': 0.13862163754172394, 'auprc': 0.6691411117313302, 'loss_val': 1.305239971982668, 'psi': 0.35082942721756644}
[S11] START round=3 head_norm_before_train=1.233406 (no previous merge yet)
[S11] round=3 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.8194041736589075, 'loss_val': 1.244351699348259, 'psi': 0.41200987948742934}-{'f1_val': 0.14041368337311058, 'auprc': 0.8405398362436871, 'loss_val': 1.2925353041776937, 'psi': 0.42046414452134123}
[S13] START round=3 head_norm_before_train=1.218580 (no previous merge yet)
[S13] round=3 local utility u=0.042059 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5209326761412636, 'loss_val': 1.2608078735722061, 'psi': 0.2926045280027373}-{'f1_val': 0.1403857625770531, 'auprc': 0.5065359090379233, 'loss_val': 1.3017352220096166, 'psi': 0.2868458211614012}
[S14] START round=3 head_norm_before_train=0.901028 cos_to_last_merge=0.9977 (last merge round=1)
[S14] round=3 local utility u=0.185407 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7848992779999737, 'loss_val': 1.3105326015556216, 'psi': 0.39817442292961175}-{'f1_val': 0.14035785288270378, 'auprc': 0.6692088465059511, 'loss_val': 1.3342760970758203, 'psi': 0.3518982503320027}
[S15] START round=3 head_norm_before_train=0.868158 cos_to_last_merge=0.9978 (last merge round=1)
[S15] round=3 local utility u=0.016796 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7734472836073535, 'loss_val': 1.2977425395100808, 'psi': 0.39321910425987644}-{'f1_val': 0.13973365136155833, 'auprc': 0.7693585085954173, 'loss_val': 1.3190680942365811, 'psi': 0.391583594255102}
[S16] START round=3 head_norm_before_train=1.258716 (no previous merge yet)
[S16] round=3 local utility u=0.028758 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8355909908410635, 'loss_val': 1.221172381108433, 'psi': 0.41861886645594737}-{'f1_val': 0.14063745019920318, 'auprc': 0.8352469467007606, 'loss_val': 1.2776564865196245, 'psi': 0.4184812487998262}
[S17] START round=3 head_norm_before_train=1.170022 (no previous merge yet)
[S17] round=3 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5939694755301494, 'loss_val': 1.2453098173117607, 'psi': 0.3221571682024904}-{'f1_val': 0.14094896331738438, 'auprc': 0.6414074464920305, 'loss_val': 1.2851829299190674, 'psi': 0.34113235658724284}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S4] → sending delta(kind=head bytes=1792) to S9@127.0.0.1:37110
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:37116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S13] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:37116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] → sending delta(kind=head bytes=1793) to S4@127.0.0.1:37104
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:37113
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:37109
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:37104
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S5] → sending delta(kind=head bytes=1788) to S9@127.0.0.1:37110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:37114
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:37112
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1794 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1793 to 1 peers)
[S5] sending update (kind=head size=1788 to 1 peers)
[S13] sending update (kind=head size=1793 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1792 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1793) from S13
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.242738)
[S16] loaded HEAD from S13 (vec_in norm=1.242738)
[S16] cosine check vs S13: cos=-0.0224
[S16] DROPPED delta from S13 (cos=-0.0224 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1794) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.216302)
[S14] loaded HEAD from S10 (vec_in norm=1.216302)
[S14] cosine check vs S10: cos=0.0032
[S14] BUFFERED delta from S10 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1798) from S14
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.924843)
[S4] loaded HEAD from S14 (vec_in norm=0.924843)
[S4] cosine check vs S14: cos=0.7303
[S4] BUFFERED delta from S14 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1793) from S3
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.353600)
[S4] loaded HEAD from S3 (vec_in norm=1.353600)
[S4] cosine check vs S3: cos=0.0354
[S4] BUFFERED delta from S3 (total buffered=2)
[S11] RECEIVED delta(kind=head bytes=1798) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.187046)
[S11] loaded HEAD from S6 (vec_in norm=1.187046)
[S11] cosine check vs S6: cos=-0.0274
[S11] DROPPED delta from S6 (cos=-0.0274 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1796) from S9
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.348482)
[S13] loaded HEAD from S9 (vec_in norm=1.348482)
[S13] cosine check vs S9: cos=0.0538
[S13] BUFFERED delta from S9 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1799) from S15
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.892068)
[S16] loaded HEAD from S15 (vec_in norm=0.892068)
[S16] cosine check vs S15: cos=0.0229
[S16] BUFFERED delta from S15 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1802) from S16
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.295034)
[S8] loaded HEAD from S16 (vec_in norm=1.295034)
[S8] cosine check vs S16: cos=-0.0678
[S8] DROPPED delta from S16 (cos=-0.0678 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1788) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.011719)
[S9] loaded HEAD from S5 (vec_in norm=1.011719)
[S9] cosine check vs S5: cos=-0.0918
[S9] DROPPED delta from S5 (cos=-0.0918 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1792) from S4
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.246318)
[S9] loaded HEAD from S4 (vec_in norm=1.246318)
[S9] cosine check vs S4: cos=-0.0438
[S9] DROPPED delta from S4 (cos=-0.0438 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=3 metric=0.1450 head_norm=1.246318
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.789648e-01
[S4] stored merged vector for next round verification (round=3)
[S4] DEBUG after merge:  round=3 metric=0.1402 head_norm=0.886538 delta_norm=0.578965
[S4] aggregate: ACCEPT kept=['S14', 'S3'] (k=2/2) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=3 metric=0.1404 head_norm=1.242738
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.919857e-01
[S13] stored merged vector for next round verification (round=3)
[S13] DEBUG after merge:  round=3 metric=0.1404 head_norm=0.941150 delta_norm=0.891986
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=3 metric=0.1404 head_norm=0.924843
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.628251e-01
[S14] stored merged vector for next round verification (round=3)
[S14] DEBUG after merge:  round=3 metric=0.1404 head_norm=0.765153 delta_norm=0.762825
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=3 metric=0.1406 head_norm=1.295034
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.778304e-01
[S16] stored merged vector for next round verification (round=3)
[S16] DEBUG after merge:  round=3 metric=0.1406 head_norm=0.794626 delta_norm=0.777830
[S16] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=1.258818 (no previous merge yet)
[S2] round=4 local utility u=0.030168 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6114244729778173, 'loss_val': 1.1380739025547266, 'psi': 0.32963606922426697}-{'f1_val': 0.1417771333885667, 'auprc': 0.6120775527201037, 'loss_val': 1.2003686852321191, 'psi': 0.3298973011211815}
[S3] START round=4 head_norm_before_train=1.353600 (no previous merge yet)
[S3] round=4 local utility u=1.000000 metrics={'f1_val': 0.6977762917607885, 'auprc': 0.796188257485681, 'loss_val': 0.8591900729929128, 'psi': 0.7371410780507455}-{'f1_val': 0.13984006561410703, 'auprc': 0.7942436192486256, 'loss_val': 1.085793991647752, 'psi': 0.40160148706791454}
[S4] START round=4 head_norm_before_train=0.886538 cos_to_last_merge=1.0000 (last merge round=3)
[S4] round=4 local utility u=0.310227 metrics={'f1_val': 0.2391216716563053, 'auprc': 0.7951369852977218, 'loss_val': 1.0925959399040068, 'psi': 0.46152779711287195}-{'f1_val': 0.14497098646034817, 'auprc': 0.7981000616200441, 'loss_val': 1.1570346635240796, 'psi': 0.40622261652422653}
[S5] START round=4 head_norm_before_train=1.011719 cos_to_last_merge=0.9852 (last merge round=1)
[S5] round=4 local utility u=0.090063 metrics={'f1_val': 0.4183961199382637, 'auprc': 0.7778210664253794, 'loss_val': 0.9489285679031988, 'psi': 0.5621660985331101}-{'f1_val': 0.41654174186412063, 'auprc': 0.7775931913919938, 'loss_val': 1.1172449181227964, 'psi': 0.5609623216752699}
[S6] START round=4 head_norm_before_train=1.187046 (no previous merge yet)
[S6] round=4 local utility u=0.020724 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8090787475622047, 'loss_val': 1.1868795736273843, 'psi': 0.40848726825565107}-{'f1_val': 0.14142628205128205, 'auprc': 0.8104230636143162, 'loss_val': 1.2323595680150472, 'psi': 0.40902499467649567}
[S7] START round=4 head_norm_before_train=1.312853 (no previous merge yet)
[S7] round=4 local utility u=0.848940 metrics={'f1_val': 0.4166714190153544, 'auprc': 0.5755567114878727, 'loss_val': 1.0887584782864153, 'psi': 0.4802255360043617}-{'f1_val': 0.14205682272909165, 'auprc': 0.5886066812173849, 'loss_val': 1.1781016312266657, 'psi': 0.320676766124409}
[S8] START round=4 head_norm_before_train=1.241436 (no previous merge yet)
[S8] round=4 local utility u=0.040523 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7746423271907461, 'loss_val': 1.1740530942915397, 'psi': 0.3938305203120728}-{'f1_val': 0.13995598239295717, 'auprc': 0.7708894841901998, 'loss_val': 1.2438408784337784, 'psi': 0.3923293831118542}
[S9] START round=4 head_norm_before_train=1.348482 (no previous merge yet)
[S9] round=4 local utility u=0.249507 metrics={'f1_val': 0.701513881536201, 'auprc': 0.999582799621406, 'loss_val': 0.46590704737260424, 'psi': 0.820741448770283}-{'f1_val': 0.7002642836972446, 'auprc': 0.9376562897321579, 'loss_val': 0.7716432378839614, 'psi': 0.7952210861112099}
[S10] START round=4 head_norm_before_train=1.216302 (no previous merge yet)
[S10] round=4 local utility u=0.014975 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6811050607620864, 'loss_val': 1.2219452383636358, 'psi': 0.35561500682986896}-{'f1_val': 0.13862163754172394, 'auprc': 0.6851779559097897, 'loss_val': 1.2641139376123163, 'psi': 0.3572441648889502}
[S11] START round=4 head_norm_before_train=1.262117 (no previous merge yet)
[S11] round=4 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.774546871603585, 'loss_val': 1.196678782623096, 'psi': 0.3940669586653004}-{'f1_val': 0.14041368337311058, 'auprc': 0.8194041736589075, 'loss_val': 1.244351699348259, 'psi': 0.41200987948742934}
[S13] START round=4 head_norm_before_train=0.941150 cos_to_last_merge=1.0000 (last merge round=3)
[S13] round=4 local utility u=0.285116 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7110308853169203, 'loss_val': 1.260871039013528, 'psi': 0.368643811673}-{'f1_val': 0.1403857625770531, 'auprc': 0.5209326761412636, 'loss_val': 1.2608078735722061, 'psi': 0.2926045280027373}
[S14] START round=4 head_norm_before_train=0.765153 cos_to_last_merge=1.0000 (last merge round=3)
[S14] round=4 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7820668543807823, 'loss_val': 1.319021746549417, 'psi': 0.3970414534819352}-{'f1_val': 0.14035785288270378, 'auprc': 0.7848992779999737, 'loss_val': 1.3105326015556216, 'psi': 0.39817442292961175}
[S15] START round=4 head_norm_before_train=0.892068 cos_to_last_merge=0.9915 (last merge round=1)
[S15] round=4 local utility u=0.025833 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7802999712630577, 'loss_val': 1.2666349580878946, 'psi': 0.3959601793221581}-{'f1_val': 0.13973365136155833, 'auprc': 0.7734472836073535, 'loss_val': 1.2977425395100808, 'psi': 0.39321910425987644}
[S16] START round=4 head_norm_before_train=0.794626 cos_to_last_merge=1.0000 (last merge round=3)
[S16] round=4 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8363203351573636, 'loss_val': 1.2270082879242672, 'psi': 0.4189106041824674}-{'f1_val': 0.14063745019920318, 'auprc': 0.8355909908410635, 'loss_val': 1.221172381108433, 'psi': 0.41861886645594737}
[S17] START round=4 head_norm_before_train=1.195274 (no previous merge yet)
[S17] round=4 local utility u=0.022769 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.588167064196861, 'loss_val': 1.1823648082458023, 'psi': 0.3198362036691751}-{'f1_val': 0.14094896331738438, 'auprc': 0.5939694755301494, 'loss_val': 1.2453098173117607, 'psi': 0.3221571682024904}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S13] → sending delta(kind=head bytes=1786) to S16@127.0.0.1:37116
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:37104
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] → sending delta(kind=head bytes=1793) to S8@127.0.0.1:37109
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S7] → sending delta(kind=head bytes=1793) to S10@127.0.0.1:37111
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] → sending delta(kind=head bytes=1792) to S16@127.0.0.1:37116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S4] → sending delta(kind=head bytes=1792) to S9@127.0.0.1:37110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:37110
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:37112
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:37117
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S10] → sending delta(kind=head bytes=1791) to S14@127.0.0.1:37114
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S13@127.0.0.1:37113
[S9] sending update (kind=head size=1804 to 1 peers)
[S10] sending update (kind=head size=1791 to 1 peers)
[S15] sending update (kind=head size=1792 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1792 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1793 to 1 peers)
[S2] sending update (kind=head size=1793 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1786 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1792) from S15
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.924092)
[S16] loaded HEAD from S15 (vec_in norm=0.924092)
[S16] cosine check vs S15: cos=0.5557
[S16] BUFFERED delta from S15 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1792) from S4
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.936235)
[S9] loaded HEAD from S4 (vec_in norm=0.936235)
[S9] cosine check vs S4: cos=-0.0474
[S9] DROPPED delta from S4 (cos=-0.0474 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1801) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.276624)
[S17] loaded HEAD from S8 (vec_in norm=1.276624)
[S17] cosine check vs S8: cos=-0.0016
[S17] DROPPED delta from S8 (cos=-0.0016 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1786) from S13
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=0.967264)
[S16] loaded HEAD from S13 (vec_in norm=0.967264)
[S16] cosine check vs S13: cos=0.0481
[S16] BUFFERED delta from S13 (total buffered=2)
[S4] RECEIVED delta(kind=head bytes=1799) from S3
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.412519)
[S4] loaded HEAD from S3 (vec_in norm=1.412519)
[S4] cosine check vs S3: cos=0.3875
[S4] BUFFERED delta from S3 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1791) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.239473)
[S14] loaded HEAD from S10 (vec_in norm=1.239473)
[S14] cosine check vs S10: cos=0.7754
[S14] BUFFERED delta from S10 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1798) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.217864)
[S11] loaded HEAD from S6 (vec_in norm=1.217864)
[S11] cosine check vs S6: cos=-0.0273
[S11] DROPPED delta from S6 (cos=-0.0273 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1804) from S9
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.448460)
[S13] loaded HEAD from S9 (vec_in norm=1.448460)
[S13] cosine check vs S9: cos=0.7404
[S13] BUFFERED delta from S9 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1793) from S2
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.290895)
[S8] loaded HEAD from S2 (vec_in norm=1.290895)
[S8] cosine check vs S2: cos=-0.0225
[S8] DROPPED delta from S2 (cos=-0.0225 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1793) from S7
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.335507)
[S10] loaded HEAD from S7 (vec_in norm=1.335507)
[S10] cosine check vs S7: cos=0.0353
[S10] BUFFERED delta from S7 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1795) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.057230)
[S9] loaded HEAD from S5 (vec_in norm=1.057230)
[S9] cosine check vs S5: cos=-0.0962
[S9] DROPPED delta from S5 (cos=-0.0962 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:37110
[S17] sending update (kind=head size=1802 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1802) from S17
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.223865)
[S9] loaded HEAD from S17 (vec_in norm=1.223865)
[S9] cosine check vs S17: cos=-0.1145
[S9] DROPPED delta from S17 (cos=-0.1145 < 0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=4 metric=0.1404 head_norm=0.786034
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.010049e-01
[S14] stored merged vector for next round verification (round=4)
[S14] DEBUG after merge:  round=4 metric=0.1270 head_norm=0.957218 delta_norm=0.401005
[S14] aggregate: ROLLBACK (f1_val pre=0.140 post=0.127 tol_abs=0.005 tol_rel=0.0)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=4 metric=0.1404 head_norm=0.967264
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.896116e-01
[S13] stored merged vector for next round verification (round=4)
[S13] DEBUG after merge:  round=4 metric=0.1404 head_norm=1.130088 delta_norm=0.489612
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=4 metric=0.1386 head_norm=1.239473
[S10] _apply_head_vector_avg (torch): Δ‖w‖=8.948253e-01
[S10] stored merged vector for next round verification (round=4)
[S10] DEBUG after merge:  round=4 metric=0.1386 head_norm=0.926943 delta_norm=0.894825
[S10] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=4 metric=0.2391 head_norm=0.936235
[S4] _apply_head_vector_avg (torch): Δ‖w‖=6.795017e-01
[S4] stored merged vector for next round verification (round=4)
[S4] DEBUG after merge:  round=4 metric=0.2132 head_norm=0.986991 delta_norm=0.679502
[S4] aggregate: ROLLBACK (f1_val pre=0.239 post=0.213 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=4 metric=0.1406 head_norm=0.830748
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.146654e-01
[S16] stored merged vector for next round verification (round=4)
[S16] DEBUG after merge:  round=4 metric=0.1406 head_norm=0.636067 delta_norm=0.414665
[S16] aggregate: ACCEPT kept=['S15', 'S13'] (k=2/2) mode=median trim_p=0.1
[S2] START round=5 head_norm_before_train=1.290895 (no previous merge yet)
[S2] round=5 local utility u=1.000000 metrics={'f1_val': 0.4160938496492347, 'auprc': 0.7633172121158242, 'loss_val': 1.0366240143304148, 'psi': 0.5549831946358705}-{'f1_val': 0.1417771333885667, 'auprc': 0.6114244729778173, 'loss_val': 1.1380739025547266, 'psi': 0.32963606922426697}
[S3] START round=5 head_norm_before_train=1.412519 (no previous merge yet)
[S3] round=5 local utility u=0.000000 metrics={'f1_val': 0.5427270423733531, 'auprc': 0.9974638941945628, 'loss_val': 0.6510326467913237, 'psi': 0.7246217831018371}-{'f1_val': 0.6977762917607885, 'auprc': 0.796188257485681, 'loss_val': 0.8591900729929128, 'psi': 0.7371410780507455}
[S4] START round=5 head_norm_before_train=0.986991 cos_to_last_merge=1.0000 (last merge round=4)
[S4] round=5 local utility u=0.562965 metrics={'f1_val': 0.415625539257981, 'auprc': 0.7941611557624133, 'loss_val': 1.0227608863954174, 'psi': 0.567039785859754}-{'f1_val': 0.2391216716563053, 'auprc': 0.7951369852977218, 'loss_val': 1.0925959399040068, 'psi': 0.46152779711287195}
[S5] START round=5 head_norm_before_train=1.057230 cos_to_last_merge=0.9686 (last merge round=1)
[S5] round=5 local utility u=1.000000 metrics={'f1_val': 0.7148253623901194, 'auprc': 0.7947095766977147, 'loss_val': 0.7615819939432407, 'psi': 0.7467790481131575}-{'f1_val': 0.4183961199382637, 'auprc': 0.7778210664253794, 'loss_val': 0.9489285679031988, 'psi': 0.5621660985331101}
[S6] START round=5 head_norm_before_train=1.217864 (no previous merge yet)
[S6] round=5 local utility u=0.677168 metrics={'f1_val': 0.3534173273129556, 'auprc': 0.8089407686570309, 'loss_val': 1.10407525959675, 'psi': 0.5356267038505858}-{'f1_val': 0.14142628205128205, 'auprc': 0.8090787475622047, 'loss_val': 1.1868795736273843, 'psi': 0.40848726825565107}
[S7] START round=5 head_norm_before_train=1.335507 (no previous merge yet)
[S7] round=5 local utility u=0.101224 metrics={'f1_val': 0.41711588266717814, 'auprc': 0.5923928766844637, 'loss_val': 0.9394864418667715, 'psi': 0.4872266802740923}-{'f1_val': 0.4166714190153544, 'auprc': 0.5755567114878727, 'loss_val': 1.0887584782864153, 'psi': 0.4802255360043617}
[S8] START round=5 head_norm_before_train=1.276624 (no previous merge yet)
[S8] round=5 local utility u=0.890361 metrics={'f1_val': 0.4162799983110498, 'auprc': 0.7846879221007218, 'loss_val': 1.0814122728525448, 'psi': 0.5636431678269186}-{'f1_val': 0.13995598239295717, 'auprc': 0.7746423271907461, 'loss_val': 1.1740530942915397, 'psi': 0.3938305203120728}
[S9] START round=5 head_norm_before_train=1.448460 (no previous merge yet)
[S9] round=5 local utility u=0.077770 metrics={'f1_val': 0.7015406642019387, 'auprc': 0.9994051604631529, 'loss_val': 0.30999476933984244, 'psi': 0.8206864627064243}-{'f1_val': 0.701513881536201, 'auprc': 0.999582799621406, 'loss_val': 0.46590704737260424, 'psi': 0.820741448770283}
[S10] START round=5 head_norm_before_train=0.926943 cos_to_last_merge=1.0000 (last merge round=4)
[S10] round=5 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6237998863943783, 'loss_val': 1.248767344085303, 'psi': 0.3326929370827857}-{'f1_val': 0.13862163754172394, 'auprc': 0.6811050607620864, 'loss_val': 1.2219452383636358, 'psi': 0.35561500682986896}
[S11] START round=5 head_norm_before_train=1.293600 (no previous merge yet)
[S11] round=5 local utility u=0.041384 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7768816305140529, 'loss_val': 1.1209143778266004, 'psi': 0.39500086222948755}-{'f1_val': 0.14041368337311058, 'auprc': 0.774546871603585, 'loss_val': 1.196678782623096, 'psi': 0.3940669586653004}
[S13] START round=5 head_norm_before_train=1.130088 cos_to_last_merge=1.0000 (last merge round=4)
[S13] round=5 local utility u=0.011490 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.714399751195274, 'loss_val': 1.2479980018938437, 'psi': 0.36999135802434147}-{'f1_val': 0.1403857625770531, 'auprc': 0.7110308853169203, 'loss_val': 1.260871039013528, 'psi': 0.368643811673}
[S14] START round=5 head_norm_before_train=0.957218 cos_to_last_merge=1.0000 (last merge round=4)
[S14] round=5 local utility u=0.010191 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7845556696145929, 'loss_val': 1.3061058467217848, 'psi': 0.3980369795754594}-{'f1_val': 0.14035785288270378, 'auprc': 0.7820668543807823, 'loss_val': 1.319021746549417, 'psi': 0.3970414534819352}
[S15] START round=5 head_norm_before_train=0.924092 cos_to_last_merge=0.9820 (last merge round=1)
[S15] round=5 local utility u=0.014686 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7768560967906314, 'loss_val': 1.2269309887624715, 'psi': 0.39458262953318757}-{'f1_val': 0.13973365136155833, 'auprc': 0.7802999712630577, 'loss_val': 1.2666349580878946, 'psi': 0.3959601793221581}
[S16] START round=5 head_norm_before_train=0.636067 cos_to_last_merge=1.0000 (last merge round=4)
[S16] round=5 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8011476031046973, 'loss_val': 1.219931087940775, 'psi': 0.4048415113614009}-{'f1_val': 0.14063745019920318, 'auprc': 0.8363203351573636, 'loss_val': 1.2270082879242672, 'psi': 0.4189106041824674}
[S17] START round=5 head_norm_before_train=1.223865 (no previous merge yet)
[S17] round=5 local utility u=0.506791 metrics={'f1_val': 0.27269517341098093, 'auprc': 0.6283114228568013, 'loss_val': 1.0796924305246125, 'psi': 0.4149416731893091}-{'f1_val': 0.14094896331738438, 'auprc': 0.588167064196861, 'loss_val': 1.1823648082458023, 'psi': 0.3198362036691751}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] → sending delta(kind=head bytes=1794) to S16@127.0.0.1:37116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:37112
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:37110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:37104
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:37117
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:37110
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S13] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:37116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:37114
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:37113
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:37111
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S2] → sending delta(kind=head bytes=1792) to S8@127.0.0.1:37109
[S7] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1795 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1793 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S2] sending update (kind=head size=1792 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1794 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1796) from S11
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.321925)
[S14] loaded HEAD from S11 (vec_in norm=1.321925)
[S14] cosine check vs S11: cos=0.0001
[S14] BUFFERED delta from S11 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1795) from S14
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.972848)
[S4] loaded HEAD from S14 (vec_in norm=0.972848)
[S4] cosine check vs S14: cos=0.1653
[S4] BUFFERED delta from S14 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1799) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.110238)
[S9] loaded HEAD from S5 (vec_in norm=1.110238)
[S9] cosine check vs S5: cos=-0.0973
[S9] DROPPED delta from S5 (cos=-0.0973 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1796) from S4
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.018944)
[S9] loaded HEAD from S4 (vec_in norm=1.018944)
[S9] cosine check vs S4: cos=-0.0624
[S9] DROPPED delta from S4 (cos=-0.0624 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1793) from S13
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.145702)
[S16] loaded HEAD from S13 (vec_in norm=1.145702)
[S16] cosine check vs S13: cos=0.3609
[S16] BUFFERED delta from S13 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1794) from S15
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.958984)
[S16] loaded HEAD from S15 (vec_in norm=0.958984)
[S16] cosine check vs S15: cos=0.7110
[S16] BUFFERED delta from S15 (total buffered=2)
[S13] RECEIVED delta(kind=head bytes=1801) from S9
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.535946)
[S13] loaded HEAD from S9 (vec_in norm=1.535946)
[S13] cosine check vs S9: cos=0.9454
[S13] BUFFERED delta from S9 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1798) from S7
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.381385)
[S10] loaded HEAD from S7 (vec_in norm=1.381385)
[S10] cosine check vs S7: cos=0.7244
[S10] BUFFERED delta from S7 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1802) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.247849)
[S11] loaded HEAD from S6 (vec_in norm=1.247849)
[S11] cosine check vs S6: cos=-0.0272
[S11] DROPPED delta from S6 (cos=-0.0272 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1792) from S2
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.315973)
[S8] loaded HEAD from S2 (vec_in norm=1.315973)
[S8] cosine check vs S2: cos=-0.0201
[S8] DROPPED delta from S2 (cos=-0.0201 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1798) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.311108)
[S17] loaded HEAD from S8 (vec_in norm=1.311108)
[S17] cosine check vs S8: cos=-0.0027
[S17] DROPPED delta from S8 (cos=-0.0027 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:37110
[S17] sending update (kind=head size=1798 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1798) from S17
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.252938)
[S9] loaded HEAD from S17 (vec_in norm=1.252938)
[S9] cosine check vs S17: cos=-0.1151
[S9] DROPPED delta from S17 (cos=-0.1151 < 0.0)
[S3] ⇄ pheromone p=0.550 → S4@127.0.0.1:37104
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=5 metric=0.1386 head_norm=0.942781
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.770458e-01
[S10] stored merged vector for next round verification (round=5)
[S10] DEBUG after merge:  round=5 metric=0.1386 head_norm=1.082108 delta_norm=0.477046
[S10] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.401 → S14@127.0.0.1:37114
[S2] ⇄ pheromone p=0.539 → S8@127.0.0.1:37109
[S6] ⇄ pheromone p=0.504 → S11@127.0.0.1:37112
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=5 metric=0.4156 head_norm=1.018944
[S4] _apply_head_vector_avg (torch): Δ‖w‖=6.436290e-01
[S4] stored merged vector for next round verification (round=5)
[S4] DEBUG after merge:  round=5 metric=0.4156 head_norm=0.760317 delta_norm=0.643629
[S4] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.507 → S9@127.0.0.1:37110
[S9] ⇄ pheromone p=0.514 → S13@127.0.0.1:37113
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=5 metric=0.1404 head_norm=1.145702
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.934053e-01
[S13] stored merged vector for next round verification (round=5)
[S13] DEBUG after merge:  round=5 metric=0.1404 head_norm=1.322798 delta_norm=0.293405
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.381 → S16@127.0.0.1:37116
[S7] ⇄ pheromone p=0.520 → S10@127.0.0.1:37111
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=5 metric=0.1404 head_norm=0.972848
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.206013e-01
[S14] stored merged vector for next round verification (round=5)
[S14] DEBUG after merge:  round=5 metric=0.1038 head_norm=0.820715 delta_norm=0.820601
[S14] aggregate: ROLLBACK (f1_val pre=0.140 post=0.104 tol_abs=0.005 tol_rel=0.0)
[S14] ⇄ pheromone p=0.389 → S4@127.0.0.1:37104
[S5] ⇄ pheromone p=0.672 → S9@127.0.0.1:37110
[S8] ⇄ pheromone p=0.619 → S17@127.0.0.1:37117
[S15] ⇄ pheromone p=0.338 → S16@127.0.0.1:37116
[S11] ⇄ pheromone p=0.339 → S14@127.0.0.1:37114
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=5 metric=0.1406 head_norm=0.662362
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.594404e-01
[S16] stored merged vector for next round verification (round=5)
[S16] DEBUG after merge:  round=5 metric=0.1406 head_norm=0.655788 delta_norm=0.259440
[S16] aggregate: ACCEPT kept=['S13', 'S15'] (k=2/2) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.339 → S8@127.0.0.1:37109
[S17] ⇄ pheromone p=0.450 → S9@127.0.0.1:37110
[S2] START round=6 head_norm_before_train=1.315973 (no previous merge yet)
[S2] round=6 local utility u=0.078078 metrics={'f1_val': 0.417359413202934, 'auprc': 0.7713220581132061, 'loss_val': 0.9120761091262087, 'psi': 0.5589444711670428}-{'f1_val': 0.4160938496492347, 'auprc': 0.7633172121158242, 'loss_val': 1.0366240143304148, 'psi': 0.5549831946358705}
[S3] START round=6 head_norm_before_train=1.491798 (no previous merge yet)
[S3] round=6 local utility u=0.560549 metrics={'f1_val': 0.699834343606157, 'auprc': 0.9950853308750983, 'loss_val': 0.46544352591038185, 'psi': 0.8179347385137337}-{'f1_val': 0.5427270423733531, 'auprc': 0.9974638941945628, 'loss_val': 0.6510326467913237, 'psi': 0.7246217831018371}
[S4] START round=6 head_norm_before_train=0.760317 cos_to_last_merge=1.0000 (last merge round=5)
[S4] round=6 local utility u=0.019802 metrics={'f1_val': 0.4148434259400211, 'auprc': 0.7866773858032898, 'loss_val': 0.956013225320045, 'psi': 0.5635770098853287}-{'f1_val': 0.415625539257981, 'auprc': 0.7941611557624133, 'loss_val': 1.0227608863954174, 'psi': 0.567039785859754}
[S5] START round=6 head_norm_before_train=1.110238 cos_to_last_merge=0.9478 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.948
[S5] round=6 local utility u=0.045573 metrics={'f1_val': 0.7039827686417534, 'auprc': 0.793148311821517, 'loss_val': 0.6006960917267815, 'psi': 0.7396489859136588}-{'f1_val': 0.7148253623901194, 'auprc': 0.7947095766977147, 'loss_val': 0.7615819939432407, 'psi': 0.7467790481131575}
[S6] START round=6 head_norm_before_train=1.247849 (no previous merge yet)
[S6] round=6 local utility u=0.395660 metrics={'f1_val': 0.4168551858772006, 'auprc': 0.8979558882104755, 'loss_val': 0.960427447300455, 'psi': 0.6092954668105106}-{'f1_val': 0.3534173273129556, 'auprc': 0.8089407686570309, 'loss_val': 1.10407525959675, 'psi': 0.5356267038505858}
[S7] START round=6 head_norm_before_train=1.381385 (no previous merge yet)
[S7] round=6 local utility u=0.367323 metrics={'f1_val': 0.4169130971024577, 'auprc': 0.7909549478681941, 'loss_val': 0.7993101341519641, 'psi': 0.5665298374087523}-{'f1_val': 0.41711588266717814, 'auprc': 0.5923928766844637, 'loss_val': 0.9394864418667715, 'psi': 0.4872266802740923}
[S8] START round=6 head_norm_before_train=1.311108 (no previous merge yet)
[S8] round=6 local utility u=0.000000 metrics={'f1_val': 0.37307134877987713, 'auprc': 0.7948843807995922, 'loss_val': 0.9640992728965746, 'psi': 0.5417965615877631}-{'f1_val': 0.4162799983110498, 'auprc': 0.7846879221007218, 'loss_val': 1.0814122728525448, 'psi': 0.5636431678269186}
[S9] START round=6 head_norm_before_train=1.535946 (no previous merge yet)
[S9] round=6 local utility u=0.034713 metrics={'f1_val': 0.7014667606303384, 'auprc': 0.9984326172753695, 'loss_val': 0.23720767826355135, 'psi': 0.8202531032883509}-{'f1_val': 0.7015406642019387, 'auprc': 0.9994051604631529, 'loss_val': 0.30999476933984244, 'psi': 0.8206864627064243}
[S10] START round=6 head_norm_before_train=1.082108 cos_to_last_merge=1.0000 (last merge round=5)
[S10] round=6 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.5933744478739318, 'loss_val': 1.251537306984267, 'psi': 0.3205227616746071}-{'f1_val': 0.13862163754172394, 'auprc': 0.6237998863943783, 'loss_val': 1.248767344085303, 'psi': 0.3326929370827857}
[S11] START round=6 head_norm_before_train=1.321925 (no previous merge yet)
[S11] round=6 local utility u=1.000000 metrics={'f1_val': 0.4229120744550575, 'auprc': 0.8856192588477265, 'loss_val': 1.0081612339172499, 'psi': 0.6079949482121252}-{'f1_val': 0.14041368337311058, 'auprc': 0.7768816305140529, 'loss_val': 1.1209143778266004, 'psi': 0.39500086222948755}
[S13] START round=6 head_norm_before_train=1.322798 cos_to_last_merge=1.0000 (last merge round=5)
[S13] round=6 local utility u=0.026933 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7177185878703036, 'loss_val': 1.204089149526896, 'psi': 0.3713188926943533}-{'f1_val': 0.1403857625770531, 'auprc': 0.714399751195274, 'loss_val': 1.2479980018938437, 'psi': 0.36999135802434147}
[S14] START round=6 head_norm_before_train=0.820715 cos_to_last_merge=1.0000 (last merge round=5)
[S14] round=6 local utility u=0.010125 metrics={'f1_val': 0.15384615384615385, 'auprc': 0.7563080999891107, 'loss_val': 1.2820436337653318, 'psi': 0.39483093230333666}-{'f1_val': 0.14035785288270378, 'auprc': 0.7845556696145929, 'loss_val': 1.3061058467217848, 'psi': 0.3980369795754594}
[S15] START round=6 head_norm_before_train=0.958984 cos_to_last_merge=0.9714 (last merge round=1)
[S15] round=6 local utility u=0.032583 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7770126628019495, 'loss_val': 1.1622346439376974, 'psi': 0.3946452559377148}-{'f1_val': 0.13973365136155833, 'auprc': 0.7768560967906314, 'loss_val': 1.2269309887624715, 'psi': 0.39458262953318757}
[S16] START round=6 head_norm_before_train=0.655788 cos_to_last_merge=1.0000 (last merge round=5)
[S16] round=6 local utility u=0.005468 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7910363536485778, 'loss_val': 1.1786619818115882, 'psi': 0.4007970115789531}-{'f1_val': 0.14063745019920318, 'auprc': 0.8011476031046973, 'loss_val': 1.219931087940775, 'psi': 0.4048415113614009}
[S17] START round=6 head_norm_before_train=1.252938 (no previous merge yet)
[S17] round=6 local utility u=0.508362 metrics={'f1_val': 0.39202413421260673, 'auprc': 0.6828975165241358, 'loss_val': 0.9427013736241894, 'psi': 0.5083734871372183}-{'f1_val': 0.27269517341098093, 'auprc': 0.6283114228568013, 'loss_val': 1.0796924305246125, 'psi': 0.4149416731893091}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:37109
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:37110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:37111
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:37114
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:37112
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:37116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] → sending delta(kind=head bytes=1793) to S8@127.0.0.1:37109
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:37110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:37113
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:37104
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:37116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:37104
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1793 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1800) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.287211)
[S11] loaded HEAD from S6 (vec_in norm=1.287211)
[S11] cosine check vs S6: cos=-0.0301
[S11] DROPPED delta from S6 (cos=-0.0301 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1793) from S2
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.345884)
[S8] loaded HEAD from S2 (vec_in norm=1.345884)
[S8] cosine check vs S2: cos=-0.0182
[S8] DROPPED delta from S2 (cos=-0.0182 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1796) from S16
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.678242)
[S8] loaded HEAD from S16 (vec_in norm=0.678242)
[S8] cosine check vs S16: cos=-0.0454
[S8] DROPPED delta from S16 (cos=-0.0454 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1801) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.169071)
[S9] loaded HEAD from S5 (vec_in norm=1.169071)
[S9] cosine check vs S5: cos=-0.0944
[S9] DROPPED delta from S5 (cos=-0.0944 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1799) from S7
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.432154)
[S10] loaded HEAD from S7 (vec_in norm=1.432154)
[S10] cosine check vs S7: cos=0.9352
[S10] BUFFERED delta from S7 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1798) from S4
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.797394)
[S9] loaded HEAD from S4 (vec_in norm=0.797394)
[S9] cosine check vs S4: cos=-0.0708
[S9] DROPPED delta from S4 (cos=-0.0708 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1798) from S13
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.335597)
[S16] loaded HEAD from S13 (vec_in norm=1.335597)
[S16] cosine check vs S13: cos=0.5691
[S16] BUFFERED delta from S13 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1797) from S15
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.995613)
[S16] loaded HEAD from S15 (vec_in norm=0.995613)
[S16] cosine check vs S15: cos=0.7004
[S16] BUFFERED delta from S15 (total buffered=2)
[S14] RECEIVED delta(kind=head bytes=1798) from S11
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.350319)
[S14] loaded HEAD from S11 (vec_in norm=1.350319)
[S14] cosine check vs S11: cos=0.7851
[S14] BUFFERED delta from S11 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1803) from S3
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.577982)
[S4] loaded HEAD from S3 (vec_in norm=1.577982)
[S4] cosine check vs S3: cos=0.5831
[S4] BUFFERED delta from S3 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1800) from S14
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.840385)
[S4] loaded HEAD from S14 (vec_in norm=0.840385)
[S4] cosine check vs S14: cos=0.3850
[S4] BUFFERED delta from S14 (total buffered=2)
[S13] RECEIVED delta(kind=head bytes=1800) from S9
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.608177)
[S13] loaded HEAD from S9 (vec_in norm=1.608177)
[S13] cosine check vs S9: cos=0.9811
[S13] BUFFERED delta from S9 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:37110
[S17] sending update (kind=head size=1804 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1804) from S17
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.290559)
[S9] loaded HEAD from S17 (vec_in norm=1.290559)
[S9] cosine check vs S17: cos=-0.1136
[S9] DROPPED delta from S17 (cos=-0.1136 < 0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=6 metric=0.1386 head_norm=1.093303
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.818842e-01
[S10] stored merged vector for next round verification (round=6)
[S10] DEBUG after merge:  round=6 metric=0.1386 head_norm=1.242469 delta_norm=0.281884
[S10] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=6 metric=0.1404 head_norm=1.335597
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.972202e-01
[S13] stored merged vector for next round verification (round=6)
[S13] DEBUG after merge:  round=6 metric=0.1404 head_norm=1.464968 delta_norm=0.197220
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=6 metric=0.1538 head_norm=0.840385
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.323432e-01
[S14] stored merged vector for next round verification (round=6)
[S14] DEBUG after merge:  round=6 metric=0.3335 head_norm=1.038212 delta_norm=0.432343
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=6 metric=0.4148 head_norm=0.797394
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.095937e-01
[S4] stored merged vector for next round verification (round=6)
[S4] DEBUG after merge:  round=6 metric=0.4147 head_norm=0.769234 delta_norm=0.309594
[S4] aggregate: ACCEPT kept=['S3', 'S14'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=6 metric=0.1406 head_norm=0.678242
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.942138e-01
[S16] stored merged vector for next round verification (round=6)
[S16] DEBUG after merge:  round=6 metric=0.1406 head_norm=0.729349 delta_norm=0.194214
[S16] aggregate: ACCEPT kept=['S13', 'S15'] (k=2/2) mode=median trim_p=0.1
[S2] START round=7 head_norm_before_train=1.345884 (no previous merge yet)
[S2] round=7 local utility u=0.641303 metrics={'f1_val': 0.6049618945686995, 'auprc': 0.7790366039410431, 'loss_val': 0.7782283110554916, 'psi': 0.674591778317637}-{'f1_val': 0.417359413202934, 'auprc': 0.7713220581132061, 'loss_val': 0.9120761091262087, 'psi': 0.5589444711670428}
[S3] START round=7 head_norm_before_train=1.577982 (no previous merge yet)
[S3] round=7 local utility u=0.081562 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9980913064663484, 'loss_val': 0.3164161855697175, 'psi': 0.8196450983857402}-{'f1_val': 0.699834343606157, 'auprc': 0.9950853308750983, 'loss_val': 0.46544352591038185, 'psi': 0.8179347385137337}
[S4] START round=7 head_norm_before_train=0.769234 cos_to_last_merge=1.0000 (last merge round=6)
[S4] round=7 local utility u=0.035742 metrics={'f1_val': 0.4188039747317045, 'auprc': 0.7862717375496658, 'loss_val': 0.9070753697900834, 'psi': 0.565791079858889}-{'f1_val': 0.4148434259400211, 'auprc': 0.7866773858032898, 'loss_val': 0.956013225320045, 'psi': 0.5635770098853287}
[S5] START round=7 head_norm_before_train=1.169071 cos_to_last_merge=0.9264 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.926
[S5] round=7 local utility u=0.001621 metrics={'f1_val': 0.7005685100046517, 'auprc': 0.7663599923294827, 'loss_val': 0.4966038354649016, 'psi': 0.7268851029345842}-{'f1_val': 0.7039827686417534, 'auprc': 0.793148311821517, 'loss_val': 0.6006960917267815, 'psi': 0.7396489859136588}
[S6] START round=7 head_norm_before_train=1.287211 (no previous merge yet)
[S6] round=7 local utility u=0.181138 metrics={'f1_val': 0.41709547116373813, 'auprc': 0.9552174319532726, 'loss_val': 0.7713783451222312, 'psi': 0.632344255479552}-{'f1_val': 0.4168551858772006, 'auprc': 0.8979558882104755, 'loss_val': 0.960427447300455, 'psi': 0.6092954668105106}
[S7] START round=7 head_norm_before_train=1.432154 (no previous merge yet)
[S7] round=7 local utility u=0.806250 metrics={'f1_val': 0.6796878507497937, 'auprc': 0.7879238934689204, 'loss_val': 0.7543654656154829, 'psi': 0.7229822678374443}-{'f1_val': 0.4169130971024577, 'auprc': 0.7909549478681941, 'loss_val': 0.7993101341519641, 'psi': 0.5665298374087523}
[S8] START round=7 head_norm_before_train=1.339225 (no previous merge yet)
[S8] round=7 local utility u=0.076090 metrics={'f1_val': 0.37306606018310795, 'auprc': 0.7967438689913134, 'loss_val': 0.8174651407082485, 'psi': 0.5425371837063901}-{'f1_val': 0.37307134877987713, 'auprc': 0.7948843807995922, 'loss_val': 0.9640992728965746, 'psi': 0.5417965615877631}
[S9] START round=7 head_norm_before_train=1.608177 (no previous merge yet)
[S9] round=7 local utility u=0.000000 metrics={'f1_val': 0.5816602122899509, 'auprc': 0.8824262714708007, 'loss_val': 0.38364217586588495, 'psi': 0.7019666359622908}-{'f1_val': 0.7014667606303384, 'auprc': 0.9984326172753695, 'loss_val': 0.23720767826355135, 'psi': 0.8202531032883509}
[S10] START round=7 head_norm_before_train=1.242469 cos_to_last_merge=1.0000 (last merge round=6)
[S10] round=7 local utility u=0.022853 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.5963897449740386, 'loss_val': 1.2148779714116416, 'psi': 0.3217288805146498}-{'f1_val': 0.13862163754172394, 'auprc': 0.5933744478739318, 'loss_val': 1.251537306984267, 'psi': 0.3205227616746071}
[S11] START round=7 head_norm_before_train=1.350319 (no previous merge yet)
[S11] round=7 local utility u=0.122508 metrics={'f1_val': 0.4151419553975044, 'auprc': 0.9228411189465235, 'loss_val': 0.8281904152049773, 'psi': 0.6182216208171121}-{'f1_val': 0.4229120744550575, 'auprc': 0.8856192588477265, 'loss_val': 1.0081612339172499, 'psi': 0.6079949482121252}
[S13] START round=7 head_norm_before_train=1.464968 cos_to_last_merge=1.0000 (last merge round=6)
[S13] round=7 local utility u=0.516736 metrics={'f1_val': 0.36815178815714245, 'auprc': 0.5822183796494723, 'loss_val': 1.130712686565775, 'psi': 0.45377842475407437}-{'f1_val': 0.1403857625770531, 'auprc': 0.7177185878703036, 'loss_val': 1.204089149526896, 'psi': 0.3713188926943533}
[S14] START round=7 head_norm_before_train=1.038212 cos_to_last_merge=1.0000 (last merge round=6)
[S14] round=7 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7452380486798589, 'loss_val': 1.2526966971034403, 'psi': 0.3823099312015658}-{'f1_val': 0.15384615384615385, 'auprc': 0.7563080999891107, 'loss_val': 1.2820436337653318, 'psi': 0.39483093230333666}
[S15] START round=7 head_norm_before_train=0.995613 cos_to_last_merge=0.9602 (last merge round=1)
[S15] round=7 local utility u=0.911414 metrics={'f1_val': 0.416839147538149, 'auprc': 0.7924871624690851, 'loss_val': 1.0484632610501707, 'psi': 0.5670983535105234}-{'f1_val': 0.13973365136155833, 'auprc': 0.7770126628019495, 'loss_val': 1.1622346439376974, 'psi': 0.3946452559377148}
[S16] START round=7 head_norm_before_train=0.729349 cos_to_last_merge=1.0000 (last merge round=6)
[S16] round=7 local utility u=0.546122 metrics={'f1_val': 0.4150731431819776, 'auprc': 0.582562827290953, 'loss_val': 1.1076108349047347, 'psi': 0.48206901682556774}-{'f1_val': 0.14063745019920318, 'auprc': 0.7910363536485778, 'loss_val': 1.1786619818115882, 'psi': 0.4007970115789531}
[S17] START round=7 head_norm_before_train=1.290559 (no previous merge yet)
[S17] round=7 local utility u=0.000000 metrics={'f1_val': 0.35328079891142916, 'auprc': 0.6947346812459804, 'loss_val': 0.907166932738527, 'psi': 0.4898623518452496}-{'f1_val': 0.39202413421260673, 'auprc': 0.6828975165241358, 'loss_val': 0.9427013736241894, 'psi': 0.5083734871372183}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S11@127.0.0.1:37112
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:37110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:37114
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:37117
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:37116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:37110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S7] → sending delta(kind=head bytes=1791) to S10@127.0.0.1:37111
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S10] → sending delta(kind=head bytes=1790) to S14@127.0.0.1:37114
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:37109
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:37116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:37109
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:37104
[S2] sending update (kind=head size=1794 to 1 peers)
[S16] sending update (kind=head size=1794 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1791 to 1 peers)
[S10] sending update (kind=head size=1790 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1795 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1800) from S11
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.390226)
[S14] loaded HEAD from S11 (vec_in norm=1.390226)
[S14] cosine check vs S11: cos=0.9524
[S14] BUFFERED delta from S11 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1803) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.324183)
[S11] loaded HEAD from S6 (vec_in norm=1.324183)
[S11] cosine check vs S6: cos=-0.0334
[S11] DROPPED delta from S6 (cos=-0.0334 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1794) from S16
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.753913)
[S8] loaded HEAD from S16 (vec_in norm=0.753913)
[S8] cosine check vs S16: cos=-0.0367
[S8] DROPPED delta from S16 (cos=-0.0367 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1791) from S7
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.470282)
[S10] loaded HEAD from S7 (vec_in norm=1.470282)
[S10] cosine check vs S7: cos=0.9729
[S10] BUFFERED delta from S7 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1794) from S2
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.383204)
[S8] loaded HEAD from S2 (vec_in norm=1.383204)
[S8] cosine check vs S2: cos=-0.0167
[S8] DROPPED delta from S2 (cos=-0.0167 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1801) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.378062)
[S17] loaded HEAD from S8 (vec_in norm=1.378062)
[S17] cosine check vs S8: cos=-0.0088
[S17] DROPPED delta from S8 (cos=-0.0088 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1803) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.240023)
[S9] loaded HEAD from S5 (vec_in norm=1.240023)
[S9] cosine check vs S5: cos=-0.0909
[S9] DROPPED delta from S5 (cos=-0.0909 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1795) from S4
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.803930)
[S9] loaded HEAD from S4 (vec_in norm=0.803930)
[S9] cosine check vs S4: cos=-0.0667
[S9] DROPPED delta from S4 (cos=-0.0667 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1799) from S15
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.036130)
[S16] loaded HEAD from S15 (vec_in norm=1.036130)
[S16] cosine check vs S15: cos=0.6421
[S16] BUFFERED delta from S15 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1801) from S13
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.476200)
[S16] loaded HEAD from S13 (vec_in norm=1.476200)
[S16] cosine check vs S13: cos=0.6825
[S16] BUFFERED delta from S13 (total buffered=2)
[S14] RECEIVED delta(kind=head bytes=1790) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.253396)
[S14] loaded HEAD from S10 (vec_in norm=1.253396)
[S14] cosine check vs S10: cos=-0.0439
[S14] DROPPED delta from S10 (cos=-0.0439 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1802) from S3
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.642418)
[S4] loaded HEAD from S3 (vec_in norm=1.642418)
[S4] cosine check vs S3: cos=0.7636
[S4] BUFFERED delta from S3 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=7 metric=0.1404 head_norm=1.049989
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.524121e-01
[S14] stored merged vector for next round verification (round=7)
[S14] DEBUG after merge:  round=7 metric=0.5456 head_norm=1.205774 delta_norm=0.252412
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=7 metric=0.4188 head_norm=0.803930
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.760333e-01
[S4] stored merged vector for next round verification (round=7)
[S4] DEBUG after merge:  round=7 metric=0.6696 head_norm=1.157629 delta_norm=0.576033
[S4] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=7 metric=0.1386 head_norm=1.253396
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.915921e-01
[S10] stored merged vector for next round verification (round=7)
[S10] DEBUG after merge:  round=7 metric=0.1386 head_norm=1.352649 delta_norm=0.191592
[S10] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=7 metric=0.4151 head_norm=0.753913
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.552927e-01
[S16] stored merged vector for next round verification (round=7)
[S16] DEBUG after merge:  round=7 metric=0.4153 head_norm=0.809119 delta_norm=0.155293
[S16] aggregate: ACCEPT kept=['S15', 'S13'] (k=2/2) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=1.383204 (no previous merge yet)
[S2] round=8 local utility u=0.391887 metrics={'f1_val': 0.7124519638420558, 'auprc': 0.7800379616464901, 'loss_val': 0.6423983474308148, 'psi': 0.7394863629638295}-{'f1_val': 0.6049618945686995, 'auprc': 0.7790366039410431, 'loss_val': 0.7782283110554916, 'psi': 0.674591778317637}
[S3] START round=8 head_norm_before_train=1.642418 (no previous merge yet)
[S3] round=8 local utility u=0.018550 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9984541776927565, 'loss_val': 0.2804039806466026, 'psi': 0.8197902468763034}-{'f1_val': 0.7006809596653347, 'auprc': 0.9980913064663484, 'loss_val': 0.3164161855697175, 'psi': 0.8196450983857402}
[S4] START round=8 head_norm_before_train=1.157629 cos_to_last_merge=1.0000 (last merge round=7)
[S4] round=8 local utility u=1.000000 metrics={'f1_val': 0.6672277188707187, 'auprc': 0.9344521373012402, 'loss_val': 0.8208497155955855, 'psi': 0.7741174862429274}-{'f1_val': 0.4188039747317045, 'auprc': 0.7862717375496658, 'loss_val': 0.9070753697900834, 'psi': 0.565791079858889}
[S5] START round=8 head_norm_before_train=1.240023 cos_to_last_merge=0.9049 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.905
[S5] round=8 local utility u=0.372577 metrics={'f1_val': 0.7005708485915159, 'auprc': 0.9982987893922801, 'loss_val': 0.44728065825007146, 'psi': 0.8196620249118216}-{'f1_val': 0.7005685100046517, 'auprc': 0.7663599923294827, 'loss_val': 0.4966038354649016, 'psi': 0.7268851029345842}
[S6] START round=8 head_norm_before_train=1.324183 (no previous merge yet)
[S6] round=8 local utility u=0.710886 metrics={'f1_val': 0.6203403218268294, 'auprc': 0.9655011003716284, 'loss_val': 0.5999258364745581, 'psi': 0.758404633244749}-{'f1_val': 0.41709547116373813, 'auprc': 0.9552174319532726, 'loss_val': 0.7713783451222312, 'psi': 0.632344255479552}
[S7] START round=8 head_norm_before_train=1.470282 (no previous merge yet)
[S7] round=8 local utility u=0.176668 metrics={'f1_val': 0.6559570187209873, 'auprc': 0.920727829923379, 'loss_val': 0.6570569265153023, 'psi': 0.761865343201944}-{'f1_val': 0.6796878507497937, 'auprc': 0.7879238934689204, 'loss_val': 0.7543654656154829, 'psi': 0.7229822678374443}
[S8] START round=8 head_norm_before_train=1.378062 (no previous merge yet)
[S8] round=8 local utility u=0.326670 metrics={'f1_val': 0.37306606018310795, 'auprc': 0.9931424556410051, 'loss_val': 0.7533214948738209, 'psi': 0.6210966183662668}-{'f1_val': 0.37306606018310795, 'auprc': 0.7967438689913134, 'loss_val': 0.8174651407082485, 'psi': 0.5425371837063901}
[S9] START round=8 head_norm_before_train=1.656716 (no previous merge yet)
[S9] round=8 local utility u=1.000000 metrics={'f1_val': 0.9873949972964658, 'auprc': 0.9985951396063564, 'loss_val': 0.12721813607728788, 'psi': 0.991875054220422}-{'f1_val': 0.5816602122899509, 'auprc': 0.8824262714708007, 'loss_val': 0.38364217586588495, 'psi': 0.7019666359622908}
[S10] START round=8 head_norm_before_train=1.352649 cos_to_last_merge=1.0000 (last merge round=7)
[S10] round=8 local utility u=0.147330 metrics={'f1_val': 0.1536118363794604, 'auprc': 0.6391522064312414, 'loss_val': 1.1384473032390119, 'psi': 0.3478279844001728}-{'f1_val': 0.13862163754172394, 'auprc': 0.5963897449740386, 'loss_val': 1.2148779714116416, 'psi': 0.3217288805146498}
[S11] START round=8 head_norm_before_train=1.390226 (no previous merge yet)
[S11] round=8 local utility u=0.141144 metrics={'f1_val': 0.39992541946910537, 'auprc': 0.9989161735270533, 'loss_val': 0.6828289369884737, 'psi': 0.6395217210922846}-{'f1_val': 0.4151419553975044, 'auprc': 0.9228411189465235, 'loss_val': 0.8281904152049773, 'psi': 0.6182216208171121}
[S13] START round=8 head_norm_before_train=1.476200 cos_to_last_merge=0.9990 (last merge round=6)
[S13] round=8 local utility u=0.128586 metrics={'f1_val': 0.416200286011302, 'auprc': 0.5439188068136347, 'loss_val': 1.0469339089462069, 'psi': 0.46728769433223505}-{'f1_val': 0.36815178815714245, 'auprc': 0.5822183796494723, 'loss_val': 1.130712686565775, 'psi': 0.45377842475407437}
[S14] START round=8 head_norm_before_train=1.205774 cos_to_last_merge=1.0000 (last merge round=7)
[S14] round=8 local utility u=0.093118 metrics={'f1_val': 0.1539132330499237, 'auprc': 0.7604478377938756, 'loss_val': 1.1934228328609602, 'psi': 0.39652707494750444}-{'f1_val': 0.14035785288270378, 'auprc': 0.7452380486798589, 'loss_val': 1.2526966971034403, 'psi': 0.3823099312015658}
[S15] START round=8 head_norm_before_train=1.036130 cos_to_last_merge=0.9478 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.948
[S15] round=8 local utility u=0.121295 metrics={'f1_val': 0.41714217784117924, 'auprc': 0.7999078580534236, 'loss_val': 0.8299538134534189, 'psi': 0.5702484499260769}-{'f1_val': 0.416839147538149, 'auprc': 0.7924871624690851, 'loss_val': 1.0484632610501707, 'psi': 0.5670983535105234}
[S16] START round=8 head_norm_before_train=0.809119 cos_to_last_merge=1.0000 (last merge round=7)
[S16] round=8 local utility u=0.039709 metrics={'f1_val': 0.4168831021970758, 'auprc': 0.5772353431201387, 'loss_val': 1.0230706984781326, 'psi': 0.48102399856630096}-{'f1_val': 0.4150731431819776, 'auprc': 0.582562827290953, 'loss_val': 1.1076108349047347, 'psi': 0.48206901682556774}
[S17] START round=8 head_norm_before_train=1.327284 (no previous merge yet)
[S17] round=8 local utility u=0.087813 metrics={'f1_val': 0.3518424223898232, 'auprc': 0.7531030828310421, 'loss_val': 0.8980167321362861, 'psi': 0.5123466865663108}-{'f1_val': 0.35328079891142916, 'auprc': 0.6947346812459804, 'loss_val': 0.907166932738527, 'psi': 0.4898623518452496}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S14] → sending delta(kind=head bytes=1787) to S4@127.0.0.1:37104
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:37116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:37113
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:37112
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:37117
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:37114
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:37104
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S2] → sending delta(kind=head bytes=1792) to S8@127.0.0.1:37109
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:37109
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:37116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:37110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:37110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S7] → sending delta(kind=head bytes=1792) to S10@127.0.0.1:37111
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:37114
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1804 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1787 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1792 to 1 peers)
[S2] sending update (kind=head size=1792 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1792) from S7
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.506678)
[S10] loaded HEAD from S7 (vec_in norm=1.506678)
[S10] cosine check vs S7: cos=0.9839
[S10] BUFFERED delta from S7 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1801) from S3
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.694148)
[S4] loaded HEAD from S3 (vec_in norm=1.694148)
[S4] cosine check vs S3: cos=0.9595
[S4] BUFFERED delta from S3 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1787) from S14
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.212990)
[S4] loaded HEAD from S14 (vec_in norm=1.212990)
[S4] cosine check vs S14: cos=-0.0269
[S4] DROPPED delta from S14 (cos=-0.0269 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1799) from S11
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.432205)
[S14] loaded HEAD from S11 (vec_in norm=1.432205)
[S14] cosine check vs S11: cos=0.9801
[S14] BUFFERED delta from S11 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1795) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.366849)
[S14] loaded HEAD from S10 (vec_in norm=1.366849)
[S14] cosine check vs S10: cos=-0.0869
[S14] DROPPED delta from S10 (cos=-0.0869 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1800) from S15
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.085283)
[S16] loaded HEAD from S15 (vec_in norm=1.085283)
[S16] cosine check vs S15: cos=0.5958
[S16] BUFFERED delta from S15 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1800) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.365765)
[S11] loaded HEAD from S6 (vec_in norm=1.365765)
[S11] cosine check vs S6: cos=-0.0363
[S11] DROPPED delta from S6 (cos=-0.0363 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1797) from S16
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.831605)
[S8] loaded HEAD from S16 (vec_in norm=0.831605)
[S8] cosine check vs S16: cos=-0.0291
[S8] DROPPED delta from S16 (cos=-0.0291 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1792) from S2
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.423665)
[S8] loaded HEAD from S2 (vec_in norm=1.423665)
[S8] cosine check vs S2: cos=-0.0160
[S8] DROPPED delta from S2 (cos=-0.0160 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1802) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.415375)
[S17] loaded HEAD from S8 (vec_in norm=1.415375)
[S17] cosine check vs S8: cos=-0.0118
[S17] DROPPED delta from S8 (cos=-0.0118 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1799) from S4
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.183980)
[S9] loaded HEAD from S4 (vec_in norm=1.183980)
[S9] cosine check vs S4: cos=-0.0619
[S9] DROPPED delta from S4 (cos=-0.0619 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1802) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.291321)
[S9] loaded HEAD from S5 (vec_in norm=1.291321)
[S9] cosine check vs S5: cos=-0.0883
[S9] DROPPED delta from S5 (cos=-0.0883 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1804) from S13
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.492313)
[S16] loaded HEAD from S13 (vec_in norm=1.492313)
[S16] cosine check vs S13: cos=0.7472
[S16] BUFFERED delta from S13 (total buffered=2)
[S13] RECEIVED delta(kind=head bytes=1800) from S9
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.697067)
[S13] loaded HEAD from S9 (vec_in norm=1.697067)
[S13] cosine check vs S9: cos=0.9828
[S13] BUFFERED delta from S9 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:37110
[S17] sending update (kind=head size=1800 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1800) from S17
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.363986)
[S9] loaded HEAD from S17 (vec_in norm=1.363986)
[S9] cosine check vs S17: cos=-0.1078
[S9] DROPPED delta from S17 (cos=-0.1078 < 0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=8 metric=0.1539 head_norm=1.212990
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.712667e-01
[S14] stored merged vector for next round verification (round=8)
[S14] DEBUG after merge:  round=8 metric=0.3965 head_norm=1.316034 delta_norm=0.171267
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=8 metric=0.4162 head_norm=1.492313
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.796135e-01
[S13] stored merged vector for next round verification (round=8)
[S13] DEBUG after merge:  round=8 metric=0.4162 head_norm=1.587847 delta_norm=0.179614
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=8 metric=0.6672 head_norm=1.183980
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.250441e-01
[S4] stored merged vector for next round verification (round=8)
[S4] DEBUG after merge:  round=8 metric=0.6762 head_norm=1.424893 delta_norm=0.325044
[S4] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=8 metric=0.1536 head_norm=1.366849
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.464488e-01
[S10] stored merged vector for next round verification (round=8)
[S10] DEBUG after merge:  round=8 metric=0.1766 head_norm=1.430989 delta_norm=0.146449
[S10] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=8 metric=0.4169 head_norm=0.831605
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.097041e-01
[S16] stored merged vector for next round verification (round=8)
[S16] DEBUG after merge:  round=8 metric=0.4169 head_norm=0.862876 delta_norm=0.109704
[S16] aggregate: ACCEPT kept=['S15', 'S13'] (k=2/2) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=1.423665 (no previous merge yet)
[S2] round=9 local utility u=0.000000 metrics={'f1_val': 0.6581068018199353, 'auprc': 0.7803182071036955, 'loss_val': 0.6133121050960391, 'psi': 0.7069913639334394}-{'f1_val': 0.7124519638420558, 'auprc': 0.7800379616464901, 'loss_val': 0.6423983474308148, 'psi': 0.7394863629638295}
[S3] START round=9 head_norm_before_train=1.694148 (no previous merge yet)
[S3] round=9 local utility u=0.016646 metrics={'f1_val': 0.7005313319257805, 'auprc': 0.9981029876174445, 'loss_val': 0.24516100754609255, 'psi': 0.8195599942024462}-{'f1_val': 0.7006809596653347, 'auprc': 0.9984541776927565, 'loss_val': 0.2804039806466026, 'psi': 0.8197902468763034}
[S4] START round=9 head_norm_before_train=1.424893 cos_to_last_merge=1.0000 (last merge round=8)
[S4] round=9 local utility u=0.000000 metrics={'f1_val': 0.6644002801040592, 'auprc': 0.8592644992402986, 'loss_val': 0.6866112962806247, 'psi': 0.7423459677585549}-{'f1_val': 0.6672277188707187, 'auprc': 0.9344521373012402, 'loss_val': 0.8208497155955855, 'psi': 0.7741174862429274}
[S5] START round=9 head_norm_before_train=1.291321 cos_to_last_merge=0.8871 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.887
[S5] round=9 local utility u=0.000000 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.953981675158158, 'loss_val': 0.3567112421469805, 'psi': 0.8019577056608678}-{'f1_val': 0.7005708485915159, 'auprc': 0.9982987893922801, 'loss_val': 0.44728065825007146, 'psi': 0.8196620249118216}
[S6] START round=9 head_norm_before_train=1.365765 (no previous merge yet)
[S6] round=9 local utility u=0.022200 metrics={'f1_val': 0.6203709927983059, 'auprc': 0.9549039605434015, 'loss_val': 0.5239184613974993, 'psi': 0.7541841798963442}-{'f1_val': 0.6203403218268294, 'auprc': 0.9655011003716284, 'loss_val': 0.5999258364745581, 'psi': 0.758404633244749}
[S7] START round=9 head_norm_before_train=1.506678 (no previous merge yet)
[S7] round=9 local utility u=0.000000 metrics={'f1_val': 0.6643424414203754, 'auprc': 0.868050602907386, 'loss_val': 0.5675192322599031, 'psi': 0.7458257060151796}-{'f1_val': 0.6559570187209873, 'auprc': 0.920727829923379, 'loss_val': 0.6570569265153023, 'psi': 0.761865343201944}
[S8] START round=9 head_norm_before_train=1.415375 (no previous merge yet)
[S8] round=9 local utility u=0.058967 metrics={'f1_val': 0.3727318090052443, 'auprc': 0.9962619551574281, 'loss_val': 0.6427414790088136, 'psi': 0.6221438674661178}-{'f1_val': 0.37306606018310795, 'auprc': 0.9931424556410051, 'loss_val': 0.7533214948738209, 'psi': 0.6210966183662668}
[S9] START round=9 head_norm_before_train=1.697067 (no previous merge yet)
[S9] round=9 local utility u=0.040850 metrics={'f1_val': 0.9945775144926113, 'auprc': 0.9988557786760143, 'loss_val': 0.0893957873798852, 'psi': 0.9962888201659725}-{'f1_val': 0.9873949972964658, 'auprc': 0.9985951396063564, 'loss_val': 0.12721813607728788, 'psi': 0.991875054220422}
[S10] START round=9 head_norm_before_train=1.430989 cos_to_last_merge=1.0000 (last merge round=8)
[S10] round=9 local utility u=1.000000 metrics={'f1_val': 0.3975856569359279, 'auprc': 0.7902563561134699, 'loss_val': 1.0372380477490004, 'psi': 0.5546539366069447}-{'f1_val': 0.1536118363794604, 'auprc': 0.6391522064312414, 'loss_val': 1.1384473032390119, 'psi': 0.3478279844001728}
[S11] START round=9 head_norm_before_train=1.432205 (no previous merge yet)
[S11] round=9 local utility u=1.000000 metrics={'f1_val': 0.7997506828267025, 'auprc': 0.9984285630289214, 'loss_val': 0.4568202114182966, 'psi': 0.87922183490759}-{'f1_val': 0.39992541946910537, 'auprc': 0.9989161735270533, 'loss_val': 0.6828289369884737, 'psi': 0.6395217210922846}
[S13] START round=9 head_norm_before_train=1.587847 cos_to_last_merge=1.0000 (last merge round=8)
[S13] round=9 local utility u=0.000000 metrics={'f1_val': 0.37175312145770045, 'auprc': 0.5731723360111686, 'loss_val': 0.9564896305110236, 'psi': 0.45232080727908774}-{'f1_val': 0.416200286011302, 'auprc': 0.5439188068136347, 'loss_val': 1.0469339089462069, 'psi': 0.46728769433223505}
[S14] START round=9 head_norm_before_train=1.316034 cos_to_last_merge=1.0000 (last merge round=8)
[S14] round=9 local utility u=0.856549 metrics={'f1_val': 0.39652757107859105, 'auprc': 0.8140596575619885, 'loss_val': 1.0968469976742599, 'psi': 0.56354040567195}-{'f1_val': 0.1539132330499237, 'auprc': 0.7604478377938756, 'loss_val': 1.1934228328609602, 'psi': 0.39652707494750444}
[S15] START round=9 head_norm_before_train=1.085283 cos_to_last_merge=0.9329 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.933
[S15] round=9 local utility u=1.000000 metrics={'f1_val': 0.7002537939953926, 'auprc': 0.9868995808863088, 'loss_val': 0.6653286097078199, 'psi': 0.814912108751759}-{'f1_val': 0.41714217784117924, 'auprc': 0.7999078580534236, 'loss_val': 0.8299538134534189, 'psi': 0.5702484499260769}
[S16] START round=9 head_norm_before_train=0.862876 cos_to_last_merge=1.0000 (last merge round=8)
[S16] round=9 local utility u=0.293025 metrics={'f1_val': 0.39023714691662426, 'auprc': 0.7952934712827803, 'loss_val': 0.9313187567456197, 'psi': 0.5522596766630866}-{'f1_val': 0.4168831021970758, 'auprc': 0.5772353431201387, 'loss_val': 1.0230706984781326, 'psi': 0.48102399856630096}
[S17] START round=9 head_norm_before_train=1.363986 (no previous merge yet)
[S17] round=9 local utility u=0.000000 metrics={'f1_val': 0.3358702748211243, 'auprc': 0.6976707234886588, 'loss_val': 1.0730556046485618, 'psi': 0.48059045428813807}-{'f1_val': 0.3518424223898232, 'auprc': 0.7531030828310421, 'loss_val': 0.8980167321362861, 'psi': 0.5123466865663108}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S16] → sending delta(kind=head bytes=1791) to S8@127.0.0.1:37109
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:37112
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:37114
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:37117
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:37113
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:37114
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:37104
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:37116
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:37104
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1791 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1797) from S14
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.325469)
[S4] loaded HEAD from S14 (vec_in norm=1.325469)
[S4] cosine check vs S14: cos=-0.0862
[S4] DROPPED delta from S14 (cos=-0.0862 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1801) from S9
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.733366)
[S13] loaded HEAD from S9 (vec_in norm=1.733366)
[S13] cosine check vs S9: cos=0.9911
[S13] BUFFERED delta from S9 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1800) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.412566)
[S11] loaded HEAD from S6 (vec_in norm=1.412566)
[S11] cosine check vs S6: cos=-0.0408
[S11] DROPPED delta from S6 (cos=-0.0408 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1791) from S16
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.890646)
[S8] loaded HEAD from S16 (vec_in norm=0.890646)
[S8] cosine check vs S16: cos=-0.0210
[S8] DROPPED delta from S16 (cos=-0.0210 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1801) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.460089)
[S17] loaded HEAD from S8 (vec_in norm=1.460089)
[S17] cosine check vs S8: cos=-0.0131
[S17] DROPPED delta from S8 (cos=-0.0131 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1801) from S15
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.136468)
[S16] loaded HEAD from S15 (vec_in norm=1.136468)
[S16] cosine check vs S15: cos=0.5763
[S16] BUFFERED delta from S15 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1799) from S11
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.477661)
[S14] loaded HEAD from S11 (vec_in norm=1.477661)
[S14] cosine check vs S11: cos=0.9868
[S14] BUFFERED delta from S11 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1798) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.452578)
[S14] loaded HEAD from S10 (vec_in norm=1.452578)
[S14] cosine check vs S10: cos=-0.1002
[S14] DROPPED delta from S10 (cos=-0.1002 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1799) from S3
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.738126)
[S4] loaded HEAD from S3 (vec_in norm=1.738126)
[S4] cosine check vs S3: cos=0.9831
[S4] BUFFERED delta from S3 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=9 metric=0.6644 head_norm=1.451754
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.044276e-01
[S4] stored merged vector for next round verification (round=9)
[S4] DEBUG after merge:  round=9 metric=0.6632 head_norm=1.588253 delta_norm=0.204428
[S4] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=9 metric=0.3718 head_norm=1.608119
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.279773e-01
[S13] stored merged vector for next round verification (round=9)
[S13] DEBUG after merge:  round=9 metric=0.3718 head_norm=1.667010 delta_norm=0.127977
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=9 metric=0.3965 head_norm=1.325469
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.366665e-01
[S14] stored merged vector for next round verification (round=9)
[S14] DEBUG after merge:  round=9 metric=0.3965 head_norm=1.396960 delta_norm=0.136667
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=9 metric=0.3902 head_norm=0.890646
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.790860e-01
[S16] stored merged vector for next round verification (round=9)
[S16] DEBUG after merge:  round=9 metric=0.3840 head_norm=0.901599 delta_norm=0.479086
[S16] aggregate: ROLLBACK (f1_val pre=0.390 post=0.384 tol_abs=0.005 tol_rel=0.0)
[S2] START round=10 head_norm_before_train=1.471251 (no previous merge yet)
[S2] round=10 local utility u=0.427939 metrics={'f1_val': 0.6994076265853314, 'auprc': 0.9267807688757086, 'loss_val': 0.4446277188476348, 'psi': 0.7903568835014823}-{'f1_val': 0.6581068018199353, 'auprc': 0.7803182071036955, 'loss_val': 0.6133121050960391, 'psi': 0.7069913639334394}
[S3] START round=10 head_norm_before_train=1.738126 (no previous merge yet)
[S3] round=10 local utility u=0.035453 metrics={'f1_val': 0.7003512381127298, 'auprc': 0.9984518690371255, 'loss_val': 0.17422135083556586, 'psi': 0.8195914904824881}-{'f1_val': 0.7005313319257805, 'auprc': 0.9981029876174445, 'loss_val': 0.24516100754609255, 'psi': 0.8195599942024462}
[S4] START round=10 head_norm_before_train=1.588253 cos_to_last_merge=1.0000 (last merge round=9)
[S4] round=10 local utility u=0.008025 metrics={'f1_val': 0.6644474972954457, 'auprc': 0.8266768206057159, 'loss_val': 0.5730806387826489, 'psi': 0.7293392266195537}-{'f1_val': 0.6644002801040592, 'auprc': 0.8592644992402986, 'loss_val': 0.6866112962806247, 'psi': 0.7423459677585549}
[S5] START round=10 head_norm_before_train=1.333280 cos_to_last_merge=0.8709 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.871
[S5] round=10 local utility u=0.075195 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9876374666976523, 'loss_val': 0.3072889887388138, 'psi': 0.8154200222766654}-{'f1_val': 0.7006083926626743, 'auprc': 0.953981675158158, 'loss_val': 0.3567112421469805, 'psi': 0.8019577056608678}
[S6] START round=10 head_norm_before_train=1.412566 (no previous merge yet)
[S6] round=10 local utility u=0.000000 metrics={'f1_val': 0.620301554463625, 'auprc': 0.8140825488178756, 'loss_val': 0.4919135228967815, 'psi': 0.6978139522053253}-{'f1_val': 0.6203709927983059, 'auprc': 0.9549039605434015, 'loss_val': 0.5239184613974993, 'psi': 0.7541841798963442}
[S7] START round=10 head_norm_before_train=1.532156 (no previous merge yet)
[S7] round=10 local utility u=0.228060 metrics={'f1_val': 0.6859637809731893, 'auprc': 0.9111589715457638, 'loss_val': 0.3704531036347117, 'psi': 0.7760418572022192}-{'f1_val': 0.6643424414203754, 'auprc': 0.868050602907386, 'loss_val': 0.5675192322599031, 'psi': 0.7458257060151796}
[S8] START round=10 head_norm_before_train=1.460089 (no previous merge yet)
[S8] round=10 local utility u=0.039165 metrics={'f1_val': 0.3729988868650071, 'auprc': 0.9935183027699563, 'loss_val': 0.5577839571595333, 'psi': 0.6212066532269868}-{'f1_val': 0.3727318090052443, 'auprc': 0.9962619551574281, 'loss_val': 0.6427414790088136, 'psi': 0.6221438674661178}
[S9] START round=10 head_norm_before_train=1.733366 (no previous merge yet)
[S9] round=10 local utility u=0.012158 metrics={'f1_val': 0.9941601000394567, 'auprc': 0.9996001643841598, 'loss_val': 0.06480854474914506, 'psi': 0.9963361257773379}-{'f1_val': 0.9945775144926113, 'auprc': 0.9988557786760143, 'loss_val': 0.0893957873798852, 'psi': 0.9962888201659725}
[S10] START round=10 head_norm_before_train=1.452578 cos_to_last_merge=0.9982 (last merge round=8)
[S10] round=10 local utility u=0.212737 metrics={'f1_val': 0.40163921995313306, 'auprc': 0.8615237739582575, 'loss_val': 0.8498872371044951, 'psi': 0.5855930415551829}-{'f1_val': 0.3975856569359279, 'auprc': 0.7902563561134699, 'loss_val': 1.0372380477490004, 'psi': 0.5546539366069447}
[S11] START round=10 head_norm_before_train=1.477661 (no previous merge yet)
[S11] round=10 local utility u=0.519905 metrics={'f1_val': 0.9550326000595026, 'auprc': 0.9985499283238191, 'loss_val': 0.349066092819869, 'psi': 0.9724395313652292}-{'f1_val': 0.7997506828267025, 'auprc': 0.9984285630289214, 'loss_val': 0.4568202114182966, 'psi': 0.87922183490759}
[S13] START round=10 head_norm_before_train=1.667010 cos_to_last_merge=1.0000 (last merge round=9)
[S13] round=10 local utility u=0.817051 metrics={'f1_val': 0.6217708558869428, 'auprc': 0.5845494556192974, 'loss_val': 0.8566261909408383, 'psi': 0.6068822957798846}-{'f1_val': 0.37175312145770045, 'auprc': 0.5731723360111686, 'loss_val': 0.9564896305110236, 'psi': 0.45232080727908774}
[S14] START round=10 head_norm_before_train=1.396960 cos_to_last_merge=1.0000 (last merge round=9)
[S14] round=10 local utility u=0.376162 metrics={'f1_val': 0.3964619511854436, 'auprc': 0.9982277801595293, 'loss_val': 0.8966336341910495, 'psi': 0.6371682827750779}-{'f1_val': 0.39652757107859105, 'auprc': 0.8140596575619885, 'loss_val': 1.0968469976742599, 'psi': 0.56354040567195}
[S15] START round=10 head_norm_before_train=1.136468 cos_to_last_merge=0.9156 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.916
[S15] round=10 local utility u=0.049137 metrics={'f1_val': 0.700774274038031, 'auprc': 0.9705770537462982, 'loss_val': 0.5212097984823219, 'psi': 0.8086953859213379}-{'f1_val': 0.7002537939953926, 'auprc': 0.9868995808863088, 'loss_val': 0.6653286097078199, 'psi': 0.814912108751759}
[S16] START round=10 head_norm_before_train=0.901599 cos_to_last_merge=1.0000 (last merge round=9)
[S16] round=10 local utility u=0.222157 metrics={'f1_val': 0.4358894248385172, 'auprc': 0.8271959156678264, 'loss_val': 0.8566249997870546, 'psi': 0.5924120211702408}-{'f1_val': 0.39023714691662426, 'auprc': 0.7952934712827803, 'loss_val': 0.9313187567456197, 'psi': 0.5522596766630866}
[S17] START round=10 head_norm_before_train=1.391669 (no previous merge yet)
[S17] round=10 local utility u=0.080467 metrics={'f1_val': 0.3366488404014475, 'auprc': 0.7399029686463239, 'loss_val': 1.0434907207191153, 'psi': 0.4979504916993981}-{'f1_val': 0.3358702748211243, 'auprc': 0.6976707234886588, 'loss_val': 1.0730556046485618, 'psi': 0.48059045428813807}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:37104
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:37113
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] → sending delta(kind=head bytes=1805) to S4@127.0.0.1:37104
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:37117
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:37109
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] → sending delta(kind=head bytes=1794) to S16@127.0.0.1:37116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:37114
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] → sending delta(kind=head bytes=1805) to S8@127.0.0.1:37109
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:37116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:37114
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:37111
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:37110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:37110
[S15] sending update (kind=head size=1794 to 1 peers)
[S16] sending update (kind=head size=1805 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1805 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1803) from S11
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.526775)
[S14] loaded HEAD from S11 (vec_in norm=1.526775)
[S14] cosine check vs S11: cos=0.9894
[S14] BUFFERED delta from S11 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1798) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.487945)
[S14] loaded HEAD from S10 (vec_in norm=1.487945)
[S14] cosine check vs S10: cos=-0.1014
[S14] DROPPED delta from S10 (cos=-0.1014 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1805) from S16
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.932397)
[S8] loaded HEAD from S16 (vec_in norm=0.932397)
[S8] cosine check vs S16: cos=0.0071
[S8] BUFFERED delta from S16 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1805) from S3
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.776554)
[S4] loaded HEAD from S3 (vec_in norm=1.776554)
[S4] cosine check vs S3: cos=0.9887
[S4] BUFFERED delta from S3 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1803) from S14
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.416395)
[S4] loaded HEAD from S14 (vec_in norm=1.416395)
[S4] cosine check vs S14: cos=-0.1004
[S4] DROPPED delta from S14 (cos=-0.1004 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1796) from S2
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.513610)
[S8] loaded HEAD from S2 (vec_in norm=1.513610)
[S8] cosine check vs S2: cos=-0.0187
[S8] DROPPED delta from S2 (cos=-0.0187 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1800) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.507262)
[S17] loaded HEAD from S8 (vec_in norm=1.507262)
[S17] cosine check vs S8: cos=-0.0146
[S17] DROPPED delta from S8 (cos=-0.0146 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1800) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.385118)
[S9] loaded HEAD from S5 (vec_in norm=1.385118)
[S9] cosine check vs S5: cos=-0.0891
[S9] DROPPED delta from S5 (cos=-0.0891 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1802) from S4
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.616121)
[S9] loaded HEAD from S4 (vec_in norm=1.616121)
[S9] cosine check vs S4: cos=-0.0559
[S9] DROPPED delta from S4 (cos=-0.0559 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1802) from S13
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.691360)
[S16] loaded HEAD from S13 (vec_in norm=1.691360)
[S16] cosine check vs S13: cos=0.3481
[S16] BUFFERED delta from S13 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1794) from S15
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.189404)
[S16] loaded HEAD from S15 (vec_in norm=1.189404)
[S16] cosine check vs S15: cos=0.8959
[S16] BUFFERED delta from S15 (total buffered=2)
[S13] RECEIVED delta(kind=head bytes=1798) from S9
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.776692)
[S13] loaded HEAD from S9 (vec_in norm=1.776692)
[S13] cosine check vs S9: cos=0.9931
[S13] BUFFERED delta from S9 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1798) from S7
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.556398)
[S10] loaded HEAD from S7 (vec_in norm=1.556398)
[S10] cosine check vs S7: cos=0.9795
[S10] BUFFERED delta from S7 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:37110
[S17] sending update (kind=head size=1796 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1796) from S17
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.412800)
[S9] loaded HEAD from S17 (vec_in norm=1.412800)
[S9] cosine check vs S17: cos=-0.1012
[S9] DROPPED delta from S17 (cos=-0.1012 < 0.0)
[S6] ⇄ pheromone p=0.311 → S11@127.0.0.1:37112
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=10 metric=0.3730 head_norm=1.507262
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.833680e-01
[S8] stored merged vector for next round verification (round=10)
[S8] DEBUG after merge:  round=10 metric=0.3730 head_norm=0.888967 delta_norm=0.883368
[S8] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.270 → S17@127.0.0.1:37117
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=10 metric=0.6218 head_norm=1.691360
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.100598e-01
[S13] stored merged vector for next round verification (round=10)
[S13] DEBUG after merge:  round=10 metric=0.4160 head_norm=1.731056 delta_norm=0.110060
[S13] aggregate: ROLLBACK (f1_val pre=0.622 post=0.416 tol_abs=0.005 tol_rel=0.0)
[S13] ⇄ pheromone p=0.360 → S16@127.0.0.1:37116
[S9] ⇄ pheromone p=0.308 → S13@127.0.0.1:37113
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=10 metric=0.4016 head_norm=1.487945
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.578322e-01
[S10] stored merged vector for next round verification (round=10)
[S10] DEBUG after merge:  round=10 metric=0.3904 head_norm=1.514354 delta_norm=0.157832
[S10] aggregate: ROLLBACK (f1_val pre=0.402 post=0.390 tol_abs=0.005 tol_rel=0.0)
[S10] ⇄ pheromone p=0.355 → S14@127.0.0.1:37114
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=10 metric=0.4359 head_norm=0.932397
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.937685e-01
[S16] stored merged vector for next round verification (round=10)
[S16] DEBUG after merge:  round=10 metric=0.6800 head_norm=0.926048 delta_norm=0.293768
[S16] aggregate: ACCEPT kept=['S13', 'S15'] (k=2/2) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.264 → S8@127.0.0.1:37109
[S7] ⇄ pheromone p=0.351 → S10@127.0.0.1:37111
[S5] ⇄ pheromone p=0.287 → S9@127.0.0.1:37110
[S3] ⇄ pheromone p=0.247 → S4@127.0.0.1:37104
[S15] ⇄ pheromone p=0.392 → S16@127.0.0.1:37116
[S2] ⇄ pheromone p=0.384 → S8@127.0.0.1:37109
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=10 metric=0.6644 head_norm=1.616121
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.503319e-01
[S4] stored merged vector for next round verification (round=10)
[S4] DEBUG after merge:  round=10 metric=0.6632 head_norm=1.691566 delta_norm=0.150332
[S4] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.301 → S9@127.0.0.1:37110
[S11] ⇄ pheromone p=0.488 → S14@127.0.0.1:37114
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=10 metric=0.3965 head_norm=1.416395
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.203885e-01
[S14] stored merged vector for next round verification (round=10)
[S14] DEBUG after merge:  round=10 metric=0.5268 head_norm=1.467691 delta_norm=0.120388
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.353 → S4@127.0.0.1:37104
[S17] ⇄ pheromone p=0.216 → S9@127.0.0.1:37110
[S2] START round=11 head_norm_before_train=1.513610 (no previous merge yet)
[S2] round=11 local utility u=0.000000 metrics={'f1_val': 0.7011337461190337, 'auprc': 0.8061848897483377, 'loss_val': 0.3625517258994509, 'psi': 0.7431542035707552}-{'f1_val': 0.6994076265853314, 'auprc': 0.9267807688757086, 'loss_val': 0.4446277188476348, 'psi': 0.7903568835014823}
[S3] START round=11 head_norm_before_train=1.776554 (no previous merge yet)
[S3] round=11 local utility u=0.000000 metrics={'f1_val': 0.7006060025002057, 'auprc': 0.9986826294004914, 'loss_val': 0.1822815053912195, 'psi': 0.8198366532603198}-{'f1_val': 0.7003512381127298, 'auprc': 0.9984518690371255, 'loss_val': 0.17422135083556586, 'psi': 0.8195914904824881}
[S4] START round=11 head_norm_before_train=1.691566 cos_to_last_merge=1.0000 (last merge round=10)
[S4] round=11 local utility u=0.002810 metrics={'f1_val': 0.6656575185387699, 'auprc': 0.8022640073211443, 'loss_val': 0.5014817975370058, 'psi': 0.7203001140517197}-{'f1_val': 0.6644474972954457, 'auprc': 0.8266768206057159, 'loss_val': 0.5730806387826489, 'psi': 0.7293392266195537}
[S5] START round=11 head_norm_before_train=1.385118 cos_to_last_merge=0.8576 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.858
[S5] round=11 local utility u=0.018900 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9895692980682722, 'loss_val': 0.2752842279924997, 'psi': 0.8161927548249135}-{'f1_val': 0.7006083926626743, 'auprc': 0.9876374666976523, 'loss_val': 0.3072889887388138, 'psi': 0.8154200222766654}
[S6] START round=11 head_norm_before_train=1.459874 (no previous merge yet)
[S6] round=11 local utility u=0.000000 metrics={'f1_val': 0.6197136334373508, 'auprc': 0.7914550984989791, 'loss_val': 0.49819559760682597, 'psi': 0.6884102194620021}-{'f1_val': 0.620301554463625, 'auprc': 0.8140825488178756, 'loss_val': 0.4919135228967815, 'psi': 0.6978139522053253}
[S7] START round=11 head_norm_before_train=1.556398 (no previous merge yet)
[S7] round=11 local utility u=0.000000 metrics={'f1_val': 0.5529931604451301, 'auprc': 0.7777853403998816, 'loss_val': 0.8188291857691445, 'psi': 0.6429100324270307}-{'f1_val': 0.6859637809731893, 'auprc': 0.9111589715457638, 'loss_val': 0.3704531036347117, 'psi': 0.7760418572022192}
[S8] START round=11 head_norm_before_train=0.888967 cos_to_last_merge=1.0000 (last merge round=10)
[S8] round=11 local utility u=0.000000 metrics={'f1_val': 0.3728657005221765, 'auprc': 0.9933681300287246, 'loss_val': 0.6392792339306955, 'psi': 0.6210666723247957}-{'f1_val': 0.3729988868650071, 'auprc': 0.9935183027699563, 'loss_val': 0.5577839571595333, 'psi': 0.6212066532269868}
[S9] START round=11 head_norm_before_train=1.776692 (no previous merge yet)
[S9] round=11 local utility u=0.015923 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9995892161550279, 'loss_val': 0.045596206446765625, 'psi': 0.9975983039002548}-{'f1_val': 0.9941601000394567, 'auprc': 0.9996001643841598, 'loss_val': 0.06480854474914506, 'psi': 0.9963361257773379}
[S10] START round=11 head_norm_before_train=1.514354 cos_to_last_merge=1.0000 (last merge round=10)
[S10] round=11 local utility u=0.936859 metrics={'f1_val': 0.6905427352565274, 'auprc': 0.8626752428677531, 'loss_val': 0.713044399077919, 'psi': 0.7593957383010177}-{'f1_val': 0.40163921995313306, 'auprc': 0.8615237739582575, 'loss_val': 0.8498872371044951, 'psi': 0.5855930415551829}
[S11] START round=11 head_norm_before_train=1.526775 (no previous merge yet)
[S11] round=11 local utility u=0.064549 metrics={'f1_val': 0.9585332523536179, 'auprc': 0.9983718346847312, 'loss_val': 0.24043737520904263, 'psi': 0.9744686852860631}-{'f1_val': 0.9550326000595026, 'auprc': 0.9985499283238191, 'loss_val': 0.349066092819869, 'psi': 0.9724395313652292}
[S13] START round=11 head_norm_before_train=1.731056 cos_to_last_merge=1.0000 (last merge round=10)
[S13] round=11 local utility u=0.264611 metrics={'f1_val': 0.6351575911835907, 'auprc': 0.710149616374927, 'loss_val': 0.7845240854932116, 'psi': 0.6651544012601251}-{'f1_val': 0.6217708558869428, 'auprc': 0.5845494556192974, 'loss_val': 0.8566261909408383, 'psi': 0.6068822957798846}
[S14] START round=11 head_norm_before_train=1.467691 cos_to_last_merge=1.0000 (last merge round=10)
[S14] round=11 local utility u=0.967551 metrics={'f1_val': 0.6887069684732008, 'auprc': 0.9945304819021373, 'loss_val': 0.703908987269106, 'psi': 0.8110363738447754}-{'f1_val': 0.3964619511854436, 'auprc': 0.9982277801595293, 'loss_val': 0.8966336341910495, 'psi': 0.6371682827750779}
[S15] START round=11 head_norm_before_train=1.189404 cos_to_last_merge=0.8984 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.898
[S15] round=11 local utility u=0.066764 metrics={'f1_val': 0.6940639099298022, 'auprc': 0.9870224317442617, 'loss_val': 0.3967552212968889, 'psi': 0.811247318655586}-{'f1_val': 0.700774274038031, 'auprc': 0.9705770537462982, 'loss_val': 0.5212097984823219, 'psi': 0.8086953859213379}
[S16] START round=11 head_norm_before_train=0.926048 cos_to_last_merge=1.0000 (last merge round=10)
[S16] round=11 local utility u=0.837756 metrics={'f1_val': 0.6815981358357531, 'auprc': 0.8664703337643459, 'loss_val': 0.7731889989174958, 'psi': 0.7555470150071902}-{'f1_val': 0.4358894248385172, 'auprc': 0.8271959156678264, 'loss_val': 0.8566249997870546, 'psi': 0.5924120211702408}
[S17] START round=11 head_norm_before_train=1.412800 (no previous merge yet)
[S17] round=11 local utility u=0.152768 metrics={'f1_val': 0.3521394294854705, 'auprc': 0.7768941721889332, 'loss_val': 0.9418723670419692, 'psi': 0.5220413265668556}-{'f1_val': 0.3366488404014475, 'auprc': 0.7399029686463239, 'loss_val': 1.0434907207191153, 'psi': 0.4979504916993981}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:37114
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:37113
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:37116
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:37104
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:37110
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:37110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:37116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:37114
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:37109
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1801) from S14
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.494631)
[S4] loaded HEAD from S14 (vec_in norm=1.494631)
[S4] cosine check vs S14: cos=-0.1032
[S4] DROPPED delta from S14 (cos=-0.1032 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1798) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.429159)
[S9] loaded HEAD from S5 (vec_in norm=1.429159)
[S9] cosine check vs S5: cos=-0.0903
[S9] DROPPED delta from S5 (cos=-0.0903 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1800) from S4
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.719849)
[S9] loaded HEAD from S4 (vec_in norm=1.719849)
[S9] cosine check vs S4: cos=-0.0552
[S9] DROPPED delta from S4 (cos=-0.0552 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1795) from S13
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.753280)
[S16] loaded HEAD from S13 (vec_in norm=1.753280)
[S16] cosine check vs S13: cos=0.6084
[S16] BUFFERED delta from S13 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1796) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.551704)
[S14] loaded HEAD from S10 (vec_in norm=1.551704)
[S14] cosine check vs S10: cos=-0.1033
[S14] DROPPED delta from S10 (cos=-0.1033 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1803) from S11
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.576984)
[S14] loaded HEAD from S11 (vec_in norm=1.576984)
[S14] cosine check vs S11: cos=0.9916
[S14] BUFFERED delta from S11 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1798) from S15
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.246568)
[S16] loaded HEAD from S15 (vec_in norm=1.246568)
[S16] cosine check vs S15: cos=0.7347
[S16] BUFFERED delta from S15 (total buffered=2)
[S13] RECEIVED delta(kind=head bytes=1802) from S9
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.816904)
[S13] loaded HEAD from S9 (vec_in norm=1.816904)
[S13] cosine check vs S9: cos=0.9946
[S13] BUFFERED delta from S9 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:37110
[S16] sending update (kind=head size=1795 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1795) from S16
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=0.965436)
[S8] loaded HEAD from S16 (vec_in norm=0.965436)
[S8] cosine check vs S16: cos=0.4734
[S8] BUFFERED delta from S16 (total buffered=1)
[S17] sending update (kind=head size=1800 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1800) from S17
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.430239)
[S9] loaded HEAD from S17 (vec_in norm=1.430239)
[S9] cosine check vs S17: cos=-0.0977
[S9] DROPPED delta from S17 (cos=-0.0977 < 0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=11 metric=0.3729 head_norm=0.951272
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.917970e-01
[S8] stored merged vector for next round verification (round=11)
[S8] DEBUG after merge:  round=11 metric=0.3729 head_norm=0.822574 delta_norm=0.491797
[S8] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=11 metric=0.6816 head_norm=0.965436
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.702114e-01
[S16] stored merged vector for next round verification (round=11)
[S16] DEBUG after merge:  round=11 metric=0.6849 head_norm=0.992948 delta_norm=0.170211
[S16] aggregate: ACCEPT kept=['S13', 'S15'] (k=2/2) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=11 metric=0.6352 head_norm=1.753280
[S13] _apply_head_vector_avg (torch): Δ‖w‖=9.802631e-02
[S13] stored merged vector for next round verification (round=11)
[S13] DEBUG after merge:  round=11 metric=0.6392 head_norm=1.782682 delta_norm=0.098026
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=11 metric=0.6887 head_norm=1.494631
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.078634e-01
[S14] stored merged vector for next round verification (round=11)
[S14] DEBUG after merge:  round=11 metric=0.6848 head_norm=1.532568 delta_norm=0.107863
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.551434 (no previous merge yet)
[S2] round=12 local utility u=0.303025 metrics={'f1_val': 0.7009533202285976, 'auprc': 0.9918695620429401, 'loss_val': 0.312472296763164, 'psi': 0.8173198169543345}-{'f1_val': 0.7011337461190337, 'auprc': 0.8061848897483377, 'loss_val': 0.3625517258994509, 'psi': 0.7431542035707552}
[S3] START round=12 head_norm_before_train=1.812498 (no previous merge yet)
[S3] round=12 local utility u=0.933811 metrics={'f1_val': 0.9971149325810758, 'auprc': 0.9985651041195076, 'loss_val': 0.09336077358654221, 'psi': 0.9976950011964485}-{'f1_val': 0.7006060025002057, 'auprc': 0.9986826294004914, 'loss_val': 0.1822815053912195, 'psi': 0.8198366532603198}
[S4] START round=12 head_norm_before_train=1.719849 cos_to_last_merge=0.9983 (last merge round=10)
[S4] round=12 local utility u=0.016762 metrics={'f1_val': 0.66543337398187, 'auprc': 0.7993684906933891, 'loss_val': 0.45792568091838987, 'psi': 0.7190074206664776}-{'f1_val': 0.6656575185387699, 'auprc': 0.8022640073211443, 'loss_val': 0.5014817975370058, 'psi': 0.7203001140517197}
[S5] START round=12 head_norm_before_train=1.429159 cos_to_last_merge=0.8485 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.848
[S5] round=12 local utility u=0.012069 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9895255877838834, 'loss_val': 0.2510159110979164, 'psi': 0.816175270711158}-{'f1_val': 0.7006083926626743, 'auprc': 0.9895692980682722, 'loss_val': 0.2752842279924997, 'psi': 0.8161927548249135}
[S6] START round=12 head_norm_before_train=1.501733 (no previous merge yet)
[S6] round=12 local utility u=0.577855 metrics={'f1_val': 0.7070152481968857, 'auprc': 0.9529590861355861, 'loss_val': 0.3508072251769301, 'psi': 0.8053927833723659}-{'f1_val': 0.6197136334373508, 'auprc': 0.7914550984989791, 'loss_val': 0.49819559760682597, 'psi': 0.6884102194620021}
[S7] START round=12 head_norm_before_train=1.574194 (no previous merge yet)
[S7] round=12 local utility u=0.299936 metrics={'f1_val': 0.6162311185342132, 'auprc': 0.7926321581383986, 'loss_val': 0.6429246547748181, 'psi': 0.6867915343758874}-{'f1_val': 0.5529931604451301, 'auprc': 0.7777853403998816, 'loss_val': 0.8188291857691445, 'psi': 0.6429100324270307}
[S8] START round=12 head_norm_before_train=0.822574 cos_to_last_merge=1.0000 (last merge round=11)
[S8] round=12 local utility u=0.039956 metrics={'f1_val': 0.40315385759383704, 'auprc': 0.9636848863162786, 'loss_val': 0.6520458064521615, 'psi': 0.6273662690828137}-{'f1_val': 0.3728657005221765, 'auprc': 0.9933681300287246, 'loss_val': 0.6392792339306955, 'psi': 0.6210666723247957}
[S9] START round=12 head_norm_before_train=1.816904 (no previous merge yet)
[S9] round=12 local utility u=0.000000 metrics={'f1_val': 0.9899766087340214, 'auprc': 0.9996019954582922, 'loss_val': 0.04778658455606983, 'psi': 0.9938267634237297}-{'f1_val': 0.9962710290637395, 'auprc': 0.9995892161550279, 'loss_val': 0.045596206446765625, 'psi': 0.9975983039002548}
[S10] START round=12 head_norm_before_train=1.551704 cos_to_last_merge=0.9987 (last merge round=10)
[S10] round=12 local utility u=0.000000 metrics={'f1_val': 0.606382293777403, 'auprc': 0.9352169513831785, 'loss_val': 0.5639755331149199, 'psi': 0.7379161568197132}-{'f1_val': 0.6905427352565274, 'auprc': 0.8626752428677531, 'loss_val': 0.713044399077919, 'psi': 0.7593957383010177}
[S11] START round=12 head_norm_before_train=1.576984 (no previous merge yet)
[S11] round=12 local utility u=0.144740 metrics={'f1_val': 0.9971362493929642, 'auprc': 0.9983119715797565, 'loss_val': 0.18239498203382903, 'psi': 0.9976065382676811}-{'f1_val': 0.9585332523536179, 'auprc': 0.9983718346847312, 'loss_val': 0.24043737520904263, 'psi': 0.9744686852860631}
[S13] START round=12 head_norm_before_train=1.782682 cos_to_last_merge=1.0000 (last merge round=11)
[S13] round=12 local utility u=0.000000 metrics={'f1_val': 0.6069169712657211, 'auprc': 0.7169554111650238, 'loss_val': 0.7164922789178505, 'psi': 0.6509323472254421}-{'f1_val': 0.6351575911835907, 'auprc': 0.710149616374927, 'loss_val': 0.7845240854932116, 'psi': 0.6651544012601251}
[S14] START round=12 head_norm_before_train=1.532568 cos_to_last_merge=1.0000 (last merge round=11)
[S14] round=12 local utility u=0.128488 metrics={'f1_val': 0.701576189693488, 'auprc': 0.9978540199902399, 'loss_val': 0.5341187236005626, 'psi': 0.8200873218121888}-{'f1_val': 0.6887069684732008, 'auprc': 0.9945304819021373, 'loss_val': 0.703908987269106, 'psi': 0.8110363738447754}
[S15] START round=12 head_norm_before_train=1.246568 cos_to_last_merge=0.8823 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.882
[S15] round=12 local utility u=0.036973 metrics={'f1_val': 0.6944318264815387, 'auprc': 0.9870950362074935, 'loss_val': 0.325234159913436, 'psi': 0.8114971103719206}-{'f1_val': 0.6940639099298022, 'auprc': 0.9870224317442617, 'loss_val': 0.3967552212968889, 'psi': 0.811247318655586}
[S16] START round=12 head_norm_before_train=0.992948 cos_to_last_merge=1.0000 (last merge round=11)
[S16] round=12 local utility u=0.602045 metrics={'f1_val': 0.8324513767800221, 'auprc': 0.9351509695739655, 'loss_val': 0.6802597064522053, 'psi': 0.8735312138975995}-{'f1_val': 0.6815981358357531, 'auprc': 0.8664703337643459, 'loss_val': 0.7731889989174958, 'psi': 0.7555470150071902}
[S17] START round=12 head_norm_before_train=1.430239 (no previous merge yet)
[S17] round=12 local utility u=0.024484 metrics={'f1_val': 0.35302995561043005, 'auprc': 0.7832020338533536, 'loss_val': 0.9171717024164928, 'psi': 0.5250987869075995}-{'f1_val': 0.3521394294854705, 'auprc': 0.7768941721889332, 'loss_val': 0.9418723670419692, 'psi': 0.5220413265668556}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:37109
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:37117
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S14] → sending delta(kind=head bytes=1806) to S4@127.0.0.1:37104
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:37116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:37114
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S3] → sending delta(kind=head bytes=1806) to S4@127.0.0.1:37104
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:37112
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:37110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:37111
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:37110
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:37109
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1804 to 1 peers)
[S14] sending update (kind=head size=1806 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1806 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1801) from S11
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.621366)
[S14] loaded HEAD from S11 (vec_in norm=1.621366)
[S14] cosine check vs S11: cos=0.9936
[S14] BUFFERED delta from S11 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1802) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.539107)
[S11] loaded HEAD from S6 (vec_in norm=1.539107)
[S11] cosine check vs S6: cos=-0.0528
[S11] DROPPED delta from S6 (cos=-0.0528 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1800) from S2
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.590142)
[S8] loaded HEAD from S2 (vec_in norm=1.590142)
[S8] cosine check vs S2: cos=-0.0090
[S8] DROPPED delta from S2 (cos=-0.0090 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1795) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=0.884564)
[S17] loaded HEAD from S8 (vec_in norm=0.884564)
[S17] cosine check vs S8: cos=-0.0714
[S17] DROPPED delta from S8 (cos=-0.0714 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1798) from S7
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.585865)
[S10] loaded HEAD from S7 (vec_in norm=1.585865)
[S10] cosine check vs S7: cos=0.9833
[S10] BUFFERED delta from S7 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1797) from S4
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.750845)
[S9] loaded HEAD from S4 (vec_in norm=1.750845)
[S9] cosine check vs S4: cos=-0.0590
[S9] DROPPED delta from S4 (cos=-0.0590 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1804) from S15
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.298873)
[S16] loaded HEAD from S15 (vec_in norm=1.298873)
[S16] cosine check vs S15: cos=0.6394
[S16] BUFFERED delta from S15 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1806) from S14
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.559679)
[S4] loaded HEAD from S14 (vec_in norm=1.559679)
[S4] cosine check vs S14: cos=-0.1018
[S4] DROPPED delta from S14 (cos=-0.1018 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1806) from S3
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.835866)
[S4] loaded HEAD from S3 (vec_in norm=1.835866)
[S4] cosine check vs S3: cos=0.9823
[S4] BUFFERED delta from S3 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:37110
[S17] sending update (kind=head size=1800 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1800) from S17
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.443936)
[S9] loaded HEAD from S17 (vec_in norm=1.443936)
[S9] cosine check vs S17: cos=-0.0956
[S9] DROPPED delta from S17 (cos=-0.0956 < 0.0)
[S16] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1801) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.468565)
[S9] loaded HEAD from S5 (vec_in norm=1.468565)
[S9] cosine check vs S5: cos=-0.0901
[S9] DROPPED delta from S5 (cos=-0.0901 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1799) from S16
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.036473)
[S8] loaded HEAD from S16 (vec_in norm=1.036473)
[S8] cosine check vs S16: cos=0.7899
[S8] BUFFERED delta from S16 (total buffered=1)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=12 metric=0.6064 head_norm=1.593024
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.453391e-01
[S10] stored merged vector for next round verification (round=12)
[S10] DEBUG after merge:  round=12 metric=0.5959 head_norm=1.582790 delta_norm=0.145339
[S10] aggregate: ROLLBACK (f1_val pre=0.606 post=0.596 tol_abs=0.005 tol_rel=0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=12 metric=0.4032 head_norm=0.884564
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.195144e-01
[S8] stored merged vector for next round verification (round=12)
[S8] DEBUG after merge:  round=12 metric=0.3729 head_norm=0.908997 delta_norm=0.319514
[S8] aggregate: ROLLBACK (f1_val pre=0.403 post=0.373 tol_abs=0.005 tol_rel=0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=12 metric=0.6654 head_norm=1.750845
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.739571e-01
[S4] stored merged vector for next round verification (round=12)
[S4] DEBUG after merge:  round=12 metric=0.6653 head_norm=1.785404 delta_norm=0.173957
[S4] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=12 metric=0.7016 head_norm=1.559679
[S14] _apply_head_vector_avg (torch): Δ‖w‖=9.498928e-02
[S14] stored merged vector for next round verification (round=12)
[S14] DEBUG after merge:  round=12 metric=0.7021 head_norm=1.587983 delta_norm=0.094989
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=12 metric=0.8325 head_norm=1.036473
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.098377e-01
[S16] stored merged vector for next round verification (round=12)
[S16] DEBUG after merge:  round=12 metric=0.4637 head_norm=1.058650 delta_norm=0.509838
[S16] aggregate: ROLLBACK (f1_val pre=0.832 post=0.464 tol_abs=0.005 tol_rel=0.0)
[S2] START round=13 head_norm_before_train=1.590142 (no previous merge yet)
[S2] round=13 local utility u=0.000000 metrics={'f1_val': 0.6991496675670532, 'auprc': 0.9892512917095095, 'loss_val': 0.3037002267285705, 'psi': 0.8151903172240358}-{'f1_val': 0.7009533202285976, 'auprc': 0.9918695620429401, 'loss_val': 0.312472296763164, 'psi': 0.8173198169543345}
[S3] START round=13 head_norm_before_train=1.835866 (no previous merge yet)
[S3] round=13 local utility u=0.000000 metrics={'f1_val': 0.9602765867299603, 'auprc': 0.9985040538054611, 'loss_val': 0.10989148949460067, 'psi': 0.9755675735601607}-{'f1_val': 0.9971149325810758, 'auprc': 0.9985651041195076, 'loss_val': 0.09336077358654221, 'psi': 0.9976950011964485}
[S4] START round=13 head_norm_before_train=1.785404 cos_to_last_merge=1.0000 (last merge round=12)
[S4] round=13 local utility u=0.209410 metrics={'f1_val': 0.6673489312647525, 'auprc': 0.9322945247991499, 'loss_val': 0.449377111515128, 'psi': 0.7733271686785115}-{'f1_val': 0.66543337398187, 'auprc': 0.7993684906933891, 'loss_val': 0.45792568091838987, 'psi': 0.7190074206664776}
[S5] START round=13 head_norm_before_train=1.468565 cos_to_last_merge=0.8381 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.838
[S5] round=13 local utility u=0.000000 metrics={'f1_val': 0.6319671719772976, 'auprc': 0.841071359113297, 'loss_val': 0.45710161579961883, 'psi': 0.7156088468316973}-{'f1_val': 0.7006083926626743, 'auprc': 0.9895255877838834, 'loss_val': 0.2510159110979164, 'psi': 0.816175270711158}
[S6] START round=13 head_norm_before_train=1.539107 (no previous merge yet)
[S6] round=13 local utility u=0.625144 metrics={'f1_val': 0.912745598691898, 'auprc': 0.9559666477478685, 'loss_val': 0.3439247243338235, 'psi': 0.9300340183142861}-{'f1_val': 0.7070152481968857, 'auprc': 0.9529590861355861, 'loss_val': 0.3508072251769301, 'psi': 0.8053927833723659}
[S7] START round=13 head_norm_before_train=1.585865 (no previous merge yet)
[S7] round=13 local utility u=0.000000 metrics={'f1_val': 0.6065649227099001, 'auprc': 0.7875858708067289, 'loss_val': 0.669436238101636, 'psi': 0.6789733019486317}-{'f1_val': 0.6162311185342132, 'auprc': 0.7926321581383986, 'loss_val': 0.6429246547748181, 'psi': 0.6867915343758874}
[S8] START round=13 head_norm_before_train=0.908997 cos_to_last_merge=1.0000 (last merge round=12)
[S8] round=13 local utility u=0.808167 metrics={'f1_val': 0.7011436638604759, 'auprc': 0.8914433756898926, 'loss_val': 0.6069267769961673, 'psi': 0.7772635485922426}-{'f1_val': 0.40315385759383704, 'auprc': 0.9636848863162786, 'loss_val': 0.6520458064521615, 'psi': 0.6273662690828137}
[S9] START round=13 head_norm_before_train=1.853100 (no previous merge yet)
[S9] round=13 local utility u=0.026167 metrics={'f1_val': 0.9962748907591257, 'auprc': 0.9986308305946439, 'loss_val': 0.03032889411778773, 'psi': 0.997217266693333}-{'f1_val': 0.9899766087340214, 'auprc': 0.9996019954582922, 'loss_val': 0.04778658455606983, 'psi': 0.9938267634237297}
[S10] START round=13 head_norm_before_train=1.582790 cos_to_last_merge=1.0000 (last merge round=12)
[S10] round=13 local utility u=0.000000 metrics={'f1_val': 0.5786076576508145, 'auprc': 0.9428570837339767, 'loss_val': 0.5849409740100635, 'psi': 0.7243074280840793}-{'f1_val': 0.606382293777403, 'auprc': 0.9352169513831785, 'loss_val': 0.5639755331149199, 'psi': 0.7379161568197132}
[S11] START round=13 head_norm_before_train=1.621366 (no previous merge yet)
[S11] round=13 local utility u=0.000000 metrics={'f1_val': 0.9570238282507917, 'auprc': 0.9922954270572338, 'loss_val': 0.19969110431365733, 'psi': 0.9711324677733686}-{'f1_val': 0.9971362493929642, 'auprc': 0.9983119715797565, 'loss_val': 0.18239498203382903, 'psi': 0.9976065382676811}
[S13] START round=13 head_norm_before_train=1.802837 cos_to_last_merge=0.9997 (last merge round=11)
[S13] round=13 local utility u=0.000000 metrics={'f1_val': 0.37693945991058025, 'auprc': 0.5549376557783933, 'loss_val': 0.947672677382455, 'psi': 0.44813873825770545}-{'f1_val': 0.6069169712657211, 'auprc': 0.7169554111650238, 'loss_val': 0.7164922789178505, 'psi': 0.6509323472254421}
[S14] START round=13 head_norm_before_train=1.587983 cos_to_last_merge=1.0000 (last merge round=12)
[S14] round=13 local utility u=0.010894 metrics={'f1_val': 0.6998844597033875, 'auprc': 0.9957270801840925, 'loss_val': 0.4958003585053519, 'psi': 0.8182215078956696}-{'f1_val': 0.701576189693488, 'auprc': 0.9978540199902399, 'loss_val': 0.5341187236005626, 'psi': 0.8200873218121888}
[S15] START round=13 head_norm_before_train=1.298873 cos_to_last_merge=0.8678 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.868
[S15] round=13 local utility u=0.000000 metrics={'f1_val': 0.694891403284773, 'auprc': 0.9767246274045711, 'loss_val': 0.36596730773482955, 'psi': 0.8076246929326922}-{'f1_val': 0.6944318264815387, 'auprc': 0.9870950362074935, 'loss_val': 0.325234159913436, 'psi': 0.8114971103719206}
[S16] START round=13 head_norm_before_train=1.058650 cos_to_last_merge=1.0000 (last merge round=12)
[S16] round=13 local utility u=0.000000 metrics={'f1_val': 0.7284629813214007, 'auprc': 0.9811445979132907, 'loss_val': 0.6084844073866167, 'psi': 0.8295356279581567}-{'f1_val': 0.8324513767800221, 'auprc': 0.9351509695739655, 'loss_val': 0.6802597064522053, 'psi': 0.8735312138975995}
[S17] START round=13 head_norm_before_train=1.443936 (no previous merge yet)
[S17] round=13 local utility u=0.702336 metrics={'f1_val': 0.5505906538869481, 'auprc': 0.8500769084475777, 'loss_val': 0.8984892388064426, 'psi': 0.6703851557111999}-{'f1_val': 0.35302995561043005, 'auprc': 0.7832020338533536, 'loss_val': 0.9171717024164928, 'psi': 0.5250987869075995}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:37110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:37104
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] → sending delta(kind=head bytes=1805) to S11@127.0.0.1:37112
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:37117
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:37113
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1805 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1796) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=0.960331)
[S17] loaded HEAD from S8 (vec_in norm=0.960331)
[S17] cosine check vs S8: cos=-0.0835
[S17] DROPPED delta from S8 (cos=-0.0835 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1802) from S14
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.611169)
[S4] loaded HEAD from S14 (vec_in norm=1.611169)
[S4] cosine check vs S14: cos=-0.1036
[S4] DROPPED delta from S14 (cos=-0.1036 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1798) from S9
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.882221)
[S13] loaded HEAD from S9 (vec_in norm=1.882221)
[S13] cosine check vs S9: cos=0.9929
[S13] BUFFERED delta from S9 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1805) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.572746)
[S11] loaded HEAD from S6 (vec_in norm=1.572746)
[S11] cosine check vs S6: cos=-0.0570
[S11] DROPPED delta from S6 (cos=-0.0570 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:37110
[S17] sending update (kind=head size=1800 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1800) from S17
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.456385)
[S9] loaded HEAD from S17 (vec_in norm=1.456385)
[S9] cosine check vs S17: cos=-0.0947
[S9] DROPPED delta from S17 (cos=-0.0947 < 0.0)
[S4] sending update (kind=head size=1803 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1803) from S4
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.809574)
[S9] loaded HEAD from S4 (vec_in norm=1.809574)
[S9] cosine check vs S4: cos=-0.0567
[S9] DROPPED delta from S4 (cos=-0.0567 < 0.0)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=13 metric=0.3769 head_norm=1.822242
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.143190e-01
[S13] stored merged vector for next round verification (round=13)
[S13] DEBUG after merge:  round=13 metric=0.3716 head_norm=1.848943 delta_norm=0.114319
[S13] aggregate: ROLLBACK (f1_val pre=0.377 post=0.372 tol_abs=0.005 tol_rel=0.0)
[S2] START round=14 head_norm_before_train=1.628085 (no previous merge yet)
[S2] round=14 local utility u=0.017751 metrics={'f1_val': 0.7007729058908991, 'auprc': 0.989934520430923, 'loss_val': 0.2799872565187081, 'psi': 0.8164375517069087}-{'f1_val': 0.6991496675670532, 'auprc': 0.9892512917095095, 'loss_val': 0.3037002267285705, 'psi': 0.8151903172240358}
[S3] START round=14 head_norm_before_train=1.864895 (no previous merge yet)
[S3] round=14 local utility u=0.000000 metrics={'f1_val': 0.8173668290123102, 'auprc': 0.9991244621689093, 'loss_val': 0.2907735281802281, 'psi': 0.8900698822749498}-{'f1_val': 0.9602765867299603, 'auprc': 0.9985040538054611, 'loss_val': 0.10989148949460067, 'psi': 0.9755675735601607}
[S4] START round=14 head_norm_before_train=1.809574 cos_to_last_merge=0.9993 (last merge round=12)
[S4] round=14 local utility u=0.895658 metrics={'f1_val': 0.9537650296856558, 'auprc': 0.9518499902269378, 'loss_val': 0.43522457188808295, 'psi': 0.9529990139021686}-{'f1_val': 0.6673489312647525, 'auprc': 0.9322945247991499, 'loss_val': 0.449377111515128, 'psi': 0.7733271686785115}
[S5] START round=14 head_norm_before_train=1.504713 cos_to_last_merge=0.8304 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.830
[S5] round=14 local utility u=0.000000 metrics={'f1_val': 0.6088848304891639, 'auprc': 0.8311016646848665, 'loss_val': 0.5270398245858116, 'psi': 0.6977715641674449}-{'f1_val': 0.6319671719772976, 'auprc': 0.841071359113297, 'loss_val': 0.45710161579961883, 'psi': 0.7156088468316973}
[S6] START round=14 head_norm_before_train=1.572746 (no previous merge yet)
[S6] round=14 local utility u=0.000000 metrics={'f1_val': 0.8213793047599236, 'auprc': 0.949339189359232, 'loss_val': 0.3863200418075062, 'psi': 0.872563258599647}-{'f1_val': 0.912745598691898, 'auprc': 0.9559666477478685, 'loss_val': 0.3439247243338235, 'psi': 0.9300340183142861}
[S7] START round=14 head_norm_before_train=1.605734 (no previous merge yet)
[S7] round=14 local utility u=0.000000 metrics={'f1_val': 0.5892649945506386, 'auprc': 0.7886374913406752, 'loss_val': 0.6841481067353513, 'psi': 0.6690139932666532}-{'f1_val': 0.6065649227099001, 'auprc': 0.7875858708067289, 'loss_val': 0.669436238101636, 'psi': 0.6789733019486317}
[S8] START round=14 head_norm_before_train=0.960331 cos_to_last_merge=0.9920 (last merge round=12)
[S8] round=14 local utility u=0.000000 metrics={'f1_val': 0.7142391053978291, 'auprc': 0.7736642501811773, 'loss_val': 0.6408407863344773, 'psi': 0.7380091633111685}-{'f1_val': 0.7011436638604759, 'auprc': 0.8914433756898926, 'loss_val': 0.6069267769961673, 'psi': 0.7772635485922426}
[S9] START round=14 head_norm_before_train=1.882221 (no previous merge yet)
[S9] round=14 local utility u=0.002602 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9995769898182323, 'loss_val': 0.027939267901117268, 'psi': 0.9975934133655366}-{'f1_val': 0.9962748907591257, 'auprc': 0.9986308305946439, 'loss_val': 0.03032889411778773, 'psi': 0.997217266693333}
[S10] START round=14 head_norm_before_train=1.622459 cos_to_last_merge=0.9993 (last merge round=12)
[S10] round=14 local utility u=0.331917 metrics={'f1_val': 0.6383171200305251, 'auprc': 0.9865136080095662, 'loss_val': 0.41033410038971085, 'psi': 0.7775957152221415}-{'f1_val': 0.5786076576508145, 'auprc': 0.9428570837339767, 'loss_val': 0.5849409740100635, 'psi': 0.7243074280840793}
[S11] START round=14 head_norm_before_train=1.661770 (no previous merge yet)
[S11] round=14 local utility u=0.177661 metrics={'f1_val': 0.9966988539245482, 'auprc': 0.9980866468350968, 'loss_val': 0.09979242644641047, 'psi': 0.9972539710887676}-{'f1_val': 0.9570238282507917, 'auprc': 0.9922954270572338, 'loss_val': 0.19969110431365733, 'psi': 0.9711324677733686}
[S13] START round=14 head_norm_before_train=1.848943 cos_to_last_merge=1.0000 (last merge round=13)
[S13] round=14 local utility u=0.898259 metrics={'f1_val': 0.5694194246707294, 'auprc': 0.7079089063290441, 'loss_val': 0.7649473644120015, 'psi': 0.6248152173340553}-{'f1_val': 0.37693945991058025, 'auprc': 0.5549376557783933, 'loss_val': 0.947672677382455, 'psi': 0.44813873825770545}
[S14] START round=14 head_norm_before_train=1.611169 cos_to_last_merge=0.9994 (last merge round=12)
[S14] round=14 local utility u=0.072998 metrics={'f1_val': 0.7018171778232243, 'auprc': 0.9971282098324905, 'loss_val': 0.3656032060576744, 'psi': 0.8199415906269307}-{'f1_val': 0.6998844597033875, 'auprc': 0.9957270801840925, 'loss_val': 0.4958003585053519, 'psi': 0.8182215078956696}
[S15] START round=14 head_norm_before_train=1.349311 cos_to_last_merge=0.8551 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.855
[S15] round=14 local utility u=0.073344 metrics={'f1_val': 0.6970542551640937, 'auprc': 0.9869639630028675, 'loss_val': 0.26297349477501875, 'psi': 0.8130181382996032}-{'f1_val': 0.694891403284773, 'auprc': 0.9767246274045711, 'loss_val': 0.36596730773482955, 'psi': 0.8076246929326922}
[S16] START round=14 head_norm_before_train=1.101846 cos_to_last_merge=0.9971 (last merge round=12)
[S16] round=14 local utility u=0.791315 metrics={'f1_val': 0.9660783925457931, 'auprc': 0.993259050337423, 'loss_val': 0.48788944471753354, 'psi': 0.9769506556624451}-{'f1_val': 0.7284629813214007, 'auprc': 0.9811445979132907, 'loss_val': 0.6084844073866167, 'psi': 0.8295356279581567}
[S17] START round=14 head_norm_before_train=1.456385 (no previous merge yet)
[S17] round=14 local utility u=0.000000 metrics={'f1_val': 0.3556872108188842, 'auprc': 0.834699563825505, 'loss_val': 0.9039304057514889, 'psi': 0.5472921520215326}-{'f1_val': 0.5505906538869481, 'auprc': 0.8500769084475777, 'loss_val': 0.8984892388064426, 'psi': 0.6703851557111999}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:37113
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:37109
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:37114
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:37116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S15] → sending delta(kind=head bytes=1809) to S16@127.0.0.1:37116
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:37110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] → sending delta(kind=head bytes=1805) to S4@127.0.0.1:37104
[S15] sending update (kind=head size=1809 to 1 peers)
[S13] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1804 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1805 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1801) from S9
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.909189)
[S13] loaded HEAD from S9 (vec_in norm=1.909189)
[S13] cosine check vs S9: cos=0.9966
[S13] BUFFERED delta from S9 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1799) from S2
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.660903)
[S8] loaded HEAD from S2 (vec_in norm=1.660903)
[S8] cosine check vs S2: cos=-0.0066
[S8] DROPPED delta from S2 (cos=-0.0066 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1797) from S4
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.832800)
[S9] loaded HEAD from S4 (vec_in norm=1.832800)
[S9] cosine check vs S4: cos=-0.0592
[S9] DROPPED delta from S4 (cos=-0.0592 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1809) from S15
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.388787)
[S16] loaded HEAD from S15 (vec_in norm=1.388787)
[S16] cosine check vs S15: cos=0.8900
[S16] BUFFERED delta from S15 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1804) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.658875)
[S14] loaded HEAD from S10 (vec_in norm=1.658875)
[S14] cosine check vs S10: cos=-0.1075
[S14] DROPPED delta from S10 (cos=-0.1075 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1803) from S13
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.864932)
[S16] loaded HEAD from S13 (vec_in norm=1.864932)
[S16] cosine check vs S13: cos=0.3352
[S16] BUFFERED delta from S13 (total buffered=2)
[S4] RECEIVED delta(kind=head bytes=1805) from S14
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.633809)
[S4] loaded HEAD from S14 (vec_in norm=1.633809)
[S4] cosine check vs S14: cos=-0.1013
[S4] DROPPED delta from S14 (cos=-0.1013 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:37109
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1801) from S16
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.150462)
[S8] loaded HEAD from S16 (vec_in norm=1.150462)
[S8] cosine check vs S16: cos=0.8317
[S8] BUFFERED delta from S16 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:37114
[S11] sending update (kind=head size=1798 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1798) from S11
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.697468)
[S14] loaded HEAD from S11 (vec_in norm=1.697468)
[S14] cosine check vs S11: cos=0.9919
[S14] BUFFERED delta from S11 (total buffered=1)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=14 metric=0.7142 head_norm=1.023921
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.211458e-01
[S8] stored merged vector for next round verification (round=14)
[S8] DEBUG after merge:  round=14 metric=0.7142 head_norm=1.040603 delta_norm=0.321146
[S8] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=14 metric=0.5694 head_norm=1.864932
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.094125e-02
[S13] stored merged vector for next round verification (round=14)
[S13] DEBUG after merge:  round=14 metric=0.5707 head_norm=1.885454 delta_norm=0.080941
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=14 metric=0.9661 head_norm=1.150462
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.381879e-01
[S16] stored merged vector for next round verification (round=14)
[S16] DEBUG after merge:  round=14 metric=0.9513 head_norm=1.088552 delta_norm=0.338188
[S16] aggregate: ROLLBACK (f1_val pre=0.966 post=0.951 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=14 metric=0.7018 head_norm=1.633809
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.103485e-01
[S14] stored merged vector for next round verification (round=14)
[S14] DEBUG after merge:  round=14 metric=0.7018 head_norm=1.662284 delta_norm=0.110349
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.660903 (no previous merge yet)
[S2] round=15 local utility u=0.000000 metrics={'f1_val': 0.7011337461190337, 'auprc': 0.9832791859631804, 'loss_val': 0.2732224244779132, 'psi': 0.8139919220566925}-{'f1_val': 0.7007729058908991, 'auprc': 0.989934520430923, 'loss_val': 0.2799872565187081, 'psi': 0.8164375517069087}
[S3] START round=15 head_norm_before_train=1.891917 (no previous merge yet)
[S3] round=15 local utility u=0.556525 metrics={'f1_val': 0.9675380250206906, 'auprc': 0.9986915079484044, 'loss_val': 0.07745251788448648, 'psi': 0.9799994181917762}-{'f1_val': 0.8173668290123102, 'auprc': 0.9991244621689093, 'loss_val': 0.2907735281802281, 'psi': 0.8900698822749498}
[S4] START round=15 head_norm_before_train=1.832800 cos_to_last_merge=0.9977 (last merge round=12)
[S4] round=15 local utility u=0.000000 metrics={'f1_val': 0.8019517114942087, 'auprc': 0.9371190551761165, 'loss_val': 0.3923471449219375, 'psi': 0.8560186489669719}-{'f1_val': 0.9537650296856558, 'auprc': 0.9518499902269378, 'loss_val': 0.43522457188808295, 'psi': 0.9529990139021686}
[S5] START round=15 head_norm_before_train=1.530760 cos_to_last_merge=0.8247 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.825
[S5] round=15 local utility u=0.421056 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.8662579507372594, 'loss_val': 0.3407385847300407, 'psi': 0.7668682158925084}-{'f1_val': 0.6088848304891639, 'auprc': 0.8311016646848665, 'loss_val': 0.5270398245858116, 'psi': 0.6977715641674449}
[S6] START round=15 head_norm_before_train=1.603341 (no previous merge yet)
[S6] round=15 local utility u=0.000000 metrics={'f1_val': 0.5862159117502305, 'auprc': 0.7623189298916894, 'loss_val': 0.6532548363778587, 'psi': 0.656657119006814}-{'f1_val': 0.8213793047599236, 'auprc': 0.949339189359232, 'loss_val': 0.3863200418075062, 'psi': 0.872563258599647}
[S7] START round=15 head_norm_before_train=1.628762 (no previous merge yet)
[S7] round=15 local utility u=0.545695 metrics={'f1_val': 0.6866177869853597, 'auprc': 0.8482703589642735, 'loss_val': 0.35577429712287884, 'psi': 0.7512788157769252}-{'f1_val': 0.5892649945506386, 'auprc': 0.7886374913406752, 'loss_val': 0.6841481067353513, 'psi': 0.6690139932666532}
[S8] START round=15 head_norm_before_train=1.040603 cos_to_last_merge=1.0000 (last merge round=14)
[S8] round=15 local utility u=1.000000 metrics={'f1_val': 0.9816607406496494, 'auprc': 0.9961387538433457, 'loss_val': 0.4443921229849982, 'psi': 0.9874519459271279}-{'f1_val': 0.7142391053978291, 'auprc': 0.7736642501811773, 'loss_val': 0.6408407863344773, 'psi': 0.7380091633111685}
[S9] START round=15 head_norm_before_train=1.909189 (no previous merge yet)
[S9] round=15 local utility u=0.000347 metrics={'f1_val': 0.9958601375429889, 'auprc': 0.9995731573330189, 'loss_val': 0.02476869030366996, 'psi': 0.9973453454590009}-{'f1_val': 0.9962710290637395, 'auprc': 0.9995769898182323, 'loss_val': 0.027939267901117268, 'psi': 0.9975934133655366}
[S10] START round=15 head_norm_before_train=1.658875 cos_to_last_merge=0.9977 (last merge round=12)
[S10] round=15 local utility u=0.037744 metrics={'f1_val': 0.6406058529184311, 'auprc': 0.9917543175009897, 'loss_val': 0.3643014187719305, 'psi': 0.7810652387514545}-{'f1_val': 0.6383171200305251, 'auprc': 0.9865136080095662, 'loss_val': 0.41033410038971085, 'psi': 0.7775957152221415}
[S11] START round=15 head_norm_before_train=1.697468 (no previous merge yet)
[S11] round=15 local utility u=0.000000 metrics={'f1_val': 0.9706922169803734, 'auprc': 0.998007002708677, 'loss_val': 0.10931473860188676, 'psi': 0.9816181312716948}-{'f1_val': 0.9966988539245482, 'auprc': 0.9980866468350968, 'loss_val': 0.09979242644641047, 'psi': 0.9972539710887676}
[S13] START round=15 head_norm_before_train=1.885454 cos_to_last_merge=1.0000 (last merge round=14)
[S13] round=15 local utility u=0.066461 metrics={'f1_val': 0.6024504513949374, 'auprc': 0.6666053425974773, 'loss_val': 0.7063002049438221, 'psi': 0.6281124078759533}-{'f1_val': 0.5694194246707294, 'auprc': 0.7079089063290441, 'loss_val': 0.7649473644120015, 'psi': 0.6248152173340553}
[S14] START round=15 head_norm_before_train=1.662284 cos_to_last_merge=1.0000 (last merge round=14)
[S14] round=15 local utility u=0.036197 metrics={'f1_val': 0.7022370829656733, 'auprc': 0.9971592122876407, 'loss_val': 0.29582183337529694, 'psi': 0.8202059346944603}-{'f1_val': 0.7018171778232243, 'auprc': 0.9971282098324905, 'loss_val': 0.3656032060576744, 'psi': 0.8199415906269307}
[S15] START round=15 head_norm_before_train=1.388787 cos_to_last_merge=0.8452 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.845
[S15] round=15 local utility u=0.362117 metrics={'f1_val': 0.8058825919544041, 'auprc': 0.9897186318307034, 'loss_val': 0.19997444338124942, 'psi': 0.8794170079049238}-{'f1_val': 0.6970542551640937, 'auprc': 0.9869639630028675, 'loss_val': 0.26297349477501875, 'psi': 0.8130181382996032}
[S16] START round=15 head_norm_before_train=1.088552 cos_to_last_merge=1.0000 (last merge round=14)
[S16] round=15 local utility u=0.000000 metrics={'f1_val': 0.9424355399309271, 'auprc': 0.9840287007460603, 'loss_val': 0.4399204365636422, 'psi': 0.9590728042569803}-{'f1_val': 0.9660783925457931, 'auprc': 0.993259050337423, 'loss_val': 0.48788944471753354, 'psi': 0.9769506556624451}
[S17] START round=15 head_norm_before_train=1.468798 (no previous merge yet)
[S17] round=15 local utility u=0.000000 metrics={'f1_val': 0.35418274328156274, 'auprc': 0.7635945602245879, 'loss_val': 0.9469656442349234, 'psi': 0.5179474700587728}-{'f1_val': 0.3556872108188842, 'auprc': 0.834699563825505, 'loss_val': 0.9039304057514889, 'psi': 0.5472921520215326}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:37113
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S7] → sending delta(kind=head bytes=1792) to S10@127.0.0.1:37111
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:37110
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:37114
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:37116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:37116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:37104
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S8] → sending delta(kind=head bytes=1792) to S17@127.0.0.1:37117
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:37104
[S3] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1792 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1792 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1792) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.083685)
[S17] loaded HEAD from S8 (vec_in norm=1.083685)
[S17] cosine check vs S8: cos=-0.0661
[S17] DROPPED delta from S8 (cos=-0.0661 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1798) from S9
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.935858)
[S13] loaded HEAD from S9 (vec_in norm=1.935858)
[S13] cosine check vs S9: cos=0.9982
[S13] BUFFERED delta from S9 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1797) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.552721)
[S9] loaded HEAD from S5 (vec_in norm=1.552721)
[S9] cosine check vs S5: cos=-0.0930
[S9] DROPPED delta from S5 (cos=-0.0930 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1800) from S13
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.899092)
[S16] loaded HEAD from S13 (vec_in norm=1.899092)
[S16] cosine check vs S13: cos=0.5856
[S16] BUFFERED delta from S13 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1802) from S15
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.423306)
[S16] loaded HEAD from S15 (vec_in norm=1.423306)
[S16] cosine check vs S15: cos=0.7516
[S16] BUFFERED delta from S15 (total buffered=2)
[S10] RECEIVED delta(kind=head bytes=1792) from S7
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.651625)
[S10] loaded HEAD from S7 (vec_in norm=1.651625)
[S10] cosine check vs S7: cos=0.9840
[S10] BUFFERED delta from S7 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1801) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.689387)
[S14] loaded HEAD from S10 (vec_in norm=1.689387)
[S14] cosine check vs S10: cos=-0.1061
[S14] DROPPED delta from S10 (cos=-0.1061 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1803) from S3
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.919833)
[S4] loaded HEAD from S3 (vec_in norm=1.919833)
[S4] cosine check vs S3: cos=0.9789
[S4] BUFFERED delta from S3 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1803) from S14
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.682843)
[S4] loaded HEAD from S14 (vec_in norm=1.682843)
[S4] cosine check vs S14: cos=-0.1022
[S4] DROPPED delta from S14 (cos=-0.1022 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] ⇄ pheromone p=0.241 → S11@127.0.0.1:37112
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=15 metric=0.8020 head_norm=1.855672
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.965161e-01
[S4] stored merged vector for next round verification (round=15)
[S4] DEBUG after merge:  round=15 metric=0.9509 head_norm=1.877770 delta_norm=0.196516
[S4] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.271 → S9@127.0.0.1:37110
[S2] ⇄ pheromone p=0.160 → S8@127.0.0.1:37109
[S5] ⇄ pheromone p=0.181 → S9@127.0.0.1:37110
[S9] ⇄ pheromone p=0.106 → S13@127.0.0.1:37113
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=15 metric=0.6406 head_norm=1.689387
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.506073e-01
[S10] stored merged vector for next round verification (round=15)
[S10] DEBUG after merge:  round=15 metric=0.6406 head_norm=1.663810 delta_norm=0.150607
[S10] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.254 → S14@127.0.0.1:37114
[S8] ⇄ pheromone p=0.396 → S17@127.0.0.1:37117
[S7] ⇄ pheromone p=0.255 → S10@127.0.0.1:37111
[S11] ⇄ pheromone p=0.208 → S14@127.0.0.1:37114
[S3] ⇄ pheromone p=0.288 → S4@127.0.0.1:37104
[S17] ⇄ pheromone p=0.176 → S9@127.0.0.1:37110
[S14] ⇄ pheromone p=0.228 → S4@127.0.0.1:37104
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=15 metric=0.6025 head_norm=1.899092
[S13] _apply_head_vector_avg (torch): Δ‖w‖=6.083880e-02
[S13] stored merged vector for next round verification (round=15)
[S13] DEBUG after merge:  round=15 metric=0.6027 head_norm=1.916598 delta_norm=0.060839
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.297 → S16@127.0.0.1:37116
[S15] ⇄ pheromone p=0.222 → S16@127.0.0.1:37116
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=15 metric=0.9424 head_norm=1.141433
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.877421e-01
[S16] stored merged vector for next round verification (round=15)
[S16] DEBUG after merge:  round=15 metric=0.9697 head_norm=1.131565 delta_norm=0.187742
[S16] aggregate: ACCEPT kept=['S13', 'S15'] (k=2/2) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.343 → S8@127.0.0.1:37109
[S2] START round=16 head_norm_before_train=1.690509 (no previous merge yet)
[S2] round=16 local utility u=0.000000 metrics={'f1_val': 0.7013141837391442, 'auprc': 0.9036234679141995, 'loss_val': 0.27379555017735846, 'psi': 0.7822378974091664}-{'f1_val': 0.7011337461190337, 'auprc': 0.9832791859631804, 'loss_val': 0.2732224244779132, 'psi': 0.8139919220566925}
[S3] START round=16 head_norm_before_train=1.919833 (no previous merge yet)
[S3] round=16 local utility u=0.018675 metrics={'f1_val': 0.972044775801435, 'auprc': 0.9985086038420619, 'loss_val': 0.06659486934637153, 'psi': 0.9826303070176858}-{'f1_val': 0.9675380250206906, 'auprc': 0.9986915079484044, 'loss_val': 0.07745251788448648, 'psi': 0.9799994181917762}
[S4] START round=16 head_norm_before_train=1.877770 cos_to_last_merge=1.0000 (last merge round=15)
[S4] round=16 local utility u=0.469422 metrics={'f1_val': 0.9431033827738917, 'auprc': 0.9612866027789093, 'loss_val': 0.37291575375840047, 'psi': 0.9503766707758987}-{'f1_val': 0.8019517114942087, 'auprc': 0.9371190551761165, 'loss_val': 0.3923471449219375, 'psi': 0.8560186489669719}
[S5] START round=16 head_norm_before_train=1.552721 cos_to_last_merge=0.8235 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.824
[S5] round=16 local utility u=0.271455 metrics={'f1_val': 0.7005797538498719, 'auprc': 0.9914515354553864, 'loss_val': 0.17323705188309588, 'psi': 0.8169284664920777}-{'f1_val': 0.7006083926626743, 'auprc': 0.8662579507372594, 'loss_val': 0.3407385847300407, 'psi': 0.7668682158925084}
[S6] START round=16 head_norm_before_train=1.629170 (no previous merge yet)
[S6] round=16 local utility u=1.000000 metrics={'f1_val': 0.9323998727965881, 'auprc': 0.9509481339760498, 'loss_val': 0.2539433364392528, 'psi': 0.9398191772683728}-{'f1_val': 0.5862159117502305, 'auprc': 0.7623189298916894, 'loss_val': 0.6532548363778587, 'psi': 0.656657119006814}
[S7] START round=16 head_norm_before_train=1.651625 (no previous merge yet)
[S7] round=16 local utility u=0.000000 metrics={'f1_val': 0.6778185897450826, 'auprc': 0.8304970669301094, 'loss_val': 0.38648645367263496, 'psi': 0.7388899806190933}-{'f1_val': 0.6866177869853597, 'auprc': 0.8482703589642735, 'loss_val': 0.35577429712287884, 'psi': 0.7512788157769252}
[S8] START round=16 head_norm_before_train=1.083685 cos_to_last_merge=0.9960 (last merge round=14)
[S8] round=16 local utility u=0.000000 metrics={'f1_val': 0.7270637703708642, 'auprc': 0.9918895817152561, 'loss_val': 0.3647054326374091, 'psi': 0.832994094908621}-{'f1_val': 0.9816607406496494, 'auprc': 0.9961387538433457, 'loss_val': 0.4443921229849982, 'psi': 0.9874519459271279}
[S9] START round=16 head_norm_before_train=1.935858 (no previous merge yet)
[S9] round=16 local utility u=0.000000 metrics={'f1_val': 0.9941897064172326, 'auprc': 0.9995804859218357, 'loss_val': 0.02693039004708673, 'psi': 0.9963460182190739}-{'f1_val': 0.9958601375429889, 'auprc': 0.9995731573330189, 'loss_val': 0.02476869030366996, 'psi': 0.9973453454590009}
[S10] START round=16 head_norm_before_train=1.663810 cos_to_last_merge=1.0000 (last merge round=15)
[S10] round=16 local utility u=0.117279 metrics={'f1_val': 0.6640403469331218, 'auprc': 0.996317538694588, 'loss_val': 0.2840407786940957, 'psi': 0.7969512236377083}-{'f1_val': 0.6406058529184311, 'auprc': 0.9917543175009897, 'loss_val': 0.3643014187719305, 'psi': 0.7810652387514545}
[S11] START round=16 head_norm_before_train=1.730515 (no previous merge yet)
[S11] round=16 local utility u=0.035824 metrics={'f1_val': 0.9794855094520599, 'auprc': 0.9980519152745028, 'loss_val': 0.09056108599985026, 'psi': 0.9869120717810371}-{'f1_val': 0.9706922169803734, 'auprc': 0.998007002708677, 'loss_val': 0.10931473860188676, 'psi': 0.9816181312716948}
[S13] START round=16 head_norm_before_train=1.916598 cos_to_last_merge=1.0000 (last merge round=15)
[S13] round=16 local utility u=0.000000 metrics={'f1_val': 0.5772393448205367, 'auprc': 0.545496136213659, 'loss_val': 0.8225475131674147, 'psi': 0.5645420613777856}-{'f1_val': 0.6024504513949374, 'auprc': 0.6666053425974773, 'loss_val': 0.7063002049438221, 'psi': 0.6281124078759533}
[S14] START round=16 head_norm_before_train=1.682843 cos_to_last_merge=0.9997 (last merge round=14)
[S14] round=16 local utility u=0.647910 metrics={'f1_val': 0.908590164215384, 'auprc': 0.9957265634064724, 'loss_val': 0.23382241151629504, 'psi': 0.9434447238918193}-{'f1_val': 0.7022370829656733, 'auprc': 0.9971592122876407, 'loss_val': 0.29582183337529694, 'psi': 0.8202059346944603}
[S15] START round=16 head_norm_before_train=1.423306 cos_to_last_merge=0.8366 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.837
[S15] round=16 local utility u=0.188801 metrics={'f1_val': 0.8736215820168116, 'auprc': 0.9838940385342941, 'loss_val': 0.21133226114394454, 'psi': 0.9177305646238046}-{'f1_val': 0.8058825919544041, 'auprc': 0.9897186318307034, 'loss_val': 0.19997444338124942, 'psi': 0.8794170079049238}
[S16] START round=16 head_norm_before_train=1.131565 cos_to_last_merge=1.0000 (last merge round=15)
[S16] round=16 local utility u=0.087553 metrics={'f1_val': 0.9603254907314976, 'auprc': 0.9899710903245849, 'loss_val': 0.3899811677848012, 'psi': 0.9721837305687326}-{'f1_val': 0.9424355399309271, 'auprc': 0.9840287007460603, 'loss_val': 0.4399204365636422, 'psi': 0.9590728042569803}
[S17] START round=16 head_norm_before_train=1.480364 (no previous merge yet)
[S17] round=16 local utility u=0.530762 metrics={'f1_val': 0.5190876077776836, 'auprc': 0.7947489307831139, 'loss_val': 0.9683333227461005, 'psi': 0.6293521369798558}-{'f1_val': 0.35418274328156274, 'auprc': 0.7635945602245879, 'loss_val': 0.9469656442349234, 'psi': 0.5179474700587728}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:37109
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:37114
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S14] → sending delta(kind=head bytes=1806) to S4@127.0.0.1:37104
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:37116
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:37114
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:37110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:37110
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S6] → sending delta(kind=head bytes=1806) to S11@127.0.0.1:37112
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:37104
[S6] sending update (kind=head size=1806 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1806 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1799) from S3
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.948372)
[S4] loaded HEAD from S3 (vec_in norm=1.948372)
[S4] cosine check vs S3: cos=0.9917
[S4] BUFFERED delta from S3 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1806) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.646379)
[S11] loaded HEAD from S6 (vec_in norm=1.646379)
[S11] cosine check vs S6: cos=-0.0636
[S11] DROPPED delta from S6 (cos=-0.0636 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1806) from S14
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.705976)
[S4] loaded HEAD from S14 (vec_in norm=1.705976)
[S4] cosine check vs S14: cos=-0.0993
[S4] DROPPED delta from S14 (cos=-0.0993 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1801) from S4
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.898115)
[S9] loaded HEAD from S4 (vec_in norm=1.898115)
[S9] cosine check vs S4: cos=-0.0579
[S9] DROPPED delta from S4 (cos=-0.0579 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1803) from S15
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.453463)
[S16] loaded HEAD from S15 (vec_in norm=1.453463)
[S16] cosine check vs S15: cos=0.6652
[S16] BUFFERED delta from S15 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1800) from S11
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.760889)
[S14] loaded HEAD from S11 (vec_in norm=1.760889)
[S14] cosine check vs S11: cos=0.9926
[S14] BUFFERED delta from S11 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1797) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.688639)
[S14] loaded HEAD from S10 (vec_in norm=1.688639)
[S14] cosine check vs S10: cos=-0.1018
[S14] DROPPED delta from S10 (cos=-0.1018 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1801) from S16
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.181374)
[S8] loaded HEAD from S16 (vec_in norm=1.181374)
[S8] cosine check vs S16: cos=0.8864
[S8] BUFFERED delta from S16 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:37110
[S5] sending update (kind=head size=1802 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1802) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.572027)
[S9] loaded HEAD from S5 (vec_in norm=1.572027)
[S9] cosine check vs S5: cos=-0.0944
[S9] DROPPED delta from S5 (cos=-0.0944 < 0.0)
[S17] sending update (kind=head size=1800 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1800) from S17
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.493064)
[S9] loaded HEAD from S17 (vec_in norm=1.493064)
[S9] cosine check vs S17: cos=-0.0884
[S9] DROPPED delta from S17 (cos=-0.0884 < 0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=16 metric=0.7271 head_norm=1.137538
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.771716e-01
[S8] stored merged vector for next round verification (round=16)
[S8] DEBUG after merge:  round=16 metric=0.9481 head_norm=1.126052 delta_norm=0.277172
[S8] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=16 metric=0.9431 head_norm=1.898115
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.267510e-01
[S4] stored merged vector for next round verification (round=16)
[S4] DEBUG after merge:  round=16 metric=0.9406 head_norm=1.919227 delta_norm=0.126751
[S4] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=16 metric=0.9603 head_norm=1.181374
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.530944e-01
[S16] stored merged vector for next round verification (round=16)
[S16] DEBUG after merge:  round=16 metric=0.9815 head_norm=1.203406 delta_norm=0.553094
[S16] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=16 metric=0.9086 head_norm=1.705976
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.086068e-01
[S14] stored merged vector for next round verification (round=16)
[S14] DEBUG after merge:  round=16 metric=0.7021 head_norm=1.730245 delta_norm=0.108607
[S14] aggregate: ROLLBACK (f1_val pre=0.909 post=0.702 tol_abs=0.005 tol_rel=0.0)
[S2] START round=17 head_norm_before_train=1.711158 (no previous merge yet)
[S2] round=17 local utility u=0.096428 metrics={'f1_val': 0.7012347841865968, 'auprc': 0.9641980143391643, 'loss_val': 0.2621873339415225, 'psi': 0.8064200762476238}-{'f1_val': 0.7013141837391442, 'auprc': 0.9036234679141995, 'loss_val': 0.27379555017735846, 'psi': 0.7822378974091664}
[S3] START round=17 head_norm_before_train=1.948372 (no previous merge yet)
[S3] round=17 local utility u=0.000000 metrics={'f1_val': 0.9687333210888078, 'auprc': 0.9986203126237122, 'loss_val': 0.1023493664983032, 'psi': 0.9806881177027695}-{'f1_val': 0.972044775801435, 'auprc': 0.9985086038420619, 'loss_val': 0.06659486934637153, 'psi': 0.9826303070176858}
[S4] START round=17 head_norm_before_train=1.919227 cos_to_last_merge=1.0000 (last merge round=16)
[S4] round=17 local utility u=0.031688 metrics={'f1_val': 0.9456085364899958, 'auprc': 0.9642576291585256, 'loss_val': 0.3334846808328543, 'psi': 0.9530681735574078}-{'f1_val': 0.9431033827738917, 'auprc': 0.9612866027789093, 'loss_val': 0.37291575375840047, 'psi': 0.9503766707758987}
[S5] START round=17 head_norm_before_train=1.572027 cos_to_last_merge=0.8239 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.824
[S5] round=17 local utility u=0.000000 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.986900786067075, 'loss_val': 0.2735814514601014, 'psi': 0.8151253500244346}-{'f1_val': 0.7005797538498719, 'auprc': 0.9914515354553864, 'loss_val': 0.17323705188309588, 'psi': 0.8169284664920777}
[S6] START round=17 head_norm_before_train=1.646379 (no previous merge yet)
[S6] round=17 local utility u=0.000000 metrics={'f1_val': 0.5997350315207738, 'auprc': 0.8193865594975233, 'loss_val': 0.6350516142439578, 'psi': 0.6875956427114736}-{'f1_val': 0.9323998727965881, 'auprc': 0.9509481339760498, 'loss_val': 0.2539433364392528, 'psi': 0.9398191772683728}
[S7] START round=17 head_norm_before_train=1.665336 (no previous merge yet)
[S7] round=17 local utility u=0.000000 metrics={'f1_val': 0.6699503191375248, 'auprc': 0.8190408659212037, 'loss_val': 0.4148764504553254, 'psi': 0.7295865378509964}-{'f1_val': 0.6778185897450826, 'auprc': 0.8304970669301094, 'loss_val': 0.38648645367263496, 'psi': 0.7388899806190933}
[S8] START round=17 head_norm_before_train=1.126052 cos_to_last_merge=1.0000 (last merge round=16)
[S8] round=17 local utility u=0.833236 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9973891442957441, 'loss_val': 0.3295671549048341, 'psi': 0.9966775197583894}-{'f1_val': 0.7270637703708642, 'auprc': 0.9918895817152561, 'loss_val': 0.3647054326374091, 'psi': 0.832994094908621}
[S9] START round=17 head_norm_before_train=1.960068 (no previous merge yet)
[S9] round=17 local utility u=0.006948 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9969395682422373, 'loss_val': 0.02259069922918363, 'psi': 0.9970375748041806}-{'f1_val': 0.9941897064172326, 'auprc': 0.9995804859218357, 'loss_val': 0.02693039004708673, 'psi': 0.9963460182190739}
[S10] START round=17 head_norm_before_train=1.688639 cos_to_last_merge=0.9995 (last merge round=15)
[S10] round=17 local utility u=0.757468 metrics={'f1_val': 0.915421915987214, 'auprc': 0.9957253476722665, 'loss_val': 0.2756178462769094, 'psi': 0.947543288661235}-{'f1_val': 0.6640403469331218, 'auprc': 0.996317538694588, 'loss_val': 0.2840407786940957, 'psi': 0.7969512236377083}
[S11] START round=17 head_norm_before_train=1.760889 (no previous merge yet)
[S11] round=17 local utility u=0.000000 metrics={'f1_val': 0.956159783151826, 'auprc': 0.9980096784372434, 'loss_val': 0.1549193163407268, 'psi': 0.972899741265993}-{'f1_val': 0.9794855094520599, 'auprc': 0.9980519152745028, 'loss_val': 0.09056108599985026, 'psi': 0.9869120717810371}
[S13] START round=17 head_norm_before_train=1.931718 cos_to_last_merge=0.9998 (last merge round=15)
[S13] round=17 local utility u=0.147166 metrics={'f1_val': 0.5990889255880241, 'auprc': 0.5615989986647821, 'loss_val': 0.7076209093392775, 'psi': 0.5840929548187273}-{'f1_val': 0.5772393448205367, 'auprc': 0.545496136213659, 'loss_val': 0.8225475131674147, 'psi': 0.5645420613777856}
[S14] START round=17 head_norm_before_train=1.730245 cos_to_last_merge=1.0000 (last merge round=16)
[S14] round=17 local utility u=0.232516 metrics={'f1_val': 0.9815530889479538, 'auprc': 0.9970680828137378, 'loss_val': 0.2105915332810662, 'psi': 0.9877590864942675}-{'f1_val': 0.908590164215384, 'auprc': 0.9957265634064724, 'loss_val': 0.23382241151629504, 'psi': 0.9434447238918193}
[S15] START round=17 head_norm_before_train=1.453463 cos_to_last_merge=0.8290 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.829
[S15] round=17 local utility u=0.000000 metrics={'f1_val': 0.8244265557155238, 'auprc': 0.9891325757871018, 'loss_val': 0.17608055367235534, 'psi': 0.890308963744155}-{'f1_val': 0.8736215820168116, 'auprc': 0.9838940385342941, 'loss_val': 0.21133226114394454, 'psi': 0.9177305646238046}
[S16] START round=17 head_norm_before_train=1.203406 cos_to_last_merge=1.0000 (last merge round=16)
[S16] round=17 local utility u=0.000000 metrics={'f1_val': 0.9378555584826543, 'auprc': 0.9920306845418667, 'loss_val': 0.387512453155212, 'psi': 0.9595256089063393}-{'f1_val': 0.9603254907314976, 'auprc': 0.9899710903245849, 'loss_val': 0.3899811677848012, 'psi': 0.9721837305687326}
[S17] START round=17 head_norm_before_train=1.493064 (no previous merge yet)
[S17] round=17 local utility u=0.000000 metrics={'f1_val': 0.32690693966602336, 'auprc': 0.7440334198304992, 'loss_val': 1.1943354608572783, 'psi': 0.4937575317318137}-{'f1_val': 0.5190876077776836, 'auprc': 0.7947489307831139, 'loss_val': 0.9683333227461005, 'psi': 0.6293521369798558}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S14] → sending delta(kind=head bytes=1807) to S4@127.0.0.1:37104
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] → sending delta(kind=head bytes=1805) to S9@127.0.0.1:37110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:37117
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:37113
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:37116
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:37114
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:37109
[S13] sending update (kind=head size=1795 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1805 to 1 peers)
[S14] sending update (kind=head size=1807 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1797) from S9
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.976408)
[S13] loaded HEAD from S9 (vec_in norm=1.976408)
[S13] cosine check vs S9: cos=0.9975
[S13] BUFFERED delta from S9 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1807) from S14
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.756893)
[S4] loaded HEAD from S14 (vec_in norm=1.756893)
[S4] cosine check vs S14: cos=-0.0995
[S4] DROPPED delta from S14 (cos=-0.0995 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1800) from S2
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.731208)
[S8] loaded HEAD from S2 (vec_in norm=1.731208)
[S8] cosine check vs S2: cos=-0.0029
[S8] DROPPED delta from S2 (cos=-0.0029 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1798) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.170833)
[S17] loaded HEAD from S8 (vec_in norm=1.170833)
[S17] cosine check vs S8: cos=-0.0655
[S17] DROPPED delta from S8 (cos=-0.0655 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1805) from S4
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.937884)
[S9] loaded HEAD from S4 (vec_in norm=1.937884)
[S9] cosine check vs S4: cos=-0.0560
[S9] DROPPED delta from S4 (cos=-0.0560 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1803) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.709994)
[S14] loaded HEAD from S10 (vec_in norm=1.709994)
[S14] cosine check vs S10: cos=-0.0970
[S14] DROPPED delta from S10 (cos=-0.0970 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1795) from S13
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.949975)
[S16] loaded HEAD from S13 (vec_in norm=1.949975)
[S16] cosine check vs S13: cos=0.3119
[S16] BUFFERED delta from S13 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=17 metric=0.5991 head_norm=1.949975
[S13] _apply_head_vector_avg (torch): Δ‖w‖=7.062674e-02
[S13] stored merged vector for next round verification (round=17)
[S13] DEBUG after merge:  round=17 metric=0.6001 head_norm=1.961965 delta_norm=0.070627
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=17 metric=0.9379 head_norm=1.249986
[S16] _apply_head_vector_avg (torch): Δ‖w‖=9.803755e-01
[S16] stored merged vector for next round verification (round=17)
[S16] DEBUG after merge:  round=17 metric=0.9118 head_norm=1.311982 delta_norm=0.980376
[S16] aggregate: ROLLBACK (f1_val pre=0.938 post=0.912 tol_abs=0.005 tol_rel=0.0)
[S2] START round=18 head_norm_before_train=1.731208 (no previous merge yet)
[S2] round=18 local utility u=0.022587 metrics={'f1_val': 0.7010542679632784, 'auprc': 0.9763077013081444, 'loss_val': 0.2522589094965795, 'psi': 0.8111556413012249}-{'f1_val': 0.7012347841865968, 'auprc': 0.9641980143391643, 'loss_val': 0.2621873339415225, 'psi': 0.8064200762476238}
[S3] START round=18 head_norm_before_train=1.975632 (no previous merge yet)
[S3] round=18 local utility u=0.000000 metrics={'f1_val': 0.9607804860280988, 'auprc': 0.9985244089059553, 'loss_val': 0.0888790364603166, 'psi': 0.9758780551792414}-{'f1_val': 0.9687333210888078, 'auprc': 0.9986203126237122, 'loss_val': 0.1023493664983032, 'psi': 0.9806881177027695}
[S4] START round=18 head_norm_before_train=1.937884 cos_to_last_merge=0.9997 (last merge round=16)
[S4] round=18 local utility u=0.000000 metrics={'f1_val': 0.9383981831014401, 'auprc': 0.9515850403194951, 'loss_val': 0.3415614952222237, 'psi': 0.943672925988662}-{'f1_val': 0.9456085364899958, 'auprc': 0.9642576291585256, 'loss_val': 0.3334846808328543, 'psi': 0.9530681735574078}
[S5] START round=18 head_norm_before_train=1.583673 cos_to_last_merge=0.8241 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.824
[S5] round=18 local utility u=0.000000 metrics={'f1_val': 0.7005793910907778, 'auprc': 0.9766949037305039, 'loss_val': 0.2828798284152419, 'psi': 0.8110255961466682}-{'f1_val': 0.7006083926626743, 'auprc': 0.986900786067075, 'loss_val': 0.2735814514601014, 'psi': 0.8151253500244346}
[S6] START round=18 head_norm_before_train=1.660961 (no previous merge yet)
[S6] round=18 local utility u=0.948724 metrics={'f1_val': 0.8018276139668432, 'auprc': 0.9456984399436513, 'loss_val': 0.3290954882311816, 'psi': 0.8593759443575664}-{'f1_val': 0.5997350315207738, 'auprc': 0.8193865594975233, 'loss_val': 0.6350516142439578, 'psi': 0.6875956427114736}
[S7] START round=18 head_norm_before_train=1.675001 (no previous merge yet)
[S7] round=18 local utility u=0.000000 metrics={'f1_val': 0.6042967036080693, 'auprc': 0.7881728943953473, 'loss_val': 0.6366342553105021, 'psi': 0.6778471799229806}-{'f1_val': 0.6699503191375248, 'auprc': 0.8190408659212037, 'loss_val': 0.4148764504553254, 'psi': 0.7295865378509964}
[S8] START round=18 head_norm_before_train=1.170833 cos_to_last_merge=0.9976 (last merge round=16)
[S8] round=18 local utility u=0.033387 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9938286471337342, 'loss_val': 0.2521117849727437, 'psi': 0.9952533208935854}-{'f1_val': 0.9962031034001528, 'auprc': 0.9973891442957441, 'loss_val': 0.3295671549048341, 'psi': 0.9966775197583894}
[S9] START round=18 head_norm_before_train=1.976408 (no previous merge yet)
[S9] round=18 local utility u=0.000388 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.999566132886, 'loss_val': 0.022036482469879697, 'psi': 0.9973224841729112}-{'f1_val': 0.9971029125121428, 'auprc': 0.9969395682422373, 'loss_val': 0.02259069922918363, 'psi': 0.9970375748041806}
[S10] START round=18 head_norm_before_train=1.709994 cos_to_last_merge=0.9986 (last merge round=15)
[S10] round=18 local utility u=0.143194 metrics={'f1_val': 0.9588849825436028, 'auprc': 0.9961682412646296, 'loss_val': 0.25133648669483794, 'psi': 0.9737982860320136}-{'f1_val': 0.915421915987214, 'auprc': 0.9957253476722665, 'loss_val': 0.2756178462769094, 'psi': 0.947543288661235}
[S11] START round=18 head_norm_before_train=1.786454 (no previous merge yet)
[S11] round=18 local utility u=0.175323 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9981215576772992, 'loss_val': 0.04548161479815801, 'psi': 0.9970317235522362}-{'f1_val': 0.956159783151826, 'auprc': 0.9980096784372434, 'loss_val': 0.1549193163407268, 'psi': 0.972899741265993}
[S13] START round=18 head_norm_before_train=1.961965 cos_to_last_merge=1.0000 (last merge round=17)
[S13] round=18 local utility u=0.000000 metrics={'f1_val': 0.5694630218386014, 'auprc': 0.663054293077573, 'loss_val': 0.8810136822116512, 'psi': 0.6068995303341901}-{'f1_val': 0.5990889255880241, 'auprc': 0.5615989986647821, 'loss_val': 0.7076209093392775, 'psi': 0.5840929548187273}
[S14] START round=18 head_norm_before_train=1.756893 cos_to_last_merge=0.9996 (last merge round=16)
[S14] round=18 local utility u=0.074798 metrics={'f1_val': 0.9979161758042404, 'auprc': 0.9956345757451682, 'loss_val': 0.15487386848470241, 'psi': 0.9970035357806115}-{'f1_val': 0.9815530889479538, 'auprc': 0.9970680828137378, 'loss_val': 0.2105915332810662, 'psi': 0.9877590864942675}
[S15] START round=18 head_norm_before_train=1.479660 cos_to_last_merge=0.8230 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.823
[S15] round=18 local utility u=0.196782 metrics={'f1_val': 0.8876647518829405, 'auprc': 0.9901811470714751, 'loss_val': 0.16509204444032982, 'psi': 0.9286713099583543}-{'f1_val': 0.8244265557155238, 'auprc': 0.9891325757871018, 'loss_val': 0.17608055367235534, 'psi': 0.890308963744155}
[S16] START round=18 head_norm_before_train=1.311982 cos_to_last_merge=1.0000 (last merge round=17)
[S16] round=18 local utility u=0.212924 metrics={'f1_val': 0.9915212706861152, 'auprc': 0.9936483647227142, 'loss_val': 0.288511839357845, 'psi': 0.9923721083007548}-{'f1_val': 0.9378555584826543, 'auprc': 0.9920306845418667, 'loss_val': 0.387512453155212, 'psi': 0.9595256089063393}
[S17] START round=18 head_norm_before_train=1.503402 (no previous merge yet)
[S17] round=18 local utility u=0.000000 metrics={'f1_val': 0.3275545871875807, 'auprc': 0.6757731831403898, 'loss_val': 2.0596790469076134, 'psi': 0.46684202556870436}-{'f1_val': 0.32690693966602336, 'auprc': 0.7440334198304992, 'loss_val': 1.1943354608572783, 'psi': 0.4937575317318137}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:37109
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S11] → sending delta(kind=head bytes=1806) to S14@127.0.0.1:37114
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:37109
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:37112
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:37116
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] → sending delta(kind=head bytes=1804) to S4@127.0.0.1:37104
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:37117
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:37113
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:37114
[S15] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1804 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1806 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1801) from S2
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.748293)
[S8] loaded HEAD from S2 (vec_in norm=1.748293)
[S8] cosine check vs S2: cos=-0.0065
[S8] DROPPED delta from S2 (cos=-0.0065 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1800) from S16
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.350438)
[S8] loaded HEAD from S16 (vec_in norm=1.350438)
[S8] cosine check vs S16: cos=0.8518
[S8] BUFFERED delta from S16 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1798) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.215696)
[S17] loaded HEAD from S8 (vec_in norm=1.215696)
[S17] cosine check vs S8: cos=-0.0656
[S17] DROPPED delta from S8 (cos=-0.0656 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1797) from S15
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.505184)
[S16] loaded HEAD from S15 (vec_in norm=1.505184)
[S16] cosine check vs S15: cos=0.4029
[S16] BUFFERED delta from S15 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1797) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.729882)
[S14] loaded HEAD from S10 (vec_in norm=1.729882)
[S14] cosine check vs S10: cos=-0.0983
[S14] DROPPED delta from S10 (cos=-0.0983 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1802) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.676141)
[S11] loaded HEAD from S6 (vec_in norm=1.676141)
[S11] cosine check vs S6: cos=-0.0635
[S11] DROPPED delta from S6 (cos=-0.0635 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1806) from S11
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.808898)
[S14] loaded HEAD from S11 (vec_in norm=1.808898)
[S14] cosine check vs S11: cos=0.9932
[S14] BUFFERED delta from S11 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1804) from S14
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.785551)
[S4] loaded HEAD from S14 (vec_in norm=1.785551)
[S4] cosine check vs S14: cos=-0.0972
[S4] DROPPED delta from S14 (cos=-0.0972 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1798) from S9
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.998935)
[S13] loaded HEAD from S9 (vec_in norm=1.998935)
[S13] cosine check vs S9: cos=0.9986
[S13] BUFFERED delta from S9 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=18 metric=0.5695 head_norm=1.976855
[S13] _apply_head_vector_avg (torch): Δ‖w‖=5.415125e-02
[S13] stored merged vector for next round verification (round=18)
[S13] DEBUG after merge:  round=18 metric=0.5701 head_norm=1.987188 delta_norm=0.054151
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=18 metric=0.9962 head_norm=1.215696
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.552901e-01
[S8] stored merged vector for next round verification (round=18)
[S8] DEBUG after merge:  round=18 metric=0.9961 head_norm=1.234734 delta_norm=0.355290
[S8] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=18 metric=0.9979 head_norm=1.785551
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.057952e-01
[S14] stored merged vector for next round verification (round=18)
[S14] DEBUG after merge:  round=18 metric=0.9979 head_norm=1.794146 delta_norm=0.105795
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=18 metric=0.9915 head_norm=1.350438
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.828500e-01
[S16] stored merged vector for next round verification (round=18)
[S16] DEBUG after merge:  round=18 metric=0.9915 head_norm=1.196568 delta_norm=0.782850
[S16] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.748293 (no previous merge yet)
[S2] round=19 local utility u=0.017309 metrics={'f1_val': 0.7012347841865968, 'auprc': 0.9800488554951701, 'loss_val': 0.22994818436973946, 'psi': 0.8127604127100261}-{'f1_val': 0.7010542679632784, 'auprc': 0.9763077013081444, 'loss_val': 0.2522589094965795, 'psi': 0.8111556413012249}
[S3] START round=19 head_norm_before_train=1.998296 (no previous merge yet)
[S3] round=19 local utility u=0.132448 metrics={'f1_val': 0.996947988970087, 'auprc': 0.9987621492554812, 'loss_val': 0.041700832587231, 'psi': 0.9976736530842447}-{'f1_val': 0.9607804860280988, 'auprc': 0.9985244089059553, 'loss_val': 0.0888790364603166, 'psi': 0.9758780551792414}
[S4] START round=19 head_norm_before_train=1.957080 cos_to_last_merge=0.9990 (last merge round=16)
[S4] round=19 local utility u=0.087968 metrics={'f1_val': 0.9422684440603707, 'auprc': 0.9790432312010786, 'loss_val': 0.27122261118878216, 'psi': 0.9569783589166538}-{'f1_val': 0.9383981831014401, 'auprc': 0.9515850403194951, 'loss_val': 0.3415614952222237, 'psi': 0.943672925988662}
[S5] START round=19 head_norm_before_train=1.596402 cos_to_last_merge=0.8201 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.820
[S5] round=19 local utility u=0.000000 metrics={'f1_val': 0.6997951797835498, 'auprc': 0.9634254614012677, 'loss_val': 0.29885022722837673, 'psi': 0.8052472924306369}-{'f1_val': 0.7005793910907778, 'auprc': 0.9766949037305039, 'loss_val': 0.2828798284152419, 'psi': 0.8110255961466682}
[S6] START round=19 head_norm_before_train=1.676141 (no previous merge yet)
[S6] round=19 local utility u=0.000000 metrics={'f1_val': 0.7325786057536592, 'auprc': 0.8971198563545246, 'loss_val': 0.627060300364222, 'psi': 0.7983951059940053}-{'f1_val': 0.8018276139668432, 'auprc': 0.9456984399436513, 'loss_val': 0.3290954882311816, 'psi': 0.8593759443575664}
[S7] START round=19 head_norm_before_train=1.682804 (no previous merge yet)
[S7] round=19 local utility u=0.364020 metrics={'f1_val': 0.6705450085173117, 'auprc': 0.8208646232009573, 'loss_val': 0.4041597562335765, 'psi': 0.7306728543907699}-{'f1_val': 0.6042967036080693, 'auprc': 0.7881728943953473, 'loss_val': 0.6366342553105021, 'psi': 0.6778471799229806}
[S8] START round=19 head_norm_before_train=1.234734 cos_to_last_merge=1.0000 (last merge round=18)
[S8] round=19 local utility u=0.000000 metrics={'f1_val': 0.9737304903299967, 'auprc': 0.9875826835422103, 'loss_val': 0.3216985622167166, 'psi': 0.9792713676148821}-{'f1_val': 0.9962031034001528, 'auprc': 0.9938286471337342, 'loss_val': 0.2521117849727437, 'psi': 0.9952533208935854}
[S9] START round=19 head_norm_before_train=1.998935 (no previous merge yet)
[S9] round=19 local utility u=0.003608 metrics={'f1_val': 0.9966891482978385, 'auprc': 0.9995585518424853, 'loss_val': 0.019972296934874727, 'psi': 0.9978369097156973}-{'f1_val': 0.9958267183641853, 'auprc': 0.999566132886, 'loss_val': 0.022036482469879697, 'psi': 0.9973224841729112}
[S10] START round=19 head_norm_before_train=1.729882 cos_to_last_merge=0.9976 (last merge round=15)
[S10] round=19 local utility u=0.025209 metrics={'f1_val': 0.9583295013087848, 'auprc': 0.9971110303030166, 'loss_val': 0.20041401000351175, 'psi': 0.9738421129064776}-{'f1_val': 0.9588849825436028, 'auprc': 0.9961682412646296, 'loss_val': 0.25133648669483794, 'psi': 0.9737982860320136}
[S11] START round=19 head_norm_before_train=1.808898 (no previous merge yet)
[S11] round=19 local utility u=0.000966 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9981060804462364, 'loss_val': 0.04350359588735651, 'psi': 0.9970255326598112}-{'f1_val': 0.996305167468861, 'auprc': 0.9981215576772992, 'loss_val': 0.04548161479815801, 'psi': 0.9970317235522362}
[S13] START round=19 head_norm_before_train=1.987188 cos_to_last_merge=1.0000 (last merge round=18)
[S13] round=19 local utility u=0.218598 metrics={'f1_val': 0.6150153788291849, 'auprc': 0.6479174995282695, 'loss_val': 0.671721503490337, 'psi': 0.6281762271088187}-{'f1_val': 0.5694630218386014, 'auprc': 0.663054293077573, 'loss_val': 0.8810136822116512, 'psi': 0.6068995303341901}
[S14] START round=19 head_norm_before_train=1.794146 cos_to_last_merge=1.0000 (last merge round=18)
[S14] round=19 local utility u=0.005865 metrics={'f1_val': 0.9980623665153463, 'auprc': 0.9970668742226378, 'loss_val': 0.1483187250044121, 'psi': 0.997664169598263}-{'f1_val': 0.9979161758042404, 'auprc': 0.9956345757451682, 'loss_val': 0.15487386848470241, 'psi': 0.9970035357806115}
[S15] START round=19 head_norm_before_train=1.505184 cos_to_last_merge=0.8177 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.818
[S15] round=19 local utility u=0.000000 metrics={'f1_val': 0.8139039976209994, 'auprc': 0.9895355232352857, 'loss_val': 0.17483050236123387, 'psi': 0.884156607866714}-{'f1_val': 0.8876647518829405, 'auprc': 0.9901811470714751, 'loss_val': 0.16509204444032982, 'psi': 0.9286713099583543}
[S16] START round=19 head_norm_before_train=1.196568 cos_to_last_merge=1.0000 (last merge round=18)
[S16] round=19 local utility u=0.000000 metrics={'f1_val': 0.8663411347712235, 'auprc': 0.9928457346104427, 'loss_val': 0.45313454502214495, 'psi': 0.9169429747069112}-{'f1_val': 0.9915212706861152, 'auprc': 0.9936483647227142, 'loss_val': 0.288511839357845, 'psi': 0.9923721083007548}
[S17] START round=19 head_norm_before_train=1.513946 (no previous merge yet)
[S17] round=19 local utility u=0.729824 metrics={'f1_val': 0.35938156581611613, 'auprc': 0.7340340542527214, 'loss_val': 0.9657754321491065, 'psi': 0.5092425611907583}-{'f1_val': 0.3275545871875807, 'auprc': 0.6757731831403898, 'loss_val': 2.0596790469076134, 'psi': 0.46684202556870436}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:37110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:37113
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S10@127.0.0.1:37111
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] → sending delta(kind=head bytes=1805) to S4@127.0.0.1:37104
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:37104
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:37114
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:37114
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:37116
[S14] sending update (kind=head size=1805 to 1 peers)
[S7] sending update (kind=head size=1804 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1796) from S13
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=2.002362)
[S16] loaded HEAD from S13 (vec_in norm=2.002362)
[S16] cosine check vs S13: cos=0.4640
[S16] BUFFERED delta from S13 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1802) from S4
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.973294)
[S9] loaded HEAD from S4 (vec_in norm=1.973294)
[S9] cosine check vs S4: cos=-0.0577
[S9] DROPPED delta from S4 (cos=-0.0577 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1798) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.752907)
[S14] loaded HEAD from S10 (vec_in norm=1.752907)
[S14] cosine check vs S10: cos=-0.0926
[S14] DROPPED delta from S10 (cos=-0.0926 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1798) from S9
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=2.019052)
[S13] loaded HEAD from S9 (vec_in norm=2.019052)
[S13] cosine check vs S9: cos=0.9990
[S13] BUFFERED delta from S9 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1804) from S7
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.697030)
[S10] loaded HEAD from S7 (vec_in norm=1.697030)
[S10] cosine check vs S7: cos=0.9861
[S10] BUFFERED delta from S7 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1803) from S11
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.828805)
[S14] loaded HEAD from S11 (vec_in norm=1.828805)
[S14] cosine check vs S11: cos=0.9964
[S14] BUFFERED delta from S11 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1805) from S14
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.823735)
[S4] loaded HEAD from S14 (vec_in norm=1.823735)
[S4] cosine check vs S14: cos=-0.0996
[S4] DROPPED delta from S14 (cos=-0.0996 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1802) from S3
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=2.019582)
[S4] loaded HEAD from S3 (vec_in norm=2.019582)
[S4] cosine check vs S3: cos=0.9906
[S4] BUFFERED delta from S3 (total buffered=1)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:37110
[S17] sending update (kind=head size=1797 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1797) from S17
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.523448)
[S9] loaded HEAD from S17 (vec_in norm=1.523448)
[S9] cosine check vs S17: cos=-0.0809
[S9] DROPPED delta from S17 (cos=-0.0809 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:37109
[S2] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1800) from S2
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.763318)
[S8] loaded HEAD from S2 (vec_in norm=1.763318)
[S8] cosine check vs S2: cos=0.0016
[S8] BUFFERED delta from S2 (total buffered=1)
[S6] r=20 psi=0.798 u=0.0000 p_local=0.3529 f1=0.733 auprc=0.897 bytes=21609
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=19 metric=0.9737 head_norm=1.276879
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.087733e+00
[S8] stored merged vector for next round verification (round=19)
[S8] DEBUG after merge:  round=19 metric=0.7141 head_norm=1.089354 delta_norm=1.087733
[S8] aggregate: ROLLBACK (f1_val pre=0.974 post=0.714 tol_abs=0.005 tol_rel=0.0)
[S8] r=20 psi=0.979 u=0.0000 p_local=0.2741 f1=0.974 auprc=0.988 bytes=21572
[S5] r=20 psi=0.805 u=0.0000 p_local=0.1019 f1=0.700 auprc=0.963 bytes=21579
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=19 metric=0.9423 head_norm=1.973294
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.387369e-01
[S4] stored merged vector for next round verification (round=19)
[S4] DEBUG after merge:  round=19 metric=0.9417 head_norm=1.991746 delta_norm=0.138737
[S4] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S4] r=20 psi=0.957 u=0.0880 p_local=0.1806 f1=0.942 auprc=0.979 bytes=26966
[S9] r=20 psi=0.998 u=0.0036 p_local=0.0451 f1=0.997 auprc=1.000 bytes=26991
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=19 metric=0.9583 head_norm=1.752907
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.463513e-01
[S10] stored merged vector for next round verification (round=19)
[S10] DEBUG after merge:  round=19 metric=0.9550 head_norm=1.718976 delta_norm=0.146351
[S10] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S10] r=20 psi=0.974 u=0.0252 p_local=0.2409 f1=0.958 auprc=0.997 bytes=25155
[S7] r=20 psi=0.731 u=0.3640 p_local=0.1772 f1=0.671 auprc=0.821 bytes=17953
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=19 metric=0.9981 head_norm=1.823735
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.699361e-02
[S14] stored merged vector for next round verification (round=19)
[S14] DEBUG after merge:  round=19 metric=0.9981 head_norm=1.824648 delta_norm=0.076994
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S14] r=20 psi=0.998 u=0.0059 p_local=0.2027 f1=0.998 auprc=0.997 bytes=28805
[S3] r=20 psi=0.998 u=0.1324 p_local=0.1463 f1=0.997 auprc=0.999 bytes=21608
[S11] r=20 psi=0.997 u=0.0010 p_local=0.1172 f1=0.996 auprc=0.998 bytes=23397
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=19 metric=0.6150 head_norm=2.002362
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.513694e-02
[S13] stored merged vector for next round verification (round=19)
[S13] DEBUG after merge:  round=19 metric=0.6150 head_norm=2.010218 delta_norm=0.045137
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S13] r=20 psi=0.628 u=0.2186 p_local=0.1840 f1=0.615 auprc=0.648 bytes=21566
[S17] r=20 psi=0.509 u=0.7298 p_local=0.2723 f1=0.359 auprc=0.734 bytes=19792
[S2] r=20 psi=0.813 u=0.0173 p_local=0.0849 f1=0.701 auprc=0.980 bytes=21550
[S15] r=20 psi=0.884 u=0.0000 p_local=0.1417 f1=0.814 auprc=0.990 bytes=26980
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=19 metric=0.8663 head_norm=1.238631
[S16] _apply_head_vector_avg (torch): Δ‖w‖=9.002593e-01
[S16] stored merged vector for next round verification (round=19)
[S16] DEBUG after merge:  round=19 metric=0.8545 head_norm=1.400487 delta_norm=0.900259
[S16] aggregate: ROLLBACK (f1_val pre=0.866 post=0.854 tol_abs=0.005 tol_rel=0.0)
[S16] r=20 psi=0.917 u=0.0000 p_local=0.1837 f1=0.866 auprc=0.993 bytes=21579
[S2] START round=20 head_norm_before_train=1.763318 (no previous merge yet)
[S2] round=20 local utility u=0.012925 metrics={'f1_val': 0.7022902322932426, 'auprc': 0.9839048426821371, 'loss_val': 0.22199943353940219, 'psi': 0.8149360764488004}-{'f1_val': 0.7012347841865968, 'auprc': 0.9800488554951701, 'loss_val': 0.22994818436973946, 'psi': 0.8127604127100261}
[S3] START round=20 head_norm_before_train=2.019582 (no previous merge yet)
[S3] round=20 local utility u=0.000000 metrics={'f1_val': 0.9435076665748189, 'auprc': 0.9988647764814393, 'loss_val': 0.13164702704946332, 'psi': 0.9656505105374671}-{'f1_val': 0.996947988970087, 'auprc': 0.9987621492554812, 'loss_val': 0.041700832587231, 'psi': 0.9976736530842447}
[S4] START round=20 head_norm_before_train=1.991746 cos_to_last_merge=1.0000 (last merge round=19)
[S4] round=20 local utility u=0.000000 metrics={'f1_val': 0.947905999191933, 'auprc': 0.9665702169819917, 'loss_val': 0.27602973051231156, 'psi': 0.9553716863079564}-{'f1_val': 0.9422684440603707, 'auprc': 0.9790432312010786, 'loss_val': 0.27122261118878216, 'psi': 0.9569783589166538}
[S5] START round=20 head_norm_before_train=1.615155 cos_to_last_merge=0.8164 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.816
[S5] round=20 local utility u=0.119592 metrics={'f1_val': 0.7302060735706449, 'auprc': 0.9693053311353923, 'loss_val': 0.25977047424660876, 'psi': 0.8258457765965439}-{'f1_val': 0.6997951797835498, 'auprc': 0.9634254614012677, 'loss_val': 0.29885022722837673, 'psi': 0.8052472924306369}
[S6] START round=20 head_norm_before_train=1.688232 (no previous merge yet)
[S6] round=20 local utility u=0.994901 metrics={'f1_val': 0.9614977865940096, 'auprc': 0.968614082209611, 'loss_val': 0.22525640977163325, 'psi': 0.9643443048402502}-{'f1_val': 0.7325786057536592, 'auprc': 0.8971198563545246, 'loss_val': 0.627060300364222, 'psi': 0.7983951059940053}
[S7] START round=20 head_norm_before_train=1.697030 (no previous merge yet)
[S7] round=20 local utility u=0.000000 metrics={'f1_val': 0.6522349930320874, 'auprc': 0.798643211387117, 'loss_val': 0.5261797768056372, 'psi': 0.7107982803740993}-{'f1_val': 0.6705450085173117, 'auprc': 0.8208646232009573, 'loss_val': 0.4041597562335765, 'psi': 0.7306728543907699}
[S8] START round=20 head_norm_before_train=1.089354 cos_to_last_merge=1.0000 (last merge round=19)
[S8] round=20 local utility u=0.000000 metrics={'f1_val': 0.7151442486458968, 'auprc': 0.9932542093809633, 'loss_val': 0.5311900912183112, 'psi': 0.8263882329399234}-{'f1_val': 0.9737304903299967, 'auprc': 0.9875826835422103, 'loss_val': 0.3216985622167166, 'psi': 0.9792713676148821}
[S9] START round=20 head_norm_before_train=2.019052 (no previous merge yet)
[S9] round=20 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9980773573472168, 'loss_val': 0.019393279393750188, 'psi': 0.9974926904461724}-{'f1_val': 0.9966891482978385, 'auprc': 0.9995585518424853, 'loss_val': 0.019972296934874727, 'psi': 0.9978369097156973}
[S10] START round=20 head_norm_before_train=1.718976 cos_to_last_merge=1.0000 (last merge round=19)
[S10] round=20 local utility u=0.000000 metrics={'f1_val': 0.9075460282642445, 'auprc': 0.9954729723924334, 'loss_val': 0.26036130024393805, 'psi': 0.94271680591552}-{'f1_val': 0.9583295013087848, 'auprc': 0.9971110303030166, 'loss_val': 0.20041401000351175, 'psi': 0.9738421129064776}
[S11] START round=20 head_norm_before_train=1.828805 (no previous merge yet)
[S11] round=20 local utility u=0.002534 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9981170498123452, 'loss_val': 0.038468247703572385, 'psi': 0.9970299204062547}-{'f1_val': 0.996305167468861, 'auprc': 0.9981060804462364, 'loss_val': 0.04350359588735651, 'psi': 0.9970255326598112}
[S13] START round=20 head_norm_before_train=2.010218 cos_to_last_merge=1.0000 (last merge round=19)
[S13] round=20 local utility u=0.000000 metrics={'f1_val': 0.5965118753595983, 'auprc': 0.6507277851687743, 'loss_val': 0.8143917864639157, 'psi': 0.6181982392832687}-{'f1_val': 0.6150153788291849, 'auprc': 0.6479174995282695, 'loss_val': 0.671721503490337, 'psi': 0.6281762271088187}
[S14] START round=20 head_norm_before_train=1.824648 cos_to_last_merge=1.0000 (last merge round=19)
[S14] round=20 local utility u=0.019432 metrics={'f1_val': 0.9983050875260411, 'auprc': 0.9965854454842726, 'loss_val': 0.10946682684209973, 'psi': 0.9976172307093337}-{'f1_val': 0.9980623665153463, 'auprc': 0.9970668742226378, 'loss_val': 0.1483187250044121, 'psi': 0.997664169598263}
[S15] START round=20 head_norm_before_train=1.529127 cos_to_last_merge=0.8129 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.813
[S15] round=20 local utility u=0.037608 metrics={'f1_val': 0.8258767560671657, 'auprc': 0.9901441933580087, 'loss_val': 0.1732778304159475, 'psi': 0.8915837309835029}-{'f1_val': 0.8139039976209994, 'auprc': 0.9895355232352857, 'loss_val': 0.17483050236123387, 'psi': 0.884156607866714}
[S16] START round=20 head_norm_before_train=1.400487 cos_to_last_merge=1.0000 (last merge round=19)
[S16] round=20 local utility u=0.000000 metrics={'f1_val': 0.8599107222516346, 'auprc': 0.9895458416131842, 'loss_val': 0.4458551219076128, 'psi': 0.9117647699962543}-{'f1_val': 0.8663411347712235, 'auprc': 0.9928457346104427, 'loss_val': 0.45313454502214495, 'psi': 0.9169429747069112}
[S17] START round=20 head_norm_before_train=1.523448 (no previous merge yet)
[S17] round=20 local utility u=0.606420 metrics={'f1_val': 0.38954486211433936, 'auprc': 0.9601046628651272, 'loss_val': 0.6121264012271439, 'psi': 0.6177687824146545}-{'f1_val': 0.35938156581611613, 'auprc': 0.7340340542527214, 'loss_val': 0.9657754321491065, 'psi': 0.5092425611907583}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:37110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:37109
[S5] sending update (kind=head size=1802 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1802) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.635004)
[S9] loaded HEAD from S5 (vec_in norm=1.635004)
[S9] cosine check vs S5: cos=-0.0971
[S9] DROPPED delta from S5 (cos=-0.0971 < 0.0)
[S2] sending update (kind=head size=1794 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1794) from S2
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.779904)
[S8] loaded HEAD from S2 (vec_in norm=1.779904)
[S8] cosine check vs S2: cos=0.7814
[S8] BUFFERED delta from S2 (total buffered=1)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:37114
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:37116
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:37104
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:37112
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:37110
[S11] sending update (kind=head size=1799 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1799) from S11
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.846087)
[S14] loaded HEAD from S11 (vec_in norm=1.846087)
[S14] cosine check vs S11: cos=0.9977
[S14] BUFFERED delta from S11 (total buffered=1)
[S6] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1803) from S15
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.551670)
[S16] loaded HEAD from S15 (vec_in norm=1.551670)
[S16] cosine check vs S15: cos=0.3439
[S16] BUFFERED delta from S15 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1799) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.699804)
[S11] loaded HEAD from S6 (vec_in norm=1.699804)
[S11] cosine check vs S6: cos=-0.0626
[S11] DROPPED delta from S6 (cos=-0.0626 < 0.0)
[S17] sending update (kind=head size=1799 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1799) from S17
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.536718)
[S9] loaded HEAD from S17 (vec_in norm=1.536718)
[S9] cosine check vs S17: cos=-0.0781
[S9] DROPPED delta from S17 (cos=-0.0781 < 0.0)
[S14] sending update (kind=head size=1798 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1798) from S14
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.857846)
[S4] loaded HEAD from S14 (vec_in norm=1.857846)
[S4] cosine check vs S14: cos=-0.0980
[S4] DROPPED delta from S14 (cos=-0.0980 < 0.0)
[S10] ⇄ pheromone p=0.193 → S14@127.0.0.1:37114
[S5] ⇄ pheromone p=0.105 → S9@127.0.0.1:37110
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=20 metric=0.7151 head_norm=1.123016
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.712740e-01
[S8] stored merged vector for next round verification (round=20)
[S8] DEBUG after merge:  round=20 metric=0.7140 head_norm=1.374138 delta_norm=0.571274
[S8] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.219 → S17@127.0.0.1:37117
[S9] ⇄ pheromone p=0.036 → S13@127.0.0.1:37113
[S7] ⇄ pheromone p=0.142 → S10@127.0.0.1:37111
[S13] ⇄ pheromone p=0.147 → S16@127.0.0.1:37116
[S4] ⇄ pheromone p=0.144 → S9@127.0.0.1:37110
[S3] ⇄ pheromone p=0.117 → S4@127.0.0.1:37104
[S11] ⇄ pheromone p=0.094 → S14@127.0.0.1:37114
[S6] ⇄ pheromone p=0.481 → S11@127.0.0.1:37112
[S15] ⇄ pheromone p=0.121 → S16@127.0.0.1:37116
[S2] ⇄ pheromone p=0.070 → S8@127.0.0.1:37109
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=20 metric=0.8599 head_norm=1.438942
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.577013e-01
[S16] stored merged vector for next round verification (round=20)
[S16] DEBUG after merge:  round=20 metric=0.8606 head_norm=1.226159 delta_norm=0.857701
[S16] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.147 → S8@127.0.0.1:37109
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=20 metric=0.9983 head_norm=1.857846
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.239777e-02
[S14] stored merged vector for next round verification (round=20)
[S14] DEBUG after merge:  round=20 metric=0.9983 head_norm=1.850925 delta_norm=0.062398
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.166 → S4@127.0.0.1:37104
[S17] ⇄ pheromone p=0.339 → S9@127.0.0.1:37110
[S2] START round=21 head_norm_before_train=1.779904 (no previous merge yet)
[S2] round=21 local utility u=0.272370 metrics={'f1_val': 0.8534067467970019, 'auprc': 0.8706264484301854, 'loss_val': 0.24412359452926782, 'psi': 0.8602946274502754}-{'f1_val': 0.7022902322932426, 'auprc': 0.9839048426821371, 'loss_val': 0.22199943353940219, 'psi': 0.8149360764488004}
[S3] START round=21 head_norm_before_train=2.036274 (no previous merge yet)
[S3] round=21 local utility u=0.000000 metrics={'f1_val': 0.8954999382520802, 'auprc': 0.9988546714940758, 'loss_val': 0.17983822700775265, 'psi': 0.9368418315488785}-{'f1_val': 0.9435076665748189, 'auprc': 0.9988647764814393, 'loss_val': 0.13164702704946332, 'psi': 0.9656505105374671}
[S4] START round=21 head_norm_before_train=2.005323 cos_to_last_merge=0.9999 (last merge round=19)
[S4] round=21 local utility u=0.036855 metrics={'f1_val': 0.9520061805438971, 'auprc': 0.9762012263489986, 'loss_val': 0.2558147929331098, 'psi': 0.9616841988659377}-{'f1_val': 0.947905999191933, 'auprc': 0.9665702169819917, 'loss_val': 0.27602973051231156, 'psi': 0.9553716863079564}
[S5] START round=21 head_norm_before_train=1.635004 cos_to_last_merge=0.8143 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.814
[S5] round=21 local utility u=0.923283 metrics={'f1_val': 0.9967280377725878, 'auprc': 0.9930568884746164, 'loss_val': 0.08359002195262245, 'psi': 0.9952595780533993}-{'f1_val': 0.7302060735706449, 'auprc': 0.9693053311353923, 'loss_val': 0.25977047424660876, 'psi': 0.8258457765965439}
[S6] START round=21 head_norm_before_train=1.699804 (no previous merge yet)
[S6] round=21 local utility u=0.000000 metrics={'f1_val': 0.5958624687390133, 'auprc': 0.8312190425069641, 'loss_val': 0.8850232224582949, 'psi': 0.6900050982461936}-{'f1_val': 0.9614977865940096, 'auprc': 0.968614082209611, 'loss_val': 0.22525640977163325, 'psi': 0.9643443048402502}
[S7] START round=21 head_norm_before_train=1.711881 (no previous merge yet)
[S7] round=21 local utility u=0.000000 metrics={'f1_val': 0.6450539795925654, 'auprc': 0.7984923778945218, 'loss_val': 0.5122755904661221, 'psi': 0.706429338913348}-{'f1_val': 0.6522349930320874, 'auprc': 0.798643211387117, 'loss_val': 0.5261797768056372, 'psi': 0.7107982803740993}
[S8] START round=21 head_norm_before_train=1.374138 cos_to_last_merge=1.0000 (last merge round=20)
[S8] round=21 local utility u=0.000000 metrics={'f1_val': 0.7008992245294026, 'auprc': 0.9931716453964816, 'loss_val': 0.6615761298346353, 'psi': 0.8178081928762342}-{'f1_val': 0.7151442486458968, 'auprc': 0.9932542093809633, 'loss_val': 0.5311900912183112, 'psi': 0.8263882329399234}
[S9] START round=21 head_norm_before_train=2.033206 (no previous merge yet)
[S9] round=21 local utility u=0.000189 metrics={'f1_val': 0.9966891482978385, 'auprc': 0.9988720369138545, 'loss_val': 0.01891693944654901, 'psi': 0.9975623037442449}-{'f1_val': 0.9971029125121428, 'auprc': 0.9980773573472168, 'loss_val': 0.019393279393750188, 'psi': 0.9974926904461724}
[S10] START round=21 head_norm_before_train=1.742033 cos_to_last_merge=0.9997 (last merge round=19)
[S10] round=21 local utility u=0.000000 metrics={'f1_val': 0.8996944950595521, 'auprc': 0.9963529336969063, 'loss_val': 0.29160920796016937, 'psi': 0.9383578705144937}-{'f1_val': 0.9075460282642445, 'auprc': 0.9954729723924334, 'loss_val': 0.26036130024393805, 'psi': 0.94271680591552}
[S11] START round=21 head_norm_before_train=1.846087 (no previous merge yet)
[S11] round=21 local utility u=0.000000 metrics={'f1_val': 0.9593166598111371, 'auprc': 0.998118226274577, 'loss_val': 0.09583303315679406, 'psi': 0.9748372863965131}-{'f1_val': 0.996305167468861, 'auprc': 0.9981170498123452, 'loss_val': 0.038468247703572385, 'psi': 0.9970299204062547}
[S13] START round=21 head_norm_before_train=2.022874 cos_to_last_merge=0.9999 (last merge round=19)
[S13] round=21 local utility u=0.109069 metrics={'f1_val': 0.6035327859717463, 'auprc': 0.6821689836043007, 'loss_val': 0.732703815360648, 'psi': 0.6349872650247681}-{'f1_val': 0.5965118753595983, 'auprc': 0.6507277851687743, 'loss_val': 0.8143917864639157, 'psi': 0.6181982392832687}
[S14] START round=21 head_norm_before_train=1.850925 cos_to_last_merge=1.0000 (last merge round=20)
[S14] round=21 local utility u=0.008795 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9963389387200147, 'loss_val': 0.08721445276190487, 'psi': 0.997126246317918}-{'f1_val': 0.9983050875260411, 'auprc': 0.9965854454842726, 'loss_val': 0.10946682684209973, 'psi': 0.9976172307093337}
[S15] START round=21 head_norm_before_train=1.551670 cos_to_last_merge=0.8085 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.808
[S15] round=21 local utility u=0.149694 metrics={'f1_val': 0.8766473817707935, 'auprc': 0.9884547033135512, 'loss_val': 0.1734456868922462, 'psi': 0.9213703103878966}-{'f1_val': 0.8258767560671657, 'auprc': 0.9901441933580087, 'loss_val': 0.1732778304159475, 'psi': 0.8915837309835029}
[S16] START round=21 head_norm_before_train=1.226159 cos_to_last_merge=1.0000 (last merge round=20)
[S16] round=21 local utility u=0.504546 metrics={'f1_val': 0.9892595063659753, 'auprc': 0.9958514140425309, 'loss_val': 0.2317734448984075, 'psi': 0.9918962694365975}-{'f1_val': 0.8599107222516346, 'auprc': 0.9895458416131842, 'loss_val': 0.4458551219076128, 'psi': 0.9117647699962543}
[S17] START round=21 head_norm_before_train=1.536718 (no previous merge yet)
[S17] round=21 local utility u=0.224644 metrics={'f1_val': 0.4514082102290492, 'auprc': 0.9829644330632672, 'loss_val': 0.602597640804398, 'psi': 0.6640306993627364}-{'f1_val': 0.38954486211433936, 'auprc': 0.9601046628651272, 'loss_val': 0.6121264012271439, 'psi': 0.6177687824146545}
[S14] not sending this round → trigger blocked (psi=0.997)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:37110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:37116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:37110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:37109
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:37116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:37109
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:37113
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1804 to 1 peers)
[S13] sending update (kind=head size=1803 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1799) from S9
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=2.049079)
[S13] loaded HEAD from S9 (vec_in norm=2.049079)
[S13] cosine check vs S9: cos=0.9987
[S13] BUFFERED delta from S9 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1804) from S2
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.796745)
[S8] loaded HEAD from S2 (vec_in norm=1.796745)
[S8] cosine check vs S2: cos=0.9495
[S8] BUFFERED delta from S2 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1799) from S16
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.268627)
[S8] loaded HEAD from S16 (vec_in norm=1.268627)
[S8] cosine check vs S16: cos=0.2697
[S8] BUFFERED delta from S16 (total buffered=2)
[S9] RECEIVED delta(kind=head bytes=1801) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.651002)
[S9] loaded HEAD from S5 (vec_in norm=1.651002)
[S9] cosine check vs S5: cos=-0.0979
[S9] DROPPED delta from S5 (cos=-0.0979 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1798) from S4
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=2.019720)
[S9] loaded HEAD from S4 (vec_in norm=2.019720)
[S9] cosine check vs S4: cos=-0.0565
[S9] DROPPED delta from S4 (cos=-0.0565 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1803) from S13
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=2.037845)
[S16] loaded HEAD from S13 (vec_in norm=2.037845)
[S16] cosine check vs S13: cos=0.4998
[S16] BUFFERED delta from S13 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1800) from S15
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.575918)
[S16] loaded HEAD from S15 (vec_in norm=1.575918)
[S16] cosine check vs S15: cos=0.8274
[S16] BUFFERED delta from S15 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:37110
[S17] sending update (kind=head size=1801 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1801) from S17
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.548756)
[S9] loaded HEAD from S17 (vec_in norm=1.548756)
[S9] cosine check vs S17: cos=-0.0762
[S9] DROPPED delta from S17 (cos=-0.0762 < 0.0)
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=21 metric=0.7009 head_norm=1.394132
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.801546e-01
[S8] stored merged vector for next round verification (round=21)
[S8] DEBUG after merge:  round=21 metric=0.7009 head_norm=1.227270 delta_norm=0.280155
[S8] aggregate: ACCEPT kept=['S2', 'S16'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=21 metric=0.9893 head_norm=1.268627
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.394308e-01
[S16] stored merged vector for next round verification (round=21)
[S16] DEBUG after merge:  round=21 metric=0.9869 head_norm=1.237129 delta_norm=0.239431
[S16] aggregate: ACCEPT kept=['S13', 'S15'] (k=2/2) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=21 metric=0.6035 head_norm=2.037845
[S13] _apply_head_vector_avg (torch): Δ‖w‖=5.278723e-02
[S13] stored merged vector for next round verification (round=21)
[S13] DEBUG after merge:  round=21 metric=0.6033 head_norm=2.042788 delta_norm=0.052787
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=1.796745 (no previous merge yet)
[S2] round=22 local utility u=0.378080 metrics={'f1_val': 0.9237219294046809, 'auprc': 0.9696727212074169, 'loss_val': 0.20699389533154136, 'psi': 0.9421022461257753}-{'f1_val': 0.8534067467970019, 'auprc': 0.8706264484301854, 'loss_val': 0.24412359452926782, 'psi': 0.8602946274502754}
[S3] START round=22 head_norm_before_train=2.055403 (no previous merge yet)
[S3] round=22 local utility u=0.384686 metrics={'f1_val': 0.9978389274664787, 'auprc': 0.9986201555374262, 'loss_val': 0.02379636587272683, 'psi': 0.9981514186948578}-{'f1_val': 0.8954999382520802, 'auprc': 0.9988546714940758, 'loss_val': 0.17983822700775265, 'psi': 0.9368418315488785}
[S4] START round=22 head_norm_before_train=2.019720 cos_to_last_merge=0.9996 (last merge round=19)
[S4] round=22 local utility u=0.000000 metrics={'f1_val': 0.9462547268292903, 'auprc': 0.9757511064301009, 'loss_val': 0.2546391480217422, 'psi': 0.9580532786696145}-{'f1_val': 0.9520061805438971, 'auprc': 0.9762012263489986, 'loss_val': 0.2558147929331098, 'psi': 0.9616841988659377}
[S5] START round=22 head_norm_before_train=1.651002 cos_to_last_merge=0.8123 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.812
[S5] round=22 local utility u=0.014313 metrics={'f1_val': 0.9971410286679584, 'auprc': 0.9950115815078002, 'loss_val': 0.06330540054891458, 'psi': 0.9962892498038951}-{'f1_val': 0.9967280377725878, 'auprc': 0.9930568884746164, 'loss_val': 0.08359002195262245, 'psi': 0.9952595780533993}
[S6] START round=22 head_norm_before_train=1.709177 (no previous merge yet)
[S6] round=22 local utility u=1.000000 metrics={'f1_val': 0.8032660285660274, 'auprc': 0.9415508630934335, 'loss_val': 0.416248105419529, 'psi': 0.8585799623769899}-{'f1_val': 0.5958624687390133, 'auprc': 0.8312190425069641, 'loss_val': 0.8850232224582949, 'psi': 0.6900050982461936}
[S7] START round=22 head_norm_before_train=1.723820 (no previous merge yet)
[S7] round=22 local utility u=0.000000 metrics={'f1_val': 0.5109638528321836, 'auprc': 0.7812831952891757, 'loss_val': 0.9559055984904803, 'psi': 0.6190915898149805}-{'f1_val': 0.6450539795925654, 'auprc': 0.7984923778945218, 'loss_val': 0.5122755904661221, 'psi': 0.706429338913348}
[S8] START round=22 head_norm_before_train=1.227270 cos_to_last_merge=1.0000 (last merge round=21)
[S8] round=22 local utility u=0.094001 metrics={'f1_val': 0.7136651753441605, 'auprc': 0.9855244097964754, 'loss_val': 0.5272278413629353, 'psi': 0.8224088691250865}-{'f1_val': 0.7008992245294026, 'auprc': 0.9931716453964816, 'loss_val': 0.6615761298346353, 'psi': 0.8178081928762342}
[S9] START round=22 head_norm_before_train=2.049079 (no previous merge yet)
[S9] round=22 local utility u=0.000000 metrics={'f1_val': 0.9878214512971564, 'auprc': 0.9963578993265884, 'loss_val': 0.046452010804067904, 'psi': 0.9912360305089292}-{'f1_val': 0.9966891482978385, 'auprc': 0.9988720369138545, 'loss_val': 0.01891693944654901, 'psi': 0.9975623037442449}
[S10] START round=22 head_norm_before_train=1.764302 cos_to_last_merge=0.9990 (last merge round=19)
[S10] round=22 local utility u=0.019774 metrics={'f1_val': 0.9015935222308011, 'auprc': 0.9942953064673381, 'loss_val': 0.25728275000826184, 'psi': 0.938674235925416}-{'f1_val': 0.8996944950595521, 'auprc': 0.9963529336969063, 'loss_val': 0.29160920796016937, 'psi': 0.9383578705144937}
[S11] START round=22 head_norm_before_train=1.861764 (no previous merge yet)
[S11] round=22 local utility u=0.141604 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9981084380890368, 'loss_val': 0.034526695368634126, 'psi': 0.9970264757169314}-{'f1_val': 0.9593166598111371, 'auprc': 0.998118226274577, 'loss_val': 0.09583303315679406, 'psi': 0.9748372863965131}
[S13] START round=22 head_norm_before_train=2.042788 cos_to_last_merge=1.0000 (last merge round=21)
[S13] round=22 local utility u=0.002597 metrics={'f1_val': 0.6038583127130327, 'auprc': 0.6777125854751722, 'loss_val': 0.7160945753303917, 'psi': 0.6334000218178886}-{'f1_val': 0.6035327859717463, 'auprc': 0.6821689836043007, 'loss_val': 0.732703815360648, 'psi': 0.6349872650247681}
[S14] START round=22 head_norm_before_train=1.886493 cos_to_last_merge=0.9997 (last merge round=20)
[S14] round=22 local utility u=0.011195 metrics={'f1_val': 0.9980623665153463, 'auprc': 0.9963598504139, 'loss_val': 0.06735489618472551, 'psi': 0.9973813600747679}-{'f1_val': 0.9976511180498535, 'auprc': 0.9963389387200147, 'loss_val': 0.08721445276190487, 'psi': 0.997126246317918}
[S15] START round=22 head_norm_before_train=1.575918 cos_to_last_merge=0.8031 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.803
[S15] round=22 local utility u=0.303636 metrics={'f1_val': 0.9643699153603666, 'auprc': 0.9922434887675237, 'loss_val': 0.10387603846804401, 'psi': 0.9755193447232295}-{'f1_val': 0.8766473817707935, 'auprc': 0.9884547033135512, 'loss_val': 0.1734456868922462, 'psi': 0.9213703103878966}
[S16] START round=22 head_norm_before_train=1.237129 cos_to_last_merge=1.0000 (last merge round=21)
[S16] round=22 local utility u=0.016281 metrics={'f1_val': 0.9910416310373822, 'auprc': 0.9914716246846565, 'loss_val': 0.1967656104026356, 'psi': 0.9912136284962919}-{'f1_val': 0.9892595063659753, 'auprc': 0.9958514140425309, 'loss_val': 0.2317734448984075, 'psi': 0.9918962694365975}
[S17] START round=22 head_norm_before_train=1.548756 (no previous merge yet)
[S17] round=22 local utility u=0.000000 metrics={'f1_val': 0.407191343518189, 'auprc': 0.9709892973022396, 'loss_val': 0.6202838013692581, 'psi': 0.6327105250318092}-{'f1_val': 0.4514082102290492, 'auprc': 0.9829644330632672, 'loss_val': 0.602597640804398, 'psi': 0.6640306993627364}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:37112
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.976)
[S13] not sending this round → trigger blocked (psi=0.633)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:37114
[S16] not sending this round → trigger blocked (psi=0.991)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:37114
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:37104
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:37117
[S2] not sending this round → trigger blocked (psi=0.942)
[S5] not sending this round → trigger blocked (psi=0.996)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:37104
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1802) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.715529)
[S11] loaded HEAD from S6 (vec_in norm=1.715529)
[S11] cosine check vs S6: cos=-0.0621
[S11] DROPPED delta from S6 (cos=-0.0621 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1796) from S3
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=2.075861)
[S4] loaded HEAD from S3 (vec_in norm=2.075861)
[S4] cosine check vs S3: cos=0.9931
[S4] BUFFERED delta from S3 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1799) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.258062)
[S17] loaded HEAD from S8 (vec_in norm=1.258062)
[S17] cosine check vs S8: cos=-0.1005
[S17] DROPPED delta from S8 (cos=-0.1005 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1801) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.784023)
[S14] loaded HEAD from S10 (vec_in norm=1.784023)
[S14] cosine check vs S10: cos=-0.0793
[S14] DROPPED delta from S10 (cos=-0.0793 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1796) from S11
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.878557)
[S14] loaded HEAD from S11 (vec_in norm=1.878557)
[S14] cosine check vs S11: cos=0.9966
[S14] BUFFERED delta from S11 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1803) from S14
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.920559)
[S4] loaded HEAD from S14 (vec_in norm=1.920559)
[S4] cosine check vs S14: cos=-0.0986
[S4] DROPPED delta from S14 (cos=-0.0986 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=22 metric=0.9463 head_norm=2.032457
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.224202e-01
[S4] stored merged vector for next round verification (round=22)
[S4] DEBUG after merge:  round=22 metric=0.9457 head_norm=2.050623 delta_norm=0.122420
[S4] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=22 metric=0.9981 head_norm=1.920559
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.063725e-02
[S14] stored merged vector for next round verification (round=22)
[S14] DEBUG after merge:  round=22 metric=0.9981 head_norm=1.897962 delta_norm=0.080637
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=1.811013 (no previous merge yet)
[S2] round=23 local utility u=0.000000 metrics={'f1_val': 0.7887908128994975, 'auprc': 0.9651400794665922, 'loss_val': 0.20067895146111936, 'psi': 0.8593305195263354}-{'f1_val': 0.9237219294046809, 'auprc': 0.9696727212074169, 'loss_val': 0.20699389533154136, 'psi': 0.9421022461257753}
[S3] START round=23 head_norm_before_train=2.075861 (no previous merge yet)
[S3] round=23 local utility u=0.000000 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.9991559865533017, 'loss_val': 0.07780958664626463, 'psi': 0.9762835452845868}-{'f1_val': 0.9978389274664787, 'auprc': 0.9986201555374262, 'loss_val': 0.02379636587272683, 'psi': 0.9981514186948578}
[S4] START round=23 head_norm_before_train=2.050623 cos_to_last_merge=1.0000 (last merge round=22)
[S4] round=23 local utility u=0.031477 metrics={'f1_val': 0.9530084398097354, 'auprc': 0.97896922346532, 'loss_val': 0.24186271885257532, 'psi': 0.9633927532719693}-{'f1_val': 0.9462547268292903, 'auprc': 0.9757511064301009, 'loss_val': 0.2546391480217422, 'psi': 0.9580532786696145}
[S5] START round=23 head_norm_before_train=1.665627 cos_to_last_merge=0.8106 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.811
[S5] round=23 local utility u=0.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9927756787329776, 'loss_val': 0.059827048246894735, 'psi': 0.9951314525802657}-{'f1_val': 0.9971410286679584, 'auprc': 0.9950115815078002, 'loss_val': 0.06330540054891458, 'psi': 0.9962892498038951}
[S6] START round=23 head_norm_before_train=1.715529 (no previous merge yet)
[S6] round=23 local utility u=0.633604 metrics={'f1_val': 0.9614977865940096, 'auprc': 0.9715081544582379, 'loss_val': 0.18830221082630313, 'psi': 0.965501933739701}-{'f1_val': 0.8032660285660274, 'auprc': 0.9415508630934335, 'loss_val': 0.416248105419529, 'psi': 0.8585799623769899}
[S7] START round=23 head_norm_before_train=1.740547 (no previous merge yet)
[S7] round=23 local utility u=0.474737 metrics={'f1_val': 0.6137816502045775, 'auprc': 0.7930732917083705, 'loss_val': 0.6587078893443035, 'psi': 0.6854983068060947}-{'f1_val': 0.5109638528321836, 'auprc': 0.7812831952891757, 'loss_val': 0.9559055984904803, 'psi': 0.6190915898149805}
[S8] START round=23 head_norm_before_train=1.258062 cos_to_last_merge=0.9959 (last merge round=21)
[S8] round=23 local utility u=0.089358 metrics={'f1_val': 0.7139540394217572, 'auprc': 0.993252623334779, 'loss_val': 0.3734304920872825, 'psi': 0.8256734729869659}-{'f1_val': 0.7136651753441605, 'auprc': 0.9855244097964754, 'loss_val': 0.5272278413629353, 'psi': 0.8224088691250865}
[S9] START round=23 head_norm_before_train=2.060885 (no previous merge yet)
[S9] round=23 local utility u=0.042104 metrics={'f1_val': 0.9966891482978385, 'auprc': 0.9973871069466214, 'loss_val': 0.018538087005395953, 'psi': 0.9969683317573517}-{'f1_val': 0.9878214512971564, 'auprc': 0.9963578993265884, 'loss_val': 0.046452010804067904, 'psi': 0.9912360305089292}
[S10] START round=23 head_norm_before_train=1.784023 cos_to_last_merge=0.9982 (last merge round=19)
[S10] round=23 local utility u=0.000000 metrics={'f1_val': 0.8667506204803984, 'auprc': 0.9943299661022926, 'loss_val': 0.3409133844960817, 'psi': 0.917782358729156}-{'f1_val': 0.9015935222308011, 'auprc': 0.9942953064673381, 'loss_val': 0.25728275000826184, 'psi': 0.938674235925416}
[S11] START round=23 head_norm_before_train=1.878557 (no previous merge yet)
[S11] round=23 local utility u=0.000014 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9980372536177036, 'loss_val': 0.0342844769730425, 'psi': 0.9969980019283979}-{'f1_val': 0.996305167468861, 'auprc': 0.9981084380890368, 'loss_val': 0.034526695368634126, 'psi': 0.9970264757169314}
[S13] START round=23 head_norm_before_train=2.056877 cos_to_last_merge=0.9998 (last merge round=21)
[S13] round=23 local utility u=0.000000 metrics={'f1_val': 0.5655539737157387, 'auprc': 0.6559086342107724, 'loss_val': 0.8539360042685389, 'psi': 0.6016958379137521}-{'f1_val': 0.6038583127130327, 'auprc': 0.6777125854751722, 'loss_val': 0.7160945753303917, 'psi': 0.6334000218178886}
[S14] START round=23 head_norm_before_train=1.897962 cos_to_last_merge=1.0000 (last merge round=22)
[S14] round=23 local utility u=0.001587 metrics={'f1_val': 0.9974535255208126, 'auprc': 0.9969755472337347, 'loss_val': 0.062374222487365384, 'psi': 0.9972623342059814}-{'f1_val': 0.9980623665153463, 'auprc': 0.9963598504139, 'loss_val': 0.06735489618472551, 'psi': 0.9973813600747679}
[S15] START round=23 head_norm_before_train=1.598921 cos_to_last_merge=0.7988 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.799
[S15] round=23 local utility u=0.000000 metrics={'f1_val': 0.7661907309314449, 'auprc': 0.9896347978587147, 'loss_val': 0.29885120935952203, 'psi': 0.8555683577023527}-{'f1_val': 0.9643699153603666, 'auprc': 0.9922434887675237, 'loss_val': 0.10387603846804401, 'psi': 0.9755193447232295}
[S16] START round=23 head_norm_before_train=1.281372 cos_to_last_merge=0.9988 (last merge round=21)
[S16] round=23 local utility u=0.022666 metrics={'f1_val': 0.9901931869892605, 'auprc': 0.9965495854685923, 'loss_val': 0.16157647138984133, 'psi': 0.9927357463809933}-{'f1_val': 0.9910416310373822, 'auprc': 0.9914716246846565, 'loss_val': 0.1967656104026356, 'psi': 0.9912136284962919}
[S17] START round=23 head_norm_before_train=1.563625 (no previous merge yet)
[S17] round=23 local utility u=0.324542 metrics={'f1_val': 0.5056479170728305, 'auprc': 0.97169683291173, 'loss_val': 0.5640626619770162, 'psi': 0.6920674834083904}-{'f1_val': 0.407191343518189, 'auprc': 0.9709892973022396, 'loss_val': 0.6202838013692581, 'psi': 0.6327105250318092}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:37111
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:37117
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:37109
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:37113
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:37110
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] → sending delta(kind=head bytes=1804) to S11@127.0.0.1:37112
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:37104
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:37114
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1804 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1804 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1804) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.725359)
[S11] loaded HEAD from S6 (vec_in norm=1.725359)
[S11] cosine check vs S6: cos=-0.0616
[S11] DROPPED delta from S6 (cos=-0.0616 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1801) from S16
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.326203)
[S8] loaded HEAD from S16 (vec_in norm=1.326203)
[S8] cosine check vs S16: cos=0.4644
[S8] BUFFERED delta from S16 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1800) from S4
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=2.059255)
[S9] loaded HEAD from S4 (vec_in norm=2.059255)
[S9] cosine check vs S4: cos=-0.0551
[S9] DROPPED delta from S4 (cos=-0.0551 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1804) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.299222)
[S17] loaded HEAD from S8 (vec_in norm=1.299222)
[S17] cosine check vs S8: cos=-0.0998
[S17] DROPPED delta from S8 (cos=-0.0998 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1803) from S11
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.894938)
[S14] loaded HEAD from S11 (vec_in norm=1.894938)
[S14] cosine check vs S11: cos=0.9982
[S14] BUFFERED delta from S11 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1801) from S14
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.924968)
[S4] loaded HEAD from S14 (vec_in norm=1.924968)
[S4] cosine check vs S14: cos=-0.0980
[S4] DROPPED delta from S14 (cos=-0.0980 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1797) from S9
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=2.072249)
[S13] loaded HEAD from S9 (vec_in norm=2.072249)
[S13] cosine check vs S9: cos=0.9984
[S13] BUFFERED delta from S9 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1798) from S7
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.751391)
[S10] loaded HEAD from S7 (vec_in norm=1.751391)
[S10] cosine check vs S7: cos=0.9884
[S10] BUFFERED delta from S7 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:37110
[S17] sending update (kind=head size=1800 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1800) from S17
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.582822)
[S9] loaded HEAD from S17 (vec_in norm=1.582822)
[S9] cosine check vs S17: cos=-0.0694
[S9] DROPPED delta from S17 (cos=-0.0694 < 0.0)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=23 metric=0.5656 head_norm=2.069571
[S13] _apply_head_vector_avg (torch): Δ‖w‖=5.929653e-02
[S13] stored merged vector for next round verification (round=23)
[S13] DEBUG after merge:  round=23 metric=0.5944 head_norm=2.070062 delta_norm=0.059297
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=23 metric=0.8668 head_norm=1.803741
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.378922e-01
[S10] stored merged vector for next round verification (round=23)
[S10] DEBUG after merge:  round=23 metric=0.8632 head_norm=1.772403 delta_norm=0.137892
[S10] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=23 metric=0.9975 head_norm=1.924968
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.960546e-02
[S14] stored merged vector for next round verification (round=23)
[S14] DEBUG after merge:  round=23 metric=0.9975 head_norm=1.909082 delta_norm=0.059605
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=23 metric=0.7140 head_norm=1.299222
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.794173e-01
[S8] stored merged vector for next round verification (round=23)
[S8] DEBUG after merge:  round=23 metric=0.9962 head_norm=1.123294 delta_norm=0.679417
[S8] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=1.822411 (no previous merge yet)
[S2] round=24 local utility u=0.132914 metrics={'f1_val': 0.8311472161566694, 'auprc': 0.981095624316334, 'loss_val': 0.2368551049116326, 'psi': 0.8911265794205352}-{'f1_val': 0.7887908128994975, 'auprc': 0.9651400794665922, 'loss_val': 0.20067895146111936, 'psi': 0.8593305195263354}
[S3] START round=24 head_norm_before_train=2.094124 (no previous merge yet)
[S3] round=24 local utility u=0.136993 metrics={'f1_val': 0.9973982357793907, 'auprc': 0.9985308049791689, 'loss_val': 0.02012516195373757, 'psi': 0.997851263459302}-{'f1_val': 0.9610352511054436, 'auprc': 0.9991559865533017, 'loss_val': 0.07780958664626463, 'psi': 0.9762835452845868}
[S4] START round=24 head_norm_before_train=2.059255 cos_to_last_merge=0.9999 (last merge round=22)
[S4] round=24 local utility u=0.000000 metrics={'f1_val': 0.9379924664549482, 'auprc': 0.9445188831488924, 'loss_val': 0.29153573121164816, 'psi': 0.9406030331325259}-{'f1_val': 0.9530084398097354, 'auprc': 0.97896922346532, 'loss_val': 0.24186271885257532, 'psi': 0.9633927532719693}
[S5] START round=24 head_norm_before_train=1.679809 cos_to_last_merge=0.8082 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.808
[S5] round=24 local utility u=0.001888 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9922755896470541, 'loss_val': 0.05455103895654034, 'psi': 0.9949314169458963}-{'f1_val': 0.9967019684784577, 'auprc': 0.9927756787329776, 'loss_val': 0.059827048246894735, 'psi': 0.9951314525802657}
[S6] START round=24 head_norm_before_train=1.725359 (no previous merge yet)
[S6] round=24 local utility u=0.000000 metrics={'f1_val': 0.6063215959907886, 'auprc': 0.945360433387872, 'loss_val': 1.035230142239827, 'psi': 0.741937130949622}-{'f1_val': 0.9614977865940096, 'auprc': 0.9715081544582379, 'loss_val': 0.18830221082630313, 'psi': 0.965501933739701}
[S7] START round=24 head_norm_before_train=1.751391 (no previous merge yet)
[S7] round=24 local utility u=0.037556 metrics={'f1_val': 0.6131863142167109, 'auprc': 0.7959116214509251, 'loss_val': 0.5885388274542634, 'psi': 0.6862764371103967}-{'f1_val': 0.6137816502045775, 'auprc': 0.7930732917083705, 'loss_val': 0.6587078893443035, 'psi': 0.6854983068060947}
[S8] START round=24 head_norm_before_train=1.123294 cos_to_last_merge=1.0000 (last merge round=23)
[S8] round=24 local utility u=0.895678 metrics={'f1_val': 0.9953659596578323, 'auprc': 0.9924287068950395, 'loss_val': 0.2680752477484209, 'psi': 0.9941910585527152}-{'f1_val': 0.7139540394217572, 'auprc': 0.993252623334779, 'loss_val': 0.3734304920872825, 'psi': 0.8256734729869659}
[S9] START round=24 head_norm_before_train=2.072249 (no previous merge yet)
[S9] round=24 local utility u=0.000000 metrics={'f1_val': 0.9924853119792197, 'auprc': 0.99952045672393, 'loss_val': 0.027384777621943655, 'psi': 0.9952993698771038}-{'f1_val': 0.9966891482978385, 'auprc': 0.9973871069466214, 'loss_val': 0.018538087005395953, 'psi': 0.9969683317573517}
[S10] START round=24 head_norm_before_train=1.772403 cos_to_last_merge=1.0000 (last merge round=23)
[S10] round=24 local utility u=0.000000 metrics={'f1_val': 0.864703789801124, 'auprc': 0.994795430022229, 'loss_val': 0.33752186436630477, 'psi': 0.916740445889566}-{'f1_val': 0.8667506204803984, 'auprc': 0.9943299661022926, 'loss_val': 0.3409133844960817, 'psi': 0.917782358729156}
[S11] START round=24 head_norm_before_train=1.894938 (no previous merge yet)
[S11] round=24 local utility u=0.000499 metrics={'f1_val': 0.996305167468861, 'auprc': 0.997679865165825, 'loss_val': 0.03221361255273841, 'psi': 0.9968550465476466}-{'f1_val': 0.996305167468861, 'auprc': 0.9980372536177036, 'loss_val': 0.0342844769730425, 'psi': 0.9969980019283979}
[S13] START round=24 head_norm_before_train=2.070062 cos_to_last_merge=1.0000 (last merge round=23)
[S13] round=24 local utility u=0.003675 metrics={'f1_val': 0.5528504280264843, 'auprc': 0.681004936812523, 'loss_val': 0.8456537133454434, 'psi': 0.6041122315408998}-{'f1_val': 0.5655539737157387, 'auprc': 0.6559086342107724, 'loss_val': 0.8539360042685389, 'psi': 0.6016958379137521}
[S14] START round=24 head_norm_before_train=1.909082 cos_to_last_merge=1.0000 (last merge round=23)
[S14] round=24 local utility u=0.000386 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.9967905000997668, 'loss_val': 0.06324355495948943, 'psi': 0.9974079108202377}-{'f1_val': 0.9974535255208126, 'auprc': 0.9969755472337347, 'loss_val': 0.062374222487365384, 'psi': 0.9972623342059814}
[S15] START round=24 head_norm_before_train=1.623997 cos_to_last_merge=0.7946 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.795
[S15] round=24 local utility u=0.044740 metrics={'f1_val': 0.7756120792399055, 'auprc': 0.9902436616711616, 'loss_val': 0.2677268396101936, 'psi': 0.861464712212408}-{'f1_val': 0.7661907309314449, 'auprc': 0.9896347978587147, 'loss_val': 0.29885120935952203, 'psi': 0.8555683577023527}
[S16] START round=24 head_norm_before_train=1.326203 cos_to_last_merge=0.9961 (last merge round=21)
[S16] round=24 local utility u=0.011497 metrics={'f1_val': 0.99124228310456, 'auprc': 0.9900892042628094, 'loss_val': 0.12549648383049372, 'psi': 0.9907810515678598}-{'f1_val': 0.9901931869892605, 'auprc': 0.9965495854685923, 'loss_val': 0.16157647138984133, 'psi': 0.9927357463809933}
[S17] START round=24 head_norm_before_train=1.582822 (no previous merge yet)
[S17] round=24 local utility u=0.000000 metrics={'f1_val': 0.41122379723233266, 'auprc': 0.9113178000479942, 'loss_val': 0.6352540421255128, 'psi': 0.6112613983585973}-{'f1_val': 0.5056479170728305, 'auprc': 0.97169683291173, 'loss_val': 0.5640626619770162, 'psi': 0.6920674834083904}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:37110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:37116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:37104
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:37104
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:37116
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:37117
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:37114
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:37111
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:37109
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:37109
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1797) from S3
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=2.113749)
[S4] loaded HEAD from S3 (vec_in norm=2.113749)
[S4] cosine check vs S3: cos=0.9969
[S4] BUFFERED delta from S3 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1802) from S14
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.932305)
[S4] loaded HEAD from S14 (vec_in norm=1.932305)
[S4] cosine check vs S14: cos=-0.0993
[S4] DROPPED delta from S14 (cos=-0.0993 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1800) from S2
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.833268)
[S8] loaded HEAD from S2 (vec_in norm=1.833268)
[S8] cosine check vs S2: cos=0.4832
[S8] BUFFERED delta from S2 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1799) from S16
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.366923)
[S8] loaded HEAD from S16 (vec_in norm=1.366923)
[S8] cosine check vs S16: cos=0.8573
[S8] BUFFERED delta from S16 (total buffered=2)
[S9] RECEIVED delta(kind=head bytes=1801) from S5
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.698888)
[S9] loaded HEAD from S5 (vec_in norm=1.698888)
[S9] cosine check vs S5: cos=-0.0989
[S9] DROPPED delta from S5 (cos=-0.0989 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1802) from S11
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.908895)
[S14] loaded HEAD from S11 (vec_in norm=1.908895)
[S14] cosine check vs S11: cos=0.9989
[S14] BUFFERED delta from S11 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1800) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.171034)
[S17] loaded HEAD from S8 (vec_in norm=1.171034)
[S17] cosine check vs S8: cos=-0.0823
[S17] DROPPED delta from S8 (cos=-0.0823 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1798) from S7
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.756291)
[S10] loaded HEAD from S7 (vec_in norm=1.756291)
[S10] cosine check vs S7: cos=0.9957
[S10] BUFFERED delta from S7 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1800) from S15
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.649003)
[S16] loaded HEAD from S15 (vec_in norm=1.649003)
[S16] cosine check vs S15: cos=0.7028
[S16] BUFFERED delta from S15 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1798) from S13
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=2.081763)
[S16] loaded HEAD from S13 (vec_in norm=2.081763)
[S16] cosine check vs S13: cos=0.6442
[S16] BUFFERED delta from S13 (total buffered=2)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=24 metric=0.8647 head_norm=1.792996
[S10] _apply_head_vector_avg (torch): Δ‖w‖=8.421032e-02
[S10] stored merged vector for next round verification (round=24)
[S10] DEBUG after merge:  round=24 metric=0.8630 head_norm=1.772739 delta_norm=0.084210
[S10] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=24 metric=0.9380 head_norm=2.066521
[S4] _apply_head_vector_avg (torch): Δ‖w‖=8.620280e-02
[S4] stored merged vector for next round verification (round=24)
[S4] DEBUG after merge:  round=24 metric=0.9380 head_norm=2.088490 delta_norm=0.086203
[S4] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=24 metric=0.9954 head_norm=1.171034
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.669484e-01
[S8] stored merged vector for next round verification (round=24)
[S8] DEBUG after merge:  round=24 metric=0.9949 head_norm=1.129617 delta_norm=0.266948
[S8] aggregate: ACCEPT kept=['S2', 'S16'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=24 metric=0.9978 head_norm=1.932305
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.626373e-02
[S14] stored merged vector for next round verification (round=24)
[S14] DEBUG after merge:  round=24 metric=0.9978 head_norm=1.920078 delta_norm=0.046264
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=24 metric=0.9912 head_norm=1.366923
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.685765e-01
[S16] stored merged vector for next round verification (round=24)
[S16] DEBUG after merge:  round=24 metric=0.9910 head_norm=1.317959 delta_norm=0.168576
[S16] aggregate: ACCEPT kept=['S15', 'S13'] (k=2/2) mode=median trim_p=0.1
[S2] START round=25 head_norm_before_train=1.833268 (no previous merge yet)
[S2] round=25 local utility u=0.379546 metrics={'f1_val': 0.9360627359489991, 'auprc': 0.9894320111753896, 'loss_val': 0.13226612602132598, 'psi': 0.9574104460395553}-{'f1_val': 0.8311472161566694, 'auprc': 0.981095624316334, 'loss_val': 0.2368551049116326, 'psi': 0.8911265794205352}
[S3] START round=25 head_norm_before_train=2.113749 (no previous merge yet)
[S3] round=25 local utility u=0.000000 metrics={'f1_val': 0.98555620657673, 'auprc': 0.9987135496070559, 'loss_val': 0.03514679897868993, 'psi': 0.9908191437888604}-{'f1_val': 0.9973982357793907, 'auprc': 0.9985308049791689, 'loss_val': 0.02012516195373757, 'psi': 0.997851263459302}
[S4] START round=25 head_norm_before_train=2.088490 cos_to_last_merge=1.0000 (last merge round=24)
[S4] round=25 local utility u=0.037046 metrics={'f1_val': 0.940136298810933, 'auprc': 0.9580899680710752, 'loss_val': 0.2710193347509006, 'psi': 0.9473177665149899}-{'f1_val': 0.9379924664549482, 'auprc': 0.9445188831488924, 'loss_val': 0.29153573121164816, 'psi': 0.9406030331325259}
[S5] START round=25 head_norm_before_train=1.698888 cos_to_last_merge=0.8045 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.805
[S5] round=25 local utility u=0.000000 metrics={'f1_val': 0.9959201961697324, 'auprc': 0.9913614039717363, 'loss_val': 0.07117715422769182, 'psi': 0.9940966792905339}-{'f1_val': 0.9967019684784577, 'auprc': 0.9922755896470541, 'loss_val': 0.05455103895654034, 'psi': 0.9949314169458963}
[S6] START round=25 head_norm_before_train=1.733581 (no previous merge yet)
[S6] round=25 local utility u=0.722912 metrics={'f1_val': 0.7636634433834156, 'auprc': 0.9557675079305488, 'loss_val': 0.5646788792446551, 'psi': 0.8405050692022689}-{'f1_val': 0.6063215959907886, 'auprc': 0.945360433387872, 'loss_val': 1.035230142239827, 'psi': 0.741937130949622}
[S7] START round=25 head_norm_before_train=1.756291 (no previous merge yet)
[S7] round=25 local utility u=0.000000 metrics={'f1_val': 0.555920949330082, 'auprc': 0.7838034586644405, 'loss_val': 0.8472408302838551, 'psi': 0.6470739530638254}-{'f1_val': 0.6131863142167109, 'auprc': 0.7959116214509251, 'loss_val': 0.5885388274542634, 'psi': 0.6862764371103967}
[S8] START round=25 head_norm_before_train=1.129617 cos_to_last_merge=1.0000 (last merge round=24)
[S8] round=25 local utility u=0.000000 metrics={'f1_val': 0.9960539056390789, 'auprc': 0.9887699071441733, 'loss_val': 0.29288693913875813, 'psi': 0.9931403062411166}-{'f1_val': 0.9953659596578323, 'auprc': 0.9924287068950395, 'loss_val': 0.2680752477484209, 'psi': 0.9941910585527152}
[S9] START round=25 head_norm_before_train=2.086161 (no previous merge yet)
[S9] round=25 local utility u=0.010555 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9943973691302086, 'loss_val': 0.01861057005252693, 'psi': 0.9960206951593691}-{'f1_val': 0.9924853119792197, 'auprc': 0.99952045672393, 'loss_val': 0.027384777621943655, 'psi': 0.9952993698771038}
[S10] START round=25 head_norm_before_train=1.772739 cos_to_last_merge=1.0000 (last merge round=24)
[S10] round=25 local utility u=0.002945 metrics={'f1_val': 0.8649634155015756, 'auprc': 0.9945406946269406, 'loss_val': 0.3324262604272111, 'psi': 0.9167943271517216}-{'f1_val': 0.864703789801124, 'auprc': 0.994795430022229, 'loss_val': 0.33752186436630477, 'psi': 0.916740445889566}
[S11] START round=25 head_norm_before_train=1.908895 (no previous merge yet)
[S11] round=25 local utility u=0.001659 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9979227202781502, 'loss_val': 0.02962400732017924, 'psi': 0.9969521885925767}-{'f1_val': 0.996305167468861, 'auprc': 0.997679865165825, 'loss_val': 0.03221361255273841, 'psi': 0.9968550465476466}
[S13] START round=25 head_norm_before_train=2.081763 cos_to_last_merge=0.9999 (last merge round=23)
[S13] round=25 local utility u=0.026652 metrics={'f1_val': 0.5922370439706434, 'auprc': 0.6341456864870126, 'loss_val': 0.8880916643650861, 'psi': 0.609000500977191}-{'f1_val': 0.5528504280264843, 'auprc': 0.681004936812523, 'loss_val': 0.8456537133454434, 'psi': 0.6041122315408998}
[S14] START round=25 head_norm_before_train=1.920078 cos_to_last_merge=1.0000 (last merge round=24)
[S14] round=25 local utility u=0.001602 metrics={'f1_val': 0.9970202894562089, 'auprc': 0.9968844839745717, 'loss_val': 0.05552592929598466, 'psi': 0.996965967263554}-{'f1_val': 0.9978195179672185, 'auprc': 0.9967905000997668, 'loss_val': 0.06324355495948943, 'psi': 0.9974079108202377}
[S15] START round=25 head_norm_before_train=1.649003 cos_to_last_merge=0.7902 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.790
[S15] round=25 local utility u=0.650604 metrics={'f1_val': 0.9618908966543844, 'auprc': 0.9938163987726669, 'loss_val': 0.0949090149821961, 'psi': 0.9746610975016974}-{'f1_val': 0.7756120792399055, 'auprc': 0.9902436616711616, 'loss_val': 0.2677268396101936, 'psi': 0.861464712212408}
[S16] START round=25 head_norm_before_train=1.317959 cos_to_last_merge=1.0000 (last merge round=24)
[S16] round=25 local utility u=0.000000 metrics={'f1_val': 0.895054467070043, 'auprc': 0.995289734821713, 'loss_val': 0.36439478241527845, 'psi': 0.9351485741707111}-{'f1_val': 0.99124228310456, 'auprc': 0.9900892042628094, 'loss_val': 0.12549648383049372, 'psi': 0.9907810515678598}
[S17] START round=25 head_norm_before_train=1.601364 (no previous merge yet)
[S17] round=25 local utility u=0.315748 metrics={'f1_val': 0.4749596402936487, 'auprc': 0.9619472776006711, 'loss_val': 0.5380623348332164, 'psi': 0.6697546952164577}-{'f1_val': 0.41122379723233266, 'auprc': 0.9113178000479942, 'loss_val': 0.6352540421255128, 'psi': 0.6112613983585973}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:37116
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:37114
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:37109
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:37113
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:37114
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:37116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:37110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S11@127.0.0.1:37112
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:37104
[S9] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1797) from S4
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=2.098446)
[S9] loaded HEAD from S4 (vec_in norm=2.098446)
[S9] cosine check vs S4: cos=-0.0537
[S9] DROPPED delta from S4 (cos=-0.0537 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1803) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.739270)
[S11] loaded HEAD from S6 (vec_in norm=1.739270)
[S11] cosine check vs S6: cos=-0.0612
[S11] DROPPED delta from S6 (cos=-0.0612 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1800) from S13
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=2.092368)
[S16] loaded HEAD from S13 (vec_in norm=2.092368)
[S16] cosine check vs S13: cos=0.7079
[S16] BUFFERED delta from S13 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1800) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.796239)
[S14] loaded HEAD from S10 (vec_in norm=1.796239)
[S14] cosine check vs S10: cos=-0.0676
[S14] DROPPED delta from S10 (cos=-0.0676 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1801) from S2
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.845436)
[S8] loaded HEAD from S2 (vec_in norm=1.845436)
[S8] cosine check vs S2: cos=0.6406
[S8] BUFFERED delta from S2 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1797) from S9
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=2.100527)
[S13] loaded HEAD from S9 (vec_in norm=2.100527)
[S13] cosine check vs S9: cos=0.9986
[S13] BUFFERED delta from S9 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1802) from S14
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.943985)
[S4] loaded HEAD from S14 (vec_in norm=1.943985)
[S4] cosine check vs S14: cos=-0.0965
[S4] DROPPED delta from S14 (cos=-0.0965 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1801) from S11
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.924792)
[S14] loaded HEAD from S11 (vec_in norm=1.924792)
[S14] cosine check vs S11: cos=0.9992
[S14] BUFFERED delta from S11 (total buffered=1)
[S16] RECEIVED delta(kind=head bytes=1796) from S15
[S16] model_id mismatch: wear != wear
[S16] after if model_id mismatch: wear != wear
[S16] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.670862)
[S16] loaded HEAD from S15 (vec_in norm=1.670862)
[S16] cosine check vs S15: cos=0.6509
[S16] BUFFERED delta from S15 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:37110
[S17] sending update (kind=head size=1801 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1801) from S17
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.616348)
[S9] loaded HEAD from S17 (vec_in norm=1.616348)
[S9] cosine check vs S17: cos=-0.0643
[S9] DROPPED delta from S17 (cos=-0.0643 < 0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=25 metric=0.9961 head_norm=1.168924
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.085509e-01
[S8] stored merged vector for next round verification (round=25)
[S8] DEBUG after merge:  round=25 metric=0.7140 head_norm=1.372576 delta_norm=0.708551
[S8] aggregate: ROLLBACK (f1_val pre=0.996 post=0.714 tol_abs=0.005 tol_rel=0.0)
[S8] ⇄ pheromone p=0.236 → S16@127.0.0.1:37116
[S4] ⇄ pheromone p=0.062 → S14@127.0.0.1:37114
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=25 metric=0.5922 head_norm=2.092368
[S13] _apply_head_vector_avg (torch): Δ‖w‖=5.585432e-02
[S13] stored merged vector for next round verification (round=25)
[S13] DEBUG after merge:  round=25 metric=0.5965 head_norm=2.095707 delta_norm=0.055854
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.063 → S9@127.0.0.1:37110
[S10] ⇄ pheromone p=0.066 → S7@127.0.0.1:37108
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=25 metric=0.9970 head_norm=1.943985
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.898250e-02
[S14] stored merged vector for next round verification (round=25)
[S14] DEBUG after merge:  round=25 metric=0.9970 head_norm=1.934019 delta_norm=0.038982
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.057 → S10@127.0.0.1:37111
[S11] ⇄ pheromone p=0.046 → S6@127.0.0.1:37107
[S9] ⇄ pheromone p=0.019 → S17@127.0.0.1:37117
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=25 metric=0.8951 head_norm=1.354927
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.045024e-01
[S16] stored merged vector for next round verification (round=25)
[S16] DEBUG after merge:  round=25 metric=0.8908 head_norm=1.323345 delta_norm=0.104502
[S16] aggregate: ACCEPT kept=['S13', 'S15'] (k=2/2) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.096 → S8@127.0.0.1:37109
[S17] ⇄ pheromone p=0.234 → S8@127.0.0.1:37109
[S2] START round=26 head_norm_before_train=1.845436 (no previous merge yet)
[S2] round=26 local utility u=0.000000 metrics={'f1_val': 0.815046141463775, 'auprc': 0.9548627078674677, 'loss_val': 0.22551949262343804, 'psi': 0.8709727680252521}-{'f1_val': 0.9360627359489991, 'auprc': 0.9894320111753896, 'loss_val': 0.13226612602132598, 'psi': 0.9574104460395553}
[S3] START round=26 head_norm_before_train=2.128764 (no previous merge yet)
[S3] round=26 local utility u=0.000000 metrics={'f1_val': 0.9519279065516568, 'auprc': 0.9985126030854593, 'loss_val': 0.11622883203533199, 'psi': 0.9705617851651778}-{'f1_val': 0.98555620657673, 'auprc': 0.9987135496070559, 'loss_val': 0.03514679897868993, 'psi': 0.9908191437888604}
[S4] START round=26 head_norm_before_train=2.098446 cos_to_last_merge=1.0000 (last merge round=24)
[S4] round=26 local utility u=0.077186 metrics={'f1_val': 0.9537231057730021, 'auprc': 0.9709378082760586, 'loss_val': 0.23671113839204128, 'psi': 0.9606089867742247}-{'f1_val': 0.940136298810933, 'auprc': 0.9580899680710752, 'loss_val': 0.2710193347509006, 'psi': 0.9473177665149899}
[S5] START round=26 head_norm_before_train=1.715451 cos_to_last_merge=0.8011 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.801
[S5] round=26 local utility u=0.000000 metrics={'f1_val': 0.9955957911086084, 'auprc': 0.9907803513930875, 'loss_val': 0.07829271976191422, 'psi': 0.9936696152224}-{'f1_val': 0.9959201961697324, 'auprc': 0.9913614039717363, 'loss_val': 0.07117715422769182, 'psi': 0.9940966792905339}
[S6] START round=26 head_norm_before_train=1.739270 (no previous merge yet)
[S6] round=26 local utility u=0.267198 metrics={'f1_val': 0.8219348513852522, 'auprc': 0.9620799856708575, 'loss_val': 0.3988495541098515, 'psi': 0.8779929050994943}-{'f1_val': 0.7636634433834156, 'auprc': 0.9557675079305488, 'loss_val': 0.5646788792446551, 'psi': 0.8405050692022689}
[S7] START round=26 head_norm_before_train=1.764356 (no previous merge yet)
[S7] round=26 local utility u=0.512197 metrics={'f1_val': 0.6513573424011204, 'auprc': 0.8043167178371707, 'loss_val': 0.457005192079896, 'psi': 0.7125410925755405}-{'f1_val': 0.555920949330082, 'auprc': 0.7838034586644405, 'loss_val': 0.8472408302838551, 'psi': 0.6470739530638254}
[S8] START round=26 head_norm_before_train=1.372576 cos_to_last_merge=1.0000 (last merge round=25)
[S8] round=26 local utility u=0.000000 metrics={'f1_val': 0.7140186993020905, 'auprc': 0.9908891846906506, 'loss_val': 0.41696630588720596, 'psi': 0.8247668934575145}-{'f1_val': 0.9960539056390789, 'auprc': 0.9887699071441733, 'loss_val': 0.29288693913875813, 'psi': 0.9931403062411166}
[S9] START round=26 head_norm_before_train=2.100527 (no previous merge yet)
[S9] round=26 local utility u=0.000259 metrics={'f1_val': 0.9950237510807955, 'auprc': 0.9995103092910258, 'loss_val': 0.020957269871764668, 'psi': 0.9968183743648877}-{'f1_val': 0.9971029125121428, 'auprc': 0.9943973691302086, 'loss_val': 0.01861057005252693, 'psi': 0.9960206951593691}
[S10] START round=26 head_norm_before_train=1.796239 cos_to_last_merge=0.9998 (last merge round=24)
[S10] round=26 local utility u=0.005819 metrics={'f1_val': 0.8644587754880946, 'auprc': 0.9947206963753139, 'loss_val': 0.31830036341100404, 'psi': 0.9165635438429822}-{'f1_val': 0.8649634155015756, 'auprc': 0.9945406946269406, 'loss_val': 0.3324262604272111, 'psi': 0.9167943271517216}
[S11] START round=26 head_norm_before_train=1.924792 (no previous merge yet)
[S11] round=26 local utility u=0.000000 metrics={'f1_val': 0.9458680019864427, 'auprc': 0.9920302349550099, 'loss_val': 0.28111562011303914, 'psi': 0.9643328951738697}-{'f1_val': 0.996305167468861, 'auprc': 0.9979227202781502, 'loss_val': 0.02962400732017924, 'psi': 0.9969521885925767}
[S13] START round=26 head_norm_before_train=2.095707 cos_to_last_merge=1.0000 (last merge round=25)
[S13] round=26 local utility u=0.129587 metrics={'f1_val': 0.602995078227972, 'auprc': 0.665834292598757, 'loss_val': 0.7885323020779623, 'psi': 0.6281307639762861}-{'f1_val': 0.5922370439706434, 'auprc': 0.6341456864870126, 'loss_val': 0.8880916643650861, 'psi': 0.609000500977191}
[S14] START round=26 head_norm_before_train=1.934019 cos_to_last_merge=1.0000 (last merge round=25)
[S14] round=26 local utility u=0.003069 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.9981659872206075, 'loss_val': 0.058028177242380644, 'psi': 0.997958105668574}-{'f1_val': 0.9970202894562089, 'auprc': 0.9968844839745717, 'loss_val': 0.05552592929598466, 'psi': 0.996965967263554}
[S15] START round=26 head_norm_before_train=1.670862 cos_to_last_merge=0.7864 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.786
[S15] round=26 local utility u=0.089270 metrics={'f1_val': 0.9896196349177863, 'auprc': 0.9933896441757402, 'loss_val': 0.08146096708658067, 'psi': 0.9911276386209678}-{'f1_val': 0.9618908966543844, 'auprc': 0.9938163987726669, 'loss_val': 0.0949090149821961, 'psi': 0.9746610975016974}
[S16] START round=26 head_norm_before_train=1.323345 cos_to_last_merge=1.0000 (last merge round=25)
[S16] round=26 local utility u=0.152132 metrics={'f1_val': 0.933231986384208, 'auprc': 0.9950642827453083, 'loss_val': 0.28851855742665355, 'psi': 0.957964904928648}-{'f1_val': 0.895054467070043, 'auprc': 0.995289734821713, 'loss_val': 0.36439478241527845, 'psi': 0.9351485741707111}
[S17] START round=26 head_norm_before_train=1.616348 (no previous merge yet)
[S17] round=26 local utility u=0.000000 metrics={'f1_val': 0.462235851993875, 'auprc': 0.9551630157124574, 'loss_val': 0.5554603619576387, 'psi': 0.659406717481308}-{'f1_val': 0.4749596402936487, 'auprc': 0.9619472776006711, 'loss_val': 0.5380623348332164, 'psi': 0.6697546952164577}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:37110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:37114
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] → sending delta(kind=head bytes=1794) to S10@127.0.0.1:37111
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:37117
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:37111
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] → sending delta(kind=head bytes=1804) to S11@127.0.0.1:37112
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S10] → sending delta(kind=head bytes=1809) to S7@127.0.0.1:37108
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:37109
[S10] sending update (kind=head size=1809 to 1 peers)
[S6] sending update (kind=head size=1804 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1804 to 1 peers)
[S7] sending update (kind=head size=1794 to 1 peers)
[S4] sending update (kind=head size=1795 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1804) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.751465)
[S11] loaded HEAD from S6 (vec_in norm=1.751465)
[S11] cosine check vs S6: cos=-0.0612
[S11] DROPPED delta from S6 (cos=-0.0612 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1798) from S14
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.955501)
[S10] loaded HEAD from S14 (vec_in norm=1.955501)
[S10] cosine check vs S14: cos=-0.0667
[S10] DROPPED delta from S14 (cos=-0.0667 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1804) from S16
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.358713)
[S8] loaded HEAD from S16 (vec_in norm=1.358713)
[S8] cosine check vs S16: cos=0.3491
[S8] BUFFERED delta from S16 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1794) from S7
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.770149)
[S10] loaded HEAD from S7 (vec_in norm=1.770149)
[S10] cosine check vs S7: cos=0.9962
[S10] BUFFERED delta from S7 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1799) from S9
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=2.111882)
[S17] loaded HEAD from S9 (vec_in norm=2.111882)
[S17] cosine check vs S9: cos=-0.0618
[S17] DROPPED delta from S9 (cos=-0.0618 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1798) from S13
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=2.103937)
[S9] loaded HEAD from S13 (vec_in norm=2.103937)
[S9] cosine check vs S13: cos=0.9994
[S9] BUFFERED delta from S13 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1809) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.819255)
[S7] loaded HEAD from S10 (vec_in norm=1.819255)
[S7] cosine check vs S10: cos=0.9962
[S7] BUFFERED delta from S10 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1795) from S4
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=2.110405)
[S14] loaded HEAD from S4 (vec_in norm=2.110405)
[S14] cosine check vs S4: cos=-0.0970
[S14] DROPPED delta from S4 (cos=-0.0970 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=26 metric=0.7140 head_norm=1.401814
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.876284e-01
[S8] stored merged vector for next round verification (round=26)
[S8] DEBUG after merge:  round=26 metric=0.9962 head_norm=1.133681 delta_norm=0.787628
[S8] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=26 metric=0.9950 head_norm=2.111882
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.737206e-02
[S9] stored merged vector for next round verification (round=26)
[S9] DEBUG after merge:  round=26 metric=0.9950 head_norm=2.107582 delta_norm=0.037372
[S9] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=26 metric=0.6514 head_norm=1.770149
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.221478e-02
[S7] stored merged vector for next round verification (round=26)
[S7] DEBUG after merge:  round=26 metric=0.6470 head_norm=1.792986 delta_norm=0.082215
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=26 metric=0.8645 head_norm=1.819255
[S10] _apply_head_vector_avg (torch): Δ‖w‖=8.221478e-02
[S10] stored merged vector for next round verification (round=26)
[S10] DEBUG after merge:  round=26 metric=0.8635 head_norm=1.792986 delta_norm=0.082215
[S10] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=27 head_norm_before_train=1.856528 (no previous merge yet)
[S2] round=27 local utility u=0.598376 metrics={'f1_val': 0.9790319456154146, 'auprc': 0.9892554541802099, 'loss_val': 0.1158609328454695, 'psi': 0.9831213490413326}-{'f1_val': 0.815046141463775, 'auprc': 0.9548627078674677, 'loss_val': 0.22551949262343804, 'psi': 0.8709727680252521}
[S3] START round=27 head_norm_before_train=2.141887 (no previous merge yet)
[S3] round=27 local utility u=0.000000 metrics={'f1_val': 0.9333518087827101, 'auprc': 0.9985596389602326, 'loss_val': 0.12072678550484364, 'psi': 0.959434940853719}-{'f1_val': 0.9519279065516568, 'auprc': 0.9985126030854593, 'loss_val': 0.11622883203533199, 'psi': 0.9705617851651778}
[S4] START round=27 head_norm_before_train=2.110405 cos_to_last_merge=0.9998 (last merge round=24)
[S4] round=27 local utility u=0.000000 metrics={'f1_val': 0.9449956058605958, 'auprc': 0.9679567501288608, 'loss_val': 0.2556120272374311, 'psi': 0.9541800635679019}-{'f1_val': 0.9537231057730021, 'auprc': 0.9709378082760586, 'loss_val': 0.23671113839204128, 'psi': 0.9606089867742247}
[S5] START round=27 head_norm_before_train=1.729312 cos_to_last_merge=0.7989 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.799
[S5] round=27 local utility u=0.034179 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9973175738731533, 'loss_val': 0.03618367790326554, 'psi': 0.9969482106363359}-{'f1_val': 0.9955957911086084, 'auprc': 0.9907803513930875, 'loss_val': 0.07829271976191422, 'psi': 0.9936696152224}
[S6] START round=27 head_norm_before_train=1.751465 (no previous merge yet)
[S6] round=27 local utility u=0.000000 metrics={'f1_val': 0.605148099198359, 'auprc': 0.9499883860508791, 'loss_val': 0.7999881281897722, 'psi': 0.743084213939367}-{'f1_val': 0.8219348513852522, 'auprc': 0.9620799856708575, 'loss_val': 0.3988495541098515, 'psi': 0.8779929050994943}
[S7] START round=27 head_norm_before_train=1.792986 cos_to_last_merge=1.0000 (last merge round=26)
[S7] round=27 local utility u=0.272396 metrics={'f1_val': 0.6954614447103661, 'auprc': 0.8463045377428593, 'loss_val': 0.3028006328640825, 'psi': 0.7557986819233633}-{'f1_val': 0.6513573424011204, 'auprc': 0.8043167178371707, 'loss_val': 0.457005192079896, 'psi': 0.7125410925755405}
[S8] START round=27 head_norm_before_train=1.133681 cos_to_last_merge=1.0000 (last merge round=26)
[S8] round=27 local utility u=0.926074 metrics={'f1_val': 0.9960539056390789, 'auprc': 0.9909666498568024, 'loss_val': 0.25726196138269025, 'psi': 0.9940190033261682}-{'f1_val': 0.7140186993020905, 'auprc': 0.9908891846906506, 'loss_val': 0.41696630588720596, 'psi': 0.8247668934575145}
[S9] START round=27 head_norm_before_train=2.107582 cos_to_last_merge=1.0000 (last merge round=26)
[S9] round=27 local utility u=0.000000 metrics={'f1_val': 0.9909938198082651, 'auprc': 0.9994973643581084, 'loss_val': 0.03247743025912394, 'psi': 0.9943952376282024}-{'f1_val': 0.9950237510807955, 'auprc': 0.9995103092910258, 'loss_val': 0.020957269871764668, 'psi': 0.9968183743648877}
[S10] START round=27 head_norm_before_train=1.792986 cos_to_last_merge=1.0000 (last merge round=26)
[S10] round=27 local utility u=0.056116 metrics={'f1_val': 0.8786929032579358, 'auprc': 0.9946405161083317, 'loss_val': 0.2912327475641169, 'psi': 0.9250719483980943}-{'f1_val': 0.8644587754880946, 'auprc': 0.9947206963753139, 'loss_val': 0.31830036341100404, 'psi': 0.9165635438429822}
[S11] START round=27 head_norm_before_train=1.937668 (no previous merge yet)
[S11] round=27 local utility u=0.286575 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9980366211856194, 'loss_val': 0.028608704232474944, 'psi': 0.9969977489555644}-{'f1_val': 0.9458680019864427, 'auprc': 0.9920302349550099, 'loss_val': 0.28111562011303914, 'psi': 0.9643328951738697}
[S13] START round=27 head_norm_before_train=2.103937 cos_to_last_merge=1.0000 (last merge round=25)
[S13] round=27 local utility u=0.000000 metrics={'f1_val': 0.5506353355769099, 'auprc': 0.6733923588117001, 'loss_val': 0.9093751282496358, 'psi': 0.599738144870826}-{'f1_val': 0.602995078227972, 'auprc': 0.665834292598757, 'loss_val': 0.7885323020779623, 'psi': 0.6281307639762861}
[S14] START round=27 head_norm_before_train=1.955501 cos_to_last_merge=0.9999 (last merge round=25)
[S14] round=27 local utility u=0.001518 metrics={'f1_val': 0.9971882020035234, 'auprc': 0.9969749560032494, 'loss_val': 0.047630377483103746, 'psi': 0.9971029036034138}-{'f1_val': 0.9978195179672185, 'auprc': 0.9981659872206075, 'loss_val': 0.058028177242380644, 'psi': 0.997958105668574}
[S15] START round=27 head_norm_before_train=1.691508 cos_to_last_merge=0.7828 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.783
[S15] round=27 local utility u=0.028706 metrics={'f1_val': 0.9936633481384236, 'auprc': 0.9959355315822548, 'loss_val': 0.05594944291276661, 'psi': 0.9945722215159561}-{'f1_val': 0.9896196349177863, 'auprc': 0.9933896441757402, 'loss_val': 0.08146096708658067, 'psi': 0.9911276386209678}
[S16] START round=27 head_norm_before_train=1.358713 cos_to_last_merge=0.9994 (last merge round=25)
[S16] round=27 local utility u=0.252895 metrics={'f1_val': 0.9913812303173498, 'auprc': 0.9908649049046548, 'loss_val': 0.11902660909846427, 'psi': 0.9911747001522717}-{'f1_val': 0.933231986384208, 'auprc': 0.9950642827453083, 'loss_val': 0.28851855742665355, 'psi': 0.957964904928648}
[S17] START round=27 head_norm_before_train=1.627693 (no previous merge yet)
[S17] round=27 local utility u=0.627523 metrics={'f1_val': 0.6546124424892122, 'auprc': 0.9588544904923164, 'loss_val': 0.46574737779541725, 'psi': 0.7763092616904539}-{'f1_val': 0.462235851993875, 'auprc': 0.9551630157124574, 'loss_val': 0.5554603619576387, 'psi': 0.659406717481308}
[S7] not sending this round → trigger blocked (psi=0.756)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S5] sending update (kind=head size=1807 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:37107
[S15] not sending this round → trigger blocked (psi=0.995)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:37117
[S10] not sending this round → trigger blocked (psi=0.925)
[S16] not sending this round → trigger blocked (psi=0.991)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S14] not sending this round → trigger blocked (psi=0.997)
[S8] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1802) from S11
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.943476)
[S6] loaded HEAD from S11 (vec_in norm=1.943476)
[S6] cosine check vs S11: cos=-0.0621
[S6] DROPPED delta from S11 (cos=-0.0621 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1797) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.180972)
[S17] loaded HEAD from S8 (vec_in norm=1.180972)
[S17] cosine check vs S8: cos=-0.0832
[S17] DROPPED delta from S8 (cos=-0.0832 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:37109
[S17] sending update (kind=head size=1799 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1799) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.646516)
[S8] loaded HEAD from S17 (vec_in norm=1.646516)
[S8] cosine check vs S17: cos=-0.0832
[S8] DROPPED delta from S17 (cos=-0.0832 < 0.0)
[S2] START round=28 head_norm_before_train=1.866779 (no previous merge yet)
[S2] round=28 local utility u=0.024145 metrics={'f1_val': 0.9915711623785793, 'auprc': 0.9850584255378787, 'loss_val': 0.13021566025139603, 'psi': 0.9889660676422991}-{'f1_val': 0.9790319456154146, 'auprc': 0.9892554541802099, 'loss_val': 0.1158609328454695, 'psi': 0.9831213490413326}
[S3] START round=28 head_norm_before_train=2.156547 (no previous merge yet)
[S3] round=28 local utility u=0.169448 metrics={'f1_val': 0.9795891289279642, 'auprc': 0.9986771217368983, 'loss_val': 0.05960677764219314, 'psi': 0.9872243260515379}-{'f1_val': 0.9333518087827101, 'auprc': 0.9985596389602326, 'loss_val': 0.12072678550484364, 'psi': 0.959434940853719}
[S4] START round=28 head_norm_before_train=2.121676 cos_to_last_merge=0.9995 (last merge round=24)
[S4] round=28 local utility u=0.015367 metrics={'f1_val': 0.9467774169415365, 'auprc': 0.9715963767560241, 'loss_val': 0.24648788117369375, 'psi': 0.9567050008673315}-{'f1_val': 0.9449956058605958, 'auprc': 0.9679567501288608, 'loss_val': 0.2556120272374311, 'psi': 0.9541800635679019}
[S5] START round=28 head_norm_before_train=1.752051 cos_to_last_merge=0.7967 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.797
[S5] round=28 local utility u=0.004250 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9985752026915524, 'loss_val': 0.03145662222820678, 'psi': 0.9974512621636955}-{'f1_val': 0.9967019684784577, 'auprc': 0.9973175738731533, 'loss_val': 0.03618367790326554, 'psi': 0.9969482106363359}
[S6] START round=28 head_norm_before_train=1.766138 (no previous merge yet)
[S6] round=28 local utility u=0.678371 metrics={'f1_val': 0.7896918917222772, 'auprc': 0.922906629738478, 'loss_val': 0.469264576130763, 'psi': 0.8429777869287575}-{'f1_val': 0.605148099198359, 'auprc': 0.9499883860508791, 'loss_val': 0.7999881281897722, 'psi': 0.743084213939367}
[S7] START round=28 head_norm_before_train=1.796993 cos_to_last_merge=1.0000 (last merge round=26)
[S7] round=28 local utility u=0.034192 metrics={'f1_val': 0.6923330735947284, 'auprc': 0.8631102580730234, 'loss_val': 0.2660631818762154, 'psi': 0.7606439473860465}-{'f1_val': 0.6954614447103661, 'auprc': 0.8463045377428593, 'loss_val': 0.3028006328640825, 'psi': 0.7557986819233633}
[S8] START round=28 head_norm_before_train=1.180972 cos_to_last_merge=0.9976 (last merge round=26)
[S8] round=28 local utility u=0.047943 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9970941914597815, 'loss_val': 0.18065355928546056, 'psi': 0.9965595386240043}-{'f1_val': 0.9960539056390789, 'auprc': 0.9909666498568024, 'loss_val': 0.25726196138269025, 'psi': 0.9940190033261682}
[S9] START round=28 head_norm_before_train=2.117567 cos_to_last_merge=1.0000 (last merge round=26)
[S9] round=28 local utility u=0.016680 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9944754474322681, 'loss_val': 0.018243152834703402, 'psi': 0.9958056737317645}-{'f1_val': 0.9909938198082651, 'auprc': 0.9994973643581084, 'loss_val': 0.03247743025912394, 'psi': 0.9943952376282024}
[S10] START round=28 head_norm_before_train=1.814412 cos_to_last_merge=0.9998 (last merge round=26)
[S10] round=28 local utility u=0.000000 metrics={'f1_val': 0.8601763998611658, 'auprc': 0.9944826748197995, 'loss_val': 0.32749798022887777, 'psi': 0.9138989098446193}-{'f1_val': 0.8786929032579358, 'auprc': 0.9946405161083317, 'loss_val': 0.2912327475641169, 'psi': 0.9250719483980943}
[S11] START round=28 head_norm_before_train=1.943476 (no previous merge yet)
[S11] round=28 local utility u=0.000000 metrics={'f1_val': 0.9563848619984399, 'auprc': 0.9980905995548712, 'loss_val': 0.13395654117603895, 'psi': 0.9730671570210123}-{'f1_val': 0.996305167468861, 'auprc': 0.9980366211856194, 'loss_val': 0.028608704232474944, 'psi': 0.9969977489555644}
[S13] START round=28 head_norm_before_train=2.111371 cos_to_last_merge=0.9998 (last merge round=25)
[S13] round=28 local utility u=0.000000 metrics={'f1_val': 0.598510975681027, 'auprc': 0.5472646279278777, 'loss_val': 0.8621773323554166, 'psi': 0.5780124365797672}-{'f1_val': 0.5506353355769099, 'auprc': 0.6733923588117001, 'loss_val': 0.9093751282496358, 'psi': 0.599738144870826}
[S14] START round=28 head_norm_before_train=1.975136 cos_to_last_merge=0.9996 (last merge round=25)
[S14] round=28 local utility u=0.002305 metrics={'f1_val': 0.9971882020035234, 'auprc': 0.9969760971301294, 'loss_val': 0.0430239585896877, 'psi': 0.9971033600541658}-{'f1_val': 0.9971882020035234, 'auprc': 0.9969749560032494, 'loss_val': 0.047630377483103746, 'psi': 0.9971029036034138}
[S15] START round=28 head_norm_before_train=1.708931 cos_to_last_merge=0.7800 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.780
[S15] round=28 local utility u=0.000000 metrics={'f1_val': 0.7810626279035847, 'auprc': 0.9888880745005819, 'loss_val': 0.24864724863810383, 'psi': 0.8641928065423836}-{'f1_val': 0.9936633481384236, 'auprc': 0.9959355315822548, 'loss_val': 0.05594944291276661, 'psi': 0.9945722215159561}
[S16] START round=28 head_norm_before_train=1.393874 cos_to_last_merge=0.9980 (last merge round=25)
[S16] round=28 local utility u=0.000000 metrics={'f1_val': 0.9886390062486375, 'auprc': 0.9905490551343029, 'loss_val': 0.11955242151014321, 'psi': 0.9894030258029037}-{'f1_val': 0.9913812303173498, 'auprc': 0.9908649049046548, 'loss_val': 0.11902660909846427, 'psi': 0.9911747001522717}
[S17] START round=28 head_norm_before_train=1.646516 (no previous merge yet)
[S17] round=28 local utility u=0.000000 metrics={'f1_val': 0.4662032821346005, 'auprc': 0.8975274160959902, 'loss_val': 0.6582519478362664, 'psi': 0.6387329357191563}-{'f1_val': 0.6546124424892122, 'auprc': 0.9588544904923164, 'loss_val': 0.46574737779541725, 'psi': 0.7763092616904539}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:37112
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:37114
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] → sending delta(kind=head bytes=1805) to S10@127.0.0.1:37111
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S8] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:37117
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.989)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:37111
[S5] not sending this round → trigger blocked (psi=0.997)
[S14] sending update (kind=head size=1805 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1805) from S14
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.995722)
[S10] loaded HEAD from S14 (vec_in norm=1.995722)
[S10] cosine check vs S14: cos=-0.0669
[S10] DROPPED delta from S14 (cos=-0.0669 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1800) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.779036)
[S11] loaded HEAD from S6 (vec_in norm=1.779036)
[S11] cosine check vs S6: cos=-0.0619
[S11] DROPPED delta from S6 (cos=-0.0619 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1801) from S9
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=2.128651)
[S17] loaded HEAD from S9 (vec_in norm=2.128651)
[S17] cosine check vs S9: cos=-0.0580
[S17] DROPPED delta from S9 (cos=-0.0580 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1798) from S4
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=2.133369)
[S14] loaded HEAD from S4 (vec_in norm=2.133369)
[S14] cosine check vs S4: cos=-0.0954
[S14] DROPPED delta from S4 (cos=-0.0954 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1799) from S7
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.805187)
[S10] loaded HEAD from S7 (vec_in norm=1.805187)
[S10] cosine check vs S7: cos=0.9992
[S10] BUFFERED delta from S7 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=28 metric=0.8602 head_norm=1.838696
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.939356e-02
[S10] stored merged vector for next round verification (round=28)
[S10] DEBUG after merge:  round=28 metric=0.8595 head_norm=1.821592 delta_norm=0.039394
[S10] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=29 head_norm_before_train=1.874972 (no previous merge yet)
[S2] round=29 local utility u=0.000000 metrics={'f1_val': 0.8427720511200213, 'auprc': 0.9777248646925734, 'loss_val': 0.21318794196057833, 'psi': 0.8967531765490422}-{'f1_val': 0.9915711623785793, 'auprc': 0.9850584255378787, 'loss_val': 0.13021566025139603, 'psi': 0.9889660676422991}
[S3] START round=29 head_norm_before_train=2.174821 (no previous merge yet)
[S3] round=29 local utility u=0.000000 metrics={'f1_val': 0.9756541296380388, 'auprc': 0.9984584736615366, 'loss_val': 0.05914028167174775, 'psi': 0.9847758672474378}-{'f1_val': 0.9795891289279642, 'auprc': 0.9986771217368983, 'loss_val': 0.05960677764219314, 'psi': 0.9872243260515379}
[S4] START round=29 head_norm_before_train=2.133369 cos_to_last_merge=0.9991 (last merge round=24)
[S4] round=29 local utility u=0.000000 metrics={'f1_val': 0.9434219431638606, 'auprc': 0.9604994429029606, 'loss_val': 0.26622591281885494, 'psi': 0.9502529430595006}-{'f1_val': 0.9467774169415365, 'auprc': 0.9715963767560241, 'loss_val': 0.24648788117369375, 'psi': 0.9567050008673315}
[S5] START round=29 head_norm_before_train=1.767583 cos_to_last_merge=0.7956 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.796
[S5] round=29 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9923267868050024, 'loss_val': 0.039080991462372705, 'psi': 0.994731001900135}-{'f1_val': 0.9967019684784577, 'auprc': 0.9985752026915524, 'loss_val': 0.03145662222820678, 'psi': 0.9974512621636955}
[S6] START round=29 head_norm_before_train=1.779036 (no previous merge yet)
[S6] round=29 local utility u=0.361319 metrics={'f1_val': 0.8688383142134525, 'auprc': 0.9479091143672957, 'loss_val': 0.2965118078618203, 'psi': 0.9004666342749897}-{'f1_val': 0.7896918917222772, 'auprc': 0.922906629738478, 'loss_val': 0.469264576130763, 'psi': 0.8429777869287575}
[S7] START round=29 head_norm_before_train=1.805187 cos_to_last_merge=1.0000 (last merge round=26)
[S7] round=29 local utility u=0.000000 metrics={'f1_val': 0.46298629658851786, 'auprc': 0.7758107004010119, 'loss_val': 1.2336144313097344, 'psi': 0.5881160581135154}-{'f1_val': 0.6923330735947284, 'auprc': 0.8631102580730234, 'loss_val': 0.2660631818762154, 'psi': 0.7606439473860465}
[S8] START round=29 head_norm_before_train=1.236564 cos_to_last_merge=0.9912 (last merge round=26)
[S8] round=29 local utility u=0.013186 metrics={'f1_val': 0.9953051132645551, 'auprc': 0.9948223018889102, 'loss_val': 0.14207874853194294, 'psi': 0.9951119887142971}-{'f1_val': 0.9962031034001528, 'auprc': 0.9970941914597815, 'loss_val': 0.18065355928546056, 'psi': 0.9965595386240043}
[S9] START round=29 head_norm_before_train=2.128651 cos_to_last_merge=1.0000 (last merge round=26)
[S9] round=29 local utility u=0.006688 metrics={'f1_val': 0.9964388212112862, 'auprc': 0.999372182308251, 'loss_val': 0.01803618455888755, 'psi': 0.9976121656500722}-{'f1_val': 0.9966924912647621, 'auprc': 0.9944754474322681, 'loss_val': 0.018243152834703402, 'psi': 0.9958056737317645}
[S10] START round=29 head_norm_before_train=1.821592 cos_to_last_merge=1.0000 (last merge round=28)
[S10] round=29 local utility u=0.000000 metrics={'f1_val': 0.8475414751408371, 'auprc': 0.9946017578109381, 'loss_val': 0.3447563306641172, 'psi': 0.9063655882088775}-{'f1_val': 0.8601763998611658, 'auprc': 0.9944826748197995, 'loss_val': 0.32749798022887777, 'psi': 0.9138989098446193}
[S11] START round=29 head_norm_before_train=1.948120 (no previous merge yet)
[S11] round=29 local utility u=0.172316 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9980932169273148, 'loss_val': 0.028853641401753533, 'psi': 0.9970203872522425}-{'f1_val': 0.9563848619984399, 'auprc': 0.9980905995548712, 'loss_val': 0.13395654117603895, 'psi': 0.9730671570210123}
[S13] START round=29 head_norm_before_train=2.119498 cos_to_last_merge=0.9997 (last merge round=25)
[S13] round=29 local utility u=0.000000 metrics={'f1_val': 0.5491194729057096, 'auprc': 0.6429343444627869, 'loss_val': 1.0403293885189893, 'psi': 0.5866454215285406}-{'f1_val': 0.598510975681027, 'auprc': 0.5472646279278777, 'loss_val': 0.8621773323554166, 'psi': 0.5780124365797672}
[S14] START round=29 head_norm_before_train=1.995722 cos_to_last_merge=0.9991 (last merge round=25)
[S14] round=29 local utility u=0.001516 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9966009732891881, 'loss_val': 0.03917998153771989, 'psi': 0.9969846033391511}-{'f1_val': 0.9971882020035234, 'auprc': 0.9969760971301294, 'loss_val': 0.0430239585896877, 'psi': 0.9971033600541658}
[S15] START round=29 head_norm_before_train=1.724281 cos_to_last_merge=0.7774 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.777
[S15] round=29 local utility u=0.090737 metrics={'f1_val': 0.8147158097119072, 'auprc': 0.9910721549728195, 'loss_val': 0.27564498137469623, 'psi': 0.8852583478162721}-{'f1_val': 0.7810626279035847, 'auprc': 0.9888880745005819, 'loss_val': 0.24864724863810383, 'psi': 0.8641928065423836}
[S16] START round=29 head_norm_before_train=1.427414 cos_to_last_merge=0.9961 (last merge round=25)
[S16] round=29 local utility u=0.031557 metrics={'f1_val': 0.9912297924101175, 'auprc': 0.9955084061192288, 'loss_val': 0.0868602615308937, 'psi': 0.992941237893762}-{'f1_val': 0.9886390062486375, 'auprc': 0.9905490551343029, 'loss_val': 0.11955242151014321, 'psi': 0.9894030258029037}
[S17] START round=29 head_norm_before_train=1.665718 (no previous merge yet)
[S17] round=29 local utility u=0.765299 metrics={'f1_val': 0.7014727826294582, 'auprc': 0.8949794123707198, 'loss_val': 0.5316269785230013, 'psi': 0.7788754345259629}-{'f1_val': 0.4662032821346005, 'auprc': 0.8975274160959902, 'loss_val': 0.6582519478362664, 'psi': 0.6387329357191563}
[S6] not sending this round → trigger blocked (psi=0.900)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.998)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] → sending delta(kind=head bytes=1805) to S8@127.0.0.1:37109
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] sending update (kind=head size=1794 to 1 peers)
[S14] not sending this round → trigger blocked (psi=0.997)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:37107
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:37117
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1805 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1805) from S16
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.457860)
[S8] loaded HEAD from S16 (vec_in norm=1.457860)
[S8] cosine check vs S16: cos=0.8104
[S8] BUFFERED delta from S16 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1795) from S11
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.957481)
[S6] loaded HEAD from S11 (vec_in norm=1.957481)
[S6] cosine check vs S11: cos=-0.0616
[S6] DROPPED delta from S11 (cos=-0.0616 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1797) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.291263)
[S17] loaded HEAD from S8 (vec_in norm=1.291263)
[S17] cosine check vs S8: cos=-0.0757
[S17] DROPPED delta from S8 (cos=-0.0757 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S17] → sending delta(kind=head bytes=1808) to S8@127.0.0.1:37109
[S17] sending update (kind=head size=1808 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1808) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.684772)
[S8] loaded HEAD from S17 (vec_in norm=1.684772)
[S8] cosine check vs S17: cos=-0.0757
[S8] DROPPED delta from S17 (cos=-0.0757 < 0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=29 metric=0.9953 head_norm=1.291263
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.305899e-01
[S8] stored merged vector for next round verification (round=29)
[S8] DEBUG after merge:  round=29 metric=0.9961 head_norm=1.308033 delta_norm=0.430590
[S8] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=30 head_norm_before_train=1.885181 (no previous merge yet)
[S2] round=30 local utility u=0.427505 metrics={'f1_val': 0.9610457823456298, 'auprc': 0.9882308940372505, 'loss_val': 0.0993391125948101, 'psi': 0.9719198270222781}-{'f1_val': 0.8427720511200213, 'auprc': 0.9777248646925734, 'loss_val': 0.21318794196057833, 'psi': 0.8967531765490422}
[S3] START round=30 head_norm_before_train=2.191471 (no previous merge yet)
[S3] round=30 local utility u=0.000000 metrics={'f1_val': 0.8511854264125294, 'auprc': 0.9987396966473288, 'loss_val': 0.2742647081308574, 'psi': 0.9102071345064492}-{'f1_val': 0.9756541296380388, 'auprc': 0.9984584736615366, 'loss_val': 0.05914028167174775, 'psi': 0.9847758672474378}
[S4] START round=30 head_norm_before_train=2.144218 cos_to_last_merge=0.9987 (last merge round=24)
[S4] round=30 local utility u=0.039090 metrics={'f1_val': 0.9484002874633918, 'auprc': 0.9703823531679153, 'loss_val': 0.24756426844484158, 'psi': 0.9571931137452012}-{'f1_val': 0.9434219431638606, 'auprc': 0.9604994429029606, 'loss_val': 0.26622591281885494, 'psi': 0.9502529430595006}
[S5] START round=30 head_norm_before_train=1.776953 cos_to_last_merge=0.7948 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.795
[S5] round=30 local utility u=0.011691 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9970569700565788, 'loss_val': 0.03209838243040946, 'psi': 0.9968439691097062}-{'f1_val': 0.9963338119635569, 'auprc': 0.9923267868050024, 'loss_val': 0.039080991462372705, 'psi': 0.994731001900135}
[S6] START round=30 head_norm_before_train=1.789970 (no previous merge yet)
[S6] round=30 local utility u=0.000000 metrics={'f1_val': 0.6130554394556921, 'auprc': 0.9414145837785282, 'loss_val': 0.878037792198385, 'psi': 0.7443990971848264}-{'f1_val': 0.8688383142134525, 'auprc': 0.9479091143672957, 'loss_val': 0.2965118078618203, 'psi': 0.9004666342749897}
[S7] START round=30 head_norm_before_train=1.812367 cos_to_last_merge=0.9999 (last merge round=26)
[S7] round=30 local utility u=1.000000 metrics={'f1_val': 0.6975220539970455, 'auprc': 0.8454133243159165, 'loss_val': 0.32164971844518586, 'psi': 0.756678562124594}-{'f1_val': 0.46298629658851786, 'auprc': 0.7758107004010119, 'loss_val': 1.2336144313097344, 'psi': 0.5881160581135154}
[S8] START round=30 head_norm_before_train=1.308033 cos_to_last_merge=1.0000 (last merge round=29)
[S8] round=30 local utility u=0.012843 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9972652266041588, 'loss_val': 0.12910909718680666, 'psi': 0.9966279526817552}-{'f1_val': 0.9953051132645551, 'auprc': 0.9948223018889102, 'loss_val': 0.14207874853194294, 'psi': 0.9951119887142971}
[S9] START round=30 head_norm_before_train=2.137494 cos_to_last_merge=0.9999 (last merge round=26)
[S9] round=30 local utility u=0.000000 metrics={'f1_val': 0.993909773892786, 'auprc': 0.9999129079773141, 'loss_val': 0.02378651648864464, 'psi': 0.9963110275265973}-{'f1_val': 0.9964388212112862, 'auprc': 0.999372182308251, 'loss_val': 0.01803618455888755, 'psi': 0.9976121656500722}
[S10] START round=30 head_norm_before_train=1.848166 cos_to_last_merge=0.9998 (last merge round=28)
[S10] round=30 local utility u=0.046930 metrics={'f1_val': 0.8590805302015647, 'auprc': 0.994738518986546, 'loss_val': 0.32054184827386706, 'psi': 0.9133437257155572}-{'f1_val': 0.8475414751408371, 'auprc': 0.9946017578109381, 'loss_val': 0.3447563306641172, 'psi': 0.9063655882088775}
[S11] START round=30 head_norm_before_train=1.957481 (no previous merge yet)
[S11] round=30 local utility u=0.000978 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9980905085498719, 'loss_val': 0.026889723954287684, 'psi': 0.9970193039012654}-{'f1_val': 0.996305167468861, 'auprc': 0.9980932169273148, 'loss_val': 0.028853641401753533, 'psi': 0.9970203872522425}
[S13] START round=30 head_norm_before_train=2.126243 cos_to_last_merge=0.9996 (last merge round=25)
[S13] round=30 local utility u=0.461116 metrics={'f1_val': 0.6101111381340161, 'auprc': 0.6781331194067786, 'loss_val': 0.5896446605252387, 'psi': 0.637319930643121}-{'f1_val': 0.5491194729057096, 'auprc': 0.6429343444627869, 'loss_val': 1.0403293885189893, 'psi': 0.5866454215285406}
[S14] START round=30 head_norm_before_train=2.014917 cos_to_last_merge=0.9985 (last merge round=25)
[S14] round=30 local utility u=0.000969 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9968614800228661, 'loss_val': 0.036565649811598204, 'psi': 0.9969430969037455}-{'f1_val': 0.997240356705793, 'auprc': 0.9966009732891881, 'loss_val': 0.03917998153771989, 'psi': 0.9969846033391511}
[S15] START round=30 head_norm_before_train=1.739919 cos_to_last_merge=0.7747 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.775
[S15] round=30 local utility u=0.645783 metrics={'f1_val': 0.9905273982298197, 'auprc': 0.9964947507466682, 'loss_val': 0.05521629987556074, 'psi': 0.992914339236559}-{'f1_val': 0.8147158097119072, 'auprc': 0.9910721549728195, 'loss_val': 0.27564498137469623, 'psi': 0.8852583478162721}
[S16] START round=30 head_norm_before_train=1.457860 cos_to_last_merge=0.9940 (last merge round=25)
[S16] round=30 local utility u=0.000000 metrics={'f1_val': 0.9911016916289577, 'auprc': 0.9836615429867638, 'loss_val': 0.08332695408210206, 'psi': 0.9881256321720802}-{'f1_val': 0.9912297924101175, 'auprc': 0.9955084061192288, 'loss_val': 0.0868602615308937, 'psi': 0.992941237893762}
[S17] START round=30 head_norm_before_train=1.684772 (no previous merge yet)
[S17] round=30 local utility u=0.159451 metrics={'f1_val': 0.7197481098536778, 'auprc': 0.9228504953090582, 'loss_val': 0.4059905227809362, 'psi': 0.8009890640358299}-{'f1_val': 0.7014727826294582, 'auprc': 0.8949794123707198, 'loss_val': 0.5316269785230013, 'psi': 0.7788754345259629}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:37114
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1798) from S4
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=2.155565)
[S14] loaded HEAD from S4 (vec_in norm=2.155565)
[S14] cosine check vs S4: cos=-0.0940
[S14] DROPPED delta from S4 (cos=-0.0940 < 0.0)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:37111
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:37117
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:37111
[S8] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:37108
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:37110
[S7] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] sending update (kind=head size=1802 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] RECEIVED delta(kind=head bytes=1800) from S7
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.814710)
[S10] loaded HEAD from S7 (vec_in norm=1.814710)
[S10] cosine check vs S7: cos=0.9980
[S10] BUFFERED delta from S7 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1802) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.350345)
[S17] loaded HEAD from S8 (vec_in norm=1.350345)
[S17] cosine check vs S8: cos=-0.0544
[S17] DROPPED delta from S8 (cos=-0.0544 < 0.0)
[S14] sending update (kind=head size=1797 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1797) from S14
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=2.033073)
[S10] loaded HEAD from S14 (vec_in norm=2.033073)
[S10] cosine check vs S14: cos=-0.0672
[S10] DROPPED delta from S14 (cos=-0.0672 < 0.0)
[S13] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1795) from S13
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=2.130132)
[S9] loaded HEAD from S13 (vec_in norm=2.130132)
[S9] cosine check vs S13: cos=0.9990
[S9] BUFFERED delta from S13 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1798) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.875300)
[S7] loaded HEAD from S10 (vec_in norm=1.875300)
[S7] cosine check vs S10: cos=0.9980
[S7] BUFFERED delta from S10 (total buffered=1)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:37107
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S17] → sending delta(kind=head bytes=1806) to S8@127.0.0.1:37109
[S17] sending update (kind=head size=1806 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1806) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.698973)
[S8] loaded HEAD from S17 (vec_in norm=1.698973)
[S8] cosine check vs S17: cos=-0.0544
[S8] DROPPED delta from S17 (cos=-0.0544 < 0.0)
[S11] sending update (kind=head size=1797 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1797) from S11
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.969802)
[S6] loaded HEAD from S11 (vec_in norm=1.969802)
[S6] cosine check vs S11: cos=-0.0623
[S6] DROPPED delta from S11 (cos=-0.0623 < 0.0)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] ⇄ pheromone p=0.036 → S14@127.0.0.1:37114
[S6] ⇄ pheromone p=0.326 → S11@127.0.0.1:37112
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=30 metric=0.6975 head_norm=1.814710
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.539475e-02
[S7] stored merged vector for next round verification (round=30)
[S7] DEBUG after merge:  round=30 metric=0.6975 head_norm=1.844094 delta_norm=0.065395
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.311 → S10@127.0.0.1:37111
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=30 metric=0.9939 head_norm=2.148982
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.890202e-02
[S9] stored merged vector for next round verification (round=30)
[S9] DEBUG after merge:  round=30 metric=0.9939 head_norm=2.139019 delta_norm=0.048902
[S9] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.010 → S17@127.0.0.1:37117
[S8] ⇄ pheromone p=0.183 → S17@127.0.0.1:37117
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=30 metric=0.8591 head_norm=1.875300
[S10] _apply_head_vector_avg (torch): Δ‖w‖=6.539475e-02
[S10] stored merged vector for next round verification (round=30)
[S10] DEBUG after merge:  round=30 metric=0.8584 head_norm=1.844094 delta_norm=0.065395
[S10] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.037 → S7@127.0.0.1:37108
[S17] ⇄ pheromone p=0.295 → S8@127.0.0.1:37109
[S14] ⇄ pheromone p=0.020 → S10@127.0.0.1:37111
[S16] ⇄ pheromone p=0.075 → S8@127.0.0.1:37109
[S13] ⇄ pheromone p=0.124 → S9@127.0.0.1:37110
[S11] ⇄ pheromone p=0.072 → S6@127.0.0.1:37107
[S2] START round=31 head_norm_before_train=1.896820 (no previous merge yet)
[S2] round=31 local utility u=0.098772 metrics={'f1_val': 0.9924122397951886, 'auprc': 0.9863180778641425, 'loss_val': 0.0842558903701804, 'psi': 0.9899745750227701}-{'f1_val': 0.9610457823456298, 'auprc': 0.9882308940372505, 'loss_val': 0.0993391125948101, 'psi': 0.9719198270222781}
[S3] START round=31 head_norm_before_train=2.204513 (no previous merge yet)
[S3] round=31 local utility u=0.000000 metrics={'f1_val': 0.8088637978670581, 'auprc': 0.9987318445754823, 'loss_val': 0.3898919060754354, 'psi': 0.8848110165504277}-{'f1_val': 0.8511854264125294, 'auprc': 0.9987396966473288, 'loss_val': 0.2742647081308574, 'psi': 0.9102071345064492}
[S4] START round=31 head_norm_before_train=2.155565 cos_to_last_merge=0.9983 (last merge round=24)
[S4] round=31 local utility u=0.000000 metrics={'f1_val': 0.9440523664323434, 'auprc': 0.9533030594534918, 'loss_val': 0.28121697941278123, 'psi': 0.9477526436408028}-{'f1_val': 0.9484002874633918, 'auprc': 0.9703823531679153, 'loss_val': 0.24756426844484158, 'psi': 0.9571931137452012}
[S5] START round=31 head_norm_before_train=1.787398 cos_to_last_merge=0.7932 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.793
[S5] round=31 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.992474386425539, 'loss_val': 0.03691752371885937, 'psi': 0.9947900417483497}-{'f1_val': 0.9967019684784577, 'auprc': 0.9970569700565788, 'loss_val': 0.03209838243040946, 'psi': 0.9968439691097062}
[S6] START round=31 head_norm_before_train=1.799448 (no previous merge yet)
[S6] round=31 local utility u=1.000000 metrics={'f1_val': 0.8640793805605005, 'auprc': 0.9575551671998008, 'loss_val': 0.3513071978468752, 'psi': 0.9014696952162207}-{'f1_val': 0.6130554394556921, 'auprc': 0.9414145837785282, 'loss_val': 0.878037792198385, 'psi': 0.7443990971848264}
[S7] START round=31 head_norm_before_train=1.844094 cos_to_last_merge=1.0000 (last merge round=30)
[S7] round=31 local utility u=0.000000 metrics={'f1_val': 0.6588634395319705, 'auprc': 0.7947312144340796, 'loss_val': 0.5013735171943104, 'psi': 0.713210549492814}-{'f1_val': 0.6975220539970455, 'auprc': 0.8454133243159165, 'loss_val': 0.32164971844518586, 'psi': 0.756678562124594}
[S8] START round=31 head_norm_before_train=1.350345 cos_to_last_merge=0.9991 (last merge round=29)
[S8] round=31 local utility u=0.013966 metrics={'f1_val': 0.9960539056390789, 'auprc': 0.998079345309111, 'loss_val': 0.10272346366265078, 'psi': 0.9968640815070917}-{'f1_val': 0.9962031034001528, 'auprc': 0.9972652266041588, 'loss_val': 0.12910909718680666, 'psi': 0.9966279526817552}
[S9] START round=31 head_norm_before_train=2.139019 cos_to_last_merge=1.0000 (last merge round=30)
[S9] round=31 local utility u=0.011452 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9999057053630238, 'loss_val': 0.01736516836116632, 'psi': 0.9979585892335444}-{'f1_val': 0.993909773892786, 'auprc': 0.9999129079773141, 'loss_val': 0.02378651648864464, 'psi': 0.9963110275265973}
[S10] START round=31 head_norm_before_train=1.844094 cos_to_last_merge=1.0000 (last merge round=30)
[S10] round=31 local utility u=0.000000 metrics={'f1_val': 0.8213620292458885, 'auprc': 0.994689335998987, 'loss_val': 0.39420608530781037, 'psi': 0.8906929519471279}-{'f1_val': 0.8590805302015647, 'auprc': 0.994738518986546, 'loss_val': 0.32054184827386706, 'psi': 0.9133437257155572}
[S11] START round=31 head_norm_before_train=1.969802 (no previous merge yet)
[S11] round=31 local utility u=0.000453 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9980902773172662, 'loss_val': 0.025982628308094977, 'psi': 0.997019211408223}-{'f1_val': 0.996305167468861, 'auprc': 0.9980905085498719, 'loss_val': 0.026889723954287684, 'psi': 0.9970193039012654}
[S13] START round=31 head_norm_before_train=2.130132 cos_to_last_merge=0.9994 (last merge round=25)
[S13] round=31 local utility u=0.000000 metrics={'f1_val': 0.5634279069488469, 'auprc': 0.6286177518038363, 'loss_val': 1.0173404679684015, 'psi': 0.5895038448908427}-{'f1_val': 0.6101111381340161, 'auprc': 0.6781331194067786, 'loss_val': 0.5896446605252387, 'psi': 0.637319930643121}
[S14] START round=31 head_norm_before_train=2.033073 cos_to_last_merge=0.9979 (last merge round=25)
[S14] round=31 local utility u=0.002068 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9954730681660566, 'loss_val': 0.03218679656531591, 'psi': 0.9967798980963348}-{'f1_val': 0.9969975081576651, 'auprc': 0.9968614800228661, 'loss_val': 0.036565649811598204, 'psi': 0.9969430969037455}
[S15] START round=31 head_norm_before_train=1.755463 cos_to_last_merge=0.7724 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.772
[S15] round=31 local utility u=0.000000 metrics={'f1_val': 0.8357539244796028, 'auprc': 0.9883618998707202, 'loss_val': 0.16551990916298953, 'psi': 0.8967971146360498}-{'f1_val': 0.9905273982298197, 'auprc': 0.9964947507466682, 'loss_val': 0.05521629987556074, 'psi': 0.992914339236559}
[S16] START round=31 head_norm_before_train=1.485803 cos_to_last_merge=0.9923 (last merge round=25)
[S16] round=31 local utility u=0.000000 metrics={'f1_val': 0.8489204117261452, 'auprc': 0.9923793409347486, 'loss_val': 0.6062832578608741, 'psi': 0.9063039834095865}-{'f1_val': 0.9911016916289577, 'auprc': 0.9836615429867638, 'loss_val': 0.08332695408210206, 'psi': 0.9881256321720802}
[S17] START round=31 head_norm_before_train=1.698973 (no previous merge yet)
[S17] round=31 local utility u=0.000000 metrics={'f1_val': 0.6659231379413608, 'auprc': 0.8735949805748888, 'loss_val': 0.6863535272020052, 'psi': 0.7489918749947719}-{'f1_val': 0.7197481098536778, 'auprc': 0.9228504953090582, 'loss_val': 0.4059905227809362, 'psi': 0.8009890640358299}
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S3]  timeout peer S2
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S4]  timeout peer S2
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S5]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S16
[S14]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S6]  timeout peer S17
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S2]  timeout peer S3
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[S8]  timeout peer S3
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S14
[S16]  timeout peer S17
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:37107
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:37117
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:37111
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:37112
[S14] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1797) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.811109)
[S11] loaded HEAD from S6 (vec_in norm=1.811109)
[S11] cosine check vs S6: cos=-0.0624
[S11] DROPPED delta from S6 (cos=-0.0624 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1803) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.390135)
[S17] loaded HEAD from S8 (vec_in norm=1.390135)
[S17] cosine check vs S8: cos=-0.0521
[S17] DROPPED delta from S8 (cos=-0.0521 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1802) from S14
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=2.050919)
[S10] loaded HEAD from S14 (vec_in norm=2.050919)
[S10] cosine check vs S14: cos=-0.0671
[S10] DROPPED delta from S14 (cos=-0.0671 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1801) from S11
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.983199)
[S6] loaded HEAD from S11 (vec_in norm=1.983199)
[S6] cosine check vs S11: cos=-0.0624
[S6] DROPPED delta from S11 (cos=-0.0624 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:37117
[S9] sending update (kind=head size=1799 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1799) from S9
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=2.146908)
[S17] loaded HEAD from S9 (vec_in norm=2.146908)
[S17] cosine check vs S9: cos=-0.0535
[S17] DROPPED delta from S9 (cos=-0.0535 < 0.0)
[S9] CommDone barrier timeout: have=2 need=3 — continuing
[S16] CommDone barrier timeout: have=1 need=2 — continuing
[S2] START round=32 head_norm_before_train=1.907000 (no previous merge yet)
[S2] round=32 local utility u=0.000000 metrics={'f1_val': 0.8393863461513518, 'auprc': 0.9790798902390194, 'loss_val': 0.22130940176059413, 'psi': 0.8952637637864189}-{'f1_val': 0.9924122397951886, 'auprc': 0.9863180778641425, 'loss_val': 0.0842558903701804, 'psi': 0.9899745750227701}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=32 head_norm_before_train=2.217249 (no previous merge yet)
[S3] round=32 local utility u=0.166302 metrics={'f1_val': 0.8478824162095456, 'auprc': 0.9984032115067012, 'loss_val': 0.29041377023010095, 'psi': 0.9080907343284078}-{'f1_val': 0.8088637978670581, 'auprc': 0.9987318445754823, 'loss_val': 0.3898919060754354, 'psi': 0.8848110165504277}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=32 head_norm_before_train=2.164442 cos_to_last_merge=0.9979 (last merge round=24)
[S4] round=32 local utility u=0.002094 metrics={'f1_val': 0.9443142736591262, 'auprc': 0.9532736969902182, 'loss_val': 0.2785131214326991, 'psi': 0.9478980429915631}-{'f1_val': 0.9440523664323434, 'auprc': 0.9533030594534918, 'loss_val': 0.28121697941278123, 'psi': 0.9477526436408028}
[S5] START round=32 head_norm_before_train=1.796225 cos_to_last_merge=0.7923 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.792
[S5] round=32 local utility u=0.008918 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9952408299462019, 'loss_val': 0.029589740085546205, 'psi': 0.9961175130655553}-{'f1_val': 0.9963338119635569, 'auprc': 0.992474386425539, 'loss_val': 0.03691752371885937, 'psi': 0.9947900417483497}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=32 head_norm_before_train=1.811109 (no previous merge yet)
[S6] round=32 local utility u=0.012274 metrics={'f1_val': 0.8617219825685962, 'auprc': 0.958900311029744, 'loss_val': 0.3166505548933211, 'psi': 0.9005933139530553}-{'f1_val': 0.8640793805605005, 'auprc': 0.9575551671998008, 'loss_val': 0.3513071978468752, 'psi': 0.9014696952162207}
[S7] START round=32 head_norm_before_train=1.842949 cos_to_last_merge=1.0000 (last merge round=30)
[S7] round=32 local utility u=0.000000 metrics={'f1_val': 0.5814082088584096, 'auprc': 0.7818896907472463, 'loss_val': 0.7646043804221577, 'psi': 0.6616008016139443}-{'f1_val': 0.6588634395319705, 'auprc': 0.7947312144340796, 'loss_val': 0.5013735171943104, 'psi': 0.713210549492814}
[S8] START round=32 head_norm_before_train=1.390135 cos_to_last_merge=0.9970 (last merge round=29)
[S8] round=32 local utility u=0.000000 metrics={'f1_val': 0.9960539056390789, 'auprc': 0.9920997851701691, 'loss_val': 0.08969964009839584, 'psi': 0.9944722574515149}-{'f1_val': 0.9960539056390789, 'auprc': 0.998079345309111, 'loss_val': 0.10272346366265078, 'psi': 0.9968640815070917}
[S9] START round=32 head_norm_before_train=2.146908 cos_to_last_merge=1.0000 (last merge round=30)
[S9] round=32 local utility u=0.000051 metrics={'f1_val': 0.9966891482978385, 'auprc': 0.9997473358751158, 'loss_val': 0.016958929348923797, 'psi': 0.9979124233287494}-{'f1_val': 0.9966605118138915, 'auprc': 0.9999057053630238, 'loss_val': 0.01736516836116632, 'psi': 0.9979585892335444}
[S10] START round=32 head_norm_before_train=1.868179 cos_to_last_merge=0.9998 (last merge round=30)
[S10] round=32 local utility u=0.093352 metrics={'f1_val': 0.8455327786637572, 'auprc': 0.9942204756156802, 'loss_val': 0.3511203657143656, 'psi': 0.9050078574445264}-{'f1_val': 0.8213620292458885, 'auprc': 0.994689335998987, 'loss_val': 0.39420608530781037, 'psi': 0.8906929519471279}
[S11] START round=32 head_norm_before_train=1.983199 (no previous merge yet)
[S11] round=32 local utility u=0.000827 metrics={'f1_val': 0.996305167468861, 'auprc': 0.998098079258697, 'loss_val': 0.024351355193861557, 'psi': 0.9970223321847953}-{'f1_val': 0.996305167468861, 'auprc': 0.9980902773172662, 'loss_val': 0.025982628308094977, 'psi': 0.997019211408223}
[S13] START round=32 head_norm_before_train=2.134677 cos_to_last_merge=0.9993 (last merge round=25)
[S13] round=32 local utility u=0.108550 metrics={'f1_val': 0.596869811551007, 'auprc': 0.5781314963980541, 'loss_val': 0.8494333082967371, 'psi': 0.5893744854898259}-{'f1_val': 0.5634279069488469, 'auprc': 0.6286177518038363, 'loss_val': 1.0173404679684015, 'psi': 0.5895038448908427}
[S14] START round=32 head_norm_before_train=2.050919 cos_to_last_merge=0.9973 (last merge round=25)
[S14] round=32 local utility u=0.001975 metrics={'f1_val': 0.9974310505072961, 'auprc': 0.9966046032724448, 'loss_val': 0.030311070680820375, 'psi': 0.9971004716133556}-{'f1_val': 0.9976511180498535, 'auprc': 0.9954730681660566, 'loss_val': 0.03218679656531591, 'psi': 0.9967798980963348}
[S15] START round=32 head_norm_before_train=1.769312 cos_to_last_merge=0.7706 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.771
[S15] round=32 local utility u=0.177910 metrics={'f1_val': 0.8964546589923497, 'auprc': 0.9931705729836254, 'loss_val': 0.18833032809713735, 'psi': 0.93514102458886}-{'f1_val': 0.8357539244796028, 'auprc': 0.9883618998707202, 'loss_val': 0.16551990916298953, 'psi': 0.8967971146360498}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] sending update (kind=head size=1802 to 1 peers)
[S16] START round=32 head_norm_before_train=1.511442 cos_to_last_merge=0.9905 (last merge round=25)
[S16] round=32 local utility u=0.447888 metrics={'f1_val': 0.9375845800701014, 'auprc': 0.9931424464019813, 'loss_val': 0.2447806549615596, 'psi': 0.9598077266028534}-{'f1_val': 0.8489204117261452, 'auprc': 0.9923793409347486, 'loss_val': 0.6062832578608741, 'psi': 0.9063039834095865}
[S17] START round=32 head_norm_before_train=1.711151 (no previous merge yet)
[S17] round=32 local utility u=0.162532 metrics={'f1_val': 0.6935774359143054, 'auprc': 0.8833860643487539, 'loss_val': 0.5565879716824572, 'psi': 0.7695008872880849}-{'f1_val': 0.6659231379413608, 'auprc': 0.8735949805748888, 'loss_val': 0.6863535272020052, 'psi': 0.7489918749947719}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S13] → sending delta(kind=head bytes=1790) to S9@127.0.0.1:37110
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:37112
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:37107
[S11] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:37114
[S13] sending update (kind=head size=1790 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:37108
[S11] RECEIVED delta(kind=head bytes=1800) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.823642)
[S11] loaded HEAD from S6 (vec_in norm=1.823642)
[S11] cosine check vs S6: cos=-0.0622
[S11] DROPPED delta from S6 (cos=-0.0622 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1790) from S13
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=2.139951)
[S9] loaded HEAD from S13 (vec_in norm=2.139951)
[S9] cosine check vs S13: cos=0.9995
[S9] BUFFERED delta from S13 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1801) from S11
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.996108)
[S6] loaded HEAD from S11 (vec_in norm=1.996108)
[S6] cosine check vs S11: cos=-0.0622
[S6] DROPPED delta from S11 (cos=-0.0622 < 0.0)
[S4] sending update (kind=head size=1798 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:37111
[S14] RECEIVED delta(kind=head bytes=1798) from S4
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=2.173428)
[S14] loaded HEAD from S4 (vec_in norm=2.173428)
[S14] cosine check vs S4: cos=-0.0933
[S14] DROPPED delta from S4 (cos=-0.0933 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1803) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.892360)
[S7] loaded HEAD from S10 (vec_in norm=1.892360)
[S7] cosine check vs S10: cos=0.9993
[S7] BUFFERED delta from S10 (total buffered=1)
[S14] sending update (kind=head size=1802 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1802) from S14
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=2.067626)
[S10] loaded HEAD from S14 (vec_in norm=2.067626)
[S10] cosine check vs S14: cos=-0.0668
[S10] DROPPED delta from S14 (cos=-0.0668 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:37109
[S17] sending update (kind=head size=1798 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1798) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.728011)
[S8] loaded HEAD from S17 (vec_in norm=1.728011)
[S8] cosine check vs S17: cos=-0.0500
[S8] DROPPED delta from S17 (cos=-0.0500 < 0.0)
[S16]  timeout peer S13
[S16]  timeout peer S15
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S17
[S8]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S14
[S14]  timeout peer S10
[S14]  timeout peer S11
[S13]  timeout peer S9
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:37113
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1801) from S9
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=2.158913)
[S13] loaded HEAD from S9 (vec_in norm=2.158913)
[S13] cosine check vs S9: cos=0.9995
[S13] BUFFERED delta from S9 (total buffered=1)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=32 metric=0.9967 head_norm=2.158913
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.597665e-02
[S9] stored merged vector for next round verification (round=32)
[S9] DEBUG after merge:  round=32 metric=0.9967 head_norm=2.149152 delta_norm=0.035977
[S9] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=33 head_norm_before_train=1.917295 (no previous merge yet)
[S2] round=33 local utility u=0.532384 metrics={'f1_val': 0.9931993347412358, 'auprc': 0.9846212560014295, 'loss_val': 0.09604285043182686, 'psi': 0.9897681032453133}-{'f1_val': 0.8393863461513518, 'auprc': 0.9790798902390194, 'loss_val': 0.22130940176059413, 'psi': 0.8952637637864189}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=33 head_norm_before_train=2.227124 (no previous merge yet)
[S3] round=33 local utility u=0.000000 metrics={'f1_val': 0.8157360735888932, 'auprc': 0.9985593525063783, 'loss_val': 0.3639404128618836, 'psi': 0.8888653851558872}-{'f1_val': 0.8478824162095456, 'auprc': 0.9984032115067012, 'loss_val': 0.29041377023010095, 'psi': 0.9080907343284078}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=33 head_norm_before_train=2.173428 cos_to_last_merge=0.9975 (last merge round=24)
[S4] round=33 local utility u=0.063097 metrics={'f1_val': 0.9577604644992566, 'auprc': 0.9633267916319405, 'loss_val': 0.263155187286869, 'psi': 0.9599869953523301}-{'f1_val': 0.9443142736591262, 'auprc': 0.9532736969902182, 'loss_val': 0.2785131214326991, 'psi': 0.9478980429915631}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=33 head_norm_before_train=1.803227 cos_to_last_merge=0.7907 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.791
[S5] round=33 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9925575925132794, 'loss_val': 0.0326277485833728, 'psi': 0.9948233241834459}-{'f1_val': 0.9967019684784577, 'auprc': 0.9952408299462019, 'loss_val': 0.029589740085546205, 'psi': 0.9961175130655553}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=33 head_norm_before_train=1.823642 (no previous merge yet)
[S6] round=33 local utility u=0.000000 metrics={'f1_val': 0.7275514559277534, 'auprc': 0.939646354847292, 'loss_val': 0.6716383181966836, 'psi': 0.8123894154955689}-{'f1_val': 0.8617219825685962, 'auprc': 0.958900311029744, 'loss_val': 0.3166505548933211, 'psi': 0.9005933139530553}
[S7] START round=33 head_norm_before_train=1.847214 cos_to_last_merge=1.0000 (last merge round=30)
[S7] round=33 local utility u=0.019681 metrics={'f1_val': 0.5893033392932252, 'auprc': 0.7829917181670051, 'loss_val': 0.7759197398476143, 'psi': 0.6667786908427371}-{'f1_val': 0.5814082088584096, 'auprc': 0.7818896907472463, 'loss_val': 0.7646043804221577, 'psi': 0.6616008016139443}
[S8] START round=33 head_norm_before_train=1.424402 cos_to_last_merge=0.9944 (last merge round=29)
[S8] round=33 local utility u=0.017628 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9980210571748973, 'loss_val': 0.07310234906511139, 'psi': 0.9969302849100506}-{'f1_val': 0.9960539056390789, 'auprc': 0.9920997851701691, 'loss_val': 0.08969964009839584, 'psi': 0.9944722574515149}
[S9] START round=33 head_norm_before_train=2.149152 cos_to_last_merge=1.0000 (last merge round=32)
[S9] round=33 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9979608422951791, 'loss_val': 0.016707483024339012, 'psi': 0.9974460844253573}-{'f1_val': 0.9966891482978385, 'auprc': 0.9997473358751158, 'loss_val': 0.016958929348923797, 'psi': 0.9979124233287494}
[S10] START round=33 head_norm_before_train=1.892360 cos_to_last_merge=0.9994 (last merge round=30)
[S10] round=33 local utility u=0.000000 metrics={'f1_val': 0.8245491895151169, 'auprc': 0.9944298995097819, 'loss_val': 0.38076438479524627, 'psi': 0.8925014735129829}-{'f1_val': 0.8455327786637572, 'auprc': 0.9942204756156802, 'loss_val': 0.3511203657143656, 'psi': 0.9050078574445264}
[S11] START round=33 head_norm_before_train=1.996108 (no previous merge yet)
[S11] round=33 local utility u=0.000000 metrics={'f1_val': 0.957060472845392, 'auprc': 0.9984230364243312, 'loss_val': 0.11209854301392383, 'psi': 0.9736054982769676}-{'f1_val': 0.996305167468861, 'auprc': 0.998098079258697, 'loss_val': 0.024351355193861557, 'psi': 0.9970223321847953}
[S13] START round=33 head_norm_before_train=2.139951 cos_to_last_merge=0.9991 (last merge round=25)
[S13] round=33 local utility u=0.000000 metrics={'f1_val': 0.5245980009495073, 'auprc': 0.6541162138725699, 'loss_val': 1.0663322840992981, 'psi': 0.5764052861187323}-{'f1_val': 0.596869811551007, 'auprc': 0.5781314963980541, 'loss_val': 0.8494333082967371, 'psi': 0.5893744854898259}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=33 metric=0.5246 head_norm=2.144645
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.944313e-02
[S13] stored merged vector for next round verification (round=33)
[S13] DEBUG after merge:  round=33 metric=0.5250 head_norm=2.151429 delta_norm=0.039443
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S14] START round=33 head_norm_before_train=2.067626 cos_to_last_merge=0.9968 (last merge round=25)
[S14] round=33 local utility u=0.000000 metrics={'f1_val': 0.9970202894562089, 'auprc': 0.9954701435181025, 'loss_val': 0.028350136430429645, 'psi': 0.9964002310809663}-{'f1_val': 0.9974310505072961, 'auprc': 0.9966046032724448, 'loss_val': 0.030311070680820375, 'psi': 0.9971004716133556}
[S15] START round=33 head_norm_before_train=1.782986 cos_to_last_merge=0.7689 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.769
[S15] round=33 local utility u=0.086470 metrics={'f1_val': 0.9254979325372007, 'auprc': 0.9725015769395217, 'loss_val': 0.12764316642141527, 'psi': 0.9442993902981291}-{'f1_val': 0.8964546589923497, 'auprc': 0.9931705729836254, 'loss_val': 0.18833032809713735, 'psi': 0.93514102458886}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=33 head_norm_before_train=1.535223 cos_to_last_merge=0.9889 (last merge round=25)
[S16] round=33 local utility u=0.250763 metrics={'f1_val': 0.9916684435532964, 'auprc': 0.9921711513936781, 'loss_val': 0.06484326729542064, 'psi': 0.991869526689449}-{'f1_val': 0.9375845800701014, 'auprc': 0.9931424464019813, 'loss_val': 0.2447806549615596, 'psi': 0.9598077266028534}
[S17] START round=33 head_norm_before_train=1.728011 (no previous merge yet)
[S17] round=33 local utility u=0.019478 metrics={'f1_val': 0.6722503100127133, 'auprc': 0.8969346816562648, 'loss_val': 0.43031474903487366, 'psi': 0.7621240586701339}-{'f1_val': 0.6935774359143054, 'auprc': 0.8833860643487539, 'loss_val': 0.5565879716824572, 'psi': 0.7695008872880849}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.992)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:37111
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1801 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:37117
[S10] RECEIVED delta(kind=head bytes=1801) from S7
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.857212)
[S10] loaded HEAD from S7 (vec_in norm=1.857212)
[S10] cosine check vs S7: cos=0.9984
[S10] BUFFERED delta from S7 (total buffered=1)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=33 metric=0.5893 head_norm=1.857212
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.477076e-02
[S7] stored merged vector for next round verification (round=33)
[S7] DEBUG after merge:  round=33 metric=0.5933 head_norm=1.874334 delta_norm=0.044771
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S8] sending update (kind=head size=1803 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1803) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.456487)
[S17] loaded HEAD from S8 (vec_in norm=1.456487)
[S17] cosine check vs S8: cos=-0.0477
[S17] DROPPED delta from S8 (cos=-0.0477 < 0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=33 metric=0.8245 head_norm=1.915141
[S10] _apply_head_vector_avg (torch): Δ‖w‖=6.046354e-02
[S10] stored merged vector for next round verification (round=33)
[S10] DEBUG after merge:  round=33 metric=0.8256 head_norm=1.885429 delta_norm=0.060464
[S10] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:37109
[S17] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1801) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.744125)
[S8] loaded HEAD from S17 (vec_in norm=1.744125)
[S8] cosine check vs S17: cos=-0.0477
[S8] DROPPED delta from S17 (cos=-0.0477 < 0.0)
[S2] START round=34 head_norm_before_train=1.927557 (no previous merge yet)
[S2] round=34 local utility u=0.000000 metrics={'f1_val': 0.9904131343040139, 'auprc': 0.9836952400447402, 'loss_val': 0.08598217203274132, 'psi': 0.9877259766003044}-{'f1_val': 0.9931993347412358, 'auprc': 0.9846212560014295, 'loss_val': 0.09604285043182686, 'psi': 0.9897681032453133}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=34 head_norm_before_train=2.238346 (no previous merge yet)
[S3] round=34 local utility u=0.000000 metrics={'f1_val': 0.7692037618587617, 'auprc': 0.998607908995504, 'loss_val': 0.5258240416340065, 'psi': 0.8609654207134587}-{'f1_val': 0.8157360735888932, 'auprc': 0.9985593525063783, 'loss_val': 0.3639404128618836, 'psi': 0.8888653851558872}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=34 head_norm_before_train=2.180749 cos_to_last_merge=0.9971 (last merge round=24)
[S4] round=34 local utility u=0.000000 metrics={'f1_val': 0.938624557540787, 'auprc': 0.9130604623084798, 'loss_val': 0.30770243685465004, 'psi': 0.9283989194478641}-{'f1_val': 0.9577604644992566, 'auprc': 0.9633267916319405, 'loss_val': 0.263155187286869, 'psi': 0.9599869953523301}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=34 head_norm_before_train=1.813512 cos_to_last_merge=0.7896 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.790
[S5] round=34 local utility u=0.008460 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9958275085311776, 'loss_val': 0.027727222162163265, 'psi': 0.9963521844995457}-{'f1_val': 0.9963338119635569, 'auprc': 0.9925575925132794, 'loss_val': 0.0326277485833728, 'psi': 0.9948233241834459}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] sending update (kind=head size=1794 to 1 peers)
[S6] START round=34 head_norm_before_train=1.837160 (no previous merge yet)
[S6] round=34 local utility u=0.000000 metrics={'f1_val': 0.6472400170841701, 'auprc': 0.9504628117572599, 'loss_val': 0.7161224330303336, 'psi': 0.768529134953406}-{'f1_val': 0.7275514559277534, 'auprc': 0.939646354847292, 'loss_val': 0.6716383181966836, 'psi': 0.8123894154955689}
[S7] START round=34 head_norm_before_train=1.874334 cos_to_last_merge=1.0000 (last merge round=33)
[S7] round=34 local utility u=0.000000 metrics={'f1_val': 0.5647931212524064, 'auprc': 0.7811619269304195, 'loss_val': 0.8917733610179839, 'psi': 0.6513406435236118}-{'f1_val': 0.5893033392932252, 'auprc': 0.7829917181670051, 'loss_val': 0.7759197398476143, 'psi': 0.6667786908427371}
[S8] START round=34 head_norm_before_train=1.456487 cos_to_last_merge=0.9917 (last merge round=29)
[S8] round=34 local utility u=0.000000 metrics={'f1_val': 0.9953051132645551, 'auprc': 0.9942356308559364, 'loss_val': 0.07153918534008363, 'psi': 0.9948773203011075}-{'f1_val': 0.9962031034001528, 'auprc': 0.9980210571748973, 'loss_val': 0.07310234906511139, 'psi': 0.9969302849100506}
[S9] START round=34 head_norm_before_train=2.158994 cos_to_last_merge=1.0000 (last merge round=32)
[S9] round=34 local utility u=0.000140 metrics={'f1_val': 0.9962461149658858, 'auprc': 0.9999188904700486, 'loss_val': 0.01716072174955745, 'psi': 0.997715225167551}-{'f1_val': 0.9971029125121428, 'auprc': 0.9979608422951791, 'loss_val': 0.016707483024339012, 'psi': 0.9974460844253573}
[S10] START round=34 head_norm_before_train=1.885429 cos_to_last_merge=1.0000 (last merge round=33)
[S10] round=34 local utility u=0.000000 metrics={'f1_val': 0.7996163249386113, 'auprc': 0.9940638880771804, 'loss_val': 0.4409817470471497, 'psi': 0.877395350194039}-{'f1_val': 0.8245491895151169, 'auprc': 0.9944298995097819, 'loss_val': 0.38076438479524627, 'psi': 0.8925014735129829}
[S11] START round=34 head_norm_before_train=2.006260 (no previous merge yet)
[S11] round=34 local utility u=0.161695 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9981502251558935, 'loss_val': 0.023357985998036068, 'psi': 0.997043190543674}-{'f1_val': 0.957060472845392, 'auprc': 0.9984230364243312, 'loss_val': 0.11209854301392383, 'psi': 0.9736054982769676}
[S13] START round=34 head_norm_before_train=2.151429 cos_to_last_merge=1.0000 (last merge round=33)
[S13] round=34 local utility u=0.000000 metrics={'f1_val': 0.5547113619880353, 'auprc': 0.5467600296730213, 'loss_val': 0.9342070402798496, 'psi': 0.5515308290620297}-{'f1_val': 0.5245980009495073, 'auprc': 0.6541162138725699, 'loss_val': 1.0663322840992981, 'psi': 0.5764052861187323}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=34 head_norm_before_train=2.084031 cos_to_last_merge=0.9962 (last merge round=25)
[S14] round=34 local utility u=0.000086 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9954732039778523, 'loss_val': 0.02805024648192182, 'psi': 0.99638778648574}-{'f1_val': 0.9970202894562089, 'auprc': 0.9954701435181025, 'loss_val': 0.028350136430429645, 'psi': 0.9964002310809663}
[S15] START round=34 head_norm_before_train=1.796723 cos_to_last_merge=0.7673 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.767
[S15] round=34 local utility u=0.000000 metrics={'f1_val': 0.9152130695264032, 'auprc': 0.989929719205866, 'loss_val': 0.12893218289683248, 'psi': 0.9450997293981884}-{'f1_val': 0.9254979325372007, 'auprc': 0.9725015769395217, 'loss_val': 0.12764316642141527, 'psi': 0.9442993902981291}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=34 head_norm_before_train=1.556177 cos_to_last_merge=0.9876 (last merge round=25)
[S16] round=34 local utility u=0.005935 metrics={'f1_val': 0.9919277167580342, 'auprc': 0.9927305722851039, 'loss_val': 0.056206761974055795, 'psi': 0.9922488589688621}-{'f1_val': 0.9916684435532964, 'auprc': 0.9921711513936781, 'loss_val': 0.06484326729542064, 'psi': 0.991869526689449}
[S17] START round=34 head_norm_before_train=1.744125 (no previous merge yet)
[S17] round=34 local utility u=0.000000 metrics={'f1_val': 0.5819787905358522, 'auprc': 0.7895419142444797, 'loss_val': 0.8449656181826752, 'psi': 0.6650040400193032}-{'f1_val': 0.6722503100127133, 'auprc': 0.8969346816562648, 'loss_val': 0.43031474903487366, 'psi': 0.7621240586701339}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:37104
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:37107
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:37113
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1795 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1796 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] RECEIVED delta(kind=head bytes=1796) from S14
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=2.096708)
[S4] loaded HEAD from S14 (vec_in norm=2.096708)
[S4] cosine check vs S14: cos=-0.0927
[S4] DROPPED delta from S14 (cos=-0.0927 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1795) from S9
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=2.162880)
[S13] loaded HEAD from S9 (vec_in norm=2.162880)
[S13] cosine check vs S9: cos=0.9999
[S13] BUFFERED delta from S9 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1795) from S11
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=2.016438)
[S6] loaded HEAD from S11 (vec_in norm=2.016438)
[S6] cosine check vs S11: cos=-0.0610
[S6] DROPPED delta from S11 (cos=-0.0610 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=35 head_norm_before_train=1.937467 (no previous merge yet)
[S2] round=35 local utility u=0.000000 metrics={'f1_val': 0.8552272899800155, 'auprc': 0.9795547242121819, 'loss_val': 0.218787112165352, 'psi': 0.9049582636728821}-{'f1_val': 0.9904131343040139, 'auprc': 0.9836952400447402, 'loss_val': 0.08598217203274132, 'psi': 0.9877259766003044}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=35 head_norm_before_train=2.251673 (no previous merge yet)
[S3] round=35 local utility u=0.316105 metrics={'f1_val': 0.8396221664889105, 'auprc': 0.9983899925278341, 'loss_val': 0.3154716798104838, 'psi': 0.90312929690448}-{'f1_val': 0.7692037618587617, 'auprc': 0.998607908995504, 'loss_val': 0.5258240416340065, 'psi': 0.8609654207134587}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=35 head_norm_before_train=2.187103 cos_to_last_merge=0.9968 (last merge round=24)
[S4] round=35 local utility u=0.050646 metrics={'f1_val': 0.9413295029016244, 'auprc': 0.9339189384660069, 'loss_val': 0.28521556299851936, 'psi': 0.9383652771273774}-{'f1_val': 0.938624557540787, 'auprc': 0.9130604623084798, 'loss_val': 0.30770243685465004, 'psi': 0.9283989194478641}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=35 head_norm_before_train=1.829013 cos_to_last_merge=0.7882 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.788
[S5] round=35 local utility u=0.007086 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9994521380493797, 'loss_val': 0.02442937556462422, 'psi': 0.9978020363068265}-{'f1_val': 0.9967019684784577, 'auprc': 0.9958275085311776, 'loss_val': 0.027727222162163265, 'psi': 0.9963521844995457}
[S5] not sending this round → trigger blocked (psi=0.998)
[S6] START round=35 head_norm_before_train=1.849814 (no previous merge yet)
[S6] round=35 local utility u=0.114950 metrics={'f1_val': 0.6784476108384689, 'auprc': 0.9510712911911894, 'loss_val': 0.6752928329908229, 'psi': 0.7874970829795571}-{'f1_val': 0.6472400170841701, 'auprc': 0.9504628117572599, 'loss_val': 0.7161224330303336, 'psi': 0.768529134953406}
[S7] START round=35 head_norm_before_train=1.883758 cos_to_last_merge=1.0000 (last merge round=33)
[S7] round=35 local utility u=0.269813 metrics={'f1_val': 0.6053442695559654, 'auprc': 0.7945746444774242, 'loss_val': 0.6356917046548182, 'psi': 0.681036419524549}-{'f1_val': 0.5647931212524064, 'auprc': 0.7811619269304195, 'loss_val': 0.8917733610179839, 'psi': 0.6513406435236118}
[S8] START round=35 head_norm_before_train=1.481289 cos_to_last_merge=0.9894 (last merge round=29)
[S8] round=35 local utility u=0.015540 metrics={'f1_val': 0.9960539056390789, 'auprc': 0.9992965560767526, 'loss_val': 0.060135268163888714, 'psi': 0.9973509658141484}-{'f1_val': 0.9953051132645551, 'auprc': 0.9942356308559364, 'loss_val': 0.07153918534008363, 'psi': 0.9948773203011075}
[S9] START round=35 head_norm_before_train=2.162880 cos_to_last_merge=1.0000 (last merge round=32)
[S9] round=35 local utility u=0.000000 metrics={'f1_val': 0.9937421749897083, 'auprc': 0.9998710922460744, 'loss_val': 0.02212414226316901, 'psi': 0.9961937418922548}-{'f1_val': 0.9962461149658858, 'auprc': 0.9999188904700486, 'loss_val': 0.01716072174955745, 'psi': 0.997715225167551}
[S10] START round=35 head_norm_before_train=1.907256 cos_to_last_merge=0.9999 (last merge round=33)
[S10] round=35 local utility u=0.066985 metrics={'f1_val': 0.8149506360636128, 'auprc': 0.9941855690352872, 'loss_val': 0.39938183222154766, 'psi': 0.8866446092522826}-{'f1_val': 0.7996163249386113, 'auprc': 0.9940638880771804, 'loss_val': 0.4409817470471497, 'psi': 0.877395350194039}
[S11] START round=35 head_norm_before_train=2.016438 (no previous merge yet)
[S11] round=35 local utility u=0.000741 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9983531063978663, 'loss_val': 0.022484905083476038, 'psi': 0.997124343040463}-{'f1_val': 0.996305167468861, 'auprc': 0.9981502251558935, 'loss_val': 0.023357985998036068, 'psi': 0.997043190543674}
[S13] START round=35 head_norm_before_train=2.156875 cos_to_last_merge=1.0000 (last merge round=33)
[S13] round=35 local utility u=0.399425 metrics={'f1_val': 0.5867488063745685, 'auprc': 0.6797438461316716, 'loss_val': 0.7265332273825102, 'psi': 0.6239468222774098}-{'f1_val': 0.5547113619880353, 'auprc': 0.5467600296730213, 'loss_val': 0.9342070402798496, 'psi': 0.5515308290620297}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] sending update (kind=head size=1796 to 1 peers)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=35 metric=0.5867 head_norm=2.163594
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.839755e-02
[S13] stored merged vector for next round verification (round=35)
[S13] DEBUG after merge:  round=35 metric=0.5946 head_norm=2.163159 delta_norm=0.018398
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S14] START round=35 head_norm_before_train=2.096708 cos_to_last_merge=0.9957 (last merge round=25)
[S14] round=35 local utility u=0.000418 metrics={'f1_val': 0.9967805075071389, 'auprc': 0.9962957499992696, 'loss_val': 0.028379101471832712, 'psi': 0.9965866045039912}-{'f1_val': 0.9969975081576651, 'auprc': 0.9954732039778523, 'loss_val': 0.02805024648192182, 'psi': 0.99638778648574}
[S15] START round=35 head_norm_before_train=1.808392 cos_to_last_merge=0.7659 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.766
[S15] round=35 local utility u=0.000000 metrics={'f1_val': 0.7041415246176506, 'auprc': 0.9784441584982524, 'loss_val': 0.4107957249145687, 'psi': 0.8138625781698913}-{'f1_val': 0.9152130695264032, 'auprc': 0.989929719205866, 'loss_val': 0.12893218289683248, 'psi': 0.9450997293981884}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=35 head_norm_before_train=1.574282 cos_to_last_merge=0.9867 (last merge round=25)
[S16] round=35 local utility u=0.005496 metrics={'f1_val': 0.9923674692870484, 'auprc': 0.9946794958163534, 'loss_val': 0.05370076474689251, 'psi': 0.9932922798987704}-{'f1_val': 0.9919277167580342, 'auprc': 0.9927305722851039, 'loss_val': 0.056206761974055795, 'psi': 0.9922488589688621}
[S17] START round=35 head_norm_before_train=1.760266 (no previous merge yet)
[S17] round=35 local utility u=0.602549 metrics={'f1_val': 0.6412112828529251, 'auprc': 0.9728861465733779, 'loss_val': 0.5452960652245854, 'psi': 0.7738812283411062}-{'f1_val': 0.5819787905358522, 'auprc': 0.7895419142444797, 'loss_val': 0.8449656181826752, 'psi': 0.6650040400193032}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:37112
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:37111
[S11] not sending this round → trigger blocked (psi=0.997)
[S16] not sending this round → trigger blocked (psi=0.993)
[S14] not sending this round → trigger blocked (psi=0.997)
[S14] ⇄ pheromone p=0.007 → S4@127.0.0.1:37104
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:37108
[S7] sending update (kind=head size=1803 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S8] → sending delta(kind=head bytes=1806) to S17@127.0.0.1:37117
[S11] ⇄ pheromone p=0.050 → S6@127.0.0.1:37107
[S9] ⇄ pheromone p=0.004 → S13@127.0.0.1:37113
[S10] RECEIVED delta(kind=head bytes=1803) from S7
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.894442)
[S10] loaded HEAD from S7 (vec_in norm=1.894442)
[S10] cosine check vs S7: cos=0.9993
[S10] BUFFERED delta from S7 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1799) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.858362)
[S11] loaded HEAD from S6 (vec_in norm=1.858362)
[S11] cosine check vs S6: cos=-0.0606
[S11] DROPPED delta from S6 (cos=-0.0606 < 0.0)
[S8] sending update (kind=head size=1806 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S7] ⇄ pheromone p=0.158 → S10@127.0.0.1:37111
[S6] ⇄ pheromone p=0.213 → S11@127.0.0.1:37112
[S17] RECEIVED delta(kind=head bytes=1806) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.501594)
[S17] loaded HEAD from S8 (vec_in norm=1.501594)
[S17] cosine check vs S8: cos=-0.0460
[S17] DROPPED delta from S8 (cos=-0.0460 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1800) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.926014)
[S7] loaded HEAD from S10 (vec_in norm=1.926014)
[S7] cosine check vs S10: cos=0.9993
[S7] BUFFERED delta from S10 (total buffered=1)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=35 metric=0.8150 head_norm=1.926014
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.980545e-02
[S10] stored merged vector for next round verification (round=35)
[S10] DEBUG after merge:  round=35 metric=0.8150 head_norm=1.909878 delta_norm=0.039805
[S10] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.035 → S7@127.0.0.1:37108
[S8] ⇄ pheromone p=0.066 → S17@127.0.0.1:37117
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:37109
[S17] sending update (kind=head size=1802 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1802) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.781027)
[S8] loaded HEAD from S17 (vec_in norm=1.781027)
[S8] cosine check vs S17: cos=-0.0460
[S8] DROPPED delta from S17 (cos=-0.0460 < 0.0)
[S17] ⇄ pheromone p=0.236 → S8@127.0.0.1:37109
[S2] START round=36 head_norm_before_train=1.948736 (no previous merge yet)
[S2] round=36 local utility u=0.499881 metrics={'f1_val': 0.9921155576102474, 'auprc': 0.9842811044265356, 'loss_val': 0.05453375217345734, 'psi': 0.9889817763367627}-{'f1_val': 0.8552272899800155, 'auprc': 0.9795547242121819, 'loss_val': 0.218787112165352, 'psi': 0.9049582636728821}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=36 head_norm_before_train=2.264142 (no previous merge yet)
[S3] round=36 local utility u=0.355119 metrics={'f1_val': 0.936595902711969, 'auprc': 0.9984239412793217, 'loss_val': 0.18717819059277835, 'psi': 0.96132711813891}-{'f1_val': 0.8396221664889105, 'auprc': 0.9983899925278341, 'loss_val': 0.3154716798104838, 'psi': 0.90312929690448}
[S3] not sending this round → trigger blocked (psi=0.961)
[S4] START round=36 head_norm_before_train=2.194086 cos_to_last_merge=0.9965 (last merge round=24)
[S4] round=36 local utility u=0.089248 metrics={'f1_val': 0.9553078475109007, 'auprc': 0.9582485424385139, 'loss_val': 0.26357858305244475, 'psi': 0.956484125481946}-{'f1_val': 0.9413295029016244, 'auprc': 0.9339189384660069, 'loss_val': 0.28521556299851936, 'psi': 0.9383652771273774}
[S4] not sending this round → trigger blocked (psi=0.956)
[S5] START round=36 head_norm_before_train=1.846145 cos_to_last_merge=0.7876 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.788
[S5] round=36 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9940735527774335, 'loss_val': 0.027382565127058497, 'psi': 0.9954297082891075}-{'f1_val': 0.9967019684784577, 'auprc': 0.9994521380493797, 'loss_val': 0.02442937556462422, 'psi': 0.9978020363068265}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=36 head_norm_before_train=1.858362 (no previous merge yet)
[S6] round=36 local utility u=0.200867 metrics={'f1_val': 0.7516235139306282, 'auprc': 0.9230099245379559, 'loss_val': 0.6284294783099145, 'psi': 0.8201780781735593}-{'f1_val': 0.6784476108384689, 'auprc': 0.9510712911911894, 'loss_val': 0.6752928329908229, 'psi': 0.7874970829795571}
[S7] START round=36 head_norm_before_train=1.894442 cos_to_last_merge=0.9997 (last merge round=33)
[S7] round=36 local utility u=0.126168 metrics={'f1_val': 0.6466939267082453, 'auprc': 0.7996697416599796, 'loss_val': 0.6467390979555733, 'psi': 0.7078842526889391}-{'f1_val': 0.6053442695559654, 'auprc': 0.7945746444774242, 'loss_val': 0.6356917046548182, 'psi': 0.681036419524549}
[S8] START round=36 head_norm_before_train=1.501594 cos_to_last_merge=0.9876 (last merge round=29)
[S8] round=36 local utility u=0.000000 metrics={'f1_val': 0.9956798005002608, 'auprc': 0.9966385242042115, 'loss_val': 0.05933527972816583, 'psi': 0.9960632899818411}-{'f1_val': 0.9960539056390789, 'auprc': 0.9992965560767526, 'loss_val': 0.060135268163888714, 'psi': 0.9973509658141484}
[S9] START round=36 head_norm_before_train=2.172039 cos_to_last_merge=0.9999 (last merge round=32)
[S9] round=36 local utility u=0.012508 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9995337164160283, 'loss_val': 0.016259577228672478, 'psi': 0.998075234073697}-{'f1_val': 0.9937421749897083, 'auprc': 0.9998710922460744, 'loss_val': 0.02212414226316901, 'psi': 0.9961937418922548}
[S10] START round=36 head_norm_before_train=1.909878 cos_to_last_merge=1.0000 (last merge round=35)
[S10] round=36 local utility u=0.068214 metrics={'f1_val': 0.8335605278213368, 'auprc': 0.9946005526929134, 'loss_val': 0.37585751370800435, 'psi': 0.8979765377699676}-{'f1_val': 0.8149506360636128, 'auprc': 0.9941855690352872, 'loss_val': 0.39938183222154766, 'psi': 0.8866446092522826}
[S11] START round=36 head_norm_before_train=2.026500 (no previous merge yet)
[S11] round=36 local utility u=0.000427 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9984722826811072, 'loss_val': 0.021988517989429145, 'psi': 0.9971720135537594}-{'f1_val': 0.996305167468861, 'auprc': 0.9983531063978663, 'loss_val': 0.022484905083476038, 'psi': 0.997124343040463}
[S13] START round=36 head_norm_before_train=2.163159 cos_to_last_merge=1.0000 (last merge round=35)
[S13] round=36 local utility u=0.000000 metrics={'f1_val': 0.5549068414037254, 'auprc': 0.6758353361763845, 'loss_val': 1.083358510279302, 'psi': 0.603278239312789}-{'f1_val': 0.5867488063745685, 'auprc': 0.6797438461316716, 'loss_val': 0.7265332273825102, 'psi': 0.6239468222774098}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=36 head_norm_before_train=2.108618 cos_to_last_merge=0.9953 (last merge round=25)
[S14] round=36 local utility u=0.001127 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9971675334569706, 'loss_val': 0.030041883310506834, 'psi': 0.9970655182773873}-{'f1_val': 0.9967805075071389, 'auprc': 0.9962957499992696, 'loss_val': 0.028379101471832712, 'psi': 0.9965866045039912}
[S15] START round=36 head_norm_before_train=1.817048 cos_to_last_merge=0.7648 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.765
[S15] round=36 local utility u=1.000000 metrics={'f1_val': 0.9934436613179527, 'auprc': 0.9974661995292373, 'loss_val': 0.03675447910603957, 'psi': 0.9950526766024665}-{'f1_val': 0.7041415246176506, 'auprc': 0.9784441584982524, 'loss_val': 0.4107957249145687, 'psi': 0.8138625781698913}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] sending update (kind=head size=1792 to 1 peers)
[S16] START round=36 head_norm_before_train=1.591659 cos_to_last_merge=0.9857 (last merge round=25)
[S16] round=36 local utility u=0.003158 metrics={'f1_val': 0.9920955928246982, 'auprc': 0.9969347561240987, 'loss_val': 0.05251898695021436, 'psi': 0.9940312581444584}-{'f1_val': 0.9923674692870484, 'auprc': 0.9946794958163534, 'loss_val': 0.05370076474689251, 'psi': 0.9932922798987704}
[S17] START round=36 head_norm_before_train=1.781027 (no previous merge yet)
[S17] round=36 local utility u=0.000000 metrics={'f1_val': 0.5967787295662825, 'auprc': 0.8576294288474061, 'loss_val': 0.8560807655840267, 'psi': 0.701119009278732}-{'f1_val': 0.6412112828529251, 'auprc': 0.9728861465733779, 'loss_val': 0.5452960652245854, 'psi': 0.7738812283411062}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:37104
[S6] not sending this round → trigger blocked (psi=0.820)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:37107
[S7] not sending this round → trigger blocked (psi=0.708)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:37113
[S9] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S10] not sending this round → trigger blocked (psi=0.898)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=36 metric=0.6467 head_norm=1.901738
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.684489e-02
[S7] stored merged vector for next round verification (round=36)
[S7] DEBUG after merge:  round=36 metric=0.6480 head_norm=1.913560 delta_norm=0.036845
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1796 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1796) from S14
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=2.116620)
[S4] loaded HEAD from S14 (vec_in norm=2.116620)
[S4] cosine check vs S14: cos=-0.0919
[S4] DROPPED delta from S14 (cos=-0.0919 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1798) from S9
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=2.183176)
[S13] loaded HEAD from S9 (vec_in norm=2.183176)
[S13] cosine check vs S9: cos=0.9999
[S13] BUFFERED delta from S9 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1798) from S11
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=2.036422)
[S6] loaded HEAD from S11 (vec_in norm=2.036422)
[S6] cosine check vs S11: cos=-0.0602
[S6] DROPPED delta from S11 (cos=-0.0602 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=37 head_norm_before_train=1.960342 (no previous merge yet)
[S2] round=37 local utility u=0.000000 metrics={'f1_val': 0.9860361966497765, 'auprc': 0.9854676537874226, 'loss_val': 0.0503638754065775, 'psi': 0.9858087795048349}-{'f1_val': 0.9921155576102474, 'auprc': 0.9842811044265356, 'loss_val': 0.05453375217345734, 'psi': 0.9889817763367627}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=37 head_norm_before_train=2.272690 (no previous merge yet)
[S3] round=37 local utility u=0.256131 metrics={'f1_val': 0.9954616546126973, 'auprc': 0.9987192995908941, 'loss_val': 0.02899578816856415, 'psi': 0.996764712603976}-{'f1_val': 0.936595902711969, 'auprc': 0.9984239412793217, 'loss_val': 0.18717819059277835, 'psi': 0.96132711813891}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] sending update (kind=head size=1795 to 1 peers)
[S4] START round=37 head_norm_before_train=2.199698 cos_to_last_merge=0.9962 (last merge round=24)
[S4] round=37 local utility u=0.000000 metrics={'f1_val': 0.9528286674801829, 'auprc': 0.9421969872037259, 'loss_val': 0.2867926209303778, 'psi': 0.9485759953696}-{'f1_val': 0.9553078475109007, 'auprc': 0.9582485424385139, 'loss_val': 0.26357858305244475, 'psi': 0.956484125481946}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=37 head_norm_before_train=1.855240 cos_to_last_merge=0.7869 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.787
[S5] round=37 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9933846203331423, 'loss_val': 0.03447646526696796, 'psi': 0.9951541353113911}-{'f1_val': 0.9963338119635569, 'auprc': 0.9940735527774335, 'loss_val': 0.027382565127058497, 'psi': 0.9954297082891075}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=37 head_norm_before_train=1.866147 (no previous merge yet)
[S6] round=37 local utility u=0.000000 metrics={'f1_val': 0.6001201709764207, 'auprc': 0.9381970724832716, 'loss_val': 0.894674741310991, 'psi': 0.7353509315791611}-{'f1_val': 0.7516235139306282, 'auprc': 0.9230099245379559, 'loss_val': 0.6284294783099145, 'psi': 0.8201780781735593}
[S7] START round=37 head_norm_before_train=1.913560 cos_to_last_merge=1.0000 (last merge round=36)
[S7] round=37 local utility u=0.000000 metrics={'f1_val': 0.5828218143870341, 'auprc': 0.7885179214182996, 'loss_val': 0.8904367621525325, 'psi': 0.6651002571995404}-{'f1_val': 0.6466939267082453, 'auprc': 0.7996697416599796, 'loss_val': 0.6467390979555733, 'psi': 0.7078842526889391}
[S8] START round=37 head_norm_before_train=1.519008 cos_to_last_merge=0.9862 (last merge round=29)
[S8] round=37 local utility u=0.008854 metrics={'f1_val': 0.9960539056390789, 'auprc': 0.9993147693216863, 'loss_val': 0.051901292892235426, 'psi': 0.9973582511121218}-{'f1_val': 0.9956798005002608, 'auprc': 0.9966385242042115, 'loss_val': 0.05933527972816583, 'psi': 0.9960632899818411}
[S9] START round=37 head_norm_before_train=2.183176 cos_to_last_merge=0.9999 (last merge round=32)
[S9] round=37 local utility u=0.000000 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.999544510581375, 'loss_val': 0.016570096688844807, 'psi': 0.9975804216707936}-{'f1_val': 0.9971029125121428, 'auprc': 0.9995337164160283, 'loss_val': 0.016259577228672478, 'psi': 0.998075234073697}
[S10] START round=37 head_norm_before_train=1.928840 cos_to_last_merge=0.9999 (last merge round=35)
[S10] round=37 local utility u=0.000000 metrics={'f1_val': 0.8082730121533555, 'auprc': 0.9937308351847172, 'loss_val': 0.4263583169789081, 'psi': 0.8824561413659002}-{'f1_val': 0.8335605278213368, 'auprc': 0.9946005526929134, 'loss_val': 0.37585751370800435, 'psi': 0.8979765377699676}
[S11] START round=37 head_norm_before_train=2.036422 (no previous merge yet)
[S11] round=37 local utility u=0.000000 metrics={'f1_val': 0.996305167468861, 'auprc': 0.998203190374074, 'loss_val': 0.02225137591322116, 'psi': 0.9970643766309462}-{'f1_val': 0.996305167468861, 'auprc': 0.9984722826811072, 'loss_val': 0.021988517989429145, 'psi': 0.9971720135537594}
[S13] START round=37 head_norm_before_train=2.171196 cos_to_last_merge=1.0000 (last merge round=35)
[S13] round=37 local utility u=0.109421 metrics={'f1_val': 0.5741796351525019, 'auprc': 0.6642901091971453, 'loss_val': 0.945516988559272, 'psi': 0.6102238247703593}-{'f1_val': 0.5549068414037254, 'auprc': 0.6758353361763845, 'loss_val': 1.083358510279302, 'psi': 0.603278239312789}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S13] sending update (kind=head size=1792 to 1 peers)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=37 metric=0.5742 head_norm=2.175971
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.235674e-02
[S13] stored merged vector for next round verification (round=37)
[S13] DEBUG after merge:  round=37 metric=0.5671 head_norm=2.179462 delta_norm=0.022357
[S13] aggregate: ROLLBACK (f1_val pre=0.574 post=0.567 tol_abs=0.005 tol_rel=0.0)
[S14] START round=37 head_norm_before_train=2.116620 cos_to_last_merge=0.9947 (last merge round=25)
[S14] round=37 local utility u=0.000000 metrics={'f1_val': 0.9963900223018398, 'auprc': 0.9951526636486246, 'loss_val': 0.02711178692054229, 'psi': 0.9958950788405537}-{'f1_val': 0.9969975081576651, 'auprc': 0.9971675334569706, 'loss_val': 0.030041883310506834, 'psi': 0.9970655182773873}
[S15] START round=37 head_norm_before_train=1.825125 cos_to_last_merge=0.7635 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.763
[S15] round=37 local utility u=0.000000 metrics={'f1_val': 0.9501615394119901, 'auprc': 0.9963899088036313, 'loss_val': 0.07651761714171297, 'psi': 0.9686528871686466}-{'f1_val': 0.9934436613179527, 'auprc': 0.9974661995292373, 'loss_val': 0.03675447910603957, 'psi': 0.9950526766024665}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=37 head_norm_before_train=1.608224 cos_to_last_merge=0.9846 (last merge round=25)
[S16] round=37 local utility u=0.000487 metrics={'f1_val': 0.9920715401116985, 'auprc': 0.99676950225889, 'loss_val': 0.05090484788337621, 'psi': 0.9939507249705751}-{'f1_val': 0.9920955928246982, 'auprc': 0.9969347561240987, 'loss_val': 0.05251898695021436, 'psi': 0.9940312581444584}
[S17] START round=37 head_norm_before_train=1.802502 (no previous merge yet)
[S17] round=37 local utility u=0.137132 metrics={'f1_val': 0.621877694624538, 'auprc': 0.8764659460782931, 'loss_val': 0.7889207044495303, 'psi': 0.72371299520604}-{'f1_val': 0.5967787295662825, 'auprc': 0.8576294288474061, 'loss_val': 0.8560807655840267, 'psi': 0.701119009278732}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.994)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:37117
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1799 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1799) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.535961)
[S17] loaded HEAD from S8 (vec_in norm=1.535961)
[S17] cosine check vs S8: cos=-0.0450
[S17] DROPPED delta from S8 (cos=-0.0450 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:37109
[S17] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1801) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.819803)
[S8] loaded HEAD from S17 (vec_in norm=1.819803)
[S8] cosine check vs S17: cos=-0.0450
[S8] DROPPED delta from S17 (cos=-0.0450 < 0.0)
[S2] START round=38 head_norm_before_train=1.973449 (no previous merge yet)
[S2] round=38 local utility u=0.000000 metrics={'f1_val': 0.8341490479756511, 'auprc': 0.9784280228002744, 'loss_val': 0.29911926003896827, 'psi': 0.8918606379055005}-{'f1_val': 0.9860361966497765, 'auprc': 0.9854676537874226, 'loss_val': 0.0503638754065775, 'psi': 0.9858087795048349}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=38 head_norm_before_train=2.281911 (no previous merge yet)
[S3] round=38 local utility u=0.000000 metrics={'f1_val': 0.7266638003426238, 'auprc': 0.9928505793369632, 'loss_val': 0.6226726869367342, 'psi': 0.8331385119403596}-{'f1_val': 0.9954616546126973, 'auprc': 0.9987192995908941, 'loss_val': 0.02899578816856415, 'psi': 0.996764712603976}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=38 head_norm_before_train=2.204156 cos_to_last_merge=0.9959 (last merge round=24)
[S4] round=38 local utility u=0.010750 metrics={'f1_val': 0.9483276750210937, 'auprc': 0.9513668538353536, 'loss_val': 0.265795882655627, 'psi': 0.9495433465467977}-{'f1_val': 0.9528286674801829, 'auprc': 0.9421969872037259, 'loss_val': 0.2867926209303778, 'psi': 0.9485759953696}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] sending update (kind=head size=1805 to 1 peers)
[S5] START round=38 head_norm_before_train=1.859057 cos_to_last_merge=0.7864 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.786
[S5] round=38 local utility u=0.013969 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9983585674862939, 'loss_val': 0.02366903234227623, 'psi': 0.9973646080815921}-{'f1_val': 0.9963338119635569, 'auprc': 0.9933846203331423, 'loss_val': 0.03447646526696796, 'psi': 0.9951541353113911}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=38 head_norm_before_train=1.875471 (no previous merge yet)
[S6] round=38 local utility u=0.687074 metrics={'f1_val': 0.7690909535397445, 'auprc': 0.953058180270627, 'loss_val': 0.5789356241701236, 'psi': 0.8426778442320976}-{'f1_val': 0.6001201709764207, 'auprc': 0.9381970724832716, 'loss_val': 0.894674741310991, 'psi': 0.7353509315791611}
[S7] START round=38 head_norm_before_train=1.917127 cos_to_last_merge=1.0000 (last merge round=36)
[S7] round=38 local utility u=0.383066 metrics={'f1_val': 0.6309166288079895, 'auprc': 0.8057120544524646, 'loss_val': 0.4644568170771757, 'psi': 0.7008347990657795}-{'f1_val': 0.5828218143870341, 'auprc': 0.7885179214182996, 'loss_val': 0.8904367621525325, 'psi': 0.6651002571995404}
[S8] START round=38 head_norm_before_train=1.535961 cos_to_last_merge=0.9847 (last merge round=29)
[S8] round=38 local utility u=0.001206 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9992637040272778, 'loss_val': 0.050231253400999626, 'psi': 0.9974273436510028}-{'f1_val': 0.9960539056390789, 'auprc': 0.9993147693216863, 'loss_val': 0.051901292892235426, 'psi': 0.9973582511121218}
[S9] START round=38 head_norm_before_train=2.190345 cos_to_last_merge=0.9999 (last merge round=32)
[S9] round=38 local utility u=0.000000 metrics={'f1_val': 0.9941897064172326, 'auprc': 0.9999125138892914, 'loss_val': 0.02185421105269842, 'psi': 0.9964788294060561}-{'f1_val': 0.9962710290637395, 'auprc': 0.999544510581375, 'loss_val': 0.016570096688844807, 'psi': 0.9975804216707936}
[S10] START round=38 head_norm_before_train=1.947701 cos_to_last_merge=0.9997 (last merge round=35)
[S10] round=38 local utility u=0.142568 metrics={'f1_val': 0.8437182168323931, 'auprc': 0.9945176823598689, 'loss_val': 0.3562530959502164, 'psi': 0.9040380030433834}-{'f1_val': 0.8082730121533555, 'auprc': 0.9937308351847172, 'loss_val': 0.4263583169789081, 'psi': 0.8824561413659002}
[S11] START round=38 head_norm_before_train=2.046928 (no previous merge yet)
[S11] round=38 local utility u=0.000740 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9984654854190695, 'loss_val': 0.021557415671378564, 'psi': 0.9971692946489443}-{'f1_val': 0.996305167468861, 'auprc': 0.998203190374074, 'loss_val': 0.02225137591322116, 'psi': 0.9970643766309462}
[S13] START round=38 head_norm_before_train=2.179462 cos_to_last_merge=1.0000 (last merge round=37)
[S13] round=38 local utility u=0.000000 metrics={'f1_val': 0.5284038617396067, 'auprc': 0.6847086858661001, 'loss_val': 0.7730265403592927, 'psi': 0.5909257913902041}-{'f1_val': 0.5741796351525019, 'auprc': 0.6642901091971453, 'loss_val': 0.945516988559272, 'psi': 0.6102238247703593}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=38 head_norm_before_train=2.125158 cos_to_last_merge=0.9943 (last merge round=25)
[S14] round=38 local utility u=0.007525 metrics={'f1_val': 0.9974310505072961, 'auprc': 0.9971174078443142, 'loss_val': 0.02420147271010977, 'psi': 0.9973055934421033}-{'f1_val': 0.9963900223018398, 'auprc': 0.9951526636486246, 'loss_val': 0.02711178692054229, 'psi': 0.9958950788405537}
[S15] START round=38 head_norm_before_train=1.832504 cos_to_last_merge=0.7626 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.763
[S15] round=38 local utility u=0.000000 metrics={'f1_val': 0.7010443585704017, 'auprc': 0.9162314097032018, 'loss_val': 0.5297474515431507, 'psi': 0.7871191790235218}-{'f1_val': 0.9501615394119901, 'auprc': 0.9963899088036313, 'loss_val': 0.07651761714171297, 'psi': 0.9686528871686466}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=38 head_norm_before_train=1.624102 cos_to_last_merge=0.9835 (last merge round=25)
[S16] round=38 local utility u=0.000000 metrics={'f1_val': 0.9824970153402531, 'auprc': 0.9910572030766277, 'loss_val': 0.07764350972203522, 'psi': 0.985921090434803}-{'f1_val': 0.9920715401116985, 'auprc': 0.99676950225889, 'loss_val': 0.05090484788337621, 'psi': 0.9939507249705751}
[S17] START round=38 head_norm_before_train=1.819803 (no previous merge yet)
[S17] round=38 local utility u=0.000000 metrics={'f1_val': 0.5983231610169524, 'auprc': 0.8912601738809215, 'loss_val': 1.0090146229001637, 'psi': 0.71549796616254}-{'f1_val': 0.621877694624538, 'auprc': 0.8764659460782931, 'loss_val': 0.7889207044495303, 'psi': 0.72371299520604}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:37112
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:37107
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:37111
[S11] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S8] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:37108
[S10] RECEIVED delta(kind=head bytes=1797) from S7
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.920191)
[S10] loaded HEAD from S7 (vec_in norm=1.920191)
[S10] cosine check vs S7: cos=0.9994
[S10] BUFFERED delta from S7 (total buffered=1)
[S6] RECEIVED delta(kind=head bytes=1796) from S11
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=2.056261)
[S6] loaded HEAD from S11 (vec_in norm=2.056261)
[S6] cosine check vs S11: cos=-0.0604
[S6] DROPPED delta from S11 (cos=-0.0604 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1798) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.884555)
[S11] loaded HEAD from S6 (vec_in norm=1.884555)
[S11] cosine check vs S6: cos=-0.0604
[S11] DROPPED delta from S6 (cos=-0.0604 < 0.0)
[S10] sending update (kind=head size=1802 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1802) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.965637)
[S7] loaded HEAD from S10 (vec_in norm=1.965637)
[S7] cosine check vs S10: cos=0.9994
[S7] BUFFERED delta from S10 (total buffered=1)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=38 metric=0.8437 head_norm=1.965637
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.124489e-02
[S10] stored merged vector for next round verification (round=38)
[S10] DEBUG after merge:  round=38 metric=0.8439 head_norm=1.942609 delta_norm=0.041245
[S10] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=39 head_norm_before_train=1.983744 (no previous merge yet)
[S2] round=39 local utility u=0.341551 metrics={'f1_val': 0.916404194382853, 'auprc': 0.9880142021494291, 'loss_val': 0.1383059365157855, 'psi': 0.9450481974894835}-{'f1_val': 0.8341490479756511, 'auprc': 0.9784280228002744, 'loss_val': 0.29911926003896827, 'psi': 0.8918606379055005}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S2] r=40 psi=0.945 u=0.3416 p_local=0.1788 f1=0.916 auprc=0.988 bytes=39544
[S3] START round=39 head_norm_before_train=2.291823 (no previous merge yet)
[S3] round=39 local utility u=1.000000 metrics={'f1_val': 0.9977533136161222, 'auprc': 0.9982564682672589, 'loss_val': 0.016296565951582256, 'psi': 0.9979545754765768}-{'f1_val': 0.7266638003426238, 'auprc': 0.9928505793369632, 'loss_val': 0.6226726869367342, 'psi': 0.8331385119403596}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S3] r=40 psi=0.998 u=1.0000 p_local=0.3093 f1=0.998 auprc=0.998 bytes=34187
[S4] START round=39 head_norm_before_train=2.208286 cos_to_last_merge=0.9958 (last merge round=24)
[S4] round=39 local utility u=0.000000 metrics={'f1_val': 0.9408638252814427, 'auprc': 0.9314836489346243, 'loss_val': 0.2945978088770766, 'psi': 0.9371117547427155}-{'f1_val': 0.9483276750210937, 'auprc': 0.9513668538353536, 'loss_val': 0.265795882655627, 'psi': 0.9495433465467977}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=40 psi=0.937 u=0.0000 p_local=0.0233 f1=0.941 auprc=0.931 bytes=44956
[S5] START round=39 head_norm_before_train=1.867996 cos_to_last_merge=0.7856 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.786
[S5] round=39 local utility u=0.000000 metrics={'f1_val': 0.8340786116275402, 'auprc': 0.990456629574181, 'loss_val': 0.20930279910630636, 'psi': 0.8966298188061965}-{'f1_val': 0.9967019684784577, 'auprc': 0.9983585674862939, 'loss_val': 0.02366903234227623, 'psi': 0.9973646080815921}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=40 psi=0.897 u=0.0000 p_local=0.0095 f1=0.834 auprc=0.990 bytes=35981
[S6] START round=39 head_norm_before_train=1.884555 (no previous merge yet)
[S6] round=39 local utility u=0.053716 metrics={'f1_val': 0.7943408998381809, 'auprc': 0.9346378372860857, 'loss_val': 0.5677425596144249, 'psi': 0.8504596748173429}-{'f1_val': 0.7690909535397445, 'auprc': 0.953058180270627, 'loss_val': 0.5789356241701236, 'psi': 0.8426778442320976}
[S7] START round=39 head_norm_before_train=1.920191 cos_to_last_merge=1.0000 (last merge round=36)
[S7] round=39 local utility u=0.169018 metrics={'f1_val': 0.6688794406511744, 'auprc': 0.8183301299716017, 'loss_val': 0.392051882641358, 'psi': 0.7286597163793453}-{'f1_val': 0.6309166288079895, 'auprc': 0.8057120544524646, 'loss_val': 0.4644568170771757, 'psi': 0.7008347990657795}
[S8] START round=39 head_norm_before_train=1.548964 cos_to_last_merge=0.9835 (last merge round=29)
[S8] round=39 local utility u=0.000000 metrics={'f1_val': 0.7560465177651194, 'auprc': 0.9935074333933629, 'loss_val': 0.24438120442764263, 'psi': 0.8510308840164169}-{'f1_val': 0.9962031034001528, 'auprc': 0.9992637040272778, 'loss_val': 0.050231253400999626, 'psi': 0.9974273436510028}
[S9] START round=39 head_norm_before_train=2.193381 cos_to_last_merge=0.9998 (last merge round=32)
[S9] round=39 local utility u=0.006761 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9968609413550916, 'loss_val': 0.01665663319928755, 'psi': 0.9970061240493223}-{'f1_val': 0.9941897064172326, 'auprc': 0.9999125138892914, 'loss_val': 0.02185421105269842, 'psi': 0.9964788294060561}
[S10] START round=39 head_norm_before_train=1.942609 cos_to_last_merge=1.0000 (last merge round=38)
[S10] round=39 local utility u=0.000000 metrics={'f1_val': 0.8219572527352079, 'auprc': 0.9939978748326543, 'loss_val': 0.3872296603945195, 'psi': 0.8907735015741864}-{'f1_val': 0.8437182168323931, 'auprc': 0.9945176823598689, 'loss_val': 0.3562530959502164, 'psi': 0.9040380030433834}
[S11] START round=39 head_norm_before_train=2.056261 (no previous merge yet)
[S11] round=39 local utility u=0.000645 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9984688762262082, 'loss_val': 0.021727706338205914, 'psi': 0.997315753198637}-{'f1_val': 0.996305167468861, 'auprc': 0.9984654854190695, 'loss_val': 0.021557415671378564, 'psi': 0.9971692946489443}
[S13] START round=39 head_norm_before_train=2.180996 cos_to_last_merge=1.0000 (last merge round=37)
[S13] round=39 local utility u=0.000000 metrics={'f1_val': 0.537847930555394, 'auprc': 0.5687679568306848, 'loss_val': 1.084196046260675, 'psi': 0.5502159410655103}-{'f1_val': 0.5284038617396067, 'auprc': 0.6847086858661001, 'loss_val': 0.7730265403592927, 'psi': 0.5909257913902041}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=40 psi=0.550 u=0.0000 p_local=0.0679 f1=0.538 auprc=0.569 bytes=35938
[S14] START round=39 head_norm_before_train=2.131645 cos_to_last_merge=0.9940 (last merge round=25)
[S14] round=39 local utility u=0.000331 metrics={'f1_val': 0.9974310505072961, 'auprc': 0.997164366529032, 'loss_val': 0.023679980880204586, 'psi': 0.9973243769159904}-{'f1_val': 0.9974310505072961, 'auprc': 0.9971174078443142, 'loss_val': 0.02420147271010977, 'psi': 0.9973055934421033}
[S15] START round=39 head_norm_before_train=1.842114 cos_to_last_merge=0.7613 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.761
[S15] round=39 local utility u=1.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9970629798408525, 'loss_val': 0.025494484711955458, 'psi': 0.9968731929688533}-{'f1_val': 0.7010443585704017, 'auprc': 0.9162314097032018, 'loss_val': 0.5297474515431507, 'psi': 0.7871191790235218}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S15] r=40 psi=0.997 u=1.0000 p_local=0.3447 f1=0.997 auprc=0.997 bytes=46756
[S16] START round=39 head_norm_before_train=1.638471 cos_to_last_merge=0.9826 (last merge round=25)
[S16] round=39 local utility u=0.050238 metrics={'f1_val': 0.9912224742012482, 'auprc': 0.9974940286213019, 'loss_val': 0.04882975583740731, 'psi': 0.9937310959692697}-{'f1_val': 0.9824970153402531, 'auprc': 0.9910572030766277, 'loss_val': 0.07764350972203522, 'psi': 0.985921090434803}
[S17] START round=39 head_norm_before_train=1.838441 (no previous merge yet)
[S17] round=39 local utility u=0.310369 metrics={'f1_val': 0.6287912290776199, 'auprc': 0.9778264648754107, 'loss_val': 0.8307839262543076, 'psi': 0.7684053233967363}-{'f1_val': 0.5983231610169524, 'auprc': 0.8912601738809215, 'loss_val': 1.0090146229001637, 'psi': 0.71549796616254}
[S16]  timeout peer S8
[S14] not sending this round → trigger blocked (psi=0.997)
[S11] not sending this round → trigger blocked (psi=0.997)
[S7] not sending this round → trigger blocked (psi=0.729)
[S6] not sending this round → trigger blocked (psi=0.850)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S16] r=40 psi=0.994 u=0.0502 p_local=0.0532 f1=0.991 auprc=0.997 bytes=37784
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S9] r=40 psi=0.997 u=0.0068 p_local=0.0043 f1=0.997 auprc=0.997 bytes=44972
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=40 psi=0.850 u=0.0537 p_local=0.2284 f1=0.794 auprc=0.935 bytes=39615
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=39 metric=0.6689 head_norm=1.926762
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.293781e-02
[S7] stored merged vector for next round verification (round=39)
[S7] DEBUG after merge:  round=39 metric=0.6678 head_norm=1.945823 delta_norm=0.042938
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S7] r=40 psi=0.729 u=0.1690 p_local=0.1729 f1=0.669 auprc=0.818 bytes=32343
[S11] r=40 psi=0.997 u=0.0006 p_local=0.0207 f1=0.997 auprc=0.998 bytes=46783
[S14] r=40 psi=0.997 u=0.0003 p_local=0.0042 f1=0.997 auprc=0.997 bytes=52209
[S10] r=40 psi=0.891 u=0.0000 p_local=0.0442 f1=0.822 auprc=0.994 bytes=37768
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:37109
[S17] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1801) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.855945)
[S8] loaded HEAD from S17 (vec_in norm=1.855945)
[S8] cosine check vs S17: cos=-0.0448
[S8] DROPPED delta from S17 (cos=-0.0448 < 0.0)
[S17] r=40 psi=0.768 u=0.3104 p_local=0.1765 f1=0.629 auprc=0.978 bytes=41409
[S8] r=40 psi=0.851 u=0.0000 p_local=0.0286 f1=0.756 auprc=0.994 bytes=39582
[S2] START round=40 head_norm_before_train=1.994026 (no previous merge yet)
[S2] round=40 local utility u=0.142301 metrics={'f1_val': 0.9557486737507965, 'auprc': 0.9888450386614591, 'loss_val': 0.09226259358981512, 'psi': 0.9689872197150615}-{'f1_val': 0.916404194382853, 'auprc': 0.9880142021494291, 'loss_val': 0.1383059365157855, 'psi': 0.9450481974894835}
[S2] not sending this round → trigger blocked (psi=0.969)
[S3] START round=40 head_norm_before_train=2.300966 (no previous merge yet)
[S3] round=40 local utility u=0.000000 metrics={'f1_val': 0.9612503732185909, 'auprc': 0.9981828572140368, 'loss_val': 0.12823586654330926, 'psi': 0.9760233668167693}-{'f1_val': 0.9977533136161222, 'auprc': 0.9982564682672589, 'loss_val': 0.016296565951582256, 'psi': 0.9979545754765768}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=40 head_norm_before_train=2.212823 cos_to_last_merge=0.9957 (last merge round=24)
[S4] round=40 local utility u=0.044652 metrics={'f1_val': 0.9458139796261232, 'auprc': 0.9462610440619544, 'loss_val': 0.2793261383909412, 'psi': 0.9459928054004557}-{'f1_val': 0.9408638252814427, 'auprc': 0.9314836489346243, 'loss_val': 0.2945978088770766, 'psi': 0.9371117547427155}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=40 head_norm_before_train=1.872978 cos_to_last_merge=0.7850 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.785
[S5] round=40 local utility u=0.582975 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.993384680236203, 'loss_val': 0.025668430257804957, 'psi': 0.9951541592726152}-{'f1_val': 0.8340786116275402, 'auprc': 0.990456629574181, 'loss_val': 0.20930279910630636, 'psi': 0.8966298188061965}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=40 head_norm_before_train=1.895119 (no previous merge yet)
[S6] round=40 local utility u=0.000000 metrics={'f1_val': 0.6993239669393513, 'auprc': 0.9323532102238641, 'loss_val': 0.763096055166325, 'psi': 0.7925356642531565}-{'f1_val': 0.7943408998381809, 'auprc': 0.9346378372860857, 'loss_val': 0.5677425596144249, 'psi': 0.8504596748173429}
[S7] START round=40 head_norm_before_train=1.945823 cos_to_last_merge=1.0000 (last merge round=39)
[S7] round=40 local utility u=0.000000 metrics={'f1_val': 0.6651929176781275, 'auprc': 0.8163310626785169, 'loss_val': 0.383923750114843, 'psi': 0.7256481756782833}-{'f1_val': 0.6688794406511744, 'auprc': 0.8183301299716017, 'loss_val': 0.392051882641358, 'psi': 0.7286597163793453}
[S8] START round=40 head_norm_before_train=1.561619 cos_to_last_merge=0.9825 (last merge round=29)
[S8] round=40 local utility u=0.826845 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9990656321901626, 'loss_val': 0.04830518084113375, 'psi': 0.9973481149161567}-{'f1_val': 0.7560465177651194, 'auprc': 0.9935074333933629, 'loss_val': 0.24438120442764263, 'psi': 0.8510308840164169}
[S9] START round=40 head_norm_before_train=2.202313 cos_to_last_merge=0.9998 (last merge round=32)
[S9] round=40 local utility u=0.004870 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9999315974582919, 'loss_val': 0.016128535517558485, 'psi': 0.9982343864906025}-{'f1_val': 0.9971029125121428, 'auprc': 0.9968609413550916, 'loss_val': 0.01665663319928755, 'psi': 0.9970061240493223}
[S10] START round=40 head_norm_before_train=1.958072 cos_to_last_merge=1.0000 (last merge round=38)
[S10] round=40 local utility u=0.076898 metrics={'f1_val': 0.8425048982002281, 'auprc': 0.9942177120737103, 'loss_val': 0.3573789328961217, 'psi': 0.9031900237496211}-{'f1_val': 0.8219572527352079, 'auprc': 0.9939978748326543, 'loss_val': 0.3872296603945195, 'psi': 0.8907735015741864}
[S11] START round=40 head_norm_before_train=2.063630 (no previous merge yet)
[S11] round=40 local utility u=0.000000 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9981266841585462, 'loss_val': 0.021804331442268798, 'psi': 0.997033774144735}-{'f1_val': 0.9965470045135896, 'auprc': 0.9984688762262082, 'loss_val': 0.021727706338205914, 'psi': 0.997315753198637}
[S13] START round=40 head_norm_before_train=2.182913 cos_to_last_merge=1.0000 (last merge round=37)
[S13] round=40 local utility u=0.276105 metrics={'f1_val': 0.5942231823629612, 'auprc': 0.5652084738277381, 'loss_val': 0.859558937532928, 'psi': 0.582617298948872}-{'f1_val': 0.537847930555394, 'auprc': 0.5687679568306848, 'loss_val': 1.084196046260675, 'psi': 0.5502159410655103}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=40 head_norm_before_train=2.139096 cos_to_last_merge=0.9938 (last merge round=25)
[S14] round=40 local utility u=0.000000 metrics={'f1_val': 0.9971882020035234, 'auprc': 0.9967982695688811, 'loss_val': 0.02311450980062114, 'psi': 0.9970322290296665}-{'f1_val': 0.9974310505072961, 'auprc': 0.997164366529032, 'loss_val': 0.023679980880204586, 'psi': 0.9973243769159904}
[S15] START round=40 head_norm_before_train=1.851702 cos_to_last_merge=0.7599 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.760
[S15] round=40 local utility u=0.000000 metrics={'f1_val': 0.9949134031699096, 'auprc': 0.998719425590788, 'loss_val': 0.02596739295376341, 'psi': 0.9964358121382609}-{'f1_val': 0.9967466683875206, 'auprc': 0.9970629798408525, 'loss_val': 0.025494484711955458, 'psi': 0.9968731929688533}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=40 head_norm_before_train=1.651784 cos_to_last_merge=0.9816 (last merge round=25)
[S16] round=40 local utility u=0.000000 metrics={'f1_val': 0.9915364364988188, 'auprc': 0.9857470017521031, 'loss_val': 0.051764210409317606, 'psi': 0.9892206626001325}-{'f1_val': 0.9912224742012482, 'auprc': 0.9974940286213019, 'loss_val': 0.04882975583740731, 'psi': 0.9937310959692697}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=40 head_norm_before_train=1.855945 (no previous merge yet)
[S17] round=40 local utility u=0.000000 metrics={'f1_val': 0.6236624677047828, 'auprc': 0.9586840098407123, 'loss_val': 0.8679289150420945, 'psi': 0.7576710845591546}-{'f1_val': 0.6287912290776199, 'auprc': 0.9778264648754107, 'loss_val': 0.8307839262543076, 'psi': 0.7684053233967363}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.998)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] ⇄ pheromone p=0.183 → S11@127.0.0.1:37112
[S7] ⇄ pheromone p=0.138 → S10@127.0.0.1:37111
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] → sending delta(kind=head bytes=1805) to S17@127.0.0.1:37117
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:37108
[S11] ⇄ pheromone p=0.017 → S6@127.0.0.1:37107
[S10] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1805 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1796) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.972782)
[S7] loaded HEAD from S10 (vec_in norm=1.972782)
[S7] cosine check vs S10: cos=0.9998
[S7] BUFFERED delta from S10 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1805) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.571279)
[S17] loaded HEAD from S8 (vec_in norm=1.571279)
[S17] cosine check vs S8: cos=-0.0448
[S17] DROPPED delta from S8 (cos=-0.0448 < 0.0)
[S10] ⇄ pheromone p=0.051 → S7@127.0.0.1:37108
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] ⇄ pheromone p=0.141 → S8@127.0.0.1:37109
[S8] ⇄ pheromone p=0.188 → S17@127.0.0.1:37117
[S2] START round=41 head_norm_before_train=2.002412 (no previous merge yet)
[S2] round=41 local utility u=0.000000 metrics={'f1_val': 0.8151311897497173, 'auprc': 0.9814441553550275, 'loss_val': 0.3991728737925805, 'psi': 0.8816563759918414}-{'f1_val': 0.9557486737507965, 'auprc': 0.9888450386614591, 'loss_val': 0.09226259358981512, 'psi': 0.9689872197150615}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=41 head_norm_before_train=2.309911 (no previous merge yet)
[S3] round=41 local utility u=0.061516 metrics={'f1_val': 0.9714863663074268, 'auprc': 0.998185541808408, 'loss_val': 0.06662854764766638, 'psi': 0.9821660365078193}-{'f1_val': 0.9612503732185909, 'auprc': 0.9981828572140368, 'loss_val': 0.12823586654330926, 'psi': 0.9760233668167693}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=41 head_norm_before_train=2.217377 cos_to_last_merge=0.9954 (last merge round=24)
[S4] round=41 local utility u=0.011373 metrics={'f1_val': 0.9522169315973088, 'auprc': 0.9428640440620295, 'loss_val': 0.28480711144330983, 'psi': 0.948475776583197}-{'f1_val': 0.9458139796261232, 'auprc': 0.9462610440619544, 'loss_val': 0.2793261383909412, 'psi': 0.9459928054004557}
[S4] not sending this round → trigger blocked (psi=0.948)
[S5] START round=41 head_norm_before_train=1.879337 cos_to_last_merge=0.7852 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.785
[S5] round=41 local utility u=0.002230 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9935686366215206, 'loss_val': 0.02396882801354867, 'psi': 0.9954486357356829}-{'f1_val': 0.9963338119635569, 'auprc': 0.993384680236203, 'loss_val': 0.025668430257804957, 'psi': 0.9951541592726152}
[S5] not sending this round → trigger blocked (psi=0.995)
[S6] START round=41 head_norm_before_train=1.905676 (no previous merge yet)
[S6] round=41 local utility u=0.000000 metrics={'f1_val': 0.6731462783754247, 'auprc': 0.9359590264818239, 'loss_val': 0.7725697317807199, 'psi': 0.7782713776179844}-{'f1_val': 0.6993239669393513, 'auprc': 0.9323532102238641, 'loss_val': 0.763096055166325, 'psi': 0.7925356642531565}
[S7] START round=41 head_norm_before_train=1.953490 cos_to_last_merge=1.0000 (last merge round=39)
[S7] round=41 local utility u=0.751008 metrics={'f1_val': 0.8127590865910417, 'auprc': 0.9550632962774697, 'loss_val': 0.1835011842804696, 'psi': 0.8696807704656129}-{'f1_val': 0.6651929176781275, 'auprc': 0.8163310626785169, 'loss_val': 0.383923750114843, 'psi': 0.7256481756782833}
[S8] START round=41 head_norm_before_train=1.571279 cos_to_last_merge=0.9815 (last merge round=29)
[S8] round=41 local utility u=0.000000 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9987931697921049, 'loss_val': 0.055112136028893206, 'psi': 0.9972391299569336}-{'f1_val': 0.9962031034001528, 'auprc': 0.9990656321901626, 'loss_val': 0.04830518084113375, 'psi': 0.9973481149161567}
[S9] START round=41 head_norm_before_train=2.208987 cos_to_last_merge=0.9997 (last merge round=32)
[S9] round=41 local utility u=0.000000 metrics={'f1_val': 0.9971000495392299, 'auprc': 0.9998755763843041, 'loss_val': 0.016117477921346598, 'psi': 0.9982102602772597}-{'f1_val': 0.9971029125121428, 'auprc': 0.9999315974582919, 'loss_val': 0.016128535517558485, 'psi': 0.9982343864906025}
[S10] START round=41 head_norm_before_train=1.972782 cos_to_last_merge=0.9999 (last merge round=38)
[S10] round=41 local utility u=0.000000 metrics={'f1_val': 0.8356331856357908, 'auprc': 0.993842046414461, 'loss_val': 0.379783232704388, 'psi': 0.8989167299472588}-{'f1_val': 0.8425048982002281, 'auprc': 0.9942177120737103, 'loss_val': 0.3573789328961217, 'psi': 0.9031900237496211}
[S11] START round=41 head_norm_before_train=2.071592 (no previous merge yet)
[S11] round=41 local utility u=0.000000 metrics={'f1_val': 0.9815953920107573, 'auprc': 0.9984848507091628, 'loss_val': 0.04997689895767488, 'psi': 0.9883511754901195}-{'f1_val': 0.996305167468861, 'auprc': 0.9981266841585462, 'loss_val': 0.021804331442268798, 'psi': 0.997033774144735}
[S13] START round=41 head_norm_before_train=2.185398 cos_to_last_merge=1.0000 (last merge round=37)
[S13] round=41 local utility u=0.000000 metrics={'f1_val': 0.54557742582652, 'auprc': 0.6908288366120166, 'loss_val': 0.9488077993891554, 'psi': 0.6036779901407187}-{'f1_val': 0.5942231823629612, 'auprc': 0.5652084738277381, 'loss_val': 0.859558937532928, 'psi': 0.582617298948872}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=41 head_norm_before_train=2.148532 cos_to_last_merge=0.9935 (last merge round=25)
[S14] round=41 local utility u=0.000000 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9961186423630729, 'loss_val': 0.02291778527751579, 'psi': 0.9968924186462645}-{'f1_val': 0.9971882020035234, 'auprc': 0.9967982695688811, 'loss_val': 0.02311450980062114, 'psi': 0.9970322290296665}
[S15] START round=41 head_norm_before_train=1.862108 cos_to_last_merge=0.7588 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.759
[S15] round=41 local utility u=0.000000 metrics={'f1_val': 0.8013481115466641, 'auprc': 0.993166222087364, 'loss_val': 0.37646575243799596, 'psi': 0.878075355762944}-{'f1_val': 0.9949134031699096, 'auprc': 0.998719425590788, 'loss_val': 0.02596739295376341, 'psi': 0.9964358121382609}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=41 head_norm_before_train=1.662790 cos_to_last_merge=0.9811 (last merge round=25)
[S16] round=41 local utility u=0.000000 metrics={'f1_val': 0.9416956464323025, 'auprc': 0.983096881455949, 'loss_val': 0.20362374245060497, 'psi': 0.9582561404417611}-{'f1_val': 0.9915364364988188, 'auprc': 0.9857470017521031, 'loss_val': 0.051764210409317606, 'psi': 0.9892206626001325}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=41 head_norm_before_train=1.869509 (no previous merge yet)
[S17] round=41 local utility u=0.000000 metrics={'f1_val': 0.6062974434572342, 'auprc': 0.8677189397169396, 'loss_val': 1.0325659961036433, 'psi': 0.7108660419611164}-{'f1_val': 0.6236624677047828, 'auprc': 0.9586840098407123, 'loss_val': 0.8679289150420945, 'psi': 0.7576710845591546}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] → sending delta(kind=head bytes=1794) to S10@127.0.0.1:37111
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1794 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] RECEIVED delta(kind=head bytes=1794) from S7
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.961411)
[S10] loaded HEAD from S7 (vec_in norm=1.961411)
[S10] cosine check vs S7: cos=0.9997
[S10] BUFFERED delta from S7 (total buffered=1)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=41 metric=0.8128 head_norm=1.961411
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.877899e-02
[S7] stored merged vector for next round verification (round=41)
[S7] DEBUG after merge:  round=41 metric=0.8128 head_norm=1.967015 delta_norm=0.018779
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=41 metric=0.8356 head_norm=1.987549
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.823679e-02
[S10] stored merged vector for next round verification (round=41)
[S10] DEBUG after merge:  round=41 metric=0.8349 head_norm=1.974322 delta_norm=0.028237
[S10] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=42 head_norm_before_train=2.009089 (no previous merge yet)
[S2] round=42 local utility u=0.424431 metrics={'f1_val': 0.9152282556194082, 'auprc': 0.9900481610687398, 'loss_val': 0.1767060769774081, 'psi': 0.9451562177991408}-{'f1_val': 0.8151311897497173, 'auprc': 0.9814441553550275, 'loss_val': 0.3991728737925805, 'psi': 0.8816563759918414}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] START round=42 head_norm_before_train=2.320907 (no previous merge yet)
[S3] round=42 local utility u=0.000000 metrics={'f1_val': 0.9619616648309319, 'auprc': 0.9984818563477083, 'loss_val': 0.08168253200163698, 'psi': 0.9765697414376424}-{'f1_val': 0.9714863663074268, 'auprc': 0.998185541808408, 'loss_val': 0.06662854764766638, 'psi': 0.9821660365078193}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=42 head_norm_before_train=2.221570 cos_to_last_merge=0.9951 (last merge round=24)
[S4] round=42 local utility u=0.000000 metrics={'f1_val': 0.9447316120619108, 'auprc': 0.9418909472287914, 'loss_val': 0.29558370046023846, 'psi': 0.943595346128663}-{'f1_val': 0.9522169315973088, 'auprc': 0.9428640440620295, 'loss_val': 0.28480711144330983, 'psi': 0.948475776583197}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=42 head_norm_before_train=1.887723 cos_to_last_merge=0.7853 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.785
[S5] round=42 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9934482615248219, 'loss_val': 0.024473021299758816, 'psi': 0.9951795917880628}-{'f1_val': 0.9967019684784577, 'auprc': 0.9935686366215206, 'loss_val': 0.02396882801354867, 'psi': 0.9954486357356829}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=42 head_norm_before_train=1.913134 (no previous merge yet)
[S6] round=42 local utility u=0.829117 metrics={'f1_val': 0.8667350485617777, 'auprc': 0.9566219225829736, 'loss_val': 0.3378567255998036, 'psi': 0.9026897981702561}-{'f1_val': 0.6731462783754247, 'auprc': 0.9359590264818239, 'loss_val': 0.7725697317807199, 'psi': 0.7782713776179844}
[S7] START round=42 head_norm_before_train=1.967015 cos_to_last_merge=1.0000 (last merge round=41)
[S7] round=42 local utility u=0.000000 metrics={'f1_val': 0.6510274821585867, 'auprc': 0.8042999955364682, 'loss_val': 0.5059455069246447, 'psi': 0.7123364875097393}-{'f1_val': 0.8127590865910417, 'auprc': 0.9550632962774697, 'loss_val': 0.1835011842804696, 'psi': 0.8696807704656129}
[S8] START round=42 head_norm_before_train=1.579566 cos_to_last_merge=0.9805 (last merge round=29)
[S8] round=42 local utility u=0.000000 metrics={'f1_val': 0.9960539056390789, 'auprc': 0.992907859419087, 'loss_val': 0.05125225874610546, 'psi': 0.9947954871510821}-{'f1_val': 0.9962031034001528, 'auprc': 0.9987931697921049, 'loss_val': 0.055112136028893206, 'psi': 0.9972391299569336}
[S9] START round=42 head_norm_before_train=2.219907 cos_to_last_merge=0.9997 (last merge round=32)
[S9] round=42 local utility u=0.000000 metrics={'f1_val': 0.9941897064172326, 'auprc': 0.99979751702866, 'loss_val': 0.022484751550996333, 'psi': 0.9964328306618035}-{'f1_val': 0.9971000495392299, 'auprc': 0.9998755763843041, 'loss_val': 0.016117477921346598, 'psi': 0.9982102602772597}
[S10] START round=42 head_norm_before_train=1.974322 cos_to_last_merge=1.0000 (last merge round=41)
[S10] round=42 local utility u=0.000000 metrics={'f1_val': 0.8288228362704771, 'auprc': 0.9938215177924532, 'loss_val': 0.39312656658425826, 'psi': 0.8948223088792675}-{'f1_val': 0.8356331856357908, 'auprc': 0.993842046414461, 'loss_val': 0.379783232704388, 'psi': 0.8989167299472588}
[S11] START round=42 head_norm_before_train=2.079757 (no previous merge yet)
[S11] round=42 local utility u=0.058016 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9981930197308686, 'loss_val': 0.021327898565902798, 'psi': 0.997060308373664}-{'f1_val': 0.9815953920107573, 'auprc': 0.9984848507091628, 'loss_val': 0.04997689895767488, 'psi': 0.9883511754901195}
[S13] START round=42 head_norm_before_train=2.190383 cos_to_last_merge=0.9999 (last merge round=37)
[S13] round=42 local utility u=0.272551 metrics={'f1_val': 0.5948657454209628, 'auprc': 0.6998195967086084, 'loss_val': 0.7264088235280279, 'psi': 0.636847285936021}-{'f1_val': 0.54557742582652, 'auprc': 0.6908288366120166, 'loss_val': 0.9488077993891554, 'psi': 0.6036779901407187}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S13] sending update (kind=head size=1791 to 1 peers)
[S14] START round=42 head_norm_before_train=2.157667 cos_to_last_merge=0.9930 (last merge round=25)
[S14] round=42 local utility u=0.000869 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9973258403570903, 'loss_val': 0.022335881216040437, 'psi': 0.9971288410374352}-{'f1_val': 0.9974082695017256, 'auprc': 0.9961186423630729, 'loss_val': 0.02291778527751579, 'psi': 0.9968924186462645}
[S15] START round=42 head_norm_before_train=1.872574 cos_to_last_merge=0.7577 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.758
[S15] round=42 local utility u=0.162143 metrics={'f1_val': 0.8433008546054642, 'auprc': 0.9958466704857952, 'loss_val': 0.311937645390319, 'psi': 0.9043191809575966}-{'f1_val': 0.8013481115466641, 'auprc': 0.993166222087364, 'loss_val': 0.37646575243799596, 'psi': 0.878075355762944}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=42 head_norm_before_train=1.672843 cos_to_last_merge=0.9805 (last merge round=25)
[S16] round=42 local utility u=0.111098 metrics={'f1_val': 0.9638878290132267, 'auprc': 0.9844122876772312, 'loss_val': 0.11852745270051594, 'psi': 0.9720976124788285}-{'f1_val': 0.9416956464323025, 'auprc': 0.983096881455949, 'loss_val': 0.20362374245060497, 'psi': 0.9582561404417611}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] sending update (kind=head size=1805 to 1 peers)
[S17] START round=42 head_norm_before_train=1.882122 (no previous merge yet)
[S17] round=42 local utility u=0.051231 metrics={'f1_val': 0.6239539697212871, 'auprc': 0.8527194847977806, 'loss_val': 0.9910443066043363, 'psi': 0.7154601757518846}-{'f1_val': 0.6062974434572342, 'auprc': 0.8677189397169396, 'loss_val': 1.0325659961036433, 'psi': 0.7108660419611164}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:37107
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:37112
[S11] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] RECEIVED delta(kind=head bytes=1802) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.917752)
[S11] loaded HEAD from S6 (vec_in norm=1.917752)
[S11] cosine check vs S6: cos=-0.0591
[S11] DROPPED delta from S6 (cos=-0.0591 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1799) from S11
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=2.088028)
[S6] loaded HEAD from S11 (vec_in norm=2.088028)
[S6] cosine check vs S11: cos=-0.0591
[S6] DROPPED delta from S11 (cos=-0.0591 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S17] → sending delta(kind=head bytes=1791) to S8@127.0.0.1:37109
[S17] sending update (kind=head size=1791 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1791) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.893919)
[S8] loaded HEAD from S17 (vec_in norm=1.893919)
[S8] cosine check vs S17: cos=-0.0448
[S8] DROPPED delta from S17 (cos=-0.0448 < 0.0)
[S2] START round=43 head_norm_before_train=2.015934 (no previous merge yet)
[S2] round=43 local utility u=0.270182 metrics={'f1_val': 0.9925785127133088, 'auprc': 0.9810903123390357, 'loss_val': 0.07357021615522841, 'psi': 0.9879832325635995}-{'f1_val': 0.9152282556194082, 'auprc': 0.9900481610687398, 'loss_val': 0.1767060769774081, 'psi': 0.9451562177991408}
[S2] not sending this round → trigger blocked (psi=0.988)
[S3] START round=43 head_norm_before_train=2.329640 (no previous merge yet)
[S3] round=43 local utility u=0.137445 metrics={'f1_val': 0.9969520501205896, 'auprc': 0.998555173584817, 'loss_val': 0.01695543530492022, 'psi': 0.9975932995062806}-{'f1_val': 0.9619616648309319, 'auprc': 0.9984818563477083, 'loss_val': 0.08168253200163698, 'psi': 0.9765697414376424}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] sending update (kind=head size=1794 to 1 peers)
[S4] START round=43 head_norm_before_train=2.226322 cos_to_last_merge=0.9951 (last merge round=24)
[S4] round=43 local utility u=0.029728 metrics={'f1_val': 0.9443898639919364, 'auprc': 0.9580242965442674, 'loss_val': 0.2824782243879411, 'psi': 0.9498436370128687}-{'f1_val': 0.9447316120619108, 'auprc': 0.9418909472287914, 'loss_val': 0.29558370046023846, 'psi': 0.943595346128663}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=43 head_norm_before_train=1.903769 cos_to_last_merge=0.7842 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.784
[S5] round=43 local utility u=0.001192 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.993712597139821, 'loss_val': 0.022882951008690873, 'psi': 0.9952853260340624}-{'f1_val': 0.9963338119635569, 'auprc': 0.9934482615248219, 'loss_val': 0.024473021299758816, 'psi': 0.9951795917880628}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=43 head_norm_before_train=1.917752 (no previous merge yet)
[S6] round=43 local utility u=0.000000 metrics={'f1_val': 0.63401000403916, 'auprc': 0.69700476490039, 'loss_val': 1.0874868838149538, 'psi': 0.659207908383652}-{'f1_val': 0.8667350485617777, 'auprc': 0.9566219225829736, 'loss_val': 0.3378567255998036, 'psi': 0.9026897981702561}
[S7] START round=43 head_norm_before_train=1.969662 cos_to_last_merge=1.0000 (last merge round=41)
[S7] round=43 local utility u=0.189056 metrics={'f1_val': 0.6806208609989903, 'auprc': 0.8183458708953607, 'loss_val': 0.3475313701733645, 'psi': 0.7357108649575385}-{'f1_val': 0.6510274821585867, 'auprc': 0.8042999955364682, 'loss_val': 0.5059455069246447, 'psi': 0.7123364875097393}
[S8] START round=43 head_norm_before_train=1.589250 cos_to_last_merge=0.9795 (last merge round=29)
[S8] round=43 local utility u=0.013110 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9991434812594214, 'loss_val': 0.044633405300981435, 'psi': 0.9973792545438602}-{'f1_val': 0.9960539056390789, 'auprc': 0.992907859419087, 'loss_val': 0.05125225874610546, 'psi': 0.9947954871510821}
[S9] START round=43 head_norm_before_train=2.229796 cos_to_last_merge=0.9996 (last merge round=32)
[S9] round=43 local utility u=0.011867 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9999349964255837, 'loss_val': 0.016642278787374638, 'psi': 0.9982357460775192}-{'f1_val': 0.9941897064172326, 'auprc': 0.99979751702866, 'loss_val': 0.022484751550996333, 'psi': 0.9964328306618035}
[S10] START round=43 head_norm_before_train=1.989084 cos_to_last_merge=1.0000 (last merge round=41)
[S10] round=43 local utility u=0.023283 metrics={'f1_val': 0.8356506072237164, 'auprc': 0.9941326870471312, 'loss_val': 0.3884605708527423, 'psi': 0.8990434391530823}-{'f1_val': 0.8288228362704771, 'auprc': 0.9938215177924532, 'loss_val': 0.39312656658425826, 'psi': 0.8948223088792675}
[S11] START round=43 head_norm_before_train=2.088028 (no previous merge yet)
[S11] round=43 local utility u=0.000799 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9984735161940518, 'loss_val': 0.020570897400144172, 'psi': 0.9971725069589372}-{'f1_val': 0.996305167468861, 'auprc': 0.9981930197308686, 'loss_val': 0.021327898565902798, 'psi': 0.997060308373664}
[S13] START round=43 head_norm_before_train=2.196591 cos_to_last_merge=0.9999 (last merge round=37)
[S13] round=43 local utility u=0.000000 metrics={'f1_val': 0.567565761741594, 'auprc': 0.6910791826482497, 'loss_val': 0.8739868520694093, 'psi': 0.6169711301042563}-{'f1_val': 0.5948657454209628, 'auprc': 0.6998195967086084, 'loss_val': 0.7264088235280279, 'psi': 0.636847285936021}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=43 head_norm_before_train=2.164915 cos_to_last_merge=0.9927 (last merge round=25)
[S14] round=43 local utility u=0.000000 metrics={'f1_val': 0.9970007132142444, 'auprc': 0.9957831745015586, 'loss_val': 0.024769445881905747, 'psi': 0.9965136977291702}-{'f1_val': 0.9969975081576651, 'auprc': 0.9973258403570903, 'loss_val': 0.022335881216040437, 'psi': 0.9971288410374352}
[S15] START round=43 head_norm_before_train=1.883866 cos_to_last_merge=0.7563 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.756
[S15] round=43 local utility u=0.562272 metrics={'f1_val': 0.9849521591821299, 'auprc': 0.9970681796747524, 'loss_val': 0.040966632000357876, 'psi': 0.9897985673791788}-{'f1_val': 0.8433008546054642, 'auprc': 0.9958466704857952, 'loss_val': 0.311937645390319, 'psi': 0.9043191809575966}
[S15] not sending this round → trigger blocked (psi=0.990)
[S16] START round=43 head_norm_before_train=1.682116 cos_to_last_merge=0.9799 (last merge round=25)
[S16] round=43 local utility u=0.129971 metrics={'f1_val': 0.9916846636119114, 'auprc': 0.9924951646552521, 'loss_val': 0.04961483595500318, 'psi': 0.9920088640292477}-{'f1_val': 0.9638878290132267, 'auprc': 0.9844122876772312, 'loss_val': 0.11852745270051594, 'psi': 0.9720976124788285}
[S16] not sending this round → trigger blocked (psi=0.992)
[S17] START round=43 head_norm_before_train=1.893919 (no previous merge yet)
[S17] round=43 local utility u=0.000000 metrics={'f1_val': 0.6019573144142227, 'auprc': 0.7928285136202204, 'loss_val': 1.1874326997109312, 'psi': 0.6783057940966218}-{'f1_val': 0.6239539697212871, 'auprc': 0.8527194847977806, 'loss_val': 0.9910443066043363, 'psi': 0.7154601757518846}
[S11] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:37111
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:37117
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:37108
[S10] RECEIVED delta(kind=head bytes=1796) from S7
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.973605)
[S10] loaded HEAD from S7 (vec_in norm=1.973605)
[S10] cosine check vs S7: cos=0.9997
[S10] BUFFERED delta from S7 (total buffered=1)
[S10] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1800) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=2.001756)
[S7] loaded HEAD from S10 (vec_in norm=2.001756)
[S7] cosine check vs S10: cos=0.9997
[S7] BUFFERED delta from S10 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1801) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.598714)
[S17] loaded HEAD from S8 (vec_in norm=1.598714)
[S17] cosine check vs S8: cos=-0.0447
[S17] DROPPED delta from S8 (cos=-0.0447 < 0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=43 metric=0.8357 head_norm=2.001756
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.738612e-02
[S10] stored merged vector for next round verification (round=43)
[S10] DEBUG after merge:  round=43 metric=0.8353 head_norm=1.987542 delta_norm=0.027386
[S10] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=44 head_norm_before_train=2.023649 (no previous merge yet)
[S2] round=44 local utility u=0.012740 metrics={'f1_val': 0.9908159241405723, 'auprc': 0.9826466226767868, 'loss_val': 0.04218436470272102, 'psi': 0.9875482035550581}-{'f1_val': 0.9925785127133088, 'auprc': 0.9810903123390357, 'loss_val': 0.07357021615522841, 'psi': 0.9879832325635995}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=44 head_norm_before_train=2.335918 (no previous merge yet)
[S3] round=44 local utility u=0.000000 metrics={'f1_val': 0.9629642435515284, 'auprc': 0.9984370086356289, 'loss_val': 0.07159465688823408, 'psi': 0.9771533495851686}-{'f1_val': 0.9969520501205896, 'auprc': 0.998555173584817, 'loss_val': 0.01695543530492022, 'psi': 0.9975932995062806}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=44 head_norm_before_train=2.232002 cos_to_last_merge=0.9949 (last merge round=24)
[S4] round=44 local utility u=0.000000 metrics={'f1_val': 0.9400717158614325, 'auprc': 0.9468039741847037, 'loss_val': 0.3170034637608291, 'psi': 0.9427646191907411}-{'f1_val': 0.9443898639919364, 'auprc': 0.9580242965442674, 'loss_val': 0.2824782243879411, 'psi': 0.9498436370128687}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=44 head_norm_before_train=1.917810 cos_to_last_merge=0.7831 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.783
[S5] round=44 local utility u=0.008654 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9980843439131692, 'loss_val': 0.020898612382088583, 'psi': 0.9972549186523423}-{'f1_val': 0.9963338119635569, 'auprc': 0.993712597139821, 'loss_val': 0.022882951008690873, 'psi': 0.9952853260340624}
[S5] not sending this round → trigger blocked (psi=0.997)
[S6] START round=44 head_norm_before_train=1.921390 (no previous merge yet)
[S6] round=44 local utility u=1.000000 metrics={'f1_val': 0.8476167901676313, 'auprc': 0.9504438835933244, 'loss_val': 0.4479961642712353, 'psi': 0.8887476275379085}-{'f1_val': 0.63401000403916, 'auprc': 0.69700476490039, 'loss_val': 1.0874868838149538, 'psi': 0.659207908383652}
[S7] START round=44 head_norm_before_train=1.973605 cos_to_last_merge=0.9999 (last merge round=41)
[S7] round=44 local utility u=0.000000 metrics={'f1_val': 0.5094931552086015, 'auprc': 0.77857880376295, 'loss_val': 1.1064986310737475, 'psi': 0.6171274146303409}-{'f1_val': 0.6806208609989903, 'auprc': 0.8183458708953607, 'loss_val': 0.3475313701733645, 'psi': 0.7357108649575385}
[S8] START round=44 head_norm_before_train=1.598714 cos_to_last_merge=0.9787 (last merge round=29)
[S8] round=44 local utility u=0.000000 metrics={'f1_val': 0.9960539056390789, 'auprc': 0.9975687151272022, 'loss_val': 0.04081436599645975, 'psi': 0.9966598294343282}-{'f1_val': 0.9962031034001528, 'auprc': 0.9991434812594214, 'loss_val': 0.044633405300981435, 'psi': 0.9973792545438602}
[S9] START round=44 head_norm_before_train=2.228675 cos_to_last_merge=0.9995 (last merge round=32)
[S9] round=44 local utility u=0.000000 metrics={'f1_val': 0.9905718417662249, 'auprc': 0.9999426910183262, 'loss_val': 0.032314334952413565, 'psi': 0.9943201814670655}-{'f1_val': 0.9971029125121428, 'auprc': 0.9999349964255837, 'loss_val': 0.016642278787374638, 'psi': 0.9982357460775192}
[S10] START round=44 head_norm_before_train=1.987542 cos_to_last_merge=1.0000 (last merge round=43)
[S10] round=44 local utility u=0.000000 metrics={'f1_val': 0.817236975346306, 'auprc': 0.99386662866606, 'loss_val': 0.4116895072919698, 'psi': 0.8878888366742077}-{'f1_val': 0.8356506072237164, 'auprc': 0.9941326870471312, 'loss_val': 0.3884605708527423, 'psi': 0.8990434391530823}
[S11] START round=44 head_norm_before_train=2.096502 (no previous merge yet)
[S11] round=44 local utility u=0.000000 metrics={'f1_val': 0.9492114779557435, 'auprc': 0.9983336928856972, 'loss_val': 0.27158453403201344, 'psi': 0.968860363927725}-{'f1_val': 0.996305167468861, 'auprc': 0.9984735161940518, 'loss_val': 0.020570897400144172, 'psi': 0.9971725069589372}
[S13] START round=44 head_norm_before_train=2.200644 cos_to_last_merge=0.9998 (last merge round=37)
[S13] round=44 local utility u=0.000000 metrics={'f1_val': 0.5316365647194187, 'auprc': 0.6884235837828869, 'loss_val': 0.9130262245550483, 'psi': 0.594351372344806}-{'f1_val': 0.567565761741594, 'auprc': 0.6910791826482497, 'loss_val': 0.8739868520694093, 'psi': 0.6169711301042563}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=44 head_norm_before_train=2.169551 cos_to_last_merge=0.9924 (last merge round=25)
[S14] round=44 local utility u=0.002406 metrics={'f1_val': 0.9970007132142444, 'auprc': 0.9971791956840277, 'loss_val': 0.02414581309881419, 'psi': 0.9970721062021577}-{'f1_val': 0.9970007132142444, 'auprc': 0.9957831745015586, 'loss_val': 0.024769445881905747, 'psi': 0.9965136977291702}
[S15] START round=44 head_norm_before_train=1.894985 cos_to_last_merge=0.7549 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.755
[S15] round=44 local utility u=0.000000 metrics={'f1_val': 0.9822814743670689, 'auprc': 0.9933310839672329, 'loss_val': 0.04853978671999063, 'psi': 0.9867013182071345}-{'f1_val': 0.9849521591821299, 'auprc': 0.9970681796747524, 'loss_val': 0.040966632000357876, 'psi': 0.9897985673791788}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=44 head_norm_before_train=1.690644 cos_to_last_merge=0.9795 (last merge round=25)
[S16] round=44 local utility u=0.000000 metrics={'f1_val': 0.9752689062415981, 'auprc': 0.9921550949911507, 'loss_val': 0.09290243587612042, 'psi': 0.9820233817414192}-{'f1_val': 0.9916846636119114, 'auprc': 0.9924951646552521, 'loss_val': 0.04961483595500318, 'psi': 0.9920088640292477}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=44 head_norm_before_train=1.905686 (no previous merge yet)
[S17] round=44 local utility u=0.270820 metrics={'f1_val': 0.628416468208607, 'auprc': 0.8741284774006557, 'loss_val': 1.0484474422825576, 'psi': 0.7267012718854264}-{'f1_val': 0.6019573144142227, 'auprc': 0.7928285136202204, 'loss_val': 1.1874326997109312, 'psi': 0.6783057940966218}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:37112
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=44 metric=0.5095 head_norm=1.976753
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.692563e-02
[S7] stored merged vector for next round verification (round=44)
[S7] DEBUG after merge:  round=44 metric=0.5087 head_norm=1.989112 delta_norm=0.026926
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1800 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] RECEIVED delta(kind=head bytes=1800) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.926046)
[S11] loaded HEAD from S6 (vec_in norm=1.926046)
[S11] cosine check vs S6: cos=-0.0594
[S11] DROPPED delta from S6 (cos=-0.0594 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:37109
[S17] sending update (kind=head size=1797 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1797) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.918061)
[S8] loaded HEAD from S17 (vec_in norm=1.918061)
[S8] cosine check vs S17: cos=-0.0447
[S8] DROPPED delta from S17 (cos=-0.0447 < 0.0)
[S2] START round=45 head_norm_before_train=2.031956 (no previous merge yet)
[S2] round=45 local utility u=0.004240 metrics={'f1_val': 0.9928045365797099, 'auprc': 0.9826987450355072, 'loss_val': 0.045792823927745516, 'psi': 0.9887622199620288}-{'f1_val': 0.9908159241405723, 'auprc': 0.9826466226767868, 'loss_val': 0.04218436470272102, 'psi': 0.9875482035550581}
[S2] not sending this round → trigger blocked (psi=0.989)
[S3] START round=45 head_norm_before_train=2.343946 (no previous merge yet)
[S3] round=45 local utility u=0.099921 metrics={'f1_val': 0.9912750979904138, 'auprc': 0.9987560790936845, 'loss_val': 0.04257535668862319, 'psi': 0.994267490431722}-{'f1_val': 0.9629642435515284, 'auprc': 0.9984370086356289, 'loss_val': 0.07159465688823408, 'psi': 0.9771533495851686}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=45 head_norm_before_train=2.235799 cos_to_last_merge=0.9948 (last merge round=24)
[S4] round=45 local utility u=0.009157 metrics={'f1_val': 0.9413718375285824, 'auprc': 0.9455735031669643, 'loss_val': 0.3027982038841444, 'psi': 0.9430525037839351}-{'f1_val': 0.9400717158614325, 'auprc': 0.9468039741847037, 'loss_val': 0.3170034637608291, 'psi': 0.9427646191907411}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=45 head_norm_before_train=1.934198 cos_to_last_merge=0.7817 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.782
[S5] round=45 local utility u=0.000000 metrics={'f1_val': 0.7229610070104433, 'auprc': 0.9892443966340057, 'loss_val': 0.46752045412392396, 'psi': 0.8294743628598682}-{'f1_val': 0.9967019684784577, 'auprc': 0.9980843439131692, 'loss_val': 0.020898612382088583, 'psi': 0.9972549186523423}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=45 head_norm_before_train=1.926046 (no previous merge yet)
[S6] round=45 local utility u=0.000000 metrics={'f1_val': 0.6304939253208702, 'auprc': 0.9495255668727035, 'loss_val': 0.785044859189807, 'psi': 0.7581065819416035}-{'f1_val': 0.8476167901676313, 'auprc': 0.9504438835933244, 'loss_val': 0.4479961642712353, 'psi': 0.8887476275379085}
[S7] START round=45 head_norm_before_train=1.989112 cos_to_last_merge=1.0000 (last merge round=44)
[S7] round=45 local utility u=1.000000 metrics={'f1_val': 0.9873781854206731, 'auprc': 0.9865271073617254, 'loss_val': 0.18527687923909616, 'psi': 0.987037754197094}-{'f1_val': 0.5094931552086015, 'auprc': 0.77857880376295, 'loss_val': 1.1064986310737475, 'psi': 0.6171274146303409}
[S8] START round=45 head_norm_before_train=1.610140 cos_to_last_merge=0.9778 (last merge round=29)
[S8] round=45 local utility u=0.002385 metrics={'f1_val': 0.9960539056390789, 'auprc': 0.9988222732644532, 'loss_val': 0.03980522049872653, 'psi': 0.9971612526892286}-{'f1_val': 0.9960539056390789, 'auprc': 0.9975687151272022, 'loss_val': 0.04081436599645975, 'psi': 0.9966598294343282}
[S9] START round=45 head_norm_before_train=2.235250 cos_to_last_merge=0.9994 (last merge round=32)
[S9] round=45 local utility u=0.018231 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9948360234102323, 'loss_val': 0.01725681091206097, 'psi': 0.9959499041229503}-{'f1_val': 0.9905718417662249, 'auprc': 0.9999426910183262, 'loss_val': 0.032314334952413565, 'psi': 0.9943201814670655}
[S10] START round=45 head_norm_before_train=1.999781 cos_to_last_merge=1.0000 (last merge round=43)
[S10] round=45 local utility u=0.054096 metrics={'f1_val': 0.8322218419210022, 'auprc': 0.9941317113931724, 'loss_val': 0.39420237170690925, 'psi': 0.8969857897098703}-{'f1_val': 0.817236975346306, 'auprc': 0.99386662866606, 'loss_val': 0.4116895072919698, 'psi': 0.8878888366742077}
[S11] START round=45 head_norm_before_train=2.103729 (no previous merge yet)
[S11] round=45 local utility u=0.267842 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9985699146483856, 'loss_val': 0.019172120228574823, 'psi': 0.9972110663406708}-{'f1_val': 0.9492114779557435, 'auprc': 0.9983336928856972, 'loss_val': 0.27158453403201344, 'psi': 0.968860363927725}
[S13] START round=45 head_norm_before_train=2.205050 cos_to_last_merge=0.9998 (last merge round=37)
[S13] round=45 local utility u=0.000000 metrics={'f1_val': 0.5806327924762998, 'auprc': 0.586359567789389, 'loss_val': 0.9060341752758541, 'psi': 0.5829235026015356}-{'f1_val': 0.5316365647194187, 'auprc': 0.6884235837828869, 'loss_val': 0.9130262245550483, 'psi': 0.594351372344806}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=45 head_norm_before_train=2.175594 cos_to_last_merge=0.9921 (last merge round=25)
[S14] round=45 local utility u=0.000930 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.9962812967540586, 'loss_val': 0.024504144224205746, 'psi': 0.9972042294819545}-{'f1_val': 0.9970007132142444, 'auprc': 0.9971791956840277, 'loss_val': 0.02414581309881419, 'psi': 0.9970721062021577}
[S15] START round=45 head_norm_before_train=1.905847 cos_to_last_merge=0.7535 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.754
[S15] round=45 local utility u=0.058355 metrics={'f1_val': 0.9958642312648849, 'auprc': 0.997271656139001, 'loss_val': 0.02514900270516483, 'psi': 0.9964272012145313}-{'f1_val': 0.9822814743670689, 'auprc': 0.9933310839672329, 'loss_val': 0.04853978671999063, 'psi': 0.9867013182071345}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=45 head_norm_before_train=1.699907 cos_to_last_merge=0.9789 (last merge round=25)
[S16] round=45 local utility u=0.071153 metrics={'f1_val': 0.9915843765742902, 'auprc': 0.991524797444316, 'loss_val': 0.04659894700351311, 'psi': 0.9915605449223006}-{'f1_val': 0.9752689062415981, 'auprc': 0.9921550949911507, 'loss_val': 0.09290243587612042, 'psi': 0.9820233817414192}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=45 head_norm_before_train=1.918061 (no previous merge yet)
[S17] round=45 local utility u=0.432181 metrics={'f1_val': 0.696733101328223, 'auprc': 0.9211001802533472, 'loss_val': 0.734901146882583, 'psi': 0.7864799328982727}-{'f1_val': 0.628416468208607, 'auprc': 0.8741284774006557, 'loss_val': 1.0484474422825576, 'psi': 0.7267012718854264}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:37111
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S11] → sending delta(kind=head bytes=1791) to S6@127.0.0.1:37107
[S14] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] → sending delta(kind=head bytes=1805) to S17@127.0.0.1:37117
[S11] sending update (kind=head size=1791 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:37108
[S6] ⇄ pheromone p=0.305 → S11@127.0.0.1:37112
[S6] RECEIVED delta(kind=head bytes=1791) from S11
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=2.106426)
[S6] loaded HEAD from S11 (vec_in norm=2.106426)
[S6] cosine check vs S11: cos=-0.0598
[S6] DROPPED delta from S11 (cos=-0.0598 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1798) from S7
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.992546)
[S10] loaded HEAD from S7 (vec_in norm=1.992546)
[S10] cosine check vs S7: cos=0.9999
[S10] BUFFERED delta from S7 (total buffered=1)
[S10] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1805 to 1 peers)
[S7] ⇄ pheromone p=0.331 → S10@127.0.0.1:37111
[S11] ⇄ pheromone p=0.065 → S6@127.0.0.1:37107
[S7] RECEIVED delta(kind=head bytes=1801) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=2.012511)
[S7] loaded HEAD from S10 (vec_in norm=2.012511)
[S7] cosine check vs S10: cos=0.9999
[S7] BUFFERED delta from S10 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1805) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.620590)
[S17] loaded HEAD from S8 (vec_in norm=1.620590)
[S17] cosine check vs S8: cos=-0.0447
[S17] DROPPED delta from S8 (cos=-0.0447 < 0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=45 metric=0.8322 head_norm=2.012511
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.717155e-02
[S10] stored merged vector for next round verification (round=45)
[S10] DEBUG after merge:  round=45 metric=0.8318 head_norm=2.002480 delta_norm=0.017172
[S10] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.030 → S7@127.0.0.1:37108
[S17] not sending this round → trigger blocked (psi=0.786)
[S17] ⇄ pheromone p=0.181 → S8@127.0.0.1:37109
[S8] ⇄ pheromone p=0.064 → S17@127.0.0.1:37117
[S2] START round=46 head_norm_before_train=2.036842 (no previous merge yet)
[S2] round=46 local utility u=0.000000 metrics={'f1_val': 0.9897901874735275, 'auprc': 0.9831373324718276, 'loss_val': 0.041419473357813576, 'psi': 0.9871290454728475}-{'f1_val': 0.9928045365797099, 'auprc': 0.9826987450355072, 'loss_val': 0.045792823927745516, 'psi': 0.9887622199620288}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=46 head_norm_before_train=2.348498 (no previous merge yet)
[S3] round=46 local utility u=0.000000 metrics={'f1_val': 0.9085989426494433, 'auprc': 0.9985996476805514, 'loss_val': 0.22632458829345906, 'psi': 0.9445992246618865}-{'f1_val': 0.9912750979904138, 'auprc': 0.9987560790936845, 'loss_val': 0.04257535668862319, 'psi': 0.994267490431722}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=46 head_norm_before_train=2.239238 cos_to_last_merge=0.9946 (last merge round=24)
[S4] round=46 local utility u=0.023843 metrics={'f1_val': 0.948787172098873, 'auprc': 0.9445897785652759, 'loss_val': 0.29665332579704823, 'psi': 0.9471082146854342}-{'f1_val': 0.9413718375285824, 'auprc': 0.9455735031669643, 'loss_val': 0.3027982038841444, 'psi': 0.9430525037839351}
[S4] not sending this round → trigger blocked (psi=0.947)
[S5] START round=46 head_norm_before_train=1.937394 cos_to_last_merge=0.7810 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.781
[S5] round=46 local utility u=1.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9936933871044246, 'loss_val': 0.023030959398119395, 'psi': 0.9954985359288444}-{'f1_val': 0.7229610070104433, 'auprc': 0.9892443966340057, 'loss_val': 0.46752045412392396, 'psi': 0.8294743628598682}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=46 head_norm_before_train=1.933802 (no previous merge yet)
[S6] round=46 local utility u=0.373273 metrics={'f1_val': 0.7731370768371338, 'auprc': 0.8902590762889315, 'loss_val': 0.7165582677776301, 'psi': 0.8199858766178529}-{'f1_val': 0.6304939253208702, 'auprc': 0.9495255668727035, 'loss_val': 0.785044859189807, 'psi': 0.7581065819416035}
[S7] START round=46 head_norm_before_train=1.992546 cos_to_last_merge=1.0000 (last merge round=44)
[S7] round=46 local utility u=0.000000 metrics={'f1_val': 0.7033069140007158, 'auprc': 0.8385012361993329, 'loss_val': 0.29429442102329734, 'psi': 0.7573846428801627}-{'f1_val': 0.9873781854206731, 'auprc': 0.9865271073617254, 'loss_val': 0.18527687923909616, 'psi': 0.987037754197094}
[S8] START round=46 head_norm_before_train=1.620590 cos_to_last_merge=0.9768 (last merge round=29)
[S8] round=46 local utility u=0.000000 metrics={'f1_val': 0.9945800350935671, 'auprc': 0.9990804010830429, 'loss_val': 0.044284798506772596, 'psi': 0.9963801814893574}-{'f1_val': 0.9960539056390789, 'auprc': 0.9988222732644532, 'loss_val': 0.03980522049872653, 'psi': 0.9971612526892286}
[S9] START round=46 head_norm_before_train=2.245149 cos_to_last_merge=0.9994 (last merge round=32)
[S9] round=46 local utility u=0.000000 metrics={'f1_val': 0.9925154678702236, 'auprc': 0.99989068136116, 'loss_val': 0.024516212825370056, 'psi': 0.9954655532665981}-{'f1_val': 0.9966924912647621, 'auprc': 0.9948360234102323, 'loss_val': 0.01725681091206097, 'psi': 0.9959499041229503}
[S10] START round=46 head_norm_before_train=2.002480 cos_to_last_merge=1.0000 (last merge round=45)
[S10] round=46 local utility u=0.000000 metrics={'f1_val': 0.8171022700996831, 'auprc': 0.9937963992943506, 'loss_val': 0.4151279944370793, 'psi': 0.88777992177755}-{'f1_val': 0.8322218419210022, 'auprc': 0.9941317113931724, 'loss_val': 0.39420237170690925, 'psi': 0.8969857897098703}
[S11] START round=46 head_norm_before_train=2.106426 (no previous merge yet)
[S11] round=46 local utility u=0.001037 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9990814050523835, 'loss_val': 0.018631697149629402, 'psi': 0.99741566250227}-{'f1_val': 0.996305167468861, 'auprc': 0.9985699146483856, 'loss_val': 0.019172120228574823, 'psi': 0.9972110663406708}
[S13] START round=46 head_norm_before_train=2.211481 cos_to_last_merge=0.9997 (last merge round=37)
[S13] round=46 local utility u=0.210761 metrics={'f1_val': 0.5842771797731826, 'auprc': 0.7140126378679162, 'loss_val': 0.8893369586489585, 'psi': 0.6361713630110761}-{'f1_val': 0.5806327924762998, 'auprc': 0.586359567789389, 'loss_val': 0.9060341752758541, 'psi': 0.5829235026015356}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] sending update (kind=head size=1796 to 1 peers)
[S14] START round=46 head_norm_before_train=2.180122 cos_to_last_merge=0.9919 (last merge round=25)
[S14] round=46 local utility u=0.000739 metrics={'f1_val': 0.9971907882668205, 'auprc': 0.9969740837791665, 'loss_val': 0.021332717533544904, 'psi': 0.997104106471759}-{'f1_val': 0.9978195179672185, 'auprc': 0.9962812967540586, 'loss_val': 0.024504144224205746, 'psi': 0.9972042294819545}
[S15] START round=46 head_norm_before_train=1.915632 cos_to_last_merge=0.7523 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.752
[S15] round=46 local utility u=0.004552 metrics={'f1_val': 0.996234816000801, 'auprc': 0.9985739380137488, 'loss_val': 0.022174763563261642, 'psi': 0.99717046480598}-{'f1_val': 0.9958642312648849, 'auprc': 0.997271656139001, 'loss_val': 0.02514900270516483, 'psi': 0.9964272012145313}
[S15] not sending this round → trigger blocked (psi=0.997)
[S16] START round=46 head_norm_before_train=1.709826 cos_to_last_merge=0.9783 (last merge round=25)
[S16] round=46 local utility u=0.000000 metrics={'f1_val': 0.9429338289706687, 'auprc': 0.9827330577984055, 'loss_val': 0.1855003631566868, 'psi': 0.9588535205017634}-{'f1_val': 0.9915843765742902, 'auprc': 0.991524797444316, 'loss_val': 0.04659894700351311, 'psi': 0.9915605449223006}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=46 head_norm_before_train=1.927936 (no previous merge yet)
[S17] round=46 local utility u=0.000000 metrics={'f1_val': 0.6231097266921795, 'auprc': 0.8620898955578611, 'loss_val': 1.2089802381181007, 'psi': 0.7187017942384522}-{'f1_val': 0.696733101328223, 'auprc': 0.9211001802533472, 'loss_val': 0.734901146882583, 'psi': 0.7864799328982727}
[S9]  timeout peer S13
[S8]  timeout peer S16
[S10]  timeout peer S14
[S14]  timeout peer S4
[S17]  timeout peer S9
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S11] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:37112
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=46 metric=0.7033 head_norm=1.997241
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.670514e-02
[S7] stored merged vector for next round verification (round=46)
[S7] DEBUG after merge:  round=46 metric=0.7033 head_norm=2.004822 delta_norm=0.016705
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S6] sending update (kind=head size=1801 to 1 peers)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] RECEIVED delta(kind=head bytes=1801) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.939752)
[S11] loaded HEAD from S6 (vec_in norm=1.939752)
[S11] cosine check vs S6: cos=-0.0599
[S11] DROPPED delta from S6 (cos=-0.0599 < 0.0)
[S2] START round=47 head_norm_before_train=2.046153 (no previous merge yet)
[S2] round=47 local utility u=0.000000 metrics={'f1_val': 0.993030639998429, 'auprc': 0.9805315314542383, 'loss_val': 0.0564273519473689, 'psi': 0.9880309965807528}-{'f1_val': 0.9897901874735275, 'auprc': 0.9831373324718276, 'loss_val': 0.041419473357813576, 'psi': 0.9871290454728475}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=47 head_norm_before_train=2.350756 (no previous merge yet)
[S3] round=47 local utility u=0.368399 metrics={'f1_val': 0.9968752412829052, 'auprc': 0.9991548946811744, 'loss_val': 0.020850283693606496, 'psi': 0.9977871026422129}-{'f1_val': 0.9085989426494433, 'auprc': 0.9985996476805514, 'loss_val': 0.22632458829345906, 'psi': 0.9445992246618865}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=47 head_norm_before_train=2.244357 cos_to_last_merge=0.9942 (last merge round=24)
[S4] round=47 local utility u=0.000000 metrics={'f1_val': 0.9519896641218979, 'auprc': 0.9322048982960345, 'loss_val': 0.30901499597947, 'psi': 0.9440757577915525}-{'f1_val': 0.948787172098873, 'auprc': 0.9445897785652759, 'loss_val': 0.29665332579704823, 'psi': 0.9471082146854342}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=47 head_norm_before_train=1.927350 cos_to_last_merge=0.7824 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.782
[S5] round=47 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9936563900679365, 'loss_val': 0.024237709935842077, 'psi': 0.9952628432053087}-{'f1_val': 0.9967019684784577, 'auprc': 0.9936933871044246, 'loss_val': 0.023030959398119395, 'psi': 0.9954985359288444}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=47 head_norm_before_train=1.939752 (no previous merge yet)
[S6] round=47 local utility u=0.926964 metrics={'f1_val': 0.9534620922689387, 'auprc': 0.9751609340918257, 'loss_val': 0.19928589476836922, 'psi': 0.9621416289980935}-{'f1_val': 0.7731370768371338, 'auprc': 0.8902590762889315, 'loss_val': 0.7165582677776301, 'psi': 0.8199858766178529}
[S7] START round=47 head_norm_before_train=2.004822 cos_to_last_merge=1.0000 (last merge round=46)
[S7] round=47 local utility u=0.000000 metrics={'f1_val': 0.6665789314442531, 'auprc': 0.8092179117908429, 'loss_val': 0.38523836291851854, 'psi': 0.7236345235828889}-{'f1_val': 0.7033069140007158, 'auprc': 0.8385012361993329, 'loss_val': 0.29429442102329734, 'psi': 0.7573846428801627}
[S8] START round=47 head_norm_before_train=1.629715 cos_to_last_merge=0.9759 (last merge round=29)
[S8] round=47 local utility u=0.007037 metrics={'f1_val': 0.9960539056390789, 'auprc': 0.9990927111183147, 'loss_val': 0.03909161736324821, 'psi': 0.9972694278307732}-{'f1_val': 0.9945800350935671, 'auprc': 0.9990804010830429, 'loss_val': 0.044284798506772596, 'psi': 0.9963801814893574}
[S9] START round=47 head_norm_before_train=2.252728 cos_to_last_merge=0.9993 (last merge round=32)
[S9] round=47 local utility u=0.014804 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9978593288943323, 'loss_val': 0.016338917836905015, 'psi': 0.9974054790650186}-{'f1_val': 0.9925154678702236, 'auprc': 0.99989068136116, 'loss_val': 0.024516212825370056, 'psi': 0.9954655532665981}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=47 head_norm_before_train=2.015378 cos_to_last_merge=1.0000 (last merge round=45)
[S10] round=47 local utility u=0.054316 metrics={'f1_val': 0.8322218419210022, 'auprc': 0.9941335919826844, 'loss_val': 0.3982248708546209, 'psi': 0.8969865419456751}-{'f1_val': 0.8171022700996831, 'auprc': 0.9937963992943506, 'loss_val': 0.4151279944370793, 'psi': 0.88777992177755}
[S11] START round=47 head_norm_before_train=2.110696 (no previous merge yet)
[S11] round=47 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9985738665223813, 'loss_val': 0.018568665748282955, 'psi': 0.9973577493171063}-{'f1_val': 0.996305167468861, 'auprc': 0.9990814050523835, 'loss_val': 0.018631697149629402, 'psi': 0.99741566250227}
[S13] START round=47 head_norm_before_train=2.216450 cos_to_last_merge=0.9996 (last merge round=37)
[S13] round=47 local utility u=0.000000 metrics={'f1_val': 0.5621520074179303, 'auprc': 0.6747598201320457, 'loss_val': 0.9820330150638757, 'psi': 0.6071951325035765}-{'f1_val': 0.5842771797731826, 'auprc': 0.7140126378679162, 'loss_val': 0.8893369586489585, 'psi': 0.6361713630110761}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=47 head_norm_before_train=2.186771 cos_to_last_merge=0.9916 (last merge round=25)
[S14] round=47 local utility u=0.000006 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9966601413410052, 'loss_val': 0.02168335671662742, 'psi': 0.9971090182374375}-{'f1_val': 0.9971907882668205, 'auprc': 0.9969740837791665, 'loss_val': 0.021332717533544904, 'psi': 0.997104106471759}
[S14] not sending this round → trigger blocked (psi=0.997)
[S15] START round=47 head_norm_before_train=1.924172 cos_to_last_merge=0.7514 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.751
[S15] round=47 local utility u=0.000000 metrics={'f1_val': 0.954819230695445, 'auprc': 0.9960937350868737, 'loss_val': 0.06787184365467046, 'psi': 0.9713290324520165}-{'f1_val': 0.996234816000801, 'auprc': 0.9985739380137488, 'loss_val': 0.022174763563261642, 'psi': 0.99717046480598}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=47 head_norm_before_train=1.719043 cos_to_last_merge=0.9778 (last merge round=25)
[S16] round=47 local utility u=0.000000 metrics={'f1_val': 0.8387234029983609, 'auprc': 0.9868575523108243, 'loss_val': 0.5738713413039015, 'psi': 0.8979770627233463}-{'f1_val': 0.9429338289706687, 'auprc': 0.9827330577984055, 'loss_val': 0.1855003631566868, 'psi': 0.9588535205017634}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=47 head_norm_before_train=1.939147 (no previous merge yet)
[S17] round=47 local utility u=0.478675 metrics={'f1_val': 0.6879028170345911, 'auprc': 0.9190774274892175, 'loss_val': 0.81135090888623, 'psi': 0.7803726612164417}-{'f1_val': 0.6231097266921795, 'auprc': 0.8620898955578611, 'loss_val': 1.2089802381181007, 'psi': 0.7187017942384522}
[S6] not sending this round → trigger blocked (psi=0.962)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] → sending delta(kind=head bytes=1805) to S17@127.0.0.1:37117
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:37109
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:37108
[S17] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1805 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1795) from S10
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=2.026932)
[S7] loaded HEAD from S10 (vec_in norm=2.026932)
[S7] cosine check vs S10: cos=0.9999
[S7] BUFFERED delta from S10 (total buffered=1)
[S17] RECEIVED delta(kind=head bytes=1805) from S8
[S17] model_id mismatch: wear != wear
[S17] after if model_id mismatch: wear != wear
[S17] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.640189)
[S17] loaded HEAD from S8 (vec_in norm=1.640189)
[S17] cosine check vs S8: cos=-0.0447
[S17] DROPPED delta from S8 (cos=-0.0447 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1799) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.951771)
[S8] loaded HEAD from S17 (vec_in norm=1.951771)
[S8] cosine check vs S17: cos=-0.0447
[S8] DROPPED delta from S17 (cos=-0.0447 < 0.0)
[S2] START round=48 head_norm_before_train=2.055345 (no previous merge yet)
[S2] round=48 local utility u=0.000000 metrics={'f1_val': 0.9874091534487619, 'auprc': 0.9828492143154768, 'loss_val': 0.04543241320432871, 'psi': 0.9855851777954479}-{'f1_val': 0.993030639998429, 'auprc': 0.9805315314542383, 'loss_val': 0.0564273519473689, 'psi': 0.9880309965807528}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=48 head_norm_before_train=2.358335 (no previous merge yet)
[S3] round=48 local utility u=0.000000 metrics={'f1_val': 0.951729439641726, 'auprc': 0.9983962819869924, 'loss_val': 0.17066602361136957, 'psi': 0.9703961765798325}-{'f1_val': 0.9968752412829052, 'auprc': 0.9991548946811744, 'loss_val': 0.020850283693606496, 'psi': 0.9977871026422129}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=48 head_norm_before_train=2.249915 cos_to_last_merge=0.9937 (last merge round=24)
[S4] round=48 local utility u=0.003281 metrics={'f1_val': 0.9449620331622102, 'auprc': 0.9456194252630818, 'loss_val': 0.3005299838543992, 'psi': 0.9452249900025589}-{'f1_val': 0.9519896641218979, 'auprc': 0.9322048982960345, 'loss_val': 0.30901499597947, 'psi': 0.9440757577915525}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=48 head_norm_before_train=1.930267 cos_to_last_merge=0.7830 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.783
[S5] round=48 local utility u=0.001316 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9937761286015764, 'loss_val': 0.021965396880456574, 'psi': 0.9953107386187646}-{'f1_val': 0.9963338119635569, 'auprc': 0.9936563900679365, 'loss_val': 0.024237709935842077, 'psi': 0.9952628432053087}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=48 head_norm_before_train=1.943127 (no previous merge yet)
[S6] round=48 local utility u=0.000000 metrics={'f1_val': 0.624534335474647, 'auprc': 0.9089600744943043, 'loss_val': 0.938241742883248, 'psi': 0.7383046310825099}-{'f1_val': 0.9534620922689387, 'auprc': 0.9751609340918257, 'loss_val': 0.19928589476836922, 'psi': 0.9621416289980935}
[S7] START round=48 head_norm_before_train=2.008241 cos_to_last_merge=1.0000 (last merge round=46)
[S7] round=48 local utility u=0.000000 metrics={'f1_val': 0.6641029223176651, 'auprc': 0.8098830311217706, 'loss_val': 0.3899819284171023, 'psi': 0.7224149658393073}-{'f1_val': 0.6665789314442531, 'auprc': 0.8092179117908429, 'loss_val': 0.38523836291851854, 'psi': 0.7236345235828889}
[S8] START round=48 head_norm_before_train=1.640189 cos_to_last_merge=0.9752 (last merge round=29)
[S8] round=48 local utility u=0.000000 metrics={'f1_val': 0.9960539056390789, 'auprc': 0.9989672169533966, 'loss_val': 0.041506323229172096, 'psi': 0.997219230164806}-{'f1_val': 0.9960539056390789, 'auprc': 0.9990927111183147, 'loss_val': 0.03909161736324821, 'psi': 0.9972694278307732}
[S9] START round=48 head_norm_before_train=2.254313 cos_to_last_merge=0.9992 (last merge round=32)
[S9] round=48 local utility u=0.001269 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.998781670036702, 'loss_val': 0.016568117496001827, 'psi': 0.9977744155219666}-{'f1_val': 0.9971029125121428, 'auprc': 0.9978593288943323, 'loss_val': 0.016338917836905015, 'psi': 0.9974054790650186}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=48 head_norm_before_train=2.026932 cos_to_last_merge=0.9999 (last merge round=45)
[S10] round=48 local utility u=0.000000 metrics={'f1_val': 0.8272488173818013, 'auprc': 0.9941516391643903, 'loss_val': 0.40631301111932266, 'psi': 0.894009946094837}-{'f1_val': 0.8322218419210022, 'auprc': 0.9941335919826844, 'loss_val': 0.3982248708546209, 'psi': 0.8969865419456751}
[S11] START round=48 head_norm_before_train=2.115227 (no previous merge yet)
[S11] round=48 local utility u=0.000000 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9984928184926782, 'loss_val': 0.02022307760816201, 'psi': 0.9971802278783879}-{'f1_val': 0.9965470045135896, 'auprc': 0.9985738665223813, 'loss_val': 0.018568665748282955, 'psi': 0.9973577493171063}
[S13] START round=48 head_norm_before_train=2.222102 cos_to_last_merge=0.9995 (last merge round=37)
[S13] round=48 local utility u=0.353392 metrics={'f1_val': 0.6205024682662774, 'auprc': 0.6931100244618602, 'loss_val': 0.6804017119121397, 'psi': 0.6495454907445106}-{'f1_val': 0.5621520074179303, 'auprc': 0.6747598201320457, 'loss_val': 0.9820330150638757, 'psi': 0.6071951325035765}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] sending update (kind=head size=1796 to 1 peers)
[S14] START round=48 head_norm_before_train=2.192655 cos_to_last_merge=0.9912 (last merge round=25)
[S14] round=48 local utility u=0.000420 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9971849614442584, 'loss_val': 0.0224174020386386, 'psi': 0.9973189462787387}-{'f1_val': 0.9974082695017256, 'auprc': 0.9966601413410052, 'loss_val': 0.02168335671662742, 'psi': 0.9971090182374375}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=48 head_norm_before_train=1.932733 cos_to_last_merge=0.7504 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.750
[S15] round=48 local utility u=0.000000 metrics={'f1_val': 0.7848644644663473, 'auprc': 0.9925796756177357, 'loss_val': 0.35728759150281714, 'psi': 0.8679505489269026}-{'f1_val': 0.954819230695445, 'auprc': 0.9960937350868737, 'loss_val': 0.06787184365467046, 'psi': 0.9713290324520165}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=48 head_norm_before_train=1.727025 cos_to_last_merge=0.9774 (last merge round=25)
[S16] round=48 local utility u=0.725441 metrics={'f1_val': 0.9901276969130701, 'auprc': 0.9935153604951492, 'loss_val': 0.0513890115875516, 'psi': 0.9914827623459017}-{'f1_val': 0.8387234029983609, 'auprc': 0.9868575523108243, 'loss_val': 0.5738713413039015, 'psi': 0.8979770627233463}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S17] START round=48 head_norm_before_train=1.951771 (no previous merge yet)
[S17] round=48 local utility u=0.000000 metrics={'f1_val': 0.6098154718265785, 'auprc': 0.8330119451001207, 'loss_val': 1.3107941026423662, 'psi': 0.6990940611359954}-{'f1_val': 0.6879028170345911, 'auprc': 0.9190774274892175, 'loss_val': 0.81135090888623, 'psi': 0.7803726612164417}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=48 metric=0.6641 head_norm=2.015828
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.599660e-02
[S7] stored merged vector for next round verification (round=48)
[S7] DEBUG after merge:  round=48 metric=0.6649 head_norm=2.021324 delta_norm=0.015997
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=49 head_norm_before_train=2.063973 (no previous merge yet)
[S2] round=49 local utility u=0.010277 metrics={'f1_val': 0.9928045365797099, 'auprc': 0.9819227887553107, 'loss_val': 0.05447126378277254, 'psi': 0.9884518374499502}-{'f1_val': 0.9874091534487619, 'auprc': 0.9828492143154768, 'loss_val': 0.04543241320432871, 'psi': 0.9855851777954479}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=49 head_norm_before_train=2.365448 (no previous merge yet)
[S3] round=49 local utility u=0.000000 metrics={'f1_val': 0.7666736618553494, 'auprc': 0.9986212334476907, 'loss_val': 0.5255930044451481, 'psi': 0.8594526904922859}-{'f1_val': 0.951729439641726, 'auprc': 0.9983962819869924, 'loss_val': 0.17066602361136957, 'psi': 0.9703961765798325}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=49 head_norm_before_train=2.254355 cos_to_last_merge=0.9934 (last merge round=24)
[S4] round=49 local utility u=0.018246 metrics={'f1_val': 0.9461537328275982, 'auprc': 0.953888836462573, 'loss_val': 0.29599696185543023, 'psi': 0.9492477742815881}-{'f1_val': 0.9449620331622102, 'auprc': 0.9456194252630818, 'loss_val': 0.3005299838543992, 'psi': 0.9452249900025589}
[S4] not sending this round → trigger blocked (psi=0.949)
[S5] START round=49 head_norm_before_train=1.938548 cos_to_last_merge=0.7821 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.782
[S5] round=49 local utility u=0.000000 metrics={'f1_val': 0.9959650868991299, 'auprc': 0.9926562065388077, 'loss_val': 0.03187481388492934, 'psi': 0.994641534755001}-{'f1_val': 0.9963338119635569, 'auprc': 0.9937761286015764, 'loss_val': 0.021965396880456574, 'psi': 0.9953107386187646}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=49 head_norm_before_train=1.946471 (no previous merge yet)
[S6] round=49 local utility u=0.647390 metrics={'f1_val': 0.7902367651012668, 'auprc': 0.9290328919862076, 'loss_val': 0.697894446253451, 'psi': 0.8457552158552432}-{'f1_val': 0.624534335474647, 'auprc': 0.9089600744943043, 'loss_val': 0.938241742883248, 'psi': 0.7383046310825099}
[S7] START round=49 head_norm_before_train=2.021324 cos_to_last_merge=1.0000 (last merge round=48)
[S7] round=49 local utility u=0.678968 metrics={'f1_val': 0.8179523932991168, 'auprc': 0.9001858528874742, 'loss_val': 0.22605176601116725, 'psi': 0.8508457771344597}-{'f1_val': 0.6641029223176651, 'auprc': 0.8098830311217706, 'loss_val': 0.3899819284171023, 'psi': 0.7224149658393073}
[S8] START round=49 head_norm_before_train=1.649205 cos_to_last_merge=0.9741 (last merge round=29)
[S8] round=49 local utility u=0.000000 metrics={'f1_val': 0.9960539056390789, 'auprc': 0.9983763919457718, 'loss_val': 0.042796379702299346, 'psi': 0.9969829001617561}-{'f1_val': 0.9960539056390789, 'auprc': 0.9989672169533966, 'loss_val': 0.041506323229172096, 'psi': 0.997219230164806}
[S9] START round=49 head_norm_before_train=2.261325 cos_to_last_merge=0.9991 (last merge round=32)
[S9] round=49 local utility u=0.000231 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9988685429855608, 'loss_val': 0.016367466044357522, 'psi': 0.99780916470151}-{'f1_val': 0.9971029125121428, 'auprc': 0.998781670036702, 'loss_val': 0.016568117496001827, 'psi': 0.9977744155219666}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=49 head_norm_before_train=2.037086 cos_to_last_merge=0.9998 (last merge round=45)
[S10] round=49 local utility u=0.000000 metrics={'f1_val': 0.8126744223532076, 'auprc': 0.9937155759599564, 'loss_val': 0.444370820208232, 'psi': 0.8850908837959071}-{'f1_val': 0.8272488173818013, 'auprc': 0.9941516391643903, 'loss_val': 0.40631301111932266, 'psi': 0.894009946094837}
[S11] START round=49 head_norm_before_train=2.119365 (no previous merge yet)
[S11] round=49 local utility u=0.000000 metrics={'f1_val': 0.9917519384520287, 'auprc': 0.998428574168583, 'loss_val': 0.03523692280752916, 'psi': 0.9944225927386504}-{'f1_val': 0.996305167468861, 'auprc': 0.9984928184926782, 'loss_val': 0.02022307760816201, 'psi': 0.9971802278783879}
[S13] START round=49 head_norm_before_train=2.226540 cos_to_last_merge=0.9994 (last merge round=37)
[S13] round=49 local utility u=0.000000 metrics={'f1_val': 0.5369853334554662, 'auprc': 0.6655389257660638, 'loss_val': 1.1354087990200996, 'psi': 0.5884067703797051}-{'f1_val': 0.6205024682662774, 'auprc': 0.6931100244618602, 'loss_val': 0.6804017119121397, 'psi': 0.6495454907445106}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=49 head_norm_before_train=2.200277 cos_to_last_merge=0.9908 (last merge round=25)
[S14] round=49 local utility u=0.000000 metrics={'f1_val': 0.9970233560109115, 'auprc': 0.9968993846624078, 'loss_val': 0.020622416631889386, 'psi': 0.99697376747151}-{'f1_val': 0.9974082695017256, 'auprc': 0.9971849614442584, 'loss_val': 0.0224174020386386, 'psi': 0.9973189462787387}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=49 head_norm_before_train=1.941342 cos_to_last_merge=0.7495 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.749
[S15] round=49 local utility u=0.775822 metrics={'f1_val': 0.987939970038929, 'auprc': 0.9970869084632845, 'loss_val': 0.037619138776360424, 'psi': 0.9915987454086712}-{'f1_val': 0.7848644644663473, 'auprc': 0.9925796756177357, 'loss_val': 0.35728759150281714, 'psi': 0.8679505489269026}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] sending update (kind=head size=1794 to 1 peers)
[S16] START round=49 head_norm_before_train=1.734853 cos_to_last_merge=0.9769 (last merge round=25)
[S16] round=49 local utility u=0.000000 metrics={'f1_val': 0.8324858899885399, 'auprc': 0.9914744963931525, 'loss_val': 0.9472821591563626, 'psi': 0.8960813325503849}-{'f1_val': 0.9901276969130701, 'auprc': 0.9935153604951492, 'loss_val': 0.0513890115875516, 'psi': 0.9914827623459017}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=49 head_norm_before_train=1.963599 (no previous merge yet)
[S17] round=49 local utility u=0.382983 metrics={'f1_val': 0.6509295038086567, 'auprc': 0.8988878961008232, 'loss_val': 0.9891402240295621, 'psi': 0.7501128607255233}-{'f1_val': 0.6098154718265785, 'auprc': 0.8330119451001207, 'loss_val': 1.3107941026423662, 'psi': 0.6990940611359954}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S17] → sending delta(kind=head bytes=1792) to S8@127.0.0.1:37109
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] → sending delta(kind=head bytes=1794) to S10@127.0.0.1:37111
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:37112
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1794 to 1 peers)
[S17] sending update (kind=head size=1792 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1800) from S6
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.951584)
[S11] loaded HEAD from S6 (vec_in norm=1.951584)
[S11] cosine check vs S6: cos=-0.0591
[S11] DROPPED delta from S6 (cos=-0.0591 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1794) from S7
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=2.027759)
[S10] loaded HEAD from S7 (vec_in norm=2.027759)
[S10] cosine check vs S7: cos=0.9998
[S10] BUFFERED delta from S7 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1792) from S17
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.974371)
[S8] loaded HEAD from S17 (vec_in norm=1.974371)
[S8] cosine check vs S17: cos=-0.0445
[S8] DROPPED delta from S17 (cos=-0.0445 < 0.0)
[runner] rounds complete.
[runner] all agents stopped.
