[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:49303
[S3] → join 127.0.0.1:49302
[S4] → join 127.0.0.1:49302
[S5] → join 127.0.0.1:49302
[S6] → join 127.0.0.1:49302
[S7] → join 127.0.0.1:49302
[S8] → join 127.0.0.1:49302
[S9] → join 127.0.0.1:49302
[S10] → join 127.0.0.1:49302
[S11] → join 127.0.0.1:49302
[S13] → join 127.0.0.1:49302
[S14] → join 127.0.0.1:49302
[S15] → join 127.0.0.1:49302
[S16] → join 127.0.0.1:49302
[S17] → join 127.0.0.1:49302
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.130117 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.190783 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.200591 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.185171 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.140270 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.112877 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.158619 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.148698 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.191853 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.186098 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.171761 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.180152 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.125596 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.150415 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.175527 (no previous merge yet)
[S8]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S3] + discovered S11
[S3] + discovered S14
[S3] + discovered S17
[S3] + discovered S6
[S3] + discovered S4
[S3] + discovered S13
[S4] + discovered S2
[S4] + discovered S3
[S3] + discovered S15
[S3] + discovered S9
[S3] + discovered S7
[S3] + discovered S16
[S3] + discovered S10
[S3] + discovered S5
[S3] + discovered S8
[S4] + discovered S7
[S4] + discovered S15
[S4] + discovered S5
[S4] + discovered S13
[S4] + discovered S16
[S4] + discovered S8
[S4] + discovered S11
[S4] + discovered S10
[S4] + discovered S17
[S4] + discovered S6
[S4] + discovered S9
[S5] + discovered S3
[S5] + discovered S4
[S4] + discovered S14
[S5] + discovered S2
[S6] + discovered S3
[S6] + discovered S4
[S6] + discovered S5
[S6] + discovered S2
[S5] + discovered S10
[S5] + discovered S17
[S5] + discovered S6
[S5] + discovered S15
[S5] + discovered S9
[S5] + discovered S14
[S5] + discovered S11
[S5] + discovered S8
[S5] + discovered S13
[S5] + discovered S16
[S5] + discovered S7
[S6] + discovered S8
[S6] + discovered S13
[S6] + discovered S16
[S6] + discovered S7
[S6] + discovered S11
[S6] + discovered S14
[S6] + discovered S15
[S6] + discovered S9
[S6] + discovered S17
[S6] + discovered S10
[S7] + discovered S6
[S7] + discovered S2
[S7] + discovered S4
[S7] + discovered S5
[S7] + discovered S3
[S7] + discovered S10
[S7] + discovered S9
[S7] + discovered S11
[S7] + discovered S16
[S7] + discovered S13
[S7] + discovered S8
[S7] + discovered S17
[S7] + discovered S15
[S7] + discovered S14
[S8] + discovered S3
[S8] + discovered S7
[S8] + discovered S4
[S8] + discovered S5
[S8] + discovered S2
[S8] + discovered S6
[S9] + discovered S6
[S9] + discovered S5
[S9] + discovered S4
[S9] + discovered S8
[S9] + discovered S2
[S9] + discovered S7
[S9] + discovered S3
[S8] + discovered S14
[S8] + discovered S15
[S8] + discovered S13
[S8] + discovered S11
[S8] + discovered S17
[S8] + discovered S16
[S8] + discovered S9
[S8] + discovered S10
[S9] + discovered S13
[S9] + discovered S17
[S9] + discovered S16
[S9] + discovered S11
[S9] + discovered S15
[S9] + discovered S14
[S9] + discovered S10
[S10] + discovered S9
[S10] + discovered S7
[S10] + discovered S2
[S10] + discovered S8
[S10] + discovered S3
[S10] + discovered S5
[S10] + discovered S6
[S10] + discovered S4
[S11] + discovered S3
[S11] + discovered S5
[S11] + discovered S9
[S11] + discovered S10
[S11] + discovered S6
[S11] + discovered S4
[S11] + discovered S2
[S11] + discovered S7
[S10] + discovered S14
[S10] + discovered S16
[S10] + discovered S15
[S10] + discovered S11
[S10] + discovered S17
[S10] + discovered S13
[S11] + discovered S8
[S13] + discovered S9
[S13] + discovered S3
[S13] + discovered S8
[S13] + discovered S2
[S13] + discovered S5
[S13] + discovered S4
[S13] + discovered S7
[S13] + discovered S11
[S13] + discovered S10
[S13] + discovered S6
[S11] + discovered S13
[S11] + discovered S17
[S11] + discovered S15
[S11] + discovered S14
[S11] + discovered S16
[S14] + discovered S6
[S14] + discovered S7
[S14] + discovered S10
[S14] + discovered S4
[S14] + discovered S2
[S14] + discovered S13
[S13] + discovered S16
[S13] + discovered S17
[S13] + discovered S14
[S13] + discovered S15
[S14] + discovered S8
[S14] + discovered S9
[S14] + discovered S3
[S14] + discovered S5
[S14] + discovered S11
[S15] + discovered S6
[S14] + discovered S16
[S15] + discovered S4
[S15] + discovered S7
[S15] + discovered S2
[S15] + discovered S3
[S15] + discovered S11
[S15] + discovered S14
[S15] + discovered S8
[S14] + discovered S17
[S14] + discovered S15
[S15] + discovered S13
[S15] + discovered S5
[S15] + discovered S10
[S15] + discovered S9
[S15] + discovered S17
[S15] + discovered S16
[S16] + discovered S8
[S16] + discovered S2
[S16] + discovered S5
[S16] + discovered S3
[S16] + discovered S13
[S16] + discovered S6
[S16] + discovered S7
[S16] + discovered S15
[S16] + discovered S14
[S16] + discovered S11
[S16] + discovered S4
[S16] + discovered S10
[S16] + discovered S9
[S17] + discovered S8
[S17] + discovered S14
[S16] + discovered S17
[S17] + discovered S11
[S17] + discovered S3
[S17] + discovered S2
[S17] + discovered S7
[S17] + discovered S15
[S17] + discovered S9
[S17] + discovered S4
[S17] + discovered S6
[S17] + discovered S5
[S17] + discovered S10
[S17] + discovered S13
[S17] + discovered S16
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] ⇄ pheromone p=1.000 → S16@127.0.0.1:49316
[S15] ⇄ pheromone p=1.000 → S5@127.0.0.1:49305
[S14] ⇄ pheromone p=1.000 → S8@127.0.0.1:49309
[S16] ⇄ pheromone p=1.000 → S14@127.0.0.1:49314
[S8] ⇄ pheromone p=1.000 → S9@127.0.0.1:49310
[S10] ⇄ pheromone p=1.000 → S9@127.0.0.1:49310
[S5] ⇄ pheromone p=1.000 → S16@127.0.0.1:49316
[S2] ⇄ pheromone p=1.000 → S15@127.0.0.1:49315
[S13] ⇄ pheromone p=1.000 → S10@127.0.0.1:49311
[S3] ⇄ pheromone p=1.000 → S2@127.0.0.1:49302
[S4] ⇄ pheromone p=1.000 → S11@127.0.0.1:49312
[S7] ⇄ pheromone p=1.000 → S3@127.0.0.1:49303
[S6] ⇄ pheromone p=1.000 → S8@127.0.0.1:49309
[S11] ⇄ pheromone p=1.000 → S15@127.0.0.1:49315
[S17] ⇄ pheromone p=1.000 → S3@127.0.0.1:49303
[S2] START round=1 head_norm_before_train=1.140578 (no previous merge yet)
[S2] round=1 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7822801061510721, 'loss_val': 1.2604472808970155, 'psi': 0.3979783224935689}-{'f1_val': 0.31075799739530924, 'auprc': 0.7977579853187512, 'loss_val': 1.3238742034343498, 'psi': 0.505557992564686}
[S3] START round=1 head_norm_before_train=1.192061 (no previous merge yet)
[S3] round=1 local utility u=0.432114 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.7776577610419739, 'loss_val': 1.3256186061410549, 'psi': 0.39496714378525377}-{'f1_val': 0.13984006561410703, 'auprc': 0.4974972167591458, 'loss_val': 1.3493646193955002, 'psi': 0.28290292607212253}
[S4] START round=1 head_norm_before_train=1.226293 (no previous merge yet)
[S4] round=1 local utility u=0.000000 metrics={'f1_val': 0.14429825300912802, 'auprc': 0.7938241189299393, 'loss_val': 1.2330192814889502, 'psi': 0.4041085993774526}-{'f1_val': 0.4128363659984965, 'auprc': 0.7933156324368064, 'loss_val': 1.3035361613247425, 'psi': 0.5650280725738204}
[S5] START round=1 head_norm_before_train=1.187909 (no previous merge yet)
[S5] round=1 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7686757489580371, 'loss_val': 1.3057582017744558, 'psi': 0.3928274424403577}-{'f1_val': 0.42433754414358743, 'auprc': 0.7770765681377664, 'loss_val': 1.3412660644443244, 'psi': 0.565433153741259}
[S6] START round=1 head_norm_before_train=1.139502 (no previous merge yet)
[S6] round=1 local utility u=0.290651 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8303771474469277, 'loss_val': 1.2965283078312937, 'psi': 0.4170066282095403}-{'f1_val': 0.14142628205128205, 'auprc': 0.6574920435585554, 'loss_val': 1.3591756471638285, 'psi': 0.3478525866541914}
[S7] START round=1 head_norm_before_train=1.124416 (no previous merge yet)
[S7] round=1 local utility u=0.343146 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7742117061852419, 'loss_val': 1.3378027564281165, 'psi': 0.3949187761115518}-{'f1_val': 0.05555555555555555, 'auprc': 0.7300633397778475, 'loss_val': 1.372642314783133, 'psi': 0.3253586692444724}
[S8] START round=1 head_norm_before_train=1.173256 (no previous merge yet)
[S8] round=1 local utility u=0.072611 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.766063159795672, 'loss_val': 1.2676154290031716, 'psi': 0.3903988533540431}-{'f1_val': 0.13995598239295717, 'auprc': 0.7381044151848537, 'loss_val': 1.3289604790220484, 'psi': 0.3792153555097158}
[S9] START round=1 head_norm_before_train=1.157761 (no previous merge yet)
[S9] round=1 local utility u=0.061001 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9995177298399572, 'loss_val': 1.301711400789372, 'psi': 0.4846458662199805}-{'f1_val': 0.141397957139996, 'auprc': 0.974677490784316, 'loss_val': 1.3491935134300166, 'psi': 0.474709770597724}
[S10] START round=1 head_norm_before_train=1.202718 (no previous merge yet)
[S10] round=1 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7820655184029939, 'loss_val': 1.282070210962827, 'psi': 0.39599918988623195}-{'f1_val': 0.13862163754172394, 'auprc': 0.9356624673740868, 'loss_val': 1.338467810422226, 'psi': 0.4574379694746691}
[S11] START round=1 head_norm_before_train=1.190187 (no previous merge yet)
[S11] round=1 local utility u=0.185469 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7505482842803994, 'loss_val': 1.318835470659911, 'psi': 0.38446752373602616}-{'f1_val': 0.14041368337311058, 'auprc': 0.6390413232280057, 'loss_val': 1.355252289435771, 'psi': 0.3398647393150686}
[S13] START round=1 head_norm_before_train=1.168698 (no previous merge yet)
[S13] round=1 local utility u=1.000000 metrics={'f1_val': 0.415486691627877, 'auprc': 0.5761726349586587, 'loss_val': 1.3153270557654646, 'psi': 0.47976106896018966}-{'f1_val': 0.09037372593431484, 'auprc': 0.5235698212918949, 'loss_val': 1.3676370216602356, 'psi': 0.2636521640773469}
[S14] START round=1 head_norm_before_train=1.177609 (no previous merge yet)
[S14] round=1 local utility u=0.189026 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.6412963913381032, 'loss_val': 1.3535819372845244, 'psi': 0.34073326826486355}-{'f1_val': 0.09914320685434516, 'auprc': 0.6062805364737778, 'loss_val': 1.379297577654568, 'psi': 0.3019981387021182}
[S15] START round=1 head_norm_before_train=1.126479 (no previous merge yet)
[S15] round=1 local utility u=1.000000 metrics={'f1_val': 0.28469075779317893, 'auprc': 0.7245079537934056, 'loss_val': 1.319588442050139, 'psi': 0.46061763619326956}-{'f1_val': 0.103651869669801, 'auprc': 0.4097257915619018, 'loss_val': 1.3662388747910483, 'psi': 0.22608143842664133}
[S16] START round=1 head_norm_before_train=1.154209 (no previous merge yet)
[S16] round=1 local utility u=0.371256 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8935416078052146, 'loss_val': 1.3333055850639448, 'psi': 0.4417991132416078}-{'f1_val': 0.14063745019920318, 'auprc': 0.6551548540075363, 'loss_val': 1.3606580597480293, 'psi': 0.34644441172253637}
[S17] START round=1 head_norm_before_train=1.198771 (no previous merge yet)
[S17] round=1 local utility u=0.017636 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.9221325628754067, 'loss_val': 1.27598881011807, 'psi': 0.45342240314059334}-{'f1_val': 0.14094896331738438, 'auprc': 0.9299362082690423, 'loss_val': 1.3346719977430164, 'psi': 0.4565438612980476}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:49310
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S13] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:49316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S6] → sending delta(kind=head bytes=1792) to S7@127.0.0.1:49308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S9] → sending delta(kind=head bytes=1791) to S6@127.0.0.1:49307
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1785 reason=None
[S14] → sending delta(kind=head bytes=1785) to S2@127.0.0.1:49302
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S7] → sending delta(kind=head bytes=1788) to S15@127.0.0.1:49315
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S16] → sending delta(kind=head bytes=1792) to S9@127.0.0.1:49310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S11] → sending delta(kind=head bytes=1792) to S17@127.0.0.1:49317
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:49317
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1783 reason=None
[S3] → sending delta(kind=head bytes=1783) to S13@127.0.0.1:49313
[S15] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1792 to 1 peers)
[S16] sending update (kind=head size=1792 to 1 peers)
[S7] sending update (kind=head size=1788 to 1 peers)
[S3] sending update (kind=head size=1783 to 1 peers)
[S14] sending update (kind=head size=1785 to 1 peers)
[S9] sending update (kind=head size=1791 to 1 peers)
[S6] sending update (kind=head size=1792 to 1 peers)
[S13] sending update (kind=head size=1793 to 1 peers)
[S8] sending update (kind=head size=1794 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1792) from S16
[S9] cosine check vs S16: cos=0.0043
[S9] RECEIVED delta(kind=head bytes=1794) from S8
[S9] cosine check vs S8: cos=-0.0248
[S9] DROPPED delta from S8 (cos=-0.0248 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1791) from S9
[S6] cosine check vs S9: cos=-0.0770
[S6] DROPPED delta from S9 (cos=-0.0770 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1797) from S15
[S17] cosine check vs S15: cos=-0.0339
[S17] DROPPED delta from S15 (cos=-0.0339 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1792) from S11
[S17] cosine check vs S11: cos=-0.0440
[S17] DROPPED delta from S11 (cos=-0.0440 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1792) from S6
[S7] cosine check vs S6: cos=0.0364
[S15] RECEIVED delta(kind=head bytes=1788) from S7
[S15] cosine check vs S7: cos=0.0407
[S16] RECEIVED delta(kind=head bytes=1793) from S13
[S16] cosine check vs S13: cos=0.1431
[S13] RECEIVED delta(kind=head bytes=1783) from S3
[S13] cosine check vs S3: cos=0.0223
[S2] RECEIVED delta(kind=head bytes=1785) from S14
[S2] cosine check vs S14: cos=0.0592
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:49310
[S17] sending update (kind=head size=1801 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1801) from S17
[S9] cosine check vs S17: cos=-0.0785
[S9] DROPPED delta from S17 (cos=-0.0785 < 0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=1 metric=0.1418 head_norm=1.180876
[S2] _apply_head_vector_avg (torch): Δ‖w‖=8.104715e-01
[S2] stored merged vector for next round verification (round=1)
[S2] DEBUG after merge:  round=1 metric=0.2039 head_norm=0.859984 delta_norm=0.810471
[S2] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=1 metric=0.1421 head_norm=1.143995
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.011354e-01
[S7] stored merged vector for next round verification (round=1)
[S7] DEBUG after merge:  round=1 metric=0.1421 head_norm=0.830871 delta_norm=0.801135
[S7] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=1 metric=0.4155 head_norm=1.191298
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.366698e-01
[S13] stored merged vector for next round verification (round=1)
[S13] DEBUG after merge:  round=1 metric=0.1410 head_norm=0.855517 delta_norm=0.836670
[S13] aggregate: ROLLBACK (f1_val pre=0.415 post=0.141 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=1 metric=0.1414 head_norm=1.178091
[S9] _apply_head_vector_avg (torch): Δ‖w‖=8.268392e-01
[S9] stored merged vector for next round verification (round=1)
[S9] DEBUG after merge:  round=1 metric=0.1414 head_norm=0.830427 delta_norm=0.826839
[S9] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=1 metric=0.2847 head_norm=1.156882
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.967797e-01
[S15] stored merged vector for next round verification (round=1)
[S15] DEBUG after merge:  round=1 metric=0.1397 head_norm=0.829875 delta_norm=0.796780
[S15] aggregate: ROLLBACK (f1_val pre=0.285 post=0.140 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=1 metric=0.1406 head_norm=1.165610
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.714315e-01
[S16] stored merged vector for next round verification (round=1)
[S16] DEBUG after merge:  round=1 metric=0.1406 head_norm=0.890961 delta_norm=0.771432
[S16] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=0.859984 cos_to_last_merge=1.0000 (last merge round=1)
[S2] round=2 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.747549148076782, 'loss_val': 1.217544187835553, 'psi': 0.3840859392638528}-{'f1_val': 0.1417771333885667, 'auprc': 0.7822801061510721, 'loss_val': 1.2604472808970155, 'psi': 0.3979783224935689}
[S3] START round=2 head_norm_before_train=1.201940 (no previous merge yet)
[S3] round=2 local utility u=0.028338 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.7874097603259198, 'loss_val': 1.2981987798580181, 'psi': 0.39886794349883214}-{'f1_val': 0.13984006561410703, 'auprc': 0.7776577610419739, 'loss_val': 1.3256186061410549, 'psi': 0.39496714378525377}
[S4] START round=2 head_norm_before_train=1.272664 (no previous merge yet)
[S4] round=2 local utility u=0.042450 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.783652874548577, 'loss_val': 1.093176579272094, 'psi': 0.39759712715654133}-{'f1_val': 0.14429825300912802, 'auprc': 0.7938241189299393, 'loss_val': 1.2330192814889502, 'psi': 0.4041085993774526}
[S5] START round=2 head_norm_before_train=1.196481 (no previous merge yet)
[S5] round=2 local utility u=0.021538 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7692827989591521, 'loss_val': 1.2645038749193902, 'psi': 0.39307026244080373}-{'f1_val': 0.14226190476190476, 'auprc': 0.7686757489580371, 'loss_val': 1.3057582017744558, 'psi': 0.3928274424403577}
[S6] START round=2 head_norm_before_train=1.164304 (no previous merge yet)
[S6] round=2 local utility u=0.015659 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8122181257717854, 'loss_val': 1.2107324347551431, 'psi': 0.4097430195394834}-{'f1_val': 0.14142628205128205, 'auprc': 0.8303771474469277, 'loss_val': 1.2965283078312937, 'psi': 0.4170066282095403}
[S7] START round=2 head_norm_before_train=0.830871 cos_to_last_merge=1.0000 (last merge round=1)
[S7] round=2 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.5745286154754553, 'loss_val': 1.320315305394542, 'psi': 0.3150455398276371}-{'f1_val': 0.14205682272909165, 'auprc': 0.7742117061852419, 'loss_val': 1.3378027564281165, 'psi': 0.3949187761115518}
[S8] START round=2 head_norm_before_train=1.210846 (no previous merge yet)
[S8] round=2 local utility u=0.050469 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7688573491001708, 'loss_val': 1.1750599897293434, 'psi': 0.39151652907584267}-{'f1_val': 0.13995598239295717, 'auprc': 0.766063159795672, 'loss_val': 1.2676154290031716, 'psi': 0.3903988533540431}
[S9] START round=2 head_norm_before_train=0.830427 cos_to_last_merge=1.0000 (last merge round=1)
[S9] round=2 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8658195063456833, 'loss_val': 1.3055413308507071, 'psi': 0.43116657682227094}-{'f1_val': 0.141397957139996, 'auprc': 0.9995177298399572, 'loss_val': 1.301711400789372, 'psi': 0.4846458662199805}
[S10] START round=2 head_norm_before_train=1.236078 (no previous merge yet)
[S10] round=2 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6867114764981916, 'loss_val': 1.2221329212979064, 'psi': 0.35785757312431105}-{'f1_val': 0.13862163754172394, 'auprc': 0.7820655184029939, 'loss_val': 1.282070210962827, 'psi': 0.39599918988623195}
[S11] START round=2 head_norm_before_train=1.205025 (no previous merge yet)
[S11] round=2 local utility u=0.168054 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.8475045701978564, 'loss_val': 1.273596561959518, 'psi': 0.42325003810300893}-{'f1_val': 0.14041368337311058, 'auprc': 0.7505482842803994, 'loss_val': 1.318835470659911, 'psi': 0.38446752373602616}
[S13] START round=2 head_norm_before_train=0.855517 cos_to_last_merge=1.0000 (last merge round=1)
[S13] round=2 local utility u=0.000000 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5545014134691877, 'loss_val': 1.293691040633414, 'psi': 0.30603202293390697}-{'f1_val': 0.415486691627877, 'auprc': 0.5761726349586587, 'loss_val': 1.3153270557654646, 'psi': 0.47976106896018966}
[S14] START round=2 head_norm_before_train=1.182541 (no previous merge yet)
[S14] round=2 local utility u=0.043779 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.6615346532442835, 'loss_val': 1.3267388010373498, 'psi': 0.34882857302733566}-{'f1_val': 0.14035785288270378, 'auprc': 0.6412963913381032, 'loss_val': 1.3535819372845244, 'psi': 0.34073326826486355}
[S15] START round=2 head_norm_before_train=0.829875 cos_to_last_merge=1.0000 (last merge round=1)
[S15] round=2 local utility u=0.000000 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.745432912340614, 'loss_val': 1.2946994816227222, 'psi': 0.38201335575318063}-{'f1_val': 0.28469075779317893, 'auprc': 0.7245079537934056, 'loss_val': 1.319588442050139, 'psi': 0.46061763619326956}
[S16] START round=2 head_norm_before_train=0.890961 cos_to_last_merge=1.0000 (last merge round=1)
[S16] round=2 local utility u=0.140641 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.9863208833662225, 'loss_val': 1.3303606245190394, 'psi': 0.4789108234660109}-{'f1_val': 0.14063745019920318, 'auprc': 0.8935416078052146, 'loss_val': 1.3333055850639448, 'psi': 0.4417991132416078}
[S17] START round=2 head_norm_before_train=1.249025 (no previous merge yet)
[S17] round=2 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.6160983110286514, 'loss_val': 1.1387645113424965, 'psi': 0.3310087024018912}-{'f1_val': 0.14094896331738438, 'auprc': 0.9221325628754067, 'loss_val': 1.27598881011807, 'psi': 0.45342240314059334}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S11] → sending delta(kind=head bytes=1791) to S10@127.0.0.1:49311
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S6] → sending delta(kind=head bytes=1791) to S13@127.0.0.1:49313
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S5] → sending delta(kind=head bytes=1790) to S9@127.0.0.1:49310
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] → sending delta(kind=head bytes=1793) to S6@127.0.0.1:49307
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:49310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:49303
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:49305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S14] → sending delta(kind=head bytes=1788) to S4@127.0.0.1:49304
[S16] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1793 to 1 peers)
[S5] sending update (kind=head size=1790 to 1 peers)
[S6] sending update (kind=head size=1791 to 1 peers)
[S11] sending update (kind=head size=1791 to 1 peers)
[S14] sending update (kind=head size=1788 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1791) from S6
[S13] cosine check vs S6: cos=0.0563
[S9] RECEIVED delta(kind=head bytes=1797) from S8
[S9] cosine check vs S8: cos=-0.0070
[S9] DROPPED delta from S8 (cos=-0.0070 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1796) from S16
[S5] cosine check vs S16: cos=-0.0825
[S5] DROPPED delta from S16 (cos=-0.0825 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1790) from S5
[S9] cosine check vs S5: cos=-0.0041
[S9] DROPPED delta from S5 (cos=-0.0041 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1793) from S3
[S6] cosine check vs S3: cos=0.0492
[S10] RECEIVED delta(kind=head bytes=1791) from S11
[S10] cosine check vs S11: cos=0.0377
[S4] RECEIVED delta(kind=head bytes=1788) from S14
[S4] cosine check vs S14: cos=0.0003
[S3] RECEIVED delta(kind=head bytes=1801) from S4
[S3] cosine check vs S4: cos=-0.0012
[S3] DROPPED delta from S4 (cos=-0.0012 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=2 metric=0.1386 head_norm=1.273879
[S10] _apply_head_vector_avg (torch): Δ‖w‖=8.684213e-01
[S10] stored merged vector for next round verification (round=2)
[S10] DEBUG after merge:  round=2 metric=0.1386 head_norm=0.901754 delta_norm=0.868421
[S10] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=2 metric=0.1404 head_norm=0.888258
[S13] _apply_head_vector_avg (torch): Δ‖w‖=7.318212e-01
[S13] stored merged vector for next round verification (round=2)
[S13] DEBUG after merge:  round=2 metric=0.1404 head_norm=0.772218 delta_norm=0.731821
[S13] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=2 metric=0.1414 head_norm=1.214399
[S6] _apply_head_vector_avg (torch): Δ‖w‖=8.397379e-01
[S6] stored merged vector for next round verification (round=2)
[S6] DEBUG after merge:  round=2 metric=0.1414 head_norm=0.882092 delta_norm=0.839738
[S6] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=2 metric=0.1402 head_norm=1.341616
[S4] _apply_head_vector_avg (torch): Δ‖w‖=8.995699e-01
[S4] stored merged vector for next round verification (round=2)
[S4] DEBUG after merge:  round=2 metric=0.4039 head_norm=0.899882 delta_norm=0.899570
[S4] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=3 head_norm_before_train=0.910884 cos_to_last_merge=0.9921 (last merge round=1)
[S2] round=3 local utility u=0.528659 metrics={'f1_val': 0.28607587416734226, 'auprc': 0.7727165767989298, 'loss_val': 1.1015199969513754, 'psi': 0.48073215521997725}-{'f1_val': 0.1417771333885667, 'auprc': 0.747549148076782, 'loss_val': 1.217544187835553, 'psi': 0.3840859392638528}
[S3] START round=3 head_norm_before_train=1.221363 (no previous merge yet)
[S3] round=3 local utility u=0.334733 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9983630062390012, 'loss_val': 1.2615925798481924, 'psi': 0.4832492418640647}-{'f1_val': 0.13984006561410703, 'auprc': 0.7874097603259198, 'loss_val': 1.2981987798580181, 'psi': 0.39886794349883214}
[S4] START round=3 head_norm_before_train=0.899882 cos_to_last_merge=1.0000 (last merge round=2)
[S4] round=3 local utility u=0.892465 metrics={'f1_val': 0.41387245678921186, 'auprc': 0.7764175780803662, 'loss_val': 0.92841649069185, 'psi': 0.5588905053056736}-{'f1_val': 0.14022662889518414, 'auprc': 0.783652874548577, 'loss_val': 1.093176579272094, 'psi': 0.39759712715654133}
[S5] START round=3 head_norm_before_train=1.213226 (no previous merge yet)
[S5] round=3 local utility u=0.022403 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7699321095565259, 'loss_val': 1.221645426477336, 'psi': 0.3933299866797532}-{'f1_val': 0.14226190476190476, 'auprc': 0.7692827989591521, 'loss_val': 1.2645038749193902, 'psi': 0.39307026244080373}
[S6] START round=3 head_norm_before_train=0.882092 cos_to_last_merge=1.0000 (last merge round=2)
[S6] round=3 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6448579463627504, 'loss_val': 1.1485391534319123, 'psi': 0.3427989477758694}-{'f1_val': 0.14142628205128205, 'auprc': 0.8122181257717854, 'loss_val': 1.2107324347551431, 'psi': 0.4097430195394834}
[S7] START round=3 head_norm_before_train=0.854907 cos_to_last_merge=0.9971 (last merge round=1)
[S7] round=3 local utility u=0.289896 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7556503563373451, 'loss_val': 1.2838879688626588, 'psi': 0.38749423617239304}-{'f1_val': 0.14205682272909165, 'auprc': 0.5745286154754553, 'loss_val': 1.320315305394542, 'psi': 0.3150455398276371}
[S8] START round=3 head_norm_before_train=1.268764 (no previous merge yet)
[S8] round=3 local utility u=1.000000 metrics={'f1_val': 0.7158284480098736, 'auprc': 0.7771099421428577, 'loss_val': 1.028844944191578, 'psi': 0.7403410456630672}-{'f1_val': 0.13995598239295717, 'auprc': 0.7688573491001708, 'loss_val': 1.1750599897293434, 'psi': 0.39151652907584267}
[S9] START round=3 head_norm_before_train=0.852921 cos_to_last_merge=0.9969 (last merge round=1)
[S9] round=3 local utility u=0.029274 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8657490506397492, 'loss_val': 1.2467821997905417, 'psi': 0.4311383945398973}-{'f1_val': 0.141397957139996, 'auprc': 0.8658195063456833, 'loss_val': 1.3055413308507071, 'psi': 0.43116657682227094}
[S10] START round=3 head_norm_before_train=0.901754 cos_to_last_merge=1.0000 (last merge round=2)
[S10] round=3 local utility u=0.045365 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.703217765721266, 'loss_val': 1.180921046915209, 'psi': 0.3644600888135408}-{'f1_val': 0.13862163754172394, 'auprc': 0.6867114764981916, 'loss_val': 1.2221329212979064, 'psi': 0.35785757312431105}
[S11] START round=3 head_norm_before_train=1.229579 (no previous merge yet)
[S11] round=3 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7873531035433522, 'loss_val': 1.2152054496924038, 'psi': 0.39918945144120727}-{'f1_val': 0.14041368337311058, 'auprc': 0.8475045701978564, 'loss_val': 1.273596561959518, 'psi': 0.42325003810300893}
[S13] START round=3 head_norm_before_train=0.772218 cos_to_last_merge=1.0000 (last merge round=2)
[S13] round=3 local utility u=0.028825 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5615432359939869, 'loss_val': 1.2571671148896177, 'psi': 0.30884875194382666}-{'f1_val': 0.1403857625770531, 'auprc': 0.5545014134691877, 'loss_val': 1.293691040633414, 'psi': 0.30603202293390697}
[S14] START round=3 head_norm_before_train=1.199206 (no previous merge yet)
[S14] round=3 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.5902021044290029, 'loss_val': 1.30046597445267, 'psi': 0.3202955535012234}-{'f1_val': 0.14035785288270378, 'auprc': 0.6615346532442835, 'loss_val': 1.3267388010373498, 'psi': 0.34882857302733566}
[S15] START round=3 head_norm_before_train=0.874026 cos_to_last_merge=0.9923 (last merge round=1)
[S15] round=3 local utility u=0.091546 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7949517086078528, 'loss_val': 1.2601646419791124, 'psi': 0.4018208742600761}-{'f1_val': 0.13973365136155833, 'auprc': 0.745432912340614, 'loss_val': 1.2946994816227222, 'psi': 0.38201335575318063}
[S16] START round=3 head_norm_before_train=0.906420 cos_to_last_merge=0.9969 (last merge round=1)
[S16] round=3 local utility u=0.002349 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.9766074034540819, 'loss_val': 1.2965225031934906, 'psi': 0.4750254315011547}-{'f1_val': 0.14063745019920318, 'auprc': 0.9863208833662225, 'loss_val': 1.3303606245190394, 'psi': 0.4789108234660109}
[S17] START round=3 head_norm_before_train=1.316830 (no previous merge yet)
[S17] round=3 local utility u=1.000000 metrics={'f1_val': 0.3918753935428255, 'auprc': 0.86210697861071, 'loss_val': 0.9649804390634805, 'psi': 0.5799680275699792}-{'f1_val': 0.14094896331738438, 'auprc': 0.6160983110286514, 'loss_val': 1.1387645113424965, 'psi': 0.3310087024018912}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:49316
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] → sending delta(kind=head bytes=1793) to S15@127.0.0.1:49315
[S16] not sending this round → trigger blocked (psi=0.475)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.740)
[S3] not sending this round → trigger blocked (psi=0.483)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.559)
[S5] not sending this round → trigger blocked (psi=0.393)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S10] → sending delta(kind=head bytes=1792) to S9@127.0.0.1:49310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S13] → sending delta(kind=head bytes=1793) to S10@127.0.0.1:49311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:49305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:49303
[S13] sending update (kind=head size=1793 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1792 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1793 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1803) from S9
[S16] cosine check vs S9: cos=0.4513
[S15] RECEIVED delta(kind=head bytes=1793) from S2
[S15] cosine check vs S2: cos=-0.1598
[S15] DROPPED delta from S2 (cos=-0.1598 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1793) from S13
[S10] cosine check vs S13: cos=0.0281
[S5] RECEIVED delta(kind=head bytes=1795) from S15
[S5] cosine check vs S15: cos=-0.0326
[S5] DROPPED delta from S15 (cos=-0.0326 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1792) from S10
[S9] cosine check vs S10: cos=-0.0734
[S9] DROPPED delta from S10 (cos=-0.0734 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1797) from S7
[S3] cosine check vs S7: cos=-0.0234
[S3] DROPPED delta from S7 (cos=-0.0234 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] → sending delta(kind=head bytes=1793) to S3@127.0.0.1:49303
[S17] sending update (kind=head size=1793 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1793) from S17
[S3] cosine check vs S17: cos=0.0624
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=3 metric=0.1398 head_norm=1.248128
[S3] _apply_head_vector_avg (torch): Δ‖w‖=9.026957e-01
[S3] stored merged vector for next round verification (round=3)
[S3] DEBUG after merge:  round=3 metric=0.1398 head_norm=0.960610 delta_norm=0.902696
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=3 metric=0.1386 head_norm=0.949038
[S10] _apply_head_vector_avg (torch): Δ‖w‖=6.127205e-01
[S10] stored merged vector for next round verification (round=3)
[S10] DEBUG after merge:  round=3 metric=0.1440 head_norm=0.629934 delta_norm=0.612721
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=3 metric=0.1406 head_norm=0.929031
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.755591e-01
[S16] stored merged vector for next round verification (round=3)
[S16] DEBUG after merge:  round=3 metric=0.1406 head_norm=0.772963 delta_norm=0.475559
[S16] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=0.962490 cos_to_last_merge=0.9796 (last merge round=1)
[S2] round=4 local utility u=0.488415 metrics={'f1_val': 0.41698068739424143, 'auprc': 0.7716753699404595, 'loss_val': 0.906995446881686, 'psi': 0.5588585604127286}-{'f1_val': 0.28607587416734226, 'auprc': 0.7727165767989298, 'loss_val': 1.1015199969513754, 'psi': 0.48073215521997725}
[S3] START round=4 head_norm_before_train=0.960610 cos_to_last_merge=1.0000 (last merge round=3)
[S3] round=4 local utility u=0.001599 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9982262981054328, 'loss_val': 1.257984093225289, 'psi': 0.4831945586106374}-{'f1_val': 0.13984006561410703, 'auprc': 0.9983630062390012, 'loss_val': 1.2615925798481924, 'psi': 0.4832492418640647}
[S4] START round=4 head_norm_before_train=0.982587 cos_to_last_merge=0.9924 (last merge round=2)
[S4] round=4 local utility u=0.683159 metrics={'f1_val': 0.6638493304751975, 'auprc': 0.6502485478549647, 'loss_val': 0.6834519159089784, 'psi': 0.6584090174271043}-{'f1_val': 0.41387245678921186, 'auprc': 0.7764175780803662, 'loss_val': 0.92841649069185, 'psi': 0.5588905053056736}
[S5] START round=4 head_norm_before_train=1.233418 (no previous merge yet)
[S5] round=4 local utility u=0.020639 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7700686531545481, 'loss_val': 1.1807768379241592, 'psi': 0.3933846041189621}-{'f1_val': 0.14226190476190476, 'auprc': 0.7699321095565259, 'loss_val': 1.221645426477336, 'psi': 0.3933299866797532}
[S6] START round=4 head_norm_before_train=0.933697 cos_to_last_merge=0.9938 (last merge round=2)
[S6] round=4 local utility u=1.000000 metrics={'f1_val': 0.4171358730402079, 'auprc': 0.7350425117571322, 'loss_val': 0.9186090237513708, 'psi': 0.5442985285269777}-{'f1_val': 0.14142628205128205, 'auprc': 0.6448579463627504, 'loss_val': 1.1485391534319123, 'psi': 0.3427989477758694}
[S7] START round=4 head_norm_before_train=0.884556 cos_to_last_merge=0.9901 (last merge round=1)
[S7] round=4 local utility u=0.040929 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7746930217302808, 'loss_val': 1.2591580733248087, 'psi': 0.3951113023295673}-{'f1_val': 0.14205682272909165, 'auprc': 0.7556503563373451, 'loss_val': 1.2838879688626588, 'psi': 0.38749423617239304}
[S8] START round=4 head_norm_before_train=1.321242 (no previous merge yet)
[S8] round=4 local utility u=0.104929 metrics={'f1_val': 0.7072544372662525, 'auprc': 0.776938277518594, 'loss_val': 0.7670273928445455, 'psi': 0.7351279733671892}-{'f1_val': 0.7158284480098736, 'auprc': 0.7771099421428577, 'loss_val': 1.028844944191578, 'psi': 0.7403410456630672}
[S9] START round=4 head_norm_before_train=0.885526 cos_to_last_merge=0.9882 (last merge round=1)
[S9] round=4 local utility u=0.027740 metrics={'f1_val': 0.141397957139996, 'auprc': 0.865508341576416, 'loss_val': 1.1905796791756549, 'psi': 0.431042110914564}-{'f1_val': 0.141397957139996, 'auprc': 0.8657490506397492, 'loss_val': 1.2467821997905417, 'psi': 0.4311383945398973}
[S10] START round=4 head_norm_before_train=0.629934 cos_to_last_merge=1.0000 (last merge round=3)
[S10] round=4 local utility u=1.000000 metrics={'f1_val': 0.41670936461107344, 'auprc': 0.8417879982785363, 'loss_val': 1.073891779252559, 'psi': 0.5867408180780587}-{'f1_val': 0.13862163754172394, 'auprc': 0.703217765721266, 'loss_val': 1.180921046915209, 'psi': 0.3644600888135408}
[S11] START round=4 head_norm_before_train=1.261516 (no previous merge yet)
[S11] round=4 local utility u=0.031750 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7826061868983817, 'loss_val': 1.137463982172351, 'psi': 0.39729068478321905}-{'f1_val': 0.14041368337311058, 'auprc': 0.7873531035433522, 'loss_val': 1.2152054496924038, 'psi': 0.39918945144120727}
[S13] START round=4 head_norm_before_train=0.802380 cos_to_last_merge=0.9913 (last merge round=2)
[S13] round=4 local utility u=0.905197 metrics={'f1_val': 0.4152892684755862, 'auprc': 0.5795379964042935, 'loss_val': 1.150178206781507, 'psi': 0.4809887596470691}-{'f1_val': 0.1403857625770531, 'auprc': 0.5615432359939869, 'loss_val': 1.2571671148896177, 'psi': 0.30884875194382666}
[S14] START round=4 head_norm_before_train=1.223798 (no previous merge yet)
[S14] round=4 local utility u=0.155515 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.6864395741084327, 'loss_val': 1.2781476073886189, 'psi': 0.3587905413729953}-{'f1_val': 0.14035785288270378, 'auprc': 0.5902021044290029, 'loss_val': 1.30046597445267, 'psi': 0.3202955535012234}
[S15] START round=4 head_norm_before_train=0.933200 cos_to_last_merge=0.9747 (last merge round=1)
[S15] round=4 local utility u=0.659277 metrics={'f1_val': 0.4161838404121786, 'auprc': 0.6529527721994404, 'loss_val': 1.1743159240575252, 'psi': 0.5108914131270833}-{'f1_val': 0.13973365136155833, 'auprc': 0.7949517086078528, 'loss_val': 1.2601646419791124, 'psi': 0.4018208742600761}
[S16] START round=4 head_norm_before_train=0.772963 cos_to_last_merge=1.0000 (last merge round=3)
[S16] round=4 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8495465464296786, 'loss_val': 1.2643568007221153, 'psi': 0.4242010886913934}-{'f1_val': 0.14063745019920318, 'auprc': 0.9766074034540819, 'loss_val': 1.2965225031934906, 'psi': 0.4750254315011547}
[S17] START round=4 head_norm_before_train=1.384716 (no previous merge yet)
[S17] round=4 local utility u=0.025748 metrics={'f1_val': 0.3559814469781532, 'auprc': 0.9101372108703478, 'loss_val': 0.8422114801890167, 'psi': 0.5776437525350311}-{'f1_val': 0.3918753935428255, 'auprc': 0.86210697861071, 'loss_val': 0.9649804390634805, 'psi': 0.5799680275699792}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S13] → sending delta(kind=head bytes=1791) to S10@127.0.0.1:49311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:49316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:49309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:49316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:49309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S2] → sending delta(kind=head bytes=1790) to S15@127.0.0.1:49315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:49303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:49310
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:49310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:49305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:49312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S15@127.0.0.1:49315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:49302
[S8] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1790 to 1 peers)
[S14] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1794 to 1 peers)
[S6] sending update (kind=head size=1794 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1791 to 1 peers)
[S7] sending update (kind=head size=1794 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1800) from S15
[S5] cosine check vs S15: cos=-0.0403
[S5] DROPPED delta from S15 (cos=-0.0403 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1801) from S4
[S11] cosine check vs S4: cos=-0.0158
[S11] DROPPED delta from S4 (cos=-0.0158 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1798) from S3
[S2] cosine check vs S3: cos=0.0244
[S3] RECEIVED delta(kind=head bytes=1794) from S7
[S3] cosine check vs S7: cos=-0.0076
[S3] DROPPED delta from S7 (cos=-0.0076 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1795) from S14
[S8] cosine check vs S14: cos=-0.0265
[S8] DROPPED delta from S14 (cos=-0.0265 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1794) from S11
[S15] cosine check vs S11: cos=0.1077
[S15] RECEIVED delta(kind=head bytes=1790) from S2
[S15] cosine check vs S2: cos=-0.1665
[S15] DROPPED delta from S2 (cos=-0.1665 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1795) from S9
[S16] cosine check vs S9: cos=0.8210
[S16] RECEIVED delta(kind=head bytes=1797) from S5
[S16] cosine check vs S5: cos=-0.0377
[S16] DROPPED delta from S5 (cos=-0.0377 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1794) from S6
[S8] cosine check vs S6: cos=0.0213
[S9] RECEIVED delta(kind=head bytes=1802) from S8
[S9] cosine check vs S8: cos=-0.0208
[S9] DROPPED delta from S8 (cos=-0.0208 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1791) from S13
[S10] cosine check vs S13: cos=0.5858
[S9] RECEIVED delta(kind=head bytes=1799) from S10
[S9] cosine check vs S10: cos=-0.0960
[S9] DROPPED delta from S10 (cos=-0.0960 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:49303
[S17] sending update (kind=head size=1800 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1800) from S17
[S3] cosine check vs S17: cos=0.7347
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=4 metric=0.4170 head_norm=1.035553
[S2] _apply_head_vector_avg (torch): Δ‖w‖=7.072700e-01
[S2] stored merged vector for next round verification (round=4)
[S2] DEBUG after merge:  round=4 metric=0.4172 head_norm=0.724754 delta_norm=0.707270
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=4 metric=0.4167 head_norm=0.691464
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.597135e-01
[S10] stored merged vector for next round verification (round=4)
[S10] DEBUG after merge:  round=4 metric=0.4319 head_norm=0.690095 delta_norm=0.359713
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=4 metric=0.1398 head_norm=0.989257
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.959092e-01
[S3] stored merged vector for next round verification (round=4)
[S3] DEBUG after merge:  round=4 metric=0.4227 head_norm=1.142311 delta_norm=0.495909
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=4 metric=0.7073 head_norm=1.384069
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.454928e-01
[S8] stored merged vector for next round verification (round=4)
[S8] DEBUG after merge:  round=4 metric=0.7147 head_norm=0.862784 delta_norm=0.845493
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=4 metric=0.4162 head_norm=0.968153
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.669783e-01
[S15] stored merged vector for next round verification (round=4)
[S15] DEBUG after merge:  round=4 metric=0.1397 head_norm=0.850684 delta_norm=0.766978
[S15] aggregate: ROLLBACK (f1_val pre=0.416 post=0.140 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=4 metric=0.1406 head_norm=0.804662
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.650004e-01
[S16] stored merged vector for next round verification (round=4)
[S16] DEBUG after merge:  round=4 metric=0.1406 head_norm=0.825395 delta_norm=0.265000
[S16] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=5 head_norm_before_train=0.724754 cos_to_last_merge=1.0000 (last merge round=4)
[S2] round=5 local utility u=0.744672 metrics={'f1_val': 0.6673724793741529, 'auprc': 0.7393977701817301, 'loss_val': 0.8231686907259098, 'psi': 0.6961825956971838}-{'f1_val': 0.41698068739424143, 'auprc': 0.7716753699404595, 'loss_val': 0.906995446881686, 'psi': 0.5588585604127286}
[S3] START round=5 head_norm_before_train=1.142311 cos_to_last_merge=1.0000 (last merge round=4)
[S3] round=5 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8521407933703555, 'loss_val': 1.217805731216907, 'psi': 0.4247603567166065}-{'f1_val': 0.13984006561410703, 'auprc': 0.9982262981054328, 'loss_val': 1.257984093225289, 'psi': 0.4831945586106374}
[S4] START round=5 head_norm_before_train=1.084663 cos_to_last_merge=0.9739 (last merge round=2)
[S4] round=5 local utility u=0.182224 metrics={'f1_val': 0.6540007090089558, 'auprc': 0.7323290324966769, 'loss_val': 0.5061537761926642, 'psi': 0.6853320384040442}-{'f1_val': 0.6638493304751975, 'auprc': 0.6502485478549647, 'loss_val': 0.6834519159089784, 'psi': 0.6584090174271043}
[S5] START round=5 head_norm_before_train=1.255579 (no previous merge yet)
[S5] round=5 local utility u=0.043668 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7774961796019313, 'loss_val': 1.115722764390081, 'psi': 0.3963556146979154}-{'f1_val': 0.14226190476190476, 'auprc': 0.7700686531545481, 'loss_val': 1.1807768379241592, 'psi': 0.3933846041189621}
[S6] START round=5 head_norm_before_train=1.001429 cos_to_last_merge=0.9763 (last merge round=2)
[S6] round=5 local utility u=0.587022 metrics={'f1_val': 0.5187016038916464, 'auprc': 0.8496909249340167, 'loss_val': 0.6979053076241903, 'psi': 0.6510973323085946}-{'f1_val': 0.4171358730402079, 'auprc': 0.7350425117571322, 'loss_val': 0.9186090237513708, 'psi': 0.5442985285269777}
[S7] START round=5 head_norm_before_train=0.918890 cos_to_last_merge=0.9803 (last merge round=1)
[S7] round=5 local utility u=0.010911 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7774387297675326, 'loss_val': 1.2455724638124206, 'psi': 0.39620958554446806}-{'f1_val': 0.14205682272909165, 'auprc': 0.7746930217302808, 'loss_val': 1.2591580733248087, 'psi': 0.3951113023295673}
[S8] START round=5 head_norm_before_train=0.862784 cos_to_last_merge=1.0000 (last merge round=4)
[S8] round=5 local utility u=0.000000 metrics={'f1_val': 0.3729988868650071, 'auprc': 0.9953575985838036, 'loss_val': 0.7287758776530122, 'psi': 0.6219423715525257}-{'f1_val': 0.7072544372662525, 'auprc': 0.776938277518594, 'loss_val': 0.7670273928445455, 'psi': 0.7351279733671892}
[S9] START round=5 head_norm_before_train=0.924945 cos_to_last_merge=0.9761 (last merge round=1)
[S9] round=5 local utility u=0.038222 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8652291276031698, 'loss_val': 1.1132989007997114, 'psi': 0.43093042532526554}-{'f1_val': 0.141397957139996, 'auprc': 0.865508341576416, 'loss_val': 1.1905796791756549, 'psi': 0.431042110914564}
[S10] START round=5 head_norm_before_train=0.690095 cos_to_last_merge=1.0000 (last merge round=4)
[S10] round=5 local utility u=0.108056 metrics={'f1_val': 0.40917843917454355, 'auprc': 0.8644589423283521, 'loss_val': 0.8806073039101644, 'psi': 0.5912906404360669}-{'f1_val': 0.41670936461107344, 'auprc': 0.8417879982785363, 'loss_val': 1.073891779252559, 'psi': 0.5867408180780587}
[S11] START round=5 head_norm_before_train=1.298660 (no previous merge yet)
[S11] round=5 local utility u=1.000000 metrics={'f1_val': 0.4229120744550575, 'auprc': 0.9744679139017526, 'loss_val': 0.9956959372529087, 'psi': 0.6435344102337355}-{'f1_val': 0.14041368337311058, 'auprc': 0.7826061868983817, 'loss_val': 1.137463982172351, 'psi': 0.39729068478321905}
[S13] START round=5 head_norm_before_train=0.856229 cos_to_last_merge=0.9689 (last merge round=2)
[S13] round=5 local utility u=0.096632 metrics={'f1_val': 0.4160038662657951, 'auprc': 0.5893680345358935, 'loss_val': 0.9906926043438594, 'psi': 0.4853495335738345}-{'f1_val': 0.4152892684755862, 'auprc': 0.5795379964042935, 'loss_val': 1.150178206781507, 'psi': 0.4809887596470691}
[S14] START round=5 head_norm_before_train=1.249941 (no previous merge yet)
[S14] round=5 local utility u=0.122023 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7575550884304172, 'loss_val': 1.2474485596883318, 'psi': 0.3872367471017891}-{'f1_val': 0.14035785288270378, 'auprc': 0.6864395741084327, 'loss_val': 1.2781476073886189, 'psi': 0.3587905413729953}
[S15] START round=5 head_norm_before_train=0.850684 cos_to_last_merge=1.0000 (last merge round=4)
[S15] round=5 local utility u=0.018044 metrics={'f1_val': 0.3267473977859128, 'auprc': 0.7998319019058269, 'loss_val': 1.0422475168902015, 'psi': 0.5159811994338784}-{'f1_val': 0.4161838404121786, 'auprc': 0.6529527721994404, 'loss_val': 1.1743159240575252, 'psi': 0.5108914131270833}
[S16] START round=5 head_norm_before_train=0.825395 cos_to_last_merge=1.0000 (last merge round=4)
[S16] round=5 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8296068467747003, 'loss_val': 1.2316595112372277, 'psi': 0.41622520882940206}-{'f1_val': 0.14063745019920318, 'auprc': 0.8495465464296786, 'loss_val': 1.2643568007221153, 'psi': 0.4242010886913934}
[S17] START round=5 head_norm_before_train=1.457041 (no previous merge yet)
[S17] round=5 local utility u=0.000000 metrics={'f1_val': 0.35450650733504196, 'auprc': 0.8346452194380976, 'loss_val': 0.838814489267644, 'psi': 0.5465619921762642}-{'f1_val': 0.3559814469781532, 'auprc': 0.9101372108703478, 'loss_val': 0.8422114801890167, 'psi': 0.5776437525350311}
[S4] not sending this round → trigger blocked (psi=0.685)
[S9] not sending this round → trigger blocked (psi=0.431)
[S15] not sending this round → trigger blocked (psi=0.516)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.696)
[S14] not sending this round → trigger blocked (psi=0.387)
[S11] not sending this round → trigger blocked (psi=0.644)
[S5] not sending this round → trigger blocked (psi=0.396)
[S6] not sending this round → trigger blocked (psi=0.651)
[S7] not sending this round → trigger blocked (psi=0.396)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.591)
[S13] not sending this round → trigger blocked (psi=0.485)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] ⇄ pheromone p=0.592 → S11@127.0.0.1:49312
[S9] ⇄ pheromone p=0.349 → S16@127.0.0.1:49316
[S14] ⇄ pheromone p=0.397 → S8@127.0.0.1:49309
[S2] ⇄ pheromone p=0.622 → S15@127.0.0.1:49315
[S13] ⇄ pheromone p=0.577 → S10@127.0.0.1:49311
[S6] ⇄ pheromone p=0.630 → S8@127.0.0.1:49309
[S11] ⇄ pheromone p=0.565 → S15@127.0.0.1:49315
[S7] ⇄ pheromone p=0.402 → S3@127.0.0.1:49303
[S8] ⇄ pheromone p=0.484 → S9@127.0.0.1:49310
[S5] ⇄ pheromone p=0.345 → S16@127.0.0.1:49316
[S3] ⇄ pheromone p=0.409 → S2@127.0.0.1:49302
[S16] ⇄ pheromone p=0.373 → S14@127.0.0.1:49314
[S10] ⇄ pheromone p=0.515 → S9@127.0.0.1:49310
[S15] ⇄ pheromone p=0.530 → S5@127.0.0.1:49305
[S17] ⇄ pheromone p=0.461 → S3@127.0.0.1:49303
[S2] START round=6 head_norm_before_train=0.806141 cos_to_last_merge=0.9853 (last merge round=4)
[S2] round=6 local utility u=0.252590 metrics={'f1_val': 0.7016527077743507, 'auprc': 0.7689218107221187, 'loss_val': 0.6122429917267076, 'psi': 0.728560348953458}-{'f1_val': 0.6673724793741529, 'auprc': 0.7393977701817301, 'loss_val': 0.8231686907259098, 'psi': 0.6961825956971838}
[S3] START round=6 head_norm_before_train=1.163112 cos_to_last_merge=0.9974 (last merge round=4)
[S3] round=6 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.7961412675144882, 'loss_val': 1.0966384476626967, 'psi': 0.40236054637425955}-{'f1_val': 0.13984006561410703, 'auprc': 0.8521407933703555, 'loss_val': 1.217805731216907, 'psi': 0.4247603567166065}
[S4] START round=6 head_norm_before_train=1.195860 cos_to_last_merge=0.9531 (last merge round=2)
[S4] round=6 local utility u=0.000000 metrics={'f1_val': 0.6621315254406884, 'auprc': 0.6583398481397043, 'loss_val': 0.4393715086511394, 'psi': 0.6606148545202948}-{'f1_val': 0.6540007090089558, 'auprc': 0.7323290324966769, 'loss_val': 0.5061537761926642, 'psi': 0.6853320384040442}
[S5] START round=6 head_norm_before_train=1.277419 (no previous merge yet)
[S5] round=6 local utility u=0.875900 metrics={'f1_val': 0.41734838192522206, 'auprc': 0.7778222845541113, 'loss_val': 1.0154194711309623, 'psi': 0.5615379429767777}-{'f1_val': 0.14226190476190476, 'auprc': 0.7774961796019313, 'loss_val': 1.115722764390081, 'psi': 0.3963556146979154}
[S6] START round=6 head_norm_before_train=1.071993 cos_to_last_merge=0.9515 (last merge round=2)
[S6] round=6 local utility u=0.000000 metrics={'f1_val': 0.4158432846376109, 'auprc': 0.7789135491369851, 'loss_val': 0.6844891616103517, 'psi': 0.5610713904373605}-{'f1_val': 0.5187016038916464, 'auprc': 0.8496909249340167, 'loss_val': 0.6979053076241903, 'psi': 0.6510973323085946}
[S7] START round=6 head_norm_before_train=0.943781 cos_to_last_merge=0.9727 (last merge round=1)
[S7] round=6 local utility u=0.027435 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7774014396064582, 'loss_val': 1.1905909626507865, 'psi': 0.3961946694800383}-{'f1_val': 0.14205682272909165, 'auprc': 0.7774387297675326, 'loss_val': 1.2455724638124206, 'psi': 0.39620958554446806}
[S8] START round=6 head_norm_before_train=0.941549 cos_to_last_merge=0.9864 (last merge round=4)
[S8] round=6 local utility u=1.000000 metrics={'f1_val': 0.7081051934436057, 'auprc': 0.9954871258959153, 'loss_val': 0.44657693045020247, 'psi': 0.8230579664245294}-{'f1_val': 0.3729988868650071, 'auprc': 0.9953575985838036, 'loss_val': 0.7287758776530122, 'psi': 0.6219423715525257}
[S9] START round=6 head_norm_before_train=0.957540 cos_to_last_merge=0.9657 (last merge round=1)
[S9] round=6 local utility u=0.067094 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8644878638391476, 'loss_val': 0.9768863953786193, 'psi': 0.43063391981965665}-{'f1_val': 0.141397957139996, 'auprc': 0.8652291276031698, 'loss_val': 1.1132989007997114, 'psi': 0.43093042532526554}
[S10] START round=6 head_norm_before_train=0.755769 cos_to_last_merge=0.9758 (last merge round=4)
[S10] round=6 local utility u=1.000000 metrics={'f1_val': 0.7002023808723996, 'auprc': 0.9864284653195151, 'loss_val': 0.6061639267169202, 'psi': 0.8146928146512458}-{'f1_val': 0.40917843917454355, 'auprc': 0.8644589423283521, 'loss_val': 0.8806073039101644, 'psi': 0.5912906404360669}
[S11] START round=6 head_norm_before_train=1.330954 (no previous merge yet)
[S11] round=6 local utility u=0.052461 metrics={'f1_val': 0.3964515026091945, 'auprc': 0.9987421579160907, 'loss_val': 0.8048332050616404, 'psi': 0.637367764731953}-{'f1_val': 0.4229120744550575, 'auprc': 0.9744679139017526, 'loss_val': 0.9956959372529087, 'psi': 0.6435344102337355}
[S13] START round=6 head_norm_before_train=0.905314 cos_to_last_merge=0.9490 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.949
[S13] round=6 local utility u=0.000000 metrics={'f1_val': 0.37148979094291945, 'auprc': 0.5112441884016489, 'loss_val': 0.9353743230393463, 'psi': 0.4273915499264112}-{'f1_val': 0.4160038662657951, 'auprc': 0.5893680345358935, 'loss_val': 0.9906926043438594, 'psi': 0.4853495335738345}
[S14] START round=6 head_norm_before_train=1.275721 (no previous merge yet)
[S14] round=6 local utility u=0.120406 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8165731788748815, 'loss_val': 1.183690989691179, 'psi': 0.41084398327957483}-{'f1_val': 0.14035785288270378, 'auprc': 0.7575550884304172, 'loss_val': 1.2474485596883318, 'psi': 0.3872367471017891}
[S15] START round=6 head_norm_before_train=0.905398 cos_to_last_merge=0.9909 (last merge round=4)
[S15] round=6 local utility u=0.307248 metrics={'f1_val': 0.38692121756168085, 'auprc': 0.7980986616862512, 'loss_val': 0.7835944077881206, 'psi': 0.551392195211509}-{'f1_val': 0.3267473977859128, 'auprc': 0.7998319019058269, 'loss_val': 1.0422475168902015, 'psi': 0.5159811994338784}
[S16] START round=6 head_norm_before_train=0.853550 cos_to_last_merge=0.9969 (last merge round=4)
[S16] round=6 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.6744113309114788, 'loss_val': 1.1520742960699821, 'psi': 0.35414700248411346}-{'f1_val': 0.14063745019920318, 'auprc': 0.8296068467747003, 'loss_val': 1.2316595112372277, 'psi': 0.41622520882940206}
[S17] START round=6 head_norm_before_train=1.517221 (no previous merge yet)
[S17] round=6 local utility u=0.000000 metrics={'f1_val': 0.35340325427492914, 'auprc': 0.7504906268451257, 'loss_val': 0.873052940919427, 'psi': 0.5122382033030077}-{'f1_val': 0.35450650733504196, 'auprc': 0.8346452194380976, 'loss_val': 0.838814489267644, 'psi': 0.5465619921762642}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:49316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:49310
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:49310
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:49309
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:49315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:49316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] → sending delta(kind=head bytes=1793) to S15@127.0.0.1:49315
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:49303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:49305
[S7] sending update (kind=head size=1795 to 1 peers)
[S2] sending update (kind=head size=1793 to 1 peers)
[S5] sending update (kind=head size=1793 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1794 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1798) from S9
[S16] cosine check vs S9: cos=0.9150
[S3] RECEIVED delta(kind=head bytes=1795) from S7
[S3] cosine check vs S7: cos=-0.0050
[S3] DROPPED delta from S7 (cos=-0.0050 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1794) from S15
[S5] cosine check vs S15: cos=-0.0600
[S5] DROPPED delta from S15 (cos=-0.0600 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1799) from S11
[S15] cosine check vs S11: cos=0.7224
[S8] RECEIVED delta(kind=head bytes=1799) from S14
[S8] cosine check vs S14: cos=-0.0140
[S8] DROPPED delta from S14 (cos=-0.0140 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1797) from S10
[S9] cosine check vs S10: cos=-0.0994
[S9] DROPPED delta from S10 (cos=-0.0994 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1793) from S2
[S15] cosine check vs S2: cos=-0.2279
[S15] DROPPED delta from S2 (cos=-0.2279 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1793) from S5
[S16] cosine check vs S5: cos=-0.0062
[S16] DROPPED delta from S5 (cos=-0.0062 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1796) from S8
[S9] cosine check vs S8: cos=-0.0590
[S9] DROPPED delta from S8 (cos=-0.0590 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=6 metric=0.3869 head_norm=0.986672
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.743723e-01
[S15] stored merged vector for next round verification (round=6)
[S15] DEBUG after merge:  round=6 metric=0.1703 head_norm=1.096761 delta_norm=0.474372
[S15] aggregate: ROLLBACK (f1_val pre=0.387 post=0.170 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=6 metric=0.1406 head_norm=0.883832
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.013376e-01
[S16] stored merged vector for next round verification (round=6)
[S16] DEBUG after merge:  round=6 metric=0.1406 head_norm=0.919774 delta_norm=0.201338
[S16] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=7 head_norm_before_train=0.913464 cos_to_last_merge=0.9551 (last merge round=4)
[S2] round=7 local utility u=0.000000 metrics={'f1_val': 0.6824538834850126, 'auprc': 0.661381287177743, 'loss_val': 0.5331954388132485, 'psi': 0.6740248449621047}-{'f1_val': 0.7016527077743507, 'auprc': 0.7689218107221187, 'loss_val': 0.6122429917267076, 'psi': 0.728560348953458}
[S3] START round=7 head_norm_before_train=1.193561 cos_to_last_merge=0.9902 (last merge round=4)
[S3] round=7 local utility u=0.553215 metrics={'f1_val': 0.39371257005519, 'auprc': 0.6065142461655225, 'loss_val': 0.9445634093785298, 'psi': 0.478833240499323}-{'f1_val': 0.13984006561410703, 'auprc': 0.7961412675144882, 'loss_val': 1.0966384476626967, 'psi': 0.40236054637425955}
[S4] START round=7 head_norm_before_train=1.290843 cos_to_last_merge=0.9364 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.936
[S4] round=7 local utility u=1.000000 metrics={'f1_val': 0.9553127515893175, 'auprc': 0.9498127020881788, 'loss_val': 0.4711613786412491, 'psi': 0.953112731788862}-{'f1_val': 0.6621315254406884, 'auprc': 0.6583398481397043, 'loss_val': 0.4393715086511394, 'psi': 0.6606148545202948}
[S5] START round=7 head_norm_before_train=1.301129 (no previous merge yet)
[S5] round=7 local utility u=0.067261 metrics={'f1_val': 0.4183961199382637, 'auprc': 0.7778216407087825, 'loss_val': 0.8871818395057518, 'psi': 0.5621663282464713}-{'f1_val': 0.41734838192522206, 'auprc': 0.7778222845541113, 'loss_val': 1.0154194711309623, 'psi': 0.5615379429767777}
[S6] START round=7 head_norm_before_train=1.146808 cos_to_last_merge=0.9260 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.926
[S6] round=7 local utility u=1.000000 metrics={'f1_val': 0.7080483784886923, 'auprc': 0.9671865864724104, 'loss_val': 0.41301204627041876, 'psi': 0.8117036616821796}-{'f1_val': 0.4158432846376109, 'auprc': 0.7789135491369851, 'loss_val': 0.6844891616103517, 'psi': 0.5610713904373605}
[S7] START round=7 head_norm_before_train=0.958222 cos_to_last_merge=0.9678 (last merge round=1)
[S7] round=7 local utility u=0.553907 metrics={'f1_val': 0.4172807768329403, 'auprc': 0.5754474480834152, 'loss_val': 1.128258974956111, 'psi': 0.4805474453331302}-{'f1_val': 0.14205682272909165, 'auprc': 0.7774014396064582, 'loss_val': 1.1905909626507865, 'psi': 0.3961946694800383}
[S8] START round=7 head_norm_before_train=1.047376 cos_to_last_merge=0.9592 (last merge round=4)
[S8] round=7 local utility u=0.064149 metrics={'f1_val': 0.7059717428737855, 'auprc': 0.9953086340203441, 'loss_val': 0.3049427295098294, 'psi': 0.821706499332409}-{'f1_val': 0.7081051934436057, 'auprc': 0.9954871258959153, 'loss_val': 0.44657693045020247, 'psi': 0.8230579664245294}
[S9] START round=7 head_norm_before_train=0.995934 cos_to_last_merge=0.9541 (last merge round=1)
[S9] round=7 local utility u=0.963371 metrics={'f1_val': 0.43674874228585137, 'auprc': 0.8612619929699211, 'loss_val': 0.8125714738783841, 'psi': 0.6065540425594793}-{'f1_val': 0.141397957139996, 'auprc': 0.8644878638391476, 'loss_val': 0.9768863953786193, 'psi': 0.43063391981965665}
[S10] START round=7 head_norm_before_train=0.855469 cos_to_last_merge=0.9299 (last merge round=4)
[S10] ⚠️ Model drifted since last merge! cos=0.930
[S10] round=7 local utility u=0.083157 metrics={'f1_val': 0.6883210723388503, 'auprc': 0.993642896962952, 'loss_val': 0.39020559196241966, 'psi': 0.8104498021884909}-{'f1_val': 0.7002023808723996, 'auprc': 0.9864284653195151, 'loss_val': 0.6061639267169202, 'psi': 0.8146928146512458}
[S11] START round=7 head_norm_before_train=1.371972 (no previous merge yet)
[S11] round=7 local utility u=0.466586 metrics={'f1_val': 0.5241666138446328, 'auprc': 0.9987096276557521, 'loss_val': 0.6378543336420069, 'psi': 0.7139838193690806}-{'f1_val': 0.3964515026091945, 'auprc': 0.9987421579160907, 'loss_val': 0.8048332050616404, 'psi': 0.637367764731953}
[S13] START round=7 head_norm_before_train=0.972107 cos_to_last_merge=0.9213 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.921
[S13] round=7 local utility u=1.000000 metrics={'f1_val': 0.705503752292822, 'auprc': 0.6796137840005059, 'loss_val': 0.7045276029733303, 'psi': 0.6951477649758956}-{'f1_val': 0.37148979094291945, 'auprc': 0.5112441884016489, 'loss_val': 0.9353743230393463, 'psi': 0.4273915499264112}
[S14] START round=7 head_norm_before_train=1.298635 (no previous merge yet)
[S14] round=7 local utility u=0.428768 metrics={'f1_val': 0.25957741575595694, 'auprc': 0.8351917566398953, 'loss_val': 1.0973274504437076, 'psi': 0.4898231521095323}-{'f1_val': 0.14035785288270378, 'auprc': 0.8165731788748815, 'loss_val': 1.183690989691179, 'psi': 0.41084398327957483}
[S15] START round=7 head_norm_before_train=1.096761 cos_to_last_merge=1.0000 (last merge round=6)
[S15] round=7 local utility u=0.358085 metrics={'f1_val': 0.47983649261871864, 'auprc': 0.800085018059792, 'loss_val': 0.6308743839597084, 'psi': 0.6079359027951481}-{'f1_val': 0.38692121756168085, 'auprc': 0.7980986616862512, 'loss_val': 0.7835944077881206, 'psi': 0.551392195211509}
[S16] START round=7 head_norm_before_train=0.919774 cos_to_last_merge=1.0000 (last merge round=6)
[S16] round=7 local utility u=0.646305 metrics={'f1_val': 0.4175015313869336, 'auprc': 0.519651177561926, 'loss_val': 1.056367791273615, 'psi': 0.45836138985693053}-{'f1_val': 0.14063745019920318, 'auprc': 0.6744113309114788, 'loss_val': 1.1520742960699821, 'psi': 0.35414700248411346}
[S17] START round=7 head_norm_before_train=1.562620 (no previous merge yet)
[S17] round=7 local utility u=0.089912 metrics={'f1_val': 0.3688422382757552, 'auprc': 0.7858350424563083, 'loss_val': 0.8918953074681447, 'psi': 0.5356393599479764}-{'f1_val': 0.35340325427492914, 'auprc': 0.7504906268451257, 'loss_val': 0.873052940919427, 'psi': 0.5122382033030077}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:49309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:49316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:49316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:49314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:49310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:49315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S10] → sending delta(kind=head bytes=1786) to S9@127.0.0.1:49310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:49305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:49311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:49302
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:49309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:49312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:49303
[S4] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1786 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S16] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1793 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1800) from S8
[S9] cosine check vs S8: cos=-0.0658
[S9] DROPPED delta from S8 (cos=-0.0658 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1798) from S7
[S3] cosine check vs S7: cos=-0.0096
[S3] DROPPED delta from S7 (cos=-0.0096 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1802) from S4
[S11] cosine check vs S4: cos=0.0018
[S15] RECEIVED delta(kind=head bytes=1799) from S11
[S15] cosine check vs S11: cos=0.9106
[S16] RECEIVED delta(kind=head bytes=1801) from S5
[S16] cosine check vs S5: cos=0.0159
[S16] RECEIVED delta(kind=head bytes=1793) from S9
[S16] cosine check vs S9: cos=0.9621
[S14] RECEIVED delta(kind=head bytes=1802) from S16
[S14] cosine check vs S16: cos=-0.0921
[S14] DROPPED delta from S16 (cos=-0.0921 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1799) from S15
[S5] cosine check vs S15: cos=-0.0485
[S5] DROPPED delta from S15 (cos=-0.0485 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1800) from S3
[S2] cosine check vs S3: cos=0.4909
[S8] RECEIVED delta(kind=head bytes=1803) from S14
[S8] cosine check vs S14: cos=-0.0161
[S8] DROPPED delta from S14 (cos=-0.0161 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1802) from S6
[S8] cosine check vs S6: cos=0.4246
[S9] RECEIVED delta(kind=head bytes=1786) from S10
[S9] cosine check vs S10: cos=-0.1029
[S9] DROPPED delta from S10 (cos=-0.1029 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1799) from S13
[S10] cosine check vs S13: cos=0.6759
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:49303
[S17] sending update (kind=head size=1798 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1798) from S17
[S3] cosine check vs S17: cos=0.8909
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=7 metric=0.6825 head_norm=1.018012
[S2] _apply_head_vector_avg (torch): Δ‖w‖=5.735831e-01
[S2] stored merged vector for next round verification (round=7)
[S2] DEBUG after merge:  round=7 metric=0.6507 head_norm=0.970702 delta_norm=0.573583
[S2] aggregate: ROLLBACK (f1_val pre=0.682 post=0.651 tol_abs=0.005 tol_rel=0.0)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=7 metric=0.3937 head_norm=1.227261
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.748187e-01
[S3] stored merged vector for next round verification (round=7)
[S3] DEBUG after merge:  round=7 metric=0.3969 head_norm=1.372670 delta_norm=0.374819
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=7 metric=0.4798 head_norm=1.165595
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.003385e-01
[S15] stored merged vector for next round verification (round=7)
[S15] DEBUG after merge:  round=7 metric=0.4801 head_norm=1.263949 delta_norm=0.300339
[S15] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=7 metric=0.5242 head_norm=1.420186
[S11] _apply_head_vector_avg (torch): Δ‖w‖=9.822236e-01
[S11] stored merged vector for next round verification (round=7)
[S11] DEBUG after merge:  round=7 metric=0.5190 head_norm=0.983972 delta_norm=0.982224
[S11] aggregate: ROLLBACK (f1_val pre=0.524 post=0.519 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=7 metric=0.4175 head_norm=0.942528
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.063774e-01
[S16] stored merged vector for next round verification (round=7)
[S16] DEBUG after merge:  round=7 metric=0.4175 head_norm=0.805760 delta_norm=0.406377
[S16] aggregate: ACCEPT kept=['S5', 'S9'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=7 metric=0.7060 head_norm=1.141691
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.352570e-01
[S8] stored merged vector for next round verification (round=7)
[S8] DEBUG after merge:  round=7 metric=0.7009 head_norm=0.998278 delta_norm=0.635257
[S8] aggregate: ROLLBACK (f1_val pre=0.706 post=0.701 tol_abs=0.005 tol_rel=0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=7 metric=0.6883 head_norm=0.963567
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.056469e-01
[S10] stored merged vector for next round verification (round=7)
[S10] DEBUG after merge:  round=7 metric=0.6883 head_norm=0.918806 delta_norm=0.405647
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=0.970702 cos_to_last_merge=1.0000 (last merge round=7)
[S2] round=8 local utility u=0.137315 metrics={'f1_val': 0.7013039891732853, 'auprc': 0.6873628029769958, 'loss_val': 0.44961078633579304, 'psi': 0.6957275146947695}-{'f1_val': 0.6824538834850126, 'auprc': 0.661381287177743, 'loss_val': 0.5331954388132485, 'psi': 0.6740248449621047}
[S3] START round=8 head_norm_before_train=1.372670 cos_to_last_merge=1.0000 (last merge round=7)
[S3] round=8 local utility u=0.385195 metrics={'f1_val': 0.39417063440998584, 'auprc': 0.8131239143003759, 'loss_val': 0.796751750225901, 'psi': 0.5617519463661419}-{'f1_val': 0.39371257005519, 'auprc': 0.6065142461655225, 'loss_val': 0.9445634093785298, 'psi': 0.478833240499323}
[S4] START round=8 head_norm_before_train=1.359779 cos_to_last_merge=0.9258 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.926
[S4] round=8 local utility u=0.000000 metrics={'f1_val': 0.6656797203038407, 'auprc': 0.9363275502502431, 'loss_val': 0.454472265022066, 'psi': 0.7739388522824017}-{'f1_val': 0.9553127515893175, 'auprc': 0.9498127020881788, 'loss_val': 0.4711613786412491, 'psi': 0.953112731788862}
[S5] START round=8 head_norm_before_train=1.328114 (no previous merge yet)
[S5] round=8 local utility u=0.973829 metrics={'f1_val': 0.7152507227248595, 'auprc': 0.7946838038711012, 'loss_val': 0.7712376099101445, 'psi': 0.7470239551833562}-{'f1_val': 0.4183961199382637, 'auprc': 0.7778216407087825, 'loss_val': 0.8871818395057518, 'psi': 0.5621663282464713}
[S6] START round=8 head_norm_before_train=1.223423 cos_to_last_merge=0.9057 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.906
[S6] round=8 local utility u=0.000000 metrics={'f1_val': 0.6955046763147156, 'auprc': 0.9430684531392917, 'loss_val': 0.3877678276346669, 'psi': 0.794530187044546}-{'f1_val': 0.7080483784886923, 'auprc': 0.9671865864724104, 'loss_val': 0.41301204627041876, 'psi': 0.8117036616821796}
[S7] START round=8 head_norm_before_train=0.970300 cos_to_last_merge=0.9622 (last merge round=1)
[S7] round=8 local utility u=0.054948 metrics={'f1_val': 0.4168747328879592, 'auprc': 0.5754479248880118, 'loss_val': 1.0159285995522478, 'psi': 0.4803040096879802}-{'f1_val': 0.4172807768329403, 'auprc': 0.5754474480834152, 'loss_val': 1.128258974956111, 'psi': 0.4805474453331302}
[S8] START round=8 head_norm_before_train=0.998278 cos_to_last_merge=1.0000 (last merge round=7)
[S8] round=8 local utility u=0.848644 metrics={'f1_val': 0.9956663736194682, 'auprc': 0.9979308732207383, 'loss_val': 0.3536892450167926, 'psi': 0.9965721734599762}-{'f1_val': 0.7059717428737855, 'auprc': 0.9953086340203441, 'loss_val': 0.3049427295098294, 'psi': 0.821706499332409}
[S9] START round=8 head_norm_before_train=1.045793 cos_to_last_merge=0.9399 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.940
[S9] round=8 local utility u=1.000000 metrics={'f1_val': 0.7017640638110727, 'auprc': 0.9995790220120765, 'loss_val': 0.6614055520250204, 'psi': 0.8208900470914742}-{'f1_val': 0.43674874228585137, 'auprc': 0.8612619929699211, 'loss_val': 0.8125714738783841, 'psi': 0.6065540425594793}
[S10] START round=8 head_norm_before_train=0.918806 cos_to_last_merge=1.0000 (last merge round=7)
[S10] round=8 local utility u=0.000000 metrics={'f1_val': 0.6879722286559309, 'auprc': 0.9662714688393202, 'loss_val': 0.4021540082825162, 'psi': 0.7992919247292867}-{'f1_val': 0.6883210723388503, 'auprc': 0.993642896962952, 'loss_val': 0.39020559196241966, 'psi': 0.8104498021884909}
[S11] START round=8 head_norm_before_train=0.983972 cos_to_last_merge=1.0000 (last merge round=7)
[S11] round=8 local utility u=0.434205 metrics={'f1_val': 0.6820006529968936, 'auprc': 0.9941256524070993, 'loss_val': 0.7026961533381814, 'psi': 0.8068506527609759}-{'f1_val': 0.5241666138446328, 'auprc': 0.9987096276557521, 'loss_val': 0.6378543336420069, 'psi': 0.7139838193690806}
[S13] START round=8 head_norm_before_train=1.043573 cos_to_last_merge=0.8953 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.895
[S13] round=8 local utility u=0.000000 metrics={'f1_val': 0.6694136975399331, 'auprc': 0.6678927912658537, 'loss_val': 0.6255784697800253, 'psi': 0.6688053350303014}-{'f1_val': 0.705503752292822, 'auprc': 0.6796137840005059, 'loss_val': 0.7045276029733303, 'psi': 0.6951477649758956}
[S14] START round=8 head_norm_before_train=1.329218 (no previous merge yet)
[S14] round=8 local utility u=0.234605 metrics={'f1_val': 0.2800545848762723, 'auprc': 0.891293957308266, 'loss_val': 0.9192874877747472, 'psi': 0.5245503338490698}-{'f1_val': 0.25957741575595694, 'auprc': 0.8351917566398953, 'loss_val': 1.0973274504437076, 'psi': 0.4898231521095323}
[S15] START round=8 head_norm_before_train=1.263949 cos_to_last_merge=1.0000 (last merge round=7)
[S15] round=8 local utility u=0.726880 metrics={'f1_val': 0.7059061029255181, 'auprc': 0.7991808827632436, 'loss_val': 0.5308203810926434, 'psi': 0.7432160148606084}-{'f1_val': 0.47983649261871864, 'auprc': 0.800085018059792, 'loss_val': 0.6308743839597084, 'psi': 0.6079359027951481}
[S16] START round=8 head_norm_before_train=0.805760 cos_to_last_merge=1.0000 (last merge round=7)
[S16] round=8 local utility u=0.070126 metrics={'f1_val': 0.41715761842766974, 'auprc': 0.541643087063406, 'loss_val': 0.9800283428907908, 'psi': 0.4669518058819643}-{'f1_val': 0.4175015313869336, 'auprc': 0.519651177561926, 'loss_val': 1.056367791273615, 'psi': 0.45836138985693053}
[S17] START round=8 head_norm_before_train=1.594759 (no previous merge yet)
[S17] round=8 local utility u=0.472433 metrics={'f1_val': 0.41902320394448445, 'auprc': 0.9325051478344083, 'loss_val': 0.6881259957261305, 'psi': 0.624415981500454}-{'f1_val': 0.3688422382757552, 'auprc': 0.7858350424563083, 'loss_val': 0.8918953074681447, 'psi': 0.5356393599479764}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:49309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:49305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S16] → sending delta(kind=head bytes=1792) to S14@127.0.0.1:49314
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:49310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:49316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:49315
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:49302
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:49303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:49315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:49316
[S11] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1795 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1804 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1792 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1804) from S8
[S9] cosine check vs S8: cos=-0.0385
[S9] DROPPED delta from S8 (cos=-0.0385 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1800) from S7
[S3] cosine check vs S7: cos=-0.0007
[S3] DROPPED delta from S7 (cos=-0.0007 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1800) from S11
[S15] cosine check vs S11: cos=0.7076
[S15] RECEIVED delta(kind=head bytes=1795) from S2
[S15] cosine check vs S2: cos=-0.1387
[S15] DROPPED delta from S2 (cos=-0.1387 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1800) from S5
[S16] cosine check vs S5: cos=0.4165
[S16] RECEIVED delta(kind=head bytes=1798) from S9
[S16] cosine check vs S9: cos=0.8883
[S14] RECEIVED delta(kind=head bytes=1792) from S16
[S14] cosine check vs S16: cos=-0.0944
[S14] DROPPED delta from S16 (cos=-0.0944 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1797) from S15
[S5] cosine check vs S15: cos=-0.0403
[S5] DROPPED delta from S15 (cos=-0.0403 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1800) from S3
[S2] cosine check vs S3: cos=0.8048
[S8] RECEIVED delta(kind=head bytes=1798) from S14
[S8] cosine check vs S14: cos=-0.0282
[S8] DROPPED delta from S14 (cos=-0.0282 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:49303
[S17] sending update (kind=head size=1795 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1795) from S17
[S3] cosine check vs S17: cos=0.9658
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=8 metric=0.7059 head_norm=1.332600
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.727235e-01
[S15] stored merged vector for next round verification (round=8)
[S15] DEBUG after merge:  round=8 metric=0.4491 head_norm=1.092299 delta_norm=0.472724
[S15] aggregate: ROLLBACK (f1_val pre=0.706 post=0.449 tol_abs=0.005 tol_rel=0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=8 metric=0.7013 head_norm=1.056873
[S2] _apply_head_vector_avg (torch): Δ‖w‖=4.189815e-01
[S2] stored merged vector for next round verification (round=8)
[S2] DEBUG after merge:  round=8 metric=0.7013 head_norm=1.171099 delta_norm=0.418981
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=8 metric=0.3942 head_norm=1.406078
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.273369e-01
[S3] stored merged vector for next round verification (round=8)
[S3] DEBUG after merge:  round=8 metric=0.3944 head_norm=1.504875 delta_norm=0.227337
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=8 metric=0.4172 head_norm=0.839474
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.269850e-01
[S16] stored merged vector for next round verification (round=8)
[S16] DEBUG after merge:  round=8 metric=0.4261 head_norm=0.836936 delta_norm=0.226985
[S16] aggregate: ACCEPT kept=['S5', 'S9'] (k=2/2) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=1.171099 cos_to_last_merge=1.0000 (last merge round=8)
[S2] round=9 local utility u=0.000000 metrics={'f1_val': 0.7008704111015797, 'auprc': 0.6685171430694051, 'loss_val': 0.429577212559829, 'psi': 0.6879291038887099}-{'f1_val': 0.7013039891732853, 'auprc': 0.6873628029769958, 'loss_val': 0.44961078633579304, 'psi': 0.6957275146947695}
[S3] START round=9 head_norm_before_train=1.504875 cos_to_last_merge=1.0000 (last merge round=8)
[S3] round=9 local utility u=0.000000 metrics={'f1_val': 0.40310226040402647, 'auprc': 0.48338817597216416, 'loss_val': 0.8827868038358785, 'psi': 0.4352166266312816}-{'f1_val': 0.39417063440998584, 'auprc': 0.8131239143003759, 'loss_val': 0.796751750225901, 'psi': 0.5617519463661419}
[S4] START round=9 head_norm_before_train=1.404868 cos_to_last_merge=0.9193 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.919
[S4] round=9 local utility u=0.873661 metrics={'f1_val': 0.9522669653400146, 'auprc': 0.9275892052669326, 'loss_val': 0.4004583191182969, 'psi': 0.9423958613107818}-{'f1_val': 0.6656797203038407, 'auprc': 0.9363275502502431, 'loss_val': 0.454472265022066, 'psi': 0.7739388522824017}
[S5] START round=9 head_norm_before_train=1.358896 (no previous merge yet)
[S5] round=9 local utility u=0.048844 metrics={'f1_val': 0.7149202099987672, 'auprc': 0.7946442248492445, 'loss_val': 0.6714474175332138, 'psi': 0.7468098159389581}-{'f1_val': 0.7152507227248595, 'auprc': 0.7946838038711012, 'loss_val': 0.7712376099101445, 'psi': 0.7470239551833562}
[S6] START round=9 head_norm_before_train=1.281533 cos_to_last_merge=0.8882 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.888
[S6] round=9 local utility u=0.622103 metrics={'f1_val': 0.8624307807451297, 'auprc': 0.9769463838024265, 'loss_val': 0.24675137060860777, 'psi': 0.9082370219680485}-{'f1_val': 0.6955046763147156, 'auprc': 0.9430684531392917, 'loss_val': 0.3877678276346669, 'psi': 0.794530187044546}
[S7] START round=9 head_norm_before_train=0.992878 cos_to_last_merge=0.9517 (last merge round=1)
[S7] round=9 local utility u=0.078044 metrics={'f1_val': 0.4169130971024577, 'auprc': 0.5927423382362459, 'loss_val': 0.9119540035447177, 'psi': 0.487244793555973}-{'f1_val': 0.4168747328879592, 'auprc': 0.5754479248880118, 'loss_val': 1.0159285995522478, 'psi': 0.4803040096879802}
[S8] START round=9 head_norm_before_train=1.071453 cos_to_last_merge=0.9944 (last merge round=7)
[S8] round=9 local utility u=0.053326 metrics={'f1_val': 0.9959789603727395, 'auprc': 0.9982282398338138, 'loss_val': 0.24980542353524618, 'psi': 0.9968786721571692}-{'f1_val': 0.9956663736194682, 'auprc': 0.9979308732207383, 'loss_val': 0.3536892450167926, 'psi': 0.9965721734599762}
[S9] START round=9 head_norm_before_train=1.103244 cos_to_last_merge=0.9242 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.924
[S9] round=9 local utility u=0.079587 metrics={'f1_val': 0.7014391336149548, 'auprc': 0.9993777525602363, 'loss_val': 0.49967856881047246, 'psi': 0.8206145811930674}-{'f1_val': 0.7017640638110727, 'auprc': 0.9995790220120765, 'loss_val': 0.6614055520250204, 'psi': 0.8208900470914742}
[S10] START round=9 head_norm_before_train=1.000546 cos_to_last_merge=0.9926 (last merge round=7)
[S10] round=9 local utility u=0.144483 metrics={'f1_val': 0.6996640466857562, 'auprc': 0.9959238494029906, 'loss_val': 0.272296458597104, 'psi': 0.81816796777265}-{'f1_val': 0.6879722286559309, 'auprc': 0.9662714688393202, 'loss_val': 0.4021540082825162, 'psi': 0.7992919247292867}
[S11] START round=9 head_norm_before_train=1.028274 cos_to_last_merge=0.9969 (last merge round=7)
[S11] round=9 local utility u=0.148746 metrics={'f1_val': 0.7015169751345063, 'auprc': 0.996113575581446, 'loss_val': 0.5282665844250539, 'psi': 0.8193556153132822}-{'f1_val': 0.6820006529968936, 'auprc': 0.9941256524070993, 'loss_val': 0.7026961533381814, 'psi': 0.8068506527609759}
[S13] START round=9 head_norm_before_train=1.110137 cos_to_last_merge=0.8746 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.875
[S13] round=9 local utility u=0.000000 metrics={'f1_val': 0.6100742183235537, 'auprc': 0.6579983713173922, 'loss_val': 0.6072299609874133, 'psi': 0.6292438795210891}-{'f1_val': 0.6694136975399331, 'auprc': 0.6678927912658537, 'loss_val': 0.6255784697800253, 'psi': 0.6688053350303014}
[S14] START round=9 head_norm_before_train=1.372467 (no previous merge yet)
[S14] round=9 local utility u=1.000000 metrics={'f1_val': 0.9497355136011292, 'auprc': 0.9991103578735949, 'loss_val': 0.6909210970991195, 'psi': 0.9694854513101154}-{'f1_val': 0.2800545848762723, 'auprc': 0.891293957308266, 'loss_val': 0.9192874877747472, 'psi': 0.5245503338490698}
[S15] START round=9 head_norm_before_train=1.092299 cos_to_last_merge=1.0000 (last merge round=8)
[S15] round=9 local utility u=0.899355 metrics={'f1_val': 0.910122611957951, 'auprc': 0.9592735146388299, 'loss_val': 0.43768745919172153, 'psi': 0.9297829730303024}-{'f1_val': 0.7059061029255181, 'auprc': 0.7991808827632436, 'loss_val': 0.5308203810926434, 'psi': 0.7432160148606084}
[S16] START round=9 head_norm_before_train=0.836936 cos_to_last_merge=1.0000 (last merge round=8)
[S16] round=9 local utility u=0.000000 metrics={'f1_val': 0.38625411426403955, 'auprc': 0.5348132017163434, 'loss_val': 0.9320800486764664, 'psi': 0.44567774924496106}-{'f1_val': 0.41715761842766974, 'auprc': 0.541643087063406, 'loss_val': 0.9800283428907908, 'psi': 0.4669518058819643}
[S17] START round=9 head_norm_before_train=1.629604 (no previous merge yet)
[S17] round=9 local utility u=0.000000 metrics={'f1_val': 0.4066452550524987, 'auprc': 0.7649644501495388, 'loss_val': 0.6542505964969961, 'psi': 0.5499729330913148}-{'f1_val': 0.41902320394448445, 'auprc': 0.9325051478344083, 'loss_val': 0.6881259957261305, 'psi': 0.624415981500454}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:49310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:49303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:49316
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:49316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:49315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S14] → sending delta(kind=head bytes=1809) to S8@127.0.0.1:49309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:49312
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:49305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:49309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:49310
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1809 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1802) from S11
[S15] cosine check vs S11: cos=0.8729
[S3] RECEIVED delta(kind=head bytes=1796) from S7
[S3] cosine check vs S7: cos=0.0024
[S8] RECEIVED delta(kind=head bytes=1809) from S14
[S8] cosine check vs S14: cos=-0.0342
[S8] DROPPED delta from S14 (cos=-0.0342 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1801) from S8
[S9] cosine check vs S8: cos=-0.0451
[S9] DROPPED delta from S8 (cos=-0.0451 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1800) from S10
[S9] cosine check vs S10: cos=-0.0943
[S9] DROPPED delta from S10 (cos=-0.0943 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1799) from S9
[S16] cosine check vs S9: cos=0.7884
[S8] RECEIVED delta(kind=head bytes=1800) from S6
[S8] cosine check vs S6: cos=0.7622
[S11] RECEIVED delta(kind=head bytes=1797) from S4
[S11] cosine check vs S4: cos=0.6339
[S5] RECEIVED delta(kind=head bytes=1801) from S15
[S5] cosine check vs S15: cos=-0.0491
[S5] DROPPED delta from S15 (cos=-0.0491 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1802) from S5
[S16] cosine check vs S5: cos=0.6000
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=9 metric=0.4031 head_norm=1.537219
[S3] _apply_head_vector_avg (torch): Δ‖w‖=9.214563e-01
[S3] stored merged vector for next round verification (round=9)
[S3] DEBUG after merge:  round=9 metric=0.4010 head_norm=0.923529 delta_norm=0.921456
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=9 metric=0.9960 head_norm=1.151933
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.341721e-01
[S8] stored merged vector for next round verification (round=9)
[S8] DEBUG after merge:  round=9 metric=0.9809 head_norm=1.161852 delta_norm=0.434172
[S8] aggregate: ROLLBACK (f1_val pre=0.996 post=0.981 tol_abs=0.005 tol_rel=0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=9 metric=0.7015 head_norm=1.084017
[S11] _apply_head_vector_avg (torch): Δ‖w‖=5.628089e-01
[S11] stored merged vector for next round verification (round=9)
[S11] DEBUG after merge:  round=9 metric=0.7018 head_norm=1.142402 delta_norm=0.562809
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=9 metric=0.9101 head_norm=1.171080
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.873657e-01
[S15] stored merged vector for next round verification (round=9)
[S15] DEBUG after merge:  round=9 metric=0.9086 head_norm=1.091183 delta_norm=0.287366
[S15] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=9 metric=0.3863 head_norm=0.878349
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.546416e-01
[S16] stored merged vector for next round verification (round=9)
[S16] DEBUG after merge:  round=9 metric=0.3834 head_norm=0.891122 delta_norm=0.154642
[S16] aggregate: ACCEPT kept=['S9', 'S5'] (k=2/2) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=1.240195 cos_to_last_merge=0.9919 (last merge round=8)
[S2] round=10 local utility u=0.000000 metrics={'f1_val': 0.5894009614919618, 'auprc': 0.6574066511942105, 'loss_val': 0.6511000458030972, 'psi': 0.6166032373728612}-{'f1_val': 0.7008704111015797, 'auprc': 0.6685171430694051, 'loss_val': 0.429577212559829, 'psi': 0.6879291038887099}
[S3] START round=10 head_norm_before_train=0.923529 cos_to_last_merge=1.0000 (last merge round=9)
[S3] round=10 local utility u=1.000000 metrics={'f1_val': 0.5992886422044204, 'auprc': 0.8826447252261781, 'loss_val': 0.8249196428948239, 'psi': 0.7126310754131235}-{'f1_val': 0.40310226040402647, 'auprc': 0.48338817597216416, 'loss_val': 0.8827868038358785, 'psi': 0.4352166266312816}
[S4] START round=10 head_norm_before_train=1.438256 cos_to_last_merge=0.9147 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.915
[S4] round=10 local utility u=0.067821 metrics={'f1_val': 0.9549375741247647, 'auprc': 0.9430303006621155, 'loss_val': 0.32716271080608417, 'psi': 0.9501746647397049}-{'f1_val': 0.9522669653400146, 'auprc': 0.9275892052669326, 'loss_val': 0.4004583191182969, 'psi': 0.9423958613107818}
[S5] START round=10 head_norm_before_train=1.397102 (no previous merge yet)
[S5] round=10 local utility u=0.030647 metrics={'f1_val': 0.7149202099987672, 'auprc': 0.7947365770433329, 'loss_val': 0.6104300273498265, 'psi': 0.7468467568165935}-{'f1_val': 0.7149202099987672, 'auprc': 0.7946442248492445, 'loss_val': 0.6714474175332138, 'psi': 0.7468098159389581}
[S6] START round=10 head_norm_before_train=1.322822 cos_to_last_merge=0.8774 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.877
[S6] round=10 local utility u=0.000000 metrics={'f1_val': 0.641271078715542, 'auprc': 0.808923668585132, 'loss_val': 0.43403165850507924, 'psi': 0.708332114663378}-{'f1_val': 0.8624307807451297, 'auprc': 0.9769463838024265, 'loss_val': 0.24675137060860777, 'psi': 0.9082370219680485}
[S7] START round=10 head_norm_before_train=1.020261 cos_to_last_merge=0.9385 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.939
[S7] round=10 local utility u=0.297449 metrics={'f1_val': 0.4169130971024577, 'auprc': 0.7701275833364213, 'loss_val': 0.849210779055046, 'psi': 0.5581988915960432}-{'f1_val': 0.4169130971024577, 'auprc': 0.5927423382362459, 'loss_val': 0.9119540035447177, 'psi': 0.487244793555973}
[S8] START round=10 head_norm_before_train=1.161852 cos_to_last_merge=1.0000 (last merge round=9)
[S8] round=10 local utility u=0.000000 metrics={'f1_val': 0.7139521677339791, 'auprc': 0.9940043774994253, 'loss_val': 0.33369673644829906, 'psi': 0.8259730516401576}-{'f1_val': 0.9959789603727395, 'auprc': 0.9982282398338138, 'loss_val': 0.24980542353524618, 'psi': 0.9968786721571692}
[S9] START round=10 head_norm_before_train=1.161238 cos_to_last_merge=0.9081 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.908
[S9] round=10 local utility u=0.080467 metrics={'f1_val': 0.7013646677191758, 'auprc': 0.9993690553040409, 'loss_val': 0.33827106765749976, 'psi': 0.8205664227531219}-{'f1_val': 0.7014391336149548, 'auprc': 0.9993777525602363, 'loss_val': 0.49967856881047246, 'psi': 0.8206145811930674}
[S10] START round=10 head_norm_before_train=1.072352 cos_to_last_merge=0.9789 (last merge round=7)
[S10] round=10 local utility u=0.802182 metrics={'f1_val': 0.9581788939585685, 'auprc': 0.9970494684185439, 'loss_val': 0.22239909163535482, 'psi': 0.9737271237425587}-{'f1_val': 0.6996640466857562, 'auprc': 0.9959238494029906, 'loss_val': 0.272296458597104, 'psi': 0.81816796777265}
[S11] START round=10 head_norm_before_train=1.142402 cos_to_last_merge=1.0000 (last merge round=9)
[S11] round=10 local utility u=0.000000 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9965261714149183, 'loss_val': 0.5817700583517826, 'psi': 0.8197716585449594}-{'f1_val': 0.7015169751345063, 'auprc': 0.996113575581446, 'loss_val': 0.5282665844250539, 'psi': 0.8193556153132822}
[S13] START round=10 head_norm_before_train=1.166488 cos_to_last_merge=0.8565 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.857
[S13] round=10 local utility u=0.000000 metrics={'f1_val': 0.6210674495395347, 'auprc': 0.6265555310896123, 'loss_val': 0.6473346665579296, 'psi': 0.6232626821595657}-{'f1_val': 0.6100742183235537, 'auprc': 0.6579983713173922, 'loss_val': 0.6072299609874133, 'psi': 0.6292438795210891}
[S14] START round=10 head_norm_before_train=1.421000 (no previous merge yet)
[S14] round=10 local utility u=0.233144 metrics={'f1_val': 0.9978253590560278, 'auprc': 0.9951727381292758, 'loss_val': 0.5013598280283387, 'psi': 0.9967643106853269}-{'f1_val': 0.9497355136011292, 'auprc': 0.9991103578735949, 'loss_val': 0.6909210970991195, 'psi': 0.9694854513101154}
[S15] START round=10 head_norm_before_train=1.091183 cos_to_last_merge=1.0000 (last merge round=9)
[S15] round=10 local utility u=0.000000 metrics={'f1_val': 0.7627203121785067, 'auprc': 0.855691314715328, 'loss_val': 0.4763053174059, 'psi': 0.7999087131932352}-{'f1_val': 0.910122611957951, 'auprc': 0.9592735146388299, 'loss_val': 0.43768745919172153, 'psi': 0.9297829730303024}
[S16] START round=10 head_norm_before_train=0.891122 cos_to_last_merge=1.0000 (last merge round=9)
[S16] round=10 local utility u=0.255371 metrics={'f1_val': 0.3593367194121232, 'auprc': 0.7501240337290805, 'loss_val': 0.9057654217977466, 'psi': 0.5156516451389062}-{'f1_val': 0.38625411426403955, 'auprc': 0.5348132017163434, 'loss_val': 0.9320800486764664, 'psi': 0.44567774924496106}
[S17] START round=10 head_norm_before_train=1.678121 (no previous merge yet)
[S17] round=10 local utility u=0.854392 metrics={'f1_val': 0.6145550053367722, 'auprc': 0.8842574332428135, 'loss_val': 0.5508035380720726, 'psi': 0.7224359764991888}-{'f1_val': 0.4066452550524987, 'auprc': 0.7649644501495388, 'loss_val': 0.6542505964969961, 'psi': 0.5499729330913148}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:49310
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] → sending delta(kind=head bytes=1805) to S8@127.0.0.1:49309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:49314
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:49316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:49302
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:49316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:49312
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:49303
[S7] sending update (kind=head size=1796 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1794 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1805 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1794 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1799) from S5
[S16] cosine check vs S5: cos=0.6733
[S16] RECEIVED delta(kind=head bytes=1803) from S9
[S16] cosine check vs S9: cos=0.7346
[S9] RECEIVED delta(kind=head bytes=1794) from S10
[S9] cosine check vs S10: cos=-0.0942
[S9] DROPPED delta from S10 (cos=-0.0942 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1794) from S16
[S14] cosine check vs S16: cos=-0.1051
[S14] DROPPED delta from S16 (cos=-0.1051 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1800) from S4
[S11] cosine check vs S4: cos=0.9053
[S2] RECEIVED delta(kind=head bytes=1796) from S3
[S2] cosine check vs S3: cos=0.7348
[S8] RECEIVED delta(kind=head bytes=1805) from S14
[S8] cosine check vs S14: cos=-0.0339
[S8] DROPPED delta from S14 (cos=-0.0339 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1796) from S7
[S3] cosine check vs S7: cos=0.5202
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:49303
[S17] sending update (kind=head size=1800 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1800) from S17
[S3] cosine check vs S17: cos=0.8238
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=10 metric=0.7019 head_norm=1.182349
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.232468e-01
[S11] stored merged vector for next round verification (round=10)
[S11] DEBUG after merge:  round=10 metric=0.6708 head_norm=1.298438 delta_norm=0.323247
[S11] aggregate: ROLLBACK (f1_val pre=0.702 post=0.671 tol_abs=0.005 tol_rel=0.0)
[S11] ⇄ pheromone p=0.317 → S15@127.0.0.1:49315
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=10 metric=0.5894 head_norm=1.316459
[S2] _apply_head_vector_avg (torch): Δ‖w‖=4.464994e-01
[S2] stored merged vector for next round verification (round=10)
[S2] DEBUG after merge:  round=10 metric=0.5484 head_norm=1.060140 delta_norm=0.446499
[S2] aggregate: ROLLBACK (f1_val pre=0.589 post=0.548 tol_abs=0.005 tol_rel=0.0)
[S2] ⇄ pheromone p=0.242 → S15@127.0.0.1:49315
[S8] ⇄ pheromone p=0.364 → S9@127.0.0.1:49310
[S13] ⇄ pheromone p=0.292 → S10@127.0.0.1:49311
[S6] ⇄ pheromone p=0.409 → S8@127.0.0.1:49309
[S5] ⇄ pheromone p=0.330 → S16@127.0.0.1:49316
[S7] ⇄ pheromone p=0.270 → S3@127.0.0.1:49303
[S9] ⇄ pheromone p=0.375 → S16@127.0.0.1:49316
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=10 metric=0.5993 head_norm=0.955747
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.324998e-01
[S3] stored merged vector for next round verification (round=10)
[S3] DEBUG after merge:  round=10 metric=0.5913 head_norm=0.977983 delta_norm=0.132500
[S3] aggregate: ROLLBACK (f1_val pre=0.599 post=0.591 tol_abs=0.005 tol_rel=0.0)
[S3] ⇄ pheromone p=0.440 → S2@127.0.0.1:49302
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=10 metric=0.3593 head_norm=0.936680
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.278827e-01
[S16] stored merged vector for next round verification (round=10)
[S16] DEBUG after merge:  round=10 metric=0.3715 head_norm=0.941885 delta_norm=0.127883
[S16] aggregate: ACCEPT kept=['S5', 'S9'] (k=2/2) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.248 → S14@127.0.0.1:49314
[S14] ⇄ pheromone p=0.420 → S8@127.0.0.1:49309
[S10] ⇄ pheromone p=0.443 → S9@127.0.0.1:49310
[S4] ⇄ pheromone p=0.450 → S11@127.0.0.1:49312
[S15] ⇄ pheromone p=0.473 → S5@127.0.0.1:49305
[S17] ⇄ pheromone p=0.392 → S3@127.0.0.1:49303
[S2] START round=11 head_norm_before_train=1.060140 cos_to_last_merge=1.0000 (last merge round=10)
[S2] round=11 local utility u=0.490126 metrics={'f1_val': 0.7071747123832272, 'auprc': 0.6758868784919387, 'loss_val': 0.43293179272740195, 'psi': 0.6946595788267118}-{'f1_val': 0.5894009614919618, 'auprc': 0.6574066511942105, 'loss_val': 0.6511000458030972, 'psi': 0.6166032373728612}
[S3] START round=11 head_norm_before_train=0.977983 cos_to_last_merge=1.0000 (last merge round=10)
[S3] round=11 local utility u=0.450155 metrics={'f1_val': 0.6668540214427425, 'auprc': 0.9999991528406738, 'loss_val': 0.6820642538637788, 'psi': 0.800112074001915}-{'f1_val': 0.5992886422044204, 'auprc': 0.8826447252261781, 'loss_val': 0.8249196428948239, 'psi': 0.7126310754131235}
[S4] START round=11 head_norm_before_train=1.477468 cos_to_last_merge=0.9098 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.910
[S4] round=11 local utility u=0.000000 metrics={'f1_val': 0.9388884923681863, 'auprc': 0.9294265027985467, 'loss_val': 0.3438099467561523, 'psi': 0.9351036965403303}-{'f1_val': 0.9549375741247647, 'auprc': 0.9430303006621155, 'loss_val': 0.32716271080608417, 'psi': 0.9501746647397049}
[S5] START round=11 head_norm_before_train=1.429297 (no previous merge yet)
[S5] round=11 local utility u=0.000000 metrics={'f1_val': 0.7010632883987697, 'auprc': 0.7949072779550217, 'loss_val': 0.5334752707212135, 'psi': 0.7386008842212706}-{'f1_val': 0.7149202099987672, 'auprc': 0.7947365770433329, 'loss_val': 0.6104300273498265, 'psi': 0.7468467568165935}
[S6] START round=11 head_norm_before_train=1.350712 cos_to_last_merge=0.8700 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.870
[S6] round=11 local utility u=0.000000 metrics={'f1_val': 0.6013136815285213, 'auprc': 0.7810296490407811, 'loss_val': 0.6742645083524464, 'psi': 0.6732000685334252}-{'f1_val': 0.641271078715542, 'auprc': 0.808923668585132, 'loss_val': 0.43403165850507924, 'psi': 0.708332114663378}
[S7] START round=11 head_norm_before_train=1.047857 cos_to_last_merge=0.9244 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.924
[S7] round=11 local utility u=0.049825 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.79151891277335, 'loss_val': 0.8125175679219159, 'psi': 0.5666336359759541}-{'f1_val': 0.4169130971024577, 'auprc': 0.7701275833364213, 'loss_val': 0.849210779055046, 'psi': 0.5581988915960432}
[S8] START round=11 head_norm_before_train=1.230944 cos_to_last_merge=0.9949 (last merge round=9)
[S8] round=11 local utility u=0.905329 metrics={'f1_val': 0.9958331535970073, 'auprc': 0.9945611131741112, 'loss_val': 0.21599551403962458, 'psi': 0.9953243374278489}-{'f1_val': 0.7139521677339791, 'auprc': 0.9940043774994253, 'loss_val': 0.33369673644829906, 'psi': 0.8259730516401576}
[S9] START round=11 head_norm_before_train=1.221054 cos_to_last_merge=0.8924 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.892
[S9] round=11 local utility u=0.031410 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9986126091460071, 'loss_val': 0.2727363555261045, 'psi': 0.8202193337829409}-{'f1_val': 0.7013646677191758, 'auprc': 0.9993690553040409, 'loss_val': 0.33827106765749976, 'psi': 0.8205664227531219}
[S10] START round=11 head_norm_before_train=1.124312 cos_to_last_merge=0.9682 (last merge round=7)
[S10] round=11 local utility u=0.126967 metrics={'f1_val': 0.9955621277269954, 'auprc': 0.9945234832202134, 'loss_val': 0.18518748875993565, 'psi': 0.9951466699242826}-{'f1_val': 0.9581788939585685, 'auprc': 0.9970494684185439, 'loss_val': 0.22239909163535482, 'psi': 0.9737271237425587}
[S11] START round=11 head_norm_before_train=1.298438 cos_to_last_merge=1.0000 (last merge round=10)
[S11] round=11 local utility u=0.022031 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.996660167587133, 'loss_val': 0.5366580869302521, 'psi': 0.8196801547870081}-{'f1_val': 0.7019353166316534, 'auprc': 0.9965261714149183, 'loss_val': 0.5817700583517826, 'psi': 0.8197716585449594}
[S13] START round=11 head_norm_before_train=1.215114 cos_to_last_merge=0.8394 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.839
[S13] round=11 local utility u=0.000000 metrics={'f1_val': 0.5837031410445086, 'auprc': 0.6710102829697477, 'loss_val': 0.7734732889039069, 'psi': 0.6186259978146043}-{'f1_val': 0.6210674495395347, 'auprc': 0.6265555310896123, 'loss_val': 0.6473346665579296, 'psi': 0.6232626821595657}
[S14] START round=11 head_norm_before_train=1.477534 (no previous merge yet)
[S14] round=11 local utility u=0.000000 metrics={'f1_val': 0.8870393775917905, 'auprc': 0.9646678386731611, 'loss_val': 0.4061549094776214, 'psi': 0.9180907620243387}-{'f1_val': 0.9978253590560278, 'auprc': 0.9951727381292758, 'loss_val': 0.5013598280283387, 'psi': 0.9967643106853269}
[S15] START round=11 head_norm_before_train=1.164479 cos_to_last_merge=0.9913 (last merge round=9)
[S15] round=11 local utility u=0.000000 metrics={'f1_val': 0.7008364399900768, 'auprc': 0.7996799828600725, 'loss_val': 0.44036935840065755, 'psi': 0.7403738571380751}-{'f1_val': 0.7627203121785067, 'auprc': 0.855691314715328, 'loss_val': 0.4763053174059, 'psi': 0.7999087131932352}
[S16] START round=11 head_norm_before_train=0.941885 cos_to_last_merge=1.0000 (last merge round=10)
[S16] round=11 local utility u=0.167511 metrics={'f1_val': 0.39960457281625766, 'auprc': 0.7588826038509089, 'loss_val': 0.8386263808460713, 'psi': 0.5433157852301181}-{'f1_val': 0.3593367194121232, 'auprc': 0.7501240337290805, 'loss_val': 0.9057654217977466, 'psi': 0.5156516451389062}
[S17] START round=11 head_norm_before_train=1.723309 (no previous merge yet)
[S17] round=11 local utility u=0.000000 metrics={'f1_val': 0.5975668629058261, 'auprc': 0.8350592377504721, 'loss_val': 0.7609064932676283, 'psi': 0.6925638128436845}-{'f1_val': 0.6145550053367722, 'auprc': 0.8842574332428135, 'loss_val': 0.5508035380720726, 'psi': 0.7224359764991888}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:49315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:49303
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:49315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S3] → sending delta(kind=head bytes=1790) to S2@127.0.0.1:49302
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:49310
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:49316
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:49314
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:49310
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S3] sending update (kind=head size=1790 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1790) from S3
[S2] cosine check vs S3: cos=0.8734
[S9] RECEIVED delta(kind=head bytes=1802) from S8
[S9] cosine check vs S8: cos=-0.0113
[S9] DROPPED delta from S8 (cos=-0.0113 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1797) from S10
[S9] cosine check vs S10: cos=-0.0907
[S9] DROPPED delta from S10 (cos=-0.0907 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1800) from S7
[S3] cosine check vs S7: cos=0.4965
[S15] RECEIVED delta(kind=head bytes=1798) from S11
[S15] cosine check vs S11: cos=0.5882
[S16] RECEIVED delta(kind=head bytes=1796) from S9
[S16] cosine check vs S9: cos=0.7114
[S15] RECEIVED delta(kind=head bytes=1798) from S2
[S15] cosine check vs S2: cos=-0.0409
[S15] DROPPED delta from S2 (cos=-0.0409 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1798) from S16
[S14] cosine check vs S16: cos=-0.1103
[S14] DROPPED delta from S16 (cos=-0.1103 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=11 metric=0.6669 head_norm=1.014043
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.268953e-01
[S3] stored merged vector for next round verification (round=11)
[S3] DEBUG after merge:  round=11 metric=0.5172 head_norm=0.907136 delta_norm=0.526895
[S3] aggregate: ROLLBACK (f1_val pre=0.667 post=0.517 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=11 metric=0.3996 head_norm=0.984463
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.509085e-01
[S16] stored merged vector for next round verification (round=11)
[S16] DEBUG after merge:  round=11 metric=0.3998 head_norm=1.048292 delta_norm=0.450908
[S16] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=11 metric=0.7072 head_norm=1.127977
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.750783e-01
[S2] stored merged vector for next round verification (round=11)
[S2] DEBUG after merge:  round=11 metric=0.6358 head_norm=1.036648 delta_norm=0.275078
[S2] aggregate: ROLLBACK (f1_val pre=0.707 post=0.636 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=11 metric=0.7008 head_norm=1.245149
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.853002e-01
[S15] stored merged vector for next round verification (round=11)
[S15] DEBUG after merge:  round=11 metric=0.7010 head_norm=1.147298 delta_norm=0.585300
[S15] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.036648 cos_to_last_merge=1.0000 (last merge round=11)
[S2] round=12 local utility u=0.000000 metrics={'f1_val': 0.6864228120141702, 'auprc': 0.6761550259841386, 'loss_val': 0.5542022152063032, 'psi': 0.6823156976021576}-{'f1_val': 0.7071747123832272, 'auprc': 0.6758868784919387, 'loss_val': 0.43293179272740195, 'psi': 0.6946595788267118}
[S3] START round=12 head_norm_before_train=0.907136 cos_to_last_merge=1.0000 (last merge round=11)
[S3] round=12 local utility u=0.000000 metrics={'f1_val': 0.6577490950979719, 'auprc': 0.9185218072109246, 'loss_val': 0.8270470131979729, 'psi': 0.762058179943153}-{'f1_val': 0.6668540214427425, 'auprc': 0.9999991528406738, 'loss_val': 0.6820642538637788, 'psi': 0.800112074001915}
[S4] START round=12 head_norm_before_train=1.508951 cos_to_last_merge=0.9047 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.905
[S4] round=12 local utility u=0.137861 metrics={'f1_val': 0.9531310319265623, 'auprc': 0.9682247028638136, 'loss_val': 0.2699381658772125, 'psi': 0.9591685003014628}-{'f1_val': 0.9388884923681863, 'auprc': 0.9294265027985467, 'loss_val': 0.3438099467561523, 'psi': 0.9351036965403303}
[S5] START round=12 head_norm_before_train=1.463040 (no previous merge yet)
[S5] round=12 local utility u=0.023512 metrics={'f1_val': 0.7011041183246911, 'auprc': 0.7931857747722366, 'loss_val': 0.4815308324787129, 'psi': 0.7379367809037093}-{'f1_val': 0.7010632883987697, 'auprc': 0.7949072779550217, 'loss_val': 0.5334752707212135, 'psi': 0.7386008842212706}
[S6] START round=12 head_norm_before_train=1.374663 cos_to_last_merge=0.8661 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.866
[S6] round=12 local utility u=0.788653 metrics={'f1_val': 0.8120929487090297, 'auprc': 0.8009678502841745, 'loss_val': 0.4214486012096833, 'psi': 0.8076429093390876}-{'f1_val': 0.6013136815285213, 'auprc': 0.7810296490407811, 'loss_val': 0.6742645083524464, 'psi': 0.6732000685334252}
[S7] START round=12 head_norm_before_train=1.082934 cos_to_last_merge=0.9113 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.911
[S7] round=12 local utility u=0.000000 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.7871390296100301, 'loss_val': 0.8030797316416806, 'psi': 0.5648816827106261}-{'f1_val': 0.41671011811102343, 'auprc': 0.79151891277335, 'loss_val': 0.8125175679219159, 'psi': 0.5666336359759541}
[S8] START round=12 head_norm_before_train=1.300330 cos_to_last_merge=0.9847 (last merge round=9)
[S8] round=12 local utility u=0.000000 metrics={'f1_val': 0.9915995590959052, 'auprc': 0.9990232178996762, 'loss_val': 0.20451241774234533, 'psi': 0.9945690226174135}-{'f1_val': 0.9958331535970073, 'auprc': 0.9945611131741112, 'loss_val': 0.21599551403962458, 'psi': 0.9953243374278489}
[S9] START round=12 head_norm_before_train=1.278790 cos_to_last_merge=0.8777 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.878
[S9] round=12 local utility u=0.000000 metrics={'f1_val': 0.6106160659994558, 'auprc': 0.9309060410590302, 'loss_val': 0.37143067924784073, 'psi': 0.7387320560232856}-{'f1_val': 0.7012904835408967, 'auprc': 0.9986126091460071, 'loss_val': 0.2727363555261045, 'psi': 0.8202193337829409}
[S10] START round=12 head_norm_before_train=1.163463 cos_to_last_merge=0.9602 (last merge round=7)
[S10] round=12 local utility u=0.015687 metrics={'f1_val': 0.994470039851647, 'auprc': 0.9965814829942108, 'loss_val': 0.15343503548497003, 'psi': 0.9953146171086724}-{'f1_val': 0.9955621277269954, 'auprc': 0.9945234832202134, 'loss_val': 0.18518748875993565, 'psi': 0.9951466699242826}
[S11] START round=12 head_norm_before_train=1.329414 cos_to_last_merge=0.9973 (last merge round=10)
[S11] round=12 local utility u=0.046254 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9963306356744953, 'loss_val': 0.44461171930721816, 'psi': 0.8196934442487902}-{'f1_val': 0.7016934795869249, 'auprc': 0.996660167587133, 'loss_val': 0.5366580869302521, 'psi': 0.8196801547870081}
[S13] START round=12 head_norm_before_train=1.254905 cos_to_last_merge=0.8304 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.830
[S13] round=12 local utility u=0.161670 metrics={'f1_val': 0.6226469508100084, 'auprc': 0.66404932898948, 'loss_val': 0.6629136390681589, 'psi': 0.6392079020817971}-{'f1_val': 0.5837031410445086, 'auprc': 0.6710102829697477, 'loss_val': 0.7734732889039069, 'psi': 0.6186259978146043}
[S14] START round=12 head_norm_before_train=1.532712 (no previous merge yet)
[S14] round=12 local utility u=0.439379 metrics={'f1_val': 0.9965988080835264, 'auprc': 0.9975383319681004, 'loss_val': 0.2833647518184649, 'psi': 0.996974617637356}-{'f1_val': 0.8870393775917905, 'auprc': 0.9646678386731611, 'loss_val': 0.4061549094776214, 'psi': 0.9180907620243387}
[S15] START round=12 head_norm_before_train=1.147298 cos_to_last_merge=1.0000 (last merge round=11)
[S15] round=12 local utility u=1.000000 metrics={'f1_val': 0.9333597658468036, 'auprc': 0.9815463513571586, 'loss_val': 0.36708336653490137, 'psi': 0.9526344000509456}-{'f1_val': 0.7008364399900768, 'auprc': 0.7996799828600725, 'loss_val': 0.44036935840065755, 'psi': 0.7403738571380751}
[S16] START round=12 head_norm_before_train=1.048292 cos_to_last_merge=1.0000 (last merge round=11)
[S16] round=12 local utility u=0.399798 metrics={'f1_val': 0.5175221158708961, 'auprc': 0.7743267076210989, 'loss_val': 0.7928670612647051, 'psi': 0.6202439525709773}-{'f1_val': 0.39960457281625766, 'auprc': 0.7588826038509089, 'loss_val': 0.8386263808460713, 'psi': 0.5433157852301181}
[S17] START round=12 head_norm_before_train=1.781219 (no previous merge yet)
[S17] round=12 local utility u=0.049793 metrics={'f1_val': 0.590207761896737, 'auprc': 0.8830680166118332, 'loss_val': 0.7611924120883836, 'psi': 0.7073518637827754}-{'f1_val': 0.5975668629058261, 'auprc': 0.8350592377504721, 'loss_val': 0.7609064932676283, 'psi': 0.6925638128436845}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:49314
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:49312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:49305
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:49311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:49316
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:49309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:49315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:49310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:49309
[S15] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1794 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1795 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1794) from S10
[S9] cosine check vs S10: cos=-0.0883
[S9] DROPPED delta from S10 (cos=-0.0883 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1798) from S16
[S14] cosine check vs S16: cos=-0.1203
[S14] DROPPED delta from S16 (cos=-0.1203 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1798) from S15
[S5] cosine check vs S15: cos=-0.0488
[S5] DROPPED delta from S15 (cos=-0.0488 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1799) from S11
[S15] cosine check vs S11: cos=0.8745
[S16] RECEIVED delta(kind=head bytes=1800) from S5
[S16] cosine check vs S5: cos=0.3644
[S11] RECEIVED delta(kind=head bytes=1795) from S4
[S11] cosine check vs S4: cos=0.9489
[S8] RECEIVED delta(kind=head bytes=1803) from S14
[S8] cosine check vs S14: cos=-0.0409
[S8] DROPPED delta from S14 (cos=-0.0409 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1797) from S13
[S10] cosine check vs S13: cos=0.7619
[S8] RECEIVED delta(kind=head bytes=1799) from S6
[S8] cosine check vs S6: cos=0.8589
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:49303
[S17] sending update (kind=head size=1799 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1799) from S17
[S3] cosine check vs S17: cos=0.5067
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=12 metric=0.9916 head_norm=1.356481
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.660670e-01
[S8] stored merged vector for next round verification (round=12)
[S8] DEBUG after merge:  round=12 metric=0.9930 head_norm=1.326904 delta_norm=0.366067
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=12 metric=0.6577 head_norm=0.934729
[S3] _apply_head_vector_avg (torch): Δ‖w‖=7.959034e-01
[S3] stored merged vector for next round verification (round=12)
[S3] DEBUG after merge:  round=12 metric=0.6656 head_norm=1.227994 delta_norm=0.795903
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=12 metric=0.7019 head_norm=1.365703
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.487901e-01
[S11] stored merged vector for next round verification (round=12)
[S11] DEBUG after merge:  round=12 metric=0.7019 head_norm=1.436287 delta_norm=0.248790
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=12 metric=0.9334 head_norm=1.221636
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.314756e-01
[S15] stored merged vector for next round verification (round=12)
[S15] DEBUG after merge:  round=12 metric=0.7926 head_norm=1.252555 delta_norm=0.331476
[S15] aggregate: ROLLBACK (f1_val pre=0.933 post=0.793 tol_abs=0.005 tol_rel=0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=12 metric=0.9945 head_norm=1.201471
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.308483e-01
[S10] stored merged vector for next round verification (round=12)
[S10] DEBUG after merge:  round=12 metric=0.9943 head_norm=1.167107 delta_norm=0.430848
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=12 metric=0.5175 head_norm=1.090489
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.469398e-01
[S16] stored merged vector for next round verification (round=12)
[S16] DEBUG after merge:  round=12 metric=0.7893 head_norm=1.072904 delta_norm=0.746940
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.103562 cos_to_last_merge=0.9928 (last merge round=11)
[S2] round=13 local utility u=0.201148 metrics={'f1_val': 0.7082030175629204, 'auprc': 0.7295705860778872, 'loss_val': 0.4428332327099357, 'psi': 0.716750044968907}-{'f1_val': 0.6864228120141702, 'auprc': 0.6761550259841386, 'loss_val': 0.5542022152063032, 'psi': 0.6823156976021576}
[S3] START round=13 head_norm_before_train=1.227994 cos_to_last_merge=1.0000 (last merge round=12)
[S3] round=13 local utility u=0.000000 metrics={'f1_val': 0.5367815047654385, 'auprc': 0.8119958710725521, 'loss_val': 0.6425953746816547, 'psi': 0.646867251288284}-{'f1_val': 0.6577490950979719, 'auprc': 0.9185218072109246, 'loss_val': 0.8270470131979729, 'psi': 0.762058179943153}
[S4] START round=13 head_norm_before_train=1.544178 cos_to_last_merge=0.8991 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.899
[S4] round=13 local utility u=0.000000 metrics={'f1_val': 0.9376030122396111, 'auprc': 0.9214435868533544, 'loss_val': 0.2923058056824432, 'psi': 0.9311392420851083}-{'f1_val': 0.9531310319265623, 'auprc': 0.9682247028638136, 'loss_val': 0.2699381658772125, 'psi': 0.9591685003014628}
[S5] START round=13 head_norm_before_train=1.492957 (no previous merge yet)
[S5] round=13 local utility u=0.030607 metrics={'f1_val': 0.7011041183246911, 'auprc': 0.7919529066494626, 'loss_val': 0.41661922306353055, 'psi': 0.7374436336545998}-{'f1_val': 0.7011041183246911, 'auprc': 0.7931857747722366, 'loss_val': 0.4815308324787129, 'psi': 0.7379367809037093}
[S6] START round=13 head_norm_before_train=1.396180 cos_to_last_merge=0.8620 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.862
[S6] round=13 local utility u=0.813463 metrics={'f1_val': 0.9604314091167473, 'auprc': 0.9743572136219265, 'loss_val': 0.20472106582691968, 'psi': 0.9660017309188189}-{'f1_val': 0.8120929487090297, 'auprc': 0.8009678502841745, 'loss_val': 0.4214486012096833, 'psi': 0.8076429093390876}
[S7] START round=13 head_norm_before_train=1.113591 cos_to_last_merge=0.8980 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.898
[S7] round=13 local utility u=0.000000 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.7808830325845558, 'loss_val': 0.8035603882726667, 'psi': 0.5623792839004365}-{'f1_val': 0.41671011811102343, 'auprc': 0.7871390296100301, 'loss_val': 0.8030797316416806, 'psi': 0.5648816827106261}
[S8] START round=13 head_norm_before_train=1.326904 cos_to_last_merge=1.0000 (last merge round=12)
[S8] round=13 local utility u=0.000000 metrics={'f1_val': 0.9945307733441335, 'auprc': 0.993263348754219, 'loss_val': 0.2143397239628247, 'psi': 0.9940238035081677}-{'f1_val': 0.9915995590959052, 'auprc': 0.9990232178996762, 'loss_val': 0.20451241774234533, 'psi': 0.9945690226174135}
[S9] START round=13 head_norm_before_train=1.329131 cos_to_last_merge=0.8650 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.865
[S9] round=13 local utility u=0.472375 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9982299725002455, 'loss_val': 0.17225520880238426, 'psi': 0.8200219374641093}-{'f1_val': 0.6106160659994558, 'auprc': 0.9309060410590302, 'loss_val': 0.37143067924784073, 'psi': 0.7387320560232856}
[S10] START round=13 head_norm_before_train=1.167107 cos_to_last_merge=1.0000 (last merge round=12)
[S10] round=13 local utility u=0.000000 metrics={'f1_val': 0.9951279124444816, 'auprc': 0.9973034717042976, 'loss_val': 0.18230716652533355, 'psi': 0.995998136148408}-{'f1_val': 0.994470039851647, 'auprc': 0.9965814829942108, 'loss_val': 0.15343503548497003, 'psi': 0.9953146171086724}
[S11] START round=13 head_norm_before_train=1.436287 cos_to_last_merge=1.0000 (last merge round=12)
[S11] round=13 local utility u=0.006356 metrics={'f1_val': 0.7016282822309048, 'auprc': 0.9973015940309521, 'loss_val': 0.4329710412362024, 'psi': 0.8198976069509236}-{'f1_val': 0.7019353166316534, 'auprc': 0.9963306356744953, 'loss_val': 0.44461171930721816, 'psi': 0.8196934442487902}
[S13] START round=13 head_norm_before_train=1.285304 cos_to_last_merge=0.8230 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.823
[S13] round=13 local utility u=0.000000 metrics={'f1_val': 0.6174483383916616, 'auprc': 0.6598100746592963, 'loss_val': 0.6256461549015626, 'psi': 0.6343930328987155}-{'f1_val': 0.6226469508100084, 'auprc': 0.66404932898948, 'loss_val': 0.6629136390681589, 'psi': 0.6392079020817971}
[S14] START round=13 head_norm_before_train=1.579922 (no previous merge yet)
[S14] round=13 local utility u=0.052246 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9991111443715525, 'loss_val': 0.18846373294622493, 'psi': 0.9980910543093179}-{'f1_val': 0.9965988080835264, 'auprc': 0.9975383319681004, 'loss_val': 0.2833647518184649, 'psi': 0.996974617637356}
[S15] START round=13 head_norm_before_train=1.252555 cos_to_last_merge=1.0000 (last merge round=12)
[S15] round=13 local utility u=0.000000 metrics={'f1_val': 0.8721328633305594, 'auprc': 0.9433422371664109, 'loss_val': 0.39716914881319915, 'psi': 0.9006166128649}-{'f1_val': 0.9333597658468036, 'auprc': 0.9815463513571586, 'loss_val': 0.36708336653490137, 'psi': 0.9526344000509456}
[S16] START round=13 head_norm_before_train=1.072904 cos_to_last_merge=1.0000 (last merge round=12)
[S16] round=13 local utility u=0.728809 metrics={'f1_val': 0.7500353600555526, 'auprc': 0.7942148828375214, 'loss_val': 0.789993134505165, 'psi': 0.7677071691683401}-{'f1_val': 0.5175221158708961, 'auprc': 0.7743267076210989, 'loss_val': 0.7928670612647051, 'psi': 0.6202439525709773}
[S17] START round=13 head_norm_before_train=1.846387 (no previous merge yet)
[S17] round=13 local utility u=0.000000 metrics={'f1_val': 0.6048255918541678, 'auprc': 0.8282154951421075, 'loss_val': 0.8506434355779585, 'psi': 0.6941815531693437}-{'f1_val': 0.590207761896737, 'auprc': 0.8830680166118332, 'loss_val': 0.7611924120883836, 'psi': 0.7073518637827754}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:49316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:49315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] → sending delta(kind=head bytes=1805) to S16@127.0.0.1:49316
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:49315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:49314
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:49309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:49309
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1804 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1805 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1805) from S5
[S16] cosine check vs S5: cos=0.8642
[S15] RECEIVED delta(kind=head bytes=1797) from S11
[S15] cosine check vs S11: cos=0.9153
[S16] RECEIVED delta(kind=head bytes=1804) from S9
[S16] cosine check vs S9: cos=0.5285
[S15] RECEIVED delta(kind=head bytes=1801) from S2
[S15] cosine check vs S2: cos=0.0839
[S8] RECEIVED delta(kind=head bytes=1798) from S6
[S8] cosine check vs S6: cos=0.9453
[S14] RECEIVED delta(kind=head bytes=1797) from S16
[S14] cosine check vs S16: cos=-0.1029
[S14] DROPPED delta from S16 (cos=-0.1029 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1801) from S14
[S8] cosine check vs S14: cos=-0.0389
[S8] DROPPED delta from S14 (cos=-0.0389 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=13 metric=0.9945 head_norm=1.386425
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.334047e-01
[S8] stored merged vector for next round verification (round=13)
[S8] DEBUG after merge:  round=13 metric=0.9950 head_norm=1.387163 delta_norm=0.233405
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=13 metric=0.7500 head_norm=1.111529
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.418999e-01
[S16] stored merged vector for next round verification (round=13)
[S16] DEBUG after merge:  round=13 metric=0.7513 head_norm=1.074322 delta_norm=0.141900
[S16] aggregate: ACCEPT kept=['S5', 'S9'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=13 metric=0.8721 head_norm=1.317488
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.627893e-01
[S15] stored merged vector for next round verification (round=13)
[S15] DEBUG after merge:  round=13 metric=0.8940 head_norm=1.078207 delta_norm=0.462789
[S15] aggregate: ACCEPT kept=['S11', 'S2'] (k=2/2) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.171161 cos_to_last_merge=0.9797 (last merge round=11)
[S2] round=14 local utility u=0.082575 metrics={'f1_val': 0.7094037862729883, 'auprc': 0.7853536667540469, 'loss_val': 0.45223772611132806, 'psi': 0.7397837384654118}-{'f1_val': 0.7082030175629204, 'auprc': 0.7295705860778872, 'loss_val': 0.4428332327099357, 'psi': 0.716750044968907}
[S3] START round=14 head_norm_before_train=1.272006 cos_to_last_merge=0.9968 (last merge round=12)
[S3] round=14 local utility u=0.839729 metrics={'f1_val': 0.6933101788356493, 'auprc': 0.999679661303319, 'loss_val': 0.46536135881275026, 'psi': 0.8158579718227172}-{'f1_val': 0.5367815047654385, 'auprc': 0.8119958710725521, 'loss_val': 0.6425953746816547, 'psi': 0.646867251288284}
[S4] START round=14 head_norm_before_train=1.577331 cos_to_last_merge=0.8930 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.893
[S4] round=14 local utility u=0.070318 metrics={'f1_val': 0.9437286258784889, 'auprc': 0.9500201430652213, 'loss_val': 0.27415271678848113, 'psi': 0.9462452327531818}-{'f1_val': 0.9376030122396111, 'auprc': 0.9214435868533544, 'loss_val': 0.2923058056824432, 'psi': 0.9311392420851083}
[S5] START round=14 head_norm_before_train=1.523080 (no previous merge yet)
[S5] round=14 local utility u=0.195702 metrics={'f1_val': 0.7011041183246911, 'auprc': 0.9043983503418817, 'loss_val': 0.36255063765452283, 'psi': 0.7824218111315673}-{'f1_val': 0.7011041183246911, 'auprc': 0.7919529066494626, 'loss_val': 0.41661922306353055, 'psi': 0.7374436336545998}
[S6] START round=14 head_norm_before_train=1.426612 cos_to_last_merge=0.8587 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.859
[S6] round=14 local utility u=0.000000 metrics={'f1_val': 0.46240304063871746, 'auprc': 0.7774164330284665, 'loss_val': 0.9003773789472039, 'psi': 0.588408397594617}-{'f1_val': 0.9604314091167473, 'auprc': 0.9743572136219265, 'loss_val': 0.20472106582691968, 'psi': 0.9660017309188189}
[S7] START round=14 head_norm_before_train=1.142384 cos_to_last_merge=0.8874 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.887
[S7] round=14 local utility u=0.004238 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.7812802606508933, 'loss_val': 0.7962765488088581, 'psi': 0.5625381751269714}-{'f1_val': 0.41671011811102343, 'auprc': 0.7808830325845558, 'loss_val': 0.8035603882726667, 'psi': 0.5623792839004365}
[S8] START round=14 head_norm_before_train=1.387163 cos_to_last_merge=1.0000 (last merge round=13)
[S8] round=14 local utility u=0.006629 metrics={'f1_val': 0.9952852018591252, 'auprc': 0.9928972918366026, 'loss_val': 0.20451042859120108, 'psi': 0.9943300378501161}-{'f1_val': 0.9945307733441335, 'auprc': 0.993263348754219, 'loss_val': 0.2143397239628247, 'psi': 0.9940238035081677}
[S9] START round=14 head_norm_before_train=1.370508 cos_to_last_merge=0.8546 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.855
[S9] round=14 local utility u=0.896526 metrics={'f1_val': 0.994994420763055, 'auprc': 0.9982160786977415, 'loss_val': 0.1418290835139231, 'psi': 0.9962830839369297}-{'f1_val': 0.7012165807733519, 'auprc': 0.9982299725002455, 'loss_val': 0.17225520880238426, 'psi': 0.8200219374641093}
[S10] START round=14 head_norm_before_train=1.224138 cos_to_last_merge=0.9975 (last merge round=12)
[S10] round=14 local utility u=0.032148 metrics={'f1_val': 0.9953473522358949, 'auprc': 0.997103197831195, 'loss_val': 0.11872751168161218, 'psi': 0.9960496904740149}-{'f1_val': 0.9951279124444816, 'auprc': 0.9973034717042976, 'loss_val': 0.18230716652533355, 'psi': 0.995998136148408}
[S11] START round=14 head_norm_before_train=1.465488 cos_to_last_merge=0.9985 (last merge round=12)
[S11] round=14 local utility u=0.043020 metrics={'f1_val': 0.7016282822309048, 'auprc': 0.9968315953662887, 'loss_val': 0.3455215965758333, 'psi': 0.8197096074850583}-{'f1_val': 0.7016282822309048, 'auprc': 0.9973015940309521, 'loss_val': 0.4329710412362024, 'psi': 0.8198976069509236}
[S13] START round=14 head_norm_before_train=1.304925 cos_to_last_merge=0.8177 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.818
[S13] round=14 local utility u=0.000000 metrics={'f1_val': 0.5646677298045752, 'auprc': 0.6917856860082215, 'loss_val': 0.9181587890539814, 'psi': 0.6155149122860337}-{'f1_val': 0.6174483383916616, 'auprc': 0.6598100746592963, 'loss_val': 0.6256461549015626, 'psi': 0.6343930328987155}
[S14] START round=14 head_norm_before_train=1.629379 (no previous merge yet)
[S14] round=14 local utility u=0.037208 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.999117512612479, 'loss_val': 0.11406674039043418, 'psi': 0.9980936016056885}-{'f1_val': 0.9974109942678281, 'auprc': 0.9991111443715525, 'loss_val': 0.18846373294622493, 'psi': 0.9980910543093179}
[S15] START round=14 head_norm_before_train=1.078207 cos_to_last_merge=1.0000 (last merge round=13)
[S15] round=14 local utility u=0.000000 metrics={'f1_val': 0.7723327170004455, 'auprc': 0.9438432985888814, 'loss_val': 0.44512111651986197, 'psi': 0.8409369496358199}-{'f1_val': 0.8721328633305594, 'auprc': 0.9433422371664109, 'loss_val': 0.39716914881319915, 'psi': 0.9006166128649}
[S16] START round=14 head_norm_before_train=1.074322 cos_to_last_merge=1.0000 (last merge round=13)
[S16] round=14 local utility u=0.025698 metrics={'f1_val': 0.7401267742708714, 'auprc': 0.811325287092219, 'loss_val': 0.7304775681537964, 'psi': 0.7686061793994103}-{'f1_val': 0.7500353600555526, 'auprc': 0.7942148828375214, 'loss_val': 0.789993134505165, 'psi': 0.7677071691683401}
[S17] START round=14 head_norm_before_train=1.902491 (no previous merge yet)
[S17] round=14 local utility u=0.141463 metrics={'f1_val': 0.6097510632679994, 'auprc': 0.9324167657800557, 'loss_val': 0.9098735254257958, 'psi': 0.738817344272822}-{'f1_val': 0.6048255918541678, 'auprc': 0.8282154951421075, 'loss_val': 0.8506434355779585, 'psi': 0.6941815531693437}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:49310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] → sending delta(kind=head bytes=1805) to S8@127.0.0.1:49309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:49302
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:49315
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:49303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:49316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:49310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:49316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:49314
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:49315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:49312
[S16] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1805 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1798) from S16
[S14] cosine check vs S16: cos=-0.1119
[S14] DROPPED delta from S16 (cos=-0.1119 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1798) from S4
[S11] cosine check vs S4: cos=0.9679
[S15] RECEIVED delta(kind=head bytes=1797) from S11
[S15] cosine check vs S11: cos=0.9200
[S16] RECEIVED delta(kind=head bytes=1802) from S5
[S16] cosine check vs S5: cos=0.8026
[S15] RECEIVED delta(kind=head bytes=1800) from S2
[S15] cosine check vs S2: cos=0.3332
[S3] RECEIVED delta(kind=head bytes=1797) from S7
[S3] cosine check vs S7: cos=0.2963
[S2] RECEIVED delta(kind=head bytes=1799) from S3
[S2] cosine check vs S3: cos=0.8903
[S9] RECEIVED delta(kind=head bytes=1803) from S8
[S9] cosine check vs S8: cos=0.0335
[S16] RECEIVED delta(kind=head bytes=1801) from S9
[S16] cosine check vs S9: cos=0.6230
[S9] RECEIVED delta(kind=head bytes=1800) from S10
[S9] cosine check vs S10: cos=-0.0789
[S9] DROPPED delta from S10 (cos=-0.0789 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1805) from S14
[S8] cosine check vs S14: cos=-0.0388
[S8] DROPPED delta from S14 (cos=-0.0388 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:49303
[S17] sending update (kind=head size=1801 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1801) from S17
[S3] cosine check vs S17: cos=0.9295
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=14 metric=0.7094 head_norm=1.229766
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.016452e-01
[S2] stored merged vector for next round verification (round=14)
[S2] DEBUG after merge:  round=14 metric=0.7081 head_norm=1.239026 delta_norm=0.301645
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=14 metric=0.6933 head_norm=1.319102
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.252483e-01
[S3] stored merged vector for next round verification (round=14)
[S3] DEBUG after merge:  round=14 metric=0.6858 head_norm=1.211475 delta_norm=0.225248
[S3] aggregate: ROLLBACK (f1_val pre=0.693 post=0.686 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=14 metric=0.9950 head_norm=1.404014
[S9] _apply_head_vector_avg (torch): Δ‖w‖=9.919803e-01
[S9] stored merged vector for next round verification (round=14)
[S9] DEBUG after merge:  round=14 metric=0.9967 head_norm=1.025790 delta_norm=0.991980
[S9] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=14 metric=0.7401 head_norm=1.123290
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.044710e-01
[S16] stored merged vector for next round verification (round=14)
[S16] DEBUG after merge:  round=14 metric=0.7468 head_norm=1.096217 delta_norm=0.104471
[S16] aggregate: ACCEPT kept=['S5', 'S9'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=14 metric=0.7016 head_norm=1.499539
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.026488e-01
[S11] stored merged vector for next round verification (round=14)
[S11] DEBUG after merge:  round=14 metric=0.7016 head_norm=1.537228 delta_norm=0.202649
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=14 metric=0.7723 head_norm=1.148763
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.953271e-01
[S15] stored merged vector for next round verification (round=14)
[S15] DEBUG after merge:  round=14 metric=0.7812 head_norm=1.055954 delta_norm=0.295327
[S15] aggregate: ACCEPT kept=['S11', 'S2'] (k=2/2) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.239026 cos_to_last_merge=1.0000 (last merge round=14)
[S2] round=15 local utility u=0.000000 metrics={'f1_val': 0.663314915562562, 'auprc': 0.7163715526692, 'loss_val': 0.7226514453955711, 'psi': 0.6845375704052172}-{'f1_val': 0.7094037862729883, 'auprc': 0.7853536667540469, 'loss_val': 0.45223772611132806, 'psi': 0.7397837384654118}
[S3] START round=15 head_norm_before_train=1.211475 cos_to_last_merge=1.0000 (last merge round=14)
[S3] round=15 local utility u=0.600140 metrics={'f1_val': 0.8847630765968323, 'auprc': 0.9991828627702954, 'loss_val': 0.4123077329914382, 'psi': 0.9305309910662176}-{'f1_val': 0.6933101788356493, 'auprc': 0.999679661303319, 'loss_val': 0.46536135881275026, 'psi': 0.8158579718227172}
[S4] START round=15 head_norm_before_train=1.599894 cos_to_last_merge=0.8903 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.890
[S4] round=15 local utility u=0.025285 metrics={'f1_val': 0.9438427518540247, 'auprc': 0.9664327885538777, 'loss_val': 0.2735049107235741, 'psi': 0.952878766533966}-{'f1_val': 0.9437286258784889, 'auprc': 0.9500201430652213, 'loss_val': 0.27415271678848113, 'psi': 0.9462452327531818}
[S5] START round=15 head_norm_before_train=1.551744 (no previous merge yet)
[S5] round=15 local utility u=0.115357 metrics={'f1_val': 0.7008558293524949, 'auprc': 0.9708347159194602, 'loss_val': 0.32965689970321876, 'psi': 0.808847383979281}-{'f1_val': 0.7011041183246911, 'auprc': 0.9043983503418817, 'loss_val': 0.36255063765452283, 'psi': 0.7824218111315673}
[S6] START round=15 head_norm_before_train=1.451372 cos_to_last_merge=0.8558 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.856
[S6] round=15 local utility u=1.000000 metrics={'f1_val': 0.8260506222394116, 'auprc': 0.9616199820573151, 'loss_val': 0.27184541994695577, 'psi': 0.880278366166573}-{'f1_val': 0.46240304063871746, 'auprc': 0.7774164330284665, 'loss_val': 0.9003773789472039, 'psi': 0.588408397594617}
[S7] START round=15 head_norm_before_train=1.162434 cos_to_last_merge=0.8776 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.878
[S7] round=15 local utility u=0.000000 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.7815125483771441, 'loss_val': 0.8027288100616787, 'psi': 0.5626310902174717}-{'f1_val': 0.41671011811102343, 'auprc': 0.7812802606508933, 'loss_val': 0.7962765488088581, 'psi': 0.5625381751269714}
[S8] START round=15 head_norm_before_train=1.449580 cos_to_last_merge=0.9966 (last merge round=13)
[S8] round=15 local utility u=0.026458 metrics={'f1_val': 0.9943637249162036, 'auprc': 0.9917188753576744, 'loss_val': 0.1425294515429516, 'psi': 0.9933057850927919}-{'f1_val': 0.9952852018591252, 'auprc': 0.9928972918366026, 'loss_val': 0.20451042859120108, 'psi': 0.9943300378501161}
[S9] START round=15 head_norm_before_train=1.025790 cos_to_last_merge=1.0000 (last merge round=14)
[S9] round=15 local utility u=0.000000 metrics={'f1_val': 0.9359460969520482, 'auprc': 0.9796697989047012, 'loss_val': 0.37994062299764125, 'psi': 0.9534355777331094}-{'f1_val': 0.994994420763055, 'auprc': 0.9982160786977415, 'loss_val': 0.1418290835139231, 'psi': 0.9962830839369297}
[S10] START round=15 head_norm_before_train=1.303903 cos_to_last_merge=0.9894 (last merge round=12)
[S10] round=15 local utility u=0.018809 metrics={'f1_val': 0.9957620514467445, 'auprc': 0.9967682970364732, 'loss_val': 0.08259287214477225, 'psi': 0.996164549682636}-{'f1_val': 0.9953473522358949, 'auprc': 0.997103197831195, 'loss_val': 0.11872751168161218, 'psi': 0.9960496904740149}
[S11] START round=15 head_norm_before_train=1.537228 cos_to_last_merge=1.0000 (last merge round=14)
[S11] round=15 local utility u=0.752264 metrics={'f1_val': 0.9552034538751127, 'auprc': 0.9967845828179743, 'loss_val': 0.3623035225003779, 'psi': 0.9718359054522574}-{'f1_val': 0.7016282822309048, 'auprc': 0.9968315953662887, 'loss_val': 0.3455215965758333, 'psi': 0.8197096074850583}
[S13] START round=15 head_norm_before_train=1.316357 cos_to_last_merge=0.8145 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.814
[S13] round=15 local utility u=0.377677 metrics={'f1_val': 0.6522279748196878, 'auprc': 0.6395140714076911, 'loss_val': 0.5313509336787339, 'psi': 0.6471424134548891}-{'f1_val': 0.5646677298045752, 'auprc': 0.6917856860082215, 'loss_val': 0.9181587890539814, 'psi': 0.6155149122860337}
[S14] START round=15 head_norm_before_train=1.677730 (no previous merge yet)
[S14] round=15 local utility u=0.013985 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9991225444015233, 'loss_val': 0.08609595318625185, 'psi': 0.9980939794616447}-{'f1_val': 0.9974109942678281, 'auprc': 0.999117512612479, 'loss_val': 0.11406674039043418, 'psi': 0.9980936016056885}
[S15] START round=15 head_norm_before_train=1.055954 cos_to_last_merge=1.0000 (last merge round=14)
[S15] round=15 local utility u=0.783556 metrics={'f1_val': 0.9927410160998904, 'auprc': 0.9920744486430287, 'loss_val': 0.34515257231023555, 'psi': 0.9924743891171458}-{'f1_val': 0.7723327170004455, 'auprc': 0.9438432985888814, 'loss_val': 0.44512111651986197, 'psi': 0.8409369496358199}
[S16] START round=15 head_norm_before_train=1.096217 cos_to_last_merge=1.0000 (last merge round=14)
[S16] round=15 local utility u=0.446665 metrics={'f1_val': 0.8477784943605761, 'auprc': 0.8718239639698984, 'loss_val': 0.6645544962579073, 'psi': 0.8573966822043049}-{'f1_val': 0.7401267742708714, 'auprc': 0.811325287092219, 'loss_val': 0.7304775681537964, 'psi': 0.7686061793994103}
[S17] START round=15 head_norm_before_train=1.940672 (no previous merge yet)
[S17] round=15 local utility u=0.000000 metrics={'f1_val': 0.6285683547481539, 'auprc': 0.8318256368836776, 'loss_val': 1.0301386498966612, 'psi': 0.7098712676023633}-{'f1_val': 0.6097510632679994, 'auprc': 0.9324167657800557, 'loss_val': 0.9098735254257958, 'psi': 0.738817344272822}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:49315
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:49312
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] → sending delta(kind=head bytes=1794) to S10@127.0.0.1:49311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] → sending delta(kind=head bytes=1805) to S14@127.0.0.1:49314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:49310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] → sending delta(kind=head bytes=1805) to S16@127.0.0.1:49316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:49309
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:49309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:49310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S3] → sending delta(kind=head bytes=1791) to S2@127.0.0.1:49302
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:49305
[S3] sending update (kind=head size=1791 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1804 to 1 peers)
[S5] sending update (kind=head size=1805 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1805 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1794 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1802) from S10
[S9] cosine check vs S10: cos=0.3534
[S9] RECEIVED delta(kind=head bytes=1800) from S8
[S9] cosine check vs S8: cos=0.7002
[S15] RECEIVED delta(kind=head bytes=1797) from S11
[S15] cosine check vs S11: cos=0.8706
[S16] RECEIVED delta(kind=head bytes=1805) from S5
[S16] cosine check vs S5: cos=0.7689
[S14] RECEIVED delta(kind=head bytes=1805) from S16
[S14] cosine check vs S16: cos=-0.1158
[S14] DROPPED delta from S16 (cos=-0.1158 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1797) from S15
[S5] cosine check vs S15: cos=-0.0744
[S5] DROPPED delta from S15 (cos=-0.0744 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1796) from S4
[S11] cosine check vs S4: cos=0.9863
[S2] RECEIVED delta(kind=head bytes=1791) from S3
[S2] cosine check vs S3: cos=0.9469
[S8] RECEIVED delta(kind=head bytes=1803) from S6
[S8] cosine check vs S6: cos=0.9516
[S8] RECEIVED delta(kind=head bytes=1804) from S14
[S8] cosine check vs S14: cos=-0.0422
[S8] DROPPED delta from S14 (cos=-0.0422 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1794) from S13
[S10] cosine check vs S13: cos=0.8760
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] ⇄ pheromone p=0.093 → S3@127.0.0.1:49303
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=15 metric=0.6633 head_norm=1.301910
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.095877e-01
[S2] stored merged vector for next round verification (round=15)
[S2] DEBUG after merge:  round=15 metric=0.6246 head_norm=1.261054 delta_norm=0.209588
[S2] aggregate: ROLLBACK (f1_val pre=0.663 post=0.625 tol_abs=0.005 tol_rel=0.0)
[S2] ⇄ pheromone p=0.158 → S15@127.0.0.1:49315
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=15 metric=0.9359 head_norm=1.060503
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.406668e-01
[S9] stored merged vector for next round verification (round=15)
[S9] DEBUG after merge:  round=15 metric=0.5086 head_norm=1.056578 delta_norm=0.540667
[S9] aggregate: ROLLBACK (f1_val pre=0.936 post=0.509 tol_abs=0.005 tol_rel=0.0)
[S9] ⇄ pheromone p=0.329 → S16@127.0.0.1:49316
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=15 metric=0.9958 head_norm=1.378827
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.376338e-01
[S10] stored merged vector for next round verification (round=15)
[S10] DEBUG after merge:  round=15 metric=0.9951 head_norm=1.309743 delta_norm=0.337634
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.166 → S9@127.0.0.1:49310
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=15 metric=0.8478 head_norm=1.145984
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.046610e-01
[S16] stored merged vector for next round verification (round=15)
[S16] DEBUG after merge:  round=15 metric=0.8304 head_norm=1.281723 delta_norm=0.504661
[S16] aggregate: ROLLBACK (f1_val pre=0.848 post=0.830 tol_abs=0.005 tol_rel=0.0)
[S16] ⇄ pheromone p=0.323 → S14@127.0.0.1:49314
[S6] ⇄ pheromone p=0.519 → S8@127.0.0.1:49309
[S3] ⇄ pheromone p=0.435 → S2@127.0.0.1:49302
[S13] ⇄ pheromone p=0.188 → S10@127.0.0.1:49311
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=15 metric=0.9552 head_norm=1.565374
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.344559e-01
[S11] stored merged vector for next round verification (round=15)
[S11] DEBUG after merge:  round=15 metric=0.9554 head_norm=1.586339 delta_norm=0.134456
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.268 → S15@127.0.0.1:49315
[S14] ⇄ pheromone p=0.198 → S8@127.0.0.1:49309
[S4] ⇄ pheromone p=0.178 → S11@127.0.0.1:49312
[S5] ⇄ pheromone p=0.169 → S16@127.0.0.1:49316
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=15 metric=0.9927 head_norm=1.132322
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.020025e-01
[S15] stored merged vector for next round verification (round=15)
[S15] DEBUG after merge:  round=15 metric=0.9936 head_norm=1.305629 delta_norm=0.402003
[S15] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.414 → S5@127.0.0.1:49305
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=15 metric=0.9944 head_norm=1.523522
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.343411e-01
[S8] stored merged vector for next round verification (round=15)
[S8] DEBUG after merge:  round=15 metric=0.9940 head_norm=1.477692 delta_norm=0.234341
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.200 → S9@127.0.0.1:49310
[S17] ⇄ pheromone p=0.156 → S3@127.0.0.1:49303
[S2] START round=16 head_norm_before_train=1.261054 cos_to_last_merge=1.0000 (last merge round=15)
[S2] round=16 local utility u=0.183790 metrics={'f1_val': 0.6804562844177913, 'auprc': 0.7681119088690891, 'loss_val': 0.6131408394377876, 'psi': 0.7155185341983104}-{'f1_val': 0.663314915562562, 'auprc': 0.7163715526692, 'loss_val': 0.7226514453955711, 'psi': 0.6845375704052172}
[S3] START round=16 head_norm_before_train=1.254352 cos_to_last_merge=0.9983 (last merge round=14)
[S3] round=16 local utility u=0.000000 metrics={'f1_val': 0.5163239625808149, 'auprc': 0.8102621624471209, 'loss_val': 0.5766338699811764, 'psi': 0.6338992425273373}-{'f1_val': 0.8847630765968323, 'auprc': 0.9991828627702954, 'loss_val': 0.4123077329914382, 'psi': 0.9305309910662176}
[S4] START round=16 head_norm_before_train=1.618240 cos_to_last_merge=0.8885 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.889
[S4] round=16 local utility u=0.000000 metrics={'f1_val': 0.9406587978156354, 'auprc': 0.9619544405687039, 'loss_val': 0.2793949081366253, 'psi': 0.9491770549168628}-{'f1_val': 0.9438427518540247, 'auprc': 0.9664327885538777, 'loss_val': 0.2735049107235741, 'psi': 0.952878766533966}
[S5] START round=16 head_norm_before_train=1.575346 (no previous merge yet)
[S5] round=16 local utility u=0.057311 metrics={'f1_val': 0.7008563225598777, 'auprc': 0.998099191034412, 'loss_val': 0.29683064036307366, 'psi': 0.8197534699496914}-{'f1_val': 0.7008558293524949, 'auprc': 0.9708347159194602, 'loss_val': 0.32965689970321876, 'psi': 0.808847383979281}
[S6] START round=16 head_norm_before_train=1.468285 cos_to_last_merge=0.8537 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.854
[S6] round=16 local utility u=0.350391 metrics={'f1_val': 0.9273565220266649, 'auprc': 0.9708491455069195, 'loss_val': 0.20658551949313808, 'psi': 0.9447535714187667}-{'f1_val': 0.8260506222394116, 'auprc': 0.9616199820573151, 'loss_val': 0.27184541994695577, 'psi': 0.880278366166573}
[S7] START round=16 head_norm_before_train=1.181145 cos_to_last_merge=0.8698 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.870
[S7] round=16 local utility u=0.000000 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.6809110932488942, 'loss_val': 0.781120635424398, 'psi': 0.5223905081661717}-{'f1_val': 0.41671011811102343, 'auprc': 0.7815125483771441, 'loss_val': 0.8027288100616787, 'psi': 0.5626310902174717}
[S8] START round=16 head_norm_before_train=1.477692 cos_to_last_merge=1.0000 (last merge round=15)
[S8] round=16 local utility u=0.000000 metrics={'f1_val': 0.9924851457271406, 'auprc': 0.9862705651942175, 'loss_val': 0.16744762982848202, 'psi': 0.9899993135139713}-{'f1_val': 0.9943637249162036, 'auprc': 0.9917188753576744, 'loss_val': 0.1425294515429516, 'psi': 0.9933057850927919}
[S9] START round=16 head_norm_before_train=1.056578 cos_to_last_merge=1.0000 (last merge round=15)
[S9] round=16 local utility u=0.089843 metrics={'f1_val': 0.9941601000394567, 'auprc': 0.9986162844833579, 'loss_val': 0.6063773566899144, 'psi': 0.9959425738170171}-{'f1_val': 0.9359460969520482, 'auprc': 0.9796697989047012, 'loss_val': 0.37994062299764125, 'psi': 0.9534355777331094}
[S10] START round=16 head_norm_before_train=1.309743 cos_to_last_merge=1.0000 (last merge round=15)
[S10] round=16 local utility u=0.000000 metrics={'f1_val': 0.995804838087278, 'auprc': 0.9975375494663243, 'loss_val': 0.1052944837313999, 'psi': 0.9964979226388966}-{'f1_val': 0.9957620514467445, 'auprc': 0.9967682970364732, 'loss_val': 0.08259287214477225, 'psi': 0.996164549682636}
[S11] START round=16 head_norm_before_train=1.586339 cos_to_last_merge=1.0000 (last merge round=15)
[S11] round=16 local utility u=0.026342 metrics={'f1_val': 0.9580281394601605, 'auprc': 0.9956927978821521, 'loss_val': 0.3232918761920975, 'psi': 0.9730940028289572}-{'f1_val': 0.9552034538751127, 'auprc': 0.9967845828179743, 'loss_val': 0.3623035225003779, 'psi': 0.9718359054522574}
[S13] START round=16 head_norm_before_train=1.325777 cos_to_last_merge=0.8141 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.814
[S13] round=16 local utility u=0.000000 metrics={'f1_val': 0.5879465124893806, 'auprc': 0.6866779487234675, 'loss_val': 0.772861183313152, 'psi': 0.6274390869830153}-{'f1_val': 0.6522279748196878, 'auprc': 0.6395140714076911, 'loss_val': 0.5313509336787339, 'psi': 0.6471424134548891}
[S14] START round=16 head_norm_before_train=1.721393 (no previous merge yet)
[S14] round=16 local utility u=0.009349 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.999111918849341, 'loss_val': 0.06736687058745984, 'psi': 0.9980897292407718}-{'f1_val': 0.9974082695017256, 'auprc': 0.9991225444015233, 'loss_val': 0.08609595318625185, 'psi': 0.9980939794616447}
[S15] START round=16 head_norm_before_train=1.305629 cos_to_last_merge=1.0000 (last merge round=15)
[S15] round=16 local utility u=0.000000 metrics={'f1_val': 0.9217365792403558, 'auprc': 0.9924565881741131, 'loss_val': 0.28038149401920553, 'psi': 0.9500245828138587}-{'f1_val': 0.9927410160998904, 'auprc': 0.9920744486430287, 'loss_val': 0.34515257231023555, 'psi': 0.9924743891171458}
[S16] START round=16 head_norm_before_train=1.281723 cos_to_last_merge=1.0000 (last merge round=15)
[S16] round=16 local utility u=0.000000 metrics={'f1_val': 0.7972661824466931, 'auprc': 0.8839341197468923, 'loss_val': 0.6047443358864311, 'psi': 0.8319333573667729}-{'f1_val': 0.8477784943605761, 'auprc': 0.8718239639698984, 'loss_val': 0.6645544962579073, 'psi': 0.8573966822043049}
[S17] START round=16 head_norm_before_train=1.968450 (no previous merge yet)
[S17] round=16 local utility u=0.000000 metrics={'f1_val': 0.6088363921681899, 'auprc': 0.8232944497563158, 'loss_val': 1.2336891058433916, 'psi': 0.6946196152034403}-{'f1_val': 0.6285683547481539, 'auprc': 0.8318256368836776, 'loss_val': 1.0301386498966612, 'psi': 0.7098712676023633}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S5] → sending delta(kind=head bytes=1808) to S16@127.0.0.1:49316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:49309
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:49315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:49316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:49315
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:49309
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1795 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1803 to 1 peers)
[S2] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1794 to 1 peers)
[S5] sending update (kind=head size=1808 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1794) from S14
[S8] cosine check vs S14: cos=-0.0442
[S8] DROPPED delta from S14 (cos=-0.0442 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1808) from S5
[S16] cosine check vs S5: cos=0.9450
[S16] RECEIVED delta(kind=head bytes=1797) from S9
[S16] cosine check vs S9: cos=0.1080
[S8] RECEIVED delta(kind=head bytes=1803) from S6
[S8] cosine check vs S6: cos=0.9763
[S15] RECEIVED delta(kind=head bytes=1795) from S11
[S15] cosine check vs S11: cos=0.9535
[S15] RECEIVED delta(kind=head bytes=1803) from S2
[S15] cosine check vs S2: cos=0.2912
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=16 metric=0.9217 head_norm=1.373907
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.578020e-01
[S15] stored merged vector for next round verification (round=16)
[S15] DEBUG after merge:  round=16 metric=0.9713 head_norm=1.202925 delta_norm=0.357802
[S15] aggregate: ACCEPT kept=['S11', 'S2'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=16 metric=0.9925 head_norm=1.540771
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.669880e-01
[S8] stored merged vector for next round verification (round=16)
[S8] DEBUG after merge:  round=16 metric=0.9378 head_norm=1.506424 delta_norm=0.166988
[S8] aggregate: ROLLBACK (f1_val pre=0.992 post=0.938 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=16 metric=0.7973 head_norm=1.322403
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.588814e-01
[S16] stored merged vector for next round verification (round=16)
[S16] DEBUG after merge:  round=16 metric=0.8047 head_norm=1.099030 delta_norm=0.358881
[S16] aggregate: ACCEPT kept=['S5', 'S9'] (k=2/2) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.307013 cos_to_last_merge=0.9978 (last merge round=15)
[S2] round=17 local utility u=0.000000 metrics={'f1_val': 0.6512790634429402, 'auprc': 0.6916505187192554, 'loss_val': 0.7211834794814261, 'psi': 0.6674276455534662}-{'f1_val': 0.6804562844177913, 'auprc': 0.7681119088690891, 'loss_val': 0.6131408394377876, 'psi': 0.7155185341983104}
[S3] START round=17 head_norm_before_train=1.298531 cos_to_last_merge=0.9944 (last merge round=14)
[S3] round=17 local utility u=0.805078 metrics={'f1_val': 0.6973906640686207, 'auprc': 0.9081101917265781, 'loss_val': 0.3464219757257846, 'psi': 0.7816784751318038}-{'f1_val': 0.5163239625808149, 'auprc': 0.8102621624471209, 'loss_val': 0.5766338699811764, 'psi': 0.6338992425273373}
[S4] START round=17 head_norm_before_train=1.645945 cos_to_last_merge=0.8848 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.885
[S4] round=17 local utility u=0.000000 metrics={'f1_val': 0.9392640358158979, 'auprc': 0.9340231547980715, 'loss_val': 0.3049308939552265, 'psi': 0.9371676834087673}-{'f1_val': 0.9406587978156354, 'auprc': 0.9619544405687039, 'loss_val': 0.2793949081366253, 'psi': 0.9491770549168628}
[S5] START round=17 head_norm_before_train=1.603532 (no previous merge yet)
[S5] round=17 local utility u=0.000000 metrics={'f1_val': 0.7009315714961832, 'auprc': 0.9433216528954484, 'loss_val': 0.29205109547246066, 'psi': 0.7978876040558893}-{'f1_val': 0.7008563225598777, 'auprc': 0.998099191034412, 'loss_val': 0.29683064036307366, 'psi': 0.8197534699496914}
[S6] START round=17 head_norm_before_train=1.490108 cos_to_last_merge=0.8508 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.851
[S6] round=17 local utility u=0.000000 metrics={'f1_val': 0.6455484253637117, 'auprc': 0.8121888901281191, 'loss_val': 0.5123248920624821, 'psi': 0.7122046112694747}-{'f1_val': 0.9273565220266649, 'auprc': 0.9708491455069195, 'loss_val': 0.20658551949313808, 'psi': 0.9447535714187667}
[S7] START round=17 head_norm_before_train=1.201137 cos_to_last_merge=0.8636 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.864
[S7] round=17 local utility u=0.877167 metrics={'f1_val': 0.6634369750763323, 'auprc': 0.7713040272521889, 'loss_val': 0.7783264812554566, 'psi': 0.706583795946675}-{'f1_val': 0.41671011811102343, 'auprc': 0.6809110932488942, 'loss_val': 0.781120635424398, 'psi': 0.5223905081661717}
[S8] START round=17 head_norm_before_train=1.506424 cos_to_last_merge=1.0000 (last merge round=16)
[S8] round=17 local utility u=0.000000 metrics={'f1_val': 0.9860892612913941, 'auprc': 0.9973388520557711, 'loss_val': 0.19221213153407038, 'psi': 0.990589097597145}-{'f1_val': 0.9924851457271406, 'auprc': 0.9862705651942175, 'loss_val': 0.16744762982848202, 'psi': 0.9899993135139713}
[S9] START round=17 head_norm_before_train=1.079342 cos_to_last_merge=0.9963 (last merge round=15)
[S9] round=17 local utility u=0.091871 metrics={'f1_val': 0.9903686845626269, 'auprc': 0.998333974001244, 'loss_val': 0.3990405507843323, 'psi': 0.9935548003380739}-{'f1_val': 0.9941601000394567, 'auprc': 0.9986162844833579, 'loss_val': 0.6063773566899144, 'psi': 0.9959425738170171}
[S10] START round=17 head_norm_before_train=1.383166 cos_to_last_merge=0.9975 (last merge round=15)
[S10] round=17 local utility u=0.015343 metrics={'f1_val': 0.9953900010273877, 'auprc': 0.9975179199085751, 'loss_val': 0.07206097661904348, 'psi': 0.9962411685798627}-{'f1_val': 0.995804838087278, 'auprc': 0.9975375494663243, 'loss_val': 0.1052944837313999, 'psi': 0.9964979226388966}
[S11] START round=17 head_norm_before_train=1.614489 cos_to_last_merge=0.9989 (last merge round=15)
[S11] round=17 local utility u=0.037304 metrics={'f1_val': 0.9590353542760256, 'auprc': 0.9959228578527229, 'loss_val': 0.25541744221953516, 'psi': 0.9737903557067045}-{'f1_val': 0.9580281394601605, 'auprc': 0.9956927978821521, 'loss_val': 0.3232918761920975, 'psi': 0.9730940028289572}
[S13] START round=17 head_norm_before_train=1.336159 cos_to_last_merge=0.8120 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.812
[S13] round=17 local utility u=0.000000 metrics={'f1_val': 0.5598558597039807, 'auprc': 0.6937231291400927, 'loss_val': 0.9434437782317792, 'psi': 0.6134027674784255}-{'f1_val': 0.5879465124893806, 'auprc': 0.6866779487234675, 'loss_val': 0.772861183313152, 'psi': 0.6274390869830153}
[S14] START round=17 head_norm_before_train=1.760655 (no previous merge yet)
[S14] round=17 local utility u=0.007756 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9989781045831694, 'loss_val': 0.05146927187390482, 'psi': 0.9980378383939646}-{'f1_val': 0.9974082695017256, 'auprc': 0.999111918849341, 'loss_val': 0.06736687058745984, 'psi': 0.9980897292407718}
[S15] START round=17 head_norm_before_train=1.202925 cos_to_last_merge=1.0000 (last merge round=16)
[S15] round=17 local utility u=0.000000 metrics={'f1_val': 0.88854715251146, 'auprc': 0.9899853570952742, 'loss_val': 0.3403953762755739, 'psi': 0.9291224343449858}-{'f1_val': 0.9217365792403558, 'auprc': 0.9924565881741131, 'loss_val': 0.28038149401920553, 'psi': 0.9500245828138587}
[S16] START round=17 head_norm_before_train=1.099030 cos_to_last_merge=1.0000 (last merge round=16)
[S16] round=17 local utility u=0.055091 metrics={'f1_val': 0.8089327291835177, 'auprc': 0.9026264952409992, 'loss_val': 0.6206382719617626, 'psi': 0.8464102356065103}-{'f1_val': 0.7972661824466931, 'auprc': 0.8839341197468923, 'loss_val': 0.6047443358864311, 'psi': 0.8319333573667729}
[S17] START round=17 head_norm_before_train=1.984914 (no previous merge yet)
[S17] round=17 local utility u=0.118578 metrics={'f1_val': 0.6163376505631771, 'auprc': 0.8859887541784565, 'loss_val': 1.2296232252856594, 'psi': 0.7241980920092889}-{'f1_val': 0.6088363921681899, 'auprc': 0.8232944497563158, 'loss_val': 1.2336891058433916, 'psi': 0.6946196152034403}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:49316
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:49309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S15@127.0.0.1:49315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S7] → sending delta(kind=head bytes=1793) to S3@127.0.0.1:49303
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:49310
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:49314
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:49302
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1793 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1794 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1799) from S3
[S2] cosine check vs S3: cos=0.9626
[S15] RECEIVED delta(kind=head bytes=1794) from S11
[S15] cosine check vs S11: cos=0.9156
[S14] RECEIVED delta(kind=head bytes=1798) from S16
[S14] cosine check vs S16: cos=-0.1018
[S14] DROPPED delta from S16 (cos=-0.1018 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1803) from S9
[S16] cosine check vs S9: cos=0.3278
[S9] RECEIVED delta(kind=head bytes=1800) from S10
[S9] cosine check vs S10: cos=0.6518
[S3] RECEIVED delta(kind=head bytes=1793) from S7
[S3] cosine check vs S7: cos=0.3712
[S8] RECEIVED delta(kind=head bytes=1803) from S14
[S8] cosine check vs S14: cos=-0.0451
[S8] DROPPED delta from S14 (cos=-0.0451 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:49303
[S17] sending update (kind=head size=1798 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1798) from S17
[S3] cosine check vs S17: cos=0.8931
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=17 metric=0.6513 head_norm=1.348092
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.842691e-01
[S2] stored merged vector for next round verification (round=17)
[S2] DEBUG after merge:  round=17 metric=0.6320 head_norm=1.334504 delta_norm=0.184269
[S2] aggregate: ROLLBACK (f1_val pre=0.651 post=0.632 tol_abs=0.005 tol_rel=0.0)
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=17 metric=0.6974 head_norm=1.346240
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.114512e-01
[S3] stored merged vector for next round verification (round=17)
[S3] DEBUG after merge:  round=17 metric=0.6991 head_norm=1.246085 delta_norm=0.211451
[S3] aggregate: ACCEPT kept=['S7', 'S17'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=17 metric=0.9904 head_norm=1.114593
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.581369e-01
[S9] stored merged vector for next round verification (round=17)
[S9] DEBUG after merge:  round=17 metric=0.6308 head_norm=1.169992 delta_norm=0.558137
[S9] aggregate: ROLLBACK (f1_val pre=0.990 post=0.631 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=17 metric=0.8089 head_norm=1.141667
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.541266e-01
[S16] stored merged vector for next round verification (round=17)
[S16] DEBUG after merge:  round=17 metric=0.6816 head_norm=0.919228 delta_norm=0.654127
[S16] aggregate: ROLLBACK (f1_val pre=0.809 post=0.682 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=17 metric=0.8885 head_norm=1.275183
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.503194e-01
[S15] stored merged vector for next round verification (round=17)
[S15] DEBUG after merge:  round=17 metric=0.8737 head_norm=1.429404 delta_norm=0.350319
[S15] aggregate: ROLLBACK (f1_val pre=0.889 post=0.874 tol_abs=0.005 tol_rel=0.0)
[S2] START round=18 head_norm_before_train=1.334504 cos_to_last_merge=1.0000 (last merge round=17)
[S2] round=18 local utility u=0.369501 metrics={'f1_val': 0.6969595344504746, 'auprc': 0.7737418029287343, 'loss_val': 0.5025373591924176, 'psi': 0.7276724418417786}-{'f1_val': 0.6512790634429402, 'auprc': 0.6916505187192554, 'loss_val': 0.7211834794814261, 'psi': 0.6674276455534662}
[S3] START round=18 head_norm_before_train=1.246085 cos_to_last_merge=1.0000 (last merge round=17)
[S3] round=18 local utility u=1.000000 metrics={'f1_val': 0.997785879834771, 'auprc': 0.9991231839227097, 'loss_val': 0.2615597916158948, 'psi': 0.9983208014699465}-{'f1_val': 0.6973906640686207, 'auprc': 0.9081101917265781, 'loss_val': 0.3464219757257846, 'psi': 0.7816784751318038}
[S4] START round=18 head_norm_before_train=1.669664 cos_to_last_merge=0.8822 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.882
[S4] round=18 local utility u=0.056798 metrics={'f1_val': 0.9410567516284438, 'auprc': 0.9625031612234203, 'loss_val': 0.28753070316840584, 'psi': 0.9496353154664344}-{'f1_val': 0.9392640358158979, 'auprc': 0.9340231547980715, 'loss_val': 0.3049308939552265, 'psi': 0.9371676834087673}
[S5] START round=18 head_norm_before_train=1.628864 (no previous merge yet)
[S5] round=18 local utility u=0.090768 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9980840168236406, 'loss_val': 0.2728639931777313, 'psi': 0.8195986423270608}-{'f1_val': 0.7009315714961832, 'auprc': 0.9433216528954484, 'loss_val': 0.29205109547246066, 'psi': 0.7978876040558893}
[S6] START round=18 head_norm_before_train=1.514603 cos_to_last_merge=0.8483 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.848
[S6] round=18 local utility u=0.000000 metrics={'f1_val': 0.6042146691112128, 'auprc': 0.7648963691539061, 'loss_val': 0.6910138534387399, 'psi': 0.6684873491282901}-{'f1_val': 0.6455484253637117, 'auprc': 0.8121888901281191, 'loss_val': 0.5123248920624821, 'psi': 0.7122046112694747}
[S7] START round=18 head_norm_before_train=1.218184 cos_to_last_merge=0.8581 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.858
[S7] round=18 local utility u=0.000000 metrics={'f1_val': 0.40411966904611696, 'auprc': 0.7646927377730836, 'loss_val': 0.7979641255159003, 'psi': 0.5483488965369037}-{'f1_val': 0.6634369750763323, 'auprc': 0.7713040272521889, 'loss_val': 0.7783264812554566, 'psi': 0.706583795946675}
[S8] START round=18 head_norm_before_train=1.560796 cos_to_last_merge=0.9986 (last merge round=16)
[S8] round=18 local utility u=0.065384 metrics={'f1_val': 0.993632801855294, 'auprc': 0.9986107861523383, 'loss_val': 0.11052183288267017, 'psi': 0.9956239955741117}-{'f1_val': 0.9860892612913941, 'auprc': 0.9973388520557711, 'loss_val': 0.19221213153407038, 'psi': 0.990589097597145}
[S9] START round=18 head_norm_before_train=1.169992 cos_to_last_merge=1.0000 (last merge round=17)
[S9] round=18 local utility u=0.000000 metrics={'f1_val': 0.9865404245545528, 'auprc': 0.9967840929289924, 'loss_val': 0.6817547073375686, 'psi': 0.9906378919043286}-{'f1_val': 0.9903686845626269, 'auprc': 0.998333974001244, 'loss_val': 0.3990405507843323, 'psi': 0.9935548003380739}
[S10] START round=18 head_norm_before_train=1.455500 cos_to_last_merge=0.9924 (last merge round=15)
[S10] round=18 local utility u=0.008576 metrics={'f1_val': 0.9951279124444816, 'auprc': 0.9979901630756207, 'loss_val': 0.0547535850206437, 'psi': 0.9962728126969372}-{'f1_val': 0.9953900010273877, 'auprc': 0.9975179199085751, 'loss_val': 0.07206097661904348, 'psi': 0.9962411685798627}
[S11] START round=18 head_norm_before_train=1.644915 cos_to_last_merge=0.9964 (last merge round=15)
[S11] round=18 local utility u=0.033861 metrics={'f1_val': 0.9637126475429929, 'auprc': 0.9967631583377127, 'loss_val': 0.21827912488656956, 'psi': 0.9769328518608809}-{'f1_val': 0.9590353542760256, 'auprc': 0.9959228578527229, 'loss_val': 0.25541744221953516, 'psi': 0.9737903557067045}
[S13] START round=18 head_norm_before_train=1.347300 cos_to_last_merge=0.8108 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.811
[S13] round=18 local utility u=0.166766 metrics={'f1_val': 0.611069828337333, 'auprc': 0.6037036266638569, 'loss_val': 0.6471378471988658, 'psi': 0.6081233476679426}-{'f1_val': 0.5598558597039807, 'auprc': 0.6937231291400927, 'loss_val': 0.9434437782317792, 'psi': 0.6134027674784255}
[S14] START round=18 head_norm_before_train=1.793505 (no previous merge yet)
[S14] round=18 local utility u=0.000000 metrics={'f1_val': 0.9674992315946077, 'auprc': 0.9990497105956382, 'loss_val': 0.06667148317913967, 'psi': 0.9801194231950199}-{'f1_val': 0.9974109942678281, 'auprc': 0.9989781045831694, 'loss_val': 0.05146927187390482, 'psi': 0.9980378383939646}
[S15] START round=18 head_norm_before_train=1.429404 cos_to_last_merge=1.0000 (last merge round=17)
[S15] round=18 local utility u=0.079282 metrics={'f1_val': 0.8997669879710237, 'auprc': 0.9919879293648896, 'loss_val': 0.2551584019212718, 'psi': 0.93665536452857}-{'f1_val': 0.88854715251146, 'auprc': 0.9899853570952742, 'loss_val': 0.3403953762755739, 'psi': 0.9291224343449858}
[S16] START round=18 head_norm_before_train=0.919228 cos_to_last_merge=1.0000 (last merge round=17)
[S16] round=18 local utility u=0.399283 metrics={'f1_val': 0.9217165438130113, 'auprc': 0.9292994511323114, 'loss_val': 0.5787939251268609, 'psi': 0.9247497067407313}-{'f1_val': 0.8089327291835177, 'auprc': 0.9026264952409992, 'loss_val': 0.6206382719617626, 'psi': 0.8464102356065103}
[S17] START round=18 head_norm_before_train=2.002165 (no previous merge yet)
[S17] round=18 local utility u=0.335594 metrics={'f1_val': 0.6464275438314641, 'auprc': 0.9741112908506848, 'loss_val': 1.003342314634588, 'psi': 0.7775010426391524}-{'f1_val': 0.6163376505631771, 'auprc': 0.8859887541784565, 'loss_val': 1.2296232252856594, 'psi': 0.7241980920092889}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:49314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:49315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:49311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:49310
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:49310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:49312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:49302
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] → sending delta(kind=head bytes=1805) to S16@127.0.0.1:49316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:49315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:49305
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1805 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1800) from S2
[S15] cosine check vs S2: cos=0.2906
[S15] RECEIVED delta(kind=head bytes=1802) from S11
[S15] cosine check vs S11: cos=0.9738
[S9] RECEIVED delta(kind=head bytes=1798) from S8
[S9] cosine check vs S8: cos=0.7714
[S16] RECEIVED delta(kind=head bytes=1805) from S5
[S16] cosine check vs S5: cos=0.5683
[S9] RECEIVED delta(kind=head bytes=1799) from S10
[S9] cosine check vs S10: cos=0.9020
[S2] RECEIVED delta(kind=head bytes=1799) from S3
[S2] cosine check vs S3: cos=0.9756
[S14] RECEIVED delta(kind=head bytes=1798) from S16
[S14] cosine check vs S16: cos=-0.1082
[S14] DROPPED delta from S16 (cos=-0.1082 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1800) from S4
[S11] cosine check vs S4: cos=0.9811
[S10] RECEIVED delta(kind=head bytes=1799) from S13
[S10] cosine check vs S13: cos=0.9189
[S5] RECEIVED delta(kind=head bytes=1796) from S15
[S5] cosine check vs S15: cos=-0.0462
[S5] DROPPED delta from S15 (cos=-0.0462 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:49303
[S17] sending update (kind=head size=1800 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1800) from S17
[S3] cosine check vs S17: cos=0.8827
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=18 metric=0.9865 head_norm=1.186059
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.536349e-01
[S9] stored merged vector for next round verification (round=18)
[S9] DEBUG after merge:  round=18 metric=0.6335 head_norm=1.269028 delta_norm=0.253635
[S9] aggregate: ROLLBACK (f1_val pre=0.987 post=0.634 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=18 metric=0.8998 head_norm=1.493509
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.730370e-01
[S15] stored merged vector for next round verification (round=18)
[S15] DEBUG after merge:  round=18 metric=0.9014 head_norm=1.285583 delta_norm=0.373037
[S15] aggregate: ACCEPT kept=['S2', 'S11'] (k=2/2) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=18 metric=0.9978 head_norm=1.282867
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.356932e-01
[S3] stored merged vector for next round verification (round=18)
[S3] DEBUG after merge:  round=18 metric=0.9982 head_norm=1.603738 delta_norm=0.535693
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=18 metric=0.9637 head_norm=1.673877
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.635488e-01
[S11] stored merged vector for next round verification (round=18)
[S11] DEBUG after merge:  round=18 metric=0.9607 head_norm=1.673129 delta_norm=0.163549
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=18 metric=0.9951 head_norm=1.516609
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.996832e-01
[S10] stored merged vector for next round verification (round=18)
[S10] DEBUG after merge:  round=18 metric=0.9951 head_norm=1.408684 delta_norm=0.299683
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=18 metric=0.9217 head_norm=0.967223
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.791681e-01
[S16] stored merged vector for next round verification (round=18)
[S16] DEBUG after merge:  round=18 metric=0.8977 head_norm=1.169829 delta_norm=0.679168
[S16] aggregate: ROLLBACK (f1_val pre=0.922 post=0.898 tol_abs=0.005 tol_rel=0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=18 metric=0.6970 head_norm=1.365948
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.521352e-01
[S2] stored merged vector for next round verification (round=18)
[S2] DEBUG after merge:  round=18 metric=0.6975 head_norm=1.316296 delta_norm=0.152135
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.316296 cos_to_last_merge=1.0000 (last merge round=18)
[S2] round=19 local utility u=0.139835 metrics={'f1_val': 0.7037953104573599, 'auprc': 0.8429132135438505, 'loss_val': 0.47139624321596235, 'psi': 0.7594424716919561}-{'f1_val': 0.6969595344504746, 'auprc': 0.7737418029287343, 'loss_val': 0.5025373591924176, 'psi': 0.7276724418417786}
[S3] START round=19 head_norm_before_train=1.603738 cos_to_last_merge=1.0000 (last merge round=18)
[S3] round=19 local utility u=0.000000 metrics={'f1_val': 0.9228822062549499, 'auprc': 0.9919745026188573, 'loss_val': 0.24477983004418566, 'psi': 0.9505191248005129}-{'f1_val': 0.997785879834771, 'auprc': 0.9991231839227097, 'loss_val': 0.2615597916158948, 'psi': 0.9983208014699465}
[S4] START round=19 head_norm_before_train=1.688299 cos_to_last_merge=0.8803 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.880
[S4] round=19 local utility u=0.027110 metrics={'f1_val': 0.9519743992602562, 'auprc': 0.9527203386844071, 'loss_val': 0.2694674012012991, 'psi': 0.9522727750299166}-{'f1_val': 0.9410567516284438, 'auprc': 0.9625031612234203, 'loss_val': 0.28753070316840584, 'psi': 0.9496353154664344}
[S5] START round=19 head_norm_before_train=1.650461 (no previous merge yet)
[S5] round=19 local utility u=0.000000 metrics={'f1_val': 0.7113738594480568, 'auprc': 0.8034079740334426, 'loss_val': 0.35702572329729454, 'psi': 0.7481875052822111}-{'f1_val': 0.7006083926626743, 'auprc': 0.9980840168236406, 'loss_val': 0.2728639931777313, 'psi': 0.8195986423270608}
[S6] START round=19 head_norm_before_train=1.535088 cos_to_last_merge=0.8455 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.846
[S6] round=19 local utility u=0.211371 metrics={'f1_val': 0.6451853177825707, 'auprc': 0.7952610732851765, 'loss_val': 0.60519075885543, 'psi': 0.705215619983613}-{'f1_val': 0.6042146691112128, 'auprc': 0.7648963691539061, 'loss_val': 0.6910138534387399, 'psi': 0.6684873491282901}
[S7] START round=19 head_norm_before_train=1.231283 cos_to_last_merge=0.8532 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.853
[S7] round=19 local utility u=0.851852 metrics={'f1_val': 0.6669187155180928, 'auprc': 0.7624700119604401, 'loss_val': 0.6643857781733143, 'psi': 0.7051392340950318}-{'f1_val': 0.40411966904611696, 'auprc': 0.7646927377730836, 'loss_val': 0.7979641255159003, 'psi': 0.5483488965369037}
[S8] START round=19 head_norm_before_train=1.606326 cos_to_last_merge=0.9959 (last merge round=16)
[S8] round=19 local utility u=0.014522 metrics={'f1_val': 0.9936253371144965, 'auprc': 0.9986792740773347, 'loss_val': 0.08163946985826502, 'psi': 0.9956469118996318}-{'f1_val': 0.993632801855294, 'auprc': 0.9986107861523383, 'loss_val': 0.11052183288267017, 'psi': 0.9956239955741117}
[S9] START round=19 head_norm_before_train=1.269028 cos_to_last_merge=1.0000 (last merge round=18)
[S9] round=19 local utility u=0.017567 metrics={'f1_val': 0.9907913321404518, 'auprc': 0.9985350995243517, 'loss_val': 0.6773788511469455, 'psi': 0.9938888390940117}-{'f1_val': 0.9865404245545528, 'auprc': 0.9967840929289924, 'loss_val': 0.6817547073375686, 'psi': 0.9906378919043286}
[S10] START round=19 head_norm_before_train=1.408684 cos_to_last_merge=1.0000 (last merge round=18)
[S10] round=19 local utility u=0.000000 metrics={'f1_val': 0.9947757294679969, 'auprc': 0.9946177140766909, 'loss_val': 0.09494442334372669, 'psi': 0.9947125233114745}-{'f1_val': 0.9951279124444816, 'auprc': 0.9979901630756207, 'loss_val': 0.0547535850206437, 'psi': 0.9962728126969372}
[S11] START round=19 head_norm_before_train=1.673129 cos_to_last_merge=1.0000 (last merge round=18)
[S11] round=19 local utility u=0.000000 metrics={'f1_val': 0.9585635070582047, 'auprc': 0.9953370336239271, 'loss_val': 0.2211550022054455, 'psi': 0.9732729176844936}-{'f1_val': 0.9637126475429929, 'auprc': 0.9967631583377127, 'loss_val': 0.21827912488656956, 'psi': 0.9769328518608809}
[S13] START round=19 head_norm_before_train=1.359522 cos_to_last_merge=0.8097 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.810
[S13] round=19 local utility u=0.000000 metrics={'f1_val': 0.5549015963264847, 'auprc': 0.6870114963321466, 'loss_val': 0.913697017648042, 'psi': 0.6077455563287495}-{'f1_val': 0.611069828337333, 'auprc': 0.6037036266638569, 'loss_val': 0.6471378471988658, 'psi': 0.6081233476679426}
[S14] START round=19 head_norm_before_train=1.822967 (no previous merge yet)
[S14] round=19 local utility u=0.103598 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.998944205970352, 'loss_val': 0.03861256207423772, 'psi': 0.9980226440891762}-{'f1_val': 0.9674992315946077, 'auprc': 0.9990497105956382, 'loss_val': 0.06667148317913967, 'psi': 0.9801194231950199}
[S15] START round=19 head_norm_before_train=1.285583 cos_to_last_merge=1.0000 (last merge round=18)
[S15] round=19 local utility u=0.000000 metrics={'f1_val': 0.8464158355380835, 'auprc': 0.9886479925560561, 'loss_val': 0.2993084635487915, 'psi': 0.9033086983452725}-{'f1_val': 0.8997669879710237, 'auprc': 0.9919879293648896, 'loss_val': 0.2551584019212718, 'psi': 0.93665536452857}
[S16] START round=19 head_norm_before_train=1.169829 cos_to_last_merge=1.0000 (last merge round=18)
[S16] round=19 local utility u=0.000000 metrics={'f1_val': 0.842270625424586, 'auprc': 0.9122811439033129, 'loss_val': 0.6914745854019567, 'psi': 0.8702748328160768}-{'f1_val': 0.9217165438130113, 'auprc': 0.9292994511323114, 'loss_val': 0.5787939251268609, 'psi': 0.9247497067407313}
[S17] START round=19 head_norm_before_train=2.017954 (no previous merge yet)
[S17] round=19 local utility u=0.000000 metrics={'f1_val': 0.6123072255612286, 'auprc': 0.8436399872325258, 'loss_val': 1.2344967062602672, 'psi': 0.7048403302297475}-{'f1_val': 0.6464275438314641, 'auprc': 0.9741112908506848, 'loss_val': 1.003342314634588, 'psi': 0.7775010426391524}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:49312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:49316
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] → sending delta(kind=head bytes=1794) to S15@127.0.0.1:49315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:49309
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:49303
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:49309
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:49310
[S4] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1804 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1804 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1794 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1804) from S8
[S9] cosine check vs S8: cos=0.8450
[S3] RECEIVED delta(kind=head bytes=1797) from S7
[S3] cosine check vs S7: cos=0.1780
[S8] RECEIVED delta(kind=head bytes=1804) from S6
[S8] cosine check vs S6: cos=0.9714
[S15] RECEIVED delta(kind=head bytes=1794) from S2
[S15] cosine check vs S2: cos=0.4716
[S16] RECEIVED delta(kind=head bytes=1799) from S9
[S16] cosine check vs S9: cos=0.2537
[S8] RECEIVED delta(kind=head bytes=1801) from S14
[S8] cosine check vs S14: cos=-0.0500
[S8] DROPPED delta from S14 (cos=-0.0500 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1800) from S4
[S11] cosine check vs S4: cos=0.9914
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=20 psi=0.608 u=0.0000 p_local=0.1035 f1=0.555 auprc=0.687 bytes=12566
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=19 metric=0.9229 head_norm=1.628566
[S3] _apply_head_vector_avg (torch): Δ‖w‖=9.329401e-01
[S3] stored merged vector for next round verification (round=19)
[S3] DEBUG after merge:  round=19 metric=0.9350 head_norm=1.109683 delta_norm=0.932940
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S3] r=20 psi=0.951 u=0.0000 p_local=0.4414 f1=0.923 auprc=0.992 bytes=19748
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=19 metric=0.9586 head_norm=1.704017
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.114336e-01
[S11] stored merged vector for next round verification (round=19)
[S11] DEBUG after merge:  round=19 metric=0.9586 head_norm=1.697064 delta_norm=0.111434
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] r=20 psi=0.973 u=0.0000 p_local=0.1228 f1=0.959 auprc=0.995 bytes=26956
[S5] r=20 psi=0.748 u=0.0000 p_local=0.0896 f1=0.711 auprc=0.803 bytes=23407
[S10] r=20 psi=0.995 u=0.0000 p_local=0.0713 f1=0.995 auprc=0.995 bytes=21560
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=19 metric=0.8464 head_norm=1.348514
[S15] _apply_head_vector_avg (torch): Δ‖w‖=6.965681e-01
[S15] stored merged vector for next round verification (round=19)
[S15] DEBUG after merge:  round=19 metric=0.9722 head_norm=1.162374 delta_norm=0.696568
[S15] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S15] r=20 psi=0.903 u=0.0000 p_local=0.1822 f1=0.846 auprc=0.989 bytes=17974
[S14] r=20 psi=0.998 u=0.1036 p_local=0.1039 f1=0.997 auprc=0.999 bytes=26993
[S2] r=20 psi=0.759 u=0.1398 p_local=0.1708 f1=0.704 auprc=0.843 bytes=17967
[S6] r=20 psi=0.705 u=0.2114 p_local=0.2906 f1=0.645 auprc=0.795 bytes=17986
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=19 metric=0.9908 head_norm=1.281852
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.479295e-01
[S9] stored merged vector for next round verification (round=19)
[S9] DEBUG after merge:  round=19 metric=0.6378 head_norm=1.413658 delta_norm=0.447930
[S9] aggregate: ROLLBACK (f1_val pre=0.991 post=0.638 tol_abs=0.005 tol_rel=0.0)
[S9] r=20 psi=0.994 u=0.0176 p_local=0.1594 f1=0.991 auprc=0.999 bytes=25180
[S4] r=20 psi=0.952 u=0.0271 p_local=0.0873 f1=0.952 auprc=0.953 bytes=17990
[S7] r=20 psi=0.705 u=0.8519 p_local=0.3208 f1=0.667 auprc=0.762 bytes=21551
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=19 metric=0.9936 head_norm=1.659817
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.990025e-01
[S8] stored merged vector for next round verification (round=19)
[S8] DEBUG after merge:  round=19 metric=0.9936 head_norm=1.596301 delta_norm=0.199003
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S8] r=20 psi=0.996 u=0.0145 p_local=0.0952 f1=0.994 auprc=0.999 bytes=21601
[S17] r=20 psi=0.705 u=0.0000 p_local=0.1328 f1=0.612 auprc=0.844 bytes=17985
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=19 metric=0.8423 head_norm=1.217240
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.637393e-01
[S16] stored merged vector for next round verification (round=19)
[S16] DEBUG after merge:  round=19 metric=0.8582 head_norm=0.989501 delta_norm=0.763739
[S16] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S16] r=20 psi=0.870 u=0.0000 p_local=0.2032 f1=0.842 auprc=0.912 bytes=21568
[S2] START round=20 head_norm_before_train=1.361671 cos_to_last_merge=0.9975 (last merge round=18)
[S2] round=20 local utility u=0.321023 metrics={'f1_val': 0.797090504251821, 'auprc': 0.856215448219017, 'loss_val': 0.42902801763413134, 'psi': 0.8207404818386994}-{'f1_val': 0.7037953104573599, 'auprc': 0.8429132135438505, 'loss_val': 0.47139624321596235, 'psi': 0.7594424716919561}
[S3] START round=20 head_norm_before_train=1.109683 cos_to_last_merge=1.0000 (last merge round=19)
[S3] round=20 local utility u=0.000000 metrics={'f1_val': 0.9008081406055795, 'auprc': 0.9825605960133281, 'loss_val': 0.44131328499035394, 'psi': 0.9335091227686789}-{'f1_val': 0.9228822062549499, 'auprc': 0.9919745026188573, 'loss_val': 0.24477983004418566, 'psi': 0.9505191248005129}
[S4] START round=20 head_norm_before_train=1.697415 cos_to_last_merge=0.8791 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.879
[S4] round=20 local utility u=0.000000 metrics={'f1_val': 0.9409917567948693, 'auprc': 0.9593301709971778, 'loss_val': 0.2905233998661302, 'psi': 0.9483271224757928}-{'f1_val': 0.9519743992602562, 'auprc': 0.9527203386844071, 'loss_val': 0.2694674012012991, 'psi': 0.9522727750299166}
[S5] START round=20 head_norm_before_train=1.665943 (no previous merge yet)
[S5] round=20 local utility u=0.295206 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.992088105516377, 'loss_val': 0.2680605372951554, 'psi': 0.8172002778041554}-{'f1_val': 0.7113738594480568, 'auprc': 0.8034079740334426, 'loss_val': 0.35702572329729454, 'psi': 0.7481875052822111}
[S6] START round=20 head_norm_before_train=1.555816 cos_to_last_merge=0.8438 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.844
[S6] round=20 local utility u=1.000000 metrics={'f1_val': 0.9858867943106657, 'auprc': 0.955854459982478, 'loss_val': 0.09586276913911265, 'psi': 0.9738738605793906}-{'f1_val': 0.6451853177825707, 'auprc': 0.7952610732851765, 'loss_val': 0.60519075885543, 'psi': 0.705215619983613}
[S7] START round=20 head_norm_before_train=1.245520 cos_to_last_merge=0.8479 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.848
[S7] round=20 local utility u=0.000000 metrics={'f1_val': 0.3797798067829524, 'auprc': 0.6794584138172993, 'loss_val': 0.8915164559621742, 'psi': 0.49965124959669116}-{'f1_val': 0.6669187155180928, 'auprc': 0.7624700119604401, 'loss_val': 0.6643857781733143, 'psi': 0.7051392340950318}
[S8] START round=20 head_norm_before_train=1.596301 cos_to_last_merge=1.0000 (last merge round=19)
[S8] round=20 local utility u=0.000000 metrics={'f1_val': 0.9934242076394499, 'auprc': 0.9871676923685672, 'loss_val': 0.10379242590785605, 'psi': 0.9909216015310969}-{'f1_val': 0.9936253371144965, 'auprc': 0.9986792740773347, 'loss_val': 0.08163946985826502, 'psi': 0.9956469118996318}
[S9] START round=20 head_norm_before_train=1.413658 cos_to_last_merge=1.0000 (last merge round=19)
[S9] round=20 local utility u=0.090717 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9966892063972805, 'loss_val': 0.5206202874366415, 'psi': 0.9961717135774235}-{'f1_val': 0.9907913321404518, 'auprc': 0.9985350995243517, 'loss_val': 0.6773788511469455, 'psi': 0.9938888390940117}
[S10] START round=20 head_norm_before_train=1.457188 cos_to_last_merge=0.9990 (last merge round=18)
[S10] round=20 local utility u=0.016743 metrics={'f1_val': 0.9948008231115103, 'auprc': 0.9967694651543898, 'loss_val': 0.0680637833147428, 'psi': 0.9955882799286621}-{'f1_val': 0.9947757294679969, 'auprc': 0.9946177140766909, 'loss_val': 0.09494442334372669, 'psi': 0.9947125233114745}
[S11] START round=20 head_norm_before_train=1.697064 cos_to_last_merge=1.0000 (last merge round=19)
[S11] round=20 local utility u=0.065595 metrics={'f1_val': 0.9777955159723211, 'auprc': 0.9947459626884332, 'loss_val': 0.20358431883515, 'psi': 0.9845756946587658}-{'f1_val': 0.9585635070582047, 'auprc': 0.9953370336239271, 'loss_val': 0.2211550022054455, 'psi': 0.9732729176844936}
[S13] START round=20 head_norm_before_train=1.367166 cos_to_last_merge=0.8086 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.809
[S13] round=20 local utility u=0.168310 metrics={'f1_val': 0.6003158221824337, 'auprc': 0.6558430420055942, 'loss_val': 0.7560577893775859, 'psi': 0.6225267101116979}-{'f1_val': 0.5549015963264847, 'auprc': 0.6870114963321466, 'loss_val': 0.913697017648042, 'psi': 0.6077455563287495}
[S14] START round=20 head_norm_before_train=1.844985 (no previous merge yet)
[S14] round=20 local utility u=0.000000 metrics={'f1_val': 0.9970007132142444, 'auprc': 0.9957679380871072, 'loss_val': 0.03676992590879621, 'psi': 0.9965076031633895}-{'f1_val': 0.9974082695017256, 'auprc': 0.998944205970352, 'loss_val': 0.03861256207423772, 'psi': 0.9980226440891762}
[S15] START round=20 head_norm_before_train=1.162374 cos_to_last_merge=1.0000 (last merge round=19)
[S15] round=20 local utility u=0.408295 metrics={'f1_val': 0.988251595787773, 'auprc': 0.9887006805471674, 'loss_val': 0.33389174835672686, 'psi': 0.9884312296915307}-{'f1_val': 0.8464158355380835, 'auprc': 0.9886479925560561, 'loss_val': 0.2993084635487915, 'psi': 0.9033086983452725}
[S16] START round=20 head_norm_before_train=0.989501 cos_to_last_merge=1.0000 (last merge round=19)
[S16] round=20 local utility u=0.302587 metrics={'f1_val': 0.9068399885366267, 'auprc': 0.950079911310834, 'loss_val': 0.5871136032028463, 'psi': 0.9241359576463096}-{'f1_val': 0.842270625424586, 'auprc': 0.9122811439033129, 'loss_val': 0.6914745854019567, 'psi': 0.8702748328160768}
[S17] START round=20 head_norm_before_train=2.027310 (no previous merge yet)
[S17] round=20 local utility u=0.339510 metrics={'f1_val': 0.6394153391016836, 'auprc': 0.9587061107668062, 'loss_val': 1.063323078593167, 'psi': 0.7671316477677326}-{'f1_val': 0.6123072255612286, 'auprc': 0.8436399872325258, 'loss_val': 1.2344967062602672, 'psi': 0.7048403302297475}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S9] → sending delta(kind=head bytes=1805) to S16@127.0.0.1:49316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:49305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:49315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:49310
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:49311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:49314
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:49309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:49315
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:49316
[S11] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1805 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1798) from S10
[S9] cosine check vs S10: cos=0.7238
[S14] RECEIVED delta(kind=head bytes=1803) from S16
[S14] cosine check vs S16: cos=-0.0827
[S14] DROPPED delta from S16 (cos=-0.0827 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1805) from S9
[S16] cosine check vs S9: cos=0.7504
[S15] RECEIVED delta(kind=head bytes=1796) from S11
[S15] cosine check vs S11: cos=0.6488
[S15] RECEIVED delta(kind=head bytes=1800) from S2
[S15] cosine check vs S2: cos=0.8251
[S16] RECEIVED delta(kind=head bytes=1799) from S5
[S16] cosine check vs S5: cos=0.5641
[S8] RECEIVED delta(kind=head bytes=1802) from S6
[S8] cosine check vs S6: cos=0.9863
[S10] RECEIVED delta(kind=head bytes=1798) from S13
[S10] cosine check vs S13: cos=0.9566
[S5] RECEIVED delta(kind=head bytes=1797) from S15
[S5] cosine check vs S15: cos=-0.1266
[S5] DROPPED delta from S15 (cos=-0.1266 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:49303
[S17] sending update (kind=head size=1794 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1794) from S17
[S3] cosine check vs S17: cos=0.7271
[S7] ⇄ pheromone p=0.257 → S3@127.0.0.1:49303
[S14] ⇄ pheromone p=0.083 → S8@127.0.0.1:49309
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=20 metric=0.9008 head_norm=1.139042
[S3] _apply_head_vector_avg (torch): Δ‖w‖=7.193269e-01
[S3] stored merged vector for next round verification (round=20)
[S3] DEBUG after merge:  round=20 metric=0.8755 head_norm=1.484462 delta_norm=0.719327
[S3] aggregate: ROLLBACK (f1_val pre=0.901 post=0.875 tol_abs=0.005 tol_rel=0.0)
[S3] ⇄ pheromone p=0.353 → S2@127.0.0.1:49302
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=20 metric=0.9934 head_norm=1.648881
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.381508e-01
[S8] stored merged vector for next round verification (round=20)
[S8] DEBUG after merge:  round=20 metric=0.9934 head_norm=1.607527 delta_norm=0.138151
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.076 → S9@127.0.0.1:49310
[S4] ⇄ pheromone p=0.070 → S11@127.0.0.1:49312
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=20 metric=0.9948 head_norm=1.507543
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.214880e-01
[S10] stored merged vector for next round verification (round=20)
[S10] DEBUG after merge:  round=20 metric=0.9946 head_norm=1.430177 delta_norm=0.221488
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.060 → S9@127.0.0.1:49310
[S5] ⇄ pheromone p=0.131 → S16@127.0.0.1:49316
[S2] ⇄ pheromone p=0.201 → S15@127.0.0.1:49315
[S13] ⇄ pheromone p=0.116 → S10@127.0.0.1:49311
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=20 metric=0.9068 head_norm=1.030909
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.960724e-01
[S16] stored merged vector for next round verification (round=20)
[S16] DEBUG after merge:  round=20 metric=0.9067 head_norm=1.039323 delta_norm=0.196072
[S16] aggregate: ACCEPT kept=['S9', 'S5'] (k=2/2) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.223 → S14@127.0.0.1:49314
[S11] ⇄ pheromone p=0.111 → S15@127.0.0.1:49315
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=20 metric=0.9958 head_norm=1.430762
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.471048e-01
[S9] stored merged vector for next round verification (round=20)
[S9] DEBUG after merge:  round=20 metric=0.6375 head_norm=1.364023 delta_norm=0.547105
[S9] aggregate: ROLLBACK (f1_val pre=0.996 post=0.638 tol_abs=0.005 tol_rel=0.0)
[S9] ⇄ pheromone p=0.146 → S16@127.0.0.1:49316
[S6] ⇄ pheromone p=0.433 → S8@127.0.0.1:49309
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=20 metric=0.9883 head_norm=1.219429
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.961422e-01
[S15] stored merged vector for next round verification (round=20)
[S15] DEBUG after merge:  round=20 metric=0.9864 head_norm=1.199311 delta_norm=0.196142
[S15] aggregate: ACCEPT kept=['S11', 'S2'] (k=2/2) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.227 → S5@127.0.0.1:49305
[S17] ⇄ pheromone p=0.174 → S3@127.0.0.1:49303
[S2] START round=21 head_norm_before_train=1.422797 cos_to_last_merge=0.9898 (last merge round=18)
[S2] round=21 local utility u=0.109473 metrics={'f1_val': 0.8294117581985609, 'auprc': 0.8557350552993926, 'loss_val': 0.4025681827538904, 'psi': 0.8399410770388935}-{'f1_val': 0.797090504251821, 'auprc': 0.856215448219017, 'loss_val': 0.42902801763413134, 'psi': 0.8207404818386994}
[S3] START round=21 head_norm_before_train=1.484462 cos_to_last_merge=1.0000 (last merge round=20)
[S3] round=21 local utility u=0.000000 metrics={'f1_val': 0.6741324470101421, 'auprc': 0.8170363274349217, 'loss_val': 0.4753414105183377, 'psi': 0.731293999180054}-{'f1_val': 0.9008081406055795, 'auprc': 0.9825605960133281, 'loss_val': 0.44131328499035394, 'psi': 0.9335091227686789}
[S4] START round=21 head_norm_before_train=1.704809 cos_to_last_merge=0.8780 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.878
[S4] round=21 local utility u=0.000000 metrics={'f1_val': 0.9409917567948693, 'auprc': 0.9576489438273696, 'loss_val': 0.2892683778899325, 'psi': 0.9476546316078694}-{'f1_val': 0.9409917567948693, 'auprc': 0.9593301709971778, 'loss_val': 0.2905233998661302, 'psi': 0.9483271224757928}
[S5] START round=21 head_norm_before_train=1.679340 (no previous merge yet)
[S5] round=21 local utility u=0.000000 metrics={'f1_val': 0.7134931594052658, 'auprc': 0.7962630653857774, 'loss_val': 0.44454300153125853, 'psi': 0.7466011217974704}-{'f1_val': 0.7006083926626743, 'auprc': 0.992088105516377, 'loss_val': 0.2680605372951554, 'psi': 0.8172002778041554}
[S6] START round=21 head_norm_before_train=1.577227 cos_to_last_merge=0.8410 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.841
[S6] round=21 local utility u=0.000000 metrics={'f1_val': 0.6019991799554494, 'auprc': 0.7782479162346777, 'loss_val': 0.9229357445603863, 'psi': 0.6724986744671407}-{'f1_val': 0.9858867943106657, 'auprc': 0.955854459982478, 'loss_val': 0.09586276913911265, 'psi': 0.9738738605793906}
[S7] START round=21 head_norm_before_train=1.255792 cos_to_last_merge=0.8440 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.844
[S7] round=21 local utility u=0.419737 metrics={'f1_val': 0.4563664569405709, 'auprc': 0.773983876857495, 'loss_val': 0.7951381673888824, 'psi': 0.5834134249073406}-{'f1_val': 0.3797798067829524, 'auprc': 0.6794584138172993, 'loss_val': 0.8915164559621742, 'psi': 0.49965124959669116}
[S8] START round=21 head_norm_before_train=1.607527 cos_to_last_merge=1.0000 (last merge round=20)
[S8] round=21 local utility u=0.000000 metrics={'f1_val': 0.9938130760262815, 'auprc': 0.9830639841947044, 'loss_val': 0.09865103205265272, 'psi': 0.9895134392936507}-{'f1_val': 0.9934242076394499, 'auprc': 0.9871676923685672, 'loss_val': 0.10379242590785605, 'psi': 0.9909216015310969}
[S9] START round=21 head_norm_before_train=1.364023 cos_to_last_merge=1.0000 (last merge round=20)
[S9] round=21 local utility u=0.000000 metrics={'f1_val': 0.9920865114751727, 'auprc': 0.998554853356098, 'loss_val': 0.6078144184184691, 'psi': 0.9946738482275428}-{'f1_val': 0.9958267183641853, 'auprc': 0.9966892063972805, 'loss_val': 0.5206202874366415, 'psi': 0.9961717135774235}
[S10] START round=21 head_norm_before_train=1.430177 cos_to_last_merge=1.0000 (last merge round=20)
[S10] round=21 local utility u=0.000000 metrics={'f1_val': 0.9949949984746631, 'auprc': 0.998325063939702, 'loss_val': 0.08646481967286154, 'psi': 0.9963270246606787}-{'f1_val': 0.9948008231115103, 'auprc': 0.9967694651543898, 'loss_val': 0.0680637833147428, 'psi': 0.9955882799286621}
[S11] START round=21 head_norm_before_train=1.729441 cos_to_last_merge=0.9992 (last merge round=19)
[S11] round=21 local utility u=0.077893 metrics={'f1_val': 0.9967189926998994, 'auprc': 0.9937874853877112, 'loss_val': 0.15846328384994143, 'psi': 0.9955463897750241}-{'f1_val': 0.9777955159723211, 'auprc': 0.9947459626884332, 'loss_val': 0.20358431883515, 'psi': 0.9845756946587658}
[S13] START round=21 head_norm_before_train=1.384283 cos_to_last_merge=0.8057 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.806
[S13] round=21 local utility u=0.000000 metrics={'f1_val': 0.5479069109228805, 'auprc': 0.6968530880487, 'loss_val': 0.9609489857373495, 'psi': 0.6074853817732082}-{'f1_val': 0.6003158221824337, 'auprc': 0.6558430420055942, 'loss_val': 0.7560577893775859, 'psi': 0.6225267101116979}
[S14] START round=21 head_norm_before_train=1.864805 (no previous merge yet)
[S14] round=21 local utility u=0.001998 metrics={'f1_val': 0.9971680177638609, 'auprc': 0.9975546438964698, 'loss_val': 0.03913809335711474, 'psi': 0.9973226682169045}-{'f1_val': 0.9970007132142444, 'auprc': 0.9957679380871072, 'loss_val': 0.03676992590879621, 'psi': 0.9965076031633895}
[S15] START round=21 head_norm_before_train=1.199311 cos_to_last_merge=1.0000 (last merge round=20)
[S15] round=21 local utility u=0.000000 metrics={'f1_val': 0.7744493590906959, 'auprc': 0.9867470760823872, 'loss_val': 0.3668241135186822, 'psi': 0.8593684458873725}-{'f1_val': 0.988251595787773, 'auprc': 0.9887006805471674, 'loss_val': 0.33389174835672686, 'psi': 0.9884312296915307}
[S16] START round=21 head_norm_before_train=1.039323 cos_to_last_merge=1.0000 (last merge round=20)
[S16] round=21 local utility u=0.000000 metrics={'f1_val': 0.8598773289595432, 'auprc': 0.9422294369717938, 'loss_val': 0.6099976880049403, 'psi': 0.8928181721644435}-{'f1_val': 0.9068399885366267, 'auprc': 0.950079911310834, 'loss_val': 0.5871136032028463, 'psi': 0.9241359576463096}
[S17] START round=21 head_norm_before_train=2.035853 (no previous merge yet)
[S17] round=21 local utility u=0.000000 metrics={'f1_val': 0.6170467873615674, 'auprc': 0.8041219217637496, 'loss_val': 1.3977326985686211, 'psi': 0.6918768411224403}-{'f1_val': 0.6394153391016836, 'auprc': 0.9587061107668062, 'loss_val': 1.063323078593167, 'psi': 0.7671316477677326}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:49303
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:49315
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:49315
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:49309
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1802) from S2
[S15] cosine check vs S2: cos=0.7390
[S3] RECEIVED delta(kind=head bytes=1798) from S7
[S3] cosine check vs S7: cos=0.2608
[S15] RECEIVED delta(kind=head bytes=1800) from S11
[S15] cosine check vs S11: cos=0.7500
[S8] RECEIVED delta(kind=head bytes=1800) from S14
[S8] cosine check vs S14: cos=-0.0519
[S8] DROPPED delta from S14 (cos=-0.0519 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=21 metric=0.6741 head_norm=1.518446
[S3] _apply_head_vector_avg (torch): Δ‖w‖=8.526186e-01
[S3] stored merged vector for next round verification (round=21)
[S3] DEBUG after merge:  round=21 metric=0.7041 head_norm=1.108508 delta_norm=0.852619
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=21 metric=0.7744 head_norm=1.277027
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.542565e-01
[S15] stored merged vector for next round verification (round=21)
[S15] DEBUG after merge:  round=21 metric=0.7795 head_norm=1.250719 delta_norm=0.154256
[S15] aggregate: ACCEPT kept=['S2', 'S11'] (k=2/2) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=1.478534 cos_to_last_merge=0.9820 (last merge round=18)
[S2] round=22 local utility u=0.000000 metrics={'f1_val': 0.7331736490825852, 'auprc': 0.8225249221157913, 'loss_val': 0.47427849068548056, 'psi': 0.7689141582958676}-{'f1_val': 0.8294117581985609, 'auprc': 0.8557350552993926, 'loss_val': 0.4025681827538904, 'psi': 0.8399410770388935}
[S3] START round=22 head_norm_before_train=1.108508 cos_to_last_merge=1.0000 (last merge round=21)
[S3] round=22 local utility u=1.000000 metrics={'f1_val': 0.9983835929041498, 'auprc': 0.9992603638746551, 'loss_val': 0.34266464158762516, 'psi': 0.998734301292352}-{'f1_val': 0.6741324470101421, 'auprc': 0.8170363274349217, 'loss_val': 0.4753414105183377, 'psi': 0.731293999180054}
[S4] START round=22 head_norm_before_train=1.714265 cos_to_last_merge=0.8764 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.876
[S4] round=22 local utility u=0.000000 metrics={'f1_val': 0.9425872266874388, 'auprc': 0.9537768947789576, 'loss_val': 0.2886923503528634, 'psi': 0.9470630939240463}-{'f1_val': 0.9409917567948693, 'auprc': 0.9576489438273696, 'loss_val': 0.2892683778899325, 'psi': 0.9476546316078694}
[S5] START round=22 head_norm_before_train=1.691268 (no previous merge yet)
[S5] round=22 local utility u=0.326124 metrics={'f1_val': 0.7006069304790052, 'auprc': 0.9802357835841051, 'loss_val': 0.2668956290496549, 'psi': 0.8124584717210452}-{'f1_val': 0.7134931594052658, 'auprc': 0.7962630653857774, 'loss_val': 0.44454300153125853, 'psi': 0.7466011217974704}
[S6] START round=22 head_norm_before_train=1.592710 cos_to_last_merge=0.8386 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.839
[S6] round=22 local utility u=1.000000 metrics={'f1_val': 0.8442400839140741, 'auprc': 0.9471211400110471, 'loss_val': 0.3731322114145673, 'psi': 0.8853925063528633}-{'f1_val': 0.6019991799554494, 'auprc': 0.7782479162346777, 'loss_val': 0.9229357445603863, 'psi': 0.6724986744671407}
[S7] START round=22 head_norm_before_train=1.267210 cos_to_last_merge=0.8398 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.840
[S7] round=22 local utility u=0.686980 metrics={'f1_val': 0.6491723083944635, 'auprc': 0.7842163789820147, 'loss_val': 0.6087098537368614, 'psi': 0.703189936629484}-{'f1_val': 0.4563664569405709, 'auprc': 0.773983876857495, 'loss_val': 0.7951381673888824, 'psi': 0.5834134249073406}
[S8] START round=22 head_norm_before_train=1.664021 cos_to_last_merge=0.9991 (last merge round=20)
[S8] round=22 local utility u=0.031529 metrics={'f1_val': 0.9925380579155019, 'auprc': 0.9980260346908377, 'loss_val': 0.07282886995412689, 'psi': 0.9947332486256362}-{'f1_val': 0.9938130760262815, 'auprc': 0.9830639841947044, 'loss_val': 0.09865103205265272, 'psi': 0.9895134392936507}
[S9] START round=22 head_norm_before_train=1.375870 cos_to_last_merge=0.9957 (last merge round=20)
[S9] round=22 local utility u=0.138358 metrics={'f1_val': 0.9950237510807955, 'auprc': 0.9987164738056145, 'loss_val': 0.34920650510865336, 'psi': 0.9965008401707232}-{'f1_val': 0.9920865114751727, 'auprc': 0.998554853356098, 'loss_val': 0.6078144184184691, 'psi': 0.9946738482275428}
[S10] START round=22 head_norm_before_train=1.484346 cos_to_last_merge=0.9982 (last merge round=20)
[S10] round=22 local utility u=0.012282 metrics={'f1_val': 0.9955259082574451, 'auprc': 0.9972389757402766, 'loss_val': 0.061827122260192977, 'psi': 0.9962111352505777}-{'f1_val': 0.9949949984746631, 'auprc': 0.998325063939702, 'loss_val': 0.08646481967286154, 'psi': 0.9963270246606787}
[S11] START round=22 head_norm_before_train=1.759999 cos_to_last_merge=0.9973 (last merge round=19)
[S11] round=22 local utility u=0.000000 metrics={'f1_val': 0.989119248788934, 'auprc': 0.9979040004059757, 'loss_val': 0.1268674434851523, 'psi': 0.9926331494357507}-{'f1_val': 0.9967189926998994, 'auprc': 0.9937874853877112, 'loss_val': 0.15846328384994143, 'psi': 0.9955463897750241}
[S13] START round=22 head_norm_before_train=1.401082 cos_to_last_merge=0.8036 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.804
[S13] round=22 local utility u=0.079713 metrics={'f1_val': 0.5495563713020134, 'auprc': 0.6921018600319226, 'loss_val': 0.7971660419713668, 'psi': 0.6065745667939771}-{'f1_val': 0.5479069109228805, 'auprc': 0.6968530880487, 'loss_val': 0.9609489857373495, 'psi': 0.6074853817732082}
[S14] START round=22 head_norm_before_train=1.883813 (no previous merge yet)
[S14] round=22 local utility u=0.000000 metrics={'f1_val': 0.9970007132142444, 'auprc': 0.9935757012343205, 'loss_val': 0.03212167288503751, 'psi': 0.9956307084222749}-{'f1_val': 0.9971680177638609, 'auprc': 0.9975546438964698, 'loss_val': 0.03913809335711474, 'psi': 0.9973226682169045}
[S15] START round=22 head_norm_before_train=1.250719 cos_to_last_merge=1.0000 (last merge round=21)
[S15] round=22 local utility u=0.657686 metrics={'f1_val': 0.9649329958536106, 'auprc': 0.9880624141632101, 'loss_val': 0.19830090974574066, 'psi': 0.9741847631774503}-{'f1_val': 0.7744493590906959, 'auprc': 0.9867470760823872, 'loss_val': 0.3668241135186822, 'psi': 0.8593684458873725}
[S16] START round=22 head_norm_before_train=1.079900 cos_to_last_merge=0.9967 (last merge round=20)
[S16] round=22 local utility u=0.353348 metrics={'f1_val': 0.930385974545413, 'auprc': 0.9706112063964026, 'loss_val': 0.4114986915999735, 'psi': 0.9464760672858088}-{'f1_val': 0.8598773289595432, 'auprc': 0.9422294369717938, 'loss_val': 0.6099976880049403, 'psi': 0.8928181721644435}
[S17] START round=22 head_norm_before_train=2.043778 (no previous merge yet)
[S17] round=22 local utility u=0.658365 metrics={'f1_val': 0.6605847824995295, 'auprc': 0.9885962696763158, 'loss_val': 0.8956535840565976, 'psi': 0.791789377370244}-{'f1_val': 0.6170467873615674, 'auprc': 0.8041219217637496, 'loss_val': 1.3977326985686211, 'psi': 0.6918768411224403}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:49305
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S5] → sending delta(kind=head bytes=1806) to S16@127.0.0.1:49316
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.703)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:49314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:49310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:49311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S9] → sending delta(kind=head bytes=1805) to S16@127.0.0.1:49316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:49310
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:49302
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:49309
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S9] sending update (kind=head size=1805 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1806 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1798) from S3
[S2] cosine check vs S3: cos=0.8432
[S8] RECEIVED delta(kind=head bytes=1797) from S6
[S8] cosine check vs S6: cos=0.9861
[S14] RECEIVED delta(kind=head bytes=1797) from S16
[S14] cosine check vs S16: cos=-0.0895
[S14] DROPPED delta from S16 (cos=-0.0895 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1806) from S5
[S16] cosine check vs S5: cos=0.6773
[S10] RECEIVED delta(kind=head bytes=1800) from S13
[S10] cosine check vs S13: cos=0.9659
[S5] RECEIVED delta(kind=head bytes=1800) from S15
[S5] cosine check vs S15: cos=-0.1064
[S5] DROPPED delta from S15 (cos=-0.1064 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1800) from S10
[S9] cosine check vs S10: cos=0.8833
[S9] RECEIVED delta(kind=head bytes=1803) from S8
[S9] cosine check vs S8: cos=0.8107
[S16] RECEIVED delta(kind=head bytes=1805) from S9
[S16] cosine check vs S9: cos=0.6543
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:49303
[S17] sending update (kind=head size=1799 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1799) from S17
[S3] cosine check vs S17: cos=0.6709
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=22 metric=0.7332 head_norm=1.526542
[S2] _apply_head_vector_avg (torch): Δ‖w‖=4.164353e-01
[S2] stored merged vector for next round verification (round=22)
[S2] DEBUG after merge:  round=22 metric=0.7409 head_norm=1.283536 delta_norm=0.416435
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=22 metric=0.9925 head_norm=1.716297
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.486606e-01
[S8] stored merged vector for next round verification (round=22)
[S8] DEBUG after merge:  round=22 metric=0.9929 head_norm=1.657137 delta_norm=0.148661
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=22 metric=0.9955 head_norm=1.542073
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.030382e-01
[S10] stored merged vector for next round verification (round=22)
[S10] DEBUG after merge:  round=22 metric=0.9955 head_norm=1.466614 delta_norm=0.203038
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=22 metric=0.9950 head_norm=1.402611
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.187825e-01
[S9] stored merged vector for next round verification (round=22)
[S9] DEBUG after merge:  round=22 metric=0.9923 head_norm=1.406781 delta_norm=0.218782
[S9] aggregate: ACCEPT kept=['S10', 'S8'] (k=2/2) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=22 metric=0.9984 head_norm=1.145180
[S3] _apply_head_vector_avg (torch): Δ‖w‖=7.691873e-01
[S3] stored merged vector for next round verification (round=22)
[S3] DEBUG after merge:  round=22 metric=0.9992 head_norm=1.472294 delta_norm=0.769187
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=22 metric=0.9304 head_norm=1.128359
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.735960e-01
[S16] stored merged vector for next round verification (round=22)
[S16] DEBUG after merge:  round=22 metric=0.9293 head_norm=1.093915 delta_norm=0.173596
[S16] aggregate: ACCEPT kept=['S5', 'S9'] (k=2/2) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=1.283536 cos_to_last_merge=1.0000 (last merge round=22)
[S2] round=23 local utility u=0.139506 metrics={'f1_val': 0.7201596043628972, 'auprc': 0.9144434577802985, 'loss_val': 0.3929387018103366, 'psi': 0.7978731457298577}-{'f1_val': 0.7331736490825852, 'auprc': 0.8225249221157913, 'loss_val': 0.47427849068548056, 'psi': 0.7689141582958676}
[S3] START round=23 head_norm_before_train=1.472294 cos_to_last_merge=1.0000 (last merge round=22)
[S3] round=23 local utility u=0.000000 metrics={'f1_val': 0.96934859621176, 'auprc': 0.9996472427267024, 'loss_val': 0.17258258171032778, 'psi': 0.9814680548177368}-{'f1_val': 0.9983835929041498, 'auprc': 0.9992603638746551, 'loss_val': 0.34266464158762516, 'psi': 0.998734301292352}
[S4] START round=23 head_norm_before_train=1.719957 cos_to_last_merge=0.8762 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.876
[S4] round=23 local utility u=0.000000 metrics={'f1_val': 0.9378805624144096, 'auprc': 0.9610529248291888, 'loss_val': 0.31242747456327474, 'psi': 0.9471495073803213}-{'f1_val': 0.9425872266874388, 'auprc': 0.9537768947789576, 'loss_val': 0.2886923503528634, 'psi': 0.9470630939240463}
[S5] START round=23 head_norm_before_train=1.697752 (no previous merge yet)
[S5] round=23 local utility u=0.021273 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9922047070438468, 'loss_val': 0.2602643058783362, 'psi': 0.8172469184151433}-{'f1_val': 0.7006069304790052, 'auprc': 0.9802357835841051, 'loss_val': 0.2668956290496549, 'psi': 0.8124584717210452}
[S6] START round=23 head_norm_before_train=1.609575 cos_to_last_merge=0.8373 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.837
[S6] round=23 local utility u=0.028141 metrics={'f1_val': 0.8427497653097755, 'auprc': 0.9422388509793884, 'loss_val': 0.29326188006044446, 'psi': 0.8825453995776207}-{'f1_val': 0.8442400839140741, 'auprc': 0.9471211400110471, 'loss_val': 0.3731322114145673, 'psi': 0.8853925063528633}
[S7] START round=23 head_norm_before_train=1.281908 cos_to_last_merge=0.8349 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.835
[S7] round=23 local utility u=0.000000 metrics={'f1_val': 0.4617884078704302, 'auprc': 0.6361842046722623, 'loss_val': 0.8335079296748948, 'psi': 0.5315467265911631}-{'f1_val': 0.6491723083944635, 'auprc': 0.7842163789820147, 'loss_val': 0.6087098537368614, 'psi': 0.703189936629484}
[S8] START round=23 head_norm_before_train=1.657137 cos_to_last_merge=1.0000 (last merge round=22)
[S8] round=23 local utility u=0.000000 metrics={'f1_val': 0.9918109678295097, 'auprc': 0.9981573170469349, 'loss_val': 0.08022106961388285, 'psi': 0.9943495075164798}-{'f1_val': 0.9925380579155019, 'auprc': 0.9980260346908377, 'loss_val': 0.07282886995412689, 'psi': 0.9947332486256362}
[S9] START round=23 head_norm_before_train=1.406781 cos_to_last_merge=1.0000 (last merge round=22)
[S9] round=23 local utility u=0.000000 metrics={'f1_val': 0.9966857875385419, 'auprc': 0.9958517919368901, 'loss_val': 0.35246434832254964, 'psi': 0.9963521892978813}-{'f1_val': 0.9950237510807955, 'auprc': 0.9987164738056145, 'loss_val': 0.34920650510865336, 'psi': 0.9965008401707232}
[S10] START round=23 head_norm_before_train=1.466614 cos_to_last_merge=1.0000 (last merge round=22)
[S10] round=23 local utility u=0.000000 metrics={'f1_val': 0.9959407510105199, 'auprc': 0.9984287665052287, 'loss_val': 0.07486297166306485, 'psi': 0.9969359572084034}-{'f1_val': 0.9955259082574451, 'auprc': 0.9972389757402766, 'loss_val': 0.061827122260192977, 'psi': 0.9962111352505777}
[S11] START round=23 head_norm_before_train=1.793366 cos_to_last_merge=0.9947 (last merge round=19)
[S11] round=23 local utility u=0.000000 metrics={'f1_val': 0.958090897193183, 'auprc': 0.9973758223367291, 'loss_val': 0.11429685544889862, 'psi': 0.9738048672506013}-{'f1_val': 0.989119248788934, 'auprc': 0.9979040004059757, 'loss_val': 0.1268674434851523, 'psi': 0.9926331494357507}
[S13] START round=23 head_norm_before_train=1.416465 cos_to_last_merge=0.8019 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.802
[S13] round=23 local utility u=0.184989 metrics={'f1_val': 0.5976860991379226, 'auprc': 0.6969790993199859, 'loss_val': 0.730598640987982, 'psi': 0.6374032992107479}-{'f1_val': 0.5495563713020134, 'auprc': 0.6921018600319226, 'loss_val': 0.7971660419713668, 'psi': 0.6065745667939771}
[S14] START round=23 head_norm_before_train=1.905216 (no previous merge yet)
[S14] round=23 local utility u=0.003643 metrics={'f1_val': 0.9970007132142444, 'auprc': 0.9949682747086723, 'loss_val': 0.02901263471911205, 'psi': 0.9961877378120156}-{'f1_val': 0.9970007132142444, 'auprc': 0.9935757012343205, 'loss_val': 0.03212167288503751, 'psi': 0.9956307084222749}
[S15] START round=23 head_norm_before_train=1.335487 cos_to_last_merge=0.9935 (last merge round=21)
[S15] round=23 local utility u=0.000000 metrics={'f1_val': 0.773705026563229, 'auprc': 0.9877904454221932, 'loss_val': 0.3385151818596496, 'psi': 0.8593391941068147}-{'f1_val': 0.9649329958536106, 'auprc': 0.9880624141632101, 'loss_val': 0.19830090974574066, 'psi': 0.9741847631774503}
[S16] START round=23 head_norm_before_train=1.093915 cos_to_last_merge=1.0000 (last merge round=22)
[S16] round=23 local utility u=0.000000 metrics={'f1_val': 0.9114989308533167, 'auprc': 0.9827226402248983, 'loss_val': 0.4769237479571077, 'psi': 0.9399884146019494}-{'f1_val': 0.930385974545413, 'auprc': 0.9706112063964026, 'loss_val': 0.4114986915999735, 'psi': 0.9464760672858088}
[S17] START round=23 head_norm_before_train=2.051136 (no previous merge yet)
[S17] round=23 local utility u=0.000000 metrics={'f1_val': 0.6461932063779041, 'auprc': 0.998647437044598, 'loss_val': 1.1123628978892184, 'psi': 0.7871748986445817}-{'f1_val': 0.6605847824995295, 'auprc': 0.9885962696763158, 'loss_val': 0.8956535840565976, 'psi': 0.791789377370244}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.883)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.817)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.637)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:49315
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:49309
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1797) from S14
[S8] cosine check vs S14: cos=-0.0562
[S8] DROPPED delta from S14 (cos=-0.0562 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1795) from S2
[S15] cosine check vs S2: cos=0.6706
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=23 metric=0.7737 head_norm=1.407746
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.588376e-01
[S15] stored merged vector for next round verification (round=23)
[S15] DEBUG after merge:  round=23 metric=0.7934 head_norm=1.256836 delta_norm=0.558838
[S15] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=1.342432 cos_to_last_merge=0.9981 (last merge round=22)
[S2] round=24 local utility u=0.000000 metrics={'f1_val': 0.7739911113343625, 'auprc': 0.8381887836489674, 'loss_val': 0.49322028710825383, 'psi': 0.7996701802602044}-{'f1_val': 0.7201596043628972, 'auprc': 0.9144434577802985, 'loss_val': 0.3929387018103366, 'psi': 0.7978731457298577}
[S3] START round=24 head_norm_before_train=1.514008 cos_to_last_merge=0.9992 (last merge round=22)
[S3] round=24 local utility u=0.000000 metrics={'f1_val': 0.9624632639299391, 'auprc': 0.9996276421624712, 'loss_val': 0.14804379420341165, 'psi': 0.9773290152229519}-{'f1_val': 0.96934859621176, 'auprc': 0.9996472427267024, 'loss_val': 0.17258258171032778, 'psi': 0.9814680548177368}
[S4] START round=24 head_norm_before_train=1.725506 cos_to_last_merge=0.8761 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.876
[S4] round=24 local utility u=0.046357 metrics={'f1_val': 0.9427970266193452, 'auprc': 0.9746392812146498, 'loss_val': 0.2899705409820829, 'psi': 0.955533928457467}-{'f1_val': 0.9378805624144096, 'auprc': 0.9610529248291888, 'loss_val': 0.31242747456327474, 'psi': 0.9471495073803213}
[S5] START round=24 head_norm_before_train=1.702473 (no previous merge yet)
[S5] round=24 local utility u=0.000000 metrics={'f1_val': 0.702148831065832, 'auprc': 0.899041521966406, 'loss_val': 0.28823615818932813, 'psi': 0.7809059074260616}-{'f1_val': 0.7006083926626743, 'auprc': 0.9922047070438468, 'loss_val': 0.2602643058783362, 'psi': 0.8172469184151433}
[S6] START round=24 head_norm_before_train=1.628939 cos_to_last_merge=0.8358 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.836
[S6] round=24 local utility u=0.000000 metrics={'f1_val': 0.8328034200920855, 'auprc': 0.882915340944392, 'loss_val': 0.49413362257935445, 'psi': 0.8528481884330081}-{'f1_val': 0.8427497653097755, 'auprc': 0.9422388509793884, 'loss_val': 0.29326188006044446, 'psi': 0.8825453995776207}
[S7] START round=24 head_norm_before_train=1.296494 cos_to_last_merge=0.8301 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.830
[S7] round=24 local utility u=0.084451 metrics={'f1_val': 0.49355884811746387, 'auprc': 0.6270730483508798, 'loss_val': 0.8278958630897254, 'psi': 0.5469645282108302}-{'f1_val': 0.4617884078704302, 'auprc': 0.6361842046722623, 'loss_val': 0.8335079296748948, 'psi': 0.5315467265911631}
[S8] START round=24 head_norm_before_train=1.706290 cos_to_last_merge=0.9994 (last merge round=22)
[S8] round=24 local utility u=0.000000 metrics={'f1_val': 0.9063164127793558, 'auprc': 0.987500894838653, 'loss_val': 0.1329234012917626, 'psi': 0.9387902056030748}-{'f1_val': 0.9918109678295097, 'auprc': 0.9981573170469349, 'loss_val': 0.08022106961388285, 'psi': 0.9943495075164798}
[S9] START round=24 head_norm_before_train=1.432551 cos_to_last_merge=0.9965 (last merge round=22)
[S9] round=24 local utility u=0.072373 metrics={'f1_val': 0.9971000495392299, 'auprc': 0.9956644568714921, 'loss_val': 0.20964229858396813, 'psi': 0.9965258124721348}-{'f1_val': 0.9966857875385419, 'auprc': 0.9958517919368901, 'loss_val': 0.35246434832254964, 'psi': 0.9963521892978813}
[S10] START round=24 head_norm_before_train=1.523105 cos_to_last_merge=0.9981 (last merge round=22)
[S10] round=24 local utility u=0.006472 metrics={'f1_val': 0.9952143411512907, 'auprc': 0.9975413465970882, 'loss_val': 0.054898390723415305, 'psi': 0.9961451433296098}-{'f1_val': 0.9959407510105199, 'auprc': 0.9984287665052287, 'loss_val': 0.07486297166306485, 'psi': 0.9969359572084034}
[S11] START round=24 head_norm_before_train=1.824061 cos_to_last_merge=0.9921 (last merge round=19)
[S11] round=24 local utility u=0.127638 metrics={'f1_val': 0.995882955255567, 'auprc': 0.9966770754593282, 'loss_val': 0.08367771375413713, 'psi': 0.9962006033370715}-{'f1_val': 0.958090897193183, 'auprc': 0.9973758223367291, 'loss_val': 0.11429685544889862, 'psi': 0.9738048672506013}
[S13] START round=24 head_norm_before_train=1.440374 cos_to_last_merge=0.7997 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.800
[S13] round=24 local utility u=0.000000 metrics={'f1_val': 0.5408687636381394, 'auprc': 0.7165175521871264, 'loss_val': 1.1921792715042165, 'psi': 0.6111282790577341}-{'f1_val': 0.5976860991379226, 'auprc': 0.6969790993199859, 'loss_val': 0.730598640987982, 'psi': 0.6374032992107479}
[S14] START round=24 head_norm_before_train=1.926611 (no previous merge yet)
[S14] round=24 local utility u=0.008671 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.9990481154688016, 'loss_val': 0.028822013086138593, 'psi': 0.9983109569678517}-{'f1_val': 0.9970007132142444, 'auprc': 0.9949682747086723, 'loss_val': 0.02901263471911205, 'psi': 0.9961877378120156}
[S15] START round=24 head_norm_before_train=1.256836 cos_to_last_merge=1.0000 (last merge round=23)
[S15] round=24 local utility u=0.383509 metrics={'f1_val': 0.8949817227670491, 'auprc': 0.9881267147636543, 'loss_val': 0.3001652084637215, 'psi': 0.9322397195656912}-{'f1_val': 0.773705026563229, 'auprc': 0.9877904454221932, 'loss_val': 0.3385151818596496, 'psi': 0.8593391941068147}
[S16] START round=24 head_norm_before_train=1.139715 cos_to_last_merge=0.9974 (last merge round=22)
[S16] round=24 local utility u=0.000000 metrics={'f1_val': 0.8372610716694515, 'auprc': 0.9818425100726091, 'loss_val': 0.6225832951537117, 'psi': 0.8950936470307146}-{'f1_val': 0.9114989308533167, 'auprc': 0.9827226402248983, 'loss_val': 0.4769237479571077, 'psi': 0.9399884146019494}
[S17] START round=24 head_norm_before_train=2.063266 (no previous merge yet)
[S17] round=24 local utility u=0.003487 metrics={'f1_val': 0.6495269622913907, 'auprc': 0.9955658181129279, 'loss_val': 1.1161472463227324, 'psi': 0.7879425046200056}-{'f1_val': 0.6461932063779041, 'auprc': 0.998647437044598, 'loss_val': 1.1123628978892184, 'psi': 0.7871748986445817}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:49315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:49312
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.998)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:49316
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:49305
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:49310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] → sending delta(kind=head bytes=1805) to S3@127.0.0.1:49303
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1805 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1798) from S10
[S9] cosine check vs S10: cos=0.8391
[S3] RECEIVED delta(kind=head bytes=1805) from S7
[S3] cosine check vs S7: cos=0.2871
[S16] RECEIVED delta(kind=head bytes=1797) from S9
[S16] cosine check vs S9: cos=0.6157
[S15] RECEIVED delta(kind=head bytes=1796) from S11
[S15] cosine check vs S11: cos=0.5479
[S5] RECEIVED delta(kind=head bytes=1798) from S15
[S5] cosine check vs S15: cos=-0.1350
[S5] DROPPED delta from S15 (cos=-0.1350 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1797) from S4
[S11] cosine check vs S4: cos=0.9769
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:49303
[S17] sending update (kind=head size=1796 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1796) from S17
[S3] cosine check vs S17: cos=0.9514
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=24 metric=0.9625 head_norm=1.547603
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.564014e-01
[S3] stored merged vector for next round verification (round=24)
[S3] DEBUG after merge:  round=24 metric=0.9625 head_norm=1.374391 delta_norm=0.256401
[S3] aggregate: ACCEPT kept=['S7', 'S17'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=24 metric=0.9971 head_norm=1.471076
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.361640e-01
[S9] stored merged vector for next round verification (round=24)
[S9] DEBUG after merge:  round=24 metric=0.9967 head_norm=1.463677 delta_norm=0.436164
[S9] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=24 metric=0.9959 head_norm=1.852800
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.026140e-01
[S11] stored merged vector for next round verification (round=24)
[S11] DEBUG after merge:  round=24 metric=0.9955 head_norm=1.778231 delta_norm=0.202614
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=24 metric=0.8950 head_norm=1.319202
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.897232e-01
[S15] stored merged vector for next round verification (round=24)
[S15] DEBUG after merge:  round=24 metric=0.8946 head_norm=1.401042 delta_norm=0.789723
[S15] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=24 metric=0.8373 head_norm=1.194096
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.972210e-01
[S16] stored merged vector for next round verification (round=24)
[S16] DEBUG after merge:  round=24 metric=0.8470 head_norm=1.199288 delta_norm=0.597221
[S16] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=25 head_norm_before_train=1.407678 cos_to_last_merge=0.9932 (last merge round=22)
[S2] round=25 local utility u=0.123634 metrics={'f1_val': 0.7900592975772418, 'auprc': 0.8662038868159035, 'loss_val': 0.4264071046727475, 'psi': 0.8205171332727065}-{'f1_val': 0.7739911113343625, 'auprc': 0.8381887836489674, 'loss_val': 0.49322028710825383, 'psi': 0.7996701802602044}
[S3] START round=25 head_norm_before_train=1.374391 cos_to_last_merge=1.0000 (last merge round=24)
[S3] round=25 local utility u=0.000000 metrics={'f1_val': 0.9629642435515284, 'auprc': 0.9995336385544357, 'loss_val': 0.18898751225060076, 'psi': 0.9775920015526913}-{'f1_val': 0.9624632639299391, 'auprc': 0.9996276421624712, 'loss_val': 0.14804379420341165, 'psi': 0.9773290152229519}
[S4] START round=25 head_norm_before_train=1.724369 cos_to_last_merge=0.8779 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.878
[S4] round=25 local utility u=0.006596 metrics={'f1_val': 0.9512207772278747, 'auprc': 0.9607398932343079, 'loss_val': 0.2856234568146608, 'psi': 0.955028423630448}-{'f1_val': 0.9427970266193452, 'auprc': 0.9746392812146498, 'loss_val': 0.2899705409820829, 'psi': 0.955533928457467}
[S5] START round=25 head_norm_before_train=1.708381 (no previous merge yet)
[S5] round=25 local utility u=0.161821 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9970513209860669, 'loss_val': 0.24938123732583545, 'psi': 0.8191855639920314}-{'f1_val': 0.702148831065832, 'auprc': 0.899041521966406, 'loss_val': 0.28823615818932813, 'psi': 0.7809059074260616}
[S6] START round=25 head_norm_before_train=1.655144 cos_to_last_merge=0.8342 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.834
[S6] round=25 local utility u=0.657434 metrics={'f1_val': 0.962157540250929, 'auprc': 0.9555910127658864, 'loss_val': 0.17341825816026643, 'psi': 0.959530929256912}-{'f1_val': 0.8328034200920855, 'auprc': 0.882915340944392, 'loss_val': 0.49413362257935445, 'psi': 0.8528481884330081}
[S7] START round=25 head_norm_before_train=1.313877 cos_to_last_merge=0.8251 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.825
[S7] round=25 local utility u=0.396117 metrics={'f1_val': 0.5965727989963833, 'auprc': 0.638847007598049, 'loss_val': 0.6890668852551289, 'psi': 0.6134824824370495}-{'f1_val': 0.49355884811746387, 'auprc': 0.6270730483508798, 'loss_val': 0.8278958630897254, 'psi': 0.5469645282108302}
[S8] START round=25 head_norm_before_train=1.752879 cos_to_last_merge=0.9979 (last merge round=22)
[S8] round=25 local utility u=0.307111 metrics={'f1_val': 0.9910860494090681, 'auprc': 0.9990472895141091, 'loss_val': 0.06195912735824034, 'psi': 0.9942705454510845}-{'f1_val': 0.9063164127793558, 'auprc': 0.987500894838653, 'loss_val': 0.1329234012917626, 'psi': 0.9387902056030748}
[S9] START round=25 head_norm_before_train=1.463677 cos_to_last_merge=1.0000 (last merge round=24)
[S9] round=25 local utility u=0.000000 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9979716091878483, 'loss_val': 0.26679951508265765, 'psi': 0.9969512611133831}-{'f1_val': 0.9971000495392299, 'auprc': 0.9956644568714921, 'loss_val': 0.20964229858396813, 'psi': 0.9965258124721348}
[S10] START round=25 head_norm_before_train=1.581490 cos_to_last_merge=0.9935 (last merge round=22)
[S10] round=25 local utility u=0.003719 metrics={'f1_val': 0.9948838907637279, 'auprc': 0.9972869700700855, 'loss_val': 0.044714225950635914, 'psi': 0.995845122486271}-{'f1_val': 0.9952143411512907, 'auprc': 0.9975413465970882, 'loss_val': 0.054898390723415305, 'psi': 0.9961451433296098}
[S11] START round=25 head_norm_before_train=1.778231 cos_to_last_merge=1.0000 (last merge round=24)
[S11] round=25 local utility u=0.000000 metrics={'f1_val': 0.9966988539245482, 'auprc': 0.9949992414133262, 'loss_val': 0.09677978095531159, 'psi': 0.9960190089200593}-{'f1_val': 0.995882955255567, 'auprc': 0.9966770754593282, 'loss_val': 0.08367771375413713, 'psi': 0.9962006033370715}
[S13] START round=25 head_norm_before_train=1.460054 cos_to_last_merge=0.7983 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.798
[S13] round=25 local utility u=0.222337 metrics={'f1_val': 0.5792899423454182, 'auprc': 0.6821613105768871, 'loss_val': 0.8749642933827262, 'psi': 0.6204384896380057}-{'f1_val': 0.5408687636381394, 'auprc': 0.7165175521871264, 'loss_val': 1.1921792715042165, 'psi': 0.6111282790577341}
[S14] START round=25 head_norm_before_train=1.946156 (no previous merge yet)
[S14] round=25 local utility u=0.000000 metrics={'f1_val': 0.9975765414632514, 'auprc': 0.9987762705065761, 'loss_val': 0.02962518941783414, 'psi': 0.9980564330805812}-{'f1_val': 0.9978195179672185, 'auprc': 0.9990481154688016, 'loss_val': 0.028822013086138593, 'psi': 0.9983109569678517}
[S15] START round=25 head_norm_before_train=1.401042 cos_to_last_merge=1.0000 (last merge round=24)
[S15] round=25 local utility u=0.403656 metrics={'f1_val': 0.9963164379542544, 'auprc': 0.9910504105243868, 'loss_val': 0.10963316292012038, 'psi': 0.9942100269823073}-{'f1_val': 0.8949817227670491, 'auprc': 0.9881267147636543, 'loss_val': 0.3001652084637215, 'psi': 0.9322397195656912}
[S16] START round=25 head_norm_before_train=1.199288 cos_to_last_merge=1.0000 (last merge round=24)
[S16] round=25 local utility u=0.330096 metrics={'f1_val': 0.9154870519102034, 'auprc': 0.9875426260164186, 'loss_val': 0.448846596748126, 'psi': 0.9443092815526895}-{'f1_val': 0.8372610716694515, 'auprc': 0.9818425100726091, 'loss_val': 0.6225832951537117, 'psi': 0.8950936470307146}
[S17] START round=25 head_norm_before_train=2.080001 (no previous merge yet)
[S17] round=25 local utility u=0.785692 metrics={'f1_val': 0.8420649586184568, 'auprc': 0.9791080130383247, 'loss_val': 0.650618488825923, 'psi': 0.896882180386404}-{'f1_val': 0.6495269622913907, 'auprc': 0.9955658181129279, 'loss_val': 1.1161472463227324, 'psi': 0.7879425046200056}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] → sending delta(kind=head bytes=1805) to S9@127.0.0.1:49310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:49315
[S7] not sending this round → trigger blocked (psi=0.613)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:49316
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:49309
[S10] not sending this round → trigger blocked (psi=0.996)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.955)
[S15] not sending this round → trigger blocked (psi=0.994)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:49311
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:49314
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1805 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1805) from S8
[S9] cosine check vs S8: cos=0.7260
[S8] RECEIVED delta(kind=head bytes=1795) from S6
[S8] cosine check vs S6: cos=0.9860
[S10] RECEIVED delta(kind=head bytes=1801) from S13
[S10] cosine check vs S13: cos=0.9594
[S16] RECEIVED delta(kind=head bytes=1799) from S5
[S16] cosine check vs S5: cos=0.3599
[S14] RECEIVED delta(kind=head bytes=1802) from S16
[S14] cosine check vs S16: cos=-0.0685
[S14] DROPPED delta from S16 (cos=-0.0685 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1797) from S2
[S15] cosine check vs S2: cos=0.5161
[S17] not sending this round → trigger blocked (psi=0.897)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=25 metric=0.9963 head_norm=1.495409
[S9] _apply_head_vector_avg (torch): Δ‖w‖=6.215840e-01
[S9] stored merged vector for next round verification (round=25)
[S9] DEBUG after merge:  round=25 metric=0.9971 head_norm=1.524259 delta_norm=0.621584
[S9] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.073 → S16@127.0.0.1:49316
[S3] ⇄ pheromone p=0.218 → S2@127.0.0.1:49302
[S11] ⇄ pheromone p=0.063 → S15@127.0.0.1:49315
[S7] ⇄ pheromone p=0.282 → S3@127.0.0.1:49303
[S4] ⇄ pheromone p=0.032 → S11@127.0.0.1:49312
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=25 metric=0.9949 head_norm=1.630466
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.347371e-01
[S10] stored merged vector for next round verification (round=25)
[S10] DEBUG after merge:  round=25 metric=0.9940 head_norm=1.534232 delta_norm=0.234737
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.023 → S9@127.0.0.1:49310
[S14] ⇄ pheromone p=0.029 → S8@127.0.0.1:49309
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=25 metric=0.9911 head_norm=1.784157
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.544808e-01
[S8] stored merged vector for next round verification (round=25)
[S8] DEBUG after merge:  round=25 metric=0.9914 head_norm=1.724152 delta_norm=0.154481
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.090 → S9@127.0.0.1:49310
[S5] ⇄ pheromone p=0.111 → S16@127.0.0.1:49316
[S13] ⇄ pheromone p=0.114 → S10@127.0.0.1:49311
[S2] ⇄ pheromone p=0.117 → S15@127.0.0.1:49315
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=25 metric=0.9155 head_norm=1.241447
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.594030e-01
[S16] stored merged vector for next round verification (round=25)
[S16] DEBUG after merge:  round=25 metric=0.8901 head_norm=1.227040 delta_norm=0.859403
[S16] aggregate: ROLLBACK (f1_val pre=0.915 post=0.890 tol_abs=0.005 tol_rel=0.0)
[S16] ⇄ pheromone p=0.175 → S14@127.0.0.1:49314
[S6] ⇄ pheromone p=0.379 → S8@127.0.0.1:49309
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=25 metric=0.9963 head_norm=1.466349
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.193125e-01
[S15] stored merged vector for next round verification (round=25)
[S15] DEBUG after merge:  round=25 metric=0.9963 head_norm=1.273257 delta_norm=0.719312
[S15] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.284 → S5@127.0.0.1:49305
[S17] ⇄ pheromone p=0.282 → S3@127.0.0.1:49303
[S2] START round=26 head_norm_before_train=1.458428 cos_to_last_merge=0.9883 (last merge round=22)
[S2] round=26 local utility u=0.000000 metrics={'f1_val': 0.7174189264478343, 'auprc': 0.876071821669582, 'loss_val': 0.46469012868927634, 'psi': 0.7808800845365333}-{'f1_val': 0.7900592975772418, 'auprc': 0.8662038868159035, 'loss_val': 0.4264071046727475, 'psi': 0.8205171332727065}
[S3] START round=26 head_norm_before_train=1.396728 cos_to_last_merge=0.9998 (last merge round=24)
[S3] round=26 local utility u=0.127387 metrics={'f1_val': 0.9979722591986233, 'auprc': 0.9992434213815635, 'loss_val': 0.14339043220753347, 'psi': 0.9984807240717994}-{'f1_val': 0.9629642435515284, 'auprc': 0.9995336385544357, 'loss_val': 0.18898751225060076, 'psi': 0.9775920015526913}
[S4] START round=26 head_norm_before_train=1.731830 cos_to_last_merge=0.8775 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.877
[S4] round=26 local utility u=0.000000 metrics={'f1_val': 0.9406462735375676, 'auprc': 0.9728172575356061, 'loss_val': 0.29830894138229197, 'psi': 0.953514667136783}-{'f1_val': 0.9512207772278747, 'auprc': 0.9607398932343079, 'loss_val': 0.2856234568146608, 'psi': 0.955028423630448}
[S5] START round=26 head_norm_before_train=1.716744 (no previous merge yet)
[S5] round=26 local utility u=0.000000 metrics={'f1_val': 0.7093590158793546, 'auprc': 0.8284845714285716, 'loss_val': 0.38553008232840846, 'psi': 0.7570092380990414}-{'f1_val': 0.7006083926626743, 'auprc': 0.9970513209860669, 'loss_val': 0.24938123732583545, 'psi': 0.8191855639920314}
[S6] START round=26 head_norm_before_train=1.676280 cos_to_last_merge=0.8321 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.832
[S6] round=26 local utility u=0.000000 metrics={'f1_val': 0.618793486576953, 'auprc': 0.7862269462124076, 'loss_val': 0.9093964437445838, 'psi': 0.6857668704311348}-{'f1_val': 0.962157540250929, 'auprc': 0.9555910127658864, 'loss_val': 0.17341825816026643, 'psi': 0.959530929256912}
[S7] START round=26 head_norm_before_train=1.333851 cos_to_last_merge=0.8197 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.820
[S7] round=26 local utility u=0.493061 metrics={'f1_val': 0.6484799426802401, 'auprc': 0.8038500511783284, 'loss_val': 0.509396767041453, 'psi': 0.7106279860794755}-{'f1_val': 0.5965727989963833, 'auprc': 0.638847007598049, 'loss_val': 0.6890668852551289, 'psi': 0.6134824824370495}
[S8] START round=26 head_norm_before_train=1.724152 cos_to_last_merge=1.0000 (last merge round=25)
[S8] round=26 local utility u=0.000000 metrics={'f1_val': 0.9910860494090681, 'auprc': 0.999056260044067, 'loss_val': 0.06312534385808309, 'psi': 0.9942741336630676}-{'f1_val': 0.9910860494090681, 'auprc': 0.9990472895141091, 'loss_val': 0.06195912735824034, 'psi': 0.9942705454510845}
[S9] START round=26 head_norm_before_train=1.524259 cos_to_last_merge=1.0000 (last merge round=25)
[S9] round=26 local utility u=0.002749 metrics={'f1_val': 0.9880286744602689, 'auprc': 0.9946015327485109, 'loss_val': 0.20173706500815314, 'psi': 0.9906578177755656}-{'f1_val': 0.9962710290637395, 'auprc': 0.9979716091878483, 'loss_val': 0.26679951508265765, 'psi': 0.9969512611133831}
[S10] START round=26 head_norm_before_train=1.534232 cos_to_last_merge=1.0000 (last merge round=25)
[S10] round=26 local utility u=0.000000 metrics={'f1_val': 0.9953063309450747, 'auprc': 0.9983064887024209, 'loss_val': 0.0624286895034858, 'psi': 0.9965063940480132}-{'f1_val': 0.9948838907637279, 'auprc': 0.9972869700700855, 'loss_val': 0.044714225950635914, 'psi': 0.995845122486271}
[S11] START round=26 head_norm_before_train=1.805024 cos_to_last_merge=0.9998 (last merge round=24)
[S11] round=26 local utility u=0.000000 metrics={'f1_val': 0.9948632634592205, 'auprc': 0.9950732007770465, 'loss_val': 0.10097989763598968, 'psi': 0.9949472383863509}-{'f1_val': 0.9966988539245482, 'auprc': 0.9949992414133262, 'loss_val': 0.09677978095531159, 'psi': 0.9960190089200593}
[S13] START round=26 head_norm_before_train=1.469530 cos_to_last_merge=0.7977 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.798
[S13] round=26 local utility u=0.000000 metrics={'f1_val': 0.5892392612438346, 'auprc': 0.6875348382625974, 'loss_val': 0.9648735070879103, 'psi': 0.6285574920513397}-{'f1_val': 0.5792899423454182, 'auprc': 0.6821613105768871, 'loss_val': 0.8749642933827262, 'psi': 0.6204384896380057}
[S14] START round=26 head_norm_before_train=1.960038 (no previous merge yet)
[S14] round=26 local utility u=0.000000 metrics={'f1_val': 0.995501598651872, 'auprc': 0.9991056931813711, 'loss_val': 0.0307101135339707, 'psi': 0.9969432364636717}-{'f1_val': 0.9975765414632514, 'auprc': 0.9987762705065761, 'loss_val': 0.02962518941783414, 'psi': 0.9980564330805812}
[S15] START round=26 head_norm_before_train=1.273257 cos_to_last_merge=1.0000 (last merge round=25)
[S15] round=26 local utility u=0.000000 metrics={'f1_val': 0.9963164379542544, 'auprc': 0.9909850382993751, 'loss_val': 0.1755297503404736, 'psi': 0.9941838780923027}-{'f1_val': 0.9963164379542544, 'auprc': 0.9910504105243868, 'loss_val': 0.10963316292012038, 'psi': 0.9942100269823073}
[S16] START round=26 head_norm_before_train=1.227040 cos_to_last_merge=1.0000 (last merge round=25)
[S16] round=26 local utility u=0.000000 metrics={'f1_val': 0.8253984773216877, 'auprc': 0.9773821750994843, 'loss_val': 0.49805939567950996, 'psi': 0.8861919564328063}-{'f1_val': 0.9154870519102034, 'auprc': 0.9875426260164186, 'loss_val': 0.448846596748126, 'psi': 0.9443092815526895}
[S17] START round=26 head_norm_before_train=2.095641 (no previous merge yet)
[S17] round=26 local utility u=0.000000 metrics={'f1_val': 0.6192489230869868, 'auprc': 0.8609322170712135, 'loss_val': 1.451093396995639, 'psi': 0.7159222406806776}-{'f1_val': 0.8420649586184568, 'auprc': 0.9791080130383247, 'loss_val': 0.650618488825923, 'psi': 0.896882180386404}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:49316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:49303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S3] → sending delta(kind=head bytes=1792) to S2@127.0.0.1:49302
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1804 to 1 peers)
[S3] sending update (kind=head size=1792 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1801) from S7
[S3] cosine check vs S7: cos=0.3983
[S16] RECEIVED delta(kind=head bytes=1804) from S9
[S16] cosine check vs S9: cos=0.4084
[S2] RECEIVED delta(kind=head bytes=1792) from S3
[S2] cosine check vs S3: cos=0.9286
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=26 metric=0.7174 head_norm=1.497033
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.780983e-01
[S2] stored merged vector for next round verification (round=26)
[S2] DEBUG after merge:  round=26 metric=0.7169 head_norm=1.432819 delta_norm=0.278098
[S2] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=26 metric=0.9980 head_norm=1.421095
[S3] _apply_head_vector_avg (torch): Δ‖w‖=7.607459e-01
[S3] stored merged vector for next round verification (round=26)
[S3] DEBUG after merge:  round=26 metric=0.9975 head_norm=1.158990 delta_norm=0.760746
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=26 metric=0.8254 head_norm=1.274622
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.799541e-01
[S16] stored merged vector for next round verification (round=26)
[S16] DEBUG after merge:  round=26 metric=0.7994 head_norm=1.191669 delta_norm=0.779954
[S16] aggregate: ROLLBACK (f1_val pre=0.825 post=0.799 tol_abs=0.005 tol_rel=0.0)
[S2] START round=27 head_norm_before_train=1.432819 cos_to_last_merge=1.0000 (last merge round=26)
[S2] round=27 local utility u=0.112719 metrics={'f1_val': 0.7168204846128714, 'auprc': 0.9278868138936442, 'loss_val': 0.39110698623549145, 'psi': 0.8012470163251806}-{'f1_val': 0.7174189264478343, 'auprc': 0.876071821669582, 'loss_val': 0.46469012868927634, 'psi': 0.7808800845365333}
[S3] START round=27 head_norm_before_train=1.158990 cos_to_last_merge=1.0000 (last merge round=26)
[S3] round=27 local utility u=0.000000 metrics={'f1_val': 0.8020741262472306, 'auprc': 0.9211545415322507, 'loss_val': 0.5008653287337962, 'psi': 0.8497062923612386}-{'f1_val': 0.9979722591986233, 'auprc': 0.9992434213815635, 'loss_val': 0.14339043220753347, 'psi': 0.9984807240717994}
[S4] START round=27 head_norm_before_train=1.736342 cos_to_last_merge=0.8769 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.877
[S4] round=27 local utility u=0.000000 metrics={'f1_val': 0.9399068045038146, 'auprc': 0.9604832984368437, 'loss_val': 0.30285672476092407, 'psi': 0.9481374020770261}-{'f1_val': 0.9406462735375676, 'auprc': 0.9728172575356061, 'loss_val': 0.29830894138229197, 'psi': 0.953514667136783}
[S5] START round=27 head_norm_before_train=1.726096 (no previous merge yet)
[S5] round=27 local utility u=0.304648 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9979932673532671, 'loss_val': 0.23225737430268978, 'psi': 0.8195623425389114}-{'f1_val': 0.7093590158793546, 'auprc': 0.8284845714285716, 'loss_val': 0.38553008232840846, 'psi': 0.7570092380990414}
[S6] START round=27 head_norm_before_train=1.691397 cos_to_last_merge=0.8309 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.831
[S6] round=27 local utility u=0.855165 metrics={'f1_val': 0.8236663211436355, 'auprc': 0.8222224048758673, 'loss_val': 0.5362900670781638, 'psi': 0.8230887546365282}-{'f1_val': 0.618793486576953, 'auprc': 0.7862269462124076, 'loss_val': 0.9093964437445838, 'psi': 0.6857668704311348}
[S7] START round=27 head_norm_before_train=1.350731 cos_to_last_merge=0.8147 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.815
[S7] round=27 local utility u=0.000000 metrics={'f1_val': 0.4868243771351958, 'auprc': 0.7220068076374098, 'loss_val': 0.8815068863455632, 'psi': 0.5808973493360814}-{'f1_val': 0.6484799426802401, 'auprc': 0.8038500511783284, 'loss_val': 0.509396767041453, 'psi': 0.7106279860794755}
[S8] START round=27 head_norm_before_train=1.758958 cos_to_last_merge=0.9997 (last merge round=25)
[S8] round=27 local utility u=0.000000 metrics={'f1_val': 0.9936253371144965, 'auprc': 0.9897746484864667, 'loss_val': 0.05428423873210715, 'psi': 0.9920850616632846}-{'f1_val': 0.9910860494090681, 'auprc': 0.999056260044067, 'loss_val': 0.06312534385808309, 'psi': 0.9942741336630676}
[S9] START round=27 head_norm_before_train=1.559534 cos_to_last_merge=0.9974 (last merge round=25)
[S9] round=27 local utility u=0.068775 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9962218181232074, 'loss_val': 0.1234932650787115, 'psi': 0.9967504747565686}-{'f1_val': 0.9880286744602689, 'auprc': 0.9946015327485109, 'loss_val': 0.20173706500815314, 'psi': 0.9906578177755656}
[S10] START round=27 head_norm_before_train=1.579914 cos_to_last_merge=0.9992 (last merge round=25)
[S10] round=27 local utility u=0.002476 metrics={'f1_val': 0.994378377236979, 'auprc': 0.9974910551729443, 'loss_val': 0.049463252996688974, 'psi': 0.9956234484113651}-{'f1_val': 0.9953063309450747, 'auprc': 0.9983064887024209, 'loss_val': 0.0624286895034858, 'psi': 0.9965063940480132}
[S11] START round=27 head_norm_before_train=1.831329 cos_to_last_merge=0.9992 (last merge round=24)
[S11] round=27 local utility u=0.020559 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9950811664818765, 'loss_val': 0.06853658659617519, 'psi': 0.9958155670740672}-{'f1_val': 0.9948632634592205, 'auprc': 0.9950732007770465, 'loss_val': 0.10097989763598968, 'psi': 0.9949472383863509}
[S13] START round=27 head_norm_before_train=1.484690 cos_to_last_merge=0.7963 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.796
[S13] round=27 local utility u=0.019664 metrics={'f1_val': 0.5936541053442015, 'auprc': 0.705884751192914, 'loss_val': 1.0070841656015141, 'psi': 0.6385463636836866}-{'f1_val': 0.5892392612438346, 'auprc': 0.6875348382625974, 'loss_val': 0.9648735070879103, 'psi': 0.6285574920513397}
[S14] START round=27 head_norm_before_train=1.970604 (no previous merge yet)
[S14] round=27 local utility u=0.006690 metrics={'f1_val': 0.9968189060544872, 'auprc': 0.9992348979906293, 'loss_val': 0.025621007964182884, 'psi': 0.9977853028289441}-{'f1_val': 0.995501598651872, 'auprc': 0.9991056931813711, 'loss_val': 0.0307101135339707, 'psi': 0.9969432364636717}
[S15] START round=27 head_norm_before_train=1.331235 cos_to_last_merge=0.9965 (last merge round=25)
[S15] round=27 local utility u=0.000000 metrics={'f1_val': 0.9027624067881995, 'auprc': 0.9924965062244018, 'loss_val': 0.21553858599546932, 'psi': 0.9386560465626804}-{'f1_val': 0.9963164379542544, 'auprc': 0.9909850382993751, 'loss_val': 0.1755297503404736, 'psi': 0.9941838780923027}
[S16] START round=27 head_norm_before_train=1.191669 cos_to_last_merge=1.0000 (last merge round=26)
[S16] round=27 local utility u=0.289442 metrics={'f1_val': 0.9310878070270174, 'auprc': 0.9379867485857811, 'loss_val': 0.43512524526654994, 'psi': 0.9338473836505229}-{'f1_val': 0.8253984773216877, 'auprc': 0.9773821750994843, 'loss_val': 0.49805939567950996, 'psi': 0.8861919564328063}
[S17] START round=27 head_norm_before_train=2.106050 (no previous merge yet)
[S17] round=27 local utility u=1.000000 metrics={'f1_val': 0.832976864907603, 'auprc': 0.9375663576879331, 'loss_val': 0.6630674125467064, 'psi': 0.8748126620197351}-{'f1_val': 0.6192489230869868, 'auprc': 0.8609322170712135, 'loss_val': 1.451093396995639, 'psi': 0.7159222406806776}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:49310
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:49309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:49309
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:49311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:49315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:49315
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:49316
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1798) from S10
[S9] cosine check vs S10: cos=0.7607
[S15] RECEIVED delta(kind=head bytes=1798) from S11
[S15] cosine check vs S11: cos=0.6444
[S10] RECEIVED delta(kind=head bytes=1802) from S13
[S10] cosine check vs S13: cos=0.9726
[S15] RECEIVED delta(kind=head bytes=1798) from S2
[S15] cosine check vs S2: cos=0.8293
[S16] RECEIVED delta(kind=head bytes=1803) from S5
[S16] cosine check vs S5: cos=0.4527
[S8] RECEIVED delta(kind=head bytes=1797) from S6
[S8] cosine check vs S6: cos=0.9913
[S8] RECEIVED delta(kind=head bytes=1799) from S14
[S8] cosine check vs S14: cos=-0.0609
[S8] DROPPED delta from S14 (cos=-0.0609 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:49314
[S16] sending update (kind=head size=1802 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1802) from S16
[S14] cosine check vs S16: cos=-0.0783
[S14] DROPPED delta from S16 (cos=-0.0783 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:49303
[S17] sending update (kind=head size=1797 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1797) from S17
[S3] cosine check vs S17: cos=0.5688
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=27 metric=0.8021 head_norm=1.181958
[S3] _apply_head_vector_avg (torch): Δ‖w‖=8.689117e-01
[S3] stored merged vector for next round verification (round=27)
[S3] DEBUG after merge:  round=27 metric=0.7665 head_norm=1.474910 delta_norm=0.868912
[S3] aggregate: ROLLBACK (f1_val pre=0.802 post=0.766 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=27 metric=0.9971 head_norm=1.594339
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.573888e-01
[S9] stored merged vector for next round verification (round=27)
[S9] DEBUG after merge:  round=27 metric=0.9971 head_norm=1.511256 delta_norm=0.557389
[S9] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=27 metric=0.9944 head_norm=1.627032
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.935366e-01
[S10] stored merged vector for next round verification (round=27)
[S10] DEBUG after merge:  round=27 metric=0.9942 head_norm=1.553015 delta_norm=0.193537
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=27 metric=0.9936 head_norm=1.797124
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.241402e-01
[S8] stored merged vector for next round verification (round=27)
[S8] DEBUG after merge:  round=27 metric=0.9942 head_norm=1.747096 delta_norm=0.124140
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=27 metric=0.9028 head_norm=1.395587
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.386386e-01
[S15] stored merged vector for next round verification (round=27)
[S15] DEBUG after merge:  round=27 metric=0.9036 head_norm=1.319897 delta_norm=0.238639
[S15] aggregate: ACCEPT kept=['S11', 'S2'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=27 metric=0.9311 head_norm=1.227183
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.049976e-01
[S16] stored merged vector for next round verification (round=27)
[S16] DEBUG after merge:  round=27 metric=0.9238 head_norm=1.269987 delta_norm=0.804998
[S16] aggregate: ROLLBACK (f1_val pre=0.931 post=0.924 tol_abs=0.005 tol_rel=0.0)
[S2] START round=28 head_norm_before_train=1.471117 cos_to_last_merge=0.9995 (last merge round=26)
[S2] round=28 local utility u=0.000000 metrics={'f1_val': 0.7225285795413352, 'auprc': 0.8989288514925569, 'loss_val': 0.39946546147649176, 'psi': 0.7930886883218239}-{'f1_val': 0.7168204846128714, 'auprc': 0.9278868138936442, 'loss_val': 0.39110698623549145, 'psi': 0.8012470163251806}
[S3] START round=28 head_norm_before_train=1.474910 cos_to_last_merge=1.0000 (last merge round=27)
[S3] round=28 local utility u=0.823085 metrics={'f1_val': 0.9823138762891266, 'auprc': 0.9991061094231155, 'loss_val': 0.16998893671182852, 'psi': 0.9890307695427221}-{'f1_val': 0.8020741262472306, 'auprc': 0.9211545415322507, 'loss_val': 0.5008653287337962, 'psi': 0.8497062923612386}
[S4] START round=28 head_norm_before_train=1.744726 cos_to_last_merge=0.8752 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.875
[S4] round=28 local utility u=0.009275 metrics={'f1_val': 0.9444214856823375, 'auprc': 0.9527207722576422, 'loss_val': 0.28810711319618526, 'psi': 0.9477412003124593}-{'f1_val': 0.9399068045038146, 'auprc': 0.9604832984368437, 'loss_val': 0.30285672476092407, 'psi': 0.9481374020770261}
[S5] START round=28 head_norm_before_train=1.736605 (no previous merge yet)
[S5] round=28 local utility u=0.000000 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9979841079067477, 'loss_val': 0.23301542855365667, 'psi': 0.8195586787603037}-{'f1_val': 0.7006083926626743, 'auprc': 0.9979932673532671, 'loss_val': 0.23225737430268978, 'psi': 0.8195623425389114}
[S6] START round=28 head_norm_before_train=1.704656 cos_to_last_merge=0.8304 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.830
[S6] round=28 local utility u=0.387358 metrics={'f1_val': 0.846700113862009, 'auprc': 0.9630611486829157, 'loss_val': 0.3222938770472502, 'psi': 0.8932445277903717}-{'f1_val': 0.8236663211436355, 'auprc': 0.8222224048758673, 'loss_val': 0.5362900670781638, 'psi': 0.8230887546365282}
[S7] START round=28 head_norm_before_train=1.364929 cos_to_last_merge=0.8109 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.811
[S7] round=28 local utility u=0.788122 metrics={'f1_val': 0.6421590533210693, 'auprc': 0.8184930196502153, 'loss_val': 0.5267298863767303, 'psi': 0.7126926398527277}-{'f1_val': 0.4868243771351958, 'auprc': 0.7220068076374098, 'loss_val': 0.8815068863455632, 'psi': 0.5808973493360814}
[S8] START round=28 head_norm_before_train=1.747096 cos_to_last_merge=1.0000 (last merge round=27)
[S8] round=28 local utility u=0.000000 metrics={'f1_val': 0.9885804511658192, 'auprc': 0.9989034763160876, 'loss_val': 0.07092994046303173, 'psi': 0.9927096612259265}-{'f1_val': 0.9936253371144965, 'auprc': 0.9897746484864667, 'loss_val': 0.05428423873210715, 'psi': 0.9920850616632846}
[S9] START round=28 head_norm_before_train=1.511256 cos_to_last_merge=1.0000 (last merge round=27)
[S9] round=28 local utility u=0.000000 metrics={'f1_val': 0.9922651407836713, 'auprc': 0.9981261351708726, 'loss_val': 0.2121040319376222, 'psi': 0.9946095385385518}-{'f1_val': 0.9971029125121428, 'auprc': 0.9962218181232074, 'loss_val': 0.1234932650787115, 'psi': 0.9967504747565686}
[S10] START round=28 head_norm_before_train=1.553015 cos_to_last_merge=1.0000 (last merge round=27)
[S10] round=28 local utility u=0.000000 metrics={'f1_val': 0.9943532786287019, 'auprc': 0.9970291496106846, 'loss_val': 0.06340559620453891, 'psi': 0.9954236270214949}-{'f1_val': 0.994378377236979, 'auprc': 0.9974910551729443, 'loss_val': 0.049463252996688974, 'psi': 0.9956234484113651}
[S11] START round=28 head_norm_before_train=1.854544 cos_to_last_merge=0.9984 (last merge round=24)
[S11] round=28 local utility u=0.010949 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9984892276329155, 'loss_val': 0.056863164459994786, 'psi': 0.9971787915344827}-{'f1_val': 0.996305167468861, 'auprc': 0.9950811664818765, 'loss_val': 0.06853658659617519, 'psi': 0.9958155670740672}
[S13] START round=28 head_norm_before_train=1.500464 cos_to_last_merge=0.7947 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.795
[S13] round=28 local utility u=0.205989 metrics={'f1_val': 0.6111432549302073, 'auprc': 0.7778137491391972, 'loss_val': 0.915827759134423, 'psi': 0.6778114526138033}-{'f1_val': 0.5936541053442015, 'auprc': 0.705884751192914, 'loss_val': 1.0070841656015141, 'psi': 0.6385463636836866}
[S14] START round=28 head_norm_before_train=1.979645 (no previous merge yet)
[S14] round=28 local utility u=0.001086 metrics={'f1_val': 0.9971680177638609, 'auprc': 0.9988969881762129, 'loss_val': 0.024529362360276495, 'psi': 0.9978596059288016}-{'f1_val': 0.9968189060544872, 'auprc': 0.9992348979906293, 'loss_val': 0.025621007964182884, 'psi': 0.9977853028289441}
[S15] START round=28 head_norm_before_train=1.319897 cos_to_last_merge=1.0000 (last merge round=27)
[S15] round=28 local utility u=0.000000 metrics={'f1_val': 0.7008305005721126, 'auprc': 0.987765856878511, 'loss_val': 0.45749752244053965, 'psi': 0.815604643094672}-{'f1_val': 0.9027624067881995, 'auprc': 0.9924965062244018, 'loss_val': 0.21553858599546932, 'psi': 0.9386560465626804}
[S16] START round=28 head_norm_before_train=1.269987 cos_to_last_merge=1.0000 (last merge round=27)
[S16] round=28 local utility u=0.000000 metrics={'f1_val': 0.8552706866216471, 'auprc': 0.9767172817526283, 'loss_val': 0.40895382962700927, 'psi': 0.9038493246740396}-{'f1_val': 0.9310878070270174, 'auprc': 0.9379867485857811, 'loss_val': 0.43512524526654994, 'psi': 0.9338473836505229}
[S17] START round=28 head_norm_before_train=2.112750 (no previous merge yet)
[S17] round=28 local utility u=0.000000 metrics={'f1_val': 0.6365456227832662, 'auprc': 0.8009413772632807, 'loss_val': 1.3856729821235267, 'psi': 0.702303924575272}-{'f1_val': 0.832976864907603, 'auprc': 0.9375663576879331, 'loss_val': 0.6630674125467064, 'psi': 0.8748126620197351}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:49304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:49316
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:49317
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1801) from S14
[S16] cosine check vs S14: cos=-0.0869
[S16] DROPPED delta from S14 (cos=-0.0869 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1800) from S3
[S17] cosine check vs S3: cos=0.9431
[S4] RECEIVED delta(kind=head bytes=1797) from S11
[S4] cosine check vs S11: cos=0.9827
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=28 metric=0.9444 head_norm=1.754902
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.797277e-01
[S4] stored merged vector for next round verification (round=28)
[S4] DEBUG after merge:  round=28 metric=0.9444 head_norm=1.808502 delta_norm=0.179728
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=28 metric=0.6365 head_norm=2.125028
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.347577e-01
[S17] stored merged vector for next round verification (round=28)
[S17] DEBUG after merge:  round=28 metric=0.6382 head_norm=1.786042 delta_norm=0.434758
[S17] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=29 head_norm_before_train=1.518004 cos_to_last_merge=0.9977 (last merge round=26)
[S2] round=29 local utility u=0.140216 metrics={'f1_val': 0.779519095905341, 'auprc': 0.8782836406268644, 'loss_val': 0.3990410069160407, 'psi': 0.8190249137939503}-{'f1_val': 0.7225285795413352, 'auprc': 0.8989288514925569, 'loss_val': 0.39946546147649176, 'psi': 0.7930886883218239}
[S3] START round=29 head_norm_before_train=1.497391 cos_to_last_merge=0.9998 (last merge round=27)
[S3] round=29 local utility u=0.000000 metrics={'f1_val': 0.7299450892938284, 'auprc': 0.9481458018030313, 'loss_val': 0.4084577647293623, 'psi': 0.8172253742975095}-{'f1_val': 0.9823138762891266, 'auprc': 0.9991061094231155, 'loss_val': 0.16998893671182852, 'psi': 0.9890307695427221}
[S4] START round=29 head_norm_before_train=1.808502 cos_to_last_merge=1.0000 (last merge round=28)
[S4] round=29 local utility u=0.023089 metrics={'f1_val': 0.9538255354322794, 'auprc': 0.9475571070396188, 'loss_val': 0.28286187762624315, 'psi': 0.9513181640752152}-{'f1_val': 0.9444214856823375, 'auprc': 0.9527207722576422, 'loss_val': 0.28810711319618526, 'psi': 0.9477412003124593}
[S5] START round=29 head_norm_before_train=1.746680 (no previous merge yet)
[S5] round=29 local utility u=0.000000 metrics={'f1_val': 0.7047360009058722, 'auprc': 0.9051576930051659, 'loss_val': 0.292175943358517, 'psi': 0.7849046777455897}-{'f1_val': 0.7006083926626743, 'auprc': 0.9979841079067477, 'loss_val': 0.23301542855365667, 'psi': 0.8195586787603037}
[S6] START round=29 head_norm_before_train=1.718807 cos_to_last_merge=0.8299 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.830
[S6] round=29 local utility u=0.411296 metrics={'f1_val': 0.9642706443787616, 'auprc': 0.9543967704862714, 'loss_val': 0.17913099328329815, 'psi': 0.9603210948217655}-{'f1_val': 0.846700113862009, 'auprc': 0.9630611486829157, 'loss_val': 0.3222938770472502, 'psi': 0.8932445277903717}
[S7] START round=29 head_norm_before_train=1.377927 cos_to_last_merge=0.8078 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.808
[S7] round=29 local utility u=0.000000 metrics={'f1_val': 0.4809580668721364, 'auprc': 0.7768954074525314, 'loss_val': 0.8838148539215654, 'psi': 0.5993330031042944}-{'f1_val': 0.6421590533210693, 'auprc': 0.8184930196502153, 'loss_val': 0.5267298863767303, 'psi': 0.7126926398527277}
[S8] START round=29 head_norm_before_train=1.779378 cos_to_last_merge=0.9998 (last merge round=27)
[S8] round=29 local utility u=0.001925 metrics={'f1_val': 0.9929024225986427, 'auprc': 0.9866382097196985, 'loss_val': 0.056215160809116024, 'psi': 0.990396737447065}-{'f1_val': 0.9885804511658192, 'auprc': 0.9989034763160876, 'loss_val': 0.07092994046303173, 'psi': 0.9927096612259265}
[S9] START round=29 head_norm_before_train=1.540066 cos_to_last_merge=0.9982 (last merge round=27)
[S9] round=29 local utility u=0.046935 metrics={'f1_val': 0.9958557717480525, 'auprc': 0.9982015413979961, 'loss_val': 0.14000317108626303, 'psi': 0.9967940796080299}-{'f1_val': 0.9922651407836713, 'auprc': 0.9981261351708726, 'loss_val': 0.2121040319376222, 'psi': 0.9946095385385518}
[S10] START round=29 head_norm_before_train=1.599157 cos_to_last_merge=0.9989 (last merge round=27)
[S10] round=29 local utility u=0.009407 metrics={'f1_val': 0.9947918903119958, 'auprc': 0.9972321155990891, 'loss_val': 0.047832109409670975, 'psi': 0.9957679804268331}-{'f1_val': 0.9943532786287019, 'auprc': 0.9970291496106846, 'loss_val': 0.06340559620453891, 'psi': 0.9954236270214949}
[S11] START round=29 head_norm_before_train=1.877841 cos_to_last_merge=0.9975 (last merge round=24)
[S11] round=29 local utility u=0.003858 metrics={'f1_val': 0.9962850284706224, 'auprc': 0.9984764452360437, 'loss_val': 0.048987456976922826, 'psi': 0.9971615951767909}-{'f1_val': 0.996305167468861, 'auprc': 0.9984892276329155, 'loss_val': 0.056863164459994786, 'psi': 0.9971787915344827}
[S13] START round=29 head_norm_before_train=1.516355 cos_to_last_merge=0.7927 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.793
[S13] round=29 local utility u=0.032941 metrics={'f1_val': 0.6178874254093244, 'auprc': 0.7864537949875521, 'loss_val': 0.9163303874649971, 'psi': 0.6853139732406155}-{'f1_val': 0.6111432549302073, 'auprc': 0.7778137491391972, 'loss_val': 0.915827759134423, 'psi': 0.6778114526138033}
[S14] START round=29 head_norm_before_train=1.988558 (no previous merge yet)
[S14] round=29 local utility u=0.000000 metrics={'f1_val': 0.9971680177638609, 'auprc': 0.9986415555045776, 'loss_val': 0.026658412553326464, 'psi': 0.9977574328601475}-{'f1_val': 0.9971680177638609, 'auprc': 0.9988969881762129, 'loss_val': 0.024529362360276495, 'psi': 0.9978596059288016}
[S15] START round=29 head_norm_before_train=1.369640 cos_to_last_merge=0.9986 (last merge round=27)
[S15] round=29 local utility u=1.000000 metrics={'f1_val': 0.9960957151763188, 'auprc': 0.992953334174409, 'loss_val': 0.09193433614468838, 'psi': 0.9948387627755548}-{'f1_val': 0.7008305005721126, 'auprc': 0.987765856878511, 'loss_val': 0.45749752244053965, 'psi': 0.815604643094672}
[S16] START round=29 head_norm_before_train=1.311850 cos_to_last_merge=0.9985 (last merge round=27)
[S16] round=29 local utility u=0.000000 metrics={'f1_val': 0.8434982272529217, 'auprc': 0.9916799312656612, 'loss_val': 0.5856565405817532, 'psi': 0.9027709088580175}-{'f1_val': 0.8552706866216471, 'auprc': 0.9767172817526283, 'loss_val': 0.40895382962700927, 'psi': 0.9038493246740396}
[S17] START round=29 head_norm_before_train=1.786042 cos_to_last_merge=1.0000 (last merge round=28)
[S17] round=29 local utility u=0.885177 metrics={'f1_val': 0.7576668934957087, 'auprc': 0.9448113190443389, 'loss_val': 0.7736566947873518, 'psi': 0.8325246637151609}-{'f1_val': 0.6365456227832662, 'auprc': 0.8009413772632807, 'loss_val': 1.3856729821235267, 'psi': 0.702303924575272}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:49313
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1801 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1801) from S10
[S13] cosine check vs S10: cos=0.9784
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:49304
[S11] sending update (kind=head size=1797 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1797) from S11
[S4] cosine check vs S11: cos=0.9944
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] sending update (kind=head size=1794 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:49303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:49307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:49309
[S2] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1802) from S9
[S8] cosine check vs S9: cos=0.7732
[S3] RECEIVED delta(kind=head bytes=1802) from S2
[S3] cosine check vs S2: cos=0.9523
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:49302
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1800 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1800) from S15
[S2] cosine check vs S15: cos=0.7558
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1800) from S8
[S6] cosine check vs S8: cos=0.9939
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=29 metric=0.9538 head_norm=1.815724
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.072288e-01
[S4] stored merged vector for next round verification (round=29)
[S4] DEBUG after merge:  round=29 metric=0.9537 head_norm=1.856089 delta_norm=0.107229
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=29 metric=0.7299 head_norm=1.518276
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.388242e-01
[S3] stored merged vector for next round verification (round=29)
[S3] DEBUG after merge:  round=29 metric=0.7272 head_norm=1.521393 delta_norm=0.238824
[S3] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=29 metric=0.7795 head_norm=1.561469
[S2] _apply_head_vector_avg (torch): Δ‖w‖=5.240878e-01
[S2] stored merged vector for next round verification (round=29)
[S2] DEBUG after merge:  round=29 metric=0.7610 head_norm=1.392653 delta_norm=0.524088
[S2] aggregate: ROLLBACK (f1_val pre=0.780 post=0.761 tol_abs=0.005 tol_rel=0.0)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=29 metric=0.6179 head_norm=1.531618
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.739233e-01
[S13] stored merged vector for next round verification (round=29)
[S13] DEBUG after merge:  round=29 metric=0.6131 head_norm=1.578438 delta_norm=0.173923
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=29 metric=0.9643 head_norm=1.739552
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.047061e-01
[S6] stored merged vector for next round verification (round=29)
[S6] DEBUG after merge:  round=29 metric=0.9655 head_norm=1.773738 delta_norm=0.104706
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=29 metric=0.9929 head_norm=1.813333
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.814055e-01
[S8] stored merged vector for next round verification (round=29)
[S8] DEBUG after merge:  round=29 metric=0.9935 head_norm=1.595905 delta_norm=0.581406
[S8] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=30 head_norm_before_train=1.392653 cos_to_last_merge=1.0000 (last merge round=29)
[S2] round=30 local utility u=0.000000 metrics={'f1_val': 0.7538645437678428, 'auprc': 0.8185965123707335, 'loss_val': 0.5634798841173845, 'psi': 0.7797573312089991}-{'f1_val': 0.779519095905341, 'auprc': 0.8782836406268644, 'loss_val': 0.3990410069160407, 'psi': 0.8190249137939503}
[S3] START round=30 head_norm_before_train=1.521393 cos_to_last_merge=1.0000 (last merge round=29)
[S3] round=30 local utility u=0.281514 metrics={'f1_val': 0.7943110825497272, 'auprc': 0.9747463514959327, 'loss_val': 0.31142816865876755, 'psi': 0.8664851901282093}-{'f1_val': 0.7299450892938284, 'auprc': 0.9481458018030313, 'loss_val': 0.4084577647293623, 'psi': 0.8172253742975095}
[S4] START round=30 head_norm_before_train=1.856089 cos_to_last_merge=1.0000 (last merge round=29)
[S4] round=30 local utility u=0.000000 metrics={'f1_val': 0.9478056832664892, 'auprc': 0.9516053814841212, 'loss_val': 0.2966711640380324, 'psi': 0.9493255625535421}-{'f1_val': 0.9538255354322794, 'auprc': 0.9475571070396188, 'loss_val': 0.28286187762624315, 'psi': 0.9513181640752152}
[S5] START round=30 head_norm_before_train=1.754700 (no previous merge yet)
[S5] round=30 local utility u=0.165397 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9979852497285838, 'loss_val': 0.21509954932227096, 'psi': 0.8195591354890381}-{'f1_val': 0.7047360009058722, 'auprc': 0.9051576930051659, 'loss_val': 0.292175943358517, 'psi': 0.7849046777455897}
[S6] START round=30 head_norm_before_train=1.773738 cos_to_last_merge=1.0000 (last merge round=29)
[S6] round=30 local utility u=0.000000 metrics={'f1_val': 0.7506640800978329, 'auprc': 0.9227502118422728, 'loss_val': 0.6193935115630882, 'psi': 0.8194985327956088}-{'f1_val': 0.9642706443787616, 'auprc': 0.9543967704862714, 'loss_val': 0.17913099328329815, 'psi': 0.9603210948217655}
[S7] START round=30 head_norm_before_train=1.387848 cos_to_last_merge=0.8054 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.805
[S7] round=30 local utility u=0.860921 metrics={'f1_val': 0.6692928918521638, 'auprc': 0.830539153070803, 'loss_val': 0.4529130337113773, 'psi': 0.7337913963396194}-{'f1_val': 0.4809580668721364, 'auprc': 0.7768954074525314, 'loss_val': 0.8838148539215654, 'psi': 0.5993330031042944}
[S8] START round=30 head_norm_before_train=1.595905 cos_to_last_merge=1.0000 (last merge round=29)
[S8] round=30 local utility u=0.000000 metrics={'f1_val': 0.9929446689102408, 'auprc': 0.9914674016760688, 'loss_val': 0.07110582520341993, 'psi': 0.992353762016572}-{'f1_val': 0.9929024225986427, 'auprc': 0.9866382097196985, 'loss_val': 0.056215160809116024, 'psi': 0.990396737447065}
[S9] START round=30 head_norm_before_train=1.575346 cos_to_last_merge=0.9937 (last merge round=27)
[S9] round=30 local utility u=0.019102 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9965771682629032, 'loss_val': 0.1017551522306896, 'psi': 0.9966271743934961}-{'f1_val': 0.9958557717480525, 'auprc': 0.9982015413979961, 'loss_val': 0.14000317108626303, 'psi': 0.9967940796080299}
[S10] START round=30 head_norm_before_train=1.642429 cos_to_last_merge=0.9963 (last merge round=27)
[S10] round=30 local utility u=0.007809 metrics={'f1_val': 0.9957210358491089, 'auprc': 0.9976262480690994, 'loss_val': 0.038971709106690934, 'psi': 0.9964831207371051}-{'f1_val': 0.9947918903119958, 'auprc': 0.9972321155990891, 'loss_val': 0.047832109409670975, 'psi': 0.9957679804268331}
[S11] START round=30 head_norm_before_train=1.901651 cos_to_last_merge=0.9964 (last merge round=24)
[S11] round=30 local utility u=0.003865 metrics={'f1_val': 0.9967189926998994, 'auprc': 0.99856569472758, 'loss_val': 0.04412899268565893, 'psi': 0.9974576735109716}-{'f1_val': 0.9962850284706224, 'auprc': 0.9984764452360437, 'loss_val': 0.048987456976922826, 'psi': 0.9971615951767909}
[S13] START round=30 head_norm_before_train=1.578438 cos_to_last_merge=1.0000 (last merge round=29)
[S13] round=30 local utility u=0.084495 metrics={'f1_val': 0.6263217166443693, 'auprc': 0.7910946079610319, 'loss_val': 0.811869380610089, 'psi': 0.6922308731710344}-{'f1_val': 0.6178874254093244, 'auprc': 0.7864537949875521, 'loss_val': 0.9163303874649971, 'psi': 0.6853139732406155}
[S14] START round=30 head_norm_before_train=1.999553 (no previous merge yet)
[S14] round=30 local utility u=0.000000 metrics={'f1_val': 0.9970007132142444, 'auprc': 0.993043850847038, 'loss_val': 0.024003842278263583, 'psi': 0.9954179682673618}-{'f1_val': 0.9971680177638609, 'auprc': 0.9986415555045776, 'loss_val': 0.026658412553326464, 'psi': 0.9977574328601475}
[S15] START round=30 head_norm_before_train=1.410715 cos_to_last_merge=0.9956 (last merge round=27)
[S15] round=30 local utility u=0.016201 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9961618139550459, 'loss_val': 0.07306273617635516, 'psi': 0.9965127266145307}-{'f1_val': 0.9960957151763188, 'auprc': 0.992953334174409, 'loss_val': 0.09193433614468838, 'psi': 0.9948387627755548}
[S16] START round=30 head_norm_before_train=1.351888 cos_to_last_merge=0.9950 (last merge round=27)
[S16] round=30 local utility u=0.261218 metrics={'f1_val': 0.8861369775350024, 'auprc': 0.9785523661671482, 'loss_val': 0.27967032413245446, 'psi': 0.9231031329878607}-{'f1_val': 0.8434982272529217, 'auprc': 0.9916799312656612, 'loss_val': 0.5856565405817532, 'psi': 0.9027709088580175}
[S17] START round=30 head_norm_before_train=1.808854 cos_to_last_merge=0.9999 (last merge round=28)
[S17] round=30 local utility u=0.000000 metrics={'f1_val': 0.7430675370246848, 'auprc': 0.9587128643971445, 'loss_val': 0.7915943972059206, 'psi': 0.8293256679736687}-{'f1_val': 0.7576668934957087, 'auprc': 0.9448113190443389, 'loss_val': 0.7736566947873518, 'psi': 0.8325246637151609}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:49309
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:49315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:49313
[S10] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1800) from S10
[S13] cosine check vs S10: cos=0.9919
[S8] RECEIVED delta(kind=head bytes=1799) from S9
[S8] cosine check vs S9: cos=0.9271
[S15] RECEIVED delta(kind=head bytes=1801) from S5
[S15] cosine check vs S5: cos=-0.1060
[S15] DROPPED delta from S5 (cos=-0.1060 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S11] → sending delta(kind=head bytes=1790) to S4@127.0.0.1:49304
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1790 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1790) from S11
[S4] cosine check vs S11: cos=0.9978
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:49305
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:49302
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:49317
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1804 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1804) from S16
[S5] cosine check vs S16: cos=0.8831
[S15] sending update (kind=head size=1802 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1802) from S15
[S2] cosine check vs S15: cos=0.9189
[S3] sending update (kind=head size=1802 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1802) from S3
[S17] cosine check vs S3: cos=0.9515
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] ⇄ pheromone p=0.011 → S13@127.0.0.1:49313
[S11] ⇄ pheromone p=0.026 → S4@127.0.0.1:49304
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=30 metric=0.6263 head_norm=1.592206
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.124740e-01
[S13] stored merged vector for next round verification (round=30)
[S13] DEBUG after merge:  round=30 metric=0.6250 head_norm=1.631560 delta_norm=0.112474
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.010 → S16@127.0.0.1:49316
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=30 metric=0.7539 head_norm=1.436683
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.904884e-01
[S2] stored merged vector for next round verification (round=30)
[S2] DEBUG after merge:  round=30 metric=0.7466 head_norm=1.412379 delta_norm=0.290488
[S2] aggregate: ROLLBACK (f1_val pre=0.754 post=0.747 tol_abs=0.005 tol_rel=0.0)
[S2] ⇄ pheromone p=0.072 → S3@127.0.0.1:49303
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=30 metric=0.9478 head_norm=1.857102
[S4] _apply_head_vector_avg (torch): Δ‖w‖=7.150905e-02
[S4] stored merged vector for next round verification (round=30)
[S4] DEBUG after merge:  round=30 metric=0.9478 head_norm=1.889395 delta_norm=0.071509
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.015 → S11@127.0.0.1:49312
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=30 metric=0.9929 head_norm=1.636015
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.102646e-01
[S8] stored merged vector for next round verification (round=30)
[S8] DEBUG after merge:  round=30 metric=0.9933 head_norm=1.593805 delta_norm=0.310265
[S8] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.030 → S6@127.0.0.1:49307
[S15] ⇄ pheromone p=0.256 → S2@127.0.0.1:49302
[S9] ⇄ pheromone p=0.043 → S8@127.0.0.1:49309
[S3] ⇄ pheromone p=0.244 → S17@127.0.0.1:49317
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=30 metric=0.7006 head_norm=1.760208
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.210157e-01
[S5] stored merged vector for next round verification (round=30)
[S5] DEBUG after merge:  round=30 metric=0.7006 head_norm=1.529237 delta_norm=0.421016
[S5] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.101 → S15@127.0.0.1:49315
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=30 metric=0.7431 head_norm=1.837059
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.010251e-01
[S17] stored merged vector for next round verification (round=30)
[S17] DEBUG after merge:  round=30 metric=0.7449 head_norm=1.668504 delta_norm=0.301025
[S17] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.139 → S5@127.0.0.1:49305
[S2] START round=31 head_norm_before_train=1.412379 cos_to_last_merge=1.0000 (last merge round=30)
[S2] round=31 local utility u=0.248922 metrics={'f1_val': 0.7921298676371629, 'auprc': 0.8623515593150644, 'loss_val': 0.4264932801061122, 'psi': 0.8202185443083234}-{'f1_val': 0.7538645437678428, 'auprc': 0.8185965123707335, 'loss_val': 0.5634798841173845, 'psi': 0.7797573312089991}
[S3] START round=31 head_norm_before_train=1.540862 cos_to_last_merge=0.9999 (last merge round=29)
[S3] round=31 local utility u=0.185891 metrics={'f1_val': 0.8485852221956507, 'auprc': 0.9726431638871861, 'loss_val': 0.25898157403839467, 'psi': 0.8982083988722649}-{'f1_val': 0.7943110825497272, 'auprc': 0.9747463514959327, 'loss_val': 0.31142816865876755, 'psi': 0.8664851901282093}
[S4] START round=31 head_norm_before_train=1.889395 cos_to_last_merge=1.0000 (last merge round=30)
[S4] round=31 local utility u=0.000000 metrics={'f1_val': 0.9406276779496527, 'auprc': 0.9633970654093222, 'loss_val': 0.3131498123664954, 'psi': 0.9497354329335206}-{'f1_val': 0.9478056832664892, 'auprc': 0.9516053814841212, 'loss_val': 0.2966711640380324, 'psi': 0.9493255625535421}
[S5] START round=31 head_norm_before_train=1.529237 cos_to_last_merge=1.0000 (last merge round=30)
[S5] round=31 local utility u=0.000000 metrics={'f1_val': 0.7006073928698142, 'auprc': 0.9973470264133583, 'loss_val': 0.23446463226045988, 'psi': 0.8193032462872318}-{'f1_val': 0.7006083926626743, 'auprc': 0.9979852497285838, 'loss_val': 0.21509954932227096, 'psi': 0.8195591354890381}
[S6] START round=31 head_norm_before_train=1.793404 cos_to_last_merge=0.9999 (last merge round=29)
[S6] round=31 local utility u=0.000000 metrics={'f1_val': 0.6365230506008558, 'auprc': 0.8046682747099313, 'loss_val': 0.8093525877338033, 'psi': 0.703781140244486}-{'f1_val': 0.7506640800978329, 'auprc': 0.9227502118422728, 'loss_val': 0.6193935115630882, 'psi': 0.8194985327956088}
[S7] START round=31 head_norm_before_train=1.397046 cos_to_last_merge=0.8034 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.803
[S7] round=31 local utility u=0.000000 metrics={'f1_val': 0.5654029525886772, 'auprc': 0.7810598586362137, 'loss_val': 0.7605874444052916, 'psi': 0.6516657150076919}-{'f1_val': 0.6692928918521638, 'auprc': 0.830539153070803, 'loss_val': 0.4529130337113773, 'psi': 0.7337913963396194}
[S8] START round=31 head_norm_before_train=1.593805 cos_to_last_merge=1.0000 (last merge round=30)
[S8] round=31 local utility u=0.000000 metrics={'f1_val': 0.9864436062227302, 'auprc': 0.9988755625093111, 'loss_val': 0.09325297483386313, 'psi': 0.9914163887373626}-{'f1_val': 0.9929446689102408, 'auprc': 0.9914674016760688, 'loss_val': 0.07110582520341993, 'psi': 0.992353762016572}
[S9] START round=31 head_norm_before_train=1.611339 cos_to_last_merge=0.9883 (last merge round=27)
[S9] round=31 local utility u=0.015383 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9982893805515157, 'loss_val': 0.07877993928474351, 'psi': 0.997577499727892}-{'f1_val': 0.9966605118138915, 'auprc': 0.9965771682629032, 'loss_val': 0.1017551522306896, 'psi': 0.9966271743934961}
[S10] START round=31 head_norm_before_train=1.677544 cos_to_last_merge=0.9938 (last merge round=27)
[S10] round=31 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.996141645699713, 'loss_val': 0.03672042191153752, 'psi': 0.9954375701989309}-{'f1_val': 0.9957210358491089, 'auprc': 0.9976262480690994, 'loss_val': 0.038971709106690934, 'psi': 0.9964831207371051}
[S11] START round=31 head_norm_before_train=1.923805 cos_to_last_merge=0.9952 (last merge round=24)
[S11] round=31 local utility u=0.000000 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9967343182415003, 'loss_val': 0.04197469860103904, 'psi': 0.9964768277779167}-{'f1_val': 0.9967189926998994, 'auprc': 0.99856569472758, 'loss_val': 0.04412899268565893, 'psi': 0.9974576735109716}
[S13] START round=31 head_norm_before_train=1.631560 cos_to_last_merge=1.0000 (last merge round=30)
[S13] round=31 local utility u=0.000000 metrics={'f1_val': 0.6214061372421509, 'auprc': 0.7881204135666466, 'loss_val': 0.9227818982373565, 'psi': 0.6880918477719492}-{'f1_val': 0.6263217166443693, 'auprc': 0.7910946079610319, 'loss_val': 0.811869380610089, 'psi': 0.6922308731710344}
[S14] START round=31 head_norm_before_train=2.010934 (no previous merge yet)
[S14] round=31 local utility u=0.009633 metrics={'f1_val': 0.9972435617623723, 'auprc': 0.9977703202484938, 'loss_val': 0.020375236293411713, 'psi': 0.9974542651568209}-{'f1_val': 0.9970007132142444, 'auprc': 0.993043850847038, 'loss_val': 0.024003842278263583, 'psi': 0.9954179682673618}
[S15] START round=31 head_norm_before_train=1.447183 cos_to_last_merge=0.9925 (last merge round=27)
[S15] round=31 local utility u=0.000000 metrics={'f1_val': 0.8018839131154283, 'auprc': 0.990229766230077, 'loss_val': 0.3223248802445408, 'psi': 0.8772222543612878}-{'f1_val': 0.9967466683875206, 'auprc': 0.9961618139550459, 'loss_val': 0.07306273617635516, 'psi': 0.9965127266145307}
[S16] START round=31 head_norm_before_train=1.390434 cos_to_last_merge=0.9908 (last merge round=27)
[S16] round=31 local utility u=0.141602 metrics={'f1_val': 0.9287932489235605, 'auprc': 0.9950876094388853, 'loss_val': 0.30200988500080417, 'psi': 0.9553109931296904}-{'f1_val': 0.8861369775350024, 'auprc': 0.9785523661671482, 'loss_val': 0.27967032413245446, 'psi': 0.9231031329878607}
[S17] START round=31 head_norm_before_train=1.668504 cos_to_last_merge=1.0000 (last merge round=30)
[S17] round=31 local utility u=0.000000 metrics={'f1_val': 0.6700562062105138, 'auprc': 0.9492246520721733, 'loss_val': 0.9265500053519499, 'psi': 0.7817235845551775}-{'f1_val': 0.7430675370246848, 'auprc': 0.9587128643971445, 'loss_val': 0.7915943972059206, 'psi': 0.8293256679736687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:49305
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:49316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:49315
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:49309
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:49317
[S2] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1802) from S9
[S8] cosine check vs S9: cos=0.9748
[S17] RECEIVED delta(kind=head bytes=1802) from S3
[S17] cosine check vs S3: cos=0.9832
[S16] RECEIVED delta(kind=head bytes=1802) from S14
[S16] cosine check vs S14: cos=-0.0930
[S16] DROPPED delta from S14 (cos=-0.0930 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1796) from S2
[S15] cosine check vs S2: cos=0.9705
[S5] RECEIVED delta(kind=head bytes=1800) from S16
[S5] cosine check vs S16: cos=0.9580
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=31 metric=0.7006 head_norm=1.543018
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.225693e-01
[S5] stored merged vector for next round verification (round=31)
[S5] DEBUG after merge:  round=31 metric=0.7006 head_norm=1.469732 delta_norm=0.222569
[S5] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=31 metric=0.9864 head_norm=1.638993
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.843725e-01
[S8] stored merged vector for next round verification (round=31)
[S8] DEBUG after merge:  round=31 metric=0.9875 head_norm=1.632427 delta_norm=0.184373
[S8] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=31 metric=0.8019 head_norm=1.481574
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.790083e-01
[S15] stored merged vector for next round verification (round=31)
[S15] DEBUG after merge:  round=31 metric=0.8044 head_norm=1.460824 delta_norm=0.179008
[S15] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=31 metric=0.6701 head_norm=1.705050
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.661407e-01
[S17] stored merged vector for next round verification (round=31)
[S17] DEBUG after merge:  round=31 metric=0.6704 head_norm=1.625706 delta_norm=0.166141
[S17] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=32 head_norm_before_train=1.461862 cos_to_last_merge=0.9990 (last merge round=30)
[S2] round=32 local utility u=0.000000 metrics={'f1_val': 0.7505168230274565, 'auprc': 0.8811812677223009, 'loss_val': 0.42781464638408195, 'psi': 0.8027826009053942}-{'f1_val': 0.7921298676371629, 'auprc': 0.8623515593150644, 'loss_val': 0.4264932801061122, 'psi': 0.8202185443083234}
[S3] START round=32 head_norm_before_train=1.560081 cos_to_last_merge=0.9996 (last merge round=29)
[S3] round=32 local utility u=0.415828 metrics={'f1_val': 0.9566180427738753, 'auprc': 0.9915141650148868, 'loss_val': 0.13213592478273514, 'psi': 0.9705764916702798}-{'f1_val': 0.8485852221956507, 'auprc': 0.9726431638871861, 'loss_val': 0.25898157403839467, 'psi': 0.8982083988722649}
[S4] START round=32 head_norm_before_train=1.895059 cos_to_last_merge=1.0000 (last merge round=30)
[S4] round=32 local utility u=0.000000 metrics={'f1_val': 0.9400353092429089, 'auprc': 0.9362445664011975, 'loss_val': 0.31659531903412574, 'psi': 0.9385190121062243}-{'f1_val': 0.9406276779496527, 'auprc': 0.9633970654093222, 'loss_val': 0.3131498123664954, 'psi': 0.9497354329335206}
[S5] START round=32 head_norm_before_train=1.469732 cos_to_last_merge=1.0000 (last merge round=31)
[S5] round=32 local utility u=0.000000 metrics={'f1_val': 0.7095139281969434, 'auprc': 0.838704716718518, 'loss_val': 0.383358837962568, 'psi': 0.7611902436055732}-{'f1_val': 0.7006073928698142, 'auprc': 0.9973470264133583, 'loss_val': 0.23446463226045988, 'psi': 0.8193032462872318}
[S6] START round=32 head_norm_before_train=1.812332 cos_to_last_merge=0.9996 (last merge round=29)
[S6] round=32 local utility u=0.748549 metrics={'f1_val': 0.7610885339260173, 'auprc': 0.9523746594787024, 'loss_val': 0.5027657267293049, 'psi': 0.8376029841470913}-{'f1_val': 0.6365230506008558, 'auprc': 0.8046682747099313, 'loss_val': 0.8093525877338033, 'psi': 0.703781140244486}
[S7] START round=32 head_norm_before_train=1.404159 cos_to_last_merge=0.8019 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.802
[S7] round=32 local utility u=0.524745 metrics={'f1_val': 0.6656177513491307, 'auprc': 0.8274601181247071, 'loss_val': 0.4515867982806062, 'psi': 0.7303546980593613}-{'f1_val': 0.5654029525886772, 'auprc': 0.7810598586362137, 'loss_val': 0.7605874444052916, 'psi': 0.6516657150076919}
[S8] START round=32 head_norm_before_train=1.632427 cos_to_last_merge=1.0000 (last merge round=31)
[S8] round=32 local utility u=0.027193 metrics={'f1_val': 0.992174240363445, 'auprc': 0.9988560423341213, 'loss_val': 0.0731917106148917, 'psi': 0.9948469611517156}-{'f1_val': 0.9864436062227302, 'auprc': 0.9988755625093111, 'loss_val': 0.09325297483386313, 'psi': 0.9914163887373626}
[S9] START round=32 head_norm_before_train=1.646610 cos_to_last_merge=0.9830 (last merge round=27)
[S9] round=32 local utility u=0.004049 metrics={'f1_val': 0.9962748907591257, 'auprc': 0.9982895084476611, 'loss_val': 0.06571396644162555, 'psi': 0.9970807378345399}-{'f1_val': 0.9971029125121428, 'auprc': 0.9982893805515157, 'loss_val': 0.07877993928474351, 'psi': 0.997577499727892}
[S10] START round=32 head_norm_before_train=1.708291 cos_to_last_merge=0.9918 (last merge round=27)
[S10] round=32 local utility u=0.003721 metrics={'f1_val': 0.9948429234526912, 'auprc': 0.997745429646564, 'loss_val': 0.033338783112615206, 'psi': 0.9960039259302403}-{'f1_val': 0.9949681865317428, 'auprc': 0.996141645699713, 'loss_val': 0.03672042191153752, 'psi': 0.9954375701989309}
[S11] START round=32 head_norm_before_train=1.942987 cos_to_last_merge=0.9942 (last merge round=24)
[S11] round=32 local utility u=0.000000 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.9968319535744858, 'loss_val': 0.04856560023496595, 'psi': 0.9962678841509427}-{'f1_val': 0.996305167468861, 'auprc': 0.9967343182415003, 'loss_val': 0.04197469860103904, 'psi': 0.9964768277779167}
[S13] START round=32 head_norm_before_train=1.647501 cos_to_last_merge=0.9999 (last merge round=30)
[S13] round=32 local utility u=0.167675 metrics={'f1_val': 0.6531114963206472, 'auprc': 0.7809055492726298, 'loss_val': 0.7560202956892156, 'psi': 0.7042291175014402}-{'f1_val': 0.6214061372421509, 'auprc': 0.7881204135666466, 'loss_val': 0.9227818982373565, 'psi': 0.6880918477719492}
[S14] START round=32 head_norm_before_train=2.023010 (no previous merge yet)
[S14] round=32 local utility u=0.000000 metrics={'f1_val': 0.996754531653698, 'auprc': 0.9989241990187916, 'loss_val': 0.022268180008644983, 'psi': 0.9976223985997354}-{'f1_val': 0.9972435617623723, 'auprc': 0.9977703202484938, 'loss_val': 0.020375236293411713, 'psi': 0.9974542651568209}
[S15] START round=32 head_norm_before_train=1.460824 cos_to_last_merge=1.0000 (last merge round=31)
[S15] round=32 local utility u=0.370353 metrics={'f1_val': 0.9022109432627609, 'auprc': 0.9908547183177538, 'loss_val': 0.18545666192771032, 'psi': 0.9376684532847581}-{'f1_val': 0.8018839131154283, 'auprc': 0.990229766230077, 'loss_val': 0.3223248802445408, 'psi': 0.8772222543612878}
[S16] START round=32 head_norm_before_train=1.427724 cos_to_last_merge=0.9866 (last merge round=27)
[S16] round=32 local utility u=0.000000 metrics={'f1_val': 0.914205839967199, 'auprc': 0.9944960180955157, 'loss_val': 0.3427066804743932, 'psi': 0.9463219112185257}-{'f1_val': 0.9287932489235605, 'auprc': 0.9950876094388853, 'loss_val': 0.30200988500080417, 'psi': 0.9553109931296904}
[S17] START round=32 head_norm_before_train=1.625706 cos_to_last_merge=1.0000 (last merge round=31)
[S17] round=32 local utility u=0.395658 metrics={'f1_val': 0.7643304111523871, 'auprc': 0.9574317269703392, 'loss_val': 0.7255003924296044, 'psi': 0.8415709374795679}-{'f1_val': 0.6700562062105138, 'auprc': 0.9492246520721733, 'loss_val': 0.9265500053519499, 'psi': 0.7817235845551775}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:49317
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:49313
[S10] sending update (kind=head size=1795 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1795) from S10
[S13] cosine check vs S10: cos=0.9950
[S17] RECEIVED delta(kind=head bytes=1800) from S3
[S17] cosine check vs S3: cos=0.9939
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:49311
[S13] sending update (kind=head size=1798 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1798) from S13
[S10] cosine check vs S13: cos=0.9950
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:49307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:49309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:49309
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:49302
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1802) from S6
[S8] cosine check vs S6: cos=0.8284
[S8] RECEIVED delta(kind=head bytes=1801) from S9
[S8] cosine check vs S9: cos=0.9892
[S15] sending update (kind=head size=1799 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1799) from S15
[S2] cosine check vs S15: cos=0.9861
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:49303
[S17] sending update (kind=head size=1803 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1803) from S17
[S3] cosine check vs S17: cos=0.9939
[S8] sending update (kind=head size=1801 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1801) from S8
[S6] cosine check vs S8: cos=0.8284
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=32 metric=0.7611 head_norm=1.824735
[S6] _apply_head_vector_avg (torch): Δ‖w‖=5.174897e-01
[S6] stored merged vector for next round verification (round=32)
[S6] DEBUG after merge:  round=32 metric=0.8168 head_norm=1.673045 delta_norm=0.517490
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=32 metric=0.9566 head_norm=1.577956
[S3] _apply_head_vector_avg (torch): Δ‖w‖=9.848976e-02
[S3] stored merged vector for next round verification (round=32)
[S3] DEBUG after merge:  round=32 metric=0.9562 head_norm=1.616391 delta_norm=0.098490
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=32 metric=0.7505 head_norm=1.513297
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.259348e-01
[S2] stored merged vector for next round verification (round=32)
[S2] DEBUG after merge:  round=32 metric=0.7465 head_norm=1.496085 delta_norm=0.125935
[S2] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=32 metric=0.9948 head_norm=1.735965
[S10] _apply_head_vector_avg (torch): Δ‖w‖=9.351443e-02
[S10] stored merged vector for next round verification (round=32)
[S10] DEBUG after merge:  round=32 metric=0.9953 head_norm=1.694893 delta_norm=0.093514
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=32 metric=0.6531 head_norm=1.658083
[S13] _apply_head_vector_avg (torch): Δ‖w‖=9.351443e-02
[S13] stored merged vector for next round verification (round=32)
[S13] DEBUG after merge:  round=32 metric=0.6390 head_norm=1.694893 delta_norm=0.093514
[S13] aggregate: ROLLBACK (f1_val pre=0.653 post=0.639 tol_abs=0.005 tol_rel=0.0)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=32 metric=0.7643 head_norm=1.659789
[S17] _apply_head_vector_avg (torch): Δ‖w‖=9.848977e-02
[S17] stored merged vector for next round verification (round=32)
[S17] DEBUG after merge:  round=32 metric=0.7665 head_norm=1.616391 delta_norm=0.098490
[S17] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=32 metric=0.9922 head_norm=1.674543
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.148940e-01
[S8] stored merged vector for next round verification (round=32)
[S8] DEBUG after merge:  round=32 metric=0.9922 head_norm=1.643507 delta_norm=0.214894
[S8] aggregate: ACCEPT kept=['S6', 'S9'] (k=2/2) mode=median trim_p=0.1
[S2] START round=33 head_norm_before_train=1.496085 cos_to_last_merge=1.0000 (last merge round=32)
[S2] round=33 local utility u=0.032567 metrics={'f1_val': 0.7817115093021495, 'auprc': 0.8475750564070602, 'loss_val': 0.4490304999620831, 'psi': 0.8080569281441138}-{'f1_val': 0.7505168230274565, 'auprc': 0.8811812677223009, 'loss_val': 0.42781464638408195, 'psi': 0.8027826009053942}
[S3] START round=33 head_norm_before_train=1.616391 cos_to_last_merge=1.0000 (last merge round=32)
[S3] round=33 local utility u=0.000000 metrics={'f1_val': 0.9208419942173319, 'auprc': 0.985602956043394, 'loss_val': 0.1531430686515281, 'psi': 0.9467463789477567}-{'f1_val': 0.9566180427738753, 'auprc': 0.9915141650148868, 'loss_val': 0.13213592478273514, 'psi': 0.9705764916702798}
[S4] START round=33 head_norm_before_train=1.899844 cos_to_last_merge=0.9999 (last merge round=30)
[S4] round=33 local utility u=0.042800 metrics={'f1_val': 0.9410051705762532, 'auprc': 0.9617142159092773, 'loss_val': 0.31322295898924923, 'psi': 0.9492887887094629}-{'f1_val': 0.9400353092429089, 'auprc': 0.9362445664011975, 'loss_val': 0.31659531903412574, 'psi': 0.9385190121062243}
[S5] START round=33 head_norm_before_train=1.490378 cos_to_last_merge=0.9997 (last merge round=31)
[S5] round=33 local utility u=0.000000 metrics={'f1_val': 0.7136846998186256, 'auprc': 0.8000944002315422, 'loss_val': 0.47089067420946207, 'psi': 0.7482485799837922}-{'f1_val': 0.7095139281969434, 'auprc': 0.838704716718518, 'loss_val': 0.383358837962568, 'psi': 0.7611902436055732}
[S6] START round=33 head_norm_before_train=1.673045 cos_to_last_merge=1.0000 (last merge round=32)
[S6] round=33 local utility u=0.160469 metrics={'f1_val': 0.8138222176673221, 'auprc': 0.9471266308061396, 'loss_val': 0.48248525700059147, 'psi': 0.8671439829228491}-{'f1_val': 0.7610885339260173, 'auprc': 0.9523746594787024, 'loss_val': 0.5027657267293049, 'psi': 0.8376029841470913}
[S7] START round=33 head_norm_before_train=1.411626 cos_to_last_merge=0.8002 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.800
[S7] round=33 local utility u=0.000000 metrics={'f1_val': 0.48129652679759216, 'auprc': 0.7770116974391268, 'loss_val': 0.8999639908483423, 'psi': 0.599582595054206}-{'f1_val': 0.6656177513491307, 'auprc': 0.8274601181247071, 'loss_val': 0.4515867982806062, 'psi': 0.7303546980593613}
[S8] START round=33 head_norm_before_train=1.643507 cos_to_last_merge=1.0000 (last merge round=32)
[S8] round=33 local utility u=0.000000 metrics={'f1_val': 0.907643270810783, 'auprc': 0.9893394995392848, 'loss_val': 0.13270508292383673, 'psi': 0.9403217623021837}-{'f1_val': 0.992174240363445, 'auprc': 0.9988560423341213, 'loss_val': 0.0731917106148917, 'psi': 0.9948469611517156}
[S9] START round=33 head_norm_before_train=1.677403 cos_to_last_merge=0.9788 (last merge round=27)
[S9] round=33 local utility u=0.006846 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.997934458120069, 'loss_val': 0.05592518691913835, 'psi': 0.9974355307553133}-{'f1_val': 0.9962748907591257, 'auprc': 0.9982895084476611, 'loss_val': 0.06571396644162555, 'psi': 0.9970807378345399}
[S10] START round=33 head_norm_before_train=1.694893 cos_to_last_merge=1.0000 (last merge round=32)
[S10] round=33 local utility u=0.000000 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9971325481576132, 'loss_val': 0.03648977646822623, 'psi': 0.9959151001087042}-{'f1_val': 0.9948429234526912, 'auprc': 0.997745429646564, 'loss_val': 0.033338783112615206, 'psi': 0.9960039259302403}
[S11] START round=33 head_norm_before_train=1.960824 cos_to_last_merge=0.9932 (last merge round=24)
[S11] round=33 local utility u=0.000000 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.9965231020543086, 'loss_val': 0.08779045863998138, 'psi': 0.9961443435428718}-{'f1_val': 0.9958918378685807, 'auprc': 0.9968319535744858, 'loss_val': 0.04856560023496595, 'psi': 0.9962678841509427}
[S13] START round=33 head_norm_before_train=1.694893 cos_to_last_merge=1.0000 (last merge round=32)
[S13] round=33 local utility u=0.000000 metrics={'f1_val': 0.6227957286012998, 'auprc': 0.7874028529454322, 'loss_val': 0.9923790661249043, 'psi': 0.6886385783389528}-{'f1_val': 0.6531114963206472, 'auprc': 0.7809055492726298, 'loss_val': 0.7560202956892156, 'psi': 0.7042291175014402}
[S14] START round=33 head_norm_before_train=2.036038 (no previous merge yet)
[S14] round=33 local utility u=0.000000 metrics={'f1_val': 0.9426014125103459, 'auprc': 0.9972160348287813, 'loss_val': 0.07847574403498156, 'psi': 0.96444726143772}-{'f1_val': 0.996754531653698, 'auprc': 0.9989241990187916, 'loss_val': 0.022268180008644983, 'psi': 0.9976223985997354}
[S15] START round=33 head_norm_before_train=1.489359 cos_to_last_merge=0.9998 (last merge round=31)
[S15] round=33 local utility u=0.335231 metrics={'f1_val': 0.9950721929133418, 'auprc': 0.9928028514015571, 'loss_val': 0.07800570540065957, 'psi': 0.9941644563086279}-{'f1_val': 0.9022109432627609, 'auprc': 0.9908547183177538, 'loss_val': 0.18545666192771032, 'psi': 0.9376684532847581}
[S16] START round=33 head_norm_before_train=1.462830 cos_to_last_merge=0.9825 (last merge round=27)
[S16] round=33 local utility u=0.305177 metrics={'f1_val': 0.981967785100955, 'auprc': 0.9922881415891026, 'loss_val': 0.1323000246342294, 'psi': 0.986095927696214}-{'f1_val': 0.914205839967199, 'auprc': 0.9944960180955157, 'loss_val': 0.3427066804743932, 'psi': 0.9463219112185257}
[S17] START round=33 head_norm_before_train=1.616391 cos_to_last_merge=1.0000 (last merge round=32)
[S17] round=33 local utility u=0.000000 metrics={'f1_val': 0.6457919637608565, 'auprc': 0.8872928545508663, 'loss_val': 1.0106336405395064, 'psi': 0.7423923200768603}-{'f1_val': 0.7643304111523871, 'auprc': 0.9574317269703392, 'loss_val': 0.7255003924296044, 'psi': 0.8415709374795679}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:49312
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:49309
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1803 to 1 peers)
[S4] sending update (kind=head size=1795 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1795) from S4
[S11] cosine check vs S4: cos=0.9976
[S8] RECEIVED delta(kind=head bytes=1803) from S6
[S8] cosine check vs S6: cos=0.9823
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:49302
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1796 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1796) from S15
[S2] cosine check vs S15: cos=0.9913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:49315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:49309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:49305
[S2] sending update (kind=head size=1795 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1795) from S2
[S15] cosine check vs S2: cos=0.9913
[S16] sending update (kind=head size=1796 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1796) from S16
[S5] cosine check vs S16: cos=0.9816
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1803 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1803) from S9
[S8] cosine check vs S9: cos=0.9633
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=33 metric=0.9959 head_norm=1.975945
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.738789e-02
[S11] stored merged vector for next round verification (round=33)
[S11] DEBUG after merge:  round=33 metric=0.9959 head_norm=1.935670 delta_norm=0.077388
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=33 metric=0.7137 head_norm=1.511078
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.443028e-01
[S5] stored merged vector for next round verification (round=33)
[S5] DEBUG after merge:  round=33 metric=0.7137 head_norm=1.495920 delta_norm=0.144303
[S5] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=33 metric=0.9951 head_norm=1.521873
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.015451e-01
[S15] stored merged vector for next round verification (round=33)
[S15] DEBUG after merge:  round=33 metric=0.9959 head_norm=1.529890 delta_norm=0.101545
[S15] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=33 metric=0.7817 head_norm=1.544554
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.015451e-01
[S2] stored merged vector for next round verification (round=33)
[S2] DEBUG after merge:  round=33 metric=0.7807 head_norm=1.529890 delta_norm=0.101545
[S2] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=33 metric=0.9076 head_norm=1.685784
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.627060e-02
[S8] stored merged vector for next round verification (round=33)
[S8] DEBUG after merge:  round=33 metric=0.8913 head_norm=1.670283 delta_norm=0.056271
[S8] aggregate: ROLLBACK (f1_val pre=0.908 post=0.891 tol_abs=0.005 tol_rel=0.0)
[S2] START round=34 head_norm_before_train=1.529890 cos_to_last_merge=1.0000 (last merge round=33)
[S2] round=34 local utility u=0.000000 metrics={'f1_val': 0.7868543251099203, 'auprc': 0.8366388530449974, 'loss_val': 0.5073719933958397, 'psi': 0.8067681362839512}-{'f1_val': 0.7817115093021495, 'auprc': 0.8475750564070602, 'loss_val': 0.4490304999620831, 'psi': 0.8080569281441138}
[S3] START round=34 head_norm_before_train=1.632791 cos_to_last_merge=0.9999 (last merge round=32)
[S3] round=34 local utility u=0.000000 metrics={'f1_val': 0.8234069540366189, 'auprc': 0.9714034322275433, 'loss_val': 0.27641689601460856, 'psi': 0.8826055453129886}-{'f1_val': 0.9208419942173319, 'auprc': 0.985602956043394, 'loss_val': 0.1531430686515281, 'psi': 0.9467463789477567}
[S4] START round=34 head_norm_before_train=1.897698 cos_to_last_merge=0.9997 (last merge round=30)
[S4] round=34 local utility u=0.029533 metrics={'f1_val': 0.945931284906044, 'auprc': 0.9672353518849401, 'loss_val': 0.3002772867217538, 'psi': 0.9544529116976025}-{'f1_val': 0.9410051705762532, 'auprc': 0.9617142159092773, 'loss_val': 0.31322295898924923, 'psi': 0.9492887887094629}
[S5] START round=34 head_norm_before_train=1.495920 cos_to_last_merge=1.0000 (last merge round=33)
[S5] round=34 local utility u=0.380366 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9974053641647593, 'loss_val': 0.22363416923178805, 'psi': 0.8193271812635083}-{'f1_val': 0.7136846998186256, 'auprc': 0.8000944002315422, 'loss_val': 0.47089067420946207, 'psi': 0.7482485799837922}
[S6] START round=34 head_norm_before_train=1.693658 cos_to_last_merge=0.9997 (last merge round=32)
[S6] round=34 local utility u=0.000000 metrics={'f1_val': 0.8145342252637698, 'auprc': 0.9422325338904907, 'loss_val': 0.5018344190791649, 'psi': 0.8656135487144582}-{'f1_val': 0.8138222176673221, 'auprc': 0.9471266308061396, 'loss_val': 0.48248525700059147, 'psi': 0.8671439829228491}
[S7] START round=34 head_norm_before_train=1.419065 cos_to_last_merge=0.7985 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.799
[S7] round=34 local utility u=0.864246 metrics={'f1_val': 0.6673077261067246, 'auprc': 0.827950555210688, 'loss_val': 0.4403547694508824, 'psi': 0.73156485774831}-{'f1_val': 0.48129652679759216, 'auprc': 0.7770116974391268, 'loss_val': 0.8999639908483423, 'psi': 0.599582595054206}
[S8] START round=34 head_norm_before_train=1.670283 cos_to_last_merge=1.0000 (last merge round=33)
[S8] round=34 local utility u=0.292109 metrics={'f1_val': 0.9885804511658192, 'auprc': 0.9990452809489145, 'loss_val': 0.0632273175242217, 'psi': 0.9927663830790574}-{'f1_val': 0.907643270810783, 'auprc': 0.9893394995392848, 'loss_val': 0.13270508292383673, 'psi': 0.9403217623021837}
[S9] START round=34 head_norm_before_train=1.704993 cos_to_last_merge=0.9752 (last merge round=27)
[S9] round=34 local utility u=0.000000 metrics={'f1_val': 0.9888785659900814, 'auprc': 0.998460904542125, 'loss_val': 0.0683397548907913, 'psi': 0.9927115014108988}-{'f1_val': 0.9971029125121428, 'auprc': 0.997934458120069, 'loss_val': 0.05592518691913835, 'psi': 0.9974355307553133}
[S10] START round=34 head_norm_before_train=1.721355 cos_to_last_merge=0.9999 (last merge round=32)
[S10] round=34 local utility u=0.000346 metrics={'f1_val': 0.9944204775781598, 'auprc': 0.9979832474802579, 'loss_val': 0.03425125496957164, 'psi': 0.995845585538999}-{'f1_val': 0.9951034680760983, 'auprc': 0.9971325481576132, 'loss_val': 0.03648977646822623, 'psi': 0.9959151001087042}
[S11] START round=34 head_norm_before_train=1.935670 cos_to_last_merge=1.0000 (last merge round=33)
[S11] round=34 local utility u=0.017078 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.9968821763885638, 'loss_val': 0.05471211259553177, 'psi': 0.9962879732765739}-{'f1_val': 0.9958918378685807, 'auprc': 0.9965231020543086, 'loss_val': 0.08779045863998138, 'psi': 0.9961443435428718}
[S13] START round=34 head_norm_before_train=1.702607 cos_to_last_merge=0.9999 (last merge round=32)
[S13] round=34 local utility u=0.283953 metrics={'f1_val': 0.6936567088850214, 'auprc': 0.7918028934637432, 'loss_val': 0.8628396393072776, 'psi': 0.7329151827165101}-{'f1_val': 0.6227957286012998, 'auprc': 0.7874028529454322, 'loss_val': 0.9923790661249043, 'psi': 0.6886385783389528}
[S14] START round=34 head_norm_before_train=2.042656 (no previous merge yet)
[S14] round=34 local utility u=0.198418 metrics={'f1_val': 0.9976538428159559, 'auprc': 0.9992296638647641, 'loss_val': 0.017995716559184124, 'psi': 0.9982841712354792}-{'f1_val': 0.9426014125103459, 'auprc': 0.9972160348287813, 'loss_val': 0.07847574403498156, 'psi': 0.96444726143772}
[S15] START round=34 head_norm_before_train=1.529890 cos_to_last_merge=1.0000 (last merge round=33)
[S15] round=34 local utility u=0.000000 metrics={'f1_val': 0.7782584999406672, 'auprc': 0.9905003947807728, 'loss_val': 0.33280550755973465, 'psi': 0.8631552578767094}-{'f1_val': 0.9950721929133418, 'auprc': 0.9928028514015571, 'loss_val': 0.07800570540065957, 'psi': 0.9941644563086279}
[S16] START round=34 head_norm_before_train=1.494605 cos_to_last_merge=0.9789 (last merge round=27)
[S16] round=34 local utility u=0.029552 metrics={'f1_val': 0.9873911000305751, 'auprc': 0.9922403901136819, 'loss_val': 0.10559167268043607, 'psi': 0.9893308160638178}-{'f1_val': 0.981967785100955, 'auprc': 0.9922881415891026, 'loss_val': 0.1323000246342294, 'psi': 0.986095927696214}
[S17] START round=34 head_norm_before_train=1.667605 cos_to_last_merge=0.9995 (last merge round=32)
[S17] round=34 local utility u=0.000000 metrics={'f1_val': 0.6439025398334055, 'auprc': 0.8735987329706015, 'loss_val': 1.0496129405027894, 'psi': 0.7357810170882839}-{'f1_val': 0.6457919637608565, 'auprc': 0.8872928545508663, 'loss_val': 1.0106336405395064, 'psi': 0.7423923200768603}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:49313
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S11] → sending delta(kind=head bytes=1791) to S4@127.0.0.1:49304
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S16] → sending delta(kind=head bytes=1806) to S5@127.0.0.1:49305
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:49307
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] → sending delta(kind=head bytes=1793) to S11@127.0.0.1:49312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:49315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:49316
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:49311
[S4] sending update (kind=head size=1793 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1804 to 1 peers)
[S16] sending update (kind=head size=1806 to 1 peers)
[S11] sending update (kind=head size=1791 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1800) from S5
[S15] cosine check vs S5: cos=-0.0684
[S15] DROPPED delta from S5 (cos=-0.0684 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1802) from S14
[S16] cosine check vs S14: cos=-0.0967
[S16] DROPPED delta from S14 (cos=-0.0967 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1800) from S10
[S13] cosine check vs S10: cos=0.9992
[S6] RECEIVED delta(kind=head bytes=1804) from S8
[S6] cosine check vs S8: cos=0.9778
[S11] RECEIVED delta(kind=head bytes=1793) from S4
[S11] cosine check vs S4: cos=0.9988
[S10] RECEIVED delta(kind=head bytes=1797) from S13
[S10] cosine check vs S13: cos=0.9992
[S4] RECEIVED delta(kind=head bytes=1791) from S11
[S4] cosine check vs S11: cos=0.9988
[S5] RECEIVED delta(kind=head bytes=1806) from S16
[S5] cosine check vs S16: cos=0.9931
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=34 metric=0.8145 head_norm=1.713119
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.800177e-01
[S6] stored merged vector for next round verification (round=34)
[S6] DEBUG after merge:  round=34 metric=0.8254 head_norm=1.698261 delta_norm=0.180018
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=34 metric=0.9459 head_norm=1.896321
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.433151e-02
[S4] stored merged vector for next round verification (round=34)
[S4] DEBUG after merge:  round=34 metric=0.9458 head_norm=1.923058 delta_norm=0.054332
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=34 metric=0.7006 head_norm=1.519297
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.968376e-02
[S5] stored merged vector for next round verification (round=34)
[S5] DEBUG after merge:  round=34 metric=0.7006 head_norm=1.518861 delta_norm=0.089684
[S5] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=34 metric=0.6937 head_norm=1.715702
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.741038e-02
[S13] stored merged vector for next round verification (round=34)
[S13] DEBUG after merge:  round=34 metric=0.6805 head_norm=1.730605 delta_norm=0.037410
[S13] aggregate: ROLLBACK (f1_val pre=0.694 post=0.680 tol_abs=0.005 tol_rel=0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=34 metric=0.9944 head_norm=1.746183
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.741037e-02
[S10] stored merged vector for next round verification (round=34)
[S10] DEBUG after merge:  round=34 metric=0.9944 head_norm=1.730605 delta_norm=0.037410
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=34 metric=0.9959 head_norm=1.950941
[S11] _apply_head_vector_avg (torch): Δ‖w‖=5.433150e-02
[S11] stored merged vector for next round verification (round=34)
[S11] DEBUG after merge:  round=34 metric=0.9959 head_norm=1.923058 delta_norm=0.054332
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S17]  timeout peer S2
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S6]  timeout peer S17
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S7
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S15
[S8]  timeout peer S16
[S8]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S16
[S2]  timeout peer S17
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S17
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S15
[S16]  timeout peer S17
[S2] START round=35 head_norm_before_train=1.572196 cos_to_last_merge=0.9993 (last merge round=33)
[S2] round=35 local utility u=0.000000 metrics={'f1_val': 0.709452529698768, 'auprc': 0.9075009375866984, 'loss_val': 0.49758749448049355, 'psi': 0.7886718928539402}-{'f1_val': 0.7868543251099203, 'auprc': 0.8366388530449974, 'loss_val': 0.5073719933958397, 'psi': 0.8067681362839512}
[S3] START round=35 head_norm_before_train=1.649129 cos_to_last_merge=0.9998 (last merge round=32)
[S3] round=35 local utility u=0.000000 metrics={'f1_val': 0.7614561471876714, 'auprc': 0.9657762538259402, 'loss_val': 0.381311684026848, 'psi': 0.8431841898429789}-{'f1_val': 0.8234069540366189, 'auprc': 0.9714034322275433, 'loss_val': 0.27641689601460856, 'psi': 0.8826055453129886}
[S4] START round=35 head_norm_before_train=1.923058 cos_to_last_merge=1.0000 (last merge round=34)
[S4] round=35 local utility u=0.000000 metrics={'f1_val': 0.9423815752260446, 'auprc': 0.9574285063361705, 'loss_val': 0.3156862388638049, 'psi': 0.9484003476700948}-{'f1_val': 0.945931284906044, 'auprc': 0.9672353518849401, 'loss_val': 0.3002772867217538, 'psi': 0.9544529116976025}
[S5] START round=35 head_norm_before_train=1.518861 cos_to_last_merge=1.0000 (last merge round=34)
[S5] round=35 local utility u=0.000000 metrics={'f1_val': 0.7100409988055472, 'auprc': 0.8417645296055152, 'loss_val': 0.355097277495621, 'psi': 0.7627304111255344}-{'f1_val': 0.7006083926626743, 'auprc': 0.9974053641647593, 'loss_val': 0.22363416923178805, 'psi': 0.8193271812635083}
[S6] START round=35 head_norm_before_train=1.698261 cos_to_last_merge=1.0000 (last merge round=34)
[S6] round=35 local utility u=0.248399 metrics={'f1_val': 0.859592723650824, 'auprc': 0.958490416780365, 'loss_val': 0.32416188324512735, 'psi': 0.8991518009026402}-{'f1_val': 0.8145342252637698, 'auprc': 0.9422325338904907, 'loss_val': 0.5018344190791649, 'psi': 0.8656135487144582}
[S7] START round=35 head_norm_before_train=1.427065 cos_to_last_merge=0.7970 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.797
[S7] round=35 local utility u=0.000000 metrics={'f1_val': 0.521176688249813, 'auprc': 0.7455715376546419, 'loss_val': 0.8940562933307222, 'psi': 0.6109346280117446}-{'f1_val': 0.6673077261067246, 'auprc': 0.827950555210688, 'loss_val': 0.4403547694508824, 'psi': 0.73156485774831}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=35 head_norm_before_train=1.702415 cos_to_last_merge=0.9997 (last merge round=33)
[S8] round=35 local utility u=0.008066 metrics={'f1_val': 0.9936253371144965, 'auprc': 0.9888995397091455, 'loss_val': 0.04692774112679584, 'psi': 0.9917350181523561}-{'f1_val': 0.9885804511658192, 'auprc': 0.9990452809489145, 'loss_val': 0.0632273175242217, 'psi': 0.9927663830790574}
[S9] START round=35 head_norm_before_train=1.728183 cos_to_last_merge=0.9723 (last merge round=27)
[S9] round=35 local utility u=0.029720 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9946180718721789, 'loss_val': 0.046717028090382834, 'psi': 0.9961089762561572}-{'f1_val': 0.9888785659900814, 'auprc': 0.998460904542125, 'loss_val': 0.0683397548907913, 'psi': 0.9927115014108988}
[S10] START round=35 head_norm_before_train=1.730605 cos_to_last_merge=1.0000 (last merge round=34)
[S10] round=35 local utility u=0.001926 metrics={'f1_val': 0.9948838907637279, 'auprc': 0.9979468033039766, 'loss_val': 0.033070279527404954, 'psi': 0.9961090557798273}-{'f1_val': 0.9944204775781598, 'auprc': 0.9979832474802579, 'loss_val': 0.03425125496957164, 'psi': 0.995845585538999}
[S11] START round=35 head_norm_before_train=1.923058 cos_to_last_merge=1.0000 (last merge round=34)
[S11] round=35 local utility u=0.012801 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9986106223130009, 'loss_val': 0.03677443174122652, 'psi': 0.9972273494065169}-{'f1_val': 0.9958918378685807, 'auprc': 0.9968821763885638, 'loss_val': 0.05471211259553177, 'psi': 0.9962879732765739}
[S13] START round=35 head_norm_before_train=1.730605 cos_to_last_merge=1.0000 (last merge round=34)
[S13] round=35 local utility u=0.239950 metrics={'f1_val': 0.738222843721278, 'auprc': 0.7936462704485503, 'loss_val': 0.6558666728853615, 'psi': 0.7603922144121869}-{'f1_val': 0.6936567088850214, 'auprc': 0.7918028934637432, 'loss_val': 0.8628396393072776, 'psi': 0.7329151827165101}
[S14] START round=35 head_norm_before_train=2.046527 (no previous merge yet)
[S14] round=35 local utility u=0.000000 metrics={'f1_val': 0.9972216920155168, 'auprc': 0.9953820934516647, 'loss_val': 0.019859968766810652, 'psi': 0.996485852589976}-{'f1_val': 0.9976538428159559, 'auprc': 0.9992296638647641, 'loss_val': 0.017995716559184124, 'psi': 0.9982841712354792}
[S15] START round=35 head_norm_before_train=1.564415 cos_to_last_merge=0.9998 (last merge round=33)
[S15] round=35 local utility u=0.501329 metrics={'f1_val': 0.9121376580915836, 'auprc': 0.9910286073231952, 'loss_val': 0.13500735214139672, 'psi': 0.9436940377842282}-{'f1_val': 0.7782584999406672, 'auprc': 0.9905003947807728, 'loss_val': 0.33280550755973465, 'psi': 0.8631552578767094}
[S16] START round=35 head_norm_before_train=1.523713 cos_to_last_merge=0.9755 (last merge round=27)
[S16] round=35 local utility u=0.000000 metrics={'f1_val': 0.9566620741757171, 'auprc': 0.9962049856659527, 'loss_val': 0.1556855129210977, 'psi': 0.9724792387718113}-{'f1_val': 0.9873911000305751, 'auprc': 0.9922403901136819, 'loss_val': 0.10559167268043607, 'psi': 0.9893308160638178}
[S17] START round=35 head_norm_before_train=1.712851 cos_to_last_merge=0.9983 (last merge round=32)
[S17] round=35 local utility u=0.890442 metrics={'f1_val': 0.8328879438250465, 'auprc': 0.9419913722813047, 'loss_val': 0.6078184410485608, 'psi': 0.8765293152075497}-{'f1_val': 0.6439025398334055, 'auprc': 0.8735987329706015, 'loss_val': 1.0496129405027894, 'psi': 0.7357810170882839}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:49311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:49313
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:49304
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:49303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:49309
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1795 to 1 peers)
[S4] ⇄ pheromone p=0.015 → S11@127.0.0.1:49312
[S10] sending update (kind=head size=1803 to 1 peers)
[S17] sending update (kind=head size=1797 to 1 peers)
[S14] ⇄ pheromone p=0.036 → S16@127.0.0.1:49316
[S11] sending update (kind=head size=1796 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1797) from S17
[S3] cosine check vs S17: cos=0.9964
[S4] RECEIVED delta(kind=head bytes=1796) from S11
[S4] cosine check vs S11: cos=0.9999
[S13] RECEIVED delta(kind=head bytes=1803) from S10
[S13] cosine check vs S10: cos=0.9997
[S8] RECEIVED delta(kind=head bytes=1801) from S6
[S8] cosine check vs S6: cos=0.9929
[S10] RECEIVED delta(kind=head bytes=1795) from S13
[S10] cosine check vs S13: cos=0.9997
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:49302
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=35 metric=0.7382 head_norm=1.748878
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.235649e-02
[S13] stored merged vector for next round verification (round=35)
[S13] DEBUG after merge:  round=35 metric=0.7328 head_norm=1.751732 delta_norm=0.022356
[S13] aggregate: ROLLBACK (f1_val pre=0.738 post=0.733 tol_abs=0.005 tol_rel=0.0)
[S13] ⇄ pheromone p=0.139 → S10@127.0.0.1:49311
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=35 metric=0.9949 head_norm=1.754868
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.235648e-02
[S10] stored merged vector for next round verification (round=35)
[S10] DEBUG after merge:  round=35 metric=0.9949 head_norm=1.751732 delta_norm=0.022356
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.004 → S13@127.0.0.1:49313
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] ⇄ pheromone p=0.014 → S4@127.0.0.1:49304
[S17] ⇄ pheromone p=0.329 → S3@127.0.0.1:49303
[S6] ⇄ pheromone p=0.254 → S8@127.0.0.1:49309
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:49307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:49309
[S15] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1804 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1799) from S15
[S2] cosine check vs S15: cos=0.9958
[S6] RECEIVED delta(kind=head bytes=1804) from S8
[S6] cosine check vs S8: cos=0.9929
[S9] sending update (kind=head size=1803 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1803) from S9
[S8] cosine check vs S9: cos=0.9622
[S16] ⇄ pheromone p=0.101 → S5@127.0.0.1:49305
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=35 metric=0.7615 head_norm=1.664114
[S3] _apply_head_vector_avg (torch): Δ‖w‖=8.641066e-02
[S3] stored merged vector for next round verification (round=35)
[S3] DEBUG after merge:  round=35 metric=0.7599 head_norm=1.708876 delta_norm=0.086411
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.138 → S17@127.0.0.1:49317
[S9] ⇄ pheromone p=0.022 → S8@127.0.0.1:49309
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=35 metric=0.7095 head_norm=1.611457
[S2] _apply_head_vector_avg (torch): Δ‖w‖=7.400784e-02
[S2] stored merged vector for next round verification (round=35)
[S2] DEBUG after merge:  round=35 metric=0.7094 head_norm=1.603212 delta_norm=0.074008
[S2] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.048 → S15@127.0.0.1:49315
[S5] ⇄ pheromone p=0.094 → S15@127.0.0.1:49315
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=35 metric=0.9936 head_norm=1.741120
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.836161e-02
[S8] stored merged vector for next round verification (round=35)
[S8] DEBUG after merge:  round=35 metric=0.9937 head_norm=1.721238 delta_norm=0.088362
[S8] aggregate: ACCEPT kept=['S6', 'S9'] (k=2/2) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.061 → S6@127.0.0.1:49307
[S15] ⇄ pheromone p=0.265 → S2@127.0.0.1:49302
[S2] START round=36 head_norm_before_train=1.603212 cos_to_last_merge=1.0000 (last merge round=35)
[S2] round=36 local utility u=0.000000 metrics={'f1_val': 0.7159051097315288, 'auprc': 0.8398572831282701, 'loss_val': 0.5360314227534565, 'psi': 0.7654859790902253}-{'f1_val': 0.709452529698768, 'auprc': 0.9075009375866984, 'loss_val': 0.49758749448049355, 'psi': 0.7886718928539402}
[S3] START round=36 head_norm_before_train=1.708876 cos_to_last_merge=1.0000 (last merge round=35)
[S3] round=36 local utility u=0.524366 metrics={'f1_val': 0.889938359364399, 'auprc': 0.9875757632934457, 'loss_val': 0.16887174607947125, 'psi': 0.9289933209360176}-{'f1_val': 0.7614561471876714, 'auprc': 0.9657762538259402, 'loss_val': 0.381311684026848, 'psi': 0.8431841898429789}
[S4] START round=36 head_norm_before_train=1.920228 cos_to_last_merge=0.9999 (last merge round=34)
[S4] round=36 local utility u=0.000000 metrics={'f1_val': 0.942117387075894, 'auprc': 0.953994864183377, 'loss_val': 0.3184586760094787, 'psi': 0.9468683779188872}-{'f1_val': 0.9423815752260446, 'auprc': 0.9574285063361705, 'loss_val': 0.3156862388638049, 'psi': 0.9484003476700948}
[S5] START round=36 head_norm_before_train=1.537018 cos_to_last_merge=0.9999 (last merge round=34)
[S5] round=36 local utility u=0.278438 metrics={'f1_val': 0.7006090940057808, 'auprc': 0.9979649945080016, 'loss_val': 0.2102306883326845, 'psi': 0.8195514542066691}-{'f1_val': 0.7100409988055472, 'auprc': 0.8417645296055152, 'loss_val': 0.355097277495621, 'psi': 0.7627304111255344}
[S6] START round=36 head_norm_before_train=1.725764 cos_to_last_merge=0.9998 (last merge round=34)
[S6] round=36 local utility u=0.000000 metrics={'f1_val': 0.8133031649890157, 'auprc': 0.9547585564710368, 'loss_val': 0.44783729646880965, 'psi': 0.8698853215818241}-{'f1_val': 0.859592723650824, 'auprc': 0.958490416780365, 'loss_val': 0.32416188324512735, 'psi': 0.8991518009026402}
[S7] START round=36 head_norm_before_train=1.434741 cos_to_last_merge=0.7956 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.796
[S7] round=36 local utility u=0.667459 metrics={'f1_val': 0.6493471547979397, 'auprc': 0.8091280690279741, 'loss_val': 0.5188313842275265, 'psi': 0.7132595204899534}-{'f1_val': 0.521176688249813, 'auprc': 0.7455715376546419, 'loss_val': 0.8940562933307222, 'psi': 0.6109346280117446}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S7] sending update (kind=head size=1807 to 1 peers)
[S8] START round=36 head_norm_before_train=1.721238 cos_to_last_merge=1.0000 (last merge round=35)
[S8] round=36 local utility u=0.004354 metrics={'f1_val': 0.9907243993413981, 'auprc': 0.9990546136550326, 'loss_val': 0.05128011709489851, 'psi': 0.994056485066852}-{'f1_val': 0.9936253371144965, 'auprc': 0.9888995397091455, 'loss_val': 0.04692774112679584, 'psi': 0.9917350181523561}
[S9] START round=36 head_norm_before_train=1.746702 cos_to_last_merge=0.9700 (last merge round=27)
[S9] round=36 local utility u=0.004572 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.996277732580108, 'loss_val': 0.04255200671287357, 'psi': 0.9967728405393289}-{'f1_val': 0.9971029125121428, 'auprc': 0.9946180718721789, 'loss_val': 0.046717028090382834, 'psi': 0.9961089762561572}
[S10] START round=36 head_norm_before_train=1.751732 cos_to_last_merge=1.0000 (last merge round=35)
[S10] round=36 local utility u=0.000354 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9981086991131078, 'loss_val': 0.03203695536106125, 'psi': 0.9960926451768666}-{'f1_val': 0.9948838907637279, 'auprc': 0.9979468033039766, 'loss_val': 0.033070279527404954, 'psi': 0.9961090557798273}
[S11] START round=36 head_norm_before_train=1.938837 cos_to_last_merge=1.0000 (last merge round=34)
[S11] round=36 local utility u=0.001135 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9985970597660119, 'loss_val': 0.03446289692442898, 'psi': 0.9972219243877214}-{'f1_val': 0.996305167468861, 'auprc': 0.9986106223130009, 'loss_val': 0.03677443174122652, 'psi': 0.9972273494065169}
[S13] START round=36 head_norm_before_train=1.751732 cos_to_last_merge=1.0000 (last merge round=35)
[S13] round=36 local utility u=0.000000 metrics={'f1_val': 0.604206642010968, 'auprc': 0.7989300285640026, 'loss_val': 1.212586638776779, 'psi': 0.6820959966321818}-{'f1_val': 0.738222843721278, 'auprc': 0.7936462704485503, 'loss_val': 0.6558666728853615, 'psi': 0.7603922144121869}
[S14] START round=36 head_norm_before_train=2.055104 (no previous merge yet)
[S14] round=36 local utility u=0.000000 metrics={'f1_val': 0.9970007132142444, 'auprc': 0.9936556637010039, 'loss_val': 0.021074003266360004, 'psi': 0.9956626934089483}-{'f1_val': 0.9972216920155168, 'auprc': 0.9953820934516647, 'loss_val': 0.019859968766810652, 'psi': 0.996485852589976}
[S15] START round=36 head_norm_before_train=1.598356 cos_to_last_merge=0.9991 (last merge round=33)
[S15] round=36 local utility u=0.271716 metrics={'f1_val': 0.9879346120243216, 'auprc': 0.9952545433637114, 'loss_val': 0.05903558318366237, 'psi': 0.9908625845600776}-{'f1_val': 0.9121376580915836, 'auprc': 0.9910286073231952, 'loss_val': 0.13500735214139672, 'psi': 0.9436940377842282}
[S16] START round=36 head_norm_before_train=1.549100 cos_to_last_merge=0.9725 (last merge round=27)
[S16] round=36 local utility u=0.000000 metrics={'f1_val': 0.9430293499324786, 'auprc': 0.9947883222510433, 'loss_val': 0.17154677954944644, 'psi': 0.9637329388599045}-{'f1_val': 0.9566620741757171, 'auprc': 0.9962049856659527, 'loss_val': 0.1556855129210977, 'psi': 0.9724792387718113}
[S17] START round=36 head_norm_before_train=1.756750 cos_to_last_merge=0.9968 (last merge round=32)
[S17] round=36 local utility u=0.000000 metrics={'f1_val': 0.8164204640685109, 'auprc': 0.9530874008894143, 'loss_val': 0.6939702384413354, 'psi': 0.8710872387968722}-{'f1_val': 0.8328879438250465, 'auprc': 0.9419913722813047, 'loss_val': 0.6078184410485608, 'psi': 0.8765293152075497}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:49313
[S10] sending update (kind=head size=1800 to 1 peers)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=36 metric=0.9421 head_norm=1.920390
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.344798e-02
[S4] stored merged vector for next round verification (round=36)
[S4] DEBUG after merge:  round=36 metric=0.9421 head_norm=1.929493 delta_norm=0.023448
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:49315
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=36 metric=0.8133 head_norm=1.748501
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.138556e-01
[S6] stored merged vector for next round verification (round=36)
[S6] DEBUG after merge:  round=36 metric=0.8222 head_norm=1.741096 delta_norm=0.113856
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] RECEIVED delta(kind=head bytes=1800) from S10
[S13] cosine check vs S10: cos=0.9998
[S9] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:49317
[S15] not sending this round → trigger blocked (psi=0.991)
[S5] sending update (kind=head size=1801 to 1 peers)
[S8] not sending this round → trigger blocked (psi=0.994)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] RECEIVED delta(kind=head bytes=1801) from S5
[S15] cosine check vs S5: cos=-0.0684
[S15] DROPPED delta from S5 (cos=-0.0684 < 0.0)
[S3] sending update (kind=head size=1800 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1800) from S3
[S17] cosine check vs S3: cos=0.9983
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=36 metric=0.6042 head_norm=1.764910
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.857950e-02
[S13] stored merged vector for next round verification (round=36)
[S13] DEBUG after merge:  round=36 metric=0.6041 head_norm=1.769531 delta_norm=0.018579
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=37 head_norm_before_train=1.637032 cos_to_last_merge=0.9997 (last merge round=35)
[S2] round=37 local utility u=0.182598 metrics={'f1_val': 0.7144146114262514, 'auprc': 0.9461908587972219, 'loss_val': 0.480893766617424, 'psi': 0.8071251103746395}-{'f1_val': 0.7159051097315288, 'auprc': 0.8398572831282701, 'loss_val': 0.5360314227534565, 'psi': 0.7654859790902253}
[S3] START round=37 head_norm_before_train=1.721396 cos_to_last_merge=1.0000 (last merge round=35)
[S3] round=37 local utility u=0.000000 metrics={'f1_val': 0.8609380573487797, 'auprc': 0.9787477367545008, 'loss_val': 0.19845916399343425, 'psi': 0.9080619291110681}-{'f1_val': 0.889938359364399, 'auprc': 0.9875757632934457, 'loss_val': 0.16887174607947125, 'psi': 0.9289933209360176}
[S4] START round=37 head_norm_before_train=1.929493 cos_to_last_merge=1.0000 (last merge round=36)
[S4] round=37 local utility u=0.082833 metrics={'f1_val': 0.953718053819398, 'auprc': 0.9787642678423827, 'loss_val': 0.29670492045883345, 'psi': 0.9637365394285918}-{'f1_val': 0.942117387075894, 'auprc': 0.953994864183377, 'loss_val': 0.3184586760094787, 'psi': 0.9468683779188872}
[S5] START round=37 head_norm_before_train=1.553720 cos_to_last_merge=0.9996 (last merge round=34)
[S5] round=37 local utility u=0.000000 metrics={'f1_val': 0.7145325028856473, 'auprc': 0.7812915798120971, 'loss_val': 0.6310725805033818, 'psi': 0.7412361336562272}-{'f1_val': 0.7006090940057808, 'auprc': 0.9979649945080016, 'loss_val': 0.2102306883326845, 'psi': 0.8195514542066691}
[S6] START round=37 head_norm_before_train=1.741096 cos_to_last_merge=1.0000 (last merge round=36)
[S6] round=37 local utility u=0.000000 metrics={'f1_val': 0.7120078850923407, 'auprc': 0.8938887253047783, 'loss_val': 0.6374851027661708, 'psi': 0.7847602211773157}-{'f1_val': 0.8133031649890157, 'auprc': 0.9547585564710368, 'loss_val': 0.44783729646880965, 'psi': 0.8698853215818241}
[S7] START round=37 head_norm_before_train=1.442215 cos_to_last_merge=0.7941 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.794
[S7] round=37 local utility u=0.000000 metrics={'f1_val': 0.6048480893277854, 'auprc': 0.7923543097771485, 'loss_val': 0.6511037910089217, 'psi': 0.6798505775075306}-{'f1_val': 0.6493471547979397, 'auprc': 0.8091280690279741, 'loss_val': 0.5188313842275265, 'psi': 0.7132595204899534}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=37 head_norm_before_train=1.752769 cos_to_last_merge=0.9998 (last merge round=35)
[S8] round=37 local utility u=0.001805 metrics={'f1_val': 0.9907243993413981, 'auprc': 0.9991445506621284, 'loss_val': 0.04794025521251294, 'psi': 0.9940924598696903}-{'f1_val': 0.9907243993413981, 'auprc': 0.9990546136550326, 'loss_val': 0.05128011709489851, 'psi': 0.994056485066852}
[S9] START round=37 head_norm_before_train=1.761773 cos_to_last_merge=0.9682 (last merge round=27)
[S9] round=37 local utility u=0.000000 metrics={'f1_val': 0.9955763922175147, 'auprc': 0.9984693482428846, 'loss_val': 0.04031400579443758, 'psi': 0.9967335746276627}-{'f1_val': 0.9971029125121428, 'auprc': 0.996277732580108, 'loss_val': 0.04255200671287357, 'psi': 0.9967728405393289}
[S10] START round=37 head_norm_before_train=1.774334 cos_to_last_merge=0.9999 (last merge round=35)
[S10] round=37 local utility u=0.002056 metrics={'f1_val': 0.9948838907637279, 'auprc': 0.9985366757326687, 'loss_val': 0.030020007663836445, 'psi': 0.9963450047513043}-{'f1_val': 0.9947486092193725, 'auprc': 0.9981086991131078, 'loss_val': 0.03203695536106125, 'psi': 0.9960926451768666}
[S11] START round=37 head_norm_before_train=1.954094 cos_to_last_merge=0.9999 (last merge round=34)
[S11] round=37 local utility u=0.001031 metrics={'f1_val': 0.996305167468861, 'auprc': 0.998612011920947, 'loss_val': 0.03244518509973528, 'psi': 0.9972279052496953}-{'f1_val': 0.996305167468861, 'auprc': 0.9985970597660119, 'loss_val': 0.03446289692442898, 'psi': 0.9972219243877214}
[S13] START round=37 head_norm_before_train=1.769531 cos_to_last_merge=1.0000 (last merge round=36)
[S13] round=37 local utility u=0.418051 metrics={'f1_val': 0.6674851300800121, 'auprc': 0.7853270733282467, 'loss_val': 0.7153457223955928, 'psi': 0.714621907379306}-{'f1_val': 0.604206642010968, 'auprc': 0.7989300285640026, 'loss_val': 1.212586638776779, 'psi': 0.6820959966321818}
[S14] START round=37 head_norm_before_train=2.064967 (no previous merge yet)
[S14] round=37 local utility u=0.001087 metrics={'f1_val': 0.9967577367102773, 'auprc': 0.9948374665399565, 'loss_val': 0.020987053749098265, 'psi': 0.995989628642149}-{'f1_val': 0.9970007132142444, 'auprc': 0.9936556637010039, 'loss_val': 0.021074003266360004, 'psi': 0.9956626934089483}
[S15] START round=37 head_norm_before_train=1.628973 cos_to_last_merge=0.9983 (last merge round=33)
[S15] round=37 local utility u=0.000000 metrics={'f1_val': 0.9208250478953512, 'auprc': 0.9911509474619501, 'loss_val': 0.12286030832431656, 'psi': 0.9489554077219907}-{'f1_val': 0.9879346120243216, 'auprc': 0.9952545433637114, 'loss_val': 0.05903558318366237, 'psi': 0.9908625845600776}
[S16] START round=37 head_norm_before_train=1.571913 cos_to_last_merge=0.9698 (last merge round=27)
[S16] round=37 local utility u=0.161437 metrics={'f1_val': 0.9848171486338284, 'auprc': 0.9945270604481264, 'loss_val': 0.09861510411304363, 'psi': 0.9887011133595477}-{'f1_val': 0.9430293499324786, 'auprc': 0.9947883222510433, 'loss_val': 0.17154677954944644, 'psi': 0.9637329388599045}
[S17] START round=37 head_norm_before_train=1.794522 cos_to_last_merge=0.9955 (last merge round=32)
[S17] round=37 local utility u=0.077874 metrics={'f1_val': 0.8227294837094443, 'auprc': 0.9866188163496773, 'loss_val': 0.6766706551998706, 'psi': 0.8882852167655375}-{'f1_val': 0.8164204640685109, 'auprc': 0.9530874008894143, 'loss_val': 0.6939702384413354, 'psi': 0.8710872387968722}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:49312
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.996)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:49303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:49311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] → sending delta(kind=head bytes=1793) to S4@127.0.0.1:49304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:49316
[S11] sending update (kind=head size=1793 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S17] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:49315
[S4] sending update (kind=head size=1796 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1793) from S11
[S4] cosine check vs S11: cos=0.9989
[S3] RECEIVED delta(kind=head bytes=1800) from S17
[S3] cosine check vs S17: cos=0.9976
[S16] RECEIVED delta(kind=head bytes=1801) from S14
[S16] cosine check vs S14: cos=-0.0988
[S16] DROPPED delta from S14 (cos=-0.0988 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1799) from S13
[S10] cosine check vs S13: cos=0.9997
[S11] RECEIVED delta(kind=head bytes=1796) from S4
[S11] cosine check vs S4: cos=0.9989
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=37 metric=0.8227 head_norm=1.822890
[S17] _apply_head_vector_avg (torch): Δ‖w‖=7.801487e-02
[S17] stored merged vector for next round verification (round=37)
[S17] DEBUG after merge:  round=37 metric=0.8227 head_norm=1.771152 delta_norm=0.078015
[S17] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=37 metric=0.9537 head_norm=1.917140
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.163861e-02
[S4] stored merged vector for next round verification (round=37)
[S4] DEBUG after merge:  round=37 metric=0.9537 head_norm=1.942680 delta_norm=0.051639
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:49307
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:49305
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=37 metric=0.9963 head_norm=1.969243
[S11] _apply_head_vector_avg (torch): Δ‖w‖=5.163862e-02
[S11] stored merged vector for next round verification (round=37)
[S11] DEBUG after merge:  round=37 metric=0.9963 head_norm=1.942680 delta_norm=0.051639
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S15] RECEIVED delta(kind=head bytes=1797) from S2
[S15] cosine check vs S2: cos=0.9940
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1800) from S8
[S6] cosine check vs S8: cos=0.9946
[S5] RECEIVED delta(kind=head bytes=1800) from S16
[S5] cosine check vs S16: cos=0.9937
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=37 metric=0.9208 head_norm=1.657623
[S15] _apply_head_vector_avg (torch): Δ‖w‖=9.124059e-02
[S15] stored merged vector for next round verification (round=37)
[S15] DEBUG after merge:  round=37 metric=0.9214 head_norm=1.660081 delta_norm=0.091241
[S15] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=37 metric=0.8609 head_norm=1.733055
[S3] _apply_head_vector_avg (torch): Δ‖w‖=7.621953e-02
[S3] stored merged vector for next round verification (round=37)
[S3] DEBUG after merge:  round=37 metric=0.8594 head_norm=1.776906 delta_norm=0.076220
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=37 metric=0.7145 head_norm=1.568175
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.980183e-02
[S5] stored merged vector for next round verification (round=37)
[S5] DEBUG after merge:  round=37 metric=0.7145 head_norm=1.578215 delta_norm=0.089802
[S5] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=38 head_norm_before_train=1.667535 cos_to_last_merge=0.9990 (last merge round=35)
[S2] round=38 local utility u=0.301615 metrics={'f1_val': 0.8289816721994626, 'auprc': 0.8926775644872791, 'loss_val': 0.40452568821675666, 'psi': 0.8544600291145892}-{'f1_val': 0.7144146114262514, 'auprc': 0.9461908587972219, 'loss_val': 0.480893766617424, 'psi': 0.8071251103746395}
[S3] START round=38 head_norm_before_train=1.776906 cos_to_last_merge=1.0000 (last merge round=37)
[S3] round=38 local utility u=0.000000 metrics={'f1_val': 0.7124698049220648, 'auprc': 0.9702089264493924, 'loss_val': 0.39735998448821314, 'psi': 0.8155654535329958}-{'f1_val': 0.8609380573487797, 'auprc': 0.9787477367545008, 'loss_val': 0.19845916399343425, 'psi': 0.9080619291110681}
[S4] START round=38 head_norm_before_train=1.942680 cos_to_last_merge=1.0000 (last merge round=37)
[S4] round=38 local utility u=0.000000 metrics={'f1_val': 0.9359530813725837, 'auprc': 0.9403232704386054, 'loss_val': 0.32590606874211797, 'psi': 0.9377011569989924}-{'f1_val': 0.953718053819398, 'auprc': 0.9787642678423827, 'loss_val': 0.29670492045883345, 'psi': 0.9637365394285918}
[S5] START round=38 head_norm_before_train=1.578215 cos_to_last_merge=1.0000 (last merge round=37)
[S5] round=38 local utility u=0.471408 metrics={'f1_val': 0.7076747047216473, 'auprc': 0.979244445168048, 'loss_val': 0.24096773961746257, 'psi': 0.8163026009002076}-{'f1_val': 0.7145325028856473, 'auprc': 0.7812915798120971, 'loss_val': 0.6310725805033818, 'psi': 0.7412361336562272}
[S6] START round=38 head_norm_before_train=1.756978 cos_to_last_merge=0.9998 (last merge round=36)
[S6] round=38 local utility u=0.368015 metrics={'f1_val': 0.7945370281539608, 'auprc': 0.9408460145931103, 'loss_val': 0.5375013321714639, 'psi': 0.8530606227296206}-{'f1_val': 0.7120078850923407, 'auprc': 0.8938887253047783, 'loss_val': 0.6374851027661708, 'psi': 0.7847602211773157}
[S7] START round=38 head_norm_before_train=1.448817 cos_to_last_merge=0.7929 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.793
[S7] round=38 local utility u=0.172546 metrics={'f1_val': 0.6401953535156283, 'auprc': 0.8039598937053115, 'loss_val': 0.5529126661758471, 'psi': 0.7057011695915016}-{'f1_val': 0.6048480893277854, 'auprc': 0.7923543097771485, 'loss_val': 0.6511037910089217, 'psi': 0.6798505775075306}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=38 head_norm_before_train=1.781263 cos_to_last_merge=0.9992 (last merge round=35)
[S8] round=38 local utility u=0.010789 metrics={'f1_val': 0.9929024225986427, 'auprc': 0.999100438840215, 'loss_val': 0.03929798347505265, 'psi': 0.9953816290952717}-{'f1_val': 0.9907243993413981, 'auprc': 0.9991445506621284, 'loss_val': 0.04794025521251294, 'psi': 0.9940924598696903}
[S9] START round=38 head_norm_before_train=1.776888 cos_to_last_merge=0.9665 (last merge round=27)
[S9] round=38 local utility u=0.001773 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9966499700636734, 'loss_val': 0.037814189020092905, 'psi': 0.9966562951138043}-{'f1_val': 0.9955763922175147, 'auprc': 0.9984693482428846, 'loss_val': 0.04031400579443758, 'psi': 0.9967335746276627}
[S10] START round=38 head_norm_before_train=1.795046 cos_to_last_merge=0.9998 (last merge round=35)
[S10] round=38 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9982538072627731, 'loss_val': 0.029177027731355637, 'psi': 0.9961506884367328}-{'f1_val': 0.9948838907637279, 'auprc': 0.9985366757326687, 'loss_val': 0.030020007663836445, 'psi': 0.9963450047513043}
[S11] START round=38 head_norm_before_train=1.942680 cos_to_last_merge=1.0000 (last merge round=37)
[S11] round=38 local utility u=0.000425 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.998585297113582, 'loss_val': 0.0329669166309061, 'psi': 0.9973623215535865}-{'f1_val': 0.996305167468861, 'auprc': 0.998612011920947, 'loss_val': 0.03244518509973528, 'psi': 0.9972279052496953}
[S13] START round=38 head_norm_before_train=1.777793 cos_to_last_merge=1.0000 (last merge round=36)
[S13] round=38 local utility u=0.000000 metrics={'f1_val': 0.5767861034605036, 'auprc': 0.7384788918017346, 'loss_val': 1.4477388623521534, 'psi': 0.6414632187969961}-{'f1_val': 0.6674851300800121, 'auprc': 0.7853270733282467, 'loss_val': 0.7153457223955928, 'psi': 0.714621907379306}
[S14] START round=38 head_norm_before_train=2.076545 (no previous merge yet)
[S14] round=38 local utility u=0.005096 metrics={'f1_val': 0.9967577367102773, 'auprc': 0.998094996594751, 'loss_val': 0.020567378383596513, 'psi': 0.9972926406640669}-{'f1_val': 0.9967577367102773, 'auprc': 0.9948374665399565, 'loss_val': 0.020987053749098265, 'psi': 0.995989628642149}
[S15] START round=38 head_norm_before_train=1.660081 cos_to_last_merge=1.0000 (last merge round=37)
[S15] round=38 local utility u=0.000000 metrics={'f1_val': 0.8727320268237545, 'auprc': 0.9903159818466495, 'loss_val': 0.2649888771824059, 'psi': 0.9197656088329125}-{'f1_val': 0.9208250478953512, 'auprc': 0.9911509474619501, 'loss_val': 0.12286030832431656, 'psi': 0.9489554077219907}
[S16] START round=38 head_norm_before_train=1.593261 cos_to_last_merge=0.9674 (last merge round=27)
[S16] round=38 local utility u=0.025182 metrics={'f1_val': 0.9896078415739858, 'auprc': 0.9943776537660024, 'loss_val': 0.07654761237216692, 'psi': 0.9915157664507925}-{'f1_val': 0.9848171486338284, 'auprc': 0.9945270604481264, 'loss_val': 0.09861510411304363, 'psi': 0.9887011133595477}
[S17] START round=38 head_norm_before_train=1.771152 cos_to_last_merge=1.0000 (last merge round=37)
[S17] round=38 local utility u=0.000000 metrics={'f1_val': 0.8249795326213979, 'auprc': 0.9662363521181856, 'loss_val': 0.6921613507838758, 'psi': 0.8814822604201129}-{'f1_val': 0.8227294837094443, 'auprc': 0.9866188163496773, 'loss_val': 0.6766706551998706, 'psi': 0.8882852167655375}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.997)
[S11] not sending this round → trigger blocked (psi=0.997)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:49309
[S2] not sending this round → trigger blocked (psi=0.854)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=38 metric=0.9947 head_norm=1.813811
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.217993e-02
[S10] stored merged vector for next round verification (round=38)
[S10] DEBUG after merge:  round=38 metric=0.9947 head_norm=1.795604 delta_norm=0.032180
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S6] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S5] → sending delta(kind=head bytes=1806) to S15@127.0.0.1:49315
[S8] RECEIVED delta(kind=head bytes=1803) from S6
[S8] cosine check vs S6: cos=0.9929
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=38 metric=0.7945 head_norm=1.767966
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.057458e-01
[S6] stored merged vector for next round verification (round=38)
[S6] DEBUG after merge:  round=38 metric=0.8047 head_norm=1.771474 delta_norm=0.105746
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S5] sending update (kind=head size=1806 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.995)
[S16] not sending this round → trigger blocked (psi=0.992)
[S15] RECEIVED delta(kind=head bytes=1806) from S5
[S15] cosine check vs S5: cos=-0.0640
[S15] DROPPED delta from S5 (cos=-0.0640 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:49309
[S9] sending update (kind=head size=1796 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1796) from S9
[S8] cosine check vs S9: cos=0.9650
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=38 metric=0.9929 head_norm=1.809186
[S8] _apply_head_vector_avg (torch): Δ‖w‖=9.715023e-02
[S8] stored merged vector for next round verification (round=38)
[S8] DEBUG after merge:  round=38 metric=0.9929 head_norm=1.777563 delta_norm=0.097150
[S8] aggregate: ACCEPT kept=['S6', 'S9'] (k=2/2) mode=median trim_p=0.1
[S2] START round=39 head_norm_before_train=1.695062 cos_to_last_merge=0.9981 (last merge round=35)
[S2] round=39 local utility u=0.000000 metrics={'f1_val': 0.8354516996610696, 'auprc': 0.8725856551328527, 'loss_val': 0.45040374857020066, 'psi': 0.8503052818497827}-{'f1_val': 0.8289816721994626, 'auprc': 0.8926775644872791, 'loss_val': 0.40452568821675666, 'psi': 0.8544600291145892}
[S3] START round=39 head_norm_before_train=1.789841 cos_to_last_merge=1.0000 (last merge round=37)
[S3] round=39 local utility u=0.027142 metrics={'f1_val': 0.7288966200075697, 'auprc': 0.9684931161392131, 'loss_val': 0.43648877428979105, 'psi': 0.824735218460227}-{'f1_val': 0.7124698049220648, 'auprc': 0.9702089264493924, 'loss_val': 0.39735998448821314, 'psi': 0.8155654535329958}
[S4] START round=39 head_norm_before_train=1.936203 cos_to_last_merge=0.9999 (last merge round=37)
[S4] round=39 local utility u=0.071819 metrics={'f1_val': 0.941228141894323, 'auprc': 0.9714865070168948, 'loss_val': 0.30740882814683557, 'psi': 0.9533314879433518}-{'f1_val': 0.9359530813725837, 'auprc': 0.9403232704386054, 'loss_val': 0.32590606874211797, 'psi': 0.9377011569989924}
[S5] START round=39 head_norm_before_train=1.586514 cos_to_last_merge=1.0000 (last merge round=37)
[S5] round=39 local utility u=0.000000 metrics={'f1_val': 0.7204313734467901, 'auprc': 0.812810428450018, 'loss_val': 0.41840244238146146, 'psi': 0.7573829954480813}-{'f1_val': 0.7076747047216473, 'auprc': 0.979244445168048, 'loss_val': 0.24096773961746257, 'psi': 0.8163026009002076}
[S6] START round=39 head_norm_before_train=1.771474 cos_to_last_merge=1.0000 (last merge round=38)
[S6] round=39 local utility u=0.458290 metrics={'f1_val': 0.8896220738056418, 'auprc': 0.9582697685100579, 'loss_val': 0.24370340835868107, 'psi': 0.9170811516874082}-{'f1_val': 0.7945370281539608, 'auprc': 0.9408460145931103, 'loss_val': 0.5375013321714639, 'psi': 0.8530606227296206}
[S7] START round=39 head_norm_before_train=1.459268 cos_to_last_merge=0.7912 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.791
[S7] round=39 local utility u=0.000000 metrics={'f1_val': 0.5696388340907118, 'auprc': 0.7884080391912518, 'loss_val': 0.7572595253685198, 'psi': 0.6571465161309278}-{'f1_val': 0.6401953535156283, 'auprc': 0.8039598937053115, 'loss_val': 0.5529126661758471, 'psi': 0.7057011695915016}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] r=40 psi=0.657 u=0.0000 p_local=0.2291 f1=0.570 auprc=0.788 bytes=37761
[S8] START round=39 head_norm_before_train=1.777563 cos_to_last_merge=1.0000 (last merge round=38)
[S8] round=39 local utility u=0.001583 metrics={'f1_val': 0.9936253371144965, 'auprc': 0.999091647788539, 'loss_val': 0.04044217095294259, 'psi': 0.9958118613841136}-{'f1_val': 0.9929024225986427, 'auprc': 0.999100438840215, 'loss_val': 0.03929798347505265, 'psi': 0.9953816290952717}
[S9] START round=39 head_norm_before_train=1.789927 cos_to_last_merge=0.9651 (last merge round=27)
[S9] round=39 local utility u=0.000000 metrics={'f1_val': 0.9943271883459407, 'auprc': 0.9984681347175947, 'loss_val': 0.039087674577505484, 'psi': 0.9959835668946023}-{'f1_val': 0.9966605118138915, 'auprc': 0.9966499700636734, 'loss_val': 0.037814189020092905, 'psi': 0.9966562951138043}
[S10] START round=39 head_norm_before_train=1.795604 cos_to_last_merge=1.0000 (last merge round=38)
[S10] round=39 local utility u=0.000471 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9982362540104617, 'loss_val': 0.029498877192339398, 'psi': 0.9962754135232303}-{'f1_val': 0.9947486092193725, 'auprc': 0.9982538072627731, 'loss_val': 0.029177027731355637, 'psi': 0.9961506884367328}
[S11] START round=39 head_norm_before_train=1.956234 cos_to_last_merge=1.0000 (last merge round=37)
[S11] round=39 local utility u=0.000276 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9986257993028163, 'loss_val': 0.031084728230728133, 'psi': 0.9972334202024431}-{'f1_val': 0.9965470045135896, 'auprc': 0.998585297113582, 'loss_val': 0.0329669166309061, 'psi': 0.9973623215535865}
[S13] START round=39 head_norm_before_train=1.784143 cos_to_last_merge=0.9999 (last merge round=36)
[S13] round=39 local utility u=0.866590 metrics={'f1_val': 0.7202543043972615, 'auprc': 0.795743135682518, 'loss_val': 0.7471613197696519, 'psi': 0.7504498369113641}-{'f1_val': 0.5767861034605036, 'auprc': 0.7384788918017346, 'loss_val': 1.4477388623521534, 'psi': 0.6414632187969961}
[S14] START round=39 head_norm_before_train=2.083229 (no previous merge yet)
[S14] round=39 local utility u=0.003017 metrics={'f1_val': 0.9971680177638609, 'auprc': 0.9989920364559669, 'loss_val': 0.019686643943379118, 'psi': 0.9978976252407032}-{'f1_val': 0.9967577367102773, 'auprc': 0.998094996594751, 'loss_val': 0.020567378383596513, 'psi': 0.9972926406640669}
[S15] START round=39 head_norm_before_train=1.685247 cos_to_last_merge=0.9999 (last merge round=37)
[S15] round=39 local utility u=0.491107 metrics={'f1_val': 0.9963164379542544, 'auprc': 0.9954715355693953, 'loss_val': 0.03974810239099636, 'psi': 0.9959784770003108}-{'f1_val': 0.8727320268237545, 'auprc': 0.9903159818466495, 'loss_val': 0.2649888771824059, 'psi': 0.9197656088329125}
[S16] START round=39 head_norm_before_train=1.612066 cos_to_last_merge=0.9653 (last merge round=27)
[S16] round=39 local utility u=0.000000 metrics={'f1_val': 0.9568503884485702, 'auprc': 0.9943576120128832, 'loss_val': 0.14529222763518432, 'psi': 0.9718532778742954}-{'f1_val': 0.9896078415739858, 'auprc': 0.9943776537660024, 'loss_val': 0.07654761237216692, 'psi': 0.9915157664507925}
[S17] START round=39 head_norm_before_train=1.799914 cos_to_last_merge=0.9999 (last merge round=37)
[S17] round=39 local utility u=0.000000 metrics={'f1_val': 0.6725742482668405, 'auprc': 0.9604969216394681, 'loss_val': 1.1022077190159105, 'psi': 0.7877433176158917}-{'f1_val': 0.8249795326213979, 'auprc': 0.9662363521181856, 'loss_val': 0.6921613507838758, 'psi': 0.8814822604201129}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:49311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S11] → sending delta(kind=head bytes=1790) to S4@127.0.0.1:49304
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:49313
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:49316
[S6] not sending this round → trigger blocked (psi=0.917)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S4] → sending delta(kind=head bytes=1792) to S11@127.0.0.1:49312
[S4] sending update (kind=head size=1792 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1800 to 1 peers)
[S6] r=40 psi=0.917 u=0.4583 p_local=0.2546 f1=0.890 auprc=0.958 bytes=35985
[S10] sending update (kind=head size=1798 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1790 to 1 peers)
[S17] r=40 psi=0.788 u=0.0000 p_local=0.1447 f1=0.673 auprc=0.960 bytes=32373
[S13] sending update (kind=head size=1801 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1800) from S14
[S16] cosine check vs S14: cos=-0.0988
[S16] DROPPED delta from S14 (cos=-0.0988 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1798) from S10
[S13] cosine check vs S10: cos=0.9997
[S11] RECEIVED delta(kind=head bytes=1792) from S4
[S11] cosine check vs S4: cos=0.9997
[S4] RECEIVED delta(kind=head bytes=1790) from S11
[S4] cosine check vs S11: cos=0.9997
[S10] RECEIVED delta(kind=head bytes=1801) from S13
[S10] cosine check vs S13: cos=0.9997
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=39 metric=0.7203 head_norm=1.784170
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.663852e-02
[S13] stored merged vector for next round verification (round=39)
[S13] DEBUG after merge:  round=39 metric=0.7192 head_norm=1.798599 delta_norm=0.026639
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S13] r=40 psi=0.750 u=0.8666 p_local=0.2839 f1=0.720 auprc=0.796 bytes=34155
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=39 metric=0.9963 head_norm=1.969635
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.692296e-02
[S11] stored merged vector for next round verification (round=39)
[S11] DEBUG after merge:  round=39 metric=0.9963 head_norm=1.955368 delta_norm=0.026923
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] r=40 psi=0.997 u=0.0003 p_local=0.0060 f1=0.996 auprc=0.999 bytes=46700
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:49305
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] → sending delta(kind=head bytes=1794) to S17@127.0.0.1:49317
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=39 metric=0.9950 head_norm=1.813305
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.663852e-02
[S10] stored merged vector for next round verification (round=39)
[S10] DEBUG after merge:  round=39 metric=0.9950 head_norm=1.798599 delta_norm=0.026639
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S10] r=40 psi=0.996 u=0.0005 p_local=0.0022 f1=0.995 auprc=0.998 bytes=41351
[S14] r=40 psi=0.998 u=0.0030 p_local=0.0163 f1=0.997 auprc=0.999 bytes=41395
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:49307
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=39 metric=0.9412 head_norm=1.941368
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.692296e-02
[S4] stored merged vector for next round verification (round=39)
[S4] DEBUG after merge:  round=39 metric=0.9412 head_norm=1.955368 delta_norm=0.026923
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S4] r=40 psi=0.953 u=0.0718 p_local=0.0312 f1=0.941 auprc=0.971 bytes=30556
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1794 to 1 peers)
[S15] sending update (kind=head size=1804 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1803) from S8
[S6] cosine check vs S8: cos=0.9958
[S17] RECEIVED delta(kind=head bytes=1794) from S3
[S17] cosine check vs S3: cos=0.9996
[S5] RECEIVED delta(kind=head bytes=1804) from S15
[S5] cosine check vs S15: cos=-0.0650
[S5] DROPPED delta from S15 (cos=-0.0650 < 0.0)
[S9] r=40 psi=0.996 u=0.0000 p_local=0.0100 f1=0.994 auprc=0.998 bytes=44997
[S16] r=40 psi=0.972 u=0.0000 p_local=0.0661 f1=0.957 auprc=0.994 bytes=37778
[S15] r=40 psi=0.996 u=0.4911 p_local=0.2346 f1=0.996 auprc=0.995 bytes=34169
[S8] r=40 psi=0.996 u=0.0016 p_local=0.0276 f1=0.994 auprc=0.999 bytes=36021
[S3] r=40 psi=0.825 u=0.0271 p_local=0.1155 f1=0.729 auprc=0.968 bytes=34136
[S5] r=40 psi=0.757 u=0.0000 p_local=0.1424 f1=0.720 auprc=0.813 bytes=37822
[S2] r=40 psi=0.850 u=0.0000 p_local=0.0914 f1=0.835 auprc=0.873 bytes=34149
[S2] START round=40 head_norm_before_train=1.718888 cos_to_last_merge=0.9972 (last merge round=35)
[S2] round=40 local utility u=0.000000 metrics={'f1_val': 0.7157854740567238, 'auprc': 0.8371862615054317, 'loss_val': 0.5874063776169158, 'psi': 0.764345789036207}-{'f1_val': 0.8354516996610696, 'auprc': 0.8725856551328527, 'loss_val': 0.45040374857020066, 'psi': 0.8503052818497827}
[S3] START round=40 head_norm_before_train=1.801231 cos_to_last_merge=0.9999 (last merge round=37)
[S3] round=40 local utility u=0.664010 metrics={'f1_val': 0.9060772067416145, 'auprc': 0.9769556525099816, 'loss_val': 0.196939099461246, 'psi': 0.9344285850489613}-{'f1_val': 0.7288966200075697, 'auprc': 0.9684931161392131, 'loss_val': 0.43648877428979105, 'psi': 0.824735218460227}
[S4] START round=40 head_norm_before_train=1.955368 cos_to_last_merge=1.0000 (last merge round=39)
[S4] round=40 local utility u=0.000000 metrics={'f1_val': 0.9415152213539724, 'auprc': 0.9640418088054952, 'loss_val': 0.30547667481953594, 'psi': 0.9505258563345815}-{'f1_val': 0.941228141894323, 'auprc': 0.9714865070168948, 'loss_val': 0.30740882814683557, 'psi': 0.9533314879433518}
[S5] START round=40 head_norm_before_train=1.599344 cos_to_last_merge=0.9998 (last merge round=37)
[S5] round=40 local utility u=1.000000 metrics={'f1_val': 0.9967731002659072, 'auprc': 0.997245329598511, 'loss_val': 0.14582506588932598, 'psi': 0.9969619919989487}-{'f1_val': 0.7204313734467901, 'auprc': 0.812810428450018, 'loss_val': 0.41840244238146146, 'psi': 0.7573829954480813}
[S6] START round=40 head_norm_before_train=1.782189 cos_to_last_merge=0.9998 (last merge round=38)
[S6] round=40 local utility u=0.000000 metrics={'f1_val': 0.6248677721412956, 'auprc': 0.8809566724179572, 'loss_val': 0.7748657310094609, 'psi': 0.7273033322519602}-{'f1_val': 0.8896220738056418, 'auprc': 0.9582697685100579, 'loss_val': 0.24370340835868107, 'psi': 0.9170811516874082}
[S7] START round=40 head_norm_before_train=1.469486 cos_to_last_merge=0.7896 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.790
[S7] round=40 local utility u=0.158689 metrics={'f1_val': 0.5998918523915276, 'auprc': 0.7971292923246631, 'loss_val': 0.6475629421831459, 'psi': 0.6787868283647818}-{'f1_val': 0.5696388340907118, 'auprc': 0.7884080391912518, 'loss_val': 0.7572595253685198, 'psi': 0.6571465161309278}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S8] START round=40 head_norm_before_train=1.801954 cos_to_last_merge=0.9999 (last merge round=38)
[S8] round=40 local utility u=0.000000 metrics={'f1_val': 0.9907243993413981, 'auprc': 0.999059654880658, 'loss_val': 0.04330384359753483, 'psi': 0.9940585015571021}-{'f1_val': 0.9936253371144965, 'auprc': 0.999091647788539, 'loss_val': 0.04044217095294259, 'psi': 0.9958118613841136}
[S9] START round=40 head_norm_before_train=1.802096 cos_to_last_merge=0.9639 (last merge round=27)
[S9] round=40 local utility u=0.000000 metrics={'f1_val': 0.9935215919844088, 'auprc': 0.9984691412114272, 'loss_val': 0.040290520011693275, 'psi': 0.9955006116752161}-{'f1_val': 0.9943271883459407, 'auprc': 0.9984681347175947, 'loss_val': 0.039087674577505484, 'psi': 0.9959835668946023}
[S10] START round=40 head_norm_before_train=1.798599 cos_to_last_merge=1.0000 (last merge round=39)
[S10] round=40 local utility u=0.000924 metrics={'f1_val': 0.9951633020469546, 'auprc': 0.9982626598633499, 'loss_val': 0.028901045973218558, 'psi': 0.9964030451735126}-{'f1_val': 0.9949681865317428, 'auprc': 0.9982362540104617, 'loss_val': 0.029498877192339398, 'psi': 0.9962754135232303}
[S11] START round=40 head_norm_before_train=1.955368 cos_to_last_merge=1.0000 (last merge round=39)
[S11] round=40 local utility u=0.000403 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9986144431680303, 'loss_val': 0.030244245819879792, 'psi': 0.9972288777485288}-{'f1_val': 0.996305167468861, 'auprc': 0.9986257993028163, 'loss_val': 0.031084728230728133, 'psi': 0.9972334202024431}
[S13] START round=40 head_norm_before_train=1.798599 cos_to_last_merge=1.0000 (last merge round=39)
[S13] round=40 local utility u=0.000000 metrics={'f1_val': 0.7204235690620433, 'auprc': 0.7984523278910085, 'loss_val': 0.890419286088897, 'psi': 0.7516350725936294}-{'f1_val': 0.7202543043972615, 'auprc': 0.795743135682518, 'loss_val': 0.7471613197696519, 'psi': 0.7504498369113641}
[S14] START round=40 head_norm_before_train=2.089782 (no previous merge yet)
[S14] round=40 local utility u=0.000275 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9992045168172271, 'loss_val': 0.018750032920153148, 'psi': 0.9978803116214898}-{'f1_val': 0.9971680177638609, 'auprc': 0.9989920364559669, 'loss_val': 0.019686643943379118, 'psi': 0.9978976252407032}
[S15] START round=40 head_norm_before_train=1.710409 cos_to_last_merge=0.9997 (last merge round=37)
[S15] round=40 local utility u=0.000000 metrics={'f1_val': 0.8820221817337678, 'auprc': 0.9937897824983494, 'loss_val': 0.28088383787071125, 'psi': 0.9267292220396004}-{'f1_val': 0.9963164379542544, 'auprc': 0.9954715355693953, 'loss_val': 0.03974810239099636, 'psi': 0.9959784770003108}
[S16] START round=40 head_norm_before_train=1.629100 cos_to_last_merge=0.9635 (last merge round=27)
[S16] round=40 local utility u=0.000000 metrics={'f1_val': 0.9545203298360534, 'auprc': 0.9938152924623109, 'loss_val': 0.14866946919297527, 'psi': 0.9702383148865563}-{'f1_val': 0.9568503884485702, 'auprc': 0.9943576120128832, 'loss_val': 0.14529222763518432, 'psi': 0.9718532778742954}
[S17] START round=40 head_norm_before_train=1.825763 cos_to_last_merge=0.9997 (last merge round=37)
[S17] round=40 local utility u=0.547596 metrics={'f1_val': 0.8110443945909, 'auprc': 0.9330894551816994, 'loss_val': 0.7556133946944384, 'psi': 0.8598624188272197}-{'f1_val': 0.6725742482668405, 'auprc': 0.9604969216394681, 'loss_val': 1.1022077190159105, 'psi': 0.7877433176158917}
[S11] not sending this round → trigger blocked (psi=0.997)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.998)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:49303
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.996)
[S17] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] → sending delta(kind=head bytes=1805) to S15@127.0.0.1:49315
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=40 metric=0.6249 head_norm=1.796497
[S6] _apply_head_vector_avg (torch): Δ‖w‖=9.054616e-02
[S6] stored merged vector for next round verification (round=40)
[S6] DEBUG after merge:  round=40 metric=0.6277 head_norm=1.796948 delta_norm=0.090546
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.204 → S8@127.0.0.1:49309
[S14] ⇄ pheromone p=0.013 → S16@127.0.0.1:49316
[S13] ⇄ pheromone p=0.227 → S10@127.0.0.1:49311
[S4] ⇄ pheromone p=0.025 → S11@127.0.0.1:49312
[S10] ⇄ pheromone p=0.002 → S13@127.0.0.1:49313
[S11] ⇄ pheromone p=0.005 → S4@127.0.0.1:49304
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] RECEIVED delta(kind=head bytes=1799) from S17
[S3] cosine check vs S17: cos=0.9992
[S3] not sending this round → trigger blocked (psi=0.934)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1805 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=40 metric=0.8110 head_norm=1.846409
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.995936e-02
[S17] stored merged vector for next round verification (round=40)
[S17] DEBUG after merge:  round=40 metric=0.8110 head_norm=1.823522 delta_norm=0.039959
[S17] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.225 → S3@127.0.0.1:49303
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] RECEIVED delta(kind=head bytes=1805) from S5
[S15] cosine check vs S5: cos=-0.0658
[S15] DROPPED delta from S5 (cos=-0.0658 < 0.0)
[S5] ⇄ pheromone p=0.314 → S15@127.0.0.1:49315
[S15] ⇄ pheromone p=0.188 → S5@127.0.0.1:49305
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=40 metric=0.9061 head_norm=1.811463
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.992260e-02
[S3] stored merged vector for next round verification (round=40)
[S3] DEBUG after merge:  round=40 metric=0.9052 head_norm=1.828583 delta_norm=0.039923
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.225 → S7@127.0.0.1:49308
[S16] ⇄ pheromone p=0.053 → S5@127.0.0.1:49305
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] ⇄ pheromone p=0.008 → S8@127.0.0.1:49309
[S2] ⇄ pheromone p=0.073 → S15@127.0.0.1:49315
[S8] ⇄ pheromone p=0.022 → S6@127.0.0.1:49307
[S2] START round=41 head_norm_before_train=1.741519 cos_to_last_merge=0.9962 (last merge round=35)
[S2] round=41 local utility u=0.045769 metrics={'f1_val': 0.7153486375039823, 'auprc': 0.857619663090708, 'loss_val': 0.5545483702073619, 'psi': 0.7722570477386725}-{'f1_val': 0.7157854740567238, 'auprc': 0.8371862615054317, 'loss_val': 0.5874063776169158, 'psi': 0.764345789036207}
[S3] START round=41 head_norm_before_train=1.828583 cos_to_last_merge=1.0000 (last merge round=40)
[S3] round=41 local utility u=0.000000 metrics={'f1_val': 0.8531074545323292, 'auprc': 0.9712516576513885, 'loss_val': 0.32124003384066047, 'psi': 0.9003651357799529}-{'f1_val': 0.9060772067416145, 'auprc': 0.9769556525099816, 'loss_val': 0.196939099461246, 'psi': 0.9344285850489613}
[S4] START round=41 head_norm_before_train=1.959466 cos_to_last_merge=0.9999 (last merge round=39)
[S4] round=41 local utility u=0.016493 metrics={'f1_val': 0.9419106455732802, 'auprc': 0.9732395020508722, 'loss_val': 0.3024561235257107, 'psi': 0.9544421881643169}-{'f1_val': 0.9415152213539724, 'auprc': 0.9640418088054952, 'loss_val': 0.30547667481953594, 'psi': 0.9505258563345815}
[S5] START round=41 head_norm_before_train=1.613276 cos_to_last_merge=0.9996 (last merge round=37)
[S5] round=41 local utility u=0.000000 metrics={'f1_val': 0.726546258100091, 'auprc': 0.8563066474714256, 'loss_val': 0.35172077721474165, 'psi': 0.7784504138486248}-{'f1_val': 0.9967731002659072, 'auprc': 0.997245329598511, 'loss_val': 0.14582506588932598, 'psi': 0.9969619919989487}
[S6] START round=41 head_norm_before_train=1.796948 cos_to_last_merge=1.0000 (last merge round=40)
[S6] round=41 local utility u=1.000000 metrics={'f1_val': 0.8896840789471504, 'auprc': 0.961472871009025, 'loss_val': 0.21061153051273362, 'psi': 0.9183995957719002}-{'f1_val': 0.6248677721412956, 'auprc': 0.8809566724179572, 'loss_val': 0.7748657310094609, 'psi': 0.7273033322519602}
[S7] START round=41 head_norm_before_train=1.480468 cos_to_last_merge=0.7879 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.788
[S7] round=41 local utility u=0.059065 metrics={'f1_val': 0.6129194375623197, 'auprc': 0.7985949130272503, 'loss_val': 0.6119949623429074, 'psi': 0.687189627748292}-{'f1_val': 0.5998918523915276, 'auprc': 0.7971292923246631, 'loss_val': 0.6475629421831459, 'psi': 0.6787868283647818}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=41 head_norm_before_train=1.826754 cos_to_last_merge=0.9996 (last merge round=38)
[S8] round=41 local utility u=0.010113 metrics={'f1_val': 0.9929024225986427, 'auprc': 0.9991683901348554, 'loss_val': 0.036471590159773956, 'psi': 0.9954088096131277}-{'f1_val': 0.9907243993413981, 'auprc': 0.999059654880658, 'loss_val': 0.04330384359753483, 'psi': 0.9940585015571021}
[S9] START round=41 head_norm_before_train=1.814379 cos_to_last_merge=0.9626 (last merge round=27)
[S9] round=41 local utility u=0.007314 metrics={'f1_val': 0.99518968612894, 'auprc': 0.9984677224699392, 'loss_val': 0.03566731459160996, 'psi': 0.9965009006653397}-{'f1_val': 0.9935215919844088, 'auprc': 0.9984691412114272, 'loss_val': 0.040290520011693275, 'psi': 0.9955006116752161}
[S10] START round=41 head_norm_before_train=1.816811 cos_to_last_merge=1.0000 (last merge round=39)
[S10] round=41 local utility u=0.000645 metrics={'f1_val': 0.9951633020469546, 'auprc': 0.998330816698285, 'loss_val': 0.0278160571849434, 'psi': 0.9964303079074868}-{'f1_val': 0.9951633020469546, 'auprc': 0.9982626598633499, 'loss_val': 0.028901045973218558, 'psi': 0.9964030451735126}
[S11] START round=41 head_norm_before_train=1.969177 cos_to_last_merge=1.0000 (last merge round=39)
[S11] round=41 local utility u=0.000661 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9986363118108302, 'loss_val': 0.02898788091717907, 'psi': 0.9972376252056487}-{'f1_val': 0.996305167468861, 'auprc': 0.9986144431680303, 'loss_val': 0.030244245819879792, 'psi': 0.9972288777485288}
[S13] START round=41 head_norm_before_train=1.796463 cos_to_last_merge=1.0000 (last merge round=39)
[S13] round=41 local utility u=0.000000 metrics={'f1_val': 0.7021359443878665, 'auprc': 0.7780607464845283, 'loss_val': 0.8182344331673689, 'psi': 0.7325058652265313}-{'f1_val': 0.7204235690620433, 'auprc': 0.7984523278910085, 'loss_val': 0.890419286088897, 'psi': 0.7516350725936294}
[S14] START round=41 head_norm_before_train=2.096128 (no previous merge yet)
[S14] round=41 local utility u=0.002184 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9992067247426085, 'loss_val': 0.01685240495983349, 'psi': 0.9981276515980788}-{'f1_val': 0.9969975081576651, 'auprc': 0.9992045168172271, 'loss_val': 0.018750032920153148, 'psi': 0.9978803116214898}
[S15] START round=41 head_norm_before_train=1.733624 cos_to_last_merge=0.9993 (last merge round=37)
[S15] round=41 local utility u=0.143208 metrics={'f1_val': 0.9082420499863019, 'auprc': 0.9881161883316453, 'loss_val': 0.13476708653138408, 'psi': 0.9401917053244392}-{'f1_val': 0.8820221817337678, 'auprc': 0.9937897824983494, 'loss_val': 0.28088383787071125, 'psi': 0.9267292220396004}
[S16] START round=41 head_norm_before_train=1.645240 cos_to_last_merge=0.9618 (last merge round=27)
[S16] round=41 local utility u=0.068646 metrics={'f1_val': 0.9710543741457444, 'auprc': 0.9930484736855238, 'loss_val': 0.10828045702885412, 'psi': 0.9798520139616561}-{'f1_val': 0.9545203298360534, 'auprc': 0.9938152924623109, 'loss_val': 0.14866946919297527, 'psi': 0.9702383148865563}
[S17] START round=41 head_norm_before_train=1.823522 cos_to_last_merge=1.0000 (last merge round=40)
[S17] round=41 local utility u=0.338295 metrics={'f1_val': 0.8897655512888345, 'auprc': 0.9162424619207359, 'loss_val': 0.5008096242731331, 'psi': 0.9003563155415951}-{'f1_val': 0.8110443945909, 'auprc': 0.9330894551816994, 'loss_val': 0.7556133946944384, 'psi': 0.8598624188272197}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:49313
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:49303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S11] → sending delta(kind=head bytes=1790) to S4@127.0.0.1:49304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:49309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:49316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S11@127.0.0.1:49312
[S14] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:49315
[S11] sending update (kind=head size=1790 to 1 peers)
[S4] sending update (kind=head size=1794 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1794) from S4
[S11] cosine check vs S4: cos=0.9996
[S3] RECEIVED delta(kind=head bytes=1797) from S17
[S3] cosine check vs S17: cos=0.9999
[S4] RECEIVED delta(kind=head bytes=1790) from S11
[S4] cosine check vs S11: cos=0.9996
[S8] RECEIVED delta(kind=head bytes=1803) from S6
[S8] cosine check vs S6: cos=0.9982
[S16] RECEIVED delta(kind=head bytes=1796) from S14
[S16] cosine check vs S14: cos=-0.0998
[S16] DROPPED delta from S14 (cos=-0.0998 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1803) from S10
[S13] cosine check vs S10: cos=0.9998
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S8] → sending delta(kind=head bytes=1809) to S6@127.0.0.1:49307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:49305
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=41 metric=0.9419 head_norm=1.961879
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.045291e-02
[S4] stored merged vector for next round verification (round=41)
[S4] DEBUG after merge:  round=41 metric=0.9419 head_norm=1.972071 delta_norm=0.030453
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=41 metric=0.9963 head_norm=1.982679
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.045291e-02
[S11] stored merged vector for next round verification (round=41)
[S11] DEBUG after merge:  round=41 metric=0.9963 head_norm=1.972071 delta_norm=0.030453
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:49305
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] RECEIVED delta(kind=head bytes=1802) from S2
[S15] cosine check vs S2: cos=0.9905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:49309
[S16] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1809 to 1 peers)
[S15] sending update (kind=head size=1794 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1809) from S8
[S6] cosine check vs S8: cos=0.9982
[S5] RECEIVED delta(kind=head bytes=1794) from S15
[S5] cosine check vs S15: cos=-0.0664
[S5] DROPPED delta from S15 (cos=-0.0664 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1801) from S16
[S5] cosine check vs S16: cos=0.9944
[S9] sending update (kind=head size=1803 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1803) from S9
[S8] cosine check vs S9: cos=0.9691
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=41 metric=0.8531 head_norm=1.838627
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.326236e-02
[S3] stored merged vector for next round verification (round=41)
[S3] DEBUG after merge:  round=41 metric=0.8527 head_norm=1.842712 delta_norm=0.013262
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=41 metric=0.9082 head_norm=1.752893
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.209780e-01
[S15] stored merged vector for next round verification (round=41)
[S15] DEBUG after merge:  round=41 metric=0.9126 head_norm=1.751471 delta_norm=0.120978
[S15] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=41 metric=0.9929 head_norm=1.849360
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.059911e-01
[S8] stored merged vector for next round verification (round=41)
[S8] DEBUG after merge:  round=41 metric=0.9933 head_norm=1.821905 delta_norm=0.105991
[S8] aggregate: ACCEPT kept=['S6', 'S9'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=41 metric=0.7265 head_norm=1.627477
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.808228e-02
[S5] stored merged vector for next round verification (round=41)
[S5] DEBUG after merge:  round=41 metric=0.7265 head_norm=1.641378 delta_norm=0.088082
[S5] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=42 head_norm_before_train=1.758391 cos_to_last_merge=0.9953 (last merge round=35)
[S2] round=42 local utility u=0.327463 metrics={'f1_val': 0.7917233164231201, 'auprc': 0.8861480696740449, 'loss_val': 0.44345649000869264, 'psi': 0.8294932177234899}-{'f1_val': 0.7153486375039823, 'auprc': 0.857619663090708, 'loss_val': 0.5545483702073619, 'psi': 0.7722570477386725}
[S3] START round=42 head_norm_before_train=1.842712 cos_to_last_merge=1.0000 (last merge round=41)
[S3] round=42 local utility u=0.362486 metrics={'f1_val': 0.9289569552068274, 'auprc': 0.9992370977604872, 'loss_val': 0.1353212413435412, 'psi': 0.9570690122282913}-{'f1_val': 0.8531074545323292, 'auprc': 0.9712516576513885, 'loss_val': 0.32124003384066047, 'psi': 0.9003651357799529}
[S4] START round=42 head_norm_before_train=1.972071 cos_to_last_merge=1.0000 (last merge round=41)
[S4] round=42 local utility u=0.008621 metrics={'f1_val': 0.9395282695446932, 'auprc': 0.9824874584952736, 'loss_val': 0.29866445246039425, 'psi': 0.9567119451249253}-{'f1_val': 0.9419106455732802, 'auprc': 0.9732395020508722, 'loss_val': 0.3024561235257107, 'psi': 0.9544421881643169}
[S5] START round=42 head_norm_before_train=1.641378 cos_to_last_merge=1.0000 (last merge round=41)
[S5] round=42 local utility u=1.000000 metrics={'f1_val': 0.9950692622166739, 'auprc': 0.9961399396348923, 'loss_val': 0.13687434920908353, 'psi': 0.9954975331839613}-{'f1_val': 0.726546258100091, 'auprc': 0.8563066474714256, 'loss_val': 0.35172077721474165, 'psi': 0.7784504138486248}
[S6] START round=42 head_norm_before_train=1.811279 cos_to_last_merge=0.9999 (last merge round=40)
[S6] round=42 local utility u=0.000000 metrics={'f1_val': 0.6153016900567905, 'auprc': 0.8034946027986944, 'loss_val': 0.9308810696666058, 'psi': 0.6905788551535521}-{'f1_val': 0.8896840789471504, 'auprc': 0.961472871009025, 'loss_val': 0.21061153051273362, 'psi': 0.9183995957719002}
[S7] START round=42 head_norm_before_train=1.488499 cos_to_last_merge=0.7867 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.787
[S7] round=42 local utility u=0.262453 metrics={'f1_val': 0.6582695235696001, 'auprc': 0.822613051877971, 'loss_val': 0.4312445850189015, 'psi': 0.7240069348929485}-{'f1_val': 0.6129194375623197, 'auprc': 0.7985949130272503, 'loss_val': 0.6119949623429074, 'psi': 0.687189627748292}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=42 head_norm_before_train=1.821905 cos_to_last_merge=1.0000 (last merge round=41)
[S8] round=42 local utility u=0.000000 metrics={'f1_val': 0.9867984609811391, 'auprc': 0.9991314334052952, 'loss_val': 0.053827140762790986, 'psi': 0.9917316499508015}-{'f1_val': 0.9929024225986427, 'auprc': 0.9991683901348554, 'loss_val': 0.036471590159773956, 'psi': 0.9954088096131277}
[S9] START round=42 head_norm_before_train=1.825907 cos_to_last_merge=0.9613 (last merge round=27)
[S9] round=42 local utility u=0.001738 metrics={'f1_val': 0.9959957888192151, 'auprc': 0.9967957510644172, 'loss_val': 0.032011473473054324, 'psi': 0.9963157737172958}-{'f1_val': 0.99518968612894, 'auprc': 0.9984677224699392, 'loss_val': 0.03566731459160996, 'psi': 0.9965009006653397}
[S10] START round=42 head_norm_before_train=1.833742 cos_to_last_merge=0.9999 (last merge round=39)
[S10] round=42 local utility u=0.000211 metrics={'f1_val': 0.9951633020469546, 'auprc': 0.998297295240206, 'loss_val': 0.027294173841906327, 'psi': 0.9964168993242551}-{'f1_val': 0.9951633020469546, 'auprc': 0.998330816698285, 'loss_val': 0.0278160571849434, 'psi': 0.9964303079074868}
[S11] START round=42 head_norm_before_train=1.972071 cos_to_last_merge=1.0000 (last merge round=41)
[S11] round=42 local utility u=0.000000 metrics={'f1_val': 0.9962850284706224, 'auprc': 0.9981162290553864, 'loss_val': 0.028756256539121856, 'psi': 0.9970175087045281}-{'f1_val': 0.996305167468861, 'auprc': 0.9986363118108302, 'loss_val': 0.02898788091717907, 'psi': 0.9972376252056487}
[S13] START round=42 head_norm_before_train=1.794944 cos_to_last_merge=1.0000 (last merge round=39)
[S13] round=42 local utility u=0.000000 metrics={'f1_val': 0.6733909499757171, 'auprc': 0.8075382224241894, 'loss_val': 1.0318089715703596, 'psi': 0.727049858955106}-{'f1_val': 0.7021359443878665, 'auprc': 0.7780607464845283, 'loss_val': 0.8182344331673689, 'psi': 0.7325058652265313}
[S14] START round=42 head_norm_before_train=2.100397 (no previous merge yet)
[S14] round=42 local utility u=0.000607 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.9992096425097401, 'loss_val': 0.018115438043930905, 'psi': 0.9983755677842271}-{'f1_val': 0.9974082695017256, 'auprc': 0.9992067247426085, 'loss_val': 0.01685240495983349, 'psi': 0.9981276515980788}
[S15] START round=42 head_norm_before_train=1.751471 cos_to_last_merge=1.0000 (last merge round=41)
[S15] round=42 local utility u=0.000000 metrics={'f1_val': 0.9071388986036634, 'auprc': 0.9955855995384197, 'loss_val': 0.16363244166341778, 'psi': 0.9425175789775659}-{'f1_val': 0.9082420499863019, 'auprc': 0.9881161883316453, 'loss_val': 0.13476708653138408, 'psi': 0.9401917053244392}
[S16] START round=42 head_norm_before_train=1.659843 cos_to_last_merge=0.9602 (last merge round=27)
[S16] round=42 local utility u=0.000000 metrics={'f1_val': 0.9312954478168054, 'auprc': 0.9936007366097757, 'loss_val': 0.29748092702815015, 'psi': 0.9562175633339935}-{'f1_val': 0.9710543741457444, 'auprc': 0.9930484736855238, 'loss_val': 0.10828045702885412, 'psi': 0.9798520139616561}
[S17] START round=42 head_norm_before_train=1.846882 cos_to_last_merge=0.9999 (last merge round=40)
[S17] round=42 local utility u=0.000000 metrics={'f1_val': 0.6576853352675558, 'auprc': 0.9470523769917325, 'loss_val': 1.1708166606632775, 'psi': 0.7734321519572265}-{'f1_val': 0.8897655512888345, 'auprc': 0.9162424619207359, 'loss_val': 0.5008096242731331, 'psi': 0.9003563155415951}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:49312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:49316
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S10] → sending delta(kind=head bytes=1806) to S13@127.0.0.1:49313
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.829)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] → sending delta(kind=head bytes=1805) to S15@127.0.0.1:49315
[S10] sending update (kind=head size=1806 to 1 peers)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=42 metric=0.6153 head_norm=1.828649
[S6] _apply_head_vector_avg (torch): Δ‖w‖=6.260109e-02
[S6] stored merged vector for next round verification (round=42)
[S6] DEBUG after merge:  round=42 metric=0.6152 head_norm=1.837968 delta_norm=0.062601
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=42 metric=0.6734 head_norm=1.803545
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.465288e-02
[S13] stored merged vector for next round verification (round=42)
[S13] DEBUG after merge:  round=42 metric=0.6688 head_norm=1.818539 delta_norm=0.024653
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1797) from S14
[S16] cosine check vs S14: cos=-0.1006
[S16] DROPPED delta from S14 (cos=-0.1006 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1798) from S4
[S11] cosine check vs S4: cos=0.9999
[S13] RECEIVED delta(kind=head bytes=1806) from S10
[S13] cosine check vs S10: cos=0.9999
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1805 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:49308
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] RECEIVED delta(kind=head bytes=1805) from S5
[S15] cosine check vs S5: cos=-0.0598
[S15] DROPPED delta from S5 (cos=-0.0598 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:49309
[S3] sending update (kind=head size=1795 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1795) from S3
[S7] cosine check vs S3: cos=0.2931
[S9] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1801) from S9
[S8] cosine check vs S9: cos=0.9795
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=42 metric=0.9868 head_norm=1.840491
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.863521e-01
[S8] stored merged vector for next round verification (round=42)
[S8] DEBUG after merge:  round=42 metric=0.9875 head_norm=1.829422 delta_norm=0.186352
[S8] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=43 head_norm_before_train=1.772745 cos_to_last_merge=0.9944 (last merge round=35)
[S2] round=43 local utility u=0.000000 metrics={'f1_val': 0.8322677521758771, 'auprc': 0.8178643091470059, 'loss_val': 0.5337505949060449, 'psi': 0.8265063749643287}-{'f1_val': 0.7917233164231201, 'auprc': 0.8861480696740449, 'loss_val': 0.44345649000869264, 'psi': 0.8294932177234899}
[S3] START round=43 head_norm_before_train=1.853167 cos_to_last_merge=1.0000 (last merge round=41)
[S3] round=43 local utility u=0.000000 metrics={'f1_val': 0.8702248601323944, 'auprc': 0.9758166659649894, 'loss_val': 0.252002981509161, 'psi': 0.9124615824654324}-{'f1_val': 0.9289569552068274, 'auprc': 0.9992370977604872, 'loss_val': 0.1353212413435412, 'psi': 0.9570690122282913}
[S4] START round=43 head_norm_before_train=1.978940 cos_to_last_merge=1.0000 (last merge round=41)
[S4] round=43 local utility u=0.000000 metrics={'f1_val': 0.9320398871074431, 'auprc': 0.9604033429718288, 'loss_val': 0.3533458580516213, 'psi': 0.9433852694531975}-{'f1_val': 0.9395282695446932, 'auprc': 0.9824874584952736, 'loss_val': 0.29866445246039425, 'psi': 0.9567119451249253}
[S5] START round=43 head_norm_before_train=1.652228 cos_to_last_merge=0.9999 (last merge round=41)
[S5] round=43 local utility u=0.000000 metrics={'f1_val': 0.7217000934719954, 'auprc': 0.8546119643490196, 'loss_val': 0.36688680214411057, 'psi': 0.774864841822805}-{'f1_val': 0.9950692622166739, 'auprc': 0.9961399396348923, 'loss_val': 0.13687434920908353, 'psi': 0.9954975331839613}
[S6] START round=43 head_norm_before_train=1.837968 cos_to_last_merge=1.0000 (last merge round=42)
[S6] round=43 local utility u=0.418698 metrics={'f1_val': 0.6546635537078626, 'auprc': 0.9092289839843353, 'loss_val': 0.6468598174629535, 'psi': 0.7564897258184518}-{'f1_val': 0.6153016900567905, 'auprc': 0.8034946027986944, 'loss_val': 0.9308810696666058, 'psi': 0.6905788551535521}
[S7] START round=43 head_norm_before_train=1.493556 cos_to_last_merge=0.7860 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.786
[S7] round=43 local utility u=0.000000 metrics={'f1_val': 0.5179921099462026, 'auprc': 0.7818362307828859, 'loss_val': 0.8290494344440206, 'psi': 0.6235297582808759}-{'f1_val': 0.6582695235696001, 'auprc': 0.822613051877971, 'loss_val': 0.4312445850189015, 'psi': 0.7240069348929485}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=43 metric=0.5180 head_norm=1.499360
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.006408e+00
[S7] stored merged vector for next round verification (round=43)
[S7] DEBUG after merge:  round=43 metric=0.5107 head_norm=1.352145 delta_norm=1.006408
[S7] aggregate: ROLLBACK (f1_val pre=0.518 post=0.511 tol_abs=0.005 tol_rel=0.0)
[S8] START round=43 head_norm_before_train=1.829422 cos_to_last_merge=1.0000 (last merge round=42)
[S8] round=43 local utility u=0.007605 metrics={'f1_val': 0.9939009886418481, 'auprc': 0.990740272560751, 'loss_val': 0.05605821464625824, 'psi': 0.9926367022094092}-{'f1_val': 0.9867984609811391, 'auprc': 0.9991314334052952, 'loss_val': 0.053827140762790986, 'psi': 0.9917316499508015}
[S9] START round=43 head_norm_before_train=1.837286 cos_to_last_merge=0.9601 (last merge round=27)
[S9] round=43 local utility u=0.001060 metrics={'f1_val': 0.9955763922175147, 'auprc': 0.9984698634852742, 'loss_val': 0.03239827900530565, 'psi': 0.9967337807246185}-{'f1_val': 0.9959957888192151, 'auprc': 0.9967957510644172, 'loss_val': 0.032011473473054324, 'psi': 0.9963157737172958}
[S10] START round=43 head_norm_before_train=1.849506 cos_to_last_merge=0.9997 (last merge round=39)
[S10] round=43 local utility u=0.000204 metrics={'f1_val': 0.9951633020469546, 'auprc': 0.9982961649478752, 'loss_val': 0.02688200759608115, 'psi': 0.9964164472073228}-{'f1_val': 0.9951633020469546, 'auprc': 0.998297295240206, 'loss_val': 0.027294173841906327, 'psi': 0.9964168993242551}
[S11] START round=43 head_norm_before_train=1.985425 cos_to_last_merge=1.0000 (last merge round=41)
[S11] round=43 local utility u=0.000000 metrics={'f1_val': 0.9963061018870393, 'auprc': 0.9985349940017139, 'loss_val': 0.03248787695417637, 'psi': 0.9971976587329092}-{'f1_val': 0.9962850284706224, 'auprc': 0.9981162290553864, 'loss_val': 0.028756256539121856, 'psi': 0.9970175087045281}
[S13] START round=43 head_norm_before_train=1.818539 cos_to_last_merge=1.0000 (last merge round=42)
[S13] round=43 local utility u=0.000000 metrics={'f1_val': 0.6177235067454225, 'auprc': 0.7372218273126598, 'loss_val': 1.1257773422067368, 'psi': 0.6655228349723175}-{'f1_val': 0.6733909499757171, 'auprc': 0.8075382224241894, 'loss_val': 1.0318089715703596, 'psi': 0.727049858955106}
[S14] START round=43 head_norm_before_train=2.103488 (no previous merge yet)
[S14] round=43 local utility u=0.000062 metrics={'f1_val': 0.9977998904431125, 'auprc': 0.9992035717155597, 'loss_val': 0.01785449927571186, 'psi': 0.9983613629520913}-{'f1_val': 0.9978195179672185, 'auprc': 0.9992096425097401, 'loss_val': 0.018115438043930905, 'psi': 0.9983755677842271}
[S15] START round=43 head_norm_before_train=1.770895 cos_to_last_merge=1.0000 (last merge round=41)
[S15] round=43 local utility u=0.331905 metrics={'f1_val': 0.9963164379542544, 'auprc': 0.9954004189902208, 'loss_val': 0.03433275078279325, 'psi': 0.995950030368641}-{'f1_val': 0.9071388986036634, 'auprc': 0.9955855995384197, 'loss_val': 0.16363244166341778, 'psi': 0.9425175789775659}
[S16] START round=43 head_norm_before_train=1.672938 cos_to_last_merge=0.9589 (last merge round=27)
[S16] round=43 local utility u=0.190226 metrics={'f1_val': 0.9657197466279098, 'auprc': 0.9931770311178432, 'loss_val': 0.12230279824845515, 'psi': 0.9767026604238831}-{'f1_val': 0.9312954478168054, 'auprc': 0.9936007366097757, 'loss_val': 0.29748092702815015, 'psi': 0.9562175633339935}
[S17] START round=43 head_norm_before_train=1.870545 cos_to_last_merge=0.9998 (last merge round=40)
[S17] round=43 local utility u=0.136823 metrics={'f1_val': 0.6774341751329365, 'auprc': 0.9685060912361492, 'loss_val': 1.0800252858376225, 'psi': 0.7938629415742215}-{'f1_val': 0.6576853352675558, 'auprc': 0.9470523769917325, 'loss_val': 1.1708166606632775, 'psi': 0.7734321519572265}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:49303
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:49309
[S14] not sending this round → trigger blocked (psi=0.998)
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=43 metric=0.9963 head_norm=1.997310
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.760510e-02
[S11] stored merged vector for next round verification (round=43)
[S11] DEBUG after merge:  round=43 metric=0.9963 head_norm=1.988068 delta_norm=0.017605
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1799 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=43 metric=0.6177 head_norm=1.833467
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.173257e-02
[S13] stored merged vector for next round verification (round=43)
[S13] DEBUG after merge:  round=43 metric=0.6178 head_norm=1.841376 delta_norm=0.021733
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S17] sending update (kind=head size=1799 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1799) from S17
[S3] cosine check vs S17: cos=0.9996
[S8] RECEIVED delta(kind=head bytes=1799) from S6
[S8] cosine check vs S6: cos=0.9856
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S8] → sending delta(kind=head bytes=1807) to S6@127.0.0.1:49307
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:49305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:49305
[S9] not sending this round → trigger blocked (psi=0.997)
[S8] sending update (kind=head size=1807 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1793 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1793) from S16
[S5] cosine check vs S16: cos=0.9973
[S6] RECEIVED delta(kind=head bytes=1807) from S8
[S6] cosine check vs S8: cos=0.9856
[S5] RECEIVED delta(kind=head bytes=1801) from S15
[S5] cosine check vs S15: cos=-0.0604
[S5] DROPPED delta from S15 (cos=-0.0604 < 0.0)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=43 metric=0.8702 head_norm=1.862899
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.117181e-02
[S3] stored merged vector for next round verification (round=43)
[S3] DEBUG after merge:  round=43 metric=0.8702 head_norm=1.878150 delta_norm=0.031172
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=43 metric=0.9939 head_norm=1.848081
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.572489e-01
[S8] stored merged vector for next round verification (round=43)
[S8] DEBUG after merge:  round=43 metric=0.9936 head_norm=1.844380 delta_norm=0.157249
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=43 metric=0.7217 head_norm=1.662060
[S5] _apply_head_vector_avg (torch): Δ‖w‖=6.260515e-02
[S5] stored merged vector for next round verification (round=43)
[S5] DEBUG after merge:  round=43 metric=0.7206 head_norm=1.672861 delta_norm=0.062605
[S5] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=44 head_norm_before_train=1.790375 cos_to_last_merge=0.9935 (last merge round=35)
[S2] round=44 local utility u=0.000000 metrics={'f1_val': 0.7098614416250821, 'auprc': 0.977829545581711, 'loss_val': 0.5190043818329891, 'psi': 0.8170486832077337}-{'f1_val': 0.8322677521758771, 'auprc': 0.8178643091470059, 'loss_val': 0.5337505949060449, 'psi': 0.8265063749643287}
[S3] START round=44 head_norm_before_train=1.878150 cos_to_last_merge=1.0000 (last merge round=43)
[S3] round=44 local utility u=0.153099 metrics={'f1_val': 0.8979046657024106, 'auprc': 0.9972241254042475, 'loss_val': 0.17610689562477058, 'psi': 0.9376324495831454}-{'f1_val': 0.8702248601323944, 'auprc': 0.9758166659649894, 'loss_val': 0.252002981509161, 'psi': 0.9124615824654324}
[S4] START round=44 head_norm_before_train=1.981969 cos_to_last_merge=0.9998 (last merge round=41)
[S4] round=44 local utility u=0.120039 metrics={'f1_val': 0.9511053427025822, 'auprc': 0.9807925837336647, 'loss_val': 0.28882806957979223, 'psi': 0.9629802391150152}-{'f1_val': 0.9320398871074431, 'auprc': 0.9604033429718288, 'loss_val': 0.3533458580516213, 'psi': 0.9433852694531975}
[S5] START round=44 head_norm_before_train=1.672861 cos_to_last_merge=1.0000 (last merge round=43)
[S5] round=44 local utility u=1.000000 metrics={'f1_val': 0.9822929993417515, 'auprc': 0.9976224785296999, 'loss_val': 0.12583030387133232, 'psi': 0.9884247910169309}-{'f1_val': 0.7217000934719954, 'auprc': 0.8546119643490196, 'loss_val': 0.36688680214411057, 'psi': 0.774864841822805}
[S6] START round=44 head_norm_before_train=1.854056 cos_to_last_merge=0.9999 (last merge round=42)
[S6] round=44 local utility u=0.605460 metrics={'f1_val': 0.829620507654388, 'auprc': 0.8862200974642629, 'loss_val': 0.41665423958010156, 'psi': 0.852260343578338}-{'f1_val': 0.6546635537078626, 'auprc': 0.9092289839843353, 'loss_val': 0.6468598174629535, 'psi': 0.7564897258184518}
[S7] START round=44 head_norm_before_train=1.352145 cos_to_last_merge=1.0000 (last merge round=43)
[S7] round=44 local utility u=0.000000 metrics={'f1_val': 0.5008493344677859, 'auprc': 0.7809104194529504, 'loss_val': 0.818826711355943, 'psi': 0.6128737684618517}-{'f1_val': 0.5179921099462026, 'auprc': 0.7818362307828859, 'loss_val': 0.8290494344440206, 'psi': 0.6235297582808759}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=44 head_norm_before_train=1.844380 cos_to_last_merge=1.0000 (last merge round=43)
[S8] round=44 local utility u=0.004367 metrics={'f1_val': 0.9892968853633592, 'auprc': 0.9990692863978126, 'loss_val': 0.0446864108648357, 'psi': 0.9932058457771406}-{'f1_val': 0.9939009886418481, 'auprc': 0.990740272560751, 'loss_val': 0.05605821464625824, 'psi': 0.9926367022094092}
[S9] START round=44 head_norm_before_train=1.848733 cos_to_last_merge=0.9588 (last merge round=27)
[S9] round=44 local utility u=0.001122 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9962099251961072, 'loss_val': 0.029879065173011757, 'psi': 0.9964802771667778}-{'f1_val': 0.9955763922175147, 'auprc': 0.9984698634852742, 'loss_val': 0.03239827900530565, 'psi': 0.9967337807246185}
[S10] START round=44 head_norm_before_train=1.864843 cos_to_last_merge=0.9995 (last merge round=39)
[S10] round=44 local utility u=0.000186 metrics={'f1_val': 0.9951633020469546, 'auprc': 0.9983240263240961, 'loss_val': 0.026594288138842535, 'psi': 0.9964275917578111}-{'f1_val': 0.9951633020469546, 'auprc': 0.9982961649478752, 'loss_val': 0.02688200759608115, 'psi': 0.9964164472073228}
[S11] START round=44 head_norm_before_train=1.988068 cos_to_last_merge=1.0000 (last merge round=43)
[S11] round=44 local utility u=0.001574 metrics={'f1_val': 0.9962850284706224, 'auprc': 0.9980364398969415, 'loss_val': 0.027716973045576448, 'psi': 0.9969855930411501}-{'f1_val': 0.9963061018870393, 'auprc': 0.9985349940017139, 'loss_val': 0.03248787695417637, 'psi': 0.9971976587329092}
[S13] START round=44 head_norm_before_train=1.841376 cos_to_last_merge=1.0000 (last merge round=43)
[S13] round=44 local utility u=0.414510 metrics={'f1_val': 0.7096871200994963, 'auprc': 0.8020458917180052, 'loss_val': 1.0430113092938171, 'psi': 0.7466306287468999}-{'f1_val': 0.6177235067454225, 'auprc': 0.7372218273126598, 'loss_val': 1.1257773422067368, 'psi': 0.6655228349723175}
[S14] START round=44 head_norm_before_train=2.109719 (no previous merge yet)
[S14] round=44 local utility u=0.000000 metrics={'f1_val': 0.9973862616479148, 'auprc': 0.9991836656215533, 'loss_val': 0.021768468244919185, 'psi': 0.9981052232373702}-{'f1_val': 0.9977998904431125, 'auprc': 0.9992035717155597, 'loss_val': 0.01785449927571186, 'psi': 0.9983613629520913}
[S15] START round=44 head_norm_before_train=1.789611 cos_to_last_merge=0.9998 (last merge round=41)
[S15] round=44 local utility u=0.000000 metrics={'f1_val': 0.7689586921150723, 'auprc': 0.9902647961807093, 'loss_val': 0.39504130063193454, 'psi': 0.8574811337413271}-{'f1_val': 0.9963164379542544, 'auprc': 0.9954004189902208, 'loss_val': 0.03433275078279325, 'psi': 0.995950030368641}
[S16] START round=44 head_norm_before_train=1.685918 cos_to_last_merge=0.9576 (last merge round=27)
[S16] round=44 local utility u=0.106096 metrics={'f1_val': 0.9902693697038939, 'auprc': 0.9938934101152386, 'loss_val': 0.05955756695788954, 'psi': 0.9917189858684318}-{'f1_val': 0.9657197466279098, 'auprc': 0.9931770311178432, 'loss_val': 0.12230279824845515, 'psi': 0.9767026604238831}
[S17] START round=44 head_norm_before_train=1.893791 cos_to_last_merge=0.9996 (last merge round=40)
[S17] round=44 local utility u=0.869622 metrics={'f1_val': 0.8927924618936665, 'auprc': 0.9206800435670304, 'loss_val': 0.48945252643162346, 'psi': 0.903947494563012}-{'f1_val': 0.6774341751329365, 'auprc': 0.9685060912361492, 'loss_val': 1.0800252858376225, 'psi': 0.7938629415742215}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:49303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:49311
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:49309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:49304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:49313
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:49312
[S10] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:49315
[S17] sending update (kind=head size=1796 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] RECEIVED delta(kind=head bytes=1802) from S6
[S8] cosine check vs S6: cos=0.9962
[S4] RECEIVED delta(kind=head bytes=1799) from S11
[S4] cosine check vs S11: cos=0.9996
[S10] RECEIVED delta(kind=head bytes=1798) from S13
[S10] cosine check vs S13: cos=0.9997
[S3] RECEIVED delta(kind=head bytes=1796) from S17
[S3] cosine check vs S17: cos=0.9997
[S13] RECEIVED delta(kind=head bytes=1799) from S10
[S13] cosine check vs S10: cos=0.9997
[S11] RECEIVED delta(kind=head bytes=1796) from S4
[S11] cosine check vs S4: cos=0.9996
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:49308
[S5] sending update (kind=head size=1804 to 1 peers)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=44 metric=0.7097 head_norm=1.850637
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.609297e-02
[S13] stored merged vector for next round verification (round=44)
[S13] DEBUG after merge:  round=44 metric=0.7140 head_norm=1.863959 delta_norm=0.026093
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=44 metric=0.8296 head_norm=1.868140
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.636920e-01
[S6] stored merged vector for next round verification (round=44)
[S6] DEBUG after merge:  round=44 metric=0.8316 head_norm=1.850913 delta_norm=0.163692
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=44 metric=0.9963 head_norm=1.997451
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.779162e-02
[S11] stored merged vector for next round verification (round=44)
[S11] DEBUG after merge:  round=44 metric=0.9963 head_norm=1.989148 delta_norm=0.027792
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:49307
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=44 metric=0.9511 head_norm=1.981199
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.779160e-02
[S4] stored merged vector for next round verification (round=44)
[S4] DEBUG after merge:  round=44 metric=0.9511 head_norm=1.989148 delta_norm=0.027792
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=44 metric=0.9952 head_norm=1.877548
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.609296e-02
[S10] stored merged vector for next round verification (round=44)
[S10] DEBUG after merge:  round=44 metric=0.9952 head_norm=1.863959 delta_norm=0.026093
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:49305
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] RECEIVED delta(kind=head bytes=1804) from S5
[S15] cosine check vs S5: cos=-0.0607
[S15] DROPPED delta from S5 (cos=-0.0607 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S9] → sending delta(kind=head bytes=1806) to S8@127.0.0.1:49309
[S16] sending update (kind=head size=1794 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1794) from S16
[S5] cosine check vs S16: cos=0.9990
[S6] RECEIVED delta(kind=head bytes=1802) from S8
[S6] cosine check vs S8: cos=0.9999
[S7] RECEIVED delta(kind=head bytes=1797) from S3
[S7] cosine check vs S3: cos=0.8425
[S9] sending update (kind=head size=1806 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1806) from S9
[S8] cosine check vs S9: cos=0.9797
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=44 metric=0.8979 head_norm=1.887618
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.903438e-02
[S3] stored merged vector for next round verification (round=44)
[S3] DEBUG after merge:  round=44 metric=0.8958 head_norm=1.903191 delta_norm=0.029034
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=44 metric=0.9893 head_norm=1.864007
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.793041e-02
[S8] stored merged vector for next round verification (round=44)
[S8] DEBUG after merge:  round=44 metric=0.9893 head_norm=1.853481 delta_norm=0.057930
[S8] aggregate: ACCEPT kept=['S6', 'S9'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=44 metric=0.9823 head_norm=1.681247
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.967929e-02
[S5] stored merged vector for next round verification (round=44)
[S5] DEBUG after merge:  round=44 metric=0.9819 head_norm=1.689611 delta_norm=0.039679
[S5] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=45 head_norm_before_train=1.805357 cos_to_last_merge=0.9927 (last merge round=35)
[S2] round=45 local utility u=0.000000 metrics={'f1_val': 0.6754099354233989, 'auprc': 0.7907128040135518, 'loss_val': 0.7923325944423552, 'psi': 0.7215310828594601}-{'f1_val': 0.7098614416250821, 'auprc': 0.977829545581711, 'loss_val': 0.5190043818329891, 'psi': 0.8170486832077337}
[S3] START round=45 head_norm_before_train=1.903191 cos_to_last_merge=1.0000 (last merge round=44)
[S3] round=45 local utility u=0.000000 metrics={'f1_val': 0.7257922874844459, 'auprc': 0.9648080683155368, 'loss_val': 0.6162670650107199, 'psi': 0.8213985998168822}-{'f1_val': 0.8979046657024106, 'auprc': 0.9972241254042475, 'loss_val': 0.17610689562477058, 'psi': 0.9376324495831454}
[S4] START round=45 head_norm_before_train=1.989148 cos_to_last_merge=1.0000 (last merge round=44)
[S4] round=45 local utility u=0.000000 metrics={'f1_val': 0.9336618138571472, 'auprc': 0.9716168688703183, 'loss_val': 0.35543133763994295, 'psi': 0.9488438358624156}-{'f1_val': 0.9511053427025822, 'auprc': 0.9807925837336647, 'loss_val': 0.28882806957979223, 'psi': 0.9629802391150152}
[S5] START round=45 head_norm_before_train=1.689611 cos_to_last_merge=1.0000 (last merge round=44)
[S5] round=45 local utility u=0.000000 metrics={'f1_val': 0.8842657249432496, 'auprc': 0.9925280115756673, 'loss_val': 0.16929050392163347, 'psi': 0.9275706395962167}-{'f1_val': 0.9822929993417515, 'auprc': 0.9976224785296999, 'loss_val': 0.12583030387133232, 'psi': 0.9884247910169309}
[S6] START round=45 head_norm_before_train=1.850913 cos_to_last_merge=1.0000 (last merge round=44)
[S6] round=45 local utility u=0.000000 metrics={'f1_val': 0.6610356927381105, 'auprc': 0.8494522014116084, 'loss_val': 0.5332440648080186, 'psi': 0.7364022962075096}-{'f1_val': 0.829620507654388, 'auprc': 0.8862200974642629, 'loss_val': 0.41665423958010156, 'psi': 0.852260343578338}
[S7] START round=45 head_norm_before_train=1.359782 cos_to_last_merge=1.0000 (last merge round=43)
[S7] round=45 local utility u=0.741656 metrics={'f1_val': 0.6647057505697418, 'auprc': 0.8232245798917004, 'loss_val': 0.4455960971534107, 'psi': 0.7281132822985252}-{'f1_val': 0.5008493344677859, 'auprc': 0.7809104194529504, 'loss_val': 0.818826711355943, 'psi': 0.6128737684618517}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=45 metric=0.6647 head_norm=1.370044
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.247145e-01
[S7] stored merged vector for next round verification (round=45)
[S7] DEBUG after merge:  round=45 metric=0.6626 head_norm=1.563565 delta_norm=0.524715
[S7] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S8] START round=45 head_norm_before_train=1.853481 cos_to_last_merge=1.0000 (last merge round=44)
[S8] round=45 local utility u=0.000000 metrics={'f1_val': 0.7996314616321718, 'auprc': 0.9967312442431115, 'loss_val': 0.436180947260515, 'psi': 0.8784713746765477}-{'f1_val': 0.9892968853633592, 'auprc': 0.9990692863978126, 'loss_val': 0.0446864108648357, 'psi': 0.9932058457771406}
[S9] START round=45 head_norm_before_train=1.859118 cos_to_last_merge=0.9577 (last merge round=27)
[S9] round=45 local utility u=0.003527 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9982700890702064, 'loss_val': 0.02900493970581025, 'psi': 0.9973043427164174}-{'f1_val': 0.9966605118138915, 'auprc': 0.9962099251961072, 'loss_val': 0.029879065173011757, 'psi': 0.9964802771667778}
[S10] START round=45 head_norm_before_train=1.863959 cos_to_last_merge=1.0000 (last merge round=44)
[S10] round=45 local utility u=0.000000 metrics={'f1_val': 0.9951633020469546, 'auprc': 0.9982663321403572, 'loss_val': 0.02708248053770424, 'psi': 0.9964045140843156}-{'f1_val': 0.9951633020469546, 'auprc': 0.9983240263240961, 'loss_val': 0.026594288138842535, 'psi': 0.9964275917578111}
[S11] START round=45 head_norm_before_train=1.989148 cos_to_last_merge=1.0000 (last merge round=44)
[S11] round=45 local utility u=0.000000 metrics={'f1_val': 0.9963061018870393, 'auprc': 0.9985523321064792, 'loss_val': 0.02966634800571495, 'psi': 0.9972045939748153}-{'f1_val': 0.9962850284706224, 'auprc': 0.9980364398969415, 'loss_val': 0.027716973045576448, 'psi': 0.9969855930411501}
[S13] START round=45 head_norm_before_train=1.863959 cos_to_last_merge=1.0000 (last merge round=44)
[S13] round=45 local utility u=0.242319 metrics={'f1_val': 0.7434341208050541, 'auprc': 0.8124516255636328, 'loss_val': 0.7920721315358312, 'psi': 0.7710411227084856}-{'f1_val': 0.7096871200994963, 'auprc': 0.8020458917180052, 'loss_val': 1.0430113092938171, 'psi': 0.7466306287468999}
[S14] START round=45 head_norm_before_train=2.114494 (no previous merge yet)
[S14] round=45 local utility u=0.000691 metrics={'f1_val': 0.9970007132142444, 'auprc': 0.9992056714940268, 'loss_val': 0.018139783998765126, 'psi': 0.9978826965261574}-{'f1_val': 0.9973862616479148, 'auprc': 0.9991836656215533, 'loss_val': 0.021768468244919185, 'psi': 0.9981052232373702}
[S15] START round=45 head_norm_before_train=1.807507 cos_to_last_merge=0.9996 (last merge round=41)
[S15] round=45 local utility u=0.822349 metrics={'f1_val': 0.98323355982948, 'auprc': 0.9948449941347229, 'loss_val': 0.04973397838860446, 'psi': 0.9878781335515772}-{'f1_val': 0.7689586921150723, 'auprc': 0.9902647961807093, 'loss_val': 0.39504130063193454, 'psi': 0.8574811337413271}
[S16] START round=45 head_norm_before_train=1.698861 cos_to_last_merge=0.9562 (last merge round=27)
[S16] round=45 local utility u=0.000674 metrics={'f1_val': 0.9902890583210591, 'auprc': 0.993444080020413, 'loss_val': 0.056980662057728365, 'psi': 0.9915510670008006}-{'f1_val': 0.9902693697038939, 'auprc': 0.9938934101152386, 'loss_val': 0.05955756695788954, 'psi': 0.9917189858684318}
[S17] START round=45 head_norm_before_train=1.919077 cos_to_last_merge=0.9992 (last merge round=40)
[S17] round=45 local utility u=0.000000 metrics={'f1_val': 0.8817743008172594, 'auprc': 0.8900358977872835, 'loss_val': 0.5501131749943653, 'psi': 0.8850789396052691}-{'f1_val': 0.8927924618936665, 'auprc': 0.9206800435670304, 'loss_val': 0.48945252643162346, 'psi': 0.903947494563012}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:49311
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:49316
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1801 to 1 peers)
[S10] ⇄ pheromone p=0.001 → S13@127.0.0.1:49313
[S11] ⇄ pheromone p=0.002 → S4@127.0.0.1:49304
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1796 to 1 peers)
[S17] ⇄ pheromone p=0.258 → S3@127.0.0.1:49303
[S4] ⇄ pheromone p=0.030 → S11@127.0.0.1:49312
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=45 metric=0.6610 head_norm=1.864490
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.957525e-02
[S6] stored merged vector for next round verification (round=45)
[S6] DEBUG after merge:  round=45 metric=0.6618 head_norm=1.864146 delta_norm=0.019575
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.299 → S8@127.0.0.1:49309
[S16] RECEIVED delta(kind=head bytes=1801) from S14
[S16] cosine check vs S14: cos=-0.1020
[S16] DROPPED delta from S14 (cos=-0.1020 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1796) from S13
[S10] cosine check vs S13: cos=1.0000
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:49305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:49305
[S13] ⇄ pheromone p=0.189 → S10@127.0.0.1:49311
[S14] ⇄ pheromone p=0.005 → S16@127.0.0.1:49316
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1798) from S15
[S5] cosine check vs S15: cos=-0.0609
[S5] DROPPED delta from S15 (cos=-0.0609 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1800) from S16
[S5] cosine check vs S16: cos=0.9996
[S3] ⇄ pheromone p=0.135 → S7@127.0.0.1:49308
[S16] ⇄ pheromone p=0.064 → S5@127.0.0.1:49305
[S15] ⇄ pheromone p=0.280 → S5@127.0.0.1:49305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:49309
[S9] sending update (kind=head size=1799 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1799) from S9
[S8] cosine check vs S9: cos=0.9841
[S9] ⇄ pheromone p=0.004 → S8@127.0.0.1:49309
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=45 metric=0.8843 head_norm=1.695220
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.679651e-02
[S5] stored merged vector for next round verification (round=45)
[S5] DEBUG after merge:  round=45 metric=0.8713 head_norm=1.703138 delta_norm=0.026797
[S5] aggregate: ROLLBACK (f1_val pre=0.884 post=0.871 tol_abs=0.005 tol_rel=0.0)
[S5] ⇄ pheromone p=0.365 → S15@127.0.0.1:49315
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=45 metric=0.7996 head_norm=1.866847
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.665221e-01
[S8] stored merged vector for next round verification (round=45)
[S8] DEBUG after merge:  round=45 metric=0.8046 head_norm=1.859734 delta_norm=0.166522
[S8] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.010 → S6@127.0.0.1:49307
[S2] ⇄ pheromone p=0.061 → S15@127.0.0.1:49315
[S2] START round=46 head_norm_before_train=1.816922 cos_to_last_merge=0.9921 (last merge round=35)
[S2] round=46 local utility u=0.391838 metrics={'f1_val': 0.7091871838220243, 'auprc': 0.912085070358446, 'loss_val': 0.5754368774781581, 'psi': 0.790346338436593}-{'f1_val': 0.6754099354233989, 'auprc': 0.7907128040135518, 'loss_val': 0.7923325944423552, 'psi': 0.7215310828594601}
[S3] START round=46 head_norm_before_train=1.910921 cos_to_last_merge=1.0000 (last merge round=44)
[S3] round=46 local utility u=0.814738 metrics={'f1_val': 0.9073130701494951, 'auprc': 0.9989764141978416, 'loss_val': 0.1784212661828042, 'psi': 0.9439784077688337}-{'f1_val': 0.7257922874844459, 'auprc': 0.9648080683155368, 'loss_val': 0.6162670650107199, 'psi': 0.8213985998168822}
[S4] START round=46 head_norm_before_train=1.988969 cos_to_last_merge=0.9999 (last merge round=44)
[S4] round=46 local utility u=0.007333 metrics={'f1_val': 0.935256065156421, 'auprc': 0.9650306965392045, 'loss_val': 0.3305731611468136, 'psi': 0.9471659177095344}-{'f1_val': 0.9336618138571472, 'auprc': 0.9716168688703183, 'loss_val': 0.35543133763994295, 'psi': 0.9488438358624156}
[S5] START round=46 head_norm_before_train=1.703138 cos_to_last_merge=1.0000 (last merge round=45)
[S5] round=46 local utility u=0.338422 metrics={'f1_val': 0.9897524026488342, 'auprc': 0.9940017169235233, 'loss_val': 0.12978694011245692, 'psi': 0.9914521283587099}-{'f1_val': 0.8842657249432496, 'auprc': 0.9925280115756673, 'loss_val': 0.16929050392163347, 'psi': 0.9275706395962167}
[S6] START round=46 head_norm_before_train=1.864146 cos_to_last_merge=1.0000 (last merge round=45)
[S6] round=46 local utility u=1.000000 metrics={'f1_val': 0.9858399179755101, 'auprc': 0.9903666162355542, 'loss_val': 0.1369624167419135, 'psi': 0.9876505972795278}-{'f1_val': 0.6610356927381105, 'auprc': 0.8494522014116084, 'loss_val': 0.5332440648080186, 'psi': 0.7364022962075096}
[S7] START round=46 head_norm_before_train=1.563565 cos_to_last_merge=1.0000 (last merge round=45)
[S7] round=46 local utility u=0.000000 metrics={'f1_val': 0.5904882479449505, 'auprc': 0.7803240870078634, 'loss_val': 0.7117965483202825, 'psi': 0.6664225835701156}-{'f1_val': 0.6647057505697418, 'auprc': 0.8232245798917004, 'loss_val': 0.4455960971534107, 'psi': 0.7281132822985252}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=46 head_norm_before_train=1.859734 cos_to_last_merge=1.0000 (last merge round=45)
[S8] round=46 local utility u=0.000000 metrics={'f1_val': 0.7140170479737811, 'auprc': 0.9594592759481753, 'loss_val': 0.6022295323112085, 'psi': 0.8121939391635388}-{'f1_val': 0.7996314616321718, 'auprc': 0.9967312442431115, 'loss_val': 0.436180947260515, 'psi': 0.8784713746765477}
[S9] START round=46 head_norm_before_train=1.867502 cos_to_last_merge=0.9569 (last merge round=27)
[S9] round=46 local utility u=0.000000 metrics={'f1_val': 0.9943271883459407, 'auprc': 0.9984676242269974, 'loss_val': 0.03163942806953038, 'psi': 0.9959833626983634}-{'f1_val': 0.9966605118138915, 'auprc': 0.9982700890702064, 'loss_val': 0.02900493970581025, 'psi': 0.9973043427164174}
[S10] START round=46 head_norm_before_train=1.877558 cos_to_last_merge=1.0000 (last merge round=44)
[S10] round=46 local utility u=0.000125 metrics={'f1_val': 0.9951633020469546, 'auprc': 0.9982651083861076, 'loss_val': 0.026828161421145417, 'psi': 0.9964040245826158}-{'f1_val': 0.9951633020469546, 'auprc': 0.9982663321403572, 'loss_val': 0.02708248053770424, 'psi': 0.9964045140843156}
[S11] START round=46 head_norm_before_train=1.998590 cos_to_last_merge=1.0000 (last merge round=44)
[S11] round=46 local utility u=0.001540 metrics={'f1_val': 0.996305167468861, 'auprc': 0.998590708781072, 'loss_val': 0.02669555056178476, 'psi': 0.9972193839937453}-{'f1_val': 0.9963061018870393, 'auprc': 0.9985523321064792, 'loss_val': 0.02966634800571495, 'psi': 0.9972045939748153}
[S13] START round=46 head_norm_before_train=1.871021 cos_to_last_merge=1.0000 (last merge round=44)
[S13] round=46 local utility u=0.038620 metrics={'f1_val': 0.7539217626297001, 'auprc': 0.8180971108317947, 'loss_val': 0.7946946456713976, 'psi': 0.779591901910538}-{'f1_val': 0.7434341208050541, 'auprc': 0.8124516255636328, 'loss_val': 0.7920721315358312, 'psi': 0.7710411227084856}
[S14] START round=46 head_norm_before_train=2.114893 (no previous merge yet)
[S14] round=46 local utility u=0.001003 metrics={'f1_val': 0.9973891252095638, 'auprc': 0.9992138541831996, 'loss_val': 0.018488800158578712, 'psi': 0.9981190167990182}-{'f1_val': 0.9970007132142444, 'auprc': 0.9992056714940268, 'loss_val': 0.018139783998765126, 'psi': 0.9978826965261574}
[S15] START round=46 head_norm_before_train=1.824539 cos_to_last_merge=0.9994 (last merge round=41)
[S15] round=46 local utility u=0.000000 metrics={'f1_val': 0.9823715167448872, 'auprc': 0.9923878369189661, 'loss_val': 0.04969316612654218, 'psi': 0.9863780448145187}-{'f1_val': 0.98323355982948, 'auprc': 0.9948449941347229, 'loss_val': 0.04973397838860446, 'psi': 0.9878781335515772}
[S16] START round=46 head_norm_before_train=1.711440 cos_to_last_merge=0.9547 (last merge round=27)
[S16] round=46 local utility u=0.000000 metrics={'f1_val': 0.9397021332190546, 'auprc': 0.9925598128111384, 'loss_val': 0.18458047426522406, 'psi': 0.9608452050558881}-{'f1_val': 0.9902890583210591, 'auprc': 0.993444080020413, 'loss_val': 0.056980662057728365, 'psi': 0.9915510670008006}
[S17] START round=46 head_norm_before_train=1.937450 cos_to_last_merge=0.9990 (last merge round=40)
[S17] round=46 local utility u=0.000000 metrics={'f1_val': 0.7974827376240813, 'auprc': 0.8737378828137228, 'loss_val': 0.8555722546739964, 'psi': 0.8279847956999379}-{'f1_val': 0.8817743008172594, 'auprc': 0.8900358977872835, 'loss_val': 0.5501131749943653, 'psi': 0.8850789396052691}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] → sending delta(kind=head bytes=1793) to S4@127.0.0.1:49304
[S14] not sending this round → trigger blocked (psi=0.998)
[S13] not sending this round → trigger blocked (psi=0.780)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:49312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:49309
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:49313
[S6] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S2] → sending delta(kind=head bytes=1789) to S15@127.0.0.1:49315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:49315
[S11] sending update (kind=head size=1793 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1793) from S11
[S4] cosine check vs S11: cos=0.9998
[S8] RECEIVED delta(kind=head bytes=1802) from S6
[S8] cosine check vs S6: cos=0.9928
[S13] RECEIVED delta(kind=head bytes=1796) from S10
[S13] cosine check vs S10: cos=0.9999
[S11] RECEIVED delta(kind=head bytes=1799) from S4
[S11] cosine check vs S4: cos=0.9998
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=46 metric=0.9353 head_norm=1.996984
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.076616e-02
[S4] stored merged vector for next round verification (round=46)
[S4] DEBUG after merge:  round=46 metric=0.9353 head_norm=2.002246 delta_norm=0.020766
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=46 metric=0.9952 head_norm=1.891367
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.627981e-02
[S10] stored merged vector for next round verification (round=46)
[S10] DEBUG after merge:  round=46 metric=0.9952 head_norm=1.881151 delta_norm=0.016280
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] sending update (kind=head size=1789 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:49308
[S5] sending update (kind=head size=1799 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=46 metric=0.9963 head_norm=2.007708
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.076617e-02
[S11] stored merged vector for next round verification (round=46)
[S11] DEBUG after merge:  round=46 metric=0.9963 head_norm=2.002246 delta_norm=0.020766
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] RECEIVED delta(kind=head bytes=1799) from S5
[S15] cosine check vs S5: cos=-0.0616
[S15] DROPPED delta from S5 (cos=-0.0616 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1789) from S2
[S15] cosine check vs S2: cos=0.9913
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1800 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1800) from S3
[S7] cosine check vs S3: cos=0.9655
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=46 metric=0.9824 head_norm=1.840649
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.212896e-01
[S15] stored merged vector for next round verification (round=46)
[S15] DEBUG after merge:  round=46 metric=0.9832 head_norm=1.829939 delta_norm=0.121290
[S15] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=46 metric=0.7140 head_norm=1.876540
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.127330e-01
[S8] stored merged vector for next round verification (round=46)
[S8] DEBUG after merge:  round=46 metric=0.7140 head_norm=1.875574 delta_norm=0.112733
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=47 head_norm_before_train=1.827235 cos_to_last_merge=0.9914 (last merge round=35)
[S2] round=47 local utility u=0.120089 metrics={'f1_val': 0.7094031291722422, 'auprc': 0.9818296542765608, 'loss_val': 0.5457880017062225, 'psi': 0.8183737392139696}-{'f1_val': 0.7091871838220243, 'auprc': 0.912085070358446, 'loss_val': 0.5754368774781581, 'psi': 0.790346338436593}
[S3] START round=47 head_norm_before_train=1.919118 cos_to_last_merge=1.0000 (last merge round=44)
[S3] round=47 local utility u=0.000000 metrics={'f1_val': 0.7491837901718099, 'auprc': 0.9493125385351984, 'loss_val': 0.5982196122117343, 'psi': 0.8292352895171653}-{'f1_val': 0.9073130701494951, 'auprc': 0.9989764141978416, 'loss_val': 0.1784212661828042, 'psi': 0.9439784077688337}
[S4] START round=47 head_norm_before_train=2.002246 cos_to_last_merge=1.0000 (last merge round=46)
[S4] round=47 local utility u=0.089289 metrics={'f1_val': 0.9539941353224214, 'auprc': 0.9769424142237096, 'loss_val': 0.30015922776066195, 'psi': 0.9631734468829367}-{'f1_val': 0.935256065156421, 'auprc': 0.9650306965392045, 'loss_val': 0.3305731611468136, 'psi': 0.9471659177095344}
[S5] START round=47 head_norm_before_train=1.712271 cos_to_last_merge=1.0000 (last merge round=45)
[S5] round=47 local utility u=0.036402 metrics={'f1_val': 0.9945791217938664, 'auprc': 0.9976099326737206, 'loss_val': 0.09676844314407364, 'psi': 0.9957914461458081}-{'f1_val': 0.9897524026488342, 'auprc': 0.9940017169235233, 'loss_val': 0.12978694011245692, 'psi': 0.9914521283587099}
[S6] START round=47 head_norm_before_train=1.881375 cos_to_last_merge=0.9998 (last merge round=45)
[S6] round=47 local utility u=0.000000 metrics={'f1_val': 0.6711288300634601, 'auprc': 0.8165930435800722, 'loss_val': 0.6761643450944025, 'psi': 0.729314515470105}-{'f1_val': 0.9858399179755101, 'auprc': 0.9903666162355542, 'loss_val': 0.1369624167419135, 'psi': 0.9876505972795278}
[S7] START round=47 head_norm_before_train=1.579122 cos_to_last_merge=0.9997 (last merge round=45)
[S7] round=47 local utility u=0.306443 metrics={'f1_val': 0.6542225024453894, 'auprc': 0.7992132624038303, 'loss_val': 0.5379842181827452, 'psi': 0.7122188064287658}-{'f1_val': 0.5904882479449505, 'auprc': 0.7803240870078634, 'loss_val': 0.7117965483202825, 'psi': 0.6664225835701156}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=47 metric=0.6542 head_norm=1.603404
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.986560e-01
[S7] stored merged vector for next round verification (round=47)
[S7] DEBUG after merge:  round=47 metric=0.6485 head_norm=1.742918 delta_norm=0.298656
[S7] aggregate: ROLLBACK (f1_val pre=0.654 post=0.648 tol_abs=0.005 tol_rel=0.0)
[S8] START round=47 head_norm_before_train=1.875574 cos_to_last_merge=1.0000 (last merge round=46)
[S8] round=47 local utility u=0.980586 metrics={'f1_val': 0.9459636230048394, 'auprc': 0.9989344725123026, 'loss_val': 0.15116270005469887, 'psi': 0.9671519628078247}-{'f1_val': 0.7140170479737811, 'auprc': 0.9594592759481753, 'loss_val': 0.6022295323112085, 'psi': 0.8121939391635388}
[S9] START round=47 head_norm_before_train=1.873915 cos_to_last_merge=0.9563 (last merge round=27)
[S9] round=47 local utility u=0.006751 metrics={'f1_val': 0.9959957888192151, 'auprc': 0.9984710107742033, 'loss_val': 0.028159107273468608, 'psi': 0.9969858776012104}-{'f1_val': 0.9943271883459407, 'auprc': 0.9984676242269974, 'loss_val': 0.03163942806953038, 'psi': 0.9959833626983634}
[S10] START round=47 head_norm_before_train=1.881151 cos_to_last_merge=1.0000 (last merge round=46)
[S10] round=47 local utility u=0.000149 metrics={'f1_val': 0.9951633020469546, 'auprc': 0.9983068988830849, 'loss_val': 0.026655646369662805, 'psi': 0.9964207407814067}-{'f1_val': 0.9951633020469546, 'auprc': 0.9982651083861076, 'loss_val': 0.026828161421145417, 'psi': 0.9964040245826158}
[S11] START round=47 head_norm_before_train=2.002246 cos_to_last_merge=1.0000 (last merge round=46)
[S11] round=47 local utility u=0.000000 metrics={'f1_val': 0.9962850284706224, 'auprc': 0.9976861882094464, 'loss_val': 0.027130173455421062, 'psi': 0.996845492366152}-{'f1_val': 0.996305167468861, 'auprc': 0.998590708781072, 'loss_val': 0.02669555056178476, 'psi': 0.9972193839937453}
[S13] START round=47 head_norm_before_train=1.874329 cos_to_last_merge=1.0000 (last merge round=44)
[S13] round=47 local utility u=0.000000 metrics={'f1_val': 0.7076320997556163, 'auprc': 0.8210244106548891, 'loss_val': 1.0765267851701328, 'psi': 0.7529890241153254}-{'f1_val': 0.7539217626297001, 'auprc': 0.8180971108317947, 'loss_val': 0.7946946456713976, 'psi': 0.779591901910538}
[S14] START round=47 head_norm_before_train=2.114599 (no previous merge yet)
[S14] round=47 local utility u=0.000000 metrics={'f1_val': 0.9973891252095638, 'auprc': 0.9992197211521665, 'loss_val': 0.019679156206600396, 'psi': 0.9981213635866049}-{'f1_val': 0.9973891252095638, 'auprc': 0.9992138541831996, 'loss_val': 0.018488800158578712, 'psi': 0.9981190167990182}
[S15] START round=47 head_norm_before_train=1.829939 cos_to_last_merge=1.0000 (last merge round=46)
[S15] round=47 local utility u=0.052551 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9930872839216518, 'loss_val': 0.03294119247137758, 'psi': 0.995282914601173}-{'f1_val': 0.9823715167448872, 'auprc': 0.9923878369189661, 'loss_val': 0.04969316612654218, 'psi': 0.9863780448145187}
[S16] START round=47 head_norm_before_train=1.722923 cos_to_last_merge=0.9535 (last merge round=27)
[S16] round=47 local utility u=0.207651 metrics={'f1_val': 0.9885194590323894, 'auprc': 0.9922966426354896, 'loss_val': 0.06139382345294705, 'psi': 0.9900303324736294}-{'f1_val': 0.9397021332190546, 'auprc': 0.9925598128111384, 'loss_val': 0.18458047426522406, 'psi': 0.9608452050558881}
[S17] START round=47 head_norm_before_train=1.953714 cos_to_last_merge=0.9988 (last merge round=40)
[S17] round=47 local utility u=0.000000 metrics={'f1_val': 0.7062873964902121, 'auprc': 0.9195631242974114, 'loss_val': 1.1317423663822095, 'psi': 0.7915976876130919}-{'f1_val': 0.7974827376240813, 'auprc': 0.8737378828137228, 'loss_val': 0.8555722546739964, 'psi': 0.8279847956999379}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.963)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=47 metric=0.7076 head_norm=1.877700
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.892920e-02
[S13] stored merged vector for next round verification (round=47)
[S13] DEBUG after merge:  round=47 metric=0.7030 head_norm=1.884451 delta_norm=0.018929
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] not sending this round → trigger blocked (psi=0.818)
[S5] not sending this round → trigger blocked (psi=0.996)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:49305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:49307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:49305
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1804 to 1 peers)
[S16] sending update (kind=head size=1803 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1800) from S15
[S5] cosine check vs S15: cos=-0.0558
[S5] DROPPED delta from S15 (cos=-0.0558 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1803) from S16
[S5] cosine check vs S16: cos=0.9995
[S6] RECEIVED delta(kind=head bytes=1804) from S8
[S6] cosine check vs S8: cos=0.9979
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:49309
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=47 metric=0.9946 head_norm=1.720673
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.887595e-02
[S5] stored merged vector for next round verification (round=47)
[S5] DEBUG after merge:  round=47 metric=0.9946 head_norm=1.727438 delta_norm=0.028876
[S5] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S9] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1801) from S9
[S8] cosine check vs S9: cos=0.9869
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=47 metric=0.9460 head_norm=1.888706
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.528219e-01
[S8] stored merged vector for next round verification (round=47)
[S8] DEBUG after merge:  round=47 metric=0.9552 head_norm=1.878283 delta_norm=0.152822
[S8] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=48 head_norm_before_train=1.835461 cos_to_last_merge=0.9908 (last merge round=35)
[S2] round=48 local utility u=0.000000 metrics={'f1_val': 0.781392253846614, 'auprc': 0.8460846231628326, 'loss_val': 0.5717041760666387, 'psi': 0.8072692015731016}-{'f1_val': 0.7094031291722422, 'auprc': 0.9818296542765608, 'loss_val': 0.5457880017062225, 'psi': 0.8183737392139696}
[S3] START round=48 head_norm_before_train=1.928026 cos_to_last_merge=0.9999 (last merge round=44)
[S3] round=48 local utility u=1.000000 metrics={'f1_val': 0.9901388380740588, 'auprc': 0.9989787149054818, 'loss_val': 0.03740365709577681, 'psi': 0.993674788806628}-{'f1_val': 0.7491837901718099, 'auprc': 0.9493125385351984, 'loss_val': 0.5982196122117343, 'psi': 0.8292352895171653}
[S4] START round=48 head_norm_before_train=2.011505 cos_to_last_merge=1.0000 (last merge round=46)
[S4] round=48 local utility u=0.000000 metrics={'f1_val': 0.9272213345268603, 'auprc': 0.9508647310267386, 'loss_val': 0.35187738711747524, 'psi': 0.9366786931268116}-{'f1_val': 0.9539941353224214, 'auprc': 0.9769424142237096, 'loss_val': 0.30015922776066195, 'psi': 0.9631734468829367}
[S5] START round=48 head_norm_before_train=1.727438 cos_to_last_merge=1.0000 (last merge round=47)
[S5] round=48 local utility u=0.000000 metrics={'f1_val': 0.7262528000253811, 'auprc': 0.9762245819633685, 'loss_val': 0.2831429654806247, 'psi': 0.826241512800576}-{'f1_val': 0.9945791217938664, 'auprc': 0.9976099326737206, 'loss_val': 0.09676844314407364, 'psi': 0.9957914461458081}
[S6] START round=48 head_norm_before_train=1.894808 cos_to_last_merge=0.9996 (last merge round=45)
[S6] round=48 local utility u=1.000000 metrics={'f1_val': 0.9507529700107693, 'auprc': 0.9650308245296977, 'loss_val': 0.19962408502802736, 'psi': 0.9564641118183406}-{'f1_val': 0.6711288300634601, 'auprc': 0.8165930435800722, 'loss_val': 0.6761643450944025, 'psi': 0.729314515470105}
[S7] START round=48 head_norm_before_train=1.742918 cos_to_last_merge=1.0000 (last merge round=47)
[S7] round=48 local utility u=0.017121 metrics={'f1_val': 0.6627702434404656, 'auprc': 0.7943778000277393, 'loss_val': 0.5405214241561302, 'psi': 0.7154132660753751}-{'f1_val': 0.6542225024453894, 'auprc': 0.7992132624038303, 'loss_val': 0.5379842181827452, 'psi': 0.7122188064287658}
[S7] not sending this round → trigger blocked (psi=0.715)
[S8] START round=48 head_norm_before_train=1.878283 cos_to_last_merge=1.0000 (last merge round=47)
[S8] round=48 local utility u=0.180800 metrics={'f1_val': 0.9942226369520374, 'auprc': 0.9888252367715662, 'loss_val': 0.04878858358220487, 'psi': 0.992063676879849}-{'f1_val': 0.9459636230048394, 'auprc': 0.9989344725123026, 'loss_val': 0.15116270005469887, 'psi': 0.9671519628078247}
[S9] START round=48 head_norm_before_train=1.880263 cos_to_last_merge=0.9557 (last merge round=27)
[S9] round=48 local utility u=0.000000 metrics={'f1_val': 0.993909773892786, 'auprc': 0.998469141211427, 'loss_val': 0.0312182428131046, 'psi': 0.9957335208202425}-{'f1_val': 0.9959957888192151, 'auprc': 0.9984710107742033, 'loss_val': 0.028159107273468608, 'psi': 0.9969858776012104}
[S10] START round=48 head_norm_before_train=1.894589 cos_to_last_merge=1.0000 (last merge round=46)
[S10] round=48 local utility u=0.000175 metrics={'f1_val': 0.9951633020469546, 'auprc': 0.9983016585362116, 'loss_val': 0.026289820623761156, 'psi': 0.9964186446426573}-{'f1_val': 0.9951633020469546, 'auprc': 0.9983068988830849, 'loss_val': 0.026655646369662805, 'psi': 0.9964207407814067}
[S11] START round=48 head_norm_before_train=2.010260 cos_to_last_merge=1.0000 (last merge round=46)
[S11] round=48 local utility u=0.001175 metrics={'f1_val': 0.9962850284706224, 'auprc': 0.9981344465157937, 'loss_val': 0.026125849831179403, 'psi': 0.997024795688691}-{'f1_val': 0.9962850284706224, 'auprc': 0.9976861882094464, 'loss_val': 0.027130173455421062, 'psi': 0.996845492366152}
[S13] START round=48 head_norm_before_train=1.884451 cos_to_last_merge=1.0000 (last merge round=47)
[S13] round=48 local utility u=0.000000 metrics={'f1_val': 0.6406638429784924, 'auprc': 0.8154843354586745, 'loss_val': 1.1021245630957688, 'psi': 0.7105920399705652}-{'f1_val': 0.7076320997556163, 'auprc': 0.8210244106548891, 'loss_val': 1.0765267851701328, 'psi': 0.7529890241153254}
[S14] START round=48 head_norm_before_train=2.116372 (no previous merge yet)
[S14] round=48 local utility u=0.000562 metrics={'f1_val': 0.9973891252095638, 'auprc': 0.9992167363459854, 'loss_val': 0.018545886372860913, 'psi': 0.9981201696641324}-{'f1_val': 0.9973891252095638, 'auprc': 0.9992197211521665, 'loss_val': 0.019679156206600396, 'psi': 0.9981213635866049}
[S15] START round=48 head_norm_before_train=1.846100 cos_to_last_merge=1.0000 (last merge round=46)
[S15] round=48 local utility u=0.000000 metrics={'f1_val': 0.8101322245588066, 'auprc': 0.9921105251656015, 'loss_val': 0.3549954976994672, 'psi': 0.8829235448015246}-{'f1_val': 0.9967466683875206, 'auprc': 0.9930872839216518, 'loss_val': 0.03294119247137758, 'psi': 0.995282914601173}
[S16] START round=48 head_norm_before_train=1.734658 cos_to_last_merge=0.9522 (last merge round=27)
[S16] round=48 local utility u=0.010761 metrics={'f1_val': 0.990436917169137, 'auprc': 0.9931512193832133, 'loss_val': 0.05393938158957381, 'psi': 0.9915226380547675}-{'f1_val': 0.9885194590323894, 'auprc': 0.9922966426354896, 'loss_val': 0.06139382345294705, 'psi': 0.9900303324736294}
[S17] START round=48 head_norm_before_train=1.967292 cos_to_last_merge=0.9986 (last merge round=40)
[S17] round=48 local utility u=0.910656 metrics={'f1_val': 0.8866570131615694, 'auprc': 0.9633940430705862, 'loss_val': 0.5241406992613178, 'psi': 0.9173518251251761}-{'f1_val': 0.7062873964902121, 'auprc': 0.9195631242974114, 'loss_val': 1.1317423663822095, 'psi': 0.7915976876130919}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S17] → sending delta(kind=head bytes=1792) to S3@127.0.0.1:49303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:49309
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:49304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:49316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:49313
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1799 to 1 peers)
[S17] sending update (kind=head size=1792 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1795 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1796 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1796) from S10
[S13] cosine check vs S10: cos=0.9999
[S3] RECEIVED delta(kind=head bytes=1792) from S17
[S3] cosine check vs S17: cos=0.9993
[S4] RECEIVED delta(kind=head bytes=1797) from S11
[S4] cosine check vs S11: cos=0.9998
[S16] RECEIVED delta(kind=head bytes=1795) from S14
[S16] cosine check vs S14: cos=-0.1037
[S16] DROPPED delta from S14 (cos=-0.1037 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1799) from S6
[S8] cosine check vs S6: cos=0.9896
[S8] not sending this round → trigger blocked (psi=0.992)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=48 metric=0.9508 head_norm=1.909367
[S6] _apply_head_vector_avg (torch): Δ‖w‖=6.961089e-02
[S6] stored merged vector for next round verification (round=48)
[S6] DEBUG after merge:  round=48 metric=0.9475 head_norm=1.897788 delta_norm=0.069611
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:49308
[S16] not sending this round → trigger blocked (psi=0.992)
[S3] sending update (kind=head size=1796 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1796) from S3
[S7] cosine check vs S3: cos=0.9870
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=48 metric=0.9901 head_norm=1.935111
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.056181e-02
[S3] stored merged vector for next round verification (round=48)
[S3] DEBUG after merge:  round=48 metric=0.9901 head_norm=1.954631 delta_norm=0.040562
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=48 metric=0.9942 head_norm=1.893061
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.373506e-01
[S8] stored merged vector for next round verification (round=48)
[S8] DEBUG after merge:  round=48 metric=0.9942 head_norm=1.896264 delta_norm=0.137351
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=49 head_norm_before_train=1.844635 cos_to_last_merge=0.9902 (last merge round=35)
[S2] round=49 local utility u=0.276373 metrics={'f1_val': 0.8203312243638022, 'auprc': 0.9105858603926533, 'loss_val': 0.4460954857832467, 'psi': 0.8564330787753427}-{'f1_val': 0.781392253846614, 'auprc': 0.8460846231628326, 'loss_val': 0.5717041760666387, 'psi': 0.8072692015731016}
[S3] START round=49 head_norm_before_train=1.954631 cos_to_last_merge=1.0000 (last merge round=48)
[S3] round=49 local utility u=0.000000 metrics={'f1_val': 0.940733752271347, 'auprc': 0.9786231618223968, 'loss_val': 0.16882100128645824, 'psi': 0.9558895160917669}-{'f1_val': 0.9901388380740588, 'auprc': 0.9989787149054818, 'loss_val': 0.03740365709577681, 'psi': 0.993674788806628}
[S4] START round=49 head_norm_before_train=2.016590 cos_to_last_merge=0.9999 (last merge round=46)
[S4] round=49 local utility u=0.101807 metrics={'f1_val': 0.9375110294668004, 'auprc': 0.979824203818257, 'loss_val': 0.2968806488171556, 'psi': 0.954436299207383}-{'f1_val': 0.9272213345268603, 'auprc': 0.9508647310267386, 'loss_val': 0.35187738711747524, 'psi': 0.9366786931268116}
[S5] START round=49 head_norm_before_train=1.732681 cos_to_last_merge=1.0000 (last merge round=47)
[S5] round=49 local utility u=0.939046 metrics={'f1_val': 0.9964787901401435, 'auprc': 0.995104125313644, 'loss_val': 0.08304530949640412, 'psi': 0.9959289242095437}-{'f1_val': 0.7262528000253811, 'auprc': 0.9762245819633685, 'loss_val': 0.2831429654806247, 'psi': 0.826241512800576}
[S6] START round=49 head_norm_before_train=1.897788 cos_to_last_merge=1.0000 (last merge round=48)
[S6] round=49 local utility u=0.000000 metrics={'f1_val': 0.4756671083464279, 'auprc': 0.7511138856818562, 'loss_val': 1.196185304075856, 'psi': 0.5858458192805992}-{'f1_val': 0.9507529700107693, 'auprc': 0.9650308245296977, 'loss_val': 0.19962408502802736, 'psi': 0.9564641118183406}
[S7] START round=49 head_norm_before_train=1.763973 cos_to_last_merge=0.9994 (last merge round=47)
[S7] round=49 local utility u=0.000000 metrics={'f1_val': 0.377322844486566, 'auprc': 0.5106663238819728, 'loss_val': 1.408490309461256, 'psi': 0.4306602362447287}-{'f1_val': 0.6627702434404656, 'auprc': 0.7943778000277393, 'loss_val': 0.5405214241561302, 'psi': 0.7154132660753751}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=49 metric=0.3773 head_norm=1.782040
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.879562e-01
[S7] stored merged vector for next round verification (round=49)
[S7] DEBUG after merge:  round=49 metric=0.3773 head_norm=1.850631 delta_norm=0.187956
[S7] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S8] START round=49 head_norm_before_train=1.896264 cos_to_last_merge=1.0000 (last merge round=48)
[S8] round=49 local utility u=0.004001 metrics={'f1_val': 0.9896558900940475, 'auprc': 0.9991817059626816, 'loss_val': 0.044455553763685096, 'psi': 0.9934662164415012}-{'f1_val': 0.9942226369520374, 'auprc': 0.9888252367715662, 'loss_val': 0.04878858358220487, 'psi': 0.992063676879849}
[S9] START round=49 head_norm_before_train=1.887029 cos_to_last_merge=0.9549 (last merge round=27)
[S9] round=49 local utility u=0.008153 metrics={'f1_val': 0.9960207019771873, 'auprc': 0.998469158258154, 'loss_val': 0.027577933430467556, 'psi': 0.9970000844895739}-{'f1_val': 0.993909773892786, 'auprc': 0.998469141211427, 'loss_val': 0.0312182428131046, 'psi': 0.9957335208202425}
[S10] START round=49 head_norm_before_train=1.906143 cos_to_last_merge=0.9999 (last merge round=46)
[S10] round=49 local utility u=0.000000 metrics={'f1_val': 0.9951633020469546, 'auprc': 0.9982793116646015, 'loss_val': 0.026321312236478624, 'psi': 0.9964097058940133}-{'f1_val': 0.9951633020469546, 'auprc': 0.9983016585362116, 'loss_val': 0.026289820623761156, 'psi': 0.9964186446426573}
[S11] START round=49 head_norm_before_train=2.018997 cos_to_last_merge=1.0000 (last merge round=46)
[S11] round=49 local utility u=0.001748 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9983445225632462, 'loss_val': 0.0248319573965438, 'psi': 0.9972660117334522}-{'f1_val': 0.9962850284706224, 'auprc': 0.9981344465157937, 'loss_val': 0.026125849831179403, 'psi': 0.997024795688691}
[S13] START round=49 head_norm_before_train=1.895825 cos_to_last_merge=1.0000 (last merge round=47)
[S13] round=49 local utility u=0.439902 metrics={'f1_val': 0.7440374092193428, 'auprc': 0.8215296042876702, 'loss_val': 0.8606986098834396, 'psi': 0.7750342872466738}-{'f1_val': 0.6406638429784924, 'auprc': 0.8154843354586745, 'loss_val': 1.1021245630957688, 'psi': 0.7105920399705652}
[S14] START round=49 head_norm_before_train=2.121545 (no previous merge yet)
[S14] round=49 local utility u=0.000456 metrics={'f1_val': 0.9973891252095638, 'auprc': 0.9992160140159566, 'loss_val': 0.017631683157924124, 'psi': 0.998119880732121}-{'f1_val': 0.9973891252095638, 'auprc': 0.9992167363459854, 'loss_val': 0.018545886372860913, 'psi': 0.9981201696641324}
[S15] START round=49 head_norm_before_train=1.861830 cos_to_last_merge=0.9999 (last merge round=46)
[S15] round=49 local utility u=0.721315 metrics={'f1_val': 0.9963164379542544, 'auprc': 0.9922604981350392, 'loss_val': 0.02992026778380704, 'psi': 0.9946940620265683}-{'f1_val': 0.8101322245588066, 'auprc': 0.9921105251656015, 'loss_val': 0.3549954976994672, 'psi': 0.8829235448015246}
[S16] START round=49 head_norm_before_train=1.744990 cos_to_last_merge=0.9512 (last merge round=27)
[S16] round=49 local utility u=0.001576 metrics={'f1_val': 0.990436917169137, 'auprc': 0.994086892326928, 'loss_val': 0.0535952948530479, 'psi': 0.9918969072322533}-{'f1_val': 0.990436917169137, 'auprc': 0.9931512193832133, 'loss_val': 0.05393938158957381, 'psi': 0.9915226380547675}
[S17] START round=49 head_norm_before_train=1.974792 cos_to_last_merge=0.9985 (last merge round=40)
[S17] round=49 local utility u=0.000000 metrics={'f1_val': 0.7298937295107986, 'auprc': 0.9468726621127472, 'loss_val': 1.0540352192343019, 'psi': 0.816685302551578}-{'f1_val': 0.8866570131615694, 'auprc': 0.9633940430705862, 'loss_val': 0.5241406992613178, 'psi': 0.9173518251251761}
[S14] not sending this round → trigger blocked (psi=0.998)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:49311
[S11] not sending this round → trigger blocked (psi=0.997)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:49312
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:49315
[S13] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:49315
[S10] RECEIVED delta(kind=head bytes=1799) from S13
[S10] cosine check vs S13: cos=0.9997
[S11] RECEIVED delta(kind=head bytes=1798) from S4
[S11] cosine check vs S4: cos=0.9996
[S5] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:49305
[S2] sending update (kind=head size=1803 to 1 peers)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=49 metric=0.7440 head_norm=1.906200
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.199199e-02
[S13] stored merged vector for next round verification (round=49)
[S13] DEBUG after merge:  round=49 metric=0.7451 head_norm=1.906045 delta_norm=0.021992
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] → sending delta(kind=head bytes=1805) to S5@127.0.0.1:49305
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=49 metric=0.9375 head_norm=2.003990
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.901780e-02
[S4] stored merged vector for next round verification (round=49)
[S4] DEBUG after merge:  round=49 metric=0.9377 head_norm=2.011298 delta_norm=0.029018
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:49307
[S15] RECEIVED delta(kind=head bytes=1803) from S2
[S15] cosine check vs S2: cos=0.9953
[S15] RECEIVED delta(kind=head bytes=1799) from S5
[S15] cosine check vs S5: cos=-0.0572
[S15] DROPPED delta from S5 (cos=-0.0572 < 0.0)
[S8] sending update (kind=head size=1804 to 1 peers)
[S16] sending update (kind=head size=1805 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1804) from S8
[S6] cosine check vs S8: cos=0.9992
[S5] RECEIVED delta(kind=head bytes=1805) from S16
[S5] cosine check vs S16: cos=0.9995
[S5] RECEIVED delta(kind=head bytes=1800) from S15
[S5] cosine check vs S15: cos=-0.0572
[S5] DROPPED delta from S15 (cos=-0.0572 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:49309
[S9] sending update (kind=head size=1803 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1803) from S9
[S8] cosine check vs S9: cos=0.9857
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=49 metric=0.9897 head_norm=1.914102
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.615123e-01
[S8] stored merged vector for next round verification (round=49)
[S8] DEBUG after merge:  round=49 metric=0.9904 head_norm=1.897686 delta_norm=0.161512
[S8] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=49 metric=0.9963 head_norm=1.876900
[S15] _apply_head_vector_avg (torch): Δ‖w‖=9.119149e-02
[S15] stored merged vector for next round verification (round=49)
[S15] DEBUG after merge:  round=49 metric=0.9963 head_norm=1.863603 delta_norm=0.091191
[S15] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=49 metric=0.9965 head_norm=1.738394
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.760504e-02
[S5] stored merged vector for next round verification (round=49)
[S5] DEBUG after merge:  round=49 metric=0.9965 head_norm=1.746183 delta_norm=0.027605
[S5] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[runner] rounds complete.
[runner] all agents stopped.
