[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:58303
[S3] → join 127.0.0.1:58302
[S4] → join 127.0.0.1:58302
[S5] → join 127.0.0.1:58302
[S6] → join 127.0.0.1:58302
[S7] → join 127.0.0.1:58302
[S8] → join 127.0.0.1:58302
[S9] → join 127.0.0.1:58302
[S10] → join 127.0.0.1:58302
[S11] → join 127.0.0.1:58302
[S13] → join 127.0.0.1:58302
[S14] → join 127.0.0.1:58302
[S15] → join 127.0.0.1:58302
[S16] → join 127.0.0.1:58302
[S17] → join 127.0.0.1:58302
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.137370 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.152960 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.191300 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.177270 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.181015 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.175609 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.146146 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.151241 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.157793 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.161590 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.168535 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.140454 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.168592 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.179654 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.160501 (no previous merge yet)
[S14]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S3] + discovered S7
[S4] + discovered S2
[S4] + discovered S3
[S3] + discovered S4
[S3] + discovered S11
[S3] + discovered S5
[S3] + discovered S8
[S3] + discovered S9
[S3] + discovered S15
[S3] + discovered S14
[S3] + discovered S17
[S3] + discovered S16
[S3] + discovered S10
[S3] + discovered S13
[S3] + discovered S6
[S4] + discovered S8
[S4] + discovered S11
[S4] + discovered S5
[S4] + discovered S9
[S4] + discovered S15
[S4] + discovered S14
[S4] + discovered S17
[S4] + discovered S10
[S4] + discovered S16
[S4] + discovered S13
[S4] + discovered S6
[S5] + discovered S4
[S4] + discovered S7
[S5] + discovered S2
[S5] + discovered S3
[S6] + discovered S5
[S6] + discovered S4
[S6] + discovered S3
[S6] + discovered S2
[S5] + discovered S7
[S5] + discovered S14
[S5] + discovered S13
[S5] + discovered S16
[S5] + discovered S17
[S5] + discovered S9
[S5] + discovered S6
[S5] + discovered S10
[S5] + discovered S15
[S5] + discovered S11
[S5] + discovered S8
[S6] + discovered S8
[S6] + discovered S11
[S6] + discovered S10
[S6] + discovered S16
[S6] + discovered S17
[S6] + discovered S14
[S6] + discovered S9
[S6] + discovered S15
[S6] + discovered S7
[S7] + discovered S6
[S6] + discovered S13
[S7] + discovered S5
[S7] + discovered S4
[S7] + discovered S3
[S7] + discovered S2
[S8] + discovered S2
[S8] + discovered S6
[S8] + discovered S3
[S8] + discovered S7
[S8] + discovered S4
[S8] + discovered S5
[S7] + discovered S16
[S7] + discovered S11
[S7] + discovered S13
[S7] + discovered S9
[S7] + discovered S15
[S7] + discovered S14
[S7] + discovered S17
[S7] + discovered S10
[S7] + discovered S8
[S9] + discovered S3
[S9] + discovered S5
[S9] + discovered S4
[S8] + discovered S15
[S9] + discovered S6
[S9] + discovered S8
[S8] + discovered S10
[S8] + discovered S17
[S8] + discovered S9
[S9] + discovered S7
[S8] + discovered S14
[S8] + discovered S13
[S9] + discovered S2
[S8] + discovered S11
[S8] + discovered S16
[S9] + discovered S14
[S10] + discovered S5
[S10] + discovered S2
[S10] + discovered S8
[S10] + discovered S4
[S10] + discovered S7
[S10] + discovered S6
[S10] + discovered S9
[S10] + discovered S3
[S9] + discovered S16
[S9] + discovered S10
[S9] + discovered S13
[S9] + discovered S15
[S9] + discovered S17
[S9] + discovered S11
[S11] + discovered S7
[S11] + discovered S2
[S11] + discovered S3
[S11] + discovered S10
[S11] + discovered S4
[S10] + discovered S17
[S11] + discovered S9
[S10] + discovered S11
[S11] + discovered S6
[S10] + discovered S14
[S10] + discovered S16
[S10] + discovered S13
[S11] + discovered S5
[S10] + discovered S15
[S11] + discovered S8
[S13] + discovered S4
[S13] + discovered S7
[S13] + discovered S3
[S13] + discovered S2
[S13] + discovered S10
[S13] + discovered S11
[S13] + discovered S9
[S13] + discovered S6
[S13] + discovered S5
[S13] + discovered S8
[S11] + discovered S14
[S11] + discovered S16
[S11] + discovered S13
[S11] + discovered S17
[S11] + discovered S15
[S14] + discovered S9
[S14] + discovered S8
[S14] + discovered S2
[S14] + discovered S13
[S14] + discovered S5
[S14] + discovered S6
[S14] + discovered S11
[S14] + discovered S7
[S14] + discovered S3
[S14] + discovered S4
[S14] + discovered S10
[S13] + discovered S14
[S13] + discovered S16
[S13] + discovered S17
[S13] + discovered S15
[S15] + discovered S6
[S15] + discovered S8
[S15] + discovered S9
[S15] + discovered S14
[S15] + discovered S3
[S15] + discovered S10
[S15] + discovered S11
[S15] + discovered S4
[S15] + discovered S7
[S15] + discovered S13
[S15] + discovered S5
[S15] + discovered S2
[S14] + discovered S16
[S14] + discovered S15
[S14] + discovered S17
[S15] + discovered S17
[S15] + discovered S16
[S16] + discovered S4
[S16] + discovered S15
[S16] + discovered S5
[S16] + discovered S7
[S16] + discovered S13
[S16] + discovered S10
[S16] + discovered S11
[S16] + discovered S9
[S16] + discovered S14
[S16] + discovered S8
[S16] + discovered S3
[S16] + discovered S2
[S16] + discovered S6
[S17] + discovered S5
[S17] + discovered S3
[S17] + discovered S2
[S17] + discovered S11
[S17] + discovered S10
[S17] + discovered S7
[S17] + discovered S9
[S17] + discovered S8
[S17] + discovered S14
[S17] + discovered S13
[S17] + discovered S6
[S17] + discovered S15
[S17] + discovered S4
[S16] + discovered S17
[S17] + discovered S16
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] ⇄ pheromone p=1.000 → S11@127.0.0.1:58312
[S13] ⇄ pheromone p=1.000 → S10@127.0.0.1:58311
[S5] ⇄ pheromone p=1.000 → S16@127.0.0.1:58316
[S15] ⇄ pheromone p=1.000 → S5@127.0.0.1:58305
[S14] ⇄ pheromone p=1.000 → S11@127.0.0.1:58312
[S3] ⇄ pheromone p=1.000 → S5@127.0.0.1:58305
[S7] ⇄ pheromone p=1.000 → S14@127.0.0.1:58314
[S16] ⇄ pheromone p=1.000 → S6@127.0.0.1:58307
[S6] ⇄ pheromone p=1.000 → S9@127.0.0.1:58310
[S8] ⇄ pheromone p=1.000 → S7@127.0.0.1:58308
[S2] ⇄ pheromone p=1.000 → S5@127.0.0.1:58305
[S11] ⇄ pheromone p=1.000 → S14@127.0.0.1:58314
[S9] ⇄ pheromone p=1.000 → S6@127.0.0.1:58307
[S10] ⇄ pheromone p=1.000 → S13@127.0.0.1:58313
[S17] ⇄ pheromone p=1.000 → S9@127.0.0.1:58310
[S2] START round=1 head_norm_before_train=1.152700 (no previous merge yet)
[S2] round=1 local utility u=0.028239 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7845146964850445, 'loss_val': 1.2706473248543515, 'psi': 0.39887215862715786}-{'f1_val': 0.1417771333885667, 'auprc': 0.7902260624763185, 'loss_val': 1.3442590150848497, 'psi': 0.40115670502366746}
[S3] START round=1 head_norm_before_train=1.157605 (no previous merge yet)
[S3] round=1 local utility u=1.000000 metrics={'f1_val': 0.4151123481022195, 'auprc': 0.8160412733810761, 'loss_val': 1.3330311680097597, 'psi': 0.5754839182137621}-{'f1_val': 0.10474797479747974, 'auprc': 0.7494973568022832, 'loss_val': 1.35834153901509, 'psi': 0.3626477275994011}
[S4] START round=1 head_norm_before_train=1.193022 (no previous merge yet)
[S4] round=1 local utility u=0.261814 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7775768691856635, 'loss_val': 1.2908086641983458, 'psi': 0.3951667250113759}-{'f1_val': 0.14410480349344978, 'auprc': 0.6157913840321108, 'loss_val': 1.3523499981734355, 'psi': 0.3327794357089142}
[S5] START round=1 head_norm_before_train=1.180127 (no previous merge yet)
[S5] round=1 local utility u=0.027787 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7647684778454005, 'loss_val': 1.3220339787691788, 'psi': 0.3912645339953031}-{'f1_val': 0.14226190476190476, 'auprc': 0.7581157052881645, 'loss_val': 1.357649997975696, 'psi': 0.3886034249724087}
[S6] START round=1 head_norm_before_train=1.194301 (no previous merge yet)
[S6] round=1 local utility u=0.147478 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.939019280079453, 'loss_val': 1.2679635050543017, 'psi': 0.46046348126255043}-{'f1_val': 0.14142628205128205, 'auprc': 0.86111374629361, 'loss_val': 1.3292039005133103, 'psi': 0.42930126774821326}
[S7] START round=1 head_norm_before_train=1.180486 (no previous merge yet)
[S7] round=1 local utility u=0.015680 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.5726379174961, 'loss_val': 1.3205056382706633, 'psi': 0.314289260635895}-{'f1_val': 0.14205682272909165, 'auprc': 0.5721228361710053, 'loss_val': 1.35032132740673, 'psi': 0.31408322810585715}
[S8] START round=1 head_norm_before_train=1.158784 (no previous merge yet)
[S8] round=1 local utility u=0.000000 metrics={'f1_val': 0.19486088453869857, 'auprc': 0.7824684402448149, 'loss_val': 1.2680290311966014, 'psi': 0.4299039068211451}-{'f1_val': 0.6507688771773765, 'auprc': 0.7825769817439109, 'loss_val': 1.3355856000810722, 'psi': 0.7034921190039902}
[S9] START round=1 head_norm_before_train=1.154589 (no previous merge yet)
[S9] round=1 local utility u=0.027401 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8652224217213699, 'loss_val': 1.3144313024160883, 'psi': 0.4309277429725456}-{'f1_val': 0.141397957139996, 'auprc': 0.8594177693263305, 'loss_val': 1.3518187046976249, 'psi': 0.4286058820145298}
[S10] START round=1 head_norm_before_train=1.168673 (no previous merge yet)
[S10] round=1 local utility u=0.042889 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7938222477902468, 'loss_val': 1.2927045875437555, 'psi': 0.4007018816411331}-{'f1_val': 0.13862163754172394, 'auprc': 0.7802536208493918, 'loss_val': 1.337776599947468, 'psi': 0.3952744308647911}
[S11] START round=1 head_norm_before_train=1.162565 (no previous merge yet)
[S11] round=1 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7738059231655839, 'loss_val': 1.3390689045929314, 'psi': 0.39377057929009995}-{'f1_val': 0.4010738380226955, 'auprc': 0.6378647773714353, 'loss_val': 1.3728676777963147, 'psi': 0.4957902137621914}
[S13] START round=1 head_norm_before_train=1.172460 (no previous merge yet)
[S13] round=1 local utility u=1.000000 metrics={'f1_val': 0.40267998267951344, 'auprc': 0.6729396135093425, 'loss_val': 1.2997033975905135, 'psi': 0.5107838350114451}-{'f1_val': 0.09041468388851122, 'auprc': 0.543514117238531, 'loss_val': 1.363453730788332, 'psi': 0.27165445722851916}
[S14] START round=1 head_norm_before_train=1.139165 (no previous merge yet)
[S14] round=1 local utility u=0.574070 metrics={'f1_val': 0.2682962073718376, 'auprc': 0.8082643363969465, 'loss_val': 1.3373854489518662, 'psi': 0.4842834589818812}-{'f1_val': 0.1038107752956636, 'auprc': 0.7616627901370857, 'loss_val': 1.3588086425427415, 'psi': 0.3669515812322325}
[S15] START round=1 head_norm_before_train=1.174788 (no previous merge yet)
[S15] round=1 local utility u=0.234110 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7600311933683702, 'loss_val': 1.2930046298976954, 'psi': 0.3878526681642831}-{'f1_val': 0.13973365136155833, 'auprc': 0.6247695692443916, 'loss_val': 1.3554401489778853, 'psi': 0.33374801851469166}
[S16] START round=1 head_norm_before_train=1.174857 (no previous merge yet)
[S16] round=1 local utility u=0.035220 metrics={'f1_val': 0.10386473429951691, 'auprc': 0.7723922147317034, 'loss_val': 1.3472521890686937, 'psi': 0.37127572647239154}-{'f1_val': 0.10386473429951691, 'auprc': 0.7587548598192309, 'loss_val': 1.3767806682463433, 'psi': 0.3658207845074025}
[S17] START round=1 head_norm_before_train=1.163779 (no previous merge yet)
[S17] round=1 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5559188621901638, 'loss_val': 1.2836829848770634, 'psi': 0.3069369228664962}-{'f1_val': 0.3840688842092034, 'auprc': 0.5378493637101448, 'loss_val': 1.3394790741585172, 'psi': 0.44558107600957997}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:58308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:58314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] → sending delta(kind=head bytes=1793) to S2@127.0.0.1:58302
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S15] → sending delta(kind=head bytes=1791) to S16@127.0.0.1:58316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:58316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S14] → sending delta(kind=head bytes=1791) to S17@127.0.0.1:58317
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S3] → sending delta(kind=head bytes=1786) to S9@127.0.0.1:58310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S16] → sending delta(kind=head bytes=1791) to S6@127.0.0.1:58307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1785 reason=None
[S5] → sending delta(kind=head bytes=1785) to S14@127.0.0.1:58314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S10] → sending delta(kind=head bytes=1788) to S15@127.0.0.1:58315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:58316
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:58309
[S15] sending update (kind=head size=1791 to 1 peers)
[S5] sending update (kind=head size=1785 to 1 peers)
[S2] sending update (kind=head size=1796 to 1 peers)
[S3] sending update (kind=head size=1786 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1793 to 1 peers)
[S16] sending update (kind=head size=1791 to 1 peers)
[S10] sending update (kind=head size=1788 to 1 peers)
[S6] sending update (kind=head size=1794 to 1 peers)
[S14] sending update (kind=head size=1791 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1791) from S14
[S17] cosine check vs S14: cos=-0.0116
[S17] DROPPED delta from S14 (cos=-0.0116 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1785) from S5
[S14] cosine check vs S5: cos=-0.0125
[S14] DROPPED delta from S5 (cos=-0.0125 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1788) from S10
[S15] cosine check vs S10: cos=0.0292
[S14] RECEIVED delta(kind=head bytes=1794) from S6
[S14] cosine check vs S6: cos=-0.0678
[S14] DROPPED delta from S6 (cos=-0.0678 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1791) from S16
[S6] cosine check vs S16: cos=-0.0018
[S6] DROPPED delta from S16 (cos=-0.0018 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1793) from S9
[S2] cosine check vs S9: cos=0.1046
[S9] RECEIVED delta(kind=head bytes=1786) from S3
[S9] cosine check vs S3: cos=-0.0517
[S9] DROPPED delta from S3 (cos=-0.0517 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1796) from S13
[S8] cosine check vs S13: cos=0.1671
[S7] RECEIVED delta(kind=head bytes=1797) from S4
[S7] cosine check vs S4: cos=0.0608
[S16] RECEIVED delta(kind=head bytes=1796) from S7
[S16] cosine check vs S7: cos=0.0243
[S16] RECEIVED delta(kind=head bytes=1791) from S15
[S16] cosine check vs S15: cos=-0.0148
[S16] DROPPED delta from S15 (cos=-0.0148 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1796) from S2
[S16] cosine check vs S2: cos=-0.0814
[S16] DROPPED delta from S2 (cos=-0.0814 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=1 metric=0.1949 head_norm=1.195306
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.729178e-01
[S8] stored merged vector for next round verification (round=1)
[S8] DEBUG after merge:  round=1 metric=0.5920 head_norm=0.914953 delta_norm=0.772918
[S8] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=1 metric=0.1418 head_norm=1.197850
[S2] _apply_head_vector_avg (torch): Δ‖w‖=7.913443e-01
[S2] stored merged vector for next round verification (round=1)
[S2] DEBUG after merge:  round=1 metric=0.1418 head_norm=0.878902 delta_norm=0.791344
[S2] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=1 metric=0.1397 head_norm=1.205385
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.369249e-01
[S15] stored merged vector for next round verification (round=1)
[S15] DEBUG after merge:  round=1 metric=0.1397 head_norm=0.861718 delta_norm=0.836925
[S15] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=1 metric=0.1421 head_norm=1.192181
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.282317e-01
[S7] stored merged vector for next round verification (round=1)
[S7] DEBUG after merge:  round=1 metric=0.1421 head_norm=0.880227 delta_norm=0.828232
[S7] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=1 metric=0.1039 head_norm=1.179174
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.281581e-01
[S16] stored merged vector for next round verification (round=1)
[S16] DEBUG after merge:  round=1 metric=0.1039 head_norm=0.848545 delta_norm=0.828158
[S16] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=0.878902 cos_to_last_merge=1.0000 (last merge round=1)
[S2] round=2 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7538683966124371, 'loss_val': 1.232987384639873, 'psi': 0.3866136386781149}-{'f1_val': 0.1417771333885667, 'auprc': 0.7845146964850445, 'loss_val': 1.2706473248543515, 'psi': 0.39887215862715786}
[S3] START round=2 head_norm_before_train=1.169079 (no previous merge yet)
[S3] round=2 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8487983345318935, 'loss_val': 1.3019878876570758, 'psi': 0.4234233731812216}-{'f1_val': 0.4151123481022195, 'auprc': 0.8160412733810761, 'loss_val': 1.3330311680097597, 'psi': 0.5754839182137621}
[S4] START round=2 head_norm_before_train=1.224843 (no previous merge yet)
[S4] round=2 local utility u=0.065665 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7853698192090595, 'loss_val': 1.1828578923732254, 'psi': 0.3982839050207343}-{'f1_val': 0.14022662889518414, 'auprc': 0.7775768691856635, 'loss_val': 1.2908086641983458, 'psi': 0.3951667250113759}
[S5] START round=2 head_norm_before_train=1.191168 (no previous merge yet)
[S5] round=2 local utility u=0.001280 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7533314213835745, 'loss_val': 1.2851632107561826, 'psi': 0.3866897114105727}-{'f1_val': 0.14226190476190476, 'auprc': 0.7647684778454005, 'loss_val': 1.3220339787691788, 'psi': 0.3912645339953031}
[S6] START round=2 head_norm_before_train=1.231993 (no previous merge yet)
[S6] round=2 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8741737350758979, 'loss_val': 1.2016669906922257, 'psi': 0.4345252632611284}-{'f1_val': 0.14142628205128205, 'auprc': 0.939019280079453, 'loss_val': 1.2679635050543017, 'psi': 0.46046348126255043}
[S7] START round=2 head_norm_before_train=0.880227 cos_to_last_merge=1.0000 (last merge round=1)
[S7] round=2 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.5688188588545197, 'loss_val': 1.3154846701787273, 'psi': 0.31276163717926286}-{'f1_val': 0.14205682272909165, 'auprc': 0.5726379174961, 'loss_val': 1.3205056382706633, 'psi': 0.314289260635895}
[S8] START round=2 head_norm_before_train=0.914953 cos_to_last_merge=1.0000 (last merge round=1)
[S8] round=2 local utility u=0.128820 metrics={'f1_val': 0.24002384027600832, 'auprc': 0.7601128354901588, 'loss_val': 1.2142990294272555, 'psi': 0.4480594383616685}-{'f1_val': 0.19486088453869857, 'auprc': 0.7824684402448149, 'loss_val': 1.2680290311966014, 'psi': 0.4299039068211451}
[S9] START round=2 head_norm_before_train=1.167282 (no previous merge yet)
[S9] round=2 local utility u=0.024606 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8659630740820881, 'loss_val': 1.2674406641563625, 'psi': 0.43122400391683285}-{'f1_val': 0.141397957139996, 'auprc': 0.8652224217213699, 'loss_val': 1.3144313024160883, 'psi': 0.4309277429725456}
[S10] START round=2 head_norm_before_train=1.197101 (no previous merge yet)
[S10] round=2 local utility u=0.023669 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7831408993892212, 'loss_val': 1.2133218639756365, 'psi': 0.39642934228072285}-{'f1_val': 0.13862163754172394, 'auprc': 0.7938222477902468, 'loss_val': 1.2927045875437555, 'psi': 0.4007018816411331}
[S11] START round=2 head_norm_before_train=1.174801 (no previous merge yet)
[S11] round=2 local utility u=0.066967 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.8039549302677667, 'loss_val': 1.2955820657085504, 'psi': 0.40583018213097305}-{'f1_val': 0.14041368337311058, 'auprc': 0.7738059231655839, 'loss_val': 1.3390689045929314, 'psi': 0.39377057929009995}
[S13] START round=2 head_norm_before_train=1.200135 (no previous merge yet)
[S13] round=2 local utility u=0.000000 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7207183938800736, 'loss_val': 1.209656902119027, 'psi': 0.3725188150982613}-{'f1_val': 0.40267998267951344, 'auprc': 0.6729396135093425, 'loss_val': 1.2997033975905135, 'psi': 0.5107838350114451}
[S14] START round=2 head_norm_before_train=1.150000 (no previous merge yet)
[S14] round=2 local utility u=0.405420 metrics={'f1_val': 0.38532450567884935, 'auprc': 0.8366917282498372, 'loss_val': 1.3139979382194342, 'psi': 0.5658713947072445}-{'f1_val': 0.2682962073718376, 'auprc': 0.8082643363969465, 'loss_val': 1.3373854489518662, 'psi': 0.4842834589818812}
[S15] START round=2 head_norm_before_train=0.861718 cos_to_last_merge=1.0000 (last merge round=1)
[S15] round=2 local utility u=0.024353 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7715847652995119, 'loss_val': 1.2789596463050046, 'psi': 0.3924740969367398}-{'f1_val': 0.13973365136155833, 'auprc': 0.7600311933683702, 'loss_val': 1.2930046298976954, 'psi': 0.3878526681642831}
[S16] START round=2 head_norm_before_train=0.848545 cos_to_last_merge=1.0000 (last merge round=1)
[S16] round=2 local utility u=0.044904 metrics={'f1_val': 0.10386473429951691, 'auprc': 0.8000385717632239, 'loss_val': 1.3403824566483389, 'psi': 0.38233426928499975}-{'f1_val': 0.10386473429951691, 'auprc': 0.7723922147317034, 'loss_val': 1.3472521890686937, 'psi': 0.37127572647239154}
[S17] START round=2 head_norm_before_train=1.189690 (no previous merge yet)
[S17] round=2 local utility u=0.048305 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5570075121088995, 'loss_val': 1.1903380908175978, 'psi': 0.3073723828339905}-{'f1_val': 0.14094896331738438, 'auprc': 0.5559188621901638, 'loss_val': 1.2836829848770634, 'psi': 0.3069369228664962}
[S5] not sending this round → trigger blocked (psi=0.387)
[S16] not sending this round → trigger blocked (psi=0.382)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.431)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.392)
[S4] not sending this round → trigger blocked (psi=0.398)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.566)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S17@127.0.0.1:58317
[S10] not sending this round → trigger blocked (psi=0.396)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:58313
[S11] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1793 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1793) from S8
[S17] cosine check vs S8: cos=0.0088
[S13] RECEIVED delta(kind=head bytes=1797) from S11
[S13] cosine check vs S11: cos=-0.0143
[S13] DROPPED delta from S11 (cos=-0.0143 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:58309
[S17] sending update (kind=head size=1796 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1796) from S17
[S8] cosine check vs S17: cos=0.0088
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=2 metric=0.2400 head_norm=0.966590
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.822873e-01
[S8] stored merged vector for next round verification (round=2)
[S8] DEBUG after merge:  round=2 metric=0.2409 head_norm=0.789021 delta_norm=0.782287
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=2 metric=0.1409 head_norm=1.238854
[S17] _apply_head_vector_avg (torch): Δ‖w‖=7.822874e-01
[S17] stored merged vector for next round verification (round=2)
[S17] DEBUG after merge:  round=2 metric=0.1409 head_norm=0.789021 delta_norm=0.782287
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=3 head_norm_before_train=0.928068 cos_to_last_merge=0.9936 (last merge round=1)
[S2] round=3 local utility u=0.064292 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7694480464953178, 'loss_val': 1.1511417258735877, 'psi': 0.3928454986312672}-{'f1_val': 0.1417771333885667, 'auprc': 0.7538683966124371, 'loss_val': 1.232987384639873, 'psi': 0.3866136386781149}
[S3] START round=3 head_norm_before_train=1.188659 (no previous merge yet)
[S3] round=3 local utility u=0.243804 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9984996265608449, 'loss_val': 1.2634836966388368, 'psi': 0.48330388999280216}-{'f1_val': 0.13984006561410703, 'auprc': 0.8487983345318935, 'loss_val': 1.3019878876570758, 'psi': 0.4234233731812216}
[S4] START round=3 head_norm_before_train=1.279468 (no previous merge yet)
[S4] round=3 local utility u=1.000000 metrics={'f1_val': 0.6845352649384951, 'auprc': 0.7813382160397255, 'loss_val': 0.9544493540863849, 'psi': 0.7232564453789874}-{'f1_val': 0.14022662889518414, 'auprc': 0.7853698192090595, 'loss_val': 1.1828578923732254, 'psi': 0.3982839050207343}
[S5] START round=3 head_norm_before_train=1.210880 (no previous merge yet)
[S5] round=3 local utility u=0.011542 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.749975196600938, 'loss_val': 1.2520102659806571, 'psi': 0.3853472214975181}-{'f1_val': 0.14226190476190476, 'auprc': 0.7533314213835745, 'loss_val': 1.2851632107561826, 'psi': 0.3866897114105727}
[S6] START round=3 head_norm_before_train=1.281889 (no previous merge yet)
[S6] round=3 local utility u=0.913024 metrics={'f1_val': 0.41463700409720844, 'auprc': 0.8869331228856014, 'loss_val': 1.0531615510830894, 'psi': 0.6035554516125656}-{'f1_val': 0.14142628205128205, 'auprc': 0.8741737350758979, 'loss_val': 1.2016669906922257, 'psi': 0.4345252632611284}
[S7] START round=3 head_norm_before_train=0.895327 cos_to_last_merge=0.9973 (last merge round=1)
[S7] round=3 local utility u=0.029491 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.5753985365785576, 'loss_val': 1.2762425193783349, 'psi': 0.315393508268878}-{'f1_val': 0.14205682272909165, 'auprc': 0.5688188588545197, 'loss_val': 1.3154846701787273, 'psi': 0.31276163717926286}
[S8] START round=3 head_norm_before_train=0.789021 cos_to_last_merge=1.0000 (last merge round=2)
[S8] round=3 local utility u=0.585004 metrics={'f1_val': 0.4158888197469405, 'auprc': 0.7647711866339173, 'loss_val': 1.113456842557015, 'psi': 0.5554417665017313}-{'f1_val': 0.24002384027600832, 'auprc': 0.7601128354901588, 'loss_val': 1.2142990294272555, 'psi': 0.4480594383616685}
[S9] START round=3 head_norm_before_train=1.191102 (no previous merge yet)
[S9] round=3 local utility u=0.030825 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8661050641737726, 'loss_val': 1.2062157773947286, 'psi': 0.4312807999535067}-{'f1_val': 0.141397957139996, 'auprc': 0.8659630740820881, 'loss_val': 1.2674406641563625, 'psi': 0.43122400391683285}
[S10] START round=3 head_norm_before_train=1.244739 (no previous merge yet)
[S10] round=3 local utility u=0.905863 metrics={'f1_val': 0.41634224672860876, 'auprc': 0.7805537848497575, 'loss_val': 1.0601587379730706, 'psi': 0.5620268619770683}-{'f1_val': 0.13862163754172394, 'auprc': 0.7831408993892212, 'loss_val': 1.2133218639756365, 'psi': 0.39642934228072285}
[S11] START round=3 head_norm_before_train=1.197991 (no previous merge yet)
[S11] round=3 local utility u=0.004107 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7832130007734884, 'loss_val': 1.2251421580356232, 'psi': 0.3975334103332617}-{'f1_val': 0.14041368337311058, 'auprc': 0.8039549302677667, 'loss_val': 1.2955820657085504, 'psi': 0.40583018213097305}
[S13] START round=3 head_norm_before_train=1.248800 (no previous merge yet)
[S13] round=3 local utility u=0.942241 metrics={'f1_val': 0.41662964849357986, 'auprc': 0.7548464990663571, 'loss_val': 1.0850227070567935, 'psi': 0.5519163887226908}-{'f1_val': 0.1403857625770531, 'auprc': 0.7207183938800736, 'loss_val': 1.209656902119027, 'psi': 0.3725188150982613}
[S14] START round=3 head_norm_before_train=1.170160 (no previous merge yet)
[S14] round=3 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8467223874545267, 'loss_val': 1.282599082966517, 'psi': 0.4229036667114329}-{'f1_val': 0.38532450567884935, 'auprc': 0.8366917282498372, 'loss_val': 1.3139979382194342, 'psi': 0.5658713947072445}
[S15] START round=3 head_norm_before_train=0.894148 cos_to_last_merge=0.9934 (last merge round=1)
[S15] round=3 local utility u=0.029761 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7775518809885891, 'loss_val': 1.2373399453301641, 'psi': 0.39486094321237064}-{'f1_val': 0.13973365136155833, 'auprc': 0.7715847652995119, 'loss_val': 1.2789596463050046, 'psi': 0.3924740969367398}
[S16] START round=3 head_norm_before_train=0.861416 cos_to_last_merge=0.9974 (last merge round=1)
[S16] round=3 local utility u=0.129365 metrics={'f1_val': 0.14072154674108034, 'auprc': 0.8031357402994691, 'loss_val': 1.3120846330177236, 'psi': 0.40568722416443587}-{'f1_val': 0.10386473429951691, 'auprc': 0.8000385717632239, 'loss_val': 1.3403824566483389, 'psi': 0.38233426928499975}
[S17] START round=3 head_norm_before_train=0.789021 cos_to_last_merge=1.0000 (last merge round=2)
[S17] round=3 local utility u=0.280578 metrics={'f1_val': 0.21966670893384105, 'auprc': 0.5483225342783519, 'loss_val': 1.0754327488519877, 'psi': 0.3511290390716454}-{'f1_val': 0.14094896331738438, 'auprc': 0.5570075121088995, 'loss_val': 1.1903380908175978, 'psi': 0.3073723828339905}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:58316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] → sending delta(kind=head bytes=1793) to S6@127.0.0.1:58307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S7] → sending delta(kind=head bytes=1791) to S14@127.0.0.1:58314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S9] → sending delta(kind=head bytes=1791) to S14@127.0.0.1:58314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:58304
[S11] not sending this round → trigger blocked (psi=0.398)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:58310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:58312
[S8] not sending this round → trigger blocked (psi=0.555)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S2] → sending delta(kind=head bytes=1788) to S5@127.0.0.1:58305
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:58305
[S2] sending update (kind=head size=1788 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1794 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1791 to 1 peers)
[S7] sending update (kind=head size=1791 to 1 peers)
[S16] sending update (kind=head size=1793 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1797) from S3
[S5] cosine check vs S3: cos=-0.0773
[S5] DROPPED delta from S3 (cos=-0.0773 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1801) from S15
[S5] cosine check vs S15: cos=0.0009
[S6] RECEIVED delta(kind=head bytes=1793) from S16
[S6] cosine check vs S16: cos=-0.0087
[S6] DROPPED delta from S16 (cos=-0.0087 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1798) from S13
[S9] cosine check vs S13: cos=0.0280
[S4] RECEIVED delta(kind=head bytes=1797) from S6
[S4] cosine check vs S6: cos=-0.0688
[S4] DROPPED delta from S6 (cos=-0.0688 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1791) from S9
[S14] cosine check vs S9: cos=-0.0613
[S14] DROPPED delta from S9 (cos=-0.0613 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1791) from S7
[S14] cosine check vs S7: cos=0.0957
[S11] RECEIVED delta(kind=head bytes=1801) from S4
[S11] cosine check vs S4: cos=0.0602
[S16] RECEIVED delta(kind=head bytes=1796) from S5
[S16] cosine check vs S5: cos=0.0836
[S5] RECEIVED delta(kind=head bytes=1794) from S10
[S5] cosine check vs S10: cos=-0.0303
[S5] DROPPED delta from S10 (cos=-0.0303 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1788) from S2
[S5] cosine check vs S2: cos=-0.0446
[S5] DROPPED delta from S2 (cos=-0.0446 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.351)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=3 metric=0.1404 head_norm=1.229157
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.855226e-01
[S11] stored merged vector for next round verification (round=3)
[S11] DEBUG after merge:  round=3 metric=0.1404 head_norm=0.940299 delta_norm=0.885523
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=3 metric=0.1404 head_norm=1.199827
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.198098e-01
[S14] stored merged vector for next round verification (round=3)
[S14] DEBUG after merge:  round=3 metric=0.1404 head_norm=0.789665 delta_norm=0.719810
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=3 metric=0.1407 head_norm=0.880950
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.279019e-01
[S16] stored merged vector for next round verification (round=3)
[S16] DEBUG after merge:  round=3 metric=0.1406 head_norm=0.787914 delta_norm=0.727902
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=3 metric=0.1423 head_norm=1.235001
[S5] _apply_head_vector_avg (torch): Δ‖w‖=7.735293e-01
[S5] stored merged vector for next round verification (round=3)
[S5] DEBUG after merge:  round=3 metric=0.1423 head_norm=0.774188 delta_norm=0.773529
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=3 metric=0.1414 head_norm=1.220210
[S9] _apply_head_vector_avg (torch): Δ‖w‖=8.767564e-01
[S9] stored merged vector for next round verification (round=3)
[S9] DEBUG after merge:  round=3 metric=0.1414 head_norm=0.901643 delta_norm=0.876756
[S9] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=0.971062 cos_to_last_merge=0.9848 (last merge round=1)
[S2] round=4 local utility u=0.828356 metrics={'f1_val': 0.383653419719463, 'auprc': 0.7771464972026678, 'loss_val': 0.9687822435900795, 'psi': 0.5410506507127449}-{'f1_val': 0.1417771333885667, 'auprc': 0.7694480464953178, 'loss_val': 1.1511417258735877, 'psi': 0.3928454986312672}
[S3] START round=4 head_norm_before_train=1.216543 (no previous merge yet)
[S3] round=4 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9283267149540844, 'loss_val': 1.2268972889582381, 'psi': 0.455234725350098}-{'f1_val': 0.13984006561410703, 'auprc': 0.9984996265608449, 'loss_val': 1.2634836966388368, 'psi': 0.48330388999280216}
[S4] START round=4 head_norm_before_train=1.351221 (no previous merge yet)
[S4] round=4 local utility u=0.000000 metrics={'f1_val': 0.6683403972900401, 'auprc': 0.6559606119651302, 'loss_val': 0.6700371259232613, 'psi': 0.6633884831600761}-{'f1_val': 0.6845352649384951, 'auprc': 0.7813382160397255, 'loss_val': 0.9544493540863849, 'psi': 0.7232564453789874}
[S5] START round=4 head_norm_before_train=0.774188 cos_to_last_merge=1.0000 (last merge round=3)
[S5] round=4 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7452914191762546, 'loss_val': 1.2699793766422642, 'psi': 0.38347371052764473}-{'f1_val': 0.14226190476190476, 'auprc': 0.749975196600938, 'loss_val': 1.2520102659806571, 'psi': 0.3853472214975181}
[S6] START round=4 head_norm_before_train=1.328485 (no previous merge yet)
[S6] round=4 local utility u=0.259680 metrics={'f1_val': 0.4172560359570804, 'auprc': 0.9691907212491837, 'loss_val': 0.7962875710164761, 'psi': 0.6380299100739217}-{'f1_val': 0.41463700409720844, 'auprc': 0.8869331228856014, 'loss_val': 1.0531615510830894, 'psi': 0.6035554516125656}
[S7] START round=4 head_norm_before_train=0.918589 cos_to_last_merge=0.9899 (last merge round=1)
[S7] round=4 local utility u=0.031335 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.5813837857511573, 'loss_val': 1.2315272886600102, 'psi': 0.31778760793791794}-{'f1_val': 0.14205682272909165, 'auprc': 0.5753985365785576, 'loss_val': 1.2762425193783349, 'psi': 0.315393508268878}
[S8] START round=4 head_norm_before_train=0.843767 cos_to_last_merge=0.9906 (last merge round=2)
[S8] round=4 local utility u=0.000000 metrics={'f1_val': 0.3729322731464855, 'auprc': 0.7766867956354189, 'loss_val': 0.9063167624033766, 'psi': 0.5344340821420589}-{'f1_val': 0.4158888197469405, 'auprc': 0.7647711866339173, 'loss_val': 1.113456842557015, 'psi': 0.5554417665017313}
[S9] START round=4 head_norm_before_train=0.901643 cos_to_last_merge=1.0000 (last merge round=3)
[S9] round=4 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8662395647133269, 'loss_val': 1.2094150277482418, 'psi': 0.4313346001693284}-{'f1_val': 0.141397957139996, 'auprc': 0.8661050641737726, 'loss_val': 1.2062157773947286, 'psi': 0.4312807999535067}
[S10] START round=4 head_norm_before_train=1.290810 (no previous merge yet)
[S10] round=4 local utility u=0.092649 metrics={'f1_val': 0.38867670237126606, 'auprc': 0.8063100872939639, 'loss_val': 0.7861371058817163, 'psi': 0.5557300563403452}-{'f1_val': 0.41634224672860876, 'auprc': 0.7805537848497575, 'loss_val': 1.0601587379730706, 'psi': 0.5620268619770683}
[S11] START round=4 head_norm_before_train=0.940299 cos_to_last_merge=1.0000 (last merge round=3)
[S11] round=4 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.5958944162941737, 'loss_val': 1.191631880880399, 'psi': 0.32260597654153583}-{'f1_val': 0.14041368337311058, 'auprc': 0.7832130007734884, 'loss_val': 1.2251421580356232, 'psi': 0.3975334103332617}
[S13] START round=4 head_norm_before_train=1.293990 (no previous merge yet)
[S13] round=4 local utility u=0.000000 metrics={'f1_val': 0.3789129374530391, 'auprc': 0.7427205616552954, 'loss_val': 0.8311968618911328, 'psi': 0.5244359871339417}-{'f1_val': 0.41662964849357986, 'auprc': 0.7548464990663571, 'loss_val': 1.0850227070567935, 'psi': 0.5519163887226908}
[S14] START round=4 head_norm_before_train=0.789665 cos_to_last_merge=1.0000 (last merge round=3)
[S14] round=4 local utility u=0.009884 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8553408681494528, 'loss_val': 1.288687203988268, 'psi': 0.4263510589894034}-{'f1_val': 0.14035785288270378, 'auprc': 0.8467223874545267, 'loss_val': 1.282599082966517, 'psi': 0.4229036667114329}
[S15] START round=4 head_norm_before_train=0.932847 cos_to_last_merge=0.9801 (last merge round=1)
[S15] round=4 local utility u=1.000000 metrics={'f1_val': 0.6396844972532106, 'auprc': 0.7809315638354133, 'loss_val': 1.1935129356406853, 'psi': 0.6961833238860917}-{'f1_val': 0.13973365136155833, 'auprc': 0.7775518809885891, 'loss_val': 1.2373399453301641, 'psi': 0.39486094321237064}
[S16] START round=4 head_norm_before_train=0.787914 cos_to_last_merge=1.0000 (last merge round=3)
[S16] round=4 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.49916154117300116, 'loss_val': 1.3255356633249644, 'psi': 0.28404708658872235}-{'f1_val': 0.14072154674108034, 'auprc': 0.8031357402994691, 'loss_val': 1.3120846330177236, 'psi': 0.40568722416443587}
[S17] START round=4 head_norm_before_train=0.855790 cos_to_last_merge=0.9895 (last merge round=2)
[S17] round=4 local utility u=0.618122 metrics={'f1_val': 0.3962195899136122, 'auprc': 0.5585005646189958, 'loss_val': 0.9290399360595385, 'psi': 0.46113197979576565}-{'f1_val': 0.21966670893384105, 'auprc': 0.5483225342783519, 'loss_val': 1.0754327488519877, 'psi': 0.3511290390716454}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:58305
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:58314
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:58304
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:58305
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S2] → sending delta(kind=head bytes=1791) to S5@127.0.0.1:58305
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1791 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1797) from S7
[S14] cosine check vs S7: cos=0.6245
[S5] RECEIVED delta(kind=head bytes=1791) from S2
[S5] cosine check vs S2: cos=-0.0466
[S5] DROPPED delta from S2 (cos=-0.0466 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1796) from S15
[S5] cosine check vs S15: cos=0.5813
[S5] RECEIVED delta(kind=head bytes=1798) from S10
[S5] cosine check vs S10: cos=0.3371
[S5] RECEIVED delta(kind=head bytes=1800) from S14
[S5] cosine check vs S14: cos=-0.0190
[S5] DROPPED delta from S14 (cos=-0.0190 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1799) from S6
[S4] cosine check vs S6: cos=-0.0730
[S4] DROPPED delta from S6 (cos=-0.0730 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:58310
[S17] sending update (kind=head size=1795 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1795) from S17
[S9] cosine check vs S17: cos=0.2696
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=4 metric=0.1423 head_norm=0.804145
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.750485e-01
[S5] stored merged vector for next round verification (round=4)
[S5] DEBUG after merge:  round=4 metric=0.1423 head_norm=0.794889 delta_norm=0.475048
[S5] aggregate: ACCEPT kept=['S15', 'S10'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=4 metric=0.1414 head_norm=0.931765
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.692955e-01
[S9] stored merged vector for next round verification (round=4)
[S9] DEBUG after merge:  round=4 metric=0.1414 head_norm=0.750500 delta_norm=0.569295
[S9] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=4 metric=0.1404 head_norm=0.824089
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.873337e-01
[S14] stored merged vector for next round verification (round=4)
[S14] DEBUG after merge:  round=4 metric=0.1404 head_norm=0.797992 delta_norm=0.387334
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=5 head_norm_before_train=1.030220 cos_to_last_merge=0.9708 (last merge round=1)
[S2] round=5 local utility u=1.000000 metrics={'f1_val': 0.7015503535599839, 'auprc': 0.7410466347567578, 'loss_val': 0.7217849115806959, 'psi': 0.7173488660386934}-{'f1_val': 0.383653419719463, 'auprc': 0.7771464972026678, 'loss_val': 0.9687822435900795, 'psi': 0.5410506507127449}
[S3] START round=5 head_norm_before_train=1.249645 (no previous merge yet)
[S3] round=5 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8937138730841458, 'loss_val': 1.1600720856479232, 'psi': 0.44138958860212263}-{'f1_val': 0.13984006561410703, 'auprc': 0.9283267149540844, 'loss_val': 1.2268972889582381, 'psi': 0.455234725350098}
[S4] START round=5 head_norm_before_train=1.444313 (no previous merge yet)
[S4] round=5 local utility u=0.061901 metrics={'f1_val': 0.666246583560494, 'auprc': 0.6508069740495772, 'loss_val': 0.5182105172180056, 'psi': 0.6600707397561274}-{'f1_val': 0.6683403972900401, 'auprc': 0.6559606119651302, 'loss_val': 0.6700371259232613, 'psi': 0.6633884831600761}
[S5] START round=5 head_norm_before_train=0.794889 cos_to_last_merge=1.0000 (last merge round=4)
[S5] round=5 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7338441168914954, 'loss_val': 1.2657043936795092, 'psi': 0.378894789613741}-{'f1_val': 0.14226190476190476, 'auprc': 0.7452914191762546, 'loss_val': 1.2699793766422642, 'psi': 0.38347371052764473}
[S6] START round=5 head_norm_before_train=1.390749 (no previous merge yet)
[S6] round=5 local utility u=0.104520 metrics={'f1_val': 0.501328048424411, 'auprc': 0.8116225997835788, 'loss_val': 0.6189752769284692, 'psi': 0.6254458689680782}-{'f1_val': 0.4172560359570804, 'auprc': 0.9691907212491837, 'loss_val': 0.7962875710164761, 'psi': 0.6380299100739217}
[S7] START round=5 head_norm_before_train=0.945787 cos_to_last_merge=0.9796 (last merge round=1)
[S7] round=5 local utility u=0.013534 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.5755712045800323, 'loss_val': 1.1870215845712324, 'psi': 0.31546257546946793}-{'f1_val': 0.14205682272909165, 'auprc': 0.5813837857511573, 'loss_val': 1.2315272886600102, 'psi': 0.31778760793791794}
[S8] START round=5 head_norm_before_train=0.917952 cos_to_last_merge=0.9709 (last merge round=2)
[S8] round=5 local utility u=0.404927 metrics={'f1_val': 0.3728649953480749, 'auprc': 0.9939063464061485, 'loss_val': 0.7477178797244537, 'psi': 0.6212815357713044}-{'f1_val': 0.3729322731464855, 'auprc': 0.7766867956354189, 'loss_val': 0.9063167624033766, 'psi': 0.5344340821420589}
[S9] START round=5 head_norm_before_train=0.750500 cos_to_last_merge=1.0000 (last merge round=4)
[S9] round=5 local utility u=0.013325 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8659944664888977, 'loss_val': 1.1820304165080382, 'psi': 0.4312365608795567}-{'f1_val': 0.141397957139996, 'auprc': 0.8662395647133269, 'loss_val': 1.2094150277482418, 'psi': 0.4313346001693284}
[S10] START round=5 head_norm_before_train=1.342087 (no previous merge yet)
[S10] round=5 local utility u=0.990628 metrics={'f1_val': 0.6948936723936014, 'auprc': 0.794576532318047, 'loss_val': 0.60698241731562, 'psi': 0.7347668163633796}-{'f1_val': 0.38867670237126606, 'auprc': 0.8063100872939639, 'loss_val': 0.7861371058817163, 'psi': 0.5557300563403452}
[S11] START round=5 head_norm_before_train=0.972783 cos_to_last_merge=0.9968 (last merge round=3)
[S11] round=5 local utility u=0.667126 metrics={'f1_val': 0.3413594095067477, 'auprc': 0.5985171528396994, 'loss_val': 1.0709231195544804, 'psi': 0.44422250683992837}-{'f1_val': 0.14041368337311058, 'auprc': 0.5958944162941737, 'loss_val': 1.191631880880399, 'psi': 0.32260597654153583}
[S13] START round=5 head_norm_before_train=1.343328 (no previous merge yet)
[S13] round=5 local utility u=0.277264 metrics={'f1_val': 0.4631231925269545, 'auprc': 0.7361922532802215, 'loss_val': 0.7623458450127023, 'psi': 0.5723508168282614}-{'f1_val': 0.3789129374530391, 'auprc': 0.7427205616552954, 'loss_val': 0.8311968618911328, 'psi': 0.5244359871339417}
[S14] START round=5 head_norm_before_train=0.797992 cos_to_last_merge=1.0000 (last merge round=4)
[S14] round=5 local utility u=0.001621 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8539919605362276, 'loss_val': 1.28139890889709, 'psi': 0.4258114959441133}-{'f1_val': 0.14035785288270378, 'auprc': 0.8553408681494528, 'loss_val': 1.288687203988268, 'psi': 0.4263510589894034}
[S15] START round=5 head_norm_before_train=0.959463 cos_to_last_merge=0.9664 (last merge round=1)
[S15] round=5 local utility u=0.000000 metrics={'f1_val': 0.41714217784117924, 'auprc': 0.8000632712990826, 'loss_val': 0.9093370030695962, 'psi': 0.5703106152243407}-{'f1_val': 0.6396844972532106, 'auprc': 0.7809315638354133, 'loss_val': 1.1935129356406853, 'psi': 0.6961833238860917}
[S16] START round=5 head_norm_before_train=0.804011 cos_to_last_merge=0.9965 (last merge round=3)
[S16] round=5 local utility u=0.323529 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.6969915448537993, 'loss_val': 1.2719681751316554, 'psi': 0.3631790880610416}-{'f1_val': 0.14063745019920318, 'auprc': 0.49916154117300116, 'loss_val': 1.3255356633249644, 'psi': 0.28404708658872235}
[S17] START round=5 head_norm_before_train=0.952108 cos_to_last_merge=0.9616 (last merge round=2)
[S17] round=5 local utility u=0.266107 metrics={'f1_val': 0.3540627875699016, 'auprc': 0.8045756518221288, 'loss_val': 0.8821095889050156, 'psi': 0.5342679332707925}-{'f1_val': 0.3962195899136122, 'auprc': 0.5585005646189958, 'loss_val': 0.9290399360595385, 'psi': 0.46113197979576565}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:58308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:58304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S7] → sending delta(kind=head bytes=1790) to S14@127.0.0.1:58314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:58310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:58310
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:58305
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:58312
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S16] → sending delta(kind=head bytes=1792) to S6@127.0.0.1:58307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:58314
[S14] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1790 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1795 to 1 peers)
[S16] sending update (kind=head size=1792 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1792) from S16
[S6] cosine check vs S16: cos=-0.0404
[S6] DROPPED delta from S16 (cos=-0.0404 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1801) from S14
[S5] cosine check vs S14: cos=-0.0309
[S5] DROPPED delta from S14 (cos=-0.0309 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1797) from S10
[S5] cosine check vs S10: cos=0.7384
[S9] RECEIVED delta(kind=head bytes=1800) from S11
[S9] cosine check vs S11: cos=-0.1214
[S9] DROPPED delta from S11 (cos=-0.1214 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1795) from S8
[S7] cosine check vs S8: cos=-0.0045
[S7] DROPPED delta from S8 (cos=-0.0045 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1802) from S6
[S4] cosine check vs S6: cos=-0.0771
[S4] DROPPED delta from S6 (cos=-0.0771 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1803) from S9
[S14] cosine check vs S9: cos=-0.1015
[S14] DROPPED delta from S9 (cos=-0.1015 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1790) from S7
[S14] cosine check vs S7: cos=0.8829
[S11] RECEIVED delta(kind=head bytes=1799) from S4
[S11] cosine check vs S4: cos=0.7125
[S5] RECEIVED delta(kind=head bytes=1795) from S2
[S5] cosine check vs S2: cos=-0.0347
[S5] DROPPED delta from S2 (cos=-0.0347 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1796) from S13
[S9] cosine check vs S13: cos=0.6220
[S17] not sending this round → trigger blocked (psi=0.534)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=5 metric=0.1423 head_norm=0.820442
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.798516e-01
[S5] stored merged vector for next round verification (round=5)
[S5] DEBUG after merge:  round=5 metric=0.1423 head_norm=1.035507 delta_norm=0.479852
[S5] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.332 → S16@127.0.0.1:58316
[S3] ⇄ pheromone p=0.441 → S5@127.0.0.1:58305
[S2] ⇄ pheromone p=0.671 → S5@127.0.0.1:58305
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=5 metric=0.1414 head_norm=0.782223
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.483739e-01
[S9] stored merged vector for next round verification (round=5)
[S9] DEBUG after merge:  round=5 metric=0.1414 head_norm=0.990025 delta_norm=0.548374
[S9] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.339 → S14@127.0.0.1:58314
[S4] ⇄ pheromone p=0.496 → S11@127.0.0.1:58312
[S6] ⇄ pheromone p=0.519 → S4@127.0.0.1:58304
[S8] ⇄ pheromone p=0.497 → S7@127.0.0.1:58308
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=5 metric=0.3414 head_norm=1.011545
[S11] _apply_head_vector_avg (torch): Δ‖w‖=5.450724e-01
[S11] stored merged vector for next round verification (round=5)
[S11] DEBUG after merge:  round=5 metric=0.3879 head_norm=1.188681 delta_norm=0.545072
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.468 → S9@127.0.0.1:58310
[S13] ⇄ pheromone p=0.586 → S9@127.0.0.1:58310
[S7] ⇄ pheromone p=0.340 → S14@127.0.0.1:58314
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=5 metric=0.1404 head_norm=0.819036
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.289118e-01
[S14] stored merged vector for next round verification (round=5)
[S14] DEBUG after merge:  round=5 metric=0.1404 head_norm=0.868838 delta_norm=0.228912
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.418 → S5@127.0.0.1:58305
[S16] ⇄ pheromone p=0.416 → S6@127.0.0.1:58307
[S10] ⇄ pheromone p=0.663 → S5@127.0.0.1:58305
[S15] ⇄ pheromone p=0.513 → S5@127.0.0.1:58305
[S17] ⇄ pheromone p=0.521 → S9@127.0.0.1:58310
[S2] START round=6 head_norm_before_train=1.106431 cos_to_last_merge=0.9515 (last merge round=1)
[S2] round=6 local utility u=0.062693 metrics={'f1_val': 0.7019113741730649, 'auprc': 0.6845102642771228, 'loss_val': 0.428956117888261, 'psi': 0.6949509302146881}-{'f1_val': 0.7015503535599839, 'auprc': 0.7410466347567578, 'loss_val': 0.7217849115806959, 'psi': 0.7173488660386934}
[S3] START round=6 head_norm_before_train=1.278285 (no previous merge yet)
[S3] round=6 local utility u=0.907687 metrics={'f1_val': 0.4226526521515814, 'auprc': 0.8976792287689543, 'loss_val': 1.0534686814822907, 'psi': 0.6126632827985306}-{'f1_val': 0.13984006561410703, 'auprc': 0.8937138730841458, 'loss_val': 1.1600720856479232, 'psi': 0.44138958860212263}
[S4] START round=6 head_norm_before_train=1.548195 (no previous merge yet)
[S4] round=6 local utility u=0.360923 metrics={'f1_val': 0.664752153210778, 'auprc': 0.8920741716887342, 'loss_val': 0.5111995040766417, 'psi': 0.7556809606019605}-{'f1_val': 0.666246583560494, 'auprc': 0.6508069740495772, 'loss_val': 0.5182105172180056, 'psi': 0.6600707397561274}
[S5] START round=6 head_norm_before_train=1.035507 cos_to_last_merge=1.0000 (last merge round=5)
[S5] round=6 local utility u=0.024027 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.742524209053364, 'loss_val': 1.2436911403346544, 'psi': 0.38236682647848846}-{'f1_val': 0.14226190476190476, 'auprc': 0.7338441168914954, 'loss_val': 1.2657043936795092, 'psi': 0.378894789613741}
[S6] START round=6 head_norm_before_train=1.459060 (no previous merge yet)
[S6] round=6 local utility u=0.869683 metrics={'f1_val': 0.699043831838028, 'auprc': 0.9536892475481917, 'loss_val': 0.492103189337474, 'psi': 0.8009019981220935}-{'f1_val': 0.501328048424411, 'auprc': 0.8116225997835788, 'loss_val': 0.6189752769284692, 'psi': 0.6254458689680782}
[S7] START round=6 head_norm_before_train=0.971464 cos_to_last_merge=0.9694 (last merge round=1)
[S7] round=6 local utility u=0.806554 metrics={'f1_val': 0.40061529603544216, 'auprc': 0.5755765908029719, 'loss_val': 1.1252797070871452, 'psi': 0.47059981394245404}-{'f1_val': 0.14205682272909165, 'auprc': 0.5755712045800323, 'loss_val': 1.1870215845712324, 'psi': 0.31546257546946793}
[S8] START round=6 head_norm_before_train=0.998677 cos_to_last_merge=0.9464 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.946
[S8] round=6 local utility u=0.869736 metrics={'f1_val': 0.6339563693243575, 'auprc': 0.9930631066078732, 'loss_val': 0.5722643128194003, 'psi': 0.7775990642377637}-{'f1_val': 0.3728649953480749, 'auprc': 0.9939063464061485, 'loss_val': 0.7477178797244537, 'psi': 0.6212815357713044}
[S9] START round=6 head_norm_before_train=0.990025 cos_to_last_merge=1.0000 (last merge round=5)
[S9] round=6 local utility u=0.048485 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8664034243036217, 'loss_val': 1.0862864421454799, 'psi': 0.4314001440054463}-{'f1_val': 0.141397957139996, 'auprc': 0.8659944664888977, 'loss_val': 1.1820304165080382, 'psi': 0.4312365608795567}
[S10] START round=6 head_norm_before_train=1.389942 (no previous merge yet)
[S10] round=6 local utility u=0.154578 metrics={'f1_val': 0.6894141259110484, 'auprc': 0.8666365307188304, 'loss_val': 0.4811285506389863, 'psi': 0.7603030878341612}-{'f1_val': 0.6948936723936014, 'auprc': 0.794576532318047, 'loss_val': 0.60698241731562, 'psi': 0.7347668163633796}
[S11] START round=6 head_norm_before_train=1.188681 cos_to_last_merge=1.0000 (last merge round=5)
[S11] round=6 local utility u=0.531759 metrics={'f1_val': 0.4132224946426083, 'auprc': 0.7690762329783802, 'loss_val': 0.9502616825291529, 'psi': 0.5555639899769171}-{'f1_val': 0.3413594095067477, 'auprc': 0.5985171528396994, 'loss_val': 1.0709231195544804, 'psi': 0.44422250683992837}
[S13] START round=6 head_norm_before_train=1.396372 (no previous merge yet)
[S13] round=6 local utility u=0.864865 metrics={'f1_val': 0.7126326316239505, 'auprc': 0.7468926135704714, 'loss_val': 0.5617734149669218, 'psi': 0.7263366244025589}-{'f1_val': 0.4631231925269545, 'auprc': 0.7361922532802215, 'loss_val': 0.7623458450127023, 'psi': 0.5723508168282614}
[S14] START round=6 head_norm_before_train=0.868838 cos_to_last_merge=1.0000 (last merge round=5)
[S14] round=6 local utility u=0.003191 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8479741842736714, 'loss_val': 1.2569633652731809, 'psi': 0.42340438543909087}-{'f1_val': 0.14035785288270378, 'auprc': 0.8539919605362276, 'loss_val': 1.28139890889709, 'psi': 0.4258114959441133}
[S15] START round=6 head_norm_before_train=1.023165 cos_to_last_merge=0.9418 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.942
[S15] round=6 local utility u=0.977920 metrics={'f1_val': 0.701333785093376, 'auprc': 0.7999282251566288, 'loss_val': 0.6582418873822734, 'psi': 0.7407715611186771}-{'f1_val': 0.41714217784117924, 'auprc': 0.8000632712990826, 'loss_val': 0.9093370030695962, 'psi': 0.5703106152243407}
[S16] START round=6 head_norm_before_train=0.831667 cos_to_last_merge=0.9858 (last merge round=3)
[S16] round=6 local utility u=0.854103 metrics={'f1_val': 0.4144820245979186, 'auprc': 0.6953586491917084, 'loss_val': 1.2019301400888882, 'psi': 0.5268326744354346}-{'f1_val': 0.14063745019920318, 'auprc': 0.6969915448537993, 'loss_val': 1.2719681751316554, 'psi': 0.3631790880610416}
[S17] START round=6 head_norm_before_train=1.054171 cos_to_last_merge=0.9300 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.930
[S17] round=6 local utility u=0.000000 metrics={'f1_val': 0.35332495072624465, 'auprc': 0.6582553676939176, 'loss_val': 0.8690462337445793, 'psi': 0.4752971175133138}-{'f1_val': 0.3540627875699016, 'auprc': 0.8045756518221288, 'loss_val': 0.8821095889050156, 'psi': 0.5342679332707925}
[S4] not sending this round → trigger blocked (psi=0.756)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:58316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] → sending delta(kind=head bytes=1793) to S6@127.0.0.1:58307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:58304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:58314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:58308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:58310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:58310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S7] → sending delta(kind=head bytes=1790) to S14@127.0.0.1:58314
[S10] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1790 to 1 peers)
[S2] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1793 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S3] sending update (kind=head size=1794 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1793) from S16
[S6] cosine check vs S16: cos=-0.0365
[S6] DROPPED delta from S16 (cos=-0.0365 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1796) from S8
[S7] cosine check vs S8: cos=-0.0069
[S7] DROPPED delta from S8 (cos=-0.0069 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1800) from S6
[S4] cosine check vs S6: cos=-0.0857
[S4] DROPPED delta from S6 (cos=-0.0857 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1802) from S11
[S9] cosine check vs S11: cos=-0.1386
[S9] DROPPED delta from S11 (cos=-0.1386 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1800) from S13
[S9] cosine check vs S13: cos=0.9314
[S14] RECEIVED delta(kind=head bytes=1790) from S7
[S14] cosine check vs S7: cos=0.9508
[S14] RECEIVED delta(kind=head bytes=1797) from S9
[S14] cosine check vs S9: cos=-0.0938
[S14] DROPPED delta from S9 (cos=-0.0938 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1795) from S5
[S16] cosine check vs S5: cos=0.0563
[S5] RECEIVED delta(kind=head bytes=1797) from S10
[S5] cosine check vs S10: cos=0.9453
[S5] RECEIVED delta(kind=head bytes=1796) from S2
[S5] cosine check vs S2: cos=-0.0299
[S5] DROPPED delta from S2 (cos=-0.0299 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1794) from S3
[S5] cosine check vs S3: cos=-0.0073
[S5] DROPPED delta from S3 (cos=-0.0073 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1796) from S14
[S5] cosine check vs S14: cos=-0.0220
[S5] DROPPED delta from S14 (cos=-0.0220 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1799) from S15
[S5] cosine check vs S15: cos=0.6484
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=6 metric=0.4145 head_norm=0.869739
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.636233e-01
[S16] stored merged vector for next round verification (round=6)
[S16] DEBUG after merge:  round=6 metric=0.4155 head_norm=0.701400 delta_norm=0.663623
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=6 metric=0.1414 head_norm=1.011150
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.151743e-01
[S9] stored merged vector for next round verification (round=6)
[S9] DEBUG after merge:  round=6 metric=0.1414 head_norm=1.211740 delta_norm=0.315174
[S9] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=6 metric=0.1423 head_norm=1.052744
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.855250e-01
[S5] stored merged vector for next round verification (round=6)
[S5] DEBUG after merge:  round=6 metric=0.1423 head_norm=1.063322 delta_norm=0.185525
[S5] aggregate: ACCEPT kept=['S10', 'S15'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=6 metric=0.1404 head_norm=0.885724
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.580019e-01
[S14] stored merged vector for next round verification (round=6)
[S14] DEBUG after merge:  round=6 metric=0.1404 head_norm=0.930604 delta_norm=0.158002
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=7 head_norm_before_train=1.203838 cos_to_last_merge=0.9278 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.928
[S2] round=7 local utility u=0.167931 metrics={'f1_val': 0.7018318238212289, 'auprc': 0.7595424325091427, 'loss_val': 0.31771234444303603, 'psi': 0.7249160672963944}-{'f1_val': 0.7019113741730649, 'auprc': 0.6845102642771228, 'loss_val': 0.428956117888261, 'psi': 0.6949509302146881}
[S3] START round=7 head_norm_before_train=1.310200 (no previous merge yet)
[S3] round=7 local utility u=0.000000 metrics={'f1_val': 0.39645225981545407, 'auprc': 0.8249895622970221, 'loss_val': 0.8600449895438246, 'psi': 0.5678671808080813}-{'f1_val': 0.4226526521515814, 'auprc': 0.8976792287689543, 'loss_val': 1.0534686814822907, 'psi': 0.6126632827985306}
[S4] START round=7 head_norm_before_train=1.627124 (no previous merge yet)
[S4] round=7 local utility u=0.842851 metrics={'f1_val': 0.9438918153726616, 'auprc': 0.9067923675439857, 'loss_val': 0.5444904448010234, 'psi': 0.9290520362411914}-{'f1_val': 0.664752153210778, 'auprc': 0.8920741716887342, 'loss_val': 0.5111995040766417, 'psi': 0.7556809606019605}
[S5] START round=7 head_norm_before_train=1.063322 cos_to_last_merge=1.0000 (last merge round=6)
[S5] round=7 local utility u=0.061445 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7699266438748801, 'loss_val': 1.203008923812844, 'psi': 0.3933278004070949}-{'f1_val': 0.14226190476190476, 'auprc': 0.742524209053364, 'loss_val': 1.2436911403346544, 'psi': 0.38236682647848846}
[S6] START round=7 head_norm_before_train=1.528700 (no previous merge yet)
[S6] round=7 local utility u=0.000000 metrics={'f1_val': 0.5855814265204023, 'auprc': 0.7904632617594556, 'loss_val': 0.5901077747961726, 'psi': 0.6675341606160237}-{'f1_val': 0.699043831838028, 'auprc': 0.9536892475481917, 'loss_val': 0.492103189337474, 'psi': 0.8009019981220935}
[S7] START round=7 head_norm_before_train=0.998735 cos_to_last_merge=0.9593 (last merge round=1)
[S7] round=7 local utility u=0.096188 metrics={'f1_val': 0.41736073619820624, 'auprc': 0.5753864427257475, 'loss_val': 1.0328056708263695, 'psi': 0.4805710188092227}-{'f1_val': 0.40061529603544216, 'auprc': 0.5755765908029719, 'loss_val': 1.1252797070871452, 'psi': 0.47059981394245404}
[S8] START round=7 head_norm_before_train=1.079244 cos_to_last_merge=0.9214 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.921
[S8] round=7 local utility u=0.343165 metrics={'f1_val': 0.7138229449839267, 'auprc': 0.995986453943873, 'loss_val': 0.3739036324736327, 'psi': 0.8266883485679053}-{'f1_val': 0.6339563693243575, 'auprc': 0.9930631066078732, 'loss_val': 0.5722643128194003, 'psi': 0.7775990642377637}
[S9] START round=7 head_norm_before_train=1.211740 cos_to_last_merge=1.0000 (last merge round=6)
[S9] round=7 local utility u=1.000000 metrics={'f1_val': 0.40108602344511934, 'auprc': 0.9997523066022418, 'loss_val': 0.9360955042815294, 'psi': 0.6405525367079683}-{'f1_val': 0.141397957139996, 'auprc': 0.8664034243036217, 'loss_val': 1.0862864421454799, 'psi': 0.4314001440054463}
[S10] START round=7 head_norm_before_train=1.451618 (no previous merge yet)
[S10] round=7 local utility u=0.240299 metrics={'f1_val': 0.6888215669362565, 'auprc': 0.9959625586084233, 'loss_val': 0.38495279399071847, 'psi': 0.8116779636051232}-{'f1_val': 0.6894141259110484, 'auprc': 0.8666365307188304, 'loss_val': 0.4811285506389863, 'psi': 0.7603030878341612}
[S11] START round=7 head_norm_before_train=1.219154 cos_to_last_merge=0.9975 (last merge round=5)
[S11] round=7 local utility u=0.116624 metrics={'f1_val': 0.39421113913131656, 'auprc': 0.8291706625283477, 'loss_val': 0.7832293297732112, 'psi': 0.568194948490129}-{'f1_val': 0.4132224946426083, 'auprc': 0.7690762329783802, 'loss_val': 0.9502616825291529, 'psi': 0.5555639899769171}
[S13] START round=7 head_norm_before_train=1.453573 (no previous merge yet)
[S13] round=7 local utility u=0.000000 metrics={'f1_val': 0.7015157350165347, 'auprc': 0.6966984680074341, 'loss_val': 0.4903861710205833, 'psi': 0.6995888282128945}-{'f1_val': 0.7126326316239505, 'auprc': 0.7468926135704714, 'loss_val': 0.5617734149669218, 'psi': 0.7263366244025589}
[S14] START round=7 head_norm_before_train=0.930604 cos_to_last_merge=1.0000 (last merge round=6)
[S14] round=7 local utility u=0.044431 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8595855078426318, 'loss_val': 1.2029357504620422, 'psi': 0.42804891486667496}-{'f1_val': 0.14035785288270378, 'auprc': 0.8479741842736714, 'loss_val': 1.2569633652731809, 'psi': 0.42340438543909087}
[S15] START round=7 head_norm_before_train=1.095507 cos_to_last_merge=0.9109 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.911
[S15] round=7 local utility u=0.075959 metrics={'f1_val': 0.6983640589803009, 'auprc': 0.7997397034048, 'loss_val': 0.4879399210821598, 'psi': 0.7389143167501006}-{'f1_val': 0.701333785093376, 'auprc': 0.7999282251566288, 'loss_val': 0.6582418873822734, 'psi': 0.7407715611186771}
[S16] START round=7 head_norm_before_train=0.701400 cos_to_last_merge=1.0000 (last merge round=6)
[S16] round=7 local utility u=0.034094 metrics={'f1_val': 0.41467924219943564, 'auprc': 0.7057542438883214, 'loss_val': 1.166112341404815, 'psi': 0.53110924287499}-{'f1_val': 0.4144820245979186, 'auprc': 0.6953586491917084, 'loss_val': 1.2019301400888882, 'psi': 0.5268326744354346}
[S17] START round=7 head_norm_before_train=1.129446 cos_to_last_merge=0.9070 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.907
[S17] round=7 local utility u=0.096088 metrics={'f1_val': 0.3536207091334382, 'auprc': 0.7284583588928478, 'loss_val': 0.8892534570926426, 'psi': 0.503555769037202}-{'f1_val': 0.35332495072624465, 'auprc': 0.6582553676939176, 'loss_val': 0.8690462337445793, 'psi': 0.4752971175133138}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S7] → sending delta(kind=head bytes=1788) to S14@127.0.0.1:58314
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:58314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:58310
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:58307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:58312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:58316
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S14] → sending delta(kind=head bytes=1787) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:58308
[S4] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1794 to 1 peers)
[S5] sending update (kind=head size=1793 to 1 peers)
[S14] sending update (kind=head size=1787 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1788 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1787) from S14
[S5] cosine check vs S14: cos=-0.0271
[S5] DROPPED delta from S14 (cos=-0.0271 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1797) from S15
[S5] cosine check vs S15: cos=0.7147
[S5] RECEIVED delta(kind=head bytes=1797) from S10
[S5] cosine check vs S10: cos=0.9218
[S11] RECEIVED delta(kind=head bytes=1799) from S4
[S11] cosine check vs S4: cos=0.9138
[S5] RECEIVED delta(kind=head bytes=1799) from S2
[S5] cosine check vs S2: cos=-0.0246
[S5] DROPPED delta from S2 (cos=-0.0246 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1799) from S8
[S7] cosine check vs S8: cos=-0.0032
[S7] DROPPED delta from S8 (cos=-0.0032 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1795) from S9
[S14] cosine check vs S9: cos=-0.0849
[S14] DROPPED delta from S9 (cos=-0.0849 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1793) from S5
[S16] cosine check vs S5: cos=0.6992
[S14] RECEIVED delta(kind=head bytes=1788) from S7
[S14] cosine check vs S7: cos=0.9711
[S9] RECEIVED delta(kind=head bytes=1794) from S11
[S9] cosine check vs S11: cos=-0.1339
[S9] DROPPED delta from S11 (cos=-0.1339 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1802) from S16
[S6] cosine check vs S16: cos=-0.0381
[S6] DROPPED delta from S16 (cos=-0.0381 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S17] → sending delta(kind=head bytes=1786) to S9@127.0.0.1:58310
[S17] sending update (kind=head size=1786 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1786) from S17
[S9] cosine check vs S17: cos=0.3836
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=7 metric=0.4011 head_norm=1.235879
[S9] _apply_head_vector_avg (torch): Δ‖w‖=6.724839e-01
[S9] stored merged vector for next round verification (round=7)
[S9] DEBUG after merge:  round=7 metric=0.4160 head_norm=1.007081 delta_norm=0.672484
[S9] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=7 metric=0.1404 head_norm=0.948879
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.254880e-01
[S14] stored merged vector for next round verification (round=7)
[S14] DEBUG after merge:  round=7 metric=0.1404 head_norm=0.982014 delta_norm=0.125488
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=7 metric=0.4147 head_norm=0.732312
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.860175e-01
[S16] stored merged vector for next round verification (round=7)
[S16] DEBUG after merge:  round=7 metric=0.3266 head_norm=0.837655 delta_norm=0.386018
[S16] aggregate: ROLLBACK (f1_val pre=0.415 post=0.327 tol_abs=0.005 tol_rel=0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=7 metric=0.3942 head_norm=1.258917
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.660001e-01
[S11] stored merged vector for next round verification (round=7)
[S11] DEBUG after merge:  round=7 metric=0.5668 head_norm=1.435154 delta_norm=0.366000
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=7 metric=0.1423 head_norm=1.079383
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.373207e-01
[S5] stored merged vector for next round verification (round=7)
[S5] DEBUG after merge:  round=7 metric=0.1423 head_norm=1.108260 delta_norm=0.137321
[S5] aggregate: ACCEPT kept=['S15', 'S10'] (k=2/2) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=1.297879 cos_to_last_merge=0.9059 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.906
[S2] round=8 local utility u=0.076125 metrics={'f1_val': 0.7000157635183968, 'auprc': 0.8043689892502864, 'loss_val': 0.2890464193415941, 'psi': 0.7417570538111526}-{'f1_val': 0.7018318238212289, 'auprc': 0.7595424325091427, 'loss_val': 0.31771234444303603, 'psi': 0.7249160672963944}
[S3] START round=8 head_norm_before_train=1.352538 (no previous merge yet)
[S3] round=8 local utility u=0.225974 metrics={'f1_val': 0.4180943686865638, 'auprc': 0.9156717077824184, 'loss_val': 0.8099968236858318, 'psi': 0.6171253043249056}-{'f1_val': 0.39645225981545407, 'auprc': 0.8249895622970221, 'loss_val': 0.8600449895438246, 'psi': 0.5678671808080813}
[S4] START round=8 head_norm_before_train=1.674029 (no previous merge yet)
[S4] round=8 local utility u=0.000000 metrics={'f1_val': 0.6671434738142276, 'auprc': 0.9141450662364062, 'loss_val': 0.4856124456344668, 'psi': 0.7659441107830991}-{'f1_val': 0.9438918153726616, 'auprc': 0.9067923675439857, 'loss_val': 0.5444904448010234, 'psi': 0.9290520362411914}
[S5] START round=8 head_norm_before_train=1.108260 cos_to_last_merge=1.0000 (last merge round=7)
[S5] round=8 local utility u=0.866565 metrics={'f1_val': 0.41714700908202623, 'auprc': 0.7698737971454209, 'loss_val': 1.1190307796885175, 'psi': 0.5582377243073842}-{'f1_val': 0.14226190476190476, 'auprc': 0.7699266438748801, 'loss_val': 1.203008923812844, 'psi': 0.3933278004070949}
[S6] START round=8 head_norm_before_train=1.585524 (no previous merge yet)
[S6] round=8 local utility u=1.000000 metrics={'f1_val': 0.9460188022918724, 'auprc': 0.9706057956591678, 'loss_val': 0.34239185292098784, 'psi': 0.9558535996387906}-{'f1_val': 0.5855814265204023, 'auprc': 0.7904632617594556, 'loss_val': 0.5901077747961726, 'psi': 0.6675341606160237}
[S7] START round=8 head_norm_before_train=1.029478 cos_to_last_merge=0.9504 (last merge round=1)
[S7] round=8 local utility u=0.044244 metrics={'f1_val': 0.41711588266717814, 'auprc': 0.5752545066852448, 'loss_val': 0.94245364264204, 'psi': 0.48037133227440476}-{'f1_val': 0.41736073619820624, 'auprc': 0.5753864427257475, 'loss_val': 1.0328056708263695, 'psi': 0.4805710188092227}
[S8] START round=8 head_norm_before_train=1.166827 cos_to_last_merge=0.8973 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.897
[S8] round=8 local utility u=0.068097 metrics={'f1_val': 0.7138874667974482, 'auprc': 0.9968740169338541, 'loss_val': 0.24075966001449725, 'psi': 0.8270820868520106}-{'f1_val': 0.7138229449839267, 'auprc': 0.995986453943873, 'loss_val': 0.3739036324736327, 'psi': 0.8266883485679053}
[S9] START round=8 head_norm_before_train=1.007081 cos_to_last_merge=1.0000 (last merge round=7)
[S9] round=8 local utility u=0.570940 metrics={'f1_val': 0.6089481165082915, 'auprc': 0.9091404193590702, 'loss_val': 0.7695530256229344, 'psi': 0.7290250376486029}-{'f1_val': 0.40108602344511934, 'auprc': 0.9997523066022418, 'loss_val': 0.9360955042815294, 'psi': 0.6405525367079683}
[S10] START round=8 head_norm_before_train=1.515659 (no previous merge yet)
[S10] round=8 local utility u=0.036983 metrics={'f1_val': 0.6889449286227151, 'auprc': 0.998120987741094, 'loss_val': 0.3182025433770601, 'psi': 0.8126153522700666}-{'f1_val': 0.6888215669362565, 'auprc': 0.9959625586084233, 'loss_val': 0.38495279399071847, 'psi': 0.8116779636051232}
[S11] START round=8 head_norm_before_train=1.435154 cos_to_last_merge=1.0000 (last merge round=7)
[S11] round=8 local utility u=0.746039 metrics={'f1_val': 0.5685121121977557, 'auprc': 0.9502745104396776, 'loss_val': 0.7002680302110158, 'psi': 0.7212170714945244}-{'f1_val': 0.39421113913131656, 'auprc': 0.8291706625283477, 'loss_val': 0.7832293297732112, 'psi': 0.568194948490129}
[S13] START round=8 head_norm_before_train=1.509013 (no previous merge yet)
[S13] round=8 local utility u=0.000000 metrics={'f1_val': 0.6525594281911593, 'auprc': 0.6939317878591723, 'loss_val': 0.4843057693710104, 'psi': 0.6691083720583645}-{'f1_val': 0.7015157350165347, 'auprc': 0.6966984680074341, 'loss_val': 0.4903861710205833, 'psi': 0.6995888282128945}
[S14] START round=8 head_norm_before_train=0.982014 cos_to_last_merge=1.0000 (last merge round=7)
[S14] round=8 local utility u=0.811898 metrics={'f1_val': 0.39659360338126215, 'auprc': 0.8617353266757418, 'loss_val': 1.1230033207313999, 'psi': 0.582650292699054}-{'f1_val': 0.14035785288270378, 'auprc': 0.8595855078426318, 'loss_val': 1.2029357504620422, 'psi': 0.42804891486667496}
[S15] START round=8 head_norm_before_train=1.180494 cos_to_last_merge=0.8781 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.878
[S15] round=8 local utility u=0.039900 metrics={'f1_val': 0.6952066093249676, 'auprc': 0.8018853883440329, 'loss_val': 0.3956316078342491, 'psi': 0.7378781209325938}-{'f1_val': 0.6983640589803009, 'auprc': 0.7997397034048, 'loss_val': 0.4879399210821598, 'psi': 0.7389143167501006}
[S16] START round=8 head_norm_before_train=0.837655 cos_to_last_merge=1.0000 (last merge round=7)
[S16] round=8 local utility u=0.066143 metrics={'f1_val': 0.41546633441109837, 'auprc': 0.7281916979075771, 'loss_val': 1.10586191693473, 'psi': 0.5405564798096898}-{'f1_val': 0.41467924219943564, 'auprc': 0.7057542438883214, 'loss_val': 1.166112341404815, 'psi': 0.53110924287499}
[S17] START round=8 head_norm_before_train=1.185536 cos_to_last_merge=0.8902 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.890
[S17] round=8 local utility u=0.000000 metrics={'f1_val': 0.35228783858720547, 'auprc': 0.7095622860729885, 'loss_val': 0.9421999111168505, 'psi': 0.4951976175815187}-{'f1_val': 0.3536207091334382, 'auprc': 0.7284583588928478, 'loss_val': 0.8892534570926426, 'psi': 0.503555769037202}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:58310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S5] → sending delta(kind=head bytes=1789) to S16@127.0.0.1:58316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S14] → sending delta(kind=head bytes=1791) to S5@127.0.0.1:58305
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:58314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:58308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:58304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:58307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S7] → sending delta(kind=head bytes=1792) to S14@127.0.0.1:58314
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1791 to 1 peers)
[S7] sending update (kind=head size=1792 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1789 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1791) from S14
[S5] cosine check vs S14: cos=-0.0333
[S5] DROPPED delta from S14 (cos=-0.0333 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1799) from S6
[S4] cosine check vs S6: cos=-0.0978
[S4] DROPPED delta from S6 (cos=-0.0978 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1799) from S9
[S14] cosine check vs S9: cos=-0.0593
[S14] DROPPED delta from S9 (cos=-0.0593 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1792) from S7
[S14] cosine check vs S7: cos=0.9756
[S5] RECEIVED delta(kind=head bytes=1801) from S3
[S5] cosine check vs S3: cos=0.0027
[S5] RECEIVED delta(kind=head bytes=1800) from S2
[S5] cosine check vs S2: cos=-0.0210
[S5] DROPPED delta from S2 (cos=-0.0210 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1789) from S5
[S16] cosine check vs S5: cos=0.9069
[S6] RECEIVED delta(kind=head bytes=1799) from S16
[S6] cosine check vs S16: cos=-0.0320
[S6] DROPPED delta from S16 (cos=-0.0320 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1795) from S11
[S9] cosine check vs S11: cos=-0.1170
[S9] DROPPED delta from S11 (cos=-0.1170 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1798) from S10
[S5] cosine check vs S10: cos=0.9011
[S7] RECEIVED delta(kind=head bytes=1795) from S8
[S7] cosine check vs S8: cos=0.0025
[S5] RECEIVED delta(kind=head bytes=1799) from S15
[S5] cosine check vs S15: cos=0.7442
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=8 metric=0.4171 head_norm=1.126847
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.373749e-01
[S5] stored merged vector for next round verification (round=8)
[S5] DEBUG after merge:  round=8 metric=0.4173 head_norm=1.018734 delta_norm=0.237375
[S5] aggregate: ACCEPT kept=['S3', 'S10', 'S15'] (k=3/3) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=8 metric=0.4171 head_norm=1.063941
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.191999e-01
[S7] stored merged vector for next round verification (round=8)
[S7] DEBUG after merge:  round=8 metric=0.4169 head_norm=0.821258 delta_norm=0.819200
[S7] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=8 metric=0.3966 head_norm=1.004696
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.178806e-01
[S14] stored merged vector for next round verification (round=8)
[S14] DEBUG after merge:  round=8 metric=0.3966 head_norm=1.028006 delta_norm=0.117881
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=8 metric=0.4155 head_norm=0.852155
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.521516e-01
[S16] stored merged vector for next round verification (round=8)
[S16] DEBUG after merge:  round=8 metric=0.4153 head_norm=0.966642 delta_norm=0.252152
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=1.368363 cos_to_last_merge=0.8894 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.889
[S2] round=9 local utility u=0.000000 metrics={'f1_val': 0.7000157635183968, 'auprc': 0.7615317749740098, 'loss_val': 0.2932839448533199, 'psi': 0.724622168100642}-{'f1_val': 0.7000157635183968, 'auprc': 0.8043689892502864, 'loss_val': 0.2890464193415941, 'psi': 0.7417570538111526}
[S3] START round=9 head_norm_before_train=1.395442 (no previous merge yet)
[S3] round=9 local utility u=0.828063 metrics={'f1_val': 0.6200360232945852, 'auprc': 0.9974713977703256, 'loss_val': 0.6109202541451919, 'psi': 0.7710101730848813}-{'f1_val': 0.4180943686865638, 'auprc': 0.9156717077824184, 'loss_val': 0.8099968236858318, 'psi': 0.6171253043249056}
[S4] START round=9 head_norm_before_train=1.702177 (no previous merge yet)
[S4] round=9 local utility u=0.000000 metrics={'f1_val': 0.6221563045622086, 'auprc': 0.9315787632102607, 'loss_val': 0.5004490721011763, 'psi': 0.7459252880214294}-{'f1_val': 0.6671434738142276, 'auprc': 0.9141450662364062, 'loss_val': 0.4856124456344668, 'psi': 0.7659441107830991}
[S5] START round=9 head_norm_before_train=1.018734 cos_to_last_merge=1.0000 (last merge round=8)
[S5] round=9 local utility u=0.060270 metrics={'f1_val': 0.41782980503278466, 'auprc': 0.7775149585226069, 'loss_val': 1.0255110328511492, 'psi': 0.5617038664287135}-{'f1_val': 0.41714700908202623, 'auprc': 0.7698737971454209, 'loss_val': 1.1190307796885175, 'psi': 0.5582377243073842}
[S6] START round=9 head_norm_before_train=1.628588 (no previous merge yet)
[S6] round=9 local utility u=0.000000 metrics={'f1_val': 0.6793028957601435, 'auprc': 0.9666746152174348, 'loss_val': 0.374936803055896, 'psi': 0.79425158354306}-{'f1_val': 0.9460188022918724, 'auprc': 0.9706057956591678, 'loss_val': 0.34239185292098784, 'psi': 0.9558535996387906}
[S7] START round=9 head_norm_before_train=0.821258 cos_to_last_merge=1.0000 (last merge round=8)
[S7] round=9 local utility u=0.322875 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.7851184431263077, 'loss_val': 0.9238618553824377, 'psi': 0.5640734481171372}-{'f1_val': 0.41711588266717814, 'auprc': 0.5752545066852448, 'loss_val': 0.94245364264204, 'psi': 0.48037133227440476}
[S8] START round=9 head_norm_before_train=1.248653 cos_to_last_merge=0.8780 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.878
[S8] round=9 local utility u=0.894346 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.995954268414407, 'loss_val': 0.14320287380266208, 'psi': 0.9961035694058545}-{'f1_val': 0.7138874667974482, 'auprc': 0.9968740169338541, 'loss_val': 0.24075966001449725, 'psi': 0.8270820868520106}
[S9] START round=9 head_norm_before_train=1.045473 cos_to_last_merge=0.9961 (last merge round=7)
[S9] round=9 local utility u=0.525487 metrics={'f1_val': 0.7016148490515617, 'auprc': 0.9994081598091658, 'loss_val': 0.5453818073703465, 'psi': 0.8207321733546034}-{'f1_val': 0.6089481165082915, 'auprc': 0.9091404193590702, 'loss_val': 0.7695530256229344, 'psi': 0.7290250376486029}
[S10] START round=9 head_norm_before_train=1.570467 (no previous merge yet)
[S10] round=9 local utility u=0.077715 metrics={'f1_val': 0.6997590954597954, 'auprc': 0.9980376120119311, 'loss_val': 0.22740794640831855, 'psi': 0.8190705020806497}-{'f1_val': 0.6889449286227151, 'auprc': 0.998120987741094, 'loss_val': 0.3182025433770601, 'psi': 0.8126153522700666}
[S11] START round=9 head_norm_before_train=1.470014 cos_to_last_merge=0.9980 (last merge round=7)
[S11] round=9 local utility u=0.417130 metrics={'f1_val': 0.658179129112964, 'auprc': 0.9981899965604899, 'loss_val': 0.547756175424315, 'psi': 0.7941834760919744}-{'f1_val': 0.5685121121977557, 'auprc': 0.9502745104396776, 'loss_val': 0.7002680302110158, 'psi': 0.7212170714945244}
[S13] START round=9 head_norm_before_train=1.549971 (no previous merge yet)
[S13] round=9 local utility u=0.058535 metrics={'f1_val': 0.6727934422158097, 'auprc': 0.682903504952445, 'loss_val': 0.4555552200839152, 'psi': 0.6768374673104638}-{'f1_val': 0.6525594281911593, 'auprc': 0.6939317878591723, 'loss_val': 0.4843057693710104, 'psi': 0.6691083720583645}
[S14] START round=9 head_norm_before_train=1.028006 cos_to_last_merge=1.0000 (last merge round=8)
[S14] round=9 local utility u=0.173329 metrics={'f1_val': 0.39659360338126215, 'auprc': 0.9176599372804315, 'loss_val': 0.9441184929825159, 'psi': 0.6050201369409299}-{'f1_val': 0.39659360338126215, 'auprc': 0.8617353266757418, 'loss_val': 1.1230033207313999, 'psi': 0.582650292699054}
[S15] START round=9 head_norm_before_train=1.261849 cos_to_last_merge=0.8524 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.852
[S15] round=9 local utility u=0.869848 metrics={'f1_val': 0.8647174945289559, 'auprc': 0.9967952459646974, 'loss_val': 0.2577296541694039, 'psi': 0.9175485951032525}-{'f1_val': 0.6952066093249676, 'auprc': 0.8018853883440329, 'loss_val': 0.3956316078342491, 'psi': 0.7378781209325938}
[S16] START round=9 head_norm_before_train=0.966642 cos_to_last_merge=1.0000 (last merge round=8)
[S16] round=9 local utility u=0.000000 metrics={'f1_val': 0.4170026289119173, 'auprc': 0.5572212651799262, 'loss_val': 1.0223050827712479, 'psi': 0.47309008341912084}-{'f1_val': 0.41546633441109837, 'auprc': 0.7281916979075771, 'loss_val': 1.10586191693473, 'psi': 0.5405564798096898}
[S17] START round=9 head_norm_before_train=1.220232 cos_to_last_merge=0.8791 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.879
[S17] round=9 local utility u=0.108265 metrics={'f1_val': 0.3536207091334382, 'auprc': 0.7686986958895784, 'loss_val': 0.9110755686172313, 'psi': 0.5196519038358943}-{'f1_val': 0.35228783858720547, 'auprc': 0.7095622860729885, 'loss_val': 0.9421999111168505, 'psi': 0.4951976175815187}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:58316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:58305
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:58314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:58314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:58310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:58308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:58310
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1803 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1803) from S13
[S9] cosine check vs S13: cos=0.7324
[S9] RECEIVED delta(kind=head bytes=1797) from S11
[S9] cosine check vs S11: cos=-0.1135
[S9] DROPPED delta from S11 (cos=-0.1135 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1797) from S7
[S14] cosine check vs S7: cos=0.6384
[S7] RECEIVED delta(kind=head bytes=1798) from S8
[S7] cosine check vs S8: cos=0.7346
[S14] RECEIVED delta(kind=head bytes=1798) from S9
[S14] cosine check vs S9: cos=-0.0539
[S14] DROPPED delta from S9 (cos=-0.0539 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1799) from S5
[S16] cosine check vs S5: cos=0.9442
[S5] RECEIVED delta(kind=head bytes=1797) from S3
[S5] cosine check vs S3: cos=0.1613
[S5] RECEIVED delta(kind=head bytes=1798) from S15
[S5] cosine check vs S15: cos=0.7691
[S5] RECEIVED delta(kind=head bytes=1799) from S10
[S5] cosine check vs S10: cos=0.8607
[S5] RECEIVED delta(kind=head bytes=1795) from S14
[S5] cosine check vs S14: cos=-0.0297
[S5] DROPPED delta from S14 (cos=-0.0297 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:58310
[S17] sending update (kind=head size=1796 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1796) from S17
[S9] cosine check vs S17: cos=0.7940
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=9 metric=0.4167 head_norm=0.859910
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.535192e-01
[S7] stored merged vector for next round verification (round=9)
[S7] DEBUG after merge:  round=9 metric=0.4167 head_norm=1.021477 delta_norm=0.453519
[S7] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=9 metric=0.7016 head_norm=1.095933
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.709692e-01
[S9] stored merged vector for next round verification (round=9)
[S9] DEBUG after merge:  round=9 metric=0.7016 head_norm=1.098025 delta_norm=0.170969
[S9] aggregate: ACCEPT kept=['S13', 'S17'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=9 metric=0.3966 head_norm=1.055010
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.165585e-01
[S14] stored merged vector for next round verification (round=9)
[S14] DEBUG after merge:  round=9 metric=0.3966 head_norm=0.867597 delta_norm=0.416559
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=9 metric=0.4178 head_norm=1.044432
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.468270e-01
[S5] stored merged vector for next round verification (round=9)
[S5] DEBUG after merge:  round=9 metric=0.4179 head_norm=1.007485 delta_norm=0.146827
[S5] aggregate: ACCEPT kept=['S3', 'S15', 'S10'] (k=3/3) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=9 metric=0.4170 head_norm=0.975937
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.720255e-01
[S16] stored merged vector for next round verification (round=9)
[S16] DEBUG after merge:  round=9 metric=0.4448 head_norm=0.996019 delta_norm=0.172026
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=1.419155 cos_to_last_merge=0.8787 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.879
[S2] round=10 local utility u=0.049924 metrics={'f1_val': 0.6903999281214976, 'auprc': 0.8486601374263473, 'loss_val': 0.3971264278750191, 'psi': 0.7537040118434375}-{'f1_val': 0.7000157635183968, 'auprc': 0.7615317749740098, 'loss_val': 0.2932839448533199, 'psi': 0.724622168100642}
[S3] START round=10 head_norm_before_train=1.444642 (no previous merge yet)
[S3] round=10 local utility u=0.112562 metrics={'f1_val': 0.6414261683478719, 'auprc': 0.9943830658566488, 'loss_val': 0.5048718475975728, 'psi': 0.7826089273513827}-{'f1_val': 0.6200360232945852, 'auprc': 0.9974713977703256, 'loss_val': 0.6109202541451919, 'psi': 0.7710101730848813}
[S4] START round=10 head_norm_before_train=1.724925 (no previous merge yet)
[S4] round=10 local utility u=1.000000 metrics={'f1_val': 0.9463742940231116, 'auprc': 0.9400165285852484, 'loss_val': 0.40818198086717145, 'psi': 0.9438311878479664}-{'f1_val': 0.6221563045622086, 'auprc': 0.9315787632102607, 'loss_val': 0.5004490721011763, 'psi': 0.7459252880214294}
[S5] START round=10 head_norm_before_train=1.007485 cos_to_last_merge=1.0000 (last merge round=9)
[S5] round=10 local utility u=0.058487 metrics={'f1_val': 0.41750764008433106, 'auprc': 0.7858652704836717, 'loss_val': 0.9316559430636533, 'psi': 0.5648506922440673}-{'f1_val': 0.41782980503278466, 'auprc': 0.7775149585226069, 'loss_val': 1.0255110328511492, 'psi': 0.5617038664287135}
[S6] START round=10 head_norm_before_train=1.655478 (no previous merge yet)
[S6] round=10 local utility u=0.392680 metrics={'f1_val': 0.8181524665594343, 'auprc': 0.9559909130179238, 'loss_val': 0.3906238256773574, 'psi': 0.8732878451428301}-{'f1_val': 0.6793028957601435, 'auprc': 0.9666746152174348, 'loss_val': 0.374936803055896, 'psi': 0.79425158354306}
[S7] START round=10 head_norm_before_train=1.021477 cos_to_last_merge=1.0000 (last merge round=9)
[S7] round=10 local utility u=0.094740 metrics={'f1_val': 0.416587999573199, 'auprc': 0.844216482323098, 'loss_val': 0.9109434704726694, 'psi': 0.5876393926731586}-{'f1_val': 0.41671011811102343, 'auprc': 0.7851184431263077, 'loss_val': 0.9238618553824377, 'psi': 0.5640734481171372}
[S8] START round=10 head_norm_before_train=1.326177 cos_to_last_merge=0.8634 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.863
[S8] round=10 local utility u=0.022808 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9991066948814853, 'loss_val': 0.10704423006650673, 'psi': 0.9973645399926858}-{'f1_val': 0.9962031034001528, 'auprc': 0.995954268414407, 'loss_val': 0.14320287380266208, 'psi': 0.9961035694058545}
[S9] START round=10 head_norm_before_train=1.098025 cos_to_last_merge=1.0000 (last merge round=9)
[S9] round=10 local utility u=0.048564 metrics={'f1_val': 0.7013646677191758, 'auprc': 0.9984361518616308, 'loss_val': 0.4438359058565699, 'psi': 0.8201932613761578}-{'f1_val': 0.7016148490515617, 'auprc': 0.9994081598091658, 'loss_val': 0.5453818073703465, 'psi': 0.8207321733546034}
[S10] START round=10 head_norm_before_train=1.623410 (no previous merge yet)
[S10] round=10 local utility u=0.787169 metrics={'f1_val': 0.956721685528653, 'auprc': 0.9977578908399933, 'loss_val': 0.19400693551129392, 'psi': 0.9731361676531891}-{'f1_val': 0.6997590954597954, 'auprc': 0.9980376120119311, 'loss_val': 0.22740794640831855, 'psi': 0.8190705020806497}
[S11] START round=10 head_norm_before_train=1.508219 cos_to_last_merge=0.9936 (last merge round=7)
[S11] round=10 local utility u=0.184249 metrics={'f1_val': 0.7017589383281313, 'auprc': 0.9981395909014814, 'loss_val': 0.4405853097818424, 'psi': 0.8203111993574714}-{'f1_val': 0.658179129112964, 'auprc': 0.9981899965604899, 'loss_val': 0.547756175424315, 'psi': 0.7941834760919744}
[S13] START round=10 head_norm_before_train=1.585207 (no previous merge yet)
[S13] round=10 local utility u=0.000000 metrics={'f1_val': 0.628486603374252, 'auprc': 0.627758990685509, 'loss_val': 0.5525768225076326, 'psi': 0.6281955582987548}-{'f1_val': 0.6727934422158097, 'auprc': 0.682903504952445, 'loss_val': 0.4555552200839152, 'psi': 0.6768374673104638}
[S14] START round=10 head_norm_before_train=0.867597 cos_to_last_merge=1.0000 (last merge round=9)
[S14] round=10 local utility u=0.089203 metrics={'f1_val': 0.3958786349245693, 'auprc': 0.9658418154027344, 'loss_val': 0.9059679499065874, 'psi': 0.6238639071158354}-{'f1_val': 0.39659360338126215, 'auprc': 0.9176599372804315, 'loss_val': 0.9441184929825159, 'psi': 0.6050201369409299}
[S15] START round=10 head_norm_before_train=1.322699 cos_to_last_merge=0.8337 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.834
[S15] round=10 local utility u=0.000000 metrics={'f1_val': 0.6963943305154541, 'auprc': 0.8000781361803935, 'loss_val': 0.43578505359312986, 'psi': 0.7378678527814299}-{'f1_val': 0.8647174945289559, 'auprc': 0.9967952459646974, 'loss_val': 0.2577296541694039, 'psi': 0.9175485951032525}
[S16] START round=10 head_norm_before_train=0.996019 cos_to_last_merge=1.0000 (last merge round=9)
[S16] round=10 local utility u=0.363821 metrics={'f1_val': 0.43665791877571164, 'auprc': 0.7383929632121363, 'loss_val': 0.9561098879317057, 'psi': 0.5573519365502815}-{'f1_val': 0.4170026289119173, 'auprc': 0.5572212651799262, 'loss_val': 1.0223050827712479, 'psi': 0.47309008341912084}
[S17] START round=10 head_norm_before_train=1.241601 cos_to_last_merge=0.8707 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.871
[S17] round=10 local utility u=0.343685 metrics={'f1_val': 0.3892927687279527, 'auprc': 0.8521068864544846, 'loss_val': 0.6879619848124194, 'psi': 0.5744184158185655}-{'f1_val': 0.3536207091334382, 'auprc': 0.7686986958895784, 'loss_val': 0.9110755686172313, 'psi': 0.5196519038358943}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:58308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:58316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:58312
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:58314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S14] → sending delta(kind=head bytes=1789) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S6] → sending delta(kind=head bytes=1806) to S4@127.0.0.1:58304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:58314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] → sending delta(kind=head bytes=1793) to S9@127.0.0.1:58310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:58307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:58305
[S14] sending update (kind=head size=1789 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1793 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1806 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1793) from S11
[S9] cosine check vs S11: cos=-0.1145
[S9] DROPPED delta from S11 (cos=-0.1145 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1798) from S8
[S7] cosine check vs S8: cos=0.9370
[S4] RECEIVED delta(kind=head bytes=1806) from S6
[S4] cosine check vs S6: cos=-0.1046
[S4] DROPPED delta from S6 (cos=-0.1046 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1800) from S9
[S14] cosine check vs S9: cos=0.1707
[S6] RECEIVED delta(kind=head bytes=1796) from S16
[S6] cosine check vs S16: cos=-0.0250
[S6] DROPPED delta from S16 (cos=-0.0250 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1801) from S7
[S14] cosine check vs S7: cos=0.6062
[S16] RECEIVED delta(kind=head bytes=1799) from S5
[S16] cosine check vs S5: cos=0.9565
[S5] RECEIVED delta(kind=head bytes=1801) from S2
[S5] cosine check vs S2: cos=-0.0249
[S5] DROPPED delta from S2 (cos=-0.0249 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1789) from S14
[S5] cosine check vs S14: cos=-0.0059
[S5] DROPPED delta from S14 (cos=-0.0059 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1800) from S10
[S5] cosine check vs S10: cos=0.8303
[S5] RECEIVED delta(kind=head bytes=1802) from S3
[S5] cosine check vs S3: cos=0.2496
[S11] RECEIVED delta(kind=head bytes=1796) from S4
[S11] cosine check vs S4: cos=0.9481
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] → sending delta(kind=head bytes=1793) to S9@127.0.0.1:58310
[S17] sending update (kind=head size=1793 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1793) from S17
[S9] cosine check vs S17: cos=0.7624
[S13] ⇄ pheromone p=0.272 → S9@127.0.0.1:58310
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=10 metric=0.7014 head_norm=1.148266
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.188365e-01
[S9] stored merged vector for next round verification (round=10)
[S9] DEBUG after merge:  round=10 metric=0.7014 head_norm=1.131594 delta_norm=0.418837
[S9] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.384 → S14@127.0.0.1:58314
[S6] ⇄ pheromone p=0.448 → S4@127.0.0.1:58304
[S3] ⇄ pheromone p=0.403 → S5@127.0.0.1:58305
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=10 metric=0.4367 head_norm=1.009848
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.516480e-01
[S16] stored merged vector for next round verification (round=10)
[S16] DEBUG after merge:  round=10 metric=0.3881 head_norm=1.012377 delta_norm=0.151648
[S16] aggregate: ROLLBACK (f1_val pre=0.437 post=0.388 tol_abs=0.005 tol_rel=0.0)
[S16] ⇄ pheromone p=0.291 → S6@127.0.0.1:58307
[S8] ⇄ pheromone p=0.426 → S7@127.0.0.1:58308
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=10 metric=0.4166 head_norm=1.051910
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.743004e-01
[S7] stored merged vector for next round verification (round=10)
[S7] DEBUG after merge:  round=10 metric=0.4166 head_norm=1.203511 delta_norm=0.274300
[S7] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.264 → S14@127.0.0.1:58314
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=10 metric=0.7018 head_norm=1.546146
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.866002e-01
[S11] stored merged vector for next round verification (round=10)
[S11] DEBUG after merge:  round=10 metric=0.7018 head_norm=1.632038 delta_norm=0.286600
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.408 → S9@127.0.0.1:58310
[S4] ⇄ pheromone p=0.478 → S11@127.0.0.1:58312
[S2] ⇄ pheromone p=0.262 → S5@127.0.0.1:58305
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=10 metric=0.3959 head_norm=0.900080
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.084547e-01
[S14] stored merged vector for next round verification (round=10)
[S14] DEBUG after merge:  round=10 metric=0.3959 head_norm=0.796074 delta_norm=0.508455
[S14] aggregate: ACCEPT kept=['S9', 'S7'] (k=2/2) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.291 → S5@127.0.0.1:58305
[S10] ⇄ pheromone p=0.429 → S5@127.0.0.1:58305
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=10 metric=0.4175 head_norm=1.037311
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.687200e-01
[S5] stored merged vector for next round verification (round=10)
[S5] DEBUG after merge:  round=10 metric=0.4183 head_norm=1.024267 delta_norm=0.368720
[S5] aggregate: ACCEPT kept=['S10', 'S3'] (k=2/2) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.249 → S16@127.0.0.1:58316
[S15] ⇄ pheromone p=0.400 → S5@127.0.0.1:58305
[S17] ⇄ pheromone p=0.267 → S9@127.0.0.1:58310
[S2] START round=11 head_norm_before_train=1.456299 cos_to_last_merge=0.8741 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.874
[S2] round=11 local utility u=0.072423 metrics={'f1_val': 0.7018318238212289, 'auprc': 0.8311311904534708, 'loss_val': 0.2682844502339999, 'psi': 0.7535515704741257}-{'f1_val': 0.6903999281214976, 'auprc': 0.8486601374263473, 'loss_val': 0.3971264278750191, 'psi': 0.7537040118434375}
[S3] START round=11 head_norm_before_train=1.498542 (no previous merge yet)
[S3] round=11 local utility u=0.000000 metrics={'f1_val': 0.5773826823901724, 'auprc': 0.9915419126431207, 'loss_val': 0.5167289937184281, 'psi': 0.7430463744913518}-{'f1_val': 0.6414261683478719, 'auprc': 0.9943830658566488, 'loss_val': 0.5048718475975728, 'psi': 0.7826089273513827}
[S4] START round=11 head_norm_before_train=1.760911 (no previous merge yet)
[S4] round=11 local utility u=0.000000 metrics={'f1_val': 0.6480288933099748, 'auprc': 0.9485709474429556, 'loss_val': 0.4744936124029205, 'psi': 0.7682457149631672}-{'f1_val': 0.9463742940231116, 'auprc': 0.9400165285852484, 'loss_val': 0.40818198086717145, 'psi': 0.9438311878479664}
[S5] START round=11 head_norm_before_train=1.024267 cos_to_last_merge=1.0000 (last merge round=10)
[S5] round=11 local utility u=0.047211 metrics={'f1_val': 0.4181537288170242, 'auprc': 0.7948791769953794, 'loss_val': 0.8681513954384212, 'psi': 0.5688439080883663}-{'f1_val': 0.41750764008433106, 'auprc': 0.7858652704836717, 'loss_val': 0.9316559430636533, 'psi': 0.5648506922440673}
[S6] START round=11 head_norm_before_train=1.686512 (no previous merge yet)
[S6] round=11 local utility u=0.053754 metrics={'f1_val': 0.8247671332321301, 'auprc': 0.9658851408849461, 'loss_val': 0.3524861670196932, 'psi': 0.8812143362932565}-{'f1_val': 0.8181524665594343, 'auprc': 0.9559909130179238, 'loss_val': 0.3906238256773574, 'psi': 0.8732878451428301}
[S7] START round=11 head_norm_before_train=1.203511 cos_to_last_merge=1.0000 (last merge round=10)
[S7] round=11 local utility u=0.016470 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.8496968074605763, 'loss_val': 0.8951775506867168, 'psi': 0.5899047938508446}-{'f1_val': 0.416587999573199, 'auprc': 0.844216482323098, 'loss_val': 0.9109434704726694, 'psi': 0.5876393926731586}
[S8] START round=11 head_norm_before_train=1.393142 cos_to_last_merge=0.8525 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.853
[S8] round=11 local utility u=0.004211 metrics={'f1_val': 0.993632801855294, 'auprc': 0.9991080398715795, 'loss_val': 0.08320490692507694, 'psi': 0.9958228970618083}-{'f1_val': 0.9962031034001528, 'auprc': 0.9991066948814853, 'loss_val': 0.10704423006650673, 'psi': 0.9973645399926858}
[S9] START round=11 head_norm_before_train=1.131594 cos_to_last_merge=1.0000 (last merge round=10)
[S9] round=11 local utility u=0.017342 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9982249369495599, 'loss_val': 0.40807406358182596, 'psi': 0.820064264904362}-{'f1_val': 0.7013646677191758, 'auprc': 0.9984361518616308, 'loss_val': 0.4438359058565699, 'psi': 0.8201932613761578}
[S10] START round=11 head_norm_before_train=1.669967 (no previous merge yet)
[S10] round=11 local utility u=0.092892 metrics={'f1_val': 0.9935087630340739, 'auprc': 0.9941498907226874, 'loss_val': 0.2181217130985448, 'psi': 0.9937652141095193}-{'f1_val': 0.956721685528653, 'auprc': 0.9977578908399933, 'loss_val': 0.19400693551129392, 'psi': 0.9731361676531891}
[S11] START round=11 head_norm_before_train=1.632038 cos_to_last_merge=1.0000 (last merge round=10)
[S11] round=11 local utility u=0.021947 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9974869544198018, 'loss_val': 0.39579078216468233, 'psi': 0.8201559717469128}-{'f1_val': 0.7017589383281313, 'auprc': 0.9981395909014814, 'loss_val': 0.4405853097818424, 'psi': 0.8203111993574714}
[S13] START round=11 head_norm_before_train=1.622448 (no previous merge yet)
[S13] round=11 local utility u=0.189999 metrics={'f1_val': 0.6591189915765294, 'auprc': 0.6716931608724399, 'loss_val': 0.4881766299413348, 'psi': 0.6641486592948936}-{'f1_val': 0.628486603374252, 'auprc': 0.627758990685509, 'loss_val': 0.5525768225076326, 'psi': 0.6281955582987548}
[S14] START round=11 head_norm_before_train=0.796074 cos_to_last_merge=1.0000 (last merge round=10)
[S14] round=11 local utility u=0.046708 metrics={'f1_val': 0.39608194131646324, 'auprc': 0.9970928457058507, 'loss_val': 0.9075256571361418, 'psi': 0.6364863030722182}-{'f1_val': 0.3958786349245693, 'auprc': 0.9658418154027344, 'loss_val': 0.9059679499065874, 'psi': 0.6238639071158354}
[S15] START round=11 head_norm_before_train=1.366260 cos_to_last_merge=0.8226 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.823
[S15] round=11 local utility u=0.000000 metrics={'f1_val': 0.6979708147255003, 'auprc': 0.7995371965338708, 'loss_val': 0.5044333862175472, 'psi': 0.7385973674488485}-{'f1_val': 0.6963943305154541, 'auprc': 0.8000781361803935, 'loss_val': 0.43578505359312986, 'psi': 0.7378678527814299}
[S16] START round=11 head_norm_before_train=1.012377 cos_to_last_merge=1.0000 (last merge round=10)
[S16] round=11 local utility u=0.000000 metrics={'f1_val': 0.3699990698187714, 'auprc': 0.7423481794778967, 'loss_val': 0.9432491571456294, 'psi': 0.5189387136824215}-{'f1_val': 0.43665791877571164, 'auprc': 0.7383929632121363, 'loss_val': 0.9561098879317057, 'psi': 0.5573519365502815}
[S17] START round=11 head_norm_before_train=1.262277 cos_to_last_merge=0.8624 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.862
[S17] round=11 local utility u=0.000000 metrics={'f1_val': 0.35243828617822603, 'auprc': 0.7609439604335433, 'loss_val': 0.9056847714590919, 'psi': 0.5158405558803529}-{'f1_val': 0.3892927687279527, 'auprc': 0.8521068864544846, 'loss_val': 0.6879619848124194, 'psi': 0.5744184158185655}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:58310
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:58310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:58314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] → sending delta(kind=head bytes=1794) to S4@127.0.0.1:58304
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:58308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:58316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:58305
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:58314
[S9] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1793 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1794 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1794 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1794) from S11
[S9] cosine check vs S11: cos=-0.0856
[S9] DROPPED delta from S11 (cos=-0.0856 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1801) from S8
[S7] cosine check vs S8: cos=0.9752
[S9] RECEIVED delta(kind=head bytes=1798) from S13
[S9] cosine check vs S13: cos=0.5438
[S5] RECEIVED delta(kind=head bytes=1803) from S14
[S5] cosine check vs S14: cos=0.0469
[S5] RECEIVED delta(kind=head bytes=1799) from S2
[S5] cosine check vs S2: cos=-0.0434
[S5] DROPPED delta from S2 (cos=-0.0434 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1794) from S6
[S4] cosine check vs S6: cos=-0.1068
[S4] DROPPED delta from S6 (cos=-0.1068 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1801) from S7
[S14] cosine check vs S7: cos=0.7955
[S14] RECEIVED delta(kind=head bytes=1796) from S9
[S14] cosine check vs S9: cos=0.6461
[S16] RECEIVED delta(kind=head bytes=1793) from S5
[S16] cosine check vs S5: cos=0.9132
[S5] RECEIVED delta(kind=head bytes=1795) from S10
[S5] cosine check vs S10: cos=0.8421
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=11 metric=0.4182 head_norm=1.056223
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.487951e-01
[S5] stored merged vector for next round verification (round=11)
[S5] DEBUG after merge:  round=11 metric=0.4182 head_norm=0.948244 delta_norm=0.348795
[S5] aggregate: ACCEPT kept=['S14', 'S10'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=11 metric=0.3961 head_norm=0.824953
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.473025e-01
[S14] stored merged vector for next round verification (round=11)
[S14] DEBUG after merge:  round=11 metric=0.6230 head_norm=0.915482 delta_norm=0.347303
[S14] aggregate: ACCEPT kept=['S7', 'S9'] (k=2/2) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=11 metric=0.4167 head_norm=1.228716
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.840832e-01
[S7] stored merged vector for next round verification (round=11)
[S7] DEBUG after merge:  round=11 metric=0.4167 head_norm=1.329457 delta_norm=0.184083
[S7] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=11 metric=0.7013 head_norm=1.179371
[S9] _apply_head_vector_avg (torch): Δ‖w‖=7.066444e-01
[S9] stored merged vector for next round verification (round=11)
[S9] DEBUG after merge:  round=11 metric=0.7013 head_norm=1.248085 delta_norm=0.706644
[S9] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=11 metric=0.3700 head_norm=1.032921
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.178762e-01
[S16] stored merged vector for next round verification (round=11)
[S16] DEBUG after merge:  round=11 metric=0.4984 head_norm=1.021663 delta_norm=0.217876
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.486631 cos_to_last_merge=0.8710 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.871
[S2] round=12 local utility u=0.010598 metrics={'f1_val': 0.7018318238212289, 'auprc': 0.8354859225498162, 'loss_val': 0.26015358815626044, 'psi': 0.7552934633126638}-{'f1_val': 0.7018318238212289, 'auprc': 0.8311311904534708, 'loss_val': 0.2682844502339999, 'psi': 0.7535515704741257}
[S3] START round=12 head_norm_before_train=1.548531 (no previous merge yet)
[S3] round=12 local utility u=0.426090 metrics={'f1_val': 0.6932594429814481, 'auprc': 0.9926806138847699, 'loss_val': 0.3632261725967061, 'psi': 0.8130279113427769}-{'f1_val': 0.5773826823901724, 'auprc': 0.9915419126431207, 'loss_val': 0.5167289937184281, 'psi': 0.7430463744913518}
[S4] START round=12 head_norm_before_train=1.785646 (no previous merge yet)
[S4] round=12 local utility u=1.000000 metrics={'f1_val': 0.9511914436335676, 'auprc': 0.9614978910708887, 'loss_val': 0.2757098138375641, 'psi': 0.9553140226084961}-{'f1_val': 0.6480288933099748, 'auprc': 0.9485709474429556, 'loss_val': 0.4744936124029205, 'psi': 0.7682457149631672}
[S5] START round=12 head_norm_before_train=0.948244 cos_to_last_merge=1.0000 (last merge round=11)
[S5] round=12 local utility u=0.918109 metrics={'f1_val': 0.7100677826452233, 'auprc': 0.7952523921839217, 'loss_val': 0.7845379372779545, 'psi': 0.7441416264607027}-{'f1_val': 0.4181537288170242, 'auprc': 0.7948791769953794, 'loss_val': 0.8681513954384212, 'psi': 0.5688439080883663}
[S6] START round=12 head_norm_before_train=1.713973 (no previous merge yet)
[S6] round=12 local utility u=0.000000 metrics={'f1_val': 0.7153994025017955, 'auprc': 0.8260519304532179, 'loss_val': 0.5808152791103702, 'psi': 0.7596604136823644}-{'f1_val': 0.8247671332321301, 'auprc': 0.9658851408849461, 'loss_val': 0.3524861670196932, 'psi': 0.8812143362932565}
[S7] START round=12 head_norm_before_train=1.329457 cos_to_last_merge=1.0000 (last merge round=11)
[S7] round=12 local utility u=0.000000 metrics={'f1_val': 0.41650694526510673, 'auprc': 0.802395740645276, 'loss_val': 0.8673284904633404, 'psi': 0.5708624634171744}-{'f1_val': 0.41671011811102343, 'auprc': 0.8496968074605763, 'loss_val': 0.8951775506867168, 'psi': 0.5899047938508446}
[S8] START round=12 head_norm_before_train=1.446701 cos_to_last_merge=0.8451 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.845
[S8] round=12 local utility u=0.008720 metrics={'f1_val': 0.9939988207001527, 'auprc': 0.9991098747966768, 'loss_val': 0.06796737093747758, 'psi': 0.9960432423387624}-{'f1_val': 0.993632801855294, 'auprc': 0.9991080398715795, 'loss_val': 0.08320490692507694, 'psi': 0.9958228970618083}
[S9] START round=12 head_norm_before_train=1.248085 cos_to_last_merge=1.0000 (last merge round=11)
[S9] round=12 local utility u=0.020592 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9979538381409538, 'loss_val': 0.36607766691862725, 'psi': 0.8199558253809196}-{'f1_val': 0.7012904835408967, 'auprc': 0.9982249369495599, 'loss_val': 0.40807406358182596, 'psi': 0.820064264904362}
[S10] START round=12 head_norm_before_train=1.702475 (no previous merge yet)
[S10] round=12 local utility u=0.068217 metrics={'f1_val': 0.9962271198535898, 'auprc': 0.9972655369722498, 'loss_val': 0.10734469608229659, 'psi': 0.9966424867010538}-{'f1_val': 0.9935087630340739, 'auprc': 0.9941498907226874, 'loss_val': 0.2181217130985448, 'psi': 0.9937652141095193}
[S11] START round=12 head_norm_before_train=1.669013 cos_to_last_merge=0.9993 (last merge round=10)
[S11] round=12 local utility u=0.044576 metrics={'f1_val': 0.7020007759458987, 'auprc': 0.9986374138902727, 'loss_val': 0.3104819164866536, 'psi': 0.8206554311236482}-{'f1_val': 0.7019353166316534, 'auprc': 0.9974869544198018, 'loss_val': 0.39579078216468233, 'psi': 0.8201559717469128}
[S13] START round=12 head_norm_before_train=1.650214 (no previous merge yet)
[S13] round=12 local utility u=0.000000 metrics={'f1_val': 0.6279509878869279, 'auprc': 0.6166223445402733, 'loss_val': 0.6268325084279711, 'psi': 0.623419530548266}-{'f1_val': 0.6591189915765294, 'auprc': 0.6716931608724399, 'loss_val': 0.4881766299413348, 'psi': 0.6641486592948936}
[S14] START round=12 head_norm_before_train=0.915482 cos_to_last_merge=1.0000 (last merge round=11)
[S14] round=12 local utility u=0.000000 metrics={'f1_val': 0.39659360338126215, 'auprc': 0.98559381719105, 'loss_val': 0.8923014403632762, 'psi': 0.6321936889051772}-{'f1_val': 0.39608194131646324, 'auprc': 0.9970928457058507, 'loss_val': 0.9075256571361418, 'psi': 0.6364863030722182}
[S15] START round=12 head_norm_before_train=1.412763 cos_to_last_merge=0.8142 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.814
[S15] round=12 local utility u=0.767841 metrics={'f1_val': 0.8323711891943383, 'auprc': 0.9604357109722614, 'loss_val': 0.25785006812443584, 'psi': 0.8835969979055076}-{'f1_val': 0.6979708147255003, 'auprc': 0.7995371965338708, 'loss_val': 0.5044333862175472, 'psi': 0.7385973674488485}
[S16] START round=12 head_norm_before_train=1.021663 cos_to_last_merge=1.0000 (last merge round=11)
[S16] round=12 local utility u=0.161001 metrics={'f1_val': 0.4085847526583759, 'auprc': 0.7510876218353589, 'loss_val': 0.8789800367409425, 'psi': 0.5455859003291692}-{'f1_val': 0.3699990698187714, 'auprc': 0.7423481794778967, 'loss_val': 0.9432491571456294, 'psi': 0.5189387136824215}
[S17] START round=12 head_norm_before_train=1.277935 cos_to_last_merge=0.8570 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.857
[S17] round=12 local utility u=0.123325 metrics={'f1_val': 0.39090151401213213, 'auprc': 0.7376117561406941, 'loss_val': 0.8198173287746827, 'psi': 0.5295856108635568}-{'f1_val': 0.35243828617822603, 'auprc': 0.7609439604335433, 'loss_val': 0.9056847714590919, 'psi': 0.5158405558803529}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:58307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S11] → sending delta(kind=head bytes=1807) to S9@127.0.0.1:58310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:58312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:58314
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:58316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:58308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:58305
[S8] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1804 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1807 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1794 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1807) from S11
[S9] cosine check vs S11: cos=-0.1252
[S9] DROPPED delta from S11 (cos=-0.1252 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1798) from S8
[S7] cosine check vs S8: cos=0.9854
[S16] RECEIVED delta(kind=head bytes=1796) from S5
[S16] cosine check vs S5: cos=0.9436
[S14] RECEIVED delta(kind=head bytes=1802) from S9
[S14] cosine check vs S9: cos=0.6797
[S5] RECEIVED delta(kind=head bytes=1794) from S2
[S5] cosine check vs S2: cos=-0.0235
[S5] DROPPED delta from S2 (cos=-0.0235 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1801) from S4
[S11] cosine check vs S4: cos=0.9762
[S6] RECEIVED delta(kind=head bytes=1796) from S16
[S6] cosine check vs S16: cos=-0.0296
[S6] DROPPED delta from S16 (cos=-0.0296 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1804) from S3
[S5] cosine check vs S3: cos=0.2796
[S5] RECEIVED delta(kind=head bytes=1802) from S15
[S5] cosine check vs S15: cos=0.4930
[S5] RECEIVED delta(kind=head bytes=1796) from S10
[S5] cosine check vs S10: cos=0.9237
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:58310
[S17] sending update (kind=head size=1794 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1794) from S17
[S9] cosine check vs S17: cos=0.6097
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=12 metric=0.4165 head_norm=1.354350
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.380022e-01
[S7] stored merged vector for next round verification (round=12)
[S7] DEBUG after merge:  round=12 metric=0.4165 head_norm=1.415154 delta_norm=0.138002
[S7] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=12 metric=0.3966 head_norm=0.938515
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.756691e-01
[S14] stored merged vector for next round verification (round=12)
[S14] DEBUG after merge:  round=12 metric=0.6235 head_norm=1.025672 delta_norm=0.475669
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=12 metric=0.7101 head_norm=0.986681
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.513389e-01
[S5] stored merged vector for next round verification (round=12)
[S5] DEBUG after merge:  round=12 metric=0.7025 head_norm=1.000536 delta_norm=0.251339
[S5] aggregate: ROLLBACK (f1_val pre=0.710 post=0.702 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=12 metric=0.4086 head_norm=1.050811
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.740136e-01
[S16] stored merged vector for next round verification (round=12)
[S16] DEBUG after merge:  round=12 metric=0.4239 head_norm=1.004286 delta_norm=0.174014
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=12 metric=0.7020 head_norm=1.709538
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.986046e-01
[S11] stored merged vector for next round verification (round=12)
[S11] DEBUG after merge:  round=12 metric=0.7019 head_norm=1.749443 delta_norm=0.198605
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=12 metric=0.7013 head_norm=1.294495
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.717925e-01
[S9] stored merged vector for next round verification (round=12)
[S9] DEBUG after merge:  round=12 metric=0.7013 head_norm=1.161206 delta_norm=0.571792
[S9] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.513014 cos_to_last_merge=0.8666 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.867
[S2] round=13 local utility u=0.410296 metrics={'f1_val': 0.8335805163903267, 'auprc': 0.8397509322128148, 'loss_val': 0.24284895870508846, 'psi': 0.836048682719322}-{'f1_val': 0.7018318238212289, 'auprc': 0.8354859225498162, 'loss_val': 0.26015358815626044, 'psi': 0.7552934633126638}
[S3] START round=13 head_norm_before_train=1.587764 (no previous merge yet)
[S3] round=13 local utility u=0.049819 metrics={'f1_val': 0.700330919019862, 'auprc': 0.9941653772884553, 'loss_val': 0.31047034364985465, 'psi': 0.8178647023272994}-{'f1_val': 0.6932594429814481, 'auprc': 0.9926806138847699, 'loss_val': 0.3632261725967061, 'psi': 0.8130279113427769}
[S4] START round=13 head_norm_before_train=1.810378 (no previous merge yet)
[S4] round=13 local utility u=0.000000 metrics={'f1_val': 0.9392705627538339, 'auprc': 0.9382534063890349, 'loss_val': 0.27133246206219974, 'psi': 0.9388637002079143}-{'f1_val': 0.9511914436335676, 'auprc': 0.9614978910708887, 'loss_val': 0.2757098138375641, 'psi': 0.9553140226084961}
[S5] START round=13 head_norm_before_train=1.000536 cos_to_last_merge=1.0000 (last merge round=12)
[S5] round=13 local utility u=0.012816 metrics={'f1_val': 0.7008162875368863, 'auprc': 0.7948310373119385, 'loss_val': 0.7021326392616029, 'psi': 0.7384221874469072}-{'f1_val': 0.7100677826452233, 'auprc': 0.7952523921839217, 'loss_val': 0.7845379372779545, 'psi': 0.7441416264607027}
[S6] START round=13 head_norm_before_train=1.743633 (no previous merge yet)
[S6] round=13 local utility u=0.640361 metrics={'f1_val': 0.824161471344169, 'auprc': 0.9617038181737525, 'loss_val': 0.3596204205410307, 'psi': 0.8791784100760023}-{'f1_val': 0.7153994025017955, 'auprc': 0.8260519304532179, 'loss_val': 0.5808152791103702, 'psi': 0.7596604136823644}
[S7] START round=13 head_norm_before_train=1.415154 cos_to_last_merge=1.0000 (last merge round=12)
[S7] round=13 local utility u=0.053036 metrics={'f1_val': 0.416587999573199, 'auprc': 0.8313478680625082, 'loss_val': 0.8485994887023587, 'psi': 0.5824919469689227}-{'f1_val': 0.41650694526510673, 'auprc': 0.802395740645276, 'loss_val': 0.8673284904633404, 'psi': 0.5708624634171744}
[S8] START round=13 head_norm_before_train=1.486320 cos_to_last_merge=0.8404 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.840
[S8] round=13 local utility u=0.000000 metrics={'f1_val': 0.9934886015238295, 'auprc': 0.9956517458453972, 'loss_val': 0.06658817823378416, 'psi': 0.9943538592524566}-{'f1_val': 0.9939988207001527, 'auprc': 0.9991098747966768, 'loss_val': 0.06796737093747758, 'psi': 0.9960432423387624}
[S9] START round=13 head_norm_before_train=1.161206 cos_to_last_merge=1.0000 (last merge round=12)
[S9] round=13 local utility u=0.005013 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.997843012097253, 'loss_val': 0.35571893760513396, 'psi': 0.8199114949634393}-{'f1_val': 0.7012904835408967, 'auprc': 0.9979538381409538, 'loss_val': 0.36607766691862725, 'psi': 0.8199558253809196}
[S10] START round=13 head_norm_before_train=1.732864 (no previous merge yet)
[S10] round=13 local utility u=0.005312 metrics={'f1_val': 0.9955429473180637, 'auprc': 0.997553481079122, 'loss_val': 0.09347928584828256, 'psi': 0.996347160822487}-{'f1_val': 0.9962271198535898, 'auprc': 0.9972655369722498, 'loss_val': 0.10734469608229659, 'psi': 0.9966424867010538}
[S11] START round=13 head_norm_before_train=1.749443 cos_to_last_merge=1.0000 (last merge round=12)
[S11] round=13 local utility u=0.015665 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9985253058635043, 'loss_val': 0.27697099361084077, 'psi': 0.8204262100975566}-{'f1_val': 0.7020007759458987, 'auprc': 0.9986374138902727, 'loss_val': 0.3104819164866536, 'psi': 0.8206554311236482}
[S13] START round=13 head_norm_before_train=1.669878 (no previous merge yet)
[S13] round=13 local utility u=0.294573 metrics={'f1_val': 0.6699276433208331, 'auprc': 0.6787110645977691, 'loss_val': 0.47581189972397897, 'psi': 0.6734410118316074}-{'f1_val': 0.6279509878869279, 'auprc': 0.6166223445402733, 'loss_val': 0.6268325084279711, 'psi': 0.623419530548266}
[S14] START round=13 head_norm_before_train=1.025672 cos_to_last_merge=1.0000 (last merge round=12)
[S14] round=13 local utility u=1.000000 metrics={'f1_val': 0.7816434133051319, 'auprc': 0.9955233863860995, 'loss_val': 0.793181532536096, 'psi': 0.8671954025375189}-{'f1_val': 0.39659360338126215, 'auprc': 0.98559381719105, 'loss_val': 0.8923014403632762, 'psi': 0.6321936889051772}
[S15] START round=13 head_norm_before_train=1.460214 cos_to_last_merge=0.8065 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.806
[S15] round=13 local utility u=0.598442 metrics={'f1_val': 0.9911236827670269, 'auprc': 0.9934352782034191, 'loss_val': 0.1124801197866389, 'psi': 0.9920483209415838}-{'f1_val': 0.8323711891943383, 'auprc': 0.9604357109722614, 'loss_val': 0.25785006812443584, 'psi': 0.8835969979055076}
[S16] START round=13 head_norm_before_train=1.004286 cos_to_last_merge=1.0000 (last merge round=12)
[S16] round=13 local utility u=0.235745 metrics={'f1_val': 0.459014912163091, 'auprc': 0.7791980347893118, 'loss_val': 0.7944014952987732, 'psi': 0.5870881612135793}-{'f1_val': 0.4085847526583759, 'auprc': 0.7510876218353589, 'loss_val': 0.8789800367409425, 'psi': 0.5455859003291692}
[S17] START round=13 head_norm_before_train=1.294209 cos_to_last_merge=0.8531 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.853
[S17] round=13 local utility u=0.492897 metrics={'f1_val': 0.4178634959059794, 'auprc': 0.9288977483713805, 'loss_val': 0.5696540927712682, 'psi': 0.6222771968921399}-{'f1_val': 0.39090151401213213, 'auprc': 0.7376117561406941, 'loss_val': 0.8198173287746827, 'psi': 0.5295856108635568}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:58304
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:58314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S16] → sending delta(kind=head bytes=1791) to S6@127.0.0.1:58307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] → sending delta(kind=head bytes=1805) to S14@127.0.0.1:58314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:58310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:58316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:58310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:58305
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S14] → sending delta(kind=head bytes=1787) to S5@127.0.0.1:58305
[S7] sending update (kind=head size=1805 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1787 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1791 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1798) from S10
[S5] cosine check vs S10: cos=0.8695
[S5] RECEIVED delta(kind=head bytes=1787) from S14
[S5] cosine check vs S14: cos=0.1699
[S5] RECEIVED delta(kind=head bytes=1800) from S3
[S5] cosine check vs S3: cos=0.3393
[S6] RECEIVED delta(kind=head bytes=1791) from S16
[S6] cosine check vs S16: cos=-0.0251
[S6] DROPPED delta from S16 (cos=-0.0251 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1797) from S11
[S9] cosine check vs S11: cos=-0.0989
[S9] DROPPED delta from S11 (cos=-0.0989 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1798) from S2
[S5] cosine check vs S2: cos=-0.0177
[S5] DROPPED delta from S2 (cos=-0.0177 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1799) from S13
[S9] cosine check vs S13: cos=0.6437
[S14] RECEIVED delta(kind=head bytes=1805) from S7
[S14] cosine check vs S7: cos=0.7361
[S14] RECEIVED delta(kind=head bytes=1798) from S9
[S14] cosine check vs S9: cos=0.9152
[S4] RECEIVED delta(kind=head bytes=1798) from S6
[S4] cosine check vs S6: cos=-0.1121
[S4] DROPPED delta from S6 (cos=-0.1121 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1795) from S5
[S16] cosine check vs S5: cos=0.9776
[S5] RECEIVED delta(kind=head bytes=1802) from S15
[S5] cosine check vs S15: cos=0.6509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:58310
[S17] sending update (kind=head size=1801 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1801) from S17
[S9] cosine check vs S17: cos=0.8855
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=13 metric=0.7816 head_norm=1.044264
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.788079e-01
[S14] stored merged vector for next round verification (round=13)
[S14] DEBUG after merge:  round=13 metric=0.6489 head_norm=1.098667 delta_norm=0.278808
[S14] aggregate: ROLLBACK (f1_val pre=0.782 post=0.649 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=13 metric=0.7013 head_norm=1.206443
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.954315e-01
[S9] stored merged vector for next round verification (round=13)
[S9] DEBUG after merge:  round=13 metric=0.7013 head_norm=1.183130 delta_norm=0.195432
[S9] aggregate: ACCEPT kept=['S13', 'S17'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=4 kept=4 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=13 metric=0.7008 head_norm=1.037532
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.096764e-01
[S5] stored merged vector for next round verification (round=13)
[S5] DEBUG after merge:  round=13 metric=0.7008 head_norm=0.924291 delta_norm=0.209676
[S5] aggregate: ACCEPT kept=['S10', 'S14', 'S3', 'S15'] (k=4/4) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=13 metric=0.4590 head_norm=1.041068
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.100749e-01
[S16] stored merged vector for next round verification (round=13)
[S16] DEBUG after merge:  round=13 metric=0.4797 head_norm=1.033456 delta_norm=0.110075
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.534076 cos_to_last_merge=0.8628 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.863
[S2] round=14 local utility u=0.000000 metrics={'f1_val': 0.8301626839060217, 'auprc': 0.833818632990085, 'loss_val': 0.2596296044143341, 'psi': 0.8316250635396469}-{'f1_val': 0.8335805163903267, 'auprc': 0.8397509322128148, 'loss_val': 0.24284895870508846, 'psi': 0.836048682719322}
[S3] START round=14 head_norm_before_train=1.623278 (no previous merge yet)
[S3] round=14 local utility u=0.000000 metrics={'f1_val': 0.6103932023713268, 'auprc': 0.9566016695681341, 'loss_val': 0.4275993298870598, 'psi': 0.7488765892500497}-{'f1_val': 0.700330919019862, 'auprc': 0.9941653772884553, 'loss_val': 0.31047034364985465, 'psi': 0.8178647023272994}
[S4] START round=14 head_norm_before_train=1.837799 (no previous merge yet)
[S4] round=14 local utility u=0.078863 metrics={'f1_val': 0.9491654270433282, 'auprc': 0.9656574504830998, 'loss_val': 0.25518730279730634, 'psi': 0.9557622364192369}-{'f1_val': 0.9392705627538339, 'auprc': 0.9382534063890349, 'loss_val': 0.27133246206219974, 'psi': 0.9388637002079143}
[S5] START round=14 head_norm_before_train=0.924291 cos_to_last_merge=1.0000 (last merge round=13)
[S5] round=14 local utility u=0.049668 metrics={'f1_val': 0.7008168588441903, 'auprc': 0.8090545667901063, 'loss_val': 0.6454709964819826, 'psi': 0.7441119420225568}-{'f1_val': 0.7008162875368863, 'auprc': 0.7948310373119385, 'loss_val': 0.7021326392616029, 'psi': 0.7384221874469072}
[S6] START round=14 head_norm_before_train=1.766938 (no previous merge yet)
[S6] round=14 local utility u=0.000000 metrics={'f1_val': 0.7475149112537932, 'auprc': 0.9596956696315951, 'loss_val': 0.5600879976670687, 'psi': 0.832387214604914}-{'f1_val': 0.824161471344169, 'auprc': 0.9617038181737525, 'loss_val': 0.3596204205410307, 'psi': 0.8791784100760023}
[S7] START round=14 head_norm_before_train=1.438343 cos_to_last_merge=0.9983 (last merge round=12)
[S7] round=14 local utility u=0.000000 metrics={'f1_val': 0.416587999573199, 'auprc': 0.7555936916133941, 'loss_val': 0.8175628475408058, 'psi': 0.552190276389277}-{'f1_val': 0.416587999573199, 'auprc': 0.8313478680625082, 'loss_val': 0.8485994887023587, 'psi': 0.5824919469689227}
[S8] START round=14 head_norm_before_train=1.518453 cos_to_last_merge=0.8367 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.837
[S8] round=14 local utility u=0.014984 metrics={'f1_val': 0.9948349509112366, 'auprc': 0.9992297731244439, 'loss_val': 0.05543300803376351, 'psi': 0.9965928797965196}-{'f1_val': 0.9934886015238295, 'auprc': 0.9956517458453972, 'loss_val': 0.06658817823378416, 'psi': 0.9943538592524566}
[S9] START round=14 head_norm_before_train=1.183130 cos_to_last_merge=1.0000 (last merge round=13)
[S9] round=14 local utility u=0.009724 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9976691717921627, 'loss_val': 0.33530606376442024, 'psi': 0.8197976171808763}-{'f1_val': 0.7012904835408967, 'auprc': 0.997843012097253, 'loss_val': 0.35571893760513396, 'psi': 0.8199114949634393}
[S10] START round=14 head_norm_before_train=1.758210 (no previous merge yet)
[S10] round=14 local utility u=0.006540 metrics={'f1_val': 0.9947070105294492, 'auprc': 0.996701058622282, 'loss_val': 0.07282642642028703, 'psi': 0.9955046297665824}-{'f1_val': 0.9955429473180637, 'auprc': 0.997553481079122, 'loss_val': 0.09347928584828256, 'psi': 0.996347160822487}
[S11] START round=14 head_norm_before_train=1.785100 cos_to_last_merge=0.9996 (last merge round=12)
[S11] round=14 local utility u=0.013389 metrics={'f1_val': 0.7032165156930557, 'auprc': 0.9986580121001419, 'loss_val': 0.25972928382999455, 'psi': 0.8213931142558901}-{'f1_val': 0.7016934795869249, 'auprc': 0.9985253058635043, 'loss_val': 0.27697099361084077, 'psi': 0.8204262100975566}
[S13] START round=14 head_norm_before_train=1.682971 (no previous merge yet)
[S13] round=14 local utility u=0.000000 metrics={'f1_val': 0.5922214486056985, 'auprc': 0.6387294142275483, 'loss_val': 0.7634578694647697, 'psi': 0.6108246348544384}-{'f1_val': 0.6699276433208331, 'auprc': 0.6787110645977691, 'loss_val': 0.47581189972397897, 'psi': 0.6734410118316074}
[S14] START round=14 head_norm_before_train=1.098667 cos_to_last_merge=1.0000 (last merge round=13)
[S14] round=14 local utility u=0.000000 metrics={'f1_val': 0.7005613765736816, 'auprc': 0.9967217583011643, 'loss_val': 0.6612573207101711, 'psi': 0.8190255292646746}-{'f1_val': 0.7816434133051319, 'auprc': 0.9955233863860995, 'loss_val': 0.793181532536096, 'psi': 0.8671954025375189}
[S15] START round=14 head_norm_before_train=1.510684 cos_to_last_merge=0.7985 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.798
[S15] round=14 local utility u=0.000000 metrics={'f1_val': 0.9004442083986368, 'auprc': 0.9940255597212101, 'loss_val': 0.16295581400611195, 'psi': 0.937876748927666}-{'f1_val': 0.9911236827670269, 'auprc': 0.9934352782034191, 'loss_val': 0.1124801197866389, 'psi': 0.9920483209415838}
[S16] START round=14 head_norm_before_train=1.033456 cos_to_last_merge=1.0000 (last merge round=13)
[S16] round=14 local utility u=0.481085 metrics={'f1_val': 0.5798629425400953, 'auprc': 0.8431471051013157, 'loss_val': 0.7491678489453842, 'psi': 0.6851766075645835}-{'f1_val': 0.459014912163091, 'auprc': 0.7791980347893118, 'loss_val': 0.7944014952987732, 'psi': 0.5870881612135793}
[S17] START round=14 head_norm_before_train=1.325715 cos_to_last_merge=0.8475 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.847
[S17] round=14 local utility u=0.566187 metrics={'f1_val': 0.6007748956145078, 'auprc': 0.9282753019056962, 'loss_val': 0.5328811498557536, 'psi': 0.7317750581309832}-{'f1_val': 0.4178634959059794, 'auprc': 0.9288977483713805, 'loss_val': 0.5696540927712682, 'psi': 0.6222771968921399}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:58314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:58310
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:58316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] → sending delta(kind=head bytes=1805) to S7@127.0.0.1:58308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:58307
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:58312
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:58305
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1805 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1805) from S8
[S7] cosine check vs S8: cos=0.9813
[S14] RECEIVED delta(kind=head bytes=1801) from S9
[S14] cosine check vs S9: cos=0.9154
[S11] RECEIVED delta(kind=head bytes=1799) from S4
[S11] cosine check vs S4: cos=0.9862
[S16] RECEIVED delta(kind=head bytes=1798) from S5
[S16] cosine check vs S5: cos=0.9676
[S5] RECEIVED delta(kind=head bytes=1798) from S10
[S5] cosine check vs S10: cos=0.8109
[S9] RECEIVED delta(kind=head bytes=1801) from S11
[S9] cosine check vs S11: cos=-0.1114
[S9] DROPPED delta from S11 (cos=-0.1114 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1795) from S16
[S6] cosine check vs S16: cos=-0.0282
[S6] DROPPED delta from S16 (cos=-0.0282 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:58310
[S17] sending update (kind=head size=1795 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1795) from S17
[S9] cosine check vs S17: cos=0.8101
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=14 metric=0.7006 head_norm=1.121106
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.465937e-01
[S14] stored merged vector for next round verification (round=14)
[S14] DEBUG after merge:  round=14 metric=0.9280 head_norm=1.148188 delta_norm=0.246594
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=14 metric=0.4166 head_norm=1.465227
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.520880e-01
[S7] stored merged vector for next round verification (round=14)
[S7] DEBUG after merge:  round=14 metric=0.4166 head_norm=1.501456 delta_norm=0.152088
[S7] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=14 metric=0.7032 head_norm=1.815563
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.545781e-01
[S11] stored merged vector for next round verification (round=14)
[S11] DEBUG after merge:  round=14 metric=0.9560 head_norm=1.831901 delta_norm=0.154578
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=14 metric=0.7012 head_norm=1.225320
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.051187e-01
[S9] stored merged vector for next round verification (round=14)
[S9] DEBUG after merge:  round=14 metric=0.7012 head_norm=1.233437 delta_norm=0.405119
[S9] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=14 metric=0.5799 head_norm=1.074282
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.412045e-01
[S16] stored merged vector for next round verification (round=14)
[S16] DEBUG after merge:  round=14 metric=0.5672 head_norm=1.009358 delta_norm=0.141205
[S16] aggregate: ROLLBACK (f1_val pre=0.580 post=0.567 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=14 metric=0.7008 head_norm=0.960939
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.720602e-01
[S5] stored merged vector for next round verification (round=14)
[S5] DEBUG after merge:  round=14 metric=0.7008 head_norm=1.308030 delta_norm=0.572060
[S5] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.557380 cos_to_last_merge=0.8594 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.859
[S2] round=15 local utility u=0.047584 metrics={'f1_val': 0.8296435979180999, 'auprc': 0.8728798296574403, 'loss_val': 0.27852970808281247, 'psi': 0.8469380906138361}-{'f1_val': 0.8301626839060217, 'auprc': 0.833818632990085, 'loss_val': 0.2596296044143341, 'psi': 0.8316250635396469}
[S3] START round=15 head_norm_before_train=1.652577 (no previous merge yet)
[S3] round=15 local utility u=0.402938 metrics={'f1_val': 0.7003264167718803, 'auprc': 0.9939588878776964, 'loss_val': 0.27339429920906716, 'psi': 0.8177794052142068}-{'f1_val': 0.6103932023713268, 'auprc': 0.9566016695681341, 'loss_val': 0.4275993298870598, 'psi': 0.7488765892500497}
[S4] START round=15 head_norm_before_train=1.860979 (no previous merge yet)
[S4] round=15 local utility u=0.000000 metrics={'f1_val': 0.9456808500480882, 'auprc': 0.9478411434760408, 'loss_val': 0.26690905810809945, 'psi': 0.9465449674192693}-{'f1_val': 0.9491654270433282, 'auprc': 0.9656574504830998, 'loss_val': 0.25518730279730634, 'psi': 0.9557622364192369}
[S5] START round=15 head_norm_before_train=1.308030 cos_to_last_merge=1.0000 (last merge round=14)
[S5] round=15 local utility u=0.197334 metrics={'f1_val': 0.7005691551769304, 'auprc': 0.8796439319111441, 'loss_val': 0.46108491525589373, 'psi': 0.7721990658706159}-{'f1_val': 0.7008168588441903, 'auprc': 0.8090545667901063, 'loss_val': 0.6454709964819826, 'psi': 0.7441119420225568}
[S6] START round=15 head_norm_before_train=1.796971 (no previous merge yet)
[S6] round=15 local utility u=0.239260 metrics={'f1_val': 0.7992578165095823, 'auprc': 0.9612328894349251, 'loss_val': 0.3966361479967154, 'psi': 0.8640478456797194}-{'f1_val': 0.7475149112537932, 'auprc': 0.9596956696315951, 'loss_val': 0.5600879976670687, 'psi': 0.832387214604914}
[S7] START round=15 head_norm_before_train=1.501456 cos_to_last_merge=1.0000 (last merge round=14)
[S7] round=15 local utility u=0.050871 metrics={'f1_val': 0.41650694526510673, 'auprc': 0.7818984595089452, 'loss_val': 0.7942490174058318, 'psi': 0.5626635509626421}-{'f1_val': 0.416587999573199, 'auprc': 0.7555936916133941, 'loss_val': 0.8175628475408058, 'psi': 0.552190276389277}
[S8] START round=15 head_norm_before_train=1.551808 cos_to_last_merge=0.8332 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.833
[S8] round=15 local utility u=0.000000 metrics={'f1_val': 0.992765585815685, 'auprc': 0.999032013604356, 'loss_val': 0.055703560145378514, 'psi': 0.9952721569311533}-{'f1_val': 0.9948349509112366, 'auprc': 0.9992297731244439, 'loss_val': 0.05543300803376351, 'psi': 0.9965928797965196}
[S9] START round=15 head_norm_before_train=1.233437 cos_to_last_merge=1.0000 (last merge round=14)
[S9] round=15 local utility u=0.000000 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9979432568223549, 'loss_val': 0.34600758990776975, 'psi': 0.819907251192953}-{'f1_val': 0.7012165807733519, 'auprc': 0.9976691717921627, 'loss_val': 0.33530606376442024, 'psi': 0.8197976171808763}
[S10] START round=15 head_norm_before_train=1.775665 (no previous merge yet)
[S10] round=15 local utility u=0.000000 metrics={'f1_val': 0.9943563983784213, 'auprc': 0.9938877512661488, 'loss_val': 0.07242537498449073, 'psi': 0.9941689395335123}-{'f1_val': 0.9947070105294492, 'auprc': 0.996701058622282, 'loss_val': 0.07282642642028703, 'psi': 0.9955046297665824}
[S11] START round=15 head_norm_before_train=1.831901 cos_to_last_merge=1.0000 (last merge round=14)
[S11] round=15 local utility u=0.776908 metrics={'f1_val': 0.9580598988783908, 'auprc': 0.9981291240195905, 'loss_val': 0.23338749272769163, 'psi': 0.9740875889348707}-{'f1_val': 0.7032165156930557, 'auprc': 0.9986580121001419, 'loss_val': 0.25972928382999455, 'psi': 0.8213931142558901}
[S13] START round=15 head_norm_before_train=1.692178 (no previous merge yet)
[S13] round=15 local utility u=0.075658 metrics={'f1_val': 0.6218567796953636, 'auprc': 0.6151479121680089, 'loss_val': 0.7192091796616195, 'psi': 0.6191732326844217}-{'f1_val': 0.5922214486056985, 'auprc': 0.6387294142275483, 'loss_val': 0.7634578694647697, 'psi': 0.6108246348544384}
[S14] START round=15 head_norm_before_train=1.148188 cos_to_last_merge=1.0000 (last merge round=14)
[S14] round=15 local utility u=0.729802 metrics={'f1_val': 0.9255743354158259, 'auprc': 0.9980850277702966, 'loss_val': 0.5558213174438916, 'psi': 0.9545786123576141}-{'f1_val': 0.7005613765736816, 'auprc': 0.9967217583011643, 'loss_val': 0.6612573207101711, 'psi': 0.8190255292646746}
[S15] START round=15 head_norm_before_train=1.560352 cos_to_last_merge=0.7913 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.791
[S15] round=15 local utility u=0.000000 metrics={'f1_val': 0.8076581131827256, 'auprc': 0.9647439776004103, 'loss_val': 0.2894908550909837, 'psi': 0.8704924589497995}-{'f1_val': 0.9004442083986368, 'auprc': 0.9940255597212101, 'loss_val': 0.16295581400611195, 'psi': 0.937876748927666}
[S16] START round=15 head_norm_before_train=1.009358 cos_to_last_merge=1.0000 (last merge round=14)
[S16] round=15 local utility u=0.038617 metrics={'f1_val': 0.5804649417975494, 'auprc': 0.8577374567114125, 'loss_val': 0.7193177724001567, 'psi': 0.6913739477630947}-{'f1_val': 0.5798629425400953, 'auprc': 0.8431471051013157, 'loss_val': 0.7491678489453842, 'psi': 0.6851766075645835}
[S17] START round=15 head_norm_before_train=1.367321 cos_to_last_merge=0.8420 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.842
[S17] round=15 local utility u=0.223985 metrics={'f1_val': 0.6817046815419743, 'auprc': 0.9121907475562554, 'loss_val': 0.5222363168101397, 'psi': 0.7738991079476867}-{'f1_val': 0.6007748956145078, 'auprc': 0.9282753019056962, 'loss_val': 0.5328811498557536, 'psi': 0.7317750581309832}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:58314
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:58316
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:58304
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1785 reason=None
[S16] → sending delta(kind=head bytes=1785) to S6@127.0.0.1:58307
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:58310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:58310
[S11] sending update (kind=head size=1794 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1785 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1803 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1797) from S14
[S5] cosine check vs S14: cos=0.1569
[S6] RECEIVED delta(kind=head bytes=1785) from S16
[S6] cosine check vs S16: cos=-0.0284
[S6] DROPPED delta from S16 (cos=-0.0284 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1799) from S2
[S5] cosine check vs S2: cos=-0.0172
[S5] DROPPED delta from S2 (cos=-0.0172 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1794) from S11
[S9] cosine check vs S11: cos=-0.0863
[S9] DROPPED delta from S11 (cos=-0.0863 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1803) from S6
[S4] cosine check vs S6: cos=-0.1145
[S4] DROPPED delta from S6 (cos=-0.1145 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1800) from S13
[S9] cosine check vs S13: cos=0.5125
[S14] RECEIVED delta(kind=head bytes=1803) from S7
[S14] cosine check vs S7: cos=0.7609
[S16] RECEIVED delta(kind=head bytes=1795) from S5
[S16] cosine check vs S5: cos=0.9436
[S5] RECEIVED delta(kind=head bytes=1800) from S3
[S5] cosine check vs S3: cos=0.1689
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:58310
[S17] sending update (kind=head size=1797 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1797) from S17
[S9] cosine check vs S17: cos=0.9450
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=15 metric=0.7012 head_norm=1.271722
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.848268e-01
[S9] stored merged vector for next round verification (round=15)
[S9] DEBUG after merge:  round=15 metric=0.7012 head_norm=1.219263 delta_norm=0.284827
[S9] aggregate: ACCEPT kept=['S13', 'S17'] (k=2/2) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.132 → S14@127.0.0.1:58314
[S8] ⇄ pheromone p=0.143 → S7@127.0.0.1:58308
[S4] ⇄ pheromone p=0.272 → S11@127.0.0.1:58312
[S10] ⇄ pheromone p=0.157 → S5@127.0.0.1:58305
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=15 metric=0.5805 head_norm=1.056054
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.452178e-01
[S16] stored merged vector for next round verification (round=15)
[S16] DEBUG after merge:  round=15 metric=0.5697 head_norm=1.181383 delta_norm=0.245218
[S16] aggregate: ROLLBACK (f1_val pre=0.580 post=0.570 tol_abs=0.005 tol_rel=0.0)
[S16] ⇄ pheromone p=0.227 → S6@127.0.0.1:58307
[S3] ⇄ pheromone p=0.263 → S5@127.0.0.1:58305
[S6] ⇄ pheromone p=0.281 → S4@127.0.0.1:58304
[S11] ⇄ pheromone p=0.300 → S9@127.0.0.1:58310
[S13] ⇄ pheromone p=0.158 → S9@127.0.0.1:58310
[S2] ⇄ pheromone p=0.155 → S5@127.0.0.1:58305
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=15 metric=0.7006 head_norm=1.340278
[S5] _apply_head_vector_avg (torch): Δ‖w‖=7.457379e-01
[S5] stored merged vector for next round verification (round=15)
[S5] DEBUG after merge:  round=15 metric=0.7006 head_norm=0.932328 delta_norm=0.745738
[S5] aggregate: ACCEPT kept=['S14', 'S3'] (k=2/2) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.229 → S16@127.0.0.1:58316
[S7] ⇄ pheromone p=0.105 → S14@127.0.0.1:58314
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=15 metric=0.9256 head_norm=1.172742
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.937995e-01
[S14] stored merged vector for next round verification (round=15)
[S14] DEBUG after merge:  round=15 metric=0.9277 head_norm=1.265658 delta_norm=0.493800
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.373 → S5@127.0.0.1:58305
[S15] ⇄ pheromone p=0.286 → S5@127.0.0.1:58305
[S17] ⇄ pheromone p=0.298 → S9@127.0.0.1:58310
[S2] START round=16 head_norm_before_train=1.581695 cos_to_last_merge=0.8558 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.856
[S2] round=16 local utility u=0.041900 metrics={'f1_val': 0.8537917827523924, 'auprc': 0.8461244093025748, 'loss_val': 0.2593516507762519, 'psi': 0.8507248333724654}-{'f1_val': 0.8296435979180999, 'auprc': 0.8728798296574403, 'loss_val': 0.27852970808281247, 'psi': 0.8469380906138361}
[S3] START round=16 head_norm_before_train=1.677537 (no previous merge yet)
[S3] round=16 local utility u=0.013635 metrics={'f1_val': 0.7008317350254774, 'auprc': 0.995613275701938, 'loss_val': 0.2541187615407456, 'psi': 0.8187443512960617}-{'f1_val': 0.7003264167718803, 'auprc': 0.9939588878776964, 'loss_val': 0.27339429920906716, 'psi': 0.8177794052142068}
[S4] START round=16 head_norm_before_train=1.885374 (no previous merge yet)
[S4] round=16 local utility u=0.000000 metrics={'f1_val': 0.9427017188463294, 'auprc': 0.9443762947102032, 'loss_val': 0.2778574926402145, 'psi': 0.9433715491918789}-{'f1_val': 0.9456808500480882, 'auprc': 0.9478411434760408, 'loss_val': 0.26690905810809945, 'psi': 0.9465449674192693}
[S5] START round=16 head_norm_before_train=0.932328 cos_to_last_merge=1.0000 (last merge round=15)
[S5] round=16 local utility u=0.000000 metrics={'f1_val': 0.7057990125215045, 'auprc': 0.7946010158625065, 'loss_val': 0.6152860413039377, 'psi': 0.7413198138579054}-{'f1_val': 0.7005691551769304, 'auprc': 0.8796439319111441, 'loss_val': 0.46108491525589373, 'psi': 0.7721990658706159}
[S6] START round=16 head_norm_before_train=1.819739 (no previous merge yet)
[S6] round=16 local utility u=0.000000 metrics={'f1_val': 0.7389753320868953, 'auprc': 0.9570044248813451, 'loss_val': 0.6247620358968204, 'psi': 0.8261869692046753}-{'f1_val': 0.7992578165095823, 'auprc': 0.9612328894349251, 'loss_val': 0.3966361479967154, 'psi': 0.8640478456797194}
[S7] START round=16 head_norm_before_train=1.521885 cos_to_last_merge=0.9993 (last merge round=14)
[S7] round=16 local utility u=0.979943 metrics={'f1_val': 0.6809982687661956, 'auprc': 0.8958675116619046, 'loss_val': 0.7632179198599162, 'psi': 0.7669459659244793}-{'f1_val': 0.41650694526510673, 'auprc': 0.7818984595089452, 'loss_val': 0.7942490174058318, 'psi': 0.5626635509626421}
[S8] START round=16 head_norm_before_train=1.585163 cos_to_last_merge=0.8301 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.830
[S8] round=16 local utility u=0.000000 metrics={'f1_val': 0.9884946976640797, 'auprc': 0.9991874020746213, 'loss_val': 0.051924592201323824, 'psi': 0.9927717794282963}-{'f1_val': 0.992765585815685, 'auprc': 0.999032013604356, 'loss_val': 0.055703560145378514, 'psi': 0.9952721569311533}
[S9] START round=16 head_norm_before_train=1.219263 cos_to_last_merge=1.0000 (last merge round=15)
[S9] round=16 local utility u=0.023045 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9975946042429698, 'loss_val': 0.2988718932109815, 'psi': 0.819767790161199}-{'f1_val': 0.7012165807733519, 'auprc': 0.9979432568223549, 'loss_val': 0.34600758990776975, 'psi': 0.819907251192953}
[S10] START round=16 head_norm_before_train=1.798144 (no previous merge yet)
[S10] round=16 local utility u=0.007622 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9935774798951496, 'loss_val': 0.06124014381052064, 'psi': 0.9945436953696847}-{'f1_val': 0.9943563983784213, 'auprc': 0.9938877512661488, 'loss_val': 0.07242537498449073, 'psi': 0.9941689395335123}
[S11] START round=16 head_norm_before_train=1.858187 cos_to_last_merge=0.9998 (last merge round=14)
[S11] round=16 local utility u=0.000000 metrics={'f1_val': 0.9485251094054842, 'auprc': 0.9985579955324673, 'loss_val': 0.24284937213385105, 'psi': 0.9685382638562774}-{'f1_val': 0.9580598988783908, 'auprc': 0.9981291240195905, 'loss_val': 0.23338749272769163, 'psi': 0.9740875889348707}
[S13] START round=16 head_norm_before_train=1.706139 (no previous merge yet)
[S13] round=16 local utility u=0.107890 metrics={'f1_val': 0.5924585867477224, 'auprc': 0.6900838226755113, 'loss_val': 0.5518472079562188, 'psi': 0.631508681118838}-{'f1_val': 0.6218567796953636, 'auprc': 0.6151479121680089, 'loss_val': 0.7192091796616195, 'psi': 0.6191732326844217}
[S14] START round=16 head_norm_before_train=1.265658 cos_to_last_merge=1.0000 (last merge round=15)
[S14] round=16 local utility u=0.234174 metrics={'f1_val': 0.9974964634091955, 'auprc': 0.9986288954914131, 'loss_val': 0.5206381783638468, 'psi': 0.9979494362420824}-{'f1_val': 0.9255743354158259, 'auprc': 0.9980850277702966, 'loss_val': 0.5558213174438916, 'psi': 0.9545786123576141}
[S15] START round=16 head_norm_before_train=1.599505 cos_to_last_merge=0.7865 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.787
[S15] round=16 local utility u=0.186754 metrics={'f1_val': 0.858167579145748, 'auprc': 0.9794301263488785, 'loss_val': 0.2630988775140895, 'psi': 0.9066725980270003}-{'f1_val': 0.8076581131827256, 'auprc': 0.9647439776004103, 'loss_val': 0.2894908550909837, 'psi': 0.8704924589497995}
[S16] START round=16 head_norm_before_train=1.181383 cos_to_last_merge=1.0000 (last merge round=15)
[S16] round=16 local utility u=1.000000 metrics={'f1_val': 0.8909905321426479, 'auprc': 0.9820314015586765, 'loss_val': 0.5217815660759277, 'psi': 0.9274068799090593}-{'f1_val': 0.5804649417975494, 'auprc': 0.8577374567114125, 'loss_val': 0.7193177724001567, 'psi': 0.6913739477630947}
[S17] START round=16 head_norm_before_train=1.413824 cos_to_last_merge=0.8377 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.838
[S17] round=16 local utility u=0.000000 metrics={'f1_val': 0.5813675484195845, 'auprc': 0.9349431396166299, 'loss_val': 0.578313547358513, 'psi': 0.7227977848984026}-{'f1_val': 0.6817046815419743, 'auprc': 0.9121907475562554, 'loss_val': 0.5222363168101397, 'psi': 0.7738991079476867}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:58305
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:58305
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] → sending delta(kind=head bytes=1793) to S14@127.0.0.1:58314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:58310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:58314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:58307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:58305
[S3] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1804 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1793 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1796 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1793) from S9
[S14] cosine check vs S9: cos=0.8468
[S5] RECEIVED delta(kind=head bytes=1802) from S3
[S5] cosine check vs S3: cos=0.5611
[S5] RECEIVED delta(kind=head bytes=1796) from S2
[S5] cosine check vs S2: cos=-0.0147
[S5] DROPPED delta from S2 (cos=-0.0147 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1804) from S16
[S6] cosine check vs S16: cos=-0.0301
[S6] DROPPED delta from S16 (cos=-0.0301 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1798) from S15
[S5] cosine check vs S15: cos=0.4080
[S5] RECEIVED delta(kind=head bytes=1802) from S10
[S5] cosine check vs S10: cos=0.7489
[S5] RECEIVED delta(kind=head bytes=1802) from S14
[S5] cosine check vs S14: cos=0.3756
[S9] RECEIVED delta(kind=head bytes=1799) from S13
[S9] cosine check vs S13: cos=0.6876
[S14] RECEIVED delta(kind=head bytes=1801) from S7
[S14] cosine check vs S7: cos=0.9458
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=4 kept=4 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=16 metric=0.7058 head_norm=0.963089
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.053479e-01
[S5] stored merged vector for next round verification (round=16)
[S5] DEBUG after merge:  round=16 metric=0.7012 head_norm=0.924515 delta_norm=0.205348
[S5] aggregate: ACCEPT kept=['S3', 'S15', 'S10', 'S14'] (k=4/4) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=16 metric=0.9975 head_norm=1.287338
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.128886e-01
[S14] stored merged vector for next round verification (round=16)
[S14] DEBUG after merge:  round=16 metric=0.9971 head_norm=1.279592 delta_norm=0.112889
[S14] aggregate: ACCEPT kept=['S9', 'S7'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=16 metric=0.7012 head_norm=1.258457
[S9] _apply_head_vector_avg (torch): Δ‖w‖=6.246176e-01
[S9] stored merged vector for next round verification (round=16)
[S9] DEBUG after merge:  round=16 metric=0.7012 head_norm=1.369612 delta_norm=0.624618
[S9] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.609522 cos_to_last_merge=0.8519 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.852
[S2] round=17 local utility u=0.005355 metrics={'f1_val': 0.8300909769334904, 'auprc': 0.9105578205450485, 'loss_val': 0.29973638987524764, 'psi': 0.8622777143781137}-{'f1_val': 0.8537917827523924, 'auprc': 0.8461244093025748, 'loss_val': 0.2593516507762519, 'psi': 0.8507248333724654}
[S3] START round=17 head_norm_before_train=1.698928 (no previous merge yet)
[S3] round=17 local utility u=0.000000 metrics={'f1_val': 0.7005859652789095, 'auprc': 0.9943707613198205, 'loss_val': 0.268254600741423, 'psi': 0.8180998836952739}-{'f1_val': 0.7008317350254774, 'auprc': 0.995613275701938, 'loss_val': 0.2541187615407456, 'psi': 0.8187443512960617}
[S4] START round=17 head_norm_before_train=1.912398 (no previous merge yet)
[S4] round=17 local utility u=0.000000 metrics={'f1_val': 0.9258349946108522, 'auprc': 0.9084195053242321, 'loss_val': 0.35714498186385535, 'psi': 0.9188687988962042}-{'f1_val': 0.9427017188463294, 'auprc': 0.9443762947102032, 'loss_val': 0.2778574926402145, 'psi': 0.9433715491918789}
[S5] START round=17 head_norm_before_train=0.924515 cos_to_last_merge=1.0000 (last merge round=16)
[S5] round=17 local utility u=0.329504 metrics={'f1_val': 0.7008577120890963, 'auprc': 0.9932472037065582, 'loss_val': 0.522569254029984, 'psi': 0.817813508736081}-{'f1_val': 0.7057990125215045, 'auprc': 0.7946010158625065, 'loss_val': 0.6152860413039377, 'psi': 0.7413198138579054}
[S6] START round=17 head_norm_before_train=1.841850 (no previous merge yet)
[S6] round=17 local utility u=0.000000 metrics={'f1_val': 0.7249610116058265, 'auprc': 0.9558869205138982, 'loss_val': 0.6654302849706684, 'psi': 0.8173313751690552}-{'f1_val': 0.7389753320868953, 'auprc': 0.9570044248813451, 'loss_val': 0.6247620358968204, 'psi': 0.8261869692046753}
[S7] START round=17 head_norm_before_train=1.541837 cos_to_last_merge=0.9978 (last merge round=14)
[S7] round=17 local utility u=0.000000 metrics={'f1_val': 0.40342118592280274, 'auprc': 0.7541056631778355, 'loss_val': 0.812382507788168, 'psi': 0.5436949768248158}-{'f1_val': 0.6809982687661956, 'auprc': 0.8958675116619046, 'loss_val': 0.7632179198599162, 'psi': 0.7669459659244793}
[S8] START round=17 head_norm_before_train=1.619472 cos_to_last_merge=0.8271 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.827
[S8] round=17 local utility u=0.000000 metrics={'f1_val': 0.9676593858310151, 'auprc': 0.9989623966685286, 'loss_val': 0.10009606922927643, 'psi': 0.9801805901660205}-{'f1_val': 0.9884946976640797, 'auprc': 0.9991874020746213, 'loss_val': 0.051924592201323824, 'psi': 0.9927717794282963}
[S9] START round=17 head_norm_before_train=1.369612 cos_to_last_merge=1.0000 (last merge round=16)
[S9] round=17 local utility u=0.025590 metrics={'f1_val': 0.7014667606303384, 'auprc': 0.9955884365688097, 'loss_val': 0.24317456167553736, 'psi': 0.8191154310057269}-{'f1_val': 0.7012165807733519, 'auprc': 0.9975946042429698, 'loss_val': 0.2988718932109815, 'psi': 0.819767790161199}
[S10] START round=17 head_norm_before_train=1.821090 (no previous merge yet)
[S10] round=17 local utility u=0.011346 metrics={'f1_val': 0.9951704237150173, 'auprc': 0.9966329200512961, 'loss_val': 0.047610161552777704, 'psi': 0.9957554222495288}-{'f1_val': 0.9951878390193748, 'auprc': 0.9935774798951496, 'loss_val': 0.06124014381052064, 'psi': 0.9945436953696847}
[S11] START round=17 head_norm_before_train=1.883291 cos_to_last_merge=0.9992 (last merge round=14)
[S11] round=17 local utility u=0.055252 metrics={'f1_val': 0.9567004648862381, 'auprc': 0.9980116303881614, 'loss_val': 0.1797585507791104, 'psi': 0.9732249310870074}-{'f1_val': 0.9485251094054842, 'auprc': 0.9985579955324673, 'loss_val': 0.24284937213385105, 'psi': 0.9685382638562774}
[S13] START round=17 head_norm_before_train=1.717047 (no previous merge yet)
[S13] round=17 local utility u=0.000000 metrics={'f1_val': 0.5879676903731831, 'auprc': 0.6655073558960996, 'loss_val': 0.8377923859550638, 'psi': 0.6189835565823496}-{'f1_val': 0.5924585867477224, 'auprc': 0.6900838226755113, 'loss_val': 0.5518472079562188, 'psi': 0.631508681118838}
[S14] START round=17 head_norm_before_train=1.279592 cos_to_last_merge=1.0000 (last merge round=16)
[S14] round=17 local utility u=0.044810 metrics={'f1_val': 0.9961600950216628, 'auprc': 0.9980928989726798, 'loss_val': 0.42139196926084593, 'psi': 0.9969332166020697}-{'f1_val': 0.9974964634091955, 'auprc': 0.9986288954914131, 'loss_val': 0.5206381783638468, 'psi': 0.9979494362420824}
[S15] START round=17 head_norm_before_train=1.628953 cos_to_last_merge=0.7825 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.782
[S15] round=17 local utility u=0.000000 metrics={'f1_val': 0.7852845051871747, 'auprc': 0.9583774562311688, 'loss_val': 0.311830131622976, 'psi': 0.8545216856047724}-{'f1_val': 0.858167579145748, 'auprc': 0.9794301263488785, 'loss_val': 0.2630988775140895, 'psi': 0.9066725980270003}
[S16] START round=17 head_norm_before_train=1.229606 cos_to_last_merge=0.9985 (last merge round=15)
[S16] round=17 local utility u=0.343684 metrics={'f1_val': 0.9718247932422738, 'auprc': 0.9919594428700507, 'loss_val': 0.34920385224658523, 'psi': 0.9798786530933845}-{'f1_val': 0.8909905321426479, 'auprc': 0.9820314015586765, 'loss_val': 0.5217815660759277, 'psi': 0.9274068799090593}
[S17] START round=17 head_norm_before_train=1.468460 cos_to_last_merge=0.8349 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.835
[S17] round=17 local utility u=0.013150 metrics={'f1_val': 0.5814597308002184, 'auprc': 0.9454667065760121, 'loss_val': 0.5841377020653944, 'psi': 0.7270625211105359}-{'f1_val': 0.5813675484195845, 'auprc': 0.9349431396166299, 'loss_val': 0.578313547358513, 'psi': 0.7227977848984026}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:58316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:58307
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:58305
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:58314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:58305
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:58305
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:58310
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1803) from S16
[S6] cosine check vs S16: cos=-0.0387
[S6] DROPPED delta from S16 (cos=-0.0387 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1800) from S11
[S9] cosine check vs S11: cos=-0.1312
[S9] DROPPED delta from S11 (cos=-0.1312 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1799) from S5
[S16] cosine check vs S5: cos=0.8948
[S14] RECEIVED delta(kind=head bytes=1799) from S9
[S14] cosine check vs S9: cos=0.7301
[S5] RECEIVED delta(kind=head bytes=1796) from S14
[S5] cosine check vs S14: cos=0.4110
[S5] RECEIVED delta(kind=head bytes=1795) from S2
[S5] cosine check vs S2: cos=-0.0091
[S5] DROPPED delta from S2 (cos=-0.0091 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1802) from S10
[S5] cosine check vs S10: cos=0.7415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:58310
[S17] sending update (kind=head size=1800 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1800) from S17
[S9] cosine check vs S17: cos=0.5486
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=17 metric=0.7009 head_norm=0.959790
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.305539e-01
[S5] stored merged vector for next round verification (round=17)
[S5] DEBUG after merge:  round=17 metric=0.7006 head_norm=1.011614 delta_norm=0.330554
[S5] aggregate: ACCEPT kept=['S14', 'S10'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=17 metric=0.7015 head_norm=1.404693
[S9] _apply_head_vector_avg (torch): Δ‖w‖=6.964709e-01
[S9] stored merged vector for next round verification (round=17)
[S9] DEBUG after merge:  round=17 metric=0.9881 head_norm=1.286975 delta_norm=0.696471
[S9] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=17 metric=0.9962 head_norm=1.303990
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.996825e-01
[S14] stored merged vector for next round verification (round=17)
[S14] DEBUG after merge:  round=17 metric=0.9962 head_norm=1.259799 delta_norm=0.499683
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=17 metric=0.9718 head_norm=1.275741
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.989582e-01
[S16] stored merged vector for next round verification (round=17)
[S16] DEBUG after merge:  round=17 metric=0.9682 head_norm=1.088568 delta_norm=0.298958
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.631944 cos_to_last_merge=0.8489 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.849
[S2] round=18 local utility u=0.000000 metrics={'f1_val': 0.6808133926748292, 'auprc': 0.7724641347628609, 'loss_val': 0.7739539367651117, 'psi': 0.7174736895100419}-{'f1_val': 0.8300909769334904, 'auprc': 0.9105578205450485, 'loss_val': 0.29973638987524764, 'psi': 0.8622777143781137}
[S3] START round=18 head_norm_before_train=1.717654 (no previous merge yet)
[S3] round=18 local utility u=0.035303 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9970289083603564, 'loss_val': 0.20664505926507717, 'psi': 0.8192652855853224}-{'f1_val': 0.7005859652789095, 'auprc': 0.9943707613198205, 'loss_val': 0.268254600741423, 'psi': 0.8180998836952739}
[S4] START round=18 head_norm_before_train=1.923452 (no previous merge yet)
[S4] round=18 local utility u=0.091853 metrics={'f1_val': 0.9402279071191618, 'auprc': 0.9210090877128037, 'loss_val': 0.2975652415607649, 'psi': 0.9325403793566185}-{'f1_val': 0.9258349946108522, 'auprc': 0.9084195053242321, 'loss_val': 0.35714498186385535, 'psi': 0.9188687988962042}
[S5] START round=18 head_norm_before_train=1.011614 cos_to_last_merge=1.0000 (last merge round=17)
[S5] round=18 local utility u=0.000000 metrics={'f1_val': 0.7017808069656597, 'auprc': 0.8361121197509964, 'loss_val': 0.5443509764812606, 'psi': 0.7555133320797944}-{'f1_val': 0.7008577120890963, 'auprc': 0.9932472037065582, 'loss_val': 0.522569254029984, 'psi': 0.817813508736081}
[S6] START round=18 head_norm_before_train=1.868685 (no previous merge yet)
[S6] round=18 local utility u=0.857425 metrics={'f1_val': 0.9236027801639426, 'auprc': 0.9774008317164822, 'loss_val': 0.20697214484007376, 'psi': 0.9451220007849584}-{'f1_val': 0.7249610116058265, 'auprc': 0.9558869205138982, 'loss_val': 0.6654302849706684, 'psi': 0.8173313751690552}
[S7] START round=18 head_norm_before_train=1.561371 cos_to_last_merge=0.9959 (last merge round=14)
[S7] round=18 local utility u=0.363719 metrics={'f1_val': 0.5065148956014922, 'auprc': 0.7761458650804721, 'loss_val': 0.7696276274898187, 'psi': 0.6143672833930842}-{'f1_val': 0.40342118592280274, 'auprc': 0.7541056631778355, 'loss_val': 0.812382507788168, 'psi': 0.5436949768248158}
[S8] START round=18 head_norm_before_train=1.646568 cos_to_last_merge=0.8251 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.825
[S8] round=18 local utility u=0.084974 metrics={'f1_val': 0.9932883265732785, 'auprc': 0.9881171592118452, 'loss_val': 0.05138519197661928, 'psi': 0.9912198596287052}-{'f1_val': 0.9676593858310151, 'auprc': 0.9989623966685286, 'loss_val': 0.10009606922927643, 'psi': 0.9801805901660205}
[S9] START round=18 head_norm_before_train=1.286975 cos_to_last_merge=1.0000 (last merge round=17)
[S9] round=18 local utility u=0.000000 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9973971769319276, 'loss_val': 0.2548146782171749, 'psi': 0.8196888192367822}-{'f1_val': 0.7014667606303384, 'auprc': 0.9955884365688097, 'loss_val': 0.24317456167553736, 'psi': 0.8191154310057269}
[S10] START round=18 head_norm_before_train=1.846074 (no previous merge yet)
[S10] round=18 local utility u=0.004870 metrics={'f1_val': 0.996024628641722, 'auprc': 0.9970338827332548, 'loss_val': 0.04419728693290494, 'psi': 0.9964283302783351}-{'f1_val': 0.9951704237150173, 'auprc': 0.9966329200512961, 'loss_val': 0.047610161552777704, 'psi': 0.9957554222495288}
[S11] START round=18 head_norm_before_train=1.906638 cos_to_last_merge=0.9984 (last merge round=14)
[S11] round=18 local utility u=0.000000 metrics={'f1_val': 0.8567553380108419, 'auprc': 0.991914701472339, 'loss_val': 0.1987701958635531, 'psi': 0.9108190833954407}-{'f1_val': 0.9567004648862381, 'auprc': 0.9980116303881614, 'loss_val': 0.1797585507791104, 'psi': 0.9732249310870074}
[S13] START round=18 head_norm_before_train=1.728387 (no previous merge yet)
[S13] round=18 local utility u=0.000000 metrics={'f1_val': 0.5544723409523376, 'auprc': 0.6356642944660971, 'loss_val': 0.7818918318028867, 'psi': 0.5869491223578414}-{'f1_val': 0.5879676903731831, 'auprc': 0.6655073558960996, 'loss_val': 0.8377923859550638, 'psi': 0.6189835565823496}
[S14] START round=18 head_norm_before_train=1.259799 cos_to_last_merge=1.0000 (last merge round=17)
[S14] round=18 local utility u=0.025451 metrics={'f1_val': 0.9981710571531228, 'auprc': 0.9985298476216632, 'loss_val': 0.3838666690772437, 'psi': 0.998314573340539}-{'f1_val': 0.9961600950216628, 'auprc': 0.9980928989726798, 'loss_val': 0.42139196926084593, 'psi': 0.9969332166020697}
[S15] START round=18 head_norm_before_train=1.651671 cos_to_last_merge=0.7802 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.780
[S15] round=18 local utility u=0.404105 metrics={'f1_val': 0.88824221764749, 'auprc': 0.9949845812699194, 'loss_val': 0.23118755572388106, 'psi': 0.9309391630964619}-{'f1_val': 0.7852845051871747, 'auprc': 0.9583774562311688, 'loss_val': 0.311830131622976, 'psi': 0.8545216856047724}
[S16] START round=18 head_norm_before_train=1.088568 cos_to_last_merge=1.0000 (last merge round=17)
[S16] round=18 local utility u=0.000000 metrics={'f1_val': 0.7452225105948868, 'auprc': 0.887341760267976, 'loss_val': 0.651386005312152, 'psi': 0.8020702104641224}-{'f1_val': 0.9718247932422738, 'auprc': 0.9919594428700507, 'loss_val': 0.34920385224658523, 'psi': 0.9798786530933845}
[S17] START round=18 head_norm_before_train=1.519733 cos_to_last_merge=0.8318 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.832
[S17] round=18 local utility u=0.000000 metrics={'f1_val': 0.5783742185350469, 'auprc': 0.9227829891803954, 'loss_val': 0.6021580352564992, 'psi': 0.7161377267931863}-{'f1_val': 0.5814597308002184, 'auprc': 0.9454667065760121, 'loss_val': 0.5841377020653944, 'psi': 0.7270625211105359}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:58305
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:58304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:58308
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:58312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:58305
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:58314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:58305
[S15] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1804 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1803) from S15
[S5] cosine check vs S15: cos=0.4760
[S5] RECEIVED delta(kind=head bytes=1799) from S14
[S5] cosine check vs S14: cos=0.5117
[S5] RECEIVED delta(kind=head bytes=1801) from S10
[S5] cosine check vs S10: cos=0.8269
[S11] RECEIVED delta(kind=head bytes=1796) from S4
[S11] cosine check vs S4: cos=0.9878
[S4] RECEIVED delta(kind=head bytes=1802) from S6
[S4] cosine check vs S6: cos=-0.1163
[S4] DROPPED delta from S6 (cos=-0.1163 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1802) from S3
[S5] cosine check vs S3: cos=0.2621
[S7] RECEIVED delta(kind=head bytes=1797) from S8
[S7] cosine check vs S8: cos=0.9778
[S14] RECEIVED delta(kind=head bytes=1804) from S7
[S14] cosine check vs S7: cos=0.7658
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=18 metric=0.8568 head_norm=1.928245
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.508039e-01
[S11] stored merged vector for next round verification (round=18)
[S11] DEBUG after merge:  round=18 metric=0.9293 head_norm=1.924455 delta_norm=0.150804
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=4 kept=4 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=18 metric=0.7018 head_norm=1.047748
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.125407e-01
[S5] stored merged vector for next round verification (round=18)
[S5] DEBUG after merge:  round=18 metric=0.7009 head_norm=0.976460 delta_norm=0.212541
[S5] aggregate: ACCEPT kept=['S15', 'S14', 'S10', 'S3'] (k=4/4) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=18 metric=0.5065 head_norm=1.579386
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.761924e-01
[S7] stored merged vector for next round verification (round=18)
[S7] DEBUG after merge:  round=18 metric=0.5809 head_norm=1.613825 delta_norm=0.176192
[S7] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=18 metric=0.9982 head_norm=1.283319
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.091607e-01
[S14] stored merged vector for next round verification (round=18)
[S14] DEBUG after merge:  round=18 metric=0.9982 head_norm=1.345897 delta_norm=0.509161
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.653423 cos_to_last_merge=0.8462 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.846
[S2] round=19 local utility u=0.858284 metrics={'f1_val': 0.8353555947545908, 'auprc': 0.8631622359522422, 'loss_val': 0.2567336759121202, 'psi': 0.8464782512336514}-{'f1_val': 0.6808133926748292, 'auprc': 0.7724641347628609, 'loss_val': 0.7739539367651117, 'psi': 0.7174736895100419}
[S3] START round=19 head_norm_before_train=1.733558 (no previous merge yet)
[S3] round=19 local utility u=0.000000 metrics={'f1_val': 0.7003512381127298, 'auprc': 0.998080097069743, 'loss_val': 0.23688680242519547, 'psi': 0.8194427816955351}-{'f1_val': 0.7007562037352997, 'auprc': 0.9970289083603564, 'loss_val': 0.20664505926507717, 'psi': 0.8192652855853224}
[S4] START round=19 head_norm_before_train=1.932461 (no previous merge yet)
[S4] round=19 local utility u=0.022535 metrics={'f1_val': 0.9412007940588476, 'auprc': 0.9305749970715282, 'loss_val': 0.2870300978289129, 'psi': 0.9369504752639198}-{'f1_val': 0.9402279071191618, 'auprc': 0.9210090877128037, 'loss_val': 0.2975652415607649, 'psi': 0.9325403793566185}
[S5] START round=19 head_norm_before_train=0.976460 cos_to_last_merge=1.0000 (last merge round=18)
[S5] round=19 local utility u=0.147637 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9271089209907164, 'loss_val': 0.5150328491653772, 'psi': 0.7912086039938911}-{'f1_val': 0.7017808069656597, 'auprc': 0.8361121197509964, 'loss_val': 0.5443509764812606, 'psi': 0.7555133320797944}
[S6] START round=19 head_norm_before_train=1.886550 (no previous merge yet)
[S6] round=19 local utility u=0.000000 metrics={'f1_val': 0.7759458943505159, 'auprc': 0.9613486886701627, 'loss_val': 0.520236047444376, 'psi': 0.8501070120783746}-{'f1_val': 0.9236027801639426, 'auprc': 0.9774008317164822, 'loss_val': 0.20697214484007376, 'psi': 0.9451220007849584}
[S7] START round=19 head_norm_before_train=1.613825 cos_to_last_merge=1.0000 (last merge round=18)
[S7] round=19 local utility u=0.805245 metrics={'f1_val': 0.6821289719724206, 'auprc': 0.9038218159748993, 'loss_val': 0.5958503657998847, 'psi': 0.7708061095734121}-{'f1_val': 0.5065148956014922, 'auprc': 0.7761458650804721, 'loss_val': 0.7696276274898187, 'psi': 0.6143672833930842}
[S8] START round=19 head_norm_before_train=1.666279 cos_to_last_merge=0.8235 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.824
[S8] round=19 local utility u=0.000000 metrics={'f1_val': 0.9921505420845177, 'auprc': 0.988998317241726, 'loss_val': 0.05158067197838651, 'psi': 0.990889652147401}-{'f1_val': 0.9932883265732785, 'auprc': 0.9881171592118452, 'loss_val': 0.05138519197661928, 'psi': 0.9912198596287052}
[S9] START round=19 head_norm_before_train=1.316622 cos_to_last_merge=0.9991 (last merge round=17)
[S9] round=19 local utility u=0.009394 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9978112462729795, 'loss_val': 0.23726882735608032, 'psi': 0.819854446973203}-{'f1_val': 0.7012165807733519, 'auprc': 0.9973971769319276, 'loss_val': 0.2548146782171749, 'psi': 0.8196888192367822}
[S10] START round=19 head_norm_before_train=1.876339 (no previous merge yet)
[S10] round=19 local utility u=0.000000 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.99504081268961, 'loss_val': 0.03993803047762003, 'psi': 0.9953821171848558}-{'f1_val': 0.996024628641722, 'auprc': 0.9970338827332548, 'loss_val': 0.04419728693290494, 'psi': 0.9964283302783351}
[S11] START round=19 head_norm_before_train=1.924455 cos_to_last_merge=1.0000 (last merge round=18)
[S11] round=19 local utility u=0.309124 metrics={'f1_val': 0.9528818726124209, 'auprc': 0.9989460891059823, 'loss_val': 0.17837564661656713, 'psi': 0.9713075592098455}-{'f1_val': 0.8567553380108419, 'auprc': 0.991914701472339, 'loss_val': 0.1987701958635531, 'psi': 0.9108190833954407}
[S13] START round=19 head_norm_before_train=1.737882 (no previous merge yet)
[S13] round=19 local utility u=0.087253 metrics={'f1_val': 0.5839392364837453, 'auprc': 0.6290732404699233, 'loss_val': 0.7644148099750656, 'psi': 0.6019928380782165}-{'f1_val': 0.5544723409523376, 'auprc': 0.6356642944660971, 'loss_val': 0.7818918318028867, 'psi': 0.5869491223578414}
[S14] START round=19 head_norm_before_train=1.345897 cos_to_last_merge=1.0000 (last merge round=18)
[S14] round=19 local utility u=0.020230 metrics={'f1_val': 0.9974966549531046, 'auprc': 0.9987142041298989, 'loss_val': 0.33991398359658187, 'psi': 0.9979836746238222}-{'f1_val': 0.9981710571531228, 'auprc': 0.9985298476216632, 'loss_val': 0.3838666690772437, 'psi': 0.998314573340539}
[S15] START round=19 head_norm_before_train=1.670873 cos_to_last_merge=0.7788 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.779
[S15] round=19 local utility u=0.248136 metrics={'f1_val': 0.951166457989377, 'auprc': 0.9885333570027333, 'loss_val': 0.09310768692762537, 'psi': 0.9661132175947195}-{'f1_val': 0.88824221764749, 'auprc': 0.9949845812699194, 'loss_val': 0.23118755572388106, 'psi': 0.9309391630964619}
[S16] START round=19 head_norm_before_train=1.126444 cos_to_last_merge=0.9991 (last merge round=17)
[S16] round=19 local utility u=0.556333 metrics={'f1_val': 0.8576768773858976, 'auprc': 0.9944944719841836, 'loss_val': 0.534904172447079, 'psi': 0.912403915225212}-{'f1_val': 0.7452225105948868, 'auprc': 0.887341760267976, 'loss_val': 0.651386005312152, 'psi': 0.8020702104641224}
[S17] START round=19 head_norm_before_train=1.563479 cos_to_last_merge=0.8289 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.829
[S17] round=19 local utility u=0.000000 metrics={'f1_val': 0.5681096810610282, 'auprc': 0.8434973694684925, 'loss_val': 0.7230788863144875, 'psi': 0.678264756424014}-{'f1_val': 0.5783742185350469, 'auprc': 0.9227829891803954, 'loss_val': 0.6021580352564992, 'psi': 0.7161377267931863}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:58312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:58314
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:58310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:58314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:58316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:58307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:58310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:58305
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1795 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1797) from S13
[S9] cosine check vs S13: cos=0.6576
[S5] RECEIVED delta(kind=head bytes=1797) from S2
[S5] cosine check vs S2: cos=-0.0058
[S5] DROPPED delta from S2 (cos=-0.0058 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1801) from S15
[S5] cosine check vs S15: cos=0.5962
[S14] RECEIVED delta(kind=head bytes=1800) from S9
[S14] cosine check vs S9: cos=0.8294
[S14] RECEIVED delta(kind=head bytes=1799) from S7
[S14] cosine check vs S7: cos=0.9465
[S11] RECEIVED delta(kind=head bytes=1795) from S4
[S11] cosine check vs S4: cos=0.9955
[S5] RECEIVED delta(kind=head bytes=1803) from S14
[S5] cosine check vs S14: cos=0.4674
[S6] RECEIVED delta(kind=head bytes=1802) from S16
[S6] cosine check vs S16: cos=-0.0354
[S6] DROPPED delta from S16 (cos=-0.0354 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1802) from S5
[S16] cosine check vs S5: cos=0.9527
[S9] RECEIVED delta(kind=head bytes=1797) from S11
[S9] cosine check vs S11: cos=-0.1117
[S9] DROPPED delta from S11 (cos=-0.1117 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=20 psi=0.850 u=0.0000 p_local=0.2523 f1=0.776 auprc=0.961 bytes=19794
[S3] r=20 psi=0.819 u=0.0000 p_local=0.1146 f1=0.700 auprc=0.998 bytes=19785
[S8] r=20 psi=0.991 u=0.0000 p_local=0.0722 f1=0.992 auprc=0.989 bytes=19775
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=19 metric=0.7006 head_norm=1.005424
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.022783e-01
[S5] stored merged vector for next round verification (round=19)
[S5] DEBUG after merge:  round=19 metric=0.7006 head_norm=0.995222 delta_norm=0.402278
[S5] aggregate: ACCEPT kept=['S15', 'S14'] (k=2/2) mode=median trim_p=0.1
[S5] r=20 psi=0.791 u=0.1476 p_local=0.1653 f1=0.701 auprc=0.927 bytes=25134
[S2] r=20 psi=0.846 u=0.8583 p_local=0.2401 f1=0.835 auprc=0.863 bytes=26944
[S4] r=20 psi=0.937 u=0.0225 p_local=0.1305 f1=0.941 auprc=0.931 bytes=16183
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=19 metric=0.7012 head_norm=1.343127
[S9] _apply_head_vector_avg (torch): Δ‖w‖=6.667863e-01
[S9] stored merged vector for next round verification (round=19)
[S9] DEBUG after merge:  round=19 metric=0.7012 head_norm=1.411384 delta_norm=0.666786
[S9] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S9] r=20 psi=0.820 u=0.0094 p_local=0.0614 f1=0.701 auprc=0.998 bytes=26965
[S10] r=20 psi=0.995 u=0.0000 p_local=0.0673 f1=0.996 auprc=0.995 bytes=28760
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=19 metric=0.9529 head_norm=1.946725
[S11] _apply_head_vector_avg (torch): Δ‖w‖=9.268764e-02
[S11] stored merged vector for next round verification (round=19)
[S11] DEBUG after merge:  round=19 metric=0.9529 head_norm=1.947522 delta_norm=0.092688
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] r=20 psi=0.971 u=0.3091 p_local=0.1916 f1=0.953 auprc=0.999 bytes=25168
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=19 metric=0.9975 head_norm=1.367323
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.460937e-01
[S14] stored merged vector for next round verification (round=19)
[S14] DEBUG after merge:  round=19 metric=0.9975 head_norm=1.355727 delta_norm=0.146094
[S14] aggregate: ACCEPT kept=['S9', 'S7'] (k=2/2) mode=median trim_p=0.1
[S14] r=20 psi=0.998 u=0.0202 p_local=0.1907 f1=0.997 auprc=0.999 bytes=26937
[S13] r=20 psi=0.602 u=0.0873 p_local=0.0930 f1=0.584 auprc=0.629 bytes=17986
[S17] r=20 psi=0.678 u=0.0000 p_local=0.1239 f1=0.568 auprc=0.843 bytes=17953
[S15] r=20 psi=0.966 u=0.2481 p_local=0.2507 f1=0.951 auprc=0.989 bytes=21587
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=19 metric=0.8577 head_norm=1.165473
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.846350e-01
[S16] stored merged vector for next round verification (round=19)
[S16] DEBUG after merge:  round=19 metric=0.8586 head_norm=1.072619 delta_norm=0.184635
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S16] r=20 psi=0.912 u=0.5563 p_local=0.3505 f1=0.858 auprc=0.994 bytes=25142
[S7] r=20 psi=0.771 u=0.8052 p_local=0.3625 f1=0.682 auprc=0.904 bytes=26955
[S2] START round=20 head_norm_before_train=1.670819 cos_to_last_merge=0.8440 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.844
[S2] round=20 local utility u=0.141540 metrics={'f1_val': 0.8887622417980392, 'auprc': 0.8464614866354665, 'loss_val': 0.24399169994678555, 'psi': 0.8718419397330102}-{'f1_val': 0.8353555947545908, 'auprc': 0.8631622359522422, 'loss_val': 0.2567336759121202, 'psi': 0.8464782512336514}
[S3] START round=20 head_norm_before_train=1.752946 (no previous merge yet)
[S3] round=20 local utility u=0.037682 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9987798443143006, 'loss_val': 0.16560080667489807, 'psi': 0.819920513524921}-{'f1_val': 0.7003512381127298, 'auprc': 0.998080097069743, 'loss_val': 0.23688680242519547, 'psi': 0.8194427816955351}
[S4] START round=20 head_norm_before_train=1.952723 (no previous merge yet)
[S4] round=20 local utility u=0.000000 metrics={'f1_val': 0.9390347400649213, 'auprc': 0.9228505797495522, 'loss_val': 0.3017527853796903, 'psi': 0.9325610759387737}-{'f1_val': 0.9412007940588476, 'auprc': 0.9305749970715282, 'loss_val': 0.2870300978289129, 'psi': 0.9369504752639198}
[S5] START round=20 head_norm_before_train=0.995222 cos_to_last_merge=1.0000 (last merge round=19)
[S5] round=20 local utility u=0.102091 metrics={'f1_val': 0.7006099296049884, 'auprc': 0.9924591873582622, 'loss_val': 0.5069108001451488, 'psi': 0.8173496327062979}-{'f1_val': 0.7006083926626743, 'auprc': 0.9271089209907164, 'loss_val': 0.5150328491653772, 'psi': 0.7912086039938911}
[S6] START round=20 head_norm_before_train=1.895205 (no previous merge yet)
[S6] round=20 local utility u=0.000000 metrics={'f1_val': 0.6589365666045579, 'auprc': 0.9536829823390973, 'loss_val': 0.7297155796581387, 'psi': 0.7768351328983737}-{'f1_val': 0.7759458943505159, 'auprc': 0.9613486886701627, 'loss_val': 0.520236047444376, 'psi': 0.8501070120783746}
[S7] START round=20 head_norm_before_train=1.630518 cos_to_last_merge=0.9998 (last merge round=18)
[S7] round=20 local utility u=0.000000 metrics={'f1_val': 0.608366747231956, 'auprc': 0.7803913165156439, 'loss_val': 0.7182759163124547, 'psi': 0.6771765749454313}-{'f1_val': 0.6821289719724206, 'auprc': 0.9038218159748993, 'loss_val': 0.5958503657998847, 'psi': 0.7708061095734121}
[S8] START round=20 head_norm_before_train=1.683628 cos_to_last_merge=0.8223 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.822
[S8] round=20 local utility u=0.000000 metrics={'f1_val': 0.9780756445643195, 'auprc': 0.9989727045944775, 'loss_val': 0.06145525858887087, 'psi': 0.9864344685763826}-{'f1_val': 0.9921505420845177, 'auprc': 0.988998317241726, 'loss_val': 0.05158067197838651, 'psi': 0.990889652147401}
[S9] START round=20 head_norm_before_train=1.411384 cos_to_last_merge=1.0000 (last merge round=19)
[S9] round=20 local utility u=0.908400 metrics={'f1_val': 0.9937492462693716, 'auprc': 0.9955766116912436, 'loss_val': 0.16896181412529754, 'psi': 0.9944801924381204}-{'f1_val': 0.7012165807733519, 'auprc': 0.9978112462729795, 'loss_val': 0.23726882735608032, 'psi': 0.819854446973203}
[S10] START round=20 head_norm_before_train=1.906572 (no previous merge yet)
[S10] round=20 local utility u=0.003470 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9963379036802349, 'loss_val': 0.034358233201296655, 'psi': 0.9956478648837188}-{'f1_val': 0.9956096535150197, 'auprc': 0.99504081268961, 'loss_val': 0.03993803047762003, 'psi': 0.9953821171848558}
[S11] START round=20 head_norm_before_train=1.947522 cos_to_last_merge=1.0000 (last merge round=19)
[S11] round=20 local utility u=0.155547 metrics={'f1_val': 0.9969878514242156, 'auprc': 0.9981292386268066, 'loss_val': 0.1294674395550576, 'psi': 0.9974444063052521}-{'f1_val': 0.9528818726124209, 'auprc': 0.9989460891059823, 'loss_val': 0.17837564661656713, 'psi': 0.9713075592098455}
[S13] START round=20 head_norm_before_train=1.751921 (no previous merge yet)
[S13] round=20 local utility u=0.000000 metrics={'f1_val': 0.5703305554248661, 'auprc': 0.6222293902954239, 'loss_val': 0.8235725109258484, 'psi': 0.5910900893730893}-{'f1_val': 0.5839392364837453, 'auprc': 0.6290732404699233, 'loss_val': 0.7644148099750656, 'psi': 0.6019928380782165}
[S14] START round=20 head_norm_before_train=1.355727 cos_to_last_merge=1.0000 (last merge round=19)
[S14] round=20 local utility u=0.005745 metrics={'f1_val': 0.9964030091660864, 'auprc': 0.9947541681610057, 'loss_val': 0.3099829291872041, 'psi': 0.9957434727640542}-{'f1_val': 0.9974966549531046, 'auprc': 0.9987142041298989, 'loss_val': 0.33991398359658187, 'psi': 0.9979836746238222}
[S15] START round=20 head_norm_before_train=1.692925 cos_to_last_merge=0.7771 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.777
[S15] round=20 local utility u=0.000000 metrics={'f1_val': 0.9366999586229762, 'auprc': 0.9904493543032824, 'loss_val': 0.08782082207992305, 'psi': 0.9581997168950986}-{'f1_val': 0.951166457989377, 'auprc': 0.9885333570027333, 'loss_val': 0.09310768692762537, 'psi': 0.9661132175947195}
[S16] START round=20 head_norm_before_train=1.072619 cos_to_last_merge=1.0000 (last merge round=19)
[S16] round=20 local utility u=0.506787 metrics={'f1_val': 0.9907337767590316, 'auprc': 0.9953921512835057, 'loss_val': 0.3223651814653815, 'psi': 0.9925971265688213}-{'f1_val': 0.8576768773858976, 'auprc': 0.9944944719841836, 'loss_val': 0.534904172447079, 'psi': 0.912403915225212}
[S17] START round=20 head_norm_before_train=1.604117 cos_to_last_merge=0.8256 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.826
[S17] round=20 local utility u=0.158986 metrics={'f1_val': 0.5841685405745672, 'auprc': 0.9104450561962674, 'loss_val': 0.7023025147627124, 'psi': 0.7146791468232473}-{'f1_val': 0.5681096810610282, 'auprc': 0.8434973694684925, 'loss_val': 0.7230788863144875, 'psi': 0.678264756424014}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:58316
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:58305
[S5] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1804 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1804) from S3
[S5] cosine check vs S3: cos=0.1830
[S16] RECEIVED delta(kind=head bytes=1800) from S5
[S16] cosine check vs S5: cos=0.8734
[S5] RECEIVED delta(kind=head bytes=1800) from S2
[S5] cosine check vs S2: cos=0.0081
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:58314
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1799 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1799) from S9
[S14] cosine check vs S9: cos=0.7486
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:58310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:58307
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:58305
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:58305
[S16] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1795 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1795) from S11
[S9] cosine check vs S11: cos=-0.1340
[S9] DROPPED delta from S11 (cos=-0.1340 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1799) from S10
[S5] cosine check vs S10: cos=0.5784
[S6] RECEIVED delta(kind=head bytes=1798) from S16
[S6] cosine check vs S16: cos=-0.0236
[S6] DROPPED delta from S16 (cos=-0.0236 < 0.0)
[S14] sending update (kind=head size=1798 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1798) from S14
[S5] cosine check vs S14: cos=0.6107
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:58310
[S17] sending update (kind=head size=1804 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1804) from S17
[S9] cosine check vs S17: cos=0.5656
[S2] ⇄ pheromone p=0.220 → S5@127.0.0.1:58305
[S3] ⇄ pheromone p=0.099 → S5@127.0.0.1:58305
[S5] aggregate: batch=4 kept=4 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=20 metric=0.7006 head_norm=1.022458
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.801462e-01
[S5] stored merged vector for next round verification (round=20)
[S5] DEBUG after merge:  round=20 metric=0.7006 head_norm=0.860882 delta_norm=0.380146
[S5] aggregate: ACCEPT kept=['S3', 'S2', 'S10', 'S14'] (k=4/4) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.153 → S16@127.0.0.1:58316
[S4] ⇄ pheromone p=0.104 → S11@127.0.0.1:58312
[S6] ⇄ pheromone p=0.202 → S4@127.0.0.1:58304
[S8] ⇄ pheromone p=0.058 → S7@127.0.0.1:58308
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=20 metric=0.9937 head_norm=1.437951
[S9] _apply_head_vector_avg (torch): Δ‖w‖=7.234932e-01
[S9] stored merged vector for next round verification (round=20)
[S9] DEBUG after merge:  round=20 metric=0.9954 head_norm=1.363532 delta_norm=0.723493
[S9] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.231 → S14@127.0.0.1:58314
[S13] ⇄ pheromone p=0.074 → S9@127.0.0.1:58310
[S11] ⇄ pheromone p=0.184 → S9@127.0.0.1:58310
[S7] ⇄ pheromone p=0.290 → S14@127.0.0.1:58314
[S10] ⇄ pheromone p=0.055 → S5@127.0.0.1:58305
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=20 metric=0.9907 head_norm=1.111126
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.717825e-01
[S16] stored merged vector for next round verification (round=20)
[S16] DEBUG after merge:  round=20 metric=0.9914 head_norm=1.032543 delta_norm=0.271782
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.382 → S6@127.0.0.1:58307
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=20 metric=0.9964 head_norm=1.382678
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.006719e-01
[S14] stored merged vector for next round verification (round=20)
[S14] DEBUG after merge:  round=20 metric=0.9964 head_norm=1.318741 delta_norm=0.500672
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.154 → S5@127.0.0.1:58305
[S15] ⇄ pheromone p=0.201 → S5@127.0.0.1:58305
[S17] ⇄ pheromone p=0.131 → S9@127.0.0.1:58310
[S2] START round=21 head_norm_before_train=1.693778 cos_to_last_merge=0.8407 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.841
[S2] round=21 local utility u=0.000000 metrics={'f1_val': 0.8296422269823205, 'auprc': 0.904048141327779, 'loss_val': 0.3333437698017727, 'psi': 0.8594045927205038}-{'f1_val': 0.8887622417980392, 'auprc': 0.8464614866354665, 'loss_val': 0.24399169994678555, 'psi': 0.8718419397330102}
[S3] START round=21 head_norm_before_train=1.771414 (no previous merge yet)
[S3] round=21 local utility u=0.920571 metrics={'f1_val': 0.9974247332315468, 'auprc': 0.9992400995828615, 'loss_val': 0.10630124142993977, 'psi': 0.9981508797720726}-{'f1_val': 0.7006809596653347, 'auprc': 0.9987798443143006, 'loss_val': 0.16560080667489807, 'psi': 0.819920513524921}
[S4] START round=21 head_norm_before_train=1.969428 (no previous merge yet)
[S4] round=21 local utility u=0.092441 metrics={'f1_val': 0.9438962434863218, 'auprc': 0.9708555353017763, 'loss_val': 0.2900539808290404, 'psi': 0.9546799602125036}-{'f1_val': 0.9390347400649213, 'auprc': 0.9228505797495522, 'loss_val': 0.3017527853796903, 'psi': 0.9325610759387737}
[S5] START round=21 head_norm_before_train=0.860882 cos_to_last_merge=1.0000 (last merge round=20)
[S5] round=21 local utility u=0.000000 metrics={'f1_val': 0.601841613015587, 'auprc': 0.8083152395256011, 'loss_val': 0.7101808660703679, 'psi': 0.6844310636195927}-{'f1_val': 0.7006099296049884, 'auprc': 0.9924591873582622, 'loss_val': 0.5069108001451488, 'psi': 0.8173496327062979}
[S6] START round=21 head_norm_before_train=1.904722 (no previous merge yet)
[S6] round=21 local utility u=0.316100 metrics={'f1_val': 0.7419703803683048, 'auprc': 0.9616332462510198, 'loss_val': 0.619570126210345, 'psi': 0.8298355267213908}-{'f1_val': 0.6589365666045579, 'auprc': 0.9536829823390973, 'loss_val': 0.7297155796581387, 'psi': 0.7768351328983737}
[S7] START round=21 head_norm_before_train=1.645893 cos_to_last_merge=0.9992 (last merge round=18)
[S7] round=21 local utility u=0.390085 metrics={'f1_val': 0.6764909309558385, 'auprc': 0.8443161437552915, 'loss_val': 0.5386249707800037, 'psi': 0.7436210160756196}-{'f1_val': 0.608366747231956, 'auprc': 0.7803913165156439, 'loss_val': 0.7182759163124547, 'psi': 0.6771765749454313}
[S8] START round=21 head_norm_before_train=1.701050 cos_to_last_merge=0.8209 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.821
[S8] round=21 local utility u=0.050907 metrics={'f1_val': 0.9936700521263312, 'auprc': 0.9945481305222104, 'loss_val': 0.0399342267450119, 'psi': 0.9940212834846829}-{'f1_val': 0.9780756445643195, 'auprc': 0.9989727045944775, 'loss_val': 0.06145525858887087, 'psi': 0.9864344685763826}
[S9] START round=21 head_norm_before_train=1.363532 cos_to_last_merge=1.0000 (last merge round=20)
[S9] round=21 local utility u=0.000000 metrics={'f1_val': 0.9920653202133933, 'auprc': 0.9978136637121203, 'loss_val': 0.17038138762582, 'psi': 0.9943646576128842}-{'f1_val': 0.9937492462693716, 'auprc': 0.9955766116912436, 'loss_val': 0.16896181412529754, 'psi': 0.9944801924381204}
[S10] START round=21 head_norm_before_train=1.936960 (no previous merge yet)
[S10] round=21 local utility u=0.001478 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9965057186651675, 'loss_val': 0.031906368254596626, 'psi': 0.9957149908776919}-{'f1_val': 0.9951878390193748, 'auprc': 0.9963379036802349, 'loss_val': 0.034358233201296655, 'psi': 0.9956478648837188}
[S11] START round=21 head_norm_before_train=1.974153 cos_to_last_merge=0.9998 (last merge round=19)
[S11] round=21 local utility u=0.017957 metrics={'f1_val': 0.9982515059399775, 'auprc': 0.9992776899738852, 'loss_val': 0.10458138618012605, 'psi': 0.9986619795535406}-{'f1_val': 0.9969878514242156, 'auprc': 0.9981292386268066, 'loss_val': 0.1294674395550576, 'psi': 0.9974444063052521}
[S13] START round=21 head_norm_before_train=1.764343 (no previous merge yet)
[S13] round=21 local utility u=0.058212 metrics={'f1_val': 0.5807780360567769, 'auprc': 0.6242921542375041, 'loss_val': 0.7760213847393861, 'psi': 0.5981836833290677}-{'f1_val': 0.5703305554248661, 'auprc': 0.6222293902954239, 'loss_val': 0.8235725109258484, 'psi': 0.5910900893730893}
[S14] START round=21 head_norm_before_train=1.318741 cos_to_last_merge=1.0000 (last merge round=20)
[S14] round=21 local utility u=0.015939 metrics={'f1_val': 0.9966229248296374, 'auprc': 0.9989623304975594, 'loss_val': 0.29204916568824874, 'psi': 0.9975586870968063}-{'f1_val': 0.9964030091660864, 'auprc': 0.9947541681610057, 'loss_val': 0.3099829291872041, 'psi': 0.9957434727640542}
[S15] START round=21 head_norm_before_train=1.717215 cos_to_last_merge=0.7751 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.775
[S15] round=21 local utility u=0.000000 metrics={'f1_val': 0.6993184132476389, 'auprc': 0.8991806616653572, 'loss_val': 0.531327384991163, 'psi': 0.7792633126147261}-{'f1_val': 0.9366999586229762, 'auprc': 0.9904493543032824, 'loss_val': 0.08782082207992305, 'psi': 0.9581997168950986}
[S16] START round=21 head_norm_before_train=1.032543 cos_to_last_merge=1.0000 (last merge round=20)
[S16] round=21 local utility u=0.000000 metrics={'f1_val': 0.9920875221017437, 'auprc': 0.9952390494968335, 'loss_val': 0.35084855364034256, 'psi': 0.9933481330597796}-{'f1_val': 0.9907337767590316, 'auprc': 0.9953921512835057, 'loss_val': 0.3223651814653815, 'psi': 0.9925971265688213}
[S17] START round=21 head_norm_before_train=1.642444 cos_to_last_merge=0.8227 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.823
[S17] round=21 local utility u=0.000000 metrics={'f1_val': 0.5783247779159021, 'auprc': 0.9148756848444219, 'loss_val': 0.7760301328870248, 'psi': 0.71294514068731}-{'f1_val': 0.5841685405745672, 'auprc': 0.9104450561962674, 'loss_val': 0.7023025147627124, 'psi': 0.7146791468232473}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:58308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:58310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:58314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:58312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:58304
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1802) from S4
[S11] cosine check vs S4: cos=0.9963
[S14] RECEIVED delta(kind=head bytes=1803) from S7
[S14] cosine check vs S7: cos=0.7746
[S9] RECEIVED delta(kind=head bytes=1802) from S13
[S9] cosine check vs S13: cos=0.6362
[S4] RECEIVED delta(kind=head bytes=1797) from S6
[S4] cosine check vs S6: cos=-0.1182
[S4] DROPPED delta from S6 (cos=-0.1182 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1798) from S8
[S7] cosine check vs S8: cos=0.9877
[S5] RECEIVED delta(kind=head bytes=1798) from S10
[S5] cosine check vs S10: cos=0.6246
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:58305
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1800 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1800) from S14
[S5] cosine check vs S14: cos=0.5802
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:58310
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1796) from S11
[S9] cosine check vs S11: cos=-0.1109
[S9] DROPPED delta from S11 (cos=-0.1109 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1801) from S3
[S5] cosine check vs S3: cos=0.3608
[S5] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=21 metric=0.6018 head_norm=0.891324
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.455754e-01
[S5] stored merged vector for next round verification (round=21)
[S5] DEBUG after merge:  round=21 metric=0.6689 head_norm=0.914514 delta_norm=0.245575
[S5] aggregate: ACCEPT kept=['S10', 'S14', 'S3'] (k=3/3) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=21 metric=0.9921 head_norm=1.392374
[S9] _apply_head_vector_avg (torch): Δ‖w‖=6.995364e-01
[S9] stored merged vector for next round verification (round=21)
[S9] DEBUG after merge:  round=21 metric=0.9921 head_norm=1.437981 delta_norm=0.699536
[S9] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=21 metric=0.9966 head_norm=1.345534
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.268385e-01
[S14] stored merged vector for next round verification (round=21)
[S14] DEBUG after merge:  round=21 metric=0.9967 head_norm=1.418282 delta_norm=0.526839
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=21 metric=0.9983 head_norm=2.004374
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.635444e-02
[S11] stored merged vector for next round verification (round=21)
[S11] DEBUG after merge:  round=21 metric=0.9983 head_norm=1.994227 delta_norm=0.086354
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=21 metric=0.6765 head_norm=1.663641
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.356536e-01
[S7] stored merged vector for next round verification (round=21)
[S7] DEBUG after merge:  round=21 metric=0.6767 head_norm=1.686581 delta_norm=0.135654
[S7] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=1.716008 cos_to_last_merge=0.8374 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.837
[S2] round=22 local utility u=0.043610 metrics={'f1_val': 0.8304791606003235, 'auprc': 0.933953785024351, 'loss_val': 0.34086312359888293, 'psi': 0.8718690103699345}-{'f1_val': 0.8296422269823205, 'auprc': 0.904048141327779, 'loss_val': 0.3333437698017727, 'psi': 0.8594045927205038}
[S3] START round=22 head_norm_before_train=1.792450 (no previous merge yet)
[S3] round=22 local utility u=0.000000 metrics={'f1_val': 0.960651231474942, 'auprc': 0.9988628887250128, 'loss_val': 0.12759998298374356, 'psi': 0.9759358943749703}-{'f1_val': 0.9974247332315468, 'auprc': 0.9992400995828615, 'loss_val': 0.10630124142993977, 'psi': 0.9981508797720726}
[S4] START round=22 head_norm_before_train=1.987783 (no previous merge yet)
[S4] round=22 local utility u=0.000000 metrics={'f1_val': 0.9388971502794138, 'auprc': 0.9260691522601296, 'loss_val': 0.31147715499562606, 'psi': 0.9337659510717001}-{'f1_val': 0.9438962434863218, 'auprc': 0.9708555353017763, 'loss_val': 0.2900539808290404, 'psi': 0.9546799602125036}
[S5] START round=22 head_norm_before_train=0.914514 cos_to_last_merge=1.0000 (last merge round=21)
[S5] round=22 local utility u=0.681372 metrics={'f1_val': 0.7006099296049884, 'auprc': 0.9923884799064888, 'loss_val': 0.4922661153442354, 'psi': 0.8173213497255886}-{'f1_val': 0.601841613015587, 'auprc': 0.8083152395256011, 'loss_val': 0.7101808660703679, 'psi': 0.6844310636195927}
[S6] START round=22 head_norm_before_train=1.920161 (no previous merge yet)
[S6] round=22 local utility u=0.334889 metrics={'f1_val': 0.8168210951188086, 'auprc': 0.9673233157077203, 'loss_val': 0.4159672757733209, 'psi': 0.8770219833543733}-{'f1_val': 0.7419703803683048, 'auprc': 0.9616332462510198, 'loss_val': 0.619570126210345, 'psi': 0.8298355267213908}
[S7] START round=22 head_norm_before_train=1.686581 cos_to_last_merge=1.0000 (last merge round=21)
[S7] round=22 local utility u=0.000000 metrics={'f1_val': 0.6675949504205023, 'auprc': 0.7875546872926307, 'loss_val': 0.5942480856888672, 'psi': 0.7155788451693537}-{'f1_val': 0.6764909309558385, 'auprc': 0.8443161437552915, 'loss_val': 0.5386249707800037, 'psi': 0.7436210160756196}
[S8] START round=22 head_norm_before_train=1.719946 cos_to_last_merge=0.8189 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.819
[S8] round=22 local utility u=0.007501 metrics={'f1_val': 0.9933673104406822, 'auprc': 0.9984668476978393, 'loss_val': 0.034872163343921715, 'psi': 0.995407125343545}-{'f1_val': 0.9936700521263312, 'auprc': 0.9945481305222104, 'loss_val': 0.0399342267450119, 'psi': 0.9940212834846829}
[S9] START round=22 head_norm_before_train=1.437981 cos_to_last_merge=1.0000 (last merge round=21)
[S9] round=22 local utility u=0.023379 metrics={'f1_val': 0.9937492462693716, 'auprc': 0.995892236244615, 'loss_val': 0.12796262522391635, 'psi': 0.9946064422594689}-{'f1_val': 0.9920653202133933, 'auprc': 0.9978136637121203, 'loss_val': 0.17038138762582, 'psi': 0.9943646576128842}
[S10] START round=22 head_norm_before_train=1.960422 (no previous merge yet)
[S10] round=22 local utility u=0.001286 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9966401122112464, 'loss_val': 0.02973756929078914, 'psi': 0.9957687482961234}-{'f1_val': 0.9951878390193748, 'auprc': 0.9965057186651675, 'loss_val': 0.031906368254596626, 'psi': 0.9957149908776919}
[S11] START round=22 head_norm_before_train=1.994227 cos_to_last_merge=1.0000 (last merge round=21)
[S11] round=22 local utility u=0.000000 metrics={'f1_val': 0.9598707041679697, 'auprc': 0.998926138344808, 'loss_val': 0.09454858103216363, 'psi': 0.9754928778387051}-{'f1_val': 0.9982515059399775, 'auprc': 0.9992776899738852, 'loss_val': 0.10458138618012605, 'psi': 0.9986619795535406}
[S13] START round=22 head_norm_before_train=1.782016 (no previous merge yet)
[S13] round=22 local utility u=0.085546 metrics={'f1_val': 0.5939936877184024, 'auprc': 0.6514853642914084, 'loss_val': 0.7658035902985294, 'psi': 0.6169903583476049}-{'f1_val': 0.5807780360567769, 'auprc': 0.6242921542375041, 'loss_val': 0.7760213847393861, 'psi': 0.5981836833290677}
[S14] START round=22 head_norm_before_train=1.418282 cos_to_last_merge=1.0000 (last merge round=21)
[S14] round=22 local utility u=0.031052 metrics={'f1_val': 0.9975396023865201, 'auprc': 0.9988227538034302, 'loss_val': 0.2350260458612575, 'psi': 0.9980528629532841}-{'f1_val': 0.9966229248296374, 'auprc': 0.9989623304975594, 'loss_val': 0.29204916568824874, 'psi': 0.9975586870968063}
[S15] START round=22 head_norm_before_train=1.738711 cos_to_last_merge=0.7736 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.774
[S15] round=22 local utility u=0.000000 metrics={'f1_val': 0.6982671051931744, 'auprc': 0.8957451588788768, 'loss_val': 0.5451580335716492, 'psi': 0.7772583266674553}-{'f1_val': 0.6993184132476389, 'auprc': 0.8991806616653572, 'loss_val': 0.531327384991163, 'psi': 0.7792633126147261}
[S16] START round=22 head_norm_before_train=1.076649 cos_to_last_merge=0.9986 (last merge round=20)
[S16] round=22 local utility u=0.000000 metrics={'f1_val': 0.9734203621054135, 'auprc': 0.997328065104173, 'loss_val': 0.31831509498376537, 'psi': 0.9829834433049174}-{'f1_val': 0.9920875221017437, 'auprc': 0.9952390494968335, 'loss_val': 0.35084855364034256, 'psi': 0.9933481330597796}
[S17] START round=22 head_norm_before_train=1.679049 cos_to_last_merge=0.8205 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.821
[S17] round=22 local utility u=0.110544 metrics={'f1_val': 0.5921121535980414, 'auprc': 0.9639659765920907, 'loss_val': 0.7849371006843436, 'psi': 0.7408536827956611}-{'f1_val': 0.5783247779159021, 'auprc': 0.9148756848444219, 'loss_val': 0.7760301328870248, 'psi': 0.71294514068731}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:58302
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:58316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:58308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:58312
[S5] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1798) from S5
[S2] cosine check vs S5: cos=0.0965
[S7] RECEIVED delta(kind=head bytes=1801) from S14
[S7] cosine check vs S14: cos=0.9494
[S11] RECEIVED delta(kind=head bytes=1797) from S9
[S11] cosine check vs S9: cos=-0.1355
[S11] DROPPED delta from S9 (cos=-0.1355 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1799) from S6
[S16] cosine check vs S6: cos=-0.0338
[S16] DROPPED delta from S6 (cos=-0.0338 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=22 metric=0.8305 head_norm=1.739418
[S2] _apply_head_vector_avg (torch): Δ‖w‖=9.483929e-01
[S2] stored merged vector for next round verification (round=22)
[S2] DEBUG after merge:  round=22 metric=0.8307 head_norm=1.028425 delta_norm=0.948393
[S2] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=22 metric=0.6676 head_norm=1.703577
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.805229e-01
[S7] stored merged vector for next round verification (round=22)
[S7] DEBUG after merge:  round=22 metric=0.6676 head_norm=1.556276 delta_norm=0.280523
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=1.028425 cos_to_last_merge=1.0000 (last merge round=22)
[S2] round=23 local utility u=0.121829 metrics={'f1_val': 0.8984284284706504, 'auprc': 0.8602334820466032, 'loss_val': 0.28374001890197886, 'psi': 0.8831504499010316}-{'f1_val': 0.8304791606003235, 'auprc': 0.933953785024351, 'loss_val': 0.34086312359888293, 'psi': 0.8718690103699345}
[S3] START round=23 head_norm_before_train=1.818305 (no previous merge yet)
[S3] round=23 local utility u=0.127689 metrics={'f1_val': 0.9953464457261353, 'auprc': 0.9986928229396212, 'loss_val': 0.07988220466948605, 'psi': 0.9966849966115296}-{'f1_val': 0.960651231474942, 'auprc': 0.9988628887250128, 'loss_val': 0.12759998298374356, 'psi': 0.9759358943749703}
[S4] START round=23 head_norm_before_train=1.996142 (no previous merge yet)
[S4] round=23 local utility u=0.099049 metrics={'f1_val': 0.9489399197371045, 'auprc': 0.9597744614927544, 'loss_val': 0.27475246032069056, 'psi': 0.9532737364393644}-{'f1_val': 0.9388971502794138, 'auprc': 0.9260691522601296, 'loss_val': 0.31147715499562606, 'psi': 0.9337659510717001}
[S5] START round=23 head_norm_before_train=0.942677 cos_to_last_merge=0.9984 (last merge round=21)
[S5] round=23 local utility u=0.000000 metrics={'f1_val': 0.6381490081818797, 'auprc': 0.8422056261533166, 'loss_val': 0.5770985998198219, 'psi': 0.7197716553704545}-{'f1_val': 0.7006099296049884, 'auprc': 0.9923884799064888, 'loss_val': 0.4922661153442354, 'psi': 0.8173213497255886}
[S6] START round=23 head_norm_before_train=1.936840 (no previous merge yet)
[S6] round=23 local utility u=0.000000 metrics={'f1_val': 0.7835035025768159, 'auprc': 0.9638211637358365, 'loss_val': 0.5903509230674072, 'psi': 0.8556305670404241}-{'f1_val': 0.8168210951188086, 'auprc': 0.9673233157077203, 'loss_val': 0.4159672757733209, 'psi': 0.8770219833543733}
[S7] START round=23 head_norm_before_train=1.556276 cos_to_last_merge=1.0000 (last merge round=22)
[S7] round=23 local utility u=0.000000 metrics={'f1_val': 0.5180859189729577, 'auprc': 0.7736996226099658, 'loss_val': 0.8190614838829138, 'psi': 0.6203314004277609}-{'f1_val': 0.6675949504205023, 'auprc': 0.7875546872926307, 'loss_val': 0.5942480856888672, 'psi': 0.7155788451693537}
[S8] START round=23 head_norm_before_train=1.739025 cos_to_last_merge=0.8169 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.817
[S8] round=23 local utility u=0.000000 metrics={'f1_val': 0.991490485949629, 'auprc': 0.9991776133737109, 'loss_val': 0.0377826144880942, 'psi': 0.9945653369192617}-{'f1_val': 0.9933673104406822, 'auprc': 0.9984668476978393, 'loss_val': 0.034872163343921715, 'psi': 0.995407125343545}
[S9] START round=23 head_norm_before_train=1.473273 cos_to_last_merge=0.9991 (last merge round=21)
[S9] round=23 local utility u=0.017281 metrics={'f1_val': 0.9937492462693716, 'auprc': 0.997841479694912, 'loss_val': 0.0992481208209275, 'psi': 0.9953861396395877}-{'f1_val': 0.9937492462693716, 'auprc': 0.995892236244615, 'loss_val': 0.12796262522391635, 'psi': 0.9946064422594689}
[S10] START round=23 head_norm_before_train=1.984008 (no previous merge yet)
[S10] round=23 local utility u=0.002235 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.99695951566387, 'loss_val': 0.028755848359459973, 'psi': 0.9961495983745599}-{'f1_val': 0.9951878390193748, 'auprc': 0.9966401122112464, 'loss_val': 0.02973756929078914, 'psi': 0.9957687482961234}
[S11] START round=23 head_norm_before_train=2.022170 cos_to_last_merge=0.9998 (last merge round=21)
[S11] round=23 local utility u=0.124797 metrics={'f1_val': 0.9971593530989756, 'auprc': 0.9982031509981395, 'loss_val': 0.06651742991485804, 'psi': 0.9975768722586412}-{'f1_val': 0.9598707041679697, 'auprc': 0.998926138344808, 'loss_val': 0.09454858103216363, 'psi': 0.9754928778387051}
[S13] START round=23 head_norm_before_train=1.801680 (no previous merge yet)
[S13] round=23 local utility u=0.112676 metrics={'f1_val': 0.6022987923955885, 'auprc': 0.6733987145557986, 'loss_val': 0.6560232005405995, 'psi': 0.6307387612596725}-{'f1_val': 0.5939936877184024, 'auprc': 0.6514853642914084, 'loss_val': 0.7658035902985294, 'psi': 0.6169903583476049}
[S14] START round=23 head_norm_before_train=1.448863 cos_to_last_merge=0.9989 (last merge round=21)
[S14] round=23 local utility u=0.025644 metrics={'f1_val': 0.997211058727947, 'auprc': 0.9991559056822737, 'loss_val': 0.18276680728234654, 'psi': 0.9979889975096777}-{'f1_val': 0.9975396023865201, 'auprc': 0.9988227538034302, 'loss_val': 0.2350260458612575, 'psi': 0.9980528629532841}
[S15] START round=23 head_norm_before_train=1.761314 cos_to_last_merge=0.7718 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.772
[S15] round=23 local utility u=1.000000 metrics={'f1_val': 0.9191378983146722, 'auprc': 0.9927733574433912, 'loss_val': 0.11749323339463194, 'psi': 0.9485920819661597}-{'f1_val': 0.6982671051931744, 'auprc': 0.8957451588788768, 'loss_val': 0.5451580335716492, 'psi': 0.7772583266674553}
[S16] START round=23 head_norm_before_train=1.124656 cos_to_last_merge=0.9944 (last merge round=20)
[S16] round=23 local utility u=0.103688 metrics={'f1_val': 0.9917921904815221, 'auprc': 0.996284106914183, 'loss_val': 0.21803794894919046, 'psi': 0.9935889570545865}-{'f1_val': 0.9734203621054135, 'auprc': 0.997328065104173, 'loss_val': 0.31831509498376537, 'psi': 0.9829834433049174}
[S17] START round=23 head_norm_before_train=1.708489 cos_to_last_merge=0.8189 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.819
[S17] round=23 local utility u=0.011773 metrics={'f1_val': 0.5953874918843995, 'auprc': 0.9693057829356128, 'loss_val': 0.7970629031886406, 'psi': 0.7449548083048848}-{'f1_val': 0.5921121535980414, 'auprc': 0.9639659765920907, 'loss_val': 0.7849371006843436, 'psi': 0.7408536827956611}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:58308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:58307
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:58304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S2] sending update (kind=head size=1792 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:58312
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1801) from S9
[S11] cosine check vs S9: cos=-0.1374
[S11] DROPPED delta from S9 (cos=-0.1374 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1797) from S14
[S7] cosine check vs S14: cos=0.9813
[S6] RECEIVED delta(kind=head bytes=1799) from S4
[S6] cosine check vs S4: cos=-0.1177
[S6] DROPPED delta from S4 (cos=-0.1177 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:58305
[S16] sending update (kind=head size=1798 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1798) from S16
[S5] cosine check vs S16: cos=0.9141
[S11] sending update (kind=head size=1800 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1800) from S11
[S4] cosine check vs S11: cos=0.9967
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=23 metric=0.6381 head_norm=0.977007
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.434059e-01
[S5] stored merged vector for next round verification (round=23)
[S5] DEBUG after merge:  round=23 metric=0.6283 head_norm=1.053432 delta_norm=0.243406
[S5] aggregate: ROLLBACK (f1_val pre=0.638 post=0.628 tol_abs=0.005 tol_rel=0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=23 metric=0.5181 head_norm=1.575161
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.549297e-01
[S7] stored merged vector for next round verification (round=23)
[S7] DEBUG after merge:  round=23 metric=0.5061 head_norm=1.521215 delta_norm=0.154930
[S7] aggregate: ROLLBACK (f1_val pre=0.518 post=0.506 tol_abs=0.005 tol_rel=0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=23 metric=0.9489 head_norm=1.997170
[S4] _apply_head_vector_avg (torch): Δ‖w‖=8.660016e-02
[S4] stored merged vector for next round verification (round=23)
[S4] DEBUG after merge:  round=23 metric=0.9489 head_norm=2.021595 delta_norm=0.086600
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=1.109282 cos_to_last_merge=0.9966 (last merge round=22)
[S2] round=24 local utility u=0.000000 metrics={'f1_val': 0.8325514829766574, 'auprc': 0.8833841923030558, 'loss_val': 0.35000027904390935, 'psi': 0.8528845667072167}-{'f1_val': 0.8984284284706504, 'auprc': 0.8602334820466032, 'loss_val': 0.28374001890197886, 'psi': 0.8831504499010316}
[S3] START round=24 head_norm_before_train=1.840860 (no previous merge yet)
[S3] round=24 local utility u=0.000000 metrics={'f1_val': 0.9792683065128885, 'auprc': 0.9988686275038419, 'loss_val': 0.11952909796186847, 'psi': 0.9871084349092699}-{'f1_val': 0.9953464457261353, 'auprc': 0.9986928229396212, 'loss_val': 0.07988220466948605, 'psi': 0.9966849966115296}
[S4] START round=24 head_norm_before_train=2.021595 cos_to_last_merge=1.0000 (last merge round=23)
[S4] round=24 local utility u=0.000000 metrics={'f1_val': 0.9475257616812752, 'auprc': 0.9629693311189372, 'loss_val': 0.28535410589701554, 'psi': 0.9537031894563401}-{'f1_val': 0.9489399197371045, 'auprc': 0.9597744614927544, 'loss_val': 0.27475246032069056, 'psi': 0.9532737364393644}
[S5] START round=24 head_norm_before_train=1.053432 cos_to_last_merge=1.0000 (last merge round=23)
[S5] round=24 local utility u=0.527444 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9923344828251417, 'loss_val': 0.34563089147965903, 'psi': 0.8171265835904049}-{'f1_val': 0.6381490081818797, 'auprc': 0.8422056261533166, 'loss_val': 0.5770985998198219, 'psi': 0.7197716553704545}
[S6] START round=24 head_norm_before_train=1.947636 (no previous merge yet)
[S6] round=24 local utility u=0.000000 metrics={'f1_val': 0.6762275990817328, 'auprc': 0.956771474260397, 'loss_val': 0.7326373725786473, 'psi': 0.7884451491531985}-{'f1_val': 0.7835035025768159, 'auprc': 0.9638211637358365, 'loss_val': 0.5903509230674072, 'psi': 0.8556305670404241}
[S7] START round=24 head_norm_before_train=1.521215 cos_to_last_merge=1.0000 (last merge round=23)
[S7] round=24 local utility u=0.816086 metrics={'f1_val': 0.6856355790542185, 'auprc': 0.8677641044407344, 'loss_val': 0.4743801995376254, 'psi': 0.7584869892088248}-{'f1_val': 0.5180859189729577, 'auprc': 0.7736996226099658, 'loss_val': 0.8190614838829138, 'psi': 0.6203314004277609}
[S8] START round=24 head_norm_before_train=1.752819 cos_to_last_merge=0.8150 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.815
[S8] round=24 local utility u=0.004549 metrics={'f1_val': 0.992765585815685, 'auprc': 0.9991815554743719, 'loss_val': 0.03634723696095278, 'psi': 0.9953319736791597}-{'f1_val': 0.991490485949629, 'auprc': 0.9991776133737109, 'loss_val': 0.0377826144880942, 'psi': 0.9945653369192617}
[S9] START round=24 head_norm_before_train=1.509056 cos_to_last_merge=0.9969 (last merge round=21)
[S9] round=24 local utility u=0.008507 metrics={'f1_val': 0.9937421749897083, 'auprc': 0.9977185017292065, 'loss_val': 0.08182326173616641, 'psi': 0.9953327056855077}-{'f1_val': 0.9937492462693716, 'auprc': 0.997841479694912, 'loss_val': 0.0992481208209275, 'psi': 0.9953861396395877}
[S10] START round=24 head_norm_before_train=2.002322 (no previous merge yet)
[S10] round=24 local utility u=0.000000 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9963266942356973, 'loss_val': 0.02866539365168424, 'psi': 0.9958964698032908}-{'f1_val': 0.9956096535150197, 'auprc': 0.99695951566387, 'loss_val': 0.028755848359459973, 'psi': 0.9961495983745599}
[S11] START round=24 head_norm_before_train=2.049390 cos_to_last_merge=0.9992 (last merge round=21)
[S11] round=24 local utility u=0.000000 metrics={'f1_val': 0.9810355740703895, 'auprc': 0.9987171363370319, 'loss_val': 0.08124021774878602, 'psi': 0.9881081989770464}-{'f1_val': 0.9971593530989756, 'auprc': 0.9982031509981395, 'loss_val': 0.06651742991485804, 'psi': 0.9975768722586412}
[S13] START round=24 head_norm_before_train=1.817425 (no previous merge yet)
[S13] round=24 local utility u=0.059788 metrics={'f1_val': 0.6313685049913339, 'auprc': 0.6661370957489585, 'loss_val': 0.6890812250359061, 'psi': 0.6452759412943838}-{'f1_val': 0.6022987923955885, 'auprc': 0.6733987145557986, 'loss_val': 0.6560232005405995, 'psi': 0.6307387612596725}
[S14] START round=24 head_norm_before_train=1.481575 cos_to_last_merge=0.9962 (last merge round=21)
[S14] round=24 local utility u=0.020206 metrics={'f1_val': 0.9974741268994111, 'auprc': 0.9987531941280154, 'loss_val': 0.14272430046705417, 'psi': 0.9979857537908527}-{'f1_val': 0.997211058727947, 'auprc': 0.9991559056822737, 'loss_val': 0.18276680728234654, 'psi': 0.9979889975096777}
[S15] START round=24 head_norm_before_train=1.783765 cos_to_last_merge=0.7699 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.770
[S15] round=24 local utility u=0.253429 metrics={'f1_val': 0.9907211261677082, 'auprc': 0.995083666341738, 'loss_val': 0.04706556018459197, 'psi': 0.9924661422373202}-{'f1_val': 0.9191378983146722, 'auprc': 0.9927733574433912, 'loss_val': 0.11749323339463194, 'psi': 0.9485920819661597}
[S16] START round=24 head_norm_before_train=1.176175 cos_to_last_merge=0.9886 (last merge round=20)
[S16] round=24 local utility u=0.012819 metrics={'f1_val': 0.9907237767477616, 'auprc': 0.9965855851993419, 'loss_val': 0.1868934990701796, 'psi': 0.9930685001283936}-{'f1_val': 0.9917921904815221, 'auprc': 0.996284106914183, 'loss_val': 0.21803794894919046, 'psi': 0.9935889570545865}
[S17] START round=24 head_norm_before_train=1.732280 cos_to_last_merge=0.8178 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.818
[S17] round=24 local utility u=0.000000 metrics={'f1_val': 0.5191865468177558, 'auprc': 0.7227652424238138, 'loss_val': 1.1987627403724677, 'psi': 0.600618025060179}-{'f1_val': 0.5953874918843995, 'auprc': 0.9693057829356128, 'loss_val': 0.7970629031886406, 'psi': 0.7449548083048848}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S11@127.0.0.1:58312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] → sending delta(kind=head bytes=1793) to S2@127.0.0.1:58302
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:58309
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:58308
[S5] sending update (kind=head size=1793 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1793) from S5
[S2] cosine check vs S5: cos=0.3971
[S8] RECEIVED delta(kind=head bytes=1799) from S7
[S8] cosine check vs S7: cos=0.9616
[S7] RECEIVED delta(kind=head bytes=1797) from S14
[S7] cosine check vs S14: cos=0.9915
[S11] RECEIVED delta(kind=head bytes=1803) from S9
[S11] cosine check vs S9: cos=-0.1390
[S11] DROPPED delta from S9 (cos=-0.1390 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:58305
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1797 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1797) from S16
[S5] cosine check vs S16: cos=0.9785
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=24 metric=0.9928 head_norm=1.764808
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.543780e-01
[S8] stored merged vector for next round verification (round=24)
[S8] DEBUG after merge:  round=24 metric=0.9928 head_norm=1.636990 delta_norm=0.254378
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=24 metric=0.7003 head_norm=1.086614
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.382102e-01
[S5] stored merged vector for next round verification (round=24)
[S5] DEBUG after merge:  round=24 metric=0.7003 head_norm=1.149507 delta_norm=0.138210
[S5] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=24 metric=0.6856 head_norm=1.540889
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.002015e-01
[S7] stored merged vector for next round verification (round=24)
[S7] DEBUG after merge:  round=24 metric=0.6846 head_norm=1.525464 delta_norm=0.100201
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=24 metric=0.8326 head_norm=1.230241
[S2] _apply_head_vector_avg (torch): Δ‖w‖=6.388509e-01
[S2] stored merged vector for next round verification (round=24)
[S2] DEBUG after merge:  round=24 metric=0.8305 head_norm=0.969010 delta_norm=0.638851
[S2] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=25 head_norm_before_train=0.969010 cos_to_last_merge=1.0000 (last merge round=24)
[S2] round=25 local utility u=0.000000 metrics={'f1_val': 0.7780695691809503, 'auprc': 0.8005204487785339, 'loss_val': 0.4842905358240333, 'psi': 0.7870499210199837}-{'f1_val': 0.8325514829766574, 'auprc': 0.8833841923030558, 'loss_val': 0.35000027904390935, 'psi': 0.8528845667072167}
[S3] START round=25 head_norm_before_train=1.861573 (no previous merge yet)
[S3] round=25 local utility u=0.000000 metrics={'f1_val': 0.9611152572344858, 'auprc': 0.9986909145575753, 'loss_val': 0.09921732718338956, 'psi': 0.9761455201637216}-{'f1_val': 0.9792683065128885, 'auprc': 0.9988686275038419, 'loss_val': 0.11952909796186847, 'psi': 0.9871084349092699}
[S4] START round=25 head_norm_before_train=2.034057 cos_to_last_merge=1.0000 (last merge round=23)
[S4] round=25 local utility u=0.000000 metrics={'f1_val': 0.9389509558218497, 'auprc': 0.9199866845852187, 'loss_val': 0.3106942079874953, 'psi': 0.9313652473271974}-{'f1_val': 0.9475257616812752, 'auprc': 0.9629693311189372, 'loss_val': 0.28535410589701554, 'psi': 0.9537031894563401}
[S5] START round=25 head_norm_before_train=1.149507 cos_to_last_merge=1.0000 (last merge round=24)
[S5] round=25 local utility u=0.017576 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9924620136575413, 'loss_val': 0.3108620159281644, 'psi': 0.8171775959233647}-{'f1_val': 0.7003213174339138, 'auprc': 0.9923344828251417, 'loss_val': 0.34563089147965903, 'psi': 0.8171265835904049}
[S6] START round=25 head_norm_before_train=1.961700 (no previous merge yet)
[S6] round=25 local utility u=0.301235 metrics={'f1_val': 0.7720750232492067, 'auprc': 0.9490173829744422, 'loss_val': 0.6819902139050732, 'psi': 0.8428519671393009}-{'f1_val': 0.6762275990817328, 'auprc': 0.956771474260397, 'loss_val': 0.7326373725786473, 'psi': 0.7884451491531985}
[S7] START round=25 head_norm_before_train=1.525464 cos_to_last_merge=1.0000 (last merge round=24)
[S7] round=25 local utility u=0.000000 metrics={'f1_val': 0.6367581073056737, 'auprc': 0.7960411219834652, 'loss_val': 0.6131864433287761, 'psi': 0.7004713131767903}-{'f1_val': 0.6856355790542185, 'auprc': 0.8677641044407344, 'loss_val': 0.4743801995376254, 'psi': 0.7584869892088248}
[S8] START round=25 head_norm_before_train=1.636990 cos_to_last_merge=1.0000 (last merge round=24)
[S8] round=25 local utility u=0.000000 metrics={'f1_val': 0.9940378564874953, 'auprc': 0.9915508083292616, 'loss_val': 0.041701996627898974, 'psi': 0.9930430372242018}-{'f1_val': 0.992765585815685, 'auprc': 0.9991815554743719, 'loss_val': 0.03634723696095278, 'psi': 0.9953319736791597}
[S9] START round=25 head_norm_before_train=1.540350 cos_to_last_merge=0.9942 (last merge round=21)
[S9] round=25 local utility u=0.017689 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9981340698975023, 'loss_val': 0.06520291858991002, 'psi': 0.9972499350473358}-{'f1_val': 0.9937421749897083, 'auprc': 0.9977185017292065, 'loss_val': 0.08182326173616641, 'psi': 0.9953327056855077}
[S10] START round=25 head_norm_before_train=2.018635 (no previous merge yet)
[S10] round=25 local utility u=0.000000 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9946420455972618, 'loss_val': 0.029105627799164195, 'psi': 0.9952226103479166}-{'f1_val': 0.9956096535150197, 'auprc': 0.9963266942356973, 'loss_val': 0.02866539365168424, 'psi': 0.9958964698032908}
[S11] START round=25 head_norm_before_train=2.073262 cos_to_last_merge=0.9985 (last merge round=21)
[S11] round=25 local utility u=0.069692 metrics={'f1_val': 0.9974011907167429, 'auprc': 0.9989666521471882, 'loss_val': 0.04079925816736988, 'psi': 0.998027375288921}-{'f1_val': 0.9810355740703895, 'auprc': 0.9987171363370319, 'loss_val': 0.08124021774878602, 'psi': 0.9881081989770464}
[S13] START round=25 head_norm_before_train=1.818190 (no previous merge yet)
[S13] round=25 local utility u=0.018596 metrics={'f1_val': 0.6572320638923818, 'auprc': 0.6715065277211021, 'loss_val': 0.8231779754107227, 'psi': 0.6629418494238699}-{'f1_val': 0.6313685049913339, 'auprc': 0.6661370957489585, 'loss_val': 0.6890812250359061, 'psi': 0.6452759412943838}
[S14] START round=25 head_norm_before_train=1.516517 cos_to_last_merge=0.9923 (last merge round=21)
[S14] round=25 local utility u=0.000756 metrics={'f1_val': 0.9961701069502772, 'auprc': 0.9942217991151668, 'loss_val': 0.11979327729096134, 'psi': 0.995390783816233}-{'f1_val': 0.9974741268994111, 'auprc': 0.9987531941280154, 'loss_val': 0.14272430046705417, 'psi': 0.9979857537908527}
[S15] START round=25 head_norm_before_train=1.804847 cos_to_last_merge=0.7682 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.768
[S15] round=25 local utility u=0.000000 metrics={'f1_val': 0.9844358274184636, 'auprc': 0.9919842443386595, 'loss_val': 0.051953046071157055, 'psi': 0.9874551941865419}-{'f1_val': 0.9907211261677082, 'auprc': 0.995083666341738, 'loss_val': 0.04706556018459197, 'psi': 0.9924661422373202}
[S16] START round=25 head_norm_before_train=1.224828 cos_to_last_merge=0.9824 (last merge round=20)
[S16] round=25 local utility u=0.028680 metrics={'f1_val': 0.9926537735173722, 'auprc': 0.9974038741800012, 'loss_val': 0.1435681296788192, 'psi': 0.9945538137824238}-{'f1_val': 0.9907237767477616, 'auprc': 0.9965855851993419, 'loss_val': 0.1868934990701796, 'psi': 0.9930685001283936}
[S17] START round=25 head_norm_before_train=1.757095 cos_to_last_merge=0.8168 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.817
[S17] round=25 local utility u=0.439658 metrics={'f1_val': 0.5791954586237039, 'auprc': 0.8386511993601952, 'loss_val': 1.0271584776441394, 'psi': 0.6829777549183005}-{'f1_val': 0.5191865468177558, 'auprc': 0.7227652424238138, 'loss_val': 1.1987627403724677, 'psi': 0.600618025060179}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] → sending delta(kind=head bytes=1793) to S4@127.0.0.1:58304
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:58305
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:58312
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:58316
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:58302
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:58308
[S14] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1793 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1801) from S6
[S16] cosine check vs S6: cos=-0.0589
[S16] DROPPED delta from S6 (cos=-0.0589 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1797) from S16
[S5] cosine check vs S16: cos=0.9923
[S11] RECEIVED delta(kind=head bytes=1801) from S9
[S11] cosine check vs S9: cos=-0.1403
[S11] DROPPED delta from S9 (cos=-0.1403 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1797) from S5
[S2] cosine check vs S5: cos=0.6993
[S7] RECEIVED delta(kind=head bytes=1797) from S14
[S7] cosine check vs S14: cos=0.9953
[S4] RECEIVED delta(kind=head bytes=1793) from S11
[S4] cosine check vs S11: cos=0.9973
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=25 metric=0.9390 head_norm=2.043472
[S4] _apply_head_vector_avg (torch): Δ‖w‖=8.067606e-02
[S4] stored merged vector for next round verification (round=25)
[S4] DEBUG after merge:  round=25 metric=0.9394 head_norm=2.068889 delta_norm=0.080676
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.054 → S6@127.0.0.1:58307
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=25 metric=0.6368 head_norm=1.544696
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.502175e-02
[S7] stored merged vector for next round verification (round=25)
[S7] DEBUG after merge:  round=25 metric=0.6317 head_norm=1.544436 delta_norm=0.075022
[S7] aggregate: ROLLBACK (f1_val pre=0.637 post=0.632 tol_abs=0.005 tol_rel=0.0)
[S7] ⇄ pheromone p=0.258 → S8@127.0.0.1:58309
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=25 metric=0.7781 head_norm=1.088308
[S2] _apply_head_vector_avg (torch): Δ‖w‖=4.406007e-01
[S2] stored merged vector for next round verification (round=25)
[S2] DEBUG after merge:  round=25 metric=0.7364 head_norm=1.043303 delta_norm=0.440601
[S2] aggregate: ROLLBACK (f1_val pre=0.778 post=0.736 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=25 metric=0.7003 head_norm=1.175078
[S5] _apply_head_vector_avg (torch): Δ‖w‖=9.049486e-02
[S5] stored merged vector for next round verification (round=25)
[S5] DEBUG after merge:  round=25 metric=0.7003 head_norm=1.221871 delta_norm=0.090495
[S5] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.208 → S2@127.0.0.1:58302
[S9] ⇄ pheromone p=0.085 → S11@127.0.0.1:58312
[S11] ⇄ pheromone p=0.092 → S4@127.0.0.1:58304
[S6] ⇄ pheromone p=0.187 → S16@127.0.0.1:58316
[S8] ⇄ pheromone p=0.025 → S7@127.0.0.1:58308
[S14] ⇄ pheromone p=0.062 → S7@127.0.0.1:58308
[S16] ⇄ pheromone p=0.146 → S6@127.0.0.1:58307
[S2] START round=26 head_norm_before_train=1.043303 cos_to_last_merge=1.0000 (last merge round=25)
[S2] round=26 local utility u=0.341787 metrics={'f1_val': 0.8361348641468329, 'auprc': 0.8721561777831931, 'loss_val': 0.3640146944082472, 'psi': 0.850543389601377}-{'f1_val': 0.7780695691809503, 'auprc': 0.8005204487785339, 'loss_val': 0.4842905358240333, 'psi': 0.7870499210199837}
[S3] START round=26 head_norm_before_train=1.883883 (no previous merge yet)
[S3] round=26 local utility u=0.105915 metrics={'f1_val': 0.9936241426684975, 'auprc': 0.9988652123037536, 'loss_val': 0.08296269047536699, 'psi': 0.9957205705226}-{'f1_val': 0.9611152572344858, 'auprc': 0.9986909145575753, 'loss_val': 0.09921732718338956, 'psi': 0.9761455201637216}
[S4] START round=26 head_norm_before_train=2.068889 cos_to_last_merge=1.0000 (last merge round=25)
[S4] round=26 local utility u=0.101294 metrics={'f1_val': 0.946488713126546, 'auprc': 0.9665392869998756, 'loss_val': 0.2929913782636755, 'psi': 0.9545089426758778}-{'f1_val': 0.9389509558218497, 'auprc': 0.9199866845852187, 'loss_val': 0.3106942079874953, 'psi': 0.9313652473271974}
[S5] START round=26 head_norm_before_train=1.221871 cos_to_last_merge=1.0000 (last merge round=25)
[S5] round=26 local utility u=0.000000 metrics={'f1_val': 0.6211229041198317, 'auprc': 0.8579454440637108, 'loss_val': 0.4807104198953849, 'psi': 0.7158519200973834}-{'f1_val': 0.7003213174339138, 'auprc': 0.9924620136575413, 'loss_val': 0.3108620159281644, 'psi': 0.8171775959233647}
[S6] START round=26 head_norm_before_train=1.978220 (no previous merge yet)
[S6] round=26 local utility u=0.000000 metrics={'f1_val': 0.6979346705239057, 'auprc': 0.9547201799483988, 'loss_val': 0.7011875109669824, 'psi': 0.8006488742937029}-{'f1_val': 0.7720750232492067, 'auprc': 0.9490173829744422, 'loss_val': 0.6819902139050732, 'psi': 0.8428519671393009}
[S7] START round=26 head_norm_before_train=1.544436 cos_to_last_merge=1.0000 (last merge round=25)
[S7] round=26 local utility u=0.000000 metrics={'f1_val': 0.5023105883080075, 'auprc': 0.7729666383116687, 'loss_val': 0.8770505765278078, 'psi': 0.610573008309472}-{'f1_val': 0.6367581073056737, 'auprc': 0.7960411219834652, 'loss_val': 0.6131864433287761, 'psi': 0.7004713131767903}
[S8] START round=26 head_norm_before_train=1.654050 cos_to_last_merge=1.0000 (last merge round=24)
[S8] round=26 local utility u=0.010181 metrics={'f1_val': 0.9930017911527874, 'auprc': 0.9991631997610102, 'loss_val': 0.03796005682040546, 'psi': 0.9954663545960765}-{'f1_val': 0.9940378564874953, 'auprc': 0.9915508083292616, 'loss_val': 0.041701996627898974, 'psi': 0.9930430372242018}
[S9] START round=26 head_norm_before_train=1.568908 cos_to_last_merge=0.9916 (last merge round=21)
[S9] round=26 local utility u=0.000000 metrics={'f1_val': 0.9887042205730695, 'auprc': 0.9979000303511505, 'loss_val': 0.07240212515299739, 'psi': 0.992382544484302}-{'f1_val': 0.9966605118138915, 'auprc': 0.9981340698975023, 'loss_val': 0.06520291858991002, 'psi': 0.9972499350473358}
[S10] START round=26 head_norm_before_train=2.033015 (no previous merge yet)
[S10] round=26 local utility u=0.003892 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9966361418946688, 'loss_val': 0.02730366383385289, 'psi': 0.9960202488668795}-{'f1_val': 0.9956096535150197, 'auprc': 0.9946420455972618, 'loss_val': 0.029105627799164195, 'psi': 0.9952226103479166}
[S11] START round=26 head_norm_before_train=2.097104 cos_to_last_merge=0.9975 (last merge round=21)
[S11] round=26 local utility u=0.003993 metrics={'f1_val': 0.9978376696242038, 'auprc': 0.9993073861725953, 'loss_val': 0.036453518985522425, 'psi': 0.9984255562435604}-{'f1_val': 0.9974011907167429, 'auprc': 0.9989666521471882, 'loss_val': 0.04079925816736988, 'psi': 0.998027375288921}
[S13] START round=26 head_norm_before_train=1.822576 (no previous merge yet)
[S13] round=26 local utility u=0.000000 metrics={'f1_val': 0.6273301488791065, 'auprc': 0.6662367974512383, 'loss_val': 0.7164959886963657, 'psi': 0.6428928083079593}-{'f1_val': 0.6572320638923818, 'auprc': 0.6715065277211021, 'loss_val': 0.8231779754107227, 'psi': 0.6629418494238699}
[S14] START round=26 head_norm_before_train=1.547817 cos_to_last_merge=0.9887 (last merge round=21)
[S14] round=26 local utility u=0.018413 metrics={'f1_val': 0.9970637462143206, 'auprc': 0.9986704113589605, 'loss_val': 0.10167567036456605, 'psi': 0.9977064122721766}-{'f1_val': 0.9961701069502772, 'auprc': 0.9942217991151668, 'loss_val': 0.11979327729096134, 'psi': 0.995390783816233}
[S15] START round=26 head_norm_before_train=1.823577 cos_to_last_merge=0.7668 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.767
[S15] round=26 local utility u=0.000000 metrics={'f1_val': 0.7821229178641449, 'auprc': 0.9527715242219037, 'loss_val': 0.4040442856840947, 'psi': 0.8503823604072485}-{'f1_val': 0.9844358274184636, 'auprc': 0.9919842443386595, 'loss_val': 0.051953046071157055, 'psi': 0.9874551941865419}
[S16] START round=26 head_norm_before_train=1.273384 cos_to_last_merge=0.9770 (last merge round=20)
[S16] round=26 local utility u=0.011995 metrics={'f1_val': 0.9925136343127123, 'auprc': 0.9977000724481361, 'loss_val': 0.11962520999401174, 'psi': 0.9945882095668818}-{'f1_val': 0.9926537735173722, 'auprc': 0.9974038741800012, 'loss_val': 0.1435681296788192, 'psi': 0.9945538137824238}
[S17] START round=26 head_norm_before_train=1.775341 cos_to_last_merge=0.8161 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.816
[S17] round=26 local utility u=0.370926 metrics={'f1_val': 0.6028331792982957, 'auprc': 0.9888309347265457, 'loss_val': 0.8776729842178995, 'psi': 0.7572322814695958}-{'f1_val': 0.5791954586237039, 'auprc': 0.8386511993601952, 'loss_val': 1.0271584776441394, 'psi': 0.6829777549183005}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:58304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:58308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S4] → sending delta(kind=head bytes=1790) to S6@127.0.0.1:58307
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1801) from S2
[S5] cosine check vs S2: cos=0.8286
[S7] RECEIVED delta(kind=head bytes=1801) from S14
[S7] cosine check vs S14: cos=0.9969
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S17] sending update (kind=head size=1806 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:58307
[S16] sending update (kind=head size=1798 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1798) from S16
[S6] cosine check vs S16: cos=-0.0618
[S6] DROPPED delta from S16 (cos=-0.0618 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:58308
[S8] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1790 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1798) from S11
[S4] cosine check vs S11: cos=0.9987
[S6] RECEIVED delta(kind=head bytes=1790) from S4
[S6] cosine check vs S4: cos=-0.1236
[S6] DROPPED delta from S4 (cos=-0.1236 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1797) from S8
[S7] cosine check vs S8: cos=0.9715
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=26 metric=0.6211 head_norm=1.240616
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.534392e-01
[S5] stored merged vector for next round verification (round=26)
[S5] DEBUG after merge:  round=26 metric=0.6277 head_norm=1.147365 delta_norm=0.353439
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=26 metric=0.5023 head_norm=1.563711
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.896235e-02
[S7] stored merged vector for next round verification (round=26)
[S7] DEBUG after merge:  round=26 metric=0.4902 head_norm=1.582923 delta_norm=0.088962
[S7] aggregate: ROLLBACK (f1_val pre=0.502 post=0.490 tol_abs=0.005 tol_rel=0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=26 metric=0.9465 head_norm=2.073765
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.846544e-02
[S4] stored merged vector for next round verification (round=26)
[S4] DEBUG after merge:  round=26 metric=0.9469 head_norm=2.095775 delta_norm=0.058465
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=27 head_norm_before_train=1.159139 cos_to_last_merge=0.9781 (last merge round=25)
[S2] round=27 local utility u=0.000000 metrics={'f1_val': 0.8277794235250202, 'auprc': 0.8734282306647582, 'loss_val': 0.4048077560800873, 'psi': 0.8460389463809155}-{'f1_val': 0.8361348641468329, 'auprc': 0.8721561777831931, 'loss_val': 0.3640146944082472, 'psi': 0.850543389601377}
[S3] START round=27 head_norm_before_train=1.903951 (no previous merge yet)
[S3] round=27 local utility u=0.000000 metrics={'f1_val': 0.9608296089712303, 'auprc': 0.998338211904995, 'loss_val': 0.09572894932532436, 'psi': 0.9758330501447361}-{'f1_val': 0.9936241426684975, 'auprc': 0.9988652123037536, 'loss_val': 0.08296269047536699, 'psi': 0.9957205705226}
[S4] START round=27 head_norm_before_train=2.095775 cos_to_last_merge=1.0000 (last merge round=26)
[S4] round=27 local utility u=0.000000 metrics={'f1_val': 0.9421142853253553, 'auprc': 0.9528854350389414, 'loss_val': 0.30751661624821053, 'psi': 0.9464227452107898}-{'f1_val': 0.946488713126546, 'auprc': 0.9665392869998756, 'loss_val': 0.2929913782636755, 'psi': 0.9545089426758778}
[S5] START round=27 head_norm_before_train=1.147365 cos_to_last_merge=1.0000 (last merge round=26)
[S5] round=27 local utility u=0.524308 metrics={'f1_val': 0.7005691551769304, 'auprc': 0.9923633926027161, 'loss_val': 0.3120261568410137, 'psi': 0.8172868501472448}-{'f1_val': 0.6211229041198317, 'auprc': 0.8579454440637108, 'loss_val': 0.4807104198953849, 'psi': 0.7158519200973834}
[S6] START round=27 head_norm_before_train=1.985890 (no previous merge yet)
[S6] round=27 local utility u=0.328313 metrics={'f1_val': 0.7802238352794679, 'auprc': 0.9539322235654835, 'loss_val': 0.5359328249411169, 'psi': 0.8497071905938741}-{'f1_val': 0.6979346705239057, 'auprc': 0.9547201799483988, 'loss_val': 0.7011875109669824, 'psi': 0.8006488742937029}
[S7] START round=27 head_norm_before_train=1.582923 cos_to_last_merge=1.0000 (last merge round=26)
[S7] round=27 local utility u=0.756300 metrics={'f1_val': 0.6727394898462978, 'auprc': 0.8125273463548374, 'loss_val': 0.5057068953725681, 'psi': 0.7286546324497136}-{'f1_val': 0.5023105883080075, 'auprc': 0.7729666383116687, 'loss_val': 0.8770505765278078, 'psi': 0.610573008309472}
[S8] START round=27 head_norm_before_train=1.670953 cos_to_last_merge=0.9999 (last merge round=24)
[S8] round=27 local utility u=0.000000 metrics={'f1_val': 0.9920979054933599, 'auprc': 0.9992038477425174, 'loss_val': 0.03988596845579471, 'psi': 0.9949402823930229}-{'f1_val': 0.9930017911527874, 'auprc': 0.9991631997610102, 'loss_val': 0.03796005682040546, 'psi': 0.9954663545960765}
[S9] START round=27 head_norm_before_train=1.594641 cos_to_last_merge=0.9893 (last merge round=21)
[S9] round=27 local utility u=0.032919 metrics={'f1_val': 0.9958601375429889, 'auprc': 0.9980485372032928, 'loss_val': 0.049944326329701916, 'psi': 0.9967354974071103}-{'f1_val': 0.9887042205730695, 'auprc': 0.9979000303511505, 'loss_val': 0.07240212515299739, 'psi': 0.992382544484302}
[S10] START round=27 head_norm_before_train=2.046776 (no previous merge yet)
[S10] round=27 local utility u=0.000244 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.996653720481381, 'loss_val': 0.026868538176139125, 'psi': 0.9960272803015643}-{'f1_val': 0.9956096535150197, 'auprc': 0.9966361418946688, 'loss_val': 0.02730366383385289, 'psi': 0.9960202488668795}
[S11] START round=27 head_norm_before_train=2.119171 cos_to_last_merge=0.9965 (last merge round=21)
[S11] round=27 local utility u=0.001177 metrics={'f1_val': 0.9974011907167429, 'auprc': 0.9991434045551235, 'loss_val': 0.030989590147518665, 'psi': 0.9980980762520952}-{'f1_val': 0.9978376696242038, 'auprc': 0.9993073861725953, 'loss_val': 0.036453518985522425, 'psi': 0.9984255562435604}
[S13] START round=27 head_norm_before_train=1.834246 (no previous merge yet)
[S13] round=27 local utility u=0.000000 metrics={'f1_val': 0.6193793079283978, 'auprc': 0.7025115471720069, 'loss_val': 0.7863704776501352, 'psi': 0.6526322036258414}-{'f1_val': 0.6273301488791065, 'auprc': 0.6662367974512383, 'loss_val': 0.7164959886963657, 'psi': 0.6428928083079593}
[S14] START round=27 head_norm_before_train=1.576268 cos_to_last_merge=0.9854 (last merge round=21)
[S14] round=27 local utility u=0.007980 metrics={'f1_val': 0.9965574496053289, 'auprc': 0.9990027029593951, 'loss_val': 0.08367575175246578, 'psi': 0.9975355509469553}-{'f1_val': 0.9970637462143206, 'auprc': 0.9986704113589605, 'loss_val': 0.10167567036456605, 'psi': 0.9977064122721766}
[S15] START round=27 head_norm_before_train=1.840600 cos_to_last_merge=0.7657 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.766
[S15] round=27 local utility u=0.000000 metrics={'f1_val': 0.7001671235595208, 'auprc': 0.9101465979791994, 'loss_val': 0.5840633955251524, 'psi': 0.7841589133273923}-{'f1_val': 0.7821229178641449, 'auprc': 0.9527715242219037, 'loss_val': 0.4040442856840947, 'psi': 0.8503823604072485}
[S16] START round=27 head_norm_before_train=1.318113 cos_to_last_merge=0.9719 (last merge round=20)
[S16] round=27 local utility u=0.008781 metrics={'f1_val': 0.9926537735173722, 'auprc': 0.9979989144065327, 'loss_val': 0.10380044465765526, 'psi': 0.9947918298730364}-{'f1_val': 0.9925136343127123, 'auprc': 0.9977000724481361, 'loss_val': 0.11962520999401174, 'psi': 0.9945882095668818}
[S17] START round=27 head_norm_before_train=1.790431 cos_to_last_merge=0.8157 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.816
[S17] round=27 local utility u=0.000000 metrics={'f1_val': 0.5742477558958932, 'auprc': 0.7904413500051798, 'loss_val': 1.0552098943816115, 'psi': 0.6607251935396079}-{'f1_val': 0.6028331792982957, 'auprc': 0.9888309347265457, 'loss_val': 0.8776729842178995, 'psi': 0.7572322814695958}
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S16
[S8]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S16
[S5]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[S2]  timeout peer S3
[S2]  timeout peer S4
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S8
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S16
[S14]  timeout peer S17
[S3]  timeout peer S2
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:58312
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S11] → sending delta(kind=head bytes=1792) to S4@127.0.0.1:58304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:58307
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] → sending delta(kind=head bytes=1805) to S7@127.0.0.1:58308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] sending update (kind=head size=1794 to 1 peers)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:58316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S2@127.0.0.1:58302
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1792 to 1 peers)
[S14] sending update (kind=head size=1805 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1800) from S16
[S6] cosine check vs S16: cos=-0.0619
[S6] DROPPED delta from S16 (cos=-0.0619 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1792) from S11
[S4] cosine check vs S11: cos=0.9993
[S2] RECEIVED delta(kind=head bytes=1803) from S5
[S2] cosine check vs S5: cos=0.9117
[S7] RECEIVED delta(kind=head bytes=1805) from S14
[S7] cosine check vs S14: cos=0.9919
[S11] RECEIVED delta(kind=head bytes=1800) from S9
[S11] cosine check vs S9: cos=-0.1421
[S11] DROPPED delta from S9 (cos=-0.1421 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1801) from S6
[S16] cosine check vs S6: cos=-0.0619
[S16] DROPPED delta from S6 (cos=-0.0619 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:58314
[S7] sending update (kind=head size=1796 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1796) from S7
[S14] cosine check vs S7: cos=0.9919
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=27 metric=0.6727 head_norm=1.601154
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.022951e-01
[S7] stored merged vector for next round verification (round=27)
[S7] DEBUG after merge:  round=27 metric=0.6673 head_norm=1.599547 delta_norm=0.102295
[S7] aggregate: ROLLBACK (f1_val pre=0.673 post=0.667 tol_abs=0.005 tol_rel=0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=27 metric=0.9421 head_norm=2.101693
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.446322e-02
[S4] stored merged vector for next round verification (round=27)
[S4] DEBUG after merge:  round=27 metric=0.9421 head_norm=2.120408 delta_norm=0.044463
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=27 metric=0.9966 head_norm=1.604475
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.022952e-01
[S14] stored merged vector for next round verification (round=27)
[S14] DEBUG after merge:  round=27 metric=0.9966 head_norm=1.599547 delta_norm=0.102295
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S5] CommDone barrier timeout: have=2 need=4 — continuing
[S2] START round=28 head_norm_before_train=1.274637 cos_to_last_merge=0.9477 (last merge round=25)
[S2] ⚠️ Model drifted since last merge! cos=0.948
[S2] round=28 local utility u=0.066301 metrics={'f1_val': 0.8310684878493383, 'auprc': 0.895170830753407, 'loss_val': 0.35716713340937095, 'psi': 0.8567094250109657}-{'f1_val': 0.8277794235250202, 'auprc': 0.8734282306647582, 'loss_val': 0.4048077560800873, 'psi': 0.8460389463809155}
[S3] START round=28 head_norm_before_train=1.924082 (no previous merge yet)
[S3] round=28 local utility u=0.011148 metrics={'f1_val': 0.9612927942165166, 'auprc': 0.9984609531546311, 'loss_val': 0.07658033659545173, 'psi': 0.9761600577917624}-{'f1_val': 0.9608296089712303, 'auprc': 0.998338211904995, 'loss_val': 0.09572894932532436, 'psi': 0.9758330501447361}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=28 head_norm_before_train=2.120408 cos_to_last_merge=1.0000 (last merge round=27)
[S4] round=28 local utility u=0.000000 metrics={'f1_val': 0.9401282941004727, 'auprc': 0.9341185563443943, 'loss_val': 0.30533187999687644, 'psi': 0.9377243989980414}-{'f1_val': 0.9421142853253553, 'auprc': 0.9528854350389414, 'loss_val': 0.30751661624821053, 'psi': 0.9464227452107898}
[S5] START round=28 head_norm_before_train=1.162196 cos_to_last_merge=0.9998 (last merge round=26)
[S5] round=28 local utility u=0.000000 metrics={'f1_val': 0.6185131419916013, 'auprc': 0.8578291544774139, 'loss_val': 0.4796602406517913, 'psi': 0.7142395469859264}-{'f1_val': 0.7005691551769304, 'auprc': 0.9923633926027161, 'loss_val': 0.3120261568410137, 'psi': 0.8172868501472448}
[S6] START round=28 head_norm_before_train=1.988430 (no previous merge yet)
[S6] round=28 local utility u=0.000000 metrics={'f1_val': 0.6476386242819696, 'auprc': 0.9603810713048594, 'loss_val': 0.8007094464903601, 'psi': 0.7727356030911254}-{'f1_val': 0.7802238352794679, 'auprc': 0.9539322235654835, 'loss_val': 0.5359328249411169, 'psi': 0.8497071905938741}
[S7] START round=28 head_norm_before_train=1.599547 cos_to_last_merge=1.0000 (last merge round=27)
[S7] round=28 local utility u=0.000000 metrics={'f1_val': 0.5703555161104749, 'auprc': 0.7770362618505082, 'loss_val': 0.7585277235809247, 'psi': 0.6530278144064883}-{'f1_val': 0.6727394898462978, 'auprc': 0.8125273463548374, 'loss_val': 0.5057068953725681, 'psi': 0.7286546324497136}
[S8] START round=28 head_norm_before_train=1.684648 cos_to_last_merge=0.9997 (last merge round=24)
[S8] round=28 local utility u=0.004162 metrics={'f1_val': 0.9930017911527874, 'auprc': 0.9991870440943375, 'loss_val': 0.03693501465467149, 'psi': 0.9954758923294074}-{'f1_val': 0.9920979054933599, 'auprc': 0.9992038477425174, 'loss_val': 0.03988596845579471, 'psi': 0.9949402823930229}
[S9] START round=28 head_norm_before_train=1.616584 cos_to_last_merge=0.9874 (last merge round=21)
[S9] round=28 local utility u=0.000000 metrics={'f1_val': 0.985716065895656, 'auprc': 0.9975371236415382, 'loss_val': 0.07285598979523199, 'psi': 0.9904444889940089}-{'f1_val': 0.9958601375429889, 'auprc': 0.9980485372032928, 'loss_val': 0.049944326329701916, 'psi': 0.9967354974071103}
[S10] START round=28 head_norm_before_train=2.062139 (no previous merge yet)
[S10] round=28 local utility u=0.000000 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.994804079285837, 'loss_val': 0.027096811110021487, 'psi': 0.9952874238233467}-{'f1_val': 0.9956096535150197, 'auprc': 0.996653720481381, 'loss_val': 0.026868538176139125, 'psi': 0.9960272803015643}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=28 head_norm_before_train=2.139883 cos_to_last_merge=0.9955 (last merge round=21)
[S11] round=28 local utility u=0.000000 metrics={'f1_val': 0.9967460138064482, 'auprc': 0.9988985014791967, 'loss_val': 0.02975162392817318, 'psi': 0.9976070088755477}-{'f1_val': 0.9974011907167429, 'auprc': 0.9991434045551235, 'loss_val': 0.030989590147518665, 'psi': 0.9980980762520952}
[S13] START round=28 head_norm_before_train=1.839838 (no previous merge yet)
[S13] round=28 local utility u=0.000000 metrics={'f1_val': 0.6019549873825429, 'auprc': 0.6692926135602977, 'loss_val': 0.824716264333211, 'psi': 0.6288900378536448}-{'f1_val': 0.6193793079283978, 'auprc': 0.7025115471720069, 'loss_val': 0.7863704776501352, 'psi': 0.6526322036258414}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=28 head_norm_before_train=1.599547 cos_to_last_merge=1.0000 (last merge round=27)
[S14] round=28 local utility u=0.000000 metrics={'f1_val': 0.9626703055912986, 'auprc': 0.9985519322616625, 'loss_val': 0.12722096472915265, 'psi': 0.9770229562594442}-{'f1_val': 0.9965574496053289, 'auprc': 0.9990027029593951, 'loss_val': 0.08367575175246578, 'psi': 0.9975355509469553}
[S15] START round=28 head_norm_before_train=1.859621 cos_to_last_merge=0.7641 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.764
[S15] round=28 local utility u=1.000000 metrics={'f1_val': 0.992785030910577, 'auprc': 0.9976911638291861, 'loss_val': 0.04034499667983546, 'psi': 0.9947474840780206}-{'f1_val': 0.7001671235595208, 'auprc': 0.9101465979791994, 'loss_val': 0.5840633955251524, 'psi': 0.7841589133273923}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] sending update (kind=head size=1803 to 1 peers)
[S16] START round=28 head_norm_before_train=1.359411 cos_to_last_merge=0.9673 (last merge round=20)
[S16] round=28 local utility u=0.000000 metrics={'f1_val': 0.9860999272672292, 'auprc': 0.9981996675051908, 'loss_val': 0.13261071722028692, 'psi': 0.9909398233624138}-{'f1_val': 0.9926537735173722, 'auprc': 0.9979989144065327, 'loss_val': 0.10380044465765526, 'psi': 0.9947918298730364}
[S17] START round=28 head_norm_before_train=1.804145 cos_to_last_merge=0.8153 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.815
[S17] round=28 local utility u=0.000000 metrics={'f1_val': 0.5592457159007117, 'auprc': 0.7266763674378627, 'loss_val': 1.1169274628926642, 'psi': 0.6262179765155721}-{'f1_val': 0.5742477558958932, 'auprc': 0.7904413500051798, 'loss_val': 1.0552098943816115, 'psi': 0.6607251935396079}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:58308
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1799 to 1 peers)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1793 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] RECEIVED delta(kind=head bytes=1793) from S2
[S5] cosine check vs S2: cos=0.8840
[S7] RECEIVED delta(kind=head bytes=1799) from S8
[S7] cosine check vs S8: cos=0.9688
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=28 metric=0.8311 head_norm=1.363962
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.165739e-01
[S2] stored merged vector for next round verification (round=28)
[S2] DEBUG after merge:  round=28 metric=0.8299 head_norm=1.226917 delta_norm=0.316574
[S2] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=28 metric=0.5704 head_norm=1.612305
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.120680e-01
[S7] stored merged vector for next round verification (round=28)
[S7] DEBUG after merge:  round=28 metric=0.5651 head_norm=1.645062 delta_norm=0.212068
[S7] aggregate: ROLLBACK (f1_val pre=0.570 post=0.565 tol_abs=0.005 tol_rel=0.0)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11]  timeout peer S4
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S17
[S16]  timeout peer S5
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S10
[S5]  timeout peer S14
[S5]  timeout peer S15
[S14]  timeout peer S7
[S14]  timeout peer S9
[S4]  timeout peer S6
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=28 metric=0.6185 head_norm=1.179060
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.191415e-01
[S5] stored merged vector for next round verification (round=28)
[S5] DEBUG after merge:  round=28 metric=0.6275 head_norm=1.234276 delta_norm=0.319141
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=29 head_norm_before_train=1.226917 cos_to_last_merge=1.0000 (last merge round=28)
[S2] round=29 local utility u=0.048075 metrics={'f1_val': 0.8317799516996357, 'auprc': 0.9162657874094999, 'loss_val': 0.3285699939360956, 'psi': 0.8655742859835813}-{'f1_val': 0.8310684878493383, 'auprc': 0.895170830753407, 'loss_val': 0.35716713340937095, 'psi': 0.8567094250109657}
[S3] START round=29 head_norm_before_train=1.943606 (no previous merge yet)
[S3] round=29 local utility u=0.125336 metrics={'f1_val': 0.997542018298261, 'auprc': 0.9986843261469529, 'loss_val': 0.04407380343482446, 'psi': 0.9979989414377377}-{'f1_val': 0.9612927942165166, 'auprc': 0.9984609531546311, 'loss_val': 0.07658033659545173, 'psi': 0.9761600577917624}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=29 head_norm_before_train=2.118208 cos_to_last_merge=0.9999 (last merge round=27)
[S4] round=29 local utility u=0.085574 metrics={'f1_val': 0.9479859159851994, 'auprc': 0.9713940571784261, 'loss_val': 0.2931554762877945, 'psi': 0.9573491724624901}-{'f1_val': 0.9401282941004727, 'auprc': 0.9341185563443943, 'loss_val': 0.30533187999687644, 'psi': 0.9377243989980414}
[S5] START round=29 head_norm_before_train=1.234276 cos_to_last_merge=1.0000 (last merge round=28)
[S5] round=29 local utility u=0.541371 metrics={'f1_val': 0.7005691551769304, 'auprc': 0.9959302052204189, 'loss_val': 0.3035584475076172, 'psi': 0.8187135751943257}-{'f1_val': 0.6185131419916013, 'auprc': 0.8578291544774139, 'loss_val': 0.4796602406517913, 'psi': 0.7142395469859264}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=29 head_norm_before_train=1.994470 (no previous merge yet)
[S6] round=29 local utility u=0.577807 metrics={'f1_val': 0.7888526231072042, 'auprc': 0.9668108686505221, 'loss_val': 0.5116689225531889, 'psi': 0.8600359213245314}-{'f1_val': 0.6476386242819696, 'auprc': 0.9603810713048594, 'loss_val': 0.8007094464903601, 'psi': 0.7727356030911254}
[S7] START round=29 head_norm_before_train=1.645062 cos_to_last_merge=1.0000 (last merge round=28)
[S7] round=29 local utility u=0.034613 metrics={'f1_val': 0.5780964372490157, 'auprc': 0.7792687369249092, 'loss_val': 0.7424449828387778, 'psi': 0.658565357119373}-{'f1_val': 0.5703555161104749, 'auprc': 0.7770362618505082, 'loss_val': 0.7585277235809247, 'psi': 0.6530278144064883}
[S8] START round=29 head_norm_before_train=1.703783 cos_to_last_merge=0.9995 (last merge round=24)
[S8] round=29 local utility u=0.000109 metrics={'f1_val': 0.9930102130034458, 'auprc': 0.9991863019845133, 'loss_val': 0.03676475305332722, 'psi': 0.9954806485958727}-{'f1_val': 0.9930017911527874, 'auprc': 0.9991870440943375, 'loss_val': 0.03693501465467149, 'psi': 0.9954758923294074}
[S9] START round=29 head_norm_before_train=1.635726 cos_to_last_merge=0.9857 (last merge round=21)
[S9] round=29 local utility u=0.050604 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9977710706780709, 'loss_val': 0.04067142473908489, 'psi': 0.9973701757785141}-{'f1_val': 0.985716065895656, 'auprc': 0.9975371236415382, 'loss_val': 0.07285598979523199, 'psi': 0.9904444889940089}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=29 head_norm_before_train=2.074760 (no previous merge yet)
[S10] round=29 local utility u=0.001717 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9957661924767203, 'loss_val': 0.02654868240667592, 'psi': 0.9956722690997}-{'f1_val': 0.9956096535150197, 'auprc': 0.994804079285837, 'loss_val': 0.027096811110021487, 'psi': 0.9952874238233467}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=29 head_norm_before_train=2.159179 cos_to_last_merge=0.9946 (last merge round=21)
[S11] round=29 local utility u=0.003875 metrics={'f1_val': 0.9974011907167429, 'auprc': 0.9990384401491988, 'loss_val': 0.026351863940602845, 'psi': 0.9980560904897253}-{'f1_val': 0.9967460138064482, 'auprc': 0.9988985014791967, 'loss_val': 0.02975162392817318, 'psi': 0.9976070088755477}
[S13] START round=29 head_norm_before_train=1.846959 (no previous merge yet)
[S13] round=29 local utility u=0.243639 metrics={'f1_val': 0.6280757774349658, 'auprc': 0.7047108196244636, 'loss_val': 0.6004175760889988, 'psi': 0.6587297943107648}-{'f1_val': 0.6019549873825429, 'auprc': 0.6692926135602977, 'loss_val': 0.824716264333211, 'psi': 0.6288900378536448}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S14] START round=29 head_norm_before_train=1.622202 cos_to_last_merge=0.9998 (last merge round=27)
[S14] round=29 local utility u=0.108478 metrics={'f1_val': 0.9936620836628931, 'auprc': 0.9955258191387432, 'loss_val': 0.08713823424172186, 'psi': 0.9944075778532331}-{'f1_val': 0.9626703055912986, 'auprc': 0.9985519322616625, 'loss_val': 0.12722096472915265, 'psi': 0.9770229562594442}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] sending update (kind=head size=1804 to 1 peers)
[S15] START round=29 head_norm_before_train=1.876954 cos_to_last_merge=0.7626 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.763
[S15] round=29 local utility u=0.000000 metrics={'f1_val': 0.7093688584539275, 'auprc': 0.9683781259246974, 'loss_val': 0.4103481722983651, 'psi': 0.8129725654422355}-{'f1_val': 0.992785030910577, 'auprc': 0.9976911638291861, 'loss_val': 0.04034499667983546, 'psi': 0.9947474840780206}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=29 head_norm_before_train=1.395793 cos_to_last_merge=0.9631 (last merge round=20)
[S16] round=29 local utility u=0.037955 metrics={'f1_val': 0.9920014963355335, 'auprc': 0.9982028090147083, 'loss_val': 0.09211918094076044, 'psi': 0.9944820214072033}-{'f1_val': 0.9860999272672292, 'auprc': 0.9981996675051908, 'loss_val': 0.13261071722028692, 'psi': 0.9909398233624138}
[S17] START round=29 head_norm_before_train=1.813928 cos_to_last_merge=0.8150 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.815
[S17] round=29 local utility u=0.722708 metrics={'f1_val': 0.6083454730410573, 'auprc': 0.9988264019472428, 'loss_val': 0.7825609768710073, 'psi': 0.7645378446035316}-{'f1_val': 0.5592457159007117, 'auprc': 0.7266763674378627, 'loss_val': 1.1169274628926642, 'psi': 0.6262179765155721}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S17] sending update (kind=head size=1807 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:58308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:58310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:58307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:58312
[S16] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1793 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:58314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:58316
[S5] RECEIVED delta(kind=head bytes=1793) from S2
[S5] cosine check vs S2: cos=0.9957
[S11] RECEIVED delta(kind=head bytes=1799) from S4
[S11] cosine check vs S4: cos=0.9990
[S9] RECEIVED delta(kind=head bytes=1800) from S11
[S9] cosine check vs S11: cos=-0.1433
[S9] DROPPED delta from S11 (cos=-0.1433 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1801) from S8
[S7] cosine check vs S8: cos=0.9916
[S6] RECEIVED delta(kind=head bytes=1799) from S16
[S6] cosine check vs S16: cos=-0.0632
[S6] DROPPED delta from S16 (cos=-0.0632 < 0.0)
[S7] sending update (kind=head size=1799 to 1 peers)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=29 metric=0.9974 head_norm=2.177257
[S11] _apply_head_vector_avg (torch): Δ‖w‖=5.403990e-02
[S11] stored merged vector for next round verification (round=29)
[S11] DEBUG after merge:  round=29 metric=0.9974 head_norm=2.153174 delta_norm=0.054040
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S6] sending update (kind=head size=1798 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1798) from S6
[S16] cosine check vs S6: cos=-0.0632
[S16] DROPPED delta from S6 (cos=-0.0632 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1799) from S7
[S14] cosine check vs S7: cos=0.9888
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=29 metric=0.5781 head_norm=1.654977
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.153277e-01
[S7] stored merged vector for next round verification (round=29)
[S7] DEBUG after merge:  round=29 metric=0.5732 head_norm=1.688238 delta_norm=0.115328
[S7] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=30 head_norm_before_train=1.312999 cos_to_last_merge=0.9969 (last merge round=28)
[S2] round=30 local utility u=0.000000 metrics={'f1_val': 0.7358540856652569, 'auprc': 0.7845280159980585, 'loss_val': 0.5542498673610585, 'psi': 0.7553236577983775}-{'f1_val': 0.8317799516996357, 'auprc': 0.9162657874094999, 'loss_val': 0.3285699939360956, 'psi': 0.8655742859835813}
[S3] START round=30 head_norm_before_train=1.960048 (no previous merge yet)
[S3] round=30 local utility u=0.000000 metrics={'f1_val': 0.9607209831147359, 'auprc': 0.998700676796046, 'loss_val': 0.0909803075979547, 'psi': 0.9759128605872599}-{'f1_val': 0.997542018298261, 'auprc': 0.9986843261469529, 'loss_val': 0.04407380343482446, 'psi': 0.9979989414377377}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=30 head_norm_before_train=2.130190 cos_to_last_merge=0.9998 (last merge round=27)
[S4] round=30 local utility u=0.000000 metrics={'f1_val': 0.9385759439576176, 'auprc': 0.927208561900019, 'loss_val': 0.3256528034659284, 'psi': 0.934028991134578}-{'f1_val': 0.9479859159851994, 'auprc': 0.9713940571784261, 'loss_val': 0.2931554762877945, 'psi': 0.9573491724624901}
[S5] START round=30 head_norm_before_train=1.248052 cos_to_last_merge=0.9998 (last merge round=28)
[S5] round=30 local utility u=0.000000 metrics={'f1_val': 0.6544373891720137, 'auprc': 0.8255462468847392, 'loss_val': 0.4661804940360488, 'psi': 0.7228809322571039}-{'f1_val': 0.7005691551769304, 'auprc': 0.9959302052204189, 'loss_val': 0.3035584475076172, 'psi': 0.8187135751943257}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=30 metric=0.6544 head_norm=1.262525
[S5] _apply_head_vector_avg (torch): Δ‖w‖=7.267839e-02
[S5] stored merged vector for next round verification (round=30)
[S5] DEBUG after merge:  round=30 metric=0.6606 head_norm=1.285957 delta_norm=0.072678
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S6] START round=30 head_norm_before_train=2.003943 (no previous merge yet)
[S6] round=30 local utility u=0.000000 metrics={'f1_val': 0.728994873325302, 'auprc': 0.9432399619270069, 'loss_val': 0.7143456569935462, 'psi': 0.814692908765984}-{'f1_val': 0.7888526231072042, 'auprc': 0.9668108686505221, 'loss_val': 0.5116689225531889, 'psi': 0.8600359213245314}
[S7] START round=30 head_norm_before_train=1.688238 cos_to_last_merge=1.0000 (last merge round=29)
[S7] round=30 local utility u=0.658870 metrics={'f1_val': 0.6981001398246223, 'auprc': 0.859261375719729, 'loss_val': 0.3847057691039423, 'psi': 0.7625646341826651}-{'f1_val': 0.5780964372490157, 'auprc': 0.7792687369249092, 'loss_val': 0.7424449828387778, 'psi': 0.658565357119373}
[S8] START round=30 head_norm_before_train=1.728567 cos_to_last_merge=0.9990 (last merge round=24)
[S8] round=30 local utility u=0.000000 metrics={'f1_val': 0.949324175814787, 'auprc': 0.9988874884702544, 'loss_val': 0.1459590373258432, 'psi': 0.9691495008769739}-{'f1_val': 0.9930102130034458, 'auprc': 0.9991863019845133, 'loss_val': 0.03676475305332722, 'psi': 0.9954806485958727}
[S9] START round=30 head_norm_before_train=1.652986 cos_to_last_merge=0.9842 (last merge round=21)
[S9] round=30 local utility u=0.000000 metrics={'f1_val': 0.9954448862872828, 'auprc': 0.9976919656356742, 'loss_val': 0.04034896780426301, 'psi': 0.9963437180266393}-{'f1_val': 0.9971029125121428, 'auprc': 0.9977710706780709, 'loss_val': 0.04067142473908489, 'psi': 0.9973701757785141}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=30 head_norm_before_train=2.086409 (no previous merge yet)
[S10] round=30 local utility u=0.000000 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9946807737644796, 'loss_val': 0.026419482755849773, 'psi': 0.9952381016148037}-{'f1_val': 0.9956096535150197, 'auprc': 0.9957661924767203, 'loss_val': 0.02654868240667592, 'psi': 0.9956722690997}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=30 head_norm_before_train=2.153174 cos_to_last_merge=1.0000 (last merge round=29)
[S11] round=30 local utility u=0.000000 metrics={'f1_val': 0.9957161515329224, 'auprc': 0.9990137282226731, 'loss_val': 0.03308784394728321, 'psi': 0.9970351822088226}-{'f1_val': 0.9974011907167429, 'auprc': 0.9990384401491988, 'loss_val': 0.026351863940602845, 'psi': 0.9980560904897253}
[S13] START round=30 head_norm_before_train=1.854965 (no previous merge yet)
[S13] round=30 local utility u=0.000000 metrics={'f1_val': 0.5989039427605894, 'auprc': 0.6392115346472702, 'loss_val': 1.0077658030134475, 'psi': 0.6150269795152618}-{'f1_val': 0.6280757774349658, 'auprc': 0.7047108196244636, 'loss_val': 0.6004175760889988, 'psi': 0.6587297943107648}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=30 head_norm_before_train=1.641300 cos_to_last_merge=0.9995 (last merge round=27)
[S14] round=30 local utility u=0.000000 metrics={'f1_val': 0.9592308060357477, 'auprc': 0.9983681722016509, 'loss_val': 0.09896011022157772, 'psi': 0.9748857525021091}-{'f1_val': 0.9936620836628931, 'auprc': 0.9955258191387432, 'loss_val': 0.08713823424172186, 'psi': 0.9944075778532331}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=30 metric=0.9592 head_norm=1.655979
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.293295e-01
[S14] stored merged vector for next round verification (round=30)
[S14] DEBUG after merge:  round=30 metric=0.9597 head_norm=1.650419 delta_norm=0.129330
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S15] START round=30 head_norm_before_train=1.891858 cos_to_last_merge=0.7617 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.762
[S15] round=30 local utility u=0.815184 metrics={'f1_val': 0.9186107355250362, 'auprc': 0.995370687062735, 'loss_val': 0.11640942851998845, 'psi': 0.9493147161401156}-{'f1_val': 0.7093688584539275, 'auprc': 0.9683781259246974, 'loss_val': 0.4103481722983651, 'psi': 0.8129725654422355}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S15] sending update (kind=head size=1807 to 1 peers)
[S16] START round=30 head_norm_before_train=1.427637 cos_to_last_merge=0.9594 (last merge round=20)
[S16] round=30 local utility u=0.000000 metrics={'f1_val': 0.9911498303647908, 'auprc': 0.9962283060676382, 'loss_val': 0.08205397006265558, 'psi': 0.9931812206459297}-{'f1_val': 0.9920014963355335, 'auprc': 0.9982028090147083, 'loss_val': 0.09211918094076044, 'psi': 0.9944820214072033}
[S17] START round=30 head_norm_before_train=1.829819 cos_to_last_merge=0.8146 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.815
[S17] round=30 local utility u=0.000000 metrics={'f1_val': 0.5983998662942114, 'auprc': 0.830778363255879, 'loss_val': 1.035028395265169, 'psi': 0.6913512650788785}-{'f1_val': 0.6083454730410573, 'auprc': 0.9988264019472428, 'loss_val': 0.7825609768710073, 'psi': 0.7645378446035316}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] ⇄ pheromone p=0.056 → S6@127.0.0.1:58307
[S2] ⇄ pheromone p=0.074 → S5@127.0.0.1:58305
[S4] ⇄ pheromone p=0.040 → S11@127.0.0.1:58312
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.763)
[S8] ⇄ pheromone p=0.009 → S7@127.0.0.1:58308
[S11] ⇄ pheromone p=0.031 → S9@127.0.0.1:58310
[S6] ⇄ pheromone p=0.187 → S16@127.0.0.1:58316
[S7] ⇄ pheromone p=0.299 → S14@127.0.0.1:58314
[S2] START round=31 head_norm_before_train=1.399523 cos_to_last_merge=0.9900 (last merge round=28)
[S2] round=31 local utility u=0.534596 metrics={'f1_val': 0.8356151906924019, 'auprc': 0.8566280240302446, 'loss_val': 0.2999246117477346, 'psi': 0.844020324027539}-{'f1_val': 0.7358540856652569, 'auprc': 0.7845280159980585, 'loss_val': 0.5542498673610585, 'psi': 0.7553236577983775}
[S3] START round=31 head_norm_before_train=1.972806 (no previous merge yet)
[S3] round=31 local utility u=0.100360 metrics={'f1_val': 0.9870397880431735, 'auprc': 0.9986830638039387, 'loss_val': 0.04812007041069036, 'psi': 0.9916970983474795}-{'f1_val': 0.9607209831147359, 'auprc': 0.998700676796046, 'loss_val': 0.0909803075979547, 'psi': 0.9759128605872599}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=31 head_norm_before_train=2.140299 cos_to_last_merge=0.9996 (last merge round=27)
[S4] round=31 local utility u=0.045926 metrics={'f1_val': 0.9410037544258081, 'auprc': 0.9530974137324387, 'loss_val': 0.3260348033348084, 'psi': 0.9458412181484603}-{'f1_val': 0.9385759439576176, 'auprc': 0.927208561900019, 'loss_val': 0.3256528034659284, 'psi': 0.934028991134578}
[S5] START round=31 head_norm_before_train=1.285957 cos_to_last_merge=1.0000 (last merge round=30)
[S5] round=31 local utility u=0.466386 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9898871424321442, 'loss_val': 0.3017310747615058, 'psi': 0.816147216067673}-{'f1_val': 0.6544373891720137, 'auprc': 0.8255462468847392, 'loss_val': 0.4661804940360488, 'psi': 0.7228809322571039}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=31 head_norm_before_train=2.012311 (no previous merge yet)
[S6] round=31 local utility u=0.000000 metrics={'f1_val': 0.6223159658230771, 'auprc': 0.9560252703982466, 'loss_val': 0.8295368914026503, 'psi': 0.755799687653145}-{'f1_val': 0.728994873325302, 'auprc': 0.9432399619270069, 'loss_val': 0.7143456569935462, 'psi': 0.814692908765984}
[S7] START round=31 head_norm_before_train=1.696851 cos_to_last_merge=1.0000 (last merge round=29)
[S7] round=31 local utility u=0.000000 metrics={'f1_val': 0.5287311044084617, 'auprc': 0.7750820393775264, 'loss_val': 0.8981348074149593, 'psi': 0.6272714783960875}-{'f1_val': 0.6981001398246223, 'auprc': 0.859261375719729, 'loss_val': 0.3847057691039423, 'psi': 0.7625646341826651}
[S8] START round=31 head_norm_before_train=1.747837 cos_to_last_merge=0.9986 (last merge round=24)
[S8] round=31 local utility u=0.153190 metrics={'f1_val': 0.9910256372156664, 'auprc': 0.9865993582220305, 'loss_val': 0.052923440304330376, 'psi': 0.989255125618212}-{'f1_val': 0.949324175814787, 'auprc': 0.9988874884702544, 'loss_val': 0.1459590373258432, 'psi': 0.9691495008769739}
[S9] START round=31 head_norm_before_train=1.667035 cos_to_last_merge=0.9829 (last merge round=21)
[S9] round=31 local utility u=0.000000 metrics={'f1_val': 0.9377619761977686, 'auprc': 0.997797218230692, 'loss_val': 0.11499104104612311, 'psi': 0.9617760730109379}-{'f1_val': 0.9954448862872828, 'auprc': 0.9976919656356742, 'loss_val': 0.04034896780426301, 'psi': 0.9963437180266393}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=31 head_norm_before_train=2.099886 (no previous merge yet)
[S10] round=31 local utility u=0.002601 metrics={'f1_val': 0.9953900010273877, 'auprc': 0.9965823718040537, 'loss_val': 0.02560526078141745, 'psi': 0.9958669493380541}-{'f1_val': 0.9956096535150197, 'auprc': 0.9946807737644796, 'loss_val': 0.026419482755849773, 'psi': 0.9952381016148037}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] START round=31 head_norm_before_train=2.166436 cos_to_last_merge=1.0000 (last merge round=29)
[S11] round=31 local utility u=0.004020 metrics={'f1_val': 0.9967460138064482, 'auprc': 0.9979303505941285, 'loss_val': 0.027975947479940956, 'psi': 0.9972197485215204}-{'f1_val': 0.9957161515329224, 'auprc': 0.9990137282226731, 'loss_val': 0.03308784394728321, 'psi': 0.9970351822088226}
[S13] START round=31 head_norm_before_train=1.860985 (no previous merge yet)
[S13] round=31 local utility u=0.639303 metrics={'f1_val': 0.7186246279267122, 'auprc': 0.7094518530205608, 'loss_val': 0.6582049524209723, 'psi': 0.7149555179642517}-{'f1_val': 0.5989039427605894, 'auprc': 0.6392115346472702, 'loss_val': 1.0077658030134475, 'psi': 0.6150269795152618}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=31 head_norm_before_train=1.650419 cos_to_last_merge=1.0000 (last merge round=30)
[S14] round=31 local utility u=0.119982 metrics={'f1_val': 0.9963144732565343, 'auprc': 0.9985710782880377, 'loss_val': 0.08210694764208916, 'psi': 0.9972171152691357}-{'f1_val': 0.9592308060357477, 'auprc': 0.9983681722016509, 'loss_val': 0.09896011022157772, 'psi': 0.9748857525021091}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=31 head_norm_before_train=1.899527 cos_to_last_merge=0.7613 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.761
[S15] round=31 local utility u=0.248806 metrics={'f1_val': 0.9901019016459601, 'auprc': 0.9970940488396464, 'loss_val': 0.0529150121236385, 'psi': 0.9928987605234345}-{'f1_val': 0.9186107355250362, 'auprc': 0.995370687062735, 'loss_val': 0.11640942851998845, 'psi': 0.9493147161401156}
[S15] not sending this round → trigger blocked (psi=0.993)
[S16] START round=31 head_norm_before_train=1.454663 cos_to_last_merge=0.9561 (last merge round=20)
[S16] round=31 local utility u=0.009520 metrics={'f1_val': 0.9915364364988188, 'auprc': 0.997602559692031, 'loss_val': 0.06945680433902253, 'psi': 0.9939628857761038}-{'f1_val': 0.9911498303647908, 'auprc': 0.9962283060676382, 'loss_val': 0.08205397006265558, 'psi': 0.9931812206459297}
[S17] START round=31 head_norm_before_train=1.846183 cos_to_last_merge=0.8140 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.814
[S17] round=31 local utility u=0.322627 metrics={'f1_val': 0.6333637470003319, 'auprc': 0.9077012641002952, 'loss_val': 0.8303273526944885, 'psi': 0.7430987538403172}-{'f1_val': 0.5983998662942114, 'auprc': 0.830778363255879, 'loss_val': 1.035028395265169, 'psi': 0.6913512650788785}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:58307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] RECEIVED delta(kind=head bytes=1800) from S16
[S6] cosine check vs S16: cos=-0.0674
[S6] DROPPED delta from S16 (cos=-0.0674 < 0.0)
[S2] START round=32 head_norm_before_train=1.471636 cos_to_last_merge=0.9831 (last merge round=28)
[S2] round=32 local utility u=0.000000 metrics={'f1_val': 0.7404846445009365, 'auprc': 0.8482187331973802, 'loss_val': 0.6330005005803707, 'psi': 0.783578279979514}-{'f1_val': 0.8356151906924019, 'auprc': 0.8566280240302446, 'loss_val': 0.2999246117477346, 'psi': 0.844020324027539}
[S3] START round=32 head_norm_before_train=1.987632 (no previous merge yet)
[S3] round=32 local utility u=0.000000 metrics={'f1_val': 0.933852467323455, 'auprc': 0.9978923785508229, 'loss_val': 0.16094455196310212, 'psi': 0.9594684318144022}-{'f1_val': 0.9870397880431735, 'auprc': 0.9986830638039387, 'loss_val': 0.04812007041069036, 'psi': 0.9916970983474795}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=32 head_norm_before_train=2.142235 cos_to_last_merge=0.9994 (last merge round=27)
[S4] round=32 local utility u=0.017548 metrics={'f1_val': 0.9428950744119322, 'auprc': 0.9535551796708405, 'loss_val': 0.30365967392016524, 'psi': 0.9471591165154956}-{'f1_val': 0.9410037544258081, 'auprc': 0.9530974137324387, 'loss_val': 0.3260348033348084, 'psi': 0.9458412181484603}
[S5] START round=32 head_norm_before_train=1.301752 cos_to_last_merge=0.9998 (last merge round=30)
[S5] round=32 local utility u=0.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9613953911093961, 'loss_val': 0.33071093690589737, 'psi': 0.8047505155385739}-{'f1_val': 0.700320598491359, 'auprc': 0.9898871424321442, 'loss_val': 0.3017310747615058, 'psi': 0.816147216067673}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=32 head_norm_before_train=2.017183 (no previous merge yet)
[S6] round=32 local utility u=0.577464 metrics={'f1_val': 0.7882513814175578, 'auprc': 0.9541909106998642, 'loss_val': 0.6647186184589727, 'psi': 0.8546271931304803}-{'f1_val': 0.6223159658230771, 'auprc': 0.9560252703982466, 'loss_val': 0.8295368914026503, 'psi': 0.755799687653145}
[S7] START round=32 head_norm_before_train=1.703774 cos_to_last_merge=0.9999 (last merge round=29)
[S7] round=32 local utility u=0.796546 metrics={'f1_val': 0.6873538795247505, 'auprc': 0.8312391867790891, 'loss_val': 0.42525155508898405, 'psi': 0.7449080024264859}-{'f1_val': 0.5287311044084617, 'auprc': 0.7750820393775264, 'loss_val': 0.8981348074149593, 'psi': 0.6272714783960875}
[S8] START round=32 head_norm_before_train=1.765243 cos_to_last_merge=0.9983 (last merge round=24)
[S8] round=32 local utility u=0.000000 metrics={'f1_val': 0.97811786159145, 'auprc': 0.9991229519444386, 'loss_val': 0.05822020473010514, 'psi': 0.9865198977326454}-{'f1_val': 0.9910256372156664, 'auprc': 0.9865993582220305, 'loss_val': 0.052923440304330376, 'psi': 0.989255125618212}
[S9] START round=32 head_norm_before_train=1.678850 cos_to_last_merge=0.9818 (last merge round=21)
[S9] round=32 local utility u=0.202786 metrics={'f1_val': 0.9933536184876286, 'auprc': 0.9975606282786977, 'loss_val': 0.042259027176580505, 'psi': 0.9950364224040562}-{'f1_val': 0.9377619761977686, 'auprc': 0.997797218230692, 'loss_val': 0.11499104104612311, 'psi': 0.9617760730109379}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S9] sending update (kind=head size=1806 to 1 peers)
[S10] START round=32 head_norm_before_train=2.107670 (no previous merge yet)
[S10] round=32 local utility u=0.000000 metrics={'f1_val': 0.9953900010273877, 'auprc': 0.9963602908903607, 'loss_val': 0.025600436774468344, 'psi': 0.9957781169725769}-{'f1_val': 0.9953900010273877, 'auprc': 0.9965823718040537, 'loss_val': 0.02560526078141745, 'psi': 0.9958669493380541}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=32 head_norm_before_train=2.177858 cos_to_last_merge=0.9999 (last merge round=29)
[S11] round=32 local utility u=0.000000 metrics={'f1_val': 0.992796395146777, 'auprc': 0.9993290310809145, 'loss_val': 0.03847106604117939, 'psi': 0.995409449520432}-{'f1_val': 0.9967460138064482, 'auprc': 0.9979303505941285, 'loss_val': 0.027975947479940956, 'psi': 0.9972197485215204}
[S13] START round=32 head_norm_before_train=1.867903 (no previous merge yet)
[S13] round=32 local utility u=0.000000 metrics={'f1_val': 0.6480446145210242, 'auprc': 0.6857888641165609, 'loss_val': 0.8815956805343276, 'psi': 0.6631423143592389}-{'f1_val': 0.7186246279267122, 'auprc': 0.7094518530205608, 'loss_val': 0.6582049524209723, 'psi': 0.7149555179642517}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=32 head_norm_before_train=1.666065 cos_to_last_merge=0.9999 (last merge round=30)
[S14] round=32 local utility u=0.005869 metrics={'f1_val': 0.9968432356318464, 'auprc': 0.9976586318142537, 'loss_val': 0.07080417697281846, 'psi': 0.9971693941048093}-{'f1_val': 0.9963144732565343, 'auprc': 0.9985710782880377, 'loss_val': 0.08210694764208916, 'psi': 0.9972171152691357}
[S14] not sending this round → trigger blocked (psi=0.997)
[S15] START round=32 head_norm_before_train=1.910424 cos_to_last_merge=0.7604 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.760
[S15] round=32 local utility u=0.011130 metrics={'f1_val': 0.996248502210966, 'auprc': 0.9911693130112296, 'loss_val': 0.04975958240350717, 'psi': 0.9942168265310714}-{'f1_val': 0.9901019016459601, 'auprc': 0.9970940488396464, 'loss_val': 0.0529150121236385, 'psi': 0.9928987605234345}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=32 head_norm_before_train=1.480718 cos_to_last_merge=0.9530 (last merge round=20)
[S16] round=32 local utility u=0.001469 metrics={'f1_val': 0.9915364364988188, 'auprc': 0.9973464395759861, 'loss_val': 0.06575009967930236, 'psi': 0.9938604377296858}-{'f1_val': 0.9915364364988188, 'auprc': 0.997602559692031, 'loss_val': 0.06945680433902253, 'psi': 0.9939628857761038}
[S17] START round=32 head_norm_before_train=1.860524 cos_to_last_merge=0.8134 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.813
[S17] round=32 local utility u=0.317468 metrics={'f1_val': 0.6822879265608136, 'auprc': 0.9993307900811175, 'loss_val': 0.7638250637364475, 'psi': 0.8091050719689352}-{'f1_val': 0.6333637470003319, 'auprc': 0.9077012641002952, 'loss_val': 0.8303273526944885, 'psi': 0.7430987538403172}
[S17] not sending this round → trigger blocked (psi=0.809)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.947)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.994)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:58316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:58309
[S7] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1799) from S6
[S16] cosine check vs S6: cos=-0.0704
[S16] DROPPED delta from S6 (cos=-0.0704 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1801) from S7
[S8] cosine check vs S7: cos=0.9966
[S2] START round=33 head_norm_before_train=1.522541 cos_to_last_merge=0.9781 (last merge round=28)
[S2] round=33 local utility u=0.617262 metrics={'f1_val': 0.829336314262942, 'auprc': 0.9930344627446765, 'loss_val': 0.36603277105848187, 'psi': 0.8948155736556358}-{'f1_val': 0.7404846445009365, 'auprc': 0.8482187331973802, 'loss_val': 0.6330005005803707, 'psi': 0.783578279979514}
[S3] START round=33 head_norm_before_train=2.001955 (no previous merge yet)
[S3] round=33 local utility u=0.256446 metrics={'f1_val': 0.9971302205031132, 'auprc': 0.9984884337974425, 'loss_val': 0.02950716931332994, 'psi': 0.9976735058208449}-{'f1_val': 0.933852467323455, 'auprc': 0.9978923785508229, 'loss_val': 0.16094455196310212, 'psi': 0.9594684318144022}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] sending update (kind=head size=1803 to 1 peers)
[S4] START round=33 head_norm_before_train=2.152218 cos_to_last_merge=0.9989 (last merge round=27)
[S4] round=33 local utility u=0.004721 metrics={'f1_val': 0.9457076274770487, 'auprc': 0.9435100503439235, 'loss_val': 0.2809584968134169, 'psi': 0.9448285966237987}-{'f1_val': 0.9428950744119322, 'auprc': 0.9535551796708405, 'loss_val': 0.30365967392016524, 'psi': 0.9471591165154956}
[S5] START round=33 head_norm_before_train=1.319532 cos_to_last_merge=0.9992 (last merge round=30)
[S5] round=33 local utility u=0.078867 metrics={'f1_val': 0.7005691551769304, 'auprc': 0.9916559716590901, 'loss_val': 0.2652490283989903, 'psi': 0.8170038817697943}-{'f1_val': 0.700320598491359, 'auprc': 0.9613953911093961, 'loss_val': 0.33071093690589737, 'psi': 0.8047505155385739}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=33 head_norm_before_train=2.027211 (no previous merge yet)
[S6] round=33 local utility u=0.000000 metrics={'f1_val': 0.6823135961623548, 'auprc': 0.9561792109435424, 'loss_val': 0.8591905778597535, 'psi': 0.7918598420748297}-{'f1_val': 0.7882513814175578, 'auprc': 0.9541909106998642, 'loss_val': 0.6647186184589727, 'psi': 0.8546271931304803}
[S7] START round=33 head_norm_before_train=1.710723 cos_to_last_merge=0.9997 (last merge round=29)
[S7] round=33 local utility u=0.000000 metrics={'f1_val': 0.514946192924925, 'auprc': 0.7788986872000963, 'loss_val': 0.8275953482829864, 'psi': 0.6205271906349936}-{'f1_val': 0.6873538795247505, 'auprc': 0.8312391867790891, 'loss_val': 0.42525155508898405, 'psi': 0.7449080024264859}
[S8] START round=33 head_norm_before_train=1.781049 cos_to_last_merge=0.9981 (last merge round=24)
[S8] round=33 local utility u=0.039653 metrics={'f1_val': 0.9884280922259011, 'auprc': 0.9991365350054073, 'loss_val': 0.04081572939737246, 'psi': 0.9927114693377036}-{'f1_val': 0.97811786159145, 'auprc': 0.9991229519444386, 'loss_val': 0.05822020473010514, 'psi': 0.9865198977326454}
[S9] START round=33 head_norm_before_train=1.687985 cos_to_last_merge=0.9810 (last merge round=21)
[S9] round=33 local utility u=0.014300 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9978385166851222, 'loss_val': 0.03452594328836807, 'psi': 0.9971509014329062}-{'f1_val': 0.9933536184876286, 'auprc': 0.9975606282786977, 'loss_val': 0.042259027176580505, 'psi': 0.9950364224040562}
[S9] not sending this round → trigger blocked (psi=0.997)
[S10] START round=33 head_norm_before_train=2.119061 (no previous merge yet)
[S10] round=33 local utility u=0.000309 metrics={'f1_val': 0.9953900010273877, 'auprc': 0.9964830747754634, 'loss_val': 0.02535009420663277, 'psi': 0.995827230526618}-{'f1_val': 0.9953900010273877, 'auprc': 0.9963602908903607, 'loss_val': 0.025600436774468344, 'psi': 0.9957781169725769}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=33 head_norm_before_train=2.189366 cos_to_last_merge=0.9998 (last merge round=29)
[S11] round=33 local utility u=0.020972 metrics={'f1_val': 0.9974011907167429, 'auprc': 0.9989253267381717, 'loss_val': 0.022944856689821436, 'psi': 0.9980108451253145}-{'f1_val': 0.992796395146777, 'auprc': 0.9993290310809145, 'loss_val': 0.03847106604117939, 'psi': 0.995409449520432}
[S13] START round=33 head_norm_before_train=1.877461 (no previous merge yet)
[S13] round=33 local utility u=0.278148 metrics={'f1_val': 0.7025252315910727, 'auprc': 0.7184688187900242, 'loss_val': 0.7502233360257673, 'psi': 0.7089026664706533}-{'f1_val': 0.6480446145210242, 'auprc': 0.6857888641165609, 'loss_val': 0.8815956805343276, 'psi': 0.6631423143592389}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=33 head_norm_before_train=1.685902 cos_to_last_merge=0.9997 (last merge round=30)
[S14] round=33 local utility u=0.004899 metrics={'f1_val': 0.9968435534169914, 'auprc': 0.9986411839571188, 'loss_val': 0.06395493292786356, 'psi': 0.9975626056330423}-{'f1_val': 0.9968432356318464, 'auprc': 0.9976586318142537, 'loss_val': 0.07080417697281846, 'psi': 0.9971693941048093}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=33 head_norm_before_train=1.919598 cos_to_last_merge=0.7597 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.760
[S15] round=33 local utility u=0.000000 metrics={'f1_val': 0.8816273444089862, 'auprc': 0.9933578545904701, 'loss_val': 0.29591602896759706, 'psi': 0.9263195484815798}-{'f1_val': 0.996248502210966, 'auprc': 0.9911693130112296, 'loss_val': 0.04975958240350717, 'psi': 0.9942168265310714}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=33 head_norm_before_train=1.503570 cos_to_last_merge=0.9501 (last merge round=20)
[S16] round=33 local utility u=0.000000 metrics={'f1_val': 0.9682590804753836, 'auprc': 0.9976324500733467, 'loss_val': 0.12131807173982996, 'psi': 0.9800084283145689}-{'f1_val': 0.9915364364988188, 'auprc': 0.9973464395759861, 'loss_val': 0.06575009967930236, 'psi': 0.9938604377296858}
[S17] START round=33 head_norm_before_train=1.876609 cos_to_last_merge=0.8127 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.813
[S17] round=33 local utility u=0.000000 metrics={'f1_val': 0.56697287216833, 'auprc': 0.7546426505814188, 'loss_val': 1.2275286085322221, 'psi': 0.6420407835335655}-{'f1_val': 0.6822879265608136, 'auprc': 0.9993307900811175, 'loss_val': 0.7638250637364475, 'psi': 0.8091050719689352}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] sending update (kind=head size=1794 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=33 metric=0.9884 head_norm=1.791643
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.487725e-02
[S8] stored merged vector for next round verification (round=33)
[S8] DEBUG after merge:  round=33 metric=0.9884 head_norm=1.749592 delta_norm=0.084877
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=34 head_norm_before_train=1.559708 cos_to_last_merge=0.9745 (last merge round=28)
[S2] round=34 local utility u=0.000000 metrics={'f1_val': 0.8317799516996357, 'auprc': 0.9543604939528771, 'loss_val': 0.3748988563481998, 'psi': 0.8808121686009323}-{'f1_val': 0.829336314262942, 'auprc': 0.9930344627446765, 'loss_val': 0.36603277105848187, 'psi': 0.8948155736556358}
[S3] START round=34 head_norm_before_train=2.015307 (no previous merge yet)
[S3] round=34 local utility u=0.000000 metrics={'f1_val': 0.960651231474942, 'auprc': 0.9981264265977958, 'loss_val': 0.12939343808287368, 'psi': 0.9756413095240835}-{'f1_val': 0.9971302205031132, 'auprc': 0.9984884337974425, 'loss_val': 0.02950716931332994, 'psi': 0.9976735058208449}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=34 head_norm_before_train=2.155719 cos_to_last_merge=0.9986 (last merge round=27)
[S4] round=34 local utility u=0.000000 metrics={'f1_val': 0.9405453586927536, 'auprc': 0.926123360398662, 'loss_val': 0.29872528930658265, 'psi': 0.9347765593751169}-{'f1_val': 0.9457076274770487, 'auprc': 0.9435100503439235, 'loss_val': 0.2809584968134169, 'psi': 0.9448285966237987}
[S5] START round=34 head_norm_before_train=1.340234 cos_to_last_merge=0.9986 (last merge round=30)
[S5] round=34 local utility u=0.000000 metrics={'f1_val': 0.6328403317221787, 'auprc': 0.8565311227500383, 'loss_val': 0.4579167569702733, 'psi': 0.7223166481333225}-{'f1_val': 0.7005691551769304, 'auprc': 0.9916559716590901, 'loss_val': 0.2652490283989903, 'psi': 0.8170038817697943}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=34 head_norm_before_train=2.037553 (no previous merge yet)
[S6] round=34 local utility u=1.000000 metrics={'f1_val': 0.907238417594954, 'auprc': 0.9720140123901001, 'loss_val': 0.25582669861288954, 'psi': 0.9331486555130124}-{'f1_val': 0.6823135961623548, 'auprc': 0.9561792109435424, 'loss_val': 0.8591905778597535, 'psi': 0.7918598420748297}
[S7] START round=34 head_norm_before_train=1.718295 cos_to_last_merge=0.9995 (last merge round=29)
[S7] round=34 local utility u=0.512047 metrics={'f1_val': 0.6410807747400977, 'auprc': 0.7868596452332679, 'loss_val': 0.5841922796849165, 'psi': 0.6993923229373658}-{'f1_val': 0.514946192924925, 'auprc': 0.7788986872000963, 'loss_val': 0.8275953482829864, 'psi': 0.6205271906349936}
[S8] START round=34 head_norm_before_train=1.749592 cos_to_last_merge=1.0000 (last merge round=33)
[S8] round=34 local utility u=0.000000 metrics={'f1_val': 0.985115964419647, 'auprc': 0.9991527985660633, 'loss_val': 0.0489453037863123, 'psi': 0.9907306980782136}-{'f1_val': 0.9884280922259011, 'auprc': 0.9991365350054073, 'loss_val': 0.04081572939737246, 'psi': 0.9927114693377036}
[S9] START round=34 head_norm_before_train=1.697990 cos_to_last_merge=0.9801 (last merge round=21)
[S9] round=34 local utility u=0.000000 metrics={'f1_val': 0.9899884433541285, 'auprc': 0.997491106242768, 'loss_val': 0.047879471390803056, 'psi': 0.9929895085095843}-{'f1_val': 0.9966924912647621, 'auprc': 0.9978385166851222, 'loss_val': 0.03452594328836807, 'psi': 0.9971509014329062}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=34 head_norm_before_train=2.131213 (no previous merge yet)
[S10] round=34 local utility u=0.000000 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9952883140496116, 'loss_val': 0.025539259481958645, 'psi': 0.9954811177288565}-{'f1_val': 0.9953900010273877, 'auprc': 0.9964830747754634, 'loss_val': 0.02535009420663277, 'psi': 0.995827230526618}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=34 head_norm_before_train=2.201849 cos_to_last_merge=0.9997 (last merge round=29)
[S11] round=34 local utility u=0.000000 metrics={'f1_val': 0.9967460138064482, 'auprc': 0.9988601888148805, 'loss_val': 0.02356088866375653, 'psi': 0.9975916838098211}-{'f1_val': 0.9974011907167429, 'auprc': 0.9989253267381717, 'loss_val': 0.022944856689821436, 'psi': 0.9980108451253145}
[S13] START round=34 head_norm_before_train=1.885894 (no previous merge yet)
[S13] round=34 local utility u=0.000000 metrics={'f1_val': 0.6495824593102837, 'auprc': 0.6682324596970984, 'loss_val': 1.1631966274031886, 'psi': 0.6570424594650095}-{'f1_val': 0.7025252315910727, 'auprc': 0.7184688187900242, 'loss_val': 0.7502233360257673, 'psi': 0.7089026664706533}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=34 head_norm_before_train=1.705614 cos_to_last_merge=0.9993 (last merge round=30)
[S14] round=34 local utility u=0.004231 metrics={'f1_val': 0.9970858939020174, 'auprc': 0.9990056453370191, 'loss_val': 0.05804081176330727, 'psi': 0.9978537944760181}-{'f1_val': 0.9968435534169914, 'auprc': 0.9986411839571188, 'loss_val': 0.06395493292786356, 'psi': 0.9975626056330423}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=34 head_norm_before_train=1.929298 cos_to_last_merge=0.7590 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.759
[S15] round=34 local utility u=0.452600 metrics={'f1_val': 0.9884050979765215, 'auprc': 0.9963348439061256, 'loss_val': 0.040314132872643904, 'psi': 0.9915769963483632}-{'f1_val': 0.8816273444089862, 'auprc': 0.9933578545904701, 'loss_val': 0.29591602896759706, 'psi': 0.9263195484815798}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=34 head_norm_before_train=1.525123 cos_to_last_merge=0.9475 (last merge round=20)
[S16] ⚠️ Model drifted since last merge! cos=0.947
[S16] round=34 local utility u=0.000000 metrics={'f1_val': 0.9199386045496492, 'auprc': 0.9915378140279996, 'loss_val': 0.33835374566967297, 'psi': 0.9485782883409893}-{'f1_val': 0.9682590804753836, 'auprc': 0.9976324500733467, 'loss_val': 0.12131807173982996, 'psi': 0.9800084283145689}
[S17] START round=34 head_norm_before_train=1.887581 cos_to_last_merge=0.8118 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.812
[S17] round=34 local utility u=0.808636 metrics={'f1_val': 0.6796387075829161, 'auprc': 0.9290857474344396, 'loss_val': 0.8095805946845674, 'psi': 0.7794175235235254}-{'f1_val': 0.56697287216833, 'auprc': 0.7546426505814188, 'loss_val': 1.2275286085322221, 'psi': 0.6420407835335655}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:58316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:58309
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1801) from S6
[S16] cosine check vs S6: cos=-0.0729
[S16] DROPPED delta from S6 (cos=-0.0729 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1797) from S7
[S8] cosine check vs S7: cos=0.9984
[S2] START round=35 head_norm_before_train=1.589721 cos_to_last_merge=0.9717 (last merge round=28)
[S2] round=35 local utility u=0.000000 metrics={'f1_val': 0.8601337361721194, 'auprc': 0.8359072011340074, 'loss_val': 0.3035274609995003, 'psi': 0.8504431221568746}-{'f1_val': 0.8317799516996357, 'auprc': 0.9543604939528771, 'loss_val': 0.3748988563481998, 'psi': 0.8808121686009323}
[S3] START round=35 head_norm_before_train=2.025307 (no previous merge yet)
[S3] round=35 local utility u=0.000000 metrics={'f1_val': 0.9055797643163369, 'auprc': 0.9987617101616779, 'loss_val': 0.15515503139362027, 'psi': 0.9428525426544734}-{'f1_val': 0.960651231474942, 'auprc': 0.9981264265977958, 'loss_val': 0.12939343808287368, 'psi': 0.9756413095240835}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=35 head_norm_before_train=2.159330 cos_to_last_merge=0.9980 (last merge round=27)
[S4] round=35 local utility u=0.000000 metrics={'f1_val': 0.7796182307139841, 'auprc': 0.892575730639448, 'loss_val': 0.4958942658931129, 'psi': 0.8248012306841697}-{'f1_val': 0.9405453586927536, 'auprc': 0.926123360398662, 'loss_val': 0.29872528930658265, 'psi': 0.9347765593751169}
[S5] START round=35 head_norm_before_train=1.357961 cos_to_last_merge=0.9978 (last merge round=30)
[S5] round=35 local utility u=0.543841 metrics={'f1_val': 0.7005691551769304, 'auprc': 0.9970327304801017, 'loss_val': 0.19811187329340893, 'psi': 0.819154585298199}-{'f1_val': 0.6328403317221787, 'auprc': 0.8565311227500383, 'loss_val': 0.4579167569702733, 'psi': 0.7223166481333225}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S5] sending update (kind=head size=1792 to 1 peers)
[S6] START round=35 head_norm_before_train=2.040045 (no previous merge yet)
[S6] round=35 local utility u=0.000000 metrics={'f1_val': 0.6220006276061127, 'auprc': 0.9536178035781036, 'loss_val': 0.7138976107957461, 'psi': 0.754647497994909}-{'f1_val': 0.907238417594954, 'auprc': 0.9720140123901001, 'loss_val': 0.25582669861288954, 'psi': 0.9331486555130124}
[S7] START round=35 head_norm_before_train=1.726659 cos_to_last_merge=0.9992 (last merge round=29)
[S7] round=35 local utility u=0.000000 metrics={'f1_val': 0.5524622698074716, 'auprc': 0.778307757619561, 'loss_val': 0.8296558811677525, 'psi': 0.6428004649323074}-{'f1_val': 0.6410807747400977, 'auprc': 0.7868596452332679, 'loss_val': 0.5841922796849165, 'psi': 0.6993923229373658}
[S8] START round=35 head_norm_before_train=1.764378 cos_to_last_merge=1.0000 (last merge round=33)
[S8] round=35 local utility u=0.020773 metrics={'f1_val': 0.9901099825334893, 'auprc': 0.9991439284953862, 'loss_val': 0.03733718402645748, 'psi': 0.993723560918248}-{'f1_val': 0.985115964419647, 'auprc': 0.9991527985660633, 'loss_val': 0.0489453037863123, 'psi': 0.9907306980782136}
[S9] START round=35 head_norm_before_train=1.708120 cos_to_last_merge=0.9792 (last merge round=21)
[S9] round=35 local utility u=0.030162 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9977605271674114, 'loss_val': 0.031051428247034402, 'psi': 0.9973659583742502}-{'f1_val': 0.9899884433541285, 'auprc': 0.997491106242768, 'loss_val': 0.047879471390803056, 'psi': 0.9929895085095843}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=35 head_norm_before_train=2.141771 (no previous merge yet)
[S10] round=35 local utility u=0.000884 metrics={'f1_val': 0.9951704237150173, 'auprc': 0.9966532336762086, 'loss_val': 0.025231386887122145, 'psi': 0.9957635476994937}-{'f1_val': 0.9956096535150197, 'auprc': 0.9952883140496116, 'loss_val': 0.025539259481958645, 'psi': 0.9954811177288565}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=35 head_norm_before_train=2.214194 cos_to_last_merge=0.9996 (last merge round=29)
[S11] round=35 local utility u=0.000000 metrics={'f1_val': 0.9929058908379387, 'auprc': 0.9990862088321006, 'loss_val': 0.029397259551148726, 'psi': 0.9953780180356034}-{'f1_val': 0.9967460138064482, 'auprc': 0.9988601888148805, 'loss_val': 0.02356088866375653, 'psi': 0.9975916838098211}
[S13] START round=35 head_norm_before_train=1.894464 (no previous merge yet)
[S13] round=35 local utility u=0.576754 metrics={'f1_val': 0.7230873323180529, 'auprc': 0.7325002901575149, 'loss_val': 0.6435215087564583, 'psi': 0.7268525154538377}-{'f1_val': 0.6495824593102837, 'auprc': 0.6682324596970984, 'loss_val': 1.1631966274031886, 'psi': 0.6570424594650095}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=35 head_norm_before_train=1.720918 cos_to_last_merge=0.9989 (last merge round=30)
[S14] round=35 local utility u=0.002473 metrics={'f1_val': 0.9970633655553506, 'auprc': 0.9987140075179628, 'loss_val': 0.05208548859400757, 'psi': 0.9977236223403955}-{'f1_val': 0.9970858939020174, 'auprc': 0.9990056453370191, 'loss_val': 0.05804081176330727, 'psi': 0.9978537944760181}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[S15] START round=35 head_norm_before_train=1.940721 cos_to_last_merge=0.7583 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.758
[S15] round=35 local utility u=0.000000 metrics={'f1_val': 0.885487277815093, 'auprc': 0.9930231418658735, 'loss_val': 0.3048910948627317, 'psi': 0.9285016234354052}-{'f1_val': 0.9884050979765215, 'auprc': 0.9963348439061256, 'loss_val': 0.040314132872643904, 'psi': 0.9915769963483632}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=35 head_norm_before_train=1.544610 cos_to_last_merge=0.9451 (last merge round=20)
[S16] ⚠️ Model drifted since last merge! cos=0.945
[S16] round=35 local utility u=0.358733 metrics={'f1_val': 0.9921909611519293, 'auprc': 0.9938362967716567, 'loss_val': 0.061296919925275764, 'psi': 0.9928490953998202}-{'f1_val': 0.9199386045496492, 'auprc': 0.9915378140279996, 'loss_val': 0.33835374566967297, 'psi': 0.9485782883409893}
[S17] START round=35 head_norm_before_train=1.901850 cos_to_last_merge=0.8111 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.811
[S17] round=35 local utility u=0.000000 metrics={'f1_val': 0.585818031866673, 'auprc': 0.7900869612665342, 'loss_val': 1.2604308848910633, 'psi': 0.6675256036266175}-{'f1_val': 0.6796387075829161, 'auprc': 0.9290857474344396, 'loss_val': 0.8095805946845674, 'psi': 0.7794175235235254}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:58307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=35 metric=0.9901 head_norm=1.783992
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.137985e-02
[S8] stored merged vector for next round verification (round=35)
[S8] DEBUG after merge:  round=35 metric=0.9901 head_norm=1.754486 delta_norm=0.061380
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] sending update (kind=head size=1798 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] RECEIVED delta(kind=head bytes=1798) from S16
[S6] cosine check vs S16: cos=-0.0725
[S6] DROPPED delta from S16 (cos=-0.0725 < 0.0)
[S16] ⇄ pheromone p=0.091 → S6@127.0.0.1:58307
[S6] ⇄ pheromone p=0.280 → S16@127.0.0.1:58316
[S7] ⇄ pheromone p=0.262 → S8@127.0.0.1:58309
[S2] START round=36 head_norm_before_train=1.615108 cos_to_last_merge=0.9692 (last merge round=28)
[S2] round=36 local utility u=0.000000 metrics={'f1_val': 0.8348203858818918, 'auprc': 0.8466007664137399, 'loss_val': 0.35387896403046815, 'psi': 0.839532538094631}-{'f1_val': 0.8601337361721194, 'auprc': 0.8359072011340074, 'loss_val': 0.3035274609995003, 'psi': 0.8504431221568746}
[S3] START round=36 head_norm_before_train=2.032852 (no previous merge yet)
[S3] round=36 local utility u=0.000000 metrics={'f1_val': 0.8129166596121051, 'auprc': 0.9987689606211556, 'loss_val': 0.3010099615687416, 'psi': 0.8872575800157254}-{'f1_val': 0.9055797643163369, 'auprc': 0.9987617101616779, 'loss_val': 0.15515503139362027, 'psi': 0.9428525426544734}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=36 head_norm_before_train=2.158990 cos_to_last_merge=0.9974 (last merge round=27)
[S4] round=36 local utility u=0.595255 metrics={'f1_val': 0.9395055639146638, 'auprc': 0.9139766905486169, 'loss_val': 0.32891069023518255, 'psi': 0.929294014568245}-{'f1_val': 0.7796182307139841, 'auprc': 0.892575730639448, 'loss_val': 0.4958942658931129, 'psi': 0.8248012306841697}
[S5] START round=36 head_norm_before_train=1.372076 cos_to_last_merge=0.9971 (last merge round=30)
[S5] round=36 local utility u=0.000000 metrics={'f1_val': 0.7004809549016324, 'auprc': 0.9430324766900587, 'loss_val': 0.3321686982830022, 'psi': 0.797501563617003}-{'f1_val': 0.7005691551769304, 'auprc': 0.9970327304801017, 'loss_val': 0.19811187329340893, 'psi': 0.819154585298199}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=36 head_norm_before_train=2.042034 (no previous merge yet)
[S6] round=36 local utility u=0.467629 metrics={'f1_val': 0.7712373042361838, 'auprc': 0.955351888381065, 'loss_val': 0.6792611046335824, 'psi': 0.8448831378941363}-{'f1_val': 0.6220006276061127, 'auprc': 0.9536178035781036, 'loss_val': 0.7138976107957461, 'psi': 0.754647497994909}
[S7] START round=36 head_norm_before_train=1.737033 cos_to_last_merge=0.9989 (last merge round=29)
[S7] round=36 local utility u=0.464490 metrics={'f1_val': 0.6480573076802774, 'auprc': 0.80155146500425, 'loss_val': 0.5439774424783739, 'psi': 0.7094549706098664}-{'f1_val': 0.5524622698074716, 'auprc': 0.778307757619561, 'loss_val': 0.8296558811677525, 'psi': 0.6428004649323074}
[S8] START round=36 head_norm_before_train=1.754486 cos_to_last_merge=1.0000 (last merge round=35)
[S8] round=36 local utility u=0.000000 metrics={'f1_val': 0.9683172858656813, 'auprc': 0.9991531060999538, 'loss_val': 0.08362132153457287, 'psi': 0.9806516139593904}-{'f1_val': 0.9901099825334893, 'auprc': 0.9991439284953862, 'loss_val': 0.03733718402645748, 'psi': 0.993723560918248}
[S9] START round=36 head_norm_before_train=1.716937 cos_to_last_merge=0.9785 (last merge round=21)
[S9] round=36 local utility u=0.000593 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9978062548672254, 'loss_val': 0.030001697266834902, 'psi': 0.9973842494541758}-{'f1_val': 0.9971029125121428, 'auprc': 0.9977605271674114, 'loss_val': 0.031051428247034402, 'psi': 0.9973659583742502}
[S9] not sending this round → trigger blocked (psi=0.997)
[S10] START round=36 head_norm_before_train=2.144272 (no previous merge yet)
[S10] round=36 local utility u=0.000262 metrics={'f1_val': 0.9953900010273877, 'auprc': 0.9963804851034229, 'loss_val': 0.025206291983465533, 'psi': 0.9957861946578018}-{'f1_val': 0.9951704237150173, 'auprc': 0.9966532336762086, 'loss_val': 0.025231386887122145, 'psi': 0.9957635476994937}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=36 head_norm_before_train=2.226459 cos_to_last_merge=0.9995 (last merge round=29)
[S11] round=36 local utility u=0.000000 metrics={'f1_val': 0.9914733941771422, 'auprc': 0.9991044868532044, 'loss_val': 0.04191772637962879, 'psi': 0.9945258312475671}-{'f1_val': 0.9929058908379387, 'auprc': 0.9990862088321006, 'loss_val': 0.029397259551148726, 'psi': 0.9953780180356034}
[S13] START round=36 head_norm_before_train=1.895406 (no previous merge yet)
[S13] round=36 local utility u=0.000000 metrics={'f1_val': 0.6499865799570141, 'auprc': 0.682398315391608, 'loss_val': 1.0367980080410435, 'psi': 0.6629512741308516}-{'f1_val': 0.7230873323180529, 'auprc': 0.7325002901575149, 'loss_val': 0.6435215087564583, 'psi': 0.7268525154538377}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=36 head_norm_before_train=1.736914 cos_to_last_merge=0.9984 (last merge round=30)
[S14] round=36 local utility u=0.003149 metrics={'f1_val': 0.9974741268994111, 'auprc': 0.9987356101523721, 'loss_val': 0.04831647990489727, 'psi': 0.9979787202005954}-{'f1_val': 0.9970633655553506, 'auprc': 0.9987140075179628, 'loss_val': 0.05208548859400757, 'psi': 0.9977236223403955}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=36 head_norm_before_train=1.954901 cos_to_last_merge=0.7574 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.757
[S15] round=36 local utility u=0.136115 metrics={'f1_val': 0.905880470610748, 'auprc': 0.9957740150301924, 'loss_val': 0.1632735824413853, 'psi': 0.9418378883785258}-{'f1_val': 0.885487277815093, 'auprc': 0.9930231418658735, 'loss_val': 0.3048910948627317, 'psi': 0.9285016234354052}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=36 head_norm_before_train=1.562506 cos_to_last_merge=0.9431 (last merge round=20)
[S16] ⚠️ Model drifted since last merge! cos=0.943
[S16] round=36 local utility u=0.000000 metrics={'f1_val': 0.823799291547298, 'auprc': 0.9594398873083633, 'loss_val': 0.5636875004638693, 'psi': 0.8780555298517241}-{'f1_val': 0.9921909611519293, 'auprc': 0.9938362967716567, 'loss_val': 0.061296919925275764, 'psi': 0.9928490953998202}
[S17] START round=36 head_norm_before_train=1.911902 cos_to_last_merge=0.8107 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.811
[S17] round=36 local utility u=1.000000 metrics={'f1_val': 0.8071212063598393, 'auprc': 0.9166431550308375, 'loss_val': 0.6231468911239635, 'psi': 0.8509299858282386}-{'f1_val': 0.585818031866673, 'auprc': 0.7900869612665342, 'loss_val': 1.2604308848910633, 'psi': 0.6675256036266175}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:58309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:58316
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1801) from S7
[S8] cosine check vs S7: cos=0.9989
[S16] RECEIVED delta(kind=head bytes=1801) from S6
[S16] cosine check vs S6: cos=-0.0726
[S16] DROPPED delta from S6 (cos=-0.0726 < 0.0)
[S2] START round=37 head_norm_before_train=1.641647 cos_to_last_merge=0.9666 (last merge round=28)
[S2] round=37 local utility u=0.073373 metrics={'f1_val': 0.8320243732558693, 'auprc': 0.9177517960602505, 'loss_val': 0.40381022786931897, 'psi': 0.8663153423776218}-{'f1_val': 0.8348203858818918, 'auprc': 0.8466007664137399, 'loss_val': 0.35387896403046815, 'psi': 0.839532538094631}
[S3] START round=37 head_norm_before_train=2.042185 (no previous merge yet)
[S3] round=37 local utility u=0.557386 metrics={'f1_val': 0.9615785680382265, 'auprc': 0.9981827161199642, 'loss_val': 0.07645067191836148, 'psi': 0.9762202272709215}-{'f1_val': 0.8129166596121051, 'auprc': 0.9987689606211556, 'loss_val': 0.3010099615687416, 'psi': 0.8872575800157254}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=37 head_norm_before_train=2.167848 cos_to_last_merge=0.9969 (last merge round=27)
[S4] round=37 local utility u=0.000000 metrics={'f1_val': 0.9396148799731039, 'auprc': 0.9161162362313464, 'loss_val': 0.34933022292711957, 'psi': 0.930215422476401}-{'f1_val': 0.9395055639146638, 'auprc': 0.9139766905486169, 'loss_val': 0.32891069023518255, 'psi': 0.929294014568245}
[S5] START round=37 head_norm_before_train=1.385981 cos_to_last_merge=0.9962 (last merge round=30)
[S5] round=37 local utility u=1.000000 metrics={'f1_val': 0.9964353361434509, 'auprc': 0.9922615764998024, 'loss_val': 0.17603982738723253, 'psi': 0.9947658322859915}-{'f1_val': 0.7004809549016324, 'auprc': 0.9430324766900587, 'loss_val': 0.3321686982830022, 'psi': 0.797501563617003}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] START round=37 head_norm_before_train=2.050375 (no previous merge yet)
[S6] round=37 local utility u=0.000000 metrics={'f1_val': 0.5976084202110371, 'auprc': 0.9214893912956751, 'loss_val': 0.9315571125232371, 'psi': 0.7271608086448923}-{'f1_val': 0.7712373042361838, 'auprc': 0.955351888381065, 'loss_val': 0.6792611046335824, 'psi': 0.8448831378941363}
[S7] START round=37 head_norm_before_train=1.747059 cos_to_last_merge=0.9985 (last merge round=29)
[S7] round=37 local utility u=0.000000 metrics={'f1_val': 0.5998207037132351, 'auprc': 0.7882539396931756, 'loss_val': 0.6586073900736212, 'psi': 0.6751939981052113}-{'f1_val': 0.6480573076802774, 'auprc': 0.80155146500425, 'loss_val': 0.5439774424783739, 'psi': 0.7094549706098664}
[S8] START round=37 head_norm_before_train=1.769198 cos_to_last_merge=1.0000 (last merge round=35)
[S8] round=37 local utility u=0.000000 metrics={'f1_val': 0.8836969621792776, 'auprc': 0.9955157101664938, 'loss_val': 0.2148825589168609, 'psi': 0.9284244613741641}-{'f1_val': 0.9683172858656813, 'auprc': 0.9991531060999538, 'loss_val': 0.08362132153457287, 'psi': 0.9806516139593904}
[S9] START round=37 head_norm_before_train=1.725780 cos_to_last_merge=0.9777 (last merge round=21)
[S9] round=37 local utility u=0.000000 metrics={'f1_val': 0.9958601375429889, 'auprc': 0.9977987576427998, 'loss_val': 0.02989449386378536, 'psi': 0.9966355855829132}-{'f1_val': 0.9971029125121428, 'auprc': 0.9978062548672254, 'loss_val': 0.030001697266834902, 'psi': 0.9973842494541758}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=37 head_norm_before_train=2.151671 (no previous merge yet)
[S10] round=37 local utility u=0.000229 metrics={'f1_val': 0.9953900010273877, 'auprc': 0.996501980147717, 'loss_val': 0.025113057415100847, 'psi': 0.9958347926755194}-{'f1_val': 0.9953900010273877, 'auprc': 0.9963804851034229, 'loss_val': 0.025206291983465533, 'psi': 0.9957861946578018}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=37 head_norm_before_train=2.238798 cos_to_last_merge=0.9993 (last merge round=29)
[S11] round=37 local utility u=0.000000 metrics={'f1_val': 0.9909968189540582, 'auprc': 0.9990833389873599, 'loss_val': 0.05023350383542418, 'psi': 0.9942314269673789}-{'f1_val': 0.9914733941771422, 'auprc': 0.9991044868532044, 'loss_val': 0.04191772637962879, 'psi': 0.9945258312475671}
[S13] START round=37 head_norm_before_train=1.904932 (no previous merge yet)
[S13] round=37 local utility u=0.222614 metrics={'f1_val': 0.6656702642651304, 'auprc': 0.6918647922790315, 'loss_val': 0.7140725268001716, 'psi': 0.6761480754706908}-{'f1_val': 0.6499865799570141, 'auprc': 0.682398315391608, 'loss_val': 1.0367980080410435, 'psi': 0.6629512741308516}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=37 head_norm_before_train=1.752484 cos_to_last_merge=0.9978 (last merge round=30)
[S14] round=37 local utility u=0.000000 metrics={'f1_val': 0.9961701069502772, 'auprc': 0.996832762538089, 'loss_val': 0.048327202259380385, 'psi': 0.9964351691854019}-{'f1_val': 0.9974741268994111, 'auprc': 0.9987356101523721, 'loss_val': 0.04831647990489727, 'psi': 0.9979787202005954}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=37 head_norm_before_train=1.968328 cos_to_last_merge=0.7566 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.757
[S15] round=37 local utility u=0.345837 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9974397316109352, 'loss_val': 0.021793041373723298, 'psi': 0.9970238936768865}-{'f1_val': 0.905880470610748, 'auprc': 0.9957740150301924, 'loss_val': 0.1632735824413853, 'psi': 0.9418378883785258}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=37 head_norm_before_train=1.578714 cos_to_last_merge=0.9414 (last merge round=20)
[S16] ⚠️ Model drifted since last merge! cos=0.941
[S16] round=37 local utility u=0.000000 metrics={'f1_val': 0.8351662222541826, 'auprc': 0.9884623195065285, 'loss_val': 0.8528281399222275, 'psi': 0.8964846611551209}-{'f1_val': 0.823799291547298, 'auprc': 0.9594398873083633, 'loss_val': 0.5636875004638693, 'psi': 0.8780555298517241}
[S17] START round=37 head_norm_before_train=1.920971 cos_to_last_merge=0.8104 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.810
[S17] round=37 local utility u=0.000000 metrics={'f1_val': 0.5922771836924992, 'auprc': 0.9414118228507693, 'loss_val': 1.2250477004214742, 'psi': 0.7319310393558072}-{'f1_val': 0.8071212063598393, 'auprc': 0.9166431550308375, 'loss_val': 0.6231468911239635, 'psi': 0.8509299858282386}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=37 metric=0.8837 head_norm=1.781482
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.757548e-02
[S8] stored merged vector for next round verification (round=37)
[S8] DEBUG after merge:  round=37 metric=0.8852 head_norm=1.763713 delta_norm=0.047575
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=38 head_norm_before_train=1.664317 cos_to_last_merge=0.9645 (last merge round=28)
[S2] round=38 local utility u=0.000000 metrics={'f1_val': 0.8309783579777268, 'auprc': 0.8271002869740048, 'loss_val': 0.3841195101340421, 'psi': 0.829427129576238}-{'f1_val': 0.8320243732558693, 'auprc': 0.9177517960602505, 'loss_val': 0.40381022786931897, 'psi': 0.8663153423776218}
[S3] START round=38 head_norm_before_train=2.053304 (no previous merge yet)
[S3] round=38 local utility u=0.087270 metrics={'f1_val': 0.9841561160718577, 'auprc': 0.9984468095813077, 'loss_val': 0.038168782373308875, 'psi': 0.9898723934756377}-{'f1_val': 0.9615785680382265, 'auprc': 0.9981827161199642, 'loss_val': 0.07645067191836148, 'psi': 0.9762202272709215}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=38 head_norm_before_train=2.176916 cos_to_last_merge=0.9964 (last merge round=27)
[S4] round=38 local utility u=0.071715 metrics={'f1_val': 0.9447933087617195, 'auprc': 0.9333424360260143, 'loss_val': 0.2886495464377601, 'psi': 0.9402129596674373}-{'f1_val': 0.9396148799731039, 'auprc': 0.9161162362313464, 'loss_val': 0.34933022292711957, 'psi': 0.930215422476401}
[S5] START round=38 head_norm_before_train=1.396513 cos_to_last_merge=0.9954 (last merge round=30)
[S5] round=38 local utility u=0.000000 metrics={'f1_val': 0.5732531140356445, 'auprc': 0.8289304561849686, 'loss_val': 0.5968723354541818, 'psi': 0.6755240508953742}-{'f1_val': 0.9964353361434509, 'auprc': 0.9922615764998024, 'loss_val': 0.17603982738723253, 'psi': 0.9947658322859915}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=38 head_norm_before_train=2.058086 (no previous merge yet)
[S6] round=38 local utility u=0.000000 metrics={'f1_val': 0.5981780626880191, 'auprc': 0.7121452350554396, 'loss_val': 1.333412237023603, 'psi': 0.6437649316349873}-{'f1_val': 0.5976084202110371, 'auprc': 0.9214893912956751, 'loss_val': 0.9315571125232371, 'psi': 0.7271608086448923}
[S7] START round=38 head_norm_before_train=1.757812 cos_to_last_merge=0.9980 (last merge round=29)
[S7] round=38 local utility u=0.129364 metrics={'f1_val': 0.6257322864865293, 'auprc': 0.7955849685012757, 'loss_val': 0.5773411534065099, 'psi': 0.6936733592924279}-{'f1_val': 0.5998207037132351, 'auprc': 0.7882539396931756, 'loss_val': 0.6586073900736212, 'psi': 0.6751939981052113}
[S8] START round=38 head_norm_before_train=1.763713 cos_to_last_merge=1.0000 (last merge round=37)
[S8] round=38 local utility u=0.409124 metrics={'f1_val': 0.989031239147991, 'auprc': 0.9991589430661714, 'loss_val': 0.039570357584558645, 'psi': 0.993082320715263}-{'f1_val': 0.8836969621792776, 'auprc': 0.9955157101664938, 'loss_val': 0.2148825589168609, 'psi': 0.9284244613741641}
[S9] START round=38 head_norm_before_train=1.736109 cos_to_last_merge=0.9769 (last merge round=21)
[S9] round=38 local utility u=0.000044 metrics={'f1_val': 0.9958601375429889, 'auprc': 0.9978222094853149, 'loss_val': 0.029877821574677773, 'psi': 0.9966449663199193}-{'f1_val': 0.9958601375429889, 'auprc': 0.9977987576427998, 'loss_val': 0.02989449386378536, 'psi': 0.9966355855829132}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] sending update (kind=head size=1803 to 1 peers)
[S10] START round=38 head_norm_before_train=2.161891 (no previous merge yet)
[S10] round=38 local utility u=0.000000 metrics={'f1_val': 0.9951704237150173, 'auprc': 0.9965212277541381, 'loss_val': 0.025043353485990228, 'psi': 0.9957107453306655}-{'f1_val': 0.9953900010273877, 'auprc': 0.996501980147717, 'loss_val': 0.025113057415100847, 'psi': 0.9958347926755194}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=38 head_norm_before_train=2.250543 cos_to_last_merge=0.9991 (last merge round=29)
[S11] round=38 local utility u=0.010355 metrics={'f1_val': 0.9917118539908788, 'auprc': 0.9990512136561313, 'loss_val': 0.033717065019064046, 'psi': 0.9946475978569798}-{'f1_val': 0.9909968189540582, 'auprc': 0.9990833389873599, 'loss_val': 0.05023350383542418, 'psi': 0.9942314269673789}
[S13] START round=38 head_norm_before_train=1.919835 (no previous merge yet)
[S13] round=38 local utility u=0.000000 metrics={'f1_val': 0.6434902146545534, 'auprc': 0.6567236264286341, 'loss_val': 0.986172311051002, 'psi': 0.6487835793641856}-{'f1_val': 0.6656702642651304, 'auprc': 0.6918647922790315, 'loss_val': 0.7140725268001716, 'psi': 0.6761480754706908}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=38 head_norm_before_train=1.766245 cos_to_last_merge=0.9974 (last merge round=30)
[S14] round=38 local utility u=0.008409 metrics={'f1_val': 0.9971159530966711, 'auprc': 0.9987538403381189, 'loss_val': 0.04294816899145054, 'psi': 0.9977711079932503}-{'f1_val': 0.9961701069502772, 'auprc': 0.996832762538089, 'loss_val': 0.048327202259380385, 'psi': 0.9964351691854019}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S14] sending update (kind=head size=1806 to 1 peers)
[S15] START round=38 head_norm_before_train=1.981908 cos_to_last_merge=0.7557 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.756
[S15] round=38 local utility u=0.000000 metrics={'f1_val': 0.972715825812984, 'auprc': 0.9955601788207273, 'loss_val': 0.05052213433464666, 'psi': 0.9818535670160814}-{'f1_val': 0.9967466683875206, 'auprc': 0.9974397316109352, 'loss_val': 0.021793041373723298, 'psi': 0.9970238936768865}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=38 head_norm_before_train=1.592539 cos_to_last_merge=0.9399 (last merge round=20)
[S16] ⚠️ Model drifted since last merge! cos=0.940
[S16] round=38 local utility u=0.881953 metrics={'f1_val': 0.9919650973427813, 'auprc': 0.9953986015920093, 'loss_val': 0.05052511470823017, 'psi': 0.9933384990424725}-{'f1_val': 0.8351662222541826, 'auprc': 0.9884623195065285, 'loss_val': 0.8528281399222275, 'psi': 0.8964846611551209}
[S17] START round=38 head_norm_before_train=1.929585 cos_to_last_merge=0.8101 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.810
[S17] round=38 local utility u=0.700402 metrics={'f1_val': 0.7484716797643677, 'auprc': 0.932786574920724, 'loss_val': 0.7355350185586815, 'psi': 0.8221976378269102}-{'f1_val': 0.5922771836924992, 'auprc': 0.9414118228507693, 'loss_val': 1.2250477004214742, 'psi': 0.7319310393558072}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S11] sending update (kind=head size=1792 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:58307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] sending update (kind=head size=1795 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:58308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:58309
[S16] sending update (kind=head size=1804 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] RECEIVED delta(kind=head bytes=1801) from S8
[S7] cosine check vs S8: cos=0.9990
[S6] RECEIVED delta(kind=head bytes=1804) from S16
[S6] cosine check vs S16: cos=-0.0737
[S6] DROPPED delta from S16 (cos=-0.0737 < 0.0)
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1801) from S7
[S8] cosine check vs S7: cos=0.9990
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=38 metric=0.6257 head_norm=1.767536
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.032589e-02
[S7] stored merged vector for next round verification (round=38)
[S7] DEBUG after merge:  round=38 metric=0.6236 head_norm=1.773036 delta_norm=0.040326
[S7] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=39 head_norm_before_train=1.682503 cos_to_last_merge=0.9628 (last merge round=28)
[S2] round=39 local utility u=0.224251 metrics={'f1_val': 0.8919144069381306, 'auprc': 0.8287027365895399, 'loss_val': 0.30604032794615216, 'psi': 0.8666297387986943}-{'f1_val': 0.8309783579777268, 'auprc': 0.8271002869740048, 'loss_val': 0.3841195101340421, 'psi': 0.829427129576238}
[S3] START round=39 head_norm_before_train=2.063672 (no previous merge yet)
[S3] round=39 local utility u=0.049322 metrics={'f1_val': 0.9977814963782642, 'auprc': 0.9986317757353331, 'loss_val': 0.02183152762629802, 'psi': 0.9981216081210917}-{'f1_val': 0.9841561160718577, 'auprc': 0.9984468095813077, 'loss_val': 0.038168782373308875, 'psi': 0.9898723934756377}
[S3] not sending this round → trigger blocked (psi=0.998)
[S3] r=40 psi=0.998 u=0.0493 p_local=0.1215 f1=0.998 auprc=0.999 bytes=37794
[S4] START round=39 head_norm_before_train=2.176834 cos_to_last_merge=0.9953 (last merge round=27)
[S4] round=39 local utility u=0.000000 metrics={'f1_val': 0.9415408765051647, 'auprc': 0.9296569634315135, 'loss_val': 0.2981613071684162, 'psi': 0.9367873112757042}-{'f1_val': 0.9447933087617195, 'auprc': 0.9333424360260143, 'loss_val': 0.2886495464377601, 'psi': 0.9402129596674373}
[S5] START round=39 head_norm_before_train=1.406094 cos_to_last_merge=0.9949 (last merge round=30)
[S5] round=39 local utility u=0.833354 metrics={'f1_val': 0.7019313773589749, 'auprc': 0.9895894817896922, 'loss_val': 0.184211345283278, 'psi': 0.8169946191312618}-{'f1_val': 0.5732531140356445, 'auprc': 0.8289304561849686, 'loss_val': 0.5968723354541818, 'psi': 0.6755240508953742}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S5] sending update (kind=head size=1806 to 1 peers)
[S5] r=40 psi=0.817 u=0.8334 p_local=0.3870 f1=0.702 auprc=0.990 bytes=44920
[S6] START round=39 head_norm_before_train=2.057906 (no previous merge yet)
[S6] round=39 local utility u=1.000000 metrics={'f1_val': 0.9614889398218819, 'auprc': 0.9922865181402288, 'loss_val': 0.141396596405683, 'psi': 0.9738079711492207}-{'f1_val': 0.5981780626880191, 'auprc': 0.7121452350554396, 'loss_val': 1.333412237023603, 'psi': 0.6437649316349873}
[S7] START round=39 head_norm_before_train=1.773036 cos_to_last_merge=1.0000 (last merge round=38)
[S7] round=39 local utility u=0.000000 metrics={'f1_val': 0.5554558999676098, 'auprc': 0.782346150677858, 'loss_val': 0.8022240422841503, 'psi': 0.6462120002517091}-{'f1_val': 0.6257322864865293, 'auprc': 0.7955849685012757, 'loss_val': 0.5773411534065099, 'psi': 0.6936733592924279}
[S8] START round=39 head_norm_before_train=1.779433 cos_to_last_merge=1.0000 (last merge round=37)
[S8] round=39 local utility u=0.013744 metrics={'f1_val': 0.9927572273717925, 'auprc': 0.9989682833023638, 'loss_val': 0.033865811139345406, 'psi': 0.9952416497440211}-{'f1_val': 0.989031239147991, 'auprc': 0.9991589430661714, 'loss_val': 0.039570357584558645, 'psi': 0.993082320715263}
[S9] START round=39 head_norm_before_train=1.745607 cos_to_last_merge=0.9761 (last merge round=21)
[S9] round=39 local utility u=0.000000 metrics={'f1_val': 0.9941897064172326, 'auprc': 0.9977995782950828, 'loss_val': 0.03307563289295312, 'psi': 0.9956336551683727}-{'f1_val': 0.9958601375429889, 'auprc': 0.9978222094853149, 'loss_val': 0.029877821574677773, 'psi': 0.9966449663199193}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=40 psi=0.996 u=0.0000 p_local=0.0171 f1=0.994 auprc=0.998 bytes=44977
[S10] START round=39 head_norm_before_train=2.172621 (no previous merge yet)
[S10] round=39 local utility u=0.000487 metrics={'f1_val': 0.9953900010273877, 'auprc': 0.996408181345719, 'loss_val': 0.025048538485173938, 'psi': 0.9957972731547202}-{'f1_val': 0.9951704237150173, 'auprc': 0.9965212277541381, 'loss_val': 0.025043353485990228, 'psi': 0.9957107453306655}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S10] r=40 psi=0.996 u=0.0005 p_local=0.0012 f1=0.995 auprc=0.996 bytes=50328
[S11] START round=39 head_norm_before_train=2.261534 cos_to_last_merge=0.9989 (last merge round=29)
[S11] round=39 local utility u=0.023058 metrics={'f1_val': 0.9969878514242156, 'auprc': 0.9989165009095801, 'loss_val': 0.018853340518148493, 'psi': 0.9977593112183615}-{'f1_val': 0.9917118539908788, 'auprc': 0.9990512136561313, 'loss_val': 0.033717065019064046, 'psi': 0.9946475978569798}
[S13] START round=39 head_norm_before_train=1.933042 (no previous merge yet)
[S13] round=39 local utility u=0.300985 metrics={'f1_val': 0.6884618084740424, 'auprc': 0.704441761276736, 'loss_val': 0.7971872675751753, 'psi': 0.6948537895951199}-{'f1_val': 0.6434902146545534, 'auprc': 0.6567236264286341, 'loss_val': 0.986172311051002, 'psi': 0.6487835793641856}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S13] r=40 psi=0.695 u=0.3010 p_local=0.1801 f1=0.688 auprc=0.704 bytes=37798
[S14] START round=39 head_norm_before_train=1.777612 cos_to_last_merge=0.9969 (last merge round=30)
[S14] round=39 local utility u=0.000000 metrics={'f1_val': 0.9961505794277568, 'auprc': 0.9974586477120307, 'loss_val': 0.04511709101261969, 'psi': 0.9966738067414664}-{'f1_val': 0.9971159530966711, 'auprc': 0.9987538403381189, 'loss_val': 0.04294816899145054, 'psi': 0.9977711079932503}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=40 psi=0.997 u=0.0000 p_local=0.0120 f1=0.996 auprc=0.997 bytes=50346
[S15] START round=39 head_norm_before_train=1.994833 cos_to_last_merge=0.7548 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.755
[S15] round=39 local utility u=0.000000 metrics={'f1_val': 0.9595201016809821, 'auprc': 0.9967733970212311, 'loss_val': 0.069075458494907, 'psi': 0.9744214198170817}-{'f1_val': 0.972715825812984, 'auprc': 0.9955601788207273, 'loss_val': 0.05052213433464666, 'psi': 0.9818535670160814}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] r=40 psi=0.974 u=0.0000 p_local=0.1460 f1=0.960 auprc=0.997 bytes=35990
[S16] START round=39 head_norm_before_train=1.605618 cos_to_last_merge=0.9384 (last merge round=20)
[S16] ⚠️ Model drifted since last merge! cos=0.938
[S16] round=39 local utility u=0.000000 metrics={'f1_val': 0.9019263455335154, 'auprc': 0.9874002079086449, 'loss_val': 0.22626491818484445, 'psi': 0.9361158904835671}-{'f1_val': 0.9919650973427813, 'auprc': 0.9953986015920093, 'loss_val': 0.05052511470823017, 'psi': 0.9933384990424725}
[S17] START round=39 head_norm_before_train=1.936748 cos_to_last_merge=0.8100 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.810
[S17] round=39 local utility u=0.000000 metrics={'f1_val': 0.6725542993439195, 'auprc': 0.846202317956303, 'loss_val': 0.9842878656072261, 'psi': 0.7420135067888729}-{'f1_val': 0.7484716797643677, 'auprc': 0.932786574920724, 'loss_val': 0.7355350185586815, 'psi': 0.8221976378269102}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=40 psi=0.742 u=0.0000 p_local=0.3175 f1=0.673 auprc=0.846 bytes=35983
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] sending update (kind=head size=1805 to 1 peers)
[S11] not sending this round → trigger blocked (psi=0.998)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.995)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=40 psi=0.937 u=0.0000 p_local=0.0803 f1=0.942 auprc=0.930 bytes=30556
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=39 metric=0.9928 head_norm=1.793328
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.583976e-02
[S8] stored merged vector for next round verification (round=39)
[S8] DEBUG after merge:  round=39 metric=0.9928 head_norm=1.779889 delta_norm=0.045840
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S8] r=40 psi=0.995 u=0.0137 p_local=0.0784 f1=0.993 auprc=0.999 bytes=37766
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:58316
[S16] r=40 psi=0.936 u=0.0000 p_local=0.1784 f1=0.902 auprc=0.987 bytes=43131
[S2] r=40 psi=0.867 u=0.2243 p_local=0.1145 f1=0.892 auprc=0.829 bytes=44926
[S11] r=40 psi=0.998 u=0.0231 p_local=0.0117 f1=0.997 auprc=0.999 bytes=43131
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1802 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1802) from S6
[S16] cosine check vs S6: cos=-0.0745
[S16] DROPPED delta from S6 (cos=-0.0745 < 0.0)
[S7] r=40 psi=0.646 u=0.0000 p_local=0.1754 f1=0.555 auprc=0.782 bytes=41352
[S6] r=40 psi=0.974 u=1.0000 p_local=0.3628 f1=0.961 auprc=0.992 bytes=35993
[S2] START round=40 head_norm_before_train=1.695551 cos_to_last_merge=0.9615 (last merge round=28)
[S2] round=40 local utility u=0.000000 metrics={'f1_val': 0.825131964214572, 'auprc': 0.9672273192284078, 'loss_val': 0.4202397858075925, 'psi': 0.8819701062201063}-{'f1_val': 0.8919144069381306, 'auprc': 0.8287027365895399, 'loss_val': 0.30604032794615216, 'psi': 0.8666297387986943}
[S3] START round=40 head_norm_before_train=2.074973 (no previous merge yet)
[S3] round=40 local utility u=0.000000 metrics={'f1_val': 0.9615385219550141, 'auprc': 0.9983057523349674, 'loss_val': 0.07562243027949915, 'psi': 0.9762454141069955}-{'f1_val': 0.9977814963782642, 'auprc': 0.9986317757353331, 'loss_val': 0.02183152762629802, 'psi': 0.9981216081210917}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=40 head_norm_before_train=2.189911 cos_to_last_merge=0.9949 (last merge round=27)
[S4] round=40 local utility u=0.041564 metrics={'f1_val': 0.9491948125121521, 'auprc': 0.9417740815920022, 'loss_val': 0.2973091036729644, 'psi': 0.9462265201440921}-{'f1_val': 0.9415408765051647, 'auprc': 0.9296569634315135, 'loss_val': 0.2981613071684162, 'psi': 0.9367873112757042}
[S5] START round=40 head_norm_before_train=1.414601 cos_to_last_merge=0.9944 (last merge round=30)
[S5] round=40 local utility u=0.000000 metrics={'f1_val': 0.7006536512124258, 'auprc': 0.8541290084544878, 'loss_val': 0.3739537397848084, 'psi': 0.7620437941092506}-{'f1_val': 0.7019313773589749, 'auprc': 0.9895894817896922, 'loss_val': 0.184211345283278, 'psi': 0.8169946191312618}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=40 head_norm_before_train=2.058834 (no previous merge yet)
[S6] round=40 local utility u=0.000000 metrics={'f1_val': 0.6725861197456819, 'auprc': 0.760520399234797, 'loss_val': 1.0691013581459674, 'psi': 0.7077598315413279}-{'f1_val': 0.9614889398218819, 'auprc': 0.9922865181402288, 'loss_val': 0.141396596405683, 'psi': 0.9738079711492207}
[S7] START round=40 head_norm_before_train=1.785740 cos_to_last_merge=0.9999 (last merge round=38)
[S7] round=40 local utility u=0.289590 metrics={'f1_val': 0.6146999136815998, 'auprc': 0.793157320878477, 'loss_val': 0.6109411149187075, 'psi': 0.6860828765603506}-{'f1_val': 0.5554558999676098, 'auprc': 0.782346150677858, 'loss_val': 0.8022240422841503, 'psi': 0.6462120002517091}
[S8] START round=40 head_norm_before_train=1.779889 cos_to_last_merge=1.0000 (last merge round=39)
[S8] round=40 local utility u=0.000000 metrics={'f1_val': 0.9630992857284996, 'auprc': 0.9957779652414691, 'loss_val': 0.1099519239068498, 'psi': 0.9761707575336874}-{'f1_val': 0.9927572273717925, 'auprc': 0.9989682833023638, 'loss_val': 0.033865811139345406, 'psi': 0.9952416497440211}
[S9] START round=40 head_norm_before_train=1.755040 cos_to_last_merge=0.9753 (last merge round=21)
[S9] round=40 local utility u=0.000000 metrics={'f1_val': 0.9899884433541285, 'auprc': 0.997729728726857, 'loss_val': 0.043770086556615385, 'psi': 0.9930849575032199}-{'f1_val': 0.9941897064172326, 'auprc': 0.9977995782950828, 'loss_val': 0.03307563289295312, 'psi': 0.9956336551683727}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=40 head_norm_before_train=2.182552 (no previous merge yet)
[S10] round=40 local utility u=0.000000 metrics={'f1_val': 0.9951704237150173, 'auprc': 0.9964707884427946, 'loss_val': 0.02498303698025761, 'psi': 0.9956905696061282}-{'f1_val': 0.9953900010273877, 'auprc': 0.996408181345719, 'loss_val': 0.025048538485173938, 'psi': 0.9957972731547202}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=40 head_norm_before_train=2.272418 cos_to_last_merge=0.9987 (last merge round=29)
[S11] round=40 local utility u=0.001372 metrics={'f1_val': 0.9974011907167429, 'auprc': 0.9988185577379243, 'loss_val': 0.0182964315962397, 'psi': 0.9979681375252155}-{'f1_val': 0.9969878514242156, 'auprc': 0.9989165009095801, 'loss_val': 0.018853340518148493, 'psi': 0.9977593112183615}
[S13] START round=40 head_norm_before_train=1.942787 (no previous merge yet)
[S13] round=40 local utility u=0.000000 metrics={'f1_val': 0.7051856701695771, 'auprc': 0.6803621653504911, 'loss_val': 0.929270283434672, 'psi': 0.6952562682419428}-{'f1_val': 0.6884618084740424, 'auprc': 0.704441761276736, 'loss_val': 0.7971872675751753, 'psi': 0.6948537895951199}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=40 head_norm_before_train=1.788058 cos_to_last_merge=0.9964 (last merge round=30)
[S14] round=40 local utility u=0.007151 metrics={'f1_val': 0.9970407855713329, 'auprc': 0.9985439297197455, 'loss_val': 0.039411223382188915, 'psi': 0.997642043230698}-{'f1_val': 0.9961505794277568, 'auprc': 0.9974586477120307, 'loss_val': 0.04511709101261969, 'psi': 0.9966738067414664}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=40 head_norm_before_train=2.006636 cos_to_last_merge=0.7540 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.754
[S15] round=40 local utility u=0.000000 metrics={'f1_val': 0.902305976265057, 'auprc': 0.9967309675361954, 'loss_val': 0.20417384102344005, 'psi': 0.9400759727735124}-{'f1_val': 0.9595201016809821, 'auprc': 0.9967733970212311, 'loss_val': 0.069075458494907, 'psi': 0.9744214198170817}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=40 head_norm_before_train=1.617612 cos_to_last_merge=0.9368 (last merge round=20)
[S16] ⚠️ Model drifted since last merge! cos=0.937
[S16] round=40 local utility u=0.371494 metrics={'f1_val': 0.9926605645761105, 'auprc': 0.993922688392099, 'loss_val': 0.04724990035804298, 'psi': 0.9931654141025059}-{'f1_val': 0.9019263455335154, 'auprc': 0.9874002079086449, 'loss_val': 0.22626491818484445, 'psi': 0.9361158904835671}
[S17] START round=40 head_norm_before_train=1.945136 cos_to_last_merge=0.8096 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.810
[S17] round=40 local utility u=0.000000 metrics={'f1_val': 0.6236129575741167, 'auprc': 0.8565293188188066, 'loss_val': 1.0738499865541642, 'psi': 0.7167795020719927}-{'f1_val': 0.6725542993439195, 'auprc': 0.846202317956303, 'loss_val': 0.9842878656072261, 'psi': 0.7420135067888729}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6]  timeout peer S4
[S11]  timeout peer S9
[S4]  timeout peer S11
[S7]  timeout peer S14
[S2]  timeout peer S5
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:58307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S8] ⇄ pheromone p=0.063 → S7@127.0.0.1:58308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:58309
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] RECEIVED delta(kind=head bytes=1800) from S16
[S6] cosine check vs S16: cos=-0.0744
[S6] DROPPED delta from S16 (cos=-0.0744 < 0.0)
[S6] ⇄ pheromone p=0.290 → S16@127.0.0.1:58316
[S16] ⇄ pheromone p=0.217 → S6@127.0.0.1:58307
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1804) from S7
[S8] cosine check vs S7: cos=0.9997
[S7] ⇄ pheromone p=0.198 → S8@127.0.0.1:58309
[S2] START round=41 head_norm_before_train=1.708974 cos_to_last_merge=0.9603 (last merge round=28)
[S2] round=41 local utility u=0.000000 metrics={'f1_val': 0.6173003144453761, 'auprc': 0.7619552133183147, 'loss_val': 1.4531630263788844, 'psi': 0.6751622739945515}-{'f1_val': 0.825131964214572, 'auprc': 0.9672273192284078, 'loss_val': 0.4202397858075925, 'psi': 0.8819701062201063}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=41 head_norm_before_train=2.084878 (no previous merge yet)
[S3] round=41 local utility u=0.041771 metrics={'f1_val': 0.9740150500049245, 'auprc': 0.9983083584281106, 'loss_val': 0.06694829283016993, 'psi': 0.9837323733741989}-{'f1_val': 0.9615385219550141, 'auprc': 0.9983057523349674, 'loss_val': 0.07562243027949915, 'psi': 0.9762454141069955}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=41 head_norm_before_train=2.199332 cos_to_last_merge=0.9944 (last merge round=27)
[S4] round=41 local utility u=0.000000 metrics={'f1_val': 0.9405934445854656, 'auprc': 0.923002389446342, 'loss_val': 0.3205386725766097, 'psi': 0.9335570225298162}-{'f1_val': 0.9491948125121521, 'auprc': 0.9417740815920022, 'loss_val': 0.2973091036729644, 'psi': 0.9462265201440921}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=41 head_norm_before_train=1.420568 cos_to_last_merge=0.9941 (last merge round=30)
[S5] round=41 local utility u=0.999281 metrics={'f1_val': 0.9405388854813352, 'auprc': 0.9864806709817172, 'loss_val': 0.2117578130344195, 'psi': 0.958915599681488}-{'f1_val': 0.7006536512124258, 'auprc': 0.8541290084544878, 'loss_val': 0.3739537397848084, 'psi': 0.7620437941092506}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=41 head_norm_before_train=2.065603 (no previous merge yet)
[S6] round=41 local utility u=0.945085 metrics={'f1_val': 0.8213137324816339, 'auprc': 0.945678040671379, 'loss_val': 0.6267703788282841, 'psi': 0.871059455757532}-{'f1_val': 0.6725861197456819, 'auprc': 0.760520399234797, 'loss_val': 1.0691013581459674, 'psi': 0.7077598315413279}
[S7] START round=41 head_norm_before_train=1.796135 cos_to_last_merge=0.9998 (last merge round=38)
[S7] round=41 local utility u=0.000000 metrics={'f1_val': 0.5732345740391449, 'auprc': 0.784476688157406, 'loss_val': 0.7324069079335476, 'psi': 0.6577314196864494}-{'f1_val': 0.6146999136815998, 'auprc': 0.793157320878477, 'loss_val': 0.6109411149187075, 'psi': 0.6860828765603506}
[S8] START round=41 head_norm_before_train=1.792325 cos_to_last_merge=1.0000 (last merge round=39)
[S8] round=41 local utility u=0.116999 metrics={'f1_val': 0.9929047892228047, 'auprc': 0.9906567400049053, 'loss_val': 0.039424225999359346, 'psi': 0.992005569535645}-{'f1_val': 0.9630992857284996, 'auprc': 0.9957779652414691, 'loss_val': 0.1099519239068498, 'psi': 0.9761707575336874}
[S9] START round=41 head_norm_before_train=1.762231 cos_to_last_merge=0.9746 (last merge round=21)
[S9] round=41 local utility u=0.007468 metrics={'f1_val': 0.9912237657809659, 'auprc': 0.997783319942373, 'loss_val': 0.03640628528760346, 'psi': 0.9938475874455287}-{'f1_val': 0.9899884433541285, 'auprc': 0.997729728726857, 'loss_val': 0.043770086556615385, 'psi': 0.9930849575032199}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=41 head_norm_before_train=2.187773 (no previous merge yet)
[S10] round=41 local utility u=0.000279 metrics={'f1_val': 0.9951704237150173, 'auprc': 0.9966673337837869, 'loss_val': 0.025014375444101518, 'psi': 0.9957691877425251}-{'f1_val': 0.9951704237150173, 'auprc': 0.9964707884427946, 'loss_val': 0.02498303698025761, 'psi': 0.9956905696061282}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=41 head_norm_before_train=2.282998 cos_to_last_merge=0.9985 (last merge round=29)
[S11] round=41 local utility u=0.000000 metrics={'f1_val': 0.9967460138064482, 'auprc': 0.9985693611312434, 'loss_val': 0.019734116634987923, 'psi': 0.9974753527363663}-{'f1_val': 0.9974011907167429, 'auprc': 0.9988185577379243, 'loss_val': 0.0182964315962397, 'psi': 0.9979681375252155}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=41 head_norm_before_train=1.952072 (no previous merge yet)
[S13] round=41 local utility u=0.000000 metrics={'f1_val': 0.615977088507707, 'auprc': 0.7378316253583113, 'loss_val': 0.9221348695310961, 'psi': 0.6647189032479488}-{'f1_val': 0.7051856701695771, 'auprc': 0.6803621653504911, 'loss_val': 0.929270283434672, 'psi': 0.6952562682419428}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=41 head_norm_before_train=1.801798 cos_to_last_merge=0.9957 (last merge round=30)
[S14] round=41 local utility u=0.000000 metrics={'f1_val': 0.9964103030898727, 'auprc': 0.9988787425803447, 'loss_val': 0.03731042197881362, 'psi': 0.9973976788860615}-{'f1_val': 0.9970407855713329, 'auprc': 0.9985439297197455, 'loss_val': 0.039411223382188915, 'psi': 0.997642043230698}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=41 head_norm_before_train=2.017324 cos_to_last_merge=0.7536 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.754
[S15] round=41 local utility u=0.362910 metrics={'f1_val': 0.9951293408987237, 'auprc': 0.9959342476088988, 'loss_val': 0.032903341260550424, 'psi': 0.9954513035827938}-{'f1_val': 0.902305976265057, 'auprc': 0.9967309675361954, 'loss_val': 0.20417384102344005, 'psi': 0.9400759727735124}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=41 head_norm_before_train=1.629975 cos_to_last_merge=0.9356 (last merge round=20)
[S16] ⚠️ Model drifted since last merge! cos=0.936
[S16] round=41 local utility u=0.000000 metrics={'f1_val': 0.9919570424899109, 'auprc': 0.9903879226917823, 'loss_val': 0.05328038862909067, 'psi': 0.9913293945706594}-{'f1_val': 0.9926605645761105, 'auprc': 0.993922688392099, 'loss_val': 0.04724990035804298, 'psi': 0.9931654141025059}
[S17] START round=41 head_norm_before_train=1.952857 cos_to_last_merge=0.8095 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.810
[S17] round=41 local utility u=0.000000 metrics={'f1_val': 0.6040663181533539, 'auprc': 0.8048509860416753, 'loss_val': 1.2154875735452983, 'psi': 0.6843801853086824}-{'f1_val': 0.6236129575741167, 'auprc': 0.8565293188188066, 'loss_val': 1.0738499865541642, 'psi': 0.7167795020719927}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:58316
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:58308
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1800) from S8
[S7] cosine check vs S8: cos=0.9995
[S16] RECEIVED delta(kind=head bytes=1801) from S6
[S16] cosine check vs S6: cos=-0.0757
[S16] DROPPED delta from S6 (cos=-0.0757 < 0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=41 metric=0.9929 head_norm=1.800955
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.415145e-02
[S8] stored merged vector for next round verification (round=41)
[S8] DEBUG after merge:  round=41 metric=0.9925 head_norm=1.798384 delta_norm=0.024151
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=42 head_norm_before_train=1.721604 cos_to_last_merge=0.9591 (last merge round=28)
[S2] round=42 local utility u=1.000000 metrics={'f1_val': 0.8317799516996357, 'auprc': 0.9636051708372844, 'loss_val': 0.42348374656170035, 'psi': 0.8845100393546952}-{'f1_val': 0.6173003144453761, 'auprc': 0.7619552133183147, 'loss_val': 1.4531630263788844, 'psi': 0.6751622739945515}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=42 head_norm_before_train=2.093946 (no previous merge yet)
[S3] round=42 local utility u=0.000000 metrics={'f1_val': 0.963379253278021, 'auprc': 0.9986303038992257, 'loss_val': 0.08916741714924664, 'psi': 0.9774796735265028}-{'f1_val': 0.9740150500049245, 'auprc': 0.9983083584281106, 'loss_val': 0.06694829283016993, 'psi': 0.9837323733741989}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=42 head_norm_before_train=2.198806 cos_to_last_merge=0.9932 (last merge round=27)
[S4] round=42 local utility u=0.000000 metrics={'f1_val': 0.9397304136906776, 'auprc': 0.9166891981514387, 'loss_val': 0.34946578526171235, 'psi': 0.9305139274749821}-{'f1_val': 0.9405934445854656, 'auprc': 0.923002389446342, 'loss_val': 0.3205386725766097, 'psi': 0.9335570225298162}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=42 head_norm_before_train=1.426273 cos_to_last_merge=0.9938 (last merge round=30)
[S5] round=42 local utility u=0.000000 metrics={'f1_val': 0.6965700269656566, 'auprc': 0.8551726574404078, 'loss_val': 0.3909659083344524, 'psi': 0.7600110791555571}-{'f1_val': 0.9405388854813352, 'auprc': 0.9864806709817172, 'loss_val': 0.2117578130344195, 'psi': 0.958915599681488}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=42 head_norm_before_train=2.073266 (no previous merge yet)
[S6] round=42 local utility u=0.000000 metrics={'f1_val': 0.7180434564661939, 'auprc': 0.9515234616922741, 'loss_val': 0.7053007292126731, 'psi': 0.8114354585566259}-{'f1_val': 0.8213137324816339, 'auprc': 0.945678040671379, 'loss_val': 0.6267703788282841, 'psi': 0.871059455757532}
[S7] START round=42 head_norm_before_train=1.804348 cos_to_last_merge=0.9997 (last merge round=38)
[S7] round=42 local utility u=0.556700 metrics={'f1_val': 0.6775819149056412, 'auprc': 0.8290135327763748, 'loss_val': 0.37870097922717505, 'psi': 0.7381545620539347}-{'f1_val': 0.5732345740391449, 'auprc': 0.784476688157406, 'loss_val': 0.7324069079335476, 'psi': 0.6577314196864494}
[S8] START round=42 head_norm_before_train=1.798384 cos_to_last_merge=1.0000 (last merge round=41)
[S8] round=42 local utility u=0.000000 metrics={'f1_val': 0.9885656966123193, 'auprc': 0.9972917443276106, 'loss_val': 0.0412387355514538, 'psi': 0.9920561156984358}-{'f1_val': 0.9929047892228047, 'auprc': 0.9906567400049053, 'loss_val': 0.039424225999359346, 'psi': 0.992005569535645}
[S9] START round=42 head_norm_before_train=1.768223 cos_to_last_merge=0.9741 (last merge round=21)
[S9] round=42 local utility u=0.019835 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9979427361559925, 'loss_val': 0.02737257358657103, 'psi': 0.9969271513299636}-{'f1_val': 0.9912237657809659, 'auprc': 0.997783319942373, 'loss_val': 0.03640628528760346, 'psi': 0.9938475874455287}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=42 head_norm_before_train=2.196326 (no previous merge yet)
[S10] round=42 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9964190083964883, 'loss_val': 0.02502922950036735, 'psi': 0.9955485152776411}-{'f1_val': 0.9951704237150173, 'auprc': 0.9966673337837869, 'loss_val': 0.025014375444101518, 'psi': 0.9957691877425251}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=42 head_norm_before_train=2.293272 cos_to_last_merge=0.9982 (last merge round=29)
[S11] round=42 local utility u=0.000000 metrics={'f1_val': 0.9919504291303748, 'auprc': 0.9988269368510765, 'loss_val': 0.0330220226824205, 'psi': 0.9947010322186555}-{'f1_val': 0.9967460138064482, 'auprc': 0.9985693611312434, 'loss_val': 0.019734116634987923, 'psi': 0.9974753527363663}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=42 head_norm_before_train=1.958435 (no previous merge yet)
[S13] round=42 local utility u=0.000000 metrics={'f1_val': 0.6331417519319839, 'auprc': 0.7252082625192581, 'loss_val': 1.0019847406561229, 'psi': 0.6699683561668935}-{'f1_val': 0.615977088507707, 'auprc': 0.7378316253583113, 'loss_val': 0.9221348695310961, 'psi': 0.6647189032479488}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=42 head_norm_before_train=1.816684 cos_to_last_merge=0.9950 (last merge round=30)
[S14] round=42 local utility u=0.001007 metrics={'f1_val': 0.9965603779504312, 'auprc': 0.9989809788055071, 'loss_val': 0.03650323062494796, 'psi': 0.9975286182924615}-{'f1_val': 0.9964103030898727, 'auprc': 0.9988787425803447, 'loss_val': 0.03731042197881362, 'psi': 0.9973976788860615}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=42 head_norm_before_train=2.028327 cos_to_last_merge=0.7528 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.753
[S15] round=42 local utility u=0.000000 metrics={'f1_val': 0.9291987424451005, 'auprc': 0.9934323732869279, 'loss_val': 0.09260329338291433, 'psi': 0.9548921947818314}-{'f1_val': 0.9951293408987237, 'auprc': 0.9959342476088988, 'loss_val': 0.032903341260550424, 'psi': 0.9954513035827938}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=42 head_norm_before_train=1.641344 cos_to_last_merge=0.9342 (last merge round=20)
[S16] ⚠️ Model drifted since last merge! cos=0.934
[S16] round=42 local utility u=0.009898 metrics={'f1_val': 0.9923904770455448, 'auprc': 0.9936066130678218, 'loss_val': 0.04574106993687668, 'psi': 0.9928769314544557}-{'f1_val': 0.9919570424899109, 'auprc': 0.9903879226917823, 'loss_val': 0.05328038862909067, 'psi': 0.9913293945706594}
[S17] START round=42 head_norm_before_train=1.964089 cos_to_last_merge=0.8091 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.809
[S17] round=42 local utility u=0.235416 metrics={'f1_val': 0.6206153950739368, 'auprc': 0.8983591595689433, 'loss_val': 1.1244747208737416, 'psi': 0.7317129008719394}-{'f1_val': 0.6040663181533539, 'auprc': 0.8048509860416753, 'loss_val': 1.2154875735452983, 'psi': 0.6843801853086824}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:58309
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:58307
[S7] sending update (kind=head size=1804 to 1 peers)
[S16] sending update (kind=head size=1803 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1804) from S7
[S8] cosine check vs S7: cos=0.9997
[S6] RECEIVED delta(kind=head bytes=1803) from S16
[S6] cosine check vs S16: cos=-0.0764
[S6] DROPPED delta from S16 (cos=-0.0764 < 0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=42 metric=0.6776 head_norm=1.811816
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.176077e-02
[S7] stored merged vector for next round verification (round=42)
[S7] DEBUG after merge:  round=42 metric=0.6760 head_norm=1.806114 delta_norm=0.031761
[S7] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=43 head_norm_before_train=1.733747 cos_to_last_merge=0.9579 (last merge round=28)
[S2] round=43 local utility u=0.000000 metrics={'f1_val': 0.8361348641468329, 'auprc': 0.8902529669120531, 'loss_val': 0.37091743141485356, 'psi': 0.857782105252921}-{'f1_val': 0.8317799516996357, 'auprc': 0.9636051708372844, 'loss_val': 0.42348374656170035, 'psi': 0.8845100393546952}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=43 head_norm_before_train=2.103443 (no previous merge yet)
[S3] round=43 local utility u=0.120619 metrics={'f1_val': 0.9954616546126973, 'auprc': 0.9984550630822179, 'loss_val': 0.03989875168828125, 'psi': 0.9966590180005055}-{'f1_val': 0.963379253278021, 'auprc': 0.9986303038992257, 'loss_val': 0.08916741714924664, 'psi': 0.9774796735265028}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=43 head_norm_before_train=2.199109 cos_to_last_merge=0.9918 (last merge round=27)
[S4] round=43 local utility u=0.072135 metrics={'f1_val': 0.94590185990095, 'auprc': 0.9392646578004571, 'loss_val': 0.3099511918106942, 'psi': 0.9432469790607528}-{'f1_val': 0.9397304136906776, 'auprc': 0.9166891981514387, 'loss_val': 0.34946578526171235, 'psi': 0.9305139274749821}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=43 head_norm_before_train=1.431815 cos_to_last_merge=0.9936 (last merge round=30)
[S5] round=43 local utility u=1.000000 metrics={'f1_val': 0.9968035574397306, 'auprc': 0.9959562633558989, 'loss_val': 0.1420326097562641, 'psi': 0.9964646398061978}-{'f1_val': 0.6965700269656566, 'auprc': 0.8551726574404078, 'loss_val': 0.3909659083344524, 'psi': 0.7600110791555571}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=43 head_norm_before_train=2.080667 (no previous merge yet)
[S6] round=43 local utility u=0.152824 metrics={'f1_val': 0.7703457112726313, 'auprc': 0.9623940897370137, 'loss_val': 0.7460789156997866, 'psi': 0.8471650626583842}-{'f1_val': 0.7180434564661939, 'auprc': 0.9515234616922741, 'loss_val': 0.7053007292126731, 'psi': 0.8114354585566259}
[S7] START round=43 head_norm_before_train=1.806114 cos_to_last_merge=1.0000 (last merge round=42)
[S7] round=43 local utility u=0.000000 metrics={'f1_val': 0.6111247934000668, 'auprc': 0.7895677568646694, 'loss_val': 0.5932429844168299, 'psi': 0.6825019787859079}-{'f1_val': 0.6775819149056412, 'auprc': 0.8290135327763748, 'loss_val': 0.37870097922717505, 'psi': 0.7381545620539347}
[S8] START round=43 head_norm_before_train=1.809154 cos_to_last_merge=1.0000 (last merge round=41)
[S8] round=43 local utility u=0.018822 metrics={'f1_val': 0.9925712794554754, 'auprc': 0.9992898812117168, 'loss_val': 0.033623510314325006, 'psi': 0.9952587201579719}-{'f1_val': 0.9885656966123193, 'auprc': 0.9972917443276106, 'loss_val': 0.0412387355514538, 'psi': 0.9920561156984358}
[S9] START round=43 head_norm_before_train=1.774233 cos_to_last_merge=0.9736 (last merge round=21)
[S9] round=43 local utility u=0.000000 metrics={'f1_val': 0.9954158325366191, 'auprc': 0.9978639938441187, 'loss_val': 0.02635031991825104, 'psi': 0.9963950970596189}-{'f1_val': 0.9962500947792776, 'auprc': 0.9979427361559925, 'loss_val': 0.02737257358657103, 'psi': 0.9969271513299636}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=43 head_norm_before_train=2.204993 (no previous merge yet)
[S10] round=43 local utility u=0.001564 metrics={'f1_val': 0.9951704237150173, 'auprc': 0.9970661207972448, 'loss_val': 0.02505627248819962, 'psi': 0.9959287025479082}-{'f1_val': 0.9949681865317428, 'auprc': 0.9964190083964883, 'loss_val': 0.02502922950036735, 'psi': 0.9955485152776411}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=43 head_norm_before_train=2.301913 cos_to_last_merge=0.9980 (last merge round=29)
[S11] round=43 local utility u=0.021416 metrics={'f1_val': 0.9966782942738902, 'auprc': 0.9989230525998427, 'loss_val': 0.018845561509089354, 'psi': 0.9975761976042712}-{'f1_val': 0.9919504291303748, 'auprc': 0.9988269368510765, 'loss_val': 0.0330220226824205, 'psi': 0.9947010322186555}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=43 head_norm_before_train=1.958732 (no previous merge yet)
[S13] round=43 local utility u=0.342255 metrics={'f1_val': 0.7260552609977053, 'auprc': 0.7269454334670057, 'loss_val': 0.880168228617913, 'psi': 0.7264113299854255}-{'f1_val': 0.6331417519319839, 'auprc': 0.7252082625192581, 'loss_val': 1.0019847406561229, 'psi': 0.6699683561668935}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=43 head_norm_before_train=1.829676 cos_to_last_merge=0.9943 (last merge round=30)
[S14] round=43 local utility u=0.003309 metrics={'f1_val': 0.9970665706119299, 'auprc': 0.9987463448714393, 'loss_val': 0.032218670711430634, 'psi': 0.9977384803157336}-{'f1_val': 0.9965603779504312, 'auprc': 0.9989809788055071, 'loss_val': 0.03650323062494796, 'psi': 0.9975286182924615}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=43 head_norm_before_train=2.039526 cos_to_last_merge=0.7519 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.752
[S15] round=43 local utility u=0.000000 metrics={'f1_val': 0.8901087584558139, 'auprc': 0.9964370069160167, 'loss_val': 0.3329669039564393, 'psi': 0.932640057839895}-{'f1_val': 0.9291987424451005, 'auprc': 0.9934323732869279, 'loss_val': 0.09260329338291433, 'psi': 0.9548921947818314}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=43 head_norm_before_train=1.653088 cos_to_last_merge=0.9329 (last merge round=20)
[S16] ⚠️ Model drifted since last merge! cos=0.933
[S16] round=43 local utility u=0.000000 metrics={'f1_val': 0.992094582938667, 'auprc': 0.9921227819346936, 'loss_val': 0.046242644573631975, 'psi': 0.9921058625370777}-{'f1_val': 0.9923904770455448, 'auprc': 0.9936066130678218, 'loss_val': 0.04574106993687668, 'psi': 0.9928769314544557}
[S17] START round=43 head_norm_before_train=1.977782 cos_to_last_merge=0.8086 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.809
[S17] round=43 local utility u=0.000000 metrics={'f1_val': 0.6078354080088648, 'auprc': 0.7924799740493876, 'loss_val': 1.2326257863092929, 'psi': 0.6816932344250739}-{'f1_val': 0.6206153950739368, 'auprc': 0.8983591595689433, 'loss_val': 1.1244747208737416, 'psi': 0.7317129008719394}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:58316
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S8] → sending delta(kind=head bytes=1808) to S7@127.0.0.1:58308
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1808 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1808) from S8
[S7] cosine check vs S8: cos=0.9998
[S16] RECEIVED delta(kind=head bytes=1797) from S6
[S16] cosine check vs S6: cos=-0.0761
[S16] DROPPED delta from S6 (cos=-0.0761 < 0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=43 metric=0.9926 head_norm=1.819046
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.621582e-02
[S8] stored merged vector for next round verification (round=43)
[S8] DEBUG after merge:  round=43 metric=0.9926 head_norm=1.815245 delta_norm=0.026216
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=44 head_norm_before_train=1.749787 cos_to_last_merge=0.9563 (last merge round=28)
[S2] round=44 local utility u=0.067979 metrics={'f1_val': 0.8330711564310884, 'auprc': 0.9594906949492943, 'loss_val': 0.4242897431736321, 'psi': 0.8836389718383708}-{'f1_val': 0.8361348641468329, 'auprc': 0.8902529669120531, 'loss_val': 0.37091743141485356, 'psi': 0.857782105252921}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=44 head_norm_before_train=2.113957 (no previous merge yet)
[S3] round=44 local utility u=0.000000 metrics={'f1_val': 0.8859016147649097, 'auprc': 0.9980234257806828, 'loss_val': 0.2340663029491376, 'psi': 0.9307503391712189}-{'f1_val': 0.9954616546126973, 'auprc': 0.9984550630822179, 'loss_val': 0.03989875168828125, 'psi': 0.9966590180005055}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=44 head_norm_before_train=2.211744 cos_to_last_merge=0.9913 (last merge round=27)
[S4] round=44 local utility u=0.000000 metrics={'f1_val': 0.9409265162267816, 'auprc': 0.9300810127174161, 'loss_val': 0.3216515599424084, 'psi': 0.9365883148230354}-{'f1_val': 0.94590185990095, 'auprc': 0.9392646578004571, 'loss_val': 0.3099511918106942, 'psi': 0.9432469790607528}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=44 head_norm_before_train=1.436097 cos_to_last_merge=0.9932 (last merge round=30)
[S5] round=44 local utility u=0.000000 metrics={'f1_val': 0.6637990824927196, 'auprc': 0.8467108186853448, 'loss_val': 0.46629854409082433, 'psi': 0.7369637769697697}-{'f1_val': 0.9968035574397306, 'auprc': 0.9959562633558989, 'loss_val': 0.1420326097562641, 'psi': 0.9964646398061978}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=44 head_norm_before_train=2.086917 (no previous merge yet)
[S6] round=44 local utility u=0.251990 metrics={'f1_val': 0.8211054372881351, 'auprc': 0.9619325329127498, 'loss_val': 0.5452722762413289, 'psi': 0.877436275537981}-{'f1_val': 0.7703457112726313, 'auprc': 0.9623940897370137, 'loss_val': 0.7460789156997866, 'psi': 0.8471650626583842}
[S7] START round=44 head_norm_before_train=1.813835 cos_to_last_merge=1.0000 (last merge round=42)
[S7] round=44 local utility u=0.000000 metrics={'f1_val': 0.6057459095957161, 'auprc': 0.7890599275182023, 'loss_val': 0.6170526884640961, 'psi': 0.6790715167647106}-{'f1_val': 0.6111247934000668, 'auprc': 0.7895677568646694, 'loss_val': 0.5932429844168299, 'psi': 0.6825019787859079}
[S8] START round=44 head_norm_before_train=1.815245 cos_to_last_merge=1.0000 (last merge round=43)
[S8] round=44 local utility u=0.000000 metrics={'f1_val': 0.9760264943531065, 'auprc': 0.9967811146784861, 'loss_val': 0.0662371807801305, 'psi': 0.9843283424832583}-{'f1_val': 0.9925712794554754, 'auprc': 0.9992898812117168, 'loss_val': 0.033623510314325006, 'psi': 0.9952587201579719}
[S9] START round=44 head_norm_before_train=1.781520 cos_to_last_merge=0.9729 (last merge round=21)
[S9] round=44 local utility u=0.000000 metrics={'f1_val': 0.9871765865591023, 'auprc': 0.9976114959949884, 'loss_val': 0.051709991451677095, 'psi': 0.9913505503334568}-{'f1_val': 0.9954158325366191, 'auprc': 0.9978639938441187, 'loss_val': 0.02635031991825104, 'psi': 0.9963950970596189}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=44 head_norm_before_train=2.209307 (no previous merge yet)
[S10] round=44 local utility u=0.000952 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9980415911957257, 'loss_val': 0.024864263345746734, 'psi': 0.996197548397336}-{'f1_val': 0.9951704237150173, 'auprc': 0.9970661207972448, 'loss_val': 0.02505627248819962, 'psi': 0.9959287025479082}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=44 head_norm_before_train=2.308277 cos_to_last_merge=0.9979 (last merge round=29)
[S11] round=44 local utility u=0.003498 metrics={'f1_val': 0.9974011907167429, 'auprc': 0.9989226537254565, 'loss_val': 0.016186009142846874, 'psi': 0.9980097759202284}-{'f1_val': 0.9966782942738902, 'auprc': 0.9989230525998427, 'loss_val': 0.018845561509089354, 'psi': 0.9975761976042712}
[S11] not sending this round → trigger blocked (psi=0.998)
[S13] START round=44 head_norm_before_train=1.961080 (no previous merge yet)
[S13] round=44 local utility u=0.028121 metrics={'f1_val': 0.6960462058081496, 'auprc': 0.7511082745874869, 'loss_val': 0.7163596466779253, 'psi': 0.7180710333198845}-{'f1_val': 0.7260552609977053, 'auprc': 0.7269454334670057, 'loss_val': 0.880168228617913, 'psi': 0.7264113299854255}
[S13] not sending this round → trigger blocked (psi=0.718)
[S14] START round=44 head_norm_before_train=1.840169 cos_to_last_merge=0.9938 (last merge round=30)
[S14] round=44 local utility u=0.000000 metrics={'f1_val': 0.9963934278649259, 'auprc': 0.9981418181333788, 'loss_val': 0.03449223693601782, 'psi': 0.9970927839723072}-{'f1_val': 0.9970665706119299, 'auprc': 0.9987463448714393, 'loss_val': 0.032218670711430634, 'psi': 0.9977384803157336}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=44 head_norm_before_train=2.047279 cos_to_last_merge=0.7516 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.752
[S15] round=44 local utility u=0.329295 metrics={'f1_val': 0.9571746326116914, 'auprc': 0.9936696694521732, 'loss_val': 0.06847087247513048, 'psi': 0.9717726473478842}-{'f1_val': 0.8901087584558139, 'auprc': 0.9964370069160167, 'loss_val': 0.3329669039564393, 'psi': 0.932640057839895}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=44 head_norm_before_train=1.665843 cos_to_last_merge=0.9315 (last merge round=20)
[S16] ⚠️ Model drifted since last merge! cos=0.932
[S16] round=44 local utility u=0.008151 metrics={'f1_val': 0.9923839220173097, 'auprc': 0.9962380293965951, 'loss_val': 0.0440223164797038, 'psi': 0.993925564969024}-{'f1_val': 0.992094582938667, 'auprc': 0.9921227819346936, 'loss_val': 0.046242644573631975, 'psi': 0.9921058625370777}
[S17] START round=44 head_norm_before_train=1.990551 cos_to_last_merge=0.8081 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.808
[S17] round=44 local utility u=0.525386 metrics={'f1_val': 0.6618027874446802, 'auprc': 0.9540889487155456, 'loss_val': 0.990484710609498, 'psi': 0.7787172519530264}-{'f1_val': 0.6078354080088648, 'auprc': 0.7924799740493876, 'loss_val': 1.2326257863092929, 'psi': 0.6816932344250739}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.877)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:58307
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=44 metric=0.6057 head_norm=1.821825
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.018436e-02
[S7] stored merged vector for next round verification (round=44)
[S7] DEBUG after merge:  round=44 metric=0.6038 head_norm=1.820324 delta_norm=0.020184
[S7] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S16] sending update (kind=head size=1799 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1799) from S16
[S6] cosine check vs S16: cos=-0.0766
[S6] DROPPED delta from S16 (cos=-0.0766 < 0.0)
[S2] START round=45 head_norm_before_train=1.764209 cos_to_last_merge=0.9550 (last merge round=28)
[S2] round=45 local utility u=0.000000 metrics={'f1_val': 0.7815723414190621, 'auprc': 0.8102267793084263, 'loss_val': 0.5890477637679578, 'psi': 0.7930341165748078}-{'f1_val': 0.8330711564310884, 'auprc': 0.9594906949492943, 'loss_val': 0.4242897431736321, 'psi': 0.8836389718383708}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=45 head_norm_before_train=2.122849 (no previous merge yet)
[S3] round=45 local utility u=0.414201 metrics={'f1_val': 0.991773519076316, 'auprc': 0.9984498286883011, 'loss_val': 0.04217592753185553, 'psi': 0.99444404292111}-{'f1_val': 0.8859016147649097, 'auprc': 0.9980234257806828, 'loss_val': 0.2340663029491376, 'psi': 0.9307503391712189}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] sending update (kind=head size=1804 to 1 peers)
[S4] START round=45 head_norm_before_train=2.223365 cos_to_last_merge=0.9903 (last merge round=27)
[S4] round=45 local utility u=0.000000 metrics={'f1_val': 0.939492346985432, 'auprc': 0.9287921548600298, 'loss_val': 0.329424729346913, 'psi': 0.9352122701352711}-{'f1_val': 0.9409265162267816, 'auprc': 0.9300810127174161, 'loss_val': 0.3216515599424084, 'psi': 0.9365883148230354}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=45 head_norm_before_train=1.440307 cos_to_last_merge=0.9930 (last merge round=30)
[S5] round=45 local utility u=1.000000 metrics={'f1_val': 0.9968483267439869, 'auprc': 0.996713203627567, 'loss_val': 0.13738331290963882, 'psi': 0.996794277497419}-{'f1_val': 0.6637990824927196, 'auprc': 0.8467108186853448, 'loss_val': 0.46629854409082433, 'psi': 0.7369637769697697}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=45 head_norm_before_train=2.094760 (no previous merge yet)
[S6] round=45 local utility u=0.000000 metrics={'f1_val': 0.7660391377902486, 'auprc': 0.9291362557015617, 'loss_val': 0.7500703083614767, 'psi': 0.8312779849547738}-{'f1_val': 0.8211054372881351, 'auprc': 0.9619325329127498, 'loss_val': 0.5452722762413289, 'psi': 0.877436275537981}
[S7] START round=45 head_norm_before_train=1.820324 cos_to_last_merge=1.0000 (last merge round=44)
[S7] round=45 local utility u=0.147125 metrics={'f1_val': 0.6378208076122223, 'auprc': 0.7942734258344547, 'loss_val': 0.5308927455441894, 'psi': 0.7004018549011153}-{'f1_val': 0.6057459095957161, 'auprc': 0.7890599275182023, 'loss_val': 0.6170526884640961, 'psi': 0.6790715167647106}
[S8] START round=45 head_norm_before_train=1.825178 cos_to_last_merge=1.0000 (last merge round=43)
[S8] round=45 local utility u=0.000000 metrics={'f1_val': 0.9472234970681722, 'auprc': 0.992974146295985, 'loss_val': 0.14139188052098173, 'psi': 0.9655237567592974}-{'f1_val': 0.9760264943531065, 'auprc': 0.9967811146784861, 'loss_val': 0.0662371807801305, 'psi': 0.9843283424832583}
[S9] START round=45 head_norm_before_train=1.789437 cos_to_last_merge=0.9722 (last merge round=21)
[S9] round=45 local utility u=0.010714 metrics={'f1_val': 0.9895530216146718, 'auprc': 0.9976536925780055, 'loss_val': 0.04466777755207066, 'psi': 0.9927932900000053}-{'f1_val': 0.9871765865591023, 'auprc': 0.9976114959949884, 'loss_val': 0.051709991451677095, 'psi': 0.9913505503334568}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=45 head_norm_before_train=2.213503 (no previous merge yet)
[S10] round=45 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9981580353943931, 'loss_val': 0.024951134469846394, 'psi': 0.9961123796893807}-{'f1_val': 0.9949681865317428, 'auprc': 0.9980415911957257, 'loss_val': 0.024864263345746734, 'psi': 0.996197548397336}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=45 head_norm_before_train=2.315389 cos_to_last_merge=0.9977 (last merge round=29)
[S11] round=45 local utility u=0.000000 metrics={'f1_val': 0.9904140030083828, 'auprc': 0.9994159022353606, 'loss_val': 0.053925697178511915, 'psi': 0.994014762699174}-{'f1_val': 0.9974011907167429, 'auprc': 0.9989226537254565, 'loss_val': 0.016186009142846874, 'psi': 0.9980097759202284}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=45 head_norm_before_train=1.971287 (no previous merge yet)
[S13] round=45 local utility u=0.000000 metrics={'f1_val': 0.6157803376166628, 'auprc': 0.672575577802221, 'loss_val': 1.0903267741851814, 'psi': 0.6384984336908861}-{'f1_val': 0.6960462058081496, 'auprc': 0.7511082745874869, 'loss_val': 0.7163596466779253, 'psi': 0.7180710333198845}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=45 head_norm_before_train=1.847543 cos_to_last_merge=0.9934 (last merge round=30)
[S14] round=45 local utility u=0.005097 metrics={'f1_val': 0.9970665706119299, 'auprc': 0.9991773905939036, 'loss_val': 0.03144371042557756, 'psi': 0.9979108986047194}-{'f1_val': 0.9963934278649259, 'auprc': 0.9981418181333788, 'loss_val': 0.03449223693601782, 'psi': 0.9970927839723072}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] sending update (kind=head size=1805 to 1 peers)
[S15] START round=45 head_norm_before_train=2.054790 cos_to_last_merge=0.7508 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.751
[S15] round=45 local utility u=0.129824 metrics={'f1_val': 0.9922003145665506, 'auprc': 0.9987301778384794, 'loss_val': 0.034159329763356096, 'psi': 0.9948122598753221}-{'f1_val': 0.9571746326116914, 'auprc': 0.9936696694521732, 'loss_val': 0.06847087247513048, 'psi': 0.9717726473478842}
[S15] not sending this round → trigger blocked (psi=0.995)
[S16] START round=45 head_norm_before_train=1.677992 cos_to_last_merge=0.9302 (last merge round=20)
[S16] ⚠️ Model drifted since last merge! cos=0.930
[S16] round=45 local utility u=0.000000 metrics={'f1_val': 0.9460139288895909, 'auprc': 0.9895065267712342, 'loss_val': 0.1465692909479105, 'psi': 0.9634109680422482}-{'f1_val': 0.9923839220173097, 'auprc': 0.9962380293965951, 'loss_val': 0.0440223164797038, 'psi': 0.993925564969024}
[S17] START round=45 head_norm_before_train=2.003369 cos_to_last_merge=0.8076 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.808
[S17] round=45 local utility u=0.000000 metrics={'f1_val': 0.6631492216722523, 'auprc': 0.8704026939102893, 'loss_val': 1.070856415525422, 'psi': 0.7460506105674671}-{'f1_val': 0.6618027874446802, 'auprc': 0.9540889487155456, 'loss_val': 0.990484710609498, 'psi': 0.7787172519530264}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:58309
[S7] sending update (kind=head size=1803 to 1 peers)
[S16] ⇄ pheromone p=0.073 → S6@127.0.0.1:58307
[S8] ⇄ pheromone p=0.033 → S7@127.0.0.1:58308
[S6] ⇄ pheromone p=0.232 → S16@127.0.0.1:58316
[S8] RECEIVED delta(kind=head bytes=1803) from S7
[S8] cosine check vs S7: cos=0.9999
[S7] ⇄ pheromone p=0.151 → S8@127.0.0.1:58309
[S2] START round=46 head_norm_before_train=1.775881 cos_to_last_merge=0.9539 (last merge round=28)
[S2] round=46 local utility u=0.365017 metrics={'f1_val': 0.8396542129551812, 'auprc': 0.8527051138732287, 'loss_val': 0.33493924285120347, 'psi': 0.8448745733224001}-{'f1_val': 0.7815723414190621, 'auprc': 0.8102267793084263, 'loss_val': 0.5890477637679578, 'psi': 0.7930341165748078}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=46 head_norm_before_train=2.132540 (no previous merge yet)
[S3] round=46 local utility u=0.000000 metrics={'f1_val': 0.9805778274355272, 'auprc': 0.9981305088432693, 'loss_val': 0.045896453933151664, 'psi': 0.987598899998624}-{'f1_val': 0.991773519076316, 'auprc': 0.9984498286883011, 'loss_val': 0.04217592753185553, 'psi': 0.99444404292111}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=46 head_norm_before_train=2.225039 cos_to_last_merge=0.9891 (last merge round=27)
[S4] round=46 local utility u=0.046976 metrics={'f1_val': 0.941785787186308, 'auprc': 0.9540602067203057, 'loss_val': 0.3250373086941424, 'psi': 0.9466955549999071}-{'f1_val': 0.939492346985432, 'auprc': 0.9287921548600298, 'loss_val': 0.329424729346913, 'psi': 0.9352122701352711}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=46 head_norm_before_train=1.445004 cos_to_last_merge=0.9928 (last merge round=30)
[S5] round=46 local utility u=0.000000 metrics={'f1_val': 0.5174554417703775, 'auprc': 0.7773620360822073, 'loss_val': 0.7376549903196353, 'psi': 0.6214180794951094}-{'f1_val': 0.9968483267439869, 'auprc': 0.996713203627567, 'loss_val': 0.13738331290963882, 'psi': 0.996794277497419}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=46 head_norm_before_train=2.105651 (no previous merge yet)
[S6] round=46 local utility u=0.229816 metrics={'f1_val': 0.7910406388832023, 'auprc': 0.9617378627076756, 'loss_val': 0.5382517528050532, 'psi': 0.8593195284129915}-{'f1_val': 0.7660391377902486, 'auprc': 0.9291362557015617, 'loss_val': 0.7500703083614767, 'psi': 0.8312779849547738}
[S7] START round=46 head_norm_before_train=1.828251 cos_to_last_merge=1.0000 (last merge round=44)
[S7] round=46 local utility u=0.000000 metrics={'f1_val': 0.603007366080677, 'auprc': 0.7899671715407978, 'loss_val': 0.6413278234514459, 'psi': 0.6777912882647252}-{'f1_val': 0.6378208076122223, 'auprc': 0.7942734258344547, 'loss_val': 0.5308927455441894, 'psi': 0.7004018549011153}
[S8] START round=46 head_norm_before_train=1.836957 cos_to_last_merge=0.9999 (last merge round=43)
[S8] round=46 local utility u=0.200863 metrics={'f1_val': 0.9930017911527874, 'auprc': 0.9992201181307971, 'loss_val': 0.03307366834044634, 'psi': 0.9954891219439913}-{'f1_val': 0.9472234970681722, 'auprc': 0.992974146295985, 'loss_val': 0.14139188052098173, 'psi': 0.9655237567592974}
[S9] START round=46 head_norm_before_train=1.798143 cos_to_last_merge=0.9714 (last merge round=21)
[S9] round=46 local utility u=0.021350 metrics={'f1_val': 0.9941897064172326, 'auprc': 0.9978188000752619, 'loss_val': 0.03028306762862283, 'psi': 0.9956413438804443}-{'f1_val': 0.9895530216146718, 'auprc': 0.9976536925780055, 'loss_val': 0.04466777755207066, 'psi': 0.9927932900000053}
[S9] not sending this round → trigger blocked (psi=0.996)
[S10] START round=46 head_norm_before_train=2.219190 (no previous merge yet)
[S10] round=46 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9981300373960624, 'loss_val': 0.025022374120770057, 'psi': 0.9961011804900485}-{'f1_val': 0.9947486092193725, 'auprc': 0.9981580353943931, 'loss_val': 0.024951134469846394, 'psi': 0.9961123796893807}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=46 head_norm_before_train=2.323206 cos_to_last_merge=0.9975 (last merge round=29)
[S11] round=46 local utility u=0.013894 metrics={'f1_val': 0.9923190009405097, 'auprc': 0.9993834632088263, 'loss_val': 0.037470961356170444, 'psi': 0.9951447858478364}-{'f1_val': 0.9904140030083828, 'auprc': 0.9994159022353606, 'loss_val': 0.053925697178511915, 'psi': 0.994014762699174}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=46 head_norm_before_train=1.977474 (no previous merge yet)
[S13] round=46 local utility u=0.594210 metrics={'f1_val': 0.74971350390291, 'auprc': 0.7125897741022726, 'loss_val': 0.8255485577003379, 'psi': 0.734864011982655}-{'f1_val': 0.6157803376166628, 'auprc': 0.672575577802221, 'loss_val': 1.0903267741851814, 'psi': 0.6384984336908861}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=46 head_norm_before_train=1.852585 cos_to_last_merge=0.9930 (last merge round=30)
[S14] round=46 local utility u=0.000000 metrics={'f1_val': 0.9970441294227608, 'auprc': 0.998736155326726, 'loss_val': 0.030336294077010252, 'psi': 0.9977209397843468}-{'f1_val': 0.9970665706119299, 'auprc': 0.9991773905939036, 'loss_val': 0.03144371042557756, 'psi': 0.9979108986047194}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=46 head_norm_before_train=2.063855 cos_to_last_merge=0.7504 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.750
[S15] round=46 local utility u=0.000000 metrics={'f1_val': 0.9014525766685394, 'auprc': 0.996763065438059, 'loss_val': 0.3006792711389293, 'psi': 0.9395767721763473}-{'f1_val': 0.9922003145665506, 'auprc': 0.9987301778384794, 'loss_val': 0.034159329763356096, 'psi': 0.9948122598753221}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=46 head_norm_before_train=1.689912 cos_to_last_merge=0.9290 (last merge round=20)
[S16] ⚠️ Model drifted since last merge! cos=0.929
[S16] round=46 local utility u=0.203612 metrics={'f1_val': 0.9923904770455448, 'auprc': 0.9978093168514183, 'loss_val': 0.042513750760116875, 'psi': 0.9945580129678941}-{'f1_val': 0.9460139288895909, 'auprc': 0.9895065267712342, 'loss_val': 0.1465692909479105, 'psi': 0.9634109680422482}
[S17] START round=46 head_norm_before_train=2.013553 cos_to_last_merge=0.8073 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.807
[S17] round=46 local utility u=0.000000 metrics={'f1_val': 0.584381781253221, 'auprc': 0.7789766883308081, 'loss_val': 1.2956414445391273, 'psi': 0.6622197440842559}-{'f1_val': 0.6631492216722523, 'auprc': 0.8704026939102893, 'loss_val': 1.070856415525422, 'psi': 0.7460506105674671}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:58307
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:58308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:58316
[S6] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1804 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1804) from S8
[S7] cosine check vs S8: cos=0.9996
[S16] RECEIVED delta(kind=head bytes=1800) from S6
[S16] cosine check vs S6: cos=-0.0814
[S16] DROPPED delta from S6 (cos=-0.0814 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1801) from S16
[S6] cosine check vs S16: cos=-0.0814
[S6] DROPPED delta from S16 (cos=-0.0814 < 0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=46 metric=0.9930 head_norm=1.842690
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.768184e-02
[S8] stored merged vector for next round verification (round=46)
[S8] DEBUG after merge:  round=46 metric=0.9930 head_norm=1.835276 delta_norm=0.027682
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=47 head_norm_before_train=1.788248 cos_to_last_merge=0.9530 (last merge round=28)
[S2] round=47 local utility u=0.145109 metrics={'f1_val': 0.8321946164594882, 'auprc': 0.9926061969563625, 'loss_val': 0.4196677462424083, 'psi': 0.8963592486582379}-{'f1_val': 0.8396542129551812, 'auprc': 0.8527051138732287, 'loss_val': 0.33493924285120347, 'psi': 0.8448745733224001}
[S2] not sending this round → trigger blocked (psi=0.896)
[S3] START round=47 head_norm_before_train=2.142273 (no previous merge yet)
[S3] round=47 local utility u=0.000000 metrics={'f1_val': 0.7813974414229694, 'auprc': 0.9981800088702969, 'loss_val': 0.4015261358916566, 'psi': 0.8681104684019003}-{'f1_val': 0.9805778274355272, 'auprc': 0.9981305088432693, 'loss_val': 0.045896453933151664, 'psi': 0.987598899998624}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=47 head_norm_before_train=2.235229 cos_to_last_merge=0.9887 (last merge round=27)
[S4] round=47 local utility u=0.000000 metrics={'f1_val': 0.9398106466532872, 'auprc': 0.9333913646466057, 'loss_val': 0.3211964415790704, 'psi': 0.9372429338506146}-{'f1_val': 0.941785787186308, 'auprc': 0.9540602067203057, 'loss_val': 0.3250373086941424, 'psi': 0.9466955549999071}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=47 head_norm_before_train=1.448879 cos_to_last_merge=0.9926 (last merge round=30)
[S5] round=47 local utility u=1.000000 metrics={'f1_val': 0.996731224857049, 'auprc': 0.9973513978231813, 'loss_val': 0.13898740192164108, 'psi': 0.9969792940435019}-{'f1_val': 0.5174554417703775, 'auprc': 0.7773620360822073, 'loss_val': 0.7376549903196353, 'psi': 0.6214180794951094}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=47 head_norm_before_train=2.124836 (no previous merge yet)
[S6] round=47 local utility u=0.000000 metrics={'f1_val': 0.5976077042808184, 'auprc': 0.720471409418355, 'loss_val': 1.4524119846707566, 'psi': 0.646753186335833}-{'f1_val': 0.7910406388832023, 'auprc': 0.9617378627076756, 'loss_val': 0.5382517528050532, 'psi': 0.8593195284129915}
[S7] START round=47 head_norm_before_train=1.836367 cos_to_last_merge=0.9999 (last merge round=44)
[S7] round=47 local utility u=0.045304 metrics={'f1_val': 0.6228701663753299, 'auprc': 0.7895011613748036, 'loss_val': 0.6684986996016368, 'psi': 0.6895225643751195}-{'f1_val': 0.603007366080677, 'auprc': 0.7899671715407978, 'loss_val': 0.6413278234514459, 'psi': 0.6777912882647252}
[S8] START round=47 head_norm_before_train=1.835276 cos_to_last_merge=1.0000 (last merge round=46)
[S8] round=47 local utility u=0.000000 metrics={'f1_val': 0.9545849738990665, 'auprc': 0.9930124421602871, 'loss_val': 0.12900801248616706, 'psi': 0.9699559612035547}-{'f1_val': 0.9930017911527874, 'auprc': 0.9992201181307971, 'loss_val': 0.03307366834044634, 'psi': 0.9954891219439913}
[S9] START round=47 head_norm_before_train=1.805547 cos_to_last_merge=0.9708 (last merge round=21)
[S9] round=47 local utility u=0.000000 metrics={'f1_val': 0.991254331540241, 'auprc': 0.9977784057170641, 'loss_val': 0.0361982901326848, 'psi': 0.9938639612109702}-{'f1_val': 0.9941897064172326, 'auprc': 0.9978188000752619, 'loss_val': 0.03028306762862283, 'psi': 0.9956413438804443}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=47 head_norm_before_train=2.227511 (no previous merge yet)
[S10] round=47 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9977997308985265, 'loss_val': 0.025051546071076094, 'psi': 0.9959690578910341}-{'f1_val': 0.9947486092193725, 'auprc': 0.9981300373960624, 'loss_val': 0.025022374120770057, 'psi': 0.9961011804900485}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=47 head_norm_before_train=2.330631 cos_to_last_merge=0.9973 (last merge round=29)
[S11] round=47 local utility u=0.021641 metrics={'f1_val': 0.9967460138064482, 'auprc': 0.9986709881192748, 'loss_val': 0.01861398867561277, 'psi': 0.9975160035315789}-{'f1_val': 0.9923190009405097, 'auprc': 0.9993834632088263, 'loss_val': 0.037470961356170444, 'psi': 0.9951447858478364}
[S11] not sending this round → trigger blocked (psi=0.998)
[S13] START round=47 head_norm_before_train=1.983837 (no previous merge yet)
[S13] round=47 local utility u=0.000000 metrics={'f1_val': 0.7204639362162486, 'auprc': 0.6747973573437159, 'loss_val': 0.9744707993562493, 'psi': 0.7021973046672355}-{'f1_val': 0.74971350390291, 'auprc': 0.7125897741022726, 'loss_val': 0.8255485577003379, 'psi': 0.734864011982655}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=47 head_norm_before_train=1.859737 cos_to_last_merge=0.9924 (last merge round=30)
[S14] round=47 local utility u=0.000519 metrics={'f1_val': 0.9970665706119299, 'auprc': 0.9987998707326178, 'loss_val': 0.029624838313889342, 'psi': 0.9977598906602051}-{'f1_val': 0.9970441294227608, 'auprc': 0.998736155326726, 'loss_val': 0.030336294077010252, 'psi': 0.9977209397843468}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[S15] START round=47 head_norm_before_train=2.073485 cos_to_last_merge=0.7499 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.750
[S15] round=47 local utility u=0.000000 metrics={'f1_val': 0.8958091036570394, 'auprc': 0.9695297689553225, 'loss_val': 0.38108510877596335, 'psi': 0.9252973697763526}-{'f1_val': 0.9014525766685394, 'auprc': 0.996763065438059, 'loss_val': 0.3006792711389293, 'psi': 0.9395767721763473}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=47 head_norm_before_train=1.701782 cos_to_last_merge=0.9277 (last merge round=20)
[S16] ⚠️ Model drifted since last merge! cos=0.928
[S16] round=47 local utility u=0.000000 metrics={'f1_val': 0.9934948650029447, 'auprc': 0.9918662115783613, 'loss_val': 0.0401934442713013, 'psi': 0.9928434036331113}-{'f1_val': 0.9923904770455448, 'auprc': 0.9978093168514183, 'loss_val': 0.042513750760116875, 'psi': 0.9945580129678941}
[S17] START round=47 head_norm_before_train=2.024608 cos_to_last_merge=0.8069 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.807
[S17] round=47 local utility u=0.834966 metrics={'f1_val': 0.7598919699202051, 'auprc': 0.8367183564211682, 'loss_val': 0.8519959223550472, 'psi': 0.7906225245205905}-{'f1_val': 0.584381781253221, 'auprc': 0.7789766883308081, 'loss_val': 1.2956414445391273, 'psi': 0.6622197440842559}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] sending update (kind=head size=1805 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:58309
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1802) from S7
[S8] cosine check vs S7: cos=0.9998
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=47 metric=0.6229 head_norm=1.846360
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.775102e-02
[S7] stored merged vector for next round verification (round=47)
[S7] DEBUG after merge:  round=47 metric=0.6211 head_norm=1.844318 delta_norm=0.027751
[S7] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=48 head_norm_before_train=1.801567 cos_to_last_merge=0.9518 (last merge round=28)
[S2] round=48 local utility u=0.000000 metrics={'f1_val': 0.7151680612920168, 'auprc': 0.7736238462232058, 'loss_val': 1.0488047118029513, 'psi': 0.7385503752644924}-{'f1_val': 0.8321946164594882, 'auprc': 0.9926061969563625, 'loss_val': 0.4196677462424083, 'psi': 0.8963592486582379}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=48 head_norm_before_train=2.152121 (no previous merge yet)
[S3] round=48 local utility u=0.000000 metrics={'f1_val': 0.7519538633562888, 'auprc': 0.9980645825377189, 'loss_val': 0.44928623314682553, 'psi': 0.8503981510288607}-{'f1_val': 0.7813974414229694, 'auprc': 0.9981800088702969, 'loss_val': 0.4015261358916566, 'psi': 0.8681104684019003}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=48 head_norm_before_train=2.234422 cos_to_last_merge=0.9872 (last merge round=27)
[S4] round=48 local utility u=0.008869 metrics={'f1_val': 0.9399718072600433, 'auprc': 0.9393936049859659, 'loss_val': 0.32243302620674813, 'psi': 0.9397405263504124}-{'f1_val': 0.9398106466532872, 'auprc': 0.9333913646466057, 'loss_val': 0.3211964415790704, 'psi': 0.9372429338506146}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=48 head_norm_before_train=1.451601 cos_to_last_merge=0.9924 (last merge round=30)
[S5] round=48 local utility u=0.000000 metrics={'f1_val': 0.7610912851481765, 'auprc': 0.9857172015375932, 'loss_val': 0.2302347080653458, 'psi': 0.8509416517039432}-{'f1_val': 0.996731224857049, 'auprc': 0.9973513978231813, 'loss_val': 0.13898740192164108, 'psi': 0.9969792940435019}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=48 head_norm_before_train=2.126268 (no previous merge yet)
[S6] round=48 local utility u=1.000000 metrics={'f1_val': 0.9617463681734904, 'auprc': 0.9752839769653262, 'loss_val': 0.21546479040755873, 'psi': 0.9671614116902247}-{'f1_val': 0.5976077042808184, 'auprc': 0.720471409418355, 'loss_val': 1.4524119846707566, 'psi': 0.646753186335833}
[S7] START round=48 head_norm_before_train=1.844318 cos_to_last_merge=1.0000 (last merge round=47)
[S7] round=48 local utility u=0.000000 metrics={'f1_val': 0.5960946344112813, 'auprc': 0.7888616329425808, 'loss_val': 0.7307737991305826, 'psi': 0.673201433823801}-{'f1_val': 0.6228701663753299, 'auprc': 0.7895011613748036, 'loss_val': 0.6684986996016368, 'psi': 0.6895225643751195}
[S8] START round=48 head_norm_before_train=1.847549 cos_to_last_merge=1.0000 (last merge round=46)
[S8] round=48 local utility u=0.169839 metrics={'f1_val': 0.992392260479464, 'auprc': 0.9991904469980992, 'loss_val': 0.03470864654863828, 'psi': 0.9951115350869182}-{'f1_val': 0.9545849738990665, 'auprc': 0.9930124421602871, 'loss_val': 0.12900801248616706, 'psi': 0.9699559612035547}
[S9] START round=48 head_norm_before_train=1.812239 cos_to_last_merge=0.9703 (last merge round=21)
[S9] round=48 local utility u=0.000000 metrics={'f1_val': 0.9858942912577657, 'auprc': 0.9975298702732686, 'loss_val': 0.05672847178979448, 'psi': 0.9905485228639668}-{'f1_val': 0.991254331540241, 'auprc': 0.9977784057170641, 'loss_val': 0.0361982901326848, 'psi': 0.9938639612109702}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=48 head_norm_before_train=2.231229 (no previous merge yet)
[S10] round=48 local utility u=0.000502 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9976594083186411, 'loss_val': 0.024943888483276094, 'psi': 0.9960446752465022}-{'f1_val': 0.9947486092193725, 'auprc': 0.9977997308985265, 'loss_val': 0.025051546071076094, 'psi': 0.9959690578910341}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] START round=48 head_norm_before_train=2.337067 cos_to_last_merge=0.9971 (last merge round=29)
[S11] round=48 local utility u=0.001240 metrics={'f1_val': 0.9969878514242156, 'auprc': 0.99866975051022, 'loss_val': 0.01758205869010531, 'psi': 0.9976606110586175}-{'f1_val': 0.9967460138064482, 'auprc': 0.9986709881192748, 'loss_val': 0.01861398867561277, 'psi': 0.9975160035315789}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=48 head_norm_before_train=1.992248 (no previous merge yet)
[S13] round=48 local utility u=0.000000 metrics={'f1_val': 0.6319737923216188, 'auprc': 0.6720997213009349, 'loss_val': 0.9982359288567634, 'psi': 0.6480241639133452}-{'f1_val': 0.7204639362162486, 'auprc': 0.6747973573437159, 'loss_val': 0.9744707993562493, 'psi': 0.7021973046672355}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=48 head_norm_before_train=1.867673 cos_to_last_merge=0.9920 (last merge round=30)
[S14] round=48 local utility u=0.000000 metrics={'f1_val': 0.9965831726061278, 'auprc': 0.9990523029939726, 'loss_val': 0.03141799742300149, 'psi': 0.9975708247612658}-{'f1_val': 0.9970665706119299, 'auprc': 0.9987998707326178, 'loss_val': 0.029624838313889342, 'psi': 0.9977598906602051}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=48 head_norm_before_train=2.083231 cos_to_last_merge=0.7493 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.749
[S15] round=48 local utility u=0.074650 metrics={'f1_val': 0.9008967941393231, 'auprc': 0.9957258473119256, 'loss_val': 0.3408988022798948, 'psi': 0.9388284154083641}-{'f1_val': 0.8958091036570394, 'auprc': 0.9695297689553225, 'loss_val': 0.38108510877596335, 'psi': 0.9252973697763526}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=48 head_norm_before_train=1.710876 cos_to_last_merge=0.9270 (last merge round=20)
[S16] ⚠️ Model drifted since last merge! cos=0.927
[S16] round=48 local utility u=0.000408 metrics={'f1_val': 0.9934948650029447, 'auprc': 0.991799379478645, 'loss_val': 0.03917620477330094, 'psi': 0.9928166707932248}-{'f1_val': 0.9934948650029447, 'auprc': 0.9918662115783613, 'loss_val': 0.0401934442713013, 'psi': 0.9928434036331113}
[S17] START round=48 head_norm_before_train=2.037386 cos_to_last_merge=0.8063 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.806
[S17] round=48 local utility u=0.000000 metrics={'f1_val': 0.7008547636160539, 'auprc': 0.9139138178636295, 'loss_val': 0.9800243616463411, 'psi': 0.7860783853150841}-{'f1_val': 0.7598919699202051, 'auprc': 0.8367183564211682, 'loss_val': 0.8519959223550472, 'psi': 0.7906225245205905}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:58316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:58307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:58308
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1799) from S8
[S7] cosine check vs S8: cos=0.9998
[S16] RECEIVED delta(kind=head bytes=1797) from S6
[S16] cosine check vs S6: cos=-0.0789
[S16] DROPPED delta from S6 (cos=-0.0789 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1802) from S16
[S6] cosine check vs S16: cos=-0.0789
[S6] DROPPED delta from S16 (cos=-0.0789 < 0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=48 metric=0.9924 head_norm=1.854966
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.800526e-02
[S8] stored merged vector for next round verification (round=48)
[S8] DEBUG after merge:  round=48 metric=0.9924 head_norm=1.850456 delta_norm=0.028005
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=49 head_norm_before_train=1.810438 cos_to_last_merge=0.9510 (last merge round=28)
[S2] round=49 local utility u=0.971728 metrics={'f1_val': 0.8320309252245706, 'auprc': 0.9813831891601963, 'loss_val': 0.4298037717206952, 'psi': 0.8917718307988209}-{'f1_val': 0.7151680612920168, 'auprc': 0.7736238462232058, 'loss_val': 1.0488047118029513, 'psi': 0.7385503752644924}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] sending update (kind=head size=1795 to 1 peers)
[S3] START round=49 head_norm_before_train=2.162679 (no previous merge yet)
[S3] round=49 local utility u=0.814661 metrics={'f1_val': 0.9610069327789146, 'auprc': 0.9981327963464951, 'loss_val': 0.0744866300455744, 'psi': 0.9758572782059467}-{'f1_val': 0.7519538633562888, 'auprc': 0.9980645825377189, 'loss_val': 0.44928623314682553, 'psi': 0.8503981510288607}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=49 head_norm_before_train=2.240806 cos_to_last_merge=0.9865 (last merge round=27)
[S4] round=49 local utility u=0.002888 metrics={'f1_val': 0.9411298262346015, 'auprc': 0.9390238444626604, 'loss_val': 0.3224957356403798, 'psi': 0.9402874335258251}-{'f1_val': 0.9399718072600433, 'auprc': 0.9393936049859659, 'loss_val': 0.32243302620674813, 'psi': 0.9397405263504124}
[S4] not sending this round → trigger blocked (psi=0.940)
[S5] START round=49 head_norm_before_train=1.456952 cos_to_last_merge=0.9920 (last merge round=30)
[S5] round=49 local utility u=0.000000 metrics={'f1_val': 0.7008676007203419, 'auprc': 0.9677076881049077, 'loss_val': 0.2963800686242179, 'psi': 0.8076036356741683}-{'f1_val': 0.7610912851481765, 'auprc': 0.9857172015375932, 'loss_val': 0.2302347080653458, 'psi': 0.8509416517039432}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=49 head_norm_before_train=2.126894 (no previous merge yet)
[S6] round=49 local utility u=0.000000 metrics={'f1_val': 0.7482868537180719, 'auprc': 0.9243536676535494, 'loss_val': 0.8783037367584312, 'psi': 0.818713579292263}-{'f1_val': 0.9617463681734904, 'auprc': 0.9752839769653262, 'loss_val': 0.21546479040755873, 'psi': 0.9671614116902247}
[S7] START round=49 head_norm_before_train=1.851523 cos_to_last_merge=1.0000 (last merge round=47)
[S7] round=49 local utility u=0.015449 metrics={'f1_val': 0.5970605940285955, 'auprc': 0.7897930242367301, 'loss_val': 0.7084664216218194, 'psi': 0.6741535661118494}-{'f1_val': 0.5960946344112813, 'auprc': 0.7888616329425808, 'loss_val': 0.7307737991305826, 'psi': 0.673201433823801}
[S8] START round=49 head_norm_before_train=1.850456 cos_to_last_merge=1.0000 (last merge round=48)
[S8] round=49 local utility u=0.000000 metrics={'f1_val': 0.9874934518419147, 'auprc': 0.9970735579279447, 'loss_val': 0.042181879985649054, 'psi': 0.9913254942763268}-{'f1_val': 0.992392260479464, 'auprc': 0.9991904469980992, 'loss_val': 0.03470864654863828, 'psi': 0.9951115350869182}
[S9] START round=49 head_norm_before_train=1.818544 cos_to_last_merge=0.9697 (last merge round=21)
[S9] round=49 local utility u=0.045459 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9950558134143276, 'loss_val': 0.022985031804208175, 'psi': 0.9960186324540659}-{'f1_val': 0.9858942912577657, 'auprc': 0.9975298702732686, 'loss_val': 0.05672847178979448, 'psi': 0.9905485228639668}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=49 head_norm_before_train=2.236165 (no previous merge yet)
[S10] round=49 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.997851425795882, 'loss_val': 0.02515244217637641, 'psi': 0.9959897358499763}-{'f1_val': 0.9949681865317428, 'auprc': 0.9976594083186411, 'loss_val': 0.024943888483276094, 'psi': 0.9960446752465022}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=49 head_norm_before_train=2.343566 cos_to_last_merge=0.9970 (last merge round=29)
[S11] round=49 local utility u=0.000000 metrics={'f1_val': 0.9745404094717958, 'auprc': 0.9995188066132602, 'loss_val': 0.09635166540418423, 'psi': 0.9845317683283816}-{'f1_val': 0.9969878514242156, 'auprc': 0.99866975051022, 'loss_val': 0.01758205869010531, 'psi': 0.9976606110586175}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=49 head_norm_before_train=2.001274 (no previous merge yet)
[S13] round=49 local utility u=0.254877 metrics={'f1_val': 0.6901986847988615, 'auprc': 0.7074268564057846, 'loss_val': 0.9438121989429133, 'psi': 0.6970899534416307}-{'f1_val': 0.6319737923216188, 'auprc': 0.6720997213009349, 'loss_val': 0.9982359288567634, 'psi': 0.6480241639133452}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=49 head_norm_before_train=1.874555 cos_to_last_merge=0.9916 (last merge round=30)
[S14] round=49 local utility u=0.004245 metrics={'f1_val': 0.9973060238921251, 'auprc': 0.9991738876613374, 'loss_val': 0.027629291005519845, 'psi': 0.99805316939981}-{'f1_val': 0.9965831726061278, 'auprc': 0.9990523029939726, 'loss_val': 0.03141799742300149, 'psi': 0.9975708247612658}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] sending update (kind=head size=1805 to 1 peers)
[S15] START round=49 head_norm_before_train=2.092899 cos_to_last_merge=0.7487 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.749
[S15] round=49 local utility u=0.061656 metrics={'f1_val': 0.9031898184430511, 'auprc': 0.9969735317297641, 'loss_val': 0.2350875144698774, 'psi': 0.9407033037577364}-{'f1_val': 0.9008967941393231, 'auprc': 0.9957258473119256, 'loss_val': 0.3408988022798948, 'psi': 0.9388284154083641}
[S15] not sending this round → trigger blocked (psi=0.941)
[S16] START round=49 head_norm_before_train=1.719172 cos_to_last_merge=0.9260 (last merge round=20)
[S16] ⚠️ Model drifted since last merge! cos=0.926
[S16] round=49 local utility u=0.003043 metrics={'f1_val': 0.9928508455745393, 'auprc': 0.9950174841402475, 'loss_val': 0.03887987973122606, 'psi': 0.9937175010008226}-{'f1_val': 0.9934948650029447, 'auprc': 0.991799379478645, 'loss_val': 0.03917620477330094, 'psi': 0.9928166707932248}
[S17] START round=49 head_norm_before_train=2.050618 cos_to_last_merge=0.8057 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.806
[S17] round=49 local utility u=0.000000 metrics={'f1_val': 0.6373464271009794, 'auprc': 0.9265915855000633, 'loss_val': 1.1674939952295094, 'psi': 0.7530444904606131}-{'f1_val': 0.7008547636160539, 'auprc': 0.9139138178636295, 'loss_val': 0.9800243616463411, 'psi': 0.7860783853150841}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.994)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:58309
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1798) from S7
[S8] cosine check vs S7: cos=0.9999
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=49 metric=0.5971 head_norm=1.856662
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.014982e-02
[S7] stored merged vector for next round verification (round=49)
[S7] DEBUG after merge:  round=49 metric=0.5967 head_norm=1.855705 delta_norm=0.020150
[S7] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[runner] rounds complete.
[runner] all agents stopped.
