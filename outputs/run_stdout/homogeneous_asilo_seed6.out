[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:63203
[S3] → join 127.0.0.1:63202
[S4] → join 127.0.0.1:63202
[S5] → join 127.0.0.1:63202
[S6] → join 127.0.0.1:63202
[S7] → join 127.0.0.1:63202
[S8] → join 127.0.0.1:63202
[S9] → join 127.0.0.1:63202
[S10] → join 127.0.0.1:63202
[S11] → join 127.0.0.1:63202
[S13] → join 127.0.0.1:63202
[S14] → join 127.0.0.1:63202
[S15] → join 127.0.0.1:63202
[S16] → join 127.0.0.1:63202
[S17] → join 127.0.0.1:63202
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.191415 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.130238 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.168064 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.166983 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.150383 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.158815 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.172526 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.161125 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.146965 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.147367 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.159756 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.171696 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.107625 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.188039 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.148939 (no previous merge yet)
[S17]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S3] + discovered S16
[S3] + discovered S11
[S3] + discovered S17
[S3] + discovered S9
[S4] + discovered S3
[S3] + discovered S15
[S3] + discovered S4
[S3] + discovered S6
[S3] + discovered S13
[S3] + discovered S14
[S4] + discovered S2
[S3] + discovered S10
[S3] + discovered S8
[S3] + discovered S5
[S3] + discovered S7
[S5] + discovered S2
[S5] + discovered S4
[S4] + discovered S6
[S5] + discovered S3
[S4] + discovered S16
[S4] + discovered S8
[S4] + discovered S17
[S4] + discovered S5
[S4] + discovered S14
[S4] + discovered S7
[S4] + discovered S15
[S4] + discovered S10
[S4] + discovered S13
[S4] + discovered S11
[S4] + discovered S9
[S5] + discovered S10
[S5] + discovered S14
[S5] + discovered S7
[S6] + discovered S5
[S5] + discovered S8
[S5] + discovered S17
[S5] + discovered S11
[S5] + discovered S9
[S5] + discovered S15
[S6] + discovered S3
[S5] + discovered S13
[S5] + discovered S16
[S5] + discovered S6
[S6] + discovered S4
[S6] + discovered S2
[S6] + discovered S7
[S6] + discovered S9
[S6] + discovered S14
[S7] + discovered S5
[S6] + discovered S17
[S7] + discovered S2
[S7] + discovered S6
[S7] + discovered S4
[S7] + discovered S3
[S6] + discovered S11
[S6] + discovered S15
[S6] + discovered S8
[S6] + discovered S13
[S6] + discovered S16
[S6] + discovered S10
[S7] + discovered S13
[S7] + discovered S14
[S7] + discovered S17
[S7] + discovered S10
[S7] + discovered S9
[S8] + discovered S6
[S8] + discovered S3
[S8] + discovered S4
[S7] + discovered S16
[S7] + discovered S11
[S8] + discovered S7
[S7] + discovered S8
[S8] + discovered S5
[S8] + discovered S2
[S7] + discovered S15
[S8] + discovered S17
[S9] + discovered S2
[S9] + discovered S4
[S9] + discovered S6
[S8] + discovered S9
[S8] + discovered S11
[S8] + discovered S13
[S8] + discovered S15
[S8] + discovered S10
[S8] + discovered S14
[S9] + discovered S3
[S9] + discovered S8
[S9] + discovered S7
[S9] + discovered S5
[S8] + discovered S16
[S10] + discovered S8
[S9] + discovered S14
[S10] + discovered S9
[S9] + discovered S10
[S10] + discovered S6
[S9] + discovered S16
[S10] + discovered S7
[S10] + discovered S4
[S10] + discovered S2
[S9] + discovered S15
[S9] + discovered S17
[S9] + discovered S13
[S10] + discovered S5
[S10] + discovered S3
[S9] + discovered S11
[S11] + discovered S2
[S11] + discovered S7
[S11] + discovered S9
[S11] + discovered S10
[S11] + discovered S3
[S11] + discovered S4
[S10] + discovered S16
[S10] + discovered S13
[S11] + discovered S8
[S10] + discovered S15
[S10] + discovered S14
[S10] + discovered S11
[S11] + discovered S5
[S10] + discovered S17
[S11] + discovered S6
[S11] + discovered S13
[S13] + discovered S5
[S13] + discovered S2
[S13] + discovered S4
[S13] + discovered S8
[S13] + discovered S10
[S13] + discovered S6
[S13] + discovered S3
[S13] + discovered S11
[S11] + discovered S16
[S11] + discovered S14
[S11] + discovered S17
[S11] + discovered S15
[S13] + discovered S7
[S13] + discovered S9
[S14] + discovered S2
[S13] + discovered S14
[S14] + discovered S7
[S13] + discovered S17
[S14] + discovered S11
[S14] + discovered S3
[S13] + discovered S16
[S14] + discovered S13
[S14] + discovered S10
[S14] + discovered S4
[S14] + discovered S6
[S14] + discovered S8
[S14] + discovered S9
[S14] + discovered S5
[S13] + discovered S15
[S15] + discovered S2
[S14] + discovered S15
[S15] + discovered S5
[S14] + discovered S16
[S15] + discovered S9
[S15] + discovered S11
[S14] + discovered S17
[S15] + discovered S10
[S15] + discovered S4
[S15] + discovered S13
[S15] + discovered S8
[S15] + discovered S6
[S15] + discovered S3
[S15] + discovered S14
[S15] + discovered S7
[S16] + discovered S10
[S16] + discovered S5
[S16] + discovered S15
[S16] + discovered S3
[S16] + discovered S13
[S16] + discovered S14
[S16] + discovered S7
[S15] + discovered S17
[S16] + discovered S9
[S16] + discovered S2
[S16] + discovered S8
[S16] + discovered S6
[S16] + discovered S4
[S16] + discovered S11
[S15] + discovered S16
[S17] + discovered S5
[S17] + discovered S4
[S17] + discovered S16
[S17] + discovered S8
[S17] + discovered S3
[S17] + discovered S13
[S17] + discovered S9
[S17] + discovered S7
[S17] + discovered S14
[S17] + discovered S15
[S17] + discovered S11
[S16] + discovered S17
[S17] + discovered S6
[S17] + discovered S10
[S17] + discovered S2
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] ⇄ pheromone p=1.000 → S2@127.0.0.1:63202
[S14] ⇄ pheromone p=1.000 → S10@127.0.0.1:63211
[S4] ⇄ pheromone p=1.000 → S7@127.0.0.1:63208
[S6] ⇄ pheromone p=1.000 → S13@127.0.0.1:63213
[S3] ⇄ pheromone p=1.000 → S11@127.0.0.1:63212
[S15] ⇄ pheromone p=1.000 → S13@127.0.0.1:63213
[S2] ⇄ pheromone p=1.000 → S4@127.0.0.1:63204
[S16] ⇄ pheromone p=1.000 → S4@127.0.0.1:63204
[S7] ⇄ pheromone p=1.000 → S3@127.0.0.1:63203
[S5] ⇄ pheromone p=1.000 → S3@127.0.0.1:63203
[S13] ⇄ pheromone p=1.000 → S3@127.0.0.1:63203
[S11] ⇄ pheromone p=1.000 → S15@127.0.0.1:63215
[S9] ⇄ pheromone p=1.000 → S5@127.0.0.1:63205
[S10] ⇄ pheromone p=1.000 → S5@127.0.0.1:63205
[S17] ⇄ pheromone p=1.000 → S2@127.0.0.1:63202
[S2] START round=1 head_norm_before_train=1.200246 (no previous merge yet)
[S2] round=1 local utility u=0.125430 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7043999137054343, 'loss_val': 1.3077387161242728, 'psi': 0.3668262455153138}-{'f1_val': 0.1417771333885667, 'auprc': 0.6321942544560294, 'loss_val': 1.3419826327860234, 'psi': 0.3379439818155518}
[S3] START round=1 head_norm_before_train=1.137193 (no previous merge yet)
[S3] round=1 local utility u=0.143963 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8401163150427065, 'loss_val': 1.3206390835084814, 'psi': 0.41995056538554687}-{'f1_val': 0.24019781488130462, 'auprc': 0.5534991373328781, 'loss_val': 1.3508594722905676, 'psi': 0.36551834386193405}
[S4] START round=1 head_norm_before_train=1.173655 (no previous merge yet)
[S4] round=1 local utility u=0.747002 metrics={'f1_val': 0.20046297432962484, 'auprc': 0.7382519302521553, 'loss_val': 1.3267729080696833, 'psi': 0.415578556698637}-{'f1_val': 0.10637591321673677, 'auprc': 0.43878378579096045, 'loss_val': 1.35784972153784, 'psi': 0.23933906224642623}
[S5] START round=1 head_norm_before_train=1.171457 (no previous merge yet)
[S5] round=1 local utility u=0.555965 metrics={'f1_val': 0.41762898496828804, 'auprc': 0.7289213601750615, 'loss_val': 1.3352328498779316, 'psi': 0.5421459350509974}-{'f1_val': 0.24878250831413762, 'auprc': 0.7073575065576272, 'loss_val': 1.3693918208233518, 'psi': 0.43221250761153346}
[S6] START round=1 head_norm_before_train=1.152940 (no previous merge yet)
[S6] round=1 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.7973355727466814, 'loss_val': 1.3243985672018237, 'psi': 0.4037899983294418}-{'f1_val': 0.4006736677058834, 'auprc': 0.5740091629093662, 'loss_val': 1.3546587973427358, 'psi': 0.47000786578727655}
[S7] START round=1 head_norm_before_train=1.155184 (no previous merge yet)
[S7] round=1 local utility u=0.351085 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7924746015215055, 'loss_val': 1.3327824619249806, 'psi': 0.40222393424605724}-{'f1_val': 0.14205682272909165, 'auprc': 0.5674031985579724, 'loss_val': 1.3597389708269718, 'psi': 0.31219537306064393}
[S8] START round=1 head_norm_before_train=1.169903 (no previous merge yet)
[S8] round=1 local utility u=0.000000 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7826389646125997, 'loss_val': 1.323367878650318, 'psi': 0.3970291752808142}-{'f1_val': 0.16994655004859086, 'auprc': 0.7760094215557318, 'loss_val': 1.3610995033599202, 'psi': 0.41237169865144724}
[S9] START round=1 head_norm_before_train=1.172066 (no previous merge yet)
[S9] round=1 local utility u=0.018795 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9991954906257621, 'loss_val': 1.31030015988275, 'psi': 0.4845169705343025}-{'f1_val': 0.141397957139996, 'auprc': 0.9990609178729927, 'loss_val': 1.3474865998007641, 'psi': 0.4844631414331947}
[S10] START round=1 head_norm_before_train=1.157408 (no previous merge yet)
[S10] round=1 local utility u=0.046825 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6777591178143196, 'loss_val': 1.3218183000148553, 'psi': 0.35427662965076223}-{'f1_val': 0.13862163754172394, 'auprc': 0.6566365989945949, 'loss_val': 1.3521001180267538, 'psi': 0.3458276221228723}
[S11] START round=1 head_norm_before_train=1.154498 (no previous merge yet)
[S11] round=1 local utility u=0.787287 metrics={'f1_val': 0.3304823629409265, 'auprc': 0.7477348133674279, 'loss_val': 1.3431592859570614, 'psi': 0.49738334311152704}-{'f1_val': 0.10359570269677702, 'auprc': 0.6893788615684306, 'loss_val': 1.3813457628332777, 'psi': 0.3379089662454385}
[S13] START round=1 head_norm_before_train=1.167954 (no previous merge yet)
[S13] round=1 local utility u=0.000000 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7013252984881475, 'loss_val': 1.3171296944946775, 'psi': 0.36476157694149086}-{'f1_val': 0.29202263863382494, 'auprc': 0.5318383658602329, 'loss_val': 1.3523013240699402, 'psi': 0.38794892952438814}
[S14] START round=1 head_norm_before_train=1.168655 (no previous merge yet)
[S14] round=1 local utility u=0.117915 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8878479760032112, 'loss_val': 1.3429240968911336, 'psi': 0.43935390213090675}-{'f1_val': 0.14035785288270378, 'auprc': 0.8167572232908207, 'loss_val': 1.365480885727709, 'psi': 0.41091760104595054}
[S15] START round=1 head_norm_before_train=1.117700 (no previous merge yet)
[S15] round=1 local utility u=0.407284 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7215652685883966, 'loss_val': 1.3153527013805268, 'psi': 0.37246629825229366}-{'f1_val': 0.15121531512153152, 'auprc': 0.4379744507655585, 'loss_val': 1.3480382796294494, 'psi': 0.26591896937914233}
[S16] START round=1 head_norm_before_train=1.200460 (no previous merge yet)
[S16] round=1 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.822747766833058, 'loss_val': 1.3096053558682936, 'psi': 0.4134815768527451}-{'f1_val': 0.38256037982300173, 'auprc': 0.8177534328766976, 'loss_val': 1.3543855238232332, 'psi': 0.55663760104448}
[S17] START round=1 head_norm_before_train=1.155001 (no previous merge yet)
[S17] round=1 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.8848544145323518, 'loss_val': 1.340783267059952, 'psi': 0.43851114380337136}-{'f1_val': 0.38125949298170836, 'auprc': 0.8113005911112248, 'loss_val': 1.369521560291993, 'psi': 0.5532759322335149}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:63208
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S11] → sending delta(kind=head bytes=1789) to S9@127.0.0.1:63210
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1783 reason=None
[S4] → sending delta(kind=head bytes=1783) to S6@127.0.0.1:63207
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:63210
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S14] → sending delta(kind=head bytes=1791) to S9@127.0.0.1:63210
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S3] → sending delta(kind=head bytes=1787) to S7@127.0.0.1:63208
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:63205
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S7] → sending delta(kind=head bytes=1792) to S5@127.0.0.1:63205
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S5] → sending delta(kind=head bytes=1788) to S11@127.0.0.1:63212
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:63204
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1794 to 1 peers)
[S11] sending update (kind=head size=1789 to 1 peers)
[S14] sending update (kind=head size=1791 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1788 to 1 peers)
[S2] sending update (kind=head size=1793 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1792 to 1 peers)
[S3] sending update (kind=head size=1787 to 1 peers)
[S4] sending update (kind=head size=1783 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1783) from S4
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.185874)
[S6] loaded HEAD from S4 (vec_in norm=1.185874)
[S6] cosine check vs S4: cos=0.0202
[S6] BUFFERED delta from S4 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1795) from S9
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.192576)
[S7] loaded HEAD from S9 (vec_in norm=1.192576)
[S7] cosine check vs S9: cos=0.0231
[S7] BUFFERED delta from S9 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1787) from S3
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.151441)
[S7] loaded HEAD from S3 (vec_in norm=1.151441)
[S7] cosine check vs S3: cos=-0.0010
[S7] DROPPED delta from S3 (cos=-0.0010 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1789) from S11
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.171198)
[S9] loaded HEAD from S11 (vec_in norm=1.171198)
[S9] cosine check vs S11: cos=-0.0061
[S9] DROPPED delta from S11 (cos=-0.0061 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1792) from S7
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.163522)
[S5] loaded HEAD from S7 (vec_in norm=1.163522)
[S5] cosine check vs S7: cos=0.0193
[S5] BUFFERED delta from S7 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1795) from S15
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.138027)
[S4] loaded HEAD from S15 (vec_in norm=1.138027)
[S4] cosine check vs S15: cos=0.0360
[S4] BUFFERED delta from S15 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1794) from S10
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.173976)
[S9] loaded HEAD from S10 (vec_in norm=1.173976)
[S9] cosine check vs S10: cos=0.0826
[S9] BUFFERED delta from S10 (total buffered=1)
[S9] RECEIVED delta(kind=head bytes=1791) from S14
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.176405)
[S9] loaded HEAD from S14 (vec_in norm=1.176405)
[S9] cosine check vs S14: cos=0.0274
[S9] BUFFERED delta from S14 (total buffered=2)
[S11] RECEIVED delta(kind=head bytes=1788) from S5
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.183849)
[S11] loaded HEAD from S5 (vec_in norm=1.183849)
[S11] cosine check vs S5: cos=-0.0717
[S11] DROPPED delta from S5 (cos=-0.0717 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1793) from S2
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.217427)
[S5] loaded HEAD from S2 (vec_in norm=1.217427)
[S5] cosine check vs S2: cos=-0.1012
[S5] DROPPED delta from S2 (cos=-0.1012 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=1 metric=0.1414 head_norm=1.164325
[S6] _apply_head_vector_avg (torch): Δ‖w‖=8.225099e-01
[S6] stored merged vector for next round verification (round=1)
[S6] DEBUG after merge:  round=1 metric=0.1414 head_norm=0.839316 delta_norm=0.822510
[S6] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=1 metric=0.4176 head_norm=1.183849
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.219196e-01
[S5] stored merged vector for next round verification (round=1)
[S5] DEBUG after merge:  round=1 metric=0.1423 head_norm=0.837908 delta_norm=0.821920
[S5] aggregate: ROLLBACK (f1_val pre=0.418 post=0.142 tol_abs=0.005 tol_rel=0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=1 metric=0.2005 head_norm=1.185874
[S4] _apply_head_vector_avg (torch): Δ‖w‖=8.068709e-01
[S4] stored merged vector for next round verification (round=1)
[S4] DEBUG after merge:  round=1 metric=0.1402 head_norm=0.836457 delta_norm=0.806871
[S4] aggregate: ROLLBACK (f1_val pre=0.200 post=0.140 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=1 metric=0.1414 head_norm=1.192576
[S9] _apply_head_vector_avg (torch): Δ‖w‖=7.164686e-01
[S9] stored merged vector for next round verification (round=1)
[S9] DEBUG after merge:  round=1 metric=0.1461 head_norm=0.768326 delta_norm=0.716469
[S9] aggregate: ACCEPT kept=['S10', 'S14'] (k=2/2) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=1 metric=0.1421 head_norm=1.163522
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.234079e-01
[S7] stored merged vector for next round verification (round=1)
[S7] DEBUG after merge:  round=1 metric=0.1421 head_norm=0.842621 delta_norm=0.823408
[S7] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=1.217427 (no previous merge yet)
[S2] round=2 local utility u=0.082629 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7458578735273242, 'loss_val': 1.2668543711858853, 'psi': 0.38340942944406975}-{'f1_val': 0.1417771333885667, 'auprc': 0.7043999137054343, 'loss_val': 1.3077387161242728, 'psi': 0.3668262455153138}
[S3] START round=2 head_norm_before_train=1.151441 (no previous merge yet)
[S3] round=2 local utility u=0.047911 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8599139342295146, 'loss_val': 1.2842106152819868, 'psi': 0.42786961306027005}-{'f1_val': 0.13984006561410703, 'auprc': 0.8401163150427065, 'loss_val': 1.3206390835084814, 'psi': 0.41995056538554687}
[S4] START round=2 head_norm_before_train=0.836457 cos_to_last_merge=1.0000 (last merge round=1)
[S4] round=2 local utility u=0.000000 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7729830806700464, 'loss_val': 1.3214487444191139, 'psi': 0.39332920960512907}-{'f1_val': 0.20046297432962484, 'auprc': 0.7382519302521553, 'loss_val': 1.3267729080696833, 'psi': 0.415578556698637}
[S5] START round=2 head_norm_before_train=0.837908 cos_to_last_merge=1.0000 (last merge round=1)
[S5] round=2 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7291149570549184, 'loss_val': 1.313074383263485, 'psi': 0.3770031256791102}-{'f1_val': 0.41762898496828804, 'auprc': 0.7289213601750615, 'loss_val': 1.3352328498779316, 'psi': 0.5421459350509974}
[S6] START round=2 head_norm_before_train=0.839316 cos_to_last_merge=1.0000 (last merge round=1)
[S6] round=2 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6628714079229274, 'loss_val': 1.3222361774780174, 'psi': 0.35000433239994017}-{'f1_val': 0.14142628205128205, 'auprc': 0.7973355727466814, 'loss_val': 1.3243985672018237, 'psi': 0.4037899983294418}
[S7] START round=2 head_norm_before_train=0.842621 cos_to_last_merge=1.0000 (last merge round=1)
[S7] round=2 local utility u=0.008850 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7998634751859307, 'loss_val': 1.3372498643408706, 'psi': 0.40517948371182727}-{'f1_val': 0.14205682272909165, 'auprc': 0.7924746015215055, 'loss_val': 1.3327824619249806, 'psi': 0.40222393424605724}
[S8] START round=2 head_norm_before_train=1.180734 (no previous merge yet)
[S8] round=2 local utility u=0.001631 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7691467107565781, 'loss_val': 1.2796300370344658, 'psi': 0.3916322737384056}-{'f1_val': 0.13995598239295717, 'auprc': 0.7826389646125997, 'loss_val': 1.323367878650318, 'psi': 0.3970291752808142}
[S9] START round=2 head_norm_before_train=0.768326 cos_to_last_merge=1.0000 (last merge round=1)
[S9] round=2 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9984498784539635, 'loss_val': 1.3225583583436802, 'psi': 0.48421872566558305}-{'f1_val': 0.141397957139996, 'auprc': 0.9991954906257621, 'loss_val': 1.31030015988275, 'psi': 0.4845169705343025}
[S10] START round=2 head_norm_before_train=1.173976 (no previous merge yet)
[S10] round=2 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.63531870532119, 'loss_val': 1.2871434070908372, 'psi': 0.3373004646535103}-{'f1_val': 0.13862163754172394, 'auprc': 0.6777591178143196, 'loss_val': 1.3218183000148553, 'psi': 0.35427662965076223}
[S11] START round=2 head_norm_before_train=1.171198 (no previous merge yet)
[S11] round=2 local utility u=0.349643 metrics={'f1_val': 0.41529358058659227, 'auprc': 0.7951257053606419, 'loss_val': 1.2949139061241983, 'psi': 0.5672264304962121}-{'f1_val': 0.3304823629409265, 'auprc': 0.7477348133674279, 'loss_val': 1.3431592859570614, 'psi': 0.49738334311152704}
[S13] START round=2 head_norm_before_train=1.186704 (no previous merge yet)
[S13] round=2 local utility u=0.043126 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7166785174789116, 'loss_val': 1.2769370928596198, 'psi': 0.37090286453779653}-{'f1_val': 0.1403857625770531, 'auprc': 0.7013252984881475, 'loss_val': 1.3171296944946775, 'psi': 0.36476157694149086}
[S14] START round=2 head_norm_before_train=1.176405 (no previous merge yet)
[S14] round=2 local utility u=0.019350 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8922328046277166, 'loss_val': 1.3173795238902775, 'psi': 0.44110783358070893}-{'f1_val': 0.14035785288270378, 'auprc': 0.8878479760032112, 'loss_val': 1.3429240968911336, 'psi': 0.43935390213090675}
[S15] START round=2 head_norm_before_train=1.138027 (no previous merge yet)
[S15] round=2 local utility u=0.079622 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7638504759782352, 'loss_val': 1.2829637653104207, 'psi': 0.3893803812082291}-{'f1_val': 0.13973365136155833, 'auprc': 0.7215652685883966, 'loss_val': 1.3153527013805268, 'psi': 0.37246629825229366}
[S16] START round=2 head_norm_before_train=1.223452 (no previous merge yet)
[S16] round=2 local utility u=0.040565 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8329369102751885, 'loss_val': 1.259042629887105, 'psi': 0.41755723422959734}-{'f1_val': 0.14063745019920318, 'auprc': 0.822747766833058, 'loss_val': 1.3096053558682936, 'psi': 0.4134815768527451}
[S17] START round=2 head_norm_before_train=1.169007 (no previous merge yet)
[S17] round=2 local utility u=0.020043 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.8851888687073662, 'loss_val': 1.3017012183983503, 'psi': 0.43864492547337713}-{'f1_val': 0.14094896331738438, 'auprc': 0.8848544145323518, 'loss_val': 1.340783267059952, 'psi': 0.43851114380337136}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S2] → sending delta(kind=head bytes=1792) to S8@127.0.0.1:63209
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:63215
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S13] → sending delta(kind=head bytes=1790) to S14@127.0.0.1:63214
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S8] → sending delta(kind=head bytes=1791) to S14@127.0.0.1:63214
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] → sending delta(kind=head bytes=1794) to S7@127.0.0.1:63208
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] → sending delta(kind=head bytes=1793) to S9@127.0.0.1:63210
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:63209
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S3] → sending delta(kind=head bytes=1790) to S7@127.0.0.1:63208
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:63207
[S8] sending update (kind=head size=1791 to 1 peers)
[S14] sending update (kind=head size=1794 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1790 to 1 peers)
[S13] sending update (kind=head size=1790 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1790) from S3
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.173960)
[S7] loaded HEAD from S3 (vec_in norm=1.173960)
[S7] cosine check vs S3: cos=-0.0450
[S7] DROPPED delta from S3 (cos=-0.0450 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1791) from S8
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.203379)
[S14] loaded HEAD from S8 (vec_in norm=1.203379)
[S14] cosine check vs S8: cos=-0.0783
[S14] DROPPED delta from S8 (cos=-0.0783 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1799) from S7
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.855967)
[S15] loaded HEAD from S7 (vec_in norm=0.855967)
[S15] cosine check vs S7: cos=-0.0432
[S15] DROPPED delta from S7 (cos=-0.0432 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1801) from S15
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.163942)
[S8] loaded HEAD from S15 (vec_in norm=1.163942)
[S8] cosine check vs S15: cos=0.0383
[S8] BUFFERED delta from S15 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1794) from S14
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.195094)
[S7] loaded HEAD from S14 (vec_in norm=1.195094)
[S7] cosine check vs S14: cos=-0.0027
[S7] DROPPED delta from S14 (cos=-0.0027 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1790) from S13
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.212179)
[S14] loaded HEAD from S13 (vec_in norm=1.212179)
[S14] cosine check vs S13: cos=0.0651
[S14] BUFFERED delta from S13 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S11@127.0.0.1:63212
[S17] sending update (kind=head size=1800 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1800) from S17
[S6] model_id mismatch: wear != wear
[S6] after if model_id mismatch: wear != wear
[S6] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.194881)
[S6] loaded HEAD from S17 (vec_in norm=1.194881)
[S6] cosine check vs S17: cos=0.0330
[S6] BUFFERED delta from S17 (total buffered=1)
[S11] sending update (kind=head size=1793 to 1 peers)
[S2] sending update (kind=head size=1792 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1792) from S2
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.242163)
[S8] loaded HEAD from S2 (vec_in norm=1.242163)
[S8] cosine check vs S2: cos=-0.0512
[S8] DROPPED delta from S2 (cos=-0.0512 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1793) from S11
[S9] model_id mismatch: wear != wear
[S9] after if model_id mismatch: wear != wear
[S9] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.197172)
[S9] loaded HEAD from S11 (vec_in norm=1.197172)
[S9] cosine check vs S11: cos=-0.0439
[S9] DROPPED delta from S11 (cos=-0.0439 < 0.0)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1803 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1803) from S16
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.252073)
[S11] loaded HEAD from S16 (vec_in norm=1.252073)
[S11] cosine check vs S16: cos=-0.1024
[S11] DROPPED delta from S16 (cos=-0.1024 < 0.0)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=2 metric=0.1414 head_norm=0.854972
[S6] _apply_head_vector_avg (torch): Δ‖w‖=7.230627e-01
[S6] stored merged vector for next round verification (round=2)
[S6] DEBUG after merge:  round=2 metric=0.1414 head_norm=0.746016 delta_norm=0.723063
[S6] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=2 metric=0.1400 head_norm=1.203379
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.209258e-01
[S8] stored merged vector for next round verification (round=2)
[S8] DEBUG after merge:  round=2 metric=0.1400 head_norm=0.852949 delta_norm=0.820926
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=2 metric=0.1404 head_norm=1.195094
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.229617e-01
[S14] stored merged vector for next round verification (round=2)
[S14] DEBUG after merge:  round=2 metric=0.1404 head_norm=0.878378 delta_norm=0.822962
[S14] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=3 head_norm_before_train=1.242163 (no previous merge yet)
[S2] round=3 local utility u=0.045265 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.760003398935338, 'loss_val': 1.2187611172740236, 'psi': 0.38906763960727525}-{'f1_val': 0.1417771333885667, 'auprc': 0.7458578735273242, 'loss_val': 1.2668543711858853, 'psi': 0.38340942944406975}
[S3] START round=3 head_norm_before_train=1.173960 (no previous merge yet)
[S3] round=3 local utility u=0.026620 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8638736165556224, 'loss_val': 1.2428488476495125, 'psi': 0.4294534859907132}-{'f1_val': 0.13984006561410703, 'auprc': 0.8599139342295146, 'loss_val': 1.2842106152819868, 'psi': 0.42786961306027005}
[S4] START round=3 head_norm_before_train=0.855920 cos_to_last_merge=0.9973 (last merge round=1)
[S4] round=3 local utility u=0.029768 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7792130466133367, 'loss_val': 1.2806025402681327, 'psi': 0.3958211959824452}-{'f1_val': 0.14022662889518414, 'auprc': 0.7729830806700464, 'loss_val': 1.3214487444191139, 'psi': 0.39332920960512907}
[S5] START round=3 head_norm_before_train=0.857165 cos_to_last_merge=0.9967 (last merge round=1)
[S5] round=3 local utility u=0.020783 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.728796395423576, 'loss_val': 1.2705522946903218, 'psi': 0.37687570102657325}-{'f1_val': 0.14226190476190476, 'auprc': 0.7291149570549184, 'loss_val': 1.313074383263485, 'psi': 0.3770031256791102}
[S6] START round=3 head_norm_before_train=0.746016 cos_to_last_merge=1.0000 (last merge round=2)
[S6] round=3 local utility u=0.235505 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8220342852062712, 'loss_val': 1.3287152144180594, 'psi': 0.4136694833132777}-{'f1_val': 0.14142628205128205, 'auprc': 0.6628714079229274, 'loss_val': 1.3222361774780174, 'psi': 0.35000433239994017}
[S7] START round=3 head_norm_before_train=0.855967 cos_to_last_merge=0.9971 (last merge round=1)
[S7] round=3 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.779154277618919, 'loss_val': 1.3069872129028415, 'psi': 0.3968958046850226}-{'f1_val': 0.14205682272909165, 'auprc': 0.7998634751859307, 'loss_val': 1.3372498643408706, 'psi': 0.40517948371182727}
[S8] START round=3 head_norm_before_train=0.852949 cos_to_last_merge=1.0000 (last merge round=2)
[S8] round=3 local utility u=0.000000 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7661529978170896, 'loss_val': 1.2859685507711038, 'psi': 0.39043478856261016}-{'f1_val': 0.13995598239295717, 'auprc': 0.7691467107565781, 'loss_val': 1.2796300370344658, 'psi': 0.3916322737384056}
[S9] START round=3 head_norm_before_train=0.794974 cos_to_last_merge=0.9961 (last merge round=1)
[S9] round=3 local utility u=0.021714 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9984353936880404, 'loss_val': 1.2790861353930871, 'psi': 0.48421293175921376}-{'f1_val': 0.141397957139996, 'auprc': 0.9984498784539635, 'loss_val': 1.3225583583436802, 'psi': 0.48421872566558305}
[S10] START round=3 head_norm_before_train=1.198190 (no previous merge yet)
[S10] round=3 local utility u=0.027630 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6435005425936611, 'loss_val': 1.2564298375158611, 'psi': 0.3405731995624988}-{'f1_val': 0.13862163754172394, 'auprc': 0.63531870532119, 'loss_val': 1.2871434070908372, 'psi': 0.3373004646535103}
[S11] START round=3 head_norm_before_train=1.197172 (no previous merge yet)
[S11] round=3 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.8338145084672832, 'loss_val': 1.2259940729242391, 'psi': 0.41777401341077963}-{'f1_val': 0.41529358058659227, 'auprc': 0.7951257053606419, 'loss_val': 1.2949139061241983, 'psi': 0.5672264304962121}
[S13] START round=3 head_norm_before_train=1.212179 (no previous merge yet)
[S13] round=3 local utility u=0.026115 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7193959431868595, 'loss_val': 1.2328603302890913, 'psi': 0.37198983482097564}-{'f1_val': 0.1403857625770531, 'auprc': 0.7166785174789116, 'loss_val': 1.2769370928596198, 'psi': 0.37090286453779653}
[S14] START round=3 head_norm_before_train=0.878378 cos_to_last_merge=1.0000 (last merge round=2)
[S14] round=3 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8564515231565215, 'loss_val': 1.3190776392416377, 'psi': 0.4267953209922309}-{'f1_val': 0.14035785288270378, 'auprc': 0.8922328046277166, 'loss_val': 1.3173795238902775, 'psi': 0.44110783358070893}
[S15] START round=3 head_norm_before_train=1.163942 (no previous merge yet)
[S15] round=3 local utility u=0.044360 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7817698519662385, 'loss_val': 1.248002120981715, 'psi': 0.39654813160343044}-{'f1_val': 0.13973365136155833, 'auprc': 0.7638504759782352, 'loss_val': 1.2829637653104207, 'psi': 0.3893803812082291}
[S16] START round=3 head_norm_before_train=1.252073 (no previous merge yet)
[S16] round=3 local utility u=0.066184 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8582273141455938, 'loss_val': 1.2025457637584651, 'psi': 0.4276733957777594}-{'f1_val': 0.14063745019920318, 'auprc': 0.8329369102751885, 'loss_val': 1.259042629887105, 'psi': 0.41755723422959734}
[S17] START round=3 head_norm_before_train=1.194881 (no previous merge yet)
[S17] round=3 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.6631376143079453, 'loss_val': 1.2424162625025859, 'psi': 0.3498244237136087}-{'f1_val': 0.14094896331738438, 'auprc': 0.8851888687073662, 'loss_val': 1.3017012183983503, 'psi': 0.43864492547337713}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S10] → sending delta(kind=head bytes=1791) to S5@127.0.0.1:63205
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:63203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:63208
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:63204
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:63213
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:63203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S13@127.0.0.1:63213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:63205
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:63204
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:63212
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1804 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1791 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1802) from S13
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=1.242467)
[S3] loaded HEAD from S13 (vec_in norm=1.242467)
[S3] cosine check vs S13: cos=-0.0422
[S3] DROPPED delta from S13 (cos=-0.0422 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1801) from S2
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.272318)
[S4] loaded HEAD from S2 (vec_in norm=1.272318)
[S4] cosine check vs S2: cos=-0.0017
[S4] DROPPED delta from S2 (cos=-0.0017 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1804) from S15
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.193226)
[S13] loaded HEAD from S15 (vec_in norm=1.193226)
[S13] cosine check vs S15: cos=0.0831
[S13] BUFFERED delta from S15 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1797) from S3
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.203638)
[S11] loaded HEAD from S3 (vec_in norm=1.203638)
[S11] cosine check vs S3: cos=0.0098
[S11] BUFFERED delta from S3 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1797) from S9
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.830193)
[S5] loaded HEAD from S9 (vec_in norm=0.830193)
[S5] cosine check vs S9: cos=-0.0238
[S5] DROPPED delta from S9 (cos=-0.0238 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1799) from S16
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.285137)
[S4] loaded HEAD from S16 (vec_in norm=1.285137)
[S4] cosine check vs S16: cos=0.0004
[S4] BUFFERED delta from S16 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1798) from S4
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.887030)
[S7] loaded HEAD from S4 (vec_in norm=0.887030)
[S7] cosine check vs S4: cos=-0.0651
[S7] DROPPED delta from S4 (cos=-0.0651 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1791) from S10
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.226662)
[S5] loaded HEAD from S10 (vec_in norm=1.226662)
[S5] cosine check vs S10: cos=0.0049
[S5] BUFFERED delta from S10 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1801) from S6
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.758612)
[S13] loaded HEAD from S6 (vec_in norm=0.758612)
[S13] cosine check vs S6: cos=0.0216
[S13] BUFFERED delta from S6 (total buffered=2)
[S3] RECEIVED delta(kind=head bytes=1800) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.882713)
[S3] loaded HEAD from S5 (vec_in norm=0.882713)
[S3] cosine check vs S5: cos=-0.0858
[S3] DROPPED delta from S5 (cos=-0.0858 < 0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=3 metric=0.1404 head_norm=1.230135
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.562838e-01
[S11] stored merged vector for next round verification (round=3)
[S11] DEBUG after merge:  round=3 metric=0.1404 head_norm=0.864735 delta_norm=0.856284
[S11] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=3 metric=0.1404 head_norm=1.242467
[S13] _apply_head_vector_avg (torch): Δ‖w‖=6.846152e-01
[S13] stored merged vector for next round verification (round=3)
[S13] DEBUG after merge:  round=3 metric=0.1404 head_norm=0.735178 delta_norm=0.684615
[S13] aggregate: ACCEPT kept=['S15', 'S6'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=3 metric=0.1423 head_norm=0.882713
[S5] _apply_head_vector_avg (torch): Δ‖w‖=7.538546e-01
[S5] stored merged vector for next round verification (round=3)
[S5] DEBUG after merge:  round=3 metric=0.1423 head_norm=0.757393 delta_norm=0.753855
[S5] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=3 metric=0.1402 head_norm=0.887030
[S4] _apply_head_vector_avg (torch): Δ‖w‖=7.806301e-01
[S4] stored merged vector for next round verification (round=3)
[S4] DEBUG after merge:  round=3 metric=0.1402 head_norm=0.780907 delta_norm=0.780630
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=1.272318 (no previous merge yet)
[S2] round=4 local utility u=0.005500 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7480712177366364, 'loss_val': 1.171964467685636, 'psi': 0.38429476712779465}-{'f1_val': 0.1417771333885667, 'auprc': 0.760003398935338, 'loss_val': 1.2187611172740236, 'psi': 0.38906763960727525}
[S3] START round=4 head_norm_before_train=1.203638 (no previous merge yet)
[S3] round=4 local utility u=0.021935 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8639020587719928, 'loss_val': 1.199064991083275, 'psi': 0.4294648628772614}-{'f1_val': 0.13984006561410703, 'auprc': 0.8638736165556224, 'loss_val': 1.2428488476495125, 'psi': 0.4294534859907132}
[S4] START round=4 head_norm_before_train=0.780907 cos_to_last_merge=1.0000 (last merge round=3)
[S4] round=4 local utility u=0.000000 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.5938377111829234, 'loss_val': 1.285948725074424, 'psi': 0.3216710618102798}-{'f1_val': 0.14022662889518414, 'auprc': 0.7792130466133367, 'loss_val': 1.2806025402681327, 'psi': 0.3958211959824452}
[S5] START round=4 head_norm_before_train=0.757393 cos_to_last_merge=1.0000 (last merge round=3)
[S5] round=4 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7290076536190444, 'loss_val': 1.2752901094252218, 'psi': 0.3769602043047606}-{'f1_val': 0.14226190476190476, 'auprc': 0.728796395423576, 'loss_val': 1.2705522946903218, 'psi': 0.37687570102657325}
[S6] START round=4 head_norm_before_train=0.758612 cos_to_last_merge=0.9961 (last merge round=2)
[S6] round=4 local utility u=0.066601 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8543953035180223, 'loss_val': 1.2925963295793974, 'psi': 0.42661389063797817}-{'f1_val': 0.14142628205128205, 'auprc': 0.8220342852062712, 'loss_val': 1.3287152144180594, 'psi': 0.4136694833132777}
[S7] START round=4 head_norm_before_train=0.880459 cos_to_last_merge=0.9887 (last merge round=1)
[S7] round=4 local utility u=0.030525 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7887185262936034, 'loss_val': 1.2746295081440573, 'psi': 0.4007215041548964}-{'f1_val': 0.14205682272909165, 'auprc': 0.779154277618919, 'loss_val': 1.3069872129028415, 'psi': 0.3968958046850226}
[S8] START round=4 head_norm_before_train=0.879703 cos_to_last_merge=0.9976 (last merge round=2)
[S8] round=4 local utility u=0.029055 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7683957281577963, 'loss_val': 1.2345875467157459, 'psi': 0.39133188069889285}-{'f1_val': 0.13995598239295717, 'auprc': 0.7661529978170896, 'loss_val': 1.2859685507711038, 'psi': 0.39043478856261016}
[S9] START round=4 head_norm_before_train=0.830193 cos_to_last_merge=0.9862 (last merge round=1)
[S9] round=4 local utility u=0.036865 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9985526450824264, 'loss_val': 1.2057088741127484, 'psi': 0.4842598323169682}-{'f1_val': 0.141397957139996, 'auprc': 0.9984353936880404, 'loss_val': 1.2790861353930871, 'psi': 0.48421293175921376}
[S10] START round=4 head_norm_before_train=1.226662 (no previous merge yet)
[S10] round=4 local utility u=0.079015 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.684356551595001, 'loss_val': 1.2209673549448623, 'psi': 0.3569156031630348}-{'f1_val': 0.13862163754172394, 'auprc': 0.6435005425936611, 'loss_val': 1.2564298375158611, 'psi': 0.3405731995624988}
[S11] START round=4 head_norm_before_train=0.864735 cos_to_last_merge=1.0000 (last merge round=3)
[S11] round=4 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.8251563407589197, 'loss_val': 1.2340538853848615, 'psi': 0.41431074632743425}-{'f1_val': 0.14041368337311058, 'auprc': 0.8338145084672832, 'loss_val': 1.2259940729242391, 'psi': 0.41777401341077963}
[S13] START round=4 head_norm_before_train=0.735178 cos_to_last_merge=1.0000 (last merge round=3)
[S13] round=4 local utility u=0.000000 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7231150315851547, 'loss_val': 1.2448937100692015, 'psi': 0.3734774701802937}-{'f1_val': 0.1403857625770531, 'auprc': 0.7193959431868595, 'loss_val': 1.2328603302890913, 'psi': 0.37198983482097564}
[S14] START round=4 head_norm_before_train=0.902888 cos_to_last_merge=0.9974 (last merge round=2)
[S14] round=4 local utility u=0.021703 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8594809406000189, 'loss_val': 1.284759213331999, 'psi': 0.42800708796962983}-{'f1_val': 0.14035785288270378, 'auprc': 0.8564515231565215, 'loss_val': 1.3190776392416377, 'psi': 0.4267953209922309}
[S15] START round=4 head_norm_before_train=1.193226 (no previous merge yet)
[S15] round=4 local utility u=0.015130 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7766645956114194, 'loss_val': 1.2024255797902788, 'psi': 0.3945060290615028}-{'f1_val': 0.13973365136155833, 'auprc': 0.7817698519662385, 'loss_val': 1.248002120981715, 'psi': 0.39654813160343044}
[S16] START round=4 head_norm_before_train=1.285137 (no previous merge yet)
[S16] round=4 local utility u=0.033080 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8634910605975538, 'loss_val': 1.152176795326077, 'psi': 0.42977889435854344}-{'f1_val': 0.14063745019920318, 'auprc': 0.8582273141455938, 'loss_val': 1.2025457637584651, 'psi': 0.4276733957777594}
[S17] START round=4 head_norm_before_train=1.230820 (no previous merge yet)
[S17] round=4 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.6304923453261669, 'loss_val': 1.1777119486360446, 'psi': 0.3367663161208974}-{'f1_val': 0.14094896331738438, 'auprc': 0.6631376143079453, 'loss_val': 1.2424162625025859, 'psi': 0.3498244237136087}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:63204
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:63203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] → sending delta(kind=head bytes=1792) to S5@127.0.0.1:63205
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:63204
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] → sending delta(kind=head bytes=1794) to S10@127.0.0.1:63211
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:63202
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] → sending delta(kind=head bytes=1794) to S11@127.0.0.1:63212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:63213
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:63205
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S15] → sending delta(kind=head bytes=1806) to S13@127.0.0.1:63213
[S8] sending update (kind=head size=1796 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1794 to 1 peers)
[S3] sending update (kind=head size=1794 to 1 peers)
[S9] sending update (kind=head size=1792 to 1 peers)
[S6] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1806 to 1 peers)
[S16] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1795) from S10
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.244314)
[S5] loaded HEAD from S10 (vec_in norm=1.244314)
[S5] cosine check vs S10: cos=0.7878
[S5] BUFFERED delta from S10 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1798) from S2
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.304703)
[S4] loaded HEAD from S2 (vec_in norm=1.304703)
[S4] cosine check vs S2: cos=-0.0252
[S4] DROPPED delta from S2 (cos=-0.0252 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1796) from S6
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.777257)
[S13] loaded HEAD from S6 (vec_in norm=0.777257)
[S13] cosine check vs S6: cos=0.2430
[S13] BUFFERED delta from S6 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1794) from S3
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.233546)
[S11] loaded HEAD from S3 (vec_in norm=1.233546)
[S11] cosine check vs S3: cos=0.6844
[S11] BUFFERED delta from S3 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1796) from S7
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.909086)
[S3] loaded HEAD from S7 (vec_in norm=0.909086)
[S3] cosine check vs S7: cos=-0.0307
[S3] DROPPED delta from S7 (cos=-0.0307 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1802) from S16
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.313151)
[S4] loaded HEAD from S16 (vec_in norm=1.313151)
[S4] cosine check vs S16: cos=0.7983
[S4] BUFFERED delta from S16 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1806) from S15
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.225393)
[S13] loaded HEAD from S15 (vec_in norm=1.225393)
[S13] cosine check vs S15: cos=0.4509
[S13] BUFFERED delta from S15 (total buffered=2)
[S5] RECEIVED delta(kind=head bytes=1792) from S9
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.875233)
[S5] loaded HEAD from S9 (vec_in norm=0.875233)
[S5] cosine check vs S9: cos=0.3323
[S5] BUFFERED delta from S9 (total buffered=2)
[S10] RECEIVED delta(kind=head bytes=1794) from S14
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.939942)
[S10] loaded HEAD from S14 (vec_in norm=0.939942)
[S10] cosine check vs S14: cos=0.0891
[S10] BUFFERED delta from S14 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1796) from S8
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=0.909563)
[S2] loaded HEAD from S8 (vec_in norm=0.909563)
[S2] cosine check vs S8: cos=-0.0457
[S2] DROPPED delta from S8 (cos=-0.0457 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=4 metric=0.1423 head_norm=0.782890
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.281700e-01
[S5] stored merged vector for next round verification (round=4)
[S5] DEBUG after merge:  round=4 metric=0.1423 head_norm=0.777991 delta_norm=0.328170
[S5] aggregate: ACCEPT kept=['S10', 'S9'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=4 metric=0.1404 head_norm=0.896205
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.504652e-01
[S11] stored merged vector for next round verification (round=4)
[S11] DEBUG after merge:  round=4 metric=0.1404 head_norm=0.979536 delta_norm=0.450465
[S11] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=4 metric=0.1404 head_norm=0.759890
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.603387e-01
[S13] stored merged vector for next round verification (round=4)
[S13] DEBUG after merge:  round=4 metric=0.1404 head_norm=0.641507 delta_norm=0.360339
[S13] aggregate: ACCEPT kept=['S6', 'S15'] (k=2/2) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=4 metric=0.1402 head_norm=0.806795
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.134246e-01
[S4] stored merged vector for next round verification (round=4)
[S4] DEBUG after merge:  round=4 metric=0.1970 head_norm=1.008326 delta_norm=0.413425
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=4 metric=0.1386 head_norm=1.244314
[S10] _apply_head_vector_avg (torch): Δ‖w‖=7.455545e-01
[S10] stored merged vector for next round verification (round=4)
[S10] DEBUG after merge:  round=4 metric=0.1386 head_norm=0.812436 delta_norm=0.745555
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=5 head_norm_before_train=1.304703 (no previous merge yet)
[S2] round=5 local utility u=0.079669 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7756932502340074, 'loss_val': 1.0954928815180234, 'psi': 0.39534358012674303}-{'f1_val': 0.1417771333885667, 'auprc': 0.7480712177366364, 'loss_val': 1.171964467685636, 'psi': 0.38429476712779465}
[S3] START round=5 head_norm_before_train=1.233546 (no previous merge yet)
[S3] round=5 local utility u=0.045322 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8639658552116105, 'loss_val': 1.1086128815889738, 'psi': 0.42949038145310847}-{'f1_val': 0.13984006561410703, 'auprc': 0.8639020587719928, 'loss_val': 1.199064991083275, 'psi': 0.4294648628772614}
[S4] START round=5 head_norm_before_train=1.008326 cos_to_last_merge=1.0000 (last merge round=4)
[S4] round=5 local utility u=0.001111 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.5771166123260525, 'loss_val': 1.2335643982049243, 'psi': 0.3149826222675315}-{'f1_val': 0.14022662889518414, 'auprc': 0.5938377111829234, 'loss_val': 1.285948725074424, 'psi': 0.3216710618102798}
[S5] START round=5 head_norm_before_train=0.777991 cos_to_last_merge=1.0000 (last merge round=4)
[S5] round=5 local utility u=0.010427 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7333944267372726, 'loss_val': 1.2675955915387256, 'psi': 0.3787149135520519}-{'f1_val': 0.14226190476190476, 'auprc': 0.7290076536190444, 'loss_val': 1.2752901094252218, 'psi': 0.3769602043047606}
[S6] START round=5 head_norm_before_train=0.777257 cos_to_last_merge=0.9851 (last merge round=2)
[S6] round=5 local utility u=0.023647 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.856484685811222, 'loss_val': 1.2515702572357914, 'psi': 0.427449643555258}-{'f1_val': 0.14142628205128205, 'auprc': 0.8543953035180223, 'loss_val': 1.2925963295793974, 'psi': 0.42661389063797817}
[S7] START round=5 head_norm_before_train=0.909086 cos_to_last_merge=0.9777 (last merge round=1)
[S7] round=5 local utility u=0.022125 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7935962560259722, 'loss_val': 1.245012326600576, 'psi': 0.4026725960478439}-{'f1_val': 0.14205682272909165, 'auprc': 0.7887185262936034, 'loss_val': 1.2746295081440573, 'psi': 0.4007215041548964}
[S8] START round=5 head_norm_before_train=0.909563 cos_to_last_merge=0.9916 (last merge round=2)
[S8] round=5 local utility u=0.052999 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7763691412598634, 'loss_val': 1.1525092845881646, 'psi': 0.3945212459397197}-{'f1_val': 0.13995598239295717, 'auprc': 0.7683957281577963, 'loss_val': 1.2345875467157459, 'psi': 0.39133188069889285}
[S9] START round=5 head_norm_before_train=0.875233 cos_to_last_merge=0.9713 (last merge round=1)
[S9] round=5 local utility u=0.062743 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9983961296587909, 'loss_val': 1.079754158699977, 'psi': 0.484197226147514}-{'f1_val': 0.141397957139996, 'auprc': 0.9985526450824264, 'loss_val': 1.2057088741127484, 'psi': 0.4842598323169682}
[S10] START round=5 head_norm_before_train=0.812436 cos_to_last_merge=1.0000 (last merge round=4)
[S10] round=5 local utility u=0.489835 metrics={'f1_val': 0.30736779329254044, 'auprc': 0.6760566433713135, 'loss_val': 1.2288737726643144, 'psi': 0.4548433333240497}-{'f1_val': 0.13862163754172394, 'auprc': 0.684356551595001, 'loss_val': 1.2209673549448623, 'psi': 0.3569156031630348}
[S11] START round=5 head_norm_before_train=0.979536 cos_to_last_merge=1.0000 (last merge round=4)
[S11] round=5 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7016002799579236, 'loss_val': 1.2173051849391747, 'psi': 0.3648883220070358}-{'f1_val': 0.14041368337311058, 'auprc': 0.8251563407589197, 'loss_val': 1.2340538853848615, 'psi': 0.41431074632743425}
[S13] START round=5 head_norm_before_train=0.641507 cos_to_last_merge=1.0000 (last merge round=4)
[S13] round=5 local utility u=0.000000 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.685290767784382, 'loss_val': 1.2329099172444595, 'psi': 0.3583477646599847}-{'f1_val': 0.1403857625770531, 'auprc': 0.7231150315851547, 'loss_val': 1.2448937100692015, 'psi': 0.3734774701802937}
[S14] START round=5 head_norm_before_train=0.939942 cos_to_last_merge=0.9900 (last merge round=2)
[S14] round=5 local utility u=0.035339 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.866619924848786, 'loss_val': 1.2354974202587696, 'psi': 0.43086268166913666}-{'f1_val': 0.14035785288270378, 'auprc': 0.8594809406000189, 'loss_val': 1.284759213331999, 'psi': 0.42800708796962983}
[S15] START round=5 head_norm_before_train=1.225393 (no previous merge yet)
[S15] round=5 local utility u=0.037825 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7765330567694048, 'loss_val': 1.1263810898485183, 'psi': 0.3944534135246969}-{'f1_val': 0.13973365136155833, 'auprc': 0.7766645956114194, 'loss_val': 1.2024255797902788, 'psi': 0.3945060290615028}
[S16] START round=5 head_norm_before_train=1.313151 (no previous merge yet)
[S16] round=5 local utility u=0.842496 metrics={'f1_val': 0.41467924219943564, 'auprc': 0.8430172629892061, 'loss_val': 1.0500142279701585, 'psi': 0.5860144505153438}-{'f1_val': 0.14063745019920318, 'auprc': 0.8634910605975538, 'loss_val': 1.152176795326077, 'psi': 0.42977889435854344}
[S17] START round=5 head_norm_before_train=1.272347 (no previous merge yet)
[S17] round=5 local utility u=0.207802 metrics={'f1_val': 0.1656393213308196, 'auprc': 0.6883273795292923, 'loss_val': 1.083754842401622, 'psi': 0.3747145446102087}-{'f1_val': 0.14094896331738438, 'auprc': 0.6304923453261669, 'loss_val': 1.1777119486360446, 'psi': 0.3367663161208974}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:63203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:63205
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S4] → sending delta(kind=head bytes=1788) to S7@127.0.0.1:63208
[S10] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1795 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1798) from S10
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=0.832816)
[S5] loaded HEAD from S10 (vec_in norm=0.832816)
[S5] cosine check vs S10: cos=0.7619
[S5] BUFFERED delta from S10 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1795) from S7
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.938168)
[S3] loaded HEAD from S7 (vec_in norm=0.938168)
[S3] cosine check vs S7: cos=-0.0250
[S3] DROPPED delta from S7 (cos=-0.0250 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S13@127.0.0.1:63213
[S4] sending update (kind=head size=1788 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1788) from S4
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.026551)
[S7] loaded HEAD from S4 (vec_in norm=1.026551)
[S7] cosine check vs S4: cos=0.0660
[S7] BUFFERED delta from S4 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:63205
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:63213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:63202
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:63212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:63211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:63203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:63204
[S15] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] → sending delta(kind=head bytes=1805) to S4@127.0.0.1:63204
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] RECEIVED delta(kind=head bytes=1804) from S15
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.260347)
[S13] loaded HEAD from S15 (vec_in norm=1.260347)
[S13] cosine check vs S15: cos=0.7072
[S13] BUFFERED delta from S15 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:63202
[S9] sending update (kind=head size=1794 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1795 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1795) from S3
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.262168)
[S11] loaded HEAD from S3 (vec_in norm=1.262168)
[S11] cosine check vs S3: cos=0.9293
[S11] BUFFERED delta from S3 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1794) from S9
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.929145)
[S5] loaded HEAD from S9 (vec_in norm=0.929145)
[S5] cosine check vs S9: cos=0.5905
[S5] BUFFERED delta from S9 (total buffered=2)
[S2] RECEIVED delta(kind=head bytes=1799) from S8
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=0.948263)
[S2] loaded HEAD from S8 (vec_in norm=0.948263)
[S2] cosine check vs S8: cos=-0.0537
[S2] DROPPED delta from S8 (cos=-0.0537 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1798) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.802375)
[S3] loaded HEAD from S5 (vec_in norm=0.802375)
[S3] cosine check vs S5: cos=-0.0353
[S3] DROPPED delta from S5 (cos=-0.0353 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1795) from S14
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=0.987458)
[S10] loaded HEAD from S14 (vec_in norm=0.987458)
[S10] cosine check vs S14: cos=0.6335
[S10] BUFFERED delta from S14 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1800) from S16
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.340133)
[S4] loaded HEAD from S16 (vec_in norm=1.340133)
[S4] cosine check vs S16: cos=0.9548
[S4] BUFFERED delta from S16 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1798) from S6
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.804992)
[S13] loaded HEAD from S6 (vec_in norm=0.804992)
[S13] cosine check vs S6: cos=0.4100
[S13] BUFFERED delta from S6 (total buffered=2)
[S2] sending update (kind=head size=1805 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1805) from S2
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.328534)
[S4] loaded HEAD from S2 (vec_in norm=1.328534)
[S4] cosine check vs S2: cos=-0.0280
[S4] DROPPED delta from S2 (cos=-0.0280 < 0.0)
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1797) from S17
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.299061)
[S2] loaded HEAD from S17 (vec_in norm=1.299061)
[S2] cosine check vs S17: cos=0.0110
[S2] BUFFERED delta from S17 (total buffered=1)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=5 metric=0.1402 head_norm=1.026551
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.359650e-01
[S4] stored merged vector for next round verification (round=5)
[S4] DEBUG after merge:  round=5 metric=0.1408 head_norm=1.170129 delta_norm=0.235965
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.393 → S7@127.0.0.1:63208
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=5 metric=0.1421 head_norm=0.938168
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.720821e-01
[S7] stored merged vector for next round verification (round=5)
[S7] DEBUG after merge:  round=5 metric=0.1421 head_norm=0.717836 delta_norm=0.672082
[S7] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.367 → S3@127.0.0.1:63203
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=5 metric=0.1418 head_norm=1.328534
[S2] _apply_head_vector_avg (torch): Δ‖w‖=9.239221e-01
[S2] stored merged vector for next round verification (round=5)
[S2] DEBUG after merge:  round=5 metric=0.1624 head_norm=0.934157 delta_norm=0.923922
[S2] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.369 → S4@127.0.0.1:63204
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=5 metric=0.1423 head_norm=0.802375
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.613156e-01
[S5] stored merged vector for next round verification (round=5)
[S5] DEBUG after merge:  round=5 metric=0.1423 head_norm=0.736862 delta_norm=0.261316
[S5] aggregate: ACCEPT kept=['S10', 'S9'] (k=2/2) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.378 → S3@127.0.0.1:63203
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=5 metric=0.3074 head_norm=0.832816
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.958391e-01
[S10] stored merged vector for next round verification (round=5)
[S10] DEBUG after merge:  round=5 metric=0.2288 head_norm=0.823189 delta_norm=0.395839
[S10] aggregate: ROLLBACK (f1_val pre=0.307 post=0.229 tol_abs=0.005 tol_rel=0.0)
[S10] ⇄ pheromone p=0.446 → S5@127.0.0.1:63205
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=5 metric=0.1404 head_norm=0.995685
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.493790e-01
[S11] stored merged vector for next round verification (round=5)
[S11] DEBUG after merge:  round=5 metric=0.1404 head_norm=1.109071 delta_norm=0.249379
[S11] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.428 → S15@127.0.0.1:63215
[S6] ⇄ pheromone p=0.373 → S13@127.0.0.1:63213
[S9] ⇄ pheromone p=0.350 → S5@127.0.0.1:63205
[S14] ⇄ pheromone p=0.350 → S10@127.0.0.1:63211
[S3] ⇄ pheromone p=0.360 → S11@127.0.0.1:63212
[S8] ⇄ pheromone p=0.343 → S2@127.0.0.1:63202
[S15] ⇄ pheromone p=0.385 → S13@127.0.0.1:63213
[S17] ⇄ pheromone p=0.371 → S2@127.0.0.1:63202
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=5 metric=0.1404 head_norm=0.667361
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.079450e-01
[S13] stored merged vector for next round verification (round=5)
[S13] DEBUG after merge:  round=5 metric=0.1404 head_norm=0.671417 delta_norm=0.207945
[S13] aggregate: ACCEPT kept=['S15', 'S6'] (k=2/2) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.335 → S3@127.0.0.1:63203
[S16] ⇄ pheromone p=0.514 → S4@127.0.0.1:63204
[S2] START round=6 head_norm_before_train=0.934157 cos_to_last_merge=1.0000 (last merge round=5)
[S2] round=6 local utility u=0.091709 metrics={'f1_val': 0.1673185040332437, 'auprc': 0.775611389947335, 'loss_val': 1.065077070113475, 'psi': 0.4106356583988802}-{'f1_val': 0.1417771333885667, 'auprc': 0.7756932502340074, 'loss_val': 1.0954928815180234, 'psi': 0.39534358012674303}
[S3] START round=6 head_norm_before_train=1.262168 (no previous merge yet)
[S3] round=6 local utility u=0.851388 metrics={'f1_val': 0.39651525753011657, 'auprc': 0.8659054573795673, 'loss_val': 0.9517075381349467, 'psi': 0.5842713374698969}-{'f1_val': 0.13984006561410703, 'auprc': 0.8639658552116105, 'loss_val': 1.1086128815889738, 'psi': 0.42949038145310847}
[S4] START round=6 head_norm_before_train=1.170129 cos_to_last_merge=1.0000 (last merge round=5)
[S4] round=6 local utility u=0.486187 metrics={'f1_val': 0.2844018957843527, 'auprc': 0.5771962111116631, 'loss_val': 1.1264804669064188, 'psi': 0.4015196219152769}-{'f1_val': 0.14022662889518414, 'auprc': 0.5771166123260525, 'loss_val': 1.2335643982049243, 'psi': 0.3149826222675315}
[S5] START round=6 head_norm_before_train=0.736862 cos_to_last_merge=1.0000 (last merge round=5)
[S5] round=6 local utility u=0.030284 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7484554100733041, 'loss_val': 1.2522097366427467, 'psi': 0.3847393068864645}-{'f1_val': 0.14226190476190476, 'auprc': 0.7333944267372726, 'loss_val': 1.2675955915387256, 'psi': 0.3787149135520519}
[S6] START round=6 head_norm_before_train=0.804992 cos_to_last_merge=0.9686 (last merge round=2)
[S6] round=6 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8323737582051507, 'loss_val': 1.22261270701435, 'psi': 0.4178052725128295}-{'f1_val': 0.14142628205128205, 'auprc': 0.856484685811222, 'loss_val': 1.2515702572357914, 'psi': 0.427449643555258}
[S7] START round=6 head_norm_before_train=0.717836 cos_to_last_merge=1.0000 (last merge round=5)
[S7] round=6 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7915238171352963, 'loss_val': 1.2520699740434755, 'psi': 0.4018436204915735}-{'f1_val': 0.14205682272909165, 'auprc': 0.7935962560259722, 'loss_val': 1.245012326600576, 'psi': 0.4026725960478439}
[S8] START round=6 head_norm_before_train=0.948263 cos_to_last_merge=0.9825 (last merge round=2)
[S8] round=6 local utility u=1.000000 metrics={'f1_val': 0.7148108482281725, 'auprc': 0.7771089341613208, 'loss_val': 1.0679328679403994, 'psi': 0.7397300826014318}-{'f1_val': 0.13995598239295717, 'auprc': 0.7763691412598634, 'loss_val': 1.1525092845881646, 'psi': 0.3945212459397197}
[S9] START round=6 head_norm_before_train=0.929145 cos_to_last_merge=0.9542 (last merge round=1)
[S9] round=6 local utility u=1.000000 metrics={'f1_val': 0.7002577766239845, 'auprc': 0.9984597198067876, 'loss_val': 0.8501393302188762, 'psi': 0.8195385538971057}-{'f1_val': 0.141397957139996, 'auprc': 0.9983961296587909, 'loss_val': 1.079754158699977, 'psi': 0.484197226147514}
[S10] START round=6 head_norm_before_train=0.823189 cos_to_last_merge=1.0000 (last merge round=5)
[S10] round=6 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7981039447624152, 'loss_val': 1.1856974477670539, 'psi': 0.40241456043000046}-{'f1_val': 0.30736779329254044, 'auprc': 0.6760566433713135, 'loss_val': 1.2288737726643144, 'psi': 0.4548433333240497}
[S11] START round=6 head_norm_before_train=1.109071 cos_to_last_merge=1.0000 (last merge round=5)
[S11] round=6 local utility u=0.344740 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.9073035825139568, 'loss_val': 1.1449341915011535, 'psi': 0.4471696430294491}-{'f1_val': 0.14041368337311058, 'auprc': 0.7016002799579236, 'loss_val': 1.2173051849391747, 'psi': 0.3648883220070358}
[S13] START round=6 head_norm_before_train=0.671417 cos_to_last_merge=1.0000 (last merge round=5)
[S13] round=6 local utility u=0.000000 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5659053371560935, 'loss_val': 1.2017440961077672, 'psi': 0.31059359240866924}-{'f1_val': 0.1403857625770531, 'auprc': 0.685290767784382, 'loss_val': 1.2329099172444595, 'psi': 0.3583477646599847}
[S14] START round=6 head_norm_before_train=0.987458 cos_to_last_merge=0.9796 (last merge round=2)
[S14] round=6 local utility u=0.081438 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8933536949337704, 'loss_val': 1.1528230036957063, 'psi': 0.44155618970313043}-{'f1_val': 0.14035785288270378, 'auprc': 0.866619924848786, 'loss_val': 1.2354974202587696, 'psi': 0.43086268166913666}
[S15] START round=6 head_norm_before_train=1.260347 (no previous merge yet)
[S15] round=6 local utility u=0.893958 metrics={'f1_val': 0.4157993423538048, 'auprc': 0.7776303171300754, 'loss_val': 0.9981508909233824, 'psi': 0.5605317322643131}-{'f1_val': 0.13973365136155833, 'auprc': 0.7765330567694048, 'loss_val': 1.1263810898485183, 'psi': 0.3944534135246969}
[S16] START round=6 head_norm_before_train=1.340133 (no previous merge yet)
[S16] round=6 local utility u=0.000000 metrics={'f1_val': 0.4171583814486223, 'auprc': 0.7777255938331742, 'loss_val': 0.9055284249300214, 'psi': 0.561385266402443}-{'f1_val': 0.41467924219943564, 'auprc': 0.8430172629892061, 'loss_val': 1.0500142279701585, 'psi': 0.5860144505153438}
[S17] START round=6 head_norm_before_train=1.299061 (no previous merge yet)
[S17] round=6 local utility u=0.776403 metrics={'f1_val': 0.39198366286064146, 'auprc': 0.7315917573759642, 'loss_val': 1.0188085886136906, 'psi': 0.5278269006667705}-{'f1_val': 0.1656393213308196, 'auprc': 0.6883273795292923, 'loss_val': 1.083754842401622, 'psi': 0.3747145446102087}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S14] → sending delta(kind=head bytes=1789) to S10@127.0.0.1:63211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:63203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:63208
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S9] → sending delta(kind=head bytes=1788) to S5@127.0.0.1:63205
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:63212
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S2@127.0.0.1:63202
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:63204
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:63215
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:63213
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:63202
[S11] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1804 to 1 peers)
[S9] sending update (kind=head size=1788 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1789 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1797) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.755293)
[S3] loaded HEAD from S5 (vec_in norm=0.755293)
[S3] cosine check vs S5: cos=-0.0443
[S3] DROPPED delta from S5 (cos=-0.0443 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1804) from S8
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=0.976916)
[S2] loaded HEAD from S8 (vec_in norm=0.976916)
[S2] cosine check vs S8: cos=-0.1238
[S2] DROPPED delta from S8 (cos=-0.1238 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1788) from S9
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=0.984323)
[S5] loaded HEAD from S9 (vec_in norm=0.984323)
[S5] cosine check vs S9: cos=0.7500
[S5] BUFFERED delta from S9 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1799) from S2
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=0.962566)
[S4] loaded HEAD from S2 (vec_in norm=0.962566)
[S4] cosine check vs S2: cos=0.0048
[S4] BUFFERED delta from S2 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1802) from S15
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.295479)
[S13] loaded HEAD from S15 (vec_in norm=1.295479)
[S13] cosine check vs S15: cos=0.7859
[S13] BUFFERED delta from S15 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1801) from S4
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.190425)
[S7] loaded HEAD from S4 (vec_in norm=1.190425)
[S7] cosine check vs S4: cos=0.7358
[S7] BUFFERED delta from S4 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1789) from S14
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.046164)
[S10] loaded HEAD from S14 (vec_in norm=1.046164)
[S10] cosine check vs S14: cos=0.8999
[S10] BUFFERED delta from S14 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1797) from S3
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.296001)
[S11] loaded HEAD from S3 (vec_in norm=1.296001)
[S11] cosine check vs S3: cos=0.9767
[S11] BUFFERED delta from S3 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1800) from S11
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.120710)
[S15] loaded HEAD from S11 (vec_in norm=1.120710)
[S15] cosine check vs S11: cos=0.0232
[S15] BUFFERED delta from S11 (total buffered=1)
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1801) from S17
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.333658)
[S2] loaded HEAD from S17 (vec_in norm=1.333658)
[S2] cosine check vs S17: cos=0.6830
[S2] BUFFERED delta from S17 (total buffered=1)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=6 metric=0.1421 head_norm=0.743002
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.085457e-01
[S7] stored merged vector for next round verification (round=6)
[S7] DEBUG after merge:  round=6 metric=0.1421 head_norm=0.904252 delta_norm=0.408546
[S7] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=6 metric=0.1673 head_norm=0.962566
[S2] _apply_head_vector_avg (torch): Δ‖w‖=4.877739e-01
[S2] stored merged vector for next round verification (round=6)
[S2] DEBUG after merge:  round=6 metric=0.1674 head_norm=1.055777 delta_norm=0.487774
[S2] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=6 metric=0.1423 head_norm=0.755293
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.256381e-01
[S5] stored merged vector for next round verification (round=6)
[S5] DEBUG after merge:  round=6 metric=0.1423 head_norm=0.814641 delta_norm=0.325638
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=6 metric=0.2844 head_norm=1.190425
[S4] _apply_head_vector_avg (torch): Δ‖w‖=7.636597e-01
[S4] stored merged vector for next round verification (round=6)
[S4] DEBUG after merge:  round=6 metric=0.2048 head_norm=0.767233 delta_norm=0.763660
[S4] aggregate: ROLLBACK (f1_val pre=0.284 post=0.205 tol_abs=0.005 tol_rel=0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=6 metric=0.1386 head_norm=0.844527
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.332343e-01
[S10] stored merged vector for next round verification (round=6)
[S10] DEBUG after merge:  round=6 metric=0.1386 head_norm=0.921653 delta_norm=0.233234
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=6 metric=0.4158 head_norm=1.295479
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.466087e-01
[S15] stored merged vector for next round verification (round=6)
[S15] DEBUG after merge:  round=6 metric=0.3806 head_norm=0.866246 delta_norm=0.846609
[S15] aggregate: ROLLBACK (f1_val pre=0.416 post=0.381 tol_abs=0.005 tol_rel=0.0)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=6 metric=0.1404 head_norm=0.695785
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.317511e-01
[S13] stored merged vector for next round verification (round=6)
[S13] DEBUG after merge:  round=6 metric=0.1404 head_norm=0.945929 delta_norm=0.431751
[S13] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=6 metric=0.1404 head_norm=1.120710
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.568994e-01
[S11] stored merged vector for next round verification (round=6)
[S11] DEBUG after merge:  round=6 metric=0.1404 head_norm=1.201327 delta_norm=0.156899
[S11] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=7 head_norm_before_train=1.055777 cos_to_last_merge=1.0000 (last merge round=6)
[S2] round=7 local utility u=0.000000 metrics={'f1_val': 0.16752325012236907, 'auprc': 0.7046888310459323, 'loss_val': 1.022885913088553, 'psi': 0.3823894824917944}-{'f1_val': 0.1673185040332437, 'auprc': 0.775611389947335, 'loss_val': 1.065077070113475, 'psi': 0.4106356583988802}
[S3] START round=7 head_norm_before_train=1.296001 (no previous merge yet)
[S3] round=7 local utility u=0.284393 metrics={'f1_val': 0.39635856801559805, 'auprc': 0.9985359582342905, 'loss_val': 0.7798736075427777, 'psi': 0.6372295241030751}-{'f1_val': 0.39651525753011657, 'auprc': 0.8659054573795673, 'loss_val': 0.9517075381349467, 'psi': 0.5842713374698969}
[S4] START round=7 head_norm_before_train=0.767233 cos_to_last_merge=1.0000 (last merge round=6)
[S4] round=7 local utility u=0.508298 metrics={'f1_val': 0.41390996828498405, 'auprc': 0.6395299264151734, 'loss_val': 1.073933707623163, 'psi': 0.5041579515370598}-{'f1_val': 0.2844018957843527, 'auprc': 0.5771962111116631, 'loss_val': 1.1264804669064188, 'psi': 0.4015196219152769}
[S5] START round=7 head_norm_before_train=0.814641 cos_to_last_merge=1.0000 (last merge round=6)
[S5] round=7 local utility u=0.052419 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.771721636152814, 'loss_val': 1.2171713043176111, 'psi': 0.39404579731826844}-{'f1_val': 0.14226190476190476, 'auprc': 0.7484554100733041, 'loss_val': 1.2522097366427467, 'psi': 0.3847393068864645}
[S6] START round=7 head_norm_before_train=0.836842 cos_to_last_merge=0.9482 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.948
[S6] round=7 local utility u=0.580732 metrics={'f1_val': 0.38109489892905457, 'auprc': 0.7082147410215296, 'loss_val': 1.1266833731594232, 'psi': 0.5119428357660446}-{'f1_val': 0.14142628205128205, 'auprc': 0.8323737582051507, 'loss_val': 1.22261270701435, 'psi': 0.4178052725128295}
[S7] START round=7 head_norm_before_train=0.904252 cos_to_last_merge=1.0000 (last merge round=6)
[S7] round=7 local utility u=0.009379 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7922920605987108, 'loss_val': 1.2356165519639408, 'psi': 0.40215091787693935}-{'f1_val': 0.14205682272909165, 'auprc': 0.7915238171352963, 'loss_val': 1.2520699740434755, 'psi': 0.4018436204915735}
[S8] START round=7 head_norm_before_train=0.976916 cos_to_last_merge=0.9738 (last merge round=2)
[S8] round=7 local utility u=0.068596 metrics={'f1_val': 0.7155419475775954, 'auprc': 0.7771076406988755, 'loss_val': 0.93512290170587, 'psi': 0.7401682248261074}-{'f1_val': 0.7148108482281725, 'auprc': 0.7771089341613208, 'loss_val': 1.0679328679403994, 'psi': 0.7397300826014318}
[S9] START round=7 head_norm_before_train=0.984323 cos_to_last_merge=0.9375 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.937
[S9] round=7 local utility u=0.119254 metrics={'f1_val': 0.7020085231425305, 'auprc': 0.9984656979228588, 'loss_val': 0.6221535478564408, 'psi': 0.8205913930546618}-{'f1_val': 0.7002577766239845, 'auprc': 0.9984597198067876, 'loss_val': 0.8501393302188762, 'psi': 0.8195385538971057}
[S10] START round=7 head_norm_before_train=0.921653 cos_to_last_merge=1.0000 (last merge round=6)
[S10] round=7 local utility u=0.229556 metrics={'f1_val': 0.28349092627904154, 'auprc': 0.6355572544183435, 'loss_val': 1.1081619486434902, 'psi': 0.42431745753476235}-{'f1_val': 0.13862163754172394, 'auprc': 0.7981039447624152, 'loss_val': 1.1856974477670539, 'psi': 0.40241456043000046}
[S11] START round=7 head_norm_before_train=1.201327 cos_to_last_merge=1.0000 (last merge round=6)
[S11] round=7 local utility u=0.795599 metrics={'f1_val': 0.3966199105536595, 'auprc': 0.893529360142668, 'loss_val': 1.049650680485743, 'psi': 0.5953836903892629}-{'f1_val': 0.14041368337311058, 'auprc': 0.9073035825139568, 'loss_val': 1.1449341915011535, 'psi': 0.4471696430294491}
[S13] START round=7 head_norm_before_train=0.945929 cos_to_last_merge=1.0000 (last merge round=6)
[S13] round=7 local utility u=1.000000 metrics={'f1_val': 0.5629479050067423, 'auprc': 0.7314391397230184, 'loss_val': 1.1653107829655514, 'psi': 0.6303443988932527}-{'f1_val': 0.1403857625770531, 'auprc': 0.5659053371560935, 'loss_val': 1.2017440961077672, 'psi': 0.31059359240866924}
[S14] START round=7 head_norm_before_train=1.046164 cos_to_last_merge=0.9677 (last merge round=2)
[S14] round=7 local utility u=1.000000 metrics={'f1_val': 0.5202072139285323, 'auprc': 0.999455953255293, 'loss_val': 0.941610923923575, 'psi': 0.7119067096592366}-{'f1_val': 0.14035785288270378, 'auprc': 0.8933536949337704, 'loss_val': 1.1528230036957063, 'psi': 0.44155618970313043}
[S15] START round=7 head_norm_before_train=0.866246 cos_to_last_merge=1.0000 (last merge round=6)
[S15] round=7 local utility u=0.788615 metrics={'f1_val': 0.6709556191152933, 'auprc': 0.7858822274004836, 'loss_val': 0.9766141538986618, 'psi': 0.7169262624293695}-{'f1_val': 0.4157993423538048, 'auprc': 0.7776303171300754, 'loss_val': 0.9981508909233824, 'psi': 0.5605317322643131}
[S16] START round=7 head_norm_before_train=1.366772 (no previous merge yet)
[S16] round=7 local utility u=0.000000 metrics={'f1_val': 0.3947458281694566, 'auprc': 0.7546514330371696, 'loss_val': 0.8014379611914303, 'psi': 0.5387080701165419}-{'f1_val': 0.4171583814486223, 'auprc': 0.7777255938331742, 'loss_val': 0.9055284249300214, 'psi': 0.561385266402443}
[S17] START round=7 head_norm_before_train=1.333658 (no previous merge yet)
[S17] round=7 local utility u=0.168219 metrics={'f1_val': 0.3907912793961699, 'auprc': 0.803808360327455, 'loss_val': 0.8918661175677914, 'psi': 0.555998111768684}-{'f1_val': 0.39198366286064146, 'auprc': 0.7315917573759642, 'loss_val': 1.0188085886136906, 'psi': 0.5278269006667705}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:63202
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:63203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:63203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:63203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S10] → sending delta(kind=head bytes=1791) to S5@127.0.0.1:63205
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:63211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:63213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:63212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:63205
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:63208
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:63215
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:63213
[S11] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1793 to 1 peers)
[S10] sending update (kind=head size=1791 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1795 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1799) from S6
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.861988)
[S13] loaded HEAD from S6 (vec_in norm=0.861988)
[S13] cosine check vs S6: cos=0.1602
[S13] BUFFERED delta from S6 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1798) from S4
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.798974)
[S7] loaded HEAD from S4 (vec_in norm=0.798974)
[S7] cosine check vs S4: cos=0.7415
[S7] BUFFERED delta from S4 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1791) from S10
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=0.943771)
[S5] loaded HEAD from S10 (vec_in norm=0.943771)
[S5] cosine check vs S10: cos=0.4584
[S5] BUFFERED delta from S10 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1795) from S15
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.905818)
[S13] loaded HEAD from S15 (vec_in norm=0.905818)
[S13] cosine check vs S15: cos=0.7564
[S13] BUFFERED delta from S15 (total buffered=2)
[S3] RECEIVED delta(kind=head bytes=1798) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.825641)
[S3] loaded HEAD from S5 (vec_in norm=0.825641)
[S3] cosine check vs S5: cos=-0.0505
[S3] DROPPED delta from S5 (cos=-0.0505 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1795) from S7
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.921169)
[S3] loaded HEAD from S7 (vec_in norm=0.921169)
[S3] cosine check vs S7: cos=0.0468
[S3] BUFFERED delta from S7 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1800) from S8
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.015505)
[S2] loaded HEAD from S8 (vec_in norm=1.015505)
[S2] cosine check vs S8: cos=-0.1291
[S2] DROPPED delta from S8 (cos=-0.1291 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1799) from S14
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.100889)
[S10] loaded HEAD from S14 (vec_in norm=1.100889)
[S10] cosine check vs S14: cos=0.9621
[S10] BUFFERED delta from S14 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1799) from S3
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.339583)
[S11] loaded HEAD from S3 (vec_in norm=1.339583)
[S11] cosine check vs S3: cos=0.9860
[S11] BUFFERED delta from S3 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1797) from S13
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=0.959230)
[S3] loaded HEAD from S13 (vec_in norm=0.959230)
[S3] cosine check vs S13: cos=0.0055
[S3] BUFFERED delta from S13 (total buffered=2)
[S5] RECEIVED delta(kind=head bytes=1793) from S9
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.044013)
[S5] loaded HEAD from S9 (vec_in norm=1.044013)
[S5] cosine check vs S9: cos=0.9375
[S5] BUFFERED delta from S9 (total buffered=2)
[S15] RECEIVED delta(kind=head bytes=1795) from S11
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.216000)
[S15] loaded HEAD from S11 (vec_in norm=1.216000)
[S15] cosine check vs S11: cos=0.6301
[S15] BUFFERED delta from S11 (total buffered=1)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:63202
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1802) from S17
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.376933)
[S2] loaded HEAD from S17 (vec_in norm=1.376933)
[S2] cosine check vs S17: cos=0.9236
[S2] BUFFERED delta from S17 (total buffered=1)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=7 metric=0.3964 head_norm=1.339583
[S3] _apply_head_vector_avg (torch): Δ‖w‖=7.500278e-01
[S3] stored merged vector for next round verification (round=7)
[S3] DEBUG after merge:  round=7 metric=0.3964 head_norm=0.771316 delta_norm=0.750028
[S3] aggregate: ACCEPT kept=['S7', 'S13'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=7 metric=0.3966 head_norm=1.216000
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.234959e-01
[S11] stored merged vector for next round verification (round=7)
[S11] DEBUG after merge:  round=7 metric=0.3966 head_norm=1.273310 delta_norm=0.123496
[S11] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=7 metric=0.5629 head_norm=0.959230
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.630186e-01
[S13] stored merged vector for next round verification (round=7)
[S13] DEBUG after merge:  round=7 metric=0.4169 head_norm=0.725701 delta_norm=0.363019
[S13] aggregate: ROLLBACK (f1_val pre=0.563 post=0.417 tol_abs=0.005 tol_rel=0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=7 metric=0.1421 head_norm=0.921169
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.144470e-01
[S7] stored merged vector for next round verification (round=7)
[S7] DEBUG after merge:  round=7 metric=0.1421 head_norm=0.802857 delta_norm=0.314447
[S7] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=7 metric=0.2835 head_norm=0.943771
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.607751e-01
[S10] stored merged vector for next round verification (round=7)
[S10] DEBUG after merge:  round=7 metric=0.2696 head_norm=1.012661 delta_norm=0.160775
[S10] aggregate: ROLLBACK (f1_val pre=0.283 post=0.270 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=7 metric=0.1423 head_norm=0.825641
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.183538e-01
[S5] stored merged vector for next round verification (round=7)
[S5] DEBUG after merge:  round=7 metric=0.1463 head_norm=0.793939 delta_norm=0.218354
[S5] aggregate: ACCEPT kept=['S10', 'S9'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=7 metric=0.6710 head_norm=0.905818
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.772306e-01
[S15] stored merged vector for next round verification (round=7)
[S15] DEBUG after merge:  round=7 metric=0.7116 head_norm=0.960121 delta_norm=0.477231
[S15] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=7 metric=0.1675 head_norm=1.079890
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.808128e-01
[S2] stored merged vector for next round verification (round=7)
[S2] DEBUG after merge:  round=7 metric=0.1706 head_norm=1.205071 delta_norm=0.280813
[S2] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=1.205071 cos_to_last_merge=1.0000 (last merge round=7)
[S2] round=8 local utility u=0.846926 metrics={'f1_val': 0.39366676760819735, 'auprc': 0.7770726721810755, 'loss_val': 0.9030466860673474, 'psi': 0.5470291294373486}-{'f1_val': 0.16752325012236907, 'auprc': 0.7046888310459323, 'loss_val': 1.022885913088553, 'psi': 0.3823894824917944}
[S3] START round=8 head_norm_before_train=0.771316 cos_to_last_merge=1.0000 (last merge round=7)
[S3] round=8 local utility u=0.000000 metrics={'f1_val': 0.39642092198300777, 'auprc': 0.9988735178830976, 'loss_val': 0.790643829108086, 'psi': 0.6374019603430436}-{'f1_val': 0.39635856801559805, 'auprc': 0.9985359582342905, 'loss_val': 0.7798736075427777, 'psi': 0.6372295241030751}
[S4] START round=8 head_norm_before_train=0.798974 cos_to_last_merge=0.9940 (last merge round=6)
[S4] round=8 local utility u=0.106737 metrics={'f1_val': 0.3750406592215114, 'auprc': 0.7442282696271197, 'loss_val': 0.9413394010322204, 'psi': 0.5227157033837547}-{'f1_val': 0.41390996828498405, 'auprc': 0.6395299264151734, 'loss_val': 1.073933707623163, 'psi': 0.5041579515370598}
[S5] START round=8 head_norm_before_train=0.793939 cos_to_last_merge=1.0000 (last merge round=7)
[S5] round=8 local utility u=0.858948 metrics={'f1_val': 0.41734838192522206, 'auprc': 0.7774861530277245, 'loss_val': 1.1670871676798424, 'psi': 0.5614034903662231}-{'f1_val': 0.14226190476190476, 'auprc': 0.771721636152814, 'loss_val': 1.2171713043176111, 'psi': 0.39404579731826844}
[S6] START round=8 head_norm_before_train=0.861988 cos_to_last_merge=0.9307 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.931
[S6] round=8 local utility u=0.116394 metrics={'f1_val': 0.4166544795555117, 'auprc': 0.6788502154579337, 'loss_val': 1.0191589107869998, 'psi': 0.5215327739164806}-{'f1_val': 0.38109489892905457, 'auprc': 0.7082147410215296, 'loss_val': 1.1266833731594232, 'psi': 0.5119428357660446}
[S7] START round=8 head_norm_before_train=0.802857 cos_to_last_merge=1.0000 (last merge round=7)
[S7] round=8 local utility u=0.655114 metrics={'f1_val': 0.3659669935358458, 'auprc': 0.777881436576618, 'loss_val': 1.2256173399438857, 'psi': 0.5307327707521546}-{'f1_val': 0.14205682272909165, 'auprc': 0.7922920605987108, 'loss_val': 1.2356165519639408, 'psi': 0.40215091787693935}
[S8] START round=8 head_norm_before_train=1.015505 cos_to_last_merge=0.9616 (last merge round=2)
[S8] round=8 local utility u=0.000000 metrics={'f1_val': 0.3731326739016295, 'auprc': 0.7769329135742443, 'loss_val': 0.7937031234485978, 'psi': 0.5346527697706754}-{'f1_val': 0.7155419475775954, 'auprc': 0.7771076406988755, 'loss_val': 0.93512290170587, 'psi': 0.7401682248261074}
[S9] START round=8 head_norm_before_train=1.044013 cos_to_last_merge=0.9190 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.919
[S9] round=8 local utility u=0.084237 metrics={'f1_val': 0.7016857342464684, 'auprc': 0.9988483894795116, 'loss_val': 0.4528901035608202, 'psi': 0.8205507963396856}-{'f1_val': 0.7020085231425305, 'auprc': 0.9984656979228588, 'loss_val': 0.6221535478564408, 'psi': 0.8205913930546618}
[S10] START round=8 head_norm_before_train=1.012661 cos_to_last_merge=1.0000 (last merge round=7)
[S10] round=8 local utility u=0.489999 metrics={'f1_val': 0.38867670237126606, 'auprc': 0.7149335555374575, 'loss_val': 0.9974065390921066, 'psi': 0.5191794436377426}-{'f1_val': 0.28349092627904154, 'auprc': 0.6355572544183435, 'loss_val': 1.1081619486434902, 'psi': 0.42431745753476235}
[S11] START round=8 head_norm_before_train=1.273310 cos_to_last_merge=1.0000 (last merge round=7)
[S11] round=8 local utility u=0.083885 metrics={'f1_val': 0.39658602128368947, 'auprc': 0.9106348618360036, 'loss_val': 0.9329939032619304, 'psi': 0.6022055575046151}-{'f1_val': 0.3966199105536595, 'auprc': 0.893529360142668, 'loss_val': 1.049650680485743, 'psi': 0.5953836903892629}
[S13] START round=8 head_norm_before_train=0.725701 cos_to_last_merge=1.0000 (last merge round=7)
[S13] round=8 local utility u=0.197648 metrics={'f1_val': 0.6212385468436662, 'auprc': 0.7360275518231785, 'loss_val': 1.1335240533069186, 'psi': 0.6671541488354711}-{'f1_val': 0.5629479050067423, 'auprc': 0.7314391397230184, 'loss_val': 1.1653107829655514, 'psi': 0.6303443988932527}
[S14] START round=8 head_norm_before_train=1.100889 cos_to_last_merge=0.9573 (last merge round=2)
[S14] round=8 local utility u=1.000000 metrics={'f1_val': 0.9341842462326617, 'auprc': 0.9966693300344179, 'loss_val': 0.7144675137301497, 'psi': 0.9591782797533641}-{'f1_val': 0.5202072139285323, 'auprc': 0.999455953255293, 'loss_val': 0.941610923923575, 'psi': 0.7119067096592366}
[S15] START round=8 head_norm_before_train=0.960121 cos_to_last_merge=1.0000 (last merge round=7)
[S15] round=8 local utility u=0.126489 metrics={'f1_val': 0.7147265437145369, 'auprc': 0.775681516401831, 'loss_val': 0.9556603119545035, 'psi': 0.7391085327894545}-{'f1_val': 0.6709556191152933, 'auprc': 0.7858822274004836, 'loss_val': 0.9766141538986618, 'psi': 0.7169262624293695}
[S16] START round=8 head_norm_before_train=1.398034 (no previous merge yet)
[S16] round=8 local utility u=0.000000 metrics={'f1_val': 0.3432779873899371, 'auprc': 0.7599895516629099, 'loss_val': 0.7854833168777503, 'psi': 0.5099626130991263}-{'f1_val': 0.3947458281694566, 'auprc': 0.7546514330371696, 'loss_val': 0.8014379611914303, 'psi': 0.5387080701165419}
[S17] START round=8 head_norm_before_train=1.376933 (no previous merge yet)
[S17] round=8 local utility u=0.007749 metrics={'f1_val': 0.35657260771113186, 'auprc': 0.8696437919117888, 'loss_val': 0.8685614714734776, 'psi': 0.5618010813913946}-{'f1_val': 0.3907912793961699, 'auprc': 0.803808360327455, 'loss_val': 0.8918661175677914, 'psi': 0.555998111768684}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:63203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:63213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:63205
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:63204
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] → sending delta(kind=head bytes=1793) to S7@127.0.0.1:63208
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] → sending delta(kind=head bytes=1805) to S3@127.0.0.1:63203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:63213
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:63211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] → sending delta(kind=head bytes=1792) to S5@127.0.0.1:63205
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] → sending delta(kind=head bytes=1804) to S3@127.0.0.1:63203
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:63215
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:63202
[S14] sending update (kind=head size=1795 to 1 peers)
[S13] sending update (kind=head size=1804 to 1 peers)
[S5] sending update (kind=head size=1805 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[S4] sending update (kind=head size=1793 to 1 peers)
[S9] sending update (kind=head size=1792 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1792) from S9
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.103886)
[S5] loaded HEAD from S9 (vec_in norm=1.103886)
[S5] cosine check vs S9: cos=0.9074
[S5] BUFFERED delta from S9 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1796) from S10
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.033678)
[S5] loaded HEAD from S10 (vec_in norm=1.033678)
[S5] cosine check vs S10: cos=0.6150
[S5] BUFFERED delta from S10 (total buffered=2)
[S4] RECEIVED delta(kind=head bytes=1803) from S2
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.229143)
[S4] loaded HEAD from S2 (vec_in norm=1.229143)
[S4] cosine check vs S2: cos=0.5115
[S4] BUFFERED delta from S2 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1797) from S6
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.884035)
[S13] loaded HEAD from S6 (vec_in norm=0.884035)
[S13] cosine check vs S6: cos=0.4001
[S13] BUFFERED delta from S6 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1803) from S15
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.992417)
[S13] loaded HEAD from S15 (vec_in norm=0.992417)
[S13] cosine check vs S15: cos=0.5585
[S13] BUFFERED delta from S15 (total buffered=2)
[S3] RECEIVED delta(kind=head bytes=1804) from S13
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=0.742860)
[S3] loaded HEAD from S13 (vec_in norm=0.742860)
[S3] cosine check vs S13: cos=0.4979
[S3] BUFFERED delta from S13 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1805) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.811268)
[S3] loaded HEAD from S5 (vec_in norm=0.811268)
[S3] cosine check vs S5: cos=0.0030
[S3] BUFFERED delta from S5 (total buffered=2)
[S3] RECEIVED delta(kind=head bytes=1801) from S7
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.814004)
[S3] loaded HEAD from S7 (vec_in norm=0.814004)
[S3] cosine check vs S7: cos=0.3681
[S3] BUFFERED delta from S7 (total buffered=3)
[S10] RECEIVED delta(kind=head bytes=1795) from S14
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.163373)
[S10] loaded HEAD from S14 (vec_in norm=1.163373)
[S10] cosine check vs S14: cos=0.9762
[S10] BUFFERED delta from S14 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1793) from S4
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.844867)
[S7] loaded HEAD from S4 (vec_in norm=0.844867)
[S7] cosine check vs S4: cos=0.9072
[S7] BUFFERED delta from S4 (total buffered=1)
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1802) from S17
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.417036)
[S2] loaded HEAD from S17 (vec_in norm=1.417036)
[S2] cosine check vs S17: cos=0.9705
[S2] BUFFERED delta from S17 (total buffered=1)
[S11] sending update (kind=head size=1800 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1800) from S11
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.295927)
[S15] loaded HEAD from S11 (vec_in norm=1.295927)
[S15] cosine check vs S11: cos=0.8990
[S15] BUFFERED delta from S11 (total buffered=1)
[S3] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=8 metric=0.3964 head_norm=0.825709
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.679784e-01
[S3] stored merged vector for next round verification (round=8)
[S3] DEBUG after merge:  round=8 metric=0.3964 head_norm=0.577049 delta_norm=0.367978
[S3] aggregate: ACCEPT kept=['S13', 'S5', 'S7'] (k=3/3) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=8 metric=0.3887 head_norm=1.033678
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.359722e-01
[S10] stored merged vector for next round verification (round=8)
[S10] DEBUG after merge:  round=8 metric=0.3886 head_norm=1.092005 delta_norm=0.135972
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=8 metric=0.6212 head_norm=0.742860
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.881046e-01
[S13] stored merged vector for next round verification (round=8)
[S13] DEBUG after merge:  round=8 metric=0.4160 head_norm=0.648243 delta_norm=0.288105
[S13] aggregate: ROLLBACK (f1_val pre=0.621 post=0.416 tol_abs=0.005 tol_rel=0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=8 metric=0.3937 head_norm=1.229143
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.857841e-01
[S2] stored merged vector for next round verification (round=8)
[S2] DEBUG after merge:  round=8 metric=0.3937 head_norm=1.313346 delta_norm=0.185784
[S2] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=8 metric=0.3750 head_norm=0.844867
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.390240e-01
[S4] stored merged vector for next round verification (round=8)
[S4] DEBUG after merge:  round=8 metric=0.6675 head_norm=0.906504 delta_norm=0.539024
[S4] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=8 metric=0.4173 head_norm=0.811268
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.496992e-01
[S5] stored merged vector for next round verification (round=8)
[S5] DEBUG after merge:  round=8 metric=0.4178 head_norm=0.828595 delta_norm=0.149699
[S5] aggregate: ACCEPT kept=['S9', 'S10'] (k=2/2) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=8 metric=0.3660 head_norm=0.814004
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.793427e-01
[S7] stored merged vector for next round verification (round=8)
[S7] DEBUG after merge:  round=8 metric=0.3822 head_norm=0.809961 delta_norm=0.179343
[S7] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=8 metric=0.7147 head_norm=0.992417
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.965874e-01
[S15] stored merged vector for next round verification (round=8)
[S15] DEBUG after merge:  round=8 metric=0.4461 head_norm=1.115435 delta_norm=0.296587
[S15] aggregate: ROLLBACK (f1_val pre=0.715 post=0.446 tol_abs=0.005 tol_rel=0.0)
[S2] START round=9 head_norm_before_train=1.313346 cos_to_last_merge=1.0000 (last merge round=8)
[S2] round=9 local utility u=0.074395 metrics={'f1_val': 0.4017289603746973, 'auprc': 0.7740483655558844, 'loss_val': 0.793556493754884, 'psi': 0.5506567224471721}-{'f1_val': 0.39366676760819735, 'auprc': 0.7770726721810755, 'loss_val': 0.9030466860673474, 'psi': 0.5470291294373486}
[S3] START round=9 head_norm_before_train=0.577049 cos_to_last_merge=1.0000 (last merge round=8)
[S3] round=9 local utility u=0.340560 metrics={'f1_val': 0.5230863533586267, 'auprc': 0.9882604223450865, 'loss_val': 0.8376771995578423, 'psi': 0.7091559809532106}-{'f1_val': 0.39642092198300777, 'auprc': 0.9988735178830976, 'loss_val': 0.790643829108086, 'psi': 0.6374019603430436}
[S4] START round=9 head_norm_before_train=0.906504 cos_to_last_merge=1.0000 (last merge round=8)
[S4] round=9 local utility u=0.083541 metrics={'f1_val': 0.43575708618767406, 'auprc': 0.6624601911653166, 'loss_val': 0.8932508681186866, 'psi': 0.526438328178731}-{'f1_val': 0.3750406592215114, 'auprc': 0.7442282696271197, 'loss_val': 0.9413394010322204, 'psi': 0.5227157033837547}
[S5] START round=9 head_norm_before_train=0.828595 cos_to_last_merge=1.0000 (last merge round=8)
[S5] round=9 local utility u=0.048550 metrics={'f1_val': 0.41750764008433106, 'auprc': 0.7774686447492036, 'loss_val': 1.0708907690736411, 'psi': 0.56149204195028}-{'f1_val': 0.41734838192522206, 'auprc': 0.7774861530277245, 'loss_val': 1.1670871676798424, 'psi': 0.5614034903662231}
[S6] START round=9 head_norm_before_train=0.884035 cos_to_last_merge=0.9146 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.915
[S6] round=9 local utility u=0.212525 metrics={'f1_val': 0.4164535851642239, 'auprc': 0.7890689909217424, 'loss_val': 0.9235592467059557, 'psi': 0.5654997474672313}-{'f1_val': 0.4166544795555117, 'auprc': 0.6788502154579337, 'loss_val': 1.0191589107869998, 'psi': 0.5215327739164806}
[S7] START round=9 head_norm_before_train=0.809961 cos_to_last_merge=1.0000 (last merge round=8)
[S7] round=9 local utility u=0.996919 metrics={'f1_val': 0.6914864278109355, 'auprc': 0.7776681575259992, 'loss_val': 1.1842566277994113, 'psi': 0.725959119696961}-{'f1_val': 0.3659669935358458, 'auprc': 0.777881436576618, 'loss_val': 1.2256173399438857, 'psi': 0.5307327707521546}
[S8] START round=9 head_norm_before_train=1.066353 cos_to_last_merge=0.9451 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.945
[S8] round=9 local utility u=0.378826 metrics={'f1_val': 0.3729988868650071, 'auprc': 0.9934727607169165, 'loss_val': 0.684868554666931, 'psi': 0.6211884364057708}-{'f1_val': 0.3731326739016295, 'auprc': 0.7769329135742443, 'loss_val': 0.7937031234485978, 'psi': 0.5346527697706754}
[S9] START round=9 head_norm_before_train=1.103886 cos_to_last_merge=0.9004 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.900
[S9] round=9 local utility u=0.033445 metrics={'f1_val': 0.6998724191190738, 'auprc': 0.9988430046885967, 'loss_val': 0.3751044218645148, 'psi': 0.8194606533468829}-{'f1_val': 0.7016857342464684, 'auprc': 0.9988483894795116, 'loss_val': 0.4528901035608202, 'psi': 0.8205507963396856}
[S10] START round=9 head_norm_before_train=1.092005 cos_to_last_merge=1.0000 (last merge round=8)
[S10] round=9 local utility u=0.276221 metrics={'f1_val': 0.3884477848801582, 'auprc': 0.8484497506891053, 'loss_val': 0.8441392411716356, 'psi': 0.572448571203737}-{'f1_val': 0.38867670237126606, 'auprc': 0.7149335555374575, 'loss_val': 0.9974065390921066, 'psi': 0.5191794436377426}
[S11] START round=9 head_norm_before_train=1.295927 cos_to_last_merge=0.9980 (last merge round=7)
[S11] round=9 local utility u=0.101006 metrics={'f1_val': 0.396484976660716, 'auprc': 0.9398946387049698, 'loss_val': 0.818155567999934, 'psi': 0.6138488414784176}-{'f1_val': 0.39658602128368947, 'auprc': 0.9106348618360036, 'loss_val': 0.9329939032619304, 'psi': 0.6022055575046151}
[S13] START round=9 head_norm_before_train=0.648243 cos_to_last_merge=1.0000 (last merge round=8)
[S13] round=9 local utility u=0.000000 metrics={'f1_val': 0.41592377599636055, 'auprc': 0.5774131815521358, 'loss_val': 1.0844258679086096, 'psi': 0.48051953821867066}-{'f1_val': 0.6212385468436662, 'auprc': 0.7360275518231785, 'loss_val': 1.1335240533069186, 'psi': 0.6671541488354711}
[S14] START round=9 head_norm_before_train=1.163373 cos_to_last_merge=0.9447 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.945
[S14] round=9 local utility u=0.333765 metrics={'f1_val': 0.9978664828807459, 'auprc': 0.997501856885058, 'loss_val': 0.4315279348926194, 'psi': 0.9977206324824707}-{'f1_val': 0.9341842462326617, 'auprc': 0.9966693300344179, 'loss_val': 0.7144675137301497, 'psi': 0.9591782797533641}
[S15] START round=9 head_norm_before_train=1.115435 cos_to_last_merge=1.0000 (last merge round=8)
[S15] round=9 local utility u=0.007809 metrics={'f1_val': 0.6926882465250839, 'auprc': 0.7968382106019378, 'loss_val': 0.8712820528843106, 'psi': 0.7343482321558255}-{'f1_val': 0.7147265437145369, 'auprc': 0.775681516401831, 'loss_val': 0.9556603119545035, 'psi': 0.7391085327894545}
[S16] START round=9 head_norm_before_train=1.436672 (no previous merge yet)
[S16] round=9 local utility u=0.250480 metrics={'f1_val': 0.4293404331698787, 'auprc': 0.7576221486140005, 'loss_val': 0.7937953291191079, 'psi': 0.5606531193475275}-{'f1_val': 0.3432779873899371, 'auprc': 0.7599895516629099, 'loss_val': 0.7854833168777503, 'psi': 0.5099626130991263}
[S17] START round=9 head_norm_before_train=1.417036 (no previous merge yet)
[S17] round=9 local utility u=0.002039 metrics={'f1_val': 0.35564468211527034, 'auprc': 0.8667604511291159, 'loss_val': 0.8502663669058039, 'psi': 0.5600909897208086}-{'f1_val': 0.35657260771113186, 'auprc': 0.8696437919117888, 'loss_val': 0.8685614714734776, 'psi': 0.5618010813913946}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:63212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:63205
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:63203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S7] → sending delta(kind=head bytes=1786) to S3@127.0.0.1:63203
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:63213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:63215
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:63208
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:63202
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S10] → sending delta(kind=head bytes=1792) to S5@127.0.0.1:63205
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:63213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:63204
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:63204
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] → sending delta(kind=head bytes=1794) to S10@127.0.0.1:63211
[S10] sending update (kind=head size=1792 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1786 to 1 peers)
[S14] sending update (kind=head size=1794 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1798) from S8
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.119932)
[S2] loaded HEAD from S8 (vec_in norm=1.119932)
[S2] cosine check vs S8: cos=-0.1085
[S2] DROPPED delta from S8 (cos=-0.1085 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1799) from S6
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.917301)
[S13] loaded HEAD from S6 (vec_in norm=0.917301)
[S13] cosine check vs S6: cos=0.5680
[S13] BUFFERED delta from S6 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1797) from S9
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.161545)
[S5] loaded HEAD from S9 (vec_in norm=1.161545)
[S5] cosine check vs S9: cos=0.8660
[S5] BUFFERED delta from S9 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1797) from S2
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.341875)
[S4] loaded HEAD from S2 (vec_in norm=1.341875)
[S4] cosine check vs S2: cos=0.8788
[S4] BUFFERED delta from S2 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1792) from S10
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.115695)
[S5] loaded HEAD from S10 (vec_in norm=1.115695)
[S5] cosine check vs S10: cos=0.6988
[S5] BUFFERED delta from S10 (total buffered=2)
[S3] RECEIVED delta(kind=head bytes=1786) from S7
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.822812)
[S3] loaded HEAD from S7 (vec_in norm=0.822812)
[S3] cosine check vs S7: cos=0.5089
[S3] BUFFERED delta from S7 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1798) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.851400)
[S3] loaded HEAD from S5 (vec_in norm=0.851400)
[S3] cosine check vs S5: cos=0.2031
[S3] BUFFERED delta from S5 (total buffered=2)
[S13] RECEIVED delta(kind=head bytes=1800) from S15
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.140563)
[S13] loaded HEAD from S15 (vec_in norm=1.140563)
[S13] cosine check vs S15: cos=0.6073
[S13] BUFFERED delta from S15 (total buffered=2)
[S11] RECEIVED delta(kind=head bytes=1796) from S3
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=0.638291)
[S11] loaded HEAD from S3 (vec_in norm=0.638291)
[S11] cosine check vs S3: cos=0.7415
[S11] BUFFERED delta from S3 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1801) from S11
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.325700)
[S15] loaded HEAD from S11 (vec_in norm=1.325700)
[S15] cosine check vs S11: cos=0.9633
[S15] BUFFERED delta from S11 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1797) from S16
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S16 (keys=['weight', 'bias'], vec_norm=1.470418)
[S4] loaded HEAD from S16 (vec_in norm=1.470418)
[S4] cosine check vs S16: cos=0.3655
[S4] BUFFERED delta from S16 (total buffered=2)
[S7] RECEIVED delta(kind=head bytes=1795) from S4
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.944917)
[S7] loaded HEAD from S4 (vec_in norm=0.944917)
[S7] cosine check vs S4: cos=0.7447
[S7] BUFFERED delta from S4 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1794) from S14
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.235011)
[S10] loaded HEAD from S14 (vec_in norm=1.235011)
[S10] cosine check vs S14: cos=0.9818
[S10] BUFFERED delta from S14 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:63202
[S17] sending update (kind=head size=1796 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1796) from S17
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.453685)
[S2] loaded HEAD from S17 (vec_in norm=1.453685)
[S2] cosine check vs S17: cos=0.9824
[S2] BUFFERED delta from S17 (total buffered=1)
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=9 metric=0.4159 head_norm=0.669265
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.151019e-01
[S13] stored merged vector for next round verification (round=9)
[S13] DEBUG after merge:  round=9 metric=0.4159 head_norm=0.672615 delta_norm=0.215102
[S13] aggregate: ACCEPT kept=['S6', 'S15'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=9 metric=0.3965 head_norm=1.325700
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.769654e-01
[S11] stored merged vector for next round verification (round=9)
[S11] DEBUG after merge:  round=9 metric=0.3965 head_norm=0.924636 delta_norm=0.476965
[S11] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=9 metric=0.4358 head_norm=0.944917
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.581956e-01
[S4] stored merged vector for next round verification (round=9)
[S4] DEBUG after merge:  round=9 metric=0.4372 head_norm=0.936892 delta_norm=0.258196
[S4] aggregate: ACCEPT kept=['S2', 'S16'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=9 metric=0.6927 head_norm=1.140563
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.906626e-01
[S15] stored merged vector for next round verification (round=9)
[S15] DEBUG after merge:  round=9 metric=0.6796 head_norm=1.221814 delta_norm=0.190663
[S15] aggregate: ROLLBACK (f1_val pre=0.693 post=0.680 tol_abs=0.005 tol_rel=0.0)
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=9 metric=0.5231 head_norm=0.638291
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.116819e-01
[S3] stored merged vector for next round verification (round=9)
[S3] DEBUG after merge:  round=9 metric=0.6289 head_norm=0.534780 delta_norm=0.311682
[S3] aggregate: ACCEPT kept=['S7', 'S5'] (k=2/2) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=9 metric=0.3884 head_norm=1.115695
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.267790e-01
[S10] stored merged vector for next round verification (round=9)
[S10] DEBUG after merge:  round=9 metric=0.3925 head_norm=1.170017 delta_norm=0.126779
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=9 metric=0.6915 head_norm=0.822812
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.208975e-01
[S7] stored merged vector for next round verification (round=9)
[S7] DEBUG after merge:  round=9 metric=0.4248 head_norm=0.825814 delta_norm=0.320898
[S7] aggregate: ROLLBACK (f1_val pre=0.691 post=0.425 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=9 metric=0.4175 head_norm=0.851400
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.160969e-01
[S5] stored merged vector for next round verification (round=9)
[S5] DEBUG after merge:  round=9 metric=0.4175 head_norm=0.879526 delta_norm=0.116097
[S5] aggregate: ACCEPT kept=['S9', 'S10'] (k=2/2) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=9 metric=0.4017 head_norm=1.341875
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.425797e-01
[S2] stored merged vector for next round verification (round=9)
[S2] DEBUG after merge:  round=9 metric=0.4018 head_norm=1.391612 delta_norm=0.142580
[S2] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=1.391612 cos_to_last_merge=1.0000 (last merge round=9)
[S2] round=10 local utility u=0.000000 metrics={'f1_val': 0.39382509566392887, 'auprc': 0.7766737324162757, 'loss_val': 0.7905217963180029, 'psi': 0.5469645503648677}-{'f1_val': 0.4017289603746973, 'auprc': 0.7740483655558844, 'loss_val': 0.793556493754884, 'psi': 0.5506567224471721}
[S3] START round=10 head_norm_before_train=0.534780 cos_to_last_merge=1.0000 (last merge round=9)
[S3] round=10 local utility u=0.000000 metrics={'f1_val': 0.3947846481248297, 'auprc': 0.9223724326161229, 'loss_val': 0.8892680192629171, 'psi': 0.605819761921347}-{'f1_val': 0.5230863533586267, 'auprc': 0.9882604223450865, 'loss_val': 0.8376771995578423, 'psi': 0.7091559809532106}
[S4] START round=10 head_norm_before_train=0.936892 cos_to_last_merge=1.0000 (last merge round=9)
[S4] round=10 local utility u=0.006070 metrics={'f1_val': 0.3776244363589906, 'auprc': 0.7603996634789432, 'loss_val': 0.8261327616634184, 'psi': 0.5307345272069717}-{'f1_val': 0.43575708618767406, 'auprc': 0.6624601911653166, 'loss_val': 0.8932508681186866, 'psi': 0.526438328178731}
[S5] START round=10 head_norm_before_train=0.879526 cos_to_last_merge=1.0000 (last merge round=9)
[S5] round=10 local utility u=0.058022 metrics={'f1_val': 0.4181537288170242, 'auprc': 0.7772084925665663, 'loss_val': 0.9579437440068175, 'psi': 0.561775634316841}-{'f1_val': 0.41750764008433106, 'auprc': 0.7774686447492036, 'loss_val': 1.0708907690736411, 'psi': 0.56149204195028}
[S6] START round=10 head_norm_before_train=0.917301 cos_to_last_merge=0.8959 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.896
[S6] round=10 local utility u=0.080001 metrics={'f1_val': 0.4171358730402079, 'auprc': 0.7948620237637676, 'loss_val': 0.785030357973606, 'psi': 0.5682263333296318}-{'f1_val': 0.4164535851642239, 'auprc': 0.7890689909217424, 'loss_val': 0.9235592467059557, 'psi': 0.5654997474672313}
[S7] START round=10 head_norm_before_train=0.825814 cos_to_last_merge=1.0000 (last merge round=9)
[S7] round=10 local utility u=0.000000 metrics={'f1_val': 0.42491668366999935, 'auprc': 0.7776129880361013, 'loss_val': 1.097706161963668, 'psi': 0.5659952054164401}-{'f1_val': 0.6914864278109355, 'auprc': 0.7776681575259992, 'loss_val': 1.1842566277994113, 'psi': 0.725959119696961}
[S8] START round=10 head_norm_before_train=1.119932 cos_to_last_merge=0.9252 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.925
[S8] round=10 local utility u=0.000000 metrics={'f1_val': 0.40674693719942434, 'auprc': 0.8653111639015314, 'loss_val': 0.582909104184964, 'psi': 0.5901726278802673}-{'f1_val': 0.3729988868650071, 'auprc': 0.9934727607169165, 'loss_val': 0.684868554666931, 'psi': 0.6211884364057708}
[S9] START round=10 head_norm_before_train=1.161545 cos_to_last_merge=0.8829 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.883
[S9] round=10 local utility u=0.032346 metrics={'f1_val': 0.7016130641860581, 'auprc': 0.9988384278857784, 'loss_val': 0.3208433855746222, 'psi': 0.8205032096659461}-{'f1_val': 0.6998724191190738, 'auprc': 0.9988430046885967, 'loss_val': 0.3751044218645148, 'psi': 0.8194606533468829}
[S10] START round=10 head_norm_before_train=1.170017 cos_to_last_merge=1.0000 (last merge round=9)
[S10] round=10 local utility u=0.237594 metrics={'f1_val': 0.3881438130762333, 'auprc': 0.976746519763957, 'loss_val': 0.7520176037392096, 'psi': 0.6235848957513228}-{'f1_val': 0.3884477848801582, 'auprc': 0.8484497506891053, 'loss_val': 0.8441392411716356, 'psi': 0.572448571203737}
[S11] START round=10 head_norm_before_train=0.924636 cos_to_last_merge=1.0000 (last merge round=9)
[S11] round=10 local utility u=0.000000 metrics={'f1_val': 0.39711607812448974, 'auprc': 0.9398945748937224, 'loss_val': 0.8245339018370034, 'psi': 0.6142274768321828}-{'f1_val': 0.396484976660716, 'auprc': 0.9398946387049698, 'loss_val': 0.818155567999934, 'psi': 0.6138488414784176}
[S13] START round=10 head_norm_before_train=0.672615 cos_to_last_merge=1.0000 (last merge round=9)
[S13] round=10 local utility u=0.090269 metrics={'f1_val': 0.37146126764782716, 'auprc': 0.7227333512713341, 'loss_val': 1.0730730450599604, 'psi': 0.51197010109723}-{'f1_val': 0.41592377599636055, 'auprc': 0.5774131815521358, 'loss_val': 1.0844258679086096, 'psi': 0.48051953821867066}
[S14] START round=10 head_norm_before_train=1.235011 cos_to_last_merge=0.9305 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.930
[S14] round=10 local utility u=0.080676 metrics={'f1_val': 0.9984980569824138, 'auprc': 0.9956832814719684, 'loss_val': 0.2685091119690554, 'psi': 0.9973721467782356}-{'f1_val': 0.9978664828807459, 'auprc': 0.997501856885058, 'loss_val': 0.4315279348926194, 'psi': 0.9977206324824707}
[S15] START round=10 head_norm_before_train=1.221814 cos_to_last_merge=1.0000 (last merge round=9)
[S15] round=10 local utility u=0.053020 metrics={'f1_val': 0.6950265589108516, 'auprc': 0.7917001914385713, 'loss_val': 0.7638578812821898, 'psi': 0.7336960119219396}-{'f1_val': 0.6926882465250839, 'auprc': 0.7968382106019378, 'loss_val': 0.8712820528843106, 'psi': 0.7343482321558255}
[S16] START round=10 head_norm_before_train=1.470418 (no previous merge yet)
[S16] round=10 local utility u=0.000000 metrics={'f1_val': 0.395245886773585, 'auprc': 0.746858742379926, 'loss_val': 0.7893024397931536, 'psi': 0.5358910290161214}-{'f1_val': 0.4293404331698787, 'auprc': 0.7576221486140005, 'loss_val': 0.7937953291191079, 'psi': 0.5606531193475275}
[S17] START round=10 head_norm_before_train=1.453685 (no previous merge yet)
[S17] round=10 local utility u=0.020670 metrics={'f1_val': 0.358257286022418, 'auprc': 0.8695035482076926, 'loss_val': 0.8328303366363415, 'psi': 0.5627557908965278}-{'f1_val': 0.35564468211527034, 'auprc': 0.8667604511291159, 'loss_val': 0.8502663669058039, 'psi': 0.5600909897208086}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:63203
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:63208
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:63213
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:63213
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:63205
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:63211
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:63203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:63205
[S6] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1794 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1801) from S14
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.302645)
[S10] loaded HEAD from S14 (vec_in norm=1.302645)
[S10] cosine check vs S14: cos=0.9860
[S10] BUFFERED delta from S14 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1794) from S9
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.211424)
[S5] loaded HEAD from S9 (vec_in norm=1.211424)
[S5] cosine check vs S9: cos=0.8348
[S5] BUFFERED delta from S9 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1795) from S10
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.197088)
[S5] loaded HEAD from S10 (vec_in norm=1.197088)
[S5] cosine check vs S10: cos=0.7394
[S5] BUFFERED delta from S10 (total buffered=2)
[S13] RECEIVED delta(kind=head bytes=1802) from S15
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.249308)
[S13] loaded HEAD from S15 (vec_in norm=1.249308)
[S13] cosine check vs S15: cos=0.6913
[S13] BUFFERED delta from S15 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1801) from S6
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=0.961218)
[S13] loaded HEAD from S6 (vec_in norm=0.961218)
[S13] cosine check vs S6: cos=0.6197
[S13] BUFFERED delta from S6 (total buffered=2)
[S3] RECEIVED delta(kind=head bytes=1796) from S13
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=0.691601)
[S3] loaded HEAD from S13 (vec_in norm=0.691601)
[S3] cosine check vs S13: cos=0.6015
[S3] BUFFERED delta from S13 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1800) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.906262)
[S3] loaded HEAD from S5 (vec_in norm=0.906262)
[S3] cosine check vs S5: cos=0.4642
[S3] BUFFERED delta from S5 (total buffered=2)
[S7] RECEIVED delta(kind=head bytes=1798) from S4
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.985086)
[S7] loaded HEAD from S4 (vec_in norm=0.985086)
[S7] cosine check vs S4: cos=0.9652
[S7] BUFFERED delta from S4 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:63202
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1801) from S17
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.481914)
[S2] loaded HEAD from S17 (vec_in norm=1.481914)
[S2] cosine check vs S17: cos=0.9873
[S2] BUFFERED delta from S17 (total buffered=1)
[S8] ⇄ pheromone p=0.262 → S2@127.0.0.1:63202
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=10 metric=0.4249 head_norm=0.840384
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.401230e-01
[S7] stored merged vector for next round verification (round=10)
[S7] DEBUG after merge:  round=10 metric=0.4249 head_norm=0.904812 delta_norm=0.140123
[S7] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.364 → S3@127.0.0.1:63203
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=10 metric=0.3938 head_norm=1.424014
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.193492e-01
[S2] stored merged vector for next round verification (round=10)
[S2] DEBUG after merge:  round=10 metric=0.3938 head_norm=1.448343 delta_norm=0.119349
[S2] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.249 → S4@127.0.0.1:63204
[S11] ⇄ pheromone p=0.277 → S15@127.0.0.1:63215
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=10 metric=0.3948 head_norm=0.592043
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.239722e-01
[S3] stored merged vector for next round verification (round=10)
[S3] DEBUG after merge:  round=10 metric=0.6315 head_norm=0.545765 delta_norm=0.223972
[S3] aggregate: ACCEPT kept=['S13', 'S5'] (k=2/2) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.271 → S11@127.0.0.1:63212
[S16] ⇄ pheromone p=0.209 → S4@127.0.0.1:63204
[S6] ⇄ pheromone p=0.247 → S13@127.0.0.1:63213
[S15] ⇄ pheromone p=0.308 → S13@127.0.0.1:63213
[S4] ⇄ pheromone p=0.249 → S7@127.0.0.1:63208
[S9] ⇄ pheromone p=0.232 → S5@127.0.0.1:63205
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=10 metric=0.4182 head_norm=0.906262
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.016234e-01
[S5] stored merged vector for next round verification (round=10)
[S5] DEBUG after merge:  round=10 metric=0.6837 head_norm=0.932548 delta_norm=0.101623
[S5] aggregate: ACCEPT kept=['S9', 'S10'] (k=2/2) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.261 → S3@127.0.0.1:63203
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=10 metric=0.3715 head_norm=0.691601
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.590825e-01
[S13] stored merged vector for next round verification (round=10)
[S13] DEBUG after merge:  round=10 metric=0.3715 head_norm=0.727948 delta_norm=0.159082
[S13] aggregate: ACCEPT kept=['S15', 'S6'] (k=2/2) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.256 → S3@127.0.0.1:63203
[S14] ⇄ pheromone p=0.421 → S10@127.0.0.1:63211
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=10 metric=0.3881 head_norm=1.197088
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.168927e-01
[S10] stored merged vector for next round verification (round=10)
[S10] DEBUG after merge:  round=10 metric=0.3881 head_norm=1.245507 delta_norm=0.116893
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.324 → S5@127.0.0.1:63205
[S17] ⇄ pheromone p=0.208 → S2@127.0.0.1:63202
[S2] START round=11 head_norm_before_train=1.448343 cos_to_last_merge=1.0000 (last merge round=10)
[S2] round=11 local utility u=0.051189 metrics={'f1_val': 0.39873753737242834, 'auprc': 0.7693696277544244, 'loss_val': 0.6957066347948546, 'psi': 0.5469903735252268}-{'f1_val': 0.39382509566392887, 'auprc': 0.7766737324162757, 'loss_val': 0.7905217963180029, 'psi': 0.5469645503648677}
[S3] START round=11 head_norm_before_train=0.545765 cos_to_last_merge=1.0000 (last merge round=10)
[S3] round=11 local utility u=0.000000 metrics={'f1_val': 0.4929625300033109, 'auprc': 0.6626952899759031, 'loss_val': 0.9524595941872521, 'psi': 0.5608556339923478}-{'f1_val': 0.3947846481248297, 'auprc': 0.9223724326161229, 'loss_val': 0.8892680192629171, 'psi': 0.605819761921347}
[S4] START round=11 head_norm_before_train=0.985086 cos_to_last_merge=0.9952 (last merge round=9)
[S4] round=11 local utility u=0.219158 metrics={'f1_val': 0.4360228526391216, 'auprc': 0.7695777092781175, 'loss_val': 0.7657409991579608, 'psi': 0.5694447952947199}-{'f1_val': 0.3776244363589906, 'auprc': 0.7603996634789432, 'loss_val': 0.8261327616634184, 'psi': 0.5307345272069717}
[S5] START round=11 head_norm_before_train=0.932548 cos_to_last_merge=1.0000 (last merge round=10)
[S5] round=11 local utility u=0.971119 metrics={'f1_val': 0.7146935597656502, 'auprc': 0.7947392029152142, 'loss_val': 0.8475364464546722, 'psi': 0.7467118170254758}-{'f1_val': 0.4181537288170242, 'auprc': 0.7772084925665663, 'loss_val': 0.9579437440068175, 'psi': 0.561775634316841}
[S6] START round=11 head_norm_before_train=0.961218 cos_to_last_merge=0.8738 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.874
[S6] round=11 local utility u=0.458846 metrics={'f1_val': 0.550359640404777, 'auprc': 0.7925161655772639, 'loss_val': 0.6596435696095219, 'psi': 0.6472222504737717}-{'f1_val': 0.4171358730402079, 'auprc': 0.7948620237637676, 'loss_val': 0.785030357973606, 'psi': 0.5682263333296318}
[S7] START round=11 head_norm_before_train=0.904812 cos_to_last_merge=1.0000 (last merge round=10)
[S7] round=11 local utility u=0.938539 metrics={'f1_val': 0.7150874177749412, 'auprc': 0.7775703130044065, 'loss_val': 0.9615241102298702, 'psi': 0.7400805758667273}-{'f1_val': 0.42491668366999935, 'auprc': 0.7776129880361013, 'loss_val': 1.097706161963668, 'psi': 0.5659952054164401}
[S8] START round=11 head_norm_before_train=1.177441 cos_to_last_merge=0.9044 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.904
[S8] round=11 local utility u=1.000000 metrics={'f1_val': 0.7138229449839267, 'auprc': 0.9920990617414394, 'loss_val': 0.44715147869416133, 'psi': 0.8251333916869318}-{'f1_val': 0.40674693719942434, 'auprc': 0.8653111639015314, 'loss_val': 0.582909104184964, 'psi': 0.5901726278802673}
[S9] START round=11 head_norm_before_train=1.211424 cos_to_last_merge=0.8665 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.867
[S9] round=11 local utility u=0.010112 metrics={'f1_val': 0.7013629453504064, 'auprc': 0.9988413343477166, 'loss_val': 0.2991278563454659, 'psi': 0.8203543009493305}-{'f1_val': 0.7016130641860581, 'auprc': 0.9988384278857784, 'loss_val': 0.3208433855746222, 'psi': 0.8205032096659461}
[S10] START round=11 head_norm_before_train=1.245507 cos_to_last_merge=1.0000 (last merge round=10)
[S10] round=11 local utility u=1.000000 metrics={'f1_val': 0.7014667009264342, 'auprc': 0.9979249859499985, 'loss_val': 0.597542568949095, 'psi': 0.8200500149358598}-{'f1_val': 0.3881438130762333, 'auprc': 0.976746519763957, 'loss_val': 0.7520176037392096, 'psi': 0.6235848957513228}
[S11] START round=11 head_norm_before_train=0.965204 cos_to_last_merge=0.9972 (last merge round=9)
[S11] round=11 local utility u=0.891211 metrics={'f1_val': 0.6782724604675083, 'auprc': 0.9406412696567401, 'loss_val': 0.7312897783565299, 'psi': 0.783219984143201}-{'f1_val': 0.39711607812448974, 'auprc': 0.9398945748937224, 'loss_val': 0.8245339018370034, 'psi': 0.6142274768321828}
[S13] START round=11 head_norm_before_train=0.727948 cos_to_last_merge=1.0000 (last merge round=10)
[S13] round=11 local utility u=0.000000 metrics={'f1_val': 0.37175581789750844, 'auprc': 0.6804708073996598, 'loss_val': 1.0786598201809254, 'psi': 0.495241813698369}-{'f1_val': 0.37146126764782716, 'auprc': 0.7227333512713341, 'loss_val': 1.0730730450599604, 'psi': 0.51197010109723}
[S14] START round=11 head_norm_before_train=1.302645 cos_to_last_merge=0.9180 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.918
[S14] round=11 local utility u=0.043881 metrics={'f1_val': 0.9972089754700519, 'auprc': 0.995874340876286, 'loss_val': 0.17358583073058298, 'psi': 0.9966751216325456}-{'f1_val': 0.9984980569824138, 'auprc': 0.9956832814719684, 'loss_val': 0.2685091119690554, 'psi': 0.9973721467782356}
[S15] START round=11 head_norm_before_train=1.249308 cos_to_last_merge=0.9959 (last merge round=9)
[S15] round=11 local utility u=0.053047 metrics={'f1_val': 0.6937455436913117, 'auprc': 0.7788860504445483, 'loss_val': 0.611635366298668, 'psi': 0.7278017463926063}-{'f1_val': 0.6950265589108516, 'auprc': 0.7917001914385713, 'loss_val': 0.7638578812821898, 'psi': 0.7336960119219396}
[S16] START round=11 head_norm_before_train=1.503394 (no previous merge yet)
[S16] round=11 local utility u=0.000000 metrics={'f1_val': 0.37705566378199423, 'auprc': 0.7581154646359941, 'loss_val': 0.7801388529819424, 'psi': 0.5294795841235942}-{'f1_val': 0.395245886773585, 'auprc': 0.746858742379926, 'loss_val': 0.7893024397931536, 'psi': 0.5358910290161214}
[S17] START round=11 head_norm_before_train=1.481914 (no previous merge yet)
[S17] round=11 local utility u=0.062340 metrics={'f1_val': 0.3691541278946854, 'auprc': 0.8777374228250463, 'loss_val': 0.798233610176266, 'psi': 0.5725874458668297}-{'f1_val': 0.358257286022418, 'auprc': 0.8695035482076926, 'loss_val': 0.8328303366363415, 'psi': 0.5627557908965278}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] → sending delta(kind=head bytes=1794) to S4@127.0.0.1:63204
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:63205
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S8] → sending delta(kind=head bytes=1790) to S2@127.0.0.1:63202
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:63205
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:63208
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S14] → sending delta(kind=head bytes=1789) to S10@127.0.0.1:63211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:63215
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:63213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:63203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:63213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S7] → sending delta(kind=head bytes=1793) to S3@127.0.0.1:63203
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1794 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1793 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1793 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1789 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1790 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1790) from S8
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S8 (keys=['weight', 'bias'], vec_norm=1.231477)
[S2] loaded HEAD from S8 (vec_in norm=1.231477)
[S2] cosine check vs S8: cos=-0.0874
[S2] DROPPED delta from S8 (cos=-0.0874 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1802) from S4
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.033356)
[S7] loaded HEAD from S4 (vec_in norm=1.033356)
[S7] cosine check vs S4: cos=0.9830
[S7] BUFFERED delta from S4 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1794) from S2
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.479835)
[S4] loaded HEAD from S2 (vec_in norm=1.479835)
[S4] cosine check vs S2: cos=0.7513
[S4] BUFFERED delta from S2 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1799) from S9
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S9 (keys=['weight', 'bias'], vec_norm=1.254598)
[S5] loaded HEAD from S9 (vec_in norm=1.254598)
[S5] cosine check vs S9: cos=0.8148
[S5] BUFFERED delta from S9 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1802) from S15
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.286954)
[S13] loaded HEAD from S15 (vec_in norm=1.286954)
[S13] cosine check vs S15: cos=0.7483
[S13] BUFFERED delta from S15 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1793) from S7
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.926359)
[S3] loaded HEAD from S7 (vec_in norm=0.926359)
[S3] cosine check vs S7: cos=0.3782
[S3] BUFFERED delta from S7 (total buffered=1)
[S5] RECEIVED delta(kind=head bytes=1793) from S10
[S5] model_id mismatch: wear != wear
[S5] after if model_id mismatch: wear != wear
[S5] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.273783)
[S5] loaded HEAD from S10 (vec_in norm=1.273783)
[S5] cosine check vs S10: cos=0.7598
[S5] BUFFERED delta from S10 (total buffered=2)
[S10] RECEIVED delta(kind=head bytes=1789) from S14
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S14 (keys=['weight', 'bias'], vec_norm=1.360532)
[S10] loaded HEAD from S14 (vec_in norm=1.360532)
[S10] cosine check vs S14: cos=0.9898
[S10] BUFFERED delta from S14 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1800) from S5
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=0.965259)
[S3] loaded HEAD from S5 (vec_in norm=0.965259)
[S3] cosine check vs S5: cos=0.6113
[S3] BUFFERED delta from S5 (total buffered=2)
[S15] RECEIVED delta(kind=head bytes=1802) from S11
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.012709)
[S15] loaded HEAD from S11 (vec_in norm=1.012709)
[S15] cosine check vs S11: cos=0.9584
[S15] BUFFERED delta from S11 (total buffered=1)
[S13] RECEIVED delta(kind=head bytes=1799) from S6
[S13] model_id mismatch: wear != wear
[S13] after if model_id mismatch: wear != wear
[S13] loaded HEAD from S6 (keys=['weight', 'bias'], vec_norm=1.010843)
[S13] loaded HEAD from S6 (vec_in norm=1.010843)
[S13] cosine check vs S6: cos=0.6190
[S13] BUFFERED delta from S6 (total buffered=2)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:63202
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1799) from S17
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S17 (keys=['weight', 'bias'], vec_norm=1.509091)
[S2] loaded HEAD from S17 (vec_in norm=1.509091)
[S2] cosine check vs S17: cos=0.9908
[S2] BUFFERED delta from S17 (total buffered=1)
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=11 metric=0.3718 head_norm=0.745499
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.116743e-01
[S13] stored merged vector for next round verification (round=11)
[S13] DEBUG after merge:  round=11 metric=0.3717 head_norm=0.777597 delta_norm=0.111674
[S13] aggregate: ACCEPT kept=['S15', 'S6'] (k=2/2) mode=median trim_p=0.1
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=11 metric=0.4930 head_norm=0.607374
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.474483e-01
[S3] stored merged vector for next round verification (round=11)
[S3] DEBUG after merge:  round=11 metric=0.4522 head_norm=0.588921 delta_norm=0.247448
[S3] aggregate: ROLLBACK (f1_val pre=0.493 post=0.452 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=11 metric=0.7147 head_norm=0.965259
[S5] _apply_head_vector_avg (torch): Δ‖w‖=9.475216e-02
[S5] stored merged vector for next round verification (round=11)
[S5] DEBUG after merge:  round=11 metric=0.7146 head_norm=0.984607 delta_norm=0.094752
[S5] aggregate: ACCEPT kept=['S9', 'S10'] (k=2/2) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=11 metric=0.3987 head_norm=1.479835
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.022933e-01
[S2] stored merged vector for next round verification (round=11)
[S2] DEBUG after merge:  round=11 metric=0.3996 head_norm=1.491030 delta_norm=0.102293
[S2] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=11 metric=0.7151 head_norm=0.926359
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.048174e-01
[S7] stored merged vector for next round verification (round=11)
[S7] DEBUG after merge:  round=11 metric=0.7149 head_norm=0.975703 delta_norm=0.104817
[S7] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=11 metric=0.7015 head_norm=1.273783
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.037342e-01
[S10] stored merged vector for next round verification (round=11)
[S10] DEBUG after merge:  round=11 metric=0.7015 head_norm=1.313783 delta_norm=0.103734
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=11 metric=0.4360 head_norm=1.033356
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.899122e-01
[S4] stored merged vector for next round verification (round=11)
[S4] DEBUG after merge:  round=11 metric=0.6130 head_norm=1.178497 delta_norm=0.489912
[S4] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=11 metric=0.6937 head_norm=1.286954
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.142574e-01
[S15] stored merged vector for next round verification (round=11)
[S15] DEBUG after merge:  round=11 metric=0.6936 head_norm=1.137985 delta_norm=0.214257
[S15] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.491030 cos_to_last_merge=1.0000 (last merge round=11)
[S2] round=12 local utility u=0.000000 metrics={'f1_val': 0.39378997906960117, 'auprc': 0.7773150098154309, 'loss_val': 0.8431491637450481, 'psi': 0.5471999913679331}-{'f1_val': 0.39873753737242834, 'auprc': 0.7693696277544244, 'loss_val': 0.6957066347948546, 'psi': 0.5469903735252268}
[S3] START round=12 head_norm_before_train=0.588921 cos_to_last_merge=1.0000 (last merge round=11)
[S3] round=12 local utility u=0.703285 metrics={'f1_val': 0.6544492549507794, 'auprc': 0.7898835102146287, 'loss_val': 0.896374608536594, 'psi': 0.7086229570563192}-{'f1_val': 0.4929625300033109, 'auprc': 0.6626952899759031, 'loss_val': 0.9524595941872521, 'psi': 0.5608556339923478}
[S4] START round=12 head_norm_before_train=1.178497 cos_to_last_merge=1.0000 (last merge round=11)
[S4] round=12 local utility u=0.432679 metrics={'f1_val': 0.6202141626243122, 'auprc': 0.6792675944796314, 'loss_val': 0.7346013529766693, 'psi': 0.6438355353664398}-{'f1_val': 0.4360228526391216, 'auprc': 0.7695777092781175, 'loss_val': 0.7657409991579608, 'psi': 0.5694447952947199}
[S5] START round=12 head_norm_before_train=0.984607 cos_to_last_merge=1.0000 (last merge round=11)
[S5] round=12 local utility u=0.041891 metrics={'f1_val': 0.7091437057449593, 'auprc': 0.7947366885999539, 'loss_val': 0.730448159016276, 'psi': 0.7433808988869572}-{'f1_val': 0.7146935597656502, 'auprc': 0.7947392029152142, 'loss_val': 0.8475364464546722, 'psi': 0.7467118170254758}
[S6] START round=12 head_norm_before_train=1.010843 cos_to_last_merge=0.8513 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.851
[S6] round=12 local utility u=0.533457 metrics={'f1_val': 0.7092224700698951, 'auprc': 0.7929631232733328, 'loss_val': 0.54724698462871, 'psi': 0.7427187313512702}-{'f1_val': 0.550359640404777, 'auprc': 0.7925161655772639, 'loss_val': 0.6596435696095219, 'psi': 0.6472222504737717}
[S7] START round=12 head_norm_before_train=0.975703 cos_to_last_merge=1.0000 (last merge round=11)
[S7] round=12 local utility u=0.034349 metrics={'f1_val': 0.714792420046008, 'auprc': 0.7771179248669355, 'loss_val': 0.8896988121252397, 'psi': 0.739722621974379}-{'f1_val': 0.7150874177749412, 'auprc': 0.7775703130044065, 'loss_val': 0.9615241102298702, 'psi': 0.7400805758667273}
[S8] START round=12 head_norm_before_train=1.231477 cos_to_last_merge=0.8859 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.886
[S8] round=12 local utility u=0.039911 metrics={'f1_val': 0.7009013631746674, 'auprc': 0.9944460585154907, 'loss_val': 0.2968419016647019, 'psi': 0.8183192413109968}-{'f1_val': 0.7138229449839267, 'auprc': 0.9920990617414394, 'loss_val': 0.44715147869416133, 'psi': 0.8251333916869318}
[S9] START round=12 head_norm_before_train=1.254598 cos_to_last_merge=0.8522 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.852
[S9] round=12 local utility u=0.005554 metrics={'f1_val': 0.7013629453504064, 'auprc': 0.9986797984322986, 'loss_val': 0.2875357608618379, 'psi': 0.8202896865831633}-{'f1_val': 0.7013629453504064, 'auprc': 0.9988413343477166, 'loss_val': 0.2991278563454659, 'psi': 0.8203543009493305}
[S10] START round=12 head_norm_before_train=1.313783 cos_to_last_merge=1.0000 (last merge round=11)
[S10] round=12 local utility u=0.043871 metrics={'f1_val': 0.7001085408329333, 'auprc': 0.9973102781670647, 'loss_val': 0.499808011254136, 'psi': 0.8189892357665859}-{'f1_val': 0.7014667009264342, 'auprc': 0.9979249859499985, 'loss_val': 0.597542568949095, 'psi': 0.8200500149358598}
[S11] START round=12 head_norm_before_train=1.012709 cos_to_last_merge=0.9900 (last merge round=9)
[S11] round=12 local utility u=0.111012 metrics={'f1_val': 0.7014079839878589, 'auprc': 0.9417614422295746, 'loss_val': 0.6514385323960576, 'psi': 0.7975493672845452}-{'f1_val': 0.6782724604675083, 'auprc': 0.9406412696567401, 'loss_val': 0.7312897783565299, 'psi': 0.783219984143201}
[S13] START round=12 head_norm_before_train=0.777597 cos_to_last_merge=1.0000 (last merge round=11)
[S13] round=12 local utility u=0.152150 metrics={'f1_val': 0.3777574829926902, 'auprc': 0.7488721147652214, 'loss_val': 1.0155729254992036, 'psi': 0.5262033357017026}-{'f1_val': 0.37175581789750844, 'auprc': 0.6804708073996598, 'loss_val': 1.0786598201809254, 'psi': 0.495241813698369}
[S14] START round=12 head_norm_before_train=1.360532 cos_to_last_merge=0.9080 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.908
[S14] round=12 local utility u=0.022167 metrics={'f1_val': 0.9980847028057478, 'auprc': 0.9970642439439661, 'loss_val': 0.13807575377532189, 'psi': 0.9976765192610351}-{'f1_val': 0.9972089754700519, 'auprc': 0.995874340876286, 'loss_val': 0.17358583073058298, 'psi': 0.9966751216325456}
[S15] START round=12 head_norm_before_train=1.137985 cos_to_last_merge=1.0000 (last merge round=11)
[S15] round=12 local utility u=0.000136 metrics={'f1_val': 0.6930684073917, 'auprc': 0.7740357944535523, 'loss_val': 0.5927490059876654, 'psi': 0.7254553622164409}-{'f1_val': 0.6937455436913117, 'auprc': 0.7788860504445483, 'loss_val': 0.611635366298668, 'psi': 0.7278017463926063}
[S16] START round=12 head_norm_before_train=1.535110 (no previous merge yet)
[S16] round=12 local utility u=1.000000 metrics={'f1_val': 0.8204553414188694, 'auprc': 0.7829657577399217, 'loss_val': 0.7243834460761056, 'psi': 0.8054595079472904}-{'f1_val': 0.37705566378199423, 'auprc': 0.7581154646359941, 'loss_val': 0.7801388529819424, 'psi': 0.5294795841235942}
[S17] START round=12 head_norm_before_train=1.509091 (no previous merge yet)
[S17] round=12 local utility u=0.000000 metrics={'f1_val': 0.36700126722403026, 'auprc': 0.877234528329488, 'loss_val': 0.8452411895552757, 'psi': 0.5710945716662134}-{'f1_val': 0.3691541278946854, 'auprc': 0.8777374228250463, 'loss_val': 0.798233610176266, 'psi': 0.5725874458668297}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:63208
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:63212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] → sending delta(kind=head bytes=1794) to S15@127.0.0.1:63215
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:63211
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] sending update (kind=head size=1794 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S11] → sending delta(kind=head bytes=1791) to S3@127.0.0.1:63203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] → sending delta(kind=head bytes=1794) to S4@127.0.0.1:63204
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:63202
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:63214
[S4] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1794 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1791 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1794 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1791) from S11
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.057736)
[S3] loaded HEAD from S11 (vec_in norm=1.057736)
[S3] cosine check vs S11: cos=0.5509
[S3] BUFFERED delta from S11 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1797) from S15
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.181194)
[S11] loaded HEAD from S15 (vec_in norm=1.181194)
[S11] cosine check vs S15: cos=0.9717
[S11] BUFFERED delta from S15 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1800) from S5
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.022231)
[S10] loaded HEAD from S5 (vec_in norm=1.022231)
[S10] cosine check vs S5: cos=0.7710
[S10] BUFFERED delta from S5 (total buffered=1)
[S4] RECEIVED delta(kind=head bytes=1794) from S7
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=1.001361)
[S4] loaded HEAD from S7 (vec_in norm=1.001361)
[S4] cosine check vs S7: cos=0.8973
[S4] BUFFERED delta from S7 (total buffered=1)
[S14] RECEIVED delta(kind=head bytes=1798) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.348572)
[S14] loaded HEAD from S10 (vec_in norm=1.348572)
[S14] cosine check vs S10: cos=0.9919
[S14] BUFFERED delta from S10 (total buffered=1)
[S7] RECEIVED delta(kind=head bytes=1799) from S3
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=0.637843)
[S7] loaded HEAD from S3 (vec_in norm=0.637843)
[S7] cosine check vs S3: cos=0.5459
[S7] BUFFERED delta from S3 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1796) from S4
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=1.211007)
[S2] loaded HEAD from S4 (vec_in norm=1.211007)
[S2] cosine check vs S4: cos=0.9429
[S2] BUFFERED delta from S4 (total buffered=1)
[S15] RECEIVED delta(kind=head bytes=1794) from S13
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=0.796602)
[S15] loaded HEAD from S13 (vec_in norm=0.796602)
[S15] cosine check vs S13: cos=0.7729
[S15] BUFFERED delta from S13 (total buffered=1)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=12 metric=0.3938 head_norm=1.519778
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.763769e-01
[S2] stored merged vector for next round verification (round=12)
[S2] DEBUG after merge:  round=12 metric=0.3938 head_norm=1.346012 delta_norm=0.276377
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=12 metric=0.6202 head_norm=1.211007
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.707171e-01
[S4] stored merged vector for next round verification (round=12)
[S4] DEBUG after merge:  round=12 metric=0.4366 head_norm=1.077657 delta_norm=0.270717
[S4] aggregate: ROLLBACK (f1_val pre=0.620 post=0.437 tol_abs=0.005 tol_rel=0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=12 metric=0.7001 head_norm=1.348572
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.294868e-01
[S10] stored merged vector for next round verification (round=12)
[S10] DEBUG after merge:  round=12 metric=0.7001 head_norm=1.116845 delta_norm=0.429487
[S10] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=12 metric=0.7148 head_norm=1.001361
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.219770e-01
[S7] stored merged vector for next round verification (round=12)
[S7] DEBUG after merge:  round=12 metric=0.7148 head_norm=0.725755 delta_norm=0.421977
[S7] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=12 metric=0.9981 head_norm=1.415158
[S14] _apply_head_vector_avg (torch): Δ‖w‖=9.410647e-02
[S14] stored merged vector for next round verification (round=12)
[S14] DEBUG after merge:  round=12 metric=0.9981 head_norm=1.379059 delta_norm=0.094106
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=12 metric=0.6544 head_norm=0.637843
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.422336e-01
[S3] stored merged vector for next round verification (round=12)
[S3] DEBUG after merge:  round=12 metric=0.4628 head_norm=0.753163 delta_norm=0.442234
[S3] aggregate: ROLLBACK (f1_val pre=0.654 post=0.463 tol_abs=0.005 tol_rel=0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=12 metric=0.7014 head_norm=1.057736
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.466748e-01
[S11] stored merged vector for next round verification (round=12)
[S11] DEBUG after merge:  round=12 metric=0.7014 head_norm=1.111530 delta_norm=0.146675
[S11] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=12 metric=0.6931 head_norm=1.181194
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.792529e-01
[S15] stored merged vector for next round verification (round=12)
[S15] DEBUG after merge:  round=12 metric=0.6932 head_norm=0.933308 delta_norm=0.379253
[S15] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.346012 cos_to_last_merge=1.0000 (last merge round=12)
[S2] round=13 local utility u=0.868772 metrics={'f1_val': 0.6996395837866252, 'auprc': 0.6575015404009172, 'loss_val': 0.5812625879408391, 'psi': 0.682784366432342}-{'f1_val': 0.39378997906960117, 'auprc': 0.7773150098154309, 'loss_val': 0.8431491637450481, 'psi': 0.5471999913679331}
[S3] START round=13 head_norm_before_train=0.753163 cos_to_last_merge=1.0000 (last merge round=12)
[S3] round=13 local utility u=0.000000 metrics={'f1_val': 0.5426617317077601, 'auprc': 0.771877897899429, 'loss_val': 0.7778972321215457, 'psi': 0.6343481981844277}-{'f1_val': 0.6544492549507794, 'auprc': 0.7898835102146287, 'loss_val': 0.896374608536594, 'psi': 0.7086229570563192}
[S4] START round=13 head_norm_before_train=1.077657 cos_to_last_merge=1.0000 (last merge round=12)
[S4] round=13 local utility u=0.000000 metrics={'f1_val': 0.4348621920105362, 'auprc': 0.7585062330151779, 'loss_val': 0.722715272810022, 'psi': 0.5643198084123929}-{'f1_val': 0.6202141626243122, 'auprc': 0.6792675944796314, 'loss_val': 0.7346013529766693, 'psi': 0.6438355353664398}
[S5] START round=13 head_norm_before_train=1.022231 cos_to_last_merge=0.9971 (last merge round=11)
[S5] round=13 local utility u=0.044273 metrics={'f1_val': 0.7005691551769304, 'auprc': 0.7949293138691496, 'loss_val': 0.5910319809806027, 'psi': 0.7383132186538182}-{'f1_val': 0.7091437057449593, 'auprc': 0.7947366885999539, 'loss_val': 0.730448159016276, 'psi': 0.7433808988869572}
[S6] START round=13 head_norm_before_train=1.063687 cos_to_last_merge=0.8312 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.831
[S6] round=13 local utility u=0.011279 metrics={'f1_val': 0.7098830125973228, 'auprc': 0.7919814568137841, 'loss_val': 0.5257073312130429, 'psi': 0.7427223902839073}-{'f1_val': 0.7092224700698951, 'auprc': 0.7929631232733328, 'loss_val': 0.54724698462871, 'psi': 0.7427187313512702}
[S7] START round=13 head_norm_before_train=0.725755 cos_to_last_merge=1.0000 (last merge round=12)
[S7] round=13 local utility u=0.015897 metrics={'f1_val': 0.7145635158433037, 'auprc': 0.7768441144693987, 'loss_val': 0.8557107315174148, 'psi': 0.7394757552937417}-{'f1_val': 0.714792420046008, 'auprc': 0.7771179248669355, 'loss_val': 0.8896988121252397, 'psi': 0.739722621974379}
[S8] START round=13 head_norm_before_train=1.283779 cos_to_last_merge=0.8704 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.870
[S8] round=13 local utility u=0.055957 metrics={'f1_val': 0.7138229449839267, 'auprc': 0.9962975972965882, 'loss_val': 0.26801290090329877, 'psi': 0.8268128059089913}-{'f1_val': 0.7009013631746674, 'auprc': 0.9944460585154907, 'loss_val': 0.2968419016647019, 'psi': 0.8183192413109968}
[S9] START round=13 head_norm_before_train=1.293120 cos_to_last_merge=0.8412 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.841
[S9] round=13 local utility u=0.005162 metrics={'f1_val': 0.7013629453504064, 'auprc': 0.9988489606515697, 'loss_val': 0.27771998501792516, 'psi': 0.8203573514708717}-{'f1_val': 0.7013629453504064, 'auprc': 0.9986797984322986, 'loss_val': 0.2875357608618379, 'psi': 0.8202896865831633}
[S10] START round=13 head_norm_before_train=1.116845 cos_to_last_merge=1.0000 (last merge round=12)
[S10] round=13 local utility u=0.012128 metrics={'f1_val': 0.6983206586081276, 'auprc': 0.9973646046179118, 'loss_val': 0.4649869588000493, 'psi': 0.8179382370120414}-{'f1_val': 0.7001085408329333, 'auprc': 0.9973102781670647, 'loss_val': 0.499808011254136, 'psi': 0.8189892357665859}
[S11] START round=13 head_norm_before_train=1.111530 cos_to_last_merge=1.0000 (last merge round=12)
[S11] round=13 local utility u=0.040691 metrics={'f1_val': 0.701890640953942, 'auprc': 0.9422572900956401, 'loss_val': 0.574439914996724, 'psi': 0.7980373006106213}-{'f1_val': 0.7014079839878589, 'auprc': 0.9417614422295746, 'loss_val': 0.6514385323960576, 'psi': 0.7975493672845452}
[S13] START round=13 head_norm_before_train=0.796602 cos_to_last_merge=0.9946 (last merge round=11)
[S13] round=13 local utility u=0.000000 metrics={'f1_val': 0.37653913562101954, 'auprc': 0.6681117504791627, 'loss_val': 0.9638494107589144, 'psi': 0.4931681815642768}-{'f1_val': 0.3777574829926902, 'auprc': 0.7488721147652214, 'loss_val': 1.0155729254992036, 'psi': 0.5262033357017026}
[S14] START round=13 head_norm_before_train=1.379059 cos_to_last_merge=1.0000 (last merge round=12)
[S14] round=13 local utility u=0.013826 metrics={'f1_val': 0.9968416569831653, 'auprc': 0.9970681007385643, 'loss_val': 0.1029767312434548, 'psi': 0.9969322344853249}-{'f1_val': 0.9980847028057478, 'auprc': 0.9970642439439661, 'loss_val': 0.13807575377532189, 'psi': 0.9976765192610351}
[S15] START round=13 head_norm_before_train=0.933308 cos_to_last_merge=1.0000 (last merge round=12)
[S15] round=13 local utility u=0.713918 metrics={'f1_val': 0.8133377705584687, 'auprc': 0.977118888706938, 'loss_val': 0.49577782834166156, 'psi': 0.8788502178178563}-{'f1_val': 0.6930684073917, 'auprc': 0.7740357944535523, 'loss_val': 0.5927490059876654, 'psi': 0.7254553622164409}
[S16] START round=13 head_norm_before_train=1.565942 (no previous merge yet)
[S16] round=13 local utility u=0.000000 metrics={'f1_val': 0.49298786271424344, 'auprc': 0.8086140374848043, 'loss_val': 0.6031908645856403, 'psi': 0.6192383326224677}-{'f1_val': 0.8204553414188694, 'auprc': 0.7829657577399217, 'loss_val': 0.7243834460761056, 'psi': 0.8054595079472904}
[S17] START round=13 head_norm_before_train=1.533210 (no previous merge yet)
[S17] round=13 local utility u=0.015861 metrics={'f1_val': 0.36889369868969923, 'auprc': 0.8800329774451463, 'loss_val': 0.8332688020207024, 'psi': 0.5733494101918781}-{'f1_val': 0.36700126722403026, 'auprc': 0.877234528329488, 'loss_val': 0.8452411895552757, 'psi': 0.5710945716662134}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] sending update (kind=head size=1793 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S15] → sending delta(kind=head bytes=1787) to S11@127.0.0.1:63212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:63214
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:63211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:63203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:63209
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] sending update (kind=head size=1805 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:63204
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] sending update (kind=head size=1805 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] sending update (kind=head size=1794 to 1 peers)
[S7] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1787 to 1 peers)
[S11] sending update (kind=head size=1794 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1795) from S7
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.760400)
[S4] loaded HEAD from S7 (vec_in norm=0.760400)
[S4] cosine check vs S7: cos=0.8865
[S4] BUFFERED delta from S7 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1798) from S2
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.373882)
[S8] loaded HEAD from S2 (vec_in norm=1.373882)
[S8] cosine check vs S2: cos=-0.0527
[S8] DROPPED delta from S2 (cos=-0.0527 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1798) from S10
[S14] model_id mismatch: wear != wear
[S14] after if model_id mismatch: wear != wear
[S14] loaded HEAD from S10 (keys=['weight', 'bias'], vec_norm=1.163460)
[S14] loaded HEAD from S10 (vec_in norm=1.163460)
[S14] cosine check vs S10: cos=0.9501
[S14] BUFFERED delta from S10 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1794) from S11
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.152508)
[S3] loaded HEAD from S11 (vec_in norm=1.152508)
[S3] cosine check vs S11: cos=0.9156
[S3] BUFFERED delta from S11 (total buffered=1)
[S11] RECEIVED delta(kind=head bytes=1787) from S15
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=0.985252)
[S11] loaded HEAD from S15 (vec_in norm=0.985252)
[S11] cosine check vs S15: cos=0.9439
[S11] BUFFERED delta from S15 (total buffered=1)
[S10] RECEIVED delta(kind=head bytes=1799) from S5
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.064182)
[S10] loaded HEAD from S5 (vec_in norm=1.064182)
[S10] cosine check vs S5: cos=0.9067
[S10] BUFFERED delta from S5 (total buffered=1)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=13 metric=0.9968 head_norm=1.430399
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.435889e-01
[S14] stored merged vector for next round verification (round=13)
[S14] DEBUG after merge:  round=13 metric=0.9964 head_norm=1.280822 delta_norm=0.243589
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=13 metric=0.4349 head_norm=1.114340
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.818241e-01
[S4] stored merged vector for next round verification (round=13)
[S4] DEBUG after merge:  round=13 metric=0.4350 head_norm=0.911349 delta_norm=0.281824
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=13 metric=0.5427 head_norm=0.822206
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.593691e-01
[S3] stored merged vector for next round verification (round=13)
[S3] DEBUG after merge:  round=13 metric=0.5376 head_norm=0.966890 delta_norm=0.259369
[S3] aggregate: ROLLBACK (f1_val pre=0.543 post=0.538 tol_abs=0.005 tol_rel=0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=13 metric=0.7019 head_norm=1.152508
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.970895e-01
[S11] stored merged vector for next round verification (round=13)
[S11] DEBUG after merge:  round=13 metric=0.7019 head_norm=1.053876 delta_norm=0.197090
[S11] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=13 metric=0.6983 head_norm=1.163460
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.453530e-01
[S10] stored merged vector for next round verification (round=13)
[S10] DEBUG after merge:  round=13 metric=0.6985 head_norm=1.087595 delta_norm=0.245353
[S10] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.373882 cos_to_last_merge=0.9990 (last merge round=12)
[S2] round=14 local utility u=0.202214 metrics={'f1_val': 0.7012866315564704, 'auprc': 0.7777002751777359, 'loss_val': 0.5473136101531273, 'psi': 0.7318520890049767}-{'f1_val': 0.6996395837866252, 'auprc': 0.6575015404009172, 'loss_val': 0.5812625879408391, 'psi': 0.682784366432342}
[S3] START round=14 head_norm_before_train=0.966890 cos_to_last_merge=1.0000 (last merge round=13)
[S3] round=14 local utility u=0.524423 metrics={'f1_val': 0.6342427375376621, 'auprc': 0.8688355449299942, 'loss_val': 0.5694111127068194, 'psi': 0.7280798604945949}-{'f1_val': 0.5426617317077601, 'auprc': 0.771877897899429, 'loss_val': 0.7778972321215457, 'psi': 0.6343481981844277}
[S4] START round=14 head_norm_before_train=0.911349 cos_to_last_merge=1.0000 (last merge round=13)
[S4] round=14 local utility u=0.000000 metrics={'f1_val': 0.437948256597305, 'auprc': 0.6743185759879857, 'loss_val': 0.7192023162282687, 'psi': 0.5324963843535773}-{'f1_val': 0.4348621920105362, 'auprc': 0.7585062330151779, 'loss_val': 0.722715272810022, 'psi': 0.5643198084123929}
[S5] START round=14 head_norm_before_train=1.064182 cos_to_last_merge=0.9896 (last merge round=11)
[S5] round=14 local utility u=0.000000 metrics={'f1_val': 0.660824819657509, 'auprc': 0.7916395536978851, 'loss_val': 0.6778624258157034, 'psi': 0.7131507132736594}-{'f1_val': 0.7005691551769304, 'auprc': 0.7949293138691496, 'loss_val': 0.5910319809806027, 'psi': 0.7383132186538182}
[S6] START round=14 head_norm_before_train=1.115847 cos_to_last_merge=0.8142 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.814
[S6] round=14 local utility u=0.248014 metrics={'f1_val': 0.6967377382891293, 'auprc': 0.9420737163949175, 'loss_val': 0.4010839889148434, 'psi': 0.7948721295314447}-{'f1_val': 0.7098830125973228, 'auprc': 0.7919814568137841, 'loss_val': 0.5257073312130429, 'psi': 0.7427223902839073}
[S7] START round=14 head_norm_before_train=0.760400 cos_to_last_merge=0.9948 (last merge round=12)
[S7] round=14 local utility u=0.036863 metrics={'f1_val': 0.6998672030326233, 'auprc': 0.7943146395714112, 'loss_val': 0.7462190453391973, 'psi': 0.7376461776481384}-{'f1_val': 0.7145635158433037, 'auprc': 0.7768441144693987, 'loss_val': 0.8557107315174148, 'psi': 0.7394757552937417}
[S8] START round=14 head_norm_before_train=1.327658 cos_to_last_merge=0.8580 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.858
[S8] round=14 local utility u=0.025038 metrics={'f1_val': 0.7141096062959231, 'auprc': 0.9982562318887749, 'loss_val': 0.2255334027823802, 'psi': 0.8277682565330639}-{'f1_val': 0.7138229449839267, 'auprc': 0.9962975972965882, 'loss_val': 0.26801290090329877, 'psi': 0.8268128059089913}
[S9] START round=14 head_norm_before_train=1.326427 cos_to_last_merge=0.8340 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.834
[S9] round=14 local utility u=0.002664 metrics={'f1_val': 0.7013629453504064, 'auprc': 0.9988442768885122, 'loss_val': 0.27237751503493796, 'psi': 0.8203554779656488}-{'f1_val': 0.7013629453504064, 'auprc': 0.9988489606515697, 'loss_val': 0.27771998501792516, 'psi': 0.8203573514708717}
[S10] START round=14 head_norm_before_train=1.087595 cos_to_last_merge=1.0000 (last merge round=13)
[S10] round=14 local utility u=0.000000 metrics={'f1_val': 0.6915120998589867, 'auprc': 0.9946100431152981, 'loss_val': 0.43944426120942764, 'psi': 0.8127512771615113}-{'f1_val': 0.6983206586081276, 'auprc': 0.9973646046179118, 'loss_val': 0.4649869588000493, 'psi': 0.8179382370120414}
[S11] START round=14 head_norm_before_train=1.053876 cos_to_last_merge=1.0000 (last merge round=13)
[S11] round=14 local utility u=0.088422 metrics={'f1_val': 0.7018246587012323, 'auprc': 0.9839681352568226, 'loss_val': 0.522332087026461, 'psi': 0.8146820493234684}-{'f1_val': 0.701890640953942, 'auprc': 0.9422572900956401, 'loss_val': 0.574439914996724, 'psi': 0.7980373006106213}
[S13] START round=14 head_norm_before_train=0.824830 cos_to_last_merge=0.9814 (last merge round=11)
[S13] round=14 local utility u=0.464362 metrics={'f1_val': 0.48226852742269294, 'auprc': 0.7292376581021864, 'loss_val': 0.8528786125882528, 'psi': 0.5810561796944903}-{'f1_val': 0.37653913562101954, 'auprc': 0.6681117504791627, 'loss_val': 0.9638494107589144, 'psi': 0.4931681815642768}
[S14] START round=14 head_norm_before_train=1.280822 cos_to_last_merge=1.0000 (last merge round=13)
[S14] round=14 local utility u=0.000000 metrics={'f1_val': 0.9552022724683502, 'auprc': 0.9970109481093073, 'loss_val': 0.13156209310100642, 'psi': 0.971925742724733}-{'f1_val': 0.9968416569831653, 'auprc': 0.9970681007385643, 'loss_val': 0.1029767312434548, 'psi': 0.9969322344853249}
[S15] START round=14 head_norm_before_train=0.985252 cos_to_last_merge=0.9962 (last merge round=12)
[S15] round=14 local utility u=0.000000 metrics={'f1_val': 0.691373181575959, 'auprc': 0.7694084666266665, 'loss_val': 0.5315621205585493, 'psi': 0.722587295596242}-{'f1_val': 0.8133377705584687, 'auprc': 0.977118888706938, 'loss_val': 0.49577782834166156, 'psi': 0.8788502178178563}
[S16] START round=14 head_norm_before_train=1.597052 (no previous merge yet)
[S16] round=14 local utility u=0.923594 metrics={'f1_val': 0.8158438506459358, 'auprc': 0.8447936638675588, 'loss_val': 0.8016781886452476, 'psi': 0.827423775934585}-{'f1_val': 0.49298786271424344, 'auprc': 0.8086140374848043, 'loss_val': 0.6031908645856403, 'psi': 0.6192383326224677}
[S17] START round=14 head_norm_before_train=1.554022 (no previous merge yet)
[S17] round=14 local utility u=0.098902 metrics={'f1_val': 0.3865732382902861, 'auprc': 0.8817780157711518, 'loss_val': 0.7467775850827879, 'psi': 0.5846551492826324}-{'f1_val': 0.36889369868969923, 'auprc': 0.8800329774451463, 'loss_val': 0.8332688020207024, 'psi': 0.5733494101918781}
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S11]  timeout peer S2
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S5]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S6]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S16
[S13]  timeout peer S17
[S2]  timeout peer S3
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S3]  timeout peer S2
[S3]  timeout peer S4
[S3]  timeout peer S6
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S16
[S14]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S16
[S8]  timeout peer S17
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:63203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] sending update (kind=head size=1795 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] → sending delta(kind=head bytes=1794) to S7@127.0.0.1:63208
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S4@127.0.0.1:63204
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:63209
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S9] sending update (kind=head size=1790 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:63215
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1794 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1801) from S13
[S15] model_id mismatch: wear != wear
[S15] after if model_id mismatch: wear != wear
[S15] loaded HEAD from S13 (keys=['weight', 'bias'], vec_norm=0.860527)
[S15] loaded HEAD from S13 (vec_in norm=0.860527)
[S15] cosine check vs S13: cos=0.8654
[S15] BUFFERED delta from S13 (total buffered=1)
[S8] RECEIVED delta(kind=head bytes=1802) from S2
[S8] model_id mismatch: wear != wear
[S8] after if model_id mismatch: wear != wear
[S8] loaded HEAD from S2 (keys=['weight', 'bias'], vec_norm=1.402300)
[S8] loaded HEAD from S2 (vec_in norm=1.402300)
[S8] cosine check vs S2: cos=-0.0511
[S8] DROPPED delta from S2 (cos=-0.0511 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1794) from S3
[S7] model_id mismatch: wear != wear
[S7] after if model_id mismatch: wear != wear
[S7] loaded HEAD from S3 (keys=['weight', 'bias'], vec_norm=1.020974)
[S7] loaded HEAD from S3 (vec_in norm=1.020974)
[S7] cosine check vs S3: cos=0.4268
[S7] BUFFERED delta from S3 (total buffered=1)
[S7] sending update (kind=head size=1804 to 1 peers)
[S11] sending update (kind=head size=1794 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1804) from S7
[S4] model_id mismatch: wear != wear
[S4] after if model_id mismatch: wear != wear
[S4] loaded HEAD from S7 (keys=['weight', 'bias'], vec_norm=0.807979)
[S4] loaded HEAD from S7 (vec_in norm=0.807979)
[S4] cosine check vs S7: cos=0.9439
[S4] BUFFERED delta from S7 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1794) from S11
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.096477)
[S3] loaded HEAD from S11 (vec_in norm=1.096477)
[S3] cosine check vs S11: cos=0.9697
[S3] BUFFERED delta from S11 (total buffered=1)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=14 metric=0.6999 head_norm=0.807979
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.977503e-01
[S7] stored merged vector for next round verification (round=14)
[S7] DEBUG after merge:  round=14 metric=0.6814 head_norm=0.774502 delta_norm=0.497750
[S7] aggregate: ROLLBACK (f1_val pre=0.700 post=0.681 tol_abs=0.005 tol_rel=0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=14 metric=0.4379 head_norm=0.954556
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.643707e-01
[S4] stored merged vector for next round verification (round=14)
[S4] DEBUG after merge:  round=14 metric=0.4363 head_norm=0.868900 delta_norm=0.164371
[S4] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S3] CommDone barrier timeout: have=1 need=2 — continuing
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=14 metric=0.6342 head_norm=1.020974
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.355815e-01
[S3] stored merged vector for next round verification (round=14)
[S3] DEBUG after merge:  round=14 metric=0.6330 head_norm=1.050686 delta_norm=0.135581
[S3] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.402300 cos_to_last_merge=0.9965 (last merge round=12)
[S2] round=15 local utility u=0.000000 metrics={'f1_val': 0.7005925029290768, 'auprc': 0.7025753479656776, 'loss_val': 0.5054863633060163, 'psi': 0.7013856409437171}-{'f1_val': 0.7012866315564704, 'auprc': 0.7777002751777359, 'loss_val': 0.5473136101531273, 'psi': 0.7318520890049767}
[S3] START round=15 head_norm_before_train=1.050686 cos_to_last_merge=1.0000 (last merge round=14)
[S3] round=15 local utility u=0.000000 metrics={'f1_val': 0.5082623990222048, 'auprc': 0.7689060146156472, 'loss_val': 0.7460239965476191, 'psi': 0.6125198452595818}-{'f1_val': 0.6342427375376621, 'auprc': 0.8688355449299942, 'loss_val': 0.5694111127068194, 'psi': 0.7280798604945949}
[S4] START round=15 head_norm_before_train=0.868900 cos_to_last_merge=1.0000 (last merge round=14)
[S4] round=15 local utility u=0.057966 metrics={'f1_val': 0.4519840752607868, 'auprc': 0.6735326496396955, 'loss_val': 0.6851272541840822, 'psi': 0.5406035050123503}-{'f1_val': 0.437948256597305, 'auprc': 0.6743185759879857, 'loss_val': 0.7192023162282687, 'psi': 0.5324963843535773}
[S5] START round=15 head_norm_before_train=1.104820 cos_to_last_merge=0.9806 (last merge round=11)
[S5] round=15 local utility u=0.517158 metrics={'f1_val': 0.700323158105602, 'auprc': 0.9952749582753728, 'loss_val': 0.4914436355049952, 'psi': 0.8183038781735104}-{'f1_val': 0.660824819657509, 'auprc': 0.7916395536978851, 'loss_val': 0.6778624258157034, 'psi': 0.7131507132736594}
[S6] START round=15 head_norm_before_train=1.160954 cos_to_last_merge=0.8009 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.801
[S6] round=15 local utility u=0.000000 metrics={'f1_val': 0.7036851800193251, 'auprc': 0.7763823083891909, 'loss_val': 0.5152730260313404, 'psi': 0.7327640313672714}-{'f1_val': 0.6967377382891293, 'auprc': 0.9420737163949175, 'loss_val': 0.4010839889148434, 'psi': 0.7948721295314447}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=15 head_norm_before_train=0.774502 cos_to_last_merge=1.0000 (last merge round=14)
[S7] round=15 local utility u=0.000000 metrics={'f1_val': 0.6945582751387398, 'auprc': 0.7942587374105725, 'loss_val': 0.8074481807599123, 'psi': 0.7344384600474729}-{'f1_val': 0.6998672030326233, 'auprc': 0.7943146395714112, 'loss_val': 0.7462190453391973, 'psi': 0.7376461776481384}
[S8] START round=15 head_norm_before_train=1.364801 cos_to_last_merge=0.8494 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.849
[S8] round=15 local utility u=0.883577 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9987006444239153, 'loss_val': 0.15317437721381275, 'psi': 0.9972921027309409}-{'f1_val': 0.7141096062959231, 'auprc': 0.9982562318887749, 'loss_val': 0.2255334027823802, 'psi': 0.8277682565330639}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=15 head_norm_before_train=1.354213 cos_to_last_merge=0.8277 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.828
[S9] round=15 local utility u=0.000000 metrics={'f1_val': 0.7013613595118124, 'auprc': 0.994809208274554, 'loss_val': 0.2705999218744401, 'psi': 0.8187404990169092}-{'f1_val': 0.7013629453504064, 'auprc': 0.9988442768885122, 'loss_val': 0.27237751503493796, 'psi': 0.8203554779656488}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=15 head_norm_before_train=1.138898 cos_to_last_merge=0.9978 (last merge round=13)
[S10] round=15 local utility u=0.000000 metrics={'f1_val': 0.46405252648843104, 'auprc': 0.8668498025984266, 'loss_val': 0.5858161757193684, 'psi': 0.6251714369324293}-{'f1_val': 0.6915120998589867, 'auprc': 0.9946100431152981, 'loss_val': 0.43944426120942764, 'psi': 0.8127512771615113}
[S11] START round=15 head_norm_before_train=1.096477 cos_to_last_merge=0.9987 (last merge round=13)
[S11] round=15 local utility u=0.049895 metrics={'f1_val': 0.7020664967782734, 'auprc': 0.9953041721086309, 'loss_val': 0.45800114269167513, 'psi': 0.8193615669104164}-{'f1_val': 0.7018246587012323, 'auprc': 0.9839681352568226, 'loss_val': 0.522332087026461, 'psi': 0.8146820493234684}
[S13] START round=15 head_norm_before_train=0.860527 cos_to_last_merge=0.9639 (last merge round=11)
[S13] round=15 local utility u=0.000000 metrics={'f1_val': 0.421282442040893, 'auprc': 0.6294017943500706, 'loss_val': 0.8414783227610583, 'psi': 0.5045301829645641}-{'f1_val': 0.48226852742269294, 'auprc': 0.7292376581021864, 'loss_val': 0.8528786125882528, 'psi': 0.5810561796944903}
[S14] START round=15 head_norm_before_train=1.328316 cos_to_last_merge=0.9996 (last merge round=13)
[S14] round=15 local utility u=0.000000 metrics={'f1_val': 0.9371216152180258, 'auprc': 0.9970976139405574, 'loss_val': 0.1299169289830372, 'psi': 0.9611120147070384}-{'f1_val': 0.9552022724683502, 'auprc': 0.9970109481093073, 'loss_val': 0.13156209310100642, 'psi': 0.971925742724733}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=15 head_norm_before_train=1.038520 cos_to_last_merge=0.9883 (last merge round=12)
[S15] round=15 local utility u=0.206528 metrics={'f1_val': 0.6999792852916146, 'auprc': 0.8694007493410131, 'loss_val': 0.4701188496714893, 'psi': 0.767747870911374}-{'f1_val': 0.691373181575959, 'auprc': 0.7694084666266665, 'loss_val': 0.5315621205585493, 'psi': 0.722587295596242}
[S16] START round=15 head_norm_before_train=1.622229 (no previous merge yet)
[S16] round=15 local utility u=0.594392 metrics={'f1_val': 0.89753291482514, 'auprc': 0.9431985552377459, 'loss_val': 0.3982437441252707, 'psi': 0.9157991709901823}-{'f1_val': 0.8158438506459358, 'auprc': 0.8447936638675588, 'loss_val': 0.8016781886452476, 'psi': 0.827423775934585}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S17] START round=15 head_norm_before_train=1.574107 (no previous merge yet)
[S17] round=15 local utility u=0.000000 metrics={'f1_val': 0.38827790884409963, 'auprc': 0.874053353448488, 'loss_val': 0.781816831621344, 'psi': 0.582588086685855}-{'f1_val': 0.3865732382902861, 'auprc': 0.8817780157711518, 'loss_val': 0.7467775850827879, 'psi': 0.5846551492826324}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:63203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:63212
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1800 to 1 peers)
[S7] ⇄ pheromone p=0.208 → S4@127.0.0.1:63204
[S11] sending update (kind=head size=1796 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:63202
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:63211
[S10] ⇄ pheromone p=0.194 → S14@127.0.0.1:63214
[S11] RECEIVED delta(kind=head bytes=1800) from S15
[S11] model_id mismatch: wear != wear
[S11] after if model_id mismatch: wear != wear
[S11] loaded HEAD from S15 (keys=['weight', 'bias'], vec_norm=1.092200)
[S11] loaded HEAD from S15 (vec_in norm=1.092200)
[S11] cosine check vs S15: cos=0.9576
[S11] BUFFERED delta from S15 (total buffered=1)
[S3] RECEIVED delta(kind=head bytes=1796) from S11
[S3] model_id mismatch: wear != wear
[S3] after if model_id mismatch: wear != wear
[S3] loaded HEAD from S11 (keys=['weight', 'bias'], vec_norm=1.143486)
[S3] loaded HEAD from S11 (vec_in norm=1.143486)
[S3] cosine check vs S11: cos=0.9877
[S3] BUFFERED delta from S11 (total buffered=1)
[S5] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=15 metric=0.7021 head_norm=1.143486
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.647118e-01
[S11] stored merged vector for next round verification (round=15)
[S11] DEBUG after merge:  round=15 metric=0.7021 head_norm=1.105939 delta_norm=0.164712
[S11] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.204 → S3@127.0.0.1:63203
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=15 metric=0.7000 head_norm=1.092200
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.855382e-01
[S15] stored merged vector for next round verification (round=15)
[S15] DEBUG after merge:  round=15 metric=0.7000 head_norm=0.940836 delta_norm=0.285538
[S15] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.238 → S11@127.0.0.1:63212
[S10] RECEIVED delta(kind=head bytes=1801) from S5
[S10] model_id mismatch: wear != wear
[S10] after if model_id mismatch: wear != wear
[S10] loaded HEAD from S5 (keys=['weight', 'bias'], vec_norm=1.135634)
[S10] loaded HEAD from S5 (vec_in norm=1.135634)
[S10] cosine check vs S5: cos=0.9428
[S10] BUFFERED delta from S5 (total buffered=1)
[S2] RECEIVED delta(kind=head bytes=1802) from S4
[S2] model_id mismatch: wear != wear
[S2] after if model_id mismatch: wear != wear
[S2] loaded HEAD from S4 (keys=['weight', 'bias'], vec_norm=0.919523)
[S2] loaded HEAD from S4 (vec_in norm=0.919523)
[S2] cosine check vs S4: cos=0.7806
[S2] BUFFERED delta from S4 (total buffered=1)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] ⇄ pheromone p=0.155 → S2@127.0.0.1:63202
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=15 metric=0.7006 head_norm=1.432054
[S2] _apply_head_vector_avg (torch): Δ‖w‖=4.583935e-01
[S2] stored merged vector for next round verification (round=15)
[S2] DEBUG after merge:  round=15 metric=0.7008 head_norm=1.112666 delta_norm=0.458393
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.229 → S8@127.0.0.1:63209
[S7]  timeout peer S4
[S5]  timeout peer S9
[S5]  timeout peer S10
[S3]  timeout peer S5
[S3]  timeout peer S7
[S3]  timeout peer S13
[S15]  timeout peer S11
[S11]  timeout peer S3
[S4]  timeout peer S2
[S4]  timeout peer S16
[S13]  timeout peer S6
[S13]  timeout peer S15
[S2]  timeout peer S8
[S2]  timeout peer S17
[S10]  timeout peer S14
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=15 metric=0.5083 head_norm=1.093268
[S3] _apply_head_vector_avg (torch): Δ‖w‖=9.137248e-02
[S3] stored merged vector for next round verification (round=15)
[S3] DEBUG after merge:  round=15 metric=0.5063 head_norm=1.114921 delta_norm=0.091372
[S3] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=16 head_norm_before_train=1.112666 cos_to_last_merge=1.0000 (last merge round=15)
[S2] round=16 local utility u=0.000000 metrics={'f1_val': 0.7003323196347389, 'auprc': 0.6423859993806134, 'loss_val': 0.5351778000290655, 'psi': 0.6771537915330887}-{'f1_val': 0.7005925029290768, 'auprc': 0.7025753479656776, 'loss_val': 0.5054863633060163, 'psi': 0.7013856409437171}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=16 head_norm_before_train=1.114921 cos_to_last_merge=1.0000 (last merge round=15)
[S3] round=16 local utility u=0.660896 metrics={'f1_val': 0.6129788119141713, 'auprc': 0.9342472737850884, 'loss_val': 0.5485546941061772, 'psi': 0.7414861966625381}-{'f1_val': 0.5082623990222048, 'auprc': 0.7689060146156472, 'loss_val': 0.7460239965476191, 'psi': 0.6125198452595818}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] sending update (kind=head size=1805 to 1 peers)
[S4] START round=16 head_norm_before_train=0.919523 cos_to_last_merge=0.9979 (last merge round=14)
[S4] round=16 local utility u=0.622952 metrics={'f1_val': 0.6568267794156426, 'auprc': 0.6633540855540834, 'loss_val': 0.6377431026842316, 'psi': 0.6594377018710189}-{'f1_val': 0.4519840752607868, 'auprc': 0.6735326496396955, 'loss_val': 0.6851272541840822, 'psi': 0.5406035050123503}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=16 head_norm_before_train=1.135634 cos_to_last_merge=0.9736 (last merge round=11)
[S5] round=16 local utility u=0.000000 metrics={'f1_val': 0.714400588689728, 'auprc': 0.7915152860818344, 'loss_val': 0.5354533583965815, 'psi': 0.7452464676465707}-{'f1_val': 0.700323158105602, 'auprc': 0.9952749582753728, 'loss_val': 0.4914436355049952, 'psi': 0.8183038781735104}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=16 head_norm_before_train=1.192822 cos_to_last_merge=0.7915 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.792
[S6] round=16 local utility u=0.235295 metrics={'f1_val': 0.7087018680577621, 'auprc': 0.8780054108724644, 'loss_val': 0.3796525344045383, 'psi': 0.776423285183643}-{'f1_val': 0.7036851800193251, 'auprc': 0.7763823083891909, 'loss_val': 0.5152730260313404, 'psi': 0.7327640313672714}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[S7] START round=16 head_norm_before_train=0.812410 cos_to_last_merge=0.9951 (last merge round=14)
[S7] round=16 local utility u=0.094195 metrics={'f1_val': 0.6987434167887595, 'auprc': 0.7940367822107712, 'loss_val': 0.6435031146155276, 'psi': 0.7368607629575643}-{'f1_val': 0.6945582751387398, 'auprc': 0.7942587374105725, 'loss_val': 0.8074481807599123, 'psi': 0.7344384600474729}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] sending update (kind=head size=1796 to 1 peers)
[S8] START round=16 head_norm_before_train=1.398970 cos_to_last_merge=0.8409 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.841
[S8] round=16 local utility u=0.016522 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9986156971341972, 'loss_val': 0.11987582591292247, 'psi': 0.9972581238150536}-{'f1_val': 0.9963530749356245, 'auprc': 0.9987006444239153, 'loss_val': 0.15317437721381275, 'psi': 0.9972921027309409}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=16 head_norm_before_train=1.376333 cos_to_last_merge=0.8225 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.823
[S9] round=16 local utility u=0.010458 metrics={'f1_val': 0.7012888352718426, 'auprc': 0.9984603638579502, 'loss_val': 0.2602013817099787, 'psi': 0.8201574467062858}-{'f1_val': 0.7013613595118124, 'auprc': 0.994809208274554, 'loss_val': 0.2705999218744401, 'psi': 0.8187404990169092}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] sending update (kind=head size=1793 to 1 peers)
[S10] START round=16 head_norm_before_train=1.191314 cos_to_last_merge=0.9926 (last merge round=13)
[S10] round=16 local utility u=0.136342 metrics={'f1_val': 0.49836282986696734, 'auprc': 0.8740424291351399, 'loss_val': 0.540572404270188, 'psi': 0.6486346695742364}-{'f1_val': 0.46405252648843104, 'auprc': 0.8668498025984266, 'loss_val': 0.5858161757193684, 'psi': 0.6251714369324293}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=16 metric=0.4984 head_norm=1.233647
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.207171e-01
[S10] stored merged vector for next round verification (round=16)
[S10] DEBUG after merge:  round=16 metric=0.5001 head_norm=1.164929 delta_norm=0.220717
[S10] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S11] START round=16 head_norm_before_train=1.105939 cos_to_last_merge=1.0000 (last merge round=15)
[S11] round=16 local utility u=0.040717 metrics={'f1_val': 0.7020007759458987, 'auprc': 0.9980570450691606, 'loss_val': 0.38443156299340453, 'psi': 0.8204232835952034}-{'f1_val': 0.7020664967782734, 'auprc': 0.9953041721086309, 'loss_val': 0.45800114269167513, 'psi': 0.8193615669104164}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=16 head_norm_before_train=0.898698 cos_to_last_merge=0.9455 (last merge round=11)
[S13] ⚠️ Model drifted since last merge! cos=0.946
[S13] round=16 local utility u=1.000000 metrics={'f1_val': 0.7067659806341042, 'auprc': 0.7342103220624299, 'loss_val': 0.6531368725445875, 'psi': 0.7177437172054345}-{'f1_val': 0.421282442040893, 'auprc': 0.6294017943500706, 'loss_val': 0.8414783227610583, 'psi': 0.5045301829645641}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=16 head_norm_before_train=1.379849 cos_to_last_merge=0.9982 (last merge round=13)
[S14] round=16 local utility u=0.212283 metrics={'f1_val': 0.9983050875260411, 'auprc': 0.9968828932004741, 'loss_val': 0.07180800411105082, 'psi': 0.9977362097958143}-{'f1_val': 0.9371216152180258, 'auprc': 0.9970976139405574, 'loss_val': 0.1299169289830372, 'psi': 0.9611120147070384}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=16 head_norm_before_train=0.940836 cos_to_last_merge=1.0000 (last merge round=15)
[S15] round=16 local utility u=0.000000 metrics={'f1_val': 0.6927898477818142, 'auprc': 0.8000749660108805, 'loss_val': 0.5069926726316244, 'psi': 0.7357038950734407}-{'f1_val': 0.6999792852916146, 'auprc': 0.8694007493410131, 'loss_val': 0.4701188496714893, 'psi': 0.767747870911374}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=16 head_norm_before_train=1.645121 (no previous merge yet)
[S16] round=16 local utility u=0.236436 metrics={'f1_val': 0.9453713499555032, 'auprc': 0.967623154095442, 'loss_val': 0.2856760086559787, 'psi': 0.9542720716114788}-{'f1_val': 0.89753291482514, 'auprc': 0.9431985552377459, 'loss_val': 0.3982437441252707, 'psi': 0.9157991709901823}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=16 head_norm_before_train=1.596239 (no previous merge yet)
[S17] round=16 local utility u=0.037586 metrics={'f1_val': 0.4038985148511288, 'auprc': 0.8721284186085403, 'loss_val': 0.7945942945609223, 'psi': 0.5911904763540934}-{'f1_val': 0.38827790884409963, 'auprc': 0.874053353448488, 'loss_val': 0.781816831621344, 'psi': 0.582588086685855}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] sending update (kind=head size=1805 to 1 peers)
[S2] START round=17 head_norm_before_train=1.146402 cos_to_last_merge=0.9985 (last merge round=15)
[S2] round=17 local utility u=0.212199 metrics={'f1_val': 0.7010619368327821, 'auprc': 0.7706697168159572, 'loss_val': 0.5000086360765418, 'psi': 0.7289050488260521}-{'f1_val': 0.7003323196347389, 'auprc': 0.6423859993806134, 'loss_val': 0.5351778000290655, 'psi': 0.6771537915330887}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=17 head_norm_before_train=1.149988 cos_to_last_merge=0.9991 (last merge round=15)
[S3] round=17 local utility u=0.179685 metrics={'f1_val': 0.6369688766999011, 'auprc': 0.9843465510557421, 'loss_val': 0.483423173183991, 'psi': 0.7759199464422375}-{'f1_val': 0.6129788119141713, 'auprc': 0.9342472737850884, 'loss_val': 0.5485546941061772, 'psi': 0.7414861966625381}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] sending update (kind=head size=1795 to 1 peers)
[S4] START round=17 head_norm_before_train=0.969931 cos_to_last_merge=0.9933 (last merge round=14)
[S4] round=17 local utility u=0.364450 metrics={'f1_val': 0.6667846418431472, 'auprc': 0.8555575908533606, 'loss_val': 0.5452009734794018, 'psi': 0.7422938214472325}-{'f1_val': 0.6568267794156426, 'auprc': 0.6633540855540834, 'loss_val': 0.6377431026842316, 'psi': 0.6594377018710189}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] START round=17 head_norm_before_train=1.164161 cos_to_last_merge=0.9672 (last merge round=11)
[S5] round=17 local utility u=0.334201 metrics={'f1_val': 0.7003221706489986, 'auprc': 0.9934016999921599, 'loss_val': 0.38824069235933395, 'psi': 0.8175539823862632}-{'f1_val': 0.714400588689728, 'auprc': 0.7915152860818344, 'loss_val': 0.5354533583965815, 'psi': 0.7452464676465707}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] START round=17 head_norm_before_train=1.218385 cos_to_last_merge=0.7846 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.785
[S6] round=17 local utility u=0.000000 metrics={'f1_val': 0.7096572343948266, 'auprc': 0.7890348615297604, 'loss_val': 0.44660656044116087, 'psi': 0.7414082852488002}-{'f1_val': 0.7087018680577621, 'auprc': 0.8780054108724644, 'loss_val': 0.3796525344045383, 'psi': 0.776423285183643}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=17 head_norm_before_train=0.860256 cos_to_last_merge=0.9834 (last merge round=14)
[S7] round=17 local utility u=0.189115 metrics={'f1_val': 0.6540069722666861, 'auprc': 0.9985041075547061, 'loss_val': 0.6102573435448768, 'psi': 0.7918058263818941}-{'f1_val': 0.6987434167887595, 'auprc': 0.7940367822107712, 'loss_val': 0.6435031146155276, 'psi': 0.7368607629575643}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=17 head_norm_before_train=1.437609 cos_to_last_merge=0.8310 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.831
[S8] round=17 local utility u=0.006880 metrics={'f1_val': 0.9963743336862869, 'auprc': 0.9988211789190498, 'loss_val': 0.10685908996699052, 'psi': 0.997353071779392}-{'f1_val': 0.9963530749356245, 'auprc': 0.9986156971341972, 'loss_val': 0.11987582591292247, 'psi': 0.9972581238150536}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=17 head_norm_before_train=1.397498 cos_to_last_merge=0.8189 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.819
[S9] round=17 local utility u=0.012009 metrics={'f1_val': 0.7012888352718426, 'auprc': 0.9984309857393463, 'loss_val': 0.23609544978058314, 'psi': 0.8201456954588442}-{'f1_val': 0.7012888352718426, 'auprc': 0.9984603638579502, 'loss_val': 0.2602013817099787, 'psi': 0.8201574467062858}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] sending update (kind=head size=1792 to 1 peers)
[S10] START round=17 head_norm_before_train=1.164929 cos_to_last_merge=1.0000 (last merge round=16)
[S10] round=17 local utility u=0.890713 metrics={'f1_val': 0.7015352665295298, 'auprc': 0.9914731859959075, 'loss_val': 0.33047341571853384, 'psi': 0.8175104343160808}-{'f1_val': 0.49836282986696734, 'auprc': 0.8740424291351399, 'loss_val': 0.540572404270188, 'psi': 0.6486346695742364}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=17 head_norm_before_train=1.153604 cos_to_last_merge=0.9988 (last merge round=15)
[S11] round=17 local utility u=0.018849 metrics={'f1_val': 0.702242488399264, 'auprc': 0.9967087912742087, 'loss_val': 0.3441394199078663, 'psi': 0.820029009549242}-{'f1_val': 0.7020007759458987, 'auprc': 0.9980570450691606, 'loss_val': 0.38443156299340453, 'psi': 0.8204232835952034}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=17 head_norm_before_train=0.935094 cos_to_last_merge=0.9285 (last merge round=11)
[S13] ⚠️ Model drifted since last merge! cos=0.929
[S13] round=17 local utility u=0.000000 metrics={'f1_val': 0.6768598166391342, 'auprc': 0.716904206161232, 'loss_val': 0.6427446900011954, 'psi': 0.6928775724479733}-{'f1_val': 0.7067659806341042, 'auprc': 0.7342103220624299, 'loss_val': 0.6531368725445875, 'psi': 0.7177437172054345}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=17 head_norm_before_train=1.424695 cos_to_last_merge=0.9965 (last merge round=13)
[S14] round=17 local utility u=0.002568 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9970292447791744, 'loss_val': 0.061747335098185405, 'psi': 0.9972582944723667}-{'f1_val': 0.9983050875260411, 'auprc': 0.9968828932004741, 'loss_val': 0.07180800411105082, 'psi': 0.9977362097958143}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=17 head_norm_before_train=0.980909 cos_to_last_merge=0.9987 (last merge round=15)
[S15] round=17 local utility u=1.000000 metrics={'f1_val': 0.9731203937004492, 'auprc': 0.9662658222190443, 'loss_val': 0.33812434545927655, 'psi': 0.9703785651078873}-{'f1_val': 0.6927898477818142, 'auprc': 0.8000749660108805, 'loss_val': 0.5069926726316244, 'psi': 0.7357038950734407}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S15] sending update (kind=head size=1786 to 1 peers)
[S16] START round=17 head_norm_before_train=1.666833 (no previous merge yet)
[S16] round=17 local utility u=0.000000 metrics={'f1_val': 0.9201217869900643, 'auprc': 0.9853050667468368, 'loss_val': 0.28253295045004323, 'psi': 0.9461950988927733}-{'f1_val': 0.9453713499555032, 'auprc': 0.967623154095442, 'loss_val': 0.2856760086559787, 'psi': 0.9542720716114788}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=17 head_norm_before_train=1.623643 (no previous merge yet)
[S17] round=17 local utility u=0.068075 metrics={'f1_val': 0.4194953277505078, 'auprc': 0.8706994944188555, 'loss_val': 0.7477374032537378, 'psi': 0.5999769944178469}-{'f1_val': 0.4038985148511288, 'auprc': 0.8721284186085403, 'loss_val': 0.7945942945609223, 'psi': 0.5911904763540934}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=18 head_norm_before_train=1.187909 cos_to_last_merge=0.9947 (last merge round=15)
[S2] round=18 local utility u=0.018267 metrics={'f1_val': 0.7010387548670409, 'auprc': 0.7680382188934787, 'loss_val': 0.4554414158963745, 'psi': 0.727838540477616}-{'f1_val': 0.7010619368327821, 'auprc': 0.7706697168159572, 'loss_val': 0.5000086360765418, 'psi': 0.7289050488260521}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[S3] START round=18 head_norm_before_train=1.180995 cos_to_last_merge=0.9970 (last merge round=15)
[S3] round=18 local utility u=0.268459 metrics={'f1_val': 0.700330919019862, 'auprc': 0.9922916966214778, 'loss_val': 0.35051313679719176, 'psi': 0.8171152300605083}-{'f1_val': 0.6369688766999011, 'auprc': 0.9843465510557421, 'loss_val': 0.483423173183991, 'psi': 0.7759199464422375}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=18 head_norm_before_train=1.023061 cos_to_last_merge=0.9875 (last merge round=14)
[S4] round=18 local utility u=0.109957 metrics={'f1_val': 0.6641887585463608, 'auprc': 0.9152870740747188, 'loss_val': 0.48889949521580545, 'psi': 0.764628084757704}-{'f1_val': 0.6667846418431472, 'auprc': 0.8555575908533606, 'loss_val': 0.5452009734794018, 'psi': 0.7422938214472325}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] START round=18 head_norm_before_train=1.186261 cos_to_last_merge=0.9629 (last merge round=11)
[S5] round=18 local utility u=0.010578 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9943093951014484, 'loss_val': 0.36980187800990943, 'psi': 0.8179165485009277}-{'f1_val': 0.7003221706489986, 'auprc': 0.9934016999921599, 'loss_val': 0.38824069235933395, 'psi': 0.8175539823862632}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] START round=18 head_norm_before_train=1.241530 cos_to_last_merge=0.7789 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.779
[S6] round=18 local utility u=0.323924 metrics={'f1_val': 0.7095322864381675, 'auprc': 0.9624236533180004, 'loss_val': 0.3181747560869957, 'psi': 0.8106888331901007}-{'f1_val': 0.7096572343948266, 'auprc': 0.7890348615297604, 'loss_val': 0.44660656044116087, 'psi': 0.7414082852488002}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=18 head_norm_before_train=0.910342 cos_to_last_merge=0.9676 (last merge round=14)
[S7] round=18 local utility u=0.000000 metrics={'f1_val': 0.5871564115815302, 'auprc': 0.9917852615803742, 'loss_val': 0.6762944484124539, 'psi': 0.7490079515810678}-{'f1_val': 0.6540069722666861, 'auprc': 0.9985041075547061, 'loss_val': 0.6102573435448768, 'psi': 0.7918058263818941}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=18 head_norm_before_train=1.476302 cos_to_last_merge=0.8221 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.822
[S8] round=18 local utility u=0.000000 metrics={'f1_val': 0.7878463009063348, 'auprc': 0.9985959037344211, 'loss_val': 0.1544152343713848, 'psi': 0.8721461420375693}-{'f1_val': 0.9963743336862869, 'auprc': 0.9988211789190498, 'loss_val': 0.10685908996699052, 'psi': 0.997353071779392}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=18 head_norm_before_train=1.417357 cos_to_last_merge=0.8164 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.816
[S9] round=18 local utility u=0.004751 metrics={'f1_val': 0.7012888352718426, 'auprc': 0.9984454371367013, 'loss_val': 0.2266359704856761, 'psi': 0.8201514760177862}-{'f1_val': 0.7012888352718426, 'auprc': 0.9984309857393463, 'loss_val': 0.23609544978058314, 'psi': 0.8201456954588442}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=18 head_norm_before_train=1.195388 cos_to_last_merge=0.9994 (last merge round=16)
[S10] round=18 local utility u=0.793186 metrics={'f1_val': 0.9541411162532293, 'auprc': 0.9963246379532251, 'loss_val': 0.2742907958338064, 'psi': 0.9710145249332276}-{'f1_val': 0.7015352665295298, 'auprc': 0.9914731859959075, 'loss_val': 0.33047341571853384, 'psi': 0.8175104343160808}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S10] sending update (kind=head size=1792 to 1 peers)
[S11] START round=18 head_norm_before_train=1.201766 cos_to_last_merge=0.9958 (last merge round=15)
[S11] round=18 local utility u=0.043585 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9982219152340159, 'loss_val': 0.2596657839434922, 'psi': 0.8204499560725984}-{'f1_val': 0.702242488399264, 'auprc': 0.9967087912742087, 'loss_val': 0.3441394199078663, 'psi': 0.820029009549242}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=18 head_norm_before_train=0.966985 cos_to_last_merge=0.9140 (last merge round=11)
[S13] ⚠️ Model drifted since last merge! cos=0.914
[S13] round=18 local utility u=0.193139 metrics={'f1_val': 0.711208075697154, 'auprc': 0.738735756141369, 'loss_val': 0.5280505782590077, 'psi': 0.7222191478748401}-{'f1_val': 0.6768598166391342, 'auprc': 0.716904206161232, 'loss_val': 0.6427446900011954, 'psi': 0.6928775724479733}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S13] sending update (kind=head size=1791 to 1 peers)
[S14] START round=18 head_norm_before_train=1.464336 cos_to_last_merge=0.9947 (last merge round=13)
[S14] round=18 local utility u=0.000761 metrics={'f1_val': 0.9970007132142444, 'auprc': 0.9968885222926632, 'loss_val': 0.05734140926066167, 'psi': 0.996955836845612}-{'f1_val': 0.9974109942678281, 'auprc': 0.9970292447791744, 'loss_val': 0.061747335098185405, 'psi': 0.9972582944723667}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=18 head_norm_before_train=1.027120 cos_to_last_merge=0.9950 (last merge round=15)
[S15] round=18 local utility u=0.000000 metrics={'f1_val': 0.7102560824491753, 'auprc': 0.8574546233195349, 'loss_val': 0.40474449834826015, 'psi': 0.7691354987973191}-{'f1_val': 0.9731203937004492, 'auprc': 0.9662658222190443, 'loss_val': 0.33812434545927655, 'psi': 0.9703785651078873}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=18 head_norm_before_train=1.693696 (no previous merge yet)
[S16] round=18 local utility u=0.000000 metrics={'f1_val': 0.9088930720357344, 'auprc': 0.9935008958702657, 'loss_val': 0.31064546408458593, 'psi': 0.942736201569547}-{'f1_val': 0.9201217869900643, 'auprc': 0.9853050667468368, 'loss_val': 0.28253295045004323, 'psi': 0.9461950988927733}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=18 head_norm_before_train=1.656255 (no previous merge yet)
[S17] round=18 local utility u=0.022710 metrics={'f1_val': 0.4432554514268429, 'auprc': 0.8173046564124677, 'loss_val': 0.6846932647892522, 'psi': 0.5928751334210929}-{'f1_val': 0.4194953277505078, 'auprc': 0.8706994944188555, 'loss_val': 0.7477374032537378, 'psi': 0.5999769944178469}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] sending update (kind=head size=1805 to 1 peers)
[S2] START round=19 head_norm_before_train=1.231466 cos_to_last_merge=0.9892 (last merge round=15)
[S2] round=19 local utility u=0.000000 metrics={'f1_val': 0.7138380537093632, 'auprc': 0.7713509227323246, 'loss_val': 0.5928696620499819, 'psi': 0.7368432013185477}-{'f1_val': 0.7010387548670409, 'auprc': 0.7680382188934787, 'loss_val': 0.4554414158963745, 'psi': 0.727838540477616}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=20 psi=0.737 u=0.0000 p_local=0.1240 f1=0.714 auprc=0.771 bytes=23375
[S3] START round=19 head_norm_before_train=1.206473 cos_to_last_merge=0.9944 (last merge round=15)
[S3] round=19 local utility u=0.000000 metrics={'f1_val': 0.6449463118580766, 'auprc': 0.9777471861696562, 'loss_val': 0.43739747842231685, 'psi': 0.7780666615827085}-{'f1_val': 0.700330919019862, 'auprc': 0.9922916966214778, 'loss_val': 0.35051313679719176, 'psi': 0.8171152300605083}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=20 psi=0.778 u=0.0000 p_local=0.2339 f1=0.645 auprc=0.978 bytes=23344
[S4] START round=19 head_norm_before_train=1.079169 cos_to_last_merge=0.9809 (last merge round=14)
[S4] round=19 local utility u=0.038275 metrics={'f1_val': 0.6609393663047547, 'auprc': 0.9419869284865674, 'loss_val': 0.47295330944011515, 'psi': 0.7733583911774797}-{'f1_val': 0.6641887585463608, 'auprc': 0.9152870740747188, 'loss_val': 0.48889949521580545, 'psi': 0.764628084757704}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S4] r=20 psi=0.773 u=0.0383 p_local=0.1993 f1=0.661 auprc=0.942 bytes=26964
[S5] START round=19 head_norm_before_train=1.204623 cos_to_last_merge=0.9591 (last merge round=11)
[S5] round=19 local utility u=0.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.8805271315534816, 'loss_val': 0.3697720747539098, 'psi': 0.7724032117162081}-{'f1_val': 0.7003213174339138, 'auprc': 0.9943093951014484, 'loss_val': 0.36980187800990943, 'psi': 0.8179165485009277}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=20 psi=0.772 u=0.0000 p_local=0.1585 f1=0.700 auprc=0.881 bytes=25178
[S6] START round=19 head_norm_before_train=1.261512 cos_to_last_merge=0.7746 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.775
[S6] round=19 local utility u=0.000000 metrics={'f1_val': 0.7075105653958144, 'auprc': 0.9542175924449482, 'loss_val': 0.3434702974494594, 'psi': 0.8061933762154678}-{'f1_val': 0.7095322864381675, 'auprc': 0.9624236533180004, 'loss_val': 0.3181747560869957, 'psi': 0.8106888331901007}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=20 psi=0.806 u=0.0000 p_local=0.1636 f1=0.708 auprc=0.954 bytes=23399
[S7] START round=19 head_norm_before_train=0.959912 cos_to_last_merge=0.9503 (last merge round=14)
[S7] round=19 local utility u=0.427165 metrics={'f1_val': 0.684638515309093, 'auprc': 0.99631430290676, 'loss_val': 0.4204447962358126, 'psi': 0.8093088303481598}-{'f1_val': 0.5871564115815302, 'auprc': 0.9917852615803742, 'loss_val': 0.6762944484124539, 'psi': 0.7490079515810678}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S7] r=20 psi=0.809 u=0.4272 p_local=0.2044 f1=0.685 auprc=0.996 bytes=25151
[S8] START round=19 head_norm_before_train=1.507219 cos_to_last_merge=0.8152 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.815
[S8] round=19 local utility u=0.660163 metrics={'f1_val': 0.9960878102233311, 'auprc': 0.9986255874299482, 'loss_val': 0.08362814434884049, 'psi': 0.997102921105978}-{'f1_val': 0.7878463009063348, 'auprc': 0.9985959037344211, 'loss_val': 0.1544152343713848, 'psi': 0.8721461420375693}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S8] r=20 psi=0.997 u=0.6602 p_local=0.2820 f1=0.996 auprc=0.999 bytes=25175
[S9] START round=19 head_norm_before_train=1.436431 cos_to_last_merge=0.8153 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.815
[S9] round=19 local utility u=0.000000 metrics={'f1_val': 0.7012888352718426, 'auprc': 0.9984558840944687, 'loss_val': 0.232165611548162, 'psi': 0.820155654800893}-{'f1_val': 0.7012888352718426, 'auprc': 0.9984454371367013, 'loss_val': 0.2266359704856761, 'psi': 0.8201514760177862}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=20 psi=0.820 u=0.0000 p_local=0.0355 f1=0.701 auprc=0.998 bytes=28702
[S10] START round=19 head_norm_before_train=1.223770 cos_to_last_merge=0.9982 (last merge round=16)
[S10] round=19 local utility u=0.000000 metrics={'f1_val': 0.8567746635876735, 'auprc': 0.9942774698967629, 'loss_val': 0.26462180077255143, 'psi': 0.9117757861113093}-{'f1_val': 0.9541411162532293, 'auprc': 0.9963246379532251, 'loss_val': 0.2742907958338064, 'psi': 0.9710145249332276}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] r=20 psi=0.912 u=0.0000 p_local=0.3344 f1=0.857 auprc=0.994 bytes=25131
[S11] START round=19 head_norm_before_train=1.241766 cos_to_last_merge=0.9924 (last merge round=15)
[S11] round=19 local utility u=0.889220 metrics={'f1_val': 0.9967189926998994, 'auprc': 0.9965683720614225, 'loss_val': 0.24496749113223482, 'psi': 0.9966587444445085}-{'f1_val': 0.7019353166316534, 'auprc': 0.9982219152340159, 'loss_val': 0.2596657839434922, 'psi': 0.8204499560725984}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S11] r=20 psi=0.997 u=0.8892 p_local=0.2751 f1=0.997 auprc=0.997 bytes=26949
[S13] START round=19 head_norm_before_train=0.990129 cos_to_last_merge=0.9037 (last merge round=11)
[S13] ⚠️ Model drifted since last merge! cos=0.904
[S13] round=19 local utility u=0.000000 metrics={'f1_val': 0.6126301849598672, 'auprc': 0.6846904211299321, 'loss_val': 0.6939782836436238, 'psi': 0.6414542794278931}-{'f1_val': 0.711208075697154, 'auprc': 0.738735756141369, 'loss_val': 0.5280505782590077, 'psi': 0.7222191478748401}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=20 psi=0.641 u=0.0000 p_local=0.2044 f1=0.613 auprc=0.685 bytes=16172
[S14] START round=19 head_norm_before_train=1.501652 cos_to_last_merge=0.9928 (last merge round=13)
[S14] round=19 local utility u=0.009372 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9969747888724889, 'loss_val': 0.04275800257730535, 'psi': 0.9973805863789077}-{'f1_val': 0.9970007132142444, 'auprc': 0.9968885222926632, 'loss_val': 0.05734140926066167, 'psi': 0.996955836845612}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S14] r=20 psi=0.997 u=0.0094 p_local=0.0837 f1=0.998 auprc=0.997 bytes=28729
[S15] START round=19 head_norm_before_train=1.076151 cos_to_last_merge=0.9898 (last merge round=15)
[S15] round=19 local utility u=0.308260 metrics={'f1_val': 0.7680562151059775, 'auprc': 0.9262143736012107, 'loss_val': 0.3413038649610176, 'psi': 0.8313194785040707}-{'f1_val': 0.7102560824491753, 'auprc': 0.8574546233195349, 'loss_val': 0.40474449834826015, 'psi': 0.7691354987973191}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S15] r=20 psi=0.831 u=0.3083 p_local=0.2871 f1=0.768 auprc=0.926 bytes=28781
[S16] START round=19 head_norm_before_train=1.727510 (no previous merge yet)
[S16] round=19 local utility u=0.001745 metrics={'f1_val': 0.9084182078098719, 'auprc': 0.9941431093191795, 'loss_val': 0.3062321051675954, 'psi': 0.942708168413595}-{'f1_val': 0.9088930720357344, 'auprc': 0.9935008958702657, 'loss_val': 0.31064546408458593, 'psi': 0.942736201569547}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S16] r=20 psi=0.943 u=0.0017 p_local=0.2037 f1=0.908 auprc=0.994 bytes=18005
[S17] START round=19 head_norm_before_train=1.685289 (no previous merge yet)
[S17] round=19 local utility u=0.346490 metrics={'f1_val': 0.5512086226268865, 'auprc': 0.8194119270046514, 'loss_val': 0.6457540703429852, 'psi': 0.6584899443779925}-{'f1_val': 0.4432554514268429, 'auprc': 0.8173046564124677, 'loss_val': 0.6846932647892522, 'psi': 0.5928751334210929}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S17] r=20 psi=0.658 u=0.3465 p_local=0.1228 f1=0.551 auprc=0.819 bytes=25208
[S2] START round=20 head_norm_before_train=1.275164 cos_to_last_merge=0.9830 (last merge round=15)
[S2] round=20 local utility u=0.000000 metrics={'f1_val': 0.7006020547381363, 'auprc': 0.724540212975251, 'loss_val': 0.38042696144231597, 'psi': 0.7101773180329822}-{'f1_val': 0.7138380537093632, 'auprc': 0.7713509227323246, 'loss_val': 0.5928696620499819, 'psi': 0.7368432013185477}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=20 head_norm_before_train=1.229202 cos_to_last_merge=0.9918 (last merge round=15)
[S3] round=20 local utility u=0.171121 metrics={'f1_val': 0.6837286083791163, 'auprc': 0.9923780583501216, 'loss_val': 0.37174126501854815, 'psi': 0.8071883883675184}-{'f1_val': 0.6449463118580766, 'auprc': 0.9777471861696562, 'loss_val': 0.43739747842231685, 'psi': 0.7780666615827085}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=20 head_norm_before_train=1.126897 cos_to_last_merge=0.9753 (last merge round=14)
[S4] round=20 local utility u=0.885530 metrics={'f1_val': 0.9465440740751251, 'auprc': 0.9447040548585575, 'loss_val': 0.423672006184607, 'psi': 0.945808066388498}-{'f1_val': 0.6609393663047547, 'auprc': 0.9419869284865674, 'loss_val': 0.47295330944011515, 'psi': 0.7733583911774797}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=20 head_norm_before_train=1.219802 cos_to_last_merge=0.9557 (last merge round=11)
[S5] round=20 local utility u=0.000000 metrics={'f1_val': 0.7093590158793546, 'auprc': 0.792771861493295, 'loss_val': 0.4313446832149549, 'psi': 0.7427241541249308}-{'f1_val': 0.700320598491359, 'auprc': 0.8805271315534816, 'loss_val': 0.3697720747539098, 'psi': 0.7724032117162081}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=20 head_norm_before_train=1.281146 cos_to_last_merge=0.7707 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.771
[S6] round=20 local utility u=0.000000 metrics={'f1_val': 0.69430291810091, 'auprc': 0.7992804106628105, 'loss_val': 0.4414945863562164, 'psi': 0.7362939151256702}-{'f1_val': 0.7075105653958144, 'auprc': 0.9542175924449482, 'loss_val': 0.3434702974494594, 'psi': 0.8061933762154678}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=20 head_norm_before_train=1.000293 cos_to_last_merge=0.9369 (last merge round=14)
[S7] ⚠️ Model drifted since last merge! cos=0.937
[S7] round=20 local utility u=0.000000 metrics={'f1_val': 0.4422556330106009, 'auprc': 0.8007429253910491, 'loss_val': 1.005427198184568, 'psi': 0.5856505499627802}-{'f1_val': 0.684638515309093, 'auprc': 0.99631430290676, 'loss_val': 0.4204447962358126, 'psi': 0.8093088303481598}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=20 head_norm_before_train=1.530748 cos_to_last_merge=0.8106 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.811
[S8] round=20 local utility u=0.008205 metrics={'f1_val': 0.9966398743144329, 'auprc': 0.9986687898925457, 'loss_val': 0.07065967011615244, 'psi': 0.997451440545678}-{'f1_val': 0.9960878102233311, 'auprc': 0.9986255874299482, 'loss_val': 0.08362814434884049, 'psi': 0.997102921105978}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=20 head_norm_before_train=1.453822 cos_to_last_merge=0.8144 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.814
[S9] round=20 local utility u=0.891314 metrics={'f1_val': 0.9917170601363854, 'auprc': 0.9981796122542185, 'loss_val': 0.19127887525620926, 'psi': 0.9943020809835187}-{'f1_val': 0.7012888352718426, 'auprc': 0.9984558840944687, 'loss_val': 0.232165611548162, 'psi': 0.820155654800893}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=20 head_norm_before_train=1.250536 cos_to_last_merge=0.9966 (last merge round=16)
[S10] round=20 local utility u=0.000000 metrics={'f1_val': 0.8543686241298525, 'auprc': 0.9919478314098866, 'loss_val': 0.2841435050477177, 'psi': 0.9094003070418661}-{'f1_val': 0.8567746635876735, 'auprc': 0.9942774698967629, 'loss_val': 0.26462180077255143, 'psi': 0.9117757861113093}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=20 head_norm_before_train=1.282033 cos_to_last_merge=0.9882 (last merge round=15)
[S11] round=20 local utility u=0.000000 metrics={'f1_val': 0.96930156852578, 'auprc': 0.9981511730923107, 'loss_val': 0.16833274873084647, 'psi': 0.9808414103523924}-{'f1_val': 0.9967189926998994, 'auprc': 0.9965683720614225, 'loss_val': 0.24496749113223482, 'psi': 0.9966587444445085}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=20 head_norm_before_train=1.008901 cos_to_last_merge=0.8956 (last merge round=11)
[S13] ⚠️ Model drifted since last merge! cos=0.896
[S13] round=20 local utility u=0.442989 metrics={'f1_val': 0.7069414174105388, 'auprc': 0.7334785675743016, 'loss_val': 0.5202323863272356, 'psi': 0.717556277476044}-{'f1_val': 0.6126301849598672, 'auprc': 0.6846904211299321, 'loss_val': 0.6939782836436238, 'psi': 0.6414542794278931}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=20 head_norm_before_train=1.538719 cos_to_last_merge=0.9908 (last merge round=13)
[S14] round=20 local utility u=0.001402 metrics={'f1_val': 0.9972343982884562, 'auprc': 0.9984523619128245, 'loss_val': 0.04188642818980813, 'psi': 0.9977215837382034}-{'f1_val': 0.9976511180498535, 'auprc': 0.9969747888724889, 'loss_val': 0.04275800257730535, 'psi': 0.9973805863789077}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=20 head_norm_before_train=1.119815 cos_to_last_merge=0.9847 (last merge round=15)
[S15] round=20 local utility u=0.000000 metrics={'f1_val': 0.7711884130420016, 'auprc': 0.8952262527714733, 'loss_val': 0.35017391421040556, 'psi': 0.8208035489337903}-{'f1_val': 0.7680562151059775, 'auprc': 0.9262143736012107, 'loss_val': 0.3413038649610176, 'psi': 0.8313194785040707}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=20 head_norm_before_train=1.759952 (no previous merge yet)
[S16] round=20 local utility u=0.307698 metrics={'f1_val': 0.9800488446210365, 'auprc': 0.9947701971961929, 'loss_val': 0.12250177113601574, 'psi': 0.9859373856510991}-{'f1_val': 0.9084182078098719, 'auprc': 0.9941431093191795, 'loss_val': 0.3062321051675954, 'psi': 0.942708168413595}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S17] START round=20 head_norm_before_train=1.707678 (no previous merge yet)
[S17] round=20 local utility u=0.000000 metrics={'f1_val': 0.4170837239864943, 'auprc': 0.7373844609151581, 'loss_val': 0.8997389459560048, 'psi': 0.5452040187579599}-{'f1_val': 0.5512086226268865, 'auprc': 0.8194119270046514, 'loss_val': 0.6457540703429852, 'psi': 0.6584899443779925}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=21 head_norm_before_train=1.316165 cos_to_last_merge=0.9766 (last merge round=15)
[S2] round=21 local utility u=0.000000 metrics={'f1_val': 0.6776237836717407, 'auprc': 0.644142581380679, 'loss_val': 0.45462112799349264, 'psi': 0.664231302755316}-{'f1_val': 0.7006020547381363, 'auprc': 0.724540212975251, 'loss_val': 0.38042696144231597, 'psi': 0.7101773180329822}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=21 head_norm_before_train=1.251703 cos_to_last_merge=0.9890 (last merge round=15)
[S3] round=21 local utility u=0.086573 metrics={'f1_val': 0.7008317350254774, 'auprc': 0.993945097619602, 'loss_val': 0.30591562206116896, 'psi': 0.8180770800631272}-{'f1_val': 0.6837286083791163, 'auprc': 0.9923780583501216, 'loss_val': 0.37174126501854815, 'psi': 0.8071883883675184}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] sending update (kind=head size=1803 to 1 peers)
[S4] START round=21 head_norm_before_train=1.161684 cos_to_last_merge=0.9710 (last merge round=14)
[S4] round=21 local utility u=0.012700 metrics={'f1_val': 0.9492547564375021, 'auprc': 0.9302074956467876, 'loss_val': 0.3710462512268345, 'psi': 0.9416358521212163}-{'f1_val': 0.9465440740751251, 'auprc': 0.9447040548585575, 'loss_val': 0.423672006184607, 'psi': 0.945808066388498}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=21 head_norm_before_train=1.234406 cos_to_last_merge=0.9529 (last merge round=11)
[S5] round=21 local utility u=0.321802 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9932095999446885, 'loss_val': 0.33482853000275276, 'psi': 0.8174766304382237}-{'f1_val': 0.7093590158793546, 'auprc': 0.792771861493295, 'loss_val': 0.4313446832149549, 'psi': 0.7427241541249308}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=21 head_norm_before_train=1.303108 cos_to_last_merge=0.7667 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.767
[S6] round=21 local utility u=1.000000 metrics={'f1_val': 0.9603214428461182, 'auprc': 0.9602194055826462, 'loss_val': 0.27362772514317363, 'psi': 0.9602806279407294}-{'f1_val': 0.69430291810091, 'auprc': 0.7992804106628105, 'loss_val': 0.4414945863562164, 'psi': 0.7362939151256702}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S6] sending update (kind=head size=1807 to 1 peers)
[S7] START round=21 head_norm_before_train=1.028277 cos_to_last_merge=0.9287 (last merge round=14)
[S7] ⚠️ Model drifted since last merge! cos=0.929
[S7] round=21 local utility u=1.000000 metrics={'f1_val': 0.6743597233915708, 'auprc': 0.9876116253432026, 'loss_val': 0.4281948324942898, 'psi': 0.7996604841722235}-{'f1_val': 0.4422556330106009, 'auprc': 0.8007429253910491, 'loss_val': 1.005427198184568, 'psi': 0.5856505499627802}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=21 head_norm_before_train=1.548036 cos_to_last_merge=0.8078 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.808
[S8] round=21 local utility u=0.000000 metrics={'f1_val': 0.9936253371144965, 'auprc': 0.9986689450866613, 'loss_val': 0.06757438805031554, 'psi': 0.9956427803033625}-{'f1_val': 0.9966398743144329, 'auprc': 0.9986687898925457, 'loss_val': 0.07065967011615244, 'psi': 0.997451440545678}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=21 head_norm_before_train=1.467787 cos_to_last_merge=0.8136 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.814
[S9] round=21 local utility u=0.000000 metrics={'f1_val': 0.7012888352718426, 'auprc': 0.9986208232527674, 'loss_val': 0.17233217774036147, 'psi': 0.8202216304642125}-{'f1_val': 0.9917170601363854, 'auprc': 0.9981796122542185, 'loss_val': 0.19127887525620926, 'psi': 0.9943020809835187}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=21 head_norm_before_train=1.274564 cos_to_last_merge=0.9947 (last merge round=16)
[S10] round=21 local utility u=0.000000 metrics={'f1_val': 0.786730258523131, 'auprc': 0.9941946066107566, 'loss_val': 0.2658043305773231, 'psi': 0.8697159977581812}-{'f1_val': 0.8543686241298525, 'auprc': 0.9919478314098866, 'loss_val': 0.2841435050477177, 'psi': 0.9094003070418661}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=21 head_norm_before_train=1.321071 cos_to_last_merge=0.9837 (last merge round=15)
[S11] round=21 local utility u=0.093823 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9974137919053057, 'loss_val': 0.14194666514302479, 'psi': 0.996893719470276}-{'f1_val': 0.96930156852578, 'auprc': 0.9981511730923107, 'loss_val': 0.16833274873084647, 'psi': 0.9808414103523924}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] sending update (kind=head size=1803 to 1 peers)
[S13] START round=21 head_norm_before_train=1.025900 cos_to_last_merge=0.8883 (last merge round=11)
[S13] ⚠️ Model drifted since last merge! cos=0.888
[S13] round=21 local utility u=0.000000 metrics={'f1_val': 0.6982195405842783, 'auprc': 0.7202822998684012, 'loss_val': 0.5135798620715744, 'psi': 0.7070446442979275}-{'f1_val': 0.7069414174105388, 'auprc': 0.7334785675743016, 'loss_val': 0.5202323863272356, 'psi': 0.717556277476044}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=21 head_norm_before_train=1.571517 cos_to_last_merge=0.9891 (last merge round=13)
[S14] round=21 local utility u=0.000000 metrics={'f1_val': 0.9957445751558393, 'auprc': 0.9969713078434781, 'loss_val': 0.04019592451395688, 'psi': 0.9962352682308948}-{'f1_val': 0.9972343982884562, 'auprc': 0.9984523619128245, 'loss_val': 0.04188642818980813, 'psi': 0.9977215837382034}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=21 head_norm_before_train=1.162806 cos_to_last_merge=0.9794 (last merge round=15)
[S15] round=21 local utility u=0.335667 metrics={'f1_val': 0.8329446350349468, 'auprc': 0.9683952241029652, 'loss_val': 0.26888386300105005, 'psi': 0.8871248706621542}-{'f1_val': 0.7711884130420016, 'auprc': 0.8952262527714733, 'loss_val': 0.35017391421040556, 'psi': 0.8208035489337903}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=21 head_norm_before_train=1.789604 (no previous merge yet)
[S16] round=21 local utility u=0.000000 metrics={'f1_val': 0.8621478999259398, 'auprc': 0.9905665955777764, 'loss_val': 0.4830268992707978, 'psi': 0.9135153781866744}-{'f1_val': 0.9800488446210365, 'auprc': 0.9947701971961929, 'loss_val': 0.12250177113601574, 'psi': 0.9859373856510991}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=21 head_norm_before_train=1.722579 (no previous merge yet)
[S17] round=21 local utility u=0.652404 metrics={'f1_val': 0.5126799818761383, 'auprc': 0.8742200633056127, 'loss_val': 0.5790151610258443, 'psi': 0.6572960144479281}-{'f1_val': 0.4170837239864943, 'auprc': 0.7373844609151581, 'loss_val': 0.8997389459560048, 'psi': 0.5452040187579599}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[S2] START round=22 head_norm_before_train=1.349800 cos_to_last_merge=0.9714 (last merge round=15)
[S2] round=22 local utility u=0.125423 metrics={'f1_val': 0.7003235408898404, 'auprc': 0.6577624791873692, 'loss_val': 0.3808325834521108, 'psi': 0.6832991162088519}-{'f1_val': 0.6776237836717407, 'auprc': 0.644142581380679, 'loss_val': 0.45462112799349264, 'psi': 0.664231302755316}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=22 head_norm_before_train=1.271389 cos_to_last_merge=0.9864 (last merge round=15)
[S3] round=22 local utility u=0.000000 metrics={'f1_val': 0.7005813959920884, 'auprc': 0.9936648309382083, 'loss_val': 0.3097728855287918, 'psi': 0.8178147699705364}-{'f1_val': 0.7008317350254774, 'auprc': 0.993945097619602, 'loss_val': 0.30591562206116896, 'psi': 0.8180770800631272}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=22 head_norm_before_train=1.186571 cos_to_last_merge=0.9679 (last merge round=14)
[S4] round=22 local utility u=0.000000 metrics={'f1_val': 0.9402815834597169, 'auprc': 0.9504768579990542, 'loss_val': 0.41028543721316996, 'psi': 0.9443596932754519}-{'f1_val': 0.9492547564375021, 'auprc': 0.9302074956467876, 'loss_val': 0.3710462512268345, 'psi': 0.9416358521212163}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=22 head_norm_before_train=1.246601 cos_to_last_merge=0.9508 (last merge round=11)
[S5] round=22 local utility u=0.000000 metrics={'f1_val': 0.7001773225709489, 'auprc': 0.7909892649509993, 'loss_val': 0.5770022793831822, 'psi': 0.7365020995229691}-{'f1_val': 0.7003213174339138, 'auprc': 0.9932095999446885, 'loss_val': 0.33482853000275276, 'psi': 0.8174766304382237}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=22 head_norm_before_train=1.324223 cos_to_last_merge=0.7631 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.763
[S6] round=22 local utility u=0.060150 metrics={'f1_val': 0.9608274707236424, 'auprc': 0.9769689467653545, 'loss_val': 0.20661246972957775, 'psi': 0.9672840611403273}-{'f1_val': 0.9603214428461182, 'auprc': 0.9602194055826462, 'loss_val': 0.27362772514317363, 'psi': 0.9602806279407294}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=22 head_norm_before_train=1.046424 cos_to_last_merge=0.9235 (last merge round=14)
[S7] ⚠️ Model drifted since last merge! cos=0.923
[S7] round=22 local utility u=0.000000 metrics={'f1_val': 0.41451197783360594, 'auprc': 0.7899789872917868, 'loss_val': 1.0522342279118642, 'psi': 0.5646987816168783}-{'f1_val': 0.6743597233915708, 'auprc': 0.9876116253432026, 'loss_val': 0.4281948324942898, 'psi': 0.7996604841722235}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=22 head_norm_before_train=1.568668 cos_to_last_merge=0.8050 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.805
[S8] round=22 local utility u=0.005093 metrics={'f1_val': 0.9946393943175413, 'auprc': 0.9986640249938479, 'loss_val': 0.06345859160131048, 'psi': 0.9962492465880639}-{'f1_val': 0.9936253371144965, 'auprc': 0.9986689450866613, 'loss_val': 0.06757438805031554, 'psi': 0.9956427803033625}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=22 head_norm_before_train=1.483797 cos_to_last_merge=0.8124 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.812
[S9] round=22 local utility u=0.833910 metrics={'f1_val': 0.9717249819408144, 'auprc': 0.9985392055251077, 'loss_val': 0.12688390584750686, 'psi': 0.9824506713745317}-{'f1_val': 0.7012888352718426, 'auprc': 0.9986208232527674, 'loss_val': 0.17233217774036147, 'psi': 0.8202216304642125}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=22 head_norm_before_train=1.295251 cos_to_last_merge=0.9928 (last merge round=16)
[S10] round=22 local utility u=0.254032 metrics={'f1_val': 0.8641515543063216, 'auprc': 0.9946729467135635, 'loss_val': 0.22370279899724496, 'psi': 0.9163601112692183}-{'f1_val': 0.786730258523131, 'auprc': 0.9941946066107566, 'loss_val': 0.2658043305773231, 'psi': 0.8697159977581812}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=22 head_norm_before_train=1.357062 cos_to_last_merge=0.9790 (last merge round=15)
[S11] round=22 local utility u=0.011646 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.997778739691235, 'loss_val': 0.11974880870732843, 'psi': 0.9970396985846477}-{'f1_val': 0.9965470045135896, 'auprc': 0.9974137919053057, 'loss_val': 0.14194666514302479, 'psi': 0.996893719470276}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=22 head_norm_before_train=1.044309 cos_to_last_merge=0.8808 (last merge round=11)
[S13] ⚠️ Model drifted since last merge! cos=0.881
[S13] round=22 local utility u=0.006383 metrics={'f1_val': 0.7086424064852215, 'auprc': 0.6927184624692905, 'loss_val': 0.4806594158006362, 'psi': 0.7022728288788491}-{'f1_val': 0.6982195405842783, 'auprc': 0.7202822998684012, 'loss_val': 0.5135798620715744, 'psi': 0.7070446442979275}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=22 head_norm_before_train=1.595760 cos_to_last_merge=0.9877 (last merge round=13)
[S14] round=22 local utility u=0.003402 metrics={'f1_val': 0.9965760575063591, 'auprc': 0.9969683233102163, 'loss_val': 0.038371218725483686, 'psi': 0.996732963827902}-{'f1_val': 0.9957445751558393, 'auprc': 0.9969713078434781, 'loss_val': 0.04019592451395688, 'psi': 0.9962352682308948}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=22 head_norm_before_train=1.201897 cos_to_last_merge=0.9745 (last merge round=15)
[S15] round=22 local utility u=0.000000 metrics={'f1_val': 0.6884337758197583, 'auprc': 0.7704673111327756, 'loss_val': 0.5128471290005359, 'psi': 0.7212471899449653}-{'f1_val': 0.8329446350349468, 'auprc': 0.9683952241029652, 'loss_val': 0.26888386300105005, 'psi': 0.8871248706621542}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=22 head_norm_before_train=1.811725 (no previous merge yet)
[S16] round=22 local utility u=0.000000 metrics={'f1_val': 0.850327069745577, 'auprc': 0.9956469482546627, 'loss_val': 0.5192837769508356, 'psi': 0.9084550211492113}-{'f1_val': 0.8621478999259398, 'auprc': 0.9905665955777764, 'loss_val': 0.4830268992707978, 'psi': 0.9135153781866744}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=22 head_norm_before_train=1.738559 (no previous merge yet)
[S17] round=22 local utility u=0.000000 metrics={'f1_val': 0.6551966552674064, 'auprc': 0.6586794074739591, 'loss_val': 1.040710991774848, 'psi': 0.6565897561500276}-{'f1_val': 0.5126799818761383, 'auprc': 0.8742200633056127, 'loss_val': 0.5790151610258443, 'psi': 0.6572960144479281}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=23 head_norm_before_train=1.380000 cos_to_last_merge=0.9669 (last merge round=15)
[S2] round=23 local utility u=0.000000 metrics={'f1_val': 0.6839900987909044, 'auprc': 0.7730259552190728, 'loss_val': 0.7723158178933696, 'psi': 0.7196044413621718}-{'f1_val': 0.7003235408898404, 'auprc': 0.6577624791873692, 'loss_val': 0.3808325834521108, 'psi': 0.6832991162088519}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=23 head_norm_before_train=1.290495 cos_to_last_merge=0.9838 (last merge round=15)
[S3] round=23 local utility u=0.000000 metrics={'f1_val': 0.6886507686525366, 'auprc': 0.9930981798599616, 'loss_val': 0.34231610135318685, 'psi': 0.8104297331355066}-{'f1_val': 0.7005813959920884, 'auprc': 0.9936648309382083, 'loss_val': 0.3097728855287918, 'psi': 0.8178147699705364}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=23 head_norm_before_train=1.209331 cos_to_last_merge=0.9650 (last merge round=14)
[S4] round=23 local utility u=0.052824 metrics={'f1_val': 0.9434582104824472, 'auprc': 0.9536282755597902, 'loss_val': 0.33315224069510974, 'psi': 0.9475262365133844}-{'f1_val': 0.9402815834597169, 'auprc': 0.9504768579990542, 'loss_val': 0.41028543721316996, 'psi': 0.9443596932754519}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=23 head_norm_before_train=1.262398 cos_to_last_merge=0.9480 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.948
[S5] round=23 local utility u=0.442302 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9971710483970316, 'loss_val': 0.3118084415785085, 'psi': 0.819061209819161}-{'f1_val': 0.7001773225709489, 'auprc': 0.7909892649509993, 'loss_val': 0.5770022793831822, 'psi': 0.7365020995229691}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=23 head_norm_before_train=1.341841 cos_to_last_merge=0.7601 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.760
[S6] round=23 local utility u=0.000000 metrics={'f1_val': 0.6108359516758679, 'auprc': 0.7844410121491967, 'loss_val': 0.566777332425215, 'psi': 0.6802779758651994}-{'f1_val': 0.9608274707236424, 'auprc': 0.9769689467653545, 'loss_val': 0.20661246972957775, 'psi': 0.9672840611403273}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=23 head_norm_before_train=1.058499 cos_to_last_merge=0.9200 (last merge round=14)
[S7] ⚠️ Model drifted since last merge! cos=0.920
[S7] round=23 local utility u=1.000000 metrics={'f1_val': 0.7001397550937472, 'auprc': 0.9989325080794225, 'loss_val': 0.3267226011824765, 'psi': 0.8196568562880173}-{'f1_val': 0.41451197783360594, 'auprc': 0.7899789872917868, 'loss_val': 1.0522342279118642, 'psi': 0.5646987816168783}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S8] START round=23 head_norm_before_train=1.592157 cos_to_last_merge=0.8023 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.802
[S8] round=23 local utility u=0.000000 metrics={'f1_val': 0.9894208216881261, 'auprc': 0.9988789550949727, 'loss_val': 0.0754933172116248, 'psi': 0.9932040750508647}-{'f1_val': 0.9946393943175413, 'auprc': 0.9986640249938479, 'loss_val': 0.06345859160131048, 'psi': 0.9962492465880639}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=23 head_norm_before_train=1.503558 cos_to_last_merge=0.8110 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.811
[S9] round=23 local utility u=0.079954 metrics={'f1_val': 0.9925575664777104, 'auprc': 0.9980438895853608, 'loss_val': 0.09048611910532052, 'psi': 0.9947520957207705}-{'f1_val': 0.9717249819408144, 'auprc': 0.9985392055251077, 'loss_val': 0.12688390584750686, 'psi': 0.9824506713745317}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] sending update (kind=head size=1794 to 1 peers)
[S10] START round=23 head_norm_before_train=1.315220 cos_to_last_merge=0.9908 (last merge round=16)
[S10] round=23 local utility u=0.400590 metrics={'f1_val': 0.9932441185269139, 'auprc': 0.993155899522766, 'loss_val': 0.19252670027341096, 'psi': 0.9932088309252547}-{'f1_val': 0.8641515543063216, 'auprc': 0.9946729467135635, 'loss_val': 0.22370279899724496, 'psi': 0.9163601112692183}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=23 head_norm_before_train=1.383524 cos_to_last_merge=0.9754 (last merge round=15)
[S11] round=23 local utility u=0.007143 metrics={'f1_val': 0.9961498518852874, 'auprc': 0.9978576031931801, 'loss_val': 0.10331714190565569, 'psi': 0.9968329524084445}-{'f1_val': 0.9965470045135896, 'auprc': 0.997778739691235, 'loss_val': 0.11974880870732843, 'psi': 0.9970396985846477}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] sending update (kind=head size=1805 to 1 peers)
[S13] START round=23 head_norm_before_train=1.062396 cos_to_last_merge=0.8744 (last merge round=11)
[S13] ⚠️ Model drifted since last merge! cos=0.874
[S13] round=23 local utility u=0.019555 metrics={'f1_val': 0.7097293800175294, 'auprc': 0.6956116010700606, 'loss_val': 0.4567509022010978, 'psi': 0.7040822684385419}-{'f1_val': 0.7086424064852215, 'auprc': 0.6927184624692905, 'loss_val': 0.4806594158006362, 'psi': 0.7022728288788491}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S13] sending update (kind=head size=1792 to 1 peers)
[S14] START round=23 head_norm_before_train=1.619282 cos_to_last_merge=0.9862 (last merge round=13)
[S14] round=23 local utility u=0.000000 metrics={'f1_val': 0.9917991843863939, 'auprc': 0.9968636514638478, 'loss_val': 0.04623239233637728, 'psi': 0.9938249712173755}-{'f1_val': 0.9965760575063591, 'auprc': 0.9969683233102163, 'loss_val': 0.038371218725483686, 'psi': 0.996732963827902}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=23 head_norm_before_train=1.233724 cos_to_last_merge=0.9706 (last merge round=15)
[S15] round=23 local utility u=1.000000 metrics={'f1_val': 0.9740652888317481, 'auprc': 0.9702859383659109, 'loss_val': 0.18657664332588078, 'psi': 0.9725535486454132}-{'f1_val': 0.6884337758197583, 'auprc': 0.7704673111327756, 'loss_val': 0.5128471290005359, 'psi': 0.7212471899449653}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] sending update (kind=head size=1792 to 1 peers)
[S16] START round=23 head_norm_before_train=1.834100 (no previous merge yet)
[S16] round=23 local utility u=0.237014 metrics={'f1_val': 0.897689249865827, 'auprc': 0.9963391390406047, 'loss_val': 0.3315059400140765, 'psi': 0.937149205535738}-{'f1_val': 0.850327069745577, 'auprc': 0.9956469482546627, 'loss_val': 0.5192837769508356, 'psi': 0.9084550211492113}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=23 head_norm_before_train=1.752079 (no previous merge yet)
[S17] round=23 local utility u=0.755959 metrics={'f1_val': 0.6815043445619092, 'auprc': 0.9044098857567892, 'loss_val': 0.42383018630941954, 'psi': 0.7706665610398612}-{'f1_val': 0.6551966552674064, 'auprc': 0.6586794074739591, 'loss_val': 1.040710991774848, 'psi': 0.6565897561500276}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] sending update (kind=head size=1794 to 1 peers)
[S2] START round=24 head_norm_before_train=1.406169 cos_to_last_merge=0.9634 (last merge round=15)
[S2] round=24 local utility u=0.229289 metrics={'f1_val': 0.7117278426896414, 'auprc': 0.7822905150067136, 'loss_val': 0.5079588647010288, 'psi': 0.7399529116164703}-{'f1_val': 0.6839900987909044, 'auprc': 0.7730259552190728, 'loss_val': 0.7723158178933696, 'psi': 0.7196044413621718}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=24 head_norm_before_train=1.309446 cos_to_last_merge=0.9812 (last merge round=15)
[S3] round=24 local utility u=0.063965 metrics={'f1_val': 0.7008317350254774, 'auprc': 0.9936744627995355, 'loss_val': 0.28920041044554357, 'psi': 0.8179688261351006}-{'f1_val': 0.6886507686525366, 'auprc': 0.9930981798599616, 'loss_val': 0.34231610135318685, 'psi': 0.8104297331355066}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] sending update (kind=head size=1803 to 1 peers)
[S4] START round=24 head_norm_before_train=1.227134 cos_to_last_merge=0.9627 (last merge round=14)
[S4] round=24 local utility u=0.000000 metrics={'f1_val': 0.9414458218251536, 'auprc': 0.9525310545384851, 'loss_val': 0.34761814379385925, 'psi': 0.9458799149104862}-{'f1_val': 0.9434582104824472, 'auprc': 0.9536282755597902, 'loss_val': 0.33315224069510974, 'psi': 0.9475262365133844}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=24 head_norm_before_train=1.275378 cos_to_last_merge=0.9456 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.946
[S5] round=24 local utility u=0.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9419732525809275, 'loss_val': 0.3345628061089372, 'psi': 0.7969816601271864}-{'f1_val': 0.7003213174339138, 'auprc': 0.9971710483970316, 'loss_val': 0.3118084415785085, 'psi': 0.819061209819161}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=24 head_norm_before_train=1.357328 cos_to_last_merge=0.7577 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.758
[S6] round=24 local utility u=1.000000 metrics={'f1_val': 0.8201630516680031, 'auprc': 0.9563066181244669, 'loss_val': 0.3225439709876346, 'psi': 0.8746204782505886}-{'f1_val': 0.6108359516758679, 'auprc': 0.7844410121491967, 'loss_val': 0.566777332425215, 'psi': 0.6802779758651994}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[S7] START round=24 head_norm_before_train=1.068615 cos_to_last_merge=0.9174 (last merge round=14)
[S7] ⚠️ Model drifted since last merge! cos=0.917
[S7] round=24 local utility u=0.000000 metrics={'f1_val': 0.5516844099869476, 'auprc': 0.8107719221542937, 'loss_val': 0.7545787317601068, 'psi': 0.655319414853886}-{'f1_val': 0.7001397550937472, 'auprc': 0.9989325080794225, 'loss_val': 0.3267226011824765, 'psi': 0.8196568562880173}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=24 head_norm_before_train=1.614164 cos_to_last_merge=0.7998 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.800
[S8] round=24 local utility u=0.021631 metrics={'f1_val': 0.9931648515513533, 'auprc': 0.9984912114592366, 'loss_val': 0.053532915055001976, 'psi': 0.9952953955145065}-{'f1_val': 0.9894208216881261, 'auprc': 0.9988789550949727, 'loss_val': 0.0754933172116248, 'psi': 0.9932040750508647}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=24 head_norm_before_train=1.527019 cos_to_last_merge=0.8091 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.809
[S9] round=24 local utility u=0.009444 metrics={'f1_val': 0.9925575664777104, 'auprc': 0.9985342453373597, 'loss_val': 0.07306985151758516, 'psi': 0.9949482380215701}-{'f1_val': 0.9925575664777104, 'auprc': 0.9980438895853608, 'loss_val': 0.09048611910532052, 'psi': 0.9947520957207705}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] sending update (kind=head size=1793 to 1 peers)
[S10] START round=24 head_norm_before_train=1.336094 cos_to_last_merge=0.9885 (last merge round=16)
[S10] round=24 local utility u=0.006983 metrics={'f1_val': 0.9929470219789016, 'auprc': 0.9939917343166483, 'loss_val': 0.17928479477833525, 'psi': 0.9933649069140003}-{'f1_val': 0.9932441185269139, 'auprc': 0.993155899522766, 'loss_val': 0.19252670027341096, 'psi': 0.9932088309252547}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=24 head_norm_before_train=1.407863 cos_to_last_merge=0.9720 (last merge round=15)
[S11] round=24 local utility u=0.000000 metrics={'f1_val': 0.982214063202625, 'auprc': 0.9981124122641368, 'loss_val': 0.09505766942094762, 'psi': 0.9885734028272297}-{'f1_val': 0.9961498518852874, 'auprc': 0.9978576031931801, 'loss_val': 0.10331714190565569, 'psi': 0.9968329524084445}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=24 head_norm_before_train=1.077669 cos_to_last_merge=0.8692 (last merge round=11)
[S13] ⚠️ Model drifted since last merge! cos=0.869
[S13] round=24 local utility u=0.000000 metrics={'f1_val': 0.6692427905752327, 'auprc': 0.6908339240863379, 'loss_val': 0.5095082946419991, 'psi': 0.6778792439796748}-{'f1_val': 0.7097293800175294, 'auprc': 0.6956116010700606, 'loss_val': 0.4567509022010978, 'psi': 0.7040822684385419}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=24 head_norm_before_train=1.639093 cos_to_last_merge=0.9849 (last merge round=13)
[S14] round=24 local utility u=0.000000 metrics={'f1_val': 0.9886531373036748, 'auprc': 0.9985495598504719, 'loss_val': 0.04717713537117483, 'psi': 0.9926117063223936}-{'f1_val': 0.9917991843863939, 'auprc': 0.9968636514638478, 'loss_val': 0.04623239233637728, 'psi': 0.9938249712173755}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=24 head_norm_before_train=1.258623 cos_to_last_merge=0.9674 (last merge round=15)
[S15] round=24 local utility u=0.000000 metrics={'f1_val': 0.9641923255939403, 'auprc': 0.9724054393803918, 'loss_val': 0.16822855962537275, 'psi': 0.967477571108521}-{'f1_val': 0.9740652888317481, 'auprc': 0.9702859383659109, 'loss_val': 0.18657664332588078, 'psi': 0.9725535486454132}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=24 head_norm_before_train=1.856951 (no previous merge yet)
[S16] round=24 local utility u=0.327989 metrics={'f1_val': 0.9710362461220352, 'auprc': 0.993934826050537, 'loss_val': 0.10839624591832588, 'psi': 0.9801956780934359}-{'f1_val': 0.897689249865827, 'auprc': 0.9963391390406047, 'loss_val': 0.3315059400140765, 'psi': 0.937149205535738}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=24 head_norm_before_train=1.765239 (no previous merge yet)
[S17] round=24 local utility u=0.000000 metrics={'f1_val': 0.6560328687978408, 'auprc': 0.7068823307685238, 'loss_val': 0.8674505240681857, 'psi': 0.6763726535861141}-{'f1_val': 0.6815043445619092, 'auprc': 0.9044098857567892, 'loss_val': 0.42383018630941954, 'psi': 0.7706665610398612}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=25 head_norm_before_train=1.427002 cos_to_last_merge=0.9607 (last merge round=15)
[S2] round=25 local utility u=0.047569 metrics={'f1_val': 0.7013524438457823, 'auprc': 0.7824820199903874, 'loss_val': 0.3511438594819767, 'psi': 0.7338042743036244}-{'f1_val': 0.7117278426896414, 'auprc': 0.7822905150067136, 'loss_val': 0.5079588647010288, 'psi': 0.7399529116164703}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=25 head_norm_before_train=1.328499 cos_to_last_merge=0.9785 (last merge round=15)
[S3] round=25 local utility u=0.013574 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9950080456947198, 'loss_val': 0.2656006846599497, 'psi': 0.8184569405190677}-{'f1_val': 0.7008317350254774, 'auprc': 0.9936744627995355, 'loss_val': 0.28920041044554357, 'psi': 0.8179688261351006}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=25 head_norm_before_train=1.245852 cos_to_last_merge=0.9602 (last merge round=14)
[S4] round=25 local utility u=0.000000 metrics={'f1_val': 0.9303347225271312, 'auprc': 0.9439038423645637, 'loss_val': 0.4053574872681402, 'psi': 0.9357623704621042}-{'f1_val': 0.9414458218251536, 'auprc': 0.9525310545384851, 'loss_val': 0.34761814379385925, 'psi': 0.9458799149104862}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=25 head_norm_before_train=1.289202 cos_to_last_merge=0.9429 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.943
[S5] round=25 local utility u=0.100199 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9961364650705462, 'loss_val': 0.29665852264986053, 'psi': 0.8186473764885667}-{'f1_val': 0.700320598491359, 'auprc': 0.9419732525809275, 'loss_val': 0.3345628061089372, 'psi': 0.7969816601271864}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] sending update (kind=head size=1794 to 1 peers)
[S6] START round=25 head_norm_before_train=1.373554 cos_to_last_merge=0.7553 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.755
[S6] round=25 local utility u=0.000000 metrics={'f1_val': 0.6493996482110386, 'auprc': 0.9516800252378749, 'loss_val': 0.3737838116565951, 'psi': 0.7703117990217732}-{'f1_val': 0.8201630516680031, 'auprc': 0.9563066181244669, 'loss_val': 0.3225439709876346, 'psi': 0.8746204782505886}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=25 head_norm_before_train=1.077268 cos_to_last_merge=0.9157 (last merge round=14)
[S7] ⚠️ Model drifted since last merge! cos=0.916
[S7] round=25 local utility u=0.453630 metrics={'f1_val': 0.6392158127536541, 'auprc': 0.855234223059335, 'loss_val': 0.5058931955814575, 'psi': 0.7256231768759265}-{'f1_val': 0.5516844099869476, 'auprc': 0.8107719221542937, 'loss_val': 0.7545787317601068, 'psi': 0.655319414853886}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=25 head_norm_before_train=1.634153 cos_to_last_merge=0.7972 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.797
[S8] round=25 local utility u=0.000000 metrics={'f1_val': 0.987914979378081, 'auprc': 0.9988313404886305, 'loss_val': 0.07376321773315406, 'psi': 0.9922815238223008}-{'f1_val': 0.9931648515513533, 'auprc': 0.9984912114592366, 'loss_val': 0.053532915055001976, 'psi': 0.9952953955145065}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=25 head_norm_before_train=1.553278 cos_to_last_merge=0.8058 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.806
[S9] round=25 local utility u=0.000000 metrics={'f1_val': 0.9905134633010875, 'auprc': 0.9986433849666885, 'loss_val': 0.06624532394198421, 'psi': 0.9937654319673279}-{'f1_val': 0.9925575664777104, 'auprc': 0.9985342453373597, 'loss_val': 0.07306985151758516, 'psi': 0.9949482380215701}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=25 head_norm_before_train=1.361915 cos_to_last_merge=0.9859 (last merge round=16)
[S10] round=25 local utility u=0.009268 metrics={'f1_val': 0.9957455607450773, 'auprc': 0.9927820888550996, 'loss_val': 0.17391144445535417, 'psi': 0.9945601719890862}-{'f1_val': 0.9929470219789016, 'auprc': 0.9939917343166483, 'loss_val': 0.17928479477833525, 'psi': 0.9933649069140003}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=25 head_norm_before_train=1.431818 cos_to_last_merge=0.9686 (last merge round=15)
[S11] round=25 local utility u=0.000000 metrics={'f1_val': 0.9839732850981402, 'auprc': 0.9965656470060982, 'loss_val': 0.14277244437272474, 'psi': 0.9890102298613234}-{'f1_val': 0.982214063202625, 'auprc': 0.9981124122641368, 'loss_val': 0.09505766942094762, 'psi': 0.9885734028272297}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=25 head_norm_before_train=1.090603 cos_to_last_merge=0.8644 (last merge round=11)
[S13] ⚠️ Model drifted since last merge! cos=0.864
[S13] round=25 local utility u=0.000000 metrics={'f1_val': 0.6356034477772217, 'auprc': 0.6854270107266281, 'loss_val': 0.5518722313760663, 'psi': 0.6555328729569843}-{'f1_val': 0.6692427905752327, 'auprc': 0.6908339240863379, 'loss_val': 0.5095082946419991, 'psi': 0.6778792439796748}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=25 head_norm_before_train=1.660518 cos_to_last_merge=0.9835 (last merge round=13)
[S14] round=25 local utility u=0.021151 metrics={'f1_val': 0.9939003034958211, 'auprc': 0.9988332913362841, 'loss_val': 0.03720995081969119, 'psi': 0.9958734986320062}-{'f1_val': 0.9886531373036748, 'auprc': 0.9985495598504719, 'loss_val': 0.04717713537117483, 'psi': 0.9926117063223936}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=25 head_norm_before_train=1.283977 cos_to_last_merge=0.9643 (last merge round=15)
[S15] round=25 local utility u=0.000000 metrics={'f1_val': 0.8554051969154384, 'auprc': 0.9580286464534431, 'loss_val': 0.2749524981234064, 'psi': 0.8964545767306403}-{'f1_val': 0.9641923255939403, 'auprc': 0.9724054393803918, 'loss_val': 0.16822855962537275, 'psi': 0.967477571108521}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=25 head_norm_before_train=1.878438 (no previous merge yet)
[S16] round=25 local utility u=0.000000 metrics={'f1_val': 0.9251740406320115, 'auprc': 0.995957055701001, 'loss_val': 0.25296446135822526, 'psi': 0.9534872466596073}-{'f1_val': 0.9710362461220352, 'auprc': 0.993934826050537, 'loss_val': 0.10839624591832588, 'psi': 0.9801956780934359}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=25 head_norm_before_train=1.778869 (no previous merge yet)
[S17] round=25 local utility u=0.576317 metrics={'f1_val': 0.6849641803469035, 'auprc': 0.8934269227050486, 'loss_val': 0.44803818442645554, 'psi': 0.7683492772901617}-{'f1_val': 0.6560328687978408, 'auprc': 0.7068823307685238, 'loss_val': 0.8674505240681857, 'psi': 0.6763726535861141}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] START round=26 head_norm_before_train=1.442880 cos_to_last_merge=0.9590 (last merge round=15)
[S2] round=26 local utility u=0.000000 metrics={'f1_val': 0.6436887882459305, 'auprc': 0.6352139835115951, 'loss_val': 0.6510920219482068, 'psi': 0.6402988663521962}-{'f1_val': 0.7013524438457823, 'auprc': 0.7824820199903874, 'loss_val': 0.3511438594819767, 'psi': 0.7338042743036244}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=26 head_norm_before_train=1.347061 cos_to_last_merge=0.9753 (last merge round=15)
[S3] round=26 local utility u=0.016905 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9961637252374991, 'loss_val': 0.2352580084548516, 'psi': 0.8189192123361795}-{'f1_val': 0.7007562037352997, 'auprc': 0.9950080456947198, 'loss_val': 0.2656006846599497, 'psi': 0.8184569405190677}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] sending update (kind=head size=1803 to 1 peers)
[S4] START round=26 head_norm_before_train=1.266207 cos_to_last_merge=0.9573 (last merge round=14)
[S4] round=26 local utility u=0.086896 metrics={'f1_val': 0.9387332235010294, 'auprc': 0.9558785592567343, 'loss_val': 0.31788026129542046, 'psi': 0.9455913578033113}-{'f1_val': 0.9303347225271312, 'auprc': 0.9439038423645637, 'loss_val': 0.4053574872681402, 'psi': 0.9357623704621042}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=26 head_norm_before_train=1.300783 cos_to_last_merge=0.9405 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.940
[S5] round=26 local utility u=0.000000 metrics={'f1_val': 0.7122663714680815, 'auprc': 0.7922756043273789, 'loss_val': 0.4793888687921535, 'psi': 0.7442700646118005}-{'f1_val': 0.7003213174339138, 'auprc': 0.9961364650705462, 'loss_val': 0.29665852264986053, 'psi': 0.8186473764885667}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=26 head_norm_before_train=1.394564 cos_to_last_merge=0.7522 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.752
[S6] round=26 local utility u=1.000000 metrics={'f1_val': 0.9579702890087702, 'auprc': 0.980311351959557, 'loss_val': 0.17319636655128837, 'psi': 0.966906714189085}-{'f1_val': 0.6493996482110386, 'auprc': 0.9516800252378749, 'loss_val': 0.3737838116565951, 'psi': 0.7703117990217732}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=26 head_norm_before_train=1.089043 cos_to_last_merge=0.9138 (last merge round=14)
[S7] ⚠️ Model drifted since last merge! cos=0.914
[S7] round=26 local utility u=0.000000 metrics={'f1_val': 0.4642496633861629, 'auprc': 0.7868137720298183, 'loss_val': 1.0157415250678234, 'psi': 0.5932753068436251}-{'f1_val': 0.6392158127536541, 'auprc': 0.855234223059335, 'loss_val': 0.5058931955814575, 'psi': 0.7256231768759265}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=26 head_norm_before_train=1.652062 cos_to_last_merge=0.7950 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.795
[S8] round=26 local utility u=0.030136 metrics={'f1_val': 0.9937842062300497, 'auprc': 0.9986364378291639, 'loss_val': 0.04812164512304839, 'psi': 0.9957250988696954}-{'f1_val': 0.987914979378081, 'auprc': 0.9988313404886305, 'loss_val': 0.07376321773315406, 'psi': 0.9922815238223008}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] START round=26 head_norm_before_train=1.577374 cos_to_last_merge=0.8023 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.802
[S9] round=26 local utility u=0.025193 metrics={'f1_val': 0.995976001399459, 'auprc': 0.9988407027016978, 'loss_val': 0.049226903796161556, 'psi': 0.9971218819203544}-{'f1_val': 0.9905134633010875, 'auprc': 0.9986433849666885, 'loss_val': 0.06624532394198421, 'psi': 0.9937654319673279}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=26 head_norm_before_train=1.389128 cos_to_last_merge=0.9829 (last merge round=16)
[S10] round=26 local utility u=0.015927 metrics={'f1_val': 0.9947723700160056, 'auprc': 0.9928030335020337, 'loss_val': 0.13628185459649197, 'psi': 0.9939846354104168}-{'f1_val': 0.9957455607450773, 'auprc': 0.9927820888550996, 'loss_val': 0.17391144445535417, 'psi': 0.9945601719890862}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=26 head_norm_before_train=1.455260 cos_to_last_merge=0.9650 (last merge round=15)
[S11] round=26 local utility u=0.067358 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9967509990542821, 'loss_val': 0.08169722012869735, 'psi': 0.9963928844681601}-{'f1_val': 0.9839732850981402, 'auprc': 0.9965656470060982, 'loss_val': 0.14277244437272474, 'psi': 0.9890102298613234}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] sending update (kind=head size=1804 to 1 peers)
[S13] START round=26 head_norm_before_train=1.108017 cos_to_last_merge=0.8584 (last merge round=11)
[S13] ⚠️ Model drifted since last merge! cos=0.858
[S13] round=26 local utility u=0.316162 metrics={'f1_val': 0.7086118881185948, 'auprc': 0.7066334701941482, 'loss_val': 0.42121839591343774, 'psi': 0.7078205209488162}-{'f1_val': 0.6356034477772217, 'auprc': 0.6854270107266281, 'loss_val': 0.5518722313760663, 'psi': 0.6555328729569843}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S13] sending update (kind=head size=1792 to 1 peers)
[S14] START round=26 head_norm_before_train=1.682549 cos_to_last_merge=0.9822 (last merge round=13)
[S14] round=26 local utility u=0.013765 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9969479886465118, 'loss_val': 0.026529884866991402, 'psi': 0.9973698662885169}-{'f1_val': 0.9939003034958211, 'auprc': 0.9988332913362841, 'loss_val': 0.03720995081969119, 'psi': 0.9958734986320062}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=26 head_norm_before_train=1.311371 cos_to_last_merge=0.9612 (last merge round=15)
[S15] round=26 local utility u=0.461119 metrics={'f1_val': 0.977523216773745, 'auprc': 0.9733464317748175, 'loss_val': 0.13137501704879687, 'psi': 0.975852502774174}-{'f1_val': 0.8554051969154384, 'auprc': 0.9580286464534431, 'loss_val': 0.2749524981234064, 'psi': 0.8964545767306403}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=26 head_norm_before_train=1.899090 (no previous merge yet)
[S16] round=26 local utility u=0.000000 metrics={'f1_val': 0.8404094161689504, 'auprc': 0.9801190517293957, 'loss_val': 0.767046875305058, 'psi': 0.8962932703931286}-{'f1_val': 0.9251740406320115, 'auprc': 0.995957055701001, 'loss_val': 0.25296446135822526, 'psi': 0.9534872466596073}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=26 head_norm_before_train=1.796975 (no previous merge yet)
[S17] round=26 local utility u=0.000000 metrics={'f1_val': 0.6670698359541825, 'auprc': 0.8853066951638219, 'loss_val': 0.6675079882303075, 'psi': 0.7543645796380383}-{'f1_val': 0.6849641803469035, 'auprc': 0.8934269227050486, 'loss_val': 0.44803818442645554, 'psi': 0.7683492772901617}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=27 head_norm_before_train=1.456567 cos_to_last_merge=0.9572 (last merge round=15)
[S2] round=27 local utility u=0.343213 metrics={'f1_val': 0.6997031204297328, 'auprc': 0.6590319874100625, 'loss_val': 0.3722058222312902, 'psi': 0.6834346672218647}-{'f1_val': 0.6436887882459305, 'auprc': 0.6352139835115951, 'loss_val': 0.6510920219482068, 'psi': 0.6402988663521962}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=27 head_norm_before_train=1.367259 cos_to_last_merge=0.9717 (last merge round=15)
[S3] round=27 local utility u=0.000000 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9964448624046285, 'loss_val': 0.23623124481157853, 'psi': 0.8189865207610523}-{'f1_val': 0.7007562037352997, 'auprc': 0.9961637252374991, 'loss_val': 0.2352580084548516, 'psi': 0.8189192123361795}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=27 head_norm_before_train=1.288699 cos_to_last_merge=0.9539 (last merge round=14)
[S4] round=27 local utility u=0.036440 metrics={'f1_val': 0.9420716881870868, 'auprc': 0.963374592732607, 'loss_val': 0.28751939906929924, 'psi': 0.9505928500052948}-{'f1_val': 0.9387332235010294, 'auprc': 0.9558785592567343, 'loss_val': 0.31788026129542046, 'psi': 0.9455913578033113}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] sending update (kind=head size=1805 to 1 peers)
[S5] START round=27 head_norm_before_train=1.311597 cos_to_last_merge=0.9385 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.939
[S5] round=27 local utility u=0.367174 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9966214475023654, 'loss_val': 0.2864084434845452, 'psi': 0.8188413694612944}-{'f1_val': 0.7122663714680815, 'auprc': 0.7922756043273789, 'loss_val': 0.4793888687921535, 'psi': 0.7442700646118005}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] sending update (kind=head size=1794 to 1 peers)
[S6] START round=27 head_norm_before_train=1.416006 cos_to_last_merge=0.7490 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.749
[S6] round=27 local utility u=0.000000 metrics={'f1_val': 0.5879395987845194, 'auprc': 0.7072487519141561, 'loss_val': 0.7784314456218464, 'psi': 0.6356632600363741}-{'f1_val': 0.9579702890087702, 'auprc': 0.980311351959557, 'loss_val': 0.17319636655128837, 'psi': 0.966906714189085}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=27 head_norm_before_train=1.104020 cos_to_last_merge=0.9105 (last merge round=14)
[S7] ⚠️ Model drifted since last merge! cos=0.911
[S7] round=27 local utility u=1.000000 metrics={'f1_val': 0.6975247071644319, 'auprc': 0.9719008712161963, 'loss_val': 0.3443482577885219, 'psi': 0.8072751727851377}-{'f1_val': 0.4642496633861629, 'auprc': 0.7868137720298183, 'loss_val': 1.0157415250678234, 'psi': 0.5932753068436251}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=27 head_norm_before_train=1.669845 cos_to_last_merge=0.7931 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.793
[S8] round=27 local utility u=0.000000 metrics={'f1_val': 0.9922724065265219, 'auprc': 0.9987762584372724, 'loss_val': 0.042390346258940934, 'psi': 0.9948739472908221}-{'f1_val': 0.9937842062300497, 'auprc': 0.9986364378291639, 'loss_val': 0.04812164512304839, 'psi': 0.9957250988696954}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=27 head_norm_before_train=1.600621 cos_to_last_merge=0.7991 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.799
[S9] round=27 local utility u=0.003120 metrics={'f1_val': 0.9959714971026459, 'auprc': 0.9990174260498926, 'loss_val': 0.04349090446388921, 'psi': 0.9971898686815446}-{'f1_val': 0.995976001399459, 'auprc': 0.9988407027016978, 'loss_val': 0.049226903796161556, 'psi': 0.9971218819203544}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=27 head_norm_before_train=1.415592 cos_to_last_merge=0.9798 (last merge round=16)
[S10] round=27 local utility u=0.012642 metrics={'f1_val': 0.9936518403636662, 'auprc': 0.9950578915887833, 'loss_val': 0.11103975072728695, 'psi': 0.994214260853713}-{'f1_val': 0.9947723700160056, 'auprc': 0.9928030335020337, 'loss_val': 0.13628185459649197, 'psi': 0.9939846354104168}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=27 head_norm_before_train=1.481283 cos_to_last_merge=0.9611 (last merge round=15)
[S11] round=27 local utility u=0.014651 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9982961666628816, 'loss_val': 0.059510401121261165, 'psi': 0.9972589490488808}-{'f1_val': 0.9961541414107454, 'auprc': 0.9967509990542821, 'loss_val': 0.08169722012869735, 'psi': 0.9963928844681601}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=27 head_norm_before_train=1.126624 cos_to_last_merge=0.8517 (last merge round=11)
[S13] ⚠️ Model drifted since last merge! cos=0.852
[S13] round=27 local utility u=0.000000 metrics={'f1_val': 0.6225705373371554, 'auprc': 0.622516237285436, 'loss_val': 0.5992916287756164, 'psi': 0.6225488173164677}-{'f1_val': 0.7086118881185948, 'auprc': 0.7066334701941482, 'loss_val': 0.42121839591343774, 'psi': 0.7078205209488162}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=27 head_norm_before_train=1.699293 cos_to_last_merge=0.9812 (last merge round=13)
[S14] round=27 local utility u=0.000000 metrics={'f1_val': 0.9970007132142444, 'auprc': 0.9969509091251794, 'loss_val': 0.027917602033518247, 'psi': 0.9969807915786184}-{'f1_val': 0.9976511180498535, 'auprc': 0.9969479886465118, 'loss_val': 0.026529884866991402, 'psi': 0.9973698662885169}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=27 head_norm_before_train=1.339639 cos_to_last_merge=0.9580 (last merge round=15)
[S15] round=27 local utility u=0.000000 metrics={'f1_val': 0.69670970730451, 'auprc': 0.901064554124981, 'loss_val': 0.4266030987602207, 'psi': 0.7784516460326985}-{'f1_val': 0.977523216773745, 'auprc': 0.9733464317748175, 'loss_val': 0.13137501704879687, 'psi': 0.975852502774174}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=27 head_norm_before_train=1.913171 (no previous merge yet)
[S16] round=27 local utility u=0.810515 metrics={'f1_val': 0.9903864334352546, 'auprc': 0.9929745657250124, 'loss_val': 0.08444489516242716, 'psi': 0.9914216863511577}-{'f1_val': 0.8404094161689504, 'auprc': 0.9801190517293957, 'loss_val': 0.767046875305058, 'psi': 0.8962932703931286}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S17] START round=27 head_norm_before_train=1.819108 (no previous merge yet)
[S17] round=27 local utility u=0.203529 metrics={'f1_val': 0.6964401793887486, 'auprc': 0.9029366249022364, 'loss_val': 0.48956106088094486, 'psi': 0.7790387575941438}-{'f1_val': 0.6670698359541825, 'auprc': 0.8853066951638219, 'loss_val': 0.6675079882303075, 'psi': 0.7543645796380383}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=28 head_norm_before_train=1.470413 cos_to_last_merge=0.9556 (last merge round=15)
[S2] round=28 local utility u=0.052871 metrics={'f1_val': 0.7134941650837563, 'auprc': 0.7760019997952148, 'loss_val': 0.7001191480932132, 'psi': 0.7384972989683397}-{'f1_val': 0.6997031204297328, 'auprc': 0.6590319874100625, 'loss_val': 0.3722058222312902, 'psi': 0.6834346672218647}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=28 head_norm_before_train=1.388503 cos_to_last_merge=0.9676 (last merge round=15)
[S3] round=28 local utility u=0.030963 metrics={'f1_val': 0.7041795362665894, 'auprc': 0.9965945327244823, 'loss_val': 0.19574478209626578, 'psi': 0.8211455348497465}-{'f1_val': 0.7006809596653347, 'auprc': 0.9964448624046285, 'loss_val': 0.23623124481157853, 'psi': 0.8189865207610523}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=28 head_norm_before_train=1.311606 cos_to_last_merge=0.9507 (last merge round=14)
[S4] round=28 local utility u=0.000000 metrics={'f1_val': 0.9405703917252076, 'auprc': 0.9657855724101567, 'loss_val': 0.2943573518775596, 'psi': 0.9506564639991872}-{'f1_val': 0.9420716881870868, 'auprc': 0.963374592732607, 'loss_val': 0.28751939906929924, 'psi': 0.9505928500052948}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=28 head_norm_before_train=1.323521 cos_to_last_merge=0.9365 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.936
[S5] round=28 local utility u=0.000000 metrics={'f1_val': 0.7084617373264003, 'auprc': 0.8059424936568146, 'loss_val': 0.44588736851813154, 'psi': 0.7474540398585661}-{'f1_val': 0.7003213174339138, 'auprc': 0.9966214475023654, 'loss_val': 0.2864084434845452, 'psi': 0.8188413694612944}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=28 head_norm_before_train=1.438481 cos_to_last_merge=0.7457 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.746
[S6] round=28 local utility u=1.000000 metrics={'f1_val': 0.8129976296025839, 'auprc': 0.9406625560829989, 'loss_val': 0.3837364996322665, 'psi': 0.8640636001947499}-{'f1_val': 0.5879395987845194, 'auprc': 0.7072487519141561, 'loss_val': 0.7784314456218464, 'psi': 0.6356632600363741}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] START round=28 head_norm_before_train=1.117984 cos_to_last_merge=0.9078 (last merge round=14)
[S7] ⚠️ Model drifted since last merge! cos=0.908
[S7] round=28 local utility u=0.000000 metrics={'f1_val': 0.537901329694191, 'auprc': 0.7937599703763267, 'loss_val': 0.8472604850074421, 'psi': 0.6402447859670453}-{'f1_val': 0.6975247071644319, 'auprc': 0.9719008712161963, 'loss_val': 0.3443482577885219, 'psi': 0.8072751727851377}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=28 head_norm_before_train=1.686886 cos_to_last_merge=0.7912 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.791
[S8] round=28 local utility u=0.001890 metrics={'f1_val': 0.9926368238932805, 'auprc': 0.9987304754891573, 'loss_val': 0.04065948536434201, 'psi': 0.9950742845316312}-{'f1_val': 0.9922724065265219, 'auprc': 0.9987762584372724, 'loss_val': 0.042390346258940934, 'psi': 0.9948739472908221}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=28 head_norm_before_train=1.623958 cos_to_last_merge=0.7961 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.796
[S9] round=28 local utility u=0.000000 metrics={'f1_val': 0.9870725014137546, 'auprc': 0.9990160933001554, 'loss_val': 0.05995209335347868, 'psi': 0.9918499381683149}-{'f1_val': 0.9959714971026459, 'auprc': 0.9990174260498926, 'loss_val': 0.04349090446388921, 'psi': 0.9971898686815446}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=28 head_norm_before_train=1.440707 cos_to_last_merge=0.9765 (last merge round=16)
[S10] round=28 local utility u=0.002590 metrics={'f1_val': 0.9932136491405474, 'auprc': 0.9950467907283063, 'loss_val': 0.1031979608022435, 'psi': 0.9939469057756509}-{'f1_val': 0.9936518403636662, 'auprc': 0.9950578915887833, 'loss_val': 0.11103975072728695, 'psi': 0.994214260853713}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=28 head_norm_before_train=1.502039 cos_to_last_merge=0.9580 (last merge round=15)
[S11] round=28 local utility u=0.002503 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9983587867087753, 'loss_val': 0.0545690200998765, 'psi': 0.9972717173916639}-{'f1_val': 0.996567470639547, 'auprc': 0.9982961666628816, 'loss_val': 0.059510401121261165, 'psi': 0.9972589490488808}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] sending update (kind=head size=1803 to 1 peers)
[S13] START round=28 head_norm_before_train=1.141402 cos_to_last_merge=0.8467 (last merge round=11)
[S13] ⚠️ Model drifted since last merge! cos=0.847
[S13] round=28 local utility u=0.392751 metrics={'f1_val': 0.6885529505615196, 'auprc': 0.6966681616712692, 'loss_val': 0.4321402598695626, 'psi': 0.6917990350054195}-{'f1_val': 0.6225705373371554, 'auprc': 0.622516237285436, 'loss_val': 0.5992916287756164, 'psi': 0.6225488173164677}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S13] sending update (kind=head size=1792 to 1 peers)
[S14] START round=28 head_norm_before_train=1.715718 cos_to_last_merge=0.9803 (last merge round=13)
[S14] round=28 local utility u=0.006403 metrics={'f1_val': 0.9974644126759976, 'auprc': 0.9989782030207781, 'loss_val': 0.02397547519688851, 'psi': 0.9980699288139099}-{'f1_val': 0.9970007132142444, 'auprc': 0.9969509091251794, 'loss_val': 0.027917602033518247, 'psi': 0.9969807915786184}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[S15] START round=28 head_norm_before_train=1.360263 cos_to_last_merge=0.9557 (last merge round=15)
[S15] round=28 local utility u=1.000000 metrics={'f1_val': 0.9861379120510182, 'auprc': 0.973736353634917, 'loss_val': 0.11008985312173308, 'psi': 0.9811772886845777}-{'f1_val': 0.69670970730451, 'auprc': 0.901064554124981, 'loss_val': 0.4266030987602207, 'psi': 0.7784516460326985}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] sending update (kind=head size=1793 to 1 peers)
[S16] START round=28 head_norm_before_train=1.927823 (no previous merge yet)
[S16] round=28 local utility u=0.000000 metrics={'f1_val': 0.879310436393244, 'auprc': 0.9911743444484146, 'loss_val': 0.25368449859931663, 'psi': 0.9240559996153122}-{'f1_val': 0.9903864334352546, 'auprc': 0.9929745657250124, 'loss_val': 0.08444489516242716, 'psi': 0.9914216863511577}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=28 head_norm_before_train=1.840667 (no previous merge yet)
[S17] round=28 local utility u=0.000000 metrics={'f1_val': 0.6663942218455514, 'auprc': 0.7303734778641026, 'loss_val': 0.9111899328850251, 'psi': 0.6919859242529719}-{'f1_val': 0.6964401793887486, 'auprc': 0.9029366249022364, 'loss_val': 0.48956106088094486, 'psi': 0.7790387575941438}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=29 head_norm_before_train=1.483425 cos_to_last_merge=0.9544 (last merge round=15)
[S2] round=29 local utility u=0.000000 metrics={'f1_val': 0.7012939240619982, 'auprc': 0.6600688260391254, 'loss_val': 0.3681590346938538, 'psi': 0.684803884852849}-{'f1_val': 0.7134941650837563, 'auprc': 0.7760019997952148, 'loss_val': 0.7001191480932132, 'psi': 0.7384972989683397}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=29 head_norm_before_train=1.411307 cos_to_last_merge=0.9637 (last merge round=15)
[S3] round=29 local utility u=0.871362 metrics={'f1_val': 0.9833701494118764, 'auprc': 0.998357490936437, 'loss_val': 0.13345423761175926, 'psi': 0.9893650860217006}-{'f1_val': 0.7041795362665894, 'auprc': 0.9965945327244823, 'loss_val': 0.19574478209626578, 'psi': 0.8211455348497465}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] sending update (kind=head size=1804 to 1 peers)
[S4] START round=29 head_norm_before_train=1.333850 cos_to_last_merge=0.9477 (last merge round=14)
[S4] ⚠️ Model drifted since last merge! cos=0.948
[S4] round=29 local utility u=0.000000 metrics={'f1_val': 0.6390482200769543, 'auprc': 0.9189658088046584, 'loss_val': 0.5293193777838127, 'psi': 0.7510152555680359}-{'f1_val': 0.9405703917252076, 'auprc': 0.9657855724101567, 'loss_val': 0.2943573518775596, 'psi': 0.9506564639991872}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=29 head_norm_before_train=1.337147 cos_to_last_merge=0.9342 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.934
[S5] round=29 local utility u=0.346403 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9969787458470115, 'loss_val': 0.27734731063864376, 'psi': 0.8189842887991529}-{'f1_val': 0.7084617373264003, 'auprc': 0.8059424936568146, 'loss_val': 0.44588736851813154, 'psi': 0.7474540398585661}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=29 head_norm_before_train=1.453357 cos_to_last_merge=0.7437 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.744
[S6] round=29 local utility u=0.000000 metrics={'f1_val': 0.6615025609572953, 'auprc': 0.7984350592025762, 'loss_val': 0.648107401824564, 'psi': 0.7162755602554076}-{'f1_val': 0.8129976296025839, 'auprc': 0.9406625560829989, 'loss_val': 0.3837364996322665, 'psi': 0.8640636001947499}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=29 head_norm_before_train=1.126634 cos_to_last_merge=0.9060 (last merge round=14)
[S7] ⚠️ Model drifted since last merge! cos=0.906
[S7] round=29 local utility u=0.640023 metrics={'f1_val': 0.6580660283507187, 'auprc': 0.8516265055603136, 'loss_val': 0.46180155782257004, 'psi': 0.7354902192345567}-{'f1_val': 0.537901329694191, 'auprc': 0.7937599703763267, 'loss_val': 0.8472604850074421, 'psi': 0.6402447859670453}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=29 head_norm_before_train=1.703244 cos_to_last_merge=0.7888 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.789
[S8] round=29 local utility u=0.000000 metrics={'f1_val': 0.9854960038787403, 'auprc': 0.9887239046010325, 'loss_val': 0.08368219588320545, 'psi': 0.9867871641676572}-{'f1_val': 0.9926368238932805, 'auprc': 0.9987304754891573, 'loss_val': 0.04065948536434201, 'psi': 0.9950742845316312}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=29 head_norm_before_train=1.641683 cos_to_last_merge=0.7938 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.794
[S9] round=29 local utility u=0.038298 metrics={'f1_val': 0.9959034771594892, 'auprc': 0.9986256115384275, 'loss_val': 0.035170684650037386, 'psi': 0.9969923309110645}-{'f1_val': 0.9870725014137546, 'auprc': 0.9990160933001554, 'loss_val': 0.05995209335347868, 'psi': 0.9918499381683149}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=29 head_norm_before_train=1.463669 cos_to_last_merge=0.9735 (last merge round=16)
[S10] round=29 local utility u=0.001838 metrics={'f1_val': 0.9936518403636662, 'auprc': 0.9938165285404235, 'loss_val': 0.09845934753620772, 'psi': 0.9937177156343691}-{'f1_val': 0.9932136491405474, 'auprc': 0.9950467907283063, 'loss_val': 0.1031979608022435, 'psi': 0.9939469057756509}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=29 head_norm_before_train=1.520086 cos_to_last_merge=0.9553 (last merge round=15)
[S11] round=29 local utility u=0.000000 metrics={'f1_val': 0.9963958538641108, 'auprc': 0.9981271693334889, 'loss_val': 0.05629238111231385, 'psi': 0.9970883800518621}-{'f1_val': 0.9965470045135896, 'auprc': 0.9983587867087753, 'loss_val': 0.0545690200998765, 'psi': 0.9972717173916639}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=29 head_norm_before_train=1.157946 cos_to_last_merge=0.8417 (last merge round=11)
[S13] ⚠️ Model drifted since last merge! cos=0.842
[S13] round=29 local utility u=0.000000 metrics={'f1_val': 0.6725417631676464, 'auprc': 0.6804540288765962, 'loss_val': 0.4528469239182244, 'psi': 0.6757066694512264}-{'f1_val': 0.6885529505615196, 'auprc': 0.6966681616712692, 'loss_val': 0.4321402598695626, 'psi': 0.6917990350054195}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=29 head_norm_before_train=1.728748 cos_to_last_merge=0.9794 (last merge round=13)
[S14] round=29 local utility u=0.000000 metrics={'f1_val': 0.9970007132142444, 'auprc': 0.9969170496392141, 'loss_val': 0.02649874181753336, 'psi': 0.9969672477842324}-{'f1_val': 0.9974644126759976, 'auprc': 0.9989782030207781, 'loss_val': 0.02397547519688851, 'psi': 0.9980699288139099}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=29 head_norm_before_train=1.381757 cos_to_last_merge=0.9533 (last merge round=15)
[S15] round=29 local utility u=0.000000 metrics={'f1_val': 0.9813037021863038, 'auprc': 0.9696775754298395, 'loss_val': 0.12255696621639167, 'psi': 0.9766532514837181}-{'f1_val': 0.9861379120510182, 'auprc': 0.973736353634917, 'loss_val': 0.11008985312173308, 'psi': 0.9811772886845777}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=29 head_norm_before_train=1.942785 (no previous merge yet)
[S16] round=29 local utility u=0.000000 metrics={'f1_val': 0.857799660394149, 'auprc': 0.9956952263633776, 'loss_val': 0.593014937172206, 'psi': 0.9129578867818404}-{'f1_val': 0.879310436393244, 'auprc': 0.9911743444484146, 'loss_val': 0.25368449859931663, 'psi': 0.9240559996153122}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=29 head_norm_before_train=1.860294 (no previous merge yet)
[S17] round=29 local utility u=1.000000 metrics={'f1_val': 0.8339342253886266, 'auprc': 0.9021247266318567, 'loss_val': 0.38382890636685796, 'psi': 0.8612104258859186}-{'f1_val': 0.6663942218455514, 'auprc': 0.7303734778641026, 'loss_val': 0.9111899328850251, 'psi': 0.6919859242529719}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[S2] START round=30 head_norm_before_train=1.491675 cos_to_last_merge=0.9532 (last merge round=15)
[S2] round=30 local utility u=0.115064 metrics={'f1_val': 0.7079763437905828, 'auprc': 0.779384356586485, 'loss_val': 0.5360717121346255, 'psi': 0.7365395489089437}-{'f1_val': 0.7012939240619982, 'auprc': 0.6600688260391254, 'loss_val': 0.3681590346938538, 'psi': 0.684803884852849}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=30 head_norm_before_train=1.436437 cos_to_last_merge=0.9594 (last merge round=15)
[S3] round=30 local utility u=0.000000 metrics={'f1_val': 0.9479646029069043, 'auprc': 0.996900857618074, 'loss_val': 0.14864523145275874, 'psi': 0.9675391047913722}-{'f1_val': 0.9833701494118764, 'auprc': 0.998357490936437, 'loss_val': 0.13345423761175926, 'psi': 0.9893650860217006}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=30 head_norm_before_train=1.358567 cos_to_last_merge=0.9443 (last merge round=14)
[S4] ⚠️ Model drifted since last merge! cos=0.944
[S4] round=30 local utility u=1.000000 metrics={'f1_val': 0.9424819183139024, 'auprc': 0.9688567529966685, 'loss_val': 0.2731075197415998, 'psi': 0.9530318521870088}-{'f1_val': 0.6390482200769543, 'auprc': 0.9189658088046584, 'loss_val': 0.5293193777838127, 'psi': 0.7510152555680359}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=30 head_norm_before_train=1.348355 cos_to_last_merge=0.9323 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.932
[S5] round=30 local utility u=0.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9584367207570137, 'loss_val': 0.298258080880296, 'psi': 0.8035670473976209}-{'f1_val': 0.7003213174339138, 'auprc': 0.9969787458470115, 'loss_val': 0.27734731063864376, 'psi': 0.8189842887991529}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=30 head_norm_before_train=1.464928 cos_to_last_merge=0.7421 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.742
[S6] round=30 local utility u=1.000000 metrics={'f1_val': 0.9520792317803709, 'auprc': 0.991970774154559, 'loss_val': 0.17224224125763565, 'psi': 0.9680358487300462}-{'f1_val': 0.6615025609572953, 'auprc': 0.7984350592025762, 'loss_val': 0.648107401824564, 'psi': 0.7162755602554076}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[S7] START round=30 head_norm_before_train=1.132163 cos_to_last_merge=0.9045 (last merge round=14)
[S7] ⚠️ Model drifted since last merge! cos=0.904
[S7] round=30 local utility u=0.166644 metrics={'f1_val': 0.6828977128548277, 'auprc': 0.8965538144924725, 'loss_val': 0.41228509743361164, 'psi': 0.7683601535098856}-{'f1_val': 0.6580660283507187, 'auprc': 0.8516265055603136, 'loss_val': 0.46180155782257004, 'psi': 0.7354902192345567}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] sending update (kind=head size=1797 to 1 peers)
[S8] START round=30 head_norm_before_train=1.718336 cos_to_last_merge=0.7872 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.787
[S8] round=30 local utility u=0.001603 metrics={'f1_val': 0.9771369833329042, 'auprc': 0.9988433903285712, 'loss_val': 0.06068041101418443, 'psi': 0.985819546131171}-{'f1_val': 0.9854960038787403, 'auprc': 0.9887239046010325, 'loss_val': 0.08368219588320545, 'psi': 0.9867871641676572}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=30 head_norm_before_train=1.658143 cos_to_last_merge=0.7917 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.792
[S9] round=30 local utility u=0.002061 metrics={'f1_val': 0.9963223492777684, 'auprc': 0.998622752996642, 'loss_val': 0.03355399706664531, 'psi': 0.9972425107653179}-{'f1_val': 0.9959034771594892, 'auprc': 0.9986256115384275, 'loss_val': 0.035170684650037386, 'psi': 0.9969923309110645}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=30 head_norm_before_train=1.486976 cos_to_last_merge=0.9705 (last merge round=16)
[S10] round=30 local utility u=0.000000 metrics={'f1_val': 0.9892694052325466, 'auprc': 0.9909503270653156, 'loss_val': 0.12917242535825754, 'psi': 0.9899417739656542}-{'f1_val': 0.9936518403636662, 'auprc': 0.9938165285404235, 'loss_val': 0.09845934753620772, 'psi': 0.9937177156343691}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=30 head_norm_before_train=1.535420 cos_to_last_merge=0.9531 (last merge round=15)
[S11] round=30 local utility u=0.000286 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9981505067976046, 'loss_val': 0.05421658055435787, 'psi': 0.9969404076670274}-{'f1_val': 0.9963958538641108, 'auprc': 0.9981271693334889, 'loss_val': 0.05629238111231385, 'psi': 0.9970883800518621}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=30 head_norm_before_train=1.174525 cos_to_last_merge=0.8370 (last merge round=11)
[S13] ⚠️ Model drifted since last merge! cos=0.837
[S13] round=30 local utility u=0.000000 metrics={'f1_val': 0.6350415683983347, 'auprc': 0.6760895879848802, 'loss_val': 0.5428975383616899, 'psi': 0.651460776232953}-{'f1_val': 0.6725417631676464, 'auprc': 0.6804540288765962, 'loss_val': 0.4528469239182244, 'psi': 0.6757066694512264}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=30 head_norm_before_train=1.738060 cos_to_last_merge=0.9787 (last merge round=13)
[S14] round=30 local utility u=0.001139 metrics={'f1_val': 0.9971680177638609, 'auprc': 0.9970051619851305, 'loss_val': 0.025488093275024975, 'psi': 0.9971028754523688}-{'f1_val': 0.9970007132142444, 'auprc': 0.9969170496392141, 'loss_val': 0.02649874181753336, 'psi': 0.9969672477842324}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] sending update (kind=head size=1795 to 1 peers)
[S15] START round=30 head_norm_before_train=1.408484 cos_to_last_merge=0.9505 (last merge round=15)
[S15] round=30 local utility u=0.000000 metrics={'f1_val': 0.6972828307079229, 'auprc': 0.903137890510187, 'loss_val': 0.43604666096327427, 'psi': 0.7796248546288285}-{'f1_val': 0.9813037021863038, 'auprc': 0.9696775754298395, 'loss_val': 0.12255696621639167, 'psi': 0.9766532514837181}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=30 head_norm_before_train=1.956157 (no previous merge yet)
[S16] round=30 local utility u=0.000000 metrics={'f1_val': 0.8325041494225083, 'auprc': 0.9700796016588864, 'loss_val': 0.9582689459082215, 'psi': 0.8875343303170595}-{'f1_val': 0.857799660394149, 'auprc': 0.9956952263633776, 'loss_val': 0.593014937172206, 'psi': 0.9129578867818404}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=30 head_norm_before_train=1.878506 (no previous merge yet)
[S17] round=30 local utility u=0.000000 metrics={'f1_val': 0.6600262391027485, 'auprc': 0.6880404926412913, 'loss_val': 1.0214463217907102, 'psi': 0.6712319405181656}-{'f1_val': 0.8339342253886266, 'auprc': 0.9021247266318567, 'loss_val': 0.38382890636685796, 'psi': 0.8612104258859186}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=31 head_norm_before_train=1.502663 cos_to_last_merge=0.9521 (last merge round=15)
[S2] round=31 local utility u=0.008058 metrics={'f1_val': 0.7068432446207658, 'auprc': 0.7684972267432222, 'loss_val': 0.4804955324823561, 'psi': 0.7315048374697484}-{'f1_val': 0.7079763437905828, 'auprc': 0.779384356586485, 'loss_val': 0.5360717121346255, 'psi': 0.7365395489089437}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] sending update (kind=head size=1804 to 1 peers)
[S3] START round=31 head_norm_before_train=1.460078 cos_to_last_merge=0.9548 (last merge round=15)
[S3] round=31 local utility u=0.181934 metrics={'f1_val': 0.9973696976584205, 'auprc': 0.9980717333522903, 'loss_val': 0.08472008217386132, 'psi': 0.9976505119359684}-{'f1_val': 0.9479646029069043, 'auprc': 0.996900857618074, 'loss_val': 0.14864523145275874, 'psi': 0.9675391047913722}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] sending update (kind=head size=1803 to 1 peers)
[S4] START round=31 head_norm_before_train=1.382692 cos_to_last_merge=0.9414 (last merge round=14)
[S4] ⚠️ Model drifted since last merge! cos=0.941
[S4] round=31 local utility u=0.000000 metrics={'f1_val': 0.9405805901785854, 'auprc': 0.9585972883199032, 'loss_val': 0.2812298368660776, 'psi': 0.9477872694351126}-{'f1_val': 0.9424819183139024, 'auprc': 0.9688567529966685, 'loss_val': 0.2731075197415998, 'psi': 0.9530318521870088}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=31 head_norm_before_train=1.358814 cos_to_last_merge=0.9298 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.930
[S5] round=31 local utility u=0.069487 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9949168893849497, 'loss_val': 0.26872407950201826, 'psi': 0.8181591148487952}-{'f1_val': 0.700320598491359, 'auprc': 0.9584367207570137, 'loss_val': 0.298258080880296, 'psi': 0.8035670473976209}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=31 head_norm_before_train=1.478668 cos_to_last_merge=0.7402 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.740
[S6] round=31 local utility u=0.000000 metrics={'f1_val': 0.825943286001915, 'auprc': 0.969558400274541, 'loss_val': 0.36070164737574534, 'psi': 0.8833893317109655}-{'f1_val': 0.9520792317803709, 'auprc': 0.991970774154559, 'loss_val': 0.17224224125763565, 'psi': 0.9680358487300462}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=31 head_norm_before_train=1.137441 cos_to_last_merge=0.9026 (last merge round=14)
[S7] ⚠️ Model drifted since last merge! cos=0.903
[S7] round=31 local utility u=0.000000 metrics={'f1_val': 0.45226147803771455, 'auprc': 0.7823770015305869, 'loss_val': 0.9227407873721762, 'psi': 0.5843076874348635}-{'f1_val': 0.6828977128548277, 'auprc': 0.8965538144924725, 'loss_val': 0.41228509743361164, 'psi': 0.7683601535098856}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=31 head_norm_before_train=1.730294 cos_to_last_merge=0.7858 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.786
[S8] round=31 local utility u=0.000000 metrics={'f1_val': 0.7345759433479653, 'auprc': 0.9877474064843313, 'loss_val': 0.1987284338363392, 'psi': 0.8358445286025118}-{'f1_val': 0.9771369833329042, 'auprc': 0.9988433903285712, 'loss_val': 0.06068041101418443, 'psi': 0.985819546131171}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=31 head_norm_before_train=1.676076 cos_to_last_merge=0.7896 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.790
[S9] round=31 local utility u=0.000000 metrics={'f1_val': 0.9878532334303461, 'auprc': 0.9986190995672808, 'loss_val': 0.047375900803186884, 'psi': 0.99215957988512}-{'f1_val': 0.9963223492777684, 'auprc': 0.998622752996642, 'loss_val': 0.03355399706664531, 'psi': 0.9972425107653179}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=31 head_norm_before_train=1.509003 cos_to_last_merge=0.9680 (last merge round=16)
[S10] round=31 local utility u=0.026133 metrics={'f1_val': 0.9933443720574087, 'auprc': 0.9940007345794633, 'loss_val': 0.11050831801887899, 'psi': 0.9936069170662305}-{'f1_val': 0.9892694052325466, 'auprc': 0.9909503270653156, 'loss_val': 0.12917242535825754, 'psi': 0.9899417739656542}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=31 head_norm_before_train=1.547736 cos_to_last_merge=0.9514 (last merge round=15)
[S11] round=31 local utility u=0.001481 metrics={'f1_val': 0.9963958538641108, 'auprc': 0.9976987390373406, 'loss_val': 0.05147152622304908, 'psi': 0.9969170079334028}-{'f1_val': 0.9961336749133093, 'auprc': 0.9981505067976046, 'loss_val': 0.05421658055435787, 'psi': 0.9969404076670274}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=31 head_norm_before_train=1.192303 cos_to_last_merge=0.8315 (last merge round=11)
[S13] ⚠️ Model drifted since last merge! cos=0.831
[S13] round=31 local utility u=0.000000 metrics={'f1_val': 0.5855309001847082, 'auprc': 0.6806940416931904, 'loss_val': 0.7621063007369814, 'psi': 0.6235961567881011}-{'f1_val': 0.6350415683983347, 'auprc': 0.6760895879848802, 'loss_val': 0.5428975383616899, 'psi': 0.651460776232953}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=31 head_norm_before_train=1.749256 cos_to_last_merge=0.9782 (last merge round=13)
[S14] round=31 local utility u=0.001484 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9969759319509308, 'loss_val': 0.02387416276608523, 'psi': 0.9972353344814077}-{'f1_val': 0.9971680177638609, 'auprc': 0.9970051619851305, 'loss_val': 0.025488093275024975, 'psi': 0.9971028754523688}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=31 head_norm_before_train=1.432831 cos_to_last_merge=0.9480 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.948
[S15] round=31 local utility u=0.112454 metrics={'f1_val': 0.7361975906537496, 'auprc': 0.8970846091670943, 'loss_val': 0.42646717318378863, 'psi': 0.8005523980590874}-{'f1_val': 0.6972828307079229, 'auprc': 0.903137890510187, 'loss_val': 0.43604666096327427, 'psi': 0.7796248546288285}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=31 head_norm_before_train=1.966541 (no previous merge yet)
[S16] round=31 local utility u=0.690643 metrics={'f1_val': 0.9349404815750018, 'auprc': 0.9944481084402417, 'loss_val': 0.2647070665414332, 'psi': 0.9587435323210978}-{'f1_val': 0.8325041494225083, 'auprc': 0.9700796016588864, 'loss_val': 0.9582689459082215, 'psi': 0.8875343303170595}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=31 head_norm_before_train=1.891425 (no previous merge yet)
[S17] round=31 local utility u=0.054021 metrics={'f1_val': 0.6533757637279014, 'auprc': 0.7557439846837546, 'loss_val': 1.0766117673639386, 'psi': 0.6943230521102427}-{'f1_val': 0.6600262391027485, 'auprc': 0.6880404926412913, 'loss_val': 1.0214463217907102, 'psi': 0.6712319405181656}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] START round=32 head_norm_before_train=1.513854 cos_to_last_merge=0.9511 (last merge round=15)
[S2] round=32 local utility u=0.000000 metrics={'f1_val': 0.7065105968150883, 'auprc': 0.7028616325791675, 'loss_val': 0.3749817672146395, 'psi': 0.70505101112072}-{'f1_val': 0.7068432446207658, 'auprc': 0.7684972267432222, 'loss_val': 0.4804955324823561, 'psi': 0.7315048374697484}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=32 head_norm_before_train=1.486144 cos_to_last_merge=0.9494 (last merge round=15)
[S3] ⚠️ Model drifted since last merge! cos=0.949
[S3] round=32 local utility u=0.003929 metrics={'f1_val': 0.9973670153333725, 'auprc': 0.9978059942276272, 'loss_val': 0.07604795833870534, 'psi': 0.9975426068910744}-{'f1_val': 0.9973696976584205, 'auprc': 0.9980717333522903, 'loss_val': 0.08472008217386132, 'psi': 0.9976505119359684}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S3] sending update (kind=head size=1807 to 1 peers)
[S4] START round=32 head_norm_before_train=1.401082 cos_to_last_merge=0.9391 (last merge round=14)
[S4] ⚠️ Model drifted since last merge! cos=0.939
[S4] round=32 local utility u=0.000000 metrics={'f1_val': 0.9367034440624709, 'auprc': 0.9514579336170629, 'loss_val': 0.29654837003783857, 'psi': 0.9426052398843077}-{'f1_val': 0.9405805901785854, 'auprc': 0.9585972883199032, 'loss_val': 0.2812298368660776, 'psi': 0.9477872694351126}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=32 head_norm_before_train=1.371951 cos_to_last_merge=0.9259 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.926
[S5] round=32 local utility u=0.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9851984089815079, 'loss_val': 0.2817487123419248, 'psi': 0.8142717226874185}-{'f1_val': 0.700320598491359, 'auprc': 0.9949168893849497, 'loss_val': 0.26872407950201826, 'psi': 0.8181591148487952}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=32 head_norm_before_train=1.493813 cos_to_last_merge=0.7378 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.738
[S6] round=32 local utility u=0.029930 metrics={'f1_val': 0.8245656164743489, 'auprc': 0.968092303783721, 'loss_val': 0.28817656618375076, 'psi': 0.8819762913980977}-{'f1_val': 0.825943286001915, 'auprc': 0.969558400274541, 'loss_val': 0.36070164737574534, 'psi': 0.8833893317109655}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S6] sending update (kind=head size=1806 to 1 peers)
[S7] START round=32 head_norm_before_train=1.143883 cos_to_last_merge=0.9003 (last merge round=14)
[S7] ⚠️ Model drifted since last merge! cos=0.900
[S7] round=32 local utility u=1.000000 metrics={'f1_val': 0.6990924325163795, 'auprc': 0.980460471080224, 'loss_val': 0.338962375700501, 'psi': 0.8116396479419173}-{'f1_val': 0.45226147803771455, 'auprc': 0.7823770015305869, 'loss_val': 0.9227407873721762, 'psi': 0.5843076874348635}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S8] START round=32 head_norm_before_train=1.742809 cos_to_last_merge=0.7845 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.784
[S8] round=32 local utility u=0.860330 metrics={'f1_val': 0.9894208216881261, 'auprc': 0.9988146329487777, 'loss_val': 0.04033886994348965, 'psi': 0.9931783461923867}-{'f1_val': 0.7345759433479653, 'auprc': 0.9877474064843313, 'loss_val': 0.1987284338363392, 'psi': 0.8358445286025118}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=32 head_norm_before_train=1.693878 cos_to_last_merge=0.7875 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.788
[S9] round=32 local utility u=0.000000 metrics={'f1_val': 0.986572608707039, 'auprc': 0.999011068587877, 'loss_val': 0.053111375905059655, 'psi': 0.9915479926593742}-{'f1_val': 0.9878532334303461, 'auprc': 0.9986190995672808, 'loss_val': 0.047375900803186884, 'psi': 0.99215957988512}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=32 head_norm_before_train=1.528342 cos_to_last_merge=0.9659 (last merge round=16)
[S10] round=32 local utility u=0.003867 metrics={'f1_val': 0.9949140915418154, 'auprc': 0.9918121446582268, 'loss_val': 0.10562603533048398, 'psi': 0.9936733127883799}-{'f1_val': 0.9933443720574087, 'auprc': 0.9940007345794633, 'loss_val': 0.11050831801887899, 'psi': 0.9936069170662305}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=32 head_norm_before_train=1.563638 cos_to_last_merge=0.9491 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.949
[S11] round=32 local utility u=0.004747 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9983943810824847, 'loss_val': 0.04351996232123943, 'psi': 0.9971408529143104}-{'f1_val': 0.9963958538641108, 'auprc': 0.9976987390373406, 'loss_val': 0.05147152622304908, 'psi': 0.9969170079334028}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] sending update (kind=head size=1803 to 1 peers)
[S13] START round=32 head_norm_before_train=1.208650 cos_to_last_merge=0.8267 (last merge round=11)
[S13] ⚠️ Model drifted since last merge! cos=0.827
[S13] round=32 local utility u=0.385929 metrics={'f1_val': 0.6681209406935341, 'auprc': 0.6728212010244508, 'loss_val': 0.4621693491516761, 'psi': 0.6700010448259008}-{'f1_val': 0.5855309001847082, 'auprc': 0.6806940416931904, 'loss_val': 0.7621063007369814, 'psi': 0.6235961567881011}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] sending update (kind=head size=1795 to 1 peers)
[S14] START round=32 head_norm_before_train=1.760413 cos_to_last_merge=0.9777 (last merge round=13)
[S14] round=32 local utility u=0.002290 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9986395359836024, 'loss_val': 0.024284674953462485, 'psi': 0.9979007760944764}-{'f1_val': 0.9974082695017256, 'auprc': 0.9969759319509308, 'loss_val': 0.02387416276608523, 'psi': 0.9972353344814077}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=32 head_norm_before_train=1.453799 cos_to_last_merge=0.9458 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.946
[S15] round=32 local utility u=0.493111 metrics={'f1_val': 0.8603806950484887, 'auprc': 0.9381133265141375, 'loss_val': 0.3084290305115523, 'psi': 0.8914737476347482}-{'f1_val': 0.7361975906537496, 'auprc': 0.8970846091670943, 'loss_val': 0.42646717318378863, 'psi': 0.8005523980590874}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=32 head_norm_before_train=1.974419 (no previous merge yet)
[S16] round=32 local utility u=0.000000 metrics={'f1_val': 0.9344544540690083, 'auprc': 0.9893592821874039, 'loss_val': 0.27487259159060656, 'psi': 0.9564163853163665}-{'f1_val': 0.9349404815750018, 'auprc': 0.9944481084402417, 'loss_val': 0.2647070665414332, 'psi': 0.9587435323210978}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=32 head_norm_before_train=1.902783 (no previous merge yet)
[S17] round=32 local utility u=0.976144 metrics={'f1_val': 0.78201854475019, 'auprc': 0.9138181934708155, 'loss_val': 0.370402818179905, 'psi': 0.8347384042384403}-{'f1_val': 0.6533757637279014, 'auprc': 0.7557439846837546, 'loss_val': 1.0766117673639386, 'psi': 0.6943230521102427}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] sending update (kind=head size=1794 to 1 peers)
[S2] START round=33 head_norm_before_train=1.525573 cos_to_last_merge=0.9503 (last merge round=15)
[S2] round=33 local utility u=0.000000 metrics={'f1_val': 0.7068966078897714, 'auprc': 0.7105596305087629, 'loss_val': 0.4053702107338874, 'psi': 0.708361816937368}-{'f1_val': 0.7065105968150883, 'auprc': 0.7028616325791675, 'loss_val': 0.3749817672146395, 'psi': 0.70505101112072}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=33 head_norm_before_train=1.510903 cos_to_last_merge=0.9441 (last merge round=15)
[S3] ⚠️ Model drifted since last merge! cos=0.944
[S3] round=33 local utility u=0.000000 metrics={'f1_val': 0.9838348379227521, 'auprc': 0.9980027043105486, 'loss_val': 0.07335394703470513, 'psi': 0.9895019844778707}-{'f1_val': 0.9973670153333725, 'auprc': 0.9978059942276272, 'loss_val': 0.07604795833870534, 'psi': 0.9975426068910744}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=33 head_norm_before_train=1.423220 cos_to_last_merge=0.9363 (last merge round=14)
[S4] ⚠️ Model drifted since last merge! cos=0.936
[S4] round=33 local utility u=0.036272 metrics={'f1_val': 0.9408898073851638, 'auprc': 0.9610616044172992, 'loss_val': 0.2779335359514713, 'psi': 0.948958526198018}-{'f1_val': 0.9367034440624709, 'auprc': 0.9514579336170629, 'loss_val': 0.29654837003783857, 'psi': 0.9426052398843077}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=33 head_norm_before_train=1.387824 cos_to_last_merge=0.9227 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.923
[S5] round=33 local utility u=0.002923 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9887139905018429, 'loss_val': 0.2864490034123677, 'psi': 0.8156779552955526}-{'f1_val': 0.700320598491359, 'auprc': 0.9851984089815079, 'loss_val': 0.2817487123419248, 'psi': 0.8142717226874185}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] START round=33 head_norm_before_train=1.510914 cos_to_last_merge=0.7352 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.735
[S6] round=33 local utility u=0.000000 metrics={'f1_val': 0.6671637854420929, 'auprc': 0.8475262135491577, 'loss_val': 0.7461582858703475, 'psi': 0.7393087566849188}-{'f1_val': 0.8245656164743489, 'auprc': 0.968092303783721, 'loss_val': 0.28817656618375076, 'psi': 0.8819762913980977}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=33 head_norm_before_train=1.150544 cos_to_last_merge=0.8979 (last merge round=14)
[S7] ⚠️ Model drifted since last merge! cos=0.898
[S7] round=33 local utility u=0.000000 metrics={'f1_val': 0.5989012716001105, 'auprc': 0.8012385754297224, 'loss_val': 0.6247584183704538, 'psi': 0.6798361931319552}-{'f1_val': 0.6990924325163795, 'auprc': 0.980460471080224, 'loss_val': 0.338962375700501, 'psi': 0.8116396479419173}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=33 head_norm_before_train=1.753168 cos_to_last_merge=0.7834 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.783
[S8] round=33 local utility u=0.007446 metrics={'f1_val': 0.9914375510364866, 'auprc': 0.9987681537856374, 'loss_val': 0.03740853813169751, 'psi': 0.9943697921361468}-{'f1_val': 0.9894208216881261, 'auprc': 0.9988146329487777, 'loss_val': 0.04033886994348965, 'psi': 0.9931783461923867}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] START round=33 head_norm_before_train=1.709644 cos_to_last_merge=0.7859 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.786
[S9] round=33 local utility u=0.042445 metrics={'f1_val': 0.9965146876110058, 'auprc': 0.9990241233308979, 'loss_val': 0.027913542013845435, 'psi': 0.9975184618989625}-{'f1_val': 0.986572608707039, 'auprc': 0.999011068587877, 'loss_val': 0.053111375905059655, 'psi': 0.9915479926593742}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=33 head_norm_before_train=1.543269 cos_to_last_merge=0.9643 (last merge round=16)
[S10] round=33 local utility u=0.002061 metrics={'f1_val': 0.9946947145349516, 'auprc': 0.9925646876458845, 'loss_val': 0.1024460973204728, 'psi': 0.9938427037793247}-{'f1_val': 0.9949140915418154, 'auprc': 0.9918121446582268, 'loss_val': 0.10562603533048398, 'psi': 0.9936733127883799}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] sending update (kind=head size=1805 to 1 peers)
[S11] START round=33 head_norm_before_train=1.580866 cos_to_last_merge=0.9465 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.947
[S11] round=33 local utility u=0.000000 metrics={'f1_val': 0.9959123037929781, 'auprc': 0.9982034178003456, 'loss_val': 0.04592670483769034, 'psi': 0.9968287493959251}-{'f1_val': 0.996305167468861, 'auprc': 0.9983943810824847, 'loss_val': 0.04351996232123943, 'psi': 0.9971408529143104}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=33 head_norm_before_train=1.221162 cos_to_last_merge=0.8233 (last merge round=11)
[S13] ⚠️ Model drifted since last merge! cos=0.823
[S13] round=33 local utility u=0.000000 metrics={'f1_val': 0.6296453802519653, 'auprc': 0.6830732441734388, 'loss_val': 0.5586615678535227, 'psi': 0.6510165258205547}-{'f1_val': 0.6681209406935341, 'auprc': 0.6728212010244508, 'loss_val': 0.4621693491516761, 'psi': 0.6700010448259008}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=33 head_norm_before_train=1.770790 cos_to_last_merge=0.9772 (last merge round=13)
[S14] round=33 local utility u=0.002436 metrics={'f1_val': 0.9976291097282272, 'auprc': 0.9990500857247713, 'loss_val': 0.021969781914677036, 'psi': 0.9981975001268448}-{'f1_val': 0.9974082695017256, 'auprc': 0.9986395359836024, 'loss_val': 0.024284674953462485, 'psi': 0.9979007760944764}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=33 head_norm_before_train=1.471553 cos_to_last_merge=0.9441 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.944
[S15] round=33 local utility u=0.000000 metrics={'f1_val': 0.6967136548306493, 'auprc': 0.813271196378596, 'loss_val': 0.5182047888397191, 'psi': 0.743336671449828}-{'f1_val': 0.8603806950484887, 'auprc': 0.9381133265141375, 'loss_val': 0.3084290305115523, 'psi': 0.8914737476347482}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=33 head_norm_before_train=1.983609 (no previous merge yet)
[S16] round=33 local utility u=0.240129 metrics={'f1_val': 0.9792245898495806, 'auprc': 0.9926478692670113, 'loss_val': 0.07310082891749273, 'psi': 0.9845939016165528}-{'f1_val': 0.9344544540690083, 'auprc': 0.9893592821874039, 'loss_val': 0.27487259159060656, 'psi': 0.9564163853163665}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S16] sending update (kind=head size=1792 to 1 peers)
[S17] START round=33 head_norm_before_train=1.912274 (no previous merge yet)
[S17] round=33 local utility u=0.000000 metrics={'f1_val': 0.6675717705061402, 'auprc': 0.8883777217121093, 'loss_val': 0.7549635258738164, 'psi': 0.7558941509885279}-{'f1_val': 0.78201854475019, 'auprc': 0.9138181934708155, 'loss_val': 0.370402818179905, 'psi': 0.8347384042384403}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=34 head_norm_before_train=1.537018 cos_to_last_merge=0.9496 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.950
[S2] round=34 local utility u=0.017045 metrics={'f1_val': 0.7158517689337088, 'auprc': 0.7753267622697634, 'loss_val': 0.6193124804265951, 'psi': 0.7396417662681307}-{'f1_val': 0.7068966078897714, 'auprc': 0.7105596305087629, 'loss_val': 0.4053702107338874, 'psi': 0.708361816937368}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=34 head_norm_before_train=1.535766 cos_to_last_merge=0.9386 (last merge round=15)
[S3] ⚠️ Model drifted since last merge! cos=0.939
[S3] round=34 local utility u=0.000000 metrics={'f1_val': 0.9628852465428241, 'auprc': 0.9982892936387298, 'loss_val': 0.08745530261241026, 'psi': 0.9770468653811863}-{'f1_val': 0.9838348379227521, 'auprc': 0.9980027043105486, 'loss_val': 0.07335394703470513, 'psi': 0.9895019844778707}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=34 head_norm_before_train=1.437731 cos_to_last_merge=0.9349 (last merge round=14)
[S4] ⚠️ Model drifted since last merge! cos=0.935
[S4] round=34 local utility u=0.024164 metrics={'f1_val': 0.9429564737884262, 'auprc': 0.9701454286440581, 'loss_val': 0.269257995350657, 'psi': 0.9538320557306789}-{'f1_val': 0.9408898073851638, 'auprc': 0.9610616044172992, 'loss_val': 0.2779335359514713, 'psi': 0.948958526198018}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=34 head_norm_before_train=1.402853 cos_to_last_merge=0.9216 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.922
[S5] round=34 local utility u=0.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9789384514084296, 'loss_val': 0.2954251124195265, 'psi': 0.8117677396581873}-{'f1_val': 0.700320598491359, 'auprc': 0.9887139905018429, 'loss_val': 0.2864490034123677, 'psi': 0.8156779552955526}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=34 head_norm_before_train=1.526621 cos_to_last_merge=0.7328 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.733
[S6] round=34 local utility u=0.727594 metrics={'f1_val': 0.8100925662313058, 'auprc': 0.9398088416836708, 'loss_val': 0.4253918349385809, 'psi': 0.8619790764122518}-{'f1_val': 0.6671637854420929, 'auprc': 0.8475262135491577, 'loss_val': 0.7461582858703475, 'psi': 0.7393087566849188}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S6] sending update (kind=head size=1806 to 1 peers)
[S7] START round=34 head_norm_before_train=1.159955 cos_to_last_merge=0.8953 (last merge round=14)
[S7] ⚠️ Model drifted since last merge! cos=0.895
[S7] round=34 local utility u=0.000000 metrics={'f1_val': 0.5750724836717274, 'auprc': 0.7984222025406824, 'loss_val': 0.6621634940350134, 'psi': 0.6644123712193094}-{'f1_val': 0.5989012716001105, 'auprc': 0.8012385754297224, 'loss_val': 0.6247584183704538, 'psi': 0.6798361931319552}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=34 head_norm_before_train=1.761364 cos_to_last_merge=0.7827 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.783
[S8] round=34 local utility u=0.000000 metrics={'f1_val': 0.7142391053978291, 'auprc': 0.9806556805590269, 'loss_val': 0.6168840223481966, 'psi': 0.8208057354623082}-{'f1_val': 0.9914375510364866, 'auprc': 0.9987681537856374, 'loss_val': 0.03740853813169751, 'psi': 0.9943697921361468}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=34 head_norm_before_train=1.724908 cos_to_last_merge=0.7843 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.784
[S9] round=34 local utility u=0.000333 metrics={'f1_val': 0.9963948735177381, 'auprc': 0.9990177378116477, 'loss_val': 0.026508980565408218, 'psi': 0.9974440192353019}-{'f1_val': 0.9965146876110058, 'auprc': 0.9990241233308979, 'loss_val': 0.027913542013845435, 'psi': 0.9975184618989625}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] sending update (kind=head size=1794 to 1 peers)
[S10] START round=34 head_norm_before_train=1.555071 cos_to_last_merge=0.9630 (last merge round=16)
[S10] round=34 local utility u=0.000000 metrics={'f1_val': 0.9927091664903633, 'auprc': 0.9924472143546149, 'loss_val': 0.11688494755136788, 'psi': 0.992604385636064}-{'f1_val': 0.9946947145349516, 'auprc': 0.9925646876458845, 'loss_val': 0.1024460973204728, 'psi': 0.9938427037793247}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=34 head_norm_before_train=1.596986 cos_to_last_merge=0.9442 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.944
[S11] round=34 local utility u=0.000000 metrics={'f1_val': 0.9954332224704452, 'auprc': 0.9966061917160804, 'loss_val': 0.06497246427604376, 'psi': 0.9959024101686993}-{'f1_val': 0.9959123037929781, 'auprc': 0.9982034178003456, 'loss_val': 0.04592670483769034, 'psi': 0.9968287493959251}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=34 head_norm_before_train=1.232370 cos_to_last_merge=0.8197 (last merge round=11)
[S13] ⚠️ Model drifted since last merge! cos=0.820
[S13] round=34 local utility u=0.000000 metrics={'f1_val': 0.6319180425430356, 'auprc': 0.6635049740398804, 'loss_val': 0.5595417691753187, 'psi': 0.6445528151417735}-{'f1_val': 0.6296453802519653, 'auprc': 0.6830732441734388, 'loss_val': 0.5586615678535227, 'psi': 0.6510165258205547}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=34 head_norm_before_train=1.778694 cos_to_last_merge=0.9766 (last merge round=13)
[S14] round=34 local utility u=0.003084 metrics={'f1_val': 0.9983050875260411, 'auprc': 0.999053002132275, 'loss_val': 0.019866193662145832, 'psi': 0.9986042533685346}-{'f1_val': 0.9976291097282272, 'auprc': 0.9990500857247713, 'loss_val': 0.021969781914677036, 'psi': 0.9981975001268448}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] sending update (kind=head size=1804 to 1 peers)
[S15] START round=34 head_norm_before_train=1.488790 cos_to_last_merge=0.9423 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.942
[S15] round=34 local utility u=0.685590 metrics={'f1_val': 0.8051911402596856, 'auprc': 0.976181886133148, 'loss_val': 0.2866218097184345, 'psi': 0.8735874386090706}-{'f1_val': 0.6967136548306493, 'auprc': 0.813271196378596, 'loss_val': 0.5182047888397191, 'psi': 0.743336671449828}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=34 head_norm_before_train=1.994946 (no previous merge yet)
[S16] round=34 local utility u=0.056747 metrics={'f1_val': 0.9928417395702315, 'auprc': 0.9954543742414533, 'loss_val': 0.04973002995333563, 'psi': 0.9938867934387202}-{'f1_val': 0.9792245898495806, 'auprc': 0.9926478692670113, 'loss_val': 0.07310082891749273, 'psi': 0.9845939016165528}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] sending update (kind=head size=1793 to 1 peers)
[S17] START round=34 head_norm_before_train=1.919540 (no previous merge yet)
[S17] round=34 local utility u=0.263937 metrics={'f1_val': 0.7218215223154317, 'auprc': 0.9125289606852425, 'loss_val': 0.6250412479322488, 'psi': 0.798104497663356}-{'f1_val': 0.6675717705061402, 'auprc': 0.8883777217121093, 'loss_val': 0.7549635258738164, 'psi': 0.7558941509885279}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] START round=35 head_norm_before_train=1.549489 cos_to_last_merge=0.9487 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.949
[S2] round=35 local utility u=0.000000 metrics={'f1_val': 0.7088646219515463, 'auprc': 0.7508230578787866, 'loss_val': 0.5574515951472298, 'psi': 0.7256479963224425}-{'f1_val': 0.7158517689337088, 'auprc': 0.7753267622697634, 'loss_val': 0.6193124804265951, 'psi': 0.7396417662681307}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=35 head_norm_before_train=1.559654 cos_to_last_merge=0.9333 (last merge round=15)
[S3] ⚠️ Model drifted since last merge! cos=0.933
[S3] round=35 local utility u=0.068763 metrics={'f1_val': 0.9834363840689774, 'auprc': 0.9984273880461223, 'loss_val': 0.07365051956550057, 'psi': 0.9894327856598353}-{'f1_val': 0.9628852465428241, 'auprc': 0.9982892936387298, 'loss_val': 0.08745530261241026, 'psi': 0.9770468653811863}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] sending update (kind=head size=1805 to 1 peers)
[S4] START round=35 head_norm_before_train=1.446324 cos_to_last_merge=0.9340 (last merge round=14)
[S4] ⚠️ Model drifted since last merge! cos=0.934
[S4] round=35 local utility u=0.000000 metrics={'f1_val': 0.6493175329847165, 'auprc': 0.9017544541271951, 'loss_val': 0.5583082352269817, 'psi': 0.750292301441708}-{'f1_val': 0.9429564737884262, 'auprc': 0.9701454286440581, 'loss_val': 0.269257995350657, 'psi': 0.9538320557306789}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=35 head_norm_before_train=1.419187 cos_to_last_merge=0.9203 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.920
[S5] round=35 local utility u=0.022664 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9818531821353979, 'loss_val': 0.25884129991521837, 'psi': 0.8129336319489746}-{'f1_val': 0.700320598491359, 'auprc': 0.9789384514084296, 'loss_val': 0.2954251124195265, 'psi': 0.8117677396581873}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=35 head_norm_before_train=1.539297 cos_to_last_merge=0.7309 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.731
[S6] round=35 local utility u=0.745355 metrics={'f1_val': 0.9857451327559594, 'auprc': 0.9796549122622333, 'loss_val': 0.10813568078507055, 'psi': 0.983309044558469}-{'f1_val': 0.8100925662313058, 'auprc': 0.9398088416836708, 'loss_val': 0.4253918349385809, 'psi': 0.8619790764122518}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S6] sending update (kind=head size=1808 to 1 peers)
[S7] START round=35 head_norm_before_train=1.171164 cos_to_last_merge=0.8923 (last merge round=14)
[S7] ⚠️ Model drifted since last merge! cos=0.892
[S7] round=35 local utility u=0.582797 metrics={'f1_val': 0.6776725534712915, 'auprc': 0.8828682403807714, 'loss_val': 0.36550899782774315, 'psi': 0.7597508282350834}-{'f1_val': 0.5750724836717274, 'auprc': 0.7984222025406824, 'loss_val': 0.6621634940350134, 'psi': 0.6644123712193094}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S7] sending update (kind=head size=1807 to 1 peers)
[S8] START round=35 head_norm_before_train=1.768199 cos_to_last_merge=0.7821 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.782
[S8] round=35 local utility u=0.055349 metrics={'f1_val': 0.7061461739898125, 'auprc': 0.9742341851177092, 'loss_val': 0.43836296318680773, 'psi': 0.8133813784409711}-{'f1_val': 0.7142391053978291, 'auprc': 0.9806556805590269, 'loss_val': 0.6168840223481966, 'psi': 0.8208057354623082}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=35 head_norm_before_train=1.739734 cos_to_last_merge=0.7827 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.783
[S9] round=35 local utility u=0.000000 metrics={'f1_val': 0.9912441468948172, 'auprc': 0.9989926272333364, 'loss_val': 0.03493029879643802, 'psi': 0.9943435390302249}-{'f1_val': 0.9963948735177381, 'auprc': 0.9990177378116477, 'loss_val': 0.026508980565408218, 'psi': 0.9974440192353019}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=35 head_norm_before_train=1.567474 cos_to_last_merge=0.9617 (last merge round=16)
[S10] round=35 local utility u=0.000000 metrics={'f1_val': 0.9414970511217404, 'auprc': 0.9919949491231461, 'loss_val': 0.15961237727035182, 'psi': 0.9616962103223027}-{'f1_val': 0.9927091664903633, 'auprc': 0.9924472143546149, 'loss_val': 0.11688494755136788, 'psi': 0.992604385636064}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=35 head_norm_before_train=1.613195 cos_to_last_merge=0.9419 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.942
[S11] round=35 local utility u=0.016073 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9980743835124056, 'loss_val': 0.041556978568341, 'psi': 0.9969222382514095}-{'f1_val': 0.9954332224704452, 'auprc': 0.9966061917160804, 'loss_val': 0.06497246427604376, 'psi': 0.9959024101686993}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=35 head_norm_before_train=1.244919 cos_to_last_merge=0.8157 (last merge round=11)
[S13] ⚠️ Model drifted since last merge! cos=0.816
[S13] round=35 local utility u=0.000000 metrics={'f1_val': 0.6167106059520748, 'auprc': 0.6833605959781841, 'loss_val': 0.6218103719778773, 'psi': 0.6433706019625185}-{'f1_val': 0.6319180425430356, 'auprc': 0.6635049740398804, 'loss_val': 0.5595417691753187, 'psi': 0.6445528151417735}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=35 head_norm_before_train=1.790904 cos_to_last_merge=0.9758 (last merge round=13)
[S14] round=35 local utility u=0.000000 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9990500673911656, 'loss_val': 0.019155421216953433, 'psi': 0.9982106977863784}-{'f1_val': 0.9983050875260411, 'auprc': 0.999053002132275, 'loss_val': 0.019866193662145832, 'psi': 0.9986042533685346}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=35 head_norm_before_train=1.501296 cos_to_last_merge=0.9409 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.941
[S15] round=35 local utility u=0.615348 metrics={'f1_val': 0.9825684596137341, 'auprc': 0.9725804527547064, 'loss_val': 0.10938451737815529, 'psi': 0.9785732568701231}-{'f1_val': 0.8051911402596856, 'auprc': 0.976181886133148, 'loss_val': 0.2866218097184345, 'psi': 0.8735874386090706}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=35 head_norm_before_train=2.007061 (no previous merge yet)
[S16] round=35 local utility u=0.000000 metrics={'f1_val': 0.9917367584934558, 'auprc': 0.9937484502216124, 'loss_val': 0.055656856623241685, 'psi': 0.9925414351847184}-{'f1_val': 0.9928417395702315, 'auprc': 0.9954543742414533, 'loss_val': 0.04973002995333563, 'psi': 0.9938867934387202}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=35 head_norm_before_train=1.932102 (no previous merge yet)
[S17] round=35 local utility u=0.000000 metrics={'f1_val': 0.6920233076817062, 'auprc': 0.8998083823627947, 'loss_val': 0.6398959845120653, 'psi': 0.7751373375541416}-{'f1_val': 0.7218215223154317, 'auprc': 0.9125289606852425, 'loss_val': 0.6250412479322488, 'psi': 0.798104497663356}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=36 head_norm_before_train=1.561924 cos_to_last_merge=0.9479 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.948
[S2] round=36 local utility u=0.000000 metrics={'f1_val': 0.7056289619641114, 'auprc': 0.7546082389959647, 'loss_val': 0.6169468036420211, 'psi': 0.7252206727768528}-{'f1_val': 0.7088646219515463, 'auprc': 0.7508230578787866, 'loss_val': 0.5574515951472298, 'psi': 0.7256479963224425}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=36 head_norm_before_train=1.581902 cos_to_last_merge=0.9286 (last merge round=15)
[S3] ⚠️ Model drifted since last merge! cos=0.929
[S3] round=36 local utility u=0.000000 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.998319665783179, 'loss_val': 0.11667175395987074, 'psi': 0.9759490169765377}-{'f1_val': 0.9834363840689774, 'auprc': 0.9984273880461223, 'loss_val': 0.07365051956550057, 'psi': 0.9894327856598353}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=36 head_norm_before_train=1.454365 cos_to_last_merge=0.9329 (last merge round=14)
[S4] ⚠️ Model drifted since last merge! cos=0.933
[S4] round=36 local utility u=1.000000 metrics={'f1_val': 0.9403052691742566, 'auprc': 0.9679174692271554, 'loss_val': 0.2819537002647247, 'psi': 0.9513501491954162}-{'f1_val': 0.6493175329847165, 'auprc': 0.9017544541271951, 'loss_val': 0.5583082352269817, 'psi': 0.750292301441708}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=36 head_norm_before_train=1.433961 cos_to_last_merge=0.9179 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.918
[S5] round=36 local utility u=0.040112 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9951027166443073, 'loss_val': 0.2183659056010554, 'psi': 0.8182334457525383}-{'f1_val': 0.700320598491359, 'auprc': 0.9818531821353979, 'loss_val': 0.25884129991521837, 'psi': 0.8129336319489746}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=36 head_norm_before_train=1.547793 cos_to_last_merge=0.7298 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.730
[S6] round=36 local utility u=0.000000 metrics={'f1_val': 0.716223578986891, 'auprc': 0.9544041451799188, 'loss_val': 0.6576917268223905, 'psi': 0.8114958054641022}-{'f1_val': 0.9857451327559594, 'auprc': 0.9796549122622333, 'loss_val': 0.10813568078507055, 'psi': 0.983309044558469}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=36 head_norm_before_train=1.187176 cos_to_last_merge=0.8879 (last merge round=14)
[S7] ⚠️ Model drifted since last merge! cos=0.888
[S7] round=36 local utility u=0.000000 metrics={'f1_val': 0.5330781506362055, 'auprc': 0.7917732292645137, 'loss_val': 0.7358996029887392, 'psi': 0.6365561820875287}-{'f1_val': 0.6776725534712915, 'auprc': 0.8828682403807714, 'loss_val': 0.36550899782774315, 'psi': 0.7597508282350834}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=36 head_norm_before_train=1.771937 cos_to_last_merge=0.7806 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.781
[S8] round=36 local utility u=1.000000 metrics={'f1_val': 0.9716423136036185, 'auprc': 0.9954448642821156, 'loss_val': 0.06899120462208913, 'psi': 0.9811633338750173}-{'f1_val': 0.7061461739898125, 'auprc': 0.9742341851177092, 'loss_val': 0.43836296318680773, 'psi': 0.8133813784409711}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=36 head_norm_before_train=1.749825 cos_to_last_merge=0.7817 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.782
[S9] round=36 local utility u=0.007068 metrics={'f1_val': 0.9929348022347503, 'auprc': 0.9986159170784923, 'loss_val': 0.029808013406836746, 'psi': 0.9952072481722471}-{'f1_val': 0.9912441468948172, 'auprc': 0.9989926272333364, 'loss_val': 0.03493029879643802, 'psi': 0.9943435390302249}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=36 head_norm_before_train=1.581655 cos_to_last_merge=0.9602 (last merge round=16)
[S10] round=36 local utility u=0.000000 metrics={'f1_val': 0.929798341410297, 'auprc': 0.990789081314056, 'loss_val': 0.1750531530477234, 'psi': 0.9541946373718007}-{'f1_val': 0.9414970511217404, 'auprc': 0.9919949491231461, 'loss_val': 0.15961237727035182, 'psi': 0.9616962103223027}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=36 head_norm_before_train=1.624487 cos_to_last_merge=0.9404 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.940
[S11] round=36 local utility u=0.002403 metrics={'f1_val': 0.9963958538641108, 'auprc': 0.9975451218347107, 'loss_val': 0.03661283111560311, 'psi': 0.9968555610523508}-{'f1_val': 0.9961541414107454, 'auprc': 0.9980743835124056, 'loss_val': 0.041556978568341, 'psi': 0.9969222382514095}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=36 head_norm_before_train=1.256825 cos_to_last_merge=0.8121 (last merge round=11)
[S13] ⚠️ Model drifted since last merge! cos=0.812
[S13] round=36 local utility u=0.003385 metrics={'f1_val': 0.6181107877471215, 'auprc': 0.6835354393528701, 'loss_val': 0.6239654573819308, 'psi': 0.644280648389421}-{'f1_val': 0.6167106059520748, 'auprc': 0.6833605959781841, 'loss_val': 0.6218103719778773, 'psi': 0.6433706019625185}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=36 head_norm_before_train=1.803230 cos_to_last_merge=0.9752 (last merge round=13)
[S14] round=36 local utility u=0.000000 metrics={'f1_val': 0.9976291097282272, 'auprc': 0.999042597909765, 'loss_val': 0.01908291349889276, 'psi': 0.9981945050008423}-{'f1_val': 0.9976511180498535, 'auprc': 0.9990500673911656, 'loss_val': 0.019155421216953433, 'psi': 0.9982106977863784}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=36 head_norm_before_train=1.511415 cos_to_last_merge=0.9398 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.940
[S15] round=36 local utility u=0.000000 metrics={'f1_val': 0.8359223410526633, 'auprc': 0.9302045948976928, 'loss_val': 0.30900455419972633, 'psi': 0.873635242590675}-{'f1_val': 0.9825684596137341, 'auprc': 0.9725804527547064, 'loss_val': 0.10938451737815529, 'psi': 0.9785732568701231}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=36 head_norm_before_train=2.011357 (no previous merge yet)
[S16] round=36 local utility u=0.000000 metrics={'f1_val': 0.9824172027596022, 'auprc': 0.9950585382683803, 'loss_val': 0.0675128574510769, 'psi': 0.9874737369631135}-{'f1_val': 0.9917367584934558, 'auprc': 0.9937484502216124, 'loss_val': 0.055656856623241685, 'psi': 0.9925414351847184}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=36 head_norm_before_train=1.942778 (no previous merge yet)
[S17] round=36 local utility u=0.000000 metrics={'f1_val': 0.6841199469855284, 'auprc': 0.8816756986221368, 'loss_val': 0.7500058556450067, 'psi': 0.7631422476401717}-{'f1_val': 0.6920233076817062, 'auprc': 0.8998083823627947, 'loss_val': 0.6398959845120653, 'psi': 0.7751373375541416}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=37 head_norm_before_train=1.576729 cos_to_last_merge=0.9467 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.947
[S2] round=37 local utility u=0.000000 metrics={'f1_val': 0.6937631423035991, 'auprc': 0.742928326243872, 'loss_val': 0.6976488780475127, 'psi': 0.7134292158797082}-{'f1_val': 0.7056289619641114, 'auprc': 0.7546082389959647, 'loss_val': 0.6169468036420211, 'psi': 0.7252206727768528}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=37 head_norm_before_train=1.602494 cos_to_last_merge=0.9246 (last merge round=15)
[S3] ⚠️ Model drifted since last merge! cos=0.925
[S3] round=37 local utility u=0.148154 metrics={'f1_val': 0.9977814963782642, 'auprc': 0.998378122727021, 'loss_val': 0.041017198762745656, 'psi': 0.998020146917767}-{'f1_val': 0.9610352511054436, 'auprc': 0.998319665783179, 'loss_val': 0.11667175395987074, 'psi': 0.9759490169765377}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=37 head_norm_before_train=1.464855 cos_to_last_merge=0.9316 (last merge round=14)
[S4] ⚠️ Model drifted since last merge! cos=0.932
[S4] round=37 local utility u=0.014821 metrics={'f1_val': 0.9415863261840783, 'auprc': 0.9727356651008332, 'loss_val': 0.27445211762150534, 'psi': 0.9540460617507802}-{'f1_val': 0.9403052691742566, 'auprc': 0.9679174692271554, 'loss_val': 0.2819537002647247, 'psi': 0.9513501491954162}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] START round=37 head_norm_before_train=1.448399 cos_to_last_merge=0.9151 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.915
[S5] round=37 local utility u=0.000000 metrics={'f1_val': 0.6598531778964424, 'auprc': 0.786296296055932, 'loss_val': 0.5617598304244685, 'psi': 0.7104304251602382}-{'f1_val': 0.700320598491359, 'auprc': 0.9951027166443073, 'loss_val': 0.2183659056010554, 'psi': 0.8182334457525383}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=37 head_norm_before_train=1.556981 cos_to_last_merge=0.7285 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.728
[S6] round=37 local utility u=0.158805 metrics={'f1_val': 0.7635408677478857, 'auprc': 0.9443387081817423, 'loss_val': 0.5937889134263367, 'psi': 0.8358600039214283}-{'f1_val': 0.716223578986891, 'auprc': 0.9544041451799188, 'loss_val': 0.6576917268223905, 'psi': 0.8114958054641022}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=37 head_norm_before_train=1.198879 cos_to_last_merge=0.8843 (last merge round=14)
[S7] ⚠️ Model drifted since last merge! cos=0.884
[S7] round=37 local utility u=0.833976 metrics={'f1_val': 0.6841163025117286, 'auprc': 0.9209412557722846, 'loss_val': 0.36168153684026605, 'psi': 0.778846283815951}-{'f1_val': 0.5330781506362055, 'auprc': 0.7917732292645137, 'loss_val': 0.7358996029887392, 'psi': 0.6365561820875287}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=37 head_norm_before_train=1.773787 cos_to_last_merge=0.7795 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.779
[S8] round=37 local utility u=0.089577 metrics={'f1_val': 0.9937333839017813, 'auprc': 0.998983150971916, 'loss_val': 0.032998989437817844, 'psi': 0.9958332907298352}-{'f1_val': 0.9716423136036185, 'auprc': 0.9954448642821156, 'loss_val': 0.06899120462208913, 'psi': 0.9811633338750173}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] sending update (kind=head size=1804 to 1 peers)
[S9] START round=37 head_norm_before_train=1.761499 cos_to_last_merge=0.7804 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.780
[S9] round=37 local utility u=0.000000 metrics={'f1_val': 0.985286948729855, 'auprc': 0.9986166786518591, 'loss_val': 0.05404531846048209, 'psi': 0.9906188406986566}-{'f1_val': 0.9929348022347503, 'auprc': 0.9986159170784923, 'loss_val': 0.029808013406836746, 'psi': 0.9952072481722471}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=37 head_norm_before_train=1.597641 cos_to_last_merge=0.9585 (last merge round=16)
[S10] round=37 local utility u=0.056944 metrics={'f1_val': 0.9440176719030284, 'auprc': 0.9902957352617882, 'loss_val': 0.14500150581582366, 'psi': 0.9625288972465322}-{'f1_val': 0.929798341410297, 'auprc': 0.990789081314056, 'loss_val': 0.1750531530477234, 'psi': 0.9541946373718007}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=37 head_norm_before_train=1.635978 cos_to_last_merge=0.9389 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.939
[S11] round=37 local utility u=0.003310 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9982498801539695, 'loss_val': 0.03313742643704079, 'psi': 0.9972404344453161}-{'f1_val': 0.9963958538641108, 'auprc': 0.9975451218347107, 'loss_val': 0.03661283111560311, 'psi': 0.9968555610523508}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=37 head_norm_before_train=1.271004 cos_to_last_merge=0.8083 (last merge round=11)
[S13] ⚠️ Model drifted since last merge! cos=0.808
[S13] round=37 local utility u=0.101872 metrics={'f1_val': 0.6385915709865019, 'auprc': 0.6754219177625848, 'loss_val': 0.5187661655615331, 'psi': 0.6533237096969351}-{'f1_val': 0.6181107877471215, 'auprc': 0.6835354393528701, 'loss_val': 0.6239654573819308, 'psi': 0.644280648389421}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=37 head_norm_before_train=1.812311 cos_to_last_merge=0.9745 (last merge round=13)
[S14] round=37 local utility u=0.000000 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9988385092365155, 'loss_val': 0.019757426415988204, 'psi': 0.9981260745245184}-{'f1_val': 0.9976291097282272, 'auprc': 0.999042597909765, 'loss_val': 0.01908291349889276, 'psi': 0.9981945050008423}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=37 head_norm_before_train=1.526881 cos_to_last_merge=0.9383 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.938
[S15] round=37 local utility u=0.576707 metrics={'f1_val': 0.9633087205653771, 'auprc': 0.9903930361300736, 'loss_val': 0.10047324695698444, 'psi': 0.9741424467912557}-{'f1_val': 0.8359223410526633, 'auprc': 0.9302045948976928, 'loss_val': 0.30900455419972633, 'psi': 0.873635242590675}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=37 head_norm_before_train=2.018972 (no previous merge yet)
[S16] round=37 local utility u=0.000000 metrics={'f1_val': 0.9421956809067265, 'auprc': 0.991874882058303, 'loss_val': 0.1498350654686272, 'psi': 0.9620673613673572}-{'f1_val': 0.9824172027596022, 'auprc': 0.9950585382683803, 'loss_val': 0.0675128574510769, 'psi': 0.9874737369631135}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=37 head_norm_before_train=1.954162 (no previous merge yet)
[S17] round=37 local utility u=0.740483 metrics={'f1_val': 0.8504572593020163, 'auprc': 0.9008996372270837, 'loss_val': 0.3247362213611414, 'psi': 0.8706342104720433}-{'f1_val': 0.6841199469855284, 'auprc': 0.8816756986221368, 'loss_val': 0.7500058556450067, 'psi': 0.7631422476401717}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] START round=38 head_norm_before_train=1.592826 cos_to_last_merge=0.9453 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.945
[S2] round=38 local utility u=0.000000 metrics={'f1_val': 0.7039216053701959, 'auprc': 0.7359993200514097, 'loss_val': 0.7530171617159047, 'psi': 0.7167526912426814}-{'f1_val': 0.6937631423035991, 'auprc': 0.742928326243872, 'loss_val': 0.6976488780475127, 'psi': 0.7134292158797082}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=38 head_norm_before_train=1.621433 cos_to_last_merge=0.9210 (last merge round=15)
[S3] ⚠️ Model drifted since last merge! cos=0.921
[S3] round=38 local utility u=0.000803 metrics={'f1_val': 0.9973696976584205, 'auprc': 0.9984224257234642, 'loss_val': 0.03707325506032376, 'psi': 0.997790788884438}-{'f1_val': 0.9977814963782642, 'auprc': 0.998378122727021, 'loss_val': 0.041017198762745656, 'psi': 0.998020146917767}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=38 head_norm_before_train=1.478156 cos_to_last_merge=0.9299 (last merge round=14)
[S4] ⚠️ Model drifted since last merge! cos=0.930
[S4] round=38 local utility u=0.000000 metrics={'f1_val': 0.7842597134292746, 'auprc': 0.9372259644171541, 'loss_val': 0.4403930288657809, 'psi': 0.8454462138244264}-{'f1_val': 0.9415863261840783, 'auprc': 0.9727356651008332, 'loss_val': 0.27445211762150534, 'psi': 0.9540460617507802}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=38 head_norm_before_train=1.461907 cos_to_last_merge=0.9133 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.913
[S5] round=38 local utility u=0.598582 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9902999784872486, 'loss_val': 0.21941619540349014, 'psi': 0.8163127818552477}-{'f1_val': 0.6598531778964424, 'auprc': 0.786296296055932, 'loss_val': 0.5617598304244685, 'psi': 0.7104304251602382}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=38 head_norm_before_train=1.565240 cos_to_last_merge=0.7273 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.727
[S6] round=38 local utility u=0.000000 metrics={'f1_val': 0.7641717582640419, 'auprc': 0.9403759489428947, 'loss_val': 0.6600332906861562, 'psi': 0.834653434535583}-{'f1_val': 0.7635408677478857, 'auprc': 0.9443387081817423, 'loss_val': 0.5937889134263367, 'psi': 0.8358600039214283}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=38 head_norm_before_train=1.209468 cos_to_last_merge=0.8821 (last merge round=14)
[S7] ⚠️ Model drifted since last merge! cos=0.882
[S7] round=38 local utility u=0.000000 metrics={'f1_val': 0.5187313295352222, 'auprc': 0.7871295937424196, 'loss_val': 0.7883679183679663, 'psi': 0.6260906352181012}-{'f1_val': 0.6841163025117286, 'auprc': 0.9209412557722846, 'loss_val': 0.36168153684026605, 'psi': 0.778846283815951}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=38 head_norm_before_train=1.775498 cos_to_last_merge=0.7791 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.779
[S8] round=38 local utility u=0.004142 metrics={'f1_val': 0.994792642153961, 'auprc': 0.9992307980279825, 'loss_val': 0.03181301776321871, 'psi': 0.9965679045035696}-{'f1_val': 0.9937333839017813, 'auprc': 0.998983150971916, 'loss_val': 0.032998989437817844, 'psi': 0.9958332907298352}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=38 head_norm_before_train=1.773002 cos_to_last_merge=0.7793 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.779
[S9] round=38 local utility u=0.049836 metrics={'f1_val': 0.9967327663123822, 'auprc': 0.9986195779709529, 'loss_val': 0.023057350860433905, 'psi': 0.9974874909758105}-{'f1_val': 0.985286948729855, 'auprc': 0.9986166786518591, 'loss_val': 0.05404531846048209, 'psi': 0.9906188406986566}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=38 head_norm_before_train=1.611714 cos_to_last_merge=0.9568 (last merge round=16)
[S10] round=38 local utility u=0.185722 metrics={'f1_val': 0.9932136491405474, 'auprc': 0.9921918963121961, 'loss_val': 0.07442233411867853, 'psi': 0.9928049480092069}-{'f1_val': 0.9440176719030284, 'auprc': 0.9902957352617882, 'loss_val': 0.14500150581582366, 'psi': 0.9625288972465322}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=38 head_norm_before_train=1.649136 cos_to_last_merge=0.9371 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.937
[S11] round=38 local utility u=0.001000 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9982185298867043, 'loss_val': 0.03104380479636302, 'psi': 0.99722789433841}-{'f1_val': 0.996567470639547, 'auprc': 0.9982498801539695, 'loss_val': 0.03313742643704079, 'psi': 0.9972404344453161}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] sending update (kind=head size=1803 to 1 peers)
[S13] START round=38 head_norm_before_train=1.284236 cos_to_last_merge=0.8045 (last merge round=11)
[S13] ⚠️ Model drifted since last merge! cos=0.805
[S13] round=38 local utility u=0.000000 metrics={'f1_val': 0.6168979130160884, 'auprc': 0.6767832524615032, 'loss_val': 0.67491040578324, 'psi': 0.6408520487942544}-{'f1_val': 0.6385915709865019, 'auprc': 0.6754219177625848, 'loss_val': 0.5187661655615331, 'psi': 0.6533237096969351}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=38 head_norm_before_train=1.821100 cos_to_last_merge=0.9739 (last merge round=13)
[S14] round=38 local utility u=0.000000 metrics={'f1_val': 0.9309444101570085, 'auprc': 0.9990417316320387, 'loss_val': 0.18909541562310858, 'psi': 0.9581833387470206}-{'f1_val': 0.9976511180498535, 'auprc': 0.9988385092365155, 'loss_val': 0.019757426415988204, 'psi': 0.9981260745245184}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=38 head_norm_before_train=1.542712 cos_to_last_merge=0.9367 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.937
[S15] round=38 local utility u=0.000000 metrics={'f1_val': 0.6977852558971749, 'auprc': 0.8854198250545571, 'loss_val': 0.5183679515203612, 'psi': 0.7728390835601278}-{'f1_val': 0.9633087205653771, 'auprc': 0.9903930361300736, 'loss_val': 0.10047324695698444, 'psi': 0.9741424467912557}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=38 head_norm_before_train=2.024941 (no previous merge yet)
[S16] round=38 local utility u=0.000000 metrics={'f1_val': 0.9407539078103828, 'auprc': 0.9912066055470439, 'loss_val': 0.18102344409119278, 'psi': 0.9609349869050472}-{'f1_val': 0.9421956809067265, 'auprc': 0.991874882058303, 'loss_val': 0.1498350654686272, 'psi': 0.9620673613673572}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=38 head_norm_before_train=1.964565 (no previous merge yet)
[S17] round=38 local utility u=0.000000 metrics={'f1_val': 0.6857930263797887, 'auprc': 0.8980293678602331, 'loss_val': 0.7735971189110024, 'psi': 0.7706875629719665}-{'f1_val': 0.8504572593020163, 'auprc': 0.9008996372270837, 'loss_val': 0.3247362213611414, 'psi': 0.8706342104720433}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=39 head_norm_before_train=1.604986 cos_to_last_merge=0.9441 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.944
[S2] round=39 local utility u=0.000000 metrics={'f1_val': 0.6759017207721951, 'auprc': 0.7350753193775745, 'loss_val': 0.8970023888710104, 'psi': 0.6995711602143468}-{'f1_val': 0.7039216053701959, 'auprc': 0.7359993200514097, 'loss_val': 0.7530171617159047, 'psi': 0.7167526912426814}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=40 psi=0.700 u=0.0000 p_local=0.0141 f1=0.676 auprc=0.735 bytes=37774
[S3] START round=39 head_norm_before_train=1.638949 cos_to_last_merge=0.9179 (last merge round=15)
[S3] ⚠️ Model drifted since last merge! cos=0.918
[S3] round=39 local utility u=0.000000 metrics={'f1_val': 0.987695488604234, 'auprc': 0.9984710482704418, 'loss_val': 0.04310422543358544, 'psi': 0.992005712470717}-{'f1_val': 0.9973696976584205, 'auprc': 0.9984224257234642, 'loss_val': 0.03707325506032376, 'psi': 0.997790788884438}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=40 psi=0.992 u=0.0000 p_local=0.0545 f1=0.988 auprc=0.998 bytes=44971
[S4] START round=39 head_norm_before_train=1.492093 cos_to_last_merge=0.9281 (last merge round=14)
[S4] ⚠️ Model drifted since last merge! cos=0.928
[S4] round=39 local utility u=0.582870 metrics={'f1_val': 0.938947903860369, 'auprc': 0.9648714971377794, 'loss_val': 0.2857195699130715, 'psi': 0.9493173411713332}-{'f1_val': 0.7842597134292746, 'auprc': 0.9372259644171541, 'loss_val': 0.4403930288657809, 'psi': 0.8454462138244264}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S4] r=40 psi=0.949 u=0.5829 p_local=0.2578 f1=0.939 auprc=0.965 bytes=46777
[S5] START round=39 head_norm_before_train=1.470959 cos_to_last_merge=0.9121 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.912
[S5] round=39 local utility u=0.000000 metrics={'f1_val': 0.677270976686797, 'auprc': 0.7875209296763144, 'loss_val': 0.47856017707879334, 'psi': 0.721370957882604}-{'f1_val': 0.7003213174339138, 'auprc': 0.9902999784872486, 'loss_val': 0.21941619540349014, 'psi': 0.8163127818552477}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=40 psi=0.721 u=0.0000 p_local=0.1231 f1=0.677 auprc=0.788 bytes=43170
[S6] START round=39 head_norm_before_train=1.575150 cos_to_last_merge=0.7258 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.726
[S6] round=39 local utility u=0.166057 metrics={'f1_val': 0.7923007973235916, 'auprc': 0.9520737859703067, 'loss_val': 0.5317863455461702, 'psi': 0.8562099927822776}-{'f1_val': 0.7641717582640419, 'auprc': 0.9403759489428947, 'loss_val': 0.6600332906861562, 'psi': 0.834653434535583}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S6] r=40 psi=0.856 u=0.1661 p_local=0.2314 f1=0.792 auprc=0.952 bytes=43230
[S7] START round=39 head_norm_before_train=1.219270 cos_to_last_merge=0.8807 (last merge round=14)
[S7] ⚠️ Model drifted since last merge! cos=0.881
[S7] round=39 local utility u=0.826259 metrics={'f1_val': 0.6790664793771416, 'auprc': 0.8735656759508112, 'loss_val': 0.35716834079949017, 'psi': 0.7568661580066095}-{'f1_val': 0.5187313295352222, 'auprc': 0.7871295937424196, 'loss_val': 0.7883679183679663, 'psi': 0.6260906352181012}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S7] r=40 psi=0.757 u=0.8263 p_local=0.4092 f1=0.679 auprc=0.874 bytes=43175
[S8] START round=39 head_norm_before_train=1.782776 cos_to_last_merge=0.7781 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.778
[S8] round=39 local utility u=0.000000 metrics={'f1_val': 0.9928159069878363, 'auprc': 0.9988408706687137, 'loss_val': 0.0331470596937354, 'psi': 0.9952258924601872}-{'f1_val': 0.994792642153961, 'auprc': 0.9992307980279825, 'loss_val': 0.03181301776321871, 'psi': 0.9965679045035696}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] r=40 psi=0.995 u=0.0000 p_local=0.1594 f1=0.993 auprc=0.999 bytes=46764
[S9] START round=39 head_norm_before_train=1.781391 cos_to_last_merge=0.7783 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.778
[S9] round=39 local utility u=0.000000 metrics={'f1_val': 0.9874269136456545, 'auprc': 0.9985205914825738, 'loss_val': 0.04724277017568324, 'psi': 0.9918643847804223}-{'f1_val': 0.9967327663123822, 'auprc': 0.9986195779709529, 'loss_val': 0.023057350860433905, 'psi': 0.9974874909758105}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=40 psi=0.992 u=0.0000 p_local=0.0194 f1=0.987 auprc=0.999 bytes=50253
[S10] START round=39 head_norm_before_train=1.621402 cos_to_last_merge=0.9559 (last merge round=16)
[S10] round=39 local utility u=0.007643 metrics={'f1_val': 0.9931299445855843, 'auprc': 0.9937210518426479, 'loss_val': 0.06322090542263217, 'psi': 0.9933663874884098}-{'f1_val': 0.9932136491405474, 'auprc': 0.9921918963121961, 'loss_val': 0.07442233411867853, 'psi': 0.9928049480092069}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] sending update (kind=head size=1794 to 1 peers)
[S10] r=40 psi=0.993 u=0.0076 p_local=0.0475 f1=0.993 auprc=0.994 bytes=50331
[S11] START round=39 head_norm_before_train=1.663116 cos_to_last_merge=0.9351 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.935
[S11] round=39 local utility u=0.002091 metrics={'f1_val': 0.9968091830929121, 'auprc': 0.9981467499146668, 'loss_val': 0.02809696799479204, 'psi': 0.997344209821614}-{'f1_val': 0.996567470639547, 'auprc': 0.9982185298867043, 'loss_val': 0.03104380479636302, 'psi': 0.99722789433841}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S11] r=40 psi=0.997 u=0.0021 p_local=0.0074 f1=0.997 auprc=0.998 bytes=52173
[S13] START round=39 head_norm_before_train=1.292772 cos_to_last_merge=0.8021 (last merge round=11)
[S13] ⚠️ Model drifted since last merge! cos=0.802
[S13] round=39 local utility u=0.145556 metrics={'f1_val': 0.643298463915748, 'auprc': 0.6688489049043272, 'loss_val': 0.5183978934937238, 'psi': 0.6535186403111797}-{'f1_val': 0.6168979130160884, 'auprc': 0.6767832524615032, 'loss_val': 0.67491040578324, 'psi': 0.6408520487942544}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S13] r=40 psi=0.654 u=0.1456 p_local=0.0727 f1=0.643 auprc=0.669 bytes=32334
[S14] START round=39 head_norm_before_train=1.832528 cos_to_last_merge=0.9733 (last merge round=13)
[S14] round=39 local utility u=0.285773 metrics={'f1_val': 0.9980623665153463, 'auprc': 0.9986741609684093, 'loss_val': 0.019154639288234084, 'psi': 0.9983070842965716}-{'f1_val': 0.9309444101570085, 'auprc': 0.9990417316320387, 'loss_val': 0.18909541562310858, 'psi': 0.9581833387470206}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S14] r=40 psi=0.998 u=0.2858 p_local=0.0591 f1=0.998 auprc=0.999 bytes=48505
[S15] START round=39 head_norm_before_train=1.556063 cos_to_last_merge=0.9353 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.935
[S15] round=39 local utility u=0.985171 metrics={'f1_val': 0.9225821694779013, 'auprc': 0.9737142964015045, 'loss_val': 0.16168985122042207, 'psi': 0.9430350202473425}-{'f1_val': 0.6977852558971749, 'auprc': 0.8854198250545571, 'loss_val': 0.5183679515203612, 'psi': 0.7728390835601278}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S15] r=40 psi=0.943 u=0.9852 p_local=0.4230 f1=0.923 auprc=0.974 bytes=46750
[S16] START round=39 head_norm_before_train=2.033461 (no previous merge yet)
[S16] round=39 local utility u=0.000000 metrics={'f1_val': 0.939321436319291, 'auprc': 0.9938581613500512, 'loss_val': 0.22684337012955505, 'psi': 0.9611361263315951}-{'f1_val': 0.9407539078103828, 'auprc': 0.9912066055470439, 'loss_val': 0.18102344409119278, 'psi': 0.9609349869050472}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] r=40 psi=0.961 u=0.0000 p_local=0.0575 f1=0.939 auprc=0.994 bytes=30592
[S17] START round=39 head_norm_before_train=1.973841 (no previous merge yet)
[S17] round=39 local utility u=0.425436 metrics={'f1_val': 0.7395604614292294, 'auprc': 0.959053383386292, 'loss_val': 0.42840138936153876, 'psi': 0.8273576302120544}-{'f1_val': 0.6857930263797887, 'auprc': 0.8980293678602331, 'loss_val': 0.7735971189110024, 'psi': 0.7706875629719665}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[S17] r=40 psi=0.827 u=0.4254 p_local=0.2773 f1=0.740 auprc=0.959 bytes=43181
[S2] START round=40 head_norm_before_train=1.615357 cos_to_last_merge=0.9431 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.943
[S2] round=40 local utility u=0.046031 metrics={'f1_val': 0.6944700735639744, 'auprc': 0.7255535136900326, 'loss_val': 0.8877858014970752, 'psi': 0.7069034496143977}-{'f1_val': 0.6759017207721951, 'auprc': 0.7350753193775745, 'loss_val': 0.8970023888710104, 'psi': 0.6995711602143468}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[S3] START round=40 head_norm_before_train=1.655541 cos_to_last_merge=0.9152 (last merge round=15)
[S3] ⚠️ Model drifted since last merge! cos=0.915
[S3] round=40 local utility u=0.000000 metrics={'f1_val': 0.9816369354330233, 'auprc': 0.9983396676247813, 'loss_val': 0.05755071310778181, 'psi': 0.9883180283097265}-{'f1_val': 0.987695488604234, 'auprc': 0.9984710482704418, 'loss_val': 0.04310422543358544, 'psi': 0.992005712470717}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=40 head_norm_before_train=1.503604 cos_to_last_merge=0.9267 (last merge round=14)
[S4] ⚠️ Model drifted since last merge! cos=0.927
[S4] round=40 local utility u=0.039585 metrics={'f1_val': 0.9422655113053029, 'auprc': 0.9797847959842233, 'loss_val': 0.2711952232568196, 'psi': 0.957273225176871}-{'f1_val': 0.938947903860369, 'auprc': 0.9648714971377794, 'loss_val': 0.2857195699130715, 'psi': 0.9493173411713332}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=40 head_norm_before_train=1.478933 cos_to_last_merge=0.9110 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.911
[S5] round=40 local utility u=0.504938 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9899088734649151, 'loss_val': 0.21415000200859793, 'psi': 0.8161563398463143}-{'f1_val': 0.677270976686797, 'auprc': 0.7875209296763144, 'loss_val': 0.47856017707879334, 'psi': 0.721370957882604}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=40 head_norm_before_train=1.587321 cos_to_last_merge=0.7239 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.724
[S6] round=40 local utility u=0.040453 metrics={'f1_val': 0.7830928403754952, 'auprc': 0.9818356364846499, 'loss_val': 0.484917297709354, 'psi': 0.862589958819157}-{'f1_val': 0.7923007973235916, 'auprc': 0.9520737859703067, 'loss_val': 0.5317863455461702, 'psi': 0.8562099927822776}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S6] sending update (kind=head size=1808 to 1 peers)
[S7] START round=40 head_norm_before_train=1.228842 cos_to_last_merge=0.8798 (last merge round=14)
[S7] ⚠️ Model drifted since last merge! cos=0.880
[S7] round=40 local utility u=0.000000 metrics={'f1_val': 0.46964863815586966, 'auprc': 0.7827356045212894, 'loss_val': 1.0427459078725942, 'psi': 0.5948834247020376}-{'f1_val': 0.6790664793771416, 'auprc': 0.8735656759508112, 'loss_val': 0.35716834079949017, 'psi': 0.7568661580066095}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=40 head_norm_before_train=1.791543 cos_to_last_merge=0.7771 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.777
[S8] round=40 local utility u=0.000000 metrics={'f1_val': 0.9871370762874481, 'auprc': 0.9950274315141078, 'loss_val': 0.045442024241729675, 'psi': 0.9902932183781119}-{'f1_val': 0.9928159069878363, 'auprc': 0.9988408706687137, 'loss_val': 0.0331470596937354, 'psi': 0.9952258924601872}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=40 head_norm_before_train=1.789866 cos_to_last_merge=0.7774 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.777
[S9] round=40 local utility u=0.040346 metrics={'f1_val': 0.9967327663123822, 'auprc': 0.9985343342923592, 'loss_val': 0.02242717197057679, 'psi': 0.9974533935043729}-{'f1_val': 0.9874269136456545, 'auprc': 0.9985205914825738, 'loss_val': 0.04724277017568324, 'psi': 0.9918643847804223}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=40 head_norm_before_train=1.631001 cos_to_last_merge=0.9550 (last merge round=16)
[S10] round=40 local utility u=0.004364 metrics={'f1_val': 0.9935523847669312, 'auprc': 0.9951427080839002, 'loss_val': 0.061293104750993296, 'psi': 0.9941885140937188}-{'f1_val': 0.9931299445855843, 'auprc': 0.9937210518426479, 'loss_val': 0.06322090542263217, 'psi': 0.9933663874884098}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=40 head_norm_before_train=1.676994 cos_to_last_merge=0.9332 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.933
[S11] round=40 local utility u=0.000000 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9985274489328, 'loss_val': 0.028724427925487222, 'psi': 0.9973514619568482}-{'f1_val': 0.9968091830929121, 'auprc': 0.9981467499146668, 'loss_val': 0.02809696799479204, 'psi': 0.997344209821614}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=40 head_norm_before_train=1.301895 cos_to_last_merge=0.7995 (last merge round=11)
[S13] ⚠️ Model drifted since last merge! cos=0.800
[S13] round=40 local utility u=0.000000 metrics={'f1_val': 0.6106006121460359, 'auprc': 0.6846537424665715, 'loss_val': 0.7063907304749037, 'psi': 0.6402218642742501}-{'f1_val': 0.643298463915748, 'auprc': 0.6688489049043272, 'loss_val': 0.5183978934937238, 'psi': 0.6535186403111797}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=40 head_norm_before_train=1.842509 cos_to_last_merge=0.9727 (last merge round=13)
[S14] round=40 local utility u=0.000000 metrics={'f1_val': 0.9970007132142444, 'auprc': 0.9989657119049129, 'loss_val': 0.02112517694137888, 'psi': 0.9977867126905118}-{'f1_val': 0.9980623665153463, 'auprc': 0.9986741609684093, 'loss_val': 0.019154639288234084, 'psi': 0.9983070842965716}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=40 head_norm_before_train=1.568124 cos_to_last_merge=0.9342 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.934
[S15] round=40 local utility u=0.000000 metrics={'f1_val': 0.7004156152843362, 'auprc': 0.7700718822734685, 'loss_val': 0.5287914543307953, 'psi': 0.7282781220799891}-{'f1_val': 0.9225821694779013, 'auprc': 0.9737142964015045, 'loss_val': 0.16168985122042207, 'psi': 0.9430350202473425}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=40 head_norm_before_train=2.040276 (no previous merge yet)
[S16] round=40 local utility u=0.000000 metrics={'f1_val': 0.8525460762459024, 'auprc': 0.9806480169717302, 'loss_val': 0.7910045355916993, 'psi': 0.9037868525362335}-{'f1_val': 0.939321436319291, 'auprc': 0.9938581613500512, 'loss_val': 0.22684337012955505, 'psi': 0.9611361263315951}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=40 head_norm_before_train=1.983980 (no previous merge yet)
[S17] round=40 local utility u=0.000000 metrics={'f1_val': 0.690580178307183, 'auprc': 0.8920674969391414, 'loss_val': 0.7323575194409417, 'psi': 0.7711751057599664}-{'f1_val': 0.7395604614292294, 'auprc': 0.959053383386292, 'loss_val': 0.42840138936153876, 'psi': 0.8273576302120544}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=41 head_norm_before_train=1.623197 cos_to_last_merge=0.9423 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.942
[S2] round=41 local utility u=0.019397 metrics={'f1_val': 0.7024587700087224, 'auprc': 0.7213807132627532, 'loss_val': 0.8844051669248697, 'psi': 0.7100275473103347}-{'f1_val': 0.6944700735639744, 'auprc': 0.7255535136900326, 'loss_val': 0.8877858014970752, 'psi': 0.7069034496143977}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=41 head_norm_before_train=1.670370 cos_to_last_merge=0.9128 (last merge round=15)
[S3] ⚠️ Model drifted since last merge! cos=0.913
[S3] round=41 local utility u=0.021410 metrics={'f1_val': 0.9864135609663514, 'auprc': 0.9984063279580415, 'loss_val': 0.04359091497457619, 'psi': 0.9912106677630275}-{'f1_val': 0.9816369354330233, 'auprc': 0.9983396676247813, 'loss_val': 0.05755071310778181, 'psi': 0.9883180283097265}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] sending update (kind=head size=1804 to 1 peers)
[S4] START round=41 head_norm_before_train=1.516716 cos_to_last_merge=0.9249 (last merge round=14)
[S4] ⚠️ Model drifted since last merge! cos=0.925
[S4] round=41 local utility u=0.000000 metrics={'f1_val': 0.9387667347482254, 'auprc': 0.9659274128488213, 'loss_val': 0.28416374848596404, 'psi': 0.9496310059884638}-{'f1_val': 0.9422655113053029, 'auprc': 0.9797847959842233, 'loss_val': 0.2711952232568196, 'psi': 0.957273225176871}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=41 head_norm_before_train=1.483642 cos_to_last_merge=0.9104 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.910
[S5] round=41 local utility u=0.000000 metrics={'f1_val': 0.6878160739033496, 'auprc': 0.8658185149077894, 'loss_val': 0.3759839930553524, 'psi': 0.7590170503051256}-{'f1_val': 0.7003213174339138, 'auprc': 0.9899088734649151, 'loss_val': 0.21415000200859793, 'psi': 0.8161563398463143}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=41 head_norm_before_train=1.602708 cos_to_last_merge=0.7219 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.722
[S6] round=41 local utility u=0.000000 metrics={'f1_val': 0.6512123246085373, 'auprc': 0.962772120678533, 'loss_val': 0.7541456626640325, 'psi': 0.7758362430365355}-{'f1_val': 0.7830928403754952, 'auprc': 0.9818356364846499, 'loss_val': 0.484917297709354, 'psi': 0.862589958819157}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=41 head_norm_before_train=1.238637 cos_to_last_merge=0.8787 (last merge round=14)
[S7] ⚠️ Model drifted since last merge! cos=0.879
[S7] round=41 local utility u=1.000000 metrics={'f1_val': 0.6895122073693676, 'auprc': 0.8812252168524701, 'loss_val': 0.34997172294504825, 'psi': 0.7661974111626086}-{'f1_val': 0.46964863815586966, 'auprc': 0.7827356045212894, 'loss_val': 1.0427459078725942, 'psi': 0.5948834247020376}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] sending update (kind=head size=1796 to 1 peers)
[S8] START round=41 head_norm_before_train=1.798672 cos_to_last_merge=0.7771 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.777
[S8] round=41 local utility u=0.034591 metrics={'f1_val': 0.9944672019690619, 'auprc': 0.9987358789760837, 'loss_val': 0.031365689364815715, 'psi': 0.9961746727718706}-{'f1_val': 0.9871370762874481, 'auprc': 0.9950274315141078, 'loss_val': 0.045442024241729675, 'psi': 0.9902932183781119}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=41 head_norm_before_train=1.798918 cos_to_last_merge=0.7765 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.777
[S9] round=41 local utility u=0.000044 metrics={'f1_val': 0.9967327663123822, 'auprc': 0.9985375234263272, 'loss_val': 0.02234822857003664, 'psi': 0.9974546691579601}-{'f1_val': 0.9967327663123822, 'auprc': 0.9985343342923592, 'loss_val': 0.02242717197057679, 'psi': 0.9974533935043729}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=41 head_norm_before_train=1.644014 cos_to_last_merge=0.9538 (last merge round=16)
[S10] round=41 local utility u=0.000000 metrics={'f1_val': 0.9936518403636662, 'auprc': 0.9937648148730436, 'loss_val': 0.06371841017400118, 'psi': 0.9936970301674171}-{'f1_val': 0.9935523847669312, 'auprc': 0.9951427080839002, 'loss_val': 0.061293104750993296, 'psi': 0.9941885140937188}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=41 head_norm_before_train=1.688599 cos_to_last_merge=0.9315 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.932
[S11] round=41 local utility u=0.000000 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9983160033208961, 'loss_val': 0.02816017906067453, 'psi': 0.9972668837120866}-{'f1_val': 0.996567470639547, 'auprc': 0.9985274489328, 'loss_val': 0.028724427925487222, 'psi': 0.9973514619568482}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=41 head_norm_before_train=1.308253 cos_to_last_merge=0.7974 (last merge round=11)
[S13] ⚠️ Model drifted since last merge! cos=0.797
[S13] round=41 local utility u=0.000000 metrics={'f1_val': 0.6053506888856504, 'auprc': 0.6691590813924928, 'loss_val': 0.7559707186143945, 'psi': 0.6308740458883874}-{'f1_val': 0.6106006121460359, 'auprc': 0.6846537424665715, 'loss_val': 0.7063907304749037, 'psi': 0.6402218642742501}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=41 head_norm_before_train=1.850965 cos_to_last_merge=0.9722 (last merge round=13)
[S14] round=41 local utility u=0.000000 metrics={'f1_val': 0.9970007132142444, 'auprc': 0.998967356687511, 'loss_val': 0.021628856897989865, 'psi': 0.9977873706035512}-{'f1_val': 0.9970007132142444, 'auprc': 0.9989657119049129, 'loss_val': 0.02112517694137888, 'psi': 0.9977867126905118}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=41 head_norm_before_train=1.580557 cos_to_last_merge=0.9330 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.933
[S15] round=41 local utility u=1.000000 metrics={'f1_val': 0.9948320382357905, 'auprc': 0.9911324399297659, 'loss_val': 0.04568701798549902, 'psi': 0.9933521989133807}-{'f1_val': 0.7004156152843362, 'auprc': 0.7700718822734685, 'loss_val': 0.5287914543307953, 'psi': 0.7282781220799891}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=41 head_norm_before_train=2.046874 (no previous merge yet)
[S16] round=41 local utility u=0.000000 metrics={'f1_val': 0.8491799057973364, 'auprc': 0.9864489291430443, 'loss_val': 0.8318468135982067, 'psi': 0.9040875151356196}-{'f1_val': 0.8525460762459024, 'auprc': 0.9806480169717302, 'loss_val': 0.7910045355916993, 'psi': 0.9037868525362335}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=41 head_norm_before_train=1.995374 (no previous merge yet)
[S17] round=41 local utility u=0.714419 metrics={'f1_val': 0.8519440740066285, 'auprc': 0.9105022583889928, 'loss_val': 0.32700729625807035, 'psi': 0.8753673477595743}-{'f1_val': 0.690580178307183, 'auprc': 0.8920674969391414, 'loss_val': 0.7323575194409417, 'psi': 0.7711751057599664}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=42 head_norm_before_train=1.632252 cos_to_last_merge=0.9414 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.941
[S2] round=42 local utility u=0.000000 metrics={'f1_val': 0.6776039366798459, 'auprc': 0.717340288487776, 'loss_val': 0.9379268356741467, 'psi': 0.693498477403018}-{'f1_val': 0.7024587700087224, 'auprc': 0.7213807132627532, 'loss_val': 0.8844051669248697, 'psi': 0.7100275473103347}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=42 head_norm_before_train=1.683529 cos_to_last_merge=0.9106 (last merge round=15)
[S3] ⚠️ Model drifted since last merge! cos=0.911
[S3] round=42 local utility u=0.000000 metrics={'f1_val': 0.9558881670698338, 'auprc': 0.9983185744487103, 'loss_val': 0.1423511561183751, 'psi': 0.9728603300213845}-{'f1_val': 0.9864135609663514, 'auprc': 0.9984063279580415, 'loss_val': 0.04359091497457619, 'psi': 0.9912106677630275}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=42 head_norm_before_train=1.527264 cos_to_last_merge=0.9234 (last merge round=14)
[S4] ⚠️ Model drifted since last merge! cos=0.923
[S4] round=42 local utility u=0.016969 metrics={'f1_val': 0.9429806419935797, 'auprc': 0.964061031510916, 'loss_val': 0.26991017286136987, 'psi': 0.9514127978005142}-{'f1_val': 0.9387667347482254, 'auprc': 0.9659274128488213, 'loss_val': 0.28416374848596404, 'psi': 0.9496310059884638}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=42 head_norm_before_train=1.487123 cos_to_last_merge=0.9101 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.910
[S5] round=42 local utility u=0.047704 metrics={'f1_val': 0.6750678059155606, 'auprc': 0.9142439061607459, 'loss_val': 0.34936263349460284, 'psi': 0.7707382460136347}-{'f1_val': 0.6878160739033496, 'auprc': 0.8658185149077894, 'loss_val': 0.3759839930553524, 'psi': 0.7590170503051256}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S5] sending update (kind=head size=1807 to 1 peers)
[S6] START round=42 head_norm_before_train=1.621795 cos_to_last_merge=0.7192 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.719
[S6] round=42 local utility u=0.801219 metrics={'f1_val': 0.8523682059837404, 'auprc': 0.9712651454953685, 'loss_val': 0.3841225065827113, 'psi': 0.8999269817883917}-{'f1_val': 0.6512123246085373, 'auprc': 0.962772120678533, 'loss_val': 0.7541456626640325, 'psi': 0.7758362430365355}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] sending update (kind=head size=1804 to 1 peers)
[S7] START round=42 head_norm_before_train=1.246086 cos_to_last_merge=0.8777 (last merge round=14)
[S7] ⚠️ Model drifted since last merge! cos=0.878
[S7] round=42 local utility u=0.000000 metrics={'f1_val': 0.5194745083371732, 'auprc': 0.7820659437049018, 'loss_val': 0.8633307045583263, 'psi': 0.6245110824842647}-{'f1_val': 0.6895122073693676, 'auprc': 0.8812252168524701, 'loss_val': 0.34997172294504825, 'psi': 0.7661974111626086}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=42 head_norm_before_train=1.807519 cos_to_last_merge=0.7773 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.777
[S8] round=42 local utility u=0.000000 metrics={'f1_val': 0.9936910743895857, 'auprc': 0.9987945560681948, 'loss_val': 0.031226957316693185, 'psi': 0.9957324670610294}-{'f1_val': 0.9944672019690619, 'auprc': 0.9987358789760837, 'loss_val': 0.031365689364815715, 'psi': 0.9961746727718706}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=42 head_norm_before_train=1.807459 cos_to_last_merge=0.7758 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.776
[S9] round=42 local utility u=0.000199 metrics={'f1_val': 0.9967327663123822, 'auprc': 0.9985384662815053, 'loss_val': 0.021953236890537384, 'psi': 0.9974550463000313}-{'f1_val': 0.9967327663123822, 'auprc': 0.9985375234263272, 'loss_val': 0.02234822857003664, 'psi': 0.9974546691579601}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=42 head_norm_before_train=1.658078 cos_to_last_merge=0.9525 (last merge round=16)
[S10] round=42 local utility u=0.000000 metrics={'f1_val': 0.9145098759911409, 'auprc': 0.99035371798357, 'loss_val': 0.2026233270673041, 'psi': 0.9448474127881125}-{'f1_val': 0.9936518403636662, 'auprc': 0.9937648148730436, 'loss_val': 0.06371841017400118, 'psi': 0.9936970301674171}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=42 head_norm_before_train=1.700029 cos_to_last_merge=0.9299 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.930
[S11] round=42 local utility u=0.000049 metrics={'f1_val': 0.9963958538641108, 'auprc': 0.9981853568307117, 'loss_val': 0.026640991297734076, 'psi': 0.9971116550507513}-{'f1_val': 0.996567470639547, 'auprc': 0.9983160033208961, 'loss_val': 0.02816017906067453, 'psi': 0.9972668837120866}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=42 head_norm_before_train=1.319236 cos_to_last_merge=0.7949 (last merge round=11)
[S13] ⚠️ Model drifted since last merge! cos=0.795
[S13] round=42 local utility u=0.068079 metrics={'f1_val': 0.6159421451411988, 'auprc': 0.6749740548082844, 'loss_val': 0.7008066291657878, 'psi': 0.639554909008033}-{'f1_val': 0.6053506888856504, 'auprc': 0.6691590813924928, 'loss_val': 0.7559707186143945, 'psi': 0.6308740458883874}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=42 head_norm_before_train=1.857253 cos_to_last_merge=0.9721 (last merge round=13)
[S14] round=42 local utility u=0.000533 metrics={'f1_val': 0.9970007132142444, 'auprc': 0.999005962387103, 'loss_val': 0.020678090311713082, 'psi': 0.9978028128833879}-{'f1_val': 0.9970007132142444, 'auprc': 0.998967356687511, 'loss_val': 0.021628856897989865, 'psi': 0.9977873706035512}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[S15] START round=42 head_norm_before_train=1.591419 cos_to_last_merge=0.9320 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.932
[S15] round=42 local utility u=0.000000 metrics={'f1_val': 0.7640171339847213, 'auprc': 0.907373664990306, 'loss_val': 0.45678481084019396, 'psi': 0.8213597463869552}-{'f1_val': 0.9948320382357905, 'auprc': 0.9911324399297659, 'loss_val': 0.04568701798549902, 'psi': 0.9933521989133807}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=42 head_norm_before_train=2.055126 (no previous merge yet)
[S16] round=42 local utility u=0.492312 metrics={'f1_val': 0.9268004058959425, 'auprc': 0.9933306822744542, 'loss_val': 0.3335913906062637, 'psi': 0.9534125164473471}-{'f1_val': 0.8491799057973364, 'auprc': 0.9864489291430443, 'loss_val': 0.8318468135982067, 'psi': 0.9040875151356196}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S17] START round=42 head_norm_before_train=2.010122 (no previous merge yet)
[S17] round=42 local utility u=0.000000 metrics={'f1_val': 0.6750152736123204, 'auprc': 0.8325344110435767, 'loss_val': 1.0850668394610985, 'psi': 0.738022928584823}-{'f1_val': 0.8519440740066285, 'auprc': 0.9105022583889928, 'loss_val': 0.32700729625807035, 'psi': 0.8753673477595743}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=43 head_norm_before_train=1.642216 cos_to_last_merge=0.9403 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.940
[S2] round=43 local utility u=0.000000 metrics={'f1_val': 0.6540097349903968, 'auprc': 0.7191032553815555, 'loss_val': 1.014869487899271, 'psi': 0.6800471431468603}-{'f1_val': 0.6776039366798459, 'auprc': 0.717340288487776, 'loss_val': 0.9379268356741467, 'psi': 0.693498477403018}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=43 head_norm_before_train=1.696002 cos_to_last_merge=0.9085 (last merge round=15)
[S3] ⚠️ Model drifted since last merge! cos=0.909
[S3] round=43 local utility u=0.179789 metrics={'f1_val': 0.9973696976584205, 'auprc': 0.9984732882777143, 'loss_val': 0.032125792606942316, 'psi': 0.997811133906138}-{'f1_val': 0.9558881670698338, 'auprc': 0.9983185744487103, 'loss_val': 0.1423511561183751, 'psi': 0.9728603300213845}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] sending update (kind=head size=1803 to 1 peers)
[S4] START round=43 head_norm_before_train=1.539229 cos_to_last_merge=0.9218 (last merge round=14)
[S4] ⚠️ Model drifted since last merge! cos=0.922
[S4] round=43 local utility u=0.000000 metrics={'f1_val': 0.9399878974244423, 'auprc': 0.959685767089692, 'loss_val': 0.2914081263840036, 'psi': 0.9478670452905422}-{'f1_val': 0.9429806419935797, 'auprc': 0.964061031510916, 'loss_val': 0.26991017286136987, 'psi': 0.9514127978005142}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=43 head_norm_before_train=1.492358 cos_to_last_merge=0.9098 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.910
[S5] round=43 local utility u=0.282313 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9961285333647523, 'loss_val': 0.1819122236024484, 'psi': 0.8186442038062491}-{'f1_val': 0.6750678059155606, 'auprc': 0.9142439061607459, 'loss_val': 0.34936263349460284, 'psi': 0.7707382460136347}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S5] sending update (kind=head size=1806 to 1 peers)
[S6] START round=43 head_norm_before_train=1.636370 cos_to_last_merge=0.7172 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.717
[S6] round=43 local utility u=0.112425 metrics={'f1_val': 0.8709667068075085, 'auprc': 0.9781706750036242, 'loss_val': 0.29158078577867164, 'psi': 0.9138482940859548}-{'f1_val': 0.8523682059837404, 'auprc': 0.9712651454953685, 'loss_val': 0.3841225065827113, 'psi': 0.8999269817883917}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=43 head_norm_before_train=1.253700 cos_to_last_merge=0.8757 (last merge round=14)
[S7] ⚠️ Model drifted since last merge! cos=0.876
[S7] round=43 local utility u=0.499397 metrics={'f1_val': 0.6259660046705908, 'auprc': 0.7979868185958647, 'loss_val': 0.5512483053474849, 'psi': 0.6947743302407003}-{'f1_val': 0.5194745083371732, 'auprc': 0.7820659437049018, 'loss_val': 0.8633307045583263, 'psi': 0.6245110824842647}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S7] sending update (kind=head size=1809 to 1 peers)
[S8] START round=43 head_norm_before_train=1.817757 cos_to_last_merge=0.7768 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.777
[S8] round=43 local utility u=0.000000 metrics={'f1_val': 0.9924515537855688, 'auprc': 0.9986854417133069, 'loss_val': 0.03143196981026595, 'psi': 0.9949451089566641}-{'f1_val': 0.9936910743895857, 'auprc': 0.9987945560681948, 'loss_val': 0.031226957316693185, 'psi': 0.9957324670610294}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=43 head_norm_before_train=1.816940 cos_to_last_merge=0.7750 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.775
[S9] round=43 local utility u=0.000398 metrics={'f1_val': 0.9967327663123822, 'auprc': 0.998532888395244, 'loss_val': 0.021140424280712476, 'psi': 0.9974528151455269}-{'f1_val': 0.9967327663123822, 'auprc': 0.9985384662815053, 'loss_val': 0.021953236890537384, 'psi': 0.9974550463000313}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=43 head_norm_before_train=1.672604 cos_to_last_merge=0.9512 (last merge round=16)
[S10] round=43 local utility u=0.318053 metrics={'f1_val': 0.9942095620893685, 'auprc': 0.995059861370164, 'loss_val': 0.058834250292603536, 'psi': 0.9945496818016868}-{'f1_val': 0.9145098759911409, 'auprc': 0.99035371798357, 'loss_val': 0.2026233270673041, 'psi': 0.9448474127881125}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=43 head_norm_before_train=1.711573 cos_to_last_merge=0.9283 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.928
[S11] round=43 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9981823757832436, 'loss_val': 0.0316649392592085, 'psi': 0.9969654351597447}-{'f1_val': 0.9963958538641108, 'auprc': 0.9981853568307117, 'loss_val': 0.026640991297734076, 'psi': 0.9971116550507513}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=43 head_norm_before_train=1.329008 cos_to_last_merge=0.7926 (last merge round=11)
[S13] ⚠️ Model drifted since last merge! cos=0.793
[S13] round=43 local utility u=0.000000 metrics={'f1_val': 0.5772607838985723, 'auprc': 0.6901802039944922, 'loss_val': 0.8964903235080116, 'psi': 0.6224285519369402}-{'f1_val': 0.6159421451411988, 'auprc': 0.6749740548082844, 'loss_val': 0.7008066291657878, 'psi': 0.639554909008033}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=43 head_norm_before_train=1.866781 cos_to_last_merge=0.9717 (last merge round=13)
[S14] round=43 local utility u=0.000378 metrics={'f1_val': 0.9972216920155168, 'auprc': 0.9984833364845922, 'loss_val': 0.01967927039811917, 'psi': 0.997726349803147}-{'f1_val': 0.9970007132142444, 'auprc': 0.999005962387103, 'loss_val': 0.020678090311713082, 'psi': 0.9978028128833879}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=43 head_norm_before_train=1.600234 cos_to_last_merge=0.9312 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.931
[S15] round=43 local utility u=0.358786 metrics={'f1_val': 0.823226332886168, 'auprc': 0.978993295898778, 'loss_val': 0.3093271522491843, 'psi': 0.885533118091212}-{'f1_val': 0.7640171339847213, 'auprc': 0.907373664990306, 'loss_val': 0.45678481084019396, 'psi': 0.8213597463869552}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=43 head_norm_before_train=2.064521 (no previous merge yet)
[S16] round=43 local utility u=0.000000 metrics={'f1_val': 0.8410261353069869, 'auprc': 0.9882878285284153, 'loss_val': 0.4800540275556047, 'psi': 0.8999308125955583}-{'f1_val': 0.9268004058959425, 'auprc': 0.9933306822744542, 'loss_val': 0.3335913906062637, 'psi': 0.9534125164473471}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=43 head_norm_before_train=2.022803 (no previous merge yet)
[S17] round=43 local utility u=1.000000 metrics={'f1_val': 0.8986581912032503, 'auprc': 0.9202825364793774, 'loss_val': 0.3044968561271446, 'psi': 0.9073079293137012}-{'f1_val': 0.6750152736123204, 'auprc': 0.8325344110435767, 'loss_val': 1.0850668394610985, 'psi': 0.738022928584823}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=44 head_norm_before_train=1.650576 cos_to_last_merge=0.9394 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.939
[S2] round=44 local utility u=0.141004 metrics={'f1_val': 0.68529119357266, 'auprc': 0.7240815571011999, 'loss_val': 0.9354858029630067, 'psi': 0.7008073389840759}-{'f1_val': 0.6540097349903968, 'auprc': 0.7191032553815555, 'loss_val': 1.014869487899271, 'psi': 0.6800471431468603}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=44 head_norm_before_train=1.707094 cos_to_last_merge=0.9067 (last merge round=15)
[S3] ⚠️ Model drifted since last merge! cos=0.907
[S3] round=44 local utility u=0.000000 metrics={'f1_val': 0.9973982357793907, 'auprc': 0.9983381937941549, 'loss_val': 0.03424140871548292, 'psi': 0.9977742189852964}-{'f1_val': 0.9973696976584205, 'auprc': 0.9984732882777143, 'loss_val': 0.032125792606942316, 'psi': 0.997811133906138}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=44 head_norm_before_train=1.549546 cos_to_last_merge=0.9202 (last merge round=14)
[S4] ⚠️ Model drifted since last merge! cos=0.920
[S4] round=44 local utility u=0.017594 metrics={'f1_val': 0.9409779800695482, 'auprc': 0.9660723928793629, 'loss_val': 0.2813208676101103, 'psi': 0.9510157451934741}-{'f1_val': 0.9399878974244423, 'auprc': 0.959685767089692, 'loss_val': 0.2914081263840036, 'psi': 0.9478670452905422}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=44 head_norm_before_train=1.501011 cos_to_last_merge=0.9087 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.909
[S5] round=44 local utility u=0.000000 metrics={'f1_val': 0.635695723007137, 'auprc': 0.9595446105910126, 'loss_val': 0.3261099344280754, 'psi': 0.7652352780406873}-{'f1_val': 0.7003213174339138, 'auprc': 0.9961285333647523, 'loss_val': 0.1819122236024484, 'psi': 0.8186442038062491}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=44 head_norm_before_train=1.648152 cos_to_last_merge=0.7155 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.715
[S6] round=44 local utility u=0.000000 metrics={'f1_val': 0.6110046360767573, 'auprc': 0.8152349675504376, 'loss_val': 1.0516823746411603, 'psi': 0.6926967686662294}-{'f1_val': 0.8709667068075085, 'auprc': 0.9781706750036242, 'loss_val': 0.29158078577867164, 'psi': 0.9138482940859548}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=44 head_norm_before_train=1.259416 cos_to_last_merge=0.8739 (last merge round=14)
[S7] ⚠️ Model drifted since last merge! cos=0.874
[S7] round=44 local utility u=0.122045 metrics={'f1_val': 0.6470876958179241, 'auprc': 0.8091734187306792, 'loss_val': 0.4674478589292438, 'psi': 0.7119219849830262}-{'f1_val': 0.6259660046705908, 'auprc': 0.7979868185958647, 'loss_val': 0.5512483053474849, 'psi': 0.6947743302407003}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=44 head_norm_before_train=1.827763 cos_to_last_merge=0.7758 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.776
[S8] round=44 local utility u=0.000000 metrics={'f1_val': 0.9881372834100528, 'auprc': 0.9953401177168156, 'loss_val': 0.04095072140641437, 'psi': 0.9910184171327578}-{'f1_val': 0.9924515537855688, 'auprc': 0.9986854417133069, 'loss_val': 0.03143196981026595, 'psi': 0.9949451089566641}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=44 head_norm_before_train=1.826880 cos_to_last_merge=0.7740 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.774
[S9] round=44 local utility u=0.000000 metrics={'f1_val': 0.9941897064172326, 'auprc': 0.9985270561901729, 'loss_val': 0.024737001874974032, 'psi': 0.9959246463264088}-{'f1_val': 0.9967327663123822, 'auprc': 0.998532888395244, 'loss_val': 0.021140424280712476, 'psi': 0.9974528151455269}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=44 head_norm_before_train=1.684603 cos_to_last_merge=0.9504 (last merge round=16)
[S10] round=44 local utility u=0.000000 metrics={'f1_val': 0.9953063309450747, 'auprc': 0.9936264907726038, 'loss_val': 0.07377209600110345, 'psi': 0.9946343948760864}-{'f1_val': 0.9942095620893685, 'auprc': 0.995059861370164, 'loss_val': 0.058834250292603536, 'psi': 0.9945496818016868}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=44 head_norm_before_train=1.722395 cos_to_last_merge=0.9268 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.927
[S11] round=44 local utility u=0.000000 metrics={'f1_val': 0.890822523604508, 'auprc': 0.9965503409955676, 'loss_val': 0.13726496927651644, 'psi': 0.9331136505609319}-{'f1_val': 0.9961541414107454, 'auprc': 0.9981823757832436, 'loss_val': 0.0316649392592085, 'psi': 0.9969654351597447}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=44 head_norm_before_train=1.333129 cos_to_last_merge=0.7914 (last merge round=11)
[S13] ⚠️ Model drifted since last merge! cos=0.791
[S13] round=44 local utility u=0.351032 metrics={'f1_val': 0.6378259617591568, 'auprc': 0.6758676538972919, 'loss_val': 0.5148788940362078, 'psi': 0.6530426386144108}-{'f1_val': 0.5772607838985723, 'auprc': 0.6901802039944922, 'loss_val': 0.8964903235080116, 'psi': 0.6224285519369402}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=44 head_norm_before_train=1.875176 cos_to_last_merge=0.9713 (last merge round=13)
[S14] round=44 local utility u=0.003247 metrics={'f1_val': 0.997874693950357, 'auprc': 0.99861596766447, 'loss_val': 0.01750130111721319, 'psi': 0.9981712034360022}-{'f1_val': 0.9972216920155168, 'auprc': 0.9984833364845922, 'loss_val': 0.01967927039811917, 'psi': 0.997726349803147}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=44 head_norm_before_train=1.611051 cos_to_last_merge=0.9303 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.930
[S15] round=44 local utility u=0.000000 metrics={'f1_val': 0.786915643465107, 'auprc': 0.9478376428284512, 'loss_val': 0.37920613759768157, 'psi': 0.8512844432104447}-{'f1_val': 0.823226332886168, 'auprc': 0.978993295898778, 'loss_val': 0.3093271522491843, 'psi': 0.885533118091212}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=44 head_norm_before_train=2.071662 (no previous merge yet)
[S16] round=44 local utility u=0.000000 metrics={'f1_val': 0.8588258523610818, 'auprc': 0.9955393324712669, 'loss_val': 0.668140577541879, 'psi': 0.9135112444051559}-{'f1_val': 0.8410261353069869, 'auprc': 0.9882878285284153, 'loss_val': 0.4800540275556047, 'psi': 0.8999308125955583}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=44 head_norm_before_train=2.030138 (no previous merge yet)
[S17] round=44 local utility u=0.000000 metrics={'f1_val': 0.6861493385014314, 'auprc': 0.8906790432108816, 'loss_val': 0.9827759379854243, 'psi': 0.7679612203852115}-{'f1_val': 0.8986581912032503, 'auprc': 0.9202825364793774, 'loss_val': 0.3044968561271446, 'psi': 0.9073079293137012}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=45 head_norm_before_train=1.655945 cos_to_last_merge=0.9389 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.939
[S2] round=45 local utility u=0.000000 metrics={'f1_val': 0.6708987469862642, 'auprc': 0.7255169235782282, 'loss_val': 0.9620451164771499, 'psi': 0.6927460176230498}-{'f1_val': 0.68529119357266, 'auprc': 0.7240815571011999, 'loss_val': 0.9354858029630067, 'psi': 0.7008073389840759}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=45 head_norm_before_train=1.717363 cos_to_last_merge=0.9051 (last merge round=15)
[S3] ⚠️ Model drifted since last merge! cos=0.905
[S3] round=45 local utility u=0.000000 metrics={'f1_val': 0.8902929675207932, 'auprc': 0.9428587458733972, 'loss_val': 0.2735468507374895, 'psi': 0.9113192788618348}-{'f1_val': 0.9973982357793907, 'auprc': 0.9983381937941549, 'loss_val': 0.03424140871548292, 'psi': 0.9977742189852964}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=45 head_norm_before_train=1.560394 cos_to_last_merge=0.9188 (last merge round=14)
[S4] ⚠️ Model drifted since last merge! cos=0.919
[S4] round=45 local utility u=0.000000 metrics={'f1_val': 0.939850024184153, 'auprc': 0.9627506228465811, 'loss_val': 0.2934003615084134, 'psi': 0.9490102636491242}-{'f1_val': 0.9409779800695482, 'auprc': 0.9660723928793629, 'loss_val': 0.2813208676101103, 'psi': 0.9510157451934741}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=45 head_norm_before_train=1.508394 cos_to_last_merge=0.9071 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.907
[S5] round=45 local utility u=0.311775 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9937779021953572, 'loss_val': 0.1930087438911397, 'psi': 0.8177035199729583}-{'f1_val': 0.635695723007137, 'auprc': 0.9595446105910126, 'loss_val': 0.3261099344280754, 'psi': 0.7652352780406873}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=45 head_norm_before_train=1.659067 cos_to_last_merge=0.7141 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.714
[S6] round=45 local utility u=1.000000 metrics={'f1_val': 0.8383292287357665, 'auprc': 0.9582220077487668, 'loss_val': 0.44041821433016975, 'psi': 0.8862863403409666}-{'f1_val': 0.6110046360767573, 'auprc': 0.8152349675504376, 'loss_val': 1.0516823746411603, 'psi': 0.6926967686662294}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=45 head_norm_before_train=1.269406 cos_to_last_merge=0.8711 (last merge round=14)
[S7] ⚠️ Model drifted since last merge! cos=0.871
[S7] round=45 local utility u=0.079251 metrics={'f1_val': 0.653653304563115, 'auprc': 0.8303185014484633, 'loss_val': 0.41177547260944125, 'psi': 0.7243193833172543}-{'f1_val': 0.6470876958179241, 'auprc': 0.8091734187306792, 'loss_val': 0.4674478589292438, 'psi': 0.7119219849830262}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=45 head_norm_before_train=1.836813 cos_to_last_merge=0.7746 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.775
[S8] round=45 local utility u=0.000000 metrics={'f1_val': 0.8716746915920026, 'auprc': 0.998534114059466, 'loss_val': 0.20529973646773358, 'psi': 0.922418460578988}-{'f1_val': 0.9881372834100528, 'auprc': 0.9953401177168156, 'loss_val': 0.04095072140641437, 'psi': 0.9910184171327578}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=45 head_norm_before_train=1.832739 cos_to_last_merge=0.7733 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.773
[S9] round=45 local utility u=0.007594 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.998536877794409, 'loss_val': 0.02206575146872458, 'psi': 0.9971773685560072}-{'f1_val': 0.9941897064172326, 'auprc': 0.9985270561901729, 'loss_val': 0.024737001874974032, 'psi': 0.9959246463264088}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=45 head_norm_before_train=1.694041 cos_to_last_merge=0.9496 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.950
[S10] round=45 local utility u=0.000000 metrics={'f1_val': 0.9122534150946247, 'auprc': 0.9914144792297058, 'loss_val': 0.2076678305083021, 'psi': 0.9439178407486571}-{'f1_val': 0.9953063309450747, 'auprc': 0.9936264907726038, 'loss_val': 0.07377209600110345, 'psi': 0.9946343948760864}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=45 head_norm_before_train=1.732599 cos_to_last_merge=0.9255 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.925
[S11] round=45 local utility u=0.264808 metrics={'f1_val': 0.9690882580169708, 'auprc': 0.9965974059462266, 'loss_val': 0.0773836376838384, 'psi': 0.9800919171886731}-{'f1_val': 0.890822523604508, 'auprc': 0.9965503409955676, 'loss_val': 0.13726496927651644, 'psi': 0.9331136505609319}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=45 head_norm_before_train=1.335305 cos_to_last_merge=0.7909 (last merge round=11)
[S13] ⚠️ Model drifted since last merge! cos=0.791
[S13] round=45 local utility u=0.000000 metrics={'f1_val': 0.5718085951558436, 'auprc': 0.6911924436784358, 'loss_val': 0.925946660648219, 'psi': 0.6195621345648805}-{'f1_val': 0.6378259617591568, 'auprc': 0.6758676538972919, 'loss_val': 0.5148788940362078, 'psi': 0.6530426386144108}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=45 head_norm_before_train=1.882032 cos_to_last_merge=0.9707 (last merge round=13)
[S14] round=45 local utility u=0.000000 metrics={'f1_val': 0.9976319732898762, 'auprc': 0.9985996855863578, 'loss_val': 0.01877608036653725, 'psi': 0.9980190582084689}-{'f1_val': 0.997874693950357, 'auprc': 0.99861596766447, 'loss_val': 0.01750130111721319, 'psi': 0.9981712034360022}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=45 head_norm_before_train=1.624241 cos_to_last_merge=0.9291 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.929
[S15] round=45 local utility u=0.000000 metrics={'f1_val': 0.7010182770734895, 'auprc': 0.9807484699664595, 'loss_val': 0.4551523429298752, 'psi': 0.8129103542306775}-{'f1_val': 0.786915643465107, 'auprc': 0.9478376428284512, 'loss_val': 0.37920613759768157, 'psi': 0.8512844432104447}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=45 head_norm_before_train=2.076974 (no previous merge yet)
[S16] round=45 local utility u=0.047335 metrics={'f1_val': 0.8647756146932157, 'auprc': 0.9955424731667583, 'loss_val': 0.6091791864106446, 'psi': 0.9170823580826327}-{'f1_val': 0.8588258523610818, 'auprc': 0.9955393324712669, 'loss_val': 0.668140577541879, 'psi': 0.9135112444051559}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=45 head_norm_before_train=2.036802 (no previous merge yet)
[S17] round=45 local utility u=0.098367 metrics={'f1_val': 0.6932442507291394, 'auprc': 0.8965547120649877, 'loss_val': 0.8462386121850515, 'psi': 0.7745684352634787}-{'f1_val': 0.6861493385014314, 'auprc': 0.8906790432108816, 'loss_val': 0.9827759379854243, 'psi': 0.7679612203852115}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[S2] START round=46 head_norm_before_train=1.660829 cos_to_last_merge=0.9384 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.938
[S2] round=46 local utility u=0.000000 metrics={'f1_val': 0.6631626762848757, 'auprc': 0.7278491826407156, 'loss_val': 1.035440778440832, 'psi': 0.6890372788272117}-{'f1_val': 0.6708987469862642, 'auprc': 0.7255169235782282, 'loss_val': 0.9620451164771499, 'psi': 0.6927460176230498}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=46 head_norm_before_train=1.726494 cos_to_last_merge=0.9040 (last merge round=15)
[S3] ⚠️ Model drifted since last merge! cos=0.904
[S3] round=46 local utility u=0.527418 metrics={'f1_val': 0.9973696976584205, 'auprc': 0.9984182930945611, 'loss_val': 0.027849432145687893, 'psi': 0.9977891358328768}-{'f1_val': 0.8902929675207932, 'auprc': 0.9428587458733972, 'loss_val': 0.2735468507374895, 'psi': 0.9113192788618348}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=46 head_norm_before_train=1.568739 cos_to_last_merge=0.9178 (last merge round=14)
[S4] ⚠️ Model drifted since last merge! cos=0.918
[S4] round=46 local utility u=0.000000 metrics={'f1_val': 0.9387172279202738, 'auprc': 0.9591415178582303, 'loss_val': 0.3109628241337142, 'psi': 0.9468869438954564}-{'f1_val': 0.939850024184153, 'auprc': 0.9627506228465811, 'loss_val': 0.2934003615084134, 'psi': 0.9490102636491242}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=46 head_norm_before_train=1.514466 cos_to_last_merge=0.9066 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.907
[S5] round=46 local utility u=0.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.8992083249421998, 'loss_val': 0.334393794272104, 'psi': 0.7798756890716954}-{'f1_val': 0.700320598491359, 'auprc': 0.9937779021953572, 'loss_val': 0.1930087438911397, 'psi': 0.8177035199729583}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=46 head_norm_before_train=1.669735 cos_to_last_merge=0.7131 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.713
[S6] round=46 local utility u=0.000000 metrics={'f1_val': 0.7708495108690623, 'auprc': 0.9541417338871339, 'loss_val': 0.5661788607233736, 'psi': 0.844166400076291}-{'f1_val': 0.8383292287357665, 'auprc': 0.9582220077487668, 'loss_val': 0.44041821433016975, 'psi': 0.8862863403409666}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=46 head_norm_before_train=1.280213 cos_to_last_merge=0.8680 (last merge round=14)
[S7] ⚠️ Model drifted since last merge! cos=0.868
[S7] round=46 local utility u=0.094050 metrics={'f1_val': 0.6690086749288721, 'auprc': 0.8463788986039449, 'loss_val': 0.3639886511303407, 'psi': 0.7399567643989012}-{'f1_val': 0.653653304563115, 'auprc': 0.8303185014484633, 'loss_val': 0.41177547260944125, 'psi': 0.7243193833172543}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] sending update (kind=head size=1806 to 1 peers)
[S8] START round=46 head_norm_before_train=1.844497 cos_to_last_merge=0.7740 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.774
[S8] round=46 local utility u=0.451180 metrics={'f1_val': 0.9931648515513533, 'auprc': 0.9987098553434055, 'loss_val': 0.03240767908792248, 'psi': 0.9953828530681741}-{'f1_val': 0.8716746915920026, 'auprc': 0.998534114059466, 'loss_val': 0.20529973646773358, 'psi': 0.922418460578988}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] sending update (kind=head size=1794 to 1 peers)
[S9] START round=46 head_norm_before_train=1.839897 cos_to_last_merge=0.7725 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.772
[S9] round=46 local utility u=0.003706 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9985483212948797, 'loss_val': 0.0196802036515597, 'psi': 0.9976810760252376}-{'f1_val': 0.9962710290637395, 'auprc': 0.998536877794409, 'loss_val': 0.02206575146872458, 'psi': 0.9971773685560072}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] sending update (kind=head size=1804 to 1 peers)
[S10] START round=46 head_norm_before_train=1.704893 cos_to_last_merge=0.9485 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.948
[S10] round=46 local utility u=0.042130 metrics={'f1_val': 0.9231416288858143, 'auprc': 0.9906706565412332, 'loss_val': 0.18650544127264695, 'psi': 0.9501532399479818}-{'f1_val': 0.9122534150946247, 'auprc': 0.9914144792297058, 'loss_val': 0.2076678305083021, 'psi': 0.9439178407486571}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=46 head_norm_before_train=1.742705 cos_to_last_merge=0.9242 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.924
[S11] round=46 local utility u=0.108306 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.99830146596643, 'loss_val': 0.0282797612079831, 'psi': 0.9970130712330192}-{'f1_val': 0.9690882580169708, 'auprc': 0.9965974059462266, 'loss_val': 0.0773836376838384, 'psi': 0.9800919171886731}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S11] sending update (kind=head size=1806 to 1 peers)
[S13] START round=46 head_norm_before_train=1.341859 cos_to_last_merge=0.7893 (last merge round=11)
[S13] ⚠️ Model drifted since last merge! cos=0.789
[S13] round=46 local utility u=0.025975 metrics={'f1_val': 0.576131945455046, 'auprc': 0.6893142670332912, 'loss_val': 0.8943020707752783, 'psi': 0.621404874086344}-{'f1_val': 0.5718085951558436, 'auprc': 0.6911924436784358, 'loss_val': 0.925946660648219, 'psi': 0.6195621345648805}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=46 head_norm_before_train=1.889494 cos_to_last_merge=0.9702 (last merge round=13)
[S14] round=46 local utility u=0.000622 metrics={'f1_val': 0.9976538428159559, 'auprc': 0.9988924354413866, 'loss_val': 0.01854166605779361, 'psi': 0.9981492798661282}-{'f1_val': 0.9976319732898762, 'auprc': 0.9985996855863578, 'loss_val': 0.01877608036653725, 'psi': 0.9980190582084689}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=46 head_norm_before_train=1.638123 cos_to_last_merge=0.9278 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.928
[S15] round=46 local utility u=1.000000 metrics={'f1_val': 0.9875976719931775, 'auprc': 0.9785312183378828, 'loss_val': 0.07537933989299725, 'psi': 0.9839710905310597}-{'f1_val': 0.7010182770734895, 'auprc': 0.9807484699664595, 'loss_val': 0.4551523429298752, 'psi': 0.8129103542306775}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=46 head_norm_before_train=2.082179 (no previous merge yet)
[S16] round=46 local utility u=0.230469 metrics={'f1_val': 0.9120915112549283, 'auprc': 0.9900864069664754, 'loss_val': 0.4157677995966289, 'psi': 0.9432894695395472}-{'f1_val': 0.8647756146932157, 'auprc': 0.9955424731667583, 'loss_val': 0.6091791864106446, 'psi': 0.9170823580826327}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] sending update (kind=head size=1795 to 1 peers)
[S17] START round=46 head_norm_before_train=2.045468 (no previous merge yet)
[S17] round=46 local utility u=0.700704 metrics={'f1_val': 0.8408276433314866, 'auprc': 0.913429913206532, 'loss_val': 0.38095682045428436, 'psi': 0.8698685512815048}-{'f1_val': 0.6932442507291394, 'auprc': 0.8965547120649877, 'loss_val': 0.8462386121850515, 'psi': 0.7745684352634787}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] sending update (kind=head size=1794 to 1 peers)
[S2] START round=47 head_norm_before_train=1.667883 cos_to_last_merge=0.9376 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.938
[S2] round=47 local utility u=0.074302 metrics={'f1_val': 0.6757976654913588, 'auprc': 0.7272036980889388, 'loss_val': 0.9607109617482655, 'psi': 0.6963600785303908}-{'f1_val': 0.6631626762848757, 'auprc': 0.7278491826407156, 'loss_val': 1.035440778440832, 'psi': 0.6890372788272117}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] sending update (kind=head size=1794 to 1 peers)
[S3] START round=47 head_norm_before_train=1.733791 cos_to_last_merge=0.9030 (last merge round=15)
[S3] ⚠️ Model drifted since last merge! cos=0.903
[S3] round=47 local utility u=0.000000 metrics={'f1_val': 0.9974271292865575, 'auprc': 0.9984022793062644, 'loss_val': 0.046960976279190304, 'psi': 0.9978171892944403}-{'f1_val': 0.9973696976584205, 'auprc': 0.9984182930945611, 'loss_val': 0.027849432145687893, 'psi': 0.9977891358328768}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=47 head_norm_before_train=1.575230 cos_to_last_merge=0.9172 (last merge round=14)
[S4] ⚠️ Model drifted since last merge! cos=0.917
[S4] round=47 local utility u=0.029621 metrics={'f1_val': 0.9430674689961278, 'auprc': 0.9600544820906274, 'loss_val': 0.2805617505610611, 'psi': 0.9498622742339276}-{'f1_val': 0.9387172279202738, 'auprc': 0.9591415178582303, 'loss_val': 0.3109628241337142, 'psi': 0.9468869438954564}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=47 head_norm_before_train=1.519900 cos_to_last_merge=0.9066 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.907
[S5] round=47 local utility u=0.178356 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9880559827958261, 'loss_val': 0.2442288878637629, 'psi': 0.8154151835786787}-{'f1_val': 0.700320598491359, 'auprc': 0.8992083249421998, 'loss_val': 0.334393794272104, 'psi': 0.7798756890716954}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=47 head_norm_before_train=1.681748 cos_to_last_merge=0.7119 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.712
[S6] round=47 local utility u=0.000000 metrics={'f1_val': 0.7418941271834602, 'auprc': 0.9314278480489024, 'loss_val': 0.7431892861248053, 'psi': 0.817707615529637}-{'f1_val': 0.7708495108690623, 'auprc': 0.9541417338871339, 'loss_val': 0.5661788607233736, 'psi': 0.844166400076291}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=47 head_norm_before_train=1.286441 cos_to_last_merge=0.8657 (last merge round=14)
[S7] ⚠️ Model drifted since last merge! cos=0.866
[S7] round=47 local utility u=0.000000 metrics={'f1_val': 0.5155280191796758, 'auprc': 0.784989811895118, 'loss_val': 0.9788784180380881, 'psi': 0.6233127362658527}-{'f1_val': 0.6690086749288721, 'auprc': 0.8463788986039449, 'loss_val': 0.3639886511303407, 'psi': 0.7399567643989012}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=47 head_norm_before_train=1.850711 cos_to_last_merge=0.7739 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.774
[S8] round=47 local utility u=0.000778 metrics={'f1_val': 0.9930017911527874, 'auprc': 0.9986533225470152, 'loss_val': 0.02970406171416226, 'psi': 0.9952624037104785}-{'f1_val': 0.9931648515513533, 'auprc': 0.9987098553434055, 'loss_val': 0.03240767908792248, 'psi': 0.9953828530681741}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=47 head_norm_before_train=1.848276 cos_to_last_merge=0.7716 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.772
[S9] round=47 local utility u=0.000000 metrics={'f1_val': 0.9721373296683108, 'auprc': 0.9985276522972886, 'loss_val': 0.07555463948594271, 'psi': 0.9826934587199019}-{'f1_val': 0.9971029125121428, 'auprc': 0.9985483212948797, 'loss_val': 0.0196802036515597, 'psi': 0.9976810760252376}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=47 head_norm_before_train=1.716097 cos_to_last_merge=0.9472 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.947
[S10] round=47 local utility u=0.277124 metrics={'f1_val': 0.9946635826770371, 'auprc': 0.9921580634342341, 'loss_val': 0.06585077253855154, 'psi': 0.9936613749799159}-{'f1_val': 0.9231416288858143, 'auprc': 0.9906706565412332, 'loss_val': 0.18650544127264695, 'psi': 0.9501532399479818}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=47 head_norm_before_train=1.753530 cos_to_last_merge=0.9228 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.923
[S11] round=47 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.997292572676414, 'loss_val': 0.05143815504509767, 'psi': 0.9966095139170128}-{'f1_val': 0.9961541414107454, 'auprc': 0.99830146596643, 'loss_val': 0.0282797612079831, 'psi': 0.9970130712330192}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=47 head_norm_before_train=1.350010 cos_to_last_merge=0.7876 (last merge round=11)
[S13] ⚠️ Model drifted since last merge! cos=0.788
[S13] round=47 local utility u=0.230648 metrics={'f1_val': 0.6163867852334098, 'auprc': 0.6799027364388636, 'loss_val': 0.6462996662801487, 'psi': 0.6417931657155913}-{'f1_val': 0.576131945455046, 'auprc': 0.6893142670332912, 'loss_val': 0.8943020707752783, 'psi': 0.621404874086344}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=47 head_norm_before_train=1.898263 cos_to_last_merge=0.9697 (last merge round=13)
[S14] round=47 local utility u=0.002480 metrics={'f1_val': 0.9980623665153463, 'auprc': 0.99903348584798, 'loss_val': 0.0164553274100849, 'psi': 0.9984508142483999}-{'f1_val': 0.9976538428159559, 'auprc': 0.9988924354413866, 'loss_val': 0.01854166605779361, 'psi': 0.9981492798661282}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=47 head_norm_before_train=1.650533 cos_to_last_merge=0.9266 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.927
[S15] round=47 local utility u=0.000000 metrics={'f1_val': 0.691786928488907, 'auprc': 0.7272081684535384, 'loss_val': 0.6454645644027132, 'psi': 0.7059554244747596}-{'f1_val': 0.9875976719931775, 'auprc': 0.9785312183378828, 'loss_val': 0.07537933989299725, 'psi': 0.9839710905310597}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=47 head_norm_before_train=2.085303 (no previous merge yet)
[S16] round=47 local utility u=0.429584 metrics={'f1_val': 0.9933099690446822, 'auprc': 0.9884120483851448, 'loss_val': 0.03888780095437829, 'psi': 0.9913508007808672}-{'f1_val': 0.9120915112549283, 'auprc': 0.9900864069664754, 'loss_val': 0.4157677995966289, 'psi': 0.9432894695395472}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=47 head_norm_before_train=2.055526 (no previous merge yet)
[S17] round=47 local utility u=0.000000 metrics={'f1_val': 0.6780256959695157, 'auprc': 0.8081017187280188, 'loss_val': 1.1473470184787433, 'psi': 0.730056105072917}-{'f1_val': 0.8408276433314866, 'auprc': 0.913429913206532, 'loss_val': 0.38095682045428436, 'psi': 0.8698685512815048}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=48 head_norm_before_train=1.677933 cos_to_last_merge=0.9366 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.937
[S2] round=48 local utility u=0.099384 metrics={'f1_val': 0.7023500217641989, 'auprc': 0.7244155925440042, 'loss_val': 0.9128920454500118, 'psi': 0.711176250076121}-{'f1_val': 0.6757976654913588, 'auprc': 0.7272036980889388, 'loss_val': 0.9607109617482655, 'psi': 0.6963600785303908}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=48 head_norm_before_train=1.740628 cos_to_last_merge=0.9021 (last merge round=15)
[S3] ⚠️ Model drifted since last merge! cos=0.902
[S3] round=48 local utility u=0.000000 metrics={'f1_val': 0.960651231474942, 'auprc': 0.9984162774407752, 'loss_val': 0.18063138531715064, 'psi': 0.9757572498612752}-{'f1_val': 0.9974271292865575, 'auprc': 0.9984022793062644, 'loss_val': 0.046960976279190304, 'psi': 0.9978171892944403}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=48 head_norm_before_train=1.578509 cos_to_last_merge=0.9167 (last merge round=14)
[S4] ⚠️ Model drifted since last merge! cos=0.917
[S4] round=48 local utility u=0.000000 metrics={'f1_val': 0.9395606950186162, 'auprc': 0.9613394518143626, 'loss_val': 0.2959963397672774, 'psi': 0.9482721977369148}-{'f1_val': 0.9430674689961278, 'auprc': 0.9600544820906274, 'loss_val': 0.2805617505610611, 'psi': 0.9498622742339276}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=48 head_norm_before_train=1.523756 cos_to_last_merge=0.9062 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.906
[S5] round=48 local utility u=0.000000 metrics={'f1_val': 0.7003306549797463, 'auprc': 0.9740682215007783, 'loss_val': 0.2984128445894568, 'psi': 0.8098256815881592}-{'f1_val': 0.7003213174339138, 'auprc': 0.9880559827958261, 'loss_val': 0.2442288878637629, 'psi': 0.8154151835786787}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=48 head_norm_before_train=1.693807 cos_to_last_merge=0.7106 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.711
[S6] round=48 local utility u=0.000000 metrics={'f1_val': 0.6257220316107502, 'auprc': 0.9535703181103052, 'loss_val': 0.7928019317398483, 'psi': 0.7568613462105722}-{'f1_val': 0.7418941271834602, 'auprc': 0.9314278480489024, 'loss_val': 0.7431892861248053, 'psi': 0.817707615529637}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=48 head_norm_before_train=1.289792 cos_to_last_merge=0.8641 (last merge round=14)
[S7] ⚠️ Model drifted since last merge! cos=0.864
[S7] round=48 local utility u=0.697513 metrics={'f1_val': 0.6488171369709118, 'auprc': 0.8114479197142583, 'loss_val': 0.4629618127317778, 'psi': 0.7138694500682504}-{'f1_val': 0.5155280191796758, 'auprc': 0.784989811895118, 'loss_val': 0.9788784180380881, 'psi': 0.6233127362658527}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S7] sending update (kind=head size=1808 to 1 peers)
[S8] START round=48 head_norm_before_train=1.858274 cos_to_last_merge=0.7734 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.773
[S8] round=48 local utility u=0.000000 metrics={'f1_val': 0.981280606576164, 'auprc': 0.9988084396048666, 'loss_val': 0.04727771655025873, 'psi': 0.9882917397876452}-{'f1_val': 0.9930017911527874, 'auprc': 0.9986533225470152, 'loss_val': 0.02970406171416226, 'psi': 0.9952624037104785}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=48 head_norm_before_train=1.852810 cos_to_last_merge=0.7711 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.771
[S9] round=48 local utility u=0.104262 metrics={'f1_val': 0.9975138174234109, 'auprc': 0.9985367371945381, 'loss_val': 0.019316737180386647, 'psi': 0.9979229853318617}-{'f1_val': 0.9721373296683108, 'auprc': 0.9985276522972886, 'loss_val': 0.07555463948594271, 'psi': 0.9826934587199019}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=48 head_norm_before_train=1.724941 cos_to_last_merge=0.9463 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.946
[S10] round=48 local utility u=0.007225 metrics={'f1_val': 0.9933489306849028, 'auprc': 0.9936024574109531, 'loss_val': 0.047845275346373194, 'psi': 0.993450341375323}-{'f1_val': 0.9946635826770371, 'auprc': 0.9921580634342341, 'loss_val': 0.06585077253855154, 'psi': 0.9936613749799159}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=48 head_norm_before_train=1.763763 cos_to_last_merge=0.9215 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.921
[S11] round=48 local utility u=0.000000 metrics={'f1_val': 0.8948563985204088, 'auprc': 0.9965545736213943, 'loss_val': 0.12955238777283618, 'psi': 0.935535668560803}-{'f1_val': 0.9961541414107454, 'auprc': 0.997292572676414, 'loss_val': 0.05143815504509767, 'psi': 0.9966095139170128}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=48 head_norm_before_train=1.356664 cos_to_last_merge=0.7864 (last merge round=11)
[S13] ⚠️ Model drifted since last merge! cos=0.786
[S13] round=48 local utility u=0.000000 metrics={'f1_val': 0.6002664989795147, 'auprc': 0.6873444633720106, 'loss_val': 0.732360408711922, 'psi': 0.6350976847365131}-{'f1_val': 0.6163867852334098, 'auprc': 0.6799027364388636, 'loss_val': 0.6462996662801487, 'psi': 0.6417931657155913}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=48 head_norm_before_train=1.903841 cos_to_last_merge=0.9693 (last merge round=13)
[S14] round=48 local utility u=0.000000 metrics={'f1_val': 0.943087237562441, 'auprc': 0.9990426232970918, 'loss_val': 0.07257934124872903, 'psi': 0.9654693918563013}-{'f1_val': 0.9980623665153463, 'auprc': 0.99903348584798, 'loss_val': 0.0164553274100849, 'psi': 0.9984508142483999}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=48 head_norm_before_train=1.662273 cos_to_last_merge=0.9255 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.926
[S15] round=48 local utility u=1.000000 metrics={'f1_val': 0.9829311802628193, 'auprc': 0.9659323424747958, 'loss_val': 0.1031074224027382, 'psi': 0.9761316451476099}-{'f1_val': 0.691786928488907, 'auprc': 0.7272081684535384, 'loss_val': 0.6454645644027132, 'psi': 0.7059554244747596}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=48 head_norm_before_train=2.087960 (no previous merge yet)
[S16] round=48 local utility u=0.000000 metrics={'f1_val': 0.8244458628937056, 'auprc': 0.9860542083529049, 'loss_val': 0.6375952367570448, 'psi': 0.8890892010773853}-{'f1_val': 0.9933099690446822, 'auprc': 0.9884120483851448, 'loss_val': 0.03888780095437829, 'psi': 0.9913508007808672}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=48 head_norm_before_train=2.064350 (no previous merge yet)
[S17] round=48 local utility u=0.877042 metrics={'f1_val': 0.7980224337553568, 'auprc': 0.9100707469345092, 'loss_val': 0.41915037733983723, 'psi': 0.8428417590270177}-{'f1_val': 0.6780256959695157, 'auprc': 0.8081017187280188, 'loss_val': 1.1473470184787433, 'psi': 0.730056105072917}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=49 head_norm_before_train=1.688760 cos_to_last_merge=0.9354 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.935
[S2] round=49 local utility u=0.024307 metrics={'f1_val': 0.7079712292018346, 'auprc': 0.7243923611045049, 'loss_val': 0.8979348767588968, 'psi': 0.7145396819629027}-{'f1_val': 0.7023500217641989, 'auprc': 0.7244155925440042, 'loss_val': 0.9128920454500118, 'psi': 0.711176250076121}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[S3] START round=49 head_norm_before_train=1.746957 cos_to_last_merge=0.9012 (last merge round=15)
[S3] ⚠️ Model drifted since last merge! cos=0.901
[S3] round=49 local utility u=0.128231 metrics={'f1_val': 0.983867992857389, 'auprc': 0.998607610459404, 'loss_val': 0.06404492726107149, 'psi': 0.989763839898195}-{'f1_val': 0.960651231474942, 'auprc': 0.9984162774407752, 'loss_val': 0.18063138531715064, 'psi': 0.9757572498612752}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=49 head_norm_before_train=1.584092 cos_to_last_merge=0.9157 (last merge round=14)
[S4] ⚠️ Model drifted since last merge! cos=0.916
[S4] round=49 local utility u=0.010300 metrics={'f1_val': 0.9432816409987667, 'auprc': 0.9552120909641041, 'loss_val': 0.27933946682962146, 'psi': 0.9480538209849017}-{'f1_val': 0.9395606950186162, 'auprc': 0.9613394518143626, 'loss_val': 0.2959963397672774, 'psi': 0.9482721977369148}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=49 head_norm_before_train=1.527221 cos_to_last_merge=0.9056 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.906
[S5] round=49 local utility u=0.584732 metrics={'f1_val': 0.864705111799178, 'auprc': 0.9945643044669457, 'loss_val': 0.17668394392486064, 'psi': 0.9166487888662851}-{'f1_val': 0.7003306549797463, 'auprc': 0.9740682215007783, 'loss_val': 0.2984128445894568, 'psi': 0.8098256815881592}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S5] sending update (kind=head size=1806 to 1 peers)
[S6] START round=49 head_norm_before_train=1.702258 cos_to_last_merge=0.7096 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.710
[S6] round=49 local utility u=1.000000 metrics={'f1_val': 0.9724564990127641, 'auprc': 0.9885006229849336, 'loss_val': 0.11520642942957256, 'psi': 0.9788741486016319}-{'f1_val': 0.6257220316107502, 'auprc': 0.9535703181103052, 'loss_val': 0.7928019317398483, 'psi': 0.7568613462105722}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=49 head_norm_before_train=1.294247 cos_to_last_merge=0.8623 (last merge round=14)
[S7] ⚠️ Model drifted since last merge! cos=0.862
[S7] round=49 local utility u=0.000000 metrics={'f1_val': 0.6040914034124452, 'auprc': 0.7983309081245099, 'loss_val': 0.5760070158242263, 'psi': 0.6817872052972711}-{'f1_val': 0.6488171369709118, 'auprc': 0.8114479197142583, 'loss_val': 0.4629618127317778, 'psi': 0.7138694500682504}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=49 head_norm_before_train=1.867270 cos_to_last_merge=0.7728 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.773
[S8] round=49 local utility u=0.027800 metrics={'f1_val': 0.988630461106919, 'auprc': 0.9986892508471971, 'loss_val': 0.0354187499705685, 'psi': 0.9926539770030303}-{'f1_val': 0.981280606576164, 'auprc': 0.9988084396048666, 'loss_val': 0.04727771655025873, 'psi': 0.9882917397876452}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] START round=49 head_norm_before_train=1.858384 cos_to_last_merge=0.7704 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.770
[S9] round=49 local utility u=0.000000 metrics={'f1_val': 0.9967327663123822, 'auprc': 0.9985362211413731, 'loss_val': 0.019550665760120142, 'psi': 0.9974541482439785}-{'f1_val': 0.9975138174234109, 'auprc': 0.9985367371945381, 'loss_val': 0.019316737180386647, 'psi': 0.9979229853318617}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=49 head_norm_before_train=1.734518 cos_to_last_merge=0.9455 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.946
[S10] round=49 local utility u=0.000000 metrics={'f1_val': 0.9325786655960262, 'auprc': 0.9908266566953516, 'loss_val': 0.15800921892010003, 'psi': 0.9558778620357563}-{'f1_val': 0.9933489306849028, 'auprc': 0.9936024574109531, 'loss_val': 0.047845275346373194, 'psi': 0.993450341375323}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=49 head_norm_before_train=1.773200 cos_to_last_merge=0.9203 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.920
[S11] round=49 local utility u=0.361589 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9986123955574496, 'loss_val': 0.022813299970764228, 'psi': 0.9973854406067081}-{'f1_val': 0.8948563985204088, 'auprc': 0.9965545736213943, 'loss_val': 0.12955238777283618, 'psi': 0.935535668560803}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] sending update (kind=head size=1803 to 1 peers)
[S13] START round=49 head_norm_before_train=1.363478 cos_to_last_merge=0.7850 (last merge round=11)
[S13] ⚠️ Model drifted since last merge! cos=0.785
[S13] round=49 local utility u=0.069459 metrics={'f1_val': 0.6123253274565221, 'auprc': 0.6842099436400345, 'loss_val': 0.6563927779720631, 'psi': 0.6410791739299271}-{'f1_val': 0.6002664989795147, 'auprc': 0.6873444633720106, 'loss_val': 0.732360408711922, 'psi': 0.6350976847365131}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=49 head_norm_before_train=1.910790 cos_to_last_merge=0.9688 (last merge round=13)
[S14] round=49 local utility u=0.192810 metrics={'f1_val': 0.9980623665153463, 'auprc': 0.9990534788585734, 'loss_val': 0.01684363770262715, 'psi': 0.9984588114526372}-{'f1_val': 0.943087237562441, 'auprc': 0.9990426232970918, 'loss_val': 0.07257934124872903, 'psi': 0.9654693918563013}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] sending update (kind=head size=1795 to 1 peers)
[S15] START round=49 head_norm_before_train=1.670139 cos_to_last_merge=0.9247 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.925
[S15] round=49 local utility u=0.000000 metrics={'f1_val': 0.6944374622232572, 'auprc': 0.6498850828824028, 'loss_val': 0.689303076162935, 'psi': 0.6766165104869154}-{'f1_val': 0.9829311802628193, 'auprc': 0.9659323424747958, 'loss_val': 0.1031074224027382, 'psi': 0.9761316451476099}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=49 head_norm_before_train=2.093447 (no previous merge yet)
[S16] round=49 local utility u=0.814164 metrics={'f1_val': 0.9925559284044856, 'auprc': 0.9927684360285334, 'loss_val': 0.038070459056628855, 'psi': 0.9926409314541047}-{'f1_val': 0.8244458628937056, 'auprc': 0.9860542083529049, 'loss_val': 0.6375952367570448, 'psi': 0.8890892010773853}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=49 head_norm_before_train=2.070276 (no previous merge yet)
[S17] round=49 local utility u=0.000000 metrics={'f1_val': 0.6916632622462128, 'auprc': 0.8959184665359414, 'loss_val': 0.8629252293734256, 'psi': 0.7733653439621042}-{'f1_val': 0.7980224337553568, 'auprc': 0.9100707469345092, 'loss_val': 0.41915037733983723, 'psi': 0.8428417590270177}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[runner] rounds complete.
[runner] all agents stopped.
