[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:63203
[S3] → join 127.0.0.1:63202
[S4] → join 127.0.0.1:63202
[S5] → join 127.0.0.1:63202
[S6] → join 127.0.0.1:63202
[S7] → join 127.0.0.1:63202
[S8] → join 127.0.0.1:63202
[S9] → join 127.0.0.1:63202
[S10] → join 127.0.0.1:63202
[S11] → join 127.0.0.1:63202
[S13] → join 127.0.0.1:63202
[S14] → join 127.0.0.1:63202
[S15] → join 127.0.0.1:63202
[S16] → join 127.0.0.1:63202
[S17] → join 127.0.0.1:63202
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=50
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.167599 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.191815 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.204718 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.112820 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.148080 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.101616 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.157891 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.150939 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.186114 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.195474 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.167046 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.238028 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.149716 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.111323 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.139839 (no previous merge yet)
[S4]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S4] + discovered S3
[S3] + discovered S17
[S4] + discovered S2
[S3] + discovered S11
[S3] + discovered S13
[S3] + discovered S10
[S3] + discovered S15
[S3] + discovered S7
[S3] + discovered S9
[S3] + discovered S6
[S3] + discovered S16
[S3] + discovered S8
[S3] + discovered S4
[S3] + discovered S14
[S3] + discovered S5
[S5] + discovered S3
[S5] + discovered S4
[S4] + discovered S7
[S4] + discovered S9
[S4] + discovered S5
[S4] + discovered S8
[S4] + discovered S16
[S4] + discovered S10
[S4] + discovered S6
[S5] + discovered S2
[S4] + discovered S15
[S4] + discovered S11
[S4] + discovered S17
[S4] + discovered S14
[S4] + discovered S13
[S5] + discovered S16
[S5] + discovered S7
[S5] + discovered S13
[S5] + discovered S9
[S5] + discovered S14
[S6] + discovered S4
[S5] + discovered S6
[S5] + discovered S15
[S5] + discovered S17
[S6] + discovered S3
[S5] + discovered S8
[S5] + discovered S10
[S6] + discovered S5
[S6] + discovered S2
[S5] + discovered S11
[S6] + discovered S17
[S6] + discovered S7
[S7] + discovered S2
[S6] + discovered S14
[S6] + discovered S11
[S7] + discovered S6
[S6] + discovered S10
[S7] + discovered S4
[S6] + discovered S15
[S6] + discovered S9
[S6] + discovered S16
[S6] + discovered S8
[S7] + discovered S5
[S6] + discovered S13
[S7] + discovered S3
[S8] + discovered S6
[S7] + discovered S10
[S7] + discovered S11
[S8] + discovered S2
[S8] + discovered S7
[S8] + discovered S4
[S8] + discovered S3
[S7] + discovered S9
[S8] + discovered S5
[S7] + discovered S8
[S7] + discovered S17
[S7] + discovered S14
[S7] + discovered S16
[S7] + discovered S13
[S7] + discovered S15
[S9] + discovered S4
[S8] + discovered S16
[S9] + discovered S7
[S8] + discovered S15
[S8] + discovered S17
[S9] + discovered S5
[S8] + discovered S9
[S9] + discovered S6
[S9] + discovered S3
[S9] + discovered S8
[S9] + discovered S2
[S8] + discovered S10
[S8] + discovered S13
[S8] + discovered S14
[S8] + discovered S11
[S10] + discovered S5
[S10] + discovered S3
[S10] + discovered S2
[S10] + discovered S8
[S9] + discovered S16
[S10] + discovered S7
[S9] + discovered S15
[S10] + discovered S4
[S9] + discovered S10
[S9] + discovered S17
[S9] + discovered S11
[S9] + discovered S13
[S10] + discovered S6
[S9] + discovered S14
[S10] + discovered S9
[S11] + discovered S7
[S10] + discovered S13
[S10] + discovered S17
[S11] + discovered S9
[S11] + discovered S5
[S11] + discovered S2
[S11] + discovered S6
[S10] + discovered S15
[S10] + discovered S14
[S11] + discovered S10
[S11] + discovered S8
[S11] + discovered S3
[S10] + discovered S16
[S10] + discovered S11
[S11] + discovered S4
[S11] + discovered S14
[S13] + discovered S11
[S13] + discovered S10
[S13] + discovered S6
[S11] + discovered S13
[S11] + discovered S16
[S11] + discovered S15
[S11] + discovered S17
[S13] + discovered S2
[S13] + discovered S8
[S13] + discovered S4
[S13] + discovered S5
[S13] + discovered S9
[S13] + discovered S3
[S13] + discovered S7
[S14] + discovered S11
[S14] + discovered S7
[S14] + discovered S4
[S13] + discovered S15
[S13] + discovered S14
[S13] + discovered S16
[S14] + discovered S3
[S14] + discovered S6
[S14] + discovered S13
[S13] + discovered S17
[S14] + discovered S9
[S14] + discovered S10
[S14] + discovered S5
[S14] + discovered S8
[S14] + discovered S2
[S15] + discovered S6
[S15] + discovered S2
[S14] + discovered S17
[S15] + discovered S11
[S15] + discovered S4
[S15] + discovered S5
[S15] + discovered S3
[S15] + discovered S10
[S15] + discovered S8
[S15] + discovered S7
[S15] + discovered S13
[S14] + discovered S15
[S14] + discovered S16
[S15] + discovered S14
[S15] + discovered S9
[S16] + discovered S2
[S15] + discovered S16
[S16] + discovered S3
[S16] + discovered S11
[S16] + discovered S14
[S15] + discovered S17
[S16] + discovered S13
[S16] + discovered S5
[S16] + discovered S8
[S16] + discovered S4
[S16] + discovered S10
[S16] + discovered S7
[S16] + discovered S6
[S16] + discovered S15
[S16] + discovered S9
[S17] + discovered S9
[S17] + discovered S8
[S17] + discovered S6
[S17] + discovered S10
[S17] + discovered S13
[S17] + discovered S5
[S17] + discovered S7
[S17] + discovered S16
[S17] + discovered S11
[S17] + discovered S3
[S17] + discovered S4
[S17] + discovered S15
[S16] + discovered S17
[S17] + discovered S2
[S17] + discovered S14
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] ⇄ pheromone p=1.000 → S5@127.0.0.1:63205
[S6] ⇄ pheromone p=1.000 → S13@127.0.0.1:63213
[S3] ⇄ pheromone p=1.000 → S11@127.0.0.1:63212
[S14] ⇄ pheromone p=1.000 → S10@127.0.0.1:63211
[S11] ⇄ pheromone p=1.000 → S15@127.0.0.1:63215
[S2] ⇄ pheromone p=1.000 → S4@127.0.0.1:63204
[S15] ⇄ pheromone p=1.000 → S13@127.0.0.1:63213
[S8] ⇄ pheromone p=1.000 → S2@127.0.0.1:63202
[S4] ⇄ pheromone p=1.000 → S7@127.0.0.1:63208
[S5] ⇄ pheromone p=1.000 → S3@127.0.0.1:63203
[S16] ⇄ pheromone p=1.000 → S4@127.0.0.1:63204
[S13] ⇄ pheromone p=1.000 → S3@127.0.0.1:63203
[S9] ⇄ pheromone p=1.000 → S5@127.0.0.1:63205
[S7] ⇄ pheromone p=1.000 → S3@127.0.0.1:63203
[S17] ⇄ pheromone p=1.000 → S2@127.0.0.1:63202
[S2] START round=1 head_norm_before_train=1.167499 (no previous merge yet)
[S2] round=1 local utility u=0.382030 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.768721391307418, 'loss_val': 1.3199418105910816, 'psi': 0.3925548365561073}-{'f1_val': 0.1417771333885667, 'auprc': 0.5236796925439409, 'loss_val': 1.3488768770734354, 'psi': 0.2945381570507164}
[S3] START round=1 head_norm_before_train=1.194228 (no previous merge yet)
[S3] round=1 local utility u=1.000000 metrics={'f1_val': 0.40071406678232513, 'auprc': 0.8743977620326552, 'loss_val': 1.3259783117746453, 'psi': 0.5901875448824572}-{'f1_val': 0.10474797479747974, 'auprc': 0.669035592383098, 'loss_val': 1.3630693418792321, 'psi': 0.33046302183172704}
[S4] START round=1 head_norm_before_train=1.205165 (no previous merge yet)
[S4] round=1 local utility u=0.713702 metrics={'f1_val': 0.3971736816246315, 'auprc': 0.8244906263355942, 'loss_val': 1.3394003873217868, 'psi': 0.5681004595090167}-{'f1_val': 0.3317190064727926, 'auprc': 0.4900482681530104, 'loss_val': 1.3707486132999394, 'psi': 0.3950507111448798}
[S5] START round=1 head_norm_before_train=1.120702 (no previous merge yet)
[S5] round=1 local utility u=0.015301 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7834880867517846, 'loss_val': 1.3068258245231625, 'psi': 0.3987523775578567}-{'f1_val': 0.14226190476190476, 'auprc': 0.7832343207733667, 'loss_val': 1.336666782639572, 'psi': 0.39865087116648956}
[S6] START round=1 head_norm_before_train=1.156737 (no previous merge yet)
[S6] round=1 local utility u=0.043266 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6568749515145945, 'loss_val': 1.3198882498569995, 'psi': 0.347605749836607}-{'f1_val': 0.14202373767853552, 'auprc': 0.6367242391289589, 'loss_val': 1.3495531612085037, 'psi': 0.33990393825870485}
[S7] START round=1 head_norm_before_train=1.102143 (no previous merge yet)
[S7] round=1 local utility u=0.018134 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7772167689046093, 'loss_val': 1.3125917587800402, 'psi': 0.39612080119929877}-{'f1_val': 0.14205682272909165, 'auprc': 0.7754865921934964, 'loss_val': 1.3436694147962087, 'psi': 0.39542873051485355}
[S8] START round=1 head_norm_before_train=1.160960 (no previous merge yet)
[S8] round=1 local utility u=0.320452 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.6122815462776552, 'loss_val': 1.3066312634868653, 'psi': 0.3288862079468364}-{'f1_val': 0.13995598239295717, 'auprc': 0.4100245933882469, 'loss_val': 1.3407638665735298, 'psi': 0.2479834267910731}
[S9] START round=1 head_norm_before_train=1.152973 (no previous merge yet)
[S9] round=1 local utility u=0.193780 metrics={'f1_val': 0.141397957139996, 'auprc': 0.972608430514915, 'loss_val': 1.3366169050681957, 'psi': 0.47388214648996363}-{'f1_val': 0.141397957139996, 'auprc': 0.8560579293564625, 'loss_val': 1.3745245842455982, 'psi': 0.42726194602658263}
[S10] START round=1 head_norm_before_train=1.194702 (no previous merge yet)
[S10] round=1 local utility u=0.435776 metrics={'f1_val': 0.18670550847457626, 'auprc': 0.7748204458432374, 'loss_val': 1.3248325464021429, 'psi': 0.4219514834220407}-{'f1_val': 0.10265544041450778, 'auprc': 0.6619257625335152, 'loss_val': 1.3533992345683143, 'psi': 0.32636356926211074}
[S11] START round=1 head_norm_before_train=1.186436 (no previous merge yet)
[S11] round=1 local utility u=0.229665 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.5123751502868635, 'loss_val': 1.330738129650376, 'psi': 0.28919827013861177}-{'f1_val': 0.14041368337311058, 'auprc': 0.3694636342236843, 'loss_val': 1.3613340488942636, 'psi': 0.23203366371334005}
[S13] START round=1 head_norm_before_train=1.168742 (no previous merge yet)
[S13] round=1 local utility u=0.129649 metrics={'f1_val': 0.09037372593431484, 'auprc': 0.6545927353371238, 'loss_val': 1.3593676880459398, 'psi': 0.31606132969543843}-{'f1_val': 0.09037372593431484, 'auprc': 0.5789575442321443, 'loss_val': 1.391760234303944, 'psi': 0.28580725325344664}
[S14] START round=1 head_norm_before_train=1.249943 (no previous merge yet)
[S14] round=1 local utility u=0.010420 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8737406404342613, 'loss_val': 1.313134291381113, 'psi': 0.43371096790332675}-{'f1_val': 0.14035785288270378, 'auprc': 0.8748480980389941, 'loss_val': 1.337295673526015, 'psi': 0.4341539509452199}
[S15] START round=1 head_norm_before_train=1.146831 (no previous merge yet)
[S15] round=1 local utility u=0.579859 metrics={'f1_val': 0.17347165567823886, 'auprc': 0.696191779592323, 'loss_val': 1.3496025367607758, 'psi': 0.38255970524387256}-{'f1_val': 0.10879474697512796, 'auprc': 0.4489720754950288, 'loss_val': 1.3796004077450685, 'psi': 0.24486567838308831}
[S16] START round=1 head_norm_before_train=1.110764 (no previous merge yet)
[S16] round=1 local utility u=0.428818 metrics={'f1_val': 0.41597941906291047, 'auprc': 0.6278916879582376, 'loss_val': 1.3330850010166826, 'psi': 0.5007443266210413}-{'f1_val': 0.2913283926138309, 'auprc': 0.602041201319048, 'loss_val': 1.3652637901784426, 'psi': 0.4156135160959178}
[S17] START round=1 head_norm_before_train=1.148158 (no previous merge yet)
[S17] round=1 local utility u=0.089023 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.7147245338452473, 'loss_val': 1.327717160196524, 'psi': 0.3704591915285295}-{'f1_val': 0.14094896331738438, 'auprc': 0.6638108331414272, 'loss_val': 1.3530217418109685, 'psi': 0.3500937112470015}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:63208
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S8] → sending delta(kind=head bytes=1791) to S10@127.0.0.1:63211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S7] → sending delta(kind=head bytes=1789) to S5@127.0.0.1:63205
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S4] → sending delta(kind=head bytes=1788) to S10@127.0.0.1:63211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S3] → sending delta(kind=head bytes=1791) to S10@127.0.0.1:63211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S2] → sending delta(kind=head bytes=1787) to S7@127.0.0.1:63208
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S11] → sending delta(kind=head bytes=1791) to S4@127.0.0.1:63204
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S6] → sending delta(kind=head bytes=1792) to S5@127.0.0.1:63205
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:63211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S13] → sending delta(kind=head bytes=1787) to S4@127.0.0.1:63204
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1785 reason=None
[S16] → sending delta(kind=head bytes=1785) to S7@127.0.0.1:63208
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S10] → sending delta(kind=head bytes=1788) to S8@127.0.0.1:63209
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S9] → sending delta(kind=head bytes=1789) to S6@127.0.0.1:63207
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:63212
[S13] sending update (kind=head size=1787 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S9] sending update (kind=head size=1789 to 1 peers)
[S2] sending update (kind=head size=1787 to 1 peers)
[S4] sending update (kind=head size=1788 to 1 peers)
[S6] sending update (kind=head size=1792 to 1 peers)
[S10] sending update (kind=head size=1788 to 1 peers)
[S11] sending update (kind=head size=1791 to 1 peers)
[S7] sending update (kind=head size=1789 to 1 peers)
[S14] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1791 to 1 peers)
[S3] sending update (kind=head size=1791 to 1 peers)
[S16] sending update (kind=head size=1785 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1788) from S4
[S10] cosine check vs S4: cos=-0.0244
[S10] DROPPED delta from S4 (cos=-0.0244 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1791) from S8
[S10] cosine check vs S8: cos=0.0273
[S7] RECEIVED delta(kind=head bytes=1787) from S2
[S7] cosine check vs S2: cos=-0.0181
[S7] DROPPED delta from S2 (cos=-0.0181 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1796) from S5
[S11] cosine check vs S5: cos=0.0706
[S5] RECEIVED delta(kind=head bytes=1789) from S7
[S5] cosine check vs S7: cos=-0.0102
[S5] DROPPED delta from S7 (cos=-0.0102 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1788) from S10
[S8] cosine check vs S10: cos=0.0273
[S5] RECEIVED delta(kind=head bytes=1792) from S6
[S5] cosine check vs S6: cos=-0.0054
[S5] DROPPED delta from S6 (cos=-0.0054 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1795) from S14
[S7] cosine check vs S14: cos=0.0585
[S4] RECEIVED delta(kind=head bytes=1787) from S13
[S4] cosine check vs S13: cos=-0.1279
[S4] DROPPED delta from S13 (cos=-0.1279 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1791) from S3
[S10] cosine check vs S3: cos=-0.0767
[S10] DROPPED delta from S3 (cos=-0.0767 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1795) from S15
[S10] cosine check vs S15: cos=-0.0272
[S10] DROPPED delta from S15 (cos=-0.0272 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1789) from S9
[S6] cosine check vs S9: cos=0.0074
[S7] RECEIVED delta(kind=head bytes=1785) from S16
[S7] cosine check vs S16: cos=0.0045
[S4] RECEIVED delta(kind=head bytes=1791) from S11
[S4] cosine check vs S11: cos=-0.0843
[S4] DROPPED delta from S11 (cos=-0.0843 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S17] → sending delta(kind=head bytes=1791) to S7@127.0.0.1:63208
[S17] sending update (kind=head size=1791 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1791) from S17
[S7] cosine check vs S17: cos=-0.0367
[S7] DROPPED delta from S17 (cos=-0.0367 < 0.0)
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=1 metric=0.1421 head_norm=1.116336
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.767289e-01
[S7] stored merged vector for next round verification (round=1)
[S7] DEBUG after merge:  round=1 metric=0.1421 head_norm=0.708685 delta_norm=0.676729
[S7] aggregate: ACCEPT kept=['S14', 'S16'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=1 metric=0.1400 head_norm=1.176879
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.332922e-01
[S8] stored merged vector for next round verification (round=1)
[S8] DEBUG after merge:  round=1 metric=0.1400 head_norm=0.856311 delta_norm=0.833292
[S8] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=1 metric=0.1414 head_norm=1.172877
[S6] _apply_head_vector_avg (torch): Δ‖w‖=8.226637e-01
[S6] stored merged vector for next round verification (round=1)
[S6] DEBUG after merge:  round=1 metric=0.1414 head_norm=0.828781 delta_norm=0.822664
[S6] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=1 metric=0.1404 head_norm=1.189775
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.929442e-01
[S11] stored merged vector for next round verification (round=1)
[S11] DEBUG after merge:  round=1 metric=0.1404 head_norm=0.850987 delta_norm=0.792944
[S11] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=1 metric=0.1867 head_norm=1.212537
[S10] _apply_head_vector_avg (torch): Δ‖w‖=8.332921e-01
[S10] stored merged vector for next round verification (round=1)
[S10] DEBUG after merge:  round=1 metric=0.1386 head_norm=0.856311 delta_norm=0.833292
[S10] aggregate: ROLLBACK (f1_val pre=0.187 post=0.139 tol_abs=0.005 tol_rel=0.0)
[S2] START round=2 head_norm_before_train=1.179867 (no previous merge yet)
[S2] round=2 local utility u=0.020734 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7714057530471882, 'loss_val': 1.2865259913451281, 'psi': 0.39362858125201533}-{'f1_val': 0.1417771333885667, 'auprc': 0.768721391307418, 'loss_val': 1.3199418105910816, 'psi': 0.3925548365561073}
[S3] START round=2 head_norm_before_train=1.209901 (no previous merge yet)
[S3] round=2 local utility u=0.000000 metrics={'f1_val': 0.17235726342299862, 'auprc': 0.9621312984789707, 'loss_val': 1.276334423327328, 'psi': 0.4882668774453875}-{'f1_val': 0.40071406678232513, 'auprc': 0.8743977620326552, 'loss_val': 1.3259783117746453, 'psi': 0.5901875448824572}
[S4] START round=2 head_norm_before_train=1.213754 (no previous merge yet)
[S4] round=2 local utility u=0.000000 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7735543807909978, 'loss_val': 1.3007769815048806, 'psi': 0.3935577296535096}-{'f1_val': 0.3971736816246315, 'auprc': 0.8244906263355942, 'loss_val': 1.3394003873217868, 'psi': 0.5681004595090167}
[S5] START round=2 head_norm_before_train=1.135920 (no previous merge yet)
[S5] round=2 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7713250108494816, 'loss_val': 1.2727739083300598, 'psi': 0.3938871471969355}-{'f1_val': 0.14226190476190476, 'auprc': 0.7834880867517846, 'loss_val': 1.3068258245231625, 'psi': 0.3987523775578567}
[S6] START round=2 head_norm_before_train=0.828781 cos_to_last_merge=1.0000 (last merge round=1)
[S6] round=2 local utility u=0.002684 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6614931297985541, 'loss_val': 1.3283756613399282, 'psi': 0.3494530211501909}-{'f1_val': 0.14142628205128205, 'auprc': 0.6568749515145945, 'loss_val': 1.3198882498569995, 'psi': 0.347605749836607}
[S7] START round=2 head_norm_before_train=0.708685 cos_to_last_merge=1.0000 (last merge round=1)
[S7] round=2 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.777607415540097, 'loss_val': 1.3170096528428126, 'psi': 0.3962770598534938}-{'f1_val': 0.14205682272909165, 'auprc': 0.7772167689046093, 'loss_val': 1.3125917587800402, 'psi': 0.39612080119929877}
[S8] START round=2 head_norm_before_train=0.856311 cos_to_last_merge=1.0000 (last merge round=1)
[S8] round=2 local utility u=0.233151 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7661288456704172, 'loss_val': 1.3018715102845002, 'psi': 0.3904251277039412}-{'f1_val': 0.13995598239295717, 'auprc': 0.6122815462776552, 'loss_val': 1.3066312634868653, 'psi': 0.3288862079468364}
[S9] START round=2 head_norm_before_train=1.162612 (no previous merge yet)
[S9] round=2 local utility u=0.055892 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9948203404823085, 'loss_val': 1.2914685806254929, 'psi': 0.48276691047692105}-{'f1_val': 0.141397957139996, 'auprc': 0.972608430514915, 'loss_val': 1.3366169050681957, 'psi': 0.47388214648996363}
[S10] START round=2 head_norm_before_train=0.856311 cos_to_last_merge=1.0000 (last merge round=1)
[S10] round=2 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.5857698843487067, 'loss_val': 1.3195702043216495, 'psi': 0.317480936264517}-{'f1_val': 0.18670550847457626, 'auprc': 0.7748204458432374, 'loss_val': 1.3248325464021429, 'psi': 0.4219514834220407}
[S11] START round=2 head_norm_before_train=0.850987 cos_to_last_merge=1.0000 (last merge round=1)
[S11] round=2 local utility u=0.194292 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.6410412299390496, 'loss_val': 1.3281524334099157, 'psi': 0.3406647019994862}-{'f1_val': 0.14041368337311058, 'auprc': 0.5123751502868635, 'loss_val': 1.330738129650376, 'psi': 0.28919827013861177}
[S13] START round=2 head_norm_before_train=1.179559 (no previous merge yet)
[S13] round=2 local utility u=0.781329 metrics={'f1_val': 0.4156839344320697, 'auprc': 0.5131759155779761, 'loss_val': 1.324320742757408, 'psi': 0.45468072689043226}-{'f1_val': 0.09037372593431484, 'auprc': 0.6545927353371238, 'loss_val': 1.3593676880459398, 'psi': 0.31606132969543843}
[S14] START round=2 head_norm_before_train=1.269392 (no previous merge yet)
[S14] round=2 local utility u=0.014285 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8732778433544204, 'loss_val': 1.283176374329551, 'psi': 0.4335258490713904}-{'f1_val': 0.14035785288270378, 'auprc': 0.8737406404342613, 'loss_val': 1.313134291381113, 'psi': 0.43371096790332675}
[S15] START round=2 head_norm_before_train=1.153646 (no previous merge yet)
[S15] round=2 local utility u=0.000000 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7255270285223755, 'loss_val': 1.3162121496655363, 'psi': 0.3740510022258852}-{'f1_val': 0.17347165567823886, 'auprc': 0.696191779592323, 'loss_val': 1.3496025367607758, 'psi': 0.38255970524387256}
[S16] START round=2 head_norm_before_train=1.119884 (no previous merge yet)
[S16] round=2 local utility u=0.000000 metrics={'f1_val': 0.19437409812409812, 'auprc': 0.8156264627062029, 'loss_val': 1.291190489442031, 'psi': 0.44287504395694005}-{'f1_val': 0.41597941906291047, 'auprc': 0.6278916879582376, 'loss_val': 1.3330850010166826, 'psi': 0.5007443266210413}
[S17] START round=2 head_norm_before_train=1.164731 (no previous merge yet)
[S17] round=2 local utility u=0.096557 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.7687731660414331, 'loss_val': 1.296749012198287, 'psi': 0.3920786444070039}-{'f1_val': 0.14094896331738438, 'auprc': 0.7147245338452473, 'loss_val': 1.327717160196524, 'psi': 0.3704591915285295}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] → sending delta(kind=head bytes=1794) to S6@127.0.0.1:63207
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:63212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1785 reason=None
[S13] → sending delta(kind=head bytes=1785) to S7@127.0.0.1:63208
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1783 reason=None
[S9] → sending delta(kind=head bytes=1783) to S4@127.0.0.1:63204
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:63202
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S6] → sending delta(kind=head bytes=1789) to S9@127.0.0.1:63210
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S14] → sending delta(kind=head bytes=1792) to S3@127.0.0.1:63203
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:63214
[S14] sending update (kind=head size=1792 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1785 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S9] sending update (kind=head size=1783 to 1 peers)
[S6] sending update (kind=head size=1789 to 1 peers)
[S2] sending update (kind=head size=1794 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1792) from S14
[S3] cosine check vs S14: cos=-0.0381
[S3] DROPPED delta from S14 (cos=-0.0381 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1783) from S9
[S4] cosine check vs S9: cos=0.1126
[S6] RECEIVED delta(kind=head bytes=1794) from S2
[S6] cosine check vs S2: cos=0.0221
[S9] RECEIVED delta(kind=head bytes=1789) from S6
[S9] cosine check vs S6: cos=0.6848
[S11] RECEIVED delta(kind=head bytes=1795) from S8
[S11] cosine check vs S8: cos=0.0067
[S7] RECEIVED delta(kind=head bytes=1785) from S13
[S7] cosine check vs S13: cos=-0.0184
[S7] DROPPED delta from S13 (cos=-0.0184 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1798) from S11
[S2] cosine check vs S11: cos=0.1236
[S17] sending update (kind=head size=1797 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1797) from S17
[S14] cosine check vs S17: cos=0.0319
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=2 metric=0.1402 head_norm=1.230875
[S4] _apply_head_vector_avg (torch): Δ‖w‖=8.036722e-01
[S4] stored merged vector for next round verification (round=2)
[S4] DEBUG after merge:  round=2 metric=0.1402 head_norm=0.899788 delta_norm=0.803672
[S4] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=2 metric=0.1414 head_norm=0.845566
[S6] _apply_head_vector_avg (torch): Δ‖w‖=7.265573e-01
[S6] stored merged vector for next round verification (round=2)
[S6] DEBUG after merge:  round=2 metric=0.1414 head_norm=0.741815 delta_norm=0.726557
[S6] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=2 metric=0.1404 head_norm=1.297517
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.663521e-01
[S14] stored merged vector for next round verification (round=2)
[S14] DEBUG after merge:  round=2 metric=0.1404 head_norm=0.894327 delta_norm=0.866352
[S14] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=2 metric=0.1418 head_norm=1.200570
[S2] _apply_head_vector_avg (torch): Δ‖w‖=6.941429e-01
[S2] stored merged vector for next round verification (round=2)
[S2] DEBUG after merge:  round=2 metric=0.1418 head_norm=0.780777 delta_norm=0.694143
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=2 metric=0.1404 head_norm=0.861120
[S11] _apply_head_vector_avg (torch): Δ‖w‖=6.124571e-01
[S11] stored merged vector for next round verification (round=2)
[S11] DEBUG after merge:  round=2 metric=0.1404 head_norm=0.616548 delta_norm=0.612457
[S11] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=2 metric=0.1414 head_norm=1.181508
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.308777e-01
[S9] stored merged vector for next round verification (round=2)
[S9] DEBUG after merge:  round=2 metric=0.1414 head_norm=0.932639 delta_norm=0.430878
[S9] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=3 head_norm_before_train=0.780777 cos_to_last_merge=1.0000 (last merge round=2)
[S2] round=3 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6557323124181131, 'loss_val': 1.2710536652379207, 'psi': 0.3473592050003853}-{'f1_val': 0.1417771333885667, 'auprc': 0.7714057530471882, 'loss_val': 1.2865259913451281, 'psi': 0.39362858125201533}
[S3] START round=3 head_norm_before_train=1.237045 (no previous merge yet)
[S3] round=3 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8172936939047046, 'loss_val': 1.2096926117456857, 'psi': 0.4108215169303461}-{'f1_val': 0.17235726342299862, 'auprc': 0.9621312984789707, 'loss_val': 1.276334423327328, 'psi': 0.4882668774453875}
[S4] START round=3 head_norm_before_train=0.899788 cos_to_last_merge=1.0000 (last merge round=2)
[S4] round=3 local utility u=0.010199 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7810021511310281, 'loss_val': 1.3027217465722196, 'psi': 0.39653683778952176}-{'f1_val': 0.14022662889518414, 'auprc': 0.7735543807909978, 'loss_val': 1.3007769815048806, 'psi': 0.3935577296535096}
[S5] START round=3 head_norm_before_train=1.155131 (no previous merge yet)
[S5] round=3 local utility u=0.030329 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7770758887689958, 'loss_val': 1.2293682605580802, 'psi': 0.3961874983647412}-{'f1_val': 0.14226190476190476, 'auprc': 0.7713250108494816, 'loss_val': 1.2727739083300598, 'psi': 0.3938871471969355}
[S6] START round=3 head_norm_before_train=0.741815 cos_to_last_merge=1.0000 (last merge round=2)
[S6] round=3 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6425763103040154, 'loss_val': 1.3072035108896727, 'psi': 0.34188629335237536}-{'f1_val': 0.14142628205128205, 'auprc': 0.6614931297985541, 'loss_val': 1.3283756613399282, 'psi': 0.3494530211501909}
[S7] START round=3 head_norm_before_train=0.729799 cos_to_last_merge=0.9951 (last merge round=1)
[S7] round=3 local utility u=0.015947 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7776961012362237, 'loss_val': 1.2853812922929477, 'psi': 0.3963125341319445}-{'f1_val': 0.14205682272909165, 'auprc': 0.777607415540097, 'loss_val': 1.3170096528428126, 'psi': 0.3962770598534938}
[S8] START round=3 head_norm_before_train=0.876895 cos_to_last_merge=0.9968 (last merge round=1)
[S8] round=3 local utility u=0.021491 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7665383097279008, 'loss_val': 1.2601179935472442, 'psi': 0.3905889133269347}-{'f1_val': 0.13995598239295717, 'auprc': 0.7661288456704172, 'loss_val': 1.3018715102845002, 'psi': 0.3904251277039412}
[S9] START round=3 head_norm_before_train=0.932639 cos_to_last_merge=1.0000 (last merge round=2)
[S9] round=3 local utility u=0.024813 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9997844861066579, 'loss_val': 1.2567346239267878, 'psi': 0.4847525687266608}-{'f1_val': 0.141397957139996, 'auprc': 0.9948203404823085, 'loss_val': 1.2914685806254929, 'psi': 0.48276691047692105}
[S10] START round=3 head_norm_before_train=0.878485 cos_to_last_merge=0.9972 (last merge round=1)
[S10] round=3 local utility u=0.039266 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6009413955200011, 'loss_val': 1.286552038294764, 'psi': 0.3235495407330348}-{'f1_val': 0.13862163754172394, 'auprc': 0.5857698843487067, 'loss_val': 1.3195702043216495, 'psi': 0.317480936264517}
[S11] START round=3 head_norm_before_train=0.616548 cos_to_last_merge=1.0000 (last merge round=2)
[S11] round=3 local utility u=0.195519 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7710580025756342, 'loss_val': 1.3271646505923298, 'psi': 0.39267141105412}-{'f1_val': 0.14041368337311058, 'auprc': 0.6410412299390496, 'loss_val': 1.3281524334099157, 'psi': 0.3406647019994862}
[S13] START round=3 head_norm_before_train=1.197760 (no previous merge yet)
[S13] round=3 local utility u=0.000000 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5049016435885703, 'loss_val': 1.2770854899033925, 'psi': 0.28619211498166}-{'f1_val': 0.4156839344320697, 'auprc': 0.5131759155779761, 'loss_val': 1.324320742757408, 'psi': 0.45468072689043226}
[S14] START round=3 head_norm_before_train=0.894327 cos_to_last_merge=1.0000 (last merge round=2)
[S14] round=3 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8020678773874402, 'loss_val': 1.287062779845773, 'psi': 0.40504186268459835}-{'f1_val': 0.14035785288270378, 'auprc': 0.8732778433544204, 'loss_val': 1.283176374329551, 'psi': 0.4335258490713904}
[S15] START round=3 head_norm_before_train=1.169200 (no previous merge yet)
[S15] round=3 local utility u=0.041112 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7404700302931967, 'loss_val': 1.2788180445904231, 'psi': 0.3800282029342137}-{'f1_val': 0.13973365136155833, 'auprc': 0.7255270285223755, 'loss_val': 1.3162121496655363, 'psi': 0.3740510022258852}
[S16] START round=3 head_norm_before_train=1.142427 (no previous merge yet)
[S16] round=3 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8338536434757073, 'loss_val': 1.2378461413689366, 'psi': 0.4179239275098049}-{'f1_val': 0.19437409812409812, 'auprc': 0.8156264627062029, 'loss_val': 1.291190489442031, 'psi': 0.44287504395694005}
[S17] START round=3 head_norm_before_train=1.190472 (no previous merge yet)
[S17] round=3 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.7488619550960072, 'loss_val': 1.2517445009349453, 'psi': 0.38411416002883353}-{'f1_val': 0.14094896331738438, 'auprc': 0.7687731660414331, 'loss_val': 1.296749012198287, 'psi': 0.3920786444070039}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S7] → sending delta(kind=head bytes=1793) to S3@127.0.0.1:63203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:63213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:63215
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:63205
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S4] → sending delta(kind=head bytes=1792) to S7@127.0.0.1:63208
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:63203
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S9] → sending delta(kind=head bytes=1791) to S5@127.0.0.1:63205
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S2@127.0.0.1:63202
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1794 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1792 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1793 to 1 peers)
[S9] sending update (kind=head size=1791 to 1 peers)
[S7] sending update (kind=head size=1793 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1802) from S10
[S5] cosine check vs S10: cos=0.0121
[S3] RECEIVED delta(kind=head bytes=1794) from S5
[S3] cosine check vs S5: cos=-0.0231
[S3] DROPPED delta from S5 (cos=-0.0231 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1793) from S7
[S3] cosine check vs S7: cos=0.0498
[S15] RECEIVED delta(kind=head bytes=1797) from S11
[S15] cosine check vs S11: cos=-0.0151
[S15] DROPPED delta from S11 (cos=-0.0151 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1791) from S9
[S5] cosine check vs S9: cos=0.1088
[S2] RECEIVED delta(kind=head bytes=1793) from S8
[S2] cosine check vs S8: cos=0.0434
[S7] RECEIVED delta(kind=head bytes=1792) from S4
[S7] cosine check vs S4: cos=-0.1655
[S7] DROPPED delta from S4 (cos=-0.1655 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1796) from S15
[S13] cosine check vs S15: cos=0.0520
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=3 metric=0.1404 head_norm=1.225219
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.325469e-01
[S13] stored merged vector for next round verification (round=3)
[S13] DEBUG after merge:  round=3 metric=0.1600 head_norm=0.876992 delta_norm=0.832547
[S13] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=3 metric=0.1398 head_norm=1.272671
[S3] _apply_head_vector_avg (torch): Δ‖w‖=7.245591e-01
[S3] stored merged vector for next round verification (round=3)
[S3] DEBUG after merge:  round=3 metric=0.1398 head_norm=0.757058 delta_norm=0.724559
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=3 metric=0.1418 head_norm=0.812576
[S2] _apply_head_vector_avg (torch): Δ‖w‖=5.956945e-01
[S2] stored merged vector for next round verification (round=3)
[S2] DEBUG after merge:  round=3 metric=0.1418 head_norm=0.621953 delta_norm=0.595694
[S2] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=3 metric=0.1423 head_norm=1.182304
[S5] _apply_head_vector_avg (torch): Δ‖w‖=6.561289e-01
[S5] stored merged vector for next round verification (round=3)
[S5] DEBUG after merge:  round=3 metric=0.1423 head_norm=0.706267 delta_norm=0.656129
[S5] aggregate: ACCEPT kept=['S10', 'S9'] (k=2/2) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=0.621953 cos_to_last_merge=1.0000 (last merge round=3)
[S2] round=4 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6188843804796267, 'loss_val': 1.263045301146498, 'psi': 0.3326200322249907}-{'f1_val': 0.1417771333885667, 'auprc': 0.6557323124181131, 'loss_val': 1.2710536652379207, 'psi': 0.3473592050003853}
[S3] START round=4 head_norm_before_train=0.757058 cos_to_last_merge=1.0000 (last merge round=3)
[S3] round=4 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.6638236318928222, 'loss_val': 1.2143516010446496, 'psi': 0.34943349212559316}-{'f1_val': 0.13984006561410703, 'auprc': 0.8172936939047046, 'loss_val': 1.2096926117456857, 'psi': 0.4108215169303461}
[S4] START round=4 head_norm_before_train=0.915503 cos_to_last_merge=0.9971 (last merge round=2)
[S4] round=4 local utility u=0.031090 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7799657012460577, 'loss_val': 1.2374327628732702, 'psi': 0.39612225783553356}-{'f1_val': 0.14022662889518414, 'auprc': 0.7810021511310281, 'loss_val': 1.3027217465722196, 'psi': 0.39653683778952176}
[S5] START round=4 head_norm_before_train=0.706267 cos_to_last_merge=1.0000 (last merge round=3)
[S5] round=4 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7700728824705177, 'loss_val': 1.2373778251925331, 'psi': 0.39338629584534995}-{'f1_val': 0.14226190476190476, 'auprc': 0.7770758887689958, 'loss_val': 1.2293682605580802, 'psi': 0.3961874983647412}
[S6] START round=4 head_norm_before_train=0.764201 cos_to_last_merge=0.9953 (last merge round=2)
[S6] round=4 local utility u=0.126311 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.7129607468077934, 'loss_val': 1.2657340997287472, 'psi': 0.3700400679538866}-{'f1_val': 0.14142628205128205, 'auprc': 0.6425763103040154, 'loss_val': 1.3072035108896727, 'psi': 0.34188629335237536}
[S7] START round=4 head_norm_before_train=0.759310 cos_to_last_merge=0.9823 (last merge round=1)
[S7] round=4 local utility u=0.011973 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7777676564504318, 'loss_val': 1.2616495658061908, 'psi': 0.3963411562176277}-{'f1_val': 0.14205682272909165, 'auprc': 0.7776961012362237, 'loss_val': 1.2853812922929477, 'psi': 0.3963125341319445}
[S8] START round=4 head_norm_before_train=0.907236 cos_to_last_merge=0.9888 (last merge round=1)
[S8] round=4 local utility u=0.034772 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7722160953464314, 'loss_val': 1.207607577523476, 'psi': 0.3928600275743469}-{'f1_val': 0.13995598239295717, 'auprc': 0.7665383097279008, 'loss_val': 1.2601179935472442, 'psi': 0.3905889133269347}
[S9] START round=4 head_norm_before_train=0.960639 cos_to_last_merge=0.9971 (last merge round=2)
[S9] round=4 local utility u=0.033637 metrics={'f1_val': 0.141397957139996, 'auprc': 0.99950172548011, 'loss_val': 1.1886124212096814, 'psi': 0.4846394644760416}-{'f1_val': 0.141397957139996, 'auprc': 0.9997844861066579, 'loss_val': 1.2567346239267878, 'psi': 0.4847525687266608}
[S10] START round=4 head_norm_before_train=0.906991 cos_to_last_merge=0.9901 (last merge round=1)
[S10] round=4 local utility u=0.036147 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6029903109767147, 'loss_val': 1.2204038071044634, 'psi': 0.3243691069157203}-{'f1_val': 0.13862163754172394, 'auprc': 0.6009413955200011, 'loss_val': 1.286552038294764, 'psi': 0.3235495407330348}
[S11] START round=4 head_norm_before_train=0.630737 cos_to_last_merge=0.9946 (last merge round=2)
[S11] round=4 local utility u=0.039148 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7854306236285699, 'loss_val': 1.2919860064297723, 'psi': 0.3984204594752943}-{'f1_val': 0.14041368337311058, 'auprc': 0.7710580025756342, 'loss_val': 1.3271646505923298, 'psi': 0.39267141105412}
[S13] START round=4 head_norm_before_train=0.876992 cos_to_last_merge=1.0000 (last merge round=3)
[S13] round=4 local utility u=0.232395 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.6610236439235121, 'loss_val': 1.280660949240434, 'psi': 0.3486409151156367}-{'f1_val': 0.1403857625770531, 'auprc': 0.5049016435885703, 'loss_val': 1.2770854899033925, 'psi': 0.28619211498166}
[S14] START round=4 head_norm_before_train=0.925366 cos_to_last_merge=0.9973 (last merge round=2)
[S14] round=4 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7280309290348533, 'loss_val': 1.2245822016458423, 'psi': 0.3754270833435636}-{'f1_val': 0.14035785288270378, 'auprc': 0.8020678773874402, 'loss_val': 1.287062779845773, 'psi': 0.40504186268459835}
[S15] START round=4 head_norm_before_train=1.193036 (no previous merge yet)
[S15] round=4 local utility u=0.060007 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7701007852573862, 'loss_val': 1.2476972041904815, 'psi': 0.3918805049198895}-{'f1_val': 0.13973365136155833, 'auprc': 0.7404700302931967, 'loss_val': 1.2788180445904231, 'psi': 0.3800282029342137}
[S16] START round=4 head_norm_before_train=1.173653 (no previous merge yet)
[S16] round=4 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8136613619061626, 'loss_val': 1.1809086161100018, 'psi': 0.40984701488198694}-{'f1_val': 0.14063745019920318, 'auprc': 0.8338536434757073, 'loss_val': 1.2378461413689366, 'psi': 0.4179239275098049}
[S17] START round=4 head_norm_before_train=1.223371 (no previous merge yet)
[S17] round=4 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.6348013495219583, 'loss_val': 1.1809775007578809, 'psi': 0.33848991779921395}-{'f1_val': 0.14094896331738438, 'auprc': 0.7488619550960072, 'loss_val': 1.2517445009349453, 'psi': 0.38411416002883353}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:63202
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:63203
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:63213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:63208
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:63203
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S9] → sending delta(kind=head bytes=1790) to S5@127.0.0.1:63205
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] → sending delta(kind=head bytes=1793) to S15@127.0.0.1:63215
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S6] → sending delta(kind=head bytes=1806) to S13@127.0.0.1:63213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] → sending delta(kind=head bytes=1805) to S5@127.0.0.1:63205
[S7] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1790 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1806 to 1 peers)
[S11] sending update (kind=head size=1793 to 1 peers)
[S10] sending update (kind=head size=1805 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1805) from S10
[S5] cosine check vs S10: cos=0.3375
[S2] RECEIVED delta(kind=head bytes=1797) from S8
[S2] cosine check vs S8: cos=0.7277
[S13] RECEIVED delta(kind=head bytes=1806) from S6
[S13] cosine check vs S6: cos=-0.0313
[S13] DROPPED delta from S6 (cos=-0.0313 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1790) from S9
[S5] cosine check vs S9: cos=0.4383
[S3] RECEIVED delta(kind=head bytes=1797) from S7
[S3] cosine check vs S7: cos=0.5214
[S15] RECEIVED delta(kind=head bytes=1793) from S11
[S15] cosine check vs S11: cos=-0.0220
[S15] DROPPED delta from S11 (cos=-0.0220 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1801) from S4
[S7] cosine check vs S4: cos=-0.1704
[S7] DROPPED delta from S4 (cos=-0.1704 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1801) from S13
[S3] cosine check vs S13: cos=-0.0549
[S3] DROPPED delta from S13 (cos=-0.0549 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1802) from S15
[S13] cosine check vs S15: cos=0.6955
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=4 metric=0.1423 head_norm=0.739217
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.475274e-01
[S5] stored merged vector for next round verification (round=4)
[S5] DEBUG after merge:  round=4 metric=0.1423 head_norm=0.632933 delta_norm=0.347527
[S5] aggregate: ACCEPT kept=['S10', 'S9'] (k=2/2) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=4 metric=0.1398 head_norm=0.795021
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.860908e-01
[S3] stored merged vector for next round verification (round=4)
[S3] DEBUG after merge:  round=4 metric=0.1398 head_norm=0.688275 delta_norm=0.386091
[S3] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=4 metric=0.1418 head_norm=0.655890
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.235306e-01
[S2] stored merged vector for next round verification (round=4)
[S2] DEBUG after merge:  round=4 metric=0.1418 head_norm=0.744590 delta_norm=0.323531
[S2] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=4 metric=0.1404 head_norm=0.902539
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.377007e-01
[S13] stored merged vector for next round verification (round=4)
[S13] DEBUG after merge:  round=4 metric=0.1404 head_norm=0.977074 delta_norm=0.437701
[S13] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=5 head_norm_before_train=0.744590 cos_to_last_merge=1.0000 (last merge round=4)
[S2] round=5 local utility u=0.009516 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6175165465859582, 'loss_val': 1.2399092700938943, 'psi': 0.3320728986675233}-{'f1_val': 0.1417771333885667, 'auprc': 0.6188843804796267, 'loss_val': 1.263045301146498, 'psi': 0.3326200322249907}
[S3] START round=5 head_norm_before_train=0.688275 cos_to_last_merge=1.0000 (last merge round=4)
[S3] round=5 local utility u=0.200337 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.7959447822066427, 'loss_val': 1.2100413801079029, 'psi': 0.4022819522511213}-{'f1_val': 0.13984006561410703, 'auprc': 0.6638236318928222, 'loss_val': 1.2143516010446496, 'psi': 0.34943349212559316}
[S4] START round=5 head_norm_before_train=0.941834 cos_to_last_merge=0.9882 (last merge round=2)
[S4] round=5 local utility u=0.000000 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7211877642529392, 'loss_val': 1.150950505828477, 'psi': 0.37261108303828616}-{'f1_val': 0.14022662889518414, 'auprc': 0.7799657012460577, 'loss_val': 1.2374327628732702, 'psi': 0.39612225783553356}
[S5] START round=5 head_norm_before_train=0.632933 cos_to_last_merge=1.0000 (last merge round=4)
[S5] round=5 local utility u=0.011547 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7716279336699143, 'loss_val': 1.2189483931365424, 'psi': 0.39400831632510863}-{'f1_val': 0.14226190476190476, 'auprc': 0.7700728824705177, 'loss_val': 1.2373778251925331, 'psi': 0.39338629584534995}
[S6] START round=5 head_norm_before_train=0.796446 cos_to_last_merge=0.9836 (last merge round=2)
[S6] round=5 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6960564040757885, 'loss_val': 1.2391955852313603, 'psi': 0.36327833086108463}-{'f1_val': 0.14142628205128205, 'auprc': 0.7129607468077934, 'loss_val': 1.2657340997287472, 'psi': 0.3700400679538866}
[S7] START round=5 head_norm_before_train=0.783274 cos_to_last_merge=0.9708 (last merge round=1)
[S7] round=5 local utility u=0.014745 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7778224192591788, 'loss_val': 1.232323770951979, 'psi': 0.39636306134112653}-{'f1_val': 0.14205682272909165, 'auprc': 0.7777676564504318, 'loss_val': 1.2616495658061908, 'psi': 0.3963411562176277}
[S8] START round=5 head_norm_before_train=0.942327 cos_to_last_merge=0.9785 (last merge round=1)
[S8] round=5 local utility u=0.045013 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7769419022243576, 'loss_val': 1.1317583213382976, 'psi': 0.39475035032551736}-{'f1_val': 0.13995598239295717, 'auprc': 0.7722160953464314, 'loss_val': 1.207607577523476, 'psi': 0.3928600275743469}
[S9] START round=5 head_norm_before_train=0.998557 cos_to_last_merge=0.9896 (last merge round=2)
[S9] round=5 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.950763308912452, 'loss_val': 1.1007644221773198, 'psi': 0.4651440978489784}-{'f1_val': 0.141397957139996, 'auprc': 0.99950172548011, 'loss_val': 1.1886124212096814, 'psi': 0.4846394644760416}
[S10] START round=5 head_norm_before_train=0.946467 cos_to_last_merge=0.9789 (last merge round=1)
[S10] round=5 local utility u=0.065314 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6097842077058511, 'loss_val': 1.110156649200198, 'psi': 0.32708666560737476}-{'f1_val': 0.13862163754172394, 'auprc': 0.6029903109767147, 'loss_val': 1.2204038071044634, 'psi': 0.3243691069157203}
[S11] START round=5 head_norm_before_train=0.653585 cos_to_last_merge=0.9808 (last merge round=2)
[S11] round=5 local utility u=0.111168 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.8423551078449809, 'loss_val': 1.2404235651792686, 'psi': 0.4211902531618587}-{'f1_val': 0.14041368337311058, 'auprc': 0.7854306236285699, 'loss_val': 1.2919860064297723, 'psi': 0.3984204594752943}
[S13] START round=5 head_norm_before_train=0.977074 cos_to_last_merge=1.0000 (last merge round=4)
[S13] round=5 local utility u=0.026590 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.6719611550178868, 'loss_val': 1.260293229965579, 'psi': 0.35301591955338657}-{'f1_val': 0.1403857625770531, 'auprc': 0.6610236439235121, 'loss_val': 1.280660949240434, 'psi': 0.3486409151156367}
[S14] START round=5 head_norm_before_train=0.963107 cos_to_last_merge=0.9897 (last merge round=2)
[S14] round=5 local utility u=0.044883 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7305671880928631, 'loss_val': 1.1424251237233967, 'psi': 0.3764415869667675}-{'f1_val': 0.14035785288270378, 'auprc': 0.7280309290348533, 'loss_val': 1.2245822016458423, 'psi': 0.3754270833435636}
[S15] START round=5 head_norm_before_train=1.215704 (no previous merge yet)
[S15] round=5 local utility u=0.030089 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7770248738095317, 'loss_val': 1.208291528923326, 'psi': 0.3946501403407477}-{'f1_val': 0.13973365136155833, 'auprc': 0.7701007852573862, 'loss_val': 1.2476972041904815, 'psi': 0.3918805049198895}
[S16] START round=5 head_norm_before_train=1.209827 (no previous merge yet)
[S16] round=5 local utility u=0.834219 metrics={'f1_val': 0.4140870532610207, 'auprc': 0.7966901020403597, 'loss_val': 1.102254300143446, 'psi': 0.5671282727727563}-{'f1_val': 0.14063745019920318, 'auprc': 0.8136613619061626, 'loss_val': 1.1809086161100018, 'psi': 0.40984701488198694}
[S17] START round=5 head_norm_before_train=1.257457 (no previous merge yet)
[S17] round=5 local utility u=0.740608 metrics={'f1_val': 0.37500067319274677, 'auprc': 0.6159136491502989, 'loss_val': 1.047408961031484, 'psi': 0.4713658635757676}-{'f1_val': 0.14094896331738438, 'auprc': 0.6348013495219583, 'loss_val': 1.1809775007578809, 'psi': 0.33848991779921395}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:63205
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S7] → sending delta(kind=head bytes=1791) to S3@127.0.0.1:63203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:63215
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:63204
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:63212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:63203
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:63203
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:63213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:63211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:63202
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:63204
[S3] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1791 to 1 peers)
[S16] sending update (kind=head size=1795 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1797) from S2
[S4] cosine check vs S2: cos=-0.0413
[S4] DROPPED delta from S2 (cos=-0.0413 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1795) from S14
[S10] cosine check vs S14: cos=0.1018
[S3] RECEIVED delta(kind=head bytes=1791) from S7
[S3] cosine check vs S7: cos=0.8384
[S4] RECEIVED delta(kind=head bytes=1795) from S16
[S4] cosine check vs S16: cos=-0.0517
[S4] DROPPED delta from S16 (cos=-0.0517 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1798) from S5
[S3] cosine check vs S5: cos=0.0317
[S11] RECEIVED delta(kind=head bytes=1797) from S3
[S11] cosine check vs S3: cos=-0.0250
[S11] DROPPED delta from S3 (cos=-0.0250 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1796) from S13
[S3] cosine check vs S13: cos=-0.1061
[S3] DROPPED delta from S13 (cos=-0.1061 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1795) from S11
[S15] cosine check vs S11: cos=-0.0268
[S15] DROPPED delta from S11 (cos=-0.0268 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1803) from S10
[S5] cosine check vs S10: cos=0.5622
[S13] RECEIVED delta(kind=head bytes=1799) from S15
[S13] cosine check vs S15: cos=0.9270
[S2] RECEIVED delta(kind=head bytes=1797) from S8
[S2] cosine check vs S8: cos=0.9272
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:63202
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1798) from S17
[S2] cosine check vs S17: cos=0.1621
[S4] ⇄ pheromone p=0.392 → S7@127.0.0.1:63208
[S9] ⇄ pheromone p=0.358 → S5@127.0.0.1:63205
[S6] ⇄ pheromone p=0.352 → S13@127.0.0.1:63213
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=5 metric=0.1386 head_norm=0.987791
[S10] _apply_head_vector_avg (torch): Δ‖w‖=6.667914e-01
[S10] stored merged vector for next round verification (round=5)
[S10] DEBUG after merge:  round=5 metric=0.1386 head_norm=0.738499 delta_norm=0.666791
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.387 → S5@127.0.0.1:63205
[S11] ⇄ pheromone p=0.420 → S15@127.0.0.1:63215
[S2] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=5 metric=0.1418 head_norm=0.773672
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.468129e-01
[S2] stored merged vector for next round verification (round=5)
[S2] DEBUG after merge:  round=5 metric=0.1418 head_norm=0.742250 delta_norm=0.346813
[S2] aggregate: ACCEPT kept=['S8', 'S17'] (k=2/2) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.363 → S4@127.0.0.1:63204
[S16] ⇄ pheromone p=0.530 → S4@127.0.0.1:63204
[S7] ⇄ pheromone p=0.336 → S3@127.0.0.1:63203
[S8] ⇄ pheromone p=0.395 → S2@127.0.0.1:63202
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=5 metric=0.1404 head_norm=0.995857
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.443565e-01
[S13] stored merged vector for next round verification (round=5)
[S13] DEBUG after merge:  round=5 metric=0.1404 head_norm=1.096710 delta_norm=0.244357
[S13] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.461 → S3@127.0.0.1:63203
[S15] ⇄ pheromone p=0.396 → S13@127.0.0.1:63213
[S14] ⇄ pheromone p=0.339 → S10@127.0.0.1:63211
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=5 metric=0.1423 head_norm=0.662961
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.119664e-01
[S5] stored merged vector for next round verification (round=5)
[S5] DEBUG after merge:  round=5 metric=0.1423 head_norm=0.733422 delta_norm=0.411966
[S5] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.335 → S3@127.0.0.1:63203
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=5 metric=0.1398 head_norm=0.715363
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.750237e-01
[S3] stored merged vector for next round verification (round=5)
[S3] DEBUG after merge:  round=5 metric=0.1398 head_norm=0.569919 delta_norm=0.275024
[S3] aggregate: ACCEPT kept=['S7', 'S5'] (k=2/2) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.450 → S11@127.0.0.1:63212
[S17] ⇄ pheromone p=0.493 → S2@127.0.0.1:63202
[S2] START round=6 head_norm_before_train=0.742250 cos_to_last_merge=1.0000 (last merge round=5)
[S2] round=6 local utility u=0.156621 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7052189892241616, 'loss_val': 1.1897739610454994, 'psi': 0.36715387572280467}-{'f1_val': 0.1417771333885667, 'auprc': 0.6175165465859582, 'loss_val': 1.2399092700938943, 'psi': 0.3320728986675233}
[S3] START round=6 head_norm_before_train=0.569919 cos_to_last_merge=1.0000 (last merge round=5)
[S3] round=6 local utility u=0.015971 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.7961477413474249, 'loss_val': 1.1787073309234817, 'psi': 0.4023631359074342}-{'f1_val': 0.13984006561410703, 'auprc': 0.7959447822066427, 'loss_val': 1.2100413801079029, 'psi': 0.4022819522511213}
[S4] START round=6 head_norm_before_train=0.976262 cos_to_last_merge=0.9747 (last merge round=2)
[S4] round=6 local utility u=1.000000 metrics={'f1_val': 0.4902122768538778, 'auprc': 0.7755725637956412, 'loss_val': 1.0282552941345462, 'psi': 0.6043563916305832}-{'f1_val': 0.14022662889518414, 'auprc': 0.7211877642529392, 'loss_val': 1.150950505828477, 'psi': 0.37261108303828616}
[S5] START round=6 head_norm_before_train=0.733422 cos_to_last_merge=1.0000 (last merge round=5)
[S5] round=6 local utility u=0.015856 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.77340377676659, 'loss_val': 1.1925633284714268, 'psi': 0.3947186535637789}-{'f1_val': 0.14226190476190476, 'auprc': 0.7716279336699143, 'loss_val': 1.2189483931365424, 'psi': 0.39400831632510863}
[S6] START round=6 head_norm_before_train=0.828153 cos_to_last_merge=0.9701 (last merge round=2)
[S6] round=6 local utility u=0.132951 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.7638697226607795, 'loss_val': 1.1767329628202357, 'psi': 0.390403658295081}-{'f1_val': 0.14142628205128205, 'auprc': 0.6960564040757885, 'loss_val': 1.2391955852313603, 'psi': 0.36327833086108463}
[S7] START round=6 head_norm_before_train=0.805752 cos_to_last_merge=0.9599 (last merge round=1)
[S7] round=6 local utility u=0.023000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7768215358838912, 'loss_val': 1.1833202149712538, 'psi': 0.3959627079910115}-{'f1_val': 0.14205682272909165, 'auprc': 0.7778224192591788, 'loss_val': 1.232323770951979, 'psi': 0.39636306134112653}
[S8] START round=6 head_norm_before_train=0.973789 cos_to_last_merge=0.9691 (last merge round=1)
[S8] round=6 local utility u=1.000000 metrics={'f1_val': 0.715097844268966, 'auprc': 0.7770057923810686, 'loss_val': 1.012890131280622, 'psi': 0.739861023513807}-{'f1_val': 0.13995598239295717, 'auprc': 0.7769419022243576, 'loss_val': 1.1317583213382976, 'psi': 0.39475035032551736}
[S9] START round=6 head_norm_before_train=1.041488 cos_to_last_merge=0.9801 (last merge round=2)
[S9] round=6 local utility u=0.945046 metrics={'f1_val': 0.39849358979305904, 'auprc': 0.9999110800047113, 'loss_val': 0.9006887116699809, 'psi': 0.63906058587772}-{'f1_val': 0.141397957139996, 'auprc': 0.950763308912452, 'loss_val': 1.1007644221773198, 'psi': 0.4651440978489784}
[S10] START round=6 head_norm_before_train=0.738499 cos_to_last_merge=1.0000 (last merge round=5)
[S10] round=6 local utility u=0.870401 metrics={'f1_val': 0.41725894337834635, 'auprc': 0.6097748103901489, 'loss_val': 1.0411500057232344, 'psi': 0.4942652901830674}-{'f1_val': 0.13862163754172394, 'auprc': 0.6097842077058511, 'loss_val': 1.110156649200198, 'psi': 0.32708666560737476}
[S11] START round=6 head_norm_before_train=0.688138 cos_to_last_merge=0.9594 (last merge round=2)
[S11] round=6 local utility u=0.081436 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.8772542299807738, 'loss_val': 1.1822488147619952, 'psi': 0.4351499020161759}-{'f1_val': 0.14041368337311058, 'auprc': 0.8423551078449809, 'loss_val': 1.2404235651792686, 'psi': 0.4211902531618587}
[S13] START round=6 head_norm_before_train=1.096710 cos_to_last_merge=1.0000 (last merge round=5)
[S13] round=6 local utility u=0.058053 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.6930353859719467, 'loss_val': 1.207410377616896, 'psi': 0.3614456119350105}-{'f1_val': 0.1403857625770531, 'auprc': 0.6719611550178868, 'loss_val': 1.260293229965579, 'psi': 0.35301591955338657}
[S14] START round=6 head_norm_before_train=1.002123 cos_to_last_merge=0.9804 (last merge round=2)
[S14] round=6 local utility u=0.943685 metrics={'f1_val': 0.39659360338126215, 'auprc': 0.8010415386095668, 'loss_val': 1.0038920089218903, 'psi': 0.5583727774725841}-{'f1_val': 0.14035785288270378, 'auprc': 0.7305671880928631, 'loss_val': 1.1424251237233967, 'psi': 0.3764415869667675}
[S15] START round=6 head_norm_before_train=1.238239 (no previous merge yet)
[S15] round=6 local utility u=0.855065 metrics={'f1_val': 0.4161838404121786, 'auprc': 0.7770545605664709, 'loss_val': 1.1569517463030794, 'psi': 0.5605321284738956}-{'f1_val': 0.13973365136155833, 'auprc': 0.7770248738095317, 'loss_val': 1.208291528923326, 'psi': 0.3946501403407477}
[S16] START round=6 head_norm_before_train=1.241843 (no previous merge yet)
[S16] round=6 local utility u=0.000000 metrics={'f1_val': 0.4170395601558466, 'auprc': 0.7438910318182602, 'loss_val': 0.9997217653431136, 'psi': 0.547780148820812}-{'f1_val': 0.4140870532610207, 'auprc': 0.7966901020403597, 'loss_val': 1.102254300143446, 'psi': 0.5671282727727563}
[S17] START round=6 head_norm_before_train=1.298244 (no previous merge yet)
[S17] round=6 local utility u=0.388548 metrics={'f1_val': 0.369464186188203, 'auprc': 0.8359085477822477, 'loss_val': 0.8970796228666065, 'psi': 0.5560419308258209}-{'f1_val': 0.37500067319274677, 'auprc': 0.6159136491502989, 'loss_val': 1.047408961031484, 'psi': 0.4713658635757676}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:63205
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:63215
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:63208
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:63203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:63202
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:63203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:63213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:63213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:63212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:63203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:63204
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] → sending delta(kind=head bytes=1794) to S10@127.0.0.1:63211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S10] → sending delta(kind=head bytes=1792) to S5@127.0.0.1:63205
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S9] sending update (kind=head size=1793 to 1 peers)
[S10] sending update (kind=head size=1792 to 1 peers)
[S14] sending update (kind=head size=1794 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1797) from S15
[S13] cosine check vs S15: cos=0.9747
[S3] RECEIVED delta(kind=head bytes=1796) from S13
[S3] cosine check vs S13: cos=-0.0849
[S3] DROPPED delta from S13 (cos=-0.0849 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1797) from S8
[S2] cosine check vs S8: cos=0.8478
[S3] RECEIVED delta(kind=head bytes=1800) from S7
[S3] cosine check vs S7: cos=0.8559
[S15] RECEIVED delta(kind=head bytes=1803) from S11
[S15] cosine check vs S11: cos=-0.0320
[S15] DROPPED delta from S11 (cos=-0.0320 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1796) from S4
[S7] cosine check vs S4: cos=-0.1687
[S7] DROPPED delta from S4 (cos=-0.1687 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1793) from S9
[S5] cosine check vs S9: cos=0.3213
[S4] RECEIVED delta(kind=head bytes=1798) from S2
[S4] cosine check vs S2: cos=-0.0624
[S4] DROPPED delta from S2 (cos=-0.0624 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1795) from S3
[S11] cosine check vs S3: cos=0.1406
[S13] RECEIVED delta(kind=head bytes=1799) from S6
[S13] cosine check vs S6: cos=-0.0153
[S13] DROPPED delta from S6 (cos=-0.0153 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1794) from S14
[S10] cosine check vs S14: cos=0.7009
[S3] RECEIVED delta(kind=head bytes=1796) from S5
[S3] cosine check vs S5: cos=0.2661
[S5] RECEIVED delta(kind=head bytes=1792) from S10
[S5] cosine check vs S10: cos=0.6928
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:63202
[S17] sending update (kind=head size=1795 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1795) from S17
[S2] cosine check vs S17: cos=0.5565
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=6 metric=0.1423 head_norm=0.755072
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.038433e-01
[S5] stored merged vector for next round verification (round=6)
[S5] DEBUG after merge:  round=6 metric=0.1423 head_norm=0.653010 delta_norm=0.303843
[S5] aggregate: ACCEPT kept=['S9', 'S10'] (k=2/2) mode=median trim_p=0.1
[S2] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=6 metric=0.1418 head_norm=0.772841
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.963470e-01
[S2] stored merged vector for next round verification (round=6)
[S2] DEBUG after merge:  round=6 metric=0.1418 head_norm=0.812540 delta_norm=0.196347
[S2] aggregate: ACCEPT kept=['S8', 'S17'] (k=2/2) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=6 metric=0.4173 head_norm=0.775209
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.741046e-01
[S10] stored merged vector for next round verification (round=6)
[S10] DEBUG after merge:  round=6 metric=0.4158 head_norm=0.842026 delta_norm=0.374105
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=6 metric=0.1404 head_norm=1.114345
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.513559e-01
[S13] stored merged vector for next round verification (round=6)
[S13] DEBUG after merge:  round=6 metric=0.1404 head_norm=1.178675 delta_norm=0.151356
[S13] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=6 metric=0.1404 head_norm=0.723204
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.363989e-01
[S11] stored merged vector for next round verification (round=6)
[S11] DEBUG after merge:  round=6 metric=0.1404 head_norm=0.501535 delta_norm=0.436399
[S11] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=6 metric=0.1398 head_norm=0.600781
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.948712e-01
[S3] stored merged vector for next round verification (round=6)
[S3] DEBUG after merge:  round=6 metric=0.1398 head_norm=0.558351 delta_norm=0.194871
[S3] aggregate: ACCEPT kept=['S7', 'S5'] (k=2/2) mode=median trim_p=0.1
[S2] START round=7 head_norm_before_train=0.812540 cos_to_last_merge=1.0000 (last merge round=6)
[S2] round=7 local utility u=0.970288 metrics={'f1_val': 0.41663915620715675, 'auprc': 0.7759316932177006, 'loss_val': 1.110508586698337, 'psi': 0.5603561710113744}-{'f1_val': 0.1417771333885667, 'auprc': 0.7052189892241616, 'loss_val': 1.1897739610454994, 'psi': 0.36715387572280467}
[S3] START round=7 head_norm_before_train=0.558351 cos_to_last_merge=1.0000 (last merge round=6)
[S3] round=7 local utility u=0.036678 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.7961477599487756, 'loss_val': 1.1053523638162162, 'psi': 0.4023631433479745}-{'f1_val': 0.13984006561410703, 'auprc': 0.7961477413474249, 'loss_val': 1.1787073309234817, 'psi': 0.4023631359074342}
[S4] START round=7 head_norm_before_train=1.014967 cos_to_last_merge=0.9595 (last merge round=2)
[S4] round=7 local utility u=0.614776 metrics={'f1_val': 0.6699629108194537, 'auprc': 0.7689478289126215, 'loss_val': 0.8573326667746466, 'psi': 0.7095568780567209}-{'f1_val': 0.4902122768538778, 'auprc': 0.7755725637956412, 'loss_val': 1.0282552941345462, 'psi': 0.6043563916305832}
[S5] START round=7 head_norm_before_train=0.653010 cos_to_last_merge=1.0000 (last merge round=6)
[S5] round=7 local utility u=0.683769 metrics={'f1_val': 0.418719311347976, 'auprc': 0.6543093882992701, 'loss_val': 1.1264868742321805, 'psi': 0.5129553421284936}-{'f1_val': 0.14226190476190476, 'auprc': 0.77340377676659, 'loss_val': 1.1925633284714268, 'psi': 0.3947186535637789}
[S6] START round=7 head_norm_before_train=0.848672 cos_to_last_merge=0.9591 (last merge round=2)
[S6] round=7 local utility u=0.877677 metrics={'f1_val': 0.4150420236907487, 'auprc': 0.7647153277146931, 'loss_val': 1.065609760134389, 'psi': 0.5549113453003265}-{'f1_val': 0.14142628205128205, 'auprc': 0.7638697226607795, 'loss_val': 1.1767329628202357, 'psi': 0.390403658295081}
[S7] START round=7 head_norm_before_train=0.830106 cos_to_last_merge=0.9485 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.948
[S7] round=7 local utility u=0.579049 metrics={'f1_val': 0.4166714190153544, 'auprc': 0.5815487041211431, 'loss_val': 1.0870910319850087, 'psi': 0.4826223330576699}-{'f1_val': 0.14205682272909165, 'auprc': 0.7768215358838912, 'loss_val': 1.1833202149712538, 'psi': 0.3959627079910115}
[S8] START round=7 head_norm_before_train=1.013261 cos_to_last_merge=0.9578 (last merge round=1)
[S8] round=7 local utility u=0.073041 metrics={'f1_val': 0.7155419475775954, 'auprc': 0.7769383503834376, 'loss_val': 0.8692702899262786, 'psi': 0.7401005086999323}-{'f1_val': 0.715097844268966, 'auprc': 0.7770057923810686, 'loss_val': 1.012890131280622, 'psi': 0.739861023513807}
[S9] START round=7 head_norm_before_train=1.082597 cos_to_last_merge=0.9708 (last merge round=2)
[S9] round=7 local utility u=1.000000 metrics={'f1_val': 0.7010097212455122, 'auprc': 0.9997617924337839, 'loss_val': 0.6878291244618657, 'psi': 0.8205105497208209}-{'f1_val': 0.39849358979305904, 'auprc': 0.9999110800047113, 'loss_val': 0.9006887116699809, 'psi': 0.63906058587772}
[S10] START round=7 head_norm_before_train=0.842026 cos_to_last_merge=1.0000 (last merge round=6)
[S10] round=7 local utility u=0.167855 metrics={'f1_val': 0.38606531465016714, 'auprc': 0.7578243439711434, 'loss_val': 0.9624267915624426, 'psi': 0.5347689263785577}-{'f1_val': 0.41725894337834635, 'auprc': 0.6097748103901489, 'loss_val': 1.0411500057232344, 'psi': 0.4942652901830674}
[S11] START round=7 head_norm_before_train=0.501535 cos_to_last_merge=1.0000 (last merge round=6)
[S11] round=7 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7119510345699134, 'loss_val': 1.1691777047699907, 'psi': 0.3690286238518317}-{'f1_val': 0.14041368337311058, 'auprc': 0.8772542299807738, 'loss_val': 1.1822488147619952, 'psi': 0.4351499020161759}
[S13] START round=7 head_norm_before_train=1.178675 cos_to_last_merge=1.0000 (last merge round=6)
[S13] round=7 local utility u=0.928482 metrics={'f1_val': 0.41627458463323097, 'auprc': 0.7384904963110812, 'loss_val': 1.1421444357440567, 'psi': 0.5451609493043711}-{'f1_val': 0.1403857625770531, 'auprc': 0.6930353859719467, 'loss_val': 1.207410377616896, 'psi': 0.3614456119350105}
[S14] START round=7 head_norm_before_train=1.047366 cos_to_last_merge=0.9694 (last merge round=2)
[S14] round=7 local utility u=0.230672 metrics={'f1_val': 0.39649470961585787, 'auprc': 0.9096240409638262, 'loss_val': 0.8677028217852679, 'psi': 0.6017464421550451}-{'f1_val': 0.39659360338126215, 'auprc': 0.8010415386095668, 'loss_val': 1.0038920089218903, 'psi': 0.5583727774725841}
[S15] START round=7 head_norm_before_train=1.258014 (no previous merge yet)
[S15] round=7 local utility u=0.078070 metrics={'f1_val': 0.416567672447929, 'auprc': 0.7795400691378601, 'loss_val': 1.0105713356047894, 'psi': 0.5617566311239015}-{'f1_val': 0.4161838404121786, 'auprc': 0.7770545605664709, 'loss_val': 1.1569517463030794, 'psi': 0.5605321284738956}
[S16] START round=7 head_norm_before_train=1.269327 (no previous merge yet)
[S16] round=7 local utility u=0.071378 metrics={'f1_val': 0.4171177572574632, 'auprc': 0.7503352313541682, 'loss_val': 0.8767666086144014, 'psi': 0.5504047468961453}-{'f1_val': 0.4170395601558466, 'auprc': 0.7438910318182602, 'loss_val': 0.9997217653431136, 'psi': 0.547780148820812}
[S17] START round=7 head_norm_before_train=1.347099 (no previous merge yet)
[S17] round=7 local utility u=0.000000 metrics={'f1_val': 0.3534979730771019, 'auprc': 0.7887673218140432, 'loss_val': 0.8899141990829993, 'psi': 0.5276057125718785}-{'f1_val': 0.369464186188203, 'auprc': 0.8359085477822477, 'loss_val': 0.8970796228666065, 'psi': 0.5560419308258209}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:63211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S2@127.0.0.1:63202
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:63203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S11@127.0.0.1:63212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:63203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:63203
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:63213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:63208
[S6] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1794 to 1 peers)
[S3] sending update (kind=head size=1804 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1795 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1801) from S13
[S3] cosine check vs S13: cos=-0.0674
[S3] DROPPED delta from S13 (cos=-0.0674 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1797) from S4
[S7] cosine check vs S4: cos=-0.1614
[S7] DROPPED delta from S4 (cos=-0.1614 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1804) from S3
[S11] cosine check vs S3: cos=0.7254
[S3] RECEIVED delta(kind=head bytes=1801) from S5
[S3] cosine check vs S5: cos=0.4951
[S2] RECEIVED delta(kind=head bytes=1794) from S8
[S2] cosine check vs S8: cos=0.7537
[S13] RECEIVED delta(kind=head bytes=1801) from S6
[S13] cosine check vs S6: cos=-0.0154
[S13] DROPPED delta from S6 (cos=-0.0154 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1795) from S14
[S10] cosine check vs S14: cos=0.9076
[S3] RECEIVED delta(kind=head bytes=1799) from S7
[S3] cosine check vs S7: cos=0.8171
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] → sending delta(kind=head bytes=1794) to S13@127.0.0.1:63213
[S15] sending update (kind=head size=1794 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1794) from S15
[S13] cosine check vs S15: cos=0.9857
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:63205
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:63205
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:63204
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:63204
[S16] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1794 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1794) from S10
[S5] cosine check vs S10: cos=0.5139
[S4] RECEIVED delta(kind=head bytes=1799) from S16
[S4] cosine check vs S16: cos=-0.0512
[S4] DROPPED delta from S16 (cos=-0.0512 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1799) from S9
[S5] cosine check vs S9: cos=0.6068
[S2] sending update (kind=head size=1803 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1803) from S2
[S4] cosine check vs S2: cos=-0.0701
[S4] DROPPED delta from S2 (cos=-0.0701 < 0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=7 metric=0.1404 head_norm=0.540160
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.110552e-01
[S11] stored merged vector for next round verification (round=7)
[S11] DEBUG after merge:  round=7 metric=0.1404 head_norm=0.525713 delta_norm=0.211055
[S11] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=7 metric=0.4163 head_norm=1.197380
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.137951e-01
[S13] stored merged vector for next round verification (round=7)
[S13] DEBUG after merge:  round=7 metric=0.4163 head_norm=1.236960 delta_norm=0.113795
[S13] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=7 metric=0.4187 head_norm=0.679127
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.389566e-01
[S5] stored merged vector for next round verification (round=7)
[S5] DEBUG after merge:  round=7 metric=0.7151 head_norm=0.664550 delta_norm=0.238957
[S5] aggregate: ACCEPT kept=['S10', 'S9'] (k=2/2) mode=median trim_p=0.1
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=7 metric=0.1398 head_norm=0.591661
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.323569e-01
[S3] stored merged vector for next round verification (round=7)
[S3] DEBUG after merge:  round=7 metric=0.1398 head_norm=0.569188 delta_norm=0.132357
[S3] aggregate: ACCEPT kept=['S5', 'S7'] (k=2/2) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=7 metric=0.3861 head_norm=0.867826
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.392167e-01
[S10] stored merged vector for next round verification (round=7)
[S10] DEBUG after merge:  round=7 metric=0.3864 head_norm=0.960068 delta_norm=0.239217
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=7 metric=0.4166 head_norm=0.842188
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.482451e-01
[S2] stored merged vector for next round verification (round=7)
[S2] DEBUG after merge:  round=7 metric=0.4165 head_norm=0.890268 delta_norm=0.348245
[S2] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=0.890268 cos_to_last_merge=1.0000 (last merge round=7)
[S2] round=8 local utility u=0.549311 metrics={'f1_val': 0.5830503513496657, 'auprc': 0.7764676147941559, 'loss_val': 1.0119610994851327, 'psi': 0.6604172567274618}-{'f1_val': 0.41663915620715675, 'auprc': 0.7759316932177006, 'loss_val': 1.110508586698337, 'psi': 0.5603561710113744}
[S3] START round=8 head_norm_before_train=0.569188 cos_to_last_merge=1.0000 (last merge round=7)
[S3] round=8 local utility u=0.820047 metrics={'f1_val': 0.39931339562098456, 'auprc': 0.7960281718062605, 'loss_val': 1.021739449349428, 'psi': 0.557999306095095}-{'f1_val': 0.13984006561410703, 'auprc': 0.7961477599487756, 'loss_val': 1.1053523638162162, 'psi': 0.4023631433479745}
[S4] START round=8 head_norm_before_train=1.065836 cos_to_last_merge=0.9407 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.941
[S4] round=8 local utility u=0.000000 metrics={'f1_val': 0.6686468993727818, 'auprc': 0.6544351916645788, 'loss_val': 0.7429832732624205, 'psi': 0.6629622162895006}-{'f1_val': 0.6699629108194537, 'auprc': 0.7689478289126215, 'loss_val': 0.8573326667746466, 'psi': 0.7095568780567209}
[S5] START round=8 head_norm_before_train=0.664550 cos_to_last_merge=1.0000 (last merge round=7)
[S5] round=8 local utility u=0.910167 metrics={'f1_val': 0.7146937595824697, 'auprc': 0.6451345372571511, 'loss_val': 1.0544756401754765, 'psi': 0.6868700706523423}-{'f1_val': 0.418719311347976, 'auprc': 0.6543093882992701, 'loss_val': 1.1264868742321805, 'psi': 0.5129553421284936}
[S6] START round=8 head_norm_before_train=0.877670 cos_to_last_merge=0.9449 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.945
[S6] round=8 local utility u=0.116159 metrics={'f1_val': 0.4166544795555117, 'auprc': 0.7906421064370798, 'loss_val': 0.920746034008273, 'psi': 0.566249530308139}-{'f1_val': 0.4150420236907487, 'auprc': 0.7647153277146931, 'loss_val': 1.065609760134389, 'psi': 0.5549113453003265}
[S7] START round=8 head_norm_before_train=0.856318 cos_to_last_merge=0.9365 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.936
[S7] round=8 local utility u=0.303584 metrics={'f1_val': 0.4172381946317165, 'auprc': 0.7376758569635212, 'loss_val': 0.951704432190353, 'psi': 0.5454132595644384}-{'f1_val': 0.4166714190153544, 'auprc': 0.5815487041211431, 'loss_val': 1.0870910319850087, 'psi': 0.4826223330576699}
[S8] START round=8 head_norm_before_train=1.057556 cos_to_last_merge=0.9433 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.943
[S8] round=8 local utility u=0.000000 metrics={'f1_val': 0.7016299639575494, 'auprc': 0.6968115268841759, 'loss_val': 0.7299402072273113, 'psi': 0.6997025891282}-{'f1_val': 0.7155419475775954, 'auprc': 0.7769383503834376, 'loss_val': 0.8692702899262786, 'psi': 0.7401005086999323}
[S9] START round=8 head_norm_before_train=1.131372 cos_to_last_merge=0.9593 (last merge round=2)
[S9] round=8 local utility u=0.086805 metrics={'f1_val': 0.7017603346574908, 'auprc': 0.999232387380519, 'loss_val': 0.5171336604894422, 'psi': 0.8207491557467022}-{'f1_val': 0.7010097212455122, 'auprc': 0.9997617924337839, 'loss_val': 0.6878291244618657, 'psi': 0.8205105497208209}
[S10] START round=8 head_norm_before_train=0.960068 cos_to_last_merge=1.0000 (last merge round=7)
[S10] round=8 local utility u=0.087906 metrics={'f1_val': 0.3874980126721413, 'auprc': 0.7886820146237166, 'loss_val': 0.8877840193743383, 'psi': 0.5479716134527715}-{'f1_val': 0.38606531465016714, 'auprc': 0.7578243439711434, 'loss_val': 0.9624267915624426, 'psi': 0.5347689263785577}
[S11] START round=8 head_norm_before_train=0.525713 cos_to_last_merge=1.0000 (last merge round=7)
[S11] round=8 local utility u=0.110183 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7696508423697769, 'loss_val': 1.121910392847583, 'psi': 0.3921085469717771}-{'f1_val': 0.14041368337311058, 'auprc': 0.7119510345699134, 'loss_val': 1.1691777047699907, 'psi': 0.3690286238518317}
[S13] START round=8 head_norm_before_train=1.236960 cos_to_last_merge=1.0000 (last merge round=7)
[S13] round=8 local utility u=0.000000 metrics={'f1_val': 0.41592377599636055, 'auprc': 0.6745300637225597, 'loss_val': 0.9899955926006819, 'psi': 0.5193662910868402}-{'f1_val': 0.41627458463323097, 'auprc': 0.7384904963110812, 'loss_val': 1.1421444357440567, 'psi': 0.5451609493043711}
[S14] START round=8 head_norm_before_train=1.097629 cos_to_last_merge=0.9563 (last merge round=2)
[S14] round=8 local utility u=0.447745 metrics={'f1_val': 0.503642184247944, 'auprc': 0.95025578088637, 'loss_val': 0.7369935981518831, 'psi': 0.6822876229033144}-{'f1_val': 0.39649470961585787, 'auprc': 0.9096240409638262, 'loss_val': 0.8677028217852679, 'psi': 0.6017464421550451}
[S15] START round=8 head_norm_before_train=1.285426 (no previous merge yet)
[S15] round=8 local utility u=0.104213 metrics={'f1_val': 0.4166966901809296, 'auprc': 0.7961095479735196, 'loss_val': 0.8526268816700496, 'psi': 0.5684618332979656}-{'f1_val': 0.416567672447929, 'auprc': 0.7795400691378601, 'loss_val': 1.0105713356047894, 'psi': 0.5617566311239015}
[S16] START round=8 head_norm_before_train=1.308133 (no previous merge yet)
[S16] round=8 local utility u=0.000000 metrics={'f1_val': 0.3747325914628409, 'auprc': 0.7408979693349838, 'loss_val': 0.8851005145634645, 'psi': 0.521198742611698}-{'f1_val': 0.4171177572574632, 'auprc': 0.7503352313541682, 'loss_val': 0.8767666086144014, 'psi': 0.5504047468961453}
[S17] START round=8 head_norm_before_train=1.394447 (no previous merge yet)
[S17] round=8 local utility u=0.000000 metrics={'f1_val': 0.3419529359788239, 'auprc': 0.6724379142403014, 'loss_val': 1.000549646875646, 'psi': 0.4741469272834149}-{'f1_val': 0.3534979730771019, 'auprc': 0.7887673218140432, 'loss_val': 0.8899141990829993, 'psi': 0.5276057125718785}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:63204
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:63212
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S6] → sending delta(kind=head bytes=1791) to S13@127.0.0.1:63213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:63205
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:63211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:63203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:63213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:63205
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:63203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S11] → sending delta(kind=head bytes=1807) to S15@127.0.0.1:63215
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1791 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1807 to 1 peers)
[S9] sending update (kind=head size=1793 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1791) from S6
[S13] cosine check vs S6: cos=-0.0164
[S13] DROPPED delta from S6 (cos=-0.0164 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1799) from S2
[S4] cosine check vs S2: cos=-0.0599
[S4] DROPPED delta from S2 (cos=-0.0599 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1797) from S5
[S3] cosine check vs S5: cos=0.5489
[S13] RECEIVED delta(kind=head bytes=1801) from S15
[S13] cosine check vs S15: cos=0.9908
[S5] RECEIVED delta(kind=head bytes=1802) from S10
[S5] cosine check vs S10: cos=0.5308
[S10] RECEIVED delta(kind=head bytes=1800) from S14
[S10] cosine check vs S14: cos=0.9535
[S15] RECEIVED delta(kind=head bytes=1807) from S11
[S15] cosine check vs S11: cos=-0.0823
[S15] DROPPED delta from S11 (cos=-0.0823 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1802) from S3
[S11] cosine check vs S3: cos=0.8678
[S3] RECEIVED delta(kind=head bytes=1800) from S7
[S3] cosine check vs S7: cos=0.7985
[S5] RECEIVED delta(kind=head bytes=1793) from S9
[S5] cosine check vs S9: cos=0.7353
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=8 metric=0.3875 head_norm=0.984647
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.826493e-01
[S10] stored merged vector for next round verification (round=8)
[S10] DEBUG after merge:  round=8 metric=0.4380 head_norm=1.055892 delta_norm=0.182649
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=8 metric=0.3993 head_norm=0.607806
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.364773e-01
[S3] stored merged vector for next round verification (round=8)
[S3] DEBUG after merge:  round=8 metric=0.3969 head_norm=0.592021 delta_norm=0.136477
[S3] aggregate: ACCEPT kept=['S5', 'S7'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=8 metric=0.7147 head_norm=0.692014
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.868872e-01
[S5] stored merged vector for next round verification (round=8)
[S5] DEBUG after merge:  round=8 metric=0.7112 head_norm=0.719453 delta_norm=0.186887
[S5] aggregate: ACCEPT kept=['S10', 'S9'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=8 metric=0.1404 head_norm=0.564301
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.521188e-01
[S11] stored merged vector for next round verification (round=8)
[S11] DEBUG after merge:  round=8 metric=0.1404 head_norm=0.566384 delta_norm=0.152119
[S11] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=8 metric=0.4159 head_norm=1.249177
[S13] _apply_head_vector_avg (torch): Δ‖w‖=9.422883e-02
[S13] stored merged vector for next round verification (round=8)
[S13] DEBUG after merge:  round=8 metric=0.4159 head_norm=1.282446 delta_norm=0.094229
[S13] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=0.927518 cos_to_last_merge=0.9957 (last merge round=7)
[S2] round=9 local utility u=0.342908 metrics={'f1_val': 0.6775732946327528, 'auprc': 0.7760352635647557, 'loss_val': 0.8919854888379499, 'psi': 0.716958082205554}-{'f1_val': 0.5830503513496657, 'auprc': 0.7764676147941559, 'loss_val': 1.0119610994851327, 'psi': 0.6604172567274618}
[S3] START round=9 head_norm_before_train=0.592021 cos_to_last_merge=1.0000 (last merge round=8)
[S3] round=9 local utility u=0.302480 metrics={'f1_val': 0.486830366092585, 'auprc': 0.7959379966699476, 'loss_val': 0.9416110998636338, 'psi': 0.6104734183235301}-{'f1_val': 0.39931339562098456, 'auprc': 0.7960281718062605, 'loss_val': 1.021739449349428, 'psi': 0.557999306095095}
[S4] START round=9 head_norm_before_train=1.126189 cos_to_last_merge=0.9194 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.919
[S4] round=9 local utility u=0.026195 metrics={'f1_val': 0.667950778184015, 'auprc': 0.653137349313726, 'loss_val': 0.6825236715202475, 'psi': 0.6620254066358995}-{'f1_val': 0.6686468993727818, 'auprc': 0.6544351916645788, 'loss_val': 0.7429832732624205, 'psi': 0.6629622162895006}
[S5] START round=9 head_norm_before_train=0.719453 cos_to_last_merge=1.0000 (last merge round=8)
[S5] round=9 local utility u=0.252652 metrics={'f1_val': 0.7143347548915031, 'auprc': 0.7739544882527954, 'loss_val': 0.9334784213925896, 'psi': 0.7381826482360201}-{'f1_val': 0.7146937595824697, 'auprc': 0.6451345372571511, 'loss_val': 1.0544756401754765, 'psi': 0.6868700706523423}
[S6] START round=9 head_norm_before_train=0.910845 cos_to_last_merge=0.9272 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.927
[S6] round=9 local utility u=0.114339 metrics={'f1_val': 0.4173360362516195, 'auprc': 0.8187209818230756, 'loss_val': 0.7803936993017957, 'psi': 0.5778900144802019}-{'f1_val': 0.4166544795555117, 'auprc': 0.7906421064370798, 'loss_val': 0.920746034008273, 'psi': 0.566249530308139}
[S7] START round=9 head_norm_before_train=0.891861 cos_to_last_merge=0.9222 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.922
[S7] round=9 local utility u=0.117116 metrics={'f1_val': 0.41683246609844005, 'auprc': 0.7887529984788422, 'loss_val': 0.8682688295894567, 'psi': 0.565600679050601}-{'f1_val': 0.4172381946317165, 'auprc': 0.7376758569635212, 'loss_val': 0.951704432190353, 'psi': 0.5454132595644384}
[S8] START round=9 head_norm_before_train=1.102885 cos_to_last_merge=0.9257 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.926
[S8] round=9 local utility u=0.510483 metrics={'f1_val': 0.7145534943595749, 'auprc': 0.9837045271777087, 'loss_val': 0.647194171728577, 'psi': 0.8222139074868284}-{'f1_val': 0.7016299639575494, 'auprc': 0.6968115268841759, 'loss_val': 0.7299402072273113, 'psi': 0.6997025891282}
[S9] START round=9 head_norm_before_train=1.186291 cos_to_last_merge=0.9449 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.945
[S9] round=9 local utility u=0.047372 metrics={'f1_val': 0.7003692178164534, 'auprc': 0.9992055494153844, 'loss_val': 0.4139619224951971, 'psi': 0.8199037504560258}-{'f1_val': 0.7017603346574908, 'auprc': 0.999232387380519, 'loss_val': 0.5171336604894422, 'psi': 0.8207491557467022}
[S10] START round=9 head_norm_before_train=1.055892 cos_to_last_merge=1.0000 (last merge round=8)
[S10] round=9 local utility u=0.449554 metrics={'f1_val': 0.5384270541253927, 'auprc': 0.7660252059093935, 'loss_val': 0.8262796908646183, 'psi': 0.6294663148389931}-{'f1_val': 0.3874980126721413, 'auprc': 0.7886820146237166, 'loss_val': 0.8877840193743383, 'psi': 0.5479716134527715}
[S11] START round=9 head_norm_before_train=0.566384 cos_to_last_merge=1.0000 (last merge round=8)
[S11] round=9 local utility u=0.271219 metrics={'f1_val': 0.173323294810849, 'auprc': 0.865229474963495, 'loss_val': 1.063665625229373, 'psi': 0.45008576687190743}-{'f1_val': 0.14041368337311058, 'auprc': 0.7696508423697769, 'loss_val': 1.121910392847583, 'psi': 0.3921085469717771}
[S13] START round=9 head_norm_before_train=1.282446 cos_to_last_merge=1.0000 (last merge round=8)
[S13] round=9 local utility u=0.074331 metrics={'f1_val': 0.4319825913867467, 'auprc': 0.6722726581149173, 'loss_val': 0.930913847448387, 'psi': 0.528098618078015}-{'f1_val': 0.41592377599636055, 'auprc': 0.6745300637225597, 'loss_val': 0.9899955926006819, 'psi': 0.5193662910868402}
[S14] START round=9 head_norm_before_train=1.151958 cos_to_last_merge=0.9425 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.942
[S14] round=9 local utility u=0.829840 metrics={'f1_val': 0.7473152893916211, 'auprc': 0.990381663429829, 'loss_val': 0.659730267019314, 'psi': 0.8445418390069042}-{'f1_val': 0.503642184247944, 'auprc': 0.95025578088637, 'loss_val': 0.7369935981518831, 'psi': 0.6822876229033144}
[S15] START round=9 head_norm_before_train=1.321610 (no previous merge yet)
[S15] round=9 local utility u=0.813112 metrics={'f1_val': 0.5685601612078826, 'auprc': 0.9913006437303917, 'loss_val': 0.723156729730051, 'psi': 0.7376563542168861}-{'f1_val': 0.4166966901809296, 'auprc': 0.7961095479735196, 'loss_val': 0.8526268816700496, 'psi': 0.5684618332979656}
[S16] START round=9 head_norm_before_train=1.350452 (no previous merge yet)
[S16] round=9 local utility u=0.176238 metrics={'f1_val': 0.41626139063102957, 'auprc': 0.7450218958009036, 'loss_val': 0.794168456707646, 'psi': 0.5477655926989792}-{'f1_val': 0.3747325914628409, 'auprc': 0.7408979693349838, 'loss_val': 0.8851005145634645, 'psi': 0.521198742611698}
[S17] START round=9 head_norm_before_train=1.434761 (no previous merge yet)
[S17] round=9 local utility u=0.085383 metrics={'f1_val': 0.3411098480713462, 'auprc': 0.7198023921419904, 'loss_val': 0.966819395954674, 'psi': 0.49258686569960386}-{'f1_val': 0.3419529359788239, 'auprc': 0.6724379142403014, 'loss_val': 1.000549646875646, 'psi': 0.4741469272834149}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:63208
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:63215
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S7] → sending delta(kind=head bytes=1793) to S3@127.0.0.1:63203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:63203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S11@127.0.0.1:63212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:63204
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:63211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:63202
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:63205
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:63203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S6] → sending delta(kind=head bytes=1786) to S13@127.0.0.1:63213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] → sending delta(kind=head bytes=1794) to S4@127.0.0.1:63204
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:63213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:63205
[S2] sending update (kind=head size=1794 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1786 to 1 peers)
[S13] sending update (kind=head size=1794 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1793 to 1 peers)
[S3] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1786) from S6
[S13] cosine check vs S6: cos=-0.0218
[S13] DROPPED delta from S6 (cos=-0.0218 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1797) from S14
[S10] cosine check vs S14: cos=0.9699
[S3] RECEIVED delta(kind=head bytes=1794) from S13
[S3] cosine check vs S13: cos=-0.0521
[S3] DROPPED delta from S13 (cos=-0.0521 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1793) from S7
[S3] cosine check vs S7: cos=0.7981
[S3] RECEIVED delta(kind=head bytes=1797) from S5
[S3] cosine check vs S5: cos=0.5818
[S4] RECEIVED delta(kind=head bytes=1794) from S2
[S4] cosine check vs S2: cos=-0.0698
[S4] DROPPED delta from S2 (cos=-0.0698 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1799) from S10
[S5] cosine check vs S10: cos=0.5800
[S5] RECEIVED delta(kind=head bytes=1798) from S9
[S5] cosine check vs S9: cos=0.7675
[S4] RECEIVED delta(kind=head bytes=1803) from S16
[S4] cosine check vs S16: cos=-0.0435
[S4] DROPPED delta from S16 (cos=-0.0435 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1803) from S3
[S11] cosine check vs S3: cos=0.8994
[S2] RECEIVED delta(kind=head bytes=1798) from S8
[S2] cosine check vs S8: cos=0.8994
[S7] RECEIVED delta(kind=head bytes=1803) from S4
[S7] cosine check vs S4: cos=-0.1425
[S7] DROPPED delta from S4 (cos=-0.1425 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1801) from S15
[S13] cosine check vs S15: cos=0.9920
[S15] RECEIVED delta(kind=head bytes=1802) from S11
[S15] cosine check vs S11: cos=-0.0671
[S15] DROPPED delta from S11 (cos=-0.0671 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:63202
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1799) from S17
[S2] cosine check vs S17: cos=0.3995
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=9 metric=0.7143 head_norm=0.746458
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.516075e-01
[S5] stored merged vector for next round verification (round=9)
[S5] DEBUG after merge:  round=9 metric=0.7009 head_norm=0.782694 delta_norm=0.151607
[S5] aggregate: ROLLBACK (f1_val pre=0.714 post=0.701 tol_abs=0.005 tol_rel=0.0)
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=9 metric=0.4868 head_norm=0.634826
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.409332e-01
[S3] stored merged vector for next round verification (round=9)
[S3] DEBUG after merge:  round=9 metric=0.4574 head_norm=0.627338 delta_norm=0.140933
[S3] aggregate: ROLLBACK (f1_val pre=0.487 post=0.457 tol_abs=0.005 tol_rel=0.0)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=9 metric=0.4320 head_norm=1.299344
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.969574e-02
[S13] stored merged vector for next round verification (round=9)
[S13] DEBUG after merge:  round=9 metric=0.4402 head_norm=1.327538 delta_norm=0.089696
[S13] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=9 metric=0.5384 head_norm=1.080871
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.529962e-01
[S10] stored merged vector for next round verification (round=9)
[S10] DEBUG after merge:  round=9 metric=0.6400 head_norm=1.133826 delta_norm=0.152996
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=9 metric=0.1733 head_norm=0.603696
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.397180e-01
[S11] stored merged vector for next round verification (round=9)
[S11] DEBUG after merge:  round=9 metric=0.1538 head_norm=0.603494 delta_norm=0.139718
[S11] aggregate: ROLLBACK (f1_val pre=0.173 post=0.154 tol_abs=0.005 tol_rel=0.0)
[S2] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=9 metric=0.6776 head_norm=0.979154
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.871441e-01
[S2] stored merged vector for next round verification (round=9)
[S2] DEBUG after merge:  round=9 metric=0.7133 head_norm=0.935567 delta_norm=0.287144
[S2] aggregate: ACCEPT kept=['S8', 'S17'] (k=2/2) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=0.935567 cos_to_last_merge=1.0000 (last merge round=9)
[S2] round=10 local utility u=0.000000 metrics={'f1_val': 0.6996654335675643, 'auprc': 0.6459748048961612, 'loss_val': 0.7745932260086761, 'psi': 0.678189182099003}-{'f1_val': 0.6775732946327528, 'auprc': 0.7760352635647557, 'loss_val': 0.8919854888379499, 'psi': 0.716958082205554}
[S3] START round=10 head_norm_before_train=0.627338 cos_to_last_merge=1.0000 (last merge round=9)
[S3] round=10 local utility u=0.000000 metrics={'f1_val': 0.4045316402820668, 'auprc': 0.6675388600448553, 'loss_val': 0.9160435562978919, 'psi': 0.5097345281871822}-{'f1_val': 0.486830366092585, 'auprc': 0.7959379966699476, 'loss_val': 0.9416110998636338, 'psi': 0.6104734183235301}
[S4] START round=10 head_norm_before_train=1.186017 cos_to_last_merge=0.8985 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.898
[S4] round=10 local utility u=0.027006 metrics={'f1_val': 0.6676503405542982, 'auprc': 0.6488935110610137, 'loss_val': 0.6139765425217176, 'psi': 0.6601476087569844}-{'f1_val': 0.667950778184015, 'auprc': 0.653137349313726, 'loss_val': 0.6825236715202475, 'psi': 0.6620254066358995}
[S5] START round=10 head_norm_before_train=0.782694 cos_to_last_merge=1.0000 (last merge round=9)
[S5] round=10 local utility u=0.027989 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.77808076192262, 'loss_val': 0.8057992377065367, 'psi': 0.7314250952293962}-{'f1_val': 0.7143347548915031, 'auprc': 0.7739544882527954, 'loss_val': 0.9334784213925896, 'psi': 0.7381826482360201}
[S6] START round=10 head_norm_before_train=0.949838 cos_to_last_merge=0.9071 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.907
[S6] round=10 local utility u=0.063567 metrics={'f1_val': 0.4168551858772006, 'auprc': 0.8293011540092682, 'loss_val': 0.6821142748785944, 'psi': 0.5818335731300277}-{'f1_val': 0.4173360362516195, 'auprc': 0.8187209818230756, 'loss_val': 0.7803936993017957, 'psi': 0.5778900144802019}
[S7] START round=10 head_norm_before_train=0.930907 cos_to_last_merge=0.9053 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.905
[S7] round=10 local utility u=0.019103 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.7835234550516528, 'loss_val': 0.81363956581056, 'psi': 0.5634354528872751}-{'f1_val': 0.41683246609844005, 'auprc': 0.7887529984788422, 'loss_val': 0.8682688295894567, 'psi': 0.565600679050601}
[S8] START round=10 head_norm_before_train=1.150028 cos_to_last_merge=0.9062 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.906
[S8] round=10 local utility u=0.031916 metrics={'f1_val': 0.7013113666637368, 'auprc': 0.9919699364985195, 'loss_val': 0.5287065155296926, 'psi': 0.8175747945976499}-{'f1_val': 0.7145534943595749, 'auprc': 0.9837045271777087, 'loss_val': 0.647194171728577, 'psi': 0.8222139074868284}
[S9] START round=10 head_norm_before_train=1.241618 cos_to_last_merge=0.9290 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.929
[S9] round=10 local utility u=0.030201 metrics={'f1_val': 0.699058194053107, 'auprc': 0.9988104901637241, 'loss_val': 0.34450883056927795, 'psi': 0.8189591124973539}-{'f1_val': 0.7003692178164534, 'auprc': 0.9992055494153844, 'loss_val': 0.4139619224951971, 'psi': 0.8199037504560258}
[S10] START round=10 head_norm_before_train=1.133826 cos_to_last_merge=1.0000 (last merge round=9)
[S10] round=10 local utility u=0.603747 metrics={'f1_val': 0.6997996028618443, 'auprc': 0.7956938050033, 'loss_val': 0.6760267746745188, 'psi': 0.7381572837184266}-{'f1_val': 0.5384270541253927, 'auprc': 0.7660252059093935, 'loss_val': 0.8262796908646183, 'psi': 0.6294663148389931}
[S11] START round=10 head_norm_before_train=0.603494 cos_to_last_merge=1.0000 (last merge round=9)
[S11] round=10 local utility u=0.697414 metrics={'f1_val': 0.39658602128368947, 'auprc': 0.8656326739573247, 'loss_val': 1.0096237341108936, 'psi': 0.5842046823531436}-{'f1_val': 0.173323294810849, 'auprc': 0.865229474963495, 'loss_val': 1.063665625229373, 'psi': 0.45008576687190743}
[S13] START round=10 head_norm_before_train=1.327538 cos_to_last_merge=1.0000 (last merge round=9)
[S13] round=10 local utility u=0.000000 metrics={'f1_val': 0.41580726865236384, 'auprc': 0.6572859288360917, 'loss_val': 0.8354526613943503, 'psi': 0.512398732725855}-{'f1_val': 0.4319825913867467, 'auprc': 0.6722726581149173, 'loss_val': 0.930913847448387, 'psi': 0.528098618078015}
[S14] START round=10 head_norm_before_train=1.204017 cos_to_last_merge=0.9299 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.930
[S14] round=10 local utility u=0.481024 metrics={'f1_val': 0.8911735614570687, 'auprc': 0.9936954938540112, 'loss_val': 0.5707729767692453, 'psi': 0.9321823344158457}-{'f1_val': 0.7473152893916211, 'auprc': 0.990381663429829, 'loss_val': 0.659730267019314, 'psi': 0.8445418390069042}
[S15] START round=10 head_norm_before_train=1.361069 (no previous merge yet)
[S15] round=10 local utility u=0.400694 metrics={'f1_val': 0.6776904196529242, 'auprc': 0.995856527119026, 'loss_val': 0.5902176988010286, 'psi': 0.804956862639365}-{'f1_val': 0.5685601612078826, 'auprc': 0.9913006437303917, 'loss_val': 0.723156729730051, 'psi': 0.7376563542168861}
[S16] START round=10 head_norm_before_train=1.386690 (no previous merge yet)
[S16] round=10 local utility u=0.000000 metrics={'f1_val': 0.38746655130537916, 'auprc': 0.7465929551249599, 'loss_val': 0.7356841952885047, 'psi': 0.5311171128332115}-{'f1_val': 0.41626139063102957, 'auprc': 0.7450218958009036, 'loss_val': 0.794168456707646, 'psi': 0.5477655926989792}
[S17] START round=10 head_norm_before_train=1.464622 (no previous merge yet)
[S17] round=10 local utility u=0.000000 metrics={'f1_val': 0.3376720807163392, 'auprc': 0.6975034628190759, 'loss_val': 1.0638646960873077, 'psi': 0.4816046335574339}-{'f1_val': 0.3411098480713462, 'auprc': 0.7198023921419904, 'loss_val': 0.966819395954674, 'psi': 0.49258686569960386}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:63213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:63211
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S7] → sending delta(kind=head bytes=1790) to S3@127.0.0.1:63203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:63213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:63215
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:63202
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:63203
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:63208
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:63205
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:63205
[S15] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1790 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1795) from S9
[S5] cosine check vs S9: cos=0.7680
[S3] RECEIVED delta(kind=head bytes=1790) from S7
[S3] cosine check vs S7: cos=0.8023
[S15] RECEIVED delta(kind=head bytes=1800) from S11
[S15] cosine check vs S11: cos=-0.0523
[S15] DROPPED delta from S11 (cos=-0.0523 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1799) from S5
[S3] cosine check vs S5: cos=0.6211
[S2] RECEIVED delta(kind=head bytes=1799) from S8
[S2] cosine check vs S8: cos=0.7979
[S13] RECEIVED delta(kind=head bytes=1799) from S15
[S13] cosine check vs S15: cos=0.9924
[S7] RECEIVED delta(kind=head bytes=1800) from S4
[S7] cosine check vs S4: cos=-0.1354
[S7] DROPPED delta from S4 (cos=-0.1354 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1803) from S10
[S5] cosine check vs S10: cos=0.6188
[S10] RECEIVED delta(kind=head bytes=1798) from S14
[S10] cosine check vs S14: cos=0.9784
[S13] RECEIVED delta(kind=head bytes=1799) from S6
[S13] cosine check vs S6: cos=-0.0294
[S13] DROPPED delta from S6 (cos=-0.0294 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=10 metric=0.4158 head_norm=1.350272
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.874959e-02
[S13] stored merged vector for next round verification (round=10)
[S13] DEBUG after merge:  round=10 metric=0.4158 head_norm=1.373668 delta_norm=0.088750
[S13] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.263 → S3@127.0.0.1:63203
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=10 metric=0.4045 head_norm=0.673634
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.374867e-01
[S3] stored merged vector for next round verification (round=10)
[S3] DEBUG after merge:  round=10 metric=0.4045 head_norm=0.671012 delta_norm=0.137487
[S3] aggregate: ACCEPT kept=['S7', 'S5'] (k=2/2) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.306 → S11@127.0.0.1:63212
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=10 metric=0.6997 head_norm=0.987009
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.615582e-01
[S2] stored merged vector for next round verification (round=10)
[S2] DEBUG after merge:  round=10 metric=0.6994 head_norm=1.036585 delta_norm=0.361558
[S2] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.356 → S4@127.0.0.1:63204
[S11] ⇄ pheromone p=0.341 → S15@127.0.0.1:63215
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=10 metric=0.7003 head_norm=0.810702
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.279653e-01
[S5] stored merged vector for next round verification (round=10)
[S5] DEBUG after merge:  round=10 metric=0.7006 head_norm=0.841866 delta_norm=0.127965
[S5] aggregate: ACCEPT kept=['S9', 'S10'] (k=2/2) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.344 → S3@127.0.0.1:63203
[S15] ⇄ pheromone p=0.431 → S13@127.0.0.1:63213
[S6] ⇄ pheromone p=0.262 → S13@127.0.0.1:63213
[S9] ⇄ pheromone p=0.322 → S5@127.0.0.1:63205
[S4] ⇄ pheromone p=0.283 → S7@127.0.0.1:63208
[S8] ⇄ pheromone p=0.307 → S2@127.0.0.1:63202
[S7] ⇄ pheromone p=0.233 → S3@127.0.0.1:63203
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=10 metric=0.6998 head_norm=1.160461
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.341772e-01
[S10] stored merged vector for next round verification (round=10)
[S10] DEBUG after merge:  round=10 metric=0.6983 head_norm=1.201522 delta_norm=0.134177
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.419 → S5@127.0.0.1:63205
[S14] ⇄ pheromone p=0.498 → S10@127.0.0.1:63211
[S17] ⇄ pheromone p=0.207 → S2@127.0.0.1:63202
[S16] ⇄ pheromone p=0.209 → S4@127.0.0.1:63204
[S2] START round=11 head_norm_before_train=1.036585 cos_to_last_merge=1.0000 (last merge round=10)
[S2] round=11 local utility u=0.251842 metrics={'f1_val': 0.7132811898907978, 'auprc': 0.7756660828221115, 'loss_val': 0.7416769350647874, 'psi': 0.7382351470633233}-{'f1_val': 0.6996654335675643, 'auprc': 0.6459748048961612, 'loss_val': 0.7745932260086761, 'psi': 0.678189182099003}
[S3] START round=11 head_norm_before_train=0.671012 cos_to_last_merge=1.0000 (last merge round=10)
[S3] round=11 local utility u=1.000000 metrics={'f1_val': 0.7005769689796157, 'auprc': 0.7958175350632525, 'loss_val': 0.723663318485784, 'psi': 0.7386731954130704}-{'f1_val': 0.4045316402820668, 'auprc': 0.6675388600448553, 'loss_val': 0.9160435562978919, 'psi': 0.5097345281871822}
[S4] START round=11 head_norm_before_train=1.244655 cos_to_last_merge=0.8791 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.879
[S4] round=11 local utility u=0.000000 metrics={'f1_val': 0.6661827205869107, 'auprc': 0.6331927795236624, 'loss_val': 0.5756040487085182, 'psi': 0.6529867441616114}-{'f1_val': 0.6676503405542982, 'auprc': 0.6488935110610137, 'loss_val': 0.6139765425217176, 'psi': 0.6601476087569844}
[S5] START round=11 head_norm_before_train=0.841866 cos_to_last_merge=1.0000 (last merge round=10)
[S5] round=11 local utility u=0.070731 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.7928683540276746, 'loss_val': 0.7087002836855271, 'psi': 0.7373401320714181}-{'f1_val': 0.7003213174339138, 'auprc': 0.77808076192262, 'loss_val': 0.8057992377065367, 'psi': 0.7314250952293962}
[S6] START round=11 head_norm_before_train=0.996514 cos_to_last_merge=0.8864 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.886
[S6] round=11 local utility u=0.990592 metrics={'f1_val': 0.701773298255596, 'auprc': 0.8668232850157032, 'loss_val': 0.5230061933041069, 'psi': 0.7677932929596388}-{'f1_val': 0.4168551858772006, 'auprc': 0.8293011540092682, 'loss_val': 0.6821142748785944, 'psi': 0.5818335731300277}
[S7] START round=11 head_norm_before_train=0.968619 cos_to_last_merge=0.8874 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.887
[S7] round=11 local utility u=0.931522 metrics={'f1_val': 0.7138697760439328, 'auprc': 0.7879982807242839, 'loss_val': 0.7469777598487203, 'psi': 0.7435211779160733}-{'f1_val': 0.41671011811102343, 'auprc': 0.7835234550516528, 'loss_val': 0.81363956581056, 'psi': 0.5634354528872751}
[S8] START round=11 head_norm_before_train=1.198448 cos_to_last_merge=0.8851 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.885
[S8] round=11 local utility u=0.083410 metrics={'f1_val': 0.7141742661762565, 'auprc': 0.9935422405005594, 'loss_val': 0.4437800094505468, 'psi': 0.8259214559059777}-{'f1_val': 0.7013113666637368, 'auprc': 0.9919699364985195, 'loss_val': 0.5287065155296926, 'psi': 0.8175747945976499}
[S9] START round=11 head_norm_before_train=1.289112 cos_to_last_merge=0.9128 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.913
[S9] round=11 local utility u=0.027301 metrics={'f1_val': 0.7016148490515617, 'auprc': 0.9987920994188759, 'loss_val': 0.3051907960313606, 'psi': 0.8204857491984874}-{'f1_val': 0.699058194053107, 'auprc': 0.9988104901637241, 'loss_val': 0.34450883056927795, 'psi': 0.8189591124973539}
[S10] START round=11 head_norm_before_train=1.201522 cos_to_last_merge=1.0000 (last merge round=10)
[S10] round=11 local utility u=0.015969 metrics={'f1_val': 0.70122799442703, 'auprc': 0.7852567041240447, 'loss_val': 0.6213486562776326, 'psi': 0.7348394783058358}-{'f1_val': 0.6997996028618443, 'auprc': 0.7956938050033, 'loss_val': 0.6760267746745188, 'psi': 0.7381572837184266}
[S11] START round=11 head_norm_before_train=0.643873 cos_to_last_merge=0.9841 (last merge round=9)
[S11] round=11 local utility u=0.056806 metrics={'f1_val': 0.39651855440916606, 'auprc': 0.8660644065992568, 'loss_val': 0.8969016004503062, 'psi': 0.5843368952852024}-{'f1_val': 0.39658602128368947, 'auprc': 0.8656326739573247, 'loss_val': 1.0096237341108936, 'psi': 0.5842046823531436}
[S13] START round=11 head_norm_before_train=1.373668 cos_to_last_merge=1.0000 (last merge round=10)
[S13] round=11 local utility u=0.355768 metrics={'f1_val': 0.5222294158827469, 'auprc': 0.6720877764500401, 'loss_val': 0.8068544042149826, 'psi': 0.5821727601096642}-{'f1_val': 0.41580726865236384, 'auprc': 0.6572859288360917, 'loss_val': 0.8354526613943503, 'psi': 0.512398732725855}
[S14] START round=11 head_norm_before_train=1.255647 cos_to_last_merge=0.9176 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.918
[S14] round=11 local utility u=0.000000 metrics={'f1_val': 0.7789493789464783, 'auprc': 0.9946819537008716, 'loss_val': 0.47019718165441565, 'psi': 0.8652424088482356}-{'f1_val': 0.8911735614570687, 'auprc': 0.9936954938540112, 'loss_val': 0.5707729767692453, 'psi': 0.9321823344158457}
[S15] START round=11 head_norm_before_train=1.402300 (no previous merge yet)
[S15] round=11 local utility u=0.000203 metrics={'f1_val': 0.7013127984932164, 'auprc': 0.9327611478036681, 'loss_val': 0.542259279400696, 'psi': 0.7938921382173971}-{'f1_val': 0.6776904196529242, 'auprc': 0.995856527119026, 'loss_val': 0.5902176988010286, 'psi': 0.804956862639365}
[S16] START round=11 head_norm_before_train=1.426798 (no previous merge yet)
[S16] round=11 local utility u=0.248782 metrics={'f1_val': 0.45612721440934106, 'auprc': 0.7620725423569784, 'loss_val': 0.6965230696965005, 'psi': 0.5785053455883961}-{'f1_val': 0.38746655130537916, 'auprc': 0.7465929551249599, 'loss_val': 0.7356841952885047, 'psi': 0.5311171128332115}
[S17] START round=11 head_norm_before_train=1.488958 (no previous merge yet)
[S17] round=11 local utility u=0.082416 metrics={'f1_val': 0.34790758375913644, 'auprc': 0.6858308581807641, 'loss_val': 0.9254286405063603, 'psi': 0.4830768935277875}-{'f1_val': 0.3376720807163392, 'auprc': 0.6975034628190759, 'loss_val': 1.0638646960873077, 'psi': 0.4816046335574339}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:63205
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:63204
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S5] → sending delta(kind=head bytes=1790) to S3@127.0.0.1:63203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S7] → sending delta(kind=head bytes=1788) to S3@127.0.0.1:63203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:63215
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:63204
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:63213
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:63212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:63213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:63203
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:63205
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:63202
[S16] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1790 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1788 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1797) from S9
[S5] cosine check vs S9: cos=0.7608
[S4] RECEIVED delta(kind=head bytes=1802) from S16
[S4] cosine check vs S16: cos=-0.0334
[S4] DROPPED delta from S16 (cos=-0.0334 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1801) from S2
[S4] cosine check vs S2: cos=-0.0387
[S4] DROPPED delta from S2 (cos=-0.0387 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1802) from S13
[S3] cosine check vs S13: cos=-0.0581
[S3] DROPPED delta from S13 (cos=-0.0581 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1801) from S10
[S5] cosine check vs S10: cos=0.6463
[S2] RECEIVED delta(kind=head bytes=1795) from S8
[S2] cosine check vs S8: cos=0.9379
[S15] RECEIVED delta(kind=head bytes=1797) from S11
[S15] cosine check vs S11: cos=-0.0365
[S15] DROPPED delta from S11 (cos=-0.0365 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1799) from S15
[S13] cosine check vs S15: cos=0.9937
[S13] RECEIVED delta(kind=head bytes=1798) from S6
[S13] cosine check vs S6: cos=-0.0341
[S13] DROPPED delta from S6 (cos=-0.0341 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1788) from S7
[S3] cosine check vs S7: cos=0.8087
[S3] RECEIVED delta(kind=head bytes=1790) from S5
[S3] cosine check vs S5: cos=0.6612
[S11] RECEIVED delta(kind=head bytes=1800) from S3
[S11] cosine check vs S3: cos=0.8288
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S2@127.0.0.1:63202
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1803) from S17
[S2] cosine check vs S17: cos=0.3545
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=11 metric=0.7003 head_norm=0.871888
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.133319e-01
[S5] stored merged vector for next round verification (round=11)
[S5] DEBUG after merge:  round=11 metric=0.7006 head_norm=0.894707 delta_norm=0.113332
[S5] aggregate: ACCEPT kept=['S9', 'S10'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=11 metric=0.3965 head_norm=0.702497
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.073487e-01
[S11] stored merged vector for next round verification (round=11)
[S11] DEBUG after merge:  round=11 metric=0.3965 head_norm=0.677385 delta_norm=0.207349
[S11] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=11 metric=0.5222 head_norm=1.396648
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.335380e-02
[S13] stored merged vector for next round verification (round=11)
[S13] DEBUG after merge:  round=11 metric=0.5365 head_norm=1.418445 delta_norm=0.083354
[S13] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=11 metric=0.7006 head_norm=0.714272
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.253733e-01
[S3] stored merged vector for next round verification (round=11)
[S3] DEBUG after merge:  round=11 metric=0.7008 head_norm=0.715486 delta_norm=0.125373
[S3] aggregate: ACCEPT kept=['S7', 'S5'] (k=2/2) mode=median trim_p=0.1
[S2] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=11 metric=0.7133 head_norm=1.080450
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.045138e-01
[S2] stored merged vector for next round verification (round=11)
[S2] DEBUG after merge:  round=11 metric=0.7130 head_norm=1.008688 delta_norm=0.304514
[S2] aggregate: ACCEPT kept=['S8', 'S17'] (k=2/2) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.008688 cos_to_last_merge=1.0000 (last merge round=11)
[S2] round=12 local utility u=0.043023 metrics={'f1_val': 0.7081002213481051, 'auprc': 0.7763245310676502, 'loss_val': 0.6265214509424732, 'psi': 0.7353899452359232}-{'f1_val': 0.7132811898907978, 'auprc': 0.7756660828221115, 'loss_val': 0.7416769350647874, 'psi': 0.7382351470633233}
[S3] START round=12 head_norm_before_train=0.715486 cos_to_last_merge=1.0000 (last merge round=11)
[S3] round=12 local utility u=0.027129 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.7959358710824193, 'loss_val': 0.6708359766559505, 'psi': 0.7388280706741475}-{'f1_val': 0.7005769689796157, 'auprc': 0.7958175350632525, 'loss_val': 0.723663318485784, 'psi': 0.7386731954130704}
[S4] START round=12 head_norm_before_train=1.290248 cos_to_last_merge=0.8638 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.864
[S4] round=12 local utility u=0.403213 metrics={'f1_val': 0.6649250628918942, 'auprc': 0.9013307457058326, 'loss_val': 0.5660455087613385, 'psi': 0.7594873360174696}-{'f1_val': 0.6661827205869107, 'auprc': 0.6331927795236624, 'loss_val': 0.5756040487085182, 'psi': 0.6529867441616114}
[S5] START round=12 head_norm_before_train=0.894707 cos_to_last_merge=1.0000 (last merge round=11)
[S5] round=12 local utility u=0.035326 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.79306284584547, 'loss_val': 0.638631287773811, 'psi': 0.7374179287985363}-{'f1_val': 0.7003213174339138, 'auprc': 0.7928683540276746, 'loss_val': 0.7087002836855271, 'psi': 0.7373401320714181}
[S6] START round=12 head_norm_before_train=1.047161 cos_to_last_merge=0.8664 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.866
[S6] round=12 local utility u=0.000000 metrics={'f1_val': 0.6185116309668244, 'auprc': 0.7809364161414154, 'loss_val': 0.5775432828984838, 'psi': 0.6834815450366608}-{'f1_val': 0.701773298255596, 'auprc': 0.8668232850157032, 'loss_val': 0.5230061933041069, 'psi': 0.7677932929596388}
[S7] START round=12 head_norm_before_train=1.005227 cos_to_last_merge=0.8695 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.870
[S7] round=12 local utility u=0.000000 metrics={'f1_val': 0.6690576717487158, 'auprc': 0.7868558464781504, 'loss_val': 0.7105044486253865, 'psi': 0.7161769416404897}-{'f1_val': 0.7138697760439328, 'auprc': 0.7879982807242839, 'loss_val': 0.7469777598487203, 'psi': 0.7435211779160733}
[S8] START round=12 head_norm_before_train=1.252026 cos_to_last_merge=0.8638 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.864
[S8] round=12 local utility u=0.094503 metrics={'f1_val': 0.7161391439968701, 'auprc': 0.9981396632531447, 'loss_val': 0.28035547505535585, 'psi': 0.8289393516993799}-{'f1_val': 0.7141742661762565, 'auprc': 0.9935422405005594, 'loss_val': 0.4437800094505468, 'psi': 0.8259214559059777}
[S9] START round=12 head_norm_before_train=1.330769 cos_to_last_merge=0.8977 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.898
[S9] round=12 local utility u=0.006204 metrics={'f1_val': 0.7013646677191758, 'auprc': 0.9987752074381847, 'loss_val': 0.2912312582321463, 'psi': 0.8203288836067795}-{'f1_val': 0.7016148490515617, 'auprc': 0.9987920994188759, 'loss_val': 0.3051907960313606, 'psi': 0.8204857491984874}
[S10] START round=12 head_norm_before_train=1.229064 cos_to_last_merge=0.9973 (last merge round=10)
[S10] round=12 local utility u=0.609308 metrics={'f1_val': 0.7868944754748781, 'auprc': 0.981886052873326, 'loss_val': 0.5066190516618507, 'psi': 0.8648911064342573}-{'f1_val': 0.70122799442703, 'auprc': 0.7852567041240447, 'loss_val': 0.6213486562776326, 'psi': 0.7348394783058358}
[S11] START round=12 head_norm_before_train=0.677385 cos_to_last_merge=1.0000 (last merge round=11)
[S11] round=12 local utility u=0.003332 metrics={'f1_val': 0.3966054766658996, 'auprc': 0.8655603807663634, 'loss_val': 0.8892480042305316, 'psi': 0.5841874383060852}-{'f1_val': 0.39651855440916606, 'auprc': 0.8660644065992568, 'loss_val': 0.8969016004503062, 'psi': 0.5843368952852024}
[S13] START round=12 head_norm_before_train=1.418445 cos_to_last_merge=1.0000 (last merge round=11)
[S13] round=12 local utility u=0.555201 metrics={'f1_val': 0.6900393111141689, 'auprc': 0.6755617235643321, 'loss_val': 0.7137330259992339, 'psi': 0.6842482760942342}-{'f1_val': 0.5222294158827469, 'auprc': 0.6720877764500401, 'loss_val': 0.8068544042149826, 'psi': 0.5821727601096642}
[S14] START round=12 head_norm_before_train=1.301617 cos_to_last_merge=0.9080 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.908
[S14] round=12 local utility u=0.707413 metrics={'f1_val': 0.9972318496384239, 'auprc': 0.9971529557159269, 'loss_val': 0.37247946064110016, 'psi': 0.9972002920694252}-{'f1_val': 0.7789493789464783, 'auprc': 0.9946819537008716, 'loss_val': 0.47019718165441565, 'psi': 0.8652424088482356}
[S15] START round=12 head_norm_before_train=1.444729 (no previous merge yet)
[S15] round=12 local utility u=0.000000 metrics={'f1_val': 0.6705008078219626, 'auprc': 0.970963278493456, 'loss_val': 0.5171594911527985, 'psi': 0.79068579609056}-{'f1_val': 0.7013127984932164, 'auprc': 0.9327611478036681, 'loss_val': 0.542259279400696, 'psi': 0.7938921382173971}
[S16] START round=12 head_norm_before_train=1.470720 (no previous merge yet)
[S16] round=12 local utility u=0.441382 metrics={'f1_val': 0.5680663031402141, 'auprc': 0.8164421803164552, 'loss_val': 0.6485033890055653, 'psi': 0.6674166540107105}-{'f1_val': 0.45612721440934106, 'auprc': 0.7620725423569784, 'loss_val': 0.6965230696965005, 'psi': 0.5785053455883961}
[S17] START round=12 head_norm_before_train=1.515839 (no previous merge yet)
[S17] round=12 local utility u=0.061794 metrics={'f1_val': 0.3538469401662805, 'auprc': 0.674432817679498, 'loss_val': 0.8032835338509431, 'psi': 0.4820812911715675}-{'f1_val': 0.34790758375913644, 'auprc': 0.6858308581807641, 'loss_val': 0.9254286405063603, 'psi': 0.4830768935277875}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:63211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:63212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:63204
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S4] → sending delta(kind=head bytes=1806) to S7@127.0.0.1:63208
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] → sending delta(kind=head bytes=1793) to S3@127.0.0.1:63203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:63215
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:63205
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:63203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:63204
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:63202
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:63205
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1806 to 1 peers)
[S16] sending update (kind=head size=1803 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1793 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1798) from S14
[S10] cosine check vs S14: cos=0.9724
[S11] RECEIVED delta(kind=head bytes=1796) from S3
[S11] cosine check vs S3: cos=0.8989
[S7] RECEIVED delta(kind=head bytes=1806) from S4
[S7] cosine check vs S4: cos=-0.1321
[S7] DROPPED delta from S4 (cos=-0.1321 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1803) from S10
[S5] cosine check vs S10: cos=0.6649
[S3] RECEIVED delta(kind=head bytes=1793) from S5
[S3] cosine check vs S5: cos=0.6918
[S5] RECEIVED delta(kind=head bytes=1800) from S9
[S5] cosine check vs S9: cos=0.7553
[S2] RECEIVED delta(kind=head bytes=1802) from S8
[S2] cosine check vs S8: cos=0.8325
[S4] RECEIVED delta(kind=head bytes=1803) from S16
[S4] cosine check vs S16: cos=-0.0297
[S4] DROPPED delta from S16 (cos=-0.0297 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1799) from S13
[S3] cosine check vs S13: cos=-0.0621
[S3] DROPPED delta from S13 (cos=-0.0621 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1796) from S11
[S15] cosine check vs S11: cos=-0.0312
[S15] DROPPED delta from S11 (cos=-0.0312 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1799) from S2
[S4] cosine check vs S2: cos=-0.0454
[S4] DROPPED delta from S2 (cos=-0.0454 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:63202
[S17] sending update (kind=head size=1795 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1795) from S17
[S2] cosine check vs S17: cos=0.5872
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=12 metric=0.7869 head_norm=1.258995
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.584948e-01
[S10] stored merged vector for next round verification (round=12)
[S10] DEBUG after merge:  round=12 metric=0.9429 head_norm=1.292006 delta_norm=0.158495
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=12 metric=0.7081 head_norm=1.054222
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.725688e-01
[S2] stored merged vector for next round verification (round=12)
[S2] DEBUG after merge:  round=12 metric=0.7020 head_norm=1.039493 delta_norm=0.172569
[S2] aggregate: ROLLBACK (f1_val pre=0.708 post=0.702 tol_abs=0.005 tol_rel=0.0)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=12 metric=0.7008 head_norm=0.759676
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.392619e-01
[S3] stored merged vector for next round verification (round=12)
[S3] DEBUG after merge:  round=12 metric=0.7008 head_norm=0.775384 delta_norm=0.339262
[S3] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=12 metric=0.7003 head_norm=0.924949
[S5] _apply_head_vector_avg (torch): Δ‖w‖=9.304352e-02
[S5] stored merged vector for next round verification (round=12)
[S5] DEBUG after merge:  round=12 metric=0.7003 head_norm=0.934992 delta_norm=0.093044
[S5] aggregate: ACCEPT kept=['S10', 'S9'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=12 metric=0.3966 head_norm=0.728154
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.679278e-01
[S11] stored merged vector for next round verification (round=12)
[S11] DEBUG after merge:  round=12 metric=0.3973 head_norm=0.724885 delta_norm=0.167928
[S11] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.039493 cos_to_last_merge=1.0000 (last merge round=12)
[S2] round=13 local utility u=0.007054 metrics={'f1_val': 0.6994043095550904, 'auprc': 0.7766838463276071, 'loss_val': 0.5613149743856766, 'psi': 0.730316124264097}-{'f1_val': 0.7081002213481051, 'auprc': 0.7763245310676502, 'loss_val': 0.6265214509424732, 'psi': 0.7353899452359232}
[S3] START round=13 head_norm_before_train=0.775384 cos_to_last_merge=1.0000 (last merge round=12)
[S3] round=13 local utility u=0.000000 metrics={'f1_val': 0.7005813959920884, 'auprc': 0.7547587166786511, 'loss_val': 0.6682993995136742, 'psi': 0.7222523242667135}-{'f1_val': 0.7007562037352997, 'auprc': 0.7959358710824193, 'loss_val': 0.6708359766559505, 'psi': 0.7388280706741475}
[S4] START round=13 head_norm_before_train=1.328419 cos_to_last_merge=0.8504 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.850
[S4] round=13 local utility u=0.046591 metrics={'f1_val': 0.6656601370219275, 'auprc': 0.9253292213070525, 'loss_val': 0.5492703743670929, 'psi': 0.7695277707359776}-{'f1_val': 0.6649250628918942, 'auprc': 0.9013307457058326, 'loss_val': 0.5660455087613385, 'psi': 0.7594873360174696}
[S5] START round=13 head_norm_before_train=0.934992 cos_to_last_merge=1.0000 (last merge round=12)
[S5] round=13 local utility u=0.026145 metrics={'f1_val': 0.700320598491359, 'auprc': 0.7926673434946858, 'loss_val': 0.5851508577785319, 'psi': 0.7372592964926897}-{'f1_val': 0.7003213174339138, 'auprc': 0.79306284584547, 'loss_val': 0.638631287773811, 'psi': 0.7374179287985363}
[S6] START round=13 head_norm_before_train=1.090424 cos_to_last_merge=0.8500 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.850
[S6] round=13 local utility u=0.595251 metrics={'f1_val': 0.6964664592172121, 'auprc': 0.9640653618837718, 'loss_val': 0.4041563820653931, 'psi': 0.803506020283836}-{'f1_val': 0.6185116309668244, 'auprc': 0.7809364161414154, 'loss_val': 0.5775432828984838, 'psi': 0.6834815450366608}
[S7] START round=13 head_norm_before_train=1.044848 cos_to_last_merge=0.8518 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.852
[S7] round=13 local utility u=0.000000 metrics={'f1_val': 0.5516629317179946, 'auprc': 0.7815528241902419, 'loss_val': 0.7546521514652602, 'psi': 0.6436188887068935}-{'f1_val': 0.6690576717487158, 'auprc': 0.7868558464781504, 'loss_val': 0.7105044486253865, 'psi': 0.7161769416404897}
[S8] START round=13 head_norm_before_train=1.307192 cos_to_last_merge=0.8442 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.844
[S8] round=13 local utility u=0.873153 metrics={'f1_val': 0.995003834271124, 'auprc': 0.9980058917074864, 'loss_val': 0.20683680801628632, 'psi': 0.9962046572456691}-{'f1_val': 0.7161391439968701, 'auprc': 0.9981396632531447, 'loss_val': 0.28035547505535585, 'psi': 0.8289393516993799}
[S9] START round=13 head_norm_before_train=1.369676 cos_to_last_merge=0.8856 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.886
[S9] round=13 local utility u=0.001738 metrics={'f1_val': 0.7013646677191758, 'auprc': 0.9985799613325861, 'loss_val': 0.2871691728391237, 'psi': 0.82025078516454}-{'f1_val': 0.7013646677191758, 'auprc': 0.9987752074381847, 'loss_val': 0.2912312582321463, 'psi': 0.8203288836067795}
[S10] START round=13 head_norm_before_train=1.292006 cos_to_last_merge=1.0000 (last merge round=12)
[S10] round=13 local utility u=0.035221 metrics={'f1_val': 0.7837264862313063, 'auprc': 0.9947310977350373, 'loss_val': 0.45570501282640313, 'psi': 0.8681283308327987}-{'f1_val': 0.7868944754748781, 'auprc': 0.981886052873326, 'loss_val': 0.5066190516618507, 'psi': 0.8648911064342573}
[S11] START round=13 head_norm_before_train=0.724885 cos_to_last_merge=1.0000 (last merge round=12)
[S11] round=13 local utility u=0.414634 metrics={'f1_val': 0.5254107307788772, 'auprc': 0.8661101148523912, 'loss_val': 0.8344614868084517, 'psi': 0.6616904844082828}-{'f1_val': 0.3966054766658996, 'auprc': 0.8655603807663634, 'loss_val': 0.8892480042305316, 'psi': 0.5841874383060852}
[S13] START round=13 head_norm_before_train=1.441588 cos_to_last_merge=0.9994 (last merge round=11)
[S13] round=13 local utility u=0.019113 metrics={'f1_val': 0.6900393111141689, 'auprc': 0.672202325793824, 'loss_val': 0.6654281314868332, 'psi': 0.682904516986031}-{'f1_val': 0.6900393111141689, 'auprc': 0.6755617235643321, 'loss_val': 0.7137330259992339, 'psi': 0.6842482760942342}
[S14] START round=13 head_norm_before_train=1.343031 cos_to_last_merge=0.8994 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.899
[S14] round=13 local utility u=0.032489 metrics={'f1_val': 0.996821594728911, 'auprc': 0.9971561405300724, 'loss_val': 0.3050486715690964, 'psi': 0.9969554130493755}-{'f1_val': 0.9972318496384239, 'auprc': 0.9971529557159269, 'loss_val': 0.37247946064110016, 'psi': 0.9972002920694252}
[S15] START round=13 head_norm_before_train=1.489785 (no previous merge yet)
[S15] round=13 local utility u=0.173750 metrics={'f1_val': 0.699147240894093, 'auprc': 0.9852447174961364, 'loss_val': 0.3843815475756889, 'psi': 0.8135862315349104}-{'f1_val': 0.6705008078219626, 'auprc': 0.970963278493456, 'loss_val': 0.5171594911527985, 'psi': 0.79068579609056}
[S16] START round=13 head_norm_before_train=1.511078 (no previous merge yet)
[S16] round=13 local utility u=0.167749 metrics={'f1_val': 0.5489326196401876, 'auprc': 0.912232765801875, 'loss_val': 0.48557511705827905, 'psi': 0.6942526781048626}-{'f1_val': 0.5680663031402141, 'auprc': 0.8164421803164552, 'loss_val': 0.6485033890055653, 'psi': 0.6674166540107105}
[S17] START round=13 head_norm_before_train=1.541755 (no previous merge yet)
[S17] round=13 local utility u=0.365597 metrics={'f1_val': 0.3934992886579963, 'auprc': 0.7795464288411857, 'loss_val': 0.6253444389330172, 'psi': 0.5479181447312721}-{'f1_val': 0.3538469401662805, 'auprc': 0.674432817679498, 'loss_val': 0.8032835338509431, 'psi': 0.4820812911715675}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:63203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:63213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:63211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:63208
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S2@127.0.0.1:63202
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:63205
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:63204
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:63215
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:63205
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:63204
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:63203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S6] → sending delta(kind=head bytes=1791) to S13@127.0.0.1:63213
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1794 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1804 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1804 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1791 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1799) from S16
[S4] cosine check vs S16: cos=-0.0269
[S4] DROPPED delta from S16 (cos=-0.0269 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1801) from S2
[S4] cosine check vs S2: cos=-0.0449
[S4] DROPPED delta from S2 (cos=-0.0449 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1799) from S11
[S15] cosine check vs S11: cos=-0.0289
[S15] DROPPED delta from S11 (cos=-0.0289 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1800) from S14
[S10] cosine check vs S14: cos=0.9853
[S3] RECEIVED delta(kind=head bytes=1794) from S5
[S3] cosine check vs S5: cos=0.9099
[S3] RECEIVED delta(kind=head bytes=1798) from S13
[S3] cosine check vs S13: cos=0.0112
[S13] RECEIVED delta(kind=head bytes=1791) from S6
[S13] cosine check vs S6: cos=-0.0443
[S13] DROPPED delta from S6 (cos=-0.0443 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1804) from S10
[S5] cosine check vs S10: cos=0.6761
[S5] RECEIVED delta(kind=head bytes=1801) from S9
[S5] cosine check vs S9: cos=0.7520
[S13] RECEIVED delta(kind=head bytes=1802) from S15
[S13] cosine check vs S15: cos=0.9908
[S7] RECEIVED delta(kind=head bytes=1801) from S4
[S7] cosine check vs S4: cos=-0.1326
[S7] DROPPED delta from S4 (cos=-0.1326 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1804) from S8
[S2] cosine check vs S8: cos=0.7613
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:63202
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1801) from S17
[S2] cosine check vs S17: cos=0.6857
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=13 metric=0.7006 head_norm=0.815858
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.355840e-01
[S3] stored merged vector for next round verification (round=13)
[S3] DEBUG after merge:  round=13 metric=0.7006 head_norm=0.745094 delta_norm=0.435584
[S3] aggregate: ACCEPT kept=['S5', 'S13'] (k=2/2) mode=median trim_p=0.1
[S2] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=13 metric=0.6994 head_norm=1.082509
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.169298e-01
[S2] stored merged vector for next round verification (round=13)
[S2] DEBUG after merge:  round=13 metric=0.6994 head_norm=1.074386 delta_norm=0.116930
[S2] aggregate: ACCEPT kept=['S8', 'S17'] (k=2/2) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=13 metric=0.6900 head_norm=1.465971
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.057835e-01
[S13] stored merged vector for next round verification (round=13)
[S13] DEBUG after merge:  round=13 metric=0.6890 head_norm=1.492813 delta_norm=0.105783
[S13] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=13 metric=0.7003 head_norm=0.966470
[S5] _apply_head_vector_avg (torch): Δ‖w‖=9.634056e-02
[S5] stored merged vector for next round verification (round=13)
[S5] DEBUG after merge:  round=13 metric=0.7003 head_norm=0.974527 delta_norm=0.096341
[S5] aggregate: ACCEPT kept=['S10', 'S9'] (k=2/2) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=13 metric=0.7837 head_norm=1.319200
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.197068e-01
[S10] stored merged vector for next round verification (round=13)
[S10] DEBUG after merge:  round=13 metric=0.8765 head_norm=1.345410 delta_norm=0.119707
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.074386 cos_to_last_merge=1.0000 (last merge round=13)
[S2] round=14 local utility u=0.028079 metrics={'f1_val': 0.699489610203798, 'auprc': 0.7781232833186729, 'loss_val': 0.5099872686510287, 'psi': 0.730943079449748}-{'f1_val': 0.6994043095550904, 'auprc': 0.7766838463276071, 'loss_val': 0.5613149743856766, 'psi': 0.730316124264097}
[S3] START round=14 head_norm_before_train=0.745094 cos_to_last_merge=1.0000 (last merge round=13)
[S3] round=14 local utility u=0.000000 metrics={'f1_val': 0.7008317350254774, 'auprc': 0.6805460691899454, 'loss_val': 0.6730866083668336, 'psi': 0.6927174686912646}-{'f1_val': 0.7005813959920884, 'auprc': 0.7547587166786511, 'loss_val': 0.6682993995136742, 'psi': 0.7222523242667135}
[S4] START round=14 head_norm_before_train=1.360753 cos_to_last_merge=0.8399 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.840
[S4] round=14 local utility u=0.016178 metrics={'f1_val': 0.665961443619184, 'auprc': 0.9310842873004898, 'loss_val': 0.5359879677441008, 'psi': 0.7720105810917064}-{'f1_val': 0.6656601370219275, 'auprc': 0.9253292213070525, 'loss_val': 0.5492703743670929, 'psi': 0.7695277707359776}
[S5] START round=14 head_norm_before_train=0.974527 cos_to_last_merge=1.0000 (last merge round=13)
[S5] round=14 local utility u=0.042639 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.8063690098190077, 'loss_val': 0.5409824512666824, 'psi': 0.7427403943879514}-{'f1_val': 0.700320598491359, 'auprc': 0.7926673434946858, 'loss_val': 0.5851508577785319, 'psi': 0.7372592964926897}
[S6] START round=14 head_norm_before_train=1.125175 cos_to_last_merge=0.8388 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.839
[S6] round=14 local utility u=0.000000 metrics={'f1_val': 0.6989155946034424, 'auprc': 0.9547235838233801, 'loss_val': 0.40264570222101986, 'psi': 0.8012387902914175}-{'f1_val': 0.6964664592172121, 'auprc': 0.9640653618837718, 'loss_val': 0.4041563820653931, 'psi': 0.803506020283836}
[S7] START round=14 head_norm_before_train=1.079293 cos_to_last_merge=0.8382 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.838
[S7] round=14 local utility u=0.446679 metrics={'f1_val': 0.6722156823250268, 'auprc': 0.7850220554205913, 'loss_val': 0.5950191816745657, 'psi': 0.7173382315632526}-{'f1_val': 0.5516629317179946, 'auprc': 0.7815528241902419, 'loss_val': 0.7546521514652602, 'psi': 0.6436188887068935}
[S8] START round=14 head_norm_before_train=1.358207 cos_to_last_merge=0.8278 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.828
[S8] round=14 local utility u=0.000000 metrics={'f1_val': 0.7529078905745998, 'auprc': 0.9965450760858299, 'loss_val': 0.1833963390962123, 'psi': 0.8503627647790919}-{'f1_val': 0.995003834271124, 'auprc': 0.9980058917074864, 'loss_val': 0.20683680801628632, 'psi': 0.9962046572456691}
[S9] START round=14 head_norm_before_train=1.401899 cos_to_last_merge=0.8746 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.875
[S9] round=14 local utility u=0.003250 metrics={'f1_val': 0.7013646677191758, 'auprc': 0.9985782361281113, 'loss_val': 0.28066330898796055, 'psi': 0.82025009508275}-{'f1_val': 0.7013646677191758, 'auprc': 0.9985799613325861, 'loss_val': 0.2871691728391237, 'psi': 0.82025078516454}
[S10] START round=14 head_norm_before_train=1.345410 cos_to_last_merge=1.0000 (last merge round=13)
[S10] round=14 local utility u=0.266810 metrics={'f1_val': 0.8659046660129857, 'auprc': 0.9950106160059473, 'loss_val': 0.41599224700996135, 'psi': 0.9175470460101703}-{'f1_val': 0.7837264862313063, 'auprc': 0.9947310977350373, 'loss_val': 0.45570501282640313, 'psi': 0.8681283308327987}
[S11] START round=14 head_norm_before_train=0.772335 cos_to_last_merge=0.9915 (last merge round=12)
[S11] round=14 local utility u=0.578474 metrics={'f1_val': 0.6976938415077695, 'auprc': 0.8656301512725237, 'loss_val': 0.7097720882333641, 'psi': 0.7648683654136712}-{'f1_val': 0.5254107307788772, 'auprc': 0.8661101148523912, 'loss_val': 0.8344614868084517, 'psi': 0.6616904844082828}
[S13] START round=14 head_norm_before_train=1.492813 cos_to_last_merge=1.0000 (last merge round=13)
[S13] round=14 local utility u=0.074267 metrics={'f1_val': 0.7118396729657227, 'auprc': 0.6709859099567732, 'loss_val': 0.6440460944005038, 'psi': 0.6954981677621429}-{'f1_val': 0.6900393111141689, 'auprc': 0.672202325793824, 'loss_val': 0.6654281314868332, 'psi': 0.682904516986031}
[S14] START round=14 head_norm_before_train=1.381532 cos_to_last_merge=0.8921 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.892
[S14] round=14 local utility u=0.024907 metrics={'f1_val': 0.9965795690206102, 'auprc': 0.9971567901177572, 'loss_val': 0.25378376033870087, 'psi': 0.996810457459469}-{'f1_val': 0.996821594728911, 'auprc': 0.9971561405300724, 'loss_val': 0.3050486715690964, 'psi': 0.9969554130493755}
[S15] START round=14 head_norm_before_train=1.526528 (no previous merge yet)
[S15] round=14 local utility u=0.008365 metrics={'f1_val': 0.692736563472482, 'auprc': 0.9898299386800349, 'loss_val': 0.34294356219150457, 'psi': 0.8115739135555031}-{'f1_val': 0.699147240894093, 'auprc': 0.9852447174961364, 'loss_val': 0.3843815475756889, 'psi': 0.8135862315349104}
[S16] START round=14 head_norm_before_train=1.541701 (no previous merge yet)
[S16] round=14 local utility u=0.961737 metrics={'f1_val': 0.8675208037961846, 'auprc': 0.925124477250878, 'loss_val': 0.5123057529526077, 'psi': 0.890562273178062}-{'f1_val': 0.5489326196401876, 'auprc': 0.912232765801875, 'loss_val': 0.48557511705827905, 'psi': 0.6942526781048626}
[S17] START round=14 head_norm_before_train=1.565383 (no previous merge yet)
[S17] round=14 local utility u=0.810140 metrics={'f1_val': 0.6162058441153657, 'auprc': 0.8367626121055483, 'loss_val': 0.5129516948587258, 'psi': 0.7044285513114388}-{'f1_val': 0.3934992886579963, 'auprc': 0.7795464288411857, 'loss_val': 0.6253444389330172, 'psi': 0.5479181447312721}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:63203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:63211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:63215
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:63213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:63205
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:63203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:63208
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] → sending delta(kind=head bytes=1804) to S3@127.0.0.1:63203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] → sending delta(kind=head bytes=1793) to S4@127.0.0.1:63204
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:63204
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S9] → sending delta(kind=head bytes=1806) to S5@127.0.0.1:63205
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1793 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1804 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1806 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1806) from S9
[S5] cosine check vs S9: cos=0.7503
[S10] RECEIVED delta(kind=head bytes=1797) from S14
[S10] cosine check vs S14: cos=0.9905
[S4] RECEIVED delta(kind=head bytes=1793) from S2
[S4] cosine check vs S2: cos=-0.0400
[S4] DROPPED delta from S2 (cos=-0.0400 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1797) from S16
[S4] cosine check vs S16: cos=-0.0254
[S4] DROPPED delta from S16 (cos=-0.0254 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1804) from S13
[S3] cosine check vs S13: cos=0.4907
[S3] RECEIVED delta(kind=head bytes=1796) from S5
[S3] cosine check vs S5: cos=0.8422
[S13] RECEIVED delta(kind=head bytes=1800) from S15
[S13] cosine check vs S15: cos=0.9951
[S3] RECEIVED delta(kind=head bytes=1796) from S7
[S3] cosine check vs S7: cos=0.3322
[S7] RECEIVED delta(kind=head bytes=1803) from S4
[S7] cosine check vs S4: cos=-0.1329
[S7] DROPPED delta from S4 (cos=-0.1329 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1796) from S11
[S15] cosine check vs S11: cos=-0.0118
[S15] DROPPED delta from S11 (cos=-0.0118 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1802) from S10
[S5] cosine check vs S10: cos=0.6851
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:63202
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1799) from S17
[S2] cosine check vs S17: cos=0.7243
[S3] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=14 metric=0.7008 head_norm=0.784118
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.383740e-01
[S3] stored merged vector for next round verification (round=14)
[S3] DEBUG after merge:  round=14 metric=0.7008 head_norm=0.741687 delta_norm=0.138374
[S3] aggregate: ACCEPT kept=['S13', 'S5', 'S7'] (k=3/3) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=14 metric=0.7003 head_norm=1.006574
[S5] _apply_head_vector_avg (torch): Δ‖w‖=9.441007e-02
[S5] stored merged vector for next round verification (round=14)
[S5] DEBUG after merge:  round=14 metric=0.7003 head_norm=1.011373 delta_norm=0.094410
[S5] aggregate: ACCEPT kept=['S9', 'S10'] (k=2/2) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=14 metric=0.6995 head_norm=1.119243
[S2] _apply_head_vector_avg (torch): Δ‖w‖=5.488005e-01
[S2] stored merged vector for next round verification (round=14)
[S2] DEBUG after merge:  round=14 metric=0.6997 head_norm=1.261389 delta_norm=0.548800
[S2] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=14 metric=0.7118 head_norm=1.513389
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.034354e-02
[S13] stored merged vector for next round verification (round=14)
[S13] DEBUG after merge:  round=14 metric=0.7118 head_norm=1.536216 delta_norm=0.080344
[S13] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=14 metric=0.8659 head_norm=1.373201
[S10] _apply_head_vector_avg (torch): Δ‖w‖=9.863698e-02
[S10] stored merged vector for next round verification (round=14)
[S10] DEBUG after merge:  round=14 metric=0.9649 head_norm=1.392122 delta_norm=0.098637
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.261389 cos_to_last_merge=1.0000 (last merge round=14)
[S2] round=15 local utility u=0.022518 metrics={'f1_val': 0.6996741554113749, 'auprc': 0.786626071943038, 'loss_val': 0.4915675258463598, 'psi': 0.7344549220240402}-{'f1_val': 0.699489610203798, 'auprc': 0.7781232833186729, 'loss_val': 0.5099872686510287, 'psi': 0.730943079449748}
[S3] START round=15 head_norm_before_train=0.741687 cos_to_last_merge=1.0000 (last merge round=14)
[S3] round=15 local utility u=0.044375 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.680972752545001, 'loss_val': 0.5851630261377025, 'psi': 0.6928428232591801}-{'f1_val': 0.7008317350254774, 'auprc': 0.6805460691899454, 'loss_val': 0.6730866083668336, 'psi': 0.6927174686912646}
[S4] START round=15 head_norm_before_train=1.387982 cos_to_last_merge=0.8308 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.831
[S4] round=15 local utility u=0.021083 metrics={'f1_val': 0.6681396736143812, 'auprc': 0.9371410893844418, 'loss_val': 0.5250618901795803, 'psi': 0.7757402399224055}-{'f1_val': 0.665961443619184, 'auprc': 0.9310842873004898, 'loss_val': 0.5359879677441008, 'psi': 0.7720105810917064}
[S5] START round=15 head_norm_before_train=1.011373 cos_to_last_merge=1.0000 (last merge round=14)
[S5] round=15 local utility u=0.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.7786307923646245, 'loss_val': 0.5489067323050988, 'psi': 0.7316446760406652}-{'f1_val': 0.7003213174339138, 'auprc': 0.8063690098190077, 'loss_val': 0.5409824512666824, 'psi': 0.7427403943879514}
[S6] START round=15 head_norm_before_train=1.156805 cos_to_last_merge=0.8303 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.830
[S6] round=15 local utility u=0.037989 metrics={'f1_val': 0.69861470155377, 'auprc': 0.9630337773660592, 'loss_val': 0.34979227187562734, 'psi': 0.8043823318786857}-{'f1_val': 0.6989155946034424, 'auprc': 0.9547235838233801, 'loss_val': 0.40264570222101986, 'psi': 0.8012387902914175}
[S7] START round=15 head_norm_before_train=1.101819 cos_to_last_merge=0.8300 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.830
[S7] round=15 local utility u=0.000000 metrics={'f1_val': 0.582171113102236, 'auprc': 0.7745598282629913, 'loss_val': 0.7090464773781218, 'psi': 0.6591265991665382}-{'f1_val': 0.6722156823250268, 'auprc': 0.7850220554205913, 'loss_val': 0.5950191816745657, 'psi': 0.7173382315632526}
[S8] START round=15 head_norm_before_train=1.407887 cos_to_last_merge=0.8126 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.813
[S8] round=15 local utility u=0.752004 metrics={'f1_val': 0.9943590272655265, 'auprc': 0.9958924733405468, 'loss_val': 0.12613775406782365, 'psi': 0.9949724056955347}-{'f1_val': 0.7529078905745998, 'auprc': 0.9965450760858299, 'loss_val': 0.1833963390962123, 'psi': 0.8503627647790919}
[S9] START round=15 head_norm_before_train=1.431146 cos_to_last_merge=0.8668 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.867
[S9] round=15 local utility u=0.004758 metrics={'f1_val': 0.7013629453504064, 'auprc': 0.9987646283525031, 'loss_val': 0.2716966313265098, 'psi': 0.820323618551245}-{'f1_val': 0.7013646677191758, 'auprc': 0.9985782361281113, 'loss_val': 0.28066330898796055, 'psi': 0.82025009508275}
[S10] START round=15 head_norm_before_train=1.392122 cos_to_last_merge=1.0000 (last merge round=14)
[S10] round=15 local utility u=0.000000 metrics={'f1_val': 0.8128555900704789, 'auprc': 0.9925287880881275, 'loss_val': 0.44019112994876314, 'psi': 0.8847248692775384}-{'f1_val': 0.8659046660129857, 'auprc': 0.9950106160059473, 'loss_val': 0.41599224700996135, 'psi': 0.9175470460101703}
[S11] START round=15 head_norm_before_train=0.830640 cos_to_last_merge=0.9727 (last merge round=12)
[S11] round=15 local utility u=0.078538 metrics={'f1_val': 0.7017589383281313, 'auprc': 0.865325554698306, 'loss_val': 0.5761719196179856, 'psi': 0.7671855848762013}-{'f1_val': 0.6976938415077695, 'auprc': 0.8656301512725237, 'loss_val': 0.7097720882333641, 'psi': 0.7648683654136712}
[S13] START round=15 head_norm_before_train=1.536216 cos_to_last_merge=1.0000 (last merge round=14)
[S13] round=15 local utility u=0.000000 metrics={'f1_val': 0.7121045034741973, 'auprc': 0.6710899699126772, 'loss_val': 0.6739363619021426, 'psi': 0.6956986900495893}-{'f1_val': 0.7118396729657227, 'auprc': 0.6709859099567732, 'loss_val': 0.6440460944005038, 'psi': 0.6954981677621429}
[S14] START round=15 head_norm_before_train=1.417668 cos_to_last_merge=0.8859 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.886
[S14] round=15 local utility u=0.020389 metrics={'f1_val': 0.9963376686748938, 'auprc': 0.9971578047643448, 'loss_val': 0.21155705238402434, 'psi': 0.9966657231106741}-{'f1_val': 0.9965795690206102, 'auprc': 0.9971567901177572, 'loss_val': 0.25378376033870087, 'psi': 0.996810457459469}
[S15] START round=15 head_norm_before_train=1.562845 (no previous merge yet)
[S15] round=15 local utility u=0.003056 metrics={'f1_val': 0.6925019503770578, 'auprc': 0.9875566537638232, 'loss_val': 0.32860406725608854, 'psi': 0.8105238317317639}-{'f1_val': 0.692736563472482, 'auprc': 0.9898299386800349, 'loss_val': 0.34294356219150457, 'psi': 0.8115739135555031}
[S16] START round=15 head_norm_before_train=1.570120 (no previous merge yet)
[S16] round=15 local utility u=0.411432 metrics={'f1_val': 0.9310023072572368, 'auprc': 0.9926284366525238, 'loss_val': 0.2728432856134197, 'psi': 0.9556527590153516}-{'f1_val': 0.8675208037961846, 'auprc': 0.925124477250878, 'loss_val': 0.5123057529526077, 'psi': 0.890562273178062}
[S17] START round=15 head_norm_before_train=1.591183 (no previous merge yet)
[S17] round=15 local utility u=0.000000 metrics={'f1_val': 0.5670726802050667, 'auprc': 0.8797128777867171, 'loss_val': 0.5786659448645427, 'psi': 0.692128759237727}-{'f1_val': 0.6162058441153657, 'auprc': 0.8367626121055483, 'loss_val': 0.5129516948587258, 'psi': 0.7044285513114388}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] → sending delta(kind=head bytes=1805) to S2@127.0.0.1:63202
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:63203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] → sending delta(kind=head bytes=1793) to S8@127.0.0.1:63209
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S9] sending update (kind=head size=1806 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:63205
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:63212
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1793 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1805 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1801) from S11
[S3] cosine check vs S11: cos=0.7218
[S8] RECEIVED delta(kind=head bytes=1793) from S2
[S8] cosine check vs S2: cos=0.3924
[S11] RECEIVED delta(kind=head bytes=1800) from S15
[S11] cosine check vs S15: cos=0.0016
[S5] RECEIVED delta(kind=head bytes=1798) from S3
[S5] cosine check vs S3: cos=0.8280
[S2] RECEIVED delta(kind=head bytes=1805) from S4
[S2] cosine check vs S4: cos=-0.0581
[S2] DROPPED delta from S4 (cos=-0.0581 < 0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=15 metric=0.7003 head_norm=1.040766
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.939214e-01
[S5] stored merged vector for next round verification (round=15)
[S5] DEBUG after merge:  round=15 metric=0.7003 head_norm=0.876622 delta_norm=0.293921
[S5] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.132 → S10@127.0.0.1:63211
[S10] ⇄ pheromone p=0.248 → S14@127.0.0.1:63214
[S7] ⇄ pheromone p=0.224 → S4@127.0.0.1:63204
[S13] ⇄ pheromone p=0.186 → S15@127.0.0.1:63215
[S4] ⇄ pheromone p=0.147 → S2@127.0.0.1:63202
[S15] ⇄ pheromone p=0.166 → S11@127.0.0.1:63212
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=15 metric=0.7008 head_norm=0.791528
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.177944e-01
[S3] stored merged vector for next round verification (round=15)
[S3] DEBUG after merge:  round=15 metric=0.7008 head_norm=0.781960 delta_norm=0.317794
[S3] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.194 → S5@127.0.0.1:63205
[S2] ⇄ pheromone p=0.152 → S8@127.0.0.1:63209
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=15 metric=0.7018 head_norm=0.893527
[S11] _apply_head_vector_avg (torch): Δ‖w‖=9.134231e-01
[S11] stored merged vector for next round verification (round=15)
[S11] DEBUG after merge:  round=15 metric=0.7018 head_norm=0.914708 delta_norm=0.913423
[S11] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.278 → S3@127.0.0.1:63203
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=15 metric=0.9944 head_norm=1.452106
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.608759e-01
[S8] stored merged vector for next round verification (round=15)
[S8] DEBUG after merge:  round=15 metric=0.9940 head_norm=1.148502 delta_norm=0.760876
[S8] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.379 → S2@127.0.0.1:63202
[S2] START round=16 head_norm_before_train=1.298988 cos_to_last_merge=0.9981 (last merge round=14)
[S2] round=16 local utility u=0.000000 metrics={'f1_val': 0.6995078406626564, 'auprc': 0.7458462719666041, 'loss_val': 0.4114907225710848, 'psi': 0.7180432131842355}-{'f1_val': 0.6996741554113749, 'auprc': 0.786626071943038, 'loss_val': 0.4915675258463598, 'psi': 0.7344549220240402}
[S3] START round=16 head_norm_before_train=0.781960 cos_to_last_merge=1.0000 (last merge round=15)
[S3] round=16 local utility u=0.066091 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.6816200758518351, 'loss_val': 0.4549228413649769, 'psi': 0.6931017525819139}-{'f1_val': 0.7007562037352997, 'auprc': 0.680972752545001, 'loss_val': 0.5851630261377025, 'psi': 0.6928428232591801}
[S4] START round=16 head_norm_before_train=1.411372 cos_to_last_merge=0.8228 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.823
[S4] round=16 local utility u=0.858347 metrics={'f1_val': 0.9530507092738599, 'auprc': 0.936827833444264, 'loss_val': 0.5168947843497915, 'psi': 0.9465615589420215}-{'f1_val': 0.6681396736143812, 'auprc': 0.9371410893844418, 'loss_val': 0.5250618901795803, 'psi': 0.7757402399224055}
[S5] START round=16 head_norm_before_train=0.876622 cos_to_last_merge=1.0000 (last merge round=15)
[S5] round=16 local utility u=0.008000 metrics={'f1_val': 0.7011739492493075, 'auprc': 0.7910906008859488, 'loss_val': 0.5754071657788596, 'psi': 0.7371406099039641}-{'f1_val': 0.700320598491359, 'auprc': 0.7786307923646245, 'loss_val': 0.5489067323050988, 'psi': 0.7316446760406652}
[S6] START round=16 head_norm_before_train=1.187167 cos_to_last_merge=0.8242 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.824
[S6] round=16 local utility u=0.000000 metrics={'f1_val': 0.7074444286310667, 'auprc': 0.8103947697907192, 'loss_val': 0.40224592495411715, 'psi': 0.7486245650949277}-{'f1_val': 0.69861470155377, 'auprc': 0.9630337773660592, 'loss_val': 0.34979227187562734, 'psi': 0.8043823318786857}
[S7] START round=16 head_norm_before_train=1.118556 cos_to_last_merge=0.8244 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.824
[S7] round=16 local utility u=0.000000 metrics={'f1_val': 0.5672399960479262, 'auprc': 0.7832209211620755, 'loss_val': 0.7239970557133302, 'psi': 0.6536323660935859}-{'f1_val': 0.582171113102236, 'auprc': 0.7745598282629913, 'loss_val': 0.7090464773781218, 'psi': 0.6591265991665382}
[S8] START round=16 head_norm_before_train=1.148502 cos_to_last_merge=1.0000 (last merge round=15)
[S8] round=16 local utility u=0.000000 metrics={'f1_val': 0.9286953212237882, 'auprc': 0.9905864447826566, 'loss_val': 0.21397815154844846, 'psi': 0.9534517706473356}-{'f1_val': 0.9943590272655265, 'auprc': 0.9958924733405468, 'loss_val': 0.12613775406782365, 'psi': 0.9949724056955347}
[S9] START round=16 head_norm_before_train=1.454819 cos_to_last_merge=0.8621 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.862
[S9] round=16 local utility u=0.002093 metrics={'f1_val': 0.7013629453504064, 'auprc': 0.9987682164715024, 'loss_val': 0.2675220685937459, 'psi': 0.8203250537988448}-{'f1_val': 0.7013629453504064, 'auprc': 0.9987646283525031, 'loss_val': 0.2716966313265098, 'psi': 0.820323618551245}
[S10] START round=16 head_norm_before_train=1.421888 cos_to_last_merge=0.9989 (last merge round=14)
[S10] round=16 local utility u=0.031503 metrics={'f1_val': 0.804729025398645, 'auprc': 0.9949644565040829, 'loss_val': 0.3357334867535777, 'psi': 0.8808231978408202}-{'f1_val': 0.8128555900704789, 'auprc': 0.9925287880881275, 'loss_val': 0.44019112994876314, 'psi': 0.8847248692775384}
[S11] START round=16 head_norm_before_train=0.914708 cos_to_last_merge=1.0000 (last merge round=15)
[S11] round=16 local utility u=0.053746 metrics={'f1_val': 0.7017589383281313, 'auprc': 0.9368393571649051, 'loss_val': 0.6832212794504058, 'psi': 0.7957911058628409}-{'f1_val': 0.7017589383281313, 'auprc': 0.865325554698306, 'loss_val': 0.5761719196179856, 'psi': 0.7671855848762013}
[S13] START round=16 head_norm_before_train=1.555456 cos_to_last_merge=0.9997 (last merge round=14)
[S13] round=16 local utility u=0.000000 metrics={'f1_val': 0.6320575304597086, 'auprc': 0.6728391779715344, 'loss_val': 0.685920853957602, 'psi': 0.6483701894644389}-{'f1_val': 0.7121045034741973, 'auprc': 0.6710899699126772, 'loss_val': 0.6739363619021426, 'psi': 0.6956986900495893}
[S14] START round=16 head_norm_before_train=1.450432 cos_to_last_merge=0.8807 (last merge round=2)
[S14] ⚠️ Model drifted since last merge! cos=0.881
[S14] round=16 local utility u=0.019949 metrics={'f1_val': 0.9964424345629549, 'auprc': 0.9971580631759253, 'loss_val': 0.17228779597855853, 'psi': 0.996728686008143}-{'f1_val': 0.9963376686748938, 'auprc': 0.9971578047643448, 'loss_val': 0.21155705238402434, 'psi': 0.9966657231106741}
[S15] START round=16 head_norm_before_train=1.594890 (no previous merge yet)
[S15] round=16 local utility u=0.043675 metrics={'f1_val': 0.6910170134433689, 'auprc': 0.9899922348784271, 'loss_val': 0.2396506620184218, 'psi': 0.8106071020173922}-{'f1_val': 0.6925019503770578, 'auprc': 0.9875566537638232, 'loss_val': 0.32860406725608854, 'psi': 0.8105238317317639}
[S16] START round=16 head_norm_before_train=1.601352 (no previous merge yet)
[S16] round=16 local utility u=0.125368 metrics={'f1_val': 0.9563909819483605, 'auprc': 0.9937550070226477, 'loss_val': 0.1778189989479632, 'psi': 0.9713365919780754}-{'f1_val': 0.9310023072572368, 'auprc': 0.9926284366525238, 'loss_val': 0.2728432856134197, 'psi': 0.9556527590153516}
[S17] START round=16 head_norm_before_train=1.615479 (no previous merge yet)
[S17] round=16 local utility u=0.199946 metrics={'f1_val': 0.5863927756209439, 'auprc': 0.9615529637567042, 'loss_val': 0.5402142338365431, 'psi': 0.736456850875248}-{'f1_val': 0.5670726802050667, 'auprc': 0.8797128777867171, 'loss_val': 0.5786659448645427, 'psi': 0.692128759237727}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] → sending delta(kind=head bytes=1793) to S10@127.0.0.1:63211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S2@127.0.0.1:63202
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:63212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] → sending delta(kind=head bytes=1793) to S3@127.0.0.1:63203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:63211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:63214
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:63205
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1793 to 1 peers)
[S11] sending update (kind=head size=1793 to 1 peers)
[S4] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1793) from S5
[S10] cosine check vs S5: cos=0.6429
[S14] RECEIVED delta(kind=head bytes=1803) from S10
[S14] cosine check vs S10: cos=0.9860
[S3] RECEIVED delta(kind=head bytes=1793) from S11
[S3] cosine check vs S11: cos=0.6542
[S5] RECEIVED delta(kind=head bytes=1799) from S3
[S5] cosine check vs S3: cos=0.8451
[S10] RECEIVED delta(kind=head bytes=1803) from S14
[S10] cosine check vs S14: cos=0.9860
[S11] RECEIVED delta(kind=head bytes=1800) from S15
[S11] cosine check vs S15: cos=0.8412
[S2] RECEIVED delta(kind=head bytes=1803) from S4
[S2] cosine check vs S4: cos=-0.0589
[S2] DROPPED delta from S4 (cos=-0.0589 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] sending update (kind=head size=1795 to 1 peers)
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S17
[S3]  timeout peer S2
[S3]  timeout peer S4
[S3]  timeout peer S6
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S5
[S7]  timeout peer S6
[S5]  timeout peer S2
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S5]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S6]  timeout peer S17
[S2]  timeout peer S3
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=16 metric=0.7008 head_norm=0.846981
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.782167e-01
[S3] stored merged vector for next round verification (round=16)
[S3] DEBUG after merge:  round=16 metric=0.7008 head_norm=0.820392 delta_norm=0.378217
[S3] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=16 metric=0.7012 head_norm=0.905789
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.455093e-01
[S5] stored merged vector for next round verification (round=16)
[S5] DEBUG after merge:  round=16 metric=0.7008 head_norm=0.841808 delta_norm=0.245509
[S5] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=16 metric=0.8047 head_norm=1.450664
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.801706e-01
[S10] stored merged vector for next round verification (round=16)
[S10] DEBUG after merge:  round=16 metric=0.7903 head_norm=1.248683 delta_norm=0.280171
[S10] aggregate: ROLLBACK (f1_val pre=0.805 post=0.790 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=16 metric=0.9964 head_norm=1.479811
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.233045e-01
[S14] stored merged vector for next round verification (round=16)
[S14] DEBUG after merge:  round=16 metric=0.9980 head_norm=1.460113 delta_norm=0.123305
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=16 metric=0.7018 head_norm=0.956454
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.838135e-01
[S11] stored merged vector for next round verification (round=16)
[S11] DEBUG after merge:  round=16 metric=0.7017 head_norm=1.240684 delta_norm=0.483813
[S11] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.339681 cos_to_last_merge=0.9933 (last merge round=14)
[S2] round=17 local utility u=0.065133 metrics={'f1_val': 0.6995843541840225, 'auprc': 0.7876183045294818, 'loss_val': 0.40699972156220865, 'psi': 0.7347979343222062}-{'f1_val': 0.6995078406626564, 'auprc': 0.7458462719666041, 'loss_val': 0.4114907225710848, 'psi': 0.7180432131842355}
[S3] START round=17 head_norm_before_train=0.820392 cos_to_last_merge=1.0000 (last merge round=16)
[S3] round=17 local utility u=0.000000 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.6793330400597082, 'loss_val': 0.4613518794689447, 'psi': 0.6921869382650631}-{'f1_val': 0.7007562037352997, 'auprc': 0.6816200758518351, 'loss_val': 0.4549228413649769, 'psi': 0.6931017525819139}
[S4] START round=17 head_norm_before_train=1.434576 cos_to_last_merge=0.8156 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.816
[S4] round=17 local utility u=0.000000 metrics={'f1_val': 0.8208406911985079, 'auprc': 0.9402353659778191, 'loss_val': 0.525572066333318, 'psi': 0.8685985611102324}-{'f1_val': 0.9530507092738599, 'auprc': 0.936827833444264, 'loss_val': 0.5168947843497915, 'psi': 0.9465615589420215}
[S5] START round=17 head_norm_before_train=0.841808 cos_to_last_merge=1.0000 (last merge round=16)
[S5] round=17 local utility u=0.128647 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.8620280020772436, 'loss_val': 0.5258094636488061, 'psi': 0.7650039912912456}-{'f1_val': 0.7011739492493075, 'auprc': 0.7910906008859488, 'loss_val': 0.5754071657788596, 'psi': 0.7371406099039641}
[S6] START round=17 head_norm_before_train=1.223552 cos_to_last_merge=0.8176 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.818
[S6] round=17 local utility u=1.000000 metrics={'f1_val': 0.9600382356371215, 'auprc': 0.9581320518828372, 'loss_val': 0.28345601507886786, 'psi': 0.9592757621354079}-{'f1_val': 0.7074444286310667, 'auprc': 0.8103947697907192, 'loss_val': 0.40224592495411715, 'psi': 0.7486245650949277}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] sending update (kind=head size=1795 to 1 peers)
[S7] START round=17 head_norm_before_train=1.138135 cos_to_last_merge=0.8191 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.819
[S7] round=17 local utility u=0.000000 metrics={'f1_val': 0.5628341919671285, 'auprc': 0.7186928997327386, 'loss_val': 0.7469382678977844, 'psi': 0.6251776750733725}-{'f1_val': 0.5672399960479262, 'auprc': 0.7832209211620755, 'loss_val': 0.7239970557133302, 'psi': 0.6536323660935859}
[S8] START round=17 head_norm_before_train=1.188740 cos_to_last_merge=0.9986 (last merge round=15)
[S8] round=17 local utility u=0.240323 metrics={'f1_val': 0.993632801855294, 'auprc': 0.9982207641645189, 'loss_val': 0.14585943560438283, 'psi': 0.995467986778984}-{'f1_val': 0.9286953212237882, 'auprc': 0.9905864447826566, 'loss_val': 0.21397815154844846, 'psi': 0.9534517706473356}
[S9] START round=17 head_norm_before_train=1.475941 cos_to_last_merge=0.8575 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.858
[S9] round=17 local utility u=0.001104 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9987680195886698, 'loss_val': 0.26487885414133283, 'psi': 0.8202814979600059}-{'f1_val': 0.7013629453504064, 'auprc': 0.9987682164715024, 'loss_val': 0.2675220685937459, 'psi': 0.8203250537988448}
[S10] START round=17 head_norm_before_train=1.248683 cos_to_last_merge=1.0000 (last merge round=16)
[S10] round=17 local utility u=0.570467 metrics={'f1_val': 0.9947314934809462, 'auprc': 0.9952293272253617, 'loss_val': 0.3356091376232209, 'psi': 0.9949306269787125}-{'f1_val': 0.804729025398645, 'auprc': 0.9949644565040829, 'loss_val': 0.3357334867535777, 'psi': 0.8808231978408202}
[S11] START round=17 head_norm_before_train=1.240684 cos_to_last_merge=1.0000 (last merge round=16)
[S11] round=17 local utility u=0.036541 metrics={'f1_val': 0.7007320335079714, 'auprc': 0.9587894556147449, 'loss_val': 0.6698276068436292, 'psi': 0.8039550023506808}-{'f1_val': 0.7017589383281313, 'auprc': 0.9368393571649051, 'loss_val': 0.6832212794504058, 'psi': 0.7957911058628409}
[S13] START round=17 head_norm_before_train=1.575474 cos_to_last_merge=0.9988 (last merge round=14)
[S13] round=17 local utility u=0.000000 metrics={'f1_val': 0.5180092641726567, 'auprc': 0.6435565223279929, 'loss_val': 0.776385457404411, 'psi': 0.5682281674347911}-{'f1_val': 0.6320575304597086, 'auprc': 0.6728391779715344, 'loss_val': 0.685920853957602, 'psi': 0.6483701894644389}
[S14] START round=17 head_norm_before_train=1.460113 cos_to_last_merge=1.0000 (last merge round=16)
[S14] round=17 local utility u=0.009256 metrics={'f1_val': 0.9975054147531532, 'auprc': 0.9971566211197535, 'loss_val': 0.16014917364724282, 'psi': 0.9973658972997933}-{'f1_val': 0.9964424345629549, 'auprc': 0.9971580631759253, 'loss_val': 0.17228779597855853, 'psi': 0.996728686008143}
[S15] START round=17 head_norm_before_train=1.622325 (no previous merge yet)
[S15] round=17 local utility u=0.000000 metrics={'f1_val': 0.6974191410589458, 'auprc': 0.9876050878672902, 'loss_val': 0.3065832819033787, 'psi': 0.8134935197822836}-{'f1_val': 0.6910170134433689, 'auprc': 0.9899922348784271, 'loss_val': 0.2396506620184218, 'psi': 0.8106071020173922}
[S16] START round=17 head_norm_before_train=1.634423 (no previous merge yet)
[S16] round=17 local utility u=0.138054 metrics={'f1_val': 0.9914630725339029, 'auprc': 0.9945280456155694, 'loss_val': 0.11446269483060728, 'psi': 0.9926890617665695}-{'f1_val': 0.9563909819483605, 'auprc': 0.9937550070226477, 'loss_val': 0.1778189989479632, 'psi': 0.9713365919780754}
[S17] START round=17 head_norm_before_train=1.641796 (no previous merge yet)
[S17] round=17 local utility u=0.000000 metrics={'f1_val': 0.5797208203341859, 'auprc': 0.9684348174374421, 'loss_val': 0.5478630031105541, 'psi': 0.7352064191754883}-{'f1_val': 0.5863927756209439, 'auprc': 0.9615529637567042, 'loss_val': 0.5402142338365431, 'psi': 0.736456850875248}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:63209
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] RECEIVED delta(kind=head bytes=1802) from S2
[S8] cosine check vs S2: cos=0.7974
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S10@127.0.0.1:63211
[S5] sending update (kind=head size=1794 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1794) from S5
[S10] cosine check vs S5: cos=0.6728
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S16
[S13]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S16
[S14]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S16
[S11]  timeout peer S17
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S8]  timeout peer S3
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S16
[S8]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S2@127.0.0.1:63202
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] sending update (kind=head size=1805 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:63203
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:63214
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S9] sending update (kind=head size=1805 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] → sending delta(kind=head bytes=1794) to S10@127.0.0.1:63211
[S11] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1794 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1794 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1794) from S8
[S2] cosine check vs S8: cos=0.7974
[S10] RECEIVED delta(kind=head bytes=1794) from S14
[S10] cosine check vs S14: cos=0.9865
[S14] RECEIVED delta(kind=head bytes=1802) from S10
[S14] cosine check vs S10: cos=0.9865
[S3] RECEIVED delta(kind=head bytes=1800) from S11
[S3] cosine check vs S11: cos=0.7391
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=17 metric=0.9936 head_norm=1.237598
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.218034e-01
[S8] stored merged vector for next round verification (round=17)
[S8] DEBUG after merge:  round=17 metric=0.9944 head_norm=1.240668 delta_norm=0.421803
[S8] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=17 metric=0.9975 head_norm=1.488144
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.539535e-01
[S14] stored merged vector for next round verification (round=17)
[S14] DEBUG after merge:  round=17 metric=0.9979 head_norm=1.379563 delta_norm=0.153953
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=17 metric=0.6996 head_norm=1.379384
[S2] _apply_head_vector_avg (torch): Δ‖w‖=4.218034e-01
[S2] stored merged vector for next round verification (round=17)
[S2] DEBUG after merge:  round=17 metric=0.6996 head_norm=1.240668 delta_norm=0.421803
[S2] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=17 metric=0.9947 head_norm=1.280321
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.716010e-01
[S10] stored merged vector for next round verification (round=17)
[S10] DEBUG after merge:  round=17 metric=0.9947 head_norm=1.159123 delta_norm=0.171601
[S10] aggregate: ACCEPT kept=['S5', 'S14'] (k=2/2) mode=median trim_p=0.1
[S3] CommDone barrier timeout: have=2 need=3 — continuing
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=17 metric=0.7008 head_norm=0.877478
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.273290e-01
[S3] stored merged vector for next round verification (round=17)
[S3] DEBUG after merge:  round=17 metric=0.7008 head_norm=1.001787 delta_norm=0.427329
[S3] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.240668 cos_to_last_merge=1.0000 (last merge round=17)
[S2] round=18 local utility u=0.016923 metrics={'f1_val': 0.7043300859263658, 'auprc': 0.7871472267373008, 'loss_val': 0.4002156351952679, 'psi': 0.7374569422507398}-{'f1_val': 0.6995843541840225, 'auprc': 0.7876183045294818, 'loss_val': 0.40699972156220865, 'psi': 0.7347979343222062}
[S3] START round=18 head_norm_before_train=1.001787 cos_to_last_merge=1.0000 (last merge round=17)
[S3] round=18 local utility u=0.000000 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.6723687657634102, 'loss_val': 0.48677661217889184, 'psi': 0.6893560821045649}-{'f1_val': 0.7007562037352997, 'auprc': 0.6793330400597082, 'loss_val': 0.4613518794689447, 'psi': 0.6921869382650631}
[S4] START round=18 head_norm_before_train=1.460585 cos_to_last_merge=0.8075 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.807
[S4] round=18 local utility u=0.428034 metrics={'f1_val': 0.9481155586250228, 'auprc': 0.9412053751790742, 'loss_val': 0.4360642018769394, 'psi': 0.9453514852466434}-{'f1_val': 0.8208406911985079, 'auprc': 0.9402353659778191, 'loss_val': 0.525572066333318, 'psi': 0.8685985611102324}
[S5] START round=18 head_norm_before_train=0.869231 cos_to_last_merge=0.9985 (last merge round=16)
[S5] round=18 local utility u=0.000000 metrics={'f1_val': 0.5911909706307245, 'auprc': 0.7888808408650487, 'loss_val': 0.7761093028419122, 'psi': 0.6702669187244542}-{'f1_val': 0.7003213174339138, 'auprc': 0.8620280020772436, 'loss_val': 0.5258094636488061, 'psi': 0.7650039912912456}
[S6] START round=18 head_norm_before_train=1.260668 cos_to_last_merge=0.8106 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.811
[S6] round=18 local utility u=0.000000 metrics={'f1_val': 0.7777652398813522, 'auprc': 0.8289359805523866, 'loss_val': 0.34342007656024065, 'psi': 0.7982335361497659}-{'f1_val': 0.9600382356371215, 'auprc': 0.9581320518828372, 'loss_val': 0.28345601507886786, 'psi': 0.9592757621354079}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=18 head_norm_before_train=1.161136 cos_to_last_merge=0.8143 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.814
[S7] round=18 local utility u=0.000000 metrics={'f1_val': 0.5119992098267939, 'auprc': 0.6393612548440689, 'loss_val': 0.858241632596632, 'psi': 0.5629440278337039}-{'f1_val': 0.5628341919671285, 'auprc': 0.7186928997327386, 'loss_val': 0.7469382678977844, 'psi': 0.6251776750733725}
[S8] START round=18 head_norm_before_train=1.240668 cos_to_last_merge=1.0000 (last merge round=17)
[S8] round=18 local utility u=0.000000 metrics={'f1_val': 0.9930910663870046, 'auprc': 0.9891464045949935, 'loss_val': 0.18634029782373634, 'psi': 0.9915132016702002}-{'f1_val': 0.993632801855294, 'auprc': 0.9982207641645189, 'loss_val': 0.14585943560438283, 'psi': 0.995467986778984}
[S9] START round=18 head_norm_before_train=1.496345 cos_to_last_merge=0.8551 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.855
[S9] round=18 local utility u=0.000000 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9987683586302714, 'loss_val': 0.26540212439041544, 'psi': 0.8202816335766466}-{'f1_val': 0.7012904835408967, 'auprc': 0.9987680195886698, 'loss_val': 0.26487885414133283, 'psi': 0.8202814979600059}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=18 head_norm_before_train=1.159123 cos_to_last_merge=1.0000 (last merge round=17)
[S10] round=18 local utility u=0.001578 metrics={'f1_val': 0.993569612373587, 'auprc': 0.9953797937209209, 'loss_val': 0.32593333956992, 'psi': 0.9942936849125206}-{'f1_val': 0.9947314934809462, 'auprc': 0.9952293272253617, 'loss_val': 0.3356091376232209, 'psi': 0.9949306269787125}
[S11] START round=18 head_norm_before_train=1.265861 cos_to_last_merge=0.9970 (last merge round=16)
[S11] round=18 local utility u=0.131219 metrics={'f1_val': 0.7009724449445034, 'auprc': 0.9927808762268646, 'loss_val': 0.5108056199626081, 'psi': 0.8176958174574479}-{'f1_val': 0.7007320335079714, 'auprc': 0.9587894556147449, 'loss_val': 0.6698276068436292, 'psi': 0.8039550023506808}
[S13] START round=18 head_norm_before_train=1.591487 cos_to_last_merge=0.9981 (last merge round=14)
[S13] round=18 local utility u=0.351413 metrics={'f1_val': 0.6140004036289037, 'auprc': 0.6648480528889931, 'loss_val': 0.7133810817030671, 'psi': 0.6343394633329396}-{'f1_val': 0.5180092641726567, 'auprc': 0.6435565223279929, 'loss_val': 0.776385457404411, 'psi': 0.5682281674347911}
[S14] START round=18 head_norm_before_train=1.379563 cos_to_last_merge=1.0000 (last merge round=17)
[S14] round=18 local utility u=0.000000 metrics={'f1_val': 0.996333081002392, 'auprc': 0.9988504831902114, 'loss_val': 0.1624592453066507, 'psi': 0.9973400418775198}-{'f1_val': 0.9975054147531532, 'auprc': 0.9971566211197535, 'loss_val': 0.16014917364724282, 'psi': 0.9973658972997933}
[S15] START round=18 head_norm_before_train=1.650065 (no previous merge yet)
[S15] round=18 local utility u=0.000000 metrics={'f1_val': 0.688685479442395, 'auprc': 0.9896648526644858, 'loss_val': 0.38875966023258884, 'psi': 0.8090772287312313}-{'f1_val': 0.6974191410589458, 'auprc': 0.9876050878672902, 'loss_val': 0.3065832819033787, 'psi': 0.8134935197822836}
[S16] START round=18 head_norm_before_train=1.669357 (no previous merge yet)
[S16] round=18 local utility u=0.000000 metrics={'f1_val': 0.9323014406401218, 'auprc': 0.9893162726522144, 'loss_val': 0.22263846387781466, 'psi': 0.9551073734449589}-{'f1_val': 0.9914630725339029, 'auprc': 0.9945280456155694, 'loss_val': 0.11446269483060728, 'psi': 0.9926890617665695}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=18 head_norm_before_train=1.672471 (no previous merge yet)
[S17] round=18 local utility u=0.000000 metrics={'f1_val': 0.5610597402576352, 'auprc': 0.9564502342086981, 'loss_val': 0.6104551070790837, 'psi': 0.7192159378380604}-{'f1_val': 0.5797208203341859, 'auprc': 0.9684348174374421, 'loss_val': 0.5478630031105541, 'psi': 0.7352064191754883}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:63205
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:63215
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:63208
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:63209
[S10] sending update (kind=head size=1801 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1798) from S11
[S15] cosine check vs S11: cos=0.9436
[S5] RECEIVED delta(kind=head bytes=1801) from S10
[S5] cosine check vs S10: cos=0.7336
[S4] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1800) from S4
[S7] cosine check vs S4: cos=-0.1355
[S7] DROPPED delta from S4 (cos=-0.1355 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1798) from S2
[S8] cosine check vs S2: cos=0.9975
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=18 metric=0.6887 head_norm=1.679922
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.124103e-01
[S15] stored merged vector for next round verification (round=18)
[S15] DEBUG after merge:  round=18 metric=0.6878 head_norm=1.469231 delta_norm=0.312410
[S15] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S4]  timeout peer S2
[S4]  timeout peer S16
[S13]  timeout peer S6
[S13]  timeout peer S15
[S11]  timeout peer S3
[S10]  timeout peer S14
[S5]  timeout peer S9
[S5]  timeout peer S10
[S2]  timeout peer S17
[S3]  timeout peer S5
[S3]  timeout peer S7
[S3]  timeout peer S13
[S15]  timeout peer S11
[S7]  timeout peer S4
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=18 metric=0.5912 head_norm=0.900166
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.074523e-01
[S5] stored merged vector for next round verification (round=18)
[S5] DEBUG after merge:  round=18 metric=0.6431 head_norm=0.978543 delta_norm=0.407452
[S5] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=19 head_norm_before_train=1.280034 cos_to_last_merge=0.9992 (last merge round=17)
[S2] round=19 local utility u=0.000000 metrics={'f1_val': 0.7119935229116275, 'auprc': 0.7847386943602248, 'loss_val': 0.44229633643259025, 'psi': 0.7410915914910665}-{'f1_val': 0.7043300859263658, 'auprc': 0.7871472267373008, 'loss_val': 0.4002156351952679, 'psi': 0.7374569422507398}
[S3] START round=19 head_norm_before_train=1.041232 cos_to_last_merge=0.9963 (last merge round=17)
[S3] round=19 local utility u=0.196566 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.7747401803901071, 'loss_val': 0.4007596933503117, 'psi': 0.7303046479552437}-{'f1_val': 0.7006809596653347, 'auprc': 0.6723687657634102, 'loss_val': 0.48677661217889184, 'psi': 0.6893560821045649}
[S4] START round=19 head_norm_before_train=1.482307 cos_to_last_merge=0.8019 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.802
[S4] round=19 local utility u=0.015890 metrics={'f1_val': 0.9461087128121106, 'auprc': 0.9457734730057139, 'loss_val': 0.4059478168623944, 'psi': 0.945974616889552}-{'f1_val': 0.9481155586250228, 'auprc': 0.9412053751790742, 'loss_val': 0.4360642018769394, 'psi': 0.9453514852466434}
[S5] START round=19 head_norm_before_train=0.978543 cos_to_last_merge=1.0000 (last merge round=18)
[S5] round=19 local utility u=0.334941 metrics={'f1_val': 0.7000718940915064, 'auprc': 0.7067155263863105, 'loss_val': 0.5130160527911679, 'psi': 0.702729347009428}-{'f1_val': 0.5911909706307245, 'auprc': 0.7888808408650487, 'loss_val': 0.7761093028419122, 'psi': 0.6702669187244542}
[S6] START round=19 head_norm_before_train=1.291109 cos_to_last_merge=0.8052 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.805
[S6] round=19 local utility u=0.317861 metrics={'f1_val': 0.8222830548482815, 'auprc': 0.9474989289453479, 'loss_val': 0.33049458296804096, 'psi': 0.872369404487108}-{'f1_val': 0.7777652398813522, 'auprc': 0.8289359805523866, 'loss_val': 0.34342007656024065, 'psi': 0.7982335361497659}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] sending update (kind=head size=1793 to 1 peers)
[S6] r=20 psi=0.872 u=0.3179 p_local=0.2943 f1=0.822 auprc=0.947 bytes=23335
[S7] START round=19 head_norm_before_train=1.184300 cos_to_last_merge=0.8097 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.810
[S7] round=19 local utility u=0.473241 metrics={'f1_val': 0.5981224471736764, 'auprc': 0.7159113302789525, 'loss_val': 0.658149645764247, 'psi': 0.6452380004157868}-{'f1_val': 0.5119992098267939, 'auprc': 0.6393612548440689, 'loss_val': 0.858241632596632, 'psi': 0.5629440278337039}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S7] r=20 psi=0.645 u=0.4732 p_local=0.1864 f1=0.598 auprc=0.716 bytes=21538
[S8] START round=19 head_norm_before_train=1.290555 cos_to_last_merge=0.9982 (last merge round=17)
[S8] round=19 local utility u=0.043650 metrics={'f1_val': 0.9932673365348732, 'auprc': 0.9983203412038932, 'loss_val': 0.12761924205056582, 'psi': 0.9952885384024812}-{'f1_val': 0.9930910663870046, 'auprc': 0.9891464045949935, 'loss_val': 0.18634029782373634, 'psi': 0.9915132016702002}
[S9] START round=19 head_norm_before_train=1.513924 cos_to_last_merge=0.8524 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.852
[S9] round=19 local utility u=0.002102 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9987802521249237, 'loss_val': 0.2612341106109412, 'psi': 0.8202863909745075}-{'f1_val': 0.7012904835408967, 'auprc': 0.9987683586302714, 'loss_val': 0.26540212439041544, 'psi': 0.8202816335766466}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S9] r=20 psi=0.820 u=0.0021 p_local=0.0458 f1=0.701 auprc=0.999 bytes=30547
[S10] START round=19 head_norm_before_train=1.198678 cos_to_last_merge=0.9988 (last merge round=17)
[S10] round=19 local utility u=0.021131 metrics={'f1_val': 0.9943563983784213, 'auprc': 0.9912527666812904, 'loss_val': 0.2760107606149348, 'psi': 0.9931149456995689}-{'f1_val': 0.993569612373587, 'auprc': 0.9953797937209209, 'loss_val': 0.32593333956992, 'psi': 0.9942936849125206}
[S11] START round=19 head_norm_before_train=1.300131 cos_to_last_merge=0.9889 (last merge round=16)
[S11] round=19 local utility u=0.053750 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9928116253171271, 'loss_val': 0.4077236072391546, 'psi': 0.8181407378790058}-{'f1_val': 0.7009724449445034, 'auprc': 0.9927808762268646, 'loss_val': 0.5108056199626081, 'psi': 0.8176958174574479}
[S13] START round=19 head_norm_before_train=1.605386 cos_to_last_merge=0.9974 (last merge round=14)
[S13] round=19 local utility u=0.000000 metrics={'f1_val': 0.5395010773472946, 'auprc': 0.6427260156962288, 'loss_val': 0.8145183822791756, 'psi': 0.5807910526868683}-{'f1_val': 0.6140004036289037, 'auprc': 0.6648480528889931, 'loss_val': 0.7133810817030671, 'psi': 0.6343394633329396}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=20 psi=0.581 u=0.0000 p_local=0.1326 f1=0.540 auprc=0.643 bytes=21568
[S14] START round=19 head_norm_before_train=1.413626 cos_to_last_merge=0.9997 (last merge round=17)
[S14] round=19 local utility u=0.017218 metrics={'f1_val': 0.9979161758042404, 'auprc': 0.9971567031238772, 'loss_val': 0.1324412231263499, 'psi': 0.9976123867320952}-{'f1_val': 0.996333081002392, 'auprc': 0.9988504831902114, 'loss_val': 0.1624592453066507, 'psi': 0.9973400418775198}
[S15] START round=19 head_norm_before_train=1.469231 cos_to_last_merge=1.0000 (last merge round=18)
[S15] round=19 local utility u=0.064453 metrics={'f1_val': 0.6954073532514483, 'auprc': 0.989737378999436, 'loss_val': 0.30040184373382306, 'psi': 0.8131393635506434}-{'f1_val': 0.688685479442395, 'auprc': 0.9896648526644858, 'loss_val': 0.38875966023258884, 'psi': 0.8090772287312313}
[S16] START round=19 head_norm_before_train=1.703207 (no previous merge yet)
[S16] round=19 local utility u=0.255393 metrics={'f1_val': 0.9909585022873495, 'auprc': 0.9969148603339908, 'loss_val': 0.08659053460958993, 'psi': 0.993341045506006}-{'f1_val': 0.9323014406401218, 'auprc': 0.9893162726522144, 'loss_val': 0.22263846387781466, 'psi': 0.9551073734449589}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] sending update (kind=head size=1805 to 1 peers)
[S16] r=20 psi=0.993 u=0.2554 p_local=0.2420 f1=0.991 auprc=0.997 bytes=21595
[S17] START round=19 head_norm_before_train=1.703462 (no previous merge yet)
[S17] round=19 local utility u=0.000000 metrics={'f1_val': 0.5583102368946069, 'auprc': 0.9466349656412336, 'loss_val': 0.6354471444968101, 'psi': 0.7136401283932576}-{'f1_val': 0.5610597402576352, 'auprc': 0.9564502342086981, 'loss_val': 0.6104551070790837, 'psi': 0.7192159378380604}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=20 psi=0.714 u=0.0000 p_local=0.1259 f1=0.558 auprc=0.947 bytes=17973
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:63213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:63202
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:63208
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:63215
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S5] → sending delta(kind=head bytes=1792) to S3@127.0.0.1:63203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:63212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:63205
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:63211
[S11] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1792 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1796 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1799) from S14
[S10] cosine check vs S14: cos=0.9787
[S7] RECEIVED delta(kind=head bytes=1800) from S4
[S7] cosine check vs S4: cos=-0.1363
[S7] DROPPED delta from S4 (cos=-0.1363 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1801) from S8
[S2] cosine check vs S8: cos=0.9908
[S5] RECEIVED delta(kind=head bytes=1800) from S10
[S5] cosine check vs S10: cos=0.9409
[S3] RECEIVED delta(kind=head bytes=1792) from S5
[S3] cosine check vs S5: cos=0.5087
[S13] RECEIVED delta(kind=head bytes=1796) from S15
[S13] cosine check vs S15: cos=0.9734
[S11] RECEIVED delta(kind=head bytes=1800) from S3
[S11] cosine check vs S3: cos=0.9242
[S15] RECEIVED delta(kind=head bytes=1800) from S11
[S15] cosine check vs S11: cos=0.9696
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=19 metric=0.6954 head_norm=1.500691
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.926689e-01
[S15] stored merged vector for next round verification (round=19)
[S15] DEBUG after merge:  round=19 metric=0.6947 head_norm=1.408642 delta_norm=0.192669
[S15] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S15] r=20 psi=0.813 u=0.0645 p_local=0.0852 f1=0.695 auprc=0.990 bytes=26981
[S4] r=20 psi=0.946 u=0.0159 p_local=0.2197 f1=0.946 auprc=0.946 bytes=25195
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=19 metric=0.7007 head_norm=1.087160
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.202358e-01
[S3] stored merged vector for next round verification (round=19)
[S3] DEBUG after merge:  round=19 metric=0.7007 head_norm=0.909838 delta_norm=0.520236
[S3] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S3] r=20 psi=0.730 u=0.1966 p_local=0.1254 f1=0.701 auprc=0.775 bytes=19785
[S14] r=20 psi=0.998 u=0.0172 p_local=0.1082 f1=0.998 auprc=0.997 bytes=26953
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=19 metric=0.7001 head_norm=1.007465
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.215265e-01
[S5] stored merged vector for next round verification (round=19)
[S5] DEBUG after merge:  round=19 metric=0.7001 head_norm=1.102519 delta_norm=0.221527
[S5] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S5] r=20 psi=0.703 u=0.3349 p_local=0.1384 f1=0.700 auprc=0.707 bytes=26930
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=19 metric=0.9944 head_norm=1.230552
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.753055e-01
[S10] stored merged vector for next round verification (round=19)
[S10] DEBUG after merge:  round=19 metric=0.9944 head_norm=1.332061 delta_norm=0.175306
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S10] r=20 psi=0.993 u=0.0211 p_local=0.1824 f1=0.994 auprc=0.991 bytes=30604
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=19 metric=0.7017 head_norm=1.338176
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.661906e-01
[S11] stored merged vector for next round verification (round=19)
[S11] DEBUG after merge:  round=19 metric=0.7017 head_norm=1.189730 delta_norm=0.266191
[S11] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S11] r=20 psi=0.818 u=0.0538 p_local=0.1559 f1=0.702 auprc=0.993 bytes=32366
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=19 metric=0.9933 head_norm=1.347578
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.533904e-02
[S8] stored merged vector for next round verification (round=19)
[S8] DEBUG after merge:  round=19 metric=0.9933 head_norm=1.311466 delta_norm=0.085339
[S8] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S8] r=20 psi=0.995 u=0.0437 p_local=0.1948 f1=0.993 auprc=0.998 bytes=26960
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=19 metric=0.7120 head_norm=1.314389
[S2] _apply_head_vector_avg (torch): Δ‖w‖=9.183356e-02
[S2] stored merged vector for next round verification (round=19)
[S2] DEBUG after merge:  round=19 metric=0.7118 head_norm=1.327915 delta_norm=0.091834
[S2] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] r=20 psi=0.741 u=0.0000 p_local=0.0732 f1=0.712 auprc=0.785 bytes=25159
[S2] START round=20 head_norm_before_train=1.327915 cos_to_last_merge=1.0000 (last merge round=19)
[S2] round=20 local utility u=0.000000 metrics={'f1_val': 0.7127638844527147, 'auprc': 0.7878436924945669, 'loss_val': 0.48481922220158885, 'psi': 0.7427958076694556}-{'f1_val': 0.7119935229116275, 'auprc': 0.7847386943602248, 'loss_val': 0.44229633643259025, 'psi': 0.7410915914910665}
[S3] START round=20 head_norm_before_train=0.909838 cos_to_last_merge=1.0000 (last merge round=19)
[S3] round=20 local utility u=0.000000 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.7037955252652353, 'loss_val': 0.3857965916250856, 'psi': 0.7019267859052949}-{'f1_val': 0.7006809596653347, 'auprc': 0.7747401803901071, 'loss_val': 0.4007596933503117, 'psi': 0.7303046479552437}
[S4] START round=20 head_norm_before_train=1.504433 cos_to_last_merge=0.7964 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.796
[S4] round=20 local utility u=0.010643 metrics={'f1_val': 0.9448150755412426, 'auprc': 0.9413107223818016, 'loss_val': 0.36351207611444475, 'psi': 0.9434133342774662}-{'f1_val': 0.9461087128121106, 'auprc': 0.9457734730057139, 'loss_val': 0.4059478168623944, 'psi': 0.945974616889552}
[S5] START round=20 head_norm_before_train=1.102519 cos_to_last_merge=1.0000 (last merge round=19)
[S5] round=20 local utility u=0.016155 metrics={'f1_val': 0.7000938677112191, 'auprc': 0.71705162780095, 'loss_val': 0.511845597642842, 'psi': 0.7068769717471115}-{'f1_val': 0.7000718940915064, 'auprc': 0.7067155263863105, 'loss_val': 0.5130160527911679, 'psi': 0.702729347009428}
[S6] START round=20 head_norm_before_train=1.316359 cos_to_last_merge=0.8014 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.801
[S6] round=20 local utility u=0.000000 metrics={'f1_val': 0.8135123289571757, 'auprc': 0.947494368198581, 'loss_val': 0.3558593181547117, 'psi': 0.8671051446537379}-{'f1_val': 0.8222830548482815, 'auprc': 0.9474989289453479, 'loss_val': 0.33049458296804096, 'psi': 0.872369404487108}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=20 head_norm_before_train=1.205990 cos_to_last_merge=0.8058 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.806
[S7] round=20 local utility u=0.000000 metrics={'f1_val': 0.565358196608644, 'auprc': 0.7788205243694374, 'loss_val': 0.7394631825316133, 'psi': 0.6507431277129614}-{'f1_val': 0.5981224471736764, 'auprc': 0.7159113302789525, 'loss_val': 0.658149645764247, 'psi': 0.6452380004157868}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=20 head_norm_before_train=1.311466 cos_to_last_merge=1.0000 (last merge round=19)
[S8] round=20 local utility u=0.000000 metrics={'f1_val': 0.9925530904813786, 'auprc': 0.9933919479729459, 'loss_val': 0.11469615182209458, 'psi': 0.9928886334780056}-{'f1_val': 0.9932673365348732, 'auprc': 0.9983203412038932, 'loss_val': 0.12761924205056582, 'psi': 0.9952885384024812}
[S9] START round=20 head_norm_before_train=1.527695 cos_to_last_merge=0.8488 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.849
[S9] round=20 local utility u=0.001635 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9987446142526054, 'loss_val': 0.25785686243036315, 'psi': 0.8202721358255802}-{'f1_val': 0.7012904835408967, 'auprc': 0.9987802521249237, 'loss_val': 0.2612341106109412, 'psi': 0.8202863909745075}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] sending update (kind=head size=1803 to 1 peers)
[S10] START round=20 head_norm_before_train=1.332061 cos_to_last_merge=1.0000 (last merge round=19)
[S10] round=20 local utility u=0.024253 metrics={'f1_val': 0.9943563983784213, 'auprc': 0.9922047797731973, 'loss_val': 0.23036003280715242, 'psi': 0.9934957509363318}-{'f1_val': 0.9943563983784213, 'auprc': 0.9912527666812904, 'loss_val': 0.2760107606149348, 'psi': 0.9931149456995689}
[S11] START round=20 head_norm_before_train=1.189730 cos_to_last_merge=1.0000 (last merge round=19)
[S11] round=20 local utility u=0.014270 metrics={'f1_val': 0.7007320335079714, 'auprc': 0.9953743353471506, 'loss_val': 0.3811033983594938, 'psi': 0.8185889542436431}-{'f1_val': 0.7016934795869249, 'auprc': 0.9928116253171271, 'loss_val': 0.4077236072391546, 'psi': 0.8181407378790058}
[S13] START round=20 head_norm_before_train=1.618442 cos_to_last_merge=0.9965 (last merge round=14)
[S13] round=20 local utility u=0.000000 metrics={'f1_val': 0.5183319308473412, 'auprc': 0.6715000786005128, 'loss_val': 0.8279725119547361, 'psi': 0.5795991899486098}-{'f1_val': 0.5395010773472946, 'auprc': 0.6427260156962288, 'loss_val': 0.8145183822791756, 'psi': 0.5807910526868683}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=20 metric=0.5183 head_norm=1.635937
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.964124e-01
[S13] stored merged vector for next round verification (round=20)
[S13] DEBUG after merge:  round=20 metric=0.5314 head_norm=1.557435 delta_norm=0.196412
[S13] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S14] START round=20 head_norm_before_train=1.447749 cos_to_last_merge=0.9987 (last merge round=17)
[S14] round=20 local utility u=0.005181 metrics={'f1_val': 0.9959874237039671, 'auprc': 0.9971169000256423, 'loss_val': 0.1103881759912097, 'psi': 0.9964392142326373}-{'f1_val': 0.9979161758042404, 'auprc': 0.9971567031238772, 'loss_val': 0.1324412231263499, 'psi': 0.9976123867320952}
[S15] START round=20 head_norm_before_train=1.408642 cos_to_last_merge=1.0000 (last merge round=19)
[S15] round=20 local utility u=0.825677 metrics={'f1_val': 0.9588498074655185, 'auprc': 0.9917145434861873, 'loss_val': 0.23563467079489664, 'psi': 0.971995701873786}-{'f1_val': 0.6954073532514483, 'auprc': 0.989737378999436, 'loss_val': 0.30040184373382306, 'psi': 0.8131393635506434}
[S16] START round=20 head_norm_before_train=1.735726 (no previous merge yet)
[S16] round=20 local utility u=0.000000 metrics={'f1_val': 0.9264807408854253, 'auprc': 0.9979728995413862, 'loss_val': 0.23747822929157938, 'psi': 0.9550776043478097}-{'f1_val': 0.9909585022873495, 'auprc': 0.9969148603339908, 'loss_val': 0.08659053460958993, 'psi': 0.993341045506006}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=20 head_norm_before_train=1.731977 (no previous merge yet)
[S17] round=20 local utility u=0.227434 metrics={'f1_val': 0.6192939755535511, 'auprc': 0.9650792158754211, 'loss_val': 0.6018146561135481, 'psi': 0.7576080716822992}-{'f1_val': 0.5583102368946069, 'auprc': 0.9466349656412336, 'loss_val': 0.6354471444968101, 'psi': 0.7136401283932576}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] sending update (kind=head size=1794 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S4] sending update (kind=head size=1806 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=21 head_norm_before_train=1.357231 cos_to_last_merge=0.9996 (last merge round=19)
[S2] round=21 local utility u=0.000000 metrics={'f1_val': 0.7127828997304243, 'auprc': 0.7881277634079407, 'loss_val': 0.48710354937667055, 'psi': 0.7429208452014309}-{'f1_val': 0.7127638844527147, 'auprc': 0.7878436924945669, 'loss_val': 0.48481922220158885, 'psi': 0.7427958076694556}
[S3] START round=21 head_norm_before_train=0.960099 cos_to_last_merge=0.9978 (last merge round=19)
[S3] round=21 local utility u=0.362169 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9322540929937214, 'loss_val': 0.34683421518988256, 'psi': 0.7933102129966894}-{'f1_val': 0.7006809596653347, 'auprc': 0.7037955252652353, 'loss_val': 0.3857965916250856, 'psi': 0.7019267859052949}
[S4] START round=21 head_norm_before_train=1.530729 cos_to_last_merge=0.7906 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.791
[S4] round=21 local utility u=0.024710 metrics={'f1_val': 0.9454065037263262, 'auprc': 0.9440667882796883, 'loss_val': 0.3259086627456364, 'psi': 0.944870617547671}-{'f1_val': 0.9448150755412426, 'auprc': 0.9413107223818016, 'loss_val': 0.36351207611444475, 'psi': 0.9434133342774662}
[S5] START round=21 head_norm_before_train=1.133961 cos_to_last_merge=0.9983 (last merge round=19)
[S5] round=21 local utility u=0.234659 metrics={'f1_val': 0.700320598491359, 'auprc': 0.8324237061008505, 'loss_val': 0.3900044791896297, 'psi': 0.7531618415351555}-{'f1_val': 0.7000938677112191, 'auprc': 0.71705162780095, 'loss_val': 0.511845597642842, 'psi': 0.7068769717471115}
[S6] START round=21 head_norm_before_train=1.339691 cos_to_last_merge=0.7985 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.798
[S6] round=21 local utility u=0.088471 metrics={'f1_val': 0.8283640458685825, 'auprc': 0.9625396111029957, 'loss_val': 0.3131638663478693, 'psi': 0.8820342719623477}-{'f1_val': 0.8135123289571757, 'auprc': 0.947494368198581, 'loss_val': 0.3558593181547117, 'psi': 0.8671051446537379}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] sending update (kind=head size=1795 to 1 peers)
[S7] START round=21 head_norm_before_train=1.221699 cos_to_last_merge=0.8026 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.803
[S7] round=21 local utility u=0.000000 metrics={'f1_val': 0.5503806014179914, 'auprc': 0.7816648646006717, 'loss_val': 0.8110585775575863, 'psi': 0.6428943066910635}-{'f1_val': 0.565358196608644, 'auprc': 0.7788205243694374, 'loss_val': 0.7394631825316133, 'psi': 0.6507431277129614}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=21 head_norm_before_train=1.367974 cos_to_last_merge=0.9986 (last merge round=19)
[S8] round=21 local utility u=0.000822 metrics={'f1_val': 0.9930990485370332, 'auprc': 0.9854385867713147, 'loss_val': 0.0924678841310458, 'psi': 0.9900348638307458}-{'f1_val': 0.9925530904813786, 'auprc': 0.9933919479729459, 'loss_val': 0.11469615182209458, 'psi': 0.9928886334780056}
[S9] START round=21 head_norm_before_train=1.539892 cos_to_last_merge=0.8448 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.845
[S9] round=21 local utility u=0.000673 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9986922281253244, 'loss_val': 0.25635440486407063, 'psi': 0.8202511813746678}-{'f1_val': 0.7012904835408967, 'auprc': 0.9987446142526054, 'loss_val': 0.25785686243036315, 'psi': 0.8202721358255802}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S9] sending update (kind=head size=1806 to 1 peers)
[S10] START round=21 head_norm_before_train=1.358996 cos_to_last_merge=0.9996 (last merge round=19)
[S10] round=21 local utility u=0.028130 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9949390536297489, 'loss_val': 0.1872911222381671, 'psi': 0.9950883248635244}-{'f1_val': 0.9943563983784213, 'auprc': 0.9922047797731973, 'loss_val': 0.23036003280715242, 'psi': 0.9934957509363318}
[S11] START round=21 head_norm_before_train=1.229178 cos_to_last_merge=0.9988 (last merge round=19)
[S11] round=21 local utility u=0.024019 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9929971303362879, 'loss_val': 0.33170146877594303, 'psi': 0.81821493988667}-{'f1_val': 0.7007320335079714, 'auprc': 0.9953743353471506, 'loss_val': 0.3811033983594938, 'psi': 0.8185889542436431}
[S13] START round=21 head_norm_before_train=1.557435 cos_to_last_merge=1.0000 (last merge round=20)
[S13] round=21 local utility u=0.278989 metrics={'f1_val': 0.5978402663775766, 'auprc': 0.6542611234661355, 'loss_val': 0.6953275934359294, 'psi': 0.6204086092130001}-{'f1_val': 0.5183319308473412, 'auprc': 0.6715000786005128, 'loss_val': 0.8279725119547361, 'psi': 0.5795991899486098}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=21 head_norm_before_train=1.482795 cos_to_last_merge=0.9971 (last merge round=17)
[S14] round=21 local utility u=0.010070 metrics={'f1_val': 0.9961605687915402, 'auprc': 0.9970936555660407, 'loss_val': 0.09121821436402139, 'psi': 0.9965338035013405}-{'f1_val': 0.9959874237039671, 'auprc': 0.9971169000256423, 'loss_val': 0.1103881759912097, 'psi': 0.9964392142326373}
[S15] START round=21 head_norm_before_train=1.447480 cos_to_last_merge=0.9995 (last merge round=19)
[S15] round=21 local utility u=0.000000 metrics={'f1_val': 0.6999576636121825, 'auprc': 0.7959140186157203, 'loss_val': 0.500566119318771, 'psi': 0.7383402056135977}-{'f1_val': 0.9588498074655185, 'auprc': 0.9917145434861873, 'loss_val': 0.23563467079489664, 'psi': 0.971995701873786}
[S16] START round=21 head_norm_before_train=1.764682 (no previous merge yet)
[S16] round=21 local utility u=0.066639 metrics={'f1_val': 0.938759816972862, 'auprc': 0.9975352286530672, 'loss_val': 0.176562304771119, 'psi': 0.9622699816449442}-{'f1_val': 0.9264807408854253, 'auprc': 0.9979728995413862, 'loss_val': 0.23747822929157938, 'psi': 0.9550776043478097}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S16] sending update (kind=head size=1806 to 1 peers)
[S17] START round=21 head_norm_before_train=1.757759 (no previous merge yet)
[S17] round=21 local utility u=0.000000 metrics={'f1_val': 0.5621565049381537, 'auprc': 0.9547001778054548, 'loss_val': 0.6372237229890143, 'psi': 0.7191739740850742}-{'f1_val': 0.6192939755535511, 'auprc': 0.9650792158754211, 'loss_val': 0.6018146561135481, 'psi': 0.7576080716822992}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] sending update (kind=head size=1805 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S3] sending update (kind=head size=1792 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=22 head_norm_before_train=1.379376 cos_to_last_merge=0.9989 (last merge round=19)
[S2] round=22 local utility u=0.000000 metrics={'f1_val': 0.7134742865323744, 'auprc': 0.7897358316087452, 'loss_val': 0.6065210055627869, 'psi': 0.7439789045629228}-{'f1_val': 0.7127828997304243, 'auprc': 0.7881277634079407, 'loss_val': 0.48710354937667055, 'psi': 0.7429208452014309}
[S3] START round=22 head_norm_before_train=1.009983 cos_to_last_merge=0.9929 (last merge round=19)
[S3] round=22 local utility u=0.107798 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9958060283734884, 'loss_val': 0.3218950009239317, 'psi': 0.8187309871485962}-{'f1_val': 0.7006809596653347, 'auprc': 0.9322540929937214, 'loss_val': 0.34683421518988256, 'psi': 0.7933102129966894}
[S4] START round=22 head_norm_before_train=1.554767 cos_to_last_merge=0.7852 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.785
[S4] round=22 local utility u=0.000000 metrics={'f1_val': 0.9420347471670434, 'auprc': 0.9130994416217628, 'loss_val': 0.3293461153946758, 'psi': 0.9304606249489311}-{'f1_val': 0.9454065037263262, 'auprc': 0.9440667882796883, 'loss_val': 0.3259086627456364, 'psi': 0.944870617547671}
[S5] START round=22 head_norm_before_train=1.172033 cos_to_last_merge=0.9936 (last merge round=19)
[S5] round=22 local utility u=0.000000 metrics={'f1_val': 0.4382719543782975, 'auprc': 0.8182114693455091, 'loss_val': 0.7630362990597421, 'psi': 0.5902477603651821}-{'f1_val': 0.700320598491359, 'auprc': 0.8324237061008505, 'loss_val': 0.3900044791896297, 'psi': 0.7531618415351555}
[S6] START round=22 head_norm_before_train=1.360359 cos_to_last_merge=0.7965 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.796
[S6] round=22 local utility u=0.589636 metrics={'f1_val': 0.9858867943106657, 'auprc': 0.9828685212772452, 'loss_val': 0.14001559070003403, 'psi': 0.9846794850972975}-{'f1_val': 0.8283640458685825, 'auprc': 0.9625396111029957, 'loss_val': 0.3131638663478693, 'psi': 0.8820342719623477}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] sending update (kind=head size=1794 to 1 peers)
[S7] START round=22 head_norm_before_train=1.234198 cos_to_last_merge=0.7998 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.800
[S7] round=22 local utility u=0.000000 metrics={'f1_val': 0.4296665953664784, 'auprc': 0.7808191108693563, 'loss_val': 1.0046512997196155, 'psi': 0.5701276015676295}-{'f1_val': 0.5503806014179914, 'auprc': 0.7816648646006717, 'loss_val': 0.8110585775575863, 'psi': 0.6428943066910635}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=22 head_norm_before_train=1.423355 cos_to_last_merge=0.9956 (last merge round=19)
[S8] round=22 local utility u=0.026258 metrics={'f1_val': 0.992174240363445, 'auprc': 0.998263490943152, 'loss_val': 0.07287730387613854, 'psi': 0.9946099405953278}-{'f1_val': 0.9930990485370332, 'auprc': 0.9854385867713147, 'loss_val': 0.0924678841310458, 'psi': 0.9900348638307458}
[S9] START round=22 head_norm_before_train=1.551629 cos_to_last_merge=0.8423 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.842
[S9] round=22 local utility u=0.002407 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.998778366440538, 'loss_val': 0.2517994192247155, 'psi': 0.8202856367007533}-{'f1_val': 0.7012904835408967, 'auprc': 0.9986922281253244, 'loss_val': 0.25635440486407063, 'psi': 0.8202511813746678}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=22 head_norm_before_train=1.394951 cos_to_last_merge=0.9984 (last merge round=19)
[S10] round=22 local utility u=0.016997 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.995589634680439, 'loss_val': 0.15129648596564077, 'psi': 0.9949533179512122}-{'f1_val': 0.9951878390193748, 'auprc': 0.9949390536297489, 'loss_val': 0.1872911222381671, 'psi': 0.9950883248635244}
[S11] START round=22 head_norm_before_train=1.264233 cos_to_last_merge=0.9962 (last merge round=19)
[S11] round=22 local utility u=0.021201 metrics={'f1_val': 0.7009724449445034, 'auprc': 0.9958785704079399, 'loss_val': 0.29361682298362235, 'psi': 0.818934895129878}-{'f1_val': 0.7016934795869249, 'auprc': 0.9929971303362879, 'loss_val': 0.33170146877594303, 'psi': 0.81821493988667}
[S13] START round=22 head_norm_before_train=1.574129 cos_to_last_merge=0.9998 (last merge round=20)
[S13] round=22 local utility u=0.000000 metrics={'f1_val': 0.5412933656611063, 'auprc': 0.674309102488122, 'loss_val': 0.7570040270906837, 'psi': 0.5944996603919126}-{'f1_val': 0.5978402663775766, 'auprc': 0.6542611234661355, 'loss_val': 0.6953275934359294, 'psi': 0.6204086092130001}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=22 head_norm_before_train=1.515927 cos_to_last_merge=0.9951 (last merge round=17)
[S14] round=22 local utility u=0.000000 metrics={'f1_val': 0.9930611278268856, 'auprc': 0.9970739737624665, 'loss_val': 0.08871015766129355, 'psi': 0.9946662662011181}-{'f1_val': 0.9961605687915402, 'auprc': 0.9970936555660407, 'loss_val': 0.09121821436402139, 'psi': 0.9965338035013405}
[S15] START round=22 head_norm_before_train=1.481306 cos_to_last_merge=0.9985 (last merge round=19)
[S15] round=22 local utility u=0.924776 metrics={'f1_val': 0.8705056224362594, 'auprc': 0.9965739157957703, 'loss_val': 0.27628231393289393, 'psi': 0.9209329397800637}-{'f1_val': 0.6999576636121825, 'auprc': 0.7959140186157203, 'loss_val': 0.500566119318771, 'psi': 0.7383402056135977}
[S16] START round=22 head_norm_before_train=1.786471 (no previous merge yet)
[S16] round=22 local utility u=0.003188 metrics={'f1_val': 0.939182667978972, 'auprc': 0.9973324649607307, 'loss_val': 0.1721157157055038, 'psi': 0.9624425867716755}-{'f1_val': 0.938759816972862, 'auprc': 0.9975352286530672, 'loss_val': 0.176562304771119, 'psi': 0.9622699816449442}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=22 head_norm_before_train=1.780211 (no previous merge yet)
[S17] round=22 local utility u=0.000000 metrics={'f1_val': 0.5492347411781826, 'auprc': 0.9183542799752771, 'loss_val': 0.7345750124569183, 'psi': 0.6968825566970204}-{'f1_val': 0.5621565049381537, 'auprc': 0.9547001778054548, 'loss_val': 0.6372237229890143, 'psi': 0.7191739740850742}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S10] sending update (kind=head size=1807 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S3] sending update (kind=head size=1790 to 1 peers)
[S2] START round=23 head_norm_before_train=1.396872 cos_to_last_merge=0.9979 (last merge round=19)
[S2] round=23 local utility u=0.037489 metrics={'f1_val': 0.7136792936076531, 'auprc': 0.7899339016706896, 'loss_val': 0.533367420439889, 'psi': 0.7441811368328677}-{'f1_val': 0.7134742865323744, 'auprc': 0.7897358316087452, 'loss_val': 0.6065210055627869, 'psi': 0.7439789045629228}
[S3] START round=23 head_norm_before_train=1.055283 cos_to_last_merge=0.9872 (last merge round=19)
[S3] round=23 local utility u=0.011812 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9984621468170839, 'loss_val': 0.3062401433202496, 'psi': 0.8197934345260345}-{'f1_val': 0.7006809596653347, 'auprc': 0.9958060283734884, 'loss_val': 0.3218950009239317, 'psi': 0.8187309871485962}
[S4] START round=23 head_norm_before_train=1.577674 cos_to_last_merge=0.7806 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.781
[S4] round=23 local utility u=0.099030 metrics={'f1_val': 0.9485473406206876, 'auprc': 0.9554129310600549, 'loss_val': 0.29730283610841063, 'psi': 0.9512935767964346}-{'f1_val': 0.9420347471670434, 'auprc': 0.9130994416217628, 'loss_val': 0.3293461153946758, 'psi': 0.9304606249489311}
[S5] START round=23 head_norm_before_train=1.207636 cos_to_last_merge=0.9879 (last merge round=19)
[S5] round=23 local utility u=1.000000 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.8703367240973859, 'loss_val': 0.33225332891157217, 'psi': 0.7683274800993026}-{'f1_val': 0.4382719543782975, 'auprc': 0.8182114693455091, 'loss_val': 0.7630362990597421, 'psi': 0.5902477603651821}
[S6] START round=23 head_norm_before_train=1.382929 cos_to_last_merge=0.7940 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.794
[S6] round=23 local utility u=0.000000 metrics={'f1_val': 0.41701511304337235, 'auprc': 0.786298872766224, 'loss_val': 1.0661326932580053, 'psi': 0.564728616932513}-{'f1_val': 0.9858867943106657, 'auprc': 0.9828685212772452, 'loss_val': 0.14001559070003403, 'psi': 0.9846794850972975}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=23 head_norm_before_train=1.247193 cos_to_last_merge=0.7962 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.796
[S7] round=23 local utility u=1.000000 metrics={'f1_val': 0.6724512406253014, 'auprc': 0.8253747454549063, 'loss_val': 0.47222875739264925, 'psi': 0.7336206425571434}-{'f1_val': 0.4296665953664784, 'auprc': 0.7808191108693563, 'loss_val': 1.0046512997196155, 'psi': 0.5701276015676295}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=23 head_norm_before_train=1.471022 cos_to_last_merge=0.9923 (last merge round=19)
[S8] round=23 local utility u=0.005236 metrics={'f1_val': 0.9929276522285003, 'auprc': 0.9971510660675486, 'loss_val': 0.06358846416913867, 'psi': 0.9946170177641196}-{'f1_val': 0.992174240363445, 'auprc': 0.998263490943152, 'loss_val': 0.07287730387613854, 'psi': 0.9946099405953278}
[S9] START round=23 head_norm_before_train=1.562705 cos_to_last_merge=0.8413 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.841
[S9] round=23 local utility u=0.000033 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9982948723337015, 'loss_val': 0.2498401185173147, 'psi': 0.8200478973974917}-{'f1_val': 0.7012904835408967, 'auprc': 0.998778366440538, 'loss_val': 0.2517994192247155, 'psi': 0.8202856367007533}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=23 head_norm_before_train=1.435165 cos_to_last_merge=0.9962 (last merge round=19)
[S10] round=23 local utility u=0.008655 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9929874415256658, 'loss_val': 0.12760459521514964, 'psi': 0.9940548668357836}-{'f1_val': 0.9945291067983943, 'auprc': 0.995589634680439, 'loss_val': 0.15129648596564077, 'psi': 0.9949533179512122}
[S11] START round=23 head_norm_before_train=1.294214 cos_to_last_merge=0.9934 (last merge round=19)
[S11] round=23 local utility u=0.014283 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9958764489111801, 'loss_val': 0.27082209176447647, 'psi': 0.8195117695434642}-{'f1_val': 0.7009724449445034, 'auprc': 0.9958785704079399, 'loss_val': 0.29361682298362235, 'psi': 0.818934895129878}
[S13] START round=23 head_norm_before_train=1.587559 cos_to_last_merge=0.9994 (last merge round=20)
[S13] round=23 local utility u=0.079552 metrics={'f1_val': 0.5656310079926941, 'auprc': 0.6696632211681877, 'loss_val': 0.7299885064126952, 'psi': 0.6072438932628915}-{'f1_val': 0.5412933656611063, 'auprc': 0.674309102488122, 'loss_val': 0.7570040270906837, 'psi': 0.5944996603919126}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=23 head_norm_before_train=1.547533 cos_to_last_merge=0.9931 (last merge round=17)
[S14] round=23 local utility u=0.026005 metrics={'f1_val': 0.9980623665153463, 'auprc': 0.9970705675763671, 'loss_val': 0.06669786807266181, 'psi': 0.9976656469397547}-{'f1_val': 0.9930611278268856, 'auprc': 0.9970739737624665, 'loss_val': 0.08871015766129355, 'psi': 0.9946662662011181}
[S15] START round=23 head_norm_before_train=1.509549 cos_to_last_merge=0.9973 (last merge round=19)
[S15] round=23 local utility u=0.000000 metrics={'f1_val': 0.6968939053553627, 'auprc': 0.9039474543684363, 'loss_val': 0.5105521793458538, 'psi': 0.7797153249605921}-{'f1_val': 0.8705056224362594, 'auprc': 0.9965739157957703, 'loss_val': 0.27628231393289393, 'psi': 0.9209329397800637}
[S16] START round=23 head_norm_before_train=1.805345 (no previous merge yet)
[S16] round=23 local utility u=0.018328 metrics={'f1_val': 0.9408705933273313, 'auprc': 0.9974912020704243, 'loss_val': 0.14606283248817314, 'psi': 0.9635188368245685}-{'f1_val': 0.939182667978972, 'auprc': 0.9973324649607307, 'loss_val': 0.1721157157055038, 'psi': 0.9624425867716755}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=23 head_norm_before_train=1.797298 (no previous merge yet)
[S17] round=23 local utility u=0.042169 metrics={'f1_val': 0.5516265166178452, 'auprc': 0.9331161288506576, 'loss_val': 0.7088727638482183, 'psi': 0.7042223615109702}-{'f1_val': 0.5492347411781826, 'auprc': 0.9183542799752771, 'loss_val': 0.7345750124569183, 'psi': 0.6968825566970204}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S2] START round=24 head_norm_before_train=1.413827 cos_to_last_merge=0.9972 (last merge round=19)
[S2] round=24 local utility u=0.000000 metrics={'f1_val': 0.6996105493161282, 'auprc': 0.723833964659391, 'loss_val': 0.35255352086849, 'psi': 0.7092999154534333}-{'f1_val': 0.7136792936076531, 'auprc': 0.7899339016706896, 'loss_val': 0.533367420439889, 'psi': 0.7441811368328677}
[S3] START round=24 head_norm_before_train=1.093976 cos_to_last_merge=0.9821 (last merge round=19)
[S3] round=24 local utility u=0.004046 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9975402594895741, 'loss_val': 0.2953821973184966, 'psi': 0.8194246795950305}-{'f1_val': 0.7006809596653347, 'auprc': 0.9984621468170839, 'loss_val': 0.3062401433202496, 'psi': 0.8197934345260345}
[S4] START round=24 head_norm_before_train=1.598275 cos_to_last_merge=0.7767 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.777
[S4] round=24 local utility u=0.000000 metrics={'f1_val': 0.9483412792413359, 'auprc': 0.9529745372749576, 'loss_val': 0.29189178549892014, 'psi': 0.9501945824547846}-{'f1_val': 0.9485473406206876, 'auprc': 0.9554129310600549, 'loss_val': 0.29730283610841063, 'psi': 0.9512935767964346}
[S5] START round=24 head_norm_before_train=1.235683 cos_to_last_merge=0.9830 (last merge round=19)
[S5] round=24 local utility u=0.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.8107097072011873, 'loss_val': 0.32330632438041784, 'psi': 0.7444762419752904}-{'f1_val': 0.7003213174339138, 'auprc': 0.8703367240973859, 'loss_val': 0.33225332891157217, 'psi': 0.7683274800993026}
[S6] START round=24 head_norm_before_train=1.401225 cos_to_last_merge=0.7925 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.793
[S6] round=24 local utility u=1.000000 metrics={'f1_val': 0.8539733508122964, 'auprc': 0.9744371117771777, 'loss_val': 0.20727291706277146, 'psi': 0.9021588551982489}-{'f1_val': 0.41701511304337235, 'auprc': 0.786298872766224, 'loss_val': 1.0661326932580053, 'psi': 0.564728616932513}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=24 head_norm_before_train=1.257027 cos_to_last_merge=0.7933 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.793
[S7] round=24 local utility u=0.000000 metrics={'f1_val': 0.4316035205424582, 'auprc': 0.7799470223490097, 'loss_val': 0.952802491188784, 'psi': 0.5709409212650788}-{'f1_val': 0.6724512406253014, 'auprc': 0.8253747454549063, 'loss_val': 0.47222875739264925, 'psi': 0.7336206425571434}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=24 head_norm_before_train=1.511992 cos_to_last_merge=0.9891 (last merge round=19)
[S8] round=24 local utility u=0.005698 metrics={'f1_val': 0.9933016371923923, 'auprc': 0.9977654720070768, 'loss_val': 0.056278873117155126, 'psi': 0.9950871711182661}-{'f1_val': 0.9929276522285003, 'auprc': 0.9971510660675486, 'loss_val': 0.06358846416913867, 'psi': 0.9946170177641196}
[S9] START round=24 head_norm_before_train=1.574739 cos_to_last_merge=0.8402 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.840
[S9] round=24 local utility u=0.007647 metrics={'f1_val': 0.7014667606303384, 'auprc': 0.9983192526693543, 'loss_val': 0.2361206612101374, 'psi': 0.8202077574459448}-{'f1_val': 0.7012165807733519, 'auprc': 0.9982948723337015, 'loss_val': 0.2498401185173147, 'psi': 0.8200478973974917}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S9] sending update (kind=head size=1806 to 1 peers)
[S10] START round=24 head_norm_before_train=1.472123 cos_to_last_merge=0.9937 (last merge round=19)
[S10] round=24 local utility u=0.014747 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9954467496287455, 'loss_val': 0.10801595093410386, 'psi': 0.995291403263123}-{'f1_val': 0.9947664837091956, 'auprc': 0.9929874415256658, 'loss_val': 0.12760459521514964, 'psi': 0.9940548668357836}
[S11] START round=24 head_norm_before_train=1.319193 cos_to_last_merge=0.9907 (last merge round=19)
[S11] round=24 local utility u=0.021111 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9979856779632079, 'loss_val': 0.23347771611244308, 'psi': 0.8202103589374381}-{'f1_val': 0.7019353166316534, 'auprc': 0.9958764489111801, 'loss_val': 0.27082209176447647, 'psi': 0.8195117695434642}
[S13] START round=24 head_norm_before_train=1.601230 cos_to_last_merge=0.9990 (last merge round=20)
[S13] round=24 local utility u=0.000000 metrics={'f1_val': 0.5483388619072797, 'auprc': 0.6738440791791419, 'loss_val': 0.78137251156098, 'psi': 0.5985409488160245}-{'f1_val': 0.5656310079926941, 'auprc': 0.6696632211681877, 'loss_val': 0.7299885064126952, 'psi': 0.6072438932628915}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=24 head_norm_before_train=1.576418 cos_to_last_merge=0.9911 (last merge round=17)
[S14] round=24 local utility u=0.001326 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9970891185366618, 'loss_val': 0.05771239438159822, 'psi': 0.9970341523092638}-{'f1_val': 0.9980623665153463, 'auprc': 0.9970705675763671, 'loss_val': 0.06669786807266181, 'psi': 0.9976656469397547}
[S15] START round=24 head_norm_before_train=1.537927 cos_to_last_merge=0.9957 (last merge round=19)
[S15] round=24 local utility u=1.000000 metrics={'f1_val': 0.9495907432463466, 'auprc': 0.9914595995485718, 'loss_val': 0.1395744756997091, 'psi': 0.9663382857672367}-{'f1_val': 0.6968939053553627, 'auprc': 0.9039474543684363, 'loss_val': 0.5105521793458538, 'psi': 0.7797153249605921}
[S16] START round=24 head_norm_before_train=1.821490 (no previous merge yet)
[S16] round=24 local utility u=0.127547 metrics={'f1_val': 0.9743440844942117, 'auprc': 0.9973451181998952, 'loss_val': 0.0913707919960829, 'psi': 0.9835444979764851}-{'f1_val': 0.9408705933273313, 'auprc': 0.9974912020704243, 'loss_val': 0.14606283248817314, 'psi': 0.9635188368245685}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S17] START round=24 head_norm_before_train=1.813419 (no previous merge yet)
[S17] round=24 local utility u=0.295125 metrics={'f1_val': 0.6482846225920224, 'auprc': 0.9329952861540793, 'loss_val': 0.6982098225822763, 'psi': 0.7621688880168451}-{'f1_val': 0.5516265166178452, 'auprc': 0.9331161288506576, 'loss_val': 0.7088727638482183, 'psi': 0.7042223615109702}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S15] sending update (kind=head size=1806 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=25 head_norm_before_train=1.430071 cos_to_last_merge=0.9965 (last merge round=19)
[S2] round=25 local utility u=0.095523 metrics={'f1_val': 0.7050720623869249, 'auprc': 0.7907534549172397, 'loss_val': 0.39503427489090676, 'psi': 0.7393446193990508}-{'f1_val': 0.6996105493161282, 'auprc': 0.723833964659391, 'loss_val': 0.35255352086849, 'psi': 0.7092999154534333}
[S3] START round=25 head_norm_before_train=1.124804 cos_to_last_merge=0.9780 (last merge round=19)
[S3] round=25 local utility u=0.005522 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9982353323762344, 'loss_val': 0.2864226456316401, 'psi': 0.8197027087496946}-{'f1_val': 0.7006809596653347, 'auprc': 0.9975402594895741, 'loss_val': 0.2953821973184966, 'psi': 0.8194246795950305}
[S4] START round=25 head_norm_before_train=1.611705 cos_to_last_merge=0.7747 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.775
[S4] round=25 local utility u=0.036922 metrics={'f1_val': 0.957224167356098, 'auprc': 0.955495030731918, 'loss_val': 0.2789070355012022, 'psi': 0.9565325127064261}-{'f1_val': 0.9483412792413359, 'auprc': 0.9529745372749576, 'loss_val': 0.29189178549892014, 'psi': 0.9501945824547846}
[S5] START round=25 head_norm_before_train=1.260246 cos_to_last_merge=0.9794 (last merge round=19)
[S5] round=25 local utility u=0.274235 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9895614206337366, 'loss_val': 0.311395866345948, 'psi': 0.8160173587138428}-{'f1_val': 0.700320598491359, 'auprc': 0.8107097072011873, 'loss_val': 0.32330632438041784, 'psi': 0.7444762419752904}
[S6] START round=25 head_norm_before_train=1.412547 cos_to_last_merge=0.7912 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.791
[S6] round=25 local utility u=0.000000 metrics={'f1_val': 0.7888848141799751, 'auprc': 0.956173304915109, 'loss_val': 0.4039304344403273, 'psi': 0.8558002104740287}-{'f1_val': 0.8539733508122964, 'auprc': 0.9744371117771777, 'loss_val': 0.20727291706277146, 'psi': 0.9021588551982489}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=25 head_norm_before_train=1.265030 cos_to_last_merge=0.7913 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.791
[S7] round=25 local utility u=1.000000 metrics={'f1_val': 0.6786378390553022, 'auprc': 0.8300139943361999, 'loss_val': 0.4452695763591431, 'psi': 0.7391883011676613}-{'f1_val': 0.4316035205424582, 'auprc': 0.7799470223490097, 'loss_val': 0.952802491188784, 'psi': 0.5709409212650788}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] sending update (kind=head size=1796 to 1 peers)
[S8] START round=25 head_norm_before_train=1.546628 cos_to_last_merge=0.9863 (last merge round=19)
[S8] round=25 local utility u=0.001670 metrics={'f1_val': 0.9929361822751569, 'auprc': 0.9981877883153758, 'loss_val': 0.05201259910769743, 'psi': 0.9950368246912444}-{'f1_val': 0.9933016371923923, 'auprc': 0.9977654720070768, 'loss_val': 0.056278873117155126, 'psi': 0.9950871711182661}
[S9] START round=25 head_norm_before_train=1.586580 cos_to_last_merge=0.8391 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.839
[S9] round=25 local utility u=0.017978 metrics={'f1_val': 0.7014667606303384, 'auprc': 0.99821175815018, 'loss_val': 0.19984178856719553, 'psi': 0.8201647596382751}-{'f1_val': 0.7014667606303384, 'auprc': 0.9983192526693543, 'loss_val': 0.2361206612101374, 'psi': 0.8202077574459448}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=25 head_norm_before_train=1.507717 cos_to_last_merge=0.9910 (last merge round=19)
[S10] round=25 local utility u=0.005913 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9953913600586939, 'loss_val': 0.09602403887518265, 'psi': 0.9952692474351024}-{'f1_val': 0.9951878390193748, 'auprc': 0.9954467496287455, 'loss_val': 0.10801595093410386, 'psi': 0.995291403263123}
[S11] START round=25 head_norm_before_train=1.343438 cos_to_last_merge=0.9878 (last merge round=19)
[S11] round=25 local utility u=0.780070 metrics={'f1_val': 0.9566315483935912, 'auprc': 0.9979917959365113, 'loss_val': 0.20298470963889204, 'psi': 0.9731756474107592}-{'f1_val': 0.7016934795869249, 'auprc': 0.9979856779632079, 'loss_val': 0.23347771611244308, 'psi': 0.8202103589374381}
[S13] START round=25 head_norm_before_train=1.614839 cos_to_last_merge=0.9983 (last merge round=20)
[S13] round=25 local utility u=0.016748 metrics={'f1_val': 0.565535733872542, 'auprc': 0.6421434206558959, 'loss_val': 0.755955363346872, 'psi': 0.5961788085858836}-{'f1_val': 0.5483388619072797, 'auprc': 0.6738440791791419, 'loss_val': 0.78137251156098, 'psi': 0.5985409488160245}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=25 head_norm_before_train=1.604883 cos_to_last_merge=0.9892 (last merge round=17)
[S14] round=25 local utility u=0.001030 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9963643629647638, 'loss_val': 0.05347874968965168, 'psi': 0.9967442500805046}-{'f1_val': 0.9969975081576651, 'auprc': 0.9970891185366618, 'loss_val': 0.05771239438159822, 'psi': 0.9970341523092638}
[S15] START round=25 head_norm_before_train=1.564711 cos_to_last_merge=0.9942 (last merge round=19)
[S15] round=25 local utility u=0.000000 metrics={'f1_val': 0.6987969326752825, 'auprc': 0.9700615711240427, 'loss_val': 0.5196609871536659, 'psi': 0.8073027880547866}-{'f1_val': 0.9495907432463466, 'auprc': 0.9914595995485718, 'loss_val': 0.1395744756997091, 'psi': 0.9663382857672367}
[S16] START round=25 head_norm_before_train=1.837315 (no previous merge yet)
[S16] round=25 local utility u=0.000000 metrics={'f1_val': 0.946296970044653, 'auprc': 0.9967295103684279, 'loss_val': 0.119664307103015, 'psi': 0.966469986174163}-{'f1_val': 0.9743440844942117, 'auprc': 0.9973451181998952, 'loss_val': 0.0913707919960829, 'psi': 0.9835444979764851}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=25 head_norm_before_train=1.828094 (no previous merge yet)
[S17] round=25 local utility u=0.000000 metrics={'f1_val': 0.5536781265635643, 'auprc': 0.9167138977167286, 'loss_val': 0.745249679307349, 'psi': 0.69889243502483}-{'f1_val': 0.6482846225920224, 'auprc': 0.9329952861540793, 'loss_val': 0.6982098225822763, 'psi': 0.7621688880168451}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S4] sending update (kind=head size=1808 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S11] sending update (kind=head size=1807 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] sending update (kind=head size=1804 to 1 peers)
[S2] START round=26 head_norm_before_train=1.443324 cos_to_last_merge=0.9955 (last merge round=19)
[S2] round=26 local utility u=0.000000 metrics={'f1_val': 0.6996105493161282, 'auprc': 0.6593712177985013, 'loss_val': 0.3780958543845707, 'psi': 0.6835148167090774}-{'f1_val': 0.7050720623869249, 'auprc': 0.7907534549172397, 'loss_val': 0.39503427489090676, 'psi': 0.7393446193990508}
[S3] START round=26 head_norm_before_train=1.149292 cos_to_last_merge=0.9748 (last merge round=19)
[S3] round=26 local utility u=0.000797 metrics={'f1_val': 0.7006060025002057, 'auprc': 0.9971345158466332, 'loss_val': 0.28107684179519266, 'psi': 0.8192174078387766}-{'f1_val': 0.7006809596653347, 'auprc': 0.9982353323762344, 'loss_val': 0.2864226456316401, 'psi': 0.8197027087496946}
[S4] START round=26 head_norm_before_train=1.626609 cos_to_last_merge=0.7724 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.772
[S4] round=26 local utility u=0.000000 metrics={'f1_val': 0.9467423020790715, 'auprc': 0.927681522209785, 'loss_val': 0.2935858846551364, 'psi': 0.9391179901313569}-{'f1_val': 0.957224167356098, 'auprc': 0.955495030731918, 'loss_val': 0.2789070355012022, 'psi': 0.9565325127064261}
[S5] START round=26 head_norm_before_train=1.280691 cos_to_last_merge=0.9763 (last merge round=19)
[S5] round=26 local utility u=0.000000 metrics={'f1_val': 0.41698169927682627, 'auprc': 0.7544559178061733, 'loss_val': 1.5094511979977991, 'psi': 0.551971386688565}-{'f1_val': 0.7003213174339138, 'auprc': 0.9895614206337366, 'loss_val': 0.311395866345948, 'psi': 0.8160173587138428}
[S6] START round=26 head_norm_before_train=1.423428 cos_to_last_merge=0.7906 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.791
[S6] round=26 local utility u=0.000000 metrics={'f1_val': 0.6821376363194063, 'auprc': 0.9362562802328229, 'loss_val': 0.5473007940269056, 'psi': 0.7837850938847729}-{'f1_val': 0.7888848141799751, 'auprc': 0.956173304915109, 'loss_val': 0.4039304344403273, 'psi': 0.8558002104740287}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=26 head_norm_before_train=1.272372 cos_to_last_merge=0.7901 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.790
[S7] round=26 local utility u=0.000000 metrics={'f1_val': 0.42987431829186273, 'auprc': 0.780891878442285, 'loss_val': 1.0295171869790143, 'psi': 0.5702813423520317}-{'f1_val': 0.6786378390553022, 'auprc': 0.8300139943361999, 'loss_val': 0.4452695763591431, 'psi': 0.7391883011676613}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=26 head_norm_before_train=1.572727 cos_to_last_merge=0.9841 (last merge round=19)
[S8] round=26 local utility u=0.000000 metrics={'f1_val': 0.9921779497216437, 'auprc': 0.9933422321297152, 'loss_val': 0.050091882817061145, 'psi': 0.9926436626848724}-{'f1_val': 0.9929361822751569, 'auprc': 0.9981877883153758, 'loss_val': 0.05201259910769743, 'psi': 0.9950368246912444}
[S9] START round=26 head_norm_before_train=1.599849 cos_to_last_merge=0.8392 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.839
[S9] round=26 local utility u=0.005751 metrics={'f1_val': 0.7014667606303384, 'auprc': 0.9983670800277753, 'loss_val': 0.18880551561148098, 'psi': 0.8202268883893131}-{'f1_val': 0.7014667606303384, 'auprc': 0.99821175815018, 'loss_val': 0.19984178856719553, 'psi': 0.8201647596382751}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=26 head_norm_before_train=1.543693 cos_to_last_merge=0.9880 (last merge round=19)
[S10] round=26 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9923409537640633, 'loss_val': 0.09532134515134918, 'psi': 0.9940490849172501}-{'f1_val': 0.9951878390193748, 'auprc': 0.9953913600586939, 'loss_val': 0.09602403887518265, 'psi': 0.9952692474351024}
[S11] START round=26 head_norm_before_train=1.367942 cos_to_last_merge=0.9845 (last merge round=19)
[S11] round=26 local utility u=0.086661 metrics={'f1_val': 0.981169186686789, 'auprc': 0.997982513870147, 'loss_val': 0.17686168578171987, 'psi': 0.9878945175601321}-{'f1_val': 0.9566315483935912, 'auprc': 0.9979917959365113, 'loss_val': 0.20298470963889204, 'psi': 0.9731756474107592}
[S13] START round=26 head_norm_before_train=1.628644 cos_to_last_merge=0.9974 (last merge round=20)
[S13] round=26 local utility u=0.023729 metrics={'f1_val': 0.5579416935995863, 'auprc': 0.6848692280521114, 'loss_val': 0.7911105947473366, 'psi': 0.6087127073805964}-{'f1_val': 0.565535733872542, 'auprc': 0.6421434206558959, 'loss_val': 0.755955363346872, 'psi': 0.5961788085858836}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=26 head_norm_before_train=1.630363 cos_to_last_merge=0.9875 (last merge round=17)
[S14] round=26 local utility u=0.000000 metrics={'f1_val': 0.9949559986320392, 'auprc': 0.995890204522345, 'loss_val': 0.05888916087672584, 'psi': 0.9953296809881615}-{'f1_val': 0.9969975081576651, 'auprc': 0.9963643629647638, 'loss_val': 0.05347874968965168, 'psi': 0.9967442500805046}
[S15] START round=26 head_norm_before_train=1.592676 cos_to_last_merge=0.9926 (last merge round=19)
[S15] round=26 local utility u=0.336371 metrics={'f1_val': 0.7613267752896498, 'auprc': 0.9934040954544284, 'loss_val': 0.29212495396103577, 'psi': 0.8541577033555612}-{'f1_val': 0.6987969326752825, 'auprc': 0.9700615711240427, 'loss_val': 0.5196609871536659, 'psi': 0.8073027880547866}
[S16] START round=26 head_norm_before_train=1.851357 (no previous merge yet)
[S16] round=26 local utility u=0.000000 metrics={'f1_val': 0.8820228805975246, 'auprc': 0.98771509415584, 'loss_val': 0.47821899805708956, 'psi': 0.9242997660208507}-{'f1_val': 0.946296970044653, 'auprc': 0.9967295103684279, 'loss_val': 0.119664307103015, 'psi': 0.966469986174163}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=26 head_norm_before_train=1.843288 (no previous merge yet)
[S17] round=26 local utility u=0.552779 metrics={'f1_val': 0.6777954822016968, 'auprc': 0.9703078319591861, 'loss_val': 0.5451767990657801, 'psi': 0.7948004221046926}-{'f1_val': 0.5536781265635643, 'auprc': 0.9167138977167286, 'loss_val': 0.745249679307349, 'psi': 0.69889243502483}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2]  timeout peer S4
[S2]  timeout peer S8
[S11]  timeout peer S15
[S5]  timeout peer S3
[S10]  timeout peer S5
[S14]  timeout peer S10
[S8]  timeout peer S2
[S4]  timeout peer S7
[S3]  timeout peer S11
[S15]  timeout peer S13
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S15] sending update (kind=head size=1806 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] sending update (kind=head size=1793 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S11] sending update (kind=head size=1807 to 1 peers)
[S2] START round=27 head_norm_before_train=1.455720 cos_to_last_merge=0.9946 (last merge round=19)
[S2] round=27 local utility u=0.000000 metrics={'f1_val': 0.6992497273755923, 'auprc': 0.6586898405336479, 'loss_val': 0.37468755615077526, 'psi': 0.6830257726388145}-{'f1_val': 0.6996105493161282, 'auprc': 0.6593712177985013, 'loss_val': 0.3780958543845707, 'psi': 0.6835148167090774}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=27 head_norm_before_train=1.171650 cos_to_last_merge=0.9718 (last merge round=19)
[S3] round=27 local utility u=0.002689 metrics={'f1_val': 0.7006060025002057, 'auprc': 0.9972548126842216, 'loss_val': 0.2760591384760625, 'psi': 0.819265526573812}-{'f1_val': 0.7006060025002057, 'auprc': 0.9971345158466332, 'loss_val': 0.28107684179519266, 'psi': 0.8192174078387766}
[S3] not sending this round → trigger blocked (psi=0.819)
[S4] START round=27 head_norm_before_train=1.640919 cos_to_last_merge=0.7702 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.770
[S4] round=27 local utility u=0.056871 metrics={'f1_val': 0.9490376242874445, 'auprc': 0.958449956101886, 'loss_val': 0.28592151289229, 'psi': 0.9528025570132211}-{'f1_val': 0.9467423020790715, 'auprc': 0.927681522209785, 'loss_val': 0.2935858846551364, 'psi': 0.9391179901313569}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] sending update (kind=head size=1805 to 1 peers)
[S5] START round=27 head_norm_before_train=1.295292 cos_to_last_merge=0.9738 (last merge round=19)
[S5] round=27 local utility u=1.000000 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.8061790396283638, 'loss_val': 0.30406599112176613, 'psi': 0.7426644063116938}-{'f1_val': 0.41698169927682627, 'auprc': 0.7544559178061733, 'loss_val': 1.5094511979977991, 'psi': 0.551971386688565}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=27 head_norm_before_train=1.442234 cos_to_last_merge=0.7892 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.789
[S6] round=27 local utility u=1.000000 metrics={'f1_val': 0.9395042268530409, 'auprc': 0.9709605539185795, 'loss_val': 0.18938783178772758, 'psi': 0.9520867576792563}-{'f1_val': 0.6821376363194063, 'auprc': 0.9362562802328229, 'loss_val': 0.5473007940269056, 'psi': 0.7837850938847729}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=27 head_norm_before_train=1.284844 cos_to_last_merge=0.7882 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.788
[S7] round=27 local utility u=1.000000 metrics={'f1_val': 0.6727056011791446, 'auprc': 0.8339173111950742, 'loss_val': 0.4431395895358677, 'psi': 0.7371902851855164}-{'f1_val': 0.42987431829186273, 'auprc': 0.780891878442285, 'loss_val': 1.0295171869790143, 'psi': 0.5702813423520317}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=27 head_norm_before_train=1.596287 cos_to_last_merge=0.9822 (last merge round=19)
[S8] round=27 local utility u=0.004560 metrics={'f1_val': 0.9910860494090681, 'auprc': 0.9988850054184844, 'loss_val': 0.051049490174081204, 'psi': 0.9942056318128346}-{'f1_val': 0.9921779497216437, 'auprc': 0.9933422321297152, 'loss_val': 0.050091882817061145, 'psi': 0.9926436626848724}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] sending update (kind=head size=1804 to 1 peers)
[S9] START round=27 head_norm_before_train=1.614706 cos_to_last_merge=0.8402 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.840
[S9] round=27 local utility u=0.875737 metrics={'f1_val': 0.9820498998607067, 'auprc': 0.9982145574314697, 'loss_val': 0.12037232600162802, 'psi': 0.988515762889012}-{'f1_val': 0.7014667606303384, 'auprc': 0.9983670800277753, 'loss_val': 0.18880551561148098, 'psi': 0.8202268883893131}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=27 head_norm_before_train=1.577634 cos_to_last_merge=0.9849 (last merge round=19)
[S10] round=27 local utility u=0.012518 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9955319906416915, 'loss_val': 0.07985931405402658, 'psi': 0.9953254996683014}-{'f1_val': 0.9951878390193748, 'auprc': 0.9923409537640633, 'loss_val': 0.09532134515134918, 'psi': 0.9940490849172501}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=27 head_norm_before_train=1.390776 cos_to_last_merge=0.9812 (last merge round=19)
[S11] round=27 local utility u=0.049338 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9979427060144145, 'loss_val': 0.16785239294705623, 'psi': 0.9968572873537513}-{'f1_val': 0.981169186686789, 'auprc': 0.997982513870147, 'loss_val': 0.17686168578171987, 'psi': 0.9878945175601321}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=27 head_norm_before_train=1.644049 cos_to_last_merge=0.9965 (last merge round=20)
[S13] round=27 local utility u=0.047883 metrics={'f1_val': 0.5667206732370536, 'auprc': 0.682481621174812, 'loss_val': 0.7408566347398083, 'psi': 0.613025052412157}-{'f1_val': 0.5579416935995863, 'auprc': 0.6848692280521114, 'loss_val': 0.7911105947473366, 'psi': 0.6087127073805964}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=27 head_norm_before_train=1.653956 cos_to_last_merge=0.9859 (last merge round=17)
[S14] round=27 local utility u=0.016390 metrics={'f1_val': 0.9972854860577647, 'auprc': 0.9971534629475326, 'loss_val': 0.04387665964066331, 'psi': 0.9972326768136718}-{'f1_val': 0.9949559986320392, 'auprc': 0.995890204522345, 'loss_val': 0.05888916087672584, 'psi': 0.9953296809881615}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=27 head_norm_before_train=1.621601 cos_to_last_merge=0.9908 (last merge round=19)
[S15] round=27 local utility u=0.564627 metrics={'f1_val': 0.922489368076341, 'auprc': 0.9935463385339667, 'loss_val': 0.13027280643094072, 'psi': 0.9509121562593912}-{'f1_val': 0.7613267752896498, 'auprc': 0.9934040954544284, 'loss_val': 0.29212495396103577, 'psi': 0.8541577033555612}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=27 head_norm_before_train=1.865505 (no previous merge yet)
[S16] round=27 local utility u=0.307687 metrics={'f1_val': 0.9401894052440868, 'auprc': 0.9895675306763203, 'loss_val': 0.21740175324069497, 'psi': 0.9599406554169803}-{'f1_val': 0.8820228805975246, 'auprc': 0.98771509415584, 'loss_val': 0.47821899805708956, 'psi': 0.9242997660208507}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=27 head_norm_before_train=1.858701 (no previous merge yet)
[S17] round=27 local utility u=0.000000 metrics={'f1_val': 0.5855377817496568, 'auprc': 0.9634738095738928, 'loss_val': 0.6043330316418202, 'psi': 0.7367121928793512}-{'f1_val': 0.6777954822016968, 'auprc': 0.9703078319591861, 'loss_val': 0.5451767990657801, 'psi': 0.7948004221046926}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=28 head_norm_before_train=1.466834 cos_to_last_merge=0.9939 (last merge round=19)
[S2] round=28 local utility u=0.009288 metrics={'f1_val': 0.6996105493161282, 'auprc': 0.6584321757865519, 'loss_val': 0.35750437025059334, 'psi': 0.6831391999042977}-{'f1_val': 0.6992497273755923, 'auprc': 0.6586898405336479, 'loss_val': 0.37468755615077526, 'psi': 0.6830257726388145}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=28 head_norm_before_train=1.191921 cos_to_last_merge=0.9695 (last merge round=19)
[S3] round=28 local utility u=0.006158 metrics={'f1_val': 0.7006060025002057, 'auprc': 0.9976321647946934, 'loss_val': 0.2648760984441193, 'psi': 0.8194164674180007}-{'f1_val': 0.7006060025002057, 'auprc': 0.9972548126842216, 'loss_val': 0.2760591384760625, 'psi': 0.819265526573812}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=28 head_norm_before_train=1.655486 cos_to_last_merge=0.7681 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.768
[S4] round=28 local utility u=0.000000 metrics={'f1_val': 0.9472307098938038, 'auprc': 0.9265699744096421, 'loss_val': 0.29953251559800526, 'psi': 0.9389664157001392}-{'f1_val': 0.9490376242874445, 'auprc': 0.958449956101886, 'loss_val': 0.28592151289229, 'psi': 0.9528025570132211}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=28 head_norm_before_train=1.303895 cos_to_last_merge=0.9727 (last merge round=19)
[S5] round=28 local utility u=0.000000 metrics={'f1_val': 0.41972184799160556, 'auprc': 0.7587086912690059, 'loss_val': 0.9683733956275777, 'psi': 0.5553165853025657}-{'f1_val': 0.7003213174339138, 'auprc': 0.8061790396283638, 'loss_val': 0.30406599112176613, 'psi': 0.7426644063116938}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=28 head_norm_before_train=1.459789 cos_to_last_merge=0.7874 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.787
[S6] round=28 local utility u=0.000000 metrics={'f1_val': 0.4612753073335411, 'auprc': 0.7791166858469208, 'loss_val': 0.7939411148467929, 'psi': 0.588411858738893}-{'f1_val': 0.9395042268530409, 'auprc': 0.9709605539185795, 'loss_val': 0.18938783178772758, 'psi': 0.9520867576792563}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=28 head_norm_before_train=1.295292 cos_to_last_merge=0.7867 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.787
[S7] round=28 local utility u=0.000000 metrics={'f1_val': 0.5131523235137573, 'auprc': 0.7782291969305, 'loss_val': 0.9631050844593375, 'psi': 0.6191830728804544}-{'f1_val': 0.6727056011791446, 'auprc': 0.8339173111950742, 'loss_val': 0.4431395895358677, 'psi': 0.7371902851855164}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=28 head_norm_before_train=1.613644 cos_to_last_merge=0.9810 (last merge round=19)
[S8] round=28 local utility u=0.008228 metrics={'f1_val': 0.9933016371923923, 'auprc': 0.9981926541506766, 'loss_val': 0.045810578037137215, 'psi': 0.995258043975706}-{'f1_val': 0.9910860494090681, 'auprc': 0.9988850054184844, 'loss_val': 0.051049490174081204, 'psi': 0.9942056318128346}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=28 head_norm_before_train=1.632813 cos_to_last_merge=0.8406 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.841
[S9] round=28 local utility u=0.031968 metrics={'f1_val': 0.9876451771534523, 'auprc': 0.9982076506539723, 'loss_val': 0.08998779304624331, 'psi': 0.9918701665536602}-{'f1_val': 0.9820498998607067, 'auprc': 0.9982145574314697, 'loss_val': 0.12037232600162802, 'psi': 0.988515762889012}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] sending update (kind=head size=1803 to 1 peers)
[S10] START round=28 head_norm_before_train=1.608429 cos_to_last_merge=0.9822 (last merge round=19)
[S10] round=28 local utility u=0.000000 metrics={'f1_val': 0.9944043122373717, 'auprc': 0.9961860116553672, 'loss_val': 0.07994720572083353, 'psi': 0.9951169920045699}-{'f1_val': 0.9951878390193748, 'auprc': 0.9955319906416915, 'loss_val': 0.07985931405402658, 'psi': 0.9953254996683014}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=28 head_norm_before_train=1.414538 cos_to_last_merge=0.9776 (last merge round=19)
[S11] round=28 local utility u=0.016731 metrics={'f1_val': 0.9963753869090841, 'auprc': 0.9979705080845505, 'loss_val': 0.13592464188088033, 'psi': 0.9970134353792707}-{'f1_val': 0.9961336749133093, 'auprc': 0.9979427060144145, 'loss_val': 0.16785239294705623, 'psi': 0.9968572873537513}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=28 head_norm_before_train=1.660130 cos_to_last_merge=0.9955 (last merge round=20)
[S13] round=28 local utility u=0.000000 metrics={'f1_val': 0.5666756759251184, 'auprc': 0.6864826240644807, 'loss_val': 0.8431880731392329, 'psi': 0.6145984551808633}-{'f1_val': 0.5667206732370536, 'auprc': 0.682481621174812, 'loss_val': 0.7408566347398083, 'psi': 0.613025052412157}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=28 head_norm_before_train=1.668067 cos_to_last_merge=0.9846 (last merge round=17)
[S14] round=28 local utility u=0.000000 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9970917688079334, 'loss_val': 0.047271496437257976, 'psi': 0.9972816692242087}-{'f1_val': 0.9972854860577647, 'auprc': 0.9971534629475326, 'loss_val': 0.04387665964066331, 'psi': 0.9972326768136718}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=28 head_norm_before_train=1.653595 cos_to_last_merge=0.9887 (last merge round=19)
[S15] round=28 local utility u=0.000000 metrics={'f1_val': 0.744708272421895, 'auprc': 0.990768627481361, 'loss_val': 0.34283686431434385, 'psi': 0.8431324144456813}-{'f1_val': 0.922489368076341, 'auprc': 0.9935463385339667, 'loss_val': 0.13027280643094072, 'psi': 0.9509121562593912}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=28 head_norm_before_train=1.878225 (no previous merge yet)
[S16] round=28 local utility u=0.000000 metrics={'f1_val': 0.8347614644340038, 'auprc': 0.9644870632418329, 'loss_val': 0.565056048609934, 'psi': 0.8866517039571354}-{'f1_val': 0.9401894052440868, 'auprc': 0.9895675306763203, 'loss_val': 0.21740175324069497, 'psi': 0.9599406554169803}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=28 head_norm_before_train=1.873891 (no previous merge yet)
[S17] round=28 local utility u=0.000000 metrics={'f1_val': 0.5713572116201029, 'auprc': 0.8371513360399976, 'loss_val': 0.7038817725687401, 'psi': 0.6776748613880608}-{'f1_val': 0.5855377817496568, 'auprc': 0.9634738095738928, 'loss_val': 0.6043330316418202, 'psi': 0.7367121928793512}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=29 head_norm_before_train=1.478801 cos_to_last_merge=0.9933 (last merge round=19)
[S2] round=29 local utility u=0.203477 metrics={'f1_val': 0.7010877703372841, 'auprc': 0.7920792225053385, 'loss_val': 0.36035408634721, 'psi': 0.737484351204506}-{'f1_val': 0.6996105493161282, 'auprc': 0.6584321757865519, 'loss_val': 0.35750437025059334, 'psi': 0.6831391999042977}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[S3] START round=29 head_norm_before_train=1.209460 cos_to_last_merge=0.9676 (last merge round=19)
[S3] round=29 local utility u=0.000000 metrics={'f1_val': 0.7005313319257805, 'auprc': 0.9971382863529323, 'loss_val': 0.26480150418296194, 'psi': 0.8191741136966413}-{'f1_val': 0.7006060025002057, 'auprc': 0.9976321647946934, 'loss_val': 0.2648760984441193, 'psi': 0.8194164674180007}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=29 head_norm_before_train=1.669197 cos_to_last_merge=0.7669 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.767
[S4] round=29 local utility u=0.038924 metrics={'f1_val': 0.9507487936815566, 'auprc': 0.9436214865081857, 'loss_val': 0.2939478326482107, 'psi': 0.9478978708122082}-{'f1_val': 0.9472307098938038, 'auprc': 0.9265699744096421, 'loss_val': 0.29953251559800526, 'psi': 0.9389664157001392}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] sending update (kind=head size=1805 to 1 peers)
[S5] START round=29 head_norm_before_train=1.310045 cos_to_last_merge=0.9722 (last merge round=19)
[S5] round=29 local utility u=1.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.8211461784744059, 'loss_val': 0.30137510476128193, 'psi': 0.7486508304845778}-{'f1_val': 0.41972184799160556, 'auprc': 0.7587086912690059, 'loss_val': 0.9683733956275777, 'psi': 0.5553165853025657}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=29 head_norm_before_train=1.473425 cos_to_last_merge=0.7866 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.787
[S6] round=29 local utility u=1.000000 metrics={'f1_val': 0.8471863688340894, 'auprc': 0.9660032996760018, 'loss_val': 0.23346892275964873, 'psi': 0.8947131411708544}-{'f1_val': 0.4612753073335411, 'auprc': 0.7791166858469208, 'loss_val': 0.7939411148467929, 'psi': 0.588411858738893}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] sending update (kind=head size=1796 to 1 peers)
[S7] START round=29 head_norm_before_train=1.304366 cos_to_last_merge=0.7853 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.785
[S7] round=29 local utility u=0.272463 metrics={'f1_val': 0.5668046082313665, 'auprc': 0.7901210176593673, 'loss_val': 0.7757685125811513, 'psi': 0.6561311720025669}-{'f1_val': 0.5131523235137573, 'auprc': 0.7782291969305, 'loss_val': 0.9631050844593375, 'psi': 0.6191830728804544}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] sending update (kind=head size=1797 to 1 peers)
[S8] START round=29 head_norm_before_train=1.628872 cos_to_last_merge=0.9800 (last merge round=19)
[S8] round=29 local utility u=0.000653 metrics={'f1_val': 0.9933016371923923, 'auprc': 0.9981337960094476, 'loss_val': 0.04432721122923926, 'psi': 0.9952345007192145}-{'f1_val': 0.9933016371923923, 'auprc': 0.9981926541506766, 'loss_val': 0.045810578037137215, 'psi': 0.995258043975706}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=29 head_norm_before_train=1.653643 cos_to_last_merge=0.8409 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.841
[S9] round=29 local utility u=0.039721 metrics={'f1_val': 0.9956610011122148, 'auprc': 0.9981432957212841, 'loss_val': 0.0584473189502028, 'psi': 0.9966539189558425}-{'f1_val': 0.9876451771534523, 'auprc': 0.9982076506539723, 'loss_val': 0.08998779304624331, 'psi': 0.9918701665536602}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] sending update (kind=head size=1803 to 1 peers)
[S10] START round=29 head_norm_before_train=1.635036 cos_to_last_merge=0.9798 (last merge round=19)
[S10] round=29 local utility u=0.005790 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9931859300099454, 'loss_val': 0.06406760471546134, 'psi': 0.994387075415603}-{'f1_val': 0.9944043122373717, 'auprc': 0.9961860116553672, 'loss_val': 0.07994720572083353, 'psi': 0.9951169920045699}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=29 head_norm_before_train=1.442502 cos_to_last_merge=0.9731 (last merge round=19)
[S11] round=29 local utility u=0.010022 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9978834749684646, 'loss_val': 0.1141694093898652, 'psi': 0.9968335949353715}-{'f1_val': 0.9963753869090841, 'auprc': 0.9979705080845505, 'loss_val': 0.13592464188088033, 'psi': 0.9970134353792707}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] sending update (kind=head size=1803 to 1 peers)
[S13] START round=29 head_norm_before_train=1.675056 cos_to_last_merge=0.9944 (last merge round=20)
[S13] round=29 local utility u=0.025346 metrics={'f1_val': 0.5634596530567543, 'auprc': 0.6854586650070353, 'loss_val': 0.7701276383678051, 'psi': 0.6122592578368666}-{'f1_val': 0.5666756759251184, 'auprc': 0.6864826240644807, 'loss_val': 0.8431880731392329, 'psi': 0.6145984551808633}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=29 head_norm_before_train=1.678862 cos_to_last_merge=0.9836 (last merge round=17)
[S14] round=29 local utility u=0.001622 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9971182171141546, 'loss_val': 0.044106279826379456, 'psi': 0.9972922485466972}-{'f1_val': 0.9974082695017256, 'auprc': 0.9970917688079334, 'loss_val': 0.047271496437257976, 'psi': 0.9972816692242087}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=29 head_norm_before_train=1.689010 cos_to_last_merge=0.9862 (last merge round=19)
[S15] round=29 local utility u=0.780598 metrics={'f1_val': 0.9668513023712746, 'auprc': 0.9964598180492419, 'loss_val': 0.1315735114903735, 'psi': 0.9786947086424616}-{'f1_val': 0.744708272421895, 'auprc': 0.990768627481361, 'loss_val': 0.34283686431434385, 'psi': 0.8431324144456813}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=29 head_norm_before_train=1.891885 (no previous merge yet)
[S16] round=29 local utility u=0.138721 metrics={'f1_val': 0.8693230602628753, 'auprc': 0.9901111633666463, 'loss_val': 0.571856642164644, 'psi': 0.9176383015043836}-{'f1_val': 0.8347614644340038, 'auprc': 0.9644870632418329, 'loss_val': 0.565056048609934, 'psi': 0.8866517039571354}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] sending update (kind=head size=1804 to 1 peers)
[S17] START round=29 head_norm_before_train=1.889770 (no previous merge yet)
[S17] round=29 local utility u=0.000000 metrics={'f1_val': 0.5353008486073118, 'auprc': 0.7461940475346758, 'loss_val': 0.9588592431646364, 'psi': 0.6196581281782574}-{'f1_val': 0.5713572116201029, 'auprc': 0.8371513360399976, 'loss_val': 0.7038817725687401, 'psi': 0.6776748613880608}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=30 head_norm_before_train=1.491348 cos_to_last_merge=0.9925 (last merge round=19)
[S2] round=30 local utility u=0.000000 metrics={'f1_val': 0.6998688180552864, 'auprc': 0.6594396054629547, 'loss_val': 0.3626232149010858, 'psi': 0.6836971330183537}-{'f1_val': 0.7010877703372841, 'auprc': 0.7920792225053385, 'loss_val': 0.36035408634721, 'psi': 0.737484351204506}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=30 head_norm_before_train=1.227035 cos_to_last_merge=0.9654 (last merge round=19)
[S3] round=30 local utility u=0.005316 metrics={'f1_val': 0.7006060025002057, 'auprc': 0.9977323637262796, 'loss_val': 0.2563989182578723, 'psi': 0.8194565469906352}-{'f1_val': 0.7005313319257805, 'auprc': 0.9971382863529323, 'loss_val': 0.26480150418296194, 'psi': 0.8191741136966413}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=30 head_norm_before_train=1.682071 cos_to_last_merge=0.7660 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.766
[S4] round=30 local utility u=0.000000 metrics={'f1_val': 0.9416028128744927, 'auprc': 0.9160147369541308, 'loss_val': 0.31718180851459715, 'psi': 0.9313675825063479}-{'f1_val': 0.9507487936815566, 'auprc': 0.9436214865081857, 'loss_val': 0.2939478326482107, 'psi': 0.9478978708122082}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=30 head_norm_before_train=1.318526 cos_to_last_merge=0.9714 (last merge round=19)
[S5] round=30 local utility u=0.000000 metrics={'f1_val': 0.6290026128144349, 'auprc': 0.8445096527424689, 'loss_val': 0.43228000393761257, 'psi': 0.7152054287856485}-{'f1_val': 0.700320598491359, 'auprc': 0.8211461784744059, 'loss_val': 0.30137510476128193, 'psi': 0.7486508304845778}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=30 head_norm_before_train=1.482574 cos_to_last_merge=0.7861 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.786
[S6] round=30 local utility u=0.000000 metrics={'f1_val': 0.6142127650160614, 'auprc': 0.8041381602560899, 'loss_val': 0.7806416738364125, 'psi': 0.6901829231120727}-{'f1_val': 0.8471863688340894, 'auprc': 0.9660032996760018, 'loss_val': 0.23346892275964873, 'psi': 0.8947131411708544}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=30 head_norm_before_train=1.312582 cos_to_last_merge=0.7840 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.784
[S7] round=30 local utility u=0.720641 metrics={'f1_val': 0.6851205222058807, 'auprc': 0.8912550210985702, 'loss_val': 0.34778397678747025, 'psi': 0.7675743217629565}-{'f1_val': 0.5668046082313665, 'auprc': 0.7901210176593673, 'loss_val': 0.7757685125811513, 'psi': 0.6561311720025669}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=30 head_norm_before_train=1.645168 cos_to_last_merge=0.9789 (last merge round=19)
[S8] round=30 local utility u=0.000000 metrics={'f1_val': 0.9896558900940475, 'auprc': 0.9988996324273414, 'loss_val': 0.04863910751667379, 'psi': 0.9933533870273651}-{'f1_val': 0.9933016371923923, 'auprc': 0.9981337960094476, 'loss_val': 0.04432721122923926, 'psi': 0.9952345007192145}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=30 head_norm_before_train=1.676203 cos_to_last_merge=0.8408 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.841
[S9] round=30 local utility u=0.000000 metrics={'f1_val': 0.9886727075027679, 'auprc': 0.9983959559941392, 'loss_val': 0.05915243080035835, 'psi': 0.9925620068993164}-{'f1_val': 0.9956610011122148, 'auprc': 0.9981432957212841, 'loss_val': 0.0584473189502028, 'psi': 0.9966539189558425}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=30 head_norm_before_train=1.657799 cos_to_last_merge=0.9777 (last merge round=19)
[S10] round=30 local utility u=0.000000 metrics={'f1_val': 0.9943563983784213, 'auprc': 0.9921294010219129, 'loss_val': 0.06464216475167435, 'psi': 0.9934655994358179}-{'f1_val': 0.9951878390193748, 'auprc': 0.9931859300099454, 'loss_val': 0.06406760471546134, 'psi': 0.994387075415603}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=30 head_norm_before_train=1.471524 cos_to_last_merge=0.9684 (last merge round=19)
[S11] round=30 local utility u=0.009367 metrics={'f1_val': 0.9966169742661891, 'auprc': 0.99780514074544, 'loss_val': 0.09810087147021192, 'psi': 0.9970922408578895}-{'f1_val': 0.9961336749133093, 'auprc': 0.9978834749684646, 'loss_val': 0.1141694093898652, 'psi': 0.9968335949353715}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=30 head_norm_before_train=1.687933 cos_to_last_merge=0.9934 (last merge round=20)
[S13] round=30 local utility u=0.056246 metrics={'f1_val': 0.573416696203426, 'auprc': 0.6810705176462789, 'loss_val': 0.7042127542489065, 'psi': 0.6164782247805671}-{'f1_val': 0.5634596530567543, 'auprc': 0.6854586650070353, 'loss_val': 0.7701276383678051, 'psi': 0.6122592578368666}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=30 head_norm_before_train=1.692412 cos_to_last_merge=0.9827 (last merge round=17)
[S14] round=30 local utility u=0.003557 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9971537352068839, 'loss_val': 0.0385554047977335, 'psi': 0.9974521649126658}-{'f1_val': 0.9974082695017256, 'auprc': 0.9971182171141546, 'loss_val': 0.044106279826379456, 'psi': 0.9972922485466972}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] sending update (kind=head size=1804 to 1 peers)
[S15] START round=30 head_norm_before_train=1.721844 cos_to_last_merge=0.9837 (last merge round=19)
[S15] round=30 local utility u=0.000000 metrics={'f1_val': 0.6921751044579605, 'auprc': 0.9878202133975168, 'loss_val': 0.5360397720834389, 'psi': 0.810433148033783}-{'f1_val': 0.9668513023712746, 'auprc': 0.9964598180492419, 'loss_val': 0.1315735114903735, 'psi': 0.9786947086424616}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=30 head_norm_before_train=1.901856 (no previous merge yet)
[S16] round=30 local utility u=0.000000 metrics={'f1_val': 0.8267719464041778, 'auprc': 0.917797386916703, 'loss_val': 1.0233601638574825, 'psi': 0.8631821226091879}-{'f1_val': 0.8693230602628753, 'auprc': 0.9901111633666463, 'loss_val': 0.571856642164644, 'psi': 0.9176383015043836}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=30 head_norm_before_train=1.906141 (no previous merge yet)
[S17] round=30 local utility u=0.457332 metrics={'f1_val': 0.5612393006537002, 'auprc': 0.9501424086704081, 'loss_val': 0.8116711215711198, 'psi': 0.7168005438603834}-{'f1_val': 0.5353008486073118, 'auprc': 0.7461940475346758, 'loss_val': 0.9588592431646364, 'psi': 0.6196581281782574}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=31 head_norm_before_train=1.501314 cos_to_last_merge=0.9917 (last merge round=19)
[S2] round=31 local utility u=0.165294 metrics={'f1_val': 0.7013732463601503, 'auprc': 0.7754481767159462, 'loss_val': 0.38908656278531223, 'psi': 0.7310032185024686}-{'f1_val': 0.6998688180552864, 'auprc': 0.6594396054629547, 'loss_val': 0.3626232149010858, 'psi': 0.6836971330183537}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=31 head_norm_before_train=1.242247 cos_to_last_merge=0.9638 (last merge round=19)
[S3] round=31 local utility u=0.007142 metrics={'f1_val': 0.7006060025002057, 'auprc': 0.9971176790607905, 'loss_val': 0.24027177490474716, 'psi': 0.8192106731244395}-{'f1_val': 0.7006060025002057, 'auprc': 0.9977323637262796, 'loss_val': 0.2563989182578723, 'psi': 0.8194565469906352}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=31 head_norm_before_train=1.693817 cos_to_last_merge=0.7648 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.765
[S4] round=31 local utility u=0.048368 metrics={'f1_val': 0.9463043104680902, 'auprc': 0.9344082634114161, 'loss_val': 0.3038344642433856, 'psi': 0.9415458916454206}-{'f1_val': 0.9416028128744927, 'auprc': 0.9160147369541308, 'loss_val': 0.31718180851459715, 'psi': 0.9313675825063479}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=31 head_norm_before_train=1.330360 cos_to_last_merge=0.9700 (last merge round=19)
[S5] round=31 local utility u=0.497323 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9888944479785037, 'loss_val': 0.298700937660703, 'psi': 0.8157505696517497}-{'f1_val': 0.6290026128144349, 'auprc': 0.8445096527424689, 'loss_val': 0.43228000393761257, 'psi': 0.7152054287856485}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] START round=31 head_norm_before_train=1.493034 cos_to_last_merge=0.7854 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.785
[S6] round=31 local utility u=1.000000 metrics={'f1_val': 0.8268622167982442, 'auprc': 0.95799375872913, 'loss_val': 0.3323773160849623, 'psi': 0.8793148335705985}-{'f1_val': 0.6142127650160614, 'auprc': 0.8041381602560899, 'loss_val': 0.7806416738364125, 'psi': 0.6901829231120727}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] START round=31 head_norm_before_train=1.321273 cos_to_last_merge=0.7820 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.782
[S7] round=31 local utility u=0.000000 metrics={'f1_val': 0.5690671676794872, 'auprc': 0.7939589116623526, 'loss_val': 0.7462452631130764, 'psi': 0.6590238652726333}-{'f1_val': 0.6851205222058807, 'auprc': 0.8912550210985702, 'loss_val': 0.34778397678747025, 'psi': 0.7675743217629565}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=31 head_norm_before_train=1.658129 cos_to_last_merge=0.9777 (last merge round=19)
[S8] round=31 local utility u=0.005343 metrics={'f1_val': 0.992543926000205, 'auprc': 0.9956573892109649, 'loss_val': 0.04555421649846825, 'psi': 0.993789311284509}-{'f1_val': 0.9896558900940475, 'auprc': 0.9988996324273414, 'loss_val': 0.04863910751667379, 'psi': 0.9933533870273651}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=31 head_norm_before_train=1.699077 cos_to_last_merge=0.8401 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.840
[S9] round=31 local utility u=0.007956 metrics={'f1_val': 0.9900177553403688, 'auprc': 0.9983024082593333, 'loss_val': 0.05103000117827176, 'psi': 0.9933316165079547}-{'f1_val': 0.9886727075027679, 'auprc': 0.9983959559941392, 'loss_val': 0.05915243080035835, 'psi': 0.9925620068993164}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] sending update (kind=head size=1804 to 1 peers)
[S10] START round=31 head_norm_before_train=1.676919 cos_to_last_merge=0.9761 (last merge round=19)
[S10] round=31 local utility u=0.009292 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9956688966600381, 'loss_val': 0.057713314273091905, 'psi': 0.9949850227430519}-{'f1_val': 0.9943563983784213, 'auprc': 0.9921294010219129, 'loss_val': 0.06464216475167435, 'psi': 0.9934655994358179}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=31 head_norm_before_train=1.498152 cos_to_last_merge=0.9640 (last merge round=19)
[S11] round=31 local utility u=0.008559 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9979161659869211, 'loss_val': 0.08089692537452252, 'psi': 0.9970946691029222}-{'f1_val': 0.9966169742661891, 'auprc': 0.99780514074544, 'loss_val': 0.09810087147021192, 'psi': 0.9970922408578895}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=31 head_norm_before_train=1.699719 cos_to_last_merge=0.9925 (last merge round=20)
[S13] round=31 local utility u=0.000000 metrics={'f1_val': 0.5351825705156548, 'auprc': 0.6995869157854158, 'loss_val': 0.9063028672023715, 'psi': 0.6009443086235592}-{'f1_val': 0.573416696203426, 'auprc': 0.6810705176462789, 'loss_val': 0.7042127542489065, 'psi': 0.6164782247805671}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=31 head_norm_before_train=1.704791 cos_to_last_merge=0.9815 (last merge round=17)
[S14] round=31 local utility u=0.000179 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9971281157808058, 'loss_val': 0.03811994861958034, 'psi': 0.9974419171422345}-{'f1_val': 0.9976511180498535, 'auprc': 0.9971537352068839, 'loss_val': 0.0385554047977335, 'psi': 0.9974521649126658}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S14] sending update (kind=head size=1806 to 1 peers)
[S15] START round=31 head_norm_before_train=1.749709 cos_to_last_merge=0.9816 (last merge round=19)
[S15] round=31 local utility u=0.914342 metrics={'f1_val': 0.9407108463605355, 'auprc': 0.997296905324436, 'loss_val': 0.2270006254170934, 'psi': 0.9633452699460958}-{'f1_val': 0.6921751044579605, 'auprc': 0.9878202133975168, 'loss_val': 0.5360397720834389, 'psi': 0.810433148033783}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=31 head_norm_before_train=1.913283 (no previous merge yet)
[S16] round=31 local utility u=0.860130 metrics={'f1_val': 0.930544492249674, 'auprc': 0.9926802391201262, 'loss_val': 0.15038319681565626, 'psi': 0.9553987909978549}-{'f1_val': 0.8267719464041778, 'auprc': 0.917797386916703, 'loss_val': 1.0233601638574825, 'psi': 0.8631821226091879}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=31 head_norm_before_train=1.925334 (no previous merge yet)
[S17] round=31 local utility u=0.053696 metrics={'f1_val': 0.5704483291867957, 'auprc': 0.9748476370955932, 'loss_val': 0.8336483574661758, 'psi': 0.7322080523503147}-{'f1_val': 0.5612393006537002, 'auprc': 0.9501424086704081, 'loss_val': 0.8116711215711198, 'psi': 0.7168005438603834}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=32 head_norm_before_train=1.510274 cos_to_last_merge=0.9909 (last merge round=19)
[S2] round=32 local utility u=0.008683 metrics={'f1_val': 0.7180374186534405, 'auprc': 0.7958154568931401, 'loss_val': 0.5328069929450121, 'psi': 0.7491486339493204}-{'f1_val': 0.7013732463601503, 'auprc': 0.7754481767159462, 'loss_val': 0.38908656278531223, 'psi': 0.7310032185024686}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=32 head_norm_before_train=1.257984 cos_to_last_merge=0.9621 (last merge round=19)
[S3] round=32 local utility u=0.013627 metrics={'f1_val': 0.7006060025002057, 'auprc': 0.9974925444867694, 'loss_val': 0.21414208975964563, 'psi': 0.8193606192948311}-{'f1_val': 0.7006060025002057, 'auprc': 0.9971176790607905, 'loss_val': 0.24027177490474716, 'psi': 0.8192106731244395}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=32 head_norm_before_train=1.704693 cos_to_last_merge=0.7639 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.764
[S4] round=32 local utility u=0.000000 metrics={'f1_val': 0.9444759285838839, 'auprc': 0.921715417860231, 'loss_val': 0.3133660948925969, 'psi': 0.9353717242944227}-{'f1_val': 0.9463043104680902, 'auprc': 0.9344082634114161, 'loss_val': 0.3038344642433856, 'psi': 0.9415458916454206}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=32 head_norm_before_train=1.340946 cos_to_last_merge=0.9685 (last merge round=19)
[S5] round=32 local utility u=0.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9738632272616314, 'loss_val': 0.3058377005183593, 'psi': 0.809737649999468}-{'f1_val': 0.7003213174339138, 'auprc': 0.9888944479785037, 'loss_val': 0.298700937660703, 'psi': 0.8157505696517497}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=32 head_norm_before_train=1.501855 cos_to_last_merge=0.7847 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.785
[S6] round=32 local utility u=0.061217 metrics={'f1_val': 0.8400087733280491, 'auprc': 0.9638882946248116, 'loss_val': 0.30650659537344555, 'psi': 0.8895605818467541}-{'f1_val': 0.8268622167982442, 'auprc': 0.95799375872913, 'loss_val': 0.3323773160849623, 'psi': 0.8793148335705985}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=32 head_norm_before_train=1.324645 cos_to_last_merge=0.7805 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.780
[S7] round=32 local utility u=0.000000 metrics={'f1_val': 0.5576788620892281, 'auprc': 0.7881927285680173, 'loss_val': 0.7911696141891672, 'psi': 0.6498844086807438}-{'f1_val': 0.5690671676794872, 'auprc': 0.7939589116623526, 'loss_val': 0.7462452631130764, 'psi': 0.6590238652726333}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=32 head_norm_before_train=1.672037 cos_to_last_merge=0.9763 (last merge round=19)
[S8] round=32 local utility u=0.007948 metrics={'f1_val': 0.9929361822751569, 'auprc': 0.9986879093229815, 'loss_val': 0.04110351804989141, 'psi': 0.9952368730942867}-{'f1_val': 0.992543926000205, 'auprc': 0.9956573892109649, 'loss_val': 0.04555421649846825, 'psi': 0.993789311284509}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=32 head_norm_before_train=1.717794 cos_to_last_merge=0.8391 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.839
[S9] round=32 local utility u=0.028683 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9982604711600087, 'loss_val': 0.03604989703488091, 'psi': 0.9975659359712892}-{'f1_val': 0.9900177553403688, 'auprc': 0.9983024082593333, 'loss_val': 0.05103000117827176, 'psi': 0.9933316165079547}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] sending update (kind=head size=1803 to 1 peers)
[S10] START round=32 head_norm_before_train=1.694255 cos_to_last_merge=0.9745 (last merge round=19)
[S10] round=32 local utility u=0.001778 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9937446802530021, 'loss_val': 0.052337195672060466, 'psi': 0.9946105755128256}-{'f1_val': 0.9945291067983943, 'auprc': 0.9956688966600381, 'loss_val': 0.057713314273091905, 'psi': 0.9949850227430519}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=32 head_norm_before_train=1.519550 cos_to_last_merge=0.9603 (last merge round=19)
[S11] round=32 local utility u=0.002339 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9977740637865555, 'loss_val': 0.07579172772817677, 'psi': 0.997037828222776}-{'f1_val': 0.9965470045135896, 'auprc': 0.9979161659869211, 'loss_val': 0.08089692537452252, 'psi': 0.9970946691029222}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] sending update (kind=head size=1804 to 1 peers)
[S13] START round=32 head_norm_before_train=1.710614 cos_to_last_merge=0.9917 (last merge round=20)
[S13] round=32 local utility u=0.000000 metrics={'f1_val': 0.5150881545520358, 'auprc': 0.6935598900760279, 'loss_val': 0.8873208593877278, 'psi': 0.5864768487616328}-{'f1_val': 0.5351825705156548, 'auprc': 0.6995869157854158, 'loss_val': 0.9063028672023715, 'psi': 0.6009443086235592}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=32 head_norm_before_train=1.718149 cos_to_last_merge=0.9805 (last merge round=17)
[S14] round=32 local utility u=0.003656 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9986119182015906, 'loss_val': 0.03525883429203948, 'psi': 0.9980354381105484}-{'f1_val': 0.9976511180498535, 'auprc': 0.9971281157808058, 'loss_val': 0.03811994861958034, 'psi': 0.9974419171422345}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] sending update (kind=head size=1804 to 1 peers)
[S15] START round=32 head_norm_before_train=1.774079 cos_to_last_merge=0.9798 (last merge round=19)
[S15] round=32 local utility u=0.000000 metrics={'f1_val': 0.8328247260159694, 'auprc': 0.9950430101477843, 'loss_val': 0.18614099062408046, 'psi': 0.8977120396686953}-{'f1_val': 0.9407108463605355, 'auprc': 0.997296905324436, 'loss_val': 0.2270006254170934, 'psi': 0.9633452699460958}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=32 head_norm_before_train=1.923607 (no previous merge yet)
[S16] round=32 local utility u=0.246951 metrics={'f1_val': 0.9931045696335692, 'auprc': 0.9952643716217462, 'loss_val': 0.039593840117292486, 'psi': 0.9939684904288401}-{'f1_val': 0.930544492249674, 'auprc': 0.9926802391201262, 'loss_val': 0.15038319681565626, 'psi': 0.9553987909978549}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=32 head_norm_before_train=1.942869 (no previous merge yet)
[S17] round=32 local utility u=0.000000 metrics={'f1_val': 0.5711739083956403, 'auprc': 0.970796806888155, 'loss_val': 0.8783913504453623, 'psi': 0.7310230677926461}-{'f1_val': 0.5704483291867957, 'auprc': 0.9748476370955932, 'loss_val': 0.8336483574661758, 'psi': 0.7322080523503147}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=33 head_norm_before_train=1.520257 cos_to_last_merge=0.9900 (last merge round=19)
[S2] round=33 local utility u=0.000000 metrics={'f1_val': 0.7040816410756787, 'auprc': 0.7261228569664169, 'loss_val': 0.34997392435077257, 'psi': 0.7128981274319739}-{'f1_val': 0.7180374186534405, 'auprc': 0.7958154568931401, 'loss_val': 0.5328069929450121, 'psi': 0.7491486339493204}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=33 head_norm_before_train=1.272425 cos_to_last_merge=0.9604 (last merge round=19)
[S3] round=33 local utility u=0.006433 metrics={'f1_val': 0.7003512381127298, 'auprc': 0.9974159316024953, 'loss_val': 0.19951806109182696, 'psi': 0.819177115508636}-{'f1_val': 0.7006060025002057, 'auprc': 0.9974925444867694, 'loss_val': 0.21414208975964563, 'psi': 0.8193606192948311}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] sending update (kind=head size=1803 to 1 peers)
[S4] START round=33 head_norm_before_train=1.716813 cos_to_last_merge=0.7628 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.763
[S4] round=33 local utility u=0.066931 metrics={'f1_val': 0.9524210579951937, 'auprc': 0.9464950836611226, 'loss_val': 0.3015140489284061, 'psi': 0.9500506682615653}-{'f1_val': 0.9444759285838839, 'auprc': 0.921715417860231, 'loss_val': 0.3133660948925969, 'psi': 0.9353717242944227}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=33 head_norm_before_train=1.349920 cos_to_last_merge=0.9672 (last merge round=19)
[S5] round=33 local utility u=0.000000 metrics={'f1_val': 0.512001169884111, 'auprc': 0.8374744979535073, 'loss_val': 0.7299537245809797, 'psi': 0.6421905011118696}-{'f1_val': 0.700320598491359, 'auprc': 0.9738632272616314, 'loss_val': 0.3058377005183593, 'psi': 0.809737649999468}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=33 head_norm_before_train=1.512844 cos_to_last_merge=0.7837 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.784
[S6] round=33 local utility u=0.000000 metrics={'f1_val': 0.7424302955000455, 'auprc': 0.9446419223077749, 'loss_val': 0.5927688724781872, 'psi': 0.8233149462231373}-{'f1_val': 0.8400087733280491, 'auprc': 0.9638882946248116, 'loss_val': 0.30650659537344555, 'psi': 0.8895605818467541}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=33 head_norm_before_train=1.327660 cos_to_last_merge=0.7792 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.779
[S7] round=33 local utility u=0.046859 metrics={'f1_val': 0.5680610460161951, 'auprc': 0.7886605678259833, 'loss_val': 0.7611487392561834, 'psi': 0.6563008547401104}-{'f1_val': 0.5576788620892281, 'auprc': 0.7881927285680173, 'loss_val': 0.7911696141891672, 'psi': 0.6498844086807438}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] sending update (kind=head size=1797 to 1 peers)
[S8] START round=33 head_norm_before_train=1.684495 cos_to_last_merge=0.9751 (last merge round=19)
[S8] round=33 local utility u=0.000000 metrics={'f1_val': 0.9558791495783561, 'auprc': 0.9857835436905397, 'loss_val': 0.10068722792203616, 'psi': 0.9678409072232295}-{'f1_val': 0.9929361822751569, 'auprc': 0.9986879093229815, 'loss_val': 0.04110351804989141, 'psi': 0.9952368730942867}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=33 head_norm_before_train=1.736066 cos_to_last_merge=0.8379 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.838
[S9] round=33 local utility u=0.000000 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9982831857512362, 'loss_val': 0.034200900274876475, 'psi': 0.9970758917387381}-{'f1_val': 0.9971029125121428, 'auprc': 0.9982604711600087, 'loss_val': 0.03604989703488091, 'psi': 0.9975659359712892}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=33 head_norm_before_train=1.713205 cos_to_last_merge=0.9729 (last merge round=19)
[S10] round=33 local utility u=0.001156 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9934660203148546, 'loss_val': 0.049189562777273495, 'psi': 0.9944991115375668}-{'f1_val': 0.9951878390193748, 'auprc': 0.9937446802530021, 'loss_val': 0.052337195672060466, 'psi': 0.9946105755128256}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=33 head_norm_before_train=1.538186 cos_to_last_merge=0.9572 (last merge round=19)
[S11] round=33 local utility u=0.000224 metrics={'f1_val': 0.9966169742661891, 'auprc': 0.9972326813950634, 'loss_val': 0.07413921493187779, 'psi': 0.9968632571177387}-{'f1_val': 0.9965470045135896, 'auprc': 0.9977740637865555, 'loss_val': 0.07579172772817677, 'psi': 0.997037828222776}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] sending update (kind=head size=1804 to 1 peers)
[S13] START round=33 head_norm_before_train=1.721199 cos_to_last_merge=0.9908 (last merge round=20)
[S13] round=33 local utility u=0.292567 metrics={'f1_val': 0.5885957845319361, 'auprc': 0.6904220118989084, 'loss_val': 0.7338199910415969, 'psi': 0.629326275478725}-{'f1_val': 0.5150881545520358, 'auprc': 0.6935598900760279, 'loss_val': 0.8873208593877278, 'psi': 0.5864768487616328}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] sending update (kind=head size=1806 to 1 peers)
[S14] START round=33 head_norm_before_train=1.730803 cos_to_last_merge=0.9793 (last merge round=17)
[S14] round=33 local utility u=0.000000 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.996873329263932, 'loss_val': 0.03768238450830602, 'psi': 0.9971942934066081}-{'f1_val': 0.9976511180498535, 'auprc': 0.9986119182015906, 'loss_val': 0.03525883429203948, 'psi': 0.9980354381105484}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=33 head_norm_before_train=1.794351 cos_to_last_merge=0.9783 (last merge round=19)
[S15] round=33 local utility u=0.000000 metrics={'f1_val': 0.7604117147178199, 'auprc': 0.990172745863726, 'loss_val': 0.3979316452219543, 'psi': 0.8523161271761823}-{'f1_val': 0.8328247260159694, 'auprc': 0.9950430101477843, 'loss_val': 0.18614099062408046, 'psi': 0.8977120396686953}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=33 head_norm_before_train=1.933460 (no previous merge yet)
[S16] round=33 local utility u=0.000000 metrics={'f1_val': 0.8662297010143567, 'auprc': 0.9769872496138985, 'loss_val': 0.7006588789893664, 'psi': 0.9105327204541733}-{'f1_val': 0.9931045696335692, 'auprc': 0.9952643716217462, 'loss_val': 0.039593840117292486, 'psi': 0.9939684904288401}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=33 head_norm_before_train=1.957425 (no previous merge yet)
[S17] round=33 local utility u=0.000000 metrics={'f1_val': 0.491452318576064, 'auprc': 0.8324422911784605, 'loss_val': 1.1153878308677296, 'psi': 0.6278483076170226}-{'f1_val': 0.5711739083956403, 'auprc': 0.970796806888155, 'loss_val': 0.8783913504453623, 'psi': 0.7310230677926461}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=34 head_norm_before_train=1.530243 cos_to_last_merge=0.9892 (last merge round=19)
[S2] round=34 local utility u=0.000000 metrics={'f1_val': 0.6809246508531559, 'auprc': 0.6527326754793011, 'loss_val': 0.4993808292841807, 'psi': 0.669647860703614}-{'f1_val': 0.7040816410756787, 'auprc': 0.7261228569664169, 'loss_val': 0.34997392435077257, 'psi': 0.7128981274319739}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=34 head_norm_before_train=1.287659 cos_to_last_merge=0.9585 (last merge round=19)
[S3] round=34 local utility u=0.001873 metrics={'f1_val': 0.7006060025002057, 'auprc': 0.9970749633473044, 'loss_val': 0.19627736322569056, 'psi': 0.8191935868390452}-{'f1_val': 0.7003512381127298, 'auprc': 0.9974159316024953, 'loss_val': 0.19951806109182696, 'psi': 0.819177115508636}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=34 head_norm_before_train=1.727433 cos_to_last_merge=0.7619 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.762
[S4] round=34 local utility u=0.000000 metrics={'f1_val': 0.9499554785700568, 'auprc': 0.942608611851623, 'loss_val': 0.3051056447475016, 'psi': 0.9470167318826833}-{'f1_val': 0.9524210579951937, 'auprc': 0.9464950836611226, 'loss_val': 0.3015140489284061, 'psi': 0.9500506682615653}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=34 head_norm_before_train=1.359167 cos_to_last_merge=0.9661 (last merge round=19)
[S5] round=34 local utility u=1.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9887414070402519, 'loss_val': 0.2843387514079367, 'psi': 0.8156889219109162}-{'f1_val': 0.512001169884111, 'auprc': 0.8374744979535073, 'loss_val': 0.7299537245809797, 'psi': 0.6421905011118696}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=34 head_norm_before_train=1.524190 cos_to_last_merge=0.7825 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.782
[S6] round=34 local utility u=0.471795 metrics={'f1_val': 0.847158682490315, 'auprc': 0.957227325835553, 'loss_val': 0.31530533496364277, 'psi': 0.8911861398284102}-{'f1_val': 0.7424302955000455, 'auprc': 0.9446419223077749, 'loss_val': 0.5927688724781872, 'psi': 0.8233149462231373}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=34 head_norm_before_train=1.330330 cos_to_last_merge=0.7785 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.779
[S7] round=34 local utility u=0.000000 metrics={'f1_val': 0.5057434662304583, 'auprc': 0.782169576417834, 'loss_val': 0.9053780703673249, 'psi': 0.6163139103054086}-{'f1_val': 0.5680610460161951, 'auprc': 0.7886605678259833, 'loss_val': 0.7611487392561834, 'psi': 0.6563008547401104}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=34 head_norm_before_train=1.697232 cos_to_last_merge=0.9739 (last merge round=19)
[S8] round=34 local utility u=0.120033 metrics={'f1_val': 0.9838460548583284, 'auprc': 0.9955769304206876, 'loss_val': 0.057803402410987, 'psi': 0.9885384050832721}-{'f1_val': 0.9558791495783561, 'auprc': 0.9857835436905397, 'loss_val': 0.10068722792203616, 'psi': 0.9678409072232295}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] sending update (kind=head size=1803 to 1 peers)
[S9] START round=34 head_norm_before_train=1.753281 cos_to_last_merge=0.8367 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.837
[S9] round=34 local utility u=0.004389 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9982740022545868, 'loss_val': 0.030386454503719816, 'psi': 0.9975713484091204}-{'f1_val': 0.9962710290637395, 'auprc': 0.9982831857512362, 'loss_val': 0.034200900274876475, 'psi': 0.9970758917387381}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S9] sending update (kind=head size=1806 to 1 peers)
[S10] START round=34 head_norm_before_train=1.732677 cos_to_last_merge=0.9712 (last merge round=19)
[S10] round=34 local utility u=0.000992 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9930428553484197, 'loss_val': 0.0459365533936522, 'psi': 0.9943298455509928}-{'f1_val': 0.9951878390193748, 'auprc': 0.9934660203148546, 'loss_val': 0.049189562777273495, 'psi': 0.9944991115375668}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=34 head_norm_before_train=1.554604 cos_to_last_merge=0.9545 (last merge round=19)
[S11] round=34 local utility u=0.007546 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9979230642340262, 'loss_val': 0.06069763209834422, 'psi': 0.9970974284017642}-{'f1_val': 0.9966169742661891, 'auprc': 0.9972326813950634, 'loss_val': 0.07413921493187779, 'psi': 0.9968632571177387}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=34 head_norm_before_train=1.732430 cos_to_last_merge=0.9900 (last merge round=20)
[S13] round=34 local utility u=0.000000 metrics={'f1_val': 0.5685163919470628, 'auprc': 0.6968969087570991, 'loss_val': 0.8747988350161755, 'psi': 0.6198685986710772}-{'f1_val': 0.5885957845319361, 'auprc': 0.6904220118989084, 'loss_val': 0.7338199910415969, 'psi': 0.629326275478725}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=34 head_norm_before_train=1.743363 cos_to_last_merge=0.9782 (last merge round=17)
[S14] round=34 local utility u=0.000000 metrics={'f1_val': 0.9969910436891155, 'auprc': 0.9971296102822192, 'loss_val': 0.04369298374602819, 'psi': 0.9970464703263571}-{'f1_val': 0.9974082695017256, 'auprc': 0.996873329263932, 'loss_val': 0.03768238450830602, 'psi': 0.9971942934066081}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=34 head_norm_before_train=1.813443 cos_to_last_merge=0.9768 (last merge round=19)
[S15] round=34 local utility u=0.447839 metrics={'f1_val': 0.8670044153735645, 'auprc': 0.9940360695292971, 'loss_val': 0.1533995119023662, 'psi': 0.9178170770358576}-{'f1_val': 0.7604117147178199, 'auprc': 0.990172745863726, 'loss_val': 0.3979316452219543, 'psi': 0.8523161271761823}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=34 head_norm_before_train=1.941444 (no previous merge yet)
[S16] round=34 local utility u=0.275970 metrics={'f1_val': 0.9018125703156535, 'auprc': 0.9972404451205393, 'loss_val': 0.42297583302439234, 'psi': 0.9399837202376079}-{'f1_val': 0.8662297010143567, 'auprc': 0.9769872496138985, 'loss_val': 0.7006588789893664, 'psi': 0.9105327204541733}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S17] START round=34 head_norm_before_train=1.969902 (no previous merge yet)
[S17] round=34 local utility u=0.371906 metrics={'f1_val': 0.5870683262252093, 'auprc': 0.8302920309505019, 'loss_val': 0.9388201587623323, 'psi': 0.6843578081153263}-{'f1_val': 0.491452318576064, 'auprc': 0.8324422911784605, 'loss_val': 1.1153878308677296, 'psi': 0.6278483076170226}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] sending update (kind=head size=1795 to 1 peers)
[S2] START round=35 head_norm_before_train=1.539007 cos_to_last_merge=0.9884 (last merge round=19)
[S2] round=35 local utility u=0.243179 metrics={'f1_val': 0.7145518815295673, 'auprc': 0.7868202428558005, 'loss_val': 0.6170486402132155, 'psi': 0.7434592260600605}-{'f1_val': 0.6809246508531559, 'auprc': 0.6527326754793011, 'loss_val': 0.4993808292841807, 'psi': 0.669647860703614}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=35 head_norm_before_train=1.304968 cos_to_last_merge=0.9563 (last merge round=19)
[S3] round=35 local utility u=0.778855 metrics={'f1_val': 0.9523109062378271, 'auprc': 0.997783939580888, 'loss_val': 0.1509227888135658, 'psi': 0.9705001195750514}-{'f1_val': 0.7006060025002057, 'auprc': 0.9970749633473044, 'loss_val': 0.19627736322569056, 'psi': 0.8191935868390452}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=35 head_norm_before_train=1.731471 cos_to_last_merge=0.7619 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.762
[S4] round=35 local utility u=0.018156 metrics={'f1_val': 0.9525722763741205, 'auprc': 0.9485977580557416, 'loss_val': 0.3024615824058325, 'psi': 0.950982469046769}-{'f1_val': 0.9499554785700568, 'auprc': 0.942608611851623, 'loss_val': 0.3051056447475016, 'psi': 0.9470167318826833}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=35 head_norm_before_train=1.368358 cos_to_last_merge=0.9650 (last merge round=19)
[S5] round=35 local utility u=0.000000 metrics={'f1_val': 0.6361750930638539, 'auprc': 0.9147405242286406, 'loss_val': 0.4072896607688549, 'psi': 0.7476012655297686}-{'f1_val': 0.700320598491359, 'auprc': 0.9887414070402519, 'loss_val': 0.2843387514079367, 'psi': 0.8156889219109162}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=35 head_norm_before_train=1.537602 cos_to_last_merge=0.7804 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.780
[S6] round=35 local utility u=0.000000 metrics={'f1_val': 0.44795126584590655, 'auprc': 0.7790011780708858, 'loss_val': 1.1695511585801126, 'psi': 0.5803712307358982}-{'f1_val': 0.847158682490315, 'auprc': 0.957227325835553, 'loss_val': 0.31530533496364277, 'psi': 0.8911861398284102}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=35 head_norm_before_train=1.334158 cos_to_last_merge=0.7781 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.778
[S7] round=35 local utility u=0.574762 metrics={'f1_val': 0.6304930446762916, 'auprc': 0.802115968421461, 'loss_val': 0.5641908900226988, 'psi': 0.6991422141743594}-{'f1_val': 0.5057434662304583, 'auprc': 0.782169576417834, 'loss_val': 0.9053780703673249, 'psi': 0.6163139103054086}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=35 head_norm_before_train=1.704556 cos_to_last_merge=0.9733 (last merge round=19)
[S8] round=35 local utility u=0.041525 metrics={'f1_val': 0.9929361822751569, 'auprc': 0.9989069968730677, 'loss_val': 0.03928416504177044, 'psi': 0.9953245081143212}-{'f1_val': 0.9838460548583284, 'auprc': 0.9955769304206876, 'loss_val': 0.057803402410987, 'psi': 0.9885384050832721}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=35 head_norm_before_train=1.768538 cos_to_last_merge=0.8357 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.836
[S9] round=35 local utility u=0.000000 metrics={'f1_val': 0.9925069029958717, 'auprc': 0.9983895650265383, 'loss_val': 0.03691607790293527, 'psi': 0.9948599678081383}-{'f1_val': 0.9971029125121428, 'auprc': 0.9982740022545868, 'loss_val': 0.030386454503719816, 'psi': 0.9975713484091204}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=35 head_norm_before_train=1.752731 cos_to_last_merge=0.9694 (last merge round=19)
[S10] round=35 local utility u=0.004858 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9952865969534491, 'loss_val': 0.042951513555609874, 'psi': 0.9952273421930045}-{'f1_val': 0.9951878390193748, 'auprc': 0.9930428553484197, 'loss_val': 0.0459365533936522, 'psi': 0.9943298455509928}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=35 head_norm_before_train=1.573235 cos_to_last_merge=0.9514 (last merge round=19)
[S11] round=35 local utility u=0.002021 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9977853180379744, 'loss_val': 0.05624176176442046, 'psi': 0.9970423299233435}-{'f1_val': 0.9965470045135896, 'auprc': 0.9979230642340262, 'loss_val': 0.06069763209834422, 'psi': 0.9970974284017642}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S11] sending update (kind=head size=1807 to 1 peers)
[S13] START round=35 head_norm_before_train=1.741220 cos_to_last_merge=0.9894 (last merge round=20)
[S13] round=35 local utility u=0.093030 metrics={'f1_val': 0.5902675805877986, 'auprc': 0.7071267974835352, 'loss_val': 0.849935803762261, 'psi': 0.6370112673460933}-{'f1_val': 0.5685163919470628, 'auprc': 0.6968969087570991, 'loss_val': 0.8747988350161755, 'psi': 0.6198685986710772}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S13] sending update (kind=head size=1807 to 1 peers)
[S14] START round=35 head_norm_before_train=1.756286 cos_to_last_merge=0.9772 (last merge round=17)
[S14] round=35 local utility u=0.010361 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9989305671539827, 'loss_val': 0.030877980324237598, 'psi': 0.9980171885626284}-{'f1_val': 0.9969910436891155, 'auprc': 0.9971296102822192, 'loss_val': 0.04369298374602819, 'psi': 0.9970464703263571}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=35 head_norm_before_train=1.830122 cos_to_last_merge=0.9756 (last merge round=19)
[S15] round=35 local utility u=0.000000 metrics={'f1_val': 0.7034021618584282, 'auprc': 0.9914574534332002, 'loss_val': 0.5155761404289054, 'psi': 0.8186242784883371}-{'f1_val': 0.8670044153735645, 'auprc': 0.9940360695292971, 'loss_val': 0.1533995119023662, 'psi': 0.9178170770358576}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=35 head_norm_before_train=1.951572 (no previous merge yet)
[S16] round=35 local utility u=0.458235 metrics={'f1_val': 0.9913441012428271, 'auprc': 0.9981399566247513, 'loss_val': 0.04639444756057868, 'psi': 0.9940624433955967}-{'f1_val': 0.9018125703156535, 'auprc': 0.9972404451205393, 'loss_val': 0.42297583302439234, 'psi': 0.9399837202376079}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=35 head_norm_before_train=1.982053 (no previous merge yet)
[S17] round=35 local utility u=0.029641 metrics={'f1_val': 0.60739714027177, 'auprc': 0.8305587221122344, 'loss_val': 1.0023119908402531, 'psi': 0.6966617730079558}-{'f1_val': 0.5870683262252093, 'auprc': 0.8302920309505019, 'loss_val': 0.9388201587623323, 'psi': 0.6843578081153263}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] START round=36 head_norm_before_train=1.545728 cos_to_last_merge=0.9878 (last merge round=19)
[S2] round=36 local utility u=0.000000 metrics={'f1_val': 0.7074773778638468, 'auprc': 0.6744480882252051, 'loss_val': 0.39119560638029666, 'psi': 0.69426566200839}-{'f1_val': 0.7145518815295673, 'auprc': 0.7868202428558005, 'loss_val': 0.6170486402132155, 'psi': 0.7434592260600605}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=36 head_norm_before_train=1.322640 cos_to_last_merge=0.9541 (last merge round=19)
[S3] round=36 local utility u=0.037573 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.9978096254853897, 'loss_val': 0.12820049558582372, 'psi': 0.975745000857422}-{'f1_val': 0.9523109062378271, 'auprc': 0.997783939580888, 'loss_val': 0.1509227888135658, 'psi': 0.9705001195750514}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=36 head_norm_before_train=1.734348 cos_to_last_merge=0.7620 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.762
[S4] round=36 local utility u=0.000000 metrics={'f1_val': 0.9454316640829941, 'auprc': 0.932164976861097, 'loss_val': 0.31048413893721505, 'psi': 0.9401249891942353}-{'f1_val': 0.9525722763741205, 'auprc': 0.9485977580557416, 'loss_val': 0.3024615824058325, 'psi': 0.950982469046769}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=36 head_norm_before_train=1.378118 cos_to_last_merge=0.9636 (last merge round=19)
[S5] round=36 local utility u=0.000000 metrics={'f1_val': 0.42473775507254824, 'auprc': 0.8347617713708603, 'loss_val': 1.1721920843480955, 'psi': 0.588747361591873}-{'f1_val': 0.6361750930638539, 'auprc': 0.9147405242286406, 'loss_val': 0.4072896607688549, 'psi': 0.7476012655297686}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=36 head_norm_before_train=1.551004 cos_to_last_merge=0.7791 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.779
[S6] round=36 local utility u=1.000000 metrics={'f1_val': 0.7852666483939795, 'auprc': 0.9424957451928003, 'loss_val': 0.47535254029978635, 'psi': 0.8481582871135078}-{'f1_val': 0.44795126584590655, 'auprc': 0.7790011780708858, 'loss_val': 1.1695511585801126, 'psi': 0.5803712307358982}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=36 head_norm_before_train=1.340569 cos_to_last_merge=0.7775 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.778
[S7] round=36 local utility u=0.134678 metrics={'f1_val': 0.6539821290752396, 'auprc': 0.8172922477025357, 'loss_val': 0.48129832464518546, 'psi': 0.719306176526158}-{'f1_val': 0.6304930446762916, 'auprc': 0.802115968421461, 'loss_val': 0.5641908900226988, 'psi': 0.6991422141743594}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=36 head_norm_before_train=1.712783 cos_to_last_merge=0.9725 (last merge round=19)
[S8] round=36 local utility u=0.000000 metrics={'f1_val': 0.9878177834215355, 'auprc': 0.9860872014419454, 'loss_val': 0.06769112052622984, 'psi': 0.9871255506296994}-{'f1_val': 0.9929361822751569, 'auprc': 0.9989069968730677, 'loss_val': 0.03928416504177044, 'psi': 0.9953245081143212}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=36 head_norm_before_train=1.780241 cos_to_last_merge=0.8350 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.835
[S9] round=36 local utility u=0.000000 metrics={'f1_val': 0.988279001546821, 'auprc': 0.9984369530749195, 'loss_val': 0.04496277220526537, 'psi': 0.9923421821580605}-{'f1_val': 0.9925069029958717, 'auprc': 0.9983895650265383, 'loss_val': 0.03691607790293527, 'psi': 0.9948599678081383}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=36 head_norm_before_train=1.770474 cos_to_last_merge=0.9678 (last merge round=19)
[S10] round=36 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9933824214056394, 'loss_val': 0.04101326404007729, 'psi': 0.9944656719738806}-{'f1_val': 0.9951878390193748, 'auprc': 0.9952865969534491, 'loss_val': 0.042951513555609874, 'psi': 0.9952273421930045}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=36 head_norm_before_train=1.592719 cos_to_last_merge=0.9483 (last merge round=19)
[S11] ⚠️ Model drifted since last merge! cos=0.948
[S11] round=36 local utility u=0.000000 metrics={'f1_val': 0.9963753869090841, 'auprc': 0.9962950817505996, 'loss_val': 0.05963974257611296, 'psi': 0.9963432648456902}-{'f1_val': 0.9965470045135896, 'auprc': 0.9977853180379744, 'loss_val': 0.05624176176442046, 'psi': 0.9970423299233435}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=36 head_norm_before_train=1.750247 cos_to_last_merge=0.9887 (last merge round=20)
[S13] round=36 local utility u=0.000000 metrics={'f1_val': 0.5662301988992268, 'auprc': 0.7160136336583174, 'loss_val': 0.9554542299231104, 'psi': 0.626143572802863}-{'f1_val': 0.5902675805877986, 'auprc': 0.7071267974835352, 'loss_val': 0.849935803762261, 'psi': 0.6370112673460933}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=36 head_norm_before_train=1.771237 cos_to_last_merge=0.9760 (last merge round=17)
[S14] round=36 local utility u=0.002301 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9991257391598183, 'loss_val': 0.02831930385938023, 'psi': 0.9982409664938394}-{'f1_val': 0.9974082695017256, 'auprc': 0.9989305671539827, 'loss_val': 0.030877980324237598, 'psi': 0.9980171885626284}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[S15] START round=36 head_norm_before_train=1.847607 cos_to_last_merge=0.9744 (last merge round=19)
[S15] round=36 local utility u=1.000000 metrics={'f1_val': 0.9818924797827787, 'auprc': 0.9968041407412473, 'loss_val': 0.056918826239306365, 'psi': 0.9878571441661661}-{'f1_val': 0.7034021618584282, 'auprc': 0.9914574534332002, 'loss_val': 0.5155761404289054, 'psi': 0.8186242784883371}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] sending update (kind=head size=1803 to 1 peers)
[S16] START round=36 head_norm_before_train=1.960660 (no previous merge yet)
[S16] round=36 local utility u=0.000000 metrics={'f1_val': 0.9168128851424655, 'auprc': 0.9831515826156529, 'loss_val': 0.42418199232249637, 'psi': 0.9433483641317404}-{'f1_val': 0.9913441012428271, 'auprc': 0.9981399566247513, 'loss_val': 0.04639444756057868, 'psi': 0.9940624433955967}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=36 head_norm_before_train=1.992750 (no previous merge yet)
[S17] round=36 local utility u=0.050497 metrics={'f1_val': 0.5976133335931502, 'auprc': 0.8760888838968907, 'loss_val': 0.9792053097857079, 'psi': 0.7090035537146464}-{'f1_val': 0.60739714027177, 'auprc': 0.8305587221122344, 'loss_val': 1.0023119908402531, 'psi': 0.6966617730079558}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] START round=37 head_norm_before_train=1.553604 cos_to_last_merge=0.9870 (last merge round=19)
[S2] round=37 local utility u=0.078522 metrics={'f1_val': 0.7137188971994394, 'auprc': 0.7858353433074795, 'loss_val': 0.6057628618746284, 'psi': 0.7425654756426554}-{'f1_val': 0.7074773778638468, 'auprc': 0.6744480882252051, 'loss_val': 0.39119560638029666, 'psi': 0.69426566200839}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=37 head_norm_before_train=1.339837 cos_to_last_merge=0.9520 (last merge round=19)
[S3] round=37 local utility u=0.089879 metrics={'f1_val': 0.9859851590918147, 'auprc': 0.99817652830043, 'loss_val': 0.0992425612601704, 'psi': 0.9908617067752609}-{'f1_val': 0.9610352511054436, 'auprc': 0.9978096254853897, 'loss_val': 0.12820049558582372, 'psi': 0.975745000857422}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S3] sending update (kind=head size=1792 to 1 peers)
[S4] START round=37 head_norm_before_train=1.740058 cos_to_last_merge=0.7613 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.761
[S4] round=37 local utility u=0.016124 metrics={'f1_val': 0.9471890297787845, 'auprc': 0.9386993347197874, 'loss_val': 0.30838347550879064, 'psi': 0.9437931517551856}-{'f1_val': 0.9454316640829941, 'auprc': 0.932164976861097, 'loss_val': 0.31048413893721505, 'psi': 0.9401249891942353}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=37 head_norm_before_train=1.388808 cos_to_last_merge=0.9623 (last merge round=19)
[S5] round=37 local utility u=1.000000 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9952821009425752, 'loss_val': 0.2754726912642637, 'psi': 0.8183056308373784}-{'f1_val': 0.42473775507254824, 'auprc': 0.8347617713708603, 'loss_val': 1.1721920843480955, 'psi': 0.588747361591873}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=37 head_norm_before_train=1.558820 cos_to_last_merge=0.7786 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.779
[S6] round=37 local utility u=0.838508 metrics={'f1_val': 0.986467296264691, 'auprc': 0.9720306536982017, 'loss_val': 0.09414569377051409, 'psi': 0.9806926392380952}-{'f1_val': 0.7852666483939795, 'auprc': 0.9424957451928003, 'loss_val': 0.47535254029978635, 'psi': 0.8481582871135078}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] sending update (kind=head size=1805 to 1 peers)
[S7] START round=37 head_norm_before_train=1.347044 cos_to_last_merge=0.7767 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.777
[S7] round=37 local utility u=0.000000 metrics={'f1_val': 0.48458267936521837, 'auprc': 0.7817119581907908, 'loss_val': 0.8485760155405251, 'psi': 0.6034343908954474}-{'f1_val': 0.6539821290752396, 'auprc': 0.8172922477025357, 'loss_val': 0.48129832464518546, 'psi': 0.719306176526158}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=37 head_norm_before_train=1.721956 cos_to_last_merge=0.9718 (last merge round=19)
[S8] round=37 local utility u=0.045602 metrics={'f1_val': 0.992032490903249, 'auprc': 0.9989573944958166, 'loss_val': 0.0403859414316003, 'psi': 0.994802452340276}-{'f1_val': 0.9878177834215355, 'auprc': 0.9860872014419454, 'loss_val': 0.06769112052622984, 'psi': 0.9871255506296994}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=37 head_norm_before_train=1.793072 cos_to_last_merge=0.8341 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.834
[S9] round=37 local utility u=0.034498 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9984994310799584, 'loss_val': 0.02644369805652922, 'psi': 0.9973960795203183}-{'f1_val': 0.988279001546821, 'auprc': 0.9984369530749195, 'loss_val': 0.04496277220526537, 'psi': 0.9923421821580605}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] sending update (kind=head size=1804 to 1 peers)
[S10] START round=37 head_norm_before_train=1.788414 cos_to_last_merge=0.9662 (last merge round=19)
[S10] round=37 local utility u=0.003461 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9950209824355525, 'loss_val': 0.0390065506204057, 'psi': 0.9951210963858459}-{'f1_val': 0.9951878390193748, 'auprc': 0.9933824214056394, 'loss_val': 0.04101326404007729, 'psi': 0.9944656719738806}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=37 head_norm_before_train=1.611670 cos_to_last_merge=0.9452 (last merge round=19)
[S11] ⚠️ Model drifted since last merge! cos=0.945
[S11] round=37 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9963124193851467, 'loss_val': 0.06948879626718842, 'psi': 0.9962051727020442}-{'f1_val': 0.9963753869090841, 'auprc': 0.9962950817505996, 'loss_val': 0.05963974257611296, 'psi': 0.9963432648456902}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=37 head_norm_before_train=1.759465 cos_to_last_merge=0.9880 (last merge round=20)
[S13] round=37 local utility u=0.049434 metrics={'f1_val': 0.5873479107497909, 'auprc': 0.7203953461714004, 'loss_val': 0.996437749726568, 'psi': 0.6405668849184347}-{'f1_val': 0.5662301988992268, 'auprc': 0.7160136336583174, 'loss_val': 0.9554542299231104, 'psi': 0.626143572802863}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=37 head_norm_before_train=1.786526 cos_to_last_merge=0.9751 (last merge round=17)
[S14] round=37 local utility u=0.000000 metrics={'f1_val': 0.9596662228743902, 'auprc': 0.9990310407511969, 'loss_val': 0.05680030474174301, 'psi': 0.975412150025113}-{'f1_val': 0.9976511180498535, 'auprc': 0.9991257391598183, 'loss_val': 0.02831930385938023, 'psi': 0.9982409664938394}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=37 head_norm_before_train=1.865474 cos_to_last_merge=0.9731 (last merge round=19)
[S15] round=37 local utility u=0.000000 metrics={'f1_val': 0.8479156617274388, 'auprc': 0.9957408150246791, 'loss_val': 0.19391565288220242, 'psi': 0.9070457230463349}-{'f1_val': 0.9818924797827787, 'auprc': 0.9968041407412473, 'loss_val': 0.056918826239306365, 'psi': 0.9878571441661661}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=37 head_norm_before_train=1.963675 (no previous merge yet)
[S16] round=37 local utility u=0.000000 metrics={'f1_val': 0.9144739781619649, 'auprc': 0.9708127668495448, 'loss_val': 0.44172845209729594, 'psi': 0.9370094936369968}-{'f1_val': 0.9168128851424655, 'auprc': 0.9831515826156529, 'loss_val': 0.42418199232249637, 'psi': 0.9433483641317404}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=37 head_norm_before_train=2.004134 (no previous merge yet)
[S17] round=37 local utility u=0.003186 metrics={'f1_val': 0.6000043561470401, 'auprc': 0.8748175441166706, 'loss_val': 0.9833662033691054, 'psi': 0.7099296313348922}-{'f1_val': 0.5976133335931502, 'auprc': 0.8760888838968907, 'loss_val': 0.9792053097857079, 'psi': 0.7090035537146464}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=38 head_norm_before_train=1.562027 cos_to_last_merge=0.9863 (last merge round=19)
[S2] round=38 local utility u=0.028307 metrics={'f1_val': 0.712151241771348, 'auprc': 0.7751068825304148, 'loss_val': 0.5075572563632323, 'psi': 0.7373334980749747}-{'f1_val': 0.7137188971994394, 'auprc': 0.7858353433074795, 'loss_val': 0.6057628618746284, 'psi': 0.7425654756426554}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S2] sending update (kind=head size=1808 to 1 peers)
[S3] START round=38 head_norm_before_train=1.358291 cos_to_last_merge=0.9499 (last merge round=19)
[S3] ⚠️ Model drifted since last merge! cos=0.950
[S3] round=38 local utility u=0.000000 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.998155672259455, 'loss_val': 0.10500442201619992, 'psi': 0.9758834195670482}-{'f1_val': 0.9859851590918147, 'auprc': 0.99817652830043, 'loss_val': 0.0992425612601704, 'psi': 0.9908617067752609}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=38 head_norm_before_train=1.750664 cos_to_last_merge=0.7599 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.760
[S4] round=38 local utility u=0.050643 metrics={'f1_val': 0.9484640156656763, 'auprc': 0.9675948071637192, 'loss_val': 0.3014330803188786, 'psi': 0.9561163322648935}-{'f1_val': 0.9471890297787845, 'auprc': 0.9386993347197874, 'loss_val': 0.30838347550879064, 'psi': 0.9437931517551856}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=38 head_norm_before_train=1.395943 cos_to_last_merge=0.9617 (last merge round=19)
[S5] round=38 local utility u=0.000000 metrics={'f1_val': 0.4171435078150064, 'auprc': 0.7577719931535026, 'loss_val': 1.6069887494668342, 'psi': 0.553394901950405}-{'f1_val': 0.7003213174339138, 'auprc': 0.9952821009425752, 'loss_val': 0.2754726912642637, 'psi': 0.8183056308373784}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=38 head_norm_before_train=1.566576 cos_to_last_merge=0.7777 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.778
[S6] round=38 local utility u=0.000000 metrics={'f1_val': 0.5985461505532452, 'auprc': 0.7740688061918533, 'loss_val': 1.0258213719001035, 'psi': 0.6687552128086884}-{'f1_val': 0.986467296264691, 'auprc': 0.9720306536982017, 'loss_val': 0.09414569377051409, 'psi': 0.9806926392380952}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=38 head_norm_before_train=1.355044 cos_to_last_merge=0.7756 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.776
[S7] round=38 local utility u=0.987043 metrics={'f1_val': 0.6853355778823105, 'auprc': 0.865749326424359, 'loss_val': 0.3311202019991148, 'psi': 0.75750107729913}-{'f1_val': 0.48458267936521837, 'auprc': 0.7817119581907908, 'loss_val': 0.8485760155405251, 'psi': 0.6034343908954474}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=38 head_norm_before_train=1.730646 cos_to_last_merge=0.9711 (last merge round=19)
[S8] round=38 local utility u=0.000000 metrics={'f1_val': 0.9732433751924605, 'auprc': 0.9954856117594574, 'loss_val': 0.07109417990109078, 'psi': 0.9821402698192593}-{'f1_val': 0.992032490903249, 'auprc': 0.9989573944958166, 'loss_val': 0.0403859414316003, 'psi': 0.994802452340276}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=38 head_norm_before_train=1.803883 cos_to_last_merge=0.8334 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.833
[S9] round=38 local utility u=0.000846 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9986088432286946, 'loss_val': 0.0250801078584138, 'psi': 0.9974398443798127}-{'f1_val': 0.9966605118138915, 'auprc': 0.9984994310799584, 'loss_val': 0.02644369805652922, 'psi': 0.9973960795203183}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S9] sending update (kind=head size=1805 to 1 peers)
[S10] START round=38 head_norm_before_train=1.805866 cos_to_last_merge=0.9646 (last merge round=19)
[S10] round=38 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9940588119359961, 'loss_val': 0.03775199985813315, 'psi': 0.9947362281860233}-{'f1_val': 0.9951878390193748, 'auprc': 0.9950209824355525, 'loss_val': 0.0390065506204057, 'psi': 0.9951210963858459}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=38 head_norm_before_train=1.630074 cos_to_last_merge=0.9423 (last merge round=19)
[S11] ⚠️ Model drifted since last merge! cos=0.942
[S11] round=38 local utility u=0.004142 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9964107418607073, 'loss_val': 0.061499206297786345, 'psi': 0.9962445016922685}-{'f1_val': 0.9961336749133093, 'auprc': 0.9963124193851467, 'loss_val': 0.06948879626718842, 'psi': 0.9962051727020442}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=38 head_norm_before_train=1.766173 cos_to_last_merge=0.9874 (last merge round=20)
[S13] round=38 local utility u=0.230317 metrics={'f1_val': 0.6226017977262069, 'auprc': 0.7048939840820708, 'loss_val': 0.7008227629790036, 'psi': 0.6555186722685524}-{'f1_val': 0.5873479107497909, 'auprc': 0.7203953461714004, 'loss_val': 0.996437749726568, 'psi': 0.6405668849184347}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=38 head_norm_before_train=1.803015 cos_to_last_merge=0.9745 (last merge round=17)
[S14] round=38 local utility u=0.128583 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9990879059671836, 'loss_val': 0.02625688101110886, 'psi': 0.9980801240879088}-{'f1_val': 0.9596662228743902, 'auprc': 0.9990310407511969, 'loss_val': 0.05680030474174301, 'psi': 0.975412150025113}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] sending update (kind=head size=1804 to 1 peers)
[S15] START round=38 head_norm_before_train=1.882920 cos_to_last_merge=0.9718 (last merge round=19)
[S15] round=38 local utility u=0.000000 metrics={'f1_val': 0.8435004579381971, 'auprc': 0.9956776325652921, 'loss_val': 0.1978101233405406, 'psi': 0.9043713277890351}-{'f1_val': 0.8479156617274388, 'auprc': 0.9957408150246791, 'loss_val': 0.19391565288220242, 'psi': 0.9070457230463349}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=38 head_norm_before_train=1.969639 (no previous merge yet)
[S16] round=38 local utility u=0.331814 metrics={'f1_val': 0.9580107472016108, 'auprc': 0.9948531889855965, 'loss_val': 0.11144189323803343, 'psi': 0.9727477239152051}-{'f1_val': 0.9144739781619649, 'auprc': 0.9708127668495448, 'loss_val': 0.44172845209729594, 'psi': 0.9370094936369968}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=38 head_norm_before_train=2.016578 (no previous merge yet)
[S17] round=38 local utility u=0.064660 metrics={'f1_val': 0.6033965579378757, 'auprc': 0.8803647263545125, 'loss_val': 0.8910404807734388, 'psi': 0.7141838253045305}-{'f1_val': 0.6000043561470401, 'auprc': 0.8748175441166706, 'loss_val': 0.9833662033691054, 'psi': 0.7099296313348922}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=39 head_norm_before_train=1.570259 cos_to_last_merge=0.9854 (last merge round=19)
[S2] round=39 local utility u=0.000000 metrics={'f1_val': 0.7133196528815999, 'auprc': 0.7886528158087452, 'loss_val': 0.5924702931946345, 'psi': 0.7434529180524581}-{'f1_val': 0.712151241771348, 'auprc': 0.7751068825304148, 'loss_val': 0.5075572563632323, 'psi': 0.7373334980749747}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=40 psi=0.743 u=0.0000 p_local=0.0468 f1=0.713 auprc=0.789 bytes=41370
[S3] START round=39 head_norm_before_train=1.377488 cos_to_last_merge=0.9475 (last merge round=19)
[S3] ⚠️ Model drifted since last merge! cos=0.948
[S3] round=39 local utility u=0.127889 metrics={'f1_val': 0.9977814963782642, 'auprc': 0.9978079052190347, 'loss_val': 0.06866087361331105, 'psi': 0.9977920599145724}-{'f1_val': 0.9610352511054436, 'auprc': 0.998155672259455, 'loss_val': 0.10500442201619992, 'psi': 0.9758834195670482}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S3] r=40 psi=0.998 u=0.1279 p_local=0.1097 f1=0.998 auprc=0.998 bytes=48547
[S4] START round=39 head_norm_before_train=1.763050 cos_to_last_merge=0.7583 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.758
[S4] round=39 local utility u=0.000000 metrics={'f1_val': 0.9462047325147668, 'auprc': 0.9678793404300077, 'loss_val': 0.30849373843880146, 'psi': 0.9548745756808632}-{'f1_val': 0.9484640156656763, 'auprc': 0.9675948071637192, 'loss_val': 0.3014330803188786, 'psi': 0.9561163322648935}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=40 psi=0.955 u=0.0000 p_local=0.0219 f1=0.946 auprc=0.968 bytes=45027
[S5] START round=39 head_norm_before_train=1.401344 cos_to_last_merge=0.9610 (last merge round=19)
[S5] round=39 local utility u=1.000000 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9946241332455652, 'loss_val': 0.26748682975642246, 'psi': 0.8180424437585743}-{'f1_val': 0.4171435078150064, 'auprc': 0.7577719931535026, 'loss_val': 1.6069887494668342, 'psi': 0.553394901950405}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S5] r=40 psi=0.818 u=1.0000 p_local=0.4560 f1=0.700 auprc=0.995 bytes=44928
[S6] START round=39 head_norm_before_train=1.574701 cos_to_last_merge=0.7773 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.777
[S6] round=39 local utility u=1.000000 metrics={'f1_val': 0.8409928556570089, 'auprc': 0.9593716529776295, 'loss_val': 0.34479034767389055, 'psi': 0.8883443745852571}-{'f1_val': 0.5985461505532452, 'auprc': 0.7740688061918533, 'loss_val': 1.0258213719001035, 'psi': 0.6687552128086884}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S6] r=40 psi=0.888 u=1.0000 p_local=0.5254 f1=0.841 auprc=0.959 bytes=43123
[S7] START round=39 head_norm_before_train=1.365103 cos_to_last_merge=0.7741 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.774
[S7] round=39 local utility u=0.000000 metrics={'f1_val': 0.44614350123819346, 'auprc': 0.7807959625214547, 'loss_val': 0.9820341622723192, 'psi': 0.5800044857514979}-{'f1_val': 0.6853355778823105, 'auprc': 0.865749326424359, 'loss_val': 0.3311202019991148, 'psi': 0.75750107729913}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] r=40 psi=0.580 u=0.0000 p_local=0.2768 f1=0.446 auprc=0.781 bytes=37727
[S8] START round=39 head_norm_before_train=1.741144 cos_to_last_merge=0.9703 (last merge round=19)
[S8] round=39 local utility u=0.000000 metrics={'f1_val': 0.9365589892577838, 'auprc': 0.9858680304740182, 'loss_val': 0.10960952851859009, 'psi': 0.9562826057442775}-{'f1_val': 0.9732433751924605, 'auprc': 0.9954856117594574, 'loss_val': 0.07109417990109078, 'psi': 0.9821402698192593}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] r=40 psi=0.956 u=0.0000 p_local=0.0203 f1=0.937 auprc=0.986 bytes=50375
[S9] START round=39 head_norm_before_train=1.813321 cos_to_last_merge=0.8327 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.833
[S9] round=39 local utility u=0.000000 metrics={'f1_val': 0.9171053930674866, 'auprc': 0.9986390497654186, 'loss_val': 0.1362808118923859, 'psi': 0.9497188557466594}-{'f1_val': 0.9966605118138915, 'auprc': 0.9986088432286946, 'loss_val': 0.0250801078584138, 'psi': 0.9974398443798127}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=40 psi=0.950 u=0.0000 p_local=0.0206 f1=0.917 auprc=0.999 bytes=57591
[S10] START round=39 head_norm_before_train=1.822605 cos_to_last_merge=0.9632 (last merge round=19)
[S10] round=39 local utility u=0.000000 metrics={'f1_val': 0.9943563983784213, 'auprc': 0.9919661911484535, 'loss_val': 0.05664267287550084, 'psi': 0.9934003154864341}-{'f1_val': 0.9951878390193748, 'auprc': 0.9940588119359961, 'loss_val': 0.03775199985813315, 'psi': 0.9947362281860233}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] r=40 psi=0.993 u=0.0000 p_local=0.0042 f1=0.994 auprc=0.992 bytes=55807
[S11] START round=39 head_norm_before_train=1.647913 cos_to_last_merge=0.9396 (last merge round=19)
[S11] ⚠️ Model drifted since last merge! cos=0.940
[S11] round=39 local utility u=0.011416 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9977048632051534, 'loss_val': 0.04254863729420572, 'psi': 0.996762150230047}-{'f1_val': 0.9961336749133093, 'auprc': 0.9964107418607073, 'loss_val': 0.061499206297786345, 'psi': 0.9962445016922685}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] sending update (kind=head size=1803 to 1 peers)
[S11] r=40 psi=0.997 u=0.0114 p_local=0.0155 f1=0.996 auprc=0.998 bytes=63002
[S13] START round=39 head_norm_before_train=1.771443 cos_to_last_merge=0.9870 (last merge round=20)
[S13] round=39 local utility u=0.000000 metrics={'f1_val': 0.5500878974477641, 'auprc': 0.7269588473075113, 'loss_val': 0.9786517228273615, 'psi': 0.6208362773916629}-{'f1_val': 0.6226017977262069, 'auprc': 0.7048939840820708, 'loss_val': 0.7008227629790036, 'psi': 0.6555186722685524}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=40 psi=0.621 u=0.0000 p_local=0.0722 f1=0.550 auprc=0.727 bytes=41401
[S14] START round=39 head_norm_before_train=1.816158 cos_to_last_merge=0.9735 (last merge round=17)
[S14] round=39 local utility u=0.000023 metrics={'f1_val': 0.9980403583402068, 'auprc': 0.9979833538664185, 'loss_val': 0.02668993687716954, 'psi': 0.9980175565506915}-{'f1_val': 0.9974082695017256, 'auprc': 0.9990879059671836, 'loss_val': 0.02625688101110886, 'psi': 0.9980801240879088}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S14] r=40 psi=0.998 u=0.0000 p_local=0.0236 f1=0.998 auprc=0.998 bytes=52175
[S15] START round=39 head_norm_before_train=1.897192 cos_to_last_merge=0.9707 (last merge round=19)
[S15] round=39 local utility u=0.510758 metrics={'f1_val': 0.9883646006797152, 'auprc': 0.9954050054022308, 'loss_val': 0.04466023736576709, 'psi': 0.9911807625687215}-{'f1_val': 0.8435004579381971, 'auprc': 0.9956776325652921, 'loss_val': 0.1978101233405406, 'psi': 0.9043713277890351}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S15] r=40 psi=0.991 u=0.5108 p_local=0.3074 f1=0.988 auprc=0.995 bytes=44984
[S16] START round=39 head_norm_before_train=1.977920 (no previous merge yet)
[S16] round=39 local utility u=0.141513 metrics={'f1_val': 0.9922209735966265, 'auprc': 0.9977472695526637, 'loss_val': 0.04235934418993573, 'psi': 0.9944314919790413}-{'f1_val': 0.9580107472016108, 'auprc': 0.9948531889855965, 'loss_val': 0.11144189323803343, 'psi': 0.9727477239152051}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S16] r=40 psi=0.994 u=0.1415 p_local=0.1875 f1=0.992 auprc=0.998 bytes=43211
[S17] START round=39 head_norm_before_train=2.026710 (no previous merge yet)
[S17] round=39 local utility u=0.015480 metrics={'f1_val': 0.5876555481646335, 'auprc': 0.9318807792453431, 'loss_val': 0.9201826422399879, 'psi': 0.7253456405969174}-{'f1_val': 0.6033965579378757, 'auprc': 0.8803647263545125, 'loss_val': 0.8910404807734388, 'psi': 0.7141838253045305}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S17] r=40 psi=0.725 u=0.0155 p_local=0.0704 f1=0.588 auprc=0.932 bytes=39566
[S2] START round=40 head_norm_before_train=1.579673 cos_to_last_merge=0.9844 (last merge round=19)
[S2] round=40 local utility u=0.000000 metrics={'f1_val': 0.7124677144604303, 'auprc': 0.7869536648293537, 'loss_val': 0.607539214519268, 'psi': 0.7422620946079996}-{'f1_val': 0.7133196528815999, 'auprc': 0.7886528158087452, 'loss_val': 0.5924702931946345, 'psi': 0.7434529180524581}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=40 head_norm_before_train=1.397582 cos_to_last_merge=0.9451 (last merge round=19)
[S3] ⚠️ Model drifted since last merge! cos=0.945
[S3] round=40 local utility u=0.000000 metrics={'f1_val': 0.9606109340814555, 'auprc': 0.998077320405987, 'loss_val': 0.12270820057049091, 'psi': 0.975597488611268}-{'f1_val': 0.9977814963782642, 'auprc': 0.9978079052190347, 'loss_val': 0.06866087361331105, 'psi': 0.9977920599145724}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=40 head_norm_before_train=1.775519 cos_to_last_merge=0.7565 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.757
[S4] round=40 local utility u=0.000000 metrics={'f1_val': 0.9479205206920891, 'auprc': 0.9605852309321787, 'loss_val': 0.3064937275195179, 'psi': 0.952986404788125}-{'f1_val': 0.9462047325147668, 'auprc': 0.9678793404300077, 'loss_val': 0.30849373843880146, 'psi': 0.9548745756808632}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=40 head_norm_before_train=1.405872 cos_to_last_merge=0.9604 (last merge round=19)
[S5] round=40 local utility u=0.000000 metrics={'f1_val': 0.6752892221126547, 'auprc': 0.9465610302614502, 'loss_val': 0.301896389216926, 'psi': 0.7837979453721728}-{'f1_val': 0.7003213174339138, 'auprc': 0.9946241332455652, 'loss_val': 0.26748682975642246, 'psi': 0.8180424437585743}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=40 head_norm_before_train=1.581568 cos_to_last_merge=0.7767 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.777
[S6] round=40 local utility u=0.532944 metrics={'f1_val': 0.9770556372753717, 'auprc': 0.9695849104882683, 'loss_val': 0.12591956274582497, 'psi': 0.9740673465605304}-{'f1_val': 0.8409928556570089, 'auprc': 0.9593716529776295, 'loss_val': 0.34479034767389055, 'psi': 0.8883443745852571}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] sending update (kind=head size=1805 to 1 peers)
[S7] START round=40 head_norm_before_train=1.372081 cos_to_last_merge=0.7731 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.773
[S7] round=40 local utility u=0.683571 metrics={'f1_val': 0.6089950067321395, 'auprc': 0.7928190137481557, 'loss_val': 0.6280699594641423, 'psi': 0.682524609538546}-{'f1_val': 0.44614350123819346, 'auprc': 0.7807959625214547, 'loss_val': 0.9820341622723192, 'psi': 0.5800044857514979}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=40 head_norm_before_train=1.748576 cos_to_last_merge=0.9697 (last merge round=19)
[S8] round=40 local utility u=0.189098 metrics={'f1_val': 0.9913939174441393, 'auprc': 0.9860824917790636, 'loss_val': 0.06106653502118305, 'psi': 0.989269347178109}-{'f1_val': 0.9365589892577838, 'auprc': 0.9858680304740182, 'loss_val': 0.10960952851859009, 'psi': 0.9562826057442775}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] sending update (kind=head size=1804 to 1 peers)
[S9] START round=40 head_norm_before_train=1.822165 cos_to_last_merge=0.8320 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.832
[S9] round=40 local utility u=0.293367 metrics={'f1_val': 0.9962421144756511, 'auprc': 0.9987211222839439, 'loss_val': 0.02461265469095809, 'psi': 0.9972337175989683}-{'f1_val': 0.9171053930674866, 'auprc': 0.9986390497654186, 'loss_val': 0.1362808118923859, 'psi': 0.9497188557466594}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=40 head_norm_before_train=1.837042 cos_to_last_merge=0.9619 (last merge round=19)
[S10] round=40 local utility u=0.014216 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9938158087017771, 'loss_val': 0.03956075836196123, 'psi': 0.9947201958189491}-{'f1_val': 0.9943563983784213, 'auprc': 0.9919661911484535, 'loss_val': 0.05664267287550084, 'psi': 0.9934003154864341}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=40 head_norm_before_train=1.664238 cos_to_last_merge=0.9371 (last merge round=19)
[S11] ⚠️ Model drifted since last merge! cos=0.937
[S11] round=40 local utility u=0.000000 metrics={'f1_val': 0.8686854843703522, 'auprc': 0.9966810306791845, 'loss_val': 0.15963924064358118, 'psi': 0.9198837028938851}-{'f1_val': 0.9961336749133093, 'auprc': 0.9977048632051534, 'loss_val': 0.04254863729420572, 'psi': 0.996762150230047}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=40 head_norm_before_train=1.777974 cos_to_last_merge=0.9864 (last merge round=20)
[S13] round=40 local utility u=0.219157 metrics={'f1_val': 0.6152005191241294, 'auprc': 0.7341454126565912, 'loss_val': 0.9525722862492866, 'psi': 0.6627784765371141}-{'f1_val': 0.5500878974477641, 'auprc': 0.7269588473075113, 'loss_val': 0.9786517228273615, 'psi': 0.6208362773916629}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=40 head_norm_before_train=1.829511 cos_to_last_merge=0.9727 (last merge round=17)
[S14] round=40 local utility u=0.000000 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9989450022576072, 'loss_val': 0.02619338375971961, 'psi': 0.9980229626040782}-{'f1_val': 0.9980403583402068, 'auprc': 0.9979833538664185, 'loss_val': 0.02668993687716954, 'psi': 0.9980175565506915}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=40 head_norm_before_train=1.909651 cos_to_last_merge=0.9698 (last merge round=19)
[S15] round=40 local utility u=0.000000 metrics={'f1_val': 0.7325585840197997, 'auprc': 0.9883009580072515, 'loss_val': 0.5499369978771815, 'psi': 0.8348555336147805}-{'f1_val': 0.9883646006797152, 'auprc': 0.9954050054022308, 'loss_val': 0.04466023736576709, 'psi': 0.9911807625687215}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=40 head_norm_before_train=1.983778 (no previous merge yet)
[S16] round=40 local utility u=0.000000 metrics={'f1_val': 0.991177197015794, 'auprc': 0.9958049802930065, 'loss_val': 0.048545301512435295, 'psi': 0.993028310326679}-{'f1_val': 0.9922209735966265, 'auprc': 0.9977472695526637, 'loss_val': 0.04235934418993573, 'psi': 0.9944314919790413}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=40 head_norm_before_train=2.033348 (no previous merge yet)
[S17] round=40 local utility u=0.089288 metrics={'f1_val': 0.5984406018359469, 'auprc': 0.9539815473321732, 'loss_val': 0.8726194750850874, 'psi': 0.7406569800344375}-{'f1_val': 0.5876555481646335, 'auprc': 0.9318807792453431, 'loss_val': 0.9201826422399879, 'psi': 0.7253456405969174}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=41 head_norm_before_train=1.588097 cos_to_last_merge=0.9834 (last merge round=19)
[S2] round=41 local utility u=0.019269 metrics={'f1_val': 0.6989921947302767, 'auprc': 0.7844489200420686, 'loss_val': 0.4806329952750836, 'psi': 0.7331748848549935}-{'f1_val': 0.7124677144604303, 'auprc': 0.7869536648293537, 'loss_val': 0.607539214519268, 'psi': 0.7422620946079996}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=41 head_norm_before_train=1.418315 cos_to_last_merge=0.9427 (last merge round=19)
[S3] ⚠️ Model drifted since last merge! cos=0.943
[S3] round=41 local utility u=0.000000 metrics={'f1_val': 0.922237277911645, 'auprc': 0.998273158312294, 'loss_val': 0.1836848826934473, 'psi': 0.9526516300719046}-{'f1_val': 0.9606109340814555, 'auprc': 0.998077320405987, 'loss_val': 0.12270820057049091, 'psi': 0.975597488611268}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=41 head_norm_before_train=1.785158 cos_to_last_merge=0.7557 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.756
[S4] round=41 local utility u=0.007750 metrics={'f1_val': 0.951148704440451, 'auprc': 0.958563313568936, 'loss_val': 0.3042968470358111, 'psi': 0.9541145480918449}-{'f1_val': 0.9479205206920891, 'auprc': 0.9605852309321787, 'loss_val': 0.3064937275195179, 'psi': 0.952986404788125}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=41 head_norm_before_train=1.411956 cos_to_last_merge=0.9596 (last merge round=19)
[S5] round=41 local utility u=0.000000 metrics={'f1_val': 0.6160402510832127, 'auprc': 0.8773094413716098, 'loss_val': 0.40738422586067524, 'psi': 0.7205479271985715}-{'f1_val': 0.6752892221126547, 'auprc': 0.9465610302614502, 'loss_val': 0.301896389216926, 'psi': 0.7837979453721728}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=41 head_norm_before_train=1.587304 cos_to_last_merge=0.7762 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.776
[S6] round=41 local utility u=0.000000 metrics={'f1_val': 0.7095840230536, 'auprc': 0.841117987703332, 'loss_val': 0.7381801748914235, 'psi': 0.7621976089134928}-{'f1_val': 0.9770556372753717, 'auprc': 0.9695849104882683, 'loss_val': 0.12591956274582497, 'psi': 0.9740673465605304}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=41 head_norm_before_train=1.381272 cos_to_last_merge=0.7724 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.772
[S7] round=41 local utility u=0.379727 metrics={'f1_val': 0.6738755316464541, 'auprc': 0.8311715802972028, 'loss_val': 0.37295595833493045, 'psi': 0.7367939511067536}-{'f1_val': 0.6089950067321395, 'auprc': 0.7928190137481557, 'loss_val': 0.6280699594641423, 'psi': 0.682524609538546}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=41 head_norm_before_train=1.754627 cos_to_last_merge=0.9692 (last merge round=19)
[S8] round=41 local utility u=0.000000 metrics={'f1_val': 0.9834957852698268, 'auprc': 0.9956146026118824, 'loss_val': 0.054626428092331376, 'psi': 0.988343312206649}-{'f1_val': 0.9913939174441393, 'auprc': 0.9860824917790636, 'loss_val': 0.06106653502118305, 'psi': 0.989269347178109}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=41 head_norm_before_train=1.829711 cos_to_last_merge=0.8313 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.831
[S9] round=41 local utility u=0.000000 metrics={'f1_val': 0.9899766087340214, 'auprc': 0.9986112203952106, 'loss_val': 0.03654348228473623, 'psi': 0.993430453398497}-{'f1_val': 0.9962421144756511, 'auprc': 0.9987211222839439, 'loss_val': 0.02461265469095809, 'psi': 0.9972337175989683}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=41 head_norm_before_train=1.848682 cos_to_last_merge=0.9609 (last merge round=19)
[S10] round=41 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9932702524345918, 'loss_val': 0.03840549026506221, 'psi': 0.9945019733120749}-{'f1_val': 0.9953231205637304, 'auprc': 0.9938158087017771, 'loss_val': 0.03956075836196123, 'psi': 0.9947201958189491}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=41 head_norm_before_train=1.677490 cos_to_last_merge=0.9352 (last merge round=19)
[S11] ⚠️ Model drifted since last merge! cos=0.935
[S11] round=41 local utility u=0.442557 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9972941261027973, 'loss_val': 0.041053376877375515, 'psi': 0.9965978553891045}-{'f1_val': 0.8686854843703522, 'auprc': 0.9966810306791845, 'loss_val': 0.15963924064358118, 'psi': 0.9198837028938851}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S11] sending update (kind=head size=1808 to 1 peers)
[S13] START round=41 head_norm_before_train=1.787835 cos_to_last_merge=0.9857 (last merge round=20)
[S13] round=41 local utility u=0.142013 metrics={'f1_val': 0.6296058544689952, 'auprc': 0.728874093313868, 'loss_val': 0.7391645991892954, 'psi': 0.6693131500069444}-{'f1_val': 0.6152005191241294, 'auprc': 0.7341454126565912, 'loss_val': 0.9525722862492866, 'psi': 0.6627784765371141}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=41 head_norm_before_train=1.837597 cos_to_last_merge=0.9720 (last merge round=17)
[S14] round=41 local utility u=0.000000 metrics={'f1_val': 0.9423488607791358, 'auprc': 0.9974701522808371, 'loss_val': 0.08861297871132491, 'psi': 0.9643973773798163}-{'f1_val': 0.9974082695017256, 'auprc': 0.9989450022576072, 'loss_val': 0.02619338375971961, 'psi': 0.9980229626040782}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=41 head_norm_before_train=1.922263 cos_to_last_merge=0.9690 (last merge round=19)
[S15] round=41 local utility u=1.000000 metrics={'f1_val': 0.9854897732706588, 'auprc': 0.9970531382525323, 'loss_val': 0.05272698107567348, 'psi': 0.9901151192634081}-{'f1_val': 0.7325585840197997, 'auprc': 0.9883009580072515, 'loss_val': 0.5499369978771815, 'psi': 0.8348555336147805}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=41 head_norm_before_train=1.988285 (no previous merge yet)
[S16] round=41 local utility u=0.000000 metrics={'f1_val': 0.9632587476408443, 'auprc': 0.990193045410729, 'loss_val': 0.10689134317427944, 'psi': 0.9740324667487981}-{'f1_val': 0.991177197015794, 'auprc': 0.9958049802930065, 'loss_val': 0.048545301512435295, 'psi': 0.993028310326679}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=41 head_norm_before_train=2.041346 (no previous merge yet)
[S17] round=41 local utility u=0.000000 metrics={'f1_val': 0.5927048896563458, 'auprc': 0.8189511431605325, 'loss_val': 1.0898944507870838, 'psi': 0.6832033910580205}-{'f1_val': 0.5984406018359469, 'auprc': 0.9539815473321732, 'loss_val': 0.8726194750850874, 'psi': 0.7406569800344375}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=42 head_norm_before_train=1.595528 cos_to_last_merge=0.9825 (last merge round=19)
[S2] round=42 local utility u=0.000000 metrics={'f1_val': 0.6828133776724659, 'auprc': 0.7803107938257339, 'loss_val': 0.5634178131693609, 'psi': 0.7218123441337732}-{'f1_val': 0.6989921947302767, 'auprc': 0.7844489200420686, 'loss_val': 0.4806329952750836, 'psi': 0.7331748848549935}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=42 head_norm_before_train=1.437819 cos_to_last_merge=0.9402 (last merge round=19)
[S3] ⚠️ Model drifted since last merge! cos=0.940
[S3] round=42 local utility u=0.146066 metrics={'f1_val': 0.9599721348864418, 'auprc': 0.9982273388556574, 'loss_val': 0.11782429101704398, 'psi': 0.9752742164741282}-{'f1_val': 0.922237277911645, 'auprc': 0.998273158312294, 'loss_val': 0.1836848826934473, 'psi': 0.9526516300719046}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=42 head_norm_before_train=1.790616 cos_to_last_merge=0.7557 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.756
[S4] round=42 local utility u=0.000000 metrics={'f1_val': 0.9499323765049499, 'auprc': 0.9515496914307224, 'loss_val': 0.3075337474631892, 'psi': 0.9505793024752589}-{'f1_val': 0.951148704440451, 'auprc': 0.958563313568936, 'loss_val': 0.3042968470358111, 'psi': 0.9541145480918449}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=42 head_norm_before_train=1.420384 cos_to_last_merge=0.9588 (last merge round=19)
[S5] round=42 local utility u=0.291475 metrics={'f1_val': 0.700320598491359, 'auprc': 0.8716888710430206, 'loss_val': 0.31325551543661767, 'psi': 0.7688679075120237}-{'f1_val': 0.6160402510832127, 'auprc': 0.8773094413716098, 'loss_val': 0.40738422586067524, 'psi': 0.7205479271985715}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=42 head_norm_before_train=1.596967 cos_to_last_merge=0.7751 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.775
[S6] round=42 local utility u=0.471629 metrics={'f1_val': 0.7866871110347989, 'auprc': 0.9393264754394365, 'loss_val': 0.5521663906373514, 'psi': 0.847742856796654}-{'f1_val': 0.7095840230536, 'auprc': 0.841117987703332, 'loss_val': 0.7381801748914235, 'psi': 0.7621976089134928}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] START round=42 head_norm_before_train=1.391560 cos_to_last_merge=0.7715 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.771
[S7] round=42 local utility u=0.000000 metrics={'f1_val': 0.6364344640062236, 'auprc': 0.7958532202022597, 'loss_val': 0.5532017074490659, 'psi': 0.7002019664846381}-{'f1_val': 0.6738755316464541, 'auprc': 0.8311715802972028, 'loss_val': 0.37295595833493045, 'psi': 0.7367939511067536}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=42 head_norm_before_train=1.762046 cos_to_last_merge=0.9686 (last merge round=19)
[S8] round=42 local utility u=0.038738 metrics={'f1_val': 0.9933016371923923, 'auprc': 0.9959405475314566, 'loss_val': 0.03696371430495695, 'psi': 0.994357201328018}-{'f1_val': 0.9834957852698268, 'auprc': 0.9956146026118824, 'loss_val': 0.054626428092331376, 'psi': 0.988343312206649}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S8] sending update (kind=head size=1807 to 1 peers)
[S9] START round=42 head_norm_before_train=1.838177 cos_to_last_merge=0.8305 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.831
[S9] round=42 local utility u=0.025261 metrics={'f1_val': 0.9962421144756511, 'auprc': 0.998582780370273, 'loss_val': 0.023528829996105883, 'psi': 0.9971783808335}-{'f1_val': 0.9899766087340214, 'auprc': 0.9986112203952106, 'loss_val': 0.03654348228473623, 'psi': 0.993430453398497}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] sending update (kind=head size=1803 to 1 peers)
[S10] START round=42 head_norm_before_train=1.858715 cos_to_last_merge=0.9599 (last merge round=19)
[S10] round=42 local utility u=0.001923 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9937285824465505, 'loss_val': 0.035934052460371575, 'psi': 0.9946853053168584}-{'f1_val': 0.9953231205637304, 'auprc': 0.9932702524345918, 'loss_val': 0.03840549026506221, 'psi': 0.9945019733120749}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=42 head_norm_before_train=1.689157 cos_to_last_merge=0.9335 (last merge round=19)
[S11] ⚠️ Model drifted since last merge! cos=0.934
[S11] round=42 local utility u=0.000000 metrics={'f1_val': 0.993611924360192, 'auprc': 0.9980830458733521, 'loss_val': 0.04093993760130158, 'psi': 0.9954003729654559}-{'f1_val': 0.9961336749133093, 'auprc': 0.9972941261027973, 'loss_val': 0.041053376877375515, 'psi': 0.9965978553891045}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=42 head_norm_before_train=1.795394 cos_to_last_merge=0.9850 (last merge round=20)
[S13] round=42 local utility u=0.000000 metrics={'f1_val': 0.6129049787646904, 'auprc': 0.7367331397187894, 'loss_val': 0.8975931721334899, 'psi': 0.66243624314633}-{'f1_val': 0.6296058544689952, 'auprc': 0.728874093313868, 'loss_val': 0.7391645991892954, 'psi': 0.6693131500069444}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=42 head_norm_before_train=1.844704 cos_to_last_merge=0.9715 (last merge round=17)
[S14] round=42 local utility u=0.187043 metrics={'f1_val': 0.9943183518468823, 'auprc': 0.9992237385748004, 'loss_val': 0.0316054872157341, 'psi': 0.9962805065380496}-{'f1_val': 0.9423488607791358, 'auprc': 0.9974701522808371, 'loss_val': 0.08861297871132491, 'psi': 0.9643973773798163}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] sending update (kind=head size=1805 to 1 peers)
[S15] START round=42 head_norm_before_train=1.933328 cos_to_last_merge=0.9682 (last merge round=19)
[S15] round=42 local utility u=0.000000 metrics={'f1_val': 0.9372665255493237, 'auprc': 0.991377571095224, 'loss_val': 0.08907939923555191, 'psi': 0.9589109437676837}-{'f1_val': 0.9854897732706588, 'auprc': 0.9970531382525323, 'loss_val': 0.05272698107567348, 'psi': 0.9901151192634081}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=42 head_norm_before_train=1.991690 (no previous merge yet)
[S16] round=42 local utility u=0.000000 metrics={'f1_val': 0.8990500977326727, 'auprc': 0.9559691402821904, 'loss_val': 0.5012087935851278, 'psi': 0.9218177147524798}-{'f1_val': 0.9632587476408443, 'auprc': 0.990193045410729, 'loss_val': 0.10689134317427944, 'psi': 0.9740324667487981}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=42 head_norm_before_train=2.051684 (no previous merge yet)
[S17] round=42 local utility u=0.226095 metrics={'f1_val': 0.6241255055942557, 'auprc': 0.845743479889645, 'loss_val': 0.9066059175760045, 'psi': 0.7127726953124115}-{'f1_val': 0.5927048896563458, 'auprc': 0.8189511431605325, 'loss_val': 1.0898944507870838, 'psi': 0.6832033910580205}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=43 head_norm_before_train=1.605298 cos_to_last_merge=0.9813 (last merge round=19)
[S2] round=43 local utility u=0.079761 metrics={'f1_val': 0.7092032833054137, 'auprc': 0.8045264452802863, 'loss_val': 0.6348828692843984, 'psi': 0.7473325480953628}-{'f1_val': 0.6828133776724659, 'auprc': 0.7803107938257339, 'loss_val': 0.5634178131693609, 'psi': 0.7218123441337732}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=43 head_norm_before_train=1.453645 cos_to_last_merge=0.9382 (last merge round=19)
[S3] ⚠️ Model drifted since last merge! cos=0.938
[S3] round=43 local utility u=0.149203 metrics={'f1_val': 0.9973696976584205, 'auprc': 0.9978643059876235, 'loss_val': 0.04271523535972813, 'psi': 0.9975675409901017}-{'f1_val': 0.9599721348864418, 'auprc': 0.9982273388556574, 'loss_val': 0.11782429101704398, 'psi': 0.9752742164741282}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] sending update (kind=head size=1804 to 1 peers)
[S4] START round=43 head_norm_before_train=1.794507 cos_to_last_merge=0.7556 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.756
[S4] round=43 local utility u=0.000000 metrics={'f1_val': 0.9440279711257409, 'auprc': 0.9241330811506276, 'loss_val': 0.32236782336763486, 'psi': 0.9360700151356955}-{'f1_val': 0.9499323765049499, 'auprc': 0.9515496914307224, 'loss_val': 0.3075337474631892, 'psi': 0.9505793024752589}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=43 head_norm_before_train=1.429577 cos_to_last_merge=0.9579 (last merge round=19)
[S5] round=43 local utility u=0.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.7871698238434031, 'loss_val': 0.3826934092737056, 'psi': 0.7350602886321767}-{'f1_val': 0.700320598491359, 'auprc': 0.8716888710430206, 'loss_val': 0.31325551543661767, 'psi': 0.7688679075120237}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=43 head_norm_before_train=1.607182 cos_to_last_merge=0.7738 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.774
[S6] round=43 local utility u=0.000000 metrics={'f1_val': 0.6377708099187022, 'auprc': 0.7907761498598128, 'loss_val': 0.8766535801935178, 'psi': 0.6989729458951464}-{'f1_val': 0.7866871110347989, 'auprc': 0.9393264754394365, 'loss_val': 0.5521663906373514, 'psi': 0.847742856796654}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=43 head_norm_before_train=1.402319 cos_to_last_merge=0.7704 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.770
[S7] round=43 local utility u=0.000012 metrics={'f1_val': 0.6376760469967391, 'auprc': 0.7969904349722147, 'loss_val': 0.564038864450613, 'psi': 0.7014018021869293}-{'f1_val': 0.6364344640062236, 'auprc': 0.7958532202022597, 'loss_val': 0.5532017074490659, 'psi': 0.7002019664846381}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=43 head_norm_before_train=1.768700 cos_to_last_merge=0.9681 (last merge round=19)
[S8] round=43 local utility u=0.002897 metrics={'f1_val': 0.9933016371923923, 'auprc': 0.997697324476081, 'loss_val': 0.03644083640309534, 'psi': 0.9950599121058679}-{'f1_val': 0.9933016371923923, 'auprc': 0.9959405475314566, 'loss_val': 0.03696371430495695, 'psi': 0.994357201328018}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] sending update (kind=head size=1804 to 1 peers)
[S9] START round=43 head_norm_before_train=1.847114 cos_to_last_merge=0.8297 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.830
[S9] round=43 local utility u=0.000207 metrics={'f1_val': 0.9962421144756511, 'auprc': 0.9984990236319263, 'loss_val': 0.022864190220099577, 'psi': 0.9971448781381612}-{'f1_val': 0.9962421144756511, 'auprc': 0.998582780370273, 'loss_val': 0.023528829996105883, 'psi': 0.9971783808335}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] sending update (kind=head size=1803 to 1 peers)
[S10] START round=43 head_norm_before_train=1.869928 cos_to_last_merge=0.9589 (last merge round=19)
[S10] round=43 local utility u=0.000205 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9934202422753965, 'loss_val': 0.03459850702529699, 'psi': 0.9945619692483968}-{'f1_val': 0.9953231205637304, 'auprc': 0.9937285824465505, 'loss_val': 0.035934052460371575, 'psi': 0.9946853053168584}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=43 head_norm_before_train=1.700904 cos_to_last_merge=0.9319 (last merge round=19)
[S11] ⚠️ Model drifted since last merge! cos=0.932
[S11] round=43 local utility u=0.000000 metrics={'f1_val': 0.981169186686789, 'auprc': 0.9981314616608484, 'loss_val': 0.04985965905927035, 'psi': 0.9879540966764127}-{'f1_val': 0.993611924360192, 'auprc': 0.9980830458733521, 'loss_val': 0.04093993760130158, 'psi': 0.9954003729654559}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=43 head_norm_before_train=1.801500 cos_to_last_merge=0.9845 (last merge round=20)
[S13] round=43 local utility u=0.000000 metrics={'f1_val': 0.6131535029101316, 'auprc': 0.7430352277529284, 'loss_val': 0.9497247514277288, 'psi': 0.6651061928472504}-{'f1_val': 0.6129049787646904, 'auprc': 0.7367331397187894, 'loss_val': 0.8975931721334899, 'psi': 0.66243624314633}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=43 head_norm_before_train=1.854285 cos_to_last_merge=0.9709 (last merge round=17)
[S14] round=43 local utility u=0.004197 metrics={'f1_val': 0.9967480671851483, 'auprc': 0.9957033589997496, 'loss_val': 0.027228130821880758, 'psi': 0.9963301839109888}-{'f1_val': 0.9943183518468823, 'auprc': 0.9992237385748004, 'loss_val': 0.0316054872157341, 'psi': 0.9962805065380496}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] sending update (kind=head size=1804 to 1 peers)
[S15] START round=43 head_norm_before_train=1.943166 cos_to_last_merge=0.9675 (last merge round=19)
[S15] round=43 local utility u=0.214949 metrics={'f1_val': 0.9962895101731264, 'auprc': 0.9965040340128332, 'loss_val': 0.02869932528275219, 'psi': 0.996375319709009}-{'f1_val': 0.9372665255493237, 'auprc': 0.991377571095224, 'loss_val': 0.08907939923555191, 'psi': 0.9589109437676837}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=43 head_norm_before_train=1.997915 (no previous merge yet)
[S16] round=43 local utility u=0.233730 metrics={'f1_val': 0.934689031492333, 'auprc': 0.9852007349956629, 'loss_val': 0.33527675794057266, 'psi': 0.9548937128936649}-{'f1_val': 0.8990500977326727, 'auprc': 0.9559691402821904, 'loss_val': 0.5012087935851278, 'psi': 0.9218177147524798}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S17] START round=43 head_norm_before_train=2.064179 (no previous merge yet)
[S17] round=43 local utility u=0.000000 metrics={'f1_val': 0.5910624473302305, 'auprc': 0.8293277908677433, 'loss_val': 1.175772460066459, 'psi': 0.6863685847452357}-{'f1_val': 0.6241255055942557, 'auprc': 0.845743479889645, 'loss_val': 0.9066059175760045, 'psi': 0.7127726953124115}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=44 head_norm_before_train=1.614189 cos_to_last_merge=0.9801 (last merge round=19)
[S2] round=44 local utility u=0.000000 metrics={'f1_val': 0.6293295486283959, 'auprc': 0.7598890306466284, 'loss_val': 0.7286538389539466, 'psi': 0.6815533414356889}-{'f1_val': 0.7092032833054137, 'auprc': 0.8045264452802863, 'loss_val': 0.6348828692843984, 'psi': 0.7473325480953628}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=44 head_norm_before_train=1.468019 cos_to_last_merge=0.9363 (last merge round=19)
[S3] ⚠️ Model drifted since last merge! cos=0.936
[S3] round=44 local utility u=0.000000 metrics={'f1_val': 0.960995754132836, 'auprc': 0.998000149071114, 'loss_val': 0.11172363382482192, 'psi': 0.9757975121081472}-{'f1_val': 0.9973696976584205, 'auprc': 0.9978643059876235, 'loss_val': 0.04271523535972813, 'psi': 0.9975675409901017}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=44 head_norm_before_train=1.794739 cos_to_last_merge=0.7563 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.756
[S4] round=44 local utility u=0.080722 metrics={'f1_val': 0.9568805893357024, 'auprc': 0.9463503590939674, 'loss_val': 0.30469108211123336, 'psi': 0.9526684972390085}-{'f1_val': 0.9440279711257409, 'auprc': 0.9241330811506276, 'loss_val': 0.32236782336763486, 'psi': 0.9360700151356955}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=44 head_norm_before_train=1.438594 cos_to_last_merge=0.9571 (last merge round=19)
[S5] round=44 local utility u=0.000000 metrics={'f1_val': 0.605206157769179, 'auprc': 0.7884805344641275, 'loss_val': 0.6218845390966975, 'psi': 0.6785159084471584}-{'f1_val': 0.700320598491359, 'auprc': 0.7871698238434031, 'loss_val': 0.3826934092737056, 'psi': 0.7350602886321767}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=44 head_norm_before_train=1.620392 cos_to_last_merge=0.7719 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.772
[S6] round=44 local utility u=1.000000 metrics={'f1_val': 0.9394054462831657, 'auprc': 0.9625994665776181, 'loss_val': 0.18863747750655244, 'psi': 0.9486830544009466}-{'f1_val': 0.6377708099187022, 'auprc': 0.7907761498598128, 'loss_val': 0.8766535801935178, 'psi': 0.6989729458951464}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] START round=44 head_norm_before_train=1.418971 cos_to_last_merge=0.7685 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.769
[S7] round=44 local utility u=0.000000 metrics={'f1_val': 0.6130875029072713, 'auprc': 0.7930938529204198, 'loss_val': 0.6246089965836734, 'psi': 0.6850900429125307}-{'f1_val': 0.6376760469967391, 'auprc': 0.7969904349722147, 'loss_val': 0.564038864450613, 'psi': 0.7014018021869293}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=44 head_norm_before_train=1.774691 cos_to_last_merge=0.9676 (last merge round=19)
[S8] round=44 local utility u=0.000000 metrics={'f1_val': 0.9922164873423569, 'auprc': 0.9989451755153729, 'loss_val': 0.0375748725304177, 'psi': 0.9949079626115633}-{'f1_val': 0.9933016371923923, 'auprc': 0.997697324476081, 'loss_val': 0.03644083640309534, 'psi': 0.9950599121058679}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=44 head_norm_before_train=1.856694 cos_to_last_merge=0.8288 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.829
[S9] round=44 local utility u=0.000000 metrics={'f1_val': 0.9895217784513768, 'auprc': 0.9985978269806088, 'loss_val': 0.03277507293807526, 'psi': 0.9931521978630696}-{'f1_val': 0.9962421144756511, 'auprc': 0.9984990236319263, 'loss_val': 0.022864190220099577, 'psi': 0.9971448781381612}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=44 head_norm_before_train=1.882056 cos_to_last_merge=0.9578 (last merge round=19)
[S10] round=44 local utility u=0.001239 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9939212469718717, 'loss_val': 0.033622807457336285, 'psi': 0.9947623711269868}-{'f1_val': 0.9953231205637304, 'auprc': 0.9934202422753965, 'loss_val': 0.03459850702529699, 'psi': 0.9945619692483968}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=44 head_norm_before_train=1.711524 cos_to_last_merge=0.9303 (last merge round=19)
[S11] ⚠️ Model drifted since last merge! cos=0.930
[S11] round=44 local utility u=0.050244 metrics={'f1_val': 0.9955339121130024, 'auprc': 0.9978785440447497, 'loss_val': 0.0348012245915534, 'psi': 0.9964717648857013}-{'f1_val': 0.981169186686789, 'auprc': 0.9981314616608484, 'loss_val': 0.04985965905927035, 'psi': 0.9879540966764127}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=44 head_norm_before_train=1.807733 cos_to_last_merge=0.9840 (last merge round=20)
[S13] round=44 local utility u=0.116472 metrics={'f1_val': 0.6328045661941342, 'auprc': 0.752706677657485, 'loss_val': 0.8637006453686742, 'psi': 0.6807654107794745}-{'f1_val': 0.6131535029101316, 'auprc': 0.7430352277529284, 'loss_val': 0.9497247514277288, 'psi': 0.6651061928472504}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S13] sending update (kind=head size=1807 to 1 peers)
[S14] START round=44 head_norm_before_train=1.863326 cos_to_last_merge=0.9704 (last merge round=17)
[S14] round=44 local utility u=0.002294 metrics={'f1_val': 0.996754531653698, 'auprc': 0.9970982813776477, 'loss_val': 0.02686387361159546, 'psi': 0.9968920315432779}-{'f1_val': 0.9967480671851483, 'auprc': 0.9957033589997496, 'loss_val': 0.027228130821880758, 'psi': 0.9963301839109888}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] sending update (kind=head size=1804 to 1 peers)
[S15] START round=44 head_norm_before_train=1.954226 cos_to_last_merge=0.9668 (last merge round=19)
[S15] round=44 local utility u=0.000000 metrics={'f1_val': 0.7875406920317544, 'auprc': 0.9956780155878422, 'loss_val': 0.32202660595773286, 'psi': 0.8707956214541894}-{'f1_val': 0.9962895101731264, 'auprc': 0.9965040340128332, 'loss_val': 0.02869932528275219, 'psi': 0.996375319709009}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=44 head_norm_before_train=2.006403 (no previous merge yet)
[S16] round=44 local utility u=0.338515 metrics={'f1_val': 0.9920726066943684, 'auprc': 0.9980404570918786, 'loss_val': 0.04106663365077795, 'psi': 0.9944597468533725}-{'f1_val': 0.934689031492333, 'auprc': 0.9852007349956629, 'loss_val': 0.33527675794057266, 'psi': 0.9548937128936649}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=44 head_norm_before_train=2.073084 (no previous merge yet)
[S17] round=44 local utility u=0.140067 metrics={'f1_val': 0.5900168342714913, 'auprc': 0.8971104290902345, 'loss_val': 1.0927136277130374, 'psi': 0.7128542721989886}-{'f1_val': 0.5910624473302305, 'auprc': 0.8293277908677433, 'loss_val': 1.175772460066459, 'psi': 0.6863685847452357}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=45 head_norm_before_train=1.621563 cos_to_last_merge=0.9792 (last merge round=19)
[S2] round=45 local utility u=0.074666 metrics={'f1_val': 0.6515591037076354, 'auprc': 0.759141649276013, 'loss_val': 0.7104572119648326, 'psi': 0.6945921219349864}-{'f1_val': 0.6293295486283959, 'auprc': 0.7598890306466284, 'loss_val': 0.7286538389539466, 'psi': 0.6815533414356889}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] sending update (kind=head size=1804 to 1 peers)
[S3] START round=45 head_norm_before_train=1.480026 cos_to_last_merge=0.9347 (last merge round=19)
[S3] ⚠️ Model drifted since last merge! cos=0.935
[S3] round=45 local utility u=0.141415 metrics={'f1_val': 0.9966688156992842, 'auprc': 0.9982747631242622, 'loss_val': 0.04375666548253504, 'psi': 0.9973111946692754}-{'f1_val': 0.960995754132836, 'auprc': 0.998000149071114, 'loss_val': 0.11172363382482192, 'psi': 0.9757975121081472}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=45 head_norm_before_train=1.794419 cos_to_last_merge=0.7572 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.757
[S4] round=45 local utility u=0.000000 metrics={'f1_val': 0.9423601244362066, 'auprc': 0.9234696522273342, 'loss_val': 0.3227998691118336, 'psi': 0.9348039355526576}-{'f1_val': 0.9568805893357024, 'auprc': 0.9463503590939674, 'loss_val': 0.30469108211123336, 'psi': 0.9526684972390085}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=45 head_norm_before_train=1.445639 cos_to_last_merge=0.9567 (last merge round=19)
[S5] round=45 local utility u=0.749450 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9829447088919574, 'loss_val': 0.2770646757188055, 'psi': 0.8133702426515983}-{'f1_val': 0.605206157769179, 'auprc': 0.7884805344641275, 'loss_val': 0.6218845390966975, 'psi': 0.6785159084471584}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=45 head_norm_before_train=1.632758 cos_to_last_merge=0.7704 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.770
[S6] round=45 local utility u=0.000000 metrics={'f1_val': 0.595810739728229, 'auprc': 0.7634994658994159, 'loss_val': 0.9878724812213052, 'psi': 0.6628862301967038}-{'f1_val': 0.9394054462831657, 'auprc': 0.9625994665776181, 'loss_val': 0.18863747750655244, 'psi': 0.9486830544009466}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=45 head_norm_before_train=1.434559 cos_to_last_merge=0.7663 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.766
[S7] round=45 local utility u=0.000632 metrics={'f1_val': 0.6095778456822101, 'auprc': 0.7938058736136284, 'loss_val': 0.6044222712501053, 'psi': 0.6832690568547775}-{'f1_val': 0.6130875029072713, 'auprc': 0.7930938529204198, 'loss_val': 0.6246089965836734, 'psi': 0.6850900429125307}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=45 head_norm_before_train=1.783369 cos_to_last_merge=0.9670 (last merge round=19)
[S8] round=45 local utility u=0.000000 metrics={'f1_val': 0.9927318893430277, 'auprc': 0.9864765410691372, 'loss_val': 0.04141181150235717, 'psi': 0.9902297500334715}-{'f1_val': 0.9922164873423569, 'auprc': 0.9989451755153729, 'loss_val': 0.0375748725304177, 'psi': 0.9949079626115633}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=45 head_norm_before_train=1.865245 cos_to_last_merge=0.8281 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.828
[S9] round=45 local utility u=0.009117 metrics={'f1_val': 0.9920560831330487, 'auprc': 0.9987162945405377, 'loss_val': 0.030101377332123442, 'psi': 0.9947201676960442}-{'f1_val': 0.9895217784513768, 'auprc': 0.9985978269806088, 'loss_val': 0.03277507293807526, 'psi': 0.9931521978630696}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S9] sending update (kind=head size=1805 to 1 peers)
[S10] START round=45 head_norm_before_train=1.894181 cos_to_last_merge=0.9567 (last merge round=19)
[S10] round=45 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9928853047700215, 'loss_val': 0.03356587224725089, 'psi': 0.9943479942462468}-{'f1_val': 0.9953231205637304, 'auprc': 0.9939212469718717, 'loss_val': 0.033622807457336285, 'psi': 0.9947623711269868}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=45 head_norm_before_train=1.721891 cos_to_last_merge=0.9288 (last merge round=19)
[S11] ⚠️ Model drifted since last merge! cos=0.929
[S11] round=45 local utility u=0.000000 metrics={'f1_val': 0.8438792469993844, 'auprc': 0.996565617198695, 'loss_val': 0.2180694957155297, 'psi': 0.9049537950791087}-{'f1_val': 0.9955339121130024, 'auprc': 0.9978785440447497, 'loss_val': 0.0348012245915534, 'psi': 0.9964717648857013}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=45 head_norm_before_train=1.813924 cos_to_last_merge=0.9835 (last merge round=20)
[S13] round=45 local utility u=0.000000 metrics={'f1_val': 0.6517466849755319, 'auprc': 0.766162525818148, 'loss_val': 1.0212342952792057, 'psi': 0.6975130213125784}-{'f1_val': 0.6328045661941342, 'auprc': 0.752706677657485, 'loss_val': 0.8637006453686742, 'psi': 0.6807654107794745}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=45 head_norm_before_train=1.872818 cos_to_last_merge=0.9700 (last merge round=17)
[S14] round=45 local utility u=0.001935 metrics={'f1_val': 0.9971652929977585, 'auprc': 0.9970277075196992, 'loss_val': 0.025246823117363225, 'psi': 0.9971102588065348}-{'f1_val': 0.996754531653698, 'auprc': 0.9970982813776477, 'loss_val': 0.02686387361159546, 'psi': 0.9968920315432779}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=45 head_norm_before_train=1.966085 cos_to_last_merge=0.9660 (last merge round=19)
[S15] round=45 local utility u=0.000000 metrics={'f1_val': 0.7748141269783061, 'auprc': 0.9933508250509177, 'loss_val': 0.41832211810221126, 'psi': 0.8622288062073507}-{'f1_val': 0.7875406920317544, 'auprc': 0.9956780155878422, 'loss_val': 0.32202660595773286, 'psi': 0.8707956214541894}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=45 head_norm_before_train=2.015789 (no previous merge yet)
[S16] round=45 local utility u=0.003986 metrics={'f1_val': 0.9926771897808344, 'auprc': 0.9984680652720541, 'loss_val': 0.03800443267129175, 'psi': 0.9949935399773222}-{'f1_val': 0.9920726066943684, 'auprc': 0.9980404570918786, 'loss_val': 0.04106663365077795, 'psi': 0.9944597468533725}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S17] START round=45 head_norm_before_train=2.081068 (no previous merge yet)
[S17] round=45 local utility u=0.205682 metrics={'f1_val': 0.598124801224301, 'auprc': 0.9897261441170744, 'loss_val': 1.0078440169299283, 'psi': 0.7547653383814104}-{'f1_val': 0.5900168342714913, 'auprc': 0.8971104290902345, 'loss_val': 1.0927136277130374, 'psi': 0.7128542721989886}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=46 head_norm_before_train=1.627424 cos_to_last_merge=0.9784 (last merge round=19)
[S2] round=46 local utility u=0.000000 metrics={'f1_val': 0.6609136724082989, 'auprc': 0.7525597715097584, 'loss_val': 0.7568670461770339, 'psi': 0.6975721120488827}-{'f1_val': 0.6515591037076354, 'auprc': 0.759141649276013, 'loss_val': 0.7104572119648326, 'psi': 0.6945921219349864}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=46 head_norm_before_train=1.491930 cos_to_last_merge=0.9330 (last merge round=19)
[S3] ⚠️ Model drifted since last merge! cos=0.933
[S3] round=46 local utility u=0.000000 metrics={'f1_val': 0.9721272380718695, 'auprc': 0.9982764840024562, 'loss_val': 0.07044227180117953, 'psi': 0.9825869364441042}-{'f1_val': 0.9966688156992842, 'auprc': 0.9982747631242622, 'loss_val': 0.04375666548253504, 'psi': 0.9973111946692754}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=46 head_norm_before_train=1.795784 cos_to_last_merge=0.7575 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.757
[S4] round=46 local utility u=0.000000 metrics={'f1_val': 0.9397929288009991, 'auprc': 0.9191114468639902, 'loss_val': 0.3438514678463889, 'psi': 0.9315203360261956}-{'f1_val': 0.9423601244362066, 'auprc': 0.9234696522273342, 'loss_val': 0.3227998691118336, 'psi': 0.9348039355526576}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=46 head_norm_before_train=1.450905 cos_to_last_merge=0.9564 (last merge round=19)
[S5] round=46 local utility u=0.000000 metrics={'f1_val': 0.6994625350261692, 'auprc': 0.8856442071811952, 'loss_val': 0.3214974755714928, 'psi': 0.7739352038881796}-{'f1_val': 0.700320598491359, 'auprc': 0.9829447088919574, 'loss_val': 0.2770646757188055, 'psi': 0.8133702426515983}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=46 head_norm_before_train=1.641697 cos_to_last_merge=0.7702 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.770
[S6] round=46 local utility u=1.000000 metrics={'f1_val': 0.8259357357300134, 'auprc': 0.9503333412376004, 'loss_val': 0.43381495268835946, 'psi': 0.8756947779330482}-{'f1_val': 0.595810739728229, 'auprc': 0.7634994658994159, 'loss_val': 0.9878724812213052, 'psi': 0.6628862301967038}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=46 head_norm_before_train=1.450325 cos_to_last_merge=0.7644 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.764
[S7] round=46 local utility u=0.203441 metrics={'f1_val': 0.6503172782845057, 'auprc': 0.8052693778650764, 'loss_val': 0.4763671825874908, 'psi': 0.712298118116734}-{'f1_val': 0.6095778456822101, 'auprc': 0.7938058736136284, 'loss_val': 0.6044222712501053, 'psi': 0.6832690568547775}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=46 head_norm_before_train=1.790883 cos_to_last_merge=0.9665 (last merge round=19)
[S8] round=46 local utility u=0.018056 metrics={'f1_val': 0.9918532151771823, 'auprc': 0.9989800498221116, 'loss_val': 0.03753909873396544, 'psi': 0.9947039490351541}-{'f1_val': 0.9927318893430277, 'auprc': 0.9864765410691372, 'loss_val': 0.04141181150235717, 'psi': 0.9902297500334715}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=46 head_norm_before_train=1.872128 cos_to_last_merge=0.8276 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.828
[S9] round=46 local utility u=0.011248 metrics={'f1_val': 0.994994420763055, 'auprc': 0.9983356203206375, 'loss_val': 0.02409302108276554, 'psi': 0.996330900586088}-{'f1_val': 0.9920560831330487, 'auprc': 0.9987162945405377, 'loss_val': 0.030101377332123442, 'psi': 0.9947201676960442}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=46 head_norm_before_train=1.906085 cos_to_last_merge=0.9557 (last merge round=19)
[S10] round=46 local utility u=0.001643 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9935834455305392, 'loss_val': 0.032375184351551956, 'psi': 0.9946272505504539}-{'f1_val': 0.9953231205637304, 'auprc': 0.9928853047700215, 'loss_val': 0.03356587224725089, 'psi': 0.9943479942462468}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=46 head_norm_before_train=1.732064 cos_to_last_merge=0.9274 (last merge round=19)
[S11] ⚠️ Model drifted since last merge! cos=0.927
[S11] round=46 local utility u=0.549858 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9972508495753523, 'loss_val': 0.03393536974968344, 'psi': 0.9965805447781265}-{'f1_val': 0.8438792469993844, 'auprc': 0.996565617198695, 'loss_val': 0.2180694957155297, 'psi': 0.9049537950791087}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=46 head_norm_before_train=1.822499 cos_to_last_merge=0.9829 (last merge round=20)
[S13] round=46 local utility u=0.034999 metrics={'f1_val': 0.6383104254034718, 'auprc': 0.765501151617966, 'loss_val': 0.8686344245971588, 'psi': 0.6891867158892695}-{'f1_val': 0.6517466849755319, 'auprc': 0.766162525818148, 'loss_val': 1.0212342952792057, 'psi': 0.6975130213125784}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S14] START round=46 head_norm_before_train=1.884175 cos_to_last_merge=0.9695 (last merge round=17)
[S14] round=46 local utility u=0.000000 metrics={'f1_val': 0.9591989392924253, 'auprc': 0.9984742246442888, 'loss_val': 0.05485818857109966, 'psi': 0.9749090534331708}-{'f1_val': 0.9971652929977585, 'auprc': 0.9970277075196992, 'loss_val': 0.025246823117363225, 'psi': 0.9971102588065348}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=46 head_norm_before_train=1.976690 cos_to_last_merge=0.9652 (last merge round=19)
[S15] round=46 local utility u=0.867737 metrics={'f1_val': 0.9962895101731264, 'auprc': 0.9971649907367752, 'loss_val': 0.023143406092573066, 'psi': 0.9966397023985859}-{'f1_val': 0.7748141269783061, 'auprc': 0.9933508250509177, 'loss_val': 0.41832211810221126, 'psi': 0.8622288062073507}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=46 head_norm_before_train=2.022422 (no previous merge yet)
[S16] round=46 local utility u=0.000000 metrics={'f1_val': 0.9924626102086869, 'auprc': 0.9983540045853594, 'loss_val': 0.038376147232400126, 'psi': 0.9948191679593559}-{'f1_val': 0.9926771897808344, 'auprc': 0.9984680652720541, 'loss_val': 0.03800443267129175, 'psi': 0.9949935399773222}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=46 head_norm_before_train=2.087851 (no previous merge yet)
[S17] round=46 local utility u=0.000000 metrics={'f1_val': 0.5960906985470131, 'auprc': 0.8342172470310862, 'loss_val': 1.0805128997554736, 'psi': 0.6913413179406425}-{'f1_val': 0.598124801224301, 'auprc': 0.9897261441170744, 'loss_val': 1.0078440169299283, 'psi': 0.7547653383814104}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=47 head_norm_before_train=1.633910 cos_to_last_merge=0.9775 (last merge round=19)
[S2] round=47 local utility u=0.186338 metrics={'f1_val': 0.7175003433683241, 'auprc': 0.7744267989848522, 'loss_val': 0.7893114334344026, 'psi': 0.7402709256149353}-{'f1_val': 0.6609136724082989, 'auprc': 0.7525597715097584, 'loss_val': 0.7568670461770339, 'psi': 0.6975721120488827}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=47 head_norm_before_train=1.504418 cos_to_last_merge=0.9314 (last merge round=19)
[S3] ⚠️ Model drifted since last merge! cos=0.931
[S3] round=47 local utility u=0.000000 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.998279292843175, 'loss_val': 0.09244553149750635, 'psi': 0.9759328678005361}-{'f1_val': 0.9721272380718695, 'auprc': 0.9982764840024562, 'loss_val': 0.07044227180117953, 'psi': 0.9825869364441042}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=47 head_norm_before_train=1.798760 cos_to_last_merge=0.7576 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.758
[S4] round=47 local utility u=0.026237 metrics={'f1_val': 0.9426011853949741, 'auprc': 0.9238738719415731, 'loss_val': 0.3225134265788841, 'psi': 0.9351102600136136}-{'f1_val': 0.9397929288009991, 'auprc': 0.9191114468639902, 'loss_val': 0.3438514678463889, 'psi': 0.9315203360261956}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=47 head_norm_before_train=1.456870 cos_to_last_merge=0.9558 (last merge round=19)
[S5] round=47 local utility u=0.219845 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9936819065574897, 'loss_val': 0.21106864542960316, 'psi': 0.8176651217178112}-{'f1_val': 0.6994625350261692, 'auprc': 0.8856442071811952, 'loss_val': 0.3214974755714928, 'psi': 0.7739352038881796}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=47 head_norm_before_train=1.649578 cos_to_last_merge=0.7696 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.770
[S6] round=47 local utility u=0.000000 metrics={'f1_val': 0.7388439669523913, 'auprc': 0.937511007568476, 'loss_val': 0.5763903601627224, 'psi': 0.8183107831988252}-{'f1_val': 0.8259357357300134, 'auprc': 0.9503333412376004, 'loss_val': 0.43381495268835946, 'psi': 0.8756947779330482}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=47 head_norm_before_train=1.465294 cos_to_last_merge=0.7629 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.763
[S7] round=47 local utility u=0.000000 metrics={'f1_val': 0.61332268475778, 'auprc': 0.7904885664099169, 'loss_val': 0.7230397785077396, 'psi': 0.6841890374186348}-{'f1_val': 0.6503172782845057, 'auprc': 0.8052693778650764, 'loss_val': 0.4763671825874908, 'psi': 0.712298118116734}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=47 head_norm_before_train=1.799122 cos_to_last_merge=0.9659 (last merge round=19)
[S8] round=47 local utility u=0.000000 metrics={'f1_val': 0.9919702074593876, 'auprc': 0.9862635826328284, 'loss_val': 0.04891334527107794, 'psi': 0.989687557528764}-{'f1_val': 0.9918532151771823, 'auprc': 0.9989800498221116, 'loss_val': 0.03753909873396544, 'psi': 0.9947039490351541}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=47 head_norm_before_train=1.880779 cos_to_last_merge=0.8268 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.827
[S9] round=47 local utility u=0.000000 metrics={'f1_val': 0.9916350289240425, 'auprc': 0.9986854056974418, 'loss_val': 0.030823091609836387, 'psi': 0.9944551796334022}-{'f1_val': 0.994994420763055, 'auprc': 0.9983356203206375, 'loss_val': 0.02409302108276554, 'psi': 0.996330900586088}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=47 head_norm_before_train=1.917636 cos_to_last_merge=0.9547 (last merge round=19)
[S10] round=47 local utility u=0.000667 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9937651352713194, 'loss_val': 0.03158609769866077, 'psi': 0.994699926446766}-{'f1_val': 0.9953231205637304, 'auprc': 0.9935834455305392, 'loss_val': 0.032375184351551956, 'psi': 0.9946272505504539}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=47 head_norm_before_train=1.742239 cos_to_last_merge=0.9260 (last merge round=19)
[S11] ⚠️ Model drifted since last merge! cos=0.926
[S11] round=47 local utility u=0.000000 metrics={'f1_val': 0.9961352899639802, 'auprc': 0.996538961952939, 'loss_val': 0.033968024915607645, 'psi': 0.9962967587595637}-{'f1_val': 0.9961336749133093, 'auprc': 0.9972508495753523, 'loss_val': 0.03393536974968344, 'psi': 0.9965805447781265}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=47 head_norm_before_train=1.829349 cos_to_last_merge=0.9823 (last merge round=20)
[S13] round=47 local utility u=0.000000 metrics={'f1_val': 0.6297229361273172, 'auprc': 0.7369253961316239, 'loss_val': 0.9753945647283787, 'psi': 0.6726039201290399}-{'f1_val': 0.6383104254034718, 'auprc': 0.765501151617966, 'loss_val': 0.8686344245971588, 'psi': 0.6891867158892695}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=47 head_norm_before_train=1.894016 cos_to_last_merge=0.9691 (last merge round=17)
[S14] round=47 local utility u=0.129750 metrics={'f1_val': 0.9974055297193176, 'auprc': 0.998720906233201, 'loss_val': 0.02533770758927392, 'psi': 0.997931680324871}-{'f1_val': 0.9591989392924253, 'auprc': 0.9984742246442888, 'loss_val': 0.05485818857109966, 'psi': 0.9749090534331708}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=47 head_norm_before_train=1.987054 cos_to_last_merge=0.9645 (last merge round=19)
[S15] round=47 local utility u=0.000000 metrics={'f1_val': 0.7605516621655483, 'auprc': 0.9918048051595636, 'loss_val': 0.5134890920331563, 'psi': 0.8530529193631544}-{'f1_val': 0.9962895101731264, 'auprc': 0.9971649907367752, 'loss_val': 0.023143406092573066, 'psi': 0.9966397023985859}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=47 head_norm_before_train=2.026318 (no previous merge yet)
[S16] round=47 local utility u=0.000000 metrics={'f1_val': 0.9913959028193259, 'auprc': 0.9914420613851871, 'loss_val': 0.05125096374743217, 'psi': 0.9914143662456704}-{'f1_val': 0.9924626102086869, 'auprc': 0.9983540045853594, 'loss_val': 0.038376147232400126, 'psi': 0.9948191679593559}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=47 head_norm_before_train=2.094200 (no previous merge yet)
[S17] round=47 local utility u=0.000000 metrics={'f1_val': 0.5764613932473686, 'auprc': 0.736770383262094, 'loss_val': 1.1310365738377957, 'psi': 0.6405849892532587}-{'f1_val': 0.5960906985470131, 'auprc': 0.8342172470310862, 'loss_val': 1.0805128997554736, 'psi': 0.6913413179406425}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=48 head_norm_before_train=1.641574 cos_to_last_merge=0.9765 (last merge round=19)
[S2] round=48 local utility u=0.002575 metrics={'f1_val': 0.7174431135249114, 'auprc': 0.7631574983192675, 'loss_val': 0.7500101690547156, 'psi': 0.7357288674426539}-{'f1_val': 0.7175003433683241, 'auprc': 0.7744267989848522, 'loss_val': 0.7893114334344026, 'psi': 0.7402709256149353}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=48 head_norm_before_train=1.517225 cos_to_last_merge=0.9298 (last merge round=19)
[S3] ⚠️ Model drifted since last merge! cos=0.930
[S3] round=48 local utility u=0.134020 metrics={'f1_val': 0.9965365984006044, 'auprc': 0.9980344649262918, 'loss_val': 0.0366782784371798, 'psi': 0.9971357450108793}-{'f1_val': 0.9610352511054436, 'auprc': 0.998279292843175, 'loss_val': 0.09244553149750635, 'psi': 0.9759328678005361}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=48 head_norm_before_train=1.805775 cos_to_last_merge=0.7571 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.757
[S4] round=48 local utility u=0.000000 metrics={'f1_val': 0.939117848887418, 'auprc': 0.9131044443202313, 'loss_val': 0.3383503306067621, 'psi': 0.9287124870605433}-{'f1_val': 0.9426011853949741, 'auprc': 0.9238738719415731, 'loss_val': 0.3225134265788841, 'psi': 0.9351102600136136}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=48 head_norm_before_train=1.465955 cos_to_last_merge=0.9551 (last merge round=19)
[S5] round=48 local utility u=0.000000 metrics={'f1_val': 0.5800639488697539, 'auprc': 0.8548091634972279, 'loss_val': 0.6069009033763588, 'psi': 0.6899620347207436}-{'f1_val': 0.700320598491359, 'auprc': 0.9936819065574897, 'loss_val': 0.21106864542960316, 'psi': 0.8176651217178112}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=48 head_norm_before_train=1.655679 cos_to_last_merge=0.7696 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.770
[S6] round=48 local utility u=0.603351 metrics={'f1_val': 0.8795826133292998, 'auprc': 0.9603634146945179, 'loss_val': 0.28267708755856624, 'psi': 0.911894933875387}-{'f1_val': 0.7388439669523913, 'auprc': 0.937511007568476, 'loss_val': 0.5763903601627224, 'psi': 0.8183107831988252}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=48 head_norm_before_train=1.477272 cos_to_last_merge=0.7618 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.762
[S7] round=48 local utility u=0.491032 metrics={'f1_val': 0.6911042700002746, 'auprc': 0.8471117321023267, 'loss_val': 0.37753517916657836, 'psi': 0.7535072548410955}-{'f1_val': 0.61332268475778, 'auprc': 0.7904885664099169, 'loss_val': 0.7230397785077396, 'psi': 0.6841890374186348}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=48 head_norm_before_train=1.804441 cos_to_last_merge=0.9655 (last merge round=19)
[S8] round=48 local utility u=0.006412 metrics={'f1_val': 0.9870209625417231, 'auprc': 0.9989918707298785, 'loss_val': 0.04457960891184168, 'psi': 0.9918093258169853}-{'f1_val': 0.9919702074593876, 'auprc': 0.9862635826328284, 'loss_val': 0.04891334527107794, 'psi': 0.989687557528764}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S8] sending update (kind=head size=1807 to 1 peers)
[S9] START round=48 head_norm_before_train=1.889215 cos_to_last_merge=0.8261 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.826
[S9] round=48 local utility u=0.008706 metrics={'f1_val': 0.9937421749897083, 'auprc': 0.9985228952613641, 'loss_val': 0.025565926551929415, 'psi': 0.9956544630983706}-{'f1_val': 0.9916350289240425, 'auprc': 0.9986854056974418, 'loss_val': 0.030823091609836387, 'psi': 0.9944551796334022}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=48 head_norm_before_train=1.927958 cos_to_last_merge=0.9538 (last merge round=19)
[S10] round=48 local utility u=0.000070 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9936083238797955, 'loss_val': 0.030976244821047303, 'psi': 0.9946372018901564}-{'f1_val': 0.9953231205637304, 'auprc': 0.9937651352713194, 'loss_val': 0.03158609769866077, 'psi': 0.994699926446766}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=48 head_norm_before_train=1.750710 cos_to_last_merge=0.9247 (last merge round=19)
[S11] ⚠️ Model drifted since last merge! cos=0.925
[S11] round=48 local utility u=0.002366 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.997528262431539, 'loss_val': 0.030742777317800413, 'psi': 0.996546407693764}-{'f1_val': 0.9961352899639802, 'auprc': 0.996538961952939, 'loss_val': 0.033968024915607645, 'psi': 0.9962967587595637}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=48 head_norm_before_train=1.834868 cos_to_last_merge=0.9819 (last merge round=20)
[S13] round=48 local utility u=0.000000 metrics={'f1_val': 0.6161436741591184, 'auprc': 0.7986421738611327, 'loss_val': 1.1025501223348408, 'psi': 0.689143074039924}-{'f1_val': 0.6297229361273172, 'auprc': 0.7369253961316239, 'loss_val': 0.9753945647283787, 'psi': 0.6726039201290399}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=48 head_norm_before_train=1.904798 cos_to_last_merge=0.9686 (last merge round=17)
[S14] round=48 local utility u=0.000000 metrics={'f1_val': 0.9972216920155168, 'auprc': 0.9959111300024746, 'loss_val': 0.0237186437786313, 'psi': 0.9966974672103}-{'f1_val': 0.9974055297193176, 'auprc': 0.998720906233201, 'loss_val': 0.02533770758927392, 'psi': 0.997931680324871}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=48 head_norm_before_train=1.997661 cos_to_last_merge=0.9638 (last merge round=19)
[S15] round=48 local utility u=0.000000 metrics={'f1_val': 0.7009202876340006, 'auprc': 0.9908620638458638, 'loss_val': 0.7089281057174583, 'psi': 0.8168969981187459}-{'f1_val': 0.7605516621655483, 'auprc': 0.9918048051595636, 'loss_val': 0.5134890920331563, 'psi': 0.8530529193631544}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=48 head_norm_before_train=2.031274 (no previous merge yet)
[S16] round=48 local utility u=0.000000 metrics={'f1_val': 0.9346570483679855, 'auprc': 0.9851917926577798, 'loss_val': 0.3464511744978508, 'psi': 0.9548709460839031}-{'f1_val': 0.9913959028193259, 'auprc': 0.9914420613851871, 'loss_val': 0.05125096374743217, 'psi': 0.9914143662456704}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=48 head_norm_before_train=2.101231 (no previous merge yet)
[S17] round=48 local utility u=0.000000 metrics={'f1_val': 0.5610324196949881, 'auprc': 0.7669366047928419, 'loss_val': 1.3038362960901433, 'psi': 0.6433940937341296}-{'f1_val': 0.5764613932473686, 'auprc': 0.736770383262094, 'loss_val': 1.1310365738377957, 'psi': 0.6405849892532587}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=49 head_norm_before_train=1.649512 cos_to_last_merge=0.9753 (last merge round=19)
[S2] round=49 local utility u=0.004853 metrics={'f1_val': 0.7180009107341132, 'auprc': 0.7732381386713982, 'loss_val': 0.7738923746248947, 'psi': 0.7400958019090271}-{'f1_val': 0.7174431135249114, 'auprc': 0.7631574983192675, 'loss_val': 0.7500101690547156, 'psi': 0.7357288674426539}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=49 head_norm_before_train=1.529644 cos_to_last_merge=0.9283 (last merge round=19)
[S3] ⚠️ Model drifted since last merge! cos=0.928
[S3] round=49 local utility u=0.000000 metrics={'f1_val': 0.9919338418812474, 'auprc': 0.9985499423088882, 'loss_val': 0.041418841610721686, 'psi': 0.9945802820523038}-{'f1_val': 0.9965365984006044, 'auprc': 0.9980344649262918, 'loss_val': 0.0366782784371798, 'psi': 0.9971357450108793}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=49 head_norm_before_train=1.812171 cos_to_last_merge=0.7567 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.757
[S4] round=49 local utility u=0.108556 metrics={'f1_val': 0.9537331330023148, 'auprc': 0.9465335052635041, 'loss_val': 0.30921676873484855, 'psi': 0.9508532819067905}-{'f1_val': 0.939117848887418, 'auprc': 0.9131044443202313, 'loss_val': 0.3383503306067621, 'psi': 0.9287124870605433}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=49 head_norm_before_train=1.470714 cos_to_last_merge=0.9549 (last merge round=19)
[S5] round=49 local utility u=0.000000 metrics={'f1_val': 0.5551591180595964, 'auprc': 0.8547885920703079, 'loss_val': 0.6837802934357461, 'psi': 0.675010907663881}-{'f1_val': 0.5800639488697539, 'auprc': 0.8548091634972279, 'loss_val': 0.6069009033763588, 'psi': 0.6899620347207436}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=49 head_norm_before_train=1.668076 cos_to_last_merge=0.7681 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.768
[S6] round=49 local utility u=0.000000 metrics={'f1_val': 0.6439155478687834, 'auprc': 0.9326270510392415, 'loss_val': 0.7760512719427384, 'psi': 0.7594001491369666}-{'f1_val': 0.8795826133292998, 'auprc': 0.9603634146945179, 'loss_val': 0.28267708755856624, 'psi': 0.911894933875387}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=49 head_norm_before_train=1.483027 cos_to_last_merge=0.7611 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.761
[S7] round=49 local utility u=0.000000 metrics={'f1_val': 0.6080232642846763, 'auprc': 0.7899115689181008, 'loss_val': 0.7628101302431318, 'psi': 0.6807785861380461}-{'f1_val': 0.6911042700002746, 'auprc': 0.8471117321023267, 'loss_val': 0.37753517916657836, 'psi': 0.7535072548410955}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=49 head_norm_before_train=1.811709 cos_to_last_merge=0.9649 (last merge round=19)
[S8] round=49 local utility u=0.000000 metrics={'f1_val': 0.9793578204123208, 'auprc': 0.9951772481030003, 'loss_val': 0.05895873309363691, 'psi': 0.9856855914885927}-{'f1_val': 0.9870209625417231, 'auprc': 0.9989918707298785, 'loss_val': 0.04457960891184168, 'psi': 0.9918093258169853}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=49 head_norm_before_train=1.897961 cos_to_last_merge=0.8254 (last merge round=2)
[S9] ⚠️ Model drifted since last merge! cos=0.825
[S9] round=49 local utility u=0.000000 metrics={'f1_val': 0.9192697542558848, 'auprc': 0.9984919694729963, 'loss_val': 0.11911693342384425, 'psi': 0.9509586403427295}-{'f1_val': 0.9937421749897083, 'auprc': 0.9985228952613641, 'loss_val': 0.025565926551929415, 'psi': 0.9956544630983706}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=49 head_norm_before_train=1.936682 cos_to_last_merge=0.9529 (last merge round=19)
[S10] round=49 local utility u=0.000205 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9935741147704699, 'loss_val': 0.030463429288134725, 'psi': 0.9946235182464261}-{'f1_val': 0.9953231205637304, 'auprc': 0.9936083238797955, 'loss_val': 0.030976244821047303, 'psi': 0.9946372018901564}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=49 head_norm_before_train=1.759512 cos_to_last_merge=0.9235 (last merge round=19)
[S11] ⚠️ Model drifted since last merge! cos=0.924
[S11] round=49 local utility u=0.000769 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9971966877507239, 'loss_val': 0.029661105485920585, 'psi': 0.9965588800482752}-{'f1_val': 0.9958918378685807, 'auprc': 0.997528262431539, 'loss_val': 0.030742777317800413, 'psi': 0.996546407693764}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] sending update (kind=head size=1804 to 1 peers)
[S13] START round=49 head_norm_before_train=1.839643 cos_to_last_merge=0.9815 (last merge round=20)
[S13] round=49 local utility u=0.315856 metrics={'f1_val': 0.6886508468628683, 'auprc': 0.7842975399081521, 'loss_val': 0.8628475889424624, 'psi': 0.7269095240809818}-{'f1_val': 0.6161436741591184, 'auprc': 0.7986421738611327, 'loss_val': 1.1025501223348408, 'psi': 0.689143074039924}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=49 head_norm_before_train=1.914446 cos_to_last_merge=0.9681 (last merge round=17)
[S14] round=49 local utility u=0.000000 metrics={'f1_val': 0.9972216920155168, 'auprc': 0.9947299884919286, 'loss_val': 0.025070984196417016, 'psi': 0.9962250106060815}-{'f1_val': 0.9972216920155168, 'auprc': 0.9959111300024746, 'loss_val': 0.0237186437786313, 'psi': 0.9966974672103}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=49 head_norm_before_train=2.008255 cos_to_last_merge=0.9631 (last merge round=19)
[S15] round=49 local utility u=1.000000 metrics={'f1_val': 0.9962895101731264, 'auprc': 0.9982414189798384, 'loss_val': 0.021388040040850854, 'psi': 0.9970702736958112}-{'f1_val': 0.7009202876340006, 'auprc': 0.9908620638458638, 'loss_val': 0.7089281057174583, 'psi': 0.8168969981187459}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=49 head_norm_before_train=2.037983 (no previous merge yet)
[S16] round=49 local utility u=0.000000 metrics={'f1_val': 0.8684621624994713, 'auprc': 0.861632603949875, 'loss_val': 0.8164433479687276, 'psi': 0.8657303390796328}-{'f1_val': 0.9346570483679855, 'auprc': 0.9851917926577798, 'loss_val': 0.3464511744978508, 'psi': 0.9548709460839031}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=49 head_norm_before_train=2.111088 (no previous merge yet)
[S17] round=49 local utility u=0.299727 metrics={'f1_val': 0.5822492319887631, 'auprc': 0.8924491403458892, 'loss_val': 1.2082212269479762, 'psi': 0.7063291953316135}-{'f1_val': 0.5610324196949881, 'auprc': 0.7669366047928419, 'loss_val': 1.3038362960901433, 'psi': 0.6433940937341296}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[runner] rounds complete.
[runner] all agents stopped.
